---
title: О панелях прокрутки
description: В окне может отображаться объект данных, например документ или точечный рисунок, который больше, чем клиентская область окна.
ms.assetid: 9cb3afad-79ef-4817-950a-c8c1de39401b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d410e98ea1fe722d6dc1c4869010df30f99bddb
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070648"
---
# <a name="about-scroll-bars"></a><span data-ttu-id="be51a-103">О панелях прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-103">About Scroll Bars</span></span>

<span data-ttu-id="be51a-104">В окне может отображаться объект данных, например документ или точечный рисунок, который больше, чем клиентская область окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-104">A window can display a data object, such as a document or a bitmap, that is larger than the window's client area.</span></span> <span data-ttu-id="be51a-105">При использовании с полосой прокрутки пользователь может прокручивать объект данных в клиентской области, чтобы отобразить части объекта, выходящие за рамки окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-105">When provided with a scroll bar, the user can scroll a data object in the client area to bring into view the portions of the object that extend beyond the borders of the window.</span></span>

<span data-ttu-id="be51a-106">Полосы прокрутки должны включаться в любое окно, для которого содержимое клиентской области выходит за границы окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-106">Scroll bars should be included in any window for which the content of the client area extends beyond the window's borders.</span></span> <span data-ttu-id="be51a-107">Ориентация полосы прокрутки определяет направление прокрутки, когда пользователь работает с полосой прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-107">A scroll bar's orientation determines the direction in which scrolling occurs when the user operates the scroll bar.</span></span> <span data-ttu-id="be51a-108">Горизонтальная полоса прокрутки позволяет пользователю прокручивать содержимое окна влево или вправо.</span><span class="sxs-lookup"><span data-stu-id="be51a-108">A horizontal scroll bar enables the user to scroll the content of a window to the left or right.</span></span> <span data-ttu-id="be51a-109">Вертикальная полоса прокрутки позволяет пользователю прокручивать содержимое вверх или вниз.</span><span class="sxs-lookup"><span data-stu-id="be51a-109">A vertical scroll bar enables the user to scroll the content up or down.</span></span>

<span data-ttu-id="be51a-110">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="be51a-110">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="be51a-111">Части полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-111">Parts of a Scroll Bar</span></span>](#parts-of-a-scroll-bar)
-   [<span data-ttu-id="be51a-112">Стандартные полосы прокрутки и элементы управления полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-112">Standard Scroll Bars and Scroll Bar Controls</span></span>](#standard-scroll-bars-and-scroll-bar-controls)
-   [<span data-ttu-id="be51a-113">Расположение поля прокрутки и диапазон прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-113">Scroll Box Position and Scrolling Range</span></span>](#scroll-box-position-and-scrolling-range)
-   [<span data-ttu-id="be51a-114">Видимость полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-114">Scroll Bar Visibility</span></span>](#scroll-bar-visibility)
-   [<span data-ttu-id="be51a-115">Запросы к полосе прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-115">Scroll Bar Requests</span></span>](#scroll-bar-requests)
-   [<span data-ttu-id="be51a-116">Интерфейс клавиатуры для полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-116">Keyboard Interface for a Scroll Bar</span></span>](#keyboard-interface-for-a-scroll-bar)
-   [<span data-ttu-id="be51a-117">Прокрутка клиентской области</span><span class="sxs-lookup"><span data-stu-id="be51a-117">Scrolling the Client Area</span></span>](#scrolling-the-client-area)
-   [<span data-ttu-id="be51a-118">Цвета и метрики полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-118">Scroll Bar Colors and Metrics</span></span>](#scroll-bar-colors-and-metrics)

## <a name="parts-of-a-scroll-bar"></a><span data-ttu-id="be51a-119">Части полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-119">Parts of a Scroll Bar</span></span>

<span data-ttu-id="be51a-120">Полоса прокрутки состоит из затененной Шафт с кнопкой со стрелкой на каждой стороне и *полем прокрутки* (иногда называемым бегунком) между кнопками со стрелками.</span><span class="sxs-lookup"><span data-stu-id="be51a-120">A scroll bar consists of a shaded shaft with an arrow button at each end and a *scroll box* (sometimes called a thumb) between the arrow buttons.</span></span> <span data-ttu-id="be51a-121">Полоса прокрутки представляет общую длину или ширину объекта данных в клиентской области окна; поле прокрутки представляет часть объекта, видимого в клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-121">A scroll bar represents the overall length or width of a data object in a window's client area; the scroll box represents the portion of the object that is visible in the client area.</span></span> <span data-ttu-id="be51a-122">Расположение поля прокрутки изменяется каждый раз, когда пользователь прокручивает объект данных для отображения другой части.</span><span class="sxs-lookup"><span data-stu-id="be51a-122">The position of the scroll box changes whenever the user scrolls a data object to display a different portion of it.</span></span> <span data-ttu-id="be51a-123">Система также корректирует размер ползунка полосы прокрутки таким образом, чтобы он обозначает, какая часть всего объекта данных в данный момент видна в окне.</span><span class="sxs-lookup"><span data-stu-id="be51a-123">The system also adjusts the size of a scroll bar's scroll box so that it indicates what portion of the entire data object is currently visible in the window.</span></span> <span data-ttu-id="be51a-124">Если большая часть объекта видна, то поле прокрутки занимает большую часть полосы прокрутки Шафт.</span><span class="sxs-lookup"><span data-stu-id="be51a-124">If most of the object is visible, the scroll box occupies most of the scroll bar shaft.</span></span> <span data-ttu-id="be51a-125">Аналогично, если видима только небольшая часть объекта, то поле прокрутки занимает небольшую часть полосы прокрутки Шафт.</span><span class="sxs-lookup"><span data-stu-id="be51a-125">Similarly, if only a small portion of the object is visible, the scroll box occupies a small part of the scroll bar shaft.</span></span>

<span data-ttu-id="be51a-126">Пользователь прокручивает содержимое окна, щелкая одну из кнопок со стрелками, щелкая область на затененной полосе прокрутки Шафт или перетаскивая ползунок.</span><span class="sxs-lookup"><span data-stu-id="be51a-126">The user scrolls the content of a window by clicking one of the arrow buttons, by clicking the area in the shaded scroll bar shaft, or by dragging the scroll box.</span></span> <span data-ttu-id="be51a-127">Когда пользователь нажимает кнопку со стрелкой, приложение прокручивает содержимое на одну единицу (обычно это одна строка или столбец).</span><span class="sxs-lookup"><span data-stu-id="be51a-127">When the user clicks an arrow button, the application scrolls the content by one unit (typically a single line or column).</span></span> <span data-ttu-id="be51a-128">Когда пользователь щелкает затененные области, приложение прокручивает содержимое по одному окну.</span><span class="sxs-lookup"><span data-stu-id="be51a-128">When the user clicks the shaded areas, the application scrolls the content by one window.</span></span> <span data-ttu-id="be51a-129">Величина прокрутки, которая возникает при перетаскивании ползунка полосы прокрутки, зависит от расстояния, на которое пользователь перетаскивает ползунок и в диапазоне прокрутки полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-129">The amount of scrolling that occurs when the user drags the scroll box depends on the distance the user drags the scroll box and on the scrolling range of the scroll bar.</span></span> <span data-ttu-id="be51a-130">Дополнительные сведения о диапазоне прокрутки см. в разделе Расположение бегунка [и диапазон прокрутки](#scroll-box-position-and-scrolling-range).</span><span class="sxs-lookup"><span data-stu-id="be51a-130">For more information about the scrolling range, see [Scroll Box Position and Scrolling Range](#scroll-box-position-and-scrolling-range).</span></span>

<span data-ttu-id="be51a-131">На следующем снимке экрана показан форматированный элемент управления "поле ввода" с вертикальной и горизонтальной полосами прокрутки, как это может появиться в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="be51a-131">The following screen shot shows a rich edit control with vertical and horizontal scroll bars, as they might appear in Windows Vista.</span></span> <span data-ttu-id="be51a-132">Вертикальная полоса прокрутки в данный момент является "активной", так как указатель мыши наводится на него при попытке выполнить снимок экрана.</span><span class="sxs-lookup"><span data-stu-id="be51a-132">The vertical scroll bar is currently "hot" because the mouse pointer was hovering over it when the screen shot was taken.</span></span>

![снимок экрана с элементом управления Rich Edit с полосами прокрутки](images/sbvista.png)

## <a name="standard-scroll-bars-and-scroll-bar-controls"></a><span data-ttu-id="be51a-134">Стандартные полосы прокрутки и элементы управления полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-134">Standard Scroll Bars and Scroll Bar Controls</span></span>

<span data-ttu-id="be51a-135">Полоса прокрутки включается в окно либо как стандартная полоса прокрутки, либо как элемент управления "полоса прокрутки".</span><span class="sxs-lookup"><span data-stu-id="be51a-135">A scroll bar is included in a window either as a standard scroll bar or as a scroll bar control.</span></span> <span data-ttu-id="be51a-136">Стандартная полоса прокрутки находится в неклиентской области окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-136">A standard scroll bar is located in the nonclient area of a window.</span></span> <span data-ttu-id="be51a-137">Он создается с окном и отображается при отображении окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-137">It is created with the window and displayed when the window is displayed.</span></span> <span data-ttu-id="be51a-138">Единственной целью стандартной полосы прокрутки является предоставление пользователю возможности создавать запросы прокрутки для просмотра всего содержимого клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-138">The sole purpose of a standard scroll bar is to enable the user to generate scrolling requests for viewing the entire content of the client area.</span></span> <span data-ttu-id="be51a-139">Можно включить стандартную полосу прокрутки в окно, указав [**WS \_ HSCROLL**](/windows/desktop/winmsg/window-styles), [**WS \_ VSCROLL**](/windows/desktop/winmsg/window-styles)или оба стиля при создании окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-139">You can include a standard scroll bar in a window by specifying [**WS\_HSCROLL**](/windows/desktop/winmsg/window-styles), [**WS\_VSCROLL**](/windows/desktop/winmsg/window-styles), or both styles when you create the window.</span></span> <span data-ttu-id="be51a-140">Стиль **WS \_ HSCROLL** создает горизонтальную полосу прокрутки, расположенную в нижней части клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-140">The **WS\_HSCROLL** style creates a horizontal scroll bar positioned at the bottom of the client area.</span></span> <span data-ttu-id="be51a-141">Стиль **WS \_ VSCROLL** создает вертикальную полосу прокрутки, расположенную справа от клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-141">The **WS\_VSCROLL** style creates a vertical scroll bar positioned at the right of the client area.</span></span> <span data-ttu-id="be51a-142">\_Значения метрик системы SM кксхскролл и SM \_ цихскролл определяют ширину и высоту стандартной горизонтальной полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-142">The SM\_CXHSCROLL and SM\_CYHSCROLL system metric values define the width and height of a standard horizontal scroll bar.</span></span> <span data-ttu-id="be51a-143">Значения SM \_ кксвскролл и SM \_ цивскролл определяют ширину и высоту стандартной вертикальной полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-143">The SM\_CXVSCROLL and SM\_CYVSCROLL values define the width and height of a standard vertical scroll bar.</span></span> <span data-ttu-id="be51a-144">Стандартная полоса прокрутки является частью связанного окна и поэтому не имеет собственного обработчика окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-144">A standard scroll bar is part of its associated window and therefore does not have a window handle of its own.</span></span>

<span data-ttu-id="be51a-145">Элемент управления "полоса прокрутки" — это окно управления, которое принадлежит классу окна SCROLLBAR.</span><span class="sxs-lookup"><span data-stu-id="be51a-145">A scroll bar control is a control window that belongs to the SCROLLBAR window class.</span></span> <span data-ttu-id="be51a-146">Появляется элемент управления "полоса прокрутки", который работает как стандартная полоса прокрутки, но является отдельным окном.</span><span class="sxs-lookup"><span data-stu-id="be51a-146">A scroll bar control appears and functions like a standard scroll bar, but it is a separate window.</span></span> <span data-ttu-id="be51a-147">В отдельном окне элемент управления "полоса прокрутки" принимает прямой фокус ввода.</span><span class="sxs-lookup"><span data-stu-id="be51a-147">As a separate window, a scroll bar control takes direct input focus.</span></span> <span data-ttu-id="be51a-148">В отличие от стандартной полосы прокрутки, элемент управления "полоса прокрутки" также имеет встроенный интерфейс клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="be51a-148">Unlike a standard scroll bar, a scroll bar control also has a built-in keyboard interface.</span></span>

<span data-ttu-id="be51a-149">В одном окне можно использовать столько элементов управления полосой прокрутки, сколько необходимо.</span><span class="sxs-lookup"><span data-stu-id="be51a-149">You can use as many scroll bar controls as needed in a single window.</span></span> <span data-ttu-id="be51a-150">При создании элемента управления "полоса прокрутки" необходимо указать размер и расположение полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-150">When you create a scroll bar control, you must specify the scroll bar's size and position.</span></span> <span data-ttu-id="be51a-151">Однако если размер окна элемента управления "полоса прокрутки" можно изменить, то при изменении размера окна размер полосы прокрутки должен быть изменен.</span><span class="sxs-lookup"><span data-stu-id="be51a-151">However, if a scroll bar control's window can be resized, adjustments to the scroll bar's size must be made whenever the size of the window changes.</span></span>

<span data-ttu-id="be51a-152">Преимуществом использования стандартной полосы прокрутки является то, что система создает полосу прокрутки и автоматически задает ее размер и расположение.</span><span class="sxs-lookup"><span data-stu-id="be51a-152">The advantage of using a standard scroll bar is that the system creates the scroll bar and automatically sets its size and position.</span></span> <span data-ttu-id="be51a-153">Однако стандартные полосы прокрутки иногда являются слишком узкими.</span><span class="sxs-lookup"><span data-stu-id="be51a-153">However, standard scroll bars are sometimes too restrictive.</span></span> <span data-ttu-id="be51a-154">Например, предположим, что необходимо разделить клиентскую область на квадранты и использовать отдельный набор полос прокрутки для управления содержимым каждого квадранта.</span><span class="sxs-lookup"><span data-stu-id="be51a-154">For example, suppose that you want to divide a client area into quadrants and use a separate set of scroll bars to control the content of each quadrant.</span></span> <span data-ttu-id="be51a-155">Нельзя использовать стандартные полосы прокрутки, так как для конкретного окна можно создать только один набор полос прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-155">You cannot use standard scroll bars because you can only create one set of scroll bars for a particular window.</span></span> <span data-ttu-id="be51a-156">Вместо этого используйте элементы управления "полоса прокрутки", так как в окно можно добавить любое количество элементов.</span><span class="sxs-lookup"><span data-stu-id="be51a-156">Use scroll bar controls instead, because you can add as many of them to a window as you want.</span></span>

<span data-ttu-id="be51a-157">Приложения могут предоставлять элементы управления "полоса прокрутки" для целей, отличных от прокрутки содержимого окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-157">Applications can provide scroll bar controls for purposes other than scrolling the content of a window.</span></span> <span data-ttu-id="be51a-158">Например, приложение-заставка может предоставить полосу прокрутки для настройки скорости перемещения графики на экране.</span><span class="sxs-lookup"><span data-stu-id="be51a-158">For example, a screen saver application might provide a scroll bar for setting the speed at which graphics are moved about on the screen.</span></span>

<span data-ttu-id="be51a-159">Элемент управления "полоса прокрутки" может иметь ряд стилей, которые служат для управления ориентацией и положением полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-159">A scroll bar control can have a number of styles that serves to control the orientation and position of the scroll bar.</span></span> <span data-ttu-id="be51a-160">Нужные стили задаются при вызове функции [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) для создания элемента управления "полоса прокрутки".</span><span class="sxs-lookup"><span data-stu-id="be51a-160">You specify the styles that you want when you call the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function to create a scroll bar control.</span></span> <span data-ttu-id="be51a-161">Некоторые стили создают элемент управления "полоса прокрутки", который использует ширину или высоту по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="be51a-161">Some of the styles create a scroll bar control that uses a default width or height.</span></span> <span data-ttu-id="be51a-162">Однако необходимо всегда указывать координаты x и y, а также другие измерения полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-162">However, you must always specify the x- and y-coordinates and the other dimensions of the scroll bar.</span></span>

<span data-ttu-id="be51a-163">Таблицу стилей элемента управления "полоса прокрутки" см. в разделе [стили элементов управления полосы прокрутки](scroll-bar-control-styles.md).</span><span class="sxs-lookup"><span data-stu-id="be51a-163">For a table of scroll bar control styles, see [Scroll Bar Control Styles](scroll-bar-control-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="be51a-164">Чтобы использовать визуальные стили с полосами прокрутки, приложение должно включать манифест и вызывать [**иниткоммонконтролс**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) в начале программы.</span><span class="sxs-lookup"><span data-stu-id="be51a-164">To use visual styles with scroll bars, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="be51a-165">Сведения о визуальных стилях см. в разделе [стили визуальных](themes-overview.md)элементов.</span><span class="sxs-lookup"><span data-stu-id="be51a-165">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="be51a-166">Дополнительные сведения о манифестах см. в разделе [Включение визуальных стилей](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="be51a-166">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="scroll-box-position-and-scrolling-range"></a><span data-ttu-id="be51a-167">Расположение поля прокрутки и диапазон прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-167">Scroll Box Position and Scrolling Range</span></span>

<span data-ttu-id="be51a-168">Расположение поля прокрутки представлено целым числом; Он задается относительно левого или верхнего конца полосы прокрутки в зависимости от того, является ли полоса прокрутки горизонтальной или вертикальной.</span><span class="sxs-lookup"><span data-stu-id="be51a-168">The position of the scroll box is represented as an integer; it is relative to the left or upper end of the scroll bar, depending on whether the scroll bar is horizontal or vertical.</span></span> <span data-ttu-id="be51a-169">Значение должно находиться в пределах минимального и максимального значений диапазона прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-169">The position must be within the minimum and maximum values of the scrolling range.</span></span> <span data-ttu-id="be51a-170">Например, в полосе прокрутки с диапазоном от 0 до 100 позиция 50 находится в середине, а оставшиеся позиции равномерно распределяются по полосе прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-170">For example, in a scroll bar with a range of 0 through 100, position 50 is in the middle, with the remaining positions distributed equally along the scroll bar.</span></span> <span data-ttu-id="be51a-171">Начальный диапазон зависит от полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-171">The initial range depends on the scroll bar.</span></span> <span data-ttu-id="be51a-172">Стандартные полосы прокрутки имеют начальный диапазон от 0 до 100; элементы управления "полоса прокрутки" имеют пустой диапазон (минимальное и максимальное значения равны нулю), если не указать явный диапазон при создании элемента управления.</span><span class="sxs-lookup"><span data-stu-id="be51a-172">Standard scroll bars have an initial range of 0 through 100; scroll bar controls have an empty range (both minimum and maximum values are zero), unless you supply an explicit range when the control is created.</span></span> <span data-ttu-id="be51a-173">Диапазон можно изменить в любое время.</span><span class="sxs-lookup"><span data-stu-id="be51a-173">You can change the range at any time.</span></span> <span data-ttu-id="be51a-174">Для задания значений диапазона можно использовать функцию [**сетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) , а для получения текущих значений диапазона — функцию [**жетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) .</span><span class="sxs-lookup"><span data-stu-id="be51a-174">You can use the [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) function to set the range values, and the [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) function to retrieve the current range values.</span></span>

<span data-ttu-id="be51a-175">Приложение обычно корректирует диапазон прокрутки до удобных целых чисел, что упрощает перевод ползунка в значение, соответствующее объекту данных для прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-175">An application typically adjusts the scroll range to convenient integers, making it easy to translate the scroll box position into a value corresponding to the data object to be scrolled.</span></span> <span data-ttu-id="be51a-176">Например, если приложение должно отображать 260 строк текстового файла в окне, в котором может отображаться только 16 строк, то диапазон вертикальной полосы прокрутки может быть установлен в 1 – 244.</span><span class="sxs-lookup"><span data-stu-id="be51a-176">For example, if an application must display 260 lines of a text file in a window that can show only 16 lines at a time, the vertical scroll bar range can be set to 1 through 244.</span></span> <span data-ttu-id="be51a-177">Если ползунок находится в позиции 1, первая строка будет находиться в верхней части окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-177">If the scroll box is at position 1, the first line will be at the top of the window.</span></span> <span data-ttu-id="be51a-178">Если ползунок находится в позиции 244, последняя строка (строка 260) будет находиться в нижней части окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-178">If the scroll box is at position 244, the last line (line 260) will be at the bottom of the window.</span></span> <span data-ttu-id="be51a-179">Если приложение пытается указать значение, которое меньше минимального или максимального значения, вместо него используется минимальное или максимальное значение диапазона прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-179">If an application attempts to specify a position value that is less than the minimum or more than the maximum, the minimum or maximum scrolling range value is used instead.</span></span>

<span data-ttu-id="be51a-180">Можно задать размер страницы для полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-180">You can set a page size for a scroll bar.</span></span> <span data-ttu-id="be51a-181">*Размер страницы* представляет количество единиц данных, которые могут поместиться в клиентскую область окна владельца, учитывая его текущий размер.</span><span class="sxs-lookup"><span data-stu-id="be51a-181">The *page size* represents the number of data units that can fit in the client area of the owner window given its current size.</span></span> <span data-ttu-id="be51a-182">Например, если клиентская область может содержать 16 строк текста, то приложение будет устанавливать размер страницы равным 16.</span><span class="sxs-lookup"><span data-stu-id="be51a-182">For example, if the client area can hold 16 lines of text, an application would set the page size to 16.</span></span> <span data-ttu-id="be51a-183">Система использует размер страницы вместе с диапазоном прокрутки и длиной полосы прокрутки Шафт, чтобы задать размер ползунка.</span><span class="sxs-lookup"><span data-stu-id="be51a-183">The system uses the page size, along with the scrolling range and length of the scroll bar shaft, to set the size of the scroll box.</span></span> <span data-ttu-id="be51a-184">При изменении размера окна, содержащего полосу прокрутки, приложение должно вызвать функцию [**сетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) , чтобы задать размер страницы.</span><span class="sxs-lookup"><span data-stu-id="be51a-184">Whenever a window containing a scroll bar is resized, an application should call the [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) function to set the page size.</span></span> <span data-ttu-id="be51a-185">Приложение может получить текущий размер страницы, вызвав функцию Send [**жетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) .</span><span class="sxs-lookup"><span data-stu-id="be51a-185">An application can retrieve the current page size by calling the sending [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) function.</span></span>

<span data-ttu-id="be51a-186">Чтобы установить полезную связь между диапазоном полосы прокрутки и объектом данных, приложение должно скорректировать диапазон при изменении размера объекта данных.</span><span class="sxs-lookup"><span data-stu-id="be51a-186">To establish a useful relationship between the scroll bar range and the data object, an application must adjust the range whenever the size of the data object changes.</span></span>

<span data-ttu-id="be51a-187">По мере того, как пользователь перемещает бегунок в полосе прокрутки, полоса прокрутки сообщает о положении ползунка в виде целого числа в диапазоне прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-187">As the user moves the scroll box in a scroll bar, the scroll bar reports the scroll box position as an integer in the scrolling range.</span></span> <span data-ttu-id="be51a-188">Если значение позиции является минимальным, то поле прокрутки находится в верхней части вертикальной полосы прокрутки или в левом конце горизонтальной полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-188">If the position is the minimum value, the scroll box is at the top of a vertical scroll bar or at the left end of a horizontal scroll bar.</span></span> <span data-ttu-id="be51a-189">Если значение позиции равно максимальному значению, поле прокрутки находится в нижней части вертикальной полосы прокрутки или в правом конце горизонтальной полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-189">If the position is the maximum value, the scroll box is at the bottom of a vertical scroll bar or at right end of a horizontal scroll bar.</span></span>

<span data-ttu-id="be51a-190">Максимальное значение, которое может быть выдается полосой прокрутки (то есть максимальной позицией прокрутки), зависит от размера страницы.</span><span class="sxs-lookup"><span data-stu-id="be51a-190">The maximum value that a scroll bar can report (that is, the maximum scrolling position) depends on the page size.</span></span> <span data-ttu-id="be51a-191">Если размер страницы в полосе прокрутки больше единицы, то максимальная длина прокрутки меньше максимального значения диапазона.</span><span class="sxs-lookup"><span data-stu-id="be51a-191">If the scroll bar has a page size greater than one, the maximum scrolling position is less than the maximum range value.</span></span> <span data-ttu-id="be51a-192">Для вычисления максимальной прокрутки можно использовать следующую формулу:</span><span class="sxs-lookup"><span data-stu-id="be51a-192">You can use the following formula to calculate the maximum scrolling position:</span></span>


```
MaxScrollPos = MaxRangeValue - (PageSize - 1) 
```



<span data-ttu-id="be51a-193">Приложение должно перемещать ползунок в полосе прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-193">An application must move the scroll box in a scroll bar.</span></span> <span data-ttu-id="be51a-194">Несмотря на то, что пользователь выполняет запрос на прокрутку в полосе прокрутки, полоса прокрутки не обновляет расположение поля прокрутки автоматически.</span><span class="sxs-lookup"><span data-stu-id="be51a-194">Although the user makes a request for scrolling in a scroll bar, the scroll bar does not automatically update the scroll box position.</span></span> <span data-ttu-id="be51a-195">Вместо этого он передает запрос родительскому окну, которое должно прокручивать данные и обновлять расположение поля прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-195">Instead, it passes the request to the parent window, which must scroll the data and update the scroll box position.</span></span> <span data-ttu-id="be51a-196">Приложение использует функцию [**сетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) для обновления расположения поля прокрутки; в противном случае используется функция [**сетскроллпос**](/windows/desktop/api/Winuser/nf-winuser-setscrollpos) .</span><span class="sxs-lookup"><span data-stu-id="be51a-196">An application uses the [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) function to update the scroll box position; otherwise, it uses the [**SetScrollPos**](/windows/desktop/api/Winuser/nf-winuser-setscrollpos) function.</span></span> <span data-ttu-id="be51a-197">Так как он управляет перемещением ползунка прокрутки, приложение может перемещать ползунок с приращениями, которые лучше подходят для прокрутки данных.</span><span class="sxs-lookup"><span data-stu-id="be51a-197">Because it controls the scroll box movement, the application can move the scroll box in increments that work best for the data being scrolled.</span></span>

## <a name="scroll-bar-visibility"></a><span data-ttu-id="be51a-198">Видимость полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-198">Scroll Bar Visibility</span></span>

<span data-ttu-id="be51a-199">Система скрывает и отключает стандартную полосу прокрутки при указании равного минимального и максимального значения.</span><span class="sxs-lookup"><span data-stu-id="be51a-199">The system hides and disables a standard scroll bar when equal minimum and maximum values are specified.</span></span> <span data-ttu-id="be51a-200">Система также скрывает и отключает стандартную полосу прокрутки, если задан размер страницы, включающий весь диапазон прокрутки полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-200">The system also hides and disables a standard scroll bar if you specify a page size that includes the entire scroll range of the scroll bar.</span></span> <span data-ttu-id="be51a-201">Это способ временного скрытия полосы прокрутки, если она не требуется для содержимого клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-201">This is the way to temporarily hide a scroll bar when it is not needed for the content of the client area.</span></span> <span data-ttu-id="be51a-202">Нет необходимости выполнять прокрутку запросов с помощью полосы прокрутки, если она скрыта.</span><span class="sxs-lookup"><span data-stu-id="be51a-202">There is no need to make scrolling requests through the scroll bar when it is hidden.</span></span> <span data-ttu-id="be51a-203">Система включает полосу прокрутки и показывает ее снова при установке минимальных и максимальных значений в неравные значения или при размере страницы, не включающем весь диапазон прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-203">The system enables the scroll bar and shows it again when you set the minimum and maximum values to unequal values or when the page size that does not include the entire scroll range.</span></span> <span data-ttu-id="be51a-204">Функцию [**шовскроллбар**](/windows/desktop/api/Winuser/nf-winuser-showscrollbar) можно также использовать для скрытия или отображения полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-204">The [**ShowScrollBar**](/windows/desktop/api/Winuser/nf-winuser-showscrollbar) function can also be used to hide or show a scroll bar.</span></span> <span data-ttu-id="be51a-205">Он не влияет на диапазон полосы прокрутки, размер страницы или расположение поля полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-205">It does not affect the scroll bar's range, page size, or scroll box position.</span></span>

<span data-ttu-id="be51a-206">Функцию [**енаблескроллбар**](/windows/desktop/api/Winuser/nf-winuser-enablescrollbar) можно использовать для отключения одной или обеих стрелок полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-206">The [**EnableScrollBar**](/windows/desktop/api/Winuser/nf-winuser-enablescrollbar) function can be used to disable one or both arrows of a scroll bar.</span></span> <span data-ttu-id="be51a-207">Приложение отображает отключенные стрелки серым цветом и не реагирует на вводимые пользователем данные.</span><span class="sxs-lookup"><span data-stu-id="be51a-207">An application displays disabled arrows in gray and does not respond to user input.</span></span>

## <a name="scroll-bar-requests"></a><span data-ttu-id="be51a-208">Запросы к полосе прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-208">Scroll Bar Requests</span></span>

<span data-ttu-id="be51a-209">Пользователь выполняет прокрутку запросов, щелкая различные части полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-209">The user makes scrolling requests by clicking various parts of a scroll bar.</span></span> <span data-ttu-id="be51a-210">Система отправляет запрос в указанное окно в виде сообщения [**WM \_ HSCROLL**](wm-hscroll.md) или [**WM \_ VSCROLL**](wm-vscroll.md) .</span><span class="sxs-lookup"><span data-stu-id="be51a-210">The system sends the request to the specified window in the form of a [**WM\_HSCROLL**](wm-hscroll.md) or [**WM\_VSCROLL**](wm-vscroll.md) message.</span></span> <span data-ttu-id="be51a-211">Горизонтальная полоса прокрутки отправляет сообщение **WM \_ HSCROLL** ; вертикальная полоса прокрутки отправляет сообщение **WM \_ VSCROLL** .</span><span class="sxs-lookup"><span data-stu-id="be51a-211">A horizontal scroll bar sends the **WM\_HSCROLL** message; a vertical scroll bar sends the **WM\_VSCROLL** message.</span></span> <span data-ttu-id="be51a-212">Каждое сообщение содержит код запроса, соответствующий действию пользователя, к маркеру полосы прокрутки (только элементы управления "полоса прокрутки") и, в некоторых случаях, к положению полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-212">Each message includes a request code that corresponds to the user's action, to the handle to the scroll bar (scroll bar controls only), and, in some cases, to the position of the scroll box.</span></span>

<span data-ttu-id="be51a-213">На следующей диаграмме показан код запроса, создаваемый пользователем при щелчке различных частей полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-213">The following diagram shows the request code that the user generates when clicking various parts of a scroll bar.</span></span>

![Схема, показывающая коды запросов, связанные с каждым регионом на двух полосах прокрутки](images/csscr-02.png)

<span data-ttu-id="be51a-215">Значения SB \_ указывают действие, которое принимает пользователь.</span><span class="sxs-lookup"><span data-stu-id="be51a-215">The SB\_ values specify the action the user takes.</span></span> <span data-ttu-id="be51a-216">Приложение проверяет коды, сопровождающие сообщения [**WM \_ HSCROLL**](wm-hscroll.md) и [**WM \_ VSCROLL**](wm-vscroll.md) , а затем выполняет соответствующую операцию прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-216">An application examines the codes that accompany the [**WM\_HSCROLL**](wm-hscroll.md) and [**WM\_VSCROLL**](wm-vscroll.md) messages and then performs the appropriate scrolling operation.</span></span> <span data-ttu-id="be51a-217">В следующей таблице для каждого значения указывается действие пользователя, за которым следует ответ приложения.</span><span class="sxs-lookup"><span data-stu-id="be51a-217">In the following table, the user's action is specified for each value, followed by the application's response.</span></span> <span data-ttu-id="be51a-218">В каждом случае единица определяется приложением соответствующим образом для данных.</span><span class="sxs-lookup"><span data-stu-id="be51a-218">In each case, a unit is defined by the application as appropriate for the data.</span></span> <span data-ttu-id="be51a-219">Например, обычная единица для прокрутки текста по вертикали — это строка текста.</span><span class="sxs-lookup"><span data-stu-id="be51a-219">For example, the typical unit for scrolling text vertically is a line of text.</span></span>



| <span data-ttu-id="be51a-220">Запрос</span><span class="sxs-lookup"><span data-stu-id="be51a-220">Request</span></span>           | <span data-ttu-id="be51a-221">Действие</span><span class="sxs-lookup"><span data-stu-id="be51a-221">Action</span></span>                                                                               | <span data-ttu-id="be51a-222">Ответ</span><span class="sxs-lookup"><span data-stu-id="be51a-222">Response</span></span>                                                                                                                                                                                                                                                                                                                         |
|-------------------|--------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="be51a-223">построителя \_</span><span class="sxs-lookup"><span data-stu-id="be51a-223">SB\_LINEUP</span></span>        | <span data-ttu-id="be51a-224">Пользователь щелкает стрелку с верхней прокруткой.</span><span class="sxs-lookup"><span data-stu-id="be51a-224">The user clicks the top scroll arrow.</span></span>                                                | <span data-ttu-id="be51a-225">Уменьшает значение ползунка полосы прокрутки; выполняет прокрутку к началу данных на одну единицу.</span><span class="sxs-lookup"><span data-stu-id="be51a-225">Decrements the scroll box position; scrolls toward the top of the data by one unit.</span></span>                                                                                                                                                                                                                                              |
| <span data-ttu-id="be51a-226">SB \_ линедовн</span><span class="sxs-lookup"><span data-stu-id="be51a-226">SB\_LINEDOWN</span></span>      | <span data-ttu-id="be51a-227">Пользователь щелкает нижнюю стрелку прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-227">The user clicks the bottom scroll arrow.</span></span>                                             | <span data-ttu-id="be51a-228">Увеличивает расположение ползунка; выполняет прокрутку к концу данных на одну единицу.</span><span class="sxs-lookup"><span data-stu-id="be51a-228">Increments the scroll box position; scrolls toward the bottom of the data by one unit.</span></span>                                                                                                                                                                                                                                           |
| <span data-ttu-id="be51a-229">SB \_ линелефт</span><span class="sxs-lookup"><span data-stu-id="be51a-229">SB\_LINELEFT</span></span>      | <span data-ttu-id="be51a-230">Пользователь щелкает стрелку прокрутки влево.</span><span class="sxs-lookup"><span data-stu-id="be51a-230">The user clicks the left scroll arrow.</span></span>                                               | <span data-ttu-id="be51a-231">Уменьшает значение ползунка полосы прокрутки; выполняет прокрутку к левому концу данных на одну единицу.</span><span class="sxs-lookup"><span data-stu-id="be51a-231">Decrements the scroll box position; scrolls toward the left end of the data by one unit.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="be51a-232">SB \_ линеригхт</span><span class="sxs-lookup"><span data-stu-id="be51a-232">SB\_LINERIGHT</span></span>     | <span data-ttu-id="be51a-233">Пользователь щелкает стрелку вправо.</span><span class="sxs-lookup"><span data-stu-id="be51a-233">The user clicks the right scroll arrow.</span></span>                                              | <span data-ttu-id="be51a-234">Увеличивает расположение ползунка; Прокручивает в сторону правого конца данных на одну единицу.</span><span class="sxs-lookup"><span data-stu-id="be51a-234">Increments the scroll box position; scrolls toward the right end of the data by one unit.</span></span>                                                                                                                                                                                                                                        |
| <span data-ttu-id="be51a-235">SB \_ PageUp</span><span class="sxs-lookup"><span data-stu-id="be51a-235">SB\_PAGEUP</span></span>        | <span data-ttu-id="be51a-236">Пользователь щелкает полосу прокрутки, Шафт над полем прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-236">The user clicks the scroll bar shaft above the scroll box.</span></span>                           | <span data-ttu-id="be51a-237">Уменьшает расположение ползунка на число единиц данных в окне; выполняет прокрутку к началу данных по одинаковому количеству единиц.</span><span class="sxs-lookup"><span data-stu-id="be51a-237">Decrements the scroll box position by the number of data units in the window; scrolls toward the top of the data by the same number of units.</span></span>                                                                                                                                                                                    |
| <span data-ttu-id="be51a-238">SB \_ PageDown</span><span class="sxs-lookup"><span data-stu-id="be51a-238">SB\_PAGEDOWN</span></span>      | <span data-ttu-id="be51a-239">Пользователь щелкает полосу прокрутки Шафт под полем прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-239">The user clicks the scroll bar shaft below the scroll box.</span></span>                           | <span data-ttu-id="be51a-240">Увеличивает значение поля прокрутки на число единиц данных в окне; выполняет прокрутку к концу данных по одинаковому количеству единиц.</span><span class="sxs-lookup"><span data-stu-id="be51a-240">Increments the scroll box position by the number of data units in the window; scrolls toward the bottom of the data by the same number of units.</span></span>                                                                                                                                                                                 |
| <span data-ttu-id="be51a-241">SB \_ пажелефт</span><span class="sxs-lookup"><span data-stu-id="be51a-241">SB\_PAGELEFT</span></span>      | <span data-ttu-id="be51a-242">Пользователь щелкает полосу прокрутки Шафт слева от ползунка.</span><span class="sxs-lookup"><span data-stu-id="be51a-242">The user clicks the scroll bar shaft to the left of the scroll box.</span></span>                  | <span data-ttu-id="be51a-243">Уменьшает расположение ползунка на число единиц данных в окне; выполняет прокрутку к левому концу данных по одинаковому количеству единиц.</span><span class="sxs-lookup"><span data-stu-id="be51a-243">Decrements the scroll box position by the number of data units in the window; scrolls toward the left end of the data by the same number of units.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="be51a-244">SB \_ пажеригхт</span><span class="sxs-lookup"><span data-stu-id="be51a-244">SB\_PAGERIGHT</span></span>     | <span data-ttu-id="be51a-245">Пользователь щелкает полосу прокрутки Шафт справа от ползунка.</span><span class="sxs-lookup"><span data-stu-id="be51a-245">The user clicks the scroll bar shaft to the right of the scroll box.</span></span>                 | <span data-ttu-id="be51a-246">Увеличивает значение поля прокрутки на число единиц данных в окне; Прокручивает к правому концу данных по одинаковому количеству единиц.</span><span class="sxs-lookup"><span data-stu-id="be51a-246">Increments the scroll box position by the number of data units in the window; scrolls toward the right end of the data by the same number of units.</span></span>                                                                                                                                                                              |
| <span data-ttu-id="be51a-247">SB \_ сумбпоситион</span><span class="sxs-lookup"><span data-stu-id="be51a-247">SB\_THUMBPOSITION</span></span> | <span data-ttu-id="be51a-248">Пользователь отпускает поле прокрутки после его перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="be51a-248">The user releases the scroll box after dragging it.</span></span>                                  | <span data-ttu-id="be51a-249">Устанавливает ползунок полосы прокрутки в соответствии с позицией, указанной в сообщении; Прокручивает данные на одно и то же число единиц, перемещенных в ползунок полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-249">Sets the scroll box to the position specified in the message; scrolls the data by the same number of units the scroll box has moved.</span></span>                                                                                                                                                                                             |
| <span data-ttu-id="be51a-250">SB \_ сумбтракк</span><span class="sxs-lookup"><span data-stu-id="be51a-250">SB\_THUMBTRACK</span></span>    | <span data-ttu-id="be51a-251">Пользователь перетаскивает ползунок полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-251">The user drags the scroll box.</span></span>                                                       | <span data-ttu-id="be51a-252">Устанавливает ползунок полосы прокрутки в соответствии с позицией, указанной в сообщении, и прокручивает данные на то же количество единиц, которое прокручивается ползунок, для приложений, которые быстро нарисуют данные.</span><span class="sxs-lookup"><span data-stu-id="be51a-252">Sets the scroll box to the position specified in the message and scrolls the data by the same number of units the scroll box has moved for applications that draw data quickly.</span></span> <span data-ttu-id="be51a-253">Приложения, которые не могут быстро выводить данные, должны ждать \_ код запроса SB сумбпоситион перед перемещением ползунка прокрутки и прокрутки данных.</span><span class="sxs-lookup"><span data-stu-id="be51a-253">Applications that cannot draw data quickly must wait for the SB\_THUMBPOSITION request code before moving the scroll box and scrolling the data.</span></span> |
| <span data-ttu-id="be51a-254">SB \_ ендскролл</span><span class="sxs-lookup"><span data-stu-id="be51a-254">SB\_ENDSCROLL</span></span>     | <span data-ttu-id="be51a-255">Пользователь отпускает мышь после нажатия на стрелку или на полосе прокрутки Шафт.</span><span class="sxs-lookup"><span data-stu-id="be51a-255">The user releases the mouse after holding it on an arrow or in the scroll bar shaft.</span></span> | <span data-ttu-id="be51a-256">Ответ не требуется.</span><span class="sxs-lookup"><span data-stu-id="be51a-256">No response is needed.</span></span>                                                                                                                                                                                                                                                                                                           |



 

<span data-ttu-id="be51a-257">Полоса прокрутки создает \_ код запроса SB сумбпоситион и SB \_ сумбтракк, когда пользователь нажимает и перетаскивает ползунок.</span><span class="sxs-lookup"><span data-stu-id="be51a-257">A scroll bar generates SB\_THUMBPOSITION and SB\_THUMBTRACK request code when the user clicks and drags the scroll box.</span></span> <span data-ttu-id="be51a-258">Приложение должно быть запрограммирован на обработку \_ кода запроса SB сумбтракк или SB \_ сумбпоситион.</span><span class="sxs-lookup"><span data-stu-id="be51a-258">An application should be programmed to process either the SB\_THUMBTRACK or SB\_THUMBPOSITION request code.</span></span>

<span data-ttu-id="be51a-259">\_Код запроса SB сумбпоситион возникает, когда пользователь отпускает кнопку мыши после нажатия кнопки прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-259">The SB\_THUMBPOSITION request code occurs when the user releases the mouse button after clicking the scroll box.</span></span> <span data-ttu-id="be51a-260">Приложение, обрабатывающее это сообщение, выполняет операцию прокрутки после того, как пользователь переместил бегунок в нужную точку и отпустил кнопку мыши.</span><span class="sxs-lookup"><span data-stu-id="be51a-260">An application that processes this message performs the scrolling operation after the user has dragged the scroll box to the desired position and released the mouse button.</span></span>

<span data-ttu-id="be51a-261">\_Код запроса SB сумбтракк возникает, когда пользователь перетаскивает ползунок прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-261">The SB\_THUMBTRACK request code occurs as the user drags the scroll box.</span></span> <span data-ttu-id="be51a-262">Если приложение обрабатывает \_ коды запросов SB сумбтракк, оно может прокручивать содержимое окна, когда пользователь перетаскивает ползунок.</span><span class="sxs-lookup"><span data-stu-id="be51a-262">If an application processes SB\_THUMBTRACK request codes, it can scroll the content of a window as the user drags the scroll box.</span></span> <span data-ttu-id="be51a-263">Однако в течение короткого периода времени полоса прокрутки может создавать много \_ сумбтракк кода запроса SB, поэтому приложение должно обрабатывать эти коды запросов, только если оно может быстро перерисовывать содержимое окна.</span><span class="sxs-lookup"><span data-stu-id="be51a-263">However, a scroll bar can generate many SB\_THUMBTRACK request code in a short period, so an application should process these request codes only if it can quickly repaint the content of the window.</span></span>

## <a name="keyboard-interface-for-a-scroll-bar"></a><span data-ttu-id="be51a-264">Интерфейс клавиатуры для полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-264">Keyboard Interface for a Scroll Bar</span></span>

<span data-ttu-id="be51a-265">Элемент управления "полоса прокрутки" предоставляет встроенный интерфейс клавиатуры, позволяющий пользователю выдавать прокрутку запросов с помощью клавиатуры. Стандартная полоса прокрутки не имеет.</span><span class="sxs-lookup"><span data-stu-id="be51a-265">A scroll bar control provides a built-in keyboard interface that enables the user to issue scrolling requests by using the keyboard; a standard scroll bar does not.</span></span> <span data-ttu-id="be51a-266">Когда элемент управления "полоса прокрутки" имеет фокус клавиатуры, он отправляет сообщения [**WM \_ HSCROLL**](wm-hscroll.md) и [**WM \_ VSCROLL**](wm-vscroll.md) в родительское окно, когда пользователь нажимает клавиши со стрелками.</span><span class="sxs-lookup"><span data-stu-id="be51a-266">When a scroll bar control has the keyboard focus, it sends [**WM\_HSCROLL**](wm-hscroll.md) and [**WM\_VSCROLL**](wm-vscroll.md) messages to its parent window when the user presses the arrow keys.</span></span> <span data-ttu-id="be51a-267">Код запроса отправляется с каждым сообщением, соответствующим клавише со стрелкой, нажатой пользователем.</span><span class="sxs-lookup"><span data-stu-id="be51a-267">The request code is sent with each message corresponding to the arrow key the user has pressed.</span></span> <span data-ttu-id="be51a-268">Ниже приведены клавиши со стрелками и соответствующие коды запросов.</span><span class="sxs-lookup"><span data-stu-id="be51a-268">Following are the arrow keys and their corresponding request codes.</span></span>



| <span data-ttu-id="be51a-269">Клавиша со стрелкой</span><span class="sxs-lookup"><span data-stu-id="be51a-269">Arrow key</span></span> | <span data-ttu-id="be51a-270">Код запроса</span><span class="sxs-lookup"><span data-stu-id="be51a-270">Request code</span></span>                  |
|-----------|-------------------------------|
| <span data-ttu-id="be51a-271">СБОЙ</span><span class="sxs-lookup"><span data-stu-id="be51a-271">DOWN</span></span>      | <span data-ttu-id="be51a-272">SB \_ линедовн или SB \_ линеригхт</span><span class="sxs-lookup"><span data-stu-id="be51a-272">SB\_LINEDOWN or SB\_LINERIGHT</span></span> |
| <span data-ttu-id="be51a-273">END</span><span class="sxs-lookup"><span data-stu-id="be51a-273">END</span></span>       | <span data-ttu-id="be51a-274">SB \_ снизу</span><span class="sxs-lookup"><span data-stu-id="be51a-274">SB\_BOTTOM</span></span>                    |
| <span data-ttu-id="be51a-275">HOME</span><span class="sxs-lookup"><span data-stu-id="be51a-275">HOME</span></span>      | <span data-ttu-id="be51a-276">SB \_ сверху</span><span class="sxs-lookup"><span data-stu-id="be51a-276">SB\_TOP</span></span>                       |
| <span data-ttu-id="be51a-277">LEFT</span><span class="sxs-lookup"><span data-stu-id="be51a-277">LEFT</span></span>      | <span data-ttu-id="be51a-278">SB \_ или SB \_ линелефт</span><span class="sxs-lookup"><span data-stu-id="be51a-278">SB\_LINEUP or SB\_LINELEFT</span></span>    |
| <span data-ttu-id="be51a-279">Page Down</span><span class="sxs-lookup"><span data-stu-id="be51a-279">PGDN</span></span>      | <span data-ttu-id="be51a-280">SB \_ PageDown или SB \_ пажеригхт</span><span class="sxs-lookup"><span data-stu-id="be51a-280">SB\_PAGEDOWN or SB\_PAGERIGHT</span></span> |
| <span data-ttu-id="be51a-281">Page Up</span><span class="sxs-lookup"><span data-stu-id="be51a-281">PGUP</span></span>      | <span data-ttu-id="be51a-282">SB \_ PageUp или SB \_ пажелефт</span><span class="sxs-lookup"><span data-stu-id="be51a-282">SB\_PAGEUP or SB\_PAGELEFT</span></span>    |
| <span data-ttu-id="be51a-283">RIGHT</span><span class="sxs-lookup"><span data-stu-id="be51a-283">RIGHT</span></span>     | <span data-ttu-id="be51a-284">SB \_ линедовн или SB \_ линеригхт</span><span class="sxs-lookup"><span data-stu-id="be51a-284">SB\_LINEDOWN or SB\_LINERIGHT</span></span> |
| <span data-ttu-id="be51a-285">UP</span><span class="sxs-lookup"><span data-stu-id="be51a-285">UP</span></span>        | <span data-ttu-id="be51a-286">SB \_ или SB \_ линелефт</span><span class="sxs-lookup"><span data-stu-id="be51a-286">SB\_LINEUP or SB\_LINELEFT</span></span>    |



 

 

> [!Note]  
> <span data-ttu-id="be51a-287">Интерфейс клавиатуры элемента управления "полоса прокрутки" отправляет \_ коды запросов верхнего и SB- \_ нижней части SB.</span><span class="sxs-lookup"><span data-stu-id="be51a-287">The keyboard interface of a scroll bar control sends the SB\_TOP and SB\_BOTTOM request codes.</span></span> <span data-ttu-id="be51a-288">\_Код запроса SB Top указывает, что пользователь достиг верхнего значения диапазона прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-288">The SB\_TOP request code indicates that the user has reached the top value of the scrolling range.</span></span> <span data-ttu-id="be51a-289">Приложение прокручивает содержимое окна вниз, чтобы отобразить верхнюю часть объекта данных.</span><span class="sxs-lookup"><span data-stu-id="be51a-289">An application scrolls the window content downward so that the top of the data object is visible.</span></span> <span data-ttu-id="be51a-290">\_Код запроса SB Bottom указывает, что пользователь достиг нижнего значения диапазона прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-290">The SB\_BOTTOM request code indicates that the user has reached the bottom value of the scrolling range.</span></span> <span data-ttu-id="be51a-291">Если приложение обрабатывает \_ код запроса с самым нижним периодом, он прокручивает содержимое окна вверх, чтобы было видно, что нижняя часть объекта данных является видимой.</span><span class="sxs-lookup"><span data-stu-id="be51a-291">If an application processes the SB\_BOTTOM request code, it scrolls the window content upward so that the bottom of the data object is visible.</span></span>

 

<span data-ttu-id="be51a-292">Если вам нужен интерфейс клавиатуры для стандартной полосы прокрутки, можно создать его самостоятельно, обрабатывая сообщение [**WM \_ KeyDown**](/windows/desktop/inputdev/wm-keydown) в процедуре окна, а затем выполнить соответствующее действие прокрутки на основе кода виртуального ключа, сопровождающего сообщение.</span><span class="sxs-lookup"><span data-stu-id="be51a-292">If you want a keyboard interface for a standard scroll bar, you can create one yourself by processing the [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) message in your window procedure and then performing the appropriate scrolling action based on the virtual-key code that accompanies the message.</span></span> <span data-ttu-id="be51a-293">Сведения о создании интерфейса клавиатуры для полосы прокрутки см. в разделе [Создание интерфейса клавиатуры для стандартной полосы прокрутки](using-scroll-bars.md).</span><span class="sxs-lookup"><span data-stu-id="be51a-293">For information about how to create a keyboard interface for a scroll bar, see [Creating a Keyboard Interface for a Standard Scroll Bar](using-scroll-bars.md).</span></span>

## <a name="scrolling-the-client-area"></a><span data-ttu-id="be51a-294">Прокрутка клиентской области</span><span class="sxs-lookup"><span data-stu-id="be51a-294">Scrolling the Client Area</span></span>

<span data-ttu-id="be51a-295">Самый простой способ прокрутить содержимое клиентской области — стереть его, а затем перерисовать.</span><span class="sxs-lookup"><span data-stu-id="be51a-295">The simplest way to scroll the content of a client area is to erase and then redraw it.</span></span> <span data-ttu-id="be51a-296">Это метод, который приложение может использовать с \_ кодами запросов SB PageUp, SB \_ PageDown и SB \_ Top, для которых обычно требуется совершенно новое содержимое.</span><span class="sxs-lookup"><span data-stu-id="be51a-296">This is the method an application is likely to use with SB\_PAGEUP, SB\_PAGEDOWN, and SB\_TOP request codes, which typically require completely new content.</span></span>

<span data-ttu-id="be51a-297">Для некоторых кодов запросов, например SB- \_ линедовн и SB \_ , не все содержимое должно быть стерто, поскольку после прокрутки они остаются видимыми.</span><span class="sxs-lookup"><span data-stu-id="be51a-297">For some request codes, such as SB\_LINEUP and SB\_LINEDOWN, not all the content need be erased, because some remains visible after scrolling occurs.</span></span> <span data-ttu-id="be51a-298">Функция [**скроллвиндовекс**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex) сохраняет часть содержимого клиентской области, перемещает сохраненную часть на заданный объем, а затем подготавливает оставшуюся часть клиентской области для рисования новых данных.</span><span class="sxs-lookup"><span data-stu-id="be51a-298">The [**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex) function preserves a portion of the client area's content, moves the preserved portion a specified amount, and then prepares the rest of the client area for painting new information.</span></span> <span data-ttu-id="be51a-299">**Скроллвиндовекс** использует функцию [**BitBlt**](/windows/desktop/api/wingdi/nf-wingdi-bitblt) для перемещения определенной части объекта данных в новое место в клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-299">**ScrollWindowEx** uses the [**BitBlt**](/windows/desktop/api/wingdi/nf-wingdi-bitblt) function to move a specific part of the data object to a new location within the client area.</span></span> <span data-ttu-id="be51a-300">Любая непокрытая часть клиентской области (что не сохраняется) становится недействительной, стерта и окрашена при возникновении следующего сообщения [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) .</span><span class="sxs-lookup"><span data-stu-id="be51a-300">Any uncovered part of the client area (anything not preserved) is invalidated, erased, and painted when the next [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message occurs.</span></span>

<span data-ttu-id="be51a-301">Функцию [**скроллвиндовекс**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex) можно использовать для исключения части клиентской области из операции прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-301">The [**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex) function can be used to exclude a portion of the client area from the scrolling operation.</span></span> <span data-ttu-id="be51a-302">Это позволяет сохранять элементы с фиксированными положениями, например дочерними окнами, от перемещения в клиентской области.</span><span class="sxs-lookup"><span data-stu-id="be51a-302">This keeps items with fixed positions, such as child windows, from moving within the client area.</span></span> <span data-ttu-id="be51a-303">Он автоматически делает недействительную часть клиентской области, которая должна получить новую информацию, поэтому приложению не нужно вычислять собственные области отсечения.</span><span class="sxs-lookup"><span data-stu-id="be51a-303">It automatically invalidates the portion of the client area that is to receive the new information, so the application does not have to compute its own clipping regions.</span></span> <span data-ttu-id="be51a-304">Дополнительные сведения об отсечении см. в разделе [Обрезка](/windows/desktop/gdi/clipping).</span><span class="sxs-lookup"><span data-stu-id="be51a-304">For more information on clipping, see [Clipping](/windows/desktop/gdi/clipping).</span></span>

<span data-ttu-id="be51a-305">Обычно приложение прокручивает содержимое окна в направлении, противоположном указанному полосой прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-305">Usually an application scrolls the content of a window in the direction opposite that indicated by the scroll bar.</span></span> <span data-ttu-id="be51a-306">Например, когда пользователь щелкает полосу прокрутки Шафт в области под полем прокрутки, приложение прокручивает объект в окне вверх, чтобы отобразить часть объекта, которая находится ниже видимой части.</span><span class="sxs-lookup"><span data-stu-id="be51a-306">For example, when the user clicks the scroll bar shaft in the area below the scroll box, an application scrolls the object in the window upward to reveal a portion of the object that is below the visible portion.</span></span>

<span data-ttu-id="be51a-307">Можно также прокручивать прямоугольную область с помощью функции [**скроллдк**](/windows/desktop/api/Winuser/nf-winuser-scrolldc) .</span><span class="sxs-lookup"><span data-stu-id="be51a-307">You can also scroll a rectangular region using the [**ScrollDC**](/windows/desktop/api/Winuser/nf-winuser-scrolldc) function.</span></span>

## <a name="scroll-bar-colors-and-metrics"></a><span data-ttu-id="be51a-308">Цвета и метрики полосы прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-308">Scroll Bar Colors and Metrics</span></span>

<span data-ttu-id="be51a-309">Определяемое системой значение цвета, ЦВЕТовая \_ полоса прокрутки управляет цветом в Шафт полосе.</span><span class="sxs-lookup"><span data-stu-id="be51a-309">The system-defined color value, COLOR\_SCROLLBAR, controls the color within a scroll bar shaft.</span></span> <span data-ttu-id="be51a-310">Используйте функцию [**жетсисколор**](/windows/desktop/api/winuser/nf-winuser-getsyscolor) для определения цвета полосы прокрутки Шафт и функции [**сетсисколорс**](/windows/desktop/api/winuser/nf-winuser-setsyscolors) , чтобы задать цвет полосы прокрутки Шафт.</span><span class="sxs-lookup"><span data-stu-id="be51a-310">Use the [**GetSysColor**](/windows/desktop/api/winuser/nf-winuser-getsyscolor) function to determine the color of the scroll bar shaft and the [**SetSysColors**](/windows/desktop/api/winuser/nf-winuser-setsyscolors) function to set the color of the scroll bar shaft.</span></span> <span data-ttu-id="be51a-311">Однако обратите внимание, что это изменение цвета влияет на все полосы прокрутки в системе.</span><span class="sxs-lookup"><span data-stu-id="be51a-311">Note, however, that this change of color affects all scroll bars in the system.</span></span>

<span data-ttu-id="be51a-312">Можно получить размеры растровых изображений, которые система использует в стандартных полосах прокрутки, вызвав функцию [**жетсистемметрикс**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) .</span><span class="sxs-lookup"><span data-stu-id="be51a-312">You can get the dimensions of the bitmaps that the system uses in standard scroll bars by calling the [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) function.</span></span> <span data-ttu-id="be51a-313">Ниже приведены значения системных метрик, связанных с полосами прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-313">Following are the system metric values associated with scroll bars.</span></span>



| <span data-ttu-id="be51a-314">Метрика системы</span><span class="sxs-lookup"><span data-stu-id="be51a-314">System metric</span></span> | <span data-ttu-id="be51a-315">Описание</span><span class="sxs-lookup"><span data-stu-id="be51a-315">Description</span></span>                                                                                                                |
|---------------|----------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="be51a-316">SM \_ кксхскролл</span><span class="sxs-lookup"><span data-stu-id="be51a-316">SM\_CXHSCROLL</span></span> | <span data-ttu-id="be51a-317">Ширина растрового изображения стрелки на горизонтальной полосе прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-317">Width of arrow bitmap on horizontal scroll bar</span></span>                                                                             |
| <span data-ttu-id="be51a-318">SM \_ кксхсумб</span><span class="sxs-lookup"><span data-stu-id="be51a-318">SM\_CXHTHUMB</span></span>  | <span data-ttu-id="be51a-319">Ширина ползунка на горизонтальной полосе прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-319">Width of scroll box on horizontal scroll bar.</span></span> <span data-ttu-id="be51a-320">Это значение получает ширину полосы прокрутки с нулевым размером страницы.</span><span class="sxs-lookup"><span data-stu-id="be51a-320">This value retrieves the width a scroll bar that has a page size of zero.</span></span>    |
| <span data-ttu-id="be51a-321">SM \_ кксвскролл</span><span class="sxs-lookup"><span data-stu-id="be51a-321">SM\_CXVSCROLL</span></span> | <span data-ttu-id="be51a-322">Ширина растрового изображения стрелки на вертикальной полосе прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-322">Width of arrow bitmap on vertical scroll bar</span></span>                                                                               |
| <span data-ttu-id="be51a-323">SM \_ цихскролл</span><span class="sxs-lookup"><span data-stu-id="be51a-323">SM\_CYHSCROLL</span></span> | <span data-ttu-id="be51a-324">Высота изображения стрелки на горизонтальной полосе прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-324">Height of arrow bitmap on horizontal scroll bar</span></span>                                                                            |
| <span data-ttu-id="be51a-325">SM \_ цивскролл</span><span class="sxs-lookup"><span data-stu-id="be51a-325">SM\_CYVSCROLL</span></span> | <span data-ttu-id="be51a-326">Высота растрового изображения стрелки на вертикальной полосе прокрутки</span><span class="sxs-lookup"><span data-stu-id="be51a-326">Height of arrow bitmap on vertical scroll bar</span></span>                                                                              |
| <span data-ttu-id="be51a-327">SM \_ цивсумб</span><span class="sxs-lookup"><span data-stu-id="be51a-327">SM\_CYVTHUMB</span></span>  | <span data-ttu-id="be51a-328">Высота поля прокрутки на вертикальной полосе прокрутки.</span><span class="sxs-lookup"><span data-stu-id="be51a-328">Height of scroll box on vertical scroll bar.</span></span> <span data-ttu-id="be51a-329">Это значение Получает высоту полосы прокрутки с нулевым размером страницы.</span><span class="sxs-lookup"><span data-stu-id="be51a-329">This value retrieves the height of a scroll bar that has a page size of zero.</span></span> |



 

 

 