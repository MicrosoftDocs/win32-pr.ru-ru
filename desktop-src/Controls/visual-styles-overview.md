---
title: Общие сведения о визуальных стилях
description: В этом разделе описываются стили оформления и определяются компоненты Windows, которые их поддерживают. Здесь также объясняются действия, которые необходимо выполнить для использования стилей оформления в приложениях.
ms.assetid: 5B5D7BB6-684F-478D-BF5F-B8D18BBCFF2E
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5663730c752fbf16c4f229a031eafa0c65bb9dbb
ms.sourcegitcommit: a716ca2a6a22a400f02c6b31699cf4da83ee3619
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2020
ms.locfileid: "104488559"
---
# <a name="visual-styles-overview"></a><span data-ttu-id="6589b-104">Общие сведения о визуальных стилях</span><span class="sxs-lookup"><span data-stu-id="6589b-104">Visual Styles Overview</span></span>

<span data-ttu-id="6589b-105">В этом разделе описываются стили оформления и определяются компоненты Windows, которые их поддерживают.</span><span class="sxs-lookup"><span data-stu-id="6589b-105">This topic describes visual styles and identifies the Windows components that support them.</span></span> <span data-ttu-id="6589b-106">Здесь также объясняются действия, которые необходимо выполнить для использования стилей оформления в приложениях.</span><span class="sxs-lookup"><span data-stu-id="6589b-106">It also explains the steps you must take to use visual styles in your applications.</span></span> <span data-ttu-id="6589b-107">Этот раздел включает следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="6589b-107">This topic includes the following sections:</span></span>

-   [<span data-ttu-id="6589b-108">Темы и визуальные стили</span><span class="sxs-lookup"><span data-stu-id="6589b-108">Themes and Visual Styles</span></span>](#themes-and-visual-styles)
-   [<span data-ttu-id="6589b-109">Компоненты визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="6589b-109">Visual Styles Components</span></span>](#visual-styles-components)
-   [<span data-ttu-id="6589b-110">Требования к приложениям для поддержки визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="6589b-110">Application Requirements for Supporting Visual Styles</span></span>](#application-requirements-for-supporting-visual-styles)
-   [<span data-ttu-id="6589b-111">См. также</span><span class="sxs-lookup"><span data-stu-id="6589b-111">Related topics</span></span>](#related-topics)

## <a name="themes-and-visual-styles"></a><span data-ttu-id="6589b-112">Темы и визуальные стили</span><span class="sxs-lookup"><span data-stu-id="6589b-112">Themes and Visual Styles</span></span>

<span data-ttu-id="6589b-113">В состав Windows входит несколько функций, позволяющих пользователям настраивать пользовательский интерфейс в соответствии с индивидуальными потребностями и предпочтениями.</span><span class="sxs-lookup"><span data-stu-id="6589b-113">Windows includes several features that enable users to tailor the UI to accommodate their individual needs and preferences.</span></span> <span data-ttu-id="6589b-114">Эти функции включают темы, появившиеся в Microsoft Plus!.</span><span class="sxs-lookup"><span data-stu-id="6589b-114">These features include themes, which were introduced in Microsoft Plus!</span></span> <span data-ttu-id="6589b-115">для Windows 95.</span><span class="sxs-lookup"><span data-stu-id="6589b-115">for Windows 95.</span></span> <span data-ttu-id="6589b-116">Тема — это Выбираемая пользователем коллекция параметров, включающая фоновый рисунок, курсоры, шрифты, звуки и значки.</span><span class="sxs-lookup"><span data-stu-id="6589b-116">A theme is a user-selectable collection of settings that includes wallpaper, cursors, fonts, sounds, and icons.</span></span> <span data-ttu-id="6589b-117">Ниже приведены некоторые характеристики тем.</span><span class="sxs-lookup"><span data-stu-id="6589b-117">The following are some characteristics of themes.</span></span>

-   <span data-ttu-id="6589b-118">Параметры темы указываются в файлах Theme, имеющих формат, аналогичный win.ini файлам.</span><span class="sxs-lookup"><span data-stu-id="6589b-118">Theme settings are specified in .theme files that have a format similar to win.ini files.</span></span>
-   <span data-ttu-id="6589b-119">Независимый поставщик программного обеспечения (ISV) может создать и распространить файл Theme с помощью продукта.</span><span class="sxs-lookup"><span data-stu-id="6589b-119">An independent software vendor (ISV) can create and distribute a .theme file with a product.</span></span>
-   <span data-ttu-id="6589b-120">В версиях, предшествующих Windows Vista, файлы темы отображаются на вкладке тема панели управления.</span><span class="sxs-lookup"><span data-stu-id="6589b-120">In versions earlier than Windows Vista, theme files are displayed on the Theme tab of the Display control panel.</span></span> <span data-ttu-id="6589b-121">В Windows Vista и более поздних версиях темы отображаются на панели управления персонализацией.</span><span class="sxs-lookup"><span data-stu-id="6589b-121">In Windows Vista and later, themes are displayed in the Personalization control panel.</span></span>

<span data-ttu-id="6589b-122">Дополнительные сведения о файлах Theme см. в разделе [Формат файла темы](themesfileformat-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6589b-122">For more information about .theme files, see [Theme File Format](themesfileformat-overview.md).</span></span>

<span data-ttu-id="6589b-123">Визуальный стиль — это спецификация, определяющая внешний вид стандартных элементов управления Windows.</span><span class="sxs-lookup"><span data-stu-id="6589b-123">A visual style is a specification that defines the appearance of the Windows common controls.</span></span> <span data-ttu-id="6589b-124">Визуальные стили связаны с темами; то есть файл Theme содержит раздел, в котором указывается визуальный стиль, применяемый при активной теме.</span><span class="sxs-lookup"><span data-stu-id="6589b-124">Visual styles are associated with themes; that is, a .theme file contains a section that specifies the visual style to apply when the particular theme is active.</span></span> <span data-ttu-id="6589b-125">Ниже приведены некоторые характеристики визуальных стилей.</span><span class="sxs-lookup"><span data-stu-id="6589b-125">The following are some characteristics of visual styles.</span></span>

-   <span data-ttu-id="6589b-126">Пользователи могут изменить визуальный стиль в любое время, выбрав другую тему.</span><span class="sxs-lookup"><span data-stu-id="6589b-126">Users can change the visual style at any time by selecting a different theme.</span></span>
-   <span data-ttu-id="6589b-127">Необходимо использовать API визуальных стилей, чтобы применить текущий активный визуальный стиль к пользовательским элементам управления или рисуемым владельцем приложения, если таковые имеются.</span><span class="sxs-lookup"><span data-stu-id="6589b-127">You must use the visual styles API to apply the currently active visual style to your application's custom or owner-drawn controls, if any.</span></span>
-   <span data-ttu-id="6589b-128">Сведения, определяющие визуальный стиль, хранятся в мсстилес-файле.</span><span class="sxs-lookup"><span data-stu-id="6589b-128">The information that defines a visual style is stored in a .msstyles file.</span></span> <span data-ttu-id="6589b-129">Корпорация Майкрософт не поддерживает создание мсстилес файлов.</span><span class="sxs-lookup"><span data-stu-id="6589b-129">Microsoft does not support the authoring of .msstyles files.</span></span>


<span data-ttu-id="6589b-130">На следующем рисунке показано простое диалоговое окно с панелью задач на рабочем столе Windows 7, использующей тему Windows Aero без прозрачности.</span><span class="sxs-lookup"><span data-stu-id="6589b-130">The following illustration shows a simple dialog box with a taskbar, on a Windows 7 desktop that uses the Windows Aero theme without transparency.</span></span> <span data-ttu-id="6589b-131">Так как приложение не настроено для использования стилей оформления, кнопки отображаются одинаково независимо от параметров темы.</span><span class="sxs-lookup"><span data-stu-id="6589b-131">Because the application is not configured to use visual styles, the buttons appear the same regardless of the theme settings.</span></span>

![снимок экрана с диалоговым окном с кнопками, которые не используют прозрачность](images/tb-wostyles.png)

<span data-ttu-id="6589b-133">На следующем рисунке показано одно и то же диалоговое окно на том же рабочем столе, но на этот раз приложение настроено для работы с визуальными стилями.</span><span class="sxs-lookup"><span data-stu-id="6589b-133">In contrast, the following illustration shows the same dialog box on the same desktop, but this time the application has been configured to work with visual styles.</span></span> <span data-ttu-id="6589b-134">Обратите внимание на различные внешний вид кнопок в клиентской области.</span><span class="sxs-lookup"><span data-stu-id="6589b-134">Note the different appearance of the buttons in the client area.</span></span> <span data-ttu-id="6589b-135">Кнопки выглядят иначе, поскольку система применяет визуальные стили, определенные в теме Aero.</span><span class="sxs-lookup"><span data-stu-id="6589b-135">The buttons look different because the system has applied the visual styles that are defined in the Aero theme.</span></span>

![снимок экрана с диалоговым окном с кнопками, использующими прозрачность](images/tb-withstyles.png)

<span data-ttu-id="6589b-137">В следующем примере показано аналогичное диалоговое окно на рабочем столе Windows 8.</span><span class="sxs-lookup"><span data-stu-id="6589b-137">The following example shows a similar dialog box on a Windows 8 desktop.</span></span> <span data-ttu-id="6589b-138">В Windows 8 стили оформления всегда включены, поэтому приложения Windows 8 получают их «бесплатно».</span><span class="sxs-lookup"><span data-stu-id="6589b-138">In Windows 8, visual styles are always on, so Windows 8 apps get theming "for free".</span></span>

![снимок экрана простого диалогового окна на рабочем столе Windows 8](images/tb-win8.png)

## <a name="visual-styles-components"></a><span data-ttu-id="6589b-140">Компоненты визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="6589b-140">Visual Styles Components</span></span>

<span data-ttu-id="6589b-141">Стили оформления поддерживаются следующими компонентами:</span><span class="sxs-lookup"><span data-stu-id="6589b-141">Visual styles are supported by the following components:</span></span>

-   <span data-ttu-id="6589b-142">Версия 6 или более поздняя версия библиотеки общих элементов управления (ComCtl32.dll)</span><span class="sxs-lookup"><span data-stu-id="6589b-142">Version 6 or later of the common control library (ComCtl32.dll)</span></span>
-   <span data-ttu-id="6589b-143">API визуальных стилей, реализованный в UxTheme.dll</span><span class="sxs-lookup"><span data-stu-id="6589b-143">The visual styles API implemented in UxTheme.dll</span></span>
-   <span data-ttu-id="6589b-144">Служба "темы"</span><span class="sxs-lookup"><span data-stu-id="6589b-144">Themes service</span></span>
-   <span data-ttu-id="6589b-145">Один или несколько файлов определения стиля оформления (. мсстилес)</span><span class="sxs-lookup"><span data-stu-id="6589b-145">One or more visual style definition files (.msstyles)</span></span>

<span data-ttu-id="6589b-146">API визуальных стилей зависит от системной службы, именуемой темами.</span><span class="sxs-lookup"><span data-stu-id="6589b-146">The visual styles API depends on a system service called Themes.</span></span> <span data-ttu-id="6589b-147">Общая библиотека элементов управления запрашивает у службы "темы" получение сведений о стиле и, вплоть до Windows 7, использует службу для отрисовки элементов управления в текущем визуальном стиле.</span><span class="sxs-lookup"><span data-stu-id="6589b-147">The common control library queries the Themes service to get style-related information and, up through Windows 7, uses the service to render controls in the current visual style.</span></span>

<span data-ttu-id="6589b-148">В Windows 8 и более поздних версиях API визуальных стилей по-прежнему работает, если служба "темы" отключена.</span><span class="sxs-lookup"><span data-stu-id="6589b-148">In Windows 8 and later, the visual styles API still works if the Themes service is off.</span></span> <span data-ttu-id="6589b-149">Это означает, что стандартные элементы управления и неклиентская область Windows по-прежнему будут иметь стили оформления, если служба "темы" отключена.</span><span class="sxs-lookup"><span data-stu-id="6589b-149">This means that the common controls and the non-client area of windows will still have visual styles when the Themes service is off.</span></span> <span data-ttu-id="6589b-150">Компоненты Windows 8, которые по-прежнему нуждаются в службе "темы", включают:</span><span class="sxs-lookup"><span data-stu-id="6589b-150">The Windows 8 features that still require the Themes service include:</span></span>

-   <span data-ttu-id="6589b-151">Изменение стиля оформления, обычно через страницу **персонализации** **параметров ПК**.</span><span class="sxs-lookup"><span data-stu-id="6589b-151">Changing the visual style, typically through the **Personalization** page of **PC Settings**.</span></span>
-   <span data-ttu-id="6589b-152">Оптимизация производительности, связанная с переключением пользователей, выходом из системы, завершением работы и обменом данными между пользовательскими сеансами.</span><span class="sxs-lookup"><span data-stu-id="6589b-152">Performance optimizations involved in switching users, logging off, shutting down, and sharing across user sessions.</span></span>

<span data-ttu-id="6589b-153">API визуальных стилей получает сведения о стиле из файла мсстилес, связанного с текущей выбранной темой.</span><span class="sxs-lookup"><span data-stu-id="6589b-153">The visual styles API gets style information from the .msstyles file associated with the currently selected theme.</span></span> <span data-ttu-id="6589b-154">Файл. мсстилес содержит набор метрик, шрифтов, цветов и точечных рисунков, определяющих визуальный стиль.</span><span class="sxs-lookup"><span data-stu-id="6589b-154">The .msstyles file contains a set of metrics, fonts, colors, and bitmaps that define a visual style</span></span>

## <a name="application-requirements-for-supporting-visual-styles"></a><span data-ttu-id="6589b-155">Требования к приложениям для поддержки визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="6589b-155">Application Requirements for Supporting Visual Styles</span></span>

<span data-ttu-id="6589b-156">Чтобы использовать стили оформления, приложение должно работать под управлением операционной системы, содержащей ComCtl32.dll версии 6 или более поздней.</span><span class="sxs-lookup"><span data-stu-id="6589b-156">To use visual styles, your application must be running on an operating system that contains ComCtl32.dll version 6 or later.</span></span> <span data-ttu-id="6589b-157">Если вы хотите, чтобы приложение использовало ComCtl32.dll версии 6, необходимо добавить манифест приложения или директиву компилятора, чтобы указать, что следует использовать версию 6, если она доступна.</span><span class="sxs-lookup"><span data-stu-id="6589b-157">If you want your application to use ComCtl32.dll version 6, you must add an application manifest or compiler directive to specify that version 6 should be used if it is available.</span></span> <span data-ttu-id="6589b-158">Сведения о создании манифеста приложения, позволяющего использовать стили оформления в приложении, см. в разделе [Включение визуальных стилей](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6589b-158">For information on how to create an application manifest that enables your application to use visual styles, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

<span data-ttu-id="6589b-159">Для стандартных элементов управления никаких дополнительных действий не требуется, чтобы обеспечить отображение элементов управления в предпочитаемом визуальном стиле пользователя.</span><span class="sxs-lookup"><span data-stu-id="6589b-159">For common controls, no further action is necessary to ensure that the controls are displayed in the user's preferred visual style.</span></span>

<span data-ttu-id="6589b-160">Если приложение содержит настраиваемые или рисуемые пользователем элементы управления, необходимо использовать API визуальных стилей для получения сведений о текущем активном визуальном стиле, а также для рисования элементов управления в этом стиле.</span><span class="sxs-lookup"><span data-stu-id="6589b-160">If your application contains custom or owner-drawn controls, you need to use the visual styles API to retrieve information about the currently active visual style, and to draw the controls in that style.</span></span>

<span data-ttu-id="6589b-161">Для версий Windows, предшествовавших Windows 8, приложениям, как правило, необходимо предоставить два отдельных пути кода для рисования пользовательских и рисуемых пользователем элементов управления.</span><span class="sxs-lookup"><span data-stu-id="6589b-161">For Windows versions prior to Windows 8, applications typically need to provide two separate code paths for drawing custom and owner-drawn controls.</span></span> <span data-ttu-id="6589b-162">Один путь к коду рисует элементы управления, когда тема, использующая стили оформления, активна, а другой путь к коду рисует элементы управления, когда активна классическая тема Windows или тема с высокой контрастностью.</span><span class="sxs-lookup"><span data-stu-id="6589b-162">One code path draws the controls when a theme that uses visual styles is active, and another code path draws the controls when the Windows Classic theme or a high contrast theme is active.</span></span> <span data-ttu-id="6589b-163">Однако в Windows 8 визуальные стили всегда включены, поэтому Разделяйте пути кода не нужны.</span><span class="sxs-lookup"><span data-stu-id="6589b-163">In Windows 8, however, visual styles are always on, so separate theming code paths are not needed.</span></span> <span data-ttu-id="6589b-164">Приложения, которые обрабатываются для Windows 8, получают высокую контрастность в "бесплатно".</span><span class="sxs-lookup"><span data-stu-id="6589b-164">Applications that are manifested for Windows 8 get high contrast theming "for free."</span></span> <span data-ttu-id="6589b-165">Дополнительные сведения см. в разделе [Поддержка тем высокая контрастность](supporting-high-contrast-themes.md).</span><span class="sxs-lookup"><span data-stu-id="6589b-165">For more information, see [Supporting High Contrast Themes](supporting-high-contrast-themes.md).</span></span>

<span data-ttu-id="6589b-166">Дополнительные сведения о см. в разделе [Использование стилей оформления с пользовательскими и Owner-Drawn элементами управления](using-visual-styles.md) и [справочником по визуальным стилям](uxctl-ref.md).</span><span class="sxs-lookup"><span data-stu-id="6589b-166">For more information about, see [Using Visual Styles with Custom and Owner-Drawn Controls](using-visual-styles.md) and [Visual Styles Reference](uxctl-ref.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="6589b-167">См. также</span><span class="sxs-lookup"><span data-stu-id="6589b-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6589b-168">Стили оформления</span><span class="sxs-lookup"><span data-stu-id="6589b-168">Visual Styles</span></span>](themes-overview.md)
</dt> </dl>

 

 




