---
title: Об элементах управления анимацией
description: Элемент управления "анимация" — это окно, в котором отображается изображение Audio-Video с чередованием (AVI). Ролик AVI — это ряд кадров точечного рисунка, например фильм. Элементы управления "анимация" могут отображать только AVI, не содержащие звук.
ms.assetid: 6be69d1a-5b2c-41d5-b6d7-e86ddac2cb0d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625828e5f4febce7314da365c9db93ce3a07136
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105654385"
---
# <a name="about-animation-controls"></a><span data-ttu-id="e8edb-105">Об элементах управления анимацией</span><span class="sxs-lookup"><span data-stu-id="e8edb-105">About Animation Controls</span></span>

<span data-ttu-id="e8edb-106">*Элемент управления "анимация* " — это окно, в котором отображается изображение Audio-Video с чередованием (AVI).</span><span class="sxs-lookup"><span data-stu-id="e8edb-106">An *animation control* is a window that displays an Audio-Video Interleaved (AVI) clip.</span></span> <span data-ttu-id="e8edb-107">Ролик AVI — это ряд кадров точечного рисунка, например фильм.</span><span class="sxs-lookup"><span data-stu-id="e8edb-107">An AVI clip is a series of bitmap frames like a movie.</span></span> <span data-ttu-id="e8edb-108">Элементы управления "анимация" могут отображать только AVI, не содержащие звук.</span><span class="sxs-lookup"><span data-stu-id="e8edb-108">Animation controls can only display AVI clips that do not contain audio.</span></span>

<span data-ttu-id="e8edb-109">Одним из распространенных способов использования элемента управления анимации является указание активности системы во время длительной операции.</span><span class="sxs-lookup"><span data-stu-id="e8edb-109">One common use for an animation control is to indicate system activity during a lengthy operation.</span></span> <span data-ttu-id="e8edb-110">Это возможно потому, что поток операций продолжит выполнение во время отображения AVI-клипа.</span><span class="sxs-lookup"><span data-stu-id="e8edb-110">This is possible because the operation thread continues executing while the AVI clip is displayed.</span></span> <span data-ttu-id="e8edb-111">Например, диалоговое окно Поиск в проводнике Windows отображает движущийся увеличительное стекло по мере того, как система осуществляет поиск файла.</span><span class="sxs-lookup"><span data-stu-id="e8edb-111">For example, the Find dialog box of Windows Explorer displays a moving magnifying glass as the system searches for a file.</span></span>

> [!Note]  
> <span data-ttu-id="e8edb-112">Если используется ComCtl32.dll версии 6, поток не поддерживается. Убедитесь, что приложение не блокирует пользовательский интерфейс, иначе анимация не будет выполняться.</span><span class="sxs-lookup"><span data-stu-id="e8edb-112">If you are using ComCtl32.dll version 6 the thread is not supported; make sure that your application does not block the UI, or else the animation will not occur.</span></span>

 

<span data-ttu-id="e8edb-113">Элемент управления "анимация" может отображать ролик AVI, исходящий из несжатого AVI-файла, или из AVI-файла, который был сжат с помощью кодирования длины выполнения (BI \_ RLE8).</span><span class="sxs-lookup"><span data-stu-id="e8edb-113">An animation control can display an AVI clip originating from either an uncompressed AVI file or from an AVI file that was compressed using run-length (BI\_RLE8) encoding.</span></span> <span data-ttu-id="e8edb-114">Можно добавить ролик AVI в приложение в виде AVI-ресурса, или клип может сопровождать ваше приложение как отдельный файл AVI.</span><span class="sxs-lookup"><span data-stu-id="e8edb-114">You can add the AVI clip to your application as an AVI resource, or the clip can accompany your application as a separate AVI file.</span></span>

> [!Note]  
> <span data-ttu-id="e8edb-115">Файл AVI или Resource не должен иметь звуковой канал.</span><span class="sxs-lookup"><span data-stu-id="e8edb-115">The AVI file, or resource, must not have a sound channel.</span></span> <span data-ttu-id="e8edb-116">Возможности элемента управления анимации очень ограничены и могут изменяться.</span><span class="sxs-lookup"><span data-stu-id="e8edb-116">The capabilities of the animation control are very limited and are subject to change.</span></span> <span data-ttu-id="e8edb-117">Если требуется элемент управления для обеспечения возможности воспроизведения и записи мультимедийных файлов для приложения, можно использовать элемент управления МЦивнд.</span><span class="sxs-lookup"><span data-stu-id="e8edb-117">If you need a control to provide multimedia playback and recording capabilities for your application, you can use the MCIWnd control.</span></span> <span data-ttu-id="e8edb-118">Дополнительные сведения см. в разделе [класс окна мЦивнд](/windows/desktop/Multimedia/mciwnd-window-class).</span><span class="sxs-lookup"><span data-stu-id="e8edb-118">For more information, see [MCIWnd Window Class](/windows/desktop/Multimedia/mciwnd-window-class).</span></span>

 

<span data-ttu-id="e8edb-119">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="e8edb-119">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="e8edb-120">Создание элемента управления анимацией</span><span class="sxs-lookup"><span data-stu-id="e8edb-120">Animation Control Creation</span></span>](#animation-control-creation)
-   [<span data-ttu-id="e8edb-121">Об управляющих сообщениях анимации</span><span class="sxs-lookup"><span data-stu-id="e8edb-121">About Animation Control Messages</span></span>](#about-animation-control-messages)
-   [<span data-ttu-id="e8edb-122">Обработка сообщений по умолчанию</span><span class="sxs-lookup"><span data-stu-id="e8edb-122">Default Message Processing</span></span>](#default-message-processing)

## <a name="animation-control-creation"></a><span data-ttu-id="e8edb-123">Создание элемента управления анимацией</span><span class="sxs-lookup"><span data-stu-id="e8edb-123">Animation Control Creation</span></span>

<span data-ttu-id="e8edb-124">Элемент управления "анимация" принадлежит классу окна " [**анимировать \_ класс**](common-control-window-classes.md) ".</span><span class="sxs-lookup"><span data-stu-id="e8edb-124">An animation control belongs to the [**ANIMATE\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="e8edb-125">Элемент управления анимации создается с помощью функции [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) или [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) или макроса [**анимации \_ CREATE**](/windows/desktop/api/Commctrl/nf-commctrl-animate_create) .</span><span class="sxs-lookup"><span data-stu-id="e8edb-125">You create an animation control by using the [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) or [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function or the [**Animate\_Create**](/windows/desktop/api/Commctrl/nf-commctrl-animate_create) macro.</span></span> <span data-ttu-id="e8edb-126">Макрос располагает анимированный элемент управления в левом верхнем углу родительского окна и, если не указан стиль [**\_ центра ACS**](animation-control-styles.md) , устанавливает ширину и высоту элемента управления на основе размеров кадра в ролике AVI.</span><span class="sxs-lookup"><span data-stu-id="e8edb-126">The macro positions the animation control in the upper-left corner of the parent window and, if the [**ACS\_CENTER**](animation-control-styles.md) style is not specified, sets the width and height of the control based on the dimensions of a frame in the AVI clip.</span></span> <span data-ttu-id="e8edb-127">Если **указан \_ центр ACS** , команда **анимировать \_ CREATE** устанавливает ширину и высоту элемента управления равными нулю.</span><span class="sxs-lookup"><span data-stu-id="e8edb-127">If **ACS\_CENTER** is specified, **Animate\_Create** sets the width and height of the control to zero.</span></span> <span data-ttu-id="e8edb-128">Для задания расположения и размера элемента управления можно использовать функцию [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) .</span><span class="sxs-lookup"><span data-stu-id="e8edb-128">You can use the [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to set the position and size of the control.</span></span>

<span data-ttu-id="e8edb-129">При создании элемента управления "анимация" в диалоговом окне или в ресурсе диалогового окна элемент управления автоматически уничтожается, когда пользователь закрывает диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="e8edb-129">If you create an animation control within a dialog box or from a dialog box resource, the control is automatically destroyed when the user closes the dialog box.</span></span> <span data-ttu-id="e8edb-130">При создании элемента управления анимации в окне необходимо явным образом уничтожить элемент управления.</span><span class="sxs-lookup"><span data-stu-id="e8edb-130">If you create an animation control within a window, you must explicitly destroy the control.</span></span>

## <a name="about-animation-control-messages"></a><span data-ttu-id="e8edb-131">Об управляющих сообщениях анимации</span><span class="sxs-lookup"><span data-stu-id="e8edb-131">About Animation Control Messages</span></span>

<span data-ttu-id="e8edb-132">Приложение отправляет сообщения в элемент управления "анимация", чтобы открывать, воспроизводить, прекращать и закрывать соответствующий ролик.</span><span class="sxs-lookup"><span data-stu-id="e8edb-132">An application sends messages to an animation control to open, play, stop, and close the corresponding AVI clip.</span></span> <span data-ttu-id="e8edb-133">Каждое сообщение содержит один или несколько макросов, которые можно использовать вместо отправки сообщения явным образом.</span><span class="sxs-lookup"><span data-stu-id="e8edb-133">Each message has one or more macros that you can use instead of sending the message explicitly.</span></span>

<span data-ttu-id="e8edb-134">После создания элемента управления анимацией приложение отправляет сообщение [**ACM \_ Open**](acm-open.md) , чтобы открыть ролик AVI и загрузить его в память.</span><span class="sxs-lookup"><span data-stu-id="e8edb-134">After creating an animation control, an application sends the [**ACM\_OPEN**](acm-open.md) message to open an AVI clip and load it into memory.</span></span> <span data-ttu-id="e8edb-135">В сообщении указывается путь к файлу AVI или имя ресурса AVI.</span><span class="sxs-lookup"><span data-stu-id="e8edb-135">The message specifies either the path of an AVI file or the name of an AVI resource.</span></span> <span data-ttu-id="e8edb-136">Система загружает ресурс AVI из модуля, который создал элемент управления Animation.</span><span class="sxs-lookup"><span data-stu-id="e8edb-136">The system loads the AVI resource from the module that created the animation control.</span></span>

<span data-ttu-id="e8edb-137">Если элемент управления анимации имеет стиль [**\_ автозапуска ACS**](animation-control-styles.md) , элемент управления начинает воспроизводить ролик AVI сразу после открытия файла AVI или AVI.</span><span class="sxs-lookup"><span data-stu-id="e8edb-137">If the animation control has the [**ACS\_AUTOPLAY**](animation-control-styles.md) style, the control begins playing the AVI clip immediately after the AVI file or AVI resource is opened.</span></span> <span data-ttu-id="e8edb-138">В противном случае приложение может использовать сообщение [**ACM \_ Play**](acm-play.md) для запуска клипа AVI.</span><span class="sxs-lookup"><span data-stu-id="e8edb-138">Otherwise, an application can use the [**ACM\_PLAY**](acm-play.md) message to start the AVI clip.</span></span> <span data-ttu-id="e8edb-139">Приложение может прерывать работу клипа в любое время, отправляя сообщение об ошибке [**ACM \_**](acm-stop.md) .</span><span class="sxs-lookup"><span data-stu-id="e8edb-139">An application can stop the clip at any time by sending the [**ACM\_STOP**](acm-stop.md) message.</span></span> <span data-ttu-id="e8edb-140">Последний кадр остается отображенным, когда элемент управления завершает воспроизведение AVI-клипа или **когда \_ отправляется ACM** .</span><span class="sxs-lookup"><span data-stu-id="e8edb-140">The last frame played remains displayed when the control finishes playing the AVI clip or when **ACM\_STOP** is sent.</span></span>

<span data-ttu-id="e8edb-141">Элемент управления "анимация" может отправить два кода уведомления в родительское окно: [АКН \_ Start](acn-start.md) and [АКН \_ останавливаться](acn-stop.md).</span><span class="sxs-lookup"><span data-stu-id="e8edb-141">An animation control can send two notification codes to its parent window: [ACN\_START](acn-start.md) and [ACN\_STOP](acn-stop.md).</span></span> <span data-ttu-id="e8edb-142">Большинство приложений не обрабатывает ни одно уведомление.</span><span class="sxs-lookup"><span data-stu-id="e8edb-142">Most applications do not handle either notification.</span></span>

<span data-ttu-id="e8edb-143">Чтобы закрыть файл AVI или AVI и удалить его из памяти, приложение может использовать макрос [**анимации «анимировать» \_**](/windows/desktop/api/Commctrl/nf-commctrl-animate_close) , который отправляет [**ACM \_ Open**](acm-open.md) с именем файла или именем ресурса, установленным в **null**.</span><span class="sxs-lookup"><span data-stu-id="e8edb-143">To close the AVI file or AVI resource and remove it from memory, an application can use the [**Animate\_Close**](/windows/desktop/api/Commctrl/nf-commctrl-animate_close) macro, which sends [**ACM\_OPEN**](acm-open.md) with the file name or resource name set to **NULL**.</span></span>

## <a name="default-message-processing"></a><span data-ttu-id="e8edb-144">Обработка сообщений по умолчанию</span><span class="sxs-lookup"><span data-stu-id="e8edb-144">Default Message Processing</span></span>

<span data-ttu-id="e8edb-145">В этом разделе описываются сообщения окна, обрабатываемые процедурой окна для класса окна [**анимировать \_ класс**](common-control-window-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="e8edb-145">This section describes the window messages handled by the window procedure for the [**ANIMATE\_CLASS**](common-control-window-classes.md) window class.</span></span>



| <span data-ttu-id="e8edb-146">Сообщение</span><span class="sxs-lookup"><span data-stu-id="e8edb-146">Message</span></span>                                    | <span data-ttu-id="e8edb-147">Обработка выполнена</span><span class="sxs-lookup"><span data-stu-id="e8edb-147">Processing performed</span></span>                                                                                                                                                                                                                                                                        |
|--------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e8edb-148">**\_Закрыть WM**</span><span class="sxs-lookup"><span data-stu-id="e8edb-148">**WM\_CLOSE**</span></span>](/windows/desktop/winmsg/wm-close)           | <span data-ttu-id="e8edb-149">Освобождает файл AVI или AVI, связанный с элементом управления анимации.</span><span class="sxs-lookup"><span data-stu-id="e8edb-149">Frees the AVI file or AVI resource associated with the animation control.</span></span>                                                                                                                                                                                                                   |
| [<span data-ttu-id="e8edb-150">**WM \_ destroy**</span><span class="sxs-lookup"><span data-stu-id="e8edb-150">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)       | <span data-ttu-id="e8edb-151">Освобождает файл AVI или AVI, освобождает внутреннюю структуру данных, а затем вызывает функцию [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="e8edb-151">Frees the AVI file or AVI resource, frees an internal data structure, and then calls the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span>                                                                                                                                                |
| [<span data-ttu-id="e8edb-152">**WM \_ ерасебкгнд**</span><span class="sxs-lookup"><span data-stu-id="e8edb-152">**WM\_ERASEBKGND**</span></span>](/windows/desktop/winmsg/wm-erasebkgnd) | <span data-ttu-id="e8edb-153">Стирает фон окна, используя текущий цвет фона для статических элементов управления.</span><span class="sxs-lookup"><span data-stu-id="e8edb-153">Erases the window background using the current background color for static controls.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="e8edb-154">**WM \_ нккреате**</span><span class="sxs-lookup"><span data-stu-id="e8edb-154">**WM\_NCCREATE**</span></span>](/windows/desktop/winmsg/wm-nccreate)     | <span data-ttu-id="e8edb-155">Выделяет и инициализирует внутреннюю структуру данных, а затем вызывает [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span><span class="sxs-lookup"><span data-stu-id="e8edb-155">Allocates and initializes an internal data structure and then calls [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span></span>                                                                                                                                                                              |
| [<span data-ttu-id="e8edb-156">**WM \_ нчиттест**</span><span class="sxs-lookup"><span data-stu-id="e8edb-156">**WM\_NCHITTEST**</span></span>](/windows/desktop/inputdev/wm-nchittest) | <span data-ttu-id="e8edb-157">Возвращает значение проверки попадания ХТТРАНСПАРЕНТ.</span><span class="sxs-lookup"><span data-stu-id="e8edb-157">Returns the HTTRANSPARENT hit test value.</span></span>                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="e8edb-158">**WM \_ Paint**</span><span class="sxs-lookup"><span data-stu-id="e8edb-158">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)              | <span data-ttu-id="e8edb-159">Рисует рамку AVI в элементе управления Animation.</span><span class="sxs-lookup"><span data-stu-id="e8edb-159">Draws an AVI frame in the animation control.</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="e8edb-160">**\_Размер WM**</span><span class="sxs-lookup"><span data-stu-id="e8edb-160">**WM\_SIZE**</span></span>](/windows/desktop/winmsg/wm-size)             | <span data-ttu-id="e8edb-161">Проверяет, имеет ли элемент управления [**стиль \_ центра ACS**](animation-control-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="e8edb-161">Checks if the control has the [**ACS\_CENTER**](animation-control-styles.md) style.</span></span> <span data-ttu-id="e8edb-162">Если элемент управления не имеет значение, он вызывает [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span><span class="sxs-lookup"><span data-stu-id="e8edb-162">If the control does not, it calls [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span></span> <span data-ttu-id="e8edb-163">В противном случае он выравнивает анимацию в элементе управления, делает элемент управления недействительным, а затем вызывает **дефвиндовпрок**.</span><span class="sxs-lookup"><span data-stu-id="e8edb-163">Otherwise, it centers the animation in the control, invalidates the control, and then calls **DefWindowProc**.</span></span> |



 

 

 