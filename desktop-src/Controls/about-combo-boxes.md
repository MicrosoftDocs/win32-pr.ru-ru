---
title: Сведения о полях со списком
description: В этом разделе обсуждаются различные виды полей со списками.
ms.assetid: 76410a87-aa0e-4da9-9e78-c80ac485e3cd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 344596a3c0aa772568956344aaddcc053b534993
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104551610"
---
# <a name="about-combo-boxes"></a><span data-ttu-id="63605-103">Сведения о полях со списком</span><span class="sxs-lookup"><span data-stu-id="63605-103">About Combo Boxes</span></span>

<span data-ttu-id="63605-104">Поле со списком объединяет поле ввода или статический текст и список.</span><span class="sxs-lookup"><span data-stu-id="63605-104">A combo box combines an edit box or static text and a list.</span></span>

<span data-ttu-id="63605-105">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="63605-105">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="63605-106">Типы и стили поля со списком</span><span class="sxs-lookup"><span data-stu-id="63605-106">Combo Box Types and Styles</span></span>](#combo-box-types-and-styles)
-   [<span data-ttu-id="63605-107">Список полей со списком</span><span class="sxs-lookup"><span data-stu-id="63605-107">Combo Box List</span></span>](#combo-box-list)
    -   [<span data-ttu-id="63605-108">Текущий выбор</span><span class="sxs-lookup"><span data-stu-id="63605-108">Current Selection</span></span>](#current-selection)
    -   [<span data-ttu-id="63605-109">Раскрывающиеся списки</span><span class="sxs-lookup"><span data-stu-id="63605-109">Drop-down Lists</span></span>](#drop-down-lists)
    -   [<span data-ttu-id="63605-110">Вывод списка содержимого</span><span class="sxs-lookup"><span data-stu-id="63605-110">List Contents</span></span>](#list-contents)
-   [<span data-ttu-id="63605-111">Изменить поля выбора элемента управления</span><span class="sxs-lookup"><span data-stu-id="63605-111">Edit Control Selection Fields</span></span>](#edit-control-selection-fields)
-   [<span data-ttu-id="63605-112">Поля со списком, рисуемые владельцем</span><span class="sxs-lookup"><span data-stu-id="63605-112">Owner-Drawn Combo Boxes</span></span>](#owner-drawn-combo-boxes)
-   [<span data-ttu-id="63605-113">Поля со списком для подклассов</span><span class="sxs-lookup"><span data-stu-id="63605-113">Subclassed Combo Boxes</span></span>](#subclassed-combo-boxes)

## <a name="combo-box-types-and-styles"></a><span data-ttu-id="63605-114">Типы и стили поля со списком</span><span class="sxs-lookup"><span data-stu-id="63605-114">Combo Box Types and Styles</span></span>

<span data-ttu-id="63605-115">Поле со списком состоит из списка и поля выбора.</span><span class="sxs-lookup"><span data-stu-id="63605-115">A combo box consists of a list and a selection field.</span></span> <span data-ttu-id="63605-116">В списке представлены параметры, которые пользователь может выбирать, а в поле выбора отображается текущее выделение.</span><span class="sxs-lookup"><span data-stu-id="63605-116">The list presents the options that a user can select, and the selection field displays the current selection.</span></span> <span data-ttu-id="63605-117">Если поле выбора является элементом управления редактирования, пользователь может ввести сведения, недоступные в списке. в противном случае пользователь может выбрать только элементы из списка.</span><span class="sxs-lookup"><span data-stu-id="63605-117">If the selection field is an edit control, the user can enter information not available in the list; otherwise, the user can only select items in the list.</span></span>

<span data-ttu-id="63605-118">Библиотека Common Controls включает три основных стиля поля со списком, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="63605-118">The common controls library includes three main styles of combo box, as shown in the following table.</span></span>



| <span data-ttu-id="63605-119">Тип поля со списком</span><span class="sxs-lookup"><span data-stu-id="63605-119">Combo box type</span></span>             | <span data-ttu-id="63605-120">Константа стиля</span><span class="sxs-lookup"><span data-stu-id="63605-120">Style constant</span></span>                                                 | <span data-ttu-id="63605-121">Описание</span><span class="sxs-lookup"><span data-stu-id="63605-121">Description</span></span>                                                                                  |
|----------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| <span data-ttu-id="63605-122">Простота</span><span class="sxs-lookup"><span data-stu-id="63605-122">Simple</span></span>                     | [<span data-ttu-id="63605-123">**\_простой CBS**</span><span class="sxs-lookup"><span data-stu-id="63605-123">**CBS\_SIMPLE**</span></span>](combo-box-styles.md)             | <span data-ttu-id="63605-124">Отображает список в любое время и отображает выбранный элемент в элементе управления "поле ввода".</span><span class="sxs-lookup"><span data-stu-id="63605-124">Displays the list at all times, and shows the selected item in an edit control.</span></span>              |
| <span data-ttu-id="63605-125">Drop-down</span><span class="sxs-lookup"><span data-stu-id="63605-125">Drop-down</span></span>                  | [<span data-ttu-id="63605-126">**\_раскрывающийся список CBS**</span><span class="sxs-lookup"><span data-stu-id="63605-126">**CBS\_DROPDOWN**</span></span>](combo-box-styles.md)         | <span data-ttu-id="63605-127">Отображает список при нажатии на значок и отображает выбранный элемент в элементе управления "поле ввода".</span><span class="sxs-lookup"><span data-stu-id="63605-127">Displays the list when the icon is clicked, and shows the selected item in an edit control.</span></span>  |
| <span data-ttu-id="63605-128">Раскрывающийся список (раскрывающийся список)</span><span class="sxs-lookup"><span data-stu-id="63605-128">Drop-down list (drop list)</span></span> | [<span data-ttu-id="63605-129">**DROPDOWNLIST для CBS \_**</span><span class="sxs-lookup"><span data-stu-id="63605-129">**CBS\_DROPDOWNLIST**</span></span>](combo-box-styles.md) | <span data-ttu-id="63605-130">Отображает список при нажатии на значок и отображает выбранный элемент в статическом элементе управления.</span><span class="sxs-lookup"><span data-stu-id="63605-130">Displays the list when the icon is clicked, and shows the selected item in a static control.</span></span> |



 

<span data-ttu-id="63605-131">На следующем снимке экрана показаны три типа полей со списком, которые могут отображаться в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="63605-131">The following screen shots each show the three kinds of combo box as they might appear in Windows Vista.</span></span> <span data-ttu-id="63605-132">На первом снимке экрана пользователь выбрал элемент в простом поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-132">In the first screen shot, the user has selected an item in the simple combo box.</span></span> <span data-ttu-id="63605-133">Пользователь также может ввести новое значение в поле ввода этого элемента управления.</span><span class="sxs-lookup"><span data-stu-id="63605-133">The user can also type a new value in the edit box of this control.</span></span> <span data-ttu-id="63605-134">Размер списка в редакторе ресурсов Microsoft Visual Studio и достаточно большой для размещения двух элементов.</span><span class="sxs-lookup"><span data-stu-id="63605-134">The list has been sized in the Microsoft Visual Studio resource editor and is only large enough to accommodate two items.</span></span>

![снимок экрана, показывающий элемент, выбранный в простом поле со списком](images/simplecombo.png)

<span data-ttu-id="63605-136">На втором снимке экрана пользователь ввел новый текст в поле редактирования раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="63605-136">In the second screen shot, the user has typed new text in the edit control of the drop-down combo box.</span></span> <span data-ttu-id="63605-137">Пользователь также может выбрать существующий элемент.</span><span class="sxs-lookup"><span data-stu-id="63605-137">The user could also have selected an existing item.</span></span> <span data-ttu-id="63605-138">Список раскрывается в соответствии с максимально возможным количеством элементов.</span><span class="sxs-lookup"><span data-stu-id="63605-138">The list box expands to accommodate as many items as possible.</span></span>

![снимок экрана с текстом, введенным в раскрывающееся поле со списком](images/dropdown.png)

<span data-ttu-id="63605-140">На третьем снимке экрана пользователь открыл поле со списком раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="63605-140">In the third screen shot, the user has opened the drop-down list combo box.</span></span> <span data-ttu-id="63605-141">Список раскрывается в соответствии с максимально возможным количеством элементов.</span><span class="sxs-lookup"><span data-stu-id="63605-141">The list box expands to accommodate as many items as possible.</span></span> <span data-ttu-id="63605-142">Пользователь не может ввести новый текст.</span><span class="sxs-lookup"><span data-stu-id="63605-142">The user cannot enter new text.</span></span>

![снимок экрана, показывающий элемент, выбранный в раскрывающемся списке с раскрывающимся списком](images/droplist.png)

<span data-ttu-id="63605-144">Также существует ряд стилей полей со списком, определяющих конкретные свойства.</span><span class="sxs-lookup"><span data-stu-id="63605-144">There are also a number of combo box styles that define specific properties.</span></span> <span data-ttu-id="63605-145">Стили полей со списками определяют определенные свойства поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-145">Combo box styles define specific properties of a combo box.</span></span> <span data-ttu-id="63605-146">Стили можно объединять; Однако некоторые стили применяются только к определенным типам полей со списками.</span><span class="sxs-lookup"><span data-stu-id="63605-146">You can combine styles; however, some styles apply only to certain combo box types.</span></span> <span data-ttu-id="63605-147">Сведения о таблице стилей полей со списками см. в разделе [стили полей со](combo-box-styles.md)списками.</span><span class="sxs-lookup"><span data-stu-id="63605-147">For a table of combo box styles, see [Combo Box Styles](combo-box-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="63605-148">Чтобы использовать стили оформления с полями со списком, приложение должно включать манифест и вызывать [**иниткоммонконтролс**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) в начале программы.</span><span class="sxs-lookup"><span data-stu-id="63605-148">To use visual styles with combo boxes, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="63605-149">Сведения о визуальных стилях см. в разделе [стили визуальных](themes-overview.md)элементов.</span><span class="sxs-lookup"><span data-stu-id="63605-149">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="63605-150">Дополнительные сведения о манифестах см. в разделе [Включение визуальных стилей](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="63605-150">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="combo-box-list"></a><span data-ttu-id="63605-151">Список полей со списком</span><span class="sxs-lookup"><span data-stu-id="63605-151">Combo Box List</span></span>

<span data-ttu-id="63605-152">Список — это часть поля со списком, в которой отображаются элементы, которые может выбрать пользователь.</span><span class="sxs-lookup"><span data-stu-id="63605-152">The list is the portion of a combo box that displays the items a user can select.</span></span> <span data-ttu-id="63605-153">Как правило, приложение инициализирует содержимое списка при создании поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-153">Typically, an application initializes the contents of the list when it creates a combo box.</span></span> <span data-ttu-id="63605-154">Выбранный пользователем элемент списка является *текущим выбором*.</span><span class="sxs-lookup"><span data-stu-id="63605-154">Any list item selected by the user is the *current selection*.</span></span> <span data-ttu-id="63605-155">Невозможно выбрать несколько элементов.</span><span class="sxs-lookup"><span data-stu-id="63605-155">Multiple items cannot be selected.</span></span> <span data-ttu-id="63605-156">В простых и раскрывающихся списках поля пользователь может ввести в поле выбора вместо выбора элемента списка.</span><span class="sxs-lookup"><span data-stu-id="63605-156">In simple and drop-down combo boxes, the user can type in the selection field instead of selecting a list item.</span></span> <span data-ttu-id="63605-157">В таких случаях текущий выбор отсутствует, и приложение обязано добавить элемент в список и сделать его текущим выбором, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="63605-157">In these cases, there is no current selection, and it is the application's responsibility to add the item to the list and make it the current selection, if it is appropriate to do so.</span></span>

<span data-ttu-id="63605-158">В этом разделе рассматриваются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="63605-158">This section discusses following topics:</span></span>

-   [<span data-ttu-id="63605-159">Текущий выбор</span><span class="sxs-lookup"><span data-stu-id="63605-159">Current Selection</span></span>](#current-selection)
-   [<span data-ttu-id="63605-160">Раскрывающиеся списки</span><span class="sxs-lookup"><span data-stu-id="63605-160">Drop-down Lists</span></span>](#drop-down-lists)
-   [<span data-ttu-id="63605-161">Вывод списка содержимого</span><span class="sxs-lookup"><span data-stu-id="63605-161">List Contents</span></span>](#list-contents)

### <a name="current-selection"></a><span data-ttu-id="63605-162">Текущий выбор</span><span class="sxs-lookup"><span data-stu-id="63605-162">Current Selection</span></span>

<span data-ttu-id="63605-163">Текущий выделенный фрагмент является элементом списка, выбранным пользователем. выбранный текст появится в поле выбора поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-163">The current selection is a list item that the user has selected; the selected text appears in the selection field of the combo box.</span></span> <span data-ttu-id="63605-164">Однако в случае простого поля со списком или раскрывающегося поля со списком текущий выделенный фрагмент представляет собой только одну форму возможных входных данных пользователя в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-164">However, in the case of a simple combo box or a drop-down combo box, the current selection is only one form of possible user input in a combo box.</span></span> <span data-ttu-id="63605-165">Пользователь также может ввести текст в поле выбора.</span><span class="sxs-lookup"><span data-stu-id="63605-165">The user can also type text in the selection field.</span></span>

<span data-ttu-id="63605-166">Текущий выбор определяется индексом (от нуля) выбранного элемента списка.</span><span class="sxs-lookup"><span data-stu-id="63605-166">The current selection is identified by the zero-based index of the selected list item.</span></span> <span data-ttu-id="63605-167">Приложение может установить и получить его в любое время.</span><span class="sxs-lookup"><span data-stu-id="63605-167">An application can set and retrieve it at any time.</span></span> <span data-ttu-id="63605-168">Родительское окно или процедура диалогового окна получает уведомление, когда пользователь изменяет текущее выделение для поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-168">The parent window or dialog box procedure receives notification when the user changes the current selection for a combo box.</span></span> <span data-ttu-id="63605-169">Родительское окно или диалоговое окно не уведомляется, когда приложение изменяет выбор.</span><span class="sxs-lookup"><span data-stu-id="63605-169">The parent window or dialog box is not notified when the application changes the selection.</span></span>

<span data-ttu-id="63605-170">При создании поля со списком текущий выбор отсутствует.</span><span class="sxs-lookup"><span data-stu-id="63605-170">When a combo box is created, there is no current selection.</span></span> <span data-ttu-id="63605-171">Это также справедливо для простого или раскрывающегося поля со списком, если пользователь изменил содержимое поля выбора.</span><span class="sxs-lookup"><span data-stu-id="63605-171">This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field.</span></span> <span data-ttu-id="63605-172">Чтобы задать текущее выделение, приложение отправляет сообщение [**\_ сеткурсел CB**](cb-setcursel.md) в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-172">To set the current selection, an application sends the [**CB\_SETCURSEL**](cb-setcursel.md) message to the combo box.</span></span> <span data-ttu-id="63605-173">Приложение может также использовать сообщение [**\_ селектстринг CB**](cb-selectstring.md) , чтобы установить текущий выбор для элемента списка, строка которого начинается с указанной строки.</span><span class="sxs-lookup"><span data-stu-id="63605-173">An application can also use the [**CB\_SELECTSTRING**](cb-selectstring.md) message to set the current selection to a list item whose string begins with a specified string.</span></span> <span data-ttu-id="63605-174">Чтобы определить текущее выделение, приложение отправляет в поле со списком сообщение с [**\_ нерекурсивной**](cb-getcursel.md) назначением CB.</span><span class="sxs-lookup"><span data-stu-id="63605-174">To determine the current selection, an application sends the [**CB\_GETCURSEL**](cb-getcursel.md) message to the combo box.</span></span> <span data-ttu-id="63605-175">Если текущего выбора нет, это сообщение возвращает значение CB \_ Err.</span><span class="sxs-lookup"><span data-stu-id="63605-175">If there is no current selection, this message returns CB\_ERR.</span></span>

<span data-ttu-id="63605-176">Когда пользователь изменяет текущий выбор в поле со списком, родительское окно или процедура диалогового окна получает сообщение [**\_ команды WM**](/windows/desktop/menurc/wm-command) с кодом уведомления [КБН \_ селчанже](cbn-selchange.md) в верхнем слове параметра *wParam* .</span><span class="sxs-lookup"><span data-stu-id="63605-176">When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the [CBN\_SELCHANGE](cbn-selchange.md) notification code in the high-order word of the *wParam* parameter.</span></span> <span data-ttu-id="63605-177">Этот код уведомления не отправляется, если текущий выбор задается с помощью сообщения [**\_ сеткурсел CB**](cb-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-177">This notification code is not sent when the current selection is set using the [**CB\_SETCURSEL**](cb-setcursel.md) message.</span></span>

<span data-ttu-id="63605-178">Раскрывающееся поле со списком или раскрывающийся список отправляет код уведомления [КБН \_ крупный план](cbn-closeup.md) в родительское окно или процедуру диалогового окна при закрытии раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="63605-178">A drop-down combo box or drop-down list box sends the [CBN\_CLOSEUP](cbn-closeup.md) notification code to the parent window or dialog-box procedure when the drop-down list closes.</span></span> <span data-ttu-id="63605-179">Если пользователь изменил текущее выделение, поле со списком также отправляет код уведомления [КБН \_ селчанже](cbn-selchange.md) при закрытии раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="63605-179">If the user changed the current selection, the combo box also sends the [CBN\_SELCHANGE](cbn-selchange.md) notification code when the drop-down list closes.</span></span> <span data-ttu-id="63605-180">Для выполнения определенного процесса каждый раз, когда пользователь выбирает элемент списка, можно обработать \_ код уведомления КБН селчанже или КБН \_ крупный план.</span><span class="sxs-lookup"><span data-stu-id="63605-180">To execute a specific process each time the user selects a list item, you can handle either the CBN\_SELCHANGE or CBN\_CLOSEUP notification code.</span></span> <span data-ttu-id="63605-181">Как правило, вы ждете \_ код уведомления КБН крупный план перед обработкой изменения в текущем выделенном фрагменте.</span><span class="sxs-lookup"><span data-stu-id="63605-181">Typically, you would wait for the CBN\_CLOSEUP notification code before processing a change in the current selection.</span></span> <span data-ttu-id="63605-182">Это может быть особенно важно, если требуется значительный объем обработки.</span><span class="sxs-lookup"><span data-stu-id="63605-182">This can be particularly important if a significant amount of processing is required.</span></span>

<span data-ttu-id="63605-183">Приложение также может обрабатывать коды уведомлений [КБН \_ Селендок](cbn-selendok.md) и [КБН \_ селендканцел](cbn-selendcancel.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-183">An application could also process the [CBN\_SELENDOK](cbn-selendok.md) and [CBN\_SELENDCANCEL](cbn-selendcancel.md) notification codes.</span></span> <span data-ttu-id="63605-184">Система отправляет КБН \_ селендок, когда пользователь выбирает элемент списка или выбирает элемент, а затем закрывает список.</span><span class="sxs-lookup"><span data-stu-id="63605-184">The system sends CBN\_SELENDOK when the user selects a list item, or selects an item and then closes the list.</span></span> <span data-ttu-id="63605-185">Это означает, что пользователь завершил работу и должен обработать выделение.</span><span class="sxs-lookup"><span data-stu-id="63605-185">This indicates that the user has finished, and that the selection should be processed.</span></span> <span data-ttu-id="63605-186">КБН \_ селендканцел отправляется, когда пользователь выбирает элемент, а затем выбирает другой элемент управления, нажимает клавишу ESC, когда раскрывающийся список открыт, или закрывает диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="63605-186">CBN\_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses ESC while the drop-down list is open, or closes the dialog box.</span></span> <span data-ttu-id="63605-187">Это означает, что выбор пользователя следует игнорировать.</span><span class="sxs-lookup"><span data-stu-id="63605-187">This indicates that the user's selection should be ignored.</span></span> <span data-ttu-id="63605-188">КБН \_ селендок отправляется перед каждым сообщением [КБН \_ селчанже](cbn-selchange.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-188">CBN\_SELENDOK is sent before every [CBN\_SELCHANGE](cbn-selchange.md) message.</span></span>

<span data-ttu-id="63605-189">В простом поле со списком система отправляет код уведомления [КБН \_ дблклк](cbn-dblclk.md) , когда пользователь дважды щелкает элемент списка.</span><span class="sxs-lookup"><span data-stu-id="63605-189">In a simple combo box, the system sends the [CBN\_DBLCLK](cbn-dblclk.md) notification code when the user double-clicks a list item.</span></span> <span data-ttu-id="63605-190">В раскрывающемся поле со списком или раскрывающемся списке один щелчок скрывает список, поэтому невозможно дважды щелкнуть элемент.</span><span class="sxs-lookup"><span data-stu-id="63605-190">In a drop-down combo box or drop-down list, a single click hides the list, so it is not possible to double-click an item.</span></span>

### <a name="drop-down-lists"></a><span data-ttu-id="63605-191">Раскрывающиеся списки</span><span class="sxs-lookup"><span data-stu-id="63605-191">Drop-down Lists</span></span>

<span data-ttu-id="63605-192">Некоторые уведомления и сообщения применяются только к полям со списком, содержащим раскрывающиеся списки.</span><span class="sxs-lookup"><span data-stu-id="63605-192">Certain notifications and messages apply only to combo boxes containing drop-down lists.</span></span> <span data-ttu-id="63605-193">Если раскрывающийся список открыт или закрыт, то родительское окно поля со списком получает уведомление в виде [**\_ командного сообщения WM**](/windows/desktop/menurc/wm-command) .</span><span class="sxs-lookup"><span data-stu-id="63605-193">When a drop-down list is open or closed, the parent window of a combo box receives a notification in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="63605-194">Если список открывается, то в [ \_ раскрывающемся](cbn-dropdown.md)списке *wParam* используется слово КБН с высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="63605-194">If the list is being opened, the high-order word of *wParam* is [CBN\_DROPDOWN](cbn-dropdown.md).</span></span> <span data-ttu-id="63605-195">Если список закрывается, это [КБН \_ крупный план](cbn-closeup.md).</span><span class="sxs-lookup"><span data-stu-id="63605-195">If the list is being closed, it is [CBN\_CLOSEUP](cbn-closeup.md).</span></span>

<span data-ttu-id="63605-196">Приложение может открыть список раскрывающихся полей со списком или раскрывающийся список с помощью сообщения [**\_ шовдропдовн CB**](cb-showdropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-196">An application can open the list of a drop-down combo box or drop-down list box by using the [**CB\_SHOWDROPDOWN**](cb-showdropdown.md) message.</span></span> <span data-ttu-id="63605-197">Он может определить, открыт ли список с помощью сообщения [**\_ жетдроппедстате CB**](cb-getdroppedstate.md) , и может определить координаты раскрывающегося списка с помощью сообщения [**\_ жетдроппедконтролрект CB**](cb-getdroppedcontrolrect.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-197">It can determine whether the list is open by using the [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md) message and can determine the coordinates of a drop-down list by using the [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) message.</span></span> <span data-ttu-id="63605-198">Приложение также может увеличить ширину раскрывающегося списка с помощью сообщения [**\_ сетдроппедвидс CB**](cb-setdroppedwidth.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-198">An application can also increase the width of a drop-down list by using the [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md) message.</span></span>

### <a name="list-contents"></a><span data-ttu-id="63605-199">Вывод списка содержимого</span><span class="sxs-lookup"><span data-stu-id="63605-199">List Contents</span></span>

<span data-ttu-id="63605-200">Когда приложение создает поле со списком, оно обычно инициализирует поле со списком, добавляя один или несколько элементов в список.</span><span class="sxs-lookup"><span data-stu-id="63605-200">When an application creates a combo box, it typically initializes the combo box by adding one or more items to the list.</span></span> <span data-ttu-id="63605-201">Позже приложение может добавлять или удалять элементы списка, повторно инициализировать список или получать из него сведения об элементе.</span><span class="sxs-lookup"><span data-stu-id="63605-201">Later, an application may add or delete list items, reinitialize the list, or retrieve item information from it.</span></span>

<span data-ttu-id="63605-202">Приложение добавляет элементы списка в поле со списком, отправляя ему [**сообщение \_ ADDSTRING CB**](cb-addstring.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-202">An application adds list items to a combo box by sending the [**CB\_ADDSTRING**](cb-addstring.md) message to it.</span></span> <span data-ttu-id="63605-203">Указанный элемент добавляется в конец списка или в отсортированном поле со списком в соответствующей позиции сортировки на основе строки элемента.</span><span class="sxs-lookup"><span data-stu-id="63605-203">The specified item is added to the end of the list or, in a sorted combo box, in its correct sorted position based on the item's string.</span></span> <span data-ttu-id="63605-204">В поле со списком без сортировки приложение может использовать сообщение [**\_ инсертстринг CB**](cb-insertstring.md) для вставки элемента в определенной позиции.</span><span class="sxs-lookup"><span data-stu-id="63605-204">In an unsorted combo box, an application can use the [**CB\_INSERTSTRING**](cb-insertstring.md) message to insert an item at a specific position.</span></span> <span data-ttu-id="63605-205">После добавления элемент списка определяется его позицией.</span><span class="sxs-lookup"><span data-stu-id="63605-205">Once added, a list item is identified by its position.</span></span>

<span data-ttu-id="63605-206">С помощью сообщения [**CB \_ FINDSTRING**](cb-findstring.md) или [**CB \_ финдстринжексакт**](cb-findstringexact.md) приложение может определить позицию элемента списка.</span><span class="sxs-lookup"><span data-stu-id="63605-206">By using the [**CB\_FINDSTRING**](cb-findstring.md) or [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md) message, an application can determine the position of a list item.</span></span> <span data-ttu-id="63605-207">**CB \_ FINDSTRING** находит элемент, строка которого начинается с указанной строки.</span><span class="sxs-lookup"><span data-stu-id="63605-207">**CB\_FINDSTRING** finds an item whose string begins with the specified string.</span></span> <span data-ttu-id="63605-208">**CB \_ ФИНДСТРИНЖЕКСАКТ** находит элемент, строка которого точно соответствует строке.</span><span class="sxs-lookup"><span data-stu-id="63605-208">**CB\_FINDSTRINGEXACT** finds an item whose string matches the string exactly.</span></span> <span data-ttu-id="63605-209">Ни одно из сообщений не учитывает регистр.</span><span class="sxs-lookup"><span data-stu-id="63605-209">Neither message is case sensitive.</span></span>

<span data-ttu-id="63605-210">Приложение может удалить элемент списка с помощью сообщения [**\_ делетестринг CB**](cb-deletestring.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-210">An application can remove a list item by using the [**CB\_DELETESTRING**](cb-deletestring.md) message.</span></span> <span data-ttu-id="63605-211">Если приложению необходимо повторно инициализировать список полей со списком, оно может сначала очистить все содержимое с помощью сообщения [**\_ ресетконтент CB**](cb-resetcontent.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-211">If an application needs to reinitialize the combo box list, it can first clear its entire contents by using the [**CB\_RESETCONTENT**](cb-resetcontent.md) message.</span></span> <span data-ttu-id="63605-212">При добавлении нескольких элементов в список после того, как поле со списком уже отображается, приложение может снять флаг перерисовки, чтобы раскрасить поле со списком после добавления каждого элемента.</span><span class="sxs-lookup"><span data-stu-id="63605-212">When adding multiple items to the list after a combo box has already been shown, an application can clear the redraw flag to prevent the combo box from being repainted after each item is added.</span></span> <span data-ttu-id="63605-213">Дополнительные сведения о перерисовки см. в описании сообщения [**WM \_ сетредрав**](/windows/desktop/gdi/wm-setredraw) .</span><span class="sxs-lookup"><span data-stu-id="63605-213">For more information about redrawing, see the description of the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message.</span></span>

<span data-ttu-id="63605-214">Чтобы получить строку, связанную с элементом списка, приложение может использовать сообщение [**\_ жетлбтекст CB**](cb-getlbtext.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-214">To retrieve the string associated with a list item, an application can use the [**CB\_GETLBTEXT**](cb-getlbtext.md) message.</span></span> <span data-ttu-id="63605-215">Строка элемента копируется в буфер, указанный приложением.</span><span class="sxs-lookup"><span data-stu-id="63605-215">The item's string is copied to the buffer specified by the application.</span></span> <span data-ttu-id="63605-216">Чтобы убедиться, что буфер достаточно велик для получения строки, приложение может сначала использовать сообщение [**\_ жетлбтекстлен CB**](cb-getlbtextlen.md) для определения длины строки.</span><span class="sxs-lookup"><span data-stu-id="63605-216">To ensure that the buffer is large enough to receive the string, the application can first use the [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md) message to determine the length of the string.</span></span> <span data-ttu-id="63605-217">Чтобы получить количество элементов списка в поле со списком, приложение может использовать сообщение [**CB \_ NOCOUNT**](cb-getcount.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-217">To get the number of list items in a combo box, an application can use the [**CB\_GETCOUNT**](cb-getcount.md) message.</span></span>

## <a name="edit-control-selection-fields"></a><span data-ttu-id="63605-218">Изменить поля выбора элемента управления</span><span class="sxs-lookup"><span data-stu-id="63605-218">Edit Control Selection Fields</span></span>

<span data-ttu-id="63605-219">Приложение может извлекать или задавать содержимое поля выбора, а также определять или устанавливать выбор редактирования.</span><span class="sxs-lookup"><span data-stu-id="63605-219">An application can retrieve or set the contents of the selection field and can determine or set the edit selection.</span></span> <span data-ttu-id="63605-220">Приложение также может ограничить объем текста, который пользователь может ввести в поле выбора.</span><span class="sxs-lookup"><span data-stu-id="63605-220">The application can also limit the amount of text a user can type in the selection field.</span></span> <span data-ttu-id="63605-221">При изменении содержимого поля выбора система отправляет сообщения уведомления в родительское окно или процедуру диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="63605-221">When the contents of the selection field change, the system sends notification messages to the parent window or dialog box procedure.</span></span>

<span data-ttu-id="63605-222">Чтобы получить содержимое поля выбора, приложение может отправить сообщение [**WM \_ gettext**](/windows/desktop/winmsg/wm-gettext) в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-222">To retrieve the content of the selection field, an application can send the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message to the combo box.</span></span> <span data-ttu-id="63605-223">Чтобы задать содержимое поля выбора простого или раскрывающегося списка, приложение может отправить сообщение [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-223">To set the contents of the selection field of a simple or drop-down combo box, an application can send the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message to the combo box.</span></span>

<span data-ttu-id="63605-224">Область редактирования — это диапазон выделенного текста (при наличии) в поле выбора простого или раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="63605-224">The edit selection is the range of selected text, if any, in the selection field of a simple or drop-down combo box.</span></span> <span data-ttu-id="63605-225">Приложение может определить позиции начального и конечного символов текущего выделения с помощью сообщения [**CB \_ жетедитсел**](cb-geteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-225">An application can determine the starting and ending character positions of the current selection by using the [**CB\_GETEDITSEL**](cb-geteditsel.md) message.</span></span> <span data-ttu-id="63605-226">Он также может выбирать символы в области редактирования с помощью сообщения [**\_ сетедитсел CB**](cb-seteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-226">It can also select characters in the edit selection by using the [**CB\_SETEDITSEL**](cb-seteditsel.md) message.</span></span>

<span data-ttu-id="63605-227">Изначально объем текста, который пользователь может ввести в поле выбора, ограничен размером поля выбора.</span><span class="sxs-lookup"><span data-stu-id="63605-227">Initially, the amount of text that the user can type into the selection field is limited by the size of the selection field.</span></span> <span data-ttu-id="63605-228">Однако если поле со списком имеет стиль [**CBS \_ аутохскролл**](combo-box-styles.md) , текст может быть продолжен за пределами поля выбора.</span><span class="sxs-lookup"><span data-stu-id="63605-228">However, if the combo box has the [**CBS\_AUTOHSCROLL**](combo-box-styles.md) style, the text can continue beyond the size of the selection field.</span></span> <span data-ttu-id="63605-229">Приложение может использовать сообщение [**\_ лимиттекст CB**](cb-limittext.md) , чтобы ограничить объем текста, который пользователь может ввести в поле выбора, независимо от того, имеет ли элемент управления стиль **\_ аутохскролл CBS** .</span><span class="sxs-lookup"><span data-stu-id="63605-229">An application can use the [**CB\_LIMITTEXT**](cb-limittext.md) message to limit the amount of text a user can type into the selection field, regardless of whether the control has the **CBS\_AUTOHSCROLL** style.</span></span>

<span data-ttu-id="63605-230">Когда пользователь редактирует содержимое поля выбора, родительское окно или процедура диалогового окна получает сообщения уведомления.</span><span class="sxs-lookup"><span data-stu-id="63605-230">When the user edits the content of the selection field, the parent window or dialog box procedure receives notification messages.</span></span> <span data-ttu-id="63605-231">Сначала будет отправлен код уведомления [КБН \_ едитупдате](cbn-editupdate.md) , указывающий, что текст в поле выбора был изменен.</span><span class="sxs-lookup"><span data-stu-id="63605-231">The [CBN\_EDITUPDATE](cbn-editupdate.md) notification code is sent first, indicating that the text in the selection field has been edited.</span></span> <span data-ttu-id="63605-232">После отображения измененного текста система отправляет [КБН \_ едитчанже](cbn-editchange.md).</span><span class="sxs-lookup"><span data-stu-id="63605-232">After the altered text is displayed, the system sends [CBN\_EDITCHANGE](cbn-editchange.md).</span></span> <span data-ttu-id="63605-233">При изменении содержимого поля выбора в результате выбора элемента списка эти сообщения не отправляются.</span><span class="sxs-lookup"><span data-stu-id="63605-233">When the selection field content changes as the result of a list item being selected, these messages are not sent.</span></span>

## <a name="owner-drawn-combo-boxes"></a><span data-ttu-id="63605-234">Owner-Drawn поля со списком</span><span class="sxs-lookup"><span data-stu-id="63605-234">Owner-Drawn Combo Boxes</span></span>

<span data-ttu-id="63605-235">Приложение может создать поле со списком, рисуемое владельцем, чтобы принимать ответственность за рисование элементов списка.</span><span class="sxs-lookup"><span data-stu-id="63605-235">An application can create an owner-drawn combo box to take responsibility for painting list items.</span></span> <span data-ttu-id="63605-236">Родительское окно поля со списком, рисуемого владельцем (его владелец), получает сообщения [**WM \_ DRAWITEM**](wm-drawitem.md) , когда часть поля со списком должна быть окрашена.</span><span class="sxs-lookup"><span data-stu-id="63605-236">The parent window of an owner-drawn combo box (its owner) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the combo box needs to be painted.</span></span> <span data-ttu-id="63605-237">Поле со списком, рисуемое владельцем, может выводить список сведений, отличных от текстовых строк, или в дополнение к.</span><span class="sxs-lookup"><span data-stu-id="63605-237">An owner-drawn combo box can list information other than, or in addition to, text strings.</span></span> <span data-ttu-id="63605-238">Поля со списком, рисуемые владельцем, могут иметь любой тип.</span><span class="sxs-lookup"><span data-stu-id="63605-238">Owner-drawn combo boxes can be of any type.</span></span> <span data-ttu-id="63605-239">Однако элемент управления "поле ввода" в простом или раскрывающемся списке может отображать только текст, а владелец заполняет поле выбора в раскрывающемся списке.</span><span class="sxs-lookup"><span data-stu-id="63605-239">However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box.</span></span>

<span data-ttu-id="63605-240">Владелец поля со списком, рисуемого владельцем, должен обработать сообщение [**WM \_ DRAWITEM**](wm-drawitem.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-240">The owner of an owner-drawn combo box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="63605-241">Это сообщение отправляется каждый раз, когда необходимо перерисовать часть поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-241">This message is sent whenever a portion of the combo box must be redrawn.</span></span> <span data-ttu-id="63605-242">Владельцу может потребоваться обработка других сообщений в зависимости от стилей, заданных для поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-242">The owner may need to process other messages, depending on the styles specified for the combo box.</span></span>

<span data-ttu-id="63605-243">Приложение может создать поле со списком, рисуемое владельцем, указав стиль [**CBS \_ Овнердравфиксед**](combo-box-styles.md) или [**CBS \_ овнердраввариабле**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-243">An application can create an owner-drawn combo box by specifying the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) or [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style.</span></span> <span data-ttu-id="63605-244">Если все элементы списка в поле со списком имеют одинаковую высоту, например строки или значки, приложение может использовать стиль **\_ овнердравфиксед CBS** .</span><span class="sxs-lookup"><span data-stu-id="63605-244">If all list items in the combo box are the same height, such as strings or icons, an application can use the **CBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="63605-245">Если элементы списка имеют переменную высоту, например точечные рисунки разного размера, приложение может использовать стиль **CBS \_ овнердраввариабле** .</span><span class="sxs-lookup"><span data-stu-id="63605-245">If list items are of varying height, like bitmaps of different size, an application can use the **CBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="63605-246">Владелец поля со списком, рисуемого владельцем, может обработать сообщение [**WM \_ меасуреитем**](wm-measureitem.md) , чтобы указать размеры элементов списка в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-246">The owner of an owner-drawn combo box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items in the combo box.</span></span> <span data-ttu-id="63605-247">Если приложение создает поле со списком с помощью стиля [**CBS \_ овнердравфиксед**](combo-box-styles.md) , система отправляет сообщение **WM \_ меасуреитем** только один раз.</span><span class="sxs-lookup"><span data-stu-id="63605-247">If the application creates the combo box by using the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="63605-248">Измерения, заданные владельцем, используются для всех элементов списка.</span><span class="sxs-lookup"><span data-stu-id="63605-248">The dimensions specified by the owner are used for all list items.</span></span> <span data-ttu-id="63605-249">Если используется [**стиль \_ овнердраввариабле CBS**](combo-box-styles.md) , система отправляет сообщение **WM \_ меасуреитем** для каждого элемента списка, добавленного в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-249">If the [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item added to the combo box.</span></span> <span data-ttu-id="63605-250">Владелец может определить или задать высоту элемента списка в любое время с помощью сообщений [**CB \_ GETITEMHEIGHT**](cb-getitemheight.md) и [**CB \_ сетитемхеигхт**](cb-setitemheight.md) соответственно.</span><span class="sxs-lookup"><span data-stu-id="63605-250">The owner can determine or set the height of a list item at any time by using the [**CB\_GETITEMHEIGHT**](cb-getitemheight.md) and [**CB\_SETITEMHEIGHT**](cb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="63605-251">Если сведения, отображаемые в поле со списком, рисуемом владельцем, содержат текст, приложение может отследить текст для каждого элемента списка, указав стиль [**CBS \_ хасстрингс**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-251">If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the [**CBS\_HASSTRINGS**](combo-box-styles.md) style.</span></span> <span data-ttu-id="63605-252">Поля со списком, имеющие стиль [**\_ сортировки CBS**](combo-box-styles.md) , сортируются на основе этого текста.</span><span class="sxs-lookup"><span data-stu-id="63605-252">Combo boxes with the [**CBS\_SORT**](combo-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="63605-253">Если поле со списком отсортировано, а не имеет стиль **CBS \_ хасстрингс** , владелец должен обработать сообщение [**WM \_ компареитем**](wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-253">If a combo box is sorted and not of the **CBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="63605-254">В поле со списком, рисуемом владельцем, владелец должен отследить элементы списка, содержащие сведения, кроме текста.</span><span class="sxs-lookup"><span data-stu-id="63605-254">In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text.</span></span> <span data-ttu-id="63605-255">Один из удобных способов сделать это — сохранить данные об элементе в виде данных элемента.</span><span class="sxs-lookup"><span data-stu-id="63605-255">One convenient way to do this is to save the handle to the information as item data.</span></span> <span data-ttu-id="63605-256">Чтобы освободить объекты данных, связанные с элементами в поле со списком, владелец может обработать сообщение [**WM \_ DELETEITEM**](wm-deleteitem.md) .</span><span class="sxs-lookup"><span data-stu-id="63605-256">To free data objects associated with items in a combo box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

## <a name="subclassed-combo-boxes"></a><span data-ttu-id="63605-257">Поля со списком для подклассов</span><span class="sxs-lookup"><span data-stu-id="63605-257">Subclassed Combo Boxes</span></span>

<span data-ttu-id="63605-258">Подклассы — это процедура, которая позволяет приложению перехватывать и обрабатывать сообщения, отправленные или отправляемые в окно.</span><span class="sxs-lookup"><span data-stu-id="63605-258">Subclassing is a procedure that allows an application to intercept and process messages sent or posted to a window.</span></span> <span data-ttu-id="63605-259">С помощью подклассов приложение может заменить свою обработку определенными сообщениями, продолжая обработку большинства сообщений в процедуру окна, определенную классом.</span><span class="sxs-lookup"><span data-stu-id="63605-259">By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure.</span></span>

<span data-ttu-id="63605-260">Когда операционная система создает окно, она сохраняет сведения о нем во внутренней структуре данных, которая включает указатель на процедуру окна.</span><span class="sxs-lookup"><span data-stu-id="63605-260">When the operating system creates a window, it saves information about it in an internal data structure that includes a pointer to the window procedure.</span></span> <span data-ttu-id="63605-261">Чтобы создать подкласс окна, приложение вызывает функцию [**сеткласслонг**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) , чтобы заменить указатель на эту процедуру указателем на процедуру-подкласс, определяемую приложением.</span><span class="sxs-lookup"><span data-stu-id="63605-261">To subclass a window, an application calls the [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) function to replace the pointer to that procedure with a pointer to an application-defined subclass procedure.</span></span> <span data-ttu-id="63605-262">После этого все сообщения в окне отправляются в процедуру подкласс.</span><span class="sxs-lookup"><span data-stu-id="63605-262">Thereafter, all messages to the window are sent to the subclass procedure.</span></span> <span data-ttu-id="63605-263">Затем эта процедура использует функцию [**каллвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) для передачи необработанных сообщений в исходную процедуру окна.</span><span class="sxs-lookup"><span data-stu-id="63605-263">This procedure then uses the [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) function to pass unprocessed messages to the original window procedure.</span></span> <span data-ttu-id="63605-264">Описание обработки сообщений, выполняемой процедурой окна класса COMBOBOX, см. в разделе [поведение поля со списком по умолчанию](combo-box-features.md).</span><span class="sxs-lookup"><span data-stu-id="63605-264">For a description of the message processing performed by the COMBOBOX class window procedure, see [Default Combo Box Behavior](combo-box-features.md).</span></span>

<span data-ttu-id="63605-265">Если поле со списком находится за пределами диалогового окна, приложение не может обработать клавиши TAB, ENTER и ESC, если только не использует процедуру подкласса.</span><span class="sxs-lookup"><span data-stu-id="63605-265">When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESC keys unless it uses a subclass procedure.</span></span> <span data-ttu-id="63605-266">Когда простое или раскрывающееся поле со списком получает фокус ввода, оно немедленно устанавливает фокус на его дочерний элемент управления Edit.</span><span class="sxs-lookup"><span data-stu-id="63605-266">When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control.</span></span> <span data-ttu-id="63605-267">Поэтому приложение должно подделать подкласс для элемента управления "поле ввода" для перехвата ввода с клавиатуры для простого или раскрывающегося поля со списком.</span><span class="sxs-lookup"><span data-stu-id="63605-267">Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box.</span></span> <span data-ttu-id="63605-268">Пример см. в разделе [подклассировать поле со списком](using-combo-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="63605-268">For an example of this, see [Subclassing a Combo Box](using-combo-boxes.md).</span></span>

<span data-ttu-id="63605-269">Если процедура подкласса обрабатывает сообщение [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) , для подготовки к рисованию необходимо использовать функцию [**бегинпаинт**](/windows/desktop/api/winuser/nf-winuser-beginpaint) .</span><span class="sxs-lookup"><span data-stu-id="63605-269">If a subclass procedure processes the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, it must use the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function to prepare for painting.</span></span> <span data-ttu-id="63605-270">Перед вызовом функции [**ендпаинт**](/windows/desktop/api/winuser/nf-winuser-endpaint) он передает в качестве параметра *wParam* в оконной процедуре маркер контекста устройства (DC).</span><span class="sxs-lookup"><span data-stu-id="63605-270">Before calling the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function, it passes the device context (DC) handle as the *wParam* parameter for the window procedure.</span></span> <span data-ttu-id="63605-271">Если **ендпаинт** вызывается первым, то процедура окна класса не зарисовывается, так как **ендпаинт** проверяет все окно.</span><span class="sxs-lookup"><span data-stu-id="63605-271">If **EndPaint** is called first, the class window procedure does no painting because **EndPaint** validates the entire window.</span></span>

<span data-ttu-id="63605-272">Метод, связанный с подклассом, является подклассом.</span><span class="sxs-lookup"><span data-stu-id="63605-272">A technique related to subclassing is superclassing.</span></span> <span data-ttu-id="63605-273">Суперкласс похож на любой другой класс, за исключением того, что его оконная процедура не вызывает [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) для обработки необработанных сообщений.</span><span class="sxs-lookup"><span data-stu-id="63605-273">A superclass resembles any other class except that its window procedure does not call [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) to handle unprocessed messages.</span></span> <span data-ttu-id="63605-274">Вместо этого он передает необработанные сообщения в процедуру окна для класса родительского окна.</span><span class="sxs-lookup"><span data-stu-id="63605-274">Instead, it passes unprocessed messages to the window procedure for the parent window class.</span></span> <span data-ttu-id="63605-275">Следуйте рекомендациям в [оконных процедурах](/windows/desktop/winmsg/window-procedures) , чтобы избежать проблем, которые могут возникнуть при использовании подкласса и класса.</span><span class="sxs-lookup"><span data-stu-id="63605-275">Follow the guidelines in [Window Procedures](/windows/desktop/winmsg/window-procedures) to avoid problems that can occur with subclassing and superclassing.</span></span>

 

 