---
title: О страницах свойств
description: Страница свойств — это окно, позволяющее пользователю просматривать и изменять свойства элемента.
ms.assetid: 93676a64-7980-48cd-8615-23b14a118e1c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3256959b588e2109740033692c0c528889fc939f
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "105647897"
---
# <a name="about-property-sheets"></a><span data-ttu-id="9551f-103">О страницах свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-103">About Property Sheets</span></span>

<span data-ttu-id="9551f-104">*Страница свойств* — это окно, позволяющее пользователю просматривать и изменять свойства элемента.</span><span class="sxs-lookup"><span data-stu-id="9551f-104">A *property sheet* is a window that allows the user to view and edit the properties of an item.</span></span> <span data-ttu-id="9551f-105">Например, приложение электронной таблицы может использовать страницу свойств, чтобы разрешить пользователю задавать свойства шрифта и границы ячейки, а также просматривать и задавать свойства устройства, такие как диск, принтер или мышь.</span><span class="sxs-lookup"><span data-stu-id="9551f-105">For example, a spreadsheet application can use a property sheet to allow the user to set the font and border properties of a cell or to view and set the properties of a device, such as a disk drive, printer, or mouse.</span></span>

<span data-ttu-id="9551f-106">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="9551f-106">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="9551f-107">Основные сведения о странице свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-107">Property Sheet Basics</span></span>](#property-sheet-basics)
-   [<span data-ttu-id="9551f-108">Диалоговые окна страницы свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-108">Property Sheet Dialog Boxes</span></span>](#property-sheet-dialog-boxes)
-   [<span data-ttu-id="9551f-109">Страницы</span><span class="sxs-lookup"><span data-stu-id="9551f-109">Pages</span></span>](#pages)
-   [<span data-ttu-id="9551f-110">Создание страницы свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-110">Property Sheet Creation</span></span>](#property-sheet-creation)
-   [<span data-ttu-id="9551f-111">Добавление и удаление страниц</span><span class="sxs-lookup"><span data-stu-id="9551f-111">Adding and Removing Pages</span></span>](#adding-and-removing-pages)
-   [<span data-ttu-id="9551f-112">Заголовок и метки страницы свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-112">Property Sheet Title and Page Labels</span></span>](#property-sheet-title-and-page-labels)
-   [<span data-ttu-id="9551f-113">Активация страницы</span><span class="sxs-lookup"><span data-stu-id="9551f-113">Page Activation</span></span>](#page-activation)
-   [<span data-ttu-id="9551f-114">Кнопка "Справка"</span><span class="sxs-lookup"><span data-stu-id="9551f-114">Help Button</span></span>](#help-button)
    -   [<span data-ttu-id="9551f-115">Удаление кнопки «Справка» в строке заголовка</span><span class="sxs-lookup"><span data-stu-id="9551f-115">Removing the Caption Bar Help Button</span></span>](#removing-the-caption-bar-help-button)
-   [<span data-ttu-id="9551f-116">Кнопки ОК, отмена и применить</span><span class="sxs-lookup"><span data-stu-id="9551f-116">OK, Cancel, and Apply Buttons</span></span>](#ok-cancel-and-apply-buttons)
-   [<span data-ttu-id="9551f-117">Мастеры</span><span class="sxs-lookup"><span data-stu-id="9551f-117">Wizards</span></span>](#wizards)

## <a name="property-sheet-basics"></a><span data-ttu-id="9551f-118">Основные сведения о странице свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-118">Property Sheet Basics</span></span>

<span data-ttu-id="9551f-119">Чтобы реализовать вкладки свойств в приложении, включите в проект файл заголовка Пршт. h.</span><span class="sxs-lookup"><span data-stu-id="9551f-119">To implement property sheets in your application, include the Prsht.h header file in your project.</span></span> <span data-ttu-id="9551f-120">Пршт. h содержит все идентификаторы, используемые со страницами свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-120">Prsht.h contains all of the identifiers used with property sheets.</span></span>

<span data-ttu-id="9551f-121">Страница свойств содержит одно или несколько перекрывающихся окон, которые называются страницами, каждая из которых содержит окна элементов управления для настройки группы связанных свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-121">A property sheet contains one or more overlapping child windows called pages, each containing control windows for setting a group of related properties.</span></span> <span data-ttu-id="9551f-122">Например, страница может содержать элементы управления для установки свойств шрифта элемента, включая стиль типа, размер точки, цвет и т. д.</span><span class="sxs-lookup"><span data-stu-id="9551f-122">For example, a page can contain the controls for setting the font properties of an item, including the type style, point size, color, and so on.</span></span> <span data-ttu-id="9551f-123">Каждая страница содержит вкладку, которую пользователь может выбрать, чтобы отобразить страницу на передний план страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-123">Each page has a tab that the user can select to bring the page to the foreground of the property sheet.</span></span> <span data-ttu-id="9551f-124">Например, в приложении панели управления Date-Time отображается следующая страница свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-124">For example, the Date-Time control panel application displays the following property sheet.</span></span>

![снимок экрана: страница свойств с двумя вкладками, одна из которых показывает часы и месячный элемент управления "Календарь"](images/propsheet1.png)

<span data-ttu-id="9551f-126">Стандартная страница свойств с несколькими страницами с вкладками позволяет пользователю получить произвольный доступ ко всем свойствам.</span><span class="sxs-lookup"><span data-stu-id="9551f-126">A standard property sheet with multiple, tabbed pages allows the user random access to all properties.</span></span> <span data-ttu-id="9551f-127">Если свойства больше подходят для задания последовательности, можно использовать [Мастер](#wizards).</span><span class="sxs-lookup"><span data-stu-id="9551f-127">If it is more appropriate to have properties set in sequence, you can use a [wizard](#wizards).</span></span>

## <a name="property-sheet-dialog-boxes"></a><span data-ttu-id="9551f-128">Диалоговые окна страницы свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-128">Property Sheet Dialog Boxes</span></span>

<span data-ttu-id="9551f-129">Страница свойств и содержащаяся в ней страницами фактически являются диалоговыми окнами.</span><span class="sxs-lookup"><span data-stu-id="9551f-129">A property sheet and the pages it contains are actually dialog boxes.</span></span> <span data-ttu-id="9551f-130">Страница свойств является системным диалоговым окном, которое управляет страницами и предоставляет общий контейнер для них.</span><span class="sxs-lookup"><span data-stu-id="9551f-130">The property sheet is a system-defined dialog box that manages the pages and provides a common container for them.</span></span> <span data-ttu-id="9551f-131">Диалоговое окно «страница свойств» может быть модальным или немодальным.</span><span class="sxs-lookup"><span data-stu-id="9551f-131">A property sheet dialog box can be modal or modeless.</span></span> <span data-ttu-id="9551f-132">Он включает рамку, строку заголовка и четыре кнопки: **ОК**, **Отмена**, **Применить** и (необязательно) **справку**.</span><span class="sxs-lookup"><span data-stu-id="9551f-132">It includes a frame, a title bar, and four buttons: **OK**, **Cancel**, **Apply**, and (optionally) **Help**.</span></span> <span data-ttu-id="9551f-133">Процедуры диалоговых окон получают коды уведомлений в форме [**WM \_ Notify**](wm-notify.md) messages, когда пользователь нажимает кнопку.</span><span class="sxs-lookup"><span data-stu-id="9551f-133">The dialog box procedures for the pages receive notification codes in the form of [**WM\_NOTIFY**](wm-notify.md) messages when the user clicks the buttons.</span></span>

> [!NOTE]  
> <span data-ttu-id="9551f-134">Не все сведения в этом разделе относятся к мастерам, которые имеют несколько различного внешнего вида и поведения.</span><span class="sxs-lookup"><span data-stu-id="9551f-134">Not all the information in this section applies to wizards, which have a somewhat different appearance and behavior.</span></span> <span data-ttu-id="9551f-135">Например, мастеры имеют разные наборы кнопок и не имеют вкладок.</span><span class="sxs-lookup"><span data-stu-id="9551f-135">For example, wizards have a different set of buttons and no tabs.</span></span> <span data-ttu-id="9551f-136">Дополнительные сведения см. в разделе [Создание мастеров](wizards.md).</span><span class="sxs-lookup"><span data-stu-id="9551f-136">For more information, see [Creating Wizards](wizards.md).</span></span>

<span data-ttu-id="9551f-137">Каждая страница на странице свойств является определенным приложением немодальным диалоговым окном, которое управляет окнами управления, используемыми для просмотра и редактирования свойств элемента.</span><span class="sxs-lookup"><span data-stu-id="9551f-137">Each page in a property sheet is an application-defined modeless dialog box that manages the control windows used to view and edit the properties of an item.</span></span> <span data-ttu-id="9551f-138">Вы предоставляете шаблон диалогового окна, используемый для создания каждой страницы, а также процедуру диалогового окна, которая управляет элементами управления и задает свойства соответствующего элемента.</span><span class="sxs-lookup"><span data-stu-id="9551f-138">You provide the dialog box template used to create each page as well as the dialog box procedure that manages the controls and sets the properties of the corresponding item.</span></span>

<span data-ttu-id="9551f-139">Страница свойств отправляет коды уведомлений в процедуру диалогового окна для страницы, когда она получает или теряет активацию, а также когда пользователь нажимает кнопку **ОК**, **Отмена**, **Применить** или **Справка** .</span><span class="sxs-lookup"><span data-stu-id="9551f-139">A property sheet sends notification codes to the dialog box procedure for a page when the page is gaining or losing the activation and when the user clicks the **OK**, **Cancel**, **Apply**, or **Help** button.</span></span> <span data-ttu-id="9551f-140">Уведомления отправляются в виде сообщений [**\_ уведомления WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-140">The notifications are sent in the form of [**WM\_NOTIFY**](wm-notify.md) messages.</span></span> <span data-ttu-id="9551f-141">Параметр *lParam* — это адрес структуры [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) , которая включает в себя обработчик окна для диалогового окна страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-141">The *lParam* parameter is the address of an [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) structure that includes the window handle to the property sheet dialog box.</span></span>

<span data-ttu-id="9551f-142">Для некоторых кодов уведомлений требуется, чтобы страница возвращала **значение true** или **false** в ответ на сообщение [**\_ уведомления WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-142">Some notification codes require a page to return either **TRUE** or **FALSE** in response to the [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <span data-ttu-id="9551f-143">Для этого на странице должна быть использована функция [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) , чтобы задать для диалогового окна "страница" значение **\_ Мсгресулт** ( **true** или **false**).</span><span class="sxs-lookup"><span data-stu-id="9551f-143">To do this, the page must use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value for the page dialog box to either **TRUE** or **FALSE**.</span></span>

## <a name="pages"></a><span data-ttu-id="9551f-144">Страницы</span><span class="sxs-lookup"><span data-stu-id="9551f-144">Pages</span></span>

<span data-ttu-id="9551f-145">Страница свойств должна содержать по крайней мере одну страницу, но она не может содержать больше, чем значение **макспроппажес** , как определено в файлах заголовков Windows.</span><span class="sxs-lookup"><span data-stu-id="9551f-145">A property sheet must contain at least one page, but it cannot contain more than the value of **MAXPROPPAGES** as defined in the Windows header files.</span></span> <span data-ttu-id="9551f-146">Каждая страница содержит Отсчитываемый от нуля индекс, назначаемый странице свойств в соответствии с порядком добавления страницы в страницу свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-146">Each page has a zero-based index that the property sheet assigns according to the order in which the page is added to the property sheet.</span></span> <span data-ttu-id="9551f-147">Индексы используются в сообщениях, отправляемых на страницу свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-147">The indexes are used in messages that you send to the property sheet.</span></span>

<span data-ttu-id="9551f-148">Страница свойств может содержать вложенное диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="9551f-148">A property page can contain a nested dialog box.</span></span> <span data-ttu-id="9551f-149">Если это так, необходимо включить стиль [**WS \_ ex \_ контролпарент**](/windows/desktop/winmsg/extended-window-styles) для диалогового окна верхнего уровня и вызвать функцию [**исдиалогмессаже**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) с маркером родительского диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="9551f-149">If it does, you must include the [**WS\_EX\_CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) style for the top-level dialog box and call the [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) function with the handle to the parent dialog box.</span></span> <span data-ttu-id="9551f-150">Это гарантирует, что пользователь сможет использовать нажатия клавиш и клавиши навигации диалогового окна, чтобы переместить фокус на элементы управления во вложенном диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="9551f-150">This ensures that the user can use mnemonics and the dialog box navigation keys to move the focus to controls in the nested dialog box.</span></span>

<span data-ttu-id="9551f-151">Каждая страница имеет соответствующий значок и метку.</span><span class="sxs-lookup"><span data-stu-id="9551f-151">Each page has a corresponding icon and label.</span></span> <span data-ttu-id="9551f-152">Страница свойств создает вкладку для каждой страницы и отображает значок и метку на вкладке. Все страницы свойств должны использовать нежирный шрифт.</span><span class="sxs-lookup"><span data-stu-id="9551f-152">The property sheet creates a tab for each page and displays the icon and label in the tab. All property sheet pages are expected to use a nonbold font.</span></span> <span data-ttu-id="9551f-153">Чтобы убедиться, что шрифт не является полужирным, укажите в шаблоне диалогового окна стиль **\_ 3DLOOK в DS** .</span><span class="sxs-lookup"><span data-stu-id="9551f-153">To ensure that the font is not bold, specify the **DS\_3DLOOK** style in the dialog box template.</span></span>

<span data-ttu-id="9551f-154">Процедура диалогового окна для страницы не должна вызывать функцию [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) .</span><span class="sxs-lookup"><span data-stu-id="9551f-154">The dialog box procedure for a page must not call the [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) function.</span></span> <span data-ttu-id="9551f-155">Это приведет к уничтожению всей страницы свойств, а не только странице.</span><span class="sxs-lookup"><span data-stu-id="9551f-155">Doing so will destroy the entire property sheet, not just the page.</span></span>

<span data-ttu-id="9551f-156">Минимальный размер страницы свойств — 212 единиц диалогового окна по горизонтали и 114 единиц диалогового окна по вертикали.</span><span class="sxs-lookup"><span data-stu-id="9551f-156">The minimum size for a property sheet page is 212 dialog units horizontally and 114 dialog units vertically.</span></span> <span data-ttu-id="9551f-157">Если диалоговое окно страницы меньше этого размера, то страница будет увеличена до тех пор, пока не превысит минимальный размер.</span><span class="sxs-lookup"><span data-stu-id="9551f-157">If a page dialog is smaller than this, the page will be enlarged until it meets the minimum size.</span></span> <span data-ttu-id="9551f-158">Файл заголовка Пршт. h содержит три набора рекомендуемых размеров для страниц свойств, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="9551f-158">The Prsht.h header file contains three sets of recommended sizes for property sheet pages, as shown in the following table.</span></span>

|  <span data-ttu-id="9551f-159">Размер</span><span class="sxs-lookup"><span data-stu-id="9551f-159">Size</span></span>                |   <span data-ttu-id="9551f-160">Описание</span><span class="sxs-lookup"><span data-stu-id="9551f-160">Description</span></span>                                                   |
|----------------------|-----------------------------------------------------------------|
| <span data-ttu-id="9551f-161">**PROP \_ SM \_ кксдлг**</span><span class="sxs-lookup"><span data-stu-id="9551f-161">**PROP\_SM\_CXDLG**</span></span>  | <span data-ttu-id="9551f-162">Ширина (в диалоговых единицах) небольшой страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-162">Width, in dialog units, of a small property sheet page.</span></span>         |
| <span data-ttu-id="9551f-163">**PROP \_ SM \_ цидлг**</span><span class="sxs-lookup"><span data-stu-id="9551f-163">**PROP\_SM\_CYDLG**</span></span>  | <span data-ttu-id="9551f-164">Высота (в единицах диалоговых окон) небольшой страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-164">Height, in dialog units, of a small property sheet page.</span></span>        |
| <span data-ttu-id="9551f-165">**PROP \_ MED \_ кксдлг**</span><span class="sxs-lookup"><span data-stu-id="9551f-165">**PROP\_MED\_CXDLG**</span></span> | <span data-ttu-id="9551f-166">Ширина (в диалоговых единицах) страницы свойств среднего размера.</span><span class="sxs-lookup"><span data-stu-id="9551f-166">Width, in dialog units, of a medium-sized property sheet page.</span></span>  |
| <span data-ttu-id="9551f-167">**PROP \_ MED \_ цидлг**</span><span class="sxs-lookup"><span data-stu-id="9551f-167">**PROP\_MED\_CYDLG**</span></span> | <span data-ttu-id="9551f-168">Высота страницы свойств среднего размера в диалоговых единицах.</span><span class="sxs-lookup"><span data-stu-id="9551f-168">Height, in dialog units, of a medium-sized property sheet page.</span></span> |
| <span data-ttu-id="9551f-169">**PROP \_ LG \_ кксдлг**</span><span class="sxs-lookup"><span data-stu-id="9551f-169">**PROP\_LG\_CXDLG**</span></span>  | <span data-ttu-id="9551f-170">Ширина на единицах диалогового окна большой страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-170">Width, in dialog units, of a large property sheet page.</span></span>         |
| <span data-ttu-id="9551f-171">**PROP \_ LG \_ цидлг**</span><span class="sxs-lookup"><span data-stu-id="9551f-171">**PROP\_LG\_CYDLG**</span></span>  | <span data-ttu-id="9551f-172">Высота на единицах диалогового окна большой страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-172">Height, in dialog units, of a large property sheet page.</span></span>        |

<span data-ttu-id="9551f-173">Использование этих рекомендуемых размеров поможет обеспечить согласованность визуальных элементов приложения и других приложений Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="9551f-173">Using these recommended sizes will help ensure visual consistency between your application and other Microsoft Windows applications.</span></span>

<span data-ttu-id="9551f-174">В редакторе ресурсов Microsoft Visual Studio можно создать страницу соответствующего размера в диалоговом окне **Добавление ресурса** .</span><span class="sxs-lookup"><span data-stu-id="9551f-174">In the Microsoft Visual Studio resource editor, you can create a page of the appropriate size in the **Add Resource** dialog box.</span></span> <span data-ttu-id="9551f-175">Разверните узел диалогового окна и выберите **Идд ( \_ \_ крупный**), **Идд ( \_ \_ средний**) или **Идд ( \_ \_ малый**).</span><span class="sxs-lookup"><span data-stu-id="9551f-175">Expand the Dialog node and select **IDD\_PROPPAGE\_LARGE**, **IDD\_PROPPAGE\_MEDIUM**, or **IDD\_PROPPAGE\_SMALL**.</span></span>

<span data-ttu-id="9551f-176">Лист свойств автоматически изменяется в соответствии с самой крупной страницей.</span><span class="sxs-lookup"><span data-stu-id="9551f-176">The property sheet is automatically sized to accommodate the largest page.</span></span>

## <a name="property-sheet-creation"></a><span data-ttu-id="9551f-177">Создание страницы свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-177">Property Sheet Creation</span></span>

<span data-ttu-id="9551f-178">Перед созданием страницы свойств необходимо определить одну или несколько страниц.</span><span class="sxs-lookup"><span data-stu-id="9551f-178">Before creating a property sheet, you must define one or more pages.</span></span> <span data-ttu-id="9551f-179">Это включает в себя заполнение структуры [**пропшитпаже**](pss-propsheetpage.md) информацией о странице — ее значком, меткой, шаблоном диалогового окна, процедурой диалогового окна и т. д., а затем указание адреса структуры в вызове функции [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) .</span><span class="sxs-lookup"><span data-stu-id="9551f-179">This involves filling a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure with information about the page—its icon, label, dialog box template, dialog box procedure, and so on—and then specifying the address of the structure in a call to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function.</span></span> <span data-ttu-id="9551f-180">Функция возвращает маркер типа ХПРОПШИТПАЖЕ, который однозначно определяет страницу.</span><span class="sxs-lookup"><span data-stu-id="9551f-180">The function returns a handle to the HPROPSHEETPAGE type that uniquely identifies the page.</span></span>

<span data-ttu-id="9551f-181">Чтобы создать страницу свойств, необходимо указать адрес структуры [**пропшисеадер**](pss-propsheetheader.md) в вызове функции [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="9551f-181">To create a property sheet, you specify the address of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure in a call to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span> <span data-ttu-id="9551f-182">Структура определяет значок и заголовок для страницы свойств, а также включает адрес массива дескрипторов ХПРОПШИТПАЖЕ, полученных с помощью [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span><span class="sxs-lookup"><span data-stu-id="9551f-182">The structure defines the icon and title for the property sheet and also includes the address of an array of HPROPSHEETPAGE handles that you obtain by using [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span></span> <span data-ttu-id="9551f-183">Когда **Страница свойств** создает страницу свойств, она включает страницы, указанные в массиве.</span><span class="sxs-lookup"><span data-stu-id="9551f-183">When **PropertySheet** creates the property sheet, it includes the pages identified in the array.</span></span> <span data-ttu-id="9551f-184">Страницы отображаются на странице свойств в том же порядке, в котором они содержатся в массиве.</span><span class="sxs-lookup"><span data-stu-id="9551f-184">The pages appear in the property sheet in the same order that they are contained in the array.</span></span>

<span data-ttu-id="9551f-185">Другим способом назначения страниц на страницу свойств является указание массива структур [**пропшитпаже**](pss-propsheetpage.md) вместо массива дескрипторов **хпропшитпаже** .</span><span class="sxs-lookup"><span data-stu-id="9551f-185">Another way to assign pages to a property sheet is to specify an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures instead of an array of **HPROPSHEETPAGE** handles.</span></span> <span data-ttu-id="9551f-186">В этом случае [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) создает дескрипторы для страниц перед их добавлением в страницу свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-186">In this case, [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) creates handles for the pages before adding them to the property sheet.</span></span>

<span data-ttu-id="9551f-187">При создании страницы процедура диалогового окна получает сообщение [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="9551f-187">When a page is created, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="9551f-188">Параметр *lParam* сообщения является указателем на копию структуры [**пропшитпаже**](pss-propsheetpage.md) , которая определяется при создании страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-188">The message's *lParam* parameter is a pointer to a copy of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that is defined when the page is created.</span></span> <span data-ttu-id="9551f-189">В частности, при создании страницы член **lParam** структуры может использоваться для передачи сведений, определяемых приложением, в процедуру диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="9551f-189">In particular, when a page is created, the structure's **lParam** member can be used to pass application-defined information to the dialog box procedure.</span></span> <span data-ttu-id="9551f-190">За исключением члена **lParam** , эта структура должна рассматриваться как доступная только для чтения.</span><span class="sxs-lookup"><span data-stu-id="9551f-190">With the exception of the **lParam** member, this structure must be treated as read-only.</span></span> <span data-ttu-id="9551f-191">Изменение любого, кроме **lParam** , приведет к непредсказуемым последствиям.</span><span class="sxs-lookup"><span data-stu-id="9551f-191">Modifying anything other than **lParam** will have unpredictable consequences.</span></span>

<span data-ttu-id="9551f-192">Когда система впоследствии передает копию структуры [**пропшитпаже**](pss-propsheetpage.md) страницы в приложение, она использует тот же указатель.</span><span class="sxs-lookup"><span data-stu-id="9551f-192">When the system subsequently passes a copy of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to your application, it uses the same pointer.</span></span> <span data-ttu-id="9551f-193">Все изменения в структуре будут передаваться вместе с.</span><span class="sxs-lookup"><span data-stu-id="9551f-193">Any changes to the structure will be passed along.</span></span> <span data-ttu-id="9551f-194">Поскольку член **lParam** игнорируется системой, его можно изменить для отправки данных в другие части приложения.</span><span class="sxs-lookup"><span data-stu-id="9551f-194">Because the **lParam** member is ignored by the system, it can be modified to send information to other parts of your application.</span></span> <span data-ttu-id="9551f-195">Например, можно использовать **lParam** для передачи информации в функцию обратного вызова [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-195">You can, for instance, use **lParam** to pass information to the page's [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function.</span></span>

<span data-ttu-id="9551f-196">[**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) автоматически задает размер и начальное расположение страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-196">[**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) automatically sets the size and initial position of a property sheet.</span></span> <span data-ttu-id="9551f-197">Расположение основано на положении окна-владельца, а размер — на самой крупной странице, указанной в массиве страниц при создании страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-197">The position is based on the position of the owner window, and the size is based on the largest page specified in the array of pages when the property sheet was created.</span></span> <span data-ttu-id="9551f-198">Если нужно, чтобы страницы совпадали с шириной четырех кнопок в нижней части страницы свойств, установите ширину самой широкой страницы равным 190 единицам диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="9551f-198">If you want the pages to match the width of the four buttons at the bottom of the property sheet, set the width of the widest page to 190 dialog units.</span></span>

<span data-ttu-id="9551f-199">Размер страницы свойств вычисляются на основе свойств *Width* и *Height* шаблона диалогового окна в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="9551f-199">The size of a property sheet is computed from the *width* and *height* properties of the dialog template in the resource file.</span></span> <span data-ttu-id="9551f-200">Дополнительные сведения см. в разделе [**ресурс диалога**](/windows/desktop/menurc/dialog-resource) или [**ресурс диаложекс**](/windows/desktop/menurc/dialogex-resource) .</span><span class="sxs-lookup"><span data-stu-id="9551f-200">See [**DIALOG Resource**](/windows/desktop/menurc/dialog-resource) or [**DIALOGEX Resource**](/windows/desktop/menurc/dialogex-resource) for further details.</span></span> <span data-ttu-id="9551f-201">Однако обратите внимание, что в целях совместимости измерения вычисляются относительно шрифта MS Shell Dlg, а не шрифта, используемого страницей.</span><span class="sxs-lookup"><span data-stu-id="9551f-201">Note, however, that for compatibility reasons, the dimensions are computed relative to the MS Shell Dlg font rather than the font used by the page.</span></span> <span data-ttu-id="9551f-202">При проектировании страницы, использующей другой шрифт, можно использовать одно из следующих предложений.</span><span class="sxs-lookup"><span data-stu-id="9551f-202">If you design a page that uses another font, one of the following suggestions can be used.</span></span>

-   <span data-ttu-id="9551f-203">Настройте размеры шаблона диалогового окна, чтобы компенсировать разницу в размере между шрифтом MS Shell Dlg и шрифтом, используемым страницей в действительности.</span><span class="sxs-lookup"><span data-stu-id="9551f-203">Adjust the dimensions of the dialog template to compensate for the difference in size between the MS Shell Dlg font and the font the page actually uses.</span></span> <span data-ttu-id="9551f-204">Например, если выбрать шрифт, который вдвое шире, чем MS Shell Dlg, задайте для свойства Width диалогового окна значение дважды в качестве обычного.</span><span class="sxs-lookup"><span data-stu-id="9551f-204">For example, if you choose a font that is twice as wide as MS Shell Dlg, then set the dialog template's width property to twice the normal use.</span></span>
-   <span data-ttu-id="9551f-205">Используйте шаблон [**диаложекс**](/windows/desktop/menurc/dialogex-resource) и задайте стиль диалогового окна **DS \_ шеллфонт** .</span><span class="sxs-lookup"><span data-stu-id="9551f-205">Use a [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) template and set the **DS\_SHELLFONT** dialog style.</span></span> <span data-ttu-id="9551f-206">В этом случае диспетчер страниц свойств интерпретирует измерения диалогового окна относительно шрифта, используемого шаблоном диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="9551f-206">In that case, the property sheet manager interprets the dialog template dimensions relative to the font used by the dialog template.</span></span>

## <a name="adding-and-removing-pages"></a><span data-ttu-id="9551f-207">Добавление и удаление страниц</span><span class="sxs-lookup"><span data-stu-id="9551f-207">Adding and Removing Pages</span></span>

<span data-ttu-id="9551f-208">После создания страницы свойств приложение может добавить страницу в конец существующего набора страниц, отправив сообщение [**ПСМ \_ ADDPAGE**](psm-addpage.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-208">After creating a property sheet, an application can add a page to the end of the existing set of pages by sending a [**PSM\_ADDPAGE**](psm-addpage.md) message.</span></span> <span data-ttu-id="9551f-209">Чтобы вставить страницу между существующими страницами, отправьте сообщение [**пропшит \_ инсертпаже**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) .</span><span class="sxs-lookup"><span data-stu-id="9551f-209">To insert a page between existing pages, send a [**PropSheet\_InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) message.</span></span> <span data-ttu-id="9551f-210">Обратите внимание, что размер страницы свойств не может быть изменен после ее создания.</span><span class="sxs-lookup"><span data-stu-id="9551f-210">Note that the size of the property sheet cannot change after it has been created.</span></span> <span data-ttu-id="9551f-211">Все добавленные или вставленные страницы должны быть не больше самой большой страницы, находящегося в данный момент на странице свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-211">Any added or inserted pages must be no larger than the largest page currently in the property sheet.</span></span> <span data-ttu-id="9551f-212">Чтобы удалить страницу, отправьте сообщение [**ПСМ \_ REMOVEPAGE**](psm-removepage.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-212">To remove a page, send a [**PSM\_REMOVEPAGE**](psm-removepage.md) message.</span></span>

<span data-ttu-id="9551f-213">При определении страницы можно указать адрес функции обратного вызова [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) , которую вызывает страница свойств при создании или удалении страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-213">When you define a page, you can specify the address of a [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function that the property sheet calls when it is creating or removing the page.</span></span> <span data-ttu-id="9551f-214">Использование *пропшитпажепрок* дает возможность выполнять операции инициализации и очистки для отдельных страниц.</span><span class="sxs-lookup"><span data-stu-id="9551f-214">Using *PropSheetPageProc* gives you an opportunity to perform initialization and cleanup operations for individual pages.</span></span>

> [!NOTE]  
> <span data-ttu-id="9551f-215">Количество сообщений и один вызов функции происходят, когда страница свойств манипулирует списком страниц.</span><span class="sxs-lookup"><span data-stu-id="9551f-215">A number of messages and one function call occur while the property sheet is manipulating the list of pages.</span></span> <span data-ttu-id="9551f-216">При выполнении этого действия попытка изменить список страниц приведет к непредсказуемым результатам.</span><span class="sxs-lookup"><span data-stu-id="9551f-216">While this action is taking place, attempting to modify the list of pages will have unpredictable results.</span></span> <span data-ttu-id="9551f-217">Не добавляйте, вставляйте или удаляйте страницы в реализации [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka)или при обработке следующих уведомлений и сообщений Windows.</span><span class="sxs-lookup"><span data-stu-id="9551f-217">Do not add, insert, or remove pages in your implementation of [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka), or while handling the following notifications and Windows messages.</span></span>
>
> -   [<span data-ttu-id="9551f-218">PSN \_ Применить</span><span class="sxs-lookup"><span data-stu-id="9551f-218">PSN\_APPLY</span></span>](psn-apply.md)
> -   [<span data-ttu-id="9551f-219">PSN \_ киллактиве</span><span class="sxs-lookup"><span data-stu-id="9551f-219">PSN\_KILLACTIVE</span></span>](psn-killactive.md)
> -   [<span data-ttu-id="9551f-220">\_Сброс PSN</span><span class="sxs-lookup"><span data-stu-id="9551f-220">PSN\_RESET</span></span>](psn-reset.md)
> -   [<span data-ttu-id="9551f-221">PSN \_ сетактиве</span><span class="sxs-lookup"><span data-stu-id="9551f-221">PSN\_SETACTIVE</span></span>](psn-setactive.md)
> -   [<span data-ttu-id="9551f-222">PSN \_ визбакк</span><span class="sxs-lookup"><span data-stu-id="9551f-222">PSN\_WIZBACK</span></span>](psn-wizback.md)
> -   [<span data-ttu-id="9551f-223">PSN \_ визнекст</span><span class="sxs-lookup"><span data-stu-id="9551f-223">PSN\_WIZNEXT</span></span>](psn-wiznext.md)
> -   [<span data-ttu-id="9551f-224">**WM \_ инитдиалог**</span><span class="sxs-lookup"><span data-stu-id="9551f-224">**WM\_INITDIALOG**</span></span>](/windows/desktop/dlgbox/wm-initdialog)
> -   [<span data-ttu-id="9551f-225">**WM \_ destroy**</span><span class="sxs-lookup"><span data-stu-id="9551f-225">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)

<span data-ttu-id="9551f-226">Если возникает необходимость изменить страницу свойств во время обработки одного из этих сообщений или во время выполнения [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) , опубликуйте частное сообщение Windows.</span><span class="sxs-lookup"><span data-stu-id="9551f-226">If the need arises to modify a property sheet page while you are handling one of these messages or while [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) is in operation, post a private Windows message.</span></span> <span data-ttu-id="9551f-227">Приложение не будет получать это сообщение до тех пор, пока диспетчер страниц свойств не завершит свои задачи, после чего вы сможете изменить список страниц.</span><span class="sxs-lookup"><span data-stu-id="9551f-227">Your application will not receive that message until after the property sheet manager has finished its tasks, at which point it will be safe to modify the list of pages.</span></span>

<span data-ttu-id="9551f-228">При удалении страницы свойств она автоматически удаляет все добавленные в нее страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-228">When a property sheet is destroyed, it automatically destroys all of the pages that have been added to it.</span></span> <span data-ttu-id="9551f-229">Страницы уничтожаются в обратном порядке, указанном в массиве, используемом для создания страниц.</span><span class="sxs-lookup"><span data-stu-id="9551f-229">The pages are destroyed in reverse order from that specified in the array used to create the pages.</span></span> <span data-ttu-id="9551f-230">Чтобы уничтожить страницу, созданную функцией [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , но не добавленную на страницу свойств, используйте функцию [**дестройпропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) .</span><span class="sxs-lookup"><span data-stu-id="9551f-230">To destroy a page that was created by the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function but was not added to the property sheet, use the [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) function.</span></span>

## <a name="property-sheet-title-and-page-labels"></a><span data-ttu-id="9551f-231">Заголовок и метки страницы свойств</span><span class="sxs-lookup"><span data-stu-id="9551f-231">Property Sheet Title and Page Labels</span></span>

<span data-ttu-id="9551f-232">Задается заголовок страницы свойств в структуре [**пропшисеадер**](pss-propsheetheader.md) , используемой для создания страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-232">You specify the title of a property sheet in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure used to create the property sheet.</span></span> <span data-ttu-id="9551f-233">Если элемент **dwFlags** включает значение **командном PSH \_ проптитле** , то на странице свойств добавляется суффикс "Properties" или префикс "свойства для" в зависимости от версии.</span><span class="sxs-lookup"><span data-stu-id="9551f-233">If the **dwFlags** member includes the **PSH\_PROPTITLE** value, the property sheet adds the suffix "Properties" or the prefix "Properties for", depending on the version.</span></span> <span data-ttu-id="9551f-234">Заголовок можно изменить после создания страницы свойств с помощью сообщения [**ПСМ \_ сеттитле**](psm-settitle.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-234">You can change the title after a property sheet is created by using the [**PSM\_SETTITLE**](psm-settitle.md) message.</span></span> <span data-ttu-id="9551f-235">В мастере Aero это сообщение можно использовать для динамического изменения заголовка внутренней страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-235">In an Aero Wizard, this message can be used to change the title of an interior page dynamically.</span></span>

<span data-ttu-id="9551f-236">По умолчанию страница свойств использует строку имени, указанную в шаблоне диалогового окна, в качестве метки для страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-236">By default, a property sheet uses the name string specified in the dialog box template as the label for a page.</span></span> <span data-ttu-id="9551f-237">Строку имени можно переопределить, включив значение **PSP \_ усетитле** в элемент **dwFlags** структуры [**пропшитпаже**](pss-propsheetpage.md) , определяющей страницу.</span><span class="sxs-lookup"><span data-stu-id="9551f-237">You can override the name string by including the **PSP\_USETITLE** value in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that defines the page.</span></span> <span data-ttu-id="9551f-238">Если задано **PSP \_ усетитле** , то элемент **псзтитле** должен содержать адрес строки метки для страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-238">When **PSP\_USETITLE** is specified, the **pszTitle** member must contain the address of the label string for the page.</span></span>

## <a name="page-activation"></a><span data-ttu-id="9551f-239">Активация страницы</span><span class="sxs-lookup"><span data-stu-id="9551f-239">Page Activation</span></span>

<span data-ttu-id="9551f-240">Страница свойств может содержать только одну активную страницу за раз.</span><span class="sxs-lookup"><span data-stu-id="9551f-240">A property sheet can have only one active page at a time.</span></span> <span data-ttu-id="9551f-241">Страница, на которой активирована активация, находится на переднем плане перекрывающихся стеков страниц.</span><span class="sxs-lookup"><span data-stu-id="9551f-241">The page that has the activation is at the foreground of the overlapping stack of pages.</span></span> <span data-ttu-id="9551f-242">Пользователь активирует страницу, выбирая ее вкладку. приложение активирует страницу с помощью сообщения [**ПСМ \_ сеткурсел**](psm-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-242">The user activates a page by selecting its tab; an application activates a page by using the [**PSM\_SETCURSEL**](psm-setcursel.md) message.</span></span>

<span data-ttu-id="9551f-243">Страница свойств отправляет код уведомления [PSN \_ киллактиве](psn-killactive.md) на страницу, на которой будет потеряна активация.</span><span class="sxs-lookup"><span data-stu-id="9551f-243">The property sheet sends the [PSN\_KILLACTIVE](psn-killactive.md) notification code to the page that is about to lose the activation.</span></span> <span data-ttu-id="9551f-244">В ответ на страницу необходимо проверить все изменения, внесенные пользователем на странице.</span><span class="sxs-lookup"><span data-stu-id="9551f-244">In response, the page must validate any changes that the user has made to the page.</span></span> <span data-ttu-id="9551f-245">Если перед потерей активации страница требует дополнительных входных данных пользователя, используйте функцию [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) , чтобы установить для **значения \_ Мсгресулт** на странице значение **true**.</span><span class="sxs-lookup"><span data-stu-id="9551f-245">If the page requires additional user input before losing the activation, use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value of the page to **TRUE**.</span></span> <span data-ttu-id="9551f-246">Кроме того, на странице должно отобразиться окно сообщения с описанием проблемы и рекомендуемым действием.</span><span class="sxs-lookup"><span data-stu-id="9551f-246">Also, the page must display a message box that describes the problem and provides the recommended action.</span></span> <span data-ttu-id="9551f-247">Задайте для параметра **DWL \_ Мсгресулт** **значение false** , если вы хотите потерять активацию.</span><span class="sxs-lookup"><span data-stu-id="9551f-247">Set **DWL\_MSGRESULT** to **FALSE** when it is okay to lose the activation.</span></span>

<span data-ttu-id="9551f-248">Прежде чем страница, которая получает активацию, была видна, страница свойств отправляет на страницу код уведомления [PSN \_ сетактиве](psn-setactive.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-248">Before the page that is gaining the activation is visible, the property sheet sends the [PSN\_SETACTIVE](psn-setactive.md) notification code to the page.</span></span> <span data-ttu-id="9551f-249">Страница должна отвечать, инициализируя ее окна управления.</span><span class="sxs-lookup"><span data-stu-id="9551f-249">The page must respond by initializing its control windows.</span></span>

## <a name="help-button"></a><span data-ttu-id="9551f-250">Кнопка "Справка"</span><span class="sxs-lookup"><span data-stu-id="9551f-250">Help Button</span></span>

<span data-ttu-id="9551f-251">Вкладки свойств могут отображать две кнопки справки: кнопку справки на странице свойств, которая отображается в нижней части фрейма, рядом с кнопками **ОК** / **Отмена** / **применения** и стандартная кнопка заголовка, предоставляющая контекстную справку.</span><span class="sxs-lookup"><span data-stu-id="9551f-251">Property sheets can display two Help buttons: a property sheet Help button that is displayed at the bottom of the frame, next to the **OK**/**Cancel**/**Apply** buttons, and a standard caption bar button that provides context-sensitive Help.</span></span>

<span data-ttu-id="9551f-252">Кнопка Справка страницы свойств является необязательной и может быть включена на странице по отдельности.</span><span class="sxs-lookup"><span data-stu-id="9551f-252">The property sheet Help button is optional, and can be enabled on a page by page basis.</span></span> <span data-ttu-id="9551f-253">Отображение кнопки Справка на странице свойств для одной или нескольких страниц:</span><span class="sxs-lookup"><span data-stu-id="9551f-253">To display the property sheet Help button for one or more pages:</span></span>

-   <span data-ttu-id="9551f-254">Установите флаг **командном PSH \_ хашелп** в элементе **dwFlags** структуры [**пропшисеадер**](pss-propsheetheader.md) страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-254">Set the **PSH\_HASHELP** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="9551f-255">Для каждой страницы, на которой будет отображаться кнопка справки, установите флаг **PSP \_ хашелп** в элементе **dwFlags** структуры [**пропшитпаже**](pss-propsheetpage.md) страницы.</span><span class="sxs-lookup"><span data-stu-id="9551f-255">For each page that will display a Help button, set the **PSP\_HASHELP** flag in the **dwFlags** member of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>

<span data-ttu-id="9551f-256">Когда пользователь нажимает кнопку "Справка", активная страница получает код уведомления [PSN \_ Help](psn-help.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-256">When the user clicks the Help button, the active page receives a [PSN\_HELP](psn-help.md) notification code.</span></span> <span data-ttu-id="9551f-257">Страница должна отвечать, отображая справочные сведения, как правило, путем вызова функции [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="9551f-257">The page must respond by displaying Help information, typically by calling the [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) function.</span></span>

### <a name="removing-the-caption-bar-help-button"></a><span data-ttu-id="9551f-258">Удаление кнопки «Справка» в строке заголовка</span><span class="sxs-lookup"><span data-stu-id="9551f-258">Removing the Caption Bar Help Button</span></span>

<span data-ttu-id="9551f-259">Кнопка Справка по строке заголовка отображается по умолчанию, так что контекстно-зависимая справка всегда доступна для кнопок ОК/Отмена/применить.</span><span class="sxs-lookup"><span data-stu-id="9551f-259">The caption bar Help button is displayed by default, so that context-sensitive Help is always available for the OK/Cancel/Apply buttons.</span></span> <span data-ttu-id="9551f-260">Однако при необходимости эту кнопку можно удалить.</span><span class="sxs-lookup"><span data-stu-id="9551f-260">However, this button can be removed, if necessary.</span></span> <span data-ttu-id="9551f-261">Удаление кнопки справки в строке заголовка страницы свойств:</span><span class="sxs-lookup"><span data-stu-id="9551f-261">To remove a property sheet's caption bar Help button:</span></span>

-   <span data-ttu-id="9551f-262">Для версий стандартных элементов управления до [версии 5,80](common-control-versions.md)необходимо реализовать [**функцию обратного вызова на странице свойств**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span><span class="sxs-lookup"><span data-stu-id="9551f-262">For versions of the common controls prior to [version 5.80](common-control-versions.md), you must implement a [**property sheet callback function**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span></span>
-   <span data-ttu-id="9551f-263">Для стандартных элементов управления [версии 5,80](common-control-versions.md) и более поздних можно просто установить \_ флаг командном PSH Ноконтексселп в элементе **dwFlags** структуры [**пропшисеадер**](pss-propsheetheader.md) страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-263">For [version 5.80](common-control-versions.md) and later of the common controls, you can simply set the PSH\_NOCONTEXTHELP flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="9551f-264">Однако если требуется обратная совместимость с более ранними версиями элементов управления, необходимо реализовать функцию обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="9551f-264">However, if you need backward compatibility with earlier common control versions, you must implement the callback function.</span></span>

<span data-ttu-id="9551f-265">Для реализации функции обратного вызова страницы свойств, которая удаляет кнопку справки в строке заголовка:</span><span class="sxs-lookup"><span data-stu-id="9551f-265">To implement a property sheet callback function that removes the caption bar Help button:</span></span>

-   <span data-ttu-id="9551f-266">Установите флаг **командном PSH \_ усекаллбакк** в элементе **dwFlags** структуры [**пропшисеадер**](pss-propsheetheader.md) страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-266">Set the **PSH\_USECALLBACK** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="9551f-267">Установите элемент **пфнкаллбакк** структуры [**пропшисеадер**](pss-propsheetheader.md) , чтобы он указывал на функцию обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="9551f-267">Set the **pfnCallBack** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to point to the callback function.</span></span>
-   <span data-ttu-id="9551f-268">Реализуйте функцию обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="9551f-268">Implement the callback function.</span></span> <span data-ttu-id="9551f-269">Когда эта функция получает сообщение **о \_ создании пскб** , оно также получит указатель на шаблон диалогового окна страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-269">When this function receives the **PSCB\_PRECREATE** message, it will also receive a pointer to the property sheet's dialog box template.</span></span> <span data-ttu-id="9551f-270">Удалите из этого шаблона стиль **\_ Контексселп для DS** .</span><span class="sxs-lookup"><span data-stu-id="9551f-270">Remove the **DS\_CONTEXTHELP** style from this template.</span></span>

<span data-ttu-id="9551f-271">В следующем примере показано, как реализовать такую функцию обратного вызова:</span><span class="sxs-lookup"><span data-stu-id="9551f-271">The following sample illustrates how to implement such a callback function:</span></span>

```cpp
int CALLBACK RemoveContextHelpProc(HWND hwnd, UINT message, LPARAM lParam)
{
    switch (message) 
    {
    case PSCB_PRECREATE:
        // Remove the DS_CONTEXTHELP style from the
        // dialog box template
        if (((LPDLGTEMPLATEEX)lParam)->signature ==    
           0xFFFF)
           {
            ((LPDLGTEMPLATEEX)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        else {
            ((LPDLGTEMPLATE)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        return TRUE;
    }
    return TRUE;
}
```

<span data-ttu-id="9551f-272">Если структура [**длгтемплатикс**](/windows/desktop/dlgbox/dlgtemplateex) не определена, включите следующее объявление:</span><span class="sxs-lookup"><span data-stu-id="9551f-272">If the [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) structure is not defined, include the following declaration:</span></span>

```cpp
#include <pshpack1.h>

typedef struct DLGTEMPLATEEX
{
    WORD dlgVer;
    WORD signature;
    DWORD helpID;
    DWORD exStyle;
    DWORD style;
    WORD cDlgItems;
    short x;
    short y;
    short cx;
    short cy;
} DLGTEMPLATEEX, *LPDLGTEMPLATEEX;

#include <poppack.h>
```

## <a name="ok-cancel-and-apply-buttons"></a><span data-ttu-id="9551f-273">Кнопки ОК, отмена и применить</span><span class="sxs-lookup"><span data-stu-id="9551f-273">OK, Cancel, and Apply Buttons</span></span>

<span data-ttu-id="9551f-274">Кнопки **ОК** и **Применить** похожи; как направить страницы свойств для проверки и применения изменений свойств, внесенных пользователем.</span><span class="sxs-lookup"><span data-stu-id="9551f-274">The **OK** and **Apply** buttons are similar; both direct a property sheet's pages to validate and apply the property changes that the user has made.</span></span> <span data-ttu-id="9551f-275">Единственное отличие заключается в том, что нажатие кнопки **ОК** приводит к уничтожению страницы свойств после применения изменений.</span><span class="sxs-lookup"><span data-stu-id="9551f-275">The only difference is that clicking the **OK** button causes the property sheet to be destroyed after the changes are applied.</span></span>

<span data-ttu-id="9551f-276">Когда пользователь нажимает кнопку **ОК** или **Применить** , страница свойств отправляет на активную страницу уведомление [PSN \_ киллактиве](psn-killactive.md) , давая ему возможность проверить изменения, внесенные пользователем.</span><span class="sxs-lookup"><span data-stu-id="9551f-276">When the user clicks the **OK** or **Apply** button, the property sheet sends a [PSN\_KILLACTIVE](psn-killactive.md) notification to the active page, giving it an opportunity to validate the user's changes.</span></span> <span data-ttu-id="9551f-277">Если изменения являются допустимыми, страница должна вызвать функцию [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с параметром **DWL \_ мсгресулт** , установленным в значение **false**.</span><span class="sxs-lookup"><span data-stu-id="9551f-277">If the changes are valid, the page must call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the **DWL\_MSGRESULT** value set to **FALSE**.</span></span> <span data-ttu-id="9551f-278">Если изменения пользователя недопустимы, на странице необходимо установить **DWL \_ Мсгресулт** в **значение true** и отобразить диалоговое окно, информирующее пользователя о проблеме.</span><span class="sxs-lookup"><span data-stu-id="9551f-278">If the user's changes are not valid, the page must set **DWL\_MSGRESULT** to **TRUE** and display a dialog box informing the user of the problem.</span></span> <span data-ttu-id="9551f-279">Страница остается активной до тех пор, пока в ответ на сообщение киллактиве PSN будет задано **значение false** для **\_ мсгресулт DWL** \_ .</span><span class="sxs-lookup"><span data-stu-id="9551f-279">The page remains active until it sets **DWL\_MSGRESULT** to **FALSE** in response to a PSN\_KILLACTIVE message.</span></span>

<span data-ttu-id="9551f-280">После того как страница ответит на уведомление [PSN \_ киллактиве](psn-killactive.md) , установив для **DWL \_ мсгресулт** **значение false**, страница свойств будет отсылать [PSN \_ Применить](psn-apply.md) уведомление к каждой странице.</span><span class="sxs-lookup"><span data-stu-id="9551f-280">After a page responds to a [PSN\_KILLACTIVE](psn-killactive.md) notification by setting **DWL\_MSGRESULT** to **FALSE**, the property sheet will send a [PSN\_APPLY](psn-apply.md) notification to each page.</span></span> <span data-ttu-id="9551f-281">Когда страница получает это уведомление, она должна применить новые свойства к соответствующему элементу.</span><span class="sxs-lookup"><span data-stu-id="9551f-281">When a page receives this notification, it must apply the new properties to the corresponding item.</span></span> <span data-ttu-id="9551f-282">Чтобы указать странице свойств, что изменения действительны для страницы, вызовите [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с **DWL \_ мсгресулт** , установленным в **пснрет \_ Error**.</span><span class="sxs-lookup"><span data-stu-id="9551f-282">To indicate to the property sheet that the changes are valid for the page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with **DWL\_MSGRESULT** set to **PSNRET\_NOERROR**.</span></span> <span data-ttu-id="9551f-283">Если изменения для этой страницы недопустимы, возвращайте ошибку.</span><span class="sxs-lookup"><span data-stu-id="9551f-283">If the changes are invalid for the page, return an error.</span></span> <span data-ttu-id="9551f-284">Это предотвращает уничтожение страницы свойств и Возврат фокуса на страницу, получивший \_ уведомление о применении PSN, или на страницу, на которой был установлен фокус при нажатии кнопки **Применить** .</span><span class="sxs-lookup"><span data-stu-id="9551f-284">Doing so prevents the property sheet from being destroyed and returns focus to either the page that received the PSN\_APPLY notification or the page that had focus when the **Apply** button was pressed.</span></span> <span data-ttu-id="9551f-285">Чтобы получить сообщение об ошибке и указать, какая страница будет получать фокус, установите для **\_ мсгресулт DWL** одно из следующих значений.</span><span class="sxs-lookup"><span data-stu-id="9551f-285">To return an error, and indicate which page will receive focus, set **DWL\_MSGRESULT** to one of the following values.</span></span>

-   <span data-ttu-id="9551f-286">**Пснрет \_ НЕДОПУСТИМое**.</span><span class="sxs-lookup"><span data-stu-id="9551f-286">**PSNRET\_INVALID**.</span></span> <span data-ttu-id="9551f-287">Страница свойств не будет уничтожена, и на эту страницу будет возвращен фокус.</span><span class="sxs-lookup"><span data-stu-id="9551f-287">The property sheet will not be destroyed, and focus will be returned to this page.</span></span>
-   <span data-ttu-id="9551f-288">**Пснрет \_ Недопустимый \_ ночанжепаже**.</span><span class="sxs-lookup"><span data-stu-id="9551f-288">**PSNRET\_INVALID\_NOCHANGEPAGE**.</span></span> <span data-ttu-id="9551f-289">Страница свойств не будет уничтожена, и фокус будет возвращен на страницу, на которую находил фокус при нажатии кнопки.</span><span class="sxs-lookup"><span data-stu-id="9551f-289">The property sheet will not be destroyed, and focus will be returned to the page that had focus when the button was pressed.</span></span>

<span data-ttu-id="9551f-290">Приложение может использовать сообщение [**\_ Apply ПСМ**](psm-apply.md) для имитации выбора кнопки **Применить** .</span><span class="sxs-lookup"><span data-stu-id="9551f-290">An application can use the [**PSM\_APPLY**](psm-apply.md) message to simulate the selection of the **Apply** button.</span></span>

<span data-ttu-id="9551f-291">Кнопка **Применить** изначально отключена, когда страница становится активной, что указывает на то, что нет изменений свойств для применения.</span><span class="sxs-lookup"><span data-stu-id="9551f-291">The **Apply** button is initially disabled when a page becomes active, indicating that there are not yet any property changes to apply.</span></span> <span data-ttu-id="9551f-292">Когда страница получает входные данные через один из элементов управления, указывая, что пользователь изменил свойство, страница должна отправить сообщение [**ПСМ \_ Changed**](psm-changed.md) на вкладку свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-292">When the page receives input through one of its controls indicating that the user has edited a property, the page must send the [**PSM\_CHANGED**](psm-changed.md) message to the property sheet.</span></span> <span data-ttu-id="9551f-293">Сообщение приводит к включению кнопки **Применить** на странице свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-293">The message causes the property sheet to enable the **Apply** button.</span></span> <span data-ttu-id="9551f-294">Если пользователь в дальнейшем нажмет кнопку " **Применить** " или **"Отмена** ", страница должна повторно инициализировать свои элементы управления, а затем отправить [**ПСМ \_ неизмененное**](psm-unchanged.md) сообщение, чтобы снова отключить кнопку " **Применить** ".</span><span class="sxs-lookup"><span data-stu-id="9551f-294">If the user subsequently clicks the **Apply** or **Cancel** button, the page must reinitialize its controls and then send the [**PSM\_UNCHANGED**](psm-unchanged.md) message to again disable the **Apply** button.</span></span>

<span data-ttu-id="9551f-295">Иногда кнопка **Применить** приводит к изменению страницы свойств, и это изменение нельзя отменить.</span><span class="sxs-lookup"><span data-stu-id="9551f-295">Sometimes the **Apply** button causes a page to make a change to a property sheet, and the change cannot be undone.</span></span> <span data-ttu-id="9551f-296">В этом случае страница должна отправить сообщение [**ПСМ \_ канцелтоклосе**](psm-canceltoclose.md) на страницу свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-296">When this happens, the page must send the [**PSM\_CANCELTOCLOSE**](psm-canceltoclose.md) message to the property sheet.</span></span> <span data-ttu-id="9551f-297">Сообщение заставляет страницу свойств изменить текст кнопки **ОК** на «Close» (закрыть), что означает, что примененные изменения не могут быть отменены.</span><span class="sxs-lookup"><span data-stu-id="9551f-297">The message causes the property sheet to change the text of the **OK** button to "Close," indicating that the applied changes cannot be canceled.</span></span>

<span data-ttu-id="9551f-298">Иногда страница вносит изменения в конфигурацию системы, которая требует перезапуска Windows или перезагрузки системы, прежде чем изменение вступит в силу.</span><span class="sxs-lookup"><span data-stu-id="9551f-298">Sometimes a page makes a change to the system configuration that requires Windows to be restarted or the system rebooted before the change can take effect.</span></span> <span data-ttu-id="9551f-299">После внесения такого изменения страница должна отправить сообщение [**ПСМ \_ Рестартвиндовс**](psm-restartwindows.md) или [**ПСМ \_ ребутсистем**](psm-rebootsystem.md) на страницу свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-299">After making such a change, a page must send either the [**PSM\_RESTARTWINDOWS**](psm-restartwindows.md) or [**PSM\_REBOOTSYSTEM**](psm-rebootsystem.md) message to the property sheet.</span></span> <span data-ttu-id="9551f-300">Эти сообщения приводят к тому, что функция [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) возвращает значение **ID \_ псрестартвиндовс** или **ID \_ псребутсистем** после уничтожения страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-300">These messages cause the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to return the **ID\_PSRESTARTWINDOWS** or **ID\_PSREBOOTSYSTEM** value after the property sheet is destroyed.</span></span>

<span data-ttu-id="9551f-301">Когда пользователь нажимает кнопку **Отмена** , страница свойств отправляет на все страницы код уведомления о [ \_ сбросе PSN](psn-reset.md) , указывая, что страница свойств собирается быть уничтожена.</span><span class="sxs-lookup"><span data-stu-id="9551f-301">When a user clicks the **Cancel** button, the property sheet sends the [PSN\_RESET](psn-reset.md) notification code to all pages, indicating that the property sheet is about to be destroyed.</span></span> <span data-ttu-id="9551f-302">Страница должна использовать уведомление для выполнения операций очистки.</span><span class="sxs-lookup"><span data-stu-id="9551f-302">A page must use the notification to perform cleanup operations.</span></span>

## <a name="wizards"></a><span data-ttu-id="9551f-303">Мастера</span><span class="sxs-lookup"><span data-stu-id="9551f-303">Wizards</span></span>

<span data-ttu-id="9551f-304">Мастер — это особый тип страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="9551f-304">A wizard is a special type of property sheet.</span></span> <span data-ttu-id="9551f-305">Мастера предназначены для одновременного представления страниц в последовательности, управляемой приложением.</span><span class="sxs-lookup"><span data-stu-id="9551f-305">Wizards are designed to present pages one at a time in a sequence that is controlled by the application.</span></span> <span data-ttu-id="9551f-306">Вместо того чтобы выбирать из группы страниц, щелкая вкладку, пользователи переходят вперед и назад по последовательности, по одной странице за раз, нажав кнопку кнопки.</span><span class="sxs-lookup"><span data-stu-id="9551f-306">Instead of selecting from a group of pages by clicking a tab, users navigate forward and backward through the sequence, one page at a time, by clicking buttons.</span></span> <span data-ttu-id="9551f-307">Например, на следующем снимке экрана показана страница приветствия в мастере добавления оборудования:</span><span class="sxs-lookup"><span data-stu-id="9551f-307">For example, the following screen shot shows the welcome page from the Add Hardware wizard:</span></span>

![снимок экрана со страницей приветствия мастера](images/wizard97.png)

<span data-ttu-id="9551f-309">На следующем снимке экрана показана первая страница мастера Aero, новый стиль, появившийся в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9551f-309">The following screen shot shows the first page of an Aero Wizard, the new style introduced in Windows Vista.</span></span>

![снимок экрана с первой страницей мастера Aero](images/wizardaero.png)

<span data-ttu-id="9551f-311">Подробное описание мастеров см. в разделе [Создание мастеров](wizards.md) .</span><span class="sxs-lookup"><span data-stu-id="9551f-311">See [Creating Wizards](wizards.md) for a complete discussion of wizards.</span></span>
