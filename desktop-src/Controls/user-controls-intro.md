---
title: Пользовательские элементы управления
description: В этом разделе содержатся сведения об определяемых приложением или пользовательских элементах управления.
ms.assetid: 220f7058-db04-46d0-acee-ed5e676790b3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e82ed9394ec06257e524153b86ef487f4507f35b
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104134607"
---
# <a name="custom-controls"></a><span data-ttu-id="17fec-103">Пользовательские элементы управления</span><span class="sxs-lookup"><span data-stu-id="17fec-103">Custom Controls</span></span>

<span data-ttu-id="17fec-104">В этом разделе содержатся сведения об определяемых приложением или пользовательских элементах управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-104">This section contains information about application-defined or custom controls.</span></span>

<span data-ttu-id="17fec-105">Обсуждаются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="17fec-105">The following topics are discussed.</span></span>

-   [<span data-ttu-id="17fec-106">Создание элементов управления Owner-Drawn</span><span class="sxs-lookup"><span data-stu-id="17fec-106">Creating Owner-Drawn Controls</span></span>](#creating-owner-drawn-controls)
-   [<span data-ttu-id="17fec-107">Подклассировать класс окна существующего элемента управления</span><span class="sxs-lookup"><span data-stu-id="17fec-107">Subclassing the Window Class of an Existing Control</span></span>](#subclassing-the-window-class-of-an-existing-control)
-   [<span data-ttu-id="17fec-108">Реализация класса окна Application-Defined</span><span class="sxs-lookup"><span data-stu-id="17fec-108">Implementing an Application-Defined Window Class</span></span>](#implementing-an-application-defined-window-class)
-   [<span data-ttu-id="17fec-109">Отправка уведомлений из элемента управления</span><span class="sxs-lookup"><span data-stu-id="17fec-109">Sending Notifications from a Control</span></span>](#sending-notifications-from-a-control)
-   [<span data-ttu-id="17fec-110">Специальные возможности</span><span class="sxs-lookup"><span data-stu-id="17fec-110">Accessibility</span></span>](#accessibility)
-   [<span data-ttu-id="17fec-111">См. также</span><span class="sxs-lookup"><span data-stu-id="17fec-111">Related topics</span></span>](#related-topics)

## <a name="creating-owner-drawn-controls"></a><span data-ttu-id="17fec-112">Создание элементов управления Owner-Drawn</span><span class="sxs-lookup"><span data-stu-id="17fec-112">Creating Owner-Drawn Controls</span></span>

<span data-ttu-id="17fec-113">Кнопки, меню, статические текстовые элементы управления, списки и поля со списком можно создавать с помощью флага стиля, рисуемого владельцем.</span><span class="sxs-lookup"><span data-stu-id="17fec-113">Buttons, menus, static text controls, list boxes, and combo boxes can be created with an owner-drawn style flag.</span></span> <span data-ttu-id="17fec-114">Когда элемент управления имеет стиль, рисуемый владельцем, система обрабатывает взаимодействие пользователя с элементом управления обычным образом, выполняя такие задачи, как обнаружение того, когда пользователь выбрал кнопку, и уведомляет ее владельца о событии.</span><span class="sxs-lookup"><span data-stu-id="17fec-114">When a control has the owner-drawn style, the system handles the user's interaction with the control as usual, performing such tasks as detecting when a user has chosen a button and notifying the button's owner of the event.</span></span> <span data-ttu-id="17fec-115">Однако, поскольку элемент управления нарисован владельцем, родительское окно элемента управления отвечает за визуальный внешний вид элемента управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-115">However, because the control is owner-drawn, the parent window of the control is responsible for the visual appearance of the control.</span></span> <span data-ttu-id="17fec-116">Родительское окно получает сообщение, когда должен быть нарисован элемент управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-116">The parent window receives a message whenever the control must be drawn.</span></span>

<span data-ttu-id="17fec-117">Для кнопок и статических текстовых элементов управления стиль, рисуемый владельцем, влияет на то, как система рисует весь элемент управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-117">For buttons and static text controls, the owner-drawn style affects how the system draws the entire control.</span></span> <span data-ttu-id="17fec-118">Для списков и полей со списком родительское окно рисует элементы внутри элемента управления, и элемент управления рисует свою собственную структуру.</span><span class="sxs-lookup"><span data-stu-id="17fec-118">For list boxes and combo boxes, the parent window draws the items within the control, and the control draws its own outline.</span></span> <span data-ttu-id="17fec-119">Например, приложение может настроить окно списка таким образом, чтобы оно отображало небольшое точечное изображение рядом с каждым элементом в списке.</span><span class="sxs-lookup"><span data-stu-id="17fec-119">For example, an application can customize a list box so that it displays a small bitmap next to each item in the list.</span></span>

<span data-ttu-id="17fec-120">В следующем примере кода показано, как создать элемент управления "статический текст", рисуемый владельцем.</span><span class="sxs-lookup"><span data-stu-id="17fec-120">The following example code shows how to create an owner-drawn static text control.</span></span> <span data-ttu-id="17fec-121">Предположим, что задан Юникод.</span><span class="sxs-lookup"><span data-stu-id="17fec-121">Assume that Unicode is defined.</span></span>


```
// g_myStatic is a global HWND variable.
g_myStatic = CreateWindowEx(0, L"STATIC", L"Some static text", 
            WS_CHILD | WS_VISIBLE | SS_OWNERDRAW, 
            25, 125, 150, 20, hDlg, 0, 0, 0);
```



<span data-ttu-id="17fec-122">В следующем примере из процедуры окна для диалогового окна, содержащего элемент управления, созданный в предыдущем примере, сообщение [**WM \_ DRAWITEM**](wm-drawitem.md) обрабатывается путем отображения текста в пользовательском цвете с использованием шрифта по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="17fec-122">In the following example, from the window procedure for the dialog box that contains the control created in the previous example, the [**WM\_DRAWITEM**](wm-drawitem.md) message is handled by displaying the text in a custom color, using the default font.</span></span> <span data-ttu-id="17fec-123">Обратите внимание, что при обработке **WM \_ DRAWITEM** не нужно вызывать [**бегинпаинт**](/windows/desktop/api/winuser/nf-winuser-beginpaint) и [**ендпаинт**](/windows/desktop/api/winuser/nf-winuser-endpaint) .</span><span class="sxs-lookup"><span data-stu-id="17fec-123">Note that you do not need to call [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) and [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) when handling **WM\_DRAWITEM**.</span></span>


```
case WM_DRAWITEM:
{
    LPDRAWITEMSTRUCT pDIS = (LPDRAWITEMSTRUCT)lParam;
    if (pDIS->hwndItem == g_myStatic)
    {
        SetTextColor(pDIS->hDC, RGB(100, 0, 100));
        WCHAR staticText[99];
        int len = SendMessage(myStatic, WM_GETTEXT, 
            ARRAYSIZE(staticText), (LPARAM)staticText);
        TextOut(pDIS->hDC, pDIS->rcItem.left, pDIS->rcItem.top, staticText, len);
    }
    return TRUE;
}
```



<span data-ttu-id="17fec-124">Дополнительные сведения об элементах управления, рисуемых владельцем, см. [в разделе Создание рисуемых владельцем списков](using-list-boxes.md) и [созданных владельцем полей со](about-combo-boxes.md)списками.</span><span class="sxs-lookup"><span data-stu-id="17fec-124">For more information about owner-drawn controls, see [Creating an Owner-drawn List Box](using-list-boxes.md) and [Owner Drawn Combo Boxes](about-combo-boxes.md).</span></span>

## <a name="subclassing-the-window-class-of-an-existing-control"></a><span data-ttu-id="17fec-125">Подклассировать класс окна существующего элемента управления</span><span class="sxs-lookup"><span data-stu-id="17fec-125">Subclassing the Window Class of an Existing Control</span></span>

<span data-ttu-id="17fec-126">Создание пользовательского элемента управления с помощью подкласса существующего элемента управления является еще одним способом.</span><span class="sxs-lookup"><span data-stu-id="17fec-126">Subclassing an existing control is another way to create a custom control.</span></span> <span data-ttu-id="17fec-127">Процедура подкласса может изменить выбранные поведения элемента управления, обрабатывая эти сообщения, влияющие на выбранные поведения.</span><span class="sxs-lookup"><span data-stu-id="17fec-127">The subclass procedure can alter selected behaviors of the control by processing those messages that affect the selected behaviors.</span></span> <span data-ttu-id="17fec-128">Все остальные сообщения передаются в исходную процедуру окна для элемента управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-128">All other messages pass to the original window procedure for the control.</span></span> <span data-ttu-id="17fec-129">Например, приложение может отображать небольшое точечное изображение рядом с текстом в однострочном элементе управления "поле ввода" только для чтения, подклассом элемента управления и обрабатывая сообщение [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) .</span><span class="sxs-lookup"><span data-stu-id="17fec-129">For example, an application can display a small bitmap next to the text in a read-only, single-line edit control by subclassing the control and processing the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message.</span></span> <span data-ttu-id="17fec-130">Дополнительные сведения см. в разделе [сведения о процедурах окон](/windows/desktop/winmsg/about-window-procedures) и [подклассах элементов управления](subclassing-overview.md).</span><span class="sxs-lookup"><span data-stu-id="17fec-130">For more information, see [About Window Procedures](/windows/desktop/winmsg/about-window-procedures) and [Subclassing Controls](subclassing-overview.md).</span></span>

## <a name="implementing-an-application-defined-window-class"></a><span data-ttu-id="17fec-131">Реализация класса окна Application-Defined</span><span class="sxs-lookup"><span data-stu-id="17fec-131">Implementing an Application-Defined Window Class</span></span>

<span data-ttu-id="17fec-132">Чтобы создать элемент управления, который явно не основан на существующем элементе управления, приложение должно создать и зарегистрировать класс окна.</span><span class="sxs-lookup"><span data-stu-id="17fec-132">To create a control that is not explicitly based on an existing control, the application must create and register a window class.</span></span> <span data-ttu-id="17fec-133">Процесс регистрации определяемого приложением класса окна для пользовательского элемента управления аналогичен регистрации класса для обычного окна.</span><span class="sxs-lookup"><span data-stu-id="17fec-133">The process for registering an application-defined window class for a custom control is the same as registering a class for an ordinary window.</span></span> <span data-ttu-id="17fec-134">Чтобы создать пользовательский элемент управления, укажите имя класса окна в функции [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) или в шаблоне диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="17fec-134">To create a custom control, specify the name of the window class in the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function or in a dialog box template.</span></span> <span data-ttu-id="17fec-135">Каждый класс должен иметь уникальное имя, соответствующую процедуру окна и другие сведения.</span><span class="sxs-lookup"><span data-stu-id="17fec-135">Each class must have a unique name, a corresponding window procedure, and other information.</span></span>

<span data-ttu-id="17fec-136">Как минимум, оконная процедура рисует элемент управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-136">At a minimum, the window procedure draws the control.</span></span> <span data-ttu-id="17fec-137">Если приложение использует элемент управления для получения сведений о типе пользователя, то процедура окна также обрабатывает входные сообщения с клавиатуры и мыши и отправляет сообщения уведомления родительскому окну.</span><span class="sxs-lookup"><span data-stu-id="17fec-137">If an application uses the control to let the user type information, the window procedure also processes input messages from the keyboard and mouse and sends notification messages to the parent window.</span></span> <span data-ttu-id="17fec-138">Кроме того, если элемент управления поддерживает управляющие сообщения, то процедура окна обрабатывает сообщения, отправленные ей родительским окном или другими окнами.</span><span class="sxs-lookup"><span data-stu-id="17fec-138">In addition, if the control supports control messages, the window procedure processes messages sent to it by the parent window or other windows.</span></span> <span data-ttu-id="17fec-139">Например, элементы управления часто обрабатывают сообщение [**WM \_ жетдлгкоде**](/windows/desktop/dlgbox/wm-getdlgcode) , отправленное в диалоговых окнах, чтобы направлять диалоговое окно для обработки ввода с клавиатуры определенным способом.</span><span class="sxs-lookup"><span data-stu-id="17fec-139">For example, controls often process the [**WM\_GETDLGCODE**](/windows/desktop/dlgbox/wm-getdlgcode) message sent by dialog boxes to direct a dialog box to process keyboard input in a given way.</span></span>

<span data-ttu-id="17fec-140">Процедура окна для элемента управления, определяемого приложением, должна обрабатывать любое предопределенное управляющее сообщение в следующей таблице, если оно влияет на работу элемента управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-140">The window procedure for an application-defined control should process any predefined control message in the following table if the message affects the operation of the control.</span></span>



| <span data-ttu-id="17fec-141">Сообщение</span><span class="sxs-lookup"><span data-stu-id="17fec-141">Message</span></span>                                          | <span data-ttu-id="17fec-142">Рекомендация</span><span class="sxs-lookup"><span data-stu-id="17fec-142">Recommendation</span></span>                                                                                                                                                                                                                                  |
|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="17fec-143">**WM \_ жетдлгкоде**</span><span class="sxs-lookup"><span data-stu-id="17fec-143">**WM\_GETDLGCODE**</span></span>](/windows/desktop/dlgbox/wm-getdlgcode)       | <span data-ttu-id="17fec-144">Обработка, если в элементе управления используются клавиши ВВОД, ESC, ТАБУЛЯЦИя или стрелка.</span><span class="sxs-lookup"><span data-stu-id="17fec-144">Process if the control uses the ENTER, ESC, TAB, or arrow keys.</span></span> <span data-ttu-id="17fec-145">Функция [**исдиалогмессаже**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) отправляет это сообщение элементам управления в диалоговом окне, чтобы определить, следует ли обрабатывать ключи или передавать их в элемент управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-145">The [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) function sends this message to controls in a dialog box to determine whether to process the keys or pass them to the control.</span></span> |
| [<span data-ttu-id="17fec-146">**WM, \_ Шрифт**</span><span class="sxs-lookup"><span data-stu-id="17fec-146">**WM\_GETFONT**</span></span>](/windows/desktop/winmsg/wm-getfont)             | <span data-ttu-id="17fec-147">Обработка, если сообщение [**WM \_ сетфонт**](/windows/desktop/winmsg/wm-setfont) также обработано.</span><span class="sxs-lookup"><span data-stu-id="17fec-147">Process if the [**WM\_SETFONT**](/windows/desktop/winmsg/wm-setfont) message is also processed.</span></span>                                                                                                                                                                  |
| [<span data-ttu-id="17fec-148">**WM \_ gettext**</span><span class="sxs-lookup"><span data-stu-id="17fec-148">**WM\_GETTEXT**</span></span>](/windows/desktop/winmsg/wm-gettext)             | <span data-ttu-id="17fec-149">Обработка, если текст элемента управления отличается от заголовка, указанного функцией [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) .</span><span class="sxs-lookup"><span data-stu-id="17fec-149">Process if the control text is not the same as the title specified by the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function.</span></span>                                                                                                                 |
| [<span data-ttu-id="17fec-150">**WM \_ жеттекстленгс**</span><span class="sxs-lookup"><span data-stu-id="17fec-150">**WM\_GETTEXTLENGTH**</span></span>](/windows/desktop/winmsg/wm-gettextlength) | <span data-ttu-id="17fec-151">Обработка, если текст элемента управления отличается от заголовка, указанного функцией [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) .</span><span class="sxs-lookup"><span data-stu-id="17fec-151">Process if the control text is not the same as the title specified by the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function.</span></span>                                                                                                                 |
| [<span data-ttu-id="17fec-152">**WM \_ киллфокус**</span><span class="sxs-lookup"><span data-stu-id="17fec-152">**WM\_KILLFOCUS**</span></span>](/windows/desktop/inputdev/wm-killfocus)       | <span data-ttu-id="17fec-153">Обработка, если элемент управления отображает курсор, прямоугольник фокуса или другой элемент, чтобы показать, что он имеет фокус ввода.</span><span class="sxs-lookup"><span data-stu-id="17fec-153">Process if the control displays a caret, a focus rectangle, or another item to indicate that it has the input focus.</span></span>                                                                                                                            |
| [<span data-ttu-id="17fec-154">**WM \_ SETFOCUS**</span><span class="sxs-lookup"><span data-stu-id="17fec-154">**WM\_SETFOCUS**</span></span>](/windows/desktop/inputdev/wm-setfocus)         | <span data-ttu-id="17fec-155">Обработка, если элемент управления отображает курсор, прямоугольник фокуса или другой элемент, чтобы показать, что он имеет фокус ввода.</span><span class="sxs-lookup"><span data-stu-id="17fec-155">Process if the control displays a caret, a focus rectangle, or another item to indicate that it has the input focus.</span></span>                                                                                                                            |
| [<span data-ttu-id="17fec-156">**WM \_ SETTEXT**</span><span class="sxs-lookup"><span data-stu-id="17fec-156">**WM\_SETTEXT**</span></span>](/windows/desktop/winmsg/wm-settext)             | <span data-ttu-id="17fec-157">Обработка, если текст элемента управления отличается от заголовка, указанного функцией [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) .</span><span class="sxs-lookup"><span data-stu-id="17fec-157">Process if the control text is not the same as the title specified by the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function.</span></span>                                                                                                                 |
| [<span data-ttu-id="17fec-158">**WM \_ сетфонт**</span><span class="sxs-lookup"><span data-stu-id="17fec-158">**WM\_SETFONT**</span></span>](/windows/desktop/winmsg/wm-setfont)             | <span data-ttu-id="17fec-159">Обработка, если элемент управления отображает текст.</span><span class="sxs-lookup"><span data-stu-id="17fec-159">Process if the control displays text.</span></span> <span data-ttu-id="17fec-160">Система отправляет это сообщение при создании диалогового окна, имеющего \_ стиль сетфонт для DS.</span><span class="sxs-lookup"><span data-stu-id="17fec-160">The system sends this message when creating a dialog box that has the DS\_SETFONT style.</span></span>                                                                                                                  |



 

<span data-ttu-id="17fec-161">Определяемые приложением управляющие сообщения относятся к заданному элементу управления и должны быть явно отправлены в элемент управления с помощью функции [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) или [**сенддлгитеммессаже**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) .</span><span class="sxs-lookup"><span data-stu-id="17fec-161">Application-defined control messages are specific to the given control and must be explicitly sent to the control by using a [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) or [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) function.</span></span> <span data-ttu-id="17fec-162">Числовое значение для каждого сообщения должно быть уникальным и не должно конфликтовать со значениями других оконных сообщений.</span><span class="sxs-lookup"><span data-stu-id="17fec-162">The numeric value for each message must be unique and must not conflict with the values of other window messages.</span></span> <span data-ttu-id="17fec-163">Чтобы гарантировать, что определяемые приложением значения сообщений не конфликтуют, приложение должно создать каждое значение, добавив уникальный номер к значению [**\_ пользователя WM**](/windows/desktop/winmsg/wm-user) .</span><span class="sxs-lookup"><span data-stu-id="17fec-163">To ensure that application-defined message values do not conflict, an application should create each value by adding a unique number to the [**WM\_USER**](/windows/desktop/winmsg/wm-user) value.</span></span>

## <a name="sending-notifications-from-a-control"></a><span data-ttu-id="17fec-164">Отправка уведомлений из элемента управления</span><span class="sxs-lookup"><span data-stu-id="17fec-164">Sending Notifications from a Control</span></span>

<span data-ttu-id="17fec-165">Пользовательские элементы управления могут потребоваться для отправки уведомлений о событиях в родительское окно, чтобы ведущее приложение могло отвечать на эти события.</span><span class="sxs-lookup"><span data-stu-id="17fec-165">Custom controls might be required to send notifications of events to the parent window so that the host application can respond to these events.</span></span> <span data-ttu-id="17fec-166">Например, пользовательское представление списка может отправить уведомление, когда пользователь выберет элемент, и другое уведомление при двойном щелчке элемента.</span><span class="sxs-lookup"><span data-stu-id="17fec-166">For example, a custom list view might send a notification when the user selects an item, and another notification when an item is double-clicked.</span></span>

<span data-ttu-id="17fec-167">Уведомления отправляются с сообщением [**\_ команды WM**](/windows/desktop/menurc/wm-command) или [**\_ уведомления WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="17fec-167">Notifications are sent as [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) or [**WM\_NOTIFY**](wm-notify.md) messages.</span></span> <span data-ttu-id="17fec-168">**WM \_ УВЕДОМЛЕНИЯ о** сообщениях содержат больше информации, чем **\_ Командные сообщения WM** .</span><span class="sxs-lookup"><span data-stu-id="17fec-168">**WM\_NOTIFY** messages carry more information than **WM\_COMMAND** messages.</span></span>

<span data-ttu-id="17fec-169">Идентификатор элемента управления — это уникальный номер, который приложение использует для идентификации элемента управления, отправляющего сообщение.</span><span class="sxs-lookup"><span data-stu-id="17fec-169">The control identifier is a unique number the application uses to identify the control sending the message.</span></span> <span data-ttu-id="17fec-170">Приложение задает идентификатор элемента управления при создании элемента управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-170">The application sets the identifier for a control when it creates the control.</span></span> <span data-ttu-id="17fec-171">Приложение указывает идентификатор либо в параметре *HMENU* функции [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) , либо в элементе **ID** структуры [**длгитемтемплатикс**](/windows/desktop/dlgbox/dlgitemtemplateex) .</span><span class="sxs-lookup"><span data-stu-id="17fec-171">The application specifies the identifier either in the *hMenu* parameter of the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function or in the **id** member of the [**DLGITEMTEMPLATEEX**](/windows/desktop/dlgbox/dlgitemtemplateex) structure.</span></span>

<span data-ttu-id="17fec-172">Так как сам элемент управления не задает идентификатор элемента управления, элемент управления должен получить идентификатор, прежде чем он сможет отправить сообщения уведомления.</span><span class="sxs-lookup"><span data-stu-id="17fec-172">Because the control itself does not set the control identifier, the control must retrieve the identifier before it can send notification messages.</span></span> <span data-ttu-id="17fec-173">Элемент управления должен использовать функцию [**жетдлгктрлид**](/windows/desktop/api/winuser/nf-winuser-getdlgctrlid) для получения собственного идентификатора элемента управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-173">A control must use the [**GetDlgCtrlID**](/windows/desktop/api/winuser/nf-winuser-getdlgctrlid) function to retrieve its own control identifier.</span></span> <span data-ttu-id="17fec-174">Хотя идентификатор элемента управления указывается в виде маркера меню при создании элемента управления, функцию [**Menu**](/windows/desktop/api/winuser/nf-winuser-getmenu) нельзя использовать для получения идентификатора.</span><span class="sxs-lookup"><span data-stu-id="17fec-174">Although the control identifier is specified as the menu handle when the control is created, the [**GetMenu**](/windows/desktop/api/winuser/nf-winuser-getmenu) function cannot be used to retrieve the identifier.</span></span> <span data-ttu-id="17fec-175">Кроме того, элемент управления может извлечь идентификатор из члена **HMENU** в структуре [**CREATESTRUCT**](/windows/win32/api/winuser/ns-winuser-createstructa) при обработке сообщения о [**\_ создании WM**](/windows/desktop/winmsg/wm-create) .</span><span class="sxs-lookup"><span data-stu-id="17fec-175">Alternatively, a control can retrieve the identifier from the **hMenu** member in the [**CREATESTRUCT**](/windows/win32/api/winuser/ns-winuser-createstructa) structure while processing the [**WM\_CREATE**](/windows/desktop/winmsg/wm-create) message.</span></span>

<span data-ttu-id="17fec-176">В следующих примерах, где *хвндконтрол* — это маркер окна управления, а CN \_ VALUECHANGED — пользовательское определение уведомления, покажите два способа отправки уведомления, относящихся к конкретному элементу управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-176">The following examples, where *hwndControl* is the handle of the control window and CN\_VALUECHANGED is a custom notification definition, show the two ways of sending a control-specific notification.</span></span>


```
 // Send as WM_COMMAND.
SendMessage(GetParent(hwndControl), 
    WM_COMMAND,
    MAKEWPARAM(GetDlgCtrlID(hwndControl), CN_VALUECHANGED),
    (LPARAM)hwndControl);

// Send as WM_NOTIFY.           
NMHDR nmh;
nmh.code = CN_VALUECHANGED;
nmh.idFrom = GetDlgCtrlID(hwndControl);
nmh.hwndFrom = hwndControl;
SendMessage(GetParent(hwndControl), 
    WM_NOTIFY, 
    (WPARAM)hwndControl, 
    (LPARAM)&nmh);
```



<span data-ttu-id="17fec-177">Обратите внимание, что структура [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) может быть частью более крупной, определяемой элементом управления структуры, содержащей дополнительные сведения.</span><span class="sxs-lookup"><span data-stu-id="17fec-177">Note that the [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) structure can be part of a larger control-defined structure that contains additional information.</span></span> <span data-ttu-id="17fec-178">В этом примере старые и новые значения элемента управления могут содержаться в этой структуре.</span><span class="sxs-lookup"><span data-stu-id="17fec-178">In the example, the old and new values of the control might be contained in this structure.</span></span> <span data-ttu-id="17fec-179">(Такие расширенные структуры используются со многими стандартными уведомлениями. Например, см. раздел [ЛВН \_ INSERTITEM](lvn-insertitem.md), в котором используется структура [**нмлиствиев**](/windows/win32/api/commctrl/ns-commctrl-nmlistview) .)</span><span class="sxs-lookup"><span data-stu-id="17fec-179">(Such extended structures are used with many standard notifications; for example, see [LVN\_INSERTITEM](lvn-insertitem.md), which uses the [**NMLISTVIEW**](/windows/win32/api/commctrl/ns-commctrl-nmlistview) structure.)</span></span>

## <a name="accessibility"></a><span data-ttu-id="17fec-180">Специальные возможности</span><span class="sxs-lookup"><span data-stu-id="17fec-180">Accessibility</span></span>

<span data-ttu-id="17fec-181">Все общие элементы управления поддерживают Microsoft Active Accessibility (MSAA), который обеспечивает программный доступ к приложениям с поддержкой специальных возможностей, таким как средства чтения с экрана.</span><span class="sxs-lookup"><span data-stu-id="17fec-181">All the common controls support Microsoft Active Accessibility (MSAA), which enables programmatic access by accessible-technology applications such as screen-readers.</span></span> <span data-ttu-id="17fec-182">MSAA также обеспечивает автоматизацию пользовательского интерфейса, более новую технологию, для взаимодействия с элементами управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-182">MSAA also enables UI Automation, a newer technology, to interact with controls.</span></span>

<span data-ttu-id="17fec-183">Пользовательские элементы управления должны реализовывать интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) (для поддержки MSAA) или интерфейсы модели автоматизации пользовательского интерфейса, или и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="17fec-183">Custom controls should implement either the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface (to support MSAA) or the UI Automation interfaces, or both.</span></span> <span data-ttu-id="17fec-184">В противном случае программные продукты, доступные для работы с технологиями, смогут получить только очень ограниченные сведения об окне управления, не будут иметь доступа к свойствам элемента управления и не смогут активировать события в элементе управления.</span><span class="sxs-lookup"><span data-stu-id="17fec-184">Otherwise, accessible-technology products will be able to obtain only very limited information about the control window, will not have access to the control's properties, and will be unable to trigger events in the control.</span></span>

<span data-ttu-id="17fec-185">Дополнительные сведения о том, как сделать элемент управления доступным, см. в разделе [API автоматизации Windows](/windows/desktop/WinAuto/windows-automation-api-portal).</span><span class="sxs-lookup"><span data-stu-id="17fec-185">For more information about making your control accessible, see [Windows Automation API](/windows/desktop/WinAuto/windows-automation-api-portal).</span></span>

## <a name="related-topics"></a><span data-ttu-id="17fec-186">См. также</span><span class="sxs-lookup"><span data-stu-id="17fec-186">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="17fec-187">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="17fec-187">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="17fec-188">Справочник по общим элементам управления</span><span class="sxs-lookup"><span data-stu-id="17fec-188">General Control Reference</span></span>](common-control-reference.md)
</dt> <dt>

[<span data-ttu-id="17fec-189">Настройка внешнего вида элемента управления с помощью пользовательского рисования</span><span class="sxs-lookup"><span data-stu-id="17fec-189">Customizing a Control's Appearance Using Custom Draw</span></span>](custom-draw.md)
</dt> <dt>

[<span data-ttu-id="17fec-190">Управляющие сообщения</span><span class="sxs-lookup"><span data-stu-id="17fec-190">Control Messages</span></span>](control-messages.md)
</dt> <dt>

[<span data-ttu-id="17fec-191">Использование стилей оформления с элементами управления Owner-Drawn</span><span class="sxs-lookup"><span data-stu-id="17fec-191">Using Visual Styles with Owner-Drawn Controls</span></span>](using-visual-styles.md)
</dt> </dl>

 

 