---
title: Сообщение PSM_INSERTPAGE (Пршт. h)
description: Вставляет новую страницу в существующую вкладку свойств. Эту страницу можно вставить либо по указанному индексу, либо после указанной страницы. Это сообщение можно отправить явным образом или с помощью \_ макроса пропшит инсертпаже.
ms.assetid: 69d55e68-510d-45f1-93d6-ce2bf5dfdb6d
keywords:
- элементы управления Windows сообщений PSM_INSERTPAGE
topic_type:
- apiref
api_name:
- PSM_INSERTPAGE
api_location:
- Prsht.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 11c81869b1ca575efa960fc00eea09536ca4b6b2f43a5e637c5dc6a9d7632983
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119985670"
---
# <a name="psm_insertpage-message"></a>\_Сообщение ПСМ инсертпаже

Вставляет новую страницу в существующую вкладку свойств. Эту страницу можно вставить либо по указанному индексу, либо после указанной страницы. Это сообщение можно отправить явным образом или с помощью макроса [**пропшит \_ инсертпаже**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) .

## <a name="parameters"></a>Параметры

<dl> <dt>

*wParam* 
</dt> <dd>

Место вставки страницы. Присвойте этому параметру **значение NULL** , чтобы новая страница стала первой страницей. Чтобы указать место вставки новой страницы, можно передать индекс или обработчик ХПРОПШИТПАЖЕ существующей страницы.



| Значение                                                                                                                                             | Значение                                                                                                                                                                                                                                                                                                                                                                                                                    |
|---------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt></dt> <dt>index</dt> </dl>            | Если значение параметра *wParam* меньше максушорт (самое большое целое число без знака), то параметр *wParam* задает отсчитываемый от нуля индекс для новой страницы. Например, чтобы сделать вставленную страницу третьей страницей на странице свойств, установите параметр *wParam* в значение 2. Чтобы сделать его первой страницей, установите параметр *wParam* в значение 0. Если параметр *wParam* имеет значение больше, чем число страниц и меньше максушорт, то страница будет добавлена.<br/> |
| <dl> <dt></dt><dt>хпажеинсертафтер</dt> </dl> | Если задать для параметра *wParam* маркер хпропшитпаже существующей страницы, Новая страница будет вставлена после нее.<br/>                                                                                                                                                                                                                                                                                          |



 

</dd> <dt>

*lParam* 
</dt> <dd>

Обрабатываемый обработчик для вставляемой страницы. Сначала необходимо создать страницу, вызвав функцию [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает ненулевое значение, если страница была успешно вставлена, или ноль в противном случае.

## <a name="remarks"></a>Remarks

Страницы после точки вставки сдвигаются вправо, чтобы разместить новую страницу.

Размер страницы свойств не изменяется в соответствии с новой страницей. Не делайте новую страницу больше, чем самая большая страница страницы свойств.

Количество сообщений и один вызов функции происходят, когда страница свойств манипулирует списком страниц. При выполнении этого действия попытка изменить список страниц приведет к непредсказуемым результатам. соответственно, не следует использовать \_ сообщение псм инсертпаже в реализации [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) или при обработке следующих уведомлений и Windows сообщений.

-   [PSN \_ Применить](psn-apply.md)
-   [PSN \_ киллактиве](psn-killactive.md)
-   [\_Сброс PSN](psn-reset.md)
-   [PSN \_ сетактиве](psn-setactive.md)
-   [**WM \_ destroy**](/windows/desktop/winmsg/wm-destroy)
-   [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog)

если необходимо изменить страницу свойств во время обработки одного из этих сообщений или во время выполнения [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) , опубликуйте сообщение частного Windows. Приложение не будет принимать это сообщение до тех пор, пока диспетчер страниц свойств не завершит свои задачи. Затем можно изменить список страниц.

На следующие уведомления также влияют изменения страницы свойств.

-   [PSN \_ визбакк](psn-wizback.md)
-   [PSN \_ визнекст](psn-wiznext.md)

В ответ на эти уведомления можно добавлять или удалять страницы при условии, что вы возвращаете (через DWL \_ мсгресулт) ненулевое значение для указания нужной новой страницы. Однако обратите внимание, что при вставке страницы, расположенной перед текущей страницей (с меньшим индексом, чем текущая страница), [PSN \_ киллактиве](psn-killactive.md) может быть отправлен на неправильную страницу.

> [!Note]  
> Это сообщение не поддерживается при использовании стиля мастера Aero ([**командном PSH \_ аеровизард**](/windows/desktop/api/Prsht/ns-prsht-propsheetheadera_v2)).

 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения Vista\]<br/>                                     |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2003\]<br/>                               |
| Заголовок<br/>                   | <dl> <dt>Пршт. h</dt> </dl> |



 

