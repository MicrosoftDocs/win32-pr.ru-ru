---
title: О пользовательской прорисовке
description: В этом разделе содержатся общие сведения о пользовательской функции рисования и дается концептуальный обзор того, как приложение может поддерживать пользовательскую прорисовку.
ms.assetid: dd104661-1e0c-4569-9753-817bcded1894
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 121a4df5aa6fab222a5c4387ebdcfba51a7977b2
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2020
ms.locfileid: "104488442"
---
# <a name="about-custom-draw"></a><span data-ttu-id="fd011-103">О пользовательской прорисовке</span><span class="sxs-lookup"><span data-stu-id="fd011-103">About Custom Draw</span></span>

<span data-ttu-id="fd011-104">В этом разделе содержатся общие сведения о пользовательской функции рисования и дается концептуальный обзор того, как приложение может поддерживать пользовательскую прорисовку.</span><span class="sxs-lookup"><span data-stu-id="fd011-104">This section contains general information about custom draw functionality and provides a conceptual overview of how an application can support custom draw.</span></span> <span data-ttu-id="fd011-105">В настоящее время следующие элементы управления поддерживают пользовательские функции рисования:</span><span class="sxs-lookup"><span data-stu-id="fd011-105">Currently, the following controls support custom draw functionality:</span></span>

-   <span data-ttu-id="fd011-106">Элементы управления "заголовок"</span><span class="sxs-lookup"><span data-stu-id="fd011-106">Header controls</span></span>
-   <span data-ttu-id="fd011-107">Элементы управления "представление списка"</span><span class="sxs-lookup"><span data-stu-id="fd011-107">List-view controls</span></span>
-   <span data-ttu-id="fd011-108">Элементы управления главной панели</span><span class="sxs-lookup"><span data-stu-id="fd011-108">Rebar controls</span></span>
-   <span data-ttu-id="fd011-109">Элементы управления панели инструментов</span><span class="sxs-lookup"><span data-stu-id="fd011-109">Toolbar controls</span></span>
-   <span data-ttu-id="fd011-110">Элементы управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="fd011-110">Tooltip controls</span></span>
-   <span data-ttu-id="fd011-111">Элементы управления TrackBar</span><span class="sxs-lookup"><span data-stu-id="fd011-111">Trackbar controls</span></span>
-   <span data-ttu-id="fd011-112">Элементы управления "дерево-представление"</span><span class="sxs-lookup"><span data-stu-id="fd011-112">Tree-view controls</span></span>

<!-- -->

-   [<span data-ttu-id="fd011-113">О настраиваемых сообщениях уведомления о выводе</span><span class="sxs-lookup"><span data-stu-id="fd011-113">About Custom Draw Notification Messages</span></span>](#about-custom-draw-notification-messages)
-   [<span data-ttu-id="fd011-114">Циклы рисования, этапы рисования и сообщения с уведомлениями</span><span class="sxs-lookup"><span data-stu-id="fd011-114">Paint Cycles, Drawing Stages, and Notification Messages</span></span>](#paint-cycles-drawing-stages-and-notification-messages)
-   [<span data-ttu-id="fd011-115">Использование преимуществ пользовательских служб рисования</span><span class="sxs-lookup"><span data-stu-id="fd011-115">Taking Advantage of Custom Draw Services</span></span>](#taking-advantage-of-custom-draw-services)
    -   [<span data-ttu-id="fd011-116">Ответ на уведомление о предрисовке</span><span class="sxs-lookup"><span data-stu-id="fd011-116">Responding to the prepaint notification</span></span>](#responding-to-the-prepaint-notification)
    -   [<span data-ttu-id="fd011-117">Запрос уведомлений для конкретного элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-117">Requesting item-specific notifications</span></span>](#requesting-item-specific-notifications)
    -   [<span data-ttu-id="fd011-118">Рисование элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-118">Drawing the item yourself</span></span>](#drawing-the-item-yourself)
    -   [<span data-ttu-id="fd011-119">Изменение шрифтов и цветов</span><span class="sxs-lookup"><span data-stu-id="fd011-119">Changing fonts and colors</span></span>](#changing-fonts-and-colors)
-   [<span data-ttu-id="fd011-120">Пользовательские прорисовки с помощью элементов управления List-View и Tree-View</span><span class="sxs-lookup"><span data-stu-id="fd011-120">Custom Draw With List-View and Tree-View Controls</span></span>](#custom-draw-with-list-view-and-tree-view-controls)
    -   [<span data-ttu-id="fd011-121">Пользовательские прорисовки с помощью элементов управления List-View</span><span class="sxs-lookup"><span data-stu-id="fd011-121">Custom Draw With List-View Controls</span></span>](#custom-draw-with-list-view-controls)
-   [<span data-ttu-id="fd011-122">См. также</span><span class="sxs-lookup"><span data-stu-id="fd011-122">Related topics</span></span>](#related-topics)

## <a name="about-custom-draw-notification-messages"></a><span data-ttu-id="fd011-123">О настраиваемых сообщениях уведомления о выводе</span><span class="sxs-lookup"><span data-stu-id="fd011-123">About Custom Draw Notification Messages</span></span>

<span data-ttu-id="fd011-124">Все стандартные элементы управления, поддерживающие пользовательские коды уведомления Send [ \_ кустомдрав](nm-customdraw.md) , в конкретных точках во время операций рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-124">All common controls that support custom draw send [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes at specific points during drawing operations.</span></span> <span data-ttu-id="fd011-125">Эти коды уведомлений описывают операции рисования, которые применяются ко всему элементу управления, а также к операциям рисования, относящимся к элементам внутри элемента управления.</span><span class="sxs-lookup"><span data-stu-id="fd011-125">These notification codes describe drawing operations that apply to the entire control as well as drawing operations specific to items within the control.</span></span> <span data-ttu-id="fd011-126">Как и многие коды уведомлений, \_ кустомдравные уведомления отправляются в виде сообщений [**WM \_ Notify**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="fd011-126">Like many notification codes, NM\_CUSTOMDRAW notifications are sent as [**WM\_NOTIFY**](wm-notify.md) messages.</span></span>

<span data-ttu-id="fd011-127">Параметр *lParam* пользовательского уведомления о выводе будет являться адресом структуры [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) или структурой элемента управления, содержащей структуру **нмкустомдрав** в качестве первого элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-127">The *lParam* parameter of a custom draw notification will be the address of an [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure or a control-specific structure that contains an **NMCUSTOMDRAW** structure as its first member.</span></span> <span data-ttu-id="fd011-128">В следующей таблице показана связь между элементами управления и используемыми ими структурами.</span><span class="sxs-lookup"><span data-stu-id="fd011-128">The following table illustrates the relationship between the controls and the structures they use.</span></span>



| <span data-ttu-id="fd011-129">Структура</span><span class="sxs-lookup"><span data-stu-id="fd011-129">Structure</span></span>                                | <span data-ttu-id="fd011-130">Где используется</span><span class="sxs-lookup"><span data-stu-id="fd011-130">Used by</span></span>                              |
|------------------------------------------|--------------------------------------|
| [<span data-ttu-id="fd011-131">**нмкустомдрав**</span><span class="sxs-lookup"><span data-stu-id="fd011-131">**NMCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)     | <span data-ttu-id="fd011-132">Элементы управления "Главная панель", "TrackBar" и "заголовок"</span><span class="sxs-lookup"><span data-stu-id="fd011-132">Rebar, trackbar, and header controls</span></span> |
| [<span data-ttu-id="fd011-133">**нмлвкустомдрав**</span><span class="sxs-lookup"><span data-stu-id="fd011-133">**NMLVCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmlvcustomdraw) | <span data-ttu-id="fd011-134">Элементы управления "представление списка"</span><span class="sxs-lookup"><span data-stu-id="fd011-134">List-view controls</span></span>                   |
| [<span data-ttu-id="fd011-135">**нмтбкустомдрав**</span><span class="sxs-lookup"><span data-stu-id="fd011-135">**NMTBCUSTOMDRAW**</span></span>](/windows/desktop/api/Commctrl/ns-commctrl-nmtbcustomdraw) | <span data-ttu-id="fd011-136">Элементы управления панели инструментов</span><span class="sxs-lookup"><span data-stu-id="fd011-136">Toolbar controls</span></span>                     |
| [<span data-ttu-id="fd011-137">**нмтткустомдрав**</span><span class="sxs-lookup"><span data-stu-id="fd011-137">**NMTTCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmttcustomdraw) | <span data-ttu-id="fd011-138">Элементы управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="fd011-138">Tooltip controls</span></span>                     |
| [<span data-ttu-id="fd011-139">**нмтвкустомдрав**</span><span class="sxs-lookup"><span data-stu-id="fd011-139">**NMTVCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw) | <span data-ttu-id="fd011-140">Элементы управления "дерево-представление"</span><span class="sxs-lookup"><span data-stu-id="fd011-140">Tree-view controls</span></span>                   |



 

## <a name="paint-cycles-drawing-stages-and-notification-messages"></a><span data-ttu-id="fd011-141">Циклы рисования, этапы рисования и сообщения с уведомлениями</span><span class="sxs-lookup"><span data-stu-id="fd011-141">Paint Cycles, Drawing Stages, and Notification Messages</span></span>

<span data-ttu-id="fd011-142">Как и все приложения Windows, стандартные элементы управления периодически передаются и удаляются на основе сообщений, полученных от системы или других приложений.</span><span class="sxs-lookup"><span data-stu-id="fd011-142">Like all Windows applications, common controls periodically paint and erase themselves based on messages received from the system or other applications.</span></span> <span data-ttu-id="fd011-143">Процесс рисования или стирания элемента управления называется *циклом рисования*.</span><span class="sxs-lookup"><span data-stu-id="fd011-143">The process of a control painting or erasing itself is called a *paint cycle*.</span></span> <span data-ttu-id="fd011-144">Элементы управления, поддерживающие пользовательский код уведомления Send [NM \_ кустомдрав](nm-customdraw.md) , периодически проходят через каждый цикл рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-144">Controls that support custom draw send [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes periodically through each paint cycle.</span></span> <span data-ttu-id="fd011-145">Этот код уведомления сопровождается структурой [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) или другой структурой, содержащей структуру **нмкустомдрав** в качестве первого элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-145">This notification code is accompanied by an [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure or another structure that contains an **NMCUSTOMDRAW** structure as its first member.</span></span>

<span data-ttu-id="fd011-146">Один из данных, содержащихся в структуре [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) , — это текущий этап цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-146">One piece of information that the [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure contains is the current stage of the paint cycle.</span></span> <span data-ttu-id="fd011-147">Это называется *стадией прорисовки* и представляется значением в элементе **двдравстаже** структуры.</span><span class="sxs-lookup"><span data-stu-id="fd011-147">This is referred to as the *draw stage* and is represented by the value in the structure's **dwDrawStage** member.</span></span> <span data-ttu-id="fd011-148">Элемент управления сообщает его родителю о четырех основных стадиях рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-148">A control informs its parent about four basic draw stages.</span></span> <span data-ttu-id="fd011-149">Эти основные или глобальные этапы рисования представлены в структуре следующими значениями флагов (определенными в Коммктрл. h).</span><span class="sxs-lookup"><span data-stu-id="fd011-149">These basic, or global, draw stages are represented in the structure by the following flag values (defined in Commctrl.h).</span></span>



| <span data-ttu-id="fd011-150">Глобальные значения этапа рисования</span><span class="sxs-lookup"><span data-stu-id="fd011-150">Global draw stage values</span></span> | <span data-ttu-id="fd011-151">Описание</span><span class="sxs-lookup"><span data-stu-id="fd011-151">Description</span></span>                        |
|--------------------------|------------------------------------|
| <span data-ttu-id="fd011-152">КДДС \_</span><span class="sxs-lookup"><span data-stu-id="fd011-152">CDDS\_PREPAINT</span></span>           | <span data-ttu-id="fd011-153">Перед началом цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-153">Before the paint cycle begins.</span></span>     |
| <span data-ttu-id="fd011-154">КДДС \_</span><span class="sxs-lookup"><span data-stu-id="fd011-154">CDDS\_POSTPAINT</span></span>          | <span data-ttu-id="fd011-155">После завершения цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-155">After the paint cycle is complete.</span></span> |
| <span data-ttu-id="fd011-156">предочистка КДДС \_</span><span class="sxs-lookup"><span data-stu-id="fd011-156">CDDS\_PREERASE</span></span>           | <span data-ttu-id="fd011-157">Перед началом цикла стирания.</span><span class="sxs-lookup"><span data-stu-id="fd011-157">Before the erase cycle begins.</span></span>     |
| <span data-ttu-id="fd011-158">КДДСная \_ Очистка</span><span class="sxs-lookup"><span data-stu-id="fd011-158">CDDS\_POSTERASE</span></span>          | <span data-ttu-id="fd011-159">После завершения цикла стирания.</span><span class="sxs-lookup"><span data-stu-id="fd011-159">After the erase cycle is complete.</span></span> |



 

<span data-ttu-id="fd011-160">Каждое из приведенных выше значений можно сочетать с \_ флагом элемента кддс, чтобы указать этапы отрисовки, характерные для элементов.</span><span class="sxs-lookup"><span data-stu-id="fd011-160">Each of the preceding values can be combined with the CDDS\_ITEM flag to specify draw stages specific to items.</span></span> <span data-ttu-id="fd011-161">Для удобства Коммктрл. h содержит следующие значения, зависящие от конкретного элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-161">For convenience, Commctrl.h contains the following item-specific values.</span></span>



| <span data-ttu-id="fd011-162">Значения этапа отрисовки для конкретного элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-162">Item-specific draw stage values</span></span> | <span data-ttu-id="fd011-163">Описание</span><span class="sxs-lookup"><span data-stu-id="fd011-163">Description</span></span>                                                                                                                                                                                                                                                                         |
|---------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fd011-164">КДДС \_ итемпрепаинт</span><span class="sxs-lookup"><span data-stu-id="fd011-164">CDDS\_ITEMPREPAINT</span></span>              | <span data-ttu-id="fd011-165">Перед прорисовкой элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-165">Before an item is drawn.</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="fd011-166">КДДС \_ итемпостпаинт</span><span class="sxs-lookup"><span data-stu-id="fd011-166">CDDS\_ITEMPOSTPAINT</span></span>             | <span data-ttu-id="fd011-167">После прорисовки элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-167">After an item has been drawn.</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="fd011-168">КДДС \_ итемприрасе</span><span class="sxs-lookup"><span data-stu-id="fd011-168">CDDS\_ITEMPREERASE</span></span>              | <span data-ttu-id="fd011-169">Перед удалением элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-169">Before an item is erased.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="fd011-170">КДДС \_ итемпостерасе</span><span class="sxs-lookup"><span data-stu-id="fd011-170">CDDS\_ITEMPOSTERASE</span></span>             | <span data-ttu-id="fd011-171">После удаления элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-171">After an item has been erased.</span></span>                                                                                                                                                                                                                                                      |
| <span data-ttu-id="fd011-172">подэлемент КДДС \_</span><span class="sxs-lookup"><span data-stu-id="fd011-172">CDDS\_SUBITEM</span></span>                   | <span data-ttu-id="fd011-173">[Стандартные версии элементов управления](common-control-versions.md) 4,71.</span><span class="sxs-lookup"><span data-stu-id="fd011-173">[Common Control Versions](common-control-versions.md) 4.71.</span></span> <span data-ttu-id="fd011-174">Пометьте вместе с КДДС \_ итемпрепаинт или кддс \_ итемпостпаинт при прорисовке подэлемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-174">Flag combined with CDDS\_ITEMPREPAINT or CDDS\_ITEMPOSTPAINT if a subitem is being drawn.</span></span> <span data-ttu-id="fd011-175">Это значение будет установлено только в том случае, если [**кдрф \_ нотифитемдрав**](cdrf-constants.md) возвращается из кддс предустановки \_ .</span><span class="sxs-lookup"><span data-stu-id="fd011-175">This will only be set if [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md) is returned from CDDS\_PREPAINT.</span></span> |



 

<span data-ttu-id="fd011-176">Приложение должно обработать код уведомления [NM \_ кустомдрав](nm-customdraw.md) , а затем вернуть конкретное значение, которое информирует элемент управления о том, что оно должно делать.</span><span class="sxs-lookup"><span data-stu-id="fd011-176">Your application must process the [NM\_CUSTOMDRAW](nm-customdraw.md) notification code and then return a specific value that informs the control what it must do.</span></span> <span data-ttu-id="fd011-177">Дополнительные сведения об этих возвращаемых значениях см. в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="fd011-177">See the following sections for more information about these return values.</span></span>

## <a name="taking-advantage-of-custom-draw-services"></a><span data-ttu-id="fd011-178">Использование преимуществ пользовательских служб рисования</span><span class="sxs-lookup"><span data-stu-id="fd011-178">Taking Advantage of Custom Draw Services</span></span>

<span data-ttu-id="fd011-179">Ключом к использованию пользовательских функций рисования является реагирование на коды уведомлений [NM \_ кустомдрав](nm-customdraw.md) , которые отправляет элемент управления.</span><span class="sxs-lookup"><span data-stu-id="fd011-179">The key to harnessing custom draw functionality is in responding to the [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes that a control sends.</span></span> <span data-ttu-id="fd011-180">Возвращаемые значения, которые приложение отправляет в ответ на эти уведомления, определяют поведение элемента управления для этого цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-180">The return values your application sends in response to these notifications determine the control's behavior for that paint cycle.</span></span>

<span data-ttu-id="fd011-181">В этом разделе содержатся сведения о том, как приложение может использовать возвращаемые значения уведомлений [NM \_ кустомдрав](nm-customdraw.md) для определения поведения элемента управления.</span><span class="sxs-lookup"><span data-stu-id="fd011-181">This section contains information about how your application can use [NM\_CUSTOMDRAW](nm-customdraw.md) notification return values to determine the control's behavior.</span></span>

<span data-ttu-id="fd011-182">Сведения разбиваются на следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="fd011-182">Details are broken into the following topics:</span></span>

-   [<span data-ttu-id="fd011-183">Ответ на уведомление о предрисовке</span><span class="sxs-lookup"><span data-stu-id="fd011-183">Responding to the prepaint notification</span></span>](#responding-to-the-prepaint-notification)
-   [<span data-ttu-id="fd011-184">Запрос уведомлений для конкретного элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-184">Requesting item-specific notifications</span></span>](#requesting-item-specific-notifications)
-   [<span data-ttu-id="fd011-185">Рисование элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-185">Drawing the item yourself</span></span>](#drawing-the-item-yourself)
-   [<span data-ttu-id="fd011-186">Изменение шрифтов и цветов</span><span class="sxs-lookup"><span data-stu-id="fd011-186">Changing fonts and colors</span></span>](#changing-fonts-and-colors)

### <a name="responding-to-the-prepaint-notification"></a><span data-ttu-id="fd011-187">Ответ на уведомление о предрисовке</span><span class="sxs-lookup"><span data-stu-id="fd011-187">Responding to the prepaint notification</span></span>

<span data-ttu-id="fd011-188">В начале каждого цикла рисования элемент управления отправляет код уведомления [NM \_ кустомдрав](nm-customdraw.md) , указывая \_ значение кддс в элементе **двдравстаже** сопутствующей \_ кустомдрав структуры.</span><span class="sxs-lookup"><span data-stu-id="fd011-188">At the beginning of each paint cycle, the control sends the [NM\_CUSTOMDRAW](nm-customdraw.md) notification code, specifying the CDDS\_PREPAINT value in the **dwDrawStage** member of the accompanying NM\_CUSTOMDRAW structure.</span></span> <span data-ttu-id="fd011-189">Значение, которое приложение возвращает к первому уведомлению, определяет, как и когда элемент управления отправляет последующие уведомления о пользовательской прорисовке для оставшейся части этого цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-189">The value that your application returns to this first notification dictates how and when the control sends subsequent custom draw notifications for the rest of that paint cycle.</span></span> <span data-ttu-id="fd011-190">Приложение может вернуть сочетание следующих флагов в ответ на первое уведомление.</span><span class="sxs-lookup"><span data-stu-id="fd011-190">Your application can return a combination of the following flags in response to the first notification.</span></span>



| <span data-ttu-id="fd011-191">Возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="fd011-191">Return value</span></span>            | <span data-ttu-id="fd011-192">Действие</span><span class="sxs-lookup"><span data-stu-id="fd011-192">Effect</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|-------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fd011-193">КДРФ \_ додефаулт</span><span class="sxs-lookup"><span data-stu-id="fd011-193">CDRF\_DODEFAULT</span></span>         | <span data-ttu-id="fd011-194">Элемент управления будет рисовать сам.</span><span class="sxs-lookup"><span data-stu-id="fd011-194">The control will draw itself.</span></span> <span data-ttu-id="fd011-195">Он не будет отправлять дополнительные [уведомления \_ кустомдрав](nm-customdraw.md) для этого цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-195">It will not send additional [NM\_CUSTOMDRAW](nm-customdraw.md) notifications for this paint cycle.</span></span> <span data-ttu-id="fd011-196">Этот флаг нельзя использовать с любым другим флагом.</span><span class="sxs-lookup"><span data-stu-id="fd011-196">This flag cannot be used with any other flag.</span></span>                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="fd011-197">КДРФ \_ доерасе</span><span class="sxs-lookup"><span data-stu-id="fd011-197">CDRF\_DOERASE</span></span>           | <span data-ttu-id="fd011-198">Элемент управления будет рисовать только фон.</span><span class="sxs-lookup"><span data-stu-id="fd011-198">The control will only draw the background.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="fd011-199">КДРФ \_ невфонт</span><span class="sxs-lookup"><span data-stu-id="fd011-199">CDRF\_NEWFONT</span></span>           | <span data-ttu-id="fd011-200">В приложении указан новый шрифт для элемента. элемент управления будет использовать новый шрифт.</span><span class="sxs-lookup"><span data-stu-id="fd011-200">Your application specified a new font for the item; the control will use the new font.</span></span> <span data-ttu-id="fd011-201">Дополнительные сведения об изменении шрифтов см. в разделе [Изменение шрифтов и цветов](#changing-fonts-and-colors).</span><span class="sxs-lookup"><span data-stu-id="fd011-201">For more information on changing fonts, see [Changing fonts and colors](#changing-fonts-and-colors).</span></span> <span data-ttu-id="fd011-202">Это происходит, когда **двдравстаже** равно кддс \_ итемпрепаинт.</span><span class="sxs-lookup"><span data-stu-id="fd011-202">This occurs when **dwDrawStage** equals CDDS\_ITEMPREPAINT.</span></span>                                                                                                                                                                                                       |
| <span data-ttu-id="fd011-203">КДРФ \_ нотифитемдрав</span><span class="sxs-lookup"><span data-stu-id="fd011-203">CDRF\_NOTIFYITEMDRAW</span></span>    | <span data-ttu-id="fd011-204">Элемент управления будет уведомлять родителя всех операций рисования, связанных с элементами.</span><span class="sxs-lookup"><span data-stu-id="fd011-204">The control will notify the parent of any item-specific drawing operations.</span></span> <span data-ttu-id="fd011-205">Он будет отсылать [технологические \_](nm-customdraw.md) коды уведомлений до и после рисования элементов. Это происходит, когда **двдравстаже** равно кддс \_ .</span><span class="sxs-lookup"><span data-stu-id="fd011-205">It will send [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes before and after it draws items.This occurs when **dwDrawStage** equals CDDS\_PREPAINT.</span></span>                                                                                                                                                                                                                       |
| <span data-ttu-id="fd011-206">КДРФ \_ нотифипостерасе</span><span class="sxs-lookup"><span data-stu-id="fd011-206">CDRF\_NOTIFYPOSTERASE</span></span>   | <span data-ttu-id="fd011-207">Элемент управления будет уведомлять родительский элемент после стирания элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-207">The control will notify the parent after erasing an item.</span></span> <span data-ttu-id="fd011-208">Это происходит, когда **двдравстаже** равно кддс \_ .</span><span class="sxs-lookup"><span data-stu-id="fd011-208">This occurs when **dwDrawStage** equals CDDS\_PREPAINT.</span></span>                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="fd011-209">КДРФ \_ нотифипостпаинт</span><span class="sxs-lookup"><span data-stu-id="fd011-209">CDRF\_NOTIFYPOSTPAINT</span></span>   | <span data-ttu-id="fd011-210">При завершении цикла рисования для всего элемента управления будет отправлено уведомление [ \_ кустомдрав](nm-customdraw.md) .</span><span class="sxs-lookup"><span data-stu-id="fd011-210">The control will send an [NM\_CUSTOMDRAW](nm-customdraw.md) notification when the painting cycle for the entire control is complete.</span></span> <span data-ttu-id="fd011-211">Это происходит, когда **двдравстаже** равно кддс \_ .</span><span class="sxs-lookup"><span data-stu-id="fd011-211">This occurs when **dwDrawStage** equals CDDS\_PREPAINT.</span></span>                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="fd011-212">КДРФ \_ нотифисубитемдрав</span><span class="sxs-lookup"><span data-stu-id="fd011-212">CDRF\_NOTIFYSUBITEMDRAW</span></span> | <span data-ttu-id="fd011-213">[Версия 4,71](common-control-versions.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-213">[Version 4.71](common-control-versions.md).</span></span> <span data-ttu-id="fd011-214">Приложение получит [ \_ кустомдравное](nm-customdraw.md) уведомление с **двдравстаже** , для которого задано значение кддс \_ итемпрепаинт \| кддс \_ подэлемент перед прорисовкой каждого подэлемента представления списка.</span><span class="sxs-lookup"><span data-stu-id="fd011-214">Your application will receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification with **dwDrawStage** set to CDDS\_ITEMPREPAINT \| CDDS\_SUBITEM before each list-view subitem is drawn.</span></span> <span data-ttu-id="fd011-215">Затем можно указать шрифт и цвет для каждого подэлемента отдельно или вернуть [**кдрф \_ додефаулт**](cdrf-constants.md) для обработки по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="fd011-215">You can then specify font and color for each subitem separately or return [**CDRF\_DODEFAULT**](cdrf-constants.md) for default processing.</span></span> <span data-ttu-id="fd011-216">Это происходит, когда **двдравстаже** равно кддс \_ итемпрепаинт.</span><span class="sxs-lookup"><span data-stu-id="fd011-216">This occurs when **dwDrawStage** equals CDDS\_ITEMPREPAINT.</span></span> |
| <span data-ttu-id="fd011-217">КДРФ \_ скипдефаулт</span><span class="sxs-lookup"><span data-stu-id="fd011-217">CDRF\_SKIPDEFAULT</span></span>       | <span data-ttu-id="fd011-218">Приложение вынарисовало элемент вручную.</span><span class="sxs-lookup"><span data-stu-id="fd011-218">Your application drew the item manually.</span></span> <span data-ttu-id="fd011-219">Элемент управления не будет рисовать элемент.</span><span class="sxs-lookup"><span data-stu-id="fd011-219">The control will not draw the item.</span></span> <span data-ttu-id="fd011-220">Это происходит, когда **двдравстаже** равно кддс \_ итемпрепаинт.</span><span class="sxs-lookup"><span data-stu-id="fd011-220">This occurs when **dwDrawStage** equals CDDS\_ITEMPREPAINT.</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="fd011-221">КДРФ \_ скиппостпаинт</span><span class="sxs-lookup"><span data-stu-id="fd011-221">CDRF\_SKIPPOSTPAINT</span></span>     | <span data-ttu-id="fd011-222">Элемент управления не будет рисовать прямоугольник фокуса вокруг элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-222">The control will not draw the focus rectangle around an item.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                 |



 

### <a name="requesting-item-specific-notifications"></a><span data-ttu-id="fd011-223">Запрос уведомлений для конкретного элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-223">Requesting item-specific notifications</span></span>

<span data-ttu-id="fd011-224">Если приложение возвращает [**кдрф \_ нотифитемдрав**](cdrf-constants.md) в начальное настраиваемое уведомление, элемент управления будет отправлять уведомления для каждого элемента, который он рисует во время цикла рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-224">If your application returns [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md) to the initial prepaint custom draw notification, the control will send notifications for each item it draws during that paint cycle.</span></span> <span data-ttu-id="fd011-225">Эти уведомления для конкретного элемента будут иметь значение КДДС \_ итемпрепаинт в элементе **двдравстаже** сопровождающей [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) структуры.</span><span class="sxs-lookup"><span data-stu-id="fd011-225">These item-specific notifications will have the CDDS\_ITEMPREPAINT value in the **dwDrawStage** member of the accompanying [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure.</span></span> <span data-ttu-id="fd011-226">Можно запросить, чтобы элемент управления отправлял еще одно уведомление по завершении прорисовки элемента, возвращая [**кдрф \_ нотифипостпаинт**](cdrf-constants.md) для этих уведомлений об уровне элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-226">You can request that the control send another notification when it is finished drawing the item by returning [**CDRF\_NOTIFYPOSTPAINT**](cdrf-constants.md) to these item-specific notifications.</span></span> <span data-ttu-id="fd011-227">В противном случае возвратите [**кдрф \_ додефаулт**](cdrf-constants.md) , и элемент управления не будет уведомлять родительское окно, пока не начнет прорисовку следующего элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-227">Otherwise, return [**CDRF\_DODEFAULT**](cdrf-constants.md) and the control will not notify the parent window until it starts to draw the next item.</span></span>

### <a name="drawing-the-item-yourself"></a><span data-ttu-id="fd011-228">Рисование элемента</span><span class="sxs-lookup"><span data-stu-id="fd011-228">Drawing the item yourself</span></span>

<span data-ttu-id="fd011-229">Если приложение рисует весь элемент, возвратите [**кдрф \_ скипдефаулт**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-229">If your application draws the entire item, return [**CDRF\_SKIPDEFAULT**](cdrf-constants.md).</span></span> <span data-ttu-id="fd011-230">Это позволяет элементу управления пропускать элементы, которые ему не нужно рисовать, тем самым уменьшая нагрузку на систему.</span><span class="sxs-lookup"><span data-stu-id="fd011-230">This allows the control to skip items that it does not need to draw, thereby decreasing system overhead.</span></span> <span data-ttu-id="fd011-231">Помните, что возврат этого значения означает, что элемент управления не будет рисовать какую бы то ни было части элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-231">Keep in mind that returning this value means the control will not draw any portion of the item.</span></span>

### <a name="changing-fonts-and-colors"></a><span data-ttu-id="fd011-232">Изменение шрифтов и цветов</span><span class="sxs-lookup"><span data-stu-id="fd011-232">Changing fonts and colors</span></span>

<span data-ttu-id="fd011-233">Для изменения шрифта элемента приложение может использовать пользовательский метод рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-233">Your application can use custom draw to change an item's font.</span></span> <span data-ttu-id="fd011-234">Просто выберите ХФОНТ в контексте устройства, который указан в элементе **HDC** структуры [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) , связанной с пользовательским уведомлением рисования.</span><span class="sxs-lookup"><span data-stu-id="fd011-234">Simply select the HFONT you want into the device context specified by the **hdc** member of the [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure associated with the custom draw notification.</span></span> <span data-ttu-id="fd011-235">Так как выбранный шрифт может отличаться от метрик по умолчанию, убедитесь, что в возвращаемое значение для сообщения уведомления включен бит [**кдрф \_ невфонт**](cdrf-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="fd011-235">Since the font you select might have different metrics than the default font, make sure you include the [**CDRF\_NEWFONT**](cdrf-constants.md) bit in the return value for the notification message.</span></span> <span data-ttu-id="fd011-236">Дополнительные сведения об использовании этой функции см. в примере кода в разделе [Использование пользовательской прорисовки](using-custom-draw.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-236">For more information on using this functionality, see the sample code in [Using Custom Draw](using-custom-draw.md).</span></span> <span data-ttu-id="fd011-237">Шрифт, который указывает ваше приложение, используется для показа этого элемента, если он не выбран.</span><span class="sxs-lookup"><span data-stu-id="fd011-237">The font that your application specifies is used to display that item when it is not selected.</span></span> <span data-ttu-id="fd011-238">Пользовательская прорисовка не позволяет изменять атрибуты шрифтов для выбранных элементов.</span><span class="sxs-lookup"><span data-stu-id="fd011-238">Custom draw does not allow you to change the font attributes for selected items.</span></span>

<span data-ttu-id="fd011-239">Чтобы изменить цвета текста для всех элементов управления, поддерживающих пользовательский вывод, за исключением представления списка и представления в виде дерева, просто задайте нужные цвета текста и фона в контексте устройства, предоставляемом в пользовательской структуре уведомления с помощью функций [**сеттекстколор**](/windows/desktop/api/wingdi/nf-wingdi-settextcolor) и [**сетбкколор**](/windows/desktop/api/wingdi/nf-wingdi-setbkcolor) .</span><span class="sxs-lookup"><span data-stu-id="fd011-239">To change text colors for all controls that support custom draw except for the list view and tree view, simply set the desired text and background colors in the device context supplied in the custom draw notification structure with the [**SetTextColor**](/windows/desktop/api/wingdi/nf-wingdi-settextcolor) and [**SetBkColor**](/windows/desktop/api/wingdi/nf-wingdi-setbkcolor) functions.</span></span> <span data-ttu-id="fd011-240">Чтобы изменить цвета текста в представлении списка или представлении в виде дерева, необходимо поместить нужные значения цвета в элементы **клртекст** и **клртекстбк** структуры [**нмлвкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmlvcustomdraw) или [**нмтвкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw) .</span><span class="sxs-lookup"><span data-stu-id="fd011-240">To modify the text colors in the list view or tree view, you need to place the desired color values in the **clrText** and **clrTextBk** members of the [**NMLVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmlvcustomdraw) or [**NMTVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw) structure.</span></span>

> [!Note]  
> <span data-ttu-id="fd011-241">До [версии 6,0](common-control-versions.md) стандартных элементов управления панели инструментов игнорируют флаг [**кдрф \_ невфонт**](cdrf-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="fd011-241">Prior to [Version 6.0](common-control-versions.md) of the common controls, toolbars ignore the [**CDRF\_NEWFONT**](cdrf-constants.md) flag.</span></span> <span data-ttu-id="fd011-242">Версия 6,0 поддерживает флаг **кдрф \_ невфонт** , и его можно использовать для выбора другого шрифта для панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="fd011-242">Version 6.0 supports the **CDRF\_NEWFONT** flag, and you can use it to select a different font for the toolbar.</span></span> <span data-ttu-id="fd011-243">Однако нельзя изменить цвет панели инструментов, когда активен визуальный стиль.</span><span class="sxs-lookup"><span data-stu-id="fd011-243">However, you cannot change a toolbar's color when a visual style is active.</span></span> <span data-ttu-id="fd011-244">Чтобы изменить цвет панели инструментов в версии 6,0, необходимо сначала отключить стили оформления, вызвав [**SetWindowTheme**](/windows/desktop/api/Uxtheme/nf-uxtheme-setwindowtheme) и указав параметр без визуального стиля:</span><span class="sxs-lookup"><span data-stu-id="fd011-244">To change a toolbar's color in Version 6.0, you must first disable visual styles by calling [**SetWindowTheme**](/windows/desktop/api/Uxtheme/nf-uxtheme-setwindowtheme) and specifying no visual style:</span></span>

 


```
SetWindowTheme (hwnd, "", "");
```



## <a name="custom-draw-with-list-view-and-tree-view-controls"></a><span data-ttu-id="fd011-245">Пользовательские прорисовки с помощью элементов управления List-View и Tree-View</span><span class="sxs-lookup"><span data-stu-id="fd011-245">Custom Draw With List-View and Tree-View Controls</span></span>

<span data-ttu-id="fd011-246">Большинство стандартных элементов управления могут обрабатываться практически так же.</span><span class="sxs-lookup"><span data-stu-id="fd011-246">Most common controls can be handled in essentially the same way.</span></span> <span data-ttu-id="fd011-247">Однако элементы управления "список-представление" и "дерево" имеют некоторые функции, для которых требуется несколько иной подход к пользовательской отрисовке.</span><span class="sxs-lookup"><span data-stu-id="fd011-247">However, the list-view and tree-view controls have some features that require a somewhat different approach to custom draw.</span></span>

<span data-ttu-id="fd011-248">В [версии 5,0](common-control-versions.md)эти два элемента управления могут отображать обрезанный текст при изменении шрифта путем возвращения [**кдрф \_ невфонт**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-248">For [Version 5.0](common-control-versions.md), these two controls may display clipped text if you change the font by returning [**CDRF\_NEWFONT**](cdrf-constants.md).</span></span> <span data-ttu-id="fd011-249">Это поведение необходимо для обеспечения обратной совместимости с более ранними версиями стандартных элементов управления.</span><span class="sxs-lookup"><span data-stu-id="fd011-249">This behavior is necessary for backward compatibility with earlier versions of the common controls.</span></span> <span data-ttu-id="fd011-250">Если вы хотите изменить шрифт элемента управления "список-представление" или "дерево-представление", вы получите лучшие результаты, если отправите сообщение [**CCM \_ сетверсион**](ccm-setversion.md) с параметром *wParam* , равным 5, прежде чем добавлять элементы в элемент управления.</span><span class="sxs-lookup"><span data-stu-id="fd011-250">If you want to change the font of a list-view or tree-view control, you will get better results if you send a [**CCM\_SETVERSION**](ccm-setversion.md) message with the *wParam* value set to 5 before adding any items to the control.</span></span> <span data-ttu-id="fd011-251">Пример элемента управления представлением в виде дерева, в котором используется пользовательская прорисовка, см. в статье базы знаний [Sample: Кустдтв иллюстрирует пользовательскую прорисовку в TreeView (Q248496)]( https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496).</span><span class="sxs-lookup"><span data-stu-id="fd011-251">For an example of a tree-view control that uses custom draw see Knowledge Base article [SAMPLE: CustDTv Illustrates Custom Draw in a TreeView (Q248496)]( https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496).</span></span>

### <a name="custom-draw-with-list-view-controls"></a><span data-ttu-id="fd011-252">Пользовательские прорисовки с помощью элементов управления List-View</span><span class="sxs-lookup"><span data-stu-id="fd011-252">Custom Draw With List-View Controls</span></span>

<span data-ttu-id="fd011-253">Так как элементы управления "представление списка" имеют подэлементы и несколько режимов отображения, вам нужно будет работать с уведомлением [NM \_ кустомдрав](nm-customdraw.md) немного иначе, чем для других стандартных элементов управления.</span><span class="sxs-lookup"><span data-stu-id="fd011-253">Because list-view controls have subitems and multiple display modes, you will need to handle the [NM\_CUSTOMDRAW](nm-customdraw.md) notification somewhat differently than for the other common controls.</span></span>

<span data-ttu-id="fd011-254">Для режима отчета используйте следующую процедуру.</span><span class="sxs-lookup"><span data-stu-id="fd011-254">For report mode, use the following procedure.</span></span>

1.  <span data-ttu-id="fd011-255">В первом уведомлении [ \_ кустомдрав](nm-customdraw.md) будет установлен элемент **двдравстаже** в связанном наборе структур [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) для кддс предварительной версии \_ .</span><span class="sxs-lookup"><span data-stu-id="fd011-255">The first [NM\_CUSTOMDRAW](nm-customdraw.md) notification will have the **dwDrawStage** member of the associated [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure set to CDDS\_PREPAINT.</span></span> <span data-ttu-id="fd011-256">Возвращает [**кдрф \_ нотифитемдрав**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-256">Return [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md).</span></span>
2.  <span data-ttu-id="fd011-257">Затем вы получите уведомление о [NM \_ кустомдрав](nm-customdraw.md) с параметром **ДВДРАВСТАЖЕ** , имеющим значение кддс \_ итемпрепаинт.</span><span class="sxs-lookup"><span data-stu-id="fd011-257">You will then receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification with **dwDrawStage** set to CDDS\_ITEMPREPAINT.</span></span> <span data-ttu-id="fd011-258">Если вы укажете новые шрифты или цвета и вернете [**кдрф \_ невфонт**](cdrf-constants.md), будут изменены все подэлементы элемента.</span><span class="sxs-lookup"><span data-stu-id="fd011-258">If you specify new fonts or colors and return [**CDRF\_NEWFONT**](cdrf-constants.md), all subitems of the item will be changed.</span></span> <span data-ttu-id="fd011-259">Если вы хотите, чтобы каждый подэлемент обрабатывался отдельно, возвратите [**кдрф \_ нотифисубитемдрав**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-259">If you want instead to handle each subitem separately, return [**CDRF\_NOTIFYSUBITEMDRAW**](cdrf-constants.md).</span></span>
3.  <span data-ttu-id="fd011-260">Если вы вернули [**кдрф \_ нотифисубитемдрав**](cdrf-constants.md) на предыдущем шаге, вы получите [NM \_ кустомдрав](nm-customdraw.md) уведомление для каждого подэлемента с **ДВДРАВСТАЖЕ** , установленным в кддс \_ подэлемент \| кддс \_ итемпрепаинт.</span><span class="sxs-lookup"><span data-stu-id="fd011-260">If you returned [**CDRF\_NOTIFYSUBITEMDRAW**](cdrf-constants.md) in the previous step, you will then receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification for each subitem with **dwDrawStage** set to CDDS\_SUBITEM \| CDDS\_ITEMPREPAINT.</span></span> <span data-ttu-id="fd011-261">Чтобы изменить шрифт или цвет для этого подэлемента, укажите новый шрифт или цвет и возвратите [**кдрф \_ невфонт**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-261">To change the font or color for that subitem, specify a new font or color and return [**CDRF\_NEWFONT**](cdrf-constants.md).</span></span>

<span data-ttu-id="fd011-262">При работе с крупным значком, мелким значком и режимом списка используйте следующую процедуру.</span><span class="sxs-lookup"><span data-stu-id="fd011-262">For the large icon, small icon, and list modes, use the following procedure.</span></span>

1.  <span data-ttu-id="fd011-263">В первом уведомлении [ \_ кустомдрав](nm-customdraw.md) будет установлен элемент **двдравстаже** в связанном наборе структур [**нмкустомдрав**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) для кддс предварительной версии \_ .</span><span class="sxs-lookup"><span data-stu-id="fd011-263">The first [NM\_CUSTOMDRAW](nm-customdraw.md) notification will have the **dwDrawStage** member of the associated [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure set to CDDS\_PREPAINT.</span></span> <span data-ttu-id="fd011-264">Возвращает [**кдрф \_ нотифитемдрав**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-264">Return [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md).</span></span>
2.  <span data-ttu-id="fd011-265">Затем вы получите уведомление о [NM \_ кустомдрав](nm-customdraw.md) с параметром **ДВДРАВСТАЖЕ** , имеющим значение кддс \_ итемпрепаинт.</span><span class="sxs-lookup"><span data-stu-id="fd011-265">You will then receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification with **dwDrawStage** set to CDDS\_ITEMPREPAINT.</span></span> <span data-ttu-id="fd011-266">Можно изменить шрифты или цвета элемента, указав новые шрифты и цвета и возвращая [**кдрф \_ невфонт**](cdrf-constants.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-266">You can change the fonts or colors of an item by specifying new fonts and colors and returning [**CDRF\_NEWFONT**](cdrf-constants.md).</span></span> <span data-ttu-id="fd011-267">Так как эти режимы не имеют подэлементов, вы не будете получать дополнительные \_ кустомдрав уведомления.</span><span class="sxs-lookup"><span data-stu-id="fd011-267">Because these modes do not have subitems, you will not receive any additional NM\_CUSTOMDRAW notifications.</span></span>

<span data-ttu-id="fd011-268">Пример обработчика уведомлений "List-View [NM \_ кустомдрав](nm-customdraw.md) " см. в разделе [Использование пользовательского рисования](using-custom-draw.md).</span><span class="sxs-lookup"><span data-stu-id="fd011-268">For an example of a list-view [NM\_CUSTOMDRAW](nm-customdraw.md) notification handler, see [Using Custom Draw](using-custom-draw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="fd011-269">См. также</span><span class="sxs-lookup"><span data-stu-id="fd011-269">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="fd011-270">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="fd011-270">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="fd011-271">Использование пользовательского рисования</span><span class="sxs-lookup"><span data-stu-id="fd011-271">Using Custom Draw</span></span>](using-custom-draw.md)
</dt> <dt>

[<span data-ttu-id="fd011-272">Пользовательская ссылка для рисования</span><span class="sxs-lookup"><span data-stu-id="fd011-272">Custom Draw Reference</span></span>](custom-draw-reference.md)
</dt> <dt>

<span data-ttu-id="fd011-273">**Другие ресурсы**</span><span class="sxs-lookup"><span data-stu-id="fd011-273">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="fd011-274">Пример: Кустдтв демонстрирует пользовательское рисование в TreeView (Q248496)</span><span class="sxs-lookup"><span data-stu-id="fd011-274">SAMPLE: CustDTv Illustrates Custom Draw in a TreeView (Q248496)</span></span>]( https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496)
</dt> </dl>

 

 