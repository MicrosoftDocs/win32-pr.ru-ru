---
title: Сведения об элементах управления ToolTip
description: Всплывающие подсказки отображаются автоматически или при наведении указателя мыши на инструмент или другой элемент пользовательского интерфейса.
ms.assetid: 1020cec7-57b4-4463-9419-f80fd14fa12c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9c1042523c86e794865da5d38fb023ee37d60b4
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070701"
---
# <a name="about-tooltip-controls"></a><span data-ttu-id="0db36-103">Сведения об элементах управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="0db36-103">About Tooltip Controls</span></span>

<span data-ttu-id="0db36-104">Всплывающие подсказки отображаются автоматически или при наведении указателя мыши на инструмент или другой элемент пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0db36-104">Tooltips appear automatically, or pop up, when the user pauses the mouse pointer over a tool or some other UI element.</span></span> <span data-ttu-id="0db36-105">Всплывающая подсказка появляется рядом с указателем и исчезает, когда пользователь нажимает кнопку мыши, перемещает указатель за пределы инструмента или просто ждет несколько секунд.</span><span class="sxs-lookup"><span data-stu-id="0db36-105">The tooltip appears near the pointer and disappears when the user clicks a mouse button, moves the pointer away from the tool, or simply waits for a few seconds.</span></span>

<span data-ttu-id="0db36-106">Элемент управления ToolTip на следующем рисунке отображает сведения о файле на рабочем столе Windows.</span><span class="sxs-lookup"><span data-stu-id="0db36-106">The tooltip control in the following illustration displays information about a file on the Windows desktop.</span></span> <span data-ttu-id="0db36-107">При наведении указателя мыши на иллюстрацию также должна отобразиться Динамическая подсказка, содержащая описательный текст.</span><span class="sxs-lookup"><span data-stu-id="0db36-107">As you move the mouse over the illustration, you should also see a live tooltip that contains descriptive text.</span></span>

![снимок экрана с текстом во всплывающей подсказке, отображаемой для файла на рабочем столе](images/tt-desktop.png)

<span data-ttu-id="0db36-109">В этом разделе описывается работа элементов управления ToolTip и их создание.</span><span class="sxs-lookup"><span data-stu-id="0db36-109">This section describes how tooltip controls work and how you create them.</span></span>

-   [<span data-ttu-id="0db36-110">Поведение и внешний вид всплывающей подсказки</span><span class="sxs-lookup"><span data-stu-id="0db36-110">Tooltip Behavior and Appearance</span></span>](#tooltip-behavior-and-appearance)
-   [<span data-ttu-id="0db36-111">Создание элементов управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="0db36-111">Creating Tooltip Controls</span></span>](#creating-tooltip-controls)
-   [<span data-ttu-id="0db36-112">Активация элементов управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="0db36-112">Activating Tooltip Controls</span></span>](#activating-tooltip-controls)
-   [<span data-ttu-id="0db36-113">Вспомогательные средства</span><span class="sxs-lookup"><span data-stu-id="0db36-113">Supporting Tools</span></span>](#supporting-tools)
-   [<span data-ttu-id="0db36-114">Отображение текста</span><span class="sxs-lookup"><span data-stu-id="0db36-114">Displaying Text</span></span>](#displaying-text)
-   [<span data-ttu-id="0db36-115">Обмен сообщениями и уведомление</span><span class="sxs-lookup"><span data-stu-id="0db36-115">Messaging and Notification</span></span>](#messaging-and-notification)
-   [<span data-ttu-id="0db36-116">Проверка нажатия</span><span class="sxs-lookup"><span data-stu-id="0db36-116">Hit Testing</span></span>](#hit-testing)
-   [<span data-ttu-id="0db36-117">Обработка сообщений по умолчанию</span><span class="sxs-lookup"><span data-stu-id="0db36-117">Default Message Processing</span></span>](#default-message-processing)

## <a name="tooltip-behavior-and-appearance"></a><span data-ttu-id="0db36-118">Поведение и внешний вид всплывающей подсказки</span><span class="sxs-lookup"><span data-stu-id="0db36-118">Tooltip Behavior and Appearance</span></span>

<span data-ttu-id="0db36-119">Элементы управления ToolTip могут отображать одну строку текста или несколько строк.</span><span class="sxs-lookup"><span data-stu-id="0db36-119">Tooltip controls can display a single line of text or multiple lines.</span></span> <span data-ttu-id="0db36-120">Их углы можно округлить или квадратировать.</span><span class="sxs-lookup"><span data-stu-id="0db36-120">Their corners can be rounded or square.</span></span> <span data-ttu-id="0db36-121">Они могут или не иметь основу, которая указывает на такие средства, как мультипликационное всплывающее сообщение.</span><span class="sxs-lookup"><span data-stu-id="0db36-121">They might or might not have a stem that points to the tools like a cartoon speech balloon.</span></span> <span data-ttu-id="0db36-122">Текст подсказки может быть стационарным или может перемещаться с помощью указателя мыши, называемого отслеживанием.</span><span class="sxs-lookup"><span data-stu-id="0db36-122">Tooltip text can be stationary or can move with the mouse pointer, called tracking.</span></span> <span data-ttu-id="0db36-123">Стационарный текст может отображаться рядом с инструментом или отображаться в средстве, который называется «на месте».</span><span class="sxs-lookup"><span data-stu-id="0db36-123">Stationary text can be displayed adjacent to a tool or it can be displayed over a tool, which is referred to as in-place.</span></span> <span data-ttu-id="0db36-124">Стандартные подсказки являются стационарными, отображают одну строку текста, имеют квадратные углы и не имеют основной области, указывающей на средство.</span><span class="sxs-lookup"><span data-stu-id="0db36-124">Standard tooltips are stationary, display a single line of text, have square corners, and have no stem pointing to the tool.</span></span>

<span data-ttu-id="0db36-125">Отслеживание всплывающих подсказок, поддерживаемых стандартными элементами управления [версии 4,70](common-control-versions.md) , изменяет расположение на экране динамически.</span><span class="sxs-lookup"><span data-stu-id="0db36-125">Tracking tooltips, which are supported by [version 4.70](common-control-versions.md) of the common controls, change position on the screen dynamically.</span></span> <span data-ttu-id="0db36-126">При быстром обновлении положения эти элементы управления ToolTip перемещаются плавно, или «Track».</span><span class="sxs-lookup"><span data-stu-id="0db36-126">By rapidly updating the position, these tooltip controls appear to move smoothly, or "track."</span></span> <span data-ttu-id="0db36-127">Они полезны, если текст подсказки должен следовать за положением указателя мыши по мере его перемещения.</span><span class="sxs-lookup"><span data-stu-id="0db36-127">These are useful when you want tooltip text to follow the position of the mouse pointer as it moves.</span></span> <span data-ttu-id="0db36-128">Дополнительные сведения об отслеживании всплывающих подсказок и пример кода с описанием их создания см. в разделе [Отслеживание подсказок](using-tooltip-contro.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-128">For more information about tracking tooltips and an example with code that shows how you create them, see [Tracking Tooltips](using-tooltip-contro.md).</span></span>

<span data-ttu-id="0db36-129">Многострочные подсказки, которые также поддерживаются в версии 4,70 общих элементов управления, отображают текст на более чем одной строке.</span><span class="sxs-lookup"><span data-stu-id="0db36-129">Multiline tooltips, which are also supported by version 4.70 of the common controls, display text on more than one line.</span></span> <span data-ttu-id="0db36-130">Они полезны для отображения длинных сообщений.</span><span class="sxs-lookup"><span data-stu-id="0db36-130">These are useful for displaying lengthy messages.</span></span> <span data-ttu-id="0db36-131">Дополнительные сведения и пример, демонстрирующий создание многострочных подсказок, см. в разделе [многострочные подсказки](using-tooltip-contro.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-131">For more information and an example that shows how to create multiline tooltips, see [Multiline Tooltips](using-tooltip-contro.md).</span></span>

<span data-ttu-id="0db36-132">Всплывающие подсказки отображаются в поле со скругленными углами и с появлением инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-132">Balloon tooltips are displayed in a box with rounded corners and a stem pointing to the tool.</span></span> <span data-ttu-id="0db36-133">Они могут быть либо однострочными, либо многострочными.</span><span class="sxs-lookup"><span data-stu-id="0db36-133">They can be either single-line or multiline.</span></span> <span data-ttu-id="0db36-134">На следующем рисунке показана всплывающая подсказка с областью и прямоугольником в их позициях по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0db36-134">The following illustration shows a balloon tooltip with the stem and rectangle in their default positions.</span></span> <span data-ttu-id="0db36-135">Дополнительные сведения о всплывающих подсказках и примерах, демонстрирующих их создание, см. в разделе [Использование элементов управления ToolTip](using-tooltip-contro.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-135">For more information about balloon tooltips and an example that shows how to create them, see [Using Tooltip Controls](using-tooltip-contro.md).</span></span>

![снимок экрана, показывающий подсказку, содержащую одну строку текста, расположенную над кнопкой в диалоговом окне](images/tt-balloon.png)

<span data-ttu-id="0db36-137">Всплывающая подсказка также может содержать текст заголовка и значок, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="0db36-137">A tooltip can also have title text and an icon, as shown in the following illustration.</span></span> <span data-ttu-id="0db36-138">Обратите внимание, что подсказка должна содержать текст; Если он содержит только текст заголовка, подсказка не отображается.</span><span class="sxs-lookup"><span data-stu-id="0db36-138">Note that the tooltip must have text; if it has only title text, the tooltip does not display.</span></span> <span data-ttu-id="0db36-139">Кроме того, значок не отображается, если отсутствует заголовок.</span><span class="sxs-lookup"><span data-stu-id="0db36-139">Also the icon does not appear unless there is a title.</span></span>

![снимок экрана с подсказкой с значком, заголовком и текстом, расположенным под кнопкой в диалоговом окне](images/tt-titled.png)

<span data-ttu-id="0db36-141">Иногда текстовые строки обрезаются, так как они слишком длинны для полного отображения в маленьком окне.</span><span class="sxs-lookup"><span data-stu-id="0db36-141">Sometimes text strings are clipped because they are too long to be displayed completely in a small window.</span></span> <span data-ttu-id="0db36-142">Подсказки на месте используются для вывода текстовых строк для объектов, которые были обрезаны, например имя файла на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="0db36-142">In-place tooltips are used to display text strings for objects that have been clipped, such as the file name in the following illustration.</span></span> <span data-ttu-id="0db36-143">Пример, демонстрирующий создание подсказок на месте, см. [в разделе подсказки на месте](using-tooltip-contro.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-143">For an example that shows how to create in-place tooltips, see [In-Place Tooltips](using-tooltip-contro.md).</span></span>

![снимок экрана с подсказкой, содержащей имя файла, расположенное рядом со значком файла в элементе управления "дерево"](images/tt-inplace.png)

<span data-ttu-id="0db36-145">Курсор должен навести указатель мыши на инструмент в течение определенного периода времени до отображения подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-145">The cursor must hover over a tool for a period of time before the tooltip is displayed.</span></span> <span data-ttu-id="0db36-146">По умолчанию длительность этого времени ожидания регулируется временем двойного щелчка пользователя и обычно составляет примерно одну половину секунды.</span><span class="sxs-lookup"><span data-stu-id="0db36-146">The default duration of this timeout is controlled by the user's double click time and is typically about one-half second.</span></span> <span data-ttu-id="0db36-147">Чтобы указать значение времени ожидания, отличное от значения по умолчанию, отправьте сообщение [**ТТМ \_ сетделайтиме**](ttm-setdelaytime.md) в элемент управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-147">To specify a non-default timeout value, send the tooltip control a [**TTM\_SETDELAYTIME**](ttm-setdelaytime.md) message.</span></span>

## <a name="creating-tooltip-controls"></a><span data-ttu-id="0db36-148">Создание элементов управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="0db36-148">Creating Tooltip Controls</span></span>

<span data-ttu-id="0db36-149">Чтобы создать элемент управления ToolTip, вызовите [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) и укажите класс окна [**\_ класса ToolTips**](common-control-window-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-149">To create a tooltip control, call [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) and specify the [**TOOLTIPS\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="0db36-150">Этот класс регистрируется при загрузке библиотеки DLL общих элементов управления.</span><span class="sxs-lookup"><span data-stu-id="0db36-150">This class is registered when the common control DLL is loaded.</span></span> <span data-ttu-id="0db36-151">Чтобы убедиться, что библиотека DLL загружена, включите в приложение функцию [**InitCommonControlsEx**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex) .</span><span class="sxs-lookup"><span data-stu-id="0db36-151">To ensure that this DLL is loaded, include the [**InitCommonControlsEx**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex) function in your application.</span></span> <span data-ttu-id="0db36-152">Необходимо явно определить элемент управления ToolTip как верхний.</span><span class="sxs-lookup"><span data-stu-id="0db36-152">You must explicitly define a tooltip control as topmost.</span></span> <span data-ttu-id="0db36-153">В противном случае оно может быть охвачено родительским окном.</span><span class="sxs-lookup"><span data-stu-id="0db36-153">Otherwise, it might be covered by the parent window.</span></span> <span data-ttu-id="0db36-154">В следующем фрагменте кода показано, как создать элемент управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-154">The following code fragment shows how to create a tooltip control.</span></span>


```
HWND hwndTip = CreateWindowEx(NULL, TOOLTIPS_CLASS, NULL,
                            WS_POPUP | TTS_NOPREFIX | TTS_ALWAYSTIP,
                            CW_USEDEFAULT, CW_USEDEFAULT,
                            CW_USEDEFAULT, CW_USEDEFAULT,
                            hwndParent, NULL, hinstMyDll,
                            NULL);

SetWindowPos(hwndTip, HWND_TOPMOST,0, 0, 0, 0,
             SWP_NOMOVE | SWP_NOSIZE | SWP_NOACTIVATE);
```



<span data-ttu-id="0db36-155">Процедура окна для элемента управления ToolTip автоматически задает размер, расположение и видимость элемента управления.</span><span class="sxs-lookup"><span data-stu-id="0db36-155">The window procedure for the tooltip control automatically sets the size, position, and visibility of the control.</span></span> <span data-ttu-id="0db36-156">Высота окна подсказки зависит от высоты шрифта, выбранного в данный момент в контексте устройства для элемента управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-156">The height of the tooltip window is based on the height of the font currently selected into the device context for the tooltip control.</span></span> <span data-ttu-id="0db36-157">Ширина варьируется в зависимости от длины строки, находящегося в окне подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-157">The width varies based on the length of the string currently in the tooltip window.</span></span>

## <a name="activating-tooltip-controls"></a><span data-ttu-id="0db36-158">Активация элементов управления ToolTip</span><span class="sxs-lookup"><span data-stu-id="0db36-158">Activating Tooltip Controls</span></span>

<span data-ttu-id="0db36-159">Элемент управления ToolTip может быть либо активным, либо неактивным.</span><span class="sxs-lookup"><span data-stu-id="0db36-159">A tooltip control can be either active or inactive.</span></span> <span data-ttu-id="0db36-160">Если указатель мыши находится на инструменте, отображается текст подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-160">When it is active, the tooltip text appears when the mouse pointer is on a tool.</span></span> <span data-ttu-id="0db36-161">Если он неактивен, текст подсказки не отображается, даже если указатель находится на инструменте.</span><span class="sxs-lookup"><span data-stu-id="0db36-161">When it is inactive, the tooltip text does not appear, even if the pointer is on a tool.</span></span> <span data-ttu-id="0db36-162">Сообщение [**\_ активации ТТМ**](ttm-activate.md) активирует и деактивирует элемент управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-162">The [**TTM\_ACTIVATE**](ttm-activate.md) message activates and deactivates a tooltip control.</span></span>

## <a name="supporting-tools"></a><span data-ttu-id="0db36-163">Вспомогательные средства</span><span class="sxs-lookup"><span data-stu-id="0db36-163">Supporting Tools</span></span>

<span data-ttu-id="0db36-164">Элемент управления ToolTip может поддерживать любое количество инструментов.</span><span class="sxs-lookup"><span data-stu-id="0db36-164">A tooltip control can support any number of tools.</span></span> <span data-ttu-id="0db36-165">Для поддержки конкретного средства необходимо зарегистрировать средство с помощью элемента управления ToolTip, отправив управление сообщением [**ТТМ \_ аддтул**](ttm-addtool.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-165">To support a particular tool, you must register the tool with the tooltip control by sending the control the [**TTM\_ADDTOOL**](ttm-addtool.md) message.</span></span> <span data-ttu-id="0db36-166">Сообщение включает адрес структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) , которая предоставляет сведения, необходимые элементу управления ToolTip для показа текста для инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-166">The message includes the address of a [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure, which provides information the tooltip control needs to display text for the tool.</span></span> <span data-ttu-id="0db36-167">Элемент **UID** структуры **тулинфо** определяется приложением.</span><span class="sxs-lookup"><span data-stu-id="0db36-167">The **uID** member of the **TOOLINFO** structure is defined by the application.</span></span> <span data-ttu-id="0db36-168">Каждый раз при добавлении средства приложение предоставляет уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="0db36-168">Each time you add a tool, your application provides a unique identifier.</span></span> <span data-ttu-id="0db36-169">Элемент **кбсизе** структуры **тулинфо** является обязательным и должен указывать размер структуры.</span><span class="sxs-lookup"><span data-stu-id="0db36-169">The **cbSize** member of the **TOOLINFO** structure is required, and must specify the size of the structure.</span></span>

<span data-ttu-id="0db36-170">Элемент управления ToolTip поддерживает средства, реализованные как окна (например, дочерние окна или окна элементов управления) и как прямоугольные области в клиентской области окна.</span><span class="sxs-lookup"><span data-stu-id="0db36-170">A tooltip control supports tools implemented as windows (such as child windows or control windows) and as rectangular areas within a window's client area.</span></span> <span data-ttu-id="0db36-171">При добавлении средства, реализованного в виде прямоугольной области, элемент **HWND** структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) должен задавать дескриптор для окна, содержащего область, а элемент **Rect** должен указывать клиентские координаты ограничивающего прямоугольника области.</span><span class="sxs-lookup"><span data-stu-id="0db36-171">When you add a tool implemented as a rectangular area, the **hwnd** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure must specify the handle to the window that contains the area, and the **rect** member must specify the client coordinates of the area's bounding rectangle.</span></span> <span data-ttu-id="0db36-172">Кроме того, член **UID** должен указывать определяемый приложением идентификатор для инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-172">In addition, the **uID** member must specify the application-defined identifier for the tool.</span></span>

<span data-ttu-id="0db36-173">При добавлении средства, реализованного в виде окна, элемент **UID** структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) должен содержать описатель окна для средства.</span><span class="sxs-lookup"><span data-stu-id="0db36-173">When you add a tool implemented as a window, the **uID** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure must contain the window handle to the tool.</span></span> <span data-ttu-id="0db36-174">Кроме того, элемент **уфлагс** должен задавать значение **TTF \_ идишвнд** , которое сообщает элементу управления ToolTip, что элемент **UID** интерпретируется как описатель окна.</span><span class="sxs-lookup"><span data-stu-id="0db36-174">Also, the **uFlags** member must specify the **TTF\_IDISHWND** value, which tells the tooltip control to interpret the **uID** member as a window handle.</span></span>

## <a name="displaying-text"></a><span data-ttu-id="0db36-175">Отображение текста</span><span class="sxs-lookup"><span data-stu-id="0db36-175">Displaying Text</span></span>

<span data-ttu-id="0db36-176">При добавлении инструмента в элемент управления ToolTip элемент **лпсзтекст** структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) должен указывать адрес строки, которая будет отображаться для средства.</span><span class="sxs-lookup"><span data-stu-id="0db36-176">When you add a tool to a tooltip control, the **lpszText** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure must specify the address of the string to display for the tool.</span></span> <span data-ttu-id="0db36-177">После добавления средства можно изменить текст с помощью сообщения [**ТТМ \_ упдатетиптекст**](ttm-updatetiptext.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-177">After you add a tool, you can change the text using the [**TTM\_UPDATETIPTEXT**](ttm-updatetiptext.md) message.</span></span>

<span data-ttu-id="0db36-178">Если слово **лпсзтекст** с высоким приоритетом имеет нулевое значение, то слово низкого порядка должно быть идентификатором строкового ресурса.</span><span class="sxs-lookup"><span data-stu-id="0db36-178">If the high-order word of **lpszText** is zero, the low-order word must be the identifier of a string resource.</span></span> <span data-ttu-id="0db36-179">Когда элементу управления ToolTip требуется текст, система загружает указанный строковый ресурс из экземпляра приложения, идентифицируемого элементом **хинст** структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) .</span><span class="sxs-lookup"><span data-stu-id="0db36-179">When the tooltip control needs the text, the system loads the specified string resource from the application instance identified by the **hinst** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.</span></span>

<span data-ttu-id="0db36-180">Если указать \_ значение LPSTR тексткаллбакк в элементе **лпсзтекст** , элемент управления ToolTip уведомляет окно, указанное в элементе **HWND** структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa), каждый раз, когда элементу управления ToolTip требуется отображать текст для средства.</span><span class="sxs-lookup"><span data-stu-id="0db36-180">If you specify the LPSTR\_TEXTCALLBACK value in the **lpszText** member, the tooltip control notifies the window specified in the **hwnd** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)structure whenever the tooltip control needs to display text for the tool.</span></span> <span data-ttu-id="0db36-181">Элемент управления ToolTip отправляет в окно код уведомления [ТТН \_ жетдиспинфо](ttn-getdispinfo.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-181">The tooltip control sends the [TTN\_GETDISPINFO](ttn-getdispinfo.md) notification code to the window.</span></span> <span data-ttu-id="0db36-182">Сообщение включает адрес структуры [**нмттдиспинфо**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) , которая содержит маркер окна, а также определяемый приложением идентификатор для инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-182">The message includes the address of a [**NMTTDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) structure, which contains the window handle as well as the application-defined identifier for the tool.</span></span> <span data-ttu-id="0db36-183">Окно анализирует структуру, чтобы определить средство, для которого требуется текст, и заполняет соответствующие элементы структуры данными, которые требуются для вывода строки элементом управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-183">The window examines the structure to determine the tool for which text is needed, and it fills the appropriate structure members with information that the tooltip control needs in order to display the string.</span></span>

> [!Note]  
> <span data-ttu-id="0db36-184">Максимальная длина стандартного текста всплывающей подсказки — 80 символов.</span><span class="sxs-lookup"><span data-stu-id="0db36-184">The maximum length for standard tooltip text is 80 characters.</span></span> <span data-ttu-id="0db36-185">Дополнительные сведения см. в разделе Структура [**нмттдиспинфо**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) .</span><span class="sxs-lookup"><span data-stu-id="0db36-185">For more information, see the [**NMTTDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) structure.</span></span> <span data-ttu-id="0db36-186">Текст многострочной подсказки может быть больше.</span><span class="sxs-lookup"><span data-stu-id="0db36-186">Multiline tooltip text can be longer.</span></span>

 

<span data-ttu-id="0db36-187">Многие приложения создают панели инструментов, содержащие средства, соответствующие командам меню.</span><span class="sxs-lookup"><span data-stu-id="0db36-187">Many applications create toolbars containing tools that correspond to menu commands.</span></span> <span data-ttu-id="0db36-188">Для таких инструментов удобно, чтобы элемент управления ToolTip отображал тот же текст, что и соответствующий пункт меню.</span><span class="sxs-lookup"><span data-stu-id="0db36-188">For such tools, it is convenient for the tooltip control to display the same text as the corresponding menu item.</span></span> <span data-ttu-id="0db36-189">Система автоматически отделяет символы ускорителя (&) от всех строк, передаваемых в элемент управления ToolTip, и завершает строку на первом символе табуляции ( \\ t), если только элемент управления не имеет стиля [**TTS без \_ префикса**](tooltip-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-189">The system automatically strips the ampersand (&) accelerator characters from all strings passed to a tooltip control, and terminates the string at the first tab character (\\t), unless the control has the [**TTS\_NOPREFIX**](tooltip-styles.md) style.</span></span>

<span data-ttu-id="0db36-190">Чтобы получить текст для средства, используйте сообщение [**ТТМ \_ gettext**](ttm-gettext.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-190">To retrieve the text for a tool, use the [**TTM\_GETTEXT**](ttm-gettext.md) message.</span></span>

## <a name="messaging-and-notification"></a><span data-ttu-id="0db36-191">Обмен сообщениями и уведомление</span><span class="sxs-lookup"><span data-stu-id="0db36-191">Messaging and Notification</span></span>

<span data-ttu-id="0db36-192">Текст подсказки обычно отображается при наведении указателя мыши на область (обычно это прямоугольник, определенный средством, например элементом управления "Кнопка").</span><span class="sxs-lookup"><span data-stu-id="0db36-192">Tooltip text is normally displayed when the mouse pointer hovers over an area, typically the rectangle defined by a tool such as a button control.</span></span> <span data-ttu-id="0db36-193">Однако Microsoft Windows отправляет только сообщения, связанные с мышью, в окно, содержащее указатель, а не сам элемент управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-193">However, Microsoft Windows only sends mouse-related messages to the window that contains the pointer, not the tooltip control itself.</span></span> <span data-ttu-id="0db36-194">Информация, связанная с мышью, должна быть передаваться в элемент управления ToolTip для того, чтобы отображать текст подсказки в соответствующее время и место.</span><span class="sxs-lookup"><span data-stu-id="0db36-194">Mouse-related information must be relayed to the tooltip control in order for it to display the tooltip text at the appropriate time and place.</span></span>

<span data-ttu-id="0db36-195">Сообщения можно ретранслировать автоматически, если:</span><span class="sxs-lookup"><span data-stu-id="0db36-195">You can have messages relayed automatically if:</span></span>

-   <span data-ttu-id="0db36-196">Инструмент является элементом управления или определяется как прямоугольник в структуре [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) средства.</span><span class="sxs-lookup"><span data-stu-id="0db36-196">The tool is a control or is defined as a rectangle in the tool's [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.</span></span>
-   <span data-ttu-id="0db36-197">Окно, связанное с инструментом, находится в том же потоке, что и элемент управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-197">The window associated with the tool is in the same thread as the tooltip control.</span></span>

<span data-ttu-id="0db36-198">Если эти два условия выполнены, установите флаг **\_ подкласса TTF** в **уфлагс** элемента структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) при добавлении средства в элемент управления ToolTip с [**ТТМ \_ аддтул**](ttm-addtool.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-198">If these two conditions are met, set the **TTF\_SUBCLASS** flag in the **uFlags** member of the tool's [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure when you add the tool to the tooltip control with [**TTM\_ADDTOOL**](ttm-addtool.md).</span></span> <span data-ttu-id="0db36-199">Необходимые сообщения мыши затем автоматически передаются элементу управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-199">The necessary mouse messages then will be relayed automatically to the tooltip control.</span></span>

<span data-ttu-id="0db36-200">Настройка **\_ подкласса TTF** для передвижения сообщений мыши в элемент управления достаточно для большинства целей.</span><span class="sxs-lookup"><span data-stu-id="0db36-200">Setting **TTF\_SUBCLASS** to have mouse messages relayed to the control is sufficient for most purposes.</span></span> <span data-ttu-id="0db36-201">Однако он не будет работать в тех случаях, когда между элементом управления ToolTip и окном средства нет прямого соединения.</span><span class="sxs-lookup"><span data-stu-id="0db36-201">However, it will not work in cases where there is no direct connection between the tooltip control and the tool's window.</span></span> <span data-ttu-id="0db36-202">Например, если средство реализуется в виде прямоугольной области в окне, определяемом приложением, то процедура окна получает сообщения мыши.</span><span class="sxs-lookup"><span data-stu-id="0db36-202">For example, if a tool is implemented as a rectangular area in an application-defined window, the window procedure receives the mouse messages.</span></span> <span data-ttu-id="0db36-203">Настройка **\_ подкласса TTF** достаточна для того, чтобы убедиться, что они передаются элементу управления.</span><span class="sxs-lookup"><span data-stu-id="0db36-203">Setting **TTF\_SUBCLASS** is sufficient to ensure that they are passed to the control.</span></span> <span data-ttu-id="0db36-204">Однако если средство реализовано как системное окно, сообщения мыши отправляются в это окно и не доступны для приложения напрямую.</span><span class="sxs-lookup"><span data-stu-id="0db36-204">However, if a tool is implemented as a system-defined window, mouse messages are sent to that window and are not directly available to the application.</span></span> <span data-ttu-id="0db36-205">В этом случае необходимо либо подделать окно подклассом, либо использовать обработчик сообщений для доступа к сообщениям мыши.</span><span class="sxs-lookup"><span data-stu-id="0db36-205">In this case, you must either subclass the window or use a message hook to access the mouse messages.</span></span> <span data-ttu-id="0db36-206">Затем необходимо явно пересылать сообщения мыши в элемент управления ToolTip с помощью [**ТТМ \_ релайевент**](ttm-relayevent.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-206">You must then explicitly relay mouse messages to the tooltip control with [**TTM\_RELAYEVENT**](ttm-relayevent.md).</span></span> <span data-ttu-id="0db36-207">Пример использования **ТТМ \_ релайевент** см. в разделе [Отслеживание подсказок](using-tooltip-contro.md).</span><span class="sxs-lookup"><span data-stu-id="0db36-207">For an example of how to use **TTM\_RELAYEVENT**, see [Tracking Tooltips](using-tooltip-contro.md).</span></span>

<span data-ttu-id="0db36-208">Когда элемент управления ToolTip получает сообщение [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) , он определяет, находится ли указатель мыши в ограничивающем прямоугольнике инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-208">When a tooltip control receives a [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) message, it determines whether the mouse pointer is in the bounding rectangle of a tool.</span></span> <span data-ttu-id="0db36-209">Если это так, элемент управления ToolTip устанавливает таймер.</span><span class="sxs-lookup"><span data-stu-id="0db36-209">If it is, the tooltip control sets a timer.</span></span> <span data-ttu-id="0db36-210">По окончании интервала времени ожидания элемент управления ToolTip проверяет расположение указателя, чтобы увидеть, перемещен ли он.</span><span class="sxs-lookup"><span data-stu-id="0db36-210">At the end of the time-out interval, the tooltip control checks the position of the pointer to see if it has moved.</span></span> <span data-ttu-id="0db36-211">В противном случае элемент управления ToolTip извлекает текст для инструмента и отображает подсказку.</span><span class="sxs-lookup"><span data-stu-id="0db36-211">If it hasn't, the tooltip control retrieves the text for the tool and displays the tooltip.</span></span> <span data-ttu-id="0db36-212">Элемент управления ToolTip сохраняет окно до тех пор, пока оно не получит сообщение кнопки ретрансляции или кнопки или пока сообщение **WM \_ MOUSEMOVE** не покажет, что указатель переместился за пределы ограничивающего прямоугольника инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-212">The tooltip control continues to show the window until it receives a relayed button-up or button-down message or until a **WM\_MOUSEMOVE** message indicates that the pointer has moved outside the bounding rectangle of the tool.</span></span>

<span data-ttu-id="0db36-213">С элементом управления ToolTip фактически связано три длительности времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="0db36-213">A tooltip control actually has three time-out durations associated with it.</span></span> <span data-ttu-id="0db36-214">Начальная длительность — это время, в течение которого указатель мыши должен оставаться в пределах ограничивающего прямоугольника инструмента перед отображением окна подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-214">The initial duration is the time that the mouse pointer must remain stationary within the bounding rectangle of a tool before the tooltip window is displayed.</span></span> <span data-ttu-id="0db36-215">Длительность повторного отображения — это длина задержки до отображения последующих окон всплывающей подсказки при переходе указателя с одного инструмента на другое.</span><span class="sxs-lookup"><span data-stu-id="0db36-215">The reshow duration is the length of the delay before subsequent tooltip windows are displayed when the pointer moves from one tool to another.</span></span> <span data-ttu-id="0db36-216">Длительность всплывающего окна — это время, когда окно подсказки остается видимым, прежде чем оно будет скрыто.</span><span class="sxs-lookup"><span data-stu-id="0db36-216">The pop-up duration is the time that the tooltip window remains displayed before it is hidden.</span></span> <span data-ttu-id="0db36-217">То есть, если указатель остается неподвижным в ограничивающем прямоугольнике после отображения всплывающей подсказки, окно подсказки автоматически скрывается в конце интервала всплывающего окна.</span><span class="sxs-lookup"><span data-stu-id="0db36-217">That is, if the pointer remains stationary within the bounding rectangle after the tooltip window is displayed, the tooltip window is automatically hidden at the end of the pop-up duration.</span></span> <span data-ttu-id="0db36-218">Все интервалы времени ожидания можно настроить с помощью сообщения [**ТТМ \_ сетделайтиме**](ttm-setdelaytime.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-218">You can adjust all of the time-out durations by using the [**TTM\_SETDELAYTIME**](ttm-setdelaytime.md) message.</span></span>

<span data-ttu-id="0db36-219">Если приложение включает средство, реализованное в виде прямоугольной области, и размер или расположение элемента управления изменяется, приложение может использовать сообщение [**ТТМ \_ невтулрект**](ttm-newtoolrect.md) для сообщения об изменении элемента управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-219">If an application includes a tool implemented as a rectangular area and the size or position of the control changes, the application can use the [**TTM\_NEWTOOLRECT**](ttm-newtoolrect.md) message to report the change to the tooltip control.</span></span> <span data-ttu-id="0db36-220">Приложению не требуется сообщать об изменениях размера и позиции для инструмента, реализованного в виде окна, поскольку элемент управления ToolTip использует маркер окна средства, чтобы определить, находится ли указатель мыши на инструменте, а не на ограничивающем прямоугольнике инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-220">An application does not need to report size and position changes for a tool implemented as a window because the tooltip control uses the tool's window handle to determine if the mouse pointer is on the tool, not the tool's bounding rectangle.</span></span>

<span data-ttu-id="0db36-221">Когда подсказка будет отображаться, элемент управления ToolTip посылает окну-владельцу [ТТН \_ Показать](ttn-show.md) код уведомления.</span><span class="sxs-lookup"><span data-stu-id="0db36-221">When a tooltip is about to be displayed, the tooltip control sends the owner window a [TTN\_SHOW](ttn-show.md) notification code.</span></span> <span data-ttu-id="0db36-222">Окно-владелец получает код [уведомления \_ POP ТТН](ttn-pop.md) , когда подсказка будет скрыта.</span><span class="sxs-lookup"><span data-stu-id="0db36-222">The owner window receives a [TTN\_POP](ttn-pop.md) notification code when a tooltip is about to be hidden.</span></span> <span data-ttu-id="0db36-223">Каждый код уведомления отправляется в контексте сообщения [**WM \_ Notify**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="0db36-223">Each notification code is sent in the context of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span>

## <a name="hit-testing"></a><span data-ttu-id="0db36-224">Проверка нажатия</span><span class="sxs-lookup"><span data-stu-id="0db36-224">Hit Testing</span></span>

<span data-ttu-id="0db36-225">Сообщение [**ТТМ \_ HITTEST**](ttm-hittest.md) позволяет извлекать сведения, которые поддерживает элемент управления ToolTip, о средстве, которое занимает определенную точку.</span><span class="sxs-lookup"><span data-stu-id="0db36-225">The [**TTM\_HITTEST**](ttm-hittest.md) message allows you to retrieve information that a tooltip control maintains about the tool occupying a particular point.</span></span> <span data-ttu-id="0db36-226">Сообщение содержит структуру [**тситтестинфо**](/windows/win32/api/commctrl/ns-commctrl-tthittestinfoa) , содержащую маркер окна, координаты точки и адрес структуры [**тулинфо**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) .</span><span class="sxs-lookup"><span data-stu-id="0db36-226">The message includes a [**TTHITTESTINFO**](/windows/win32/api/commctrl/ns-commctrl-tthittestinfoa) structure that contains a window handle, the coordinates of a point, and the address of a [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.</span></span> <span data-ttu-id="0db36-227">Элемент управления ToolTip определяет, занимает ли инструмент точка, и, если это так, заполняет **тулинфо** информацией о средстве.</span><span class="sxs-lookup"><span data-stu-id="0db36-227">The tooltip control determines whether a tool occupies the point and, if it does, fills **TOOLINFO** with information about the tool.</span></span>

## <a name="default-message-processing"></a><span data-ttu-id="0db36-228">Обработка сообщений по умолчанию</span><span class="sxs-lookup"><span data-stu-id="0db36-228">Default Message Processing</span></span>

<span data-ttu-id="0db36-229">В следующей таблице описаны сообщения, обрабатываемые процедурой окна для элемента управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-229">The following table describes the messages handled by the window procedure for the tooltip control.</span></span>



| <span data-ttu-id="0db36-230">Сообщение</span><span class="sxs-lookup"><span data-stu-id="0db36-230">Message</span></span>                                        | <span data-ttu-id="0db36-231">Описание</span><span class="sxs-lookup"><span data-stu-id="0db36-231">Description</span></span>                                                                                                                                                                                                                                                       |
|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="0db36-232">**\_Создание WM**</span><span class="sxs-lookup"><span data-stu-id="0db36-232">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)             | <span data-ttu-id="0db36-233">Гарантирует, что элемент управления ToolTip содержит стили окна "панели [**\_ \_ инструментов WS**](/windows/desktop/winmsg/window-styles) " и [**\_ "ws"**](/windows/desktop/winmsg/window-styles) .</span><span class="sxs-lookup"><span data-stu-id="0db36-233">Ensures that the tooltip control has the [**WS\_EX\_TOOLWINDOW**](/windows/desktop/winmsg/window-styles) and [**WS\_POPUP**](/windows/desktop/winmsg/window-styles) window styles.</span></span> <span data-ttu-id="0db36-234">Он также выделяет память и инициализирует внутренние переменные.</span><span class="sxs-lookup"><span data-stu-id="0db36-234">It also allocates memory and initializes internal variables.</span></span> |
| [<span data-ttu-id="0db36-235">**WM \_ destroy**</span><span class="sxs-lookup"><span data-stu-id="0db36-235">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)           | <span data-ttu-id="0db36-236">Освобождает ресурсы, выделенные для элемента управления ToolTip.</span><span class="sxs-lookup"><span data-stu-id="0db36-236">Frees resources allocated for the tooltip control.</span></span>                                                                                                                                                                                                                |
| [<span data-ttu-id="0db36-237">**WM, \_ Шрифт**</span><span class="sxs-lookup"><span data-stu-id="0db36-237">**WM\_GETFONT**</span></span>](/windows/desktop/winmsg/wm-getfont)           | <span data-ttu-id="0db36-238">Возвращает маркер шрифта, который будет использоваться элементом управления ToolTip для рисования текста.</span><span class="sxs-lookup"><span data-stu-id="0db36-238">Returns the handle of the font that the tooltip control will use to draw text.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="0db36-239">**WM \_ MOUSEMOVE**</span><span class="sxs-lookup"><span data-stu-id="0db36-239">**WM\_MOUSEMOVE**</span></span>](/windows/desktop/inputdev/wm-mousemove)     | <span data-ttu-id="0db36-240">Скрывает окно подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-240">Hides the tooltip window.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="0db36-241">**WM \_ Paint**</span><span class="sxs-lookup"><span data-stu-id="0db36-241">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                  | <span data-ttu-id="0db36-242">Рисует окно подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-242">Draws the tooltip window.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="0db36-243">**WM \_ сетфонт**</span><span class="sxs-lookup"><span data-stu-id="0db36-243">**WM\_SETFONT**</span></span>](/windows/desktop/winmsg/wm-setfont)           | <span data-ttu-id="0db36-244">Задает маркер шрифта, который будет использоваться элементом управления ToolTip для рисования текста.</span><span class="sxs-lookup"><span data-stu-id="0db36-244">Sets the handle of the font that the tooltip control will use to draw text.</span></span>                                                                                                                                                                                       |
| [<span data-ttu-id="0db36-245">**\_таймер WM**</span><span class="sxs-lookup"><span data-stu-id="0db36-245">**WM\_TIMER**</span></span>](/windows/desktop/winmsg/wm-timer)               | <span data-ttu-id="0db36-246">Скрывает окно подсказки, если оно изменилось или если указатель мыши переместился за пределы инструмента.</span><span class="sxs-lookup"><span data-stu-id="0db36-246">Hides the tooltip window if the tool has changed position or if the mouse pointer has moved outside the tool.</span></span> <span data-ttu-id="0db36-247">В противном случае отображается окно подсказки.</span><span class="sxs-lookup"><span data-stu-id="0db36-247">Otherwise, it shows the tooltip window.</span></span>                                                                                                             |
| [<span data-ttu-id="0db36-248">**WM \_ вининичанже**</span><span class="sxs-lookup"><span data-stu-id="0db36-248">**WM\_WININICHANGE**</span></span>](/windows/desktop/winmsg/wm-wininichange) | <span data-ttu-id="0db36-249">Сбрасывает внутренние переменные, основанные на системных метриках.</span><span class="sxs-lookup"><span data-stu-id="0db36-249">Resets internal variables that are based on system metrics.</span></span>                                                                                                                                                                                                       |



 

 

 