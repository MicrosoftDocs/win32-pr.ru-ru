---
title: Строки состояния (элементы управления Windows)
description: Строка состояния — это горизонтальное окно в нижней части родительского окна, в котором приложение может отображать различные типы сведений о состоянии.
ms.assetid: vs|controls|~\controls\status\status.htm
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3c2d1130b25cf0dc6373021e063210b765aa34a5
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "105654405"
---
# <a name="status-bars-windows-controls"></a>Строки состояния (элементы управления Windows)

*Строка состояния* — это горизонтальное окно в нижней части родительского окна, в котором приложение может отображать различные типы сведений о состоянии. Строку состояния можно разделить на части, чтобы отобразить более одного типа информации. На следующем снимке экрана показана строка состояния в приложении Microsoft Windows Paint. В этом случае строка состояния содержит текст "для справки выберите пункт" разделы справки "в меню" Справка ". Строка состояния — это область в нижней части окна, содержащая текст справки и сведения о координатах.

![снимок экрана приложения Paint со строкой состояния, содержащей подсказки о справке в Интернете](images/sb-paint.png)

Этот раздел содержит следующие темы.

-   [Типы и стили](#types-and-styles)
-   [Размер и высота](#size-and-height)
-   [Строки состояния с несколькими частями](#multiple-part-status-bars)
-   [Операции с текстом строки состояния](#status-bar-text-operations)
-   [Строки состояния, рисуемые владельцем](#owner-drawn-status-bars)
-   [Строки состояния в простом режиме](#simple-mode-status-bars)
-   [Обработка сообщений в строке состояния по умолчанию](#default-status-bar-message-processing)

## <a name="types-and-styles"></a>Типы и стили

По умолчанию строка состояния находится в нижней части родительского окна, но для ее отображения в верхней части клиентской области родительского окна можно указать стиль в [**\_ верхнем стиле CCS**](common-control-styles.md) .

Можно указать стиль [**сбарс \_ сизегрип**](status-bar-styles.md) , чтобы включить захват изменения размера в правый конец строки состояния.

> [!Note]  
> Не рекомендуется объединять стили [**CCS \_ Top**](common-control-styles.md) и [**сбарс \_ сизегрип**](status-bar-styles.md) , так как полученный захват изменения размера не работает.

 

## <a name="size-and-height"></a>Размер и высота

Процедура окна для строки состояния автоматически задает начальный размер и расположение окна, игнорируя значения, указанные в функции [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) . Ширина совпадает с шириной клиентской области родительского окна. Высота зависит от метрик шрифта, выбранного в настоящий момент в контексте устройства в строке состояния, и от ширины границ окна.

Процедура окна автоматически корректирует размер строки состояния каждый раз, когда она получает сообщение о [**\_ размере WM**](/windows/desktop/winmsg/wm-size) . Как правило, при изменении размера родительского окна родительский элемент отправляет сообщение о **\_ размере WM** в строку состояния.

Приложение может установить минимальную высоту области рисования в строке состояния, отправив окну сообщение [**SB \_ сетминхеигхт**](sb-setminheight.md) , указав минимальную высоту (в пикселях). Область рисования не включает границы окна. Минимальная высота полезна для рисования в строке состояния, рисуемой владельцем. Дополнительные сведения см. в разделе [строки состояния, рисуемые владельцем](#owner-drawn-status-bars) далее в этой главе.

Чтобы получить ширину границ строки состояния, отправьте окно с сообщением [**SB \_**](sb-getborders.md) . Сообщение включает адрес массива из трех элементов, который получает ширину.

## <a name="multiple-part-status-bars"></a>Строки состояния Multiple-Part

Строка состояния может содержать множество различных частей, каждая из которых отображает отдельную строку текста. Строку состояния можно разделить на части, отправив окно с сообщением [**SB \_ сетпартс**](sb-setparts.md) , указав количество создаваемых частей и адрес целочисленного массива. Массив содержит по одному элементу для каждой части, и каждый элемент Указывает координату клиента правого края части.

Строка состояния может содержать не более 256 частей, хотя приложения обычно используют гораздо меньше. Вы получаете число частей в строке состояния, а также координату правого края каждой из частей, отправляя окно сообщения [**SB \_**](sb-getparts.md) .

## <a name="status-bar-text-operations"></a>Операции с текстом строки состояния

Можно задать текст любой части строки состояния, отправив сообщение [**SB \_ SETTEXT**](sb-settext.md) , указав Отсчитываемый от нуля индекс части, адрес строки для рисования в части, а также метод рисования строки. Метод рисования определяет, имеет ли текст границы и стиль границы. Он также определяет, отвечает ли родительское окно для рисования текста. Дополнительные сведения см. в разделе [строки состояния, рисуемые владельцем](#owner-drawn-status-bars) ниже.

По умолчанию текст выдается по левому краю в пределах указанной части строки состояния. В тексте можно внедрять символы табуляции ( \\ t), чтобы выровнять их по центру или по правому краю. Текст справа от одного символа табуляции выравнивается по центру, а текст справа от второго символа табуляции выравнивается по правому краю.

Чтобы получить текст из строки состояния, используйте сообщения [**SB \_ Жеттекстленгс**](sb-gettextlength.md) и [**SB \_ gettext**](sb-gettext.md) .

Если приложение использует строку состояния, которая содержит только одну часть, можно использовать сообщения [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext), [**WM \_ gettext**](/windows/desktop/winmsg/wm-gettext)и [**WM \_ жеттекстленгс**](/windows/desktop/winmsg/wm-gettextlength) для выполнения текстовых операций. Эти сообщения относятся только к части с нулевым индексом, что позволяет обрабатывать строку состояния так же, как и статический элемент управления Text.

Чтобы отобразить строку состояния без создания строки состояния, используйте функцию [**дравстатустекст**](/windows/desktop/api/Commctrl/nf-commctrl-drawstatustexta) . Функция использует те же методы для отображения состояния в качестве процедуры окна для строки состояния, но не задает автоматически размер и расположение сведений о состоянии. При вызове функции необходимо указать размер и расположение сведений о состоянии, а также контекст устройства, в котором будет нарисовано окно.

## <a name="owner-drawn-status-bars"></a>Строки состояния Owner-Drawn

Отдельные части строки состояния можно определить как фрагменты, рисуемые владельцем. Использование этой методики обеспечивает больше возможностей управления, чем в противном случае. Например, можно отобразить точечный рисунок, а не текст или нарисовать текст, используя другой шрифт.

Чтобы определить часть окна как рисуемую владельцем, отправьте сообщение [**SB \_ SETTEXT**](sb-settext.md) в строку состояния, указав часть и \_ метод рисования SBT овнердрав. Если \_ указан SBT овнердрав, параметр *lParam* является значением, заданным в приложении 32 бит, которое приложение может использовать при рисовании части. Например, можно указать маркер шрифта, маркер точечного рисунка, адрес строки и т. д.

Когда строка состояния должна нарисовать рисуемую владельцем часть, она отправляет сообщение [**WM \_ DRAWITEM**](wm-drawitem.md) в родительское окно. Параметр *wParam* сообщения является идентификатором дочернего окна строки состояния, а параметр *lParam* — адресом структуры [**дравитемструкт**](/windows/win32/api/winuser/ns-winuser-drawitemstruct) . Родительское окно использует сведения в структуре для отрисовки части. Для рисуемой владельцем части строки состояния **дравитемструкт** содержит следующие сведения.



| Член         | Описание                                                                                                            |
|----------------|------------------------------------------------------------------------------------------------------------------------|
| **ктлтипе**    | Определено не используйте.                                                                                                 |
| **ктлид**      | Идентификатор дочернего окна строки состояния.                                                                             |
| **itemID**     | Отсчитываемый от нуля индекс части для рисования.                                                                              |
| **итемактион** | Определено не используйте.                                                                                                 |
| **ItemState**  | Определено не используйте.                                                                                                 |
| **хвндитем**   | Маркер строки состояния.                                                                                              |
| **hDC**        | Обработайте с контекстом устройства строки состояния.                                                                        |
| **rcItem**     | Координаты отображаемой части окна. Координаты задаются относительно левого верхнего угла строки состояния.   |
| **итемдата**   | Определяемое приложением 32-разрядное значение, указанное в параметре *lParam* сообщения [**SB \_ SETTEXT**](sb-settext.md) . |



 

## <a name="simple-mode-status-bars"></a>Строки состояния в простом режиме

Вы поместили строку состояния в "простой режим", отправив ей [**\_ простое**](sb-simple.md) сообщение. В простой режим в строке состояния отображается только одна часть. Когда задается текст окна, окно становится недействительным, но не перерисовывается до следующего [**\_ рисования WM**](/windows/desktop/gdi/wm-paint). Ожидание сообщения уменьшает мерцание экрана за счет минимизации количества попыток перерисовки окна. Строка состояния простого режима полезна для отображения текста справки для пунктов меню, когда пользователь прокручивается по меню.

Строка, отображаемая в строке состояния в простом режиме, сохраняется отдельно от строк, отображаемых в непростом режиме. Это означает, что окно можно перевести в простой режим, задать его текст и вернуться к непростому режиму без изменения текста в непростом режиме.

При задании текста в строке состояния простого режима можно указать любой метод рисования, кроме SBT \_ овнердрав. Строка состояния простого режима не поддерживает рисование владельцем.

## <a name="default-status-bar-message-processing"></a>Обработка сообщений в строке состояния по умолчанию

В этом разделе описываются сообщения, обрабатываемые процедурой окна для предопределенного класса [**статускласснаме**](common-control-window-classes.md) .



| Сообщение               | Обработка по умолчанию                                                                                                                                                                                                                                                       |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **\_Создание WM**        | Инициализирует строку состояния.                                                                                                                                                                                                                                              |
| **WM \_ destroy**       | Освобождает ресурсы, выделенные для строки состояния.                                                                                                                                                                                                                            |
| **WM, \_ Шрифт**       | Возвращает маркер текущего шрифта, с которым строка состояния рисует текст.                                                                                                                                                                                         |
| **WM \_ gettext**       | Копирует текст из первой части строки состояния в буфер. Он возвращает 32-разрядное значение, указывающее длину текста в символах, а также метод, используемый для рисования текста.                                                                                |
| **WM \_ жеттекстленгс** | Возвращает 32-разрядное значение, определяющее длину текста в первой части строки состояния (в символах) и метод, используемый для рисования текста.                                                                                                                  |
| **WM \_ нчиттест**     | Возвращает значение ХТБОТТОМРИГХТ, если курсор мыши находится на захвате изменения размера, что приводит к отображению курсора изменения размера в системе. Если курсор мыши не находится на захвате изменения размера, строка состояния передает это сообщение функции [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) . |
| **WM \_ Paint**         | Закрашивает недействительную область строки состояния. Если параметр *wParam* не равен **null**, то элемент управления предполагает, что значение является HDC и рисует его с помощью контекста устройства.                                                                                               |
| **WM \_ сетфонт**       | Выбирает маркер шрифта в контексте устройства для строки состояния.                                                                                                                                                                                                      |
| **WM \_ SETTEXT**       | Копирует указанный текст в первую часть строки состояния, используя операцию рисования по умолчанию (указанную как нуль). При успешном выполнении он возвращает **значение true** или **false** в противном случае.                                                                                       |
| **\_Размер WM**          | Изменяет размер строки состояния в соответствии с текущей шириной клиентской области родительского окна и высотой текущего шрифта в строке состояния.                                                                                                                               |



 

 

 
