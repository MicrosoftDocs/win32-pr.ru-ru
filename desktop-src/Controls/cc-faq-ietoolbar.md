---
title: Создание панели инструментов Explorer-Style Интернета
description: Одним из основных функций пользовательского интерфейса Windows Internet Explorer является панель инструментов. Он не только предоставляет пользователям доступ к широкому набору функций, но и позволяет пользователям настраивать его макет в соответствии с личными предпочтениями.
ms.assetid: d24969ec-4dea-44c6-b045-5611de8f1cce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d32228f941a7c7e1253884ab5d72368f66f25c7f
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104134662"
---
# <a name="how-to-create-an-internet-explorer-style-toolbar"></a>Создание панели инструментов Explorer-Style Интернета

Одним из основных функций пользовательского интерфейса Windows Internet Explorer является панель инструментов. Он не только предоставляет пользователям доступ к широкому набору функций, но и позволяет пользователям настраивать его макет в соответствии с личными предпочтениями.

На следующем снимке экрана показана панель инструментов Internet Explorer, а также некоторые основные функции.

![снимок экрана панели инструментов Windows Internet Explorer с метками для восьми компонентов](images/howto1a.jpg)

Эта панель инструментов, по сути, состоит из элемента управления главной панели с четырьмя полосами: с тремя панелями инструментов и с строкой меню. Поскольку она реализована с помощью API общих элементов управления, разработчики могут создавать панели инструментов с любыми или всеми функциями. В этом разделе рассматриваются ключевые особенности панели инструментов Internet Explorer и способы их реализации в приложении.

-   [Элемент управления главной панели](#the-rebar-control)
    -   [Реализация элемента управления "Главная панель"](#implementing-the-rebar-control)
-   [Панели инструментов](#how-to-create-an-internet-explorer-style-toolbar)
    -   [Кнопки с раскрывающимся списком](#drop-down-buttons)
    -   [Кнопки в стиле списка](#list-style-buttons)
    -   [Двойные угловые скобки](#handling-chevrons)
    -   [Оперативное отслеживание](#hot-tracking)
-   [См. также](#related-topics)

## <a name="the-rebar-control"></a>Элемент управления главной панели

Базовая структура панели инструментов Internet Explorer обеспечивается [элементом управления "Главная](rebar-controls.md)панель". Этот элемент управления предоставляет пользователям способ настройки упорядочения коллекции инструментов. Каждая Главная панель содержит одну или несколько *полос*, которые обычно являются длинными, узкими прямоугольниками, которые содержат дочернее окно, обычно это элемент управления ToolBar.

Элемент управления "Главная панель" отображает его полосы в прямоугольной области, обычно в верхней части окна. Этот прямоугольник делится на одну или несколько полос, которые являются высотой диапазона. Каждая полоса может находиться на отдельной полосе, или на одной и той же полосе можно поместить несколько полос.

Элемент управления "Главная панель" предоставляет пользователям два способа упорядочения своих инструментов:

-   В левой границе каждого диапазона обычно есть область *захвата* . Захват используется, когда две или более полосы на одной полосе выходят за пределы окна. Перетаскивая границу влево или вправо, пользователи могут управлять тем, сколько места выделяется для каждого диапазона.
-   Пользователи могут перемещать полосы внутри прямоугольника панели элементов, перетаскивая их. Затем элемент управления главной панели изменяет отображение в соответствии с новым расположением полос. Если все полосы удалены из полосы, высота главной панели будет уменьшена, а область просмотра изменится.

Приложение может добавлять или удалять полосы по мере необходимости. Как правило, приложения позволяют пользователям выбирать, какие диапазоны должны отображаться в меню Вид или в контекстном меню.

Если суммарная ширина полос на полосе превышает ширину окна, элемент управления главной панели будет изменять их ширину по мере необходимости. Некоторые средства могут быть охвачены смежным диапазоном.

[Версия 5,80](common-control-versions.md) стандартных элементов управления предоставляет способ создания средств, которые были охвачены другим диапазоном, доступным для пользователя. Если установить \_ флаг рббс усечеврон в элементе **Фстиле** структуры [**ребарбандинфо**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) диапазона, то для панелей инструментов, которые были охвачены, будет отображаться *Шеврон* . Когда пользователь щелкает Шеврон, отображается меню, позволяющее ему использовать скрытые инструменты. На следующем снимке экрана из Microsoft Internet Explorer 6 отображается меню, отображаемое при покрытии части стандартной панели инструментов.

![снимок экрана, на котором показано меню, отображаемое щелчком шеврона](images/howto2.jpg)

Поскольку каждый диапазон содержит элемент управления, можно обеспечить дополнительную гибкость через API элемента управления. Например, можно реализовать настройку панели инструментов, чтобы позволить пользователю добавлять, перемещать или удалять кнопки на панели инструментов.

### <a name="implementing-the-rebar-control"></a>Реализация элемента управления "Главная панель"

Большинство функций панели инструментов Internet Explorer фактически реализуются в отдельных диапазонах. Реализация самого элемента управления "Главная панель" является простой и приведена ниже.

1.  Создайте элемент управления "Главная панель" с помощью [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa). Задайте для *двексстиле* значение [**WS \_ ex \_**](/windows/desktop/winmsg/extended-window-styles) и *лпкласснаме* в [**ребаркласснаме**](common-control-window-classes.md). Internet Explorer использует следующие стили окна:

    -   [**\_БАНДБОРДЕРС RBS**](rebar-control-styles.md)
    -   [**\_ДБЛКЛКТОГГЛЕ RBS**](rebar-control-styles.md)
    -   [**\_РЕГИСТЕРДРОП RBS**](rebar-control-styles.md)
    -   [**\_ВАРХЕИГХТ RBS**](rebar-control-styles.md)
    -   [**CCS, \_ Разделитель**](common-control-styles.md)
    -   [**CCS \_ нопаренталигн**](common-control-styles.md)
    -   [**\_граница WS**](/windows/desktop/winmsg/window-styles)
    -   [**\_дочерний элемент WS**](/windows/desktop/winmsg/window-styles)
    -   [**\_КЛИПЧИЛДРЕН WS**](/windows/desktop/winmsg/window-styles)
    -   [**\_КЛИПСИБЛИНГС WS**](/windows/desktop/winmsg/window-styles)
    -   [**\_видимый WS**](/windows/desktop/winmsg/window-styles)

    Задайте другие параметры в соответствии с вашими приложениями.

2.  Создайте элемент управления с помощью [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) или специализированной функции создания элемента управления, например [**креатетулбарекс**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex).
3.  Инициализируйте полосу для элемента управления, заполняя элементы элемента [**ребарбандинфо**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa). Включите стиль РББС \_ усечеврон с элементом **фстиле** , чтобы включить угловые скобки.
4.  Добавьте полосу к элементу управления главной панели с сообщением [**RB \_ инсертбанд**](rb-insertband.md) .
5.  Повторите шаги 2-4 для оставшихся полос.
6.  Реализуйте обработчики для уведомлений главной панели. В частности, необходимо будет выполнить обработку [РБН \_ чевронпушед](rbn-chevronpushed.md) , чтобы отобразить раскрывающееся меню при нажатии на значок шеврона. Дополнительные сведения см. в разделе [Обработка шевронов](#handling-chevrons).

Захват по умолчанию включается. Чтобы опустить захват для полосы, установите флаг РББС для \_ захвата в элемент **фстиле** в структуре [**ребарбандинфо**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) диапазона. Дополнительные сведения о реализации элементов управления главной панели см. в разделе [о главных элементах управления](rebar-controls.md).

### <a name="handling-chevrons"></a>Обработка угловых кавычек

Когда пользователь щелкает Шеврон, элемент управления "Главная панель" отправляет приложению уведомление [РБН \_ чевронпушед](rbn-chevronpushed.md) . Структура [**нмребарчеврон**](/windows/win32/api/commctrl/ns-commctrl-nmrebarchevron) , которая передается вместе с уведомлением, содержит идентификатор диапазона и структуру [**Rect**](/previous-versions//dd162897(v=vs.85)) с прямоугольником, занятым шевроном. Обработчик должен определить, какие кнопки скрыты, и отобразить связанные команды во всплывающем меню.

Следующая процедура описывает обработку уведомления [РБН \_ чевронпушед](rbn-chevronpushed.md) :

1.  Извлеките текущий ограничивающий прямоугольник для выбранного диапазона, отправив элемент управления главной панели [**сообщение \_ RB**](rb-getrect.md) .
2.  Извлеките общее количество кнопок, отправив панель инструментов элемента управления "полоса" в [**\_ буттонкаунте**](tb-buttoncount.md) сообщение.
3.  Начиная с крайней левой кнопки, можно получить ограничивающий прямоугольник кнопки, отправив элемент управления ToolBar с сообщением [**\_ Жетитемрект (ТБ**](tb-getitemrect.md) ).
4.  Передайте панель и прямоугольники кнопки функции [**интерсектрект**](/windows/desktop/api/winuser/nf-winuser-intersectrect) . Эта функция вернет структуру [**Rect**](/previous-versions//dd162897(v=vs.85)) , соответствующую видимой части кнопки.
5.  Передайте прямоугольник кнопки и прямоугольник для видимой части кнопки в функцию [**екуалрект**](/windows/desktop/api/winuser/nf-winuser-equalrect) .
6.  Если [**екуалрект**](/windows/desktop/api/winuser/nf-winuser-equalrect) возвращает **значение true**, отображается вся кнопка. Повторите шаги 3-5 для кнопки Далее на панели инструментов. Если **екуалрект** возвращает **значение false**, кнопка по крайней мере частично скрыта, а все оставшиеся кнопки будут полностью скрыты. Перейдите к следующему шагу.
7.  Создайте всплывающее меню с элементами для каждой из скрытых кнопок.
8.  Отображение всплывающего меню с помощью функции [**метод TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) . Используйте угловой прямоугольник, который был передан с уведомлением [РБН \_ чевронпушед](rbn-chevronpushed.md) , чтобы разместить меню. Меню должно находиться непосредственно под уголком шеврона, а левые границы — по левому краю.
9.  Обработайте команды меню.

## <a name="the-toolbars"></a>Панели инструментов

Большая часть сложности панели инструментов Internet Explorer заключается в реализации элементов управления, составляющих полосы главной панели. Internet Explorer обычно отображает четыре полосы:

-   Строка меню
-   Стандартная панель инструментов
-   Панель инструментов ссылок
-   Панель инструментов адреса

Все эти полосы, включая строку меню, содержат элементы управления панели инструментов. В этом разделе рассматривается реализация панелей инструментов Стандартная и ссылки. Строка меню несколько сложнее и обсуждается отдельно в разделе [Создание строки меню Интернет-Explorer-Style](cc-faq-iemenubar.md).

Основные процедуры реализации элементов управления панели инструментов обсуждаются в разделе [элементы управления ToolBar](toolbar-controls-overview.md). В этом разделе рассматриваются некоторые новые функции панели инструментов, используемые Internet Explorer для повышения удобства использования элемента управления.

-   [Кнопки с раскрывающимся списком](#drop-down-buttons)
-   [Кнопки в стиле списка](#list-style-buttons)
-   [Двойные угловые скобки](#handling-chevrons)
-   [Оперативное отслеживание](#hot-tracking)

### <a name="drop-down-buttons"></a>Кнопки с раскрывающимся списком

Кнопки раскрывающегося списка поддерживают несколько команд. Когда пользователь нажимает кнопку раскрывающегося списка, Кнопка отображает всплывающее меню вместо запуска команды. Пользователь запускает команду, выбирая ее из меню. На следующем снимке экрана показана кнопка раскрывающегося списка и меню на стандартной панели инструментов Internet Explorer.

![снимок экрана с раскрывающимся меню "почта"](images/howto3.jpg)

Функцию раскрывающегося списка можно добавить к любому стилю кнопки, добавив флаг стиля к элементу **фстиле** структуры [**тббуттон**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) этой кнопки. Существует три стиля кнопки раскрывающегося списка, все из которых используются Internet Explorer.

-   Обычные раскрывающиеся кнопки имеют стиль раскрывающегося [**\_ списка бтнс**](toolbar-control-and-button-styles.md) . Они выглядят как обычные кнопки, но при щелчке отображаются меню вместо запуска команды.
-   Простые кнопки со стрелками раскрывающегося списка имеют стиль [**бтнс \_ вхоледропдовн**](toolbar-control-and-button-styles.md) . Рядом с изображением кнопки или текстом отображается стрелка. В отличие от отличий, они идентичны обычным раскрывающимся кнопкам. Кнопка "почта", используемая в качестве примера на предыдущем рисунке, является кнопкой с раскрывающимся списком.
-   Кнопки со стрелками вниз, которые добавляют в [**\_ раскрывающийся список бтнс**](toolbar-control-and-button-styles.md) [**тбстиле \_ ex \_ дравддарровс**](toolbar-extended-styles.md) расширенный стиль, имеют стрелку, отделенную от текста или изображения. Этот стиль кнопки сочетает в себе функциональные возможности раскрывающихся и стандартных кнопок. Если пользователь щелкает стрелку, отображается меню, и пользователь может выбрать одну из нескольких команд. Если пользователь нажимает на соседнюю кнопку, он запускает команду по умолчанию. На следующем снимке экрана показана кнопка " **назад** " в Internet Explorer, в которой используется разделенная стрелка.

    ![снимок экрана, на котором показано меню кнопки "задняя разбить"](images/howto4.jpg)

Когда пользователь нажимает кнопку раскрывающегося списка с обычными или простыми стилями стрелок, элемент управления "панель инструментов" отправляет в приложение уведомление [ \_ раскрывающегося списка ТБН](tbn-dropdown.md) . Когда приложение получает это сообщение, оно отвечает за создание и отображение меню, а также на обработку выбранной команды.

Когда пользователь щелкает разделенную стрелку, элемент управления "панель инструментов" отправляет ваше приложение на уведомление [ \_ раскрывающегося списка ТБН](tbn-dropdown.md) . Приложение должно обрабатывать его так же, как и другие два типа кнопок раскрывающегося списка. Если пользователь нажимает кнопку Main, приложение получает [**\_ командное сообщение WM**](/windows/desktop/menurc/wm-command) с идентификатором команды, точно так же, как если бы это была стандартная кнопка. Приложения, как правило, реагируют на запуск команды Top в раскрывающемся меню, но вы можете ответить любым способом.

### <a name="list-style-buttons"></a>List-Style кнопки

При использовании стандартных кнопок при добавлении текста он отображается под точечным рисунком. На следующем снимке экрана показаны кнопки " **Поиск** **" и "Избранное"** в Internet Explorer с текстом "Стандартная кнопка".

![снимок экрана, показывающий панель инструментов поиска и избранного с помощью стандартных кнопок](images/howto6.jpg)

В Microsoft Internet Explorer 5 и более поздних версиях используется стиль [**\_ списка тбстиле**](toolbar-control-and-button-styles.md) . Текст расположен справа от точечного рисунка, уменьшая высоту кнопки и увеличив область просмотра. На следующем рисунке показаны кнопки **поиска** и **избранного** Internet Explorer 6 со стилем **\_ списка тбстиле** .

![снимок экрана, показывающий панель инструментов поиска и избранного с помощью кнопок в стиле списка](images/howto5.jpg)

### <a name="chevrons"></a>Двойные угловые скобки

Когда пользователь меняет порядок полос в элементе управления "Главная панель", часть панели инструментов может быть охвачена. Если полоса была создана с использованием \_ стиля рббс усечеврон, элемент управления "Главная панель" отобразит значок шеврона на правой границе панели инструментов. Пользователь щелкает значок шеврона, чтобы отобразить меню со скрытыми инструментами.

### <a name="hot-tracking"></a>Hot-Tracking

Если включена поддержка горячего отслеживания, кнопка становится *активной* при наведении на нее курсора. Обычно эта кнопка отличается от других кнопок на панели инструментов на конкретном изображении. По умолчанию на панели инструментов появляется кнопка с активной кнопкой. Когда новая кнопка перестает быть активной, приложение получает уведомление [ТБН \_ хотитемчанже](tbn-hotitemchange.md) . На следующем рисунке показана кнопка " **Поиск** и **Избранное"** в Internet Explorer 5 с кнопкой "активный **Поиск** ". В дополнение к порожденному внешнему рисунку кнопка серого цвета заменена на цвет.

![снимок экрана с кнопками "Поиск" и "Избранное" с кнопкой "активный поиск"](images/howto7.jpg)

Чтобы включить горячее отслеживание, создайте элемент управления ToolBar с стилем [**\_ списка**](toolbar-control-and-button-styles.md) [**тбстиле \_ Flat**](toolbar-control-and-button-styles.md) или тбстиле. Они называются *плоскими* панелями инструментов, так как отдельные кнопки обычно не выделены каким-либо образом. Растровые изображения просто отображаются рядом друг с другом. Они принимают вид, аналогичный кнопке, только когда они активны. Эти два стиля также являются прозрачными, что означает, что фон значков будет цветом базового окна клиента.

Чтобы при активном нажатии кнопки отображалось другое растровое изображение, создайте второй [список изображений](image-lists.md) , содержащий горячие изображения для всех кнопок на панели инструментов. Размер и порядок этих изображений должен быть таким же, как и в списке изображений по умолчанию. Чтобы задать список горячих образов, отправьте панель инструментов с сообщением [**\_ сесотимажелист**](tb-sethotimagelist.md) в виде ТБ.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Создание строки меню Интернет Explorer-Style](cc-faq-iemenubar.md)
</dt> </dl>

 

 