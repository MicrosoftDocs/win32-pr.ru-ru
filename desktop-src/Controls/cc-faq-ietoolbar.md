---
title: Создание панели инструментов Explorer-Style Интернета
description: Одним из основных функций пользовательского интерфейса Windows Internet Explorer является панель инструментов. Он не только предоставляет пользователям доступ к широкому набору функций, но и позволяет пользователям настраивать его макет в соответствии с личными предпочтениями.
ms.assetid: d24969ec-4dea-44c6-b045-5611de8f1cce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d32228f941a7c7e1253884ab5d72368f66f25c7f
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104134662"
---
# <a name="how-to-create-an-internet-explorer-style-toolbar"></a><span data-ttu-id="1dbba-104">Создание панели инструментов Explorer-Style Интернета</span><span class="sxs-lookup"><span data-stu-id="1dbba-104">How to Create an Internet Explorer-Style Toolbar</span></span>

<span data-ttu-id="1dbba-105">Одним из основных функций пользовательского интерфейса Windows Internet Explorer является панель инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-105">One of the key user interface features of Windows Internet Explorer is the toolbar.</span></span> <span data-ttu-id="1dbba-106">Он не только предоставляет пользователям доступ к широкому набору функций, но и позволяет пользователям настраивать его макет в соответствии с личными предпочтениями.</span><span class="sxs-lookup"><span data-stu-id="1dbba-106">It not only gives users access to a wide array of features, it also allows users to customize its layout according to their personal preferences.</span></span>

<span data-ttu-id="1dbba-107">На следующем снимке экрана показана панель инструментов Internet Explorer, а также некоторые основные функции.</span><span class="sxs-lookup"><span data-stu-id="1dbba-107">The following screen shot shows the Internet Explorer toolbar, and highlights some of the key features.</span></span>

![снимок экрана панели инструментов Windows Internet Explorer с метками для восьми компонентов](images/howto1a.jpg)

<span data-ttu-id="1dbba-109">Эта панель инструментов, по сути, состоит из элемента управления главной панели с четырьмя полосами: с тремя панелями инструментов и с строкой меню.</span><span class="sxs-lookup"><span data-stu-id="1dbba-109">This toolbar essentially consists of a rebar control with four bands: three toolbars and a menu bar.</span></span> <span data-ttu-id="1dbba-110">Поскольку она реализована с помощью API общих элементов управления, разработчики могут создавать панели инструментов с любыми или всеми функциями.</span><span class="sxs-lookup"><span data-stu-id="1dbba-110">Because it is implemented with the common controls API, developers can create toolbars with any or all of its features.</span></span> <span data-ttu-id="1dbba-111">В этом разделе рассматриваются ключевые особенности панели инструментов Internet Explorer и способы их реализации в приложении.</span><span class="sxs-lookup"><span data-stu-id="1dbba-111">This topic discusses the essential features of the Internet Explorer toolbar and how to implement them in your application.</span></span>

-   [<span data-ttu-id="1dbba-112">Элемент управления главной панели</span><span class="sxs-lookup"><span data-stu-id="1dbba-112">The Rebar Control</span></span>](#the-rebar-control)
    -   [<span data-ttu-id="1dbba-113">Реализация элемента управления "Главная панель"</span><span class="sxs-lookup"><span data-stu-id="1dbba-113">Implementing the Rebar Control</span></span>](#implementing-the-rebar-control)
-   [<span data-ttu-id="1dbba-114">Панели инструментов</span><span class="sxs-lookup"><span data-stu-id="1dbba-114">The Toolbars</span></span>](#how-to-create-an-internet-explorer-style-toolbar)
    -   [<span data-ttu-id="1dbba-115">Кнопки с раскрывающимся списком</span><span class="sxs-lookup"><span data-stu-id="1dbba-115">Drop-down Buttons</span></span>](#drop-down-buttons)
    -   [<span data-ttu-id="1dbba-116">Кнопки в стиле списка</span><span class="sxs-lookup"><span data-stu-id="1dbba-116">List-Style Buttons</span></span>](#list-style-buttons)
    -   [<span data-ttu-id="1dbba-117">Двойные угловые скобки</span><span class="sxs-lookup"><span data-stu-id="1dbba-117">Chevrons</span></span>](#handling-chevrons)
    -   [<span data-ttu-id="1dbba-118">Оперативное отслеживание</span><span class="sxs-lookup"><span data-stu-id="1dbba-118">Hot-Tracking</span></span>](#hot-tracking)
-   [<span data-ttu-id="1dbba-119">См. также</span><span class="sxs-lookup"><span data-stu-id="1dbba-119">Related topics</span></span>](#related-topics)

## <a name="the-rebar-control"></a><span data-ttu-id="1dbba-120">Элемент управления главной панели</span><span class="sxs-lookup"><span data-stu-id="1dbba-120">The Rebar Control</span></span>

<span data-ttu-id="1dbba-121">Базовая структура панели инструментов Internet Explorer обеспечивается [элементом управления "Главная](rebar-controls.md)панель".</span><span class="sxs-lookup"><span data-stu-id="1dbba-121">The underlying structure of the Internet Explorer toolbar is provided by a [rebar control](rebar-controls.md).</span></span> <span data-ttu-id="1dbba-122">Этот элемент управления предоставляет пользователям способ настройки упорядочения коллекции инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-122">This control provides a way for users to customize the arrangement of a collection of tools.</span></span> <span data-ttu-id="1dbba-123">Каждая Главная панель содержит одну или несколько *полос*, которые обычно являются длинными, узкими прямоугольниками, которые содержат дочернее окно, обычно это элемент управления ToolBar.</span><span class="sxs-lookup"><span data-stu-id="1dbba-123">Each rebar contains one or more *bands*, which are typically long, narrow rectangles that contain a child window, commonly a toolbar control.</span></span>

<span data-ttu-id="1dbba-124">Элемент управления "Главная панель" отображает его полосы в прямоугольной области, обычно в верхней части окна.</span><span class="sxs-lookup"><span data-stu-id="1dbba-124">The rebar control displays its bands in a rectangular area, typically at the top of the window.</span></span> <span data-ttu-id="1dbba-125">Этот прямоугольник делится на одну или несколько полос, которые являются высотой диапазона.</span><span class="sxs-lookup"><span data-stu-id="1dbba-125">This rectangle is subdivided into one or more strips that are the height of a band.</span></span> <span data-ttu-id="1dbba-126">Каждая полоса может находиться на отдельной полосе, или на одной и той же полосе можно поместить несколько полос.</span><span class="sxs-lookup"><span data-stu-id="1dbba-126">Each band can be on a separate strip, or multiple bands can be placed on the same strip.</span></span>

<span data-ttu-id="1dbba-127">Элемент управления "Главная панель" предоставляет пользователям два способа упорядочения своих инструментов:</span><span class="sxs-lookup"><span data-stu-id="1dbba-127">A rebar control provides users with two ways to arrange their tools:</span></span>

-   <span data-ttu-id="1dbba-128">В левой границе каждого диапазона обычно есть область *захвата* .</span><span class="sxs-lookup"><span data-stu-id="1dbba-128">Each band usually has a *gripper* at its left edge.</span></span> <span data-ttu-id="1dbba-129">Захват используется, когда две или более полосы на одной полосе выходят за пределы окна.</span><span class="sxs-lookup"><span data-stu-id="1dbba-129">Grippers are used when two or more bands on a single strip exceed the width of the window.</span></span> <span data-ttu-id="1dbba-130">Перетаскивая границу влево или вправо, пользователи могут управлять тем, сколько места выделяется для каждого диапазона.</span><span class="sxs-lookup"><span data-stu-id="1dbba-130">By dragging the gripper to the left or right, users can control how much space is allocated to each band.</span></span>
-   <span data-ttu-id="1dbba-131">Пользователи могут перемещать полосы внутри прямоугольника панели элементов, перетаскивая их.</span><span class="sxs-lookup"><span data-stu-id="1dbba-131">Users can move the bands within the rebar's display rectangle by dragging and dropping.</span></span> <span data-ttu-id="1dbba-132">Затем элемент управления главной панели изменяет отображение в соответствии с новым расположением полос.</span><span class="sxs-lookup"><span data-stu-id="1dbba-132">The rebar control then changes the display to accommodate the new arrangement of bands.</span></span> <span data-ttu-id="1dbba-133">Если все полосы удалены из полосы, высота главной панели будет уменьшена, а область просмотра изменится.</span><span class="sxs-lookup"><span data-stu-id="1dbba-133">If all the bands are removed from a strip, the height of the rebar will be reduced, enlarging the viewing area.</span></span>

<span data-ttu-id="1dbba-134">Приложение может добавлять или удалять полосы по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="1dbba-134">An application can add or remove bands as needed.</span></span> <span data-ttu-id="1dbba-135">Как правило, приложения позволяют пользователям выбирать, какие диапазоны должны отображаться в меню Вид или в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="1dbba-135">Typically, applications enable users to select which bands they want to have displayed through the View menu or a shortcut menu.</span></span>

<span data-ttu-id="1dbba-136">Если суммарная ширина полос на полосе превышает ширину окна, элемент управления главной панели будет изменять их ширину по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="1dbba-136">If the combined width of the bands on a strip exceeds the width of the window, the rebar control will adjust their widths as needed.</span></span> <span data-ttu-id="1dbba-137">Некоторые средства могут быть охвачены смежным диапазоном.</span><span class="sxs-lookup"><span data-stu-id="1dbba-137">Some of the tools might be covered by the adjacent band.</span></span>

<span data-ttu-id="1dbba-138">[Версия 5,80](common-control-versions.md) стандартных элементов управления предоставляет способ создания средств, которые были охвачены другим диапазоном, доступным для пользователя.</span><span class="sxs-lookup"><span data-stu-id="1dbba-138">[Version 5.80](common-control-versions.md) of the common controls provides a way to make tools that have been covered by another band accessible to the user.</span></span> <span data-ttu-id="1dbba-139">Если установить \_ флаг рббс усечеврон в элементе **Фстиле** структуры [**ребарбандинфо**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) диапазона, то для панелей инструментов, которые были охвачены, будет отображаться *Шеврон* .</span><span class="sxs-lookup"><span data-stu-id="1dbba-139">If you set the RBBS\_USECHEVRON flag in the **fStyle** member of the band's [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) structure, a *chevron* will be displayed for toolbars that have been covered.</span></span> <span data-ttu-id="1dbba-140">Когда пользователь щелкает Шеврон, отображается меню, позволяющее ему использовать скрытые инструменты.</span><span class="sxs-lookup"><span data-stu-id="1dbba-140">When a user clicks the chevron, a menu is displayed that allows him or her to use the hidden tools.</span></span> <span data-ttu-id="1dbba-141">На следующем снимке экрана из Microsoft Internet Explorer 6 отображается меню, отображаемое при покрытии части стандартной панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-141">The following screen shot from Microsoft Internet Explorer 6 shows the menu that is displayed when part of the standard toolbar is covered.</span></span>

![снимок экрана, на котором показано меню, отображаемое щелчком шеврона](images/howto2.jpg)

<span data-ttu-id="1dbba-143">Поскольку каждый диапазон содержит элемент управления, можно обеспечить дополнительную гибкость через API элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1dbba-143">Since each band contains a control, you can provide additional flexibility through the control's API.</span></span> <span data-ttu-id="1dbba-144">Например, можно реализовать настройку панели инструментов, чтобы позволить пользователю добавлять, перемещать или удалять кнопки на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-144">For example, you can implement toolbar customization to enable the user to add, move, or delete buttons on a toolbar.</span></span>

### <a name="implementing-the-rebar-control"></a><span data-ttu-id="1dbba-145">Реализация элемента управления "Главная панель"</span><span class="sxs-lookup"><span data-stu-id="1dbba-145">Implementing the Rebar Control</span></span>

<span data-ttu-id="1dbba-146">Большинство функций панели инструментов Internet Explorer фактически реализуются в отдельных диапазонах.</span><span class="sxs-lookup"><span data-stu-id="1dbba-146">Most of the features of the Internet Explorer toolbar are actually implemented in the individual bands.</span></span> <span data-ttu-id="1dbba-147">Реализация самого элемента управления "Главная панель" является простой и приведена ниже.</span><span class="sxs-lookup"><span data-stu-id="1dbba-147">The implementation of the rebar control itself is straightforward and is listed below.</span></span>

1.  <span data-ttu-id="1dbba-148">Создайте элемент управления "Главная панель" с помощью [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa).</span><span class="sxs-lookup"><span data-stu-id="1dbba-148">Create the rebar control with [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa).</span></span> <span data-ttu-id="1dbba-149">Задайте для *двексстиле* значение [**WS \_ ex \_**](/windows/desktop/winmsg/extended-window-styles) и *лпкласснаме* в [**ребаркласснаме**](common-control-window-classes.md).</span><span class="sxs-lookup"><span data-stu-id="1dbba-149">Set *dwExStyle* to [**WS\_EX\_TOOLWINDOW**](/windows/desktop/winmsg/extended-window-styles) and *lpClassName* to [**REBARCLASSNAME**](common-control-window-classes.md).</span></span> <span data-ttu-id="1dbba-150">Internet Explorer использует следующие стили окна:</span><span class="sxs-lookup"><span data-stu-id="1dbba-150">Internet Explorer uses the following window styles:</span></span>

    -   [<span data-ttu-id="1dbba-151">**\_БАНДБОРДЕРС RBS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-151">**RBS\_BANDBORDERS**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="1dbba-152">**\_ДБЛКЛКТОГГЛЕ RBS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-152">**RBS\_DBLCLKTOGGLE**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="1dbba-153">**\_РЕГИСТЕРДРОП RBS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-153">**RBS\_REGISTERDROP**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="1dbba-154">**\_ВАРХЕИГХТ RBS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-154">**RBS\_VARHEIGHT**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="1dbba-155">**CCS, \_ Разделитель**</span><span class="sxs-lookup"><span data-stu-id="1dbba-155">**CCS\_NODIVIDER**</span></span>](common-control-styles.md)
    -   [<span data-ttu-id="1dbba-156">**CCS \_ нопаренталигн**</span><span class="sxs-lookup"><span data-stu-id="1dbba-156">**CCS\_NOPARENTALIGN**</span></span>](common-control-styles.md)
    -   [<span data-ttu-id="1dbba-157">**\_граница WS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-157">**WS\_BORDER**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="1dbba-158">**\_дочерний элемент WS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-158">**WS\_CHILD**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="1dbba-159">**\_КЛИПЧИЛДРЕН WS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-159">**WS\_CLIPCHILDREN**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="1dbba-160">**\_КЛИПСИБЛИНГС WS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-160">**WS\_CLIPSIBLINGS**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="1dbba-161">**\_видимый WS**</span><span class="sxs-lookup"><span data-stu-id="1dbba-161">**WS\_VISIBLE**</span></span>](/windows/desktop/winmsg/window-styles)

    <span data-ttu-id="1dbba-162">Задайте другие параметры в соответствии с вашими приложениями.</span><span class="sxs-lookup"><span data-stu-id="1dbba-162">Set the other parameters as appropriate for your application.</span></span>

2.  <span data-ttu-id="1dbba-163">Создайте элемент управления с помощью [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) или специализированной функции создания элемента управления, например [**креатетулбарекс**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex).</span><span class="sxs-lookup"><span data-stu-id="1dbba-163">Create a control with [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) or a specialized control creation function such as [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex).</span></span>
3.  <span data-ttu-id="1dbba-164">Инициализируйте полосу для элемента управления, заполняя элементы элемента [**ребарбандинфо**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa).</span><span class="sxs-lookup"><span data-stu-id="1dbba-164">Initialize a band for the control by filling in the members of [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa).</span></span> <span data-ttu-id="1dbba-165">Включите стиль РББС \_ усечеврон с элементом **фстиле** , чтобы включить угловые скобки.</span><span class="sxs-lookup"><span data-stu-id="1dbba-165">Include the RBBS\_USECHEVRON style with the **fStyle** member to enable chevrons.</span></span>
4.  <span data-ttu-id="1dbba-166">Добавьте полосу к элементу управления главной панели с сообщением [**RB \_ инсертбанд**](rb-insertband.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-166">Add the band to the rebar control with an [**RB\_INSERTBAND**](rb-insertband.md) message.</span></span>
5.  <span data-ttu-id="1dbba-167">Повторите шаги 2-4 для оставшихся полос.</span><span class="sxs-lookup"><span data-stu-id="1dbba-167">Repeat steps 2-4 for the remaining bands.</span></span>
6.  <span data-ttu-id="1dbba-168">Реализуйте обработчики для уведомлений главной панели.</span><span class="sxs-lookup"><span data-stu-id="1dbba-168">Implement handlers for the rebar notifications.</span></span> <span data-ttu-id="1dbba-169">В частности, необходимо будет выполнить обработку [РБН \_ чевронпушед](rbn-chevronpushed.md) , чтобы отобразить раскрывающееся меню при нажатии на значок шеврона.</span><span class="sxs-lookup"><span data-stu-id="1dbba-169">In particular, you will need to handle [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) to display a drop-down menu when a chevron is clicked.</span></span> <span data-ttu-id="1dbba-170">Дополнительные сведения см. в разделе [Обработка шевронов](#handling-chevrons).</span><span class="sxs-lookup"><span data-stu-id="1dbba-170">For further information, see [Handling Chevrons](#handling-chevrons).</span></span>

<span data-ttu-id="1dbba-171">Захват по умолчанию включается.</span><span class="sxs-lookup"><span data-stu-id="1dbba-171">The grippers are included by default.</span></span> <span data-ttu-id="1dbba-172">Чтобы опустить захват для полосы, установите флаг РББС для \_ захвата в элемент **фстиле** в структуре [**ребарбандинфо**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) диапазона.</span><span class="sxs-lookup"><span data-stu-id="1dbba-172">To omit the gripper for a band, set the RBBS\_NOGRIPPER flag in the **fStyle** member of the band's [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) structure.</span></span> <span data-ttu-id="1dbba-173">Дополнительные сведения о реализации элементов управления главной панели см. в разделе [о главных элементах управления](rebar-controls.md).</span><span class="sxs-lookup"><span data-stu-id="1dbba-173">For further information on implementing rebar controls, see [About Rebar Controls](rebar-controls.md).</span></span>

### <a name="handling-chevrons"></a><span data-ttu-id="1dbba-174">Обработка угловых кавычек</span><span class="sxs-lookup"><span data-stu-id="1dbba-174">Handling Chevrons</span></span>

<span data-ttu-id="1dbba-175">Когда пользователь щелкает Шеврон, элемент управления "Главная панель" отправляет приложению уведомление [РБН \_ чевронпушед](rbn-chevronpushed.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-175">When a user clicks a chevron, the rebar control sends your application an [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) notification.</span></span> <span data-ttu-id="1dbba-176">Структура [**нмребарчеврон**](/windows/win32/api/commctrl/ns-commctrl-nmrebarchevron) , которая передается вместе с уведомлением, содержит идентификатор диапазона и структуру [**Rect**](/previous-versions//dd162897(v=vs.85)) с прямоугольником, занятым шевроном.</span><span class="sxs-lookup"><span data-stu-id="1dbba-176">The [**NMREBARCHEVRON**](/windows/win32/api/commctrl/ns-commctrl-nmrebarchevron) structure that is passed with the notification contains the band's identifier and a [**RECT**](/previous-versions//dd162897(v=vs.85)) structure with the rectangle that is occupied by the chevron.</span></span> <span data-ttu-id="1dbba-177">Обработчик должен определить, какие кнопки скрыты, и отобразить связанные команды во всплывающем меню.</span><span class="sxs-lookup"><span data-stu-id="1dbba-177">Your handler must determine which buttons are hidden and display the associated commands on a pop-up menu.</span></span>

<span data-ttu-id="1dbba-178">Следующая процедура описывает обработку уведомления [РБН \_ чевронпушед](rbn-chevronpushed.md) :</span><span class="sxs-lookup"><span data-stu-id="1dbba-178">The following procedure outlines how to handle an [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) notification:</span></span>

1.  <span data-ttu-id="1dbba-179">Извлеките текущий ограничивающий прямоугольник для выбранного диапазона, отправив элемент управления главной панели [**сообщение \_ RB**](rb-getrect.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-179">Retrieve the current bounding rectangle for the selected band by sending the rebar control an [**RB\_GETRECT**](rb-getrect.md) message.</span></span>
2.  <span data-ttu-id="1dbba-180">Извлеките общее количество кнопок, отправив панель инструментов элемента управления "полоса" в [**\_ буттонкаунте**](tb-buttoncount.md) сообщение.</span><span class="sxs-lookup"><span data-stu-id="1dbba-180">Retrieve the total number of buttons by sending the band's toolbar control a [**TB\_BUTTONCOUNT**](tb-buttoncount.md) message.</span></span>
3.  <span data-ttu-id="1dbba-181">Начиная с крайней левой кнопки, можно получить ограничивающий прямоугольник кнопки, отправив элемент управления ToolBar с сообщением [**\_ Жетитемрект (ТБ**](tb-getitemrect.md) ).</span><span class="sxs-lookup"><span data-stu-id="1dbba-181">Starting from the leftmost button, retrieve the button's bounding rectangle by sending the toolbar control a [**TB\_GETITEMRECT**](tb-getitemrect.md) message.</span></span>
4.  <span data-ttu-id="1dbba-182">Передайте панель и прямоугольники кнопки функции [**интерсектрект**](/windows/desktop/api/winuser/nf-winuser-intersectrect) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-182">Pass the band and button rectangles to the [**IntersectRect**](/windows/desktop/api/winuser/nf-winuser-intersectrect) function.</span></span> <span data-ttu-id="1dbba-183">Эта функция вернет структуру [**Rect**](/previous-versions//dd162897(v=vs.85)) , соответствующую видимой части кнопки.</span><span class="sxs-lookup"><span data-stu-id="1dbba-183">This function will return a [**RECT**](/previous-versions//dd162897(v=vs.85)) structure that corresponds to the visible portion of the button.</span></span>
5.  <span data-ttu-id="1dbba-184">Передайте прямоугольник кнопки и прямоугольник для видимой части кнопки в функцию [**екуалрект**](/windows/desktop/api/winuser/nf-winuser-equalrect) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-184">Pass the button rectangle and the rectangle for the visible portion of the button to the [**EqualRect**](/windows/desktop/api/winuser/nf-winuser-equalrect) function.</span></span>
6.  <span data-ttu-id="1dbba-185">Если [**екуалрект**](/windows/desktop/api/winuser/nf-winuser-equalrect) возвращает **значение true**, отображается вся кнопка.</span><span class="sxs-lookup"><span data-stu-id="1dbba-185">If [**EqualRect**](/windows/desktop/api/winuser/nf-winuser-equalrect) returns **TRUE**, the entire button is visible.</span></span> <span data-ttu-id="1dbba-186">Повторите шаги 3-5 для кнопки Далее на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-186">Repeat steps 3-5 for the next button on the toolbar.</span></span> <span data-ttu-id="1dbba-187">Если **екуалрект** возвращает **значение false**, кнопка по крайней мере частично скрыта, а все оставшиеся кнопки будут полностью скрыты.</span><span class="sxs-lookup"><span data-stu-id="1dbba-187">If **EqualRect** returns **FALSE**, the button is at least partially hidden and all remaining buttons will be completely hidden.</span></span> <span data-ttu-id="1dbba-188">Перейдите к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="1dbba-188">Continue to the next step.</span></span>
7.  <span data-ttu-id="1dbba-189">Создайте всплывающее меню с элементами для каждой из скрытых кнопок.</span><span class="sxs-lookup"><span data-stu-id="1dbba-189">Create a pop-up menu with items for each of the hidden buttons.</span></span>
8.  <span data-ttu-id="1dbba-190">Отображение всплывающего меню с помощью функции [**метод TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-190">Display the pop-up menu by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function.</span></span> <span data-ttu-id="1dbba-191">Используйте угловой прямоугольник, который был передан с уведомлением [РБН \_ чевронпушед](rbn-chevronpushed.md) , чтобы разместить меню.</span><span class="sxs-lookup"><span data-stu-id="1dbba-191">Use the chevron rectangle that was passed with the [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) notification to position the menu.</span></span> <span data-ttu-id="1dbba-192">Меню должно находиться непосредственно под уголком шеврона, а левые границы — по левому краю.</span><span class="sxs-lookup"><span data-stu-id="1dbba-192">The menu should be immediately below the chevron, with the left edges aligned.</span></span>
9.  <span data-ttu-id="1dbba-193">Обработайте команды меню.</span><span class="sxs-lookup"><span data-stu-id="1dbba-193">Handle the menu commands.</span></span>

## <a name="the-toolbars"></a><span data-ttu-id="1dbba-194">Панели инструментов</span><span class="sxs-lookup"><span data-stu-id="1dbba-194">The Toolbars</span></span>

<span data-ttu-id="1dbba-195">Большая часть сложности панели инструментов Internet Explorer заключается в реализации элементов управления, составляющих полосы главной панели.</span><span class="sxs-lookup"><span data-stu-id="1dbba-195">Most of the complexity of the Internet Explorer toolbar lies in the implementation of controls that make up the rebar bands.</span></span> <span data-ttu-id="1dbba-196">Internet Explorer обычно отображает четыре полосы:</span><span class="sxs-lookup"><span data-stu-id="1dbba-196">Internet Explorer commonly displays four bands:</span></span>

-   <span data-ttu-id="1dbba-197">Строка меню</span><span class="sxs-lookup"><span data-stu-id="1dbba-197">The menu bar</span></span>
-   <span data-ttu-id="1dbba-198">Стандартная панель инструментов</span><span class="sxs-lookup"><span data-stu-id="1dbba-198">The standard toolbar</span></span>
-   <span data-ttu-id="1dbba-199">Панель инструментов ссылок</span><span class="sxs-lookup"><span data-stu-id="1dbba-199">The links toolbar</span></span>
-   <span data-ttu-id="1dbba-200">Панель инструментов адреса</span><span class="sxs-lookup"><span data-stu-id="1dbba-200">The address toolbar</span></span>

<span data-ttu-id="1dbba-201">Все эти полосы, включая строку меню, содержат элементы управления панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-201">All of these bands, including the menu bar, actually hold toolbar controls.</span></span> <span data-ttu-id="1dbba-202">В этом разделе рассматривается реализация панелей инструментов Стандартная и ссылки.</span><span class="sxs-lookup"><span data-stu-id="1dbba-202">This section discusses the implementation of the standard and links toolbars.</span></span> <span data-ttu-id="1dbba-203">Строка меню несколько сложнее и обсуждается отдельно в разделе [Создание строки меню Интернет-Explorer-Style](cc-faq-iemenubar.md).</span><span class="sxs-lookup"><span data-stu-id="1dbba-203">The menu bar is somewhat more complicated and is discussed separately in [How to Create an Internet Explorer-Style Menu Bar](cc-faq-iemenubar.md).</span></span>

<span data-ttu-id="1dbba-204">Основные процедуры реализации элементов управления панели инструментов обсуждаются в разделе [элементы управления ToolBar](toolbar-controls-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1dbba-204">The basic procedures for implementing toolbar controls are discussed in [About Toolbar Controls](toolbar-controls-overview.md).</span></span> <span data-ttu-id="1dbba-205">В этом разделе рассматриваются некоторые новые функции панели инструментов, используемые Internet Explorer для повышения удобства использования элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1dbba-205">This section focuses on some of the newer toolbar features that are used by Internet Explorer to increase the usability of the control.</span></span>

-   [<span data-ttu-id="1dbba-206">Кнопки с раскрывающимся списком</span><span class="sxs-lookup"><span data-stu-id="1dbba-206">Drop-down Buttons</span></span>](#drop-down-buttons)
-   [<span data-ttu-id="1dbba-207">Кнопки в стиле списка</span><span class="sxs-lookup"><span data-stu-id="1dbba-207">List-Style Buttons</span></span>](#list-style-buttons)
-   [<span data-ttu-id="1dbba-208">Двойные угловые скобки</span><span class="sxs-lookup"><span data-stu-id="1dbba-208">Chevrons</span></span>](#handling-chevrons)
-   [<span data-ttu-id="1dbba-209">Оперативное отслеживание</span><span class="sxs-lookup"><span data-stu-id="1dbba-209">Hot-Tracking</span></span>](#hot-tracking)

### <a name="drop-down-buttons"></a><span data-ttu-id="1dbba-210">Кнопки с раскрывающимся списком</span><span class="sxs-lookup"><span data-stu-id="1dbba-210">Drop-down Buttons</span></span>

<span data-ttu-id="1dbba-211">Кнопки раскрывающегося списка поддерживают несколько команд.</span><span class="sxs-lookup"><span data-stu-id="1dbba-211">Drop-down buttons support multiple commands.</span></span> <span data-ttu-id="1dbba-212">Когда пользователь нажимает кнопку раскрывающегося списка, Кнопка отображает всплывающее меню вместо запуска команды.</span><span class="sxs-lookup"><span data-stu-id="1dbba-212">When the user clicks a drop-down button, the button displays a pop-up menu instead of launching a command.</span></span> <span data-ttu-id="1dbba-213">Пользователь запускает команду, выбирая ее из меню.</span><span class="sxs-lookup"><span data-stu-id="1dbba-213">The user launches a command by selecting it from the menu.</span></span> <span data-ttu-id="1dbba-214">На следующем снимке экрана показана кнопка раскрывающегося списка и меню на стандартной панели инструментов Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="1dbba-214">The following screen shot shows a drop-down button and menu from the Internet Explorer standard toolbar.</span></span>

![снимок экрана с раскрывающимся меню "почта"](images/howto3.jpg)

<span data-ttu-id="1dbba-216">Функцию раскрывающегося списка можно добавить к любому стилю кнопки, добавив флаг стиля к элементу **фстиле** структуры [**тббуттон**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) этой кнопки.</span><span class="sxs-lookup"><span data-stu-id="1dbba-216">Drop-down functionality can be added to any button style by adding a style flag to the **fStyle** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure.</span></span> <span data-ttu-id="1dbba-217">Существует три стиля кнопки раскрывающегося списка, все из которых используются Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="1dbba-217">There are three styles of drop-down button, all of which are used by Internet Explorer:</span></span>

-   <span data-ttu-id="1dbba-218">Обычные раскрывающиеся кнопки имеют стиль раскрывающегося [**\_ списка бтнс**](toolbar-control-and-button-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-218">Plain drop-down buttons have the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="1dbba-219">Они выглядят как обычные кнопки, но при щелчке отображаются меню вместо запуска команды.</span><span class="sxs-lookup"><span data-stu-id="1dbba-219">They look like normal buttons, but they display a menu when clicked instead of launching a command.</span></span>
-   <span data-ttu-id="1dbba-220">Простые кнопки со стрелками раскрывающегося списка имеют стиль [**бтнс \_ вхоледропдовн**](toolbar-control-and-button-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-220">Simple drop-down arrow buttons have the [**BTNS\_WHOLEDROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="1dbba-221">Рядом с изображением кнопки или текстом отображается стрелка.</span><span class="sxs-lookup"><span data-stu-id="1dbba-221">They have an arrow displayed next to the button image or text.</span></span> <span data-ttu-id="1dbba-222">В отличие от отличий, они идентичны обычным раскрывающимся кнопкам.</span><span class="sxs-lookup"><span data-stu-id="1dbba-222">Other than the difference in appearance, they are identical to plain drop-down buttons.</span></span> <span data-ttu-id="1dbba-223">Кнопка "почта", используемая в качестве примера на предыдущем рисунке, является кнопкой с раскрывающимся списком.</span><span class="sxs-lookup"><span data-stu-id="1dbba-223">The Mail button used as the example in the preceding illustration is a drop-down arrow button.</span></span>
-   <span data-ttu-id="1dbba-224">Кнопки со стрелками вниз, которые добавляют в [**\_ раскрывающийся список бтнс**](toolbar-control-and-button-styles.md) [**тбстиле \_ ex \_ дравддарровс**](toolbar-extended-styles.md) расширенный стиль, имеют стрелку, отделенную от текста или изображения.</span><span class="sxs-lookup"><span data-stu-id="1dbba-224">Drop-down arrow buttons that add the [**TBSTYLE\_EX\_DRAWDDARROWS**](toolbar-extended-styles.md) extended style to [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) have an arrow that is separated from the text or image.</span></span> <span data-ttu-id="1dbba-225">Этот стиль кнопки сочетает в себе функциональные возможности раскрывающихся и стандартных кнопок.</span><span class="sxs-lookup"><span data-stu-id="1dbba-225">This button style combines the functionality of drop-down and standard buttons.</span></span> <span data-ttu-id="1dbba-226">Если пользователь щелкает стрелку, отображается меню, и пользователь может выбрать одну из нескольких команд.</span><span class="sxs-lookup"><span data-stu-id="1dbba-226">If the user clicks the arrow, a menu is displayed and the user can choose from several commands.</span></span> <span data-ttu-id="1dbba-227">Если пользователь нажимает на соседнюю кнопку, он запускает команду по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1dbba-227">If the user clicks the adjacent button, it launches a default command.</span></span> <span data-ttu-id="1dbba-228">На следующем снимке экрана показана кнопка " **назад** " в Internet Explorer, в которой используется разделенная стрелка.</span><span class="sxs-lookup"><span data-stu-id="1dbba-228">The following screen shot shows the Internet Explorer **Back** button, which uses a separated arrow.</span></span>

    ![снимок экрана, на котором показано меню кнопки "задняя разбить"](images/howto4.jpg)

<span data-ttu-id="1dbba-230">Когда пользователь нажимает кнопку раскрывающегося списка с обычными или простыми стилями стрелок, элемент управления "панель инструментов" отправляет в приложение уведомление [ \_ раскрывающегося списка ТБН](tbn-dropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-230">When the user clicks a drop-down button with either the plain or simple arrow styles, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="1dbba-231">Когда приложение получает это сообщение, оно отвечает за создание и отображение меню, а также на обработку выбранной команды.</span><span class="sxs-lookup"><span data-stu-id="1dbba-231">When your application receives this message, it is responsible for creating and displaying the menu, and for handling the selected command.</span></span>

<span data-ttu-id="1dbba-232">Когда пользователь щелкает разделенную стрелку, элемент управления "панель инструментов" отправляет ваше приложение на уведомление [ \_ раскрывающегося списка ТБН](tbn-dropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-232">When the user clicks a separated arrow, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="1dbba-233">Приложение должно обрабатывать его так же, как и другие два типа кнопок раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="1dbba-233">Your application should handle it the same way as it handles the other two types of drop-down buttons.</span></span> <span data-ttu-id="1dbba-234">Если пользователь нажимает кнопку Main, приложение получает [**\_ командное сообщение WM**](/windows/desktop/menurc/wm-command) с идентификатором команды, точно так же, как если бы это была стандартная кнопка.</span><span class="sxs-lookup"><span data-stu-id="1dbba-234">If the user clicks the main button, your application receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the button's command ID, just as if it were a standard button.</span></span> <span data-ttu-id="1dbba-235">Приложения, как правило, реагируют на запуск команды Top в раскрывающемся меню, но вы можете ответить любым способом.</span><span class="sxs-lookup"><span data-stu-id="1dbba-235">Applications typically respond by launching the top command in the drop-down menu, but you are free to respond in any suitable way.</span></span>

### <a name="list-style-buttons"></a><span data-ttu-id="1dbba-236">List-Style кнопки</span><span class="sxs-lookup"><span data-stu-id="1dbba-236">List-Style Buttons</span></span>

<span data-ttu-id="1dbba-237">При использовании стандартных кнопок при добавлении текста он отображается под точечным рисунком.</span><span class="sxs-lookup"><span data-stu-id="1dbba-237">With standard buttons, if you add text, it is displayed below the bitmap.</span></span> <span data-ttu-id="1dbba-238">На следующем снимке экрана показаны кнопки " **Поиск** **" и "Избранное"** в Internet Explorer с текстом "Стандартная кнопка".</span><span class="sxs-lookup"><span data-stu-id="1dbba-238">The following screen shot shows the Internet Explorer **Search** and **Favorites** buttons with standard button text.</span></span>

![снимок экрана, показывающий панель инструментов поиска и избранного с помощью стандартных кнопок](images/howto6.jpg)

<span data-ttu-id="1dbba-240">В Microsoft Internet Explorer 5 и более поздних версиях используется стиль [**\_ списка тбстиле**](toolbar-control-and-button-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-240">Microsoft Internet Explorer 5 and later versions use the [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="1dbba-241">Текст расположен справа от точечного рисунка, уменьшая высоту кнопки и увеличив область просмотра.</span><span class="sxs-lookup"><span data-stu-id="1dbba-241">The text is to the right of the bitmap, reducing the height of the button and enlarging the viewing region.</span></span> <span data-ttu-id="1dbba-242">На следующем рисунке показаны кнопки **поиска** и **избранного** Internet Explorer 6 со стилем **\_ списка тбстиле** .</span><span class="sxs-lookup"><span data-stu-id="1dbba-242">The following illustration shows the Internet Explorer 6 **Search** and **Favorites** buttons with the **TBSTYLE\_LIST** style.</span></span>

![снимок экрана, показывающий панель инструментов поиска и избранного с помощью кнопок в стиле списка](images/howto5.jpg)

### <a name="chevrons"></a><span data-ttu-id="1dbba-244">Двойные угловые скобки</span><span class="sxs-lookup"><span data-stu-id="1dbba-244">Chevrons</span></span>

<span data-ttu-id="1dbba-245">Когда пользователь меняет порядок полос в элементе управления "Главная панель", часть панели инструментов может быть охвачена.</span><span class="sxs-lookup"><span data-stu-id="1dbba-245">When the user rearranges the bands in the rebar control, part of a toolbar might be covered up.</span></span> <span data-ttu-id="1dbba-246">Если полоса была создана с использованием \_ стиля рббс усечеврон, элемент управления "Главная панель" отобразит значок шеврона на правой границе панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-246">If the band was created with the RBBS\_USECHEVRON style, the rebar control will display a chevron at the right edge of the toolbar.</span></span> <span data-ttu-id="1dbba-247">Пользователь щелкает значок шеврона, чтобы отобразить меню со скрытыми инструментами.</span><span class="sxs-lookup"><span data-stu-id="1dbba-247">The user clicks the chevron to display a menu with the hidden tools.</span></span>

### <a name="hot-tracking"></a><span data-ttu-id="1dbba-248">Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="1dbba-248">Hot-Tracking</span></span>

<span data-ttu-id="1dbba-249">Если включена поддержка горячего отслеживания, кнопка становится *активной* при наведении на нее курсора.</span><span class="sxs-lookup"><span data-stu-id="1dbba-249">When hot-tracking is enabled, a button becomes *hot* when the cursor is over it.</span></span> <span data-ttu-id="1dbba-250">Обычно эта кнопка отличается от других кнопок на панели инструментов на конкретном изображении.</span><span class="sxs-lookup"><span data-stu-id="1dbba-250">The hot button is normally distinguished from the other buttons on the toolbar by a distinctive image.</span></span> <span data-ttu-id="1dbba-251">По умолчанию на панели инструментов появляется кнопка с активной кнопкой.</span><span class="sxs-lookup"><span data-stu-id="1dbba-251">By default, a hot button appears to be raised above the rest of the toolbar.</span></span> <span data-ttu-id="1dbba-252">Когда новая кнопка перестает быть активной, приложение получает уведомление [ТБН \_ хотитемчанже](tbn-hotitemchange.md) .</span><span class="sxs-lookup"><span data-stu-id="1dbba-252">When a new button becomes hot, your application receives a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification.</span></span> <span data-ttu-id="1dbba-253">На следующем рисунке показана кнопка " **Поиск** и **Избранное"** в Internet Explorer 5 с кнопкой "активный **Поиск** ".</span><span class="sxs-lookup"><span data-stu-id="1dbba-253">The following illustration shows the Internet Explorer 5 **Search** and **Favorites** buttons, with a hot **Search** button.</span></span> <span data-ttu-id="1dbba-254">В дополнение к порожденному внешнему рисунку кнопка серого цвета заменена на цвет.</span><span class="sxs-lookup"><span data-stu-id="1dbba-254">In addition to having a raised appearance, the button's gray bitmap has been replaced with a colored one.</span></span>

![снимок экрана с кнопками "Поиск" и "Избранное" с кнопкой "активный поиск"](images/howto7.jpg)

<span data-ttu-id="1dbba-256">Чтобы включить горячее отслеживание, создайте элемент управления ToolBar с стилем [**\_ списка**](toolbar-control-and-button-styles.md) [**тбстиле \_ Flat**](toolbar-control-and-button-styles.md) или тбстиле.</span><span class="sxs-lookup"><span data-stu-id="1dbba-256">To enable hot-tracking, create a toolbar control with either the [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) or [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="1dbba-257">Они называются *плоскими* панелями инструментов, так как отдельные кнопки обычно не выделены каким-либо образом.</span><span class="sxs-lookup"><span data-stu-id="1dbba-257">These are referred to as *flat* toolbars because the individual buttons are not ordinarily highlighted in any way.</span></span> <span data-ttu-id="1dbba-258">Растровые изображения просто отображаются рядом друг с другом.</span><span class="sxs-lookup"><span data-stu-id="1dbba-258">The bitmaps are simply displayed next to each other.</span></span> <span data-ttu-id="1dbba-259">Они принимают вид, аналогичный кнопке, только когда они активны.</span><span class="sxs-lookup"><span data-stu-id="1dbba-259">They take on a button-like appearance only when they are hot.</span></span> <span data-ttu-id="1dbba-260">Эти два стиля также являются прозрачными, что означает, что фон значков будет цветом базового окна клиента.</span><span class="sxs-lookup"><span data-stu-id="1dbba-260">These two styles are also transparent, which means that the background of the icons will be the color of the underlying client window.</span></span>

<span data-ttu-id="1dbba-261">Чтобы при активном нажатии кнопки отображалось другое растровое изображение, создайте второй [список изображений](image-lists.md) , содержащий горячие изображения для всех кнопок на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="1dbba-261">To have a different bitmap displayed when the button is hot, create a second [image list](image-lists.md) that contains hot images for all the buttons on the toolbar.</span></span> <span data-ttu-id="1dbba-262">Размер и порядок этих изображений должен быть таким же, как и в списке изображений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1dbba-262">The size and order of these images should be the same as in the default image list.</span></span> <span data-ttu-id="1dbba-263">Чтобы задать список горячих образов, отправьте панель инструментов с сообщением [**\_ сесотимажелист**](tb-sethotimagelist.md) в виде ТБ.</span><span class="sxs-lookup"><span data-stu-id="1dbba-263">Send the toolbar control a [**TB\_SETHOTIMAGELIST**](tb-sethotimagelist.md) message to set the hot image list.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1dbba-264">См. также</span><span class="sxs-lookup"><span data-stu-id="1dbba-264">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1dbba-265">Создание строки меню Интернет Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="1dbba-265">How to Create an Internet Explorer-Style Menu Bar</span></span>](cc-faq-iemenubar.md)
</dt> </dl>

 

 