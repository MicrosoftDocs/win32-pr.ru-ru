---
description: Классические поставщики используют функцию Трацеевентинстанце для трассировки событий, которые являются частью одной транзакции. Эту функцию также можно использовать для трассировки родительских и дочерних событий.
ms.assetid: 246e9443-3120-49bf-a6e3-64dddba348fa
title: Запись связанных событий в классическом поставщике
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 771b08a66625d5cd6e723fbc2e12eed87bd1d434
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104350325"
---
# <a name="writing-related-events-in-a-classic-provider"></a><span data-ttu-id="309eb-104">Запись связанных событий в классическом поставщике</span><span class="sxs-lookup"><span data-stu-id="309eb-104">Writing Related Events in a Classic Provider</span></span>

<span data-ttu-id="309eb-105">[Классические](about-event-tracing.md) поставщики используют функцию [**трацеевентинстанце**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) для трассировки событий, которые являются частью одной транзакции.</span><span class="sxs-lookup"><span data-stu-id="309eb-105">[Classic](about-event-tracing.md) providers use the [**TraceEventInstance**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) function to trace events that are part of a single transaction.</span></span> <span data-ttu-id="309eb-106">Эту функцию также можно использовать для трассировки родительских и дочерних событий.</span><span class="sxs-lookup"><span data-stu-id="309eb-106">You can also use this function to trace parent/child events.</span></span>

<span data-ttu-id="309eb-107">Перед вызовом функции [**трацеевентинстанце**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) необходимо сначала вызвать функцию [**креатетрацеинстанцеид**](/windows/win32/api/evntrace/nf-evntrace-createtraceinstanceid) , чтобы получить идентификатор транзакции.</span><span class="sxs-lookup"><span data-stu-id="309eb-107">Before calling the [**TraceEventInstance**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) function, you must first call the [**CreateTraceInstanceId**](/windows/win32/api/evntrace/nf-evntrace-createtraceinstanceid) function to obtain a transaction identifier.</span></span> <span data-ttu-id="309eb-108">Эта функция создает уникальный идентификатор транзакции и сопоставляет ее с зарегистрированным маркером GUID класса.</span><span class="sxs-lookup"><span data-stu-id="309eb-108">This function generates a unique transaction identifier, and maps it to a registered class GUID handle.</span></span> <span data-ttu-id="309eb-109">Дескрипторы идентификаторов GUID зарегистрированного класса доступны в элементах **регхандле** структур [**\_ \_ регистрации GUID трассировки**](/windows/win32/api/evntrace/ns-evntrace-trace_guid_registration) после вызова функции [**регистертрацегуидс**](/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa) .</span><span class="sxs-lookup"><span data-stu-id="309eb-109">The handles for registered class GUIDs are available in the **RegHandle** members of [**TRACE\_GUID\_REGISTRATION**](/windows/win32/api/evntrace/ns-evntrace-trace_guid_registration) structures, after calling the [**RegisterTraceGuids**](/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa) function.</span></span> <span data-ttu-id="309eb-110">Идентификатор транзакции помещается в элемент **InstanceId** структуры событий, которая передается функции **креатетрацеинстанцеид** . [**\_ \_**](/windows/win32/api/evntrace/ns-evntrace-event_instance_info)</span><span class="sxs-lookup"><span data-stu-id="309eb-110">The transaction identifier is placed in the **InstanceId** member of an [**EVENT\_INSTANCE\_INFO**](/windows/win32/api/evntrace/ns-evntrace-event_instance_info) structure that you pass to the **CreateTraceInstanceId** function.</span></span>

<span data-ttu-id="309eb-111">Структура [**\_ \_ заголовка экземпляра события**](/windows/win32/api/evntrace/ns-evntrace-event_instance_header) , передаваемая функции [**трацеевентинстанце**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) , аналогична структуре [**\_ \_ заголовка трассировки событий**](/windows/win32/api/evntrace/ns-evntrace-event_trace_header) (см. [события трассировки](tracing-events.md)), за исключением того, что она содержит дополнительные сведения об экземплярах и не содержит элемент **GUID** .</span><span class="sxs-lookup"><span data-stu-id="309eb-111">The [**EVENT\_INSTANCE\_HEADER**](/windows/win32/api/evntrace/ns-evntrace-event_instance_header) structure that is passed to the [**TraceEventInstance**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) function is similar to the [**EVENT\_TRACE\_HEADER**](/windows/win32/api/evntrace/ns-evntrace-event_trace_header) structure (see [Tracing Events](tracing-events.md)), except that it contains additional information relating to instances, and does not contain a **Guid** member.</span></span>

<span data-ttu-id="309eb-112">Экземпляры событий можно использовать для установления иерархических отношений между событиями.</span><span class="sxs-lookup"><span data-stu-id="309eb-112">Event instances can be used to establish a hierarchical relationship between events.</span></span> <span data-ttu-id="309eb-113">Функция [**трацеевентинстанце**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) принимает сведения, относящиеся к экземпляру, от двух экземпляров событий.</span><span class="sxs-lookup"><span data-stu-id="309eb-113">The [**TraceEventInstance**](/windows/win32/api/evntrace/nf-evntrace-traceeventinstance) function accepts instance-specific information from two event instances.</span></span> <span data-ttu-id="309eb-114">Параметр *пинстинфо* указывает на [**\_ \_ информационную**](/windows/win32/api/evntrace/ns-evntrace-event_instance_info) структуру экземпляра события, а параметр *ппарентинстинфо* указывает на структуру **\_ \_ сведений об экземпляре события** родительского экземпляра события.</span><span class="sxs-lookup"><span data-stu-id="309eb-114">The *pInstInfo* parameter points to the [**EVENT\_INSTANCE\_INFO**](/windows/win32/api/evntrace/ns-evntrace-event_instance_info) structure of the event instance, and the *pParentInstInfo* parameter points to the **EVENT\_INSTANCE\_INFO** structure of a parent event instance.</span></span> <span data-ttu-id="309eb-115">Определение экземпляра события "Parent" определено приложением; родительским может быть любой экземпляр, который уже был создан.</span><span class="sxs-lookup"><span data-stu-id="309eb-115">The definition of a "parent" event instance is application-defined; the parent can be any instance that has already been generated.</span></span>

 

 
