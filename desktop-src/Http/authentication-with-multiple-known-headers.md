---
title: Проверка подлинности с несколькими известными заголовками
description: Структура HTTP с \_ несколькими \_ известными \_ заголовками позволяет серверным приложениям передавать клиенту несколько проблем проверки подлинности.
ms.assetid: d517fd61-9547-4e1c-b0fd-1eb3d0098db2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8afbce3c2a41ea143003723acebc7eb83dc463d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105681446"
---
# <a name="authentication-with-multiple-known-headers"></a><span data-ttu-id="d9837-103">Проверка подлинности с несколькими известными заголовками</span><span class="sxs-lookup"><span data-stu-id="d9837-103">Authentication with Multiple Known Headers</span></span>

<span data-ttu-id="d9837-104">Структура [**HTTP с \_ несколькими \_ известными \_ заголовками**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) позволяет серверным приложениям передавать клиенту несколько проблем проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d9837-104">The [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) structure enables server applications to send multiple authentication challenges to the client.</span></span> <span data-ttu-id="d9837-105">Приложения могут выключать клиент с помощью одной схемы проверки подлинности, предоставляя тип перечисления **хттфеадерввваусентикате** в элементе **кновнхеадерс** структуры [**\_ \_ заголовков HTTP-ответа**](/windows/desktop/api/Http/ns-http-http_response_headers) , содержащейся в [**HTTP- \_ ответе**](http-response.md).</span><span class="sxs-lookup"><span data-stu-id="d9837-105">Applications can challenge the client with a single authentication scheme by supplying the **HttpHeaderWwwAuthenticate** enumeration type in the **KnownHeaders** member of the [**HTTP\_RESPONSE\_HEADERS**](/windows/desktop/api/Http/ns-http-http_response_headers) structure contained in [**HTTP\_RESPONSE**](http-response.md).</span></span> <span data-ttu-id="d9837-106">Однако при проблемах с несколькими схемами проверки подлинности для сервера приложение использует структуру [**HTTP с \_ несколькими \_ известными \_ заголовками**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) для предоставления типов проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d9837-106">However, when the server challenges with multiple authentication schemes, the application uses the [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) structure to provide the authentication types.</span></span>

<span data-ttu-id="d9837-107">Если флаг **\_ \_ \_ сохранения флага \_ \_ для HTTP-ответа** установлен, HTTP отправляет заголовки проверки подлинности в указанном порядке.</span><span class="sxs-lookup"><span data-stu-id="d9837-107">When the **HTTP\_RESPONSE\_INFO\_FLAGS\_PRESERVE\_ORDER** flag is present, HTTP sends the authentication headers in the specified order.</span></span> <span data-ttu-id="d9837-108">Если этот флаг отсутствует, HTTP упорядочивает схемы проверки подлинности от самого надежного к слабому, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="d9837-108">If the flag is not present, HTTP orders the authentication schemes from strongest to weakest as follows:</span></span>

1.  <span data-ttu-id="d9837-109">Согласование</span><span class="sxs-lookup"><span data-stu-id="d9837-109">Negotiate</span></span>
2.  <span data-ttu-id="d9837-110">NTLM</span><span class="sxs-lookup"><span data-stu-id="d9837-110">NTLM</span></span>
3.  <span data-ttu-id="d9837-111">Digest (дайджест)</span><span class="sxs-lookup"><span data-stu-id="d9837-111">Digest</span></span>
4.  <span data-ttu-id="d9837-112">Basic</span><span class="sxs-lookup"><span data-stu-id="d9837-112">Basic</span></span>

<span data-ttu-id="d9837-113">Если схема проверки подлинности не является ни одной из этих схем, в приложении необходимо указать флаг **\_ \_ \_ сохранения флага \_ \_ для HTTP-ответа** .</span><span class="sxs-lookup"><span data-stu-id="d9837-113">If the authentication scheme is not one of these schemes, the application must specify the **HTTP\_RESPONSE\_INFO\_FLAGS\_PRESERVE\_ORDER** flag.</span></span>

<span data-ttu-id="d9837-114">Элемент **кновнхеадер** с [**\_ несколькими \_ известными \_ заголовками HTTP**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) указывает на массив [**известных структур \_ \_ заголовков HTTP**](/windows/desktop/api/Http/ns-http-http_known_header) .</span><span class="sxs-lookup"><span data-stu-id="d9837-114">The **KnownHeader** member of [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) points to an array of [**HTTP\_KNOWN\_HEADER**](/windows/desktop/api/Http/ns-http-http_known_header) structures.</span></span> <span data-ttu-id="d9837-115">Элемент **праввалуе** в структуре **\_ известных \_ заголовков HTTP** должен указывать на строку, указывающую имя схемы.</span><span class="sxs-lookup"><span data-stu-id="d9837-115">The **pRawValue** member of the **HTTP\_KNOWN\_HEADER** structure must point to a string that specifies the scheme name.</span></span> <span data-ttu-id="d9837-116">HTTP анализирует строку для определения схемы и выполняет одно из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="d9837-116">HTTP parses the string to determine the scheme and performs one of the following actions:</span></span>

-   <span data-ttu-id="d9837-117">Если строка содержит неизвестный тип проверки подлинности или если тип проверки подлинности не включен в группе конфигурации (либо в группе URL-адресов, либо в сеансе сервера), связанном с запросом, API сервера HTTP добавляет строку в **праввалуе** в заголовок WWW-Authenticate.</span><span class="sxs-lookup"><span data-stu-id="d9837-117">If the string contains an unknown authentication type, or if the authentication type is not enabled on the configuration group (either the URL group or server session) associated with the request, the HTTP Server API appends the string in **pRawValue** to the WWW-Authenticate header.</span></span> <span data-ttu-id="d9837-118">Например, если в приложении указана неподдерживаемая схема проверки подлинности, а **праввалуе** содержит строку "кустомаусстринг", в заголовок проверки подлинности добавляется следующий текст:</span><span class="sxs-lookup"><span data-stu-id="d9837-118">For example, if the application specifies an unsupported authentication scheme, and **pRawValue** contains the string "CustomAuthString", the following text is appended to the authentication header:</span></span>

    <span data-ttu-id="d9837-119">WWW-Authenticate: Кустомауссчемекрлф</span><span class="sxs-lookup"><span data-stu-id="d9837-119">WWW-Authenticate: CustomAuthSchemeCRLF</span></span>

    <span data-ttu-id="d9837-120">Если в приложении не включена обычная проверка подлинности и **праввалуе** содержит строку "Basic realm =" басикреалм "", заголовок проверки подлинности содержит следующий текст:</span><span class="sxs-lookup"><span data-stu-id="d9837-120">If the application does not have Basic authentication enabled, and **pRawValue** contains the string "Basic realm="BasicRealm"", the authentication header contains the following text:</span></span>

    <span data-ttu-id="d9837-121">WWW-Authenticate: обычная область = "Басикреалм"</span><span class="sxs-lookup"><span data-stu-id="d9837-121">WWW-Authenticate: Basic realm="BasicRealm"</span></span>

-   <span data-ttu-id="d9837-122">Если строка содержит известный тип проверки подлинности и имеется в группе конфигурации (либо в группе URL-адресов, либо в сеансе сервера), связанном с запросом, то API сервера HTTP создает заголовок WWW-Authenticate.</span><span class="sxs-lookup"><span data-stu-id="d9837-122">If the string contains a known authentication type and is present on the configuration group (either the URL group or the server session) associated with the request, the HTTP Server API generates the WWW-Authenticate header.</span></span> <span data-ttu-id="d9837-123">Например, если строка, указанная в **праввалуе** , имеет значение Digest, а в сеансе сервера включена функция дайджеста, API-интерфейс сервера HTTP добавляет следующий текст в заголовок Authentication:</span><span class="sxs-lookup"><span data-stu-id="d9837-123">For example if the string specified in **pRawValue** is "Digest", and Digest is enabled on the server session, the HTTP Server API appends the following text to the authentication header:</span></span>

    <span data-ttu-id="d9837-124">WWW-Authenticate: дайджест realm = " testrealm@host.com "</span><span class="sxs-lookup"><span data-stu-id="d9837-124">WWW-Authenticate: Digest realm="testrealm@host.com"</span></span>

<span data-ttu-id="d9837-125">Если схема в **праввалуе** члене [**\_ известного \_ заголовка HTTP**](/windows/desktop/api/Http/ns-http-http_known_header) является Negotiate или NTLM, то достаточно имени схемы проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d9837-125">If the scheme in the **pRawValue** member of [**HTTP\_KNOWN\_HEADER**](/windows/desktop/api/Http/ns-http-http_known_header) is Negotiate or NTLM, the authentication scheme name is sufficient.</span></span> <span data-ttu-id="d9837-126">Если указана базовая схема, имя области добавляется к имени схемы; приложению не нужно указывать имя области в **праввалуе**.</span><span class="sxs-lookup"><span data-stu-id="d9837-126">If the specified scheme is Basic, the realm name is appended to the scheme name; the application doesn't need to supply the realm name in **pRawValue**.</span></span> <span data-ttu-id="d9837-127">Если указанная схема является дайджестом, HTTP вызывает [**AcceptSecurityContext**](../SecAuthN/acceptsecuritycontext--general.md) для создания запроса, который добавляется к имени схемы.</span><span class="sxs-lookup"><span data-stu-id="d9837-127">If the specified scheme is Digest, HTTP calls [**AcceptSecurityContext**](../SecAuthN/acceptsecuritycontext--general.md) to generate the challenge that is appended to the scheme name.</span></span> <span data-ttu-id="d9837-128">Параметры для базовой схемы (области) и дайджеста (доменного имени) получаются из соответствующих сведений о проверке подлинности группы конфигурации.</span><span class="sxs-lookup"><span data-stu-id="d9837-128">The parameters for Basic (realm) and Digest (realm and domain name) scheme are obtained from the corresponding configuration group authentication information.</span></span>

<span data-ttu-id="d9837-129">Когда приложение отправляет клиенту несколько проблем проверки подлинности в неизвестных заголовках запроса, API сервера HTTP отправляет их клиенту без вмешательства пользователя.</span><span class="sxs-lookup"><span data-stu-id="d9837-129">When the application sends multiple authentication challenges to the client in Unknown request headers, the HTTP Server API sends these to the client without intervention.</span></span> <span data-ttu-id="d9837-130">Однако это использование не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="d9837-130">However this usage is not recommended.</span></span>

 

 




