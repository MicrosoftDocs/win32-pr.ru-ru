---
title: Именованная очередь запросов
description: Именованная очередь запросов
ms.assetid: d0686a9b-fc3d-4b69-b083-d04b35ce5b50
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f4aca045f84fe9f9e4b57365ba8831456f2dc1ad
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104332088"
---
# <a name="named-request-queue"></a><span data-ttu-id="cb288-103">Именованная очередь запросов</span><span class="sxs-lookup"><span data-stu-id="cb288-103">Named Request Queue</span></span>

<span data-ttu-id="cb288-104">API-интерфейс версии 2,0 сервера HTTP с именем "очередь запросов" позволяет использовать несколько приложений, работающих в рамках отдельных процессов и учетных записей пользователей, доступ к очереди запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-104">The HTTP Server version 2.0 API named request queue feature allows multiple applications, operating under separate processes and user accounts, access to the request queue.</span></span> <span data-ttu-id="cb288-105">Очередь запросов открывается по имени и защищена с помощью списков управления доступом (ACL), чтобы гарантировать, что приложения не смогут получить доступ к другим данным.</span><span class="sxs-lookup"><span data-stu-id="cb288-105">The request queue is opened by name, and secured using Access Control Lists (ACLs) to ensure that applications are not able to access each others data.</span></span> <span data-ttu-id="cb288-106">Один процесс создает очередь запросов и предоставляет другим процессам разрешение на использование очереди запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-106">A single process creates the request queue, and grants permission to other processes to use the request queue.</span></span> <span data-ttu-id="cb288-107">Поэтому другие процессы на компьютере обращаются к очереди запросов с минимальными привилегиями, необходимыми для запросов на обслуживание.</span><span class="sxs-lookup"><span data-stu-id="cb288-107">Thus, other processes on the computer access the request queue with the least privilege necessary to service requests.</span></span> <span data-ttu-id="cb288-108">Повреждение службы HTTP может повредиться из-за уязвимостей в коде стороннего разработчика, если приложения выполняются с минимальными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="cb288-108">Possible damage to the HTTP service, due to vulnerabilities in third party code, is minimized when applications are running under least privileges.</span></span>

<span data-ttu-id="cb288-109">Именованная очередь запросов создается с помощью функции [**хттпкреатерекуесткуеуе**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) .</span><span class="sxs-lookup"><span data-stu-id="cb288-109">The named request queue is created with the [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) function.</span></span> <span data-ttu-id="cb288-110">При создании очереди запросов приложение указывает список ACL в параметре *псекуритяттрибуте* .</span><span class="sxs-lookup"><span data-stu-id="cb288-110">When the request queue is created, the application specifies the ACL in the *pSecurityAttribute* parameter.</span></span> <span data-ttu-id="cb288-111">Список управления доступом, который может быть установлен только при создании очереди запросов, позволяет рабочим процессам открывать очередь запросов, получать запросы и отправлять ответы.</span><span class="sxs-lookup"><span data-stu-id="cb288-111">The ACL, which can only be set when the request queue is created, allows worker processes to open the request queue, receive requests, and send responses.</span></span> <span data-ttu-id="cb288-112">По умолчанию процессы не могут открывать очередь запросов, если только им не было предоставлено разрешение в списке управления доступом.</span><span class="sxs-lookup"><span data-stu-id="cb288-112">By default, processes are not allowed to open a request queue unless they have been granted permission in the ACL.</span></span> <span data-ttu-id="cb288-113">Для создания очереди запросов приложениям не требуются права администратора.</span><span class="sxs-lookup"><span data-stu-id="cb288-113">Applications do not require administrative privileges to create the request queue.</span></span>

<span data-ttu-id="cb288-114">Для открытия очереди запросов необходимо создать очередь запросов с именем, указанным в параметре *pName* параметра [**хттпкреатерекуесткуеуе**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) , чтобы другие процессы открыли очередь запроса.</span><span class="sxs-lookup"><span data-stu-id="cb288-114">The request queue must be created with a name specified in the *pName* parameter of [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) for other processes to open the request queue.</span></span> <span data-ttu-id="cb288-115">Если *pName* имеет **значение NULL**, создается неименованная очередь запросов, и другие процессы не могут его открыть.</span><span class="sxs-lookup"><span data-stu-id="cb288-115">If *pName* is **NULL**, an unnamed request queue is created and no other processes can open it.</span></span>

## <a name="creator-and-controller-processes"></a><span data-ttu-id="cb288-116">Процессы создателя и контроллера</span><span class="sxs-lookup"><span data-stu-id="cb288-116">Creator and Controller Processes</span></span>

<span data-ttu-id="cb288-117">После создания очереди запросов приложение может открыть его как процесс контроллера или процесс создания.</span><span class="sxs-lookup"><span data-stu-id="cb288-117">When the request queue is created, the application can open it as a controller process or a creator process.</span></span> <span data-ttu-id="cb288-118">Контроллер и создатель процессов выполняют роль администраторов для очереди запросов, но контроллер не выполняет операции ввода-вывода на нем.</span><span class="sxs-lookup"><span data-stu-id="cb288-118">The controller and creator processes both act as administrators for the request queue, but the controller does not perform I/O operations on it.</span></span> <span data-ttu-id="cb288-119">Приложение указывает, что это процесс контроллера, когда очередь запросов создается путем указания **\_ \_ \_ \_ \_ контроллера флага http Create Request** в параметре *flags* параметра [**хттпкреатерекуесткуеуе**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue).</span><span class="sxs-lookup"><span data-stu-id="cb288-119">The application indicates that it is a controller process when the request queue is created by specifying **HTTP\_CREATE\_REQUEST\_QUEUE\_FLAG\_CONTROLLER** in the *Flags* parameter of [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue).</span></span> <span data-ttu-id="cb288-120">Если флаг **\_ \_ \_ \_ \_ контроллера флага http-запроса на создание очереди** не установлен, приложение является процессом создателя.</span><span class="sxs-lookup"><span data-stu-id="cb288-120">If the **HTTP\_CREATE\_REQUEST\_QUEUE\_FLAG\_CONTROLLER** flag is not set, the application is a creator process.</span></span>

<span data-ttu-id="cb288-121">В следующем списке содержатся задачи, выполняемые процессом контроллера и процессом создателя:</span><span class="sxs-lookup"><span data-stu-id="cb288-121">The following list contains tasks performed by the controller process and the creator process:</span></span>

-   <span data-ttu-id="cb288-122">Создайте очередь запросов и укажите имя.</span><span class="sxs-lookup"><span data-stu-id="cb288-122">Create the request queue and specify the name.</span></span>
-   <span data-ttu-id="cb288-123">Настройте очередь запросов с помощью функции [**хттпсетрекуесткуеуепроперти**](/windows/desktop/api/Http/nf-http-httpsetrequestqueueproperty) .</span><span class="sxs-lookup"><span data-stu-id="cb288-123">Configure the request queue using the [**HttpSetRequestQueueProperty**](/windows/desktop/api/Http/nf-http-httpsetrequestqueueproperty) function.</span></span>
-   <span data-ttu-id="cb288-124">Запросите параметры конфигурации очереди запросов с помощью функции [**хттпкуерирекуесткуеуепроперти**](/windows/desktop/api/Http/nf-http-httpqueryrequestqueueproperty) .</span><span class="sxs-lookup"><span data-stu-id="cb288-124">Query the request queue configuration parameters using the [**HttpQueryRequestQueueProperty**](/windows/desktop/api/Http/nf-http-httpqueryrequestqueueproperty) function.</span></span>
-   <span data-ttu-id="cb288-125">Создайте группы URL-адресов и связывает их с очередью запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-125">Create URL Groups and associates them with a request queue.</span></span>
-   <span data-ttu-id="cb288-126">Задайте список управления доступом, указывающий рабочие процессы, которым разрешено принимать операции ввода-вывода в очереди запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-126">Set the ACL specifying the worker processes that are allowed to receive I/O on the request queue.</span></span>
-   <span data-ttu-id="cb288-127">Вызовите [**хттпваитфордемандстарт**](/windows/desktop/api/Http/nf-http-httpwaitfordemandstart) , чтобы отложить создание экземпляра рабочих процессов до тех пор, пока первый запрос не поступит в очередь запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-127">Call [**HttpWaitForDemandStart**](/windows/desktop/api/Http/nf-http-httpwaitfordemandstart) to delay the instantiation of worker processes until the first request arrives on the request queue.</span></span>

<span data-ttu-id="cb288-128">В дополнение к этим задачам процесс создания также может выполнять операции ввода-вывода в очереди запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-128">In addition to these tasks, the creator process can also perform I/O operations on the request queue.</span></span>

## <a name="worker-processes"></a><span data-ttu-id="cb288-129">Рабочие процессы</span><span class="sxs-lookup"><span data-stu-id="cb288-129">Worker Processes</span></span>

<span data-ttu-id="cb288-130">Рабочий процесс может открыть существующую очередь запросов, только если им предоставлен доступ к ней в списке ACL.</span><span class="sxs-lookup"><span data-stu-id="cb288-130">A worker process can open an existing request queue only if they have been granted access to it in the ACL.</span></span> <span data-ttu-id="cb288-131">Рабочие процессы, работающие с минимальными привилегиями, могут открыть очередь запросов и выполнить операции ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="cb288-131">Worker processes operating under least privileges can open a request queue and perform I/O on it.</span></span> <span data-ttu-id="cb288-132">Приложения открывают существующую очередь запросов, вызывая [**хттпкреатерекуесткуеуе**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) с **\_ \_ флагом HTTP Create Request \_ очереди, \_ \_ открытым \_** в параметре *flags* , и именем очереди запросов в параметре *pName* .</span><span class="sxs-lookup"><span data-stu-id="cb288-132">Applications open an existing request queue by calling [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) with the **HTTP\_CREATE\_REQUEST\_QUEUE\_FLAG\_OPEN\_EXISTING** in the *Flags* parameter, and the name of the request queue in the *pName* parameter.</span></span>

<span data-ttu-id="cb288-133">Рабочий процесс выполняет следующие функции:</span><span class="sxs-lookup"><span data-stu-id="cb288-133">The worker process performs the following functions:</span></span>

-   <span data-ttu-id="cb288-134">Получение запросов и отправка ответов в очередь запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-134">Receive requests and send responses on the request queue.</span></span>
-   <span data-ttu-id="cb288-135">Открытие существующей очереди запросов по имени.</span><span class="sxs-lookup"><span data-stu-id="cb288-135">Open an existing request queue by name.</span></span> <span data-ttu-id="cb288-136">Невозможно использовать для настройки очереди запросов обработчик запросов, возвращаемый в рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="cb288-136">The handle to the request queue returned to the worker process cannot be used to configure the request queue.</span></span>
-   <span data-ttu-id="cb288-137">Запросите параметры конфигурации очереди запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-137">Query the request queue configuration parameters.</span></span>

<span data-ttu-id="cb288-138">На следующей диаграмме показана модель рабочего процесса для очередей запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-138">The following diagram shows the worker process model for request queues.</span></span> <span data-ttu-id="cb288-139">Очередь запросов может иметь несколько рабочих процессов, обрабатывающих операции ввода-вывода, и один процесс создателя, который настраивает очередь запросов.</span><span class="sxs-lookup"><span data-stu-id="cb288-139">The request queue can have several worker processes that process I/O, and one creator processes that configures the request queue.</span></span>

![модель рабочего процесса для очередей запросов](images/namedrequestqueue.png)

 

 




