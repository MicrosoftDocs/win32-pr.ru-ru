---
title: Проверка подлинности (API сервера HTTP)
description: Начиная с версии 2,0 API сервера HTTP выполняет проверку подлинности на стороне сервера для приложения.
ms.assetid: e8e41e8e-1b10-4747-b18e-763e0752ade4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 16d523df90861c83a45f67811edad243ceee5165
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104414517"
---
# <a name="authentication-http-server-api"></a><span data-ttu-id="29b22-103">Проверка подлинности (API сервера HTTP)</span><span class="sxs-lookup"><span data-stu-id="29b22-103">Authentication (HTTP Server API)</span></span>

<span data-ttu-id="29b22-104">Некоторым серверным приложениям требуется проверка подлинности клиента для доступа к ресурсам и HTTP-запросам службы.</span><span class="sxs-lookup"><span data-stu-id="29b22-104">Some server applications require client authentication to access resources and service HTTP requests.</span></span> <span data-ttu-id="29b22-105">Начиная с версии 2,0 API сервера HTTP выполняет проверку подлинности на стороне сервера для приложения.</span><span class="sxs-lookup"><span data-stu-id="29b22-105">Starting with version 2.0, the HTTP Server API performs server side authentication for the application.</span></span> <span data-ttu-id="29b22-106">В API сервера HTTP версии 1,0 серверному приложению пришлось реализовать собственную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-106">In the HTTP Server API version 1.0, the server application had to implement its own authentication.</span></span> <span data-ttu-id="29b22-107">Ниже перечислены некоторые преимущества проверки подлинности, выполняемые API-сервером HTTP.</span><span class="sxs-lookup"><span data-stu-id="29b22-107">Some advantages of authentication performed by the HTTP Server API include:</span></span>

-   <span data-ttu-id="29b22-108">Приложения могут работать с низким уровнем привилегий, тем самым уменьшая риски безопасности.</span><span class="sxs-lookup"><span data-stu-id="29b22-108">Applications can run under low privileges, thus reducing security risks.</span></span>
-   <span data-ttu-id="29b22-109">Проверка подлинности выполняется в режиме ядра, тем самым уменьшая переходы из пользовательского режима в режим ядра во время проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-109">Authentication is performed in kernel mode, thus reducing transitions from user mode to kernel mode during authentication.</span></span>
-   <span data-ttu-id="29b22-110">Проверка подлинности, выполненная в режиме ядра, позволяет серверным приложениям работать с разными учетными записями пользователей.</span><span class="sxs-lookup"><span data-stu-id="29b22-110">Authentication performed in kernel mode allows server applications to run on different user accounts.</span></span> <span data-ttu-id="29b22-111">В версии 1,0 все приложения на компьютере должны работать под одной и той же учетной записью пользователя для проверки подлинности в имени участника-службы (SPN).</span><span class="sxs-lookup"><span data-stu-id="29b22-111">In version 1.0, all applications on the machine must run under the same user account to authenticate on the Service Principle Name (SPN).</span></span>
-   <span data-ttu-id="29b22-112">Подтверждение проверки подлинности NTLM не сбрасывается, если рабочий процесс перезапускается в процессе подтверждения.</span><span class="sxs-lookup"><span data-stu-id="29b22-112">The NTLM authentication handshake is not reset if a worker process is recycled while the handshake is in process.</span></span>

<span data-ttu-id="29b22-113">Чтобы воспользоваться преимуществами проверки подлинности версии 2,0, приложение включит схемы проверки подлинности, применяемые API-сервером HTTP, к URL-адресам, для которых приложение зарегистрировано.</span><span class="sxs-lookup"><span data-stu-id="29b22-113">To take advantage of the version 2.0 authentication, the application enables the authentication schemes that the HTTP Server API applies to the URLs for which the application has registered.</span></span> <span data-ttu-id="29b22-114">Проверку подлинности можно включить в сеансе сервера или группе URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="29b22-114">Authentication can be enabled on the server session or URL group.</span></span> <span data-ttu-id="29b22-115">Группа URL-адресов наследует схемы проверки подлинности, включенные сеансом сервера, если ни одна из них не задана в группе URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="29b22-115">The URL group inherits the authentication schemes enabled by the server session if none are set on the URL group.</span></span> <span data-ttu-id="29b22-116">API сервера HTTP поддерживает следующие схемы:</span><span class="sxs-lookup"><span data-stu-id="29b22-116">The HTTP Server API supports the following schemes:</span></span>

-   <span data-ttu-id="29b22-117">Согласование</span><span class="sxs-lookup"><span data-stu-id="29b22-117">Negotiate</span></span>
-   <span data-ttu-id="29b22-118">NTLM</span><span class="sxs-lookup"><span data-stu-id="29b22-118">NTLM</span></span>
-   <span data-ttu-id="29b22-119">Digest (дайджест)</span><span class="sxs-lookup"><span data-stu-id="29b22-119">Digest</span></span>
-   <span data-ttu-id="29b22-120">Basic</span><span class="sxs-lookup"><span data-stu-id="29b22-120">Basic</span></span>

<span data-ttu-id="29b22-121">Серверное приложение также может реализовывать схемы проверки подлинности, не поддерживаемые API-сервером HTTP.</span><span class="sxs-lookup"><span data-stu-id="29b22-121">The server application can also implement authentication schemes not supported by the HTTP Server API.</span></span> <span data-ttu-id="29b22-122">API сервера HTTP отправляет запросы в приложение для схем проверки подлинности, которые не поддерживаются, или для схем, которые не были включены приложением.</span><span class="sxs-lookup"><span data-stu-id="29b22-122">The HTTP Server API sends requests to the application for authentication schemes that are not supported, or for schemes that have not been enabled by the application.</span></span>

### <a name="enabling-authentication"></a><span data-ttu-id="29b22-123">Включение аутентификации</span><span class="sxs-lookup"><span data-stu-id="29b22-123">Enabling Authentication</span></span>

<span data-ttu-id="29b22-124">Серверное приложение включает и настраивает проверку подлинности в сеансе сервера или группе URL-адресов с помощью функций [**хттпсетсерверсессионпроперти**](/windows/desktop/api/Http/nf-http-httpsetserversessionproperty) или [**хттпсетурлграуппроперти**](/windows/desktop/api/Http/nf-http-httpseturlgroupproperty) следующим образом:</span><span class="sxs-lookup"><span data-stu-id="29b22-124">The server application enables and configures authentication on the server session or URL group with the [**HttpSetServerSessionProperty**](/windows/desktop/api/Http/nf-http-httpsetserversessionproperty) or [**HttpSetUrlGroupProperty**](/windows/desktop/api/Http/nf-http-httpseturlgroupproperty) functions as follows:</span></span>

1.  <span data-ttu-id="29b22-125">Приложение включает проверку подлинности, указывая **хттпсервераусентикатионпроперти** в параметре *Property* [**хттпсетсерверсессионпроперти**](/windows/desktop/api/Http/nf-http-httpsetserversessionproperty) или [**хттпсетурлграуппроперти**](/windows/desktop/api/Http/nf-http-httpseturlgroupproperty).</span><span class="sxs-lookup"><span data-stu-id="29b22-125">The application enables authentication by specifying **HttpServerAuthenticationProperty** in the *Property* parameter of [**HttpSetServerSessionProperty**](/windows/desktop/api/Http/nf-http-httpsetserversessionproperty) or [**HttpSetUrlGroupProperty**](/windows/desktop/api/Http/nf-http-httpseturlgroupproperty).</span></span>
2.  <span data-ttu-id="29b22-126">Приложение задает параметры конфигурации в структуре [**\_ \_ \_ сведений о проверке подлинности HTTP-сервера**](/windows/desktop/api/Http/ns-http-http_server_authentication_info) в параметре *ппропертинформатион* [**хттпсетсерверсессионпроперти**](/windows/desktop/api/Http/nf-http-httpsetserversessionproperty) или [**хттпсетурлграуппроперти**](/windows/desktop/api/Http/nf-http-httpseturlgroupproperty).</span><span class="sxs-lookup"><span data-stu-id="29b22-126">The application specifies the configuration parameters in the [**HTTP\_SERVER\_AUTHENTICATION\_INFO**](/windows/desktop/api/Http/ns-http-http_server_authentication_info) structure in the *pPropertyInformation* parameter of [**HttpSetServerSessionProperty**](/windows/desktop/api/Http/nf-http-httpsetserversessionproperty) or [**HttpSetUrlGroupProperty**](/windows/desktop/api/Http/nf-http-httpseturlgroupproperty).</span></span> <span data-ttu-id="29b22-127">В приложении указываются включенные схемы проверки подлинности, отключено ли кэширование учетных данных NTLM, а также предоставляются основные и дайджест-параметры в структуре **\_ \_ \_ сведений о проверке подлинности сервера HTTP** .</span><span class="sxs-lookup"><span data-stu-id="29b22-127">The application specifies the authentication schemes enabled, whether NTLM credential caching is disabled, and supplies the Basic and Digest parameters in the **HTTP\_SERVER\_AUTHENTICATION\_INFO** structure.</span></span>

### <a name="authentication-procedure"></a><span data-ttu-id="29b22-128">Процедура проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="29b22-128">Authentication Procedure</span></span>

<span data-ttu-id="29b22-129">Чтобы инициировать проверку подлинности HTTP-сервера, приложение включает свойство проверки подлинности, прежде чем первый запрос поступит в очередь запросов.</span><span class="sxs-lookup"><span data-stu-id="29b22-129">To initiate HTTP Server authentication, the application enables the authentication property before the first request arrives on the request queue.</span></span> <span data-ttu-id="29b22-130">Следующие шаги являются стандартным потоком обработки для проверки подлинности запроса.</span><span class="sxs-lookup"><span data-stu-id="29b22-130">The following steps are the common processing flow for authenticating a request.</span></span>

1.  <span data-ttu-id="29b22-131">Приложение включает проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-131">The application enables authentication.</span></span> <span data-ttu-id="29b22-132">См. предыдущий раздел "Включение проверки подлинности".</span><span class="sxs-lookup"><span data-stu-id="29b22-132">See the preceding "Enabling Authentication" section.</span></span>
    > [!Note]  
    > <span data-ttu-id="29b22-133">Клиент отправляет запрос, не прошедший проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-133">The client sends an unauthenticated request.</span></span> <span data-ttu-id="29b22-134">API сервера HTTP передает запрос серверному приложению и позволяет ему создать первоначальную задачу 401.</span><span class="sxs-lookup"><span data-stu-id="29b22-134">The HTTP Server API passes the request to the server application and allows it to generate the initial 401 challenge.</span></span> <span data-ttu-id="29b22-135">API HTTP-сервера включает структуру данных [**HTTP- \_ запроса \_ AUTH \_**](/windows/desktop/api/Http/ns-http-http_request_auth_info) , внедренную в структуру [**HTTP- \_ запросов**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="29b22-135">The HTTP Server API includes the [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure embedded with the [**HTTP\_REQUEST**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85)) structure.</span></span> <span data-ttu-id="29b22-136">Элемент **аусстатус** указывает на **хттпаусстатуснотаусентикатед**</span><span class="sxs-lookup"><span data-stu-id="29b22-136">The **AuthStatus** member indicates **HttpAuthStatusNotAuthenticated**</span></span>

     

2.  <span data-ttu-id="29b22-137">Приложение проверяет элемент **аусстатус** структуры [**HTTP- \_ запроса \_ AUTH \_**](/windows/desktop/api/Http/ns-http-http_request_auth_info) , чтобы определить, прошел ли запрос проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-137">The application examines the **AuthStatus** member of the [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure to determine if the request has been authenticated.</span></span> <span data-ttu-id="29b22-138">Если запрос не прошел проверку подлинности, приложение может обслуживать запрос как анонимный или отправить первоначальный запрос проверки подлинности 401.</span><span class="sxs-lookup"><span data-stu-id="29b22-138">If the request has not been authenticated, the application can service the request as anonymous or send an initial 401 authentication challenge.</span></span>
3.  <span data-ttu-id="29b22-139">Если приложение обслуживает запрос как анонимное, оно обрабатывает запрос и отправляет окончательный ответ клиентскому приложению, как если бы проверка подлинности не была задействована.</span><span class="sxs-lookup"><span data-stu-id="29b22-139">If the application services the request as anonymous, it handles the request and sends the final response to the client application, just as if the authentication was not involved.</span></span>
4.  <span data-ttu-id="29b22-140">Если вместо этого приложение требует проверки подлинности, оно отправляет первоначальный запрос 401 с одним или несколькими WWW-Authenticate заголовками, которые указывают на доступные схемы для клиента.</span><span class="sxs-lookup"><span data-stu-id="29b22-140">If instead the application requires authentication, it sends the initial 401 challenge with one or more WWW-Authenticate headers indicating the available schemes to the client.</span></span> <span data-ttu-id="29b22-141">Приложение должно использовать структуру [**HTTP с \_ несколькими \_ известными \_ заголовками**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) для создания необходимого набора заголовков при отправке в ответ нескольких заголовков проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-141">The application should use the [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) structure to build the required set of headers when more than one authentication header is sent in the response.</span></span>
    > [!Note]
    >
    > <span data-ttu-id="29b22-142">Клиент повторно отправляет запрос с заголовком авторизации для схемы, выбранной из набора доступных схем, указанных серверным приложением в первом ответе 401.</span><span class="sxs-lookup"><span data-stu-id="29b22-142">The client resends the request with the authorization header for a scheme selected from the set of available schemes indicated by the server application in initial 401 response.</span></span>
    >
    > <span data-ttu-id="29b22-143">API сервера HTTP проверяет заголовок авторизации запроса на авторизацию, чтобы определить, включена ли схема.</span><span class="sxs-lookup"><span data-stu-id="29b22-143">The HTTP Server API examines the authorization request authorization header to determine if the scheme is enabled.</span></span> <span data-ttu-id="29b22-144">Если это так, то API сервера HTTP выполняет проверку подлинности и обрабатывает все промежуточные запросы и сообщения 401-Response, пока подтверждение проверки подлинности не будет завершено.</span><span class="sxs-lookup"><span data-stu-id="29b22-144">If it is, then the HTTP Server API performs authentication and handles all interim request/401-response exchanges, until the authentication handshake is finalized.</span></span>
    >
    > <span data-ttu-id="29b22-145">Когда API сервера HTTP завершает попытку проверки подлинности, он отправляет приложению запрос с результатами попытки проверки подлинности в структуре данных [**HTTP- \_ запроса \_ AUTH \_**](/windows/desktop/api/Http/ns-http-http_request_auth_info) , возвращаемой с запросом.</span><span class="sxs-lookup"><span data-stu-id="29b22-145">When The HTTP Server API completes the authentication attempt, it sends the request to the application with the results of the authentication attempt in the [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure that is returned with the request.</span></span> <span data-ttu-id="29b22-146">Если попытка проверки подлинности завершается неудачей по одной из следующих причин, HTTP-API сервера не передает запрос приложению:</span><span class="sxs-lookup"><span data-stu-id="29b22-146">If the authentication attempt fails for one of the following reasons, the HTTP Server API does not pass the request to the application:</span></span>
    >
    > -   <span data-ttu-id="29b22-147">В случае сбоя подтверждения подлинности из-за внутренней ошибки API сервера HTTP, такой как сбой выделения памяти, API сервера HTTP создает ответ 503 (служба недоступна) и отправляется обратно клиенту.</span><span class="sxs-lookup"><span data-stu-id="29b22-147">If the authentication handshake fails due to an internal HTTP Server API error such as a memory allocation failure, the HTTP Server API generates a 503 (service unavailable) response and sends back to client.</span></span>
    > -   <span data-ttu-id="29b22-148">Если обнаружен неправильно сформированный заголовок авторизации, например заголовок без имени схемы или неправильно сформированная кодировка Base64 для учетных данных клиента, то API-интерфейс сервера HTTP создает ответ 400 (недопустимый запрос) и отправляется обратно клиенту.</span><span class="sxs-lookup"><span data-stu-id="29b22-148">If a malformed authorization header such as a header without a scheme name, or malformed Base64 encoding of client credentials encountered, the HTTP Server API generates a 400 (bad request) response and sends back to client.</span></span>

     

5.  <span data-ttu-id="29b22-149">Серверное приложение просматривает элемент **аусстатус** структуры [**HTTP- \_ запроса \_ \_**](/windows/desktop/api/Http/ns-http-http_request_auth_info) Authentication, чтобы определить, была ли проверка подлинности успешной.</span><span class="sxs-lookup"><span data-stu-id="29b22-149">The server application examines the **AuthStatus** member of the [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure to determine if authentication was successful.</span></span> <span data-ttu-id="29b22-150">При сбое проверки подлинности API сервера HTTP включает ошибку, возвращенную из [AcceptSecurityContext](/previous-versions/windows/embedded/ms937012(v=msdn.10)) в члене **Секстатус** структуры **HTTP- \_ запроса \_ AUTH \_** .</span><span class="sxs-lookup"><span data-stu-id="29b22-150">When authentication fails, the HTTP Server API includes the error returned from [AcceptSecurityContext](/previous-versions/windows/embedded/ms937012(v=msdn.10)) in the **SecStatus** member of the **HTTP\_REQUEST\_AUTH\_INFO** structure.</span></span> <span data-ttu-id="29b22-151">Если попытка проверки подлинности завершается неудачей из-за неправильных учетных данных, приложение может создать еще одну ошибку 401 с нужным заголовком WWW-Authenticate или может обслужить запрос как анонимный.</span><span class="sxs-lookup"><span data-stu-id="29b22-151">If the authentication attempt fails due to bad credentials, the application can generate another 401 challenge with the desired WWW-Authenticate header, or may decided to service the request as anonymous.</span></span>
6.  <span data-ttu-id="29b22-152">Если проверка подлинности прошла успешно, приложение использует маркер, указанный в структуре [**\_ \_ \_ сведений о проверке подлинности HTTP-запроса**](/windows/desktop/api/Http/ns-http-http_request_auth_info) , для олицетворения клиента и доступа к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="29b22-152">If authentication was successful, the application uses the token provided in the [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure to impersonate the client and to access resources.</span></span> <span data-ttu-id="29b22-153">Маркер доступа, возвращаемый в приложение, является допустимым, пока идентификатор запроса является допустимым, что обычно происходит до тех пор, пока приложение не завершит ответ на запрос.</span><span class="sxs-lookup"><span data-stu-id="29b22-153">The access token handle returned to the application is valid as long as the request ID is valid, which is typically until the application completes the response to the request.</span></span> <span data-ttu-id="29b22-154">Однако срок действия маркера может истечь в течение этого периода, и приложению может потребоваться отправить клиенту еще одну проблему 401.</span><span class="sxs-lookup"><span data-stu-id="29b22-154">The token may, however, expire during this period and the application may need to send another 401 challenge to the client.</span></span>
7.  <span data-ttu-id="29b22-155">Приложение отправляет окончательный ответ в 200 ОК и должен закрыть маркер маркера доступа.</span><span class="sxs-lookup"><span data-stu-id="29b22-155">The application sends the final 200 OK response, and it must close the handle to the access token.</span></span>
    > [!Note]  
    > <span data-ttu-id="29b22-156">API сервера HTTP добавляет данные взаимной проверки подлинности к последнему ответу 200 ОК, если он был создан во время подтверждения подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-156">The HTTP Server API appends the mutual authentication data to the final 200 OK response, if one was generated during the authentication handshake.</span></span>

     

### <a name="ntlm-null-sessions"></a><span data-ttu-id="29b22-157">Сеансы NTLM NULL</span><span class="sxs-lookup"><span data-stu-id="29b22-157">NTLM NULL Sessions</span></span>

<span data-ttu-id="29b22-158">Обратите внимание, что сеанс NTLM NULL, указанный в окончательном контексте безопасности, не рассматривается как аутентифицированный.</span><span class="sxs-lookup"><span data-stu-id="29b22-158">Note that an NTLM NULL session indicated in the final security context, is not treated as authenticated.</span></span> <span data-ttu-id="29b22-159">В этом случае запрос отправляется в приложение с ошибкой Хттпаусстатусфаилуре в структуре [**\_ \_ \_ сведений о проверке подлинности HTTP-запроса**](/windows/desktop/api/Http/ns-http-http_request_auth_info) , и приложение может отправить еще одну задачу 401.</span><span class="sxs-lookup"><span data-stu-id="29b22-159">In this case, the request is sent to the application with an HttpAuthStatusFailure error in the [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure and the application can send another 401 challenge.</span></span>

### <a name="preemptive-authentication"></a><span data-ttu-id="29b22-160">Приоритетная аутентификация</span><span class="sxs-lookup"><span data-stu-id="29b22-160">Preemptive Authentication</span></span>

<span data-ttu-id="29b22-161">В соответствии с протоколом HTTP после того, как клиент установил проверку подлинности для ресурса, он может заранее отсылать соответствующий заголовок авторизации с последовательными запросами для ресурса, не дожидаясь запроса 401 с сервера.</span><span class="sxs-lookup"><span data-stu-id="29b22-161">According to the HTTP protocol, after the client has established authentication for a resource, it can preemptively send the corresponding authorization header with subsequent consecutive requests for the resource without waiting for a 401 challenge from the server.</span></span> <span data-ttu-id="29b22-162">Если схема, указанная в заголовке авторизации, по-прежнему включена приложением и поддерживается API HTTP-сервера, HTTP-сервер попытается выполнить проверку подлинности без отправки запроса приложению.</span><span class="sxs-lookup"><span data-stu-id="29b22-162">If the scheme indicated in the Authorization header is still enabled by the application and supported by the HTTP Server API, the HTTP Server attempts authentication without sending the request to the application.</span></span> <span data-ttu-id="29b22-163">Когда приложение получает этот тип запроса, прошедшего проверку подлинности, он может отказаться от запроса и повторно создать первоначальный запрос на 401 или службу, чтобы запрос прошел проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-163">When this type of authenticated request is received by the application, it can choose to discard the request and regenerate the initial 401 challenge or service the request as authenticated.</span></span>

### <a name="mutual-authentication"></a><span data-ttu-id="29b22-164">Взаимная проверка подлинности</span><span class="sxs-lookup"><span data-stu-id="29b22-164">Mutual Authentication</span></span>

<span data-ttu-id="29b22-165">Данные взаимной проверки подлинности создаются, когда схема согласования используется во время подтверждения и разрешается в Kerberos, а клиент запрашивает взаимную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="29b22-165">Mutual authentication data is generated when the negotiate scheme is used during handshake and it is resolved to Kerberos, and client has asked for mutual authentication.</span></span> <span data-ttu-id="29b22-166">Данные взаимной проверки подлинности автоматически вставляются API HTTP-сервера в последнем ответе 200 ОК, отправленном серверным приложением.</span><span class="sxs-lookup"><span data-stu-id="29b22-166">The mutual authentication data is automatically inserted by HTTP Server API in the final 200 OK response sent by the server application.</span></span> <span data-ttu-id="29b22-167">По умолчанию API сервера HTTP не передает данные взаимной проверки подлинности в серверное приложение, так как оно автоматически обрабатывает отправку.</span><span class="sxs-lookup"><span data-stu-id="29b22-167">By default HTTP Server API does not pass the Mutual authentication data to the server application, since it automatically handles the sending of it.</span></span> <span data-ttu-id="29b22-168">Однако если серверное приложение включает флаг Рецеивемутуалаус в структуре [**\_ \_ \_ сведений о проверке подлинности HTTP-сервера**](/windows/desktop/api/Http/ns-http-http_server_authentication_info) в конфигурации, то данные взаимной проверки подлинности передаются в приложение в структуре данных проверки подлинности [**HTTP- \_ запроса \_ \_**](/windows/desktop/api/Http/ns-http-http_request_auth_info) , внедренной в [**HTTP- \_ запрос**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85)), прошедший проверку</span><span class="sxs-lookup"><span data-stu-id="29b22-168">However, if server application enables the ReceiveMutualAuth flag in the [**HTTP\_SERVER\_AUTHENTICATION\_INFO**](/windows/desktop/api/Http/ns-http-http_server_authentication_info) structure in configuration, the mutual authentication data is passed to the application in [**HTTP\_REQUEST\_AUTH\_INFO**](/windows/desktop/api/Http/ns-http-http_request_auth_info) structure embedded with the authenticated [**HTTP\_REQUEST**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85)).</span></span> <span data-ttu-id="29b22-169">В этом случае приложение должно отправить данные взаимной проверки подлинности с завершающим ответом 200 ОК.</span><span class="sxs-lookup"><span data-stu-id="29b22-169">In this case application should send the mutual authentication data with the final 200 OK response.</span></span> <span data-ttu-id="29b22-170">Если один компьютер обслуживает несколько сайтов, все сайты компьютера используют для взаимной проверки подлинности учетные данные учетной записи локального компьютера в домене.</span><span class="sxs-lookup"><span data-stu-id="29b22-170">In the case where multiple sites are served by a single computer, all sites on the computer use the credentials for the Local Machine Account in the domain for mutual authentication.</span></span>

 

 
