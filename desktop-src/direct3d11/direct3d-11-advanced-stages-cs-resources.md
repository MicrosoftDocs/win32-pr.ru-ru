---
title: Новые типы ресурсов
description: В Direct3D 11 были добавлены несколько новых типов ресурсов.
ms.assetid: 597cc12f-dd0e-4603-b670-3f584f25e192
keywords:
- Буфер байтового адреса (обзор)
- Буфер чтения и записи (обзор)
- Структурированный буфер (обзор)
- Неупорядоченный буфер доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b7a75ec95917a5ee819126e42dce3117994574
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413297"
---
# <a name="new-resource-types"></a>Новые типы ресурсов

В Direct3D 11 были добавлены несколько новых типов ресурсов.

-   [Буферы чтения и записи и текстуры](#readwrite-buffers-and-textures)
-   [Структурированный буфер](#structured-buffer)
-   [Буфер байтового адреса](#byte-address-buffer)
-   [Неупорядоченный буфер или текстура доступа](#unordered-access-buffer-or-texture)
    -   [Добавление и использование буфера](#append-and-consume-buffer)
-   [См. также](#related-topics)

## <a name="readwrite-buffers-and-textures"></a>Буферы чтения и записи и текстуры

Ресурсы Shader Model 4 доступны только для чтения. В модели шейдеров 5 реализован новый соответствующий набор ресурсов для чтения и записи:

-   [рвбуффер](/windows/desktop/direct3dhlsl/sm5-object-rwbuffer)
-   [RWTexture1D](/windows/desktop/direct3dhlsl/sm5-object-rwtexture1d), [RWTexture1DArray](/windows/desktop/direct3dhlsl/sm5-object-rwtexture1darray)
-   [RWTexture2D](/windows/desktop/direct3dhlsl/sm5-object-rwtexture2d), [RWTexture2DArray](/windows/desktop/direct3dhlsl/sm5-object-rwtexture2darray)
-   [RWTexture3D](/windows/desktop/direct3dhlsl/sm5-object-rwtexture3d)

Для этих ресурсов требуется переменная ресурса для доступа к памяти (посредством индексирования), так как нет методов для прямого доступа к памяти. Переменную ресурса можно использовать в левой и правой частях уравнения. При использовании с правой стороны тип шаблона должен быть единственным компонентом (float, int или uint).

## <a name="structured-buffer"></a>Структурированный буфер

Структурированный буфер — это буфер, содержащий элементы одинаковых размеров. Для определения элемента используйте структуру с одним или несколькими типами элементов. Ниже приведена структура с тремя элементами.


```
struct MyStruct
{
    float4 Color;
    float4 Normal;
    bool isAwesome;
};
```



Используйте эту структуру для объявления структурированного буфера следующим образом:


```
StructuredBuffer<MyStruct> mySB;
```



Помимо индексирования, структурированный буфер поддерживает доступ к одному элементу следующим образом:


```
float4 myColor = mySb[27].Color;
```



Для доступа к структурированному буферу используйте следующие типы объектов:

-   [Структуредбуффер](/windows/desktop/direct3dhlsl/sm5-object-structuredbuffer) является структурированным буфером только для чтения.
-   [Рвструктуредбуффер](/windows/desktop/direct3dhlsl/sm5-object-rwstructuredbuffer) — это структурированный буфер для чтения и записи.

[Атомарные функции](direct3d-11-advanced-stages-cs-atomic-functions.md) , которые реализуют блокируемые операции, допускаются для элементов int и uint в **рвструктуредбуффер**.

## <a name="byte-address-buffer"></a>Буфер байтового адреса

Буфер байтового адреса — это буфер, содержимое которого можно устранить с помощью смещения в байтах. Как правило, содержимое [буфера](overviews-direct3d-11-resources-buffers-intro.md) индексируется по каждому элементу с помощью шага для каждого элемента и номера элемента (N), заданного параметром S \* N. Буфер байтового адреса, который также может называться необработанным буфером, использует смещение байтового значения от начала буфера для доступа к данным. Значение байта должно быть кратно четырем, чтобы оно было высвоено по DWORD. Если указано любое другое значение, поведение не определено.

В модели шейдеров 5 представлены объекты для доступа к [буферу байтового адреса только для чтения](/windows/desktop/direct3dhlsl/sm5-object-byteaddressbuffer) , а также [буферу байтов для чтения и записи](/windows/desktop/direct3dhlsl/sm5-object-rwbyteaddressbuffer). Содержимое буфера байтового адреса разработано как 32-разрядное целое число без знака; Если значение в буфере действительно не является целым числом без знака, используйте функцию, например [**асфлоат**](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-asfloat) , чтобы прочитать ее.

## <a name="unordered-access-buffer-or-texture"></a>Неупорядоченный буфер или текстура доступа

Неупорядоченный ресурс доступа (который включает буферы, текстуры и массивы текстур без множественной выборки) позволяет временно неупорядоченный доступ на чтение и запись из нескольких потоков. Это означает, что этот тип ресурса можно считывать и записывать одновременно несколькими потоками, не создавая конфликты памяти за счет использования [атомарных функций](direct3d-11-advanced-stages-cs-atomic-functions.md).

Создайте неупорядоченный буфер или текстуру доступа, вызвав функцию, такую как [**ID3D11Device:: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer) или [**ID3D11Device:: CreateTexture2D**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createtexture2d) и передав флаг **\_ \_ неупорядоченного \_ доступа D3D11 BIND** в перечислении [**\_ \_ флага привязки D3D11**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_bind_flag) .

Неупорядоченные ресурсы доступа можно привязывать только к шейдерам пикселей и шейдерам вычислений. Во время выполнения шейдеры пикселей или шейдеры вычислений, выполняющиеся параллельно, имеют одинаковые привязанные неупорядоченные ресурсы доступа.

### <a name="append-and-consume-buffer"></a>Добавление и использование буфера

Буфер добавления и использования — это особый тип неупорядоченного ресурса, который поддерживает добавление и удаление значений из конца буфера аналогично тому, как работает стек.

Буфер добавления и использования должен быть структурированным буфером:

-   [аппендструктуредбуффер](/windows/desktop/direct3dhlsl/sm5-object-appendstructuredbuffer)
-   [консуместруктуредбуффер](/windows/desktop/direct3dhlsl/sm5-object-consumestructuredbuffer)

Используйте эти ресурсы в своих методах. Эти ресурсы не используют переменные ресурсов.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Общие сведения о вычислении шейдера](direct3d-11-advanced-stages-compute-shader.md)
</dt> </dl>

 

 