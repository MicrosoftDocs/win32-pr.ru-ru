---
title: Правила растрирования
description: Правила растеризации определяют, как векторные данные сопоставляются с растровыми.
ms.assetid: 2b3894eb-dff3-401f-8b14-4af98db86e39
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e256c6fc171c1cce9b63b79fac6a480e507a306e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104412997"
---
# <a name="rasterization-rules"></a><span data-ttu-id="850bf-103">Правила растрирования</span><span class="sxs-lookup"><span data-stu-id="850bf-103">Rasterization Rules</span></span>

<span data-ttu-id="850bf-104">Правила растеризации определяют, как векторные данные сопоставляются с растровыми.</span><span class="sxs-lookup"><span data-stu-id="850bf-104">Rasterization rules define how vector data is mapped into raster data.</span></span> <span data-ttu-id="850bf-105">Растровые данные прикрепляются в целочисленные расположения, которые затем сортируются и обрезаются (так, чтобы рисовать минимальное число пикселей), а атрибуты отдельных пикселей интерполируются (от атрибутов отдельных вершин), прежде чем будут переданы в построитель текстуры.</span><span class="sxs-lookup"><span data-stu-id="850bf-105">The raster data is snapped to integer locations that are then culled and clipped (to draw the minimum number of pixels), and per-pixel attributes are interpolated (from per-vertex attributes) before being passed to a pixel shader.</span></span>

<span data-ttu-id="850bf-106">Существует несколько типов правил, которые зависят от типа сопоставляемого примитива, а также от того, используют ли данные множественную дискретизацию, чтобы уменьшить искажения.</span><span class="sxs-lookup"><span data-stu-id="850bf-106">There are several types of rules, which depend on the type of primitive that is being mapped, as well as whether or not the data uses multisampling to reduce aliasing.</span></span> <span data-ttu-id="850bf-107">На следующих рисунках показана обработка углов.</span><span class="sxs-lookup"><span data-stu-id="850bf-107">The following illustrations demonstrate how the corner cases are handled.</span></span>

-   [<span data-ttu-id="850bf-108">Правила растрирования треугольников (без множественной выборки)</span><span class="sxs-lookup"><span data-stu-id="850bf-108">Triangle Rasterization Rules (Without Multisampling)</span></span>](#triangle-rasterization-rules-without-multisampling)
-   [<span data-ttu-id="850bf-109">Правила растрирования линий (с псевдонимами без множественной выборки)</span><span class="sxs-lookup"><span data-stu-id="850bf-109">Line Rasterization Rules (Aliased, Without Multisampling)</span></span>](#line-rasterization-rules-aliased-without-multisampling)
-   [<span data-ttu-id="850bf-110">Правила растрирования линий (сглаженные без множественной выборки)</span><span class="sxs-lookup"><span data-stu-id="850bf-110">Line Rasterization Rules (Antialiased, Without Multisampling)</span></span>](#line-rasterization-rules-antialiased-without-multisampling)
-   [<span data-ttu-id="850bf-111">Правила растрирования точек (без множественной выборки)</span><span class="sxs-lookup"><span data-stu-id="850bf-111">Point Rasterization Rules (Without Multisampling)</span></span>](#point-rasterization-rules-without-multisampling)
-   [<span data-ttu-id="850bf-112">Многовыборочные правила растрирования с сглаживанием</span><span class="sxs-lookup"><span data-stu-id="850bf-112">Multisample Anti-Aliasing Rasterization Rules</span></span>](#multisample-anti-aliasing-rasterization-rules)
    -   [<span data-ttu-id="850bf-113">Поддержка оборудования</span><span class="sxs-lookup"><span data-stu-id="850bf-113">Hardware Support</span></span>](#hardware-support)
    -   [<span data-ttu-id="850bf-114">Центроид выборка атрибутов при многовыборочной сглаживания</span><span class="sxs-lookup"><span data-stu-id="850bf-114">Centroid Sampling of Attributes when Multisample Antialiasing</span></span>](#centroid-sampling-of-attributes-when-multisample-antialiasing)
    -   [<span data-ttu-id="850bf-115">Производные вычисления при множественной выборки</span><span class="sxs-lookup"><span data-stu-id="850bf-115">Derivative Calculations When Multisampling</span></span>](#derivative-calculations-when-multisampling)
-   [<span data-ttu-id="850bf-116">См. также</span><span class="sxs-lookup"><span data-stu-id="850bf-116">Related topics</span></span>](#related-topics)

## <a name="triangle-rasterization-rules-without-multisampling"></a><span data-ttu-id="850bf-117">Правила растеризации треугольника (без множественной дискретизации)</span><span class="sxs-lookup"><span data-stu-id="850bf-117">Triangle Rasterization Rules (Without Multisampling)</span></span>

<span data-ttu-id="850bf-118">Любой центр пикселя, который находится внутри треугольника, рисуется; пиксель считается расположенным внутри, если он соответствует правилу "верхнего левого".</span><span class="sxs-lookup"><span data-stu-id="850bf-118">Any pixel center which falls inside a triangle is drawn; a pixel is assumed to be inside if it passes the top-left rule.</span></span> <span data-ttu-id="850bf-119">Правило "верхнего левого" заключается в том, что центр пикселя считается размещенным внутри треугольника, если он располагается на верхней или левой стороне треугольника.</span><span class="sxs-lookup"><span data-stu-id="850bf-119">The top-left rule is that a pixel center is defined to lie inside of a triangle if it lies on the top edge or the left edge of a triangle.</span></span>

<span data-ttu-id="850bf-120">Где:</span><span class="sxs-lookup"><span data-stu-id="850bf-120">Where:</span></span>

-   <span data-ttu-id="850bf-121">верхняя сторона — это сторона, которая размещено строго по горизонтали и выше других сторон;</span><span class="sxs-lookup"><span data-stu-id="850bf-121">A top edge, is an edge that is exactly horizontal and is above the other edges.</span></span>
-   <span data-ttu-id="850bf-122">Левый край — это ребро, не совпадающее по горизонтали и расположенное в левой части треугольника.</span><span class="sxs-lookup"><span data-stu-id="850bf-122">A left edge, is an edge that is not exactly horizontal and is on the left side of the triangle.</span></span> <span data-ttu-id="850bf-123">Треугольник может иметь один или два левого края.</span><span class="sxs-lookup"><span data-stu-id="850bf-123">A triangle can have one or two left edges.</span></span>

<span data-ttu-id="850bf-124">Правило "верхнего левого" гарантирует, что смежные треугольники рисуются один раз.</span><span class="sxs-lookup"><span data-stu-id="850bf-124">The top-left rule ensures that adjacent triangles are drawn once.</span></span>

<span data-ttu-id="850bf-125">На этом рисунке показаны примеры пикселей, которые рисуются, так как они размещены внутри треугольника или соответствуют правилу "верхнего левого".</span><span class="sxs-lookup"><span data-stu-id="850bf-125">This illustration shows examples of pixels that are drawn because they either lie inside a triangle or follow the top-left rule.</span></span>

![Иллюстрация примеров растрирования верхнего левого треугольника](images/d3d10-rasterrulestriangle.png)

<span data-ttu-id="850bf-127">Светлыми и темно-серыми квадратами показаны группы пикселей, чтобы обозначить, внутри каких треугольников они находятся.</span><span class="sxs-lookup"><span data-stu-id="850bf-127">The light and dark gray covering of the pixels show them as groups of the pixels to indicate which triangle they are inside.</span></span>

## <a name="line-rasterization-rules-aliased-without-multisampling"></a><span data-ttu-id="850bf-128">Правила растеризации линий (без сглаживания, без множественной дискретизации)</span><span class="sxs-lookup"><span data-stu-id="850bf-128">Line Rasterization Rules (Aliased, Without Multisampling)</span></span>

<span data-ttu-id="850bf-129">Правила растеризации линий используют ромбовидную тестовую область, чтобы определить, охватывает ли линия пиксель.</span><span class="sxs-lookup"><span data-stu-id="850bf-129">Line rasterization rules use a diamond test area to determine if a line covers a pixel.</span></span> <span data-ttu-id="850bf-130">Для основных линий x (строки с-1 <= наклон <= + 1) область тестирования ромба включает (показывается сплошной) нижний левый край, нижний правый край и нижний угол; ромб не включает (показан пунктир) верхний левый край, верхний правый край, верхний кабель, левый угол и правый угол.</span><span class="sxs-lookup"><span data-stu-id="850bf-130">For x-major lines (lines with -1 <= slope <= +1), the diamond test area includes (shown solid) the lower-left edge, lower-right edge, and bottom corner; the diamond excludes (shown dotted) the upper-left edge, upper-right edge, the top corder, the left corner, and the right corner.</span></span> <span data-ttu-id="850bf-131">Основная линия сетки y — это любая линия, не являющаяся основной линией сетки x. Ромбовидная тестовая область описывается так же, как и для x, но в нее также включен правый угол.</span><span class="sxs-lookup"><span data-stu-id="850bf-131">A y-major line is any line that is not an x-major line; the test diamond area is the same as described for the x-major line except the right corner is also included.</span></span>

<span data-ttu-id="850bf-132">В ромбовидной области линия охватывает пиксель, если она есть в ромбовидной тестовой области при обходе линии с начала до конца.</span><span class="sxs-lookup"><span data-stu-id="850bf-132">Given the diamond area, a line covers a pixel if the line exits the pixel's diamond test area when traveling along the line from the start towards the end.</span></span> <span data-ttu-id="850bf-133">Ломаная ведет себя так же, как при ее отрисовке в виде последовательности линий.</span><span class="sxs-lookup"><span data-stu-id="850bf-133">A line strip behaves the same, as it is drawn as a sequence of lines.</span></span>

<span data-ttu-id="850bf-134">На следующем рисунке представлены некоторые примеры.</span><span class="sxs-lookup"><span data-stu-id="850bf-134">The following illustration shows some examples.</span></span>

![Примеры растрирования линий с псевдонимами](images/d3d10-rasterrulesline.png)

## <a name="line-rasterization-rules-antialiased-without-multisampling"></a><span data-ttu-id="850bf-136">Правила растеризации линий (со сглаживанием, без множественной дискретизации)</span><span class="sxs-lookup"><span data-stu-id="850bf-136">Line Rasterization Rules (Antialiased, Without Multisampling)</span></span>

<span data-ttu-id="850bf-137">Линия со сглаживанием преобразуется в растровый формат так, будто она представляет прямоугольник (с шириной = 1).</span><span class="sxs-lookup"><span data-stu-id="850bf-137">An antialiased line is rasterized as if it were a rectangle (with width = 1).</span></span> <span data-ttu-id="850bf-138">Прямоугольник пересекается с целью прорисовки, что дает значения покрытия для каждого пикселя, которые умножаются на выходные альфа-компоненты пиксельного шейдера.</span><span class="sxs-lookup"><span data-stu-id="850bf-138">The rectangle intersects with a render target producing per-pixel coverage values, which are multiplied into pixel shader output alpha components.</span></span> <span data-ttu-id="850bf-139">Сглаживание не выполняется при рисовании линий целевого объекта прорисовки со множественной дискретизацией.</span><span class="sxs-lookup"><span data-stu-id="850bf-139">There is no antialiasing preformed when drawing lines on a multisampled render target.</span></span>

<span data-ttu-id="850bf-140">Считается, что не существует единственного лучшего способа отрисовки линии со сглаживанием.</span><span class="sxs-lookup"><span data-stu-id="850bf-140">It is deemed that there is no single "best" way to perform antialiased line rendering.</span></span> <span data-ttu-id="850bf-141">Direct3D 10 принимает в качестве рекомендации метод, показанный на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="850bf-141">Direct3D 10 adopts as a guideline the method shown in the following illustration.</span></span> <span data-ttu-id="850bf-142">Он был получен опытным путем, т. к. продемонстрировал ряд желательных визуальных свойств.</span><span class="sxs-lookup"><span data-stu-id="850bf-142">This method was derived empirically, exhibiting a number of visual properties deemed desirable.</span></span> <span data-ttu-id="850bf-143">Оборудования не обязано точно соответствовать этому алгоритму. Отклонения тестов с использованием этого эталонного метода будут «допустимыми», если следовать указанным ниже принципам, что позволяет применять различные аппаратные реализации и размеры ядер фильтра.</span><span class="sxs-lookup"><span data-stu-id="850bf-143">Hardware need not exactly match this algorithm; tests against this reference shall have "reasonable" tolerances, guided by some of the principles listed further below, permitting various hardware implementations and filter kernel sizes.</span></span> <span data-ttu-id="850bf-144">Однако ни одна из этих гибких возможностей в реализации оборудования может быть передана через Direct3D 10 в приложения, помимо просто линий рисования и наблюдения за их отображением.</span><span class="sxs-lookup"><span data-stu-id="850bf-144">None of this flexibility permitted in hardware implementation, however, can be communicated up through Direct3D 10 to applications, beyond simply drawing lines and observing/measuring how they look.</span></span>

![Примеры растрирования строк со сглаженным сглаживанием](images/d3d10-rasterruleslineaa.png)

<span data-ttu-id="850bf-146">Этот алгоритм создает относительно плавные линии одинаковой интенсивности с минимальным числом неровных краев или искажений.</span><span class="sxs-lookup"><span data-stu-id="850bf-146">This algorithm generates relatively smooth lines, with uniform intensity, with minimal jagged edges or braiding.</span></span> <span data-ttu-id="850bf-147">Образование муарового узора для рядом расположенных линий минимизировано.</span><span class="sxs-lookup"><span data-stu-id="850bf-147">Moire patterning for close lines is minimized.</span></span> <span data-ttu-id="850bf-148">Обеспечивается хорошее покрытие соединений между сегментами линий, размещенными возле концов.</span><span class="sxs-lookup"><span data-stu-id="850bf-148">There is good coverage for junctions between line segments placed end-to-end.</span></span> <span data-ttu-id="850bf-149">Ядро фильтра — это разумный компромисс между объем размытия краев и изменениями интенсивности, вызванными гамма-коррекцией.</span><span class="sxs-lookup"><span data-stu-id="850bf-149">The filter kernel is a reasonable tradeoff between the amount of edge blurring and the changes in intensity caused by gamma corrections.</span></span> <span data-ttu-id="850bf-150">Значение покрытия умножается на построитель текстуры O0. a (Сркалфа) на следующую формулу на стадии слияния: Сркколор \* сркалфа + дестколор \* (1-сркалфа).</span><span class="sxs-lookup"><span data-stu-id="850bf-150">The coverage value is multiplied into pixel shader o0.a (srcAlpha) per the following formula by the output-merger stage: srcColor \* srcAlpha + destColor \* (1-srcAlpha).</span></span>

## <a name="point-rasterization-rules-without-multisampling"></a><span data-ttu-id="850bf-151">Правила растеризация точки (без множественной дискретизации)</span><span class="sxs-lookup"><span data-stu-id="850bf-151">Point Rasterization Rules (Without Multisampling)</span></span>

<span data-ttu-id="850bf-152">Точка интерпретируется как состоящая из двух треугольников в Z-шаблоне, для которого используются правила растеризации треугольника.</span><span class="sxs-lookup"><span data-stu-id="850bf-152">A point is interpreted as though it were composed of two triangles in a Z pattern, which use triangle rasterization rules.</span></span> <span data-ttu-id="850bf-153">Координата определяет центр квадрата шириной один пиксель.</span><span class="sxs-lookup"><span data-stu-id="850bf-153">The coordinate identifies the center of a one pixel wide square.</span></span> <span data-ttu-id="850bf-154">Для точек отбрасывание не выполняется.</span><span class="sxs-lookup"><span data-stu-id="850bf-154">There is no culling for points.</span></span>

<span data-ttu-id="850bf-155">На следующем рисунке представлены некоторые примеры.</span><span class="sxs-lookup"><span data-stu-id="850bf-155">The following illustration shows some examples.</span></span>

![Иллюстрация примеров растрирования точек](images/d3d10-rasterrulespoint.png)

## <a name="multisample-anti-aliasing-rasterization-rules"></a><span data-ttu-id="850bf-157">Правила растеризации со сглаживанием и множественной дискретизацией</span><span class="sxs-lookup"><span data-stu-id="850bf-157">Multisample Anti-Aliasing Rasterization Rules</span></span>

<span data-ttu-id="850bf-158">Сглаживание со множественной дискретизацией (MSAA) уменьшает геометрические искажения, используя тесты покрытия пикселей и трафарета глубины в нескольких местах из подмножества выборки.</span><span class="sxs-lookup"><span data-stu-id="850bf-158">Multisample antialiasing (MSAA) reduces geometry aliasing using pixel coverage and depth-stencil tests at multiple sub-sample locations.</span></span> <span data-ttu-id="850bf-159">Для повышения производительности пиксельные вычисления выполняются один раз для каждого охваченного пикселя за счет совместного использования выходных данных шейдера для всех охваченных пикселей.</span><span class="sxs-lookup"><span data-stu-id="850bf-159">To improve performance, per-pixel calculations are performed once for each covered pixel, by sharing shader outputs across covered sub-pixels.</span></span> <span data-ttu-id="850bf-160">Множественное сглаживание не уменьшает искажения поверхности.</span><span class="sxs-lookup"><span data-stu-id="850bf-160">Multisample antialiasing does not reduce surface aliasing.</span></span> <span data-ttu-id="850bf-161">Расположения выборки и функции реконструкции зависят от аппаратной реализации.</span><span class="sxs-lookup"><span data-stu-id="850bf-161">Sample locations and reconstruction functions are dependent on the hardware implementation.</span></span>

<span data-ttu-id="850bf-162">На следующем рисунке представлены некоторые примеры.</span><span class="sxs-lookup"><span data-stu-id="850bf-162">The following illustration shows some examples.</span></span>

![Примеры растрирования с многовыборочным сглаживанием](images/d3d10-rasterrulesmsaa.png)

<span data-ttu-id="850bf-164">Количество расположений выборки зависит от режима множественной дискретизации.</span><span class="sxs-lookup"><span data-stu-id="850bf-164">The number of sample locations is dependent on the multisample mode.</span></span> <span data-ttu-id="850bf-165">Интерполяции атрибутов вершин происходит в центре пикселей, т. к. здесь вызывается пиксельный шейдер (это становится экстраполяцией, если центр не охвачен).</span><span class="sxs-lookup"><span data-stu-id="850bf-165">Vertex attributes are interpolated at pixel centers, since this is where the pixel shader is invoked (this becomes extrapolation if the center is not covered).</span></span> <span data-ttu-id="850bf-166">Атрибуты могут быть отмечены в пиксельном шейдере для центроидной дискретизации, из-за чего незатронутые пиксели интерполируют атрибут на пересечения области пикселя и примитива.</span><span class="sxs-lookup"><span data-stu-id="850bf-166">Attributes can be flagged in the pixel shader to be centroid sampled, which causes non-covered pixels to interpolate the attribute at intersection of the pixel's area and the primitive.</span></span> <span data-ttu-id="850bf-167">Пиксельный шейдер запускается для каждой области размером 2x2 пикселя для поддержки производных вычислений (в которых используется дельта x и y).</span><span class="sxs-lookup"><span data-stu-id="850bf-167">A pixel shader runs for each 2x2 pixel area to support derivative calculations (which use x and y deltas).</span></span> <span data-ttu-id="850bf-168">Это означает, что шейдер вызывается чаще, чем показано, для заполнения минимального кванта 2x2 (который не зависит от множественной дискретизации).</span><span class="sxs-lookup"><span data-stu-id="850bf-168">This means that shader invocations occur more than is shown to fill out the minimum 2x2 quanta (which is independent of multisampling).</span></span> <span data-ttu-id="850bf-169">Результат шейдера записывается для каждого охваченного образца, который прошел тест трафарета глубины.</span><span class="sxs-lookup"><span data-stu-id="850bf-169">The shader result is written out for each covered sample that passes the per-sample depth-stencil test.</span></span>

<span data-ttu-id="850bf-170">Правила растеризации для примитивов, в целом, не изменяются при множественном сглаживании, за исключением следующие случаев:</span><span class="sxs-lookup"><span data-stu-id="850bf-170">Rasterization rules for primitives are, in general, unchanged by multisample antialiasing, except:</span></span>

-   <span data-ttu-id="850bf-171">для треугольника тест покрытия выполняется для каждого расположения образца (а не для центра пикселя);</span><span class="sxs-lookup"><span data-stu-id="850bf-171">For a triangle, a coverage test is performed for each sample location (not for a pixel center).</span></span> <span data-ttu-id="850bf-172">Если охватывается больше одного местоположения, пиксельный шейдер запускается один раз, а атрибуты интерполируются в центре пикселей.</span><span class="sxs-lookup"><span data-stu-id="850bf-172">If more than one sample location is covered, a pixel shader runs once with attributes interpolated at the pixel center.</span></span> <span data-ttu-id="850bf-173">Результат сохраняется (копируется) для каждого охваченного местоположения в пикселе, прошедшем проверку глубины трафарета.</span><span class="sxs-lookup"><span data-stu-id="850bf-173">The result is stored (replicated) for each covered sample location in the pixel that passes the depth/stencil test.</span></span>

    <span data-ttu-id="850bf-174">Линия считается прямоугольником, состоящим из двух треугольников с толщиной линии 1,4;</span><span class="sxs-lookup"><span data-stu-id="850bf-174">A line is treated as a rectangle made up of two triangles, with a line width of 1.4.</span></span>

-   <span data-ttu-id="850bf-175">для точки тест покрытия выполняется для каждого расположения образца (а не для центра пикселя).</span><span class="sxs-lookup"><span data-stu-id="850bf-175">For a point, a coverage test is performed for each sample location (not for a pixel center).</span></span>

<span data-ttu-id="850bf-176">Многие форматы поддерживают множественную выборку (см. раздел [Поддержка оборудования для форматов Direct3D 10](/previous-versions//cc627090(v=vs.85))), некоторые форматы могут быть разрешены ([**ресолвесубресаурце**](/windows/desktop/api/d3d10/nf-d3d10-id3d10device-resolvesubresource);, довнсамплес многовыборочный формат для выборки размера 1).</span><span class="sxs-lookup"><span data-stu-id="850bf-176">Many formats support multisampling (see [Hardware Support for Direct3D 10 Formats](/previous-versions//cc627090(v=vs.85))), some formats can be resolved ([**ResolveSubresource**](/windows/desktop/api/d3d10/nf-d3d10-id3d10device-resolvesubresource); which downsamples a multisampled format to a sample size of 1).</span></span> <span data-ttu-id="850bf-177">Форматы множественной дискретизации могут использоваться в целях отрисовки, которые могут быть считаны в шейдеры с помощью [загрузки](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-to-load), так как разрешение для отдельных образцов, к которым обращается шейдер, не требуется.</span><span class="sxs-lookup"><span data-stu-id="850bf-177">Multisampling formats can be used in render targets which can be read back into shaders using [load](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-to-load), since no resolve is required for individual samples accessed by the shader.</span></span> <span data-ttu-id="850bf-178">Форматы глубины не поддерживаются для ресурса множественной дискретизации, поэтому форматы глубины ограничены только целями прорисовки.</span><span class="sxs-lookup"><span data-stu-id="850bf-178">Depth formats are not supported for multisample resource, therefore, depth formats are restricted to render targets only.</span></span>

<span data-ttu-id="850bf-179">Форматы с нетипизированными типами (R8G8B8A8 \_ ) поддерживают множественную выборку, чтобы представление ресурсов было интерпретировать данные разными способами.</span><span class="sxs-lookup"><span data-stu-id="850bf-179">Typeless formats (R8G8B8A8\_TYPELESS for instance) support multisampling to allow a resource view to interpret data in different ways.</span></span> <span data-ttu-id="850bf-180">Например, можно создать многовыборочный ресурс с помощью R8G8B8A8 без \_ типов, подготовить его к просмотру с помощью ресурса рендеринга целевого представления с \_ форматом R8G8B8A8 uint, а затем разрешить содержимое в другой ресурс с \_ форматом данных R8G8B8A8 UNORM.</span><span class="sxs-lookup"><span data-stu-id="850bf-180">For instance, you could create a multisample resource using R8G8B8A8\_TYPELESS, render to it using a render-target-view resource with a R8G8B8A8\_UINT format, then resolve the contents to another resource with a R8G8B8A8\_UNORM data format.</span></span>

### <a name="hardware-support"></a><span data-ttu-id="850bf-181">Поддержка оборудования</span><span class="sxs-lookup"><span data-stu-id="850bf-181">Hardware Support</span></span>

<span data-ttu-id="850bf-182">API сообщает о поддержке оборудования для множественной дискретизации с помощью ряда проверок качества.</span><span class="sxs-lookup"><span data-stu-id="850bf-182">The API reports hardware support for multisampling through the number of quality levels.</span></span> <span data-ttu-id="850bf-183">Например, уровень качества 0 означает, что множественная дискретизация (на определенном уровне формата и качества) не поддерживается оборудованием.</span><span class="sxs-lookup"><span data-stu-id="850bf-183">For example, a 0 quality level means the hardware does not support multisampling (at a particular format and quality level).</span></span> <span data-ttu-id="850bf-184">Уровень качества 3 означает, что оборудование поддерживает три разных макета образца и алгоритма разрешения.</span><span class="sxs-lookup"><span data-stu-id="850bf-184">A 3 for quality levels means that the hardware supports three different sample layouts and/or resolve algorithms.</span></span> <span data-ttu-id="850bf-185">Вы также можете предположить следующее:</span><span class="sxs-lookup"><span data-stu-id="850bf-185">You can also assume the following:</span></span>

-   <span data-ttu-id="850bf-186">любой формат, который поддерживает множественную дискретизацию, поддерживает одинаковое число уровней качества для каждого формата этого семейства;</span><span class="sxs-lookup"><span data-stu-id="850bf-186">Any format that supports multisampling, supports the same number of quality levels for every format in that family.</span></span>
-   <span data-ttu-id="850bf-187">Каждый формат, поддерживающий множественную выборку и имеющий \_ форматы UNORM, \_ sRGB, \_ снорм или \_ float, также поддерживает разрешение.</span><span class="sxs-lookup"><span data-stu-id="850bf-187">Every format that supports multisampling, and has the \_UNORM, \_SRGB, \_SNORM or \_FLOAT formats, also supports resolving.</span></span>

### <a name="centroid-sampling-of-attributes-when-multisample-antialiasing"></a><span data-ttu-id="850bf-188">Центроидная дискретизация атрибутов при множественном сглаживании</span><span class="sxs-lookup"><span data-stu-id="850bf-188">Centroid Sampling of Attributes when Multisample Antialiasing</span></span>

<span data-ttu-id="850bf-189">По умолчанию атрибуты вершин интерполируются в центре пикселей во время множественного сглаживания. Если центр пикселя не охвачен, атрибуты экстраполируются в центре пикселей.</span><span class="sxs-lookup"><span data-stu-id="850bf-189">By default, vertex attributes are interpolated to a pixel center during multisample antialiasing; if the pixel center is not covered, attributes are extrapolated to a pixel center.</span></span> <span data-ttu-id="850bf-190">Если входные данные пиксельного шейдера, которые содержат семантику центроида (если пиксель не полностью охвачен), будут выбираться где-то в пределах области охвата пикселя, возможно, в одном из охваченных расположений.</span><span class="sxs-lookup"><span data-stu-id="850bf-190">If a pixel shader input that contains the centroid semantic (assuming the pixel is not fully covered) will be sampled somewhere within the covered area of the pixel, possibly at one of the covered sample locations.</span></span> <span data-ttu-id="850bf-191">Маска образца (задается состоянием средства прорисовки) применяется перед вычислением центроида.</span><span class="sxs-lookup"><span data-stu-id="850bf-191">A sample mask (specified by the rasterizer state) is applied prior to centroid computation.</span></span> <span data-ttu-id="850bf-192">Поэтому маскированный образец не будет использоваться в качестве расположения центроида.</span><span class="sxs-lookup"><span data-stu-id="850bf-192">Therefore, a sample that is masked out will not be used as a centroid location.</span></span>

<span data-ttu-id="850bf-193">Средство программной прорисовки выбирает расположение образца для центроидной дискретизации следующим образом.</span><span class="sxs-lookup"><span data-stu-id="850bf-193">The reference rasterizer chooses a sample location for centroid sampling similar to this:</span></span>

-   <span data-ttu-id="850bf-194">Маска дискретизации разрешает все образцы.</span><span class="sxs-lookup"><span data-stu-id="850bf-194">The sample mask allows all samples.</span></span> <span data-ttu-id="850bf-195">Центр пикселя используется, если пиксель охвачен или ни один из образцов не охвачен.</span><span class="sxs-lookup"><span data-stu-id="850bf-195">Use a pixel center if the pixel is covered or if none of the samples are covered.</span></span> <span data-ttu-id="850bf-196">В противном случае выбирается первый охваченный образец начиная от центра пикселя и с перемещением вперед.</span><span class="sxs-lookup"><span data-stu-id="850bf-196">Otherwise, the first covered sample is chosen, starting from the pixel center and moving outward.</span></span>
-   <span data-ttu-id="850bf-197">Маска дискретизации отключает все образцы, кроме одного (общий сценарий).</span><span class="sxs-lookup"><span data-stu-id="850bf-197">The sample mask turns off all samples but one (a common scenario).</span></span> <span data-ttu-id="850bf-198">Приложение может реализовывать многопроходную супердискретизацию, перебирая одноразрядные значения маски дискретизации и повторно отрисовывая сцену для каждого образца, используя центроидную дискретизации.</span><span class="sxs-lookup"><span data-stu-id="850bf-198">An application can implement multipass supersampling by cycling through single-bit sample-mask values and re-rendering the scene for each sample using centroid sampling.</span></span> <span data-ttu-id="850bf-199">Для этого приложению потребуется настроить производные данные, чтобы выбрать более детализированные MIP текстур для повышения плотности дискретизации текстур.</span><span class="sxs-lookup"><span data-stu-id="850bf-199">This would require that an application adjust derivatives to select appropriately more detailed texture mips for the higher texture sampling density.</span></span>

### <a name="derivative-calculations-when-multisampling"></a><span data-ttu-id="850bf-200">Производные вычисления при множественной дискретизации</span><span class="sxs-lookup"><span data-stu-id="850bf-200">Derivative Calculations When Multisampling</span></span>

<span data-ttu-id="850bf-201">Пиксельные шейдеры всегда запускаются с использованием минимальной области размером 2x2 пикселя для поддержки производных вычислений, для получения которых учитывается разница между смежными пикселями (предполагается, что данные в каждом пикселе были дискретизированы с горизонтальным или вертикальным интервалом).</span><span class="sxs-lookup"><span data-stu-id="850bf-201">Pixel shaders always run using a minimum 2x2 pixel area to support derivative calculations, which are calculated by taking deltas between data from adjacent pixels (making the assumption that the data in each pixel has been sampled with unit spacing horizontally or vertically).</span></span> <span data-ttu-id="850bf-202">Множественная дискретизация на это не влияет.</span><span class="sxs-lookup"><span data-stu-id="850bf-202">This is unaffected by multisampling.</span></span>

<span data-ttu-id="850bf-203">Если производные вычисления запрашиваются для атрибута, который был дискретизирован по центроиду, аппаратные вычисления не корректируются, что может вызвать неточные результаты.</span><span class="sxs-lookup"><span data-stu-id="850bf-203">If derivatives are requested on an attribute that has been centroid sampled, the hardware calculation is not adjusted, which can cause inaccurate derivatives.</span></span> <span data-ttu-id="850bf-204">Шейдер ожидает единичный вектор в цели отрисовки, но может получить иной вектор относительно другого векторного пространства.</span><span class="sxs-lookup"><span data-stu-id="850bf-204">A shader will expect a unit vector in render-target space but may get a non-unit vector with respect to some other vector space.</span></span> <span data-ttu-id="850bf-205">Поэтому приложение отвечает за проверку при запросе производных вычислений на основе атрибутов с центроидной дискретизацией.</span><span class="sxs-lookup"><span data-stu-id="850bf-205">Therefore, it is an application's responsibility to exhibit caution when requesting derivatives from attributes that are centroid sampled.</span></span> <span data-ttu-id="850bf-206">К слову, не рекомендуется объединять производные вычисления и центроидную дискретизацию.</span><span class="sxs-lookup"><span data-stu-id="850bf-206">In fact, it is recommended that you do not combine derivatives and centroid sampling.</span></span> <span data-ttu-id="850bf-207">Центроидная дискретизация может быть полезна в случаях, когда интерполированные атрибуты примитива не должны быть экстраполированы, но при этом требуются компромиссы, например атрибуты меняются резко, а не непрерывно, когда край примитива пересекает пиксель или производные вычисления не могут использоваться в операциях дискретизации текстуры, которые получают уровень детализации.</span><span class="sxs-lookup"><span data-stu-id="850bf-207">Centroid sampling can be useful for situations where it is critical that a primitive's interpolated attributes are not extrapolated, but this comes with tradeoffs such as attributes that appear to jump where a primitive edge crosses a pixel (rather than change continuously) or derivatives that cannot be used by texture sampling operations that derive LOD.</span></span>

## <a name="related-topics"></a><span data-ttu-id="850bf-208">См. также</span><span class="sxs-lookup"><span data-stu-id="850bf-208">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="850bf-209">Этап растеризации</span><span class="sxs-lookup"><span data-stu-id="850bf-209">Rasterizer Stage</span></span>](d3d10-graphics-programming-guide-rasterizer-stage.md)
</dt> </dl>

 

 