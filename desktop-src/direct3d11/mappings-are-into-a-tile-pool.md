---
title: Сопоставления в пуле плиток
description: При создании ресурса с помощью \_ флага D3D11 ресурса " \_ Разное" элементы \_ мозаики, составляющие ресурс, берутся из расположения в пуле плиток.
ms.assetid: 1DBE23B2-A1E6-4491-9B74-4E92508A68FC
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d4a31d2e8cd4457281c047db514dd2450d3bf70d85be7e4933cb7e5f5e026a5
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119045622"
---
# <a name="mappings-are-into-a-tile-pool"></a>Сопоставления в пуле плиток

При создании ресурса с помощью флага [**D3D11 \_ ресурса \_ " \_ Разное**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) " элементы мозаики, составляющие ресурс, берутся из расположения в пуле плиток. Пул плиток — это пул памяти (в фоновом режиме которого выполняется одно или несколько выделений, которые не видны приложению). Операционная система и видеодрайвер управляют этим пулом памяти, а занятый в памяти участок легко понятен приложению. Мозаичные ресурсы сопоставляют регионы в 64 КБ, указывая на расположения в пуле плиток. Один из недостатков такой конфигурации заключается в том, что она позволяет нескольким ресурсам совместно и многократно использовать одни и те же плитки, а также повторно использовать одни и те же плитки в различных расположениях в ресурсе, если это необходимо.

Цена, которую приходится платить за гибкость заполнения плиток для ресурсов из пула плиток, состоит в том, что ресурсу приходится выполнять работу по определению и поддержанию соответствия плиток в пуле плиткам, необходимым ресурсам. Сопоставления плиток можно изменить. Кроме того, не все плитки в ресурсе необходимо сопоставлять единовременно; ресурс может иметь сопоставления **NULL**. Сопоставление **NULL** определяет плитку как недоступную с точки зрения ресурса, осуществляющего доступ к ней.

Можно создать несколько пулов плиток, и любое количество мозаичных ресурсов может быть сопоставлено с любым пулом плиток одновременно. Пулы плиток также можно расширять и сокращать. Дополнительные сведения см. в разделе [Изменение размера пула плиток](tile-pool-resizing.md). Одно из ограничений, которое существует для упрощения драйвера экрана и реализации среды выполнения, заключается в том, что данный мозаичный ресурс может одновременно сопоставляться только с одним пулом плиток (в отличие от одновременного сопоставления с несколькими пулами плиток).

Объем хранилища, связанный с самим ресурсом (то есть независимой памятью пула плиток), приблизительно пропорционален количеству плиток, фактически сопоставленных с пулом в любое заданное время. Для оборудования этот факт сводится к масштабированию объема памяти для хранения таблицы страниц примерно в соответствии с количеством сопоставленных плиток (например, с помощью многоуровневой таблицы страниц, если это необходимо).

Пул плиток можно считать полностью программной абстракцией, которая позволяет приложениям Direct3D эффективно создавать таблицы страниц на графическом процессоре (GPU) без необходимости получения сведений о реализации на низком уровне (или работать непосредственно с адресами-указателями). Пулы плиток не добавляют каких-либо дополнительных уровней косвенного обращения в оборудовании. Оптимизация одноуровневой таблицы страниц с помощью таких конструкций, как каталоги страницы, не зависит от концепции пула плиток.

Рассмотрим, какой объем памяти может потребоваться самой таблице страницы в худшем случае (хотя на практике требуется объем памяти, примерно пропорциональный сопоставляемым объектам).

Предположим, что каждая запись таблицы страниц состоит из 64 бит.

Для неограниченного размера таблицы страниц с наихудшим регистром, учитывая ограничения ресурсов в Direct3D 11, предположим, что создается мозаичный ресурс с 128-разрядным форматом элемента (например, RGBA с плавающей точкой), поэтому плитка 64 КБ содержит только 4096 пикселов. Максимальный поддерживаемый размер [**Texture2DArray**](/windows/desktop/direct3dhlsl/sm5-object-texture2darray) 16384 \* 16384 \* 2048 (но только для одного mipmap) потребовал около 1 ГБ хранилища в таблице страниц, если они полностью заполнены (не включая MIP-карты) с использованием записей таблицы битов 64. Добавление MIP-карт приведет к увеличению пространства для полностью сопоставленной (в худшем случае) таблицы страниц примерно на треть, то есть приблизительно до 1,3 ГБ.

В этом случае обеспечивается доступ к примерно 10,6 терабайт адресуемой памяти. Однако может существовать ограничение на объем адресуемой памяти, которое сократит эти объемы, возможно, до значений около одного терабайта.

Другим вариантом, который следует рассмотреть, является один [**Texture2Dный**](/windows/desktop/direct3dhlsl/sm5-object-texture2d) мозаичный ресурс 16384 \* 16384 с форматом 32 bit-for-element, в том числе MIP-карты. Место, необходимое в полностью заполненной таблице страниц, составит около 170 КБ при 64-битных записях в таблице.

Наконец, рассмотрим пример с использованием формата BC, скажем, BC7 со 128 битами на плитку размером 4 × 4 пикселя. Это составит один байт на пиксель. [**Texture2DArray**](/windows/desktop/direct3dhlsl/sm5-object-texture2darray) 16384 \* 16384 2048, \* включая MIP-карты, потребует примерно 85MB, чтобы полностью заполнить эту память в таблице страниц. Это неплохо, но это позволяет одному мозаичному ресурсу охватывать 550 гигапикселс (в данном случае 512 ГБ памяти).

На практике настолько полные сопоставления не определяются с учетом того, что объем физической памяти не позволит выполнить сопоставление и адресацию одновременно в подобных масштабах. Однако при работе с пулом плиток приложения могут повторно использовать плитки (в качестве простого примера мы можем повторно использовать плитку для заполнения крупных черных областей изображения), что позволяет эффективно применять пул плиток (то есть, сопоставления таблицы страниц) как средство для сокращения объемов памяти.

Начальное содержимое таблицы страниц — **NULL** для всех записей. Приложения также не могут передавать исходные данные для содержимого памяти для поверхности, поскольку они запускаются без резервирования памяти.

## <a name="in-this-section"></a>В этом разделе



| Раздел                                                                                                   | Описание                                                                                                                                                                                                                                                                                                                                                                |
|---------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Создание пула плиток](tile-pool-creation.md)<br/>                                                 | Пул плиток создается с помощью API-интерфейса [**ID3D11Device:: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer) путем передачи флага [**\_ \_ \_ \_ пула плиток ресурсов D3D11**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) в элементе **мискфлагс** в структуре [**D3D11 \_ buffer \_**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_buffer_desc) , на которую указывает параметр *пдеск* . <br/> |
| [Изменение размера пула плиток](tile-pool-resizing.md)<br/>                                                 | Используйте API [**ID3D11DeviceContext2:: ресизетилепул**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool) , чтобы расширить пул плиток, если приложению требуется больше рабочего набора для сопоставления с мозаичными ресурсами или для сжатия, если требуется меньше пространства. <br/>                                                                                                                    |
| [Отслеживание рисков и ресурсы пула плиток](hazard-tracking-versus-tile-pool-resources.md)<br/> | Для ресурсов без мозаичного разбиения Direct3D может предотвратить определенные условия опасности во время подготовки к просмотру, но так как отслеживание угроз будет на уровне плитки для мозаичных ресурсов, отслеживание условий угрозы во время отрисовки мозаичных ресурсов может оказаться слишком дорогостоящим. <br/>                                                                                                     |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Создание мозаичных ресурсов](creating-tiled-resources.md)
</dt> </dl>

 

