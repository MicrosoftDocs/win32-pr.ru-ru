---
title: Немедленное и отложенное отображение
description: 'Direct3D 11 поддерживает два типа отрисовки: немедленное и отложенное. Оба метода реализуются с помощью интерфейса ссылку ID3D11DeviceContext.'
ms.assetid: 8991be9f-c882-4752-9048-704fe4ae1725
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ef954a8e794755e1405c8e1e07505a5f39189b03
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104996778"
---
# <a name="immediate-and-deferred-rendering"></a><span data-ttu-id="d7535-104">Немедленное и отложенное отображение</span><span class="sxs-lookup"><span data-stu-id="d7535-104">Immediate and Deferred Rendering</span></span>

<span data-ttu-id="d7535-105">Direct3D 11 поддерживает два типа отрисовки: немедленное и отложенное.</span><span class="sxs-lookup"><span data-stu-id="d7535-105">Direct3D 11 supports two types of rendering: immediate and deferred.</span></span> <span data-ttu-id="d7535-106">Оба метода реализуются с помощью интерфейса [**ссылку ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext) .</span><span class="sxs-lookup"><span data-stu-id="d7535-106">Both are implemented by using the [**ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext) interface.</span></span>

## <a name="immediate-rendering"></a><span data-ttu-id="d7535-107">Немедленное отображение</span><span class="sxs-lookup"><span data-stu-id="d7535-107">Immediate Rendering</span></span>

<span data-ttu-id="d7535-108">Немедленное отображение означает вызов API-интерфейсов отрисовки или команд с устройства, который помещает команды в буфер для выполнения на GPU.</span><span class="sxs-lookup"><span data-stu-id="d7535-108">Immediate rendering refers to calling rendering APIs or commands from a device, which queues the commands in a buffer for execution on the GPU.</span></span> <span data-ttu-id="d7535-109">Используйте непосредственный контекст для подготовки к просмотру, задания состояния конвейера и воспроизведения списка команд.</span><span class="sxs-lookup"><span data-stu-id="d7535-109">Use an immediate context to render, set pipeline state, and play back a command list.</span></span>

<span data-ttu-id="d7535-110">Создайте непосредственный контекст с помощью [**D3D11CreateDevice**](/windows/desktop/api/D3D11/nf-d3d11-d3d11createdevice) или [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/D3D11/nf-d3d11-d3d11createdeviceandswapchain).</span><span class="sxs-lookup"><span data-stu-id="d7535-110">Create an immediate context using [**D3D11CreateDevice**](/windows/desktop/api/D3D11/nf-d3d11-d3d11createdevice) or [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/D3D11/nf-d3d11-d3d11createdeviceandswapchain).</span></span>

## <a name="deferred-rendering"></a><span data-ttu-id="d7535-111">Отложенная отрисовка</span><span class="sxs-lookup"><span data-stu-id="d7535-111">Deferred Rendering</span></span>

<span data-ttu-id="d7535-112">Отложенная визуализация записывает графические команды в буфер команд, чтобы их можно было воспроизводить в другое время.</span><span class="sxs-lookup"><span data-stu-id="d7535-112">Deferred rendering records graphics commands in a command buffer so that they can be played back at some other time.</span></span> <span data-ttu-id="d7535-113">Используйте отложенный контекст для записи команд (отрисовка, а также параметра состояния) в список команд.</span><span class="sxs-lookup"><span data-stu-id="d7535-113">Use a deferred context to record commands (rendering as well as state setting) to a command list.</span></span> <span data-ttu-id="d7535-114">Отложенная визуализация — это новая концепция Direct3D 11; Отложенная отрисовка разработана для поддержки отрисовки в одном потоке при записи команд для отрисовки в дополнительных потоках.</span><span class="sxs-lookup"><span data-stu-id="d7535-114">Deferred rendering is a new concept in Direct3D 11; deferred rendering is designed to support rendering on one thread while recording commands for rendering on additional threads.</span></span> <span data-ttu-id="d7535-115">Такая параллельная Многопотоковая стратегия позволяет разбивать сложные сцены на параллельные задачи.</span><span class="sxs-lookup"><span data-stu-id="d7535-115">This parallel, multithread strategy allows you to break up complex scenes into concurrent tasks.</span></span> <span data-ttu-id="d7535-116">Дополнительные сведения о визуализации сложных сцен см. в разделе [многопроходная визуализация](overviews-direct3d-11-render-multipass.md).</span><span class="sxs-lookup"><span data-stu-id="d7535-116">For more information about rendering complex scenes, see [Multiple-Pass Rendering](overviews-direct3d-11-render-multipass.md).</span></span>

<span data-ttu-id="d7535-117">Создайте отложенный контекст с помощью [**ID3D11Device:: креатедеферредконтекст**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createdeferredcontext).</span><span class="sxs-lookup"><span data-stu-id="d7535-117">Create a deferred context using [**ID3D11Device::CreateDeferredContext**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createdeferredcontext).</span></span>

<span data-ttu-id="d7535-118">Direct3D создает издержки на подготовку к просмотру при постановке команд в буфер команд.</span><span class="sxs-lookup"><span data-stu-id="d7535-118">Direct3D generates rendering overhead when it queues up commands in the command buffer.</span></span> <span data-ttu-id="d7535-119">В отличие от этого, [список команд](overviews-direct3d-11-render-multi-thread-command-list.md) выполняется гораздо эффективнее во время воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="d7535-119">In contrast, a [command list](overviews-direct3d-11-render-multi-thread-command-list.md) executes much more efficiently during playback.</span></span> <span data-ttu-id="d7535-120">Чтобы использовать список команд, записывайте команды подготовки к просмотру с отложенным контекстом и воспроизводите их обратно с помощью непосредственных контекстов.</span><span class="sxs-lookup"><span data-stu-id="d7535-120">To use a command list, record rendering commands with a deferred context and play them back using an immediate context.</span></span>

<span data-ttu-id="d7535-121">В одном потоке можно создать только один список команд.</span><span class="sxs-lookup"><span data-stu-id="d7535-121">You can generate only a single command list in a single-threaded fashion.</span></span> <span data-ttu-id="d7535-122">Однако можно одновременно создавать и использовать несколько отложенных контекстов, каждый из которых находится в отдельном потоке.</span><span class="sxs-lookup"><span data-stu-id="d7535-122">However, you can create and use multiple deferred contexts simultaneously, each in a separate thread.</span></span> <span data-ttu-id="d7535-123">Затем можно использовать эти несколько отложенных контекстов для одновременного создания нескольких списков команд.</span><span class="sxs-lookup"><span data-stu-id="d7535-123">Then, you can use those multiple deferred contexts to simultaneously create multiple command lists.</span></span>

<span data-ttu-id="d7535-124">Нельзя одновременно воспроизвести несколько списков команд в непосредственных контекстах.</span><span class="sxs-lookup"><span data-stu-id="d7535-124">You cannot play back two or more command lists simultaneously on the immediate context.</span></span>

<span data-ttu-id="d7535-125">Чтобы определить, является ли контекст устройства медленным или отложенным контекстом, вызовите метод [**ссылку ID3D11DeviceContext:: GetType**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-gettype).</span><span class="sxs-lookup"><span data-stu-id="d7535-125">To determine if a device context is an immediate or a deferred context, call [**ID3D11DeviceContext::GetType**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-gettype).</span></span>

<span data-ttu-id="d7535-126">Метод [**ссылку ID3D11DeviceContext:: Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) поддерживается только в отложенном контексте для динамических ресурсов ([**\_ \_ Динамическое использование D3D11**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_usage)), в котором первый вызов в списке команд является [**D3D11ной \_ \_ записью \_ отмены Map**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_map).</span><span class="sxs-lookup"><span data-stu-id="d7535-126">The [**ID3D11DeviceContext::Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) method is only supported in a deferred context for dynamic resources ([**D3D11\_USAGE\_DYNAMIC**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_usage)) where the first call within the command list is [**D3D11\_MAP\_WRITE\_DISCARD**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_map).</span></span> <span data-ttu-id="d7535-127">**D3D11 \_ \_Запись Map \_ без \_ перезаписи** поддерживается в последующих вызовах, если они доступны для данного типа ресурса.</span><span class="sxs-lookup"><span data-stu-id="d7535-127">**D3D11\_MAP\_WRITE\_NO\_OVERWRITE** is supported on subsequent calls if available for the given type of resource.</span></span>

<span data-ttu-id="d7535-128">Запросы в отложенном контексте ограничены созданием данных и рисованием в предикате.</span><span class="sxs-lookup"><span data-stu-id="d7535-128">Queries in a deferred context are limited to data generation and predicated drawing.</span></span> <span data-ttu-id="d7535-129">Нельзя вызвать [**ссылку ID3D11DeviceContext:: GetData**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-getdata) в отложенном контексте для получения данных о запросе; метод **GetData** можно вызвать только в непосредственных контекстах для получения данных о запросе.</span><span class="sxs-lookup"><span data-stu-id="d7535-129">You cannot call [**ID3D11DeviceContext::GetData**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-getdata) on a deferred context to get data about a query; you can only call **GetData** on the immediate context to get data about a query.</span></span> <span data-ttu-id="d7535-130">Можно задать предикат отрисовки (тип запроса), вызвав [**D3D11DeviceContext:: сетпредикатион**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-setpredication) , чтобы использовать результаты запроса на GPU.</span><span class="sxs-lookup"><span data-stu-id="d7535-130">You can set a rendering predicate (a type of query) by calling [**D3D11DeviceContext::SetPredication**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-setpredication) to use query results on the GPU.</span></span> <span data-ttu-id="d7535-131">Данные запроса можно создавать с помощью вызовов [**ссылку ID3D11DeviceContext:: Begin**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-begin) и [**ссылку ID3D11DeviceContext:: end**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-end).</span><span class="sxs-lookup"><span data-stu-id="d7535-131">You can generate query data through calls to [**ID3D11DeviceContext::Begin**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-begin) and [**ID3D11DeviceContext::End**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-end).</span></span> <span data-ttu-id="d7535-132">Однако данные запроса будут недоступны до тех пор, пока не будет вызван метод [**ссылку ID3D11DeviceContext:: вызова элемента executecommandlist**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-executecommandlist) в непосредственных контекстах для отправки списка отложенных команд контекста.</span><span class="sxs-lookup"><span data-stu-id="d7535-132">However, the query data will not be available until you call [**ID3D11DeviceContext::ExecuteCommandList**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-executecommandlist) on the immediate context to submit the deferred context command list.</span></span> <span data-ttu-id="d7535-133">Затем данные запроса обрабатываются графическим процессором.</span><span class="sxs-lookup"><span data-stu-id="d7535-133">The query data is then processed by the GPU.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d7535-134">См. также</span><span class="sxs-lookup"><span data-stu-id="d7535-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d7535-135">Многопоточность</span><span class="sxs-lookup"><span data-stu-id="d7535-135">Multithreading</span></span>](overviews-direct3d-11-render-multi-thread.md)
</dt> </dl>

 

 




