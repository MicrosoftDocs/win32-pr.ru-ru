---
title: Уязвимость мозаичных ресурсов HLSL
description: Новый синтаксис языка шейдера высокого уровня (Майкрософт) (HLSL) необходим для поддержки мозаичных ресурсов в модели шейдеров 5.
ms.assetid: B6CE51E6-1BA9-4D15-9654-86FE9BAAF585
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b2b266b98045b38645e1e8d24ed0014a5f448a38
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104487964"
---
# <a name="hlsl-tiled-resources-exposure"></a><span data-ttu-id="a79a9-103">Уязвимость мозаичных ресурсов HLSL</span><span class="sxs-lookup"><span data-stu-id="a79a9-103">HLSL tiled resources exposure</span></span>

<span data-ttu-id="a79a9-104">Новый синтаксис языка шейдера высокого уровня (Майкрософт) (HLSL) необходим для поддержки мозаичных ресурсов в [модели шейдеров 5](/windows/desktop/direct3dhlsl/d3d11-graphics-reference-sm5).</span><span class="sxs-lookup"><span data-stu-id="a79a9-104">New Microsoft High Level Shader Language (HLSL) syntax is required to support tiled resources in [Shader Model 5](/windows/desktop/direct3dhlsl/d3d11-graphics-reference-sm5).</span></span>

<span data-ttu-id="a79a9-105">Новый синтаксис HLSL разрешен только на устройствах с поддержкой мозаичных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a79a9-105">The new HLSL syntax is allowed only on devices with tiled resources support.</span></span> <span data-ttu-id="a79a9-106">Каждый соответствующий метод HLSL для мозаичных ресурсов в следующей таблице принимает один (отклик) или два (срез и обратную связь в этом порядке) дополнительные необязательные параметры.</span><span class="sxs-lookup"><span data-stu-id="a79a9-106">Each relevant HLSL method for tiled resources in the following table accepts either one (feedback) or two (clamp and feedback in this order) additional optional parameters.</span></span> <span data-ttu-id="a79a9-107">Например, метод **Sample** выглядит так:</span><span class="sxs-lookup"><span data-stu-id="a79a9-107">For example, a **Sample** method is:</span></span>

<span data-ttu-id="a79a9-108">**Образец (образец, расположение \[ , смещение \[ , срез \[ , обратная связь \] \] \] )**</span><span class="sxs-lookup"><span data-stu-id="a79a9-108">**Sample(sampler, location \[, offset \[, clamp \[, feedback\] \] \])**</span></span>

<span data-ttu-id="a79a9-109">Пример метода **Sample** — [**Texture2D.Sample(S,float,int,float,uint)**](/windows/desktop/direct3dhlsl/t2darray-sample-s-float-int-float-uint-).</span><span class="sxs-lookup"><span data-stu-id="a79a9-109">An example of a **Sample** method is [**Texture2D.Sample(S,float,int,float,uint)**](/windows/desktop/direct3dhlsl/t2darray-sample-s-float-int-float-uint-).</span></span>

<span data-ttu-id="a79a9-110">Параметры offset, clamp и feedback необязательны.</span><span class="sxs-lookup"><span data-stu-id="a79a9-110">The offset, clamp and feedback parameters are optional.</span></span> <span data-ttu-id="a79a9-111">Необходимо указать все необязательные параметры вплоть до требуемого в соответствии с правилами C++ касательно аргументов функций по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a79a9-111">You must specify all optional parameters up to the one you need, which is consistent with the C++ rules for default function arguments.</span></span> <span data-ttu-id="a79a9-112">Например, если требуется состояние feedback, необходимо явным образом предоставить параметры offset и clamp методу **Sample**, даже если логически они не нужны.</span><span class="sxs-lookup"><span data-stu-id="a79a9-112">For example, if the feedback status is needed, both offset and clamp parameters need to be explicitly supplied to **Sample**, even though they may not be logically needed.</span></span>

<span data-ttu-id="a79a9-113">Параметр clamp — скалярное значение с плавающей точкой.</span><span class="sxs-lookup"><span data-stu-id="a79a9-113">The clamp parameter is a scalar float value.</span></span> <span data-ttu-id="a79a9-114">Литеральное значение clamp=0.0f указывает, что операция прикрепления не выполнена.</span><span class="sxs-lookup"><span data-stu-id="a79a9-114">The literal value of clamp=0.0f indicates that the clamp operation isn't performed.</span></span>

<span data-ttu-id="a79a9-115">Параметр feedback — это переменная **uint**, которую можно передать встроенной функции опроса доступа к памяти [**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped).</span><span class="sxs-lookup"><span data-stu-id="a79a9-115">The feedback parameter is a **uint** variable that you can supply to the memory-access querying intrinsic [**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped) function.</span></span> <span data-ttu-id="a79a9-116">Значение параметра feedback нельзя изменять или интерпретировать. Но компилятор не предоставляет средств расширенного анализа и диагностики для обнаружения изменений значения.</span><span class="sxs-lookup"><span data-stu-id="a79a9-116">You must not modify or interpret the value of the feedback parameter; but, the compiler doesn't provide any advanced analysis and diagnostics to detect whether you modified the value.</span></span>

<span data-ttu-id="a79a9-117">Вот синтаксис [**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped):</span><span class="sxs-lookup"><span data-stu-id="a79a9-117">Here is the syntax of [**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped):</span></span>

<span data-ttu-id="a79a9-118">**bool CheckAccessFullyMapped(in uint FeedbackVar);**</span><span class="sxs-lookup"><span data-stu-id="a79a9-118">**bool CheckAccessFullyMapped(in uint FeedbackVar);**</span></span>

<span data-ttu-id="a79a9-119">[**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped) интерпретирует значение *FeedbackVar* и возвращает значение true, если все данные, к которым осуществляется доступ, сопоставлены в ресурсе. В противном случае **CheckAccessFullyMapped** возвращает значение false.</span><span class="sxs-lookup"><span data-stu-id="a79a9-119">[**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped) interprets the value of *FeedbackVar* and returns true if all data being accessed was mapped in the resource; otherwise, **CheckAccessFullyMapped** returns false.</span></span>

<span data-ttu-id="a79a9-120">Если параметр clamp или feedback присутствует, компилятор выдает вариант базовой инструкции.</span><span class="sxs-lookup"><span data-stu-id="a79a9-120">If either the clamp or feedback parameter is present, the compiler emits a variant of the basic instruction.</span></span> <span data-ttu-id="a79a9-121">Например, образец мозаичного ресурса создает `sample_cl_s` инструкцию.</span><span class="sxs-lookup"><span data-stu-id="a79a9-121">For example, sample of a tiled resource generates the `sample_cl_s` instruction.</span></span> <span data-ttu-id="a79a9-122">Если параметры clamp и feedback не указаны, компилятор выдает базовую инструкцию, чтобы исключить отклонение от текущего поведения.</span><span class="sxs-lookup"><span data-stu-id="a79a9-122">If neither clamp nor feedback is specified, the compiler emits the basic instruction, so that there is no change from the current behavior.</span></span> <span data-ttu-id="a79a9-123">Если параметру clamp присвоено значение 0.0f, прикрепление не выполнено. Компилятор драйвера может дополнительно настроить инструкцию под целевое оборудование.</span><span class="sxs-lookup"><span data-stu-id="a79a9-123">The clamp value of 0.0f indicates that no clamp is performed; thus, the driver compiler can further tailor the instruction to the target hardware.</span></span> <span data-ttu-id="a79a9-124">Если значением параметра feedback является регистр NULL в инструкции, параметр feedback не используется. Таким образом, компилятор драйвера может дополнительно настроить инструкцию под целевую архитектуру.</span><span class="sxs-lookup"><span data-stu-id="a79a9-124">If feedback is a NULL register in an instruction, the feedback is unused; thus, the driver compiler can further tailor the instruction to the target architecture.</span></span>

<span data-ttu-id="a79a9-125">Если компилятор HLSL делает логический вывод, что значение параметра clamp — 0.0f, а параметр feedback не используется, компилятор выдает соответствующую базовую инструкцию (например, `sample` вместо `sample_cl_s`).</span><span class="sxs-lookup"><span data-stu-id="a79a9-125">If the HLSL compiler infers that clamp is 0.0f and feedback is unused, the compiler emits the corresponding basic instruction (for example, `sample` rather than `sample_cl_s`).</span></span>

<span data-ttu-id="a79a9-126">Если доступ к мозаичному ресурсу состоит из нескольких составных инструкций по созданию байтового кода, например для структурированных ресурсов, компилятор выполняет статистическую обработку отдельных значений обратной связи с помощью операции или для получения окончательного значения обратной связи.</span><span class="sxs-lookup"><span data-stu-id="a79a9-126">If a tiled resource access consists of several constituent byte code instructions, for example, for structured resources, the compiler aggregates individual feedback values via the OR operation to produce the final feedback value.</span></span> <span data-ttu-id="a79a9-127">Таким образом, для такого сложного доступа вы получаете одно значение параметра feedback.</span><span class="sxs-lookup"><span data-stu-id="a79a9-127">Therefore, you see a single feedback value for such a complex access.</span></span>

<span data-ttu-id="a79a9-128">Это сводная таблица методов HLSL, измененных для обеспечения поддержки параметров feedback и clamp.</span><span class="sxs-lookup"><span data-stu-id="a79a9-128">This is the summary table of HLSL methods that are changed to support feedback and/or clamp.</span></span> <span data-ttu-id="a79a9-129">Все это работает с мозаичными и немозаичными ресурсами всех измерений.</span><span class="sxs-lookup"><span data-stu-id="a79a9-129">These all work on tiled and non-tiled resources of all dimensions.</span></span> <span data-ttu-id="a79a9-130">Ресурсы, не являющиеся мозаичными, всегда будут полностью сопоставлены.</span><span class="sxs-lookup"><span data-stu-id="a79a9-130">Non-tiled resources always appear to be fully mapped.</span></span>



| [<span data-ttu-id="a79a9-131">Объекты HLSL</span><span class="sxs-lookup"><span data-stu-id="a79a9-131">HLSL objects</span></span>](/windows/desktop/direct3dhlsl/d3d11-graphics-reference-sm5-objects)                                                                                                                                                                                                                                | <span data-ttu-id="a79a9-132">Встроенные методы с параметром Feedback ( \* ) также имеют параметр среза</span><span class="sxs-lookup"><span data-stu-id="a79a9-132">Intrinsic methods with feedback option (\*) - also has clamp option</span></span>                                                                                                                                                                  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a79a9-133">\[RW \] Texture2D</span><span class="sxs-lookup"><span data-stu-id="a79a9-133">\[RW\]Texture2D</span></span><br/> <span data-ttu-id="a79a9-134">\[RW \] Texture2DArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-134">\[RW\]Texture2DArray</span></span><br/> <span data-ttu-id="a79a9-135">TextureCUBE</span><span class="sxs-lookup"><span data-stu-id="a79a9-135">TextureCUBE</span></span><br/> <span data-ttu-id="a79a9-136">TextureCUBEArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-136">TextureCUBEArray</span></span><br/>                                                                                                                                                                                    | <span data-ttu-id="a79a9-137">Gather</span><span class="sxs-lookup"><span data-stu-id="a79a9-137">Gather</span></span><br/> <span data-ttu-id="a79a9-138">GatherRed</span><span class="sxs-lookup"><span data-stu-id="a79a9-138">GatherRed</span></span><br/> <span data-ttu-id="a79a9-139">GatherGreen</span><span class="sxs-lookup"><span data-stu-id="a79a9-139">GatherGreen</span></span><br/> <span data-ttu-id="a79a9-140">GatherBlue</span><span class="sxs-lookup"><span data-stu-id="a79a9-140">GatherBlue</span></span><br/> <span data-ttu-id="a79a9-141">GatherAlpha</span><span class="sxs-lookup"><span data-stu-id="a79a9-141">GatherAlpha</span></span><br/> <span data-ttu-id="a79a9-142">GatherCmp</span><span class="sxs-lookup"><span data-stu-id="a79a9-142">GatherCmp</span></span><br/> <span data-ttu-id="a79a9-143">GatherCmpRed</span><span class="sxs-lookup"><span data-stu-id="a79a9-143">GatherCmpRed</span></span><br/> <span data-ttu-id="a79a9-144">GatherCmpGreen</span><span class="sxs-lookup"><span data-stu-id="a79a9-144">GatherCmpGreen</span></span><br/> <span data-ttu-id="a79a9-145">GatherCmpBlue</span><span class="sxs-lookup"><span data-stu-id="a79a9-145">GatherCmpBlue</span></span><br/> <span data-ttu-id="a79a9-146">GatherCmpAlpha</span><span class="sxs-lookup"><span data-stu-id="a79a9-146">GatherCmpAlpha</span></span><br/> |
| <span data-ttu-id="a79a9-147">\[RW \] Texture1D</span><span class="sxs-lookup"><span data-stu-id="a79a9-147">\[RW\]Texture1D</span></span><br/> <span data-ttu-id="a79a9-148">\[RW \] Texture1DArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-148">\[RW\]Texture1DArray</span></span><br/> <span data-ttu-id="a79a9-149">\[RW \] Texture2D</span><span class="sxs-lookup"><span data-stu-id="a79a9-149">\[RW\]Texture2D</span></span><br/> <span data-ttu-id="a79a9-150">\[RW \] Texture2DArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-150">\[RW\]Texture2DArray</span></span><br/> <span data-ttu-id="a79a9-151">\[RW \] Texture3D</span><span class="sxs-lookup"><span data-stu-id="a79a9-151">\[RW\]Texture3D</span></span><br/> <span data-ttu-id="a79a9-152">TextureCUBE</span><span class="sxs-lookup"><span data-stu-id="a79a9-152">TextureCUBE</span></span><br/> <span data-ttu-id="a79a9-153">TextureCUBEArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-153">TextureCUBEArray</span></span><br/>                                                                                              | <span data-ttu-id="a79a9-154">Пример\*</span><span class="sxs-lookup"><span data-stu-id="a79a9-154">Sample\*</span></span><br/> <span data-ttu-id="a79a9-155">самплебиас\*</span><span class="sxs-lookup"><span data-stu-id="a79a9-155">SampleBias\*</span></span><br/> <span data-ttu-id="a79a9-156">самплекмп\*</span><span class="sxs-lookup"><span data-stu-id="a79a9-156">SampleCmp\*</span></span><br/> <span data-ttu-id="a79a9-157">SampleCmpLevelZero</span><span class="sxs-lookup"><span data-stu-id="a79a9-157">SampleCmpLevelZero</span></span><br/> <span data-ttu-id="a79a9-158">самплеград\*</span><span class="sxs-lookup"><span data-stu-id="a79a9-158">SampleGrad\*</span></span><br/> <span data-ttu-id="a79a9-159">SampleLevel</span><span class="sxs-lookup"><span data-stu-id="a79a9-159">SampleLevel</span></span><br/>                                                                                      |
| <span data-ttu-id="a79a9-160">\[RW \] Texture1D</span><span class="sxs-lookup"><span data-stu-id="a79a9-160">\[RW\]Texture1D</span></span><br/> <span data-ttu-id="a79a9-161">\[RW \] Texture1DArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-161">\[RW\]Texture1DArray</span></span><br/> <span data-ttu-id="a79a9-162">\[RW \] Texture2D</span><span class="sxs-lookup"><span data-stu-id="a79a9-162">\[RW\]Texture2D</span></span><br/> <span data-ttu-id="a79a9-163">Texture2DMS</span><span class="sxs-lookup"><span data-stu-id="a79a9-163">Texture2DMS</span></span><br/> <span data-ttu-id="a79a9-164">\[RW \] Texture2DArray</span><span class="sxs-lookup"><span data-stu-id="a79a9-164">\[RW\]Texture2DArray</span></span><br/> <span data-ttu-id="a79a9-165">Texture2DArrayMS</span><span class="sxs-lookup"><span data-stu-id="a79a9-165">Texture2DArrayMS</span></span><br/> <span data-ttu-id="a79a9-166">\[RW \] Texture3D</span><span class="sxs-lookup"><span data-stu-id="a79a9-166">\[RW\]Texture3D</span></span><br/> <span data-ttu-id="a79a9-167">\[RW \] буфер</span><span class="sxs-lookup"><span data-stu-id="a79a9-167">\[RW\]Buffer</span></span><br/> <span data-ttu-id="a79a9-168">\[RW \] битеаддрессбуффер</span><span class="sxs-lookup"><span data-stu-id="a79a9-168">\[RW\]ByteAddressBuffer</span></span><br/> <span data-ttu-id="a79a9-169">\[RW \] структуредбуффер</span><span class="sxs-lookup"><span data-stu-id="a79a9-169">\[RW\]StructuredBuffer</span></span><br/> | <span data-ttu-id="a79a9-170">Загрузить</span><span class="sxs-lookup"><span data-stu-id="a79a9-170">Load</span></span>                                                                                                                                                                                                                                 |



 

## <a name="related-topics"></a><span data-ttu-id="a79a9-171">См. также</span><span class="sxs-lookup"><span data-stu-id="a79a9-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a79a9-172">Доступ конвейера к мозаичным ресурсам</span><span class="sxs-lookup"><span data-stu-id="a79a9-172">Pipeline access to tiled resources</span></span>](pipeline-access-to-tiled-resources.md)
</dt> </dl>

 

