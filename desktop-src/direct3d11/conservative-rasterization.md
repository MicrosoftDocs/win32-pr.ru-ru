---
title: Технология Direct3D 11,3 консервативная растрирование
description: Консервативная растрирование добавляет некоторую степень уверенности в отрисовку пикселей, что полезно для алгоритмов обнаружения столкновений.
ms.assetid: 83F223C0-9282-4149-86CF-471B88829F76
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 003cb7e31c1380943318b34f9308f6b5e72d6e51
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104260981"
---
# <a name="direct3d-113-conservative-rasterization"></a><span data-ttu-id="71ec2-103">Технология Direct3D 11,3 консервативная растрирование</span><span class="sxs-lookup"><span data-stu-id="71ec2-103">Direct3D 11.3 Conservative Rasterization</span></span>

<span data-ttu-id="71ec2-104">Консервативная растрирование добавляет некоторую степень уверенности в отрисовку пикселей, что полезно для алгоритмов обнаружения столкновений.</span><span class="sxs-lookup"><span data-stu-id="71ec2-104">Conservative rasterization adds some certainty to pixel rendering, which is helpful in particular to collision detection algorithms.</span></span>

-   [<span data-ttu-id="71ec2-105">Обзор</span><span class="sxs-lookup"><span data-stu-id="71ec2-105">Overview</span></span>](#overview)
-   [<span data-ttu-id="71ec2-106">Взаимодействие с конвейером</span><span class="sxs-lookup"><span data-stu-id="71ec2-106">Interactions with the pipeline</span></span>](#interactions-with-the-pipeline)
-   [<span data-ttu-id="71ec2-107">Сведения о реализации</span><span class="sxs-lookup"><span data-stu-id="71ec2-107">Implementation details</span></span>](#implementation-details)
-   [<span data-ttu-id="71ec2-108">Сводка по API</span><span class="sxs-lookup"><span data-stu-id="71ec2-108">API summary</span></span>](#api-summary)
-   [<span data-ttu-id="71ec2-109">См. также</span><span class="sxs-lookup"><span data-stu-id="71ec2-109">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="71ec2-110">Обзор</span><span class="sxs-lookup"><span data-stu-id="71ec2-110">Overview</span></span>

<span data-ttu-id="71ec2-111">Консервативная растрирование означает, что все пиксели, которые по крайней мере частично охвачены визуализированным примитивом, растрируются, то есть вызывается шейдер пикселей.</span><span class="sxs-lookup"><span data-stu-id="71ec2-111">Conservative rasterization means that all pixels that are at least partially covered by a rendered primitive are rasterized, which means that the pixel shader is invoked.</span></span> <span data-ttu-id="71ec2-112">Нормальным поведением является выборка, которая не используется, если включена консервативная растрирование.</span><span class="sxs-lookup"><span data-stu-id="71ec2-112">Normal behavior is sampling, which is not used if conservative rasterization is enabled.</span></span>

<span data-ttu-id="71ec2-113">Консервативная растрирование полезна в ряде ситуаций, в том числе для обеспечения достаточной уверенности в обнаружении столкновений, перекрытияного отбора и обнаружения видимости.</span><span class="sxs-lookup"><span data-stu-id="71ec2-113">Conservative rasterization is useful in a number of situations, including for certainty in collision detection, occlusion culling, and visibility detection.</span></span>

<span data-ttu-id="71ec2-114">Например, на следующем рисунке показан зеленый треугольник, отображаемый с использованием консервативной растрирования.</span><span class="sxs-lookup"><span data-stu-id="71ec2-114">For example, the following figure shows a green triangle rendered using conservative rasterization.</span></span> <span data-ttu-id="71ec2-115">Область Браун называется «областью неопределенности» — регион, в котором ошибки округления и другие проблемы приводят некоторой неопределенности к точным измерениям треугольника.</span><span class="sxs-lookup"><span data-stu-id="71ec2-115">The brown area is known as an "uncertainty region" - a region where rounding errors and other issues add some uncertainty to the exact dimensions of the triangle.</span></span> <span data-ttu-id="71ec2-116">Красные треугольники на каждой вершине показывают, как рассчитывается область неопределенности.</span><span class="sxs-lookup"><span data-stu-id="71ec2-116">The red triangles at each vertex show how the uncertainty region is calculated.</span></span> <span data-ttu-id="71ec2-117">Крупные серые квадраты показывают Пиксели, которые будут отображены.</span><span class="sxs-lookup"><span data-stu-id="71ec2-117">The large gray squares show the pixels that will be rendered.</span></span> <span data-ttu-id="71ec2-118">Розовые квадраты показывают Пиксели, отображаемые с помощью "верхнего левого правила", которые воспроизводятся как край треугольника, пересекающий границу пикселов.</span><span class="sxs-lookup"><span data-stu-id="71ec2-118">The pink squares show pixels rendered using the "top-left rule", which comes into play as the edge of the triangle crosses the edge of the pixels.</span></span> <span data-ttu-id="71ec2-119">Могут воздержаться ложные срабатывания (набор пикселей, который не должен быть), который система обычно, но не всегда исключает.</span><span class="sxs-lookup"><span data-stu-id="71ec2-119">There can be false positives (pixels set that should not have been) which the system will normally but not always cull.</span></span>

![Отображение верхнего левого правила](images/conservative-rasterization-0.png)

## <a name="interactions-with-the-pipeline"></a><span data-ttu-id="71ec2-121">Взаимодействие с конвейером</span><span class="sxs-lookup"><span data-stu-id="71ec2-121">Interactions with the pipeline</span></span>

<span data-ttu-id="71ec2-122">Дополнительные сведения о том, как консервативная растрирование взаимодействует с графическим конвейером, см. в разделе [D3D12 консервативная растрирование](/windows/desktop/direct3d12/conservative-rasterization).</span><span class="sxs-lookup"><span data-stu-id="71ec2-122">For many details on how conservative rasterization interacts with the graphics pipeline, refer to [D3D12 Conservative rasterization](/windows/desktop/direct3d12/conservative-rasterization).</span></span>

## <a name="implementation-details"></a><span data-ttu-id="71ec2-123">Сведения о реализации</span><span class="sxs-lookup"><span data-stu-id="71ec2-123">Implementation details</span></span>

<span data-ttu-id="71ec2-124">Тип растрирования, поддерживаемый Direct3D 12, иногда называется «неоцененной экономией».</span><span class="sxs-lookup"><span data-stu-id="71ec2-124">The type of rasterization supported in Direct3D 12 is sometimes referred to as "overestimated conservative rasterization".</span></span> <span data-ttu-id="71ec2-125">Также существует понятие "неполная оценка консервативной растеризации", что означает, что только пикселы, полностью охваченные визуализированным примитивом, растрируются.</span><span class="sxs-lookup"><span data-stu-id="71ec2-125">There is also the concept of "underestimated conservative rasterization", which means that only pixels that are fully covered by a rendered primitive are rasterized.</span></span> <span data-ttu-id="71ec2-126">Некоторая консервативная информация о растрировании доступна через шейдер пикселей за счет использования данных о покрытии, а в качестве режима растрирования доступен только неоцененная консервативная растрирование.</span><span class="sxs-lookup"><span data-stu-id="71ec2-126">Underestimated conservative rasterization information is available through the pixel shader through the use of input coverage data, and only overestimated conservative rasterization is available as a rasterizing mode.</span></span>

<span data-ttu-id="71ec2-127">Если какая-либо часть примитива перекрывает пиксел, то этот пиксель считается охваченным и затем растрируются.</span><span class="sxs-lookup"><span data-stu-id="71ec2-127">If any part of a primitive overlaps a pixel, then that pixel is considered covered and is then rasterized.</span></span> <span data-ttu-id="71ec2-128">Когда край или угол примитива попадают вдоль края или угла пикселя, применение "верхнего левого правила" зависит от реализации.</span><span class="sxs-lookup"><span data-stu-id="71ec2-128">When an edge or corner of a primitive falls along the edge or corner of a pixel, the application of the "top-left rule" is implementation-specific.</span></span> <span data-ttu-id="71ec2-129">Однако для реализаций, поддерживающих дегенерирование треугольников, вырожденный треугольник на границе или углу должен охватывать по крайней мере один пиксель.</span><span class="sxs-lookup"><span data-stu-id="71ec2-129">However, for implementations that support degenerate triangles, a degenerate triangle along an edge or corner must cover at least one pixel.</span></span>

<span data-ttu-id="71ec2-130">Консервативные реализации растрирования могут различаться на разных устройствах и выдавать ложные срабатывания, то есть они могут неправильно решить, что пикселы охвачены.</span><span class="sxs-lookup"><span data-stu-id="71ec2-130">Conservative rasterization implementations can vary on different hardware, and do produce false positives, meaning that they can incorrectly decide that pixels are covered.</span></span> <span data-ttu-id="71ec2-131">Это может произойти из-за сведений, относящихся к реализации, таких как примитивное увеличение или привязка ошибок, присущих координатам вершин с фиксированной точкой, которые используются при растрировании.</span><span class="sxs-lookup"><span data-stu-id="71ec2-131">This can occur because of implementation-specific details like primitive growing or snapping errors inherent in the fixed-point vertex coordinates used in rasterization.</span></span> <span data-ttu-id="71ec2-132">Причина ложного срабатывания (по отношению к координатам вершин с фиксированной точкой) является допустимой, так как требуется определенное количество ложных положительных результатов, чтобы реализация выполняла оценку покрытия для вершин с привязкой к ним (т. е. координаты вершин, преобразованные из 16,8 плавающей запятой в фиксированную точку с плавающей запятой), но учитывают покрытие, полученное исходными координатами</span><span class="sxs-lookup"><span data-stu-id="71ec2-132">The reason false positives (with respect to fixed point vertex coordinates) are valid is because some amount of false positives are needed to allow an implementation to do coverage evaluation against post-snapped vertices (i.e. vertex coordinates that have been converted from floating point to the 16.8 fixed-point used in the rasterizer), but honor the coverage produced by the original floating point vertex coordinates.</span></span>

<span data-ttu-id="71ec2-133">Консервативные реализации растрирования не создают ложные отрицательные значения относительно координат вершин с плавающей запятой для вырожденных примитивов после привязки: Если какая-либо часть примитива пересекается с любой частью пикселя, то этот пиксель будет растрирования.</span><span class="sxs-lookup"><span data-stu-id="71ec2-133">Conservative rasterization implementations do not produce false negatives with respect to the floating-point vertex coordinates for non-degenerate post-snap primitives: if any part of a primitive overlaps any part of a pixel, then that pixel is rasterized.</span></span>

<span data-ttu-id="71ec2-134">Треугольники, которые выявляются вырожденными (повторяющимися индексами в буфере индексов или коллинеарности в трехмерной области), или становятся вырожденными после преобразования с фиксированной запятой (в средствах формирования программной прорисовки), могут быть или не изменяться. Оба являются допустимыми поведениями.</span><span class="sxs-lookup"><span data-stu-id="71ec2-134">Triangles that are degenerate (duplicate indices in an index buffer or collinear in 3D), or become degenerate after fixed-point conversion (collinear vertices in the rasterizer), may or may not be culled; both are valid behaviors.</span></span> <span data-ttu-id="71ec2-135">Дегенерация треугольников должна считаться обратной стороной, поэтому если для приложения требуется определенное поведение, оно может использовать исключение обратной стороны или тест для внешнего доступа.</span><span class="sxs-lookup"><span data-stu-id="71ec2-135">Degenerate triangles must be considered back facing, so if a specific behavior is required by an application, it can use back-face culling or test for front facing.</span></span> <span data-ttu-id="71ec2-136">Вырожденные треугольники используют значения, присвоенные вершине 0 для всех интерполяций значений.</span><span class="sxs-lookup"><span data-stu-id="71ec2-136">Degenerate triangles use the values assigned to Vertex 0 for all interpolated values.</span></span>

<span data-ttu-id="71ec2-137">В дополнение к тому, что оборудование не поддерживает эту функцию, существует три уровня поддержки оборудования.</span><span class="sxs-lookup"><span data-stu-id="71ec2-137">There are three tiers of hardware support, in addition to the possibility that the hardware does not support this feature.</span></span>

-   <span data-ttu-id="71ec2-138">Уровень 1 поддерживает области неопределенности 1/2 пикселей и не создает отправку после привязки.</span><span class="sxs-lookup"><span data-stu-id="71ec2-138">Tier 1 supports 1/2 pixel uncertainty regions, and no post-snap degenerates.</span></span> <span data-ttu-id="71ec2-139">Это удобно для мозаичной отрисовки, текстуры Atlas, создания светлых карт и теневых карт в виде точек.</span><span class="sxs-lookup"><span data-stu-id="71ec2-139">This is good for tiled rendering, a texture atlas, light map generation and sub-pixel shadow maps.</span></span>
-   <span data-ttu-id="71ec2-140">На уровне 2 добавляются дегенерация после привязки и 1/256 неопределенности.</span><span class="sxs-lookup"><span data-stu-id="71ec2-140">Tier 2 adds post-snap degenerates, and 1/256 uncertainty regions.</span></span> <span data-ttu-id="71ec2-141">Также добавлена поддержка ускорения алгоритма на основе ЦП (например, вокселизатион).</span><span class="sxs-lookup"><span data-stu-id="71ec2-141">It also adds support for CPU-based algorithm acceleration (such as voxelization).</span></span>
-   <span data-ttu-id="71ec2-142">На уровне 3 добавляется 1/512 областей неопределенности, внутреннее покрытие ввода и поддержка перекрытияного отбора.</span><span class="sxs-lookup"><span data-stu-id="71ec2-142">Tier 3 adds 1/512 uncertainty regions, inner input coverage and supports occlusion culling.</span></span> <span data-ttu-id="71ec2-143">Покрытие ввода добавляет новое значение `SV_InnerCoverage` в язык штриховки высокого уровня (HLSL).</span><span class="sxs-lookup"><span data-stu-id="71ec2-143">The input coverage adds the new value `SV_InnerCoverage` to High Level Shading Language (HLSL).</span></span> <span data-ttu-id="71ec2-144">Это 32-разрядное скалярное целое число, которое может быть задано для входных данных в шейдер пикселей, а также представляет собой неоцененную информацию о растрирования (то есть, гарантируется ли полностью покрытая точка).</span><span class="sxs-lookup"><span data-stu-id="71ec2-144">This is a 32-bit scalar integer that can be specified on input to a pixel shader, and represents the underestimated conservative rasterization information (that is, whether a pixel is guaranteed-to-be-fully covered).</span></span>

## <a name="api-summary"></a><span data-ttu-id="71ec2-145">Сводные данные API</span><span class="sxs-lookup"><span data-stu-id="71ec2-145">API summary</span></span>

<span data-ttu-id="71ec2-146">Следующие методы, структуры, перечисления и вспомогательные классы ссылаются на консервативную растрирование:</span><span class="sxs-lookup"><span data-stu-id="71ec2-146">The following methods, structures, enums, and helper classes reference conservative rasterization:</span></span>

-   <span data-ttu-id="71ec2-147">[**D3D11 \_ Средство программной ПРОРИСОВКи \_ DESC2**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_rasterizer_desc2) : структура, содержащая описание средства программной прорисовки, с указанием вспомогательного класса CD3D12 средства программной \_ прорисовки \_ для создания описаний средства растеризации.</span><span class="sxs-lookup"><span data-stu-id="71ec2-147">[**D3D11\_RASTERIZER\_DESC2**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_rasterizer_desc2) : structure holding the rasterizer description, noting the CD3D12\_RASTERIZER\_DESC2 helper class for creating rasterizer descriptions.</span></span>
-   <span data-ttu-id="71ec2-148">[**D3D11 \_ КОНСЕРВАТИВНый \_ \_ режим растрирования**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_conservative_rasterization_mode) : перечисление значений для режима (включено или выключено).</span><span class="sxs-lookup"><span data-stu-id="71ec2-148">[**D3D11\_CONSERVATIVE\_RASTERIZATION\_MODE**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_conservative_rasterization_mode) : enum values for the mode (on or off).</span></span>
-   <span data-ttu-id="71ec2-149">[**D3D11 \_ FEATURE \_ Data \_ D3D11 \_ OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2) : структура, содержащая уровень поддержки.</span><span class="sxs-lookup"><span data-stu-id="71ec2-149">[**D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2) : structure holding the tier of support.</span></span>
-   <span data-ttu-id="71ec2-150">[**D3D11 \_ КОНСЕРВАТИВНый \_ \_ уровень растрирования**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_conservative_rasterization_tier) : перечислимые значения для каждого уровня поддержки оборудования.</span><span class="sxs-lookup"><span data-stu-id="71ec2-150">[**D3D11\_CONSERVATIVE\_RASTERIZATION\_TIER**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_conservative_rasterization_tier) : enum values for each tier of support by the hardware.</span></span>
-   <span data-ttu-id="71ec2-151">[**ID3D11Device:: чеккфеатуресуппорт**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) : метод для доступа к поддерживаемым функциям.</span><span class="sxs-lookup"><span data-stu-id="71ec2-151">[**ID3D11Device::CheckFeatureSupport**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) : method to access the supported features.</span></span>

## <a name="related-topics"></a><span data-ttu-id="71ec2-152">См. также</span><span class="sxs-lookup"><span data-stu-id="71ec2-152">Related topics</span></span>
* [<span data-ttu-id="71ec2-153">Функции Direct3D 11,3</span><span class="sxs-lookup"><span data-stu-id="71ec2-153">Direct3D 11.3 Features</span></span>](direct3d-11-3-features.md)