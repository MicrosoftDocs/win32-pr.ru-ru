---
title: Сопоставление текстур по умолчанию
description: Использование сопоставления текстур по умолчанию сокращает время копирования и использования памяти при совместном использовании данных изображений между GPU и ЦП.
ms.assetid: 77AF4BFA-09B5-4181-9408-002764F2A923
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f203c7590c3673d30315250b2b4ce2663e48c9c3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104410958"
---
# <a name="default-texture-mapping"></a><span data-ttu-id="cd927-103">Сопоставление текстур по умолчанию</span><span class="sxs-lookup"><span data-stu-id="cd927-103">Default Texture Mapping</span></span>

<span data-ttu-id="cd927-104">Использование сопоставления текстур по умолчанию сокращает время копирования и использования памяти при совместном использовании данных изображений между GPU и ЦП.</span><span class="sxs-lookup"><span data-stu-id="cd927-104">The use of default texture mapping reduces copying and memory usage while sharing image data between the GPU and the CPU.</span></span> <span data-ttu-id="cd927-105">Однако его следует использовать только в конкретных ситуациях.</span><span class="sxs-lookup"><span data-stu-id="cd927-105">However, it should only be used in specific situations.</span></span> <span data-ttu-id="cd927-106">Стандартный макет свиззле позволяет избежать копирования или группирующие данных в нескольких макетах.</span><span class="sxs-lookup"><span data-stu-id="cd927-106">The standard swizzle layout avoids copying or swizzling data in multiple layouts.</span></span>

-   [<span data-ttu-id="cd927-107">Обзор</span><span class="sxs-lookup"><span data-stu-id="cd927-107">Overview</span></span>](#overview)
-   [<span data-ttu-id="cd927-108">API-интерфейсы D3D 11.3</span><span class="sxs-lookup"><span data-stu-id="cd927-108">D3D11.3 APIs</span></span>](#d3d113-apis)
-   [<span data-ttu-id="cd927-109">См. также</span><span class="sxs-lookup"><span data-stu-id="cd927-109">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="cd927-110">Обзор</span><span class="sxs-lookup"><span data-stu-id="cd927-110">Overview</span></span>

<span data-ttu-id="cd927-111">Сопоставление текстур по умолчанию не должно быть первым выбором для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="cd927-111">Mapping default textures should not be the first choice for developers.</span></span> <span data-ttu-id="cd927-112">Разработчики должны сначала выполнять код на отдельном языке GPU (т. е. не иметь доступа к ЦП для большинства текстур и передавать их с помощью [**CopySubresourceRegion1**](/windows/desktop/api/D3D11_1/nf-d3d11_1-id3d11devicecontext1-copysubresourceregion1)).</span><span class="sxs-lookup"><span data-stu-id="cd927-112">Developers should code in a discrete-GPU friendly way first (that is, do not have any CPU access for the majority of textures and upload with [**CopySubresourceRegion1**](/windows/desktop/api/D3D11_1/nf-d3d11_1-id3d11devicecontext1-copysubresourceregion1)).</span></span> <span data-ttu-id="cd927-113">Но в некоторых случаях ЦП и GPU могут часто взаимодействовать в одних и тех же данных, что позволяет использовать текстуры по умолчанию для экономии энергии или для ускорения определенной архитектуры на определенных адаптерах или архитектурах.</span><span class="sxs-lookup"><span data-stu-id="cd927-113">But, for certain cases, the CPU and GPU may interact so frequently on the same data, that mapping default textures becomes helpful to save power, or to speed up a particular design on particular adapters or architectures.</span></span> <span data-ttu-id="cd927-114">Приложения должны обнаружить эти случаи и оптимизировать ненужные копии.</span><span class="sxs-lookup"><span data-stu-id="cd927-114">Applications should detect these cases and optimize out the unnecessary copies.</span></span>

<span data-ttu-id="cd927-115">В D3D 11.3 текстуры, созданные с помощью \_ макета текстуры D3D11, \_ \_ не определены (один элемент перечисления [**с \_ \_ макетом текстуры D3D11**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) ), а доступ ЦП не наиболее эффективен для частой отрисовки и выборки GPU.</span><span class="sxs-lookup"><span data-stu-id="cd927-115">In D3D11.3, textures created with D3D11\_TEXTURE\_LAYOUT\_UNDEFINED (one member of the [**D3D11\_TEXTURE\_LAYOUT**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) enum) and no CPU access are the most efficient for frequent GPU rendering and sampling.</span></span> <span data-ttu-id="cd927-116">При тестировании производительности эти текстуры должны сравниваться с \_ \_ макетом текстуры D3D11 \_ , который не ОПРЕДЕЛЕН с помощью ЦП, и D3D11, \_ \_ Макет текстуры \_ размером 64 КБ \_ \_ , Стандартный свиззле с доступом к ЦП и D3D11 \_ \_ строки макета текстуры \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="cd927-116">When performance testing, those textures should be compared against D3D11\_TEXTURE\_LAYOUT\_UNDEFINED with CPU access, and D3D11\_TEXTURE\_LAYOUT\_64K\_STANDARD\_SWIZZLE with CPU access, and D3D11\_TEXTURE\_LAYOUT\_ROW\_MAJOR for cross-adapter support.</span></span>

<span data-ttu-id="cd927-117">Использование \_ макета текстуры \_ D3D11 \_ undefine с доступом к ЦП позволяет методам [**вритетосубресаурце**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource), [**реадфромсубресаурце**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource), [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) (исключая доступ приложения к указателю) и отменять [**сопоставление**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap); но может пожертвовать производительность доступа GPU.</span><span class="sxs-lookup"><span data-stu-id="cd927-117">Using D3D11\_TEXTURE\_LAYOUT\_UNDEFINED with CPU access enables the methods [**WriteToSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource), [**ReadFromSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource), [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) (precluding application access to pointer), and [**Unmap**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap); but can sacrifice efficiency of GPU access.</span></span> <span data-ttu-id="cd927-118">Использование \_ макета текстуры \_ D3D11 \_ 64k \_ Standard \_ свиззле с доступом к ЦП позволяет **вритетосубресаурце**, **реадфромсубресаурце**, **Map** (который возвращает допустимый указатель на приложение) и **отменить сопоставление**.</span><span class="sxs-lookup"><span data-stu-id="cd927-118">Using D3D11\_TEXTURE\_LAYOUT\_64K\_STANDARD\_SWIZZLE with CPU access enables **WriteToSubresource**, **ReadFromSubresource**, **Map** (which returns a valid pointer to application), and **Unmap**.</span></span> <span data-ttu-id="cd927-119">Это также может пожертвовать эффективность доступа GPU, чем D3D11ный \_ \_ Макет текстуры, не \_ определенный с помощью доступа ЦП.</span><span class="sxs-lookup"><span data-stu-id="cd927-119">It can also sacrifice efficiency of GPU access more than D3D11\_TEXTURE\_LAYOUT\_UNDEFINED with CPU access.</span></span>

<span data-ttu-id="cd927-120">Как правило, приложения должны создавать большую часть текстур как доступную только GPU, а структура текстуры D3D11 не \_ \_ \_ определена.</span><span class="sxs-lookup"><span data-stu-id="cd927-120">In general, applications should create the majority of textures as GPU-only-accessible, and with D3D11\_TEXTURE\_LAYOUT\_UNDEFINED.</span></span>

<span data-ttu-id="cd927-121">Ранее для функции сопоставления текстур по умолчанию был только один стандартизированный макет для многомерных данных: «линейная», также известная как «строка-основная».</span><span class="sxs-lookup"><span data-stu-id="cd927-121">Previous to the mapping default textures feature, there was only one standardized layout for multi-dimensional data: "linear", also known as "row-major".</span></span> <span data-ttu-id="cd927-122">Приложения должны избегать использования \_ динамических текстур промежуточного хранения и использования, \_ если доступна схема по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="cd927-122">Applications should avoid USAGE\_STAGING and USAGE\_DYNAMIC textures when map default is available.</span></span> <span data-ttu-id="cd927-123">В \_ динамических текстурах для промежуточного использования и использования \_ используются линейные макеты.</span><span class="sxs-lookup"><span data-stu-id="cd927-123">The USAGE\_STAGING and USAGE\_DYNAMIC textures use the linear layout.</span></span>

<span data-ttu-id="cd927-124">D3D 11.3 (и D3D12) представляют собой стандартный многомерный макет данных.</span><span class="sxs-lookup"><span data-stu-id="cd927-124">D3D11.3 (and D3D12) introduce a standard multi-dimensional data layout.</span></span> <span data-ttu-id="cd927-125">Это делается для того, чтобы несколько единиц обработки работали с одними и теми же данными без копирования данных или группирующие данных между несколькими макетами.</span><span class="sxs-lookup"><span data-stu-id="cd927-125">This is done to enable multiple processing units to operate on the same data without copying the data or swizzling the data between multiple layouts.</span></span> <span data-ttu-id="cd927-126">Стандартизированный макет позволяет повысить эффективность благодаря сетевым эффектам и позволяет использовать алгоритмы для сокращенного использования определенного шаблона.</span><span class="sxs-lookup"><span data-stu-id="cd927-126">A standardized layout enables efficiency gains through network effects and allows algorithms to make short-cuts assuming a particular pattern.</span></span>

<span data-ttu-id="cd927-127">Обратите внимание, что этот стандарт свиззле является аппаратной функцией и может не поддерживаться всеми GPU.</span><span class="sxs-lookup"><span data-stu-id="cd927-127">Note though that this standard swizzle is a hardware feature, and may not be supported by all GPUs.</span></span>

## <a name="d3d113-apis"></a><span data-ttu-id="cd927-128">API-интерфейсы D3D 11.3</span><span class="sxs-lookup"><span data-stu-id="cd927-128">D3D11.3 APIs</span></span>

<span data-ttu-id="cd927-129">В отличие от D3D12, D3D 11.3 не поддерживает сопоставление текстур по умолчанию, поэтому необходимо запросить [**данные о \_ функциях D3D11 \_ \_ D3D11 \_ OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2).</span><span class="sxs-lookup"><span data-stu-id="cd927-129">Unlike D3D12, D3D11.3 does not supports texture mapping by default, so you need to query [**D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2).</span></span> <span data-ttu-id="cd927-130">Кроме того, необходимо запросить Стандартный свиззле, вызвав [**ID3D11Device:: чеккфеатуресуппорт**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) и установив флажок `StandardSwizzle64KBSupported` **D3D11 \_ Feature \_ Data \_ D3D11 \_ OPTIONS2**.</span><span class="sxs-lookup"><span data-stu-id="cd927-130">Standard swizzle will also need to be queried for with a call to [**ID3D11Device::CheckFeatureSupport**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) and checking the `StandardSwizzle64KBSupported` field of **D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**.</span></span>

<span data-ttu-id="cd927-131">Следующие API сопоставлены текстурные карты:</span><span class="sxs-lookup"><span data-stu-id="cd927-131">The following APIs reference texture mapping:</span></span>

<span data-ttu-id="cd927-132">Перечисления</span><span class="sxs-lookup"><span data-stu-id="cd927-132">Enums</span></span>

-   <span data-ttu-id="cd927-133">[**D3D11 \_ \_Макет текстуры**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) . управляет шаблоном свиззле текстур по умолчанию и включает поддержку карт для текстур по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="cd927-133">[**D3D11\_TEXTURE\_LAYOUT**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) : controls the swizzle pattern of default textures and enable map support on default textures.</span></span>
-   <span data-ttu-id="cd927-134">[**D3D11 \_ Функция**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_feature) : ссылается на [**D3D11 \_ Feature \_ Data \_ D3D11 \_ OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2).</span><span class="sxs-lookup"><span data-stu-id="cd927-134">[**D3D11\_FEATURE**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_feature) : references [**D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2).</span></span>
-   <span data-ttu-id="cd927-135">[**D3D11 \_ \_ \_ Флаг копирования плитки**](/windows/desktop/api/D3D11_2/ne-d3d11_2-d3d11_tile_copy_flag) : содержит флаги для копирования ресурсов свиззлед мозаичного заполнения в линейные буферы и из них.</span><span class="sxs-lookup"><span data-stu-id="cd927-135">[**D3D11\_TILE\_COPY\_FLAG**](/windows/desktop/api/D3D11_2/ne-d3d11_2-d3d11_tile_copy_flag) : contains flags to copy swizzled tiled resources to and from linear buffers.</span></span>

<span data-ttu-id="cd927-136">Структуры</span><span class="sxs-lookup"><span data-stu-id="cd927-136">Structures</span></span>

-   <span data-ttu-id="cd927-137">[**D3D11 \_ TEXTURE2D \_ DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture2d_desc1) : описывает двухмерную текстуру.</span><span class="sxs-lookup"><span data-stu-id="cd927-137">[**D3D11\_TEXTURE2D\_DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture2d_desc1) : describes a 2D texture.</span></span> <span data-ttu-id="cd927-138">Обратите внимание \_ на \_ вспомогательную структуру CD3D11 TEXTURE2D DESC1.</span><span class="sxs-lookup"><span data-stu-id="cd927-138">Note the CD3D11\_TEXTURE2D\_DESC1 helper structure.</span></span>
-   <span data-ttu-id="cd927-139">[**D3D11 \_ TEXTURE3D \_ DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture3d_desc1) : описывает трехмерную текстуру.</span><span class="sxs-lookup"><span data-stu-id="cd927-139">[**D3D11\_TEXTURE3D\_DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture3d_desc1) : describes a 3D texture.</span></span> <span data-ttu-id="cd927-140">Обратите внимание \_ на \_ вспомогательную структуру CD3D11 TEXTURE3D DESC1.</span><span class="sxs-lookup"><span data-stu-id="cd927-140">Note the CD3D11\_TEXTURE3D\_DESC1 helper structure.</span></span>

<span data-ttu-id="cd927-141">Методы</span><span class="sxs-lookup"><span data-stu-id="cd927-141">Methods</span></span>

-   <span data-ttu-id="cd927-142">[**ID3D11Device3:: CreateTexture2D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture2d1) : создает массив двумерных текстур.</span><span class="sxs-lookup"><span data-stu-id="cd927-142">[**ID3D11Device3::CreateTexture2D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture2d1) : creates an array of 2D textures.</span></span>
-   <span data-ttu-id="cd927-143">[**ID3D11Device3:: CreateTexture3D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture3d1) : создает одну трехмерную текстуру.</span><span class="sxs-lookup"><span data-stu-id="cd927-143">[**ID3D11Device3::CreateTexture3D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture3d1) : creates a single 3D texture.</span></span>
-   <span data-ttu-id="cd927-144">[**ID3D11Device3:: вритетосубресаурце**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource) : копирует данные в \_ \_ текстуру использования по умолчанию D3D11, которая была сопоставлена с помощью [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map).</span><span class="sxs-lookup"><span data-stu-id="cd927-144">[**ID3D11Device3::WriteToSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource) : copies data into a D3D11\_USAGE\_DEFAULT texture which was mapped using [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map).</span></span>
-   <span data-ttu-id="cd927-145">[**ID3D11Device3:: реадфромсубресаурце**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource) : копирует данные из \_ \_ текстуры использования по умолчанию D3D11, которая была сопоставлена с помощью [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map).</span><span class="sxs-lookup"><span data-stu-id="cd927-145">[**ID3D11Device3::ReadFromSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource) : copies data from a D3D11\_USAGE\_DEFAULT texture which was mapped using [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map).</span></span>
-   <span data-ttu-id="cd927-146">[**Ссылку ID3D11DeviceContext:: Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) : получает указатель на данные, содержащиеся во вложенном ресурсе, и запрещает доступ GPU к этому подресурсу.</span><span class="sxs-lookup"><span data-stu-id="cd927-146">[**ID3D11DeviceContext::Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) : gets a pointer to the data contained in a subresource, and denies the GPU access to that subresource.</span></span>
-   <span data-ttu-id="cd927-147">[**Ссылку ID3D11DeviceContext::**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap) unpointer: делает указатель на ресурс недействительным и повторно включает доступ GPU к этому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="cd927-147">[**ID3D11DeviceContext::Unmap**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap) : invalidates the pointer to a resource and reenables the GPU's access to that resource.</span></span>
-   <span data-ttu-id="cd927-148">[**ID3D11Texture2D1:: GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture2d1-getdesc1) : получает свойства ресурса двухмерной текстуры.</span><span class="sxs-lookup"><span data-stu-id="cd927-148">[**ID3D11Texture2D1::GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture2d1-getdesc1) : gets the properties of a 2D texture resource.</span></span>
-   <span data-ttu-id="cd927-149">[**ID3D11Texture3D1:: GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture3d1-getdesc1) : получает свойства ресурса трехмерной текстуры.</span><span class="sxs-lookup"><span data-stu-id="cd927-149">[**ID3D11Texture3D1::GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture3d1-getdesc1) : gets the properties of a 3D texture resource.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cd927-150">См. также</span><span class="sxs-lookup"><span data-stu-id="cd927-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cd927-151">Функции Direct3D 11,3</span><span class="sxs-lookup"><span data-stu-id="cd927-151">Direct3D 11.3 Features</span></span>](direct3d-11-3-features.md)
</dt> </dl>

 

 




