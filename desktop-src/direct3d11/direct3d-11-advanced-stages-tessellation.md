---
title: Этапы тесселяции
description: Среда выполнения Direct3D 11 поддерживает три новых этапа, реализующих тесселяцию, которая преобразует поверхности подразделений с низким уровнем детализации в примитивы более высокого уровня для GPU.
ms.assetid: 4ad2fd3e-6e1a-4326-8469-3198acf931dc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3aacb48ccc2c95ab93ba4f34212e654880d9a369
ms.sourcegitcommit: 4e4f9e7c90d25af0774deec1d44bd49fa9b6daa9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2020
ms.locfileid: "104339513"
---
# <a name="tessellation-stages"></a><span data-ttu-id="2ab0b-103">Этапы тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-103">Tessellation Stages</span></span>

<span data-ttu-id="2ab0b-104">Среда выполнения Direct3D 11 поддерживает три новых этапа, реализующих тесселяцию, которая преобразует поверхности подразделений с низким уровнем детализации в примитивы более высокого уровня для GPU.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-104">The Direct3D 11 runtime supports three new stages that implement tessellation, which converts low-detail subdivision surfaces into higher-detail primitives on the GPU.</span></span> <span data-ttu-id="2ab0b-105">Тесселяции разбивает на плитки поверхности старшего порядка на структуры, подходящие для прорисовки.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-105">Tessellation tiles (or breaks up) high-order surfaces into suitable structures for rendering.</span></span>

<span data-ttu-id="2ab0b-106">Реализуя тесселяцию на аппаратном оборудовании, графический конвейер может оценить модели низкой детализации (с малым числом полигоном) и прорисовать их более детально.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-106">By implementing tessellation in hardware, a graphics pipeline can evaluate lower detail (lower polygon count) models and render in higher detail.</span></span> <span data-ttu-id="2ab0b-107">Хоть выполнение тесселяции возможно и программными методами, аппаратная тесселяция может дать огромное число визуальных деталей (включая поддержку карт смещения) без добавления визуальных деталей к размерам моделей и парализации частот обновления.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-107">While software tessellation can be done, tessellation implemented by hardware can generate an incredible amount of visual detail (including support for displacement mapping) without adding the visual detail to the model sizes and paralyzing refresh rates.</span></span>

-   [<span data-ttu-id="2ab0b-108">Преимущества тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-108">Tessellation Benefits</span></span>](#tessellation-benefits)
-   [<span data-ttu-id="2ab0b-109">Новые этапы конвейера</span><span class="sxs-lookup"><span data-stu-id="2ab0b-109">New Pipeline Stages</span></span>](#new-pipeline-stages)
    -   [<span data-ttu-id="2ab0b-110">Поверхности — этап шейдера</span><span class="sxs-lookup"><span data-stu-id="2ab0b-110">Hull-Shader Stage</span></span>](#hull-shader-stage)
    -   [<span data-ttu-id="2ab0b-111">Стадия тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-111">Tessellator Stage</span></span>](#tessellator-stage)
    -   [<span data-ttu-id="2ab0b-112">Этап шейдера домена</span><span class="sxs-lookup"><span data-stu-id="2ab0b-112">Domain-Shader Stage</span></span>](#domain-shader-stage)
-   [<span data-ttu-id="2ab0b-113">API для инициализации этапов тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-113">APIs for initializing Tessellation Stages</span></span>](#apis-for-initializing-tessellation-stages)
-   [<span data-ttu-id="2ab0b-114">Как:</span><span class="sxs-lookup"><span data-stu-id="2ab0b-114">How to's:</span></span>](#how-tos)
-   [<span data-ttu-id="2ab0b-115">См. также</span><span class="sxs-lookup"><span data-stu-id="2ab0b-115">Related topics</span></span>](#related-topics)

## <a name="tessellation-benefits"></a><span data-ttu-id="2ab0b-116">Преимущества тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-116">Tessellation Benefits</span></span>

<span data-ttu-id="2ab0b-117">Тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-117">Tessellation:</span></span>

-   <span data-ttu-id="2ab0b-118">Экономит много памяти и пропускной способности, что позволяет приложению визуализировать более детализированные поверхности из моделей с низким разрешением.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-118">Saves lots of memory and bandwidth, which allows an application to render higher detailed surfaces from low-resolution models.</span></span> <span data-ttu-id="2ab0b-119">Методика тесселяции, реализованная в конвейере Direct3D 11, также поддерживает сопоставление смещения, что может привести к привлекательным объемам сведений о поверхности.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-119">The tessellation technique implemented in the Direct3D 11 pipeline also supports displacement mapping, which can produce stunning amounts of surface detail.</span></span>
-   <span data-ttu-id="2ab0b-120">Поддерживает масштабируемые методы отрисовки, такие как непрерывные или Просмотр зависимых уровней детализации, которые можно рассчитывать на лету.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-120">Supports scalable-rendering techniques, such as continuous or view dependent levels-of-detail which can be calculated on the fly.</span></span>
-   <span data-ttu-id="2ab0b-121">Повышает производительность, выполняя ресурсоемкие вычисления с более низкой частотой (выполняя вычисления в модели с более низким уровнем детализации).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-121">Improves performance by performing expensive computations at lower frequency (doing calculations on a lower-detail model).</span></span> <span data-ttu-id="2ab0b-122">Сюда могут входить расчеты смешения с применением форм наложения и морфинговые цели для реалистичной анимации или физических расчетов для обнаружения столкновений или эмуляции динамики мягких тел.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-122">This could include blending calculations using blend shapes or morph targets for realistic animation or physics calculations for collision detection or soft body dynamics.</span></span>

<span data-ttu-id="2ab0b-123">Конвейер Direct3D 11 реализует тесселяцию в аппаратном обеспечении, что позволяет загружать работу с ЦП на GPU.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-123">The Direct3D 11 pipeline implements tessellation in hardware, which off-loads the work from the CPU to the GPU.</span></span> <span data-ttu-id="2ab0b-124">Это может дать очень существенный прирост производительности, если в приложение реализуется большое число морфинговых целей и/или более сложные модели деформации/скиннинга.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-124">This can lead to very large performance improvements if an application implements large numbers of morph targets and/or more sophisticated skinning/deformation models.</span></span> <span data-ttu-id="2ab0b-125">Чтобы получить доступ к новым функциям тесселяции, необходимо изучить некоторые новые этапы конвейера.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-125">To access the new tessellation features, you must learn about some new pipeline stages.</span></span>

## <a name="new-pipeline-stages"></a><span data-ttu-id="2ab0b-126">Новые этапы конвейера</span><span class="sxs-lookup"><span data-stu-id="2ab0b-126">New Pipeline Stages</span></span>

<span data-ttu-id="2ab0b-127">В ходе тесселяции задействуется GPU для расчета более подробной поверхности из поверхности, составленной из преобразований четырехугольников, треугольников и изолиний.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-127">Tessellation uses the GPU to calculate a more detailed surface from a surface constructed from quad patches, triangle patches or isolines.</span></span> <span data-ttu-id="2ab0b-128">Для аппроксимации поверхности высокого порядка, каждое преобразование подразделяется на треугольники, точки и линии согласно факторам тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-128">To approximate the high-ordered surface, each patch is subdivided into triangles, points, or lines using tessellation factors.</span></span> <span data-ttu-id="2ab0b-129">Конвейер Direct3D 11 реализует тесселяцию, используя три новых этапа конвейера:</span><span class="sxs-lookup"><span data-stu-id="2ab0b-129">The Direct3D 11 pipeline implements tessellation using three new pipeline stages:</span></span>

-   <span data-ttu-id="2ab0b-130">[Поверхности-Shader Stage](#hull-shader-stage) — программируемый этап шейдера, который создает геометрический набор исправлений (и константы исправлений), соответствующий каждому выходному исправлению (Quad, треугольник или линия).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-130">[Hull-Shader Stage](#hull-shader-stage) - A programmable shader stage that produces a geometry patch (and patch constants) that correspond to each input patch (quad, triangle, or line).</span></span>
-   <span data-ttu-id="2ab0b-131">[Стадия тесселяции](#tessellator-stage) . этап конвейера фиксированной функции, который создает шаблон выборки для домена, который представляет собой исправление геометрии, и создает набор объектов меньшего размера (треугольники, точки или линии), соединяющий эти образцы.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-131">[Tessellator Stage](#tessellator-stage) - A fixed function pipeline stage that creates a sampling pattern of the domain that represents the geometry patch and generates a set of smaller objects (triangles, points, or lines) that connect these samples.</span></span>
-   <span data-ttu-id="2ab0b-132">[Этап шейдера домена](#domain-shader-stage) — программируемый этап шейдера, который вычисляет расположение вершины, соответствующее образцу каждого домена.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-132">[Domain-Shader Stage](#domain-shader-stage) - A programmable shader stage that calculates the vertex position that corresponds to each domain sample.</span></span>

<span data-ttu-id="2ab0b-133">На следующей схеме показаны новые этапы конвейера Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-133">The following diagram highlights the new stages of the Direct3D 11 pipeline.</span></span>

![схема конвейера direct3d 11, с выделенными этапами шейдера поверхности, тесселятора и шейдера доменов](images/d3d11-pipeline-stages-tessellation.png)

<span data-ttu-id="2ab0b-135">На следующей схеме показано выполнение этапов тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-135">The following diagram shows the progression through the tessellation stages.</span></span> <span data-ttu-id="2ab0b-136">Выполнение начинается с меньшей поверхности с низкой степенью детализации.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-136">The progression starts with the low-detail subdivision surface.</span></span> <span data-ttu-id="2ab0b-137">Далее рассматривается входное преобразование с соответствующим преобразованием геометрии, выборками домена и треугольниками, которые соединяют эти выборки.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-137">The progression next highlights the input patch with the corresponding geometry patch, domain samples, and triangles that connect these samples.</span></span> <span data-ttu-id="2ab0b-138">Наконец выделяются вершины, которые соответствуют этим выборкам.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-138">The progression finally highlights the vertices that correspond to these samples.</span></span>

![схема выполнения тесселяции](images/tess-prog.png)

### <a name="hull-shader-stage"></a><span data-ttu-id="2ab0b-140">Стадия Hull-Shader</span><span class="sxs-lookup"><span data-stu-id="2ab0b-140">Hull-Shader Stage</span></span>

<span data-ttu-id="2ab0b-141">Шейдер поверхности, который вызывается один раз для каждого исправления — преобразует входные точки управления, которые определяют поверхность низкого порядка в контрольных точках, составляющих исправление.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-141">A hull shader -- which is invoked once per patch -- transforms input control points that define a low-order surface into control points that make up a patch.</span></span> <span data-ttu-id="2ab0b-142">Он также выполняет некоторые вычисления с исправлениями для предоставления данных для этапа тесселяции и этапа домена.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-142">It also does some per patch calculations to provide data for the tessellation stage and the domain stage.</span></span> <span data-ttu-id="2ab0b-143">На самом простом уровне черного ящика этап поверхности-Shader будет выглядеть примерно так, как на следующей диаграмме.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-143">At the simplest black-box level, the hull-shader stage would look something like the following diagram.</span></span>

![схема этапа шейдера поверхностей](images/d3d11-hull-shader.png)

<span data-ttu-id="2ab0b-145">Шейдер поверхности реализуется с помощью функции HLSL и имеет следующие свойства.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-145">A hull shader is implemented with an HLSL function, and has the following properties:</span></span>

-   <span data-ttu-id="2ab0b-146">Вход шейдера находится в диапазоне от 1 до 32 контрольных точек.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-146">The shader input is between 1 and 32 control points.</span></span>
-   <span data-ttu-id="2ab0b-147">Шейдер выводит от 1 до 32 контрольных точек независимо от количества факторов тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-147">The shader output is between 1 and 32 control points, regardless of the number of tessellation factors.</span></span> <span data-ttu-id="2ab0b-148">Выходные контрольные точки шейдера поверхностей могут использоваться на этапе шейдера доменов.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-148">The control-points output from a hull shader can be consumed by the domain-shader stage.</span></span> <span data-ttu-id="2ab0b-149">Данные констант исправлений можно использовать в шейдере доменов. факторы тесселяции могут быть использованы шейдером доменов и стадией тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-149">Patch constant data can be consumed by a domain shader; tessellation factors can be consumed by the domain shader and the tessellation stage.</span></span>
-   <span data-ttu-id="2ab0b-150">Факторы тесселяции определяют, на сколько частей делить каждый участок.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-150">Tessellation factors determine how much to subdivide each patch.</span></span>
-   <span data-ttu-id="2ab0b-151">Шейдер объявляет состояние, требуемое для этапа тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-151">The shader declares the state required by the tessellator stage.</span></span> <span data-ttu-id="2ab0b-152">Сюда входят такие сведения, как число контрольных точек, тип поверхности участка и тип секционирования при тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-152">This includes information such as the number of control points, the type of patch face and the type of partitioning to use when tessellating.</span></span> <span data-ttu-id="2ab0b-153">Эти сведения появляются в виде объявлений, как правило, в начале кода шейдера.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-153">This information appears as declarations typically at the front of the shader code.</span></span>
-   <span data-ttu-id="2ab0b-154">Если на этапе поверхности-шейдера для каждого фактора тесселяции ребра задается значение = 0 или NaN, исправление будет исправлено.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-154">If the hull-shader stage sets any edge tessellation factor to = 0 or NaN, the patch will be culled.</span></span> <span data-ttu-id="2ab0b-155">В результате, этап тесселяции может выполняться или не выполняться, шейдер доменов не будет выполняться, а для указанного участка не будет выдано видимых выходных данных.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-155">As a result, the tessellator stage may or may not run, the domain shader will not run, and no visible output will be produced for that patch.</span></span>

<span data-ttu-id="2ab0b-156">На более глубоком уровне поверхности-шейдер на самом деле работает в два этапа: этап контрольной точки и фаза исправления — постоянной, которые выполняются параллельно с оборудованием.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-156">At a deeper level, a hull-shader actually operates in two phases: a control-point phase and a patch-constant phase, which are run in parallel by the hardware.</span></span> <span data-ttu-id="2ab0b-157">Компилятор HLSL извлекает параллелизм в шейдере поверхностей и кодирует его в байт-код, управляющий оборудованием.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-157">The HLSL compiler extracts the parallelism in a hull shader and encodes it into bytecode that drives the hardware.</span></span>

-   <span data-ttu-id="2ab0b-158">Этап контрольных точек выполняется единожды для каждой контрольной точки. При этом считываются контрольные точки для участка и создается одна выходная контрольная точка (определенная ControlPointID).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-158">The control-point phase operates once for each control-point, reading the control points for a patch, and generating one output control point (identified by a ControlPointID).</span></span>
-   <span data-ttu-id="2ab0b-159">Этап констант участков выполняется единожды для каждого участка. При этом создаются факторы тесселяции ребер и другие константы отдельных участков.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-159">The patch-constant phase operates once per patch to generate edge tessellation factors and other per-patch constants.</span></span> <span data-ttu-id="2ab0b-160">Внутри системы может одновременно выполняться множество этапов констант участков.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-160">Internally, many patch-constant phases may run at the same time.</span></span> <span data-ttu-id="2ab0b-161">Этап констант участков есть доступ только для чтения ко всем входным и выходным контрольным точкам.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-161">The patch-constant phase has read-only access to all input and output control points.</span></span>

<span data-ttu-id="2ab0b-162">Ниже приведен пример шейдера поверхности:</span><span class="sxs-lookup"><span data-stu-id="2ab0b-162">Here's an example of a hull shader:</span></span>


```
[patchsize(12)]
[patchconstantfunc(MyPatchConstantFunc)]
MyOutPoint main(uint Id : SV_ControlPointID,
     InputPatch<MyInPoint, 12> InPts)
{
     MyOutPoint result;
     
     ...
     
     result = TransformControlPoint( InPts[Id] );

     return result;
}
```



<span data-ttu-id="2ab0b-163">Пример создания шейдера поверхности см. [в разделе как создать поверхности шейдер](direct3d-11-advanced-stages-hull-shader-create.md).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-163">For an example that creates a hull shader, see [How To: Create a Hull Shader](direct3d-11-advanced-stages-hull-shader-create.md).</span></span>

### <a name="tessellator-stage"></a><span data-ttu-id="2ab0b-164">Стадия тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-164">Tessellator Stage</span></span>

<span data-ttu-id="2ab0b-165">Тесселяция — это этап с фиксированной функцией, инициализированный путем привязки шейдера поверхности к конвейеру (см. раздел [как инициализировать этап тесселяции](direct3d-11-advanced-stages-tessellator-initialize.md)).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-165">The tessellator is a fixed-function stage initialized by binding a hull shader to the pipeline (see [How To: Initialize the Tessellator Stage](direct3d-11-advanced-stages-tessellator-initialize.md)).</span></span> <span data-ttu-id="2ab0b-166">Назначение этапа тесселятора подразделить домен (четырехугольник, треугольник или линию ) на большое число меньших объектов (треугольников, точек или линий).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-166">The purpose of the tessellator stage is to subdivide a domain (quad, tri, or line) into many smaller objects (triangles, points or lines).</span></span> <span data-ttu-id="2ab0b-167">Тесселятор разбивает канонический домен в нормализованной (ноль к единице) системе координат.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-167">The tessellator tiles a canonical domain in a normalized (zero-to-one) coordinate system.</span></span> <span data-ttu-id="2ab0b-168">Например, домен четырехугольника тесселируется в единичный квадрат.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-168">For example, a quad domain is tessellated to a unit square.</span></span>

<span data-ttu-id="2ab0b-169">Тесселяция выполняется единожды для каждого участка с использованием факторов тесселяции (указывают тщательность тесселяции домена) и типа секционирования (указывает алгоритм разделения участка на части), переданных с предыдущего этапа шейдера поверхностей.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-169">The tessellator operates once per patch using the tessellation factors (which specify how finely the domain will be tessellated) and the type of partitioning (which specifies the algorithm used to slice up a patch) that are passed in from the hull-shader stage.</span></span> <span data-ttu-id="2ab0b-170">Тесселяция выводит координаты uv (дополнительно — w) и топологию поверхности для этапа шейдера доменов.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-170">The tessellator outputs uv (and optionally w) coordinates and the surface topology to the domain-shader stage.</span></span>

<span data-ttu-id="2ab0b-171">На внутреннем уровне тесселяция работает в два этапа:</span><span class="sxs-lookup"><span data-stu-id="2ab0b-171">Internally, the tessellator operates in two phases:</span></span>

-   <span data-ttu-id="2ab0b-172">В ходе первой фазы обрабатываются факторы тесселяции, устраняются ошибки округления, обрабатываются очень маленькие факторы, уменьшаются и объединяются факторы, при этом применяется 32-разрядная арифметика с плавающей запятой.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-172">The first phase processes the tessellation factors, fixing rounding problems, handling very small factors, reducing and combining factors, using 32-bit floating-point arithmetic.</span></span>
-   <span data-ttu-id="2ab0b-173">На второй фазе формируются списки точек или топологи на основе выбранного типа секционирования.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-173">The second phase generates point or topology lists based on the type of partitioning selected.</span></span> <span data-ttu-id="2ab0b-174">Это основная задача этапа тесселятора, где применяются 16-разрядные дроби с арифметикой фиксированной точки.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-174">This is the core task of the tessellator stage and uses 16-bit fractions with fixed-point arithmetic.</span></span> <span data-ttu-id="2ab0b-175">Арифметику фиксированной точки можно ускорить аппаратно с сохранением допустимый точности.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-175">Fixed-point arithmetic allows hardware acceleration while maintaining acceptable precision.</span></span> <span data-ttu-id="2ab0b-176">Например, для преобразования шириной 64 метра такая точность позволяет размещать точки с разрешением в 2 мм.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-176">For example, given a 64 meter wide patch, this precision can place points at a 2 mm resolution.</span></span>



| <span data-ttu-id="2ab0b-177">Тип секционирования</span><span class="sxs-lookup"><span data-stu-id="2ab0b-177">Type of Partitioning</span></span> | <span data-ttu-id="2ab0b-178">Диапазон</span><span class="sxs-lookup"><span data-stu-id="2ab0b-178">Range</span></span>                       |
|----------------------|-----------------------------|
| <span data-ttu-id="2ab0b-179">нечетные доли \_</span><span class="sxs-lookup"><span data-stu-id="2ab0b-179">fractional\_odd</span></span>      | <span data-ttu-id="2ab0b-180">\[1... 63\]</span><span class="sxs-lookup"><span data-stu-id="2ab0b-180">\[1...63\]</span></span>                  |
| <span data-ttu-id="2ab0b-181">частичное \_ четное</span><span class="sxs-lookup"><span data-stu-id="2ab0b-181">fractional\_even</span></span>     | <span data-ttu-id="2ab0b-182">Диапазон Тессфактор: \[ 2.. 64\]</span><span class="sxs-lookup"><span data-stu-id="2ab0b-182">TessFactor range: \[2..64\]</span></span> |
| <span data-ttu-id="2ab0b-183">Целое число</span><span class="sxs-lookup"><span data-stu-id="2ab0b-183">integer</span></span>              | <span data-ttu-id="2ab0b-184">Диапазон Тессфактор: \[ 1.. 64\]</span><span class="sxs-lookup"><span data-stu-id="2ab0b-184">TessFactor range: \[1..64\]</span></span> |
| <span data-ttu-id="2ab0b-185">pow2</span><span class="sxs-lookup"><span data-stu-id="2ab0b-185">pow2</span></span>                 | <span data-ttu-id="2ab0b-186">Диапазон Тессфактор: \[ 1.. 64\]</span><span class="sxs-lookup"><span data-stu-id="2ab0b-186">TessFactor range: \[1..64\]</span></span> |



 

### <a name="domain-shader-stage"></a><span data-ttu-id="2ab0b-187">Стадия Domain-Shader</span><span class="sxs-lookup"><span data-stu-id="2ab0b-187">Domain-Shader Stage</span></span>

<span data-ttu-id="2ab0b-188">Шейдер домена вычисляет позицию вершины разделенной точки в выходном исправлении.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-188">A domain shader calculates the vertex position of a subdivided point in the output patch.</span></span> <span data-ttu-id="2ab0b-189">Шейдер домена выполняется один раз для выходной точки тесселяции и имеет доступ только для чтения к выводу UV-координат, выходное исправление поверхности шейдеров и константы выходного исправления поверхности Shader, как показано на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-189">A domain shader is run once per tessellator stage output point and has read-only access to the tessellator stage output UV coordinates, the hull shader output patch, and the hull shader output patch constants, as the following diagram shows.</span></span>

![схема этапа шейдера доменов](images/d3d11-domain-shader.png)

<span data-ttu-id="2ab0b-191">Ниже перечислены свойства шейдера доменов.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-191">Properties of the domain shader include:</span></span>

-   <span data-ttu-id="2ab0b-192">Шейдер домена вызывается один раз для каждой координаты вывода на этапе тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-192">A domain shader is invoked once per output coordinate from the tessellator stage.</span></span>
-   <span data-ttu-id="2ab0b-193">Шейдер домена использует контрольные точки вывода из этапа поверхности-шейдера.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-193">A domain shader consumes output control points from the hull-shader stage.</span></span>
-   <span data-ttu-id="2ab0b-194">Шейдер домена выводит расположение вершины.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-194">A domain shader outputs the position of a vertex.</span></span>
-   <span data-ttu-id="2ab0b-195">Входными данными являются выходные данные шейдера поверхности, включая контрольные точки, постоянные данные исправления и факторы тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-195">Inputs are the hull shader outputs including control points, patch constant data and tessellation factors.</span></span> <span data-ttu-id="2ab0b-196">Факторы тесселяции могут включать значения, используемые тесселяции фиксированных функций, а также необработанные значения (например, до округления по целочисленной тесселяции), что упрощает геотрансформация, например.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-196">The tessellation factors can include the values used by the fixed function tessellator as well as the raw values (before rounding by integer tessellation, for example), which facilitates geomorphing, for example.</span></span>

<span data-ttu-id="2ab0b-197">После завершения работы шейдера доменов тесселяция завершается, и данные конвейера переходит к следующему этапу конвейера (шейдер геометрии, шейдер пикселей и т. д.).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-197">After the domain shader completes, tessellation is finished and pipeline data continues to the next pipeline stage (geometry shader, pixel shader etc).</span></span> <span data-ttu-id="2ab0b-198">Шейдер геометрии, ожидающий примитивы со смежностью (например, 6 вершин на треугольник), недействителен при активной тесселяции (это приводит к неопределенному поведению, о чем будет сообщать уровень отладки).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-198">A geometry shader that expects primitives with adjacency (for example, 6 vertices per triangle) is not valid when tessellation is active (this results in undefined behavior, which the debug layer will complain about).</span></span>

<span data-ttu-id="2ab0b-199">Ниже приведен пример шейдера домена.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-199">Here is an example of a domain shader:</span></span>


```
void main( out    MyDSOutput result, 
           float2 myInputUV : SV_DomainPoint, 
           MyDSInput DSInputs,
           OutputPatch<MyOutPoint, 12> ControlPts, 
           MyTessFactors tessFactors)
{
     ...

     result.Position = EvaluateSurfaceUV(ControlPoints, myInputUV);
}
```



## <a name="apis-for-initializing-tessellation-stages"></a><span data-ttu-id="2ab0b-200">API для инициализации этапов тесселяции</span><span class="sxs-lookup"><span data-stu-id="2ab0b-200">APIs for initializing Tessellation Stages</span></span>

<span data-ttu-id="2ab0b-201">Тесселяция реализуется с помощью двух новых стадий программируемого шейдера: шейдера поверхности и шейдера доменов.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-201">Tessellation is implemented with two new programmable shader stages: a hull shader and a domain shader.</span></span> <span data-ttu-id="2ab0b-202">Эти новые этапы шейдера запрограммированы с помощью кода HLSL, определенного в модели шейдера 5.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-202">These new shader stages are programmed with HLSL code that is defined in shader model 5.</span></span> <span data-ttu-id="2ab0b-203">Новые цели шейдера: HS \_ 5 \_ 0 и DS \_ 5 \_ 0.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-203">The new shader targets are: hs\_5\_0 and ds\_5\_0.</span></span> <span data-ttu-id="2ab0b-204">Как и все программируемые этапы шейдера, код для оборудования извлекается из скомпилированных шейдеров, переданных в среду выполнения, когда шейдеры привязаны к конвейеру с помощью таких интерфейсов API, как [**дссетшадер**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dssetshader) и [**хссетшадер**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hssetshader).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-204">Like all programmable shader stages, code for the hardware is extracted from compiled shaders passed into the runtime when shaders are bound to the pipeline using APIs such as [**DSSetShader**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dssetshader) and [**HSSetShader**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hssetshader).</span></span> <span data-ttu-id="2ab0b-205">Но сначала шейдер необходимо создать с помощью интерфейсов API, таких как [**креатехуллшадер**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createhullshader) и [**креатедомаиншадер**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createdomainshader).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-205">But first, the shader must be created using APIs such as [**CreateHullShader**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createhullshader) and [**CreateDomainShader**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createdomainshader).</span></span>

<span data-ttu-id="2ab0b-206">Включите тесселяцию, создав шейдер поверхности и привязав его к этапу шейдера поверхности (это автоматически настраивает этап тесселятора).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-206">Enable tessellation by creating a hull shader and binding it to the hull-shader stage (this automatically sets up the tessellator stage).</span></span> <span data-ttu-id="2ab0b-207">Для формирования финальных позиций вершин из тесселированных преобразований также понадобится создать шейдер доменов и привязать его к этапу шейдера доменов.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-207">To generate the final vertex positions from the tessellated patches, you will also need to create a domain shader and bind it to the domain-shader stage.</span></span> <span data-ttu-id="2ab0b-208">После включения тесселяции входные данные на этапе ассемблерного ввода должны быть данными исправлений.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-208">Once tessellation is enabled, the data input to the input-assembler stage must be patch data.</span></span> <span data-ttu-id="2ab0b-209">Это значит, что топология входного ассемблера должна представлять собой топологию постоянного исправления из [**D3D11- \_ примитивной \_ топологии**](/previous-versions/windows/desktop/legacy/ff476189(v=vs.85)) , установленной с [**иасетпримитиветопологи**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetprimitivetopology).</span><span class="sxs-lookup"><span data-stu-id="2ab0b-209">That is, the input assembler topology must be a patch constant topology from [**D3D11\_PRIMITIVE\_TOPOLOGY**](/previous-versions/windows/desktop/legacy/ff476189(v=vs.85)) set with [**IASetPrimitiveTopology**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetprimitivetopology).</span></span>

<span data-ttu-id="2ab0b-210">Чтобы отключить тесселяцию, установите для шейдера поверхности и шейдера доменов значение **NULL**.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-210">To disable tessellation, set the hull shader and the domain shader to **NULL**.</span></span> <span data-ttu-id="2ab0b-211">Ни стадия с геометрическим шейдером, ни стадия потокового вывода не могут считывать контрольные точки вывода поверхности или данные исправлений.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-211">Neither the geometry-shader stage nor the stream-output stage can read hull-shader output-control points or patch data.</span></span>

-   <span data-ttu-id="2ab0b-212">Новые топологии для этапа входного ассемблера, которые являются расширениями для этого перечисления.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-212">New topologies for the input-assembler stage, which are extensions to this enumeration.</span></span>

    ```
    enum D3D11_PRIMITIVE_TOPOLOGY
    ```

    

    <span data-ttu-id="2ab0b-213">Топология задается на этапе входного ассемблера с помощью [ **иасетпримитиветопологи**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetprimitivetopology)</span><span class="sxs-lookup"><span data-stu-id="2ab0b-213">The topology is set to the input-assembler stage using [**IASetPrimitiveTopology**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetprimitivetopology)</span></span>

-   <span data-ttu-id="2ab0b-214">Разумеется, для новых программируемых стадий шейдера требуется задать другое состояние, чтобы привязать константные буферы, примеры и ресурсы шейдера к соответствующим этапам конвейера.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-214">Of course, the new programmable shader stages require other state to be set, to bind constant buffers, samples, and shader resources to the appropriate pipeline stages.</span></span> <span data-ttu-id="2ab0b-215">Эти новые методы ID3D11Device реализуются для установки этого состояния.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-215">These new ID3D11Device methods are implemented for setting this state.</span></span>
    -   [<span data-ttu-id="2ab0b-216">**дсжетконстантбуфферс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-216">**DSGetConstantBuffers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dsgetconstantbuffers)
    -   [<span data-ttu-id="2ab0b-217">**дсжетсамплерс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-217">**DSGetSamplers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dsgetsamplers)
    -   [<span data-ttu-id="2ab0b-218">**дсжетшадер**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-218">**DSGetShader**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dsgetshader)
    -   [<span data-ttu-id="2ab0b-219">**дсжетшадерресаурцес**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-219">**DSGetShaderResources**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dsgetshaderresources)
    -   [<span data-ttu-id="2ab0b-220">**дссетконстантбуфферс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-220">**DSSetConstantBuffers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dssetconstantbuffers)
    -   [<span data-ttu-id="2ab0b-221">**дссетсамплерс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-221">**DSSetSamplers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dssetsamplers)
    -   [<span data-ttu-id="2ab0b-222">**дссетшадер**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-222">**DSSetShader**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dssetshader)
    -   [<span data-ttu-id="2ab0b-223">**дссетшадерресаурцес**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-223">**DSSetShaderResources**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dssetshaderresources)
    -   [<span data-ttu-id="2ab0b-224">**хсжетконстантбуфферс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-224">**HSGetConstantBuffers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hsgetconstantbuffers)
    -   [<span data-ttu-id="2ab0b-225">**хсжетшадерресаурцес**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-225">**HSGetShaderResources**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hsgetshaderresources)
    -   [<span data-ttu-id="2ab0b-226">**хсжетсамплерс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-226">**HSGetSamplers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hsgetsamplers)
    -   [<span data-ttu-id="2ab0b-227">**хсжетшадер**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-227">**HSGetShader**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hsgetshader)
    -   [<span data-ttu-id="2ab0b-228">**хссетконстантбуфферс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-228">**HSSetConstantBuffers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hssetconstantbuffers)
    -   [<span data-ttu-id="2ab0b-229">**хссетсамплерс**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-229">**HSSetSamplers**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hssetsamplers)
    -   [<span data-ttu-id="2ab0b-230">**хссетшадер**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-230">**HSSetShader**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hssetshader)
    -   [<span data-ttu-id="2ab0b-231">**хссетшадерресаурцес**</span><span class="sxs-lookup"><span data-stu-id="2ab0b-231">**HSSetShaderResources**</span></span>](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-hssetshaderresources)

## <a name="how-tos"></a><span data-ttu-id="2ab0b-232">Как:</span><span class="sxs-lookup"><span data-stu-id="2ab0b-232">How to's:</span></span>

<span data-ttu-id="2ab0b-233">Документация также содержит примеры инициализации этапов тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-233">The documentation also contains examples for initializing the tessellation stages.</span></span>



| <span data-ttu-id="2ab0b-234">Элемент</span><span class="sxs-lookup"><span data-stu-id="2ab0b-234">Item</span></span>                                                                                                                                                                                                                                                                                           | <span data-ttu-id="2ab0b-235">Описание</span><span class="sxs-lookup"><span data-stu-id="2ab0b-235">Description</span></span>                                   |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
| <span data-ttu-id="2ab0b-236"><span id="How_To__Create_a_Hull_Shader"></span><span id="how_to__create_a_hull_shader"></span><span id="HOW_TO__CREATE_A_HULL_SHADER"></span>[Руководство. Создание шейдера поверхности](direct3d-11-advanced-stages-hull-shader-create.md)</span><span class="sxs-lookup"><span data-stu-id="2ab0b-236"><span id="How_To__Create_a_Hull_Shader"></span><span id="how_to__create_a_hull_shader"></span><span id="HOW_TO__CREATE_A_HULL_SHADER"></span>[How To: Create a Hull Shader](direct3d-11-advanced-stages-hull-shader-create.md)</span></span><br/>                                                     | <span data-ttu-id="2ab0b-237">Создайте шейдер поверхности.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-237">Create a hull shader.</span></span><br/>              |
| <span data-ttu-id="2ab0b-238"><span id="How_To__Design_a_Hull_Shader"></span><span id="how_to__design_a_hull_shader"></span><span id="HOW_TO__DESIGN_A_HULL_SHADER"></span>[Руководство. Проектирование шейдера поверхности](direct3d-11-advanced-stages-hull-shader-design.md)</span><span class="sxs-lookup"><span data-stu-id="2ab0b-238"><span id="How_To__Design_a_Hull_Shader"></span><span id="how_to__design_a_hull_shader"></span><span id="HOW_TO__DESIGN_A_HULL_SHADER"></span>[How To: Design a Hull Shader](direct3d-11-advanced-stages-hull-shader-design.md)</span></span><br/>                                                     | <span data-ttu-id="2ab0b-239">Создайте шейдер поверхности.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-239">Design a hull shader.</span></span><br/>              |
| <span data-ttu-id="2ab0b-240"><span id="How_To__Initialize_the_Tessellator_Stage"></span><span id="how_to__initialize_the_tessellator_stage"></span><span id="HOW_TO__INITIALIZE_THE_TESSELLATOR_STAGE"></span>[Поэтапное руководство. Инициализация этапа тесселяции](direct3d-11-advanced-stages-tessellator-initialize.md)</span><span class="sxs-lookup"><span data-stu-id="2ab0b-240"><span id="How_To__Initialize_the_Tessellator_Stage"></span><span id="how_to__initialize_the_tessellator_stage"></span><span id="HOW_TO__INITIALIZE_THE_TESSELLATOR_STAGE"></span>[How To: Initialize the Tessellator Stage](direct3d-11-advanced-stages-tessellator-initialize.md)</span></span><br/> | <span data-ttu-id="2ab0b-241">Инициализация этапа тесселяции.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-241">Initialize the tessellation stage.</span></span><br/> |
| <span data-ttu-id="2ab0b-242"><span id="How_To__Create_a_Domain_Shader"></span><span id="how_to__create_a_domain_shader"></span><span id="HOW_TO__CREATE_A_DOMAIN_SHADER"></span>[Как создать Шейдер доменов](direct3d-11-advanced-stages-domain-shader-create.md)</span><span class="sxs-lookup"><span data-stu-id="2ab0b-242"><span id="How_To__Create_a_Domain_Shader"></span><span id="how_to__create_a_domain_shader"></span><span id="HOW_TO__CREATE_A_DOMAIN_SHADER"></span>[How To: Create a Domain Shader](direct3d-11-advanced-stages-domain-shader-create.md)</span></span><br/>                                           | <span data-ttu-id="2ab0b-243">Создайте шейдер домена.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-243">Create a domain shader.</span></span><br/>            |
| <span data-ttu-id="2ab0b-244"><span id="How_To__Design_a_Domain_Shader"></span><span id="how_to__design_a_domain_shader"></span><span id="HOW_TO__DESIGN_A_DOMAIN_SHADER"></span>[Руководство. Проектирование шейдера доменов](direct3d-11-advanced-stages-domain-shader-design.md)</span><span class="sxs-lookup"><span data-stu-id="2ab0b-244"><span id="How_To__Design_a_Domain_Shader"></span><span id="how_to__design_a_domain_shader"></span><span id="HOW_TO__DESIGN_A_DOMAIN_SHADER"></span>[How To: Design a Domain Shader](direct3d-11-advanced-stages-domain-shader-design.md)</span></span><br/>                                           | <span data-ttu-id="2ab0b-245">Создайте шейдер домена.</span><span class="sxs-lookup"><span data-stu-id="2ab0b-245">Create a domain shader.</span></span><br/>            |



 

## <a name="related-topics"></a><span data-ttu-id="2ab0b-246">См. также</span><span class="sxs-lookup"><span data-stu-id="2ab0b-246">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2ab0b-247">Графический конвейер</span><span class="sxs-lookup"><span data-stu-id="2ab0b-247">Graphics Pipeline</span></span>](overviews-direct3d-11-graphics-pipeline.md)
</dt> </dl>

 

