---
title: Информация модуля
description: Модуль — это исполняемый файл или DLL.
ms.assetid: e15b5e15-ca06-4733-bd0a-705058ba2db8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625877832b7e57e68ec6baff79f0c34b4478176
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413069"
---
# <a name="module-information"></a><span data-ttu-id="a8590-103">Информация модуля</span><span class="sxs-lookup"><span data-stu-id="a8590-103">Module Information</span></span>

<span data-ttu-id="a8590-104">*Модуль* — это исполняемый файл или DLL.</span><span class="sxs-lookup"><span data-stu-id="a8590-104">A *module* is an executable file or DLL.</span></span> <span data-ttu-id="a8590-105">Каждый процесс состоит из одного или нескольких модулей.</span><span class="sxs-lookup"><span data-stu-id="a8590-105">Each process consists of one or more modules.</span></span> <span data-ttu-id="a8590-106">Список дескрипторов модуля для процесса можно получить, вызвав функцию [**енумпроцессмодулес**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) .</span><span class="sxs-lookup"><span data-stu-id="a8590-106">You can retrieve the list of module handles for a process by calling the [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) function.</span></span> <span data-ttu-id="a8590-107">Эта функция заполняет массив значений **хмодуле** с помощью дескрипторов модуля для указанного процесса.</span><span class="sxs-lookup"><span data-stu-id="a8590-107">This function fills an array of **HMODULE** values with the module handles for the specified process.</span></span> <span data-ttu-id="a8590-108">Первый модуль — это исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="a8590-108">The first module is the executable file.</span></span> <span data-ttu-id="a8590-109">Помните, что эти дескрипторы модулей, скорее всего, из другого процесса, поэтому их нельзя использовать с такими функциями, как [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span><span class="sxs-lookup"><span data-stu-id="a8590-109">Remember that these module handles are most likely from some other process, so you cannot use them with functions such as [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span></span> <span data-ttu-id="a8590-110">Однако [функции PSAPI](psapi-functions.md) можно использовать для получения сведений о модуле из другого процесса.</span><span class="sxs-lookup"><span data-stu-id="a8590-110">However, you can use [PSAPI functions](psapi-functions.md) to obtain information about a module from another process.</span></span>

<span data-ttu-id="a8590-111">В следующей процедуре описывается получение сведений о модулях из другого процесса.</span><span class="sxs-lookup"><span data-stu-id="a8590-111">The following procedure describes how to obtain module information from another process.</span></span>

<span data-ttu-id="a8590-112">**Получение сведений о модуле из другого процесса**</span><span class="sxs-lookup"><span data-stu-id="a8590-112">**To obtain module information from another process**</span></span>

1.  <span data-ttu-id="a8590-113">Вызовите функцию [**жетмодулебасенаме**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) .</span><span class="sxs-lookup"><span data-stu-id="a8590-113">Call the [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) function.</span></span> <span data-ttu-id="a8590-114">Эта функция принимает обработчик процесса и модуль в качестве входных данных и заполняет буфер базовым именем модуля (например, Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="a8590-114">This function takes a process handle and a module handle as input and fills in a buffer with the base name of a module (for example, Kernel32.dll).</span></span> <span data-ttu-id="a8590-115">Связанная функция [**жетмодулефиленамикс**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa)принимает те же параметры, что и входные данные, но возвращает полный путь к модулю (например, C: \\ Windows \\ system32 \\Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="a8590-115">A related function, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), takes the same parameters as input but returns the full path to the module (for example, C:\\Windows\\System32\\Kernel32.dll).</span></span>
2.  <span data-ttu-id="a8590-116">Вызовите функцию [**жетмодулеинформатион**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) .</span><span class="sxs-lookup"><span data-stu-id="a8590-116">Call the [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) function.</span></span> <span data-ttu-id="a8590-117">Эта функция принимает обработчик процесса и модуль и заполняет структуру [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) с помощью адреса загрузки модуля, размера занимаемого им линейного адресного пространства и указателя на точку входа.</span><span class="sxs-lookup"><span data-stu-id="a8590-117">This function takes a process handle and a module handle and fills a [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) structure with the load address of the module, the size of the linear address space it occupies, and a pointer to its entry point.</span></span>

<span data-ttu-id="a8590-118">Если приложению требуются сведения о модуле для текущего процесса, вместо функций модуля PSAPI следует использовать функцию [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) .</span><span class="sxs-lookup"><span data-stu-id="a8590-118">If an application requires module information for the current process, it should use the [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) function instead of the PSAPI module functions.</span></span> <span data-ttu-id="a8590-119">Это помогает повысить производительность приложения двумя способами: функция **GetModuleFileName** более эффективна, чем функции модуля PSAPI, и приложение может избежать загрузки psapi.dll, если не использует какие-либо функции PSAPI.</span><span class="sxs-lookup"><span data-stu-id="a8590-119">This helps application performance in two ways: The **GetModuleFileName** function is more efficient than the PSAPI module functions, and an application can avoid loading psapi.dll if it does not use any PSAPI functions.</span></span>

<span data-ttu-id="a8590-120">Функции [**жетмодулебасенаме**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) и [**жетмодулефиленамикс**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) в основном предназначены для использования отладчиками и аналогичными приложениями, которые должны извлекать сведения о модулях из другого процесса.</span><span class="sxs-lookup"><span data-stu-id="a8590-120">The [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) and [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) functions are primarily designed for use by debuggers and similar applications that must extract module information from another process.</span></span> <span data-ttu-id="a8590-121">Если список модулей в целевом процессе поврежден или еще не инициализирован, или если список модулей изменяется во время вызова функции в результате загрузки или выгрузки библиотек DLL, эти функции могут завершиться ошибкой или возвращать неверные данные.</span><span class="sxs-lookup"><span data-stu-id="a8590-121">If the module list in the target process is corrupted or is not yet initialized, or if the module list changes during the function call as a result of DLLs being loaded or unloaded, these functions may fail or return incorrect information.</span></span>

 

 