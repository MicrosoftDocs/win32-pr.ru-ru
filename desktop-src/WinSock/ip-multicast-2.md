---
description: Многоадресная рассылка IP-адресов попадает в категорию некорневой плоскости данных и некорневой плоскости управления.
ms.assetid: 474a1c7f-0ece-4192-a2d9-6e2f3df2ac02
title: Многоадресная рассылка IP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3bf9469822ae974b7c616b7904f9dc7120682acb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105701513"
---
# <a name="ip-multicast"></a><span data-ttu-id="1e9d3-103">Многоадресная рассылка IP</span><span class="sxs-lookup"><span data-stu-id="1e9d3-103">IP Multicast</span></span>

<span data-ttu-id="1e9d3-104">Многоадресная рассылка IP-адресов попадает в категорию некорневой плоскости данных и некорневой плоскости управления.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-104">IP multicast falls into the category of nonrooted data plane and nonrooted control plane.</span></span> <span data-ttu-id="1e9d3-105">Все приложения играют конечную роль.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-105">All applications play a leaf role.</span></span> <span data-ttu-id="1e9d3-106">В настоящее время большинство реализаций многоадресной IP-рассылки используют набор параметров сокета, предлагаемых Стив Диринг в стандарте Task Engineering Force (IETF).</span><span class="sxs-lookup"><span data-stu-id="1e9d3-106">Currently, most IP multicast implementations use a set of socket options proposed by Steve Deering to the Internet Engineering Task Force (IETF).</span></span> <span data-ttu-id="1e9d3-107">Таким образом становятся доступны пять операций:</span><span class="sxs-lookup"><span data-stu-id="1e9d3-107">Five operations are thus made available:</span></span>

-   <span data-ttu-id="1e9d3-108">\_TTL многоадресной IP-рассылки \_ — задает срок жизни, управляет областью многоадресного сеанса.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-108">IP\_MULTICAST\_TTL—Sets time-to-live, controls scope of a multicast session.</span></span>
-   <span data-ttu-id="1e9d3-109">IP \_ multicast \_ , если — определяет интерфейс, используемый для многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-109">IP\_MULTICAST\_IF—Determines interface to be used for multicasting.</span></span>
-   <span data-ttu-id="1e9d3-110">IP \_ Add \_ мемберши — присоединяется к указанному сеансу многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-110">IP\_ADD\_MEMBERSHI —Joins a specified multicast session.</span></span>
-   <span data-ttu-id="1e9d3-111">Членство IP-адресов \_ \_ — удаляется из сеанса многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-111">IP\_DROP\_MEMBERSHIP—Drops out of a multicast session.</span></span>
-   <span data-ttu-id="1e9d3-112">\_Многоадресный \_ цикл IP — управляет замыканием многоадресного трафика.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-112">IP\_MULTICAST\_LOOP—Controls loopback of multicast traffic.</span></span>

<span data-ttu-id="1e9d3-113">Настройка срока жизни для сокета IP-адресов напрямую сопоставляется с использованием \_ кода команды многоадресной области ввода-вывода в \_ [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl).</span><span class="sxs-lookup"><span data-stu-id="1e9d3-113">Setting the time-to-live for an IP-multicast socket maps directly to using the SIO\_MULTICAST\_SCOPE command code for [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl).</span></span>

<span data-ttu-id="1e9d3-114">Метод определения IP-интерфейса, используемого для многоадресной рассылки, заключается в использовании параметра сокета, зависящего от TCP/IP, как описано в приложении Windows Sockets 2 Protocol-Specific.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-114">The method for determining the IP interface to be used for multicasting is through a TCP/IP-specific socket option as described in the Windows Sockets 2 Protocol-Specific Annex.</span></span> <span data-ttu-id="1e9d3-115">Остальные три операции хорошо покрываются с семантикой Windows Sockets 2, описанной здесь.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-115">The remaining three operations are covered well with the Windows Sockets 2 semantics described here.</span></span>

<span data-ttu-id="1e9d3-116">Приложение будет открывать сокеты с \_ \_ флагами конечных листов c конечными или d в [**всасоккет**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa).</span><span class="sxs-lookup"><span data-stu-id="1e9d3-116">The application would open sockets with c\_leaf/d\_leaf flags in [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa).</span></span> <span data-ttu-id="1e9d3-117">Он будет использовать [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) для добавления себя в группу многоадресной рассылки в интерфейсе по умолчанию, предназначенном для многоадресных операций.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-117">It would use [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) to add itself to a multicast group on the default interface designated for multicast operations.</span></span> <span data-ttu-id="1e9d3-118">Если флаг в **всажоинлеаф** указывает, что этот сокет является только отправителем, то операция соединения является, по сути, отсутствием операции и не требует отправки сообщений IGMP.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-118">If the flag in **WSAJoinLeaf** indicates that this socket is only a sender, then the join operation is essentially a no-op and no IGMP messages need to be sent.</span></span> <span data-ttu-id="1e9d3-119">В противном случае пакет IGMP отправляется маршрутизатору для указания на получение пакетов, отправляемых на указанный адрес многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-119">Otherwise, an IGMP packet is sent out to the router to indicate interests in receiving packets sent to the specified multicast address.</span></span> <span data-ttu-id="1e9d3-120">Так как приложение создало специальные \_ \_ конечные сокеты c или d, используемые только для многоадресной рассылки, для удаления многоадресного сеанса будет использоваться стандартная функция [**функции closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) .</span><span class="sxs-lookup"><span data-stu-id="1e9d3-120">Since the application created special c\_leaf/d\_leaf sockets used only for performing multicast, the standard [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) function would be used to drop out of the multicast session.</span></span> <span data-ttu-id="1e9d3-121">\_ \_ Код команды обратного замыкания на себя для [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) предоставляет универсальный механизм управления для определения того, можно ли получить данные, отправляемые на \_ конечный сокет d в некорневой схеме MULTIPOINT, на одном сокете.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-121">The SIO\_MULTIPOINT\_LOOPBACK command code for [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) provides a generic control mechanism for determining whether data sent on a d\_leaf socket in a nonrooted multipoint scheme can also be received on the same socket.</span></span>

> [!Note]  
> <span data-ttu-id="1e9d3-122">Версия Winsock \_ параметра "цикл многоадресной рассылки IP" \_ семантически отличается от версии UNIX \_ параметра цикла многоадресной IP-рассылки \_ :</span><span class="sxs-lookup"><span data-stu-id="1e9d3-122">The Winsock version of the IP\_MULTICAST\_LOOP option is semantically different than the UNIX version of the IP\_MULTICAST\_LOOP option:</span></span>

 

-   <span data-ttu-id="1e9d3-123">В Winsock \_ параметр "цикл многоадресной рассылки IP-адресов" \_ применяется только к пути получения.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-123">In Winsock, the IP\_MULTICAST\_LOOP option applies only to the receive path.</span></span>
-   <span data-ttu-id="1e9d3-124">В версии UNIX \_ параметр цикл многоадресной рассылки IP \_ применяется к пути отправки.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-124">In the UNIX version, the IP\_MULTICAST\_LOOP option applies to the send path.</span></span>

<span data-ttu-id="1e9d3-125">Например, приложения, ВКЛЮЧЕНные и ОТКЛЮЧЕНные (которые легче отслеживанию по сравнению с X и Y), присоединяются к одной группе в одном интерфейсе. приложение ON задает параметр " \_ цикл многоадресной рассылки IP-адресов" \_ , приложение отключено задает \_ параметр "цикл многоадресной рассылки IP-адресов" \_ .</span><span class="sxs-lookup"><span data-stu-id="1e9d3-125">For example, applications ON and OFF (which are easier to track than X and Y) join the same group on the same interface; application ON sets the IP\_MULTICAST\_LOOP option on, application OFF sets the IP\_MULTICAST\_LOOP option off.</span></span> <span data-ttu-id="1e9d3-126">Если ON и OFF являются приложениями Winsock, OFF могут отправлять данные на ON, но не могут отсылаться на OFF.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-126">If ON and OFF are Winsock applications, OFF can send to ON, but ON cannot sent to OFF.</span></span> <span data-ttu-id="1e9d3-127">В отличие от этого, если включены и ОТКЛЮЧЕНы приложения UNIX, на может быть отправлено в состояние OFF, но отключить нельзя.</span><span class="sxs-lookup"><span data-stu-id="1e9d3-127">In contrast, if ON and OFF are UNIX applications, ON can send to OFF, but OFF cannot send to ON.</span></span>

 

 



