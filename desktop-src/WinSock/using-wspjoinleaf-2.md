---
description: Как упоминалось ранее, Вспжоинлеаф используется для приподключения конечного узла к сеансу MultiPoint.
ms.assetid: 03325f5e-4d4a-405b-b644-3d8c03435e17
title: Использование Вспжоинлеаф
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ef4426c0d22657b26dcc2217d856865d9ebe98db
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263062"
---
# <a name="using-wspjoinleaf"></a><span data-ttu-id="37175-103">Использование Вспжоинлеаф</span><span class="sxs-lookup"><span data-stu-id="37175-103">Using WSPJoinLeaf</span></span>

<span data-ttu-id="37175-104">Как упоминалось ранее, [**вспжоинлеаф**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) используется для приподключения конечного узла к сеансу MultiPoint.</span><span class="sxs-lookup"><span data-stu-id="37175-104">As mentioned previously, [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) is used to join a leaf node into a multipoint session.</span></span> <span data-ttu-id="37175-105">**Вспжоинлеаф** имеет те же параметры и семантику, что и [**вспконнект**](/previous-versions/windows/hardware/network/ff566275(v=vs.85)) , за исключением того, что она возвращает дескриптор сокета (как в [**вспакцепт**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)) и имеет дополнительный параметр *dwFlags* .</span><span class="sxs-lookup"><span data-stu-id="37175-105">**WSPJoinLeaf** has the same parameters and semantics as [**WSPConnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85)) except that it returns a socket descriptor (as in [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)), and it has an additional *dwFlags* parameter.</span></span> <span data-ttu-id="37175-106">Параметр *dwFlags* используется для указания того, будет ли сокет действовать только как отправитель, только как получатель или как и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="37175-106">The *dwFlags* parameter is used to indicate whether the socket will be acting only as a sender, only as a receiver, or both.</span></span> <span data-ttu-id="37175-107">*В этой* функции для входных параметров можно использовать только сокеты MultiPoint.</span><span class="sxs-lookup"><span data-stu-id="37175-107">Only multipoint sockets may be used for input parameter *s* in this function.</span></span> <span data-ttu-id="37175-108">Если сокет MultiPoint находится в неблокирующем режиме, возвращаемый дескриптор сокета не будет использоваться до тех пор, пока не \_ получится соответствующее указание соединения с демоном фильтра.</span><span class="sxs-lookup"><span data-stu-id="37175-108">If the multipoint socket is in the nonblocking mode, the returned socket descriptor will not be usable until after a corresponding FD\_CONNECT indication has been received.</span></span> <span data-ttu-id="37175-109">Корневое приложение в сеансе MultiPoint может вызвать **вспжоинлеаф** один или несколько раз, чтобы добавить несколько конечных узлов, однако одновременно может выполняться не более одного запроса на подключение MultiPoint.</span><span class="sxs-lookup"><span data-stu-id="37175-109">A root application in a multipoint session may call **WSPJoinLeaf** one or more times in order to add a number of leaf nodes, however at most one multipoint connection request may be outstanding at a time.</span></span>

<span data-ttu-id="37175-110">Дескриптор сокета, возвращаемый функцией [**вспжоинлеаф**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) , отличается в зависимости от *того, является* ли входной дескриптор сокета, \_ корневой c или \_ конечным листом c.</span><span class="sxs-lookup"><span data-stu-id="37175-110">The socket descriptor returned by [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) is different depending on whether the input socket descriptor, *s*, is a c\_root or a c\_leaf.</span></span> <span data-ttu-id="37175-111">При использовании с \_ корневым сокетом c параметр *Name* обозначает добавляемый конечный узел, а возвращаемый дескриптор сокета — конечный сокет c, \_ соответствующий вновь добавленному конечному узлу.</span><span class="sxs-lookup"><span data-stu-id="37175-111">When used with a c\_root socket, the *name* parameter designates a particular leaf node to be added and the returned socket descriptor is a c\_leaf socket corresponding to the newly added leaf node.</span></span> <span data-ttu-id="37175-112">Он не предназначен для использования при обмене данными MultiPoint, а используется для получения событий сетевого события (например, "\ \ \_ " Закрыть ") для соединения, которое существует на конкретном конечном диске c \_ .</span><span class="sxs-lookup"><span data-stu-id="37175-112">It is not intended to be used for exchange of multipoint data, but rather is used to receive network event indications (for example FD\_CLOSE) for the connection that exists to the particular c\_leaf.</span></span> <span data-ttu-id="37175-113">Некоторые реализации MultiPoint также могут разрешить использование этого сокета для побочных сеансов между корнем и отдельным конечным узлом.</span><span class="sxs-lookup"><span data-stu-id="37175-113">Some multipoint implementations may also allow this socket to be used for side chats between the root and an individual leaf node.</span></span> <span data-ttu-id="37175-114">\_Для этого сокета должно быть задано указание Close, если соответствующий конечный узел вызывает [**вспклосесоккет**](/previous-versions/windows/hardware/network/ff566273(v=vs.85)) для удаления сеанса MultiPoint.</span><span class="sxs-lookup"><span data-stu-id="37175-114">An FD\_CLOSE indication should be given for this socket if the corresponding leaf node calls [**WSPCloseSocket**](/previous-versions/windows/hardware/network/ff566273(v=vs.85)) to drop out of the multipoint session.</span></span> <span data-ttu-id="37175-115">В симметричном виде вызов **вспклосесоккет** на \_ оконечном сокете c, возвращенном из [**вспжоинлеаф**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) , приведет к тому, что сокет в соответствующем конечном узле будет получать \_ уведомление о закрытии демона.</span><span class="sxs-lookup"><span data-stu-id="37175-115">Symmetrically, invoking **WSPCloseSocket** on the c\_leaf socket returned from [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) will cause the socket in the corresponding leaf node to get FD\_CLOSE notification.</span></span>

<span data-ttu-id="37175-116">При вызове [**вспжоинлеаф**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) с \_ конечным сокетом c параметр *Name* содержит адрес корневого приложения (для схемы корневого элемента управления) или существующий сеанс MultiPoint (неадминистративная схема управления), а возвращаемый дескриптор сокета совпадает с дескриптором входного сокета.</span><span class="sxs-lookup"><span data-stu-id="37175-116">When [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) is invoked with a c\_leaf socket, the *name* parameter contains the address of the root application (for a rooted control scheme) or an existing multipoint session (nonrooted control scheme), and the returned socket descriptor is the same as the input socket descriptor.</span></span> <span data-ttu-id="37175-117">В схеме корневого элемента управления корневой клиент поместит свой \_ корневой сокет c в режим прослушивания, вызвав [**всплистен**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="37175-117">In a rooted control scheme, the root client would put its c\_root socket in the listening mode by calling [**WSPListen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)).</span></span> <span data-ttu-id="37175-118">Стандартное \_ уведомление о принятии запроса на включение в очередь будет доставлено, когда конечный узел запросит присоединиться к сеансу MultiPoint.</span><span class="sxs-lookup"><span data-stu-id="37175-118">The standard FD\_ACCEPT notification will be delivered when the leaf node requests to join itself to the multipoint session.</span></span> <span data-ttu-id="37175-119">Корневой клиент использует обычную функцию [**вспакцепт**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) , чтобы признать новый конечный узел.</span><span class="sxs-lookup"><span data-stu-id="37175-119">The root client uses the usual [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) function to admit the new leaf node.</span></span> <span data-ttu-id="37175-120">Значение, возвращаемое из **вспакцепт** , также является \_ дескриптором конечного сокета c, точно так же, как возвращаемые из **вспжоинлеаф**.</span><span class="sxs-lookup"><span data-stu-id="37175-120">The value returned from **WSPAccept** is also a c\_leaf socket descriptor just like those returned from **WSPJoinLeaf**.</span></span> <span data-ttu-id="37175-121">Для размещения схем MultiPoint, которые допускают соединения, инициированные как с помощью корневого, так и для конечной точки, допускается \_ Использование корневого сокета c, который уже находится в режиме прослушивания, в качестве входных данных для **вспжоинлеаф**.</span><span class="sxs-lookup"><span data-stu-id="37175-121">To accommodate multipoint schemes that allow both root-initiated and leaf-initiated joins, it is acceptable for a c\_root socket that is already in listening mode to be used as in input to **WSPJoinLeaf**.</span></span>

<span data-ttu-id="37175-122">Корневой клиент MultiPoint обычно отвечает за упорядоченный дисмантлинг сеанса MultiPoint.</span><span class="sxs-lookup"><span data-stu-id="37175-122">A multipoint root client is generally responsible for the orderly dismantling of a multipoint session.</span></span> <span data-ttu-id="37175-123">Такое приложение может использовать [**вспшутдовн**](/previous-versions/windows/desktop/legacy/ms742294(v=vs.85)) или [**вспклосесоккет**](/previous-versions/windows/hardware/network/ff566273(v=vs.85)) на \_ корневом сокете c для выполнения всех связанных \_ конечных сокетов c, включая те, которые возвращаются из [**вспжоинлеаф**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) и соответствующих \_ конечных сокетов c в удаленных КОНЕЧных узлах для получения \_ уведомления о закрытии демона.</span><span class="sxs-lookup"><span data-stu-id="37175-123">Such an application may use [**WSPShutdown**](/previous-versions/windows/desktop/legacy/ms742294(v=vs.85)) or [**WSPCloseSocket**](/previous-versions/windows/hardware/network/ff566273(v=vs.85)) on a c\_root socket to cause all of the associated c\_leaf sockets, including those returned from [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) and their corresponding c\_leaf sockets in the remote leaf nodes, to get FD\_CLOSE notification.</span></span>

 

 
