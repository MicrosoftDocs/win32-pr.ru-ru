---
description: Раздел навигации по сокетам сокетов Windows (Winsock).
ms.assetid: 6a63c2c9-4e09-4a62-b39f-3ccb26287da8
title: IOCTL Winsock (Winsock2.h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: de7094f802b815bfbd7511bd67eb4e6b1767cb94
ms.sourcegitcommit: 392c0a56f99f4d19686e734291abcac887fc5ba2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2021
ms.locfileid: "105647749"
---
# <a name="winsock-ioctls"></a><span data-ttu-id="9b454-103">Winsock IOCTL</span><span class="sxs-lookup"><span data-stu-id="9b454-103">Winsock IOCTLs</span></span>

<span data-ttu-id="9b454-104">В этом разделе описываются элементы управления вводом-выводом сокетов Winsock (IOCTL) для различных выпусков операционных систем Windows.</span><span class="sxs-lookup"><span data-stu-id="9b454-104">This section describes Winsock Socket input/output controls (IOCTLs) for various editions of Windows operating systems.</span></span> <span data-ttu-id="9b454-105">Используйте функцию [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) или [**вспиоктл**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) , чтобы выдать Winsock IOCTL для управления режимом сокета, транспортного протокола или подсистемы связи.</span><span class="sxs-lookup"><span data-stu-id="9b454-105">Use the [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) or [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) function to issue a Winsock IOCTL to control the mode of a socket, the transport protocol, or the communications subsystem.</span></span>

<span data-ttu-id="9b454-106">Некоторым запросам Winsock IOCTL требуется больше объяснений, чем может передать эта таблица. такие параметры содержат ссылки на дополнительные разделы.</span><span class="sxs-lookup"><span data-stu-id="9b454-106">Some Winsock IOCTLs require more explanation than this table can convey; such options contain links to additional topics.</span></span>

<span data-ttu-id="9b454-107">Можно использовать схему кодирования, которая сохраняет определенные в настоящий момент коды операций [**иоктлсоккет**](/windows/desktop/api/winsock/nf-winsock-ioctlsocket) , а также предоставляет удобный способ секционирования пространства идентификаторов операций в, так как параметр *двиоконтролкоде* теперь является 32-разрядной сущностью.</span><span class="sxs-lookup"><span data-stu-id="9b454-107">It is possible to adopt an encoding scheme that preserves the currently defined [**ioctlsocket**](/windows/desktop/api/winsock/nf-winsock-ioctlsocket) opcodes while providing a convenient way to partition the opcode identifier space in as much as the *dwIoControlCode* parameter is now a 32-bit entity.</span></span> <span data-ttu-id="9b454-108">Параметр *двиоконтролкоде* создается для обеспечения независимости от протокола и поставщика при добавлении новых управляющих кодов, сохраняя обратную совместимость с кодами Windows sockets 1,1 и UNIX Controls.</span><span class="sxs-lookup"><span data-stu-id="9b454-108">The *dwIoControlCode* parameter is built to allow for protocol and vendor independence when adding new control codes while retaining backward compatibility with the Windows Sockets 1.1 and Unix control codes.</span></span> <span data-ttu-id="9b454-109">Параметр *двиоконтролкоде* имеет следующую форму.</span><span class="sxs-lookup"><span data-stu-id="9b454-109">The *dwIoControlCode* parameter has the following form.</span></span>

| <span data-ttu-id="9b454-110">I</span><span class="sxs-lookup"><span data-stu-id="9b454-110">I</span></span>  | <span data-ttu-id="9b454-111">O</span><span class="sxs-lookup"><span data-stu-id="9b454-111">O</span></span>  | <span data-ttu-id="9b454-112">V</span><span class="sxs-lookup"><span data-stu-id="9b454-112">V</span></span>  | <span data-ttu-id="9b454-113">T</span><span class="sxs-lookup"><span data-stu-id="9b454-113">T</span></span>  | <span data-ttu-id="9b454-114">Семейство поставщиков и адресов</span><span class="sxs-lookup"><span data-stu-id="9b454-114">Vendor/address family</span></span> | <span data-ttu-id="9b454-115">Код</span><span class="sxs-lookup"><span data-stu-id="9b454-115">Code</span></span>                   |
|-|-|-|-|-|-|
| <span data-ttu-id="9b454-116">3</span><span class="sxs-lookup"><span data-stu-id="9b454-116">3</span></span>  | <span data-ttu-id="9b454-117">3</span><span class="sxs-lookup"><span data-stu-id="9b454-117">3</span></span>  | <span data-ttu-id="9b454-118">2</span><span class="sxs-lookup"><span data-stu-id="9b454-118">2</span></span>  | <span data-ttu-id="9b454-119">2 2</span><span class="sxs-lookup"><span data-stu-id="9b454-119">2 2</span></span> | <span data-ttu-id="9b454-120">2 2 2 2 2 2 2 1 1 1 1</span><span class="sxs-lookup"><span data-stu-id="9b454-120">2 2 2 2 2 2 2 1 1 1 1</span></span> | <span data-ttu-id="9b454-121">1 1 1 1 1 1</span><span class="sxs-lookup"><span data-stu-id="9b454-121">1 1 1 1 1 1</span></span>              |
| <span data-ttu-id="9b454-122">1</span><span class="sxs-lookup"><span data-stu-id="9b454-122">1</span></span>  | <span data-ttu-id="9b454-123">0</span><span class="sxs-lookup"><span data-stu-id="9b454-123">0</span></span>  | <span data-ttu-id="9b454-124">9</span><span class="sxs-lookup"><span data-stu-id="9b454-124">9</span></span>  | <span data-ttu-id="9b454-125">8 7</span><span class="sxs-lookup"><span data-stu-id="9b454-125">8 7</span></span> | <span data-ttu-id="9b454-126">6 5 4 3 2 1 0 9 8 7 6</span><span class="sxs-lookup"><span data-stu-id="9b454-126">6 5 4 3 2 1 0 9 8 7 6</span></span> | <span data-ttu-id="9b454-127">5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0</span><span class="sxs-lookup"><span data-stu-id="9b454-127">5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0</span></span> |

> [!Note] 
> <span data-ttu-id="9b454-128">Биты в параметре *двиоконтролкоде* , отображаемые в таблице, должны считываться вертикально сверху вниз по столбцу.</span><span class="sxs-lookup"><span data-stu-id="9b454-128">The bits in *dwIoControlCode* parameter displayed in the table must be read vertically from top to bottom by column.</span></span> <span data-ttu-id="9b454-129">Так что самое левое значение бита 31, следующий бит — 30, а правый — бит 0.</span><span class="sxs-lookup"><span data-stu-id="9b454-129">So the left-most bit is bit 31, the next bit is bit 30, and the right-most bit is bit 0.</span></span>

<span data-ttu-id="9b454-130">Я настроил, является ли входной буфер допустимым для кода, как в случае с **IOC_IN**.</span><span class="sxs-lookup"><span data-stu-id="9b454-130">I is set if the input buffer is valid for the code, as with **IOC_IN**.</span></span>

<span data-ttu-id="9b454-131">Параметр O устанавливается, если выходной буфер допустим для кода, как в случае с **IOC_OUT**.</span><span class="sxs-lookup"><span data-stu-id="9b454-131">O is set if the output buffer is valid for the code, as with **IOC_OUT**.</span></span> <span data-ttu-id="9b454-132">Управляющие коды, использующие как входной, так и выходной буферы, устанавливают и I, и O.</span><span class="sxs-lookup"><span data-stu-id="9b454-132">Control codes using both input and output buffers set both I and O.</span></span>

<span data-ttu-id="9b454-133">V задается, если для кода нет параметров, как в случае с **IOC_VOID**.</span><span class="sxs-lookup"><span data-stu-id="9b454-133">V is set if there are no parameters for the code, as with **IOC_VOID**.</span></span>

<span data-ttu-id="9b454-134">T — это 2-разрядное количество, определяющее тип IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-134">T is a 2-bit quantity that defines the type of the IOCTL.</span></span> <span data-ttu-id="9b454-135">Определены следующие значения:</span><span class="sxs-lookup"><span data-stu-id="9b454-135">The following values are defined:</span></span>

<span data-ttu-id="9b454-136">0 запрос IOCTL является стандартным кодом UNIX IOCTL, как в случае с **фионреад** и **фионбио**.</span><span class="sxs-lookup"><span data-stu-id="9b454-136">0 The IOCTL is a standard Unix IOCTL code, as with **FIONREAD** and **FIONBIO**.</span></span>

<span data-ttu-id="9b454-137">1 запрос IOCTL является универсальным кодом IOCTL Windows Sockets 2.</span><span class="sxs-lookup"><span data-stu-id="9b454-137">1 The IOCTL is a generic Windows Sockets 2 IOCTL code.</span></span> <span data-ttu-id="9b454-138">Новые коды IOCTL, определенные для сокетов Windows 2, будут иметь T = = 1.</span><span class="sxs-lookup"><span data-stu-id="9b454-138">New IOCTL codes defined for Windows Sockets 2 will have T == 1.</span></span>

<span data-ttu-id="9b454-139">2 запрос IOCTL применяется только к определенному семейству адресов.</span><span class="sxs-lookup"><span data-stu-id="9b454-139">2 The IOCTL applies only to a specific address family.</span></span>

<span data-ttu-id="9b454-140">3 запрос IOCTL применяется только к поставщику конкретного поставщика, как в случае с **IOC_VENDOR**.</span><span class="sxs-lookup"><span data-stu-id="9b454-140">3 The IOCTL applies only to a specific vendor's provider, as with **IOC_VENDOR**.</span></span> <span data-ttu-id="9b454-141">Этот тип позволяет компаниям назначить номер поставщика, который отображается в параметре " **поставщик/семейство адресов** ".</span><span class="sxs-lookup"><span data-stu-id="9b454-141">This type allows companies to be assigned a vendor number that appears in the **Vendor/Address family** parameter.</span></span> <span data-ttu-id="9b454-142">Затем поставщик может определить новые запросы IOCTL, относящиеся к этому поставщику, без регистрации IOCTL в расчетной палате, тем самым обеспечивая гибкость и конфиденциальность поставщика.</span><span class="sxs-lookup"><span data-stu-id="9b454-142">Then, the vendor can define new IOCTLs specific to that vendor without having to register the IOCTL with a clearinghouse, thereby providing vendor flexibility and privacy.</span></span>

<span data-ttu-id="9b454-143">**Семейство поставщиков и адресов** 11-разрядное количество, определяющее поставщика, владеющего кодом (если T = = 3) или содержащего семейство адресов, к которому применяется код (если T = = 2).</span><span class="sxs-lookup"><span data-stu-id="9b454-143">**Vendor/Address family** An 11-bit quantity that defines the vendor who owns the code (if T == 3) or that contains the address family to which the code applies (if T == 2).</span></span> <span data-ttu-id="9b454-144">Если это код для UNIX IOCTL (T = = 0), то этот параметр имеет то же значение, что и код в UNIX.</span><span class="sxs-lookup"><span data-stu-id="9b454-144">If this is a Unix IOCTL code (T == 0) then this parameter has the same value as the code on Unix.</span></span> <span data-ttu-id="9b454-145">Если это универсальный сокет Windows Sockets 2 IOCTL (T = = 1), этот параметр можно использовать как расширение параметра Code для предоставления дополнительных значений кода.</span><span class="sxs-lookup"><span data-stu-id="9b454-145">If this is a generic Windows Sockets 2 IOCTL (T == 1) then this parameter can be used as an extension of the code parameter to provide additional code values.</span></span>

<span data-ttu-id="9b454-146">**Код** 16-разрядное количество, содержащее конкретный код IOCTL для операции.</span><span class="sxs-lookup"><span data-stu-id="9b454-146">**Code** The 16-bit quantity that contains the specific IOCTL code for the operation.</span></span>

## <a name="unix-ioctl-codes"></a><span data-ttu-id="9b454-147">Коды для UNIX IOCTL</span><span class="sxs-lookup"><span data-stu-id="9b454-147">Unix IOCTL codes</span></span>

<span data-ttu-id="9b454-148">Поддерживаются следующие коды (команды) IOCTL UNIX.</span><span class="sxs-lookup"><span data-stu-id="9b454-148">The following Unix IOCTL codes (commands) are supported.</span></span>

### <a name="fionbio"></a><span data-ttu-id="9b454-149">фионбио</span><span class="sxs-lookup"><span data-stu-id="9b454-149">FIONBIO</span></span>

<span data-ttu-id="9b454-150">Включает или отключает режим без блокировки *на сокетах*.</span><span class="sxs-lookup"><span data-stu-id="9b454-150">Enable or disable non-blocking mode on socket *s*.</span></span> <span data-ttu-id="9b454-151">Параметр *лпвинбуффер* указывает на беззнаковое длинное (QoS) **без знака** (ненулевое значение), если включен режим без блокировки, и нуль, если он должен быть отключен.</span><span class="sxs-lookup"><span data-stu-id="9b454-151">The *lpvInBuffer* parameter points at an **unsigned long** (QoS), which is nonzero if non-blocking mode is to be enabled and zero if it is to be disabled.</span></span> <span data-ttu-id="9b454-152">При создании сокета он работает в блокирующем режиме (т. е. неблокирующего режима отключен).</span><span class="sxs-lookup"><span data-stu-id="9b454-152">When a socket is created, it operates in blocking mode (that is, non-blocking mode is disabled).</span></span> <span data-ttu-id="9b454-153">Это согласуется с сокетами BSD.</span><span class="sxs-lookup"><span data-stu-id="9b454-153">This is consistent with BSD sockets.</span></span>

<span data-ttu-id="9b454-154">Подпрограммы [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) или [**всаевентселект**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) автоматически устанавливают сокет в режим без блокировки.</span><span class="sxs-lookup"><span data-stu-id="9b454-154">The [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) or [**WSAEventSelect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) routine automatically sets a socket to non-blocking mode.</span></span> <span data-ttu-id="9b454-155">Если **всаасинкселект** или **всаевентселект** был выдан на сокете, любая попытка использовать [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) для переключения сокета в режим блокировки приведет к сбою с всаеинвал.</span><span class="sxs-lookup"><span data-stu-id="9b454-155">If **WSAAsyncSelect** or **WSAEventSelect** has been issued on a socket, then any attempt to use [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) to set the socket back to blocking mode will fail with WSAEINVAL.</span></span> <span data-ttu-id="9b454-156">Чтобы установить сокет обратно в режим блокировки, приложение должно сначала отключить **всаасинкселект** , вызвав **всаасинкселект** с параметром *Левент* , равным нулю, или отключить **всаевентселект** , вызвав **всаевентселект** с параметром *лнетворкевентс* , равным нулю.</span><span class="sxs-lookup"><span data-stu-id="9b454-156">To set the socket back to blocking mode, an application must first disable **WSAAsyncSelect** by calling **WSAAsyncSelect** with the *lEvent* parameter equal to zero, or disable **WSAEventSelect** by calling **WSAEventSelect** with the *lNetworkEvents* parameter equal to zero.</span></span>

### <a name="fionread"></a><span data-ttu-id="9b454-157">фионреад</span><span class="sxs-lookup"><span data-stu-id="9b454-157">FIONREAD</span></span>

<span data-ttu-id="9b454-158">Определите объем данных, которые могут быть считаны атомарно *с сокетов*.</span><span class="sxs-lookup"><span data-stu-id="9b454-158">Determine the amount of data that can be read atomically from socket *s*.</span></span> <span data-ttu-id="9b454-159">Параметр *лпваутбуффер* указывает на **беззнаковое значение типа Long** , в котором [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) сохраняет результат.</span><span class="sxs-lookup"><span data-stu-id="9b454-159">The *lpvOutBuffer* parameter points at an **unsigned long** in which [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) stores the result.</span></span>

<span data-ttu-id="9b454-160">Если сокет, переданный в параметре *s* , ориентирован на поток (например, тип Сокк \_ Stream), **фионреад** возвращает общий объем данных, которые могут быть считаны в рамках одной операции получения. обычно это то же самое, что и общий объем данных, поставленных в очередь на сокете (так как поток данных ориентирован на байты, это не гарантируется).</span><span class="sxs-lookup"><span data-stu-id="9b454-160">If the socket passed in the *s* parameter is stream oriented (for example, type SOCK\_STREAM), **FIONREAD** returns the total amount of data that can be read in a single receive operation; this is normally the same as the total amount of data queued on the socket (since a data stream is byte-oriented, this is not guaranteed).</span></span>

<span data-ttu-id="9b454-161">Если сокет, переданный в параметре *s* , является ориентированным на сообщения (например, введите Сокк \_ Дграм), **фионреад** возвращает отчет общее число доступных для чтения байтов, а не размер первой датаграммы (сообщения), поставленной в очередь на сокете.</span><span class="sxs-lookup"><span data-stu-id="9b454-161">If the socket passed in the *s* parameter is message oriented (for example, type SOCK\_DGRAM), **FIONREAD** returns the reports the total number of bytes available to read, not the size of the first datagram (message) queued on the socket.</span></span>

### <a name="siocatmark"></a><span data-ttu-id="9b454-162">сиокатмарк</span><span class="sxs-lookup"><span data-stu-id="9b454-162">SIOCATMARK</span></span>

<span data-ttu-id="9b454-163">Определить, были ли прочитаны все данные OOB.</span><span class="sxs-lookup"><span data-stu-id="9b454-163">Determine whether or not all OOB data has been read.</span></span> <span data-ttu-id="9b454-164">Это относится только к сокету в стиле потока (например, введите Сокк \_ Stream), который был настроен для встроенного приема любых данных OOB (поэтому \_ убинлине).</span><span class="sxs-lookup"><span data-stu-id="9b454-164">This applies only to a socket of stream-style (for example, type SOCK\_STREAM) that has been configured for inline reception of any OOB data (SO\_OOBINLINE).</span></span> <span data-ttu-id="9b454-165">Если данные OOB не ожидают чтения, операция возвращает значение TRUE.</span><span class="sxs-lookup"><span data-stu-id="9b454-165">If no OOB data is waiting to be read, the operation returns TRUE.</span></span> <span data-ttu-id="9b454-166">В противном случае возвращается **значение false**, а следующая операция Receive, выполняемая на сокете, будет извлекать некоторые или все данные, предшествующие метке. приложение должно использовать операцию **сиокатмарк** , чтобы определить, остались ли они.</span><span class="sxs-lookup"><span data-stu-id="9b454-166">Otherwise, it returns **FALSE**, and the next receive operation performed on the socket will retrieve some or all of the data preceding the mark; the application should use the **SIOCATMARK** operation to determine whether any remains.</span></span> <span data-ttu-id="9b454-167">При наличии обычных данных, предшествующих срочным (нестандартным) данным, они будут получены по порядку.</span><span class="sxs-lookup"><span data-stu-id="9b454-167">If there is any normal data preceding the urgent (out of band) data, it will be received in order.</span></span> <span data-ttu-id="9b454-168">(Обратите внимание, что операции [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) никогда не будут смешивать OOB и обычные данные в одном вызове.) *лпваутбуффер* указывает на логическое значение, в котором [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) сохраняет результат.</span><span class="sxs-lookup"><span data-stu-id="9b454-168">(Note that [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) operations will never mix OOB and normal data in the same call.) *lpvOutBuffer* points at a BOOL in which [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) stores the result.</span></span>

## <a name="windows-sockets-2-commands"></a><span data-ttu-id="9b454-169">Команды сокетов Windows 2</span><span class="sxs-lookup"><span data-stu-id="9b454-169">Windows Sockets 2 commands</span></span>

<span data-ttu-id="9b454-170">Поддерживаются следующие команды Windows Sockets 2.</span><span class="sxs-lookup"><span data-stu-id="9b454-170">The following Windows Sockets 2 commands are supported.</span></span>

### <a name="sio_acquire_port_reservation-opcode-setting-i-t3"></a><span data-ttu-id="9b454-171">SIO_ACQUIRE_PORT_RESERVATION (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-171">SIO_ACQUIRE_PORT_RESERVATION (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-172">Запросите резервирование среды выполнения для блока портов TCP или UDP.</span><span class="sxs-lookup"><span data-stu-id="9b454-172">Request a runtime reservation for a block of TCP or UDP ports.</span></span> <span data-ttu-id="9b454-173">Для резервирования портов во время выполнения пул портов требует, чтобы резервирования использовались в процессе, для которого было предоставлено резервирование.</span><span class="sxs-lookup"><span data-stu-id="9b454-173">For runtime port reservations, the port pool requires that reservations be consumed from the process on whose socket the reservation was granted.</span></span> <span data-ttu-id="9b454-174">Количество резервирований портов среды выполнения было последним только в течение времени существования сокета, на котором был вызван [**\_ запрос IOCTL \_ \_ резервирования порта**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-174">Runtime port reservations last only as long as the lifetime of the socket on which the [**SIO\_ACQUIRE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) IOCTL was called.</span></span> <span data-ttu-id="9b454-175">Напротив, постоянные резервирования портов, созданные с помощью функции [**креатеперсистентткппортресерватион**](/windows/win32/api/iphlpapi/nf-iphlpapi-createpersistenttcpportreservation) или [**креатеперсистентудппортресерватион**](/windows/win32/api/iphlpapi/nf-iphlpapi-createpersistentudpportreservation) , могут быть использованы любым процессом с возможностью получения постоянных резервирований.</span><span class="sxs-lookup"><span data-stu-id="9b454-175">In contrast, persistent port reservations created using the [**CreatePersistentTcpPortReservation**](/windows/win32/api/iphlpapi/nf-iphlpapi-createpersistenttcpportreservation) or [**CreatePersistentUdpPortReservation**](/windows/win32/api/iphlpapi/nf-iphlpapi-createpersistentudpportreservation) function may be consumed by any process with the ability to obtain persistent reservations.</span></span>

<span data-ttu-id="9b454-176">Дополнительные сведения см. в справочнике [**по \_ \_ \_ резервированию порта для получения SIO**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-176">For more detailed information, see the [**SIO\_ACQUIRE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-177">[**Суперконтроллер ввода/вывода \_ ПОЛУЧЕНИЕ \_ \_ резервирования портов**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) поддерживается в Windows Vista и более поздних версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9b454-177">[**SIO\_ACQUIRE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) is supported on Windows Vista and later versions of the operating system.</span></span>

### <a name="sio_address_list_change-opcode-setting-v-t1"></a><span data-ttu-id="9b454-178">\_ \_ Изменение списка адресов SIO \_ (параметр кода операции: V, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-178">SIO\_ADDRESS\_LIST\_CHANGE (opcode setting: V, T==1)</span></span>

<span data-ttu-id="9b454-179">Для получения уведомлений об изменениях в списке локальных транспортных адресов семейства протоколов сокета, к которому может быть привязано приложение.</span><span class="sxs-lookup"><span data-stu-id="9b454-179">To receive notification of changes in the list of local transport addresses of the socket's protocol family to which the application can bind.</span></span> <span data-ttu-id="9b454-180">При завершении этого IOCTL не будут предоставлены выходные данные. завершение просто означает, что список доступных локальных адресов изменился, и его следует запросить снова через **\_ \_ \_ запрос списка адресов SIO**.</span><span class="sxs-lookup"><span data-stu-id="9b454-180">No output information will be provided upon completion of this IOCTL; the completion merely indicates that list of available local address has changed and should be queried again through **SIO\_ADDRESS\_LIST\_QUERY**.</span></span>

<span data-ttu-id="9b454-181">Предполагается (хотя и не обязательно), что приложение использует перекрывающиеся операции ввода-вывода, чтобы получать уведомления об изменениях по завершении запроса на **\_ \_ \_ изменение списка адресов SIO** .</span><span class="sxs-lookup"><span data-stu-id="9b454-181">It is assumed (although not required) that the application uses overlapped I/O to be notified of change by completion of **SIO\_ADDRESS\_LIST\_CHANGE** request.</span></span> <span data-ttu-id="9b454-182">Кроме того, если запрос IOCTL с **\_ \_ \_ изменением списка адресов SIO** выполняется на неблокирующем сокете и без перекрывающихся параметров (*лповерлаппед* /  *лпкомплетионраутине* имеет значение **null**), он будет немедленно завершен с ошибкой [всаеваулдблокк](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-182">Alternatively, if the **SIO\_ADDRESS\_LIST\_CHANGE** IOCTL is issued on a non-blocking socket and without overlapped parameters (*lpOverlapped*/ *lpCompletionRoutine* are set to **NULL**), it will complete immediately with error [WSAEWOULDBLOCK](windows-sockets-error-codes-2.md).</span></span> <span data-ttu-id="9b454-183">Затем приложение может ожидать события изменения списка адресов с помощью вызова [**всаевентселект**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) или [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) с \_ \_ \_ установленным битом изменения списка адресов в маске сетевого события.</span><span class="sxs-lookup"><span data-stu-id="9b454-183">The application can then wait for address list change events through a call to [**WSAEventSelect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) or [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) with FD\_ADDRESS\_LIST\_CHANGE bit set in the network event bitmask.</span></span>

### <a name="sio_address_list_query-opcode-setting-o-t1"></a><span data-ttu-id="9b454-184">\_ \_ Запрос списка адресов SIO \_ (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-184">SIO\_ADDRESS\_LIST\_QUERY (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-185">Получает список локальных транспортных адресов семейства протоколов сокетов, к которым может быть привязано приложение.</span><span class="sxs-lookup"><span data-stu-id="9b454-185">Obtains a list of local transport addresses of the socket's protocol family to which the application can bind.</span></span> <span data-ttu-id="9b454-186">Список адресов зависит от семейства адресов, а некоторые адреса исключаются из списка.</span><span class="sxs-lookup"><span data-stu-id="9b454-186">The list of addresses varies based on address family and some addresses are excluded from the list.</span></span>

> [!Note] 
> <span data-ttu-id="9b454-187">В средах Windows Plug-n-Play адреса можно добавлять и удалять динамически.</span><span class="sxs-lookup"><span data-stu-id="9b454-187">In Windows Plug-n-Play environments, addresses can be added and removed dynamically.</span></span> <span data-ttu-id="9b454-188">Поэтому приложения не могут полагаться на сведения, возвращаемые **\_ \_ \_ запросом списка адресов SIO** , как постоянные.</span><span class="sxs-lookup"><span data-stu-id="9b454-188">Therefore, applications cannot rely on the information returned by **SIO\_ADDRESS\_LIST\_QUERY** to be persistent.</span></span> <span data-ttu-id="9b454-189">Приложения могут регистрироваться для получения уведомлений об изменении адреса через **\_ список адресов SIO \_ \_ изменение** ioctl, который обеспечивает уведомление с помощью перекрывающихся операций ввода-вывода или \_ \_ \_ события изменения списка адресов.</span><span class="sxs-lookup"><span data-stu-id="9b454-189">Applications may register for address change notifications through the **SIO\_ADDRESS\_LIST\_CHANGE** IOCTL which provides for notification through either overlapped I/O or FD\_ADDRESS\_LIST\_CHANGE event.</span></span> <span data-ttu-id="9b454-190">Чтобы гарантировать, что приложение всегда имеет текущие сведения о списке адресов, можно использовать следующую последовательность действий.</span><span class="sxs-lookup"><span data-stu-id="9b454-190">The following sequence of actions can be used to guarantee that the application always has current address list information:</span></span>

-  <span data-ttu-id="9b454-191">Выдача IOCTL с **\_ \_ \_ изменением списка адресов через SIO**</span><span class="sxs-lookup"><span data-stu-id="9b454-191">Issue **SIO\_ADDRESS\_LIST\_CHANGE** IOCTL</span></span>
-  <span data-ttu-id="9b454-192">Выдача **\_ запроса на список адресов SIO с \_ \_ запросом** ioctl</span><span class="sxs-lookup"><span data-stu-id="9b454-192">Issue **SIO\_ADDRESS\_LIST\_QUERY** IOCTL</span></span>
-  <span data-ttu-id="9b454-193">Всякий раз, когда запрос IOCTL на **\_ \_ \_ изменение списка адресов SIO** уведомляет приложение об изменении списка адресов (с перекрытием операций ввода-вывода или с помощью сигнализации о \_ \_ \_ событии изменения списка адресов), должна повторяться вся последовательность действий.</span><span class="sxs-lookup"><span data-stu-id="9b454-193">Whenever **SIO\_ADDRESS\_LIST\_CHANGE** IOCTL notifies the application of address list change (either through overlapped I/O or by signaling FD\_ADDRESS\_LIST\_CHANGE event), the whole sequence of actions should be repeated.</span></span>

<span data-ttu-id="9b454-194">Более подробные сведения см. в справочнике по [**\_ \_ \_ запросам списка адресов SIO**](/previous-versions/windows/desktop/legacy/dd877219(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-194">For more detailed information, see the [**SIO\_ADDRESS\_LIST\_QUERY**](/previous-versions/windows/desktop/legacy/dd877219(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-195">**Суперконтроллер ввода/вывода \_ \_ \_ Запрос списка адресов** поддерживается в Windows 2000 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-195">**SIO\_ADDRESS\_LIST\_QUERY** is supported on Windows 2000 and later.</span></span>

### <a name="sio_apply_transport_setting-opcode-setting-i-t3"></a><span data-ttu-id="9b454-196">\_ \_ Параметр транспорта применения SIO \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-196">SIO\_APPLY\_TRANSPORT\_SETTING (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-197">Применяет параметр транспорта к сокету.</span><span class="sxs-lookup"><span data-stu-id="9b454-197">Applies a transport setting to a socket.</span></span> <span data-ttu-id="9b454-198">Применяемый параметр транспорта основан на [**\_ \_ идентификаторе параметра транспорта**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) , переданном в параметре *лпвинбуффер* .</span><span class="sxs-lookup"><span data-stu-id="9b454-198">The transport setting being applied is based on the [**TRANSPORT\_SETTING\_ID**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) passed in the *lpvInBuffer* parameter.</span></span>

<span data-ttu-id="9b454-199">Единственным параметром транспорта, который сейчас определяет, является возможность получения **\_ \_ уведомлений \_ в режиме реального времени** на сокете TCP.</span><span class="sxs-lookup"><span data-stu-id="9b454-199">The only transport setting currently defines is for the **REAL\_TIME\_NOTIFICATION\_CAPABILITY** capability on a TCP socket.</span></span>

<span data-ttu-id="9b454-200">Если переданный [**\_ \_ идентификатор параметра транспорта**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) имеет значение **GUID** , установленное в **режиме реального \_ времени \_ , то \_** это запрос на применение параметров уведомлений в режиме реального времени для сокета TCP, используемого с [**контролчаннелтригжер**](/uwp/api/Windows.Networking.Sockets.ControlChannelTrigger) , для получения фоновых сетевых уведомлений в приложении Магазина Windows.</span><span class="sxs-lookup"><span data-stu-id="9b454-200">If the [**TRANSPORT\_SETTING\_ID**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) passed has the **Guid** member set to **REAL\_TIME\_NOTIFICATION\_CAPABILITY**, then this is a request to apply real time notification settings for the TCP socket used with the [**ControlChannelTrigger**](/uwp/api/Windows.Networking.Sockets.ControlChannelTrigger) to receive background network notifications in a Windows Store app.</span></span>

<span data-ttu-id="9b454-201">Дополнительные сведения см. в статье [**\_ использование \_ \_ параметров транспорта для SIO**](/previous-versions/windows/desktop/legacy/jj553481(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-201">For more detailed information, see the [**SIO\_APPLY\_TRANSPORT\_SETTING**](/previous-versions/windows/desktop/legacy/jj553481(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-202">**Суперконтроллер ввода/вывода \_ \_ \_ Параметр "применить транспорт** " поддерживается в Windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-202">**SIO\_APPLY\_TRANSPORT\_SETTING** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_associate_handle-opcode-setting-i-t1"></a><span data-ttu-id="9b454-203">\_Маркер связи SIO \_ (параметр кода операции: I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-203">SIO\_ASSOCIATE\_HANDLE (opcode setting: I, T==1)</span></span>

<span data-ttu-id="9b454-204">Связывает этот сокет с указанным дескриптором сопутствующего интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9b454-204">Associate this socket with the specified handle of a companion interface.</span></span> <span data-ttu-id="9b454-205">Входной буфер содержит целочисленное значение, соответствующее константе манифеста для сопутствующего интерфейса (например, \_ нетдев и th \_ TAPI.), за которым следует значение, которое является маркером указанного сопутствующего интерфейса вместе с любой другой обязательной информацией.</span><span class="sxs-lookup"><span data-stu-id="9b454-205">The input buffer contains the integer value corresponding to the manifest constant for the companion interface (for example, TH\_NETDEV and TH\_TAPI.), followed by a value that is a handle of the specified companion interface, along with any other required information.</span></span> <span data-ttu-id="9b454-206">Дополнительные сведения о конкретном сопутствующем интерфейсе см. в соответствующем разделе в [приложении Winsock](winsock-annexes.md) .</span><span class="sxs-lookup"><span data-stu-id="9b454-206">Refer to the appropriate section in [Winsock Annexes](winsock-annexes.md) for details specific to a particular companion interface.</span></span> <span data-ttu-id="9b454-207">Общий размер отражается в длине входного буфера.</span><span class="sxs-lookup"><span data-stu-id="9b454-207">The total size is reflected in the input buffer length.</span></span> <span data-ttu-id="9b454-208">Выходной буфер не требуется.</span><span class="sxs-lookup"><span data-stu-id="9b454-208">No output buffer is required.</span></span> <span data-ttu-id="9b454-209">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают этот запрос IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-209">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support this IOCTL.</span></span> <span data-ttu-id="9b454-210">Маркер, связанный с этим IOCTL, можно получить с **помощью \_ \_ маркера перевода SIO**.</span><span class="sxs-lookup"><span data-stu-id="9b454-210">The handle associated by this IOCTL can be retrieved using **SIO\_TRANSLATE\_HANDLE**.</span></span>

<span data-ttu-id="9b454-211">Можно использовать сопутствующий интерфейс, например, если конкретный поставщик предоставляет (1) большую часть контроля над поведением сокета и (2) элементы управления являются достаточно специфичными для поставщика, чтобы они не сопоставлялись с существующими функциями сокетов Windows или, скорее всего, были определены в будущем.</span><span class="sxs-lookup"><span data-stu-id="9b454-211">A companion interface might be used, for example, if a particular provider provides (1) a great deal of additional controls over the behavior of a socket and (2) the controls are provider-specific enough that they do not map to existing Windows Socket functions or ones likely to be defined in the future.</span></span> <span data-ttu-id="9b454-212">Для обнаружения и мониторинга других интерфейсов, которые могут поддерживаться сокетом, рекомендуется использовать модель COM вместо этого IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-212">It is recommend that the Component Object Model (COM) be used instead of this IOCTL to discover and track other interfaces that might be supported by a socket.</span></span> <span data-ttu-id="9b454-213">Этот запрос IOCTL представлен для (обратная) совместимости с системами, в которых COM недоступен, или по какой-либо другой причине.</span><span class="sxs-lookup"><span data-stu-id="9b454-213">This IOCTL is present for (reverse) compatibility with systems where COM is not available or cannot be used for some other reason.</span></span>

### <a name="sio_associate_port_reservation-opcode-setting-i-t3"></a><span data-ttu-id="9b454-214">\_ \_ Резервирование порта для сопоставления SIO \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-214">SIO\_ASSOCIATE\_PORT\_RESERVATION (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-215">Свяжите сокет с постоянным или резервным резервированием для блока портов TCP или UDP, идентифицируемого маркером резервирования портов.</span><span class="sxs-lookup"><span data-stu-id="9b454-215">Associate a socket with a persistent or runtime reservation for a block of TCP or UDP ports identified by the port reservation token.</span></span> <span data-ttu-id="9b454-216">Перед привязкой сокета необходимо выдать запрос IOCTL для [**\_ \_ \_ резервирования порта SIO**](/previous-versions/windows/desktop/legacy/gg699721(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-216">The [**SIO\_ASSOCIATE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699721(v=vs.85)) IOCTL must be issued before the socket is bound.</span></span> <span data-ttu-id="9b454-217">Если и при привязке сокета, назначенный ему порт будет выбран из резервирования портов, определенного данным токеном.</span><span class="sxs-lookup"><span data-stu-id="9b454-217">If and when the socket is bound, the port assigned to it will be selected from the port reservation identified by the given token.</span></span> <span data-ttu-id="9b454-218">Если из указанного резервирования нет доступных портов, вызов функции [**BIND**](/windows/desktop/api/winsock/nf-winsock-bind) завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="9b454-218">If no ports are available from the specified reservation, the [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) function call will fail.</span></span>

<span data-ttu-id="9b454-219">Более подробные сведения см. в справочнике по [**\_ \_ \_ резервированию порта для сопоставления SIO**](/previous-versions/windows/desktop/legacy/gg699721(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-219">For more detailed information, see the [**SIO\_ASSOCIATE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699721(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-220">[**Суперконтроллер ввода/вывода \_ \_ \_ Резервирование портов связи**](/previous-versions/windows/desktop/legacy/gg699721(v=vs.85)) поддерживается в Windows Vista и более поздних версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9b454-220">[**SIO\_ASSOCIATE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699721(v=vs.85)) is supported on Windows Vista and later versions of the operating system.</span></span>

### <a name="sio_base_handle-opcode-setting-o-t1"></a><span data-ttu-id="9b454-221">\_Базовый \_ маркер sio (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-221">SIO\_BASE\_HANDLE (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-222">Получает базовый маркер поставщика службы для данного сокета.</span><span class="sxs-lookup"><span data-stu-id="9b454-222">Retrieves the base service provider handle for a given socket.</span></span> <span data-ttu-id="9b454-223">Возвращаемое значение — это **сокет**.</span><span class="sxs-lookup"><span data-stu-id="9b454-223">The returned value is a **SOCKET**.</span></span>

<span data-ttu-id="9b454-224">Многоуровневый поставщик услуг никогда не перехватит этот IOCTL, так как возвращаемое значение должно быть маркером сокета от базового поставщика служб.</span><span class="sxs-lookup"><span data-stu-id="9b454-224">A layered service provider would never intercept this IOCTL since the return value must be the socket handle from the base service provider.</span></span>

<span data-ttu-id="9b454-225">Если выходной буфер недостаточно велик для маркера сокета ( *кбаутбуффер* меньше, чем размер **сокета**), или параметр *лпваутбуффер* является **пустым** указателем, то в результате этого ioctl **возвращается \_ Ошибка сокета** , а [**всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаефаулт](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-225">If the output buffer is not large enough for a socket handle (the *cbOutBuffer* is less than the size of a **SOCKET**) or the *lpvOutBuffer* parameter is a **NULL** pointer, **SOCKET\_ERROR** is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEFAULT](windows-sockets-error-codes-2.md).</span></span>

<span data-ttu-id="9b454-226">**Суперконтроллер ввода/вывода \_ Базовый \_ маркер** определяется в файле заголовка *мсвсокк. h* и поддерживается в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-226">**SIO\_BASE\_HANDLE** is defined in the *Mswsock.h* header file and supported on Windows Vista and later.</span></span>

### <a name="sio_bsp_handle-opcode-setting-o-t1"></a><span data-ttu-id="9b454-227">\_Маркер загрузочного процессора SIO \_ (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-227">SIO\_BSP\_HANDLE (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-228">Получает базовый маркер поставщика службы для сокета, используемого функцией [**всасендмсг**](/windows/desktop/api/winsock2/nf-winsock2-wsasendmsg) .</span><span class="sxs-lookup"><span data-stu-id="9b454-228">Retrieves the base service provider handle for a socket used by the [**WSASendMsg**](/windows/desktop/api/winsock2/nf-winsock2-wsasendmsg) function.</span></span> <span data-ttu-id="9b454-229">Возвращаемое значение — это **сокет**.</span><span class="sxs-lookup"><span data-stu-id="9b454-229">The returned value is a **SOCKET**.</span></span>

<span data-ttu-id="9b454-230">Этот запрос IOCTL используется многоуровневый поставщик служб, чтобы гарантировать перехват поставщиком функции [**всасендмсг**](/windows/desktop/api/winsock2/nf-winsock2-wsasendmsg) .</span><span class="sxs-lookup"><span data-stu-id="9b454-230">This Ioctl is used by a layered service provider to ensure the provider intercept the [**WSASendMsg**](/windows/desktop/api/winsock2/nf-winsock2-wsasendmsg) function.</span></span>

<span data-ttu-id="9b454-231">Если выходной буфер недостаточно велик для маркера сокета ( *кбаутбуффер* меньше, чем размер **сокета**), или параметр *лпваутбуффер* является **пустым** указателем, то в результате этого ioctl **возвращается \_ Ошибка сокета** , а [**всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаефаулт](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-231">If the output buffer is not large enough for a socket handle (the *cbOutBuffer* is less than the size of a **SOCKET**) or the *lpvOutBuffer* parameter is a **NULL** pointer, **SOCKET\_ERROR** is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEFAULT](windows-sockets-error-codes-2.md).</span></span>

<span data-ttu-id="9b454-232">**Суперконтроллер ввода/вывода \_ \_Обработчик BSP** определен в файле заголовка *мсвсокк. h* и поддерживается в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-232">**SIO\_BSP\_HANDLE** is defined in the *Mswsock.h* header file and supported on Windows Vista and later.</span></span>

### <a name="sio_bsp_handle_select-opcode-setting-o-t1"></a><span data-ttu-id="9b454-233">\_ \_ Выбор обработчика контроллера SIO \_ (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-233">SIO\_BSP\_HANDLE\_SELECT (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-234">Получает базовый маркер поставщика службы для сокета, используемого функцией [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select) .</span><span class="sxs-lookup"><span data-stu-id="9b454-234">Retrieves the base service provider handle for a socket used by the [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select) function.</span></span> <span data-ttu-id="9b454-235">Возвращаемое значение — это **сокет**.</span><span class="sxs-lookup"><span data-stu-id="9b454-235">The returned value is a **SOCKET**.</span></span>

<span data-ttu-id="9b454-236">Этот запрос IOCTL используется многоуровневый поставщик служб, чтобы гарантировать перехват поставщиком функции [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select) .</span><span class="sxs-lookup"><span data-stu-id="9b454-236">This Ioctl is used by a layered service provider to ensure the provider intercept the [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select) function.</span></span>

<span data-ttu-id="9b454-237">Если выходной буфер недостаточно велик для маркера сокета ( *кбаутбуффер* меньше, чем размер **сокета**), или параметр *лпваутбуффер* является **пустым** указателем, то в результате этого ioctl **возвращается \_ Ошибка сокета** , а [**всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаефаулт](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-237">If the output buffer is not large enough for a socket handle (the *cbOutBuffer* is less than the size of a **SOCKET**) or the *lpvOutBuffer* parameter is a **NULL** pointer, **SOCKET\_ERROR** is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEFAULT](windows-sockets-error-codes-2.md).</span></span>

<span data-ttu-id="9b454-238">**Суперконтроллер ввода/вывода \_ В \_ \_** файле заголовка *мсвсокк. h* определено значение SELECT для обработчика загрузочных процессоров, которое поддерживается в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-238">**SIO\_BSP\_HANDLE\_SELECT** is defined in the *Mswsock.h* header file and supported on Windows Vista and later.</span></span>

### <a name="sio_bsp_handle_poll-opcode-setting-o-t1"></a><span data-ttu-id="9b454-239">\_ \_ Опрос обработчика контроллера SIO \_ (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-239">SIO\_BSP\_HANDLE\_POLL (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-240">Получает базовый маркер поставщика службы для сокета, используемого функцией [**всаполл**](/windows/win32/api/winsock2/nf-winsock2-wsapoll) .</span><span class="sxs-lookup"><span data-stu-id="9b454-240">Retrieves the base service provider handle for a socket used by the [**WSAPoll**](/windows/win32/api/winsock2/nf-winsock2-wsapoll) function.</span></span> <span data-ttu-id="9b454-241">Параметр *лповерлаппед* должен быть **пустым** указателем.</span><span class="sxs-lookup"><span data-stu-id="9b454-241">The *lpOverlapped* parameter must be a **NULL** pointer.</span></span> <span data-ttu-id="9b454-242">Возвращаемое значение — это **сокет**.</span><span class="sxs-lookup"><span data-stu-id="9b454-242">The returned value is a **SOCKET**.</span></span>

<span data-ttu-id="9b454-243">Этот запрос IOCTL используется многоуровневый поставщик служб, чтобы гарантировать перехват поставщиком функции [**всаполл**](/windows/win32/api/winsock2/nf-winsock2-wsapoll) .</span><span class="sxs-lookup"><span data-stu-id="9b454-243">This Ioctl is used by a layered service provider to ensure the provider intercept the [**WSAPoll**](/windows/win32/api/winsock2/nf-winsock2-wsapoll) function.</span></span>

<span data-ttu-id="9b454-244">Если выходной буфер недостаточно велик для маркера сокета ( *кбаутбуффер* меньше, чем размер **сокета**), то параметр *лпваутбуффер* является **пустым** указателем, или параметр *лповерлаппед* не является **пустым** указателем, **\_ Ошибка сокета** возвращается в результате этого IOCTL и [**всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаефаулт](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-244">If the output buffer is not large enough for a socket handle (the *cbOutBuffer* is less than the size of a **SOCKET**), the *lpvOutBuffer* parameter is a **NULL** pointer, or the *lpOverlapped* parameter is not a **NULL** pointer, **SOCKET\_ERROR** is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEFAULT](windows-sockets-error-codes-2.md).</span></span>

<span data-ttu-id="9b454-245">**Суперконтроллер ввода/вывода \_ \_ \_ Опрос обработчика BSP** определяется в файле заголовка *мсвсокк. h* и поддерживается в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-245">**SIO\_BSP\_HANDLE\_POLL** is defined in the *Mswsock.h* header file and supported on Windows Vista and later.</span></span>

### <a name="sio_chk_qos-opcode-setting-i-o-t3"></a><span data-ttu-id="9b454-246">\_QoS SIO \_ (параметр кода операции: I, O, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-246">SIO\_CHK\_QOS (opcode setting: I, O, T==3)</span></span>

<span data-ttu-id="9b454-247">Извлекает сведения о характеристиках трафика QoS.</span><span class="sxs-lookup"><span data-stu-id="9b454-247">Retrieves information about QoS traffic characteristics.</span></span> <span data-ttu-id="9b454-248">На этапе перехода в систему отправляющей системы между настройкой потока и получением сообщения RESV (см. сведения о [том, как служба RSVP вызывает TC](/previous-versions/windows/desktop/qos/how-the-rsvp-service-invokes-tc) для получения дополнительных сведений о переходном этапе) трафик, связанный с потоком RSVP, основан на типе службы ([наилучшие усилия](/previous-versions/windows/desktop/qos/best-effort), [управляемая нагрузка](/previous-versions/windows/desktop/qos/controlled-load)или [гарантированная](/previous-versions/windows/desktop/qos/guaranteed)).</span><span class="sxs-lookup"><span data-stu-id="9b454-248">During the transitional phase on the sending system between flow setup and the receipt of a RESV message (see [How the RSVP Service Invokes TC](/previous-versions/windows/desktop/qos/how-the-rsvp-service-invokes-tc) for more information on the transitional phase), traffic associated with an RSVP flow is shaped based on service type ([BEST EFFORT](/previous-versions/windows/desktop/qos/best-effort), [CONTROLLED LOAD](/previous-versions/windows/desktop/qos/controlled-load), or [GUARANTEED](/previous-versions/windows/desktop/qos/guaranteed)).</span></span> <span data-ttu-id="9b454-249">Дополнительные сведения см. в разделе [использование \_ службы \_ QoS SIO](/previous-versions/windows/desktop/qos/using-sio-chk-qos) по [качеству обслуживания раздела Quality Service](/previous-versions/windows/desktop/qos/qos-start-page) SDK платформы.</span><span class="sxs-lookup"><span data-stu-id="9b454-249">For more information, see [Using SIO\_CHK\_QOS](/previous-versions/windows/desktop/qos/using-sio-chk-qos) in the [Quality of Service](/previous-versions/windows/desktop/qos/qos-start-page) section of the Platform SDK.</span></span>

### <a name="sio_cpu_affinity-opcode-setting-i-t3"></a><span data-ttu-id="9b454-250">SIO_CPU_AFFINITY (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-250">SIO_CPU_AFFINITY (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-251">Включает совместное использование портов и возможность получения индикации.</span><span class="sxs-lookup"><span data-stu-id="9b454-251">Enables port sharing and receive indication parallelization.</span></span> <span data-ttu-id="9b454-252">Если приложение использует этот параметр сокета для связывания сокетов с разными процессорами, а затем привязывает сокеты к одному и тому же адресу, то приемы приема будут распределяться между сокетами на основе хэша масштабирования на стороне приема (RSS).</span><span class="sxs-lookup"><span data-stu-id="9b454-252">When your application uses this socket option to associate sockets to different processors, and then binds the sockets to the same address, receive indications will be distributed across the sockets based on Receive Side Scaling (RSS) hash.</span></span> <span data-ttu-id="9b454-253">Параметры RSS не меняются, поэтому любой заданный поток (локальная конечная точка, пара удаленных конечных точек) всегда будет указан на одном процессоре.</span><span class="sxs-lookup"><span data-stu-id="9b454-253">The RSS settings don't change, so any given flow (local endpoint, remote endpoint pair) will always be indicated on the same processor.</span></span> <span data-ttu-id="9b454-254">В результате все пакеты, принадлежащие заданному потоку, будут обозначены одним и тем же сокетом.</span><span class="sxs-lookup"><span data-stu-id="9b454-254">As a result, all packets belonging to a given flow will be indicated to the same socket.</span></span> <span data-ttu-id="9b454-255">Этот запрос IOCTL должен быть вызван перед привязкой, в противном случае будет возвращен ВСАЕИНВАЛ.</span><span class="sxs-lookup"><span data-stu-id="9b454-255">This IOCTL must be called prior to bind, otherwise WSAEINVAL will be returned.</span></span> <span data-ttu-id="9b454-256">Входной буфер — это индекс процессора (от 0) типа USHORT.</span><span class="sxs-lookup"><span data-stu-id="9b454-256">The input buffer is a processor index (0-based) of type USHORT.</span></span> <span data-ttu-id="9b454-257">Запрос IOCTL несовместим с SO_REUSEADDR и SO_REUSE_MULTICASTPORT.</span><span class="sxs-lookup"><span data-stu-id="9b454-257">The IOCTL is incompatible with SO_REUSEADDR and SO_REUSE_MULTICASTPORT.</span></span> <span data-ttu-id="9b454-258">Поддерживается только для сокетов UDP.</span><span class="sxs-lookup"><span data-stu-id="9b454-258">Only supported for UDP sockets.</span></span>

> [!NOTE]
> <span data-ttu-id="9b454-259">Если вы используете версию 10.0.19041.0 (Windows 10, 2004) Windows SDK, используйте значение `0x98000015` вместо имени **SIO_CPU_AFFINITY**.</span><span class="sxs-lookup"><span data-stu-id="9b454-259">If you're targeting version 10.0.19041.0 (Windows 10, version 2004) of the Windows SDK, then use the value `0x98000015` instead of the name **SIO_CPU_AFFINITY**.</span></span>

### <a name="sio_enable_circular_queueing-opcode-setting-v-t1"></a><span data-ttu-id="9b454-260">\_Включение \_ циклической \_ очереди в SIO (параметр кода операции: V, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-260">SIO\_ENABLE\_CIRCULAR\_QUEUEING (opcode setting: V, T==1)</span></span>

<span data-ttu-id="9b454-261">Указывает на базовый поставщик услуг, ориентированный на сообщения, что переданное сообщение никогда не должно быть удалено из-за переполнения очереди буфера.</span><span class="sxs-lookup"><span data-stu-id="9b454-261">Indicates to the underlying message-oriented service provider that a newly arrived message should never be dropped because of a buffer queue overflow.</span></span> <span data-ttu-id="9b454-262">Вместо этого самое старое сообщение в очереди должно быть устранено, чтобы охватить вновь полученное сообщение.</span><span class="sxs-lookup"><span data-stu-id="9b454-262">Instead, the oldest message in the queue should be eliminated in order to accommodate the newly arrived message.</span></span> <span data-ttu-id="9b454-263">Входные и выходные буферы не требуются.</span><span class="sxs-lookup"><span data-stu-id="9b454-263">No input and output buffers are required.</span></span> <span data-ttu-id="9b454-264">Обратите внимание, что этот запрос IOCTL допустим только для сокетов, связанных с ненадежными протоколами, ориентированными на сообщения.</span><span class="sxs-lookup"><span data-stu-id="9b454-264">Note that this IOCTL is only valid for sockets associated with unreliable, message-oriented protocols.</span></span> <span data-ttu-id="9b454-265">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают этот запрос IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-265">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support this IOCTL.</span></span>

### <a name="sio_find_route-opcode-setting-o-t1"></a><span data-ttu-id="9b454-266">\_Поиск \_ маршрута sio (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-266">SIO\_FIND\_ROUTE (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-267">При выдаче этот запрос IOCTL запрашивает возможность обнаружения маршрута к удаленному адресу, указанному в качестве [**SOCKADDR**](sockaddr-2.md) во входном буфере.</span><span class="sxs-lookup"><span data-stu-id="9b454-267">When issued, this IOCTL requests that the route to the remote address specified as a [**sockaddr**](sockaddr-2.md) in the input buffer be discovered.</span></span> <span data-ttu-id="9b454-268">Если адрес уже существует в локальном кэше, его запись становится недействительной.</span><span class="sxs-lookup"><span data-stu-id="9b454-268">If the address already exists in the local cache, its entry is invalidated.</span></span> <span data-ttu-id="9b454-269">При использовании протокола IPX для Novell этот вызов инициирует Жетлокалтаржет IPX (ГЛТ), который запрашивает сеть для данного удаленного адреса.</span><span class="sxs-lookup"><span data-stu-id="9b454-269">In the case of Novell's IPX, this call initiates an IPX GetLocalTarget (GLT), which queries the network for the given remote address.</span></span>

### <a name="sio_flush-opcode-setting-v-t1"></a><span data-ttu-id="9b454-270">\_Сброс sio (параметр кода операции: V, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-270">SIO\_FLUSH (opcode setting: V, T==1)</span></span>

<span data-ttu-id="9b454-271">Удаляет текущее содержимое очереди отправки, связанной с этим сокетом.</span><span class="sxs-lookup"><span data-stu-id="9b454-271">Discards current contents of the sending queue associated with this socket.</span></span> <span data-ttu-id="9b454-272">Входные и выходные буферы не требуются.</span><span class="sxs-lookup"><span data-stu-id="9b454-272">No input and output buffers are required.</span></span> <span data-ttu-id="9b454-273">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают этот запрос IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-273">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support this IOCTL.</span></span>

### <a name="sio_get_broadcast_address-opcode-setting-o-t1"></a><span data-ttu-id="9b454-274">\_Получение \_ широковещательного \_ адреса sio (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-274">SIO\_GET\_BROADCAST\_ADDRESS (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-275">Этот запрос IOCTL заполняет выходной буфер структурой [SOCKADDR](sockaddr-2.md) , содержащей подходящий широковещательный адрес для использования с [**SendTo**](/windows/desktop/api/winsock/nf-winsock-sendto) /  [**всасендто**](/windows/desktop/api/Winsock2/nf-winsock2-wsasendto).</span><span class="sxs-lookup"><span data-stu-id="9b454-275">This IOCTL fills the output buffer with a [sockaddr](sockaddr-2.md) structure containing a suitable broadcast address for use with [**sendto**](/windows/desktop/api/winsock/nf-winsock-sendto)/ [**WSASendTo**](/windows/desktop/api/Winsock2/nf-winsock2-wsasendto).</span></span> <span data-ttu-id="9b454-276">Этот запрос IOCTL не поддерживается для сокетов IPv6 и возвращает код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) .</span><span class="sxs-lookup"><span data-stu-id="9b454-276">This IOCTL is not supported for IPv6 sockets and returns the [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code.</span></span>

### <a name="sio_get_extension_function_pointer-opcode-setting-o-i-t1"></a><span data-ttu-id="9b454-277">\_ \_ Указатель функции получения расширения SIO \_ \_ (параметр кода операции: O, I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-277">SIO\_GET\_EXTENSION\_FUNCTION\_POINTER (opcode setting: O, I, T==1)</span></span>

<span data-ttu-id="9b454-278">Получение указателя на указанную функцию расширения, поддерживаемую связанным поставщиком служб.</span><span class="sxs-lookup"><span data-stu-id="9b454-278">Retrieve a pointer to the specified extension function supported by the associated service provider.</span></span> <span data-ttu-id="9b454-279">Входной буфер содержит глобальный уникальный идентификатор (**GUID**), значение которого определяет рассматриваемую функцию расширения.</span><span class="sxs-lookup"><span data-stu-id="9b454-279">The input buffer contains a globally unique identifier (**GUID**) whose value identifies the extension function in question.</span></span> <span data-ttu-id="9b454-280">Указатель на нужную функцию возвращается в выходном буфере.</span><span class="sxs-lookup"><span data-stu-id="9b454-280">The pointer to the desired function is returned in the output buffer.</span></span> <span data-ttu-id="9b454-281">Идентификаторы функций расширения устанавливаются поставщиками поставщиков услуг и должны быть включены в документацию поставщика, в которой описываются возможности и семантика функций расширения.</span><span class="sxs-lookup"><span data-stu-id="9b454-281">Extension function identifiers are established by service provider vendors and should be included in vendor documentation that describes extension function capabilities and semantics.</span></span>

<span data-ttu-id="9b454-282">Значения GUID для функций расширения, поддерживаемых поставщиком услуг Windows TCP/IP, определяются в файле заголовка *мсвсокк. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-282">The GUID values for extension functions supported by the Windows TCP/IP service provider are defined in the *Mswsock.h* header file.</span></span> <span data-ttu-id="9b454-283">Возможны следующие значения для этих идентификаторов GUID:</span><span class="sxs-lookup"><span data-stu-id="9b454-283">The possible value for these GUIDs are as follows:</span></span>

| <span data-ttu-id="9b454-284">Термин</span><span class="sxs-lookup"><span data-stu-id="9b454-284">Term</span></span>                                                                                                                | <span data-ttu-id="9b454-285">Описание</span><span class="sxs-lookup"><span data-stu-id="9b454-285">Description</span></span>                                                                               |
|-|-|
| <span data-ttu-id="9b454-286"><span id="WSAID_ACCEPTEX"></span><span id="wsaid_acceptex"></span>ВСАИД \_ акцептекс</span><span class="sxs-lookup"><span data-stu-id="9b454-286"><span id="WSAID_ACCEPTEX"></span><span id="wsaid_acceptex"></span>WSAID\_ACCEPTEX</span></span><br/>                                     | <span data-ttu-id="9b454-287">Функция расширения [**акцептекс**](/windows/win32/api/mswsock/nf-mswsock-acceptex) .</span><span class="sxs-lookup"><span data-stu-id="9b454-287">The [**AcceptEx**](/windows/win32/api/mswsock/nf-mswsock-acceptex) extension function.</span></span><br/>                         |
| <span data-ttu-id="9b454-288"><span id="WSAID_CONNECTEX"></span><span id="wsaid_connectex"></span>ВСАИД \_ коннектекс</span><span class="sxs-lookup"><span data-stu-id="9b454-288"><span id="WSAID_CONNECTEX"></span><span id="wsaid_connectex"></span>WSAID\_CONNECTEX</span></span><br/>                                  | <span data-ttu-id="9b454-289">Функция расширения [**коннектекс**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_connectex) .</span><span class="sxs-lookup"><span data-stu-id="9b454-289">The [**ConnectEx**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_connectex) extension function.</span></span> <br/>                      |
| <span data-ttu-id="9b454-290"><span id="WSAID_DISCONNECTEX"></span><span id="wsaid_disconnectex"></span>ВСАИД \_ дисконнектекс</span><span class="sxs-lookup"><span data-stu-id="9b454-290"><span id="WSAID_DISCONNECTEX"></span><span id="wsaid_disconnectex"></span>WSAID\_DISCONNECTEX</span></span><br/>                         | <span data-ttu-id="9b454-291">Функция расширения [**дисконнектекс**](/previous-versions/windows/desktop/legacy/ms737757(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-291">The [**DisconnectEx**](/previous-versions/windows/desktop/legacy/ms737757(v=vs.85)) extension function.</span></span> <br/>                |
| <span data-ttu-id="9b454-292"><span id="WSAID_GETACCEPTEXSOCKADDRS"></span><span id="wsaid_getacceptexsockaddrs"></span>ВСАИД \_ жетакцептекссоккаддрс</span><span class="sxs-lookup"><span data-stu-id="9b454-292"><span id="WSAID_GETACCEPTEXSOCKADDRS"></span><span id="wsaid_getacceptexsockaddrs"></span>WSAID\_GETACCEPTEXSOCKADDRS</span></span><br/> | <span data-ttu-id="9b454-293">Функция расширения [**жетакцептекссоккаддрс**](/windows/win32/api/mswsock/nf-mswsock-getacceptexsockaddrs) .</span><span class="sxs-lookup"><span data-stu-id="9b454-293">The [**GetAcceptExSockaddrs**](/windows/win32/api/mswsock/nf-mswsock-getacceptexsockaddrs) extension function.</span></span><br/> |
| <span data-ttu-id="9b454-294"><span id="WSAID_TRANSMITFILE"></span><span id="wsaid_transmitfile"></span>ВСАИД \_ TRANSMITFILE</span><span class="sxs-lookup"><span data-stu-id="9b454-294"><span id="WSAID_TRANSMITFILE"></span><span id="wsaid_transmitfile"></span>WSAID\_TRANSMITFILE</span></span><br/>                         | <span data-ttu-id="9b454-295">Функция расширения [**TransmitFile**](/windows/win32/api/mswsock/nf-mswsock-transmitfile) .</span><span class="sxs-lookup"><span data-stu-id="9b454-295">The [**TransmitFile**](/windows/win32/api/mswsock/nf-mswsock-transmitfile) extension function.</span></span><br/>                 |
| <span data-ttu-id="9b454-296"><span id="WSAID_TRANSMITPACKETS"></span><span id="wsaid_transmitpackets"></span>ВСАИД \_ трансмитпаккетс</span><span class="sxs-lookup"><span data-stu-id="9b454-296"><span id="WSAID_TRANSMITPACKETS"></span><span id="wsaid_transmitpackets"></span>WSAID\_TRANSMITPACKETS</span></span><br/>                | <span data-ttu-id="9b454-297">Функция расширения [**трансмитпаккетс**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_transmitpackets) .</span><span class="sxs-lookup"><span data-stu-id="9b454-297">The [**TransmitPackets**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_transmitpackets) extension function.</span></span> <br/>          |
| <span data-ttu-id="9b454-298"><span id="WSAID_WSARECVMSG"></span><span id="wsaid_wsarecvmsg"></span>ВСАИД \_ всареквмсг</span><span class="sxs-lookup"><span data-stu-id="9b454-298"><span id="WSAID_WSARECVMSG"></span><span id="wsaid_wsarecvmsg"></span>WSAID\_WSARECVMSG</span></span><br/>                               | <span data-ttu-id="9b454-299">Функция расширения [**LPFN_WSARECVMSG (всареквмсг)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) .</span><span class="sxs-lookup"><span data-stu-id="9b454-299">The [**LPFN_WSARECVMSG (WSARecvMsg)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) extension function.</span></span><br/>                     |
| <span data-ttu-id="9b454-300"><span id="WSAID_WSASENDMSG"></span><span id="wsaid_wsasendmsg"></span>ВСАИД \_ всасендмсг</span><span class="sxs-lookup"><span data-stu-id="9b454-300"><span id="WSAID_WSASENDMSG"></span><span id="wsaid_wsasendmsg"></span>WSAID\_WSASENDMSG</span></span><br/>                               | <span data-ttu-id="9b454-301">Функция расширения [**всасендмсг**](/windows/desktop/api/winsock2/nf-winsock2-wsasendmsg) .</span><span class="sxs-lookup"><span data-stu-id="9b454-301">The [**WSASendMsg**](/windows/desktop/api/winsock2/nf-winsock2-wsasendmsg) extension function.</span></span> <br/>                      |

### <a name="sio_get_group_qos-opcode-setting-o-i-t1"></a><span data-ttu-id="9b454-302">\_Получение \_ \_ качества обслуживания группы sio (параметр кода операции: O, I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-302">SIO\_GET\_GROUP\_QOS (opcode setting: O, I, T==1)</span></span>

<span data-ttu-id="9b454-303">Зарезервировано для будущего использования с сокетами.</span><span class="sxs-lookup"><span data-stu-id="9b454-303">Reserved for future use with sockets.</span></span>

<span data-ttu-id="9b454-304">Получите структуру [**QoS**](/windows/win32/api/winsock2/ns-winsock2-qos) , связанную с группой сокетов, к которой принадлежит этот сокет.</span><span class="sxs-lookup"><span data-stu-id="9b454-304">Retrieve the [**QOS**](/windows/win32/api/winsock2/ns-winsock2-qos) structure associated with the socket group to which this socket belongs.</span></span> <span data-ttu-id="9b454-305">Входной буфер является необязательным.</span><span class="sxs-lookup"><span data-stu-id="9b454-305">The input buffer is optional.</span></span> <span data-ttu-id="9b454-306">Некоторые протоколы (например, RSVP) позволяют использовать входной буфер для уточнения запроса на качество обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9b454-306">Some protocols (for example, RSVP) allow the input buffer to be used to qualify a quality of service request.</span></span> <span data-ttu-id="9b454-307">Структура **качества обслуживания** будет скопирована в выходной буфер.</span><span class="sxs-lookup"><span data-stu-id="9b454-307">The **QOS** structure will be copied into the output buffer.</span></span> <span data-ttu-id="9b454-308">Если этот сокет не принадлежит подходящей группе сокетов, члены **сендингфловспек** и **рецеивингфловспек** возвращенной структуры **качества обслуживания** устанавливаются в **значение NULL**.</span><span class="sxs-lookup"><span data-stu-id="9b454-308">If this socket does not belong to an appropriate socket group, the **SendingFlowspec** and **ReceivingFlowspec** members of the returned **QOS** structure are set to **NULL**.</span></span> <span data-ttu-id="9b454-309">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают качество обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9b454-309">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support quality of service.</span></span>

### <a name="sio_get_interface_list-opcode-setting-o-t0"></a><span data-ttu-id="9b454-310">\_ \_ Список интерфейсов получения SIO \_ (параметр кода операции: O, T = = 0)</span><span class="sxs-lookup"><span data-stu-id="9b454-310">SIO\_GET\_INTERFACE\_LIST (opcode setting: O, T==0)</span></span>

<span data-ttu-id="9b454-311">Возвращает список настроенных интерфейсов IP и их параметры в виде массива структур [**\_ сведений о интерфейсе**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info) .</span><span class="sxs-lookup"><span data-stu-id="9b454-311">Returns a list of configured IP interfaces and their parameters as an array of [**INTERFACE\_INFO**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info) structures.</span></span>

> [!Note]  
> <span data-ttu-id="9b454-312">Эта команда является обязательной для поставщиков служб TCP/IP, совместимых с Windows Sockets 2.</span><span class="sxs-lookup"><span data-stu-id="9b454-312">Support of this command is mandatory for Windows Sockets 2-compliant TCP/IP service providers.</span></span>

<span data-ttu-id="9b454-313">Параметр *лпваутбуффер* указывает на буфер, в котором хранятся сведения об интерфейсах в виде массива структур [**\_ сведений о интерфейсах**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info) для одноадресных IP-адресов в интерфейсах.</span><span class="sxs-lookup"><span data-stu-id="9b454-313">The *lpvOutBuffer* parameter points to the buffer in which to store the information about interfaces as an array of [**INTERFACE\_INFO**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info) structures for unicast IP addresses on the interfaces.</span></span> <span data-ttu-id="9b454-314">Параметр *кбаутбуффер* задает длину выходного буфера.</span><span class="sxs-lookup"><span data-stu-id="9b454-314">The *cbOutBuffer* parameter specifies the length of the output buffer.</span></span> <span data-ttu-id="9b454-315">Число возвращаемых интерфейсов (число структур, возвращаемых в буфере, на которое указывает параметр *лпваутбуффер* ) можно определить на основе фактической длины выходного буфера, возвращаемого в параметре *лпкббитесретурнед* .</span><span class="sxs-lookup"><span data-stu-id="9b454-315">The number of interfaces returned (number of structures returned in the buffer pointed to by *lpvOutBuffer* parameter) can be determined based on the actual length of the output buffer returned in *lpcbBytesReturned* parameter.</span></span>

<span data-ttu-id="9b454-316">Если функция [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) вызывается с помощью **\_ \_ \_ списка интерфейсов SIO Get** , а элемент Level параметра Socket *s* не определен как **иппрото \_ IP**, то возвращается **всаеинвал** .</span><span class="sxs-lookup"><span data-stu-id="9b454-316">If the [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) function is called with **SIO\_GET\_INTERFACE\_LIST** and the level member of the socket *s* parameter is not defined as **IPPROTO\_IP**, **WSAEINVAL** is returned.</span></span> <span data-ttu-id="9b454-317">Вызов функции **всаиоктл** с **SIO \_ Get \_ Interface \_ List** возвращает **всаефаулт** , если параметр *кбаутбуффер* , указывающий длину выходного буфера, слишком мал, то получает список настроенных интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9b454-317">A call to the **WSAIoctl** function with **SIO\_GET\_INTERFACE\_LIST** returns **WSAEFAULT** if the *cbOutBuffer* parameter that specifies the length of the output buffer is too small ro receive the list of configured interfaces.</span></span>

<span data-ttu-id="9b454-318">**Суперконтроллер ввода/вывода \_ \_ \_ Список интерфейсов Get** поддерживается в Windows Me/98 и Windows NT 4,0 с пакетом обновления 4 (SP4) и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="9b454-318">**SIO\_GET\_INTERFACE\_LIST** is supported on Windows Me/98 and Windows NT 4.0 with SP4 and later.</span></span>

### <a name="sio_get_interface_list_ex-opcode-setting-o-t0"></a><span data-ttu-id="9b454-319">\_Получение \_ списка интерфейсов SIO \_ \_ (параметр кода операции: O, T = = 0)</span><span class="sxs-lookup"><span data-stu-id="9b454-319">SIO\_GET\_INTERFACE\_LIST\_EX (opcode setting: O, T==0)</span></span>

<span data-ttu-id="9b454-320">Зарезервировано для будущего использования с сокетами.</span><span class="sxs-lookup"><span data-stu-id="9b454-320">Reserved for future use with sockets.</span></span>

<span data-ttu-id="9b454-321">Возвращает список настроенных интерфейсов IP и их параметров в виде массива [**\_ сведений о интерфейсе \_ ex**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info_ex) .</span><span class="sxs-lookup"><span data-stu-id="9b454-321">Returns a list of configured IP interfaces and their parameters as an array of [**INTERFACE\_INFO\_EX**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info_ex) structures.</span></span>

<span data-ttu-id="9b454-322">Параметр *лпваутбуффер* указывает на буфер, в котором хранятся сведения об интерфейсах в виде массива [**сведений о интерфейсе \_ \_**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info_ex) , например структуры для одноадресных IP-адресов в интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9b454-322">The *lpvOutBuffer* parameter points to the buffer in which to store the information about interfaces as an array of [**INTERFACE\_INFO\_EX**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-interface_info_ex) structures for unicast IP addresses on the interface.</span></span> <span data-ttu-id="9b454-323">Параметр *кбаутбуффер* задает длину выходного буфера.</span><span class="sxs-lookup"><span data-stu-id="9b454-323">The *cbOutBuffer* parameter specifies the length of the output buffer.</span></span> <span data-ttu-id="9b454-324">Число возвращаемых интерфейсов (число структур, возвращаемых в *лпваутбуффер*) можно определить на основе фактической длины выходного буфера, возвращаемого в параметре *лпкббитесретурнед* .</span><span class="sxs-lookup"><span data-stu-id="9b454-324">The number of interfaces returned (number of structures returned in *lpvOutBuffer*) can be determined based on the actual length of the output buffer returned in *lpcbBytesReturned* parameter.</span></span>

<span data-ttu-id="9b454-325">**Суперконтроллер ввода/вывода \_ ПОЛУЧЕНИЕ \_ списка интерфейсов, \_ \_ например** , в настоящее время не поддерживается в Windows.</span><span class="sxs-lookup"><span data-stu-id="9b454-325">**SIO\_GET\_INTERFACE\_LIST\_EX** is not currently supported on Windows.</span></span>

### <a name="sio_get_qos-opcode-setting-o-t1"></a><span data-ttu-id="9b454-326">\_Получение \_ качества обслуживания sio (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-326">SIO\_GET\_QOS (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-327">Зарезервировано для будущего использования с сокетами.</span><span class="sxs-lookup"><span data-stu-id="9b454-327">Reserved for future use with sockets.</span></span> <span data-ttu-id="9b454-328">Получение структуры [**QoS**](/windows/win32/api/winsock2/ns-winsock2-qos) , связанной с сокетом.</span><span class="sxs-lookup"><span data-stu-id="9b454-328">Retrieve the [**QOS**](/windows/win32/api/winsock2/ns-winsock2-qos) structure associated with the socket.</span></span> <span data-ttu-id="9b454-329">Входной буфер является необязательным.</span><span class="sxs-lookup"><span data-stu-id="9b454-329">The input buffer is optional.</span></span> <span data-ttu-id="9b454-330">Некоторые протоколы (например, RSVP) позволяют использовать входной буфер для уточнения запроса на качество обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9b454-330">Some protocols (for example, RSVP) allow the input buffer to be used to qualify a quality of service request.</span></span> <span data-ttu-id="9b454-331">Структура **качества обслуживания** будет скопирована в выходной буфер.</span><span class="sxs-lookup"><span data-stu-id="9b454-331">The **QOS** structure will be copied into the output buffer.</span></span> <span data-ttu-id="9b454-332">Размер выходного буфера должен быть достаточно большим, чтобы вместить полную структуру **QoS** .</span><span class="sxs-lookup"><span data-stu-id="9b454-332">The output buffer must be sized large enough to be able to contain the full **QOS** structure.</span></span> <span data-ttu-id="9b454-333">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают качество обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9b454-333">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support quality of service.</span></span>

<span data-ttu-id="9b454-334">Отправитель может не вызывать **SIO для \_ получения \_ QoS** , пока сокет не будет подключен.</span><span class="sxs-lookup"><span data-stu-id="9b454-334">A sender may not call **SIO\_GET\_QOS** until the socket is connected.</span></span>

<span data-ttu-id="9b454-335">Получатель может вызвать **SIO для \_ получения \_ качества обслуживания** , как только оно будет привязано.</span><span class="sxs-lookup"><span data-stu-id="9b454-335">A receiver may call **SIO\_GET\_QOS** as soon as it is bound.</span></span>

### <a name="sio_ideal_send_backlog_change-opcode-setting-v-t0"></a><span data-ttu-id="9b454-336">\_Оптимальное \_ \_ изменение невыполненной работы SIO \_ (параметр кода операции: V, T = = 0)</span><span class="sxs-lookup"><span data-stu-id="9b454-336">SIO\_IDEAL\_SEND\_BACKLOG\_CHANGE (opcode setting: V, T==0)</span></span>

<span data-ttu-id="9b454-337">Уведомляет приложение об изменении идеального значения невыполненной отправки (ISB) для базового соединения.</span><span class="sxs-lookup"><span data-stu-id="9b454-337">Notifies an application when the ideal send backlog (ISB) value changes for the underlying connection.</span></span>

<span data-ttu-id="9b454-338">При отправке данных через TCP-соединение с помощью сокетов Windows важно обеспечить достаточное количество необработанных данных (отправленных, но еще не подтвержденных) в TCP для достижения максимальной пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="9b454-338">When sending data over a TCP connection using Windows sockets, it is important to keep a sufficient amount of data outstanding (sent but not acknowledged yet) in TCP in order to achieve the highest throughput.</span></span> <span data-ttu-id="9b454-339">Оптимальное значение объема данных, необходимых для достижения наилучшей пропускной способности для подключения TCP, называется идеальным размером невыполненной отправки (ISB).</span><span class="sxs-lookup"><span data-stu-id="9b454-339">The ideal value for the amount of data outstanding to achieve the best throughput for the TCP connection is called the ideal send backlog (ISB) size.</span></span> <span data-ttu-id="9b454-340">Значение ISB является функцией произведения задержки пропускной способности подключения TCP и полученного окна приема получателя (а также частично перегрузки в сети).</span><span class="sxs-lookup"><span data-stu-id="9b454-340">The ISB value is a function of the bandwidth-delay product of the TCP connection and the receiver's advertised receive window (and partly the amount of congestion in the network).</span></span>

<span data-ttu-id="9b454-341">Значение ISB для каждого подключения доступно в реализации протокола TCP в Windows Server 2008, Windows Vista с пакетом обновления 1 (SP1) и более поздних версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9b454-341">The ISB value per connection is available from the TCP protocol implementation in Windows Server 2008, Windows Vista with SP1, and later versions of the operating system.</span></span> <span data-ttu-id="9b454-342">**\_ Оптимальный запрос \_ на \_ отработку невыполненной работы \_ по отправке SIO** может использоваться приложением для получения уведомления при динамическом изменении значения ISB для соединения.</span><span class="sxs-lookup"><span data-stu-id="9b454-342">The **SIO\_IDEAL\_SEND\_BACKLOG\_CHANGE** IOCTL can be used by an application to get notification when the ISB value changes dynamically for a connection.</span></span>

<span data-ttu-id="9b454-343">Дополнительные сведения см. в справочнике [**по \_ \_ \_ \_ изменению невыполненной работы SIO**](/previous-versions/windows/desktop/legacy/bb736548(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-343">For more detailed information, see the [**SIO\_IDEAL\_SEND\_BACKLOG\_CHANGE**](/previous-versions/windows/desktop/legacy/bb736548(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-344">[**Суперконтроллер ввода/вывода \_ ОПТИМАЛЬное \_ \_ \_ изменение невыполненной работы по отправке**](/previous-versions/windows/desktop/legacy/bb736548(v=vs.85)) поддерживается в Windows Server 2008, Windows Vista с пакетом обновления 1 (SP1) и более поздних версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9b454-344">[**SIO\_IDEAL\_SEND\_BACKLOG\_CHANGE**](/previous-versions/windows/desktop/legacy/bb736548(v=vs.85)) is supported on Windows Server 2008, Windows Vista with SP1, and later versions of the operating system.</span></span>

### <a name="sio_ideal_send_backlog_query-opcode-setting-o-t0"></a><span data-ttu-id="9b454-345">\_Идеальный \_ запрос на \_ отработку невыполненной работы по отправке SIO \_ (параметр кода операции: O, T = = 0)</span><span class="sxs-lookup"><span data-stu-id="9b454-345">SIO\_IDEAL\_SEND\_BACKLOG\_QUERY (opcode setting: O, T==0)</span></span>

<span data-ttu-id="9b454-346">Извлекает оптимальное значение невыполненной отправки (ISB) для базового соединения.</span><span class="sxs-lookup"><span data-stu-id="9b454-346">Retrieves the ideal send backlog (ISB) value for the underlying connection.</span></span>

<span data-ttu-id="9b454-347">При отправке данных через TCP-соединение с помощью сокетов Windows важно обеспечить достаточное количество необработанных данных (отправленных, но еще не подтвержденных) в TCP для достижения максимальной пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="9b454-347">When sending data over a TCP connection using Windows sockets, it is important to keep a sufficient amount of data outstanding (sent but not acknowledged yet) in TCP in order to achieve the highest throughput.</span></span> <span data-ttu-id="9b454-348">Оптимальное значение объема данных, необходимых для достижения наилучшей пропускной способности для подключения TCP, называется идеальным размером невыполненной отправки (ISB).</span><span class="sxs-lookup"><span data-stu-id="9b454-348">The ideal value for the amount of data outstanding to achieve the best throughput for the TCP connection is called the ideal send backlog (ISB) size.</span></span> <span data-ttu-id="9b454-349">Значение ISB является функцией произведения задержки пропускной способности подключения TCP и полученного окна приема получателя (а также частично перегрузки в сети).</span><span class="sxs-lookup"><span data-stu-id="9b454-349">The ISB value is a function of the bandwidth-delay product of the TCP connection and the receiver's advertised receive window (and partly the amount of congestion in the network).</span></span>

<span data-ttu-id="9b454-350">Значение ISB для каждого подключения доступно в реализации протокола TCP в Windows Server 2008 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-350">The ISB value per connection is available from the TCP protocol implementation in Windows Server 2008 and later.</span></span> <span data-ttu-id="9b454-351">Запрос IOCTL с **\_ идеальными для \_ отправки \_ невыполненной работы \_** может использоваться приложением для запроса значения ISB для соединения.</span><span class="sxs-lookup"><span data-stu-id="9b454-351">The **SIO\_IDEAL\_SEND\_BACKLOG\_QUERY** IOCTL can be used by an application to query the ISB value for a connection.</span></span>

<span data-ttu-id="9b454-352">Более подробные сведения см. в справочнике по [**\_ \_ \_ \_ запросу невыполненной работы по отправке SIO**](/previous-versions/windows/desktop/legacy/bb736549(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-352">For more detailed information, see the [**SIO\_IDEAL\_SEND\_BACKLOG\_QUERY**](/previous-versions/windows/desktop/legacy/bb736549(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-353">[**Суперконтроллер ввода/вывода \_ ИДЕАЛЬНЫЙ \_ \_ \_ запрос на отработку невыполненной работы**](/previous-versions/windows/desktop/legacy/bb736549(v=vs.85)) поддерживается в Windows Server 2008, Windows Vista с пакетом обновления 1 (SP1) и более поздних версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9b454-353">[**SIO\_IDEAL\_SEND\_BACKLOG\_QUERY**](/previous-versions/windows/desktop/legacy/bb736549(v=vs.85)) is supported on Windows Server 2008, Windows Vista with SP1, and later versions of the operating system.</span></span>

### <a name="sio_keepalive_vals-opcode-setting-i-t3"></a><span data-ttu-id="9b454-354">\_Валс KeepAlive SIO \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-354">SIO\_KEEPALIVE\_VALS (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-355">Включает или отключает параметр для каждого подключения параметра проверки **активности** TCP, который указывает время ожидания и интервал поддержания активности TCP.</span><span class="sxs-lookup"><span data-stu-id="9b454-355">Enables or disables the per-connection setting of the TCP **keep-alive** option which specifies the TCP keep-alive timeout and interval.</span></span> <span data-ttu-id="9b454-356">Дополнительные сведения о параметре проверки активности см. в разделе 4.2.3.6 ( *требования для узлов Интернета) — уровни взаимодействия* , указанные в RFC 1122, доступны на [веб-сайте IETF](https://www.ietf.org/rfc/rfc1122.txt).</span><span class="sxs-lookup"><span data-stu-id="9b454-356">For more information on the keep-alive option, see section 4.2.3.6 on the *Requirements for Internet Hosts—Communication Layers* specified in RFC 1122 available at the [IETF website](https://www.ietf.org/rfc/rfc1122.txt).</span></span> <span data-ttu-id="9b454-357">(Этот ресурс может быть доступен только на английском языке.)</span><span class="sxs-lookup"><span data-stu-id="9b454-357">(This resource may only be available in English.)</span></span>

<span data-ttu-id="9b454-358">**Суперконтроллер ввода/вывода \_ \_ВАЛС KeepAlive** можно использовать для включения или отключения проверок активности и установки времени ожидания и интервала проверки активности.</span><span class="sxs-lookup"><span data-stu-id="9b454-358">**SIO\_KEEPALIVE\_VALS** can be used to enable or disable keep-alive probes and set the keep-alive timeout and interval.</span></span> <span data-ttu-id="9b454-359">Время ожидания проверки активности указывает время ожидания (в миллисекундах) без активности, пока не будет отправлен первый пакет проверки активности.</span><span class="sxs-lookup"><span data-stu-id="9b454-359">The keep-alive timeout specifies the timeout, in milliseconds, with no activity until the first keep-alive packet is sent.</span></span> <span data-ttu-id="9b454-360">Интервал проверки активности определяет интервал (в миллисекундах) между отправкой успешных пакетов проверки активности, если подтверждение не получено.</span><span class="sxs-lookup"><span data-stu-id="9b454-360">The keep-alive interval specifies the interval, in milliseconds, between when successive keep-alive packets are sent if no acknowledgement is received.</span></span>

<span data-ttu-id="9b454-361">[**Таким образом \_**](so-keepalive.md) , параметр KeepAlive, который является одним из [ \_ параметров сокета сокета Sol](sol-socket-socket-options.md), также может использоваться для включения или отключения поддержки TCP-активности в соединении, а также для запроса текущего состояния этого параметра.</span><span class="sxs-lookup"><span data-stu-id="9b454-361">The [**SO\_KEEPALIVE**](so-keepalive.md) option, which is one of the [SOL\_SOCKET Socket Options](sol-socket-socket-options.md), can also be used to enable or disable the TCP keep-alive on a connection, as well as query the current state of this option.</span></span> <span data-ttu-id="9b454-362">Чтобы запросить, включена ли поддержка TCP-активности на сокете, функцию [**жетсоккопт**](/windows/desktop/api/winsock/nf-winsock-getsockopt) можно вызвать с помощью параметра **so \_ KeepAlive** .</span><span class="sxs-lookup"><span data-stu-id="9b454-362">To query whether TCP keep-alive is enabled on a socket, the [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) function can be called with the **SO\_KEEPALIVE** option.</span></span> <span data-ttu-id="9b454-363">Чтобы включить или отключить поддержку поддержания активности TCP, функцию [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt) можно вызвать с помощью параметра [**so \_ KeepAlive**](so-keepalive.md) .</span><span class="sxs-lookup"><span data-stu-id="9b454-363">To enable or disable TCP keep-alive, the [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) function can be called with the [**SO\_KEEPALIVE**](so-keepalive.md) option.</span></span> <span data-ttu-id="9b454-364">Если поддержка проверки активности TCP включена с **таким образом \_**, то для времени ожидания и интервала проверки активности используются параметры TCP по умолчанию, если эти значения не были изменены с помощью **SIO \_ KeepAlive \_ Валс**.</span><span class="sxs-lookup"><span data-stu-id="9b454-364">If TCP keep-alive is enabled with **SO\_KEEPALIVE**, then the default TCP settings are used for keep-alive timeout and interval unless these values have been changed using **SIO\_KEEPALIVE\_VALS**.</span></span>

<span data-ttu-id="9b454-365">Более подробные сведения см. в справочнике по [**\_ KeepAlive \_ Валс**](/previous-versions/windows/desktop/legacy/dd877220(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-365">For more detailed information, see the [**SIO\_KEEPALIVE\_VALS**](/previous-versions/windows/desktop/legacy/dd877220(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-366">**Суперконтроллер ввода/вывода \_ KEEPALIVE \_ Валс** поддерживается в Windows 2000 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-366">**SIO\_KEEPALIVE\_VALS** is supported on Windows 2000 and later.</span></span>

### <a name="sio_loopback_fast_path-opcode-setting-i-t3"></a><span data-ttu-id="9b454-367">\_Быстрый путь замыкания на себя SIO \_ \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-367">SIO\_LOOPBACK\_FAST\_PATH (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-368">Настраивает сокет TCP для более низкой задержки и более быстрых операций в интерфейсе замыкания на себя.</span><span class="sxs-lookup"><span data-stu-id="9b454-368">Configures a TCP socket for lower latency and faster operations on the loopback interface.</span></span> <span data-ttu-id="9b454-369">Этот запрос IOCTL запрашивает использование в стеке TCP/IP специального быстрого пути для операций замыкания на себя на этом сокете.</span><span class="sxs-lookup"><span data-stu-id="9b454-369">This IOCTL requests that the TCP/IP stack uses a special fast path for loopback operations on this socket.</span></span> <span data-ttu-id="9b454-370">IOCTL [**с \_ \_ быстрым \_ путем замыкания на себя**](/previous-versions/windows/desktop/legacy/jj841212(v=vs.85)) можно использовать только с сокетами TCP.</span><span class="sxs-lookup"><span data-stu-id="9b454-370">The [**SIO\_LOOPBACK\_FAST\_PATH**](/previous-versions/windows/desktop/legacy/jj841212(v=vs.85)) IOCTL can be used only with TCP sockets.</span></span> <span data-ttu-id="9b454-371">Этот запрос IOCTL должен использоваться на обеих сторонах сеанса замыкания на себя.</span><span class="sxs-lookup"><span data-stu-id="9b454-371">This IOCTL must be used on both sides of the loopback session.</span></span> <span data-ttu-id="9b454-372">Быстрый путь TCP замыкания на себя поддерживается с помощью интерфейса замыкания на себя IPv4 или IPv6.</span><span class="sxs-lookup"><span data-stu-id="9b454-372">The TCP loopback fast path is supported using either the IPv4 or IPv6 loopback interface.</span></span> <span data-ttu-id="9b454-373">По умолчанию **\_ Быстрый режим замыкания на себя на петлевой \_ \_ адрес** отключен.</span><span class="sxs-lookup"><span data-stu-id="9b454-373">By default, **SIO\_LOOPBACK\_FAST\_PATH** is disabled.</span></span>

<span data-ttu-id="9b454-374">Дополнительные сведения см. в справочнике [**по \_ \_ быстрому \_ пути замыкания на себя**](/previous-versions/windows/desktop/legacy/jj841212(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-374">For more detailed information, see the [**SIO\_LOOPBACK\_FAST\_PATH**](/previous-versions/windows/desktop/legacy/jj841212(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-375">**Суперконтроллер ввода/вывода \_ \_Быстрый \_ путь замыкания на себя** поддерживается в Windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-375">**SIO\_LOOPBACK\_FAST\_PATH** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_multipoint_loopback-opcode-setting-v-t1"></a><span data-ttu-id="9b454-376">\_Петлевой MULTIPOINT \_ (параметр кода операции: V, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-376">SIO\_MULTIPOINT\_LOOPBACK (opcode setting: V, T==1)</span></span>

<span data-ttu-id="9b454-377">Определяет, будут ли данные, отправляемые приложением на локальном компьютере (не обязательное одним сокетом) в сеансе многоадресной рассылки, приниматься сокетом, присоединенным к группе назначения многоадресной рассылки через интерфейс замыкания на себя.</span><span class="sxs-lookup"><span data-stu-id="9b454-377">Controls whether data sent by an application on the local computer (not necessarily by the same socket) in a multicast session will be received by a socket joined to the multicast destination group on the loopback interface.</span></span> <span data-ttu-id="9b454-378">Значение **true** приводит к тому, что данные многоадресной рассылки, отправляемые приложением на локальном компьютере, доставляются в Прослушивающий сокет через интерфейс замыкания на себя.</span><span class="sxs-lookup"><span data-stu-id="9b454-378">A value of **TRUE** causes multicast data sent by an application on the local computer to be delivered to a listening socket on the loopback interface.</span></span> <span data-ttu-id="9b454-379">Значение **false** указывает, что данные многоадресной рассылки, отправляемые приложением на локальном компьютере, не доставляются в Прослушивающий сокет через интерфейс замыкания на себя.</span><span class="sxs-lookup"><span data-stu-id="9b454-379">A value of **FALSE** prevents multicast data sent by an application on the local computer from being delivered to a listening socket on the loopback interface.</span></span> <span data-ttu-id="9b454-380">По умолчанию **\_ \_ петлевой контроллер SIO MULTIPOINT** включен.</span><span class="sxs-lookup"><span data-stu-id="9b454-380">By default, **SIO\_MULTIPOINT\_LOOPBACK** is enabled.</span></span>

### <a name="sio_multicast_scope-opcode-setting-i-t1"></a><span data-ttu-id="9b454-381">\_Многоадресная \_ область sio (параметр кода операции: I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-381">SIO\_MULTICAST\_SCOPE (opcode setting: I, T==1)</span></span>

<span data-ttu-id="9b454-382">Указывает область, в которой будут выполняться многоадресные передачи.</span><span class="sxs-lookup"><span data-stu-id="9b454-382">Specifies the scope over which multicast transmissions will occur.</span></span> <span data-ttu-id="9b454-383">Область определяется как количество сегментов маршрутизируемых сетей, подпадающих под действие.</span><span class="sxs-lookup"><span data-stu-id="9b454-383">Scope is defined as the number of routed network segments to be covered.</span></span> <span data-ttu-id="9b454-384">Нулевая область означает, что многоадресная передача не будет помещаться в сеть, но может быть распределена между сокетами на локальном узле.</span><span class="sxs-lookup"><span data-stu-id="9b454-384">A scope of zero would indicate that the multicast transmission would not be placed on the wire but could be disseminated across sockets within the local host.</span></span> <span data-ttu-id="9b454-385">Значение области, равное единице (по умолчанию), указывает, что передача будет размещена на канале передачи, но не будет пересекать маршрутизаторы.</span><span class="sxs-lookup"><span data-stu-id="9b454-385">A scope value of one (the default) indicates that the transmission will be placed on the wire, but will not cross any routers.</span></span> <span data-ttu-id="9b454-386">Более высокие значения области определяют количество маршрутизаторов, которые могут быть перепутаны.</span><span class="sxs-lookup"><span data-stu-id="9b454-386">Higher scope values determine the number of routers that can be crossed.</span></span> <span data-ttu-id="9b454-387">Обратите внимание, что это соответствует параметру срока жизни (TTL) в многоадресной IP-рассылке.</span><span class="sxs-lookup"><span data-stu-id="9b454-387">Note that this corresponds to the time-to-live (TTL) parameter in IP multicasting.</span></span> <span data-ttu-id="9b454-388">По умолчанию областью действия является 1.</span><span class="sxs-lookup"><span data-stu-id="9b454-388">By default, scope is 1.</span></span>

### <a name="sio_query_rss_processor_info-opcode-setting-o-t1"></a><span data-ttu-id="9b454-389">\_ \_ \_ Сведения о обработчике запросов SIO в формате RSS \_ (параметр кода операции: O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-389">SIO\_QUERY\_RSS\_PROCESSOR\_INFO (opcode setting: O, T==1)</span></span>

<span data-ttu-id="9b454-390">Запрашивает связь между сокетом и ядром процессора RSS и узлом NUMA.</span><span class="sxs-lookup"><span data-stu-id="9b454-390">Queries the association between a socket and an RSS processor core and NUMA node.</span></span>

<span data-ttu-id="9b454-391">[**\_ \_ \_ \_ Сведения о процессоре суперконтроллера**](/previous-versions/windows/desktop/legacy/jj553482(v=vs.85)) ввода-вывода в формате RSS запрос IOCTL возвращает структуру [**\_ \_ соответствия процессоров сокетов**](/windows/desktop/api/Ws2def/ns-ws2def-socket_processor_affinity) , которая содержит [**\_ номер процессора**](/windows/win32/api/winnt/ns-winnt-processor_number) и идентификатор узла NUMA.</span><span class="sxs-lookup"><span data-stu-id="9b454-391">The [**SIO\_QUERY\_RSS\_PROCESSOR\_INFO**](/previous-versions/windows/desktop/legacy/jj553482(v=vs.85)) IOCTL returns a [**SOCKET\_PROCESSOR\_AFFINITY**](/windows/desktop/api/Ws2def/ns-ws2def-socket_processor_affinity) structure that contains the [**PROCESSOR\_NUMBER**](/windows/win32/api/winnt/ns-winnt-processor_number) and the NUMA node ID.</span></span> <span data-ttu-id="9b454-392">Возвращенная **Структура \_ номеров процессоров** содержит номер группы и относительный номер процессора в группе.</span><span class="sxs-lookup"><span data-stu-id="9b454-392">The returned **PROCESSOR\_NUMBER** structure contains a group number and relative processor number within the group.</span></span>

<span data-ttu-id="9b454-393">Более подробные сведения см. в справочнике по [**\_ \_ \_ \_ сведениям о процессоре SIO**](/previous-versions/windows/desktop/legacy/jj553482(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-393">For more detailed information, see the [**SIO\_QUERY\_RSS\_PROCESSOR\_INFO**](/previous-versions/windows/desktop/legacy/jj553482(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-394">**Суперконтроллер ввода/вывода \_ \_ \_ \_ Сведения о обработчике RSS-канала для запросов** поддерживаются в Windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-394">**SIO\_QUERY\_RSS\_PROCESSOR\_INFO** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_query_rss_scalability_info-opcode-setting-o-t3"></a><span data-ttu-id="9b454-395">\_ \_ \_ Сведения о масштабируемости RSS запроса SIO \_ (параметр кода операции: O, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-395">SIO\_QUERY\_RSS\_SCALABILITY\_INFO (opcode setting: O, T==3)</span></span>

<span data-ttu-id="9b454-396">Запрашивает разгрузку интерфейсов для возможности масштабирования на стороне приема (RSS).</span><span class="sxs-lookup"><span data-stu-id="9b454-396">Queries offload interfaces for receive-side scaling (RSS) capability.</span></span> <span data-ttu-id="9b454-397">Структура аргумента, возвращаемая для **\_ \_ \_ \_ сведений о масштабируемости RSS запроса SIO** , указана в структуре **\_ \_ сведений о масштабируемости RSS** , определенной в файле заголовка *мсткпип. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-397">The argument structure returned for **SIO\_QUERY\_RSS\_SCALABILITY\_INFO** is specified in the **RSS\_SCALABILITY\_INFO** structure defined in the *Mstcpip.h* header file.</span></span> <span data-ttu-id="9b454-398">Эта структура определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9b454-398">This structure is defined as follows:</span></span>

```cpp
// Scalability info for the transport
typedef struct _RSS_SCALABILITY_INFO {
   BOOLEAN RssEnabled;
} RSS_SCALABILITY_INFO, *PRSS_SCALABILITY_INFO;
```

<span data-ttu-id="9b454-399">Значение, возвращаемое в элементе **рссенаблед** , указывает, включена ли поддержка RSS по крайней мере в одном интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9b454-399">The value returned in the **RssEnabled** member indicates if RSS is enabled on at least one interface.</span></span>

<span data-ttu-id="9b454-400">Если выходной буфер не достаточен для структуры **\_ \_ сведений о масштабируемости RSS** ( *кбаутбуффер* меньше, чем размер **\_ \_ информации о масштабируемости RSS**), или параметр *лпваутбуффер* является **пустым** указателем, то в результате этого ioctl возвращается **\_ Ошибка сокета** , а [**всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаеинвал](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-400">If the output buffer is not large enough for the **RSS\_SCALABILITY\_INFO** structure (the *cbOutBuffer* is less than the size of a **RSS\_SCALABILITY\_INFO**) or the *lpvOutBuffer* parameter is a **NULL** pointer, **SOCKET\_ERROR** is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEINVAL](windows-sockets-error-codes-2.md).</span></span>

<span data-ttu-id="9b454-401">В высокоскоростной сети, в которой несколько процессоров находятся в пределах одной системы, способность стека сетевых протоколов масштабироваться в многопроцессорной системе, запрещена, поскольку архитектура NDIS 5,1 и более ранних версий ограничивает скорость обработки протокола одним ЦП.</span><span class="sxs-lookup"><span data-stu-id="9b454-401">In high-speed networking where multiple CPUs reside within a single system, the ability of the networking protocol stack to scale well on a multi-CPU system is inhibited because the architecture of NDIS 5.1 and earlier versions limits receive protocol processing to a single CPU.</span></span> <span data-ttu-id="9b454-402">Масштабирование на стороне приема (RSS) устраняет эту проблему, разрешая сетевую загрузку с сетевого адаптера на несколько процессоров.</span><span class="sxs-lookup"><span data-stu-id="9b454-402">Receive-side scaling (RSS) resolves this issue by allowing the network load from a network adapter to be balanced across multiple CPUs.</span></span>

<span data-ttu-id="9b454-403">**Суперконтроллер ввода/вывода \_ \_ \_ \_ Сведения о масштабируемости RSS-канала запросов** поддерживаются в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-403">**SIO\_QUERY\_RSS\_SCALABILITY\_INFO** is supported on Windows Vista and later.</span></span>

### <a name="sio_query_transport_setting-opcode-setting-i-t3"></a><span data-ttu-id="9b454-404">\_ \_ Параметр транспорта запросов SIO \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-404">SIO\_QUERY\_TRANSPORT\_SETTING (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-405">Запрашивает параметры транспорта на сокете.</span><span class="sxs-lookup"><span data-stu-id="9b454-405">Queries the transport settings on a socket.</span></span> <span data-ttu-id="9b454-406">Запрашиваемый параметр транспорта основан на [**\_ \_ идентификаторе параметра транспорта**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) , переданном в параметре *лпвинбуффер* .</span><span class="sxs-lookup"><span data-stu-id="9b454-406">The transport setting being queried is based on the [**TRANSPORT\_SETTING\_ID**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) passed in the *lpvInBuffer* parameter.</span></span>

<span data-ttu-id="9b454-407">Единственным параметром транспорта, который сейчас определяет, является возможность получения **\_ \_ уведомлений \_ в режиме реального времени** на сокете TCP.</span><span class="sxs-lookup"><span data-stu-id="9b454-407">The only transport setting currently defines is for the **REAL\_TIME\_NOTIFICATION\_CAPABILITY** capability on a TCP socket.</span></span>

<span data-ttu-id="9b454-408">Если [**\_ \_ идентификатор параметра транспорта**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) имеет значение **GUID** , установленное в **режиме реального \_ времени \_ , это \_** запрос на запрос параметров уведомлений в режиме реального времени для сокета TCP, используемого с [**контролчаннелтригжер**](/uwp/api/Windows.Networking.Sockets.ControlChannelTrigger) , для получения фоновых уведомлений в приложении Магазина Windows.</span><span class="sxs-lookup"><span data-stu-id="9b454-408">If the [**TRANSPORT\_SETTING\_ID**](/windows/win32/api/transportsettingcommon/ns-transportsettingcommon-transport_setting_id) has the **Guid** member set to **REAL\_TIME\_NOTIFICATION\_CAPABILITY**, then this is a request to query the real time notification settings for the TCP socket used with the [**ControlChannelTrigger**](/uwp/api/Windows.Networking.Sockets.ControlChannelTrigger) to receive background network notifications in a Windows Store app.</span></span> <span data-ttu-id="9b454-409">При успешном вызове [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) или [**ВСПИОКТЛ**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) этот запрос IOCTL возвращает [**\_ \_ \_ \_ выходную структуру параметра уведомления в режиме реального времени**](/windows/desktop/api/Mstcpip/ns-mstcpip-real_time_notification_setting_input) с текущим состоянием.</span><span class="sxs-lookup"><span data-stu-id="9b454-409">If the [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) or [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) call is successful, this IOCTL returns a [**REAL\_TIME\_NOTIFICATION\_SETTING\_OUTPUT**](/windows/desktop/api/Mstcpip/ns-mstcpip-real_time_notification_setting_input) structure with the current status.</span></span>

<span data-ttu-id="9b454-410">Более подробные сведения см. в справочнике по [**\_ \_ \_ параметрам транспорта запросов SIO**](/previous-versions/windows/desktop/legacy/jj553483(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-410">For more detailed information, see the [**SIO\_QUERY\_TRANSPORT\_SETTING**](/previous-versions/windows/desktop/legacy/jj553483(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-411">**Суперконтроллер ввода/вывода \_ \_ \_ Параметр передачи запросов** поддерживается в Windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-411">**SIO\_QUERY\_TRANSPORT\_SETTING** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_query_wfp_ale_endpoint_handle-opcode-setting-o-t3"></a><span data-ttu-id="9b454-412">\_Обработчик SIO запрос на \_ \_ \_ конечную точку ALE WFP \_ (параметр кода операции: O, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-412">SIO\_QUERY\_WFP\_ALE\_ENDPOINT\_HANDLE (opcode setting: O, T==3)</span></span>

<span data-ttu-id="9b454-413">Запрашивает обработчика конечных точек принудительного применения уровня приложения (ALE).</span><span class="sxs-lookup"><span data-stu-id="9b454-413">Queries the Application Layer Enforcement (ALE) endpoint handle.</span></span>

<span data-ttu-id="9b454-414">Платформа фильтрации Windows (WFP) поддерживает проверку и изменение сетевого трафика.</span><span class="sxs-lookup"><span data-stu-id="9b454-414">The Windows Filtering Platform (WFP) supports network traffic inspection and modification.</span></span> <span data-ttu-id="9b454-415">В Windows Vista в WFP основное внимание уделяется сценариям, где хост-компьютер является конечной точкой связи.</span><span class="sxs-lookup"><span data-stu-id="9b454-415">On Windows Vista, WFP focuses on scenarios where the host machine is the communication endpoint.</span></span> <span data-ttu-id="9b454-416">Однако в Windows Server 2008 существуют реализации пограничных брандмауэров, которые хотели бы использовать платформу WFP для проверки и сквозного трафика прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="9b454-416">On Windows Server 2008 , however, there are edge firewall implementations which would like to leverage the WFP platform to inspect and proxy pass-through traffic.</span></span> <span data-ttu-id="9b454-417">Примером такого устройства является сервер Internet Security and Acceleration (ISA).</span><span class="sxs-lookup"><span data-stu-id="9b454-417">The Internet Security and Acceleration (ISA) server is an example of such an edge device.</span></span>

<span data-ttu-id="9b454-418">В некоторых сценариях брандмауэра может потребоваться возможность внедрять входящий пакет в путь отправки, связанный с существующей конечной точкой.</span><span class="sxs-lookup"><span data-stu-id="9b454-418">There are some firewall scenarios that may require the ability to inject an inbound packet into the send path associated with an existing endpoint.</span></span> <span data-ttu-id="9b454-419">Необходим механизм обнаружения маркера конечной точки транспортного уровня, связанного с конечной точкой назначения.</span><span class="sxs-lookup"><span data-stu-id="9b454-419">There needs to be a mechanism to discover the transport layer endpoint handle associated with the destination endpoint.</span></span> <span data-ttu-id="9b454-420">Приложение, создавшее конечную точку, владеет этими конечными точками транспортного уровня.</span><span class="sxs-lookup"><span data-stu-id="9b454-420">The application that created the endpoint owns these transport layer endpoints.</span></span> <span data-ttu-id="9b454-421">Этот запрос IOCTL используется для предоставления маркера сокета для сопоставления с маркерами конечной точки транспортного уровня.</span><span class="sxs-lookup"><span data-stu-id="9b454-421">This IOCTL is used to provide socket handle to transport layer endpoint handle mapping.</span></span>

<span data-ttu-id="9b454-422">Если выходной буфер недостаточно велик для маркера конечной точки ( *кбаутбуффер* меньше размера **UINT64**) или параметр *лпваутбуффер* является **пустым** указателем, то в результате выполнения этого ioctl возвращается **\_ Ошибка сокета** , а [**всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаеинвал](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-422">If the output buffer is not large enough for the endpoint handle (the *cbOutBuffer* is less than the size of a **UINT64**) or the *lpvOutBuffer* parameter is a **NULL** pointer, **SOCKET\_ERROR** is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEINVAL](windows-sockets-error-codes-2.md).</span></span>

<span data-ttu-id="9b454-423">**Суперконтроллер ввода/вывода \_ \_Обработчик запросов \_ к \_ конечным \_ точкам ALE WFP** поддерживается в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-423">**SIO\_QUERY\_WFP\_ALE\_ENDPOINT\_HANDLE** is supported on Windows Vista and later.</span></span>

### <a name="sio_query_wfp_connection_redirect_context-opcode-setting-i-t3"></a><span data-ttu-id="9b454-424">\_Запрос SIO \_ \_ \_ контекста перенаправления соединения WFP \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-424">SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_CONTEXT (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-425">Запрашивает контекст перенаправления для записи перенаправления, используемой службой перенаправления платформы фильтрации Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="9b454-425">Queries the redirect context for a redirect record used by a Windows Filtering Platform (WFP) redirect service.</span></span>

<span data-ttu-id="9b454-426">В [**\_ запросе SIO \_ \_ \_ \_ контекст перенаправления подключения WFP**](/previous-versions/windows/desktop/legacy/hh859712(v=vs.85)) используется для обеспечения отслеживания подключений через посредника при перенаправленных соединениях сокетов.</span><span class="sxs-lookup"><span data-stu-id="9b454-426">The [**SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_CONTEXT**](/previous-versions/windows/desktop/legacy/hh859712(v=vs.85)) IOCTL is used to provide proxied connection tracking on redirected socket connections.</span></span> <span data-ttu-id="9b454-427">Эта функция WFP упрощает отслеживание записей перенаправления из первоначального перенаправления соединения к конечному подключению.</span><span class="sxs-lookup"><span data-stu-id="9b454-427">This WFP feature facilitates tracking of redirection records from the initial redirect of a connection to the final connection to the destination.</span></span>

<span data-ttu-id="9b454-428">Более подробные сведения см. в разделе ссылка на [**\_ \_ \_ \_ \_ контекст перенаправления подключения WFP**](/previous-versions/windows/desktop/legacy/hh859712(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-428">For more detailed information, see the [**SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_CONTEXT**](/previous-versions/windows/desktop/legacy/hh859712(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-429">**Суперконтроллер ввода/вывода \_ ЗАПРОС \_ \_ \_ \_ контекста перенаправления подключения WFP** поддерживается в windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-429">**SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_CONTEXT** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_query_wfp_connection_redirect_records-opcode-setting-i-t3"></a><span data-ttu-id="9b454-430">SIO \_ запрос \_ на \_ \_ Перенаправление соединений WFP \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-430">SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_RECORDS (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-431">Запрашивает запись перенаправления для принятого подключения TCP/IP для использования службой перенаправления платформы фильтрации Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="9b454-431">Queries the redirect record for the accepted TCP/IP connection for use by a Windows Filtering Platform (WFP) redirect service.</span></span>

<span data-ttu-id="9b454-432">[**Записи о перенаправлении подключений в протоколе SIO используют запросы на \_ \_ \_ \_ \_ перенаправление запросов WFP**](/previous-versions/windows/desktop/legacy/hh859713(v=vs.85)) , чтобы обеспечить отслеживание подключений через посредника при перенаправленных соединениях сокетов.</span><span class="sxs-lookup"><span data-stu-id="9b454-432">The [**SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_RECORDS**](/previous-versions/windows/desktop/legacy/hh859713(v=vs.85)) IOCTL is used to provide proxied connection tracking on redirected socket connections.</span></span> <span data-ttu-id="9b454-433">Эта функция WFP упрощает отслеживание записей перенаправления из первоначального перенаправления соединения к конечному подключению.</span><span class="sxs-lookup"><span data-stu-id="9b454-433">This WFP feature facilitates tracking of redirection records from the initial redirect of a connection to the final connection to the destination.</span></span>

<span data-ttu-id="9b454-434">Более подробные сведения см. в справочнике по [**\_ \_ \_ \_ \_ записям перенаправления подключения WFP**](/previous-versions/windows/desktop/legacy/hh859713(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-434">For more detailed information, see the [**SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_RECORDS**](/previous-versions/windows/desktop/legacy/hh859713(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-435">**Суперконтроллер ввода/вывода \_ ЗАПРОСЫ \_ \_ \_ \_ записей перенаправления подключения WFP** поддерживаются в windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-435">**SIO\_QUERY\_WFP\_CONNECTION\_REDIRECT\_RECORDS** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_rcvall-opcode-setting-i-t3"></a><span data-ttu-id="9b454-436">SIO \_ рквалл (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-436">SIO\_RCVALL (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-437">Позволяет сокету принимать все пакеты IPv4 или IPv6, передающие срауигх сетевой интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9b454-437">Enables a socket to receive all IPv4 or IPv6 packets passing throuigh a network interface.</span></span> <span data-ttu-id="9b454-438">Маркер сокета, переданный функции [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) , должен быть одним из следующих:</span><span class="sxs-lookup"><span data-stu-id="9b454-438">The socket handle passed to the [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) function must be one of the following:</span></span>

-   <span data-ttu-id="9b454-439">Сокет IPv4, созданный с семейством адресов, имеющим значение AF \_ INET, тип сокета, установленный в значение Сокк \_ RAW, и протокол, установленный в иппрото \_ IP.</span><span class="sxs-lookup"><span data-stu-id="9b454-439">An IPv4 socket that was created with the address family set to AF\_INET, the socket type set to SOCK\_RAW, and the protocol set to IPPROTO\_IP.</span></span>
-   <span data-ttu-id="9b454-440">Сокет IPv6, созданный с семейством адресов, настроенным на AF \_ INET6, тип сокета, установленный в Сокк \_ RAW, и протокол, установленный в иппрото \_ IPv6.</span><span class="sxs-lookup"><span data-stu-id="9b454-440">An IPv6 socket that was created with the address family set to AF\_INET6, the socket type set to SOCK\_RAW, and the protocol set to IPPROTO\_IPV6.</span></span>

<span data-ttu-id="9b454-441">Сокет также должен быть привязан к явному локальному интерфейсу IPv4 или IPv6, что означает, что вы не можете выполнить привязку к **адресу \_** или **in6addr \_ любому** из них.</span><span class="sxs-lookup"><span data-stu-id="9b454-441">The socket also must be bound to an explicit local IPv4 or IPv6 interface, which means that you cannot bind to **INADDR\_ANY** or **in6addr\_any**.</span></span>

<span data-ttu-id="9b454-442">В Windows Server 2008 и более ранних версиях параметр [**\_ Рквалл ioctl SIO**](/previous-versions/windows/desktop/legacy/ee309610(v=vs.85)) не будет записывать локальные пакеты, отправленные из сетевого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9b454-442">On Windows Server 2008 and earlier, the [**SIO\_RCVALL**](/previous-versions/windows/desktop/legacy/ee309610(v=vs.85)) IOCTL setting would not capture local packets sent out of a network interface.</span></span> <span data-ttu-id="9b454-443">Это включает пакеты, полученные на другом интерфейсе, и перенаправляли сетевой интерфейс, указанный для **SIO \_ рквалл** IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-443">This included packets received on another interface and forwarded out the network interface specified for the **SIO\_RCVALL** IOCTL.</span></span>

<span data-ttu-id="9b454-444">В Windows 7 и Windows Server 2008 R2 это было изменено, так что также фиксируются локальные пакеты, отправленные из сетевого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9b454-444">On Windows 7 and Windows Server 2008 R2 , this was changed so that local packets sent out of a network interface are also captured.</span></span> <span data-ttu-id="9b454-445">Это относится к пакетам, полученным в другом интерфейсе, и последующем пересылке сетевого интерфейса, привязанного к сокету, с помощью интерфейса [**SIO \_ рквалл**](/previous-versions/windows/desktop/legacy/ee309610(v=vs.85)) IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-445">This includes packets received on another interface and then forwarded out the network interface bound to the socket with [**SIO\_RCVALL**](/previous-versions/windows/desktop/legacy/ee309610(v=vs.85)) IOCTL.</span></span>

<span data-ttu-id="9b454-446">Для установки этого IOCTL требуются права администратора на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="9b454-446">Setting this IOCTL requires Administrator privilege on the local computer.</span></span>

<span data-ttu-id="9b454-447">Эта функция иногда называется неизбирательным режимом.</span><span class="sxs-lookup"><span data-stu-id="9b454-447">This feature is sometimes referred to as promiscuous mode.</span></span>

<span data-ttu-id="9b454-448">Возможные значения параметра **SIO \_ рквалл** ioctl указаны в перечислении **\_ значений рквалл** , определенных в файле заголовка *мсткпип. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-448">The possible values for the **SIO\_RCVALL** IOCTL option are specified in the **RCVALL\_VALUE** enumeration defined in the *Mstcpip.h* header file.</span></span> <span data-ttu-id="9b454-449">Ниже приведены возможные значения для SIO \_ рквалл.</span><span class="sxs-lookup"><span data-stu-id="9b454-449">The possible values for SIO\_RCVALL are as follows:</span></span>

| <span data-ttu-id="9b454-450">Термин</span><span class="sxs-lookup"><span data-stu-id="9b454-450">Term</span></span>                                                                                                                 | <span data-ttu-id="9b454-451">Описание</span><span class="sxs-lookup"><span data-stu-id="9b454-451">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-|-|
| <span data-ttu-id="9b454-452"><span id="RCVALL_OFF"></span><span id="rcvall_off"></span>РКВАЛЛ \_</span><span class="sxs-lookup"><span data-stu-id="9b454-452"><span id="RCVALL_OFF"></span><span id="rcvall_off"></span>RCVALL\_OFF</span></span><br/>                                     | <span data-ttu-id="9b454-453">Отключите этот параметр, чтобы сокет не получал все пакеты IPv4 или IPv6 в сети.</span><span class="sxs-lookup"><span data-stu-id="9b454-453">Disable this option so a socket does not receive all IPv4 or IPv6 packets on the network.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="9b454-454"><span id="RCVALL_ON"></span><span id="rcvall_on"></span>РКВАЛЛ \_</span><span class="sxs-lookup"><span data-stu-id="9b454-454"><span id="RCVALL_ON"></span><span id="rcvall_on"></span>RCVALL\_ON</span></span><br/>                                        | <span data-ttu-id="9b454-455">Включите этот параметр, чтобы сокет получит все пакеты IPv4 или IPv6 в сети.</span><span class="sxs-lookup"><span data-stu-id="9b454-455">Enable this option so a socket receives all IPv4 or IPv6 packets on the network.</span></span> <span data-ttu-id="9b454-456">Этот параметр включает неизбирательный режим на плате сетевого интерфейса (NIC), если сетевой адаптер поддерживает неизбирательный режим.</span><span class="sxs-lookup"><span data-stu-id="9b454-456">This option enables promiscuous mode on the network interface card (NIC), if the NIC supports promiscuous mode.</span></span> <span data-ttu-id="9b454-457">В сегменте локальной сети с сетевым концентратором сетевая карта, поддерживающая неизбирательный режим, захватывает весь трафик IPv4 или IPv6 в локальной сети, включая трафик между другими компьютерами в одном сегменте локальной сети.</span><span class="sxs-lookup"><span data-stu-id="9b454-457">On a LAN segment with a network hub, a NIC that supports promiscuous mode will capture all IPv4 or IPv6 traffic on the LAN, including traffic between other computers on the same LAN segment.</span></span> <span data-ttu-id="9b454-458">Все захваченные пакеты (IPv4 или IPv6, в зависимости от сокета) будут переданы в необработанный сокет.</span><span class="sxs-lookup"><span data-stu-id="9b454-458">All of the captured packets (IPv4 or IPv6, depending on the socket) will be delivered to the raw socket.</span></span> <br/> <span data-ttu-id="9b454-459">Этот параметр не будет захватывать другие пакеты (например, пакеты ARP, IPX и NetBEUI) в интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9b454-459">This option will not capture other packets (ARP, IPX, and NetBEUI packets, for example) on the interface.</span></span><br/> <span data-ttu-id="9b454-460">NetMon использует тот же режим для сетевого интерфейса, но не использует этот параметр для записи трафика.</span><span class="sxs-lookup"><span data-stu-id="9b454-460">Netmon uses the same mode for the network interface, but does not use this option to capture traffic.</span></span><br/> |
| <span data-ttu-id="9b454-461"><span id="RCVALL_SOCKETLEVELONLY"></span><span id="rcvall_socketlevelonly"></span>РКВАЛЛ \_ соккетлевелонли</span><span class="sxs-lookup"><span data-stu-id="9b454-461"><span id="RCVALL_SOCKETLEVELONLY"></span><span id="rcvall_socketlevelonly"></span>RCVALL\_SOCKETLEVELONLY</span></span><br/> | <span data-ttu-id="9b454-462">Эта функция в настоящее время не реализована, поэтому установка этого параметра не влияет на.</span><span class="sxs-lookup"><span data-stu-id="9b454-462">This feature is not currently implemented, so setting this option does not have any affect.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="9b454-463"><span id="RCVALL_IPLEVEL"></span><span id="rcvall_iplevel"></span>РКВАЛЛ \_ иплевел</span><span class="sxs-lookup"><span data-stu-id="9b454-463"><span id="RCVALL_IPLEVEL"></span><span id="rcvall_iplevel"></span>RCVALL\_IPLEVEL</span></span><br/>                         | <span data-ttu-id="9b454-464">Включите этот параметр, чтобы сокет IPv4 или IPv6 получал все пакеты на уровне IP-адреса в сети.</span><span class="sxs-lookup"><span data-stu-id="9b454-464">Enable this option so an IPv4 or IPv6 socket receives all packets at the IP level on the network.</span></span> <span data-ttu-id="9b454-465">Этот параметр не включает неизбирательный режим на плате сетевого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9b454-465">This option does not enable promiscuous mode on the network interface card.</span></span> <span data-ttu-id="9b454-466">Этот параметр влияет только на обработку пакетов на уровне IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="9b454-466">This option only affects packet processing at the IP level.</span></span> <span data-ttu-id="9b454-467">Сетевая карта по-прежнему получает только пакеты, направленные на настроенные адрес рассылки и адреса многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="9b454-467">The NIC still receives only packets directed to its configured unicast and multicast addresses.</span></span> <span data-ttu-id="9b454-468">Тем не менее, сокет с включенным параметром будет получать не только пакеты, направленные на определенные IP-адреса, но и все пакеты IPv4 или IPv6, получаемые сетевым адаптером.</span><span class="sxs-lookup"><span data-stu-id="9b454-468">However, a socket with this option enabled will receive not only packets directed to specific IP addresses, but will receive all the IPv4 or IPv6 packets the NIC receives.</span></span><br/> <span data-ttu-id="9b454-469">Этот параметр не записывает другие пакеты (например, пакеты ARP, IPX и NetBEUI), полученные через интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9b454-469">This option will not capture other packets (ARP, IPX, and NetBEUI packets, for example) received on the interface.</span></span><br/>                                                                                             |



 

<span data-ttu-id="9b454-470">Более подробные сведения см. в справочнике по [**SIO \_ рквалл**](/previous-versions/windows/desktop/legacy/ee309610(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-470">For more detailed information, see the [**SIO\_RCVALL**](/previous-versions/windows/desktop/legacy/ee309610(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-471">**Суперконтроллер ввода/вывода \_ РКВАЛЛ** поддерживается в Windows 2000 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-471">**SIO\_RCVALL** is supported on Windows 2000 and later.</span></span>

### <a name="sio_rcvall_igmpmcast-opcode-setting-i-t3"></a><span data-ttu-id="9b454-472">SIO \_ рквалл \_ игмпмкаст (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-472">SIO\_RCVALL\_IGMPMCAST (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-473">Позволяет сокету получать весь IGMP-трафик многоадресной рассылки в сети без получения другого многоадресного IP-трафика.</span><span class="sxs-lookup"><span data-stu-id="9b454-473">Enables a socket to receive all IGMP multicast IP traffic on the network, without receiving other multicast IP traffic.</span></span> <span data-ttu-id="9b454-474">Маркер сокета, передаваемый функции [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) , должен иметь \_ семейство адресов AF INET, \_ тип необработанного сокета Сокк и \_ протокол IGMP иппрото.</span><span class="sxs-lookup"><span data-stu-id="9b454-474">The socket handle passed to the [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) function must be of AF\_INET address family, SOCK\_RAW socket type, and IPPROTO\_IGMP protocol.</span></span> <span data-ttu-id="9b454-475">Сокет также должен быть привязан к явному локальному интерфейсу, что означает, что невозможно выполнить привязку к любому АДРЕСу \_ .</span><span class="sxs-lookup"><span data-stu-id="9b454-475">The socket also must be bound to an explicit local interface, which means that you cannot bind to INADDR\_ANY.</span></span>

<span data-ttu-id="9b454-476">После привязки сокета и набора запросов IOCTL вызовы функций [**всарекв**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv) или [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) возвращают IP-Датаграммы многоадресной рассылки, передаваемые через данный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9b454-476">Once the socket is bound and the IOCTL set, calls to the [**WSARecv**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv) or [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) functions return multicast IP datagrams passing through the given interface.</span></span> <span data-ttu-id="9b454-477">Обратите внимание, что необходимо указать достаточно большой буфер.</span><span class="sxs-lookup"><span data-stu-id="9b454-477">Note that you must supply a sufficiently large buffer.</span></span> <span data-ttu-id="9b454-478">Для установки этого IOCTL требуются права администратора на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="9b454-478">Setting this IOCTL requires Administrator privilege on the local computer.</span></span>

<span data-ttu-id="9b454-479">**Суперконтроллер ввода/вывода \_ РКВАЛЛ \_ игмпмкаст** поддерживается в Windows 2000 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-479">**SIO\_RCVALL\_IGMPMCAST** is supported on Windows 2000 and later.</span></span>

### <a name="sio_rcvall_mcast-opcode-setting-i-t3"></a><span data-ttu-id="9b454-480">SIO \_ рквалл \_ мкаст (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-480">SIO\_RCVALL\_MCAST (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-481">Позволяет сокету принимать весь многоадресный IP-трафик в сети (т. е. все IP-пакеты, предназначенные для IP-адресов в диапазоне от 224.0.0.0 до 239.255.255.255).</span><span class="sxs-lookup"><span data-stu-id="9b454-481">Enables a socket to receive all multicast IP traffic on the network (that is, all IP packets destined for IP addresses in the range of 224.0.0.0 to 239.255.255.255).</span></span> <span data-ttu-id="9b454-482">Маркер сокета, передаваемый функции [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) , должен иметь \_ семейство адресов AF INET, \_ тип необработанного сокета Сокк и протокол иппрото \_ UDP.</span><span class="sxs-lookup"><span data-stu-id="9b454-482">The socket handle passed to the [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) function must be of AF\_INET address family, SOCK\_RAW socket type, and IPPROTO\_UDP protocol.</span></span> <span data-ttu-id="9b454-483">Сокет также должен быть привязан к явному локальному интерфейсу, что означает, что невозможно выполнить привязку к любому АДРЕСу \_ .</span><span class="sxs-lookup"><span data-stu-id="9b454-483">The socket also must bind to an explicit local interface, which means that you cannot bind to INADDR\_ANY.</span></span> <span data-ttu-id="9b454-484">Сокет должен быть привязан к порту нуль.</span><span class="sxs-lookup"><span data-stu-id="9b454-484">The socket should bind to port zero.</span></span>

<span data-ttu-id="9b454-485">После привязки сокета и набора запросов IOCTL вызовы функций [**всарекв**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv) или [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) возвращают IP-Датаграммы многоадресной рассылки, передаваемые через данный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9b454-485">Once the socket is bound and the IOCTL set, calls to the [**WSARecv**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv) or [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) functions return multicast IP datagrams passing through the given interface.</span></span> <span data-ttu-id="9b454-486">Обратите внимание, что необходимо указать достаточно большой буфер.</span><span class="sxs-lookup"><span data-stu-id="9b454-486">Note that you must supply a sufficiently large buffer.</span></span> <span data-ttu-id="9b454-487">Для установки этого IOCTL требуются права администратора на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="9b454-487">Setting this IOCTL requires Administrator privilege on the local computer.</span></span>

<span data-ttu-id="9b454-488">**Суперконтроллер ввода/вывода \_ РКВАЛЛ \_ мкаст** поддерживается в Windows 2000 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-488">**SIO\_RCVALL\_MCAST** is supported on Windows 2000 and later.</span></span>

### <a name="sio_release_port_reservation-opcode-setting-i-t3"></a><span data-ttu-id="9b454-489">\_ \_ Резервирование портов освобождения SIO \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-489">SIO\_RELEASE\_PORT\_RESERVATION (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-490">Освобождает резервирование среды выполнения для блока портов TCP или UDP.</span><span class="sxs-lookup"><span data-stu-id="9b454-490">Releases a runtime reservation for a block of TCP or UDP ports.</span></span> <span data-ttu-id="9b454-491">Резервируемое резервирование среды выполнения должно быть получено из процесса выдачи с помощью [**запроса ввода/вывода для \_ \_ \_ резервирования порта**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-491">The runtime reservation to be released must have been obtained from the issuing process using the [**SIO\_ACQUIRE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699720(v=vs.85)) IOCTL.</span></span>

<span data-ttu-id="9b454-492">Более подробные сведения см. в справочнике по [**\_ \_ \_ резервированию портов для освобождения SIO**](/previous-versions/windows/desktop/legacy/gg699722(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-492">For more detailed information, see the [**SIO\_RELEASE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699722(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-493">[**Суперконтроллер ввода/вывода \_ \_ \_ Резервирование портов выпуска**](/previous-versions/windows/desktop/legacy/gg699722(v=vs.85)) поддерживается в Windows Vista и более поздних версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9b454-493">[**SIO\_RELEASE\_PORT\_RESERVATION**](/previous-versions/windows/desktop/legacy/gg699722(v=vs.85)) is supported on Windows Vista and later versions of the operating system.</span></span>

### <a name="sio_routing_interface_change-opcode-setting-i-t1"></a><span data-ttu-id="9b454-494">\_ \_ Изменение интерфейса маршрутизации SIO \_ (параметр кода операции: I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-494">SIO\_ROUTING\_INTERFACE\_CHANGE (opcode setting: I, T==1)</span></span>

<span data-ttu-id="9b454-495">Получение уведомления об изменении интерфейса маршрутизации, которое следует использовать для обращения к удаленному адресу во входном буфере (указывается как структура [**SOCKADDR**](sockaddr-2.md) ).</span><span class="sxs-lookup"><span data-stu-id="9b454-495">To receive notification of a routing interface change that should be used to reach the remote address in the input buffer (specified as a [**sockaddr**](sockaddr-2.md) structure).</span></span> <span data-ttu-id="9b454-496">При завершении этого IOCTL не будут предоставлены выходные данные нового интерфейса маршрутизации. завершение просто означает, что интерфейс маршрутизации для данного назначения изменился и должен быть выполнен запрос через **\_ интерфейс маршрутизации SIO с \_ помощью \_ запроса** IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-496">No output information on the new routing interface will be provided upon completion of this IOCTL; the completion merely indicates that the routing interface for a given destination has changed and should be queried using the **SIO\_ROUTING\_INTERFACE\_QUERY** IOCTL.</span></span>

<span data-ttu-id="9b454-497">Предполагается, что, хотя это и не является обязательным, приложение использует перекрывающиеся операции ввода-вывода, чтобы получать уведомления об изменении интерфейса маршрутизации по завершении запроса на **\_ \_ \_ изменение интерфейса маршрутизации SIO** .</span><span class="sxs-lookup"><span data-stu-id="9b454-497">It is assumed, although not required, that the application uses overlapped I/O to be notified of the routing interface change through completion of **SIO\_ROUTING\_INTERFACE\_CHANGE** request.</span></span> <span data-ttu-id="9b454-498">Кроме того, если **\_ интерфейс маршрутизации \_ SIO \_ изменился** на неблокирующем сокете с параметрами *лповерлаппед* и *лпкомплетионраутине* , для которых установлено **значение NULL**), он будет немедленно возвращать и [всаеваулдблокк](windows-sockets-error-codes-2.md) в качестве ошибки, а приложение может ожидать события изменения маршрутизации с помощью вызова [**всаевентселект**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) или [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) с \_ \_ \_ установленным битом изменения интерфейса маршрутизации в битовой маске сетевого события.</span><span class="sxs-lookup"><span data-stu-id="9b454-498">Alternatively, if the **SIO\_ROUTING\_INTERFACE\_CHANGE** IOCTL is issued on a non-blocking socket with the *lpOverlapped* and *lpCompletionRoutine* parameters set to **NULL**), it will complete immediately returning and [WSAEWOULDBLOCK](windows-sockets-error-codes-2.md) as an error, and the application can then wait for routing change events through call to [**WSAEventSelect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) or [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) with FD\_ROUTING\_INTERFACE\_CHANGE bit set in the network event bitmask.</span></span>

<span data-ttu-id="9b454-499">Он знает, что сведения о маршрутизации в большинстве случаев остаются стабильными, поэтому, чтобы приложение сознало несколько необработанных запросов IOCTL, чтобы получать уведомления о всех назначениях, которые он интересует, а также о том, что поставщик услуг должен отслеживать эти запросы, будет использовать значительный объем системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="9b454-499">It is recognized that routing information remains stable in most cases so that requiring the application to keep multiple outstanding IOCTLs to get notifications about all destinations that it is interested in as well as having the service provider keep track of these notification requests will use a significant amount system resources.</span></span> <span data-ttu-id="9b454-500">Эту ситуацию можно избежать, расширив смысл входных параметров и добавив требования поставщика услуг следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9b454-500">This situation can be avoided by extending the meaning of the input parameters and relaxing the service provider requirements as follows:</span></span>

-   <span data-ttu-id="9b454-501">Приложение может указать адрес шаблона для конкретного семейства протоколов (аналогично тому, который используется при вызове [**BIND**](/windows/desktop/api/winsock/nf-winsock-bind) при запросе на привязку к любому доступному адресу) для запроса уведомлений об изменениях маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="9b454-501">The application can specify a protocol family specific wildcard address (same as one used in [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) call when requesting to bind to any available address) to request notifications of any routing changes.</span></span> <span data-ttu-id="9b454-502">Это позволяет приложению удерживать только одно необработанное **\_ \_ \_ изменение интерфейса маршрутизации SIO** для всех используемых сокетов и назначений, а затем использовать **\_ \_ \_ запрос интерфейса маршрутизации SIO** для получения фактических сведений о маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="9b454-502">This allows the application to keep only one outstanding **SIO\_ROUTING\_INTERFACE\_CHANGE** for all the sockets and destinations it has and then use **SIO\_ROUTING\_INTERFACE\_QUERY** to get the actual routing information.</span></span>
-   <span data-ttu-id="9b454-503">Поставщик услуг может игнорировать сведения, заданные приложением во входном буфере **\_ \_ интерфейса \_ маршрутизации SIO** (как если бы приложение указало адрес с подстановочным знаком), и завершить **\_ интерфейс маршрутизации SIO \_ \_ изменить** запрос IOCTL или \_ \_ событие изменения интерфейса маршрутизации для передачи сигнала \_ в случае любого изменения информации маршрутизации (а не только маршрута к назначению, указанному во входном буфере).</span><span class="sxs-lookup"><span data-stu-id="9b454-503">A service provider has the option to ignore the information specified by the application in the input buffer of the **SIO\_ROUTING\_INTERFACE\_CHANGE** (as though the application specified a wildcard address) and complete the **SIO\_ROUTING\_INTERFACE\_CHANGE** IOCTL or signal FD\_ROUTING\_INTERFACE\_CHANGE event in the event of any routing information change (not just the route to the destination specified in the input buffer).</span></span>

### <a name="sio_routing_interface_query-opcode-setting-i-o-t1"></a><span data-ttu-id="9b454-504">\_ \_ Запрос интерфейса маршрутизации SIO \_ (параметр кода операции: I, O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-504">SIO\_ROUTING\_INTERFACE\_QUERY (opcode setting: I, O, T==1)</span></span>

<span data-ttu-id="9b454-505">Для получения адреса локального интерфейса (представленного в виде структуры [**SOCKADDR**](sockaddr-2.md) ), который должен использоваться для отправки на удаленный адрес, указанный во входном буфере (как **SOCKADDR**).</span><span class="sxs-lookup"><span data-stu-id="9b454-505">To obtain the address of the local interface (represented as [**sockaddr**](sockaddr-2.md) structure) which should be used to send to the remote address specified in the input buffer (as **sockaddr**).</span></span> <span data-ttu-id="9b454-506">Удаленные адреса многоадресной рассылки можно отправить во входной буфер, чтобы получить адрес предпочтительного интерфейса для многоадресной передачи.</span><span class="sxs-lookup"><span data-stu-id="9b454-506">Remote multicast addresses may be submitted in the input buffer to get the address of the preferred interface for multicast transmission.</span></span> <span data-ttu-id="9b454-507">В любом случае возвращаемый адрес интерфейса может использоваться приложением в последующем запросе BIND ().</span><span class="sxs-lookup"><span data-stu-id="9b454-507">In any case, the interface address returned may be used by the application in a subsequent bind() request.</span></span>

<span data-ttu-id="9b454-508">Обратите внимание, что маршруты могут быть изменены.</span><span class="sxs-lookup"><span data-stu-id="9b454-508">Note that routes are subject to change.</span></span> <span data-ttu-id="9b454-509">Поэтому приложения не могут полагаться на сведения, возвращаемые **\_ \_ \_ запросом интерфейса маршрутизации SIO** , как постоянные.</span><span class="sxs-lookup"><span data-stu-id="9b454-509">Therefore, applications cannot rely on the information returned by **SIO\_ROUTING\_INTERFACE\_QUERY** to be persistent.</span></span> <span data-ttu-id="9b454-510">Приложения могут регистрироваться для уведомлений об изменениях маршрутизации **через \_ интерфейс маршрутизации SIO \_ \_ изменение** ioctl, который обеспечивает уведомление через перекрывающиеся операции ввода-вывода или \_ \_ \_ события изменения интерфейса маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="9b454-510">Applications may register for routing change notifications through the **SIO\_ROUTING\_INTERFACE\_CHANGE** IOCTL which provides for notification through either overlapped I/O or a FD\_ROUTING\_INTERFACE\_CHANGE event.</span></span> <span data-ttu-id="9b454-511">Чтобы гарантировать, что приложение всегда имеет текущие сведения о интерфейсе маршрутизации для данного назначения, можно использовать следующую последовательность действий.</span><span class="sxs-lookup"><span data-stu-id="9b454-511">The following sequence of actions can be used to guarantee that the application always has current routing interface information for a given destination:</span></span>

-   <span data-ttu-id="9b454-512">Выдача **\_ интерфейса маршрутизации SIO \_ \_ изменение** ioctl</span><span class="sxs-lookup"><span data-stu-id="9b454-512">Issue **SIO\_ROUTING\_INTERFACE\_CHANGE** IOCTL</span></span>
-   <span data-ttu-id="9b454-513">Выдача **\_ \_ \_ запроса интерфейса маршрутизации SIO** ioctl</span><span class="sxs-lookup"><span data-stu-id="9b454-513">Issue **SIO\_ROUTING\_INTERFACE\_QUERY** IOCTL</span></span>
-   <span data-ttu-id="9b454-514">Всякий раз, когда **\_ \_ интерфейс маршрутизации \_ суперконтроллера** ввода/вывода уведомляет приложение об изменении маршрутизации (с помощью перекрывающегося элемента I/O или посредством сигнализации \_ \_ \_ события изменения интерфейса маршрутизации), должна повторяться вся последовательность действий.</span><span class="sxs-lookup"><span data-stu-id="9b454-514">Whenever **SIO\_ROUTING\_INTERFACE\_CHANGE** IOCTL notifies the application of routing change (either through overlapped I/O or by signaling FD\_ROUTING\_INTERFACE\_CHANGE event), the whole sequence of actions should be repeated.</span></span>

<span data-ttu-id="9b454-515">Если выходной буфер недостаточно велик для размещения адреса интерфейса, то в \_ результате выполнения этого ioctl возвращается ошибка сокета, а [**Всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаефаулт](windows-sockets-error-codes-2.md).</span><span class="sxs-lookup"><span data-stu-id="9b454-515">If the output buffer is not large enough to contain the interface address, SOCKET\_ERROR is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAEFAULT](windows-sockets-error-codes-2.md).</span></span> <span data-ttu-id="9b454-516">В этом случае в *лпкббитесретурнед* будет возвращен требуемый размер выходного буфера.</span><span class="sxs-lookup"><span data-stu-id="9b454-516">The required size of the output buffer will be returned in *lpcbBytesReturned* in this case.</span></span> <span data-ttu-id="9b454-517">Обратите внимание, что код ошибки ВСАЕФАУЛТ также возвращается в том случае, если параметр *лпвинбуффер*, *лпваутбуффер* или *лпкббитесретурнед* полностью не содержится в допустимой части адресного пространства пользователя.</span><span class="sxs-lookup"><span data-stu-id="9b454-517">Note the WSAEFAULT error code is also returned if the *lpvInBuffer*, *lpvOutBuffer*, or *lpcbBytesReturned* parameter is not totally contained in a valid part of the user address space.</span></span>

<span data-ttu-id="9b454-518">Если адрес назначения, указанный во входном буфере, недоступен через какой-либо из доступных интерфейсов, то в \_ результате выполнения этого ioctl возвращается ошибка сокета, а [**Всажетластеррор**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) возвращает [всаенетунреач](windows-sockets-error-codes-2.md) или даже [всаенетдовн](windows-sockets-error-codes-2.md) , если все сетевые подключения потеряны.</span><span class="sxs-lookup"><span data-stu-id="9b454-518">If the destination address specified in the input buffer cannot be reached through any of the available interfaces, SOCKET\_ERROR is returned as the result of this IOCTL and [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) returns [WSAENETUNREACH](windows-sockets-error-codes-2.md) or even [WSAENETDOWN](windows-sockets-error-codes-2.md) if all of the network connectivity is lost.</span></span>

### <a name="sio_set_compatibility_mode-opcode-setting-i-t3"></a><span data-ttu-id="9b454-519">\_ \_ Режим СОВМЕСТИМОСТИ набора SIO \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-519">SIO\_SET\_COMPATIBILITY\_MODE (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-520">Запрашивает, как сетевой стек должен обрабатывать определенные поведения, для которых по умолчанию обработка поведения может отличаться в разных версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="9b454-520">Requests how the networking stack should handle certain behaviors for which the default way of handling the behavior may differ across Windows versions.</span></span> <span data-ttu-id="9b454-521">Структура аргумента для **\_ \_ \_ режима совместимости набора SIO** указывается в структуре **\_ \_ режима совместимости WSA** , определенной в файле заголовка *мсвсоккдеф. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-521">The argument structure for **SIO\_SET\_COMPATIBILITY\_MODE** is specified in the **WSA\_COMPATIBILITY\_MODE** structure defined in the *Mswsockdef.h* header file.</span></span> <span data-ttu-id="9b454-522">Эта структура определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9b454-522">This structure is defined as follows:</span></span>

```cpp
/* Argument structure for SIO_SET_COMPATIBILITY_MODE */
typedef struct _WSA_COMPATIBILITY_MODE {
    WSA_COMPATIBILITY_BEHAVIOR_ID BehaviorId;
    ULONG TargetOsVersion;
} WSA_COMPATIBILITY_MODE, *PWSA_COMPATIBILITY_MODE;
```

<span data-ttu-id="9b454-523">Значение, указанное в элементе **бехавиорид** , указывает на запрошенное поведение.</span><span class="sxs-lookup"><span data-stu-id="9b454-523">The value specified in the **BehaviorId** member indicates the behavior requested.</span></span> <span data-ttu-id="9b454-524">Значение, указанное в элементе **TargetOsVersion** , указывает версию Windows, запрашиваемую для поведения.</span><span class="sxs-lookup"><span data-stu-id="9b454-524">The value specified in the **TargetOsVersion** member indicates the Windows version that is being requested for the behavior.</span></span>

<span data-ttu-id="9b454-525">Элемент **бехавиорид** может быть одним из значений типа перечисления " **\_ \_ \_ идентификатор действия совместимости WSA** ", определенного в файле заголовка *мсвсоккдеф. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-525">The **BehaviorId** member can be one of the values from the **WSA\_COMPATIBILITY\_BEHAVIOR\_ID** enumeration type defined in the *Mswsockdef.h* header file.</span></span> <span data-ttu-id="9b454-526">Возможные значения для элемента **бехавиорид** :</span><span class="sxs-lookup"><span data-stu-id="9b454-526">The possible values for the **BehaviorId** member are as follows.</span></span>

| <span data-ttu-id="9b454-527">Термин</span><span class="sxs-lookup"><span data-stu-id="9b454-527">Term</span></span>                                                                                                                                                                             | <span data-ttu-id="9b454-528">Описание</span><span class="sxs-lookup"><span data-stu-id="9b454-528">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-|-|
| <span data-ttu-id="9b454-529"><span id="WsaBehaviorAll"></span><span id="wsabehaviorall"></span><span id="WSABEHAVIORALL"></span>всабехавиоралл</span><span class="sxs-lookup"><span data-stu-id="9b454-529"><span id="WsaBehaviorAll"></span><span id="wsabehaviorall"></span><span id="WSABEHAVIORALL"></span>WsaBehaviorAll</span></span><br/>                                                     | <span data-ttu-id="9b454-530">Это эквивалентно запросу всех возможных совместимых вариантов поведения, определенных для **\_ \_ \_ идентификатора режима совместимости WSA**.</span><span class="sxs-lookup"><span data-stu-id="9b454-530">This is equivalent to requesting all of the possible compatible behaviors defined for **WSA\_COMPATIBILITY\_BEHAVIOR\_ID**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="9b454-531"><span id="WsaBehaviorReceiveBuffering"></span><span id="wsabehaviorreceivebuffering"></span><span id="WSABEHAVIORRECEIVEBUFFERING"></span>всабехавиоррецеивебуфферинг</span><span class="sxs-lookup"><span data-stu-id="9b454-531"><span id="WsaBehaviorReceiveBuffering"></span><span id="wsabehaviorreceivebuffering"></span><span id="WSABEHAVIORRECEIVEBUFFERING"></span>WsaBehaviorReceiveBuffering</span></span><br/> | <span data-ttu-id="9b454-532">Если для элемента **TargetOsVersion** задано значение Windows Vista или более поздней версии, уменьшение размера буфера приема TCP на этом сокете с помощью параметра **so \_ рквбуф** может быть даже после установления TCP-подключения.</span><span class="sxs-lookup"><span data-stu-id="9b454-532">When the **TargetOsVersion** member is set to a value for Windows Vista or later, reductions to the TCP receive buffer size on this socket using the **SO\_RCVBUF** socket option are allowed even after a TCP connection has been establishment.</span></span> <br/> <span data-ttu-id="9b454-533">Если для элемента **TargetOsVersion** задано значение, предшествующее Windows Vista, уменьшение размера буфера приема TCP на этом сокете с помощью параметра **so \_ рквбуф** не допускается после установки соединения.</span><span class="sxs-lookup"><span data-stu-id="9b454-533">When the **TargetOsVersion** member is set to a value earlier than Windows Vista, reductions to the TCP receive buffer size on this socket using the **SO\_RCVBUF** socket option are not allowed after connection establishment.</span></span> <br/>                                                                                                                                                                                  |
| <span data-ttu-id="9b454-534"><span id="WsaBehaviorAutoTuning"></span><span id="wsabehaviorautotuning"></span><span id="WSABEHAVIORAUTOTUNING"></span>всабехавиораутотунинг</span><span class="sxs-lookup"><span data-stu-id="9b454-534"><span id="WsaBehaviorAutoTuning"></span><span id="wsabehaviorautotuning"></span><span id="WSABEHAVIORAUTOTUNING"></span>WsaBehaviorAutoTuning</span></span><br/>                         | <span data-ttu-id="9b454-535">Если для элемента **TargetOsVersion** задано значение Windows Vista или более поздней версии, автоматическая настройка окна приема включена, а коэффициент МАСШТАБИРОВАНИЯ окна TCP уменьшается до 2 из значения по умолчанию 8.</span><span class="sxs-lookup"><span data-stu-id="9b454-535">When the **TargetOsVersion** member is set to a value for Windows Vista or later, receive window auto-tuning is enabled and the TCP window scale factor is reduced to 2 from the default value of 8.</span></span><br/> <span data-ttu-id="9b454-536">Если для **TargetOsVersion** задано значение, предшествующее Windows Vista, автоматическая настройка окна приема отключена.</span><span class="sxs-lookup"><span data-stu-id="9b454-536">When the **TargetOsVersion** is set to a value earlier than Windows Vista, receive window auto-tuning is disabled.</span></span> <span data-ttu-id="9b454-537">Параметр масштабирования окна TCP также отключается, и максимальный размер окна приема ограничен 65 535 байт.</span><span class="sxs-lookup"><span data-stu-id="9b454-537">The TCP window scaling option is also disabled and the maximum true receive window size is limited to 65,535 bytes.</span></span> <span data-ttu-id="9b454-538">Параметр масштабирования окна TCP не может быть согласован в соединении, даже если для этого сокета был вызван параметр **so \_ рквбуф** , указывающий значение более 65 535 байт до установки соединения.</span><span class="sxs-lookup"><span data-stu-id="9b454-538">The TCP window scaling option can't be negotiated on the connection even if the **SO\_RCVBUF** socket option was called on this socket specifying a value greater than 65,535 bytes before the connection was established.</span></span><br/> |



 

<span data-ttu-id="9b454-539">Более подробные сведения см. в справочнике по [**\_ \_ \_ режиму совместимости с набором SIO**](/previous-versions/windows/desktop/legacy/cc136103(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-539">For more detailed information, see the [**SIO\_SET\_COMPATIBILITY\_MODE**](/previous-versions/windows/desktop/legacy/cc136103(v=vs.85)) reference.</span></span>

<span data-ttu-id="9b454-540">**Суперконтроллер ввода/вывода \_ Установка \_ \_ режима совместимости** поддерживается в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-540">**SIO\_SET\_COMPATIBILITY\_MODE** is supported on Windows Vista and later.</span></span>

### <a name="sio_set_group_qos-opcode-setting-i-t1"></a><span data-ttu-id="9b454-541">\_Установка \_ \_ качества обслуживания sio (параметр кода операции: I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-541">SIO\_SET\_GROUP\_QOS (opcode setting: I, T==1)</span></span>

<span data-ttu-id="9b454-542">Зарезервировано.</span><span class="sxs-lookup"><span data-stu-id="9b454-542">Reserved.</span></span>

### <a name="sio_set_priority_hint-opcode-setting-i-t3"></a><span data-ttu-id="9b454-543">SIO_SET_PRIORITY_HINT (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-543">SIO_SET_PRIORITY_HINT (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-544">Предоставляет подсказку для основного транспортного протокола, чтобы обрабатывать трафик на этом сокете с указанным приоритетом.</span><span class="sxs-lookup"><span data-stu-id="9b454-544">Provides a hint to the underlying transport protocol to treat the traffic on this socket with a specific priority.</span></span> <span data-ttu-id="9b454-545">*Лпвинбуффер* должен указывать на переменную типа **PRIORITY_HINT** с *кбинбуффер* , для которого задано значение sizeof (PRIORITY_HINT).</span><span class="sxs-lookup"><span data-stu-id="9b454-545">The *lpvInBuffer* must point to a variable of type **PRIORITY_HINT** with *cbInBuffer* set to sizeof(PRIORITY_HINT).</span></span> <span data-ttu-id="9b454-546">Параметры *лпваутбуффер* и *Кбаутбуффер* должны иметь **значение NULL** и 0 соответственно.</span><span class="sxs-lookup"><span data-stu-id="9b454-546">The *lpvOutBuffer* and *cbOutBuffer* parameters must be **NULL** and 0, respectively.</span></span> <span data-ttu-id="9b454-547">Реализация Microsoft Windows TCP поддерживает этот запрос IOCTL начиная с Windows 10, версия 1809 (10,0; Сборка 17763) и более поздних версий следующим образом: Если для запрошенного значения приоритета задано значение **иоприоритихинтверилов**, TCP использует модифицированную версию алгоритма LEDBAT (определенную в RFC 6817) для управления скоростью исходящего трафика на сокете.</span><span class="sxs-lookup"><span data-stu-id="9b454-547">The Microsoft Windows TCP implementation supports this IOCTL starting with Windows 10, version 1809 (10.0; Build 17763) and later as follows: when the requested priority value is set to **IoPriorityHintVeryLow**, TCP uses a modified version of the LEDBAT algorithm (defined in RFC 6817) for controlling the outbound traffic rate on the socket.</span></span> <span data-ttu-id="9b454-548">Этот IOCTL не влияет на входящий трафик.</span><span class="sxs-lookup"><span data-stu-id="9b454-548">The inbound traffic is not affected by this IOCTL.</span></span> <span data-ttu-id="9b454-549">LEDBAT — это алгоритм очистки, и его цель — сократить задержку и предотвратить неблагоприятное воздействие на трафик с нормальным приоритетом, изменяя способ передачи трафика с нормальным приоритетом.</span><span class="sxs-lookup"><span data-stu-id="9b454-549">LEDBAT is a scavenger algorithm, and its goal is to keep latency low and prevent any adverse effect on normal-priority traffic by getting out of the way when normal-priority traffic is present.</span></span>

<span data-ttu-id="9b454-550">См. также [RFC 6817](https://tools.ietf.org/html/rfc6817).</span><span class="sxs-lookup"><span data-stu-id="9b454-550">Also see [RFC 6817](https://tools.ietf.org/html/rfc6817).</span></span>

<span data-ttu-id="9b454-551">**SIO_SET_PRIORITY_HINT** поддерживается в Windows 10, версия 1809 (10,0; Сборка 17763) и более поздние версии.</span><span class="sxs-lookup"><span data-stu-id="9b454-551">**SIO_SET_PRIORITY_HINT** is supported on Windows 10, version 1809 (10.0; Build 17763) and later.</span></span>

### <a name="sio_set_qos-opcode-setting-i-t1"></a><span data-ttu-id="9b454-552">\_Установка \_ качества обслуживания sio (параметр кода операции: I, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-552">SIO\_SET\_QOS (opcode setting: I, T==1)</span></span>

<span data-ttu-id="9b454-553">Свяжите указанную структуру [**QoS**](/windows/win32/api/winsock2/ns-winsock2-qos) с сокетом.</span><span class="sxs-lookup"><span data-stu-id="9b454-553">Associate the specified [**QOS**](/windows/win32/api/winsock2/ns-winsock2-qos) structure with the socket.</span></span> <span data-ttu-id="9b454-554">Выходной буфер не требуется, структура **качества обслуживания** будет получена из входного буфера.</span><span class="sxs-lookup"><span data-stu-id="9b454-554">No output buffer is required, the **QOS** structure will be obtained from the input buffer.</span></span> <span data-ttu-id="9b454-555">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают качество обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9b454-555">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support quality of service.</span></span>

### <a name="sio_tcp_initial_rto-opcode-setting-i-t3"></a><span data-ttu-id="9b454-556">SIO_TCP_INITIAL_RTO (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-556">SIO_TCP_INITIAL_RTO (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-557">Управляет начальными характеристиками повторной передачи (SYN/SYN + ACK) TCP-сокета, настраивая начальные параметры времени ожидания повторной передачи (RTO).</span><span class="sxs-lookup"><span data-stu-id="9b454-557">Controls the initial (SYN / SYN+ACK) retransmission characteristics of a TCP socket by configuring initial retransmission timeout (RTO) parameters.</span></span> <span data-ttu-id="9b454-558">Параметры конфигурации указываются в структуре [**параметров TCP \_ начального \_ \_ параметра RTO**](/windows/desktop/api/mswsock/ns-mswsock-transmit_file_buffers) .</span><span class="sxs-lookup"><span data-stu-id="9b454-558">The configuration parameters are specified in a [**TCP\_INITIAL\_RTO\_PARAMETERS**](/windows/desktop/api/mswsock/ns-mswsock-transmit_file_buffers) structure.</span></span>

<span data-ttu-id="9b454-559">Более подробные сведения см. в справочнике по [**SIO_TCP_INITIAL_RTO**](./sio-tcp-initial-rto.md) .</span><span class="sxs-lookup"><span data-stu-id="9b454-559">For more detailed information, see the [**SIO_TCP_INITIAL_RTO**](./sio-tcp-initial-rto.md) reference.</span></span> <span data-ttu-id="9b454-560">[**SIO_TCP_INITIAL_RTO**](./sio-tcp-initial-rto.md) поддерживается в Windows 8, windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-560">[**SIO_TCP_INITIAL_RTO**](./sio-tcp-initial-rto.md) is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_translate_handle-opcode-setting-i-o-t1"></a><span data-ttu-id="9b454-561">\_Маркер перевода SIO \_ (параметр кода операции: I, O, T = = 1)</span><span class="sxs-lookup"><span data-stu-id="9b454-561">SIO\_TRANSLATE\_HANDLE (opcode setting: I, O, T==1)</span></span>

<span data-ttu-id="9b454-562">Чтобы получить соответствующий маркер *для сокетов* , допустимый в контексте сопутствующего интерфейса (например, \_ нетдев и th \_ TAPI).</span><span class="sxs-lookup"><span data-stu-id="9b454-562">To obtain a corresponding handle for socket *s* that is valid in the context of a companion interface (for example, TH\_NETDEV and TH\_TAPI).</span></span> <span data-ttu-id="9b454-563">Константа манифеста, определяющая сопутствующий интерфейс вместе с любыми другими необходимыми параметрами, задается во входном буфере.</span><span class="sxs-lookup"><span data-stu-id="9b454-563">A manifest constant identifying the companion interface along with any other needed parameters are specified in the input buffer.</span></span> <span data-ttu-id="9b454-564">После завершения этой функции соответствующий обработчик будет доступен в выходном буфере.</span><span class="sxs-lookup"><span data-stu-id="9b454-564">The corresponding handle will be available in the output buffer upon completion of this function.</span></span> <span data-ttu-id="9b454-565">Дополнительные сведения о конкретном сопутствующем интерфейсе см. в соответствующем разделе в [приложении Winsock](winsock-annexes.md) .</span><span class="sxs-lookup"><span data-stu-id="9b454-565">Refer to the appropriate section in [Winsock Annexes](winsock-annexes.md) for details specific to a particular companion interface.</span></span> <span data-ttu-id="9b454-566">Код ошибки [всаенопротупт](windows-sockets-error-codes-2.md) указывается для поставщиков услуг, которые не поддерживают этот запрос IOCTL для указанного сопутствующего интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9b454-566">The [WSAENOPROTOOPT](windows-sockets-error-codes-2.md) error code is indicated for service providers that do not support this IOCTL for the specified companion interface.</span></span> <span data-ttu-id="9b454-567">Этот запрос IOCTL получает маркер, связанный с использованием **\_ \_ маркера преобразования SIO**.</span><span class="sxs-lookup"><span data-stu-id="9b454-567">This IOCTL retrieves the handle associated using **SIO\_TRANSLATE\_HANDLE**.</span></span>

<span data-ttu-id="9b454-568">Для обнаружения и мониторинга других интерфейсов, которые могут поддерживаться сокетом, рекомендуется использовать модель COM вместо этого IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-568">It is recommend that the Component Object Model (COM) be used instead of this IOCTL to discover and track other interfaces that might be supported by a socket.</span></span> <span data-ttu-id="9b454-569">Этот запрос IOCTL используется для обеспечения обратной совместимости с системами, в которых COM недоступен или не может использоваться по какой-либо другой причине.</span><span class="sxs-lookup"><span data-stu-id="9b454-569">This IOCTL is present for backward compatibility with systems where COM is not available or cannot be used for some other reason.</span></span>

### <a name="sio_udp_connreset-opcode-setting-i-t3"></a><span data-ttu-id="9b454-570">SIO \_ UDP \_ коннресет (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-570">SIO\_UDP\_CONNRESET (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-571">**Windows XP:** Определяет \_ , передаются ли сообщения о НЕдостижимых UDP-портах.</span><span class="sxs-lookup"><span data-stu-id="9b454-571">**Windows XP:** Controls whether UDP PORT\_UNREACHABLE messages are reported.</span></span> <span data-ttu-id="9b454-572">Задайте значение **true** , чтобы включить создание отчетов.</span><span class="sxs-lookup"><span data-stu-id="9b454-572">Set to **TRUE** to enable reporting.</span></span> <span data-ttu-id="9b454-573">Задайте значение **false** , чтобы отключить отчеты.</span><span class="sxs-lookup"><span data-stu-id="9b454-573">Set to **FALSE** to disable reporting.</span></span>

### <a name="sio_set_wfp_connection_redirect_records-opcode-setting-i-t3"></a><span data-ttu-id="9b454-574">SIO \_ Установка \_ \_ \_ записей перенаправления соединения WFP \_ (параметр кода операции: I, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-574">SIO\_SET\_WFP\_CONNECTION\_REDIRECT\_RECORDS (opcode setting: I, T==3)</span></span>

<span data-ttu-id="9b454-575">Задает для записи перенаправления новый сокет TCP, используемый для подключения к конечному месту назначения для использования службой перенаправления платформы фильтрации Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="9b454-575">Sets the redirect record to the new TCP socket used for connecting to the final destination for use by a Windows Filtering Platform (WFP) redirect service.</span></span>

<span data-ttu-id="9b454-576">[**\_ \_ \_ \_ \_ Записи перенаправления подключения суперконтроллера**](/previous-versions/windows/desktop/legacy/hh859714(v=vs.85)) ввода-вывода по протоколу ioctl используются в рамках отслеживания подключений через посредника при перенаправленных соединениях сокетов.</span><span class="sxs-lookup"><span data-stu-id="9b454-576">The [**SIO\_SET\_WFP\_CONNECTION\_REDIRECT\_RECORDS**](/previous-versions/windows/desktop/legacy/hh859714(v=vs.85)) IOCTL is used as part of proxied connection tracking on redirected socket connections.</span></span> <span data-ttu-id="9b454-577">Эта функция WFP упрощает отслеживание записей перенаправления из первоначального перенаправления соединения к конечному подключению.</span><span class="sxs-lookup"><span data-stu-id="9b454-577">This WFP feature facilitates tracking of redirection records from the initial redirect of a connection to the final connection to the destination.</span></span>

<span data-ttu-id="9b454-578">Более подробные сведения см. в справочнике по [**\_ \_ \_ \_ \_ записям перенаправления подключения для набора SIO**](/previous-versions/windows/desktop/legacy/hh859714(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="9b454-578">For more detailed information, see the [**SIO\_SET\_WFP\_CONNECTION\_REDIRECT\_RECORDS**](/previous-versions/windows/desktop/legacy/hh859714(v=vs.85)) reference.</span></span> <span data-ttu-id="9b454-579">**Суперконтроллер ввода/вывода \_ Настройка \_ \_ \_ \_ записей перенаправления подключения WFP** поддерживается в windows 8, Windows Server 2012 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-579">**SIO\_SET\_WFP\_CONNECTION\_REDIRECT\_RECORDS** is supported on Windows 8, Windows Server 2012, and later.</span></span>

### <a name="sio_tcp_info-opcode-setting-i-o-t3"></a><span data-ttu-id="9b454-580">\_Сведения TCP SIO \_ (параметр кода операции: I, O, T = = 3)</span><span class="sxs-lookup"><span data-stu-id="9b454-580">SIO\_TCP\_INFO (opcode setting: I, O, T==3)</span></span>

<span data-ttu-id="9b454-581">Возвращает статистику TCP для сокета.</span><span class="sxs-lookup"><span data-stu-id="9b454-581">Retrieves the TCP statistics for a socket.</span></span> <span data-ttu-id="9b454-582">Статистика TCP предоставляется в структуре [**TCP \_ info \_ v0**](/windows/desktop/api/Mstcpip/ns-mstcpip-tcp_info_v0) .</span><span class="sxs-lookup"><span data-stu-id="9b454-582">The TCP statistics are provided in a [**TCP\_INFO\_v0**](/windows/desktop/api/Mstcpip/ns-mstcpip-tcp_info_v0) structure.</span></span>

<span data-ttu-id="9b454-583">В отличие от получения статистики TCP с помощью функции [**жетперткпконнектионестатс**](/windows/win32/api/iphlpapi/nf-iphlpapi-getpertcpconnectionestats) , получение статистики TCP с помощью этого управляющего кода не требует от пользовательского кода загрузки, хранения и фильтрации таблицы соединений TCP, а также не требует повышенных привилегий для использования.</span><span class="sxs-lookup"><span data-stu-id="9b454-583">Unlike retrieving TCP statistics with the [**GetPerTcpConnectionEStats**](/windows/win32/api/iphlpapi/nf-iphlpapi-getpertcpconnectionestats) function, retrieving TCP statistics with this control code does not require the user code to load, store, and filter the TCP connection table, and does not require elevated privileges to use.</span></span>

<span data-ttu-id="9b454-584">Дополнительные сведения см. в [**статье \_ \_ о SIO TCP**](/previous-versions/windows/desktop/legacy/mt823415(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="9b454-584">For more information, see [**SIO\_TCP\_INFO**](/previous-versions/windows/desktop/legacy/mt823415(v=vs.85)).</span></span> <span data-ttu-id="9b454-585">**Суперконтроллер ввода/вывода \_ \_Сведения TCP** поддерживаются в Windows 10, версии 1703, windows Server 2016 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="9b454-585">**SIO\_TCP\_INFO** is supported on Windows 10, version 1703, Windows Server 2016, and later.</span></span>

## <a name="remarks"></a><span data-ttu-id="9b454-586">Комментарии</span><span class="sxs-lookup"><span data-stu-id="9b454-586">Remarks</span></span>

<span data-ttu-id="9b454-587">Winsock ioctl определяются в нескольких файлах заголовков.</span><span class="sxs-lookup"><span data-stu-id="9b454-587">Winsock Ioctls are defined in a number of different header files.</span></span> <span data-ttu-id="9b454-588">В их число входят файлы заголовков *Winsock2. h*, *мсвсокк. h* и *мсткпип. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-588">These include the *Winsock2.h*, *Mswsock.h*, and *Mstcpip.h* header file.</span></span>

<span data-ttu-id="9b454-589">В пакете средств разработки программного обеспечения Microsoft Windows (SDK), выпущенном для Windows Vista и более поздних версий, была изменена организация файлов заголовков, и в файлах заголовков *Ws2def. h*, *Ws2ipdef. h* и *мсвсоккдеф. h* также определены ряд Winsock-IOCTL.</span><span class="sxs-lookup"><span data-stu-id="9b454-589">On the Microsoft Windows Software Development Kit (SDK) released for Windows Vista and later, the organization of header files has changed and a number of Winsock Ioctls are also defined in the *Ws2def.h*, *Ws2ipdef.h*, and *Mswsockdef.h* header files.</span></span> <span data-ttu-id="9b454-590">Файл заголовка *Ws2def. h* автоматически включается в заголовочный файл *Winsock2. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-590">The *Ws2def.h* header file is automatically included by the *Winsock2.h* header file.</span></span> <span data-ttu-id="9b454-591">Файл заголовка *Ws2ipdef. h* автоматически включается в заголовочный файл *Ws2tcpip. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-591">The *Ws2ipdef.h* header file is automatically included by the *Ws2tcpip.h* header file.</span></span> <span data-ttu-id="9b454-592">Файл заголовка *мсвсоккдеф. h* автоматически включается в заголовочный файл *мсвсоккдеф. h* .</span><span class="sxs-lookup"><span data-stu-id="9b454-592">The *Mswsockdef.h* header file is automatically included in the *Mswsockdef.h* header file.</span></span>

## <a name="requirements"></a><span data-ttu-id="9b454-593">Требования</span><span class="sxs-lookup"><span data-stu-id="9b454-593">Requirements</span></span>

|||
|-|-|
| <span data-ttu-id="9b454-594">Header</span><span class="sxs-lookup"><span data-stu-id="9b454-594">Header</span></span><br/> | <dl> <span data-ttu-id="9b454-595"><dt>Winsock2. h; </dt> <dt>Мсткпип. h; </dt> <dt>Мсвсокк. h; </dt> <dt>Мсвсоккдеф. h в Windows Vista, Windows Server 2008 и Windows 7 (включая мсвсокк. h); </dt> <dt>Ws2def. h в Windows Vista, Windows Server 2008 и Windows 7 (включая Winsock2. h); </dt> <dt>Ws2ipdef. h в Windows Vista, Windows Server 2008 и Windows 7 (включая Ws2tcpip. h)</dt></span><span class="sxs-lookup"><span data-stu-id="9b454-595"><dt>Winsock2.h; </dt> <dt>Mstcpip.h; </dt> <dt>Mswsock.h; </dt> <dt>Mswsockdef.h on Windows Vista, Windows Server 2008 and Windows 7 (include Mswsock.h); </dt> <dt>Ws2def.h on Windows Vista, Windows Server 2008 and Windows 7 (include Winsock2.h); </dt> <dt>Ws2ipdef.h on Windows Vista, Windows Server 2008 and Windows 7 (include Ws2tcpip.h)</dt></span></span> </dl> |
