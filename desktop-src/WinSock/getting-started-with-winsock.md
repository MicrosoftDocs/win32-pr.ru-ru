---
description: Ниже приведено пошаговое руководство по началу работы с программированием Windows Sockets.
ms.assetid: 905cd5bc-44af-4d3f-841a-9e9a2700a785
title: начало работы с помощью Winsock
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43751663a637fafb2eec453a48c329ff8e4499f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692287"
---
# <a name="getting-started-with-winsock"></a><span data-ttu-id="732c0-103">начало работы с помощью Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-103">Getting Started with Winsock</span></span>

<span data-ttu-id="732c0-104">Ниже приведено пошаговое руководство по началу работы с программированием Windows Sockets.</span><span class="sxs-lookup"><span data-stu-id="732c0-104">The following is a step-by-step guide to getting started with Windows Sockets programming.</span></span> <span data-ttu-id="732c0-105">Он предназначен для понимания основных функций и структур данных Winsock и их совместной работы.</span><span class="sxs-lookup"><span data-stu-id="732c0-105">It is designed to provide an understanding of basic Winsock functions and data structures, and how they work together.</span></span>

<span data-ttu-id="732c0-106">Приложение клиента и сервера, используемое для иллюстрации, является очень базовым клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="732c0-106">The client and server application that is used for illustration is a very basic client and server.</span></span> <span data-ttu-id="732c0-107">В образцы, входящие в состав пакета средств разработки программного обеспечения (SDK) для Microsoft Windows, включены более сложные примеры кода.</span><span class="sxs-lookup"><span data-stu-id="732c0-107">More advanced code examples are included in the samples included with the Microsoft Windows Software Development Kit (SDK).</span></span>

<span data-ttu-id="732c0-108">Первые несколько шагов одинаковы для клиентских и серверных приложений.</span><span class="sxs-lookup"><span data-stu-id="732c0-108">The first few steps are the same for both client and server applications.</span></span>

-   [<span data-ttu-id="732c0-109">О серверах и клиентах</span><span class="sxs-lookup"><span data-stu-id="732c0-109">About Servers and Clients</span></span>](about-clients-and-servers.md)
-   [<span data-ttu-id="732c0-110">Создание базового приложения Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-110">Creating a Basic Winsock Application</span></span>](creating-a-basic-winsock-application.md)
-   [<span data-ttu-id="732c0-111">Инициализация Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-111">Initializing Winsock</span></span>](initializing-winsock.md)

<span data-ttu-id="732c0-112">В следующих разделах описаны оставшиеся шаги по созданию клиентского приложения Winsock.</span><span class="sxs-lookup"><span data-stu-id="732c0-112">The following sections describe the remaining steps for creating a Winsock client application.</span></span>

-   [<span data-ttu-id="732c0-113">Создание сокета для клиента</span><span class="sxs-lookup"><span data-stu-id="732c0-113">Creating a Socket for the Client</span></span>](creating-a-socket-for-the-client.md)
-   [<span data-ttu-id="732c0-114">Подключение к сокету</span><span class="sxs-lookup"><span data-stu-id="732c0-114">Connecting to a Socket</span></span>](connecting-to-a-socket.md)
-   [<span data-ttu-id="732c0-115">Отправка и получение данных на клиенте</span><span class="sxs-lookup"><span data-stu-id="732c0-115">Sending and Receiving Data on the Client</span></span>](sending-and-receiving-data-on-the-client.md)
-   [<span data-ttu-id="732c0-116">Отсоединение клиента</span><span class="sxs-lookup"><span data-stu-id="732c0-116">Disconnecting the Client</span></span>](disconnecting-the-client.md)

<span data-ttu-id="732c0-117">В следующих разделах описаны оставшиеся шаги по созданию серверного приложения Winsock.</span><span class="sxs-lookup"><span data-stu-id="732c0-117">The following sections describe the remaining steps for creating a Winsock server application.</span></span>

-   [<span data-ttu-id="732c0-118">Создание сокета для сервера</span><span class="sxs-lookup"><span data-stu-id="732c0-118">Creating a Socket for the Server</span></span>](creating-a-socket-for-the-server.md)
-   [<span data-ttu-id="732c0-119">Привязка сокета</span><span class="sxs-lookup"><span data-stu-id="732c0-119">Binding a Socket</span></span>](binding-a-socket.md)
-   [<span data-ttu-id="732c0-120">Прослушивание на сокете</span><span class="sxs-lookup"><span data-stu-id="732c0-120">Listening on a Socket</span></span>](listening-on-a-socket.md)
-   [<span data-ttu-id="732c0-121">Принятие подключения</span><span class="sxs-lookup"><span data-stu-id="732c0-121">Accepting a Connection</span></span>](accepting-a-connection.md)
-   [<span data-ttu-id="732c0-122">Получение и отправка данных на сервере</span><span class="sxs-lookup"><span data-stu-id="732c0-122">Receiving and Sending Data on the Server</span></span>](receiving-and-sending-data-on-the-server.md)
-   [<span data-ttu-id="732c0-123">Отключение сервера</span><span class="sxs-lookup"><span data-stu-id="732c0-123">Disconnecting the Server</span></span>](disconnecting-the-server.md)

<span data-ttu-id="732c0-124">Полный исходный код для этих основных примеров.</span><span class="sxs-lookup"><span data-stu-id="732c0-124">The complete source code for these basic examples.</span></span>

-   [<span data-ttu-id="732c0-125">Выполнение примера кода клиента и сервера Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-125">Running the Winsock Client and Server Code Sample</span></span>](finished-server-and-client-code.md)
-   [<span data-ttu-id="732c0-126">Завершение кода клиента Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-126">Complete Winsock Client Code</span></span>](complete-client-code.md)
-   [<span data-ttu-id="732c0-127">Завершение кода сервера Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-127">Complete Winsock Server Code</span></span>](complete-server-code.md)

## <a name="advanced-winsock-samples"></a><span data-ttu-id="732c0-128">Расширенные примеры Winsock</span><span class="sxs-lookup"><span data-stu-id="732c0-128">Advanced Winsock Samples</span></span>

<span data-ttu-id="732c0-129">В Windows SDK включены несколько дополнительных примеров клиента и сервера Winsock.</span><span class="sxs-lookup"><span data-stu-id="732c0-129">Several more advanced Winsock client and server samples are included with the Windows SDK.</span></span> <span data-ttu-id="732c0-130">По умолчанию исходный код примера Winsock устанавливается в следующий каталог Windows SDK для Windows 7:</span><span class="sxs-lookup"><span data-stu-id="732c0-130">By default, the Winsock sample source code is installed in the following directory by the Windows SDK for Windows 7:</span></span>

<span data-ttu-id="732c0-131">*C: \\ Program Files \\ Microsoft SDK \\ Windows \\ v 7.0 \\ Samples \\ нетдс \\ Winsock*</span><span class="sxs-lookup"><span data-stu-id="732c0-131">*C:\\Program Files\\Microsoft SDKs\\Windows\\v7.0\\Samples\\NetDs\\winsock*</span></span>

<span data-ttu-id="732c0-132">В более ранних версиях Windows SDK номер версии в указанном выше пути изменится.</span><span class="sxs-lookup"><span data-stu-id="732c0-132">On earlier versions of the Windows SDK, the version number in the above path would change.</span></span> <span data-ttu-id="732c0-133">Например, исходный код примера Winsock устанавливается в следующий каталог по умолчанию Windows SDK для Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="732c0-133">For example, the Winsock sample source code is installed in the following default directory by the Windows SDK for Windows Vista</span></span>

<span data-ttu-id="732c0-134">*C: \\ Program Files \\ Microsoft SDK \\ Windows \\ v 6.0 \\ Samples \\ нетдс \\ Winsock*</span><span class="sxs-lookup"><span data-stu-id="732c0-134">*C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0\\Samples\\NetDs\\winsock*</span></span>

<span data-ttu-id="732c0-135">Более сложные примеры, перечисленные ниже, в порядке возрастания производительности находятся в следующих каталогах:</span><span class="sxs-lookup"><span data-stu-id="732c0-135">The more advanced samples listed below in order from higher to lower performance are found in the following directories:</span></span>

-   <span data-ttu-id="732c0-136">IOCP</span><span class="sxs-lookup"><span data-stu-id="732c0-136">iocp</span></span>

    <span data-ttu-id="732c0-137">Этот каталог содержит три примера программ, использующих порты завершения ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="732c0-137">This directory contains three sample programs that use I/O completion ports.</span></span> <span data-ttu-id="732c0-138">В число программ входит сервер Winsock (иокпсервер), использующий функцию [**всаакцепт**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) , сервер Winsock (иокпсерверекс), использующий функцию [**акцептекс**](/windows/win32/api/mswsock/nf-mswsock-acceptex) , и простой многопоточный клиент Winsock (иокпклиент), используемый для тестирования любого из этих серверов.</span><span class="sxs-lookup"><span data-stu-id="732c0-138">The programs include a Winsock server (iocpserver) that uses the [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) function, a Winsock server (iocpserverex) that uses the [**AcceptEx**](/windows/win32/api/mswsock/nf-mswsock-acceptex) function, and a simple multithreaded Winsock client (iocpclient) used to test either of these servers.</span></span> <span data-ttu-id="732c0-139">Серверные программы поддерживают несколько клиентов, подключающихся по протоколу TCP/IP, и отправляют произвольный размер буферов данных, которые сервер возвращает обратно клиенту.</span><span class="sxs-lookup"><span data-stu-id="732c0-139">The server programs support multiple clients connecting via TCP/IP and sending arbitrary sized data buffers which the server then echoes back to the client.</span></span> <span data-ttu-id="732c0-140">Для удобства простая клиентская программа, иокпклиент, была разработана для подключения и непрерывной отправки данных на сервер, чтобы нагрузить их с помощью нескольких потоков.</span><span class="sxs-lookup"><span data-stu-id="732c0-140">For convenience, a simple client program, iocpclient, was developed to connect and continually send data to the server to stress it using multiple threads.</span></span> <span data-ttu-id="732c0-141">Серверы Winsock, использующие порты завершения ввода-вывода, обеспечивают наибольшую производительность.</span><span class="sxs-lookup"><span data-stu-id="732c0-141">Winsock servers that use I/O completion ports provide the most performance capability.</span></span>

-   <span data-ttu-id="732c0-142">крывает</span><span class="sxs-lookup"><span data-stu-id="732c0-142">overlap</span></span>

    <span data-ttu-id="732c0-143">Этот каталог содержит образец серверной программы, которая использует перекрывающиеся операции ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="732c0-143">This directory contains a sample server program that uses overlapped I/O.</span></span> <span data-ttu-id="732c0-144">Пример программы использует функцию [**акцептекс**](/windows/win32/api/mswsock/nf-mswsock-acceptex) и перекрывающиеся операции ввода-вывода для эффективной обработки нескольких асинхронных запросов на подключение от клиентов.</span><span class="sxs-lookup"><span data-stu-id="732c0-144">The sample program uses the [**AcceptEx**](/windows/win32/api/mswsock/nf-mswsock-acceptex) function and overlapped I/O to handle multiple asynchronous connection requests from clients effectively.</span></span> <span data-ttu-id="732c0-145">Сервер использует функцию **акцептекс** для мультиплексирования различных клиентских подключений в приложении Win32 с одним потоком.</span><span class="sxs-lookup"><span data-stu-id="732c0-145">The server uses the **AcceptEx** function to multiplex different client connections in a single-threaded Win32 application.</span></span> <span data-ttu-id="732c0-146">Использование перекрывающихся операций ввода-вывода позволяет повысить масштабируемость.</span><span class="sxs-lookup"><span data-stu-id="732c0-146">Using overlapped I/O allows for greater scalability.</span></span>

-   <span data-ttu-id="732c0-147">всаполл</span><span class="sxs-lookup"><span data-stu-id="732c0-147">WSAPoll</span></span>

    <span data-ttu-id="732c0-148">Этот каталог содержит базовый пример программы, демонстрирующий использование функции [**всаполл**](/windows/win32/api/winsock2/nf-winsock2-wsapoll) .</span><span class="sxs-lookup"><span data-stu-id="732c0-148">This directory contains a basic sample program that demonstrates the use of the [**WSAPoll**](/windows/win32/api/winsock2/nf-winsock2-wsapoll) function.</span></span> <span data-ttu-id="732c0-149">Объединенная клиентская и серверная программы не блокируются и используют функцию **всаполл** , чтобы определить, когда возможна отправка или получение без блокировки.</span><span class="sxs-lookup"><span data-stu-id="732c0-149">The combined client and server program are non-blocking and use the **WSAPoll** function to determine when it is possible to send or receive without blocking.</span></span> <span data-ttu-id="732c0-150">Этот пример более нагляден для иллюстрации и не является высокопроизводительным сервером.</span><span class="sxs-lookup"><span data-stu-id="732c0-150">This sample is more for illustration and is not a high-performance server.</span></span>

-   <span data-ttu-id="732c0-151">простой</span><span class="sxs-lookup"><span data-stu-id="732c0-151">simple</span></span>

    <span data-ttu-id="732c0-152">Этот каталог содержит три основных примера программ, демонстрирующих использование нескольких потоков сервером.</span><span class="sxs-lookup"><span data-stu-id="732c0-152">This directory contains three basic sample programs that demonstrate the use of multiple threads by a server.</span></span> <span data-ttu-id="732c0-153">В число программ входит простой сервер TCP/UDP (простой), сервер TCP-сервера (Simple \_ IOCTL), использующий функцию [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select) в консольном приложении Win32 для поддержки нескольких клиентских запросов, а также клиентская программа TCP/UDP (симплек) для тестирования серверов.</span><span class="sxs-lookup"><span data-stu-id="732c0-153">The programs include a simple TCP/UDP server (simples), a TCP-only server (simples\_ioctl) that uses the [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select) function in a Win32 console application to support multiple client requests, and a client TCP/UDP program (simplec) for testing the servers.</span></span> <span data-ttu-id="732c0-154">Серверы демонстрируют использование нескольких потоков для обработки нескольких клиентских запросов.</span><span class="sxs-lookup"><span data-stu-id="732c0-154">The servers demonstrates the use of multiple threads to handle multiple client requests.</span></span> <span data-ttu-id="732c0-155">Этот метод имеет проблемы масштабируемости, так как для каждого клиентского запроса создается отдельный поток.</span><span class="sxs-lookup"><span data-stu-id="732c0-155">This method has scalability issues since a separate thread is created for each client request.</span></span>

-   <span data-ttu-id="732c0-156">гласит</span><span class="sxs-lookup"><span data-stu-id="732c0-156">accept</span></span>

    <span data-ttu-id="732c0-157">Этот каталог содержит базовый пример сервера и клиентской программы.</span><span class="sxs-lookup"><span data-stu-id="732c0-157">This directory contains a basic sample server and client program.</span></span> <span data-ttu-id="732c0-158">Сервер демонстрирует использование неблокирующего приема с помощью функции [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select) или асинхронного приема с помощью функции [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) .</span><span class="sxs-lookup"><span data-stu-id="732c0-158">The server demonstrates the use of either non-blocking accept using the [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select) function or asynchronous accept using the [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) function.</span></span> <span data-ttu-id="732c0-159">Этот пример более нагляден для иллюстрации и не является высокопроизводительным сервером.</span><span class="sxs-lookup"><span data-stu-id="732c0-159">This sample is more for illustration and is not a high-performance server.</span></span>

 

 
