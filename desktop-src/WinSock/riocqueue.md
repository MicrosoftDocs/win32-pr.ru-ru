---
description: Указывает дескриптор очереди завершения, используемый для уведомлений о завершении ввода-вывода с помощью запросов send и Receive с зарегистрированными расширениями ввода-вывода Winsock.
ms.assetid: 9196F8AF-3C48-445D-B2D5-E22A99759D92
title: RIO_CQ (Mswsockdef.h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 69ca4376c5b130cccaefd7170f62878f31fd1457
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105702093"
---
# <a name="rio_cq"></a>Рио \_ КК

**Рио \_ КК** typedef указывает дескриптор очереди завершения, используемый для уведомлений о завершении ввода-вывода с помощью запросов send и Receive с зарегистрированными расширениями ввода-вывода Winsock.


```C++
typedef struct RIO_CQ_t* RIO_CQ, **PRIO_CQ;
```



<dl> <dt>

**Рио \_ КК**
</dt> <dd>

Тип данных, указывающий дескриптор очереди завершения, используемый для уведомлений о завершении ввода-вывода по запросам Send и Receive.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Объект **Рио \_ КК** используется для уведомления о завершении ввода-вывода запросов send и Receive по сетевым запросам, зарегистрированным расширениями ввода-вывода Winsock.

Приложение может использовать функцию [**рионотифи**](/windows/win32/api/mswsock/nc-mswsock-lpfn_rionotify) для запроса уведомления, если очередь завершения **Рио \_ КК** не пуста. Приложение также может опрашивать состояние в любое время в очереди завершения **Рио \_ КК** без блокировки с помощью функции [**риодекуеуекомплетион**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riodequeuecompletion) .

Объект **\_ КК Рио** создается с помощью функции [**риокреатекомплетионкуеуе**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riodequeuecompletion) . Во время создания приложение должно указать размер очереди, который определяет количество записей завершения, которое он может содержать. Когда приложение вызывает функцию [**риокреатерекуесткуеуе**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riocreaterequestqueue) для получения маркера [**\_ РК Рио**](riorqueue.md) , приложение должно указать **Рио \_ КК** для отправки завершений и Рио **\_ КК** для получения завершений. Эти дескрипторы могут быть идентичны, если одна и та же очередь должна использоваться для завершения отправки и получения. Функция **риокреатерекуесткуеуе** также требует максимального количества ожидающих операций отправки и получения, которые начисляются по емкости связанной очереди завершения или очередей. Если в очередях недостаточно емкости, вызов **риокреатерекуесткуеуе** завершится с ошибкой [всаенобуфс](windows-sockets-error-codes-2.md).

Поведение уведомлений для очереди завершения задается при создании **\_ КК Рио** .

Для очереди завершения, в которой используется событие, элементу **Type** структуры [**\_ \_ завершения уведомлений Рио**](/windows/desktop/api/Mswsock/ns-mswsock-rio_notification_completion) присваивается значение Рио для **\_ \_ завершения события**. Элемент **Event. евенсандле** должен содержать маркер события, созданного функцией [**всакреативент**](/windows/desktop/api/Winsock2/nf-winsock2-wsacreateevent) или [**CreateEvent**](/windows/win32/api/synchapi/nf-synchapi-createeventa) . Чтобы получить завершение [**рионотифи**](/windows/win32/api/mswsock/nc-mswsock-lpfn_rionotify) , приложение должно ожидать указанного обработчика событий с помощью [**всаваитформултипливентс**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents) или аналогичной процедуры Wait. Если приложение планирует сбросить и повторно использовать событие, оно может снизить нагрузку, установив для элемента **Event. нотифиресет** ненулевое значение. Это приводит к тому, что событие автоматически сбрасывается функцией **рионотифи** при возникновении уведомления. Это снижает потребность в вызове функции [**всаресетевент**](/windows/desktop/api/Winsock2/nf-winsock2-wsaresetevent) для сброса события между вызовами функции **рионотифи** .

Для очереди завершения, в которой используется порт завершения ввода-вывода, элементу **Type** структуры [**\_ \_ завершения уведомлений Рио**](/windows/desktop/api/Mswsock/ns-mswsock-rio_notification_completion) присваивается значение **Рио \_ IOCP \_ завершения**. Элемент **IOCP. иокфандле** должен содержать маркер для порта завершения ввода-вывода, созданного функцией [**CreateIoCompletionPort**](/windows/win32/api/ioapiset/nf-ioapiset-createiocompletionport) . Чтобы получить завершение [**рионотифи**](/windows/win32/api/mswsock/nc-mswsock-lpfn_rionotify) , приложение должно вызвать функцию [**жеткуеуедкомплетионстатус**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) или [**жеткуеуедкомплетионстатусекс**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatusex) . Приложение должно предоставить выделенный объект [**OVERLAPPED**](/windows/win32/api/minwinbase/ns-minwinbase-overlapped) для очереди завершения, а также элемент **IOCP. комплетионкэй** , чтобы отличать запросы **рионотифи** к очереди завершения от других завершений ввода-вывода, включая **рионотифи** завершения для других очередей завершения.

> [!Note]  
> В целях повышения эффективности доступ к очередям завершения (структурам **Рио \_ КК** ) и очередям запросов ([**Рио \_ РК**](riorqueue.md) структуры) не защищается примитивами синхронизации. Если необходимо получить доступ к очереди завершения или запросов из нескольких потоков, доступ должен координироваться критическим разделом, упрощенной блокировкой записи чтения или аналогичным механизмом. Эта блокировка не требуется для доступа в одном потоке. Различные потоки могут обращаться к отдельным запросам или очередям завершения без блокировок. Необходимость в синхронизации происходит только в том случае, если несколько потоков пытаются получить доступ к одной и той же очереди. Синхронизация также необходима, если несколько потоков отправляют и получают на одном сокете, так как операции отправки и получения используют очередь запросов сокета.

 

Если несколько потоков пытаются получить доступ к одному **Рио \_ КК** с помощью [**риодекуеуекомплетион**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riodequeuecompletion), доступ должен координироваться критической секцией, упрощенной блокировкой записи чтения или аналогичным механизмом взаимного исключения. Если очереди завершения не являются общими, взаимное исключение не требуется.

Если очередь завершения больше не нужна, приложение может закрыть его с помощью функции [**риоклосекомплетионкуеуе**](/previous-versions/windows/desktop/legacy/hh448837(v=vs.85)) .

**Рио \_ КК** typedef определяется в файле заголовка *мсвсоккдеф. h* , который автоматически включается в заголовочный файл *мсвсокк. h* . Файл заголовка *мсвсоккдеф. h* никогда не должен использоваться напрямую.

## <a name="thread-safety"></a>Потокобезопасность

Если несколько потоков пытаются получить доступ к одному **Рио \_ КК** с помощью [**риодекуеуекомплетион**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riodequeuecompletion), доступ должен координироваться критической секцией, упрощенной блокировкой записи чтения или аналогичным механизмом взаимного исключения. Если очереди завершения не являются общими, взаимное исключение не требуется.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | \[Только классические приложения Windows 8\]<br/>                                                                  |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2012\]<br/>                                                        |
| Header<br/>                   | <dl> <dt>Мсвсоккдеф. h (включение Мсвсокк. h)</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**CreateIoCompletionPort**](/windows/win32/api/ioapiset/nf-ioapiset-createiocompletionport)
</dt> <dt>

[**CreateEvent**](/windows/win32/api/synchapi/nf-synchapi-createeventa)
</dt> <dt>

[**жеткуеуедкомплетионстатус**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus)
</dt> <dt>

[**жеткуеуедкомплетионстатусекс**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatusex)
</dt> <dt>

[**OVERLAPPED**](/windows/win32/api/minwinbase/ns-minwinbase-overlapped)
</dt> <dt>

[**\_Завершение уведомлений \_ Рио**](/windows/desktop/api/Mswsock/ns-mswsock-rio_notification_completion)
</dt> <dt>

[**\_ \_ тип завершения уведомления \_ Рио**](/windows/desktop/api/Mswsock/ne-mswsock-rio_notification_completion_type)
</dt> <dt>

[**Рио \_ РК**](riorqueue.md)
</dt> <dt>

[**риоклосекомплетионкуеуе**](/previous-versions/windows/desktop/legacy/hh448837(v=vs.85))
</dt> <dt>

[**риокреатекомплетионкуеуе**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riodequeuecompletion)
</dt> <dt>

[**риокреатерекуесткуеуе**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riocreaterequestqueue)
</dt> <dt>

[**риодекуеуекомплетион**](/windows/win32/api/mswsock/nc-mswsock-lpfn_riodequeuecompletion)
</dt> <dt>

[**рионотифи**](/windows/win32/api/mswsock/nc-mswsock-lpfn_rionotify)
</dt> <dt>

[**всакреативент**](/windows/desktop/api/Winsock2/nf-winsock2-wsacreateevent)
</dt> <dt>

[**всаресетевент**](/windows/desktop/api/Winsock2/nf-winsock2-wsaresetevent)
</dt> <dt>

[**всаваитформултипливентс**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)
</dt> </dl>

 

 
