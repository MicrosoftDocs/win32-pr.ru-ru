---
description: При установке нового класса службы необходимо подготовить и предоставить структуру ВСАСЕРВИЦЕКЛАССИНФО. Эта структура также состоит из подструктур, содержащих ряд параметров, которые применяются к конкретным пространствам имен.
ms.assetid: fb225e0c-a0c7-44e1-80fb-7b924b371afa
title: Структуры данных класса службы в SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b5bf249c7437751e7c6d08b2fdf3830e92921ce7
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2021
ms.locfileid: "104571702"
---
# <a name="service-class-data-structures-in-the-spi"></a><span data-ttu-id="81bbb-104">Структуры данных класса службы в SPI</span><span class="sxs-lookup"><span data-stu-id="81bbb-104">Service Class Data Structures in the SPI</span></span>

<span data-ttu-id="81bbb-105">При установке нового класса службы необходимо подготовить и предоставить структуру [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) .</span><span class="sxs-lookup"><span data-stu-id="81bbb-105">When a new service class is installed, a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure must be prepared and supplied.</span></span> <span data-ttu-id="81bbb-106">Эта структура также состоит из подструктур, содержащих ряд параметров, которые применяются к конкретным пространствам имен.</span><span class="sxs-lookup"><span data-stu-id="81bbb-106">This structure also consists of substructures that contain a series of parameters that apply to specific namespaces.</span></span>

![Схема, показывающая структуру ВСАСЕРВИЦЕКЛАССИНФО, подструктуры и параметры, которые применяются к конкретным пространствам имен.](images/ovrvw3-3.png)

<span data-ttu-id="81bbb-108">Для каждого класса службы существует одна структура [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) .</span><span class="sxs-lookup"><span data-stu-id="81bbb-108">For each service class, there is a single [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure.</span></span> <span data-ttu-id="81bbb-109">В структуре **всасервицеклассинфо** уникальный идентификатор класса службы содержится в **лпсервицеклассид**, а на связанную отображаемую строку ссылается **лпсервицекласснаме**.</span><span class="sxs-lookup"><span data-stu-id="81bbb-109">Within the **WSASERVICECLASSINFO** structure, the service class's unique identifier is contained in **lpServiceClassId**, and an associated display string is referenced by **lpServiceClassName**.</span></span>

<span data-ttu-id="81bbb-110">Элемент **лпклассинфос** в структуре [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) ссылается на массив структур [**всансклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) , каждый из которых предоставляет именованный и типизированный параметр, который применяется к указанному пространству имен.</span><span class="sxs-lookup"><span data-stu-id="81bbb-110">The **lpClassInfos** member in the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure references an array of [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) structures, each of which supplies a named and typed parameter that applies to a specified namespace.</span></span> <span data-ttu-id="81bbb-111">Примеры значений для элемента **лпсзнаме** : SAPID, TCPPORT, удппорт и т. д. Эти строки обычно относятся к пространству имен, определенному в **двнамеспаце**.</span><span class="sxs-lookup"><span data-stu-id="81bbb-111">Examples of values for the **lpszName** member include: SAPID, TCPPORT, UDPPORT, etc. These strings are generally specific to the namespace identified in **dwNameSpace**.</span></span> <span data-ttu-id="81bbb-112">Типичными значениями для **дввалуетипе** могут быть REG \_ DWORD, REG \_ SZ и т. д. Элемент **дввалуесизе** указывает длину элемента данных, на который указывает **лпвалуе**.</span><span class="sxs-lookup"><span data-stu-id="81bbb-112">Typical values for **dwValueType** might be REG\_DWORD, REG\_SZ, etc. The **dwValueSize** member indicates the length of the data item pointed to by **lpValue**.</span></span>

<span data-ttu-id="81bbb-113">Вся коллекция данных, представленная в структуре [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) , предоставляется каждому поставщику пространства имен через [**нспинсталлсервицекласс**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass).</span><span class="sxs-lookup"><span data-stu-id="81bbb-113">The entire collection of data represented in a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure is provided to each namespace provider via [**NSPInstallServiceClass**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass).</span></span> <span data-ttu-id="81bbb-114">Затем каждый отдельный поставщик пространства имен сифтс через список структур [**всансклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) и содействует применимые к нему сведения.</span><span class="sxs-lookup"><span data-stu-id="81bbb-114">Each individual namespace provider then sifts through the list of [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) structures and retain the information applicable to it.</span></span> <span data-ttu-id="81bbb-115">Эта архитектура также позволяет представить будущее существование специального поставщика пространства имен, сохраняющего все сведения о схеме класса службы для всех пространств имен.</span><span class="sxs-lookup"><span data-stu-id="81bbb-115">This architecture also envisions the future existence of a special namespace provider that would retain all of the service class schema information for all of the namespaces.</span></span> <span data-ttu-id="81bbb-116">32.dll Ws2 \_ будет запрашивать у этого поставщика данные **всасервицеклассинфо** , необходимые для предоставления поставщикам пространства имен, когда [**нсплукупсервицебегин**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin) вызывается для инициации запроса и когда [**нспсетсервице**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice) вызывается для регистрации службы.</span><span class="sxs-lookup"><span data-stu-id="81bbb-116">The Ws2\_32.dll would query this provider to obtain the **WSASERVICECLASSINFO** data needed to supply to namespace providers when [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin) is invoked to initiate a query, and when [**NSPSetService**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice) is invoked to register a service.</span></span> <span data-ttu-id="81bbb-117">Поставщик пространства имен не должен полагаться на эту возможность в течение времени, а вместо этого должен иметь специфические для поставщика средства для получения необходимых сведений о схеме класса службы.</span><span class="sxs-lookup"><span data-stu-id="81bbb-117">Namespace provider should not rely on this capability for the time being, and should instead have a provider-specific means to obtain any needed service class schema information.</span></span> <span data-ttu-id="81bbb-118">В отсутствие поставщика, хранящего все схемы класса службы для всех пространств имен, \_32.dll Ws2 будет использовать [**нспжетсервицеклассинфо**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) для получения такой информации от каждого отдельного поставщика пространства имен.</span><span class="sxs-lookup"><span data-stu-id="81bbb-118">In the absence of a provider that stores all service class schema for all namespaces, the Ws2\_32.dll will use [**NSPGetServiceClassInfo**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) to obtain such information from each individual namespace provider.</span></span>

 

 



