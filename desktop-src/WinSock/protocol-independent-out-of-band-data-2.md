---
description: Абстракция сокета потока включает понятие данных внешнего контроллера управления.
ms.assetid: 1a517885-2688-421f-9389-2d329e5c3d56
title: Protocol-Independent нестандартных данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a929f4273d9cc9f268a296b711649406622ca9b4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104343472"
---
# <a name="protocol-independent-out-of-band-data"></a><span data-ttu-id="cecf4-103">Protocol-Independent нестандартных данных</span><span class="sxs-lookup"><span data-stu-id="cecf4-103">Protocol-Independent Out-of-Band Data</span></span>

<span data-ttu-id="cecf4-104">Абстракция сокета потока включает понятие данных внешнего контроллера управления.</span><span class="sxs-lookup"><span data-stu-id="cecf4-104">The stream socket abstraction includes the notion of out of band (OOB) data.</span></span> <span data-ttu-id="cecf4-105">Многие протоколы позволяют каким бы то ни было особым образом помечать части входящих данных как особые, и эти специальные блоки данных могут доставляться пользователю из обычной последовательности.</span><span class="sxs-lookup"><span data-stu-id="cecf4-105">Many protocols allow portions of incoming data to be marked as special in some way, and these special data blocks can be delivered to the user out of the normal sequence.</span></span> <span data-ttu-id="cecf4-106">К примерам относятся срочные данные в X. 25 и другие протоколы OSI и срочные данные в использовании протокола TCP в среде BSD UNIX.</span><span class="sxs-lookup"><span data-stu-id="cecf4-106">Examples include expedited data in X.25 and other OSI protocols, and urgent data in BSD UNIX's use of TCP.</span></span> <span data-ttu-id="cecf4-107">В следующем разделе описывается обработка данных OOB независимо от протокола.</span><span class="sxs-lookup"><span data-stu-id="cecf4-107">The following section describes OOB data handling in a protocol-independent manner.</span></span> <span data-ttu-id="cecf4-108">Обсуждение данных OOB, реализованных с помощью срочных данных TCP, следует за независимым от протокола описанием.</span><span class="sxs-lookup"><span data-stu-id="cecf4-108">A discussion of OOB data implemented using TCP urgent data follows the protocol-independent explanation.</span></span> <span data-ttu-id="cecf4-109">В каждом обсуждении использование [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) также подразумевает [**реквфром**](/windows/desktop/api/winsock/nf-winsock-recvfrom), [**всарекв**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv)и [**всареквфром**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvfrom), а ссылки на [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) также применяются к [**всаевентселект**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect).</span><span class="sxs-lookup"><span data-stu-id="cecf4-109">In each discussion, the use of [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) also implies [**recvfrom**](/windows/desktop/api/winsock/nf-winsock-recvfrom), [**WSARecv**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv), and [**WSARecvFrom**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvfrom), and references to [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) also apply to [**WSAEventSelect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect).</span></span>

## <a name="protocol-independent-oob-data"></a><span data-ttu-id="cecf4-110">Независимые от протокола данные OOB</span><span class="sxs-lookup"><span data-stu-id="cecf4-110">Protocol Independent OOB Data</span></span>

<span data-ttu-id="cecf4-111">Данные OOB — это логически независимый канал передачи, связанный с каждой парой подключенных сокетов потоков.</span><span class="sxs-lookup"><span data-stu-id="cecf4-111">OOB data is a logically independent transmission channel associated with each pair of connected stream sockets.</span></span> <span data-ttu-id="cecf4-112">Данные OOB могут быть переданы пользователю независимо от обычных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-112">OOB data may be delivered to the user independently of normal data.</span></span> <span data-ttu-id="cecf4-113">Абстракция определяет, что средства данных OOB должны поддерживать надежную доставку по крайней мере одного блока данных OOB за раз.</span><span class="sxs-lookup"><span data-stu-id="cecf4-113">The abstraction defines that the OOB data facilities must support the reliable delivery of at least one OOB data block at a time.</span></span> <span data-ttu-id="cecf4-114">Этот блок данных может содержать по крайней мере один байт данных, и хотя бы один блок данных OOB может быть отложенной доставкой пользователя в любой момент времени.</span><span class="sxs-lookup"><span data-stu-id="cecf4-114">This data block can contain at least one byte of data, and at least one OOB data block can be pending delivery to the user at any one time.</span></span> <span data-ttu-id="cecf4-115">Для протоколов связи, поддерживающих последовательное получение сигналов (например, TCP, когда срочные данные поступают последовательно с обычными данными), система обычно извлекает данные OOB из потока обычных данных и сохраняет их отдельно (в потоке данных в обычном режиме остается разрыв).</span><span class="sxs-lookup"><span data-stu-id="cecf4-115">For communications protocols that support in-band signaling (such as TCP, where the urgent data is delivered in sequence with the normal data), the system normally extracts the OOB data from the normal data stream and stores it separately (leaving a gap in the normal data stream).</span></span> <span data-ttu-id="cecf4-116">Это позволяет пользователям выбирать между получением данных OOB по порядку и их получением из последовательности без необходимости буферизации всех промежуточных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-116">This allows users to choose between receiving the OOB data in order and receiving it out of sequence without having to buffer all the intervening data.</span></span> <span data-ttu-id="cecf4-117">Можно просматривать данные, не являющиеся внешними (OOB).</span><span class="sxs-lookup"><span data-stu-id="cecf4-117">It is possible to peek at out-of-band (OOB) data.</span></span>

<span data-ttu-id="cecf4-118">Пользователь может определить, ожидают ли какие-либо данные OOB для чтения с помощью функции [**иоктлсоккет**](/windows/desktop/api/winsock/nf-winsock-ioctlsocket) или [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) с **сиокатмарк** IOCTL.</span><span class="sxs-lookup"><span data-stu-id="cecf4-118">A user can determine if any OOB data is waiting to be read using the [**ioctlsocket**](/windows/desktop/api/winsock/nf-winsock-ioctlsocket) or [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) function with the **SIOCATMARK** IOCTL.</span></span> <span data-ttu-id="cecf4-119">Для протоколов, в которых понятна концепция положения блока данных OOB в обычных потоках данных, например TCP, поставщик службы Windows Sockets поддерживает концептуальный маркер, указывающий позицию последнего байта данных OOB в потоке обычных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-119">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful, such as TCP, a Windows Sockets service provider maintains a conceptual marker indicating the position of the last byte of OOB data within the normal data stream.</span></span> <span data-ttu-id="cecf4-120">Это необязательно для реализации функций **иоктлсоккет** или **всаиоктл** , поддерживающих **сиокатмарк**.</span><span class="sxs-lookup"><span data-stu-id="cecf4-120">This is not necessary for the implementation of the **ioctlsocket** or **WSAIoctl** functions that support **SIOCATMARK**.</span></span> <span data-ttu-id="cecf4-121">Присутствие или отсутствие данных OOB является обязательным.</span><span class="sxs-lookup"><span data-stu-id="cecf4-121">The presence or absence of OOB data is all is required.</span></span>

<span data-ttu-id="cecf4-122">Для протоколов, где концепция положения блока данных OOB в обычном потоке данных имеет смысл, приложение может обрабатывать нестандартные данные встроенным образом как часть обычного потока данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-122">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful, an application might process out-of-band data inline, as part of the normal data stream.</span></span> <span data-ttu-id="cecf4-123">Это достигается путем установки параметра Socket для \_ убинлине с функцией [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt) .</span><span class="sxs-lookup"><span data-stu-id="cecf4-123">This is achieved by setting the socket option SO\_OOBINLINE with the [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) function.</span></span> <span data-ttu-id="cecf4-124">Для других протоколов, в которых блоки данных OOB действительно не зависят от обычного потока данных, попытка установить таким образом \_ убинлине приведет к ошибке.</span><span class="sxs-lookup"><span data-stu-id="cecf4-124">For other protocols where the OOB data blocks are truly independent of the normal data stream, attempting to set SO\_OOBINLINE results in an error.</span></span> <span data-ttu-id="cecf4-125">Приложение может использовать функцию [**иоктлсоккет**](/windows/desktop/api/winsock/nf-winsock-ioctlsocket) или [**всаиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) с **сиокатмарк** ioctl, чтобы определить, есть ли непрочтенные данные OOB перед меткой.</span><span class="sxs-lookup"><span data-stu-id="cecf4-125">An application can use the [**ioctlsocket**](/windows/desktop/api/winsock/nf-winsock-ioctlsocket) or [**WSAIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsaioctl) function with the **SIOCATMARK** IOCTL to determine whether there is any unread OOB data preceding the mark.</span></span> <span data-ttu-id="cecf4-126">Например, эта информация может использоваться для повторной синхронизации с одноранговым узлом, гарантируя, что все данные в потоке данных отбрасываются при необходимости.</span><span class="sxs-lookup"><span data-stu-id="cecf4-126">For example, it can use this information to resynchronize with its peer by ensuring that all data up to the mark in the data stream is discarded when appropriate.</span></span>

<span data-ttu-id="cecf4-127">WITH \_ убинлине Disabled (значение по умолчанию):</span><span class="sxs-lookup"><span data-stu-id="cecf4-127">With SO\_OOBINLINE disabled (the default setting):</span></span>

-   <span data-ttu-id="cecf4-128">Сокеты Windows уведомляют приложение о \_ событии OOB, если приложение, зарегистрированное для уведомления с [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect), точно так же, как и \_ прочитанное, используется для уведомления о присутствии обычных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-128">Windows Sockets notifies an application of an FD\_OOB event, if the application registered for notification with [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect), in exactly the same way FD\_READ is used to notify of the presence of normal data.</span></span> <span data-ttu-id="cecf4-129">Это значит, что демон \_ OOB публикуется, когда данные OOB поступают без ранее поставленных в очередь данных OOB.</span><span class="sxs-lookup"><span data-stu-id="cecf4-129">That is, FD\_OOB is posted when OOB data arrives with no OOB data previously queued.</span></span> <span data-ttu-id="cecf4-130">\_При считывании данных с помощью \_ флага OOB, а некоторые данные OOB остаются в очереди после возвращения операции чтения.</span><span class="sxs-lookup"><span data-stu-id="cecf4-130">The FD\_OOB is also posted when data is read using the MSG\_OOB flag while some OOB data remains queued after the read operation has returned.</span></span> <span data-ttu-id="cecf4-131">Сообщения ДЕМОна \_ чтения не размещаются для данных OOB.</span><span class="sxs-lookup"><span data-stu-id="cecf4-131">FD\_READ messages are not posted for OOB data.</span></span>
-   <span data-ttu-id="cecf4-132">Сокеты Windows возвращаются из [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select) с соответствующим набором сокетов *ексцептфдс* , если данные OOB поставлены в очередь на сокете.</span><span class="sxs-lookup"><span data-stu-id="cecf4-132">Windows Sockets returns from [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select) with the appropriate *exceptfds* socket set if OOB data is queued on the socket.</span></span>
-   <span data-ttu-id="cecf4-133">Приложение может вызвать метод [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) с сообщением \_ OOB для чтения блока срочных данных в любое время.</span><span class="sxs-lookup"><span data-stu-id="cecf4-133">The application can call [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) with MSG\_OOB to read the urgent data block at any time.</span></span> <span data-ttu-id="cecf4-134">Блок данных OOB переходит в очередь.</span><span class="sxs-lookup"><span data-stu-id="cecf4-134">The block of OOB data jumps the queue.</span></span>
-   <span data-ttu-id="cecf4-135">Приложение может вызвать метод [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) без сообщения \_ OOB для чтения потока обычных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-135">The application can call [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) without MSG\_OOB to read the normal data stream.</span></span> <span data-ttu-id="cecf4-136">Блок данных OOB не отображается в потоке данных с обычными данными.</span><span class="sxs-lookup"><span data-stu-id="cecf4-136">The OOB data block does not appear in the data stream with normal data.</span></span> <span data-ttu-id="cecf4-137">Если данные OOB остаются после вызова метода **recv**, сокеты Windows уведомляют приложение с помощью демона \_ OOB или WITH *ексцептфдс* при использовании инструкции [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select).</span><span class="sxs-lookup"><span data-stu-id="cecf4-137">If OOB data remains after any call to **recv**, Windows Sockets notifies the application with FD\_OOB or with *exceptfds* when using [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select).</span></span>
-   <span data-ttu-id="cecf4-138">Для протоколов, в которых данные OOB имеют позицию в потоке обычных данных, одна операция [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) не охватывает эту позицию.</span><span class="sxs-lookup"><span data-stu-id="cecf4-138">For protocols where the OOB data has a position within the normal data stream, a single [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) operation does not span that position.</span></span> <span data-ttu-id="cecf4-139">Одна инструкция **recv** возвращает обычные данные перед меткой, **а вторая —** для начала чтения данных после метки.</span><span class="sxs-lookup"><span data-stu-id="cecf4-139">One **recv** returns the normal data before the mark, and a second **recv** is required to begin reading data after the mark.</span></span>

<span data-ttu-id="cecf4-140">При \_ включенном убинлине:</span><span class="sxs-lookup"><span data-stu-id="cecf4-140">With SO\_OOBINLINE enabled:</span></span>

-   <span data-ttu-id="cecf4-141">\_Сообщения OOB не размещаются для данных OOB.</span><span class="sxs-lookup"><span data-stu-id="cecf4-141">FD\_OOB messages are not posted for OOB data.</span></span> <span data-ttu-id="cecf4-142">Данные OOB обрабатываются как обычные для функций [**SELECT**](/windows/desktop/api/Winsock2/nf-winsock2-select) и [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) и указываются путем установки сокета в *реадфдс* или отправки сообщения демо- \_ чтения, соответственно.</span><span class="sxs-lookup"><span data-stu-id="cecf4-142">OOB data is treated as normal for the purpose of the [**select**](/windows/desktop/api/Winsock2/nf-winsock2-select) and [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) functions, and indicated by setting the socket in *readfds* or by sending an FD\_READ message respectively.</span></span>
-   <span data-ttu-id="cecf4-143">Приложение не может вызвать [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) с \_ флагом сообщения OOB, установленным для чтения блока данных OOB.</span><span class="sxs-lookup"><span data-stu-id="cecf4-143">The application cannot call [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) with the MSG\_OOB flag set to read the OOB data block.</span></span> <span data-ttu-id="cecf4-144">Возвращается код ошибки ВСАЕИНВАЛ.</span><span class="sxs-lookup"><span data-stu-id="cecf4-144">The error code WSAEINVAL is returned.</span></span>
-   <span data-ttu-id="cecf4-145">Приложение может вызвать метод [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) без \_ установленного флага сообщения OOB.</span><span class="sxs-lookup"><span data-stu-id="cecf4-145">The application can call [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) without the MSG\_OOB flag set.</span></span> <span data-ttu-id="cecf4-146">Все данные OOB доставляются в правильном порядке в потоке обычных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-146">Any OOB data is delivered in its correct order within the normal data stream.</span></span> <span data-ttu-id="cecf4-147">Данные OOB никогда не смешиваются с обычными данными.</span><span class="sxs-lookup"><span data-stu-id="cecf4-147">OOB data is never mixed with normal data.</span></span> <span data-ttu-id="cecf4-148">Для получения данных OOB необходимо три запроса на чтение.</span><span class="sxs-lookup"><span data-stu-id="cecf4-148">There must be three read requests to get past the OOB data.</span></span> <span data-ttu-id="cecf4-149">Первый возвращает обычные данные до блока данных OOB, второй возвращает данные OOB, третий — обычные данные, следующие за данными OOB.</span><span class="sxs-lookup"><span data-stu-id="cecf4-149">The first returns the normal data prior to the OOB data block, the second returns the OOB data, the third returns the normal data following the OOB data.</span></span> <span data-ttu-id="cecf4-150">Иными словами, границы блоков данных OOB сохраняются.</span><span class="sxs-lookup"><span data-stu-id="cecf4-150">In other words, the OOB data block boundaries are preserved.</span></span>

<span data-ttu-id="cecf4-151">Подпрограммы [**всаасинкселект**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) особенно хорошо подходят для обработки уведомлений о присутствии нестандартных данных, когда \_ убинлине выключен.</span><span class="sxs-lookup"><span data-stu-id="cecf4-151">The [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) routine is particularly well suited to handling notification of the presence of out-of-band-data when SO\_OOBINLINE is off.</span></span>

## <a name="oob-data-in-tcp"></a><span data-ttu-id="cecf4-152">Данные OOB в TCP</span><span class="sxs-lookup"><span data-stu-id="cecf4-152">OOB Data in TCP</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cecf4-153">Следующее обсуждение нестандартных данных (OOB), реализованных с помощью срочных данных TCP, соответствует модели, используемой в распространении программного обеспечения Berkeley.</span><span class="sxs-lookup"><span data-stu-id="cecf4-153">The following discussion of out-of-band data (OOB), implemented using TCP urgent data, follows the model used in the Berkeley software distribution.</span></span> <span data-ttu-id="cecf4-154">Пользователи и разработчики должны иметь в виду следующее:</span><span class="sxs-lookup"><span data-stu-id="cecf4-154">Users and implementers should be aware that:</span></span>

 

-   <span data-ttu-id="cecf4-155">В настоящее время существует две конфликтующие интерпретации [RFC 793](https://www.ietf.org/rfc/rfc793.txt) (где представлена концепция).</span><span class="sxs-lookup"><span data-stu-id="cecf4-155">There are, at present, two conflicting interpretations of [RFC 793](https://www.ietf.org/rfc/rfc793.txt) (where the concept is introduced).</span></span>
-   <span data-ttu-id="cecf4-156">Реализация данных OOB в программе Berkeley Software Distribution (BSD) не соответствует требованиям к узлу, указанным в [RFC 1122](https://www.ietf.org/rfc/rfc1122.txt).</span><span class="sxs-lookup"><span data-stu-id="cecf4-156">The implementation of OOB data in the Berkeley Software Distribution (BSD) does not conform to the Host Requirements specified in [RFC 1122](https://www.ietf.org/rfc/rfc1122.txt).</span></span>

    <span data-ttu-id="cecf4-157">В частности, срочный указатель TCP в BSD указывает на байт после байта срочных данных и срочный указатель TCP, совместимый с RFC, указывает на байт срочных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-157">Specifically, the TCP urgent pointer in BSD points to the byte after the urgent data byte, and an RFC-compliant TCP urgent pointer points to the urgent data byte.</span></span> <span data-ttu-id="cecf4-158">В результате, если приложение отправляет срочные данные из реализации, совместимой с BSD, в реализацию, совместимую с RFC 1122, получатель считывает неправильный байт срочных данных (он считывает байт, расположенный после правильного байта в потоке данных в качестве срочного байта данных).</span><span class="sxs-lookup"><span data-stu-id="cecf4-158">As a result, if an application sends urgent data from a BSD-compatible implementation to an implementation compatible with RFC 1122, the receiver reads the wrong urgent data byte (it reads the byte located after the correct byte in the data stream as the urgent data byte).</span></span>

    <span data-ttu-id="cecf4-159">Чтобы избежать проблем взаимодействия, разработчикам приложений рекомендуется не использовать данные OOB, если это не требуется для взаимодействия с существующей службой.</span><span class="sxs-lookup"><span data-stu-id="cecf4-159">To minimize interoperability problems, applications writers are advised not to use OOB data unless this is required to interoperate with an existing service.</span></span> <span data-ttu-id="cecf4-160">Поставщики сокетов Windows — это законодателей для документирования семантики OOB (BSD или RFC 1122), реализуемой их продуктом.</span><span class="sxs-lookup"><span data-stu-id="cecf4-160">Windows Sockets suppliers are urged to document the OOB semantics (BSD or RFC 1122) that their product implements.</span></span>

<span data-ttu-id="cecf4-161">Получение сегмента TCP с установленным флагом УРГ (для срочной) указывает на существование одного байта данных OOB в потоке данных TCP.</span><span class="sxs-lookup"><span data-stu-id="cecf4-161">The arrival of a TCP segment with the URG (for urgent) flag set indicates the existence of a single byte of OOB data within the TCP data stream.</span></span> <span data-ttu-id="cecf4-162">Блок данных OOB имеет размер один байт.</span><span class="sxs-lookup"><span data-stu-id="cecf4-162">The OOB data block is one byte in size.</span></span> <span data-ttu-id="cecf4-163">Срочный указатель — это положительное смещение от текущего порядкового номера в заголовке TCP, которое указывает расположение блока данных OOB (неоднозначно, как указано выше).</span><span class="sxs-lookup"><span data-stu-id="cecf4-163">The urgent pointer is a positive offset from the current sequence number in the TCP header that indicates the location of the OOB data block (ambiguously, as noted in the preceding).</span></span> <span data-ttu-id="cecf4-164">Поэтому он может указывать на данные, которые еще не были получены.</span><span class="sxs-lookup"><span data-stu-id="cecf4-164">It might, therefore, point to data that has not yet been received.</span></span>

<span data-ttu-id="cecf4-165">Если \_ убинлине отключен (по умолчанию), то при получении сегмента TCP, содержащего байт, на который указывает срочный указатель, блок данных OOB (один байт) удаляется из потока данных и перемещается в буфер.</span><span class="sxs-lookup"><span data-stu-id="cecf4-165">If SO\_OOBINLINE is disabled (the default) when the TCP segment containing the byte pointed to by the urgent pointer arrives, the OOB data block (one byte) is removed from the data stream and buffered.</span></span> <span data-ttu-id="cecf4-166">Если последующий сегмент TCP поступает с установленным флагом срочности (и новым срочным указателем), байт OOB, находящиеся в очереди, может быть потерян, так как он заменяется новым блоком данных OOB (как происходит при распространении программного обеспечения).</span><span class="sxs-lookup"><span data-stu-id="cecf4-166">If a subsequent TCP segment arrives with the urgent flag set (and a new urgent pointer), the OOB byte currently queued can be lost as it is replaced by the new OOB data block (as occurs in Berkeley Software Distribution).</span></span> <span data-ttu-id="cecf4-167">Однако он никогда не заменяется в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-167">It is never replaced in the data stream, however.</span></span>

<span data-ttu-id="cecf4-168">Если \_ убинлине включен, срочные данные остаются в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-168">With SO\_OOBINLINE enabled, the urgent data remains in the data stream.</span></span> <span data-ttu-id="cecf4-169">В результате блок данных OOB никогда не будет потерян при поступлении нового сегмента TCP, содержащего срочные данные.</span><span class="sxs-lookup"><span data-stu-id="cecf4-169">As a result, the OOB data block is never lost when a new TCP segment arrives containing urgent data.</span></span> <span data-ttu-id="cecf4-170">Существующая метка данных OOB обновляется до новой должности.</span><span class="sxs-lookup"><span data-stu-id="cecf4-170">The existing OOB data mark is updated to the new position.</span></span>

> [!Note]  
> <span data-ttu-id="cecf4-171">Если \_ установлен параметр убинлине Socket, то СИОКАТМАРК ioctl всегда возвращает **значение true**, а данные OOB возвращаются пользователю в виде обычных данных.</span><span class="sxs-lookup"><span data-stu-id="cecf4-171">When the SO\_OOBINLINE socket option is set, the SIOCATMARK IOCTL always returns **TRUE**, and OOB data is returned to the user as normal data.</span></span>

 

 

 



