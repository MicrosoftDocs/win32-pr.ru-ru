---
description: При необходимости маркером сокета может быть описатель файла в сокетах Windows 2. Маркер сокета от поставщика Winsock можно использовать с другими функциями, отличными от Winsock, такими как ReadFile, WriteFile, Реадфиликс и Вритефиликс.
ms.assetid: 986dd9d8-52be-47aa-92b2-6cd40b83f5de
title: Дескрипторы сокетов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca6ca8ed935819e018a59c52fb43dcf816530c07
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711766"
---
# <a name="socket-handles"></a><span data-ttu-id="59437-104">Дескрипторы сокетов</span><span class="sxs-lookup"><span data-stu-id="59437-104">Socket Handles</span></span>

<span data-ttu-id="59437-105">При необходимости маркером сокета может быть описатель файла в сокетах Windows 2.</span><span class="sxs-lookup"><span data-stu-id="59437-105">A socket handle can optionally be a file handle in Windows Sockets 2.</span></span> <span data-ttu-id="59437-106">Маркер сокета от поставщика Winsock можно использовать с другими функциями, отличными от Winsock, такими как [**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile), [**реадфиликс**](/windows/win32/api/fileapi/nf-fileapi-readfileex)и [**вритефиликс**](/windows/win32/api/fileapi/nf-fileapi-writefileex).</span><span class="sxs-lookup"><span data-stu-id="59437-106">A socket handle from a Winsock provider can be used with other non-Winsock functions such as [**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile), [**ReadFileEx**](/windows/win32/api/fileapi/nf-fileapi-readfileex), and [**WriteFileEx**](/windows/win32/api/fileapi/nf-fileapi-writefileex).</span></span>

<span data-ttu-id="59437-107">Элемент **XP1 \_ IFS \_ Handles** в структуре сведений о протоколе для поставщика определяет, является ли дескриптор сокета поставщика подсистемой для установки файловой системы (IFS).</span><span class="sxs-lookup"><span data-stu-id="59437-107">The **XP1\_IFS\_HANDLES** member in the protocol information structure for a provider determines whether a socket handle from a provider is an Installable File System (IFS) handle.</span></span> <span data-ttu-id="59437-108">Дескрипторы сокетов, которые являются дескрипторами IFS, можно использовать без снижения производительности с другими функциями, отличными от Winsock (например,[**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile) и [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile)).</span><span class="sxs-lookup"><span data-stu-id="59437-108">Socket handles that are IFS handles can be used without a performance penalty with other non-Winsock functions ([**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile), for example).</span></span> <span data-ttu-id="59437-109">Любые дескрипторы сокетов, не относящихся к IFS, при использовании с функциями, отличными от Winsock (например,**ReadFile** и **WriteFile**), приводят к взаимодействию между поставщиком и файловой системой, в которой участвуют дополнительные издержки на обработку, что может привести к значительному снижению производительности.</span><span class="sxs-lookup"><span data-stu-id="59437-109">Any non-IFS socket handles when used with non-Winsock functions (**ReadFile** and **WriteFile**, for example) result in interactions between the provider and the file system where extra processing overhead is involved that can result in a significant performance penalty.</span></span> <span data-ttu-id="59437-110">При использовании дескрипторов сокетов с функциями, отличными от Winsock, коды ошибок, распространяемые из базовой файловой системы, не всегда сопоставляются с кодами ошибок Winsock.</span><span class="sxs-lookup"><span data-stu-id="59437-110">When using socket handles with non-Winsock functions, the error codes propagated from the base file system are not always mapped to Winsock error codes.</span></span> <span data-ttu-id="59437-111">Поэтому рекомендуется использовать дескрипторы сокетов только с функциями Winsock.</span><span class="sxs-lookup"><span data-stu-id="59437-111">Consequently, it is recommended that socket handles be used only with Winsock functions.</span></span>

<span data-ttu-id="59437-112">Не следует использовать маркер сокета с функцией [**дупликатехандле**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) .</span><span class="sxs-lookup"><span data-stu-id="59437-112">A socket handle should not be used with the [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) function.</span></span> <span data-ttu-id="59437-113">Наличие многоуровневых поставщиков служб (LSP) может привести к сбою, и процесс назначения не сможет импортировать маркер сокета.</span><span class="sxs-lookup"><span data-stu-id="59437-113">The presence of layered service providers (LSPs) can cause this to fail and there is no way for the destination process to import the socket handle.</span></span>

> [!Note]  
> <span data-ttu-id="59437-114">Многоуровневые поставщики служб являются устаревшими.</span><span class="sxs-lookup"><span data-stu-id="59437-114">Layered Service Providers are deprecated.</span></span> <span data-ttu-id="59437-115">Начиная с Windows 8 и Windows Server 2012, используйте [платформу фильтрации Windows](../fwp/windows-filtering-platform-start-page.md).</span><span class="sxs-lookup"><span data-stu-id="59437-115">Starting with Windows 8 and Windows Server 2012, use [Windows Filtering Platform](../fwp/windows-filtering-platform-start-page.md).</span></span>

 

<span data-ttu-id="59437-116">Сокеты Windows 2 развернули некоторые функции, которые передают данные между сокетами с помощью дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="59437-116">Windows Sockets 2 has expanded certain functions that transfer data between sockets using handles.</span></span> <span data-ttu-id="59437-117">Функции предоставляют преимущества, характерные для сокетов для передачи данных и включают [**всарекв**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv), [**всасенд**](/windows/desktop/api/Winsock2/nf-winsock2-wsasend)и [**всадупликатесоккет**](/windows/desktop/api/Winsock2/nf-winsock2-wsaduplicatesocketa).</span><span class="sxs-lookup"><span data-stu-id="59437-117">The functions offer advantages specific to sockets for transferring data and include [**WSARecv**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv), [**WSASend**](/windows/desktop/api/Winsock2/nf-winsock2-wsasend), and [**WSADuplicateSocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsaduplicatesocketa).</span></span>

 

 
