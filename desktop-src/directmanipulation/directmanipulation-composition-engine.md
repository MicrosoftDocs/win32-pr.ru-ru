---
description: Чтобы обеспечить визуальное обновление, приложение должно использовать Идиректманипулатионкомпоситор.
ms.assetid: 6D8FB359-F52B-43F9-8A62-6BB2AEDE4F2B
title: Механизм композиции
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: aa4d922893472c1fe235bae60e41a00924d13bba
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104494952"
---
# <a name="composition-engine"></a><span data-ttu-id="09199-103">Механизм композиции</span><span class="sxs-lookup"><span data-stu-id="09199-103">Composition engine</span></span>

<span data-ttu-id="09199-104">Чтобы обеспечить визуальное обновление, приложение должно использовать [**идиректманипулатионкомпоситор**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor).</span><span class="sxs-lookup"><span data-stu-id="09199-104">In order to drive visual updates, the application should use [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor).</span></span> <span data-ttu-id="09199-105">Этот объект отвечает за обновление визуальных элементов на основе обновлений [непосредственного управления](direct-manipulation-portal.md) , переход на обновления инерции и предоставление сведений о времени компоновки для непосредственной манипуляции. Кроме того, приложение должно использовать [дкомпманипулатионкомпоситор](direct-manipulation-guids.md) , предоставляемый [непосредственной манипуляцией](direct-manipulation-portal.md), который будет обрабатывать все визуальные обновления от имени приложения и управлять обновлениями инерции.</span><span class="sxs-lookup"><span data-stu-id="09199-105">This object is responsible for updating visuals based on [Direct Manipulation](direct-manipulation-portal.md) updates, driving inertia updates forward, and providing composition timing information to Direct Manipulation Furthermore, an application should use the [DCompManipulationCompositor](direct-manipulation-guids.md) provided by [Direct Manipulation](direct-manipulation-portal.md), which will handle all visual updates on behalf of the application and drive inertia updates.</span></span>

<span data-ttu-id="09199-106">[Дкомпманипулатионкомпоситор](direct-manipulation-guids.md) является реализацией интерфейса [**идиректманипулатионкомпоситор**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor) , который заключает [DirectComposition](../directcomp/directcomposition-portal.md).</span><span class="sxs-lookup"><span data-stu-id="09199-106">The [DCompManipulationCompositor](direct-manipulation-guids.md) is an implementation of the [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor) interface that wraps [DirectComposition](../directcomp/directcomposition-portal.md).</span></span> <span data-ttu-id="09199-107">Вместо того, чтобы приложение применяло выходные данные, через [прямую манипуляцию](direct-manipulation-portal.md) с объектом-компоновщиком можно применить выходные данные, установив преобразования непосредственно в дереве DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="09199-107">Rather than having the application apply the output, through this compositor object [Direct Manipulation](direct-manipulation-portal.md) can apply the output by setting the transforms directly on the DirectComposition tree.</span></span> <span data-ttu-id="09199-108">С помощью этой конфигурации можно обрабатывать входные и выходные преобразования, независимо от действий в потоке пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="09199-108">By using this configuration, input can be processed and output transforms can be applied, regardless of activity on the UI thread.</span></span>

<span data-ttu-id="09199-109">Чтобы предоставить сведения о [прямой манипуляции](direct-manipulation-portal.md) по времени механизма композиции, класс [Дкомпманипулатионкомпоситор](direct-manipulation-guids.md) реализует интерфейс [**идиректманипулатионфрамеинфопровидер**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationframeinfoprovider) .</span><span class="sxs-lookup"><span data-stu-id="09199-109">To give [Direct Manipulation](direct-manipulation-portal.md) information on the timing of the composition engine, the [DCompManipulationCompositor](direct-manipulation-guids.md) class implements the [**IDirectManipulationFrameInfoProvider**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationframeinfoprovider) interface.</span></span> <span data-ttu-id="09199-110">При создании окна просмотра [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) [**идиректманипулатионкомпоситор**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor) указатель, полученный из [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для экземпляра **идиректманипулатионфрамеинфопровидер**.</span><span class="sxs-lookup"><span data-stu-id="09199-110">When creating a viewport, [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) the [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor) pointer obtained from [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) for an instance of **IDirectManipulationFrameInfoProvider**.</span></span> <span data-ttu-id="09199-111">Указатель **идиректманипулатионфрамеинфопровидер** передается в функцию [**Идиректманипулатионманажер:: креатевиевпорт ()**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-createviewport) .</span><span class="sxs-lookup"><span data-stu-id="09199-111">The **IDirectManipulationFrameInfoProvider** pointer is passed to the [**IDirectManipulationManager::CreateViewport()**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-createviewport) function.</span></span>
