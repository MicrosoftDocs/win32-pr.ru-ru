---
description: Наборы API — это функциональные группы API-интерфейсов Win32 в основной операционной системе. Они предоставляют архитектурное разделение от библиотеки DLL узла, в которой определен заданный API Win32, и функциональную группу, к которой принадлежит API.
title: Наборы API Windows
ms.topic: article
ms.date: 10/14/2020
ms.openlocfilehash: 15c8e6ad8124abf06e6ab3c2a8ca2bcd83772855
ms.sourcegitcommit: db89157e3be911fdce2e543e99faa31fb2403bc8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "104488616"
---
# <a name="windows-api-sets"></a><span data-ttu-id="32865-104">Наборы API Windows</span><span class="sxs-lookup"><span data-stu-id="32865-104">Windows API sets</span></span>

<span data-ttu-id="32865-105">Все версии Windows 10 совместно используют общую основу компонентов операционной системы, которая называется *основной ОС* (в некоторых контекстах эта общая основа также называется *OneCore*).</span><span class="sxs-lookup"><span data-stu-id="32865-105">All versions of Windows 10 share a common base of OS components that is called the *core OS* (in some contexts this common base is also called *OneCore*).</span></span> <span data-ttu-id="32865-106">В основных компонентах ОС API Win32 организованы в функциональные группы, которые называются *наборами API*.</span><span class="sxs-lookup"><span data-stu-id="32865-106">In core OS components, Win32 APIs are organized into functional groups called *API sets*.</span></span>

<span data-ttu-id="32865-107">Целью набора API является предоставление архитектурного разделения от библиотеки DLL узла, в которой реализован данный API Win32, и функционального контракта, к которому принадлежит API.</span><span class="sxs-lookup"><span data-stu-id="32865-107">The purpose of an API set is to provide an architectural separation from the host DLL in which a given Win32 API is implemented and the functional contract to which the API belongs.</span></span> <span data-ttu-id="32865-108">Разделение, предоставляемое наборами API между реализацией и контрактами, предоставляет разработчикам множество преимуществ для инженеров.</span><span class="sxs-lookup"><span data-stu-id="32865-108">The decoupling that API sets provide between implementation and contracts offers many engineering advantages for developers.</span></span> <span data-ttu-id="32865-109">В частности, использование наборов API в коде может улучшить совместимость со всеми устройствами Windows 10.</span><span class="sxs-lookup"><span data-stu-id="32865-109">In particular, using API sets in your code can improve compatibility with all Windows 10 devices.</span></span>

<span data-ttu-id="32865-110">Наборы API специально предназначены для следующих сценариев:</span><span class="sxs-lookup"><span data-stu-id="32865-110">API sets specifically address the following scenarios:</span></span>

- <span data-ttu-id="32865-111">Хотя все возможности API Win32 поддерживаются на компьютерах, только подмножество API Win32 доступно на других устройствах Windows 10, таких как HoloLens, Xbox и другие устройства под управлением Windows 10 раз.</span><span class="sxs-lookup"><span data-stu-id="32865-111">Although the full breadth of the Win32 API is supported on PCs, only a subset of the Win32 API is available on other Windows 10 devices such as HoloLens, Xbox, and other devices running Windows 10x.</span></span> <span data-ttu-id="32865-112">Имя набора API предоставляет механизм запросов, позволяющий четко определить, доступен ли API на любом конкретном устройстве.</span><span class="sxs-lookup"><span data-stu-id="32865-112">The API set name provides a query mechanism to cleanly detect whether an API is available on any given device.</span></span>

- <span data-ttu-id="32865-113">Некоторые реализации API Win32 существуют в библиотеках DLL с разными именами на разных устройствах Windows 10.</span><span class="sxs-lookup"><span data-stu-id="32865-113">Some Win32 API implementations exist in DLLs with different names across different Windows 10 devices.</span></span> <span data-ttu-id="32865-114">Использование имен наборов API вместо имен библиотек DLL при обнаружении API доступности и отложенной загрузки API обеспечивает правильный маршрут к реализации независимо от того, где фактически реализован API.</span><span class="sxs-lookup"><span data-stu-id="32865-114">Using API set names instead of DLL names when detecting API availability and delay loading APIs provide a correct route to the implementation no matter where the API is actually implemented.</span></span>

<span data-ttu-id="32865-115">Дополнительные сведения см. в разделе [Операция загрузчика набора API](api-set-loader-operation.md) и [Определение доступности набора API](detect-api-set-availability.md).</span><span class="sxs-lookup"><span data-stu-id="32865-115">For more details, see [API set loader operation](api-set-loader-operation.md) and [Detect API set availability](detect-api-set-availability.md).</span></span>

## <a name="linking-to-umbrella-libraries"></a><span data-ttu-id="32865-116">Связывание с библиотеками "тег"</span><span class="sxs-lookup"><span data-stu-id="32865-116">Linking to umbrella libraries</span></span>

<span data-ttu-id="32865-117">Чтобы упростить ограничение кода интерфейсами API Win32, которые поддерживаются в основной ОС, мы предоставляем ряд *библиотек*-кодов.</span><span class="sxs-lookup"><span data-stu-id="32865-117">To make it easier to restrict your code to Win32 APIs that are supported in the core OS, we provide a series of *umbrella libraries*.</span></span> <span data-ttu-id="32865-118">Например, Библиотека с именем OneCore. lib предоставляет экспорты для подмножества API-интерфейсов Win32, общих для всех устройств Windows 10.</span><span class="sxs-lookup"><span data-stu-id="32865-118">For example, an umbrella library named OneCore.lib provides the exports for the subset of Win32 APIs that are common to all Windows 10 devices.</span></span>

<span data-ttu-id="32865-119">API-интерфейсы в библиотеке-области могут быть реализованы в разных модулях.</span><span class="sxs-lookup"><span data-stu-id="32865-119">The APIs in an umbrella library may be implemented across a range of modules.</span></span> <span data-ttu-id="32865-120">Библиотека «тег» абстрагирует эти сведения от вас, делая код более переносимым в разных версиях и устройствах Windows 10.</span><span class="sxs-lookup"><span data-stu-id="32865-120">The umbrella library abstracts those details away from you, making your code more portable across Windows 10 versions and devices.</span></span> <span data-ttu-id="32865-121">Вместо связывания с библиотеками, такими как Kernel32. lib и advapi32. lib, просто Свяжите свое классическое приложение или драйвер с библиотекой-символами-разработчиками, которая содержит набор основных API ОС, которые вас интересуют.</span><span class="sxs-lookup"><span data-stu-id="32865-121">Instead of linking to libraries such as kernel32.lib and advapi32.lib, simply link your desktop app or driver with the umbrella library that contains the set of core OS APIs that you're interested in.</span></span>

<span data-ttu-id="32865-122">Дополнительные сведения см. в разделе [библиотеки подсистемы Windows](windows-umbrella-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="32865-122">For more details, see [Windows umbrella libraries](windows-umbrella-libraries.md).</span></span>

## <a name="api-set-contract-names"></a><span data-ttu-id="32865-123">Имена контрактов набора API</span><span class="sxs-lookup"><span data-stu-id="32865-123">API set contract names</span></span>

<span data-ttu-id="32865-124">Наборы API идентифицируются строгим именем контракта, которое соответствует стандартным соглашениям, распознаваемым загрузчиком библиотеки.</span><span class="sxs-lookup"><span data-stu-id="32865-124">API sets are identified by a strong contract name that follows these standard conventions recognized by the library loader.</span></span> 

- <span data-ttu-id="32865-125">Имя должно начинаться с строки **API** или **ext-**.</span><span class="sxs-lookup"><span data-stu-id="32865-125">The name must begin either with the string **api-** or **ext-**.</span></span> 
    - <span data-ttu-id="32865-126">Имена, начинающиеся с **API** , представляют интерфейсы API, которые гарантированно существуют во всех версиях Windows 10.</span><span class="sxs-lookup"><span data-stu-id="32865-126">Names that begin with **api-** represent APIs that are guaranteed to exist on all Windows 10 versions.</span></span>
    - <span data-ttu-id="32865-127">Имена, начинающиеся с **ext** , представляют интерфейсы API, которые могут не существовать во всех версиях Windows 10.</span><span class="sxs-lookup"><span data-stu-id="32865-127">Names that begin with **ext-** represent APIs that may not exist on all Windows 10 versions.</span></span>
- <span data-ttu-id="32865-128">Имя должно заканчиваться последовательностью **l \<n\> - \<n\> - \<n\>**, где **n** состоит из десятичных цифр.</span><span class="sxs-lookup"><span data-stu-id="32865-128">The name must end with the sequence **l\<n\>-\<n\>-\<n\>**, where **n** consists of decimal digits.</span></span>
- <span data-ttu-id="32865-129">Текст имени может быть буквенно-цифровым символом или тире ( **-** ).</span><span class="sxs-lookup"><span data-stu-id="32865-129">The body of the name can be alphanumeric characters, or dashes (**-**).</span></span>
- <span data-ttu-id="32865-130">Регистр букв в имени не учитывается.</span><span class="sxs-lookup"><span data-stu-id="32865-130">The name is case insensitive.</span></span>

<span data-ttu-id="32865-131">Ниже приведены некоторые примеры имен контрактов для наборов API.</span><span class="sxs-lookup"><span data-stu-id="32865-131">Here are some examples of API set contract names:</span></span>

- <span data-ttu-id="32865-132">**API-MS-Win-Core-UMS-L1-1-0**</span><span class="sxs-lookup"><span data-stu-id="32865-132">**api-ms-win-core-ums-l1-1-0**</span></span>
- <span data-ttu-id="32865-133">**Ext-MS-Win-com-ole32-L1-1-5**</span><span class="sxs-lookup"><span data-stu-id="32865-133">**ext-ms-win-com-ole32-l1-1-5**</span></span>
- <span data-ttu-id="32865-134">**Ext-MS-Win-NTuser-Window-L1-1-0**</span><span class="sxs-lookup"><span data-stu-id="32865-134">**ext-ms-win-ntuser-window-l1-1-0**</span></span>
- <span data-ttu-id="32865-135">**Ext-MS-Win-NTuser-Window-L1-1-1**</span><span class="sxs-lookup"><span data-stu-id="32865-135">**ext-ms-win-ntuser-window-l1-1-1**</span></span>

<span data-ttu-id="32865-136">Имя набора API можно использовать в контексте операции загрузчика, например [LoadLibrary](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) или [P/Invoke](/dotnet/standard/native-interop/pinvoke) , вместо имени модуля DLL, чтобы обеспечить правильный маршрут к реализации независимо от того, где фактически реализован API на текущем устройстве.</span><span class="sxs-lookup"><span data-stu-id="32865-136">You can use an API set name in the context of a loader operation such as [LoadLibrary](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [P/Invoke](/dotnet/standard/native-interop/pinvoke) instead of a DLL module name to ensure a correct route to the implementation no matter where the API is actually implemented on the current device.</span></span> <span data-ttu-id="32865-137">Однако при этом необходимо добавить String **. dll** в конце имени контракта.</span><span class="sxs-lookup"><span data-stu-id="32865-137">However, when you do this you must append the string **.dll** at the end of the contract name.</span></span> <span data-ttu-id="32865-138">Это требование для правильной работы загрузчика и не считается частью имени контракта.</span><span class="sxs-lookup"><span data-stu-id="32865-138">This is a requirement of the loader to function properly, and is not considered actually a part of the contract name.</span></span> <span data-ttu-id="32865-139">Хотя имена контрактов похожи на имена библиотек DLL в этом контексте, они имеют фундаментальные отличия от имен модулей DLL и не ссылаются непосредственно на файл на диске.</span><span class="sxs-lookup"><span data-stu-id="32865-139">Although contract names appear similar to DLL names in this context, they are fundamentally different from DLL module names and do not directly refer to a file on disk.</span></span>

<span data-ttu-id="32865-140">За исключением добавления строки **. dll** в операции загрузчика, имена контрактов набора API должны рассматриваться как неизменяемые идентификаторы, соответствующие определенной версии контракта.</span><span class="sxs-lookup"><span data-stu-id="32865-140">Except for appending the string **.dll** in loader operations, API set contract names should be considered an immutable identifier that corresponds to a specific contract version.</span></span>

## <a name="identifying-api-sets-for-win32-apis"></a><span data-ttu-id="32865-141">Определение наборов API для API-интерфейсов Win32</span><span class="sxs-lookup"><span data-stu-id="32865-141">Identifying API sets for Win32 APIs</span></span>

<span data-ttu-id="32865-142">Чтобы определить, принадлежит ли конкретный API Win32 набору API, ознакомьтесь с таблицей требований в справочной документации по API.</span><span class="sxs-lookup"><span data-stu-id="32865-142">To identify whether a particular Win32 API belongs to an API set, review the requirements table in the reference documentation for the API.</span></span> <span data-ttu-id="32865-143">Если API принадлежит к набору API, в таблице требований в статье перечислены имя набора API и версия Windows, в которой API впервые появился в наборе API.</span><span class="sxs-lookup"><span data-stu-id="32865-143">If the API belongs to an API set, the requirements table in the article lists the API set name and the Windows version in which the API was first introduced to the API set.</span></span> <span data-ttu-id="32865-144">Примеры API-интерфейсов, принадлежащих набору API, см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="32865-144">For examples of APIs that belong to an API set, see these articles:</span></span>

- [<span data-ttu-id="32865-145">алловсетфореграундвиндов</span><span class="sxs-lookup"><span data-stu-id="32865-145">AllowSetForegroundWindow</span></span>](/windows/win32/api/winuser/nf-winuser-allowsetforegroundwindow)
- [<span data-ttu-id="32865-146">финдвиндовсекс</span><span class="sxs-lookup"><span data-stu-id="32865-146">FindWindowsEx</span></span>](/windows/win32/api/winuser/nf-winuser-findwindowexa)
- [<span data-ttu-id="32865-147">жетклассфиле</span><span class="sxs-lookup"><span data-stu-id="32865-147">GetClassFile</span></span>](/windows/win32/api/objbase/nf-objbase-getclassfile)

## <a name="in-this-section"></a><span data-ttu-id="32865-148">Содержание раздела</span><span class="sxs-lookup"><span data-stu-id="32865-148">In this section</span></span>

* [<span data-ttu-id="32865-149">Операция загрузчика набора API</span><span class="sxs-lookup"><span data-stu-id="32865-149">API set loader operation</span></span>](api-set-loader-operation.md)
* [<span data-ttu-id="32865-150">Определение доступности набора API</span><span class="sxs-lookup"><span data-stu-id="32865-150">Detect API set availability</span></span>](detect-api-set-availability.md)
* [<span data-ttu-id="32865-151">Общие библиотеки Windows</span><span class="sxs-lookup"><span data-stu-id="32865-151">Windows umbrella libraries</span></span>](windows-umbrella-libraries.md)