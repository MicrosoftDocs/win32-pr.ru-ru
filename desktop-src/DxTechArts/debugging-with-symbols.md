---
title: Отладка с использованием символов
description: В этой статье представлен общий обзор того, как лучше использовать символы в процессе отладки.
ms.assetid: 7ce0c9c7-485c-8d72-0353-27fd2e369a7c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff63e2404a07a2f0ab5adcb156d83dc989b42fd4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104533326"
---
# <a name="debugging-with-symbols"></a><span data-ttu-id="0455c-103">Отладка с использованием символов</span><span class="sxs-lookup"><span data-stu-id="0455c-103">Debugging with Symbols</span></span>

<span data-ttu-id="0455c-104">В этой статье представлен общий обзор того, как лучше использовать символы в процессе отладки.</span><span class="sxs-lookup"><span data-stu-id="0455c-104">This article provides a high level overview of how to best use symbols in your debugging process.</span></span> <span data-ttu-id="0455c-105">В нем объясняется, как использовать сервер символов Майкрософт, а также как настроить и использовать собственный частный сервер символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-105">It explains how to use the Microsoft symbol server, and also how to set up and use your own private symbol server.</span></span> <span data-ttu-id="0455c-106">Эти рекомендации помогут повысить эффективность и способность отлаживать проблемы даже в тех случаях, когда все символы и исполняемые файлы, связанные с проблемой, не находятся на компьютере.</span><span class="sxs-lookup"><span data-stu-id="0455c-106">These best practices can help increase your effectiveness and ability to debug issues, even in cases where all the symbols and executable files that are related to a problem are not located on your computer.</span></span>

-   [<span data-ttu-id="0455c-107">Символы</span><span class="sxs-lookup"><span data-stu-id="0455c-107">Symbols</span></span>](#debugging-with-symbols)
-   [<span data-ttu-id="0455c-108">Использование символов для отладки</span><span class="sxs-lookup"><span data-stu-id="0455c-108">Using Symbols for Debugging</span></span>](#using-symbols-for-debugging)
-   [<span data-ttu-id="0455c-109">Получение необходимых символов</span><span class="sxs-lookup"><span data-stu-id="0455c-109">Getting the Symbols You Need</span></span>](#getting-the-symbols-you-need)
    -   [<span data-ttu-id="0455c-110">Проверьте, соответствует ли указанная DLL-или исполняемый файл и PDB в одной папке</span><span class="sxs-lookup"><span data-stu-id="0455c-110">Check if a given DLL or .exe file and PDB in the same folder match</span></span>](#check-if-a-given-dll-or-exe-file-and-pdb-in-the-same-folder-match)
    -   [<span data-ttu-id="0455c-111">Убедитесь, что все библиотеки DLL и исполняемые файлы в наборе папок соответствуют PDB</span><span class="sxs-lookup"><span data-stu-id="0455c-111">Check if all the DLLs and executable files in a set of folders have matching PDBs</span></span>](#check-if-all-the-dlls-and-executable-files-in-a-set-of-folders-have-matching-pdbs)
    -   [<span data-ttu-id="0455c-112">Как работает симчк</span><span class="sxs-lookup"><span data-stu-id="0455c-112">How symchk Works</span></span>](#how-symchk-works)
-   [<span data-ttu-id="0455c-113">Серверы символов</span><span class="sxs-lookup"><span data-stu-id="0455c-113">Symbol Servers</span></span>](#symbol-servers)
-   [<span data-ttu-id="0455c-114">Использование сервера символов Майкрософт</span><span class="sxs-lookup"><span data-stu-id="0455c-114">Using the Microsoft Symbol Server</span></span>](#using-the-microsoft-symbol-server)
-   [<span data-ttu-id="0455c-115">Получение символов вручную</span><span class="sxs-lookup"><span data-stu-id="0455c-115">Getting Symbols Manually</span></span>](#getting-symbols-manually)
-   [<span data-ttu-id="0455c-116">Настройка сервера символов</span><span class="sxs-lookup"><span data-stu-id="0455c-116">Setting Up a Symbol Server</span></span>](#setting-up-a-symbol-server)
-   [<span data-ttu-id="0455c-117">Добавление символов на сервер символов</span><span class="sxs-lookup"><span data-stu-id="0455c-117">Adding Symbols to a Symbol Server</span></span>](#adding-symbols-to-a-symbol-server)
-   [<span data-ttu-id="0455c-118">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="0455c-118">Best Practices</span></span>](#best-practices)

## <a name="symbols"></a><span data-ttu-id="0455c-119">Символы</span><span class="sxs-lookup"><span data-stu-id="0455c-119">Symbols</span></span>

<span data-ttu-id="0455c-120">Для отладки доступен ряд различных типов символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-120">A number of different types of symbols are available for debugging.</span></span> <span data-ttu-id="0455c-121">К ним относятся Информация CodeView символы, COFF, DBG, SYM, PDB и даже экспорт символов, созданных из таблицы экспорта двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="0455c-121">They include CodeView symbols, COFF, DBG, SYM, PDB, and even export symbols that are generated from a binary files export table.</span></span> <span data-ttu-id="0455c-122">В этом техническом документе обсуждаются только VS.NET и символы формата PDB, так как они являются самыми последними Предпочтительными форматами.</span><span class="sxs-lookup"><span data-stu-id="0455c-122">This white paper discusses only VS.NET and the PDB format symbols, because they are the most recent, preferred format.</span></span> <span data-ttu-id="0455c-123">Они создаются по умолчанию для проектов, компилируемых с помощью Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0455c-123">They are generated by default for projects that are compiled by using Visual Studio.</span></span>

<span data-ttu-id="0455c-124">Создание PDB-файлов для исполняемых объектов выпуска не влияет на оптимизацию или значительно изменяет размер создаваемых файлов.</span><span class="sxs-lookup"><span data-stu-id="0455c-124">Generating PDB files for release executables does not affect any optimizations, or significantly alter the size of the generated files.</span></span> <span data-ttu-id="0455c-125">Как правило, единственным отличием является путь, а имя файла PDB-файла внедряется в исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="0455c-125">Typically, the only difference is the path, and the file name of the PDB file is embedded in the executable.</span></span> <span data-ttu-id="0455c-126">По этой причине следует всегда создавать PDB-файлы, даже если вы не хотите поставлять их вместе с исполняемым файлом.</span><span class="sxs-lookup"><span data-stu-id="0455c-126">For this reason, you should always produce PDB files, even if you don't want to ship them with the executable.</span></span>

<span data-ttu-id="0455c-127">PDB-файлы создаются, если проект строится с помощью параметра компилятора **/Zi** или **/Zi** (создание сведений о PDB), а также коммутатора компоновщика **/Debug** (создание отладочной информации).</span><span class="sxs-lookup"><span data-stu-id="0455c-127">PDB files are generated if a project is built by using the **/Zi** or **/ZI** (Produce PDB Information) compiler switch, together with the **/DEBUG** (Generate Debug Info) linker switch.</span></span> <span data-ttu-id="0455c-128">PDB-файлы, созданные компилятором, объединяются и записываются в один файл PDB, который размещается в том же каталоге, что и исполняемый объект.</span><span class="sxs-lookup"><span data-stu-id="0455c-128">The compiler-generated PDB files are combined and written into a single PDB file that is placed in the same directory as the executable.</span></span>

<span data-ttu-id="0455c-129">По умолчанию PDB-файлы содержат следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="0455c-129">By default, PDB files contain the following information:</span></span>

-   <span data-ttu-id="0455c-130">Открытые символы (обычно все функции, статические и глобальные переменные)</span><span class="sxs-lookup"><span data-stu-id="0455c-130">Public symbols (typically all functions, static and global variables)</span></span>
-   <span data-ttu-id="0455c-131">Список объектных файлов, отвечающих за разделы кода в исполняемом файле</span><span class="sxs-lookup"><span data-stu-id="0455c-131">A list of object files that are responsible for sections of code in the executable</span></span>
-   <span data-ttu-id="0455c-132">Сведения о оптимизации указателя фрейма (FPO)</span><span class="sxs-lookup"><span data-stu-id="0455c-132">Frame pointer optimization information (FPO)</span></span>
-   <span data-ttu-id="0455c-133">Сведения о имени и типе для локальных переменных и структур данных</span><span class="sxs-lookup"><span data-stu-id="0455c-133">Name and type information for local variables and data structures</span></span>
-   <span data-ttu-id="0455c-134">Сведения об исходном файле и номере строки</span><span class="sxs-lookup"><span data-stu-id="0455c-134">Source file and line number information</span></span>

<span data-ttu-id="0455c-135">Если вас интересуют сведения, использующие PDB-файл, чтобы помочь им реконструировать исполняемый файл, можно также создать файлы с удаленным PDB-файлами с помощью параметра компоновщика **/PDBSTRIPPED: filename** .</span><span class="sxs-lookup"><span data-stu-id="0455c-135">If you are concerned about people using the PDB file information to help them reverse engineer your executable, you can also generate stripped PDB files, by using the **/PDBSTRIPPED:filename** linker option.</span></span> <span data-ttu-id="0455c-136">Если у вас есть файлы PDB, из которых вы хотите удалить закрытую информацию из, можно использовать средство с именем pdbcopy, которое является частью средств отладки для Windows.</span><span class="sxs-lookup"><span data-stu-id="0455c-136">If you have existing PDB files that you would like to strip private information from, you can use a tool called pdbcopy, which is part of the debugging tools for Windows.</span></span>

<span data-ttu-id="0455c-137">По умолчанию очищенные PDB-файлы содержат следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="0455c-137">By default, stripped PDB files contain the following information:</span></span>

-   <span data-ttu-id="0455c-138">Открытые символы (обычно не статические функции и глобальные переменные)</span><span class="sxs-lookup"><span data-stu-id="0455c-138">Public symbols (typically only non-static functions and global variables)</span></span>
-   <span data-ttu-id="0455c-139">Список объектных файлов, отвечающих за разделы кода в исполняемом файле</span><span class="sxs-lookup"><span data-stu-id="0455c-139">A list of object files that are responsible for sections of code in the executable</span></span>
-   <span data-ttu-id="0455c-140">Сведения о оптимизации указателя фрейма (FPO)</span><span class="sxs-lookup"><span data-stu-id="0455c-140">Frame pointer optimization information (FPO)</span></span>

<span data-ttu-id="0455c-141">Это минимальные сведения, необходимые для обеспечения надежной отладки.</span><span class="sxs-lookup"><span data-stu-id="0455c-141">This is the minimum information that is required to allow reliable debugging.</span></span> <span data-ttu-id="0455c-142">Минимальная информация также затрудняет получение дополнительных сведений о исходном коде.</span><span class="sxs-lookup"><span data-stu-id="0455c-142">Minimum information also makes it difficult to obtain any additional information about your original source code.</span></span> <span data-ttu-id="0455c-143">Так как создается и очищенный PDB-файл, и обычный PDB-файл, можно предоставить удаленную версию пользователям, которым могут потребоваться ограниченные возможности отладки, но оставить полные файлы PDB конфиденциальными.</span><span class="sxs-lookup"><span data-stu-id="0455c-143">Because both a stripped PDB file and a regular PDB file are generated, you can provide the stripped version to users who may need limited debugging abilities, but keep the full PDBs confidential.</span></span> <span data-ttu-id="0455c-144">Обратите внимание, что **/PDBSTRIPPED** создает второй, меньший PDB-файл, поэтому при создании сборок для широкого распределения следует использовать правильный PDB-файл.</span><span class="sxs-lookup"><span data-stu-id="0455c-144">Note that **/PDBSTRIPPED** generates a second, smaller PDB file, so make sure that you use the correct PDB file when you generate builds to distribute broadly.</span></span> <span data-ttu-id="0455c-145">Для типичного проекта обычная PDB-файл может быть размером в несколько мегабайт, но удаленная версия PDB может составлять всего несколько сотен килобайт.</span><span class="sxs-lookup"><span data-stu-id="0455c-145">For a typical project, a regular PDB may be a few megabytes in size, but a stripped version of the PDB may be only a few hundred kilobytes.</span></span>

## <a name="using-symbols-for-debugging"></a><span data-ttu-id="0455c-146">Использование символов для отладки</span><span class="sxs-lookup"><span data-stu-id="0455c-146">Using Symbols for Debugging</span></span>

<span data-ttu-id="0455c-147">При отладке приложения, в котором произошел сбой, отладчик пытается отобразить в стеке функции, которые привели к сбою.</span><span class="sxs-lookup"><span data-stu-id="0455c-147">When you are debugging an application that has crashed, the debugger attempts to show you the functions on the stack that led up to the crash.</span></span> <span data-ttu-id="0455c-148">Без файла PDB отладчик не может разрешить имена функций, их параметры или любые локальные переменные, хранимые в стеке.</span><span class="sxs-lookup"><span data-stu-id="0455c-148">Without a PDB file, the debugger can not resolve the function names, their parameters, or any local variables that are stored on the stack.</span></span> <span data-ttu-id="0455c-149">При отладке 32-разрядных исполняемых файлов существуют ситуации, когда невозможно даже получить надежные трассировки стека без символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-149">If you debug 32-bit executables, there are situations where you cannot even get reliable stack traces without symbols.</span></span> <span data-ttu-id="0455c-150">Иногда можно просмотреть необработанные значения в стеке и определить, какие значения могут возвращать адреса, но они могут быть легко путают со ссылками на функции или данными.</span><span class="sxs-lookup"><span data-stu-id="0455c-150">Sometimes it's possible to look at the raw values on the stack, and work out which values might be return addresses, but these can be easily confused with function references or data.</span></span>

<span data-ttu-id="0455c-151">Если функции в текущем стеке скомпилированы с использованием оптимизации указателей на фреймы (**/Oy**), и если символы отсутствуют, отладчик не может надежно определить, какая функция вызвала текущую функцию.</span><span class="sxs-lookup"><span data-stu-id="0455c-151">If functions on the current stack were compiled by using the Omit Frame Pointers (**/Oy**) optimization, and if symbols are not present, the debugger cannot reliably determine which function called the current function.</span></span> <span data-ttu-id="0455c-152">Это связано с тем, что без сведений о оптимизации указателя кадров (FPO), содержащихся в PDB, отладчик не может полагаться на регистр указателя кадра (EBP), указывающий на сохраненный предыдущий указатель на кадр и на обратный адрес родительской функции.</span><span class="sxs-lookup"><span data-stu-id="0455c-152">This is because without the Frame Pointer Optimization (FPO) information that PDBs contain, the debugger cannot rely on the frame pointer register (EBP) to point at the saved previous frame pointer and at the return address of the parent function.</span></span> <span data-ttu-id="0455c-153">Вместо этого он догадаться.</span><span class="sxs-lookup"><span data-stu-id="0455c-153">Instead, it guesses.</span></span> <span data-ttu-id="0455c-154">Иногда он получает право.</span><span class="sxs-lookup"><span data-stu-id="0455c-154">Sometimes it gets it right.</span></span> <span data-ttu-id="0455c-155">Однако он часто получает неправильный, что может привести к неправильному получению.</span><span class="sxs-lookup"><span data-stu-id="0455c-155">However, it often gets it wrong, which can be misleading.</span></span> <span data-ttu-id="0455c-156">Если отображается предупреждение об отсутствующих символах или символы не загружены, как показано в следующем примере, не следует доверять стеку с этого момента.</span><span class="sxs-lookup"><span data-stu-id="0455c-156">If you see a warning about missing symbols, or no symbols loaded, as in the following example, do not trust the stack from that point down.</span></span>

``` syntax
SWPerfTest.exe!TextFunction(... ...)    Line 59    C++
d3dx9d.dll!008829b5()
[Frames below may be incorrect and/or missing, no symbols loaded for d3dx9d.dll]
SWPerfTest.exe!main(int argc=, const char * * argv=)  Line 328 + 0x12 bytes     C++
SWPerfTest.exe!__mainCRTStartup() Line 716 + 0x17 bytes    C
kernel32.dll!@BaseThreadInitThunk@12() + 0x12 bytes
ntdll.dll!__RtlUserThreadStart@8() + 0x27 bytes
```

<span data-ttu-id="0455c-157">Во многих случаях можно продолжить отладку без символов, так как проблема находится в расположении с точными символами, и вам не нужно просматривать функции в стеке вызовов.</span><span class="sxs-lookup"><span data-stu-id="0455c-157">In many cases, it's possible to continue debugging without symbols, because the problem is in a location that has accurate symbols, and you don't need to look at functions further down the call stack.</span></span> <span data-ttu-id="0455c-158">Даже если в библиотеке, находящихся в стеке вызовов, нет доступных PDB-файлов, при условии, что они были скомпилированы с помощью указателей на фреймы, отладчик должен иметь возможность правильно угадать в родительских функциях.</span><span class="sxs-lookup"><span data-stu-id="0455c-158">Even if a library that is in your call stack doesn't have PDBs available, as long as they were compiled with frame pointers, the debugger should be able to guess correctly at the parent functions.</span></span> <span data-ttu-id="0455c-159">Начиная с Windows XP с пакетом обновления 2 (SP2) все библиотеки DLL и исполняемые файлы Windows компилируются с отключением FPO, так как это делает отладку более точной.</span><span class="sxs-lookup"><span data-stu-id="0455c-159">Starting with Windows XP Service Pack 2, all Windows DLL and executable files are compiled with FPO disabled, because it makes debugging more accurate.</span></span> <span data-ttu-id="0455c-160">Отключение FPO также позволяет профилировщикам выборки проходить по стеку во время выполнения с минимальным влиянием на производительность.</span><span class="sxs-lookup"><span data-stu-id="0455c-160">Disabling FPO also allows sampling profilers to walk the stack during run-time, with minimal performance impact.</span></span> <span data-ttu-id="0455c-161">В версиях Windows до Windows XP с пакетом обновления 2 (SP2) для всех двоичных файлов операционной системы требуются соответствующие файлы символов, содержащие сведения о завершении, чтобы обеспечить точную отладку и профилирование.</span><span class="sxs-lookup"><span data-stu-id="0455c-161">On versions of Windows before Windows XP SP2, all operating system binaries require matching symbol files that contain FPO information, to allow accurate debugging and profiling.</span></span>

<span data-ttu-id="0455c-162">При отладке 64-разрядных машинных исполняемых файлов не требуется использовать файлы символов для создания правильных трассировок стека, так как операционная система и компиляторы x64 не требуют их.</span><span class="sxs-lookup"><span data-stu-id="0455c-162">If you debug 64-bit native executables, you do not need symbol files to produce valid stack traces, because x64 operating systems and compilers are designed not to require them.</span></span> <span data-ttu-id="0455c-163">Однако по-прежнему требуются файлы символов для получения имен функций, вызова параметров и локальных переменных.</span><span class="sxs-lookup"><span data-stu-id="0455c-163">However, you still need symbol files to retrieve the function names, call parameters and local variables.</span></span>

<span data-ttu-id="0455c-164">Однако некоторые случаи особенно сложны для отладки без символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-164">However, some cases are particularly difficult to debug without symbols.</span></span> <span data-ttu-id="0455c-165">Например, если выполняется отладка программы, для которой был создан PDB-файл, и при сбое обратного вызова из функции в библиотеке DLL, для которой отсутствуют символы, вы не сможете увидеть, какая функция вызывала обратный вызов, так как вы не сможете декодировать стек.</span><span class="sxs-lookup"><span data-stu-id="0455c-165">For example, if you debug a program for which you built a PDB file, and if you crash in a callback from a function in a DLL that you don't have symbols for, you will not be able to see which function caused the callback, because you will not be able to decode the stack.</span></span> <span data-ttu-id="0455c-166">Это часто происходит в библиотеках сторонних производителей, если PDB не предоставлены или в старых компонентах операционной системы, если PDB недоступны.</span><span class="sxs-lookup"><span data-stu-id="0455c-166">This frequently happens in third-party libraries, if PDBs are not provided, or in old operating system components, if PDBs are not available.</span></span> <span data-ttu-id="0455c-167">Обратные вызовы часто происходят во время передачи сообщения, перечисления, выделения памяти или обработки исключений.</span><span class="sxs-lookup"><span data-stu-id="0455c-167">Callbacks often happen during message passing, enumeration, memory allocation, or exception handling.</span></span> <span data-ttu-id="0455c-168">Отладка этих функций без точного стека может оказаться неприятной.</span><span class="sxs-lookup"><span data-stu-id="0455c-168">Debugging these functions without an accurate stack can be frustrating.</span></span>

<span data-ttu-id="0455c-169">Чтобы надежно выполнять отладку мини-дампов, созданных на другом компьютере или вызвавших сбой в коде, важно иметь возможность доступа ко всем символам и двоичным файлам для исполняемых файлов, на которые имеются ссылки в мини-дампе.</span><span class="sxs-lookup"><span data-stu-id="0455c-169">To reliably debug mini-dumps that are generated on a different computer, or that crashed in code that you do not own, it's important to be able to access all the symbols and binaries for the executables that are referenced in the mini-dump.</span></span> <span data-ttu-id="0455c-170">Если символы и двоичные файлы доступны на сервере символов, они автоматически получаются отладчиком.</span><span class="sxs-lookup"><span data-stu-id="0455c-170">If the symbols and binaries are available from a symbol server, they are automatically obtained by the debugger.</span></span> <span data-ttu-id="0455c-171">Дополнительные сведения о мини-дампах см. в техническом документе [анализ аварийного дампа](/windows/desktop/DxTechArts/crash-dump-analysis) .</span><span class="sxs-lookup"><span data-stu-id="0455c-171">For more information on mini-dumps, see the [Crash Dump Analysis](/windows/desktop/DxTechArts/crash-dump-analysis) white paper.</span></span>

## <a name="getting-the-symbols-you-need"></a><span data-ttu-id="0455c-172">Получение необходимых символов</span><span class="sxs-lookup"><span data-stu-id="0455c-172">Getting the Symbols You Need</span></span>

<span data-ttu-id="0455c-173">Visual Studio и другие отладчики Майкрософт, такие как WinDbg, обычно настроены на работу только при создании приложения и его отладке на собственном компьютере.</span><span class="sxs-lookup"><span data-stu-id="0455c-173">Visual Studio and other Microsoft debuggers, such as WinDbg, are typically set up to just work if you are building an application and debugging it on your own computer.</span></span> <span data-ttu-id="0455c-174">Если вам нужно передать исполняемый файл другому пользователю, при наличии на компьютере нескольких версий библиотеки DLL или EXE-файла или при необходимости точной отладки приложения, использующего Windows или другие библиотеки, такие как DirectX, необходимо понимать, как отладчики могут находить и загружать символы.</span><span class="sxs-lookup"><span data-stu-id="0455c-174">If you need to give your executable to someone else, if you have multiple versions of a DLL or an .exe file on your computer, or if you want to accurately debug an application that uses Windows or other libraries, such as DirectX, you need to understand how debuggers find and load symbols.</span></span> <span data-ttu-id="0455c-175">Отладчик использует либо путь поиска символов, заданный пользователем, который находится в параметрах \\ Отладка \\ символов в Visual Studio, либо \_ \_ \_ переменная среды PATH символов NT.</span><span class="sxs-lookup"><span data-stu-id="0455c-175">The debugger uses either the symbol search path that is specified by the user—which is found in Options\\Debugging\\Symbols in Visual Studio—or the \_NT\_SYMBOL\_PATH environment variable.</span></span> <span data-ttu-id="0455c-176">Как правило, отладчик выполняет поиск соответствующих PDB в следующих расположениях:</span><span class="sxs-lookup"><span data-stu-id="0455c-176">Typically, the debugger searches for matching PDBs in the following locations:</span></span>

-   <span data-ttu-id="0455c-177">Расположение, указанное в библиотеке DLL или в исполняемом файле.</span><span class="sxs-lookup"><span data-stu-id="0455c-177">The location that is specified inside the DLL or the executable file.</span></span>

    <span data-ttu-id="0455c-178">Если на компьютере была создана библиотека DLL или исполняемый файл, по умолчанию компоновщик поместит полный путь и имя файла соответствующего PDB-файла в библиотеку DLL или исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="0455c-178">If you have built a DLL or an executable file on your computer, by default the linker places the full path and file name of the associated PDB file inside the DLL or the executable file.</span></span> <span data-ttu-id="0455c-179">При отладке отладчик сначала проверяет, существует ли файл символов в расположении, указанном в библиотеке DLL или в исполняемом файле.</span><span class="sxs-lookup"><span data-stu-id="0455c-179">When you debug, the debugger first checks to see if the symbol file exists in the location that is specified inside the DLL or the executable file.</span></span> <span data-ttu-id="0455c-180">Это полезно, так как у вас всегда есть символы, доступные для кода, скомпилированного на компьютере.</span><span class="sxs-lookup"><span data-stu-id="0455c-180">This is helpful, because you always have symbols available for code that you have compiled on your computer.</span></span>

-   <span data-ttu-id="0455c-181">PDB, которые могут присутствовать в одной папке с библиотекой DLL или исполняемым файлом.</span><span class="sxs-lookup"><span data-stu-id="0455c-181">PDBs that may be present in the same folder as the DLL or executable file.</span></span>
-   <span data-ttu-id="0455c-182">Все папки локального кэша символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-182">Any local symbol cache folders.</span></span>
-   <span data-ttu-id="0455c-183">Любые серверы символов локальной сетевой папки.</span><span class="sxs-lookup"><span data-stu-id="0455c-183">Any local network file share symbol servers.</span></span>
-   <span data-ttu-id="0455c-184">Любые серверы символов Интернета, например Microsoft Symbol Server.</span><span class="sxs-lookup"><span data-stu-id="0455c-184">Any Internet symbol servers, such as the Microsoft symbol server.</span></span>

<span data-ttu-id="0455c-185">Чтобы убедиться в наличии всех PDB, необходимых для точной отладки, установите средства отладки для Windows.</span><span class="sxs-lookup"><span data-stu-id="0455c-185">To make sure that you have all the PDBs that you need for accurate debugging, install the debugging tools for Windows.</span></span> <span data-ttu-id="0455c-186">Битовые версии 32 и 64 можно найти в [средствах отладки для Windows](/windows-hardware/drivers/debugger/).</span><span class="sxs-lookup"><span data-stu-id="0455c-186">The 32 and 64 bit versions can be found at [Debugging Tools for Windows](/windows-hardware/drivers/debugger/).</span></span>

<span data-ttu-id="0455c-187">Полезным средством, устанавливаемым с этим пакетом, является symchk.exe.</span><span class="sxs-lookup"><span data-stu-id="0455c-187">A useful tool that is installed with this package is symchk.exe.</span></span> <span data-ttu-id="0455c-188">Он может помочь определить отсутствующие или неверные символы.</span><span class="sxs-lookup"><span data-stu-id="0455c-188">It can help to identify missing or incorrect symbols.</span></span> <span data-ttu-id="0455c-189">Это средство имеет большое количество возможных параметров командной строки.</span><span class="sxs-lookup"><span data-stu-id="0455c-189">This tool has a large number of potential command line options.</span></span> <span data-ttu-id="0455c-190">Ниже приведены две из наиболее полезных и часто используемых.</span><span class="sxs-lookup"><span data-stu-id="0455c-190">Here are two of the more useful and commonly used ones.</span></span>

### <a name="check-if-a-given-dll-or-exe-file-and-pdb-in-the-same-folder-match"></a><span data-ttu-id="0455c-191">Проверьте, соответствует ли указанная DLL-или исполняемый файл и PDB в одной папке</span><span class="sxs-lookup"><span data-stu-id="0455c-191">Check if a given DLL or .exe file and PDB in the same folder match</span></span>

``` syntax
"c:\Program Files\Debugging Tools for Windows\symchk" testing.dll /s

SYMCHK: FAILED files = 0
SYMCHK: PASSED + IGNORED files = 1
```

<span data-ttu-id="0455c-192">Параметр **/s** указывает **симчк** искать символы только в текущей папке, а не на серверах символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-192">The **/s** option tells **symchk** to look for symbols only in the current folder, and not to look in any symbol servers.</span></span>

### <a name="check-if-all-the-dlls-and-executable-files-in-a-set-of-folders-have-matching-pdbs"></a><span data-ttu-id="0455c-193">Убедитесь, что все библиотеки DLL и исполняемые файлы в наборе папок соответствуют PDB</span><span class="sxs-lookup"><span data-stu-id="0455c-193">Check if all the DLLs and executable files in a set of folders have matching PDBs</span></span>

``` syntax
"c:\Program Files\Debugging Tools for Windows\symchk" *.* /r
```

<span data-ttu-id="0455c-194">Параметр **/r** задает **симчк** для рекурсивного прохода по папкам, чтобы убедиться, что все исполняемые файлы имеют совпадающие PDB.</span><span class="sxs-lookup"><span data-stu-id="0455c-194">The **/r** option sets **symchk** to recursively traverse through folders, to check that all the executable files have matching PDBs.</span></span> <span data-ttu-id="0455c-195">Без параметра **/s** **симчк** использует текущий \_ \_ путь к символам NT \_ для поиска символов на любом частном или локальном сервере или на серверах символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-195">Without the **/s** option, **symchk** uses the current \_NT\_SYMBOL\_PATH to search for symbols on any private or local server, or on the Microsoft symbol servers.</span></span> <span data-ttu-id="0455c-196">Средство **симчк** выполняет поиск только символов для исполняемых файлов (exe, DLL и т. д.).</span><span class="sxs-lookup"><span data-stu-id="0455c-196">The **symchk** tool searches only for symbols for executable files (.exe, .dll, and similar).</span></span> <span data-ttu-id="0455c-197">Подстановочные знаки нельзя использовать для поиска символов в неисполняемых файлах.</span><span class="sxs-lookup"><span data-stu-id="0455c-197">You cannot use wild cards search for symbols for non-executable files.</span></span>

### <a name="how-symchk-works"></a><span data-ttu-id="0455c-198">Как работает симчк</span><span class="sxs-lookup"><span data-stu-id="0455c-198">How symchk Works</span></span>

<span data-ttu-id="0455c-199">При формировании компоновщиком DLL, исполняемых и PDB-файлов в каждом файле хранятся идентичные идентификаторы GUID.</span><span class="sxs-lookup"><span data-stu-id="0455c-199">When the linker generates .dll, executable, and PDB files, it stores identical GUIDs in each file.</span></span> <span data-ttu-id="0455c-200">Идентификатор GUID используется средствами для определения того, соответствует ли указанный PDB-файл библиотеке DLL или исполняемому файлу.</span><span class="sxs-lookup"><span data-stu-id="0455c-200">The GUID is used by tools to determine if a given PDB file matches a DLL or an executable file.</span></span> <span data-ttu-id="0455c-201">Если вы изменяете библиотеку DLL или исполняемый файл с помощью редактора ресурсов или шифрования для защиты от копирования или изменяете сведения о версии, идентификатор GUID обновляется, и отладчик не может загрузить PDB-файл.</span><span class="sxs-lookup"><span data-stu-id="0455c-201">If you alter a DLL or an executable file—by using a resource editor or copy protection encoding, or by altering its version information—the GUID is updated and the debugger cannot load the PDB file.</span></span> <span data-ttu-id="0455c-202">По этой причине очень важно избегать управления библиотекой DLL или исполняемым файлом после его создания компоновщиком.</span><span class="sxs-lookup"><span data-stu-id="0455c-202">For this reason, it's very important to avoid manipulating the DLL or executable file after it is created by the linker.</span></span>

<span data-ttu-id="0455c-203">Вы также можете использовать служебную программу DUMPBIN, поставляемую вместе с VS.NET, чтобы показать пути к символам, в которых выполняется поиск, и определить, найдены ли файлы символов, соответствующие заданной библиотеке DLL или исполняемому файлу.</span><span class="sxs-lookup"><span data-stu-id="0455c-203">You can also use the DUMPBIN utility that comes with VS.NET to show the symbol paths that are searched, and to see if symbol files are found that match a given DLL or executable file.</span></span> <span data-ttu-id="0455c-204">Пример:</span><span class="sxs-lookup"><span data-stu-id="0455c-204">For example:</span></span>

``` syntax
DUMPBIN /PDBPATH:VERBOSE filename.exe
```

## <a name="symbol-servers"></a><span data-ttu-id="0455c-205">Серверы символов</span><span class="sxs-lookup"><span data-stu-id="0455c-205">Symbol Servers</span></span>

<span data-ttu-id="0455c-206">Сервер символов — это репозиторий для нескольких версий исполняемого файла и файлов символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-206">A symbol server is a repository for multiple versions of executable and symbol files.</span></span> <span data-ttu-id="0455c-207">Он содержит либо сами файлы символов, либо ссылки на соответствующие файлы символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-207">It contains either the symbol files themselves, or pointers to the associated symbol files.</span></span> <span data-ttu-id="0455c-208">Отладчики понимают, как использовать серверы символов и могут использовать их для поиска отсутствующих или неизвестных символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-208">Debuggers understand how to use symbol servers, and can use them to search for missing or unknown symbols.</span></span>

<span data-ttu-id="0455c-209">DLL и исполняемые файлы также доступны на сервере символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-209">DLL and executable files are also available from the Microsoft symbol server.</span></span> <span data-ttu-id="0455c-210">Это позволяет отлаживать сбои и проверять код для файлов операционной системы, которые могут отсутствовать на компьютере.</span><span class="sxs-lookup"><span data-stu-id="0455c-210">This makes it possible to debug crashes and examine code for operating system files that may not exist on your machine.</span></span> <span data-ttu-id="0455c-211">Если отладчик обнаруживает исполняемый файл или библиотеку DLL, которая не существует в системе, используемой для отладки, она автоматически запрашивает как символы, так и копию двоичного файла на серверах символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-211">If a debugger encounters an executable file or a DLL that does not exist on the system that you are using for debugging, it automatically requests both the symbols and a copy of the binary file from the Microsoft symbol servers.</span></span> <span data-ttu-id="0455c-212">Это полезно при отладке компонента, имеющего много версий, например msvcrt.dll, и необходимо изучить код для версии, которая не существует на компьютере.</span><span class="sxs-lookup"><span data-stu-id="0455c-212">This is helpful if you are debugging a component that has many versions—for example, msvcrt.dll—and you need to examine the code for a version that does not exist on your computer.</span></span> <span data-ttu-id="0455c-213">Это также помогает отлаживать Мини-дампы, созданные в операционной системе, отличной от системы, используемой для отладки.</span><span class="sxs-lookup"><span data-stu-id="0455c-213">This also helps debug mini-dumps that are generated on an operating system that is different from the system that you are using for debugging.</span></span>

<span data-ttu-id="0455c-214">Корпорация Майкрософт публикует все PDB-файлы для всех операционных систем и других перераспределенных компонентов, таких как пакет SDK DirectX, на внешнем доступном сервере символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-214">Microsoft publishes all the PDB files for all operating systems and other redistributed components, such as the DirectX SDK, on its externally accessible symbol server.</span></span> <span data-ttu-id="0455c-215">Это упрощает отладку приложения, использующего эти библиотеки DLL или исполняемые файлы.</span><span class="sxs-lookup"><span data-stu-id="0455c-215">This makes it easy to debug an application that uses these DLL or executable files.</span></span> <span data-ttu-id="0455c-216">Сервер символов Майкрософт можно использовать для разрешения символов вместе с любыми локальными символами для компонентов, созданных на компьютере.</span><span class="sxs-lookup"><span data-stu-id="0455c-216">You can use the Microsoft symbol server to resolve symbols, together with any local symbols for components that were built on your computer.</span></span>

<span data-ttu-id="0455c-217">Можно настроить компьютер для использования сервера символов Майкрософт, который предоставляет доступ ко всем файлам символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-217">You can set up your computer to use the Microsoft symbol server, which gives you access to all Microsoft symbol files.</span></span> <span data-ttu-id="0455c-218">Можно также настроить частный сервер символов для вашей компании, группы или сети, который можно использовать для хранения нескольких более ранних версий проекта, над которым вы работаете, или для предоставления локального кэша для символов, используемых на сервере символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-218">You can also set up a private symbol server for your company, team or network, which can be used to store multiple older versions of a project you are working on, or to provide a local cache for the symbols that you use from the Microsoft symbol server.</span></span>

<span data-ttu-id="0455c-219">Чтобы использовать сервер символов, укажите путь поиска в переменной среды, которая называется « \_ \_ путь к символам NT» \_ .</span><span class="sxs-lookup"><span data-stu-id="0455c-219">To use a symbol server, specify the search path in an environment variable that is called \_NT\_SYMBOL\_PATH.</span></span> <span data-ttu-id="0455c-220">Отладчики и современные средства, такие как WinDbg, NTSD или Visual Studio, автоматически используют этот путь для поиска символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-220">Debuggers and modern tools, such as WinDbg, NTSD or Visual Studio, automatically use this path to search for symbols.</span></span>

<span data-ttu-id="0455c-221">Когда отладчик выполняет поиск символов, он сначала выполняет поиск в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="0455c-221">When a debugger searches for symbols, it first searches locally.</span></span> <span data-ttu-id="0455c-222">Затем он выполняет поиск на серверах символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-222">Then it looks on symbol servers.</span></span> <span data-ttu-id="0455c-223">При обнаружении совпадающего символа он передает файл символов в локальный кэш.</span><span class="sxs-lookup"><span data-stu-id="0455c-223">When it finds a matching symbol, it transfers the symbol file to your local cache.</span></span> <span data-ttu-id="0455c-224">Символы для типовой библиотеки DLL или исполняемого файла, размер которых составляет от 1 до 100 МБ.</span><span class="sxs-lookup"><span data-stu-id="0455c-224">The symbols for a typical DLL or executable file range from 1 to 100 MB in size.</span></span> <span data-ttu-id="0455c-225">Поэтому при отладке процесса, включающего множество библиотек DLL, может потребоваться некоторое время для разрешения всех символов и их перемещения в локальный кэш.</span><span class="sxs-lookup"><span data-stu-id="0455c-225">Therefore, if you are debugging a process that includes many DLLs, it can take some time to resolve all the symbols and transfer them to a local cache.</span></span>

## <a name="using-the-microsoft-symbol-server"></a><span data-ttu-id="0455c-226">Использование сервера символов Майкрософт</span><span class="sxs-lookup"><span data-stu-id="0455c-226">Using the Microsoft Symbol Server</span></span>

<span data-ttu-id="0455c-227">Сервер символов Майкрософт позволяет получить все последние символы, включая символы для исправленных или обновленных файлов.</span><span class="sxs-lookup"><span data-stu-id="0455c-227">The Microsoft symbol server allows you to obtain all the latest symbols, including symbols for patched or updated files.</span></span> <span data-ttu-id="0455c-228">Сервер символов Майкрософт доступен по адресу <https://msdl.microsoft.com/download/symbols> .</span><span class="sxs-lookup"><span data-stu-id="0455c-228">The Microsoft symbol server is available at <https://msdl.microsoft.com/download/symbols>.</span></span>

<span data-ttu-id="0455c-229">Доступ к серверу символов можно получить одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="0455c-229">You can access the symbol server in one of the following ways:</span></span>

-   <span data-ttu-id="0455c-230">Введите адрес сервера напрямую.</span><span class="sxs-lookup"><span data-stu-id="0455c-230">Enter the server address directly.</span></span> <span data-ttu-id="0455c-231">В Visual Studio в меню **Сервис** выберите **Параметры**, затем **Отладка**, а затем выберите **символы**.</span><span class="sxs-lookup"><span data-stu-id="0455c-231">In Visual Studio, from the **Tools** menu, choose **Options**, then choose **Debugging**, and then choose **Symbols**.</span></span>
-   <span data-ttu-id="0455c-232">Используйте переменную среды \_ \_ путь к символам NT \_ .</span><span class="sxs-lookup"><span data-stu-id="0455c-232">Use the environment variable \_NT\_SYMBOL\_PATH.</span></span> <span data-ttu-id="0455c-233">Рекомендуется использовать этот метод.</span><span class="sxs-lookup"><span data-stu-id="0455c-233">We recommend this method.</span></span>

    <span data-ttu-id="0455c-234">Это используется всеми средствами отладки.</span><span class="sxs-lookup"><span data-stu-id="0455c-234">This is used by all debugging tools.</span></span> <span data-ttu-id="0455c-235">Она также используется в Visual Studio и считывается и декодирована при открытии Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0455c-235">It is also used by Visual Studio, and is read and decoded when Visual Studio opens.</span></span> <span data-ttu-id="0455c-236">Поэтому, если вы измените его, необходимо перезапустить Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0455c-236">Therefore, if you change it, you need to restart Visual Studio.</span></span>

    <span data-ttu-id="0455c-237">Эта переменная среды позволяет указать несколько серверов символов, например внутренний частный сервер символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-237">This environment variable allows you to specify multiple symbol servers—for example, an internal private symbol server.</span></span> <span data-ttu-id="0455c-238">Он также позволяет указать каталог локального кэша для хранения PDB-файлов для всех символов, которые вы ищете на серверах символов — как внутри, так и через Интернет.</span><span class="sxs-lookup"><span data-stu-id="0455c-238">It also allows you to specify a local cache directory to store PDBs for all symbols that you look up from symbol servers, both internally and over the Internet.</span></span>

<span data-ttu-id="0455c-239">Для \_ \_ переменной пути к символам NT используется следующий синтаксис \_ :</span><span class="sxs-lookup"><span data-stu-id="0455c-239">The syntax for the \_NT\_SYMBOL\_PATH variable is:</span></span>

``` syntax
srv*[local cache]*[private symbol server]*https://msdl.microsoft.com/download/symbols
```

<span data-ttu-id="0455c-240">Замените \[ локальный кэш \] именем каталога на компьютере, где будет храниться кэш любых используемых символов, например% systemroot% \\ SYMBOLS или c: \\ SYMBOLS.</span><span class="sxs-lookup"><span data-stu-id="0455c-240">Replace \[local cache\] with the name of a directory on your computer where you want to store a cache of any symbols used—for example, %SYSTEMROOT%\\Symbols, or c:\\symbols.</span></span>

<span data-ttu-id="0455c-241">\[Частный сервер символов \] является необязательным.</span><span class="sxs-lookup"><span data-stu-id="0455c-241">The \[private symbol server\] is optional.</span></span> <span data-ttu-id="0455c-242">Он может указывать на сервер символов, расположенный в сети, или на сервер символов, который совместно используется вашей командой, группой продуктов или компанией.</span><span class="sxs-lookup"><span data-stu-id="0455c-242">It can point to a symbol server that is located on your network, or it can point to a symbol server that is shared by your team, product group, or company.</span></span>

<span data-ttu-id="0455c-243">Чтобы использовать только сервер символов Майкрософт вместе с локальным кэшем символов, чтобы ускорить доступ через Интернет, используйте следующий параметр для \_ \_ пути к символам NT \_ :</span><span class="sxs-lookup"><span data-stu-id="0455c-243">To use only the Microsoft symbol server together with a local cache of symbols, to speed up access over the Internet, use the following setting for \_NT\_SYMBOL\_PATH:</span></span>

``` syntax
srv*c:\symbols*https://msdl.microsoft.com/download/symbols
```

<span data-ttu-id="0455c-244">Другие параметры для \_ \_ пути к символам NT можно найти \_ в файле справки, который устанавливается вместе с пакетом средств отладки Microsoft для Windows.</span><span class="sxs-lookup"><span data-stu-id="0455c-244">You can find other options for the \_NT\_SYMBOL\_PATH in the help file that is installed with the Microsoft Debugging Tools for Windows package.</span></span>

<span data-ttu-id="0455c-245">Исполняемые файлы без символов могут увеличить время, затрачиваемое на запуск отладчика, если используется сервер символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-245">Executables without symbols can increase the time it takes to launch a debugger if you use a symbol server.</span></span> <span data-ttu-id="0455c-246">Это происходит потому, что отладчик запрашивает сервер символов каждый раз при попытке загрузить исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="0455c-246">This is because the debugger queries the symbol server each time it tries to load the executable.</span></span> <span data-ttu-id="0455c-247">По этой причине лучше всегда запрашивать символы для всех компонентов.</span><span class="sxs-lookup"><span data-stu-id="0455c-247">For this reason, it is best to always request symbols for all components.</span></span>

<span data-ttu-id="0455c-248">Может оказаться невозможным запрашивать символы для каждого компонента — например, видеодрайверы могут иметь библиотеки DLL в пространстве процесса, а необходимые PDB-файлы доступны на сервере символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-248">It may not be possible to request symbols for every component—for example, video drivers may have DLLs in your process space, and the required PDB files are available on the Microsoft symbol server.</span></span> <span data-ttu-id="0455c-249">В этом случае при запуске сеанса отладки возникает небольшая задержка.</span><span class="sxs-lookup"><span data-stu-id="0455c-249">In this case, there is a small delay when you start a debugging session.</span></span>

<span data-ttu-id="0455c-250">Чтобы избежать такой небольшой задержки, можно запустить отладчик один раз, чтобы кэшировать все символы локально с сервера символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-250">To avoid even this small delay, you can run the debugger once, to cache all the symbols locally from the Microsoft symbol server.</span></span> <span data-ttu-id="0455c-251">Затем измените путь к \_ \_ символам NT, \_ чтобы удалить сервер символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-251">Then, modify your \_NT\_SYMBOL\_PATH to remove the Microsoft symbol server.</span></span> <span data-ttu-id="0455c-252">Если исполняемые файлы не изменяются, для проверки исполняемых файлов, не имеющих символов, запрос через Интернет не потребуется, так как у вас есть локальные кэшированные копии всех символов, необходимых на сервере символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-252">Unless the executable files change, checks for executable files that do not have symbols will not require a query over the Internet, because you have local cached copies of all the symbols that you need from the Microsoft symbol server.</span></span>

## <a name="getting-symbols-manually"></a><span data-ttu-id="0455c-253">Получение символов вручную</span><span class="sxs-lookup"><span data-stu-id="0455c-253">Getting Symbols Manually</span></span>

<span data-ttu-id="0455c-254">Если отладчик настроен правильно, он автоматически загружает все необходимые символы из локального кэша или с сервера символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-254">If you have set up your debugger correctly, it automatically loads any symbols that it requires from your local cache or from a symbol server.</span></span> <span data-ttu-id="0455c-255">Если вы хотите получить символы только для одного исполняемого файла или для папки исполняемых файлов, можно использовать **симчк**.</span><span class="sxs-lookup"><span data-stu-id="0455c-255">If you would like to get the symbols for just a single executable, or for a folder of executables, you can use **symchk**.</span></span> <span data-ttu-id="0455c-256">Например, если вы хотите загрузить символы для \_ файла d3dx930.dll в системной папке Windows в текущий каталог, можно использовать следующую команду:</span><span class="sxs-lookup"><span data-stu-id="0455c-256">For example, if you want to download the symbols for the d3dx9\_30.dll file in the Windows System folder into the current directory, you can use the following command:</span></span>

``` syntax
"c:\Program Files\Debugging Tools for Windows\symchk" c:\Windows\System32\d3dx9_30.dll /oc \.
```

<span data-ttu-id="0455c-257">Средство **симчк** имеет много других целей.</span><span class="sxs-lookup"><span data-stu-id="0455c-257">The **symchk** tool has many other uses.</span></span> <span data-ttu-id="0455c-258">Дополнительные сведения см. в разделе **симчк/?** или в документации по средствам отладки Microsoft для Windows.</span><span class="sxs-lookup"><span data-stu-id="0455c-258">For details, see **symchk /?**, or look in the Microsoft Debugging Tools for Windows documentation.</span></span>

## <a name="setting-up-a-symbol-server"></a><span data-ttu-id="0455c-259">Настройка сервера символов</span><span class="sxs-lookup"><span data-stu-id="0455c-259">Setting Up a Symbol Server</span></span>

<span data-ttu-id="0455c-260">Настройка сервера символов очень проста.</span><span class="sxs-lookup"><span data-stu-id="0455c-260">Setting up a symbol server is very simple.</span></span> <span data-ttu-id="0455c-261">Это полезно по следующим причинам.</span><span class="sxs-lookup"><span data-stu-id="0455c-261">It is useful for the following reasons:</span></span>

-   <span data-ttu-id="0455c-262">Для экономии пропускной способности или ускорения разрешения символов для вашей компании, группы или продукта.</span><span class="sxs-lookup"><span data-stu-id="0455c-262">To save bandwidth, or to speed up symbol resolution for your company, team or product.</span></span> <span data-ttu-id="0455c-263">Внутренний сервер символов на локальном файловом ресурсе в сети кэширует все ссылки на внешние серверы символов, такие как Microsoft Symbol Server.</span><span class="sxs-lookup"><span data-stu-id="0455c-263">An internal symbol server on a local file share on your network caches any references to external symbol servers, such as the Microsoft symbol server.</span></span> <span data-ttu-id="0455c-264">Доступ к локальному или внутреннему серверу символов можно быстро получить одновременно несколькими людьми.</span><span class="sxs-lookup"><span data-stu-id="0455c-264">A local or internal symbol server can be accessed quickly by many people at the same time.</span></span> <span data-ttu-id="0455c-265">Поэтому он экономит пропускную способность и задержку, с которой могут создаваться дублирующие запросы символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-265">Therefore, it saves bandwidth and the latency that duplicate symbol requests can create.</span></span>
-   <span data-ttu-id="0455c-266">Для хранения символов для старых сборок, версий или внешних выпусков приложения.</span><span class="sxs-lookup"><span data-stu-id="0455c-266">To store symbols for old builds, versions or external releases of your application.</span></span> <span data-ttu-id="0455c-267">Хранение символов для этих сборок на сервере символов, к которому можно легко получить доступ, позволяет отлаживать сбои и проблемы в этих сборках на любом компьютере с отладчиком и подключением к локальному серверу символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-267">By storing the symbols for these builds on a symbol server that you can easily access, you can debug crashes and problems in these builds on any computer that has a debugger and a connection to the local symbol server.</span></span> <span data-ttu-id="0455c-268">Это особенно полезно при отладке мини-дампов, созданных исполняемыми файлами, которые не были построены самостоятельно, то есть сборками, созданными другим программистом или компьютером сборки.</span><span class="sxs-lookup"><span data-stu-id="0455c-268">This is particularly useful if you debug mini-dumps that are generated by executables that you did not build yourself—that is, builds that were generated by another programmer or by a build machine.</span></span> <span data-ttu-id="0455c-269">Если символы для этих сборок хранятся на сервере символов, вы получите надежную и точную отладку.</span><span class="sxs-lookup"><span data-stu-id="0455c-269">If the symbols for these builds are stored on your symbol server, you will have reliable and accurate debugging.</span></span>
-   <span data-ttu-id="0455c-270">Для обновления символов в актуальном состоянии.</span><span class="sxs-lookup"><span data-stu-id="0455c-270">To keep symbols up to date.</span></span> <span data-ttu-id="0455c-271">При обновлении компонентов, таких как компоненты ОС, измененные Центр обновления Windows или пакетом SDK DirectX, можно по-прежнему выполнять отладку с использованием всех последних символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-271">When components are updated, such as OS components that are modified by Windows Update or by the DirectX SDK, you can still debug by using all the latest symbols.</span></span>

<span data-ttu-id="0455c-272">Настройка сервера символов в собственной локальной сети — это просто создание общей папки на сервере и предоставление пользователям полных разрешений на доступ к общей папке для создания файлов и папок.</span><span class="sxs-lookup"><span data-stu-id="0455c-272">Setting up a symbol server on your own local network is as simple as creating a file share on a server and giving users full permissions to access the share, to create files and folders.</span></span> <span data-ttu-id="0455c-273">Эта общая папка должна быть создана в серверной операционной системе, такой как Windows Server 2003, чтобы количество пользователей, которые могут одновременно получить доступ к ней, не ограничено.</span><span class="sxs-lookup"><span data-stu-id="0455c-273">This share should be created on a server operating system, such as Windows Server 2003, so that the number of people who can access the share simultaneously is not limited.</span></span>

<span data-ttu-id="0455c-274">Например, если вы настроили общую папку на \\ \\ mainserver- \\ символах, члены вашей команды настроили \_ \_ путь к символам NT \_ следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0455c-274">For example, if you set up a file share on \\\\mainserver\\symbols, then the members of your team set the \_NT\_SYMBOL\_PATH to the following:</span></span>

``` syntax
Srv*c:\symbols*\\mainserver\symbols*https://msdl.microsoft.com/download/symbols
```

<span data-ttu-id="0455c-275">По мере извлечения символов файлы и папки отображаются в \\ \\ \\ общем каталоге mainserver Symbols, а также в отдельных кэшах в каталоге c: \\ SYMBOLS.</span><span class="sxs-lookup"><span data-stu-id="0455c-275">As symbols are retrieved, files and folders appear in the \\\\mainserver\\symbols shared directory, as well as in individual caches, in the c:\\symbols directory.</span></span>

<span data-ttu-id="0455c-276">Обычно это все, что необходимо для настройки и использования собственного сервера символов или сервера символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-276">This is typically all that is involved in setting up and using either your own symbol server, or the Microsoft symbol server.</span></span>

## <a name="adding-symbols-to-a-symbol-server"></a><span data-ttu-id="0455c-277">Добавление символов на сервер символов</span><span class="sxs-lookup"><span data-stu-id="0455c-277">Adding Symbols to a Symbol Server</span></span>

<span data-ttu-id="0455c-278">Чтобы добавить, удалить или изменить файлы в общей папке сервера символов, используйте средство symstore.exe.</span><span class="sxs-lookup"><span data-stu-id="0455c-278">To add, delete or edit files on a symbol server share, use the symstore.exe tool.</span></span> <span data-ttu-id="0455c-279">Это средство является частью пакета средств отладки Microsoft для Windows.</span><span class="sxs-lookup"><span data-stu-id="0455c-279">This tool is part of the Microsoft Debugging Tools for Windows package.</span></span> <span data-ttu-id="0455c-280">Полная документация по серверам символов, средству SymStore и индексированию символов включена в пакет средств отладки для Windows.</span><span class="sxs-lookup"><span data-stu-id="0455c-280">Full documentation on symbol servers, the symstore tool, and indexing symbols is included in the Debugging Tools for Windows package.</span></span>

<span data-ttu-id="0455c-281">Вам может потребоваться добавить символы непосредственно на собственный сервер символов в рамках процесса сборки или сделать символы доступными для всей команды для библиотек или средств сторонних разработчиков.</span><span class="sxs-lookup"><span data-stu-id="0455c-281">You may want to add symbols directly to your own symbol server, as part of a build process, or to make symbols available to your whole team for third-party libraries or tools.</span></span> <span data-ttu-id="0455c-282">Процесс добавления символа в файловый ресурс сервера символов называется индексированием символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-282">The process of adding a symbol to a symbol server file share is called indexing symbols.</span></span> <span data-ttu-id="0455c-283">Существует два распространенных способа индексирования символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-283">There are two common ways to index symbols.</span></span> <span data-ttu-id="0455c-284">Файл символов можно скопировать на сервер символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-284">A symbol file can be copied to the symbol server.</span></span> <span data-ttu-id="0455c-285">Или указатель на расположение символа можно скопировать на сервер символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-285">Or, a pointer to the location of the symbol can be copied to the symbol server.</span></span> <span data-ttu-id="0455c-286">Если у вас есть архивная папка, содержащая старые сборки, может потребоваться индексировать указатели на PDB-файлы, которые уже находятся в общей папке, вместо дублирования символов.</span><span class="sxs-lookup"><span data-stu-id="0455c-286">If you have an archive folder that contains your old builds, you may want to index pointers to the PDB files that are already on the share, instead of duplicating symbols.</span></span> <span data-ttu-id="0455c-287">Так как символы иногда могут быть десятками мегабайт, рекомендуется заранее спланировать объем пространства, которое может потребоваться для архивации всех сборок проекта в ходе разработки.</span><span class="sxs-lookup"><span data-stu-id="0455c-287">Because symbols can sometimes be tens of megabytes in size, it's a good idea to plan ahead for how much space you may require to archive all the builds of your project throughout development.</span></span> <span data-ttu-id="0455c-288">При индексировании только указателей на символы могут возникнуть проблемы при удалении старых сборок или изменении имени общей папки.</span><span class="sxs-lookup"><span data-stu-id="0455c-288">If you index only pointers to symbols, you may have problems if you remove old builds, or change the name of a file share.</span></span>

<span data-ttu-id="0455c-289">Например, для рекурсивного индексирования всех символов в c: \\ дкссим \\ Дополнительные \\ символы, полученные из пакета SDK DirectX за Октябрь 2006, на файловый ресурс сервера символов, именуемый \\ \\ \\ символами mainserver, можно использовать следующую команду:</span><span class="sxs-lookup"><span data-stu-id="0455c-289">For example, to index recursively all the symbols in c:\\dxsym\\Extras\\Symbols that you obtained from the October 2006 DirectX SDK onto a symbol server file share called \\\\mainserver\\symbols, you can use the following command:</span></span>

``` syntax
"c:\Program Files\Debugging Tools for Windows\symstore" add /f "C:\dxsym\Extras\Symbols\*.pdb"
/s \\mainserver\symbols /t "October 2006 DirectX SDK " /r
```

<span data-ttu-id="0455c-290">Параметр **/t "Comment"** используется для добавления описания транзакции, которая добавила символы.</span><span class="sxs-lookup"><span data-stu-id="0455c-290">The **/t "comment"** parameter is used to add a description to the transaction that added the symbols.</span></span> <span data-ttu-id="0455c-291">Это может быть полезно при выполнении административных задач с символами.</span><span class="sxs-lookup"><span data-stu-id="0455c-291">This can be useful when performing administrative tasks on the symbols.</span></span>

## <a name="best-practices"></a><span data-ttu-id="0455c-292">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="0455c-292">Best Practices</span></span>

-   <span data-ttu-id="0455c-293">Настройте файловый ресурс сервера символов для своей команды, компании или продукта.</span><span class="sxs-lookup"><span data-stu-id="0455c-293">Set up your own symbol server file share for your team, company, or product.</span></span>
-   <span data-ttu-id="0455c-294">Настройте \_ путь к \_ символам NT, \_ чтобы указать локальный кэш, сервер закрытых символов и сервер символов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0455c-294">Set up \_NT\_SYMBOL\_PATH to point to a local cache, to a private symbol server, and to the Microsoft symbol server.</span></span>
-   <span data-ttu-id="0455c-295">Если отладчику не удается загрузить символы для отлаживаемого компонента, обратитесь к владельцу компонента, чтобы запросить символы — по крайней мере в виде очищенного PDB-файла.</span><span class="sxs-lookup"><span data-stu-id="0455c-295">If a debugger cannot load symbols for a component you are debugging, contact the owner of the component to request symbols—at least a stripped PDB.</span></span>
-   <span data-ttu-id="0455c-296">Настройте автоматическую систему сборки для индексирования символов на закрытом сервере символов для каждой создаваемой сборки.</span><span class="sxs-lookup"><span data-stu-id="0455c-296">Set up an automated build system to index symbols on your private symbol server for each build that is produced.</span></span> <span data-ttu-id="0455c-297">Убедитесь, что распространяемые сборки являются сборками, создаваемыми этим процессом.</span><span class="sxs-lookup"><span data-stu-id="0455c-297">Make sure that the builds that you distribute are the builds that are generated by this process.</span></span> <span data-ttu-id="0455c-298">Это гарантирует, что символы всегда будут доступны для проблем отладки.</span><span class="sxs-lookup"><span data-stu-id="0455c-298">This ensures that symbols are always available to debug problems.</span></span>
-   <span data-ttu-id="0455c-299">Настройте сервер символов, чтобы разрешить отладчикам получать доступ к исходному коду определенного модуля непосредственно из системы управления исходным кодом на основе безопасного источника или Перфорце.</span><span class="sxs-lookup"><span data-stu-id="0455c-299">Set up a symbol server to allow debuggers to access the source code for a specific module directly from a Visual Source Safe or Perforce based source control system.</span></span> <span data-ttu-id="0455c-300">Если сведения о исходном файле и символы для выпущенной версии игры индексируются, разработчики, у которых есть доступ к серверу символов, могут иметь полный исходный уровень отладки сообщаемых проблем без сохранения сред сборки или старых версий исходных файлов на компьютерах разработки.</span><span class="sxs-lookup"><span data-stu-id="0455c-300">If the source file information and symbols for a released version of a game are indexed, developers who have access to your symbol server can have full source level debugging of reported issues, without keeping build environments or old versions of source files on their development computers.</span></span> <span data-ttu-id="0455c-301">Сведения о настройке сервера символов для разрешения индексации данных исходного файла см. в документации по исходному серверу.</span><span class="sxs-lookup"><span data-stu-id="0455c-301">To set up your symbol server to allow indexing of source file information, see source server documentation.</span></span>

 

 