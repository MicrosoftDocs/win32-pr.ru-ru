---
title: Обозреватель игр Windows для разработчиков игр
description: В этой статье описывается процесс регистрации игры с помощью обозревателя игр и родительского контроля в Windows Vista и Windows 7 с использованием новой схемы ГДФ.
ms.assetid: 628f14bf-2714-0d68-8267-4f7f48c2774a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7f59b90a23f407be3990a6a4e24b92d39e66852
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105661761"
---
# <a name="windows-games-explorer-for-game-developers"></a><span data-ttu-id="a667f-103">Обозреватель игр Windows для разработчиков игр</span><span class="sxs-lookup"><span data-stu-id="a667f-103">Windows Games Explorer for Game Developers</span></span>

<span data-ttu-id="a667f-104">Windows Vista улучшает взаимодействие пользователей с играми в Windows, включая Обозреватель игр.</span><span class="sxs-lookup"><span data-stu-id="a667f-104">Windows Vista improves the user experience of gaming on Windows by including Games Explorer.</span></span> <span data-ttu-id="a667f-105">Обозреватель игр открывается в меню Пуск Windows Vista в виде папки «игры» и предоставляет централизованное расположение для доступа к играм.</span><span class="sxs-lookup"><span data-stu-id="a667f-105">Games Explorer is exposed in the Windows Vista Start Menu as the Games folder and provides a central location for accessing games.</span></span>

<span data-ttu-id="a667f-106">Начиная с выпуска DirectX SDK за Март 2009, для поддержки функций в Windows 7, поставщика игр и RSS-канале используется новая схема файла определения игры (ГДФ).</span><span class="sxs-lookup"><span data-stu-id="a667f-106">Starting with the March 2009 release of the DirectX SDK, a new game definition file (GDF) schema is used to support features in Windows 7, Game Provider and RSS feed, and IGameExplorer2.</span></span> <span data-ttu-id="a667f-107">IGameExplorer2 — это новый интерфейс в Windows 7, который упрощает процесс интеграции игр с обозревателем игр.</span><span class="sxs-lookup"><span data-stu-id="a667f-107">IGameExplorer2 is a new interface on Windows 7 that simplifies the process of integrating a game with Games Explorer.</span></span>

<span data-ttu-id="a667f-108">В этой статье описывается процесс регистрации игры с помощью обозревателя игр и родительского контроля в Windows Vista и Windows 7 с использованием новой схемы ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-108">This article outlines the process of registering a game with Games Explorer and parental controls on Windows Vista and Windows 7 by using the new GDF schema.</span></span>

<span data-ttu-id="a667f-109">Содержимое:</span><span class="sxs-lookup"><span data-stu-id="a667f-109">Contents:</span></span>

-   [<span data-ttu-id="a667f-110">Предварительные условия</span><span class="sxs-lookup"><span data-stu-id="a667f-110">Prerequisites</span></span>](#prerequisites)
-   [<span data-ttu-id="a667f-111">Интеграция с установщиком</span><span class="sxs-lookup"><span data-stu-id="a667f-111">Integrating with an Installer</span></span>](#integrating-with-an-installer)
-   [<span data-ttu-id="a667f-112">Процесс интеграции</span><span class="sxs-lookup"><span data-stu-id="a667f-112">Integration Process</span></span>](#integration-process)
-   [<span data-ttu-id="a667f-113">Задачи обозревателя игр</span><span class="sxs-lookup"><span data-stu-id="a667f-113">Games Explorer Tasks</span></span>](#games-explorer-tasks)
-   [<span data-ttu-id="a667f-114">Интеграция в Инсталлскрипт</span><span class="sxs-lookup"><span data-stu-id="a667f-114">Integrating into InstallScript</span></span>](#integrating-into-installscript)
-   [<span data-ttu-id="a667f-115">Интеграция в пакет MSI</span><span class="sxs-lookup"><span data-stu-id="a667f-115">Integrating into an MSI Package</span></span>](#integrating-into-an-msi-package)
-   [<span data-ttu-id="a667f-116">Советы по отладке</span><span class="sxs-lookup"><span data-stu-id="a667f-116">Debugging Tips</span></span>](#debugging-tips)
    -   [<span data-ttu-id="a667f-117">Тестирование с помощью примера кода</span><span class="sxs-lookup"><span data-stu-id="a667f-117">Test with sample code</span></span>](#test-with-sample-code)
    -   [<span data-ttu-id="a667f-118">Убедитесь, что ваша игра была правильно удалена</span><span class="sxs-lookup"><span data-stu-id="a667f-118">Make sure that your game was removed properly</span></span>](#make-sure-that-your-game-was-removed-properly)
    -   [<span data-ttu-id="a667f-119">Обязательно подпишитесь с помощью Authenticode.</span><span class="sxs-lookup"><span data-stu-id="a667f-119">Be sure to sign using Authenticode</span></span>](#be-sure-to-sign-using-authenticode)
    -   [<span data-ttu-id="a667f-120">Убедитесь, что доступны родительские элементы управления</span><span class="sxs-lookup"><span data-stu-id="a667f-120">Be sure that parental controls are available</span></span>](#be-sure-that-parental-controls-are-available)
    -   [<span data-ttu-id="a667f-121">Убедитесь, что задачи имеют правильный тип</span><span class="sxs-lookup"><span data-stu-id="a667f-121">Verify that tasks are of the correct type</span></span>](#verify-that-tasks-are-of-the-correct-type)
    -   [<span data-ttu-id="a667f-122">Проверка данных в двоичном файле ГДФ</span><span class="sxs-lookup"><span data-stu-id="a667f-122">Verify the data in GDF binary</span></span>](#verify-the-data-in-gdf-binary)
-   [<span data-ttu-id="a667f-123">Сводка</span><span class="sxs-lookup"><span data-stu-id="a667f-123">Summary</span></span>](#summary)

## <a name="prerequisites"></a><span data-ttu-id="a667f-124">Предварительные условия</span><span class="sxs-lookup"><span data-stu-id="a667f-124">Prerequisites</span></span>

<span data-ttu-id="a667f-125">Перед интеграцией игры в Обозреватель игр необходимо создать файл определения игры (ГДФ).</span><span class="sxs-lookup"><span data-stu-id="a667f-125">Before you can integrate a game into Games Explorer, you must create a game definition file (GDF).</span></span> <span data-ttu-id="a667f-126">ГДФ — это XML-файл, содержащий метаданные, описывающие игру.</span><span class="sxs-lookup"><span data-stu-id="a667f-126">A GDF is an XML file that contains metadata that describes the game.</span></span> <span data-ttu-id="a667f-127">В выпуске DirectX SDK, выпущенном в марте 2009, в схему ГДФ добавлена секция для поставщика игр, RSS-канала и задачи игры.</span><span class="sxs-lookup"><span data-stu-id="a667f-127">In the March 2009 release of the DirectX SDK, a section for game provider, RSS feed, and game task has been added to the GDF schema.</span></span> <span data-ttu-id="a667f-128">Чтобы использовать инструкции, приведенные в этой статье, необходимо использовать этот новый формат ГДФ для создания файла ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-128">To use the instructions in this article, you must use this new GDF format to create your GDF file.</span></span>

<span data-ttu-id="a667f-129">Корпорация Майкрософт предоставляет средство для создания Гдфс в пакете SDK DirectX, редакторе файлов определения игр, чтобы упростить процесс создания.</span><span class="sxs-lookup"><span data-stu-id="a667f-129">Microsoft provides a tool for authoring GDFs in the DirectX SDK, Game Definition File Editor, to make this creation process easier.</span></span> <span data-ttu-id="a667f-130">Это средство также помогает создавать локализованные версии ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-130">This tool also helps you create localized versions of a GDF.</span></span>

<span data-ttu-id="a667f-131">После создания и локализации ГДФ оно должно быть инкапсулировано в раздел ресурсов двоичного файла (исполняемый файл или DLL), вместе с эскизом и значком игры.</span><span class="sxs-lookup"><span data-stu-id="a667f-131">Once a GDF has been authored and localized, it must be encapsulated within a resource section of a binary file (either an executable or DLL), along with the game's thumbnail and icon.</span></span> <span data-ttu-id="a667f-132">ГДФ содержит все метаданные, связанные с игрой, включая рейтинг игры.</span><span class="sxs-lookup"><span data-stu-id="a667f-132">The GDF contains all of the metadata associated with the game, including the game's rating.</span></span> <span data-ttu-id="a667f-133">Функция родительского контроля Windows использует рейтинг игры, чтобы разрешить родителям управлять доступом к игре.</span><span class="sxs-lookup"><span data-stu-id="a667f-133">Windows Parental Controls use the game's rating to allow parents to control access to the game.</span></span> <span data-ttu-id="a667f-134">Двоичный файл, содержащий ГДФ, должен иметь цифровую подпись с действительным сертификатом Authenticode. в противном случае Обозреватель игр и система родительского контроля пропускают рейтинг игры, так как сведения о рейтинге не могут быть доверенными без сертификации.</span><span class="sxs-lookup"><span data-stu-id="a667f-134">The binary file which contains the GDF must be digitally signed with a valid Authenticode certificate; otherwise, Games Explorer and the parental control system ignores the game's rating, because the rating information cannot be trusted without certification.</span></span> <span data-ttu-id="a667f-135">Дополнительные сведения о подписывании кода с помощью Authenticode см. в статье [Подписывание Authenticode для разработчиков игр](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span><span class="sxs-lookup"><span data-stu-id="a667f-135">For more details about signing code with Authenticode, see [Authenticode Signing for Game Developers](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span></span>

## <a name="integrating-with-an-installer"></a><span data-ttu-id="a667f-136">Интеграция с установщиком</span><span class="sxs-lookup"><span data-stu-id="a667f-136">Integrating with an Installer</span></span>

<span data-ttu-id="a667f-137">Для упрощения интеграции обозревателя игр пример Гамеуксинсталлхелпер предоставляет общий API, который можно вызывать в Windows XP, Windows Vista и Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a667f-137">To simplify Games Explorer integration, the GameUXInstallHelper sample provides a common API that can be called on Windows XP, Windows Vista, and Windows 7.</span></span> <span data-ttu-id="a667f-138">Он предназначен для работы со сценариями для установки InstallShield и, а также с пользовательскими действиями MSI и настраиваемыми инструментами установки.</span><span class="sxs-lookup"><span data-stu-id="a667f-138">It is designed to work with scripts for InstallShield and Wise Installation System, as well as MSI custom actions and custom installation tools.</span></span> <span data-ttu-id="a667f-139">Обнаружение операционной системы обрабатывается в этом образце библиотеки DLL, поэтому вызывающему объекту не нужно беспокоиться о том, работает ли клиент под управлением Windows XP, Windows Vista или Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a667f-139">Detection of the operating system is handled inside this sample DLL, so the caller does not need to worry whether the client is running Windows XP, Windows Vista, or Windows 7.</span></span>

<span data-ttu-id="a667f-140">Ниже перечислены функции, экспортируемые этой библиотекой DLL.</span><span class="sxs-lookup"><span data-stu-id="a667f-140">The functions exported by this DLL are the following:</span></span>

<dl> <dt>

<span data-ttu-id="a667f-141"><span id="GameExplorerInstallW"></span><span id="gameexplorerinstallw"></span><span id="GAMEEXPLORERINSTALLW"></span>**гамиксплореринсталлв**</span><span class="sxs-lookup"><span data-stu-id="a667f-141"><span id="GameExplorerInstallW"></span><span id="gameexplorerinstallw"></span><span id="GAMEEXPLORERINSTALLW"></span>**GameExplorerInstallW**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-142">Регистрирует игру в обозревателе игр по указанному пути к двоичному файлу ГДФ, полному пути к папке, в которой установлена игра, и области установки.</span><span class="sxs-lookup"><span data-stu-id="a667f-142">Registers a game with Games Explorer, given a path to the GDF binary, a full path to the folder where the game is installed, and the installation scope.</span></span>

</dd> <dt>

<span data-ttu-id="a667f-143"><span id="GameExplorerInstallA"></span><span id="gameexplorerinstalla"></span><span id="GAMEEXPLORERINSTALLA"></span>**гамиксплореринсталла**</span><span class="sxs-lookup"><span data-stu-id="a667f-143"><span id="GameExplorerInstallA"></span><span id="gameexplorerinstalla"></span><span id="GAMEEXPLORERINSTALLA"></span>**GameExplorerInstallA**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-144">Регистрирует игру в обозревателе игр; Версия **гамиксплореринсталлв** для ANSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-144">Registers a game with Games Explorer; ANSI version of **GameExplorerInstallW**.</span></span>

</dd> <dt>

<span data-ttu-id="a667f-145"><span id="GameExplorerUninstallW"></span><span id="gameexploreruninstallw"></span><span id="GAMEEXPLORERUNINSTALLW"></span>**гамиксплорерунинсталлв**</span><span class="sxs-lookup"><span data-stu-id="a667f-145"><span id="GameExplorerUninstallW"></span><span id="gameexploreruninstallw"></span><span id="GAMEEXPLORERUNINSTALLW"></span>**GameExplorerUninstallW**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-146">Удаляет игру из регистрации в обозревателе игр по указанному пути к двоичному файлу ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-146">Removes a game from registration with Games Explorer, given a path to the GDF binary.</span></span>

</dd> <dt>

<span data-ttu-id="a667f-147"><span id="GameExplorerUninstallA"></span><span id="gameexploreruninstalla"></span><span id="GAMEEXPLORERUNINSTALLA"></span>**гамиксплорерунинсталла**</span><span class="sxs-lookup"><span data-stu-id="a667f-147"><span id="GameExplorerUninstallA"></span><span id="gameexploreruninstalla"></span><span id="GAMEEXPLORERUNINSTALLA"></span>**GameExplorerUninstallA**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-148">Удаляет игру из регистрации в обозревателе игр. Версия **гамиксплорерунинсталлв** для ANSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-148">Removes a game from registration with Games Explorer; ANSI version of **GameExplorerUninstallW**.</span></span>

</dd> <dt>

<span data-ttu-id="a667f-149"><span id="GameExplorerSetMSIProperties"></span><span id="gameexplorersetmsiproperties"></span><span id="GAMEEXPLORERSETMSIPROPERTIES"></span>**гамиксплорерсетмсипропертиес**</span><span class="sxs-lookup"><span data-stu-id="a667f-149"><span id="GameExplorerSetMSIProperties"></span><span id="gameexplorersetmsiproperties"></span><span id="GAMEEXPLORERSETMSIPROPERTIES"></span>**GameExplorerSetMSIProperties**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-150">Настраивает свойства CustomActionData для действий отложенной выборочной установки MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-150">Configures the CustomActionData properties for the actions of an MSI deferred custom installation.</span></span> <span data-ttu-id="a667f-151">Использование этой функции подробно описано далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="a667f-151">Usage of this function is described in detail later in this article.</span></span>

</dd> <dt>

<span data-ttu-id="a667f-152"><span id="GameExplorerInstallUsingMSI"></span><span id="gameexplorerinstallusingmsi"></span><span id="GAMEEXPLORERINSTALLUSINGMSI"></span>**гамиксплореринсталлусингмси**</span><span class="sxs-lookup"><span data-stu-id="a667f-152"><span id="GameExplorerInstallUsingMSI"></span><span id="gameexplorerinstallusingmsi"></span><span id="GAMEEXPLORERINSTALLUSINGMSI"></span>**GameExplorerInstallUsingMSI**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-153">Добавляет игру в Обозреватель игр; для использования во время установки настраиваемого действия MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-153">Adds a game to Games Explorer; for use during an MSI custom action installation.</span></span>

</dd> <dt>

<span data-ttu-id="a667f-154"><span id="GameExplorerUninstallUsingMSI"></span><span id="gameexploreruninstallusingmsi"></span><span id="GAMEEXPLORERUNINSTALLUSINGMSI"></span>**гамиксплорерунинсталлусингмси**</span><span class="sxs-lookup"><span data-stu-id="a667f-154"><span id="GameExplorerUninstallUsingMSI"></span><span id="gameexploreruninstallusingmsi"></span><span id="GAMEEXPLORERUNINSTALLUSINGMSI"></span>**GameExplorerUninstallUsingMSI**</span></span>
</dt> <dd>

<span data-ttu-id="a667f-155">Удаление игры из обозревателя игр; для использования во время установки настраиваемого действия MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-155">Remove a game from Games Explorer; for use during an MSI custom action installation.</span></span>

</dd> </dl>

<span data-ttu-id="a667f-156">Эти функции более подробно описаны в заголовке Гамеуксинсталлхелпер. h.</span><span class="sxs-lookup"><span data-stu-id="a667f-156">These functions are further explained in the GameUXInstallHelper.h header.</span></span>

## <a name="integration-process"></a><span data-ttu-id="a667f-157">Процесс интеграции</span><span class="sxs-lookup"><span data-stu-id="a667f-157">Integration Process</span></span>

<span data-ttu-id="a667f-158">После добавления ГДФ и связанных файлов в двоичный ресурс можно интегрировать игру с обозревателем игр.</span><span class="sxs-lookup"><span data-stu-id="a667f-158">Once the GDF and related files have been added to a binary resource, it is then possible to integrate the game with Games Explorer.</span></span> <span data-ttu-id="a667f-159">Использование **гамеуксинсталлхелпер** упростит процесс интеграции.</span><span class="sxs-lookup"><span data-stu-id="a667f-159">Using **GameUXInstallHelper** will simplify the integration process.</span></span> <span data-ttu-id="a667f-160">Чтобы зарегистрировать игру в обозревателе игр, вызовите **гамиксплореринсталл** , указав путь к двоичному файлу ГДФ, полный путь к папке, в которой установлена игра, и область установки.</span><span class="sxs-lookup"><span data-stu-id="a667f-160">To register the game with Games Explorer, call the **GameExplorerInstall** with a path to the GDF binary, a full path to the folder where the game is installed, and the installation scope.</span></span> <span data-ttu-id="a667f-161">Чтобы удалить регистрацию игры, вызовите **гамиксплорерунинсталл** , указав путь к двоичному файлу ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-161">To remove the game's registration, call **GameExplorerUninstall** with a path to the GDF binary.</span></span>

<span data-ttu-id="a667f-162">Обратите внимание, что процесс удаления удаляет только одну уникальную установку.</span><span class="sxs-lookup"><span data-stu-id="a667f-162">Note that the removal process only removes one unique installation.</span></span> <span data-ttu-id="a667f-163">Если игра была установлена несколько раз, этот процесс необходимо повторить для каждой уникальной установки.</span><span class="sxs-lookup"><span data-stu-id="a667f-163">If a game has been installed multiple times, this process must be repeated for each unique installation.</span></span>

## <a name="games-explorer-tasks"></a><span data-ttu-id="a667f-164">Задачи обозревателя игр</span><span class="sxs-lookup"><span data-stu-id="a667f-164">Games Explorer Tasks</span></span>

<span data-ttu-id="a667f-165">Задачи обозревателя игр будут отображаться в контекстном меню элемента обозревателя игр.</span><span class="sxs-lookup"><span data-stu-id="a667f-165">Games Explorer tasks will appear in the context menu of an item in Games Explorer.</span></span> <span data-ttu-id="a667f-166">Задачи делятся на задачи воспроизведения и задачи поддержки.</span><span class="sxs-lookup"><span data-stu-id="a667f-166">Tasks are divided into play tasks and support tasks.</span></span> <span data-ttu-id="a667f-167">Задачи воспроизведения позволяют запускать игру в определенном режиме, а задачи поддержки — в других целях, включая ссылки на веб-сайты.</span><span class="sxs-lookup"><span data-stu-id="a667f-167">Play tasks launch a game into a particular mode, while support tasks serve any other purpose, including linking to web sites.</span></span>

<span data-ttu-id="a667f-168">В Windows Vista задачи — это просто ярлыки, расположенные в отдельных папках.</span><span class="sxs-lookup"><span data-stu-id="a667f-168">In Windows Vista, tasks are simply shortcuts that are located in specific folders.</span></span> <span data-ttu-id="a667f-169">Задачи воспроизведения и задачи поддержки хранятся в папках с соответствующими именами Плайтаскс и Суппорттаскс.</span><span class="sxs-lookup"><span data-stu-id="a667f-169">Play tasks and support tasks are stored in folders with the corresponding names PlayTasks and SupportTasks.</span></span> <span data-ttu-id="a667f-170">Гамеуксинсталлхелпер может считывать сведения о задачах игры из двоичного файла ГДФ и автоматически создавать все ярлыки.</span><span class="sxs-lookup"><span data-stu-id="a667f-170">GameUXInstallHelper can read the game's task information from the GDF binary file and create all of the shortcuts automatically.</span></span>

<span data-ttu-id="a667f-171">В Windows 7 ярлыки задач не требуются, так как Обозреватель игр получает всю информацию о задаче непосредственно из двоичного файла ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-171">In Windows 7, the shortcuts to the tasks are not needed, because Games Explorer obtains all of the task information directly from the GDF binary file.</span></span>

## <a name="integrating-into-installscript"></a><span data-ttu-id="a667f-172">Интеграция в Инсталлскрипт</span><span class="sxs-lookup"><span data-stu-id="a667f-172">Integrating into InstallScript</span></span>

<span data-ttu-id="a667f-173">Вызов API обозревателя игр из Инсталлскрипт InstallShield упрощается с помощью примера Гамеуксинсталлхелпер.</span><span class="sxs-lookup"><span data-stu-id="a667f-173">Calling Games Explorer APIs from InstallShield's InstallScript is made easy by using the GameUXInstallHelper sample.</span></span> <span data-ttu-id="a667f-174">Ниже приведены шаги, необходимые для интеграции с InstallShield.</span><span class="sxs-lookup"><span data-stu-id="a667f-174">The steps required to integrate with InstallShield are as follows:</span></span>

1.  <span data-ttu-id="a667f-175">Откройте проект Инсталлскрипт в редакторе InstallShield.</span><span class="sxs-lookup"><span data-stu-id="a667f-175">Open an InstallScript project in the InstallShield editor.</span></span>
2.  <span data-ttu-id="a667f-176">Добавьте GameUXInstallHelper.dll в проект, который будет установлен в целевой каталог.</span><span class="sxs-lookup"><span data-stu-id="a667f-176">Add GameUXInstallHelper.dll to the project to be installed to the target directory.</span></span>

    <span data-ttu-id="a667f-177">**Чтобы добавить GameUXInstallHelper.dll в проект Инсталлскрипт, выполните следующие действия.**</span><span class="sxs-lookup"><span data-stu-id="a667f-177">**To add GameUXInstallHelper.dll to an InstallScript project:**</span></span>

    1.  <span data-ttu-id="a667f-178">На вкладке **конструктор установки** щелкните **Данные приложения** в области навигации слева.</span><span class="sxs-lookup"><span data-stu-id="a667f-178">On the **Installation Designer** tab, click **Application Data** in the navigation pane on the left.</span></span>
    2.  <span data-ttu-id="a667f-179">Щелкните **файлы и папки** и перейдите к **папкам исходного компьютера** , чтобы найти GameUXInstallerHelper.dll в **файлах исходного компьютера**.</span><span class="sxs-lookup"><span data-stu-id="a667f-179">Click **Files and Folders** and browse in **Source computer's folders** to locate GameUXInstallerHelper.dll in **Source computer's files**.</span></span>

        <span data-ttu-id="a667f-180">Расположение по умолчанию для GameUXInstallerHelper.dll — корневые примеры пакета SDK для DirectX с поддержкой \\ \\ C++ \\ Прочие \\ bin \\ x86.</span><span class="sxs-lookup"><span data-stu-id="a667f-180">The default location for GameUXInstallerHelper.dll is DirectX SDK root\\Samples\\C++\\Misc\\Bin\\x86.</span></span>

    3.  <span data-ttu-id="a667f-181">В разделе **папки конечного компьютера** щелкните **Целевая папка приложения**.</span><span class="sxs-lookup"><span data-stu-id="a667f-181">Under **Destination computer's folders**, click **Application Target Folder**.</span></span>
    4.  <span data-ttu-id="a667f-182">Перетащите GameUXInstallerHelper.dll из **файлов исходного компьютера** в **файлы конечного компьютера**.</span><span class="sxs-lookup"><span data-stu-id="a667f-182">Drag GameUXInstallerHelper.dll from **Source computer's files** to **Destination computer's files**.</span></span>

3.  <span data-ttu-id="a667f-183">В обозревателе Инсталлскрипт щелкните файл Инсталлскрипт (обычно Setup. RUL), который вызывает функцию DLL.</span><span class="sxs-lookup"><span data-stu-id="a667f-183">In the InstallScript explorer, click the InstallScript file (usually setup.rul) that calls the DLL function.</span></span>
4.  <span data-ttu-id="a667f-184">Вставьте в файл следующий Инсталлскрипт:</span><span class="sxs-lookup"><span data-stu-id="a667f-184">Paste the following InstallScript into the file:</span></span>

    ``` syntax
    typedef GUID
    begin
    LONG  Data1;
    SHORT Data2;
    SHORT Data3;
    CHAR  Data4(8);
    end;

    prototype LONG GameUXInstallHelper.GameExplorerInstallW(WSTRING, WSTRING, NUMBER);
    prototype LONG GameUXInstallHelper.GameExplorerUninstallW(WSTRING);

    function OnMoved()

    WSTRING gdfbin[256];
    WSTRING path[256];
    NUMBER scope;

    begin

    if !MAINTENANCE then

    UseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UseDLL( WINSYSDIR ^ "OLE32.dll" );

    path = TARGETDIR;
    gdfbin = TARGETDIR ^ "bin\\ExampleGame.exe";  // TODO: Change this to point to binary containing the GDF

    if ALLUSERS == 1 then
    scope = 3;
    else
    scope = 2;
    endif;

    GameUXInstallHelper.GameExplorerInstallW( gdfbin, path, scope);

    UnUseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UnUseDLL( WINSYSDIR ^ "OLE32.dll" );

    endif;

    end;

    function OnMoving()

    WSTRING gdfbin[256];

    begin

    if MAINTENANCE && UNINST != "" then

    UseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UseDLL( WINSYSDIR ^ "OLE32.dll" );

    gdfbin = path ^ "bin\\ExampleGame.exe";  // TODO: Change this to point to binary containing the GDF

    GameUXInstallHelper.GameExplorerUninstallW(gdfbin);
    UnUseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UnUseDLL( WINSYSDIR ^ "OLE32.dll" );

    endif;

    end;
    ```

## <a name="integrating-into-an-msi-package"></a><span data-ttu-id="a667f-185">Интеграция в пакет MSI</span><span class="sxs-lookup"><span data-stu-id="a667f-185">Integrating into an MSI Package</span></span>

<span data-ttu-id="a667f-186">Ниже приведено общее описание действий, необходимых для вызова API обозревателя игр с помощью настраиваемых действий MSI:</span><span class="sxs-lookup"><span data-stu-id="a667f-186">The following is a high-level description of the steps required to call the Games Explorer APIs using MSI custom actions:</span></span>

1.  <span data-ttu-id="a667f-187">Добавьте в таблицу свойств MSI свойство с именем "Релативепастогдф", содержащее относительный путь к двоичному файлу ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-187">Add a property to the MSI Property table called "RelativePathToGDF" containing the relative path to the GDF binary.</span></span>
2.  <span data-ttu-id="a667f-188">После действия Костфинализе вызовите функцию Гамеуксинсталлхелпер DLL **сетмсигамиксплорерпропертиес** в непосредственных пользовательских действиях, чтобы задать соответствующие свойства MSI для других настраиваемых действий.</span><span class="sxs-lookup"><span data-stu-id="a667f-188">After the CostFinalize action, call the GameUXInstallHelper DLL function **SetMSIGameExplorerProperties** in an immediate custom action to set the appropriate MSI properties for the other custom actions.</span></span>
3.  <span data-ttu-id="a667f-189">После установки активируйте отложенное настраиваемое действие после действия Инсталлфилес, которое вызывает функцию Гамеуксинсталлхелпер DLL **аддтогамиксплорерусингмси**.</span><span class="sxs-lookup"><span data-stu-id="a667f-189">Upon installation, trigger a deferred custom action after the InstallFiles action that calls the GameUXInstallHelper DLL function **AddToGameExplorerUsingMSI**.</span></span> <span data-ttu-id="a667f-190">Если установка предназначена для всех пользователей, то пользовательское действие должно установить флаг msidbCustomActionTypeNoImpersonate; в противном случае он не должен устанавливать этот флаг.</span><span class="sxs-lookup"><span data-stu-id="a667f-190">If the installation is for all users, then the custom action must set the flag msidbCustomActionTypeNoImpersonate; otherwise, it must not set this flag.</span></span> <span data-ttu-id="a667f-191">Поэтому определяются два практически идентичных настраиваемых действия: Гамеуксаддасадмин и Гамеуксаддаскурусер.</span><span class="sxs-lookup"><span data-stu-id="a667f-191">Therefore, two nearly identical custom actions are defined: GameUXAddAsAdmin and GameUXAddAsCurUser.</span></span>
4.  <span data-ttu-id="a667f-192">После удаления установки активируйте отложенное настраиваемое действие перед действием Ремовефилес, которое вызывает функцию Гамеуксинсталлхелпер DLL **ремовефромгамиксплорерусингмси**.</span><span class="sxs-lookup"><span data-stu-id="a667f-192">Upon removal of the installation, trigger a deferred custom action before the RemoveFiles action that calls the GameUXInstallHelper DLL function **RemoveFromGameExplorerUsingMSI**.</span></span> <span data-ttu-id="a667f-193">Если установка выполнялась для всех пользователей, то пользовательское действие должно установить флаг msidbCustomActionTypeNoImpersonate; в противном случае он не должен устанавливать этот флаг.</span><span class="sxs-lookup"><span data-stu-id="a667f-193">If the installation was for all users, then the custom action must set the flag msidbCustomActionTypeNoImpersonate; otherwise, it must not set this flag.</span></span> <span data-ttu-id="a667f-194">Поэтому определяются два практически идентичных настраиваемых действия: Гамеуксремовеасадмин и Гамеуксремовеаскурусер.</span><span class="sxs-lookup"><span data-stu-id="a667f-194">Therefore, two nearly identical custom actions are defined: GameUXRemoveAsAdmin and GameUXRemoveAsCurUser.</span></span>
5.  <span data-ttu-id="a667f-195">Определение настраиваемых действий отката для решения ситуации, когда пользователь отменяет установку или удаление после того, как одно из этих пользовательских действий уже произошло.</span><span class="sxs-lookup"><span data-stu-id="a667f-195">Define rollback custom actions to handle the case where the user cancels installing or removing after one of the these custom actions has already happened.</span></span> <span data-ttu-id="a667f-196">Это приводит к дополнительным 4 настраиваемым действиям: Гамеуксроллбаккаддасадмин, Гамеуксроллбаккаддаскурусер, Гамеуксроллбаккремовеасадмин и GameUXRollBackRemoveAsCurUser.</span><span class="sxs-lookup"><span data-stu-id="a667f-196">This results in an additional 4 custom actions: GameUXRollBackAddAsAdmin, GameUXRollBackAddAsCurUser, GameUXRollBackRemoveAsAdmin, and GameUXRollBackRemoveAsCurUser.</span></span>

<span data-ttu-id="a667f-197">Эта процедура подробно описана в следующих инструкциях, в которых описывается процесс, который можно выполнить с помощью редактора MSI, например редактора Orca, который находится в пакете Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="a667f-197">This procedure is described in detail in the following instructions, which describe a process that can be done using an MSI editor, such as the Orca editor found in the Platform SDK.</span></span> <span data-ttu-id="a667f-198">Некоторые редакторы MSI содержат мастера, упрощающие некоторые из этих действий по настройке.</span><span class="sxs-lookup"><span data-stu-id="a667f-198">Some MSI editors have wizards which simplify some of these configuration steps.</span></span>

<span data-ttu-id="a667f-199">**Настройка пакета MSI для интеграции с обозревателем игр**</span><span class="sxs-lookup"><span data-stu-id="a667f-199">**To configure an MSI package for integration with Games Explorer**</span></span>

1.  <span data-ttu-id="a667f-200">Откройте пакет MSI в Orca.</span><span class="sxs-lookup"><span data-stu-id="a667f-200">Open the MSI package in Orca.</span></span>
2.  <span data-ttu-id="a667f-201">Добавьте строку, показанную в следующей таблице, в **двоичную** таблицу в пакете MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-201">Add the row shown in the following table to the **Binary** table in the MSI package.</span></span> 

    | <span data-ttu-id="a667f-202">Имя</span><span class="sxs-lookup"><span data-stu-id="a667f-202">Name</span></span>   | <span data-ttu-id="a667f-203">Данные</span><span class="sxs-lookup"><span data-stu-id="a667f-203">Data</span></span>                                          |
    |--------|-----------------------------------------------|
    | <span data-ttu-id="a667f-204">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-204">GAMEUX</span></span> | <span data-ttu-id="a667f-205">путь к файлу DLL \\GameUXInstallHelper.dll</span><span class="sxs-lookup"><span data-stu-id="a667f-205">file path to the DLL\\GameUXInstallHelper.dll</span></span> |

    

     

    > [!Note]  
    > <span data-ttu-id="a667f-206">Этот файл будет внедрен в пакет MSI, поэтому этот шаг необходимо выполнять каждый раз при повторной компиляции GameUXInstallHelper.dll.</span><span class="sxs-lookup"><span data-stu-id="a667f-206">This file will be embedded in the MSI package, so you must do this step every time you recompile GameUXInstallHelper.dll.</span></span>

     

3.  <span data-ttu-id="a667f-207">Добавьте строки, показанные в следующей таблице, в таблицу **CustomAction** в пакете MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-207">Add the rows shown in the following table to the **CustomAction** table in the MSI package.</span></span>

    | <span data-ttu-id="a667f-208">Действие</span><span class="sxs-lookup"><span data-stu-id="a667f-208">Action</span></span>                        | <span data-ttu-id="a667f-209">Тип</span><span class="sxs-lookup"><span data-stu-id="a667f-209">Type</span></span>                                                                                                                                                                                                   | <span data-ttu-id="a667f-210">Источник</span><span class="sxs-lookup"><span data-stu-id="a667f-210">Source</span></span> | <span data-ttu-id="a667f-211">Назначение</span><span class="sxs-lookup"><span data-stu-id="a667f-211">Target</span></span>                         |
    |-------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|--------------------------------|
    | <span data-ttu-id="a667f-212">гамеукссетмсипропертиес</span><span class="sxs-lookup"><span data-stu-id="a667f-212">GameUXSetMSIProperties</span></span>        | <span data-ttu-id="a667f-213">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе = 65</span><span class="sxs-lookup"><span data-stu-id="a667f-213">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue = 65</span></span>                                                                                                        | <span data-ttu-id="a667f-214">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-214">GAMEUX</span></span> | <span data-ttu-id="a667f-215">сетмсигамиксплорерпропертиес</span><span class="sxs-lookup"><span data-stu-id="a667f-215">SetMSIGameExplorerProperties</span></span>   |
    | <span data-ttu-id="a667f-216">гамеуксаддасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-216">GameUXAddAsAdmin</span></span>              | <span data-ttu-id="a667f-217">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span><span class="sxs-lookup"><span data-stu-id="a667f-217">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span></span>                                 | <span data-ttu-id="a667f-218">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-218">GAMEUX</span></span> | <span data-ttu-id="a667f-219">аддтогамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-219">AddToGameExplorerUsingMSI</span></span>      |
    | <span data-ttu-id="a667f-220">гамеуксаддаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-220">GameUXAddAsCurUser</span></span>            | <span data-ttu-id="a667f-221">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeInScript = 1089</span><span class="sxs-lookup"><span data-stu-id="a667f-221">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript = 1089</span></span>                                                                      | <span data-ttu-id="a667f-222">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-222">GAMEUX</span></span> | <span data-ttu-id="a667f-223">аддтогамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-223">AddToGameExplorerUsingMSI</span></span>      |
    | <span data-ttu-id="a667f-224">гамеуксроллбаккаддасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-224">GameUXRollBackAddAsAdmin</span></span>      | <span data-ttu-id="a667f-225">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span><span class="sxs-lookup"><span data-stu-id="a667f-225">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span></span> | <span data-ttu-id="a667f-226">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-226">GAMEUX</span></span> | <span data-ttu-id="a667f-227">ремовефромгамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-227">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="a667f-228">гамеуксроллбаккаддаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-228">GameUXRollBackAddAsCurUser</span></span>    | <span data-ttu-id="a667f-229">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span><span class="sxs-lookup"><span data-stu-id="a667f-229">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span></span>                                      | <span data-ttu-id="a667f-230">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-230">GAMEUX</span></span> | <span data-ttu-id="a667f-231">ремовефромгамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-231">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="a667f-232">гамеуксремовеасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-232">GameUXRemoveAsAdmin</span></span>           | <span data-ttu-id="a667f-233">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span><span class="sxs-lookup"><span data-stu-id="a667f-233">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span></span>                                 | <span data-ttu-id="a667f-234">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-234">GAMEUX</span></span> | <span data-ttu-id="a667f-235">ремовефромгамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-235">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="a667f-236">гамеуксремовеаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-236">GameUXRemoveAsCurUser</span></span>         | <span data-ttu-id="a667f-237">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeInScript = 1089</span><span class="sxs-lookup"><span data-stu-id="a667f-237">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript = 1089</span></span>                                                                      | <span data-ttu-id="a667f-238">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-238">GAMEUX</span></span> | <span data-ttu-id="a667f-239">ремовефромгамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-239">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="a667f-240">гамеуксроллбаккремовеасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-240">GameUXRollBackRemoveAsAdmin</span></span>   | <span data-ttu-id="a667f-241">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span><span class="sxs-lookup"><span data-stu-id="a667f-241">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span></span> | <span data-ttu-id="a667f-242">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-242">GAMEUX</span></span> | <span data-ttu-id="a667f-243">аддтогамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-243">AddToGameExplorerUsingMSI</span></span>      |
    | <span data-ttu-id="a667f-244">гамеуксроллбаккремовеаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-244">GameUXRollBackRemoveAsCurUser</span></span> | <span data-ttu-id="a667f-245">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеконтинуе + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span><span class="sxs-lookup"><span data-stu-id="a667f-245">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span></span>                                      | <span data-ttu-id="a667f-246">гамеукс</span><span class="sxs-lookup"><span data-stu-id="a667f-246">GAMEUX</span></span> | <span data-ttu-id="a667f-247">аддтогамиксплорерусингмси</span><span class="sxs-lookup"><span data-stu-id="a667f-247">AddToGameExplorerUsingMSI</span></span>      |

    

     

4.  <span data-ttu-id="a667f-248">Добавьте значения, показанные для действия, условия и последовательности в следующей таблице, в таблицу **инсталлексекутесекуенце** в пакете MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-248">Add the values shown for Action, Condition, and Sequence in the following table to the **InstallExecuteSequence** table in the MSI package.</span></span>

    | <span data-ttu-id="a667f-249">Действие</span><span class="sxs-lookup"><span data-stu-id="a667f-249">Action</span></span>                        | <span data-ttu-id="a667f-250">Условие</span><span class="sxs-lookup"><span data-stu-id="a667f-250">Condition</span></span>                      | <span data-ttu-id="a667f-251">Последовательность</span><span class="sxs-lookup"><span data-stu-id="a667f-251">Sequence</span></span> | <span data-ttu-id="a667f-252">Примечания</span><span class="sxs-lookup"><span data-stu-id="a667f-252">Notes</span></span>                                                                                                                                                                                            |
    |-------------------------------|--------------------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="a667f-253">гамеукссетмсипропертиес</span><span class="sxs-lookup"><span data-stu-id="a667f-253">GameUXSetMSIProperties</span></span>        |                                | <span data-ttu-id="a667f-254">1015</span><span class="sxs-lookup"><span data-stu-id="a667f-254">1015</span></span>     | <span data-ttu-id="a667f-255">Порядковый номер помещает действие в ближайшее время после Костфинализе.</span><span class="sxs-lookup"><span data-stu-id="a667f-255">The sequence number places the action soon after CostFinalize.</span></span>                                                                                                                                   |
    | <span data-ttu-id="a667f-256">гамеуксаддасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-256">GameUXAddAsAdmin</span></span>              | <span data-ttu-id="a667f-257">НЕ установлено и ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-257">NOT Installed AND ALLUSERS</span></span>     | <span data-ttu-id="a667f-258">4003</span><span class="sxs-lookup"><span data-stu-id="a667f-258">4003</span></span>     | <span data-ttu-id="a667f-259">Это пользовательское действие выполняется только во время новой установки для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="a667f-259">This custom action will only happen during a fresh installation for all users.</span></span> <span data-ttu-id="a667f-260">Порядковый номер помещает действие после Инсталлфилес и после отката.</span><span class="sxs-lookup"><span data-stu-id="a667f-260">The sequence number places the action after InstallFiles and after the rollbacks.</span></span>                                 |
    | <span data-ttu-id="a667f-261">гамеуксаддаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-261">GameUXAddAsCurUser</span></span>            | <span data-ttu-id="a667f-262">НЕ установлено, а не ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-262">NOT Installed AND NOT ALLUSERS</span></span> | <span data-ttu-id="a667f-263">4004</span><span class="sxs-lookup"><span data-stu-id="a667f-263">4004</span></span>     | <span data-ttu-id="a667f-264">Это пользовательское действие выполняется только во время новой установки только для текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="a667f-264">This custom action will only happen during a fresh installation for the current user only.</span></span> <span data-ttu-id="a667f-265">Порядковый номер помещает действие после Инсталлфилес и после отката.</span><span class="sxs-lookup"><span data-stu-id="a667f-265">The sequence number places the action after InstallFiles and after the rollbacks.</span></span>                     |
    | <span data-ttu-id="a667f-266">гамеуксроллбаккаддасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-266">GameUXRollBackAddAsAdmin</span></span>      | <span data-ttu-id="a667f-267">НЕ установлено и ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-267">NOT Installed AND ALLUSERS</span></span>     | <span data-ttu-id="a667f-268">4001</span><span class="sxs-lookup"><span data-stu-id="a667f-268">4001</span></span>     | <span data-ttu-id="a667f-269">Это пользовательское действие выполняется только при отмене новой установки для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="a667f-269">This custom action will only happen when a fresh installation for all users is cancelled.</span></span> <span data-ttu-id="a667f-270">Порядковый номер помещает действие после Инсталлфилес и перед добавлением настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="a667f-270">The sequence number places the action after InstallFiles and before the Add custom action.</span></span>             |
    | <span data-ttu-id="a667f-271">гамеуксроллбаккаддаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-271">GameUXRollBackAddAsCurUser</span></span>    | <span data-ttu-id="a667f-272">НЕ установлено, а не ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-272">NOT Installed AND NOT ALLUSERS</span></span> | <span data-ttu-id="a667f-273">4002</span><span class="sxs-lookup"><span data-stu-id="a667f-273">4002</span></span>     | <span data-ttu-id="a667f-274">Это пользовательское действие происходит только в том случае, если будет отменена Новая установка для текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="a667f-274">This custom action will only happen when a fresh installation for the current user only is cancelled.</span></span> <span data-ttu-id="a667f-275">Порядковый номер помещает действие после Инсталлфилес и перед добавлением настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="a667f-275">The sequence number places the action after InstallFiles and before the Add custom action.</span></span> |
    | <span data-ttu-id="a667f-276">гамеуксремовеасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-276">GameUXRemoveAsAdmin</span></span>           | <span data-ttu-id="a667f-277">REMOVE ~ = "ALL" И ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-277">REMOVE~="ALL" AND ALLUSERS</span></span>     | <span data-ttu-id="a667f-278">3452</span><span class="sxs-lookup"><span data-stu-id="a667f-278">3452</span></span>     | <span data-ttu-id="a667f-279">Это пользовательское действие выполняется только во время удаления всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="a667f-279">This custom action will only happen during removal for all users.</span></span> <span data-ttu-id="a667f-280">Порядковый номер помещает действие непосредственно перед Ремовефилес и после отката.</span><span class="sxs-lookup"><span data-stu-id="a667f-280">The sequence number places the action directly before RemoveFiles and after the rollbacks.</span></span>                                     |
    | <span data-ttu-id="a667f-281">гамеуксремовеаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-281">GameUXRemoveAsCurUser</span></span>         | <span data-ttu-id="a667f-282">REMOVE ~ = "ALL", А НЕ ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-282">REMOVE~="ALL" AND NOT ALLUSERS</span></span> | <span data-ttu-id="a667f-283">3453</span><span class="sxs-lookup"><span data-stu-id="a667f-283">3453</span></span>     | <span data-ttu-id="a667f-284">Это пользовательское действие будет происходить только при удалении текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="a667f-284">This custom action will only happen during removal for the current user.</span></span> <span data-ttu-id="a667f-285">Порядковый номер помещает действие непосредственно перед Ремовефилес и после отката.</span><span class="sxs-lookup"><span data-stu-id="a667f-285">The sequence number places the action directly before RemoveFiles and after the rollbacks.</span></span>                              |
    | <span data-ttu-id="a667f-286">гамеуксроллбаккремовеасадмин</span><span class="sxs-lookup"><span data-stu-id="a667f-286">GameUXRollBackRemoveAsAdmin</span></span>   | <span data-ttu-id="a667f-287">REMOVE ~ = "ALL" И ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-287">REMOVE~="ALL" AND ALLUSERS</span></span>     | <span data-ttu-id="a667f-288">3450</span><span class="sxs-lookup"><span data-stu-id="a667f-288">3450</span></span>     | <span data-ttu-id="a667f-289">Это пользовательское действие будет выполнено только после отмены удаления всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="a667f-289">This custom action will only happen when removal for all users is cancelled.</span></span> <span data-ttu-id="a667f-290">Порядковый номер помещает действие непосредственно перед Ремовефилес и перед удалением настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="a667f-290">The sequence number places the action directly before RemoveFiles and before the Remove custom action.</span></span>              |
    | <span data-ttu-id="a667f-291">гамеуксроллбаккремовеаскурусер</span><span class="sxs-lookup"><span data-stu-id="a667f-291">GameUXRollBackRemoveAsCurUser</span></span> | <span data-ttu-id="a667f-292">REMOVE ~ = "ALL", А НЕ ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="a667f-292">REMOVE~="ALL" AND NOT ALLUSERS</span></span> | <span data-ttu-id="a667f-293">3451</span><span class="sxs-lookup"><span data-stu-id="a667f-293">3451</span></span>     | <span data-ttu-id="a667f-294">Это пользовательское действие будет выполнено только после отмены удаления текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="a667f-294">This custom action will only happen when removal for the current user is cancelled.</span></span> <span data-ttu-id="a667f-295">Порядковый номер помещает действие непосредственно перед Ремовефилес и перед удалением настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="a667f-295">The sequence number places the action directly before RemoveFiles and before the Remove custom action.</span></span>       |

    

     

5.  <span data-ttu-id="a667f-296">Добавьте строку, показанную в следующей таблице, в таблицу свойств в пакете MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-296">Add the row shown in the following table to the Property table in the MSI package.</span></span>

    | <span data-ttu-id="a667f-297">Свойство</span><span class="sxs-lookup"><span data-stu-id="a667f-297">Property</span></span>          | <span data-ttu-id="a667f-298">Значение</span><span class="sxs-lookup"><span data-stu-id="a667f-298">Value</span></span>                                                         |
    |-------------------|---------------------------------------------------------------|
    | <span data-ttu-id="a667f-299">релативепастогдф</span><span class="sxs-lookup"><span data-stu-id="a667f-299">RelativePathToGDF</span></span> | <span data-ttu-id="a667f-300">относительный путь к \\ двоичному файлу, содержащему ГДФ</span><span class="sxs-lookup"><span data-stu-id="a667f-300">relative file path\\name of binary file that contains the GDF</span></span> |

    

     

    > [!Note]  
    > <span data-ttu-id="a667f-301">Расположение, указанное в пути, указывается относительно расположения, указанного в пути установки.</span><span class="sxs-lookup"><span data-stu-id="a667f-301">The location specified by the path is relative to the location specified by the installation path.</span></span> <span data-ttu-id="a667f-302">Например, bin \\GDF.dll.</span><span class="sxs-lookup"><span data-stu-id="a667f-302">For example, bin\\GDF.dll.</span></span>

     

6.  <span data-ttu-id="a667f-303">Сохраните пакет MSI.</span><span class="sxs-lookup"><span data-stu-id="a667f-303">Save the MSI package.</span></span>

<span data-ttu-id="a667f-304">Более подробные сведения о пакетах MSI и установщик Windows см. в разделе [установщик Windows](/windows/desktop/Msi/windows-installer-portal).</span><span class="sxs-lookup"><span data-stu-id="a667f-304">For more detailed information about MSI packages and Windows Installer, see [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span></span>

## <a name="debugging-tips"></a><span data-ttu-id="a667f-305">Советы по отладке</span><span class="sxs-lookup"><span data-stu-id="a667f-305">Debugging Tips</span></span>

<span data-ttu-id="a667f-306">Ниже приведены некоторые советы по отладке проблем при вызове API обозревателя игр.</span><span class="sxs-lookup"><span data-stu-id="a667f-306">The following are some tips to help debug issues when calling Games Explorer APIs:</span></span>

### <a name="test-with-sample-code"></a><span data-ttu-id="a667f-307">Тестирование с помощью примера кода</span><span class="sxs-lookup"><span data-stu-id="a667f-307">Test with sample code</span></span>

<span data-ttu-id="a667f-308">При построении примера решения Гамеуксинсталлхелпер создается GameUXInstallHelper.dll и GDFInstall.exe.</span><span class="sxs-lookup"><span data-stu-id="a667f-308">Building the GameUXInstallHelper sample solution will create a GameUXInstallHelper.dll and a GDFInstall.exe.</span></span> <span data-ttu-id="a667f-309">GDFInstall.exe — это пример приложения, использующего GameUXInstallHelper.dll.</span><span class="sxs-lookup"><span data-stu-id="a667f-309">The GDFInstall.exe is a sample application that uses GameUXInstallHelper.dll.</span></span> <span data-ttu-id="a667f-310">Выполнение GDFInstall.exe предложит установить или удалить двоичный файл ГДФ из обозревателя игр.</span><span class="sxs-lookup"><span data-stu-id="a667f-310">Running GDFInstall.exe will prompt if you want install or remove a GDF binary from game explorer.</span></span> <span data-ttu-id="a667f-311">Вы можете протестировать двоичный файл ГДФ, передав его в качестве первого аргумента командной строки для GDFInstall.exe.</span><span class="sxs-lookup"><span data-stu-id="a667f-311">You can test your GDF binary file by passing it in as the first command line arg to GDFInstall.exe.</span></span>

<span data-ttu-id="a667f-312">Если у вас нет двоичного файла ГДФ или вы не можете установить его, попробуйте использовать пример ГДФ в пакете SDK DirectX.</span><span class="sxs-lookup"><span data-stu-id="a667f-312">If you don't have a GDF binary or yours fails to install, try using the sample GDF in the DirectX SDK.</span></span> <span data-ttu-id="a667f-313">Пример Гдфексамплебинари находится в пакете SDK DirectX и представляет собой только библиотеку DLL, содержащую файл ГДФ.</span><span class="sxs-lookup"><span data-stu-id="a667f-313">The GDFExampleBinary sample is found in the DirectX SDK and is just a DLL that only contains a GDF file.</span></span> <span data-ttu-id="a667f-314">Кроме того, в источник входит проект Гдфмакер.</span><span class="sxs-lookup"><span data-stu-id="a667f-314">Also included in the source is its GDFMaker project.</span></span> <span data-ttu-id="a667f-315">Его можно создать и протестировать с помощью GDFInstall.exe.</span><span class="sxs-lookup"><span data-stu-id="a667f-315">You can build it and test it using GDFInstall.exe.</span></span> <span data-ttu-id="a667f-316">Можно также сравнить свой XML с вашими, чтобы точно определить, где именно возникла эта ошибка.</span><span class="sxs-lookup"><span data-stu-id="a667f-316">You can also compare the its XML to yours to pinpoint exactly where the issue is.</span></span>

### <a name="make-sure-that-your-game-was-removed-properly"></a><span data-ttu-id="a667f-317">Убедитесь, что ваша игра была правильно удалена</span><span class="sxs-lookup"><span data-stu-id="a667f-317">Make sure that your game was removed properly</span></span>

<span data-ttu-id="a667f-318">Если игра уже установлена в обозревателе игр, последующие вызовы **игамиксплорер:: аддгаме** будут возвращать E \_ Fail, поэтому перед тестированием убедитесь, что ваша игра не установлена.</span><span class="sxs-lookup"><span data-stu-id="a667f-318">If the game is already installed in Games Explorer, then subsequent calls to **IGameExplorer::AddGame** will return E\_FAIL so make sure your game isn't installed before testing.</span></span> <span data-ttu-id="a667f-319">Это также применимо, если вы установили ГДФ только для текущего пользователя, а затем пытаетесь установить ГДФ для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="a667f-319">This also applies if you install the GDF for only the current user and then try to install the GDF for all users.</span></span> <span data-ttu-id="a667f-320">Сначала необходимо удалить игру из текущих пользователей, прежде чем **игамиксплорер:: аддгаме** будет выполнена.</span><span class="sxs-lookup"><span data-stu-id="a667f-320">You must first remove the game from the current users before **IGameExplorer::AddGame** will succeed.</span></span>

<span data-ttu-id="a667f-321">Если запустить **GDFInstall.exe enum**, пример приложения будет вводить другой режим, который будет перечислять все установленные игры Explorer и предлагать вам удалить их.</span><span class="sxs-lookup"><span data-stu-id="a667f-321">If you run **GDFInstall.exe enum**, the sample application will enter a different mode which will enumerate all of the installed Games Explorer games and prompt you to remove them.</span></span> <span data-ttu-id="a667f-322">Кроме того, можно просмотреть и найти в реестре в разделе HKEY \_ Local \_ Machine \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ гамеукс, чтобы убедиться, что ваша игра не установлена для другого пользователя в системе.</span><span class="sxs-lookup"><span data-stu-id="a667f-322">You can also browse and search the registry in HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\GameUX to make sure that your game isn't installed for another user on the system.</span></span> <span data-ttu-id="a667f-323">Однако не следует изменять эти параметры реестра для других целей, так как они не обязательно должны оставаться совместимыми в будущих версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="a667f-323">However, do not alter these registry settings for any other purpose, as they are not guaranteed to remain compatible in future versions of the operating system.</span></span>

### <a name="be-sure-to-sign-using-authenticode"></a><span data-ttu-id="a667f-324">Обязательно подпишитесь с помощью Authenticode.</span><span class="sxs-lookup"><span data-stu-id="a667f-324">Be sure to sign using Authenticode</span></span>

<span data-ttu-id="a667f-325">Если вы предоставили оценку, но не видите ее в обозревателе игр, убедитесь, что вы использовали Authenticode для подписывания исполняемого файла или DLL-файлов, содержащих рейтинг.</span><span class="sxs-lookup"><span data-stu-id="a667f-325">If you have provided a rating, but are not seeing it in Games Explorer, make sure that you have used Authenticode to sign the executable or DLL file that contains the rating.</span></span> <span data-ttu-id="a667f-326">Обозреватель игр игнорирует сведения об оценках в неподписанных файлах.</span><span class="sxs-lookup"><span data-stu-id="a667f-326">Games Explorer ignores ratings information in unsigned files.</span></span> <span data-ttu-id="a667f-327">Дополнительные сведения о Authenticode см. в статье [Подписывание Authenticode для разработчиков игр](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span><span class="sxs-lookup"><span data-stu-id="a667f-327">For more information about Authenticode, see [Authenticode Signing for Game Developers](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span></span>

### <a name="be-sure-that-parental-controls-are-available"></a><span data-ttu-id="a667f-328">Убедитесь, что доступны родительские элементы управления</span><span class="sxs-lookup"><span data-stu-id="a667f-328">Be sure that parental controls are available</span></span>

<span data-ttu-id="a667f-329">Убедитесь, что вы тестируете родительские элементы управления в выпуске Windows Vista, который обеспечивает родительский контроль: Домашняя базовая, Домашняя расширенная или максимальная.</span><span class="sxs-lookup"><span data-stu-id="a667f-329">Ensure that you are testing parental controls on an edition of Windows Vista that provides parental controls: Home Basic, Home Premium, or Ultimate.</span></span> <span data-ttu-id="a667f-330">Windows Vista Business и Windows Vista Enterprise не предоставляют родительских средств контроля, однако если тестируется на Windows Vista Ultimate, а тестовый компьютер присоединен к домену, необходимо изменить параметр групповой политики, чтобы сделать родительский элемент управления видимым.</span><span class="sxs-lookup"><span data-stu-id="a667f-330">Windows Vista Business and Windows Vista Enterprise do not provide parental controls however if you are testing on Windows Vista Ultimate, and the test computer is joined to a domain, you must change a group policy setting make parental controls visible.</span></span> <span data-ttu-id="a667f-331">Дополнительные сведения см. в разделе [Начало работы с обозревателем игр](/previous-versions/windows/desktop/legacy/ee417682(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="a667f-331">To do this, see [Getting Started with Games Explorer](/previous-versions/windows/desktop/legacy/ee417682(v=vs.85)).</span></span>

### <a name="verify-that-tasks-are-of-the-correct-type"></a><span data-ttu-id="a667f-332">Убедитесь, что задачи имеют правильный тип</span><span class="sxs-lookup"><span data-stu-id="a667f-332">Verify that tasks are of the correct type</span></span>

<span data-ttu-id="a667f-333">Если вы указали задачи поддержки, которые не отображаются в обозревателе игр, убедитесь, что они являются веб-ссылками.</span><span class="sxs-lookup"><span data-stu-id="a667f-333">If you have specified support tasks that do not appear in Games Explorer, verify that they are all Web links.</span></span> <span data-ttu-id="a667f-334">Любые другие задачи с ярлыками должны создаваться как задачи воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="a667f-334">Any other shortcut tasks must be created as play tasks.</span></span> <span data-ttu-id="a667f-335">Задачи рассмотрены ранее в этой статье в разделе [задачи обозревателя игр](#games-explorer-tasks).</span><span class="sxs-lookup"><span data-stu-id="a667f-335">Tasks are covered earlier in this article in [Games Explorer Tasks](#games-explorer-tasks).</span></span>

### <a name="verify-the-data-in-gdf-binary"></a><span data-ttu-id="a667f-336">Проверка данных в двоичном файле ГДФ</span><span class="sxs-lookup"><span data-stu-id="a667f-336">Verify the data in GDF binary</span></span>

<span data-ttu-id="a667f-337">GDFTrace.exe — это средство, которое содержится в пакете SDK для DirectX.</span><span class="sxs-lookup"><span data-stu-id="a667f-337">GDFTrace.exe is a tool found in the DirectX SDK.</span></span> <span data-ttu-id="a667f-338">Вы можете запустить GDFTrace.exe в двоичном файле ГДФ и вывести все метаданные ГДФ, содержащиеся в двоичном файле, для каждого поддерживаемого языка для быстрой проверки.</span><span class="sxs-lookup"><span data-stu-id="a667f-338">You can run GDFTrace.exe on your GDF binary and it will output all the GDF metadata contained in the binary for every supported language for quick validation.</span></span> <span data-ttu-id="a667f-339">Он также отображает предупреждения об отсутствующей или устаревшей информации.</span><span class="sxs-lookup"><span data-stu-id="a667f-339">It also displays any warnings about missing or outdated information.</span></span>

## <a name="summary"></a><span data-ttu-id="a667f-340">Сводка</span><span class="sxs-lookup"><span data-stu-id="a667f-340">Summary</span></span>

<span data-ttu-id="a667f-341">Обозреватель игр в Windows Vista предоставляет простой, настраиваемый способ предоставления игр пользователям Windows Vista, но при этом также требуется зарегистрировать игру в системе в процессе установки.</span><span class="sxs-lookup"><span data-stu-id="a667f-341">Games Explorer in Windows Vista provides an easy, customizable way to present your game to users of Windows Vista, but it also requires you to register the game with the system during the installation process.</span></span> <span data-ttu-id="a667f-342">Пример Гамеуксинсталлхелпер значительно упрощает этот процесс для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="a667f-342">The GameUXInstallHelper sample greatly simplifies this process for developers.</span></span>

 

 