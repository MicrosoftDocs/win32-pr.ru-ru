---
description: Когда приложение подключается к аппаратному устройству для получения образа Windows (WIA), WIA создает дерево элементов (иерархическое дерево интерфейсов Ивиаитем или IWiaItem2), которое представляет устройство и его изображения, папки и сканирование кроватях.
ms.assetid: 2a7bcfd4-4075-48a4-9eff-5210b9a635e3
title: Выбор устройства (WIA)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 08a2eab41016397f6505e60efcbf78d1fdf82499
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103897438"
---
# <a name="selecting-a-device-wia"></a><span data-ttu-id="3280b-103">Выбор устройства (WIA)</span><span class="sxs-lookup"><span data-stu-id="3280b-103">Selecting a Device (WIA)</span></span>

<span data-ttu-id="3280b-104">Когда приложение подключается к аппаратному устройству для получения образа Windows (WIA), WIA создает дерево элементов (иерархическое дерево интерфейсов [**ивиаитем**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) или [**IWiaItem2**](-wia-iwiaitem2.md) ), которое представляет устройство и его изображения, папки и сканирование кроватях.</span><span class="sxs-lookup"><span data-stu-id="3280b-104">When an application connects to a Windows Image Acquisition (WIA) hardware device, WIA creates an item tree (a hierarchical tree of [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) interfaces) that represents the device and its images, folders, and scanning beds.</span></span> <span data-ttu-id="3280b-105">Приложение может выбирать и подключаться к устройству без ввода данных пользователем, а также может отображать диалоговое окно, позволяющее пользователю выбрать устройство.</span><span class="sxs-lookup"><span data-stu-id="3280b-105">An application can select and connect to a device without user input, or it can display a dialog box that allows a user to select a device.</span></span>

-   [<span data-ttu-id="3280b-106">Выбор устройства без пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="3280b-106">Selecting a Device Without the UI</span></span>](#selecting-a-device-without-the-ui)
-   [<span data-ttu-id="3280b-107">Выбор устройства с помощью пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="3280b-107">Selecting a Device With the UI</span></span>](#selecting-a-device-with-the-ui)

## <a name="selecting-a-device-without-the-ui"></a><span data-ttu-id="3280b-108">Выбор устройства без пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="3280b-108">Selecting a Device Without the UI</span></span>

<span data-ttu-id="3280b-109">Чтобы выбрать и подключиться к аппаратному устройству WIA, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="3280b-109">Perform the following steps to select and connect to a WIA hardware device.</span></span>

-   <span data-ttu-id="3280b-110">Вызовите [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для получения указателя на интерфейс [**ивиадевмгр**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) или [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) .</span><span class="sxs-lookup"><span data-stu-id="3280b-110">Call [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to retrieve a pointer to the [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface.</span></span>
-   <span data-ttu-id="3280b-111">Используйте метод [**ивиадевмгр:: енумдевицеинфо**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-enumdeviceinfo) интерфейса [**ивиадевмгр**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) или [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) , чтобы получить указатель на интерфейс [**иенумвиа \_ dev \_ info**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) .</span><span class="sxs-lookup"><span data-stu-id="3280b-111">Use the [**IWiaDevMgr::EnumDeviceInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-enumdeviceinfo) method of the [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface to obtain a pointer to the [**IEnumWIA\_DEV\_INFO**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) interface.</span></span> <span data-ttu-id="3280b-112">Инструкции по перечислению устройств см. в разделе [перечисление системных устройств](-wia-enumerating-system-devices.md).</span><span class="sxs-lookup"><span data-stu-id="3280b-112">For instructions on how to enumerate devices, see [Enumerating System Devices](-wia-enumerating-system-devices.md).</span></span>
-   <span data-ttu-id="3280b-113">Используйте интерфейс [**иенумвиа \_ dev \_ info**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) для получения указателей интерфейса [**ивиапропертистораже**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) для каждого перечисленного устройства WIA.</span><span class="sxs-lookup"><span data-stu-id="3280b-113">Use [**IEnumWIA\_DEV\_INFO**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) interface to obtain [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) interface pointers for each WIA device enumerated.</span></span>
-   <span data-ttu-id="3280b-114">Используйте интерфейс [**ивиапропертистораже**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) для проверки свойств сведений об устройстве каждого устройства и сохранения \_ свойства идентификатора WIA DIP \_ dev \_ с нужного устройства.</span><span class="sxs-lookup"><span data-stu-id="3280b-114">Use [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) interface to inspect the device information properties of each device and save the WIA\_DIP\_DEV\_ID property from the desired device.</span></span>
-   <span data-ttu-id="3280b-115">Используйте свойство DeviceID с методом [**ивиадевмгр:: креатедевице**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) в интерфейсе [**ивиадевмгр**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) или [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) , чтобы создать объект устройства WIA.</span><span class="sxs-lookup"><span data-stu-id="3280b-115">Use the DeviceID property with the [**IWiaDevMgr::CreateDevice**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) method in the [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface to create a WIA device object.</span></span> <span data-ttu-id="3280b-116">Метод **ивиадевмгр:: креатедевице** предоставляет приложению указатель на интерфейс [**ивиаитем**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) или [**IWiaItem2**](-wia-iwiaitem2.md) корневого элемента указанного устройства.</span><span class="sxs-lookup"><span data-stu-id="3280b-116">The **IWiaDevMgr::CreateDevice** method provides the application with the pointer to the [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) interface of the root item of the specified device.</span></span>

<span data-ttu-id="3280b-117">Пример того, как это сделать в приложении, см. в разделе [Создание устройства](-wia-creating-a-device.md) в руководстве этого руководства.</span><span class="sxs-lookup"><span data-stu-id="3280b-117">For an example of how to do this in an application, see [Creating a Device](-wia-creating-a-device.md) in the tutorial section of this guide.</span></span>

## <a name="selecting-a-device-with-the-ui"></a><span data-ttu-id="3280b-118">Выбор устройства с помощью пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="3280b-118">Selecting a Device With the UI</span></span>

<span data-ttu-id="3280b-119">После получения указателя на [**ивиадевмгр**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr)приложение может позволить пользователю выбрать устройство, пропустив оставшиеся действия, описанные выше, и вызвав [**Ивиадевмгр:: селектдевицедлг**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-selectdevicedlg).</span><span class="sxs-lookup"><span data-stu-id="3280b-119">After retrieving a pointer to [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr), an application can allow a user to select a device by skipping the rest of the above steps and calling [**IWiaDevMgr::SelectDeviceDlg**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-selectdevicedlg).</span></span> <span data-ttu-id="3280b-120">**Ивиадевмгр:: селектдевицедлг** отображает диалоговое окно, в котором пользователь может выбрать устройство WIA.</span><span class="sxs-lookup"><span data-stu-id="3280b-120">The **IWiaDevMgr::SelectDeviceDlg** displays a dialog box in which the user can select a WIA device.</span></span>

<span data-ttu-id="3280b-121">Рекомендуется, чтобы приложения были доступны для выбора устройств и изображений с помощью пункта меню **с именем сканер** в меню **файл** .</span><span class="sxs-lookup"><span data-stu-id="3280b-121">It is recommended that applications make device and image selection available through a menu item named **From scanner** on the **File** menu.</span></span>

 

 
