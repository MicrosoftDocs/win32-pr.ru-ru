---
description: Прежде чем можно будет использовать подпрограммы обратного вызова очереди по умолчанию, укажите ее в качестве подпрограммы обратного вызова при фиксации очереди файлов или путем вызова ее из настраиваемой подпрограммы обратного вызова, которая должна быть инициализирована.
ms.assetid: e25a9787-a4a3-4d06-bf55-f6f7cfb23481
title: Инициализация и завершение контекста обратного вызова
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03cb4c144cb9069d395ccd688e2a172680df8a12
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105663901"
---
# <a name="initializing-and-terminating-the-callback-context"></a><span data-ttu-id="a97bc-103">Инициализация и завершение контекста обратного вызова</span><span class="sxs-lookup"><span data-stu-id="a97bc-103">Initializing and Terminating the Callback Context</span></span>

<span data-ttu-id="a97bc-104">Прежде чем можно будет использовать подпрограммы обратного вызова очереди по умолчанию, укажите ее в качестве подпрограммы обратного вызова при фиксации очереди файлов или путем вызова ее из настраиваемой подпрограммы обратного вызова, которая должна быть инициализирована.</span><span class="sxs-lookup"><span data-stu-id="a97bc-104">Before the default queue callback routine can be used, either by specifying it as the callback routine when committing a file queue, or by calling it from a custom callback routine, it must be initialized.</span></span>

<span data-ttu-id="a97bc-105">Функция [**сетупинитдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) создает структуру контекста, которая используется подпрограммы обратного вызова очереди по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a97bc-105">The [**SetupInitDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) function builds the context structure that is used by the default queue callback routine.</span></span> <span data-ttu-id="a97bc-106">Он возвращает указатель void на эту структуру.</span><span class="sxs-lookup"><span data-stu-id="a97bc-106">It returns a void pointer to that structure.</span></span> <span data-ttu-id="a97bc-107">Эта структура является обязательной для операции подпрограммы обратного вызова по умолчанию и должна быть передана в подпрограммы обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="a97bc-107">This structure is essential for the default callback routine's operation and must be passed to the callback routine.</span></span> <span data-ttu-id="a97bc-108">Это можно сделать, указав указатель void в качестве контекста в вызове [**сетупкоммитфилекуеуе**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea)или указав указатель void в качестве параметра контекста при вызове [**сетупдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setupdefaultqueuecallbacka) из пользовательской подпрограммы обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="a97bc-108">You do can this either by specifying the void pointer as the context in a call to [**SetupCommitFileQueue**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea), or by specifying the void pointer as the context parameter when calling [**SetupDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupdefaultqueuecallbacka) from a custom callback routine.</span></span> <span data-ttu-id="a97bc-109">Эта структура контекста не должна изменяться или ссылаться на нее в приложении установки.</span><span class="sxs-lookup"><span data-stu-id="a97bc-109">This context structure must not be altered or referenced by the setup application.</span></span>

<span data-ttu-id="a97bc-110">Функция [**сетупинитдефаулткуеуекаллбаккекс**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex) также инициализирует контекст для подпрограммы обратного вызова очереди по умолчанию, но указывает второе окно для получения сообщения о ходе выполнения, указанного вызывающим объектом каждый раз, когда очередь отправляет уведомление.</span><span class="sxs-lookup"><span data-stu-id="a97bc-110">The [**SetupInitDefaultQueueCallbackEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex) function also initializes a context for the default queue callback routine, but it specifies a second window to receive a caller-specified progress message each time the queue sends a notification.</span></span> <span data-ttu-id="a97bc-111">Это позволяет использовать диалоговые окна по умолчанию и сообщения об ошибках, а также встраивать индикатор выполнения во второе окно, например на страницу мастера установки.</span><span class="sxs-lookup"><span data-stu-id="a97bc-111">This enables you to use the default disk prompting and error dialog boxes, and to also embed a progress bar in a second window, for example, in a page of an installation wizard.</span></span>

<span data-ttu-id="a97bc-112">Независимо от того, инициализирован ли контекст, используемый подпрограммой обратного вызова очереди по умолчанию с [**сетупинитдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) или [**сетупинитдефаулткуеуекаллбаккекс**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex), после завершения обработки операций, поставленных в очередь, вызовите [**сетуптермдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setuptermdefaultqueuecallback) , чтобы освободить ресурсы, выделенные при инициализации структуры контекста.</span><span class="sxs-lookup"><span data-stu-id="a97bc-112">Regardless of whether you initialized the context used by the default queue callback routine with [**SetupInitDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) or [**SetupInitDefaultQueueCallbackEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex), after the queued operations have finished processing, call [**SetupTermDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setuptermdefaultqueuecallback) to release the resources allocated in initializing the context structure.</span></span>

 

 



