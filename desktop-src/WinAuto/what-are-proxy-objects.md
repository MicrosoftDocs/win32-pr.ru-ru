---
title: Что такое прокси-объекты
description: Прокси-объект выступает в качестве посредника между клиентом и доступным объектом. Цель прокси-объекта — мониторинг жизненного цикла доступного объекта и переадресация вызовов к доступному объекту только в том случае, если он не уничтожается.
ms.assetid: fdd5d44a-1797-47e6-8044-37dde926c18a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60d54fb20d677f1a417d633242ddf40c704087f3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338932"
---
# <a name="what-are-proxy-objects"></a><span data-ttu-id="afe06-104">Что такое прокси-объекты?</span><span class="sxs-lookup"><span data-stu-id="afe06-104">What Are Proxy Objects?</span></span>

<span data-ttu-id="afe06-105">Прокси-объект выступает в качестве *посредника* между клиентом и доступным объектом.</span><span class="sxs-lookup"><span data-stu-id="afe06-105">A *proxy* object acts as an intermediary between the client and an accessible object.</span></span> <span data-ttu-id="afe06-106">Цель прокси-объекта — мониторинг жизненного цикла доступного объекта и переадресация вызовов к доступному объекту только в том случае, если он не уничтожается.</span><span class="sxs-lookup"><span data-stu-id="afe06-106">The purpose of the proxy object is to monitor the life span of the accessible object and to forward calls to the accessible object only if it is not destroyed.</span></span>

<span data-ttu-id="afe06-107">Когда клиент вызывает свойство [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для получения сведений об объекте, прокси-объект должен проверить, доступен ли доступный объект.</span><span class="sxs-lookup"><span data-stu-id="afe06-107">When a client calls an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) property to get information about an object, the proxy object must check whether the accessible object is still available.</span></span> <span data-ttu-id="afe06-108">Если это так, прокси-объект передает клиентский запрос объекту со специальными возможностями.</span><span class="sxs-lookup"><span data-stu-id="afe06-108">If it is, the proxy object passes the client's request to the accessible object.</span></span> <span data-ttu-id="afe06-109">При уничтожении доступного объекта (например, при закрытии диалогового окна с пользовательскими элементами управления) прокси-объект возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="afe06-109">If the accessible object is destroyed (for example, when a dialog box with custom controls is closed), the proxy object returns an error.</span></span> <span data-ttu-id="afe06-110">Чтобы указать, что объект был уничтожен, рекомендуется, чтобы серверы возвращали код ошибки **CO \_ E \_ обжнотконнектед** , так как эта ошибка возвращается компонентом модели COM после того, как сервер вызывает [кодисконнектобжект](/windows/win32/api/combaseapi/nf-combaseapi-codisconnectobject).</span><span class="sxs-lookup"><span data-stu-id="afe06-110">To indicate that the object has been destroyed, it is recommended that servers return the error code **CO\_E\_OBJNOTCONNECTED** because this error is returned by Component Object Model (COM) after a server calls [CoDisconnectObject](/windows/win32/api/combaseapi/nf-combaseapi-codisconnectobject).</span></span>

<span data-ttu-id="afe06-111">Прокси-объект является прозрачным для клиента.</span><span class="sxs-lookup"><span data-stu-id="afe06-111">The proxy object is transparent to the client.</span></span> <span data-ttu-id="afe06-112">Когда клиент вызывает [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**акцессиблеобжектфромпоинт**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)или [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow), он получает указатель на интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="afe06-112">When the client calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), or [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow), it receives back a pointer to an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface.</span></span> <span data-ttu-id="afe06-113">Однако если клиент использует этот указатель для вызова любых свойств или методов **IAccessible** , выполняемый код находится в прокси-объекте.</span><span class="sxs-lookup"><span data-stu-id="afe06-113">However, when the client uses this pointer to call any of the **IAccessible** properties or methods, the code that is executed is within the proxy object.</span></span>

 

 