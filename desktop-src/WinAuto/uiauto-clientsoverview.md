---
title: Общие сведения о клиентах автоматизации пользовательского интерфейса
description: В этом разделе описываются основные задачи, связанные с реализацией клиентского приложения Microsoft UI Automation.
ms.assetid: 536ccf03-2f52-49e5-a95f-ea56cf821779
keywords:
- Модель автоматизации пользовательского интерфейса, общие сведения о клиентах
- Клиенты, о
- Клиенты, элементы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d4705d75a0a80c114e2b83f9625f827c75503b9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413049"
---
# <a name="ui-automation-clients-overview"></a><span data-ttu-id="cb974-106">Общие сведения о клиентах автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="cb974-106">UI Automation Clients Overview</span></span>

<span data-ttu-id="cb974-107">В этом разделе описываются основные задачи, связанные с реализацией клиентского приложения Microsoft UI Automation.</span><span class="sxs-lookup"><span data-stu-id="cb974-107">This topic describes the main tasks involved in implementing a Microsoft UI Automation client application.</span></span>

<span data-ttu-id="cb974-108">Клиент автоматизации пользовательского интерфейса — это любое приложение, которое использует API автоматизации пользовательского интерфейса для доступа к информации об элементах ПОЛЬЗОВАТЕЛЬСКОГО интерфейса или для управления приложениями с помощью программной манипуляции с элементами пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="cb974-108">A UI Automation client is any application that uses the UI Automation API to access information about UI elements, or to control applications through programmatic manipulation of their UI elements.</span></span> <span data-ttu-id="cb974-109">Клиенты автоматизации пользовательского интерфейса включают вспомогательные технологические приложения, такие как средства чтения с экрана, которые извлекают сведения об элементах пользовательского интерфейса и представляют информацию способом, который можно использовать для людей с ограниченными возможностями.</span><span class="sxs-lookup"><span data-stu-id="cb974-109">UI Automation clients include assistive technology applications such as screen readers, which retrieve information about UI elements and present the information in a way that is usable for people with disabilities.</span></span> <span data-ttu-id="cb974-110">Они также включают в себя такие приложения, как программы распознавания речи и средства тестирования программного обеспечения, использующие автоматизацию пользовательского интерфейса, а не мышь и клавиатуру для «дисковых» других приложений.</span><span class="sxs-lookup"><span data-stu-id="cb974-110">They also include applications such as speech recognition programs and software testing tools, which use UI Automation instead of the mouse and keyboard to "drive" other applications.</span></span>

<span data-ttu-id="cb974-111">С точки зрения модели автоматизации пользовательского интерфейса основные задачи, которые должен выполнить клиентское приложение автоматизации пользовательского интерфейса, включают следующее.</span><span class="sxs-lookup"><span data-stu-id="cb974-111">From a UI Automation perspective, the main tasks that a UI Automation client application must accomplish include the following:</span></span>

1.  <span data-ttu-id="cb974-112">**Получите экземпляр объекта Куиаутоматион.**</span><span class="sxs-lookup"><span data-stu-id="cb974-112">**Obtain an instance of the CUIAutomation object.**</span></span>

    <span data-ttu-id="cb974-113">Сведения об элементах пользовательского интерфейса и доступе к функциональности элементов пользовательского интерфейса предоставляются клиентам поставщиками автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="cb974-113">Information about UI elements, and access to UI element functionality, is exposed to clients by UI Automation providers.</span></span> <span data-ttu-id="cb974-114">Однако клиентские приложения не работают напрямую с поставщиками.</span><span class="sxs-lookup"><span data-stu-id="cb974-114">However, client applications do not work directly with providers.</span></span> <span data-ttu-id="cb974-115">Вместо этого основная служба находится между клиентом и поставщиком.</span><span class="sxs-lookup"><span data-stu-id="cb974-115">Instead, a core service lies between the client and the provider.</span></span> <span data-ttu-id="cb974-116">Когда клиент вызывает API автоматизации пользовательского интерфейса, он фактически вызывает базовую службу автоматизации пользовательского интерфейса, которая, в свою очередь, выполняет вызовы интерфейсов, реализованных поставщиком.</span><span class="sxs-lookup"><span data-stu-id="cb974-116">When a client calls the UI Automation API, it is actually calling the UI Automation core service which, in turn, makes calls to the interfaces implemented by the provider.</span></span>

    <span data-ttu-id="cb974-117">Чтобы получить доступ к базовой службе автоматизации пользовательского интерфейса, клиент должен создать экземпляр объекта [**куиаутоматион**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) и получить указатель интерфейса [**иуиаутоматион**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) на объекте.</span><span class="sxs-lookup"><span data-stu-id="cb974-117">To gain access to the core UI Automation service, a client must create an instance of the [**CUIAutomation**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) object and retrieve an [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) interface pointer on the object.</span></span> <span data-ttu-id="cb974-118">Указатель **иуиаутоматион** — это ключ клиента для доступа ко всем функциональным возможностям модели автоматизации пользовательского интерфейса, доступным для клиента.</span><span class="sxs-lookup"><span data-stu-id="cb974-118">The **IUIAutomation** pointer is the client's key to accessing all of the UI Automation functionality that is available to the client.</span></span> <span data-ttu-id="cb974-119">Дополнительные сведения см. [в разделе Создание объекта куиаутоматион](uiauto-creatingcuiautomation.md).</span><span class="sxs-lookup"><span data-stu-id="cb974-119">For more information, see [Creating the CUIAutomation Object](uiauto-creatingcuiautomation.md).</span></span>

2.  <span data-ttu-id="cb974-120">**Получение интерфейсов Иуиаутоматионелемент для элементов пользовательского интерфейса из дерева модели автоматизации пользовательского интерфейса.**</span><span class="sxs-lookup"><span data-stu-id="cb974-120">**Retrieve IUIAutomationElement interfaces for UI elements from the UI Automation tree.**</span></span>

    <span data-ttu-id="cb974-121">Модель автоматизации пользовательского интерфейса предоставляет отдельные элементы пользовательского интерфейса в виде объектов, реализующих интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="cb974-121">UI Automation exposes individual UI elements as objects that implement the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface.</span></span> <span data-ttu-id="cb974-122">Сведения об элементе доступны клиентам через свойства, предоставляемые интерфейсом **иуиаутоматионелемент** элемента, а также с доступом к шаблонам элементов управления элемента.</span><span class="sxs-lookup"><span data-stu-id="cb974-122">Information about an element is available to clients through properties exposed by the element's **IUIAutomationElement** interface, along with access to the element's control patterns.</span></span> <span data-ttu-id="cb974-123">Свойства и методы, предоставляемые интерфейсами шаблонов элементов управления, предоставляют доступ к информации и функциональным возможностям, относящимся к конкретному элементу управления.</span><span class="sxs-lookup"><span data-stu-id="cb974-123">Properties and methods exposed by the control pattern interfaces provide access to control-specific information and functionality.</span></span>

    <span data-ttu-id="cb974-124">Объекты элементов модели автоматизации пользовательского интерфейса предоставляются клиентам в иерархической древовидной структуре, называемой деревом модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="cb974-124">The UI Automation element objects are provided to clients in a hierarchical tree structure called the UI Automation tree.</span></span> <span data-ttu-id="cb974-125">Клиенты используют методы, предоставляемые интерфейсом [**иуиаутоматион**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) , для получения интерфейсов [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для элементов пользовательского интерфейса в дереве и для получения других интерфейсов, используемых для поиска элементов, соответствующих определенному набору критериев.</span><span class="sxs-lookup"><span data-stu-id="cb974-125">Clients use methods exposed by the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) interface to retrieve [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements in the tree, and to retrieve other interfaces used to search the tree for elements that match a particular set of criteria.</span></span> <span data-ttu-id="cb974-126">Дополнительные сведения см. в разделе [Получение элементов автоматизации пользовательского интерфейса](uiauto-obtainingelements.md).</span><span class="sxs-lookup"><span data-stu-id="cb974-126">For more information, see [Obtaining UI Automation Elements](uiauto-obtainingelements.md).</span></span>

    <span data-ttu-id="cb974-127">При извлечении элементов пользовательского интерфейса клиенты могут повысить производительность системы с помощью возможностей кэширования в модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="cb974-127">When retrieving UI elements, clients can improve system performance by using the caching capabilities of UI Automation.</span></span> <span data-ttu-id="cb974-128">Кэширование позволяет клиенту указать набор свойств и шаблонов элементов управления, которые необходимо получить вместе с элементом.</span><span class="sxs-lookup"><span data-stu-id="cb974-128">Caching enables a client to specify a set of properties and control patterns to retrieve along with the element.</span></span> <span data-ttu-id="cb974-129">При одном многопроцессном вызове модель автоматизации пользовательского интерфейса извлекает элемент, заданные свойства и шаблоны элементов управления, а затем сохраняет их в кэше.</span><span class="sxs-lookup"><span data-stu-id="cb974-129">In a single interprocess call, UI Automation retrieves the element and the specified properties and control patterns, and then stores them in the cache.</span></span> <span data-ttu-id="cb974-130">Без кэширования для получения каждого свойства или шаблона элемента управления требуется отдельный межпроцессный вызов.</span><span class="sxs-lookup"><span data-stu-id="cb974-130">Without caching, a separate interprocess call is required to retrieve each property or control pattern.</span></span> <span data-ttu-id="cb974-131">Дополнительные сведения см. в разделе [кэширование свойств и шаблонов элементов управления автоматизации пользовательского интерфейса](uiauto-cachingforclients.md).</span><span class="sxs-lookup"><span data-stu-id="cb974-131">For more information, see [Caching UI Automation Properties and Control Patterns](uiauto-cachingforclients.md).</span></span>

3.  <span data-ttu-id="cb974-132">**Получение свойств элемента пользовательского интерфейса и вызов функциональности элемента пользовательского интерфейса.**</span><span class="sxs-lookup"><span data-stu-id="cb974-132">**Retrieve UI element properties and invoke UI element functionality.**</span></span>

    <span data-ttu-id="cb974-133">Клиенты используют интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для извлечения свойств элемента и шаблонов элементов управления.</span><span class="sxs-lookup"><span data-stu-id="cb974-133">Clients use the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface to retrieve an element's properties and control patterns.</span></span> <span data-ttu-id="cb974-134">Интерфейс включает две версии метода получения свойств — одна версия извлекает свойство из кэша, а другой извлекает свойство от поставщика.</span><span class="sxs-lookup"><span data-stu-id="cb974-134">The interface includes two versions of each property retrieval method—one version retrieves the property from the cache, the other retrieves the property from the provider.</span></span> <span data-ttu-id="cb974-135">Дополнительные сведения см. в разделе [Получение свойств элементов модели автоматизации пользовательского интерфейса](uiauto-propertiesforclients.md).</span><span class="sxs-lookup"><span data-stu-id="cb974-135">For more information, see [Retrieving Properties from UI Automation Elements](uiauto-propertiesforclients.md).</span></span>

4.  <span data-ttu-id="cb974-136">**Реагирование на события модели автоматизации пользовательского интерфейса.**</span><span class="sxs-lookup"><span data-stu-id="cb974-136">**Respond to UI Automation events.**</span></span>

    <span data-ttu-id="cb974-137">Поставщики автоматизации пользовательского интерфейса уведомляют клиентов об изменениях или важных событиях в пользовательском интерфейсе, создавая события.</span><span class="sxs-lookup"><span data-stu-id="cb974-137">UI Automation providers notify clients of changes or important occurrences in the UI by raising events.</span></span> <span data-ttu-id="cb974-138">Клиенты должны определить, какие события им нужны, а затем реализовать и зарегистрировать интерфейсы обработки событий для получения и обработки этих событий.</span><span class="sxs-lookup"><span data-stu-id="cb974-138">Clients must determine which events they need, and then implement and register event handling interfaces to receive and process those events.</span></span> <span data-ttu-id="cb974-139">Дополнительные сведения см. [в разделе Подписка на события модели автоматизации пользовательского интерфейса](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="cb974-139">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="cb974-140">См. также</span><span class="sxs-lookup"><span data-stu-id="cb974-140">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="cb974-141">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="cb974-141">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="cb974-142">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="cb974-142">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="cb974-143">Общие сведения о свойствах автоматизированного пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="cb974-143">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> <dt>

[<span data-ttu-id="cb974-144">Обзор событий автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="cb974-144">UI Automation Events Overview</span></span>](uiauto-eventsoverview.md)
</dt> </dl>

 

 