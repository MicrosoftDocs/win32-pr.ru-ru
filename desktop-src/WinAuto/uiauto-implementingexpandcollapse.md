---
title: Шаблон элемента управления ExpandCollapse
description: Описывает правила и соглашения для реализации Иекспандколлапсепровидер, включая сведения о свойствах, методах и событиях.
ms.assetid: 0ffc26c3-8696-44f9-b463-902a69e06d21
keywords:
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления ExpandCollapse
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления ExpandCollapse
- Модель автоматизации пользовательского интерфейса, Иекспандколлапсепровидер
- IExpandCollapseProvider
- реализация шаблонов элементов управления ExpandCollapse модели автоматизации пользовательского интерфейса
- Шаблоны элементов управления ExpandCollapse
- шаблоны элементов управления, Иекспандколлапсепровидер
- шаблоны элементов управления, реализация модели автоматизации пользовательского интерфейса ExpandCollapse
- шаблоны элементов управления, ExpandCollapse
- интерфейсы, Иекспандколлапсепровидер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45bd28ddcc201dcff0a4811a1eb8e04670f93091
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067738"
---
# <a name="expandcollapse-control-pattern"></a><span data-ttu-id="35c10-113">Шаблон элемента управления ExpandCollapse</span><span class="sxs-lookup"><span data-stu-id="35c10-113">ExpandCollapse Control Pattern</span></span>

<span data-ttu-id="35c10-114">Описывает правила и соглашения для реализации [**иекспандколлапсепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), включая сведения о свойствах, методах и событиях.</span><span class="sxs-lookup"><span data-stu-id="35c10-114">Describes guidelines and conventions for implementing [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), including information about properties, methods, and events.</span></span> <span data-ttu-id="35c10-115">Шаблон элемента управления **ExpandCollapse** используется для поддержки элементов управления, которые визуально разворачиваются для отображения большего содержимого и сворачиваются для скрытия содержимого.</span><span class="sxs-lookup"><span data-stu-id="35c10-115">The **ExpandCollapse** control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span>

<span data-ttu-id="35c10-116">Примеры элементов управления, реализующих этот шаблон элемента управления, см. в разделе [типы элементов управления и поддерживаемые шаблоны элементов управления](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="35c10-116">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

<span data-ttu-id="35c10-117">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="35c10-117">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="35c10-118">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="35c10-118">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="35c10-119">Обязательные члены для **иекспандколлапсепровидер**</span><span class="sxs-lookup"><span data-stu-id="35c10-119">Required Members for **IExpandCollapseProvider**</span></span>](#required-members-for-iexpandcollapseprovider)
-   [<span data-ttu-id="35c10-120">См. также</span><span class="sxs-lookup"><span data-stu-id="35c10-120">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="35c10-121">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="35c10-121">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="35c10-122">При реализации шаблона элемента управления **ExpandCollapse** Обратите внимание на следующие правила и соглашения.</span><span class="sxs-lookup"><span data-stu-id="35c10-122">When implementing the **ExpandCollapse** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="35c10-123">Агрегатные элементы управления, построенные с помощью дочерних объектов, которые предоставляют пользовательский интерфейс с функциональностью развертывания и свертывания, должны поддерживать шаблон элемента управления **ExpandCollapse** , а их дочерние элементы — нет.</span><span class="sxs-lookup"><span data-stu-id="35c10-123">Aggregate controls, built with child objects that provide the UI with expand/collapse functionality, must support the **ExpandCollapse** control pattern whereas their child elements do not.</span></span> <span data-ttu-id="35c10-124">Например, элемент управления "поле со списком" создается с помощью сочетания элементов управления "список", "Кнопка" и "Правка", но это только родительское поле со списком, которое должно поддерживать шаблон элемента управления **ExpandCollapse** .</span><span class="sxs-lookup"><span data-stu-id="35c10-124">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the **ExpandCollapse** control pattern.</span></span>
    > [!Note]  
    > <span data-ttu-id="35c10-125">Исключением является элемент управления Menu, который представляет собой статистическое выражение отдельных объектов пунктов меню.</span><span class="sxs-lookup"><span data-stu-id="35c10-125">An exception is the menu control, which is an aggregate of individual menu item objects.</span></span> <span data-ttu-id="35c10-126">Объекты пунктов меню могут поддерживать шаблон элемента управления **ExpandCollapse** , но родительский элемент управления Menu не может.</span><span class="sxs-lookup"><span data-stu-id="35c10-126">The menu item objects can support the **ExpandCollapse** control pattern, but the parent menu control cannot.</span></span> <span data-ttu-id="35c10-127">Аналогичное исключение применяется к элементам управления "дерево" и "элемент дерева".</span><span class="sxs-lookup"><span data-stu-id="35c10-127">A similar exception applies to the tree and tree item controls.</span></span>

     

-   <span data-ttu-id="35c10-128">Если для элемента управления [**иекспандколлапсепровидер:: ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) задано значение **ExpandCollapseState \_ леафноде**, то все функции **ExpandCollapse** в настоящее время неактивны для элемента управления, и единственной информацией, которая может быть получена с помощью этого шаблона элемента управления, является **ExpandCollapseState**.</span><span class="sxs-lookup"><span data-stu-id="35c10-128">When the [**IExpandCollapseProvider::ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) of a control is set to **ExpandCollapseState\_LeafNode**, any **ExpandCollapse** functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the **ExpandCollapseState**.</span></span> <span data-ttu-id="35c10-129">При последующем добавлении каких-либо дочерних объектов активируется функция **ExpandCollapseState** Changes и **ExpandCollapse** .</span><span class="sxs-lookup"><span data-stu-id="35c10-129">If any child objects are subsequently added, the **ExpandCollapseState** changes and **ExpandCollapse** functionality is activated.</span></span>
-   <span data-ttu-id="35c10-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) относится только к видимости непосредственных дочерних объектов; Он не ссылается на видимость всех объектов-потомков.</span><span class="sxs-lookup"><span data-stu-id="35c10-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>
-   <span data-ttu-id="35c10-131">Функция [**иекспандколлапсепровидер:: Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) и [**сворачивания**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) зависит от конкретного элемента управления.</span><span class="sxs-lookup"><span data-stu-id="35c10-131">[**IExpandCollapseProvider::Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) and [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) functionality is control-specific.</span></span> <span data-ttu-id="35c10-132">Ниже представлены примеры такого поведения.</span><span class="sxs-lookup"><span data-stu-id="35c10-132">The following are examples of this behavior.</span></span>
    -   <span data-ttu-id="35c10-133">Меню Office Personal может быть элементом меню с тремя состояниями ("развернуто", "свернуто" и "Партиаллекспандед"), где элемент управления определяет состояние, которое необходимо принять при вызове [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) или [**сворачивания**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) .</span><span class="sxs-lookup"><span data-stu-id="35c10-133">The Office Personal Menu can be a three-state menu item ("Expanded", "Collapsed" and "PartiallyExpanded") where the control specifies the state to adopt when [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) is called.</span></span>
    -   <span data-ttu-id="35c10-134">При вызове [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) для элемента дерева могут отображаться все потомки или только непосредственные дочерние элементы.</span><span class="sxs-lookup"><span data-stu-id="35c10-134">Calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) on a tree item may display all descendants or only immediate children.</span></span>
    -   <span data-ttu-id="35c10-135">Если вызов метода [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) или [**сворачивания**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) для элемента управления поддерживает состояние его потомков, необходимо отправить событие изменения видимости, а не событие изменения состояния.</span><span class="sxs-lookup"><span data-stu-id="35c10-135">If calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event.</span></span> <span data-ttu-id="35c10-136">Если родительский элемент управления не сохраняет состояние его потомков при свертывании, элемент управления может уничтожить все потомки, которые больше не видны, и вызвать уничтоженное событие. или может изменить [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) для каждого потомка и вызвать событие изменения видимости.</span><span class="sxs-lookup"><span data-stu-id="35c10-136">If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) for each descendant and raise a visibility change event.</span></span>
-   <span data-ttu-id="35c10-137">Чтобы гарантировать навигацию, желательно, чтобы объект находящегося в дереве Microsoft UI Automation (с соответствующим состоянием видимости), независимо от его родителей- [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate).</span><span class="sxs-lookup"><span data-stu-id="35c10-137">To guarantee navigation, it is desirable for an object to be in the Microsoft UI Automation tree (with appropriate visibility state) regardless of its parents [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate).</span></span> <span data-ttu-id="35c10-138">Если потомки создаются по запросу, они могут отображаться только в дереве модели автоматизации пользовательского интерфейса после того, как они отображаются в первый раз или только когда они видимы.</span><span class="sxs-lookup"><span data-stu-id="35c10-138">If descendants are generated on demand, they may only appear in the UI Automation tree after being displayed for the first time or only while they are visible.</span></span>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="35c10-139">Обязательные члены для **иекспандколлапсепровидер**</span><span class="sxs-lookup"><span data-stu-id="35c10-139">Required Members for **IExpandCollapseProvider**</span></span>

<span data-ttu-id="35c10-140">Для реализации интерфейса [**иекспандколлапсепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) требуются следующие свойства, методы и события.</span><span class="sxs-lookup"><span data-stu-id="35c10-140">The following properties, methods, and events are required for implementing the [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) interface.</span></span>



| <span data-ttu-id="35c10-141">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="35c10-141">Required members</span></span>                                                                                    | <span data-ttu-id="35c10-142">Тип члена</span><span class="sxs-lookup"><span data-stu-id="35c10-142">Member type</span></span> | <span data-ttu-id="35c10-143">Примечания</span><span class="sxs-lookup"><span data-stu-id="35c10-143">Notes</span></span>                                                                  |
|-----------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------|
| [<span data-ttu-id="35c10-144">**ExpandCollapseState**</span><span class="sxs-lookup"><span data-stu-id="35c10-144">**ExpandCollapseState**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate)                   | <span data-ttu-id="35c10-145">Свойство</span><span class="sxs-lookup"><span data-stu-id="35c10-145">Property</span></span>    | <span data-ttu-id="35c10-146">Нет</span><span class="sxs-lookup"><span data-stu-id="35c10-146">None</span></span>                                                                   |
| [<span data-ttu-id="35c10-147">**Разверните**</span><span class="sxs-lookup"><span data-stu-id="35c10-147">**Expand**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand)                                             | <span data-ttu-id="35c10-148">Метод</span><span class="sxs-lookup"><span data-stu-id="35c10-148">Method</span></span>      | <span data-ttu-id="35c10-149">Нет</span><span class="sxs-lookup"><span data-stu-id="35c10-149">None</span></span>                                                                   |
| [<span data-ttu-id="35c10-150">**Свернуть**</span><span class="sxs-lookup"><span data-stu-id="35c10-150">**Collapse**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse)                                         | <span data-ttu-id="35c10-151">Метод</span><span class="sxs-lookup"><span data-stu-id="35c10-151">Method</span></span>      | <span data-ttu-id="35c10-152">Нет</span><span class="sxs-lookup"><span data-stu-id="35c10-152">None</span></span>                                                                   |
| [<span data-ttu-id="35c10-153">**иуиаутоматионпропертичанжедевенсандлер**</span><span class="sxs-lookup"><span data-stu-id="35c10-153">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler) | <span data-ttu-id="35c10-154">Событие</span><span class="sxs-lookup"><span data-stu-id="35c10-154">Event</span></span>       | <span data-ttu-id="35c10-155">Этот элемент управления не имеет связанных событий; Используйте этот универсальный обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="35c10-155">This control has no associated events; use this generic event handler.</span></span> |



 

## <a name="related-topics"></a><span data-ttu-id="35c10-156">См. также</span><span class="sxs-lookup"><span data-stu-id="35c10-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="35c10-157">Типы элементов управления и поддерживаемые ими шаблоны элементов управления</span><span class="sxs-lookup"><span data-stu-id="35c10-157">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="35c10-158">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="35c10-158">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="35c10-159">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="35c10-159">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 




