---
title: Обработка сообщения WM_GETOBJECT
description: Как Microsoft Active Accessibility, так и Microsoft UI Automation отправляют \_ сообщение WM GetObject серверу или приложению поставщика для получения сведений о доступном объекте, поддерживаемом сервером или поставщиком.
ms.assetid: 4b8e551f-aba7-4a89-8874-ba690175f525
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 695fad8f050606f0a95a1780551d35499e39d166
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105710331"
---
# <a name="handling-the-wm_getobject-message"></a><span data-ttu-id="c43fa-103">Обработка сообщения WM \_ GetObject</span><span class="sxs-lookup"><span data-stu-id="c43fa-103">Handling the WM\_GETOBJECT Message</span></span>

<span data-ttu-id="c43fa-104">Как Microsoft Active Accessibility, так и Microsoft UI Automation отправляют сообщение [**WM \_ GetObject**](wm-getobject.md) серверу или приложению поставщика для получения сведений о доступном объекте, поддерживаемом сервером или поставщиком.</span><span class="sxs-lookup"><span data-stu-id="c43fa-104">Both Microsoft Active Accessibility and Microsoft UI Automation send the [**WM\_GETOBJECT**](wm-getobject.md) message to a server or provider application to retrieve information about an accessible object supported by the server or provider.</span></span> <span data-ttu-id="c43fa-105">Клиенты никогда не отправляют **WM \_ GetObject** напрямую.</span><span class="sxs-lookup"><span data-stu-id="c43fa-105">Clients never send **WM\_GETOBJECT** directly.</span></span> <span data-ttu-id="c43fa-106">Вместо этого, Microsoft Active Accessibility отправляет это сообщение, когда клиент вызывает функции [**акцессиблеобжектфромпоинт**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)и [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-106">Instead, Microsoft Active Accessibility sends this message when a client calls the [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) functions.</span></span> <span data-ttu-id="c43fa-107">Автоматизация пользовательского интерфейса **отправляет \_ объект WM GetObject** , когда клиент [**вызывает иуиаутоматион:: Елементфромхандле**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**елементфромпоинт**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)и [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), а также при обработке событий, для которых зарегистрирован клиент.</span><span class="sxs-lookup"><span data-stu-id="c43fa-107">UI Automation sends **WM\_GETOBJECT** when a client calls [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint), and [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), and when handling events for which the client has registered.</span></span>

<span data-ttu-id="c43fa-108">Microsoft Active Accessibility или модель автоматизации пользовательского интерфейса определяет тип объекта, для которого требуются сведения, передавая значение, называемое *идентификатором объекта* , с сообщением [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-108">Microsoft Active Accessibility or UI Automation specifies the type of object it needs information for by passing a valued called an *object identifier* with the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="c43fa-109">При получении сообщения сервер или поставщик проверяет идентификатор объекта, чтобы определить, как реагировать на сообщение.</span><span class="sxs-lookup"><span data-stu-id="c43fa-109">When it receives the message, the server or provider examines the object identifier to determine how to respond to the message.</span></span> <span data-ttu-id="c43fa-110">Ответ зависит от того, реализует ли принимающее приложение Microsoft Active Accessibility (сервер), автоматизацию пользовательского интерфейса (поставщика) или ни один из них для указанного объекта.</span><span class="sxs-lookup"><span data-stu-id="c43fa-110">The response depends on whether the receiving application implements Microsoft Active Accessibility (a server), UI Automation (a provider), or neither, for the specified object.</span></span>

-   <span data-ttu-id="c43fa-111">Если принимающее приложение является сервером Microsoft Active Accessibility, а сообщение [**WM \_ GetObject**](wm-getobject.md) содержит идентификатор объекта [**\_ клиента OBJID**](object-identifiers.md), сервер должен вернуть значение, полученное путем передачи интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) объекта в функцию [**функции lresultfromobject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-111">If the receiving application is an Microsoft Active Accessibility server and the [**WM\_GETOBJECT**](wm-getobject.md) message includes an object identifier of [**OBJID\_CLIENT**](object-identifiers.md), the server should return the value obtained by passing the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object to the [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) function.</span></span>
-   <span data-ttu-id="c43fa-112">Если принимающее приложение является поставщиком автоматизации АУИ и идентификатором объекта является **уиарутобжектид**, поставщик должен вернуть интерфейс [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) объекта.</span><span class="sxs-lookup"><span data-stu-id="c43fa-112">If the receiving application is aUI Automation provider and the object identifier is **UiaRootObjectId**, the provider should return the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface of the object.</span></span> <span data-ttu-id="c43fa-113">Поставщик получает интерфейс путем вызова функции [**уиаретурнравелементпровидер**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-113">The provider obtains the interface by calling the [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) function.</span></span>
-   <span data-ttu-id="c43fa-114">Если принимающее приложение не реализует ни Microsoft Active Accessibility, ни автоматизацию пользовательского интерфейса, оно должно передать сообщение [**WM \_ GetObject**](wm-getobject.md) функции [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-114">If the receiving application implements neither Microsoft Active Accessibility nor UI Automation, it should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="c43fa-115">Передача сообщения позволяет платформе специальных возможностей определить, доступен ли прокси-сервер для указанного объекта.</span><span class="sxs-lookup"><span data-stu-id="c43fa-115">Passing the message enables the accessibility framework to determine if a proxy is available for the specified object.</span></span>
-   <span data-ttu-id="c43fa-116">Если идентификатор объекта не является ни [**OBJID \_ клиентом**](object-identifiers.md) , ни уиарутобжектид, принимающее приложение должно передать сообщение [**WM \_ GetObject**](wm-getobject.md) функции [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-116">If the object identifier is neither [**OBJID\_CLIENT**](object-identifiers.md) nor UiaRootObjectId, the receiving application should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="c43fa-117">Передача сообщения позволяет платформе специальных возможностей использовать поставщики по умолчанию для стандартных элементов пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="c43fa-117">Passing the message enables the accessibility framework to use the default providers for standard UI elements.</span></span>

<span data-ttu-id="c43fa-118">Microsoft Active Accessibility и служба автоматизации пользовательского интерфейса могут передавать идентификаторы пользовательских объектов в сообщении [**WM \_ GetObject**](wm-getobject.md) для получения определяемых приложением значений или объектов с сервера или поставщика.</span><span class="sxs-lookup"><span data-stu-id="c43fa-118">Microsoft Active Accessibility and UI Automation can pass custom object identifiers in a [**WM\_GETOBJECT**](wm-getobject.md) message to retrieve application-defined values or objects from a server or provider.</span></span> <span data-ttu-id="c43fa-119">Идентификатор объекта [**OBJID \_ Нативеом**](object-identifiers.md) или [**OBJID \_ куерикласснамеидкс**](object-identifiers.md) можно использовать для получения интерфейса собственной объектной модели или для запроса определенного прокси-объекта, поддерживаемого Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="c43fa-119">The [**OBJID\_NATIVEOM**](object-identifiers.md) or [**OBJID\_QUERYCLASSNAMEIDX**](object-identifiers.md) object identifier can be used to retrieve a native Object Model interface, or to request a specific proxy object that is supported by Oleacc.dll.</span></span>

<span data-ttu-id="c43fa-120">При обработке идентификаторов [**OBJID \_ клиента**](object-identifiers.md) и объекта **уиарутобжектид** реализация сервера Microsoft Active Accessibility Server может сосуществовать наряду с реализацией поставщика автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="c43fa-120">By handling both the [**OBJID\_CLIENT**](object-identifiers.md) and **UiaRootObjectId** object identifiers, a Microsoft Active Accessibility server implementation can co-exist alongside a UI Automation provider implementation.</span></span> <span data-ttu-id="c43fa-121">Так как большинство стандартных элементов управления Windows и стандартных элементов управления, реализованных в общей библиотеке элементов управления (ComCtl32.dll), не реализуют ни Microsoft Active Accessibility, ни автоматизацию пользовательского интерфейса, эти элементы управления обычно не обрабатывали сообщение [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="c43fa-121">Because most standard Windows controls and common controls implemented by the common control library (ComCtl32.dll) do not implement either Microsoft Active Accessibility or UI Automation, these controls typically do not handle the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="c43fa-122">Вместо этого платформа Microsoft Active Accessibility или модель автоматизации пользовательского интерфейса проверяет, доступен ли прокси-объект для определенного элемента пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="c43fa-122">Instead, the Microsoft Active Accessibility or UI Automation framework checks if a proxy object is available for a particular UI element.</span></span> <span data-ttu-id="c43fa-123">В противном случае он предоставляет прокси-объект по умолчанию для объекта окна узла.</span><span class="sxs-lookup"><span data-stu-id="c43fa-123">Otherwise, it provides the default proxy object for the host window object.</span></span>

 

 