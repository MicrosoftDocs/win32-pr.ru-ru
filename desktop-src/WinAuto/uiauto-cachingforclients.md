---
title: Кэширование свойств и шаблонов элементов управления автоматизации пользовательского интерфейса
description: При использовании Microsoft UI Automation клиентам часто требуется получить несколько свойств для нескольких элементов автоматизации.
ms.assetid: 948b3bb9-75a9-4197-9680-e6fe7bb86feb
keywords:
- кэширование, свойства модели автоматизации пользовательского интерфейса
- кэширование, свойства
- кэширование, шаблоны элементов управления модели автоматизации пользовательского интерфейса
- кэширование, шаблоны элементов управления
- Модель автоматизации пользовательского интерфейса, свойства кэширования
- Модель автоматизации пользовательского интерфейса, кэширование свойств
- Клиенты, свойства автоматизации пользовательского интерфейса кэширования
- Клиенты, шаблоны элементов управления автоматизации пользовательского интерфейса для кэширования
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления кэшированием
- Модель автоматизации пользовательского интерфейса, кэширование шаблонов элементов управления
- шаблоны элементов управления, кэширование
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 69f75a7dc9491565fdfdc0ecc73808c2fb6a9d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104410764"
---
# <a name="caching-ui-automation-properties-and-control-patterns"></a><span data-ttu-id="7fe70-114">Кэширование свойств и шаблонов элементов управления автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="7fe70-114">Caching UI Automation Properties and Control Patterns</span></span>

<span data-ttu-id="7fe70-115">При использовании Microsoft UI Automation клиентам часто требуется получить несколько свойств для нескольких элементов автоматизации.</span><span class="sxs-lookup"><span data-stu-id="7fe70-115">When using Microsoft UI Automation, clients often need to retrieve multiple properties for multiple automation elements.</span></span> <span data-ttu-id="7fe70-116">Клиент может получить отдельные свойства по одному элементу за раз, используя методы получения свойств, такие как [**иуиаутоматионелемент:: куррентнаме**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) или [**куррентакцесскэй**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span><span class="sxs-lookup"><span data-stu-id="7fe70-116">A client could retrieve individual properties one element at a time by using the property retrieval methods such as [**IUIAutomationElement::CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) or [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span></span> <span data-ttu-id="7fe70-117">Однако этот метод работает достаточно долго и неэффективно, поскольку для каждого получаемого свойства требуется кросс-процессный вызов.</span><span class="sxs-lookup"><span data-stu-id="7fe70-117">However, this method is slow and inefficient because it requires a cross-process call for each property being retrieved.</span></span> <span data-ttu-id="7fe70-118">Для повышения производительности клиенты могут использовать функции кэширования (также называемые массовым извлечением) модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7fe70-118">To improve performance, clients can use the caching (also called bulk fetching) capabilities of UI Automation.</span></span> <span data-ttu-id="7fe70-119">Кэширование позволяет клиенту получать все необходимые свойства для всех нужных элементов с помощью одного вызова метода.</span><span class="sxs-lookup"><span data-stu-id="7fe70-119">Caching enables a client to retrieve all of the desired properties for all of the desired elements with a single method call.</span></span> <span data-ttu-id="7fe70-120">Затем клиент может получить отдельные свойства из кэша по мере необходимости и периодически получать новый моментальный снимок кэша, обычно в ответ на события, которые обозначают изменения в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="7fe70-120">The client can then retrieve the individual properties from the cache as needed, and can get a new snapshot of the cache periodically, generally in response to events that signify changes in the UI.</span></span>

<span data-ttu-id="7fe70-121">Приложение может запрашивать кэширование при извлечении элемента модели автоматизации пользовательского интерфейса с помощью метода, такого как [**иуиаутоматион:: елементфромпоинтбуилдкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**Иуиаутоматионтривалкер:: жетфирстчилделементбуилдкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache)или [**IUIAutomationElement:: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span><span class="sxs-lookup"><span data-stu-id="7fe70-121">The application can request caching when it retrieves a UI Automation element by using a method, such as [**IUIAutomation::ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker::GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache), or [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span></span>

<span data-ttu-id="7fe70-122">Кэширование также происходит при указании запроса кэша во время подписки на события.</span><span class="sxs-lookup"><span data-stu-id="7fe70-122">Caching also occurs when you specify a cache request while subscribing to events.</span></span> <span data-ttu-id="7fe70-123">Элемент модели автоматизации пользовательского интерфейса, переданный обработчику событий как источник события, содержит кэшированные свойства и шаблоны элементов управления, заданные запросом кэша.</span><span class="sxs-lookup"><span data-stu-id="7fe70-123">The UI Automation element passed to your event handler as the source of an event contains the cached properties and control patterns that are specified by the cache request.</span></span> <span data-ttu-id="7fe70-124">Любые изменения, внесенные в запрос кэша после подписки на событие, не действуют.</span><span class="sxs-lookup"><span data-stu-id="7fe70-124">Any changes made to the cache request after you subscribe to the event have no effect.</span></span>

<span data-ttu-id="7fe70-125">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="7fe70-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="7fe70-126">Запросы кэша</span><span class="sxs-lookup"><span data-stu-id="7fe70-126">Cache Requests</span></span>](#cache-requests)
    -   [<span data-ttu-id="7fe70-127">Указание свойств и шаблонов элементов управления для кэширования</span><span class="sxs-lookup"><span data-stu-id="7fe70-127">Specifying Property and Control Patterns to Cache</span></span>](#specifying-property-and-control-patterns-to-cache)
    -   [<span data-ttu-id="7fe70-128">Указание области и фильтрации запроса кэширования</span><span class="sxs-lookup"><span data-stu-id="7fe70-128">Specifying the Scoping and Filtering of a Caching Request</span></span>](#specifying-the-scoping-and-filtering-of-a-caching-request)
    -   [<span data-ttu-id="7fe70-129">Стойкость ссылок на элементы</span><span class="sxs-lookup"><span data-stu-id="7fe70-129">Strength of Element References</span></span>](#strength-of-element-references)
-   [<span data-ttu-id="7fe70-130">Получение кэшированных дочерних и родительских элементов</span><span class="sxs-lookup"><span data-stu-id="7fe70-130">Retrieving Cached Children and Parents</span></span>](#retrieving-cached-children-and-parents)
-   [<span data-ttu-id="7fe70-131">Получение нового моментального снимка кэша</span><span class="sxs-lookup"><span data-stu-id="7fe70-131">Retrieving a New Snapshot of the Cache</span></span>](#retrieving-a-new-snapshot-of-the-cache)
-   [<span data-ttu-id="7fe70-132">Примеры</span><span class="sxs-lookup"><span data-stu-id="7fe70-132">Examples</span></span>](#examples)
-   [<span data-ttu-id="7fe70-133">См. также</span><span class="sxs-lookup"><span data-stu-id="7fe70-133">Related topics</span></span>](#related-topics)

## <a name="cache-requests"></a><span data-ttu-id="7fe70-134">Запросы кэша</span><span class="sxs-lookup"><span data-stu-id="7fe70-134">Cache Requests</span></span>

<span data-ttu-id="7fe70-135">Кэширование включает определение извлекаемых свойств и элементов, из которых они извлекаются, а затем использование этих сведений для создания запроса кэша.</span><span class="sxs-lookup"><span data-stu-id="7fe70-135">Caching involves determining which properties to retrieve and which elements to retrieve them from, and then using this information to create a cache request.</span></span> <span data-ttu-id="7fe70-136">Всякий раз, когда клиент получает интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для элемента пользовательского интерфейса, модель автоматизации пользовательского интерфейса кэширует сведения, указанные в запросе кэша.</span><span class="sxs-lookup"><span data-stu-id="7fe70-136">Whenever the client obtains an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for UI item, UI Automation caches the information that is specified in the cache request.</span></span>

<span data-ttu-id="7fe70-137">Чтобы создать запрос к кэшу, начните с использования метода [**иуиаутоматион:: креатекачерекуест**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) , чтобы получить указатель на интерфейс [**иуиаутоматионкачерекуест**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) .</span><span class="sxs-lookup"><span data-stu-id="7fe70-137">To create a cache request, begin by using the [**IUIAutomation::CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) method to retrieve an [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) interface pointer.</span></span> <span data-ttu-id="7fe70-138">Затем настройте запрос кэша с помощью методов **иуиаутоматионкачерекуест**.</span><span class="sxs-lookup"><span data-stu-id="7fe70-138">Next, configure the cache request by using the methods of **IUIAutomationCacheRequest**.</span></span>

### <a name="specifying-property-and-control-patterns-to-cache"></a><span data-ttu-id="7fe70-139">Указание свойств и шаблонов элементов управления для кэширования</span><span class="sxs-lookup"><span data-stu-id="7fe70-139">Specifying Property and Control Patterns to Cache</span></span>

<span data-ttu-id="7fe70-140">Вы можете указать свойства для кэширования, вызвав [**иуиаутоматионкачерекуест:: AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span><span class="sxs-lookup"><span data-stu-id="7fe70-140">You can specify properties to cache by calling [**IUIAutomationCacheRequest::AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span></span> <span data-ttu-id="7fe70-141">Вы можете указать шаблоны элементов управления для кэширования, вызвав [**иуиаутоматионкачерекуест:: аддпаттерн**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span><span class="sxs-lookup"><span data-stu-id="7fe70-141">You can specify control patterns to cache by calling [**IUIAutomationCacheRequest::AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span></span> <span data-ttu-id="7fe70-142">При кэшировании шаблона элемента управления его свойства не кэшируются автоматически. необходимо указать свойства, которые необходимо кэшировать с помощью **AddProperty**.</span><span class="sxs-lookup"><span data-stu-id="7fe70-142">When a control pattern is cached, its properties are not automatically cached; you must specify the properties you want to cache by using **AddProperty**.</span></span>

<span data-ttu-id="7fe70-143">Можно получить свойство шаблона элемента управления (например, свойство Value шаблона элемента управления [value](uiauto-implementingvalue.md) ), не получая весь шаблон элемента управления в кэш.</span><span class="sxs-lookup"><span data-stu-id="7fe70-143">You can retrieve a control pattern property (for example, the Value property of the [Value](uiauto-implementingvalue.md) control pattern), without having to retrieve the entire control pattern into the cache.</span></span> <span data-ttu-id="7fe70-144">Шаблон элемента управления необходимо получить только в том случае, если необходимо использовать метод шаблона элемента управления.</span><span class="sxs-lookup"><span data-stu-id="7fe70-144">You must retrieve the control pattern only if you need to use a control pattern method.</span></span>

### <a name="specifying-the-scoping-and-filtering-of-a-caching-request"></a><span data-ttu-id="7fe70-145">Указание области и фильтрации запроса кэширования</span><span class="sxs-lookup"><span data-stu-id="7fe70-145">Specifying the Scoping and Filtering of a Caching Request</span></span>

<span data-ttu-id="7fe70-146">Можно указать элементы, свойства и шаблоны элементов управления, которые необходимо кэшировать, задав свойство [**иуиаутоматионкачерекуест:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) перед использованием запроса.</span><span class="sxs-lookup"><span data-stu-id="7fe70-146">You can specify the elements whose properties and control patterns you want to cache by setting the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property before using the request.</span></span> <span data-ttu-id="7fe70-147">Область задается относительно элементов, извлекаемых методом, к которому передается запрос кэша.</span><span class="sxs-lookup"><span data-stu-id="7fe70-147">The scope is relative to the elements that are retrieved by the method to which the cache request is passed.</span></span> <span data-ttu-id="7fe70-148">Например, если задать только [**\_ дочерние элементы TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), а затем извлечь элемент модели автоматизации пользовательского интерфейса, будут кэшироваться свойства и шаблоны элементов управления дочерних элементов, но свойства и шаблоны элементов управления самого элемента не кэшируются.</span><span class="sxs-lookup"><span data-stu-id="7fe70-148">For example, if you set only [**TreeScope\_Children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), and then retrieve a UI Automation element, the properties and control patterns of children of that element are cached, but the properties and control patterns of the element itself are not cached.</span></span> <span data-ttu-id="7fe70-149">Чтобы обеспечить кэширование для полученного элемента, необходимо включить **\_ элемент TreeScope** в свойство **иуиаутоматионкачерекуест:: TreeScope** .</span><span class="sxs-lookup"><span data-stu-id="7fe70-149">To ensure that caching is done for the retrieved element itself, you must include **TreeScope\_Element** in the **IUIAutomationCacheRequest::TreeScope** property.</span></span> <span data-ttu-id="7fe70-150">Невозможно задать область **TreeScope \_ родительских** или **TreeScope \_ предков**.</span><span class="sxs-lookup"><span data-stu-id="7fe70-150">It is not possible to set the scope to **TreeScope\_Parent** or **TreeScope\_Ancestors**.</span></span> <span data-ttu-id="7fe70-151">Однако родительский элемент может быть кэширован, когда кэшируется дочерний элемент; см. подраздел "Получение кэшированных дочерних и родительских элементов" в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="7fe70-151">However, a parent element can be cached when a child element is cached; see Retrieving Cached Children and Parents in this topic.</span></span>

<span data-ttu-id="7fe70-152">На экстент кэширования также влияет свойство [**иуиаутоматионкачерекуест:: трифилтер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) .</span><span class="sxs-lookup"><span data-stu-id="7fe70-152">The extent of caching is also affected by the [**IUIAutomationCacheRequest::TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) property.</span></span> <span data-ttu-id="7fe70-153">По умолчанию кэширование выполняется только для элементов, которые отображаются в представлении элемента управления дерева модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7fe70-153">By default, caching is performed only for elements that appear in the control view of the UI Automation tree.</span></span> <span data-ttu-id="7fe70-154">Однако можно изменить это свойство, чтобы кэширование применялось ко всем элементам или только к элементам, отображаемым в представлении содержимого.</span><span class="sxs-lookup"><span data-stu-id="7fe70-154">However, you can change this property to apply caching to all elements, or only to elements that appear in the content view.</span></span>

### <a name="strength-of-element-references"></a><span data-ttu-id="7fe70-155">Стойкость ссылок на элементы</span><span class="sxs-lookup"><span data-stu-id="7fe70-155">Strength of Element References</span></span>

<span data-ttu-id="7fe70-156">При извлечении элемента автоматизации по умолчанию у вас есть доступ ко всем свойствам и шаблонам элементов управления этого элемента, включая те свойства и шаблоны элементов управления, которые не были кэшированы.</span><span class="sxs-lookup"><span data-stu-id="7fe70-156">When you retrieve an automation element, by default you have access to all properties and control patterns of that element, including those properties and control patterns that were not cached.</span></span> <span data-ttu-id="7fe70-157">Однако можно указать, что ссылка на элемент ссылается только на кэшированные данные, задав для свойства [**иуиаутоматионкачерекуест:: аутоматионелементмоде**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) значение **аутоматионелементмоде \_ None**.</span><span class="sxs-lookup"><span data-stu-id="7fe70-157">However, you can specify that the reference to the element refers to cached data only, by setting the [**IUIAutomationCacheRequest::AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) property to **AutomationElementMode\_None**.</span></span> <span data-ttu-id="7fe70-158">В этом случае у вас нет доступа к некэшированным свойствам и шаблонам элементов управления извлеченных элементов.</span><span class="sxs-lookup"><span data-stu-id="7fe70-158">In this case, you do not have access to any uncached properties and control patterns of retrieved elements.</span></span> <span data-ttu-id="7fe70-159">Это означает, что вы не можете получить доступ к любым текущим свойствам, таким как [**иуиаутоматионелемент:: куррентисенаблед**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) , или получить шаблон элемента управления с помощью [**Иуиаутоматионелемент:: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span><span class="sxs-lookup"><span data-stu-id="7fe70-159">This means that you cannot access any current properties such as [**IUIAutomationElement::CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) or retrieve a control pattern by using [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span></span> <span data-ttu-id="7fe70-160">В кэшированных шаблонах элементов управления нельзя вызывать методы, выполняющие действия с элементом управления, например [**иуиаутоматионинвокепаттерн:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="7fe70-160">On cached control patterns, you cannot call methods that perform actions on the control, such as [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="7fe70-161">Примером приложения, которое может не требовать полных ссылок на объекты, является средство чтения с экрана, которое может выполнять предварительную выборку имени и свойства типа элементов в окне, не требуя самих объектов элементов автоматизации.</span><span class="sxs-lookup"><span data-stu-id="7fe70-161">An example of an application that might not need full references to objects is a screen reader, which might prefetch the name and control type properties of elements in a window without needing the automation element objects themselves.</span></span>

## <a name="retrieving-cached-children-and-parents"></a><span data-ttu-id="7fe70-162">Получение кэшированных дочерних и родительских элементов</span><span class="sxs-lookup"><span data-stu-id="7fe70-162">Retrieving Cached Children and Parents</span></span>

<span data-ttu-id="7fe70-163">При получении элемента автоматизации и запросе кэширования для дочерних элементов этого элемента через свойство [**иуиаутоматионкачерекуест:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) запроса можно получить дочерние элементы, вызвав [**Иуиаутоматионелемент:: жеткачедчилдрен**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) в извлеченном элементе.</span><span class="sxs-lookup"><span data-stu-id="7fe70-163">When you retrieve an automation element and request caching for children of that element through the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property of the request, it is possible to get the child elements by calling [**IUIAutomationElement::GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) on the element you retrieved.</span></span>

<span data-ttu-id="7fe70-164">Если [**\_ элемент TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) был включен в область запроса кэша, корневой элемент запроса можно получить, вызвав [**иуиаутоматионелемент:: жеткачедпарент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) в любом из дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="7fe70-164">If [**TreeScope\_Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) was included in the scope of the cache request, the root element of the request can be retrieved by calling [**IUIAutomationElement::GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) on any of the child elements.</span></span>

> [!Note]  
> <span data-ttu-id="7fe70-165">Нельзя кэшировать родителей или предков корневого элемента запроса.</span><span class="sxs-lookup"><span data-stu-id="7fe70-165">You cannot cache parents or ancestors of the root element of the request.</span></span>

 

## <a name="retrieving-a-new-snapshot-of-the-cache"></a><span data-ttu-id="7fe70-166">Получение нового моментального снимка кэша</span><span class="sxs-lookup"><span data-stu-id="7fe70-166">Retrieving a New Snapshot of the Cache</span></span>

<span data-ttu-id="7fe70-167">Кэш действителен только при условии, что в пользовательском интерфейсе ничего не меняется.</span><span class="sxs-lookup"><span data-stu-id="7fe70-167">The cache is valid only as long as nothing changes in the UI.</span></span> <span data-ttu-id="7fe70-168">Приложение отвечает за получение нового моментального снимка кэша, как правило, в ответ на события.</span><span class="sxs-lookup"><span data-stu-id="7fe70-168">Your application is responsible for retrieving a new snapshot of the cache, typically, in response to events.</span></span>

<span data-ttu-id="7fe70-169">При оформлении подписки на событие с запросом кэша вы получаете [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) новый моментальный снимок кэша в качестве источника события при каждом вызове обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="7fe70-169">If you subscribe to an event with a cache request, you obtain an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) new snapshot of the cache as the source of the event whenever your event handler is called.</span></span> <span data-ttu-id="7fe70-170">Можно также получить новый моментальный снимок кэшированных данных для элемента, вызвав [**иуиаутоматионелемент:: буилдупдатедкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span><span class="sxs-lookup"><span data-stu-id="7fe70-170">You can also retrieve a new snapshot of cached information for an element by calling [**IUIAutomationElement::BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span></span> <span data-ttu-id="7fe70-171">Вы можете передать исходный [**иуиаутоматионкачерекуест**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) , чтобы получить новый моментальный снимок всех данных, которые были ранее кэшированы.</span><span class="sxs-lookup"><span data-stu-id="7fe70-171">You can pass in the original [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) to get a new snapshot of all information that was previously cached.</span></span>

<span data-ttu-id="7fe70-172">Получение нового моментального снимка кэша не изменяет свойства существующих ссылок [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="7fe70-172">Retrieving a new snapshot of the cache does not modify the properties of any existing [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) references.</span></span>

## <a name="examples"></a><span data-ttu-id="7fe70-173">Примеры</span><span class="sxs-lookup"><span data-stu-id="7fe70-173">Examples</span></span>

<span data-ttu-id="7fe70-174">Примеры кода, демонстрирующие использование возможностей кэширования в модели автоматизации пользовательского интерфейса, см. [в статье Использование кэширования](uiauto-howto-use-caching.md).</span><span class="sxs-lookup"><span data-stu-id="7fe70-174">For code examples that show how to use the caching capabilities of UI Automation, see [How to Use Caching](uiauto-howto-use-caching.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7fe70-175">См. также</span><span class="sxs-lookup"><span data-stu-id="7fe70-175">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="7fe70-176">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="7fe70-176">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="7fe70-177">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="7fe70-177">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="7fe70-178">Получение элементов автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="7fe70-178">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="7fe70-179">Общие сведения о свойствах автоматизированного пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="7fe70-179">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> </dl>

 

 




