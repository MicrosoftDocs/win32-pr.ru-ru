---
title: Текстовые модули для автоматизации пользовательского интерфейса
description: В этом разделе описываются единицы текста, поддерживаемые автоматизацией пользовательского интерфейса Майкрософт \ 32; Шаблон элемента управления TextRange. Поставщики и клиенты автоматизации пользовательского интерфейса используют текстовые единицы для указания величины перемещения или изменения размера текстового диапазона.
ms.assetid: 3ec43a81-c4f1-4c73-865f-a60c751fc3fb
keywords:
- Автоматизация пользовательского интерфейса, единицы измерения текста
- единицы текста, сведения
- Модель автоматизации пользовательского интерфейса, список единиц текста
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91ff4257c70b34cea01a149b30dff2bf2fbe691a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104337652"
---
# <a name="ui-automation-text-units"></a><span data-ttu-id="ff91a-107">Единицы текста модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="ff91a-107">UI Automation text units</span></span>

<span data-ttu-id="ff91a-108">В этом разделе описываются единицы текста, поддерживаемые шаблоном элемента управления Microsoft UI Automation [TextRange](uiauto-implementingtextandtextrange.md) .</span><span class="sxs-lookup"><span data-stu-id="ff91a-108">This topic describes the text units supported by the Microsoft UI Automation [TextRange](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="ff91a-109">Поставщики и клиенты автоматизации пользовательского интерфейса используют текстовые единицы для указания величины перемещения или изменения размера текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="ff91a-109">UI Automation providers and clients use text units to specify the amount by which to move or change the size of a text range.</span></span>

-   [<span data-ttu-id="ff91a-110">Элементы API единиц текста</span><span class="sxs-lookup"><span data-stu-id="ff91a-110">Text Unit API Elements</span></span>](#text-unit-api-elements)
-   [<span data-ttu-id="ff91a-111">Описания единиц текста</span><span class="sxs-lookup"><span data-stu-id="ff91a-111">Text Unit Descriptions</span></span>](#text-unit-descriptions)
    -   [<span data-ttu-id="ff91a-112">Знак</span><span class="sxs-lookup"><span data-stu-id="ff91a-112">Character</span></span>](#character)
    -   [<span data-ttu-id="ff91a-113">Формат</span><span class="sxs-lookup"><span data-stu-id="ff91a-113">Format</span></span>](#format)
    -   [<span data-ttu-id="ff91a-114">Word</span><span class="sxs-lookup"><span data-stu-id="ff91a-114">Word</span></span>](#word)
    -   [<span data-ttu-id="ff91a-115">Line</span><span class="sxs-lookup"><span data-stu-id="ff91a-115">Line</span></span>](#line)
    -   [<span data-ttu-id="ff91a-116">Paragraph</span><span class="sxs-lookup"><span data-stu-id="ff91a-116">Paragraph</span></span>](#paragraph)
    -   [<span data-ttu-id="ff91a-117">Страница</span><span class="sxs-lookup"><span data-stu-id="ff91a-117">Page</span></span>](#page)
    -   [<span data-ttu-id="ff91a-118">Document</span><span class="sxs-lookup"><span data-stu-id="ff91a-118">Document</span></span>](#document)
-   [<span data-ttu-id="ff91a-119">Другие возможные диапазоны</span><span class="sxs-lookup"><span data-stu-id="ff91a-119">Other Potential Ranges</span></span>](#other-potential-ranges)
-   [<span data-ttu-id="ff91a-120">См. также</span><span class="sxs-lookup"><span data-stu-id="ff91a-120">Related topics</span></span>](#related-topics)

## <a name="text-unit-api-elements"></a><span data-ttu-id="ff91a-121">Элементы API единиц текста</span><span class="sxs-lookup"><span data-stu-id="ff91a-121">Text unit API elements</span></span>

<span data-ttu-id="ff91a-122">API автоматизации пользовательского интерфейса содержит следующие методы, для которых требуется указать единицу текста:</span><span class="sxs-lookup"><span data-stu-id="ff91a-122">The UI Automation API includes the following methods that require a text unit to be specified:</span></span>

-   [<span data-ttu-id="ff91a-123">**Итекстранжепровидер:: Move**</span><span class="sxs-lookup"><span data-stu-id="ff91a-123">**ITextRangeProvider::Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)
-   [<span data-ttu-id="ff91a-124">**Итекстранжепровидер:: Експандтоенклосингунит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-124">**ITextRangeProvider::ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit)
-   [<span data-ttu-id="ff91a-125">**Итекстранжепровидер:: Мовиндпоинтбюнит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-125">**ITextRangeProvider::MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)
-   [<span data-ttu-id="ff91a-126">**Иуиаутоматионтекстранже:: Move**</span><span class="sxs-lookup"><span data-stu-id="ff91a-126">**IUIAutomationTextRange::Move**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move)
-   [<span data-ttu-id="ff91a-127">**Иуиаутоматионтекстранже:: Експандтоенклосингунит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-127">**IUIAutomationTextRange::ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit)
-   [<span data-ttu-id="ff91a-128">**Иуиаутоматионтекстранже:: Мовиндпоинтбюнит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-128">**IUIAutomationTextRange::MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit)

<span data-ttu-id="ff91a-129">Перечисление [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) определяет единицы текста, поддерживаемые диапазонами текста модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="ff91a-129">The [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) enumeration defines the text units that are supported by UI Automation text ranges.</span></span> <span data-ttu-id="ff91a-130">Чтобы указать единицу текста, член перечисления [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) указывается в вызове метода [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) или [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) .</span><span class="sxs-lookup"><span data-stu-id="ff91a-130">To specify the text unit, a member of the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) enumeration is specified in a call to an [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) or [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) method.</span></span> <span data-ttu-id="ff91a-131">Ниже приведены текстовые единицы измерения от наименьшего до большего.</span><span class="sxs-lookup"><span data-stu-id="ff91a-131">The text units, from smallest to largest, are as follows:</span></span>

-   [<span data-ttu-id="ff91a-132">**Текстунит \_ символ**</span><span class="sxs-lookup"><span data-stu-id="ff91a-132">**TextUnit\_Character**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="ff91a-133">**\_Формат текстунит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-133">**TextUnit\_Format**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="ff91a-134">**Текстунит \_ слово**</span><span class="sxs-lookup"><span data-stu-id="ff91a-134">**TextUnit\_Word**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="ff91a-135">**Текстунит \_ строка**</span><span class="sxs-lookup"><span data-stu-id="ff91a-135">**TextUnit\_Line**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="ff91a-136">**Текстунит \_ абзац**</span><span class="sxs-lookup"><span data-stu-id="ff91a-136">**TextUnit\_Paragraph**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="ff91a-137">**\_Страница текстунит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-137">**TextUnit\_Page**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="ff91a-138">**\_Документ текстунит**</span><span class="sxs-lookup"><span data-stu-id="ff91a-138">**TextUnit\_Document**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)

<span data-ttu-id="ff91a-139">Если конкретный текстовый элемент управления не поддерживает указанную единицу текста, поставщик должен ответить, подставив следующую единицу измерения большего размера, которая поддерживается элементом управления.</span><span class="sxs-lookup"><span data-stu-id="ff91a-139">If a particular text-based control does not support the specified text unit, the provider should respond by substituting the next larger text unit that is supported by the control.</span></span> <span data-ttu-id="ff91a-140">Например, если [**текстунит \_ абзац**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) указан, но не поддерживается, метод может заменить [**Текстунит \_ страницу**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) или [**\_ документ текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit).</span><span class="sxs-lookup"><span data-stu-id="ff91a-140">For example, if [**TextUnit\_Paragraph**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is specified but not supported, the method can substitute [**TextUnit\_Page**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) or [**TextUnit\_Document**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit).</span></span>

<span data-ttu-id="ff91a-141">Лингвистические характеристики исходного текста могут усложнить поставщика определить границы текста на основе указанной единицы текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-141">The linguistic characteristics of the source text can make it difficult for a provider to determine text boundaries based on the specified text unit.</span></span> <span data-ttu-id="ff91a-142">Для получения справки по определению границ текста поставщик может использовать функции API Uniscribe, такие как [**скриптбреак**](/windows/desktop/api/usp10/nf-usp10-scriptbreak).</span><span class="sxs-lookup"><span data-stu-id="ff91a-142">For help in determining text boundaries, a provider can use Uniscribe API functions such as [**ScriptBreak**](/windows/desktop/api/usp10/nf-usp10-scriptbreak).</span></span> <span data-ttu-id="ff91a-143">Дополнительные сведения см. в разделе о [Uniscribe](/windows/desktop/Intl/uniscribe) на веб-сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="ff91a-143">For more information, see [Uniscribe](/windows/desktop/Intl/uniscribe) on the MSDN website.</span></span>

## <a name="endpoint-inclusivity"></a><span data-ttu-id="ff91a-144">Инклусивити конечной точки</span><span class="sxs-lookup"><span data-stu-id="ff91a-144">Endpoint inclusivity</span></span>

<span data-ttu-id="ff91a-145">Конечная точка текстового блока может служить как [начальной](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) конечной точкой, так и [конечной](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) конечной точкой для смежных диапазонов текста того же типа.</span><span class="sxs-lookup"><span data-stu-id="ff91a-145">A text unit endpoint can serve as both a [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint and an [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint for adjacent text ranges of the same type.</span></span> <span data-ttu-id="ff91a-146">Если конец одной единицы текста также является началом другой единицы текста, диапазон, содержащий [конечную](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) точку, не использует атрибуты или объекты соседнего диапазона, содержащего [начальную](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) конечную точку.</span><span class="sxs-lookup"><span data-stu-id="ff91a-146">If the end of one text unit is also the start of another text unit, the range containing the [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint does not share any attributes or objects of the adjacent range containing the [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint.</span></span>

<span data-ttu-id="ff91a-147">Например, текстовый поток "Hello **World**" содержит две единицы слова с различными атрибутами насыщенности шрифта (обычный и полужирный).</span><span class="sxs-lookup"><span data-stu-id="ff91a-147">For example, a text stream, "Hello **world**", contains two word units with different font weight attributes (normal and bold).</span></span> <span data-ttu-id="ff91a-148">В этом случае [Конечная](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) точка слова «Привет» и [Начальная](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) конечная точка слова «**World**» одинаковы, что приводит к следующему результату:</span><span class="sxs-lookup"><span data-stu-id="ff91a-148">In this case, the [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit "Hello" and the [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit "**world**" are the same, which results in the following:</span></span>

- <span data-ttu-id="ff91a-149">Диапазон "Hello" не использует атрибут полужирного начертания слова "World" и не возвращает значения атрибута mixed для текстового атрибута "насыщенность шрифта".</span><span class="sxs-lookup"><span data-stu-id="ff91a-149">The range of "Hello" does not share the bold attribute of the word unit "world" and does not return the mixed attribute value for the font weight text attribute.</span></span>
- <span data-ttu-id="ff91a-150">Диапазон «**World**» имеет один и тот же вес шрифта (полужирный) и не использует насыщенность шрифта предшествующей единицы слова «Hello».</span><span class="sxs-lookup"><span data-stu-id="ff91a-150">The range of "**world**" has a single font weight (bold), and does not share the font weight of the preceding word unit “Hello”.</span></span>

<span data-ttu-id="ff91a-151">Вот еще один пример, когда текстовый поток содержит две единицы слов, одна из которых является ссылкой: `[Foo]() Bar` .</span><span class="sxs-lookup"><span data-stu-id="ff91a-151">Here's another example where a text stream contains two word units, one of which is a link: `[Foo]() Bar`.</span></span> <span data-ttu-id="ff91a-152">В этом случае [Конечная](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) точка в слове `[Foo]()` и [Начальная](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) конечная точка слова «Bar» одинаковы, что приводит к следующему результату:</span><span class="sxs-lookup"><span data-stu-id="ff91a-152">In this case, the [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit `[Foo]()` and the [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit "Bar" are the same, which results in the following:</span></span>

- <span data-ttu-id="ff91a-153">Ссылка относится к текстовому диапазону, содержащему "foo".</span><span class="sxs-lookup"><span data-stu-id="ff91a-153">The link belongs to the text range containing "Foo".</span></span>
- <span data-ttu-id="ff91a-154">Ссылка является дочерней по отношению к текстовому диапазону "foo" и заключена в [итекстпровидер](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider).</span><span class="sxs-lookup"><span data-stu-id="ff91a-154">The link is a child of the text range "Foo", and is enclosed by the [ITextProvider](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider).</span></span>
- <span data-ttu-id="ff91a-155">Текстовый диапазон не имеет дочерних элементов и заключен в [итекстпровидер](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider).</span><span class="sxs-lookup"><span data-stu-id="ff91a-155">The text range "Bar" has no children and and is enclosed by the [ITextProvider](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider).</span></span>

<span data-ttu-id="ff91a-156">**Дополнительные примечания:**</span><span class="sxs-lookup"><span data-stu-id="ff91a-156">**Additional notes:**</span></span>

> <span data-ttu-id="ff91a-157">Вырожденный (пустой) диапазон на границе единицы текста с текстовым диапазоном того же типа предполагает свойства непосредственно примыкающей единицы текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-157">A degenerate (empty) range at a text unit boundary with a text range of the same type assumes properties of the immediately adjacent text unit.</span></span>
>
> <span data-ttu-id="ff91a-158">Вызов [иуиаутоматионтекстранже:: експандтоенклосингунит](/windows/desktop/api/uiautomationclient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit
) для вырожденного диапазона на границе единицы текста с текстовым диапазоном того же типа разворачивает вырожденный диапазон до следующей единицы текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-158">Calling [IUIAutomationTextRange::ExpandToEnclosingUnit](/windows/desktop/api/uiautomationclient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit
) on a degenerate range at a text unit boundary with a text range of the same type, expands the degenerate range to the following text unit.</span></span>

## <a name="text-unit-descriptions"></a><span data-ttu-id="ff91a-159">Описания единиц текста</span><span class="sxs-lookup"><span data-stu-id="ff91a-159">Text Unit Descriptions</span></span>

<span data-ttu-id="ff91a-160">В этом разделе описываются все текстовые единицы, поддерживаемые автоматизацией пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="ff91a-160">This section describes each of the text units supported by UI Automation.</span></span>

### <a name="character"></a><span data-ttu-id="ff91a-161">Знак</span><span class="sxs-lookup"><span data-stu-id="ff91a-161">Character</span></span>

<span data-ttu-id="ff91a-162">[**Текстунит \_ Символ**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) — это лингвистическая единица текста, представляющая один символ.</span><span class="sxs-lookup"><span data-stu-id="ff91a-162">[**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a linguistic unit of text that represents a single character.</span></span> <span data-ttu-id="ff91a-163">Лингвистическое определение символа зависит от языка.</span><span class="sxs-lookup"><span data-stu-id="ff91a-163">The linguistic definition of a character varies by language.</span></span> <span data-ttu-id="ff91a-164">Для английского языка (США) символ обычно размещается с помощью пробела или другого символа, например знака пунктуации, числа или буквы.</span><span class="sxs-lookup"><span data-stu-id="ff91a-164">For US English, a character is typically bordered by a space or another character, such as a punctuation mark, a number, or a letter.</span></span>

<span data-ttu-id="ff91a-165">Управляющие символы, такие как возврат каретки и знак Юникода слева направо (LTM), не должны рассматриваться как символы, но могут включаться в текстовый диапазон, нормализованный на основе единицы символьного текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-165">Control characters such as carriage returns and the Unicode left-to-right mark (LTM) should not be considered as characters, but may be included in a text range that is normalized based on the character text unit.</span></span>

<span data-ttu-id="ff91a-166">Знаки пунктуации и символы разрыва слов, такие как пробелы, следует рассматривать как символы.</span><span class="sxs-lookup"><span data-stu-id="ff91a-166">Punctuation marks and word break characters such as spaces should be considered as characters.</span></span>

### <a name="format"></a><span data-ttu-id="ff91a-167">Формат</span><span class="sxs-lookup"><span data-stu-id="ff91a-167">Format</span></span>

<span data-ttu-id="ff91a-168">[**Текстунит \_ Формат**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) используется для размещения границы текстового диапазона на основе атрибутов форматирования текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-168">[**TextUnit\_Format**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is used to position the boundary of a text range based on the formatting attributes of the text.</span></span> <span data-ttu-id="ff91a-169">Например, если текстовый диапазон в данный момент располагается на одном символе слова, то при указании **\_ формата текстунит** в вызове [**иуиаутоматионтекстранже:: експандтоенклосингунит**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) расширяется текстовый диапазон, чтобы он включал весь текст с одинаковыми атрибутами, равными одному символу.</span><span class="sxs-lookup"><span data-stu-id="ff91a-169">For example, if a text range is currently positioned on a single character of a word, specifying **TextUnit\_Format** in a call to [**IUIAutomationTextRange::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) expands the text range to include all text that shares all the same attributes as the single character.</span></span> <span data-ttu-id="ff91a-170">Результирующий диапазон текста может содержать или не включать слово целиком.</span><span class="sxs-lookup"><span data-stu-id="ff91a-170">The resulting text range might or might not include the entire word.</span></span> <span data-ttu-id="ff91a-171">Кроме того, использование единицы форматирования текста не расширяет диапазон текста по границе внедренного объекта, такого как изображение или гиперссылка.</span><span class="sxs-lookup"><span data-stu-id="ff91a-171">Also, using the format text unit will not expand a text range across the boundary of an embedded object such as an image or hyperlink.</span></span>

<span data-ttu-id="ff91a-172">В отличие от других единиц текста, в том числе тех единиц текста, которые меньше, чем сами по себе, [**\_ Формат текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) может быть меньше или больше, чем другие единицы.</span><span class="sxs-lookup"><span data-stu-id="ff91a-172">Unlike the other text units, which include the text units that are smaller than themselves, [**TextUnit\_Format**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) can be smaller or larger than the other units.</span></span> <span data-ttu-id="ff91a-173">Например, если весь документ использует одни и те же атрибуты текста и не содержит внедренные объекты, расширение текстового диапазона по **\_ формату текстунит** создаст новый диапазон, охватывающий весь документ, а при расширении текстового диапазона на [**текстунит \_ Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) создаст меньший диапазон.</span><span class="sxs-lookup"><span data-stu-id="ff91a-173">For example, if an entire document shares the same text attributes and contains no embedded objects, expanding a text range by **TextUnit\_Format** would create a new range that encompasses the entire document, while expanding the text range by [**TextUnit\_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) would create a smaller range.</span></span>

### <a name="word"></a><span data-ttu-id="ff91a-174">Word</span><span class="sxs-lookup"><span data-stu-id="ff91a-174">Word</span></span>

<span data-ttu-id="ff91a-175">[**Текстунит \_ Слово**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) — это лингвистическая единица текста, представляющая одно целое слово.</span><span class="sxs-lookup"><span data-stu-id="ff91a-175">[**TextUnit\_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a linguistic unit of text that represents a single, whole word.</span></span> <span data-ttu-id="ff91a-176">Лингвистическое определение слова зависит от языка.</span><span class="sxs-lookup"><span data-stu-id="ff91a-176">The linguistic definition of a word varies by language.</span></span> <span data-ttu-id="ff91a-177">Для английского языка (США) слова обычно разделяются пробелами или знаками препинания.</span><span class="sxs-lookup"><span data-stu-id="ff91a-177">For US English, words are typically bordered by spaces or punctuation characters.</span></span>

<span data-ttu-id="ff91a-178">Если для установки границы текстового диапазона используется [**текстунит \_ слово**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , результирующий диапазон текста должен содержать символы разрыва слов, которые находятся в конце слова, но перед началом следующего слова.</span><span class="sxs-lookup"><span data-stu-id="ff91a-178">When [**TextUnit\_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is used to set the boundary of a text range, the resulting text range should include any word break characters that are present at the end of the word, but before the start of the next word.</span></span>

### <a name="line"></a><span data-ttu-id="ff91a-179">Линия</span><span class="sxs-lookup"><span data-stu-id="ff91a-179">Line</span></span>

<span data-ttu-id="ff91a-180">[**Текстунит \_ Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) — это единица текста, представляющая одну строку текста, представленную в окне просмотра элемента управления.</span><span class="sxs-lookup"><span data-stu-id="ff91a-180">[**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a unit of text that represents a single line of text as presented in the viewport of the control.</span></span> <span data-ttu-id="ff91a-181">При использовании **\_ линии текстунит** для установки границы текстового диапазона поставщик должен задать границу сразу после точки, где управляющий символ разрывает линию, или когда окно просмотра элемента управления заключает текст в новую строку.</span><span class="sxs-lookup"><span data-stu-id="ff91a-181">When using **TextUnit\_Line** to set the boundary of a text range, a provider should set the boundary immediately after the point where a control character breaks the line, or where the viewport of the control wraps the text to a new line.</span></span> <span data-ttu-id="ff91a-182">Граница должна быть установлена, где начинается новая строка.</span><span class="sxs-lookup"><span data-stu-id="ff91a-182">The boundary should be set where a new line starts.</span></span>

### <a name="paragraph"></a><span data-ttu-id="ff91a-183">Paragraph</span><span class="sxs-lookup"><span data-stu-id="ff91a-183">Paragraph</span></span>

<span data-ttu-id="ff91a-184">[**Текстунит \_ Абзац**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) — это лингвистическая единица текста, представляющая полный абзац.</span><span class="sxs-lookup"><span data-stu-id="ff91a-184">[**TextUnit\_Paragraph**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a linguistic unit of text that represents a complete paragraph.</span></span> <span data-ttu-id="ff91a-185">Абзац должен начинаться непосредственно перед первым символом абзаца и обычно заканчиваться сразу после последнего символа.</span><span class="sxs-lookup"><span data-stu-id="ff91a-185">A paragraph should begin just before the first character of a paragraph and should typically end just after the last character.</span></span> <span data-ttu-id="ff91a-186">Все пустые строки, следующие за абзацем, должны быть объединены в абзац, если в источнике текста не указано иное.</span><span class="sxs-lookup"><span data-stu-id="ff91a-186">Any empty lines following a paragraph should be merged into the paragraph, unless something in the text source indicates otherwise.</span></span> <span data-ttu-id="ff91a-187">Как правило, конечная граница абзаца также отмечает конечную границу единицы текста [**текстунит \_ строки**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) .</span><span class="sxs-lookup"><span data-stu-id="ff91a-187">Typically, the end boundary of a paragraph also marks the end boundary of a [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) text unit.</span></span>

### <a name="page"></a><span data-ttu-id="ff91a-188">Страница</span><span class="sxs-lookup"><span data-stu-id="ff91a-188">Page</span></span>

<span data-ttu-id="ff91a-189">[**Текстунит \_ Страница**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) представляет полную текстовую страницу документа.</span><span class="sxs-lookup"><span data-stu-id="ff91a-189">[**TextUnit\_Page**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) represents a complete text page of a document.</span></span> <span data-ttu-id="ff91a-190">Границы страницы должны быть установлены в тех местах, где начинается и заканчивается страница.</span><span class="sxs-lookup"><span data-stu-id="ff91a-190">The boundaries of a page should be set at the immediate points where a page starts and ends.</span></span>

### <a name="document"></a><span data-ttu-id="ff91a-191">Документ</span><span class="sxs-lookup"><span data-stu-id="ff91a-191">Document</span></span>

<span data-ttu-id="ff91a-192">[**Текстунит \_ Документ**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) представляет все содержимое документа, поддерживаемое шаблоном элемента управления [Text](uiauto-implementingtextandtextrange.md) .</span><span class="sxs-lookup"><span data-stu-id="ff91a-192">[**TextUnit\_Document**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) represents the entire contents of a document as supported by the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="ff91a-193">Текст не должен существовать за пределами текстового диапазона, содержащего документ.</span><span class="sxs-lookup"><span data-stu-id="ff91a-193">No text should exist outside of a text range that contains a document.</span></span> <span data-ttu-id="ff91a-194">Любые объекты, которые вставляются в документ, например заметки заметки, пересекающие границу страницы, должны рассматриваться как внедренные объекты документа, а не как часть текстового содержимого документа.</span><span class="sxs-lookup"><span data-stu-id="ff91a-194">Any objects that are inserted into a document, such as annotation notes that cross a page boundary, should be treated as embedded objects of the document and not part of the document's text content.</span></span>

## <a name="other-potential-ranges"></a><span data-ttu-id="ff91a-195">Другие возможные диапазоны</span><span class="sxs-lookup"><span data-stu-id="ff91a-195">Other Potential Ranges</span></span>

<span data-ttu-id="ff91a-196">Текущая спецификация шаблона элемента управления [TextRange](uiauto-implementingtextandtextrange.md) не допускает добавление новых значений текстовых единиц в перечисление [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) и не позволяет переопределять существующие значения единиц текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-196">The current [TextRange](uiauto-implementingtextandtextrange.md) control pattern specification does not allow new text unit values to be added to the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) enumeration, nor does it allow the existing text unit values to be redefined.</span></span> <span data-ttu-id="ff91a-197">Чтобы предоставить доступ к другим потенциальным диапазонам, таким как заголовки и заметки, поставщик должен предоставить эти диапазоны как внедренные объекты с соответствующим текстовым диапазоном.</span><span class="sxs-lookup"><span data-stu-id="ff91a-197">To expose other potential ranges, such as headers and annotations, a provider should expose these ranges as embedded objects with an associated text range.</span></span> <span data-ttu-id="ff91a-198">Таким образом, можно также добавить поддержку соответствующих шаблонов элементов управления.</span><span class="sxs-lookup"><span data-stu-id="ff91a-198">That way, you can also add support for the appropriate control patterns.</span></span> <span data-ttu-id="ff91a-199">Это решение является более гибким и расширяемым, чем определение новых единиц текста.</span><span class="sxs-lookup"><span data-stu-id="ff91a-199">This solution is more flexible and extensible than defining new text units.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ff91a-200">См. также</span><span class="sxs-lookup"><span data-stu-id="ff91a-200">Related topics</span></span>

### <a name="reference"></a><span data-ttu-id="ff91a-201">Справочник</span><span class="sxs-lookup"><span data-stu-id="ff91a-201">Reference</span></span>

[<span data-ttu-id="ff91a-202">текстпаттернранжеендпоинт</span><span class="sxs-lookup"><span data-stu-id="ff91a-202">TextPatternRangeEndpoint</span></span>](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint)

[<span data-ttu-id="ff91a-203">Итекстранжепровидер:: дочерние элементы</span><span class="sxs-lookup"><span data-stu-id="ff91a-203">ITextRangeProvider::GetChildren</span></span>](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-getchildren)





### <a name="conceptual"></a><span data-ttu-id="ff91a-204">Основные понятия</span><span class="sxs-lookup"><span data-stu-id="ff91a-204">Conceptual</span></span>

[<span data-ttu-id="ff91a-205">Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого</span><span class="sxs-lookup"><span data-stu-id="ff91a-205">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)

[<span data-ttu-id="ff91a-206">Работа с элементами управления на основе текста</span><span class="sxs-lookup"><span data-stu-id="ff91a-206">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)