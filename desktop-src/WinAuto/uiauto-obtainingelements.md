---
title: Получение элементов автоматизации пользовательского интерфейса
description: В этом разделе описаны различные способы получения интерфейсов Иуиаутоматионелемент для элементов пользовательского интерфейса.
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- Клиенты, получение элементов модели автоматизации пользовательского интерфейса
- Клиенты, элементы модели автоматизации пользовательского интерфейса
- Клиенты, корневые элементы
- Клиенты, область поиска
- Модель автоматизации пользовательского интерфейса, получение элементов
- Модель автоматизации пользовательского интерфейса, элементы
- Модель автоматизации пользовательского интерфейса, корневые элементы
- Модель автоматизации пользовательского интерфейса, условия
- Модель автоматизации пользовательского интерфейса, область поиска
- получение элементов модели автоматизации пользовательского интерфейса
- корневые элементы
- область поиска
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "105694372"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="c9ebf-115">Получение элементов автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="c9ebf-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="c9ebf-116">В этом разделе описаны различные способы получения интерфейсов [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для элементов пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="c9ebf-117">**Иуиаутоматионелемент** используется в [примере приложения клиента содержимого документов модели автоматизации пользовательского интерфейса](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="c9ebf-118">Корневой элемент</span><span class="sxs-lookup"><span data-stu-id="c9ebf-118">Root Element</span></span>

<span data-ttu-id="c9ebf-119">Хотя элементы могут быть получены непосредственно с помощью методов, таких как [**иуиаутоматион:: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), некоторым клиентским приложениям требуется представление иерархической структуры элементов, известной как дерево автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="c9ebf-120">Корневым элементом этой иерархии является Рабочий стол.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="c9ebf-121">Этот элемент можно получить с помощью метода [**иуиаутоматион:: жетрутелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) или метода [**Иуиаутоматион:: жетрутелементбуилдкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="c9ebf-122">Оба эти метода извлекают указатель интерфейса [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="c9ebf-123">Можно выполнять поиск элементов-потомков с помощью методов, таких как [**иуиаутоматионелемент:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) и [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="c9ebf-124">В общем случае следует попытаться получить только прямые дочерние элементы корневого элемента.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="c9ebf-125">Поиск потомков может выполнять итерацию сотен или тысяч элементов.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="c9ebf-126">Если вы пытаетесь получить определенный элемент на более низком уровне, необходимо запустить поиск из окна приложения или из контейнера на более низком уровне.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="c9ebf-127">Условия</span><span class="sxs-lookup"><span data-stu-id="c9ebf-127">Conditions</span></span>

<span data-ttu-id="c9ebf-128">Для большинства методов, используемых для получения элементов автоматизации пользовательского интерфейса, необходимо указать условие.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="c9ebf-129">Условие — это набор критериев, определяющих элементы, которые требуется получить.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="c9ebf-130">Условие представлено интерфейсом [**иуиаутоматионкондитион**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="c9ebf-131">Простейшим условием является истинное условие, представляющее собой предопределенный объект, указывающий, что должны возвращаться все элементы в области поиска.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="c9ebf-132">Условие false является обратным условием для истинного условия и менее полезно, так как оно предотвратит возможность обнаружения каких-либо элементов.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="c9ebf-133">Получить интерфейс к истинному условию можно с помощью [**иуиаутоматион:: креатетруекондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="c9ebf-134">Три других предопределенных условия, доступные в качестве свойств объекта [**иуиаутоматион**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) , можно использовать отдельно или в сочетании с другими условиями: [**Иуиаутоматион:: контентвиевкондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**контролвиевкондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)и [**раввиевкондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="c9ebf-135">**Раввиевкондитион**, используемый сама по себе, эквивалентен истинному условию, так как не фильтрует элементы по свойствам [**Иуиаутоматионелемент:: куррентисконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) или [**куррентисконтентелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="c9ebf-136">Другие условия строятся на основе объектов условий, каждый из которых задает значение свойства.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="c9ebf-137">Например, условие свойства может указывать, что элемент включен или поддерживает определенный шаблон элемента управления.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="c9ebf-138">Условия, использующие логическую логику, можно комбинировать путем вызова [**иуиаутоматион:: креатеандкондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**креатеоркондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**креатеноткондитион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)и связанных методов.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="c9ebf-139">Область поиска</span><span class="sxs-lookup"><span data-stu-id="c9ebf-139">Search Scope</span></span>

<span data-ttu-id="c9ebf-140">Поиск, выполняемый с помощью [**иуиаутоматионелемент:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) или [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) , должен иметь область и начальную позицию.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="c9ebf-141">Любые комментарии об этих двух методах также применяются к [**иуиаутоматионелемент:: финдфирстбуилдкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) и [**финдаллбуилдкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="c9ebf-142">Область определяет пространство вокруг начальной позиции, в которой выполняется поиск.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="c9ebf-143">Это может быть сам элемент, его элементы того же уровня, его родитель, непосредственные дочерние элементы и его потомки.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="c9ebf-144">Имейте в виду, что методы **Find** не поддерживают поиск по дереву Microsoft UI Automation; Это значит, что поиск элементов-предков не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="c9ebf-145">Область поиска определяется побитовым сочетанием значений из перечисляемого типа [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="c9ebf-146">Поиск известного элемента</span><span class="sxs-lookup"><span data-stu-id="c9ebf-146">Finding a Known Element</span></span>

<span data-ttu-id="c9ebf-147">Чтобы найти известный элемент, идентифицируемый по имени, ИДЕНТИФИКАТОРу автоматизации или другому свойству или сочетанию свойств, проще всего использовать метод [**иуиаутоматионелемент:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="c9ebf-148">Если искомый элемент является окном приложения, то начальной точкой поиска может быть корневой элемент.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="c9ebf-149">Такой способ поиска элементов автоматизации пользовательского интерфейса наиболее удобен в сценариях автоматического тестирования.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="c9ebf-150">Пример кода, в котором показано, как найти известный элемент, см. в разделе [Поиск элемента по имени](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="c9ebf-151">Поиск элементов в поддереве</span><span class="sxs-lookup"><span data-stu-id="c9ebf-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="c9ebf-152">Чтобы найти все элементы, соответствующие определенным условиям и связанные с известным элементом, можно вызвать [**иуиаутоматионелемент:: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) для известного элемента.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="c9ebf-153">Например, этот метод используется для получения элементов списка или пунктов меню из списка или меню или для определения всех элементов управления в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="c9ebf-154">Пример кода, в котором показано, как найти элементы в поддереве, см. в разделе [Поиск связанных элементов](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="c9ebf-155">Обход поддерева</span><span class="sxs-lookup"><span data-stu-id="c9ebf-155">Walking a Subtree</span></span>

<span data-ttu-id="c9ebf-156">Если у вас нет сведений о приложениях, которые может использовать клиент, можно создать поддерево всех интересующих элементов с помощью [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="c9ebf-157">Клиент может сделать это, например, в ответ на событие изменения фокуса; то есть, когда приложение или элемент управления получает фокус ввода, клиент автоматизации пользовательского интерфейса проверяет дочерние элементы и, возможно, все потомки элемента с фокусом.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="c9ebf-158">Имейте в виду, что прохождение дерева модели автоматизации пользовательского интерфейса занимает много ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="c9ebf-159">Пройдите по дереву только в том случае, когда невозможно использовать методы [**иуиаутоматионелемент:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)или [**буилдупдатедкаче**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="c9ebf-160">Вы можете определить собственный обход дерева, передав пользовательское условие в [**иуиаутоматион:: креатетривалкер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), или можно использовать один из следующих предопределенных объектов, определенных как свойства базового [**иуиаутоматион**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="c9ebf-161">Объект</span><span class="sxs-lookup"><span data-stu-id="c9ebf-161">Object</span></span>                                                              | <span data-ttu-id="c9ebf-162">Назначение</span><span class="sxs-lookup"><span data-stu-id="c9ebf-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c9ebf-163">**контентвиеввалкер**</span><span class="sxs-lookup"><span data-stu-id="c9ebf-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="c9ebf-164">Находит только те элементы, свойство [**иуиаутоматионелемент:: куррентисконтентелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) которых имеет **значение true**.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="c9ebf-165">**контролвиеввалкер**</span><span class="sxs-lookup"><span data-stu-id="c9ebf-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="c9ebf-166">Находит только те элементы, свойство [**иуиаутоматионелемент:: куррентисконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) которых имеет **значение true**.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="c9ebf-167">**раввиеввалкер**</span><span class="sxs-lookup"><span data-stu-id="c9ebf-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="c9ebf-168">Поиск всех элементов.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="c9ebf-169">После получения [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker)вызовите методы **Иуиаутоматионтривалкер:: жеткскскс** для навигации по элементам поддерева, передав элемент, с которого начинается проход.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="c9ebf-170">Метод [**иуиаутоматионтривалкер:: нормализация**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) можно использовать для перехода к элементу в поддереве из другого элемента, который не является частью представления.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="c9ebf-171">Например, предположим, что вы создаете представление поддерева с помощью [**иуиаутоматион:: контентвиеввалкер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="c9ebf-172">Приложение получает уведомление о том, что полоса прокрутки получила фокус ввода.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="c9ebf-173">Поскольку полоса прокрутки не является элементом содержимого, она отсутствует в представлении поддерева.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="c9ebf-174">Однако можно передать [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) , представляющий полосу прокрутки, в **Иуиаутоматионтривалкер:: нормализацию** и получить ближайший предк, который находится в представлении содержимого.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="c9ebf-175">Примеры кода, демонстрирующие использование интерфейса [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) , см. в разделе [Пошаговое руководство по дереву модели автоматизации пользовательского интерфейса](uiauto-howto-walk-uiautomation-tree.md).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="c9ebf-176">Другие способы получения элемента</span><span class="sxs-lookup"><span data-stu-id="c9ebf-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="c9ebf-177">Помимо поиска и навигации можно получить [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) следующими способами.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="c9ebf-178">Из события</span><span class="sxs-lookup"><span data-stu-id="c9ebf-178">From an Event</span></span>

<span data-ttu-id="c9ebf-179">Когда приложение получает событие автоматизации пользовательского интерфейса, исходный объект, переданный обработчику событий, представлен [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="c9ebf-180">Например, если вы подписались на события изменения фокуса, источником, передаваемым в [**иуиаутоматионфокусчанжедевенсандлер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) , будет элемент, получивший фокус.</span><span class="sxs-lookup"><span data-stu-id="c9ebf-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="c9ebf-181">Дополнительные сведения см. [в разделе Подписка на события модели автоматизации пользовательского интерфейса](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="c9ebf-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="c9ebf-182">Из точки</span><span class="sxs-lookup"><span data-stu-id="c9ebf-182">From a Point</span></span>

<span data-ttu-id="c9ebf-183">Чтобы получить [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) из экранных координат, например позиции курсора, используйте метод [**Иуиаутоматион:: елементфромпоинт**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="c9ebf-184">Из дескриптора окна</span><span class="sxs-lookup"><span data-stu-id="c9ebf-184">From a Window Handle</span></span>

<span data-ttu-id="c9ebf-185">Чтобы получить [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) из **HWND**, используйте метод [**иуиаутоматион:: елементфромхандле**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="c9ebf-186">Из элемента управления с фокусом</span><span class="sxs-lookup"><span data-stu-id="c9ebf-186">From the Focused Control</span></span>

<span data-ttu-id="c9ebf-187">Чтобы получить объект [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) , представляющий элемент управления с сортировкой, используйте метод [**Иуиаутоматион:: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) .</span><span class="sxs-lookup"><span data-stu-id="c9ebf-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c9ebf-188">См. также</span><span class="sxs-lookup"><span data-stu-id="c9ebf-188">Related topics</span></span>

[<span data-ttu-id="c9ebf-189">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="c9ebf-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="c9ebf-190">Пример приложения клиента содержимого документов модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="c9ebf-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
