---
title: Вызвать шаблон элемента управления
description: Описывает правила и соглашения для реализации IInvokeProvider, включая сведения о методах.
ms.assetid: 6557a03c-fd1f-4e44-8393-fe367d7a17af
keywords:
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления Invoke
- Модель автоматизации пользовательского интерфейса, вызов шаблона элемента управления
- Модель автоматизации пользовательского интерфейса, IInvokeProvider
- IInvokeProvider
- реализация шаблонов элементов управления, вызывающих автоматизацию пользовательского интерфейса
- Вызов шаблонов элементов управления
- шаблоны элементов управления, IInvokeProvider
- шаблоны элементов управления, реализация вызова модели автоматизации пользовательского интерфейса
- шаблоны элементов управления, Invoke
- интерфейсы, IInvokeProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 963f8d9ccd6ea2a50557ec26a655d5c7f43c6123
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888159"
---
# <a name="invoke-control-pattern"></a>Вызвать шаблон элемента управления

Описывает правила и соглашения для реализации [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider), включая сведения о методах. Шаблон элемента управления **Invoke** используется для поддержки элементов управления, которые не сохраняют состояние при активации, а инициируют или выполняют одно однозначное действие.

Элементы управления, которые сохраняют состояние, такие как флажки и переключатели, должны вместо этого реализовывать [**IToggleProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itoggleprovider) и [**иселектионпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionprovider) соответственно. Примеры элементов управления, реализующих этот шаблон элемента управления, см. в разделе [типы элементов управления и поддерживаемые шаблоны элементов управления](uiauto-controlpatternmapping.md).

В этом разделе содержатся следующие подразделы.

-   [Правила и соглашения реализации](#implementation-guidelines-and-conventions)
-   [Обязательные члены для **IInvokeProvider**](#required-members-for-iinvokeprovider)
-   [См. также](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a>Правила и соглашения реализации

При реализации шаблона элемента управления **Invoke** Обратите внимание на следующие правила и соглашения.

-   Элементы управления реализуют [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider) , если такое же поведение не предоставляется через другой поставщик шаблона элемента управления. Например, если метод [**иуиаутоматионинвокепаттерн:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke) в элементе управления выполняет то же действие, что и метод [**Иуиаутоматионекспандколлапсепаттерн:: Expand**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationexpandcollapsepattern-expand) или [**сворачивания**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationexpandcollapsepattern-collapse) , элемент управления не должен реализовывать **IInvokeProvider**.
-   Обычно для вызова элемента управления нужно щелкнуть, дважды щелкнуть, нажать клавишу ВВОД, нажать стандартное сочетание клавиш или нажать некоторое другую другое сочетание клавиш.
-   Событие **вызванного** события ([**UIA \_ Invoke \_ инвокедевентид**](uiauto-event-ids.md)) вызывается для элемента управления, который был активирован (как ответ на элемент управления, выполняющий связанное действие). Если это возможно, событие должно вызываться после завершения действия элементом управления и его возврата без блокировки. **Вызываемое** событие (**UIA \_ Invoke \_ инвокедевентид**) должно быть создано перед обслуживанием запроса **Invoke** в следующих сценариях:
    -   невозможно или нецелесообразно ожидать завершения действия;
    -   действие требует взаимодействия с пользователем;
    -   действие занимает много времени и приведет к блокировке вызывающего клиента на значительное время.
-   Если вызов элемента управления имеет существенные побочные эффекты, эти побочные эффекты должны предоставляться через свойство **HELPTEXT** . Например, несмотря на то, что [**иуиаутоматионинвокепаттерн:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke) не связан с выделением, **Invoke** может привести к тому, что другой элемент управления станет выбранным.
-   Эффекты наведения указателя (или мыши) обычно не составляют **вызванного** события. Однако элементы управления, выполняющие действие (а не вызывающие визуальные эффекты) на основе состояния наведения, должны поддерживать шаблон элемента управления **Invoke** .
    > [!Note]  
    > Эта реализация считается проблемой специальных возможностей, если элемент управления может быть вызван только в результате побочного эффекта, связанного с мышью.

     

-   Вызов элемента управления отличается от выбора элемента. Тем не менее в зависимости от элемента управления его вызов может привести к выбору элемента в качестве побочного эффекта. Например, при вызове элемента списка документов Microsoft Word в папке «Мои документы» выбирается элемент и открывается документ.
-   Элемент может исчезнуть из дерева Microsoft UI Automation сразу после вызова. В результате запрос информации из элемента, предоставленного обратным вызовом события, может завершиться неудачно. В качестве обходного решения рекомендуется выполнять предварительное кэширование информации.
-   Элементы управления могут реализовывать множество шаблонов элементов управления. Например, элемент управления **Цвет заливки** на панели инструментов Microsoft Excel реализует шаблоны элементов управления Invoke и [ExpandCollapse](uiauto-implementingexpandcollapse.md) . Шаблон элемента управления ExpandCollapse предоставляет меню, а шаблон элемента управления **вызывает** заливку активного выделения выбранным цветом.

## <a name="required-members-for-iinvokeprovider"></a>Обязательные члены для **IInvokeProvider**

Для реализации интерфейса [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider) требуется следующий метод.



| Обязательные члены                                | Тип члена | Примечания                                                                                                                                                                                                                                                                                                                                  |
|-------------------------------------------------|-------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Вызвать**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iinvokeprovider-invoke) | Метод      | **Invoke** является асинхронным вызовом и должен возвращаться немедленно без блокировки.<br/> Это особенно важно для элементов управления, которые при вызове прямо или косвенно запускают модальное диалоговое окно. Любой клиент автоматизации пользовательского интерфейса, инициировавший это событие, будет оставаться заблокированным до закрытия модального диалогового окна. <br/> |



 

Этот шаблон элемента управления не имеет связанных свойств или событий.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Типы элементов управления и поддерживаемые ими шаблоны элементов управления](uiauto-controlpatternmapping.md)
</dt> <dt>

[Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
</dt> <dt>

[Общие сведения о дереве модели автоматизации пользовательского интерфейса](uiauto-treeoverview.md)
</dt> <dt>

[**UIA \_ Invoke \_ инвокедевентид**](uiauto-event-ids.md)
</dt> </dl>

 

 





