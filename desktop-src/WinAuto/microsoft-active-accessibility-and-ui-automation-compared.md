---
title: Сравнение Microsoft Active Accessibility и автоматизации пользовательского интерфейса
description: В этом разделе приведены основные различия между Microsoft Active Accessibility и автоматизацией пользовательского интерфейса.
ms.assetid: ba963e53-6fb8-4bc1-8883-62547f52b0e2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c90c4bffd0646aea592e19adc51ca020b2c90d5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105654327"
---
# <a name="microsoft-active-accessibility-and-ui-automation-compared"></a>Сравнение Microsoft Active Accessibility и автоматизации пользовательского интерфейса

API автоматизации Windows состоит из двух технологий: Microsoft Active Accessibility и Microsoft UI Automation. Microsoft Active Accessibility — это устаревшая технология специальных возможностей, появившаяся в качестве надстройки платформы для Windows 95, в то время как модель автоматизации пользовательского интерфейса — это более новая, более мощная технология, которая приводит к ограничениям, свойственным Microsoft Active Accessibility.

В этом разделе приведены основные различия между Microsoft Active Accessibility и автоматизацией пользовательского интерфейса. Она включает следующие разделы:

-   [Основные принципы разработки](#basic-design-principles)
-   [Свойства и шаблоны элементов управления](#properties-and-control-patterns)
-   [Роли MSAA и шаблоны элементов управления модели автоматизации пользовательского интерфейса](#msaa-roles-and-ui-automation-control-patterns)
-   [Навигация в объектной модели](#object-model-navigation)
-   [Расширяемость объектной модели](#object-model-extensibility)
-   [Переход из MSAA](#transitioning-from-msaa)
-   [Выбор Microsoft Active Accessibility, модель автоматизации пользовательского интерфейса или IAccessibleEx](#choosing-microsoft-active-accessibility-ui-automation-or-iaccessibleex)
    -   [Новые приложения и элементы управления](#new-applications-and-controls)
    -   [Существующие реализации Active Accessibility Майкрософт](#existing-microsoft-active-accessibility-implementations)
-   [См. также](#related-topics)

## <a name="basic-design-principles"></a>Основные принципы разработки

Хотя Microsoft Active Accessibility и модель автоматизации пользовательского интерфейса — это две различные технологии, основные принципы разработки похожи. Обе технологии предназначены для предоставления обширных сведений об элементах пользовательского интерфейса, используемых в приложениях Windows. Разработчики средств специальных возможностей могут использовать эти сведения для создания программного обеспечения, которое делает приложения, работающие в Windows, более доступными для людей с зрением, слухом или нарушениями движения.

Как в Microsoft Active Accessibility, так и в модели автоматизации пользовательского интерфейса модель объектов пользовательского интерфейса предоставляется в виде иерархического дерева, расположенного на рабочем столе. Microsoft Active Accessibility представляет отдельные элементы пользовательского интерфейса как *Доступные объекты*, а модель автоматизации пользовательского интерфейса представляет их как *элементы автоматизации*. Они ссылаются на средство специальных возможностей или программу автоматизации программного обеспечения в качестве *клиента*. Однако Microsoft Active Accessibility относится к приложению или элементу управления, предлагающему пользовательский интерфейс для обеспечения специальных возможностей в качестве *сервера*, а модель автоматизации пользовательского интерфейса — это *поставщик*.

## <a name="properties-and-control-patterns"></a>Свойства и шаблоны элементов управления

Microsoft Active Accessibility предлагает единый интерфейс модели объектов (COM) с фиксированным небольшим набором свойств. Модель автоматизации пользовательского интерфейса предлагает более широкий набор свойств, а также набор расширенных интерфейсов, называемых *шаблонами элементов управления* , для управления доступными объектами в целях использования Microsoft Active Accessibility.

Дополнительные сведения см. в разделе [Общие сведения о свойствах модели автоматизации пользовательского интерфейса](uiauto-propertiesoverview.md) и [Обзор шаблонов элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md).

## <a name="msaa-roles-and-ui-automation-control-patterns"></a>Роли MSAA и шаблоны элементов управления модели автоматизации пользовательского интерфейса

Корпорация Майкрософт разработала модель объектов Microsoft Active Accessibility примерно в то же время, что и Windows 95. Модель основана на "ролях", определенной в десяти лет назад, и вы не можете поддерживать новые варианты поведения пользовательского интерфейса или объединять две или более ролей. Не существует объектной модели текста, например, чтобы помочь вспомогательным технологиям работать со сложным веб-содержимым. Модель автоматизации пользовательского интерфейса предоставляет эти ограничения, представляя шаблоны элементов управления, которые позволяют объектам поддерживать более одной роли, а шаблон элемента управления [текстом](uiauto-implementingtextandtextrange.md) модели автоматизации пользовательского интерфейса — полноценной объектной модели текста.

## <a name="object-model-navigation"></a>Навигация в объектной модели

Другое ограничение Microsoft Active Accessibility включает навигацию по объектной модели. Microsoft Active Accessibility представляет пользовательский интерфейс как иерархию доступных объектов. Клиенты могут переходить от одного доступного объекта к другому с помощью интерфейсов и методов, доступных из доступного объекта. Серверы могут предоставлять дочерние объекты доступного объекта со свойствами интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) или стандартным COM-интерфейсом [IEnumVARIANT](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) . Однако клиенты должны иметь возможность работать с обоими способами для любого сервера. Такая неоднозначность означает дополнительную работу для клиентских реализаций и неработающие объектные модели, доступные для реализации серверов.

Модель автоматизации пользовательского интерфейса представляет пользовательский интерфейс в виде иерархического дерева элементов автоматизации и предоставляет единый интерфейс для навигации по дереву. Клиенты могут настраивать представление элементов в дереве с помощью области и фильтрации.

## <a name="object-model-extensibility"></a>Расширяемость объектной модели

Свойства и функции Microsoft Active Accessibility не могут быть расширены без нарушения или изменения спецификации интерфейса COM для [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) . В результате новое поведение элемента управления не может быть предоставлено через объектную модель; Он, как правило, является статическим.

При использовании автоматизации пользовательского интерфейса при создании новых элементов пользовательского интерфейса разработчики приложений могут добавлять пользовательские свойства, шаблоны элементов управления и события для описания новых элементов. Дополнительные сведения см. в разделе [пользовательские свойства, события и шаблоны элементов управления](uiauto-custompropertieseventscontrolpatterns.md).

## <a name="transitioning-from-msaa"></a>Переход из MSAA

Платформа API автоматизации Windows обеспечивает поддержку перехода с серверов Microsoft Active Accessibility в поставщики автоматизации пользовательского интерфейса. Интерфейс [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex) позволяет добавлять определенные свойства автоматизации пользовательского интерфейса и шаблоны элементов управления к устаревшим серверам Microsoft Active Accessibility без необходимости переписывать всю реализацию. Интерфейс **IAccessibleEx** также позволяет внутрипроцессный клиентам Microsoft Active Accessibility доступ к интерфейсам поставщика автоматизации пользовательского интерфейса напрямую, а не через клиентские интерфейсы модели автоматизации пользовательского интерфейса. Дополнительные сведения см. в описании [интерфейса IAccessibleEx](iaccessibleex.md).

## <a name="choosing-microsoft-active-accessibility-ui-automation-or-iaccessibleex"></a>Выбор Microsoft Active Accessibility, модель автоматизации пользовательского интерфейса или IAccessibleEx

Этот раздел поможет вам определить, какое решение API службы автоматизации Windows использовать для реализации продукта с поддержкой специальных возможностей или сделать приложение доступным для программных продуктов с поддержкой специальных возможностей.

### <a name="new-applications-and-controls"></a>Новые приложения и элементы управления

При разработке нового приложения или элемента управления корпорация Майкрософт рекомендует использовать автоматизацию пользовательского интерфейса. Несмотря на то, что Microsoft Active Accessibility можно легко реализовать в течение короткого периода, ограничения, присущие этой технологии, такие как объектная модель устаревания и невозможность поддержки новых поведений пользовательского интерфейса или ролей слияния, делают его более сложным и дорогостоящим в долгосрочной перспективе. Эти ограничения становятся особенно очевидными при внедрении новых элементов управления.

Модель объектов модели автоматизации пользовательского интерфейса проще в использовании и более гибка, чем Active Accessibility Майкрософт. Элементы модели автоматизации пользовательского интерфейса отражать развитие пользовательских интерфейсов, а разработчики могут определять пользовательские шаблоны элементов управления автоматизации пользовательского интерфейса, свойства и события.

Microsoft Active Accessibility, как правило, медленно работает для клиентов, которые не работают в процессе. Для повышения производительности разработчики средств специальных возможностей часто применяют свои программы в процессе назначения и запускают их в процессе работы приложения: очень сложный и рискованный подход. Модель автоматизации пользовательского интерфейса гораздо проще реализовать для необработанных клиентов и обеспечивает гораздо более высокую производительность и надежность.

### <a name="existing-microsoft-active-accessibility-implementations"></a>Существующие реализации Active Accessibility Майкрософт

При обновлении существующего приложения или элемента управления, основанного на Microsoft Active Accessibility, рассмотрите возможность добавления поддержки модели автоматизации пользовательского интерфейса путем реализации интерфейса [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex) . Сначала убедитесь, что ваше приложение или элемент управления соответствует следующим требованиям.

-   Базовая иерархия доступных объектов Microsoft Active Accessibility Server должна быть хорошо организована, а ошибка бесплатная. [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex) не может устранить проблемы с существующими иерархиями доступных объектов.
-   Реализация [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex) должна соответствовать спецификации Microsoft Active Accessibility и спецификации автоматизации пользовательского интерфейса. Корпорация Майкрософт предоставляет набор средств для проверки соответствия обеим спецификациям. Дополнительные сведения см. в разделе [средства тестирования](testing-tools.md).

Если какое-либо из этих требований не соблюдается, рекомендуется реализовать автоматизацию пользовательского интерфейса изначально. Для обеспечения обратной совместимости в случае необходимости можно использовать устаревшие реализации Microsoft Active Accessibility Server. С точки зрения клиента модели автоматизации пользовательского интерфейса нет различий между поставщиками автоматизации пользовательского интерфейса и серверами Microsoft Active Accessibility, которые правильно реализуют [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex) .

Дополнительные сведения см. в описании [интерфейса IAccessibleEx](iaccessibleex.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Общие сведения об API автоматизации Windows](windows-automation-api-overview.md)
</dt> <dt>

[Microsoft Active Accessibility](microsoft-active-accessibility.md)
</dt> <dt>

[Модель автоматизации пользовательского интерфейса](entry-uiauto-win32.md)
</dt> <dt>

[Интерфейс IAccessibleEx](iaccessibleex.md)
</dt> </dl>

 

 