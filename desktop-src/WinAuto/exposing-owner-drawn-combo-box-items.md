---
title: Предоставление Owner-Drawn элементов поля со списком
description: Разработчикам приложений не нужно реализовывать IAccessible, чтобы предоставить элементы в поле со списком, рисуемом владельцем, которое имеет стиль CBS \_ хасстрингс, так как Microsoft Active Accessibility предоставляет элементы в полях со списком с этим стилем.
ms.assetid: 9ff14b2f-ae09-4839-b281-fba46addaf5f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 364dccaf21927e2d0092fc744d501f47830c6eeb
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105672361"
---
# <a name="exposing-owner-drawn-combo-box-items"></a>Предоставление Owner-Drawn элементов поля со списком

Разработчикам приложений не нужно реализовывать [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , чтобы предоставить элементы в поле со списком, рисуемом владельцем, которое имеет стиль **CBS \_ Хасстрингс** , так как Microsoft Active Accessibility предоставляет элементы в полях со списком с этим стилем. Элементы в поле со списком, рисуемом владельцем, с использованием стиля **CBS \_ хасстрингс** отображаются в виде текста. Однако этот стиль также используется с полями со списком, рисуемыми владельцем, которые не отображают текст, чтобы элементы поля со списком предоставлялись корпорацией Майкрософт Active Accessibility.

Чтобы разрешить Microsoft Active Accessibility предоставлять элементы в поле со списком, рисуемом владельцем, которое не отображает текст:

-   Используйте стиль **\_ хасстрингс CBS** при создании поля со списком.
-   Создайте текстовый аналог, названный или описывающий каждый элемент в поле со списком.
-   При добавлении элементов в поле со списком, рисуемое владельцем, используйте \_ сообщение ADDSTRING CB, чтобы добавить текст, который будет предоставляться Microsoft Active Accessibility. Этот текст не отображается, поэтому он не должен быть частью рисуемых владельцем данных. Добавление рисуемых владельцем данных элемента с помощью \_ сообщения СЕТИТЕМДАТА CB.

При использовании приведенного выше метода обратите внимание на следующее.

-   При использовании стиля **\_ сортировки CBS** поле со списком сортируется с использованием переданного строк, а не процедуры обратного вызова [WM \_ компареитем](../controls/wm-compareitem.md) .
-   С помощью рисуемых владельцем переменных полей со списком, созданных с помощью **\_ овнердраввариаблеа CBS**, используйте глобальную переменную или другой механизм, чтобы отследить, когда **итемдата** элемент [меасуреитемструкт](/windows/win32/api/winuser/ns-winuser-measureitemstruct) является допустимым. Глобальная переменная является обязательной, так как система отправляет сообщение [WM \_ меасуреитем](../controls/wm-measureitem.md) сразу после добавления строки, но перед присоединением данных элемента, и на данном этапе элемент **итемдата** является недопустимым.
-   Чтобы изменить строку для элемента в поле со списком с помощью стиля **CBS \_ хасстрингс** , удалите элемент с сообщением [ \_ делетестринг CB](../controls/cb-deletestring.md) и добавьте новую строку с сообщением [ \_ ADDSTRING CB](../controls/cb-addstring.md) .

 

 