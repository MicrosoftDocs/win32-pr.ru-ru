---
title: О шаблонах элементов управления Text и TextRange
description: Текстовое содержимое элемента управления предоставляется с помощью шаблона элемента управления Text, который представляет содержимое текстового контейнера в виде текстового потока.
ms.assetid: acc2b513-9367-416a-b0d9-3c2bcc14a8a7
keywords:
- Автоматизация пользовательского интерфейса, поддержка текстового содержимого
- Модель автоматизации пользовательского интерфейса, общие сведения о шаблоне текста
- Модель автоматизации пользовательского интерфейса, общие сведения об элементах управления текстом
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления Text
- Модель автоматизации пользовательского интерфейса, платформа текстовых служб (TSF)
- Модель автоматизации пользовательского интерфейса, TSF
- Модель автоматизации пользовательского интерфейса, производительность
- текстовые шаблоны, сведения
- текстовые шаблоны, платформа текстовых служб (TSF)
- элементы управления текстом, сведения
- текстовое содержимое, поддержка
- элементы управления "текст", "производительность"
- Шаблон элемента управления Text
- шаблоны элементов управления, текст
- Инфраструктура текстовых служб (TSF)
- TSF (платформа текстовых служб)
- производительность
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9ff1eb75227454e3e9df6035798a304096a958
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105700925"
---
# <a name="about-the-text-and-textrange-control-patterns"></a><span data-ttu-id="bef1c-120">О шаблонах элементов управления Text и TextRange</span><span class="sxs-lookup"><span data-stu-id="bef1c-120">About the Text and TextRange Control Patterns</span></span>

<span data-ttu-id="bef1c-121">Текстовое содержимое элемента управления предоставляется с помощью шаблона элемента управления [Text](uiauto-implementingtextandtextrange.md) , который представляет содержимое текстового контейнера в виде текстового потока.</span><span class="sxs-lookup"><span data-stu-id="bef1c-121">The textual content of a control is exposed by using the [Text](uiauto-implementingtextandtextrange.md) control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="bef1c-122">Шаблон элемента управления Text требует поддержки шаблона элемента управления TextRange для представления атрибутов формата и стиля.</span><span class="sxs-lookup"><span data-stu-id="bef1c-122">The Text control pattern requires the support of the TextRange control pattern to expose format and style attributes.</span></span> <span data-ttu-id="bef1c-123">Шаблон элемента управления TextRange поддерживает шаблон элемента управления Text, представляющий смежные или несколько несвязных текстовых диапазонов (или диапазонов) в текстовом контейнере с коллекцией начальных и конечных конечных точек.</span><span class="sxs-lookup"><span data-stu-id="bef1c-123">The TextRange control pattern supports the Text control pattern by representing contiguous or multiple, disjoint text spans (or ranges) in a text container with a collection of start and end endpoints.</span></span> <span data-ttu-id="bef1c-124">Шаблон элемента управления TextRange поддерживает такие функции, как выбор, сравнение, извлечение и обход.</span><span class="sxs-lookup"><span data-stu-id="bef1c-124">The TextRange control pattern supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!Note]  
> <span data-ttu-id="bef1c-125">Шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) не предоставляет средств для вставки или изменения текста.</span><span class="sxs-lookup"><span data-stu-id="bef1c-125">The [Text](uiauto-implementingtextandtextrange.md) control pattern does not provide a means to insert or modify text.</span></span> <span data-ttu-id="bef1c-126">Однако, в зависимости от элемента управления, это можно сделать с помощью шаблона элемента управления [value](uiauto-implementingvalue.md) модели автоматизации пользовательского интерфейса (Майкрософт) или с помощью прямого ввода с клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="bef1c-126">However, depending on the control, this may be accomplished by using the Microsoft UI Automation [Value](uiauto-implementingvalue.md) control pattern or through direct keyboard input.</span></span> <span data-ttu-id="bef1c-127">Существует также шаблон [**также TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) , который поддерживает программное изменение текста.</span><span class="sxs-lookup"><span data-stu-id="bef1c-127">There's also a [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) pattern that supports programmatic change to text.</span></span>

 

<span data-ttu-id="bef1c-128">Функциональные возможности, описанные в этом разделе, важны для поставщиков вспомогательных технологий и их конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="bef1c-128">The functionality described in this topic is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="bef1c-129">Специальные технологии могут использовать автоматизацию пользовательского интерфейса для сбора полных сведений о форматировании текста для пользователя и предоставления программных средств навигации и выбора текста по [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (символ, слово, строка или абзац).</span><span class="sxs-lookup"><span data-stu-id="bef1c-129">Assistive technologies can use UI Automation to gather complete text formatting information for the user and provide programmatic navigation and selection of text by [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (character, word, line, or paragraph).</span></span>

<span data-ttu-id="bef1c-130">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="bef1c-130">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="bef1c-131">Модель автоматизации пользовательского интерфейса TextPattern и платформа текстовых служб</span><span class="sxs-lookup"><span data-stu-id="bef1c-131">UI Automation TextPattern and the Text Services Framework</span></span>](#ui-automation-textpattern-and-the-text-services-framework)
-   [<span data-ttu-id="bef1c-132">Типы элементов управления</span><span class="sxs-lookup"><span data-stu-id="bef1c-132">Control Types</span></span>](#control-types)
-   [<span data-ttu-id="bef1c-133">Интерфейсы поставщика</span><span class="sxs-lookup"><span data-stu-id="bef1c-133">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="bef1c-134">Клиентские интерфейсы</span><span class="sxs-lookup"><span data-stu-id="bef1c-134">Client Interfaces</span></span>](#client-interfaces)
-   [<span data-ttu-id="bef1c-135">Производительность</span><span class="sxs-lookup"><span data-stu-id="bef1c-135">Performance</span></span>](#performance)
-   [<span data-ttu-id="bef1c-136">Шаблон текста и виртуализированные внедренные объекты</span><span class="sxs-lookup"><span data-stu-id="bef1c-136">Text Pattern and Virtualized Embedded Objects</span></span>](#text-pattern-and-virtualized-embedded-objects)
-   [<span data-ttu-id="bef1c-137">Использование пользовательского типа элемента управления с шаблоном элемента управления Text</span><span class="sxs-lookup"><span data-stu-id="bef1c-137">Using the Custom Control Type with the Text Control Pattern</span></span>](#using-the-custom-control-type-with-the-text-control-pattern)
-   [<span data-ttu-id="bef1c-138">Время существования текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="bef1c-138">Lifetime of a Text Range</span></span>](#lifetime-of-a-text-range)
-   [<span data-ttu-id="bef1c-139">См. также</span><span class="sxs-lookup"><span data-stu-id="bef1c-139">Related topics</span></span>](#related-topics)

## <a name="ui-automation-textpattern-and-the-text-services-framework"></a><span data-ttu-id="bef1c-140">Модель автоматизации пользовательского интерфейса TextPattern и платформа текстовых служб</span><span class="sxs-lookup"><span data-stu-id="bef1c-140">UI Automation TextPattern and the Text Services Framework</span></span>

<span data-ttu-id="bef1c-141">Платформа текстовых служб (TSF) — это простая и масштабируемая системная платформа, которая обеспечивает службы естественного языка и расширенный ввод текста на рабочем столе и в приложениях.</span><span class="sxs-lookup"><span data-stu-id="bef1c-141">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and in applications.</span></span> <span data-ttu-id="bef1c-142">Помимо предоставления интерфейсам для приложений доступа к хранилищу текста, оно также поддерживает метаданные для хранилища текста.</span><span class="sxs-lookup"><span data-stu-id="bef1c-142">In addition to providing interfaces for applications to expose their text store, it also supports metadata for the text store.</span></span>

<span data-ttu-id="bef1c-143">TSF предназначен для приложений, которым необходимо внедрять входные данные в сценарии с учетом контекста.</span><span class="sxs-lookup"><span data-stu-id="bef1c-143">TSF was designed for applications that need to inject input into context-aware scenarios.</span></span> <span data-ttu-id="bef1c-144">Однако шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) является решением только для чтения, которое предназначено для обеспечения оптимизированного доступа к хранилищу текста для средств чтения с экрана и устройств Брайля.</span><span class="sxs-lookup"><span data-stu-id="bef1c-144">The [Text](uiauto-implementingtextandtextrange.md) control pattern, however, is a read-only solution that is intended to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="bef1c-145">Доступные технологии, которым требуется доступ только для чтения к хранилищу текста, могут использовать шаблон элемента управления Text, но при этом потребуется функциональность TSF для входных данных, учитывающих контекст.</span><span class="sxs-lookup"><span data-stu-id="bef1c-145">Accessible technologies that require read-only access to a text store can use the Text control pattern, but will need the functionality of TSF for context-aware input.</span></span>

<span data-ttu-id="bef1c-146">Дополнительные сведения см. в разделе [Платформа текстовых служб](/windows/desktop/TSF/text-services-framework).</span><span class="sxs-lookup"><span data-stu-id="bef1c-146">For more information, see [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span></span>

## <a name="control-types"></a><span data-ttu-id="bef1c-147">Типы элементов управления</span><span class="sxs-lookup"><span data-stu-id="bef1c-147">Control Types</span></span>

<span data-ttu-id="bef1c-148">Тип [элемента управления "](uiauto-supporteditcontroltype.md) поле ввода" и тип элемента управления " [документ](uiauto-supportdocumentcontroltype.md) " модели автоматизации пользовательского интерфейса должны поддерживать шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) .</span><span class="sxs-lookup"><span data-stu-id="bef1c-148">The UI Automation [Edit](uiauto-supporteditcontroltype.md) control type and [Document](uiauto-supportdocumentcontroltype.md) control type must support the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="bef1c-149">Для улучшения специальных возможностей корпорация Майкрософт рекомендует, чтобы типы элементов управления [ToolTip](uiauto-supporttooltipcontroltype.md) и Text также поддерживали шаблон элемента управления Text, но это не обязательно.</span><span class="sxs-lookup"><span data-stu-id="bef1c-149">For improved accessibility, Microsoft recommends that the [ToolTip](uiauto-supporttooltipcontroltype.md) and Text control types also support the Text control pattern, but it is not required.</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="bef1c-150">Интерфейсы поставщика</span><span class="sxs-lookup"><span data-stu-id="bef1c-150">Provider Interfaces</span></span>

<span data-ttu-id="bef1c-151">Поставщики автоматизации пользовательского интерфейса поддерживают шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) для элемента управления путем реализации интерфейсов [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) и [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="bef1c-151">UI Automation providers support the [Text](uiauto-implementingtextandtextrange.md) control pattern for a control by implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interfaces.</span></span> <span data-ttu-id="bef1c-152">Эти интерфейсы предоставляют подробные сведения об атрибутах для текста в элементе управления и предоставляют широкие возможности навигации.</span><span class="sxs-lookup"><span data-stu-id="bef1c-152">These interfaces expose detailed attribute information for text in the control and provide robust navigational capabilities.</span></span>

<span data-ttu-id="bef1c-153">Поставщику не требуется поддерживать все текстовые атрибуты, если в элементе управления отсутствует поддержка какого-либо конкретного атрибута.</span><span class="sxs-lookup"><span data-stu-id="bef1c-153">A provider does not need to support all text attributes if the control lacks support for any particular attribute.</span></span>

<span data-ttu-id="bef1c-154">Поставщик должен поддерживать методы [**итекстпровидер::-SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) и [**Итекстранжепровидер:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) , если элемент управления поддерживает выделение текста или размещение текстового курсора (или системного курсора) в области текста.</span><span class="sxs-lookup"><span data-stu-id="bef1c-154">A provider must support the [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) and [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) methods if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="bef1c-155">Если элемент управления не поддерживает эту функцию, он не должен поддерживать ни один из этих методов.</span><span class="sxs-lookup"><span data-stu-id="bef1c-155">If the control does not support this functionality, it does not need to support either of these methods.</span></span> <span data-ttu-id="bef1c-156">Однако элемент управления должен предоставлять тип выбора текста, который он поддерживает, путем реализации свойства [**итекстпровидер:: суппортедтекстселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="bef1c-156">However, the control must expose the type of text selection it supports by implementing the [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property.</span></span>

<span data-ttu-id="bef1c-157">Поставщик всегда должен поддерживать [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) константы, **\_ символы текстунит** и текстунит, а также все остальные, которые он может поддерживать. **\_**</span><span class="sxs-lookup"><span data-stu-id="bef1c-157">A provider must always support the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) constants, **TextUnit\_Character** and **TextUnit\_Document**, as well as any others it is capable of supporting.</span></span>

> [!Note]  
> <span data-ttu-id="bef1c-158">Поставщик может пропускать поддержку определенного [**текстунита**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , откладывая до следующей самой крупной единицы, поддерживаемой в следующем порядке: **текстунит- \_ символ**, **текстунит \_**, **текстунит \_ Word**, **текстунит \_ line**, **текстунит \_ абзац**, **текстунит \_ Page** и **текстунит \_ Document**.</span><span class="sxs-lookup"><span data-stu-id="bef1c-158">The provider may skip support for a specific [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) by deferring to the next largest unit supported in the following order: **TextUnit\_Character**, **TextUnit\_Format**, **TextUnit\_Word**, **TextUnit\_Line**, **TextUnit\_Paragraph**, **TextUnit\_Page**, and **TextUnit\_Document**.</span></span>

 

## <a name="client-interfaces"></a><span data-ttu-id="bef1c-159">Клиентские интерфейсы</span><span class="sxs-lookup"><span data-stu-id="bef1c-159">Client Interfaces</span></span>

<span data-ttu-id="bef1c-160">Клиентские приложения модели автоматизации пользовательского интерфейса используют интерфейсы [**иуиаутоматионтекстпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) и [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) для доступа к текстовому содержимому элемента управления "текст".</span><span class="sxs-lookup"><span data-stu-id="bef1c-160">UI Automation client applications use the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) and [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interfaces to access the textual content of a text control.</span></span> <span data-ttu-id="bef1c-161">Клиенты используют **иуиаутоматионтекстпаттерн** для выбора фрагментов текста, называемых *текстовыми диапазонами*, и для получения указателей на интерфейсы **иуиаутоматионтекстранже** для диапазонов.</span><span class="sxs-lookup"><span data-stu-id="bef1c-161">Clients use **IUIAutomationTextPattern** to select spans of text called *text ranges*, and to retrieve pointers to **IUIAutomationTextRange** interfaces for the ranges.</span></span> <span data-ttu-id="bef1c-162">Интерфейс **иуиаутоматионтекстранже** позволяет клиентам управлять диапазоном текста и получать сведения о тексте в диапазоне, включая такие атрибуты, как имя шрифта, цвет переднего плана, стиль подчеркивания и т. д.</span><span class="sxs-lookup"><span data-stu-id="bef1c-162">The **IUIAutomationTextRange** interface enables clients to manipulate the text range, and to retrieve information about the text in the range, including attributes such as font name, foreground color, underline style, and so on.</span></span> <span data-ttu-id="bef1c-163">Дополнительные сведения см. в разделе [идентификаторы атрибутов текста](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="bef1c-163">For more information, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

## <a name="performance"></a><span data-ttu-id="bef1c-164">Производительность</span><span class="sxs-lookup"><span data-stu-id="bef1c-164">Performance</span></span>

<span data-ttu-id="bef1c-165">Шаблон элемента управления **Text** полагается на вызовы между процессами для большей части его функциональности, поэтому он не предоставляет механизм кэширования для повышения производительности при обработке содержимого.</span><span class="sxs-lookup"><span data-stu-id="bef1c-165">The **Text** control pattern relies on cross-process calls for most of its functionality, so it does not provide a caching mechanism to improve performance when it processes content.</span></span> <span data-ttu-id="bef1c-166">Доступ к другим шаблонам элементов управления в службе автоматизации пользовательского интерфейса Майкрософт можно получить с помощью метода [**иуиаутоматионелемент:: жеткачедпаттерн**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) .</span><span class="sxs-lookup"><span data-stu-id="bef1c-166">Other control patterns in Microsoft UI Automation can be accessed by using the [**IUIAutomationElement::GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) method.</span></span>

<span data-ttu-id="bef1c-167">Одним из способов повышения производительности является обеспечение того, что клиенты автоматизации пользовательского интерфейса пытаются получить блоки текста умеренного размера с помощью метода [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) .</span><span class="sxs-lookup"><span data-stu-id="bef1c-167">One technique for improving performance is to ensure that UI Automation clients attempt to retrieve moderately sized blocks of text by using the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method.</span></span> <span data-ttu-id="bef1c-168">Например, использование **gettext** для извлечения одиночных символов повлечет за собой попадание между процессами для каждого символа, в то время как не задавая максимальную длину при вызове **gettext** , повлечет за собой однопроцессное попадание, но может иметь высокую задержку в зависимости от размера текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="bef1c-168">For example, using **GetText** to retrieve single characters will incur cross-process hits for each character, whereas not specifying a maximum length when calling **GetText** will incur one cross-process hit, but can have high latency depending on the size of the text range.</span></span>

## <a name="text-pattern-and-virtualized-embedded-objects"></a><span data-ttu-id="bef1c-169">Шаблон текста и виртуализированные внедренные объекты</span><span class="sxs-lookup"><span data-stu-id="bef1c-169">Text Pattern and Virtualized Embedded Objects</span></span>

<span data-ttu-id="bef1c-170">Всякий раз, когда это возможно, реализация поставщика [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) и [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) должна поддерживать весь текст документа, включая текст за пределами окна просмотра.</span><span class="sxs-lookup"><span data-stu-id="bef1c-170">Whenever possible, a provider implementation of [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) should support the entire text of a document, including any text outside of the viewport.</span></span> <span data-ttu-id="bef1c-171">Для неотображаемого текста или внедренных объектов, которые являются виртуализированными, поставщики должны поддерживать [шаблон элемента управления виртуализедитем](uiauto-implementingvirtualizeditem.md) ([**ивиртуализедитемпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span><span class="sxs-lookup"><span data-stu-id="bef1c-171">For off-screen text or embedded objects that are virtualized, providers should support the [VirtualizedItem control pattern](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span></span>

<span data-ttu-id="bef1c-172">Если документ является виртуализированным, а весь текстовый поток по-прежнему доступен, свойство [**итекстпровидер::D окументранже**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) Извлекает текстовый диапазон, включающий весь документ.</span><span class="sxs-lookup"><span data-stu-id="bef1c-172">If a document is virtualized while the entire text stream is still available, the [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property will retrieve a text range that includes the entire document.</span></span> <span data-ttu-id="bef1c-173">Однако вызов метода [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) извлечет коллекцию виртуализированных объектов, представляющих все внедренные объекты в документе.</span><span class="sxs-lookup"><span data-stu-id="bef1c-173">However, calling the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method will retrieve a collection of virtualized objects that represent all embedded objects in the document.</span></span> <span data-ttu-id="bef1c-174">Для взаимодействия с виртуализированным внедренным объектом клиенты должны вызвать метод [**ивиртуализедитемпровидер:: реализовать**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) , который делает элементы полностью доступными в качестве элементов модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="bef1c-174">To interact with a virtualized embedded object, clients must call the [**IVirtualizedItemProvider::Realize**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) method, which makes the items fully accessible as UI Automation elements.</span></span> <span data-ttu-id="bef1c-175">Клиенты должны следовать аналогичной процедуре работы с элементами сетки во внедренной таблице, где часть таблицы находится вне экрана и виртуализирована.</span><span class="sxs-lookup"><span data-stu-id="bef1c-175">Clients must follow a similar process to work with grid elements in an embedded table where a portion of the table is off-screen and virtualized.</span></span>

## <a name="using-the-custom-control-type-with-the-text-control-pattern"></a><span data-ttu-id="bef1c-176">Использование пользовательского типа элемента управления с шаблоном элемента управления Text</span><span class="sxs-lookup"><span data-stu-id="bef1c-176">Using the Custom Control Type with the Text Control Pattern</span></span>

<span data-ttu-id="bef1c-177">Хотя шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) поддерживает множество атрибутов текста и внедренных объектов, невозможно определить заранее все возможные элементы документа и типы представления.</span><span class="sxs-lookup"><span data-stu-id="bef1c-177">While the [Text](uiauto-implementingtextandtextrange.md) control pattern supports many text attributes and embedded objects, it is not possible to define in advance all possible document elements and presentation types.</span></span> <span data-ttu-id="bef1c-178">Для элементов документа, которые не поддерживаются существующими атрибутами или типами стандартных элементов управления, поставщики могут использовать функции расширяемости, предоставляемые **настраиваемым** типом элемента управления модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="bef1c-178">For document elements that are not supported by the existing attributes or standard control types, providers can use the extensibility features provided by the UI Automation **Custom** control type.</span></span>

<span data-ttu-id="bef1c-179">Для приложений и пользовательских интерфейсов, основанных на презентациях страниц, представление границы и макета «страницы» также может быть выражено как внедренный объект, имеющий пользовательский тип элемента управления (то есть `LocalizedControlType="page"` ).</span><span class="sxs-lookup"><span data-stu-id="bef1c-179">For applications and user interfaces that are based on page presentations, the boundary and layout presentation of "page" can also be expressed as an embedded object that has a custom control type (that is, `LocalizedControlType="page"`).</span></span> <span data-ttu-id="bef1c-180">Таким образом, внедренный объект может размещать другие элементы страницы, которые не могут быть просто частью потока текста документа, например поля верхнего и нижнего колонтитула на каждой странице, как дочерние элементы внедренного объекта Page.</span><span class="sxs-lookup"><span data-stu-id="bef1c-180">That way, the embedded object can host other page elements that cannot easily be part of the document text stream, such as the header and footer fields of each page, as children of the "page" embedded object.</span></span> <span data-ttu-id="bef1c-181">Кроме того, каждый объект «Page» может поддерживать шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) независимо друг от друга, который хорошо подходит для приложений, таких как средства разработки для презентаций с показом слайдов или для настольных сред публикации на основе страниц.</span><span class="sxs-lookup"><span data-stu-id="bef1c-181">Alternatively, each "page" object can support the [Text](uiauto-implementingtextandtextrange.md) control pattern independently, which works well for applications such as authoring tools for slide show presentations, or page-based desktop publishing environments.</span></span>

## <a name="lifetime-of-a-text-range"></a><span data-ttu-id="bef1c-182">Время существования текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="bef1c-182">Lifetime of a Text Range</span></span>

<span data-ttu-id="bef1c-183">Если это возможно, поставщик должен гарантировать, что любые изменения текста, такие как удаления, вставки и перемещения, будут отражены в соответствующем текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="bef1c-183">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range.</span></span> <span data-ttu-id="bef1c-184">Если обновление диапазона текста невозможно, поставщик должен вызвать событие [**UIA \_ Text \_ текстчанжедевентид**](uiauto-event-ids.md) , чтобы уведомить клиентов о том, что текстовый диапазон больше не действителен, а новый должен быть получен.</span><span class="sxs-lookup"><span data-stu-id="bef1c-184">If updating the text range is not possible, the provider should raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event to notify clients that the text range is no longer valid and a new one must be retrieved.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bef1c-185">См. также</span><span class="sxs-lookup"><span data-stu-id="bef1c-185">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="bef1c-186">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="bef1c-186">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="bef1c-187">Как модель автоматизации пользовательского интерфейса поддерживает внедренные объекты</span><span class="sxs-lookup"><span data-stu-id="bef1c-187">How UI Automation Supports Embedded Objects</span></span>](uiauto-textpattern-and-embedded-objects-overview.md)
</dt> <dt>

[<span data-ttu-id="bef1c-188">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="bef1c-188">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="bef1c-189">Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого</span><span class="sxs-lookup"><span data-stu-id="bef1c-189">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="bef1c-190">Работа с элементами управления на основе текста</span><span class="sxs-lookup"><span data-stu-id="bef1c-190">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> <dt>

<span data-ttu-id="bef1c-191">**Другие ресурсы**</span><span class="sxs-lookup"><span data-stu-id="bef1c-191">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="bef1c-192">инфраструктуры текстовых служб (TSF)</span><span class="sxs-lookup"><span data-stu-id="bef1c-192">Text Services Framework</span></span>](/windows/desktop/TSF/text-services-framework)
</dt> </dl>

 

 