---
title: Работа с виртуализированными элементами
description: В этом разделе описывается использование функций, предоставляемых шаблонами элементов управления ItemContainer и Виртуализедитем для поиска и получения сведений о виртуализированных элементах.
ms.assetid: e1898ba0-5ffa-4c61-b378-c7ef7c4a2c52
keywords:
- Клиенты, виртуализированные элементы модели автоматизации пользовательского интерфейса
- Клиенты, виртуализированные элементы
- Клиенты, шаблоны элементов управления
- Клиенты, шаблоны элементов управления Виртуализедитем
- Клиенты, шаблоны элементов управления ItemContainer
- Клиенты, шаблоны элементов управления Виртуализедитем модели автоматизации пользовательского интерфейса
- Клиенты, шаблоны элементов управления модели автоматизации пользовательского интерфейса
- Клиенты, шаблоны элементов управления ItemContainer модели автоматизации пользовательского интерфейса
- Модель автоматизации пользовательского интерфейса, виртуализированные элементы
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления Виртуализедитем
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления ItemContainer
- Шаблоны элементов управления Виртуализедитем
- Шаблоны элементов управления ItemContainer
- шаблоны элементов управления, Виртуализедитем
- шаблоны элементов управления, ItemContainer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb29232b06304079ad5b9dfdfb589ad510a5b51f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104331403"
---
# <a name="working-with-virtualized-items"></a><span data-ttu-id="4ffa8-119">Работа с виртуализированными элементами</span><span class="sxs-lookup"><span data-stu-id="4ffa8-119">Working with Virtualized Items</span></span>

<span data-ttu-id="4ffa8-120">В этом разделе описывается использование функций, предоставляемых шаблонами элементов управления [ItemContainer](uiauto-implementingitemcontainer.md) и [виртуализедитем](uiauto-implementingvirtualizeditem.md) для поиска и получения сведений о виртуализированных элементах.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-120">This topic describes how to use functionality provided by the [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control patterns to find and retrieve information about virtualized items.</span></span>

-   [<span data-ttu-id="4ffa8-121">Общие сведения о виртуализации</span><span class="sxs-lookup"><span data-stu-id="4ffa8-121">Overview of Virtualization</span></span>](#overview-of-virtualization)
-   [<span data-ttu-id="4ffa8-122">Как элемент управления поддерживает виртуализацию</span><span class="sxs-lookup"><span data-stu-id="4ffa8-122">How a Control Supports Virtualization</span></span>](#how-a-control-supports-virtualization)
-   [<span data-ttu-id="4ffa8-123">Как клиенты находят и реализуют виртуализованные элементы</span><span class="sxs-lookup"><span data-stu-id="4ffa8-123">How Clients Find and Realize Virtualized Items</span></span>](#how-clients-find-and-realize-virtualized-items)
-   [<span data-ttu-id="4ffa8-124">Пример</span><span class="sxs-lookup"><span data-stu-id="4ffa8-124">Example</span></span>](#example)
-   [<span data-ttu-id="4ffa8-125">См. также</span><span class="sxs-lookup"><span data-stu-id="4ffa8-125">Related topics</span></span>](#related-topics)

## <a name="overview-of-virtualization"></a><span data-ttu-id="4ffa8-126">Общие сведения о виртуализации</span><span class="sxs-lookup"><span data-stu-id="4ffa8-126">Overview of Virtualization</span></span>

<span data-ttu-id="4ffa8-127">Элементы управления, содержащие большое количество дочерних элементов, могут использовать виртуализацию для эффективного управления элементами.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-127">Controls that contain a large number of child items can use virtualization to efficiently manage the items.</span></span> <span data-ttu-id="4ffa8-128">При использовании виртуализации элемент управления сохраняет полную информацию в памяти только для подмножества элементов в любой момент времени.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-128">With virtualization, the control maintains full information in memory for only a subset of items at any given time.</span></span> <span data-ttu-id="4ffa8-129">Как правило, подмножество включает только те элементы, которые в настоящее время видны пользователю.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-129">Typically, the subset includes only those items that are currently visible to the user.</span></span> <span data-ttu-id="4ffa8-130">Полные сведения о оставшихся виртуализованных элементах хранятся в хранилище и загружаются в память, так как им требуется элемент управления, например, когда новые элементы становятся видимыми для пользователя.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-130">Full information about the remaining virtualized items is kept in storage and is loaded into memory, or realized, as the control needs it, for example, as new items become visible to the user.</span></span>

<span data-ttu-id="4ffa8-131">Элементы управления, использующие виртуализацию, представляют проблему, поскольку только реализованные элементы полностью доступны в виде элементов модели автоматизации пользовательского интерфейса Майкрософт в дереве модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-131">Controls that use virtualization represent a challenge because only realized items are fully available as Microsoft UI Automation elements in the UI Automation tree.</span></span> <span data-ttu-id="4ffa8-132">Виртуализированные элементы не существуют в дереве, поэтому сведения о них недоступны для клиентов.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-132">Virtualized items do not exist in the tree, so information about them is not available to clients.</span></span> <span data-ttu-id="4ffa8-133">Чтобы получить сведения о виртуализированных элементах, клиентам требуется способ принудительной автоматизации пользовательского интерфейса для передачи запроса, чтобы реализовать элементы элемента управления.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-133">To retrieve information about virtualized items, clients need a way to force UI Automation to pass the request to realize the items to the control.</span></span> <span data-ttu-id="4ffa8-134">После реализации элементов Модель автоматизации пользовательского интерфейса может создавать для них элементы автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-134">After the items have been realized, UI Automation can create UI Automation elements for them.</span></span> <span data-ttu-id="4ffa8-135">Модель автоматизации пользовательского интерфейса содержит два шаблона элементов управления, позволяющие клиентам работать с виртуализированными элементами: [ItemContainer](uiauto-implementingitemcontainer.md) и [виртуализедитем](uiauto-implementingvirtualizeditem.md).</span><span class="sxs-lookup"><span data-stu-id="4ffa8-135">UI Automation includes two control patterns to enable clients to work with virtualized items: [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span></span>

## <a name="how-a-control-supports-virtualization"></a><span data-ttu-id="4ffa8-136">Как элемент управления поддерживает виртуализацию</span><span class="sxs-lookup"><span data-stu-id="4ffa8-136">How a Control Supports Virtualization</span></span>

<span data-ttu-id="4ffa8-137">Любой элемент управления, который может содержать виртуализированные элементы, должен поддерживать шаблон элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="4ffa8-137">Any control that can contain virtualized items must support the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="4ffa8-138">Кроме того, любой элемент, который может быть виртуализирован, должен поддерживать шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="4ffa8-138">Further, any item that can be virtualized must support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="4ffa8-139">Функциональные возможности, предоставляемые шаблонами элементов управления ItemContainer и Виртуализедитем, доступны клиентам через интерфейсы [**иуиаутоматионитемконтаинерпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) и [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="4ffa8-139">The functionality that is exposed by the ItemContainer and VirtualizedItem control patterns is accessible to clients through the [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) and [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interfaces.</span></span>

## <a name="how-clients-find-and-realize-virtualized-items"></a><span data-ttu-id="4ffa8-140">Как клиенты находят и реализуют виртуализованные элементы</span><span class="sxs-lookup"><span data-stu-id="4ffa8-140">How Clients Find and Realize Virtualized Items</span></span>

<span data-ttu-id="4ffa8-141">Клиенты могут использовать метод [**иуиаутоматионитемконтаинерпаттерн:: финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) для поиска дочерних элементов в контейнере на основе значения конкретного свойства.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-141">Clients can use the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method to search for child items in the container based on the value of a particular property.</span></span> <span data-ttu-id="4ffa8-142">Метод также может получить первый элемент в контейнере или элемент, следующий за указанным элементом.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-142">The method can also retrieve the first item in the container or the item that follows the specified item.</span></span> <span data-ttu-id="4ffa8-143">Если найден соответствующий дочерний элемент, **финдитембипроперти** Извлекает интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для элемента.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-143">If a matching child item is found, the **FindItemByProperty** retrieves an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the item.</span></span> <span data-ttu-id="4ffa8-144">Однако если дочерний элемент является виртуализированным, то интерфейс **иуиаутоматионелемент** является заполнителем.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-144">However, if the child item is virtualized, the **IUIAutomationElement** interface is a placeholder.</span></span> <span data-ttu-id="4ffa8-145">Ошибка [**UIA \_ E \_ елементнотаваилабле**](uiauto-error-codes.md) возникает, когда клиент пытается использовать интерфейс **иуиаутоматионелемент** для получения значений свойств или вызова методов, которые еще недоступны.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-145">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error occurs when the client attempts to use the **IUIAutomationElement** interface to retrieve property values or call methods that are not yet available.</span></span> <span data-ttu-id="4ffa8-146">Свойства или методы, доступные через заполнитель, зависят от реализации элемента управления.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-146">Which properties or methods are available through a placeholder depends on the control implementation.</span></span> <span data-ttu-id="4ffa8-147">Единственным требованием для заполнителя является поддержка интерфейса [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="4ffa8-147">The only requirement for a placeholder is to support the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface.</span></span>

<span data-ttu-id="4ffa8-148">Ошибка [**UIA \_ E \_ елементнотаваилабле**](uiauto-error-codes.md) — это указание клиенту на то, что элемент может быть виртуализирован.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-148">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error is an indication to the client that an item may be virtualized.</span></span> <span data-ttu-id="4ffa8-149">Клиент должен ответить путем получения интерфейса [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) для элемента, а затем реализовать элемент, вызвав метод [**Иуиаутоматионвиртуализедитемпаттерн:: реализовать**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) .</span><span class="sxs-lookup"><span data-stu-id="4ffa8-149">The client should respond by retrieving the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface for the item, and then realizing the item by calling the [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method.</span></span> <span data-ttu-id="4ffa8-150">В случае этого интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) будет полностью функциональным для всех доступных свойств.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-150">If this succeeds, the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface is fully functional with all appropriate properties available.</span></span>

<span data-ttu-id="4ffa8-151">В зависимости от реализации элемента управления вызов [**иуиаутоматионвиртуализедитемпаттерн:: реализовать**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) может привести к тому, что элемент управления прокручивает элемент на представление.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-151">Depending on the control implementation, calling [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) may cause the control to scroll the item into view.</span></span> <span data-ttu-id="4ffa8-152">Однако клиент не должен полагаться на прокрутку элемента в представление или сделать видимым.</span><span class="sxs-lookup"><span data-stu-id="4ffa8-152">However, a client should not rely on the item scrolling into view or made visible.</span></span> <span data-ttu-id="4ffa8-153">Чтобы убедиться, что элемент является видимым, клиент может использовать метод [**иуиаутоматионскроллитемпаттерн:: скроллинтовиев**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) .</span><span class="sxs-lookup"><span data-stu-id="4ffa8-153">To ensure that the item is visible, the client can use the [**IUIAutomationScrollItemPattern::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) method.</span></span>

## <a name="example"></a><span data-ttu-id="4ffa8-154">Пример</span><span class="sxs-lookup"><span data-stu-id="4ffa8-154">Example</span></span>

<span data-ttu-id="4ffa8-155">Пример кода, демонстрирующий использование поддержки модели автоматизации пользовательского интерфейса для виртуализации, см. [в разделе Получение виртуализированного элемента](uiauto-howto-retrieve-virtualized-item.md).</span><span class="sxs-lookup"><span data-stu-id="4ffa8-155">For example code that shows how to use the UI Automation support for virtualization, see [How to Retrieve a Virtualized Item](uiauto-howto-retrieve-virtualized-item.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4ffa8-156">См. также</span><span class="sxs-lookup"><span data-stu-id="4ffa8-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4ffa8-157">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="4ffa8-157">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 




