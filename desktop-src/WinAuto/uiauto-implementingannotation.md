---
title: Шаблон элемента Annotation
description: Описывает правила и соглашения для реализации Ианнотатионпровидер, включая сведения о свойствах и методах. Шаблон элемента управления Annotation используется для предоставления свойств заметки в документе.
ms.assetid: 5A334991-66AF-4A82-9A09-09D5BDAAA771
keywords:
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления Annotation
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления Annotation
- Модель автоматизации пользовательского интерфейса, Ианнотатионпровидер
- IAnnotationProvider
- Реализация шаблона элемента управления заметки модели автоматизации пользовательского интерфейса
- шаблон элемента Annotation
- шаблоны элементов управления, Ианнотатионпровидер
- шаблоны элементов управления, реализация аннотации автоматизации пользовательского интерфейса
- шаблоны элементов управления, аннотация
- интерфейсы, Ианнотатионпровидер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c1a0441816e548faaa9076b3a9717c0aa76f08a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105710313"
---
# <a name="annotation-control-pattern"></a><span data-ttu-id="77800-114">Шаблон элемента Annotation</span><span class="sxs-lookup"><span data-stu-id="77800-114">Annotation Control Pattern</span></span>

<span data-ttu-id="77800-115">Описывает правила и соглашения для реализации [**ианнотатионпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), включая сведения о свойствах и методах.</span><span class="sxs-lookup"><span data-stu-id="77800-115">Describes guidelines and conventions for implementing [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), including information about properties and methods.</span></span> <span data-ttu-id="77800-116">Шаблон элемента управления **Annotation** используется для предоставления свойств заметки в документе.</span><span class="sxs-lookup"><span data-stu-id="77800-116">The **Annotation** control pattern is used to expose the properties of an annotation in a document.</span></span>

<span data-ttu-id="77800-117">Одним из примеров является всплывающая подсказка с комментарием, расположенная на поле документа и подключенная к тексту документа или ячейке таблицы.</span><span class="sxs-lookup"><span data-stu-id="77800-117">One example is a comment balloon that is in the margin of a document and is connected to some document text or a spreadsheet cell.</span></span>

<span data-ttu-id="77800-118">На следующем рисунке показан пример заметки.</span><span class="sxs-lookup"><span data-stu-id="77800-118">The following illustration shows an example of an annotation.</span></span> <span data-ttu-id="77800-119">Примеры элементов управления, реализующих этот шаблон элемента управления, см. в разделе [типы элементов управления и поддерживаемые шаблоны элементов управления](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="77800-119">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

![снимок экрана с комментарием, балун в документе](images/annotation.png)

<span data-ttu-id="77800-121">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="77800-121">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="77800-122">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="77800-122">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="77800-123">Обязательные члены для **ианнотатионпровидер**</span><span class="sxs-lookup"><span data-stu-id="77800-123">Required Members for **IAnnotationProvider**</span></span>](#required-members-for-iannotationprovider)
-   [<span data-ttu-id="77800-124">См. также</span><span class="sxs-lookup"><span data-stu-id="77800-124">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="77800-125">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="77800-125">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="77800-126">При реализации шаблона элемента управления **Annotation** Обратите внимание на следующие правила и соглашения.</span><span class="sxs-lookup"><span data-stu-id="77800-126">When implementing the **Annotation** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="77800-127">Существует много различных типов заметок.</span><span class="sxs-lookup"><span data-stu-id="77800-127">There are many different kinds of annotations.</span></span> <span data-ttu-id="77800-128">Файл заголовка UIAutomationClient. h определяет набор именованных постоянных значений, которые определяют типы заметок, поддерживаемых Microsoft UI Automation.</span><span class="sxs-lookup"><span data-stu-id="77800-128">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that Microsoft UI Automation supports.</span></span> <span data-ttu-id="77800-129">Дополнительные сведения см. в разделе [**идентификаторы типов заметок**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="77800-129">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>
-   <span data-ttu-id="77800-130">Если используется [**аннотатионтипе \_ Unknown**](uiauto-annotation-type-identifiers.md), необходимо реализовать свойство [**ианнотатионпровидер:: аннотатионтипенаме**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) , чтобы позволить клиентам обнаруживать имя типа заметки.</span><span class="sxs-lookup"><span data-stu-id="77800-130">If you use [**AnnotationType\_Unknown**](uiauto-annotation-type-identifiers.md), you must implement the [**IAnnotationProvider::AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) property to enable clients to discover the name of the annotation type.</span></span> <span data-ttu-id="77800-131">Не нужно реализовывать **аннотатионтипенаме** для стандартного типа заметки, так как модель автоматизации пользовательского интерфейса предоставляет имя по умолчанию, но его можно реализовать, если необходимо переопределить имя по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="77800-131">You do not need to implement **AnnotationTypeName** for a standard annotation type because UI Automation provides a default name, but you can implement it if you need to override the default name.</span></span>
-   <span data-ttu-id="77800-132">Свойство [**ианнотатионпровидер:: Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) является необязательным.</span><span class="sxs-lookup"><span data-stu-id="77800-132">The [**IAnnotationProvider::Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) property is optional.</span></span>
-   <span data-ttu-id="77800-133">Свойство [**ианнотатионпровидер::D атетиме**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) является необязательным.</span><span class="sxs-lookup"><span data-stu-id="77800-133">The [**IAnnotationProvider::DateTime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) property is optional.</span></span>
-   <span data-ttu-id="77800-134">Свойство [**ианнотатионпровидер:: target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) является обязательным, так как оно связывает заметку с элементом пользовательского интерфейса, позволяя клиенту переходить от заметки к ЭЛЕМЕНТУ пользовательского интерфейса, к которому относится Аннотация.</span><span class="sxs-lookup"><span data-stu-id="77800-134">The [**IAnnotationProvider::Target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) property is required because it links an annotation to a UI element, enabling a client to navigate from the annotation back to the UI element to which the annotation refers.</span></span>
-   <span data-ttu-id="77800-135">Поскольку заметки могут принимать множество различных форм, интерфейс [**ианнотатионпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) не определяет свойство для хранения значения или текста заметки.</span><span class="sxs-lookup"><span data-stu-id="77800-135">Because annotations can take many different forms, the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface does not define a property for storing the value or text of an annotation.</span></span> <span data-ttu-id="77800-136">Простая Аннотация должна предоставлять доступ к интерфейсу [**ивалуепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) , а свойство [**Ивалуепровидер:: value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) должно возвращать значение только для чтения, указывающее текст заметки.</span><span class="sxs-lookup"><span data-stu-id="77800-136">A simple annotation should expose the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface, and the [**IValueProvider::Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) property should return a read-only value that specifies the annotation text.</span></span> <span data-ttu-id="77800-137">Более широкая Аннотация должна предоставлять интерфейс [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) для предоставления клиентам более обширного текста.</span><span class="sxs-lookup"><span data-stu-id="77800-137">A richer annotation should expose the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface to provide richer text to clients.</span></span>
-   <span data-ttu-id="77800-138">Переход от элемента пользовательского интерфейса к заметке в элементе зависит от вида элемента, для которого записываются аннотации, следующим образом:</span><span class="sxs-lookup"><span data-stu-id="77800-138">Navigating from a UI element to an annotation on the element depends on the kind of element being annotated, as follows:</span></span>
    -   <span data-ttu-id="77800-139">Для ячеек таблицы реализуйте метод [**испреадшититемпровидер:: жетаннотатионобжектс**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) для ссылки на заметку.</span><span class="sxs-lookup"><span data-stu-id="77800-139">For spreadsheet cells, implement the [**ISpreadsheetItemProvider::GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) method to refer to the annotation.</span></span>
    -   <span data-ttu-id="77800-140">Для текстового содержимого реализуйте атрибут Text [**аннотатионобжектс**](uiauto-textattribute-ids.md) в интерфейсе [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) для ссылки на заметку.</span><span class="sxs-lookup"><span data-stu-id="77800-140">For textual content, implement the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute on the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface to refer to the annotation.</span></span>
-   <span data-ttu-id="77800-141">Некоторые типы заметок не нуждаются в полной реализации интерфейса [**ианнотатионпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="77800-141">Some kinds of annotations do not require a full implementation of the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span> <span data-ttu-id="77800-142">Например, можно представить простой индикатор орфографической ошибки, если интерфейс [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) возвращает атрибут [**аннотатионтипес**](uiauto-textattribute-ids.md) Text [**аннотатионтипе \_ Спеллинжеррор**](uiauto-annotation-type-identifiers.md)и значение NULL для атрибута [**аннотатионобжектс**](uiauto-textattribute-ids.md) Text.</span><span class="sxs-lookup"><span data-stu-id="77800-142">For example, a simple spelling-error indicator could be represented by having the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
-   <span data-ttu-id="77800-143">Может быть полезно реализовать интерфейс [**ианнотатионпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) в невидимом ЭЛЕМЕНТЕ пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="77800-143">It can be useful to implement the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface on a UI element that is not visible.</span></span> <span data-ttu-id="77800-144">Например, можно создать невидимый элемент автоматизации пользовательского интерфейса, реализующий **ианнотатионпровидер** для предоставления расширенной информации об грамматической ошибке.</span><span class="sxs-lookup"><span data-stu-id="77800-144">For example, you could create a non-visible UI Automation element that implements **IAnnotationProvider** to provide extended information about a grammar error.</span></span>
-   <span data-ttu-id="77800-145">Аннотации в элементе управления на основе текста могут быть сложными, если элемент управления содержит перекрывающиеся комментарии.</span><span class="sxs-lookup"><span data-stu-id="77800-145">Annotations in a text-based control can be complex if the control contains overlapping comments.</span></span> <span data-ttu-id="77800-146">Используйте следующие рекомендации для работы с сложными заметками:</span><span class="sxs-lookup"><span data-stu-id="77800-146">Use the following guidelines to handle complex annotations:</span></span>
    -   <span data-ttu-id="77800-147">Текстовый диапазон без заметок должен возвращать пустой массив для текстового атрибута [**аннотатионтипес**](uiauto-textattribute-ids.md) и пустой массив для атрибута Text [**аннотатионобжектс**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="77800-147">A text range with no annotations should return an empty array for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an empty array for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="77800-148">Текстовый диапазон с одной заметкой должен возвращать массив из одного целочисленного значения для текстового атрибута [**аннотатионтипес**](uiauto-textattribute-ids.md) и массив из одного интерфейса [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) для текстового атрибута [**аннотатионобжектс**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="77800-148">A text range with one annotation should return an array of one integer value for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of one [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="77800-149">Текстовый диапазон с несколькими заметками должен возвращать массив из нескольких целочисленных значений для атрибута Text [**аннотатионтипес**](uiauto-textattribute-ids.md) и массив соответствующего числа интерфейсов [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) для атрибута Text [**аннотатионобжектс**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="77800-149">A text range with multiple annotations should return an array of multiple integer values for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of a matching number of [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interfaces for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="77800-150">Текстовый диапазон с различными заметками, например диапазон с заметками и текстом без заметок, должен возвращать свойство [**ресерведмикседаттрибутевалуе**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) для [**аннотатионтипес**](uiauto-textattribute-ids.md) и [**аннотатионобжектс**](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="77800-150">A text range with varying annotations, such as a range with both annotated and non-annotated text, should return the [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) property for both [**AnnotationTypes**](uiauto-textattribute-ids.md) and [**AnnotationObjects**](uiauto-textattribute-ids.md).</span></span> <span data-ttu-id="77800-151">Клиент, получивший этот ответ, может разделить текстовый диапазон, чтобы найти место начала и конца заметок.</span><span class="sxs-lookup"><span data-stu-id="77800-151">A client receiving this response can subdivide the text range to find where the annotations begin and end.</span></span>

## <a name="required-members-for-iannotationprovider"></a><span data-ttu-id="77800-152">Обязательные члены для **ианнотатионпровидер**</span><span class="sxs-lookup"><span data-stu-id="77800-152">Required Members for **IAnnotationProvider**</span></span>

<span data-ttu-id="77800-153">Для реализации интерфейса [**ианнотатионпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) требуются следующие свойства.</span><span class="sxs-lookup"><span data-stu-id="77800-153">The following properties are required for implementing the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span>



| <span data-ttu-id="77800-154">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="77800-154">Required members</span></span>                                                                | <span data-ttu-id="77800-155">Тип члена</span><span class="sxs-lookup"><span data-stu-id="77800-155">Member type</span></span> | <span data-ttu-id="77800-156">Примечания</span><span class="sxs-lookup"><span data-stu-id="77800-156">Notes</span></span> |
|---------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="77800-157">**аннотатионтипеид**</span><span class="sxs-lookup"><span data-stu-id="77800-157">**AnnotationTypeId**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypeid)     | <span data-ttu-id="77800-158">Свойство</span><span class="sxs-lookup"><span data-stu-id="77800-158">Property</span></span>    | <span data-ttu-id="77800-159">Нет.</span><span class="sxs-lookup"><span data-stu-id="77800-159">None.</span></span> |
| [<span data-ttu-id="77800-160">**аннотатионтипенаме**</span><span class="sxs-lookup"><span data-stu-id="77800-160">**AnnotationTypeName**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) | <span data-ttu-id="77800-161">Свойство</span><span class="sxs-lookup"><span data-stu-id="77800-161">Property</span></span>    | <span data-ttu-id="77800-162">Нет.</span><span class="sxs-lookup"><span data-stu-id="77800-162">None.</span></span> |
| [<span data-ttu-id="77800-163">**Автор**</span><span class="sxs-lookup"><span data-stu-id="77800-163">**Author**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author)                         | <span data-ttu-id="77800-164">Свойство</span><span class="sxs-lookup"><span data-stu-id="77800-164">Property</span></span>    | <span data-ttu-id="77800-165">Нет.</span><span class="sxs-lookup"><span data-stu-id="77800-165">None.</span></span> |
| [<span data-ttu-id="77800-166">**DateTime**</span><span class="sxs-lookup"><span data-stu-id="77800-166">**DateTime**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime)                     | <span data-ttu-id="77800-167">Свойство</span><span class="sxs-lookup"><span data-stu-id="77800-167">Property</span></span>    | <span data-ttu-id="77800-168">Нет.</span><span class="sxs-lookup"><span data-stu-id="77800-168">None.</span></span> |
| [<span data-ttu-id="77800-169">**Целевой объект**</span><span class="sxs-lookup"><span data-stu-id="77800-169">**Target**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target)                         | <span data-ttu-id="77800-170">Свойство</span><span class="sxs-lookup"><span data-stu-id="77800-170">Property</span></span>    | <span data-ttu-id="77800-171">Нет.</span><span class="sxs-lookup"><span data-stu-id="77800-171">None.</span></span> |



 

<span data-ttu-id="77800-172">Этот шаблон элемента управления не имеет связанных событий.</span><span class="sxs-lookup"><span data-stu-id="77800-172">This control pattern has no associated events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="77800-173">См. также</span><span class="sxs-lookup"><span data-stu-id="77800-173">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="77800-174">Типы элементов управления и поддерживаемые ими шаблоны элементов управления</span><span class="sxs-lookup"><span data-stu-id="77800-174">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="77800-175">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="77800-175">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="77800-176">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="77800-176">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 