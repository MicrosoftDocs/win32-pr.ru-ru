---
title: Использование дочерних идентификаторов в параметрах
description: В этом разделе описываются входные параметры, выходные параметры и особые случаи для интерпретации дочерних идентификаторов, возвращаемых методами IAccessible.
ms.assetid: 051ec5ba-540c-4ae1-b917-4c229557ca2f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c03026e6abf769efab95cc513231fad3af64511f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413209"
---
# <a name="how-child-ids-are-used-in-parameters"></a><span data-ttu-id="b3c73-103">Использование дочерних идентификаторов в параметрах</span><span class="sxs-lookup"><span data-stu-id="b3c73-103">How Child IDs Are Used in Parameters</span></span>

<span data-ttu-id="b3c73-104">В этом разделе описываются входные параметры, выходные параметры и особые случаи для интерпретации дочерних идентификаторов, возвращаемых методами [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-104">This topic describes input parameters, output parameters, and special cases for interpreting child IDs returned from [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods.</span></span>

## <a name="input-parameters"></a><span data-ttu-id="b3c73-105">Входные параметры</span><span class="sxs-lookup"><span data-stu-id="b3c73-105">Input Parameters</span></span>

<span data-ttu-id="b3c73-106">Многие функции Microsoft Active Accessibility и большинство свойств [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) принимают [**вариантную**](/windows/win32/api/oaidl/ns-oaidl-variant) структуру в качестве входного параметра.</span><span class="sxs-lookup"><span data-stu-id="b3c73-106">Many of the Microsoft Active Accessibility functions and most of the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties take a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) structure as an input parameter.</span></span> <span data-ttu-id="b3c73-107">Для большинства свойств **IAccessible** этот параметр позволяет разработчикам клиентов указать, требуется ли пользователю получить сведения о самом объекте или об одном из простых элементов объекта.</span><span class="sxs-lookup"><span data-stu-id="b3c73-107">For most of the **IAccessible** properties, this parameter allows client developers to specify whether they want information about the object itself or about one of the object's simple elements.</span></span>

<span data-ttu-id="b3c73-108">Microsoft Active Accessibility предоставляет постоянную **чилдид \_** , которая указывает, что информация необходима для самого объекта.</span><span class="sxs-lookup"><span data-stu-id="b3c73-108">Microsoft Active Accessibility provides the constant **CHILDID\_SELF** to indicate that information is needed about the object itself.</span></span> <span data-ttu-id="b3c73-109">Чтобы получить сведения о простом элементе, разработчики клиента указывают свой дочерний идентификатор в параметре [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-109">To obtain information about a simple element, client developers specify its child ID in the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter.</span></span>

<span data-ttu-id="b3c73-110">При инициализации параметра [**типа Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) не забудьте указать **VT \_ I4** в элементе **VT** , а также указать значение идентификатора дочернего элемента (или **чилдид \_ Self**) в элементе **лвал** .</span><span class="sxs-lookup"><span data-stu-id="b3c73-110">When initializing a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, be sure to specify **VT\_I4** in the **vt** member in addition to specifying the child ID value (or **CHILDID\_SELF**) in the **lVal** member.</span></span>

<span data-ttu-id="b3c73-111">Например, чтобы получить имя объекта, а не один из дочерних элементов объекта, инициализируйте [**вариант**](/windows/win32/api/oaidl/ns-oaidl-variant) первого параметра метода [**IAccessible:: Get \_ аккнаме**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **Чилдид \_ Self** в элементе **лвал** и **VT \_ I4** в элементе **VT** ), а затем вызовите метод **IAccessible:: Get \_ аккнаме**.</span><span class="sxs-lookup"><span data-stu-id="b3c73-111">For example, to get the name of an object, and not one of the object's child elements, initialize the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) for the first parameter of [**IAccessible::get\_accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID\_SELF** in the **lVal** member and **VT\_I4** in the **vt** member), and then call **IAccessible::get\_accName**.</span></span>

## <a name="output-parameters"></a><span data-ttu-id="b3c73-112">Выходные параметры</span><span class="sxs-lookup"><span data-stu-id="b3c73-112">Output Parameters</span></span>

<span data-ttu-id="b3c73-113">Несколько функций и методов [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) имеют [](/windows/win32/api/oaidl/ns-oaidl-variant) \* выходной параметр Variant, который содержит идентификатор дочернего объекта или указатель интерфейса [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) на дочерний объект.</span><span class="sxs-lookup"><span data-stu-id="b3c73-113">Several [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) functions and methods have a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)\* output parameter that contains a child ID or an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer to a child object.</span></span> <span data-ttu-id="b3c73-114">Клиент должен выполнить различные действия в зависимости от того, получал ли он дочерний идентификатор объекта **VT \_** (простой элемент) или указатель интерфейса **IDispatch** с **чилдид \_ Self** (полный объект).</span><span class="sxs-lookup"><span data-stu-id="b3c73-114">There are different steps that a client must take depending on whether they receive a **VT\_I4** child ID (simple element) or an **IDispatch** interface pointer with **CHILDID\_SELF** (full object).</span></span> <span data-ttu-id="b3c73-115">После выполнения этих действий будет предоставлен указатель интерфейса **IAccessible** и идентификатор дочернего элемента, которые позволяют клиентам использовать методы и свойства **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="b3c73-115">Following these steps will provide an **IAccessible** interface pointer and child ID that together allow clients to use the **IAccessible** methods and properties.</span></span> <span data-ttu-id="b3c73-116">Эти действия относятся к методам [**IAccessible:: акчиттест**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**Get \_ аккфокус**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus)и [**Get \_ аккселектион**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-116">These steps apply to the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**get\_accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus), and [**get\_accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) methods.</span></span> <span data-ttu-id="b3c73-117">Они также применяются к клиентским функциям [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**акцессиблеобжектфромпоинт**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)и [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-117">They also apply to the [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) client functions.</span></span>

<span data-ttu-id="b3c73-118">В следующей таблице перечислены возможные возвращаемые результаты и необходимые действия, выполняемые после обработки, чтобы клиенты имели указатель интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) и идентификатор дочернего элемента.</span><span class="sxs-lookup"><span data-stu-id="b3c73-118">The following table lists the possible result returned and the required post-processing steps so that clients will have an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer and child ID.</span></span>



| <span data-ttu-id="b3c73-119">Возвращенный результат</span><span class="sxs-lookup"><span data-stu-id="b3c73-119">Result returned</span></span>                                      | <span data-ttu-id="b3c73-120">После обработки возвращаемого значения</span><span class="sxs-lookup"><span data-stu-id="b3c73-120">Post-processing for the return value</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b3c73-121">Указатель интерфейса [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch)</span><span class="sxs-lookup"><span data-stu-id="b3c73-121">[**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer</span></span> | <span data-ttu-id="b3c73-122">Это полный объект. Вызовите [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) для доступа к указателю интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-122">This is a full object.Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to access the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer.</span></span><br/> <span data-ttu-id="b3c73-123">Используйте указатель интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) с **чилдид \_ Self** для доступа к методам и свойствам **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="b3c73-123">Use the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer with **CHILDID\_SELF** to access **IAccessible** methods and properties.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="b3c73-124">\_Идентификатор дочернего элемента VT I4</span><span class="sxs-lookup"><span data-stu-id="b3c73-124">VT\_I4 child ID</span></span>                                      | <span data-ttu-id="b3c73-125">Вызовите метод [**IAccessible:: Get \_ аккчилд**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) , используя идентификатор дочернего элемента, чтобы проверить, есть ли у вас указатель интерфейса [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) . Если вы получаете указатель интерфейса [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) , используйте его с **чилдид \_ Self** для доступа к методам и свойствам интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-125">Call [**IAccessible::get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) using the child ID to see if you have an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer.If you get an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer, use it with **CHILDID\_SELF** to access [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface methods and properties.</span></span><br/> <span data-ttu-id="b3c73-126">Если вызов [**Get \_ аккчилд**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) завершается неудачей, у вас есть простой элемент.</span><span class="sxs-lookup"><span data-stu-id="b3c73-126">If the call to [**get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) fails, you have a simple element.</span></span> <span data-ttu-id="b3c73-127">Используйте исходный указатель интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) (тот, который использовался при вызове метода или функции, упомянутой выше) с идентификатором дочернего элемента **VT \_ I4** , возвращенным вызовом.</span><span class="sxs-lookup"><span data-stu-id="b3c73-127">Use the original [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer (the one you used in your call to the method or function mentioned above) with the **VT\_I4** child ID that the call returned.</span></span><br/> |



 

<span data-ttu-id="b3c73-128">Прежде чем можно будет использовать параметр [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , его необходимо инициализировать, вызвав функцию модели COM компонента [**вариантинит**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-128">Before you can use a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, you must initialize it by calling the [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) Component Object Model (COM) function.</span></span> <span data-ttu-id="b3c73-129">После завершения работы со структурой вызовите [**вариантклеар**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) , чтобы освободить память, зарезервированную для этого **варианта**.</span><span class="sxs-lookup"><span data-stu-id="b3c73-129">When finished with the structure, call [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) to free the memory reserved for that **VARIANT**.</span></span>

## <a name="special-cases"></a><span data-ttu-id="b3c73-130">Особые случаи</span><span class="sxs-lookup"><span data-stu-id="b3c73-130">Special Cases</span></span>

<span data-ttu-id="b3c73-131">Существуют исключения из правил, приведенных в таблице выше, например, когда идентификатор дочернего элемента возвращается методом [**IAccessible:: акчиттест**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) .</span><span class="sxs-lookup"><span data-stu-id="b3c73-131">There are exceptions to the guidelines in the above table, such as when a child ID is returned by the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) method.</span></span> <span data-ttu-id="b3c73-132">Серверы должны возвращать интерфейс [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) , если дочерний объект является доступным объектом.</span><span class="sxs-lookup"><span data-stu-id="b3c73-132">Servers must return an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface if the child is an accessible object.</span></span> <span data-ttu-id="b3c73-133">Если в **IAccessible:: акчиттест** возвращается дочерний идентификатор, то дочерний элемент является простым.</span><span class="sxs-lookup"><span data-stu-id="b3c73-133">If a child ID is returned by **IAccessible::accHitTest**, the child is a simple element.</span></span>

<span data-ttu-id="b3c73-134">Кроме того, существуют особые случаи для [**аккнавигате**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span><span class="sxs-lookup"><span data-stu-id="b3c73-134">In addition, there are special cases for [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span></span> <span data-ttu-id="b3c73-135">Дополнительные сведения см. в разделе **IAccessible:: аккнавигате** , [пространственные и логическая Навигация](spatial-and-logical-navigation.md).</span><span class="sxs-lookup"><span data-stu-id="b3c73-135">For more information, see **IAccessible::accNavigate** and [Spatial and Logical Navigation](spatial-and-logical-navigation.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b3c73-136">См. также</span><span class="sxs-lookup"><span data-stu-id="b3c73-136">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="b3c73-137">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="b3c73-137">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="b3c73-138">Интерфейс IDispatch</span><span class="sxs-lookup"><span data-stu-id="b3c73-138">IDispatch Interface</span></span>](idispatch-interface.md)
</dt> <dt>

[<span data-ttu-id="b3c73-139">Структура варианта</span><span class="sxs-lookup"><span data-stu-id="b3c73-139">VARIANT Structure</span></span>](variant-structure.md)
</dt> </dl>

 

