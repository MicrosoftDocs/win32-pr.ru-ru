---
title: Общие сведения о дереве модели автоматизации пользовательского интерфейса
description: Продукты с поддержкой специальных возможностей и сценарии тестирования позволяют перемещаться по дереву Microsoft UI Automation для сбора сведений о пользовательском интерфейсе и его элементах.
ms.assetid: f3afe258-baa7-41b5-a27e-cdc94b467d73
keywords:
- Модель автоматизации пользовательского интерфейса, Обзор дерева
- Модель автоматизации пользовательского интерфейса, представление дерева
- Модель автоматизации пользовательского интерфейса, необработанное представление дерева
- Модель автоматизации пользовательского интерфейса, представление элемента управления Tree
- Модель автоматизации пользовательского интерфейса, представление содержимого дерева
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c76bc9aa6568a3f4d63194d35ff0c7d8f59510c3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888175"
---
# <a name="ui-automation-tree-overview"></a><span data-ttu-id="fa545-108">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="fa545-108">UI Automation Tree Overview</span></span>

<span data-ttu-id="fa545-109">Продукты с поддержкой специальных возможностей и сценарии тестирования позволяют перемещаться по дереву Microsoft UI Automation для сбора сведений о пользовательском интерфейсе и его элементах.</span><span class="sxs-lookup"><span data-stu-id="fa545-109">Assistive technology products and test scripts navigate the Microsoft UI Automation tree to gather information about the UI and its elements.</span></span>

<span data-ttu-id="fa545-110">В дереве модели автоматизации пользовательского интерфейса находится корневой элемент, представляющий окно рабочего стола Windows (Рабочий стол), чьи дочерние элементы представляют окна приложений.</span><span class="sxs-lookup"><span data-stu-id="fa545-110">In the UI Automation tree is a root element that represents the Windows desktop window ("the desktop") and whose child elements represent application windows.</span></span> <span data-ttu-id="fa545-111">Каждый из этих дочерних элементов может содержать элементы, представляющие части пользовательского интерфейса, такие как меню, кнопки, панели инструментов и списки.</span><span class="sxs-lookup"><span data-stu-id="fa545-111">Each of these child elements can contain elements that represent pieces of the UI, such as menus, buttons, toolbars, and list boxes.</span></span> <span data-ttu-id="fa545-112">Эти элементы могут содержать элементы, такие как элементы списка.</span><span class="sxs-lookup"><span data-stu-id="fa545-112">These elements can contain elements, such as list items.</span></span>

<span data-ttu-id="fa545-113">Дерево модели автоматизации пользовательского интерфейса не является фиксированной структурой.</span><span class="sxs-lookup"><span data-stu-id="fa545-113">The UI Automation tree is not a fixed structure.</span></span> <span data-ttu-id="fa545-114">Она редко встречается в целом, так как она может содержать тысячи элементов.</span><span class="sxs-lookup"><span data-stu-id="fa545-114">It is seldom seen in its totality because it might contain thousands of elements.</span></span> <span data-ttu-id="fa545-115">Части дерева модели автоматизации пользовательского интерфейса строятся по мере необходимости клиентом, а структура дерева изменяется по мере добавления, перемещения или удаления элементов.</span><span class="sxs-lookup"><span data-stu-id="fa545-115">Parts of the UI Automation tree are built as a client needs them, and the structure of the tree changes as elements are added, moved, or removed.</span></span>

<span data-ttu-id="fa545-116">Поставщики автоматизации пользовательского интерфейса поддерживают дерево модели автоматизации пользовательского интерфейса, реализуя навигацию между элементами в фрагменте.</span><span class="sxs-lookup"><span data-stu-id="fa545-116">UI Automation providers support the UI Automation tree by implementing navigation among items in a fragment.</span></span> <span data-ttu-id="fa545-117">Фрагмент — это полное поддерево элементов из определенной платформы и имеющее корневой элемент (называемый *корнем фрагмента*), который обычно размещается в окне.</span><span class="sxs-lookup"><span data-stu-id="fa545-117">A fragment is a complete subtree of elements from a particular framework, and has a root element (called the *fragment root*) that is typically hosted in a window.</span></span>

<span data-ttu-id="fa545-118">Поставщики не связаны с навигацией от одного элемента управления к другому.</span><span class="sxs-lookup"><span data-stu-id="fa545-118">Providers are not concerned with navigation from one control to another.</span></span> <span data-ttu-id="fa545-119">Это управляется ядром автоматизации пользовательского интерфейса, которое использует сведения из поставщиков окон по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="fa545-119">This is managed by the UI Automation core, which uses information from the default window providers.</span></span>

<span data-ttu-id="fa545-120">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="fa545-120">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="fa545-121">Представления дерева модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="fa545-121">Views of the UI Automation Tree</span></span>](#views-of-the-ui-automation-tree)
    -   [<span data-ttu-id="fa545-122">Необработанное представление</span><span class="sxs-lookup"><span data-stu-id="fa545-122">Raw View</span></span>](#raw-view)
    -   [<span data-ttu-id="fa545-123">Представление элемента управления</span><span class="sxs-lookup"><span data-stu-id="fa545-123">Control View</span></span>](#control-view)
    -   [<span data-ttu-id="fa545-124">Представление содержимого</span><span class="sxs-lookup"><span data-stu-id="fa545-124">Content View</span></span>](#content-view)
-   [<span data-ttu-id="fa545-125">См. также</span><span class="sxs-lookup"><span data-stu-id="fa545-125">Related topics</span></span>](#related-topics)

## <a name="views-of-the-ui-automation-tree"></a><span data-ttu-id="fa545-126">Представления дерева модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="fa545-126">Views of the UI Automation Tree</span></span>

<span data-ttu-id="fa545-127">Дерево модели автоматизации пользовательского интерфейса можно фильтровать для создания представлений, содержащих только те элементы автоматизации пользовательского интерфейса, которые относятся к конкретному клиенту.</span><span class="sxs-lookup"><span data-stu-id="fa545-127">The UI Automation tree can be filtered to create views that contain only those UI Automation elements that are relevant for a particular client.</span></span> <span data-ttu-id="fa545-128">Такой подход позволяет клиентам настраивать структуру, представленную в модели автоматизации пользовательского интерфейса, в соответствии с конкретными потребностями.</span><span class="sxs-lookup"><span data-stu-id="fa545-128">This approach allows clients to customize the structure that is presented through UI Automation to their particular needs.</span></span>

<span data-ttu-id="fa545-129">Клиент может настраивать представление с помощью области и фильтрации.</span><span class="sxs-lookup"><span data-stu-id="fa545-129">The client can customize the view by scoping and by filtering.</span></span> <span data-ttu-id="fa545-130">Определение области определяет экстент представления, начиная с базового элемента.</span><span class="sxs-lookup"><span data-stu-id="fa545-130">Scoping is defining the extent of the view, starting from a base element.</span></span> <span data-ttu-id="fa545-131">Например, приложению может потребоваться найти только прямые дочерние элементы рабочего стола или всех потомков окна приложения.</span><span class="sxs-lookup"><span data-stu-id="fa545-131">For example, the application might want to find only direct children of the desktop, or all descendants of an application window.</span></span> <span data-ttu-id="fa545-132">Фильтрация определяет типы элементов, включенных в представление.</span><span class="sxs-lookup"><span data-stu-id="fa545-132">Filtering is defining the types of elements that are included in the view.</span></span>

<span data-ttu-id="fa545-133">Поставщики автоматизации пользовательского интерфейса поддерживают фильтрацию путем определения свойств элементов, включая свойства [**иуиаутоматионелемент:: исконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) и [**Иуиаутоматионелемент:: исконтентелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="fa545-133">UI Automation providers support filtering by defining properties on elements, including the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) and [**IUIAutomationElement::IsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="fa545-134">Модель автоматизации пользовательского интерфейса предоставляет три представления по умолчанию: представление RAW, представление элемента управления и представление содержимого.</span><span class="sxs-lookup"><span data-stu-id="fa545-134">UI Automation provides three default views: raw view, control view, and content view.</span></span> <span data-ttu-id="fa545-135">Эти представления определяются типом выполняемой фильтрации.</span><span class="sxs-lookup"><span data-stu-id="fa545-135">These views are defined by the type of filtering performed.</span></span> <span data-ttu-id="fa545-136">Область любого представления определяется приложением.</span><span class="sxs-lookup"><span data-stu-id="fa545-136">The scope of any view is defined by the application.</span></span> <span data-ttu-id="fa545-137">Приложение может применять другие фильтры к свойствам; Например, чтобы включить в представление элемента управления только включенные элементы управления.</span><span class="sxs-lookup"><span data-stu-id="fa545-137">The application can apply other filters on properties; for example, to include only enabled controls in a control view.</span></span>

### <a name="raw-view"></a><span data-ttu-id="fa545-138">Базовое представление</span><span class="sxs-lookup"><span data-stu-id="fa545-138">Raw View</span></span>

<span data-ttu-id="fa545-139">Необработанное представление дерева модели автоматизации пользовательского интерфейса представляет собой полное дерево элементов автоматизации, для которых настольным компьютером является корневой элемент.</span><span class="sxs-lookup"><span data-stu-id="fa545-139">The raw view of the UI Automation tree is the full tree of automation elements for which the desktop is the root.</span></span> <span data-ttu-id="fa545-140">Необработанное представление в точности соответствует собственной программной структуре приложения и является самым подробным представлением.</span><span class="sxs-lookup"><span data-stu-id="fa545-140">The raw view closely follows the native programmatic structure of an application, and is the most detailed view available.</span></span> <span data-ttu-id="fa545-141">Оно также является основой, на которой строятся другие представления дерева.</span><span class="sxs-lookup"><span data-stu-id="fa545-141">It is also the base on which the other views of the tree are built.</span></span> <span data-ttu-id="fa545-142">Поскольку это представление зависит от базовой платформы пользовательского интерфейса, необработанное представление кнопки Windows Presentation Foundation (WPF) имеет разное представление RAW, чем кнопка Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="fa545-142">Because this view depends on the underlying UI framework, the raw view of a Windows Presentation Foundation (WPF) button has a different raw view than a Microsoft Win32 button.</span></span>

<span data-ttu-id="fa545-143">Представление RAW получается путем поиска элементов без указания свойств или с помощью [**иуиаутоматион:: раввиеввалкер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker) для получения интерфейса [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) для навигации по дереву.</span><span class="sxs-lookup"><span data-stu-id="fa545-143">The raw view is obtained by searching for elements without specifying properties or by using the [**IUIAutomation::RawViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker) to get an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface for navigating the tree.</span></span>

### <a name="control-view"></a><span data-ttu-id="fa545-144">Представление элемента управления</span><span class="sxs-lookup"><span data-stu-id="fa545-144">Control View</span></span>

<span data-ttu-id="fa545-145">Представление элемента управления является подмножеством базового представления.</span><span class="sxs-lookup"><span data-stu-id="fa545-145">The control view is a subset of the raw view.</span></span> <span data-ttu-id="fa545-146">Он включает только те элементы пользовательского интерфейса, для которых свойство [**иуиаутоматионелемент:: исконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) имеет значение **true**.</span><span class="sxs-lookup"><span data-stu-id="fa545-146">It includes only those UI items that have the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property set to **TRUE**.</span></span>

<span data-ttu-id="fa545-147">Представление элемента управления включает элементы пользовательского интерфейса, предоставляющие сведения пользователю или позволяющие пользователю выполнить действие.</span><span class="sxs-lookup"><span data-stu-id="fa545-147">The control view includes the UI items that provide information to the user or enable the user to perform an action.</span></span> <span data-ttu-id="fa545-148">Это элементы пользовательского интерфейса, которые наиболее интересны для автоматизированного тестирования приложений.</span><span class="sxs-lookup"><span data-stu-id="fa545-148">These are the UI items that are most interesting to automated testing applications.</span></span>

<span data-ttu-id="fa545-149">Представление элемента управления также включает неинтерактивные элементы пользовательского интерфейса, которые вносят вклад в логическую структуру пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="fa545-149">The control view also includes noninteractive UI items that contribute to the logical structure of the UI.</span></span> <span data-ttu-id="fa545-150">К ним относятся контейнеры элементов, такие как заголовки представлений списков, панели инструментов, меню и строка состояния.</span><span class="sxs-lookup"><span data-stu-id="fa545-150">These include item containers such as list view headers, toolbars, menus, and the status bar.</span></span> <span data-ttu-id="fa545-151">Другие неинтерактивные элементы, отображаемые в представлении элемента управления, представляют собой графические данные и статический текст в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="fa545-151">Other noninteractive items that appear in the control view are graphics with information and static text in a dialog box.</span></span>

<span data-ttu-id="fa545-152">Неинтерактивные элементы, используемые только для макета или декоративных целей, такие как панели, используемые для размещения элементов управления в диалоговом окне, не отображаются в представлении элемента управления.</span><span class="sxs-lookup"><span data-stu-id="fa545-152">Noninteractive items used only for layout or decorative purposes, such as panels used to lay out controls in a dialog box, do not appear in the control view.</span></span>

<span data-ttu-id="fa545-153">Представление элемента управления дерева модели автоматизации пользовательского интерфейса тесно соответствует структуре пользовательского интерфейса, воспринимаемой конечным пользователем.</span><span class="sxs-lookup"><span data-stu-id="fa545-153">The control view of the UI Automation tree closely maps to the UI structure perceived by an end user.</span></span> <span data-ttu-id="fa545-154">Благодаря этому продукт с поддержкой специальных возможностей упрощает описание пользовательского интерфейса для конечного пользователя и помогает ему взаимодействовать с приложением.</span><span class="sxs-lookup"><span data-stu-id="fa545-154">This makes it easier for the assistive technology product to describe the UI to the end user and help that end user interact with the application.</span></span>

<span data-ttu-id="fa545-155">Представление элемента управления получается путем поиска элементов, для которых свойство [**иуиаутоматионелемент:: исконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) установлено в значение true, или с помощью [**контролвиеввалкер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) , чтобы получить интерфейс [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) для навигации по дереву.</span><span class="sxs-lookup"><span data-stu-id="fa545-155">The control view is obtained by searching for elements that have the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property set to true, or by using [**ControlViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) to get an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface for navigating the tree.</span></span>

### <a name="content-view"></a><span data-ttu-id="fa545-156">Представление содержимого</span><span class="sxs-lookup"><span data-stu-id="fa545-156">Content View</span></span>

<span data-ttu-id="fa545-157">Представление содержимого дерева модели автоматизации пользовательского интерфейса является подмножеством представления элемента управления.</span><span class="sxs-lookup"><span data-stu-id="fa545-157">The content view of the UI Automation tree is a subset of the control view.</span></span> <span data-ttu-id="fa545-158">Он включает только те элементы пользовательского интерфейса, у которых свойство [**иуиаутоматионелемент:: исконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) и [**Иуиаутоматионелемент:: Исконтентелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) установлено в **значение true**.</span><span class="sxs-lookup"><span data-stu-id="fa545-158">It includes only those UI items that have both the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) and the [**IUIAutomationElement::IsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property set to **TRUE**.</span></span>

<span data-ttu-id="fa545-159">Представление содержимого содержит элементы ПОЛЬЗОВАТЕЛЬСКОГО интерфейса, которые передают фактические данные в пользовательском интерфейсе, включая элементы пользовательского интерфейса, которые могут получать фокус клавиатуры, и некоторый текст, который не является меткой элемента пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="fa545-159">The content view contains UI items that convey the actual information in a user interface, including UI items that can receive keyboard focus and some text that is not a label on a UI item.</span></span> <span data-ttu-id="fa545-160">Это элементы пользовательского интерфейса, которые наиболее интересны для приложения для чтения с экрана.</span><span class="sxs-lookup"><span data-stu-id="fa545-160">These are the UI items that are most interesting to a screen reader application.</span></span> <span data-ttu-id="fa545-161">Например, значения в раскрывающемся поле со списком отображаются в представлении содержимого, поскольку значения представляют сведения, используемые конечным пользователем.</span><span class="sxs-lookup"><span data-stu-id="fa545-161">For example, the values in a drop-down combo box appear in the content view because the values represent information being used by an end user.</span></span>

<span data-ttu-id="fa545-162">В представлении содержимого поле со списком и поле со списком представляются в виде коллекции элементов пользовательского интерфейса, где можно выбрать один или несколько элементов.</span><span class="sxs-lookup"><span data-stu-id="fa545-162">In the content view, a combo box and a list box are both represented as a collection of UI items where one, or more than one, item can be selected.</span></span> <span data-ttu-id="fa545-163">Тот факт, что один элемент всегда открыт, и один элемент может быть развернут и свернут, не имеет отношения к представлению содержимого, так как он предназначен для отображения данных или содержимого, представляемого пользователю.</span><span class="sxs-lookup"><span data-stu-id="fa545-163">The fact that one item is always open and one item can expand and collapse is irrelevant in the content view because it is designed to show the data, or content, that is being presented to the user.</span></span>

<span data-ttu-id="fa545-164">Представление содержимого получается путем поиска элементов, у которых свойство [**исконтролелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) и [**Куррентисконтентелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) имеет значение **true**, или с помощью [**иуиаутоматион:: контентвиеввалкер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) , чтобы получить интерфейс [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) для навигации по дереву.</span><span class="sxs-lookup"><span data-stu-id="fa545-164">The content view is obtained by searching for elements that have both the [**IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) and the [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property set to **TRUE**, or by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) to get an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface for navigating the tree.</span></span>

<span data-ttu-id="fa545-165">На следующих изображениях показаны различия между представлением элемента управления и представлением содержимого.</span><span class="sxs-lookup"><span data-stu-id="fa545-165">The following images show the differences between the control view and content view.</span></span> <span data-ttu-id="fa545-166">На первом изображении показано простое поле со списком, содержащее три элемента в раскрывающемся списке.</span><span class="sxs-lookup"><span data-stu-id="fa545-166">The first image shows a simple combo box with three items in the dropdown list.</span></span> <span data-ttu-id="fa545-167">На втором изображении показано, как отображаются элементы пользовательского интерфейса поля со списком в представлениях элементов управления и содержимого приложения UISpy.exe.</span><span class="sxs-lookup"><span data-stu-id="fa545-167">The second image shows how the combo box UI items appear in the control and content views of the UISpy.exe application.</span></span>

![снимок экрана простого поля со списком с тремя раскрывающимися элементами](images/combobox.png)

![снимок экрана приложения UISpy с представлениями элементов управления и содержимого элементов поля со списком](images/treeviews.jpg)

## <a name="related-topics"></a><span data-ttu-id="fa545-170">См. также</span><span class="sxs-lookup"><span data-stu-id="fa545-170">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="fa545-171">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="fa545-171">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="fa545-172">Создание объекта Куиаутоматион</span><span class="sxs-lookup"><span data-stu-id="fa545-172">Creating the CUIAutomation Object</span></span>](uiauto-creatingcuiautomation.md)
</dt> <dt>

[<span data-ttu-id="fa545-173">Получение элементов автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="fa545-173">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="fa545-174">Основы модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="fa545-174">UI Automation Fundamentals</span></span>](entry-uiautocore-overview.md)
</dt> </dl>

 

 




