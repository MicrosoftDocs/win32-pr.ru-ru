---
title: Использование заметки с картой значений
description: Пример кода см. в разделе пример заметки к карте значений.
ms.assetid: 29be74c7-a7c2-41f4-8b94-5771988b74ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a3a3e8d003d863372e21a413fad56bc93b977ee3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413017"
---
# <a name="using-value-map-annotation"></a>Использование заметки с картой значений

**Создание схемы значений**

1.  **Создайте строку сопоставления.**

    Строка сопоставления — это список числовых значений элемента управления, соответствующих удобочитаемой строке в Юникоде. Он начинается с "A:", за которым следует число, указывающее тип используемого индекса. Поддерживаются только индексы изображений; Поэтому тип индекса всегда равен 0.

    За строкой следуют следующие пары: индекс: результат. "Index" — это число, представляющее индекс изображения для List-View или представления дерева или значение для элемента управления "ползунок".

    Полученное значение представляет собой число, полученное при сопоставлении свойства Role или State для представления списка или элемента управления иерархического представления. Такие числа выражаются в десятичном или шестнадцатеричном формате с префиксом "0x".

    Строка сопоставления всегда заканчивается завершающим двоеточием (":").

    Ниже приведен пример отображения заметки для свойств State и Role флажка в представлении списка или элементе управления иерархического представления. В представлении есть два элемента, представляющих флажки, каждый из которых имеет изображения, соответствующие установленному и непроверенному состоянию.

    ```C++
    LPCWSTR g_ListOrTreeStateMap = 
    L"A:0"     // Index type; always 0. !
    L":0:0x00" // Image 0 is normal !
    L":1:0x10" // Image 1 is checked - STATE_SYSTEM_CHECKED (0x10) !
    L":";

    LPCWSTR g_ListOrTreeRoleMap = 
    L"A:0"     // Index type; always 0. !
    L":0:0x2C" // Image 0 is a check box - ROLE_SYSTEM_CHECKBUTTON
    (0x2c) !
    L":1:0x2C" // image 1 is also a check box !
    L":";
    ```

    

    Допустимые значения ролей и состояний см. в разделе [роли объектов](object-roles.md) и [константы состояния объектов](object-state-constants.md).

    Значение индекса может быть отрицательным при сопоставлении свойств для элемента управления "ползунок".

    При сопоставлении свойства Value или Description результатом будет строка. Строки не заключаются в кавычки, а двоеточия действуют как разделители.

    Дополнительные сведения см. в разделе [Формат отображения заметок](value-map-annotation.md).

2.  **Создайте диспетчер заметок и получите указатель на его** интерфейс [**иаккпропсервицес**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices)**.**

    Ниже приведен пример создания диспетчера заметок.

    ```C++
    IAccPropServices * pAccPropSvc = NULL;
    HRESULT hr = CoCreateInstance(CLSID_AccPropServices, NULL,
    CLSCTX_SERVER, IID_IAccPropServices, (void**) & pAccPropSvc));
    
    ```

    

3.  **Присоедините строку сопоставления к элементу управления.**

    Вызовите [**иаккпропсервицес:: сесвндпропстр**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropstr), передав **HWND** элемента управления и указатель на строку сопоставления.

    Параметр *идпроп* будет иметь один из следующих параметров.

    

    | Параметр                   | Используется для                                                |
    |-----------------------------|---------------------------------------------------------|
    | МСААПРОПИД \_ ролемап         | Для задания схемы роли для элементов управления представления списка или дерева.  |
    | МСААПРОПИД \_ статемап        | Задание отображения состояния для представления списка или элементов управления иерархического представления. |
    | PROPID \_ ACC \_ дескриптионмап | Для задания схемы описания представления списка или представления в виде дерева.   |
    | МСААПРОПИД \_ VALUEMAP        | Чтобы задать карту значений для элементов управления "ползунок".                  |

    

     

4.  **Очистка.**

    Перед удалением элементов управления с аннотацией значений (например, при обработке [WM \_ destroy](../winmsg/wm-destroy.md)) необходимо очистить ранее зарегистрированные свойства и отпустить диспетчер заметок.

    Для этого вызовите [**иаккпропсервицес:: клеархвндпропс**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearhwndprops) , как нужно, и отпустите указатель на [**иаккпропсервицес**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices).

Пример кода см. в разделе [Пример заметки к карте значений](value-map-annotation-sample.md).

 

 