---
title: Как работает Active Accessibility
description: Microsoft Active Accessibility предназначен для поддержки специальных возможностей, называемых клиентами, взаимодействия со стандартными и настраиваемыми элементами пользовательского интерфейса других приложений и операционной системы.
ms.assetid: 29325f0a-c6ca-42b1-b85d-2671f7041034
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdeffcebd96ffba804bfc24672bf867028e9b0c7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "103890192"
---
# <a name="how-active-accessibility-works"></a><span data-ttu-id="9e9a7-103">Как работает Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="9e9a7-103">How Active Accessibility Works</span></span>

<span data-ttu-id="9e9a7-104">Microsoft Active Accessibility предназначен для поддержки специальных возможностей, называемых *клиентами*, взаимодействия со стандартными и настраиваемыми ЭЛЕМЕНТАМИ пользовательского интерфейса других приложений и операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-104">Microsoft Active Accessibility is designed to help accessibility aids, called *clients*, interact with standard and custom UI elements of other applications and the operating system.</span></span> <span data-ttu-id="9e9a7-105">Клиент Microsoft Active Accessibility — это любая программа, которая использует Microsoft Active Accessibility для доступа к элементам пользовательского интерфейса приложения, их обнаружения или управления ими.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-105">A Microsoft Active Accessibility client is any program that uses Microsoft Active Accessibility to access, identify, or manipulate the UI elements of an application.</span></span> <span data-ttu-id="9e9a7-106">Клиенты включают специальные возможности, средства автоматизированного тестирования и некоторые обучающие приложения на основе компьютеров.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-106">Clients include accessibility aids, automated testing tools, and some computer-based training applications.</span></span>

<span data-ttu-id="9e9a7-107">С помощью Active Accessibility Майкрософт клиентское приложение может:</span><span class="sxs-lookup"><span data-stu-id="9e9a7-107">Using Microsoft Active Accessibility, a client application can:</span></span>

-   <span data-ttu-id="9e9a7-108">Запрос сведений; Например, сведения об элементе пользовательского интерфейса в определенном месте.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-108">Query for information; for example, about a UI element at a particular location.</span></span>
-   <span data-ttu-id="9e9a7-109">Получение уведомлений об изменении информации; Например, когда элемент управления превращается в серый или изменяется при изменении текстовой строки.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-109">Receive notifications when information changes; for example, when a control becomes grayed or when a text string changes.</span></span>
-   <span data-ttu-id="9e9a7-110">Выполнение действий, влияющих на пользовательский интерфейс или содержимое документа; Например, нажмите кнопку "Отправить", раскрывающийся меню и выберите команду меню.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-110">Carry out actions that affect user interface or document contents; for example, click a push button, drop down a menu, and choose a menu command.</span></span>

<span data-ttu-id="9e9a7-111">Приложения, которые взаимодействуют с и предоставляют сведения для клиентов, называются *серверами*.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-111">The applications that interact with and provide information for clients are called *servers*.</span></span> <span data-ttu-id="9e9a7-112">Сервер использует Active Accessibility Майкрософт для предоставления сведений о своих элементах пользовательского интерфейса клиентам.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-112">A server uses Microsoft Active Accessibility to provide information about its UI elements to clients.</span></span> <span data-ttu-id="9e9a7-113">Любой элемент управления, модуль или приложение, использующее Microsoft Active Accessibility для предоставления сведений о пользовательском интерфейсе, считается сервером Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-113">Any control, module, or application that uses Microsoft Active Accessibility to expose information about its user interface is considered a Microsoft Active Accessibility server.</span></span> <span data-ttu-id="9e9a7-114">Серверы взаимодействуют с клиентами, отправляя уведомления о событиях (например, вызов [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)) и реагируя на запросы клиентов на доступ к элементам пользовательского интерфейса (например, обработка сообщений [**WM \_ GetObject**](wm-getobject.md) , отправленных из [*олеакк*](uiauto-glossary.md)).</span><span class="sxs-lookup"><span data-stu-id="9e9a7-114">Servers communicate with clients by sending event notifications (such as calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)) and responding to client requests for access to UI elements (such as handling [**WM\_GETOBJECT**](wm-getobject.md) messages sent from [*OLEACC*](uiauto-glossary.md)).</span></span> <span data-ttu-id="9e9a7-115">Серверы предоставляют сведения через интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="9e9a7-115">Servers expose information through the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface.</span></span>

<span data-ttu-id="9e9a7-116">С помощью Microsoft Active Accessibility серверное приложение может:</span><span class="sxs-lookup"><span data-stu-id="9e9a7-116">Using Microsoft Active Accessibility, a server application can:</span></span>

-   <span data-ttu-id="9e9a7-117">Предоставьте сведения о пользовательских объектах пользовательского интерфейса и содержимом его клиентских окон.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-117">Provide information about its custom user interface objects and the contents of its client windows.</span></span>
-   <span data-ttu-id="9e9a7-118">Отправка уведомлений при изменении пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-118">Send notifications when its user interface changes.</span></span>

<span data-ttu-id="9e9a7-119">Например, чтобы позволить пользователю выбирать команды, которые являются командными на пользовательской панели инструментов текстового редактора, программа распознавания речи должна иметь информацию об этой панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-119">For example, to enable a user to select commands verbally from a word processor custom toolbar, a speech recognition program must have information about that toolbar.</span></span> <span data-ttu-id="9e9a7-120">Поэтому обработчику слова необходимо сделать эту информацию доступной.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-120">The word processor would therefore need to make that information available.</span></span> <span data-ttu-id="9e9a7-121">Microsoft Active Accessibility предоставляет для текстового процессора средства для предоставления сведений о пользовательской панели инструментов и программе распознавания речи для получения этих сведений.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-121">Microsoft Active Accessibility provides the means for the word processor to expose information about its custom toolbar and for the speech recognition program to get that information.</span></span>

### <a name="client-applications-and-active-accessibility"></a><span data-ttu-id="9e9a7-122">Клиентские приложения и Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="9e9a7-122">Client Applications and Active Accessibility</span></span>

<span data-ttu-id="9e9a7-123">Клиент Microsoft Active Accessibility должен получать уведомления при изменении пользовательского интерфейса сервера, чтобы он мог передать эту информацию пользователю.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-123">A Microsoft Active Accessibility client must be notified when the server UI has changed so that it can convey that information to the user.</span></span> <span data-ttu-id="9e9a7-124">Чтобы гарантировать, что клиент уведомляется об изменениях пользовательского интерфейса, он использует механизм, именуемый событиями окна или Виневентс, для регистрации для получения уведомлений.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-124">To ensure that the client is informed about UI changes, it uses a mechanism called Window Events, or WinEvents, to register to receive notifications.</span></span> <span data-ttu-id="9e9a7-125">Дополнительные сведения см. в разделе [виневентс](winevents-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="9e9a7-125">For more information, see [WinEvents](winevents-infrastructure.md).</span></span>

<span data-ttu-id="9e9a7-126">Для получения сведений об определенном элементе пользовательского интерфейса и управлении им используются клиенты, использующие интерфейс модели COM (Майкрософт) компонента [**Active Accessibility.**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible)</span><span class="sxs-lookup"><span data-stu-id="9e9a7-126">To learn about and manipulate a particular UI element, clients use the Microsoft Active Accessibility Component Object Model (COM) interface, [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).</span></span>

<span data-ttu-id="9e9a7-127">Клиент может получить объект [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента пользовательского интерфейса следующими четырьмя способами:</span><span class="sxs-lookup"><span data-stu-id="9e9a7-127">A client can retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for a UI element in the following four ways:</span></span>

-   <span data-ttu-id="9e9a7-128">Вызовите [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) и передайте маркер окна элемента пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-128">Call [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) and pass the UI element's window handle.</span></span>
-   <span data-ttu-id="9e9a7-129">Вызовите [**акцессиблеобжектфромпоинт**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) и передайте положение на экране, которое находится внутри ограничивающего прямоугольника элемента пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-129">Call [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) and pass a screen location that lies within the UI element's bounding rectangle.</span></span>
-   <span data-ttu-id="9e9a7-130">Установите обработчик WinEvent, получите уведомление и вызовите [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) , чтобы получить указатель интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента пользовательского интерфейса, создавшего событие.</span><span class="sxs-lookup"><span data-stu-id="9e9a7-130">Set a WinEvent hook, receive a notification, and call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer for the UI element that generated the event.</span></span>
-   <span data-ttu-id="9e9a7-131">Вызовите метод [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , такой как [**аккнавигате**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) или [**Get \_ аккпарент**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) , чтобы перейти к другому объекту **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="9e9a7-131">Call an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) method such as [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) or [**get\_accParent**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) to move to a different **IAccessible** object.</span></span>

 

 




