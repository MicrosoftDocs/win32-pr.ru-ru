---
title: Обзор Виневентс и Active Accessibility
description: Microsoft Active Accessibility Servers вызывает Виневентс для уведомления клиентов об изменении объекта со специальными возможностями.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "103987145"
---
# <a name="winevents-and-active-accessibility"></a><span data-ttu-id="02e18-103">Виневентс и Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="02e18-103">WinEvents and Active Accessibility</span></span>

<span data-ttu-id="02e18-104">Microsoft Active Accessibility Servers вызывает *виневентс* для уведомления клиентов об изменении объекта со специальными возможностями.</span><span class="sxs-lookup"><span data-stu-id="02e18-104">Microsoft Active Accessibility servers raise *WinEvents* to notify clients when an accessible object changes.</span></span> <span data-ttu-id="02e18-105">Существует множество условий, при которых сервер уведомляет клиента об изменении.</span><span class="sxs-lookup"><span data-stu-id="02e18-105">There are numerous conditions in which a server notifies a client of a change.</span></span> <span data-ttu-id="02e18-106">Каждая [константа события](event-constants.md) , определенная корпорацией Майкрософт Active Accessibility, описывает условие, о котором уведомляется клиент.</span><span class="sxs-lookup"><span data-stu-id="02e18-106">Each [event constant](event-constants.md) defined by Microsoft Active Accessibility describes a condition about which a client is notified.</span></span> <span data-ttu-id="02e18-107">Например, Виневентс может дать сигнал:</span><span class="sxs-lookup"><span data-stu-id="02e18-107">For example, WinEvents can signal:</span></span>

- <span data-ttu-id="02e18-108">При создании или уничтожении объекта.</span><span class="sxs-lookup"><span data-stu-id="02e18-108">When an object is created or destroyed.</span></span>
- <span data-ttu-id="02e18-109">Когда объект получает или теряет фокус.</span><span class="sxs-lookup"><span data-stu-id="02e18-109">When an object receives or loses focus.</span></span>
- <span data-ttu-id="02e18-110">При изменении состояния или расположения объекта.</span><span class="sxs-lookup"><span data-stu-id="02e18-110">When the state or location of an object changes.</span></span>
- <span data-ttu-id="02e18-111">При изменении любого свойства объекта.</span><span class="sxs-lookup"><span data-stu-id="02e18-111">When any property of an object changes.</span></span>

<span data-ttu-id="02e18-112">Клиентские приложения не получают уведомления о событиях автоматически; они должны указывать, какие события они хотят получить, вызвав функцию [**сетвиневенсук**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) .</span><span class="sxs-lookup"><span data-stu-id="02e18-112">Client applications do not receive event notifications automatically; they must specify which events they want to receive by calling the [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) function.</span></span> <span data-ttu-id="02e18-113">При использовании **сетвиневенсук** клиент регистрируется для получения одного или нескольких событий и задает функцию-обработчик для обработки указанных событий.</span><span class="sxs-lookup"><span data-stu-id="02e18-113">With **SetWinEventHook**, a client registers to receive one or more events and sets a hook function to handle the specified events.</span></span> <span data-ttu-id="02e18-114">Клиенты могут использовать одну и ту же функцию-обработчик для обработки нескольких типов событий или могут использовать функции-обработчики несколько.</span><span class="sxs-lookup"><span data-stu-id="02e18-114">Clients can use the same hook function to handle multiple types of events, or it can use multipe hook functions.</span></span> <span data-ttu-id="02e18-115">Клиенты вызывают **сетвиневенсук** один раз для каждой функции-ловушки, которую необходимо зарегистрировать.</span><span class="sxs-lookup"><span data-stu-id="02e18-115">Clients call the **SetWinEventHook** once for each hook function it needs to register.</span></span>

<span data-ttu-id="02e18-116">Функции-ловушки находятся в теле кода клиента, в библиотеке DLL, сопоставленной с процессом клиента, или в библиотеке DLL, сопоставленной с процессом сервера.</span><span class="sxs-lookup"><span data-stu-id="02e18-116">Hook functions are located within the client's code body, in a DLL mapped into the client's process, or in a DLL mapped into the server's process.</span></span> <span data-ttu-id="02e18-117">Каждый из этих методов имеет свои преимущества и недостатки.</span><span class="sxs-lookup"><span data-stu-id="02e18-117">Each of these methods has advantages and disadvantages.</span></span> <span data-ttu-id="02e18-118">Дополнительные сведения см. [в разделе функции-обработчики в контексте и вне контекста](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="02e18-118">For more information, see [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="02e18-119">Чтобы уведомить клиентов о возникновении события, серверы вызывают [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span><span class="sxs-lookup"><span data-stu-id="02e18-119">To notify clients of an event occurrence, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span></span> <span data-ttu-id="02e18-120">Система проверяет, установлены ли в клиентских приложениях функции-обработчики для события, и при необходимости вызывает соответствующие функции-обработчики.</span><span class="sxs-lookup"><span data-stu-id="02e18-120">The system checks whether any client applications have set hook functions for the event and calls the appropriate hook functions as necessary.</span></span>

<span data-ttu-id="02e18-121">При вызове функции-ловушки клиента он получает ряд параметров, описывающих событие, и объект, создавший событие.</span><span class="sxs-lookup"><span data-stu-id="02e18-121">When the client's hook function is called, it receives a number of parameters that describe the event and the object that generated the event.</span></span> <span data-ttu-id="02e18-122">Чтобы получить доступ к объекту, создавшему событие, функция клиентского обработчика вызывает [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span><span class="sxs-lookup"><span data-stu-id="02e18-122">To gain access to the object that generated the event, the client hook function calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span></span>

> [!NOTE]
> <span data-ttu-id="02e18-123">Если ни один клиент не зарегистрировался для получения Виневентс, влияние на производительность сервера для вызова [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) незначительно.</span><span class="sxs-lookup"><span data-stu-id="02e18-123">If no clients have registered to receive WinEvents, the performance impact on a server for calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) is negligible.</span></span>
>
> <span data-ttu-id="02e18-124">Серверы вызывают [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) для изменений только в собственных доступных объектах; они не вызывают **нотифивиневент** для изменений в предоставляемых системой элементах пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="02e18-124">Servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) for changes only in their own accessible objects; they do not call **NotifyWinEvent** for changes in system-provided user interface elements.</span></span>

## <a name="event-driven-communication"></a><span data-ttu-id="02e18-125">Связь Event-Driven</span><span class="sxs-lookup"><span data-stu-id="02e18-125">Event-Driven Communication</span></span>

<span data-ttu-id="02e18-126">Клиенты должны зарегистрировать обработчик WinEvent, прежде чем они смогут получать уведомления WinEvent.</span><span class="sxs-lookup"><span data-stu-id="02e18-126">Clients must register a WinEvent hook before they can receive WinEvent notifications.</span></span> <span data-ttu-id="02e18-127">Чтобы избежать ненужных обратных вызовов и повысить производительность, клиентам рекомендуется регистрировать только те события, которые они должны получить.</span><span class="sxs-lookup"><span data-stu-id="02e18-127">To avoid unnecessary callbacks and improve performance, clients are advised to register only for the events they need to receive.</span></span>

<span data-ttu-id="02e18-128">Внутри процедуры-ловушки клиент может вызвать [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) , чтобы получить объект [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента, к которому применяется событие.</span><span class="sxs-lookup"><span data-stu-id="02e18-128">Inside the hook procedure, the client can call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for the element to which the event applies.</span></span> <span data-ttu-id="02e18-129">С помощью этого объекта клиент может начать вызывать методы **IAccessible** для получения сведений или взаимодействия с элементом пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="02e18-129">With this object, the client can begin calling **IAccessible** methods to retrieve information or interact with the UI element.</span></span>

## <a name="related-topics"></a><span data-ttu-id="02e18-130">См. также</span><span class="sxs-lookup"><span data-stu-id="02e18-130">Related topics</span></span>

[<span data-ttu-id="02e18-131">WinEvents</span><span class="sxs-lookup"><span data-stu-id="02e18-131">WinEvents</span></span>](winevents-infrastructure.md)
