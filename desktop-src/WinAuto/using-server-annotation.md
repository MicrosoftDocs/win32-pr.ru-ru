---
title: Использование заметок сервера
description: В этом разделе содержатся сведения об использовании заметок сервера для указания объекта обратного вызова.
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105691582"
---
# <a name="using-server-annotation"></a><span data-ttu-id="46c5f-103">Использование заметок сервера</span><span class="sxs-lookup"><span data-stu-id="46c5f-103">Using Server Annotation</span></span>

<span data-ttu-id="46c5f-104">В этом разделе содержатся сведения об использовании заметок сервера для указания объекта обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="46c5f-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="46c5f-105">**Переопределение свойства, определяющего объект обратного вызова**</span><span class="sxs-lookup"><span data-stu-id="46c5f-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="46c5f-106">Получите указатель на интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента, доступного для добавления в заметки.</span><span class="sxs-lookup"><span data-stu-id="46c5f-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="46c5f-107">Вызовите метод [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) для доступного элемента, чтобы получить указатель интерфейса [**иакЦидентити**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) .</span><span class="sxs-lookup"><span data-stu-id="46c5f-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="46c5f-108">Вызовите метод [**иакЦидентити:: жетидентитистринг ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) в указателе интерфейса [**иакЦидентити**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) , чтобы получить строку, которая однозначно определяет доступный элемент, для которого необходимо добавить заметки.</span><span class="sxs-lookup"><span data-stu-id="46c5f-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="46c5f-109">Для создания объекта [**иаккпропсервицес**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) используйте [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) или [**кокреатеинстанцеекс**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) .</span><span class="sxs-lookup"><span data-stu-id="46c5f-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="46c5f-110">Создайте объект модели COM, реализующий [**иаккпропсервер**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span><span class="sxs-lookup"><span data-stu-id="46c5f-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="46c5f-111">Вызовите [**иаккпропсервицес:: сетпропсервер**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), передав строку идентификатора, GUID, указывающий переопределяемое свойство, и указатель на объект обратного вызова [**иаккпропсервер**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) .</span><span class="sxs-lookup"><span data-stu-id="46c5f-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="46c5f-112">Освободить указатели интерфейса и свободную память.</span><span class="sxs-lookup"><span data-stu-id="46c5f-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="46c5f-113">Когда клиент запрашивает свойство доступного элемента, объект обратного вызова будет вызван и вернет значение клиенту.</span><span class="sxs-lookup"><span data-stu-id="46c5f-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="46c5f-114">Как и при указании значения, разработчики сервера могут также использовать метод [**иаккпропсервицес:: компосехвндидентитистринг**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) для получения строки идентификатора. также можно использовать метод [**иаккпропсервицес:: сесвндпропсервер**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) и указать параметры *HWND*, *идобжект* или *идчилд* вместо строки удостоверения.</span><span class="sxs-lookup"><span data-stu-id="46c5f-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="46c5f-115">При использовании [**сетпропсервер**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) или [**сесвндпропсервер**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) для объекта-контейнера разработчики сервера могут дополнительно указать, что переопределяемые сведения также должны применяться ко всем дочерним элементам этого контейнера.</span><span class="sxs-lookup"><span data-stu-id="46c5f-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="46c5f-116">Серверы могут явно очищать заметку в любое время с помощью [**иаккпропсервицес:: клеарпропс**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span><span class="sxs-lookup"><span data-stu-id="46c5f-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="46c5f-117">Обычно это не требуется, так как Служба заметок будет автоматически очищать и выпустить сведения о заметках, когда доступ к элементу с аннотацией исчезает.</span><span class="sxs-lookup"><span data-stu-id="46c5f-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="46c5f-118">Ниже приведен список свойств, которые можно закомментировать с помощью этой процедуры.</span><span class="sxs-lookup"><span data-stu-id="46c5f-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="46c5f-119">Свойства, поддерживаемые при указании обратного вызова</span><span class="sxs-lookup"><span data-stu-id="46c5f-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="46c5f-120">При указании обратного вызова можно добавлять заметки к следующим свойствам.</span><span class="sxs-lookup"><span data-stu-id="46c5f-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="46c5f-121">В настоящее время эти свойства нельзя напрямую закомментировать, указав значение.</span><span class="sxs-lookup"><span data-stu-id="46c5f-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="46c5f-122">Свойство</span><span class="sxs-lookup"><span data-stu-id="46c5f-122">Property</span></span>                      | <span data-ttu-id="46c5f-123">Тип</span><span class="sxs-lookup"><span data-stu-id="46c5f-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="46c5f-124">\_имя счетов \_ PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="46c5f-125">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-126">\_Описание счетов \_ PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="46c5f-127">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-128">\_роль PropID ACC \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="46c5f-129">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="46c5f-130">\_состояние счетов \_ PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="46c5f-131">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="46c5f-132">\_ \_ Справка по PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="46c5f-133">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-134">PROPID \_ ACC \_ кэйбоардшорткут</span><span class="sxs-lookup"><span data-stu-id="46c5f-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="46c5f-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-136">PROPID \_ ACC \_ DEFAULTACTION</span><span class="sxs-lookup"><span data-stu-id="46c5f-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="46c5f-137">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-138">PROPID \_ ACC — \_ VALUEMAP</span><span class="sxs-lookup"><span data-stu-id="46c5f-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="46c5f-139">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-140">PROPID \_ ACC \_ ролемап</span><span class="sxs-lookup"><span data-stu-id="46c5f-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="46c5f-141">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-142">PROPID \_ ACC \_ статемап</span><span class="sxs-lookup"><span data-stu-id="46c5f-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="46c5f-143">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="46c5f-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="46c5f-144">\_фокус на счет PropID \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="46c5f-145">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-146">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-147">\_Выбор счетов \_ PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="46c5f-148">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-149">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-149">VT\_I4</span></span><br/> <span data-ttu-id="46c5f-150">VT \_ Unknown</span><span class="sxs-lookup"><span data-stu-id="46c5f-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="46c5f-151">\_ \_ родительский счет PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="46c5f-152">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="46c5f-153">\_счет за \_ PropID \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="46c5f-154">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-155">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-156">\_счет по \_ PropID \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="46c5f-157">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-158">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-159">\_левый счет для \_ навигации \_ по PropID</span><span class="sxs-lookup"><span data-stu-id="46c5f-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="46c5f-160">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-161">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-162">\_правый счет \_ навигации по PropID \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="46c5f-163">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-164">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-165">Переход по \_ сумме PropID \_ \_ назад</span><span class="sxs-lookup"><span data-stu-id="46c5f-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="46c5f-166">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-167">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-168">\_ \_ Следующая навигационная панель \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="46c5f-169">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-170">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-171">\_FIRSTCHILD по сумме PropID \_ \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="46c5f-172">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-173">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="46c5f-174">\_LASTCHILD по сумме PropID \_ \_</span><span class="sxs-lookup"><span data-stu-id="46c5f-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="46c5f-175">\_Диспетчер VT</span><span class="sxs-lookup"><span data-stu-id="46c5f-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="46c5f-176">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="46c5f-176">VT\_I4</span></span><br/>                        |



 

 

