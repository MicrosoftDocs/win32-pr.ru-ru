---
title: Запрос виртуализированного элемента в представлении "элементы"
description: В этом разделе описывается использование службы автоматизации пользовательского интерфейса Майкрософт для получения сведений о пользовательском интерфейсе для виртуализированных элементов в представлении элементов Windows 7.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411290"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="0cd7a-103">Запрос виртуализированного элемента в представлении "элементы"</span><span class="sxs-lookup"><span data-stu-id="0cd7a-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="0cd7a-104">В этом разделе описывается использование службы автоматизации пользовательского интерфейса Майкрософт для получения сведений о пользовательском интерфейсе для виртуализированных элементов в представлении элементов Windows 7.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="0cd7a-105">Этот раздел включает следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="0cd7a-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="0cd7a-106">Этот раздел относится только к Windows 7.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="0cd7a-107">Имейте в виду, что функции специальных возможностей, описанные в этом разделе, могут измениться в будущих версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="0cd7a-108">Обзор</span><span class="sxs-lookup"><span data-stu-id="0cd7a-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="0cd7a-109">Древовидная структура представления элементов</span><span class="sxs-lookup"><span data-stu-id="0cd7a-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="0cd7a-110">Виртуализация</span><span class="sxs-lookup"><span data-stu-id="0cd7a-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="0cd7a-111">Получение количества всех элементов</span><span class="sxs-lookup"><span data-stu-id="0cd7a-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="0cd7a-112">Получение индекса элемента по отношению ко всем элементам</span><span class="sxs-lookup"><span data-stu-id="0cd7a-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="0cd7a-113">Получение ссылки на элемент Витуализед</span><span class="sxs-lookup"><span data-stu-id="0cd7a-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="0cd7a-114">Прокрутка виртуализированного элемента на экране</span><span class="sxs-lookup"><span data-stu-id="0cd7a-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="0cd7a-115">См. также</span><span class="sxs-lookup"><span data-stu-id="0cd7a-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="0cd7a-116">Обзор</span><span class="sxs-lookup"><span data-stu-id="0cd7a-116">Overview</span></span>

<span data-ttu-id="0cd7a-117">Представление "элементы" — это компонент пользовательского интерфейса, который позволяет пользователям просматривать файлы и другие элементы и взаимодействовать с ними.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="0cd7a-118">В Windows 7 представление "элементы" заменяет элемент управления "представление списка" для представления элементов в представлении проводника по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="0cd7a-119">Представление "элементы" также используется в диалоговом окне общих элементов, в результатах поиска в меню "Пуск" и в других элементах пользовательского интерфейса Windows 7, использующих элемент управления браузера обозревателя.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="0cd7a-120">По сравнению с элементом управления "представление списка", для пользователей доступны следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="0cd7a-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="0cd7a-121">Представление элементов может представлять элементы более полезными, желательными и релевантными, позволяя пользователям быстрее находить и упорядочивать элементы.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="0cd7a-122">В представлении "элементы" можно отображать большие наборы элементов из источников данных с разными характеристиками производительности, что позволяет пользователям просматривать всю коллекцию элементов в нескольких источниках и выполнять поиск по ним.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="0cd7a-123">На следующем рисунке показано представление элементы в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-123">The following image shows the Items View in Windows Explorer.</span></span>

![снимок экрана, отображающий проводник Windows с компонентом "Просмотр элементов"](images/itemsview.gif)

<span data-ttu-id="0cd7a-125">С точки зрения разработчика общая структура и функциональные возможности представления «элементы» аналогичны элементам управления «список».</span><span class="sxs-lookup"><span data-stu-id="0cd7a-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="0cd7a-126">Основное отличие заключается в том, что представление элементов поддерживает виртуализацию, а элемент управления "представление списка" — нет.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="0cd7a-127">Кроме того, в представлении "элементы" используются два новых интерфейса автоматизации пользовательского интерфейса для обеспечения доступности виртуализированного содержимого, предоставленного представлением элементов.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="0cd7a-128">Эти интерфейсы описаны в следующих разделах этой статьи.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="0cd7a-129">Общие сведения о виртуализации в модели автоматизации пользовательского интерфейса см. [в разделе Работа с виртуализированными элементами](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="0cd7a-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="0cd7a-130">Древовидная структура представления элементов</span><span class="sxs-lookup"><span data-stu-id="0cd7a-130">Items View Tree Structure</span></span>

<span data-ttu-id="0cd7a-131">В дереве модели автоматизации пользовательского интерфейса элемент автоматизации пользовательского интерфейса верхнего уровня представления Items имеет имя "Итемсвиев" и тип элемента управления "List".</span><span class="sxs-lookup"><span data-stu-id="0cd7a-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="0cd7a-132">На предыдущем рисунке элемент модели автоматизации пользовательского интерфейса Итемсвиев выделено красным цветом.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="0cd7a-133">Ниже верхнего уровня Итемсвиев существуют различные элементы автоматизации пользовательского интерфейса, но в этом документе упоминается только два других элемента автоматизации пользовательского интерфейса: элементы группы и элементы списка.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="0cd7a-134">Элементы группы — это элементы модели автоматизации пользовательского интерфейса, которые содержат все элементы группы. их тип элемента управления — Group, и их имена зависят от имени группы.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="0cd7a-135">На предыдущем рисунке первый элемент группы содержит заголовок "A-H (1)" и элемент списка "папка", а его имя — "A-H".</span><span class="sxs-lookup"><span data-stu-id="0cd7a-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="0cd7a-136">Элементы списка являются элементами модели автоматизации пользовательского интерфейса, представляющими конечные элементы в представлении. их тип элемента управления — "ListItem", а их имена различаются в зависимости от имени элемента.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="0cd7a-137">На предыдущем рисунке элементы списка являются конечными элементами, такими как "папка", "Музыка" и "Рисунок".</span><span class="sxs-lookup"><span data-stu-id="0cd7a-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="0cd7a-138">Эти три элемента модели автоматизации пользовательского интерфейса называются элементом Итемсвиев, элементом Group и элементом ListItem в оставшейся части этого документа.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="0cd7a-139">Виртуализация</span><span class="sxs-lookup"><span data-stu-id="0cd7a-139">Virtualization</span></span>

<span data-ttu-id="0cd7a-140">В представлении "элементы" используется виртуализация, что означает, что элементы за пределами видимой области представления не извлекаться из системы, а представление пользовательского интерфейса не создается.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="0cd7a-141">Эти элементы называются *виртуализированными элементами*.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="0cd7a-142">Поскольку они не создаются, виртуализированные элементы не имеют элементов автоматизации пользовательского интерфейса и поэтому не отображаются в дереве модели автоматизации ПОЛЬЗОВАТЕЛЬСКОГО интерфейса, когда клиент автоматизации пользовательского интерфейса перечисляет дерево.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="0cd7a-143">Кроме того, шаблоны элементов управления модели автоматизации пользовательского интерфейса работают только с видимыми элементами.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="0cd7a-144">Например, шаблон элемента управления [Selection](uiauto-implementingselection.md) возвращает только видимые выбранные элементы, когда клиент вызывает метод [**Иуиаутоматионселектионпаттерн:: жеткуррентселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="0cd7a-145">Представление "элементы" поддерживает возможность получения следующих сведений о виртуализированных элементах:</span><span class="sxs-lookup"><span data-stu-id="0cd7a-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="0cd7a-146">Общее число элементов, включая виртуализированные элементы.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="0cd7a-147">Элементы модели автоматизации пользовательского интерфейса для виртуализированных элементов</span><span class="sxs-lookup"><span data-stu-id="0cd7a-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="0cd7a-148">Элементы модели автоматизации пользовательского интерфейса для выбранных виртуализированных элементов</span><span class="sxs-lookup"><span data-stu-id="0cd7a-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="0cd7a-149">Получение количества всех элементов</span><span class="sxs-lookup"><span data-stu-id="0cd7a-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="0cd7a-150">Клиент может использовать элемент Итемсвиев, чтобы получить количество всех элементов, а также количество выбранных элементов.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="0cd7a-151">Элемент Итемсвиев предоставляет два способа получения этих счетчиков.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="0cd7a-152">Первый заключается в получении свойства Итемстатус элемента Итемсвиев, а второй — при получении пользовательских свойств из элемента Итемсвиев.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="0cd7a-153">Свойство Итемстатус — это строка, указывающая количество общего числа элементов и число выбранных элементов, разделенных запятыми.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="0cd7a-154">Например: "3 элемента, выбран 1 элемент".</span><span class="sxs-lookup"><span data-stu-id="0cd7a-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="0cd7a-155">Эта строка локализована и может быть передана непосредственно пользователю.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="0cd7a-156">Пользовательские свойства элемента Итемсвиев включают одно свойство для счетчика элементов, а другое — для счетчика выбора.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="0cd7a-157">К ним относятся следующие:</span><span class="sxs-lookup"><span data-stu-id="0cd7a-157">They include:</span></span>

-   <span data-ttu-id="0cd7a-158">\_GUID свойства ItemCount \_ (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162) — количество всех уникальных элементов в представлении.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="0cd7a-159">При группировании по многозначному свойству (MVP), чтобы один элемент мог встречаться несколько раз, каждый элемент учитывается только один раз.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="0cd7a-160">(Уиаутоматионтипе: [**уиаутоматионтипе \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), программное имя: "ItemCount")</span><span class="sxs-lookup"><span data-stu-id="0cd7a-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="0cd7a-161">\_GUID свойства селектедитемкаунт \_ (92A053DA-2969-4021-BF27-514CFC2E4A69) — количество всех уникальных элементов, выбранных в представлении.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="0cd7a-162">При группировании по многозначному свойству (MVP), чтобы один элемент мог встречаться несколько раз, каждый элемент учитывается только один раз.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="0cd7a-163">(Уиаутоматионтипе: [**уиаутоматионтипе \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), программное имя: "селектедитемкаунт")</span><span class="sxs-lookup"><span data-stu-id="0cd7a-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="0cd7a-164">Эти пользовательские свойства определяются в Шлгуид. h, который входит в состав пакета средств разработки программного обеспечения (SDK) для Windows, и эти свойства регистрируются с помощью метода [**иуиаутоматионрегистрар:: регистерпроперти**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="0cd7a-165">Клиенты автоматизации пользовательского интерфейса используют **регистерпроперти** для получения идентификаторов свойств (пропертидс) для пользовательских свойств.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="0cd7a-166">Получение индекса элемента по отношению ко всем элементам</span><span class="sxs-lookup"><span data-stu-id="0cd7a-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="0cd7a-167">Клиент может получить индекс элемента либо путем получения свойства Итемстатус элемента ListItem, либо путем получения пользовательского свойства элемента ListItem.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="0cd7a-168">Свойство Итемстатус — это строка, содержащая индекс элемента по отношению к общему количеству элементов.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="0cd7a-169">Например: "элемент 1 из 3".</span><span class="sxs-lookup"><span data-stu-id="0cd7a-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="0cd7a-170">Эта строка локализована и может быть передана непосредственно пользователю.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="0cd7a-171">Следующее пользовательское свойство получает индекс элемента элемента ListItem:</span><span class="sxs-lookup"><span data-stu-id="0cd7a-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="0cd7a-172">\_GUID свойства итеминдекс \_ (92A053DA-2969-4021-BF27-514CFC2E4A69) — абсолютный индекс элемента, основанный на 1.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="0cd7a-173">При группировании по многозначному свойству (MVP), чтобы один элемент мог появиться дважды, каждый вид элемента получает отдельный индекс.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="0cd7a-174">(Уиаутоматионтипе: [**уиаутоматионтипе \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), программное имя: "итеминдекс")</span><span class="sxs-lookup"><span data-stu-id="0cd7a-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="0cd7a-175">Это пользовательское свойство определено в Шлгуид. h, которое включено в Windows SDK и регистрируется с помощью метода [**иуиаутоматионрегистрар:: регистерпроперти**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="0cd7a-176">Клиенты автоматизации пользовательского интерфейса используют **регистерпроперти** для получения идентификатора свойства (пропертидс) для настраиваемого свойства.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="0cd7a-177">Получение ссылки на элемент Витуализед</span><span class="sxs-lookup"><span data-stu-id="0cd7a-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="0cd7a-178">Элемент Итемсвиев реализует шаблон элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) (интерфейс [**иитемконтаинерпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) ), который позволяет клиенту получить элемент модели автоматизации пользовательского интерфейса для виртуализированного элемента (элемента, находящегося за пределами видимой области).</span><span class="sxs-lookup"><span data-stu-id="0cd7a-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="0cd7a-179">Итемсвиев позволяет клиенту найти элемент ListItem, выполнив поиск по имени и свойствам выбора. попытка поиска по любому другому свойству завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="0cd7a-180">Виртуальный элемент реализует только шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) (интерфейс [**ивиртуализедитемпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) ).</span><span class="sxs-lookup"><span data-stu-id="0cd7a-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="0cd7a-181">Поскольку элемент, представленный виртуализированным элементом автоматизации пользовательского интерфейса, еще не существует, попытка получить любой другой шаблон элемента управления или свойство элемента завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="0cd7a-182">Элементы ListItem и Group виртуализированы, но только элементы ListItem могут возвращаться из шаблона элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="0cd7a-183">Поскольку вызов метода [**иуиаутоматионитемконтаинерпаттерн:: финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) выполняется в ПОТОКЕ пользовательского интерфейса и блокируется, представление не будет отвечать, пока **финдитембипроперти** не вернет, а все другие вызовы метода в поставщике должны дождаться завершения **финдитембипроперти** .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="0cd7a-184">В некоторых случаях **финдитембипроперти** должен обработать весь набор данных перед возвратом, что может потребовать много ресурсов.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="0cd7a-185">Указание **значения NULL** в качестве начального элемента приводит к тому, что **финдитембипроперти** начинает поиск с первого элемента в представлении.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="0cd7a-186">Итемсвиев поддерживает следующие свойства для [**финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span><span class="sxs-lookup"><span data-stu-id="0cd7a-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="0cd7a-187">Name (UIA \_ намепропертид) — поиск первого элемента, имя которого полностью совпадает с указанной строкой.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="0cd7a-188">Поиск не учитывает регистр символов.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-188">The search is not case sensitive.</span></span> <span data-ttu-id="0cd7a-189">Подстановочные знаки или частичное совпадение не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="0cd7a-190">Если указано имя **null** , возвращается следующий элемент после начального элемента.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="0cd7a-191">Указание имен **null** позволяет клиенту автоматизации пользовательского интерфейса перечислять все элементы в представлении; Однако не рекомендуется перечислить все элементы, так как это приводит к реализации всех элементов в представлении.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="0cd7a-192">SelectionItem \_ (UIA \_ селектионитемисселектедпропертид) — ищет первый элемент, свойство SelectionItem которого \_ соответствует указанному значению.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="0cd7a-193">Укажите **значение true** , чтобы найти первый выбранный элемент, или **false** , чтобы найти первый невыбранный элемент.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="0cd7a-194">Будьте внимательны при перечислении всех выбранных элементов, так как количество выбранных элементов может быть очень большим, особенно если пользователь выбрал все элементы.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="0cd7a-195">Прокрутка виртуализированного элемента на экране</span><span class="sxs-lookup"><span data-stu-id="0cd7a-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="0cd7a-196">После получения ссылки на элемент модели автоматизации пользовательского интерфейса для виртуализированного (экранного) элемента клиент может прокручивать элемент в представление с помощью метода [**иуиаутоматионвиртуализеитемпаттерн:: реализовать**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) шаблона элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="0cd7a-197">После реализации элемента он становится видимым, и все свойства и шаблоны элементов управления, обычно связанные с элементом ListItem, доступны клиенту.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="0cd7a-198">Только элементы ListItem, полученные методом [**иуиаутоматионитемконтаинерпаттерн:: финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) , предоставляют шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="0cd7a-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="0cd7a-199">Когда экранный элемент прокручивается за пределы экрана, элемент становится недопустимым и клиент должен вызвать **финдитембипроперти** , чтобы получить ссылку на экран.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="0cd7a-200">Также можно перемещать элементы в или из представления с помощью шаблона элемента управления [Scroll](uiauto-implementingscroll.md) (или с помощью полос прокрутки).</span><span class="sxs-lookup"><span data-stu-id="0cd7a-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="0cd7a-201">Элементы и группы реализуются по мере того, как они прокручиваются в представление, и виртуализованы по мере прокрутки представления.</span><span class="sxs-lookup"><span data-stu-id="0cd7a-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0cd7a-202">См. также</span><span class="sxs-lookup"><span data-stu-id="0cd7a-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0cd7a-203">Работа с виртуализированными элементами</span><span class="sxs-lookup"><span data-stu-id="0cd7a-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




