---
title: Использование текстовых диапазонов
description: В этом разделе описывается использование свойств и методов интерфейса Иуиаутоматионтекстранже для доступа к текстовому содержимому элемента управления на основе текста и управления им.
ms.assetid: 66BC7324-5322-4996-AF62-766936559F0E
keywords:
- Клиенты, использование объектов текстового диапазона
- текстовые элементы управления
- Клиенты, текстовые диапазоны
- Клиенты, шаблон элемента управления TextRange
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6a2aef7c23db6903e3492fec7c83ba7c14599c63
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413207"
---
# <a name="using-text-ranges"></a><span data-ttu-id="03938-107">Использование текстовых диапазонов</span><span class="sxs-lookup"><span data-stu-id="03938-107">Using Text Ranges</span></span>

<span data-ttu-id="03938-108">В этом разделе описывается использование свойств и методов интерфейса [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) для доступа к текстовому содержимому элемента управления на основе текста и управления им.</span><span class="sxs-lookup"><span data-stu-id="03938-108">This topic describes how to use the properties and methods of the [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface to access and manipulate the textual content of a text-based control.</span></span> <span data-ttu-id="03938-109">Он содержит следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="03938-109">It contains the following sections:</span></span>

-   [<span data-ttu-id="03938-110">Что такое текстовый диапазон?</span><span class="sxs-lookup"><span data-stu-id="03938-110">What is a Text Range?</span></span>](#using-text-ranges)
-   [<span data-ttu-id="03938-111">Получение объектов текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-111">Acquiring Text Range Objects</span></span>](#acquiring-text-range-objects)
-   [<span data-ttu-id="03938-112">Выбор текста в текстовом диапазоне</span><span class="sxs-lookup"><span data-stu-id="03938-112">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
-   [<span data-ttu-id="03938-113">Извлечение текста из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-113">Retrieving Text from a Text Range</span></span>](#retrieving-text-from-a-text-range)
-   [<span data-ttu-id="03938-114">Получение текстовых атрибутов из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-114">Retrieving Text Attributes from a Text Range</span></span>](#retrieving-text-attributes-from-a-text-range)
-   [<span data-ttu-id="03938-115">Получение внедренных объектов из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-115">Retrieving Embedded Objects from a Text Range</span></span>](#retrieving-embedded-objects-from-a-text-range)
-   [<span data-ttu-id="03938-116">Управление диапазоном текста</span><span class="sxs-lookup"><span data-stu-id="03938-116">Manipulating a Text Range</span></span>](#manipulating-a-text-range)
-   [<span data-ttu-id="03938-117">Прокрутка текстового диапазона в представление</span><span class="sxs-lookup"><span data-stu-id="03938-117">Scrolling a Text Range into View</span></span>](#scrolling-a-text-range-into-view)
-   [<span data-ttu-id="03938-118">Извлечение включающего элемента текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-118">Retrieving the Enclosing Element of a Text Range</span></span>](#retrieving-the-enclosing-element-of-a-text-range)
-   [<span data-ttu-id="03938-119">Сравнение и клонирование диапазонов текста</span><span class="sxs-lookup"><span data-stu-id="03938-119">Comparing and Cloning Text Ranges</span></span>](#comparing-and-cloning-text-ranges)
-   [<span data-ttu-id="03938-120">Получение заметок</span><span class="sxs-lookup"><span data-stu-id="03938-120">Retrieving Annotations</span></span>](#retrieving-annotations)
    -   [<span data-ttu-id="03938-121">Получение типов заметок из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-121">Retrieving Annotations Types from a Text Range</span></span>](#retrieving-annotations-types-from-a-text-range)
    -   [<span data-ttu-id="03938-122">Извлечение всех заметок из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-122">Retrieving All Annotations from a Text Range</span></span>](#retrieving-all-annotations-from-a-text-range)
    -   [<span data-ttu-id="03938-123">Получение сведений о конкретной заметке</span><span class="sxs-lookup"><span data-stu-id="03938-123">Retrieving Information About a Particular Annotation</span></span>](#retrieving-information-about-a-particular-annotation)
    -   [<span data-ttu-id="03938-124">Извлечение целевого текста заметки</span><span class="sxs-lookup"><span data-stu-id="03938-124">Retrieving the Annotation Target Text</span></span>](#retrieving-the-annotation-target-text)
-   [<span data-ttu-id="03938-125">Получение визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="03938-125">Retrieving Visual Styles</span></span>](#retrieving-visual-styles)
-   [<span data-ttu-id="03938-126">Вызов контекстных меню из текстовых диапазонов</span><span class="sxs-lookup"><span data-stu-id="03938-126">Invoking Context Menus From Text Ranges</span></span>](#invoking-context-menus-from-text-ranges)
-   [<span data-ttu-id="03938-127">См. также</span><span class="sxs-lookup"><span data-stu-id="03938-127">Related topics</span></span>](#related-topics)

## <a name="what-is-a-text-range"></a><span data-ttu-id="03938-128">Что такое текстовый диапазон?</span><span class="sxs-lookup"><span data-stu-id="03938-128">What is a Text Range?</span></span>

<span data-ttu-id="03938-129">Объектная модель текста Microsoft UI Automation основана на концепции *текстового диапазона*.</span><span class="sxs-lookup"><span data-stu-id="03938-129">The Microsoft UI Automation text object model is based on the concept of the *text range*.</span></span> <span data-ttu-id="03938-130">Текстовый диапазон — это объект, предоставляющий интерфейс [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) , который представляет непрерывный участок текста в элементе управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="03938-130">A text range is an object that exposes the [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface, and represents a contiguous span of text in a text-based control.</span></span> <span data-ttu-id="03938-131">Каждый текстовый диапазон имеет как начальную, так и конечную конечную точку, и все текстовое содержимое между двумя конечными точками считается частью диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-131">Each text range has both a starting endpoint and an ending endpoint, and all textual content between the two endpoints is considered part of the range.</span></span> <span data-ttu-id="03938-132">Текстовый диапазон, начальная конечная точка и конечная точка которого находятся в одном расположении, называется *вырожденным* (или пустым) текстовым диапазоном.</span><span class="sxs-lookup"><span data-stu-id="03938-132">A text range whose starting endpoint and ending endpoint are at the same location is called a *degenerate* (or empty) text range.</span></span> <span data-ttu-id="03938-133">Вырожденный диапазон текста используется для пометки определенного расположения внутри текста элемента управления, например расположения точки вставки текста.</span><span class="sxs-lookup"><span data-stu-id="03938-133">A degenerate text range is used to mark a specific location within the text of a control, such as the location of the text insertion point.</span></span>

## <a name="acquiring-text-range-objects"></a><span data-ttu-id="03938-134">Получение объектов текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-134">Acquiring Text Range Objects</span></span>

<span data-ttu-id="03938-135">Клиентские приложения получают объекты текстового диапазона с помощью свойств и методов интерфейса [**иуиаутоматионтекстпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) .</span><span class="sxs-lookup"><span data-stu-id="03938-135">Client applications acquire text range objects by using the properties and methods of the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) interface.</span></span> <span data-ttu-id="03938-136">Свойство [**иуиаутоматионтекстранжепаттерн::D окументранже**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_documentrange) Извлекает текстовый диапазон, представляющий все текстовое содержимое элемента управления на основе текста, а другие методы получают текстовые диапазоны, представляющие некоторую часть содержимого, например выделенный текст, видимый текст или объект, внедренный в текст.</span><span class="sxs-lookup"><span data-stu-id="03938-136">The [**IUIAutomationTextRangePattern::DocumentRange**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_documentrange) property retrieves a text range that represents the entire textual content of a text-based control, while other methods acquire text ranges that represent some portion of the content, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="03938-137">Методы [**иуиаутоматионтекстранжепаттерн:: жетвисиблеранжес**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getvisibleranges) и методического [**выбора**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getselection) могут извлекать массивы объектов текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-137">The [**IUIAutomationTextRangePattern::GetVisibleRanges**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getvisibleranges) and [**GetSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getselection) methods can retrieve arrays of text range objects.</span></span> <span data-ttu-id="03938-138">Если элемент управления частично скрывается перекрытием окна или другого объекта, **жетвисиблеранжес** возвращает массив, содержащий объект текстового диапазона для каждой частично видимой строки текста.</span><span class="sxs-lookup"><span data-stu-id="03938-138">If a control is partially obscured by an overlapping window or other object, **GetVisibleRanges** returns an array containing a text range object for each partially visible line of text.</span></span> <span data-ttu-id="03938-139">Аналогично, если текстовый элемент управления поддерживает выбор нескольких необъединяемых диапазонов текста, метод **GetObject возвращает массив, содержащий** объект текстового диапазона для каждого выбранного диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-139">Similarly, if a text-based control supports the selection of multiple, disjoint spans of text, **GetSelection** returns an array that contains a text range object for each selected span.</span></span>

<span data-ttu-id="03938-140">Метод [**иуиаутоматионтекстранжепаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) позволяет клиентскому приложению получить текстовый диапазон, охватывающий объект, внедренный в текстовое содержимое.</span><span class="sxs-lookup"><span data-stu-id="03938-140">The [**IUIAutomationTextRangePattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) method enables a client application to retrieve a text range that encloses an object that is embedded in the textual content.</span></span> <span data-ttu-id="03938-141">Клиент указывает указатель интерфейса [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) внедренного объекта, например изображение, таблицу или гиперссылку, а метод возвращает текстовый диапазон, охватывающий объект.</span><span class="sxs-lookup"><span data-stu-id="03938-141">The client specifies the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer of an embedded object, such as an image, a table, or a hyperlink, and the method returns a text range that encloses the object.</span></span> <span data-ttu-id="03938-142">Однако если с внедренным объектом не связан никакой текст, метод возвращает вырожденный текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="03938-142">However, if the embedded object has no text associated with it, the method returns a degenerate text range.</span></span>

<span data-ttu-id="03938-143">Клиентское приложение может использовать метод [**иуиаутоматионтекстранжепаттерн:: ранжефромпоинт**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) для получения текстового диапазона для видимого текста или внедренного объекта, ближайшего к заданным координатам экрана.</span><span class="sxs-lookup"><span data-stu-id="03938-143">A client application can use the [**IUIAutomationTextRangePattern::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method to retrieve a text range for the visible text or embedded object that is nearest to the specified screen coordinates.</span></span>

## <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="03938-144">Выбор текста в текстовом диапазоне</span><span class="sxs-lookup"><span data-stu-id="03938-144">Selecting Text in a Text Range</span></span>

<span data-ttu-id="03938-145">Интерфейс [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) включает ряд методов, позволяющих клиентскому приложению управлять выбором текста в элементе управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="03938-145">The [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface includes a number of methods that enable a client application to control the selection of text in a text-based control.</span></span>

<span data-ttu-id="03938-146">Клиентские приложения могут использовать метод [**иуиаутоматионтекстранже:: SELECT**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-select) , чтобы выбрать текст, соответствующий диапазону текста, и удалить предыдущее выделение (при наличии) из элемента управления "текст".</span><span class="sxs-lookup"><span data-stu-id="03938-146">Client applications can use the [**IUIAutomationTextRange::Select**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-select) method to select the text that corresponds to a text range, and to remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="03938-147">При вызове **SELECT** с разрожденным текстовым диапазоном точка вставки перемещается в расположение текстового диапазона без выбора текста.</span><span class="sxs-lookup"><span data-stu-id="03938-147">Calling **Select** with a degenerate text range moves the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="03938-148">Если элемент управления поддерживает выделение нескольких необъединяемых диапазонов текста, клиент может использовать методы [**иуиаутоматионтекстранже:: аддтоселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) и [**ремовефромселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) для добавления диапазонов текста в и удаления из коллекции выбранных текстовых диапазонов.</span><span class="sxs-lookup"><span data-stu-id="03938-148">If a control supports the selection of multiple, disjoint spans of text, a client can use the [**IUIAutomationTextRange::AddToSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) methods to add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="03938-149">Если элемент управления поддерживает только один выделенный текстовый диапазон за раз, но операция выбора приведет к выбору нескольких необъединяемых текстовых диапазонов, метод возвращает либо ошибку **E \_ INVALIDOPERATION** , либо расширяет или усекает текущий выделенный фрагмент.</span><span class="sxs-lookup"><span data-stu-id="03938-149">If the control supports only one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the method returns either an **E\_INVALIDOPERATION** error, or extends or truncates the current selection.</span></span> <span data-ttu-id="03938-150">Клиентское приложение может определить, поддерживает ли элемент управления выбор одного или нескольких фрагментов текста, или вообще ничего, путем проверки свойства [**иуиаутоматионтекстпаттерн:: суппортедтекстселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="03938-150">A client application can discover whether a control supports the selection of single or multiple spans of text, or none at all, by checking the [**IUIAutomationTextPattern::SupportedTextSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_supportedtextselection) property.</span></span>

<span data-ttu-id="03938-151">Если текстовый элемент управления поддерживает вставку текста, вызов [**иуиаутоматионтекстранже:: аддтоселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) или [**ремовефромселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) в диапазоне вырожденного текста в элементе управления перемещает точку вставки, но не выделяет текст.</span><span class="sxs-lookup"><span data-stu-id="03938-151">If a text-based control supports text insertions, calling [**IUIAutomationTextRange::AddToSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) on a degenerate text range in the control moves the insertion point but does not select any text.</span></span>

## <a name="retrieving-text-from-a-text-range"></a><span data-ttu-id="03938-152">Извлечение текста из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-152">Retrieving Text from a Text Range</span></span>

<span data-ttu-id="03938-153">Клиентские приложения могут использовать метод [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) для получения обычного текста текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-153">Client applications can use the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method to retrieve the plain text of a text range.</span></span> <span data-ttu-id="03938-154">Обычный текст включает все управляющие символы, найденные в исходном тексте, такие как возврат каретки и знак Юникода слева направо (ЛРМ).</span><span class="sxs-lookup"><span data-stu-id="03938-154">The plain text includes all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="03938-155">Обычный текст не включает теги разметки, такие как HTML, которые могут присутствовать в исходном тексте.</span><span class="sxs-lookup"><span data-stu-id="03938-155">The plain text does not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="03938-156">Кроме того, все Escape-коды в исходном тексте преобразуются в эквиваленты обычного текста.</span><span class="sxs-lookup"><span data-stu-id="03938-156">Also, any escape codes in the source text are converted to the plain text equivalents.</span></span> <span data-ttu-id="03938-157">Например, " &nbsp; " преобразуется в простой символ пробела.</span><span class="sxs-lookup"><span data-stu-id="03938-157">For example, "&nbsp;" is converted to a simple space character.</span></span>

<span data-ttu-id="03938-158">Если внедренный объект охватывает диапазон текста, обычный текст включает в себя внутренний текст объекта, но не дополнительный текст (свойство Name внедренного объекта).</span><span class="sxs-lookup"><span data-stu-id="03938-158">If an embedded object spans a range of text, the plain text includes the inner text of the object, but not the alternative text (the name property of the embedded object).</span></span> <span data-ttu-id="03938-159">Дополнительные сведения см. в статье [как модель автоматизации пользовательского интерфейса предоставляет внедренные объекты](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="03938-159">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

<span data-ttu-id="03938-160">Метод [**иуиаутоматионтекстранже:: строки FindText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findtext) ищет в текстовом диапазоне определенную строку и, если она найдена, возвращает новый текстовый диапазон, охватывающий строку.</span><span class="sxs-lookup"><span data-stu-id="03938-160">The [**IUIAutomationTextRange::FindText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findtext) method searches a text range for a particular string and, if it is found, returns a new text range that encompasses the string.</span></span>

## <a name="retrieving-text-attributes-from-a-text-range"></a><span data-ttu-id="03938-161">Получение текстовых атрибутов из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-161">Retrieving Text Attributes from a Text Range</span></span>

<span data-ttu-id="03938-162">Текстовые атрибуты определяют стиль форматирования текста в элементе управления на основе текста и включают такие элементы, как цвет переднего плана, стиль маркера, размер шрифта и т. д.</span><span class="sxs-lookup"><span data-stu-id="03938-162">Text attributes determine the formatting style of the text in a text-based control, and include such things as foreground color, bullet style, font size, and so on.</span></span> <span data-ttu-id="03938-163">Модель автоматизации пользовательского интерфейса поддерживает ряд атрибутов текста и определяет идентификатор для каждого поддерживаемого атрибута.</span><span class="sxs-lookup"><span data-stu-id="03938-163">UI Automation supports a number of text attributes, and defines an identifier for each supported attribute.</span></span> <span data-ttu-id="03938-164">Клиентское приложение может запросить значение определенного текстового атрибута в текстовом диапазоне, указав идентификатор атрибута в вызове метода [**иуиаутоматионтекстранже:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) вместе с указателем на структуру [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , которая получает значение атрибута.</span><span class="sxs-lookup"><span data-stu-id="03938-164">A client application can query a text range for the value of a particular text attribute by specifying an attribute identifier in a call to the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method, along with a pointer to a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) structure that receives the attribute value.</span></span> <span data-ttu-id="03938-165">Подробные сведения о каждом атрибуте Text, поддерживаемом в модели автоматизации пользовательского интерфейса, см. в разделе [идентификаторы текстовых атрибутов](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="03938-165">For detailed information about each text attribute that UI Automation supports, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

<span data-ttu-id="03938-166">Значение, полученное [**GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) , представляет значение атрибута во всем текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="03938-166">The value retrieved by [**GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) represents the value of the attribute across the entire text range.</span></span> <span data-ttu-id="03938-167">Если весь текст в диапазоне использует одно и то же значение для указанного атрибута, это значение возвращается функцией **GetAttributeValue**.</span><span class="sxs-lookup"><span data-stu-id="03938-167">If all text in the range shares the same value for the specified attribute, that value is returned by **GetAttributeValue**.</span></span> <span data-ttu-id="03938-168">Однако если значение атрибута изменяется в пределах текстового диапазона, **GetAttributeValue** возвращает указатель [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) на объект статического маркера, именуемый объектом **ресерведмикседаттрибуте** .</span><span class="sxs-lookup"><span data-stu-id="03938-168">However, if the value of the attribute varies across the text range, **GetAttributeValue** returns an [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) pointer to a static token object called the **ReservedMixedAttribute** object.</span></span> <span data-ttu-id="03938-169">Чтобы определить, изменяется ли значение атрибута в пределах текстового диапазона, клиентское приложение должно сравнить результаты **GetAttributeValue** с объектом **ресерведмикседаттрибуте** , полученным из свойства [**иуиаутоматион:: ресерведмикседаттрибутевалуе**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservedmixedattributevalue) .</span><span class="sxs-lookup"><span data-stu-id="03938-169">To discover whether the value of an attribute varies across a text range, a client application should compare the results of **GetAttributeValue** with the **ReservedMixedAttribute** object retrieved from the [**IUIAutomation::ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservedmixedattributevalue) property.</span></span>

<span data-ttu-id="03938-170">Элемент управления на основе текста не требуется для поддержки всех атрибутов текста модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="03938-170">A text-based control is not required to support all UI Automation text attributes.</span></span> <span data-ttu-id="03938-171">Если клиент вызывает метод [**иуиаутоматионтекстранже:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) и передает идентификатор неподдерживаемого атрибута, метод возвращает указатель [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) на статический объект маркера, именуемый объектом **ресерведнотсуппортед** .</span><span class="sxs-lookup"><span data-stu-id="03938-171">If a client calls the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method and passes the identifier of an unsupported attribute, the method returns an [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) pointer to a static token object called the **ReservedNotSupported** object.</span></span> <span data-ttu-id="03938-172">Чтобы определить, поддерживается ли определенный атрибут, клиентское приложение должно сравнить результаты **GetAttributeValue** с объектом **ресерведнотсуппортед** , полученным из свойства [**иуиаутоматион:: ресерведнотсуппортедвалуе**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservednotsupportedvalue) .</span><span class="sxs-lookup"><span data-stu-id="03938-172">To discover whether a particular attribute is supported, a client application should compare the results of **GetAttributeValue** with the **ReservedNotSupported** object retrieved from the [**IUIAutomation::ReservedNotSupportedValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservednotsupportedvalue) property.</span></span>

<span data-ttu-id="03938-173">Клиентские приложения могут использовать метод [**иуиаутоматионтекстранже:: финдаттрибуте**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findattribute) для поиска текста в текстовом диапазоне с определенным атрибутом текста.</span><span class="sxs-lookup"><span data-stu-id="03938-173">Client applications can use the [**IUIAutomationTextRange::FindAttribute**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findattribute) method to search a text range for text that has a particular text attribute.</span></span> <span data-ttu-id="03938-174">Если объект найден, метод возвращает новый текстовый диапазон, охватывающий соответствующий текст.</span><span class="sxs-lookup"><span data-stu-id="03938-174">If found, the method returns a new text range that encompasses the matching text.</span></span> <span data-ttu-id="03938-175">Обратите внимание, что **финдаттрибуте** Возвращает текстовый диапазон для соответствующего текста, даже если текст не виден.</span><span class="sxs-lookup"><span data-stu-id="03938-175">Note that **FindAttribute** returns a text range for matching text even if the text is not visible.</span></span>

## <a name="retrieving-embedded-objects-from-a-text-range"></a><span data-ttu-id="03938-176">Получение внедренных объектов из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-176">Retrieving Embedded Objects from a Text Range</span></span>

<span data-ttu-id="03938-177">Текстовый диапазон может включать в себя внедренные объекты, такие как таблицы, изображения, гиперссылки и т. д.</span><span class="sxs-lookup"><span data-stu-id="03938-177">A text range can include embedded objects such as tables, images, hyperlinks, and so on.</span></span> <span data-ttu-id="03938-178">Клиентское приложение может получить коллекцию всех внедренных объектов в диапазоне, вызвав метод [**иуиаутоматионтекстранже:: Children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) .</span><span class="sxs-lookup"><span data-stu-id="03938-178">A client application can retrieve a collection of all embedded objects in a range by calling the [**IUIAutomationTextRange::GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) method.</span></span> <span data-ttu-id="03938-179">Внедренные объекты, которые перекрываются с диапазоном, но не полностью включены в него, также включаются в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="03938-179">Embedded objects that overlap with the range but are not entirely enclosed by it are also included in the collection.</span></span> <span data-ttu-id="03938-180">Если диапазон не содержит внедренных объектов, то **дочерние** коллекции получают пустую коллекцию.</span><span class="sxs-lookup"><span data-stu-id="03938-180">If the range contains no embedded objects, **GetChildren** retrieves an empty collection.</span></span>

<span data-ttu-id="03938-181">Несмотря на то, что он зависит от поставщика текстового элемента управления, метод [**Children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) обычно не возвращает потомков внедренных элементов.</span><span class="sxs-lookup"><span data-stu-id="03938-181">Although it depends on the provider of the text-based control, the [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) method typically does not return any children of the embedded elements.</span></span> <span data-ttu-id="03938-182">Например, если текстовый диапазон содержит таблицу с числом дочерних ячеек, метод **дочернего** элемента обычно возвращает только элемент Table, а не элементы ячейки.</span><span class="sxs-lookup"><span data-stu-id="03938-182">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method typically returns just the table element and not the cell elements.</span></span>

<span data-ttu-id="03938-183">В целях повышения производительности или архитектуры [**дочерние элементы**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) могут не иметь возможности извлечения объектов [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для всех внедренных объектов в текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="03938-183">For performance or architectural reasons, [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) may not be able to retrieve [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) objects for all embedded objects in a text range.</span></span> <span data-ttu-id="03938-184">Вместо этого поставщик может возвращать коллекцию, содержащую виртуализированные элементы.</span><span class="sxs-lookup"><span data-stu-id="03938-184">Instead, the provider might return a collection that includes virtualized items.</span></span> <span data-ttu-id="03938-185">Дополнительные сведения см. в разделе [Работа с виртуализированными элементами](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="03938-185">For more information, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="manipulating-a-text-range"></a><span data-ttu-id="03938-186">Управление диапазоном текста</span><span class="sxs-lookup"><span data-stu-id="03938-186">Manipulating a Text Range</span></span>

<span data-ttu-id="03938-187">Интерфейс [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) предоставляет несколько методов для манипулирования текстовыми диапазонами и перемещения по ним в элементе управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="03938-187">The [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="03938-188">Методы [**иуиаутоматионтекстранже:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move), [**мовиндпоинтбюнит**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit)и [**експандтоенклосингунит**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) перемещают текстовый диапазон или одну из его конечных точек на указанную единицу текста, например символ, слово, абзац и т. д.</span><span class="sxs-lookup"><span data-stu-id="03938-188">The [**IUIAutomationTextRange::Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="03938-189">Дополнительные сведения см. в разделе [единицы измерения текста модели автоматизации пользовательского интерфейса](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="03938-189">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="03938-190">Несмотря на свое имя, метод [**експандтоенклосингунит**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) не обязательно расширяет текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="03938-190">Despite its name, the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="03938-191">Вместо этого он нормализует текстовый диапазон, перемещая конечные точки таким образом, чтобы диапазон затронул указанную единицу текста в точности.</span><span class="sxs-lookup"><span data-stu-id="03938-191">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit exactly.</span></span> <span data-ttu-id="03938-192">Диапазон расширяется, если он меньше указанной единицы, или сокращен, если он превышает заданную единицу.</span><span class="sxs-lookup"><span data-stu-id="03938-192">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="03938-193">На следующей схеме показано, как **експандтоенклосингунит** нормализует текстовый диапазон, перемещая конечные точки диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-193">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![Схема, показывающая позиции конечных точек до и после вызова експандтоенклосингунит](images/expandtoenclosingunit.jpg)

<span data-ttu-id="03938-195">Если текстовый диапазон начинается с начала текстового блока и заканчивается в начале (или до) следующей границы единицы текста, конечная точка перемещается на следующую границу единицы текста (см. 1 и 2 на предыдущем рисунке).</span><span class="sxs-lookup"><span data-stu-id="03938-195">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous illustration).</span></span>

<span data-ttu-id="03938-196">Если текстовый диапазон начинается в начале текстового блока и заканчивается на единице (или после), конечная точка остается или перемещается назад на следующую границу единицы после начальной конечной точки (см. 3 и 4 на предыдущем рисунке).</span><span class="sxs-lookup"><span data-stu-id="03938-196">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="03938-197">Если между начальной и конечной конечными точками имеется более одной границы единицы текста, конечная точка перемещается назад к следующей границе единицы после начальной конечной точки, что приводит к подлине текстового диапазона, имеющего одну единицу текста.</span><span class="sxs-lookup"><span data-stu-id="03938-197">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="03938-198">Если диапазон текста начинается в середине единицы текста, начальная конечная точка перемещается назад в начало текстового блока, а конечная конечная точка перемещается вперед или назад по мере необходимости на границу следующей единицы после начальной конечной точки (см. описание 5 – 8 на предыдущем рисунке).</span><span class="sxs-lookup"><span data-stu-id="03938-198">If the text range starts in the middle of a text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous illustration).</span></span>

<span data-ttu-id="03938-199">При вызове метода [**иуиаутоматионтекстранже:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) поставщик нормализует текстовый диапазон на заданную единицу текста.</span><span class="sxs-lookup"><span data-stu-id="03938-199">When the [**IUIAutomationTextRange::Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) method is called, the provider normalizes the text range by the specified text unit.</span></span> <span data-ttu-id="03938-200">Затем поставщик перемещает диапазон назад или вперед по заданному числу единиц текста.</span><span class="sxs-lookup"><span data-stu-id="03938-200">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="03938-201">При перемещении диапазона поставщик игнорирует границы любых внедренных объектов в тексте.</span><span class="sxs-lookup"><span data-stu-id="03938-201">When moving the range, the provider ignores the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="03938-202">(Однако сама граница единицы может зависеть от существования внедренного объекта).</span><span class="sxs-lookup"><span data-stu-id="03938-202">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="03938-203">На следующей схеме показано, как метод **Move** перемещает текстовый диапазон, единицу измерения между внедренными объектами и границами единиц текста.</span><span class="sxs-lookup"><span data-stu-id="03938-203">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![Диаграмма, показывающая, как метод Move перемещает конечные точки диапазона между объектами и границами единиц текста](images/move.jpg)

<span data-ttu-id="03938-205">Метод [**иуиаутоматионтекстранже:: мовиндпоинтбюнит**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit) перемещает одну из конечных точек вперед или назад по указанной единице текста.</span><span class="sxs-lookup"><span data-stu-id="03938-205">The [**IUIAutomationTextRange::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit.</span></span> <span data-ttu-id="03938-206">На следующем рисунке показано, как конечная точка перемещается вперед.</span><span class="sxs-lookup"><span data-stu-id="03938-206">The following illustration shows how an endpoint moves forward.</span></span>

![Диаграмма, показывающая, как мовиндпоинтбюнит перемещает конечную точку диапазона](images/moveendpointbyunit.gif)

<span data-ttu-id="03938-208">Метод [**иуиаутоматионтекстранже:: мовиндпоинтбиранже**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyrange) позволяет клиентскому приложению задать одну конечную точку текстового диапазона в том же расположении, что и указанная конечная точка второго текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-208">The [**IUIAutomationTextRange::MoveEndpointByRange**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

## <a name="scrolling-a-text-range-into-view"></a><span data-ttu-id="03938-209">Прокрутка текстового диапазона в представление</span><span class="sxs-lookup"><span data-stu-id="03938-209">Scrolling a Text Range into View</span></span>

<span data-ttu-id="03938-210">Метод [**иуиаутоматионтекстранже:: скроллинтовиев**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-scrollintoview) прокручивает текстовый диапазон, чтобы текст был виден в окне просмотра текстового элемента управления.</span><span class="sxs-lookup"><span data-stu-id="03938-210">The [**IUIAutomationTextRange::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-scrollintoview) method scrolls a text range so that the text is visible in the viewport of the text-based control.</span></span> <span data-ttu-id="03938-211">При вызове **скроллинтовиев** клиент может указать, следует ли выровняйте текст по верхнему или нижнему краю окна просмотра.</span><span class="sxs-lookup"><span data-stu-id="03938-211">When calling **ScrollIntoView**, a client can specify whether the text should be aligned with the top or bottom of the viewport.</span></span>

## <a name="retrieving-the-enclosing-element-of-a-text-range"></a><span data-ttu-id="03938-212">Извлечение включающего элемента текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-212">Retrieving the Enclosing Element of a Text Range</span></span>

<span data-ttu-id="03938-213">Клиентское приложение может использовать метод [**иуиаутоматионтекстранже:: жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) для получения указателя на интерфейс [**иуиаутоматион**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) самого внутреннего элемента, охватывающего текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="03938-213">A client application can use the [**IUIAutomationTextRange::GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) method to retrieve the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) interface pointer of the innermost element that encloses a text range.</span></span> <span data-ttu-id="03938-214">Включающий элемент обычно является поставщиком текста, предоставляющим текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="03938-214">The enclosing element is typically the text provider that supplies the text range.</span></span> <span data-ttu-id="03938-215">Однако если поставщик текста поддерживает дочерние элементы, такие как таблицы или гиперссылки, то включающий элемент может быть потомком поставщика текста.</span><span class="sxs-lookup"><span data-stu-id="03938-215">However, if the text provider supports child elements such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span>

## <a name="comparing-and-cloning-text-ranges"></a><span data-ttu-id="03938-216">Сравнение и клонирование диапазонов текста</span><span class="sxs-lookup"><span data-stu-id="03938-216">Comparing and Cloning Text Ranges</span></span>

<span data-ttu-id="03938-217">Интерфейс [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) включает два метода для сравнения текстовых диапазонов.</span><span class="sxs-lookup"><span data-stu-id="03938-217">The [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface includes two methods for comparing text ranges.</span></span> <span data-ttu-id="03938-218">Метод [**иуиаутоматионтекстранже:: Compare**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-compareendpoints) сравнивает начальную и конечную конечные точки двух текстовых диапазонов и возвращает **значение true** , если обе конечные точки одинаковы.</span><span class="sxs-lookup"><span data-stu-id="03938-218">The [**IUIAutomationTextRange::Compare**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-compareendpoints) method compares the starting and ending endpoints of two text ranges and returns **TRUE** if both endpoints are the same.</span></span> <span data-ttu-id="03938-219">Метод **иуиаутоматионтекстранже:: компариндпоинтс** сравнивает либо начальную, либо конечную конечную точку двух диапазонов.</span><span class="sxs-lookup"><span data-stu-id="03938-219">The **IUIAutomationTextRange::CompareEndpoints** method compares either the start or the ending endpoint of the two ranges.</span></span> <span data-ttu-id="03938-220">Возвращаемое значение равно нулю, если конечные точки совпадают, или положительное значение или отрицательное значение, указывающее относительное положение двух конечных точек.</span><span class="sxs-lookup"><span data-stu-id="03938-220">The return value is zero if the endpoints are the same, or a positive value or negative value that indicates the relative positions of the two endpoints.</span></span>

<span data-ttu-id="03938-221">Клиентские приложения могут использовать метод [**иуиаутоматионтекстранже:: Clone**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-clone) для создания точной копии текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="03938-221">Client applications can use the [**IUIAutomationTextRange::Clone**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-clone) method to create an exact copy of text range.</span></span> <span data-ttu-id="03938-222">Новый текстовый диапазон можно манипулировать независимо от исходного диапазона текста.</span><span class="sxs-lookup"><span data-stu-id="03938-222">The new text range can be manipulated independently of the original text range.</span></span>

## <a name="retrieving-annotations"></a><span data-ttu-id="03938-223">Получение заметок</span><span class="sxs-lookup"><span data-stu-id="03938-223">Retrieving Annotations</span></span>

<span data-ttu-id="03938-224">Текстовый диапазон может содержать заметки, если элемент управления на основе текста поддерживает их.</span><span class="sxs-lookup"><span data-stu-id="03938-224">A text range can include annotations if the text-based control supports them.</span></span> <span data-ttu-id="03938-225">Существует много различных типов заметок.</span><span class="sxs-lookup"><span data-stu-id="03938-225">There are many different kinds of annotations.</span></span> <span data-ttu-id="03938-226">Файл заголовка UIAutomationClient. h определяет набор именованных постоянных значений, которые определяют типы заметок, поддерживаемых автоматизацией пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="03938-226">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that UI Automation supports.</span></span> <span data-ttu-id="03938-227">Дополнительные сведения см. в разделе [**идентификаторы типов заметок**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="03938-227">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>

<span data-ttu-id="03938-228">Некоторые типы заметок представлены элементом автоматизации, который поддерживает шаблон элемента управления [Annotation](uiauto-implementingannotation.md) (интерфейс [**иуиаутоматионаннотатионпаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) ).</span><span class="sxs-lookup"><span data-stu-id="03938-228">Some kinds of annotations are represented by an automation element that supports the [Annotation](uiauto-implementingannotation.md) control pattern ([**IUIAutomationAnnotationPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) interface).</span></span> <span data-ttu-id="03938-229">Другие типы заметок предоставляются с помощью шаблона элемента управления [TextRange](uiauto-about-text-and-textrange-patterns.md) .</span><span class="sxs-lookup"><span data-stu-id="03938-229">Other kinds of annotations are exposed through the [TextRange](uiauto-about-text-and-textrange-patterns.md) control pattern.</span></span> <span data-ttu-id="03938-230">Например, поставщик может предоставить простой индикатор орфографической ошибки, получив метод [**иуиаутоматионтекстранже:: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) , возвращающий атрибут [**Аннотатионтипес**](uiauto-textattribute-ids.md) Text для [**аннотатионтипе \_ Спеллинжеррор**](uiauto-annotation-type-identifiers.md)и значение NULL для атрибута [**аннотатионобжектс**](uiauto-textattribute-ids.md) Text.</span><span class="sxs-lookup"><span data-stu-id="03938-230">For example, a provider could expose a simple spelling-error indicator by having the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>

### <a name="retrieving-annotations-types-from-a-text-range"></a><span data-ttu-id="03938-231">Получение типов заметок из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-231">Retrieving Annotations Types from a Text Range</span></span>

<span data-ttu-id="03938-232">Список типов заметок, которые содержатся в текстовом диапазоне, можно получить с помощью метода [**иуиаутоматионтекстранже:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) .</span><span class="sxs-lookup"><span data-stu-id="03938-232">You can retrieve a list of the types of annotations that are present in a text range by using the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method.</span></span> <span data-ttu-id="03938-233">При вызове метода укажите идентификатор текстового атрибута [**UIA \_ аннотатионтипесаттрибутеид**](uiauto-textattribute-ids.md) и указатель на параметр типа [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant).</span><span class="sxs-lookup"><span data-stu-id="03938-233">When calling the method, specify a text attribute ID of [**UIA\_AnnotationTypesAttributeId**](uiauto-textattribute-ids.md) and a pointer to a parameter of type [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant).</span></span> <span data-ttu-id="03938-234">Когда метод возвращает значение, параметр **Variant** содержит список идентификаторов типов заметок, по одному для каждого типа заметок в текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="03938-234">When the method returns, the **VARIANT** parameter contains a list of annotation type identifiers, one for each type of annotation in the text range.</span></span> <span data-ttu-id="03938-235">Дополнительные сведения см. в разделе [**идентификаторы типов заметок**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="03938-235">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>

### <a name="retrieving-all-annotations-from-a-text-range"></a><span data-ttu-id="03938-236">Извлечение всех заметок из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="03938-236">Retrieving All Annotations from a Text Range</span></span>

<span data-ttu-id="03938-237">Чтобы получить заметки из текстового диапазона, вызовите метод [**иуиаутоматионтекстранже:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) , указав идентификатор текстового атрибута [**UIA \_ аннотатионобжектсаттрибутеид**](uiauto-textattribute-ids.md) и указатель на параметр типа [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant).</span><span class="sxs-lookup"><span data-stu-id="03938-237">To retrieve the annotations from a text range, call the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method, specifying a text attribute ID of [**UIA\_AnnotationObjectsAttributeId**](uiauto-textattribute-ids.md) and a pointer to a parameter of type [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant).</span></span> <span data-ttu-id="03938-238">Когда метод возвращает значение, параметр **Variant** содержит интерфейс [**иуиаутоматионелементаррай**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelementarray) , представляющий массив элементов автоматизации, по одному для каждой заметки в диапазоне текста.</span><span class="sxs-lookup"><span data-stu-id="03938-238">When the method returns, the **VARIANT** parameter contains an [**IUIAutomationElementArray**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelementarray) interface that represents an array of automation elements, one for each annotation in the text range.</span></span> <span data-ttu-id="03938-239">Свойство [**иуиаутоматионелементаррай:: Length**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-get_length) указывает количество элементов в массиве, а метод [**иуиаутоматионелементаррай::-element**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-getelement) Извлекает интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для определенного элемента.</span><span class="sxs-lookup"><span data-stu-id="03938-239">The [**IUIAutomationElementArray::Length**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-get_length) property indicates the number of elements in the array, and the [**IUIAutomationElementArray::GetElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-getelement) method retrieves the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for a particular element.</span></span>

### <a name="retrieving-information-about-a-particular-annotation"></a><span data-ttu-id="03938-240">Получение сведений о конкретной заметке</span><span class="sxs-lookup"><span data-stu-id="03938-240">Retrieving Information About a Particular Annotation</span></span>

<span data-ttu-id="03938-241">Чтобы получить сведения о конкретной заметке, сначала извлеките интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для элемента Annotation, как описано в предыдущем разделе.</span><span class="sxs-lookup"><span data-stu-id="03938-241">To retrieve information about a particular annotation, first retrieve the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the annotation element as described in the previous section.</span></span> <span data-ttu-id="03938-242">Затем извлеките интерфейс [**иуиаутоматионаннотатионпаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) для аннотации, вызвав метод [**Иуиаутоматионелемент:: жеткуррентпаттернас**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) с идентификатором шаблона элемента управления [**UIA \_ аннотатионпаттернид**](uiauto-controlpattern-ids.md), идентификатором интерфейса IID \_ IUIAutomationAnnotationPattern и адресом переменной, которая получает указатель **IUIAutomationAnnotation** для заметки.</span><span class="sxs-lookup"><span data-stu-id="03938-242">Next, retrieve the [**IUIAutomationAnnotationPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) interface for the annotation by calling the [**IUIAutomationElement::GetCurrentPatternAs**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) method with a control pattern ID of [**UIA\_AnnotationPatternId**](uiauto-controlpattern-ids.md), an interface identifier of IID\_IUIAutomationAnnotationPattern, and the address of a variable that receives the **IUIAutomationAnnotation** pointer for the annotation.</span></span> <span data-ttu-id="03938-243">Запросите свойства интерфейса **иуиаутоматионаннотатион** , чтобы получить имя типа заметки и идентификатор типа, имя автора заметки, дату и время заметки, а также интерфейс **иуиаутоматионелемент** для элемента, для которого задается заметка.</span><span class="sxs-lookup"><span data-stu-id="03938-243">Query the properties of the **IUIAutomationAnnotation** interface to retrieve the annotation type name and type ID, the name of the annotation author, the date and time of the annotation, and the **IUIAutomationElement** interface for the element that is being annotated.</span></span>

### <a name="retrieving-the-annotation-target-text"></a><span data-ttu-id="03938-244">Извлечение целевого текста заметки</span><span class="sxs-lookup"><span data-stu-id="03938-244">Retrieving the Annotation Target Text</span></span>

<span data-ttu-id="03938-245">Как правило, аннотация применяется к некоторым подмножествам текста в текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="03938-245">Typically, an annotation applies to some subset of the text in a text range.</span></span> <span data-ttu-id="03938-246">После получения интерфейса [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для аннотации можно передать интерфейс методу [**IUIAutomationTextRange2:: ранжефроманнотатион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) , чтобы получить текстовый диапазон, содержащий текст, который является целевым объектом заметки.</span><span class="sxs-lookup"><span data-stu-id="03938-246">After you retrieve the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for an annotation, you can pass the interface to the [**IUIAutomationTextRange2::RangeFromAnnotation**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) method to retrieve a text range that contains the text that is the target of the annotation.</span></span>

## <a name="retrieving-visual-styles"></a><span data-ttu-id="03938-247">Получение визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="03938-247">Retrieving Visual Styles</span></span>

<span data-ttu-id="03938-248">Поставщик реализует шаблон элемента управления [styles](/windows/desktop/WinAuto/uiauto-implementingstyles) для описания элемента пользовательского интерфейса, имеющего конкретный стиль, цвет заливки, шаблон заливки или форму.</span><span class="sxs-lookup"><span data-stu-id="03938-248">A provider implements the [Styles](/windows/desktop/WinAuto/uiauto-implementingstyles) control pattern to describe a UI element that has a specific style, fill color, fill pattern, or shape.</span></span> <span data-ttu-id="03938-249">Это особенно полезно при описании элементов в документе, которые часто имеют такие стили.</span><span class="sxs-lookup"><span data-stu-id="03938-249">This is especially useful when describing elements in a document, which frequently have such styles.</span></span> <span data-ttu-id="03938-250">Такие стили часто содержат информацию, которая полезна для клиентов с ограниченными возможностями. Например, стили могут описывать определенную строку как заголовок документа или определенный объект блок-схемы как ромб или окружность.</span><span class="sxs-lookup"><span data-stu-id="03938-250">Styles like this often carry information that is useful for customers with disabilities; for example, styles can describe a certain string as the title of a document, or a certain flowchart object as a diamond or a circle.</span></span>

<span data-ttu-id="03938-251">Для получения имен и идентификаторов визуальных стилей, используемых в текстовом диапазоне, можно использовать метод [**иуиаутоматионтекстранже:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) .</span><span class="sxs-lookup"><span data-stu-id="03938-251">You can use the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method to retrieve the names and identifiers of the visual styles that are used in a text range.</span></span> <span data-ttu-id="03938-252">Используйте атрибут [**\_ Стиленамеаттрибутеид текста UIA**](uiauto-textattribute-ids.md) для получения имен стилей и [**UIA \_ стилеидаттрибутеид**](uiauto-textattribute-ids.md) для получения идентификаторов стилей.</span><span class="sxs-lookup"><span data-stu-id="03938-252">Use the [**UIA\_StyleNameAttributeId**](uiauto-textattribute-ids.md) text attribute to retrieve the style names, and [**UIA\_StyleIdAttributeId**](uiauto-textattribute-ids.md) to retrieve the style identifiers.</span></span>

<span data-ttu-id="03938-253">Элемент управления на основе текста, поддерживающий стили оформления, может реализовать шаблон элемента управления [styles](/windows/desktop/WinAuto/uiauto-implementingstyles) , чтобы позволить клиентам получать доступ к информации о визуальном стиле, используемом элементом управления.</span><span class="sxs-lookup"><span data-stu-id="03938-253">A text-based control that supports visual styles can implement the [Styles](/windows/desktop/WinAuto/uiauto-implementingstyles) control pattern to enable clients to access information about a visual style used by the control.</span></span> <span data-ttu-id="03938-254">Клиенты обращаются к шаблону элемента управления Styles через интерфейс [**иуиаутоматионстилеспаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) .</span><span class="sxs-lookup"><span data-stu-id="03938-254">Clients access the Styles control pattern through the [**IUIAutomationStylesPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) interface.</span></span> <span data-ttu-id="03938-255">Этот интерфейс можно получить, вызвав метод [**иуиаутоматионелемент:: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern) или [**Жеткуррентпаттернас**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) , указав [**UIA \_ стилеспаттернид**](uiauto-controlpattern-ids.md) в качестве идентификатора шаблона элемента управления.</span><span class="sxs-lookup"><span data-stu-id="03938-255">You can retrieve this interface by calling the [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern) or [**GetCurrentPatternAs**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) method, specifying [**UIA\_StylesPatternId**](uiauto-controlpattern-ids.md) as the control pattern identifier.</span></span>

<span data-ttu-id="03938-256">Интерфейс [**иуиаутоматионстилеспаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) содержит свойства и методы, которые предоставляют следующие сведения о визуальном стиле:</span><span class="sxs-lookup"><span data-stu-id="03938-256">The [**IUIAutomationStylesPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) interface includes properties and methods that provide the following information about a visual style:</span></span>

-   <span data-ttu-id="03938-257">Имя визуального стиля, например "нормальный" или "Заголовок 1".</span><span class="sxs-lookup"><span data-stu-id="03938-257">The name of the visual style, such as "Normal" or "Heading 1".</span></span>
-   <span data-ttu-id="03938-258">Идентификатор визуального стиля.</span><span class="sxs-lookup"><span data-stu-id="03938-258">The identifier of the visual style.</span></span> <span data-ttu-id="03938-259">Дополнительные сведения см. в разделе [**идентификаторы стилей**](uiauto-style-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="03938-259">For more information, see [**Style Identifiers**](uiauto-style-identifiers.md).</span></span>
-   <span data-ttu-id="03938-260">Цвет, используемый для заполнения элемента управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="03938-260">The color used to fill the text-based control.</span></span>
-   <span data-ttu-id="03938-261">Цвет шаблона, используемого для заполнения элемента управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="03938-261">The color of the pattern used to fill the text-based control.</span></span>
-   <span data-ttu-id="03938-262">Форма элемента управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="03938-262">The shape of the text-based control.</span></span>
-   <span data-ttu-id="03938-263">Расширенные свойства; то есть список имен и значений стиля для конкретного элемента управления.</span><span class="sxs-lookup"><span data-stu-id="03938-263">The extended properties; that is, a list of control-specific style names and values.</span></span>

## <a name="invoking-context-menus-from-text-ranges"></a><span data-ttu-id="03938-264">Вызов контекстных меню из текстовых диапазонов</span><span class="sxs-lookup"><span data-stu-id="03938-264">Invoking Context Menus From Text Ranges</span></span>

<span data-ttu-id="03938-265">Начиная с Windows 8.1, текстовые диапазоны могут поддерживать интерфейс [**IUIAutomationTextRange2**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange2) .</span><span class="sxs-lookup"><span data-stu-id="03938-265">Starting with Windows 8.1, text ranges may support the [**IUIAutomationTextRange2**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange2) interface.</span></span> <span data-ttu-id="03938-266">Этот интерфейс поддерживает метод [**шовконтекстмену**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange2-showcontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="03938-266">This interface supports the [**ShowContextMenu**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange2-showcontextmenu) method.</span></span> <span data-ttu-id="03938-267">Этот метод можно вызвать для вызова любого контекстного меню, связанного с текстовым диапазоном.</span><span class="sxs-lookup"><span data-stu-id="03938-267">You can call this method to invoke any context menu that is associated with a text range.</span></span> <span data-ttu-id="03938-268">В этом сценарии используется Автозамена диапазонов текста или выбора кандидатов IME.</span><span class="sxs-lookup"><span data-stu-id="03938-268">The scenario for this is autocorrection of text ranges or IME candidate selection.</span></span> <span data-ttu-id="03938-269">В этих случаях появляется контекстное меню, поддерживающее взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="03938-269">In these cases a context menu appears that supports user interaction.</span></span>

## <a name="related-topics"></a><span data-ttu-id="03938-270">См. также</span><span class="sxs-lookup"><span data-stu-id="03938-270">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="03938-271">Шаблоны элементов управления Text и TextRange</span><span class="sxs-lookup"><span data-stu-id="03938-271">Text and TextRange Control Patterns</span></span>](uiauto-implementingtextandtextrange.md)
</dt> <dt>

[<span data-ttu-id="03938-272">Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого</span><span class="sxs-lookup"><span data-stu-id="03938-272">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="03938-273">Работа с элементами управления на основе текста</span><span class="sxs-lookup"><span data-stu-id="03938-273">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> </dl>

 

 