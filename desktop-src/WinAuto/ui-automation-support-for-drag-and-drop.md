---
title: Поддержка модели автоматизации пользовательского интерфейса для перетаскивания
description: В этом разделе описываются шаблоны элементов управления, которые предоставляют сведения о возможностях перетаскивания элемента.
ms.assetid: FFF5A296-C9FF-4B47-AAF8-A9DD581D9DBE
keywords:
- Автоматизация пользовательского интерфейса, поддержка перетаскивания
- Модель автоматизации пользовательского интерфейса, обзор шаблона перетаскивания
- Модель автоматизации пользовательского интерфейса, общие сведения о шаблоне Дроптаржет
- Модель автоматизации пользовательского интерфейса, обзор перетаскивания
- шаблоны перетаскивания, сведения
- Перетащите шаблон элемента управления
- Шаблон элемента управления Дроптаржет
- шаблоны элементов управления, перетащите
- шаблоны элементов управления, Дроптаржет
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4194613d15aadac4a925303ef2322d4cf53c341c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105681656"
---
# <a name="ui-automation-support-for-drag-and-drop"></a>Поддержка модели автоматизации пользовательского интерфейса для перетаскивания

Модель автоматизации пользовательского интерфейса Майкрософт определяет два шаблона элементов управления для поддержки сценариев перетаскивания, шаблона элемента управления [Drag](/windows/desktop/WinAuto/uiauto-implementingdrag) и шаблона элемента управления [дроптаржет](/windows/desktop/WinAuto/uiauto-implementingdroptarget) . Вы реализуете шаблон элемента управления перетаскиванием для элемента, который можно перетаскивать, и шаблон элемента управления Дроптаржет для элемента, который может получить перетаскиваемый элемент. то есть цель перетаскивания. Эти два шаблона элементов управления предоставляют сведения, которые могут использоваться специальными технологиями, чтобы помочь пользователю в выполнении операции перетаскивания.

-   [Перетаскивание стилей](#dragging-styles)
    -   [Исходный или конечный стиль](#sourcetarget-style)
    -   [Стиль только исходного кода](#source-only-style)
-   [Перетаскивание нескольких элементов](#dragging-multiple-items)
-   [Клиентские интерфейсы для перетаскивания](#client-interfaces-for-drag-and-drop)

## <a name="dragging-styles"></a>Перетаскивание стилей

При реализации шаблона элемента управления [перетаскиванием](/windows/desktop/WinAuto/uiauto-implementingdrag) для перетаскиваемого элемента необходимо решить, следует ли реализовать стиль перетаскивания *исходного или целевого объекта* или *только исходный* стиль перетаскивания.

### <a name="sourcetarget-style"></a>Исходный или конечный стиль

В исходном или целевом стиле перетаскивания, перетаскиваемый элемент ("источник") и элемент Drop-Target ("цель") различаются, и каждый из них создает отдельный набор событий. Ниже приведен жизненный цикл операции перетаскивания, которая использует исходный или целевой стиль: <dl> Когда пользователь запускает операцию перетаскивания:

-   Источник создает событие Драгстарт ([**UIA \_ Drag \_ драгстартевентид**](uiauto-event-ids.md)).
-   Источник задает для свойства [**идрагпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) **IsTrue значение true**.
-   Целевые объекты обновляют свойства [**дроптаржетеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idroptargetprovider-get_droptargeteffect) .

  
Когда операция перетаскивания переходит в целевую область:

-   Целевой объект вызывает событие DragEnter ([**UIA \_ дроптаржет \_ дражентеревентид**](uiauto-event-ids.md)).

  
Когда операция перетаскивания покидает целевую область:

-   Целевой объект вызывает событие DragLeave ([**UIA \_ дроптаржет \_ драглеавивентид**](uiauto-event-ids.md)).

  
Когда пользователь отпускает перетаскиваемый элемент на нецелевом:

-   Источник создает событие Драгканцел ([**UIA \_ Drag \_ драгканцелевентид**](uiauto-event-ids.md)).
-   Источник устанавливает свойство [**идрагпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) **IsFalse в значение false**.

  
Когда пользователь отпускает перетаскиваемый элемент на целевом объекте:

-   Источник создает событие Драгкомплете ([**UIA \_ Drag \_ драгкомплетивентид**](uiauto-event-ids.md)).
-   Источник устанавливает свойство [**идрагпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) **IsFalse в значение false**.
-   Целевой объект задает свойство [**идроптаржетпровидер::D роптаржетеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idroptargetprovider-get_droptargeteffect) , которое указывает на произошедшее воздействие.
-   Целевой объект создает событие "удалено" ([**UIA \_ дроптаржет \_ дроппедевентид**](uiauto-event-ids.md)).

  
</dl>

События из исходного и целевого объектов тесно связаны, но отличаются друг от друга. Данные о том, что происходит при перетаскивании, поступают из источника, а данные о том, что могло произойти, поступили из целевого объекта.

При выполнении операции перетаскивания перетаскиваемый элемент можно перетаскивать в целевые регионы или из него любое количество раз до завершения операции.

Любая цель перетаскивания, нуждающаяся в обновлении свойства [**идроптаржетпровидер::D роптаржетеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idroptargetprovider-get_droptargeteffect) в режиме реального времени, должна вызвать дополнительное событие изменения свойства для этого свойства.

### <a name="source-only-style"></a>Стиль только исходного кода

Стиль перетаскивания «только исходный код» позволяет поставщику избегать реализации целевых объектов перетаскивания. Не реализация целевых объектов перетаскивания помогает снизить затраты на реализацию, но не предоставляет клиентским приложениям специальных возможностей сведения об объекте, который получил удаление. Ниже приведен жизненный цикл операции перетаскивания, которая использует только исходный стиль: <dl> Когда пользователь запускает операцию перетаскивания:

-   Источник создает событие Драгстарт ([**UIA \_ Drag \_ драгстартевентид**](uiauto-event-ids.md)).
-   Источник задает для свойства [**идрагпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) **IsTrue значение true**.

  
Когда операция перетаскивания переходит в целевую область:

-   Источник задает для свойства [**идрагпровидер::D ропеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) соответствующее значение.

  
Когда операция перетаскивания покидает целевую область:

-   Источник задает для свойства [**идрагпровидер::D ропеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) соответствующее значение.

  
Когда пользователь отпускает перетаскиваемый элемент на нецелевом:

-   Источник создает событие Драгканцел ([**UIA \_ Drag \_ драгканцелевентид**](uiauto-event-ids.md)).
-   Источник устанавливает свойство [**идрагпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) **IsFalse в значение false**.

  
Когда пользователь отпускает перетаскиваемый элемент на целевом объекте:

-   Источник создает событие Драгкомплете ([**UIA \_ Drag \_ драгкомплетивентид**](uiauto-event-ids.md)).
-   Источник устанавливает свойство [**идрагпровидер::D ропеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) , чтобы указать результат, который выполнялся при удалении элемента.

  
</dl>

## <a name="dragging-multiple-items"></a>Перетаскивание нескольких элементов

Если поставщик реализует операции перетаскивания, в которых пользователь может одновременно перетаскивать несколько объектов, поставщик использует стили источника/назначения или исходного кода, как описано в предыдущем разделе, но с небольшой разницей. Когда пользователь начинает операцию перетаскивания, поставщик создает элемент главного источника, представляющий полный набор элементов, которые перетаскиваются. Элемент главного источника вызывает все события от имени набора перетаскиваемых элементов. элементы не вызывают никаких собственных событий.<dl> Когда пользователь запускает операцию перетаскивания:

-   Поставщик создает элемент Master source.
-   Элемент главного источника вызывает событие Драгстарт ([**UIA \_ Drag \_ драгстартевентид**](uiauto-event-ids.md)).
-   Элемент "Master source" задает для свойства [**идрагпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) **IsTrue значение true**.
-   Элемент главного источника обновляет список извлеченных элементов, чтобы включить все перетаскиваемые элементы, чтобы метод [**жетграббедитемс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) мог получить список.

  
</dl>

Для этой точки главный элемент Source выполняет ту же роль, что и исходный элемент, как описано в предыдущем разделе.

## <a name="client-interfaces-for-drag-and-drop"></a>Клиентские интерфейсы для перетаскивания

Клиентские приложения модели автоматизации пользовательского интерфейса используют интерфейсы [**иуиаутоматиондрагпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationdragpattern) и [**иуиаутоматиондроптаржетпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationdroptargetpattern) для доступа к сведениям о ПЕРЕТАСКИВАНИИ из элементов пользовательского интерфейса.

 

 