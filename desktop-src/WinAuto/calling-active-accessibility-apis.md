---
title: Вызов интерфейсов API Active Accessibility
description: Microsoft Active Accessibility предоставляет прикладные программные интерфейсы (API) как для клиентов, так и для серверов.
ms.assetid: c40441d2-7294-4c76-8b42-08ed66eccb7e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 209a239495fddbcaf2275f095abc889295568b3c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070147"
---
# <a name="calling-active-accessibility-apis"></a><span data-ttu-id="4c68f-103">Вызов интерфейсов API Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="4c68f-103">Calling Active Accessibility APIs</span></span>

<span data-ttu-id="4c68f-104">Microsoft Active Accessibility предоставляет прикладные программные интерфейсы (API) как для клиентов, так и для серверов.</span><span class="sxs-lookup"><span data-stu-id="4c68f-104">Microsoft Active Accessibility provides application programming interfaces (APIs) for both clients and servers.</span></span> <span data-ttu-id="4c68f-105">Большинство из них реализованы в библиотеке динамической компоновки Microsoft Active Accessibility, Oleacc.dll, но [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**сетвиневенсук**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook)и [**унхуквиневент**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) реализуются в user32.dll, который является основным компонентом операционной системы Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="4c68f-105">Most are implemented in the Microsoft Active Accessibility dynamic-link library, Oleacc.dll, but [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook), and [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) are implemented in user32.dll, which is a core component of the Microsoft Windows operating system.</span></span>

<span data-ttu-id="4c68f-106">На компьютерах под управлением Windows 95 или Microsoft Windows NT 4,0 не установлены Oleacc.dll и установлена правильная версия user32.dll, так как Microsoft Active Accessibility был включен в составе последующих версий Windows.</span><span class="sxs-lookup"><span data-stu-id="4c68f-106">Computers running Windows 95 or Microsoft Windows NT 4.0 do not have Oleacc.dll and the correct version of user32.dll installed because Microsoft Active Accessibility was incorporated in stages into succeeding versions of Windows.</span></span> <span data-ttu-id="4c68f-107">В результате приложения, работающие на этих платформах, явным образом связываются с Oleacc.dll во время выполнения с помощью функции [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) , а не с использованием библиотек импорта.</span><span class="sxs-lookup"><span data-stu-id="4c68f-107">As a result, applications that run on these platforms explicitly link to Oleacc.dll at run time using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function instead of relying on import libraries.</span></span> <span data-ttu-id="4c68f-108">Active Accessibility 1,3 поддерживает Windows 95 и Microsoft Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="4c68f-108">Active Accessibility 1.3 supports Windows 95 and Microsoft Windows NT 4.0.</span></span> <span data-ttu-id="4c68f-109">Более ранние версии Windows не поддерживаются корпорацией Майкрософт Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="4c68f-109">Earlier versions of Windows are not supported by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="4c68f-110">Серверные приложения используют функцию [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) для получения адреса функции Microsoft Active Accessibility, а затем выполняют вызов через указатель функции.</span><span class="sxs-lookup"><span data-stu-id="4c68f-110">Server applications use the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to retrieve the address of an Microsoft Active Accessibility function and then make the call through a function pointer.</span></span> <span data-ttu-id="4c68f-111">При вызове функции, реализованной в Oleacc.dll, серверные приложения используют в вызове **GetProcAddress** маркер, возвращенный из [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) .</span><span class="sxs-lookup"><span data-stu-id="4c68f-111">If calling a function that was implemented in Oleacc.dll, server applications use the handle returned from [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) in the call to **GetProcAddress**.</span></span> <span data-ttu-id="4c68f-112">При вызове функции, определенной в user32.dll, серверные приложения вызывают [**Ошибка GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) , УКАЗАВ "user32", и используйте возвращенный маркер модуля в вызове **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="4c68f-112">If calling a function defined in user32.dll, server applications call [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specifying "USER32" and use the returned module handle in the call to **GetProcAddress**.</span></span>

<span data-ttu-id="4c68f-113">Например, если приложение использует [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), оно вызывает [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) с помощью обработчика модуля user32.dll, чтобы получить адрес функции.</span><span class="sxs-lookup"><span data-stu-id="4c68f-113">For example, if an application uses [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), it calls [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) using the module handle of user32.dll to get the address of the function.</span></span> <span data-ttu-id="4c68f-114">Если вызов прошел успешно (это означает, что эта версия Windows поддерживает Microsoft Active Accessibility), то в приложении устанавливается флаг, указывающий, что вызов **нотифивиневент** может быть защищен.</span><span class="sxs-lookup"><span data-stu-id="4c68f-114">If the call is successful (meaning that this version of Windows supports Microsoft Active Accessibility), then the application sets a flag that indicates that it is safe to call **NotifyWinEvent**.</span></span> <span data-ttu-id="4c68f-115">Адрес, полученный из **GetProcAddress** , хранится в переменной указателя функции и используется во всем коде.</span><span class="sxs-lookup"><span data-stu-id="4c68f-115">The address received from **GetProcAddress** is stored in a function pointer variable and used throughout the code.</span></span>

 

 