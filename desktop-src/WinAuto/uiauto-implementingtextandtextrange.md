---
title: Шаблоны элементов управления Text и TextRange
description: Описывает правила и соглашения для реализации Итекстпровидер, ITextProvider2 и Итекстранжепровидер, включая сведения о свойствах и методах.
ms.assetid: 4d541c31-11f7-4d7e-a0e0-9ed1da873d07
keywords:
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления Text
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления TextRange
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления Text
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления TextRange
- Модель автоматизации пользовательского интерфейса, Итекстпровидер
- Модель автоматизации пользовательского интерфейса, Итекстранжепровидер
- ITextProvider
- ITextRangeProvider
- Реализация шаблона элемента управления текстом модели автоматизации пользовательского интерфейса
- Реализация шаблона элемента управления TextRange модели автоматизации пользовательского интерфейса
- Шаблон элемента управления Text
- Шаблон элемента управления TextRange
- шаблоны элементов управления, Итекстпровидер
- шаблоны элементов управления, Итекстранжепровидер
- шаблоны элементов управления, реализация текста автоматизации пользовательского интерфейса
- шаблоны элементов управления, реализация модели автоматизации пользовательского интерфейса TextRange
- шаблоны элементов управления, текст
- шаблоны элементов управления, TextRange
- интерфейсы, Итекстпровидер
- интерфейсы, Итекстранжепровидер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f53429dc8ec137a83b6a40db377b5c84aeb36120
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104550373"
---
# <a name="text-and-textrange-control-patterns"></a><span data-ttu-id="bb285-123">Шаблоны элементов управления Text и TextRange</span><span class="sxs-lookup"><span data-stu-id="bb285-123">Text and TextRange Control Patterns</span></span>

<span data-ttu-id="bb285-124">Описывает правила и соглашения для реализации [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)и [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), включая сведения о свойствах и методах.</span><span class="sxs-lookup"><span data-stu-id="bb285-124">Describes guidelines and conventions for implementing [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2), and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), including information about properties and methods.</span></span> <span data-ttu-id="bb285-125">Шаблон элемента управления **Text** позволяет приложениям и элементам управления предоставлять простую объектную модель текста, позволяя клиентам получать текстовое содержимое, текстовые атрибуты и внедренные объекты из текстовых элементов управления.</span><span class="sxs-lookup"><span data-stu-id="bb285-125">The **Text** control pattern enables applications and controls to expose a simple text object model, enabling clients to retrieve textual content, text attributes, and embedded objects from text-based controls.</span></span>

<span data-ttu-id="bb285-126">Для поддержки шаблона элемента управления **Text** элементы управления реализуют интерфейсы [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) и [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="bb285-126">To support the **Text** control pattern, controls implement the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces.</span></span> <span data-ttu-id="bb285-127">Типы элементов управления, которые должны поддерживать шаблон элемента управления **Text** , включают в себя типы [Edit](uiauto-supporteditcontroltype.md) и [Document](uiauto-supportdocumentcontroltype.md) Control, а также любой другой тип элемента управления, позволяющий пользователю вводить текст или выбирать текст только для чтения.</span><span class="sxs-lookup"><span data-stu-id="bb285-127">Control types that should support the **Text** control pattern include the [Edit](uiauto-supporteditcontroltype.md) and [Document](uiauto-supportdocumentcontroltype.md) control types, and any other control type that enables the user to enter text or select read-only text.</span></span>

<span data-ttu-id="bb285-128">Шаблон элемента управления **Text** можно использовать с другими шаблонами элементов управления автоматизации пользовательского интерфейса Майкрософт для поддержки нескольких типов внедренных объектов в тексте, включая таблицы, гиперссылки и кнопки команд.</span><span class="sxs-lookup"><span data-stu-id="bb285-128">The **Text** control pattern can be used with other Microsoft UI Automation control patterns to support several types of embedded objects in the text, including tables, hyperlinks, and command buttons.</span></span>

<span data-ttu-id="bb285-129">Интерфейсы [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) и [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) включают ряд методов для получения текстовых диапазонов.</span><span class="sxs-lookup"><span data-stu-id="bb285-129">The [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces include a number of methods for acquiring text ranges.</span></span> <span data-ttu-id="bb285-130">*Текстовый диапазон* — это объект, представляющий непрерывный участок текста (или несколько несвязных диапазонов текста) в текстовом контейнере.</span><span class="sxs-lookup"><span data-stu-id="bb285-130">A *text range* is an object that represents a contiguous span of text—or multiple, disjoint spans of text—in a text container.</span></span> <span data-ttu-id="bb285-131">Один метод **итекстпровидер** получает текстовый диапазон, представляющий весь документ, а другие запрашивают диапазоны текста, представляющие некоторую часть документа, например выделенный текст, видимый текст или объект, внедренный в текст.</span><span class="sxs-lookup"><span data-stu-id="bb285-131">One **ITextProvider** method acquires a text range that represents the entire document, while others acquire text ranges that represent some portion of the document, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="bb285-132">Объект текстового диапазона представлен шаблоном элемента управления **TextRange** , который реализуется через интерфейс [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="bb285-132">A text range object is represented by the **TextRange** control pattern, which is implemented through the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span> <span data-ttu-id="bb285-133">Шаблон элемента управления **TextRange** предоставляет методы и свойства, используемые для предоставления сведений о тексте в диапазоне, перемещения конечных точек диапазона, выделения или девыделения текста, прокрутки диапазона на представление и т. д.</span><span class="sxs-lookup"><span data-stu-id="bb285-133">The **TextRange** control pattern provides methods and properties used to expose information about the text in the range, move the endpoints of the range, select or deselect text, scroll the range into view, and so on.</span></span>

<span data-ttu-id="bb285-134">Дополнительные сведения о шаблонах элементов управления **Text** и **TextRange** см. в разделе [Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого](uiauto-ui-automation-textpattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb285-134">For more information about the **Text** and **TextRange** control patterns, see [UI Automation Support for Textual Content](uiauto-ui-automation-textpattern-overview.md).</span></span>

<span data-ttu-id="bb285-135">Начиная с поставщиков Windows 8.1 может реализовать интерфейс [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="bb285-135">Starting with Windows 8.1 providers can implement the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span> <span data-ttu-id="bb285-136">Это позволяет вызывать контекстные меню, связанные с текстовым диапазоном.</span><span class="sxs-lookup"><span data-stu-id="bb285-136">This enables invoking context menus that are associated with a text range.</span></span> <span data-ttu-id="bb285-137">Это поддерживает такие сценарии, как Автозамена текста или выбор кандидатов редактора методов ввода (IME).</span><span class="sxs-lookup"><span data-stu-id="bb285-137">This supports scenarios such as text autocorrection or Input Method Editor (IME) candidate selection.</span></span>

<span data-ttu-id="bb285-138">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="bb285-138">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="bb285-139">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="bb285-139">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="bb285-140">Обязательные члены для **итекстпровидер**</span><span class="sxs-lookup"><span data-stu-id="bb285-140">Required Members for **ITextProvider**</span></span>](#required-members-for-itextprovider)
-   [<span data-ttu-id="bb285-141">Обязательные члены для **итекстранжепровидер**</span><span class="sxs-lookup"><span data-stu-id="bb285-141">Required Members for **ITextRangeProvider**</span></span>](#required-members-for-itextrangeprovider)
-   [<span data-ttu-id="bb285-142">Поддержка диапазонов текста</span><span class="sxs-lookup"><span data-stu-id="bb285-142">Supporting Text Ranges</span></span>](#supporting-text-ranges)
    -   [<span data-ttu-id="bb285-143">Управление текстовым диапазоном по единицам текста</span><span class="sxs-lookup"><span data-stu-id="bb285-143">Manipulating a Text Range by Text Unit</span></span>](#manipulating-a-text-range-by-text-unit)
    -   [<span data-ttu-id="bb285-144">Выбор текста в текстовом диапазоне</span><span class="sxs-lookup"><span data-stu-id="bb285-144">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
    -   [<span data-ttu-id="bb285-145">Получение текста из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="bb285-145">Acquiring Text from a Text Range</span></span>](#acquiring-text-from-a-text-range)
    -   [<span data-ttu-id="bb285-146">Реализация Шовконтекстмену</span><span class="sxs-lookup"><span data-stu-id="bb285-146">Implementing ShowContextMenu</span></span>](#implementing-showcontextmenu)
-   [<span data-ttu-id="bb285-147">Взаимодействие с системным курсором</span><span class="sxs-lookup"><span data-stu-id="bb285-147">Interoperability with the System Caret</span></span>](#interoperability-with-the-system-caret)
-   [<span data-ttu-id="bb285-148">См. также</span><span class="sxs-lookup"><span data-stu-id="bb285-148">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="bb285-149">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="bb285-149">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="bb285-150">При реализации шаблона элемента управления **Text** Обратите внимание на следующие правила и соглашения.</span><span class="sxs-lookup"><span data-stu-id="bb285-150">When implementing the **Text** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="bb285-151">Любой элемент управления, обеспечивающий доступ к тексту (например, ввод текста или выбор текста только для чтения), должен поддерживать шаблон элемента управления **Text** .</span><span class="sxs-lookup"><span data-stu-id="bb285-151">Any control that enables access to text (for example, entering text or selecting read-only text) should support the **Text** control pattern.</span></span>
-   <span data-ttu-id="bb285-152">Шаблон элемента управления **Text** можно использовать с любым элементом пользовательского интерфейса, который представляет текст, даже статическую метку для стандартного элемента управления "Кнопка".</span><span class="sxs-lookup"><span data-stu-id="bb285-152">The **Text** control pattern can be used with any UI element that presents text, even a static label on a standard button control.</span></span> <span data-ttu-id="bb285-153">Однако он не является обязательным для статических текстовых элементов управления, которые не могут быть выбраны или не имеют точки вставки.</span><span class="sxs-lookup"><span data-stu-id="bb285-153">However, it is not required on static text controls that cannot be selected or do not have an insertion point.</span></span>
-   <span data-ttu-id="bb285-154">Чтобы обеспечить полный доступ к тексту, элементы управления, реализующие [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) , также должны поддерживать интерфейс [**ивалуепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) .</span><span class="sxs-lookup"><span data-stu-id="bb285-154">To ensure that text is fully accessible, controls that implement [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) should also support the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface.</span></span> <span data-ttu-id="bb285-155">**Ивалуепровидер** дополняет **итекстпровидер** , предоставляя программный способ изменения текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-155">**IValueProvider** complements **ITextProvider** by providing a programmatic way to change the text.</span></span> <span data-ttu-id="bb285-156">Кроме того, она обеспечивает более высокую совместимость с клиентскими приложениями с поддержкой специальных возможностей, в том числе на основе устаревших технологий, таких как Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="bb285-156">It also offers greater compatibility with assistive technology client applications, including those based on legacy technologies such as Microsoft Active Accessibility.</span></span> <span data-ttu-id="bb285-157">При реализации обоих шаблонов элементов управления событие **TextChanged** ([**UIA \_ Text \_ текстчанжедевентид**](uiauto-event-ids.md)) и событие **аутоматионпропертичанжед** ([**UIA \_ аутоматионпропертичанжедевентид**](uiauto-event-ids.md)) эквивалентны для свойства **value** ([**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span><span class="sxs-lookup"><span data-stu-id="bb285-157">When both control patterns are implemented, the **TextChanged** event ([**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md)) and **AutomationPropertyChanged** event ([**UIA\_AutomationPropertyChangedEventId**](uiauto-event-ids.md)) are equivalent for the **Value** property ([**UIA\_ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span></span> <span data-ttu-id="bb285-158">Оба события должны поддерживаться.</span><span class="sxs-lookup"><span data-stu-id="bb285-158">Both events must be supported.</span></span>
-   <span data-ttu-id="bb285-159">Шаблон элемента управления **Text** поддерживает только один поток текста и одно окно просмотра для каждого элемента управления.</span><span class="sxs-lookup"><span data-stu-id="bb285-159">The **Text** control pattern supports only one stream of text and one viewport per control.</span></span> <span data-ttu-id="bb285-160">Если приложение предлагает несколько представлений документа в панелях, каждое представление (элемент управления) должно поддерживать [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) независимо друг от друга.</span><span class="sxs-lookup"><span data-stu-id="bb285-160">If the application offers multiple views of document in panes, each view (control) should support [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) independently.</span></span>
-   <span data-ttu-id="bb285-161">Метод [**итекстпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) noreturn может возвращать один текстовый диапазон, представляющий текущий выделенный текст.</span><span class="sxs-lookup"><span data-stu-id="bb285-161">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method may return a single text range representing the currently selected text.</span></span> <span data-ttu-id="bb285-162">Если элемент управления поддерживает выбор нескольких несмежных диапазонов текста **, метод WebMethod** должен возвращать массив, который содержит один интерфейс [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) для каждого выбранного фрагмента текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-162">If a control supports the selection of multiple, noncontiguous spans of text, the **GetSelection** method should return an array that contains one [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface for each selected span of text.</span></span>
-   <span data-ttu-id="bb285-163">Шаблон элемента управления **Text** представляет точку вставки в виде вырожденного (пустого) текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-163">The **Text** control pattern represents the insertion point as a degenerate (empty) text range.</span></span> <span data-ttu-id="bb285-164">Метод [**итекстпровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) noreturn должен возвращать вырожденный диапазон текста, если точка вставки существует, а текст не выбран.</span><span class="sxs-lookup"><span data-stu-id="bb285-164">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method should return a degenerate text range when the insertion point exists and no text is selected.</span></span> <span data-ttu-id="bb285-165">Дополнительные сведения см. [в разделе взаимодействие с системным курсором](#interoperability-with-the-system-caret).</span><span class="sxs-lookup"><span data-stu-id="bb285-165">For more information, see [Interoperability with the System Caret](#interoperability-with-the-system-caret).</span></span>
-   <span data-ttu-id="bb285-166">Метод [**итекстпровидер:: жетвисиблеранжес**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) может возвращать один текстовый диапазон, если непрерывный диапазон текста отображается в окне просмотра или может возвращать массив несвязанных текстовых диапазонов, представляющих несколько частично видимых строк текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-166">The [**ITextProvider::GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) method may return a single text range if a contiguous range of text is visible in the viewport, or it may return an array of disjoint text ranges representing multiple, partially visible lines of text.</span></span>
-   <span data-ttu-id="bb285-167">Метод [**итекстпровидер:: ранжефромчилд**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) должен возвращать вырожденный диапазон, если дочерний элемент не содержит текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-167">The [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method should return a degenerate range if the child element contains no text.</span></span> <span data-ttu-id="bb285-168">Поскольку внедренный объект может содержать текст, метод **ранжефромчилд** не всегда может возвращать вырожденный текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="bb285-168">Because an embedded object can include text, the **RangeFromChild** method may not always return a degenerate text range.</span></span> <span data-ttu-id="bb285-169">Дополнительные сведения см. в статье [как модель автоматизации пользовательского интерфейса предоставляет внедренные объекты](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb285-169">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>
-   <span data-ttu-id="bb285-170">Метод [**итекстпровидер:: ранжефромпоинт**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) выполняет проверку нажатия в области документа, используя указанные экранные координаты.</span><span class="sxs-lookup"><span data-stu-id="bb285-170">The [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method performs hit testing in the document area using the specified screen coordinates.</span></span> <span data-ttu-id="bb285-171">Результирующий диапазон текста должен соответствовать положению курсора или выделению, которое будет получено при щелчке расположения на указанных координатах экрана.</span><span class="sxs-lookup"><span data-stu-id="bb285-171">The resulting text range should be consistent with the insertion point or selection that would result from clicking the location at the specified screen coordinates.</span></span> <span data-ttu-id="bb285-172">Например, если изображение находится на заданных координатах экрана, то результирующий диапазон текста должен совпадать с текстовым диапазоном, который метод [**итекстпровидер:: ранжефромчилд**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) будет получать для изображения.</span><span class="sxs-lookup"><span data-stu-id="bb285-172">For example, if an image resides at the specified screen coordinates, the resulting text range should be the same as the text range that the [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method would acquire for the image.</span></span> <span data-ttu-id="bb285-173">Аналогично, если клиентское приложение запрашивает текстовый диапазон для расположения в центре курсора системы (точка вставки), результирующий диапазон текста должен совпадать с положением системного курсора.</span><span class="sxs-lookup"><span data-stu-id="bb285-173">Similarly, if a client application requests a text range for the location at the center of the system caret (the insertion point), the resulting text range should be the same as the system caret location.</span></span>
-   <span data-ttu-id="bb285-174">Свойство [**итекстпровидер::D окументранже**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) всегда должно предоставлять текстовый диапазон, включающий весь текст, поддерживаемый соответствующей реализацией [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) .</span><span class="sxs-lookup"><span data-stu-id="bb285-174">The [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property should always provide a text range that includes all of the text supported by the corresponding [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) implementation.</span></span>
-   <span data-ttu-id="bb285-175">Событие [**UIA \_ Text \_ текстчанжедевентид**](uiauto-event-ids.md) должно вызываться после любого изменения текста, даже если это изменение не отображается в окне просмотра.</span><span class="sxs-lookup"><span data-stu-id="bb285-175">The [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event must be raised after any text change occurs, even if the change is not visible in the viewport.</span></span> <span data-ttu-id="bb285-176">Например, поставщик должен вызывать событие, даже если пользователь вставит тот же текст над выделенным текстом.</span><span class="sxs-lookup"><span data-stu-id="bb285-176">For example, the provider should raise the event even if the user pastes the exact same text over the selected text.</span></span>
-   <span data-ttu-id="bb285-177">[**Текст UIA \_ \_ текстселектиончанжедевентид**](uiauto-event-ids.md) должен вызываться всякий раз, когда изменяется выборка текста или когда точка вставки (курсор) перемещается между текстом.</span><span class="sxs-lookup"><span data-stu-id="bb285-177">The [**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md) must be raised whenever the selection of text changes, or whenever the insertion point (caret) moves among the text.</span></span>

<span data-ttu-id="bb285-178">При реализации шаблона элемента управления **TextRange** Обратите внимание на следующие правила и соглашения.</span><span class="sxs-lookup"><span data-stu-id="bb285-178">When implementing the **TextRange** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="bb285-179">Все методы шаблона элемента управления **TextRange** должны выполнять текстовые операции независимо от состояния видимости текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-179">All methods of the **TextRange** control pattern should perform text operations regardless of the visibility state of the text.</span></span> <span data-ttu-id="bb285-180">Видимость текстового диапазона всегда может быть определена с помощью запроса атрибута « **скрытый** текст» ([**UIA \_ ишидденаттрибутеид**](uiauto-textattribute-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="bb285-180">The visibility of a text range can always be determined by querying the **IsHidden** text attribute ([**UIA\_IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span></span>
-   <span data-ttu-id="bb285-181">Если это возможно, поставщик должен гарантировать, что любые изменения текста, такие как удаления, вставки и перемещения, будут отражены в связанных объектах текстового диапазона (экземплярах интерфейса [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) ) и порождать событие [**UIA \_ Text \_ текстчанжедевентид**](uiauto-event-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="bb285-181">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range objects (instances of [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface) and raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event.</span></span> <span data-ttu-id="bb285-182">Клиенты могут использовать событие как подсказку для подтверждения редакционных изменений, внесенных в текст элемента управления.</span><span class="sxs-lookup"><span data-stu-id="bb285-182">Clients may use the event as a hint to confirm editorial changes made to the text of a control.</span></span>
-   <span data-ttu-id="bb285-183">Все объекты текстового диапазона, используемые методами [**итекстранжепровидер:: Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**компариндпоинтс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)и [**мовиндпоинтбиранже**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) , должны быть однорангами одной и той же реализации шаблона элемента управления **Text** .</span><span class="sxs-lookup"><span data-stu-id="bb285-183">All of the text range objects used by the [**ITextRangeProvider::Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints), and [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) methods must be peers of the same **Text** control pattern implementation.</span></span>
-   <span data-ttu-id="bb285-184">Хотя это и не обязательно, значение *претвал* , полученное методом [**Итекстранжепровидер:: компариндпоинтс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) , может указывать расстояние в символах [**( \_ символ текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)) между двумя конечными точками.</span><span class="sxs-lookup"><span data-stu-id="bb285-184">Although not required, the *pRetVal* value retrieved by the [**ITextRangeProvider::CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) method can indicate the distance, in characters ([**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), between the two endpoints.</span></span> <span data-ttu-id="bb285-185">Однако клиентские приложения не должны зависеть от точности *претвал* за пределами положительного или отрицательного значения.</span><span class="sxs-lookup"><span data-stu-id="bb285-185">However, client applications should not depend on the accuracy of *pRetVal* beyond its positive or negative value.</span></span>
-   <span data-ttu-id="bb285-186">Для методов [**итекстранжепровидер:: експандтоенклосингунит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)и [**мовиндпоинтбюнит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) необходимо тщательно рассмотреть указанную единицу текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-186">The [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), and [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) methods require careful consideration of the specified text unit.</span></span> <span data-ttu-id="bb285-187">Дополнительные сведения см. в разделе Управление параметром TextRange по текстовому блоку.</span><span class="sxs-lookup"><span data-stu-id="bb285-187">For more information, see Manipulating a TextRange by Text Unit.</span></span>
-   <span data-ttu-id="bb285-188">Требования к реализации, связанные с методами [**итекстранжепровидер:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**аддтоселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)и [**ремовефромселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) , см. в разделе выделение текста в текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="bb285-188">For implementation requirements related to the [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection), and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods, see Selecting Text in a Text Range.</span></span>
-   <span data-ttu-id="bb285-189">Методы [**итекстранжепровидер:: строки FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) и [**финдаттрибуте**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) выполняют поиск по одной совпадающей текстовой строке или текстовому атрибуту в обратном направлении.</span><span class="sxs-lookup"><span data-stu-id="bb285-189">The [**ITextRangeProvider::FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) and [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) methods search forward or backward for a single matching text string or text attribute.</span></span> <span data-ttu-id="bb285-190">Если совпадений не найдено, они должны вернуть **значение NULL** .</span><span class="sxs-lookup"><span data-stu-id="bb285-190">They should return **NULL** if no match is found.</span></span>
-   <span data-ttu-id="bb285-191">Метод [**итекстранжепровидер:: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) должен возвращать адрес, полученный от функции [**уиажетресерведмикседаттрибутевалуе**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) или [**уиажетресерведнотсуппортедвалуе**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) , если связанный атрибут изменяется в диапазоне или если атрибут не поддерживается элементом управления "текст".</span><span class="sxs-lookup"><span data-stu-id="bb285-191">The [**ITextRangeProvider::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method must return the address acquired from the [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) or [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) function if the associated attribute varies in the range, or if the attribute is not supported by the text control.</span></span> <span data-ttu-id="bb285-192">Спецификация шаблона элемента управления **TextRange** не позволяет добавлять новые идентификаторы атрибутов текста или изменять способ определения существующих атрибутов.</span><span class="sxs-lookup"><span data-stu-id="bb285-192">The **TextRange** control pattern specification does not allow adding new text-attribute identifiers or changing how the existing attributes are defined.</span></span>
-   <span data-ttu-id="bb285-193">Если это возможно, метод [**итекстранжепровидер:: жетбаундингректанглес**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) должен возвращать массив, который содержит один ограничивающий прямоугольник для каждой полностью или частично видимой строки текста в текстовом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="bb285-193">If possible, the [**ITextRangeProvider::GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) method should return an array that contains one bounding rectangle for each fully or partially visible line of text in a text range.</span></span> <span data-ttu-id="bb285-194">Если это невозможно, поставщик может возвратить массив, содержащий ограничивающие прямоугольники только полностью видимых строк. Однако это ограничивает способность клиентского приложения точно описать, как текст отображается на экране.</span><span class="sxs-lookup"><span data-stu-id="bb285-194">If this is not possible, the provider can return an array that contains the bounding rectangles of only fully visible lines; however, this limits a client application's ability to accurately describe how the text is being presented on the screen.</span></span>
-   <span data-ttu-id="bb285-195">Метод [**итекстранжепровидер::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) Child должен возвращать все дочерние элементы, внедренные в текстовый диапазон, но не требуется возвращать дочерние элементы дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="bb285-195">The [**ITextRangeProvider::GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method should return all child elements embedded in a text range, but it does not need to return any children of the child elements.</span></span> <span data-ttu-id="bb285-196">Например, если текстовый диапазон содержит таблицу с числом дочерних ячеек, метод **дочернего** элемента может вернуть только элемент Table, а не элементы ячейки.</span><span class="sxs-lookup"><span data-stu-id="bb285-196">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method may return just the table element and not the cell elements.</span></span> <span data-ttu-id="bb285-197">В целях повышения производительности или архитектуры поставщик может не иметь возможности предоставлять все внедренные объекты, размещенные в документе в дереве автоматизации.</span><span class="sxs-lookup"><span data-stu-id="bb285-197">For performance or architectural reasons, a provider may not be able to expose all embedded objects that are hosted in a document in the automation tree.</span></span> <span data-ttu-id="bb285-198">В этом случае поставщик должен по крайней мере поддерживать перечисление дочерних объектов через метод **Children** и, как вариант, поддерживать шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) для поддержки отмены виртуализации.</span><span class="sxs-lookup"><span data-stu-id="bb285-198">In this case, the provider should at least support the enumerating of child objects through the **GetChildren** method and, as an option, support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern for de-virtualization support.</span></span>
-   <span data-ttu-id="bb285-199">Метод [**итекстранжепровидер:: жетенклосинжелемент**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) обычно возвращает поставщик текста, который предоставляет текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="bb285-199">The [**ITextRangeProvider::GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) method typically returns the text provider that supplies the text range.</span></span> <span data-ttu-id="bb285-200">Однако если поставщик текста поддерживает дочерние объекты, такие как таблицы или гиперссылки, то этот элемент может быть потомком поставщика текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-200">However, if the text provider supports child objects such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span> <span data-ttu-id="bb285-201">Элемент, возвращаемый функцией **жетенклосинжелемент** , должен быть ближайшим к заданному текстовому диапазону.</span><span class="sxs-lookup"><span data-stu-id="bb285-201">The element returned by **GetEnclosingElement** should be the element closest to the given text range.</span></span> <span data-ttu-id="bb285-202">Например, если текстовый диапазон находится в ячейке таблицы, **жетенклосинжелемент** должен возвращать содержащуюся ячейку вместо элемента table.</span><span class="sxs-lookup"><span data-stu-id="bb285-202">For example, if the text range is in a cell of a table, **GetEnclosingElement** should return the containing cell instead of the table element.</span></span>
-   <span data-ttu-id="bb285-203">Метод [**итекстранжепровидер:: GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) должен возвращать обычный текст в диапазоне.</span><span class="sxs-lookup"><span data-stu-id="bb285-203">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text in the range.</span></span> <span data-ttu-id="bb285-204">Дополнительные сведения см. в разделе Получение текста из текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-204">For more information, see Acquiring Text from a Text Range.</span></span>
-   <span data-ttu-id="bb285-205">Вызов [**итекстранжепровидер:: скроллинтовиев**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) должен выровняйте текст в окне просмотра текстового элемента управления, как указано в параметре *алигнтотоп* .</span><span class="sxs-lookup"><span data-stu-id="bb285-205">Calling [**ITextRangeProvider::ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) should align the text in the viewport of the text control as specified by the *alignToTop* parameter.</span></span> <span data-ttu-id="bb285-206">Хотя в условиях горизонтального выравнивания нет необходимости, текстовый диапазон должен быть видимым как по горизонтали, так и по вертикали.</span><span class="sxs-lookup"><span data-stu-id="bb285-206">Although there is no requirement in terms of horizontal alignment, the text range should be visible both horizontally and vertically.</span></span> <span data-ttu-id="bb285-207">При оценке параметра *алигнтотоп* поставщик должен учитывать ориентацию текстового элемента управления и направление потока текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-207">When evaluating the *alignToTop* parameter, a provider must take into account the orientation of the text control and the flow direction of the text.</span></span> <span data-ttu-id="bb285-208">Например, если *алигнтотоп* имеет **значение true** для вертикально ориентированного текстового элемента управления, содержащего текст, который передается справа налево, поставщик должен выравнивать текстовый диапазон с правой стороны окна просмотра.</span><span class="sxs-lookup"><span data-stu-id="bb285-208">For example, if *alignToTop* is **TRUE** for a vertically oriented text control containing text that flows from right to left, the provider should align the text range with the right side of the viewport.</span></span>
-   <span data-ttu-id="bb285-209">При перемещении по документу по [**текстунит \_ строке**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), если текстовый диапазон входит в внедренную таблицу, каждая строка текста в ячейке должна рассматриваться как линия.</span><span class="sxs-lookup"><span data-stu-id="bb285-209">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="required-members-for-itextprovider"></a><span data-ttu-id="bb285-210">Обязательные члены для **итекстпровидер**</span><span class="sxs-lookup"><span data-stu-id="bb285-210">Required Members for **ITextProvider**</span></span>

<span data-ttu-id="bb285-211">Для реализации интерфейса [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) требуются следующие свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="bb285-211">The following properties and methods are required for implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface.</span></span>



| <span data-ttu-id="bb285-212">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="bb285-212">Required members</span></span>                                                                                        | <span data-ttu-id="bb285-213">Тип члена</span><span class="sxs-lookup"><span data-stu-id="bb285-213">Member type</span></span> | <span data-ttu-id="bb285-214">Примечания</span><span class="sxs-lookup"><span data-stu-id="bb285-214">Notes</span></span> |
|---------------------------------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="bb285-215">**DocumentRange**</span><span class="sxs-lookup"><span data-stu-id="bb285-215">**DocumentRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)                                             | <span data-ttu-id="bb285-216">Свойство</span><span class="sxs-lookup"><span data-stu-id="bb285-216">Property</span></span>    | <span data-ttu-id="bb285-217">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-217">None</span></span>  |
| [<span data-ttu-id="bb285-218">**суппортедтекстселектион**</span><span class="sxs-lookup"><span data-stu-id="bb285-218">**SupportedTextSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)                           | <span data-ttu-id="bb285-219">Свойство</span><span class="sxs-lookup"><span data-stu-id="bb285-219">Property</span></span>    | <span data-ttu-id="bb285-220">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-220">None</span></span>  |
| [<span data-ttu-id="bb285-221">**Выборка**</span><span class="sxs-lookup"><span data-stu-id="bb285-221">**GetSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)                                               | <span data-ttu-id="bb285-222">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-222">Method</span></span>      | <span data-ttu-id="bb285-223">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-223">None</span></span>  |
| [<span data-ttu-id="bb285-224">**жетвисиблеранжес**</span><span class="sxs-lookup"><span data-stu-id="bb285-224">**GetVisibleRanges**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)                                       | <span data-ttu-id="bb285-225">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-225">Method</span></span>      | <span data-ttu-id="bb285-226">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-226">None</span></span>  |
| [<span data-ttu-id="bb285-227">**ранжефромчилд**</span><span class="sxs-lookup"><span data-stu-id="bb285-227">**RangeFromChild**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild)                                           | <span data-ttu-id="bb285-228">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-228">Method</span></span>      | <span data-ttu-id="bb285-229">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-229">None</span></span>  |
| [<span data-ttu-id="bb285-230">**ранжефромпоинт**</span><span class="sxs-lookup"><span data-stu-id="bb285-230">**RangeFromPoint**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)                                           | <span data-ttu-id="bb285-231">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-231">Method</span></span>      | <span data-ttu-id="bb285-232">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-232">None</span></span>  |
| [<span data-ttu-id="bb285-233">**\_Текстовая \_ ТЕКСТЧАНЖЕДЕВЕНТИДа UIA**</span><span class="sxs-lookup"><span data-stu-id="bb285-233">**UIA\_Text\_TextChangedEventId**</span></span>](uiauto-event-ids.md)                   | <span data-ttu-id="bb285-234">Событие</span><span class="sxs-lookup"><span data-stu-id="bb285-234">Event</span></span>       | <span data-ttu-id="bb285-235">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-235">None</span></span>  |
| [<span data-ttu-id="bb285-236">**\_Текстовая \_ ТЕКСТСЕЛЕКТИОНЧАНЖЕДЕВЕНТИДа UIA**</span><span class="sxs-lookup"><span data-stu-id="bb285-236">**UIA\_Text\_TextSelectionChangedEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="bb285-237">Событие</span><span class="sxs-lookup"><span data-stu-id="bb285-237">Event</span></span>       | <span data-ttu-id="bb285-238">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-238">None</span></span>  |



 

<span data-ttu-id="bb285-239">Для реализации интерфейса [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) требуются следующие дополнительные свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="bb285-239">The following additional properties and methods are required for implementing the [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interface.</span></span>



| <span data-ttu-id="bb285-240">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="bb285-240">Required members</span></span>                                                         | <span data-ttu-id="bb285-241">Тип члена</span><span class="sxs-lookup"><span data-stu-id="bb285-241">Member type</span></span> | <span data-ttu-id="bb285-242">Примечания</span><span class="sxs-lookup"><span data-stu-id="bb285-242">Notes</span></span> |
|--------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="bb285-243">**жеткаретранже**</span><span class="sxs-lookup"><span data-stu-id="bb285-243">**GetCaretRange**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange)         | <span data-ttu-id="bb285-244">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-244">Method</span></span>      | <span data-ttu-id="bb285-245">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-245">None</span></span>  |
| [<span data-ttu-id="bb285-246">**ранжефроманнотатион**</span><span class="sxs-lookup"><span data-stu-id="bb285-246">**RangeFromAnnotation**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) | <span data-ttu-id="bb285-247">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-247">Method</span></span>      | <span data-ttu-id="bb285-248">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-248">None</span></span>  |



 

## <a name="required-members-for-itextrangeprovider"></a><span data-ttu-id="bb285-249">Обязательные члены для **итекстранжепровидер**</span><span class="sxs-lookup"><span data-stu-id="bb285-249">Required Members for **ITextRangeProvider**</span></span>

<span data-ttu-id="bb285-250">Для реализации интерфейса [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) требуются следующие свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="bb285-250">The following properties and methods are required for implementing the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span>



| <span data-ttu-id="bb285-251">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="bb285-251">Required members</span></span>                                                                 | <span data-ttu-id="bb285-252">Тип члена</span><span class="sxs-lookup"><span data-stu-id="bb285-252">Member type</span></span> | <span data-ttu-id="bb285-253">Примечания</span><span class="sxs-lookup"><span data-stu-id="bb285-253">Notes</span></span> |
|----------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="bb285-254">**аддтоселектион**</span><span class="sxs-lookup"><span data-stu-id="bb285-254">**AddToSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)               | <span data-ttu-id="bb285-255">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-255">Method</span></span>      | <span data-ttu-id="bb285-256">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-256">None</span></span>  |
| [<span data-ttu-id="bb285-257">**Клонировать**</span><span class="sxs-lookup"><span data-stu-id="bb285-257">**Clone**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-clone)                                 | <span data-ttu-id="bb285-258">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-258">Method</span></span>      | <span data-ttu-id="bb285-259">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-259">None</span></span>  |
| [<span data-ttu-id="bb285-260">**Сравнение**</span><span class="sxs-lookup"><span data-stu-id="bb285-260">**Compare**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)                             | <span data-ttu-id="bb285-261">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-261">Method</span></span>      | <span data-ttu-id="bb285-262">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-262">None</span></span>  |
| [<span data-ttu-id="bb285-263">**компариндпоинтс**</span><span class="sxs-lookup"><span data-stu-id="bb285-263">**CompareEndpoints**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)           | <span data-ttu-id="bb285-264">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-264">Method</span></span>      | <span data-ttu-id="bb285-265">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-265">None</span></span>  |
| [<span data-ttu-id="bb285-266">**експандтоенклосингунит**</span><span class="sxs-lookup"><span data-stu-id="bb285-266">**ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) | <span data-ttu-id="bb285-267">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-267">Method</span></span>      | <span data-ttu-id="bb285-268">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-268">None</span></span>  |
| [<span data-ttu-id="bb285-269">**FindAttribute**</span><span class="sxs-lookup"><span data-stu-id="bb285-269">**FindAttribute**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)                 | <span data-ttu-id="bb285-270">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-270">Method</span></span>      | <span data-ttu-id="bb285-271">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-271">None</span></span>  |
| [<span data-ttu-id="bb285-272">**Строки FindText**</span><span class="sxs-lookup"><span data-stu-id="bb285-272">**FindText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)                           | <span data-ttu-id="bb285-273">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-273">Method</span></span>      | <span data-ttu-id="bb285-274">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-274">None</span></span>  |
| [<span data-ttu-id="bb285-275">**GetAttributeValue**</span><span class="sxs-lookup"><span data-stu-id="bb285-275">**GetAttributeValue**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue)         | <span data-ttu-id="bb285-276">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-276">Method</span></span>      | <span data-ttu-id="bb285-277">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-277">None</span></span>  |
| [<span data-ttu-id="bb285-278">**жетбаундингректанглес**</span><span class="sxs-lookup"><span data-stu-id="bb285-278">**GetBoundingRectangles**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) | <span data-ttu-id="bb285-279">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-279">Method</span></span>      | <span data-ttu-id="bb285-280">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-280">None</span></span>  |
| [<span data-ttu-id="bb285-281">**GetChildren**</span><span class="sxs-lookup"><span data-stu-id="bb285-281">**GetChildren**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)                     | <span data-ttu-id="bb285-282">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-282">Method</span></span>      | <span data-ttu-id="bb285-283">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-283">None</span></span>  |
| [<span data-ttu-id="bb285-284">**жетенклосинжелемент**</span><span class="sxs-lookup"><span data-stu-id="bb285-284">**GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)     | <span data-ttu-id="bb285-285">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-285">Method</span></span>      | <span data-ttu-id="bb285-286">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-286">None</span></span>  |
| [<span data-ttu-id="bb285-287">**GetText**</span><span class="sxs-lookup"><span data-stu-id="bb285-287">**GetText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)                             | <span data-ttu-id="bb285-288">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-288">Method</span></span>      | <span data-ttu-id="bb285-289">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-289">None</span></span>  |
| [<span data-ttu-id="bb285-290">**Переместить**</span><span class="sxs-lookup"><span data-stu-id="bb285-290">**Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)                                   | <span data-ttu-id="bb285-291">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-291">Method</span></span>      | <span data-ttu-id="bb285-292">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-292">None</span></span>  |
| [<span data-ttu-id="bb285-293">**мовиндпоинтбюнит**</span><span class="sxs-lookup"><span data-stu-id="bb285-293">**MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)       | <span data-ttu-id="bb285-294">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-294">Method</span></span>      | <span data-ttu-id="bb285-295">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-295">None</span></span>  |
| [<span data-ttu-id="bb285-296">**мовиндпоинтбиранже**</span><span class="sxs-lookup"><span data-stu-id="bb285-296">**MoveEndpointByRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)     | <span data-ttu-id="bb285-297">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-297">Method</span></span>      | <span data-ttu-id="bb285-298">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-298">None</span></span>  |
| [<span data-ttu-id="bb285-299">**Метьте**</span><span class="sxs-lookup"><span data-stu-id="bb285-299">**Select**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)                               | <span data-ttu-id="bb285-300">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-300">Method</span></span>      | <span data-ttu-id="bb285-301">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-301">None</span></span>  |
| [<span data-ttu-id="bb285-302">**скроллинтовиев**</span><span class="sxs-lookup"><span data-stu-id="bb285-302">**ScrollIntoView**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview)               | <span data-ttu-id="bb285-303">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-303">Method</span></span>      | <span data-ttu-id="bb285-304">Нет</span><span class="sxs-lookup"><span data-stu-id="bb285-304">None</span></span>  |



 

<span data-ttu-id="bb285-305">Для реализации интерфейса [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) требуются следующие дополнительные свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="bb285-305">The following additional properties and methods are required for implementing the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span>



| <span data-ttu-id="bb285-306">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="bb285-306">Required members</span></span>                                                      | <span data-ttu-id="bb285-307">Тип члена</span><span class="sxs-lookup"><span data-stu-id="bb285-307">Member type</span></span> | <span data-ttu-id="bb285-308">Примечания</span><span class="sxs-lookup"><span data-stu-id="bb285-308">Notes</span></span>                                      |
|-----------------------------------------------------------------------|-------------|--------------------------------------------|
| [<span data-ttu-id="bb285-309">**ShowContextMenu**</span><span class="sxs-lookup"><span data-stu-id="bb285-309">**ShowContextMenu**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) | <span data-ttu-id="bb285-310">Метод</span><span class="sxs-lookup"><span data-stu-id="bb285-310">Method</span></span>      | <span data-ttu-id="bb285-311">См. раздел "реализация Шовконтекстмену".</span><span class="sxs-lookup"><span data-stu-id="bb285-311">See "Implementing ShowContextMenu" section</span></span> |



 

<span data-ttu-id="bb285-312">Шаблон элемента управления **TextRange** не имеет связанных событий.</span><span class="sxs-lookup"><span data-stu-id="bb285-312">The **TextRange** control pattern has no associated events.</span></span>

## <a name="supporting-text-ranges"></a><span data-ttu-id="bb285-313">Поддержка диапазонов текста</span><span class="sxs-lookup"><span data-stu-id="bb285-313">Supporting Text Ranges</span></span>

<span data-ttu-id="bb285-314">В этом разделе описывается, как поставщик должен реализовать различные методы интерфейсов [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) и [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) для поддержки шаблона элемента управления **TextRange** .</span><span class="sxs-lookup"><span data-stu-id="bb285-314">This section describes how a provider should implement various methods of the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) and [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interfaces to support the **TextRange** control pattern.</span></span>

### <a name="manipulating-a-text-range-by-text-unit"></a><span data-ttu-id="bb285-315">Управление текстовым диапазоном по единицам текста</span><span class="sxs-lookup"><span data-stu-id="bb285-315">Manipulating a Text Range by Text Unit</span></span>

<span data-ttu-id="bb285-316">Интерфейс [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) предоставляет несколько методов для манипулирования текстовыми диапазонами и перемещения по ним в элементе управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-316">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="bb285-317">Методы [**итекстранжепровидер:: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**мовиндпоинтбюнит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)и [**експандтоенклосингунит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) перемещают текстовый диапазон или одну из его конечных точек на указанную единицу текста, например символ, слово, абзац и т. д.</span><span class="sxs-lookup"><span data-stu-id="bb285-317">The [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="bb285-318">Дополнительные сведения см. в разделе [единицы измерения текста модели автоматизации пользовательского интерфейса](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="bb285-318">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="bb285-319">Несмотря на свое имя, метод [**итекстранжепровидер:: експандтоенклосингунит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) не обязательно расширяет текстовый диапазон.</span><span class="sxs-lookup"><span data-stu-id="bb285-319">Despite its name, the [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="bb285-320">Вместо этого он нормализует текстовый диапазон, перемещая конечные точки, чтобы диапазон охватывает указанную единицу текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-320">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit.</span></span> <span data-ttu-id="bb285-321">Диапазон расширяется, если он меньше указанной единицы, или сокращен, если он превышает заданную единицу.</span><span class="sxs-lookup"><span data-stu-id="bb285-321">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="bb285-322">Очень важно, чтобы метод **експандтоенклосингунит** всегда выполнял нормализацию текстовых диапазонов согласованным образом. в противном случае другие аспекты обработки текстового диапазона по текстовому блоку будут непредсказуемыми.</span><span class="sxs-lookup"><span data-stu-id="bb285-322">It is critical that the **ExpandToEnclosingUnit** method always normalizes text ranges in a consistent manner; otherwise, other aspects of text range manipulation by text unit would be unpredictable.</span></span> <span data-ttu-id="bb285-323">На следующей схеме показано, как **експандтоенклосингунит** нормализует текстовый диапазон, перемещая конечные точки диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-323">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![Схема, показывающая позиции конечной точки текстового диапазона до и после вызова експандтоенклосингунит](images/expandtoenclosingunit.jpg)

<span data-ttu-id="bb285-325">Если текстовый диапазон начинается с начала текстового блока и заканчивается в начале (или до) следующей границы единицы текста, конечная точка перемещается на следующую границу единицы текста (см. 1 и 2 на предыдущей схеме).</span><span class="sxs-lookup"><span data-stu-id="bb285-325">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous diagram).</span></span>

<span data-ttu-id="bb285-326">Если текстовый диапазон начинается в начале текстового блока и заканчивается на единице (или после), конечная точка остается или перемещается назад на следующую границу единицы после начальной конечной точки (см. 3 и 4 на предыдущем рисунке).</span><span class="sxs-lookup"><span data-stu-id="bb285-326">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="bb285-327">Если между начальной и конечной конечными точками имеется более одной границы единицы текста, конечная точка перемещается назад к следующей границе единицы после начальной конечной точки, что приводит к подлине текстового диапазона, имеющего одну единицу текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-327">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="bb285-328">Если диапазон текста начинается в середине единицы текста, начальная конечная точка перемещается назад в начало текстового блока, а конечная конечная точка перемещается вперед или назад при необходимости на следующую границу единицы после начальной конечной точки (см. 5 – 8 на предыдущей схеме).</span><span class="sxs-lookup"><span data-stu-id="bb285-328">If the text range starts in a middle of the text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous diagram).</span></span>

<span data-ttu-id="bb285-329">При вызове метода [**итекстранжепровидер:: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) поставщик нормализует текстовый диапазон на заданную единицу текста, используя ту же логику нормализации, что и метод [**експандтоенклосингунит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) .</span><span class="sxs-lookup"><span data-stu-id="bb285-329">When the [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) method is called, the provider normalizes the text range by the specified text unit, using the same normalization logic as the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method.</span></span> <span data-ttu-id="bb285-330">Затем поставщик перемещает диапазон назад или вперед по заданному числу единиц текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-330">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="bb285-331">При перемещении диапазона поставщик должен игнорировать границы любых внедренных объектов в тексте.</span><span class="sxs-lookup"><span data-stu-id="bb285-331">When moving the range, the provider should ignore the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="bb285-332">(Однако сама граница единицы может зависеть от существования внедренного объекта).</span><span class="sxs-lookup"><span data-stu-id="bb285-332">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="bb285-333">На следующей схеме показано, как метод **Move** перемещает текстовый диапазон, единицу измерения между внедренными объектами и границами единиц текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-333">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![Диаграмма, показывающая, как метод Move перемещает конечные точки диапазона между объектами и границами единиц текста](images/move.jpg)

<span data-ttu-id="bb285-335">Метод [**итекстранжепровидер:: мовиндпоинтбюнит**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) перемещает одну из конечных точек вперед или назад по указанной единице текста, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="bb285-335">The [**ITextRangeProvider::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit, as the following illustration shows.</span></span>

![Диаграмма, показывающая, как мовиндпоинтбюнит перемещает конечную точку диапазона](images/moveendpointbyunit.gif)

<span data-ttu-id="bb285-337">Метод [**итекстранжепровидер:: мовиндпоинтбиранже**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) позволяет клиентскому приложению задать одну конечную точку текстового диапазона в том же расположении, что и указанная конечная точка второго текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-337">The [**ITextRangeProvider::MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

### <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="bb285-338">Выбор текста в текстовом диапазоне</span><span class="sxs-lookup"><span data-stu-id="bb285-338">Selecting Text in a Text Range</span></span>

<span data-ttu-id="bb285-339">Интерфейс [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) включает несколько методов для управления выделением текста в элементе управления на основе текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-339">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface includes several methods for controlling the selection of text in a text-based control.</span></span>

<span data-ttu-id="bb285-340">Метод [**итекстранжепровидер:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) должен выбрать текст, соответствующий диапазону текста, и удалить предыдущий выделенный фрагмент из элемента управления "текст".</span><span class="sxs-lookup"><span data-stu-id="bb285-340">The [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) method should select the text that corresponds to a text range, and remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="bb285-341">Если для вырожденного текстового диапазона вызывается **SELECT** , поставщик должен переместить точку вставки в расположение текстового диапазона без выбора текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-341">If **Select** is called on a degenerate text range, the provider should move the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="bb285-342">Если элемент управления поддерживает выделение нескольких необъединяемых диапазонов текста, методы [**итекстранжепровидер:: аддтоселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) и [**ремовефромселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) добавляют диапазоны текста в и удаляют их из коллекции выбранных текстовых диапазонов.</span><span class="sxs-lookup"><span data-stu-id="bb285-342">If a control supports the selection of multiple, disjoint spans of text, the [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="bb285-343">Если элемент управления поддерживает только один выбранный текстовый диапазон за раз, но операция выбора приведет к выбору нескольких необъединяемых текстовых диапазонов, поставщик должен либо вернуть ошибку **E \_ INVALIDOPERATION** , либо расширить или усечь текущий выделенный фрагмент.</span><span class="sxs-lookup"><span data-stu-id="bb285-343">If the control only supports one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the provider should either return an **E\_INVALIDOPERATION** error, or should extend or truncate the current selection.</span></span> <span data-ttu-id="bb285-344">Свойство [**итекстпровидер:: суппортедтекстселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) должно указывать, поддерживает ли элемент управления выделение одного или нескольких диапазонов текста или нет вообще.</span><span class="sxs-lookup"><span data-stu-id="bb285-344">The [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property should indicate whether a control supports the selection of single or multiple spans of text, or none at all.</span></span>

<span data-ttu-id="bb285-345">Если текстовый элемент управления поддерживает вставку текста, вызов [**итекстранжепровидер:: аддтоселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) или [**ремовефромселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) в диапазоне вырожденного текста в элементе управления должен переместить точку вставки, но не должен выбирать какой-либо текст.</span><span class="sxs-lookup"><span data-stu-id="bb285-345">If a text-based control supports text insertions, calling [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) on a degenerate text range in the control should move the insertion point but should not select any text.</span></span>

### <a name="acquiring-text-from-a-text-range"></a><span data-ttu-id="bb285-346">Получение текста из текстового диапазона</span><span class="sxs-lookup"><span data-stu-id="bb285-346">Acquiring Text from a Text Range</span></span>

<span data-ttu-id="bb285-347">Метод [**итекстранжепровидер:: GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) должен возвращать обычный текст текстового диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-347">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text of a text range.</span></span> <span data-ttu-id="bb285-348">Обычный текст должен включать все управляющие символы, найденные в исходном тексте, такие как возврат каретки и знак Юникода слева направо (ЛРМ).</span><span class="sxs-lookup"><span data-stu-id="bb285-348">The plain text should include all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="bb285-349">Обычный текст не должен содержать теги разметки, такие как HTML, которые могут присутствовать в исходном тексте.</span><span class="sxs-lookup"><span data-stu-id="bb285-349">The plain text should not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="bb285-350">Кроме того, все Escape-коды в исходном тексте должны быть преобразованы в эквиваленты обычного текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-350">Also, any escape codes in the source text should be converted to the plain text equivalents.</span></span> <span data-ttu-id="bb285-351">Например, " &nbsp; " следует преобразовать в простой символ пробела.</span><span class="sxs-lookup"><span data-stu-id="bb285-351">For example, "&nbsp;" should be converted to a simple space character.</span></span>

<span data-ttu-id="bb285-352">Если внедренный объект охватывает диапазон текста, в обычном тексте должен содержаться внутренний текст объекта, но не альтернативный текст (свойство Name внедренного объекта), так как он может не соответствовать описательному внутреннему тексту.</span><span class="sxs-lookup"><span data-stu-id="bb285-352">If an embedded object spans a range of text, the plain text should include the inner text of the object, but not the alternative text (the name property of the embedded object) because it might be inconsistent with the descriptive inner text.</span></span> <span data-ttu-id="bb285-353">Дополнительные сведения см. в статье [как модель автоматизации пользовательского интерфейса предоставляет внедренные объекты](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb285-353">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

### <a name="implementing-showcontextmenu"></a><span data-ttu-id="bb285-354">Реализация Шовконтекстмену</span><span class="sxs-lookup"><span data-stu-id="bb285-354">Implementing ShowContextMenu</span></span>

<span data-ttu-id="bb285-355">[**ITextRangeProvider2:: шовконтекстмену**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) должен всегда показывать контекстное меню в начальной конечной точке диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-355">[**ITextRangeProvider2::ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) should always show the context menu at the beginning end point of the range.</span></span> <span data-ttu-id="bb285-356">Это должно быть эквивалентно тому, что произойдет, если пользователь нажал на клавишу контекстного меню или SHIFT + F10 с точкой вставки в начале диапазона.</span><span class="sxs-lookup"><span data-stu-id="bb285-356">This should be equivalent to what would happen if the user pressed the context menu key or SHIFT + F10 with the insertion point at the beginning of the range.</span></span>

<span data-ttu-id="bb285-357">Если отображение контекстного меню обычно приводит к перемещению точки вставки в заданное место, то оно должно сделать это для программного вызова [**шовконтекстмену**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) для поддержки модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="bb285-357">If showing the context menu would typically result in the insertion point moving to a given location, then it should do so for programmatically invoking [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) for UI Automation support also.</span></span>

## <a name="interoperability-with-the-system-caret"></a><span data-ttu-id="bb285-358">Взаимодействие с системным курсором</span><span class="sxs-lookup"><span data-stu-id="bb285-358">Interoperability with the System Caret</span></span>

<span data-ttu-id="bb285-359">Правильная поддержка точки вставки важна для многих клиентских приложений, включая те, которые не основаны на автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="bb285-359">Correctly supporting the insertion point is critical to many client applications, including those not based on UI Automation.</span></span> <span data-ttu-id="bb285-360">В шаблоне элемента управления **Text** точка вставки представлена вырожденным (пустым) текстовым диапазоном в позиции системного курсора.</span><span class="sxs-lookup"><span data-stu-id="bb285-360">In the **Text** control pattern, the insertion point is represented by a degenerate (empty) text range at the position of the system caret.</span></span> <span data-ttu-id="bb285-361">Когда точка вставки будет перемещена, элемент управления должен вызвать событие **текстселектиончанжед** ([**UIA \_ Text \_ текстселектиончанжедевентид**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="bb285-361">When the insertion point moves, a control should raise the **TextSelectionChanged** event ([**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md)).</span></span> <span data-ttu-id="bb285-362">Некоторые клиентские приложения зависят от этого события, чтобы отслеживать положение курсора и отслеживать выделение текста.</span><span class="sxs-lookup"><span data-stu-id="bb285-362">Some client applications depend on this event to monitor the location of the insertion point, and to keep track of the text selection.</span></span>

<span data-ttu-id="bb285-363">Если элемент управления содержит выделенный текст, текущий дизайн шаблона элемента управления **Text** не предоставляет способа непосредственного связывания места вставки с определенным текстовым диапазоном.</span><span class="sxs-lookup"><span data-stu-id="bb285-363">When a control contains selected text, the current design of the **Text** control pattern does not provide a way to directly associate the location of the insertion point with a particular text range.</span></span> <span data-ttu-id="bb285-364">Поставщик должен отследить выбор текста и установить расположение точки вставки соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="bb285-364">The provider must keep track of the text selection and set the location of the insertion point appropriately.</span></span> <span data-ttu-id="bb285-365">Поскольку выбор текста обычно выполняется путем перемещения точки вставки, удерживая нажатой клавишу SHIFT или CTRL или и то и другое, поставщик может отнести выбор текста, проверив состояние этих ключей при каждом изменении выбора.</span><span class="sxs-lookup"><span data-stu-id="bb285-365">Because selecting text is typically done by moving the insertion point while holding down the SHIFT or CTRL key, or both, a provider can track the text selection by checking the state of these keys whenever the selection changes.</span></span>

<span data-ttu-id="bb285-366">Поскольку платформа специальных возможностей предоставляет встроенную поддержку системного курсора, но не для пользовательского курсора, элементы управления на основе текста должны по возможности использовать системный курсор.</span><span class="sxs-lookup"><span data-stu-id="bb285-366">Because the accessibility framework provides built-in support for the system caret but not for a custom caret, text-based controls should use the system caret whenever possible.</span></span> <span data-ttu-id="bb285-367">Элементы управления, использующие пользовательское курсор, могут обеспечить доступность курсора, создавая системную точку ввода, которая имеет те же размеры, что и пользовательское курсор, и размещая системную курсор в том же расположении в пользовательском интерфейсе элемента управления, что и пользовательское курсор — то есть в точке вставки.</span><span class="sxs-lookup"><span data-stu-id="bb285-367">Controls that use a custom caret can ensure that the caret is accessible by creating a system caret that has the same dimensions as the custom caret, and positioning the system caret at the same location in the UI of the control as the custom caret—that is, at the insertion point.</span></span> <span data-ttu-id="bb285-368">В качестве альтернативы элемент управления, использующий пользовательское курсор, может реализовать поставщик Active Accessibility Майкрософт [**для \_ курсора OBJID**](object-identifiers.md) , чтобы предоставить сведения о специальных возможностях непосредственно для пользовательского курсора.</span><span class="sxs-lookup"><span data-stu-id="bb285-368">As an alternative, a control that uses a custom caret can implement a Microsoft Active Accessibility provider for [**OBJID\_CARET**](object-identifiers.md) to provide accessibility information directly for your custom caret.</span></span>

<span data-ttu-id="bb285-369">Дополнительные сведения о системных курсорах см. в разделе символы [крышки](/windows/desktop/menurc/carets).</span><span class="sxs-lookup"><span data-stu-id="bb285-369">For more information about the system caret, see [Carets](/windows/desktop/menurc/carets).</span></span>

<span data-ttu-id="bb285-370">Чтобы проверить, правильно ли элемент управления предоставляет расположение курсора системы, используйте средства [отслеживания событий](accessible-event-watcher.md) для [проверки](inspect-objects.md) и доступности.</span><span class="sxs-lookup"><span data-stu-id="bb285-370">To test whether your control properly exposes the location of the system caret, use the [Inspect](inspect-objects.md) and [Accessible Event Watcher](accessible-event-watcher.md) tools.</span></span>

<span data-ttu-id="bb285-371">Экранные координаты центра точечного изображения курсора системы должны всегда соответствовать расположению точки вставки.</span><span class="sxs-lookup"><span data-stu-id="bb285-371">The screen coordinates of the center of the system caret bitmap should always match the location of the insertion point.</span></span> <span data-ttu-id="bb285-372">Таким образом, клиент может использовать координаты экрана курсора в вызове [**итекстпровидер:: ранжефромпоинт**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) для получения текстового диапазона, точно представляющего положение точки вставки.</span><span class="sxs-lookup"><span data-stu-id="bb285-372">That way, a client can use the caret screen coordinates in a call to [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) to retrieve a text range that accurately represents the location of the insertion point.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bb285-373">См. также</span><span class="sxs-lookup"><span data-stu-id="bb285-373">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bb285-374">Типы элементов управления и поддерживаемые ими шаблоны элементов управления</span><span class="sxs-lookup"><span data-stu-id="bb285-374">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="bb285-375">Тип элемента управления "текст"</span><span class="sxs-lookup"><span data-stu-id="bb285-375">Text Control Type</span></span>](uiauto-supporttextcontroltype.md)
</dt> <dt>

[<span data-ttu-id="bb285-376">Шаблон элемента управления также TextEdit</span><span class="sxs-lookup"><span data-stu-id="bb285-376">TextEdit Control Pattern</span></span>](textedit-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="bb285-377">Шаблон элемента управления Текстчилд</span><span class="sxs-lookup"><span data-stu-id="bb285-377">TextChild Control Pattern</span></span>](textchild-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="bb285-378">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="bb285-378">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="bb285-379">Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого</span><span class="sxs-lookup"><span data-stu-id="bb285-379">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="bb285-380">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="bb285-380">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 