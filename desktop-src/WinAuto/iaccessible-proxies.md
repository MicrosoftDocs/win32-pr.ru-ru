---
title: Прокси-серверы IAccessible
description: Прокси-серверы IAccessible предоставляют сведения о специальных возможностях по умолчанию для стандартных элементов пользовательского интерфейса, пользовательских меню и общих элементов управления из КОМКТЛ и COMCTL32.
ms.assetid: 236c2064-de44-4021-8825-f1519312dbfc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53dcb4cae8980e4003d9915c6783e4ddb043a8c8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338196"
---
# <a name="iaccessible-proxies"></a>Прокси-серверы IAccessible

Прокси-серверы [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) предоставляют сведения о специальных возможностях по умолчанию для стандартных элементов пользовательского интерфейса: пользовательские элементы управления, меню пользователей и общие элементы управления из КОМКТЛ и Comctl32. Эта поддержка по умолчанию предоставляется через объекты **IAccessible** , созданные Oleacc.dll и обеспечивает поддержку Microsoft Active Accessibility без дополнительных операций по разработке сервера. Сервер может использовать [динамический API аннотации](dynamic-annotation-api.md) для изменения большей части информации, предоставляемой Oleacc.dll, но не имеет полного контроля.

## <a name="creating-a-proxy"></a>Создание учетной записи-посредника

Чтобы определить, поддерживает ли элемент пользовательского интерфейса интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , Oleacc.dll отправляет его в сообщение [**WM \_ GetObject**](wm-getobject.md) . Ненулевое возвращаемое значение означает, что элемент изначально поддерживает Microsoft Active Accessibility и предоставляет собственную поддержку **IAccessible** . Однако если возвращаемое значение равно нулю, Oleacc.dll предоставляет прокси-объект для элемента пользовательского интерфейса и пытается вернуть значимую информацию от ее имени. Дополнительные сведения о **WM \_ GetObject** см. в статье [как \_ работает WM GetObject](how-wm-getobject-works.md).

## <a name="what-information-is-exposed"></a>Какие сведения предоставляются

Oleacc.dll использует имя класса Windows элемента пользовательского интерфейса, чтобы определить, какие сведения должны предоставляться для каждого из своих свойств [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , а также как получить эти сведения. Например, Oleacc.dll вызывает функцию [**жетвиндовтекст**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) , чтобы получить свойство [**Name**](name-property.md) для стандартной кнопки отправки, но вызывает эту же функцию для получения свойства [**value**](value-property.md) для стандартного элемента управления "поле ввода". Фактически Oleacc.dll сопоставляет каждый метод **IAccessible** с соответствующим сообщением Microsoft Win32 или конкретным элементом управления или вызовом функции. Используя особый регистр на основе имени класса, он может возвращать значимые сведения через прокси-серверы **IAccessible** без поддержки Microsoft Active Accessibility на сервере.

Приложения, созданные с помощью стандартных элементов пользовательского интерфейса, обычно получают полную поддержку Active Accessibility Майкрософт без дополнительных работ по разработке. Исключениями из этого правила являются элементы управления, которые были подклассами, которые не хранят собственные строки (отсутствие стиля **хасстрингс** ) или рисуются владельцем. В таких случаях Oleacc.dll не может собрать необходимые сведения, так как информация хранится за пределами элемента управления. Однако во многих из этих сценариев, установленных обходных путей или использовании динамической аннотации, сервер позволяет взаимодействовать с прокси-серверами, предоставляемыми Oleacc.dll.

## <a name="generic-proxy-objects"></a>Универсальные прокси-объекты

Если Oleacc.dll не распознает имя класса элемента пользовательского интерфейса, он создает универсальный прокси-сервер, который предоставляет как можно больше информации. В большинстве случаев это включает ограничивающий прямоугольник объекта, родительский объект, имя (от [**WM- \_ текста**](/windows/desktop/winmsg/wm-gettext)) и все дочерние элементы в иерархии окна.

 

 