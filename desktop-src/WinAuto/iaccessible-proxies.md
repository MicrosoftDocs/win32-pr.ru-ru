---
title: Прокси-серверы IAccessible
description: Прокси-серверы IAccessible предоставляют сведения о специальных возможностях по умолчанию для стандартных элементов пользовательского интерфейса, пользовательских меню и общих элементов управления из КОМКТЛ и COMCTL32.
ms.assetid: 236c2064-de44-4021-8825-f1519312dbfc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53dcb4cae8980e4003d9915c6783e4ddb043a8c8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338196"
---
# <a name="iaccessible-proxies"></a><span data-ttu-id="3168d-103">Прокси-серверы IAccessible</span><span class="sxs-lookup"><span data-stu-id="3168d-103">IAccessible Proxies</span></span>

<span data-ttu-id="3168d-104">Прокси-серверы [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) предоставляют сведения о специальных возможностях по умолчанию для стандартных элементов пользовательского интерфейса: пользовательские элементы управления, меню пользователей и общие элементы управления из КОМКТЛ и Comctl32.</span><span class="sxs-lookup"><span data-stu-id="3168d-104">[**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) proxies provide default accessibility information for standard UI elements: USER controls, USER menus, and common controls from COMCTL and COMCTL32.</span></span> <span data-ttu-id="3168d-105">Эта поддержка по умолчанию предоставляется через объекты **IAccessible** , созданные Oleacc.dll и обеспечивает поддержку Microsoft Active Accessibility без дополнительных операций по разработке сервера.</span><span class="sxs-lookup"><span data-stu-id="3168d-105">This default support is exposed through **IAccessible** objects created by Oleacc.dll and delivers Microsoft Active Accessibility support without additional server development work.</span></span> <span data-ttu-id="3168d-106">Сервер может использовать [динамический API аннотации](dynamic-annotation-api.md) для изменения большей части информации, предоставляемой Oleacc.dll, но не имеет полного контроля.</span><span class="sxs-lookup"><span data-stu-id="3168d-106">The server can then use the [Dynamic Annotation API](dynamic-annotation-api.md) to modify much of the information exposed by Oleacc.dll, but it does not have complete control.</span></span>

## <a name="creating-a-proxy"></a><span data-ttu-id="3168d-107">Создание учетной записи-посредника</span><span class="sxs-lookup"><span data-stu-id="3168d-107">Creating a Proxy</span></span>

<span data-ttu-id="3168d-108">Чтобы определить, поддерживает ли элемент пользовательского интерфейса интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , Oleacc.dll отправляет его в сообщение [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="3168d-108">To determine whether a UI element natively supports the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface, Oleacc.dll sends it a [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="3168d-109">Ненулевое возвращаемое значение означает, что элемент изначально поддерживает Microsoft Active Accessibility и предоставляет собственную поддержку **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="3168d-109">A nonzero return value means the element natively supports Microsoft Active Accessibility and provides its own **IAccessible** support.</span></span> <span data-ttu-id="3168d-110">Однако если возвращаемое значение равно нулю, Oleacc.dll предоставляет прокси-объект для элемента пользовательского интерфейса и пытается вернуть значимую информацию от ее имени.</span><span class="sxs-lookup"><span data-stu-id="3168d-110">However, if the return value is zero, Oleacc.dll provides a proxy object for the UI element and attempts to return meaningful information on its behalf.</span></span> <span data-ttu-id="3168d-111">Дополнительные сведения о **WM \_ GetObject** см. в статье [как \_ работает WM GetObject](how-wm-getobject-works.md).</span><span class="sxs-lookup"><span data-stu-id="3168d-111">For more information about **WM\_GETOBJECT**, see [How WM\_GETOBJECT Works](how-wm-getobject-works.md).</span></span>

## <a name="what-information-is-exposed"></a><span data-ttu-id="3168d-112">Какие сведения предоставляются</span><span class="sxs-lookup"><span data-stu-id="3168d-112">What Information Is Exposed</span></span>

<span data-ttu-id="3168d-113">Oleacc.dll использует имя класса Windows элемента пользовательского интерфейса, чтобы определить, какие сведения должны предоставляться для каждого из своих свойств [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , а также как получить эти сведения.</span><span class="sxs-lookup"><span data-stu-id="3168d-113">Oleacc.dll uses the UI element's Windows class name to determine what information should be exposed for each of its [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties and how to collect that information.</span></span> <span data-ttu-id="3168d-114">Например, Oleacc.dll вызывает функцию [**жетвиндовтекст**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) , чтобы получить свойство [**Name**](name-property.md) для стандартной кнопки отправки, но вызывает эту же функцию для получения свойства [**value**](value-property.md) для стандартного элемента управления "поле ввода".</span><span class="sxs-lookup"><span data-stu-id="3168d-114">For example, Oleacc.dll calls the [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) function to retrieve the [**Name**](name-property.md) property for a standard push button, but calls this same function to retrieve the [**Value**](value-property.md) property for a standard edit control.</span></span> <span data-ttu-id="3168d-115">Фактически Oleacc.dll сопоставляет каждый метод **IAccessible** с соответствующим сообщением Microsoft Win32 или конкретным элементом управления или вызовом функции.</span><span class="sxs-lookup"><span data-stu-id="3168d-115">In effect, Oleacc.dll is mapping each **IAccessible** method to an appropriate Microsoft Win32 or control-specific message or function call.</span></span> <span data-ttu-id="3168d-116">Используя особый регистр на основе имени класса, он может возвращать значимые сведения через прокси-серверы **IAccessible** без поддержки Microsoft Active Accessibility на сервере.</span><span class="sxs-lookup"><span data-stu-id="3168d-116">By using this class name-based special casing, it can return meaningful information through **IAccessible** proxies without any Microsoft Active Accessibility support in the server.</span></span>

<span data-ttu-id="3168d-117">Приложения, созданные с помощью стандартных элементов пользовательского интерфейса, обычно получают полную поддержку Active Accessibility Майкрософт без дополнительных работ по разработке.</span><span class="sxs-lookup"><span data-stu-id="3168d-117">Applications built with standard UI elements typically get full Microsoft Active Accessibility support without additional development work.</span></span> <span data-ttu-id="3168d-118">Исключениями из этого правила являются элементы управления, которые были подклассами, которые не хранят собственные строки (отсутствие стиля **хасстрингс** ) или рисуются владельцем.</span><span class="sxs-lookup"><span data-stu-id="3168d-118">The exceptions to this rule are controls that have been subclassed, that do not store their own strings (absence of the **HASSTRINGS** style), or that are owner-drawn.</span></span> <span data-ttu-id="3168d-119">В таких случаях Oleacc.dll не может собрать необходимые сведения, так как информация хранится за пределами элемента управления.</span><span class="sxs-lookup"><span data-stu-id="3168d-119">In these cases, Oleacc.dll cannot gather the information it needs because the information is stored outside the control.</span></span> <span data-ttu-id="3168d-120">Однако во многих из этих сценариев, установленных обходных путей или использовании динамической аннотации, сервер позволяет взаимодействовать с прокси-серверами, предоставляемыми Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="3168d-120">However in many of these scenarios, established workarounds, or the use of Dynamic Annotation, allow the server to cooperate with the proxies provided by Oleacc.dll.</span></span>

## <a name="generic-proxy-objects"></a><span data-ttu-id="3168d-121">Универсальные прокси-объекты</span><span class="sxs-lookup"><span data-stu-id="3168d-121">Generic Proxy Objects</span></span>

<span data-ttu-id="3168d-122">Если Oleacc.dll не распознает имя класса элемента пользовательского интерфейса, он создает универсальный прокси-сервер, который предоставляет как можно больше информации.</span><span class="sxs-lookup"><span data-stu-id="3168d-122">If Oleacc.dll does not recognize the class name of the UI element, it creates a generic proxy that exposes as much information as possible.</span></span> <span data-ttu-id="3168d-123">В большинстве случаев это включает ограничивающий прямоугольник объекта, родительский объект, имя (от [**WM- \_ текста**](/windows/desktop/winmsg/wm-gettext)) и все дочерние элементы в иерархии окна.</span><span class="sxs-lookup"><span data-stu-id="3168d-123">At most, this includes the object's bounding rectangle, parent object, name (from [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext)), and any children in the window hierarchy.</span></span>

 

 