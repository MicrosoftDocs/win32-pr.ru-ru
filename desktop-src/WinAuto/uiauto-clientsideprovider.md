---
title: Реализация поставщика автоматизации пользовательского интерфейса Client-Side (прокси)
description: В этом разделе описывается, как создать поставщик прокси для неподдерживаемого элемента управления и добавить его в список прокси-серверов, используемых клиентскими приложениями.
ms.assetid: c66f4a7b-0a12-4c65-a3e9-1c826d54ac6b
keywords:
- Модель автоматизации пользовательского интерфейса, реализация поставщика на стороне клиента
- Автоматизация пользовательского интерфейса, реализация поставщика
- Модель автоматизации пользовательского интерфейса, реализация поставщиков на стороне клиента
- Модель автоматизации пользовательского интерфейса, реализация поставщиков
- Модель автоматизации пользовательского интерфейса, прокси
- proxies
- поставщики на стороне клиента
- поставщики, реализация
- Реализация поставщиков на стороне клиента
- реализация поставщиков
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e2bdb4a94ba6e693792508de5c573317299b0d3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070092"
---
# <a name="implementing-a-client-side-proxy-ui-automation-provider"></a><span data-ttu-id="4fe93-113">Реализация поставщика автоматизации пользовательского интерфейса Client-Side (прокси)</span><span class="sxs-lookup"><span data-stu-id="4fe93-113">Implementing a Client-Side (Proxy) UI Automation Provider</span></span>

<span data-ttu-id="4fe93-114">Модель автоматизации пользовательского интерфейса Майкрософт предоставляет набор прокси-серверов для большинства стандартных элементов управления, например используемых в приложениях Microsoft Win32, Windows Forms и Windows Presentation Foundation (WPF).</span><span class="sxs-lookup"><span data-stu-id="4fe93-114">Microsoft UI Automation supplies a set of proxies for most standard controls, such as those used in Microsoft Win32, Windows Forms, and Windows Presentation Foundation (WPF) applications.</span></span> <span data-ttu-id="4fe93-115">Однако многие пользовательские элементы управления и сторонние элементы управления не реализуют собственные поставщики автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4fe93-115">However, many custom controls and third party controls do not implement native UI Automation providers.</span></span> <span data-ttu-id="4fe93-116">Для доступа к клиентским приложениям модели автоматизации пользовательского интерфейса эти элементы управления должны предоставляться поставщикам на стороне клиента, которые также называются *поставщиками прокси-сервера* *или прокси*.</span><span class="sxs-lookup"><span data-stu-id="4fe93-116">To be accessible to UI Automation client applications, these controls must be furnished with client-side providers, also known as *proxy providers*, or *proxies*.</span></span>

<span data-ttu-id="4fe93-117">В этом разделе описывается, как создать поставщик прокси для неподдерживаемого элемента управления и добавить его в список прокси-серверов, используемых клиентскими приложениями.</span><span class="sxs-lookup"><span data-stu-id="4fe93-117">This topic describes how to write a proxy provider for an unsupported control and add it to the list of proxies used by client applications.</span></span> <span data-ttu-id="4fe93-118">Руководство состоит из таких разделов:</span><span class="sxs-lookup"><span data-stu-id="4fe93-118">It includes the following topics:</span></span>

-   [<span data-ttu-id="4fe93-119">Что такое прокси?</span><span class="sxs-lookup"><span data-stu-id="4fe93-119">What is a Proxy?</span></span>](#what-is-a-proxy)
-   [<span data-ttu-id="4fe93-120">Что такое фабрика прокси-серверов?</span><span class="sxs-lookup"><span data-stu-id="4fe93-120">What is a Proxy Factory?</span></span>](#what-is-a-proxy-factory)
-   [<span data-ttu-id="4fe93-121">Сопоставление фабрики прокси-серверов</span><span class="sxs-lookup"><span data-stu-id="4fe93-121">Proxy Factory Mapping</span></span>](#proxy-factory-mapping)
-   [<span data-ttu-id="4fe93-122">Управление прокси-серверами по умолчанию</span><span class="sxs-lookup"><span data-stu-id="4fe93-122">Managing Default Proxies</span></span>](#managing-default-proxies)
-   [<span data-ttu-id="4fe93-123">См. также</span><span class="sxs-lookup"><span data-stu-id="4fe93-123">Related topics</span></span>](#related-topics)

<span data-ttu-id="4fe93-124">Примеры кода, демонстрирующие способы реализации поставщиков прокси-сервера, см. [в разделах с инструкциями по поставщикам автоматизации пользовательского интерфейса](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="4fe93-124">For code examples that show how to implement proxy providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="what-is-a-proxy"></a><span data-ttu-id="4fe93-125">Что такое прокси?</span><span class="sxs-lookup"><span data-stu-id="4fe93-125">What is a Proxy?</span></span>

<span data-ttu-id="4fe93-126">Поставщик на стороне клиента или прокси-сервер — это объект, реализующий интерфейс [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) от имени элемента управления, который не имеет собственной реализации **иравелементпровидерсимпле** .</span><span class="sxs-lookup"><span data-stu-id="4fe93-126">A client-side provider, or proxy, is an object that implements the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface on behalf of a control that does not have an **IRawElementProviderSimple** implementation of its own.</span></span> <span data-ttu-id="4fe93-127">Без прокси-сервера такой элемент управления в значительной степени непрозрачен для автоматизации пользовательского интерфейса, который может предоставлять только основные сведения, доступные из дескриптора окна (**HWND**), например расположения элемента управления.</span><span class="sxs-lookup"><span data-stu-id="4fe93-127">Without a proxy, such a control is largely opaque to UI Automation, which can supply only basic information available from the window handle (**HWND**), such as the control location.</span></span>

## <a name="what-is-a-proxy-factory"></a><span data-ttu-id="4fe93-128">Что такое фабрика прокси-серверов?</span><span class="sxs-lookup"><span data-stu-id="4fe93-128">What is a Proxy Factory?</span></span>

<span data-ttu-id="4fe93-129">Для каждого прокси-сервера требуется соответствующая *фабрика прокси-сервера*, которая представляет собой объект, предоставляющий интерфейс [**иуиаутоматионпроксифактори**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) .</span><span class="sxs-lookup"><span data-stu-id="4fe93-129">Each proxy requires a corresponding *proxy factory*, which is an object that exposes the [**IUIAutomationProxyFactory**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) interface.</span></span> <span data-ttu-id="4fe93-130">Модель автоматизации пользовательского интерфейса поддерживает внутреннюю таблицу *записей фабрики прокси-серверов*, каждая из которых содержит ссылку на фабрику прокси-сервера для каждого прокси-сервера и набор условий.</span><span class="sxs-lookup"><span data-stu-id="4fe93-130">UI Automation maintains an internal table of *proxy factory entries*, each of which contains a reference to the proxy factory for each proxy, and a set of conditions.</span></span> <span data-ttu-id="4fe93-131">Когда модель автоматизации пользовательского интерфейса обнаруживает элемент управления, который не имеет собственной реализации [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) , он ищет запись фабрики прокси, условия которой указывают, что он поддерживает элемент управления.</span><span class="sxs-lookup"><span data-stu-id="4fe93-131">When UI Automation encounters a control that does not have a native [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) implementation, it searches for a proxy factory entry whose conditions indicate that it supports the control.</span></span> <span data-ttu-id="4fe93-132">Модель автоматизации пользовательского интерфейса выполняет поиск в таблице начиная с начала, а при обнаружении соответствующей записи модель автоматизации пользовательского интерфейса вызывает метод [**иуиаутоматионпроксифактори:: креатепровидер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) фабрики.</span><span class="sxs-lookup"><span data-stu-id="4fe93-132">UI Automation searches the table from the beginning, and when it finds a matching entry, UI Automation calls the factory's [**IUIAutomationProxyFactory::CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) method.</span></span> <span data-ttu-id="4fe93-133">Если соответствующий прокси-сервер успешно создан, Автоматизация пользовательского интерфейса прекращает поиск и использует только что созданный прокси-объект. в противном случае автоматизация пользовательского интерфейса продолжит поиск.</span><span class="sxs-lookup"><span data-stu-id="4fe93-133">If the matching proxy is successfully created, the UI Automation stops searching and uses the newly created proxy object; otherwise, UI Automation continues searching.</span></span>

<span data-ttu-id="4fe93-134">Клиентское приложение создает экземпляр записи фабрики прокси с помощью метода [**иуиаутоматион:: креатепроксифакторентри**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) , который возвращает указатель интерфейса [**иуиаутоматионпроксифакторентри**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) .</span><span class="sxs-lookup"><span data-stu-id="4fe93-134">A client application creates an instance of a proxy factory entry by using the [**IUIAutomation::CreateProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) method, which returns an [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) interface pointer.</span></span> <span data-ttu-id="4fe93-135">Клиенты используют методы, предоставляемые **иуиаутоматионпроксифакторентри** , для указания набора условий, которые фабрика прокси использует для создания учетной записи-посредника.</span><span class="sxs-lookup"><span data-stu-id="4fe93-135">Clients use methods exposed by **IUIAutomationProxyFactoryEntry** to specify the set of conditions that the proxy factory uses for creating the proxy.</span></span>

<span data-ttu-id="4fe93-136">При вызове [**иуиаутоматионпроксифактори:: Креатепровидер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider)модель автоматизации пользовательского интерфейса передает параметры, которые объект фабрики прокси может использовать для определения того, поддерживает ли прокси пользовательский элемент управления.</span><span class="sxs-lookup"><span data-stu-id="4fe93-136">When it calls [**IUIAutomationProxyFactory::CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider), UI Automation passes parameters that the proxy factory object can use to determine whether the proxy adequately supports the custom control.</span></span> <span data-ttu-id="4fe93-137">В этом случае фабрика прокси-сервера создает экземпляр прокси-сервера и возвращает указатель на интерфейс [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) ; в противном случае возвращается **пустой** указатель.</span><span class="sxs-lookup"><span data-stu-id="4fe93-137">If so, the proxy factory creates an instance of the proxy and returns the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface pointer; otherwise, it returns a **NULL** pointer.</span></span>

## <a name="proxy-factory-mapping"></a><span data-ttu-id="4fe93-138">Сопоставление фабрики прокси-серверов</span><span class="sxs-lookup"><span data-stu-id="4fe93-138">Proxy Factory Mapping</span></span>

<span data-ttu-id="4fe93-139">По умолчанию модель автоматизации пользовательского интерфейса выполняет поиск в таблице фабрики прокси в следующем порядке.</span><span class="sxs-lookup"><span data-stu-id="4fe93-139">By default, UI Automation searches through the proxy factory table in the following order.</span></span>



| <span data-ttu-id="4fe93-140">Заказ</span><span class="sxs-lookup"><span data-stu-id="4fe93-140">Order</span></span> | <span data-ttu-id="4fe93-141">Proxy (Прокси)</span><span class="sxs-lookup"><span data-stu-id="4fe93-141">Proxy</span></span>                        | <span data-ttu-id="4fe93-142">Описание</span><span class="sxs-lookup"><span data-stu-id="4fe93-142">Description</span></span>                                                                      |
|-------|------------------------------|----------------------------------------------------------------------------------|
| <span data-ttu-id="4fe93-143">1</span><span class="sxs-lookup"><span data-stu-id="4fe93-143">1</span></span>     | <span data-ttu-id="4fe93-144">Майкрософт: не управляющий прокси-сервер</span><span class="sxs-lookup"><span data-stu-id="4fe93-144">Microsoft: Non-Control Proxy</span></span> | <span data-ttu-id="4fe93-145">Для Windows с точным именем класса или именем базового класса "ComboBoxEx32".</span><span class="sxs-lookup"><span data-stu-id="4fe93-145">For windows with the exact class name or base class name "ComboBoxEx32".</span></span>         |
| <span data-ttu-id="4fe93-146">2</span><span class="sxs-lookup"><span data-stu-id="4fe93-146">2</span></span>     | <span data-ttu-id="4fe93-147">Майкрософт: не управляющий прокси-сервер</span><span class="sxs-lookup"><span data-stu-id="4fe93-147">Microsoft: Non-Control Proxy</span></span> | <span data-ttu-id="4fe93-148">Для Windows с точным именем класса или именем базового класса "Воркерв".</span><span class="sxs-lookup"><span data-stu-id="4fe93-148">For windows with the exact class name or base class name "WorkerW".</span></span>              |
| <span data-ttu-id="4fe93-149">3</span><span class="sxs-lookup"><span data-stu-id="4fe93-149">3</span></span>     | <span data-ttu-id="4fe93-150">Майкрософт: не управляющий прокси-сервер</span><span class="sxs-lookup"><span data-stu-id="4fe93-150">Microsoft: Non-Control Proxy</span></span> | <span data-ttu-id="4fe93-151">Для Windows с точным именем класса или именем базового класса "ШЕЛЛДЛЛ \_ дефвиев".</span><span class="sxs-lookup"><span data-stu-id="4fe93-151">For windows with the exact class name or base class name "SHELLDLL\_DefView".</span></span>    |
| <span data-ttu-id="4fe93-152">4</span><span class="sxs-lookup"><span data-stu-id="4fe93-152">4</span></span>     | <span data-ttu-id="4fe93-153">Microsoft: прокси-контейнер</span><span class="sxs-lookup"><span data-stu-id="4fe93-153">Microsoft: Container Proxy</span></span>   | <span data-ttu-id="4fe93-154">Для Windows с точным именем класса или именем базового класса " \# 32770".</span><span class="sxs-lookup"><span data-stu-id="4fe93-154">For windows with the exact class name or base class name "\#32770".</span></span>              |
| <span data-ttu-id="4fe93-155">5</span><span class="sxs-lookup"><span data-stu-id="4fe93-155">5</span></span>     | <span data-ttu-id="4fe93-156">Microsoft: прокси-контейнер</span><span class="sxs-lookup"><span data-stu-id="4fe93-156">Microsoft: Container Proxy</span></span>   | <span data-ttu-id="4fe93-157">Для Windows с именем класса или именем базового класса, содержащим "Афксконтролбар".</span><span class="sxs-lookup"><span data-stu-id="4fe93-157">For windows with a class name or base class name containing "AfxControlBar".</span></span>     |
| <span data-ttu-id="4fe93-158">6</span><span class="sxs-lookup"><span data-stu-id="4fe93-158">6</span></span>     | <span data-ttu-id="4fe93-159">Microsoft: прокси-сервер TreeView</span><span class="sxs-lookup"><span data-stu-id="4fe93-159">Microsoft: TreeView Proxy</span></span>    | <span data-ttu-id="4fe93-160">Для Windows с именем класса или именем базового класса, содержащим "SysTreeView32".</span><span class="sxs-lookup"><span data-stu-id="4fe93-160">For windows with a class name or base class name containing "SysTreeView32".</span></span>     |
| <span data-ttu-id="4fe93-161">7</span><span class="sxs-lookup"><span data-stu-id="4fe93-161">7</span></span>     | <span data-ttu-id="4fe93-162">Microsoft: прокси-сервер ListView</span><span class="sxs-lookup"><span data-stu-id="4fe93-162">Microsoft: ListView Proxy</span></span>    | <span data-ttu-id="4fe93-163">Для Windows с именем класса или именем базового класса, содержащим "SysListView32" (1).</span><span class="sxs-lookup"><span data-stu-id="4fe93-163">For windows with a class name or base class name containing "SysListView32" (1).</span></span> |
| <span data-ttu-id="4fe93-164">8</span><span class="sxs-lookup"><span data-stu-id="4fe93-164">8</span></span>     | <span data-ttu-id="4fe93-165">Microsoft: прокси-сервер ListView</span><span class="sxs-lookup"><span data-stu-id="4fe93-165">Microsoft: ListView Proxy</span></span>    | <span data-ttu-id="4fe93-166">Для Windows с именем класса или именем базового класса, содержащим "SysListView32" (2).</span><span class="sxs-lookup"><span data-stu-id="4fe93-166">For windows with a class name or base class name containing "SysListView32" (2).</span></span> |
| <span data-ttu-id="4fe93-167">9</span><span class="sxs-lookup"><span data-stu-id="4fe93-167">9</span></span>     | <span data-ttu-id="4fe93-168">Microsoft: прокси MSAA</span><span class="sxs-lookup"><span data-stu-id="4fe93-168">Microsoft: MSAA Proxy</span></span>        | <span data-ttu-id="4fe93-169">Для любого окна.</span><span class="sxs-lookup"><span data-stu-id="4fe93-169">For any window.</span></span>                                                                  |



 

<span data-ttu-id="4fe93-170">Прокси 7 и 8 являются повторяющимися записями для элемента управления SysListView32.</span><span class="sxs-lookup"><span data-stu-id="4fe93-170">Proxies 7 and 8 are duplicate entries for the SysListView32 control.</span></span> <span data-ttu-id="4fe93-171">Без изменения прокси-сервер 7 всегда используется для элемента управления SysListView32, а прокси 8 никогда не используется.</span><span class="sxs-lookup"><span data-stu-id="4fe93-171">Without modification, the proxy 7 is always used for the SysListView32 control, and proxy 8 is never used.</span></span> <span data-ttu-id="4fe93-172">Прокси 8 используется только для видимых элементов списка и обычно используется клиентскими приложениями, работающими только с видимыми элементами или имеющими требования к производительности.</span><span class="sxs-lookup"><span data-stu-id="4fe93-172">Proxy 8 is used only for visible list items, and is typically used by client applications that work only with visible elements, or that have strict performance requirements.</span></span> <span data-ttu-id="4fe93-173">Эти клиенты могут удалить прокси 7.</span><span class="sxs-lookup"><span data-stu-id="4fe93-173">These clients can remove proxy 7.</span></span>

<span data-ttu-id="4fe93-174">Прокси 9, Active Accessibility Майкрософт к прокси-серверу автоматизации пользовательского интерфейса, всегда должен быть последним элементом в таблице.</span><span class="sxs-lookup"><span data-stu-id="4fe93-174">Proxy 9, the Microsoft Active Accessibility to UI Automation proxy, should always be the last entry in the table.</span></span> <span data-ttu-id="4fe93-175">Это обеспечивает возможность использования Microsoft Active Accessibility для элементов управления, реализующих Microsoft Active Accessibility, но не для автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4fe93-175">This enables Microsoft Active Accessibility fallback functionality for controls that implement Microsoft Active Accessibility, but not UI Automation.</span></span>

<span data-ttu-id="4fe93-176">При изменении записей в таблице фабрики прокси следует тщательно оценить новое расположение записей.</span><span class="sxs-lookup"><span data-stu-id="4fe93-176">When modifying entries in the proxy factory table, you should carefully evaluate the new position of the entries.</span></span> <span data-ttu-id="4fe93-177">Рекомендуется размещать записи для настраиваемых прокси-серверов после учетных записей-посредников, не относящихся к элементам управления и контейнеров, но до того, как Microsoft Active Accessibilityся в прокси модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4fe93-177">We recommend that entries for custom proxies be placed after the non-control and container proxies, but before the Microsoft Active Accessibility to UI Automation proxy.</span></span> <span data-ttu-id="4fe93-178">Кроме того, хотя код в вызове [**креатепровидер**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) определяет, должен ли он поддерживать данный дескриптор окна (**HWND**), более эффективным является выбор прокси-сервера на основе имени класса и сохранение условного кода в методе **креатепровидер** до минимума.</span><span class="sxs-lookup"><span data-stu-id="4fe93-178">Also, while it is possible to have code in the call to [**CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) determine whether it should support a given window handle (**HWND**), it is more efficient to let UI Automation select the proxy based on the class name, and keep conditional code in the **CreateProvider** method to a minimum.</span></span>

<span data-ttu-id="4fe93-179">Модель автоматизации пользовательского интерфейса поддерживает отдельную таблицу фабрики прокси для каждого клиента.</span><span class="sxs-lookup"><span data-stu-id="4fe93-179">UI Automation maintains a separate proxy factory table for each client.</span></span> <span data-ttu-id="4fe93-180">Когда клиент изменяет свою таблицу прокси, изменения затрагивают только сам клиент; на другие клиенты это не влияет.</span><span class="sxs-lookup"><span data-stu-id="4fe93-180">When a client changes its proxy table, the changes affect only the client itself; other clients are not affected.</span></span>

## <a name="managing-default-proxies"></a><span data-ttu-id="4fe93-181">Управление прокси-серверами по умолчанию</span><span class="sxs-lookup"><span data-stu-id="4fe93-181">Managing Default Proxies</span></span>

<span data-ttu-id="4fe93-182">Когда клиентское приложение создает объект [**куиаутоматион**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) , в таблице фабрики прокси-сервера изначально содержатся только записи для поставщиков прокси-серверов по умолчанию для стандартных элементов управления.</span><span class="sxs-lookup"><span data-stu-id="4fe93-182">When a client application creates the [**CUIAutomation**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) object, the proxy factory table initially contains entries only for the default proxy providers for standard controls.</span></span> <span data-ttu-id="4fe93-183">С помощью интерфейса [**иуиаутоматионпроксифакторимаппинг**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) клиенты могут добавлять новые записи, удалять ненужные записи, изменять порядок записей и т. д.</span><span class="sxs-lookup"><span data-stu-id="4fe93-183">By using the [**IUIAutomationProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) interface, clients can add new entries, remove unwanted entries, change the order of entries, and so on.</span></span> <span data-ttu-id="4fe93-184">Клиент может получить указатель интерфейса **иуиаутоматионпроксифакторимаппинг** , вызвав метод [**Иуиаутоматион::P роксифакторимаппинг**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) .</span><span class="sxs-lookup"><span data-stu-id="4fe93-184">A client can retrieve an **IUIAutomationProxyFactoryMapping** interface pointer by calling the [**IUIAutomation::ProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) method.</span></span>

<span data-ttu-id="4fe93-185">Таблица доступных прокси содержит интерфейс [**иуиаутоматионпроксифакторентри**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) для каждого прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="4fe93-185">The table of available proxies contains an [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) interface for each proxy.</span></span> <span data-ttu-id="4fe93-186">Каждый **иуиаутоматионпроксифакторентри** указывает [**иуиаутоматионпроксифактори**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) и класс элемента управления, который обслуживает прокси-сервер, и определяет способ обработки событий.</span><span class="sxs-lookup"><span data-stu-id="4fe93-186">Each **IUIAutomationProxyFactoryEntry** specifies the [**IUIAutomationProxyFactory**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) and the control class that the proxy serves, and defines how events are to be handled.</span></span>

<span data-ttu-id="4fe93-187">Таблица прокси-серверов представлена интерфейсом [**иуиаутоматионпроксифакторимаппинг**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) , который можно получить из свойства [**Иуиаутоматион::P роксифакторимаппинг**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) .</span><span class="sxs-lookup"><span data-stu-id="4fe93-187">The table of proxies is represented by an [**IUIAutomationProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) interface, which can be obtained from the [**IUIAutomation::ProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) property.</span></span> <span data-ttu-id="4fe93-188">Приложение может использовать методы **иуиаутоматионпроксифакторимаппинг** для добавления и удаления прокси-серверов.</span><span class="sxs-lookup"><span data-stu-id="4fe93-188">An application can use **IUIAutomationProxyFactoryMapping** methods to add and delete proxies.</span></span> <span data-ttu-id="4fe93-189">Чтобы создать новую запись для добавления в эту таблицу, используйте [**иуиаутоматион:: креатепроксифакторентри**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) , чтобы получить интерфейс, а затем используйте методы [**иуиаутоматионпроксифакторентри**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) для определения соответствующего класса элемента управления и поведения прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="4fe93-189">To create a new entry to add to this table, use [**IUIAutomation::CreateProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) to obtain the interface, and then use the [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) methods to define the applicable control class and the behavior of the proxy.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4fe93-190">См. также</span><span class="sxs-lookup"><span data-stu-id="4fe93-190">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4fe93-191">Создание поставщика автоматизации пользовательского интерфейса Client-Side (прокси)</span><span class="sxs-lookup"><span data-stu-id="4fe93-191">How to Create a Client-Side (Proxy) UI Automation Provider</span></span>](uiauto-howto-create-clientside-provider.md)
</dt> <dt>

[<span data-ttu-id="4fe93-192">Рекомендации программиста поставщика модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="4fe93-192">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 