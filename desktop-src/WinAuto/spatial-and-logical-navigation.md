---
title: Пространственное и логическое перемещение
description: Клиенты получают сведения об объекте, который пространственно или логически близк к другому объекту в том же контейнере путем вызова IAccessible Аккнавигате и указания одной из констант навигации.
ms.assetid: a1ebb50e-76cf-472d-bb0f-3f5bf5ed30d5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b9e49772a267e49d723a04005dcbc8a369510b3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105710339"
---
# <a name="spatial-and-logical-navigation"></a><span data-ttu-id="bf7e9-103">Пространственное и логическое перемещение</span><span class="sxs-lookup"><span data-stu-id="bf7e9-103">Spatial and Logical Navigation</span></span>

<span data-ttu-id="bf7e9-104">Клиенты получают сведения об объекте, который пространственный или логически близок к другому объекту в том же контейнере путем вызова метода [**IAccessible:: аккнавигате**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) и указания одной из [констант навигации](navigation-constants.md).</span><span class="sxs-lookup"><span data-stu-id="bf7e9-104">Clients retrieve information about an object that is spatially or logically near another object within the same container by calling [**IAccessible::accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) and specifying one of the [navigation constants](navigation-constants.md).</span></span>

<span data-ttu-id="bf7e9-105">Клиенты *пространственной навигации* переходят к объекту в зависимости от его расположения на экране.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-105">With *spatial navigation* clients navigate to an object based on its location on the screen.</span></span> <span data-ttu-id="bf7e9-106">Клиенты переходят вверх, вниз, влево или вправо с текущего объекта, чтобы получить сведения о другом объекте в том же контейнере.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-106">Clients navigate up, down, left, or right from the current object to obtain information about another object within the same container.</span></span>

<span data-ttu-id="bf7e9-107">При использовании *логических клиентов навигации* перейдите к объекту, который логически предшествует или следует за другим объектом, как определено сервером.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-107">With *logical navigation* clients navigate to the object that logically precedes or follows another object, as determined by the server.</span></span> <span data-ttu-id="bf7e9-108">Клиенты переходят ко всем дочерним объектам объекта двумя способами:</span><span class="sxs-lookup"><span data-stu-id="bf7e9-108">Clients navigate to all of an object's children in two ways:</span></span>

-   <span data-ttu-id="bf7e9-109">Запустите навигацию с помощью [**навдир \_ FIRSTCHILD**](navigation-constants.md) , а затем повторно вызовите метод с помощью [**навдир \_ Next**](navigation-constants.md).</span><span class="sxs-lookup"><span data-stu-id="bf7e9-109">Start the navigation with [**NAVDIR\_FIRSTCHILD**](navigation-constants.md) and then repeatedly call the method with [**NAVDIR\_NEXT**](navigation-constants.md).</span></span>
-   <span data-ttu-id="bf7e9-110">Запустите навигацию с помощью [**навдир \_ LASTCHILD**](navigation-constants.md) и повторно вызовите метод с помощью [**навдир \_ Previous**](navigation-constants.md).</span><span class="sxs-lookup"><span data-stu-id="bf7e9-110">Start the navigation with [**NAVDIR\_LASTCHILD**](navigation-constants.md) and repeatedly call the method with [**NAVDIR\_PREVIOUS**](navigation-constants.md).</span></span>

<span data-ttu-id="bf7e9-111">Независимо от направления переход посещает все видимые дочерние объекты, принадлежащие родительскому объекту.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-111">Regardless of the direction, the navigation visits each visible child that belongs to the parent object.</span></span> <span data-ttu-id="bf7e9-112">Невидимые дочерние элементы могут быть пропущены при логической навигации.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-112">Invisible children may be skipped with logical navigation.</span></span> <span data-ttu-id="bf7e9-113">Кроме того, каждый дочерний элемент посещается только один раз, и навигация не выполняет Циклическое перемещение.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-113">Additionally, each child is visited only once, and the navigation does not loop around.</span></span> <span data-ttu-id="bf7e9-114">Это значит, что метод завершается ошибкой, если клиент пытается выполнить переход перед первым объектом или после последнего объекта.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-114">That is, the method fails if a client attempts to navigate before the first object or after the last object.</span></span>

<span data-ttu-id="bf7e9-115">Пространственные и логическая Навигация связаны.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-115">Spatial and logical navigation are related.</span></span> <span data-ttu-id="bf7e9-116">Например, на горизонтальной панели инструментов вызов метода с [**навдир \_ right**](navigation-constants.md) должен дать те же результаты, что и вызов метода с помощью [**навдир \_ Next**](navigation-constants.md).</span><span class="sxs-lookup"><span data-stu-id="bf7e9-116">For example, in a horizontal toolbar, calling the method with [**NAVDIR\_RIGHT**](navigation-constants.md) should produce the same results as calling the method with [**NAVDIR\_NEXT**](navigation-constants.md).</span></span>

<span data-ttu-id="bf7e9-117">Начальный объект навигации — это либо объект, либо его **дочерние объекты, за исключением случаев, когда** указан параметр [**Навдир \_ FIRSTCHILD**](navigation-constants.md) или [**навдир \_ LASTCHILD**](navigation-constants.md) . в этом случае переход должен начинаться с самого объекта.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-117">The starting object of the navigation is either the object it **self or one of the object's children, except when either** [**NAVDIR\_FIRSTCHILD**](navigation-constants.md) or [**NAVDIR\_LASTCHILD**](navigation-constants.md) is specified; in this case, the navigation must start from the object itself.</span></span>

<span data-ttu-id="bf7e9-118">Если клиент переходит из доступного объекта в одноуровневый элемент пользовательского интерфейса или если элемент **лвал** объекта *варстарт* имеет **чилдид \_ Self** , а указанный флаг в *Навдир* является любым флагом навигации, кроме навдир FIRSTCHILD или [**навдир \_ LASTCHILD**](navigation-constants.md), результатом в *пваренд* является либо дочерний идентификатор, либо интерфейс [**IDispatch**](idispatch-interface.md) . [**\_**](navigation-constants.md)</span><span class="sxs-lookup"><span data-stu-id="bf7e9-118">If a client navigates from an accessible object to a sibling user interface element, or if the **lVal** member of *varStart* is **CHILDID\_SELF** and the specified flag in *navDir* is any navigation flag except [**NAVDIR\_FIRSTCHILD**](navigation-constants.md) or [**NAVDIR\_LASTCHILD**](navigation-constants.md), the result in *pvarEnd* is either a child ID or an [**IDispatch**](idispatch-interface.md) interface.</span></span> <span data-ttu-id="bf7e9-119">Если *пваренд* содержит дочерний идентификатор, клиенты должны сначала получить указатель на интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) родителя, чтобы выполнить переход от этого элемента пользовательского интерфейса или получить дополнительные сведения о нем.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-119">If *pvarEnd* contains a child ID, clients must first obtain a pointer to the parent's [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface in order to navigate from this user interface element or to obtain more information about it.</span></span> <span data-ttu-id="bf7e9-120">Чтобы получить родительский объект, клиенты вызывают свойство [**IAccessible:: Get \_ аккпарент**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) родственного объекта или начального объекта навигации.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-120">To obtain the parent object, clients call the [**IAccessible::get\_accParent**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) property of the sibling object or the starting object of the navigation.</span></span>

<span data-ttu-id="bf7e9-121">Обратите внимание, что клиенты должны получить сведения обо всех плавающих объектах, вызвав функцию [**енумчилдвиндовс**](/windows/desktop/api/winuser/nf-winuser-enumchildwindows) .</span><span class="sxs-lookup"><span data-stu-id="bf7e9-121">Note that clients must have information about all floating objects by calling the [**EnumChildWindows**](/windows/desktop/api/winuser/nf-winuser-enumchildwindows) function.</span></span> <span data-ttu-id="bf7e9-122">Так как плавающий объект не обрезается до родительского объекта, клиенты не имеют сведений о иерархических отношениях между двумя объектами на экране.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-122">Because a floating object is not clipped to its parent, clients do not have information about the hierarchical relationship between two objects near one another on the screen.</span></span>

<span data-ttu-id="bf7e9-123">На следующем рисунке показан пример плавающего объекта, который не обрезается в его родительском объекте.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-123">The following graphic is an example of a floating object that is not clipped to its parent.</span></span>

![снимок экрана открытого окна с плавающей точкой в более крупном окне Microsoft Developer Studio](images/floatob.gif)

## <a name="establishing-the-order-in-logical-navigation"></a><span data-ttu-id="bf7e9-125">Задание порядка в логической навигации</span><span class="sxs-lookup"><span data-stu-id="bf7e9-125">Establishing the Order in Logical Navigation</span></span>

<span data-ttu-id="bf7e9-126">При логической навигации разработчики, которые разрабатывает объекты, устанавливают связи между ними.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-126">In logical navigation, the developers who design the objects establish the relationships between them.</span></span> <span data-ttu-id="bf7e9-127">Логическая Навигация является более субъективной, чем пространственный переход.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-127">Logical navigation is more subjective than spatial navigation.</span></span> <span data-ttu-id="bf7e9-128">Кроме того, порядок в логической навигации не совпадает с порядком, используемым для дочерних идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-128">Also, the order in logical navigation is not the same as the order used with child IDs.</span></span>

<span data-ttu-id="bf7e9-129">Для объектов, имеющих расположения на экране, разработчики сервера должны установить порядок навигации в том виде, в котором большинство пользователей будут считаться логическими.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-129">For objects that have screen locations, server developers should establish the navigation order in the way that most users would consider logical.</span></span> <span data-ttu-id="bf7e9-130">Например, в странах или регионах, говорящих на английском языке, это означает порядок сортировки слева направо и сверху вниз.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-130">In English-speaking countries/regions, for instance, this means a left-to-right, top-to-bottom ordering.</span></span>

<span data-ttu-id="bf7e9-131">Логический порядок навигации должен быть параллельным порядком навигации с помощью клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-131">Logical navigation order must parallel keyboard navigation order.</span></span> <span data-ttu-id="bf7e9-132">Например, диалоговое окно содержит кнопки **ОК** и **Отмена** и несколько элементов управления редактированием.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-132">For example, a dialog box contains **OK** and **Cancel** push buttons and a few edit controls.</span></span> <span data-ttu-id="bf7e9-133">Клиент, который вызывает метод [**IAccessible:: аккнавигате**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) для перехода к следующему или предыдущему объекту в этом диалоговом окне, перемещается в том же порядке, что и нажатие клавиши TAB или SHIFT + TAB для перемещения фокуса между элементами.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-133">A client that calls [**IAccessible::accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) to navigate to the next or previous object in that dialog box moves in the same order as a user pressing TAB or SHIFT+TAB to move the focus between items.</span></span>

<span data-ttu-id="bf7e9-134">Для объектов, не имеющих определенных расположений экрана, логический порядок выбирается разработчиками сервера, и разработчики клиентов не должны ничего предполагать о нем.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-134">For objects that do not have defined screen locations, the logical order is decided by server developers, and client developers should make no assumptions about it.</span></span> <span data-ttu-id="bf7e9-135">Например, можно использовать невидимые объекты, такие как объекты, которые временно скрыты, для постороннего отображения видимых объектов.</span><span class="sxs-lookup"><span data-stu-id="bf7e9-135">For instance, it is acceptable for non-visible objects, such as objects that are only temporarily hidden, to be interspersed with visible objects.</span></span>

 

 