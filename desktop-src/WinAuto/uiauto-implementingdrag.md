---
title: Перетащите шаблон элемента управления
description: Содержит правила и соглашения по реализации шаблона элемента управления Drag с помощью Идрагпровидер, включая сведения о свойствах и методах. Шаблон элемента управления перетаскиванием используется для поддержки перетаскиваемых элементов управления или элементов управления с элементами, которые можно перетаскивать.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления Drag
- Модель автоматизации пользовательского интерфейса, перетаскивание шаблона элемента управления
- Модель автоматизации пользовательского интерфейса, Идрагпровидер
- IDragProvider
- реализация шаблонов элементов управления для модели автоматизации пользовательского интерфейса
- Перетаскивание шаблонов элементов управления
- шаблоны элементов управления, Идрагпровидер
- шаблоны элементов управления, реализация перетаскивания UI Automation
- шаблоны элементов управления, перетащите
- интерфейсы, Идрагпровидер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070225"
---
# <a name="drag-control-pattern"></a><span data-ttu-id="70b00-114">Перетащите шаблон элемента управления</span><span class="sxs-lookup"><span data-stu-id="70b00-114">Drag Control Pattern</span></span>

<span data-ttu-id="70b00-115">Содержит правила и соглашения по реализации шаблона элемента управления **Drag** с помощью [**идрагпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), включая сведения о свойствах и методах.</span><span class="sxs-lookup"><span data-stu-id="70b00-115">Provides guidelines and conventions for implementing the **Drag** control pattern by using [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), including information about properties and methods.</span></span> <span data-ttu-id="70b00-116">Шаблон элемента управления **перетаскиванием** используется для поддержки перетаскиваемых элементов управления или элементов управления с элементами, которые можно перетаскивать.</span><span class="sxs-lookup"><span data-stu-id="70b00-116">The **Drag** control pattern is used to support draggable controls, or controls with draggable items.</span></span>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="70b00-117">Правила и соглашения реализации</span><span class="sxs-lookup"><span data-stu-id="70b00-117">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="70b00-118">При реализации шаблона элемента управления **перетаскиванием** используйте следующие правила и соглашения:</span><span class="sxs-lookup"><span data-stu-id="70b00-118">When implementing the **Drag** control pattern, use these guidelines and conventions:</span></span>

-   <span data-ttu-id="70b00-119">Интерфейс [**идрагпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) поддерживает два разных стиля перетаскивания: исходный и конечный стили и стиль только для исходного кода.</span><span class="sxs-lookup"><span data-stu-id="70b00-119">The [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) interface supports two different dragging styles: the source/target style, and the source-only style.</span></span> <span data-ttu-id="70b00-120">Необходимо выбрать стиль, который лучше подходит для сценариев перетаскивания:</span><span class="sxs-lookup"><span data-stu-id="70b00-120">You need to choose the style that works best for your drag-and-drop scenarios:</span></span>
    -   <span data-ttu-id="70b00-121">**Исходный или конечный стиль:** Каждая возможная цель перетаскивания представлена элементом, реализующим интерфейс [**идроптаржетпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) .</span><span class="sxs-lookup"><span data-stu-id="70b00-121">**Source/target style:** Each possible drop target is represented by an element that implements the [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) interface.</span></span> <span data-ttu-id="70b00-122">Во время операции перетаскивания события модели автоматизации пользовательского интерфейса Майкрософт берутся из элемента, который перетаскивается, и из элементов-приемников.</span><span class="sxs-lookup"><span data-stu-id="70b00-122">During a drag operation, Microsoft UI Automation events originate from the element that is being dragged, and from the drop-target elements.</span></span>
    -   <span data-ttu-id="70b00-123">**Стиль только для исходного кода:** Целевые объекты перетаскивания не представлены элементами модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="70b00-123">**Source-only style:** Drop targets are not represented by UI Automation elements.</span></span> <span data-ttu-id="70b00-124">Во время операции перетаскивания события берутся только из перетаскиваемого элемента.</span><span class="sxs-lookup"><span data-stu-id="70b00-124">During a drag operation, events originate only from the element that is being dragged.</span></span>
-   <span data-ttu-id="70b00-125">[**Идрагпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) — это интерфейс только для чтения, предназначенный для наблюдения за операциями перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="70b00-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) is a read-only interface intended for monitoring drag operations.</span></span> <span data-ttu-id="70b00-126">Его нельзя использовать для управления операцией перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="70b00-126">You cannot use it to control a drag operation.</span></span> <span data-ttu-id="70b00-127">Операции перетаскивания можно автоматизировать, отправляя ввод мыши в элемент управления.</span><span class="sxs-lookup"><span data-stu-id="70b00-127">You can automate drag operations by sending mouse input to a control.</span></span>
-   <span data-ttu-id="70b00-128">Требуется свойство [**идрагпровидер:: «не извлечено**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) ».</span><span class="sxs-lookup"><span data-stu-id="70b00-128">The [**IDragProvider::IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) property is required.</span></span>
-   <span data-ttu-id="70b00-129">Свойства [**идрагпровидер::D ропеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) и [**Идрагпровидер::D ропеффектс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) необходимы для реализации стиля только с исходным кодом и запрещены для реализации исходного и целевого стилей.</span><span class="sxs-lookup"><span data-stu-id="70b00-129">The [**IDragProvider::DropEffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) and [**IDragProvider::DropEffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) properties are required for a source-only style implementation, and prohibited for a source/target style implementation.</span></span> <span data-ttu-id="70b00-130">В реализации в исходном и целевом стиле элементы Drop-Target можно запрашивать для своих эффектов перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="70b00-130">In a source/target style implementation, drop-target elements can be queried for their drop effects.</span></span>
-   <span data-ttu-id="70b00-131">Свойство [**идрагпровидер:: граббедитемс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) представляет собой перетаскивание нескольких элементов.</span><span class="sxs-lookup"><span data-stu-id="70b00-131">The [**IDragProvider::GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) property represents the dragging of multiple items.</span></span> <span data-ttu-id="70b00-132">Когда пользователь начинает операцию перетаскивания, необходимо создать новый элемент модели автоматизации пользовательского интерфейса, который будет служить элементом источника события.</span><span class="sxs-lookup"><span data-stu-id="70b00-132">When the user begins the drag operation, you need to create a new UI Automation element to serve as the event source element.</span></span> <span data-ttu-id="70b00-133">Этот новый элемент запускает все события, которые элемент источника мог бы запустить в исходном или целевом режиме или только исходный режим, в то время как ни один из элементов, которые в действительности не перемещаются, не запускает никаких событий.</span><span class="sxs-lookup"><span data-stu-id="70b00-133">This new element fires all events that the source element would have fired in either the source/target or source-only mode, while none of the elements that are actually being dragged fire any events.</span></span> <span data-ttu-id="70b00-134">После завершения операции перетаскивания удалите элемент источника события.</span><span class="sxs-lookup"><span data-stu-id="70b00-134">When the drag operation is complete, destroy the event source element.</span></span>
-   <span data-ttu-id="70b00-135">Элемент должен вызывать события изменения свойств для свойств **дропеффект** ([**UIA \_ драгдропеффектпропертид**](uiauto-control-pattern-propids.md)) и **дропеффектс** ([**UIA \_ драгдропеффектспропертид**](uiauto-control-pattern-propids.md)) при их изменении.</span><span class="sxs-lookup"><span data-stu-id="70b00-135">The element must fire property-changed events for the **DropEffect** ([**UIA\_DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) and **DropEffects** ([**UIA\_DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) properties when they change.</span></span> <span data-ttu-id="70b00-136">События изменения свойств для других свойств допускаются, но могут выводиться из обязательных событий **драгстарт** ([**UIA \_ Drag \_ драгстартевентид**](uiauto-event-ids.md)), **драгканцел** (UIA перетаскивания [**\_ \_ драгканцелевентид**](uiauto-event-ids.md)) и **драгкомплете** (драгкомплетивентид [**\_ перетаскивания \_**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="70b00-136">Property-changed events for the other properties are allowed, but can be inferred from the required **DragStart** ([**UIA\_Drag\_DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA\_Drag\_DragCancelEventId**](uiauto-event-ids.md)), and **DragComplete** ([**UIA\_Drag\_DragCompleteEventId**](uiauto-event-ids.md)) events.</span></span>
-   

## <a name="required-members-for-idragprovider"></a><span data-ttu-id="70b00-137">Обязательные члены для **идрагпровидер**</span><span class="sxs-lookup"><span data-stu-id="70b00-137">Required Members for **IDragProvider**</span></span>

<span data-ttu-id="70b00-138">Для реализации интерфейса [**идрагпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) требуются следующие свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="70b00-138">The following properties and methods are required for implementing the [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) interface.</span></span>



| <span data-ttu-id="70b00-139">Обязательные члены</span><span class="sxs-lookup"><span data-stu-id="70b00-139">Required members</span></span>                                                                        | <span data-ttu-id="70b00-140">Тип члена</span><span class="sxs-lookup"><span data-stu-id="70b00-140">Member type</span></span> | <span data-ttu-id="70b00-141">Примечания</span><span class="sxs-lookup"><span data-stu-id="70b00-141">Notes</span></span>                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [<span data-ttu-id="70b00-142">**Извлечено**</span><span class="sxs-lookup"><span data-stu-id="70b00-142">**IsGrabbed**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | <span data-ttu-id="70b00-143">Свойство</span><span class="sxs-lookup"><span data-stu-id="70b00-143">Property</span></span>    | <span data-ttu-id="70b00-144">Нет</span><span class="sxs-lookup"><span data-stu-id="70b00-144">None</span></span>                                                                          |
| [<span data-ttu-id="70b00-145">**дропеффект**</span><span class="sxs-lookup"><span data-stu-id="70b00-145">**DropEffect**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | <span data-ttu-id="70b00-146">Свойство</span><span class="sxs-lookup"><span data-stu-id="70b00-146">Property</span></span>    | <span data-ttu-id="70b00-147">Требуется для реализации стиля, основанного только на источнике.</span><span class="sxs-lookup"><span data-stu-id="70b00-147">Required for an implementation of the source-only style.</span></span>                      |
| [<span data-ttu-id="70b00-148">**дропеффектс**</span><span class="sxs-lookup"><span data-stu-id="70b00-148">**DropEffects**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | <span data-ttu-id="70b00-149">Свойство</span><span class="sxs-lookup"><span data-stu-id="70b00-149">Property</span></span>    | <span data-ttu-id="70b00-150">Требуется, если для извлеченного элемента имеется несколько возможных эффектов перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="70b00-150">Required if there is more than one possible drop effect for the grabbed item.</span></span> |
| [<span data-ttu-id="70b00-151">**жетграббедитемс**</span><span class="sxs-lookup"><span data-stu-id="70b00-151">**GetGrabbedItems**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | <span data-ttu-id="70b00-152">Метод</span><span class="sxs-lookup"><span data-stu-id="70b00-152">Method</span></span>      | <span data-ttu-id="70b00-153">Требуется для операции перетаскивания с несколькими элементами.</span><span class="sxs-lookup"><span data-stu-id="70b00-153">Required for a multiple-item drag operation.</span></span>                                  |
| [<span data-ttu-id="70b00-154">**UIA \_ перетаскивания \_ драгстартевентид**</span><span class="sxs-lookup"><span data-stu-id="70b00-154">**UIA\_Drag\_DragStartEventId**</span></span>](uiauto-event-ids.md)       | <span data-ttu-id="70b00-155">Событие</span><span class="sxs-lookup"><span data-stu-id="70b00-155">Event</span></span>       | <span data-ttu-id="70b00-156">Нет</span><span class="sxs-lookup"><span data-stu-id="70b00-156">None</span></span>                                                                          |
| [<span data-ttu-id="70b00-157">**UIA \_ перетаскивания \_ драгканцелевентид**</span><span class="sxs-lookup"><span data-stu-id="70b00-157">**UIA\_Drag\_DragCancelEventId**</span></span>](uiauto-event-ids.md)     | <span data-ttu-id="70b00-158">Событие</span><span class="sxs-lookup"><span data-stu-id="70b00-158">Event</span></span>       | <span data-ttu-id="70b00-159">Нет</span><span class="sxs-lookup"><span data-stu-id="70b00-159">None</span></span>                                                                          |
| [<span data-ttu-id="70b00-160">**UIA \_ перетаскивания \_ драгкомплетивентид**</span><span class="sxs-lookup"><span data-stu-id="70b00-160">**UIA\_Drag\_DragCompleteEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="70b00-161">Событие</span><span class="sxs-lookup"><span data-stu-id="70b00-161">Event</span></span>       | <span data-ttu-id="70b00-162">Нет</span><span class="sxs-lookup"><span data-stu-id="70b00-162">None</span></span>                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="70b00-163">См. также</span><span class="sxs-lookup"><span data-stu-id="70b00-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="70b00-164">Типы элементов управления и поддерживаемые ими шаблоны элементов управления</span><span class="sxs-lookup"><span data-stu-id="70b00-164">Control Types and their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="70b00-165">Шаблон элемента управления Дроптаржет</span><span class="sxs-lookup"><span data-stu-id="70b00-165">DropTarget Control Pattern</span></span>](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[<span data-ttu-id="70b00-166">Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="70b00-166">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="70b00-167">Общие сведения о дереве модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="70b00-167">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="70b00-168">Поддержка модели автоматизации пользовательского интерфейса для перетаскивания</span><span class="sxs-lookup"><span data-stu-id="70b00-168">UI Automation Support for Drag-and-Drop</span></span>](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 