---
title: Реализация поставщика автоматизации пользовательского интерфейса Server-Side
description: В этом разделе описывается реализация поставщика Microsoft UI Automation на стороне сервера для пользовательского элемента управления, написанного на языке C++.
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- Модель автоматизации пользовательского интерфейса, реализация поставщика на стороне сервера
- Автоматизация пользовательского интерфейса, реализация поставщика
- Модель автоматизации пользовательского интерфейса, реализация поставщиков на стороне сервера
- Модель автоматизации пользовательского интерфейса, реализация поставщиков
- поставщики на стороне сервера, реализация
- поставщики на стороне сервера, интерфейсы
- поставщики на стороне сервера, значения свойств
- поставщики на стороне сервера, события
- поставщики на стороне сервера, назначение нового родителя
- события, поставщики на стороне сервера
- интерфейсы, поставщики на стороне сервера
- поставщики, реализация
- Реализация поставщиков на стороне сервера
- реализация поставщиков
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105672367"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="a4e53-117">Реализация поставщика автоматизации пользовательского интерфейса Server-Side</span><span class="sxs-lookup"><span data-stu-id="a4e53-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="a4e53-118">В этом разделе описывается реализация поставщика Microsoft UI Automation на стороне сервера для пользовательского элемента управления, написанного на языке C++.</span><span class="sxs-lookup"><span data-stu-id="a4e53-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="a4e53-119">Он содержит следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="a4e53-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="a4e53-120">Интерфейсы поставщика</span><span class="sxs-lookup"><span data-stu-id="a4e53-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="a4e53-121">Требуемая функциональность для поставщиков автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="a4e53-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="a4e53-122">Значения свойств</span><span class="sxs-lookup"><span data-stu-id="a4e53-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="a4e53-123">События от поставщиков</span><span class="sxs-lookup"><span data-stu-id="a4e53-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="a4e53-124">Навигация поставщика</span><span class="sxs-lookup"><span data-stu-id="a4e53-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="a4e53-125">Назначение нового родителя</span><span class="sxs-lookup"><span data-stu-id="a4e53-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="a4e53-126">Изменение расположения поставщика</span><span class="sxs-lookup"><span data-stu-id="a4e53-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="a4e53-127">Отключение поставщиков</span><span class="sxs-lookup"><span data-stu-id="a4e53-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="a4e53-128">См. также</span><span class="sxs-lookup"><span data-stu-id="a4e53-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="a4e53-129">Примеры кода, демонстрирующие способы реализации поставщиков на стороне сервера, см. [в разделах с инструкциями по поставщикам автоматизации пользовательского интерфейса](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="a4e53-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="a4e53-130">Интерфейсы поставщика</span><span class="sxs-lookup"><span data-stu-id="a4e53-130">Provider Interfaces</span></span>

<span data-ttu-id="a4e53-131">Следующие интерфейсы объектной модели (COM) предоставляют функциональные возможности для пользовательских элементов управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="a4e53-132">Для обеспечения базовой функциональности каждый поставщик автоматизации пользовательского интерфейса должен реализовывать по крайней мере интерфейс [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) .</span><span class="sxs-lookup"><span data-stu-id="a4e53-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="a4e53-133">Интерфейсы [**иравелементпровидерфрагмент**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) и [**иравелементпровидерфрагментрут**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) являются необязательными, но должны быть реализованы для элементов сложного элемента управления, чтобы обеспечить дополнительные функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="a4e53-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="a4e53-134">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="a4e53-134">Interface</span></span>                                                                         | <span data-ttu-id="a4e53-135">Описание</span><span class="sxs-lookup"><span data-stu-id="a4e53-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a4e53-136">**иравелементпровидерсимпле**</span><span class="sxs-lookup"><span data-stu-id="a4e53-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="a4e53-137">Предоставляет базовые функциональные возможности для элемента управления, размещенного в окне, включая поддержку шаблонов элементов управления и свойств.</span><span class="sxs-lookup"><span data-stu-id="a4e53-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="a4e53-138">**иравелементпровидерфрагмент**</span><span class="sxs-lookup"><span data-stu-id="a4e53-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="a4e53-139">Добавляет функциональные возможности для элемента в сложном элементе управления, включая навигацию в фрагменте, установку фокуса и возврат ограничивающего прямоугольника элемента.</span><span class="sxs-lookup"><span data-stu-id="a4e53-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="a4e53-140">**иравелементпровидерфрагментрут**</span><span class="sxs-lookup"><span data-stu-id="a4e53-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="a4e53-141">Добавляет функциональные возможности для корневого элемента в сложном элементе управления, включая поиск дочернего элемента по указанным координатам и установку состояния фокуса для всего элемента управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="a4e53-142">В интерфейсе API модели автоматизации пользовательского интерфейса для управляемого кода эти интерфейсы формируют иерархию наследования.</span><span class="sxs-lookup"><span data-stu-id="a4e53-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="a4e53-143">Это не так в C++, где интерфейсы полностью отделены.</span><span class="sxs-lookup"><span data-stu-id="a4e53-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="a4e53-144">Следующие интерфейсы предоставляют дополнительные функциональные возможности, но реализация является необязательной.</span><span class="sxs-lookup"><span data-stu-id="a4e53-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="a4e53-145">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="a4e53-145">Interface</span></span>                                                                         | <span data-ttu-id="a4e53-146">Описание</span><span class="sxs-lookup"><span data-stu-id="a4e53-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="a4e53-147">**иравелементпровидерадвисивентс**</span><span class="sxs-lookup"><span data-stu-id="a4e53-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="a4e53-148">Позволяет поставщику отслеживать запросы событий.</span><span class="sxs-lookup"><span data-stu-id="a4e53-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="a4e53-149">**иравелементпровидерхвндоверриде**</span><span class="sxs-lookup"><span data-stu-id="a4e53-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="a4e53-150">Включает изменение расположения элементов на основе окна в дереве автоматизации пользовательского интерфейса фрагмента.</span><span class="sxs-lookup"><span data-stu-id="a4e53-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="a4e53-151">Требуемая функциональность для поставщиков автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="a4e53-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="a4e53-152">Для взаимодействия с автоматизацией пользовательского интерфейса элемент управления должен реализовать основные области функциональности, описанные в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="a4e53-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="a4e53-153">Функциональность</span><span class="sxs-lookup"><span data-stu-id="a4e53-153">Functionality</span></span>                                              | <span data-ttu-id="a4e53-154">Реализация</span><span class="sxs-lookup"><span data-stu-id="a4e53-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a4e53-155">Предоставьте поставщику модель автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="a4e53-156">В ответ на сообщение [**WM \_ GetObject**](wm-getobject.md) , отправленное в окно управления, возвращается объект, реализующий [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span><span class="sxs-lookup"><span data-stu-id="a4e53-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="a4e53-157">Для фрагментов это должен быть поставщик для корневого фрагмента.</span><span class="sxs-lookup"><span data-stu-id="a4e53-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="a4e53-158">Укажите значения свойств.</span><span class="sxs-lookup"><span data-stu-id="a4e53-158">Provide property values.</span></span>                                   | <span data-ttu-id="a4e53-159">Реализуйте [**иравелементпровидерсимпле:: жетпропертивалуе**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) для предоставления или переопределения значений.</span><span class="sxs-lookup"><span data-stu-id="a4e53-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="a4e53-160">Разрешить клиенту взаимодействовать с элементом управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="a4e53-161">Реализуйте интерфейсы, поддерживающие каждый подходящий шаблон элемента управления, например [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span><span class="sxs-lookup"><span data-stu-id="a4e53-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="a4e53-162">Возвращайте эти поставщики шаблонов элементов управления в реализации [**иравелементпровидерсимпле:: жетпаттернпровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span><span class="sxs-lookup"><span data-stu-id="a4e53-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="a4e53-163">Инициируйте события.</span><span class="sxs-lookup"><span data-stu-id="a4e53-163">Raise events.</span></span>                                              | <span data-ttu-id="a4e53-164">[**Уиараисеаутоматионевент**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), методы [**ипроксипровидервиневентсинк**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span><span class="sxs-lookup"><span data-stu-id="a4e53-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="a4e53-165">Включение навигации и фокусировки в фрагменте.</span><span class="sxs-lookup"><span data-stu-id="a4e53-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="a4e53-166">Реализуйте [**иравелементпровидерфрагмент**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) для каждого элемента внутри фрагмента.</span><span class="sxs-lookup"><span data-stu-id="a4e53-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="a4e53-167">Не требуется для элементов, которые не являются частью фрагмента.</span><span class="sxs-lookup"><span data-stu-id="a4e53-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="a4e53-168">Включение фокусировки и поиск дочерних элементов в фрагменте.</span><span class="sxs-lookup"><span data-stu-id="a4e53-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="a4e53-169">Реализуйте [**иравелементпровидерфрагментрут**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span><span class="sxs-lookup"><span data-stu-id="a4e53-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="a4e53-170">Не требуется для элементов, которые не являются корнями фрагментов.</span><span class="sxs-lookup"><span data-stu-id="a4e53-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="a4e53-171">Значения свойств</span><span class="sxs-lookup"><span data-stu-id="a4e53-171">Property Values</span></span>

<span data-ttu-id="a4e53-172">Поставщики автоматизации пользовательского интерфейса для пользовательских элементов управления должны поддерживать определенные свойства, которые могут использоваться автоматизацией пользовательского интерфейса и клиентскими приложениями.</span><span class="sxs-lookup"><span data-stu-id="a4e53-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="a4e53-173">Для элементов, размещенных в Windows, модель автоматизации пользовательского интерфейса может извлекать некоторые свойства из поставщика окна по умолчанию, но должна получить других из настраиваемого поставщика.</span><span class="sxs-lookup"><span data-stu-id="a4e53-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="a4e53-174">Как правило, поставщики для элементов управления на основе окон не обязательно должны предоставлять следующие свойства, идентифицируемые **PROPERTYID**:</span><span class="sxs-lookup"><span data-stu-id="a4e53-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="a4e53-175">**UIA \_ баундингректанглепропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-176">**UIA \_ кликкаблепоинтпропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-177">**UIA \_ процессидпропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-178">**UIA \_ класснамепропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-179">**UIA \_ хаскэйбоардфокуспропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-180">**UIA \_ исенабледпропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-181">**UIA \_ искэйбоардфокусаблепропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-182">**UIA \_ испассвордпропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-183">**UIA \_ намепропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="a4e53-184">**UIA \_ рунтимеидпропертид**</span><span class="sxs-lookup"><span data-stu-id="a4e53-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="a4e53-185">Свойство Рунтимеид простого элемента или корня фрагмента, размещенного в окне, получается из окна.</span><span class="sxs-lookup"><span data-stu-id="a4e53-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="a4e53-186">Однако элементы фрагментов, расположенные под корнем, например элементы списка в списке, должны предоставлять собственные идентификаторы.</span><span class="sxs-lookup"><span data-stu-id="a4e53-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="a4e53-187">Дополнительные сведения см. в разделе [**иравелементпровидерфрагмент:: жетрунтимеид**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span><span class="sxs-lookup"><span data-stu-id="a4e53-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="a4e53-188">Свойство Искэйбоардфокусабле должно возвращаться для поставщиков, размещенных в элементе управления Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="a4e53-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="a4e53-189">В этом случае поставщику окна по умолчанию может не удастся получить правильное значение.</span><span class="sxs-lookup"><span data-stu-id="a4e53-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="a4e53-190">Свойство Name обычно предоставляется поставщиком узла.</span><span class="sxs-lookup"><span data-stu-id="a4e53-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="a4e53-191">События от поставщиков</span><span class="sxs-lookup"><span data-stu-id="a4e53-191">Events from Providers</span></span>

<span data-ttu-id="a4e53-192">Поставщики автоматизации пользовательского интерфейса должны создавать события для уведомления клиентских приложений об изменениях в состоянии пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="a4e53-193">Для вызова событий используются следующие функции.</span><span class="sxs-lookup"><span data-stu-id="a4e53-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="a4e53-194">Функция</span><span class="sxs-lookup"><span data-stu-id="a4e53-194">Function</span></span>                                                                                   | <span data-ttu-id="a4e53-195">Описание</span><span class="sxs-lookup"><span data-stu-id="a4e53-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a4e53-196">**уиараисеаутоматионевент**</span><span class="sxs-lookup"><span data-stu-id="a4e53-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="a4e53-197">Создает различные события, включая события, вызываемые шаблонами элементов управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="a4e53-198">**уиараисеаутоматионпропертичанжедевент**</span><span class="sxs-lookup"><span data-stu-id="a4e53-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="a4e53-199">Вызывает событие при изменении свойства модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="a4e53-200">**уиараисеструктуречанжедевент**</span><span class="sxs-lookup"><span data-stu-id="a4e53-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="a4e53-201">Вызывает событие при изменении структуры дерева автоматизации пользовательского интерфейса, например путем удаления или добавления элемента.</span><span class="sxs-lookup"><span data-stu-id="a4e53-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="a4e53-202">Назначение события — уведомление клиента о том, что происходит в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="a4e53-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="a4e53-203">Поставщики должны создавать события независимо от того, активировалось ли это изменение с помощью пользовательского ввода или клиентского приложения, использующего автоматизацию пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="a4e53-204">Например, событие, идентифицированное с помощью [**UIA \_ Invoke \_ инвокедевентид**](uiauto-event-ids.md) , должно вызываться всякий раз, когда вызывается элемент управления, либо путем прямого ввода данных пользователем, либо клиентским приложением, вызывающим метод [**иуиаутоматионинвокепаттерн:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="a4e53-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="a4e53-205">Для оптимизации производительности поставщик можно выборочно вызывать события или вообще не создавать события, если отсутствует клиентское приложение, зарегистрированное для их получения.</span><span class="sxs-lookup"><span data-stu-id="a4e53-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="a4e53-206">Для оптимизации используются следующие элементы API.</span><span class="sxs-lookup"><span data-stu-id="a4e53-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="a4e53-207">API, элемент</span><span class="sxs-lookup"><span data-stu-id="a4e53-207">API Element</span></span>                                                                       | <span data-ttu-id="a4e53-208">Описание</span><span class="sxs-lookup"><span data-stu-id="a4e53-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a4e53-209">**уиаклиентсарелистенинг**</span><span class="sxs-lookup"><span data-stu-id="a4e53-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="a4e53-210">Эта функция проверяет, подписаны ли какие либо клиентские приложения на события модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="a4e53-211">**иравелементпровидерадвисивентс**</span><span class="sxs-lookup"><span data-stu-id="a4e53-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="a4e53-212">Реализация этого интерфейса в корне фрагмента позволяет поставщику получать рекомендации, когда клиенты регистрируют и отменяют регистрацию обработчиков событий в фрагменте.</span><span class="sxs-lookup"><span data-stu-id="a4e53-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="a4e53-213">Подобно реализации подсчета ссылок в программировании COM, поставщики автоматизации пользовательского интерфейса должны обрабатывать методы [**иравелементпровидерадвисивентс:: адвисивентаддед**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) и [**адвисивентремовед**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) , такие как [**IUnknown:: AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) и [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) в интерфейсе [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="a4e53-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="a4e53-214">Пока **адвисивентаддед** вызывал больше времени, чем **адвисивентремовед** для определенного события или свойства, поставщик должен по-прежнему вызывать соответствующие события, так как некоторые клиенты все еще ожидают прослушивание.</span><span class="sxs-lookup"><span data-stu-id="a4e53-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="a4e53-215">Кроме того, поставщики автоматизации пользовательского интерфейса могут использовать функцию [**уиаклиентсарелистенинг**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) , чтобы определить, прослушивается ли хотя бы один клиент, и, если это так, вызвать все соответствующие события.</span><span class="sxs-lookup"><span data-stu-id="a4e53-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="a4e53-216">Навигация поставщика</span><span class="sxs-lookup"><span data-stu-id="a4e53-216">Provider Navigation</span></span>

<span data-ttu-id="a4e53-217">Поставщики простых элементов управления, таких как пользовательская кнопка, размещенная в окне, не нуждаются в поддержке навигации в дереве модели автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="a4e53-218">Переход к элементу и из него обрабатывается поставщиком по умолчанию для главного окна, которое указывается в реализации [**иравелементпровидерсимпле:: хостравелементпровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span><span class="sxs-lookup"><span data-stu-id="a4e53-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="a4e53-219">Однако при реализации поставщика сложного пользовательского элемента управления необходимо поддерживать навигацию между корневым узлом фрагмента и его потомками, а также между одноуровневыми узлами.</span><span class="sxs-lookup"><span data-stu-id="a4e53-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="a4e53-220">Элементы фрагмента, отличные от корневого, должны возвращать **значение NULL** из [**хостравелементпровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), поскольку они не размещаются непосредственно в окне, а поставщик по умолчанию не может поддерживать навигацию по ним.</span><span class="sxs-lookup"><span data-stu-id="a4e53-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="a4e53-221">Структура фрагмента определяется реализацией [**иравелементпровидерфрагмент:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span><span class="sxs-lookup"><span data-stu-id="a4e53-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="a4e53-222">Для каждого возможного направления из каждого фрагмента этот метод возвращает объект поставщика для элемента в указанном направлении.</span><span class="sxs-lookup"><span data-stu-id="a4e53-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="a4e53-223">Если в этом направлении нет элемента, метод возвращает **значение NULL**.</span><span class="sxs-lookup"><span data-stu-id="a4e53-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="a4e53-224">Корневой элемент фрагмента поддерживает переход только к дочерним элементам.</span><span class="sxs-lookup"><span data-stu-id="a4e53-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="a4e53-225">Например, список возвращает первый элемент в списке, если направлением является **навигатедиректион \_ FirstChild**, и возвращает последний элемент, когда направление — **навигатедиректион \_ LastChild**.</span><span class="sxs-lookup"><span data-stu-id="a4e53-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="a4e53-226">Корневой элемент фрагмента не поддерживает переходы к родителю или к родственным элементам; это обрабатывается поставщиком главного окна.</span><span class="sxs-lookup"><span data-stu-id="a4e53-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="a4e53-227">Элементы фрагмента, отличные от корневого, должны поддерживать переходы к родительскому элементу, а также любым одноуровневым и дочерним элементам.</span><span class="sxs-lookup"><span data-stu-id="a4e53-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="a4e53-228">Назначение нового родителя</span><span class="sxs-lookup"><span data-stu-id="a4e53-228">Assigning a New Parent</span></span>

<span data-ttu-id="a4e53-229">Всплывающие окна являются окнами верхнего уровня, и по умолчанию они отображаются в дереве модели автоматизации пользовательского интерфейса как дочерние элементы рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="a4e53-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="a4e53-230">Однако во многих случаях всплывающие окна логически являются потомками других элементов управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="a4e53-231">Например, раскрывающийся список поля со списком логически является дочерним элементом поля со списком.</span><span class="sxs-lookup"><span data-stu-id="a4e53-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="a4e53-232">Аналогичным образом всплывающее окно меню логически является дочерним элементом меню.</span><span class="sxs-lookup"><span data-stu-id="a4e53-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="a4e53-233">Модель автоматизации пользовательского интерфейса позволяет назначить новый родительский элемент для всплывающего окна, чтобы он являлся дочерним по отношению к связанному элементу управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="a4e53-234">Чтобы назначить новый родительский элемент для всплывающего окна, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="a4e53-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="a4e53-235">Создайте поставщик для всплывающего окна.</span><span class="sxs-lookup"><span data-stu-id="a4e53-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="a4e53-236">Для этого класс всплывающего окна должен быть известен заранее.</span><span class="sxs-lookup"><span data-stu-id="a4e53-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="a4e53-237">Реализуйте все свойства и шаблоны элементов управления обычным образом для этого всплывающего окна, как будто это элемент управления в его собственном правом.</span><span class="sxs-lookup"><span data-stu-id="a4e53-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="a4e53-238">Реализуйте свойство [**иравелементпровидерсимпле:: хостравелементпровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) , чтобы оно возвращало значение, полученное от [**уиахостпровидерфромхвнд**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), где параметр является маркером окна всплывающего окна.</span><span class="sxs-lookup"><span data-stu-id="a4e53-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="a4e53-239">Реализуйте [**иравелементпровидерфрагмент:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) для всплывающего окна и его родителя, чтобы правильно обработать навигацию от логического родителя к логическим дочерним элементам и между одноуровневыми потомками.</span><span class="sxs-lookup"><span data-stu-id="a4e53-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="a4e53-240">Когда модель автоматизации пользовательского интерфейса встречает всплывающее окно, она распознает, что переход переопределяется из значения по умолчанию, и пропускает всплывающее окно, когда оно встречается в качестве дочернего элемента рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="a4e53-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="a4e53-241">Вместо этого узел доступен только через фрагмент.</span><span class="sxs-lookup"><span data-stu-id="a4e53-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="a4e53-242">Назначение нового родителя не подходит для случаев, когда элемент управления может размещать окно любого класса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="a4e53-243">Например, элемент управления "Главная панель" может размещать в своих диапазонах любой тип окна.</span><span class="sxs-lookup"><span data-stu-id="a4e53-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="a4e53-244">Чтобы справиться с этими случаями, модель автоматизации пользовательского интерфейса поддерживает альтернативную форму перемещения окна, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="a4e53-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="a4e53-245">Изменение расположения поставщика</span><span class="sxs-lookup"><span data-stu-id="a4e53-245">Provider Repositioning</span></span>

<span data-ttu-id="a4e53-246">Фрагменты автоматизации пользовательского интерфейса могут содержать два или более элементов, каждый из которых содержится в окне.</span><span class="sxs-lookup"><span data-stu-id="a4e53-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="a4e53-247">Поскольку каждое окно имеет собственный поставщик по умолчанию, который считает, что окно является дочерним по отношению к содержащему окну, дерево модели автоматизации пользовательского интерфейса по умолчанию будет показывать окна в фрагменте как дочерние элементы родительского окна.</span><span class="sxs-lookup"><span data-stu-id="a4e53-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="a4e53-248">В большинстве случаев это предпочтительное поведение, но иногда это может привести к путанице, поскольку оно не соответствует логической структуре пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a4e53-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="a4e53-249">Хорошим примером служит элемент управления главной панели.</span><span class="sxs-lookup"><span data-stu-id="a4e53-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="a4e53-250">Элемент управления "Главная панель" содержит полосы, каждая из которых может в свою очередь содержать элемент управления на основе окна, например панель инструментов, поле ввода или поле со списком.</span><span class="sxs-lookup"><span data-stu-id="a4e53-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="a4e53-251">Поставщик окна по умолчанию для окна главной панели видит окна управления полосой как дочерние элементы, а поставщик главной панели видит их как дочерние элементы.</span><span class="sxs-lookup"><span data-stu-id="a4e53-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="a4e53-252">Так как поставщик окон и поставщик главной панели работают совместно и объединяют их дочерние элементы, как полосы, так и элементы управления на основе окон отображаются как дочерние элементы элемента управления "Главная панель".</span><span class="sxs-lookup"><span data-stu-id="a4e53-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="a4e53-253">Логически, однако, только полосы должны отображаться как дочерние элементы элемента управления главной панели, и каждый поставщик диапазона должен быть связан с поставщиком окна по умолчанию для элемента управления, который он содержит.</span><span class="sxs-lookup"><span data-stu-id="a4e53-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="a4e53-254">Для этого корневой поставщик фрагмента для элемента управления "Главная панель" предоставляет набор дочерних элементов, представляющих полосы.</span><span class="sxs-lookup"><span data-stu-id="a4e53-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="a4e53-255">Каждый диапазон имеет один поставщик, который может предоставлять свойства и шаблоны элементов управления.</span><span class="sxs-lookup"><span data-stu-id="a4e53-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="a4e53-256">В реализации [**иравелементпровидерсимпле:: хостравелементпровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider)поставщик диапазонов Возвращает поставщик окна по умолчанию для окна управления, которое оно получает путем вызова [**уиахостпровидерфромхвнд**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), передавая дескриптор окна элемента управления (**HWND**).</span><span class="sxs-lookup"><span data-stu-id="a4e53-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="a4e53-257">Наконец, поставщик корневого элемента фрагмента для главной панели реализует интерфейс [**иравелементпровидерхвндоверриде**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) , и в его реализации [**Иравелементпровидерхвндоверриде:: жетоверридепровидерфорхвнд**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd)он возвращает соответствующий поставщик управления, содержащийся в указанном окне.</span><span class="sxs-lookup"><span data-stu-id="a4e53-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="a4e53-258">Отключение поставщиков</span><span class="sxs-lookup"><span data-stu-id="a4e53-258">Disconnecting Providers</span></span>

<span data-ttu-id="a4e53-259">Приложения обычно создают элементы управления по мере необходимости и удаляют их впоследствии.</span><span class="sxs-lookup"><span data-stu-id="a4e53-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="a4e53-260">После уничтожения элемента управления ресурсы поставщика автоматизации пользовательского интерфейса, связанные с элементом управления, должны быть освобождены путем вызова метода [**уиадисконнектпровидер**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span><span class="sxs-lookup"><span data-stu-id="a4e53-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="a4e53-261">Аналогичным образом приложение должно использовать функцию [**уиадисконнекталлпровидерс**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) , чтобы освободить все ресурсы модели автоматизации пользовательского интерфейса, удерживаемые всеми поставщиками в приложении, перед завершением работы.</span><span class="sxs-lookup"><span data-stu-id="a4e53-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a4e53-262">См. также</span><span class="sxs-lookup"><span data-stu-id="a4e53-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a4e53-263">Рекомендации программиста поставщика модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="a4e53-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 