---
description: Рабочий набор процесса — это набор страниц в виртуальном адресном пространстве процесса, которые в настоящий момент находятся в физической памяти.
ms.assetid: ff05276a-1d40-4844-b649-10e32e3f1937
title: Рабочий набор
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4985e7eb526d5dda8469ccc2f46bfe6fd050c745
ms.sourcegitcommit: b01ad017c152c6756f3638623fe335877644d414
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/06/2021
ms.locfileid: "111549896"
---
# <a name="working-set"></a>Рабочий набор

Рабочий набор процесса — это набор страниц в виртуальном адресном пространстве процесса, которые в настоящий момент находятся в физической памяти. Рабочий набор содержит только страничные выделения памяти. нестраничные выделения памяти, такие как [расширения](address-windowing-extensions.md) AWE или большие объемы [страниц](large-page-support.md) , не включаются в рабочий набор.

Если процесс ссылается на страничную память, которая в данный момент не находится в рабочем наборе, возникает *Ошибка страницы* . Обработчик ошибок системной страницы пытается разрешить ошибку страницы и, если она будет выполнена, эта страница добавляется в рабочий набор. (Доступ к расширениям AWE или большим страницам при выделении страниц никогда не вызывает ошибки страницы, так как эти выделения не являются страничными.)

*Сбой жесткой страницы* должен быть разрешен путем считывания содержимого страницы из *резервного хранилища* страницы, которое является либо системным файлом подкачки, либо размещенным в памяти файлом, созданным процессом. *Сбой страницы с мягкими ошибками* может быть разрешен без доступа к резервному хранилищу. Сбой страницы с мягкими ошибками возникает в следующих случаях:

-   Эта страница находится в рабочем множестве других процессов, поэтому она уже находится в памяти.
-   Страница находится в состоянии перехода, так как она была удалена из рабочих наборов всех процессов, которые использовали эту страницу и еще не были переназначены, либо уже является резидентным в результате операции предварительной выборки диспетчера памяти.
-   Процесс ссылается на выделенную виртуальную страницу в первый раз (иногда это называется *сбоем с нулевым требованием*).

Страницы могут быть удалены из рабочего набора процесса в результате выполнения следующих действий.

-   Процесс сокращает или очищает рабочий набор, вызывая функцию [**сетпроцессворкингсетсизе**](/windows/win32/api/memoryapi/nf-memoryapi-setprocessworkingsetsize), [**сетпроцессворкингсетсизикс**](/windows/win32/api/memoryapi/nf-memoryapi-setprocessworkingsetsizeex) или [**емптиворкингсет**](/windows/win32/api/psapi/nf-psapi-emptyworkingset) .
-   Этот процесс вызывает функцию [**виртуалунлокк**](/windows/win32/api/memoryapi/nf-memoryapi-virtualunlock) для незаблокированного диапазона памяти.
-   Процесс отменяет сопоставление сопоставленного представления файла с помощью функции [**UnmapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-unmapviewoffile) .
-   Диспетчер памяти усекает страницы рабочего набора для создания большего объема доступной памяти.
-   Диспетчер памяти должен удалить страницу из рабочего набора, чтобы освободить место для новой страницы (например, так как рабочий набор имеет максимальный размер).

Если несколько процессов совместно используют одну страницу, удаление страницы из рабочего набора одного процесса не влияет на другие процессы. После удаления страницы из рабочих наборов всех процессов, которые ее используют, страница становится *переходной страницей*. Страницы переходов остаются в кэше ОЗУ до тех пор, пока страница не будет снова указана каким-либо процессом или перенаправлена (например, заполнена нулями и передана другому процессу). Если страница перехода была изменена с момента последней запись на диск (т. е. Если страница является "грязной"), то эту страницу необходимо записать в резервное хранилище, прежде чем ее можно будет перепланировать. Система может начать запись страниц «грязных» переходов в резервное хранилище, как только эти страницы станут доступны.

Каждый процесс имеет минимальный и максимальный размер рабочего множества, влияющие на режим разбиения на страницы виртуальной памяти процесса. Чтобы получить текущий размер рабочего набора указанного процесса, используйте функцию [**жетпроцессмеморинфо**](/windows/win32/api/psapi/nf-psapi-getprocessmemoryinfo) . Чтобы получить или изменить минимальный и максимальный размеры рабочего множества, используйте функции [**жетпроцессворкингсетсизикс**](/windows/win32/api/memoryapi/nf-memoryapi-getprocessworkingsetsizeex) и [**сетпроцессворкингсетсизикс**](/windows/win32/api/memoryapi/nf-memoryapi-setprocessworkingsetsizeex) .

Программный интерфейс "состояние процесса" (PSAPI) предоставляет ряд функций, возвращающих подробные сведения о рабочем наборе процесса. Дополнительные сведения см. в разделе [сведения о рабочем множестве](../psapi/working-set-information.md).

 

 
