---
description: Функция VirtualFree выфиксирует и освобождает страницы в соответствии со следующими правилами.
ms.assetid: 8fbd7960-f3f0-4326-ad1d-12b636c0039e
title: Освобождение виртуальной памяти
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a7628ed53f956d5cd13f0c7d2d1157443d529129
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673264"
---
# <a name="freeing-virtual-memory"></a><span data-ttu-id="0f2d3-103">Освобождение виртуальной памяти</span><span class="sxs-lookup"><span data-stu-id="0f2d3-103">Freeing Virtual Memory</span></span>

<span data-ttu-id="0f2d3-104">Функция [**VirtualFree**](/windows/win32/api/memoryapi/nf-memoryapi-virtualfree) снимает и освобождает страницы в соответствии со следующими правилами.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-104">The [**VirtualFree**](/windows/win32/api/memoryapi/nf-memoryapi-virtualfree) function decommits and releases pages according to the following rules:</span></span>

-   <span data-ttu-id="0f2d3-105">Отменяет фиксацию одной или нескольких зафиксированных страниц, изменяя состояние зарезервированных страниц.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-105">Decommits one or more committed pages, changing the state of the pages to reserved.</span></span> <span data-ttu-id="0f2d3-106">При дефиксации страниц освобождается физическое хранилище, связанное со страницами, что делает ее доступной для любого процесса.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-106">Decommitting pages releases the physical storage associated with the pages, making it available to be allocated by any process.</span></span> <span data-ttu-id="0f2d3-107">Любой блок зафиксированных страниц может быть незафиксированным.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-107">Any block of committed pages can be decommitted.</span></span>
-   <span data-ttu-id="0f2d3-108">Освобождает блок из одной или нескольких зарезервированных страниц, изменяя состояние страниц на Free.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-108">Releases a block of one or more reserved pages, changing the state of the pages to free.</span></span> <span data-ttu-id="0f2d3-109">Освобождение блока страниц делает диапазон зарезервированных адресов доступным для процесса.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-109">Releasing a block of pages makes the range of reserved addresses available to be allocated by the process.</span></span> <span data-ttu-id="0f2d3-110">Зарезервированные страницы можно освободить только путем освобождения всего блока, первоначально зарезервированного [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc).</span><span class="sxs-lookup"><span data-stu-id="0f2d3-110">Reserved pages can be released only by freeing the entire block that was initially reserved by [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc).</span></span>
-   <span data-ttu-id="0f2d3-111">Отменяет фиксацию и освобождение блока одной или нескольких зафиксированных страниц, изменяя состояние страниц на Free.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-111">Decommits and releases a block of one or more committed pages simultaneously, changing the state of the pages to free.</span></span> <span data-ttu-id="0f2d3-112">Указанный блок должен включать весь блок, изначально зарезервированный [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), и все страницы должны быть зафиксированы.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-112">The specified block must include the entire block initially reserved by [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), and all of the pages must be currently committed.</span></span>

<span data-ttu-id="0f2d3-113">После того как блок памяти будет освобожден или снят, вы не сможете снова обратиться к нему.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-113">After a memory block is released or decommitted, you can never refer to it again.</span></span> <span data-ttu-id="0f2d3-114">Все данные, которые могли наблюдаться в этой памяти, пропали бесконечно.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-114">Any information that may have been in that memory is gone forever.</span></span> <span data-ttu-id="0f2d3-115">Попытка чтения или записи на свободную страницу приводит к исключению нарушения прав доступа.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-115">Attempting to read from or write to a free page results in an access violation exception.</span></span> <span data-ttu-id="0f2d3-116">Если требуется информация, не вынуждайте или освободите память, содержащую эти сведения.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-116">If you require information, do not decommit or free memory containing that information.</span></span>

<span data-ttu-id="0f2d3-117">Чтобы указать, что данные в диапазоне памяти больше не нужны, вызовите [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) с **\_ сбросом MEM**.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-117">To specify that the data in a memory range is no longer of interest, call [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) with **MEM\_RESET**.</span></span> <span data-ttu-id="0f2d3-118">Страницы не будут считываться или записываться в файл подкачки.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-118">The pages will not be read from or written to the paging file.</span></span> <span data-ttu-id="0f2d3-119">Однако блок памяти можно использовать снова позже.</span><span class="sxs-lookup"><span data-stu-id="0f2d3-119">However, the memory block can be used again later.</span></span>

 

 
