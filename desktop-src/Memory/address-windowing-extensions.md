---
description: Расширения AWE — это набор расширений, позволяющих приложению быстро управлять физической памятью более 4 ГБ.
ms.assetid: 48a29922-8130-4540-86b0-0faa120566a6
title: Расширения для окон адресов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8cb311bf9ecef2de334018ca3f9982a31f0b072
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909484"
---
# <a name="address-windowing-extensions"></a><span data-ttu-id="871d8-103">Расширения для окон адресов</span><span class="sxs-lookup"><span data-stu-id="871d8-103">Address Windowing Extensions</span></span>

<span data-ttu-id="871d8-104">Расширения AWE — это набор расширений, позволяющих приложению быстро управлять физической памятью более 4 ГБ.</span><span class="sxs-lookup"><span data-stu-id="871d8-104">Address Windowing Extensions (AWE) is a set of extensions that allows an application to quickly manipulate physical memory greater than 4GB.</span></span> <span data-ttu-id="871d8-105">Для некоторых приложений, интенсивно использующих данные, таких как системы управления базами данных и инженерных и инженерных программ, необходим доступ к очень большим кэшам данных.</span><span class="sxs-lookup"><span data-stu-id="871d8-105">Certain data-intensive applications, such as database management systems and scientific and engineering software, need access to very large caches of data.</span></span> <span data-ttu-id="871d8-106">В случае с очень большими наборами данных ограничение размера кэша в пределах 2 ГБ адресного пространства пользователя является очень строгим.</span><span class="sxs-lookup"><span data-stu-id="871d8-106">In the case of very large data sets, restricting the cache to fit within an application's 2GB of user address space is a severe restriction.</span></span> <span data-ttu-id="871d8-107">В таких ситуациях кэш слишком мал для правильной поддержки приложения.</span><span class="sxs-lookup"><span data-stu-id="871d8-107">In these situations, the cache is too small to properly support the application.</span></span>

<span data-ttu-id="871d8-108">AWE решает эту проблему, позволяя приложениям напрямую обращаться к большим объемам памяти, продолжая использовать 32-разрядные указатели.</span><span class="sxs-lookup"><span data-stu-id="871d8-108">AWE solves this problem by allowing applications to directly address huge amounts of memory while continuing to use 32-bit pointers.</span></span> <span data-ttu-id="871d8-109">Расширения AWE позволяют приложениям иметь кэш данных размером более 4 ГБ (при наличии достаточного объема физической памяти).</span><span class="sxs-lookup"><span data-stu-id="871d8-109">AWE allows applications to have data caches larger than 4GB (where sufficient physical memory is present).</span></span> <span data-ttu-id="871d8-110">Расширения AWE используют физическую нестраничную память и представления окон различных частей физической памяти в пределах 32-битного виртуального адресного пространства.</span><span class="sxs-lookup"><span data-stu-id="871d8-110">AWE uses physical nonpaged memory and window views of various portions of this physical memory within a 32-bit virtual address space.</span></span>

<span data-ttu-id="871d8-111">Расширения AWE накладывают несколько ограничений на то, как может использоваться эта память, в первую очередь, потому что эти ограничения позволяют очень быстро сопоставлять, повторно сопоставлять и освобождать.</span><span class="sxs-lookup"><span data-stu-id="871d8-111">AWE places a few restrictions on how this memory may be used, primarily because these restrictions allow extremely fast mapping, remapping, and freeing.</span></span> <span data-ttu-id="871d8-112">Высокая скорость управления памятью важна для этих потенциально неогромных адресных пространств.</span><span class="sxs-lookup"><span data-stu-id="871d8-112">Fast memory management is important for these potentially enormous address spaces.</span></span>

-   <span data-ttu-id="871d8-113">Диапазоны виртуальных адресов, выделенные для расширений AWE, не могут совместно обрабатываться другими процессами (и поэтому не наследуются).</span><span class="sxs-lookup"><span data-stu-id="871d8-113">Virtual address ranges allocated for the AWE are not sharable with other processes (and therefore not inheritable).</span></span> <span data-ttu-id="871d8-114">На самом деле два разных виртуальных адреса AWE в одном процессе не могут сопоставлять одну и ту же физическую страницу.</span><span class="sxs-lookup"><span data-stu-id="871d8-114">In fact, two different AWE virtual addresses within the same process are not allowed to map the same physical page.</span></span> <span data-ttu-id="871d8-115">Эти ограничения обеспечивают быстрое повторное сопоставление и очистку при освобождении памяти.</span><span class="sxs-lookup"><span data-stu-id="871d8-115">These restrictions provide fast remapping and cleanup when memory is freed.</span></span>
-   <span data-ttu-id="871d8-116">Физические страницы, которые могут быть выделены для области AWE, ограничены числом физических страниц, имеющихся на компьютере, так как эта память никогда не помещается в разбивку на страницы. она блокируется до тех пор, пока приложение явно не освободит его или не завершит работу.</span><span class="sxs-lookup"><span data-stu-id="871d8-116">The physical pages that can be allocated for an AWE region are limited by the number of physical pages present in the machine, since this memory is never paged – it is locked down until the application explicitly frees it or exits.</span></span> <span data-ttu-id="871d8-117">Физические страницы, выделенные для данного процесса, можно сопоставить с любой виртуальной областью AWE в рамках одного процесса.</span><span class="sxs-lookup"><span data-stu-id="871d8-117">The physical pages allocated for a given process can be mapped into any AWE virtual region within the same process.</span></span> <span data-ttu-id="871d8-118">Приложения, использующие расширения AWE, должны быть внимательны, чтобы не занимать настолько много физической памяти, что они приводят к чрезмерной нагрузке на другие приложения или препятствуют созданию новых процессов или потоков из-за нехватки ресурсов.</span><span class="sxs-lookup"><span data-stu-id="871d8-118">Applications that use AWE must be careful not to take so much physical memory that they cause other applications to page excessively or prevent creation of new processes or threads due to lack of resources.</span></span> <span data-ttu-id="871d8-119">Используйте функцию [**глобалмемористатусекс**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) для отслеживания использования физической памяти.</span><span class="sxs-lookup"><span data-stu-id="871d8-119">Use the [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) function to monitor physical memory use.</span></span>
-   <span data-ttu-id="871d8-120">Виртуальные адреса AWE всегда доступны для чтения и записи и не могут быть защищены посредством вызовов [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) (т. е. нет памяти только для чтения, недоступна память, страницы защиты и т. д.).</span><span class="sxs-lookup"><span data-stu-id="871d8-120">AWE virtual addresses are always read/write and cannot be protected via calls to [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) (that is, no read-only memory, noaccess memory, guard pages, and the like can be specified).</span></span>
-   <span data-ttu-id="871d8-121">Диапазоны адресов AWE нельзя использовать для буферизации данных для видеоадаптеров или видеовызовов.</span><span class="sxs-lookup"><span data-stu-id="871d8-121">AWE address ranges cannot be used to buffer data for graphics or video calls.</span></span>
-   <span data-ttu-id="871d8-122">Диапазон памяти AWE не может быть разделен, и его части нельзя удалить.</span><span class="sxs-lookup"><span data-stu-id="871d8-122">An AWE memory range cannot be split, nor can pieces of it be deleted.</span></span> <span data-ttu-id="871d8-123">Вместо этого весь диапазон виртуальных адресов должен быть удален как единица, если требуется удаление.</span><span class="sxs-lookup"><span data-stu-id="871d8-123">Instead, the entire virtual address range must be deleted as a unit when deletion is required.</span></span> <span data-ttu-id="871d8-124">Это означает, что при вызове [**VirtualFree**](/windows/win32/api/memoryapi/nf-memoryapi-virtualfree)необходимо указать **\_ выпуск MEM** .</span><span class="sxs-lookup"><span data-stu-id="871d8-124">This means you must specify **MEM\_RELEASE** when calling [**VirtualFree**](/windows/win32/api/memoryapi/nf-memoryapi-virtualfree).</span></span>
-   <span data-ttu-id="871d8-125">Приложения могут сопоставлять несколько регионов одновременно, если они не перекрываются.</span><span class="sxs-lookup"><span data-stu-id="871d8-125">Applications can map multiple regions simultaneously, provided they do not overlap.</span></span>
-   <span data-ttu-id="871d8-126">Приложения, использующие расширения AWE, не поддерживаются в режиме эмуляции.</span><span class="sxs-lookup"><span data-stu-id="871d8-126">Applications that use AWE are not supported in emulation mode.</span></span> <span data-ttu-id="871d8-127">Это значит, что приложение x86, использующее функции AWE, должно быть перекомпилировано для запуска на другом процессоре, в то время как большинство приложений могут выполняться без перекомпиляции в эмуляторе на других платформах.</span><span class="sxs-lookup"><span data-stu-id="871d8-127">That is, an x86 application that uses AWE functions must be recompiled to run on another processor, whereas most applications can run without recompiling under an emulator on other platforms.</span></span>

<span data-ttu-id="871d8-128">Это решение устраняет проблемы физической памяти в очень общем и широко применимом способе.</span><span class="sxs-lookup"><span data-stu-id="871d8-128">This solution addresses the physical memory issues in a very general, widely applicable manner.</span></span> <span data-ttu-id="871d8-129">Ниже перечислены некоторые преимущества расширений AWE.</span><span class="sxs-lookup"><span data-stu-id="871d8-129">Some of the benefits of AWE are:</span></span>

-   <span data-ttu-id="871d8-130">Для обработки памяти AWE определена небольшая группа новых функций.</span><span class="sxs-lookup"><span data-stu-id="871d8-130">A small group of new functions is defined to manipulate AWE memory.</span></span>
-   <span data-ttu-id="871d8-131">Расширения AWE обеспечивают очень быструю возможность повторного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="871d8-131">AWE provides a very fast remapping capability.</span></span> <span data-ttu-id="871d8-132">Повторное сопоставление выполняется путем манипулирования таблицами виртуальной памяти, а не перемещением данных в физическую память.</span><span class="sxs-lookup"><span data-stu-id="871d8-132">Remapping is done by manipulating virtual memory tables, not by moving data in physical memory.</span></span>
-   <span data-ttu-id="871d8-133">Расширения AWE обеспечивают гранулярность размера страницы, соответствующую процессору (например, 4 КБ на x86), что более полезно для приложений, чем большие страницы (например, 2 МБ или 4 МБ на платформе x86).</span><span class="sxs-lookup"><span data-stu-id="871d8-133">AWE provides page size granularity appropriate to the processor (for example, 4 KB on x86), which is more useful to applications than large pages (for example, 2MB or 4MB on x86).</span></span>

<span data-ttu-id="871d8-134">Для использования расширений AWE приложение должно иметь разрешение Блокировка страниц в памяти.</span><span class="sxs-lookup"><span data-stu-id="871d8-134">An application must have the Lock Pages in Memory privilege to use AWE.</span></span> <span data-ttu-id="871d8-135">Чтобы получить эту привилегию, администратор должен добавить **блокировку страниц в памяти** в **назначения прав пользователя**.</span><span class="sxs-lookup"><span data-stu-id="871d8-135">To obtain this privilege, an administrator must add **Lock Pages in Memory** to the user's **User Rights Assignments**.</span></span> <span data-ttu-id="871d8-136">Дополнительные сведения о том, как это сделать, см. в разделе "права пользователя" справки по операционной системе.</span><span class="sxs-lookup"><span data-stu-id="871d8-136">For more information on how to do this, see "User Rights" in the operating system help.</span></span>

<span data-ttu-id="871d8-137">Следующие функции составляют API расширений AWE.</span><span class="sxs-lookup"><span data-stu-id="871d8-137">The following functions make up the Address Windowing Extensions (AWE) API.</span></span>



| <span data-ttu-id="871d8-138">Функция</span><span class="sxs-lookup"><span data-stu-id="871d8-138">Function</span></span>                                                                          | <span data-ttu-id="871d8-139">Описание</span><span class="sxs-lookup"><span data-stu-id="871d8-139">Description</span></span>                                                                                                                                                                                                                                               |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="871d8-140">[**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) и [ **виртуалаллоцекс**](/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex)</span><span class="sxs-lookup"><span data-stu-id="871d8-140">[**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) and [**VirtualAllocEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex)</span></span> | <span data-ttu-id="871d8-141">Зарезервируйте часть виртуального адресного пространства, используемую для расширений AWE, с помощью функции **mem \_ PHYSICAL**.</span><span class="sxs-lookup"><span data-stu-id="871d8-141">Reserve a portion of virtual address space to use for AWE, using **MEM\_PHYSICAL**.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="871d8-142">**аллокатеусерфисикалпажес**</span><span class="sxs-lookup"><span data-stu-id="871d8-142">**AllocateUserPhysicalPages**</span></span>](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages)                    | <span data-ttu-id="871d8-143">Выделение физической памяти для использования с расширениями AWE.</span><span class="sxs-lookup"><span data-stu-id="871d8-143">Allocate physical memory for use with AWE.</span></span>                                                                                                                                                                                                                |
| [<span data-ttu-id="871d8-144">**мапусерфисикалпажес**</span><span class="sxs-lookup"><span data-stu-id="871d8-144">**MapUserPhysicalPages**</span></span>](/windows/win32/api/memoryapi/nf-memoryapi-mapuserphysicalpages)                              | <span data-ttu-id="871d8-145">Сопоставьте виртуальные адреса AWE (или сделает их недействительными) с любым набором физических страниц, полученных с помощью [**аллокатеусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages).</span><span class="sxs-lookup"><span data-stu-id="871d8-145">Map (or invalidate) AWE virtual addresses onto any set of physical pages obtained with [**AllocateUserPhysicalPages**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages).</span></span>                                                                                                    |
| [<span data-ttu-id="871d8-146">**мапусерфисикалпажесскаттер**</span><span class="sxs-lookup"><span data-stu-id="871d8-146">**MapUserPhysicalPagesScatter**</span></span>](/windows/desktop/api/WinBase/nf-winbase-mapuserphysicalpagesscatter)                | <span data-ttu-id="871d8-147">Сопоставьте виртуальные адреса AWE (или сделает их недействительными) с любым набором физических страниц, полученных с помощью [**аллокатеусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages), но с более детализированным контролем, чем предоставлено [**мапусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-mapuserphysicalpages).</span><span class="sxs-lookup"><span data-stu-id="871d8-147">Map (or invalidate) AWE virtual addresses onto any set of physical pages obtained with [**AllocateUserPhysicalPages**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages), but with finer control than that provided by [**MapUserPhysicalPages**](/windows/win32/api/memoryapi/nf-memoryapi-mapuserphysicalpages).</span></span> |
| [<span data-ttu-id="871d8-148">**фриусерфисикалпажес**</span><span class="sxs-lookup"><span data-stu-id="871d8-148">**FreeUserPhysicalPages**</span></span>](/windows/win32/api/memoryapi/nf-memoryapi-freeuserphysicalpages)                            | <span data-ttu-id="871d8-149">Свободная физическая память, используемая для расширений AWE.</span><span class="sxs-lookup"><span data-stu-id="871d8-149">Free physical memory that was used for AWE.</span></span>                                                                                                                                                                                                               |



 

 

 
