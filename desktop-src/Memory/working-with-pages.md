---
description: Чтобы определить размер страницы на текущем компьютере, используйте функцию Жетсистеминфо.
ms.assetid: 953ddfc4-6126-41fb-81a3-0ce1f0fb223f
title: Работа со страницами
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 66c12c99ada03dca1e17c72c2a5f0d5360b6a98d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104543042"
---
# <a name="working-with-pages"></a><span data-ttu-id="ad326-103">Работа со страницами</span><span class="sxs-lookup"><span data-stu-id="ad326-103">Working with Pages</span></span>

<span data-ttu-id="ad326-104">Чтобы определить размер страницы на текущем компьютере, используйте функцию [**жетсистеминфо**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) .</span><span class="sxs-lookup"><span data-stu-id="ad326-104">To determine the size of a page on the current computer, use the [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function.</span></span>

<span data-ttu-id="ad326-105">Функции [**VirtualQuery**](/windows/win32/api/memoryapi/nf-memoryapi-virtualquery) и [**виртуалкуерекс**](/windows/win32/api/memoryapi/nf-memoryapi-virtualqueryex) возвращают сведения о регионе последовательных страниц, начиная с указанного адреса в адресном пространстве процесса.</span><span class="sxs-lookup"><span data-stu-id="ad326-105">The [**VirtualQuery**](/windows/win32/api/memoryapi/nf-memoryapi-virtualquery) and [**VirtualQueryEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualqueryex) functions return information about a region of consecutive pages beginning at a specified address in the address space of a process.</span></span> <span data-ttu-id="ad326-106">**VirtualQuery** возвращает сведения о памяти в вызывающем процессе.</span><span class="sxs-lookup"><span data-stu-id="ad326-106">**VirtualQuery** returns information about memory in the calling process.</span></span> <span data-ttu-id="ad326-107">**Виртуалкуерекс** возвращает сведения о памяти в указанном процессе и используется для поддержки отладчиков, которым требуются сведения о отлаживаемом процессе.</span><span class="sxs-lookup"><span data-stu-id="ad326-107">**VirtualQueryEx** returns information about memory in a specified process and is used to support debuggers that need information about a process being debugged.</span></span> <span data-ttu-id="ad326-108">Область страниц ограничена указанным адресом, округленным вниз до ближайшей границы страницы.</span><span class="sxs-lookup"><span data-stu-id="ad326-108">The region of pages is bounded by the specified address rounded down to the nearest page boundary.</span></span> <span data-ttu-id="ad326-109">Он распространяется на все последующие страницы со следующими общими атрибутами:</span><span class="sxs-lookup"><span data-stu-id="ad326-109">It extends through all subsequent pages with the following attributes in common:</span></span>

-   <span data-ttu-id="ad326-110">Все страницы имеют одно и то же значение: зафиксированный, зарезервированный или бесплатный.</span><span class="sxs-lookup"><span data-stu-id="ad326-110">The state of all pages is the same: either committed, reserved, or free.</span></span>
-   <span data-ttu-id="ad326-111">Если начальная страница не свободна, все страницы в регионе являются частью того же начального выделения страниц, которые были зарезервированы вызовом [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc).</span><span class="sxs-lookup"><span data-stu-id="ad326-111">If the initial page is not free, all pages in the region are part of the same initial allocation of pages that were reserved by a call to [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc).</span></span>
-   <span data-ttu-id="ad326-112">Защита доступа ко всем страницам одинакова (т. е. **\_ только чтение** страниц **, \_ Чтение с страницы** или **\_ недоступность страницы**).</span><span class="sxs-lookup"><span data-stu-id="ad326-112">The access protection of all pages is the same (that is, **PAGE\_READONLY**, **PAGE\_READWRITE**, or **PAGE\_NOACCESS**).</span></span>

<span data-ttu-id="ad326-113">Функция [**виртуаллокк**](/windows/win32/api/memoryapi/nf-memoryapi-virtuallock) позволяет процессу блокировать одну или несколько страниц выделенной памяти в физическую память (ОЗУ), предотвращая Переключение страниц в файл подкачки.</span><span class="sxs-lookup"><span data-stu-id="ad326-113">The [**VirtualLock**](/windows/win32/api/memoryapi/nf-memoryapi-virtuallock) function enables a process to lock one or more pages of committed memory into physical memory (RAM), preventing the system from swapping the pages out to the paging file.</span></span> <span data-ttu-id="ad326-114">Его можно использовать для обеспечения доступности важных данных без доступа к диску.</span><span class="sxs-lookup"><span data-stu-id="ad326-114">It can be used to ensure that critical data is accessible without disk access.</span></span> <span data-ttu-id="ad326-115">Блокировка страниц в память опасно, так как она позволяет системе управлять памятью.</span><span class="sxs-lookup"><span data-stu-id="ad326-115">Locking pages into memory is dangerous because it restricts the system's ability to manage memory.</span></span> <span data-ttu-id="ad326-116">Чрезмерное использование **виртуаллокк** может снизить производительность системы, вызывая переход исполняемого кода в файл подкачки.</span><span class="sxs-lookup"><span data-stu-id="ad326-116">Excessive use of **VirtualLock** can degrade system performance by causing executable code to be swapped out to the paging file.</span></span> <span data-ttu-id="ad326-117">Функция [**виртуалунлокк**](/windows/win32/api/memoryapi/nf-memoryapi-virtualunlock) разблокирует память, Заблокированную **виртуаллокк**.</span><span class="sxs-lookup"><span data-stu-id="ad326-117">The [**VirtualUnlock**](/windows/win32/api/memoryapi/nf-memoryapi-virtualunlock) function unlocks memory locked by **VirtualLock**.</span></span>

<span data-ttu-id="ad326-118">Функция [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) позволяет процессу изменять защиту доступа всех зафиксированных страниц в адресном пространстве процесса.</span><span class="sxs-lookup"><span data-stu-id="ad326-118">The [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) function enables a process to modify the access protection of any committed page in the address space of a process.</span></span> <span data-ttu-id="ad326-119">Например, процесс может выделять страницы, доступные для чтения и записи, для хранения конфиденциальных данных, а затем может изменить доступ только на чтение или без доступа для защиты от случайной перезаписи.</span><span class="sxs-lookup"><span data-stu-id="ad326-119">For example, a process can allocate read/write pages to store sensitive data, and then it can change the access to read only or no access to protect against accidental overwriting.</span></span> <span data-ttu-id="ad326-120">**VirtualProtect** обычно используется со страницами, выделенными [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), но она также работает со страницами, зафиксированными любыми другими функциями выделения.</span><span class="sxs-lookup"><span data-stu-id="ad326-120">**VirtualProtect** is typically used with pages allocated by [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), but it also works with pages committed by any of the other allocation functions.</span></span> <span data-ttu-id="ad326-121">Однако **VirtualProtect** изменяет защиту целых страниц, и указатели, возвращаемые другими функциями, не обязательно согласовываются на границах страниц.</span><span class="sxs-lookup"><span data-stu-id="ad326-121">However, **VirtualProtect** changes the protection of entire pages, and pointers returned by the other functions are not necessarily aligned on page boundaries.</span></span> <span data-ttu-id="ad326-122">Функция [**виртуалпротектекс**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex) похожа на **VirtualProtect**, за исключением того, что она изменяет защиту памяти в указанном процессе.</span><span class="sxs-lookup"><span data-stu-id="ad326-122">The [**VirtualProtectEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex) function is similar to **VirtualProtect**, except it changes the protection of memory in a specified process.</span></span> <span data-ttu-id="ad326-123">Изменение защиты полезно для отладчиков при доступе к памяти отлаживаемого процесса.</span><span class="sxs-lookup"><span data-stu-id="ad326-123">Changing the protection is useful to debuggers in accessing the memory of a process being debugged.</span></span>

 

 
