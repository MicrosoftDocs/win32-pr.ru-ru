---
description: Программисты, использующие агент Центр обновления Windows (WUA), начинают с добавления ссылки на Wuapi.dll в текущий проект (в Visual C++, Microsoft Visual Basic или C \# ) или с помощью ссылок на вуапи. h и вугуид. lib в проекте C или C++.
ms.assetid: ec9cbb0b-b5d4-41f2-8a25-143130d08a3b
title: Объектная модель агента Центр обновления Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5060a76c850ea9ad97e9132f661d4b64f4f4fd03
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104564088"
---
# <a name="windows-update-agent-object-model"></a><span data-ttu-id="0dece-103">Объектная модель агента Центр обновления Windows</span><span class="sxs-lookup"><span data-stu-id="0dece-103">Windows Update Agent Object Model</span></span>

<span data-ttu-id="0dece-104">Программисты, использующие агент Центр обновления Windows (WUA), начинают с добавления ссылки на Wuapi.dll в текущий проект (в Visual C++, Microsoft Visual Basic или C \# ) или с помощью ссылок на вуапи. h и вугуид. lib в проекте C или C++.</span><span class="sxs-lookup"><span data-stu-id="0dece-104">Programmers using Windows Update Agent (WUA) begin by adding a reference to Wuapi.dll to their current project (in Visual C++, Microsoft Visual Basic, or C\#) or by referencing Wuapi.h and Wuguid.lib in a C or C++ project.</span></span> <span data-ttu-id="0dece-105">Первым шагом при использовании API WUA является создание экземпляра одного из интерфейсов путем создания объекта из соответствующего компонентного класса.</span><span class="sxs-lookup"><span data-stu-id="0dece-105">The first step in using the WUA API is to create an instance of one of the interfaces by creating an object from the appropriate coclass.</span></span>

<span data-ttu-id="0dece-106">На следующем рисунке описывается объектная модель WUA.</span><span class="sxs-lookup"><span data-stu-id="0dece-106">The following illustration describes the WUA object model.</span></span> <span data-ttu-id="0dece-107">Дополнительные сведения см. в разделе "[объекты WUA и связанные задачи](#wua-objects-and-associated-tasks)".</span><span class="sxs-lookup"><span data-stu-id="0dece-107">For more information, see the "[WUA Objects and Associated Tasks](#wua-objects-and-associated-tasks)" section.</span></span> <span data-ttu-id="0dece-108">Полный список всех интерфейсов WUA см. в разделе [интерфейсы](interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="0dece-108">For a complete list of all the WUA interfaces, see [Interfaces](interfaces.md).</span></span>

![Объектная модель агента обновления Windows](images/wua-object-model.png)

## <a name="wua-objects-and-associated-tasks"></a><span data-ttu-id="0dece-110">Объекты WUA и связанные задачи</span><span class="sxs-lookup"><span data-stu-id="0dece-110">WUA Objects and Associated Tasks</span></span>

<span data-ttu-id="0dece-111">В следующей таблице перечислены объекты WUA и типичные задачи, связанные с объектами WUA.</span><span class="sxs-lookup"><span data-stu-id="0dece-111">The following table lists the WUA objects and the typical tasks that are associated with the WUA objects.</span></span>



| <span data-ttu-id="0dece-112">Объект</span><span class="sxs-lookup"><span data-stu-id="0dece-112">Object</span></span>                                                                | <span data-ttu-id="0dece-113">Описание</span><span class="sxs-lookup"><span data-stu-id="0dece-113">Description</span></span>                                                                                                                                                                                                                                 |
|-----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="0dece-114">**AutomaticUpdates**</span><span class="sxs-lookup"><span data-stu-id="0dece-114">**AutomaticUpdates**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdates)                         | <span data-ttu-id="0dece-115">Начало, приостановка или возобновление автоматическое обновление.</span><span class="sxs-lookup"><span data-stu-id="0dece-115">Begin, pause, or resume Automatic Updates.</span></span>                                                                                                                                                                                                  |
| [<span data-ttu-id="0dece-116">**аутоматикупдатессеттингс**</span><span class="sxs-lookup"><span data-stu-id="0dece-116">**AutomaticUpdatesSettings**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdatessettings)         | <span data-ttu-id="0dece-117">Получение или установка дня и времени для установки обновлений.</span><span class="sxs-lookup"><span data-stu-id="0dece-117">Retrieve or set the day and time to install updates.</span></span> <span data-ttu-id="0dece-118">Укажите, как пользователи получают уведомления о событии автоматическое обновление.</span><span class="sxs-lookup"><span data-stu-id="0dece-118">Specify how users are notified of an Automatic Updates event.</span></span>                                                                                                                          |
| [<span data-ttu-id="0dece-119">**Категория**</span><span class="sxs-lookup"><span data-stu-id="0dece-119">**Category**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-icategory)                                         | <span data-ttu-id="0dece-120">Получение сведений о категории обновления, включая имя, идентификатор, описание, владельца и предполагаемый продукт.</span><span class="sxs-lookup"><span data-stu-id="0dece-120">Retrieve information about the update's category, including the name, ID, description, owner, and intended product.</span></span> <span data-ttu-id="0dece-121">Получение коллекции обновлений, относящихся к этой категории.</span><span class="sxs-lookup"><span data-stu-id="0dece-121">Retrieve a collection of updates that belong to this category.</span></span> <span data-ttu-id="0dece-122">Получение коллекции родительских или дочерних категорий.</span><span class="sxs-lookup"><span data-stu-id="0dece-122">Retrieve a collection of the parent or child categories.</span></span> |
| [<span data-ttu-id="0dece-123">**категориколлектион**</span><span class="sxs-lookup"><span data-stu-id="0dece-123">**CategoryCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-icategorycollection)                     | <span data-ttu-id="0dece-124">Доступ к коллекции объектов Category.</span><span class="sxs-lookup"><span data-stu-id="0dece-124">Access a collection of Category objects.</span></span>                                                                                                                                                                                                    |
| [<span data-ttu-id="0dece-125">**довнлоадресулт**</span><span class="sxs-lookup"><span data-stu-id="0dece-125">**DownloadResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-idownloadresult)                             | <span data-ttu-id="0dece-126">Получение сведений о результате загрузки.</span><span class="sxs-lookup"><span data-stu-id="0dece-126">Retrieve information about the result of a download.</span></span>                                                                                                                                                                                        |
| [<span data-ttu-id="0dece-127">**инсталлатионресулт**</span><span class="sxs-lookup"><span data-stu-id="0dece-127">**InstallationResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iinstallationresult)                     | <span data-ttu-id="0dece-128">Получение сведений о результатах установки или удаления.</span><span class="sxs-lookup"><span data-stu-id="0dece-128">Retrieve information about the result of an installation or uninstallation.</span></span> <span data-ttu-id="0dece-129">Определите, требуется ли перезагрузка системы для завершения установки или удаления.</span><span class="sxs-lookup"><span data-stu-id="0dece-129">Determine whether a system restart is required to complete the installation or uninstallation.</span></span>                                                                  |
| [<span data-ttu-id="0dece-130">**SearchResult**</span><span class="sxs-lookup"><span data-stu-id="0dece-130">**SearchResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-isearchresult)                                 | <span data-ttu-id="0dece-131">Получение сведений о результатах поиска по категориям или обновлениям.</span><span class="sxs-lookup"><span data-stu-id="0dece-131">Retrieve information about the result of a search for categories or updates.</span></span> <span data-ttu-id="0dece-132">Получение коллекции категорий, найденных на конечном компьютере с помощью поиска.</span><span class="sxs-lookup"><span data-stu-id="0dece-132">Retrieve a collection of categories found on the destination computer by the search.</span></span> <span data-ttu-id="0dece-133">Получение коллекции обновлений, найденных при поиске.</span><span class="sxs-lookup"><span data-stu-id="0dece-133">Retrieve a collection of updates found by the search.</span></span>                     |
| [<span data-ttu-id="0dece-134">**SystemInformation**</span><span class="sxs-lookup"><span data-stu-id="0dece-134">**SystemInformation**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-isysteminformation)                       | <span data-ttu-id="0dece-135">Получите сведения о требованиях изготовителя оборудования и перезагрузки системы на конечном компьютере.</span><span class="sxs-lookup"><span data-stu-id="0dece-135">Retrieve information about OEM hardware and system restart requirements on the destination computer.</span></span>                                                                                                                                        |
| [<span data-ttu-id="0dece-136">**Обновляют**</span><span class="sxs-lookup"><span data-stu-id="0dece-136">**Update**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdate)                                             | <span data-ttu-id="0dece-137">Получение большинства сведений об обновлении, включая объединенные обновления, требования к источнику, удостоверение, описание, параметры удаления, приоритет загрузки, размер и крайний срок.</span><span class="sxs-lookup"><span data-stu-id="0dece-137">Retrieve most information about the update, including bundled updates, source requirements, identity, description, uninstall options, download priority, size, and deadline.</span></span>                                                                |
| [<span data-ttu-id="0dece-138">**упдатеколлектион**</span><span class="sxs-lookup"><span data-stu-id="0dece-138">**UpdateCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatecollection)                         | <span data-ttu-id="0dece-139">Доступ к коллекции объектов Update.</span><span class="sxs-lookup"><span data-stu-id="0dece-139">Access a collection of Update objects.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="0dece-140">**упдатедовнлоадер**</span><span class="sxs-lookup"><span data-stu-id="0dece-140">**UpdateDownloader**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloader)                         | <span data-ttu-id="0dece-141">Запустите асинхронную или синхронную загрузку файлов, связанных с обновлениями.</span><span class="sxs-lookup"><span data-stu-id="0dece-141">Start an asynchronous or synchronous download of the files that are associated with the updates.</span></span>                                                                                                                                            |
| [<span data-ttu-id="0dece-142">**упдатедовнлоадресулт**</span><span class="sxs-lookup"><span data-stu-id="0dece-142">**UpdateDownloadResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloadresult)                 | <span data-ttu-id="0dece-143">Получение сведений о результатах загрузки для одного обновления.</span><span class="sxs-lookup"><span data-stu-id="0dece-143">Retrieve information about the result of the download for one update.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="0dece-144">**упдатиксцептион**</span><span class="sxs-lookup"><span data-stu-id="0dece-144">**UpdateException**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateexception)                           | <span data-ttu-id="0dece-145">Получение описания и контекста исключения, возникающего при возникновении ошибки обновления.</span><span class="sxs-lookup"><span data-stu-id="0dece-145">Retrieve the description and context of an exception that is thrown when an update error occurs.</span></span>                                                                                                                                            |
| [<span data-ttu-id="0dece-146">**упдатиксцептионколлектион**</span><span class="sxs-lookup"><span data-stu-id="0dece-146">**UpdateExceptionCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateexceptioncollection)       | <span data-ttu-id="0dece-147">Доступ к коллекции объектов Упдатиксцептион.</span><span class="sxs-lookup"><span data-stu-id="0dece-147">Access a collection of UpdateException objects.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="0dece-148">**упдатехисторентри**</span><span class="sxs-lookup"><span data-stu-id="0dece-148">**UpdateHistoryEntry**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentry)                     | <span data-ttu-id="0dece-149">Получение сведений об установленном или удаленном обновлении, включая обработанное приложение, дату и описание.</span><span class="sxs-lookup"><span data-stu-id="0dece-149">Retrieve information about an update that has been installed or uninstalled, including the processed application, date, and description.</span></span>                                                                                                    |
| [<span data-ttu-id="0dece-150">**упдатехисторентриколлектион**</span><span class="sxs-lookup"><span data-stu-id="0dece-150">**UpdateHistoryEntryCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentrycollection) | <span data-ttu-id="0dece-151">Доступ к коллекции объектов Упдатехисторентри.</span><span class="sxs-lookup"><span data-stu-id="0dece-151">Access a collection of UpdateHistoryEntry objects.</span></span>                                                                                                                                                                                          |
| [<span data-ttu-id="0dece-152">**упдатеинсталлатионресулт**</span><span class="sxs-lookup"><span data-stu-id="0dece-152">**UpdateInstallationResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstallationresult)         | <span data-ttu-id="0dece-153">Получение сведений о результатах установки или удаления обновления.</span><span class="sxs-lookup"><span data-stu-id="0dece-153">Retrieve information about the result of the installation or uninstallation for an update.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="0dece-154">**упдатеинсталлер**</span><span class="sxs-lookup"><span data-stu-id="0dece-154">**UpdateInstaller**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstaller)                           | <span data-ttu-id="0dece-155">Запуск асинхронной или синхронной установки или удаления обновления.</span><span class="sxs-lookup"><span data-stu-id="0dece-155">Start an asynchronous or synchronous installation or uninstallation of an update.</span></span> <span data-ttu-id="0dece-156">Запустите интерактивную последовательность диалогового окна, чтобы пошаговое руководство пользователя по установке обновлений.</span><span class="sxs-lookup"><span data-stu-id="0dece-156">Start an interactive dialog sequence to guide the user through the steps to install updates.</span></span>                                                              |
| [<span data-ttu-id="0dece-157">**упдатесеарчер**</span><span class="sxs-lookup"><span data-stu-id="0dece-157">**UpdateSearcher**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatesearcher)                             | <span data-ttu-id="0dece-158">Выполняет поиск обновлений на сервере по критериям, таким как тип обновления, идентификатор или Категория.</span><span class="sxs-lookup"><span data-stu-id="0dece-158">Searches for updates on the server by criteria such as the update type, the ID, or the category.</span></span>                                                                                                                                            |
| [<span data-ttu-id="0dece-159">**UpdateSession**</span><span class="sxs-lookup"><span data-stu-id="0dece-159">**UpdateSession**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatesession)                               | <span data-ttu-id="0dece-160">Запустите сеанс для поиска, скачивания, установки или удаления обновлений для приложения.</span><span class="sxs-lookup"><span data-stu-id="0dece-160">Start a session to search, download, install, or uninstall the updates for an application.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="0dece-161">**WebProxy**</span><span class="sxs-lookup"><span data-stu-id="0dece-161">**WebProxy**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iwebproxy)                                         | <span data-ttu-id="0dece-162">Получение и Настройка параметров прокси-сервера HTTP.</span><span class="sxs-lookup"><span data-stu-id="0dece-162">Retrieve and set HTTP proxy settings.</span></span>                                                                                                                                                                                                       |



 

 

 



