---
title: Диалоговое окно "Шрифт"
description: Диалоговое окно Шрифт позволяет пользователю выбирать атрибуты для логического шрифта, например семейство шрифтов и связанный стиль шрифта, размер точки, эффекты (подчеркивание, зачеркнутый и цвет текста), а также сценарий (или набор символов).
ms.assetid: e8a996aa-4e34-45d0-a325-9c20b1a6ce07
keywords:
- Пользовательский интерфейс Windows, ввод данных пользователем
- Пользовательский интерфейс Windows, Библиотека общих диалоговых окон
- ввод пользователя, Библиотека общих диалоговых окон
- запись вводимых пользователем данных, Библиотека общих диалоговых окон
- Библиотека общих диалоговых окон
- Общие диалоговые окна
- диалоговое окно шрифтов
- диалоговое окно «Настройка шрифта»
- Флаги, диалоговое окно "Шрифт"
- Флаги инициализации
- стандартные диалоговые окна
- диалоговые окна, шрифт
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9a752ce53ecf496c58efb0c346a8c3d67c4f1b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070557"
---
# <a name="font-dialog-box"></a><span data-ttu-id="084d7-115">Диалоговое окно "Шрифт"</span><span class="sxs-lookup"><span data-stu-id="084d7-115">Font Dialog Box</span></span>

<span data-ttu-id="084d7-116">Диалоговое окно **Шрифт** позволяет пользователю выбирать атрибуты для логического шрифта, например семейство шрифтов и связанный стиль шрифта, размер точки, эффекты (подчеркивание, зачеркнутый и цвет текста), а также сценарий (или набор символов).</span><span class="sxs-lookup"><span data-stu-id="084d7-116">The **Font** dialog box lets the user choose attributes for a logical font, such as font family and associated font style, point size, effects (underline, strikeout, and text color), and a script (or character set).</span></span>

<span data-ttu-id="084d7-117">Диалоговое окно **Шрифт** создается и отображается путем инициализации структуры [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) и передачи структуры в функцию [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="084d7-117">You create and display a **Font** dialog box by initializing a [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure and passing the structure to the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function.</span></span>

<span data-ttu-id="084d7-118">На следующем снимке экрана показано диалоговое окно типичного **шрифта** .</span><span class="sxs-lookup"><span data-stu-id="084d7-118">The following screen shot shows a typical **Font** dialog box.</span></span>

![снимок экрана, показывающий диалоговое окно "Шрифт"](images/fontdialogboxxp.png)

<span data-ttu-id="084d7-120">Если пользователь нажмет кнопку **ОК** , функция [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) возвращает **значение true** и задает сведения о выборе пользователя в структуре [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="084d7-120">If the user clicks the **OK** button, the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function returns **TRUE** and sets the information about the user's selection in the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure.</span></span>

<span data-ttu-id="084d7-121">Если пользователь отменяет диалоговое окно **Шрифт** или возникает ошибка, [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) возвращает **значение false** , а содержимое структуры [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) не определяется.</span><span class="sxs-lookup"><span data-stu-id="084d7-121">If the user cancels the **Font** dialog box or an error occurs, [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) returns **FALSE** and the contents of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure are not defined.</span></span> <span data-ttu-id="084d7-122">Причину ошибки можно определить с помощью функции [**коммдлжекстендедеррор**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) , чтобы получить расширенное значение ошибки.</span><span class="sxs-lookup"><span data-stu-id="084d7-122">You can determine the cause of an error by using the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="084d7-123">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="084d7-123">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="084d7-124">Флаги инициализации диалогового окна шрифта</span><span class="sxs-lookup"><span data-stu-id="084d7-124">Font Dialog Box Initialization Flags</span></span>](#font-dialog-box-initialization-flags)
-   [<span data-ttu-id="084d7-125">Настройка диалогового окна «Шрифт» в более ранних версиях Windows</span><span class="sxs-lookup"><span data-stu-id="084d7-125">Customizing the Font Dialog Box on earlier versions of Windows</span></span>](#customizing-the-font-dialog-box-on-earlier-versions-of-windows)
-   [<span data-ttu-id="084d7-126">Настройка диалогового окна «Шрифт» в Windows 7</span><span class="sxs-lookup"><span data-stu-id="084d7-126">Customizing the Font Dialog Box on Windows 7</span></span>](#customizing-the-font-dialog-box-on-windows-7)

## <a name="font-dialog-box-initialization-flags"></a><span data-ttu-id="084d7-127">Флаги инициализации диалогового окна шрифта</span><span class="sxs-lookup"><span data-stu-id="084d7-127">Font Dialog Box Initialization Flags</span></span>

<span data-ttu-id="084d7-128">Перед вызовом [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta)элемент **flags** в структуре [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) должен указать **\_ оба** параметра: **CF \_ скринфонтс**, **CF \_ принтерфонтс** или CF, чтобы указать, следует ли диалоговое окно вывести список экранных шрифтов, шрифтов принтера или и того и другого.</span><span class="sxs-lookup"><span data-stu-id="084d7-128">Before calling [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta), the **Flags** member of the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure must specify **CF\_SCREENFONTS**, **CF\_PRINTERFONTS**, or **CF\_BOTH**, to indicate whether the dialog box should list screen fonts, printer fonts, or both.</span></span> <span data-ttu-id="084d7-129">Если указать **\_ обе** версии: **CF \_ Принтерфонтс** или CF, элемент **HDC** структуры **CHOOSEFONT** должен задавать маркер для контекста устройства для принтера.</span><span class="sxs-lookup"><span data-stu-id="084d7-129">If you specify **CF\_PRINTERFONTS** or **CF\_BOTH**, the **hDC** member of the **CHOOSEFONT** structure must specify a handle to a device context for the printer.</span></span>

<span data-ttu-id="084d7-130">Если установлен флаг **CF \_ Принтерфонтс** или **CF \_** , то в нижней части диалогового окна **Шрифт** отображается метка описание типа шрифта.</span><span class="sxs-lookup"><span data-stu-id="084d7-130">If the **CF\_PRINTERFONTS** or **CF\_BOTH** flag is set, the font type description label appears at the bottom of the **Font** dialog box.</span></span>

<span data-ttu-id="084d7-131">Начиная с Windows 7 флаги **CF \_ принтерфонтс**, **CF \_ Скринфонтс**, **CF \_ both** и **CF \_ WYSIWYG** больше не используются функцией [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) для перечисления шрифтов.</span><span class="sxs-lookup"><span data-stu-id="084d7-131">Starting with Windows 7, the **CF\_PRINTERFONTS**, **CF\_SCREENFONTS**, **CF\_BOTH**, and **CF\_WYSIWYG** flags are no longer used by the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function for font enumeration.</span></span> <span data-ttu-id="084d7-132">Они устарели в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="084d7-132">They are obsolete in Windows 7.</span></span> <span data-ttu-id="084d7-133">Однако флаг **CF \_ принтерфонтс** содержит одну функцию: для вывода метки описания типа шрифта в нижней части диалогового окна **Шрифт** .</span><span class="sxs-lookup"><span data-stu-id="084d7-133">However, the **CF\_PRINTERFONTS** flag retains one function: to display the font type description label at the bottom of the **Font** dialog box.</span></span>

<span data-ttu-id="084d7-134">Можно использовать элемент **flags** для включения или отключения некоторых элементов управления диалогового окна **Шрифт** , а также можно использовать элемент **flags** вместе с другими элементами [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) для управления начальными значениями некоторых элементов управления.</span><span class="sxs-lookup"><span data-stu-id="084d7-134">You can use the **Flags** member to enable or disable some of the **Font** dialog box controls, and you can use the **Flags** member in conjunction with other [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) members to control the initial values of some controls.</span></span>

<span data-ttu-id="084d7-135">**Чтобы отобразить элементы управления, позволяющие пользователю выбрать параметры зачеркивания, подчеркивание и цвет, выполните следующие действия.**</span><span class="sxs-lookup"><span data-stu-id="084d7-135">**To display the controls that allow the user to select strikeout, underline, and color options:**</span></span>

-   <span data-ttu-id="084d7-136">Установка флага **\_ эффектов CF** .</span><span class="sxs-lookup"><span data-stu-id="084d7-136">Set the **CF\_EFFECTS** flag.</span></span> <span data-ttu-id="084d7-137">Для указания исходного цвета шрифта можно использовать элемент **ргбколорс** структуры [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="084d7-137">You can use the **rgbColors** member of the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure to specify an initial font color.</span></span>

<span data-ttu-id="084d7-138">**Чтобы указать начальные значения для элементов управления "Шрифт", "стиль шрифта", "размер", "зачеркивание" и "подчеркивание", сделайте следующее:**</span><span class="sxs-lookup"><span data-stu-id="084d7-138">**To specify the initial values for the Font, Font Style, Size, Strikeout, and Underline dialog box controls:**</span></span>

1.  <span data-ttu-id="084d7-139">Чтобы указать начальные значения для элементов управления "Шрифт", "стиль шрифта", "размер", "зачеркивание" и "подчеркивание", сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="084d7-139">To specify the initial values for the Font, Font Style, Size, Strikeout, and Underline dialog box controls:</span></span>
2.  <span data-ttu-id="084d7-140">Установите флаг **CF \_ иниттологфонтструкт** в элементе **flags** вместе с элементами структуры [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) , на которую указывает **лплогфонт**, чтобы указать начальные значения для атрибутов шрифта.</span><span class="sxs-lookup"><span data-stu-id="084d7-140">Set the **CF\_INITTOLOGFONTSTRUCT** flag in the **Flags** member, along with members of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure that is pointed to by the **lpLogFont**, to specify the initial values for the font attributes.</span></span>
3.  <span data-ttu-id="084d7-141">Можно также использовать флаги **CF \_ нофацесел**, **CF \_ ностилесел** и **CF \_ носизесел** , чтобы диалоговое окно **шрифта** не отображало начальные значения соответствующих элементов управления.</span><span class="sxs-lookup"><span data-stu-id="084d7-141">You can also use the **CF\_NOFACESEL**, **CF\_NOSTYLESEL**, and **CF\_NOSIZESEL** flags to prevent the **Font** dialog box from displaying initial values for the corresponding controls.</span></span> <span data-ttu-id="084d7-142">Это полезно при работе с выделенным текстом, имеющим более одного шрифта, стиля или кегля.</span><span class="sxs-lookup"><span data-stu-id="084d7-142">This is useful when you are working with a selection of text that has more than one typeface, style, or point size.</span></span> <span data-ttu-id="084d7-143">Эти значения также будут заданы в **флагах** , когда [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) возвращает, если пользователь не выберет соответствующее значение.</span><span class="sxs-lookup"><span data-stu-id="084d7-143">These values will also be set in **Flags** when [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) returns, if the user did not select a corresponding value.</span></span>

<span data-ttu-id="084d7-144">**Инициализация элемента управления стиля шрифта на указанное имя стиля**</span><span class="sxs-lookup"><span data-stu-id="084d7-144">**To initialize the Font Style control to a specified style name**</span></span>

-   <span data-ttu-id="084d7-145">Установите флаг **CF \_ усестиле** и используйте элемент **лпсзстиле** , чтобы указать имя стиля.</span><span class="sxs-lookup"><span data-stu-id="084d7-145">Set the **CF\_USESTYLE** flag and use the **lpszStyle** member to specify the style name.</span></span>

> [!Note]  
> <span data-ttu-id="084d7-146">Чтобы выполнить глобализацию приложения, укажите стиль с помощью членов **лфвеигхт** и **лфиталик** структуры [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) , на которую указывает **лплогфонт**.</span><span class="sxs-lookup"><span data-stu-id="084d7-146">To globalize your application, specify the style by using the **lfWeight** and **lfItalic** members of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure that is pointed to by **lpLogFont**.</span></span> <span data-ttu-id="084d7-147">Имя стиля может изменяться в зависимости от языка пользовательского интерфейса системы.</span><span class="sxs-lookup"><span data-stu-id="084d7-147">The style name may change depending on the system user interface language.</span></span>

 

<span data-ttu-id="084d7-148">**Отображение кнопки «Применить»**</span><span class="sxs-lookup"><span data-stu-id="084d7-148">**To display the Apply button**</span></span>

-   <span data-ttu-id="084d7-149">Установите флаг **\_ применения CF** и укажите процедуру-обработчик для обработки [**\_ командных сообщений WM**](/windows/desktop/menurc/wm-command) для кнопки **Применить** .</span><span class="sxs-lookup"><span data-stu-id="084d7-149">Set the **CF\_APPLY** flag and provide a hook procedure to process [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages for the **Apply** button.</span></span> <span data-ttu-id="084d7-150">Процедура-обработчик может отправить сообщение [**WM \_ CHOOSEFONT \_ жетлогфонт**](wm-choosefont-getlogfont.md) в диалоговое окно, чтобы получить адрес структуры [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) , которая содержит текущие выборки для шрифта.</span><span class="sxs-lookup"><span data-stu-id="084d7-150">The hook procedure can send the [**WM\_CHOOSEFONT\_GETLOGFONT**](wm-choosefont-getlogfont.md) message to the dialog box to retrieve the address of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure that contains the current selections for the font.</span></span>

<span data-ttu-id="084d7-151">**Отображение кнопки «Справка»**</span><span class="sxs-lookup"><span data-stu-id="084d7-151">**To display the Help button**</span></span>

-   <span data-ttu-id="084d7-152">Установите флаг **CF \_ SHOWHELP** .</span><span class="sxs-lookup"><span data-stu-id="084d7-152">Set the **CF\_SHOWHELP** flag.</span></span> <span data-ttu-id="084d7-153">Член **хвндовнер** должен определить окно для получения зарегистрированного сообщения [**хелпмсгстринг**](helpmsgstring.md) , когда пользователь нажмет кнопку " **Справка** ".</span><span class="sxs-lookup"><span data-stu-id="084d7-153">The **hwndOwner** member must identify the window to receive the [**HELPMSGSTRING**](helpmsgstring.md) registered message when the user clicks the **Help** button.</span></span>

<span data-ttu-id="084d7-154">**Ограничение шрифтов, отображаемых в диалоговом окне**</span><span class="sxs-lookup"><span data-stu-id="084d7-154">**To restrict the fonts displayed in the dialog box**</span></span>

-   <span data-ttu-id="084d7-155">Задайте любое сочетание флагов **CF \_ ттонли**, **CF \_ фикседпитчонли**, **CF \_ Новекторфонтс**, **CF \_ новертфонтс**, **CF \_ скалаблеонли** и **CF \_ WYSIWYG** .</span><span class="sxs-lookup"><span data-stu-id="084d7-155">Set any combination of the **CF\_TTONLY**, **CF\_FIXEDPITCHONLY**, **CF\_NOVECTORFONTS**, **CF\_NOVERTFONTS**, **CF\_SCALABLEONLY**, and **CF\_WYSIWYG** flags.</span></span> <span data-ttu-id="084d7-156">Можно также ограничить доступные стили, отображаемые в диалоговом окне для некоторых шрифтов, с помощью **значения \_ CF** .</span><span class="sxs-lookup"><span data-stu-id="084d7-156">You can also restrict the available styles that the dialog box displays for some fonts by using the **CF\_NOSIMULATIONS** value.</span></span>

<span data-ttu-id="084d7-157">Начиная с Windows 7, список шрифтов, отображаемых в диалоговом окне, ограничен на основе показанных шрифтов пользователя.</span><span class="sxs-lookup"><span data-stu-id="084d7-157">Starting with Windows 7, the list of fonts displayed in the dialog box is restricted based on the user's shown fonts.</span></span> <span data-ttu-id="084d7-158">Чтобы снять ограничение, установите флаг **CF \_ инактивефонтс** .</span><span class="sxs-lookup"><span data-stu-id="084d7-158">To remove the restriction, set the **CF\_INACTIVEFONTS** flag.</span></span>

<span data-ttu-id="084d7-159">**Ограничение имен шрифтов, стилей и размеров точек, которые может указывать пользователь**</span><span class="sxs-lookup"><span data-stu-id="084d7-159">**To restrict the typeface names, styles, and point sizes that the user can specify**</span></span>

1.  <span data-ttu-id="084d7-160">Установите флаг **CF \_ форцефонтексист** , чтобы запретить пользователю указывать только допустимые имена гарнитур, стили и размеры точек, перечисленные в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="084d7-160">Set the **CF\_FORCEFONTEXIST** flag to restrict the user to specifying only valid typeface names, styles, and point sizes listed in the dialog box.</span></span>
2.  <span data-ttu-id="084d7-161">Установите флаг **CF \_ лимитсизе** , чтобы запретить пользователю указывать размеры точек в диапазоне, указанном в элементах **нсиземин** и **нсиземакс** .</span><span class="sxs-lookup"><span data-stu-id="084d7-161">Set the **CF\_LIMITSIZE** flag to restrict the user to specifying point sizes in the range specified by the **nSizeMin** and **nSizeMax** members.</span></span>

<span data-ttu-id="084d7-162">**Ограничение или отключение поля со списком "скрипты"**</span><span class="sxs-lookup"><span data-stu-id="084d7-162">**To restrict or disable the Scripts combo box**</span></span>

-   <span data-ttu-id="084d7-163">Установите флаг **CF \_ носкриптсел** , чтобы отключить поле со списком " **скрипты** ", или установите флаг **CF \_ селектскрипт** , чтобы ограничить выбор в поле со списком **скрипты** указанной кодировкой.</span><span class="sxs-lookup"><span data-stu-id="084d7-163">Set the **CF\_NOSCRIPTSEL** flag to disable the **Scripts** combo box, or set the **CF\_SELECTSCRIPT** flag to restrict selections in the **Scripts** combo box to a specified character set.</span></span>

## <a name="customizing-the-font-dialog-box-on-earlier-versions-of-windows"></a><span data-ttu-id="084d7-164">Настройка диалогового окна «Шрифт» в более ранних версиях Windows</span><span class="sxs-lookup"><span data-stu-id="084d7-164">Customizing the Font Dialog Box on earlier versions of Windows</span></span>

<span data-ttu-id="084d7-165">Можно указать пользовательский шаблон для диалогового окна **Шрифт** , например, если требуется включить дополнительные элементы управления, которые являются уникальными для приложения.</span><span class="sxs-lookup"><span data-stu-id="084d7-165">You can provide a custom template for the **Font** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="084d7-166">Функция [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) использует пользовательский шаблон вместо шаблона по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="084d7-166">The [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="084d7-167">**Предоставление пользовательского шаблона для диалогового окна «Шрифт»**</span><span class="sxs-lookup"><span data-stu-id="084d7-167">**To provide a custom template for the Font dialog box**</span></span>

1.  <span data-ttu-id="084d7-168">Создайте пользовательский шаблон, изменив шаблон по умолчанию, указанный в файле Font. DLG.</span><span class="sxs-lookup"><span data-stu-id="084d7-168">Create the custom template by modifying the default template specified in the Font.dlg file.</span></span> <span data-ttu-id="084d7-169">Идентификаторы элементов управления, используемые в шаблоне диалогового окна Шрифт по умолчанию, определены в файле Длгс. h.</span><span class="sxs-lookup"><span data-stu-id="084d7-169">The control identifiers used in the default Font dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="084d7-170">Используйте структуру [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) , чтобы включить шаблон следующим образом:</span><span class="sxs-lookup"><span data-stu-id="084d7-170">Use the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="084d7-171">Если пользовательский шаблон является ресурсом в приложении или библиотеке динамической компоновки, установите флаг **CF \_ енаблетемплате** в элементе **flags** .</span><span class="sxs-lookup"><span data-stu-id="084d7-171">If your custom template is a resource in an application or dynamic link library, set the **CF\_ENABLETEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="084d7-172">Используйте элементы **HINSTANCE** и **лптемплатенаме** структуры для задания имени модуля и ресурса.</span><span class="sxs-lookup"><span data-stu-id="084d7-172">Use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span>
    -   <span data-ttu-id="084d7-173">Если пользовательский шаблон уже находится в памяти, установите флаг **CF \_ енаблетемплатехандле** .</span><span class="sxs-lookup"><span data-stu-id="084d7-173">If your custom template is already in memory, set the **CF\_ENABLETEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="084d7-174">Используйте элемент **HINSTANCE** для задания объекта памяти, содержащего шаблон.</span><span class="sxs-lookup"><span data-stu-id="084d7-174">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="084d7-175">Вы можете предоставить процедуру обработчика [**кфхукпрок**](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc) для диалогового окна **Шрифт** .</span><span class="sxs-lookup"><span data-stu-id="084d7-175">You can provide a [**CFHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc) hook procedure for the **Font** dialog box.</span></span> <span data-ttu-id="084d7-176">Процедура-обработчик может обрабатывать сообщения, отправленные в диалоговое окно, и отправлять сообщения в диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="084d7-176">The hook procedure can process messages sent to the dialog box and send messages to the dialog box.</span></span> <span data-ttu-id="084d7-177">При использовании пользовательского шаблона для определения дополнительных элементов управления необходимо предоставить процедуру-обработчик для обработки входных данных для элементов управления.</span><span class="sxs-lookup"><span data-stu-id="084d7-177">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

<span data-ttu-id="084d7-178">**Включение процедуры-обработчика для диалогового окна «Шрифт»**</span><span class="sxs-lookup"><span data-stu-id="084d7-178">**To enable a hook procedure for the Font dialog box**</span></span>

1.  <span data-ttu-id="084d7-179">Установите флаг **CF \_ енаблехук** в элементе **flags** структуры [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="084d7-179">Set the **CF\_ENABLEHOOK** flag in the **Flags** member of the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure.</span></span>
2.  <span data-ttu-id="084d7-180">Укажите адрес процедуры-обработчика в элементе **лпфнхук** .</span><span class="sxs-lookup"><span data-stu-id="084d7-180">Specify the address of the hook procedure in the **lpfnHook** member.</span></span>

<span data-ttu-id="084d7-181">После обработки сообщения [**WM \_ инитдиалог**](wm-initdialog.md) процедура диалогового окна отправляет сообщение **WM \_ инитдиалог** в процедуру-обработчик.</span><span class="sxs-lookup"><span data-stu-id="084d7-181">After processing the [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="084d7-182">Параметр *lParam* этого сообщения является указателем на структуру [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) , которая используется для инициализации диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="084d7-182">The *lParam* parameter of this message is a pointer to the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure that is used to initialize the dialog box.</span></span>

<span data-ttu-id="084d7-183">Процедура-ловушка может отправить сообщения [**WM \_ CHOOSEFONT \_ жетлогфонт**](wm-choosefont-getlogfont.md), [**WM \_ CHOOSEFONT \_ сетлогфонт**](wm-choosefont-setlogfont.md)и [**WM \_ CHOOSEFONT \_ сетфлагс**](wm-choosefont-setflags.md) в диалоговое окно для получения и задания текущих значений и флагов диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="084d7-183">The hook procedure can send the [**WM\_CHOOSEFONT\_GETLOGFONT**](wm-choosefont-getlogfont.md), [**WM\_CHOOSEFONT\_SETLOGFONT**](wm-choosefont-setlogfont.md), and [**WM\_CHOOSEFONT\_SETFLAGS**](wm-choosefont-setflags.md) messages to the dialog box to get and set the current values and flags of the dialog box.</span></span>

## <a name="customizing-the-font-dialog-box-on-windows-7"></a><span data-ttu-id="084d7-184">Настройка диалогового окна «Шрифт» в Windows 7</span><span class="sxs-lookup"><span data-stu-id="084d7-184">Customizing the Font Dialog Box on Windows 7</span></span>

<span data-ttu-id="084d7-185">На следующем снимке экрана показано диалоговое окно типичного **шрифта** в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="084d7-185">The following screen shot shows a typical **Font** dialog box in Windows 7.</span></span>

![снимок экрана, показывающий поле "диалоб шрифта"](images/fontdialogboxwin7.png)

<span data-ttu-id="084d7-187">В более ранних версиях Windows файл шаблона Font. DLG содержит один шаблон ChooseFont по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="084d7-187">In earlier Windows versions, the font.dlg template file contains one default ChooseFont template.</span></span> <span data-ttu-id="084d7-188">Файл шаблона Font. DLG в Windows 7 содержит два шаблона по умолчанию: шаблон по умолчанию из более ранних версий Windows и новый шаблон Windows 7 ChooseFont.</span><span class="sxs-lookup"><span data-stu-id="084d7-188">The font.dlg template file on Windows 7 contains two default templates: the default template from earlier Windows versions and the new Windows 7 ChooseFont template.</span></span> <span data-ttu-id="084d7-189">Поэтому при настройке диалогового окна **Шрифт** в Windows 7 необходимо учитывать следующие моменты.</span><span class="sxs-lookup"><span data-stu-id="084d7-189">Therefore, when you customize the **Font** dialog box on Windows 7, you must consider the following issues.</span></span>

1.  <span data-ttu-id="084d7-190">Используйте новый шаблон при создании пользовательских шаблонов для приложений, работающих в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="084d7-190">Use the new template when you create custom templates for applications that run on Windows 7.</span></span> <span data-ttu-id="084d7-191">Этот новый шаблон содержит элемент управления "ссылка", который пользователь может щелкнуть для открытия окна **панели управления "шрифты** ", как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="084d7-191">This new template contains a link control that the user can click to launch the **Fonts Control Panel** window, as shown in the following screen shot.</span></span>

    ![снимок экрана, показывающий панель управления шрифтами в Windows 7](images/fontcontrolpanelforwin7.png)

2.  <span data-ttu-id="084d7-193">Чтобы использовать этот элемент управления ссылки, вызывающее приложение должно использовать COMCTL32.DLL версии 6 или более поздней.</span><span class="sxs-lookup"><span data-stu-id="084d7-193">To use this link control, your calling application must use the COMCTL32.DLL version 6 or later.</span></span> <span data-ttu-id="084d7-194">В противном случае функция [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) возвращает ошибку при попытке создать элемент управления Link в пользовательском шаблоне.</span><span class="sxs-lookup"><span data-stu-id="084d7-194">Otherwise, the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function returns an error when it tries to create the link control in your custom template.</span></span> <span data-ttu-id="084d7-195">Чтобы определить, включен ли этот элемент управления, скомпилируйте вызывающее приложение с COMCTL32.DLL версии 6,0.</span><span class="sxs-lookup"><span data-stu-id="084d7-195">To determine if this control is enabled, compile your calling application against COMCTL32.DLL version 6.0.</span></span> <span data-ttu-id="084d7-196">Дополнительные сведения см. в разделе [Включение визуальных стилей с помощью стандартных элементов управления](/previous-versions//ms649781(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="084d7-196">For more information, see [Enabling Visual Styles with Common Controls](/previous-versions//ms649781(v=vs.85)).</span></span>
3.  <span data-ttu-id="084d7-197">Если приложение использует COMCTL32.DLL версии 5,0 или более ранней, при создании пользовательского шаблона необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="084d7-197">If your application uses COMCTL32.DLL version 5.0 or earlier, you must do the following when you create a custom template:</span></span>

    -   <span data-ttu-id="084d7-198">Укажите элемент управления в качестве **кнопки**.</span><span class="sxs-lookup"><span data-stu-id="084d7-198">Specify the control as a **PUSHBUTTON**.</span></span> <span data-ttu-id="084d7-199">Элемент управления, используемый для запуска **панели элементов управления "шрифты** ", отображается как кнопка, а не как ссылка.</span><span class="sxs-lookup"><span data-stu-id="084d7-199">The control used to launch the **Fonts Control Panel** will appear as a button rather than as a link.</span></span>
    -   <span data-ttu-id="084d7-200">Замените приведенный ниже текст на Font. DLG:</span><span class="sxs-lookup"><span data-stu-id="084d7-200">Replace the following text in the font.dlg:</span></span>

        `CONTROL         "<A>Show more fonts</A>", IDC_MANAGE_LINK, "SysLink", WS_TABSTOP, 7, 199, 227, 9`

        <span data-ttu-id="084d7-201">со следующим текстом:</span><span class="sxs-lookup"><span data-stu-id="084d7-201">with the following text:</span></span>

        `PUSHBUTTON      "S&how more fonts", IDC_MANAGE_LINK, 7, 199, 74, 14 , WS_TABSTOP`

    -   <span data-ttu-id="084d7-202">Чтобы приложение использовало пользовательский шаблон, необходимо указать пользовательский шаблон с флагом **CF \_ енаблетемплате** , создать пользовательский шаблон на основе шаблона ChooseFont Windows 7, а затем при необходимости включить процедуру-обработчик.</span><span class="sxs-lookup"><span data-stu-id="084d7-202">To ensure that your application uses a custom template, you must specify a custom template with the **CF\_ENABLETEMPLATE** flag, create a custom template based on the Windows 7 ChooseFont template, and then optionally enable a hook procedure.</span></span>

        <span data-ttu-id="084d7-203">Если включить процедуру-обработчик без создания пользовательского шаблона, будет загружен шаблон ChooseFont по умолчанию для более ранних версий Windows.</span><span class="sxs-lookup"><span data-stu-id="084d7-203">If you enable a hook procedure without creating a custom template, the default ChooseFont template for earlier Windows versions will be loaded.</span></span>

> [!Note]  
> <span data-ttu-id="084d7-204">Необходимо указать **тип элемента управления** или **кнопки** в новом шаблоне в зависимости от версии COMMCTL.DLL, для которой выполняется компиляция приложения.</span><span class="sxs-lookup"><span data-stu-id="084d7-204">You must specify the **CONTROL** or **PUSHBUTTON** control type in your new template, depending on the version of COMMCTL.DLL that your application compiles against.</span></span> <span data-ttu-id="084d7-205">Также обратите внимание, что специальные функции Windows 7, такие как отображение списков шрифтов и расширенных семейств, недоступны, если приложения работают в более ранних версиях операционной системы Windows.</span><span class="sxs-lookup"><span data-stu-id="084d7-205">Also note that Windows 7 specific features, such as WYSIWYG display of font lists and extended families, are not available when your applications run on earlier versions of the Windows operating system.</span></span>

 

 

 