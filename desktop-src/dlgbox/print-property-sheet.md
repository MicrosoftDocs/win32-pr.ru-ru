---
title: Страница свойств печати
description: Страница свойств печать — это стандартный пользовательский интерфейс, позволяющий пользователю задавать свойства конкретного задания печати.
ms.assetid: b52b71cc-a583-4a21-8a53-501ab442e6f8
keywords:
- Пользовательский интерфейс Windows, ввод данных пользователем
- Пользовательский интерфейс Windows, Библиотека общих диалоговых окон
- ввод пользователя, Библиотека общих диалоговых окон
- запись вводимых пользователем данных, Библиотека общих диалоговых окон
- Библиотека общих диалоговых окон
- Общие диалоговые окна
- Диалоговое окно «Печать страницы свойств»
- диалоговое окно «Настройка страницы свойств печати»
- стандартные диалоговые окна
- диалоговые окна, страница свойств печати
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20905f76af290b3978bec828a382604147297998
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070590"
---
# <a name="print-property-sheet"></a><span data-ttu-id="c4cea-113">Страница свойств печати</span><span class="sxs-lookup"><span data-stu-id="c4cea-113">Print Property Sheet</span></span>

<span data-ttu-id="c4cea-114">Страница свойств **Печать** — это стандартный пользовательский интерфейс, позволяющий пользователю задавать свойства конкретного задания печати.</span><span class="sxs-lookup"><span data-stu-id="c4cea-114">The **Print** property sheet is a standard user interface that enables the user to specify the properties of a particular print job.</span></span> <span data-ttu-id="c4cea-115">Страница свойств состоит из набора страниц свойств, которые зависят от принтера или приложения.</span><span class="sxs-lookup"><span data-stu-id="c4cea-115">The property sheet is composed of a set of property pages that varies by printer or application.</span></span> <span data-ttu-id="c4cea-116">К подмножеству стандартных страниц свойств Windows некоторые принтеры могут добавлять страницы свойств, относящиеся к драйверу, а некоторые приложения могут добавлять страницы свойств, относящиеся к конкретному приложению.</span><span class="sxs-lookup"><span data-stu-id="c4cea-116">To a subset of standard Windows property pages, some printers might add driver-specific property pages and some applications might add application-specific property pages.</span></span>

<span data-ttu-id="c4cea-117">Чтобы создать и отобразить страницу свойств **печати** , инициализируйте структуру [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) и передайте эту структуру в функцию [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-117">To create and display a **Print** property sheet, initialize a [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure and pass the structure to the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function.</span></span>

<span data-ttu-id="c4cea-118">На следующем рисунке показана типичная страница свойств **печати** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-118">The following illustration shows a typical **Print** property sheet.</span></span>

![Страница свойств принтера](images/printerpropertypagexp.png)

<span data-ttu-id="c4cea-120">Большинство элементов структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) идентичны элементам структуры [**принтдлг**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-120">Most members of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure are identical to those of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="c4cea-121">Описание использования общих членов структуры для взаимодействия с элементами управления диалогового окна см. в разделе [диалоговое окно «Печать](print-dialog-box.md)».</span><span class="sxs-lookup"><span data-stu-id="c4cea-121">For descriptions of how to use the common structure members to interact with the dialog box controls, see [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="c4cea-122">Оставшаяся часть этого раздела описывает функции страницы свойств **печати** , которые отличаются от диалогового окна « **Печать** ».</span><span class="sxs-lookup"><span data-stu-id="c4cea-122">The remainder of this topic describes the **Print** property sheet features that differ from the **Print** dialog box.</span></span>

<span data-ttu-id="c4cea-123">Страницу свойств **печати** можно настроить, указав настраиваемый шаблон диалогового окна для нижней части страницы **Общие** и указав дополнительные страницы свойств для перехода на страницу **Общие** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-123">You can customize a **Print** property sheet by specifying a custom dialog box template for the lower portion of the **General** page and by specifying additional property pages to follow the **General** page.</span></span> <span data-ttu-id="c4cea-124">Дополнительные сведения см. [в разделе Настройка страницы свойств печати](#customizing-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="c4cea-124">For more information, see [Customizing the Print Property Sheet](#customizing-the-print-property-sheet).</span></span>

<span data-ttu-id="c4cea-125">Вы можете реализовать объект обратного вызова для получения уведомлений и сообщений от функции [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) при отображении страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="c4cea-125">You can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="c4cea-126">Приложения, предоставляющие настраиваемые шаблоны или дополнительные страницы, используют объект обратного вызова для взаимодействия со страницей свойств.</span><span class="sxs-lookup"><span data-stu-id="c4cea-126">Applications that provide custom templates or additional pages use the callback object to communicate with the property sheet.</span></span> <span data-ttu-id="c4cea-127">Дополнительные сведения см. [в разделе объект обратного вызова для страницы свойств печати](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="c4cea-127">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="c4cea-128">Страница свойств **Печать** обеспечивает поддержку для указания нескольких несмежных диапазонов страниц для печати.</span><span class="sxs-lookup"><span data-stu-id="c4cea-128">The **Print** property sheet provides support for specifying multiple, noncontiguous page ranges to print.</span></span> <span data-ttu-id="c4cea-129">Элемент **лппажеранжес** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) задает массив структур [**принтпажеранже**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) , в которых каждая структура задает диапазон страниц.</span><span class="sxs-lookup"><span data-stu-id="c4cea-129">The **lpPageRanges** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure specifies an array of [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) structures in which each structure specifies a page range.</span></span>

<span data-ttu-id="c4cea-130">На странице свойств **Печать** отображается переключатель **Текущая страница** в составе группы **диапазонов страниц** переключателей.</span><span class="sxs-lookup"><span data-stu-id="c4cea-130">The **Print** property sheet displays a **Current Page** radio button as part of the **Page Range** group of radio buttons.</span></span> <span data-ttu-id="c4cea-131">Для управления переключателем **Текущая страница** используйте флаги **PD \_ CURRENTPAGE** и **PD \_ нокуррентпаже** в элементе **flags** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-131">To control the **Current Page** radio button, use the **PD\_CURRENTPAGE** and **PD\_NOCURRENTPAGE** flags in the **Flags** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="c4cea-132">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="c4cea-132">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="c4cea-133">Настройка страницы свойств печати</span><span class="sxs-lookup"><span data-stu-id="c4cea-133">Customizing the Print Property Sheet</span></span>](#customizing-the-print-property-sheet)
-   [<span data-ttu-id="c4cea-134">Объект обратного вызова для страницы свойств печати</span><span class="sxs-lookup"><span data-stu-id="c4cea-134">Callback Object for the Print Property Sheet</span></span>](#callback-object-for-the-print-property-sheet)

## <a name="customizing-the-print-property-sheet"></a><span data-ttu-id="c4cea-135">Настройка страницы свойств печати</span><span class="sxs-lookup"><span data-stu-id="c4cea-135">Customizing the Print Property Sheet</span></span>

<span data-ttu-id="c4cea-136">Страницу свойств **Печать** можно настроить следующими способами.</span><span class="sxs-lookup"><span data-stu-id="c4cea-136">You can customize the **Print** property sheet in the following ways:</span></span>

-   <span data-ttu-id="c4cea-137">Предоставьте пользовательский шаблон для нижней части страницы **Общие** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-137">Provide a custom template for the lower portion of the **General** page.</span></span> <span data-ttu-id="c4cea-138">Это позволяет включать дополнительные элементы управления, которые являются уникальными для приложения.</span><span class="sxs-lookup"><span data-stu-id="c4cea-138">This allows you to include additional controls that are unique to your application.</span></span> <span data-ttu-id="c4cea-139">Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) использует пользовательский шаблон вместо шаблона по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c4cea-139">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses your custom template in place of the default template.</span></span>
-   <span data-ttu-id="c4cea-140">Укажите дополнительные страницы свойств для перехода на страницу **Общие** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-140">Provide additional property pages to follow the **General** page.</span></span>
-   <span data-ttu-id="c4cea-141">Предоставьте объект обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="c4cea-141">Provide a callback object.</span></span> <span data-ttu-id="c4cea-142">Дополнительные сведения см. [в разделе объект обратного вызова для страницы свойств печати](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="c4cea-142">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="c4cea-143">Нельзя изменить верхнюю часть страницы **Общие** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-143">You cannot change the upper portion of the **General** page.</span></span> <span data-ttu-id="c4cea-144">Нельзя изменять страницы свойств, предоставленные драйвером принтера.</span><span class="sxs-lookup"><span data-stu-id="c4cea-144">You cannot change property pages provided by the printer driver.</span></span>

<span data-ttu-id="c4cea-145">Чтобы предоставить пользовательский шаблон для страницы "Общие", выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="c4cea-145">To provide a custom template for the General page:</span></span>

1.  <span data-ttu-id="c4cea-146">Создайте пользовательский шаблон для нижней части страницы " **Общие** ", изменив шаблон принтдлжексорд, указанный в файле прнсетуп. DLG.</span><span class="sxs-lookup"><span data-stu-id="c4cea-146">Create a custom template for the lower portion of the **General** page by modifying the PRINTDLGEXORD template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="c4cea-147">Как правило, пользовательский шаблон должен иметь тот же размер, что и шаблон по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c4cea-147">Typically, the custom template must be the same size as the default template.</span></span> <span data-ttu-id="c4cea-148">Однако можно увеличить пользовательский шаблон, если указать флаг **PD \_ уселаржетемплате** , чтобы создать **общую страницу общего** размера.</span><span class="sxs-lookup"><span data-stu-id="c4cea-148">However, you can enlarge the custom template if you specify the **PD\_USELARGETEMPLATE** flag to create a larger **General** page.</span></span> <span data-ttu-id="c4cea-149">Идентификаторы элементов управления, используемые в шаблоне диалогового окна **печати** по умолчанию, определяются в файле длгс. h.</span><span class="sxs-lookup"><span data-stu-id="c4cea-149">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="c4cea-150">Используйте структуру [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) , чтобы включить шаблон следующим образом:</span><span class="sxs-lookup"><span data-stu-id="c4cea-150">Use the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="c4cea-151">Если пользовательский шаблон является ресурсом в приложении или библиотеке динамической компоновки, установите флаг **PD \_ енаблепринттемплате** в элементе **flags** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-151">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="c4cea-152">Используйте элементы **HINSTANCE** и **лппринттемплатенаме** структуры для задания имени модуля и ресурса.</span><span class="sxs-lookup"><span data-stu-id="c4cea-152">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="c4cea-153">-Или-</span><span class="sxs-lookup"><span data-stu-id="c4cea-153">-Or-</span></span>

    -   <span data-ttu-id="c4cea-154">Если пользовательский шаблон уже находится в памяти, установите флаг **PD \_ енаблепринттемплатехандле** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-154">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="c4cea-155">Используйте элемент **HINSTANCE** для задания объекта памяти, содержащего шаблон.</span><span class="sxs-lookup"><span data-stu-id="c4cea-155">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

3.  <span data-ttu-id="c4cea-156">При использовании пользовательского шаблона для определения дополнительных элементов управления необходимо предоставить объект обратного вызова для обработки входных данных для элементов управления.</span><span class="sxs-lookup"><span data-stu-id="c4cea-156">If you use a custom template to define additional controls, you must provide a callback object to process input for your controls.</span></span> <span data-ttu-id="c4cea-157">Объект обратного вызова реализует метод [**ипринтдиалогкаллбакк:: хандлемессаже**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) , который получает сообщения, отправленные в настраиваемое диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="c4cea-157">The callback object implements a [**IPrintDialogCallback::HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) method which receives messages sent to the custom dialog box.</span></span>

<span data-ttu-id="c4cea-158">Предоставление дополнительных страниц свойств</span><span class="sxs-lookup"><span data-stu-id="c4cea-158">To provide additional property pages</span></span>

1.  <span data-ttu-id="c4cea-159">Используйте функцию, чтобы создать дополнительные страницы.</span><span class="sxs-lookup"><span data-stu-id="c4cea-159">Use the function to create the additional pages.</span></span>
2.  <span data-ttu-id="c4cea-160">Используйте элемент **лфпропертипажес** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) , чтобы указать массив дескрипторов для дополнительных страниц.</span><span class="sxs-lookup"><span data-stu-id="c4cea-160">Use the **lphPropertyPages** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to specify an array of handles to the additional pages.</span></span>

    <span data-ttu-id="c4cea-161">Процедуры диалоговых окон, указанные при создании каждой страницы, обрабатывают сообщения, отправленные на страницы.</span><span class="sxs-lookup"><span data-stu-id="c4cea-161">The dialog box procedures specified when you created each page process messages sent to the pages.</span></span>

3.  <span data-ttu-id="c4cea-162">Может потребоваться предоставить объект обратного вызова, который реализует интерфейс.</span><span class="sxs-lookup"><span data-stu-id="c4cea-162">You might want to provide a callback object that implements the interface.</span></span> <span data-ttu-id="c4cea-163">Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) использует этот интерфейс, чтобы передать приложению указатель на интерфейс [**ипринтдиалогсервицес**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-163">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses this interface to pass to the application a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface.</span></span> <span data-ttu-id="c4cea-164">В диалоговых окнах для дополнительных страниц свойств этот интерфейс можно использовать для получения сведений о текущем выбранном принтере.</span><span class="sxs-lookup"><span data-stu-id="c4cea-164">The dialog box procedures for the additional property pages can use this interface to retrieve information about the currently selected printer.</span></span>

## <a name="callback-object-for-the-print-property-sheet"></a><span data-ttu-id="c4cea-165">Объект обратного вызова для страницы свойств печати</span><span class="sxs-lookup"><span data-stu-id="c4cea-165">Callback Object for the Print Property Sheet</span></span>

<span data-ttu-id="c4cea-166">Приложение, отображающее страницу свойств **печати** , может реализовать объект обратного вызова для получения уведомлений и сообщений от функции [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) при отображении страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="c4cea-166">An application that displays a **Print** property sheet can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="c4cea-167">Чтобы предоставить объект обратного вызова, укажите указатель на объект в элементе **лпкаллбакк** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-167">To provide a callback object, specify a pointer to the object in the **lpCallback** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="c4cea-168">Объект обратного вызова должен реализовывать интерфейс [**ипринтдиалогкаллбакк**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-168">The callback object must implement the [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) interface.</span></span> <span data-ttu-id="c4cea-169">Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) вызывает методы **ипринтдиалогкаллбакк** в следующих ситуациях:</span><span class="sxs-lookup"><span data-stu-id="c4cea-169">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls **IPrintDialogCallback** methods in the following situations:</span></span>

-   <span data-ttu-id="c4cea-170">При инициализации диалогового окна</span><span class="sxs-lookup"><span data-stu-id="c4cea-170">When the dialog box has been initialized</span></span>
-   <span data-ttu-id="c4cea-171">Когда пользователь выбирает другой принтер из списка установленных принтеров, отображаемых на странице свойств</span><span class="sxs-lookup"><span data-stu-id="c4cea-171">When the user selects a different printer from the list of installed printers displayed by the property sheet</span></span>
-   <span data-ttu-id="c4cea-172">При получении сообщений для дочернего диалогового окна в нижней части страницы " **Общие** " вкладки свойств</span><span class="sxs-lookup"><span data-stu-id="c4cea-172">When it receives messages for the child dialog box in the lower portion of the property sheet's **General** page</span></span>

<span data-ttu-id="c4cea-173">Объект обратного вызова также должен реализовывать интерфейс [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) .</span><span class="sxs-lookup"><span data-stu-id="c4cea-173">The callback object should also implement the [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) interface.</span></span> <span data-ttu-id="c4cea-174">Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) вызывает метод, чтобы передать указатель на интерфейс [**ипринтдиалогсервицес**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) в приложение.</span><span class="sxs-lookup"><span data-stu-id="c4cea-174">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls the method to pass a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface to an application.</span></span> <span data-ttu-id="c4cea-175">Методы [**ипринтдиалогкаллбакк**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) могут использовать интерфейс **ипринтдиалогсервицес** для получения сведений о выбранном в данный момент принтере.</span><span class="sxs-lookup"><span data-stu-id="c4cea-175">The [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) methods can use the **IPrintDialogServices** interface to retrieve information about the currently selected printer.</span></span> <span data-ttu-id="c4cea-176">Интерфейс **ипринтдиалогсервицес** также полезен для приложений, которые создают дополнительные страницы для перехода на страницу « **Общие** » страницы свойств **печати** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-176">The **IPrintDialogServices** interface is also useful for applications that create additional pages to follow the **General** page of the **Print** property sheet.</span></span> <span data-ttu-id="c4cea-177">Процедуры диалоговых окон для дополнительных страниц могут вызывать методы **ипринтдиалогсервицес** .</span><span class="sxs-lookup"><span data-stu-id="c4cea-177">The dialog box procedures for the additional pages can call **IPrintDialogServices** methods.</span></span>

 

 