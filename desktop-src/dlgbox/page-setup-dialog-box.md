---
title: Диалоговое окно «Параметры страницы»
description: Отображает модальное диалоговое окно, позволяющее пользователю выбирать параметры, включающие тип бумаги, источник бумаги, ориентацию страницы и ширину полей страницы.
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Пользовательский интерфейс Windows, ввод данных пользователем
- Пользовательский интерфейс Windows, Библиотека общих диалоговых окон
- ввод пользователя, Библиотека общих диалоговых окон
- запись вводимых пользователем данных, Библиотека общих диалоговых окон
- Библиотека общих диалоговых окон
- Общие диалоговые окна
- диалоговое окно «Параметры страницы»
- диалоговое окно «Настройка параметров страницы»
- обработчики, диалоговое окно "Параметры страницы"
- стандартные диалоговые окна
- диалоговые окна, параметры страницы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104134534"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="39c8d-114">Диалоговое окно «Параметры страницы»</span><span class="sxs-lookup"><span data-stu-id="39c8d-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="39c8d-115">Отображает модальное диалоговое окно, позволяющее пользователю задать следующие атрибуты печатной страницы:</span><span class="sxs-lookup"><span data-stu-id="39c8d-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="39c8d-116">Тип бумаги (конверт, Юридическая информация, буква и т. д.)</span><span class="sxs-lookup"><span data-stu-id="39c8d-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="39c8d-117">Источник бумаги (ручной канал, веб-канал с перфорацией, податчик листов и т. д.)</span><span class="sxs-lookup"><span data-stu-id="39c8d-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="39c8d-118">Ориентация страницы (книжная или альбомная)</span><span class="sxs-lookup"><span data-stu-id="39c8d-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="39c8d-119">Ширина полей страницы</span><span class="sxs-lookup"><span data-stu-id="39c8d-119">The width of the page margins</span></span>

<span data-ttu-id="39c8d-120">Вы создаете и отображаете диалоговое окно **Параметры страницы** путем инициализации структуры [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) и передачи структуры в функцию [**пажесетупдлг**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="39c8d-121">Однако атрибуты, представленные в диалоговом окне, зависят от возможностей принтера.</span><span class="sxs-lookup"><span data-stu-id="39c8d-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="39c8d-122">На следующем рисунке показана типичная диалоговая **Страница Параметры страницы** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![диалоговое окно «Параметры страницы»](images/pagesetupdialogboxxp.png)

<span data-ttu-id="39c8d-124">Если пользователь нажмет кнопку **ОК** , [**Пажесетупдлг**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) возвращает **значение true** после настройки различных членов в структуре [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) для указания выбора пользователя.</span><span class="sxs-lookup"><span data-stu-id="39c8d-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="39c8d-125">Члены **птпаперсизе** и **ртмаргин** содержат значения, указанные пользователем.</span><span class="sxs-lookup"><span data-stu-id="39c8d-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="39c8d-126">Члены **хдевмоде** и **хдевнамес** содержат глобальные дескрипторы памяти для структур [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) и [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="39c8d-127">Эти структуры содержат дополнительные сведения о странице, а также сведения о принтере.</span><span class="sxs-lookup"><span data-stu-id="39c8d-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="39c8d-128">Эти сведения можно использовать для подготовки выходных данных к отправке на выбранный принтер.</span><span class="sxs-lookup"><span data-stu-id="39c8d-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="39c8d-129">Если пользователь отменяет диалоговое окно " **Параметры страницы** " или возникает ошибка, [**Пажесетупдлг**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) возвращает **значение false**.</span><span class="sxs-lookup"><span data-stu-id="39c8d-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="39c8d-130">Чтобы определить причину ошибки, вызовите функцию [**коммдлжекстендедеррор**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) , чтобы получить расширенное значение ошибки.</span><span class="sxs-lookup"><span data-stu-id="39c8d-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="39c8d-131">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="39c8d-132">Инициализация диалогового окна «Параметры страницы»</span><span class="sxs-lookup"><span data-stu-id="39c8d-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="39c8d-133">Настройка диалогового окна «Параметры страницы»</span><span class="sxs-lookup"><span data-stu-id="39c8d-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="39c8d-134">Настройка образца страницы</span><span class="sxs-lookup"><span data-stu-id="39c8d-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="39c8d-135">Инициализация диалогового окна «Параметры страницы»</span><span class="sxs-lookup"><span data-stu-id="39c8d-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="39c8d-136">По умолчанию в диалоговом окне « **Параметры страницы** » отображаются сведения о текущем принтере по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="39c8d-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="39c8d-137">Чтобы направить диалоговое окно для вывода сведений о конкретном принтере, установите элементы структуры [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) или [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) и назначьте глобальные дескрипторы памяти этих структур соответствующему элементу в [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span><span class="sxs-lookup"><span data-stu-id="39c8d-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="39c8d-138">Если указать имя принтера, которое не установлено в настоящий момент, в диалоговом окне появится сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="39c8d-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="39c8d-139">Чтобы диалоговое окно не отображало сообщения об ошибках, используйте значение **\_ непредупреждения PSD** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="39c8d-140">Чтобы получить сведения о принтере по умолчанию без отображения диалогового окна « **Параметры страницы** », используйте значение **PSD \_ ретурндефаулт** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="39c8d-141">Если системой измерения по умолчанию является дюйм, то в качестве единицы измерения по умолчанию в диалоговом окне используются доли дюйма.</span><span class="sxs-lookup"><span data-stu-id="39c8d-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="39c8d-142">Если системой измерения по умолчанию является метрика, то в диалоговом окне в качестве единицы измерения по умолчанию используются сотые миллиметры.</span><span class="sxs-lookup"><span data-stu-id="39c8d-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="39c8d-143">Чтобы переопределить единицу измерения по умолчанию, установите **флаг \_ PSD Инхундредссофмиллиметерс** или **PSD \_ инсаусандссофинчес** в элементе **flags** структуры [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="39c8d-144">Начальные значения для полей по умолчанию — 1 дюйм.</span><span class="sxs-lookup"><span data-stu-id="39c8d-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="39c8d-145">Если задать флаг **\_ полей PSD** , то в диалоговом окне будут отображены начальные значения полей, указанные в элементе **ртмаргин** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="39c8d-146">Минимальный размер полей, допустимый принтером, определяется по умолчанию минимальными значениями, которые пользователь может указать для полей.</span><span class="sxs-lookup"><span data-stu-id="39c8d-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="39c8d-147">Если задать флаг **PSD \_ минмаргинс** , то в диалоговом окне будут принудительно установлены минимальные поля, указанные в элементе **ртминмаргин** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="39c8d-148">Чтобы запретить пользователям выбирать определенные параметры, установите любое сочетание следующих флагов, чтобы отключить соответствующие элементы управления.</span><span class="sxs-lookup"><span data-stu-id="39c8d-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="39c8d-149">Flag</span><span class="sxs-lookup"><span data-stu-id="39c8d-149">Flag</span></span>                        | <span data-ttu-id="39c8d-150">Значение</span><span class="sxs-lookup"><span data-stu-id="39c8d-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="39c8d-151">**\_ДИСАБЛЕМАРГИНС PSD**</span><span class="sxs-lookup"><span data-stu-id="39c8d-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="39c8d-152">Отключает элементы управления "поле ввода", в которых пользователь вводит параметры поля.</span><span class="sxs-lookup"><span data-stu-id="39c8d-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="39c8d-153">**\_ДИСАБЛЕОРИЕНТАТИОН PSD**</span><span class="sxs-lookup"><span data-stu-id="39c8d-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="39c8d-154">Отключает переключатели **книжной** и **альбомной** ориентации.</span><span class="sxs-lookup"><span data-stu-id="39c8d-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="39c8d-155">**\_ДИСАБЛЕПАПЕР PSD**</span><span class="sxs-lookup"><span data-stu-id="39c8d-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="39c8d-156">Отключает элементы управления для выбора размера бумаги и источника бумаги.</span><span class="sxs-lookup"><span data-stu-id="39c8d-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="39c8d-157">**\_ДИСАБЛЕПРИНТЕР PSD**</span><span class="sxs-lookup"><span data-stu-id="39c8d-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="39c8d-158">Отключает кнопку " **принтер** ".</span><span class="sxs-lookup"><span data-stu-id="39c8d-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="39c8d-159">Настройка диалогового окна «Параметры страницы»</span><span class="sxs-lookup"><span data-stu-id="39c8d-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="39c8d-160">Можно указать пользовательский шаблон для диалогового окна **Параметры страницы** , например, если требуется включить дополнительные элементы управления, которые являются уникальными для приложения.</span><span class="sxs-lookup"><span data-stu-id="39c8d-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="39c8d-161">Функция [**пажесетупдлг**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) использует пользовательский шаблон вместо шаблона по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="39c8d-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="39c8d-162">**Предоставление пользовательского шаблона для диалогового окна «Параметры страницы»**</span><span class="sxs-lookup"><span data-stu-id="39c8d-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="39c8d-163">Создайте пользовательский шаблон, изменив шаблон по умолчанию, указанный в файле Прнсетуп. DLG.</span><span class="sxs-lookup"><span data-stu-id="39c8d-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="39c8d-164">Идентификаторы элементов управления, используемые в шаблоне диалогового окна **Параметры страницы** по умолчанию, определены в файле длгс. h.</span><span class="sxs-lookup"><span data-stu-id="39c8d-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="39c8d-165">Используйте структуру [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) , чтобы включить шаблон следующим образом:</span><span class="sxs-lookup"><span data-stu-id="39c8d-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="39c8d-166">Если пользовательский шаблон является ресурсом в приложении или библиотеке динамической компоновки, установите флаг **PSD \_ енаблепажесетуптемплате** в элементе **flags** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="39c8d-167">Используйте элементы **HINSTANCE** и **лппажесетуптемплатенаме** структуры для задания имени модуля и ресурса.</span><span class="sxs-lookup"><span data-stu-id="39c8d-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="39c8d-168">-Или-</span><span class="sxs-lookup"><span data-stu-id="39c8d-168">-Or-</span></span>

        -   <span data-ttu-id="39c8d-169">Если пользовательский шаблон уже находится в памяти, установите флаг **PSD \_ енаблепажесетуптемплатехандле** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="39c8d-170">Используйте элемент **хпажесетуптемплате** для задания объекта памяти, содержащего шаблон.</span><span class="sxs-lookup"><span data-stu-id="39c8d-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="39c8d-171">Чтобы отфильтровать сообщения, отправляемые в процедуру диалогового окна, можно предоставить процедуру обработчика [**пажесетуфук**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="39c8d-172">При использовании пользовательского шаблона для определения дополнительных элементов управления необходимо предоставить процедуру обработчика **пажесетуфук** для обработки входных данных для элементов управления.</span><span class="sxs-lookup"><span data-stu-id="39c8d-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="39c8d-173">Кроме того, можно предоставить процедуру обработчика [**пажепаинсук**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) для настройки содержимого образца страницы, отображаемого в диалоговом окне « **Параметры страницы** ».</span><span class="sxs-lookup"><span data-stu-id="39c8d-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="39c8d-174">Дополнительные сведения о процедуре обработчика **пажепаинсук** см. [в разделе Настройка образца страницы](#customizing-the-sample-page).</span><span class="sxs-lookup"><span data-stu-id="39c8d-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="39c8d-175">**Включение процедуры-обработчика Пажесетуфук**</span><span class="sxs-lookup"><span data-stu-id="39c8d-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="39c8d-176">Установите флаг **PSD \_ енаблепажесетуфук** в элементе **flags** структуры [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="39c8d-177">Укажите адрес процедуры-обработчика в элементе **лпфнпажесетуфук** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="39c8d-178">После обработки сообщения [**WM \_ инитдиалог**](wm-initdialog.md) процедура диалогового окна отправляет сообщение **WM \_ Инитдиалог** в процедуру обработчика [**пажесетуфук**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="39c8d-179">Параметр *lParam* этого сообщения является указателем на структуру [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) , используемую для инициализации диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="39c8d-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="39c8d-180">Настройка образца страницы</span><span class="sxs-lookup"><span data-stu-id="39c8d-180">Customizing the Sample Page</span></span>

<span data-ttu-id="39c8d-181">Диалоговое окно **Параметры страницы** содержит изображение образца страницы, показывающее, как выбранные пользователем параметры влияют на внешний вид напечатанных данных.</span><span class="sxs-lookup"><span data-stu-id="39c8d-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="39c8d-182">Изображение состоит из прямоугольника, представляющего выбранную бумагу или тип конверта, с пунктирным прямоугольником, представляющим текущие поля, и частичными (греческими текстовыми) символами для демонстрации того, как выглядит текст на печатной странице.</span><span class="sxs-lookup"><span data-stu-id="39c8d-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="39c8d-183">При вызове функции [**пажесетупдлг**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) можно предоставить процедуру-обработчик [**пажепаинсук**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) для настройки внешнего вида образца страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="39c8d-184">**Включение процедуры-обработчика Пажепаинсук**</span><span class="sxs-lookup"><span data-stu-id="39c8d-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="39c8d-185">Установите флаг **PSD \_ енаблепажепаинсук** в элементе **flags** структуры [**пажесетупдлг**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="39c8d-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="39c8d-186">Укажите адрес процедуры-обработчика в элементе **лпфнпажепаинсук** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="39c8d-187">Каждый раз, когда диалоговое окно собирается вывести содержимое образца страницы, процедура-обработчик получает следующие сообщения в том порядке, в котором они перечислены.</span><span class="sxs-lookup"><span data-stu-id="39c8d-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="39c8d-188">Сообщение</span><span class="sxs-lookup"><span data-stu-id="39c8d-188">Message</span></span>                                                  | <span data-ttu-id="39c8d-189">Значение</span><span class="sxs-lookup"><span data-stu-id="39c8d-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="39c8d-190">**WM \_ PSD \_ пажесетупдлг**</span><span class="sxs-lookup"><span data-stu-id="39c8d-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="39c8d-191">Диалоговое окно собирается нарисовать образец страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="39c8d-192">Процедура-обработчик может использовать это сообщение для подготовки к отрисовке содержимого образца страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="39c8d-193">**WM \_ PSD \_ фуллпажерект**</span><span class="sxs-lookup"><span data-stu-id="39c8d-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="39c8d-194">Диалоговое окно собирается нарисовать образец страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="39c8d-195">В этом сообщении указывается ограничивающий прямоугольник образца страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="39c8d-196">**WM \_ PSD \_ минмаргинрект**</span><span class="sxs-lookup"><span data-stu-id="39c8d-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="39c8d-197">Диалоговое окно собирается нарисовать образец страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="39c8d-198">Это сообщение указывает прямоугольник поля.</span><span class="sxs-lookup"><span data-stu-id="39c8d-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="39c8d-199">**WM \_ PSD \_ маргинрект**</span><span class="sxs-lookup"><span data-stu-id="39c8d-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="39c8d-200">Диалоговое окно собирается нарисовать прямоугольник поля.</span><span class="sxs-lookup"><span data-stu-id="39c8d-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="39c8d-201">**WM \_ PSD \_ гриктекстрект**</span><span class="sxs-lookup"><span data-stu-id="39c8d-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="39c8d-202">Диалоговое окно собирается нарисовать Греческий текст внутри прямоугольника поля.</span><span class="sxs-lookup"><span data-stu-id="39c8d-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="39c8d-203">**WM \_ PSD \_ енвстампрект**</span><span class="sxs-lookup"><span data-stu-id="39c8d-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="39c8d-204">Диалоговое окно собирается нарисоваться в прямоугольнике метки конверта на странице образца конверта.</span><span class="sxs-lookup"><span data-stu-id="39c8d-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="39c8d-205">Это сообщение отправляется только для конвертов.</span><span class="sxs-lookup"><span data-stu-id="39c8d-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="39c8d-206">**WM \_ PSD \_ яфуллпажерект**</span><span class="sxs-lookup"><span data-stu-id="39c8d-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="39c8d-207">Откроется диалоговое окно, в котором будет отображаться часть возвращаемого адреса на странице образца конверта.</span><span class="sxs-lookup"><span data-stu-id="39c8d-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="39c8d-208">Это сообщение отправляется для конвертов и других размеров бумаги.</span><span class="sxs-lookup"><span data-stu-id="39c8d-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="39c8d-209">Если процедура-обработчик возвращает **значение true** для любого из первых трех сообщений последовательности ([**WM \_ PSD \_ пажесетупдлг**](wm-psd-pagesetupdlg.md), [**WM \_ PSD \_ фуллпажерект**](wm-psd-fullpagerect.md)или [**WM \_ PSD \_ минмаргинрект**](wm-psd-minmarginrect.md)), то диалоговое окно отправляет больше сообщений и не рисует его на странице до следующего момента, когда системе потребуется перерисовать образец страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="39c8d-210">Если процедура-обработчик возвращает **значение false** для всех трех сообщений, то диалоговое окно отправляет оставшиеся сообщения последовательности отображения.</span><span class="sxs-lookup"><span data-stu-id="39c8d-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="39c8d-211">Если процедура-обработчик возвращает **значение true** для любого из оставшихся сообщений в последовательности отображения, диалоговое окно не рисует соответствующую часть образца страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="39c8d-212">Если процедура-обработчик возвращает **значение false** для любого из этих сообщений, диалоговое окно выводит эту часть образца страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="39c8d-213">Чтобы диалоговое окно не могли рисовать содержимое образца страницы, можно установить флаг **PSD \_ дисаблепажепаинтинг** .</span><span class="sxs-lookup"><span data-stu-id="39c8d-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="39c8d-214">Этот флаг не влияет на процедуру-обработчик [**пажепаинсук**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) , которая получает все сообщения в **формате \_ WM \_ \* PSD** и может отображать образец содержимого страницы.</span><span class="sxs-lookup"><span data-stu-id="39c8d-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 