---
title: Обрезка (DirectComposition)
description: В этом разделе описывается поддержка обрезкими визуальных элементов в Microsoft DirectComposition.
ms.assetid: B6E0D8F5-B6B9-40CC-B079-850AC8F2D538
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f4feb537dfb41053dd1099eca7f122b3284dce95
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104414669"
---
# <a name="clipping-directcomposition"></a><span data-ttu-id="5b0ca-103">Обрезка (DirectComposition)</span><span class="sxs-lookup"><span data-stu-id="5b0ca-103">Clipping (DirectComposition)</span></span>

> [!NOTE]
> <span data-ttu-id="5b0ca-104">Для приложений в Windows 10 рекомендуется использовать интерфейсы API Windows. UI. компоновки вместо DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-104">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="5b0ca-105">Дополнительные сведения см. в разделе [модернизировать The классическое приложение с использованием визуального слоя](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="5b0ca-105">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="5b0ca-106">Обрезка позволяет раскрывать только часть визуального или визуального дерева путем ограничения отрисовки визуального элемента или дерева определенной прямоугольной областью.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-106">Clipping provides a way to reveal only a portion of a visual or visual tree by limiting the rendering of the visual or tree to a particular rectangular area.</span></span> <span data-ttu-id="5b0ca-107">В этом разделе описывается поддержка обрезкими визуальных элементов в Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-107">This topic describes Microsoft DirectComposition support for clipping visuals.</span></span> <span data-ttu-id="5b0ca-108">Она включает следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="5b0ca-108">It includes the following sections:</span></span>

-   [<span data-ttu-id="5b0ca-109">Прямоугольник обрезки</span><span class="sxs-lookup"><span data-stu-id="5b0ca-109">Clip rectangle</span></span>](#clip-rectangle)
-   [<span data-ttu-id="5b0ca-110">Объект Clip</span><span class="sxs-lookup"><span data-stu-id="5b0ca-110">Clip object</span></span>](#clip-object)
-   [<span data-ttu-id="5b0ca-111">Анимированный прямоугольник клипа</span><span class="sxs-lookup"><span data-stu-id="5b0ca-111">Animated clip rectangle</span></span>](#animated-clip-rectangle)
-   [<span data-ttu-id="5b0ca-112">См. также</span><span class="sxs-lookup"><span data-stu-id="5b0ca-112">Related topics</span></span>](#related-topics)

## <a name="clip-rectangle"></a><span data-ttu-id="5b0ca-113">Прямоугольник обрезки</span><span class="sxs-lookup"><span data-stu-id="5b0ca-113">Clip rectangle</span></span>

<span data-ttu-id="5b0ca-114">Визуальный объект имеет свойство Clip, определяющее прямоугольную область или *прямоугольный прямоугольник* в содержимом растрового изображения визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-114">A visual object has a Clip property that defines a rectangular region, or *clip rectangle*, within the visual's bitmap content.</span></span> <span data-ttu-id="5b0ca-115">При отрисовке визуального элемента на экране отображается только часть содержимого растрового изображения, находящаяся внутри прямоугольника обрезки, а содержимое, выходящее за пределы прямоугольника обрезки, обрезается (не рисуется).</span><span class="sxs-lookup"><span data-stu-id="5b0ca-115">When the visual is rendered to the screen, only the portion of the bitmap content that is inside the clip rectangle is drawn on the screen, while the content that extends outside the clip rectangle is clipped (not drawn).</span></span> <span data-ttu-id="5b0ca-116">По умолчанию свойство Clip включает все содержимое растрового изображения.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-116">By default, the Clip property includes all bitmap content.</span></span>

<span data-ttu-id="5b0ca-117">Свойство Clip для визуального элемента применяется ко всем дочерним и потомкам дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-117">A visual's Clip property applies to all child and descendent visuals.</span></span> <span data-ttu-id="5b0ca-118">Иными словами, все дочернее или дочернее содержимое, находящееся за пределами границ родительского прямоугольника, также обрезается.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-118">In other words, any child or descendent content that falls outside the bounds of the parent's clip rectangle is also clipped.</span></span>

<span data-ttu-id="5b0ca-119">DirectComposition применяет свойство Clip перед применением свойств Оффсеткс, offset и 2D-преобразования, но после применения эффектов и свойств трехмерного преобразования.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-119">DirectComposition applies the Clip property before applying the OffsetX, OffsetY, and 2D Transform properties, but after applying the Effect and 3D Transform properties.</span></span> <span data-ttu-id="5b0ca-120">Это означает, что двумерные преобразования, Оффсеткс и смещение будут влиять как на визуальное содержимое, так и на прямоугольник клипа.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-120">This means that 2D Transforms, OffsetX, and OffsetY, will affect both the visual content, and the clip rectangle.</span></span> <span data-ttu-id="5b0ca-121">В то время как трехмерные преобразования и эффекты не будут применены к прямоугольнику Clip.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-121">Whereas 3D transforms and effects will not apply to the clip rectangle.</span></span>

<span data-ttu-id="5b0ca-122">Например, при применении смещения или 2D-преобразования к прямоугольнику обрезки применяется матрица преобразования.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-122">For example, when applying an offset or 2D transform, the clip rectangle is affected by the transformation matrix.</span></span> <span data-ttu-id="5b0ca-123">Таким образом, добавление смещения и 2D-вращения (45 градусов) вместе с скругленным угловым прямоугольником приведет к следующим результатам:</span><span class="sxs-lookup"><span data-stu-id="5b0ca-123">So adding an offset and a 2D rotate (45 degrees) along with a rounded corner clip rectangle will result in this:</span></span>

![Схема, демонстрирующая результат 2D-преобразования в прямоугольнике обрезки.](images/clipping2dtransform.png)

<span data-ttu-id="5b0ca-125">При применении трехмерного преобразования «внутри» прямоугольника обрезки матрица преобразования не влияет на прямоугольник.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-125">When applying a 3D transformation “within” the clip rectangle, the clip rectangle is not affected by the transformation matrix.</span></span> <span data-ttu-id="5b0ca-126">Даже при применении вращения вокруг оси Z (аналогично предыдущему примеру) Следующая диаграмма является результатом:</span><span class="sxs-lookup"><span data-stu-id="5b0ca-126">Even when applying a rotation around the Z axis (effectively the same as the previous example), the following diagram is the result:</span></span>

![Схема, показывающая, что трехмерное преобразование не влияет на прямоугольный ролик (визуальный поворот внутри клипа).](images/clipping3dtransform.png)

<span data-ttu-id="5b0ca-128">Обратите внимание, что визуальный элемент, повернутый в зажиме, потому, что трехмерная матрица не применяется к самому клипу.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-128">Note that the visual rotated within the clip because the 3D matrix is not applied to the clip itself.</span></span>

<span data-ttu-id="5b0ca-129">Если для свойства Clip задан пустой прямоугольник, визуальный элемент полностью обрезается. Это значит, что визуальный элемент включен в визуальное дерево, но не отображает ничего.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-129">If the Clip property is set to an empty rectangle, the visual is fully clipped; that is, the visual is included in the visual tree, but it does not render anything.</span></span> <span data-ttu-id="5b0ca-130">Если вы не хотите включать в композицию конкретный визуальный элемент, удалите визуальный элемент из визуального дерева вместо установки пустого прямоугольника обрезки.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-130">If you do not want to include a particular visual in a composition, remove the visual from the visual tree instead of setting an empty clip rectangle.</span></span> <span data-ttu-id="5b0ca-131">Удаление визуальных результатов обеспечивает лучшую производительность.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-131">Removing the visual results in better performance.</span></span>

<span data-ttu-id="5b0ca-132">Свойство Clip визуального элемента задается с помощью метода [**идкомпоситионвисуал:: сетклип**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) .</span><span class="sxs-lookup"><span data-stu-id="5b0ca-132">You set the Clip property of a visual by using the [**IDCompositionVisual::SetClip**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) method.</span></span> <span data-ttu-id="5b0ca-133">Этот метод включает перегрузки, которые позволяют задать значение свойства Clip в виде статического прямоугольника или объекта Clip.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-133">This method includes overloads that enable you to set the value of the Clip property to a static rectangle or to a clip object.</span></span> <span data-ttu-id="5b0ca-134">Используйте статический прямоугольник, если не нужно изменять размеры прямоугольника обрезки в течение времени существования визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-134">Use a static rectangle if you do not need to change the dimensions of the clip rectangle during the lifetime of the visual.</span></span> <span data-ttu-id="5b0ca-135">Если необходимо изменить размеры или анимировать прямоугольник обрезки, используйте объект Clip.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-135">If you do need to change the dimensions or animate the clip rectangle, use a clip object.</span></span>

## <a name="clip-object"></a><span data-ttu-id="5b0ca-136">Объект Clip</span><span class="sxs-lookup"><span data-stu-id="5b0ca-136">Clip object</span></span>

<span data-ttu-id="5b0ca-137">Объект Clip — это объект модели COM, представляющий прямоугольник Clip.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-137">A clip object is a Component Object Model (COM) object that represents a clip rectangle.</span></span> <span data-ttu-id="5b0ca-138">Объект Clip создается с помощью метода [**идкомпоситиондевице:: креатеректанглеклип**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createrectangleclip) , а затем для задания свойств объекта используется интерфейс [**идкомпоситионректанглеклип**](/windows/win32/api/dcomp/nn-dcomp-idcompositionrectangleclip) объекта.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-138">You create a clip object by using the [**IDCompositionDevice::CreateRectangleClip**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createrectangleclip) method, and then use the object's [**IDCompositionRectangleClip**](/windows/win32/api/dcomp/nn-dcomp-idcompositionrectangleclip) interface to set the properties of the object.</span></span> <span data-ttu-id="5b0ca-139">Только что созданный объект Clip имеет минимальные возможные значения для свойств Left и Top, а также максимальное возможное значение для свойств Right и Bottom, что фактически делает его объектом Clip-Op.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-139">A newly created clip object has the minimum possible values for the Left and Top properties, and the maximum possible values for the Right and Bottom properties, effectively making it a no-op clip object.</span></span> <span data-ttu-id="5b0ca-140">Иными словами, объект представляет прямоугольник клипа, который будет включать все содержимое растрового изображения визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-140">In other words, the object represents a clip rectangle that would include the entire bitmap content of a visual.</span></span>

<span data-ttu-id="5b0ca-141">Объект Clip включает набор свойств, позволяющих указать скругленные углы для объекта Clip.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-141">A clip object includes a set of properties that enable you to specify rounded corners for the clip object.</span></span> <span data-ttu-id="5b0ca-142">Свойства позволяют задать радиус и радиус оси x для каждого угла объекта обрезки.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-142">The properties enable you to set the x radius and y radius of each corner of the clipping object.</span></span>

## <a name="animated-clip-rectangle"></a><span data-ttu-id="5b0ca-143">Анимированный прямоугольник клипа</span><span class="sxs-lookup"><span data-stu-id="5b0ca-143">Animated clip rectangle</span></span>

<span data-ttu-id="5b0ca-144">Можно анимировать прямоугольник клипа, применяя объекты анимации к свойствам слева, сверху, справа и снизу объекта Clip.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-144">You can animate a clip rectangle by applying animation objects to the Left, Top, Right, and Bottom properties of a clip object.</span></span> <span data-ttu-id="5b0ca-145">Используйте перегруженный метод [**идкомпоситионвисуал:: сетклип (идкомпоситионклип)**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(idcompositionclip)) , чтобы применить анимированный прямоугольник клипа к свойству Clip визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="5b0ca-145">Use the [**IDCompositionVisual::SetClip(IDCompositionClip)**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(idcompositionclip)) overloaded method to apply the animated clip rectangle to the Clip property of a visual.</span></span>

<span data-ttu-id="5b0ca-146">Дополнительные сведения об объектах анимации см. в разделе [анимация](animation.md).</span><span class="sxs-lookup"><span data-stu-id="5b0ca-146">For more information about animation objects, see [Animation](animation.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5b0ca-147">См. также</span><span class="sxs-lookup"><span data-stu-id="5b0ca-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5b0ca-148">Основные понятия DirectComposition</span><span class="sxs-lookup"><span data-stu-id="5b0ca-148">DirectComposition Concepts</span></span>](directcomposition-concepts.md)
</dt> <dt>

[<span data-ttu-id="5b0ca-149">Обрезка с помощью объекта прямоугольной обрезки</span><span class="sxs-lookup"><span data-stu-id="5b0ca-149">How to Clip with a Rectangle Clip Object</span></span>](how-to--set-the-clip-rectangle-for-a-visual.md)
</dt> </dl>

 

 
