---
title: Анимация (DirectComposition)
description: В этом разделе обсуждаются основы анимации Microsoft DirectComposition.
ms.assetid: 65DA3971-97C0-4B59-BC67-287AAEAAE340
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f7462a10fd83b45c1b90450fdde806ef306a2f6
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "105681726"
---
# <a name="animation-directcomposition"></a><span data-ttu-id="397dd-103">Анимация (DirectComposition)</span><span class="sxs-lookup"><span data-stu-id="397dd-103">Animation (DirectComposition)</span></span>

> [!NOTE]
> <span data-ttu-id="397dd-104">Для приложений в Windows 10 рекомендуется использовать интерфейсы API Windows. UI. компоновки вместо DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="397dd-104">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="397dd-105">Дополнительные сведения см. в разделе [модернизировать The классическое приложение с использованием визуального слоя](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="397dd-105">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="397dd-106">В этом разделе обсуждаются основы анимации Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="397dd-106">This topic discusses the basics of Microsoft DirectComposition animation.</span></span> <span data-ttu-id="397dd-107">Занятие содержит следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="397dd-107">It contains the following topics:</span></span>

-   [<span data-ttu-id="397dd-108">Что такое анимация?</span><span class="sxs-lookup"><span data-stu-id="397dd-108">What is an animation?</span></span>](#what-is-an-animation)
-   [<span data-ttu-id="397dd-109">Свойства, которые могут быть анимированы</span><span class="sxs-lookup"><span data-stu-id="397dd-109">Properties that can be animated</span></span>](#properties-that-can-be-animated)
-   [<span data-ttu-id="397dd-110">Функции анимации</span><span class="sxs-lookup"><span data-stu-id="397dd-110">Animation functions</span></span>](#animation-functions)
-   [<span data-ttu-id="397dd-111">Сегменты анимации</span><span class="sxs-lookup"><span data-stu-id="397dd-111">Animation segments</span></span>](#animation-segments)
    -   [<span data-ttu-id="397dd-112">Сегмент в кубических</span><span class="sxs-lookup"><span data-stu-id="397dd-112">Cubic segment</span></span>](#cubic-segment)
    -   [<span data-ttu-id="397dd-113">Сегмент синусоидальной</span><span class="sxs-lookup"><span data-stu-id="397dd-113">Sinusoidal segment</span></span>](#sinusoidal-segment)
    -   [<span data-ttu-id="397dd-114">Повторить сегмент</span><span class="sxs-lookup"><span data-stu-id="397dd-114">Repeat segment</span></span>](#repeat-segment)
    -   [<span data-ttu-id="397dd-115">Конечный сегмент</span><span class="sxs-lookup"><span data-stu-id="397dd-115">End segment</span></span>](#end-segment)
-   [<span data-ttu-id="397dd-116">Совместимость с диспетчером анимации Windows</span><span class="sxs-lookup"><span data-stu-id="397dd-116">Compatibility with Windows Animation Manager</span></span>](#compatibility-with-windows-animation-manager)
-   [<span data-ttu-id="397dd-117">См. также</span><span class="sxs-lookup"><span data-stu-id="397dd-117">Related topics</span></span>](#related-topics)

## <a name="what-is-an-animation"></a><span data-ttu-id="397dd-118">Что такое анимация?</span><span class="sxs-lookup"><span data-stu-id="397dd-118">What is an animation?</span></span>

<span data-ttu-id="397dd-119">*Анимация* — это оптическая иллюзия, которая быстро делает добавочные изменения визуального элемента в течение определенного периода времени, перерисуя визуальный элемент после каждого изменения.</span><span class="sxs-lookup"><span data-stu-id="397dd-119">*Animation* is an optical illusion created by quickly making incremental changes to a visual over a period of time while redrawing the visual after each change is made.</span></span> <span data-ttu-id="397dd-120">Поскольку перерисовки происходят быстро, мозг воспринимается в виде одной изменяющейся сцены, как в фильме или видео о действии в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="397dd-120">Because the redraws occur quickly, the brain perceives the incremental changes as a single changing scene, just as in a movie or video of live action.</span></span>

<span data-ttu-id="397dd-121">В следующей таблице описаны некоторые типичные способы использования анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-121">The following table describes some of the typical ways of using animation.</span></span>

| <span data-ttu-id="397dd-122">Анимация</span><span class="sxs-lookup"><span data-stu-id="397dd-122">Animation</span></span>                 | <span data-ttu-id="397dd-123">Описание</span><span class="sxs-lookup"><span data-stu-id="397dd-123">Description</span></span>                                                                                                                                                                                                                                          |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="397dd-124">Прокрутка</span><span class="sxs-lookup"><span data-stu-id="397dd-124">Scrolling</span></span>                 | <span data-ttu-id="397dd-125">Используйте анимацию, чтобы добавить такие функции, как физическое имитация импульса, в элемент управления "прокручиваемый список".</span><span class="sxs-lookup"><span data-stu-id="397dd-125">Use animation to add features like physics-emulating momentum to a scrolling list control.</span></span>                                                                                                                                                           |
| <span data-ttu-id="397dd-126">Переходы сцены</span><span class="sxs-lookup"><span data-stu-id="397dd-126">Scene transitions</span></span>         | <span data-ttu-id="397dd-127">Используйте анимацию для создания переходов по монтажным кадрам, обеспечивающих непрерывность задач в рабочем процессе.</span><span class="sxs-lookup"><span data-stu-id="397dd-127">Use animation to create navigational scene transitions that provide continuity between tasks in a workflow.</span></span> <span data-ttu-id="397dd-128">Переходы по монтажным кадрам предоставляют контекст, который показывает пользователя, где они были, где они были, и где они должны идти дальше.</span><span class="sxs-lookup"><span data-stu-id="397dd-128">Navigational scene transitions provide context that shows the user where they have been, where they are, and where they need to go next.</span></span> |
| <span data-ttu-id="397dd-129">Взаимодействие между окнами</span><span class="sxs-lookup"><span data-stu-id="397dd-129">Cross-window interactions</span></span> | <span data-ttu-id="397dd-130">Анимация элементов пользовательского интерфейса различных приложений таким образом, что дает возможность восприятия между ними, что позволяет пользователю завершать задачи, связанные с переключением из одного приложения в другое.</span><span class="sxs-lookup"><span data-stu-id="397dd-130">Animate UI elements of different applications in a way that gives the perception of seamless continuity between them to help the user complete tasks that involve switching from one application to another.</span></span>                                         |



 

## <a name="properties-that-can-be-animated"></a><span data-ttu-id="397dd-131">Свойства, которые могут быть анимированы</span><span class="sxs-lookup"><span data-stu-id="397dd-131">Properties that can be animated</span></span>

<span data-ttu-id="397dd-132">В DirectComposition вы выполняете анимацию визуального элемента, применяя анимацию к отдельным свойствам объектов, определяющих визуальный элемент.</span><span class="sxs-lookup"><span data-stu-id="397dd-132">In DirectComposition, you animate a visual by applying animation to individual properties of the objects that define the visual.</span></span> <span data-ttu-id="397dd-133">Например, если требуется переместить визуальный элемент по горизонтали на экран, то анимация будет применена к свойству Оффсеткс визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="397dd-133">For example, if you want to move a visual horizontally across the screen, you would apply animation to the OffsetX property of the visual.</span></span> <span data-ttu-id="397dd-134">Аналогичным образом, если вы хотите выполнить простой анимированный 2D-поворот визуального элемента, можно применить анимацию к свойству Angle объекта 2D-преобразования, а затем применить объект 2D-преобразования к свойству Transform визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="397dd-134">Similarly, if you wanted to do a simple animated 2D rotation of a visual, you would apply animation to the Angle property of a 2D transform object, and then apply the 2D transform object to the Transform property of the visual.</span></span>

<span data-ttu-id="397dd-135">DirectComposition позволяет применять анимацию к любому свойству объекта, которое принимает скалярное значение.</span><span class="sxs-lookup"><span data-stu-id="397dd-135">DirectComposition enables you to apply animation to any object property that takes a scalar value.</span></span> <span data-ttu-id="397dd-136">Можно применять одновременную анимацию к нескольким свойствам и нескольким объектам.</span><span class="sxs-lookup"><span data-stu-id="397dd-136">You can apply simultaneous animations to multiple properties and multiple objects.</span></span>

<span data-ttu-id="397dd-137">DirectComposition запускает анимацию в отдельном потоке.</span><span class="sxs-lookup"><span data-stu-id="397dd-137">DirectComposition runs animations on a separate thread.</span></span> <span data-ttu-id="397dd-138">Можно запустить анимацию или набор анимаций, а затем выполнить другие действия над потоками приложения или даже перевести потоки в спящий режим, в то время как механизм композиции выполняет анимацию с соответствующей частотой кадров.</span><span class="sxs-lookup"><span data-stu-id="397dd-138">You can start an animation or set of animations and then do other work on your application threads, or even put threads to sleep, while the composition engine runs the animations at the appropriate frame rate.</span></span>

## <a name="animation-functions"></a><span data-ttu-id="397dd-139">Функции анимации</span><span class="sxs-lookup"><span data-stu-id="397dd-139">Animation functions</span></span>

<span data-ttu-id="397dd-140">DirectComposition анимирует свойство объекта на основе определяемой пользователем функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-140">DirectComposition animates an object property based on an animation function that you define.</span></span> <span data-ttu-id="397dd-141">*Функция анимации* — это конструкция, которая указывает, как изменяется значение свойства объекта за определенный период времени.</span><span class="sxs-lookup"><span data-stu-id="397dd-141">An *animation function* is a construct that specifies how the value of an object property changes over a period of time.</span></span> <span data-ttu-id="397dd-142">Например, можно определить функцию анимации, которая изменяет значение свойства с 1 на 360 в течение 4 секунд.</span><span class="sxs-lookup"><span data-stu-id="397dd-142">For example, you could define an animation function that changes the value of a property from 1 to 360 over the course of 4 seconds.</span></span> <span data-ttu-id="397dd-143">Затем, если применить функцию анимации к свойству Angle объекта преобразования 2D-вращения, а затем применить объект Transform к свойству Transform визуального элемента, функция анимации будет вращать визуальный элемент в полном круге в течение 4 секунд.</span><span class="sxs-lookup"><span data-stu-id="397dd-143">Then, if you apply the animation function to the Angle property of a 2D rotate transform object, and then apply the transform object to the Transform property of a visual, the animation function would rotate the visual in a full circle over the course of 4 seconds.</span></span>

<span data-ttu-id="397dd-144">Функция анимации представлена *объектом анимации* , созданным путем вызова метода [**Идкомпоситиондевице:: креатеаниматион**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createanimation) .</span><span class="sxs-lookup"><span data-stu-id="397dd-144">An animation function is represented by an *animation object* created by a call to the [**IDCompositionDevice::CreateAnimation**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createanimation) method.</span></span> <span data-ttu-id="397dd-145">Вы создаете функцию анимации с помощью методов интерфейса [**идкомпоситионаниматион**](/windows/desktop/api/DcompAnimation/nn-dcompanimation-idcompositionanimation) объекта анимации, чтобы добавлять *сегменты анимации* по одной за раз в массив, определяющий функцию анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-145">You create an animation function by using the methods of an animation object's [**IDCompositionAnimation**](/windows/desktop/api/DcompAnimation/nn-dcompanimation-idcompositionanimation) interface to append *animation segments*, one at a time, to the array that defines the animation function.</span></span> <span data-ttu-id="397dd-146">При добавлении сегмента задается смещение, начинающееся с нуля, которое отмечает время начала сегмента относительно начала функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-146">When appending a segment, you specify a zero-based offset that marks the begin time of the segment, relative to the beginning of the animation function.</span></span> <span data-ttu-id="397dd-147">Сегменты анимации должны добавляться в порядке возрастания времени начала.</span><span class="sxs-lookup"><span data-stu-id="397dd-147">Animation segments must be appended in increasing order of begin times.</span></span> <span data-ttu-id="397dd-148">Попытка добавить сегмент анимации, время начала которого меньше или равно предыдущему сегменту, завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="397dd-148">Attempting to append an animation segment whose begin time is before or equal to a preceding segment will fail.</span></span> <span data-ttu-id="397dd-149">Функция анимации может иметь указанное время окончания, указывающее, когда должна завершаться функция.</span><span class="sxs-lookup"><span data-stu-id="397dd-149">An animation function can have a specified end time, indicating when the function should conclude.</span></span>

<span data-ttu-id="397dd-150">Если не указано иное, функция анимации запускается, когда диспетчер окон рабочего стола (DWM) получает команду для выполнения анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-150">Unless otherwise specified, an animation function starts when the Desktop Window Manager (DWM) receives the command to execute the animation.</span></span> <span data-ttu-id="397dd-151">Каждый сегмент выполняется до тех пор, пока не будет достигнуто время начала следующего сегмента.</span><span class="sxs-lookup"><span data-stu-id="397dd-151">Each segment runs until the begin time of the next segment is reached.</span></span> <span data-ttu-id="397dd-152">Все ненепрерывные изменения, происходящие в значении анимированного свойства между сегментами, считаются дискретными изменениями.</span><span class="sxs-lookup"><span data-stu-id="397dd-152">Any discontinuous changes that occur in the animated property value between segments are considered to be discrete changes.</span></span>

<span data-ttu-id="397dd-153">Функция анимации применяется к свойству путем присвоения свойству значения [**идкомпоситионаниматион**](/windows/desktop/api/DcompAnimation/nn-dcompanimation-idcompositionanimation) указателя объекта анимации, представляющего функцию анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-153">You apply an animation function to a property by setting the property value to the [**IDCompositionAnimation**](/windows/desktop/api/DcompAnimation/nn-dcompanimation-idcompositionanimation) pointer of the animation object that represents the animation function.</span></span> <span data-ttu-id="397dd-154">Один и тот же объект анимации может применяться к нескольким свойствам одного и того же объекта, а также к свойствам других объектов, созданных тем же устройством.</span><span class="sxs-lookup"><span data-stu-id="397dd-154">The same animation object can be applied to multiple properties of the same object, as well as to the properties of other objects created by the same device.</span></span>

## <a name="animation-segments"></a><span data-ttu-id="397dd-155">Сегменты анимации</span><span class="sxs-lookup"><span data-stu-id="397dd-155">Animation segments</span></span>

<span data-ttu-id="397dd-156">Сегменты анимации являются фундаментальными определениями времени функции анимации. Это примитивы, из которых строятся более сложные и более высокие функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-156">Animation segments are the fundamental timing definitions of an animation function; they are the primitives from which more complex and higher level animation functions are built.</span></span> <span data-ttu-id="397dd-157">Сегмент анимации создается на основе ряда параметров, описывающих функцию, и времени начала сегмента относительно начала функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-157">An animation segment is constructed from a series of parameters that describe the function and the time when the segment begins, relative to the beginning of the animation function.</span></span> <span data-ttu-id="397dd-158">Для каждого сегмента, время (*t*) выполняется вдоль горизонтальной оси и начинается с *t* = 0.</span><span class="sxs-lookup"><span data-stu-id="397dd-158">For every segment, time (*t*) progresses along the horizontal axis and begins at *t* = 0.</span></span>

### <a name="cubic-segment"></a><span data-ttu-id="397dd-159">Сегмент в кубических</span><span class="sxs-lookup"><span data-stu-id="397dd-159">Cubic segment</span></span>

<span data-ttu-id="397dd-160">Время для сегмента в кубических задается с помощью полинома в кубических отрезков.</span><span class="sxs-lookup"><span data-stu-id="397dd-160">The timing of a cubic segment is defined by a cubic polynomial.</span></span> <span data-ttu-id="397dd-161">Для заданного входного значения времени (*t*) выходное значение присваивается следующим уравнением:</span><span class="sxs-lookup"><span data-stu-id="397dd-161">For a given time input (*t*), the output value is given by the following equation:</span></span>

<span data-ttu-id="397dd-162">*x*(*t*) = *в*³ + *BT*² + *CT*  +  *d*</span><span class="sxs-lookup"><span data-stu-id="397dd-162">*x*(*t*) = *at*³ + *bt*² + *ct* + *d*</span></span>

<span data-ttu-id="397dd-163">На следующей диаграмме показана функция анимации, которая содержит два сегмента в кубических кривых.</span><span class="sxs-lookup"><span data-stu-id="397dd-163">The following diagram shows an animation function that contains of two cubic segments.</span></span> <span data-ttu-id="397dd-164">Первый сегмент переводит значение от 0 до 16 в течение 4 секунд, а второй изменяет значение линейно с 16 на 0 в течение следующих 4 секунд.</span><span class="sxs-lookup"><span data-stu-id="397dd-164">The first segment transitions a value from 0 to 16 over 4 seconds, and the second changes the value linearly from 16 to 0 over the next 4 seconds.</span></span> <span data-ttu-id="397dd-165">Первый переход выполняется по этому полиному в кубических:</span><span class="sxs-lookup"><span data-stu-id="397dd-165">The first transition occurs along this cubic polynomial:</span></span>

<span data-ttu-id="397dd-166">*x*(*t*) = *t*³-6 *t*² + 12 *t*</span><span class="sxs-lookup"><span data-stu-id="397dd-166">*x*(*t*) = *t*³ - 6 *t*² + 12 *t*</span></span>

<span data-ttu-id="397dd-167">второй переход выполняется по этому пути:</span><span class="sxs-lookup"><span data-stu-id="397dd-167">and the second transition occurs along this one:</span></span>

<span data-ttu-id="397dd-168">*x*(*t*) =-4 *t* + 16</span><span class="sxs-lookup"><span data-stu-id="397dd-168">*x*(*t*) = - 4 *t* + 16</span></span>

![Схема функции анимации с двумя сегментами третьего порядка](images/cubicsegment.png)

<span data-ttu-id="397dd-170">Сегмент третьего порядка добавляется в функцию анимации с помощью метода [**идкомпоситионаниматион:: аддкубик**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-addcubic) .</span><span class="sxs-lookup"><span data-stu-id="397dd-170">You add a cubic segment to an animation function by using the [**IDCompositionAnimation::AddCubic**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-addcubic) method.</span></span>

### <a name="sinusoidal-segment"></a><span data-ttu-id="397dd-171">Сегмент синусоидальной</span><span class="sxs-lookup"><span data-stu-id="397dd-171">Sinusoidal segment</span></span>

<span data-ttu-id="397dd-172">Время сегмента синусоидальной определяется следующим уравнением:</span><span class="sxs-lookup"><span data-stu-id="397dd-172">The timing of a sinusoidal segment is defined by the following equation:</span></span>

<span data-ttu-id="397dd-173">*x*(*t* *) =*  +  *амплитуда* \* -sin (*t* \* *Частота* \* 2 \* Pi + 1 \* )</span><span class="sxs-lookup"><span data-stu-id="397dd-173">*x*(*t*) = *Bias* + *Amplitude* \* sin(*t*\**Frequency*\*2\*PI + *Phase*\*PI/180.0)</span></span>

<span data-ttu-id="397dd-174">Вы добавляете сегмент синусоидальной в функцию анимации с помощью метода [**идкомпоситионаниматион:: аддсинусоидал**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-addsinusoidal) .</span><span class="sxs-lookup"><span data-stu-id="397dd-174">You add a sinusoidal segment to an animation function by using the [**IDCompositionAnimation::AddSinusoidal**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-addsinusoidal) method.</span></span>

### <a name="repeat-segment"></a><span data-ttu-id="397dd-175">Повторить сегмент</span><span class="sxs-lookup"><span data-stu-id="397dd-175">Repeat segment</span></span>

<span data-ttu-id="397dd-176">Повторяющийся сегмент повторяет указанную предыдущую часть функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-176">A repeat segment repeats a specified preceding portion of an animation function.</span></span> <span data-ttu-id="397dd-177">Повторяющийся сегмент заставляет указанную часть функции анимации пройти бессрочно до тех пор, пока не встретится следующий сегмент или не достигнет указанного конца анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-177">A repeat segment causes the specified portion of the animation function to loop indefinitely until the next segment is encountered or the specified end of the animation is reached.</span></span> <span data-ttu-id="397dd-178">Предыдущая часть анимации состоит из других сегментов, включая другие повторяющиеся сегменты.</span><span class="sxs-lookup"><span data-stu-id="397dd-178">The preceding portion of an animation is made of other segments, including other repeat segments.</span></span> <span data-ttu-id="397dd-179">Сегмент Repeat нельзя использовать в качестве первого сегмента в функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-179">A repeat segment cannot be used as the first segment in an animation function.</span></span>

<span data-ttu-id="397dd-180">На следующей схеме показана функция анимации, состоящая из двух сегментов третьего порядка в 4 секунды, за которыми следует сегмент повторения, продолжительность которого составляет 12 секунд.</span><span class="sxs-lookup"><span data-stu-id="397dd-180">The following diagram shows an animation function that consists two cubic segments of 4 seconds duration each, followed by a repeat segment that lasts 12 seconds.</span></span> <span data-ttu-id="397dd-181">Сегмент Repeat начинает 8 секунд в анимацию и повторяет предыдущие 6 секунд анимации два раза, пока конечный сегмент не достигнет 20 секунд.</span><span class="sxs-lookup"><span data-stu-id="397dd-181">The repeat segment begins 8 seconds into the animation and repeats the previous 6 seconds of the animation two times until the end segment is reached at 20 seconds.</span></span>

![Схема функции анимации, которая содержит два сегмента в кубических и один повторяющийся сегмент](images/repeatsegment.png)

<span data-ttu-id="397dd-183">Чтобы добавить повторяющийся сегмент в функцию анимации, используйте метод [**идкомпоситионаниматион:: аддрепеат**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-addrepeat) .</span><span class="sxs-lookup"><span data-stu-id="397dd-183">To add a repeat segment to an animation function, use the [**IDCompositionAnimation::AddRepeat**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-addrepeat) method.</span></span>

### <a name="end-segment"></a><span data-ttu-id="397dd-184">Конечный сегмент</span><span class="sxs-lookup"><span data-stu-id="397dd-184">End segment</span></span>

<span data-ttu-id="397dd-185">После создания функции анимации из сегментов можно добавить конечный сегмент, чтобы функция анимации закончится в определенное время.</span><span class="sxs-lookup"><span data-stu-id="397dd-185">After constructing an animation function from segments, you can append an end segment to cause the animation function to end at a particular time.</span></span> <span data-ttu-id="397dd-186">Если не добавить конечный сегмент, последний сегмент функции анимации будет выполняться неограниченное время.</span><span class="sxs-lookup"><span data-stu-id="397dd-186">If you do not append an end segment, the final segment of the animation function runs indefinitely.</span></span>

<span data-ttu-id="397dd-187">Чтобы добавить конечный сегмент, вызовите метод [**идкомпоситионаниматион:: end**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-end) , указав смещение от начала функции анимации, которое указывает на конечную точку функции.</span><span class="sxs-lookup"><span data-stu-id="397dd-187">You append an end segment by calling the [**IDCompositionAnimation::End**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-end) method, specifying an offset from the beginning of the animation function which indicates the function's end point.</span></span> <span data-ttu-id="397dd-188">Смещение должно быть больше начального смещения предыдущего сегмента.</span><span class="sxs-lookup"><span data-stu-id="397dd-188">The offset must be greater than the beginning offset of the preceding segment.</span></span> <span data-ttu-id="397dd-189">Кроме того, конечный сегмент нельзя использовать в качестве первого примитива в функции анимации.</span><span class="sxs-lookup"><span data-stu-id="397dd-189">Also, an end segment cannot be used as the first primitive in an animation function.</span></span>

<span data-ttu-id="397dd-190">При вызове [**End**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-end)вы также указываете конечное значение анимируемого свойства.</span><span class="sxs-lookup"><span data-stu-id="397dd-190">When you call [**End**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-end), you also specify a final value for the property being animated.</span></span> <span data-ttu-id="397dd-191">В момент достижения конечной точки функции анимации в свойстве задается указанное итоговое значение.</span><span class="sxs-lookup"><span data-stu-id="397dd-191">The property is set to the specified final value at the moment when the end point of the animation function is reached.</span></span>

<span data-ttu-id="397dd-192">После добавления конечного сегмента к функции анимации нельзя добавить другие сегменты.</span><span class="sxs-lookup"><span data-stu-id="397dd-192">After appending an end segment, you cannot append any other segments to the animation function.</span></span> <span data-ttu-id="397dd-193">Это значит, что все вызовы методов для объекта анимации завершаются ошибкой, за исключением [**идкомпоситионаниматион:: Reset**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-reset).</span><span class="sxs-lookup"><span data-stu-id="397dd-193">That is, all method calls on the animation object fail except [**IDCompositionAnimation::Reset**](/windows/desktop/api/DcompAnimation/nf-dcompanimation-idcompositionanimation-reset).</span></span> <span data-ttu-id="397dd-194">Вызов **Reset** возвращает объект анимации, чтобы очистить состояние, в котором функция анимации не содержит сегментов, после чего можно снова добавить сегменты.</span><span class="sxs-lookup"><span data-stu-id="397dd-194">Calling **Reset** returns the animation object to clean state in which the animation function contains no segments, at which point you can once again add segments.</span></span>

## <a name="compatibility-with-windows-animation-manager"></a><span data-ttu-id="397dd-195">Совместимость с диспетчером анимации Windows</span><span class="sxs-lookup"><span data-stu-id="397dd-195">Compatibility with Windows Animation Manager</span></span>

<span data-ttu-id="397dd-196">Диспетчер анимации Windows (Windows Animation) выводит примитивы анимации в формате, совместимом с API DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="397dd-196">Windows Animation Manager (Windows Animation) outputs animation primitives in a format that is compatible with the DirectComposition API.</span></span> <span data-ttu-id="397dd-197">Это означает, что DirectComposition может создавать анимации на основе примитивов анимации, созданных анимацией Windows.</span><span class="sxs-lookup"><span data-stu-id="397dd-197">This means that DirectComposition can create animations based on animation primitives created by Windows Animation.</span></span>

<span data-ttu-id="397dd-198">Дополнительные сведения см. в статьях [диспетчер анимации Windows](/windows/desktop/UIAnimation/-main-portal), метод [**IUIAnimationVariable2:: скачок**](/windows/desktop/api/uianimation/nf-uianimation-iuianimationvariable2-getcurve) и [Управление анимацией DirectComposition с помощью диспетчера анимации Windows версии 2](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/DirectCompositionWindowsAnimationManager).</span><span class="sxs-lookup"><span data-stu-id="397dd-198">For more information, see [Windows Animation Manager](/windows/desktop/UIAnimation/-main-portal), the [**IUIAnimationVariable2::GetCurve**](/windows/desktop/api/uianimation/nf-uianimation-iuianimationvariable2-getcurve) method, and [Managing DirectComposition Animation with Windows Animation Manager v2](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/DirectCompositionWindowsAnimationManager).</span></span>

## <a name="related-topics"></a><span data-ttu-id="397dd-199">См. также</span><span class="sxs-lookup"><span data-stu-id="397dd-199">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="397dd-200">Основные понятия DirectComposition</span><span class="sxs-lookup"><span data-stu-id="397dd-200">DirectComposition Concepts</span></span>](directcomposition-concepts.md)
</dt> </dl>

 

 
