---
description: Предоставляет механизм управления доступом к защищаемым объектам.
ms.assetid: 5923cb4c-f663-40d2-989a-07d71ac475db
title: контроль целостности учетных данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c184ba01da0a55309fcb27ace9b0fe156edd6425
ms.sourcegitcommit: 4570ac533e129ff88b23f2c2b69e0140ead3a4a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2021
ms.locfileid: "105652300"
---
# <a name="mandatory-integrity-control"></a><span data-ttu-id="1f923-103">контроль целостности учетных данных</span><span class="sxs-lookup"><span data-stu-id="1f923-103">Mandatory Integrity Control</span></span>

<span data-ttu-id="1f923-104">Контроль целостности учетных данных (MIC) предоставляет механизм управления доступом к защищаемым объектам.</span><span class="sxs-lookup"><span data-stu-id="1f923-104">Mandatory Integrity Control (MIC) provides a mechanism for controlling access to securable objects.</span></span> <span data-ttu-id="1f923-105">Этот механизм является дополнением к контролю доступа на уровне пользователей и оценивает доступ до проверки доступа к [*списку управления доступом на уровне пользователей*](/windows/desktop/SecGloss/d-gly) (DACL) объекта.</span><span class="sxs-lookup"><span data-stu-id="1f923-105">This mechanism is in addition to discretionary access control and evaluates access before access checks against an object's [*discretionary access control list*](/windows/desktop/SecGloss/d-gly) (DACL) are evaluated.</span></span>

<span data-ttu-id="1f923-106">Для вычисления доступа MIC использует уровни целостности и обязательную политику.</span><span class="sxs-lookup"><span data-stu-id="1f923-106">MIC uses integrity levels and mandatory policy to evaluate access.</span></span> <span data-ttu-id="1f923-107">[*Субъектам безопасности*](/windows/desktop/SecGloss/s-gly) и защищаемым объектам назначаются уровни целостности, определяющие их уровни защиты или доступа.</span><span class="sxs-lookup"><span data-stu-id="1f923-107">[*Security principals*](/windows/desktop/SecGloss/s-gly) and securable objects are assigned integrity levels that determine their levels of protection or access.</span></span> <span data-ttu-id="1f923-108">Например, участник с низким уровнем целостности не может записывать в объект с уровнем целостности Medium, даже если DACL этого объекта допускает доступ на запись к участнику.</span><span class="sxs-lookup"><span data-stu-id="1f923-108">For example, a principal with a low integrity level cannot write to an object with a medium integrity level, even if that object's DACL allows write access to the principal.</span></span>

<span data-ttu-id="1f923-109">Windows определяет четыре уровня целостности: низкая, средняя, высокая и система.</span><span class="sxs-lookup"><span data-stu-id="1f923-109">Windows defines four integrity levels: low, medium, high, and system.</span></span> <span data-ttu-id="1f923-110">Обычные пользователи получают доступ к среднему уровню, а пользователи с повышенными правами получают высокий уровень.</span><span class="sxs-lookup"><span data-stu-id="1f923-110">Standard users receive medium, elevated users receive high.</span></span> <span data-ttu-id="1f923-111">Запущенные процессы и созданные объекты получают уровень целостности (средний или высокий) или низкий, если уровень исполняемого файла низкий; Системные службы получают целостность системы.</span><span class="sxs-lookup"><span data-stu-id="1f923-111">Processes you start and objects you create receive your integrity level (medium or high) or low if the executable file's level is low; system services receive system integrity.</span></span> <span data-ttu-id="1f923-112">Объекты, для которых отсутствует метка целостности, обрабатываются операционной системой как средняя; Это предотвращает изменение непомеченных объектов кодом с низким уровнем целостности.</span><span class="sxs-lookup"><span data-stu-id="1f923-112">Objects that lack an integrity label are treated as medium by the operating system; this prevents low-integrity code from modifying unlabeled objects.</span></span> <span data-ttu-id="1f923-113">Кроме того, Windows гарантирует, что процессы, работающие с низким уровнем целостности, не смогут получить доступ к процессу, связанному с контейнером приложения.</span><span class="sxs-lookup"><span data-stu-id="1f923-113">Additionally, Windows ensures that processes running with a low integrity level cannot obtain access to a process which is associated with an app container.</span></span>

## <a name="integrity-labels"></a><span data-ttu-id="1f923-114">Метки целостности</span><span class="sxs-lookup"><span data-stu-id="1f923-114">Integrity Labels</span></span>

<span data-ttu-id="1f923-115">Метки целостности определяют уровни целостности защищаемых объектов и субъектов безопасности.</span><span class="sxs-lookup"><span data-stu-id="1f923-115">Integrity labels specify the integrity levels of securable objects and security principals.</span></span> <span data-ttu-id="1f923-116">Метки целостности представлены [*идентификаторами безопасности целостности*](/windows/desktop/SecGloss/i-gly).</span><span class="sxs-lookup"><span data-stu-id="1f923-116">Integrity labels are represented by [*integrity SIDs*](/windows/desktop/SecGloss/i-gly).</span></span> <span data-ttu-id="1f923-117">SID целостности для защищаемого объекта хранится в [*системном списке управления доступом*](/windows/desktop/SecGloss/s-gly) (SACL).</span><span class="sxs-lookup"><span data-stu-id="1f923-117">The integrity SID for a securable object is stored in its [*system access control list*](/windows/desktop/SecGloss/s-gly) (SACL).</span></span> <span data-ttu-id="1f923-118">Список SACL содержит обязательную системную [*запись управления доступом*](/windows/desktop/SecGloss/a-gly) [**\_ \_ \_ ACE**](/windows/desktop/api/Winnt/ns-winnt-system_mandatory_label_ace) (ACE), которая, в свою очередь, содержит SID целостности.</span><span class="sxs-lookup"><span data-stu-id="1f923-118">The SACL contains a [**SYSTEM\_MANDATORY\_LABEL\_ACE**](/windows/desktop/api/Winnt/ns-winnt-system_mandatory_label_ace) [*access control entry*](/windows/desktop/SecGloss/a-gly) (ACE) that in turn contains the integrity SID.</span></span> <span data-ttu-id="1f923-119">Любой объект без идентификатора безопасности целостности обрабатывается так, как если бы он имел среднюю целостность.</span><span class="sxs-lookup"><span data-stu-id="1f923-119">Any object without an integrity SID is treated as if it had medium integrity.</span></span>

<span data-ttu-id="1f923-120">SID целостности для субъекта безопасности хранится в его маркере доступа.</span><span class="sxs-lookup"><span data-stu-id="1f923-120">The integrity SID for a security principal is stored in its access token.</span></span> <span data-ttu-id="1f923-121">Маркер доступа может содержать один или несколько SID целостности.</span><span class="sxs-lookup"><span data-stu-id="1f923-121">An access token may contain one or more integrity SIDs.</span></span>

<span data-ttu-id="1f923-122">Подробные сведения об определенных идентификаторах безопасности см. в разделе [известные идентификаторы](well-known-sids.md)безопасности.</span><span class="sxs-lookup"><span data-stu-id="1f923-122">For detailed information about the defined integrity SIDs, see [Well-known SIDs](well-known-sids.md).</span></span>

## <a name="process-creation"></a><span data-ttu-id="1f923-123">Создание процесса</span><span class="sxs-lookup"><span data-stu-id="1f923-123">Process Creation</span></span>

<span data-ttu-id="1f923-124">Когда пользователь пытается запустить исполняемый файл, новый процесс создается с минимальным уровнем целостности пользователя и уровнем целостности файла.</span><span class="sxs-lookup"><span data-stu-id="1f923-124">When a user attempts to launch an executable file, the new process is created with the minimum of the user integrity level and the file integrity level.</span></span> <span data-ttu-id="1f923-125">Это означает, что новый процесс никогда не будет выполняться с более высокой целостностью, чем исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="1f923-125">This means that the new process will never execute with higher integrity than the executable file.</span></span> <span data-ttu-id="1f923-126">Если пользователь с правами администратора выполняет программу низкой целостности, маркер для нового процесса работает с низким уровнем целостности.</span><span class="sxs-lookup"><span data-stu-id="1f923-126">If the administrator user executes a low integrity program, the token for the new process functions with the low integrity level.</span></span> <span data-ttu-id="1f923-127">Это помогает защитить пользователя, запускающего ненадежный код от вредоносных действий, выполняемых этим кодом.</span><span class="sxs-lookup"><span data-stu-id="1f923-127">This helps protect a user who launches untrustworthy code from malicious acts performed by that code.</span></span> <span data-ttu-id="1f923-128">Данные пользователя, которые являются обычным уровнем целостности пользователя, защищаются от записи к этому новому процессу.</span><span class="sxs-lookup"><span data-stu-id="1f923-128">The user data, which is at the typical user integrity level, is write-protected against this new process.</span></span>

## <a name="mandatory-policy"></a><span data-ttu-id="1f923-129">Обязательная политика</span><span class="sxs-lookup"><span data-stu-id="1f923-129">Mandatory Policy</span></span>

<span data-ttu-id="1f923-130">Элемент ACE ACE " [**\_ обязательная \_ \_ система**](/windows/desktop/api/Winnt/ns-winnt-system_mandatory_label_ace) " в списке SACL защищаемого объекта содержит маску доступа, которая задает доступ для участников с уровнем целостности ниже, чем у объекта.</span><span class="sxs-lookup"><span data-stu-id="1f923-130">The [**SYSTEM\_MANDATORY\_LABEL\_ACE**](/windows/desktop/api/Winnt/ns-winnt-system_mandatory_label_ace) ACE in the SACL of a securable object contains an access mask that specifies the access that principals with integrity levels lower than the object are granted.</span></span> <span data-ttu-id="1f923-131">Значения, определенные для этой маски доступа, **являются \_ обязательной системной \_ меткой " \_ нет \_ записи \_**", " **системная \_ обязательная \_ метка \_ не \_ читается \_**" и " **системная \_ обязательная \_ метка \_ не \_ выполняется \_**".</span><span class="sxs-lookup"><span data-stu-id="1f923-131">The values defined for this access mask are **SYSTEM\_MANDATORY\_LABEL\_NO\_WRITE\_UP**, **SYSTEM\_MANDATORY\_LABEL\_NO\_READ\_UP**, and **SYSTEM\_MANDATORY\_LABEL\_NO\_EXECUTE\_UP**.</span></span> <span data-ttu-id="1f923-132">По умолчанию система создает каждый объект с маской доступа к **системной \_ обязательной \_ метке \_ без \_ записи \_**.</span><span class="sxs-lookup"><span data-stu-id="1f923-132">By default, the system creates every object with an access mask of **SYSTEM\_MANDATORY\_LABEL\_NO\_WRITE\_UP**.</span></span>

<span data-ttu-id="1f923-133">Каждый маркер доступа также указывает обязательную политику, которая задается [*локальным администратором безопасности*](/windows/desktop/SecGloss/l-gly) (LSA) при создании маркера.</span><span class="sxs-lookup"><span data-stu-id="1f923-133">Every access token also specifies a mandatory policy that is set by the [*Local Security Authority*](/windows/desktop/SecGloss/l-gly) (LSA) when the token is created.</span></span> <span data-ttu-id="1f923-134">Эта политика указывается с помощью [**\_ обязательной структуры \_ политики маркера**](/windows/desktop/api/Winnt/ns-winnt-token_mandatory_policy) , связанной с токеном.</span><span class="sxs-lookup"><span data-stu-id="1f923-134">This policy is specified by a [**TOKEN\_MANDATORY\_POLICY**](/windows/desktop/api/Winnt/ns-winnt-token_mandatory_policy) structure associated with the token.</span></span> <span data-ttu-id="1f923-135">Эту структуру можно запросить, вызвав функцию [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) со значением параметра *токенинформатионкласс* , равным **токенмандаториполици**.</span><span class="sxs-lookup"><span data-stu-id="1f923-135">This structure can be queried by calling the [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) function with the value of the *TokenInformationClass* parameter set to **TokenMandatoryPolicy**.</span></span>

 

 
