---
description: Windows поддерживает набор функций, которые создают список управления доступом (ACL) или изменяют записи контроля доступа (ACE) в существующем списке управления доступом.
ms.assetid: 71301aab-1040-4f61-855f-2b891c8b6077
title: Создание или изменение списка управления доступом
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a0deb72bcd1a1c805dd8524027601952dda0eac1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103898014"
---
# <a name="creating-or-modifying-an-acl"></a><span data-ttu-id="5c148-103">Создание или изменение списка управления доступом</span><span class="sxs-lookup"><span data-stu-id="5c148-103">Creating or Modifying an ACL</span></span>

<span data-ttu-id="5c148-104">Windows поддерживает набор функций, которые создают [*список управления доступом*](/windows/desktop/SecGloss/a-gly) (ACL) или изменяют [*записи контроля доступа*](/windows/desktop/SecGloss/a-gly) (ACE) в существующем списке управления доступом.</span><span class="sxs-lookup"><span data-stu-id="5c148-104">Windows supports a set of functions that create an [*access control list*](/windows/desktop/SecGloss/a-gly) (ACL) or modify the [*access control entries*](/windows/desktop/SecGloss/a-gly) (ACEs) in an existing ACL.</span></span>

<span data-ttu-id="5c148-105">Функция [**сетентриесинакл**](/windows/desktop/api/Aclapi/nf-aclapi-setentriesinacla) создает новый список ACL.</span><span class="sxs-lookup"><span data-stu-id="5c148-105">The [**SetEntriesInAcl**](/windows/desktop/api/Aclapi/nf-aclapi-setentriesinacla) function creates a new ACL.</span></span> <span data-ttu-id="5c148-106">**Сетентриесинакл** может указать совершенно новый набор записей ACE для ACL или выполнить слияние одного или нескольких новых записей ACE с элементами управления доступом существующего списка ACL.</span><span class="sxs-lookup"><span data-stu-id="5c148-106">**SetEntriesInAcl** can specify a completely new set of ACEs for the ACL, or it can merge one or more new ACEs with the ACEs of an existing ACL.</span></span> <span data-ttu-id="5c148-107">Функция **сетентриесинакл** использует массив [**явных структур \_ доступа**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) для указания сведений для новых записей ACE.</span><span class="sxs-lookup"><span data-stu-id="5c148-107">The **SetEntriesInAcl** function uses an array of [**EXPLICIT\_ACCESS**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) structures to specify the information for the new ACEs.</span></span> <span data-ttu-id="5c148-108">Каждая **явная структура \_ доступа** содержит сведения, описывающие один элемент управления доступом.</span><span class="sxs-lookup"><span data-stu-id="5c148-108">Each **EXPLICIT\_ACCESS** structure contains information that describes a single ACE.</span></span> <span data-ttu-id="5c148-109">Эти сведения включают права доступа, Тип ACE, флаги, управляющие наследованием ACE, и структуру [**доверенного лица**](/windows/desktop/api/AccCtrl/ns-accctrl-trustee_a) , определяющую доверенное лицо.</span><span class="sxs-lookup"><span data-stu-id="5c148-109">This information includes the access rights, the type of ACE, the flags that control ACE inheritance, and a [**TRUSTEE**](/windows/desktop/api/AccCtrl/ns-accctrl-trustee_a) structure that identifies the trustee.</span></span>

<span data-ttu-id="5c148-110">**Добавление нового элемента управления доступом в существующий список управления доступом**</span><span class="sxs-lookup"><span data-stu-id="5c148-110">**To add a new ACE to an existing ACL**</span></span>

1.  <span data-ttu-id="5c148-111">Используйте функцию [**жетсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-getsecurityinfo) или [**жетнамедсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-getnamedsecurityinfoa) , чтобы получить существующий список DACL или список SACL из [*дескриптора безопасности*](/windows/desktop/SecGloss/s-gly)объекта.</span><span class="sxs-lookup"><span data-stu-id="5c148-111">Use the [**GetSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-getsecurityinfo) or [**GetNamedSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-getnamedsecurityinfoa) function to get the existing DACL or SACL from an object's [*security descriptor*](/windows/desktop/SecGloss/s-gly).</span></span>
2.  <span data-ttu-id="5c148-112">Для каждого нового элемента управления доступом вызовите функцию [**буилдексплиЦитакцессвиснаме**](/windows/desktop/api/Aclapi/nf-aclapi-buildexplicitaccesswithnamea) для заполнения [**явной структуры \_ доступа**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) сведениями, описывающими элемент управления доступом.</span><span class="sxs-lookup"><span data-stu-id="5c148-112">For each new ACE, call the [**BuildExplicitAccessWithName**](/windows/desktop/api/Aclapi/nf-aclapi-buildexplicitaccesswithnamea) function to fill an [**EXPLICIT\_ACCESS**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) structure with the information that describes the ACE.</span></span>
3.  <span data-ttu-id="5c148-113">Вызовите [**сетентриесинакл**](/windows/desktop/api/Aclapi/nf-aclapi-setentriesinacla), указав существующий список ACL и массив [**явных структур \_ доступа**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) для новых записей ACE.</span><span class="sxs-lookup"><span data-stu-id="5c148-113">Call [**SetEntriesInAcl**](/windows/desktop/api/Aclapi/nf-aclapi-setentriesinacla), specifying the existing ACL and an array of [**EXPLICIT\_ACCESS**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) structures for the new ACEs.</span></span> <span data-ttu-id="5c148-114">Функция **сетентриесинакл** выделяет и инициализирует список управления доступом и его записи ACE.</span><span class="sxs-lookup"><span data-stu-id="5c148-114">The **SetEntriesInAcl** function allocates and initializes the ACL and its ACEs.</span></span>
4.  <span data-ttu-id="5c148-115">Вызовите функцию [**сетсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-setsecurityinfo) или [**сетнамедсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-setnamedsecurityinfoa) , чтобы присоединить новый список ACL к дескриптору безопасности объекта.</span><span class="sxs-lookup"><span data-stu-id="5c148-115">Call the [**SetSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-setsecurityinfo) or [**SetNamedSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-setnamedsecurityinfoa) function to attach the new ACL to the object's security descriptor.</span></span>

<span data-ttu-id="5c148-116">Если вызывающий объект указывает существующий список ACL, [**сетентриесинакл**](/windows/desktop/api/Aclapi/nf-aclapi-setentriesinacla) объединяет новые данные ACE с существующими элементами ACE в списке управления доступом.</span><span class="sxs-lookup"><span data-stu-id="5c148-116">If the caller specifies an existing ACL, [**SetEntriesInAcl**](/windows/desktop/api/Aclapi/nf-aclapi-setentriesinacla) merges the new ACE information with the existing ACEs in the ACL.</span></span> <span data-ttu-id="5c148-117">Рассмотрим случай, например, если существующий список ACL предоставляет доступ к указанному доверенному лицу, а [**явная структура \_ доступа**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) запрещает доступ к тому же доверенному лицу.</span><span class="sxs-lookup"><span data-stu-id="5c148-117">Consider the case, for example, in which the existing ACL grants access to a specified trustee and an [**EXPLICIT\_ACCESS**](/windows/desktop/api/AccCtrl/ns-accctrl-explicit_access_a) structure denies access to the same trustee.</span></span> <span data-ttu-id="5c148-118">В этом случае **сетентриесинакл** добавляет новый ACE запрещения доступа для доверенного лица и удаляет или изменяет существующий ACE, разрешенный доступом к доверенному лицу.</span><span class="sxs-lookup"><span data-stu-id="5c148-118">In this case, **SetEntriesInAcl** adds a new access-denied ACE for the trustee and deletes or modifies the existing access-allowed ACE for the trustee.</span></span>

<span data-ttu-id="5c148-119">Пример кода, который объединяет новый элемент управления доступом в существующий список управления доступом, см. [в разделе изменение списков управления доступом для объекта в C++](modifying-the-acls-of-an-object-in-c--.md).</span><span class="sxs-lookup"><span data-stu-id="5c148-119">For sample code that merges a new ACE into an existing ACL, see [Modifying the ACLs of an Object in C++](modifying-the-acls-of-an-object-in-c--.md).</span></span>

 

 
