---
description: Приложение делится на две программы. Одна из программ запускается от имени обычного пользователя, а другая запускается с правами администратора.
ms.assetid: 1e661915-5797-421d-b96f-72949f441aba
title: Модель брокера администратора
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5299d35c995fb56f969fc5983864cfc93b25b6c7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103910616"
---
# <a name="administrator-broker-model"></a>Модель брокера администратора

В модели брокера администратора приложение делится на две программы. Одна из программ запускается от имени обычного пользователя, а другая запускается с правами администратора.

С помощью манифеста приложения пометьте стандартную пользовательскую программу **RequestedExecutionLevel** **asInvoker** и пометьте административную программу на **requestedExecutionLevel** **requireAdministrator**. Сначала пользователь запускает стандартную пользовательскую программу. Когда пользователь пытается выполнить операцию, для которой требуется полный маркер доступа администратора, Стандартная пользовательская программа вызывает функцию [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) для запуска программы администрирования. Функция **ShellExecute** запрашивает у пользователя утверждение перед запуском приложения с полным маркером доступа администратора пользователя. Программа администрирования может выполнять задачи, требующие прав администратора.

Административная программа не полностью изолирована от стандартной пользовательской программы. Административная программа может включить взаимодействие между процессами с помощью стандартной программы пользователя. Однако такое взаимодействие ограничивается обязательной политикой целостности по умолчанию. Сведения о обязательных особенностях целостности см. в разделе [Разработка приложений для запуска с низким уровнем целостности](/previous-versions/dotnet/articles/bb625960(v=msdn.10)).

Ниже приведены возможные варианты использования модели брокера администратора.

-   Разработка мастеров. Если мастер оборудования определит, что необходимый драйвер не установлен на компьютере или расположен в утвержденном расположении предприятия, он вызывает приложение с повышенными правами, позволяющее переместить драйвер в хранилище компьютера.
-   Autorun.exe вызова Setup.exe. Когда пользователь запускает программное обеспечение с компакт-диска, Autorun.exe, который запускается от имени обычного пользователя, запускает Setup.exe, который запускается от имени администратора, для установки программного обеспечения на компьютер.

Ниже перечислены недостатки использования модели брокера администратора.

-   Переход от приложения к приложению может быть непонятен пользователю. Сообщить пользователю о том, почему на мониторе появляется новое приложение, может быть трудно.
-   Передача сведений о состоянии между двумя приложениями может быть затруднена. Например, эта модель не будет использоваться для передачи сведений о состоянии между стандартной панелью управления (CPL) и ее аналогом администратора просто для того, чтобы позволить тому же CPL использовать функции администрирования и обычного пользователя. Стандартная пользовательская CPL должна хранить свое состояние в каком-то месте.
-   При разделении функциональных возможностей между двумя программами может быть много реплицируемого кода.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Разработка приложений, требующих прав администратора](developing-applications-that-require-administrator-privilege.md)
</dt> <dt>

[Модель COM-объектов администратора](administrator-com-object-model.md)
</dt> <dt>

[Модель службы операционной системы](operating-system-service-model.md)
</dt> <dt>

[Модель задач с повышенными правами](elevated-task-model.md)
</dt> </dl>

 

 
