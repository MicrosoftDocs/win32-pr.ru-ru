---
description: Функции Сетнамедсекуритинфо и Сетсекуритинфо поддерживают автоматическое распространение наследуемых записей контроля доступа (ACE).
ms.assetid: 0aa49b9b-13e3-4ef9-921d-ea47a013e5a1
title: Автоматическое распространение наследуемых ACE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8fab03c73a1c926468e46a0d0492e512dab42af6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104273096"
---
# <a name="automatic-propagation-of-inheritable-aces"></a><span data-ttu-id="7e331-103">Автоматическое распространение наследуемых ACE</span><span class="sxs-lookup"><span data-stu-id="7e331-103">Automatic Propagation of Inheritable ACEs</span></span>

<span data-ttu-id="7e331-104">Функции [**сетнамедсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-setnamedsecurityinfoa) и [**сетсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-setsecurityinfo) поддерживают автоматическое распространение наследуемых [*записей контроля доступа*](/windows/desktop/SecGloss/a-gly) (ACE).</span><span class="sxs-lookup"><span data-stu-id="7e331-104">The [**SetNamedSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-setnamedsecurityinfoa) and [**SetSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-setsecurityinfo) functions support automatic propagation of inheritable [*access control entries*](/windows/desktop/SecGloss/a-gly) (ACEs).</span></span> <span data-ttu-id="7e331-105">Например, при использовании этих функций для добавления наследуемого ACE в каталог в файловой системе NTFS система применяет ACE в соответствии с [*списками управления доступом*](/windows/desktop/SecGloss/a-gly) (ACL) всех существующих подкаталогов или файлов.</span><span class="sxs-lookup"><span data-stu-id="7e331-105">For example, if you use these functions to add an inheritable ACE to a directory in an NTFS, the system applies the ACE as appropriate to the [*access control lists*](/windows/desktop/SecGloss/a-gly) (ACLs) of any existing subdirectories or files.</span></span>

<span data-ttu-id="7e331-106">Непосредственно примененные ACE имеют приоритет над наследуемыми элементами управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7e331-106">Directly applied ACEs have precedence over inherited ACEs.</span></span> <span data-ttu-id="7e331-107">Система реализует этот приоритет, помещая непосредственно примененные ACE прямо из наследуемых ACE в [*избирательный список управления доступом*](/windows/desktop/SecGloss/d-gly) (DACL).</span><span class="sxs-lookup"><span data-stu-id="7e331-107">The system implements this precedence by placing directly applied ACEs ahead of inherited ACEs in a [*discretionary access control list*](/windows/desktop/SecGloss/d-gly) (DACL).</span></span> <span data-ttu-id="7e331-108">При вызове функций [**сетнамедсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-setnamedsecurityinfoa) и [**сетсекуритинфо**](/windows/desktop/api/Aclapi/nf-aclapi-setsecurityinfo) для задания сведений о безопасности объекта система накладывает текущую модель наследования на списки ACL всех объектов в иерархии под целевым объектом.</span><span class="sxs-lookup"><span data-stu-id="7e331-108">When you call the [**SetNamedSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-setnamedsecurityinfoa) and [**SetSecurityInfo**](/windows/desktop/api/Aclapi/nf-aclapi-setsecurityinfo) functions to set the security information of an object, the system imposes the current inheritance model on the ACLs of all objects in the hierarchy below the target object.</span></span> <span data-ttu-id="7e331-109">Для объектов, которые были преобразованы в текущую модель наследования, в \_ \_ \_ \_ \_ \_ поле Control [*дескриптора безопасности*](/windows/desktop/SecGloss/s-gly) объекта задаются автоматические унаследованные биты набора DACL (SE) и разрешения SE SACL.</span><span class="sxs-lookup"><span data-stu-id="7e331-109">For objects that have been converted to the current inheritance model, the SE\_DACL\_AUTO\_INHERITED and SE\_SACL\_AUTO\_INHERITED bits are set in the control field of the [*security descriptor*](/windows/desktop/SecGloss/s-gly) of the object.</span></span>

<span data-ttu-id="7e331-110">При создании нового дескриптора безопасности, отражающего текущую модель наследования, не изменяется семантика дескриптора безопасности.</span><span class="sxs-lookup"><span data-stu-id="7e331-110">When you build a new security descriptor that reflects the current inheritance model, care is taken not to change the semantics of the security descriptor.</span></span> <span data-ttu-id="7e331-111">Таким образом, разрешение и отклонение Ace никогда не перемещается по отношению друг к другу.</span><span class="sxs-lookup"><span data-stu-id="7e331-111">As such, allow and deny ACEs are never moved in relation to one another.</span></span> <span data-ttu-id="7e331-112">Если требуется такое перемещение (например, для размещения всех неунаследованных ACE в начале списка ACL), список ACL помечается как защищенный, чтобы предотвратить семантическое изменение.</span><span class="sxs-lookup"><span data-stu-id="7e331-112">If such movement is needed (for instance to place all noninherited ACEs at the front of an ACL), the ACL is marked as protected to prevent the semantic change.</span></span>

<span data-ttu-id="7e331-113">При распространении наследуемых ACE на дочерние объекты система использует следующие правила:</span><span class="sxs-lookup"><span data-stu-id="7e331-113">The system uses the following rules when propagating inherited ACEs to child objects:</span></span>

-   <span data-ttu-id="7e331-114">Если дочерний объект без DACL наследует ACE, то результатом является дочерний объект с DACL, который содержит только унаследованный элемент ACE.</span><span class="sxs-lookup"><span data-stu-id="7e331-114">If a child object with no DACL inherits an ACE, the result is a child object with a DACL that contains only the inherited ACE.</span></span>
-   <span data-ttu-id="7e331-115">Если дочерний объект с пустым списком DACL наследует запись ACE, то результатом будет дочерний объект с DACL, который содержит только унаследованный элемент ACE.</span><span class="sxs-lookup"><span data-stu-id="7e331-115">If a child object with an empty DACL inherits an ACE, the result is a child object with a DACL that contains only the inherited ACE.</span></span>
-   <span data-ttu-id="7e331-116">При удалении наследуемого элемента ACE из родительского объекта автоматическое наследование удаляет все копии ACE, унаследованные дочерними объектами.</span><span class="sxs-lookup"><span data-stu-id="7e331-116">If you remove an inheritable ACE from a parent object, automatic inheritance removes any copies of the ACE that were inherited by child objects.</span></span>
-   <span data-ttu-id="7e331-117">Если автоматическое наследование приводит к удалению всех записей ACE из списка DACL дочернего объекта, дочерний объект имеет пустой DACL, а не DACL.</span><span class="sxs-lookup"><span data-stu-id="7e331-117">If automatic inheritance results in the removal of all ACEs from the DACL of a child object, the child object has an empty DACL rather than no DACL.</span></span>

<span data-ttu-id="7e331-118">Эти правила могут привести к непредвиденному результату преобразования объекта без DACL в объект с пустым списком DACL.</span><span class="sxs-lookup"><span data-stu-id="7e331-118">These rules can have the unexpected result of converting an object with no DACL to an object with an empty DACL.</span></span> <span data-ttu-id="7e331-119">Объект без DACL обеспечивает полный доступ, но объект с пустым списком DACL не предоставляет доступа.</span><span class="sxs-lookup"><span data-stu-id="7e331-119">An object with no DACL allows full access, but an object with an empty DACL allows no access.</span></span> <span data-ttu-id="7e331-120">В качестве примера того, как эти правила могут создать пустой список DACL, предположим, что вы добавили наследуемый ACE в корневой объект дерева объектов.</span><span class="sxs-lookup"><span data-stu-id="7e331-120">As an example of how these rules can create an empty DACL, suppose you add an inheritable ACE to the root object of a tree of objects.</span></span> <span data-ttu-id="7e331-121">Автоматическое наследование распространяет наследуемый ACE на все объекты в дереве.</span><span class="sxs-lookup"><span data-stu-id="7e331-121">Automatic inheritance propagates the inheritable ACE to all the objects in the tree.</span></span> <span data-ttu-id="7e331-122">Дочерние объекты, запущенные без DACL, теперь имеют список DACL с унаследованным элементом управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7e331-122">Child objects that started with no DACL now have a DACL with the inherited ACE.</span></span> <span data-ttu-id="7e331-123">При удалении наследуемого ACE из корневого объекта система автоматически распространяет изменения в дочерние объекты.</span><span class="sxs-lookup"><span data-stu-id="7e331-123">If you remove the inheritable ACE from the root object, the system automatically propagates the change to the child objects.</span></span> <span data-ttu-id="7e331-124">Дочерние объекты, запущенные без DACL (разрешение полного доступа), теперь имеют пустой список DACL (без доступа).</span><span class="sxs-lookup"><span data-stu-id="7e331-124">Child objects that started with no DACL (allowing full access) now have an empty DACL (allowing no access).</span></span>

<span data-ttu-id="7e331-125">Чтобы наследуемые ACE не влияли на дочерний объект без DACL, установите \_ \_ флаг защищенного списка DACL SE в дескрипторе безопасности объекта.</span><span class="sxs-lookup"><span data-stu-id="7e331-125">To ensure that a child object with no DACL is not affected by inheritable ACEs, set the SE\_DACL\_PROTECTED flag in the security descriptor of the object.</span></span>

<span data-ttu-id="7e331-126">Сведения о том, как правильно создать список DACL, см. [в разделе Создание списка DACL](/windows/desktop/SecBP/creating-a-dacl).</span><span class="sxs-lookup"><span data-stu-id="7e331-126">For information about how to properly create a DACL, see [Creating a DACL](/windows/desktop/SecBP/creating-a-dacl).</span></span>

 

 
