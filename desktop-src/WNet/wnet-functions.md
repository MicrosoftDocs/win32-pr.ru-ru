---
title: Функции Внет
description: Сетевые функции Windows предоставляют сведения и служебные программы для управления сетевыми ресурсами.
ms.assetid: 8a83186f-a912-4c61-8137-1f6be1f3afd6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 623de7adfdb57e21f01bff8b9647d6d2d175bd63
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104260976"
---
# <a name="wnet-functions"></a><span data-ttu-id="89355-103">Функции Внет</span><span class="sxs-lookup"><span data-stu-id="89355-103">WNet Functions</span></span>

<span data-ttu-id="89355-104">Сетевые функции Windows предоставляют сведения и служебные программы для управления сетевыми ресурсами.</span><span class="sxs-lookup"><span data-stu-id="89355-104">Windows Networking functions provide information and utilities for managing network resources.</span></span> <span data-ttu-id="89355-105">Сетевые функции Windows можно группировать следующим образом:</span><span class="sxs-lookup"><span data-stu-id="89355-105">The Windows Networking functions can be grouped as follows:</span></span>

-   [<span data-ttu-id="89355-106">Функции подключения</span><span class="sxs-lookup"><span data-stu-id="89355-106">Connection functions</span></span>](#connection-functions)
-   [<span data-ttu-id="89355-107">Функции перечисления</span><span class="sxs-lookup"><span data-stu-id="89355-107">Enumeration functions</span></span>](#enumeration-functions)
-   [<span data-ttu-id="89355-108">Информационные функции</span><span class="sxs-lookup"><span data-stu-id="89355-108">Information functions</span></span>](#information-functions)
-   [<span data-ttu-id="89355-109">Пользовательские функции</span><span class="sxs-lookup"><span data-stu-id="89355-109">User functions</span></span>](#user-functions)

## <a name="connection-functions"></a><span data-ttu-id="89355-110">Функции подключения</span><span class="sxs-lookup"><span data-stu-id="89355-110">Connection Functions</span></span>

<span data-ttu-id="89355-111">Вызовите следующие функции подключения Внет, чтобы подключить локальное устройство к сетевому ресурсу и отменить сетевые подключения.</span><span class="sxs-lookup"><span data-stu-id="89355-111">Call the following WNet connection functions to connect a local device to a network resource, and to cancel network connections.</span></span>



| <span data-ttu-id="89355-112">Функция</span><span class="sxs-lookup"><span data-stu-id="89355-112">Function</span></span>                                                                     | <span data-ttu-id="89355-113">Описание</span><span class="sxs-lookup"><span data-stu-id="89355-113">Description</span></span>                                                                                                                                                                                                                    |
|------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="89355-114">**мултинетжетконнектионперформанце**</span><span class="sxs-lookup"><span data-stu-id="89355-114">**MultinetGetConnectionPerformance**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-multinetgetconnectionperformancea) | <span data-ttu-id="89355-115">Возвращает сведения о ожидаемой производительности подключения к сетевому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="89355-115">Returns information about the expected performance of a connection to a network resource.</span></span>                                                                                                                                      |
| [<span data-ttu-id="89355-116">**внетаддконнектион**</span><span class="sxs-lookup"><span data-stu-id="89355-116">**WNetAddConnection**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona)                               | <span data-ttu-id="89355-117">Подключает локальное устройство к сетевому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="89355-117">Connects a local device to a network resource.</span></span> <span data-ttu-id="89355-118">(Предоставляется для совместимости с 16-разрядными версиями Windows.)</span><span class="sxs-lookup"><span data-stu-id="89355-118">(Provided for compatibility with 16-bit versions of Windows.)</span></span>                                                                                                                   |
| [<span data-ttu-id="89355-119">**WNetAddConnection2**</span><span class="sxs-lookup"><span data-stu-id="89355-119">**WNetAddConnection2**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection2a)                             | <span data-ttu-id="89355-120">Подключает локальное устройство к сетевому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="89355-120">Connects a local device to a network resource.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="89355-121">**WNetAddConnection3**</span><span class="sxs-lookup"><span data-stu-id="89355-121">**WNetAddConnection3**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection3a)                             | <span data-ttu-id="89355-122">Подключает локальное устройство к сетевому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="89355-122">Connects a local device to a network resource.</span></span> <span data-ttu-id="89355-123">Эта функция включает еще один параметр, чем функция **WNetAddConnection2** — обработчик, который сетевой поставщик может использовать в качестве окна-владельца для диалоговых окон.</span><span class="sxs-lookup"><span data-stu-id="89355-123">This function includes one more parameter than the **WNetAddConnection2** function, a handle to a window that the network provider can use as an owner window for dialog boxes.</span></span> |
| [<span data-ttu-id="89355-124">**внетканцелконнектион**</span><span class="sxs-lookup"><span data-stu-id="89355-124">**WNetCancelConnection**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnectiona)                         | <span data-ttu-id="89355-125">Отменяет сетевое подключение.</span><span class="sxs-lookup"><span data-stu-id="89355-125">Cancels a network connection.</span></span> <span data-ttu-id="89355-126">(Предоставляется для совместимости с 16-разрядными версиями Windows.)</span><span class="sxs-lookup"><span data-stu-id="89355-126">(Provided for compatibility with 16-bit versions of Windows.)</span></span>                                                                                                                                    |
| [<span data-ttu-id="89355-127">**WNetCancelConnection2**</span><span class="sxs-lookup"><span data-stu-id="89355-127">**WNetCancelConnection2**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnection2a)                       | <span data-ttu-id="89355-128">Отменяет сетевое подключение, предоставляя возможность обновления профиля пользователя сведениями о постоянных подключениях.</span><span class="sxs-lookup"><span data-stu-id="89355-128">Cancels a network connection, providing the ability to update the user profile with information about persistent connections.</span></span>                                                                                                  |
| [<span data-ttu-id="89355-129">**внетконнектиондиалог**</span><span class="sxs-lookup"><span data-stu-id="89355-129">**WNetConnectionDialog**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetconnectiondialog)                         | <span data-ttu-id="89355-130">Открывает общее диалоговое окно обзора для подключения к сетевым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="89355-130">Starts a general browsing dialog box for connecting to network resources.</span></span>                                                                                                                                                      |
| [<span data-ttu-id="89355-131">**WNetConnectionDialog1**</span><span class="sxs-lookup"><span data-stu-id="89355-131">**WNetConnectionDialog1**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetconnectiondialog1a)                       | <span data-ttu-id="89355-132">Открывает общее диалоговое окно обзора для подключения к сетевым ресурсам с помощью структуры [**коннектдлгструкт**](/windows/win32/api/winnetwk/ns-winnetwk-connectdlgstructa) .</span><span class="sxs-lookup"><span data-stu-id="89355-132">Starts a general browsing dialog box for connecting to network resources, using a [**CONNECTDLGSTRUCT**](/windows/win32/api/winnetwk/ns-winnetwk-connectdlgstructa) structure.</span></span>                                                                                  |
| [<span data-ttu-id="89355-133">**внетдисконнектдиалог**</span><span class="sxs-lookup"><span data-stu-id="89355-133">**WNetDisconnectDialog**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetdisconnectdialog)                         | <span data-ttu-id="89355-134">Открывает общее диалоговое окно обзора для отключения от сетевых ресурсов.</span><span class="sxs-lookup"><span data-stu-id="89355-134">Starts a general browsing dialog box for disconnecting from network resources.</span></span>                                                                                                                                                 |
| [<span data-ttu-id="89355-135">**WNetDisconnectDialog1**</span><span class="sxs-lookup"><span data-stu-id="89355-135">**WNetDisconnectDialog1**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetdisconnectdialog1a)                       | <span data-ttu-id="89355-136">Открывает общее диалоговое окно обзора для отключения от сетевых ресурсов с помощью структуры [**дискдлгструкт**](/windows/win32/api/winnetwk/ns-winnetwk-discdlgstructa) .</span><span class="sxs-lookup"><span data-stu-id="89355-136">Starts a general browsing dialog box for disconnecting from network resources, using a [**DISCDLGSTRUCT**](/windows/win32/api/winnetwk/ns-winnetwk-discdlgstructa) structure.</span></span>                                                                                   |
| [<span data-ttu-id="89355-137">**внетжетконнектион**</span><span class="sxs-lookup"><span data-stu-id="89355-137">**WNetGetConnection**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetconnectiona)                               | <span data-ttu-id="89355-138">Возвращает имя сетевого ресурса, связанного с локальным устройством.</span><span class="sxs-lookup"><span data-stu-id="89355-138">Retrieves the name of the network resource associated with a local device.</span></span>                                                                                                                                                     |
| [<span data-ttu-id="89355-139">**внетжетуниверсалнаме**</span><span class="sxs-lookup"><span data-stu-id="89355-139">**WNetGetUniversalName**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetuniversalnamea)                         | <span data-ttu-id="89355-140">При наличии пути на основе диска для сетевого ресурса возвращает более универсальную форму имени.</span><span class="sxs-lookup"><span data-stu-id="89355-140">When given a drive-based path for a network resource, returns a more universal form of the name.</span></span>                                                                                                                               |
| [<span data-ttu-id="89355-141">**внетрестореконнектионв**</span><span class="sxs-lookup"><span data-stu-id="89355-141">**WNetRestoreConnectionW**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetrestoreconnectionw)                     | <span data-ttu-id="89355-142">Восстанавливает подключение к сетевому ресурсу, запрашивая пользователя, если это необходимо, для имени и пароля.</span><span class="sxs-lookup"><span data-stu-id="89355-142">Restores the connection to a network resource, prompting the user, if necessary, for a name and password.</span></span>                                                                                                                      |
| [<span data-ttu-id="89355-143">**внетусеконнектион**</span><span class="sxs-lookup"><span data-stu-id="89355-143">**WNetUseConnection**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetuseconnectiona)                               | <span data-ttu-id="89355-144">Подключает локальное устройство к сетевому ресурсу; автоматически выбирает неиспользуемое локальное устройство для перенаправления к сетевому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="89355-144">Connects a local device to a network resource; automatically selects an unused local device to redirect to the network resource.</span></span>                                                                                               |



 

> [!Note]  
> <span data-ttu-id="89355-145">Функции [**внетаддконнектион**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona) и [**внетканцелконнектион**](/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnectiona) поддерживаются для обеспечения совместимости с Windows для рабочих групп.</span><span class="sxs-lookup"><span data-stu-id="89355-145">The [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona) and [**WNetCancelConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnectiona) functions are supported for compatibility with Windows for Workgroups.</span></span> <span data-ttu-id="89355-146">Однако новые приложения должны использовать [**WNetAddConnection2**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection2a) или [**WNetAddConnection3**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection3a)и [**WNetCancelConnection2**](/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnection2a).</span><span class="sxs-lookup"><span data-stu-id="89355-146">However, new applications should use [**WNetAddConnection2**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection2a) or [**WNetAddConnection3**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection3a), and [**WNetCancelConnection2**](/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnection2a).</span></span>

 

## <a name="enumeration-functions"></a><span data-ttu-id="89355-147">Функции перечисления</span><span class="sxs-lookup"><span data-stu-id="89355-147">Enumeration Functions</span></span>

<span data-ttu-id="89355-148">Чтобы перечислить сетевые ресурсы, вызовите следующие функции Внет.</span><span class="sxs-lookup"><span data-stu-id="89355-148">Call the following WNet functions to enumerate network resources.</span></span>



| <span data-ttu-id="89355-149">Функция</span><span class="sxs-lookup"><span data-stu-id="89355-149">Function</span></span>                                     | <span data-ttu-id="89355-150">Описание</span><span class="sxs-lookup"><span data-stu-id="89355-150">Description</span></span>                                                                             |
|----------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="89355-151">**внетклосинум**</span><span class="sxs-lookup"><span data-stu-id="89355-151">**WNetCloseEnum**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetcloseenum)       | <span data-ttu-id="89355-152">Завершает перечисление сетевых ресурсов.</span><span class="sxs-lookup"><span data-stu-id="89355-152">Ends a network resource enumeration.</span></span>                                                    |
| [<span data-ttu-id="89355-153">**внетенумресаурце**</span><span class="sxs-lookup"><span data-stu-id="89355-153">**WNetEnumResource**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetenumresourcea) | <span data-ttu-id="89355-154">Возобновляет перечисление сетевых ресурсов, запущенных функцией **внетопененум** .</span><span class="sxs-lookup"><span data-stu-id="89355-154">Continues an enumeration of network resources started by the **WNetOpenEnum** function.</span></span> |
| [<span data-ttu-id="89355-155">**внетопененум**</span><span class="sxs-lookup"><span data-stu-id="89355-155">**WNetOpenEnum**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetopenenuma)         | <span data-ttu-id="89355-156">Запускает перечисление сетевых ресурсов.</span><span class="sxs-lookup"><span data-stu-id="89355-156">Starts an enumeration of network resources.</span></span>                                             |



 

## <a name="information-functions"></a><span data-ttu-id="89355-157">Информационные функции</span><span class="sxs-lookup"><span data-stu-id="89355-157">Information Functions</span></span>

<span data-ttu-id="89355-158">Вызовите следующие информационные и служебные функции Внет, чтобы получить поставщик сети и другие сведения.</span><span class="sxs-lookup"><span data-stu-id="89355-158">Call the following WNet informational and utility functions to retrieve network provider and other information.</span></span>



| <span data-ttu-id="89355-159">Функция</span><span class="sxs-lookup"><span data-stu-id="89355-159">Function</span></span>                                                         | <span data-ttu-id="89355-160">Описание</span><span class="sxs-lookup"><span data-stu-id="89355-160">Description</span></span>                                                                                         |
|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="89355-161">**внетжетластеррор**</span><span class="sxs-lookup"><span data-stu-id="89355-161">**WNetGetLastError**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetlasterrora)                     | <span data-ttu-id="89355-162">Возвращает самый последний код ошибки, заданный функцией Внет, полученной от поставщика сети.</span><span class="sxs-lookup"><span data-stu-id="89355-162">Returns the most recent error code set by a WNet function, the one reported by a network provider.</span></span>  |
| [<span data-ttu-id="89355-163">**внетжетнетворкинформатион**</span><span class="sxs-lookup"><span data-stu-id="89355-163">**WNetGetNetworkInformation**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetnetworkinformationa)   | <span data-ttu-id="89355-164">Возвращает расширенные сведения о конкретном поставщике сети.</span><span class="sxs-lookup"><span data-stu-id="89355-164">Returns extended information about a specific network provider.</span></span>                                     |
| [<span data-ttu-id="89355-165">**внетжетпровидернаме**</span><span class="sxs-lookup"><span data-stu-id="89355-165">**WNetGetProviderName**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea)               | <span data-ttu-id="89355-166">Возвращает имя поставщика для определенного типа сети.</span><span class="sxs-lookup"><span data-stu-id="89355-166">Returns the provider name for a specific type of network.</span></span>                                           |
| [<span data-ttu-id="89355-167">**внетжетресаурцеинформатион**</span><span class="sxs-lookup"><span data-stu-id="89355-167">**WNetGetResourceInformation**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetresourceinformationa) | <span data-ttu-id="89355-168">Возвращает поставщика сети, владеющего ресурсом, и получает сведения о типе ресурса.</span><span class="sxs-lookup"><span data-stu-id="89355-168">Returns the network provider that owns a resource, and obtains information about the resource type.</span></span> |
| [<span data-ttu-id="89355-169">**внетжетресаурцепарент**</span><span class="sxs-lookup"><span data-stu-id="89355-169">**WNetGetResourceParent**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetresourceparenta)           | <span data-ttu-id="89355-170">Возвращает родителя сетевого ресурса.</span><span class="sxs-lookup"><span data-stu-id="89355-170">Returns the parent of a network resource.</span></span>                                                           |



 

## <a name="user-functions"></a><span data-ttu-id="89355-171">Пользовательские функции</span><span class="sxs-lookup"><span data-stu-id="89355-171">User Functions</span></span>

<span data-ttu-id="89355-172">Вызовите следующую функцию Внет, чтобы получить имя пользователя, связанного с локальным устройством.</span><span class="sxs-lookup"><span data-stu-id="89355-172">Call the following WNet function to retrieve the name of the user associated with a local device.</span></span>



| <span data-ttu-id="89355-173">Функция</span><span class="sxs-lookup"><span data-stu-id="89355-173">Function</span></span>                           | <span data-ttu-id="89355-174">Описание</span><span class="sxs-lookup"><span data-stu-id="89355-174">Description</span></span>                                                                              |
|------------------------------------|------------------------------------------------------------------------------------------|
| [<span data-ttu-id="89355-175">**внетжетусер**</span><span class="sxs-lookup"><span data-stu-id="89355-175">**WNetGetUser**</span></span>](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetusera) | <span data-ttu-id="89355-176">Возвращает текущее имя пользователя по умолчанию или имя пользователя, который установил соединение.</span><span class="sxs-lookup"><span data-stu-id="89355-176">Returns the current default user name, or the user name that established the connection.</span></span> |



 

<span data-ttu-id="89355-177">Многие функции Внет используют структуру [**нетресаурце**](/windows/desktop/api/Winnetwk/ns-winnetwk-netresourcea) для хранения информации о сетевом ресурсе.</span><span class="sxs-lookup"><span data-stu-id="89355-177">Many of the WNet functions use a [**NETRESOURCE**](/windows/desktop/api/Winnetwk/ns-winnetwk-netresourcea) structure to store information about a network resource.</span></span>

 

 