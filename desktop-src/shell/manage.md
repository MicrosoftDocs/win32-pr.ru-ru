---
description: Оболочка предоставляет несколько способов управления файловыми системами.
ms.assetid: d9ffda6f-adc0-44a3-b410-e23bf5f4f165
title: Управление файловой системой
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 404b456ce1f26c128e6c3fc3bc9971672378a0d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104342432"
---
# <a name="managing-the-file-system"></a><span data-ttu-id="38be2-103">Управление файловой системой</span><span class="sxs-lookup"><span data-stu-id="38be2-103">Managing the File System</span></span>

<span data-ttu-id="38be2-104">Оболочка предоставляет несколько способов управления файловыми системами.</span><span class="sxs-lookup"><span data-stu-id="38be2-104">The Shell provides a number of ways to manage file systems.</span></span> <span data-ttu-id="38be2-105">Оболочка предоставляет функцию [**шфилеоператион**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), которая позволяет приложению программно перемещать, копировать, переименовывать и удалять файлы.</span><span class="sxs-lookup"><span data-stu-id="38be2-105">The Shell provides a function, [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), that allows an application to programmatically move, copy, rename, and delete files.</span></span> <span data-ttu-id="38be2-106">Оболочка также поддерживает некоторые дополнительные возможности управления файлами.</span><span class="sxs-lookup"><span data-stu-id="38be2-106">The Shell also supports some additional file management capabilities.</span></span>

-   <span data-ttu-id="38be2-107">Документы HTML могут быть *подключены* к связанным файлам, таким как графические файлы или таблицы стилей.</span><span class="sxs-lookup"><span data-stu-id="38be2-107">HTML documents can be *connected* to related files, such as graphics files or style sheets.</span></span> <span data-ttu-id="38be2-108">При перемещении или копировании документа подключенные файлы также автоматически перемещаются или копируются.</span><span class="sxs-lookup"><span data-stu-id="38be2-108">When the document is moved or copied, the connected files are automatically moved or copied as well.</span></span>
-   <span data-ttu-id="38be2-109">Для систем, доступных нескольким пользователям, Управление файлами может осуществляться отдельно для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="38be2-109">For systems that are available to more than one user, files can be managed on a per-user basis.</span></span> <span data-ttu-id="38be2-110">Пользователи имеют простой доступ к файлам данных, но не к файлам, принадлежащим другим пользователям.</span><span class="sxs-lookup"><span data-stu-id="38be2-110">Users have easy access to their data files, but not to files belonging to other users.</span></span>
-   <span data-ttu-id="38be2-111">Если файлы документа добавляются или изменяются, их можно добавить в список последних документов оболочки.</span><span class="sxs-lookup"><span data-stu-id="38be2-111">If document files are added or modified, they can be added to the Shell's list of recent documents.</span></span> <span data-ttu-id="38be2-112">Когда пользователь щелкает команду " **документы** " в меню "Пуск", отображается список ссылок на документы.</span><span class="sxs-lookup"><span data-stu-id="38be2-112">When the user clicks the **Documents** command on the Start menu, a list of links to the documents appears.</span></span>

<span data-ttu-id="38be2-113">В этом документе описывается, как работают эти технологии управления файлами.</span><span class="sxs-lookup"><span data-stu-id="38be2-113">This document discusses how these file management technologies work.</span></span> <span data-ttu-id="38be2-114">Затем в нем описано, как использовать оболочку для перемещения, копирования, переименования и удаления файлов и управления объектами в корзине.</span><span class="sxs-lookup"><span data-stu-id="38be2-114">It then outlines how to use the Shell to move, copy, rename, and delete files, and how to manage objects in the Recycle Bin.</span></span>

-   [<span data-ttu-id="38be2-115">Управление файлами на уровне пользователя</span><span class="sxs-lookup"><span data-stu-id="38be2-115">Per-User File Management</span></span>](#per-user-file-management)
-   [<span data-ttu-id="38be2-116">Папки "Мои документы" и "Мои рисунки"</span><span class="sxs-lookup"><span data-stu-id="38be2-116">My Documents and My Pictures Folders</span></span>](#my-documents-and-my-pictures-folders)
-   [<span data-ttu-id="38be2-117">Подключенные файлы</span><span class="sxs-lookup"><span data-stu-id="38be2-117">Connected Files</span></span>](#connected-files)
-   [<span data-ttu-id="38be2-118">Перемещение, копирование, переименование и удаление файлов</span><span class="sxs-lookup"><span data-stu-id="38be2-118">Moving, Copying, Renaming, and Deleting Files</span></span>](#moving-copying-renaming-and-deleting-files)
    -   [<span data-ttu-id="38be2-119">Уведомление оболочки</span><span class="sxs-lookup"><span data-stu-id="38be2-119">Notifying the Shell</span></span>](#notifying-the-shell)
-   [<span data-ttu-id="38be2-120">Простой пример управления файлами с помощью Шфилеоператион</span><span class="sxs-lookup"><span data-stu-id="38be2-120">Simple Example of Managing Files with SHFileOperation</span></span>](#simple-example-of-managing-files-with-shfileoperation)
-   [<span data-ttu-id="38be2-121">Добавление файлов в список последних документов оболочки</span><span class="sxs-lookup"><span data-stu-id="38be2-121">Adding Files to the Shell's List of Recent Documents</span></span>](#adding-files-to-the-shells-list-of-recent-documents)

## <a name="per-user-file-management"></a><span data-ttu-id="38be2-122">Per-User Управление файлами</span><span class="sxs-lookup"><span data-stu-id="38be2-122">Per-User File Management</span></span>

<span data-ttu-id="38be2-123">Оболочка Windows 2000 позволяет связать файлы с определенным пользователем, чтобы они оставались скрытыми для других пользователей.</span><span class="sxs-lookup"><span data-stu-id="38be2-123">The Windows 2000 Shell allows files to be associated with a particular user so the files remain hidden from other users.</span></span> <span data-ttu-id="38be2-124">В плане файловой системы файлы хранятся в папке профиля пользователя, обычно C: \\ Documents and Settings \\ *username* \\ в системах Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="38be2-124">In terms of the file system, the files are stored under the user's profile folder, typically C:\\Documents and Settings\\*Username*\\ on Windows 2000 systems.</span></span> <span data-ttu-id="38be2-125">Эта функция позволяет многим пользователям использовать один и тот же компьютер, сохраняя конфиденциальность своих файлов от других пользователей.</span><span class="sxs-lookup"><span data-stu-id="38be2-125">This feature allows many individuals to use the same computer, while maintaining the privacy of their files from other users.</span></span> <span data-ttu-id="38be2-126">Разные пользователи могут иметь разные доступные программы.</span><span class="sxs-lookup"><span data-stu-id="38be2-126">Different users can have different programs available.</span></span> <span data-ttu-id="38be2-127">Он также предоставляет администраторам и приложениям простой способ хранения таких файлов, как инициализация (. ini) или ссылки (lnk).</span><span class="sxs-lookup"><span data-stu-id="38be2-127">It also provides a straightforward way for administrators and applications to store such things as initialization (.ini) or link (.lnk) files.</span></span> <span data-ttu-id="38be2-128">Таким способом приложения могут сохранять разные состояния для каждого пользователя и легко восстанавливать это состояние при необходимости.</span><span class="sxs-lookup"><span data-stu-id="38be2-128">Applications can thus preserve a different state for each user and easily recover that particular state when needed.</span></span> <span data-ttu-id="38be2-129">Кроме того, существует папка профиля для хранения сведений, общих для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="38be2-129">There is also a profile folder for storing information that is common to all users.</span></span>

<span data-ttu-id="38be2-130">Так как неудобно определить, какой пользователь вошел в систему и где находятся файлы, стандартные папки для каждого пользователя являются специальными папками и идентифицируются с помощью [**CSid**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="38be2-130">Because it is inconvenient to determine which user is logged in and where their files are located, the standard per-user folders are special folders and are identified by a [**CSIDL**](csidl.md).</span></span> <span data-ttu-id="38be2-131">Например, CSID для папки "Program Files" (файлы программы для пользователя) — это \_ программы CSid.</span><span class="sxs-lookup"><span data-stu-id="38be2-131">For instance, the CSIDL for the per-user Program Files folder is CSIDL\_PROGRAMS.</span></span> <span data-ttu-id="38be2-132">Если приложение вызывает [**шжетфолдерлокатион**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) или [**шжетфолдерпас**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) с одним из ксидлс для каждого пользователя, функция возвращает указатель на список идентификаторов элементов (Пидл) или путь, соответствующий текущему пользователю, вошедшему в систему.</span><span class="sxs-lookup"><span data-stu-id="38be2-132">If your application calls [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with one of the per-user CSIDLs, the function returns the pointer to an item identifier list (PIDL) or path appropriate to the currently logged-in user.</span></span> <span data-ttu-id="38be2-133">Если приложению необходимо получить путь или ПИДЛ папки Profile, то его CSID имеет **\_ профиль CSid**.</span><span class="sxs-lookup"><span data-stu-id="38be2-133">If your application needs to retrieve the path or PIDL of the profile folder, its CSIDL is **CSIDL\_PROFILE**.</span></span>

## <a name="my-documents-and-my-pictures-folders"></a><span data-ttu-id="38be2-134">Папки "Мои документы" и "Мои рисунки"</span><span class="sxs-lookup"><span data-stu-id="38be2-134">My Documents and My Pictures Folders</span></span>

<span data-ttu-id="38be2-135">Один из стандартных значков, находящихся на рабочем столе, — **Мои документы**.</span><span class="sxs-lookup"><span data-stu-id="38be2-135">One of the standard icons found on the desktop is **My Documents**.</span></span> <span data-ttu-id="38be2-136">При открытии этой папки в ней содержатся файлы документов текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="38be2-136">When you open this folder, it contains the current user's document files.</span></span> <span data-ttu-id="38be2-137">Экземпляр рабочего стола "Мои документы" — это виртуальная папка — псевдоним для расположения файловой системы, используемый для физического хранения документов пользователя, расположенных непосредственно под настольным компьютером в иерархии пространства имен.</span><span class="sxs-lookup"><span data-stu-id="38be2-137">The desktop instance of My Documents is a virtual folder—an alias to the file system location used to physically store the user's documents—located immediately below the desktop in the namespace hierarchy.</span></span>

<span data-ttu-id="38be2-138">Папки «Мои документы» и «мои рисунки» — обеспечивают простой и безопасный способ доступа пользователей к документам и файлам изображений в системе, в которой может быть несколько пользователей.</span><span class="sxs-lookup"><span data-stu-id="38be2-138">The purpose of the My Documents and My Pictures folders is to provide a straightforward and secure way for users to access their document and picture files on a system that might have multiple users.</span></span> <span data-ttu-id="38be2-139">Каждому пользователю назначаются отдельные папки файловой системы для своих файлов.</span><span class="sxs-lookup"><span data-stu-id="38be2-139">Each user is assigned separate file system folders for his or her files.</span></span> <span data-ttu-id="38be2-140">Например, расположением папки "документы пользователя" в файловой системе обычно является нечто вроде C: \\ Documents and Settings \\ *username* \\ Мои документы.</span><span class="sxs-lookup"><span data-stu-id="38be2-140">For example, the location of a user's documents folder in the file system is typically something like C:\\Documents and Settings\\*username*\\My Documents.</span></span> <span data-ttu-id="38be2-141">Пользователям не нужно ничего знать о физическом расположении их папок файловой системы.</span><span class="sxs-lookup"><span data-stu-id="38be2-141">There is no need for users to know anything about the physical location of their file system folders.</span></span> <span data-ttu-id="38be2-142">Они просто обращаются к своим файлам через значок «Мои документы».</span><span class="sxs-lookup"><span data-stu-id="38be2-142">They simply access their files through the My Documents icon.</span></span>

> [!Note]  
> <span data-ttu-id="38be2-143">Мои документы позволяют пользователю получить доступ к своим собственным файлам, но не к другим пользователям.</span><span class="sxs-lookup"><span data-stu-id="38be2-143">My Documents allows a user to access his or her own files but not those of any other user.</span></span> <span data-ttu-id="38be2-144">Если несколько пользователей используют один и тот же компьютер, администратор может блокировать пользователей из части файловой системы, в которой хранятся фактические файлы.</span><span class="sxs-lookup"><span data-stu-id="38be2-144">If multiple individuals use the same computer, an administrator can lock users out of the part of the file system where the actual files are stored.</span></span> <span data-ttu-id="38be2-145">Таким же пользователям будет доступна возможность работать с собственными документами в папке «Мои документы», но не с документами, принадлежащими другим пользователям.</span><span class="sxs-lookup"><span data-stu-id="38be2-145">Users will thus be able to work on their own documents through the My Documents folder but not on documents that belong to any other users.</span></span>

 

<span data-ttu-id="38be2-146">Как правило, приложению не нужно знать, какой пользователь вошел в систему или в файловой системе, где находится папка "Мои документы" пользователя.</span><span class="sxs-lookup"><span data-stu-id="38be2-146">There is usually no need for an application to know which user is logged in or where in the file system that user's My Documents folder is located.</span></span> <span data-ttu-id="38be2-147">Вместо этого приложение может извлечь ПИДЛ значка рабочего стола "Мои документы", вызвав метод [**ишеллфолдер::P арседисплайнаме**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="38be2-147">Instead, your application can retrieve the PIDL of the My Documents desktop icon by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method.</span></span> <span data-ttu-id="38be2-148">Имя синтаксического анализа, используемое для обнаружения папки "Мои документы", не является путем к файлу, а:: {450d8fba-ad25-11D0-98a8-0800361b1103}.</span><span class="sxs-lookup"><span data-stu-id="38be2-148">The parsing name used to identify the My Documents folder is not a file path but rather ::{450d8fba-ad25-11d0-98a8-0800361b1103}.</span></span> <span data-ttu-id="38be2-149">Выражение в квадратных скобках является текстовой формой GUID "Мои документы".</span><span class="sxs-lookup"><span data-stu-id="38be2-149">The bracketed expression is the text form of the My Documents GUID.</span></span> <span data-ttu-id="38be2-150">Например, чтобы получить ПИДЛ из документов, приложение должно использовать этот вызов в **ишеллфолдер::P арседисплайнаме**.</span><span class="sxs-lookup"><span data-stu-id="38be2-150">For example, to retrieve the PIDL of My Documents, your application should use this call to **IShellFolder::ParseDisplayName**.</span></span>


```C++
hr = psfDeskTop->ParseDisplayName(NULL, 
                                  NULL, 
                                  L"::{450d8fba-ad25-11d0-98a8-0800361b1103}", 
                                  &chEaten, 
                                  &pidlDocFiles, 
                                  NULL);
```



<span data-ttu-id="38be2-151">После того, как приложение ПИДЛ мои документы, оно может обработать папку так же, как обычная папка файловой системы — перечисление элементов, синтаксический анализ, привязка и выполнение любых других допустимых операций с папкой.</span><span class="sxs-lookup"><span data-stu-id="38be2-151">Once your application has the My Documents PIDL, it can handle the folder just as it would a normal file system folder—enumerating items, parsing, binding, and performing any other valid folder operations.</span></span> <span data-ttu-id="38be2-152">Оболочка автоматически сопоставляет изменения в папке «Мои документы» или ее вложенных папках с соответствующими папками файловой системы.</span><span class="sxs-lookup"><span data-stu-id="38be2-152">The Shell automatically maps changes in My Documents or its subfolders to the appropriate file system folders.</span></span>

<span data-ttu-id="38be2-153">Если приложению требуется доступ к реальной папке файловой системы, содержащей документы текущего пользователя, передавайте параметру CSID \_ Personal значение [**шжетфолдерлокатион**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span><span class="sxs-lookup"><span data-stu-id="38be2-153">If your application needs access to the actual file system folder that contains the current user's documents, pass CSIDL\_PERSONAL to [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span></span> <span data-ttu-id="38be2-154">Функция возвращает ПИДЛ папки файловой системы, которая отображается в папке "Мои документы" текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="38be2-154">The function returns the PIDL of the file system folder that is displayed in the current user's My Documents folder.</span></span>

## <a name="connected-files"></a><span data-ttu-id="38be2-155">Подключенные файлы</span><span class="sxs-lookup"><span data-stu-id="38be2-155">Connected Files</span></span>

<span data-ttu-id="38be2-156">HTML-документы часто имеют ряд связанных графических файлов, файл таблицы стилей, несколько сценариев Microsoft JScript (совместимых с ECMA 262 языка) и т. д.</span><span class="sxs-lookup"><span data-stu-id="38be2-156">HTML documents often have a number of associated graphics files, a style sheet file, several Microsoft JScript (compatible with ECMA 262 language specification ) files, and so on.</span></span> <span data-ttu-id="38be2-157">При перемещении или копировании первичного HTML-документа обычно требуется переместить или скопировать связанные файлы, чтобы избежать разрыва связей.</span><span class="sxs-lookup"><span data-stu-id="38be2-157">When you move or copy the primary HTML document, you also usually want to move or copy its associated files to avoid breaking links.</span></span> <span data-ttu-id="38be2-158">К сожалению, не существовало простого способа определить, какие файлы связаны с любым документом HTML, а не путем анализа их содержимого.</span><span class="sxs-lookup"><span data-stu-id="38be2-158">Unfortunately, there has been no easy way until now to determine which files are related to any given HTML document other than by analyzing their contents.</span></span> <span data-ttu-id="38be2-159">Чтобы решить эту проблему, Windows 2000 предоставляет простой способ *подключения* основного документа HTML к группе связанных файлов.</span><span class="sxs-lookup"><span data-stu-id="38be2-159">To alleviate this problem, Windows 2000 provides a simple way to *connect* a primary HTML document to its group of associated files.</span></span> <span data-ttu-id="38be2-160">Если подключение к файлу включено, то при перемещении или копировании документа все связанные с ним файлы помещаются вместе с ним.</span><span class="sxs-lookup"><span data-stu-id="38be2-160">If file connection is enabled, when the document is moved or copied all its connected files go with it.</span></span>

<span data-ttu-id="38be2-161">Чтобы создать группу подключенных файлов, первичный документ должен иметь расширение htm или HTML.</span><span class="sxs-lookup"><span data-stu-id="38be2-161">To create a group of connected files, the primary document must have an .htm or .html file name extension.</span></span> <span data-ttu-id="38be2-162">Создайте вложенную папку родительской папки основного документа.</span><span class="sxs-lookup"><span data-stu-id="38be2-162">Create a subfolder of the primary document's parent folder.</span></span> <span data-ttu-id="38be2-163">Имя вложенной папки должно быть именем основного документа, за вычетом расширения htm или HTML, за которым следует одно из перечисленных ниже расширений.</span><span class="sxs-lookup"><span data-stu-id="38be2-163">The subfolder's name must be the name of the primary document, minus the .htm or .html extension, followed by one of the extensions listed below.</span></span> <span data-ttu-id="38be2-164">Чаще всего используются расширения ". Files" или " \_ Files".</span><span class="sxs-lookup"><span data-stu-id="38be2-164">The most commonly used extensions are ".files" or "\_files".</span></span> <span data-ttu-id="38be2-165">Например, если первичный документ называется MyDoc.htm, то имя вложенной папки «Мидок \_ Files» определяет вложенную папку как контейнер для подключенных файлов документа.</span><span class="sxs-lookup"><span data-stu-id="38be2-165">For instance, if the primary document is named MyDoc.htm, naming the subfolder "MyDoc\_files" defines the subfolder as the container for the document's connected files.</span></span> <span data-ttu-id="38be2-166">Если первичный документ перемещен или скопирован, то вложенная папка и ее файлы также будут перемещены или скопированы.</span><span class="sxs-lookup"><span data-stu-id="38be2-166">If the primary document is moved or copied, the subfolder and its files are moved or copied as well.</span></span>

<span data-ttu-id="38be2-167">Для некоторых языков можно использовать локализованный эквивалент " \_ Files", чтобы создать вложенную папку для подключенных файлов.</span><span class="sxs-lookup"><span data-stu-id="38be2-167">For some languages, it is possible to use a localized equivalent of "\_files" to create a subfolder for connected files.</span></span> <span data-ttu-id="38be2-168">В следующей таблице перечислены допустимые строки, которые можно добавить к имени документа для создания вложенной папки с подключенными файлами.</span><span class="sxs-lookup"><span data-stu-id="38be2-168">The following table lists the valid strings that can be appended to a document name to create a connected files subfolder.</span></span> <span data-ttu-id="38be2-169">Обратите внимание, что некоторые из этих строк содержат символ "-" в качестве первого символа, а не " \_ " или ".".</span><span class="sxs-lookup"><span data-stu-id="38be2-169">Note that some of these strings have '-' as their first character rather than '\_' or '.'.</span></span>



|              |               |                 |               |
|--------------|---------------|-----------------|---------------|
| <span data-ttu-id="38be2-170">" \_ арчивос"</span><span class="sxs-lookup"><span data-stu-id="38be2-170">"\_archivos"</span></span> | <span data-ttu-id="38be2-171">" \_ аркуивос"</span><span class="sxs-lookup"><span data-stu-id="38be2-171">"\_arquivos"</span></span>  | <span data-ttu-id="38be2-172">" \_ бестанден"</span><span class="sxs-lookup"><span data-stu-id="38be2-172">"\_bestanden"</span></span>   | <span data-ttu-id="38be2-173">" \_ билос"</span><span class="sxs-lookup"><span data-stu-id="38be2-173">"\_bylos"</span></span>     |
| <span data-ttu-id="38be2-174">"-Датеиен"</span><span class="sxs-lookup"><span data-stu-id="38be2-174">"-Dateien"</span></span>   | <span data-ttu-id="38be2-175">" \_ датотеке"</span><span class="sxs-lookup"><span data-stu-id="38be2-175">"\_datoteke"</span></span>  | <span data-ttu-id="38be2-176">" \_ досялар"</span><span class="sxs-lookup"><span data-stu-id="38be2-176">"\_dosyalar"</span></span>    | <span data-ttu-id="38be2-177">" \_ елемеи"</span><span class="sxs-lookup"><span data-stu-id="38be2-177">"\_elemei"</span></span>    |
| <span data-ttu-id="38be2-178">" \_ фаилид"</span><span class="sxs-lookup"><span data-stu-id="38be2-178">"\_failid"</span></span>   | <span data-ttu-id="38be2-179">" \_ сбой"</span><span class="sxs-lookup"><span data-stu-id="38be2-179">"\_fails"</span></span>     | <span data-ttu-id="38be2-180">" \_ фажлови"</span><span class="sxs-lookup"><span data-stu-id="38be2-180">"\_fajlovi"</span></span>     | <span data-ttu-id="38be2-181">" \_ фичеирос"</span><span class="sxs-lookup"><span data-stu-id="38be2-181">"\_ficheiros"</span></span> |
| <span data-ttu-id="38be2-182">" \_ фичиерс"</span><span class="sxs-lookup"><span data-stu-id="38be2-182">"\_fichiers"</span></span> | <span data-ttu-id="38be2-183">"-фильтр"</span><span class="sxs-lookup"><span data-stu-id="38be2-183">"-filer"</span></span>      | <span data-ttu-id="38be2-184">". Files"</span><span class="sxs-lookup"><span data-stu-id="38be2-184">".files"</span></span>        | <span data-ttu-id="38be2-185">" \_ файлы"</span><span class="sxs-lookup"><span data-stu-id="38be2-185">"\_files"</span></span>     |
| <span data-ttu-id="38be2-186">" \_ файл"</span><span class="sxs-lookup"><span data-stu-id="38be2-186">"\_file"</span></span>     | <span data-ttu-id="38be2-187">" \_ фитксерс"</span><span class="sxs-lookup"><span data-stu-id="38be2-187">"\_fitxers"</span></span>   | <span data-ttu-id="38be2-188">" \_ фитксатегиак"</span><span class="sxs-lookup"><span data-stu-id="38be2-188">"\_fitxategiak"</span></span> | <span data-ttu-id="38be2-189">" \_ плики"</span><span class="sxs-lookup"><span data-stu-id="38be2-189">"\_pliki"</span></span>     |
| <span data-ttu-id="38be2-190">" \_ саубори"</span><span class="sxs-lookup"><span data-stu-id="38be2-190">"\_soubory"</span></span>  | <span data-ttu-id="38be2-191">" \_ тиедостот"</span><span class="sxs-lookup"><span data-stu-id="38be2-191">"\_tiedostot"</span></span> |                 |               |



 

> [!Note]  
> <span data-ttu-id="38be2-192">Эта функция чувствительна к регистру расширения.</span><span class="sxs-lookup"><span data-stu-id="38be2-192">This feature is sensitive to the case of the extension.</span></span> <span data-ttu-id="38be2-193">Например, для указанного выше примера вложенная папка с именем "Мидок \_ Files" не будет подключена к MyDoc.htm.</span><span class="sxs-lookup"><span data-stu-id="38be2-193">For instance, for the example given above, a subfolder named "MyDoc\_Files" will not be connected to MyDoc.htm.</span></span>

 

<span data-ttu-id="38be2-194">Включение или отключение подключения файлов осуществляется с помощью параметра **reg \_ DWORD** , нофилефолдерконнектион в следующем разделе реестра.</span><span class="sxs-lookup"><span data-stu-id="38be2-194">Whether file connection is enabled or disabled is controlled by a **REG\_DWORD** value, NoFileFolderConnection, of the following registry key.</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
```

<span data-ttu-id="38be2-195">Обычно это значение не определено, а соединение с файлом включено.</span><span class="sxs-lookup"><span data-stu-id="38be2-195">This value normally is not defined, and file connection is enabled.</span></span> <span data-ttu-id="38be2-196">При необходимости можно отключить подключение к файлу, добавив это значение в раздел и установив для него параметр 1.</span><span class="sxs-lookup"><span data-stu-id="38be2-196">If necessary, you can disable file connection by adding this value to the key and setting it to 1.</span></span> <span data-ttu-id="38be2-197">Чтобы снова включить подключение к файлу, присвойте параметру Нофилефолдерконнектион значение 0.</span><span class="sxs-lookup"><span data-stu-id="38be2-197">To enable file connection again, set NoFileFolderConnection to zero.</span></span>

> [!Note]  
> <span data-ttu-id="38be2-198">Подключение файла обычно должно быть включено, так как от него могут зависеть другие приложения.</span><span class="sxs-lookup"><span data-stu-id="38be2-198">File connection should normally be enabled because other applications might depend on it.</span></span> <span data-ttu-id="38be2-199">Отключите соединение с файлом только в случае крайней необходимости.</span><span class="sxs-lookup"><span data-stu-id="38be2-199">Disable file connection only if absolutely necessary.</span></span>

 

## <a name="moving-copying-renaming-and-deleting-files"></a><span data-ttu-id="38be2-200">Перемещение, копирование, переименование и удаление файлов</span><span class="sxs-lookup"><span data-stu-id="38be2-200">Moving, Copying, Renaming, and Deleting Files</span></span>

<span data-ttu-id="38be2-201">Пространство имен не является статическим, и приложениям обычно требуется управлять файловой системой, выполнив одну из следующих операций.</span><span class="sxs-lookup"><span data-stu-id="38be2-201">The namespace is not static, and applications commonly need to manage the file system by performing one of the following operations.</span></span>

-   <span data-ttu-id="38be2-202">Копирование объекта в другую папку.</span><span class="sxs-lookup"><span data-stu-id="38be2-202">Copying an object to another folder.</span></span>
-   <span data-ttu-id="38be2-203">Перемещение объекта в другую папку.</span><span class="sxs-lookup"><span data-stu-id="38be2-203">Moving an object to another folder.</span></span>
-   <span data-ttu-id="38be2-204">Удаление объекта.</span><span class="sxs-lookup"><span data-stu-id="38be2-204">Deleting an object.</span></span>
-   <span data-ttu-id="38be2-205">Переименование объекта.</span><span class="sxs-lookup"><span data-stu-id="38be2-205">Renaming an object.</span></span>

<span data-ttu-id="38be2-206">Все эти операции выполняются с помощью [**шфилеоператион**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span><span class="sxs-lookup"><span data-stu-id="38be2-206">These operations are all performed with [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="38be2-207">Эта функция принимает один или несколько исходных файлов и создает соответствующие файлы назначения.</span><span class="sxs-lookup"><span data-stu-id="38be2-207">This function takes one or more source files and produces corresponding destination files.</span></span> <span data-ttu-id="38be2-208">В случае операции удаления система пытается разместить удаленные файлы в корзине.</span><span class="sxs-lookup"><span data-stu-id="38be2-208">In the case of the delete operation, the system attempts to put the deleted files into the Recycle Bin.</span></span>

<span data-ttu-id="38be2-209">Также можно перемещать файлы с помощью функции [перетаскивания](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="38be2-209">It is also possible to move files using the [drag-and-drop](dragdrop.md) functionality.</span></span>

<span data-ttu-id="38be2-210">Чтобы использовать функцию, необходимо заполнить члены структуры [**шфилеопструкт**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) и передать ее в [**шфилеоператион**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span><span class="sxs-lookup"><span data-stu-id="38be2-210">To use the function, you must fill in the members of an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure and pass it to [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="38be2-211">Ключевые элементы структуры **пфром** и переносятся. </span><span class="sxs-lookup"><span data-stu-id="38be2-211">The key members of the structure are **pFrom** and **pTo**.</span></span>

<span data-ttu-id="38be2-212">Член **пфром** представляет собой строку, завершающуюся **нулем**, которая содержит одно или несколько имен исходных файлов.</span><span class="sxs-lookup"><span data-stu-id="38be2-212">The **pFrom** member is a double **null**-terminated string that contains one or more source file names.</span></span> <span data-ttu-id="38be2-213">Эти имена могут быть либо полными путями, либо стандартными подстановочными знаками DOS, такими как \* . \* .</span><span class="sxs-lookup"><span data-stu-id="38be2-213">These names can be either fully qualified paths or standard DOS wildcards such as \*.\*.</span></span> <span data-ttu-id="38be2-214">Хотя этот член объявлен как строка с **завершающим нулем,** он используется в качестве буфера для хранения нескольких имен файлов.</span><span class="sxs-lookup"><span data-stu-id="38be2-214">Although this member is declared as a **null**-terminated string, it is used as a buffer to hold multiple file names.</span></span> <span data-ttu-id="38be2-215">Каждое имя файла должно заканчиваться обычным **нулевым** символом.</span><span class="sxs-lookup"><span data-stu-id="38be2-215">Each file name must be terminated by the usual single **NULL** character.</span></span> <span data-ttu-id="38be2-216">К концу окончательного имени должен быть добавлен дополнительный символ **null** для указания на конец **пфром**.</span><span class="sxs-lookup"><span data-stu-id="38be2-216">An additional **NULL** character must be appended to the end of the final name to indicate the end of **pFrom**.</span></span>

<span data-ttu-id="38be2-217">Перекрывающийся **элемент —** это строка, завершающаяся символом двойной точности **null**, подобно **пфром**.</span><span class="sxs-lookup"><span data-stu-id="38be2-217">The **pTo** member is a double **null**-terminated string, much like **pFrom**.</span></span> <span data-ttu-id="38be2-218">Элемент **«** составной» содержит имена одного или нескольких полных имен назначения.</span><span class="sxs-lookup"><span data-stu-id="38be2-218">The **pTo** member contains the names of one or more fully qualified destination names.</span></span> <span data-ttu-id="38be2-219">Они упаковываются так  же, как и для **пфром**.</span><span class="sxs-lookup"><span data-stu-id="38be2-219">They are packed into **pTo** in the same way as they are for **pFrom**.</span></span> <span data-ttu-id="38be2-220">Если  перестройка содержит несколько имен, необходимо также установить флаг **ФОФ \_ мултидестфилес** в элементе **ффлагс** .</span><span class="sxs-lookup"><span data-stu-id="38be2-220">If **pTo** contains multiple names, you must also set the **FOF\_MULTIDESTFILES** flag in the **fFlags** member.</span></span> <span data-ttu-id="38be2-221">Использование **этого параметра зависит от** операции, как описано здесь.</span><span class="sxs-lookup"><span data-stu-id="38be2-221">The usage of **pTo** depends on the operation as described here.</span></span>

-   <span data-ttu-id="38be2-222">Для операций копирования и перемещения, если все файлы будут находиться в одном каталоге, то, что не **будет содержать полное** имя каталога.</span><span class="sxs-lookup"><span data-stu-id="38be2-222">For copy and move operations, if all the files are going to a single directory, **pTo** contains the fully qualified directory name.</span></span> <span data-ttu-id="38be2-223">Если файлы будут находиться в разных назначениях **, то** , в своюмся, они также могут содержать один полный каталог или имя файла для каждого исходного файла.</span><span class="sxs-lookup"><span data-stu-id="38be2-223">If the files are going to different destinations, **pTo** can also contain one fully qualified directory or file name for each source file.</span></span> <span data-ttu-id="38be2-224">Если каталог не существует, система создаст его.</span><span class="sxs-lookup"><span data-stu-id="38be2-224">If a directory does not exist, the system creates it.</span></span>
-   <span data-ttu-id="38be2-225">Для операций переименования в **пфром** **содержится один** полный путь к каждому исходному файлу.</span><span class="sxs-lookup"><span data-stu-id="38be2-225">For rename operations, **pTo** contains one fully qualified path for each source file in **pFrom**.</span></span>
-   <span data-ttu-id="38be2-226">Операции **удаления не используются** .</span><span class="sxs-lookup"><span data-stu-id="38be2-226">For delete operations, **pTo** is not used.</span></span>

### <a name="notifying-the-shell"></a><span data-ttu-id="38be2-227">Уведомление оболочки</span><span class="sxs-lookup"><span data-stu-id="38be2-227">Notifying the Shell</span></span>

<span data-ttu-id="38be2-228">Уведомлять оболочку об изменении после использования [**шфилеоператион**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) для перемещения, копирования, переименования или удаления файлов или после выполнения любых других действий, затрагивающих пространство имен.</span><span class="sxs-lookup"><span data-stu-id="38be2-228">Notify the Shell of the change after using [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to move, copy, rename, or delete files, or after taking any other action that affects the namespace.</span></span> <span data-ttu-id="38be2-229">К действиям, которые должны сопровождаться уведомлением, относятся следующие:</span><span class="sxs-lookup"><span data-stu-id="38be2-229">Actions that should be accompanied by notification include the following:</span></span>

-   <span data-ttu-id="38be2-230">Добавление или удаление файлов или папок.</span><span class="sxs-lookup"><span data-stu-id="38be2-230">Adding or deleting files or folders.</span></span>
-   <span data-ttu-id="38be2-231">Перемещение, копирование или переименование файлов или папок.</span><span class="sxs-lookup"><span data-stu-id="38be2-231">Moving, copying, or renaming files or folders.</span></span>
-   <span data-ttu-id="38be2-232">Изменение сопоставления файлов.</span><span class="sxs-lookup"><span data-stu-id="38be2-232">Changing a file association.</span></span>
-   <span data-ttu-id="38be2-233">Изменение атрибутов файла.</span><span class="sxs-lookup"><span data-stu-id="38be2-233">Changing file attributes.</span></span>
-   <span data-ttu-id="38be2-234">Добавление или удаление дисков или носителей.</span><span class="sxs-lookup"><span data-stu-id="38be2-234">Adding or removing drives or storage media.</span></span>
-   <span data-ttu-id="38be2-235">Создание или отключение общей папки.</span><span class="sxs-lookup"><span data-stu-id="38be2-235">Creating or disabling a shared folder.</span></span>
-   <span data-ttu-id="38be2-236">Изменение списка образов системы.</span><span class="sxs-lookup"><span data-stu-id="38be2-236">Changing the system image list.</span></span>

<span data-ttu-id="38be2-237">Приложение уведомляет оболочку путем вызова [**шчанженотифи**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) с подробными сведениями о том, что изменилось.</span><span class="sxs-lookup"><span data-stu-id="38be2-237">An application notifies the Shell by calling [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) with the details of what has changed.</span></span> <span data-ttu-id="38be2-238">Оболочка может обновить свой образ пространства имен, чтобы точно отразить его новое состояние.</span><span class="sxs-lookup"><span data-stu-id="38be2-238">The Shell can then update its image of the namespace to accurately reflect its new state.</span></span>

## <a name="simple-example-of-managing-files-with-shfileoperation"></a><span data-ttu-id="38be2-239">Простой пример управления файлами с помощью Шфилеоператион</span><span class="sxs-lookup"><span data-stu-id="38be2-239">Simple Example of Managing Files with SHFileOperation</span></span>

<span data-ttu-id="38be2-240">В следующем примере консольного приложения показано использование [**шфилеоператион**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) для копирования файлов из одного каталога в другой.</span><span class="sxs-lookup"><span data-stu-id="38be2-240">The following sample console application illustrates the use of [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to copy files from one directory to another.</span></span> <span data-ttu-id="38be2-241">Исходный и конечный каталоги, C: \\ Мои \_ документы и C: \\ My \_ Docs2, жестко запрограммированы в приложении для простоты.</span><span class="sxs-lookup"><span data-stu-id="38be2-241">The source and destination directories, C:\\My\_Docs and C:\\My\_Docs2, are hard-coded into the application for simplicity.</span></span>


```C++
#include <shlobj.h>
#include <shlwapi.h>
#include <strsafe.h>

int main(void)
{
    IShellFolder *psfDeskTop = NULL;
    IShellFolder *psfDocFiles = NULL;
    LPITEMIDLIST pidlDocFiles = NULL;
    LPITEMIDLIST pidlItems = NULL;
    IEnumIDList *ppenum = NULL;
    SHFILEOPSTRUCT sfo;
    STRRET strDispName;
    TCHAR szParseName[MAX_PATH];
    TCHAR szSourceFiles[256];
    int i;
    int iBufPos = 0;
    ULONG chEaten;
    ULONG celtFetched;
    size_t ParseNameSize = 0;
    HRESULT hr;
    

    szSourceFiles[0] = '\0';
    hr = SHGetDesktopFolder(&psfDeskTop);

    hr = psfDeskTop->ParseDisplayName(NULL, NULL, L"c:\\My_Docs", 
         &chEaten, &pidlDocFiles, NULL);
    hr = psfDeskTop->BindToObject(pidlDocFiles, NULL, IID_IShellFolder, 
         (LPVOID *) &psfDocFiles);
    hr = psfDeskTop->Release();

    hr = psfDocFiles->EnumObjects(NULL,SHCONTF_FOLDERS | SHCONTF_NONFOLDERS, 
         &ppenum);

    while( (hr = ppenum->Next(1,&pidlItems, &celtFetched)) == S_OK 
       && (celtFetched) == 1)
    {
        psfDocFiles->GetDisplayNameOf(pidlItems, SHGDN_FORPARSING, 
            &strDispName);
        StrRetToBuf(&strDispName, pidlItems, szParseName, MAX_PATH);
        
        hr = StringCchLength(szParseName, MAX_PATH, &ParseNameSize);
        
        if (SUCCEEDED(hr))
        {
            for(i=0; i<=ParseNameSize; i++)
            {
                szSourceFiles[iBufPos++] = szParseName[i];
            }
            CoTaskMemFree(pidlItems);
        }
    }
    ppenum->Release();
    
    szSourceFiles[iBufPos] = '\0';

    sfo.hwnd = NULL;
    sfo.wFunc = FO_COPY;
    sfo.pFrom = szSourceFiles;
    sfo.pTo = "c:\\My_Docs2\0";
    sfo.fFlags = FOF_SILENT | FOF_NOCONFIRMATION | FOF_NOCONFIRMMKDIR;

    hr = SHFileOperation(&sfo);
    
    SHChangeNotify(SHCNE_UPDATEDIR, SHCNF_PATH, (LPCVOID) "c:\\My_Docs2", 0);

    CoTaskMemFree(pidlDocFiles);
    psfDocFiles->Release();

    return 0;
}
```



<span data-ttu-id="38be2-242">Приложение сначала получает указатель на интерфейс [**ишеллфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="38be2-242">The application first retrieves a pointer to the desktop's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="38be2-243">Затем он получает ПИДЛ исходного каталога, передавая его полный путь к [**ишеллфолдер::P арседисплайнаме**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span><span class="sxs-lookup"><span data-stu-id="38be2-243">It then retrieves the source directory's PIDL by passing its fully qualified path to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span></span> <span data-ttu-id="38be2-244">Обратите внимание, что **ишеллфолдер::P арседисплайнаме** требует, чтобы путь к каталогу был строкой в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="38be2-244">Note that **IShellFolder::ParseDisplayName** requires the directory's path to be a Unicode string.</span></span> <span data-ttu-id="38be2-245">Затем приложение привязывается к исходному каталогу и использует интерфейс **ишеллфолдер** для получения интерфейса [**иенумидлист**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) объекта перечислителя.</span><span class="sxs-lookup"><span data-stu-id="38be2-245">The application then binds to the source directory and uses its **IShellFolder** interface to retrieve an enumerator object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>

<span data-ttu-id="38be2-246">При перечислении каждого файла в исходном каталоге для получения его имени используется [**ишеллфолдер:: жетдисплайнамеоф**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) .</span><span class="sxs-lookup"><span data-stu-id="38be2-246">As each file in the source directory is enumerated, [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) is used to retrieve its name.</span></span> <span data-ttu-id="38be2-247">\_Установлен флаг шгдн форпарсинг, в результате чего **ишеллфолдер:: жетдисплайнамеоф** возвращает полный путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="38be2-247">The SHGDN\_FORPARSING flag is set, which causes **IShellFolder::GetDisplayNameOf** to return the file's fully qualified path.</span></span> <span data-ttu-id="38be2-248">Пути к файлам, включая завершающие **нуль** -символы, объединяются в один массив *сзсаурцефилес*.</span><span class="sxs-lookup"><span data-stu-id="38be2-248">The file paths, including the terminating **NULL** characters, are concatenated into a single array, *szSourceFiles*.</span></span> <span data-ttu-id="38be2-249">Второй символ **null** добавляется к последнему пути для правильного завершения работы массива.</span><span class="sxs-lookup"><span data-stu-id="38be2-249">A second **NULL** character is appended to the final path to terminate the array properly.</span></span>

<span data-ttu-id="38be2-250">После завершения перечисления приложение присваивает значения структуре [**шфилеопструкт**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) .</span><span class="sxs-lookup"><span data-stu-id="38be2-250">Once the enumeration is complete, the application assigns values to an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure.</span></span> <span data-ttu-id="38be2-251">Обратите внимание, что массив, назначенный **для задания** назначения, должен также завершаться значением Double **null**.</span><span class="sxs-lookup"><span data-stu-id="38be2-251">Note that the array assigned to **pTo** to specify the destination must also be terminated by a double **NULL**.</span></span> <span data-ttu-id="38be2-252">В этом случае он просто включается в строку, которая была назначена без **необходимости.**</span><span class="sxs-lookup"><span data-stu-id="38be2-252">In this case, it is simply included in the string that is assigned to **pTo**.</span></span> <span data-ttu-id="38be2-253">Поскольку это консольное приложение, \_ Флаги ФОФ Silent, ФОФ \_ unconfirm и ФОФ \_ ноконфирммкдир установлены так, чтобы скрывать любые диалоговые окна, которые могут появиться.</span><span class="sxs-lookup"><span data-stu-id="38be2-253">Because this is a console application, the FOF\_SILENT, FOF\_NOCONFIRMATION, and FOF\_NOCONFIRMMKDIR flags are set to suppress any dialog boxes that might appear.</span></span> <span data-ttu-id="38be2-254">После возврата [**шфилеоператион**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) вызывается [**Шчанженотифи**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) для уведомления оболочки об изменении.</span><span class="sxs-lookup"><span data-stu-id="38be2-254">After [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) returns, [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) is called to notify the Shell of the change.</span></span> <span data-ttu-id="38be2-255">Затем приложение выполняет обычную очистку и возвращает.</span><span class="sxs-lookup"><span data-stu-id="38be2-255">Then the application performs the usual cleanup and returns.</span></span>

## <a name="adding-files-to-the-shells-list-of-recent-documents"></a><span data-ttu-id="38be2-256">Добавление файлов в список последних документов оболочки</span><span class="sxs-lookup"><span data-stu-id="38be2-256">Adding Files to the Shell's List of Recent Documents</span></span>

<span data-ttu-id="38be2-257">Оболочка поддерживает список недавно добавленных или измененных документов для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="38be2-257">The Shell maintains a list of recently added or modified documents for each user.</span></span> <span data-ttu-id="38be2-258">Пользователь может отобразить список ссылок на эти файлы, щелкнув документы в меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="38be2-258">The user can display a list of links to these files by clicking Documents on the Start menu.</span></span> <span data-ttu-id="38be2-259">Как и в случае с папкой «Мои документы», у каждого пользователя есть каталог файловой системы для хранения фактических ссылок.</span><span class="sxs-lookup"><span data-stu-id="38be2-259">As with My Documents, each user has a file system directory to hold the actual links.</span></span> <span data-ttu-id="38be2-260">Чтобы получить ПИДЛ от последнего каталога текущего пользователя, приложение может вызвать [**шжетфолдерлокатион**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) с CSid \_ или вызвать [**шжетфолдерпас**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) для получения пути.</span><span class="sxs-lookup"><span data-stu-id="38be2-260">To retrieve the PIDL of the current user's Recent directory, your application can call [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) with CSIDL\_RECENT, or call [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) to retrieve its path.</span></span>

<span data-ttu-id="38be2-261">Приложение может перечислить содержимое папки последних с помощью методик, описанных выше в этом документе.</span><span class="sxs-lookup"><span data-stu-id="38be2-261">Your application can enumerate the contents of the Recent folder using the techniques discussed earlier in this document.</span></span> <span data-ttu-id="38be2-262">Однако приложение не должно изменять содержимое папки так, как будто оно является обычной папкой файловой системы.</span><span class="sxs-lookup"><span data-stu-id="38be2-262">However, an application should not modify the contents of the folder as if it were a normal file system folder.</span></span> <span data-ttu-id="38be2-263">Если это так, то список последних документов оболочки не будет обновляться должным образом, а изменения не будут отражены в меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="38be2-263">If it does so, the Shell's list of recent documents will not be updated properly, and the changes will not be reflected in the Start menu.</span></span> <span data-ttu-id="38be2-264">Вместо этого, чтобы добавить ссылку на документ в папку "последние" пользователя, приложение может вызвать [**шаддторецентдокс**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span><span class="sxs-lookup"><span data-stu-id="38be2-264">Instead, to add a document link to a user's Recent folder, your application can call [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="38be2-265">Оболочка добавит ссылку в соответствующую папку файловой системы, а также обновит список последних документов и меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="38be2-265">The Shell will add a link to the appropriate file system folder, as well as updating its list of recent documents and the Start menu.</span></span> <span data-ttu-id="38be2-266">Эту функцию также можно использовать для очистки папки.</span><span class="sxs-lookup"><span data-stu-id="38be2-266">You can also use this function to clear the folder.</span></span>

 

 
