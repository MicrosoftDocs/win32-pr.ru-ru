---
description: Возможности оболочки можно расширить с помощью записей реестра и ini-файлов.
ms.assetid: 74a81e4f-7357-4901-a118-ba44e8892f25
title: Создание обработчиков расширений оболочки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 991f3c1684b7491e2ad29fae29f48164ffdd47cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104997718"
---
# <a name="creating-shell-extension-handlers"></a><span data-ttu-id="cda6e-103">Создание обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-103">Creating Shell Extension Handlers</span></span>

<span data-ttu-id="cda6e-104">Возможности оболочки можно расширить с помощью записей реестра и ini-файлов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="cda6e-105">Хотя этот подход к расширению оболочки прост и подходит для многих целей, он ограничен.</span><span class="sxs-lookup"><span data-stu-id="cda6e-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="cda6e-106">Например, если вы используете реестр для задания пользовательского значка для типа файла, для каждого файла этого типа будет отображаться один и тот же значок.</span><span class="sxs-lookup"><span data-stu-id="cda6e-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="cda6e-107">Расширение оболочки с помощью реестра не позволяет изменять значки для различных файлов одного типа.</span><span class="sxs-lookup"><span data-stu-id="cda6e-107">Extending the Shell with the registry does not allow you to vary the icon for different files of the same type.</span></span> <span data-ttu-id="cda6e-108">Другие аспекты оболочки, такие как страница свойств « **Свойства** », которая может отображаться при щелчке правой кнопкой мыши, не может быть изменена в реестре.</span><span class="sxs-lookup"><span data-stu-id="cda6e-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="cda6e-109">Более мощный и гибкий подход к расширению оболочки заключается в реализации *обработчиков расширения оболочки*.</span><span class="sxs-lookup"><span data-stu-id="cda6e-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="cda6e-110">Эти обработчики можно реализовать для различных действий, которые может выполнять оболочка.</span><span class="sxs-lookup"><span data-stu-id="cda6e-110">These handlers can be implemented for a variety of actions that the Shell can perform.</span></span> <span data-ttu-id="cda6e-111">Перед выполнением действия оболочка запрашивает обработчик расширения, предоставляя ему возможность изменить действие.</span><span class="sxs-lookup"><span data-stu-id="cda6e-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="cda6e-112">Распространенным примером является обработчик расширения контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="cda6e-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="cda6e-113">Если один из файлов реализуется для типа файла, он запрашивается каждый раз при щелчке правой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="cda6e-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="cda6e-114">Затем обработчик может указать дополнительные пункты меню для каждого файла, а не одинаковый набор для всего типа файлов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for the entire file type.</span></span>

<span data-ttu-id="cda6e-115">В этом документе описывается, как реализовать обработчики расширений, позволяющие изменять различные действия оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-115">This document discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="cda6e-116">Следующие обработчики связаны с определенным типом файла и позволяют указать отдельно для каждого файла:</span><span class="sxs-lookup"><span data-stu-id="cda6e-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis:</span></span>



| <span data-ttu-id="cda6e-117">Обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-117">Handler</span></span>                                               | <span data-ttu-id="cda6e-118">Описание</span><span class="sxs-lookup"><span data-stu-id="cda6e-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="cda6e-119">Обработчик контекстного меню</span><span class="sxs-lookup"><span data-stu-id="cda6e-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="cda6e-120">Вызывается перед отображением контекстного меню файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="cda6e-121">Он позволяет добавлять элементы в контекстное меню для каждого файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="cda6e-122">Обработчик данных</span><span class="sxs-lookup"><span data-stu-id="cda6e-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="cda6e-123">Вызывается при выполнении операции перетаскивания для объектов Драгшелл.</span><span class="sxs-lookup"><span data-stu-id="cda6e-123">Called when a drag-and-drop operation is performed on dragShell objects.</span></span> <span data-ttu-id="cda6e-124">Он позволяет предоставлять дополнительные форматы буфера обмена для целевого объекта перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="cda6e-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                        |
| [<span data-ttu-id="cda6e-125">Удалить обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="cda6e-126">Вызывается, когда объект данных перетаскивается или удаляется в файле.</span><span class="sxs-lookup"><span data-stu-id="cda6e-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="cda6e-127">Он позволяет преобразовать файл в цель перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="cda6e-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="cda6e-128">Обработчик значков</span><span class="sxs-lookup"><span data-stu-id="cda6e-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="cda6e-129">Вызывается перед отображением значка файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="cda6e-130">Он позволяет заменить значок файла по умолчанию на пользовательский значок для каждого файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="cda6e-131">Обработчик страницы свойств</span><span class="sxs-lookup"><span data-stu-id="cda6e-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="cda6e-132">Вызывается перед отображением страницы свойств **Свойства** объекта.</span><span class="sxs-lookup"><span data-stu-id="cda6e-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="cda6e-133">Он позволяет добавлять или заменять страницы.</span><span class="sxs-lookup"><span data-stu-id="cda6e-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="cda6e-134">**Обработчик изображений эскиза**</span><span class="sxs-lookup"><span data-stu-id="cda6e-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="cda6e-135">Предоставляет изображение для представления элемента.</span><span class="sxs-lookup"><span data-stu-id="cda6e-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="cda6e-136">**Обработчик подсказок**</span><span class="sxs-lookup"><span data-stu-id="cda6e-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="cda6e-137">Предоставляет всплывающий текст, когда пользователь наводит указатель мыши на объект.</span><span class="sxs-lookup"><span data-stu-id="cda6e-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="cda6e-138">**Обработчик метаданных**</span><span class="sxs-lookup"><span data-stu-id="cda6e-138">**Metadata handler**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)     | <span data-ttu-id="cda6e-139">Предоставляет доступ на чтение и запись к метаданным (свойствам), хранящимся в файле.</span><span class="sxs-lookup"><span data-stu-id="cda6e-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="cda6e-140">Это можно использовать для расширения подробного представления, инфотипс, страницы свойств и функций группирования.</span><span class="sxs-lookup"><span data-stu-id="cda6e-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="cda6e-141">Другие обработчики не связаны с определенным типом файла, но вызываются перед некоторыми операциями оболочки:</span><span class="sxs-lookup"><span data-stu-id="cda6e-141">Other handlers are not associated with a particular file type but are called before some Shell operations:</span></span>



| <span data-ttu-id="cda6e-142">Обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-142">Handler</span></span>                                                            | <span data-ttu-id="cda6e-143">Описание</span><span class="sxs-lookup"><span data-stu-id="cda6e-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="cda6e-144">Обработчик столбцов</span><span class="sxs-lookup"><span data-stu-id="cda6e-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="cda6e-145">Вызывается проводником Windows перед отображением подробного представления папки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="cda6e-146">Он позволяет добавлять пользовательские столбцы в представление Details.</span><span class="sxs-lookup"><span data-stu-id="cda6e-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="cda6e-147">Копирование обработчика перехватчика</span><span class="sxs-lookup"><span data-stu-id="cda6e-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="cda6e-148">Вызывается, когда объект папки или принтера собирается перемещаться, копироваться, удаляться или переименовываться.</span><span class="sxs-lookup"><span data-stu-id="cda6e-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="cda6e-149">Она позволяет утвердить или отклонить операцию.</span><span class="sxs-lookup"><span data-stu-id="cda6e-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="cda6e-150">Обработчик действия перетаскивания</span><span class="sxs-lookup"><span data-stu-id="cda6e-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="cda6e-151">Вызывается при перетаскивании файла с помощью правой кнопки мыши.</span><span class="sxs-lookup"><span data-stu-id="cda6e-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="cda6e-152">Это позволяет изменить отображаемое контекстное меню.</span><span class="sxs-lookup"><span data-stu-id="cda6e-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="cda6e-153">Обработчик наложения значков</span><span class="sxs-lookup"><span data-stu-id="cda6e-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="cda6e-154">Вызывается перед отображением значка файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="cda6e-155">Он позволяет указать наложение для значка файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="cda6e-156">Поисковый обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="cda6e-157">Вызывается для запуска поисковой системы.</span><span class="sxs-lookup"><span data-stu-id="cda6e-157">Called to launch a search engine.</span></span> <span data-ttu-id="cda6e-158">Она позволяет реализовать пользовательскую подсистему поиска, доступную в меню " **Пуск** " или в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="cda6e-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="cda6e-159">Сведения о реализации конкретных обработчиков расширений описаны в разделах, перечисленных выше.</span><span class="sxs-lookup"><span data-stu-id="cda6e-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="cda6e-160">Оставшаяся часть этого документа охватывает некоторые проблемы реализации, общие для всех обработчиков расширений оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-160">The remainder of this document covers some implementation issues that are common to all Shell extension handlers.</span></span>

-   [<span data-ttu-id="cda6e-161">Реализация обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-161">Implementing Shell Extension Handlers</span></span>](#implementing-shell-extension-handlers)
    -   [<span data-ttu-id="cda6e-162">Реализация IPersistFile</span><span class="sxs-lookup"><span data-stu-id="cda6e-162">Implementing IPersistFile</span></span>](#implementing-ipersistfile)
    -   [<span data-ttu-id="cda6e-163">Реализация Ишеллекстинит</span><span class="sxs-lookup"><span data-stu-id="cda6e-163">Implementing IShellExtInit</span></span>](#implementing-ishellextinit)
    -   [<span data-ttu-id="cda6e-164">Настройка всплывающей подсказки</span><span class="sxs-lookup"><span data-stu-id="cda6e-164">Infotip Customization</span></span>](#infotip-customization)
-   [<span data-ttu-id="cda6e-165">Улучшение поиска Windows с помощью обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-165">Enhancing Windows Search with Shell Extension Handlers</span></span>](#enhancing-windows-search-with-shell-extension-handlers)
-   [<span data-ttu-id="cda6e-166">Регистрация обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-166">Registering Shell Extension Handlers</span></span>](#registering-shell-extension-handlers)
    -   [<span data-ttu-id="cda6e-167">Имена обработчиков</span><span class="sxs-lookup"><span data-stu-id="cda6e-167">Handler Names</span></span>](#handler-names)
    -   [<span data-ttu-id="cda6e-168">Предопределенные объекты оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-168">Predefined Shell Objects</span></span>](#predefined-shell-objects)
    -   [<span data-ttu-id="cda6e-169">Пример регистрации обработчика расширений</span><span class="sxs-lookup"><span data-stu-id="cda6e-169">Example of an Extension Handler Registration</span></span>](#example-of-an-extension-handler-registration)
-   [<span data-ttu-id="cda6e-170">См. также</span><span class="sxs-lookup"><span data-stu-id="cda6e-170">Related topics</span></span>](#related-topics)

## <a name="implementing-shell-extension-handlers"></a><span data-ttu-id="cda6e-171">Реализация обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-171">Implementing Shell Extension Handlers</span></span>

<span data-ttu-id="cda6e-172">Большая часть реализации объекта обработчика расширений оболочки зависит от его типа.</span><span class="sxs-lookup"><span data-stu-id="cda6e-172">Much of the implementation of a Shell extension handler object depends on its type.</span></span> <span data-ttu-id="cda6e-173">Однако есть некоторые распространенные элементы.</span><span class="sxs-lookup"><span data-stu-id="cda6e-173">There are, however, some common elements.</span></span> <span data-ttu-id="cda6e-174">В этом разделе обсуждаются аспекты реализации, совместно используемые всеми обработчиками расширений оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-174">This section discusses those aspects of implementation that are shared by all Shell extension handlers.</span></span>

<span data-ttu-id="cda6e-175">Многие обработчики расширений оболочки — это объекты модели COM.</span><span class="sxs-lookup"><span data-stu-id="cda6e-175">Many Shell extension handlers are in-process Component Object Model (COM) objects.</span></span> <span data-ttu-id="cda6e-176">Им необходимо назначить идентификатор GUID и зарегистрировать, как описано в разделе Регистрация обработчиков расширений оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-176">They must be assigned a GUID and registered as described in Registering Shell Extension Handlers.</span></span> <span data-ttu-id="cda6e-177">Они реализуются в виде библиотек DLL и должны экспортировать следующие стандартные функции:</span><span class="sxs-lookup"><span data-stu-id="cda6e-177">They are implemented as DLLs and must export the following standard functions:</span></span>

-   <span data-ttu-id="cda6e-178">[**DllMain**](../dlls/dllmain.md).</span><span class="sxs-lookup"><span data-stu-id="cda6e-178">[**DllMain**](../dlls/dllmain.md).</span></span> <span data-ttu-id="cda6e-179">Стандартная точка входа для библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cda6e-179">The standard entry point to the DLL.</span></span>
-   <span data-ttu-id="cda6e-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span><span class="sxs-lookup"><span data-stu-id="cda6e-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span></span> <span data-ttu-id="cda6e-181">Предоставляет фабрику класса объекта.</span><span class="sxs-lookup"><span data-stu-id="cda6e-181">Exposes the object's class factory.</span></span>
-   <span data-ttu-id="cda6e-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span><span class="sxs-lookup"><span data-stu-id="cda6e-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span></span> <span data-ttu-id="cda6e-183">COM вызывает эту функцию, чтобы определить, обслуживает ли объект какие-либо клиенты.</span><span class="sxs-lookup"><span data-stu-id="cda6e-183">COM calls this function to determine whether the object is serving any clients.</span></span> <span data-ttu-id="cda6e-184">В противном случае система может выгрузить библиотеку DLL и освободить связанную с ней память.</span><span class="sxs-lookup"><span data-stu-id="cda6e-184">If not, the system can unload the DLL and free the associated memory.</span></span>

<span data-ttu-id="cda6e-185">Как и все COM-объекты, обработчики расширений оболочки должны реализовывать интерфейс [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) и [фабрику классов](../com/implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="cda6e-185">Like all COM objects, Shell extension handlers must implement an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface and a [class factory](../com/implementing-iclassfactory.md).</span></span> <span data-ttu-id="cda6e-186">Большинство обработчиков расширений также должны реализовывать интерфейс [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) или [**ИШЕЛЛЕКСТИНИТ**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) в Windows XP или более ранней версии.</span><span class="sxs-lookup"><span data-stu-id="cda6e-186">Most extension handlers must also implement either an [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface in Windows XP or earlier.</span></span> <span data-ttu-id="cda6e-187">Они были заменены на [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**иинитиализевиситем**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) и [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="cda6e-187">These were replaced by [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) and [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span></span> <span data-ttu-id="cda6e-188">Оболочка использует эти интерфейсы для инициализации обработчика.</span><span class="sxs-lookup"><span data-stu-id="cda6e-188">The Shell uses these interfaces to initialize the handler.</span></span>

<span data-ttu-id="cda6e-189">Интерфейс [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) должен быть реализован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cda6e-189">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="cda6e-190">Обработчики данных</span><span class="sxs-lookup"><span data-stu-id="cda6e-190">Data handlers</span></span>
-   <span data-ttu-id="cda6e-191">Удалить обработчики</span><span class="sxs-lookup"><span data-stu-id="cda6e-191">Drop handlers</span></span>

<span data-ttu-id="cda6e-192">В прошлом Обработчики значков также требовались для реализации [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), но это не так.</span><span class="sxs-lookup"><span data-stu-id="cda6e-192">In the past, icon handlers were also required to implement [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), but this is no longer true.</span></span> <span data-ttu-id="cda6e-193">Для обработчиков значков **IPersistFile** теперь является необязательным, и другие интерфейсы, такие как [**иинитиализевиситем**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) , являются предпочтительными.</span><span class="sxs-lookup"><span data-stu-id="cda6e-193">For icon handlers, **IPersistFile** is now optional and other interfaces such as [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) are preferred.</span></span>

<span data-ttu-id="cda6e-194">Интерфейс [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) должен быть реализован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cda6e-194">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="cda6e-195">Обработчики контекстного меню</span><span class="sxs-lookup"><span data-stu-id="cda6e-195">Shortcut menu handlers</span></span>
-   <span data-ttu-id="cda6e-196">Обработчики перетаскивания</span><span class="sxs-lookup"><span data-stu-id="cda6e-196">Drag-and-drop handlers</span></span>
-   <span data-ttu-id="cda6e-197">Обработчики страницы свойств</span><span class="sxs-lookup"><span data-stu-id="cda6e-197">Property sheet handlers</span></span>

### <a name="implementing-ipersistfile"></a><span data-ttu-id="cda6e-198">Реализация IPersistFile</span><span class="sxs-lookup"><span data-stu-id="cda6e-198">Implementing IPersistFile</span></span>

<span data-ttu-id="cda6e-199">Интерфейс [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) предназначен для того, чтобы объект был загружен или сохранен в файл на диске.</span><span class="sxs-lookup"><span data-stu-id="cda6e-199">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface is intended to permit an object to be loaded from or saved to a disk file.</span></span> <span data-ttu-id="cda6e-200">В нем есть шесть методов в дополнение к [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), пять его собственных и методу [**ClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) , который он наследует от [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span><span class="sxs-lookup"><span data-stu-id="cda6e-200">It has six methods in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), five of its own, and the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) method that it inherits from [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span></span> <span data-ttu-id="cda6e-201">С помощью расширений оболочки **IPersist** используется только для инициализации объекта обработчика расширений оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-201">With Shell extensions, **IPersist** is used only to initialize a Shell extension handler object.</span></span> <span data-ttu-id="cda6e-202">Так как обычно нет необходимости выполнять чтение или запись на диск, только для методов **класса** и метода [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) требуется только реализация без маркера.</span><span class="sxs-lookup"><span data-stu-id="cda6e-202">Because there is typically no need to read from or write to the disk, only the **GetClassID** and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods require a nontoken implementation.</span></span>

<span data-ttu-id="cda6e-203">Оболочка вызывает метод [**ClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) , а функция возвращает идентификатор класса (CLSID) объекта обработчика расширений.</span><span class="sxs-lookup"><span data-stu-id="cda6e-203">The Shell calls [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) first, and the function returns the class identifier (CLSID) of the extension handler object.</span></span> <span data-ttu-id="cda6e-204">Затем оболочка вызывает [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) и передает два значения.</span><span class="sxs-lookup"><span data-stu-id="cda6e-204">The Shell then calls [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) and passes in two values.</span></span> <span data-ttu-id="cda6e-205">Первая, *pszFileName*, представляет собой строку в Юникоде с именем файла или папки, в которой будет выполняться оболочка.</span><span class="sxs-lookup"><span data-stu-id="cda6e-205">The first, *pszFileName*, is a Unicode string with the name of the file or folder that Shell is about to operate on.</span></span> <span data-ttu-id="cda6e-206">Второй — *двмоде*, который указывает режим доступа к файлу.</span><span class="sxs-lookup"><span data-stu-id="cda6e-206">The second is *dwMode*, which indicates the file access mode.</span></span> <span data-ttu-id="cda6e-207">Так как обычно нет необходимости в доступе к файлам, *двмоде* обычно равен нулю.</span><span class="sxs-lookup"><span data-stu-id="cda6e-207">Because there is typically no need to access files, *dwMode* is usually zero.</span></span> <span data-ttu-id="cda6e-208">Метод сохраняет эти значения в соответствии с последующими ссылками.</span><span class="sxs-lookup"><span data-stu-id="cda6e-208">The method stores these values as needed for later reference.</span></span>

<span data-ttu-id="cda6e-209">В следующем фрагменте кода показано, как типичный обработчик расширений оболочки реализует методы класса [**и метода-**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) [**ClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) .</span><span class="sxs-lookup"><span data-stu-id="cda6e-209">The following code fragment illustrates how a typical Shell extension handler implements the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods.</span></span> <span data-ttu-id="cda6e-210">Он предназначен для работы с ANSI или Unicode.</span><span class="sxs-lookup"><span data-stu-id="cda6e-210">It is designed to handle either ANSI or Unicode.</span></span> <span data-ttu-id="cda6e-211">CLSID \_ сампликссандлер — это идентификатор GUID объекта обработчика расширений, а ксампликссандлер — имя класса, используемого для реализации интерфейса.</span><span class="sxs-lookup"><span data-stu-id="cda6e-211">CLSID\_SampleExtHandler is the extension handler object's GUID, and CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="cda6e-212">Переменные **m \_ сзфиленаме** и **m \_ двмоде** являются частными переменными, которые используются для хранения имени файла и флагов доступа.</span><span class="sxs-lookup"><span data-stu-id="cda6e-212">The **m\_szFileName** and **m\_dwMode** variables are private variables that are used to store the file's name and access flags.</span></span>


```C++
wchar_t m_szFileName[MAX_PATH];    // The file name
DWORD m_dwMode;                  // The file access mode

CSampleExtHandler::GetClassID(CLSID *pCLSID)
{
    *pCLSID = CLSID_SampleExtHandler;
}

CSampleExtHandler::Load(PCWSTR pszFile, DWORD dwMode)
{
    m_dwMode = dwMode;
    return StringCchCopy(_szFileName, ARRAYSIZE(m_szFileName), pszFile);
}
```

### <a name="implementing-ishellextinit"></a><span data-ttu-id="cda6e-213">Реализация Ишеллекстинит</span><span class="sxs-lookup"><span data-stu-id="cda6e-213">Implementing IShellExtInit</span></span>

<span data-ttu-id="cda6e-214">Помимо [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), в интерфейсе [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) имеется только один метод, [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span><span class="sxs-lookup"><span data-stu-id="cda6e-214">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface has only one method, [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="cda6e-215">Метод имеет три параметра, которые оболочка может использовать для передачи различных типов данных.</span><span class="sxs-lookup"><span data-stu-id="cda6e-215">The method has three parameters that the Shell can use to pass in various types of information.</span></span> <span data-ttu-id="cda6e-216">Передаваемые значения зависят от типа обработчика, а некоторые могут иметь значение **null**.</span><span class="sxs-lookup"><span data-stu-id="cda6e-216">The values passed in depend on the type of handler, and some can be set to **NULL**.</span></span>

-   <span data-ttu-id="cda6e-217">*пидфолдер* содержит указатель папки на список идентификаторов элементов (Пидл).</span><span class="sxs-lookup"><span data-stu-id="cda6e-217">*pIDFolder* holds a folder's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="cda6e-218">Для расширений таблицы свойств это значение равно **null**.</span><span class="sxs-lookup"><span data-stu-id="cda6e-218">For property sheet extensions, it is **NULL**.</span></span> <span data-ttu-id="cda6e-219">Для расширений контекстного меню это ПИДЛ папки, содержащей элемент, контекстное меню которого отображается.</span><span class="sxs-lookup"><span data-stu-id="cda6e-219">For shortcut menu extensions, it is the PIDL of the folder that contains the item whose shortcut menu is being displayed.</span></span> <span data-ttu-id="cda6e-220">Для обработчиков перетаскивания, не заданных по умолчанию, это ПИДЛ целевой папки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-220">For nondefault drag-and-drop handlers, it is the PIDL of the target folder.</span></span>
-   <span data-ttu-id="cda6e-221">*pDataObject* содержит указатель на интерфейс [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) объекта данных.</span><span class="sxs-lookup"><span data-stu-id="cda6e-221">*pDataObject* holds a pointer to a data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="cda6e-222">Объект данных содержит одно или несколько имен файлов в формате [CF \_ HDROP](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="cda6e-222">The data object holds one or more file names in [CF\_HDROP](dragdrop.md) format.</span></span>
-   <span data-ttu-id="cda6e-223">*хрегкэй* содержит раздел реестра для объекта File или типа Folder.</span><span class="sxs-lookup"><span data-stu-id="cda6e-223">*hRegKey* holds a registry key for the file object or folder type.</span></span>

<span data-ttu-id="cda6e-224">Метод [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) сохраняет имя файла, указатель [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) и раздел реестра, необходимые для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="cda6e-224">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method stores the file name, [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer, and registry key as needed for later use.</span></span> <span data-ttu-id="cda6e-225">В следующем фрагменте кода показана реализация **ишеллекстинит:: Initialize**.</span><span class="sxs-lookup"><span data-stu-id="cda6e-225">The following code fragment illustrates an implementation of **IShellExtInit::Initialize**.</span></span> <span data-ttu-id="cda6e-226">Для простоты в этом примере предполагается, что объект данных содержит только один файл.</span><span class="sxs-lookup"><span data-stu-id="cda6e-226">For simplicity, this example assumes that the data object contains only a single file.</span></span> <span data-ttu-id="cda6e-227">Как правило, он может содержать несколько файлов, которые необходимо извлечь.</span><span class="sxs-lookup"><span data-stu-id="cda6e-227">In general, it might contain multiple files that will each need to be extracted.</span></span>


```C++
LPCITEMIDLIST  m_pIDFolder;           //The folder's PIDL
wchar_t        m_szFile[MAX_PATH];    //The file name
IDataObject   *m_pDataObj;            //The IDataObject pointer
HKEY           m_hRegKey;             //The file or folder's registry key

STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, 
                                   IDataObject *pDataObj, 
                                   HKEY hRegKey) 
{ 
    // If Initialize has already been called, release the old PIDL
    ILFree(m_pIDFolder);
    m_pIDFolder = nullptr;

    // Store the new PIDL.
    if (pIDFolder)
    {
        m_pIDFolder = ILClone(pIDFolder);
    }
    
    // If Initialize has already been called, release the old
    // IDataObject pointer.
    if (m_pDataObj)
    { 
        m_pDataObj->Release(); 
    }
     
    // If a data object pointer was passed in, save it and
    // extract the file name. 
    if (pDataObj) 
    { 
        m_pDataObj = pDataObj; 
        pDataObj->AddRef(); 
      
        STGMEDIUM   medium;
        FORMATETC   fe = {CF_HDROP, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        UINT        uCount;

        if (SUCCEEDED(m_pDataObj->GetData(&fe, &medium)))
        {
            // Get the count of files dropped.
            uCount = DragQueryFile((HDROP)medium.hGlobal, (UINT)-1, NULL, 0);

            // Get the first file name from the CF_HDROP.
            if (uCount)
                DragQueryFile((HDROP)medium.hGlobal, 0, m_szFile, 
                              sizeof(m_szFile)/sizeof(TCHAR));

            ReleaseStgMedium(&medium);
        }
    }

    // Duplicate the registry handle. 
    if (hRegKey) 
        RegOpenKeyEx(hRegKey, nullptr, 0L, MAXIMUM_ALLOWED, &m_hRegKey); 
    return S_OK; 
}
```

<span data-ttu-id="cda6e-228">Ксампликссандлер — имя класса, используемого для реализации интерфейса.</span><span class="sxs-lookup"><span data-stu-id="cda6e-228">CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="cda6e-229">Переменные **m \_ пидфолдер**, **m \_ pDataObject**, **m \_ сзфиленаме** и **m \_ хрегкэй** — это частные переменные, используемые для хранения передаваемых данных.</span><span class="sxs-lookup"><span data-stu-id="cda6e-229">The **m\_pIDFolder**, **m\_pDataObject**, **m\_szFileName**, and **m\_hRegKey** variables are private variables used to store the information that is passed in.</span></span> <span data-ttu-id="cda6e-230">Для простоты в этом примере предполагается, что объект данных будет содержать только одно имя файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-230">For simplicity, this example assumes that only one file name will be held by the data object.</span></span> <span data-ttu-id="cda6e-231">После получения структуры [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) из объекта данных [**драгкуерифиле**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) используется для извлечения имени файла из элемента **Medium. хглобал** структуры **форматетк** .</span><span class="sxs-lookup"><span data-stu-id="cda6e-231">After the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure is retrieved from the data object, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) is used to extract the file name from the **FORMATETC** structure's **medium.hGlobal** member.</span></span> <span data-ttu-id="cda6e-232">Если передается раздел реестра, метод использует код [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) для открытия ключа и присваивает маркер **m \_ хрегкэй**.</span><span class="sxs-lookup"><span data-stu-id="cda6e-232">If a registry key is passed in, the method uses [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) to open the key and assigns the handle to **m\_hRegKey**.</span></span>

### <a name="infotip-customization"></a><span data-ttu-id="cda6e-233">Настройка всплывающей подсказки</span><span class="sxs-lookup"><span data-stu-id="cda6e-233">Infotip Customization</span></span>

<span data-ttu-id="cda6e-234">Существует два способа настройки инфотипс:</span><span class="sxs-lookup"><span data-stu-id="cda6e-234">There are two ways to customize infotips:</span></span>

-   <span data-ttu-id="cda6e-235">Реализуйте объект, который поддерживает [**икуеринфо**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) , а затем зарегистрируйте этот объект в соответствующем подразделе реестра (см. раздел [Регистрация обработчиков расширений оболочки](#registering-shell-extension-handlers) ниже).</span><span class="sxs-lookup"><span data-stu-id="cda6e-235">Implement an object that supports [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) and then register that object under the proper subkey in the registry (see [Registering Shell Extension Handlers](#registering-shell-extension-handlers) below).</span></span>
-   <span data-ttu-id="cda6e-236">Укажите фиксированную строку или список определенных свойств файла для отображения.</span><span class="sxs-lookup"><span data-stu-id="cda6e-236">Specify a fixed string or a list of specific file properties to be displayed.</span></span>

<span data-ttu-id="cda6e-237">Чтобы отобразить фиксированную строку для расширения пространства имен, создайте запись, вызываемую `InfoTip` в разделе *{CLSID}* расширения пространства имен.</span><span class="sxs-lookup"><span data-stu-id="cda6e-237">To display a fixed string for a namespace extension, create an entry called `InfoTip` in the *{CLSID}* key of your namespace extension.</span></span> <span data-ttu-id="cda6e-238">Задайте в качестве значения этой записи либо литеральную строку, которую нужно отобразить, как показано в этом примере, либо косвенную строку, указывающую ресурс и индекс в этом ресурсе (в целях локализации).</span><span class="sxs-lookup"><span data-stu-id="cda6e-238">Set the value of that entry to be either the literal string you want to display, as shown in this example, or an indirect string that specifies a resource and index within that resource (for localization purposes).</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {CLSID}
         InfoTip = InfoTip string for your namespace extension
```

<span data-ttu-id="cda6e-239">Чтобы отобразить фиксированную строку для типа файла, создайте запись, вызываемую `InfoTip` в ключе *ProgID* этого типа файлов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-239">To display a fixed string for a file type, create an entry called `InfoTip` in the *ProgID* key of that file type.</span></span> <span data-ttu-id="cda6e-240">Задайте в качестве значения этой записи либо литеральную строку, которую нужно отобразить, либо косвенную строку, указывающую ресурс и индекс в этом ресурсе (в целях локализации), как показано в этом примере.</span><span class="sxs-lookup"><span data-stu-id="cda6e-240">Set the value of that entry to be either the literal string you want to display or an indirect string that specifies a resource and index within that resource (for localization purposes), as shown in this example.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = Resource.dll, 3
```

<span data-ttu-id="cda6e-241">Если требуется, чтобы оболочка отображала определенные свойства файла в подсказке для конкретного типа файлов, создайте запись с именем `InfoTip` в разделе *ProgID* для этого типа файлов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-241">If you want the Shell to display specific file properties in the infotip for a specific file type, create an entry called `InfoTip` in the *ProgID* key for that file type.</span></span> <span data-ttu-id="cda6e-242">Установите значение этой записи в виде разделенного точкой с запятой списка канонических имен свойств, идентификаторов FMTID (PID) или и того, и другого.</span><span class="sxs-lookup"><span data-stu-id="cda6e-242">Set the value of that entry to be a semicolon-delineated list of canonical property names, format identifier (FMTID)/property identifier (PID) pairs, or both.</span></span> <span data-ttu-id="cda6e-243">Это значение должно начинаться с "Prop:", чтобы обозначить его как строку со списком свойств.</span><span class="sxs-lookup"><span data-stu-id="cda6e-243">This value must begin with "prop:" to identify it as a property list string.</span></span> <span data-ttu-id="cda6e-244">Если опустить "Prop:", значение будет представлено в виде литеральной строки и отображаться таким образом.</span><span class="sxs-lookup"><span data-stu-id="cda6e-244">If you omit "prop:", the value is seen as a literal string and displayed as such.</span></span>

<span data-ttu-id="cda6e-245">В следующем примере *пропнаме* — это каноническое имя свойства (например, System. Date) и *{fmtid}, PID* — это пара [**fmtid/PID**](./objects.md) .</span><span class="sxs-lookup"><span data-stu-id="cda6e-245">In the following example, *propname* is a canonical property name (such as System.Date) and *{fmtid},pid* is an [**FMTID/PID**](./objects.md) pair.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = prop:propname;propname;{fmtid},pid;{fmtid},pid
```

<span data-ttu-id="cda6e-246">Можно использовать следующие имена свойств:</span><span class="sxs-lookup"><span data-stu-id="cda6e-246">The following property names can be used:</span></span>



| <span data-ttu-id="cda6e-247">Имя свойства</span><span class="sxs-lookup"><span data-stu-id="cda6e-247">Property Name</span></span>    | <span data-ttu-id="cda6e-248">Описание</span><span class="sxs-lookup"><span data-stu-id="cda6e-248">Description</span></span>                   | <span data-ttu-id="cda6e-249">Получено из</span><span class="sxs-lookup"><span data-stu-id="cda6e-249">Retrieved From</span></span>                                                                             |
|------------------|-------------------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="cda6e-250">Автор</span><span class="sxs-lookup"><span data-stu-id="cda6e-250">Author</span></span>           | <span data-ttu-id="cda6e-251">Автор документа</span><span class="sxs-lookup"><span data-stu-id="cda6e-251">Author of the document</span></span>        | [<span data-ttu-id="cda6e-252">**\_Автор пидси**</span><span class="sxs-lookup"><span data-stu-id="cda6e-252">**PIDSI\_AUTHOR**</span></span>](../stg/the-summary-information-property-set.md)                              |
| <span data-ttu-id="cda6e-253">Заголовок</span><span class="sxs-lookup"><span data-stu-id="cda6e-253">Title</span></span>            | <span data-ttu-id="cda6e-254">Название документа</span><span class="sxs-lookup"><span data-stu-id="cda6e-254">Title of the document</span></span>         | [<span data-ttu-id="cda6e-255">**\_заголовок пидси**</span><span class="sxs-lookup"><span data-stu-id="cda6e-255">**PIDSI\_TITLE**</span></span>](../stg/the-summary-information-property-set.md)                               |
| <span data-ttu-id="cda6e-256">Субъект</span><span class="sxs-lookup"><span data-stu-id="cda6e-256">Subject</span></span>          | <span data-ttu-id="cda6e-257">Сводка по теме</span><span class="sxs-lookup"><span data-stu-id="cda6e-257">Subject summary</span></span>               | [<span data-ttu-id="cda6e-258">**\_Тема пидси**</span><span class="sxs-lookup"><span data-stu-id="cda6e-258">**PIDSI\_SUBJECT**</span></span>](../stg/the-summary-information-property-set.md)                             |
| <span data-ttu-id="cda6e-259">Комментировать</span><span class="sxs-lookup"><span data-stu-id="cda6e-259">Comment</span></span>          | <span data-ttu-id="cda6e-260">Комментарии к документу</span><span class="sxs-lookup"><span data-stu-id="cda6e-260">Document comments</span></span>             | <span data-ttu-id="cda6e-261">[**Пидси \_ Свойства комментария**](../stg/the-summary-information-property-set.md) или папки/драйвера</span><span class="sxs-lookup"><span data-stu-id="cda6e-261">[**PIDSI\_COMMENT**](../stg/the-summary-information-property-set.md) or folder/driver properties</span></span> |
| <span data-ttu-id="cda6e-262">PageCount</span><span class="sxs-lookup"><span data-stu-id="cda6e-262">PageCount</span></span>        | <span data-ttu-id="cda6e-263">Количество страниц</span><span class="sxs-lookup"><span data-stu-id="cda6e-263">Number of pages</span></span>               | [<span data-ttu-id="cda6e-264">**ПИДСИ \_ PAGECOUNT**</span><span class="sxs-lookup"><span data-stu-id="cda6e-264">**PIDSI\_PAGECOUNT**</span></span>](../stg/the-summary-information-property-set.md)                           |
| <span data-ttu-id="cda6e-265">Имя</span><span class="sxs-lookup"><span data-stu-id="cda6e-265">Name</span></span>             | <span data-ttu-id="cda6e-266">Понятное имя</span><span class="sxs-lookup"><span data-stu-id="cda6e-266">Friendly name</span></span>                 | <span data-ttu-id="cda6e-267">Стандартное представление папки</span><span class="sxs-lookup"><span data-stu-id="cda6e-267">Standard folder view</span></span>                                                                       |
| <span data-ttu-id="cda6e-268">оригиналлокатион</span><span class="sxs-lookup"><span data-stu-id="cda6e-268">OriginalLocation</span></span> | <span data-ttu-id="cda6e-269">Расположение исходного файла</span><span class="sxs-lookup"><span data-stu-id="cda6e-269">Location of original file</span></span>     | <span data-ttu-id="cda6e-270">Папка "портфель" и папка "Корзина"</span><span class="sxs-lookup"><span data-stu-id="cda6e-270">Briefcase folder and Recycle Bin folder</span></span>                                                    |
| <span data-ttu-id="cda6e-271">датеделетед</span><span class="sxs-lookup"><span data-stu-id="cda6e-271">DateDeleted</span></span>      | <span data-ttu-id="cda6e-272">Файл даты удален</span><span class="sxs-lookup"><span data-stu-id="cda6e-272">Date file was deleted</span></span>         | <span data-ttu-id="cda6e-273">Папка корзины</span><span class="sxs-lookup"><span data-stu-id="cda6e-273">Recycle Bin folder</span></span>                                                                         |
| <span data-ttu-id="cda6e-274">Тип</span><span class="sxs-lookup"><span data-stu-id="cda6e-274">Type</span></span>             | <span data-ttu-id="cda6e-275">Тип файла</span><span class="sxs-lookup"><span data-stu-id="cda6e-275">Type of file</span></span>                  | <span data-ttu-id="cda6e-276">Представление сведений о стандартной папке</span><span class="sxs-lookup"><span data-stu-id="cda6e-276">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="cda6e-277">Размер</span><span class="sxs-lookup"><span data-stu-id="cda6e-277">Size</span></span>             | <span data-ttu-id="cda6e-278">Размер файла</span><span class="sxs-lookup"><span data-stu-id="cda6e-278">Size of file</span></span>                  | <span data-ttu-id="cda6e-279">Представление сведений о стандартной папке</span><span class="sxs-lookup"><span data-stu-id="cda6e-279">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="cda6e-280">синккопин</span><span class="sxs-lookup"><span data-stu-id="cda6e-280">SyncCopyIn</span></span>       | <span data-ttu-id="cda6e-281">То же, что и Оригиналлокатион</span><span class="sxs-lookup"><span data-stu-id="cda6e-281">Same as OriginalLocation</span></span>      | <span data-ttu-id="cda6e-282">То же, что и Оригиналлокатион</span><span class="sxs-lookup"><span data-stu-id="cda6e-282">Same as OriginalLocation</span></span>                                                                   |
| <span data-ttu-id="cda6e-283">Изменен</span><span class="sxs-lookup"><span data-stu-id="cda6e-283">Modified</span></span>         | <span data-ttu-id="cda6e-284">Дата последнего изменения</span><span class="sxs-lookup"><span data-stu-id="cda6e-284">Date last modified</span></span>            | <span data-ttu-id="cda6e-285">Представление сведений о стандартной папке</span><span class="sxs-lookup"><span data-stu-id="cda6e-285">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="cda6e-286">Создание</span><span class="sxs-lookup"><span data-stu-id="cda6e-286">Created</span></span>          | <span data-ttu-id="cda6e-287">Дата создания</span><span class="sxs-lookup"><span data-stu-id="cda6e-287">Date created</span></span>                  | <span data-ttu-id="cda6e-288">Представление сведений о стандартной папке</span><span class="sxs-lookup"><span data-stu-id="cda6e-288">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="cda6e-289">Обращения</span><span class="sxs-lookup"><span data-stu-id="cda6e-289">Accessed</span></span>         | <span data-ttu-id="cda6e-290">Дата последнего доступа</span><span class="sxs-lookup"><span data-stu-id="cda6e-290">Date last accessed</span></span>            | <span data-ttu-id="cda6e-291">Представление сведений о стандартной папке</span><span class="sxs-lookup"><span data-stu-id="cda6e-291">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="cda6e-292">Папка</span><span class="sxs-lookup"><span data-stu-id="cda6e-292">InFolder</span></span>         | <span data-ttu-id="cda6e-293">Каталог, содержащий файл</span><span class="sxs-lookup"><span data-stu-id="cda6e-293">Directory containing the file</span></span> | <span data-ttu-id="cda6e-294">Результаты поиска документов</span><span class="sxs-lookup"><span data-stu-id="cda6e-294">Document search results</span></span>                                                                    |
| <span data-ttu-id="cda6e-295">Ранг</span><span class="sxs-lookup"><span data-stu-id="cda6e-295">Rank</span></span>             | <span data-ttu-id="cda6e-296">Соответствие качества поиска</span><span class="sxs-lookup"><span data-stu-id="cda6e-296">Quality of search match</span></span>       | <span data-ttu-id="cda6e-297">Результаты поиска документов</span><span class="sxs-lookup"><span data-stu-id="cda6e-297">Document search results</span></span>                                                                    |
| <span data-ttu-id="cda6e-298">FreeSpace</span><span class="sxs-lookup"><span data-stu-id="cda6e-298">FreeSpace</span></span>        | <span data-ttu-id="cda6e-299">Доступное дисковое пространство</span><span class="sxs-lookup"><span data-stu-id="cda6e-299">Available storage space</span></span>       | <span data-ttu-id="cda6e-300">Диски</span><span class="sxs-lookup"><span data-stu-id="cda6e-300">Disk drives</span></span>                                                                                |
| <span data-ttu-id="cda6e-301">NumberOfVisits</span><span class="sxs-lookup"><span data-stu-id="cda6e-301">NumberOfVisits</span></span>   | <span data-ttu-id="cda6e-302">Количество посещений</span><span class="sxs-lookup"><span data-stu-id="cda6e-302">Number of visits</span></span>              | <span data-ttu-id="cda6e-303">Папка "Избранное"</span><span class="sxs-lookup"><span data-stu-id="cda6e-303">Favorites folder</span></span>                                                                           |
| <span data-ttu-id="cda6e-304">Атрибуты</span><span class="sxs-lookup"><span data-stu-id="cda6e-304">Attributes</span></span>       | <span data-ttu-id="cda6e-305">Атрибуты файла</span><span class="sxs-lookup"><span data-stu-id="cda6e-305">File Attributes</span></span>               | <span data-ttu-id="cda6e-306">Представление сведений о стандартной папке</span><span class="sxs-lookup"><span data-stu-id="cda6e-306">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="cda6e-307">Company</span><span class="sxs-lookup"><span data-stu-id="cda6e-307">Company</span></span>          | <span data-ttu-id="cda6e-308">Название организации</span><span class="sxs-lookup"><span data-stu-id="cda6e-308">Company name</span></span>                  | [<span data-ttu-id="cda6e-309">**\_компания пиддси**</span><span class="sxs-lookup"><span data-stu-id="cda6e-309">**PIDDSI\_COMPANY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)    |
| <span data-ttu-id="cda6e-310">Category</span><span class="sxs-lookup"><span data-stu-id="cda6e-310">Category</span></span>         | <span data-ttu-id="cda6e-311">Категория документа</span><span class="sxs-lookup"><span data-stu-id="cda6e-311">Document category</span></span>             | [<span data-ttu-id="cda6e-312">**\_Категория пиддси**</span><span class="sxs-lookup"><span data-stu-id="cda6e-312">**PIDDSI\_CATEGORY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)   |
| <span data-ttu-id="cda6e-313">Авторские права</span><span class="sxs-lookup"><span data-stu-id="cda6e-313">Copyright</span></span>        | <span data-ttu-id="cda6e-314">Авторские права на мультимедиа</span><span class="sxs-lookup"><span data-stu-id="cda6e-314">Media copyright</span></span>               | [<span data-ttu-id="cda6e-315">**ПИДМСИ \_ авторские права**</span><span class="sxs-lookup"><span data-stu-id="cda6e-315">**PIDMSI\_COPYRIGHT**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)  |
| <span data-ttu-id="cda6e-316">хтмлинфотипфиле</span><span class="sxs-lookup"><span data-stu-id="cda6e-316">HTMLInfoTipFile</span></span>  | <span data-ttu-id="cda6e-317">Файл всплывающей подсказки HTML</span><span class="sxs-lookup"><span data-stu-id="cda6e-317">HTML InfoTip file</span></span>             | <span data-ttu-id="cda6e-318">Файл Desktop.ini для папки</span><span class="sxs-lookup"><span data-stu-id="cda6e-318">Desktop.ini file for folder</span></span>                                                                |



 

## <a name="enhancing-windows-search-with-shell-extension-handlers"></a><span data-ttu-id="cda6e-319">Улучшение поиска Windows с помощью обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-319">Enhancing Windows Search with Shell Extension Handlers</span></span>

<span data-ttu-id="cda6e-320">Обработчики расширений оболочки могут использоваться для улучшения пользовательского интерфейса, предоставляемого обработчиком протокола поиска Windows.</span><span class="sxs-lookup"><span data-stu-id="cda6e-320">Shell extension handlers may be used to enhance the user experience provided by a Windows Search protocol handler.</span></span> <span data-ttu-id="cda6e-321">Чтобы включить такие улучшения, необходимо разработать вспомогательный обработчик расширения оболочки для интеграции с обработчиком протокола поиска в качестве источника данных.</span><span class="sxs-lookup"><span data-stu-id="cda6e-321">To enable such enhancements, the supporting Shell extension handler must be designed to integrate with the search protocol handler as a data source.</span></span> <span data-ttu-id="cda6e-322">Сведения о расширении обработчика протокола поиска Windows с помощью интеграции с обработчиком расширений оболочки см. в разделе [Добавление значков, предварительных версий и контекстных меню](../search/-search-3x-wds-ph-ui-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="cda6e-322">For information about how to enhance a Windows Search protocol handler through integration with a Shell extension handler, see [Adding Icons, Previews and Shortcut Menus](../search/-search-3x-wds-ph-ui-extensions.md).</span></span> <span data-ttu-id="cda6e-323">Дополнительные сведения о обработчиках протоколов поиска Windows см. в разделе [Разработка обработчиков протоколов](../search/-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="cda6e-323">For more information about Windows Search protocol handlers, see [Developing Protocol Handlers](../search/-search-3x-wds-phaddins.md).</span></span>

## <a name="registering-shell-extension-handlers"></a><span data-ttu-id="cda6e-324">Регистрация обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-324">Registering Shell Extension Handlers</span></span>

<span data-ttu-id="cda6e-325">Прежде чем оболочку сможет его использовать, необходимо зарегистрировать объект обработчика расширения оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-325">A Shell extension handler object must be registered before the Shell can use it.</span></span> <span data-ttu-id="cda6e-326">В этом разделе показано общее описание регистрации обработчика расширения оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-326">This section is a general discussion of how to register a Shell extension handler.</span></span>

<span data-ttu-id="cda6e-327">Каждый раз при создании или изменении обработчика расширений оболочки важно уведомить систему, что вы внесли изменение в [**шчанженотифи**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), указав событие **шкне \_ ассокчанжед** .</span><span class="sxs-lookup"><span data-stu-id="cda6e-327">Any time you create or change a Shell extension handler, it is important to notify the system that you have made a change with [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specifying the **SHCNE\_ASSOCCHANGED** event.</span></span> <span data-ttu-id="cda6e-328">Если не вызвать **шчанженотифи**, изменение может быть не распознано, пока система не будет перезагружена.</span><span class="sxs-lookup"><span data-stu-id="cda6e-328">If you do not call **SHChangeNotify**, the change might not be recognized until the system is rebooted.</span></span>

<span data-ttu-id="cda6e-329">Как и для всех COM-объектов, необходимо создать идентификатор GUID для обработчика с помощью такого средства, как UUIDGEN.exe.</span><span class="sxs-lookup"><span data-stu-id="cda6e-329">As with all COM objects, you must create a GUID for the handler using a tool such as UUIDGEN.exe.</span></span> <span data-ttu-id="cda6e-330">Создайте ключ в разделе **\_ классы hKey \_ root** \\ **CLSID** , имя которого является строковым форматом GUID.</span><span class="sxs-lookup"><span data-stu-id="cda6e-330">Create a key under **HKEY\_CLASSES\_ROOT**\\**CLSID** whose name is the string form of the GUID.</span></span> <span data-ttu-id="cda6e-331">Так как обработчики расширений оболочки являются внутрипроцессного серверами, необходимо создать ключ **InprocServer32** в ключе GUID со значением по умолчанию, равным пути к DLL-файлу обработчика.</span><span class="sxs-lookup"><span data-stu-id="cda6e-331">Because Shell extension handlers are in-process servers, you must create an **InProcServer32** key under the GUID key with the default value set to the path of the handler's DLL.</span></span> <span data-ttu-id="cda6e-332">Используйте модель потоков подразделений.</span><span class="sxs-lookup"><span data-stu-id="cda6e-332">Use the Apartment threading model.</span></span>

<span data-ttu-id="cda6e-333">Каждый раз, когда оболочка принимает действие, которое может задействовать обработчик расширения оболочки, он проверяет соответствующий раздел реестра.</span><span class="sxs-lookup"><span data-stu-id="cda6e-333">Any time the Shell takes an action that can involve a Shell extension handler, it checks the appropriate registry key.</span></span> <span data-ttu-id="cda6e-334">Ключ, с которым зарегистрирован обработчик расширений, позволяет управлять тем, когда он будет вызываться.</span><span class="sxs-lookup"><span data-stu-id="cda6e-334">The key under which an extension handler is registered thus controls when it will be called.</span></span> <span data-ttu-id="cda6e-335">Например, при отображении оболочкой контекстного меню для элемента [типа файла](fa-file-types.md)обычно вызывается обработчик контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="cda6e-335">For instance, it is a common practice to have a shortcut menu handler called when the Shell displays a shortcut menu for a member of a [file type](fa-file-types.md).</span></span> <span data-ttu-id="cda6e-336">В этом случае обработчик должен быть зарегистрирован в ключе **ProgID** типа файла.</span><span class="sxs-lookup"><span data-stu-id="cda6e-336">In this case, the handler must be registered under the file type's **ProgID** key.</span></span>

### <a name="handler-names"></a><span data-ttu-id="cda6e-337">Имена обработчиков</span><span class="sxs-lookup"><span data-stu-id="cda6e-337">Handler Names</span></span>

<span data-ttu-id="cda6e-338">Чтобы включить обработчик расширений оболочки, создайте подраздел с именем подраздела обработчика (см. ниже) в подразделе **шеллекс** (для типов файлов) **или в имени** типа объекта оболочки (для [предопределенных объектов оболочки](#predefined-shell-objects)).</span><span class="sxs-lookup"><span data-stu-id="cda6e-338">To enable a Shell extension handler, create a subkey with the handler subkey name (see below) under the **ShellEx** subkey of either the **ProgID** (for file types) or the Shell object type name (for [Predefined Shell Objects](#predefined-shell-objects)).</span></span>

<span data-ttu-id="cda6e-339">Например, если вы хотите зарегистрировать обработчик расширения контекстного меню для MyProgram. 1, начните с создания следующего подраздела:</span><span class="sxs-lookup"><span data-stu-id="cda6e-339">For example, if you wanted to register a shortcut menu extension handler for MyProgram.1, you would begin by creating the following subkey:</span></span>

```
HKEY_CLASSES_ROOT
   MyProgram.1
      ShellEx
         ContextMenuHandlers
```

<span data-ttu-id="cda6e-340">Для следующих обработчиков создайте подраздел под ключом "имя подраздела обработчика", имя которого является строковой версией CLSID расширения оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-340">For the following handlers, create a subkey underneath the "Handler Subkey name" key whose name is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="cda6e-341">Несколько расширений можно зарегистрировать с помощью ключа имени подраздела обработчика, создав несколько подразделов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-341">Multiple extensions can be registered under the handler subkey name key by creating multiple subkeys.</span></span>



| <span data-ttu-id="cda6e-342">Обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-342">Handler</span></span>                                               | <span data-ttu-id="cda6e-343">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="cda6e-343">Interface</span></span>          | <span data-ttu-id="cda6e-344">Имя подраздела обработчика</span><span class="sxs-lookup"><span data-stu-id="cda6e-344">Handler Subkey Name</span></span>       |
|-------------------------------------------------------|--------------------|---------------------------|
| <span data-ttu-id="cda6e-345">Обработчик контекстного меню</span><span class="sxs-lookup"><span data-stu-id="cda6e-345">Shortcut menu handler</span></span>                                 | <span data-ttu-id="cda6e-346">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="cda6e-346">IContextMenu</span></span>       | <span data-ttu-id="cda6e-347">**контекстменухандлерс**</span><span class="sxs-lookup"><span data-stu-id="cda6e-347">**ContextMenuHandlers**</span></span>   |
| <span data-ttu-id="cda6e-348">Обработчик копихук</span><span class="sxs-lookup"><span data-stu-id="cda6e-348">Copyhook handler</span></span>                                      | <span data-ttu-id="cda6e-349">икопихук</span><span class="sxs-lookup"><span data-stu-id="cda6e-349">ICopyHook</span></span>          | <span data-ttu-id="cda6e-350">**копихукхандлерс**</span><span class="sxs-lookup"><span data-stu-id="cda6e-350">**CopyHookHandlers**</span></span>      |
| <span data-ttu-id="cda6e-351">Обработчик действия перетаскивания</span><span class="sxs-lookup"><span data-stu-id="cda6e-351">Drag-and-drop handler</span></span>                                 | <span data-ttu-id="cda6e-352">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="cda6e-352">IContextMenu</span></span>       | <span data-ttu-id="cda6e-353">**драгдрофандлерс**</span><span class="sxs-lookup"><span data-stu-id="cda6e-353">**DragDropHandlers**</span></span>      |
| <span data-ttu-id="cda6e-354">Обработчик страницы свойств</span><span class="sxs-lookup"><span data-stu-id="cda6e-354">Property sheet handler</span></span>                                | <span data-ttu-id="cda6e-355">ишеллпропшитекст</span><span class="sxs-lookup"><span data-stu-id="cda6e-355">IShellPropSheetExt</span></span> | <span data-ttu-id="cda6e-356">**пропертишисандлерс**</span><span class="sxs-lookup"><span data-stu-id="cda6e-356">**PropertySheetHandlers**</span></span> |
| <span data-ttu-id="cda6e-357">Обработчик поставщика столбцов (не рекомендуется в Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="cda6e-357">Column provider handler (deprecated in Windows Vista)</span></span> | <span data-ttu-id="cda6e-358">иколумнпровидер</span><span class="sxs-lookup"><span data-stu-id="cda6e-358">IColumnProvider</span></span>    | <span data-ttu-id="cda6e-359">**колумнхандлерс**</span><span class="sxs-lookup"><span data-stu-id="cda6e-359">**ColumnHandlers**</span></span>        |



 

<span data-ttu-id="cda6e-360">Для следующих обработчиков значение по умолчанию ключа "имя подраздела обработчика" является строковой версией CLSID расширения оболочки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-360">For the following handlers, the default value of the "Handler Subkey Name" key is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="cda6e-361">Для этих обработчиков можно зарегистрировать только одно расширение.</span><span class="sxs-lookup"><span data-stu-id="cda6e-361">Only one extension can be registered for these handlers.</span></span>



| <span data-ttu-id="cda6e-362">Обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-362">Handler</span></span>                 | <span data-ttu-id="cda6e-363">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="cda6e-363">Interface</span></span>                                         | <span data-ttu-id="cda6e-364">Имя подраздела обработчика</span><span class="sxs-lookup"><span data-stu-id="cda6e-364">Handler Subkey Name</span></span>                        |
|-------------------------|---------------------------------------------------|--------------------------------------------|
| <span data-ttu-id="cda6e-365">Обработчик данных</span><span class="sxs-lookup"><span data-stu-id="cda6e-365">Data handler</span></span>            | <span data-ttu-id="cda6e-366">IDataObject</span><span class="sxs-lookup"><span data-stu-id="cda6e-366">IDataObject</span></span>                                       | <span data-ttu-id="cda6e-367">**DataHandler**</span><span class="sxs-lookup"><span data-stu-id="cda6e-367">**DataHandler**</span></span>                            |
| <span data-ttu-id="cda6e-368">Удалить обработчик</span><span class="sxs-lookup"><span data-stu-id="cda6e-368">Drop handler</span></span>            | <span data-ttu-id="cda6e-369">Интерфейс IDropTarget</span><span class="sxs-lookup"><span data-stu-id="cda6e-369">IDropTarget</span></span>                                       | <span data-ttu-id="cda6e-370">**дрофандлер**</span><span class="sxs-lookup"><span data-stu-id="cda6e-370">**DropHandler**</span></span>                            |
| <span data-ttu-id="cda6e-371">Обработчик значков</span><span class="sxs-lookup"><span data-stu-id="cda6e-371">Icon handler</span></span>            | <span data-ttu-id="cda6e-372">Иекстрактикона/W</span><span class="sxs-lookup"><span data-stu-id="cda6e-372">IExtractIconA/W</span></span>                                   | <span data-ttu-id="cda6e-373">**иконхандлер**</span><span class="sxs-lookup"><span data-stu-id="cda6e-373">**IconHandler**</span></span>                            |
| <span data-ttu-id="cda6e-374">Обработчик изображений</span><span class="sxs-lookup"><span data-stu-id="cda6e-374">Image handler</span></span>           | <span data-ttu-id="cda6e-375">иекстрактимаже</span><span class="sxs-lookup"><span data-stu-id="cda6e-375">IExtractImage</span></span>                                     | <span data-ttu-id="cda6e-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span></span> |
| <span data-ttu-id="cda6e-377">Обработчик изображений эскиза</span><span class="sxs-lookup"><span data-stu-id="cda6e-377">Thumbnail image handler</span></span> | <span data-ttu-id="cda6e-378">исумбнаилпровидер</span><span class="sxs-lookup"><span data-stu-id="cda6e-378">IThumbnailProvider</span></span>                                | <span data-ttu-id="cda6e-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span></span> |
| <span data-ttu-id="cda6e-380">Обработчик подсказок</span><span class="sxs-lookup"><span data-stu-id="cda6e-380">Infotip handler</span></span>         | <span data-ttu-id="cda6e-381">икуеринфо</span><span class="sxs-lookup"><span data-stu-id="cda6e-381">IQueryInfo</span></span>                                        | <span data-ttu-id="cda6e-382">**{00021500-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-382">**{00021500-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="cda6e-383">Ссылка на оболочку (ANSI)</span><span class="sxs-lookup"><span data-stu-id="cda6e-383">Shell link (ANSI )</span></span>      | <span data-ttu-id="cda6e-384">ишелллинка</span><span class="sxs-lookup"><span data-stu-id="cda6e-384">IShellLinkA</span></span>                                       | <span data-ttu-id="cda6e-385">**{000214EE-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-385">**{000214EE-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="cda6e-386">Ссылка на оболочку (Юникод)</span><span class="sxs-lookup"><span data-stu-id="cda6e-386">Shell link (UNICODE)</span></span>    | <span data-ttu-id="cda6e-387">ишелллинкв</span><span class="sxs-lookup"><span data-stu-id="cda6e-387">IShellLinkW</span></span>                                       | <span data-ttu-id="cda6e-388">**{000214F9-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-388">**{000214F9-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="cda6e-389">Структурированное хранилище</span><span class="sxs-lookup"><span data-stu-id="cda6e-389">Structured storage</span></span>      | <span data-ttu-id="cda6e-390">Метод IStorage</span><span class="sxs-lookup"><span data-stu-id="cda6e-390">IStorage</span></span>                                          | <span data-ttu-id="cda6e-391">**{0000000B-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-391">**{0000000B-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="cda6e-392">Метаданные</span><span class="sxs-lookup"><span data-stu-id="cda6e-392">Metadata</span></span>                | <span data-ttu-id="cda6e-393">ипропертисторе</span><span class="sxs-lookup"><span data-stu-id="cda6e-393">IPropertyStore</span></span>                                    | <span data-ttu-id="cda6e-394">**пропертихандлер**</span><span class="sxs-lookup"><span data-stu-id="cda6e-394">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="cda6e-395">Метаданные</span><span class="sxs-lookup"><span data-stu-id="cda6e-395">Metadata</span></span>                | <span data-ttu-id="cda6e-396">IPropertySetStorage (не рекомендуется в Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="cda6e-396">IPropertySetStorage (deprecated in Windows Vista)</span></span> | <span data-ttu-id="cda6e-397">**пропертихандлер**</span><span class="sxs-lookup"><span data-stu-id="cda6e-397">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="cda6e-398">Закрепить в меню "Пуск"</span><span class="sxs-lookup"><span data-stu-id="cda6e-398">Pin to Start Menu</span></span>       | <span data-ttu-id="cda6e-399">истартменупиннедлист</span><span class="sxs-lookup"><span data-stu-id="cda6e-399">IStartMenuPinnedList</span></span>                              | <span data-ttu-id="cda6e-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span></span> |
| <span data-ttu-id="cda6e-401">Закрепление на панели задач</span><span class="sxs-lookup"><span data-stu-id="cda6e-401">Pin to Taskbar</span></span>          |                                                   | <span data-ttu-id="cda6e-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span><span class="sxs-lookup"><span data-stu-id="cda6e-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span></span> |



 

<span data-ttu-id="cda6e-403">Подразделы, указанные для добавления **закрепления в меню "Пуск** " и " **закрепить на панели задач** " в контекстном меню элемента, необходимы только для типов файлов, включающих запись " [ярлык](./links.md) ".</span><span class="sxs-lookup"><span data-stu-id="cda6e-403">The subkeys specified to add **Pin to Start Menu** and **Pin to Taskbar** to an item's shortcut menu are only required for file types that include the [IsShortCut](./links.md) entry.</span></span>

<span data-ttu-id="cda6e-404">В Windows Vista была удалена поддержка обработчиков поставщиков столбцов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-404">Support for column provider handlers was removed in Windows Vista.</span></span> <span data-ttu-id="cda6e-405">Кроме того, начиная с Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) является нерекомендуемым в пользу [**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="cda6e-405">Also, as of Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) has been deprecated in favor of [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span>

<span data-ttu-id="cda6e-406">Хотя [**иекстрактимаже**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) остается поддерживаемым, [**исумбнаилпровидер**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) является предпочтительным для Windows Vista и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="cda6e-406">While [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) remains supported, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) is preferred for Windows Vista and later.</span></span>

### <a name="predefined-shell-objects"></a><span data-ttu-id="cda6e-407">Предопределенные объекты оболочки</span><span class="sxs-lookup"><span data-stu-id="cda6e-407">Predefined Shell Objects</span></span>

<span data-ttu-id="cda6e-408">Оболочка определяет дополнительные объекты в **\_ \_ корне классов hKey** , которые могут быть расширены так же, как и типы файлов.</span><span class="sxs-lookup"><span data-stu-id="cda6e-408">The Shell defines additional objects under **HKEY\_CLASSES\_ROOT** which can be extended in the same way as file types.</span></span> <span data-ttu-id="cda6e-409">Например, чтобы добавить обработчик страницы свойств для всех файлов, можно выполнить регистрацию с помощью ключа **пропертишисандлерс** .</span><span class="sxs-lookup"><span data-stu-id="cda6e-409">For example, to add a property sheet handler for all files, you can register under the **PropertySheetHandlers** key.</span></span>

```
HKEY_CLASSES_ROOT
   *
      shellex
         PropertySheetHandlers
```

<span data-ttu-id="cda6e-410">В следующей таблице приведены различные подразделы **\_ \_ корня классов hKey** , в которых можно регистрировать обработчики расширений.</span><span class="sxs-lookup"><span data-stu-id="cda6e-410">The following table gives the various subkeys of **HKEY\_CLASSES\_ROOT** under which extension handlers can be registered.</span></span> <span data-ttu-id="cda6e-411">Обратите внимание, что многие обработчики расширений не могут быть зарегистрированы во всех перечисленных подразделах.</span><span class="sxs-lookup"><span data-stu-id="cda6e-411">Note that many extension handlers cannot be registered under all of the listed subkeys.</span></span> <span data-ttu-id="cda6e-412">Дополнительные сведения см. в документации по конкретному обработчику.</span><span class="sxs-lookup"><span data-stu-id="cda6e-412">For further details, see the specific handler's documentation.</span></span>



| <span data-ttu-id="cda6e-413">Подраздел</span><span class="sxs-lookup"><span data-stu-id="cda6e-413">Subkey</span></span>                    | <span data-ttu-id="cda6e-414">Описание</span><span class="sxs-lookup"><span data-stu-id="cda6e-414">Description</span></span>                                                          | <span data-ttu-id="cda6e-415">Возможные обработчики</span><span class="sxs-lookup"><span data-stu-id="cda6e-415">Possible Handlers</span></span>                                | <span data-ttu-id="cda6e-416">Version</span><span class="sxs-lookup"><span data-stu-id="cda6e-416">Version</span></span> |
|---------------------------|----------------------------------------------------------------------|--------------------------------------------------|---------|
| <span data-ttu-id="cda6e-417">\**\** _</span><span class="sxs-lookup"><span data-stu-id="cda6e-417">\**\** _</span></span>                    | <span data-ttu-id="cda6e-418">Все файлы</span><span class="sxs-lookup"><span data-stu-id="cda6e-418">All files</span></span>                                                            | <span data-ttu-id="cda6e-419">Контекстное меню, страница свойств, команды (см. ниже)</span><span class="sxs-lookup"><span data-stu-id="cda6e-419">Shortcut Menu, Property Sheet, Verbs (see below)</span></span> | <span data-ttu-id="cda6e-420">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-420">All</span></span>     |
| <span data-ttu-id="cda6e-421">_ *Аллфилесистемобжектс*\*</span><span class="sxs-lookup"><span data-stu-id="cda6e-421">_ *AllFileSystemObjects*\*</span></span>  | <span data-ttu-id="cda6e-422">Все файлы и папки с файлами</span><span class="sxs-lookup"><span data-stu-id="cda6e-422">All files and file folders</span></span>                                           | <span data-ttu-id="cda6e-423">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-423">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-424">4,71</span><span class="sxs-lookup"><span data-stu-id="cda6e-424">4.71</span></span>    |
| <span data-ttu-id="cda6e-425">**Папка**</span><span class="sxs-lookup"><span data-stu-id="cda6e-425">**Folder**</span></span>                | <span data-ttu-id="cda6e-426">Все папки</span><span class="sxs-lookup"><span data-stu-id="cda6e-426">All folders</span></span>                                                          | <span data-ttu-id="cda6e-427">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-427">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-428">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-428">All</span></span>     |
| <span data-ttu-id="cda6e-429">**Каталог**</span><span class="sxs-lookup"><span data-stu-id="cda6e-429">**Directory**</span></span>             | <span data-ttu-id="cda6e-430">Папки с файлами</span><span class="sxs-lookup"><span data-stu-id="cda6e-430">File folders</span></span>                                                         | <span data-ttu-id="cda6e-431">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-431">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-432">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-432">All</span></span>     |
| <span data-ttu-id="cda6e-433">**\\Фон каталога**</span><span class="sxs-lookup"><span data-stu-id="cda6e-433">**Directory\\Background**</span></span> | <span data-ttu-id="cda6e-434">Фон папки файлов</span><span class="sxs-lookup"><span data-stu-id="cda6e-434">File folder background</span></span>                                               | <span data-ttu-id="cda6e-435">Только контекстное меню</span><span class="sxs-lookup"><span data-stu-id="cda6e-435">Shortcut Menu only</span></span>                               | <span data-ttu-id="cda6e-436">4,71</span><span class="sxs-lookup"><span data-stu-id="cda6e-436">4.71</span></span>    |
| <span data-ttu-id="cda6e-437">**Накопитель**</span><span class="sxs-lookup"><span data-stu-id="cda6e-437">**Drive**</span></span>                 | <span data-ttu-id="cda6e-438">Все диски в MyComputer, например "C: \\ "</span><span class="sxs-lookup"><span data-stu-id="cda6e-438">All drives in MyComputer, such as "C:\\"</span></span>                             | <span data-ttu-id="cda6e-439">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-439">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-440">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-440">All</span></span>     |
| <span data-ttu-id="cda6e-441">**Network**</span><span class="sxs-lookup"><span data-stu-id="cda6e-441">**Network**</span></span>               | <span data-ttu-id="cda6e-442">Вся сеть (в разделе Мое сетевое окружение)</span><span class="sxs-lookup"><span data-stu-id="cda6e-442">Entire network (under My Network Places)</span></span>                             | <span data-ttu-id="cda6e-443">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-443">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-444">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-444">All</span></span>     |
| <span data-ttu-id="cda6e-445">**\\Тип сети\\\#**</span><span class="sxs-lookup"><span data-stu-id="cda6e-445">**Network\\Type\\\#**</span></span>     | <span data-ttu-id="cda6e-446">Все объекты типа \# (см. ниже)</span><span class="sxs-lookup"><span data-stu-id="cda6e-446">All objects of type \# (see below)</span></span>                                   | <span data-ttu-id="cda6e-447">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-447">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-448">4,71</span><span class="sxs-lookup"><span data-stu-id="cda6e-448">4.71</span></span>    |
| <span data-ttu-id="cda6e-449">**нетшаре**</span><span class="sxs-lookup"><span data-stu-id="cda6e-449">**NetShare**</span></span>              | <span data-ttu-id="cda6e-450">Все общие сетевые папки</span><span class="sxs-lookup"><span data-stu-id="cda6e-450">All network shares</span></span>                                                   | <span data-ttu-id="cda6e-451">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-451">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-452">4,71</span><span class="sxs-lookup"><span data-stu-id="cda6e-452">4.71</span></span>    |
| <span data-ttu-id="cda6e-453">**нетсервер**</span><span class="sxs-lookup"><span data-stu-id="cda6e-453">**NetServer**</span></span>             | <span data-ttu-id="cda6e-454">Все сетевые серверы</span><span class="sxs-lookup"><span data-stu-id="cda6e-454">All network servers</span></span>                                                  | <span data-ttu-id="cda6e-455">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-455">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-456">4,71</span><span class="sxs-lookup"><span data-stu-id="cda6e-456">4.71</span></span>    |
| <span data-ttu-id="cda6e-457">*\_имя поставщика \_ сети*</span><span class="sxs-lookup"><span data-stu-id="cda6e-457">*network\_provider\_name*</span></span> | <span data-ttu-id="cda6e-458">Все объекты, предоставляемые поставщиком сетевых услуг "*\_ \_ имя поставщика* сети"</span><span class="sxs-lookup"><span data-stu-id="cda6e-458">All objects provided by network provider "*network\_provider\_name*"</span></span> | <span data-ttu-id="cda6e-459">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-459">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-460">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-460">All</span></span>     |
| <span data-ttu-id="cda6e-461">**принтеры;**</span><span class="sxs-lookup"><span data-stu-id="cda6e-461">**Printers**</span></span>              | <span data-ttu-id="cda6e-462">Все принтеры</span><span class="sxs-lookup"><span data-stu-id="cda6e-462">All printers</span></span>                                                         | <span data-ttu-id="cda6e-463">Контекстное меню, страница свойств</span><span class="sxs-lookup"><span data-stu-id="cda6e-463">Shortcut Menu, Property Sheet</span></span>                    | <span data-ttu-id="cda6e-464">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-464">All</span></span>     |
| <span data-ttu-id="cda6e-465">**аудиокд**</span><span class="sxs-lookup"><span data-stu-id="cda6e-465">**AudioCD**</span></span>               | <span data-ttu-id="cda6e-466">Звуковой компакт-диск в дисководе компакт-дисков</span><span class="sxs-lookup"><span data-stu-id="cda6e-466">Audio CD in CD drive</span></span>                                                 | <span data-ttu-id="cda6e-467">Только глаголы</span><span class="sxs-lookup"><span data-stu-id="cda6e-467">Verbs only</span></span>                                       | <span data-ttu-id="cda6e-468">Все</span><span class="sxs-lookup"><span data-stu-id="cda6e-468">All</span></span>     |
| <span data-ttu-id="cda6e-469">**ОПТИЧЕСКИ**</span><span class="sxs-lookup"><span data-stu-id="cda6e-469">**DVD**</span></span>                   | <span data-ttu-id="cda6e-470">DVD-дисковод (Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="cda6e-470">DVD drive (Windows 2000)</span></span>                                             | <span data-ttu-id="cda6e-471">Контекстное меню, страница свойств, команды</span><span class="sxs-lookup"><span data-stu-id="cda6e-471">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="cda6e-472">4,71</span><span class="sxs-lookup"><span data-stu-id="cda6e-472">4.71</span></span>    |



 

<span data-ttu-id="cda6e-473">Примечания.</span><span class="sxs-lookup"><span data-stu-id="cda6e-473">Notes:</span></span>

-   <span data-ttu-id="cda6e-474">Доступ к контекстному меню фонового доступа к папке осуществляется путем щелчка правой кнопкой мыши в папке файла, но не для содержимого папки.</span><span class="sxs-lookup"><span data-stu-id="cda6e-474">The file folder background shortcut menu is accessed by right-clicking within a file folder, but not over any of the folder's contents.</span></span>
-   <span data-ttu-id="cda6e-475">"Глаголы" — это специальные команды, зарегистрированные в команде оболочки **\_ \_ корневого** \\ *подраздела* для классов hKey \\  \\  .</span><span class="sxs-lookup"><span data-stu-id="cda6e-475">"Verbs" are special commands registered under **HKEY\_CLASSES\_ROOT**\\*Subkey*\\**Shell**\\**Verb** .</span></span>
-   <span data-ttu-id="cda6e-476">Для  \\ **типа** сети \\ **\#** " \# " — это код типа поставщика сети в десятичном формате.</span><span class="sxs-lookup"><span data-stu-id="cda6e-476">For **Network**\\**Type**\\**\#** , "\#" is a network provider type code in decimal.</span></span> <span data-ttu-id="cda6e-477">Код типа поставщика сети — это старшее слово типа сети.</span><span class="sxs-lookup"><span data-stu-id="cda6e-477">The network provider type code is the high word of a network type.</span></span> <span data-ttu-id="cda6e-478">Список сетевых типов указан в файле заголовка Виннетвк. h ( \_ значения вннк NET \_ \* ).</span><span class="sxs-lookup"><span data-stu-id="cda6e-478">The list of network types is given in the Winnetwk.h header file (WNNC\_NET\_\* values).</span></span> <span data-ttu-id="cda6e-479">Например, вннк \_ net \_ «0x00330000», поэтому соответствующий ключ типа будет содержать классы в **\_ \_ корневой** \\ **сети** \\ **типа** \\ **51** .</span><span class="sxs-lookup"><span data-stu-id="cda6e-479">For example, WNNC\_NET\_SHIVA is 0x00330000, so the corresponding type key would be **HKEY\_CLASSES\_ROOT**\\**Network**\\**Type**\\**51** .</span></span>
-   <span data-ttu-id="cda6e-480">"*\_ \_ имя поставщика сети*" — это имя поставщика сети, указанное в [**внетжетпровидернаме**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), а пробелы преобразуются в символы подчеркивания.</span><span class="sxs-lookup"><span data-stu-id="cda6e-480">"*network\_provider\_name*" is a network provider name as specified by [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), with the spaces converted into underscores.</span></span> <span data-ttu-id="cda6e-481">Например, если установлен поставщик сетевых сетей Microsoft, его имя поставщика — «Microsoft Windows Network», а соответствующее *\_ \_ имя поставщика сети* — **Microsoft \_ Windows \_ Network**.</span><span class="sxs-lookup"><span data-stu-id="cda6e-481">For example, if the Microsoft Networking network provider is installed, its provider name is "Microsoft Windows Network", and the corresponding *network\_provider\_name* is **Microsoft\_Windows\_Network**.</span></span>

### <a name="example-of-an-extension-handler-registration"></a><span data-ttu-id="cda6e-482">Пример регистрации обработчика расширений</span><span class="sxs-lookup"><span data-stu-id="cda6e-482">Example of an Extension Handler Registration</span></span>

<span data-ttu-id="cda6e-483">Чтобы включить определенный обработчик, создайте подключ в разделе типа обработчика расширений с именем обработчика.</span><span class="sxs-lookup"><span data-stu-id="cda6e-483">To enable a particular handler, create a subkey under the extension handler type key with the name of the handler.</span></span> <span data-ttu-id="cda6e-484">Оболочка не использует имя обработчика, но должно отличаться от всех других имен в подразделе этого типа.</span><span class="sxs-lookup"><span data-stu-id="cda6e-484">The Shell does not use the handler's name, but it must be different from all other names under that type subkey.</span></span> <span data-ttu-id="cda6e-485">Задайте значение по умолчанию для подраздела Name в виде строки идентификатора GUID обработчика.</span><span class="sxs-lookup"><span data-stu-id="cda6e-485">Set the default value of the name subkey to the string form of the handler's GUID.</span></span>

<span data-ttu-id="cda6e-486">В следующем примере показаны записи реестра, которые позволяют использовать контекстное меню и обработчики расширений страниц свойств с использованием типа файла example. МИП:</span><span class="sxs-lookup"><span data-stu-id="cda6e-486">The following example illustrates registry entries that enable shortcut menu and property sheet extension handlers, using an example .myp file type:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   CLSID
      {00000000-1111-2222-3333-444444444444}
         InProcServer32
            (Default) = C:\MyDir\MyCommand.dll
            ThreadingModel = Apartment
      {11111111-2222-3333-4444-555555555555}
         InProcServer32
            (Default) = C:\MyDir\MyPropSheet.dll
            ThreadingModel = Apartment
   MyProgram.1
      (Default) = MyProgram Application
      Shellex
         ContextMenuHandler
            MyCommand
               (Default) = {00000000-1111-2222-3333-444444444444}
         PropertySheetHandlers
            MyPropSheet
               (Default) = {11111111-2222-3333-4444-555555555555}
```

<span data-ttu-id="cda6e-487">Процедура регистрации, описанная в этом разделе, должна соблюдаться для всех систем Windows.</span><span class="sxs-lookup"><span data-stu-id="cda6e-487">The registration procedure discussed in this section must be followed for all Windows systems.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cda6e-488">См. также</span><span class="sxs-lookup"><span data-stu-id="cda6e-488">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cda6e-489">Руководство по реализации расширений In-Process</span><span class="sxs-lookup"><span data-stu-id="cda6e-489">Guidance for Implementing In-Process Extensions</span></span>](shell-and-managed-code.md)
</dt> </dl>

 

 
