---
description: Форматы буфера обмена оболочки используются для указания типа данных оболочки, передаваемых через буфер обмена.
ms.assetid: fb8ce5d3-3215-4e05-a916-4d4a803464d2
title: Форматы буфера обмена оболочки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674ccc33db3a35a1a60abb549f5e1ab5b5c96760
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103808849"
---
# <a name="shell-clipboard-formats"></a><span data-ttu-id="8ec81-103">Форматы буфера обмена оболочки</span><span class="sxs-lookup"><span data-stu-id="8ec81-103">Shell Clipboard Formats</span></span>

<span data-ttu-id="8ec81-104">Форматы буфера обмена оболочки используются для указания типа данных оболочки, передаваемых через буфер обмена.</span><span class="sxs-lookup"><span data-stu-id="8ec81-104">Shell clipboard formats are used to identify the type of Shell data being transferred through the clipboard.</span></span> <span data-ttu-id="8ec81-105">Большинство форматов буфера обмена оболочки указывают тип данных, например список имен файлов или указатели на списки идентификаторов элементов (PIDL).</span><span class="sxs-lookup"><span data-stu-id="8ec81-105">Most Shell clipboard formats identify a type of data, such as a list of file names or pointers to item identifier lists (PIDLs).</span></span> <span data-ttu-id="8ec81-106">Однако некоторые форматы используются для обмена данными между источником и целевым объектом.</span><span class="sxs-lookup"><span data-stu-id="8ec81-106">However, some formats are used for communication between source and target.</span></span> <span data-ttu-id="8ec81-107">Они могут ускорить процесс передачи данных за счет поддержки операций оболочки, например [оптимизированного перемещения](datascenarios.md) и [delete_on_paste](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="8ec81-107">They can expedite the data transfer process by supporting Shell operations such as [optimized move](datascenarios.md) and [delete_on_paste](datascenarios.md).</span></span> <span data-ttu-id="8ec81-108">Данные оболочки всегда содержатся в [объекте данных](dataobject.md) , который использует структуру [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) как более общий способ для характеризующих данные.</span><span class="sxs-lookup"><span data-stu-id="8ec81-108">Shell data is always contained in a [data object](dataobject.md) that uses a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as a more general way to characterize data.</span></span> <span data-ttu-id="8ec81-109">Для элемента **кфформат** структуры задается формат буфера обмена для конкретного элемента данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-109">The structure's **cfFormat** member is set to the clipboard format for the particular item of data.</span></span> <span data-ttu-id="8ec81-110">Другие члены предоставляют дополнительные сведения, например механизм передачи данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-110">The other members provide additional information, such as the data transfer mechanism.</span></span> <span data-ttu-id="8ec81-111">Данные содержатся в сопутствующей структуре [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-111">The data is contained in an accompanying [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure.</span></span>

> [!Note]  
> <span data-ttu-id="8ec81-112">Стандартные идентификаторы формата буфера обмена имеют форму CF_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="8ec81-112">Standard clipboard format identifiers have the form CF_ *XXX*.</span></span> <span data-ttu-id="8ec81-113">Распространенным примером является CF_TEXT, который используется для передачи текстовых данных в формате ANSI.</span><span class="sxs-lookup"><span data-stu-id="8ec81-113">A common example is CF_TEXT, which is used for transferring ANSI text data.</span></span> <span data-ttu-id="8ec81-114">Эти идентификаторы имеют предопределенные значения и могут использоваться непосредственно с структурами [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-114">These identifiers have predefined values and can be used directly with [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures.</span></span> <span data-ttu-id="8ec81-115">За исключением [CF_HDROP](#cf_hdrop), идентификаторы формата оболочки не являются стандартными.</span><span class="sxs-lookup"><span data-stu-id="8ec81-115">With the exception of [CF_HDROP](#cf_hdrop), Shell format identifiers are not predefined.</span></span> <span data-ttu-id="8ec81-116">За исключением Драгвиндов, они имеют форму CFSTR_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="8ec81-116">With the exception of DragWindow, they have the form CFSTR_ *XXX*.</span></span> <span data-ttu-id="8ec81-117">Чтобы отличить эти значения от стандартных форматов, они часто называются просто *форматами*.</span><span class="sxs-lookup"><span data-stu-id="8ec81-117">To differentiate these values from predefined formats, they are often referred to as simply *formats*.</span></span> <span data-ttu-id="8ec81-118">Однако, в отличие от предопределенных форматов, они должны быть зарегистрированы как исходной, так и целевой средой, прежде чем их можно будет использовать для перемещения данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-118">However, unlike predefined formats, they must be registered by both source and target before they can be used to transfer data.</span></span> <span data-ttu-id="8ec81-119">Чтобы зарегистрировать формат оболочки, включите файл заголовка Шлобж. h и передайте идентификатор формата CFSTR_ *xxx* в [регистерклипбоардформат](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="8ec81-119">To register a Shell format, include the Shlobj.h header file and pass the CFSTR_ *XXX* format identifier to [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="8ec81-120">Эта функция возвращает допустимое значение формата буфера обмена, которое затем может использоваться в качестве элемента **кфформат** структуры **форматетк** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-120">This function returns a valid clipboard format value, which can then be used as the **cfFormat** member of a **FORMATETC** structure.</span></span>

 

<span data-ttu-id="8ec81-121">Форматы буфера обмена оболочки организованы в три группы в зависимости от того, как они используются.</span><span class="sxs-lookup"><span data-stu-id="8ec81-121">The Shell clipboard formats are organized here into three groups, based on how they are used.</span></span>

-   [<span data-ttu-id="8ec81-122">Форматы для передачи объектов файловой системы</span><span class="sxs-lookup"><span data-stu-id="8ec81-122">Formats for Transferring File System Objects</span></span>](#formats-for-transferring-file-system-objects)
    -   [<span data-ttu-id="8ec81-123">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="8ec81-123">CF_HDROP</span></span>](#cf_hdrop)
    -   [<span data-ttu-id="8ec81-124">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="8ec81-124">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
    -   [<span data-ttu-id="8ec81-125">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="8ec81-125">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
    -   [<span data-ttu-id="8ec81-126">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="8ec81-126">CFSTR_FILENAME</span></span>](#cfstr_filename)
    -   [<span data-ttu-id="8ec81-127">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="8ec81-127">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
    -   [<span data-ttu-id="8ec81-128">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="8ec81-128">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
    -   [<span data-ttu-id="8ec81-129">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="8ec81-129">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
    -   [<span data-ttu-id="8ec81-130">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="8ec81-130">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)
-   [<span data-ttu-id="8ec81-131">Форматы для передачи виртуальных объектов</span><span class="sxs-lookup"><span data-stu-id="8ec81-131">Formats for Transferring Virtual Objects</span></span>](#formats-for-transferring-virtual-objects)
    -   [<span data-ttu-id="8ec81-132">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="8ec81-132">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
    -   [<span data-ttu-id="8ec81-133">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="8ec81-133">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
    -   [<span data-ttu-id="8ec81-134">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="8ec81-134">CFSTR_INETURL</span></span>](#cfstr_ineturl)
    -   [<span data-ttu-id="8ec81-135">CFSTR_SHELLURL (не рекомендуется)</span><span class="sxs-lookup"><span data-stu-id="8ec81-135">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)
-   [<span data-ttu-id="8ec81-136">Форматы обмена данными между исходным и целевым элементами</span><span class="sxs-lookup"><span data-stu-id="8ec81-136">Formats for Communication Between Source and Target</span></span>](#formats-for-communication-between-source-and-target)
    -   [<span data-ttu-id="8ec81-137">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="8ec81-137">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
    -   [<span data-ttu-id="8ec81-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
    -   [<span data-ttu-id="8ec81-139">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="8ec81-139">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
    -   [<span data-ttu-id="8ec81-140">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-140">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
    -   [<span data-ttu-id="8ec81-141">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-141">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
    -   [<span data-ttu-id="8ec81-142">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="8ec81-142">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
    -   [<span data-ttu-id="8ec81-143">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="8ec81-143">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
    -   [<span data-ttu-id="8ec81-144">драгвиндов</span><span class="sxs-lookup"><span data-stu-id="8ec81-144">DragWindow</span></span>](#dragwindow)

## <a name="formats-for-transferring-file-system-objects"></a><span data-ttu-id="8ec81-145">Форматы для передачи объектов файловой системы</span><span class="sxs-lookup"><span data-stu-id="8ec81-145">Formats for Transferring File System Objects</span></span>

<span data-ttu-id="8ec81-146">Эти форматы используются для перемещения одного или нескольких файлов или других объектов оболочки.</span><span class="sxs-lookup"><span data-stu-id="8ec81-146">These formats are used to transfer one or more files or other Shell objects.</span></span>

-   [<span data-ttu-id="8ec81-147">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="8ec81-147">CF_HDROP</span></span>](#cf_hdrop)
-   [<span data-ttu-id="8ec81-148">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="8ec81-148">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
-   [<span data-ttu-id="8ec81-149">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="8ec81-149">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
-   [<span data-ttu-id="8ec81-150">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="8ec81-150">CFSTR_FILENAME</span></span>](#cfstr_filename)
-   [<span data-ttu-id="8ec81-151">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="8ec81-151">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
-   [<span data-ttu-id="8ec81-152">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="8ec81-152">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
-   [<span data-ttu-id="8ec81-153">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="8ec81-153">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
-   [<span data-ttu-id="8ec81-154">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="8ec81-154">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)

### <a name="cf_hdrop"></a><span data-ttu-id="8ec81-155">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="8ec81-155">CF_HDROP</span></span>

<span data-ttu-id="8ec81-156">Этот формат буфера обмена используется при передаче расположений группы существующих файлов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-156">This clipboard format is used when transferring the locations of a group of existing files.</span></span> <span data-ttu-id="8ec81-157">В отличие от других форматов оболочки он предопределен, поэтому нет необходимости вызывать [регистерклипбоардформат](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="8ec81-157">Unlike the other Shell formats, it is predefined, so there is no need to call [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="8ec81-158">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-158">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-159">Элемент **хглобал** структуры указывает на структуру [**дропфилес**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) в качестве элемента **хглобал** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-159">The structure's **hGlobal** member points to a [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure as its **hGlobal** member.</span></span>

<span data-ttu-id="8ec81-160">Элемент **защищенных файлах** структуры [**дропфилес**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) содержит смещение в массиве символов, заканчивающемся **двойным нулем,** который содержит имена файлов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-160">The **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains an offset to a double **null**-terminated character array that contains the file names.</span></span> <span data-ttu-id="8ec81-161">При извлечении формата CF_HDROP из объекта данных можно использовать [**драгкуерифиле**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) для извлечения отдельных имен файлов из объекта глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-161">If you are extracting a CF_HDROP format from a data object, you can use [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) to extract individual file names from the global memory object.</span></span> <span data-ttu-id="8ec81-162">При создании формата CF_HDROP для размещения объекта данных необходимо создать массив имен файлов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-162">If you are creating a CF_HDROP format to place in a data object, you will need to construct the file name array.</span></span>

<span data-ttu-id="8ec81-163">Массив имен файлов состоит из ряда строк, каждый из которых содержит полный путь к файлу, включая завершающий **нуль** -символ.</span><span class="sxs-lookup"><span data-stu-id="8ec81-163">The file name array consists of a series of strings, each containing one file's fully qualified path, including the terminating **NULL** character.</span></span> <span data-ttu-id="8ec81-164">К конечной строке добавляется дополнительный символ **null** для завершения массива.</span><span class="sxs-lookup"><span data-stu-id="8ec81-164">An additional **null** character is appended to the final string to terminate the array.</span></span> <span data-ttu-id="8ec81-165">Например, если \\ передаются файлы c:temp1.txt и c: \\temp2.txt, массив символов выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8ec81-165">For example, if the files c:\\temp1.txt and c:\\temp2.txt are being transferred, the character array looks like this:</span></span>


```CMD
c:\temp1.txt'\0'c:\temp2.txt'\0''\0'
```

> [!Note]  
> <span data-ttu-id="8ec81-166">В этом примере " \\ 0" используется для представления символа **null** , а не литеральных символов, которые должны быть добавлены.</span><span class="sxs-lookup"><span data-stu-id="8ec81-166">In this example, '\\0' is used to represent the **null** character, not the literal characters that should be included.</span></span>


<span data-ttu-id="8ec81-167">Если объект был скопирован в буфер обмена в ходе операции перетаскивания, элемент **PT** структуры [**дропфилес**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) содержит координаты точки, в которой объект был удален.</span><span class="sxs-lookup"><span data-stu-id="8ec81-167">If the object was copied to the clipboard as part of a drag-and-drop operation, the **pt** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains the coordinates of the point where the object was dropped.</span></span> <span data-ttu-id="8ec81-168">Для извлечения координат курсора можно использовать [**драгкуерипоинт**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-168">You can use [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) to extract the cursor coordinates.</span></span>

<span data-ttu-id="8ec81-169">Если этот формат представлен в объекте данных, то цикл перетаскивания OLE имитирует [**WM_DROPFILES**](wm-dropfiles.md) функциональности с целями перетаскивания, отличными от OLE.</span><span class="sxs-lookup"><span data-stu-id="8ec81-169">If this format is present in a data object, an OLE drag loop simulates [**WM_DROPFILES**](wm-dropfiles.md) functionality with non-OLE drop targets.</span></span> <span data-ttu-id="8ec81-170">Это важно, если приложение является источником операции перетаскивания в системе Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="8ec81-170">This is important if your application is the source of a drag-and-drop operation on a Windows 3.1 system.</span></span>

### <a name="cfstr_filecontents"></a><span data-ttu-id="8ec81-171">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="8ec81-171">CFSTR_FILECONTENTS</span></span>

<span data-ttu-id="8ec81-172">Этот идентификатор формата используется с форматом [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) для перемещения данных, как если бы он был файлом, независимо от того, как он фактически хранится.</span><span class="sxs-lookup"><span data-stu-id="8ec81-172">This format identifier is used with the [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format to transfer data as if it were a file, regardless of how it is actually stored.</span></span> <span data-ttu-id="8ec81-173">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , представляющей содержимое одного файла.</span><span class="sxs-lookup"><span data-stu-id="8ec81-173">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that represents the contents of one file.</span></span> <span data-ttu-id="8ec81-174">Файл обычно представляется в виде объекта потока, что позволяет избежать необходимости размещения содержимого файла в памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-174">The file is normally represented as a stream object, which avoids having to place the contents of the file in memory.</span></span> <span data-ttu-id="8ec81-175">В этом случае элемент **тимед** структуры **стгмедиум** имеет значение TYMED_ISTREAM, а файл представляется интерфейсом [**ISTREAM**](/windows/win32/api/objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-175">In that case, the **tymed** member of the **STGMEDIUM** structure is set to TYMED_ISTREAM, and the file is represented by an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="8ec81-176">Этот файл также может быть объектом хранилища или глобальной памяти (TYMED_ISTORAGE или TYMED_HGLOBAL).</span><span class="sxs-lookup"><span data-stu-id="8ec81-176">The file can also be a storage or global memory object (TYMED_ISTORAGE or TYMED_HGLOBAL).</span></span> <span data-ttu-id="8ec81-177">Связанный формат CFSTR_FILEDESCRIPTOR содержит структуру [**филедескриптор**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) для каждого файла, который указывает имя и атрибуты файла.</span><span class="sxs-lookup"><span data-stu-id="8ec81-177">The associated CFSTR_FILEDESCRIPTOR format contains a [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file that specifies the file's name and attributes.</span></span>

<span data-ttu-id="8ec81-178">Целевой объект обрабатывает данные, связанные с форматом CFSTR_FILECONTENTS, как если бы он был файлом.</span><span class="sxs-lookup"><span data-stu-id="8ec81-178">The target treats the data associated with a CFSTR_FILECONTENTS format as if it were a file.</span></span> <span data-ttu-id="8ec81-179">Когда целевой объект вызывает интерфейс [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) для извлечения данных, он указывает определенный файл, устанавливая для **элемента Линдекс** структуры [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) Отсчитываемый от нуля индекс структуры [**филедескриптор**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) файла в соответствующем [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) формате.</span><span class="sxs-lookup"><span data-stu-id="8ec81-179">When the target calls [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to extract the data, it specifies a particular file by setting the **lindex** member of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure in the accompanying [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format.</span></span> <span data-ttu-id="8ec81-180">Затем целевой объект использует возвращаемый указатель интерфейса или глобальный маркер памяти для извлечения данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-180">The target then uses the returned interface pointer or global memory handle to extract the data.</span></span>

### <a name="cfstr_filedescriptor"></a><span data-ttu-id="8ec81-181">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="8ec81-181">CFSTR_FILEDESCRIPTOR</span></span>

<span data-ttu-id="8ec81-182">Этот идентификатор формата используется с форматом [CFSTR_FILECONTENTS](#cfstr_filecontents) для перемещения данных в виде группы файлов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-182">This format identifier is used with the [CFSTR_FILECONTENTS](#cfstr_filecontents) format to transfer data as a group of files.</span></span> <span data-ttu-id="8ec81-183">Эти два формата являются предпочтительным способом перемещения объектов оболочки, которые не хранятся в виде файлов в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="8ec81-183">These two formats are the preferred way to transfer Shell objects that are not stored as file-system files.</span></span> <span data-ttu-id="8ec81-184">Например, эти форматы можно использовать для перемещения группы сообщений электронной почты в виде отдельных файлов, несмотря на то, что каждый адрес электронной почты на самом деле хранится в виде блока данных в базе данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-184">For example, these formats can be used to transfer a group of email messages as individual files, even though each email is actually stored as a block of data in a database.</span></span> <span data-ttu-id="8ec81-185">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-185">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-186">Элемент **хглобал** структуры указывает на структуру [**филеграупдескриптор**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) , за которой следует массив, содержащий одну структуру [**филедескриптор**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) для каждого файла в группе.</span><span class="sxs-lookup"><span data-stu-id="8ec81-186">The structure's **hGlobal** member points to a [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) structure that is followed by an array containing one [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file in the group.</span></span> <span data-ttu-id="8ec81-187">Для каждой структуры **филедескриптор** существует отдельный формат CFSTR_FILECONTENTS, который содержит содержимое файла.</span><span class="sxs-lookup"><span data-stu-id="8ec81-187">For each **FILEDESCRIPTOR** structure, there is a separate CFSTR_FILECONTENTS format that contains the contents of the file.</span></span> <span data-ttu-id="8ec81-188">Чтобы определить формат CFSTR_FILECONTENTS определенного файла, задайте в качестве значения **Линдекс** структуры [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) Отсчитываемый от нуля индекс структуры **филедескриптор** файла.</span><span class="sxs-lookup"><span data-stu-id="8ec81-188">To identify a particular file's CFSTR_FILECONTENTS format, set the **lIndex** value of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's **FILEDESCRIPTOR** structure.</span></span>

<span data-ttu-id="8ec81-189">Формат CFSTR_FILEDESCRIPTOR обычно используется для перемещения данных, как если бы они были группой файлов, независимо от того, как они хранятся на самом деле.</span><span class="sxs-lookup"><span data-stu-id="8ec81-189">The CFSTR_FILEDESCRIPTOR format is commonly used to transfer data as if it were a group of files, regardless of how it is actually stored.</span></span> <span data-ttu-id="8ec81-190">С точки зрения целевого объекта каждый формат CFSTR_FILECONTENTS представляет отдельный файл и обрабатывается соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="8ec81-190">From the target's perspective, each CFSTR_FILECONTENTS format represents a single file and is treated accordingly.</span></span> <span data-ttu-id="8ec81-191">Однако источник может хранить данные любым способом, который он выбрал.</span><span class="sxs-lookup"><span data-stu-id="8ec81-191">However, the source can store the data in any way it chooses.</span></span> <span data-ttu-id="8ec81-192">Хотя формат CSFTR_FILECONTENTS может соответствовать одному файлу, он также может, например, представлять данные, извлеченные источником из базы данных или текстового документа.</span><span class="sxs-lookup"><span data-stu-id="8ec81-192">While a CSFTR_FILECONTENTS format might correspond to a single file, it could also, for example, represent data extracted by the source from a database or text document.</span></span>

### <a name="cfstr_filename"></a><span data-ttu-id="8ec81-193">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="8ec81-193">CFSTR_FILENAME</span></span>

<span data-ttu-id="8ec81-194">Этот идентификатор формата используется для перемещения одного файла.</span><span class="sxs-lookup"><span data-stu-id="8ec81-194">This format identifier is used to transfer a single file.</span></span> <span data-ttu-id="8ec81-195">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-195">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-196">Элемент **хглобал** структуры указывает на одну строку, завершающуюся **нулем**, содержащую полный путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="8ec81-196">The structure's **hGlobal** member points to a single **null**-terminated string containing the file's fully qualified file path.</span></span> <span data-ttu-id="8ec81-197">Этот формат был заменен [CF_HDROP](#cf_hdrop), но он поддерживается для обеспечения обратной совместимости с приложениями Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="8ec81-197">This format has been superseded by [CF_HDROP](#cf_hdrop), but it is supported for backward compatibility with Windows 3.1 applications.</span></span>

### <a name="cfstr_filenamemap"></a><span data-ttu-id="8ec81-198">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="8ec81-198">CFSTR_FILENAMEMAP</span></span>

<span data-ttu-id="8ec81-199">Этот идентификатор формата используется при переименовании группы файлов в [CF_HDROPном](#cf_hdrop) формате, а также при передаче.</span><span class="sxs-lookup"><span data-stu-id="8ec81-199">This format identifier is used when a group of files in [CF_HDROP](#cf_hdrop) format is being renamed as well as transferred.</span></span> <span data-ttu-id="8ec81-200">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-200">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-201">Элемент **хглобал** структуры указывает на массив символов, заканчивающийся **двойным нулем.**</span><span class="sxs-lookup"><span data-stu-id="8ec81-201">The structure's **hGlobal** member points to a double **null**-terminated character array.</span></span> <span data-ttu-id="8ec81-202">Этот массив содержит новое имя для каждого файла в том же порядке, в котором эти файлы перечислены в соответствующем CF_HDROPм формате.</span><span class="sxs-lookup"><span data-stu-id="8ec81-202">This array contains a new name for each file, in the same order that the files are listed in the accompanying CF_HDROP format.</span></span> <span data-ttu-id="8ec81-203">Формат массива символов такой же, как и используемый CF_HDROP для перечисления передаваемых файлов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-203">The format of the character array is the same as that used by CF_HDROP to list the transferred files.</span></span>

### <a name="cfstr_mountedvolume"></a><span data-ttu-id="8ec81-204">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="8ec81-204">CFSTR_MOUNTEDVOLUME</span></span>

<span data-ttu-id="8ec81-205">Этот идентификатор формата используется для перемещения пути на подключенном томе.</span><span class="sxs-lookup"><span data-stu-id="8ec81-205">This format identifier is used to transfer a path on a mounted volume.</span></span> <span data-ttu-id="8ec81-206">Он похож на [CF_HDROP](#cf_hdrop), но он содержит только один путь и может обрабатывать более длинные строки пути, которые могут потребоваться для представления пути при подключении тома к папке.</span><span class="sxs-lookup"><span data-stu-id="8ec81-206">It is similar to [CF_HDROP](#cf_hdrop), but it contains only a single path and can handle the longer path strings that might be needed to represent a path when the volume is mounted on a folder.</span></span> <span data-ttu-id="8ec81-207">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-207">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-208">Элемент **хглобал** структуры указывает на одну строку, завершающуюся **нулем**, содержащую полный путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="8ec81-208">The structure's **hGlobal** member points to a single **null**-terminated string containing the fully qualified file path.</span></span> <span data-ttu-id="8ec81-209">Строка пути должна заканчиваться \\ символом "", за которым следует завершающее **значение NULL**.</span><span class="sxs-lookup"><span data-stu-id="8ec81-209">The path string must end with a '\\' character, followed by the terminating **NULL**.</span></span>

<span data-ttu-id="8ec81-210">До Windows 2000 тома могли быть подключены только к буквам дисков.</span><span class="sxs-lookup"><span data-stu-id="8ec81-210">Prior to Windows 2000, volumes could be mounted only on drive letters.</span></span> <span data-ttu-id="8ec81-211">Для систем Windows 2000 и более поздних версий с диском в формате NTFS можно также подключать тома к пустым папкам.</span><span class="sxs-lookup"><span data-stu-id="8ec81-211">For Windows 2000 and later systems with an NTFS formatted drive, you can also mount volumes on empty folders.</span></span> <span data-ttu-id="8ec81-212">Эта функция позволяет подключить том, не занимая букву диска.</span><span class="sxs-lookup"><span data-stu-id="8ec81-212">This feature allows a volume to be mounted without taking up a drive letter.</span></span> <span data-ttu-id="8ec81-213">Подключенный том может использовать любой поддерживаемый в настоящее время формат, включая FAT, FAT32, NTFS и CDFS.</span><span class="sxs-lookup"><span data-stu-id="8ec81-213">The mounted volume can use any currently supported format, including FAT, FAT32, NTFS, and CDFS.</span></span>

<span data-ttu-id="8ec81-214">Можно добавить страницы в страницу свойств диска, реализовав [обработчик страницы свойств](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="8ec81-214">You can add pages to a Drive Properties property sheet by implementing a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="8ec81-215">Если том подключен к букве диска, оболочка передает сведения о пути обработчику в формате [CF_HDROP](#cf_hdrop) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-215">If the volume is mounted on a drive letter, the Shell passes path information to the handler with the [CF_HDROP](#cf_hdrop) format.</span></span> <span data-ttu-id="8ec81-216">В Windows 2000 и более поздних версиях формат CF_HDROP используется при подключении тома к букве диска, как и в предыдущих системах.</span><span class="sxs-lookup"><span data-stu-id="8ec81-216">With Windows 2000 and later systems, the CF_HDROP format is used when a volume is mounted on a drive letter, just as with earlier systems.</span></span> <span data-ttu-id="8ec81-217">Однако если том подключен к папке, вместо CF_HDROP используется [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) идентификатор формата.</span><span class="sxs-lookup"><span data-stu-id="8ec81-217">However, if a volume is mounted on a folder, the [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) format identifier is used instead of CF_HDROP.</span></span>

<span data-ttu-id="8ec81-218">Если для подключения томов будут использоваться только буквы диска, будет использоваться только [CF_HDROP](#cf_hdrop) , а существующие обработчики страниц свойств будут работать так же, как и в предыдущих системах.</span><span class="sxs-lookup"><span data-stu-id="8ec81-218">If only drive letters will be used to mount volumes, only [CF_HDROP](#cf_hdrop) will be used, and existing property sheet handlers will work as they did with earlier systems.</span></span> <span data-ttu-id="8ec81-219">Однако, если требуется, чтобы обработчик отображал страницу для томов, которые подключены к папкам, а также к буквам дисков, обработчик должен иметь возможность понимать как форматы CSFTR_MOUNTEDVOLUME, так и CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="8ec81-219">However, if you want your handler to display a page for volumes that are mounted on folders as well as drive letters, the handler must be able to understand both the CSFTR_MOUNTEDVOLUME and CF_HDROP formats.</span></span>

### <a name="cfstr_shellidlist"></a><span data-ttu-id="8ec81-220">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="8ec81-220">CFSTR_SHELLIDLIST</span></span>

<span data-ttu-id="8ec81-221">Этот идентификатор формата используется при передаче расположений одного или нескольких существующих объектов пространства имен.</span><span class="sxs-lookup"><span data-stu-id="8ec81-221">This format identifier is used when transferring the locations of one or more existing namespace objects.</span></span> <span data-ttu-id="8ec81-222">Он используется во многом так же, как [CF_HDROP](#cf_hdrop), но он содержит PIDL вместо путей файловой системы.</span><span class="sxs-lookup"><span data-stu-id="8ec81-222">It is used in much the same way as [CF_HDROP](#cf_hdrop), but it contains PIDLs instead of file system paths.</span></span> <span data-ttu-id="8ec81-223">Использование PIDL позволяет использовать формат CFSTR_SHELLIDLIST для управления виртуальными объектами, а также объектами файловой системы.</span><span class="sxs-lookup"><span data-stu-id="8ec81-223">Using PIDLs allows the CFSTR_SHELLIDLIST format to handle virtual objects as well as file system objects.</span></span> <span data-ttu-id="8ec81-224">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-224">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-225">Элемент **хглобал** структуры указывает на структуру [**Цида**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-225">The structure's **hGlobal** member points to a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span>

<span data-ttu-id="8ec81-226">Элемент **аоффсет** структуры [**Цида**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) представляет собой массив, содержащий смещение до начала структуры [**ИТЕМИДЛИСТ**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) для каждого переданного Пидл.</span><span class="sxs-lookup"><span data-stu-id="8ec81-226">The **aoffset** member of the [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure is an array containing offsets to the beginning of the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure for each PIDL that is being transferred.</span></span> <span data-ttu-id="8ec81-227">Чтобы извлечь определенный ПИДЛ, сначала определите его индекс.</span><span class="sxs-lookup"><span data-stu-id="8ec81-227">To extract a particular PIDL, first determine its index.</span></span> <span data-ttu-id="8ec81-228">Затем добавьте значение **аоффсет** , соответствующее этому индексу, в адрес структуры **Цида** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-228">Then, add the **aoffset** value that corresponds to that index to the address of the **CIDA** structure.</span></span>

<span data-ttu-id="8ec81-229">Первый элемент **аоффсет** содержит смещение к полному Пидл родительской папки.</span><span class="sxs-lookup"><span data-stu-id="8ec81-229">The first element of **aoffset** contains an offset to the fully qualified PIDL of a parent folder.</span></span> <span data-ttu-id="8ec81-230">Если этот ПИДЛ пуст, то родительской папкой является Рабочий стол.</span><span class="sxs-lookup"><span data-stu-id="8ec81-230">If this PIDL is empty, the parent folder is the desktop.</span></span> <span data-ttu-id="8ec81-231">Каждый из оставшихся элементов массива содержит смещение для одного из PIDL, который необходимо передать.</span><span class="sxs-lookup"><span data-stu-id="8ec81-231">Each of the remaining elements of the array contains an offset to one of the PIDLs to be transferred.</span></span> <span data-ttu-id="8ec81-232">Все эти PIDL относятся к ПИДЛ родительской папки.</span><span class="sxs-lookup"><span data-stu-id="8ec81-232">All of these PIDLs are relative to the PIDL of the parent folder.</span></span>

<span data-ttu-id="8ec81-233">Для получения PIDL из структуры [**Цида**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) можно использовать следующие два макроса.</span><span class="sxs-lookup"><span data-stu-id="8ec81-233">The following two macros can be used to retrieve PIDLs from a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span> <span data-ttu-id="8ec81-234">Первый получает указатель на структуру и получает ПИДЛ родительской папки.</span><span class="sxs-lookup"><span data-stu-id="8ec81-234">The first takes a pointer to the structure and retrieves the PIDL of the parent folder.</span></span> <span data-ttu-id="8ec81-235">Второй принимает указатель на структуру и получает один из других PIDL, идентифицируемый индексом, начинающимся с нуля.</span><span class="sxs-lookup"><span data-stu-id="8ec81-235">The second takes a pointer to the structure and retrieves one of the other PIDLs, identified by its zero-based index.</span></span>


```C++
#define GetPIDLFolder(pida) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[0])

#define GetPIDLItem(pida, i) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[i+1])
```

> [!Note]  
> <span data-ttu-id="8ec81-236">Значение, возвращаемое этими макросами, является указателем на структуру [**ИТЕМИДЛИСТ**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) Пидл.</span><span class="sxs-lookup"><span data-stu-id="8ec81-236">The value that is returned by these macros is a pointer to the PIDL's [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure.</span></span> <span data-ttu-id="8ec81-237">Так как эти структуры имеют разную длину, необходимо определить конец структуры, проходя по каждой из структур [**шитемид**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) структуры **итемидлист** , пока не достигают двухбайтовый **значения NULL** , обозначающие конец.</span><span class="sxs-lookup"><span data-stu-id="8ec81-237">Since these structures vary in length, you must determine the end of the structure by walking through each of the **ITEMIDLIST** structure's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures until you reach the two-byte **NULL** that marks the end.</span></span>

### <a name="cfstr_shellidlistoffset"></a><span data-ttu-id="8ec81-238">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="8ec81-238">CFSTR_SHELLIDLISTOFFSET</span></span>

<span data-ttu-id="8ec81-239">Этот идентификатор формата используется с такими форматами, как [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist)и [CFSTR_FILECONTENTS](#cfstr_filecontents) для указания расположения группы объектов после перемещения.</span><span class="sxs-lookup"><span data-stu-id="8ec81-239">This format identifier is used with formats such as [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist), and [CFSTR_FILECONTENTS](#cfstr_filecontents) to specify the position of a group of objects following a transfer.</span></span> <span data-ttu-id="8ec81-240">Данные состоят из структуры [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-240">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-241">Элемент **хглобал** структуры указывает на массив структур [**точек**](/previous-versions//dd162805(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-241">The structure's **hGlobal** member points to an array of [**POINT**](/previous-versions//dd162805(v=vs.85)) structures.</span></span> <span data-ttu-id="8ec81-242">Первая структура задает экранные координаты (в пикселях) верхнего левого угла прямоугольника, охватывающего группу.</span><span class="sxs-lookup"><span data-stu-id="8ec81-242">The first structure specifies the screen coordinates, in pixels, of the upper-left corner of the rectangle that encloses the group.</span></span> <span data-ttu-id="8ec81-243">Оставшаяся часть структур задает расположение отдельных объектов относительно положения группы.</span><span class="sxs-lookup"><span data-stu-id="8ec81-243">The remainder of the structures specify the locations of the individual objects relative to the group's position.</span></span> <span data-ttu-id="8ec81-244">Они должны быть в том же порядке, который использовался для перечисления объектов в связанном формате.</span><span class="sxs-lookup"><span data-stu-id="8ec81-244">They must be in the same order as that used to list the objects in the associated format.</span></span>

## <a name="formats-for-transferring-virtual-objects"></a><span data-ttu-id="8ec81-245">Форматы для передачи виртуальных объектов</span><span class="sxs-lookup"><span data-stu-id="8ec81-245">Formats for Transferring Virtual Objects</span></span>

<span data-ttu-id="8ec81-246">Формат CFSTR_SHELLIDLIST можно использовать для перемещения файловой системы и виртуальных объектов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-246">The CFSTR_SHELLIDLIST format can be used to transfer both file system and virtual objects.</span></span> <span data-ttu-id="8ec81-247">Однако существует также несколько специализированных форматов для передачи определенных типов виртуальных объектов.</span><span class="sxs-lookup"><span data-stu-id="8ec81-247">However, there are also several specialized formats for transferring particular types of virtual objects.</span></span>

-   [<span data-ttu-id="8ec81-248">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="8ec81-248">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
-   [<span data-ttu-id="8ec81-249">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="8ec81-249">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
-   [<span data-ttu-id="8ec81-250">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="8ec81-250">CFSTR_INETURL</span></span>](#cfstr_ineturl)
-   [<span data-ttu-id="8ec81-251">CFSTR_SHELLURL (не рекомендуется)</span><span class="sxs-lookup"><span data-stu-id="8ec81-251">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)

### <a name="cfstr_netresources"></a><span data-ttu-id="8ec81-252">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="8ec81-252">CFSTR_NETRESOURCES</span></span>

<span data-ttu-id="8ec81-253">Этот идентификатор формата используется при передаче сетевых ресурсов, таких как домен или сервер.</span><span class="sxs-lookup"><span data-stu-id="8ec81-253">This format identifier is used when transferring network resources, such as a domain or server.</span></span> <span data-ttu-id="8ec81-254">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-254">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-255">Элемент **хглобал** структуры указывает на структуру [**нресаррай**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-255">The structure's **hGlobal** member points to a [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) structure.</span></span> <span data-ttu-id="8ec81-256">Элемент **Nr** этой структуры указывает структуру [**Нетресаурце**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) , член **лпремотенаме** которой содержит строку, завершающуюся **нулем,** обозначающую сетевой ресурс.</span><span class="sxs-lookup"><span data-stu-id="8ec81-256">The **nr** member of that structure indicates a [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) structure whose **lpRemoteName** member contains a **null**-terminated string identifying the network resource.</span></span> <span data-ttu-id="8ec81-257">Цель перетаскивания может затем использовать данные с любой из функций API [сети Windows (внет)](../wnet/windows-networking-wnet-.md) , таких как [**внетаддконнектион**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), для выполнения сетевых операций с объектом.</span><span class="sxs-lookup"><span data-stu-id="8ec81-257">The drop target can then use the data with any of the [Windows Networking (WNet)](../wnet/windows-networking-wnet-.md) API functions, such as [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), to perform network operations on the object.</span></span>

### <a name="cfstr_printergroup"></a><span data-ttu-id="8ec81-258">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="8ec81-258">CFSTR_PRINTERGROUP</span></span>

<span data-ttu-id="8ec81-259">Этот идентификатор формата используется при передаче понятных имен принтеров.</span><span class="sxs-lookup"><span data-stu-id="8ec81-259">This format identifier is used when transferring the friendly names of printers.</span></span> <span data-ttu-id="8ec81-260">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-260">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-261">Элемент **хглобал** структуры указывает на строку в том же формате, что и при использовании с [CF_HDROP](#cf_hdrop).</span><span class="sxs-lookup"><span data-stu-id="8ec81-261">The structure's **hGlobal** member points to a string in the same format as that used with [CF_HDROP](#cf_hdrop).</span></span> <span data-ttu-id="8ec81-262">Однако элемент **защищенных файлах** структуры [**дропфилес**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) содержит одно или несколько понятных имен принтеров вместо путей к файлам.</span><span class="sxs-lookup"><span data-stu-id="8ec81-262">However, the **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains one or more friendly names of printers instead of file paths.</span></span>

### <a name="cfstr_ineturl"></a><span data-ttu-id="8ec81-263">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="8ec81-263">CFSTR_INETURL</span></span>

<span data-ttu-id="8ec81-264">Этот идентификатор формата заменяет [CFSTR_SHELLURL (не рекомендуется)](#cfstr_shellurl-deprecated).</span><span class="sxs-lookup"><span data-stu-id="8ec81-264">This format identifier replaces [CFSTR_SHELLURL (deprecated)](#cfstr_shellurl-deprecated).</span></span> <span data-ttu-id="8ec81-265">Если приложение должно управлять URL-адресами буфера обмена, используйте CFSTR_INETURL вместо CFSTR_SHELLURL (не рекомендуется).</span><span class="sxs-lookup"><span data-stu-id="8ec81-265">If you want your application to manipulate clipboard URLs, use CFSTR_INETURL instead of CFSTR_SHELLURL (deprecated).</span></span> <span data-ttu-id="8ec81-266">Этот формат обеспечивает лучшее представление одного URL-адреса в буфере обмена.</span><span class="sxs-lookup"><span data-stu-id="8ec81-266">This format gives the best clipboard representation of a single URL.</span></span> <span data-ttu-id="8ec81-267">Если Юникод не определен, приложение получает версию CF_TEXT/CFSTR_SHELLURL URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="8ec81-267">If UNICODE is not defined, the application retrieves the CF_TEXT/CFSTR_SHELLURL version of the URL.</span></span> <span data-ttu-id="8ec81-268">Если определен Юникод, приложение получает CF_UNICODE версию URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="8ec81-268">If UNICODE is defined, the application retrieves the CF_UNICODE version of the URL.</span></span>

### <a name="cfstr_shellurl-deprecated"></a><span data-ttu-id="8ec81-269">CFSTR_SHELLURL (не рекомендуется)</span><span class="sxs-lookup"><span data-stu-id="8ec81-269">CFSTR_SHELLURL (deprecated)</span></span>

> [!Note]  
> <span data-ttu-id="8ec81-270">Этот идентификатор формата устарел; Вместо этого используйте CFSTR_INETURL.</span><span class="sxs-lookup"><span data-stu-id="8ec81-270">This format identifier has been deprecated; use CFSTR_INETURL instead.</span></span>

 

## <a name="formats-for-communication-between-source-and-target"></a><span data-ttu-id="8ec81-271">Форматы обмена данными между исходным и целевым элементами</span><span class="sxs-lookup"><span data-stu-id="8ec81-271">Formats for Communication Between Source and Target</span></span>

<span data-ttu-id="8ec81-272">Эти идентификаторы формата позволяют обмениваться данными между источником и целевым объектом.</span><span class="sxs-lookup"><span data-stu-id="8ec81-272">These format identifiers allow communication between source and target.</span></span> <span data-ttu-id="8ec81-273">Эти форматы сопровождают данные и предоставляют приложениям более высокий уровень контроля над операциями перемещения, копирования и перетаскивания, включая объекты оболочки.</span><span class="sxs-lookup"><span data-stu-id="8ec81-273">The formats accompany the data and give applications a greater degree of control over move-copy-paste or drag-and-drop operations involving Shell objects.</span></span>

-   [<span data-ttu-id="8ec81-274">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="8ec81-274">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
-   [<span data-ttu-id="8ec81-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
-   [<span data-ttu-id="8ec81-276">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="8ec81-276">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
-   [<span data-ttu-id="8ec81-277">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-277">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
-   [<span data-ttu-id="8ec81-278">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-278">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
-   [<span data-ttu-id="8ec81-279">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="8ec81-279">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
-   [<span data-ttu-id="8ec81-280">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="8ec81-280">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
-   [<span data-ttu-id="8ec81-281">драгвиндов</span><span class="sxs-lookup"><span data-stu-id="8ec81-281">DragWindow</span></span>](#dragwindow)

### <a name="cfstr_indragloop"></a><span data-ttu-id="8ec81-282">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="8ec81-282">CFSTR_INDRAGLOOP</span></span>

<span data-ttu-id="8ec81-283">Этот идентификатор формата используется объектом данных для указания того, находится ли он в цикле перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="8ec81-283">This format identifier is used by a data object to indicate whether it is in a drag-and-drop loop.</span></span> <span data-ttu-id="8ec81-284">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-284">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-285">Элемент **хглобал** структуры указывает на значение **типа DWORD** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-285">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="8ec81-286">Если значение **DWORD** не равно нулю, то объект данных находится в цикле перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="8ec81-286">If the **DWORD** value is nonzero, the data object is within a drag-and-drop loop.</span></span> <span data-ttu-id="8ec81-287">Если значение равно нулю, то объект данных не находится внутри цикла перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="8ec81-287">If the value is set to zero, the data object is not within a drag-and-drop loop.</span></span>

<span data-ttu-id="8ec81-288">Некоторые цели перетаскивания могут вызывать [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) и пытаться извлечь данные, пока объект все еще находится внутри цикла перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="8ec81-288">Some drop targets might call [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) and attempt to extract data while the object is still within the drag-and-drop loop.</span></span> <span data-ttu-id="8ec81-289">Полная отрисовка объекта для каждого такого экземпляра может вызвать зависание курсора перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="8ec81-289">Fully rendering the object for each such occurrence might cause the drag cursor to stall.</span></span> <span data-ttu-id="8ec81-290">Если объект данных поддерживает [CFSTR_INDRAGLOOP](#cfstr_indragloop), целевой объект может использовать этот формат, чтобы проверить состояние цикла перетаскивания и избежать интенсивного отображения объекта в памяти, пока он не будет фактически удален.</span><span class="sxs-lookup"><span data-stu-id="8ec81-290">If the data object supports [CFSTR_INDRAGLOOP](#cfstr_indragloop), the target can instead use that format to check the status of the drag-and-drop loop and avoid memory intensive rendering of the object until it is actually dropped.</span></span> <span data-ttu-id="8ec81-291">Форматы, интенсивно использующие память для визуализации, по-прежнему должны включаться в перечислитель [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) и в вызовах интерфейса [**IDataObject:: куерижетдата**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span><span class="sxs-lookup"><span data-stu-id="8ec81-291">The formats that are memory intensive to render should still be included in the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) enumerator and in calls to [**IDataObject::QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span></span> <span data-ttu-id="8ec81-292">Если объект данных не устанавливает CFSTR_INDRAGLOOP, он должен действовать так, как если бы значение было равно нулю.</span><span class="sxs-lookup"><span data-stu-id="8ec81-292">If the data object does not set CFSTR_INDRAGLOOP, it should act as if the value is set to zero.</span></span>

### <a name="cfstr_logicalperformeddropeffect"></a><span data-ttu-id="8ec81-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="8ec81-294">[Версия 5,0.](versions.md) Этот идентификатор формата позволяет удаленному источнику вызывать метод [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) объекта данных, чтобы определить результат передаваемых данных оболочки.</span><span class="sxs-lookup"><span data-stu-id="8ec81-294">[Version 5.0.](versions.md)This format identifier allows a drop source to call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to determine the outcome of a Shell data transfer.</span></span> <span data-ttu-id="8ec81-295">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-295">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-296">Элемент **хглобал** структуры указывает на DWORD, содержащий значение [**дропеффект**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-296">The structure's **hGlobal** member points to a DWORD containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span>

<span data-ttu-id="8ec81-297">Идентификатор формата [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) предназначен для того, чтобы цель указывала объекту данных на фактическую операцию.</span><span class="sxs-lookup"><span data-stu-id="8ec81-297">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format identifier was intended to allow the target to indicate to the data object what operation actually took place.</span></span> <span data-ttu-id="8ec81-298">Однако оболочка использует [оптимизированные перемещения](datascenarios.md) для объектов файловой системы везде, где это возможно.</span><span class="sxs-lookup"><span data-stu-id="8ec81-298">However, the Shell uses [optimized moves](datascenarios.md) for file system objects whenever possible.</span></span> <span data-ttu-id="8ec81-299">В этом случае оболочка обычно устанавливает CFSTR_PERFORMEDDROPEFFECT значение DROPEFFECT_NONE, чтобы указать объекту данных, что исходные данные были удалены.</span><span class="sxs-lookup"><span data-stu-id="8ec81-299">In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted.</span></span> <span data-ttu-id="8ec81-300">Поэтому источник не может использовать значение CFSTR_PERFORMEDDROPEFFECT, чтобы определить, какая операция выполнена.</span><span class="sxs-lookup"><span data-stu-id="8ec81-300">Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place.</span></span> <span data-ttu-id="8ec81-301">Хотя для большинства источников эти сведения не требуются, существуют некоторые исключения.</span><span class="sxs-lookup"><span data-stu-id="8ec81-301">While most sources do not need this information, there are some exceptions.</span></span> <span data-ttu-id="8ec81-302">Например, несмотря на то, что оптимизированные перемещения устраняют необходимость в источнике для удаления каких-либо данных, источнику может потребоваться обновить связанную базу данных, чтобы указать, что файлы были перемещены или скопированы.</span><span class="sxs-lookup"><span data-stu-id="8ec81-302">For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied.</span></span>

<span data-ttu-id="8ec81-303">Если источнику необходимо выяснить, какая операция выполнялась, он может вызвать метод [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) объекта данных и запросить формат CFSTR_LOGICALPERFORMEDDROPEFFECT.</span><span class="sxs-lookup"><span data-stu-id="8ec81-303">If a source needs to know which operation took place, it can call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method and request the CFSTR_LOGICALPERFORMEDDROPEFFECT format.</span></span> <span data-ttu-id="8ec81-304">Этот формат по сути отражает то, что происходит с точки зрения пользователя после завершения операции.</span><span class="sxs-lookup"><span data-stu-id="8ec81-304">This format essentially reflects what happens from the user's point of view after the operation is complete.</span></span> <span data-ttu-id="8ec81-305">Если создается новый файл и исходный файл удаляется, пользователь видит операцию перемещения, а значение данных формата — DROPEFFECT_MOVE.</span><span class="sxs-lookup"><span data-stu-id="8ec81-305">If a new file is created and the original file is deleted, the user sees a move operation and the format's data value is set to DROPEFFECT_MOVE.</span></span> <span data-ttu-id="8ec81-306">Если исходный файл все еще присутствует, пользователь увидит операцию копирования, и значение данных формата будет равно DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="8ec81-306">If the original file is still there, the user sees a copy operation and the format's data value is set to DROPEFFECT_COPY.</span></span> <span data-ttu-id="8ec81-307">Если была создана ссылка, значение данных формата будет DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="8ec81-307">If a link was created, the format's data value will be DROPEFFECT_LINK.</span></span>

### <a name="cfstr_pastesucceeded"></a><span data-ttu-id="8ec81-308">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="8ec81-308">CFSTR_PASTESUCCEEDED</span></span>

<span data-ttu-id="8ec81-309">Этот идентификатор формата используется целевым объектом для информирования объекта данных с помощью метода [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) , что операция удаления из операции вставки завершилась.</span><span class="sxs-lookup"><span data-stu-id="8ec81-309">This format identifier is used by the target to inform the data object, through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method, that a delete-on-paste operation succeeded.</span></span> <span data-ttu-id="8ec81-310">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-310">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-311">Элемент **хглобал** структуры указывает на **DWORD** , содержащий значение [**дропеффект**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-311">The structure's **hGlobal** member points to a **DWORD** containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span> <span data-ttu-id="8ec81-312">Этот формат используется для уведомления объекта данных о том, что он должен выполнить операцию вырезания и удалить исходные данные, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="8ec81-312">This format is used to notify the data object that it should complete the cut operation and delete the original data, if necessary.</span></span> <span data-ttu-id="8ec81-313">Дополнительные сведения см. [в разделе операции удаления при вставке](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="8ec81-313">For more information, see [Delete-on-Paste Operations](datascenarios.md).</span></span>

### <a name="cfstr_performeddropeffect"></a><span data-ttu-id="8ec81-314">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-314">CFSTR_PERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="8ec81-315">Этот идентификатор формата используется целевым объектом для информирования объекта данных через его метод [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) результата передачи данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-315">This format identifier is used by the target to inform the data object through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method of the outcome of a data transfer.</span></span> <span data-ttu-id="8ec81-316">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-316">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-317">Элемент **хглобал** структуры указывает **DWORD** , для которого задано соответствующее значение [**дропеффект**](../com/dropeffect-constants.md) , обычно DROPEFFECT_MOVE или DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="8ec81-317">The structure's **hGlobal** member points to a **DWORD** set to the appropriate [**DROPEFFECT**](../com/dropeffect-constants.md) value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY.</span></span>

<span data-ttu-id="8ec81-318">Этот формат обычно используется, когда результат операции может быть либо перемещением, либо копированием, например, в [оптимизированной операции перемещения](datascenarios.md) или удаления.</span><span class="sxs-lookup"><span data-stu-id="8ec81-318">This format is normally used when the outcome of an operation can be either move or copy, such as in an [optimized move](datascenarios.md) or delete-on-paste operation.</span></span> <span data-ttu-id="8ec81-319">Он обеспечивает надежный способ сообщить объекту данных о том, что именно произошло.</span><span class="sxs-lookup"><span data-stu-id="8ec81-319">It provides a reliable way for the target to tell the data object what actually happened.</span></span> <span data-ttu-id="8ec81-320">Оно было введено, поскольку значение *пдвеффект* , возвращенное [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) , не было уверенно указывать, какая операция была выполнена.</span><span class="sxs-lookup"><span data-stu-id="8ec81-320">It was introduced because the value of *pdwEffect* returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) did not reliably indicate which operation had taken place.</span></span> <span data-ttu-id="8ec81-321">Формат [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) является надежным способом указать, что было выполнено неоптимизированное перемещение.</span><span class="sxs-lookup"><span data-stu-id="8ec81-321">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format is the reliable way to indicate that an unoptimized move has taken place.</span></span>

### <a name="cfstr_preferreddropeffect"></a><span data-ttu-id="8ec81-322">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="8ec81-322">CFSTR_PREFERREDDROPEFFECT</span></span>

<span data-ttu-id="8ec81-323">Этот идентификатор формата используется источником для указания, следует ли перемещать или копировать предпочтительный метод передачи данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-323">This format identifier is used by the source to specify whether its preferred method of data transfer is move or copy.</span></span> <span data-ttu-id="8ec81-324">Цель перетаскивания запрашивает этот формат, вызывая метод [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) объекта данных.</span><span class="sxs-lookup"><span data-stu-id="8ec81-324">A drop target requests this format by calling the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span> <span data-ttu-id="8ec81-325">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-325">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-326">Элемент **хглобал** структуры указывает на значение **типа DWORD** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-326">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="8ec81-327">Это значение задается равным DROPEFFECT_MOVE, если операция перемещения является предпочтительной, или DROPEFFECT_COPY, если операция копирования является предпочтительной.</span><span class="sxs-lookup"><span data-stu-id="8ec81-327">This value is set to DROPEFFECT_MOVE if a move operation is preferred or DROPEFFECT_COPY if a copy operation is preferred.</span></span>

<span data-ttu-id="8ec81-328">Эта функция используется, когда источник может поддерживать операцию перемещения или копирования.</span><span class="sxs-lookup"><span data-stu-id="8ec81-328">This feature is used when a source can support either a move or copy operation.</span></span> <span data-ttu-id="8ec81-329">Для передачи предпочтений в целевой объект используется формат [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-329">It uses the [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) format to communicate its preference to the target.</span></span> <span data-ttu-id="8ec81-330">Поскольку целевой объект не обязан учитывать запрос, целевой объект должен вызвать метод [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) источника с [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) форматом, чтобы сообщить объекту данных, какая операция выполнялась фактически.</span><span class="sxs-lookup"><span data-stu-id="8ec81-330">Because the target is not obligated to honor the request, the target must call the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method with a [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format to tell the data object which operation was actually performed.</span></span>

<span data-ttu-id="8ec81-331">При использовании операции [удаления при вставке](datascenarios.md) используется формат CFSTR_PREFERREDDROPFORMAT, указывающий целевому объекту, что источник выполнил операцию вырезания или копирования.</span><span class="sxs-lookup"><span data-stu-id="8ec81-331">With a [delete-on-paste](datascenarios.md) operation, the CFSTR_PREFERREDDROPFORMAT format is used to tell the target whether the source did a cut or copy.</span></span> <span data-ttu-id="8ec81-332">С помощью операции перетаскивания можно указать действие оболочки с помощью CFSTR_PREFERREDDROPFORMAT.</span><span class="sxs-lookup"><span data-stu-id="8ec81-332">With a drag-and-drop operation, you can use CFSTR_PREFERREDDROPFORMAT to specify the Shell's action.</span></span> <span data-ttu-id="8ec81-333">Если этот формат отсутствует, оболочка выполняет действие по умолчанию на основе контекста.</span><span class="sxs-lookup"><span data-stu-id="8ec81-333">If this format is not present, the Shell performs a default action, based on context.</span></span> <span data-ttu-id="8ec81-334">Например, если пользователь перетаскивает файл из одного тома и перемещает его на другой том, действие оболочки по умолчанию — копирование файла.</span><span class="sxs-lookup"><span data-stu-id="8ec81-334">For instance, if a user drags a file from one volume and drops it on another volume, the Shell's default action is to copy the file.</span></span> <span data-ttu-id="8ec81-335">Включив в объект данных формат CFSTR_PREFERREDDROPFORMAT, можно переопределить действие по умолчанию и явно указать оболочке копировать, переместить или связать файл.</span><span class="sxs-lookup"><span data-stu-id="8ec81-335">By including a CFSTR_PREFERREDDROPFORMAT format in the data object, you can override the default action and explicitly tell the Shell to copy, move, or link the file.</span></span> <span data-ttu-id="8ec81-336">Если пользователь перетаскивайте с помощью правой кнопки, CFSTR_PREFERREDDROPFORMAT задает команду по умолчанию в контекстном меню [перетаскивания](context-menu-handlers.md) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-336">If the user chooses to drag with the right button, CFSTR_PREFERREDDROPFORMAT specifies the default command on the [drag-and-drop](context-menu-handlers.md) shortcut menu.</span></span> <span data-ttu-id="8ec81-337">Пользователь по-прежнему может выбрать другие команды в меню.</span><span class="sxs-lookup"><span data-stu-id="8ec81-337">The user is still free to choose other commands on the menu.</span></span>

<span data-ttu-id="8ec81-338">Перед браузером Microsoft Internet Explorer 4,0 приложение указало, что оно передает типы файлов ярлыков, задавая FD_LINKUI в элементе **dwFlags** структуры [**филедескриптор**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-338">Before Microsoft Internet Explorer 4.0, an application indicated that it was transferring shortcut file types by setting FD_LINKUI in the **dwFlags** member of the [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure.</span></span> <span data-ttu-id="8ec81-339">Целевым объектам пришлось бы использовать потенциально длительный вызов функции [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) , чтобы выяснить, установлен ли флаг FD_LINKUI.</span><span class="sxs-lookup"><span data-stu-id="8ec81-339">Targets then had to use a potentially time-consuming call to [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to find out if the FD_LINKUI flag was set.</span></span> <span data-ttu-id="8ec81-340">Теперь предпочтительным способом указать, что передаются ярлыки, является использование формата CFSTR_PREFERREDDROPEFFECT, для которого задано значение DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="8ec81-340">Now, the preferred way to indicate that shortcuts are being transferred is to use the CFSTR_PREFERREDDROPEFFECT format set to DROPEFFECT_LINK.</span></span> <span data-ttu-id="8ec81-341">Однако для обеспечения обратной совместимости со старыми системами источники должны по-прежнему устанавливать флаг FD_LINKUI.</span><span class="sxs-lookup"><span data-stu-id="8ec81-341">However, for backward compatibility with older systems, sources should still set the FD_LINKUI flag.</span></span>

### <a name="cfstr_targetclsid"></a><span data-ttu-id="8ec81-342">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="8ec81-342">CFSTR_TARGETCLSID</span></span>

<span data-ttu-id="8ec81-343">Этот идентификатор формата используется целевым объектом для предоставления ему идентификатора CLSID источника.</span><span class="sxs-lookup"><span data-stu-id="8ec81-343">This format identifier is used by a target to provide its CLSID to the source.</span></span> <span data-ttu-id="8ec81-344">Данные представляют собой структуру [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащую объект глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-344">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-345">Элемент **хглобал** структуры указывает на идентификатор GUID CLSID целевого объекта перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="8ec81-345">The structure's **hGlobal** member points to the CLSID GUID of the drop target.</span></span>

<span data-ttu-id="8ec81-346">Этот формат используется в основном для разрешения удаления объектов путем их перетаскивания в корзину.</span><span class="sxs-lookup"><span data-stu-id="8ec81-346">This format is used primarily to allow objects to be deleted by dragging them to the Recycle Bin.</span></span> <span data-ttu-id="8ec81-347">При удалении объекта в корзине метод интерфейса [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) вызывается с CFSTR_TARGETCLSID ФОРМАТом CLSID в корзине (CLSID_RecycleBin).</span><span class="sxs-lookup"><span data-stu-id="8ec81-347">When an object is dropped in the Recycle Bin, the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method is called with a CFSTR_TARGETCLSID format set to the Recycle Bin's CLSID (CLSID_RecycleBin).</span></span> <span data-ttu-id="8ec81-348">Затем источник может удалить исходный объект.</span><span class="sxs-lookup"><span data-stu-id="8ec81-348">The source can then delete the original object.</span></span>

### <a name="cfstr_untrusteddragdrop"></a><span data-ttu-id="8ec81-349">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="8ec81-349">CFSTR_UNTRUSTEDDRAGDROP</span></span>

<span data-ttu-id="8ec81-350">Этот идентификатор формата используется Windows Internet Explorer и оболочкой Windows для предоставления механизма для блокировки или запроса операций перетаскивания, исходящих из Internet Explorer вместе с флагом [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-350">This format identifier is used by Windows Internet Explorer and the Windows Shell to provide a mechanism through which to block or prompt for drag-and-drop operations originating from Internet Explorer in conjunction with the [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag.</span></span>

<span data-ttu-id="8ec81-351">**CFSTR_UNTRUSTEDDRAGDROP** добавляется источником операции перетаскивания, чтобы указать, что объект данных может содержать ненадежные данные.</span><span class="sxs-lookup"><span data-stu-id="8ec81-351">**CFSTR_UNTRUSTEDDRAGDROP** is added by the source of a drag-and-drop operation to specify that the data object might contain untrustworthy data.</span></span> <span data-ttu-id="8ec81-352">Данные представлены структурой [**стгмедиум**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , содержащей глобальный объект памяти.</span><span class="sxs-lookup"><span data-stu-id="8ec81-352">The data is represented by an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="8ec81-353">Элемент **хглобал** структуры указывает **DWORD** , установленный в соответствующий флаг [**действия URL-адреса**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) , для проверки политики с помощью [**иинтернетсекуритиманажер::P роцессурлактион**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) , используя флаг [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-353">The structure's **hGlobal** member points to a **DWORD** set to an appropriate [**URL Action**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag to cause a policy check through the [**IInternetSecurityManager::ProcessUrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) method, using the [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) flag.</span></span>

### <a name="dragwindow"></a><span data-ttu-id="8ec81-354">драгвиндов</span><span class="sxs-lookup"><span data-stu-id="8ec81-354">DragWindow</span></span>

<span data-ttu-id="8ec81-355">Этот формат используется в операции перетаскивания для обнаружения изображения перетаскивания объекта (окна), чтобы визуальные сведения можно было обновлять динамически.</span><span class="sxs-lookup"><span data-stu-id="8ec81-355">This format is used in a drag-and-drop operation to identify an object's drag image (window) so that its visual information can be updated dynamically.</span></span> <span data-ttu-id="8ec81-356">Когда объект перетаскивается на целевой объект перетаскивания, приложение обновляет свою структуру [**дропдескриптион**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) в ответ на метод [**интерфейс IDropTarget::D раговер**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) или [**идропсаурце:: GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) .</span><span class="sxs-lookup"><span data-stu-id="8ec81-356">When an object is dragged over a drop target, an application updates its [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) structure in response to the [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) or [**IDropSource::GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) method.</span></span> <span data-ttu-id="8ec81-357">**Дропдескриптион** обновляется новым значением [**дропимажетипе**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) , указывающим на оформление, которое должно быть применено к визуальному элементу окна перетаскивания; Например, указывает, что файл копируется, а не перемещен, или что объект не может быть удален в это расположение.</span><span class="sxs-lookup"><span data-stu-id="8ec81-357">The **DROPDESCRIPTION** is updated with a new [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) value that indicates the decoration to be applied to the drag window's visual; for instance, an indication that the file is being copied rather than moved or that the object cannot be dropped to that location.</span></span> <span data-ttu-id="8ec81-358">Однако пока объект не получит [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) сообщение, визуальные элементы не будут обновлены.</span><span class="sxs-lookup"><span data-stu-id="8ec81-358">However, until the object receives a [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, the visuals are not updated.</span></span> <span data-ttu-id="8ec81-359">Этот формат предоставляет **HWND** окна, перетащив получателя, в отправителя сообщения **DDWM_UPDATEWINDOW** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-359">This format provides the **HWND** of the recipient drag window to the sender of the **DDWM_UPDATEWINDOW** message.</span></span>

<span data-ttu-id="8ec81-360">Данные буфера обмена имеют тип [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span><span class="sxs-lookup"><span data-stu-id="8ec81-360">The clipboard data is of type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span></span> <span data-ttu-id="8ec81-361">Это представление **HWND** в виде **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="8ec81-361">It is a **DWORD** representation of an **HWND**.</span></span> <span data-ttu-id="8ec81-362">Данные можно передать в функцию **улонгтохандле** , определенную в басетсд. h, чтобы предоставить 64-разрядный **HWND** для использования в 64-разрядной версии Windows.</span><span class="sxs-lookup"><span data-stu-id="8ec81-362">The data can be passed to the **ULongToHandle** function, defined in Basetsd.h, to provide a 64-bit **HWND** for use on 64-bit Windows.</span></span>

<span data-ttu-id="8ec81-363">Этот формат не требует включения Шлобж. h.</span><span class="sxs-lookup"><span data-stu-id="8ec81-363">This format does not require the inclusion of Shlobj.h.</span></span>

 

 
