---
description: Когда пользователь щелкает правой кнопкой мыши объект оболочки, контекстное меню, которое отображается, обычно содержит элемент свойства.
title: Обработчики страницы свойств
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103910768"
---
# <a name="property-sheet-handlers"></a><span data-ttu-id="81814-103">Обработчики страницы свойств</span><span class="sxs-lookup"><span data-stu-id="81814-103">Property Sheet Handlers</span></span>

<span data-ttu-id="81814-104">Когда пользователь щелкает правой кнопкой мыши объект оболочки, контекстное меню, которое отображается, обычно содержит элемент **Свойства** .</span><span class="sxs-lookup"><span data-stu-id="81814-104">When a user right-clicks a Shell object, the shortcut menu that is displayed normally includes a **Properties** item.</span></span> <span data-ttu-id="81814-105">При выборе этого элемента открывается страница свойств, позволяющая пользователю просматривать и в некоторых случаях изменять свойства объекта.</span><span class="sxs-lookup"><span data-stu-id="81814-105">Selecting that item launches a property sheet that allows the user to view, and in some cases modify, the object's properties.</span></span> <span data-ttu-id="81814-106">Эту вкладку свойств можно настроить, реализовав и зарегистрировав *обработчик страницы свойств*.</span><span class="sxs-lookup"><span data-stu-id="81814-106">You can customize this property sheet by implementing and registering a *property sheet handler*.</span></span>

<span data-ttu-id="81814-107">Общие процедуры для реализации и регистрации обработчика расширений оболочки обсуждаются в разделе [Создание обработчиков расширений оболочки](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="81814-107">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="81814-108">В этом документе рассматриваются аспекты реализации, характерные для обработчиков страниц свойств.</span><span class="sxs-lookup"><span data-stu-id="81814-108">This document focuses on those aspects of implementation that are specific to property sheet handlers.</span></span>

-   [<span data-ttu-id="81814-109">Как работают обработчики страниц свойств</span><span class="sxs-lookup"><span data-stu-id="81814-109">How Property Sheet Handlers Work</span></span>](#how-property-sheet-handlers-work)
-   [<span data-ttu-id="81814-110">Регистрация и реализация обработчика страницы свойств для подключенного диска</span><span class="sxs-lookup"><span data-stu-id="81814-110">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [<span data-ttu-id="81814-111">См. также</span><span class="sxs-lookup"><span data-stu-id="81814-111">Related topics</span></span>](#related-topics)

## <a name="how-property-sheet-handlers-work"></a><span data-ttu-id="81814-112">Как работают обработчики страниц свойств</span><span class="sxs-lookup"><span data-stu-id="81814-112">How Property Sheet Handlers Work</span></span>

<span data-ttu-id="81814-113">На следующем рисунке показана страница свойств текстового файла Windows XP.</span><span class="sxs-lookup"><span data-stu-id="81814-113">The following illustration shows the Properties property sheet for a Windows XP text file.</span></span>

![Страница свойств](images/propsheethandler1.jpg)

<span data-ttu-id="81814-115">На этом рисунке показана страница свойств по умолчанию, которая отображается для любого файла.</span><span class="sxs-lookup"><span data-stu-id="81814-115">This illustration shows the default Properties property sheet that is displayed for any file.</span></span> <span data-ttu-id="81814-116">Для многих таких вкладок свойств можно добавить одну или несколько страниц в страницу свойств путем реализации и регистрации обработчика страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="81814-116">For many such property sheets, you can add one or more pages to the property sheet by implementing and registering a property sheet handler.</span></span>

<span data-ttu-id="81814-117">Обработчики страниц свойств чаще всего регистрируются для [типа файлов](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="81814-117">Property sheet handlers are most commonly registered for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="81814-118">Каждый обработчик может добавить одну пользовательскую страницу в страницу свойств свойств для класса.</span><span class="sxs-lookup"><span data-stu-id="81814-118">Each handler can add one custom page to the Properties property sheet for the class.</span></span> <span data-ttu-id="81814-119">Обычно эти страницы предоставляют пользователям доступ к свойствам конкретного типа файлов.</span><span class="sxs-lookup"><span data-stu-id="81814-119">These pages typically give users access to properties that are specific to the particular file type.</span></span> <span data-ttu-id="81814-120">Например, тип файла, состоящий из текстовых документов, может отображать страницу, в которой указаны заголовок и автор, и выдержку документа.</span><span class="sxs-lookup"><span data-stu-id="81814-120">A file type consisting of text documents could, for instance, display a page that listed the title and author, and an abstract of the document.</span></span> <span data-ttu-id="81814-121">Особый случай такого типа обработчика страницы свойств используется для добавления страницы в страницу свойств для подключенного диска.</span><span class="sxs-lookup"><span data-stu-id="81814-121">A special case of this type of property sheet handler is used to add a page to the Properties property sheet for a mounted drive.</span></span>

<span data-ttu-id="81814-122">Другой способ использования обработчиков страниц свойств — заменить страницы в страницах свойств, отображаемых приложениями панели управления.</span><span class="sxs-lookup"><span data-stu-id="81814-122">The other use for property sheet handlers is to replace pages in the property sheets displayed by Control Panel applications.</span></span> <span data-ttu-id="81814-123">Производитель, например, может использовать обработчик страницы свойств для замены страницы **кнопок** в окне свойств **мыши** панели управления на страницу, настроенную для характеристик ее мыши.</span><span class="sxs-lookup"><span data-stu-id="81814-123">A mouse manufacturer, for instance, can use a property sheet handler to replace the **Buttons** page on the Control Panel's **Mouse Properties** property sheet with a page that is customized for the characteristics of its mouse.</span></span>

<span data-ttu-id="81814-124">Как и все обработчики расширений оболочки, обработчики страниц свойств — это объекты модели COM, реализованные в виде библиотек DLL.</span><span class="sxs-lookup"><span data-stu-id="81814-124">Like all Shell extension handlers, property sheet handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="81814-125">Помимо [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) и [**ишеллпропшитекст**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext), они должны экспортировать два интерфейса.</span><span class="sxs-lookup"><span data-stu-id="81814-125">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span></span>

<span data-ttu-id="81814-126">Интерфейс [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) используется оболочкой для инициализации обработчика.</span><span class="sxs-lookup"><span data-stu-id="81814-126">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface is used by the Shell to initialize the handler.</span></span> <span data-ttu-id="81814-127">Когда оболочка вызывает [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), она передает объект данных с именем объекта и указатель на список идентификаторов элементов (Пидл) папки, содержащей файл.</span><span class="sxs-lookup"><span data-stu-id="81814-127">When the Shell calls [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), it passes in a data object with the object's name, and the pointer to an item identifier list (PIDL) of the folder that contains the file.</span></span> <span data-ttu-id="81814-128">Параметр *хрегкэй* не используется с обработчиками страниц свойств.</span><span class="sxs-lookup"><span data-stu-id="81814-128">The *hRegKey* parameter is not used with property sheet handlers.</span></span> <span data-ttu-id="81814-129">Метод **ишеллекстинит:: Initialize** должен извлечь имя файла из объекта данных и сохранить имя и Пидл папки для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="81814-129">The **IShellExtInit::Initialize** method must extract the file name from the data object, and store the name and the folder's PIDL for later use.</span></span> <span data-ttu-id="81814-130">Дополнительные сведения см. в разделе *Реализация ишеллекстинит* для [создания обработчиков расширений оболочки](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="81814-130">For further details, see the *Implementing IShellExtInit* section of [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="81814-131">Оставшаяся часть операции выполняется через интерфейс [**ишеллпропшитекст**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) обработчика.</span><span class="sxs-lookup"><span data-stu-id="81814-131">The remainder of the operation takes place through the handler's [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface.</span></span> <span data-ttu-id="81814-132">Если страница свойств связана с типом файла, оболочка вызывает [**ишеллпропшитекст:: аддпажес**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) , чтобы разрешить обработчику добавить страницу на лист свойств.</span><span class="sxs-lookup"><span data-stu-id="81814-132">If the property sheet is associated with a file type, the Shell calls [**IShellPropSheetExt::AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) to allow the handler to add a page to the property sheet.</span></span> <span data-ttu-id="81814-133">Если страница свойств связана с приложением панели управления, оболочка вызывает [**ишеллпропшитекст:: реплацепаже**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) , чтобы разрешить обработчику заменить страницу.</span><span class="sxs-lookup"><span data-stu-id="81814-133">If the property sheet is associated with a Control Panel application, the Shell calls [**IShellPropSheetExt::ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) to allow the handler to replace a page.</span></span>

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a><span data-ttu-id="81814-134">Регистрация и реализация обработчика страницы свойств для подключенного диска</span><span class="sxs-lookup"><span data-stu-id="81814-134">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>

<span data-ttu-id="81814-135">У каждого подключенного диска есть страница свойств, которую может отобразить пользователь.</span><span class="sxs-lookup"><span data-stu-id="81814-135">Each mounted drive has a Properties sheet that can be displayed by the user.</span></span> <span data-ttu-id="81814-136">На следующем рисунке показана страница свойств для устройства чтения компакт-дисков.</span><span class="sxs-lookup"><span data-stu-id="81814-136">The following illustration shows a Properties property sheet for a CD-ROM drive.</span></span>

![Страница свойств "свойства компакт-диска"](images/propsheethandler2.jpg)

<span data-ttu-id="81814-138">Существует множество устройств, которые можно подключить как диски.</span><span class="sxs-lookup"><span data-stu-id="81814-138">There are a wide variety of devices that can be mounted as drives.</span></span> <span data-ttu-id="81814-139">Поскольку страница свойств по умолчанию, предназначенная для дисков, может быть недостаточно для некоторых устройств, можно реализовать обработчик страницы свойств, чтобы добавить страницу, относящуюся к подключенному устройству.</span><span class="sxs-lookup"><span data-stu-id="81814-139">Because the default property sheet, designed for disk drives, might not be sufficient for some devices, a property sheet handler can be implemented to add a page that is specific to the mounted device.</span></span> <span data-ttu-id="81814-140">Базовая реализация этого типа обработчика страницы свойств идентична описанной в разделе [Регистрация и реализация обработчика страницы свойств для типа файла](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)с двумя исключениями.</span><span class="sxs-lookup"><span data-stu-id="81814-140">The basic implementation of this type of property sheet handler is identical to that discussed in [How to Register and Implement a Property Sheet Handler for a File Type](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), with two exceptions.</span></span>

-   <span data-ttu-id="81814-141">Объект данных, передаваемый методу [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) обработчика, может содержать путь к диску в формате [кфстр \_ маунтедволуме](clipboard.md) вместо формата [CF \_ HDROP](clipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="81814-141">The data object passed to the handler's [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method may contain the drive path in the [CFSTR\_MOUNTEDVOLUME](clipboard.md) format instead of the [CF\_HDROP](clipboard.md) format.</span></span> <span data-ttu-id="81814-142">Формат CF \_ HDROP используется, когда устройство подключено к букве диска.</span><span class="sxs-lookup"><span data-stu-id="81814-142">The CF\_HDROP format is used when the device is mounted to a drive letter.</span></span> <span data-ttu-id="81814-143">Формат КФСТР \_ маунтедволуме используется с файловыми системами NTFS, если удаленное устройство подключено к папке, а не к букве диска.</span><span class="sxs-lookup"><span data-stu-id="81814-143">The CFSTR\_MOUNTEDVOLUME format is used with NTFS file systems when the remote device is mounted to a folder rather than to a drive letter.</span></span>
-   <span data-ttu-id="81814-144">Идентификатор GUID обработчика регистрируется в разделе **\_ \_ корневой** \\ **диск** \\ **шеллекс** \\ **пропертишисандлерс** раздела hKey classes.</span><span class="sxs-lookup"><span data-stu-id="81814-144">The handler's GUID is registered under the **HKEY\_CLASSES\_ROOT**\\**Drive**\\**shellex**\\**PropertySheetHandlers** key.</span></span>

## <a name="related-topics"></a><span data-ttu-id="81814-145">См. также</span><span class="sxs-lookup"><span data-stu-id="81814-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="81814-146">Регистрация и реализация обработчика страницы свойств для типа файла</span><span class="sxs-lookup"><span data-stu-id="81814-146">How to Register and Implement a Property Sheet Handler for a File Type</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[<span data-ttu-id="81814-147">Регистрация и реализация обработчика страницы свойств для приложения панели управления</span><span class="sxs-lookup"><span data-stu-id="81814-147">How to Register and Implement a Property Sheet Handler for a Control Panel Application</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
