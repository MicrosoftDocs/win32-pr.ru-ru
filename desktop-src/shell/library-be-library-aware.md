---
description: В этом разделе описываются некоторые моменты, которые следует учитывать при использовании библиотек в программе.
ms.assetid: 40ACC8F6-1416-4390-A8D7-8F924DC2C2FE
title: Использование библиотек в программе
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2812a66b148d9bd16fc3951efab64a4d37afaaff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104350355"
---
# <a name="using-libraries-in-your-program"></a><span data-ttu-id="a3422-103">Использование библиотек в программе</span><span class="sxs-lookup"><span data-stu-id="a3422-103">Using Libraries in your Program</span></span>

<span data-ttu-id="a3422-104">В этом разделе описываются некоторые моменты, которые следует учитывать при использовании библиотек в программе.</span><span class="sxs-lookup"><span data-stu-id="a3422-104">This topic describes some of the things to consider when using libraries in your program.</span></span>

<span data-ttu-id="a3422-105">В этом разделе:</span><span class="sxs-lookup"><span data-stu-id="a3422-105">In this topic:</span></span>

-   [<span data-ttu-id="a3422-106">Общие сведения о программировании библиотеки</span><span class="sxs-lookup"><span data-stu-id="a3422-106">Library programming overview</span></span>](#library-programming-overview)
-   [<span data-ttu-id="a3422-107">Программирование с использованием библиотек</span><span class="sxs-lookup"><span data-stu-id="a3422-107">Programming with Libraries</span></span>](#programming-with-libraries)
    -   [<span data-ttu-id="a3422-108">Переход от известных папок к библиотекам</span><span class="sxs-lookup"><span data-stu-id="a3422-108">Moving from Known Folders to Libraries</span></span>](#moving-from-known-folders-to-libraries)
    -   [<span data-ttu-id="a3422-109">Домашняя группа и общие библиотеки</span><span class="sxs-lookup"><span data-stu-id="a3422-109">HomeGroup and shared libraries</span></span>](#homegroup-and-shared-libraries)
-   [<span data-ttu-id="a3422-110">Использование общего диалогового окна "файлы" с библиотеками</span><span class="sxs-lookup"><span data-stu-id="a3422-110">Using a common file dialog box with libraries</span></span>](#using-a-common-file-dialog-box-with-libraries)
-   [<span data-ttu-id="a3422-111">Включение выбора библиотек из пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="a3422-111">Enabling library selection from the user interface</span></span>](#enabling-library-selection-from-the-user-interface)
-   [<span data-ttu-id="a3422-112">Доступ к содержимому библиотеки в программе</span><span class="sxs-lookup"><span data-stu-id="a3422-112">Accessing library content in a program</span></span>](#accessing-library-content-in-a-program)
    -   [<span data-ttu-id="a3422-113">Доступ к содержимому библиотеки с помощью интерфейса Ишелллибрари</span><span class="sxs-lookup"><span data-stu-id="a3422-113">Accessing library content with the IShellLibrary interface</span></span>](#accessing-library-content-with-the-ishelllibrary-interface)
    -   [<span data-ttu-id="a3422-114">Доступ к содержимому библиотеки с помощью интерфейсов API оболочки</span><span class="sxs-lookup"><span data-stu-id="a3422-114">Accessing library content with the Shell APIs</span></span>](#accessing-library-content-with-the-shell-apis)
-   [<span data-ttu-id="a3422-115">Сохранение содержимого пользователя в библиотеке</span><span class="sxs-lookup"><span data-stu-id="a3422-115">Saving user content in a library</span></span>](#saving-user-content-in-a-library)
-   [<span data-ttu-id="a3422-116">Поддержка операций перетаскивания в библиотеке</span><span class="sxs-lookup"><span data-stu-id="a3422-116">Supporting drag-and-drop operations in a library</span></span>](#supporting-drag-and-drop-operations-in-a-library)
-   [<span data-ttu-id="a3422-117">Синхронизация с библиотекой</span><span class="sxs-lookup"><span data-stu-id="a3422-117">Keeping in sync with a library</span></span>](#keeping-in-sync-with-a-library)
    -   [<span data-ttu-id="a3422-118">Массовое обновление</span><span class="sxs-lookup"><span data-stu-id="a3422-118">Bulk Update</span></span>](#bulk-update)
    -   [<span data-ttu-id="a3422-119">Уведомление API оболочки</span><span class="sxs-lookup"><span data-stu-id="a3422-119">Shell API Notification</span></span>](#shell-api-notification)
    -   [<span data-ttu-id="a3422-120">Уведомление API файловой системы</span><span class="sxs-lookup"><span data-stu-id="a3422-120">File-system API Notification</span></span>](#file-system-api-notification)
-   [<span data-ttu-id="a3422-121">См. также</span><span class="sxs-lookup"><span data-stu-id="a3422-121">Related topics</span></span>](#related-topics)

## <a name="library-programming-overview"></a><span data-ttu-id="a3422-122">Общие сведения о программировании библиотеки</span><span class="sxs-lookup"><span data-stu-id="a3422-122">Library programming overview</span></span>

<span data-ttu-id="a3422-123">Библиотеки позволяют пользователям упорядочивать содержимое на основе файлов в удобном для них виде, не ограничиваясь организацией файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-123">Libraries enable users to organize their file-based content in a way that is meaningful to them and not limited by the organization of the file system.</span></span> <span data-ttu-id="a3422-124">Когда программа поддерживает библиотеки, она позволяет пользователю найти свое содержимое в удобном для них виде, одновременно предоставляя пользовательский интерфейс, совместимый с пользователем Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-124">When your program supports libraries, it allows the user to find their content in a way that makes sense to them while presenting a user interface that is consistent with the Windows 7 user experience.</span></span> <span data-ttu-id="a3422-125">Библиотеки также упрощают программу для размещения файлового содержимого, хранящегося в разных папках или на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="a3422-125">Libraries also make it easier for your program to locate file-based content that is stored in different folders or on different machines.</span></span>

<span data-ttu-id="a3422-126">В подразделах этого раздела описывается, как можно добавить в программу поддержку библиотек и воспользоваться новыми возможностями, предлагаемыми библиотеками.</span><span class="sxs-lookup"><span data-stu-id="a3422-126">The topics in this section describe how you can add library support to your program and take advantage of the new capabilities that libraries offer.</span></span> <span data-ttu-id="a3422-127">По умолчанию Windows 7 предоставляет некоторую эту поддержку.</span><span class="sxs-lookup"><span data-stu-id="a3422-127">Windows 7 provides some of this support by default.</span></span> <span data-ttu-id="a3422-128">Если программа не изменяет общие диалоговые окна файлов, которые в настоящее время используются, для поддержки библиотек может потребоваться очень немного дополнительного программирования.</span><span class="sxs-lookup"><span data-stu-id="a3422-128">If your program does not modify the common file dialog boxes that it currently uses, it might require very little additional programming to support libraries.</span></span>

<span data-ttu-id="a3422-129">В этом разделе описываются некоторые основные функции, предоставляемые библиотеками, и способы их поддержки в программе.</span><span class="sxs-lookup"><span data-stu-id="a3422-129">This section describes some of the key features that libraries provide and how to support them in your program.</span></span> <span data-ttu-id="a3422-130">С помощью этой информации вы можете выбрать, какие функции будут обеспечивать оптимальное взаимодействие с пользователем в вашей программе.</span><span class="sxs-lookup"><span data-stu-id="a3422-130">With this information, you can decide which features will provide the best user experience from your program.</span></span> <span data-ttu-id="a3422-131">Если программа настраивает общие диалоговые окна файла, сведения в этом разделе помогут определить, как использовать новые общие диалоговые окна файла для использования библиотек и обеспечения эквивалентной функциональности в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-131">If your program customizes the common file dialog boxes, the information in this section can help you determine how to use the new common file dialog boxes to use libraries and provide equivalent functionality in Windows 7.</span></span>

## <a name="programming-with-libraries"></a><span data-ttu-id="a3422-132">Программирование с использованием библиотек</span><span class="sxs-lookup"><span data-stu-id="a3422-132">Programming with Libraries</span></span>

<span data-ttu-id="a3422-133">Модель программирования оболочки Windows описывает, как программа взаимодействует с объектами программирования оболочки Windows.</span><span class="sxs-lookup"><span data-stu-id="a3422-133">The Windows Shell programming model describes how a program interacts with Windows Shell programming objects.</span></span> <span data-ttu-id="a3422-134">Хотя объекты файловой системы, такие как файлы и каталоги, представлены объектами оболочки Windows, не все объекты оболочки Windows представлены файловой системой.</span><span class="sxs-lookup"><span data-stu-id="a3422-134">While file-system objects, such as files and directories, are represented by Windows Shell objects, not all Windows Shell objects are represented by the file-system.</span></span> <span data-ttu-id="a3422-135">Библиотеки, например, являются объектами оболочки Windows, которые не имеют эквивалента файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-135">Libraries, for example, are Windows Shell objects that do not have a file-system equivalent.</span></span> <span data-ttu-id="a3422-136">Использование объектов оболочки Windows в программе позволяет программе обращаться ко всем объектам оболочки, а не только к объектам файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-136">Using Windows Shell objects in your program enables your program to access all Shell objects and not just file-system objects.</span></span>

<span data-ttu-id="a3422-137">Для получения наилучших результатов ваша программа будет использовать [**API библиотеки оболочки**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) для взаимодействия с библиотеками и доступа к их содержимому.</span><span class="sxs-lookup"><span data-stu-id="a3422-137">For the best results, your program would use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) to interact with libraries and access their contents.</span></span> <span data-ttu-id="a3422-138">Хотя библиотеки содержат элементы файловой системы, такие как папки и файлы, библиотеки не являются элементами файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-138">While libraries contain file-system items such as folders and files, libraries are not file-system items.</span></span> <span data-ttu-id="a3422-139">Таким образом, интерфейсы API файловой системы не могут использоваться для доступа к возможностям библиотеки или содержимому библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-139">As such, file-system APIs cannot be used to access library features or library contents.</span></span>

<span data-ttu-id="a3422-140">Если у вас уже есть программа, использующая множество API-интерфейсов файловой системы, ваша программа по-прежнему может воспользоваться возможностями библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-140">If you have an existing program that currently uses many file-system APIs, your program can still take advantage of library features.</span></span> <span data-ttu-id="a3422-141">[**API библиотеки оболочки**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) может предоставлять ссылки файловой системы на элементы, находящиеся в библиотеке, и эти ссылки на системные файлы, такие как имя файла и путь, могут передаваться в существующие API-компоненты файловой системы, находящиеся в существующей программе.</span><span class="sxs-lookup"><span data-stu-id="a3422-141">The [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) can provide file-system references to the items that are found in a library and these file-system references, such as the file name and path, can be passed to the existing file-system APIs that are in your existing program.</span></span>

### <a name="moving-from-known-folders-to-libraries"></a><span data-ttu-id="a3422-142">Переход от известных папок к библиотекам</span><span class="sxs-lookup"><span data-stu-id="a3422-142">Moving from Known Folders to Libraries</span></span>

<span data-ttu-id="a3422-143">До Windows 7 было распространено использование известной папки, например папки Мои документы, в качестве папки по умолчанию в операциях сохранения или открытия файлов.</span><span class="sxs-lookup"><span data-stu-id="a3422-143">Before Windows 7 it was common to use a known folder, such as the My Documents folder, as the default folder in file save or file open operations.</span></span> <span data-ttu-id="a3422-144">В Windows 7 должна использоваться соответствующая библиотека, чтобы пользователь мог работать в программе так же, как и с другими программами Windows 7, например с проводником Windows.</span><span class="sxs-lookup"><span data-stu-id="a3422-144">In Windows 7, the corresponding library should be used so the user will have the same experience in your program as they would with other Windows 7 programs, such as the Windows Explorer.</span></span>

<span data-ttu-id="a3422-145">Если в вашей программе используется API оболочки Windows, Добавление поддержки библиотеки не вызывает затруднений.</span><span class="sxs-lookup"><span data-stu-id="a3422-145">If you are currently using the Windows Shell API in your program, adding library support is straightforward.</span></span> <span data-ttu-id="a3422-146">Например, если в данный момент вызывается функция [**шжеткновнфолдеритем**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) для получения расположения папки «Мои документы», можно заменить значение [**кновнфолдерид**](knownfolderid.md) в известной папке «Мои документы» значением **кновнфолдерид** соответствующей библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-146">For example, if you currently call the [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) function to get the location of the My Documents folder, you can replace the [**KNOWNFOLDERID**](knownfolderid.md) value of the My Documents known folder with the **KNOWNFOLDERID** value of the corresponding library.</span></span>

<span data-ttu-id="a3422-147">В следующей таблице показана связь между значениями [**кновнфолдерид**](knownfolderid.md) известных папок и значением **кновнфолдерид** соответствующей библиотеки в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-147">The following table shows the relationship between the [**KNOWNFOLDERID**](knownfolderid.md) values of known folders and the **KNOWNFOLDERID** value of the corresponding library in Windows 7.</span></span> 

| <span data-ttu-id="a3422-148">Значения КНОВНФОЛДЕРИД известных папок</span><span class="sxs-lookup"><span data-stu-id="a3422-148">Known Folder KNOWNFOLDERID values</span></span> | <span data-ttu-id="a3422-149">Значения КНОВНФОЛДЕРИД библиотеки</span><span class="sxs-lookup"><span data-stu-id="a3422-149">Library KNOWNFOLDERID values</span></span> |
|-----------------------------------|------------------------------|
| <span data-ttu-id="a3422-150">\_Документы FOLDERID</span><span class="sxs-lookup"><span data-stu-id="a3422-150">FOLDERID\_Documents</span></span>               | <span data-ttu-id="a3422-151">FOLDERID \_ документслибрари</span><span class="sxs-lookup"><span data-stu-id="a3422-151">FOLDERID\_DocumentsLibrary</span></span>   |
| <span data-ttu-id="a3422-152">FOLDERID \_ изображения</span><span class="sxs-lookup"><span data-stu-id="a3422-152">FOLDERID\_Pictures</span></span>                | <span data-ttu-id="a3422-153">FOLDERID \_ пиктуреслибрари</span><span class="sxs-lookup"><span data-stu-id="a3422-153">FOLDERID\_PicturesLibrary</span></span>    |
| <span data-ttu-id="a3422-154">FOLDERID \_ музыка</span><span class="sxs-lookup"><span data-stu-id="a3422-154">FOLDERID\_Music</span></span>                   | <span data-ttu-id="a3422-155">FOLDERID \_ мусиклибрари</span><span class="sxs-lookup"><span data-stu-id="a3422-155">FOLDERID\_MusicLibrary</span></span>       |
| <span data-ttu-id="a3422-156">FOLDERID \_ рекордедтв</span><span class="sxs-lookup"><span data-stu-id="a3422-156">FOLDERID\_RecordedTV</span></span>              | <span data-ttu-id="a3422-157">FOLDERID \_ рекордедтвлибрари</span><span class="sxs-lookup"><span data-stu-id="a3422-157">FOLDERID\_RecordedTVLibrary</span></span>  |



 

### <a name="homegroup-and-shared-libraries"></a><span data-ttu-id="a3422-158">Домашняя группа и общие библиотеки</span><span class="sxs-lookup"><span data-stu-id="a3422-158">HomeGroup and shared libraries</span></span>

<span data-ttu-id="a3422-159">Добавление поддержки библиотек в вашу программу включит поддержку общих библиотек в домашней группе.</span><span class="sxs-lookup"><span data-stu-id="a3422-159">Adding library support to your program will enable support for shared libraries in a HomeGroup.</span></span> <span data-ttu-id="a3422-160">Домашняя группа идентифицируется по [](knownfolderid.md) значению кновнфолдерид [**в \_ домашней группе FOLDERID**](knownfolderid.md).</span><span class="sxs-lookup"><span data-stu-id="a3422-160">The HomeGroup is identified by its [**KNOWNFOLDERID**](knownfolderid.md) value of [**FOLDERID\_HomeGroup**](knownfolderid.md).</span></span> <span data-ttu-id="a3422-161">Программа может найти закрытое или общее расположение сохранения по умолчанию пользователя, задав значение [**дефаултсавефолдертипе**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) в вызове метода [**Ишелллибрари:: жетдефаултсавефолдер**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) .</span><span class="sxs-lookup"><span data-stu-id="a3422-161">Your program can find identify the user's private or shared default save location by setting the [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) value in the call to [**IShellLibrary::GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) method.</span></span>

## <a name="using-a-common-file-dialog-box-with-libraries"></a><span data-ttu-id="a3422-162">Использование общего диалогового окна "файлы" с библиотеками</span><span class="sxs-lookup"><span data-stu-id="a3422-162">Using a common file dialog box with libraries</span></span>

<span data-ttu-id="a3422-163">Использование общего файлового диалогового окна с библиотеками. диалоговое окно «Common File» было обновлено для поддержки библиотек в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-163">Using a common file dialog box with libraries The common file dialog box has been updated to support libraries in Windows 7.</span></span> <span data-ttu-id="a3422-164">На следующем рисунке показано, как открывается диалоговое окно Common File для пользователя в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-164">The following illustration shows how the common file dialog box appears to a user in Windows 7.</span></span>

![снимок экрана с диалоговым окном "общие файлы", в котором отображаются библиотеки](images/libraries-commonfiledialog.png)

<span data-ttu-id="a3422-166">В Windows 7, если в настоящий момент программа отображает общий файловый диалог и не изменяет шаблон диалогового окна или не привязывает какие-либо события, она автоматически отображает новую версию диалогового окна Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-166">In Windows 7, if your program currently displays a common file dialog box and does not change the dialog box template or hook any of its events, it will display the new Windows 7 version of the dialog box automatically.</span></span> <span data-ttu-id="a3422-167">В частности, в вызове функции диалогового окна common File элементы **лпфнхук**, **HINSTANCE**, **Лптемплатенаме** структуры [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) должны иметь **значение NULL** , а флаги **ОФН \_ енаблехук** и **ОФН \_ енаблетемплате** должны быть четкими.</span><span class="sxs-lookup"><span data-stu-id="a3422-167">Specifically, in the call to the common file dialog box function, the **lpfnHook**, **hInstance**, **lpTemplatename** members of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must be **NULL** and the **OFN\_ENABLEHOOK** and **OFN\_ENABLETEMPLATE** flags must be clear.</span></span>

<span data-ttu-id="a3422-168">В Windows 7 интерфейсы, связанные с [**ифиледиалог**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog), заменяют общие функции диалогового окна файла, которые использовались в более ранних версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="a3422-168">In Windows 7, the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces replace the common file dialog box functions that were used in earlier versions of Windows.</span></span> <span data-ttu-id="a3422-169">Более ранние распространенные функции диалогового окна файла по-прежнему поддерживаются в Windows 7, но они не обеспечивают полноценного взаимодействия с пользователем Windows 7 и не поддерживают библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-169">The earlier common file dialog box functions are still supported in Windows 7 but they do not provide the complete Windows 7 user experience and they do not support libraries.</span></span> <span data-ttu-id="a3422-170">Ниже перечислены некоторые новые возможности, поддерживаемые интерфейсами, связанными с **ифиледиалог**.</span><span class="sxs-lookup"><span data-stu-id="a3422-170">Some of the new features supported by the **IFileDialog**-related interfaces include:</span></span>

-   <span data-ttu-id="a3422-171">Пользователь может получить доступ к свойствам файла, поддерживаемым проводником Windows 7, для поиска и выбора файлов.</span><span class="sxs-lookup"><span data-stu-id="a3422-171">The user can access the file properties supported by the Windows 7 Windows Explorer to search and select the files.</span></span>
-   <span data-ttu-id="a3422-172">Программа может использовать интерфейсы и методы из API пространства имен оболочки для работы с элементами.</span><span class="sxs-lookup"><span data-stu-id="a3422-172">The program can use interfaces and methods from the Shell namespace API to work with the items.</span></span>
-   <span data-ttu-id="a3422-173">Программа может использовать модель настройки на основе данных вместо модели настройки на основе файлов ресурсов для добавления новых элементов управления в общие диалоговые окна файла.</span><span class="sxs-lookup"><span data-stu-id="a3422-173">The program can use a data-driven customization model instead of a resource-file-driven customization model to add new controls to the common file dialog boxes.</span></span>

<span data-ttu-id="a3422-174">Интерфейсы, связанные с [**ифиледиалог**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog), следует использовать в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="a3422-174">You should use the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces when:</span></span>

-   <span data-ttu-id="a3422-175">необходимо настроить диалоговое окно Common File для программы в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-175">you need to customize the common file dialog box for your program in Windows 7.</span></span> <span data-ttu-id="a3422-176">Это позволит программе работать с библиотеками и поддерживать настройку диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="a3422-176">This will allow your program to work with libraries and support customizing your dialog box.</span></span>
-   <span data-ttu-id="a3422-177">Вы хотите, чтобы пользователь мог выбрать несколько файлов в диалоговом окне общего файла.</span><span class="sxs-lookup"><span data-stu-id="a3422-177">you want the user to be able to select multiple files from a common file dialog box.</span></span> <span data-ttu-id="a3422-178">Это обеспечит получение правильных путей к выбранному объекту, так как библиотека может содержать содержимое, которое хранится в разных папках.</span><span class="sxs-lookup"><span data-stu-id="a3422-178">This will ensure you get the correct paths to the selected object because a library can have contents that are stored in different folders.</span></span>

<span data-ttu-id="a3422-179">Дополнительные сведения о интерфейсах, связанных с [**ифиледиалог**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog), см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="a3422-179">For more information on the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces, see:</span></span>

-   [<span data-ttu-id="a3422-180">**ифиледиалог**</span><span class="sxs-lookup"><span data-stu-id="a3422-180">**IFileDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)
-   [<span data-ttu-id="a3422-181">**ифилеопендиалог**</span><span class="sxs-lookup"><span data-stu-id="a3422-181">**IFileOpenDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)
-   [<span data-ttu-id="a3422-182">**ифилесаведиалог**</span><span class="sxs-lookup"><span data-stu-id="a3422-182">**IFileSaveDialog**</span></span>](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog)
-   [<span data-ttu-id="a3422-183">**ифиледиалогкустомизе**</span><span class="sxs-lookup"><span data-stu-id="a3422-183">**IFileDialogCustomize**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)
-   [<span data-ttu-id="a3422-184">**ифиледиаложевентс**</span><span class="sxs-lookup"><span data-stu-id="a3422-184">**IFileDialogEvents**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogevents)
-   [<span data-ttu-id="a3422-185">**ифиледиалогконтролевентс**</span><span class="sxs-lookup"><span data-stu-id="a3422-185">**IFileDialogControlEvents**</span></span>](/windows/desktop/api/Shobjidl/nn-shobjidl-ifiledialogcontrolevents)

## <a name="enabling-library-selection-from-the-user-interface"></a><span data-ttu-id="a3422-186">Включение выбора библиотек из пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="a3422-186">Enabling library selection from the user interface</span></span>

<span data-ttu-id="a3422-187">Если программа позволяет пользователю выбрать папку (например, функции импорта или экспорта) в Windows 7, она также должна позволять пользователю выбрать библиотеку.</span><span class="sxs-lookup"><span data-stu-id="a3422-187">If your program allows the user to select a folder, such as for import or export functions, in Windows 7, it should allow the user to select a library as well.</span></span> <span data-ttu-id="a3422-188">Интерфейс [**ифилеопендиалог**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) и функция [**шбровсефорфолдер**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) позволяют пользователю выбрать библиотеку, когда будет предложено выбрать папку.</span><span class="sxs-lookup"><span data-stu-id="a3422-188">The [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface and [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) function allow the user to select a library when prompted to select a folder.</span></span> <span data-ttu-id="a3422-189">Интерфейс **ифилеопендиалог** является предпочтительным по сравнению с функцией **шбровсефорфолдер** , так как **ифилеопендиалог** поддерживает пользовательский интерфейс Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a3422-189">The **IFileOpenDialog** interface is preferred over the **SHBrowseForFolder** function because **IFileOpenDialog** supports the Windows 7 user interface.</span></span>

<span data-ttu-id="a3422-190">Чтобы разрешить пользователям выбирать папки при использовании интерфейса [**ифилеопендиалог**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) , вызовите сетоптионс с \_ установленным флагом Фос пиккфолдерс и убедитесь, что \_ флаг Фос форцефилесистем снят.</span><span class="sxs-lookup"><span data-stu-id="a3422-190">To allow users to select folders when using the [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface, call SetOptions with the FOS\_PICKFOLDERS flag set and make sure the FOS\_FORCEFILESYSTEM flag is clear.</span></span>


```C++
FILEOPENDIALOGOPTIONS fileOptions;

hr = fileOpenDialogBox->GetOptions(&fileOptions);
fileOptions = fileOptions | FOS_PICKFOLDERS | ~FOS_FORCEFILESYSTEM;
hr = fileOpenDialogBox->SetOptions(fileOptions);
```



<span data-ttu-id="a3422-191">Чтобы разрешить пользователям выбирать папки при вызове функции Шбровсефорфолдер, в элементе Улфлагс структуры [**бровсеинфо**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) установите \_ флаг bЕсли усеневуи и снимите \_ флаг bЕсли ретурнонлифсдирс.</span><span class="sxs-lookup"><span data-stu-id="a3422-191">To allow users to select folders when calling the SHBrowseForFolder function, in the ulFlags member of the [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) structure, set the BIF\_USENEWUI flag and clear the BIF\_RETURNONLYFSDIRS flag.</span></span>


```C++
BROWSEINFO    browseInfo;
browseInfo.ulFlags = BIF_USENEWUI | ~BIF_RETURNONLYFSDIRS;
// Set other member values
pidl = SHBrowseForFolder(&browseInfo);
```



## <a name="accessing-library-content-in-a-program"></a><span data-ttu-id="a3422-192">Доступ к содержимому библиотеки в программе</span><span class="sxs-lookup"><span data-stu-id="a3422-192">Accessing library content in a program</span></span>

<span data-ttu-id="a3422-193">Для доступа к содержимому библиотеки необходимо использовать API оболочки Windows.</span><span class="sxs-lookup"><span data-stu-id="a3422-193">To access the contents of a library, you must use the Windows Shell API.</span></span> <span data-ttu-id="a3422-194">Функции API файловой системы не могут использоваться для доступа к содержимому библиотеки, поскольку библиотеки не являются объектами файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-194">Functions of the file-system API cannot be used to access library contents because libraries are not file-system objects.</span></span> <span data-ttu-id="a3422-195">Если программа использует пользовательский обозреватель файлов, основанный на API файловой системы, он не сможет просматривать библиотеки или доступ к содержимому библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-195">If your program uses a custom file browser that is based on the file-system API, it will not be able to browse libraries or access library content.</span></span>

<span data-ttu-id="a3422-196">В этом разделе описывается, как можно получить доступ к содержимому библиотеки, чтобы можно было выбрать лучший способ обновления программы для работы с библиотеками.</span><span class="sxs-lookup"><span data-stu-id="a3422-196">This section describes how you can access library content so that you can select the best way to update your program to work with libraries.</span></span>

### <a name="accessing-library-content-with-the-ishelllibrary-interface"></a><span data-ttu-id="a3422-197">Доступ к содержимому библиотеки с помощью интерфейса Ишелллибрари</span><span class="sxs-lookup"><span data-stu-id="a3422-197">Accessing library content with the IShellLibrary interface</span></span>

<span data-ttu-id="a3422-198">Самым простым способом доступа программы к содержимому библиотеки является использование [**API библиотеки оболочки**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span><span class="sxs-lookup"><span data-stu-id="a3422-198">The easiest way for a program to access library content is to use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span></span> <span data-ttu-id="a3422-199">При работе с программой, использующей API файловой системы, **API библиотеки оболочки** может возвращать папки файловой системы библиотеки, что позволяет избежать изменения существующего программного кода.</span><span class="sxs-lookup"><span data-stu-id="a3422-199">If you are working on a program that uses the file-system API, the **Shell Library API** can return the file-system folders of a library, which minimizes the change to your existing program code.</span></span>


```C++
IShellLibrary *picturesLibrary;

hr = SHLoadLibraryFromKnownFolder(FOLDERID_PicturesLibrary, 
                                  STGM_READ, 
                                  IID_PPV_ARGS(&picturesLibrary));

// picturesLibrary now points to the user's picture library
    
IShellItemArray *pictureFolders; 

hr = pslLibrary->GetFolders(LFF_FORCEFILESYSTEM, IID_PPV_ARGS(&pictureFolders));

// pictureFolders now contains an array of Shell items that
// represent the folders found in the user's pictures library
```



### <a name="accessing-library-content-with-the-shell-apis"></a><span data-ttu-id="a3422-200">Доступ к содержимому библиотеки с помощью интерфейсов API оболочки</span><span class="sxs-lookup"><span data-stu-id="a3422-200">Accessing library content with the Shell APIs</span></span>

<span data-ttu-id="a3422-201">Поскольку объекты библиотеки являются частью модели программирования оболочки, их можно использовать с другими API-интерфейсами оболочки Windows.</span><span class="sxs-lookup"><span data-stu-id="a3422-201">Because the library objects are part of the Shell programming model, they can be used with other Windows Shell APIs.</span></span> <span data-ttu-id="a3422-202">Например, вы можете использовать в программе интерфейсы [**интерфейса IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) и [**ишеллфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) , а также связанные вспомогательные функции для доступа к содержимому библиотеки таким же образом, как при перечислении папок и содержимого папок для доступа к содержимому с помощью API файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-202">For example you can use the [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) and [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interfaces in your program, along with related helper functions, to access the contents of a library in the same way as you would enumerate folders and folder contents to access content with the file system APIs.</span></span>

<span data-ttu-id="a3422-203">Интерфейсы API оболочки Windows поддерживают два режима перечисления для доступа к содержимому библиотеки:</span><span class="sxs-lookup"><span data-stu-id="a3422-203">The Windows Shell APIs support two enumeration modes to access the contents of a library:</span></span>

-   <span data-ttu-id="a3422-204">**Обзор перечисления**</span><span class="sxs-lookup"><span data-stu-id="a3422-204">**Browse enumeration**</span></span>

    <span data-ttu-id="a3422-205">Обзор перечисления является режимом перечисления по умолчанию и перечисляет содержимое папки библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-205">Browse enumeration is the default enumeration mode and enumerates the contents of a library folder.</span></span> <span data-ttu-id="a3422-206">Снимите \_ \_ флаг ПЕРЕЧИСЛЕНИЯ навигации шконтф, чтобы использовать этот режим.</span><span class="sxs-lookup"><span data-stu-id="a3422-206">Clear the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

-   <span data-ttu-id="a3422-207">**Перечисление навигации**</span><span class="sxs-lookup"><span data-stu-id="a3422-207">**Navigation enumeration**</span></span>

    <span data-ttu-id="a3422-208">Перечисление навигации перечисляет папки библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-208">Navigation enumeration enumerates the library folders.</span></span> <span data-ttu-id="a3422-209">Установите \_ \_ флаг ПЕРЕЧИСЛЕНИЯ навигации шконтф, чтобы использовать этот режим.</span><span class="sxs-lookup"><span data-stu-id="a3422-209">Set the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

<span data-ttu-id="a3422-210">Если программа использует настраиваемый элемент управления "дерево" для навигации по папкам пользователя, то перечисление папок в режиме перечисления навигации предоставит список папок библиотеки, которые соответствуют способу перечисления папок в Windows 7 в проводнике.</span><span class="sxs-lookup"><span data-stu-id="a3422-210">If your program uses a custom tree control to navigate the user's folders, enumerating the folders in the navigation enumeration mode will give you a list of a library's folders that is consistent with how the Windows Explorer enumerates folders in Windows 7.</span></span>

<span data-ttu-id="a3422-211">Примеры использования этих функций в программе см. в примере Шеллстораже на Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="a3422-211">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="saving-user-content-in-a-library"></a><span data-ttu-id="a3422-212">Сохранение содержимого пользователя в библиотеке</span><span class="sxs-lookup"><span data-stu-id="a3422-212">Saving user content in a library</span></span>

<span data-ttu-id="a3422-213">Программа может сохранять содержимое пользователя в библиотеке, а также в папке в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-213">Your program can save user content to a library as well as to a folder in the library.</span></span> <span data-ttu-id="a3422-214">Аналогичным образом пользователь может сохранять данные в определенной папке библиотеки или просто сохранять их в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-214">Likewise, the user can save to a specific folder in a library or they can just save to the library.</span></span>

<span data-ttu-id="a3422-215">Каждая библиотека содержит папку, которая назначается в качестве расположения для сохранения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a3422-215">Every library has a folder that is designated as the default save location.</span></span> <span data-ttu-id="a3422-216">Место сохранения по умолчанию определяется при создании библиотеки. Однако пользователь может переназначить расположение сохранения по умолчанию в любую папку в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-216">The default save location is defined when the library is created; however the user can reassign the default save location to be any folder in the library.</span></span> <span data-ttu-id="a3422-217">Хотя пользователю не нужно настраивать место сохранения по умолчанию, у него есть возможность изменить его.</span><span class="sxs-lookup"><span data-stu-id="a3422-217">While the user does not need to configure a default save location, they have the option to change it.</span></span> <span data-ttu-id="a3422-218">Если пользователь удаляет папку, которая в данный момент задана в качестве расположения для сохранения по умолчанию, библиотека автоматически настроит следующую папку в библиотеке в качестве расположения для сохранения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a3422-218">If the user deletes the folder that is currently set as the default save location, the library will automatically configure the next folder in the library to be the default save location.</span></span>

<span data-ttu-id="a3422-219">Существует несколько способов сохранения пользовательского содержимого в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-219">There are several ways you can save user content to a library.</span></span>

-   <span data-ttu-id="a3422-220">**API оболочки**</span><span class="sxs-lookup"><span data-stu-id="a3422-220">**Shell API**</span></span>

    <span data-ttu-id="a3422-221">Если вы используете модель программирования оболочки и сохраняете элемент оболочки, представленный [**интерфейса IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage или IStream, объекту библиотеки, элемент оболочки будет автоматически сохранен в месте сохранения библиотеки по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a3422-221">If you are using the Shell programming model and save a Shell item, as represented by an [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage, or IStream, to a library object, the Shell item will be automatically stored in the default save location of the library.</span></span>

-   <span data-ttu-id="a3422-222">**API файловой системы**</span><span class="sxs-lookup"><span data-stu-id="a3422-222">**File-system API**</span></span>

    <span data-ttu-id="a3422-223">Если у вас есть программа, использующая много вызовов API файловой системы, можно получить путь к папке, которая определена как расположение для сохранения по умолчанию для библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-223">If you have an existing program that uses many file-system API calls, you can get a path to the folder that is defined as the library's default save location.</span></span> <span data-ttu-id="a3422-224">Затем путь к папке можно передать в API файловой системы.</span><span class="sxs-lookup"><span data-stu-id="a3422-224">The folder path can then be passed to a file-system API.</span></span>

<span data-ttu-id="a3422-225">Примеры использования этих функций в программе см. в примере Шеллстораже на Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="a3422-225">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="supporting-drag-and-drop-operations-in-a-library"></a><span data-ttu-id="a3422-226">Поддержка операций перетаскивания в библиотеке</span><span class="sxs-lookup"><span data-stu-id="a3422-226">Supporting drag-and-drop operations in a library</span></span>

<span data-ttu-id="a3422-227">Если программа поддерживает действия по перетаскиванию, они должны быть обновлены для поддержки правильного взаимодействия с библиотекой.</span><span class="sxs-lookup"><span data-stu-id="a3422-227">If your program supports drag-and-drop actions, those should be updated to support the correct library interaction.</span></span> <span data-ttu-id="a3422-228">Если файл перемещается в библиотеку, то удаленный файл должен быть сохранен в месте сохранения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a3422-228">If a file is dropped into a library, the dropped file should be saved in the default save location.</span></span> <span data-ttu-id="a3422-229">При удалении папки в библиотеку удаленная папка должна быть добавлена в библиотеку в качестве новой папки.</span><span class="sxs-lookup"><span data-stu-id="a3422-229">If a folder is dropped into a library, the dropped folder should be added as a new folder to the library.</span></span> <span data-ttu-id="a3422-230">Если файл перемещается в существующую папку, которая не является местом сохранения по умолчанию, файл необходимо добавить в выбранную папку.</span><span class="sxs-lookup"><span data-stu-id="a3422-230">If a file is dropped into an existing folder that is not the default save location, the file should be added to the selected folder.</span></span>

<span data-ttu-id="a3422-231">Примеры добавления поддержки библиотек для программ перетаскивания см. в примере Шелллибрарикоммандлине на Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="a3422-231">For examples of how to add library support for your programs drag-and-drop functionality, see the ShellLibraryCommandLine sample in the Windows SDK.</span></span>

## <a name="keeping-in-sync-with-a-library"></a><span data-ttu-id="a3422-232">Синхронизация с библиотекой</span><span class="sxs-lookup"><span data-stu-id="a3422-232">Keeping in sync with a library</span></span>

<span data-ttu-id="a3422-233">В этом разделе описывается, как программа может регулярно просматривать содержимое библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-233">This topic describes how a program can keep its view of a library's content up-to-date.</span></span>

### <a name="bulk-update"></a><span data-ttu-id="a3422-234">Массовое обновление</span><span class="sxs-lookup"><span data-stu-id="a3422-234">Bulk Update</span></span>

<span data-ttu-id="a3422-235">Так как пользователь может изменять папки библиотеки интерактивно, когда программа не запущена, программа должна вызвать [**шресолвелибрари**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) , когда начнется обнаружение и сохранение изменений в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-235">Because the user can modify the folders of a library interactively when your program is not running, your program should call [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) when it starts to discover and store any changes to the library.</span></span> <span data-ttu-id="a3422-236">Интерфейс API оболочки предоставляет функцию **шресолвелибрари** , которая позволяет программе получать текущее содержимое библиотеки и текущие расположения любых папок, которые могут содержаться в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-236">The Shell API provides the **SHResolveLibrary** function to enable a program to get the current contents of a library and the current locations of any folders the library might contain.</span></span>

<span data-ttu-id="a3422-237">Обратите внимание, что [**шресолвелибрари**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) является блокирующей функцией, которая может занять много времени в зависимости от того, что изменилось в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-237">Note that [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) is a blocking function that could take a long time to return depending on what has changed in the library.</span></span> <span data-ttu-id="a3422-238">Таким образом, его не следует вызывать из потока пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a3422-238">As such, it should not be called from a UI thread.</span></span>

<span data-ttu-id="a3422-239">После того как программа будет обновлена, она может зарегистрироваться для получения уведомлений об изменениях, чтобы поддерживать текущее представление.</span><span class="sxs-lookup"><span data-stu-id="a3422-239">After the program has been brought up-to-date, it can then register for change notifications to maintain a current view.</span></span>

### <a name="shell-api-notification"></a><span data-ttu-id="a3422-240">Уведомление API оболочки</span><span class="sxs-lookup"><span data-stu-id="a3422-240">Shell API Notification</span></span>

<span data-ttu-id="a3422-241">Интерфейс API оболочки Windows предоставляет функцию [**шчанженотифирегистер**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) , которая является предпочтительным способом получения уведомления об изменениях в библиотеке для процессов, не относящихся к службе.</span><span class="sxs-lookup"><span data-stu-id="a3422-241">The Windows Shell API provides the [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) function, which is the preferred way for non-service processes to be notified of a change in the library.</span></span>

<span data-ttu-id="a3422-242">Чтобы обнаружить изменения в элементах библиотеки с помощью API оболочки Windows, вызовите [**шчанженотифирегистер**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) , чтобы зарегистрировать программу для уведомления об изменениях элементов в папке библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-242">To detect changes to items within a library using the Windows Shell API, call [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) to register your program for notifications of changes to items in a library folder.</span></span> <span data-ttu-id="a3422-243">Эта функция может уведомлять программу при наличии изменений в какой-либо библиотеке или только в определенной библиотеке.</span><span class="sxs-lookup"><span data-stu-id="a3422-243">This function can notify your program if there is a change in any library or just in a specific library.</span></span> <span data-ttu-id="a3422-244">Уведомления отправляются сразу после изменения библиотеки.</span><span class="sxs-lookup"><span data-stu-id="a3422-244">Notifications are sent immediately when a library is changed.</span></span>

### <a name="file-system-api-notification"></a><span data-ttu-id="a3422-245">Уведомление API файловой системы</span><span class="sxs-lookup"><span data-stu-id="a3422-245">File-system API Notification</span></span>

<span data-ttu-id="a3422-246">Уведомления файловой системы должны использоваться в процессах службы.</span><span class="sxs-lookup"><span data-stu-id="a3422-246">File system notifications must be used in service processes.</span></span>

<span data-ttu-id="a3422-247">Чтобы обнаружить изменения в элементах библиотеки с помощью API файловой системы, перечислите папки в библиотеке и вызовите [**финдфирстчанженотификатион**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) для каждой отслеживаемой папки.</span><span class="sxs-lookup"><span data-stu-id="a3422-247">To detect changes to items in a library using the file-system API, enumerate the folders in the library and call [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) for each folder to monitor.</span></span> <span data-ttu-id="a3422-248">Программа будет принимать уведомления при изменении наблюдаемой папки.</span><span class="sxs-lookup"><span data-stu-id="a3422-248">Your program will receive notification when a monitored folder changes.</span></span> <span data-ttu-id="a3422-249">Чтобы найти конкретный файл файлов, измененных в папке, вызовите [**реаддиректоричанжесв**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span><span class="sxs-lookup"><span data-stu-id="a3422-249">To find the specific file of files that changed in the folder, call [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span></span> <span data-ttu-id="a3422-250">Чтобы обнаружить изменения в файле описания библиотеки, отслеживайте папку, в которой он находится.</span><span class="sxs-lookup"><span data-stu-id="a3422-250">To detect changes in the library description file, monitor the folder that contains it.</span></span> <span data-ttu-id="a3422-251">Файл описания библиотеки можно найти в папке [**FOLDERID \_**](knownfolderid.md) librarys.</span><span class="sxs-lookup"><span data-stu-id="a3422-251">The library description file can be found in the [**FOLDERID\_Libraries**](knownfolderid.md) folder.</span></span> <span data-ttu-id="a3422-252">Однако файл описания библиотеки не должен быть открыт или изменен.</span><span class="sxs-lookup"><span data-stu-id="a3422-252">The library description file, however, should not be opened or modified.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a3422-253">См. также</span><span class="sxs-lookup"><span data-stu-id="a3422-253">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a3422-254">О библиотеках</span><span class="sxs-lookup"><span data-stu-id="a3422-254">About Libraries</span></span>](library-leverage-to-manage-folders.md)
</dt> <dt>

[<span data-ttu-id="a3422-255">**ишелллибрари**</span><span class="sxs-lookup"><span data-stu-id="a3422-255">**IShellLibrary**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)
</dt> <dt>

[<span data-ttu-id="a3422-256">Ссылки оболочки</span><span class="sxs-lookup"><span data-stu-id="a3422-256">Shell Links</span></span>](./links.md)
</dt> <dt>

[<span data-ttu-id="a3422-257">Известные папки</span><span class="sxs-lookup"><span data-stu-id="a3422-257">Known Folders</span></span>](known-folders.md)
</dt> <dt>

[<span data-ttu-id="a3422-258">Схема описания библиотеки</span><span class="sxs-lookup"><span data-stu-id="a3422-258">Library Description Schema</span></span>](library-schema-entry.md)
</dt> <dt>

[<span data-ttu-id="a3422-259">**IID \_ ППВ \_ args**</span><span class="sxs-lookup"><span data-stu-id="a3422-259">**IID\_PPV\_ARGS**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-iid_ppv_args)
</dt> </dl>

 

 
