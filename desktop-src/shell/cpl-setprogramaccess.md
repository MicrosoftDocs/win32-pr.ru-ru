---
description: В этом разделе обсуждается функция настройки доступа к программам и параметров по умолчанию (SPAD), найденная в панели управления.
ms.assetid: 0d706857-5a84-4d68-99dc-bb9aab4197b9
title: Настройка доступа к программе и параметров по умолчанию для компьютера (SPAD)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 978749171366e3091738ac22c78e04cd92123a75d2288f7c83200ee8532d232c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117861475"
---
# <a name="set-program-access-and-computer-defaults-spad"></a>Настройка доступа к программе и параметров по умолчанию для компьютера (SPAD)

В этом разделе обсуждается функция **настройки доступа к программам и параметров по умолчанию (SPAD)** , найденная в панели управления. модуль SPAD находится под элементом панели управления [программы по умолчанию](default-programs.md) в Windows Vista и более поздних версиях Windows. в Windows XP он находится в элементе установка и **удаление программ** и имеет название **настройка доступа к программе и по умолчанию**.

> [!IMPORTANT]
> Этот раздел не относится к Windows 10. Способ изменения связей файлов по умолчанию в Windows 10. дополнительные сведения см. в разделе об **изменениях Windows 10 обработки приложений по умолчанию** в [этой записи](https://blogs.windows.com/bloggingwindows/2015/05/20/announcing-windows-10-insider-preview-build-10122-for-pcs/).

 

-   [Использование средства "Установка программного доступа и параметров компьютера"](#using-the-set-program-access-and-computer-defaults-tool)
    -   [Обзор настройки доступа к программе и параметров по умолчанию для компьютера](#an-overview-of-set-program-access-and-computer-defaults)
    -   [Значение реестра Ластусеринитиатеддефаултчанже](#the-lastuserinitiateddefaultchange-registry-value)
-   [Фильтрация списка «Установка и удаление программ»](#filtering-the-add-or-remove-programs-list)
-   [Дополнительные ресурсы](#filtering-the-add-or-remove-programs-list)
-   [Связанные темы](#related-topics)

## <a name="using-the-set-program-access-and-computer-defaults-tool"></a>Использование средства "Установка программного доступа и параметров компьютера"

> [!Note]  
> начиная с Windows 8, SPAD настраивает значения по умолчанию для каждого пользователя для текущего пользователя. до Windows 8 в SPAD устанавливаются значения по умолчанию для каждого компьютера. Если пользователь по умолчанию еще не настроен пользователем, система предложит ему задать значение по умолчанию для каждого пользователя, а не будет возвращаться по умолчанию для каждого компьютера. возможно, параметры по умолчанию для компьютера не были видны пользователям в Windows Vista и Windows 7, если они ранее задали значения по умолчанию для каждого пользователя, так как по умолчанию для каждого компьютера в этих операционных системах переопределяются значения по умолчанию для отдельных компьютеров.

 

в Windows XP **настройка доступа к программам и параметров по умолчанию** является средством, которое можно найти в элементе панели управления элемент **установка и удаление программ** . в Windows Vista и более поздних версий она находится под элементом панели управления [программы по умолчанию](default-programs.md) . Для [зарегистрированных](reg-middleware-apps.md) программ выполняются следующие функции.

-   включает возможность выбора программ по умолчанию для каждого типа клиента (только Windows 7).
-   Позволяет управлять отображением значков, ярлыков и записей меню программы.
-   Предоставляет набор стандартных вариантов программ по умолчанию. (только для Windows XP с пакетом обновления 1 (SP1))

Это средство используется для следующих пяти типов клиентов.

-   Браузер
-   Адрес электронной почты
-   Программа Instant мессенгинг
-   Проигрыватель мультимедиа
-   Виртуальная машина для Java

### <a name="an-overview-of-set-program-access-and-computer-defaults"></a>Обзор настройки доступа к программе и параметров по умолчанию для компьютера

на следующем снимке экрана показана страница Windows 8 **настройка доступа к программе и параметров компьютера по умолчанию** .

![снимок экрана с представлением "Настройка доступа к программам и параметров компьютера по умолчанию"](images/spad-initial.png)

Пользователю предоставляются три возможных параметра конфигурации, с помощью которых изготовители оборудования могут представить четвертый вариант с названием «изготовитель компьютера».

-   [Microsoft Windows](#microsoft-windows)
-   [Не Майкрософт](#non-microsoft)
-   [Пользовательский](#custom)
-   [Изготовитель компьютера](#computer-manufacturer)

### <a name="microsoft-windows"></a>Microsoft Windows

конфигурация **Microsoft Windows** состоит из набора программ по умолчанию, предоставляемых Windows, как показано на следующем снимке экрана.

![снимок экрана с параметрами Microsoft "Настройка доступа к программе и параметров по умолчанию"](images/mspage.png)

выбор конфигурации **Microsoft Windows** позволяет также отображать значки, ярлыки и записи меню для каждой программы, зарегистрированной для любого из пяти типов клиентов. Эти значки, ярлыки и пункты меню доступны пользователю в меню " **Пуск** " или на экране "Пуск", на рабочем столе и во всех других местах, в которые они были добавлены.

### <a name="non-microsoft"></a>Не Майкрософт

Конфигурация, не относящаяся к **Майкрософт** , показанная на следующем снимке экрана, используется для зарегистрированных приложений в системе пользователя, которая не создается корпорацией Майкрософт. Эти приложения могут быть предварительно установлены в системе пользователя или могут быть приложениями сторонних производителей, установленными пользователем.

> [!Note]  
> Приложения должны быть зарегистрированы для отображения на этой странице. Инструкции по регистрации приложения см. в разделе [Регистрация программ с помощью типов клиентов](reg-middleware-apps.md).

 

![снимок экрана настройки доступа к программе и параметров по умолчанию не Майкрософт](images/nonmspage.png)

при выборе параметра, не относящегося к **корпорации майкрософт** , также удаляется доступ к значкам, ярлыкам и записям меню программ майкрософт, перечисленных в конфигурации [microsoft Windows](#microsoft-windows) для всех типов клиентов. Эти значки, ярлыки и пункты меню Microsoft удаляются из меню **Пуск** , рабочего стола и других мест, в которые они были добавлены.

### <a name="custom"></a>Другой

**Пользовательская** конфигурация, показанная на следующем снимке экрана, позволяет пользователям настраивать системы с помощью любого сочетания программ Майкрософт и сторонних производителей, зарегистрированных в качестве возможностей по умолчанию для пяти типов клиентов. это единственный из четырех вариантов, доступных в Windows 2000 с пакетом обновления 3 (sp3).

![снимок экрана — пользовательские параметры доступа и настройки по умолчанию для программы](images/custompage.png)

все параметры, представленные в конфигурациях [microsoft Windows](#microsoft-windows) и [сторонних](#non-microsoft) , доступны пользователю в **пользовательском** разделе, а также к любым дополнительно установленным приложениям майкрософт, не входящим в состав Windows. Выбран переключатель **использовать текущий веб-браузер** , как показано на предыдущем снимке экрана. Невозможно определить текущий браузер по умолчанию из пользовательского интерфейса. вызов веб-ссылок или файлов в Windows является единственным способом обнаружения текущего браузера по умолчанию.

когда пользователь устанавливает флажок **включить доступ к этой** программе для программы, значки, ярлыки и пункты меню отображаются в меню или на начальном экране, на рабочем столе или в любом другом расположении, где они были установлены. Снятие этого флажка должно удалить эти значки, ярлыки и записи меню, однако поведение этих параметров полностью зависит от поставщика приложения. Windows не управляет включением или удалением доступа в пользовательском интерфейсе. Также важно понимать, что приложениям не требуется регистрироваться для **настройки доступа к программам и параметров по умолчанию для компьютера**.

### <a name="computer-manufacturer"></a>Изготовитель компьютера

Четвертая категория под названием «изготовитель компьютера» может присутствовать в окне SPAD в некоторых системах. Изготовители компьютеров могут выбрать предварительную настройку компьютеров с помощью настраиваемого набора значений по умолчанию, выбрав один из вариантов, доступных в [пользовательской](#custom) конфигурации. (В целях наглядности вымышленный набор приложений с именем LitWare регистрируется для использования со всеми типами клиентов.) пользователь может вернуться к конфигурации изготовителя компьютера по умолчанию в любое время, выбрав параметр **изготовитель компьютера** , как показано на следующем снимке экрана Windows XP.

> [!Note]  
> Эта конфигурация не отображается во всех системах. Дополнительные сведения см. в комплекте предварительной установки OEM.

 

![снимок экрана с параметрами производителя компьютера "Настройка доступа к программе и значений по умолчанию"](images/oempage.jpg)

### <a name="the-lastuserinitiateddefaultchange-registry-value"></a>Значение реестра Ластусеринитиатеддефаултчанже

Значение Ластусеринитиатеддефаултчанже было добавлено в реестр, чтобы помочь приложениям в распознавании и отношению к выбору пользователя по умолчанию. Значение содержит \_ двоичные данные reg в виде структуры [**fileTime**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , содержащей дату и время (в формате UTC) последнего изменения пользователем значения по умолчанию с помощью средства **Настройка доступа к программам и параметров компьютера по умолчанию** . Это значение находится в следующем подразделе.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         ClientTypeName
            LastUserInitiatedDefaultChange = FILETIME
```

В следующем сценарии это значение используется для приложения, отслеживающего сопоставление файлов.

1.  Приложение регистрирует время, когда оно было задано в качестве программы по умолчанию для своего типа клиента (во время установки или позже).
2.  Приложение обнаруживает, что программа по умолчанию для своего типа клиента была изменена на программу, отличную от самой самой, или от приложения, которое она представляет (в случае фоновых вспомогательных программ). Не поддерживается в Windows 8.
3.  Приложение считывает значение Ластусеринитиатеддефаултчанже (отметка времени последнего инициированного пользователем изменения по умолчанию) и сравнивает его со значением отметки времени, которое она сохранила для собственного выбора по умолчанию.
4.  Если Ластусеринитиатеддефаултчанже позже, чем сохраненное значение приложения, это приложение не должно предпринимать никаких действий, так как изменение было явным образом запрошено пользователем с помощью средства **настройки доступа к программам и по умолчанию** .
5.  Приложение больше не отслеживает эту связь файлов, пока не будет снова выбрана по умолчанию. Не поддерживается в Windows 8.

Придерживаясь такой схемы, пользователь учитывается, и их максимальная собственность системы сохраняется.

## <a name="filtering-the-add-or-remove-programs-list"></a>Фильтрация списка «Установка и удаление программ»

> [!Note]  
> этот раздел относится к Windows XP с пакетом обновления 2 (sp2) и более поздних версий и Windows Server 2003 и более поздних версий.

 

в Windows XP и Windows Server 2003 список приложений, отображаемый на вкладке **изменение или удаление программ** в разделе **установка и удаление программ** , может быть отфильтрован пользователем для исключения записей об обновлениях приложений. в этих версиях Windows это осуществляется с помощью флажка **показывать обновления** в верхней части окна. Параметр **Показать обновления** не выбран по умолчанию, поэтому обновления не отображаются, если только пользователь *не* выберет их. Изменения состояния флажка сохраняются при закрытии окна " **Установка и удаление программ** ". Если пользователь выбрал отображение обновлений, они продолжают отображаться до тех пор, пока пользователь не очистит флажок.

> [!Note]  
> обновление Windows XP с пакетом обновления 2 (SP2) является исключением фильтрации. Он всегда отображается независимо от состояния флажка.

 

в Windows Vista и более поздних версий обновления приложений отображаются на отдельной странице панели управления, предназначенной только для обновлений. Эта страница отображается, когда пользователь щелкает ссылку **Просмотреть установленные обновления** . Нет выбираемых пользователем параметров для отображения обновлений на той же странице, что и установленные программы. Несмотря на изменение в пользовательском интерфейсе, механизм регистрации в качестве обновления установленной программы остается таким же, как и в предыдущих версиях Windows.

приложения майкрософт и сторонних разработчиков, использующие установщик Windows, не нуждаются в дальнейших действиях, чтобы их обновления распознавались как обновления. сторонние приложения, не использующие установщик Windows, должны объявлять определенные значения в реестре в процессе установки, чтобы быть распознанными как обновление существующей программы.

В следующем примере показано, какие значения реестра следует объявить для установки, чтобы быть распознанным как обновление существующей программы.

1.  родительскому приложению необходимо добавить сведения об удалении в подраздел в подразделе "программное обеспечение на **\_ локальном \_ компьютере** \\  \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** для \\ **удаления** ". Дополнительные сведения об использовании подраздела **удаления** см. в разделе об [установке](/previous-versions/ms997548(v=msdn.10)) .
2.  Каждое обновление родительского приложения также должно добавить его сведения в качестве подраздела подраздела **удаления** . Он должен использовать определенное соглашение об именовании, пытаясь избежать потенциальных конфликтов с другими программами. следующие соглашения зарезервированы в качестве имен подразделов корпорацией майкрософт для использования с Windows обновлениями.
    -   иеупдате
    -   оеупдате
    -   "KB", за которой следуют шесть цифр, например "KB123456"
    -   "Q", за которым следуют шесть цифр, например "Q123456"
    -   Шесть цифр, например "123456"
3.  Помимо стандартных сведений об удалении, добавленных для родительского приложения, подразделы для каждого обновления дополнительно должны включать две из следующих трех записей. Их значения имеют тип REG \_ SZ.
    -   **Паренткэйнаме**. Это значение обязательно. Это имя подраздела родителя, объявленного на шаге 1. Это обновление связывается с программой.
    -   **Парентдисплайнаме**. Это значение обязательно. Если подраздел не совпадает с именем в Паренткэйнаме, это значение используется в качестве заполнителя родительской программы для отображения в окне " **Установка и удаление программ**".
    -   **Инсталлдате**. Это необязательное значение. `yyyymmdd`Для указания даты следует использовать форму. Эта дата используется для **установки на** сведениях, отображаемых рядом с записью обновления в пользовательском интерфейсе. Если нет записи **инсталлдате** или она присутствует, но ей не назначено значение, происходит следующее:
        -   версии операционной системы, отличные от Windows Vista и Windows 7. **сведения не** отображаются.
        -   Windows Vista и более поздних версий: используется дата по умолчанию. Это Дата последнего изменения для любой записи в подразделе этого обновления. Обычно это день, когда обновление было добавлено в реестр. Однако, поскольку это Дата последнего изменения, любое последующее изменение в любом из записей подраздела приводит к изменению значения Инсталлдате на дату этого изменения.

В следующем примере показаны соответствующие записи реестра для обновления приложения LitWare Deluxe.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Uninstall
                  LitWare
                     DisplayName = LitWare Deluxe
                     UninstallString = "C:\Program Files\LitWare\LitWare Deluxe\litware.exe" /uninstall
                  LitWare_Update123456
                     DisplayName = LitWare Deluxe Update 123456. Fixes printing problems.
                     UninstallString = "C:\Program Files\LitWare\LitWare Deluxe\Updates\123456.exe" /uninstall
                     ParentKeyName = LitWare
                     ParentDisplayName = LitWare Deluxe
                     InstallDate = 20050513
```

Приложения сторонних производителей, которые не предоставляют соответствующие данные реестра, такие как обновления, созданные до того, как этот параметр был доступен, продолжают отображаться в списке установленных программ и не отфильтровываются.

фильтрация обновлений в версиях операционной системы, отличных от Windows Vista и Windows 7, обычно является управляемым пользователем параметром и должна рассматриваться в соответствии с приложениями. Однако в корпоративной среде администраторы могут контролировать, имеет ли пользователь возможность фильтровать обновления с помощью значения реестра Донтграуппатчес, как показано в следующем примере.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               policies
                  Uninstall
                     DontGroupPatches = 0 or 1
```

Это значение имеет тип REG \_ DWORD и интерпретируется следующим образом.



| Значение Донтграуппатчес             | Значение                                                                                                                                                                                                             |
|------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0                                  | Флажок **Показать обновления** отображается для пользователя. Фильтрация зависит от того, установлен ли этот флажок пользователем.                                                                                         |
| 1                                  | Флажок **Показывать обновления** удаляется из пользовательского интерфейса. Обновления не фильтруются из списка. это значение фактически возвращается к поведению Windows XP с пакетом обновления 1 (SP1), прежде чем появилась функция **отображения обновлений** . |
| Отсутствует запись Донтграуппатчес | Это эквивалентно установке значения 0.                                                                                                                                                                       |



 

донтграуппатчес не оказывает влияния на Windows Vista и Windows 7, где пользовательский интерфейс не содержит флажков, а зарегистрированные обновления всегда фильтруются.

> [!Note]  
> Политики устанавливаются только администраторами. Приложения не должны изменять это значение. дополнительные сведения о том, как задать групповая политика на основе реестра, см. в разделе [групповая политика](/previous-versions/windows/desktop/Policy/group-policy-start-page) или [Windows Server групповая политика](/windows/deployment/deploy-whats-new).

 

## <a name="additional-resources"></a>Дополнительные ресурсы

-   [Регистрация программ с помощью клиентских типов](reg-middleware-apps.md)
-   [Установка](/previous-versions/ms997548(v=msdn.10))
-   [настройка установки и удаления программ с помощью установщик Windows](../msi/configuring-add-remove-programs-with-windows-installer.md)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Рекомендации по сопоставлению файлов](fa-best-practices.md)
</dt> <dt>

[Пример сценария сопоставления файлов](fa-sample-scenarios.md)
</dt> <dt>

[рекомендации по управлению приложениями по умолчанию в Windows Vista и более поздних версий](vista-managing-defaults.md)
</dt> <dt>

[Программы по умолчанию](default-programs.md)
</dt> </dl>

 

 
