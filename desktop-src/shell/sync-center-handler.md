---
description: В этом разделе приводится пошаговое изучение требований для создания DLL-файла, который реализует обработчик, используемый в центре синхронизации. Эти сведения действительны для Windows Vista.
title: Разработка обработчика Windows Sync Center
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 66b40f81-9515-4190-8ced-44f20bb9df86
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 11185aa5976c27b7af95787b081e1eaacd99c8e9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104985560"
---
# <a name="developing-a-windows-sync-center-handler"></a><span data-ttu-id="d2269-104">Разработка обработчика Windows Sync Center</span><span class="sxs-lookup"><span data-stu-id="d2269-104">Developing a Windows Sync Center Handler</span></span>

<span data-ttu-id="d2269-105">В этом разделе приводится пошаговое изучение требований для создания DLL-файла, который реализует обработчик, используемый в центре синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-105">This topic provides a step-by-step examination of the requirements to build a DLL file that implements a handler to be used with Sync Center.</span></span> <span data-ttu-id="d2269-106">Эти сведения действительны для Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="d2269-106">This information is valid as of Windows Vista.</span></span>

-   [<span data-ttu-id="d2269-107">Процесс синхронизации Windows до Vista</span><span class="sxs-lookup"><span data-stu-id="d2269-107">The Windows Synchronization Experience Before Vista</span></span>](#the-windows-synchronization-experience-before-vista)
-   [<span data-ttu-id="d2269-108">API центра синхронизации</span><span class="sxs-lookup"><span data-stu-id="d2269-108">Sync Center APIs</span></span>](#sync-center-apis)
    -   [<span data-ttu-id="d2269-109">Нужные интерфейсы</span><span class="sxs-lookup"><span data-stu-id="d2269-109">Essential Interfaces</span></span>](#essential-interfaces)

## <a name="the-windows-synchronization-experience-before-vista"></a><span data-ttu-id="d2269-110">Процесс синхронизации Windows до Vista</span><span class="sxs-lookup"><span data-stu-id="d2269-110">The Windows Synchronization Experience Before Vista</span></span>

<span data-ttu-id="d2269-111">В Windows XP был предоставлен [Диспетчер синхронизации](syncmgr-start-page.md) (mobsync.exe).</span><span class="sxs-lookup"><span data-stu-id="d2269-111">Windows XP provided a [Synchronization Manager](syncmgr-start-page.md) (mobsync.exe).</span></span> <span data-ttu-id="d2269-112">Многие устройства, такие как MP3 Players, Сотовые телефоны и камеры, также предоставили собственные интерфейсы синхронизации вместо использования диспетчера синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-112">Many devices such as mp3 players, cell phones, and cameras also provided their own synchronization interfaces rather than using the Synchronization Manager.</span></span> <span data-ttu-id="d2269-113">Это привело к нестабильному и нецентрализованному интерфейсу пользователя.</span><span class="sxs-lookup"><span data-stu-id="d2269-113">This resulted in an inconsistent and noncentralized user experience.</span></span>

<span data-ttu-id="d2269-114">Новый компонент центра синхронизации, предоставляемый в Windows Vista, имеет несколько преимуществ по сравнению с предыдущим диспетчером синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-114">The new Sync Center feature provided in Windows Vista has several advantages over the older Synchronization Manager.</span></span>

-   <span data-ttu-id="d2269-115">Улучшенная возможность обнаружения</span><span class="sxs-lookup"><span data-stu-id="d2269-115">Better discoverability</span></span>
-   <span data-ttu-id="d2269-116">Меньше требуется для прямого вмешательства пользователя</span><span class="sxs-lookup"><span data-stu-id="d2269-116">Less need for direct user action</span></span>
-   <span data-ttu-id="d2269-117">Не блокирует другие операции</span><span class="sxs-lookup"><span data-stu-id="d2269-117">Does not block other operations</span></span>
-   <span data-ttu-id="d2269-118">Улучшенная визуализация хода выполнения синхронизации</span><span class="sxs-lookup"><span data-stu-id="d2269-118">Better visualization of the synchronization progress</span></span>
-   <span data-ttu-id="d2269-119">Упрощение понимания модели разработки</span><span class="sxs-lookup"><span data-stu-id="d2269-119">Easier to understand development model</span></span>

## <a name="sync-center-apis"></a><span data-ttu-id="d2269-120">API центра синхронизации</span><span class="sxs-lookup"><span data-stu-id="d2269-120">Sync Center APIs</span></span>

<span data-ttu-id="d2269-121">Центр синхронизации взаимодействует с обработчиками через ряд интерфейсов модели COM.</span><span class="sxs-lookup"><span data-stu-id="d2269-121">Sync Center communicates with handlers through a number of Component Object Model (COM) interfaces.</span></span> <span data-ttu-id="d2269-122">Не все эти интерфейсы необходимы для реализации обработчика центра синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-122">Not all of these interfaces are needed to implement a Sync Center handler.</span></span> <span data-ttu-id="d2269-123">Этот раздел разбит на два раздела.</span><span class="sxs-lookup"><span data-stu-id="d2269-123">This topic has been broken into two sections.</span></span> <span data-ttu-id="d2269-124">В первом разделе объясняются основные интерфейсы COM, которые должен поддерживать каждый обработчик, а во втором разделе рассматриваются необязательные COM-интерфейсы и рассматриваются причины их поддержки обработчиком.</span><span class="sxs-lookup"><span data-stu-id="d2269-124">The first section explains the essential COM interfaces that every handler must support, and the second section examines the optional COM interfaces and looks at the reasons that a handler would support them.</span></span>

-   [<span data-ttu-id="d2269-125">Нужные интерфейсы</span><span class="sxs-lookup"><span data-stu-id="d2269-125">Essential Interfaces</span></span>](#essential-interfaces)

### <a name="essential-interfaces"></a><span data-ttu-id="d2269-126">Нужные интерфейсы</span><span class="sxs-lookup"><span data-stu-id="d2269-126">Essential Interfaces</span></span>

<span data-ttu-id="d2269-127">Все обработчики центра синхронизации должны поддерживать следующие интерфейсы:</span><span class="sxs-lookup"><span data-stu-id="d2269-127">All Sync Center handlers must support the following interfaces:</span></span>

-   [<span data-ttu-id="d2269-128">**исинкмгрхандлер**</span><span class="sxs-lookup"><span data-stu-id="d2269-128">**ISyncMgrHandler**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler)
-   [<span data-ttu-id="d2269-129">**исинкмгрхандлеринфо**</span><span class="sxs-lookup"><span data-stu-id="d2269-129">**ISyncMgrHandlerInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo)
-   [<span data-ttu-id="d2269-130">**исинкмгрсинЦитемконтаинер**</span><span class="sxs-lookup"><span data-stu-id="d2269-130">**ISyncMgrSyncItemContainer**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer)
-   [<span data-ttu-id="d2269-131">**иенумсинкмгрсинЦитемс**</span><span class="sxs-lookup"><span data-stu-id="d2269-131">**IEnumSyncMgrSyncItems**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems)
-   [<span data-ttu-id="d2269-132">**исинкмгрсинЦитем**</span><span class="sxs-lookup"><span data-stu-id="d2269-132">**ISyncMgrSyncItem**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem)
-   [<span data-ttu-id="d2269-133">**исинкмгрсинЦитеминфо**</span><span class="sxs-lookup"><span data-stu-id="d2269-133">**ISyncMgrSyncItemInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo)

<span data-ttu-id="d2269-134">[**ИсинкмгрсинЦитем**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) и [**исинкмгрсинЦитеминфо**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) используются для описания одного элемента синхронизации, участвующего в синхронизации в центре синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) are used to describe a single sync item involved in the synchronization to the Sync Center.</span></span> <span data-ttu-id="d2269-135">Элемент синхронизации обычно представляет либо определенный тип данных (например, изображения), либо определенное расположение данных.</span><span class="sxs-lookup"><span data-stu-id="d2269-135">A sync item generally represents either a particular data type (such as images) or a particular location of data.</span></span>

<span data-ttu-id="d2269-136">Синхронизация элементов, представляющих различные расположения данных, позволяет выполнять очень конкретные операции синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-136">Sync items that represent different data locations allow for very specific synchronizations.</span></span> <span data-ttu-id="d2269-137">Степень гранулярности расположения достигается разработчиком обработчика, но при проектировании следует учитывать осторожность.</span><span class="sxs-lookup"><span data-stu-id="d2269-137">The granularity of the location is up to the handler author, but care should be taken in the design.</span></span> <span data-ttu-id="d2269-138">При наличии слишком мало элементов синхронизации (расположений) пользователю предоставляется возможность синхронизировать только определенные данные.</span><span class="sxs-lookup"><span data-stu-id="d2269-138">If there are too few sync items (locations), then the user is restricted in their ability to sync only certain data.</span></span> <span data-ttu-id="d2269-139">С другой крайней стороны, слишком большая степень детализации может стать неуправляемой.</span><span class="sxs-lookup"><span data-stu-id="d2269-139">At the other extreme, too much granularity can become unmanageable.</span></span>

<span data-ttu-id="d2269-140">Если обработчик поддерживает более одного типа данных или нескольких расположений данных, он должен поддерживать более одного объекта синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-140">If a handler supports more than one data type or multiple data locations, then it needs to support more than one sync item object.</span></span> <span data-ttu-id="d2269-141">Примером может быть персональный помощник по работе с данными (PDA), позволяющий пользователю синхронизировать контакты, элементы календаря и документы.</span><span class="sxs-lookup"><span data-stu-id="d2269-141">An example might be a personal data assistant (PDA) that allows the user to sync contacts, calendar items and documents.</span></span> <span data-ttu-id="d2269-142">Эти три типа данных должны быть представлены тремя уникальными объектами, каждый из которых предоставляет интерфейсы [**исинкмгрсинЦитем**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) и [**исинкмгрсинЦитеминфо**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) .</span><span class="sxs-lookup"><span data-stu-id="d2269-142">These three data types would need to be represented by three unique objects that each expose the [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) interfaces.</span></span>

<span data-ttu-id="d2269-143">Интерфейс [**иенумсинкмгрсинЦитемс**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) предоставляет механизм для перечисления элементов синхронизации обработчика.</span><span class="sxs-lookup"><span data-stu-id="d2269-143">The [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) interface provides a mechanism to enumerate through a handler's sync items.</span></span> <span data-ttu-id="d2269-144">Чтобы получить этот перечислитель, центр синхронизации вызывает метод [**исинкмгрсинЦитемконтаинер:: жетсинЦитеменумератор**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) , предоставляемый обработчиком.</span><span class="sxs-lookup"><span data-stu-id="d2269-144">To retrieve this enumerator, Sync Center calls the [**ISyncMgrSyncItemContainer::GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) method exposed by the handler.</span></span> <span data-ttu-id="d2269-145">[**ИсинкмгрсинЦитемконтаинер**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) также содержит два других метода, которые центр синхронизации может использовать для получения сведений об элементах синхронизации обработчика:</span><span class="sxs-lookup"><span data-stu-id="d2269-145">[**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) also contains two other methods that the Sync Center can use to retrieve information about the handler's sync items:</span></span>

-   <span data-ttu-id="d2269-146">[**ЖетсинЦитем**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) возвращает конкретный элемент синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) returns a specific sync item.</span></span>
-   <span data-ttu-id="d2269-147">[**ЖетсинЦитемкаунт**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) возвращает количество элементов синхронизации, поддерживаемое обработчиком.</span><span class="sxs-lookup"><span data-stu-id="d2269-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) returns the number of sync items supported by the handler.</span></span>

<span data-ttu-id="d2269-148">[**Исинкмгрхандлер**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) и [**исинкмгрхандлеринфо**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) используются для описания свойств руки и запуска фактической синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d2269-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) and [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) are used to describe the properties of the hander and launch the actual synchronization.</span></span> <span data-ttu-id="d2269-149">[**Исинкмгрхандлер:: Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) — это место, где код обработчика выполняет синхронизацию и предоставляет отзыв о ходе выполнения и любых возникающих проблемах.</span><span class="sxs-lookup"><span data-stu-id="d2269-149">[**ISyncMgrHandler::Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) is where the handler code carries out the synchronization and provides feedback on progress and any issues that occur.</span></span>

<span data-ttu-id="d2269-150">Многие из методов интерфейса не обязательно должны быть полностью реализованы.</span><span class="sxs-lookup"><span data-stu-id="d2269-150">Many of the interface methods do not need to be fully implemented.</span></span> <span data-ttu-id="d2269-151">Центр синхронизации предоставляет определенный объем сведений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d2269-151">Sync Center provides a certain amount of default information.</span></span> <span data-ttu-id="d2269-152">Интерфейсы позволяют обработчику переопределять эти сведения и предоставлять настраиваемые сведения для вывода при необходимости.</span><span class="sxs-lookup"><span data-stu-id="d2269-152">The interfaces allow a handler to override this information and provide custom information to display, if needed.</span></span>

 

 



