---
description: Флаги, управляющие поведением вызывающей функции. Используется Шкреатесреад и Шкреатесреадвисхандле. В этих функциях эти значения определяются как типы \_ флагов ШКТ.
title: Флаги КТФ (Shlwapi. h)
ms.topic: reference
ms.date: 05/31/2018
ms.assetid: 66cda866-7a39-4c5a-a795-a4c5c64cbab7
api_name:
- CTF_INSIST
- CTF_THREAD_REF
- CTF_PROCESS_REF
- CTF_COINIT_STA
- CTF_COINIT
- CTF_FREELIBANDEXIT
- CTF_REF_COUNTED
- CTF_WAIT_ALLOWCOM
- CTF_UNUSED
- CTF_INHERITWOW64
- CTF_WAIT_NO_REENTRANCY
- CTF_KEYBOARD_LOCALE
- CTF_OLEINITIALIZE
- CTF_COINIT_MTA
- CTF_NOADDREFLIB
api_type:
- HeaderDef
api_location:
- Shlwapi.h
topic_type:
- APIRef
- kbSyntax
ms.openlocfilehash: db0f33daecc4abcbfbc9972d0607f4817bc7ecff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984320"
---
# <a name="ctf-flags"></a><span data-ttu-id="64fc6-105">Флаги КТФ</span><span class="sxs-lookup"><span data-stu-id="64fc6-105">CTF Flags</span></span>

<span data-ttu-id="64fc6-106">Флаги, управляющие поведением вызывающей функции.</span><span class="sxs-lookup"><span data-stu-id="64fc6-106">Flags that control the calling function's behavior.</span></span> <span data-ttu-id="64fc6-107">Используется [**шкреатесреад**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) и [**шкреатесреадвисхандле**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle).</span><span class="sxs-lookup"><span data-stu-id="64fc6-107">Used by [**SHCreateThread**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) and [**SHCreateThreadWithHandle**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle).</span></span> <span data-ttu-id="64fc6-108">В этих функциях эти значения определяются как типы \_ флагов ШКТ.</span><span class="sxs-lookup"><span data-stu-id="64fc6-108">In those functions, these values are defined as being of type SHCT\_FLAGS.</span></span>



| <span data-ttu-id="64fc6-109">Константа/значение</span><span class="sxs-lookup"><span data-stu-id="64fc6-109">Constant/value</span></span>                                                                                                                                                                                                                                             | <span data-ttu-id="64fc6-110">Описание</span><span class="sxs-lookup"><span data-stu-id="64fc6-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CTF_INSIST"></span><span id="ctf_insist"></span><dl> <span data-ttu-id="64fc6-111"><dt>**КТФ \_ Настаивает**</dt> <dt>0x00000001</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-111"><dt>**CTF\_INSIST**</dt> <dt>0x00000001</dt></span></span> </dl>                                       | <span data-ttu-id="64fc6-112">0x00000001.</span><span class="sxs-lookup"><span data-stu-id="64fc6-112">0x00000001.</span></span> <span data-ttu-id="64fc6-113">Если попытка создать поток с помощью функции [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) завершается ошибкой, установка этого флага приведет к тому, что функция, на которую указывает *пфнсреадпрок* , будет вызываться синхронно из вызывающего потока.</span><span class="sxs-lookup"><span data-stu-id="64fc6-113">If the attempt to create the thread with [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) fails, setting this flag will cause the function pointed to by *pfnThreadProc* to be called synchronously from the calling thread.</span></span> <span data-ttu-id="64fc6-114">Этот флаг можно использовать, только если *пфнкаллбакк* имеет **значение NULL**.</span><span class="sxs-lookup"><span data-stu-id="64fc6-114">This flag can be used only if *pfnCallback* is **NULL**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_THREAD_REF"></span><span id="ctf_thread_ref"></span><dl> <span data-ttu-id="64fc6-115"><dt>**КТФ \_ \_Ссылка**</dt> на <dt>0x00000002</dt> .</span><span class="sxs-lookup"><span data-stu-id="64fc6-115"><dt>**CTF\_THREAD\_REF**</dt> <dt>0x00000002</dt></span></span> </dl>                          | <span data-ttu-id="64fc6-116">0x00000002.</span><span class="sxs-lookup"><span data-stu-id="64fc6-116">0x00000002.</span></span> <span data-ttu-id="64fc6-117">Держите ссылку на поток создания на время вызова функции, на которую указывает *пфнсреадпрок*.</span><span class="sxs-lookup"><span data-stu-id="64fc6-117">Hold a reference to the creating thread for the duration of the call to the function pointed to by *pfnThreadProc*.</span></span> <span data-ttu-id="64fc6-118">Эта ссылка должна быть задана с помощью [**шсетсреадреф**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span><span class="sxs-lookup"><span data-stu-id="64fc6-118">This reference must have been set with [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="CTF_PROCESS_REF"></span><span id="ctf_process_ref"></span><dl> <span data-ttu-id="64fc6-119"><dt>**КТФ \_ \_Ссылка на процесс**</dt> <dt>0x00000004</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-119"><dt>**CTF\_PROCESS\_REF**</dt> <dt>0x00000004</dt></span></span> </dl>                       | <span data-ttu-id="64fc6-120">0x00000004.</span><span class="sxs-lookup"><span data-stu-id="64fc6-120">0x00000004.</span></span> <span data-ttu-id="64fc6-121">Держите ссылку на процесс проводника Windows на время вызова функции, на которую указывает *пфнсреадпрок*.</span><span class="sxs-lookup"><span data-stu-id="64fc6-121">Hold a reference to the Windows Explorer process for the duration of the call to the function pointed to by *pfnThreadProc*.</span></span> <span data-ttu-id="64fc6-122">Этот флаг полезен для [обработчиков расширений оболочки](handlers.md), которые могут потребовать преждевременного закрытия процесса проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="64fc6-122">This flag is useful for [Shell extension handlers](handlers.md), which might need to keep the Windows Explorer process from closing prematurely.</span></span> <span data-ttu-id="64fc6-123">Это действие полезно при выполнении таких задач, как работа в фоновом потоке или копирование файлов.</span><span class="sxs-lookup"><span data-stu-id="64fc6-123">This action is useful during tasks such as working on a background thread or copying files.</span></span> <span data-ttu-id="64fc6-124">Дополнительные сведения см. в разделе [**шжетинстанцеексплорер**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer).</span><span class="sxs-lookup"><span data-stu-id="64fc6-124">For more information, see [**SHGetInstanceExplorer**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_COINIT_STA"></span><span id="ctf_coinit_sta"></span><dl> <span data-ttu-id="64fc6-125"><dt>**КТФ \_ 0x00000008 \_ STA**</dt> <dt></dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-125"><dt>**CTF\_COINIT\_STA**</dt> <dt>0x00000008</dt></span></span> </dl>                          | <span data-ttu-id="64fc6-126">0x00000008.</span><span class="sxs-lookup"><span data-stu-id="64fc6-126">0x00000008.</span></span> <span data-ttu-id="64fc6-127">Инициализируйте COM как единый потоковый апартамент (STA) для созданного потока перед вызовом необязательной функции, на которую указывает *пфнкаллбакк* , или функции, на которую указывает *пфнсреадпрок*.</span><span class="sxs-lookup"><span data-stu-id="64fc6-127">Initialize COM as a Single Threaded Apartment (STA) for the created thread before calling either the optional function pointed to by *pfnCallback* or the function pointed to by *pfnThreadProc*.</span></span> <span data-ttu-id="64fc6-128">Этот флаг полезен, когда необходимо инициализировать COM для потока.</span><span class="sxs-lookup"><span data-stu-id="64fc6-128">This flag is useful when COM needs to be initialized for a thread.</span></span> <span data-ttu-id="64fc6-129">COM также будет автоматически инициализирован.</span><span class="sxs-lookup"><span data-stu-id="64fc6-129">COM will automatically be uninitialized as well.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="CTF_COINIT"></span><span id="ctf_coinit"></span><dl> <span data-ttu-id="64fc6-130"><dt>**КТФ \_**</dt> <dt>0x00000008</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-130"><dt>**CTF\_COINIT**</dt> <dt>0x00000008</dt></span></span> </dl>                                       | <span data-ttu-id="64fc6-131">Эквивалентно КТФ \_ коinit \_ STA.</span><span class="sxs-lookup"><span data-stu-id="64fc6-131">Equivalent to CTF\_COINIT\_STA.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span id="CTF_FREELIBANDEXIT"></span><span id="ctf_freelibandexit"></span><dl> <span data-ttu-id="64fc6-132"><dt>**КТФ \_ ФРИЛИБАНДЕКСИТ**</dt> <dt>0x00000010</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-132"><dt>**CTF\_FREELIBANDEXIT**</dt> <dt>0x00000010</dt></span></span> </dl>               | <span data-ttu-id="64fc6-133">0x00000010.</span><span class="sxs-lookup"><span data-stu-id="64fc6-133">0x00000010.</span></span> <span data-ttu-id="64fc6-134">**Internet Explorer 6 или более поздней версии.** Для библиотеки DLL, содержащей функцию *пфнсреадпрок* , будет вызвана [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) , чтобы предотвратить ее выгрузку.</span><span class="sxs-lookup"><span data-stu-id="64fc6-134">**Internet Explorer 6 or later.**[**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) will be called on the DLL that contains the *pfnThreadProc* function to prevent it from being unloaded.</span></span> <span data-ttu-id="64fc6-135">После возврата *пфнсреадпрок* библиотека DLL будет освобождена с помощью [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary), тем самым уменьшая число ссылок на библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="64fc6-135">After *pfnThreadProc* returns, the DLL will be freed with [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary), thereby decrementing the DLL reference count.</span></span> <span data-ttu-id="64fc6-136">Передайте этот флаг, чтобы избежать преждевременной выгрузки библиотеки DLL. Например, с помощью [**кофриунуседлибрариес**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries).</span><span class="sxs-lookup"><span data-stu-id="64fc6-136">Pass this flag to prevent the DLL from being unloaded prematurely; for example, by [**CoFreeUnusedLibraries**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries).</span></span> <span data-ttu-id="64fc6-137">Обратите внимание, что при передаче этого флага функция *пфнсреадпрок* должна находиться в библиотеке DLL.</span><span class="sxs-lookup"><span data-stu-id="64fc6-137">Note that if this flag is passed, the *pfnThreadProc* function must reside in a DLL.</span></span> <span data-ttu-id="64fc6-138">Этот флаг является неявным в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="64fc6-138">This flag is implicit in Windows Vista and later.</span></span><br/>                                                                                                                                                                                                                                                                   |
| <span id="CTF_REF_COUNTED"></span><span id="ctf_ref_counted"></span><dl> <span data-ttu-id="64fc6-139"><dt>**КТФ \_ Номер \_ 0x00000020 подсчета ссылок**</dt> <dt></dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-139"><dt>**CTF\_REF\_COUNTED**</dt> <dt>0x00000020</dt></span></span> </dl>                       | <span data-ttu-id="64fc6-140">0x00000020.</span><span class="sxs-lookup"><span data-stu-id="64fc6-140">0x00000020.</span></span> <span data-ttu-id="64fc6-141">**Internet Explorer 6 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-141">**Internet Explorer 6 or later.**</span></span> <span data-ttu-id="64fc6-142">Ссылка на поток будет создана автоматически для созданного потока и задана с помощью [**шсетсреадреф**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span><span class="sxs-lookup"><span data-stu-id="64fc6-142">A thread reference will automatically be created for the created thread and set with [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span></span> <span data-ttu-id="64fc6-143">После того как *пфнсреадпрок* возвращает, ссылка на поток освобождается и сообщения отправляются до тех пор, пока число ссылок в ссылке на поток не станет равным нулю, то есть пока потоки, зависящие от созданного потока, не освободят свои ссылки.</span><span class="sxs-lookup"><span data-stu-id="64fc6-143">After the *pfnThreadProc* returns, the thread reference is released and messages are sent until the reference count on the thread reference drops to zero, that is, until threads that are dependent on the created thread have released their references.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_WAIT_ALLOWCOM"></span><span id="ctf_wait_allowcom"></span><dl> <span data-ttu-id="64fc6-144"><dt>**КТФ \_ WAIT \_ алловком**</dt> <dt>0x00000040</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-144"><dt>**CTF\_WAIT\_ALLOWCOM**</dt> <dt>0x00000040</dt></span></span> </dl>                 | <span data-ttu-id="64fc6-145">0x00000040.</span><span class="sxs-lookup"><span data-stu-id="64fc6-145">0x00000040.</span></span> <span data-ttu-id="64fc6-146">**Internet Explorer 6 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-146">**Internet Explorer 6 or later.**</span></span> <span data-ttu-id="64fc6-147">Вызывающий поток ожидает и переносит сообщения COM и [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) .</span><span class="sxs-lookup"><span data-stu-id="64fc6-147">The calling thread waits and pumps COM and [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) messages.</span></span> <span data-ttu-id="64fc6-148">Если синхронная процедура пытается отправить сообщение Windows с помощью **SendMessage** в окно, размещенное в вызывающем потоке, сообщение будет успешно доставлено.</span><span class="sxs-lookup"><span data-stu-id="64fc6-148">If the synchronous procedure attempts to send a Windows message with **SendMessage** to a window hosted on the calling thread, the message will arrive successfully.</span></span> <span data-ttu-id="64fc6-149">Если синхронная процедура пытается использовать COM для взаимодействия с объектом STA, размещенным в вызывающем потоке, вызов функции будет успешно достигнуть предполагаемого объекта.</span><span class="sxs-lookup"><span data-stu-id="64fc6-149">If the synchronous procedure attempts to use COM to communicate with an STA object hosted on the calling thread, the function call will successfully reach the intended object.</span></span> <span data-ttu-id="64fc6-150">Вызывающий поток открыт для повторного входа в хрупкости.</span><span class="sxs-lookup"><span data-stu-id="64fc6-150">The calling thread is open to re-entrance fragility.</span></span> <span data-ttu-id="64fc6-151">Хотя вызывающий поток может обрабатывать вызовы **SendMessage** и com в синхронной процедуре, если другие потоки используют **SendMessage** или COM для обмена данными с объектами, размещенными в вызывающем потоке, то они могут быть неожиданными сообщениями или вызовами функций, которые обрабатываются при завершении синхронной процедуры.</span><span class="sxs-lookup"><span data-stu-id="64fc6-151">While the calling thread can handle the synchronous procedure's use of **SendMessage** and COM, if other threads are using **SendMessage** or COM to communicate to objects hosted on the calling thread, then these might be unexpected messages or function calls which are processed while the synchronous procedure is completing.</span></span><br/> |
| <span id="CTF_UNUSED"></span><span id="ctf_unused"></span><dl> <span data-ttu-id="64fc6-152"><dt>**КТФ \_ Неиспользуемые**</dt> <dt>0x00000080</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-152"><dt>**CTF\_UNUSED**</dt> <dt>0x00000080</dt></span></span> </dl>                                       | <span data-ttu-id="64fc6-153">0x00000080.</span><span class="sxs-lookup"><span data-stu-id="64fc6-153">0x00000080.</span></span> <span data-ttu-id="64fc6-154">**Internet Explorer 7 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-154">**Internet Explorer 7 or later.**</span></span> <span data-ttu-id="64fc6-155">Не используется.</span><span class="sxs-lookup"><span data-stu-id="64fc6-155">Not used.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_INHERITWOW64"></span><span id="ctf_inheritwow64"></span><dl> <span data-ttu-id="64fc6-156"><dt>**КТФ \_ INHERITWOW64**</dt> <dt>0x00000100</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-156"><dt>**CTF\_INHERITWOW64**</dt> <dt>0x00000100</dt></span></span> </dl>                     | <span data-ttu-id="64fc6-157">0x00000100.</span><span class="sxs-lookup"><span data-stu-id="64fc6-157">0x00000100.</span></span> <span data-ttu-id="64fc6-158">**Internet Explorer 7 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-158">**Internet Explorer 7 or later.**</span></span> <span data-ttu-id="64fc6-159">Новый поток наследует состояние отключения Windows-on-Windows 64-bit (WOW64) для перенаправителя файловой системы.</span><span class="sxs-lookup"><span data-stu-id="64fc6-159">The new thread inherits the Windows-on-Windows 64-bit (WOW64) disable state for the file system redirector.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_WAIT_NO_REENTRANCY"></span><span id="ctf_wait_no_reentrancy"></span><dl> <span data-ttu-id="64fc6-160"><dt>**КТФ \_ Не дожидаться повторного \_ \_ входа**</dt> <dt>0x00000200</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-160"><dt>**CTF\_WAIT\_NO\_REENTRANCY**</dt> <dt>0x00000200</dt></span></span> </dl> | <span data-ttu-id="64fc6-161">0x00000200.</span><span class="sxs-lookup"><span data-stu-id="64fc6-161">0x00000200.</span></span> <span data-ttu-id="64fc6-162">**Windows Vista или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-162">**Windows Vista or later.**</span></span> <span data-ttu-id="64fc6-163">Вызывающий поток блокирует все остальные процессы, ожидая выполнения синхронной процедуры в новом потоке.</span><span class="sxs-lookup"><span data-stu-id="64fc6-163">The calling thread blocks all other processes while waiting for the synchronous procedure to run on the new thread.</span></span> <span data-ttu-id="64fc6-164">Если синхронная процедура пытается отправить сообщение Windows с помощью [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) в окно, размещенное в вызывающем потоке, это приводит к взаимоблокировке синхронной процедуры.</span><span class="sxs-lookup"><span data-stu-id="64fc6-164">If the synchronous procedure attempts to send a Windows message with [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) to a window hosted on the calling thread, this causes the synchronous procedure to deadlock.</span></span> <span data-ttu-id="64fc6-165">Если синхронная процедура пытается использовать COM для взаимодействия с объектом STA, размещенным в вызывающем потоке, это также приводит к взаимоблокировке синхронной процедуры.</span><span class="sxs-lookup"><span data-stu-id="64fc6-165">If the synchronous procedure attempts to use COM to talk to an STA object hosted on the calling thread, this also causes the synchronous procedure to deadlock.</span></span> <span data-ttu-id="64fc6-166">Вызывающий поток защищен от всех проблем, связанных с повторным входом, путем указания этого флага.</span><span class="sxs-lookup"><span data-stu-id="64fc6-166">The calling thread is protected from all re-entrance concerns by specifying this flag.</span></span><br/>                                                                                                                                                                                                                                                                |
| <span id="CTF_KEYBOARD_LOCALE"></span><span id="ctf_keyboard_locale"></span><dl> <span data-ttu-id="64fc6-167"><dt>**КТФ \_ \_Языковой стандарт клавиатуры**</dt> <dt>0x00000400</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-167"><dt>**CTF\_KEYBOARD\_LOCALE**</dt> <dt>0x00000400</dt></span></span> </dl>           | <span data-ttu-id="64fc6-168">0x00000400.</span><span class="sxs-lookup"><span data-stu-id="64fc6-168">0x00000400.</span></span> <span data-ttu-id="64fc6-169">**Windows 7 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-169">**Windows 7 or later.**</span></span> <span data-ttu-id="64fc6-170">Используйте языковой стандарт клавиатуры из исходного потока в новом порожденном потоке.</span><span class="sxs-lookup"><span data-stu-id="64fc6-170">Use the keyboard locale from the original thread in the new thread that it spawns.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_OLEINITIALIZE"></span><span id="ctf_oleinitialize"></span><dl> <span data-ttu-id="64fc6-171"><dt>**КТФ \_ ОЛЕИНИТИАЛИЗЕ**</dt> <dt>0x00000800</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-171"><dt>**CTF\_OLEINITIALIZE**</dt> <dt>0x00000800</dt></span></span> </dl>                  | <span data-ttu-id="64fc6-172">0x00000800.</span><span class="sxs-lookup"><span data-stu-id="64fc6-172">0x00000800.</span></span> <span data-ttu-id="64fc6-173">**Windows 7 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-173">**Windows 7 or later.**</span></span> <span data-ttu-id="64fc6-174">Инициализируйте COM с помощью модели однопотокового подразделения (STA) для созданного потока.</span><span class="sxs-lookup"><span data-stu-id="64fc6-174">Initialize COM with the single-threaded apartment (STA) model for the created thread.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_COINIT_MTA"></span><span id="ctf_coinit_mta"></span><dl> <span data-ttu-id="64fc6-175"><dt>**КТФ \_ 0x00001000 \_ агента передачи сообщений**</dt> <dt></dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-175"><dt>**CTF\_COINIT\_MTA**</dt> <dt>0x00001000</dt></span></span> </dl>                          | <span data-ttu-id="64fc6-176">0x00001000.</span><span class="sxs-lookup"><span data-stu-id="64fc6-176">0x00001000.</span></span> <span data-ttu-id="64fc6-177">**Windows 7 и более поздние версии**.</span><span class="sxs-lookup"><span data-stu-id="64fc6-177">**Windows 7 and later**.</span></span> <span data-ttu-id="64fc6-178">Инициализируйте COM-объект с моделью многопотокового подразделения (MTA) для созданного потока.</span><span class="sxs-lookup"><span data-stu-id="64fc6-178">Initialize COM with the multithreaded apartment (MTA) model for the created thread.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_NOADDREFLIB"></span><span id="ctf_noaddreflib"></span><dl> <span data-ttu-id="64fc6-179"><dt>**КТФ \_ НОАДДРЕФЛИБ**</dt> <dt>0x00002000</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-179"><dt>**CTF\_NOADDREFLIB**</dt> <dt>0x00002000</dt></span></span> </dl>                        | <span data-ttu-id="64fc6-180">0x00002000.</span><span class="sxs-lookup"><span data-stu-id="64fc6-180">0x00002000.</span></span> <span data-ttu-id="64fc6-181">**Windows 7 или более поздней версии.**</span><span class="sxs-lookup"><span data-stu-id="64fc6-181">**Windows 7 or later.**</span></span> <span data-ttu-id="64fc6-182">Этот флаг по сути является противоположностью КТФ \_ фрилибандексит.</span><span class="sxs-lookup"><span data-stu-id="64fc6-182">This flag is essentially the opposite of CTF\_FREELIBANDEXIT.</span></span> <span data-ttu-id="64fc6-183">Это позволяет избежать [](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) / вызовов [**фрилибраряндекситсреад**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread) LoadLibrary, которые могут привести к состязанию за блокировку загрузчика.</span><span class="sxs-lookup"><span data-stu-id="64fc6-183">This avoids [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)/[**FreeLibraryAndExitThread**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread) calls that can result in contention for the loader lock.</span></span> <span data-ttu-id="64fc6-184">Используйте КТФ \_ ноаддрефлиб, только если новый поток гарантирует, что код исходной процедуры потока останется загруженным.</span><span class="sxs-lookup"><span data-stu-id="64fc6-184">Use CTF\_NOADDREFLIB only when the new thread has means to ensure that the code of the original thread procedure will remain loaded.</span></span> <span data-ttu-id="64fc6-185">Это значение не должно использоваться в контексте COM-объектов, так как объекты COM должны гарантировать загрузку библиотеки DLL (обычно COM выгружает библиотеки DLL).</span><span class="sxs-lookup"><span data-stu-id="64fc6-185">This value should not be used in the context of COM objects, because COM objects must ensure that the DLL stays loaded (normally, COM unloads the DLLs).</span></span><br/>                                                                                                                                                                                                                                                                                                                    |



## <a name="remarks"></a><span data-ttu-id="64fc6-186">Примечания</span><span class="sxs-lookup"><span data-stu-id="64fc6-186">Remarks</span></span>

<span data-ttu-id="64fc6-187">Если \_ флаг ожидания КТФ не \_ указан, вызывающий поток будет ждать и отправит сообщения [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) .</span><span class="sxs-lookup"><span data-stu-id="64fc6-187">If no CTF\_WAIT\_ flag is specified, the calling thread will wait and send [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) messages.</span></span> <span data-ttu-id="64fc6-188">Если синхронная процедура пытается отправить сообщение Windows с помощью **SendMessage** в окно, размещенное в вызывающем потоке, сообщение получит в предполагаемое окно.</span><span class="sxs-lookup"><span data-stu-id="64fc6-188">If the synchronous procedure attempts to send a Windows message with **SendMessage** to a window hosted on the calling thread, the message will get to the intended window.</span></span> <span data-ttu-id="64fc6-189">Если синхронная процедура пытается использовать COM для взаимодействия с объектом STA, размещенным в вызывающем потоке, синхронная процедура будет взаимоблокировка.</span><span class="sxs-lookup"><span data-stu-id="64fc6-189">If the synchronous procedure attempts to use COM to talk to an STA object hosted on the calling thread, the synchronous procedure will deadlock.</span></span> <span data-ttu-id="64fc6-190">Вызывающий поток открыт для повторного входа в хрупкости.</span><span class="sxs-lookup"><span data-stu-id="64fc6-190">The calling thread is open to re-entrance fragility.</span></span> <span data-ttu-id="64fc6-191">Хотя вызывающий поток может обрабатывать вызовы **SendMessage** в синхронной процедуре, если другие потоки используют **SendMessage** для обмена данными с окном, размещенным в вызывающем потоке, эти сообщения могут быть неожиданными.</span><span class="sxs-lookup"><span data-stu-id="64fc6-191">While the calling thread can handle the synchronous procedure's use of **SendMessage**, if other threads use **SendMessage** to communicate to an window hosted on the calling thread, then these messages might be unexpected.</span></span> <span data-ttu-id="64fc6-192">Это может привести к их обработке во время выполнения синхронной процедуры.</span><span class="sxs-lookup"><span data-stu-id="64fc6-192">This can cause them to be processed while the synchronous procedure is completing.</span></span>

## <a name="requirements"></a><span data-ttu-id="64fc6-193">Требования</span><span class="sxs-lookup"><span data-stu-id="64fc6-193">Requirements</span></span>



| <span data-ttu-id="64fc6-194">Требование</span><span class="sxs-lookup"><span data-stu-id="64fc6-194">Requirement</span></span> | <span data-ttu-id="64fc6-195">Значение</span><span class="sxs-lookup"><span data-stu-id="64fc6-195">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------|
| <span data-ttu-id="64fc6-196">Минимальная версия клиента</span><span class="sxs-lookup"><span data-stu-id="64fc6-196">Minimum supported client</span></span><br/> | <span data-ttu-id="64fc6-197">Windows 2000 Professional, Windows XP, \[ только классические приложения Windows 7\]</span><span class="sxs-lookup"><span data-stu-id="64fc6-197">Windows 2000 Professional, Windows XP, Windows 7 \[desktop apps only\]</span></span><br/>    |
| <span data-ttu-id="64fc6-198">Минимальная версия сервера</span><span class="sxs-lookup"><span data-stu-id="64fc6-198">Minimum supported server</span></span><br/> | <span data-ttu-id="64fc6-199">Windows 2000 Server \[только классические приложения\]</span><span class="sxs-lookup"><span data-stu-id="64fc6-199">Windows 2000 Server \[desktop apps only\]</span></span><br/>                                 |
| <span data-ttu-id="64fc6-200">Заголовок</span><span class="sxs-lookup"><span data-stu-id="64fc6-200">Header</span></span><br/>                   | <dl> <span data-ttu-id="64fc6-201"><dt>Shlwapi. h</dt></span><span class="sxs-lookup"><span data-stu-id="64fc6-201"><dt>Shlwapi.h</dt></span></span> </dl> |



 

 
