---
description: В этом наборе разделов обсуждается реализация обработчиков расширений, позволяющих изменять разнообразные действия оболочки.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Работа с расширениями оболочки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104985985"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="44dea-103">Работа с расширениями оболочки</span><span class="sxs-lookup"><span data-stu-id="44dea-103">Working with Shell Extensions</span></span>

<span data-ttu-id="44dea-104">Возможности оболочки можно расширить с помощью записей реестра и ini-файлов.</span><span class="sxs-lookup"><span data-stu-id="44dea-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="44dea-105">Хотя этот подход к расширению оболочки прост и подходит для многих целей, он ограничен.</span><span class="sxs-lookup"><span data-stu-id="44dea-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="44dea-106">Например, если вы используете реестр для задания пользовательского значка для типа файла, для каждого файла этого типа будет отображаться один и тот же значок.</span><span class="sxs-lookup"><span data-stu-id="44dea-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="44dea-107">Расширение оболочки с помощью реестра не позволяет изменять значок для различных элементов типа файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="44dea-108">Другие аспекты оболочки, такие как страница свойств « **Свойства** », которая может отображаться при щелчке правой кнопкой мыши, не может быть изменена в реестре.</span><span class="sxs-lookup"><span data-stu-id="44dea-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="44dea-109">Более мощный и гибкий подход к расширению оболочки заключается в реализации *обработчиков расширения оболочки*.</span><span class="sxs-lookup"><span data-stu-id="44dea-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="44dea-110">Эти обработчики могут быть реализованы для различных действий, которые может выполнять оболочка.</span><span class="sxs-lookup"><span data-stu-id="44dea-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="44dea-111">Перед выполнением действия оболочка запрашивает обработчик расширения, предоставляя ему возможность изменить действие.</span><span class="sxs-lookup"><span data-stu-id="44dea-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="44dea-112">Распространенным примером является обработчик расширения контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="44dea-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="44dea-113">Если один из файлов реализуется для типа файла, он запрашивается каждый раз при щелчке правой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="44dea-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="44dea-114">Затем обработчик может указать дополнительные пункты меню для каждого файла, вместо того чтобы иметь одинаковый набор для всех файлов этого типа.</span><span class="sxs-lookup"><span data-stu-id="44dea-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="44dea-115">В этом наборе разделов обсуждается реализация обработчиков расширений, позволяющих изменять разнообразные действия оболочки.</span><span class="sxs-lookup"><span data-stu-id="44dea-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="44dea-116">Следующие обработчики связаны с определенным типом файла и позволяют указать отдельно для каждого файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="44dea-117">Обработчик</span><span class="sxs-lookup"><span data-stu-id="44dea-117">Handler</span></span>                                               | <span data-ttu-id="44dea-118">Описание</span><span class="sxs-lookup"><span data-stu-id="44dea-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="44dea-119">Обработчик контекстного меню</span><span class="sxs-lookup"><span data-stu-id="44dea-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="44dea-120">Вызывается перед отображением контекстного меню файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="44dea-121">Он позволяет добавлять элементы в контекстное меню для каждого файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="44dea-122">Обработчик данных</span><span class="sxs-lookup"><span data-stu-id="44dea-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="44dea-123">Вызывается при выполнении операции перетаскивания объектов оболочки.</span><span class="sxs-lookup"><span data-stu-id="44dea-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="44dea-124">Он позволяет предоставлять дополнительные форматы буфера обмена для целевого объекта перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="44dea-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="44dea-125">Удалить обработчик</span><span class="sxs-lookup"><span data-stu-id="44dea-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="44dea-126">Вызывается, когда объект данных перетаскивается или удаляется в файле.</span><span class="sxs-lookup"><span data-stu-id="44dea-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="44dea-127">Он позволяет преобразовать файл в цель перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="44dea-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="44dea-128">Обработчик значков</span><span class="sxs-lookup"><span data-stu-id="44dea-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="44dea-129">Вызывается перед отображением значка файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="44dea-130">Он позволяет заменить значок файла по умолчанию на пользовательский значок для каждого файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="44dea-131">Обработчик страницы свойств</span><span class="sxs-lookup"><span data-stu-id="44dea-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="44dea-132">Вызывается перед отображением страницы свойств **Свойства** объекта.</span><span class="sxs-lookup"><span data-stu-id="44dea-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="44dea-133">Он позволяет добавлять или заменять страницы.</span><span class="sxs-lookup"><span data-stu-id="44dea-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="44dea-134">**Обработчик изображений эскиза**</span><span class="sxs-lookup"><span data-stu-id="44dea-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="44dea-135">Предоставляет изображение для представления элемента.</span><span class="sxs-lookup"><span data-stu-id="44dea-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="44dea-136">**Обработчик подсказок**</span><span class="sxs-lookup"><span data-stu-id="44dea-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="44dea-137">Предоставляет всплывающий текст, когда пользователь наводит указатель мыши на объект.</span><span class="sxs-lookup"><span data-stu-id="44dea-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="44dea-138">**Обработчик метаданных**</span><span class="sxs-lookup"><span data-stu-id="44dea-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="44dea-139">Предоставляет доступ на чтение и запись к метаданным (свойствам), хранящимся в файле.</span><span class="sxs-lookup"><span data-stu-id="44dea-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="44dea-140">Это можно использовать для расширения подробного представления, инфотипс, страницы свойств и функций группирования.</span><span class="sxs-lookup"><span data-stu-id="44dea-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="44dea-141">Другие не связаны с определенным типом файлов, но вызываются перед некоторыми операциями оболочки.</span><span class="sxs-lookup"><span data-stu-id="44dea-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="44dea-142">Обработчик</span><span class="sxs-lookup"><span data-stu-id="44dea-142">Handler</span></span>                                                            | <span data-ttu-id="44dea-143">Описание</span><span class="sxs-lookup"><span data-stu-id="44dea-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="44dea-144">Обработчик столбцов</span><span class="sxs-lookup"><span data-stu-id="44dea-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="44dea-145">Вызывается проводником Windows перед отображением подробного представления папки.</span><span class="sxs-lookup"><span data-stu-id="44dea-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="44dea-146">Он позволяет добавлять пользовательские столбцы в представление Details.</span><span class="sxs-lookup"><span data-stu-id="44dea-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="44dea-147">Копирование обработчика перехватчика</span><span class="sxs-lookup"><span data-stu-id="44dea-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="44dea-148">Вызывается, когда объект папки или принтера собирается перемещаться, копироваться, удаляться или переименовываться.</span><span class="sxs-lookup"><span data-stu-id="44dea-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="44dea-149">Она позволяет утвердить или отклонить операцию.</span><span class="sxs-lookup"><span data-stu-id="44dea-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="44dea-150">Обработчик действия перетаскивания</span><span class="sxs-lookup"><span data-stu-id="44dea-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="44dea-151">Вызывается при перетаскивании файла с помощью правой кнопки мыши.</span><span class="sxs-lookup"><span data-stu-id="44dea-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="44dea-152">Это позволяет изменить отображаемое контекстное меню.</span><span class="sxs-lookup"><span data-stu-id="44dea-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="44dea-153">Обработчик наложения значков</span><span class="sxs-lookup"><span data-stu-id="44dea-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="44dea-154">Вызывается перед отображением значка файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="44dea-155">Он позволяет указать наложение для значка файла.</span><span class="sxs-lookup"><span data-stu-id="44dea-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="44dea-156">Поисковый обработчик</span><span class="sxs-lookup"><span data-stu-id="44dea-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="44dea-157">Вызывается для запуска поисковой системы.</span><span class="sxs-lookup"><span data-stu-id="44dea-157">Called to launch a search engine.</span></span> <span data-ttu-id="44dea-158">Она позволяет реализовать пользовательскую подсистему поиска, доступную в меню " **Пуск** " или в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="44dea-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="44dea-159">Сведения о реализации конкретных обработчиков расширений описаны в разделах, перечисленных выше.</span><span class="sxs-lookup"><span data-stu-id="44dea-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="44dea-160">Обсуждения проблем реализации, общих для всех обработчиков расширений оболочки, см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="44dea-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="44dea-161">Инициализация обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="44dea-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="44dea-162">Регистрация обработчиков расширений оболочки</span><span class="sxs-lookup"><span data-stu-id="44dea-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
