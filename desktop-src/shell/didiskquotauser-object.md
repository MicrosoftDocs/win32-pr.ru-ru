---
description: Позволяет клиенту управлять параметрами дисковой квоты на глобальные тома NTFS. этот объект делает необходимые функции интерфейса дидисккуотаусер доступными для создания сценариев и приложений на основе Microsoft Visual Basic.
title: Объект Дидисккуотаусер
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- DIDiskQuotaUser
api_type:
- COM
api_location:
- Shell32.dll
ms.assetid: 0cdf3293-3dcf-44e7-a80d-4eacf9d09fbf
ms.openlocfilehash: 65d8397ed07fc3ebab9fd4846b008f97c1b7e756366118314b978f94b64c8636
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119032812"
---
# <a name="didiskquotauser-object"></a>Объект Дидисккуотаусер

Позволяет клиенту управлять параметрами дисковой квоты на глобальные тома NTFS. этот объект делает необходимые функции интерфейса **дидисккуотаусер** доступными для создания сценариев и приложений на основе Microsoft Visual Basic.

## <a name="members"></a>Элементы

Объект **дидисккуотаусер** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Объект **дидисккуотаусер** содержит эти методы.



| Метод                                           | Описание                                             |
|:-------------------------------------------------|:--------------------------------------------------------|
| [**Invalidate**](didiskquotauser-invalidate.md) | Очищает кэшированные данные пользователя объекта.<br/> |



 

### <a name="properties"></a>Свойства

Объект **дидисккуотаусер** имеет следующие свойства.



| Свойство                                                                        | Тип доступа           | Описание                                                                                          |
|:--------------------------------------------------------------------------------|:----------------------|:-----------------------------------------------------------------------------------------------------|
| [**аккаунтконтаинернаме**](didiskquotauser-accountcontainername.md)<br/> | Только для чтения<br/>  | Возвращает имя контейнера учетной записи пользователя.<br/>                                            |
| [**аккаунтстатус**](didiskquotauser-accountstatus.md)<br/>               | Только для чтения<br/>  | Возвращает состояние учетной записи пользователя.<br/>                                                    |
| [**DisplayName**](didiskquotauser-displayname.md)<br/>                   | Только для чтения<br/>  | Возвращает отображаемое имя пользователя.<br/>                                                             |
| [**ID**](didiskquotauser-id.md)<br/>                                     | Только для чтения<br/>  | Возвращает идентификатор, который однозначно идентифицирует пользователя.<br/>                                             |
| [**логоннаме**](didiskquotauser-logonname.md)<br/>                       | Только для чтения<br/>  | Возвращает имя учетной записи входа пользователя.<br/>                                                       |
| [**QuotaLimit**](didiskquotauser-quotalimit.md)<br/>                     | Чтение/запись<br/> | Задает или возвращает текущую [**квоту**](diskquotacontrol-object.md)пользователя.<br/>           |
| [**куоталимиттекст**](didiskquotauser-quotalimittext.md)<br/>             | Только для чтения<br/>  | Возвращает текущую [**предельную квоту**](diskquotacontrol-object.md) пользователя в виде текстовой строки. <br/> |
| [**куотасрешолд**](didiskquotauser-quotathreshold.md)<br/>             | Чтение/запись<br/> | Задает или возвращает порог предупреждения пользователя в байтах.<br/>                                      |
| [**куотасрешолдтекст**](didiskquotauser-quotathresholdtext.md)<br/>     | Только для чтения<br/>  | Возвращает пороговое значение предупреждения пользователя в виде текстовой строки.<br/>                                       |
| [**QuotaUsed**](didiskquotauser-quotaused.md)<br/>                       | Только для чтения<br/>  | Возвращает текущее использование диска пользователем в байтах.<br/>                                             |
| [**куотауседтекст**](didiskquotauser-quotausedtext.md)<br/>               | Только для чтения<br/>  | Возвращает текущий объем использования диска пользователем в виде текстовой строки.<br/>                                      |



 

## <a name="remarks"></a>Remarks

Каждый пользователь на томе, управляемом объектом [**дисккуотаконтрол**](diskquotacontrol-object.md) , имеет связанный с ним объект **дидисккуотаусер** . Этот объект позволяет клиенту управлять параметрами отдельных пользователей. Существует несколько способов получить объект **дидисккуотаусер** пользователя:

-   Объекты **дидисккуотаусер** для всех пользователей с квотами на томе предоставляются в виде коллекции, и их можно перечислить. Ниже приведено обсуждение того, как перечислить объекты **дидисккуотаусер** .
-   При добавлении нового пользователя метод [**adduser**](diskquotacontrol-adduser.md) возвращает объект пользователя **дидисккуотаусер** .
-   Если у вас есть имя пользователя, метод [**финдусер**](diskquotacontrol-finduser.md) возвращает объект **дидисккуотаусер** пользователя.

### <a name="enumerating-disk-quota-users"></a>Перечисление пользователей дисковой квоты

Объекты **дидисккуотаусер** для всех пользователей с квотой на том предоставляются в виде коллекции. Объект [**дисккуотаконтрол**](diskquotacontrol-object.md) экспортирует стандартный метод перечислителя, позволяющий перечислить коллекцию объектов **дидисккуотаусер** . в следующей процедуре показано, как выполнить перечисление с помощью Microsoft JScript (совместимое с спецификацией языка ECMA 262). аналогичную процедуру можно использовать с Visual Basic или Microsoft Visual Basic scripting Edition (VBScript).

1.  Создайте новый объект [**дисккуотаконтрол**](diskquotacontrol-object.md) .
2.  Инициализируйте его с помощью [**Initialize**](diskquotacontrol-initialize.md).
3.  создайте новый объект **перечислителя** JScript.
4.  Используйте цикл **for** для перечисления объектов **дидисккуотаусер** . Нет необходимости задавать начальное значение. Метод **MoveNext** объекта перечислителя уведомляет метод **Item** , чтобы вернуть следующий объект **дидисккуотаусер** . Метод **atEnd** возвращает **значение false** , если достигнут конец списка.
5.  При необходимости используйте объект **дидисккуотаусер** , возвращенный методом **элемента** перечислителя, для получения или задания одного или нескольких свойств квоты диска связанного пользователя.

В следующем фрагменте кода показано, как перечислить объекты **дидисккуотаусер** с JScript. Аргумент **\_ метки тома** , передаваемый функции **енумусерс** , представляет собой строковое значение, содержащее метку тома, например "C: \\ \\ ".


```
function EnumUsers(Volume_Label)
{
    var Volume;
    var QuotaUsers;
    var QuotaUser;

    Volume = new ActiveXObject("Microsoft.DiskQuota.1");
    Volume.Initialize(Volume_Label, 1);

    QuotaUsers = new Enumerator(Volume);
    for (;!Users.atEnd(); Users.moveNext())
    {
       QuotaUser = QuotaUsers.item();

     //Use the QuotaUser object to retrieve or set one or more
     //of the user's disk quota properties
     ...
    }
}
```



## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                    |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                          |
| DLL<br/>                      | <dl> <dt>Shell32.dll (версия 5,0 или более поздняя)</dt> </dl> |



## <a name="see-also"></a>См. также

<dl> <dt>

[**Объект оболочки**](shell.md)
</dt> </dl>

 

 




