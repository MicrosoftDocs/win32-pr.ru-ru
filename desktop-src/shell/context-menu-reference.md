---
description: В этом разделе перечислены основные элементы программирования, используемые в контекстных меню (контекстном), и обработчики контекстного меню. Обработчики контекстного меню, также известные как обработчики контекстного меню или обработчиков команд, являются типом обработчика типов файлов.
ms.assetid: efd96a52-6455-40bc-9c21-65f89728e771
title: Справочник по контекстному меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8cb1552c8f2f383b08984e9142e464b6831a3c8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104262917"
---
# <a name="shortcut-menu-reference"></a><span data-ttu-id="de1c9-104">Справочник по контекстному меню</span><span class="sxs-lookup"><span data-stu-id="de1c9-104">Shortcut Menu Reference</span></span>

<span data-ttu-id="de1c9-105">В этом разделе перечислены основные элементы программирования, используемые в контекстных меню (контекстном), и обработчики контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="de1c9-105">This topic lists the main programming elements used with shortcut (context) menus, and shortcut menu handlers.</span></span> <span data-ttu-id="de1c9-106">Обработчики контекстного меню, также известные как обработчики контекстного меню или обработчиков команд, являются типом обработчика типов файлов.</span><span class="sxs-lookup"><span data-stu-id="de1c9-106">Shortcut menu handlers, which also known as context menu handlers or verb handlers, are a type of file type handler.</span></span>

## <a name="about-shortcut-menu-implemetation"></a><span data-ttu-id="de1c9-107">О контекстном меню Имплеметатион</span><span class="sxs-lookup"><span data-stu-id="de1c9-107">About Shortcut Menu Implemetation</span></span>

<span data-ttu-id="de1c9-108">Настоятельно рекомендуется реализовать контекстное меню с помощью одного из статических методов глагола.</span><span class="sxs-lookup"><span data-stu-id="de1c9-108">It is strongly encouraged that you implement a shortcut menu using one of the static verb methods.</span></span> <span data-ttu-id="de1c9-109">Ознакомьтесь со следующими инструкциями:</span><span class="sxs-lookup"><span data-stu-id="de1c9-109">Please review the following instructions:</span></span>

-   <span data-ttu-id="de1c9-110">Чтобы использовать статический метод Verb для реализации контекстного меню, см. раздел "Настройка контекстного меню с использованием статических глаголов" раздела [Создание обработчиков контекстного меню](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="de1c9-110">To use a static verb method to implement a shortcut menu, see the "Customizing a Shortcut Menu using Static Verbs" section of [Creating Shortcut Menu Handlers](context-menu-handlers.md).</span></span>
-   <span data-ttu-id="de1c9-111">Чтобы получить динамическое поведение для статических глаголов в Windows 7 и более поздних версиях, см. раздел «получение динамического поведения для статических глаголов» раздела [Создание обработчиков контекстного меню](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="de1c9-111">To get dynamic behavior for static verbs in Windows 7 and later, see "Getting Dynamic Behavior for Static Verbs" in [Creating Shortcut Menu Handlers](context-menu-handlers.md).</span></span>
-   <span data-ttu-id="de1c9-112">Дополнительные сведения о реализации статических команд и о том, какие динамические команды следует избегать, см. в разделе [Выбор статической или динамической команды для контекстного меню](shortcut-choose-method.md).</span><span class="sxs-lookup"><span data-stu-id="de1c9-112">For details on static verb implementation, and which dynamic verbs to avoid, see [Choosing a Static or Dynamic Verb for your Shortcut Menu](shortcut-choose-method.md).</span></span>
-   <span data-ttu-id="de1c9-113">Если необходимо расширить контекстное меню для типа файла, зарегистрировав динамическую команду для типа файла, следуйте инструкциям, приведенным в разделе [Настройка контекстного меню с помощью динамических команд](shortcut-menu-using-dynamic-verbs.md).</span><span class="sxs-lookup"><span data-stu-id="de1c9-113">If you must extend the shortcut menu for a file type by registering a dynamic verb for the file type, then follow the instructions provided in [Customizing a Shortcut Menu Using Dynamic Verbs](shortcut-menu-using-dynamic-verbs.md).</span></span>

### <a name="interfaces"></a><span data-ttu-id="de1c9-114">Интерфейсы</span><span class="sxs-lookup"><span data-stu-id="de1c9-114">Interfaces</span></span>



| <span data-ttu-id="de1c9-115">Раздел</span><span class="sxs-lookup"><span data-stu-id="de1c9-115">Topic</span></span>                                        | <span data-ttu-id="de1c9-116">Содержимое</span><span class="sxs-lookup"><span data-stu-id="de1c9-116">Contents</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="de1c9-117">**IContextMenu**</span><span class="sxs-lookup"><span data-stu-id="de1c9-117">**IContextMenu**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu)         | <span data-ttu-id="de1c9-118">Предоставляет методы, которые либо создают, либо объединяют контекстное меню, связанное с объектом Shell.</span><span class="sxs-lookup"><span data-stu-id="de1c9-118">Exposes methods that either create or merge a shortcut menu associated with a Shell object.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="de1c9-119">**IContextMenu2**</span><span class="sxs-lookup"><span data-stu-id="de1c9-119">**IContextMenu2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)       | <span data-ttu-id="de1c9-120">Предоставляет методы, которые либо создают, либо объединяют контекстное меню (контекст), связанное с объектом Shell.</span><span class="sxs-lookup"><span data-stu-id="de1c9-120">Exposes methods that either create or merge a shortcut (context) menu associated with a Shell object.</span></span> <span data-ttu-id="de1c9-121">Расширяет [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) , добавляя метод, который позволяет клиентским объектам работать с сообщениями, связанными с элементами меню, рисуемыми владельцем.</span><span class="sxs-lookup"><span data-stu-id="de1c9-121">Extends [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) by adding a method that allows client objects to handle messages associated with owner-drawn menu items.</span></span><br/>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="de1c9-122">**IContextMenu3**</span><span class="sxs-lookup"><span data-stu-id="de1c9-122">**IContextMenu3**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3)       | <span data-ttu-id="de1c9-123">Предоставляет методы, которые либо создают, либо объединяют контекстное меню, связанное с объектом Shell.</span><span class="sxs-lookup"><span data-stu-id="de1c9-123">Exposes methods that either create or merge a shortcut menu associated with a Shell object.</span></span> <span data-ttu-id="de1c9-124">Позволяет клиентским объектам обрабатывать сообщения, связанные с элементами меню, рисуемыми владельцем, и расширяет [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2) , принимая возвращаемое значение из этой обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="de1c9-124">Allows client objects to handle messages associated with owner-drawn menu items and extends [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2) by accepting a return value from that message handling.</span></span><br/>                                                                                                                                                                                                                         |
| [<span data-ttu-id="de1c9-125">**иконтекстменукб**</span><span class="sxs-lookup"><span data-stu-id="de1c9-125">**IContextMenuCB**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenucb)     | <span data-ttu-id="de1c9-126">Предоставляет метод, который обеспечивает обратный вызов контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="de1c9-126">Exposes a method that enables the callback of a context menu.</span></span> <span data-ttu-id="de1c9-127">Например, чтобы добавить значок щита к элементу **menuItem** , требующему повышения прав.</span><span class="sxs-lookup"><span data-stu-id="de1c9-127">For example, to add a shield icon to a **menuItem** that requires elevation.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="de1c9-128">**иконтекстменусите**</span><span class="sxs-lookup"><span data-stu-id="de1c9-128">**IContextMenuSite**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) | <span data-ttu-id="de1c9-129">Реализуется в представлении папок по умолчанию, созданном с помощью [**шкреатешеллфолдервиев**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span><span class="sxs-lookup"><span data-stu-id="de1c9-129">Implemented by the default folder view created using [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span> <span data-ttu-id="de1c9-130">Реализация [**иконтекстменусите**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) поддерживает [**IContextMenu:: куериконтекстмену**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), [**IContextMenu:: инвокекомманд**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand)и [**метод TrackPopupMenu**](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) , а также любую пересылку сообщений, необходимую для этой функции.</span><span class="sxs-lookup"><span data-stu-id="de1c9-130">An implementation of [**IContextMenuSite**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) supports [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand), and [**TrackPopupMenu**](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) and any message forwarding necessary for that function.</span></span> <span data-ttu-id="de1c9-131">Как правило, **иконтекстменусите** также обновляет строку состояния.</span><span class="sxs-lookup"><span data-stu-id="de1c9-131">**IContextMenuSite** typically updates the status bar as well.</span></span><br/> |



 

### <a name="functions"></a><span data-ttu-id="de1c9-132">Функции</span><span class="sxs-lookup"><span data-stu-id="de1c9-132">Functions</span></span>



| <span data-ttu-id="de1c9-133">Раздел</span><span class="sxs-lookup"><span data-stu-id="de1c9-133">Topic</span></span>                                                            | <span data-ttu-id="de1c9-134">Содержимое</span><span class="sxs-lookup"><span data-stu-id="de1c9-134">Contents</span></span>                                                                                                                                |
|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="de1c9-135">**Кдеффолдермену \_ Create2**</span><span class="sxs-lookup"><span data-stu-id="de1c9-135">**CDefFolderMenu\_Create2**</span></span>](/windows/desktop/api/shlobj_core/nf-shlobj_core-cdeffoldermenu_create2)        | <span data-ttu-id="de1c9-136">Создает контекстное меню для выбранной группы объектов папки с файлами.</span><span class="sxs-lookup"><span data-stu-id="de1c9-136">Creates a context menu for a selected group of file folder objects.</span></span><br/>                                                          |
| [<span data-ttu-id="de1c9-137">**лпфндфмкаллбакк**</span><span class="sxs-lookup"><span data-stu-id="de1c9-137">**LPFNDFMCALLBACK**</span></span>](/windows/win32/api/shlobj_core/nc-shlobj_core-lpfndfmcallback)                       | <span data-ttu-id="de1c9-138">Определяет прототип функции обратного вызова, который получает сообщения от реализации контекстного меню по умолчанию в оболочке.</span><span class="sxs-lookup"><span data-stu-id="de1c9-138">Defines the prototype for the callback function that receives messages from the Shell's default context menu implementation.</span></span><br/> |
| [<span data-ttu-id="de1c9-139">**шкреатедефаултконтекстмену**</span><span class="sxs-lookup"><span data-stu-id="de1c9-139">**SHCreateDefaultContextMenu**</span></span>](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu) | <span data-ttu-id="de1c9-140">Создает объект, представляющий реализацию контекстного меню по умолчанию для оболочки.</span><span class="sxs-lookup"><span data-stu-id="de1c9-140">Creates an object that represents the Shell's default context menu implementation.</span></span><br/>                                           |



 

### <a name="structures"></a><span data-ttu-id="de1c9-141">Структуры</span><span class="sxs-lookup"><span data-stu-id="de1c9-141">Structures</span></span>



| <span data-ttu-id="de1c9-142">Раздел</span><span class="sxs-lookup"><span data-stu-id="de1c9-142">Topic</span></span>                                                  | <span data-ttu-id="de1c9-143">Содержимое</span><span class="sxs-lookup"><span data-stu-id="de1c9-143">Contents</span></span>                                                                                                                                                                                                   |
|--------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="de1c9-144">**кминвокекоммандинфо**</span><span class="sxs-lookup"><span data-stu-id="de1c9-144">**CMINVOKECOMMANDINFO**</span></span>](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo)     | <span data-ttu-id="de1c9-145">Содержит сведения, необходимые [**IContextMenu:: инвокекомманд**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) для вызова команды контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="de1c9-145">Contains information needed by [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to invoke a shortcut menu command.</span></span><br/>                                                             |
| [<span data-ttu-id="de1c9-146">**кминвокекоммандинфоекс**</span><span class="sxs-lookup"><span data-stu-id="de1c9-146">**CMINVOKECOMMANDINFOEX**</span></span>](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfoex) | <span data-ttu-id="de1c9-147">Содержит расширенные сведения о команде контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="de1c9-147">Contains extended information about a shortcut menu command.</span></span> <span data-ttu-id="de1c9-148">Эта структура является расширенной версией [**кминвокекоммандинфо**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) , которая позволяет использовать значения Юникода.</span><span class="sxs-lookup"><span data-stu-id="de1c9-148">This structure is an extended version of [**CMINVOKECOMMANDINFO**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) that allows the use of Unicode values.</span></span><br/> |
| [<span data-ttu-id="de1c9-149">**дефконтекстмену**</span><span class="sxs-lookup"><span data-stu-id="de1c9-149">**DEFCONTEXTMENU**</span></span>](/windows/desktop/api/shlobj_core/ns-shlobj_core-defcontextmenu)               | <span data-ttu-id="de1c9-150">Содержит сведения о контекстном меню, используемом [**шкреатедефаултконтекстмену**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="de1c9-150">Contains context menu information used by [**SHCreateDefaultContextMenu**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu).</span></span><br/>                                                                                     |



 

## <a name="related-topics"></a><span data-ttu-id="de1c9-151">См. также</span><span class="sxs-lookup"><span data-stu-id="de1c9-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="de1c9-152">Контекстное меню (контекст) и обработчики контекстного меню</span><span class="sxs-lookup"><span data-stu-id="de1c9-152">Shortcut (Context) Menus and Shortcut Menu Handlers</span></span>](context-menu.md)
</dt> <dt>

[<span data-ttu-id="de1c9-153">Выбор статической или динамической команды для контекстного меню</span><span class="sxs-lookup"><span data-stu-id="de1c9-153">Choosing a Static or Dynamic Verb for your Shortcut Menu</span></span>](shortcut-choose-method.md)
</dt> <dt>

[<span data-ttu-id="de1c9-154">Команды и сопоставления файлов</span><span class="sxs-lookup"><span data-stu-id="de1c9-154">Verbs and File Associations</span></span>](fa-verbs.md)
</dt> <dt>

[<span data-ttu-id="de1c9-155">Рекомендации по работе с обработчиками контекстного меню и несколькими командами выбора</span><span class="sxs-lookup"><span data-stu-id="de1c9-155">Best Practices for Shortcut Menu Handlers and Multiple Selection Verbs</span></span>](verbs-best-practices.md)
</dt> <dt>

[<span data-ttu-id="de1c9-156">Создание обработчиков контекстного меню</span><span class="sxs-lookup"><span data-stu-id="de1c9-156">Creating Shortcut Menu Handlers</span></span>](context-menu-handlers.md)
</dt> <dt>

[<span data-ttu-id="de1c9-157">Настройка контекстного меню с помощью динамических команд</span><span class="sxs-lookup"><span data-stu-id="de1c9-157">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](shortcut-menu-using-dynamic-verbs.md)
</dt> </dl>

 

 
