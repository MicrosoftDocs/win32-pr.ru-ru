---
description: В этом разделе описывается, какие библиотеки и как они могут помочь пользователям и разработчикам.
ms.assetid: D5F5FE96-11D2-4fc5-A68B-6E594C09BE20
title: О библиотеках
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e577e7b5df0a1e072a07a096434af84ff8e2c26
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104554930"
---
# <a name="about-libraries"></a>О библиотеках

В этом разделе описывается, какие библиотеки и как они могут помочь пользователям и разработчикам.

Библиотеки представляют собой определяемые пользователем коллекции папок. Библиотека отслеживает физическое место хранения каждой папки, что позволяет отменять пользователя и программное обеспечение этой задачи. Пользователи могут группировать связанные папки вместе в библиотеке, даже если эти папки хранятся на разных жестких дисках или на разных компьютерах.

В библиотеке папки и файлы отображаются для пользователя как единая коллекция, и с помощью API библиотеки оболочки содержимое библиотеки может также находиться в одном расположении с программой.

В библиотеке содержимое, например документы пользователя, фотографии, видео или музыку, может быть отсортировано и отображено по мере необходимости, а не просто в соответствии с требованиями файловой системы. Например, пользователи могут упорядочивать содержимое библиотеки с помощью свойств элементов в библиотеке, чтобы связанные элементы могли сортироваться вместе, даже если они хранятся в разных папках.

![снимок экрана с пользовательским интерфейсом библиотек](images/libraries-whatare.png)

В этом разделе:

-   [Преимущества библиотеки](#library-benefits)
    -   [Преимущества для пользователей](#user-benefits)
    -   [Преимущества для разработчиков](#developer-benefits)
-   [Управление папками в библиотеках](#managing-folders-in-libraries)
-   [См. также](#related-topics)

## <a name="library-benefits"></a>Преимущества библиотеки

В этом разделе описываются некоторые преимущества библиотек с точки зрения конечного пользователя и точки зрения разработчика программы.

### <a name="user-benefits"></a>Преимущества для пользователей

Добавление в программу поддержки библиотек предоставляет пользователю следующие преимущества.

-   **Библиотеки предоставляют единообразный пользовательский интерфейс в Windows 7**

    Общие диалоговые окна файлов поддерживают библиотеки и предоставляют те же возможности, что и проводник Windows в Windows 7. Поддержка библиотек в программе поможет обеспечить более эффективное взаимодействие с пользователем при использовании программы в Windows 7.

-   **Пользователи решают, где хранить содержимое**

    Библиотеки позволяют пользователям управлять местом хранения содержимого. В то же время библиотеки предоставляют пользователям разумные значения по умолчанию, которые не хотят управлять этим уровнем детализации на своем компьютере. Пользователи определяют, сколько и сколько элементов управления нужно контролировать, где и как хранится их содержимое, и библиотека работает правильно.

### <a name="developer-benefits"></a>Преимущества для разработчиков

Библиотеки в программе можно использовать для предоставления более гибкого и удобного пользовательского интерфейса без необходимости добавлять множество сложных программных программ. Ниже перечислены некоторые преимущества добавления поддержки библиотек.

-   **Библиотеки поддерживают доступ к библиотеке и файловой системе**

    С помощью [**API библиотеки оболочки**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)программы могут предоставлять пользователю поддержку библиотек, уменьшая сложность кода управления файлами и папками. Если программа уже использует API файловой системы, можно сохранить как можно большую часть существующего кода и по-прежнему предоставлять пользователю поддержку библиотеки, получая необходимые сведения о файловой системе из **API библиотеки оболочки**.

-   **Упрощенное уведомление об изменении**

    Как файловая система, так и API оболочки могут уведомлять программу при изменении содержимого наблюдаемой папки или библиотеки. Однако с помощью API оболочки можно отслеживать все папки в библиотеке с помощью одного уведомления, даже несмотря на то, что папка в библиотеке может храниться на разных дисках или даже на разных компьютерах.

-   **Библиотеки используют свойства файлов**

    Программы могут использовать свойства файла для управления отображением файлов во время операций открытия и сохранения, использующих общие диалоговые окна файла. Программы также могут иметь доступ к свойствам файла с помощью интерфейсов [**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore) . Общие диалоговые окна файла также можно настроить, чтобы пользователи могли обновлять свойства, связанные с их содержимым.

-   **Программы могут создавать выделенные библиотеки**

    Новая библиотека может быть создана, если существующие пользовательские библиотеки не соответствуют потребностям программы, например, если программа создает новый тип содержимого пользователя. Новую библиотеку можно настроить с помощью уникального значка, который представляет их содержимое, и упрощает обнаружение библиотеки в проводнике Windows.

## <a name="managing-folders-in-libraries"></a>Управление папками в библиотеках

Пользователи могут упорядочивать свои библиотеки, добавляя, перемещая или удаляя папки в библиотеке. Однако не все папки поддерживают все функции, которые может предоставить библиотека. Многие функции библиотеки нуждаются в быстром доступе к различным свойствам папки и ее содержимому, доступным только в Windows Search. Чтобы обеспечить полную функциональность библиотеки, папка должна быть доступна для индексирования с помощью службы поиска Windows.

Библиотека не позволяет пользователю добавлять папки, которые не предоставляют полную функциональность библиотеки. Однако [**API библиотеки оболочки**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) могут добавлять такие папки. Если библиотека содержит папку, которая не поддерживает полную функциональность библиотеки, Библиотека будет работает в защищенном режиме и предоставляет ограниченную функциональность. В следующей таблице описаны папки, поддерживающие полную функциональность библиотеки, и те, которые не поддерживаются.



| Типы папок, поддерживающие полную функциональность библиотеки                                                               | Типы папок, не поддерживающие полную функциональность библиотеки                                  |
|--------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| Фиксированные и внешние жесткие диски NTFS и FAT32.                                                                     | Съемные диски, такие как флэш-накопители USB или карты памяти Secure Digital (SD).               |
| Общие файловые ресурсы, индексируемые службой поиска Windows, например серверы отделов, Windows 7 или домашние компьютеры Windows Vista. | Съемные носители, такие как компакт-диски или DVD-диски.                                                 |
| Общие файловые ресурсы, доступные автономно, такие как перенаправленная папка " **Мои документы** " или кэш Client-Side.        | Сетевые папки, которые недоступны для автономного или удаленного индексирования, например для дисков NAS.   |
|                                                                                                                    | Другие источники данных, такие как Microsoft SharePoint, Microsoft Exchange и Microsoft OneDrive. |



 

На следующем рисунке показано ограниченное отображение содержимого библиотеки в защищенном режиме.

![открыть диалоговое окно при работе с библиотеками в защищенном режиме](images/libraries-supportedfolders.png)

## <a name="related-topics"></a>См. также

<dl> <dt>

[О библиотеках](library-leverage-to-manage-folders.md)
</dt> <dt>

[**ишелллибрари**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)
</dt> <dt>

[Ссылки оболочки](./links.md)
</dt> <dt>

[Известные папки](known-folders.md)
</dt> <dt>

[Схема описания библиотеки](library-schema-entry.md)
</dt> </dl>

 

 
