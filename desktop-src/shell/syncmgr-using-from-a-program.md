---
description: Чтобы приложение работало с диспетчером синхронизации, необходимо реализовать объект модели COM для управления уведомлениями синхронизации, получаемыми от Синкмгр.
title: Использование диспетчера синхронизации из программы
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bf18d493-0fe7-46e7-9686-f7ee75b3039b
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 9bd5abdc382c82c6c1aafcda3a967337384dc807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104546927"
---
# <a name="using-synchronization-manager-from-a-program"></a><span data-ttu-id="f5630-103">Использование диспетчера синхронизации из программы</span><span class="sxs-lookup"><span data-stu-id="f5630-103">Using Synchronization Manager from a Program</span></span>

<span data-ttu-id="f5630-104">Чтобы приложение работало с диспетчером синхронизации, необходимо реализовать объект модели COM для управления уведомлениями синхронизации, получаемыми от Синкмгр.</span><span class="sxs-lookup"><span data-stu-id="f5630-104">To enable your application to work with the Synchronization Manager you must implement a Component Object Model (COM) object to handle synchronization notifications that you receive from SyncMgr.</span></span> <span data-ttu-id="f5630-105">Обработчик приложения выполняет синхронизацию для обрабатываемых элементов.</span><span class="sxs-lookup"><span data-stu-id="f5630-105">Your application's handler performs the synchronization for the items that you handle.</span></span> <span data-ttu-id="f5630-106">Включается в обработчик, поэтому необходимо реализовать интерфейс [**исинкмгрсинчронизе**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="f5630-106">Included in your handler, you must implement the [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="f5630-107">Кроме того, необходимо предоставить объект перечислителя и [**исинкмгренумитемс**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) для всех отдельных элементов, которые может синхронизировать приложение.</span><span class="sxs-lookup"><span data-stu-id="f5630-107">Also, you must provide an enumerator object and [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) for any separate items that your application can synchronize.</span></span>

<span data-ttu-id="f5630-108">Синкмгр реализует [**исинкмгрсинчронизекаллбакк**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) и [**исинкмгрсинчронизеинвоке**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span><span class="sxs-lookup"><span data-stu-id="f5630-108">SyncMgr implements [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) and [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span></span>

<span data-ttu-id="f5630-109">Синкмгр вызывает методы в [**исинкмгрсинчронизе**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) для получения информации о элементах, обрабатываемых приложением, и о обработчике, который вы предоставляете для синхронизации этих элементов.</span><span class="sxs-lookup"><span data-stu-id="f5630-109">The SyncMgr calls methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) to get information on the items that your application handles and information on the handler that you provide for synchronizing these items.</span></span>

<span data-ttu-id="f5630-110">Во время выполнения процесс синхронизации выполняется следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f5630-110">At runtime, the synchronization process follows these steps.</span></span>

1.  <span data-ttu-id="f5630-111">Синкмгр уведомляет ваше приложение о том, что время синхронизации происходит для одного из элементов, обрабатываемых приложением путем вызова метода [**исинкмгрсинчронизе:: Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) .</span><span class="sxs-lookup"><span data-stu-id="f5630-111">SyncMgr notifies your application that it is time for synchronization to occur for one of the items that your application handles by calling your [**ISyncMgrSynchronize::Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) method.</span></span>
2.  <span data-ttu-id="f5630-112">Синкмгр вызывает [**исинкмгрсинчронизе:: енумсинкмгритемс**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) , чтобы получить интерфейс [**исинкмгренумитемс**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) для элементов, обрабатываемых приложением.</span><span class="sxs-lookup"><span data-stu-id="f5630-112">SyncMgr calls [**ISyncMgrSynchronize::EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) to obtain the [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) interface for the items handled by your application.</span></span>
3.  <span data-ttu-id="f5630-113">Синкмгр вызывает [**исинкмгрсинчронизе:: сетпрогресскаллбакк**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) , чтобы предоставить обработчику указатель интерфейса для интерфейса [**исинкмгрсинчронизекаллбакк**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) .</span><span class="sxs-lookup"><span data-stu-id="f5630-113">SyncMgr calls [**ISyncMgrSynchronize::SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) to provide your handler with the interface pointer for the [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) interface.</span></span> <span data-ttu-id="f5630-114">Обработчик использует этот интерфейс для обратного вызова Синкмгр во время синхронизации.</span><span class="sxs-lookup"><span data-stu-id="f5630-114">Your handler uses this interface to call back to the SyncMgr during synchronization.</span></span>
4.  <span data-ttu-id="f5630-115">Затем Синкмгр вызывает метод [**исинкмгрсинчронизе::P репарефорсинк**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) , чтобы дать обработчику возможность отобразить любой элемент пользовательского интерфейса, который необходим перед началом синхронизации.</span><span class="sxs-lookup"><span data-stu-id="f5630-115">SyncMgr then calls your [**ISyncMgrSynchronize::PrepareForSync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) method to give your handler a chance to display any user interface element that is necessary before synchronization begins.</span></span> <span data-ttu-id="f5630-116">Например, в приложении электронной почты может отображаться диалоговое окно входа пользователя.</span><span class="sxs-lookup"><span data-stu-id="f5630-116">For example, an email application may display a user logon dialog.</span></span>
5.  <span data-ttu-id="f5630-117">Обработчик вызывает [**исинкмгрсинчронизекаллбакк:: енаблемоделесс**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) до и после отображения любых элементов пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="f5630-117">Your handler calls [**ISyncMgrSynchronizeCallback::EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) before and after displaying any user interface elements.</span></span> <span data-ttu-id="f5630-118">По завершении обработчик вызывает [**исинкмгрсинчронизекаллбакк::P репарефорсинккомплетед**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) .</span><span class="sxs-lookup"><span data-stu-id="f5630-118">Your handler calls [**ISyncMgrSynchronizeCallback::PrepareForSyncCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) when you are done.</span></span>
6.  <span data-ttu-id="f5630-119">Синкмгр вызывает метод [**исинкмгрсинчронизе:: Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) для запуска синхронизации.</span><span class="sxs-lookup"><span data-stu-id="f5630-119">SyncMgr calls your [**ISyncMgrSynchronize::Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) method to start the synchronization.</span></span>

<span data-ttu-id="f5630-120">Во время процесса синхронизации Синкмгр будет вызывать методы в интерфейсе [**исинкмгрсинчронизе**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="f5630-120">During the synchronization process, SyncMgr continues to call methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="f5630-121">Он может отправлять ошибки обработчика, ход выполнения и уведомления.</span><span class="sxs-lookup"><span data-stu-id="f5630-121">It can send your handler errors, progress, and notifications.</span></span> <span data-ttu-id="f5630-122">Он также может перечислять элементы, обрабатываемые приложением, или разрешать приложению отображать свойства элементов.</span><span class="sxs-lookup"><span data-stu-id="f5630-122">It can also enumerate through the items that your application handles or allow your application to show properties for the items.</span></span>

<span data-ttu-id="f5630-123">Обработчик вызывает методы в [**исинкмгрсинчронизекаллбакк**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) , чтобы определить, следует ли пропускать элемент, записывать ошибки и отправлять сведения о ходе выполнения в процессе синхронизации.</span><span class="sxs-lookup"><span data-stu-id="f5630-123">Your handler calls methods in [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) to determine if an item should be skipped, to log errors, and to post progress information during the synchronization process.</span></span>

<span data-ttu-id="f5630-124">Дополнительные сведения см. в соответствующих справочных страницах по используемым интерфейсам.</span><span class="sxs-lookup"><span data-stu-id="f5630-124">For further information, see the related reference pages for the interfaces involved.</span></span>

<span data-ttu-id="f5630-125">По завершении синхронизации обработчик вызывает [**исинкмгрсинчронизекаллбакк:: синчронизекомплетед**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span><span class="sxs-lookup"><span data-stu-id="f5630-125">When the synchronization is completed, your handler calls [**ISyncMgrSynchronizeCallback::SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span></span>

 

 



