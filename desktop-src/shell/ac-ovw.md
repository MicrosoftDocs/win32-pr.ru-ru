---
description: Автозаполнение расширяет строки, которые были частично введены в элемент управления "Правка", в строки целиком.
title: Использование автозаполнения
ms.topic: article
ms.date: 05/31/2018
ms.assetid: b990395b-fc10-48f9-a718-7cc006e37eb7
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: fbbf0c53fc1b26002d1b46a9a6a6f67cd15e3ead
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984372"
---
# <a name="using-autocomplete"></a>Использование автозаполнения

Автозаполнение расширяет строки, которые были частично введены в [элемент управления "Правка](/windows/desktop/Controls/edit-controls) ", в строки целиком. Например, когда пользователь начинает вводить URL-адрес в элемент управления «поле ввода адреса», внедренный в панель инструментов Windows Internet Explorer, автозаполнение расширяет строку на один или несколько полных параметров URL-адресов, которые соответствуют существующей частичной строке. Частичная строка URL-адреса, например "Mic", может быть расширена до " https://www.microsoft.com " или " https://www.microsoft.com/windows ". Автозаполнение обычно используется с элементами управления "поле ввода" или с элементами управления с внедренным элементом управления "поле ввода", например с элементом управления [ComboBoxEx](/windows/desktop/Controls/comboboxex-control-reference) .

## <a name="adding-autocomplete-functionality-to-your-application"></a>Добавление функции автозаполнения в приложение

Приложение может добавлять функции автозаполнения в элемент управления "Правка" двумя способами:

-   [**Шаутокомплете**](/windows/desktop/api/shlwapi/nf-shlwapi-shautocomplete) — это простая функция, которая может Автозаполнение пути к файлу или URL-адреса.
-   Интерфейс [**иаутокомплете**](/windows/desktop/api/Shldisp/nn-shldisp-iautocomplete) предоставляется объектом автозаполнения ( \_ Автозаполнение CLSID). Это позволяет приложениям инициализировать, включать и отключать объект. **Иаутокомплете** обеспечивает больший контроль над источниками автозаполнения, включая возможность добавления пользовательского источника. Оставшаяся часть этого раздела посвящена использованию **иаутокомплете**. См. статью [как включить Автозаполнение вручную](how-to-enable-autocomplete-manually.md) для конкретных примеров использования.

## <a name="autocomplete-modes"></a>Режимы автозаполнения

При использовании [**иаутокомплете**](/windows/desktop/api/Shldisp/nn-shldisp-iautocomplete)автозавершение может отображать завершенную строку в двух режимах: автоматическое добавление и Автозаполнение. Режимы независимы; можно включить один или оба варианта. Чтобы указать режим, вызовите метод [**IAutoComplete2:: сетоптионс**](/windows/desktop/api/Shldisp/nf-shldisp-iautocomplete2-setoptions).

<dl> <dt>

<span id="Autoappend"></span><span id="autoappend"></span><span id="AUTOAPPEND"></span>Автодобавление
</dt> <dd>

В режиме автодобавления, автозаполнение добавляет оставшуюся часть наиболее вероятной строки кандидатов к существующим символам, выделяя добавленные символы. Если пользователь продолжит вводить символы, они будут добавлены в существующую частичную строку. Если пользователь добавляет символ, идентичный следующему выделенному символу, выделение для этого символа будет отключено. Остальные символы по-прежнему будут выделены. Если пользователь добавляет символ, который не соответствует следующему выделенному символу, автозавершение пытается создать новую строку-кандидат на основе большей частичной строки и добавляет оставшуюся часть новой строки-кандидата в текущую частичную строку. Если не удается найти потенциальную строку, отображаются только введенные символы, а поле редактирования ведет себя без автозаполнения. Этот процесс продолжится, пока пользователь не примет строку.

</dd> <dt>

<span id="Autosuggest"></span><span id="autosuggest"></span><span id="AUTOSUGGEST"></span>Автозаполнения
</dt> <dd>

В режиме автозаполнения в автозаполнении отображается раскрывающийся список с одной или несколькими предложенными полными строками под элементом управления "поле ввода". Пользователь может выбрать одну из предлагаемых строк или продолжить ввод. По мере ввода текста раскрывающийся список может быть изменен на основе текущей частичной строки. Если установить \_ флаг поиска ACO в [**IAutoComplete2:: сетоптионс**](/windows/desktop/api/Shldisp/nf-shldisp-iautocomplete2-setoptions), функция автозаполнения предоставляет параметр в нижней части раскрывающегося списка для поиска текущей частичной строки. Этот параметр отображается, даже если нет предлагаемых строк. Если пользователь выбирает вариант поиска, приложение должно запустить поисковую систему, чтобы помочь пользователю.

</dd> </dl>

## <a name="using-predefined-autocomplete-sources"></a>Использование предопределенных источников автозаполнения

Автозаполнение зависит от наличия источника, который предоставляет строки для сопоставления с частичной строкой пользователя. Существует возможность предоставления пользовательского источника автозаполнения, но некоторые из наиболее распространенных источников предоставляются системой.

<dl> <dt>

<span id="CLSID_ACLHistory"></span><span id="clsid_aclhistory"></span><span id="CLSID_ACLHISTORY"></span>\_АКЛХИСТОРИ CLSID
</dt> <dd>

Источник автозаполнения, соответствующий списку URL-адресов в списке журнала пользователя.

</dd> <dt>

<span id="CLSID_ACLMRU"></span><span id="clsid_aclmru"></span>\_АКЛМРУ CLSID
</dt> <dd>

Источник автозаполнения, соответствующий списку URL-адресов в списке недавно использовавшихся пользователей.

</dd> <dt>

<span id="CLSID_ACListISF"></span><span id="clsid_aclistisf"></span><span id="CLSID_ACLISTISF"></span>\_АКЛИСТИСФ CLSID
</dt> <dd>

Источник автозаполнения, который соответствует элементам в пространстве имен оболочки: файлы на компьютере пользователя, а также элементы в виртуальных папках, таких как панель управления.

</dd> </dl>

Бывают случаи, когда, вместо немедленного освобождения ресурсов, может потребоваться хранить указатели интерфейса для различных объектов, участвующих в автозаполнении. В частности, это делается, когда необходимо динамически настроить поведение автозаполнения. Чаще всего это происходит при использовании \_ объекта CLSID аклистисф, который выполняет Автозаполнение из пространства имен оболочки и имеет параметр ([**Акло \_ куррентдир**](/windows/win32/api/shlobj_core/nn-shlobj_core-iaclist2)) перечисления из текущего каталога. Например, при переходе к новой папке Internet Explorer изменяет текущий каталог адресной строки, поэтому параметры необходимо динамически изменить. Существует два способа указать каталог, который \_ объект CLSID аклистисф должен рассматривать как текущий каталог:

-   [**Иперсистфолдер**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) указывает каталог через [**итемидлист**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist).
-   [**Икуррентворкингдиректори**](/windows/win32/api/shlobj/nn-shlobj-icurrentworkingdirectory) указывает каталог по строке пути.

В следующем примере предполагается, что **PAL** является указателем на интерфейс [**ИАКЛИСТ**](/windows/win32/api/shlobj_core/nn-shlobj_core-iaclist) \_ объекта аклистисф CLSID:

-   Использование [**иперсистфолдер**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder):

    Чтобы сообщить объекту CLSID \_ аклистисф, что определенный [**итемидлист**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) должен рассматриваться как текущий каталог, можно использовать интерфейс [**иперсистфолдер**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) объекта. Так как **итемидлист** может ссылаться на виртуальную папку, этот метод является более гибким, чем использование [**икуррентворкингдиректори**](/windows/win32/api/shlobj/nn-shlobj-icurrentworkingdirectory).

    Обратите внимание, что в следующих примерах используется преобразованный QueryInterface, позволяющий упростить список параметров.

    ```C++
    IPersistFolder *ppf;

    hr = pal2->QueryInterface(IID_PPV_ARGS(&ppf));   
    if (SUCCEEDED(hr))
    {
        hr = ppf->Initialize(pidlCurrentDirectory);
        ppf->Release();
    }
    ```

    

-   Использование [**икуррентворкингдиректори**](/windows/win32/api/shlobj/nn-shlobj-icurrentworkingdirectory):

    Чтобы предоставить объекту CLSID \_ аклистисф путь в качестве текущего каталога, можно использовать интерфейс [**икуррентворкингдиректори**](/windows/win32/api/shlobj/nn-shlobj-icurrentworkingdirectory) объекта.

    ```C++
    WCHAR pwszDirectory[MAX_PATH] = L"C:\\Program Files";
    ICurrentWorkingDirectory *pcwd;

    hr = pal2->QueryInterface(IID_PPV_ARGS(&pcwd));    
    if (SUCCEEDED(hr))
    {
        hr = pcwd->SetDirectory(pwszDirectory);
        pcwd->Release();
    }
    ```

    

 

 
