---
description: Интерфейс Windows содержит специальную панель инструментов рабочего стола приложения, называемую панелью задач. Панель задач можно использовать для таких задач, как переключение между открытыми окнами и запуск новых приложений.
ms.assetid: 14d520e7-7c15-441d-9662-24b972d208ac
title: Панель задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cce37991c6265f02ab92ece62dbae341031d272a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104997851"
---
# <a name="the-taskbar"></a><span data-ttu-id="64ba1-104">Панель задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-104">The Taskbar</span></span>

<span data-ttu-id="64ba1-105">Интерфейс Windows содержит специальную [панель инструментов рабочего стола приложения](application-desktop-toolbars.md) , называемую *панелью задач*.</span><span class="sxs-lookup"><span data-stu-id="64ba1-105">The Windows interface includes a special [application desktop toolbar](application-desktop-toolbars.md) called the *taskbar*.</span></span> <span data-ttu-id="64ba1-106">Панель задач можно использовать для таких задач, как переключение между открытыми окнами и запуск новых приложений.</span><span class="sxs-lookup"><span data-stu-id="64ba1-106">You can use the taskbar for such tasks as switching between open windows and starting new applications.</span></span>

> [!Note]  
> <span data-ttu-id="64ba1-107">Сведения об изменениях, внесенных в панель задач в Windows 7, см. в разделе [расширения панели задач](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-107">For information on changes made to the taskbar as of Windows 7, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

 

<span data-ttu-id="64ba1-108">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="64ba1-108">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="64ba1-109">О панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-109">About the Taskbar</span></span>](#about-the-taskbar)
    -   [<span data-ttu-id="64ba1-110">Параметры вывода панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-110">Taskbar Display Options</span></span>](#taskbar-display-options)
    -   [<span data-ttu-id="64ba1-111">Добавление ярлыков в меню "Пуск"</span><span class="sxs-lookup"><span data-stu-id="64ba1-111">Adding Shortcuts to the Start Menu</span></span>](#adding-shortcuts-to-the-start-menu)
    -   [<span data-ttu-id="64ba1-112">Управление кнопками панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-112">Managing Taskbar Buttons</span></span>](#managing-taskbar-buttons)
    -   [<span data-ttu-id="64ba1-113">Добавление, изменение и удаление значков в области уведомлений</span><span class="sxs-lookup"><span data-stu-id="64ba1-113">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>](#adding-modifying-and-deleting-icons-in-the-notification-area)
    -   [<span data-ttu-id="64ba1-114">Уведомление о создании панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-114">Taskbar Creation Notification</span></span>](#taskbar-creation-notification)
-   [<span data-ttu-id="64ba1-115">Использование панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-115">Using the Taskbar</span></span>](#using-the-taskbar)
    -   [<span data-ttu-id="64ba1-116">Добавление и удаление значков панели задач в области уведомлений</span><span class="sxs-lookup"><span data-stu-id="64ba1-116">Adding and Deleting Taskbar Icons in the Notification Area</span></span>](#adding-and-deleting-taskbar-icons-in-the-notification-area)
    -   [<span data-ttu-id="64ba1-117">Получение событий мыши</span><span class="sxs-lookup"><span data-stu-id="64ba1-117">Receiving Mouse Events</span></span>](#receiving-mouse-events)

## <a name="about-the-taskbar"></a><span data-ttu-id="64ba1-118">О панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-118">About the Taskbar</span></span>

<span data-ttu-id="64ba1-119">Панель задач включает в себя следующее:</span><span class="sxs-lookup"><span data-stu-id="64ba1-119">The taskbar includes the following:</span></span>

-   <span data-ttu-id="64ba1-120">Меню " **Пуск** "</span><span class="sxs-lookup"><span data-stu-id="64ba1-120">**Start** menu</span></span>
-   <span data-ttu-id="64ba1-121">Панель быстрого запуска (только для Windows Vista и более ранних версий)</span><span class="sxs-lookup"><span data-stu-id="64ba1-121">Quick Launch bar (Windows Vista and earlier only)</span></span>
-   <span data-ttu-id="64ba1-122">Кнопки панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-122">Taskbar buttons</span></span>
-   <span data-ttu-id="64ba1-123">Панели инструментов (необязательно)</span><span class="sxs-lookup"><span data-stu-id="64ba1-123">Toolbars (optional)</span></span>
-   <span data-ttu-id="64ba1-124">Область "Уведомления"</span><span class="sxs-lookup"><span data-stu-id="64ba1-124">Notification area</span></span>

<span data-ttu-id="64ba1-125">Меню **Пуск** содержит команды, которые могут получать доступ к программам, документам и параметрам.</span><span class="sxs-lookup"><span data-stu-id="64ba1-125">The **Start** menu contains commands that can access programs, documents, and settings.</span></span> <span data-ttu-id="64ba1-126">Эти команды включают в себя **все программы**, **документы**, **Панель управления**, **игры**, **справку и поддержку**, **Завершение работы** и **Поиск программ и файлов**.</span><span class="sxs-lookup"><span data-stu-id="64ba1-126">These commands include **All Programs**, **Documents**, **Control Panel**, **Games**, **Help and Support**, **Shut down**, and **Search programs and files**.</span></span>

<span data-ttu-id="64ba1-127">**Запуск** в более ранних версиях Windows содержал элементы, такие как **Поиск** и **Запуск**, функциональные возможности которых были включены в **программы и файлы поиска** в Windows Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="64ba1-127">The **Start** in earlier versions of Windows contained items such as **Find** and **Run**, the functionality of which was included in **Search programs and files** in Windows Vista and later.</span></span>

<span data-ttu-id="64ba1-128">Панель быстрого запуска, доступная в версиях Windows, предшествующих Windows 7, содержит ярлыки для приложений.</span><span class="sxs-lookup"><span data-stu-id="64ba1-128">The Quick Launch bar, available in versions of Windows earlier than Windows 7, contains shortcuts to applications.</span></span> <span data-ttu-id="64ba1-129">Windows предоставляет записи по умолчанию, такие как Windows Internet Explorer, и пользователь может добавлять любые другие сочетания клавиш, которые они выбирают.</span><span class="sxs-lookup"><span data-stu-id="64ba1-129">Windows provides default entries, such as Windows Internet Explorer, and the user can add any further shortcuts that they choose.</span></span> <span data-ttu-id="64ba1-130">Значки в этой области реагируют на одно нажатие.</span><span class="sxs-lookup"><span data-stu-id="64ba1-130">Icons in this area respond to a single click.</span></span> <span data-ttu-id="64ba1-131">В Windows 7 и более поздних версиях эта функция включена в кнопки панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-131">In Windows 7 and later, this functionality is included in the taskbar buttons.</span></span>

<span data-ttu-id="64ba1-132">Оболочка помещает кнопку на панель задач каждый раз, когда приложение создает несобственное окно, то есть окно, у которого нет родителя и который имеет соответствующие расширенные биты стиля (см. раздел [Управление кнопками панели задач](#managing-taskbar-buttons)ниже).</span><span class="sxs-lookup"><span data-stu-id="64ba1-132">The Shell places a button on the taskbar whenever an application creates an unowned window—that is, a window that does not have a parent and that has the appropriate extended style bits (see [Managing Taskbar Buttons](#managing-taskbar-buttons), below).</span></span> <span data-ttu-id="64ba1-133">Чтобы переключиться на окно, пользователь нажимает кнопку окна.</span><span class="sxs-lookup"><span data-stu-id="64ba1-133">To switch to a window, the user clicks its window button.</span></span> <span data-ttu-id="64ba1-134">Эта функция была значительно расширена на Windows 7.</span><span class="sxs-lookup"><span data-stu-id="64ba1-134">This functionality has been greatly expanded as of Windows 7.</span></span> <span data-ttu-id="64ba1-135">Дополнительные сведения см. в разделе [расширения панели задач](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-135">For more information, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

<span data-ttu-id="64ba1-136">Приложения могут добавлять значки в область уведомлений для указания состояния операции или уведомления пользователя о событии.</span><span class="sxs-lookup"><span data-stu-id="64ba1-136">Applications can put icons in the notification area to indicate the status of an operation or to notify the user about an event.</span></span> <span data-ttu-id="64ba1-137">Например, приложение может разместить значок принтера в области уведомлений, чтобы увидеть, что задание печати выполняется по-разному.</span><span class="sxs-lookup"><span data-stu-id="64ba1-137">For example, an application might put a printer icon in the notification area to show that a print job is under way.</span></span> <span data-ttu-id="64ba1-138">Однако в Windows 7 и более поздних версиях некоторые сведения, ранее предоставляемые областью уведомлений, должны быть предоставлены с помощью кнопки панели задач приложения.</span><span class="sxs-lookup"><span data-stu-id="64ba1-138">However, in Windows 7 and later, some of the information previously provided by the notification area should be provided through an application's taskbar button.</span></span> <span data-ttu-id="64ba1-139">Область уведомлений расположена на правой границе панели задач (если панель задач горизонтально) или внизу (если панель задач вертикально).</span><span class="sxs-lookup"><span data-stu-id="64ba1-139">The notification area is located at the right edge of the taskbar (if the taskbar is horizontal) or at the bottom (if the taskbar is vertical).</span></span> <span data-ttu-id="64ba1-140">Дополнительные сведения см. [в разделе уведомления и область уведомлений](notification-area.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-140">For more information, see [Notifications and the Notification Area](notification-area.md).</span></span>

<span data-ttu-id="64ba1-141">В области уведомлений также отображается текущее время, если выбран этот параметр.</span><span class="sxs-lookup"><span data-stu-id="64ba1-141">The notification area also displays the current time if that option is selected.</span></span> <span data-ttu-id="64ba1-142">Параметр находится в виде:</span><span class="sxs-lookup"><span data-stu-id="64ba1-142">The option is found as:</span></span>

-   <span data-ttu-id="64ba1-143">**Windows 7 и более поздние версии**: раскрывающийся список **часов** на странице " **Включение или отключение системных значков** " окна " **значки области уведомлений** " приложения панели управления (также доступны в свойствах области уведомлений).</span><span class="sxs-lookup"><span data-stu-id="64ba1-143">**Windows 7 and later**: The **Clock** drop-down list in the **Turn system icons on or off** page of the **Notification Area Icons** Control Panel application (also accessible through the notification area properties).</span></span>
-   <span data-ttu-id="64ba1-144">**Windows Vista**: флажок **часов** на странице " **область уведомлений** " окна свойств **панели задач и меню "Пуск** ".</span><span class="sxs-lookup"><span data-stu-id="64ba1-144">**Windows Vista**: The **Clock** check box in the **Notification Area** page of the **Taskbar and Start Menu** properties window.</span></span>
-   <span data-ttu-id="64ba1-145">**Windows XP**: флажок **Отображать часы** на **панели задач и** в окне свойств меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="64ba1-145">**Windows XP**: The **Show the clock** check box in the **Taskbar and Start Menu** properties window.</span></span>

<span data-ttu-id="64ba1-146">Пользователь может щелкнуть правой кнопкой мыши панель задач, чтобы открыть контекстное меню.</span><span class="sxs-lookup"><span data-stu-id="64ba1-146">The user can right-click the taskbar to display the shortcut menu.</span></span> <span data-ttu-id="64ba1-147">Контекстное меню содержит команды для каскадных окон, окон стеков, отображения окон рядом, отображения рабочего стола, запуска диспетчера задач и задания свойств панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-147">The shortcut menu includes commands to cascade windows, stack windows, show windows side-by-side, show the desktop, start Task Manager, and set taskbar properties.</span></span> <span data-ttu-id="64ba1-148">Контекстное меню также предоставляет возможность добавления или удаления набора панелей инструментов на панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-148">The shortcut menu also provides the option to add or remove a set of toolbars from the taskbar.</span></span> <span data-ttu-id="64ba1-149">В это меню можно добавить новые панели инструментов, зарегистрировав их в категории CATID \_ дескбанд.</span><span class="sxs-lookup"><span data-stu-id="64ba1-149">You can add new toolbars to this menu by registering them under the CATID\_DeskBand category.</span></span> <span data-ttu-id="64ba1-150">Дополнительные сведения см. в разделе [Реализация диапазонов объектов](band-objects.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-150">For more information, see [Implementing Band Objects](band-objects.md).</span></span> <span data-ttu-id="64ba1-151">Обратите внимание, что в Windows 7 панель задач и область уведомлений имеют отдельные контекстные меню.</span><span class="sxs-lookup"><span data-stu-id="64ba1-151">Note that as of Windows 7, the taskbar and the notification area have separate shortcut menus.</span></span> <span data-ttu-id="64ba1-152">Эти контекстные меню совместно используют некоторые параметры, например размещение окон и другие.</span><span class="sxs-lookup"><span data-stu-id="64ba1-152">These shortcut menus share some options, such as window arrangement, and add others.</span></span>

### <a name="taskbar-display-options"></a><span data-ttu-id="64ba1-153">Параметры вывода панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-153">Taskbar Display Options</span></span>

<span data-ttu-id="64ba1-154">Панель задач поддерживает два режима отображения: автоматическое скрытие и, в Windows Vista и более ранних версиях, Always On сверху (панель задач всегда находится в этом режиме в Windows 7 и более поздних версиях).</span><span class="sxs-lookup"><span data-stu-id="64ba1-154">The taskbar supports two display options: Auto-Hide and, in Windows Vista and earlier only, Always On Top (the taskbar is always in this mode in Windows 7 and later).</span></span> <span data-ttu-id="64ba1-155">Чтобы задать эти параметры, пользователь должен открыть контекстное меню панели задач, выбрать пункт **Свойства**, установить или снять флажок **автоматически скрывать панель задач** или флажок **Отображать панель задач поверх других окон** .</span><span class="sxs-lookup"><span data-stu-id="64ba1-155">To set these options, the user must open the taskbar shortcut menu, click **Properties**, and select or clear the **Auto-hide the taskbar** check box or the **Keep the taskbar on top of other windows** check box.</span></span> <span data-ttu-id="64ba1-156">Чтобы получить состояние этих параметров отображения, используйте сообщение [**АБМ \_**](abm-getstate.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-156">To retrieve the state of these display options, use the [**ABM\_GETSTATE**](abm-getstate.md) message.</span></span> <span data-ttu-id="64ba1-157">Если вы хотите получать уведомления при изменении состояния этих параметров отображения, обработайте сообщение уведомления [**АБН \_ STATECHANGE**](abn-statechange.md) в процедуре окна.</span><span class="sxs-lookup"><span data-stu-id="64ba1-157">If you would like to be notified when the state of these display options changes, process the [**ABN\_STATECHANGE**](abn-statechange.md) notification message in your window procedure.</span></span> <span data-ttu-id="64ba1-158">Чтобы изменить состояние этих параметров отображения, используйте сообщение [**АБМ \_ SETSTATE**](abm-setstate.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-158">To change the state of these display options, use the [**ABM\_SETSTATE**](abm-setstate.md) message.</span></span>

<span data-ttu-id="64ba1-159">*Рабочая область* — это часть экрана, не скрытая панелью задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-159">The *work area* is the portion of the screen not obscured by the taskbar.</span></span> <span data-ttu-id="64ba1-160">Чтобы получить размер рабочей области, вызовите функцию [**системпараметерсинфо**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) с установленным значением **SPI \_ жетворкареа** .</span><span class="sxs-lookup"><span data-stu-id="64ba1-160">To retrieve the size of the work area, call the [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) function with the **SPI\_GETWORKAREA** value set.</span></span> <span data-ttu-id="64ba1-161">Чтобы получить координаты прямоугольника, описывающие расположение панели задач, используйте сообщение [**АБМ \_ жеттаскбарпос**](abm-gettaskbarpos.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-161">To retrieve the rectangle coordinates that describe the location of the taskbar, use the [**ABM\_GETTASKBARPOS**](abm-gettaskbarpos.md) message.</span></span>

<span data-ttu-id="64ba1-162">Панель задач можно покрыть путем явного задания размера прямоугольника окна, равного размеру экрана с помощью [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span><span class="sxs-lookup"><span data-stu-id="64ba1-162">It is possible to cover the taskbar by explicitly setting the size of the window rectangle equal to the size of the screen with [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span></span> <span data-ttu-id="64ba1-163">Для систем Windows 2000 или более поздней версии в окне не должно быть [**\_ заголовка WS**](../winmsg/window-styles.md) или [**WS \_ сиккфраме**](../winmsg/window-styles.md). Кроме того, размер окна должен быть таким, чтобы клиентская область выделила весь экран.</span><span class="sxs-lookup"><span data-stu-id="64ba1-163">For Windows 2000 systems or later, the window must lack either [**WS\_CAPTION**](../winmsg/window-styles.md) or [**WS\_THICKFRAME**](../winmsg/window-styles.md), or else the window must be sized so that the client area covers the entire screen.</span></span> <span data-ttu-id="64ba1-164">Кроме того, для этих систем, если панель задач имеет значение Always On сверху, она остается скрытой только тогда, когда приложение является приложением переднего плана.</span><span class="sxs-lookup"><span data-stu-id="64ba1-164">Also particular to those systems, if the taskbar is set to Always On Top, it will remain hidden only while the application is the foreground application.</span></span>

### <a name="adding-shortcuts-to-the-start-menu"></a><span data-ttu-id="64ba1-165">Добавление ярлыков в меню "Пуск"</span><span class="sxs-lookup"><span data-stu-id="64ba1-165">Adding Shortcuts to the Start Menu</span></span>

<span data-ttu-id="64ba1-166">Чтобы добавить элемент в подменю **программы** в Microsoft windows NT 4,0, Windows 2000 и более поздней версии или Windows 95 или более поздней версии, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="64ba1-166">To add an item to the **Programs** submenu on Microsoft Windows NT 4.0, Windows 2000 and later, or Windows 95 or later, follow these steps.</span></span>

1.  <span data-ttu-id="64ba1-167">Создайте [ссылку на оболочку](./links.md) с помощью интерфейса [**ишелллинк**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-167">Create a [shell link](./links.md) by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface.</span></span>
2.  <span data-ttu-id="64ba1-168">Получите ПИДЛ папки Programs с помощью [**шжетспеЦиалфолдерлокатион**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), передав [**\_ программы CSid**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-168">Obtain the PIDL of the Programs folder by using [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passing [**CSIDL\_PROGRAMS**](csidl.md).</span></span>
3.  <span data-ttu-id="64ba1-169">Добавьте ссылку оболочки в папку программы.</span><span class="sxs-lookup"><span data-stu-id="64ba1-169">Add the Shell link to the Programs folder.</span></span> <span data-ttu-id="64ba1-170">Можно также создать папку в папке Programs и добавить ссылку в эту папку.</span><span class="sxs-lookup"><span data-stu-id="64ba1-170">You can also create a folder in the Programs folder and add the link to that folder.</span></span>

### <a name="managing-taskbar-buttons"></a><span data-ttu-id="64ba1-171">Управление кнопками панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-171">Managing Taskbar Buttons</span></span>

<span data-ttu-id="64ba1-172">Оболочка создает кнопку на панели задач каждый раз, когда приложение создает окно, которое не владеет.</span><span class="sxs-lookup"><span data-stu-id="64ba1-172">The Shell creates a button on the taskbar whenever an application creates a window that isn't owned.</span></span> <span data-ttu-id="64ba1-173">Чтобы убедиться, что кнопка окна размещена на панели задач, создайте непринадлежащее окно с расширенным стилем [**WS \_ ex \_ аппвиндов**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-173">To ensure that the window button is placed on the taskbar, create an unowned window with the [**WS\_EX\_APPWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="64ba1-174">Чтобы не допустить нажатия кнопки «окно» на панели задач, создайте непринадлежащее окно, используя расширенный стиль панели [**\_ \_ инструментов WS ex**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-174">To prevent the window button from being placed on the taskbar, create the unowned window with the [**WS\_EX\_TOOLWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="64ba1-175">В качестве альтернативы можно создать скрытое окно и сделать это скрытое окно владельцем видимого окна.</span><span class="sxs-lookup"><span data-stu-id="64ba1-175">As an alternative, you can create a hidden window and make this hidden window the owner of your visible window.</span></span>

<span data-ttu-id="64ba1-176">Оболочка удалит кнопку окна с панели задач только в том случае, если стиль окна поддерживает видимые кнопки панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-176">The Shell will remove a window's button from the taskbar only if the window's style supports visible taskbar buttons.</span></span> <span data-ttu-id="64ba1-177">Если требуется динамически изменить стиль окна на тот, который не поддерживает видимые кнопки панели задач, необходимо сначала скрыть окно (вызвав [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) с помощью **\_ скрытого** программного обеспечения), изменить стиль окна, а затем Показать окно.</span><span class="sxs-lookup"><span data-stu-id="64ba1-177">If you want to dynamically change a window's style to one that does not support visible taskbar buttons, you must hide the window first (by calling [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) with **SW\_HIDE**), change the window style, and then show the window.</span></span>

<span data-ttu-id="64ba1-178">Кнопка «окно» обычно содержит значок и заголовок приложения.</span><span class="sxs-lookup"><span data-stu-id="64ba1-178">The window button typically contains the application icon and title.</span></span> <span data-ttu-id="64ba1-179">Однако если приложение не содержит системного меню, кнопка окна создается без значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-179">However, if the application does not contain a system menu, the window button is created without the icon.</span></span>

<span data-ttu-id="64ba1-180">Если вы хотите, чтобы приложение получило внимание пользователя, когда окно не активно, используйте функцию [**FlashWindow интерфейса**](/windows/win32/api/winuser/nf-winuser-flashwindow) , чтобы сообщить пользователю о том, что сообщение находится в состоянии ожидания.</span><span class="sxs-lookup"><span data-stu-id="64ba1-180">If you want your application to get the user's attention when the window is not active, use the [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) function to let the user know that a message is waiting.</span></span> <span data-ttu-id="64ba1-181">Эта функция мигает кнопку окна.</span><span class="sxs-lookup"><span data-stu-id="64ba1-181">This function flashes the window button.</span></span> <span data-ttu-id="64ba1-182">Когда пользователь нажимает кнопку окна для активации окна, приложение может отобразить сообщение.</span><span class="sxs-lookup"><span data-stu-id="64ba1-182">Once the user clicks the window button to activate the window, your application can display the message.</span></span>

### <a name="modifying-the-contents-of-the-taskbar"></a><span data-ttu-id="64ba1-183">Изменение содержимого панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-183">Modifying the Contents of the Taskbar</span></span>

<span data-ttu-id="64ba1-184">В [версии 4,71 и более поздних](versions.md) Shell32.dll добавлена возможность изменения содержимого панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-184">[Version 4.71 and later](versions.md) of Shell32.dll adds the capability to modify the contents of the taskbar.</span></span> <span data-ttu-id="64ba1-185">Из приложения теперь можно добавлять, удалять и активировать кнопки панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-185">From an application, you can now add, remove, and activate taskbar buttons.</span></span> <span data-ttu-id="64ba1-186">Активация элемента не активирует окно. Он показывает, что элемент был нажат на панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-186">Activating the item does not activate the window; it shows the item as pressed on the taskbar.</span></span>

<span data-ttu-id="64ba1-187">Возможности изменения панели задач реализуются в объекте модели COM (CLSID \_ таскбарлист), который предоставляет интерфейс [**ИТАСКБАРЛИСТ**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) (IID \_ итаскбарлист).</span><span class="sxs-lookup"><span data-stu-id="64ba1-187">The taskbar modification capabilities are implemented in a Component Object Model (COM) object (CLSID\_TaskbarList ) that exposes the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface (IID\_ITaskbarList).</span></span> <span data-ttu-id="64ba1-188">Для инициализации объекта необходимо вызвать метод [**итаскбарлист:: хринит**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-188">You must call the [**ITaskbarList::HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) method to initialize the object.</span></span> <span data-ttu-id="64ba1-189">Затем можно использовать методы интерфейса [**итаскбарлист**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) для изменения содержимого панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-189">You can then use the methods of the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface to modify the contents of the taskbar.</span></span>

### <a name="adding-modifying-and-deleting-icons-in-the-notification-area"></a><span data-ttu-id="64ba1-190">Добавление, изменение и удаление значков в области уведомлений</span><span class="sxs-lookup"><span data-stu-id="64ba1-190">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>

<span data-ttu-id="64ba1-191">Используйте функцию [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) для добавления, изменения или удаления значков в области уведомлений.</span><span class="sxs-lookup"><span data-stu-id="64ba1-191">Use the [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) function to add, modify, or delete icons from the notification area.</span></span> <span data-ttu-id="64ba1-192">Параметр *Двмессаже* **оболочки \_ NotifyIcon** — это сообщение на панель задач, в которой указывается выполняемое действие.</span><span class="sxs-lookup"><span data-stu-id="64ba1-192">The *dwMessage* parameter of **Shell\_NotifyIcon** is a message to the taskbar that specifies the action to be taken.</span></span> <span data-ttu-id="64ba1-193">Параметр *пнид* — это указатель на структуру [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) , которая используется для задания значка и передачи дополнительных сведений, необходимых системе для обработки сообщения.</span><span class="sxs-lookup"><span data-stu-id="64ba1-193">The *pnid* parameter is a pointer to a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure that is used to identify the icon and pass any additional information that is needed for the system to process the message.</span></span>

<span data-ttu-id="64ba1-194">С помощью значков области уведомлений можно выполнять следующие действия.</span><span class="sxs-lookup"><span data-stu-id="64ba1-194">You can perform the following actions with notification area icons.</span></span>

-   <span data-ttu-id="64ba1-195">Чтобы добавить значок в область уведомлений панели задач, вызовите [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *двмессаже* , для которого задано значение ним \_ Add.</span><span class="sxs-lookup"><span data-stu-id="64ba1-195">To add an icon to the taskbar's notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_ADD.</span></span> <span data-ttu-id="64ba1-196">Структура [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) используется для указания маркера и идентификатора значка и любого текста подсказки.</span><span class="sxs-lookup"><span data-stu-id="64ba1-196">The [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure is used to specify the icon's handle and identifier, and any tooltip text.</span></span> <span data-ttu-id="64ba1-197">Если пользователь выбрал флажок **Показывать часы** в свойствах панели задач, система поместит значок в ближайшее левое время.</span><span class="sxs-lookup"><span data-stu-id="64ba1-197">If the user has selected the **Show Clock** check box in the taskbar properties, the system places the icon to the immediate left of the clock.</span></span> <span data-ttu-id="64ba1-198">В противном случае значок отображается в правой части или в нижней части панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-198">Otherwise, the icon appears on the right side or at the bottom of the taskbar.</span></span> <span data-ttu-id="64ba1-199">Все существующие значки сдвигаются влево, чтобы освободить место для нового значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-199">Any existing icons are shifted to the left to make room for the new icon.</span></span>
-   <span data-ttu-id="64ba1-200">Чтобы изменить сведения о значке, включая его маркер значка, текст подсказки и идентификатор сообщения обратного вызова, вызовите [**оболочку \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *ДВМЕССАЖЕ* , имеющим значение ним \_ Modify.</span><span class="sxs-lookup"><span data-stu-id="64ba1-200">To modify an icon's information, including its icon handle, tooltip text, and callback message identifier, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_MODIFY.</span></span>
-   <span data-ttu-id="64ba1-201">Чтобы удалить значок из области уведомлений, вызовите [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *двмессаже* , установленным в ним \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="64ba1-201">To delete an icon from the notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_DELETE.</span></span>

<span data-ttu-id="64ba1-202">После выполнения операции с пользовательским интерфейсом верните фокус в область уведомлений, вызвав [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *ДВМЕССАЖЕ* , равным ним \_ SETFOCUS.</span><span class="sxs-lookup"><span data-stu-id="64ba1-202">When you have completed a user interface operation, return focus to the notification area by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_SETFOCUS.</span></span> <span data-ttu-id="64ba1-203">Например, это можно сделать, когда значок панели задач отображает контекстное меню, но пользователь отменяет его нажатием клавиши ESCAPE.</span><span class="sxs-lookup"><span data-stu-id="64ba1-203">For example, you could do this when a taskbar icon displays a shortcut menu, but the user cancels it by pressing the ESCAPE key.</span></span>

### <a name="receiving-notification-area-callback-messages"></a><span data-ttu-id="64ba1-204">Получение сообщений обратного вызова области уведомлений</span><span class="sxs-lookup"><span data-stu-id="64ba1-204">Receiving Notification Area Callback Messages</span></span>

<span data-ttu-id="64ba1-205">Приложения обычно размещают значки в области уведомлений на панели задач, чтобы служить индикаторами состояния.</span><span class="sxs-lookup"><span data-stu-id="64ba1-205">Applications commonly put icons in the notification area of the taskbar to serve as status indicators.</span></span> <span data-ttu-id="64ba1-206">Можно указать дополнительные сведения, когда пользователь выполняет действия мыши, например, наведя указатель мыши на значок или щелкнув значок.</span><span class="sxs-lookup"><span data-stu-id="64ba1-206">You can provide additional information when the user performs mouse actions, such as moving the mouse pointer over the icon or clicking the icon.</span></span>

<span data-ttu-id="64ba1-207">Система уведомляет вас о событиях мыши и клавиатуры, отправляя определяемое приложением сообщение обратного вызова, связанное с определенным значком.</span><span class="sxs-lookup"><span data-stu-id="64ba1-207">The system notifies you of mouse and keyboard events by sending an application-defined callback message that is associated with a particular icon.</span></span> <span data-ttu-id="64ba1-208">Таким образом система может уведомлять приложение, например, когда пользователь щелкает значок или выбирает его, нажимая клавишу.</span><span class="sxs-lookup"><span data-stu-id="64ba1-208">In this way, the system can notify an application when the user, for instance, clicks the icon or selects it by pressing a key.</span></span>

<span data-ttu-id="64ba1-209">При добавлении значка на панель задач вы определяете сообщение обратного вызова значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-209">You define an icon's callback message when you add the icon to the taskbar.</span></span> <span data-ttu-id="64ba1-210">Идентификатор сообщения обратного вызова задается в элементе **укаллбаккмессаже** структуры [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) , передаваемой вместе с ним \_ Add.</span><span class="sxs-lookup"><span data-stu-id="64ba1-210">The callback message identifier is specified in the **uCallbackMessage** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure passed with NIM\_ADD.</span></span> <span data-ttu-id="64ba1-211">При возникновении события система отправляет сообщение обратного вызова в процедуру окна окна, заданную элементом **HWND** .</span><span class="sxs-lookup"><span data-stu-id="64ba1-211">When an event occurs, the system sends the callback message to the window procedure of the window specified by the **hWnd** member.</span></span> <span data-ttu-id="64ba1-212">Параметр *wParam* сообщения содержит идентификатор значка панели задач, в котором произошло событие.</span><span class="sxs-lookup"><span data-stu-id="64ba1-212">The *wParam* parameter of the message contains the identifier of the taskbar icon in which the event occurred.</span></span> <span data-ttu-id="64ba1-213">Параметр *lParam* содержит сообщение мыши или клавиатуры, связанное с событием.</span><span class="sxs-lookup"><span data-stu-id="64ba1-213">The *lParam* parameter holds the mouse or keyboard message associated with the event.</span></span> <span data-ttu-id="64ba1-214">Например, когда указатель мыши перемещается на значок панели задач, параметр *lParam* содержит [**WM \_ MOUSEMOVE**](../inputdev/wm-mousemove.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-214">For example, when the mouse pointer moves onto a taskbar icon, *lParam* contains [**WM\_MOUSEMOVE**](../inputdev/wm-mousemove.md).</span></span>

<span data-ttu-id="64ba1-215">Результаты различных событий мыши можно суммировать следующим образом:</span><span class="sxs-lookup"><span data-stu-id="64ba1-215">The results of various mouse events can be summarized as follows:</span></span>

-   <span data-ttu-id="64ba1-216">Когда пользователь наводит указатель мыши на значок, система отображает текст подсказки, указанный в [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span><span class="sxs-lookup"><span data-stu-id="64ba1-216">When the user moves the mouse pointer over the icon, the system displays the tooltip text that was specified in [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span></span>
-   <span data-ttu-id="64ba1-217">Когда пользователь щелкает значок, приложение получает уведомление [**WM \_ лбуттондовн**](../inputdev/wm-lbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-217">When the user clicks the icon, your application receives a [**WM\_LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) notification.</span></span>
-   <span data-ttu-id="64ba1-218">Когда пользователь щелкает значок правой кнопкой мыши, приложение получает уведомление [**WM \_ рбуттондовн**](../inputdev/wm-rbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-218">When the user right-clicks the icon, your application receives a [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) notification.</span></span>
-   <span data-ttu-id="64ba1-219">Когда пользователь дважды щелкает значок, приложение получает уведомление [**WM \_ лбуттондблклк**](../inputdev/wm-lbuttondblclk.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-219">When the user double-clicks the icon, your application receives a [**WM\_LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) notification.</span></span>

<span data-ttu-id="64ba1-220">Как правило, при щелчке значка приложение отображает окно с дополнительными сведениями, при щелчке правой кнопкой мыши открывается контекстное меню, а при двойном щелчке выполняется команда контекстного меню по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="64ba1-220">Typically, clicking the icon causes the application to display a window with additional information, right-clicking displays a shortcut menu, and double-clicking executes the default shortcut menu command.</span></span>

<span data-ttu-id="64ba1-221">Пример изменения текста подсказки, связанного со значком области уведомлений, см. в разделе всплывающие [подсказки для значков строки состояния](../controls/tooltip-controls.md).</span><span class="sxs-lookup"><span data-stu-id="64ba1-221">For an example of how to change the tooltip text associated with a notification area icon, see [Balloon Tooltips for Status Bar Icons](../controls/tooltip-controls.md).</span></span>

<span data-ttu-id="64ba1-222">Версии 5,0 и более поздних версий оболочки обрабатывали события мыши и клавиатуры [**\_ NotifyIcon в оболочке**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) , отличающиеся от более ранних версий оболочки, находящихся в Windows NT 4,0, Windows 95 и Windows 98.</span><span class="sxs-lookup"><span data-stu-id="64ba1-222">Versions 5.0 and later of the Shell handle [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) mouse and keyboard events in different ways than earlier Shell versions found on Windows NT 4.0, Windows 95, and Windows 98.</span></span> <span data-ttu-id="64ba1-223">Различия заключаются в следующем.</span><span class="sxs-lookup"><span data-stu-id="64ba1-223">The differences are as follows:</span></span>

-   <span data-ttu-id="64ba1-224">Если пользователь запрашивает контекстное меню значка уведомления с помощью клавиатуры, оболочка версии 5,0 отправляет связанное приложение в сообщение [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-224">If a user requests a notify icon's shortcut menu with the keyboard, the version 5.0 Shell sends the associated application a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message.</span></span> <span data-ttu-id="64ba1-225">Более ранние версии отправляют сообщения [**WM \_ Рбуттондовн**](../inputdev/wm-rbuttondown.md) и [**WM \_ рбуттонуп**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-225">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="64ba1-226">Если пользователь выбирает значок уведомления с помощью клавиатуры и активирует его с помощью пробела или клавиши ВВОД, оболочка версии 5,0 отправляет связанное приложение в уведомление **NIN \_ кэйселект** .</span><span class="sxs-lookup"><span data-stu-id="64ba1-226">If a user selects a notify icon with the keyboard and activates it with the space bar or ENTER key, the version 5.0 Shell sends the associated application an **NIN\_KEYSELECT** notification.</span></span> <span data-ttu-id="64ba1-227">Более ранние версии отправляют сообщения [**WM \_ Рбуттондовн**](../inputdev/wm-rbuttondown.md) и [**WM \_ рбуттонуп**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-227">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="64ba1-228">Если пользователь выбирает значок уведомления с помощью мыши и активирует его с помощью клавиши ВВОД, оболочка версии 5,0 отправляет связанное приложение в NIN-уведомление **\_ SELECT** .</span><span class="sxs-lookup"><span data-stu-id="64ba1-228">If a user selects a notify icon with the mouse and activates it with the ENTER key, the version 5.0 Shell sends the associated application an **NIN\_SELECT** notification.</span></span> <span data-ttu-id="64ba1-229">Более ранние версии отправляют сообщения [**WM \_ Рбуттондовн**](../inputdev/wm-rbuttondown.md) и [**WM \_ рбуттонуп**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="64ba1-229">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="64ba1-230">Если пользователь передает указатель мыши по значку, с которым связана всплывающая подсказка, оболочка версии 6,0 (Windows XP) отправляет следующие сообщения.</span><span class="sxs-lookup"><span data-stu-id="64ba1-230">If a user passes the mouse pointer over an icon with which a balloon tooltip is associated, the version 6.0 Shell (Windows XP)sends the following messages.</span></span>
    -   -   <span data-ttu-id="64ba1-231">**NIN \_ БАЛЛУНШОВ** — отправляется при отображении всплывающего окна (в очереди выноски).</span><span class="sxs-lookup"><span data-stu-id="64ba1-231">**NIN\_BALLOONSHOW** - Sent when the balloon is shown (balloons are queued).</span></span>
        -   <span data-ttu-id="64ba1-232">**NIN \_ БАЛЛУНХИДЕ** — отправляется, когда всплывающее сообщение исчезает, например, при удалении значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-232">**NIN\_BALLOONHIDE** - Sent when the balloon disappears—for example, when the icon is deleted.</span></span> <span data-ttu-id="64ba1-233">Это сообщение не отправляется, если всплывающее уведомление отклонено из-за времени ожидания или щелчка мышью.</span><span class="sxs-lookup"><span data-stu-id="64ba1-233">This message is not sent if the balloon is dismissed because of a timeout or a mouse click.</span></span>
        -   <span data-ttu-id="64ba1-234">**NIN \_ БАЛЛУНТИМЕАУТ** — отправляется, когда всплывающее сообщение отклонено из-за истечения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="64ba1-234">**NIN\_BALLOONTIMEOUT** - Sent when the balloon is dismissed because of a timeout.</span></span>
        -   <span data-ttu-id="64ba1-235">**NIN \_ БАЛЛУНУСЕРКЛИКК** — отправляется, когда всплывающее сообщение закрывается из-за щелчка мыши.</span><span class="sxs-lookup"><span data-stu-id="64ba1-235">**NIN\_BALLOONUSERCLICK** - Sent when the balloon is dismissed because of a mouse click.</span></span>

<span data-ttu-id="64ba1-236">Вы можете выбрать, каким образом оболочка должна вести себя, вызвав [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *Двмессаже* , равным **ним \_ сетверсион**.</span><span class="sxs-lookup"><span data-stu-id="64ba1-236">You can select which way the Shell should behave by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_SETVERSION**.</span></span> <span data-ttu-id="64ba1-237">Задайте элемент **уверсион** структуры [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) , чтобы указать, требуется ли поведение версии 5,0 или до версии 5,0.</span><span class="sxs-lookup"><span data-stu-id="64ba1-237">Set the **uVersion** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure to indicate whether you want version 5.0 or pre-version 5.0 behavior.</span></span>

### <a name="taskbar-creation-notification"></a><span data-ttu-id="64ba1-238">Уведомление о создании панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-238">Taskbar Creation Notification</span></span>

<span data-ttu-id="64ba1-239">В Microsoft Internet Explorer 4,0 и более поздних версиях оболочка уведомляет приложения о том, что панель задач создана.</span><span class="sxs-lookup"><span data-stu-id="64ba1-239">With Microsoft Internet Explorer 4.0 and later, the Shell notifies applications that the taskbar has been created.</span></span> <span data-ttu-id="64ba1-240">При создании панели задач она регистрирует сообщение со строкой Таскбаркреатед, а затем передает это сообщение всем окнам верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="64ba1-240">When the taskbar is created, it registers a message with the TaskbarCreated string and then broadcasts this message to all top-level windows.</span></span> <span data-ttu-id="64ba1-241">Когда приложение панели задач получает это сообщение, следует предположить, что все добавленные значки панели задач были удалены и снова добавить их.</span><span class="sxs-lookup"><span data-stu-id="64ba1-241">When your taskbar application receives this message, it should assume that any taskbar icons it added have been removed and add them again.</span></span> <span data-ttu-id="64ba1-242">Эта функция обычно применяется только к службам, которые уже запущены при запуске оболочки.</span><span class="sxs-lookup"><span data-stu-id="64ba1-242">This feature generally applies only to services that are already running when the Shell launches.</span></span> <span data-ttu-id="64ba1-243">В следующем примере показан очень упрощенный метод обработки этого случая.</span><span class="sxs-lookup"><span data-stu-id="64ba1-243">The following example shows a very simplified method for handling this case.</span></span>

<span data-ttu-id="64ba1-244">В Windows 10 панель задач также выполняет широковещательную рассылку этого сообщения при изменении DPI основного экрана.</span><span class="sxs-lookup"><span data-stu-id="64ba1-244">On Windows 10, the taskbar also broadcasts this message when the DPI of the primary display changes.</span></span>

```
LRESULT CALLBACK WndProc(HWND hWnd, 
                         UINT uMessage, 
                         WPARAM wParam, 
                         LPARAM lParam)
{
    static UINT s_uTaskbarRestart;

    switch(uMessage)
    {
        case WM_CREATE:
            s_uTaskbarRestart = RegisterWindowMessage(TEXT("TaskbarCreated"));
            break;
        
        default:
            if(uMessage == s_uTaskbarRestart)
                AddTaskbarIcons();
            break;
    }

    return DefWindowProc(hWnd, uMessage, wParam, lParam);
}
```



## <a name="using-the-taskbar"></a><span data-ttu-id="64ba1-245">Использование панели задач</span><span class="sxs-lookup"><span data-stu-id="64ba1-245">Using the Taskbar</span></span>

<span data-ttu-id="64ba1-246">Этот раздел содержит примеры, демонстрирующие Добавление значков в область уведомлений панели задач и обработку сообщений обратного вызова для значков панели задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-246">This section includes examples that demonstrate how to add icons to the taskbar notification area and how to process callback messages for taskbar icons.</span></span>

### <a name="adding-and-deleting-taskbar-icons-in-the-notification-area"></a><span data-ttu-id="64ba1-247">Добавление и удаление значков панели задач в области уведомлений</span><span class="sxs-lookup"><span data-stu-id="64ba1-247">Adding and Deleting Taskbar Icons in the Notification Area</span></span>

<span data-ttu-id="64ba1-248">Вы добавляете значок в область уведомлений панели задач, заполняя структуру [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) , а затем передаем структуру в [**оболочку \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *двмессаже* , имеющим значение **ним \_ Add**.</span><span class="sxs-lookup"><span data-stu-id="64ba1-248">You add an icon to the taskbar notification area by filling in a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and then passing the structure to [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_ADD**.</span></span> <span data-ttu-id="64ba1-249">Члены структуры должны указывать маркер для окна, которое добавляет значок, а также идентификатор значка и маркер значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-249">The structure members must specify the handle to the window that is adding the icon, as well as the icon identifier and icon handle.</span></span> <span data-ttu-id="64ba1-250">Можно также указать текст подсказки для значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-250">You can also specify tooltip text for the icon.</span></span> <span data-ttu-id="64ba1-251">Если необходимо получать сообщения мыши для значка, укажите идентификатор сообщения обратного вызова, который система должна использовать для отправки сообщения в процедуру окна.</span><span class="sxs-lookup"><span data-stu-id="64ba1-251">If you need to receive mouse messages for the icon, specify the identifier of the callback message that the system should use to send the message to the window procedure.</span></span>

<span data-ttu-id="64ba1-252">Функция в следующем примере демонстрирует добавление значка на панель задач.</span><span class="sxs-lookup"><span data-stu-id="64ba1-252">The function in the following example demonstrates how to add an icon to the taskbar.</span></span>


```
// MyTaskBarAddIcon - adds an icon to the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window to receive callback messages 
// uID - identifier of the icon 
// hicon - handle to the icon to add 
// lpszTip - tooltip text 

BOOL MyTaskBarAddIcon(HWND hwnd, UINT uID, HICON hicon, LPSTR lpszTip) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
    tnid.uFlags = NIF_MESSAGE | NIF_ICON | NIF_TIP; 
    tnid.uCallbackMessage = MYWM_NOTIFYICON; 
    tnid.hIcon = hicon; 
    if (lpszTip) 
        hr = StringCbCopyN(tnid.szTip, sizeof(tnid.szTip), lpszTip, 
                           sizeof(tnid.szTip));
        // TODO: Add error handling for the HRESULT.
    else 
        tnid.szTip[0] = (TCHAR)'\0'; 
 
    res = Shell_NotifyIcon(NIM_ADD, &tnid); 
 
    if (hicon) 
        DestroyIcon(hicon); 
 
    return res; 
}
```



<span data-ttu-id="64ba1-253">Чтобы удалить значок из области уведомлений панели задач, заполните структуру [**нотификондата**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) и вызовите [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) с параметром *двмессаже* , имеющим значение **ним \_ Delete**.</span><span class="sxs-lookup"><span data-stu-id="64ba1-253">To delete an icon from the taskbar notification area, fill a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_DELETE**.</span></span> <span data-ttu-id="64ba1-254">При удалении значка панели задач укажите только элементы **кбсизе**, **HWND** и **UID** структуры.</span><span class="sxs-lookup"><span data-stu-id="64ba1-254">When deleting a taskbar icon, specify only the **cbSize**, **hWnd**, and **uID** members of the structure.</span></span> <span data-ttu-id="64ba1-255">Например:</span><span class="sxs-lookup"><span data-stu-id="64ba1-255">For example:</span></span>


```
// MyTaskBarDeleteIcon - deletes an icon from the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window that added the icon. 
// uID - identifier of the icon to delete. 

BOOL MyTaskBarDeleteIcon(HWND hwnd, UINT uID) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
         
    res = Shell_NotifyIcon(NIM_DELETE, &tnid); 
    return res; 
}
```



### <a name="receiving-mouse-events"></a><span data-ttu-id="64ba1-256">Получение событий мыши</span><span class="sxs-lookup"><span data-stu-id="64ba1-256">Receiving Mouse Events</span></span>

<span data-ttu-id="64ba1-257">При указании сообщения обратного вызова для значка панели задач система отправляет сообщение в приложение при каждом возникновении события мыши в ограничивающем прямоугольнике значка.</span><span class="sxs-lookup"><span data-stu-id="64ba1-257">If you specify a callback message for a taskbar icon, the system sends the message to your application whenever a mouse event occurs in the icon's bounding rectangle.</span></span> <span data-ttu-id="64ba1-258">Параметр *wParam* сообщения указывает идентификатор значка панели задач, а параметр *lParam* сообщения указывает сообщение, формируемое системой в результате события мыши.</span><span class="sxs-lookup"><span data-stu-id="64ba1-258">The *wParam* parameter of the message specifies the identifier of the taskbar icon, and the *lParam* parameter of the message specifies the message that the system generated as a result of the mouse event.</span></span>

<span data-ttu-id="64ba1-259">Функция в следующем примере состоит из приложения, добавляющего на панель задач как батарею, так и значок принтера.</span><span class="sxs-lookup"><span data-stu-id="64ba1-259">The function in the following example is from an application that adds both battery and printer icons to the taskbar.</span></span> <span data-ttu-id="64ba1-260">Приложение вызывает функцию при получении сообщения обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="64ba1-260">The application calls the function when it receives a callback message.</span></span> <span data-ttu-id="64ba1-261">Функция определяет, щелкнул ли пользователь один из значков. при возникновении щелчка вызывает определяемую приложением функцию для вывода сведений о состоянии.</span><span class="sxs-lookup"><span data-stu-id="64ba1-261">The function determines whether the user has clicked one of the icons and, if a click has occurred, calls an application-defined function to display status information.</span></span>


```
// On_MYWM_NOTIFYICON - processes callback messages for taskbar icons. 
// wParam - first message parameter of the callback message. 
// lParam - second message parameter of the callback message. 

void On_MYWM_NOTIFYICON(WPARAM wParam, LPARAM lParam) 
{ 
    UINT uID; 
    UINT uMouseMsg; 
 
    uID = (UINT) wParam; 
    uMouseMsg = (UINT) lParam; 
 
    if (uMouseMsg == WM_LBUTTONDOWN) 
    { 
        switch (uID) 
        { 
            case IDI_MYBATTERYICON: 
 
                // The user clicked the battery icon. Display the 
                // battery status. 
                ShowBatteryStatus(); 
                break; 
 
            case IDI_MYPRINTERICON: 
 
                // The user clicked the printer icon. Display the 
                // status of the print job. 
                ShowJobStatus(); 
                break; 
 
            default: 
                break; 
        } 
     } 

     return; 
 }
```



 

 
