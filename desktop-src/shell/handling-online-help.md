---
description: Справка в Интернете может находиться в различных формах, от подробной концептуальной информации до быстрых определений. В этом разделе содержатся следующие подразделы.
title: Обработка справки в Интернете
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 2a3f6034-6ba6-4204-a2e1-59995fbf40fe
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: f1c125df135068c2eee37cb33a8a9d2b281b1f83
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104997715"
---
# <a name="handling-online-help"></a><span data-ttu-id="3e90c-104">Обработка справки в Интернете</span><span class="sxs-lookup"><span data-stu-id="3e90c-104">Handling Online Help</span></span>

<span data-ttu-id="3e90c-105">Справка в Интернете может находиться в различных формах, от подробной концептуальной информации до быстрых определений.</span><span class="sxs-lookup"><span data-stu-id="3e90c-105">Online help can come in a variety of forms, from detailed conceptual information to quick definitions.</span></span> <span data-ttu-id="3e90c-106">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="3e90c-106">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="3e90c-107">Сведения о справке</span><span class="sxs-lookup"><span data-stu-id="3e90c-107">About Help</span></span>](#about-help)
    -   [<span data-ttu-id="3e90c-108">Запросы справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-108">Help Requests</span></span>](#help-requests)
    -   [<span data-ttu-id="3e90c-109">Окно справки и Справка Windows</span><span class="sxs-lookup"><span data-stu-id="3e90c-109">Help Display and Windows Help</span></span>](#help-display-and-windows-help)
-   [<span data-ttu-id="3e90c-110">Использование справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-110">Using Help</span></span>](#using-help)
    -   [<span data-ttu-id="3e90c-111">Предоставление справки в диалоговом окне</span><span class="sxs-lookup"><span data-stu-id="3e90c-111">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
    -   [<span data-ttu-id="3e90c-112">Настройка внешнего вида дополнительного окна справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-112">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

## <a name="about-help"></a><span data-ttu-id="3e90c-113">Сведения о справке</span><span class="sxs-lookup"><span data-stu-id="3e90c-113">About Help</span></span>

<span data-ttu-id="3e90c-114">Важный элемент ориентированного на пользователя приложения можно легко получить в интерактивной справке.</span><span class="sxs-lookup"><span data-stu-id="3e90c-114">An important element of a user-friendly application is readily available in online help.</span></span> <span data-ttu-id="3e90c-115">Windows предоставляет функции и сообщения, которые при использовании в сочетании с приложением Windows Help упрощают реализацию интерактивной справки в приложении.</span><span class="sxs-lookup"><span data-stu-id="3e90c-115">Windows provides functions and messages that, when used in conjunction with the Windows Help application, make it easy to implement online help in your application.</span></span> <span data-ttu-id="3e90c-116">В этом обзоре обсуждаются элементы Windows, которые поддерживают справку в Интернете.</span><span class="sxs-lookup"><span data-stu-id="3e90c-116">This overview discusses the elements of Windows that support online help.</span></span> <span data-ttu-id="3e90c-117">В нем описывается использование этих элементов для предоставления пользователям средств для запроса справки и объясняется, как использовать Справочное приложение Windows для отображения справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-117">It describes how to use these elements to give users a means to request help, and it explains how to use the Windows Help application to display help.</span></span>

### <a name="help-requests"></a><span data-ttu-id="3e90c-118">Запросы справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-118">Help Requests</span></span>

<span data-ttu-id="3e90c-119">Большинство приложений на основе Windows предоставляют справочную информацию в различных формах, от концептуальной справки, которая объясняет назначение функций приложения всплывающей справке, которая предоставляет быстрые определения отдельных элементов в пользовательском интерфейсе приложения.</span><span class="sxs-lookup"><span data-stu-id="3e90c-119">Most Windows-based applications provide online help information in a variety of forms, ranging from conceptual help that explains the purpose of an application's features to pop-up help that provides quick definitions of individual elements in the application's user interface.</span></span> <span data-ttu-id="3e90c-120">Функции и сообщения используются для предоставления пользователям различных способов запроса доступа к этой информации.</span><span class="sxs-lookup"><span data-stu-id="3e90c-120">You use functions and messages to give users a variety of ways to request access to this information.</span></span> <span data-ttu-id="3e90c-121">В следующих разделах описываются эти запросы на помощь.</span><span class="sxs-lookup"><span data-stu-id="3e90c-121">The following sections describe these help requests.</span></span>

### <a name="help-menu"></a><span data-ttu-id="3e90c-122">Меню "Справка"</span><span class="sxs-lookup"><span data-stu-id="3e90c-122">Help menu</span></span>

<span data-ttu-id="3e90c-123">Большинство приложений предоставляют пользователям доступ к справочной информации, включая меню **справки** в главном окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-123">Most applications provide user access to help information by including a **Help** menu in the main window.</span></span> <span data-ttu-id="3e90c-124">Когда пользователь выбирает элемент из меню **справки** , соответствующая процедура окна получает сообщение [**\_ командной строки WM**](../menurc/wm-command.md) , идентифицирующее выбранный элемент.</span><span class="sxs-lookup"><span data-stu-id="3e90c-124">When the user selects an item from a **Help** menu, the corresponding window procedure receives a [**WM\_COMMAND**](../menurc/wm-command.md) message that identifies the selected item.</span></span> <span data-ttu-id="3e90c-125">Приложение отвечает, отображая соответствующую справочную информацию, например список разделов справки, индекс или введение в приложение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-125">The application responds by displaying the appropriate help information, such as a list of help topics, an index, or an introduction to the application.</span></span>

### <a name="help-from-the-keyboard"></a><span data-ttu-id="3e90c-126">Справка с клавиатуры</span><span class="sxs-lookup"><span data-stu-id="3e90c-126">Help from the keyboard</span></span>

<span data-ttu-id="3e90c-127">Windows предоставляет пользователю доступ к справочной информации с клавиатуры, уведомляя приложение каждый раз, когда пользователь нажимает клавишу F1.</span><span class="sxs-lookup"><span data-stu-id="3e90c-127">Windows provides user access to help information from the keyboard by notifying the application whenever the user presses the F1 key.</span></span> <span data-ttu-id="3e90c-128">Система отправляет [**\_ справочное сообщение WM**](wm-help.md) в окно с фокусом клавиатуры при нажатии пользователем клавиши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-128">The system sends a [**WM\_HELP**](wm-help.md) message to the window that had the keyboard focus when the user pressed the key.</span></span> <span data-ttu-id="3e90c-129">Если окно является дочерним окном (например, элементом управления в диалоговом окне), функция [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) передает сообщение родительскому окну.</span><span class="sxs-lookup"><span data-stu-id="3e90c-129">If the window is a child window (for example, a control in a dialog box), the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="3e90c-130">Если меню активно при нажатии клавиши F1, система отправляет сообщение в окно, связанное с меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-130">If a menu is active when F1 is pressed, the system sends the message to the window associated with the menu.</span></span> <span data-ttu-id="3e90c-131">Приложение отвечает, отображая справочные сведения, связанные с окном, элементом управления или меню, имеющим фокус или активным.</span><span class="sxs-lookup"><span data-stu-id="3e90c-131">The application responds by displaying help information associated with the window, control, or menu that has the focus or is active.</span></span> <span data-ttu-id="3e90c-132">Например, если пользователь выбирает элемент управления в диалоговом окне и нажимает клавишу F1, приложение отображает справочные сведения для этого элемента управления.</span><span class="sxs-lookup"><span data-stu-id="3e90c-132">For example, if the user selects a control in a dialog box and presses F1, the application displays help information for that control.</span></span>

<span data-ttu-id="3e90c-133">Параметр *lParam* [**\_ справки WM**](wm-help.md) — это указатель на структуру [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) , содержащую подробные сведения об элементе, для которого запрашивается справка.</span><span class="sxs-lookup"><span data-stu-id="3e90c-133">The *lParam* parameter of [**WM\_HELP**](wm-help.md) is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested.</span></span> <span data-ttu-id="3e90c-134">Эти сведения используются для определения отображаемого раздела справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-134">You use this information to determine the help topic to display.</span></span> <span data-ttu-id="3e90c-135">Структура **HELPINFO** также включает координаты курсора мыши во время нажатия пользователем клавиши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-135">The **HELPINFO** structure also includes the coordinates of the mouse cursor at the time the user pressed the key.</span></span> <span data-ttu-id="3e90c-136">Эти сведения можно использовать для предоставления справки в зависимости от положения курсора мыши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-136">You can use this information to provide help based on the location of the mouse cursor.</span></span>

### <a name="help-from-the-mouse"></a><span data-ttu-id="3e90c-137">Помощь от мыши</span><span class="sxs-lookup"><span data-stu-id="3e90c-137">Help from the mouse</span></span>

<span data-ttu-id="3e90c-138">Windows предоставляет пользователю доступ к справочной информации от мыши, уведомляя приложение каждый раз, когда пользователь нажимает правую кнопку мыши или щелкает окно, элемент управления или меню после нажатия кнопки вопроса (?).</span><span class="sxs-lookup"><span data-stu-id="3e90c-138">Windows provides the user access to help information from the mouse by notifying the application whenever the user clicks the right mouse button or clicks a window, control, or menu after clicking the Question (?) button.</span></span> <span data-ttu-id="3e90c-139">Приложение отвечает, отображая справочную информацию, связанную с данным окном, элементом управления или меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-139">The application responds by displaying help information associated with the given window, control, or menu.</span></span>

<span data-ttu-id="3e90c-140">Система отправляет сообщение [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) , когда пользователь нажимает правую кнопку мыши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-140">The system sends a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message when the user clicks the right mouse button.</span></span> <span data-ttu-id="3e90c-141">Окно, которое было выбрано, получает сообщение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-141">The window that was clicked receives the message.</span></span> <span data-ttu-id="3e90c-142">Если окно является дочерним окном, например элементом управления, функция [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) передает сообщение родительскому окну.</span><span class="sxs-lookup"><span data-stu-id="3e90c-142">If the window is a child window, such as a control, the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="3e90c-143">Сообщение **WM \_ CONTEXTMENU** указывает координаты курсора мыши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-143">The **WM\_CONTEXTMENU** message specifies the coordinates of the mouse cursor.</span></span> <span data-ttu-id="3e90c-144">Координата x находится в младшем слове параметра *lParam* , а координата y — в слове высокого порядка.</span><span class="sxs-lookup"><span data-stu-id="3e90c-144">The x-coordinate is in the low-order word of the *lParam* parameter, and the y-coordinate is in the high-order word.</span></span> <span data-ttu-id="3e90c-145">Если пользователь щелкнул элемент управления, параметр *wParam* является маркером элемента управления, получившего щелчок.</span><span class="sxs-lookup"><span data-stu-id="3e90c-145">If the user clicked a control, the *wParam* parameter is the handle to the control that received the click.</span></span>

<span data-ttu-id="3e90c-146">Система отправляет сообщение [**\_ справки WM**](wm-help.md) , когда пользователь щелкает элемент в окне после нажатия кнопки вопроса (?), которая отображается в строке заголовка окна.</span><span class="sxs-lookup"><span data-stu-id="3e90c-146">The system sends a [**WM\_HELP**](wm-help.md) message when the user clicks an item in a window after clicking the Question (?) button that appears in the title bar of the window.</span></span> <span data-ttu-id="3e90c-147">Можно добавить кнопку вопроса в строку заголовка, указав стиль **WS \_ ex \_ Контексселп** в функции [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) при создании окна.</span><span class="sxs-lookup"><span data-stu-id="3e90c-147">You can add a Question button to a title bar by specifying the **WS\_EX\_CONTEXTHELP** style in the [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) function when creating the window.</span></span> <span data-ttu-id="3e90c-148">Параметр *lParam* **\_ справки WM** является указателем на структуру [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) , которая содержит подробные сведения об элементе, для которого запрашивается справка, включая координаты курсора мыши во время нажатия пользователем кнопки мыши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-148">The *lParam* parameter of **WM\_HELP** is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested, including the coordinates of the mouse cursor at the time the user clicked the mouse button.</span></span>

<span data-ttu-id="3e90c-149">Кнопка вопроса рекомендуется для использования только в диалоговых окнах.</span><span class="sxs-lookup"><span data-stu-id="3e90c-149">The Question button is recommended for use in dialog boxes only.</span></span> <span data-ttu-id="3e90c-150">В прошлом приложения предоставили пользователю доступ к справочной информации о диалоговом окне, выполнив в диалоговом окне кнопку « **Справка** ».</span><span class="sxs-lookup"><span data-stu-id="3e90c-150">In the past, applications have provided user access to help information about a dialog box by providing a **Help** button in the dialog box.</span></span> <span data-ttu-id="3e90c-151">Этот метод больше не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="3e90c-151">This method is no longer recommended.</span></span> <span data-ttu-id="3e90c-152">Вместо нее используйте кнопку "вопрос".</span><span class="sxs-lookup"><span data-stu-id="3e90c-152">Use the Question button instead.</span></span>

### <a name="help-display-and-windows-help"></a><span data-ttu-id="3e90c-153">Окно справки и Справка Windows</span><span class="sxs-lookup"><span data-stu-id="3e90c-153">Help Display and Windows Help</span></span>

<span data-ttu-id="3e90c-154">Когда приложение получает запрос на получение справки, оно должно отобразить соответствующую справочную информацию.</span><span class="sxs-lookup"><span data-stu-id="3e90c-154">Once an application receives a request for help, it should display the appropriate help information.</span></span> <span data-ttu-id="3e90c-155">Поскольку приложение Windows Help предоставляет единообразный пользовательский интерфейс, рекомендуется, чтобы приложения использовали справку Windows, а не другие методы.</span><span class="sxs-lookup"><span data-stu-id="3e90c-155">Because the Windows Help application supplies a consistent user interface, it is recommended that applications use Windows Help rather than other methods.</span></span> <span data-ttu-id="3e90c-156">Чтобы в справке Windows отображалась справочная информация, приложение использует функцию [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , указывая такие сведения, как отображаемые сведения, и форму окна, в котором она отображается.</span><span class="sxs-lookup"><span data-stu-id="3e90c-156">To direct Windows Help to display help information, an application uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, specifying details such as the information to display and the form of the window in which to display it.</span></span> <span data-ttu-id="3e90c-157">В следующих разделах объясняется, как использовать **WinHelp** для отображения справочных сведений.</span><span class="sxs-lookup"><span data-stu-id="3e90c-157">The following sections explain how to use **WinHelp** to display help information.</span></span>

### <a name="help-files"></a><span data-ttu-id="3e90c-158">файлы справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-158">Help files</span></span>

<span data-ttu-id="3e90c-159">Для просмотра справочных сведений необходимо указать файл справки при вызове функции [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-159">To view help information, you must specify a help file when calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="3e90c-160">Файл справки должен иметь формат файла справки Windows (. hlp) и один или несколько разделов.</span><span class="sxs-lookup"><span data-stu-id="3e90c-160">The help file must have the Windows Help (.hlp) file format and one or more topics.</span></span> <span data-ttu-id="3e90c-161">Каждый раздел представляет собой отдельную единицу информации, например концептуальное описание, набор инструкций, рисунок, Определение глоссария и т. д.</span><span class="sxs-lookup"><span data-stu-id="3e90c-161">Each topic is a distinct unit of information, such as a conceptual description, a set of instructions, a picture, a glossary definition, and so on.</span></span> <span data-ttu-id="3e90c-162">Темы должны быть однозначно идентифицированы, чтобы Справка Windows могла найти их при запросе.</span><span class="sxs-lookup"><span data-stu-id="3e90c-162">Topics must be uniquely identified so that Windows Help can locate them whenever they are requested.</span></span> <span data-ttu-id="3e90c-163">На внутреннем уровне в справке Windows используются идентификаторы разделов для назначений разделов, но в приложениях чаще всего используются идентификаторы контекста (уникальные целочисленные значения) для указания разделов для вывода.</span><span class="sxs-lookup"><span data-stu-id="3e90c-163">Internally, Windows Help uses topic identifiers to locate topics, but applications most often use context identifiers (unique integer values) to specify the topics to display.</span></span> <span data-ttu-id="3e90c-164">Автор файла справки должен явным образом сопоставлять идентификаторы контекста с идентификаторами разделов в \[ разделе Map \] файла проекта, который используется для построения файла справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-164">The help file author must explicitly map context identifiers to topic identifiers in the \[MAP\] section of the project file used to build the help file.</span></span>

<span data-ttu-id="3e90c-165">Если указан файл справки, но путь не указан, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) ищет файл справки в каталоге справки или в каталоге, указанном переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="3e90c-165">When you specify a help file but you do not specify a path, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) looks for the help file in the help directory or in a directory specified by the PATH environment variable.</span></span> <span data-ttu-id="3e90c-166">Кроме того, **WinHelp** может найти файл справки, имя которого указано в следующем расположении реестра:</span><span class="sxs-lookup"><span data-stu-id="3e90c-166">In addition, **WinHelp** can find a help file whose name is listed in the following registry location:</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            Help
```

<span data-ttu-id="3e90c-167">Чтобы воспользоваться преимуществами реестра, необходимо создать имя значения, имя которого совпадает с именем файла справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-167">To take advantage of the registry, you must create a value name that has the same name as your help file.</span></span> <span data-ttu-id="3e90c-168">Значение, присваиваемое этому имени, должно быть каталогом, в котором находится файл справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-168">The value assigned to that name must be the directory where the help file resides.</span></span>

<span data-ttu-id="3e90c-169">Если [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) не удается найти указанный файл справки, отображается диалоговое окно, позволяющее пользователю указать расположение файла справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-169">If [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) cannot find the given help file, it displays a dialog box that allows the user to specify the location of the help file.</span></span> <span data-ttu-id="3e90c-170">Так как **WinHelp** сохраняет сведения о расположении в реестре, он больше не будет спрашивать о расположении того же файла справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-170">Because **WinHelp** saves the location information in the registry, it does not ask again for the location of the same help file.</span></span>

<span data-ttu-id="3e90c-171">Дополнительные сведения о создании и сборке файла справки см. в документации, поставляемой со средствами разработки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-171">For more information about how to author and build a help file, see the documentation provided with your development tools.</span></span>

### <a name="starting-windows-help"></a><span data-ttu-id="3e90c-172">Запуск справки Windows</span><span class="sxs-lookup"><span data-stu-id="3e90c-172">Starting Windows Help</span></span>

<span data-ttu-id="3e90c-173">В следующем примере функция [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) используется для запуска приложения справки Windows и открытия файла справки в его содержимом.</span><span class="sxs-lookup"><span data-stu-id="3e90c-173">The following example uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to start the Windows Help application and open the help file to its Contents topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_CONTENTS, 0L);
```



<span data-ttu-id="3e90c-174">Следующий пример открывает файл справки пользователя, ищет в файле раздел, связанный со строкой ключевого слова, а затем выводит раздел.</span><span class="sxs-lookup"><span data-stu-id="3e90c-174">This next example opens the user help file, searches the file for the topic associated with a keyword string, and then displays the topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_KEY, (DWORD) "finding topics");
```



### <a name="help-topics-dialog-box"></a><span data-ttu-id="3e90c-175">Диалоговое окно "разделы справки"</span><span class="sxs-lookup"><span data-stu-id="3e90c-175">Help Topics dialog box</span></span>

<span data-ttu-id="3e90c-176">Диалоговое окно **разделы справки** можно вызвать путем вызова функции [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) с помощью команды **Help \_ Finder** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-176">You can display the **Help Topics** dialog box by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the **HELP\_FINDER** command.</span></span> <span data-ttu-id="3e90c-177">Диалоговое окно **разделы справки** позволяет пользователю выбирать разделы для отображения путем просмотра заголовков разделов, ключевых слов, связанных с разделами, или слов и фраз, найденных в разделах.</span><span class="sxs-lookup"><span data-stu-id="3e90c-177">The **Help Topics** dialog box lets the user select topics to display by viewing the titles of the topics, the keywords associated with the topics, or the words and phrases found in the topics.</span></span> <span data-ttu-id="3e90c-178">Приложения обычно отображают это диалоговое окно, когда пользователь выбирает команду, например разделы справки, из меню Справка.</span><span class="sxs-lookup"><span data-stu-id="3e90c-178">Applications typically display this dialog box when the user chooses a command, such as Help Topics, from the Help menu.</span></span> <span data-ttu-id="3e90c-179">Приложение может также отображать это диалоговое окно, если пользователь нажимает клавишу, когда ни один из окон, элементов управления или меню в приложении не имеет фокуса или является активным.</span><span class="sxs-lookup"><span data-stu-id="3e90c-179">An application may also display this dialog box if the user presses the key when no specific window, control, or menu in the application has the focus or is active.</span></span>

<span data-ttu-id="3e90c-180">В прошлом приложения использовали справку и команды **\_ указателя справки** с функцией [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) для вывода раздела содержимого и индекса ключевого слова файла справки. **\_**</span><span class="sxs-lookup"><span data-stu-id="3e90c-180">In the past, applications have used the **HELP\_CONTENTS** and **HELP\_INDEX** commands with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to display the Contents topic and the keyword index of the Help file.</span></span> <span data-ttu-id="3e90c-181">Эти команды больше не рекомендуются.</span><span class="sxs-lookup"><span data-stu-id="3e90c-181">These commands are no longer recommended.</span></span> <span data-ttu-id="3e90c-182">Вместо этого используйте команду **Help \_ Finder** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-182">Use the **HELP\_FINDER** command instead.</span></span>

### <a name="information-topics"></a><span data-ttu-id="3e90c-183">Информационные разделы</span><span class="sxs-lookup"><span data-stu-id="3e90c-183">Information topics</span></span>

<span data-ttu-id="3e90c-184">Вы можете отобразить конкретный раздел, вызвав функцию [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) с \_ командой контекста Help и указав идентификатор контекста для раздела.</span><span class="sxs-lookup"><span data-stu-id="3e90c-184">You can display a specific topic by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_CONTEXT command and specifying the context identifier for the topic.</span></span> <span data-ttu-id="3e90c-185">Приложения обычно используют контекст справки \_ в ответ на запросы пользователей на разделы, содержащие концептуальную информацию или практическую справку, а не сведения о конкретном элементе управления или меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-185">Applications typically use the HELP\_CONTEXT command in response to user requests for topics containing conceptual information or procedural help rather than information about a specific control or menu.</span></span> <span data-ttu-id="3e90c-186">В таких случаях пользователь может продолжить просмотр файла справки для получения связанных сведений перед возвратом в приложение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-186">In such cases, the user may continue to browse the help file looking for related information before returning to the application.</span></span>

<span data-ttu-id="3e90c-187">\_Команда контекста справки вызывает обычный экземпляр справки Windows, позволяя пользователю найти другие разделы в файле справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-187">The HELP\_CONTEXT command invokes a regular instance of Windows Help, enabling the user to find other topics in the help file.</span></span> <span data-ttu-id="3e90c-188">Обычно в нем отображается главное окно справки, которое содержит строку заголовка, системное меню, кнопки сворачивания и развертывания, главное меню, необязательную панель навигации, границу изменения размера и клиентскую область.</span><span class="sxs-lookup"><span data-stu-id="3e90c-188">It typically displays the main Help window, which includes a title bar, a system menu, minimize and maximize buttons, a main menu, an optional navigation bar, a sizing border, and a client area.</span></span> <span data-ttu-id="3e90c-189">Текст выбранного раздела отображается в клиентской области, и пользователь может перемещаться по файлу справки с помощью активных ссылок или кнопок навигации в главном окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-189">The text of the selected topic appears in the client area, and the user can navigate through the help file by using hot links or navigation buttons in the main window.</span></span> <span data-ttu-id="3e90c-190">Обычный экземпляр справки Windows также может использоваться для вывода справки в одном или нескольких вторичных окнах, а не в главном окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-190">The regular instance of Windows Help can also be used to display help in one or more secondary windows instead of the main window.</span></span>

### <a name="pop-up-topics"></a><span data-ttu-id="3e90c-191">Разделы, посвященные всплывающим окнам</span><span class="sxs-lookup"><span data-stu-id="3e90c-191">Pop-up topics</span></span>

<span data-ttu-id="3e90c-192">Можно отобразить всплывающую подсказку, содержащую сведения о конкретном элементе управления или меню, вызвав функцию [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) с помощью \_ команды Help WM \_ Help или Help \_ CONTEXTMENU.</span><span class="sxs-lookup"><span data-stu-id="3e90c-192">You can display a pop-up topic that contains information for a specific control or menu by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_WM\_HELP or HELP\_CONTEXTMENU command.</span></span> <span data-ttu-id="3e90c-193">Эти команды отображают раздел во всплывающем окне рядом с соответствующим элементом управления или меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-193">These commands display a topic in a pop-up window near the corresponding control or menu.</span></span> <span data-ttu-id="3e90c-194">Чтобы позволить пользователю немедленно возвращаться к работе в приложении, всплывающее окно уничтожается сразу же после нажатия пользователем клавиши или нажатия левой кнопки мыши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-194">To let the user return immediately to work in the application, the pop-up window is destroyed as soon as the user presses a key or clicks the left mouse button.</span></span>

<span data-ttu-id="3e90c-195">\_ \_ При обработке [**\_ справочных сообщений WM**](wm-help.md) для управления окнами используется команда help WM Help.</span><span class="sxs-lookup"><span data-stu-id="3e90c-195">You use the HELP\_WM\_HELP command when processing [**WM\_HELP**](wm-help.md) messages for control windows.</span></span> <span data-ttu-id="3e90c-196">Так как большинство элементов управления передают сообщение **\_ справки WM** функции [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , соответствующая процедура диалогового окна (или процедура родительского окна) обрабатывает это сообщение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-196">Because most controls pass the **WM\_HELP** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="3e90c-197">Вместо того чтобы предоставлять определенный идентификатор контекста, процедура диалогового окна должна передать массив пар идентификаторов элементов управления и контекстов в [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) вместе с управляющим маркером, указанным в элементе **хитемхандле** структуры [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) , передаваемой с помощью **\_ справочного сообщения WM** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-197">Rather than give a specific context identifier, the dialog box procedure must pass an array of control and context identifier pairs to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) along with the control handle specified in the **hItemHandle** member of the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure passed with the **WM\_HELP** message.</span></span> <span data-ttu-id="3e90c-198">Функция определяет идентификатор элемента управления, для которого было создано сообщение **\_ справки WM** , и использует соответствующий идентификатор контекста для вывода соответствующего раздела.</span><span class="sxs-lookup"><span data-stu-id="3e90c-198">The function determines the identifier of the control for which the **WM\_HELP** message was generated and uses the matching context identifier to display the appropriate topic.</span></span>

<span data-ttu-id="3e90c-199">При \_ обработке сообщений [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) используется команда help CONTEXTMENU.</span><span class="sxs-lookup"><span data-stu-id="3e90c-199">You use the HELP\_CONTEXTMENU command when processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="3e90c-200">Так как большинство элементов управления передают сообщение **WM \_ CONTEXTMENU** функции [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , соответствующая процедура диалогового окна (или процедура родительского окна) обрабатывает это сообщение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-200">Because most controls pass the **WM\_CONTEXTMENU** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="3e90c-201">Процедура задает массив пар идентификаторов элементов управления и контекстов. Он также задает маркер в параметре *wParam* при вызове [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , чтобы функция могла выбрать соответствующий идентификатор контекста из массива и отобразить соответствующий раздел.</span><span class="sxs-lookup"><span data-stu-id="3e90c-201">The procedure specifies an array of control and context identifier pairs; it also specifies the handle in the *wParam* parameter when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) so that the function can pick the appropriate context identifier from the array and display the appropriate topic.</span></span> <span data-ttu-id="3e90c-202">В отличие от \_ команды справки WM Help \_ , \_ при помощи CONTEXTMENU сначала отображается  команда в меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-202">Unlike the HELP\_WM\_HELP command, HELP\_CONTEXTMENU first displays a **What's This?** command in a menu.</span></span> <span data-ttu-id="3e90c-203">Если пользователь выберет команду, выводится раздел **WinHelp** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-203">If the user chooses the command, **WinHelp** displays the topic.</span></span> <span data-ttu-id="3e90c-204">В противном случае запрос отменяется.</span><span class="sxs-lookup"><span data-stu-id="3e90c-204">Otherwise, the request is canceled.</span></span>

<span data-ttu-id="3e90c-205">Можно также отображать всплывающие разделы с помощью \_ команды Help контекстпопуп и указания идентификатора контекста раздела.</span><span class="sxs-lookup"><span data-stu-id="3e90c-205">You can also display pop-up topics by using the HELP\_CONTEXTPOPUP command and specifying a context identifier of the topic.</span></span> <span data-ttu-id="3e90c-206">Эта команда аналогична \_ команде контекста справки, но вызывает всплывающий экземпляр справки Windows, используемый справкой \_ WM HELP \_ и Help \_ CONTEXTMENU.</span><span class="sxs-lookup"><span data-stu-id="3e90c-206">This command is similar to the HELP\_CONTEXT command but invokes the pop-up instance of Windows Help used by HELP\_WM\_HELP and HELP\_CONTEXTMENU.</span></span> <span data-ttu-id="3e90c-207">Приложения могут использовать эту команду в ответ на [**сообщения \_ справки WM**](wm-help.md) для вывода справки для меню и для окон, не являющихся элементами управления в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-207">Applications can use this command in response to [**WM\_HELP**](wm-help.md) messages to display help for menus and for windows that are not controls in a dialog box.</span></span> <span data-ttu-id="3e90c-208">Чтобы наиболее эффективно использовать эту команду, приложение должно назначить идентификаторы контекста этим меню и окнам.</span><span class="sxs-lookup"><span data-stu-id="3e90c-208">To use this command most effectively, the application should assign context identifiers to these menus and windows.</span></span>

<span data-ttu-id="3e90c-209">Идентификатор контекста можно назначить любому окну или меню в приложении.</span><span class="sxs-lookup"><span data-stu-id="3e90c-209">You can assign a context identifier to any window or menu in the application.</span></span> <span data-ttu-id="3e90c-210">При создании [**сообщения \_ справки WM**](wm-help.md) система включает идентификатор контекста в структуру [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) , которая передается родительскому окну в **\_ справочном сообщении WM** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-210">When a [**WM\_HELP**](wm-help.md) message is generated, the system includes the context identifier in the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that is passed to the parent window in the **WM\_HELP** message.</span></span> <span data-ttu-id="3e90c-211">Родительское окно может затем передать идентификатор контекста в [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) для вывода запрошенного раздела справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-211">The parent window can then pass the context identifier to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) to display the requested help topic.</span></span>

<span data-ttu-id="3e90c-212">Используйте функцию [**сетвиндовконтексселпид**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) , чтобы назначить идентификатор контекста для окна или элемента управления, а функцию [**сетменуконтексселпид**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) — для назначения контекстного идентификатора меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-212">You use the [**SetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) function to assign a context identifier to a window or control and the [**SetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) function to assign a context identifier to a menu.</span></span> <span data-ttu-id="3e90c-213">Идентификатор контекста для окна или меню можно получить с помощью функции [**жетвиндовконтексселпид**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) или [**жетменуконтексселпид**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-213">You can retrieve the context identifier for a window or menu by using the [**GetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) or [**GetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) function.</span></span>

### <a name="keyword-searches"></a><span data-ttu-id="3e90c-214">Поиск по ключевым словам</span><span class="sxs-lookup"><span data-stu-id="3e90c-214">Keyword searches</span></span>

<span data-ttu-id="3e90c-215">Вы можете разрешить пользователю находить и просматривать разделы, назначив ключевые слова для разделов в файле справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-215">You can enable the user to find and view topics by assigning keywords to topics in the help file.</span></span> <span data-ttu-id="3e90c-216">Ключевое слово — это просто строка, связанная с одной или несколькими разделами.</span><span class="sxs-lookup"><span data-stu-id="3e90c-216">A keyword is simply a string that is associated with one or more topics.</span></span> <span data-ttu-id="3e90c-217">Справка Windows собирает все ключевые слова в файле справки, помещает их в таблицу и отображает в списке Индекс диалогового окна **разделы справки** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-217">Windows Help collects all keywords in a help file, places them in a table, and displays them in the Index list of the **Help Topics** dialog box.</span></span> <span data-ttu-id="3e90c-218">Когда пользователь выбирает ключевое слово, в справке Windows отображается соответствующий раздел справки или, если имеется несколько разделов, связанных с ключевым словом, отображает список разделов, из которых пользователь может выбрать.</span><span class="sxs-lookup"><span data-stu-id="3e90c-218">When the user selects a keyword, Windows Help displays the associated help topic or, if there is more than one topic associated with the keyword, displays a list of topics from which the user can choose.</span></span>

<span data-ttu-id="3e90c-219">В приложении можно использовать \_ команду справки, Help \_ ПАРТИАЛКЭЙ или Help \_ многоключевые с функцией [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) для поиска и вывода разделов справки на основе полных или частичных ключевых слов.</span><span class="sxs-lookup"><span data-stu-id="3e90c-219">In an application, you can use the HELP\_KEY, HELP\_PARTIALKEY, or HELP\_MULTIKEY command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to search for and display help topics based on whole or partial keywords.</span></span> <span data-ttu-id="3e90c-220">Вы указываете команду, строку ключевого слова, файл справки и маркер для окна владельца.</span><span class="sxs-lookup"><span data-stu-id="3e90c-220">You specify the command, the keyword string, the help file, and the handle to the owner window.</span></span> <span data-ttu-id="3e90c-221">Во всех случаях, если найдено одно совпадение, **WinHelp** отображает соответствующий раздел.</span><span class="sxs-lookup"><span data-stu-id="3e90c-221">In all cases, if a single match is found, **WinHelp** displays the corresponding topic.</span></span> <span data-ttu-id="3e90c-222">Если найдено несколько совпадений, функция отображает диалоговое окно найденные разделы, а пользователь может выбрать раздел для просмотра.</span><span class="sxs-lookup"><span data-stu-id="3e90c-222">If more than one match is found, the function displays the Topics Found dialog box, and the user can choose which topic to view.</span></span> <span data-ttu-id="3e90c-223">Если совпадений не найдено, **WinHelp** либо отображает список индексов (для \_ клавиши Help и Help \_ партиалкэй), либо выводит сообщение об ошибке (для Help \_ многоключевые).</span><span class="sxs-lookup"><span data-stu-id="3e90c-223">If no match is found, **WinHelp** either displays the Index list (for HELP\_KEY and HELP\_PARTIALKEY) or displays an error message (for HELP\_MULTIKEY).</span></span>

<span data-ttu-id="3e90c-224">Приложение может искать несколько ключевых слов в одном вызове [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , разделяя ключевые слова точкой с запятой.</span><span class="sxs-lookup"><span data-stu-id="3e90c-224">Your application can search for multiple keywords in a single call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) by separating the keywords with semicolons.</span></span> <span data-ttu-id="3e90c-225">(Поиск нескольких ключевых слов не поддерживается для файлов справки, созданных для Windows версии 3. *x*). Он также может искать ключевые слова в нескольких файлах справки, если файл справки с указанным файлом содержимого (. cnt) содержит команды index или: Link.</span><span class="sxs-lookup"><span data-stu-id="3e90c-225">(Searching for multiple keywords is not supported for help files created for Windows version 3.*x*) It can also search for keywords across multiple help files if the help file that is specified has a contents(.cnt) file that contains :Index or :Link commands.</span></span> <span data-ttu-id="3e90c-226">С помощью \_ команды справки **WinHelp** ищет ключевые слова во всех файлах, указанных в этих командах.</span><span class="sxs-lookup"><span data-stu-id="3e90c-226">With the HELP\_KEY command, **WinHelp** searches for keywords in all files specified by these commands.</span></span> <span data-ttu-id="3e90c-227">С помощью \_ команд Help многоключевые и Help \_ партиалкэй функция выполняет поиск по всем файлам, кроме тех, которые указаны командами: Link.</span><span class="sxs-lookup"><span data-stu-id="3e90c-227">With the HELP\_MULTIKEY and HELP\_PARTIALKEY commands, the function searches all files except those specified by :Link commands.</span></span>

<span data-ttu-id="3e90c-228">По умолчанию Справка Windows распознает только таблицу ключевых слов, обозначенную символом K сноски в файле источника справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-228">By default, Windows Help recognizes only the keyword table identified by the K footnote character in the help source file.</span></span> <span data-ttu-id="3e90c-229">Можно направить справку Windows для создания дополнительных таблиц ключевых слов, добавив в исходный файл справки символ сноски, отличный от K, с определением ключевого слова.</span><span class="sxs-lookup"><span data-stu-id="3e90c-229">You can direct Windows Help to create additional keyword tables by adding a footnote character other than K, with the keyword definition, in the help source file.</span></span> <span data-ttu-id="3e90c-230">(Однако символ сноски зарезервирован.) При сборке файла справки необходимо определить все дополнительные таблицы ключевых слов с помощью инструкций МНОГОКЛЮЧЕВЫЕ в \[ \] разделе Options файла проекта.</span><span class="sxs-lookup"><span data-stu-id="3e90c-230">(The footnote character A, however, is reserved.) You must define any additional keyword tables by using MULTIKEY statements in the \[OPTIONS\] section of the project file when building the help file.</span></span>

<span data-ttu-id="3e90c-231">Приложение может использовать \_ команду Help сетиндекс с функцией [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , чтобы направить справку Windows для вывода в списке индексов таблицы ключевых слов, отличных от K.</span><span class="sxs-lookup"><span data-stu-id="3e90c-231">An application can use the HELP\_SETINDEX command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to direct Windows Help to display a keyword table other than K in its Index list.</span></span> <span data-ttu-id="3e90c-232">Чтобы направить справку Windows на поиск ключевого слова в альтернативной таблице ключевых слов, приложение может использовать команду HELP \_ многоключевые.</span><span class="sxs-lookup"><span data-stu-id="3e90c-232">To direct Windows Help to search for a keyword in an alternate keyword table, an application can use the HELP\_MULTIKEY command.</span></span> <span data-ttu-id="3e90c-233">Вы указываете ключевое слово и таблицу ключевых слов в структуре [**мултикэйхелп**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) , которая передается в **WinHelp**.</span><span class="sxs-lookup"><span data-stu-id="3e90c-233">You specify the keyword and keyword table in a [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) structure, which you pass to **WinHelp**.</span></span>

<span data-ttu-id="3e90c-234">Когда [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) отображает раздел, он отображает его в окне, указанном в тексте ">" для раздела, в окне, заданном командой: Base в файле содержимого, или в главном окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-234">When [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) displays a topic, it displays it in the window specified by the ">" footnote for the topic, in the window specified by the :Base command in the contents file, or in the main window.</span></span> <span data-ttu-id="3e90c-235">Если главное окно уже открыто для другого файла справки при вызове **WinHelp**, функция скрывает главное окно при поиске.</span><span class="sxs-lookup"><span data-stu-id="3e90c-235">If the main window is already open to a different help file when you call **WinHelp**, the function hides the main window while searching.</span></span> <span data-ttu-id="3e90c-236">В этом случае отмена диалоговых окон « **найденные разделы** » и « **разделы справки** » приводит к закрытию главного окна.</span><span class="sxs-lookup"><span data-stu-id="3e90c-236">In this case, canceling both the **Topics Found** and **Help Topics** dialog boxes closes the main window.</span></span>

### <a name="secondary-help-windows"></a><span data-ttu-id="3e90c-237">Вспомогательные окна справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-237">Secondary Help windows</span></span>

<span data-ttu-id="3e90c-238">Главное окно приложения справки Windows называется основным окном.</span><span class="sxs-lookup"><span data-stu-id="3e90c-238">The main window of the Windows Help application is called the primary window.</span></span> <span data-ttu-id="3e90c-239">Справка Windows также может отображать разделы справки во вторичном окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-239">Windows Help can also display help topics in a secondary window.</span></span> <span data-ttu-id="3e90c-240">В отличие от основного окна справки, дополнительное окно не содержит строку меню.</span><span class="sxs-lookup"><span data-stu-id="3e90c-240">Unlike the primary Help window, a secondary window does not contain a menu bar.</span></span> <span data-ttu-id="3e90c-241">Можно включить панель навигации во вторичное окно, а также добавить кнопки на панель.</span><span class="sxs-lookup"><span data-stu-id="3e90c-241">You can include a navigation bar in a secondary window, and you can add buttons to the bar.</span></span> <span data-ttu-id="3e90c-242">Можно также настроить автоматическую настройку высоты дополнительного окна в справке Windows для размещения раздела.</span><span class="sxs-lookup"><span data-stu-id="3e90c-242">You can also choose to have Windows Help automatically adjust the height of the secondary window to accommodate the topic.</span></span>

<span data-ttu-id="3e90c-243">Необходимо определить вторичные окна в \[ разделе Windows \] файла проекта справки, указав имя и, при необходимости, начальный размер и расположение каждого окна.</span><span class="sxs-lookup"><span data-stu-id="3e90c-243">You must define secondary windows in the \[WINDOWS\] section of your help project file, providing the name and, optionally, initial size and position of each window.</span></span> <span data-ttu-id="3e90c-244">Можно направить Справочное приложение Windows для вывода раздела во вторичном окне, добавив угловую скобку (>) и имя, определенное для дополнительного окна, в имя файла справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-244">You can direct the Windows Help application to display a topic in a secondary window by appending an angle bracket (>) and the name you have defined for the secondary window to the name of the help file.</span></span> <span data-ttu-id="3e90c-245">Результирующая строка затем передается функции [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-245">The resulting string is then passed to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span>

<span data-ttu-id="3e90c-246">Приложение может изменить размер и расположение основного или дополнительного окна, указав адрес структуры [**хелпвининфо**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) и \_ команду Help сетвинпос в вызове [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span><span class="sxs-lookup"><span data-stu-id="3e90c-246">An application can change the size and position of a primary or secondary window by specifying the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure and the HELP\_SETWINPOS command in a call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="3e90c-247">**Хелпвининфо** указывает имя окна, а также его новый размер и расположение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-247">**HELPWININFO** specifies the name of the window and its new size and position.</span></span>

### <a name="training-card-help"></a><span data-ttu-id="3e90c-248">Справка по учебной карточке</span><span class="sxs-lookup"><span data-stu-id="3e90c-248">Training card help</span></span>

<span data-ttu-id="3e90c-249">С помощью справки по учебной карточке приложение может отобразить последовательность инструкций, которые помогут пользователю выполнить шаги задачи.</span><span class="sxs-lookup"><span data-stu-id="3e90c-249">Using training card help, an application can display a sequence of instructions to guide the user through the steps of a task.</span></span> <span data-ttu-id="3e90c-250">Учебная карточка обычно состоит из текста, поясняющего конкретный шаг и кнопки, которые связаны с макросами Ткард, что позволяет пользователю сообщить приложению, что делать дальше.</span><span class="sxs-lookup"><span data-stu-id="3e90c-250">A training card typically consists of text that explains a particular step and buttons that are associated with TCard macros, which allow the user to tell the application what to do next.</span></span> <span data-ttu-id="3e90c-251">Карточки обучения могут отображаться только во вторичных окнах и не должны содержать ссылки на другие разделы в файле справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-251">Training cards can only be displayed in secondary windows and must not contain hot links to other topics in the help file.</span></span>

<span data-ttu-id="3e90c-252">Приложение инициирует экземпляр справки Windows в карточке обучения, вызывая функцию [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) и УКАЗЫВАЯ \_ команду Help ткард в сочетании с другой командой, такой как \_ контекст справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-252">An application initiates the training card instance of Windows Help by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_TCARD command in combination with another command, such as HELP\_CONTEXT.</span></span> <span data-ttu-id="3e90c-253">Затем, когда пользователь нажимает кнопку на карточке обучения, щелкает активную точку, назначенную макросу Ткард, или закрывает карточку обучения, Справка Windows уведомляет приложение, отправляя ему сообщение [**WM \_ ткард**](wm-tcard.md) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-253">Subsequently, when the user clicks a button in the training card, clicks a hot spot assigned to the TCard macro, or closes the training card, Windows Help notifies the application by sending it a [**WM\_TCARD**](wm-tcard.md) message.</span></span> <span data-ttu-id="3e90c-254">Параметр *wParam* идентифицирует кнопку или действие пользователя, а параметр *lParam* содержит дополнительные данные, значение которых зависит от значения параметра *wParam*.</span><span class="sxs-lookup"><span data-stu-id="3e90c-254">The *wParam* parameter identifies the button or user action, and the *lParam* parameter contains additional data, the meaning of which depends on the value of *wParam*.</span></span>

### <a name="canceling-help"></a><span data-ttu-id="3e90c-255">Отмена справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-255">Canceling Help</span></span>

<span data-ttu-id="3e90c-256">Справочная система Windows требует, чтобы приложение явно отменило справку, чтобы освободить ресурсы, используемые для наблюдения за приложением и файлами справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-256">Windows Help requires an application to explicitly cancel help so that it can free any resources used to keep track of the application and its help files.</span></span> <span data-ttu-id="3e90c-257">Приложение может сделать это в любое время, вызвав функцию [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) и УКАЗАВ \_ команду Help Quit.</span><span class="sxs-lookup"><span data-stu-id="3e90c-257">The application can do this at any time by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_QUIT command.</span></span> <span data-ttu-id="3e90c-258">Обратите внимание, что это не относится к всплывающему экземпляру справки Windows.</span><span class="sxs-lookup"><span data-stu-id="3e90c-258">Note that this is not true for the pop-up instance of Windows Help.</span></span> <span data-ttu-id="3e90c-259">Приложение не должно пытаться закрыть всплывающий экземпляр.</span><span class="sxs-lookup"><span data-stu-id="3e90c-259">An application should not try to close a pop-up instance.</span></span>

<span data-ttu-id="3e90c-260">Если приложение выполнило какие-либо вызовы [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), оно должно отменить вызов, прежде чем закрыть его главное окно (например, в ответ на сообщение WM \_ destroy в главной процедуре окна).</span><span class="sxs-lookup"><span data-stu-id="3e90c-260">If an application has made any calls to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), it must cancel help before it closes its main window (for example, in response to the WM\_DESTROY message in the main window procedure).</span></span> <span data-ttu-id="3e90c-261">Приложение должно вызывать **WinHelp** только один раз для отмены справки, независимо от количества открытых файлов справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-261">An application needs to call **WinHelp** only once to cancel help, no matter how many help files it has opened.</span></span> <span data-ttu-id="3e90c-262">Справка Windows продолжает работать до тех пор, пока все приложения и библиотеки DLL не отменили справку.</span><span class="sxs-lookup"><span data-stu-id="3e90c-262">Windows Help remains running until all applications or DLLs have canceled help.</span></span>

<span data-ttu-id="3e90c-263">Чтобы закрыть экземпляр карточки обучения Windows Help, необходимо указать \_ команды Help ткард и Help \_ Quit при вызове [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span><span class="sxs-lookup"><span data-stu-id="3e90c-263">To close the training card instance of Windows Help, you must specify both the HELP\_TCARD and HELP\_QUIT commands when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="3e90c-264">Приложению не нужно отменять экземпляр карточки обучения Windows, если пользователь отменяет ее.</span><span class="sxs-lookup"><span data-stu-id="3e90c-264">An application does not need to cancel the training card instance of Windows Help if the user cancels it first.</span></span> <span data-ttu-id="3e90c-265">Справка Windows уведомляет приложение, когда пользователь отменяет экземпляр карточки обучения, отправляя сообщение [**WM \_ ткард**](wm-tcard.md) с параметром *wParam* , установленным в значение идклосе.</span><span class="sxs-lookup"><span data-stu-id="3e90c-265">Windows Help notifies an application when the user cancels the training card instance by sending the [**WM\_TCARD**](wm-tcard.md) message with the *wParam* parameter set to IDCLOSE.</span></span>

## <a name="using-help"></a><span data-ttu-id="3e90c-266">Использование справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-266">Using Help</span></span>

<span data-ttu-id="3e90c-267">В этом разделе показано, как предоставить контекстную справку для диалогового окна и как задать внешний вид дополнительного окна справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-267">This section shows how to provide context-sensitive help for a dialog box and how to set the appearance of a secondary Help window.</span></span>

-   [<span data-ttu-id="3e90c-268">Предоставление справки в диалоговом окне</span><span class="sxs-lookup"><span data-stu-id="3e90c-268">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
-   [<span data-ttu-id="3e90c-269">Настройка внешнего вида дополнительного окна справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-269">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

### <a name="providing-help-in-a-dialog-box"></a><span data-ttu-id="3e90c-270">Предоставление справки в диалоговом окне</span><span class="sxs-lookup"><span data-stu-id="3e90c-270">Providing Help in a Dialog Box</span></span>

<span data-ttu-id="3e90c-271">Чтобы обеспечить контекстную справку в диалоговом окне, необходимо создать массив, состоящий из пар значений **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-271">To provide context-sensitive help in a dialog box, you must create an array consisting of pairs of **DWORD** values.</span></span> <span data-ttu-id="3e90c-272">Первое значение в каждой паре — это идентификатор элемента управления в диалоговом окне, а второй — идентификатор контекста раздела справки для элемента управления.</span><span class="sxs-lookup"><span data-stu-id="3e90c-272">The first value in each pair is the identifier of a control in the dialog box, and the second is the context identifier of the help topic for the control.</span></span> <span data-ttu-id="3e90c-273">Массив должен содержать одну пару идентификаторов для каждого элемента управления в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-273">The array should contain one pair of identifiers for each control in the dialog box.</span></span>

<span data-ttu-id="3e90c-274">Процедура диалогового окна должна обрабатывать сообщения [**WM \_ Help**](wm-help.md) и [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-274">The dialog box procedure must process the [**WM\_HELP**](wm-help.md) and [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="3e90c-275">Процедура диалогового окна получает **\_ справку WM** при нажатии клавиши и **WM \_ CONTEXTMENU** , когда пользователь нажимает правую кнопку мыши.</span><span class="sxs-lookup"><span data-stu-id="3e90c-275">The dialog box procedure receives **WM\_HELP** when the user presses the key and **WM\_CONTEXTMENU** when the user clicks the right mouse button.</span></span>

<span data-ttu-id="3e90c-276">Параметр *lParam* [**\_ справки WM**](wm-help.md) содержит адрес структуры [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-276">The *lParam* parameter of [**WM\_HELP**](wm-help.md) contains the address of a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure.</span></span> <span data-ttu-id="3e90c-277">Элемент **хитемхандле** этой структуры определяет элемент управления, для которого пользователь запросил справку.</span><span class="sxs-lookup"><span data-stu-id="3e90c-277">The **hItemHandle** member of this structure identifies the control for which the user has requested help.</span></span> <span data-ttu-id="3e90c-278">Этот обработчик необходимо передать функции [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) вместе с \_ командой help WM \_ Help, именем файла справки и указателем на массив идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="3e90c-278">You must pass this handle to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function along with the HELP\_WM\_HELP command, the name of your help file, and a pointer to the array of identifiers.</span></span> <span data-ttu-id="3e90c-279">Функция **WinHelp** ищет в массиве идентификатор элемента управления указанного элемента управления, а затем извлекает соответствующий идентификатор контекста справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-279">The **WinHelp** function searches the array for the control identifier of the specified control and then retrieves the corresponding help context identifier.</span></span> <span data-ttu-id="3e90c-280">Затем функция передает идентификатор контекста справки в справку Windows, которая находит соответствующий раздел и отображает его во всплывающем окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-280">Next, the function passes the help context identifier to Windows Help, which finds the corresponding topic and displays it in a pop-up window.</span></span> <span data-ttu-id="3e90c-281">Если элемент управления имеет идентификатор-1, система выполняет поиск следующего элемента управления, который является остановкой табуляции, а затем использует его идентификатор для поиска идентификатора контекста справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-281">If the control has an identifier of -1, the system searches for the next control that is a tab stop and then uses its identifier to find the help context identifier.</span></span> <span data-ttu-id="3e90c-282">Поэтому важно поместить статический текст перед элементами управления в файл ресурсов.</span><span class="sxs-lookup"><span data-stu-id="3e90c-282">For this reason, it is important that you place static text before controls in a resource file.</span></span>

<span data-ttu-id="3e90c-283">При вызове функции [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) обработка [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) похожа на обработку [**\_ справки WM**](wm-help.md) с этими двумя исключениями:</span><span class="sxs-lookup"><span data-stu-id="3e90c-283">When calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) is similar to processing [**WM\_HELP**](wm-help.md) with these two exceptions:</span></span>

-   <span data-ttu-id="3e90c-284">Параметр *wParam* передается из [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md), который является маркером для элемента управления, отправившего сообщение.</span><span class="sxs-lookup"><span data-stu-id="3e90c-284">You pass the *wParam* parameter from [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md), which is the handle to the control that sent the message.</span></span>
-   <span data-ttu-id="3e90c-285">Вместо справки **\_ WM \_** Help следует указать команду **Help \_ CONTEXTMENU** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-285">You specify the **HELP\_CONTEXTMENU** command instead of **HELP\_WM\_HELP**.</span></span>

<span data-ttu-id="3e90c-286">Команда **Help \_ CONTEXTMENU** заставляет окно справки Windows отобразить меню перед отображением раздела справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-286">The **HELP\_CONTEXTMENU** command causes Windows Help to display a menu before it displays the help topic.</span></span> <span data-ttu-id="3e90c-287">Меню определяется системой.</span><span class="sxs-lookup"><span data-stu-id="3e90c-287">The menu is system-defined.</span></span> <span data-ttu-id="3e90c-288">Он позволяет пользователю отображать справку для элемента управления или диалоговое окно **разделы справки** .</span><span class="sxs-lookup"><span data-stu-id="3e90c-288">It allows the user to display help for the control or to display the **Help Topics** dialog box.</span></span>

<span data-ttu-id="3e90c-289">В следующем примере показано, как реализовать контекстно-зависимую справку в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="3e90c-289">The following example shows how to implement context-sensitive help in a dialog box.</span></span>


```
LRESULT CALLBACK EditDlgProc(HWND hwndDlg, UINT uMsg, 
                             WPARAM wParam, LPARAM lParam) 
{ 
    // Create an array of control identifiers and context identifiers. 
    static DWORD aIds[ ] = 
    { 
        ID_SAVE,   IDH_SAVE, 
        ID_DELETE, IDH_DELETE, 
        ID_COPY,   IDH_COPY, 
        ID_PASTE,  IDH_PASTE, 
        0,0 
    }; 

    switch (uMsg) 
    { 
        case WM_HELP: 
            WinHelp(((LPHELPINFO)lParam)->hItemHandle, "helpfile.hlp", 
                    HELP_WM_HELP, (DWORD)(LPSTR)aIds); 
            break; 

        case WM_CONTEXTMENU: 
            WinHelp((HWND)wParam, "helpfile.hlp", HELP_CONTEXTMENU, 
                    (DWORD)(LPVOID)aIds); 
            break; 
        
        // Process other messages here. 
    } 
    return FALSE; 
}
```



### <a name="setting-the-appearance-of-a-secondary-help-window"></a><span data-ttu-id="3e90c-290">Настройка внешнего вида дополнительного окна справки</span><span class="sxs-lookup"><span data-stu-id="3e90c-290">Setting the Appearance of a Secondary Help Window</span></span>

<span data-ttu-id="3e90c-291">Приложение может задать размер, расположение и состояние дополнительного окна справки, передав в \_ функцию [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) команду Help сетвинпос и адрес структуры [**хелпвининфо**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) .</span><span class="sxs-lookup"><span data-stu-id="3e90c-291">An application can set the size, position, and show state of a secondary help window by passing the HELP\_SETWINPOS command and the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="3e90c-292">Члены **хелпвининфо** задают имя изменяемого окна, а также новый размер окна, его расположение и состояние отображения.</span><span class="sxs-lookup"><span data-stu-id="3e90c-292">The members of **HELPWININFO** specify the name of the window to change and the window's new size, position, and show state.</span></span>

<span data-ttu-id="3e90c-293">В следующем примере задается внешний вид дополнительного окна с именем «ВНД \_ Menu».</span><span class="sxs-lookup"><span data-stu-id="3e90c-293">The following example sets the appearance of a secondary window named "wnd\_menu".</span></span> <span data-ttu-id="3e90c-294">Имя должно быть определено в \[ разделе Windows \] файла проекта справки.</span><span class="sxs-lookup"><span data-stu-id="3e90c-294">The name must be defined in the \[WINDOWS\] section of the help project file.</span></span>


```
BOOL DoWindowSize(VOID) 
{ 
    HANDLE hhwi; 
    LPHELPWININFO lphwi; 
    WORD wSize; 
    char *szWndName = "wnd_menu"; 
    size_t NameLength;      // Does not include the terminating null character
    HRESULT hr
    BOOL retval;

    hr = StringCbLengthA(szWndName, STRSAFE_MAX_CCH, &NameLength);
    
    if (SUCCEEDED(hr))
    {
        // Add 1 to account for the name string's terminating null character.
        NameLength++;
        
        // The HELPWININFO structure contains a minimal TCHAR array of size [2] 
        // that is used for the window name. Since sizeof(HELPWININFO) 
        // includes those two TCHARS, they must be subtracted from the 
        // total when adding the actual string length to calculate the  
        // size of the structure. 
        wSize = sizeof(HELPWININFO) - 2 + NameLength; 
    }
    else
        // Something's amiss with the string.
        return FALSE;
        
    hhwi  = GlobalAlloc(GHND, wSize); 
    lphwi = (LPHELPWININFO)GlobalLock(hhwi); 

    lphwi->wStructSize = wSize; 
    lphwi->x    = 256;      // horizontal position 
    lphwi->y    = 256;      // vertical position 
    lphwi->dx   = 767;      // width 
    lphwi->dy   = 512;      // height 
    lphwi->wMax = SW_SHOW;  // show the window 
    
    // secondary window
    hr = StringCbCopyA(lphwi->rgchMember, sizeof(lphwi->rgchMember), szWndName);
    
    if (SUCCEEDED(hr))
    {
        WinHelp(hwnd, "myhelp.hlp", HELP_SETWINPOS, (DWORD)lphwi); 
     
        GlobalUnlock(hhwi); 
        GlobalFree(hhwi); 

        return TRUE; 
    }
    else
        // There was a problem copying the window name.
        return FALSE;
}
```



 

 
