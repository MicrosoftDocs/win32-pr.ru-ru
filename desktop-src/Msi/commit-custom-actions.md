---
description: Фиксация настраиваемых действий выполняется после успешного завершения сценария установки.
ms.assetid: ad766585-e8ac-44b6-9717-7979f803886c
title: Зафиксировать настраиваемые действия
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 174af16a84f71ff90a1fc35c76054ee503449b8a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662737"
---
# <a name="commit-custom-actions"></a><span data-ttu-id="a10dc-103">Зафиксировать настраиваемые действия</span><span class="sxs-lookup"><span data-stu-id="a10dc-103">Commit Custom Actions</span></span>

<span data-ttu-id="a10dc-104">Фиксация настраиваемых действий выполняется после успешного завершения сценария установки.</span><span class="sxs-lookup"><span data-stu-id="a10dc-104">Commit Custom actions are executed upon successful completion of the installation script.</span></span> <span data-ttu-id="a10dc-105">Если [действие функции InstallFinalize](installfinalize-action.md) выполнено успешно, установщик запустит все существующие пользовательские действия фиксации.</span><span class="sxs-lookup"><span data-stu-id="a10dc-105">If the [InstallFinalize action](installfinalize-action.md) is successful, the installer will then run any existing Commit Custom actions.</span></span> <span data-ttu-id="a10dc-106">Единственным параметром mode, который устанавливает установщик в этом случае, является МСИРУНМОДЕ \_ commit.</span><span class="sxs-lookup"><span data-stu-id="a10dc-106">The only mode parameter the installer sets in this case is MSIRUNMODE\_COMMIT.</span></span> <span data-ttu-id="a10dc-107">Описание параметров режима выполнения см. в разделе [**мсижетмоде**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) .</span><span class="sxs-lookup"><span data-stu-id="a10dc-107">See [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) for a description of the run mode parameters.</span></span>

<span data-ttu-id="a10dc-108">Пользовательское действие фиксации можно указать, добавив флаг параметра в поле Тип [таблицы CustomAction](customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="a10dc-108">A commit custom action can be specified by adding an option flag to the Type field of the [CustomAction table](customaction-table.md).</span></span> <span data-ttu-id="a10dc-109">Дополнительные сведения см. в разделе [настраиваемое действие In-Script параметры выполнения](custom-action-in-script-execution-options.md) для флага параметра, определяющего настраиваемое действие фиксации.</span><span class="sxs-lookup"><span data-stu-id="a10dc-109">See [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) for the option flag designating a commit custom action.</span></span>

<span data-ttu-id="a10dc-110">Настраиваемое действие фиксации является дополнением к [настраиваемому действию отката](rollback-custom-actions.md) и может использоваться с настраиваемыми действиями отката для отмены настраиваемых действий, которые вносятся непосредственно в систему.</span><span class="sxs-lookup"><span data-stu-id="a10dc-110">A commit custom action is the complement to a [rollback custom action](rollback-custom-actions.md) and can be used with rollback custom actions to reverse custom actions that make changes directly to the system.</span></span>

<span data-ttu-id="a10dc-111">Обратите внимание, что пользовательское действие отката может не иметь возможности удалить все изменения, сделанные настраиваемыми действиями фиксации.</span><span class="sxs-lookup"><span data-stu-id="a10dc-111">Note that a rollback custom action may not be able to remove all of the changes made by commit custom actions.</span></span> <span data-ttu-id="a10dc-112">Несмотря на то, что установщик записывает как откат, так и фиксацию пользовательских действий в скрипте отката, пользовательские действия записываются только после того, как установщик успешно обработал сценарий установки.</span><span class="sxs-lookup"><span data-stu-id="a10dc-112">Although the installer writes both rollback and commit custom actions into the rollback script, commit custom actions only run after the installer has successfully processed the installation script.</span></span> <span data-ttu-id="a10dc-113">Фиксация настраиваемых действий — это первые действия, выполняемые в скрипте отката.</span><span class="sxs-lookup"><span data-stu-id="a10dc-113">Commit custom actions are the first actions to run in the rollback script.</span></span> <span data-ttu-id="a10dc-114">Если пользовательское действие фиксации завершается ошибкой, установщик инициирует откат, но может выполнять только откат тех операций, которые уже записаны в скрипт отката.</span><span class="sxs-lookup"><span data-stu-id="a10dc-114">If a commit custom action fails, the installer initiates rollback but can only rollback those operations already written to the rollback script.</span></span> <span data-ttu-id="a10dc-115">Это означает, что в зависимости от настраиваемого действия фиксации откат может не иметь возможности отменить изменения, внесенные действием.</span><span class="sxs-lookup"><span data-stu-id="a10dc-115">This means that depending on the commit custom action, a rollback may not be able to undo the changes made by the action.</span></span> <span data-ttu-id="a10dc-116">Можно пропускать сбои при фиксации настраиваемых действий путем создания настраиваемого действия для игнорирования кодов возврата.</span><span class="sxs-lookup"><span data-stu-id="a10dc-116">You can ignore failures in commit custom actions by authoring the custom action to ignore return codes.</span></span>

<span data-ttu-id="a10dc-117">Пользовательские действия отката и фиксации не выполняются, если откат отключен.</span><span class="sxs-lookup"><span data-stu-id="a10dc-117">Rollback and commit custom actions do not run when rollback is disabled.</span></span> <span data-ttu-id="a10dc-118">Если автор пакета требует этих типов настраиваемых действий для правильной установки, они должны использовать свойство [**роллбаккдисаблед**](rollbackdisabled.md) в условии, которое не позволяет продолжить установку после отключения отката.</span><span class="sxs-lookup"><span data-stu-id="a10dc-118">If a package author requires these types of custom actions for proper installation, they should use the [**RollbackDisabled**](rollbackdisabled.md) Property in a condition that prevents the installation from continuing when rollback is disabled.</span></span>

 

 



