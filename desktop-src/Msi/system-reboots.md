---
description: Установщик Windows может определить, когда требуется перезагрузка системы, и автоматически предложить пользователю перезагрузить компьютер в конце установки.
ms.assetid: 10117d2c-c2c8-456f-9fce-a89c2d69d3c1
title: Перезагрузка системы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b32149bbcd43e284f45d7cabcba94a080be5262
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650602"
---
# <a name="system-reboots"></a><span data-ttu-id="df5f0-103">Перезагрузка системы</span><span class="sxs-lookup"><span data-stu-id="df5f0-103">System Reboots</span></span>

<span data-ttu-id="df5f0-104">Установщик Windows может определить, когда требуется перезагрузка системы, и автоматически предложить пользователю перезагрузить компьютер в конце установки.</span><span class="sxs-lookup"><span data-stu-id="df5f0-104">The Windows Installer can determine when a reboot of the system is necessary and automatically prompt the user to reboot at the end of the installation.</span></span> <span data-ttu-id="df5f0-105">Например, установщик автоматически запрашивает перезагрузку, если требуется заменить все файлы, используемые во время установки.</span><span class="sxs-lookup"><span data-stu-id="df5f0-105">For example, the installer automatically prompts for a reboot if it needs to replace any files that are in use during the installation.</span></span>

<span data-ttu-id="df5f0-106">Приложения, использующие [установщик Windows](windows-installer-portal.md) версии 4,0 или более поздней для установки и обслуживания, автоматически используют [Диспетчер перезапуска](../rstmgr/restart-manager-portal.md) для уменьшения числа перезапусков системы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-106">Applications that use [Windows Installer](windows-installer-portal.md) version 4.0 or later for installation and servicing automatically use the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts.</span></span> <span data-ttu-id="df5f0-107">В установщик Windows версии 4,0 или более поздней есть свойства и политики, позволяющие авторам пакетов и администраторам управлять взаимодействием установщик Windows с диспетчером перезапуска.</span><span class="sxs-lookup"><span data-stu-id="df5f0-107">Windows Installer version 4.0 or later has properties and policies that enable the package author and administrators to control the interaction of Windows Installer with the Restart Manager.</span></span> <span data-ttu-id="df5f0-108">Дополнительные сведения см. в разделе [использование установщик Windows с диспетчером перезапуска](using-windows-installer-with-restart-manager.md).</span><span class="sxs-lookup"><span data-stu-id="df5f0-108">For more information, see [Using Windows Installer with Restart Manager](using-windows-installer-with-restart-manager.md).</span></span>

<span data-ttu-id="df5f0-109">Авторы пакетов установки могут запланировать и подавить перезагрузки с помощью стандартных действий в таблицах последовательности и путем установки свойств.</span><span class="sxs-lookup"><span data-stu-id="df5f0-109">Installation package authors can schedule and suppress reboots by using standard actions in the sequence tables and by setting properties.</span></span> <span data-ttu-id="df5f0-110">Для управления перезагрузками системы используются следующие действия и свойства.</span><span class="sxs-lookup"><span data-stu-id="df5f0-110">The following actions and properties are used to handle system reboots.</span></span>



| <span data-ttu-id="df5f0-111">Действие, диалоговое окно или свойство</span><span class="sxs-lookup"><span data-stu-id="df5f0-111">Action, dialog box, or property</span></span>                                                | <span data-ttu-id="df5f0-112">Краткое описание</span><span class="sxs-lookup"><span data-stu-id="df5f0-112">Brief description</span></span>                                                                                                                                             |
|--------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="df5f0-113">Действие Форцеребут</span><span class="sxs-lookup"><span data-stu-id="df5f0-113">ForceReboot Action</span></span>](forcereboot-action.md)                                   | <span data-ttu-id="df5f0-114">Запрашивает у пользователя перезагрузку во время установки.</span><span class="sxs-lookup"><span data-stu-id="df5f0-114">Prompts the user for a reboot during the installation.</span></span>                                                                                                        |
| [<span data-ttu-id="df5f0-115">Действие Счедулеребут</span><span class="sxs-lookup"><span data-stu-id="df5f0-115">ScheduleReboot Action</span></span>](schedulereboot-action.md)                             | <span data-ttu-id="df5f0-116">Запрашивает у пользователя перезагрузку в конце установки.</span><span class="sxs-lookup"><span data-stu-id="df5f0-116">Prompts the user for a reboot at the end of the installation.</span></span>                                                                                                 |
| [<span data-ttu-id="df5f0-117">**Перезагрузка свойства**</span><span class="sxs-lookup"><span data-stu-id="df5f0-117">**REBOOT Property**</span></span>](reboot.md)                                              | <span data-ttu-id="df5f0-118">Принудительное включение или отключение определенных автоматических запросов на перезагрузку системы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-118">Forces or suppresses certain automatic prompts for a system reboot.</span></span>                                                                                           |
| [<span data-ttu-id="df5f0-119">**РЕБУТПРОМПТ, свойство**</span><span class="sxs-lookup"><span data-stu-id="df5f0-119">**REBOOTPROMPT Property**</span></span>](rebootprompt.md)                                  | <span data-ttu-id="df5f0-120">Подавляет отображение запросов на перезагрузку для пользователя.</span><span class="sxs-lookup"><span data-stu-id="df5f0-120">Suppresses the display of prompts for reboots to the user.</span></span> <span data-ttu-id="df5f0-121">Все необходимые перезагрузки происходят автоматически.</span><span class="sxs-lookup"><span data-stu-id="df5f0-121">Any needed reboots happen automatically.</span></span>                                                           |
| [<span data-ttu-id="df5f0-122">**АФТЕРРЕБУТ, свойство**</span><span class="sxs-lookup"><span data-stu-id="df5f0-122">**AFTERREBOOT Property**</span></span>](afterreboot.md)                                    | <span data-ttu-id="df5f0-123">Обычно используется в условии, накладываемом действием Форцеребут.</span><span class="sxs-lookup"><span data-stu-id="df5f0-123">Commonly used in a condition imposed on the ForceReboot Action.</span></span>                                                                                               |
| [<span data-ttu-id="df5f0-124">Действие Инсталлвалидате</span><span class="sxs-lookup"><span data-stu-id="df5f0-124">InstallValidate Action</span></span>](installvalidate-action.md)                           | <span data-ttu-id="df5f0-125">Отображает диалоговое окно Филесинусе (при необходимости), предоставляя пользователям возможность завершать процессы и устраняя некоторые перезагрузки системы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-125">Displays the FilesInUse Dialog, if necessary, giving users the opportunity to shut down processes and avoid some system reboots.</span></span>                              |
| [<span data-ttu-id="df5f0-126">Диалоговое окно Филесинусе</span><span class="sxs-lookup"><span data-stu-id="df5f0-126">FilesInUse Dialog</span></span>](filesinuse-dialog.md)                                     | <span data-ttu-id="df5f0-127">Предоставляет пользователям возможность завершать процессы, чтобы избежать некоторых перезагрузок системы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-127">Gives users the opportunity to shut down processes to avoid some system reboots.</span></span>                                                                              |
| [<span data-ttu-id="df5f0-128">Диалоговое окно Мсирмфилесинусе</span><span class="sxs-lookup"><span data-stu-id="df5f0-128">MsiRMFilesInUse Dialog</span></span>](msirmfilesinuse-dialog.md)                           | <span data-ttu-id="df5f0-129">Дает пользователям возможность использовать [Диспетчер перезапуска](../rstmgr/restart-manager-portal.md) для закрытия и перезапуска приложений.</span><span class="sxs-lookup"><span data-stu-id="df5f0-129">Gives users the option to use the [Restart Manager](../rstmgr/restart-manager-portal.md) to close and restart applications.</span></span> <span data-ttu-id="df5f0-130">Доступно начиная с версии установщик Windows 4,0.</span><span class="sxs-lookup"><span data-stu-id="df5f0-130">Available beginning with Windows Installer version 4.0.</span></span> |
| [<span data-ttu-id="df5f0-131">**Реплацединусефилес, свойство**</span><span class="sxs-lookup"><span data-stu-id="df5f0-131">**ReplacedInUseFiles Property**</span></span>](replacedinusefiles.md)                      | <span data-ttu-id="df5f0-132">Задайте значение, если установщик установит файл, который используется.</span><span class="sxs-lookup"><span data-stu-id="df5f0-132">Set if the installer installs over a file in use.</span></span> <span data-ttu-id="df5f0-133">Это свойство используется настраиваемыми действиями для обнаружения необходимости перезагрузки.</span><span class="sxs-lookup"><span data-stu-id="df5f0-133">This property is used by custom actions to detect that a reboot is required.</span></span>                                |
| [<span data-ttu-id="df5f0-134">**мсирестартманажерконтрол**</span><span class="sxs-lookup"><span data-stu-id="df5f0-134">**MSIRESTARTMANAGERCONTROL**</span></span>](msirestartmanagercontrol.md)                   | <span data-ttu-id="df5f0-135">Свойство для отключения установщик Windows взаимодействия с [диспетчером перезапуска](../rstmgr/restart-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="df5f0-135">Property to disable Windows Installer interaction with the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span> <span data-ttu-id="df5f0-136">Доступно начиная с версии установщик Windows 4,0.</span><span class="sxs-lookup"><span data-stu-id="df5f0-136">Available beginning with Windows Installer version 4.0.</span></span>          |
| [<span data-ttu-id="df5f0-137">**мсидисаблермрестарт**</span><span class="sxs-lookup"><span data-stu-id="df5f0-137">**MSIDISABLERMRESTART**</span></span>](msidisablermrestart.md)                             | <span data-ttu-id="df5f0-138">Указывает, каким способом [Диспетчер перезапуска](../rstmgr/restart-manager-portal.md) закрывает и перезапускает приложения.</span><span class="sxs-lookup"><span data-stu-id="df5f0-138">Specifies how the [Restart Manager](../rstmgr/restart-manager-portal.md) closes and restarts applications.</span></span> <span data-ttu-id="df5f0-139">Доступно начиная с версии установщик Windows 4,0.</span><span class="sxs-lookup"><span data-stu-id="df5f0-139">Available beginning with Windows Installer version 4.0.</span></span>                  |
| [<span data-ttu-id="df5f0-140">**мсирмшутдовн**</span><span class="sxs-lookup"><span data-stu-id="df5f0-140">**MSIRMSHUTDOWN**</span></span>](msirmshutdown.md)                                         | <span data-ttu-id="df5f0-141">Указывает, каким способом [Диспетчер перезапуска](../rstmgr/restart-manager-portal.md) закрывает и перезапускает приложения.</span><span class="sxs-lookup"><span data-stu-id="df5f0-141">Specifies how the [Restart Manager](../rstmgr/restart-manager-portal.md) closes and restarts applications.</span></span> <span data-ttu-id="df5f0-142">Доступно начиная с версии установщик Windows 4,0.</span><span class="sxs-lookup"><span data-stu-id="df5f0-142">Available beginning with Windows Installer version 4.0.</span></span>                  |
| [<span data-ttu-id="df5f0-143">**мсисистемребутпендинг**</span><span class="sxs-lookup"><span data-stu-id="df5f0-143">**MsiSystemRebootPending**</span></span>](msisystemrebootpending.md)                       | <span data-ttu-id="df5f0-144">Установщик задает это свойство, если ожидается перезагрузка операционной системы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-144">Installer sets this property if a restart of the operating system is pending.</span></span> <span data-ttu-id="df5f0-145">Доступно начиная с версии установщик Windows 4,0.</span><span class="sxs-lookup"><span data-stu-id="df5f0-145">Available beginning with Windows Installer version 4.0.</span></span>                         |
| [<span data-ttu-id="df5f0-146">дисаблеаутоматикаппликатионшутдовн</span><span class="sxs-lookup"><span data-stu-id="df5f0-146">DisableAutomaticApplicationShutdown</span></span>](disableautomaticapplicationshutdown.md) | <span data-ttu-id="df5f0-147">Политика для отключения взаимодействия установщик Windows с [диспетчером перезапуска](../rstmgr/restart-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="df5f0-147">Policy to disable Windows Installer interaction with [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span> <span data-ttu-id="df5f0-148">Доступно начиная с версии установщик Windows 4,0.</span><span class="sxs-lookup"><span data-stu-id="df5f0-148">Available beginning with Windows Installer version 4.0.</span></span>                |



 

<span data-ttu-id="df5f0-149">Ошибка \_ установки \_ приостановки означает, что установка не была завершена или откатить.</span><span class="sxs-lookup"><span data-stu-id="df5f0-149">ERROR\_INSTALL\_SUSPEND means the installation did not complete or rollback.</span></span> <span data-ttu-id="df5f0-150">Установка должна быть возобновлена до ее завершения.</span><span class="sxs-lookup"><span data-stu-id="df5f0-150">The installation must resume before it is completed.</span></span> <span data-ttu-id="df5f0-151">Перед возобновлением установки может потребоваться перезагрузка системы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-151">The system may need to be rebooted before the installation can resume.</span></span>

<span data-ttu-id="df5f0-152">Установщик Windows возвращает код ошибки " \_ \_ приостановка установки" при выполнении [действия форцеребут](forcereboot-action.md) .</span><span class="sxs-lookup"><span data-stu-id="df5f0-152">The Windows Installer returns the error code ERROR\_INSTALL\_SUSPEND when the [ForceReboot action](forcereboot-action.md) is run.</span></span> <span data-ttu-id="df5f0-153">\_ \_ \_ Если перед запуском приложения требуется перезагрузка, необходимо выполнить перезагрузку после успешного выполнения, после чего она вернет сообщение об \_ успешном завершении \_ перезагрузки, \_ Если установщик действительно начал перезагрузку.</span><span class="sxs-lookup"><span data-stu-id="df5f0-153">It returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if a reboot is required before running the application, and it returns ERROR\_SUCCESS\_REBOOT\_INITIATED if the installer has actually started a reboot.</span></span> <span data-ttu-id="df5f0-154">Обратите внимание, что поскольку перезагрузки являются асинхронными, перезагрузка может быть выполнена до того, как будет возвращен код ошибки.</span><span class="sxs-lookup"><span data-stu-id="df5f0-154">Note that because reboots are asynchronous, the reboot may actually occur before the error code is returned.</span></span> <span data-ttu-id="df5f0-155">Дополнительные сведения см. в разделе [коды ошибок](error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="df5f0-155">For more information, see [Error Codes](error-codes.md).</span></span>

<span data-ttu-id="df5f0-156">Настраиваемые действия могут принудительно выполнить перезагрузку в конце установки, вызвав [**мсисетмоде**](/windows/desktop/api/Msiquery/nf-msiquery-msisetmode).</span><span class="sxs-lookup"><span data-stu-id="df5f0-156">Custom actions can force a prompt for reboot at the end of an installation by calling [**MsiSetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msisetmode).</span></span> <span data-ttu-id="df5f0-157">Настраиваемые действия также могут проверять отложенную перезагрузку, вызывая [**мсижетмоде**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode).</span><span class="sxs-lookup"><span data-stu-id="df5f0-157">Custom actions can also check for a pending reboot prompt by calling [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode).</span></span>

## <a name="filesinuse-dialog"></a><span data-ttu-id="df5f0-158">Диалоговое окно Филесинусе</span><span class="sxs-lookup"><span data-stu-id="df5f0-158">FilesInUse Dialog</span></span>

<span data-ttu-id="df5f0-159">Установщик может определить, когда требуется перезагрузка системы, и запросить у пользователя запрос на перезагрузку.</span><span class="sxs-lookup"><span data-stu-id="df5f0-159">The installer can determine when a reboot of the system is necessary and prompt the user with a request to reboot.</span></span> <span data-ttu-id="df5f0-160">Как правило, требуется перезагрузка системы, так как установщик пытается установить файл, который используется в данный момент.</span><span class="sxs-lookup"><span data-stu-id="df5f0-160">Commonly, a system reboot is required because the installer is attempting to install a file that is currently being used.</span></span> <span data-ttu-id="df5f0-161">Если [действие инсталлвалидате](installvalidate-action.md) обнаруживает, что установка файла используется, отображается [диалоговое окно филесинусе](filesinuse-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="df5f0-161">If the [InstallValidate action](installvalidate-action.md) detects the installation of a file in use it displays the [FilesInUse Dialog](filesinuse-dialog.md).</span></span>

<span data-ttu-id="df5f0-162">Если вы предполагаете, что установщик отображает Филесинуседиалог, но это не так, это может быть вызвано одной из следующих причин:</span><span class="sxs-lookup"><span data-stu-id="df5f0-162">If you expect the installer to display a FilesInUseDialog, but it does not, this may be due to one of the following reasons:</span></span>

-   <span data-ttu-id="df5f0-163">Используемые файлы не являются исполняемыми объектами.</span><span class="sxs-lookup"><span data-stu-id="df5f0-163">The files in use are not executables.</span></span>
-   <span data-ttu-id="df5f0-164">Установщик на самом деле не пытается установить эти файлы.</span><span class="sxs-lookup"><span data-stu-id="df5f0-164">The installer is not actually trying to install those files.</span></span>
-   <span data-ttu-id="df5f0-165">Процесс, удерживающий эти файлы, называется процессом, который вызывает установку.</span><span class="sxs-lookup"><span data-stu-id="df5f0-165">The process holding those files is the process invoking the installation.</span></span>
-   <span data-ttu-id="df5f0-166">Процесс, удерживающий эти файлы, не имеет окна с названием, связанным с ним.</span><span class="sxs-lookup"><span data-stu-id="df5f0-166">The process holding those files is one that does not have a window with a title associated with it.</span></span>

<span data-ttu-id="df5f0-167">Дополнительные сведения см. в разделе [ведение журнала запросов на перезагрузку](logging-of-reboot-requests.md).</span><span class="sxs-lookup"><span data-stu-id="df5f0-167">For more information, see [Logging of Reboot Requests](logging-of-reboot-requests.md).</span></span>

 

 
