---
description: Всегда устанавливайте кодовую страницу базы данных перед добавлением сведений о локализации.
ms.assetid: 0d8aee30-989a-4093-8718-1bb90029c0fb
title: Настройка кодовой страницы базы данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87ef04c2969d0933c4601bbca2f3897d86de43a1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103810906"
---
# <a name="setting-the-code-page-of-a-database"></a><span data-ttu-id="f548c-103">Настройка кодовой страницы базы данных</span><span class="sxs-lookup"><span data-stu-id="f548c-103">Setting the Code Page of a Database</span></span>

<span data-ttu-id="f548c-104">Всегда устанавливайте кодовую страницу базы данных перед добавлением сведений о локализации.</span><span class="sxs-lookup"><span data-stu-id="f548c-104">Always set the code page of a database prior to adding any localization information.</span></span> <span data-ttu-id="f548c-105">Попытка задать кодовую страницу после ввода данных в базу данных не рекомендуется, так как это может привести к повреждению символов национальных алфавитов.</span><span class="sxs-lookup"><span data-stu-id="f548c-105">Attempting to set the code page after entering data into the database is not recommended because this could corrupt extended characters.</span></span> <span data-ttu-id="f548c-106">Локализация может быть значительно упрощена, начиная с базы данных, которая является нейтральной для кодовой страницы.</span><span class="sxs-lookup"><span data-stu-id="f548c-106">Localization can be greatly facilitated by starting with a database that is code page neutral.</span></span> <span data-ttu-id="f548c-107">Дополнительные сведения см. в разделе [Создание базы данных с нейтральной кодовой страницей](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="f548c-107">For details, see [Creating a database with a neutral code page](creating-a-database-with-a-neutral-code-page.md).</span></span> <span data-ttu-id="f548c-108">Вы можете определить текущую кодовую страницу базы данных, как описано в разделе [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="f548c-108">You may determine the current code page of a database as described in [Determining an installation database's code page](determining-an-installation-database-s-code-page.md).</span></span> <span data-ttu-id="f548c-109">Список кодовых страниц см. [в разделе Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md) .</span><span class="sxs-lookup"><span data-stu-id="f548c-109">See [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md) for a list of numeric code pages.</span></span>

<span data-ttu-id="f548c-110">Можно задать кодовую страницу пустой базы данных или базы данных с нейтральной кодовой страницей, импортировав текстовый файл архива с ненейтральной кодовой страницей с [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="f548c-110">You may set the code page of a blank database, or a database with a neutral code page, by importing a text archive file having a non-neutral code page with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="f548c-111">При этом кодовая страница базы данных будет задается в кодовой странице импортированного файла.</span><span class="sxs-lookup"><span data-stu-id="f548c-111">This sets the code page of the database to the imported file's code page.</span></span> <span data-ttu-id="f548c-112">Все архивные файлы, которые впоследствии импортируются в базу данных, должны иметь ту же кодовую страницу, что и первый файл.</span><span class="sxs-lookup"><span data-stu-id="f548c-112">All archive files subsequently imported into the database must then have the same code page as the first file.</span></span> <span data-ttu-id="f548c-113">Если текстовый файл архива экспортируется из базы данных, кодовая страница файла архива совпадает с родительской базой данных.</span><span class="sxs-lookup"><span data-stu-id="f548c-113">If a text archive file is exported from a database, the code page of the archive file is the same as the parent database.</span></span> <span data-ttu-id="f548c-114">См. раздел [Обработка кодовых страниц импортированных и экспортированных таблиц](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="f548c-114">See [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="f548c-115">Кодовая страница любой базы данных может быть установлена на указанную числовую кодовую страницу с помощью [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) для импорта текстового файла архива в следующем формате: две пустые строки. , за которым следует строка, содержащая числовую кодовую страницу, разделитель табуляции и точную строку: \_ форцекодепаже.</span><span class="sxs-lookup"><span data-stu-id="f548c-115">The code page of any database may be set to a specified numeric code page by using [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) to import a text archive file with the following format: Two blank lines; followed by a line containing the numeric code page, a tab delimiter, and the exact string: \_ForceCodepage.</span></span> <span data-ttu-id="f548c-116">Обратите внимание, что при использовании Windows 2000 все строки в базе данных преобразуются в кодовую страницу \_ форцекодепаже.</span><span class="sxs-lookup"><span data-stu-id="f548c-116">Note that with Windows 2000, this translates all of the strings in the database to the code page of \_ForceCodepage.</span></span> <span data-ttu-id="f548c-117">Это может быть предусмотрено при локализации существующей базы данных и переводе всех ненейтральных строк на новую кодовую страницу.</span><span class="sxs-lookup"><span data-stu-id="f548c-117">This may be intended when localizing an existing database and translating all non-neutral strings to the new code page.</span></span> <span data-ttu-id="f548c-118">Однако это приводит к ошибке, если база данных содержит ненейтральные строки, которые не должны быть переведены.</span><span class="sxs-lookup"><span data-stu-id="f548c-118">However, this causes an error if the database contains non-neutral strings that are not to be translated.</span></span>

<span data-ttu-id="f548c-119">В программе WiLangId.vbs приведен пример того, как задать кодовую страницу пакета с помощью [**метода Import**](database-import.md).</span><span class="sxs-lookup"><span data-stu-id="f548c-119">The utility WiLangId.vbs provides an example of how to set the code page of a package using the [**Import method**](database-import.md).</span></span> <span data-ttu-id="f548c-120">Копия WiLangId.vbs предоставляется в пакете SDK для установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="f548c-120">A copy of WiLangId.vbs is provided in the Windows Installer SDK.</span></span> <span data-ttu-id="f548c-121">Эту программу можно использовать для определения языковых версий, поддерживаемых базой данных (пакетом), языка, используемого установщиком для любых строк в пользовательском интерфейсе, не созданных в базе данных (продукт), или в одной кодовой странице ANSI для пула строк (кодовая страница).</span><span class="sxs-lookup"><span data-stu-id="f548c-121">You can use this utility to determine the language versions that are supported by the database (Package), the language the installer uses for any strings in the user interface that are not authored into the database (Product), or the single ANSI code page for the string pool (Codepage).</span></span> <span data-ttu-id="f548c-122">Сведения об использовании WiLangId.vbs см. на странице справки: [Управление языком и кодовой](manage-language-and-codepage.md)страницей.</span><span class="sxs-lookup"><span data-stu-id="f548c-122">For information on using WiLangId.vbs see the help page: [Manage Language and Codepage](manage-language-and-codepage.md).</span></span>

<span data-ttu-id="f548c-123">Чтобы определить значения продукта, пакета и кодовой страницы, выполните WiLangId.vbs следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f548c-123">To determine the values of Product, Package, and Codepage, run WiLangId.vbs as follows.</span></span>

<span data-ttu-id="f548c-124">**cscript wilangid.vbs** *\[ путь к базе \] данных*</span><span class="sxs-lookup"><span data-stu-id="f548c-124">**cscript wilangid.vbs** *\[path to database\]*</span></span>

<span data-ttu-id="f548c-125">Чтобы задать кодовую страницу пакета, выполните следующую командную строку.</span><span class="sxs-lookup"><span data-stu-id="f548c-125">To set the Codepage of the package run the following command line.</span></span>

<span data-ttu-id="f548c-126">**cscript wilangid.vbs** *\[ путь к \]* *\[ значению \]* **кодовой страницы** базы данных</span><span class="sxs-lookup"><span data-stu-id="f548c-126">**cscript wilangid.vbs** *\[path to database\]* **Codepage** *\[value\]*</span></span>

<span data-ttu-id="f548c-127">Например, чтобы задать кодовую страницу для test.msi числовой кодовой странице ANSI 1252, выполните следующую командную строку.</span><span class="sxs-lookup"><span data-stu-id="f548c-127">For example, to set the Codepage of test.msi to the numeric ANSI code page value 1252, run the following command line.</span></span>

<span data-ttu-id="f548c-128">**cscript wilangid.vbs c: \\ временная \\test.msi кодовая страница 1252**</span><span class="sxs-lookup"><span data-stu-id="f548c-128">**cscript wilangid.vbs c:\\temp\\test.msi Codepage 1252**</span></span>

 

 



