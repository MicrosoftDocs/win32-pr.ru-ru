---
description: Всегда устанавливайте кодовую страницу базы данных перед добавлением сведений о локализации.
ms.assetid: 0d8aee30-989a-4093-8718-1bb90029c0fb
title: Настройка кодовой страницы базы данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87ef04c2969d0933c4601bbca2f3897d86de43a1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103810906"
---
# <a name="setting-the-code-page-of-a-database"></a>Настройка кодовой страницы базы данных

Всегда устанавливайте кодовую страницу базы данных перед добавлением сведений о локализации. Попытка задать кодовую страницу после ввода данных в базу данных не рекомендуется, так как это может привести к повреждению символов национальных алфавитов. Локализация может быть значительно упрощена, начиная с базы данных, которая является нейтральной для кодовой страницы. Дополнительные сведения см. в разделе [Создание базы данных с нейтральной кодовой страницей](creating-a-database-with-a-neutral-code-page.md). Вы можете определить текущую кодовую страницу базы данных, как описано в разделе [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md). Список кодовых страниц см. [в разделе Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md) .

Можно задать кодовую страницу пустой базы данных или базы данных с нейтральной кодовой страницей, импортировав текстовый файл архива с ненейтральной кодовой страницей с [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta). При этом кодовая страница базы данных будет задается в кодовой странице импортированного файла. Все архивные файлы, которые впоследствии импортируются в базу данных, должны иметь ту же кодовую страницу, что и первый файл. Если текстовый файл архива экспортируется из базы данных, кодовая страница файла архива совпадает с родительской базой данных. См. раздел [Обработка кодовых страниц импортированных и экспортированных таблиц](code-page-handling-of-imported-and-exported-tables.md).

Кодовая страница любой базы данных может быть установлена на указанную числовую кодовую страницу с помощью [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) для импорта текстового файла архива в следующем формате: две пустые строки. , за которым следует строка, содержащая числовую кодовую страницу, разделитель табуляции и точную строку: \_ форцекодепаже. Обратите внимание, что при использовании Windows 2000 все строки в базе данных преобразуются в кодовую страницу \_ форцекодепаже. Это может быть предусмотрено при локализации существующей базы данных и переводе всех ненейтральных строк на новую кодовую страницу. Однако это приводит к ошибке, если база данных содержит ненейтральные строки, которые не должны быть переведены.

В программе WiLangId.vbs приведен пример того, как задать кодовую страницу пакета с помощью [**метода Import**](database-import.md). Копия WiLangId.vbs предоставляется в пакете SDK для установщик Windows. Эту программу можно использовать для определения языковых версий, поддерживаемых базой данных (пакетом), языка, используемого установщиком для любых строк в пользовательском интерфейсе, не созданных в базе данных (продукт), или в одной кодовой странице ANSI для пула строк (кодовая страница). Сведения об использовании WiLangId.vbs см. на странице справки: [Управление языком и кодовой](manage-language-and-codepage.md)страницей.

Чтобы определить значения продукта, пакета и кодовой страницы, выполните WiLangId.vbs следующим образом.

**cscript wilangid.vbs** *\[ путь к базе \] данных*

Чтобы задать кодовую страницу пакета, выполните следующую командную строку.

**cscript wilangid.vbs** *\[ путь к \]* *\[ значению \]* **кодовой страницы** базы данных

Например, чтобы задать кодовую страницу для test.msi числовой кодовой странице ANSI 1252, выполните следующую командную строку.

**cscript wilangid.vbs c: \\ временная \\test.msi кодовая страница 1252**

 

 



