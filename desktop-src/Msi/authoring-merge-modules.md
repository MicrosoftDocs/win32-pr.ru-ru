---
description: Следующая процедура описывает общие шаги по созданию модулей слияния.
ms.assetid: 4b3871c0-f452-4935-9ee3-78b0ac847e67
title: Создание модулей слияния
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ece67151872a8d065d321c6adaae660be643ad8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264190"
---
# <a name="authoring-merge-modules"></a>Создание модулей слияния

Следующая процедура описывает общие шаги по созданию модулей слияния.

**Создание нового модуля слияния**

1.  Получите программное средство, которое можно использовать для изменения базы данных модуля слияния.
2.  Получите пустую базу данных модуля слияния.
3.  Создание [идентификатора GUID](guid.md) для модуля слияния. Этот идентификатор GUID необходимо использовать при создании первичных ключей таблиц базы данных в модуле слияния.
4.  Добавьте запись в [таблицу Component](component-table.md) для каждого компонента, доставленного слиянием. Таблица Component необходима в каждом модуле слияния. Обратите внимание, что модули слияния работают с компонентами, а не с функциями. Однако в некоторых случаях для записи в таблицу базы данных может потребоваться ссылка на функцию. Дополнительные сведения см. [в разделе ссылки на функции в модулях слияния](referencing-features-in-merge-modules.md).
5.  Добавьте [таблицу каталогов](directory-table.md) в модуль слияния, указывающий расположение каталогов, которые модуль слияния добавляет в целевую базу данных. Таблица каталогов необходима в каждом модуле слияния.
6.  Импортируйте пустую [таблицу феатурекомпонентс](featurecomponents-table.md) в базу данных модуля слияния. Эта пустая таблица предоставляет рекомендации для средства слияния в случаях, когда MSI-файл не содержит собственную таблицу Феатурекомпонентс.
7.  Собирайте все файлы, доставляемые этим модулем слияния, и создайте CAB-файл [MergeModule.CABinet](mergemodule-cabinet.md) . Добавьте CAB-файл в модуль слияния в виде потока внутри файла MSM.
8.  Добавьте запись в таблицу файлов для каждого файла, хранящегося в MergeModule.CABinet.
9.  Добавьте сведения, необходимые для обнаружения модуля слияния в [таблице ModuleSignature](modulesignature-table.md). Для каждого модуля слияния требуется таблица ModuleSignature.
10. Перечислите компоненты в модуле слияния в [таблице модулекомпонентс](modulecomponents-table.md). Для каждого модуля слияния требуется таблица Модулекомпонентс.
11. Добавьте таблицы последовательностей модуля слияния в файл MSM, только если модулю слияния необходимо изменить [*таблицы последовательности*](s-gly.md) целевой базы данных установки.
12. Добавьте \_ таблицу проверки в модуль слияния. Для передачи проверки модулю слияния требуется \_ Таблица проверки.
13. Для модулей слияния требуется пользовательский интерфейс в редких случаях. Не рекомендуется включать пользовательский интерфейс с модулем слияния. В случаях, когда требуется пользовательский интерфейс, таблицы пользовательского интерфейса можно объединить в MSI-файл так же, как и другие таблицы.
14. Добавьте сведения о реестре в соответствующие таблицы реестра в базе данных модуля слияния. Добавьте данные реестра для библиотек типов, классов, расширений и команд в таблицы [typelib](typelib-table.md), [Class](class-table.md), [AppID](appid-table.md), [ProgID](progid-table.md), [расширение](extension-table.md), [глагол](verb-table.md)или [MIME](mime-table.md) . Все остальные данные реестра можно найти в [таблице реестра](registry-table.md). Использовать таблицу Селфрег не рекомендуется.
15. Добавьте сводные данные в [поток сводных данных модуля слияния](merge-module-summary-information-stream-reference.md).
16. Запустите проверку для всех модулей слияния, прежде чем пытаться установить.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Получение пустых баз данных модуля слияния](obtaining-blank-merge-module-databases.md)
</dt> <dt>

[Получение средств для создания модулей слияния](obtaining-merge-module-authoring-tools.md)
</dt> <dt>

[Именование первичных ключей в базах данных модулей слияния](naming-primary-keys-in-merge-module-databases.md)
</dt> <dt>

[Создание таблиц компонентов модуля слияния](authoring-merge-module-component-tables.md)
</dt> <dt>

[Создание таблиц каталога для модуля слияния](authoring-merge-module-directory-tables.md)
</dt> <dt>

[Создание таблиц Феатурекомпонентс для модуля слияния](authoring-merge-module-featurecomponents-tables.md)
</dt> <dt>

[Создание CAB-файлов MergeModule.CABinet](generating-mergemodule-cabinet-cabinet-files.md)
</dt> <dt>

[Создание таблиц файлов модулей слияния](authoring-merge-module-file-tables.md)
</dt> <dt>

[Создание таблиц ModuleSignature](authoring-modulesignature-tables.md)
</dt> <dt>

[Создание Модулекомпонентс таблиц](authoring-modulecomponents-tables.md)
</dt> <dt>

[Создание таблиц последовательности для модуля слияния](authoring-merge-module-sequence-tables.md)
</dt> <dt>

[Проверка модулей слияния](validating-merge-modules.md)
</dt> <dt>

[Создание пользовательских интерфейсов в модулях слияния](authoring-user-interfaces-in-merge-modules.md)
</dt> <dt>

[Создание таблиц реестра для модуля слияния](authoring-merge-module-registry-tables.md)
</dt> <dt>

[Создание сводных информационных потоков для модуля слияния](authoring-merge-module-summary-information-streams.md)
</dt> <dt>

[Справочные сведения о потоке сводных данных модуля слияния](merge-module-summary-information-stream-reference.md)
</dt> <dt>

Проверка модулей слияния
</dt> <dt>

[Использование 64-разрядных модулей слияния](using-64-bit-merge-modules.md)
</dt> </dl>

 

 



