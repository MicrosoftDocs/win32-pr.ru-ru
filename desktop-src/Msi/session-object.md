---
description: Объект Session управляет процессом установки.
ms.assetid: 013959d9-900c-45f7-b742-17b0365d6107
title: объект Session (установщик Windows)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: 7b02d1f617f7e558acd9c0423dd785c84e0175f195ee0085b2fdc79d66054683
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119628924"
---
# <a name="session-object-windows-installer"></a>объект Session (установщик Windows)

Объект **Session** управляет процессом установки. Откроется база данных установщика, содержащая таблицы и данные установки. Этот объект связан со стандартным набором функций действий, каждый из которых выполняет определенные операции с данными из одной или нескольких таблиц. Для конкретных установок продукта могут быть добавлены дополнительные настраиваемые действия. Базовая функция ядра — это секвенсор, который извлекает последовательные записи из указанной таблицы последовательностей, вычисляет любое заданное условное выражение и выполняет назначенное действие. Действия, не распознаваемые ядром, откладываются на объект обработчика пользовательского интерфейса для обработки, обычно последовательности диалоговых окон.

Обратите внимание, что один процесс может открыть только один объект **сеанса** .

## <a name="members"></a>Элементы

Объект **сеанса** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Объект **Session** имеет следующие методы.



| Метод                                                 | Описание                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**DoAction**](session-doaction.md)                   | Выполняет указанное действие. <br/>                                                                                                                                                                                                                                |
| [**евалуатекондитион**](session-evaluatecondition.md) | Вычисляет логическое выражение, содержащее символы и значения, и возвращает целое число Мсиевалуатекондитионерроренум перечисления.<br/>                                                                                                                          |
| [**феатуреинфо**](session-featureinfo.md)             | Возвращает объект [**феатуреинфо**](featureinfo-object.md) , содержащий описательные сведения для указанного компонента.<br/>                                                                                                                                       |
| [**форматрекорд**](session-formatrecord.md)           | Возвращает отформатированную строку из шаблона и данных записи.<br/>                                                                                                                                                                                                      |
| [**Сообщение**](session-message.md)                     | Выполняет все включенные операции ведения журнала и откладывает выполнение объекта обработчика пользовательского интерфейса, связанного с ядром.<br/>                                                                                                                                              |
| [**Последовательность**](session-sequence.md)                   | Открывает запрос к указанной таблице, упорядочивая действия по числам в столбце последовательности. Для каждой выбранной строки вызывается метод [**DoAction**](session-doaction.md) при условии, что любое предоставленное выражение условия не возвращает значение false.<br/> |
| [**сетинсталллевел**](session-setinstalllevel.md)     | Задает для текущей установки уровень установки указанного значения и повторно вычисляет выбор и установленные состояния для всех компонентов.<br/>                                                                                                                    |



 

### <a name="properties"></a>Свойства

Объект **сеанса** имеет следующие свойства.



| Свойство                                                                  | Тип доступа           | Описание                                                                                                                                                                |
|:--------------------------------------------------------------------------|:----------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**компоненткостс**](session-componentcosts.md)<br/>               |                       | Возвращает объект [**рекордлист**](recordlist-object.md) , перечисляющий место на диске, необходимое для установки компонента.<br/>                                  |
| [**компоненткуррентстате**](session-componentcurrentstate.md)<br/> |                       | Возвращает текущее установленное состояние указанного компонента.<br/>                                                                                                |
| [**компонентрекуестстате**](session-componentrequeststate.md)<br/> |                       | Получает или запрашивает изменение в состоянии действия строки в таблице Component.<br/>                                                                               |
| [**База данных**](session-database.md)<br/>                           |                       | Возвращает базу данных для текущего сеанса установки.<br/>                                                                                                      |
| [**феатурекост**](session-featurecost.md)<br/>                     |                       | Возвращает общий объем дискового пространства (в единицах 512 байт), требуемый для указанного компонента и его родительских компонентов (до корня таблицы компонентов).<br/> |
| [**феатурекуррентстате**](session-featurecurrentstate.md)<br/>     |                       | Возвращает текущее установленное состояние указанного компонента.<br/>                                                                                                  |
| [**феатуререкуестстате**](session-featurerequeststate.md)<br/>     | Чтение/запись<br/> | Получает или запрашивает изменение в состоянии выбора записи функции и подзаписей.<br/>                                                                          |
| [**феатуревалидстатес**](session-featurevalidstates.md)<br/>       |                       | Возвращает целое число, представляющее битовые флаги с каждым соответствующим битом, представляющим допустимое состояние установки для указанного компонента.<br/>                             |
| [**Установщик**](session-installer.md)<br/>                         |                       | Возвращает активный объект установщика.<br/>                                                                                                                            |
| [**Язык (объект Session)**](session-language.md)<br/>          |                       | Представляет числовой идентификатор языка, используемый текущим сеансом установки.<br/>                                                                            |
| [**Режим**](session-mode.md)<br/>                                   |                       | Это значение, представляющее назначенный флаг режима для текущего сеанса установки.<br/>                                                            |
| [**продуктпроперти**](session-productproperty.md)<br/>             |                       | Представляет строковое значение именованного свойства установщика.<br/>                                                                                                      |
| [**Свойство (объект Session)**](session-session.md)<br/>           | Чтение/запись<br/> | Получает свойства продукта из базы данных продукта.<br/>                                                                                                         |
| [**SourcePath**](session-sourcepath.md)<br/>                       |                       | Предоставляет полный путь к указанной папке на исходном носителе или в образе сервера.<br/>                                                                            |
| [**TargetPath**](session-targetpath.md)<br/>                       | Чтение/запись<br/> | Предоставляет полный путь к указанной папке на целевом диске установки.<br/>                                                                               |
| [**верифидискспаце**](session-verifydiskspace.md)<br/>             |                       | Возвращает значение true, если на диске достаточно места, и значение false, если диск заполнен.<br/>                                                                                        |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик на Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ ISession определяется как 000C109E-0000-0000-C000-000000000046<br/>                                                                                                                                                                             |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Windows Примеры сценариев для установщика](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




