---
description: Объект Session управляет процессом установки.
ms.assetid: 013959d9-900c-45f7-b742-17b0365d6107
title: Объект Session (установщик Windows)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c391249d5ccc58fe9a947c9db761a77521c9776d
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105652248"
---
# <a name="session-object-windows-installer"></a><span data-ttu-id="59ef7-103">Объект Session (установщик Windows)</span><span class="sxs-lookup"><span data-stu-id="59ef7-103">Session object (Windows Installer)</span></span>

<span data-ttu-id="59ef7-104">Объект **Session** управляет процессом установки.</span><span class="sxs-lookup"><span data-stu-id="59ef7-104">The **Session** object controls the installation process.</span></span> <span data-ttu-id="59ef7-105">Откроется база данных установщика, содержащая таблицы и данные установки.</span><span class="sxs-lookup"><span data-stu-id="59ef7-105">It opens the Installer database, which contains the installation tables and data.</span></span> <span data-ttu-id="59ef7-106">Этот объект связан со стандартным набором функций действий, каждый из которых выполняет определенные операции с данными из одной или нескольких таблиц.</span><span class="sxs-lookup"><span data-stu-id="59ef7-106">This object is associated with a standard set of action functions, each performing particular operations on data from one or more tables.</span></span> <span data-ttu-id="59ef7-107">Для конкретных установок продукта могут быть добавлены дополнительные настраиваемые действия.</span><span class="sxs-lookup"><span data-stu-id="59ef7-107">Additional custom actions may be added for particular product installations.</span></span> <span data-ttu-id="59ef7-108">Базовая функция ядра — это секвенсор, который извлекает последовательные записи из указанной таблицы последовательностей, вычисляет любое заданное условное выражение и выполняет назначенное действие.</span><span class="sxs-lookup"><span data-stu-id="59ef7-108">The basic engine function is a sequencer that fetches sequential records from a designated sequence table, evaluates any specified condition expression, and executes the designated action.</span></span> <span data-ttu-id="59ef7-109">Действия, не распознаваемые ядром, откладываются на объект обработчика пользовательского интерфейса для обработки, обычно последовательности диалоговых окон.</span><span class="sxs-lookup"><span data-stu-id="59ef7-109">Actions not recognized by the engine are deferred to the UI handler object for processing, usually dialog box sequences.</span></span>

<span data-ttu-id="59ef7-110">Обратите внимание, что один процесс может открыть только один объект **сеанса** .</span><span class="sxs-lookup"><span data-stu-id="59ef7-110">Note that only one **Session** object can be opened by a single process.</span></span>

## <a name="members"></a><span data-ttu-id="59ef7-111">Элементы</span><span class="sxs-lookup"><span data-stu-id="59ef7-111">Members</span></span>

<span data-ttu-id="59ef7-112">Объект **сеанса** имеет следующие типы членов:</span><span class="sxs-lookup"><span data-stu-id="59ef7-112">The **Session** object has these types of members:</span></span>

-   [<span data-ttu-id="59ef7-113">Методы</span><span class="sxs-lookup"><span data-stu-id="59ef7-113">Methods</span></span>](#methods)
-   [<span data-ttu-id="59ef7-114">Свойства</span><span class="sxs-lookup"><span data-stu-id="59ef7-114">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="59ef7-115">Методы</span><span class="sxs-lookup"><span data-stu-id="59ef7-115">Methods</span></span>

<span data-ttu-id="59ef7-116">Объект **Session** имеет следующие методы.</span><span class="sxs-lookup"><span data-stu-id="59ef7-116">The **Session** object has these methods.</span></span>



| <span data-ttu-id="59ef7-117">Метод</span><span class="sxs-lookup"><span data-stu-id="59ef7-117">Method</span></span>                                                 | <span data-ttu-id="59ef7-118">Описание</span><span class="sxs-lookup"><span data-stu-id="59ef7-118">Description</span></span>                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="59ef7-119">**DoAction**</span><span class="sxs-lookup"><span data-stu-id="59ef7-119">**DoAction**</span></span>](session-doaction.md)                   | <span data-ttu-id="59ef7-120">Выполняет указанное действие.</span><span class="sxs-lookup"><span data-stu-id="59ef7-120">Executes the specified action.</span></span> <br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="59ef7-121">**евалуатекондитион**</span><span class="sxs-lookup"><span data-stu-id="59ef7-121">**EvaluateCondition**</span></span>](session-evaluatecondition.md) | <span data-ttu-id="59ef7-122">Вычисляет логическое выражение, содержащее символы и значения, и возвращает целое число Мсиевалуатекондитионерроренум перечисления.</span><span class="sxs-lookup"><span data-stu-id="59ef7-122">Evaluates a logical expression containing symbols and values and returns an integer of the enumeration msiEvaluateConditionErrorEnum.</span></span><br/>                                                                                                                          |
| [<span data-ttu-id="59ef7-123">**феатуреинфо**</span><span class="sxs-lookup"><span data-stu-id="59ef7-123">**FeatureInfo**</span></span>](session-featureinfo.md)             | <span data-ttu-id="59ef7-124">Возвращает объект [**феатуреинфо**](featureinfo-object.md) , содержащий описательные сведения для указанного компонента.</span><span class="sxs-lookup"><span data-stu-id="59ef7-124">Returns a [**FeatureInfo**](featureinfo-object.md) object containing descriptive information for the specified feature.</span></span><br/>                                                                                                                                       |
| [<span data-ttu-id="59ef7-125">**форматрекорд**</span><span class="sxs-lookup"><span data-stu-id="59ef7-125">**FormatRecord**</span></span>](session-formatrecord.md)           | <span data-ttu-id="59ef7-126">Возвращает отформатированную строку из шаблона и данных записи.</span><span class="sxs-lookup"><span data-stu-id="59ef7-126">Returns a formatted string from template and record data.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="59ef7-127">**Сообщение**</span><span class="sxs-lookup"><span data-stu-id="59ef7-127">**Message**</span></span>](session-message.md)                     | <span data-ttu-id="59ef7-128">Выполняет все включенные операции ведения журнала и откладывает выполнение объекта обработчика пользовательского интерфейса, связанного с ядром.</span><span class="sxs-lookup"><span data-stu-id="59ef7-128">Performs any enabled logging operations and defers execution to the UI handler object associated with the engine.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="59ef7-129">**Виртуализирован**</span><span class="sxs-lookup"><span data-stu-id="59ef7-129">**Sequence**</span></span>](session-sequence.md)                   | <span data-ttu-id="59ef7-130">Открывает запрос к указанной таблице, упорядочивая действия по числам в столбце последовательности.</span><span class="sxs-lookup"><span data-stu-id="59ef7-130">Opens a query on the specified table, ordering the actions by the numbers in the Sequence column.</span></span> <span data-ttu-id="59ef7-131">Для каждой выбранной строки вызывается метод [**DoAction**](session-doaction.md) при условии, что любое предоставленное выражение условия не возвращает значение false.</span><span class="sxs-lookup"><span data-stu-id="59ef7-131">For each row fetched, the [**DoAction**](session-doaction.md) method is called, provided that any supplied condition expression does not evaluate to False.</span></span><br/> |
| [<span data-ttu-id="59ef7-132">**сетинсталллевел**</span><span class="sxs-lookup"><span data-stu-id="59ef7-132">**SetInstallLevel**</span></span>](session-setinstalllevel.md)     | <span data-ttu-id="59ef7-133">Задает для текущей установки уровень установки указанного значения и повторно вычисляет выбор и установленные состояния для всех компонентов.</span><span class="sxs-lookup"><span data-stu-id="59ef7-133">Sets the install level for the current installation to a specified value and recalculates the Select and Installed states for all features.</span></span><br/>                                                                                                                    |



 

### <a name="properties"></a><span data-ttu-id="59ef7-134">Свойства</span><span class="sxs-lookup"><span data-stu-id="59ef7-134">Properties</span></span>

<span data-ttu-id="59ef7-135">Объект **сеанса** имеет следующие свойства.</span><span class="sxs-lookup"><span data-stu-id="59ef7-135">The **Session** object has these properties.</span></span>



| <span data-ttu-id="59ef7-136">Свойство</span><span class="sxs-lookup"><span data-stu-id="59ef7-136">Property</span></span>                                                                  | <span data-ttu-id="59ef7-137">Тип доступа</span><span class="sxs-lookup"><span data-stu-id="59ef7-137">Access type</span></span>           | <span data-ttu-id="59ef7-138">Описание</span><span class="sxs-lookup"><span data-stu-id="59ef7-138">Description</span></span>                                                                                                                                                                |
|:--------------------------------------------------------------------------|:----------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="59ef7-139">**компоненткостс**</span><span class="sxs-lookup"><span data-stu-id="59ef7-139">**ComponentCosts**</span></span>](session-componentcosts.md)<br/>               |                       | <span data-ttu-id="59ef7-140">Возвращает объект [**рекордлист**](recordlist-object.md) , перечисляющий место на диске, необходимое для установки компонента.</span><span class="sxs-lookup"><span data-stu-id="59ef7-140">Returns a [**RecordList**](recordlist-object.md) object enumerating the disk space per drive required to install a component.</span></span><br/>                                  |
| [<span data-ttu-id="59ef7-141">**компоненткуррентстате**</span><span class="sxs-lookup"><span data-stu-id="59ef7-141">**ComponentCurrentState**</span></span>](session-componentcurrentstate.md)<br/> |                       | <span data-ttu-id="59ef7-142">Возвращает текущее установленное состояние указанного компонента.</span><span class="sxs-lookup"><span data-stu-id="59ef7-142">Returns the current installed state of the designated component.</span></span><br/>                                                                                                |
| [<span data-ttu-id="59ef7-143">**компонентрекуестстате**</span><span class="sxs-lookup"><span data-stu-id="59ef7-143">**ComponentRequestState**</span></span>](session-componentrequeststate.md)<br/> |                       | <span data-ttu-id="59ef7-144">Получает или запрашивает изменение в состоянии действия строки в таблице Component.</span><span class="sxs-lookup"><span data-stu-id="59ef7-144">Obtains or requests a change in the Action state of a row in the Component table.</span></span><br/>                                                                               |
| [<span data-ttu-id="59ef7-145">**База данных**</span><span class="sxs-lookup"><span data-stu-id="59ef7-145">**Database**</span></span>](session-database.md)<br/>                           |                       | <span data-ttu-id="59ef7-146">Возвращает базу данных для текущего сеанса установки.</span><span class="sxs-lookup"><span data-stu-id="59ef7-146">Returns the database for the current installation session.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="59ef7-147">**феатурекост**</span><span class="sxs-lookup"><span data-stu-id="59ef7-147">**FeatureCost**</span></span>](session-featurecost.md)<br/>                     |                       | <span data-ttu-id="59ef7-148">Возвращает общий объем дискового пространства (в единицах 512 байт), требуемый для указанного компонента и его родительских компонентов (до корня таблицы компонентов).</span><span class="sxs-lookup"><span data-stu-id="59ef7-148">Returns the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the Feature table).</span></span><br/> |
| [<span data-ttu-id="59ef7-149">**феатурекуррентстате**</span><span class="sxs-lookup"><span data-stu-id="59ef7-149">**FeatureCurrentState**</span></span>](session-featurecurrentstate.md)<br/>     |                       | <span data-ttu-id="59ef7-150">Возвращает текущее установленное состояние указанного компонента.</span><span class="sxs-lookup"><span data-stu-id="59ef7-150">Returns the current installed state of the designated feature.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="59ef7-151">**феатуререкуестстате**</span><span class="sxs-lookup"><span data-stu-id="59ef7-151">**FeatureRequestState**</span></span>](session-featurerequeststate.md)<br/>     | <span data-ttu-id="59ef7-152">Чтение/запись</span><span class="sxs-lookup"><span data-stu-id="59ef7-152">Read/write</span></span><br/> | <span data-ttu-id="59ef7-153">Получает или запрашивает изменение в состоянии выбора записи функции и подзаписей.</span><span class="sxs-lookup"><span data-stu-id="59ef7-153">Obtains or requests a change in the Select state of a feature's record and subrecords.</span></span><br/>                                                                          |
| [<span data-ttu-id="59ef7-154">**феатуревалидстатес**</span><span class="sxs-lookup"><span data-stu-id="59ef7-154">**FeatureValidStates**</span></span>](session-featurevalidstates.md)<br/>       |                       | <span data-ttu-id="59ef7-155">Возвращает целое число, представляющее битовые флаги с каждым соответствующим битом, представляющим допустимое состояние установки для указанного компонента.</span><span class="sxs-lookup"><span data-stu-id="59ef7-155">Returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</span></span><br/>                             |
| [<span data-ttu-id="59ef7-156">**Установщик**</span><span class="sxs-lookup"><span data-stu-id="59ef7-156">**Installer**</span></span>](session-installer.md)<br/>                         |                       | <span data-ttu-id="59ef7-157">Возвращает активный объект установщика.</span><span class="sxs-lookup"><span data-stu-id="59ef7-157">Returns the active installer object.</span></span><br/>                                                                                                                            |
| [<span data-ttu-id="59ef7-158">**Язык (объект Session)**</span><span class="sxs-lookup"><span data-stu-id="59ef7-158">**Language (Session Object)**</span></span>](session-language.md)<br/>          |                       | <span data-ttu-id="59ef7-159">Представляет числовой идентификатор языка, используемый текущим сеансом установки.</span><span class="sxs-lookup"><span data-stu-id="59ef7-159">Represents the numeric language identifier used by the current installation session.</span></span><br/>                                                                            |
| [<span data-ttu-id="59ef7-160">**Режим**</span><span class="sxs-lookup"><span data-stu-id="59ef7-160">**Mode**</span></span>](session-mode.md)<br/>                                   |                       | <span data-ttu-id="59ef7-161">Это значение, представляющее назначенный флаг режима для текущего сеанса установки.</span><span class="sxs-lookup"><span data-stu-id="59ef7-161">This property is a value representing the designated mode flag for the current installation session.</span></span><br/>                                                            |
| [<span data-ttu-id="59ef7-162">**продуктпроперти**</span><span class="sxs-lookup"><span data-stu-id="59ef7-162">**ProductProperty**</span></span>](session-productproperty.md)<br/>             |                       | <span data-ttu-id="59ef7-163">Представляет строковое значение именованного свойства установщика.</span><span class="sxs-lookup"><span data-stu-id="59ef7-163">Represents the string value of a named installer property.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="59ef7-164">**Свойство (объект Session)**</span><span class="sxs-lookup"><span data-stu-id="59ef7-164">**Property (Session Object)**</span></span>](session-session.md)<br/>           | <span data-ttu-id="59ef7-165">Чтение/запись</span><span class="sxs-lookup"><span data-stu-id="59ef7-165">Read/write</span></span><br/> | <span data-ttu-id="59ef7-166">Получает свойства продукта из базы данных продукта.</span><span class="sxs-lookup"><span data-stu-id="59ef7-166">Retrieves product properties from the product database.</span></span><br/>                                                                                                         |
| [<span data-ttu-id="59ef7-167">**SourcePath**</span><span class="sxs-lookup"><span data-stu-id="59ef7-167">**SourcePath**</span></span>](session-sourcepath.md)<br/>                       |                       | <span data-ttu-id="59ef7-168">Предоставляет полный путь к указанной папке на исходном носителе или в образе сервера.</span><span class="sxs-lookup"><span data-stu-id="59ef7-168">Provides the full path to the designated folder on the source media or server image.</span></span><br/>                                                                            |
| [<span data-ttu-id="59ef7-169">**TargetPath**</span><span class="sxs-lookup"><span data-stu-id="59ef7-169">**TargetPath**</span></span>](session-targetpath.md)<br/>                       | <span data-ttu-id="59ef7-170">Чтение/запись</span><span class="sxs-lookup"><span data-stu-id="59ef7-170">Read/write</span></span><br/> | <span data-ttu-id="59ef7-171">Предоставляет полный путь к указанной папке на целевом диске установки.</span><span class="sxs-lookup"><span data-stu-id="59ef7-171">Provides the full path to the designated folder on the installation target drive.</span></span><br/>                                                                               |
| [<span data-ttu-id="59ef7-172">**верифидискспаце**</span><span class="sxs-lookup"><span data-stu-id="59ef7-172">**VerifyDiskSpace**</span></span>](session-verifydiskspace.md)<br/>             |                       | <span data-ttu-id="59ef7-173">Возвращает значение true, если на диске достаточно места, и значение false, если диск заполнен.</span><span class="sxs-lookup"><span data-stu-id="59ef7-173">Returns true if enough disk space exists, and false if the disk is full.</span></span><br/>                                                                                        |



 

## <a name="requirements"></a><span data-ttu-id="59ef7-174">Требования</span><span class="sxs-lookup"><span data-stu-id="59ef7-174">Requirements</span></span>



| <span data-ttu-id="59ef7-175">Требование</span><span class="sxs-lookup"><span data-stu-id="59ef7-175">Requirement</span></span> | <span data-ttu-id="59ef7-176">Значение</span><span class="sxs-lookup"><span data-stu-id="59ef7-176">Value</span></span> |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="59ef7-177">Версия</span><span class="sxs-lookup"><span data-stu-id="59ef7-177">Version</span></span><br/> | <span data-ttu-id="59ef7-178">Установщик Windows 5,0 в Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7.</span><span class="sxs-lookup"><span data-stu-id="59ef7-178">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="59ef7-179">Установщик Windows 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="59ef7-179">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="59ef7-180">установщик Windows в Windows Server 2003 или Windows XP</span><span class="sxs-lookup"><span data-stu-id="59ef7-180">Windows Installer on Windows Server 2003 or Windows XP</span></span><br/> |
| <span data-ttu-id="59ef7-181">DLL</span><span class="sxs-lookup"><span data-stu-id="59ef7-181">DLL</span></span><br/>     | <dl> <span data-ttu-id="59ef7-182"><dt>Msi.dll</dt></span><span class="sxs-lookup"><span data-stu-id="59ef7-182"><dt>Msi.dll</dt></span></span> </dl>                                                                                                                                                                      |
| <span data-ttu-id="59ef7-183">IID</span><span class="sxs-lookup"><span data-stu-id="59ef7-183">IID</span></span><br/>     | <span data-ttu-id="59ef7-184">IID \_ ISession определяется как 000C109E-0000-0000-C000-000000000046</span><span class="sxs-lookup"><span data-stu-id="59ef7-184">IID\_ISession is defined as 000C109E-0000-0000-C000-000000000046</span></span><br/>                                                                                                                                                                             |



## <a name="see-also"></a><span data-ttu-id="59ef7-185">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="59ef7-185">See also</span></span>

<dl> <dt>

[<span data-ttu-id="59ef7-186">Примеры сценариев установщик Windows</span><span class="sxs-lookup"><span data-stu-id="59ef7-186">Windows Installer Scripting Examples</span></span>](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




