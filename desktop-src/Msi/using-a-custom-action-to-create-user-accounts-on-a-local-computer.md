---
description: В этом примере показано, как использовать настраиваемые действия для создания учетных записей пользователей на локальном компьютере при установке компонента.
ms.assetid: fc06dd7b-46d7-45a0-85b3-26f808c64f89
title: Использование настраиваемого действия для создания учетных записей пользователей на локальном компьютере
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cfd3bf002c0fa1d661c6bfebb6d1a18cbc4b0652
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104346575"
---
# <a name="using-a-custom-action-to-create-user-accounts-on-a-local-computer"></a><span data-ttu-id="8b83e-103">Использование настраиваемого действия для создания учетных записей пользователей на локальном компьютере</span><span class="sxs-lookup"><span data-stu-id="8b83e-103">Using a Custom Action to Create User Accounts on a Local Computer</span></span>

<span data-ttu-id="8b83e-104">В этом примере показано, как использовать настраиваемые действия для создания учетных записей пользователей на локальном компьютере при установке компонента.</span><span class="sxs-lookup"><span data-stu-id="8b83e-104">This sample demonstrates how to use custom actions to create user accounts on a local computer when installing a component.</span></span> <span data-ttu-id="8b83e-105">При удалении компонента удаляются локальные учетные записи пользователей, созданные с помощью настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="8b83e-105">Removal of a component removes the local user accounts created by the custom action.</span></span> <span data-ttu-id="8b83e-106">Демонстрируются некоторые пользовательские действия, включая [отложенные пользовательские действия выполнения](deferred-execution-custom-actions.md) и [откат настраиваемых действий](rollback-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="8b83e-106">Several custom actions are demonstrated including [Deferred Execution Custom Actions](deferred-execution-custom-actions.md) and [Rollback Custom Actions](rollback-custom-actions.md).</span></span>

<span data-ttu-id="8b83e-107">Пример соответствует следующим спецификациям.</span><span class="sxs-lookup"><span data-stu-id="8b83e-107">The sample meets the following specifications.</span></span>

-   <span data-ttu-id="8b83e-108">При установке создаются учетные записи пользователей только при использовании Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="8b83e-108">The installation creates user accounts only if running Windows 2000.</span></span>
-   <span data-ttu-id="8b83e-109">Установка создает учетные записи пользователей только в том случае, если компонент устанавливается для локального запуска.</span><span class="sxs-lookup"><span data-stu-id="8b83e-109">The installation creates user accounts only if the component is being installed to run locally.</span></span> <span data-ttu-id="8b83e-110">Это исключает создание учетных записей пользователей во время восстановления или переустановки компонента.</span><span class="sxs-lookup"><span data-stu-id="8b83e-110">This precludes creating user accounts during the repair or reinstallation of the component.</span></span>
-   <span data-ttu-id="8b83e-111">Установщик удаляет учетные записи при удалении компонента.</span><span class="sxs-lookup"><span data-stu-id="8b83e-111">The Installer removes the accounts when the component is removed.</span></span>
-   <span data-ttu-id="8b83e-112">Данные учетной записи пользователя считываются из пользовательской таблицы в базе данных установки и не запрограммированы в коде настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="8b83e-112">User account information is read from a custom table in the installation database and is not hard-coded into the custom action code.</span></span>
-   <span data-ttu-id="8b83e-113">Поскольку для создания или удаления учетных записей пользователей требуются повышенные привилегии, некоторые из настраиваемых действий должны быть способны вносить изменения в систему, требующую повышенных привилегий.</span><span class="sxs-lookup"><span data-stu-id="8b83e-113">Because the creation or removal of user accounts requires elevated privileges, some of the custom actions must be capable of making changes to the system that require elevated privileges.</span></span> <span data-ttu-id="8b83e-114">Эти настраиваемые действия должны быть отложенными пользовательскими действиями, которые выполняются в скрипте выполнения.</span><span class="sxs-lookup"><span data-stu-id="8b83e-114">These custom actions must be deferred custom actions that run when in the execution script.</span></span>
-   <span data-ttu-id="8b83e-115">Каждая учетная запись имеет настраиваемое действие отката, чтобы гарантировать удаление учетной записи при откате установки компонента.</span><span class="sxs-lookup"><span data-stu-id="8b83e-115">Each account has a rollback custom action to ensure the account is removed on rollback of the component installation.</span></span> <span data-ttu-id="8b83e-116">Это не включает в себя откат удаления учетной записи во время удаления компонента.</span><span class="sxs-lookup"><span data-stu-id="8b83e-116">This does not include the rollback of an account deletion during the removal of a component.</span></span>
-   <span data-ttu-id="8b83e-117">Настраиваемые действия отправляют сообщения Актиондата для каждой создаваемой или удаляемой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="8b83e-117">Custom actions send ActionData messages for each account that is created or removed.</span></span> <span data-ttu-id="8b83e-118">Это не включает в себя предоставление сообщений о ходе выполнения для ProgressBar.</span><span class="sxs-lookup"><span data-stu-id="8b83e-118">This does not include providing progress messages for the ProgressBar.</span></span>
-   <span data-ttu-id="8b83e-119">Настраиваемые действия сообщают об ошибке, если учетная запись не может быть создана.</span><span class="sxs-lookup"><span data-stu-id="8b83e-119">Custom actions report an error if an account cannot be created.</span></span>
-   <span data-ttu-id="8b83e-120">Пароль учетной записи получается через взаимодействие пользователя с пользовательским интерфейсом или в случае установки на уровне Basic UI или без [интерфейса пользователя](user-interface-levels.md), как свойство, передаваемое в командной строке.</span><span class="sxs-lookup"><span data-stu-id="8b83e-120">The password for the account is obtained through the user interaction with the user interface, or in the case of an installation at the Basic UI or None [User Interface Levels](user-interface-levels.md), as a property passed on the command line.</span></span>
-   <span data-ttu-id="8b83e-121">Конфиденциальные данные скрываются из файла журнала.</span><span class="sxs-lookup"><span data-stu-id="8b83e-121">Sensitive data is hidden from the log file.</span></span>

<span data-ttu-id="8b83e-122">Пример включает гипотетический компонент с именем Тестаккаунт.</span><span class="sxs-lookup"><span data-stu-id="8b83e-122">The sample includes a hypothetical component named TestAccount.</span></span> <span data-ttu-id="8b83e-123">В обсуждении в следующих разделах предполагается, что вы уже создали ресурсы, необходимые для Тестаккаунт, и создали в образце базы данных необходимые для установки компонента таблицы [компонентов,](feature-table.md) [компонентов](component-table.md), [файлов](file-table.md), [каталогов](directory-table.md)и [феатурекомпонентс](featurecomponents-table.md) .</span><span class="sxs-lookup"><span data-stu-id="8b83e-123">The discussion in the following sections assumes that you have already created the resources required by TestAccount and have authored the [Feature](feature-table.md), [Component](component-table.md), [File](file-table.md), [Directory](directory-table.md), and [FeatureComponents](featurecomponents-table.md) tables in the sample database required to install this component.</span></span> <span data-ttu-id="8b83e-124">Дополнительные сведения см. [в примере установки](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="8b83e-124">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="8b83e-125">Следующие разделы содержат сведения о том, как создать необходимые настраиваемые действия и добавить их в пакет установки.</span><span class="sxs-lookup"><span data-stu-id="8b83e-125">The following topics contain information about how to create required custom actions and add them to an installation package.</span></span>

-   [<span data-ttu-id="8b83e-126">Создание настраиваемых действий</span><span class="sxs-lookup"><span data-stu-id="8b83e-126">Authoring the Custom Actions</span></span>](authoring-the-custom-actions.md)
-   [<span data-ttu-id="8b83e-127">Добавление пользовательской таблицы Кустомусераккаунтс</span><span class="sxs-lookup"><span data-stu-id="8b83e-127">Adding a Custom CustomUserAccounts Table</span></span>](adding-a-custom-customuseraccounts-table.md)
-   [<span data-ttu-id="8b83e-128">Создание таблицы CustomAction</span><span class="sxs-lookup"><span data-stu-id="8b83e-128">Authoring the CustomAction Table</span></span>](authoring-the-customaction-table.md)
-   [<span data-ttu-id="8b83e-129">Создание Актионтекст и таблиц ошибок</span><span class="sxs-lookup"><span data-stu-id="8b83e-129">Authoring the ActionText and Error Tables</span></span>](authoring-the-actiontext-and-error-tables.md)
-   [<span data-ttu-id="8b83e-130">Создание таблицы Инсталлексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="8b83e-130">Authoring the InstallExecuteSequence Table</span></span>](authoring-the-installexecutesequence-table.md)
-   [<span data-ttu-id="8b83e-131">Создание пользовательского интерфейса для ввода пароля</span><span class="sxs-lookup"><span data-stu-id="8b83e-131">Authoring the User Interface for Password Input</span></span>](authoring-the-user-interface-for-password-input.md)
-   [<span data-ttu-id="8b83e-132">Защита установки</span><span class="sxs-lookup"><span data-stu-id="8b83e-132">Securing the installation</span></span>](securing-the-installation.md)

 

 



