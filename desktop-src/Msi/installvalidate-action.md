---
description: Действие Инсталлвалидате проверяет, достаточно ли места для всех томов, на которые произошел атрибут cost. Действие Инсталлвалидате завершает установку с неустранимой ошибкой, если какой-либо из томов имеет небольшой объем места на диске.
ms.assetid: 1c55794d-1ecc-43bf-956f-96afc5f36964
title: Действие Инсталлвалидате
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e650ce136ac3b1b62e41ce34f79f5d28540d1292
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272066"
---
# <a name="installvalidate-action"></a><span data-ttu-id="efc8e-104">Действие Инсталлвалидате</span><span class="sxs-lookup"><span data-stu-id="efc8e-104">InstallValidate Action</span></span>

<span data-ttu-id="efc8e-105">Действие Инсталлвалидате проверяет, достаточно ли места для всех [*томов*](v-gly.md) , на которые произошел атрибут [*Cost*](c-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="efc8e-105">The InstallValidate action verifies that all [*volumes*](v-gly.md) to which [*cost*](c-gly.md) has been attributed have sufficient space for the installation.</span></span> <span data-ttu-id="efc8e-106">Действие Инсталлвалидате завершает установку с неустранимой ошибкой, если какой-либо из томов имеет небольшой объем места на диске.</span><span class="sxs-lookup"><span data-stu-id="efc8e-106">The InstallValidate action ends the installation with a fatal error if any volume is short of disk space.</span></span>

<span data-ttu-id="efc8e-107">Действие Инсталлвалидате также уведомляет пользователя, если один или несколько файлов для перезаписи или удаления в настоящее время используются активным процессом.</span><span class="sxs-lookup"><span data-stu-id="efc8e-107">The InstallValidate action also notifies the user if one or more files to be overwritten or removed are currently in use by an active process.</span></span> <span data-ttu-id="efc8e-108">Дополнительные сведения см. в разделе [перезагрузки системы](system-reboots.md).</span><span class="sxs-lookup"><span data-stu-id="efc8e-108">For more information, see [System Reboots](system-reboots.md).</span></span>

## <a name="sequence-restrictions"></a><span data-ttu-id="efc8e-109">Ограничения последовательности</span><span class="sxs-lookup"><span data-stu-id="efc8e-109">Sequence Restrictions</span></span>

<span data-ttu-id="efc8e-110">Действие [костфинализе](costfinalize-action.md) и все последовательности диалоговых окон пользовательского интерфейса, позволяющие пользователю изменять состояния выбора и каталоги, должны быть упорядочены перед действием инсталлвалидате.</span><span class="sxs-lookup"><span data-stu-id="efc8e-110">The [CostFinalize](costfinalize-action.md) action and any UI dialog box sequences that allow the user to modify selection states and/or directories should be sequenced before the InstallValidate action.</span></span>

<span data-ttu-id="efc8e-111">[Настраиваемые действия](custom-actions.md) , которые изменяют состояние установки компонентов или компонентов, должны быть упорядочены перед действием инсталлвалидате.</span><span class="sxs-lookup"><span data-stu-id="efc8e-111">[Custom actions](custom-actions.md) that change the installation state of features or components must be sequenced before the InstallValidate action.</span></span>

## <a name="actiondata-messages"></a><span data-ttu-id="efc8e-112">Сообщения Актиондата</span><span class="sxs-lookup"><span data-stu-id="efc8e-112">ActionData Messages</span></span>

<span data-ttu-id="efc8e-113">Нет сообщений Актиондата.</span><span class="sxs-lookup"><span data-stu-id="efc8e-113">There are no ActionData messages.</span></span>

## <a name="remarks"></a><span data-ttu-id="efc8e-114">Комментарии</span><span class="sxs-lookup"><span data-stu-id="efc8e-114">Remarks</span></span>

<span data-ttu-id="efc8e-115">Как правило, последовательность диалоговых окон более раннего пользователя должна выполнять ту же проверку, что и действие Инсталлвалидате, когда пользователь пытается инициировать копирование файлов.</span><span class="sxs-lookup"><span data-stu-id="efc8e-115">Typically, an earlier UI dialog box sequence should perform the same verification as the InstallValidate action when the user attempts to initiate the copying of files.</span></span> <span data-ttu-id="efc8e-116">Эта последовательность диалоговых окон пользовательского интерфейса должна показывать диалоговое окно " **недостаточно места на диске** ", если на выбранных томах недостаточно места для установки.</span><span class="sxs-lookup"><span data-stu-id="efc8e-116">This UI dialog box sequence should present an **Out of Disk Space** dialog box if the volumes selected do not have enough space for the installation.</span></span> <span data-ttu-id="efc8e-117">Диалоговые окна пользовательского интерфейса должны быть созданы таким образом, чтобы пользователь не пройдет установку, если на диске недостаточно места.</span><span class="sxs-lookup"><span data-stu-id="efc8e-117">The UI dialog boxes should be authored in a way to prevent the user from proceeding with the installation if there is insufficient disk space.</span></span> <span data-ttu-id="efc8e-118">В случае автоматической установки отсутствует пользовательский интерфейс, и действие Инсталлвалидате завершает установку, если на диске недостаточно места.</span><span class="sxs-lookup"><span data-stu-id="efc8e-118">In the case of a quiet installation, there is no user interface and the InstallValidate action terminates the installation if there is insufficient disk space.</span></span> <span data-ttu-id="efc8e-119">Причина преждевременного завершения записывается в файл журнала, если ведение журнала включено.</span><span class="sxs-lookup"><span data-stu-id="efc8e-119">The cause of the premature termination is recorded in the log file if logging is enabled.</span></span>

<span data-ttu-id="efc8e-120">Запись добавляется во внутреннюю таблицу Филесинусе, если какой-либо файл перезаписывается или удаляется, пока он открыт для выполнения или изменения любым процессом во время [*учета стоимости*](c-gly.md)файлов.</span><span class="sxs-lookup"><span data-stu-id="efc8e-120">An entry is added to an internal FilesInUse table if any file is overwritten or removed while it is open for execution or modification by any process during file [*costing*](c-gly.md).</span></span> <span data-ttu-id="efc8e-121">Таблица Филесинусе содержит столбцы для имени и полного пути к файлу.</span><span class="sxs-lookup"><span data-stu-id="efc8e-121">The FilesInUse table contains columns for the name and full path of the file.</span></span> <span data-ttu-id="efc8e-122">При выполнении действия Инсталлвалидате установщик запрашивает в таблице Филесинусе записи и определяет имя процесса с помощью файла.</span><span class="sxs-lookup"><span data-stu-id="efc8e-122">When the InstallValidate action executes, the installer queries the FilesInUse table for entries and determines the name of the process using the file.</span></span> <span data-ttu-id="efc8e-123">Действие Инсталлвалидате добавляет одну запись в таблицу пользовательского интерфейса [ListBox](listbox-table.md) для каждого уникального процесса, определенного этим запросом.</span><span class="sxs-lookup"><span data-stu-id="efc8e-123">The InstallValidate action adds one record to the [ListBox](listbox-table.md) user interface table for each unique process identified by this query.</span></span> <span data-ttu-id="efc8e-124">Запись содержит следующие значения в каждом столбце:</span><span class="sxs-lookup"><span data-stu-id="efc8e-124">The record contains the following values in each column:</span></span>

<span data-ttu-id="efc8e-125">**Свойство**: филеинусепроцесс</span><span class="sxs-lookup"><span data-stu-id="efc8e-125">**Property**: FileInUseProcess</span></span>

 

<span data-ttu-id="efc8e-126">**Значение**: *имя процесса* .</span><span class="sxs-lookup"><span data-stu-id="efc8e-126">**Value**: *Name of process*</span></span>

 

<span data-ttu-id="efc8e-127">**Text**: *текст, содержащийся в заголовке главного окна процесса*</span><span class="sxs-lookup"><span data-stu-id="efc8e-127">**Text**: *Text contained in the caption of the main window of the process*</span></span>

<span data-ttu-id="efc8e-128">Затем действие Инсталлвалидате отображает диалоговое окно **используемые файлы** .</span><span class="sxs-lookup"><span data-stu-id="efc8e-128">The InstallValidate action then displays the **Files In Use** dialog box.</span></span> <span data-ttu-id="efc8e-129">В этом диалоговом окне отображаются процессы, которые необходимо завершить, чтобы избежать необходимости перезапуска системы для замены используемых файлов.</span><span class="sxs-lookup"><span data-stu-id="efc8e-129">This dialog box displays the processes that must be shut down to avoid the requirement of restarting the system to replace files in use.</span></span>

<span data-ttu-id="efc8e-130">Действие Инсталлвалидате запрашивает таблицу [диалоговых](dialog-table.md) окон для созданного диалогового окна с зарезервированным именем [филесинусе](filesinuse-dialog.md) и отображает его.</span><span class="sxs-lookup"><span data-stu-id="efc8e-130">The InstallValidate action queries the [Dialog](dialog-table.md) table for an authored dialog box with the reserved name [FilesInUse](filesinuse-dialog.md) dialog and displays it.</span></span> <span data-ttu-id="efc8e-131">Это диалоговое окно должно содержать элемент управления [ListBox](listbox-control.md) , привязанный к свойству с именем филеинусепроцесс.</span><span class="sxs-lookup"><span data-stu-id="efc8e-131">This dialog box must contain a [ListBox](listbox-control.md) control that is tied to a property named FileInUseProcess.</span></span> <span data-ttu-id="efc8e-132">По соглашению в этом диалоговом окне есть кнопка **выйти**, **повторить** или **пропустить** , но это не тот автор пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="efc8e-132">By convention, this dialog box has an **Exit**, **Retry**, or **Ignore** button, but this is up to the UI author.</span></span> <span data-ttu-id="efc8e-133">Каждая кнопка должна быть привязана к таблице ControlEvent событие [EndDialog](enddialog-controlevent.md) в таблице [таблице ControlEvent событие](controlevent-table.md) .</span><span class="sxs-lookup"><span data-stu-id="efc8e-133">Each button should be tied to an [EndDialog](enddialog-controlevent.md) ControlEvent in the [ControlEvent](controlevent-table.md) table.</span></span> <span data-ttu-id="efc8e-134">Действие Инсталлвалидате реагирует следующим образом на значение, возвращенное [DoAction](doaction-controlevent.md) таблице ControlEvent событие, в соответствии с одним из этих аргументов [EndDialog](enddialog-controlevent.md) , связанных с кнопкой, отправленной пользователем:</span><span class="sxs-lookup"><span data-stu-id="efc8e-134">The InstallValidate action responds as follows to the value returned by the [DoAction](doaction-controlevent.md) ControlEvent, as dictated by one of these [EndDialog](enddialog-controlevent.md) arguments associated with the button pushed by the user:</span></span>

<span data-ttu-id="efc8e-135">**Повторная попытка**. все значения, добавленные в таблицу [ListBox](listbox-table.md) , очищаются, и вся хранимая процедура [*учета стоимости*](c-gly.md) файлов повторяется повторно, повторно проверяются на наличие файлов, которые еще используются.</span><span class="sxs-lookup"><span data-stu-id="efc8e-135">**Retry**: All values added to the [ListBox](listbox-table.md) table are cleared, and the entire file [*costing*](c-gly.md) procedure is repeated, rechecking for files that are still in use.</span></span> <span data-ttu-id="efc8e-136">Если один или несколько процессов по-прежнему определяются как использующие файлы для переписывания или удаления, процесс повторяется; в противном случае Инсталлвалидате возвращает управление в установщик с состоянием Мсидоактионстатуссукцесс.</span><span class="sxs-lookup"><span data-stu-id="efc8e-136">If one or more processes are still identified as using files to be overwritten or deleted, the process repeats; otherwise, InstallValidate returns control to the installer with a status of msiDoActionStatusSuccess.</span></span>

<span data-ttu-id="efc8e-137">**Выход**. действие инсталлвалидате немедленно возвращает управление в установщик с состоянием мсидоактионстатусусерексит.</span><span class="sxs-lookup"><span data-stu-id="efc8e-137">**Exit**: The InstallValidate action immediately returns control to the installer with a status of msiDoActionStatusUserExit.</span></span> <span data-ttu-id="efc8e-138">Это прерывает установку.</span><span class="sxs-lookup"><span data-stu-id="efc8e-138">This terminates the installation.</span></span>

<span data-ttu-id="efc8e-139">**Любое другое возвращаемое значение**. действие инсталлвалидате немедленно возвращает управление в установщик с состоянием мсидоактионстатуссукцесс.</span><span class="sxs-lookup"><span data-stu-id="efc8e-139">**Any other return value**: The InstallValidate action immediately returns control to the installer with a status of msiDoActionStatusSuccess.</span></span> <span data-ttu-id="efc8e-140">В этом случае, поскольку один или несколько файлов по-прежнему используются, последующие действия [инсталлфилес](installfiles-action.md) и (или) [инсталладминпаккаже](installadminpackage-action.md) должны запланировать, что используемые файлы будут заменены или удалены при перезапуске системы.</span><span class="sxs-lookup"><span data-stu-id="efc8e-140">In this case, since one or more files are still in use, the subsequent [InstallFiles](installfiles-action.md) and/or [InstallAdminPackage](installadminpackage-action.md) actions must schedule the in-use file(s) to be replaced or deleted when the system is restarted.</span></span>

<span data-ttu-id="efc8e-141">Если в базе данных нет таблицы [ListBox](listbox-table.md) , инсталлвалидате автоматически завершает работу без ошибки.</span><span class="sxs-lookup"><span data-stu-id="efc8e-141">If there is no [ListBox](listbox-table.md) table in the database, InstallValidate exits silently without an error.</span></span>

<span data-ttu-id="efc8e-142">Точка с запятой представляет собой разделитель списка для преобразований, источников и исправлений, и не должен использоваться в этих именах файлов или путях.</span><span class="sxs-lookup"><span data-stu-id="efc8e-142">The semicolon is the list delimiter for transforms, sources, and patches, and should not be used in these file names or paths.</span></span>

<span data-ttu-id="efc8e-143">Файлы, помеченные как доступные только для чтения в расположении только для чтения, никогда не считаются используемыми установщиком.</span><span class="sxs-lookup"><span data-stu-id="efc8e-143">Files marked read-only in a read-only location are never considered in use by the installer.</span></span>

<span data-ttu-id="efc8e-144">Для пользователя появляется диалоговое окно по умолчанию **нехватки места на диске** , содержащее кнопки **прервать** и **повторить** , если уровень пользовательского интерфейса является базовым.</span><span class="sxs-lookup"><span data-stu-id="efc8e-144">A default **Out of Disk Space** dialog box containing **Abort** and **Retry** buttons is presented to the user if the user interface level is basic.</span></span>

 

 



