---
description: Пакеты обновления установщик Windows могут быть созданы, чтобы обновления не устанавливались, если у пользователя уже установлена более новая версия.
ms.assetid: f46e82bd-70b3-46a2-8246-a1eadfdc589d
title: Предотвращать установку старого пакета более новой версией
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 320ab062c4ffbc740d85c59ece3d3baaa63f4209
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650692"
---
# <a name="preventing-an-old-package-from-installing-over-a-newer-version"></a>Предотвращение установки старого пакета более новой версией

Пакеты обновления установщик Windows могут быть созданы, чтобы обновления не устанавливались, если у пользователя уже установлена более новая версия. Процедура в этом разделе может только препятствовать переходу на более раннюю версию, которая может быть вызвана запуском основного пакета обновления. Эта процедура зависит от [действия финдрелатедпродуктс](findrelatedproducts-action.md), которое выполняется только при первой установке и не выполняется в режиме обслуживания (переустановка). Так как небольшие обновления выполняются с помощью повторной установки, эту процедуру нельзя использовать, чтобы определить, пытается ли понизить версию приложения с незначительным обновлением. Дополнительные сведения см. в разделе [Подготовка приложения к будущим основным обновлениям](preparing-an-application-for-future-major-upgrades.md).

**Предотвращение установки старого пакета более новой версией**

1.  Введите свойство [**UpgradeCode**](upgradecode.md) для группы связанных продуктов, которые могут получать это обновление, в столбец UpgradeCode [таблицы обновления](upgrade-table.md).
2.  Введите флаг **мсидбупградеаттрибутесонлидетект** bit в столбце Attributes [таблицы Upgrade](upgrade-table.md).
3.  Введите версию обновления, предоставленную этим пакетом, в столбец Версионмин [таблицы Upgrade](upgrade-table.md). Оставьте столбец Версионмакс пустым.
4.  Введите имя свойства, которое должно быть задано [действием финдрелатедпродуктс](findrelatedproducts-action.md) , в столбец Актионпроперти [таблицы Upgrade](upgrade-table.md).
5.  Добавьте свойство [**секурекустомпропертиес**](securecustomproperties.md) и свойство с именем в столбец Актионпроперти [таблицы Upgrade](upgrade-table.md) в [таблицу свойств](property-table.md).
6.  Добавьте [тип настраиваемого действия 19](custom-action-type-19.md) после действия Финдрелатедпродуктс в [таблице инсталлексекутесекуенце](installexecutesequence-table.md). Включите запись в [таблицу CustomAction](customaction-table.md) для этого действия и введите текст, который будет отображаться в целевом столбце. Настраиваемое действие типа 19 встроено в установщик, поэтому код для записи отсутствует.
7.  Введите имя Актионпроперти в столбец Условие записи в [таблице инсталлексекутесекуенце](installexecutesequence-table.md) , которая содержит [тип настраиваемого действия 19](custom-action-type-19.md). Это условие позволяет выполнить пользовательское действие только в том случае, если в [таблице обновления](upgrade-table.md) обнаруживается, что уже установлена более новая версия.

    Например, пакет установщик Windows, который обновляет группу связанных продуктов до версии 3,0, может включать в себя следующие записи в своих таблицах [обновления](upgrade-table.md), [CustomAction](customaction-table.md), [инсталлексекутесекуенце](installexecutesequence-table.md)и [свойств](property-table.md) . Все связанные продукты в группе имеют одно и то же значение UpgradeCode, но установщик не устанавливает этот пакет обновления, если на компьютере уже установлена более поздняя версия, чем 3,0. В этом случае установщик выводит сообщение об ошибке, и установка завершается сбоем. Пакет обновления версии 3,0 устанавливает более ранние версии, чем 1,0 и 2,0.

    [Обновление таблицы](upgrade-table.md)

    

    | UpgradeCode                            | версионмин | версионмакс | Язык | Атрибуты                                | Удалить | актионпроперти  |
    |----------------------------------------|------------|------------|----------|-------------------------------------------|--------|-----------------|
    | {E7BE6D45-49FF-4701-A17E-BDCC98CE180D} | 3.0        |            |          | мсидбупградеаттрибутесонлидетект          |        | невпродуктфаунд |
    | {E7BE6D45-49FF-4701-A17E-BDCC98CE180D} | 1.0        | 3.0        |          | мсидбупградеаттрибутесверсионмининклусиве |        | упградефаунд    |

    

     

    [Таблица CustomAction](customaction-table.md)

    

    | Действие | Тип | Источник | Назначение                                 |
    |--------|------|--------|----------------------------------------|
    | CA1    | 19   |        | Уже установлено более высокое обновление. |

    

     

    [Таблица Инсталлексекутесекуенце](installexecutesequence-table.md)

    

    | Действие              | Условие       | Последовательность |
    |---------------------|-----------------|----------|
    | финдрелатедпродуктс |                 | 200      |
    | CA1                 | невпродуктфаунд | 201      |

    

     

    [Таблица свойств](property-table.md)

    

    | Свойство                                                 | Значение                        |
    |----------------------------------------------------------|------------------------------|
    | [**секурекустомпропертиес**](securecustomproperties.md) | НЕВПРОДУКТФАУНД; упградефаунд |

    

     

 

 



