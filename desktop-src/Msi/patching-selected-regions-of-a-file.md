---
description: При внесении исправлений в файлы с переменным содержимым может потребоваться хранить выбранные регионы целевого файла, чтобы предотвратить потерю критически важных данных.
ms.assetid: 4a610588-556e-489f-ac14-73e5e6b776fe
title: Исправление выбранных регионов файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 778df4b0cc98eeacd1106929b18c7461c6fa9e70
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650616"
---
# <a name="patching-selected-regions-of-a-file"></a><span data-ttu-id="f9d76-103">Исправление выбранных регионов файла</span><span class="sxs-lookup"><span data-stu-id="f9d76-103">Patching Selected Regions of a File</span></span>

<span data-ttu-id="f9d76-104">При внесении исправлений в файлы с переменным содержимым может потребоваться хранить выбранные регионы целевого файла, чтобы предотвратить потерю критически важных данных.</span><span class="sxs-lookup"><span data-stu-id="f9d76-104">When patching files having variable content, it may be necessary to retain selected regions of the target file to prevent the lost of critical information.</span></span> <span data-ttu-id="f9d76-105">Например, некоторые приложения отделяют сведения о пользователях в исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="f9d76-105">For example, some applications stamp user information into the executable file.</span></span> <span data-ttu-id="f9d76-106">Поскольку содержимое целевого файла может зависеть от компьютера, на котором установлено приложение, становится трудно определить, является ли конкретный файл допустимым целевым объектом для данного исправления.</span><span class="sxs-lookup"><span data-stu-id="f9d76-106">Because the contents of the target file might depend upon the computer on which the application is installed, it becomes difficult to determine whether a particular file is a valid target for the patch.</span></span> <span data-ttu-id="f9d76-107">Сведения о пользователях, записанные в целевой файл, также могут быть перезаписаны с помощью исправления.</span><span class="sxs-lookup"><span data-stu-id="f9d76-107">User information written in the target file can also be overwritten by a patch.</span></span>

<span data-ttu-id="f9d76-108">При создании файла свойств создания исправления (PCP) с [Msimsp.exe](msimsp-exe.md) и [PATCHWIZ.DLL](patchwiz-dll.md)можно указать, что во время установки исправления сведения в определенных регионах целевого файла будут игнорироваться.</span><span class="sxs-lookup"><span data-stu-id="f9d76-108">When you generate a patch creation properties (PCP) file with [Msimsp.exe](msimsp-exe.md) and [PATCHWIZ.DLL](patchwiz-dll.md), you can specify that the information in certain regions of the target file be ignored during patching.</span></span> <span data-ttu-id="f9d76-109">Можно также указать, что сведения в других регионах целевого файла будут сохранены и скопированы в расположение смещения в обновленном файле.</span><span class="sxs-lookup"><span data-stu-id="f9d76-109">You can also specify that information in other regions of the target file be retained and copied to an offset location in the updated file.</span></span> <span data-ttu-id="f9d76-110">Вы указываете, какие регионы целевого файла следует игнорировать, и какие регионы следует хранить при создании таблиц [Таржетфилес оптионалдата](targetfiles-optionaldata-table-patchwiz-dll-.md), [екстерналфилес](externalfiles-table-patchwiz-dll-.md)и [фамилифилеранжес](familyfileranges-table-patchwiz-dll-.md) .</span><span class="sxs-lookup"><span data-stu-id="f9d76-110">You specify which regions of the target file to ignore and which regions to retain when authoring the [TargetFiles OptionalData](targetfiles-optionaldata-table-patchwiz-dll-.md), [ExternalFiles](externalfiles-table-patchwiz-dll-.md), and [FamilyFileRanges](familyfileranges-table-patchwiz-dll-.md) tables.</span></span>

<span data-ttu-id="f9d76-111">Используйте столбец Ретаиноффсетс таблицы [Таржетфилес оптионалдата](targetfiles-optionaldata-table-patchwiz-dll-.md) и столбцы Ретаиноффсетс и Ретаинленгсс таблицы [фамилифилеранжес](familyfileranges-table-patchwiz-dll-.md) , чтобы скопировать диапазон данных из целевого файла в диапазон смещения в обновленном файле.</span><span class="sxs-lookup"><span data-stu-id="f9d76-111">Use the RetainOffsets column of the [TargetFiles OptionalData](targetfiles-optionaldata-table-patchwiz-dll-.md) table and the RetainOffsets and RetainLengths columns of the [FamilyFileRanges](familyfileranges-table-patchwiz-dll-.md) table to copy a range of information from the target file to an offset range in the updated file.</span></span> <span data-ttu-id="f9d76-112">Информация в этом диапазоне сохраняется.</span><span class="sxs-lookup"><span data-stu-id="f9d76-112">The information in this range is retained.</span></span> <span data-ttu-id="f9d76-113">Укажите длину диапазона, используя столбцы Ретаинленгсс таблицы Фамилифилеранжес.</span><span class="sxs-lookup"><span data-stu-id="f9d76-113">Specify the length of the range using the RetainLengths columns of the FamilyFileRanges table.</span></span> <span data-ttu-id="f9d76-114">Длина сохраняемого диапазона одинакова в целевом и обновленном файлах.</span><span class="sxs-lookup"><span data-stu-id="f9d76-114">The length of the retained range is the same in the target and updated files.</span></span> <span data-ttu-id="f9d76-115">Укажите смещение диапазона в целевом файле с помощью столбца Ретаиноффсетс таблицы Таржетфилес Оптионалдата.</span><span class="sxs-lookup"><span data-stu-id="f9d76-115">Specify the offset of the range in the target file using the RetainOffsets column of the TargetFiles OptionalData table.</span></span> <span data-ttu-id="f9d76-116">Укажите смещение диапазона в обновленном файле с помощью столбца Ретаиноффсетс таблицы Фамилифилеранжес.</span><span class="sxs-lookup"><span data-stu-id="f9d76-116">Specify the offset of the range in the updated file using the RetainOffsets column of the FamilyFileRanges table.</span></span> <span data-ttu-id="f9d76-117">Таким образом, диапазон сохраняемого целевого файла является значением Ретаиноффсетс в таблице Таржетфилес Оптионалдата и Ретаинленгсс.</span><span class="sxs-lookup"><span data-stu-id="f9d76-117">The range of the target file retained is therefore the value of RetainOffsets in the TargetFiles OptionalData table plus RetainLengths.</span></span> <span data-ttu-id="f9d76-118">Эти сведения копируются в файл обновления в диапазоне, заданном значением Ретаиноффсетс в таблицах Фамилифилеранжес и Ретаинленгсс.</span><span class="sxs-lookup"><span data-stu-id="f9d76-118">This information gets copied to the update file in the range given by the value of RetainOffsets in the FamilyFileRanges tables plus RetainLengths.</span></span> <span data-ttu-id="f9d76-119">Можно указать несколько диапазонов, но порядок их длин должен совпадать с порядком смещений.</span><span class="sxs-lookup"><span data-stu-id="f9d76-119">You can specify multiple ranges but the order of the lengths must match the order of the offsets.</span></span>

<span data-ttu-id="f9d76-120">Используйте таблицу [Таржетфилес оптионалдата](targetfiles-optionaldata-table-patchwiz-dll-.md) для пропуска диапазона целевого файла.</span><span class="sxs-lookup"><span data-stu-id="f9d76-120">Use the [TargetFiles OptionalData](targetfiles-optionaldata-table-patchwiz-dll-.md) table to ignore a range of the target file.</span></span> <span data-ttu-id="f9d76-121">Сведения в этом диапазоне целевого файла по-прежнему могут быть перезаписаны исправлением.</span><span class="sxs-lookup"><span data-stu-id="f9d76-121">Information in this range of the target file can still be overwritten by the patch.</span></span> <span data-ttu-id="f9d76-122">Укажите смещение диапазона в столбце Игнореоффсетс и его длину в столбце Игнореленгсс.</span><span class="sxs-lookup"><span data-stu-id="f9d76-122">Specify the offset of the range in the IgnoreOffsets column and its length in the IgnoreLengths column.</span></span> <span data-ttu-id="f9d76-123">Можно указать несколько диапазонов, но порядок их длин должен совпадать с порядком смещений.</span><span class="sxs-lookup"><span data-stu-id="f9d76-123">You can specify multiple ranges but the order of the lengths must match the order of the offsets.</span></span>

<span data-ttu-id="f9d76-124">Значения в столбцах length и offset могут быть десятичными или шестнадцатеричными.</span><span class="sxs-lookup"><span data-stu-id="f9d76-124">The values in the lengths and offsets columns can be decimal or hexadecimal.</span></span> <span data-ttu-id="f9d76-125">[PATCHWIZ.DLL](patchwiz-dll.md) считает значение шестнадцатеричным, если оно имеет префикс 0x.</span><span class="sxs-lookup"><span data-stu-id="f9d76-125">[PATCHWIZ.DLL](patchwiz-dll.md) treats the value as hexadecimal if it is prefixed by "0x".</span></span> <span data-ttu-id="f9d76-126">Столбцы являются строковыми столбцами, поэтому PATCHWIZ.DLL преобразует значения в ULONG.</span><span class="sxs-lookup"><span data-stu-id="f9d76-126">The columns are string columns, so PATCHWIZ.DLL converts the values to ULONGs.</span></span> <span data-ttu-id="f9d76-127">Столбец length указывает длину в байтах.</span><span class="sxs-lookup"><span data-stu-id="f9d76-127">The length column specifies the length in bytes.</span></span>

 

 



