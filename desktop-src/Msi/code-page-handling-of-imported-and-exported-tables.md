---
description: Вы можете добавить сведения о локализации в базу данных установки, импортировав и экспортировав текстовые архивные файлы ASCII с помощью Мсидатабасикспорт и Мсидатабасеимпорт.
ms.assetid: dc52313b-38e7-43cc-abfd-86966c836fce
title: Обработка кодовой страницы импортированных и экспортированных таблиц
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b090bead1fa35b451ed12e0e0da0143b98b8918
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662592"
---
# <a name="code-page-handling-of-imported-and-exported-tables"></a>Обработка кодовой страницы импортированных и экспортированных таблиц

Вы можете добавить сведения о локализации в базу данных установки, импортировав и экспортировав текстовые архивные файлы ASCII с помощью [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) и [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta). Поскольку пул строк базы данных использует кодовую страницу ANSI, то как база данных, так и экспортированные [текстовые архивные файлы](text-archive-files.md) содержат кодовые страницы.

При экспорте [файла текстового архива](text-archive-files.md) из базы данных кодовая страница файла архива совпадает с родительской базой данных. Список страниц с числовыми кодовыми номерами см. в разделе [Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md).

> [!Note]  
> При экспорте таблицы в текстовый файл архива преобразуются управляющие символы, чтобы избежать конфликтов с разделителями файлов.

 

## <a name="ascii-text-archive-files"></a>Текстовые архивные файлы ASCII

[Текстовые архивные файлы](text-archive-files.md) ASCII, экспортированные с помощью [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) , объясняются в следующем формате:

-   Имена столбцов таблицы записываются в первой строке.
-   Форматы столбцов записываются во второй строке.
-   Если таблица содержит только данные ASCII, третья строка текстового файла представляет собой имя таблицы, за которым следует список первичных ключей.
-   Если таблица содержит данные, не входящие в набор ASCII, а база данных помечена цифровой кодовой страницей, номер кодовой страницы отображается в начале третьей строки.
-   Если база данных содержит данные, не входящие в набор ASCII, но база данных не помечена цифровой кодовой страницей, номер текущей системной кодовой страницы записывается в начале третьей строки.
-   Остальные строки текстового файла — это данные в указанной кодовой странице.
-   Если таблица содержит потоки, [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) экспортирует каждый поток в таблице в отдельный файл.

### <a name="neutral-and-non-neutral-code-pages"></a>Нейтральные и ненейтральные кодовые страницы

Локализацию можно упростить, начав с базы данных со нейтральной кодовой страницей:

-   Пустая база данных имеет нейтральную кодовую страницу.
-   База данных, которая не содержит расширенные символы, требующие представления кодовой страницы в коде ASCII, имеет нейтральную кодовую страницу.

Дополнительные сведения см. в разделе [Создание базы данных с нейтральной кодовой страницей](creating-a-database-with-a-neutral-code-page.md).

Нейтральные и ненейтральные кодовые страницы имеют следующие характеристики.

-   Если [файл текстового архива](text-archive-files.md) с ненейтральной кодовой страницей импортируется в базу данных с другой ненейтральной кодовой страницей, то установщик возвращает ошибку при вызове [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) .
-   [Файл текстового архива](text-archive-files.md) с нейтральной кодовой страницей можно импортировать в базу данных с любой кодовой страницей.
-   [Файл текстового архива](text-archive-files.md) с любой кодовой страницей можно импортировать в базу данных с нейтральной кодовой страницей.
-   При импорте [текстового файла архива](text-archive-files.md) в базу данных с нейтральной кодовой страницей кодовая страница базы данных задается кодовой страницей файла архива. Все архивные файлы, которые впоследствии импортируются в базу данных, должны иметь ту же кодовую страницу, что и первый файл.

Дополнительные сведения см. в разделе [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md) и [Установка кодовой страницы базы данных](setting-the-code-page-of-a-database.md).

[Файлы архивов](text-archive-files.md) , экспортированные [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) , можно использовать с системами управления версиями. Для изменения базы данных используйте [функции базы данных](database-functions.md) или редактор таблиц базы данных.

Сведения о локализации можно добавить в базу данных установки с помощью редактора таблиц базы данных или API установщик Windows. Дополнительные сведения см. в разделе [Обработка кодовых страниц строк параметров](code-page-handling-of-parameter-strings.md).

 

 



