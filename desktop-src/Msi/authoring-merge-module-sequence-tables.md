---
description: Включите таблицы Мержемодулесекуенце в файл MSM, если модуль слияния должен изменить таблицы последовательности действий в файле Target. msi. При слиянии эти таблицы не добавляются в MSI файл. Эти таблицы происходят только в модулях слияния.
ms.assetid: 9efb75d2-43f9-404c-8e7f-918d056190cf
title: Создание таблиц последовательности для модуля слияния
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24b21780601e626c006967cefa0dcff5700bdec4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103998274"
---
# <a name="authoring-merge-module-sequence-tables"></a><span data-ttu-id="ebe5f-105">Создание таблиц последовательности для модуля слияния</span><span class="sxs-lookup"><span data-stu-id="ebe5f-105">Authoring Merge Module Sequence Tables</span></span>

<span data-ttu-id="ebe5f-106">Включите таблицы Мержемодулесекуенце в файл MSM, если модуль слияния должен изменить [*таблицы последовательности*](s-gly.md) действий в файле Target. msi.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-106">Include the MergeModuleSequence tables in the .msm file if the merge module must modify the action [*sequence tables*](s-gly.md) of the target .msi file.</span></span> <span data-ttu-id="ebe5f-107">При слиянии эти таблицы не добавляются в MSI файл.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-107">Merging does not add these tables to the .msi file.</span></span> <span data-ttu-id="ebe5f-108">Эти таблицы происходят только в модулях слияния.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-108">These tables only occur in merge modules.</span></span>

<span data-ttu-id="ebe5f-109">Если в файле MSM имеются какие бы то ни было таблицы Модулесекуенце, то в модуль слияния необходимо также создать пустую копию соответствующей таблицы последовательности установщика.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-109">If any of the ModuleSequence tables are present in an .msm file, an empty copy of the corresponding installer sequence table must also be authored into the merge module.</span></span> <span data-ttu-id="ebe5f-110">Например, если модуль слияния содержит таблицу Модулеадминексекутесекуенце, то модуль слияния также должен включать пустую таблицу Админексекутесекуенце.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-110">For example, if a merge module contains a ModuleAdminExecuteSequence table, the merge module must also include an empty AdminExecuteSequence table.</span></span> <span data-ttu-id="ebe5f-111">Во время слияния эти пустые таблицы предоставляют средство слияния с необходимыми рекомендациями по схеме.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-111">During a merge, these empty tables provide the merge tool with necessary schema guidelines.</span></span>

<span data-ttu-id="ebe5f-112">При использовании [стандартных действий](standard-actions.md) в таблицах последовательности модулей слияния значением в столбце последовательности должен быть рекомендуемый порядковый номер действия для стандартного действия.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-112">When using [standard actions](standard-actions.md) in merge module sequence tables, the value in the Sequence column should be the recommended action sequence number for the standard action.</span></span> <span data-ttu-id="ebe5f-113">Рекомендуемые порядковые номера в каждой таблице последовательностей см. в приведенных ниже последовательностях действий.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-113">See the suggested action sequences given below for the recommended sequence numbers in each sequence table.</span></span> <span data-ttu-id="ebe5f-114">Если порядковый номер в таблице последовательности модулей слияния отличается от порядкового номера для того же действия в MSI – файле, то средство слияния использует порядковый номер в MSI File во время слияния.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-114">If the sequence number in the merge module sequence table differs from the sequence number for the same action in the .msi file, the merge tool uses the sequence number in the .msi file during the merge.</span></span>



| <span data-ttu-id="ebe5f-115">Таблица Мержемодулесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-115">MergeModuleSequence table</span></span>                                                    | <span data-ttu-id="ebe5f-116">Рекомендуемые последовательности действий</span><span class="sxs-lookup"><span data-stu-id="ebe5f-116">Recommended action sequences</span></span>                                             |
|------------------------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="ebe5f-117">модулеадминуисекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-117">ModuleAdminUISequence</span></span>](moduleadminuisequence-table.md)                     | [<span data-ttu-id="ebe5f-118">Предложенные Админуисекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-118">Suggested AdminUISequence</span></span>](suggested-adminuisequence.md)               |
| [<span data-ttu-id="ebe5f-119">модулеадминексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-119">ModuleAdminExecuteSequence</span></span>](moduleadminexecutesequence-table.md)           | [<span data-ttu-id="ebe5f-120">Предложенные Админексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-120">Suggested AdminExecuteSequence</span></span>](suggested-adminexecutesequence.md)     |
| [<span data-ttu-id="ebe5f-121">модулеадвтуисекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-121">ModuleAdvtUISequence</span></span>](moduleadvtuisequence-table.md)                       | [<span data-ttu-id="ebe5f-122">Предложенные Адвтуисекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-122">Suggested AdvtUISequence</span></span>](suggested-advtuisequence.md)                 |
| [<span data-ttu-id="ebe5f-123">модулеадвтексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-123">ModuleAdvtExecuteSequence</span></span>](moduleadvtexecutesequence-table.md)             | [<span data-ttu-id="ebe5f-124">Предложенные Адвтексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-124">Suggested AdvtExecuteSequence</span></span>](suggested-advtexecutesequence.md)       |
| [<span data-ttu-id="ebe5f-125">модулеинсталлуисекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-125">ModuleInstallUISequence</span></span>](moduleinstalluisequence-table.md)                 | [<span data-ttu-id="ebe5f-126">Предложенные Инсталлуисекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-126">Suggested InstallUISequence</span></span>](suggested-installuisequence.md)           |
| [<span data-ttu-id="ebe5f-127">Таблица Модулеинсталлексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-127">ModuleInstallExecuteSequence table</span></span>](moduleinstallexecutesequence-table.md) | [<span data-ttu-id="ebe5f-128">Предложенные Инсталлексекутесекуенце</span><span class="sxs-lookup"><span data-stu-id="ebe5f-128">Suggested InstallExecuteSequence</span></span>](suggested-installexecutesequence.md) |



 

<span data-ttu-id="ebe5f-129">Если в столбце Action таблицы последовательности модуля слияния используется [стандартное действие](standard-actions.md) , то столбцы Басеактион и After этой записи должны иметь значение null.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-129">If a [standard action](standard-actions.md) is used in the Action column of a merge module sequence table, the BaseAction and After columns of that record must be Null.</span></span>

<span data-ttu-id="ebe5f-130">Если пользовательское действие или диалоговое окно задано в столбце действие, то столбец последовательности должен иметь значение null.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-130">If a custom action or dialog is entered into the Action column, the Sequence column must be Null.</span></span>

<span data-ttu-id="ebe5f-131">Если в столбец Action помещается действие, возвращающее флаг завершения, то столбец Sequence должен содержать отрицательное значение для этого флага, а столбцы Басеактион и After этой записи должны иметь значение null.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-131">If an action returning a termination flag is entered into the Action column, the Sequence column should contain the negative value for that flag and the BaseAction and After columns of that record must be Null.</span></span> <span data-ttu-id="ebe5f-132">Следующие отрицательные значения указывают, что действие вызывается, если установщик возвращает флаг завершения.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-132">The following negative values indicate that the action is called if the installer returns the termination flag.</span></span>



| <span data-ttu-id="ebe5f-133">Флаг завершения</span><span class="sxs-lookup"><span data-stu-id="ebe5f-133">Termination flag</span></span>          | <span data-ttu-id="ebe5f-134">Значение</span><span class="sxs-lookup"><span data-stu-id="ebe5f-134">Value</span></span> | <span data-ttu-id="ebe5f-135">Описание</span><span class="sxs-lookup"><span data-stu-id="ebe5f-135">Description</span></span>              |
|---------------------------|-------|--------------------------|
| <span data-ttu-id="ebe5f-136">мсидоактионстатуссукцесс</span><span class="sxs-lookup"><span data-stu-id="ebe5f-136">msiDoActionStatusSuccess</span></span>  | <span data-ttu-id="ebe5f-137">-1</span><span class="sxs-lookup"><span data-stu-id="ebe5f-137">-1</span></span>    | <span data-ttu-id="ebe5f-138">Успешное завершение.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-138">Successful completion.</span></span>   |
| <span data-ttu-id="ebe5f-139">мсидоактионстатусусерексит</span><span class="sxs-lookup"><span data-stu-id="ebe5f-139">msiDoActionStatusUserExit</span></span> | <span data-ttu-id="ebe5f-140">-2</span><span class="sxs-lookup"><span data-stu-id="ebe5f-140">-2</span></span>    | <span data-ttu-id="ebe5f-141">Пользователь завершает установку.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-141">User terminates install.</span></span> |
| <span data-ttu-id="ebe5f-142">мсидоактионстатусфаилуре</span><span class="sxs-lookup"><span data-stu-id="ebe5f-142">msiDoActionStatusFailure</span></span>  | <span data-ttu-id="ebe5f-143">–3</span><span class="sxs-lookup"><span data-stu-id="ebe5f-143">-3</span></span>    | <span data-ttu-id="ebe5f-144">Неустранимое завершение работы.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-144">Fatal exit terminates.</span></span>   |
| <span data-ttu-id="ebe5f-145">мсидоактионстатуссуспенд</span><span class="sxs-lookup"><span data-stu-id="ebe5f-145">msiDoActionStatusSuspend</span></span>  | <span data-ttu-id="ebe5f-146">–4</span><span class="sxs-lookup"><span data-stu-id="ebe5f-146">-4</span></span>    | <span data-ttu-id="ebe5f-147">Установка приостановлена.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-147">Install is suspended.</span></span>    |



 

<span data-ttu-id="ebe5f-148">Столбец Басеактион может содержать стандартное действие, пользовательское действие, указанное в пользовательской таблице действий модуля слияния, или диалоговое окно, указанное в таблице диалогового окна модуля.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-148">The BaseAction column can contain a standard action, a custom action specified in the merge module's custom action table, or a dialog specified in the module's dialog table.</span></span> <span data-ttu-id="ebe5f-149">Столбец Басеактион является ключом в столбце Action этой таблицы.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-149">The BaseAction column is a key into the Action column of this table.</span></span> <span data-ttu-id="ebe5f-150">Он не может быть внешним ключом в другой таблице слияния или таблице в MSI-файле.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-150">It cannot be a foreign key into another merge table or table in the .msi file.</span></span> <span data-ttu-id="ebe5f-151">Это означает, что каждое стандартное действие, настраиваемое действие или диалоговое окно, перечисленные в столбце Басеактион, также должны быть перечислены в столбце Action другой записи в этой таблице.</span><span class="sxs-lookup"><span data-stu-id="ebe5f-151">This means that every standard action, custom action, or dialog listed in the BaseAction column must also be listed in the Action column of another record in this table.</span></span>

 

 



