---
description: Параллельные установки, также называемые вложенными установками, являются устаревшей функцией установщик Windows.
ms.assetid: 579ae4ee-47a0-440e-81ca-ea8bf60c5349
title: Параллельные установки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d89f2ef4af062c8151935fefab471603f79d7633
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103910987"
---
# <a name="concurrent-installations"></a>Параллельные установки

Параллельные установки, также называемые вложенными установками, являются устаревшей функцией установщик Windows. Приложения, установленные с параллельными установками, в итоге могут завершаться сбоем, так как они трудно обслуживать правильно. Не используйте параллельные установки для установки продуктов, предназначенных для выпуска в общедоступной версии. Параллельные установки могут иметь ограниченную применимость в контролируемых корпоративных средах при использовании для установки приложений, которые не предназначены для общедоступного выпуска. Документация по параллельным установкам предназначена для авторов пакетов, которые хотят использовать параллельные установки с приложениями, которые не предназначены для общедоступного распространения.

Одновременное действие установки устанавливает другой пакет установщик Windows во время выполнения установки. Параллельная установка добавляется в пакет путем создания одновременных действий установки в [таблице CustomAction](customaction-table.md) и планирования этого настраиваемого действия в таблицах последовательности. Целевое поле таблицы CustomAction содержит строку параметров общедоступного свойства, используемых параллельной установкой. Поле источника в таблице CustomAction определяет параллельный пакет. Одновременное действие установки может переустановить или удалить приложение, установленное с помощью пакета установки текущего приложения.

Тип одновременных операций установки указывается в поле Тип таблицы CustomAction. В зависимости от типа настраиваемого действия пакет для параллельного приложения может находиться во внешнем хранилище основного пакета, в виде файла в расположении, указанном свойством, или в виде объявленного приложения на компьютере пользователя. Следующие типы настраиваемых действий выполняют параллельную установку.



| Тип настраиваемого действия                                 | Описание                                                                     |
|----------------------------------------------------|---------------------------------------------------------------------------------|
| [Тип настраиваемого действия 7](custom-action-type-7.md)   | Параллельная установка продукта, находящегося в пакете установки.      |
| [Тип настраиваемого действия 23](custom-action-type-23.md) | Параллельная установка пакета установщика в текущем исходном дереве. |
| [Тип настраиваемого действия 39](custom-action-type-39.md) | Параллельная установка объявленного пакета установщика.                     |



 

Параллельная установка использует один и тот же пользовательский интерфейс и параметры ведения журнала в качестве основной установки.

Одновременные действия установки должны размещаться между [действием инсталлинитиализе](installinitialize-action.md) и [действием функции InstallFinalize](installfinalize-action.md) основной последовательности действий установки. После отката основной установки установщик также выполняет откат параллельной установки. Использование [отложенного выполнения](deferred-execution-custom-actions.md) с параллельными действиями установки не требуется, так как установщик объединяет данные отката из параллельных и основных установок. Все изменения отменяются при установке отката.

Возвращаемые значения для параллельных действий установки те же, что и для других настраиваемых действий. См. раздел [возвращаемые значения пользовательских действий](custom-action-return-values.md).

Стандартные или настраиваемые действия, которые задают автоматический перезапуск системы или запрашивают у пользователя перезапуск, могут также выполнять перезапуск или запрос в рамках параллельной установки.

После того как установщик начнет параллельную установку, все остальные установки будут заблокированы до завершения параллельной установки и до продолжения основной установки. Установщик может выполнять параллельные установки только в качестве синхронных настраиваемых действий. См. раздел [синхронные и асинхронные настраиваемые действия](synchronous-and-asynchronous-custom-actions.md). Флаги параметров, описанные в разделе [Параметры обработки возвращаемых значений настраиваемых действий](custom-action-return-processing-options.md) , должны иметь значение None (+ 0) или **мсидбкустомактионтипеконтинуе** (+ 64).

Одновременное действие установки может установить приложение для локального запуска, запуска из источника, переустановки или удаления тем же способом, что и при использовании [**мсиинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) для обычной установки. Чтобы указать тип установки, перед одновременным действием установки передайте значение свойства [**ADDLOCAL**](addlocal.md), [**аддсаурце**](addsource.md), [**REINSTALL**](reinstall.md)или [**Remove**](remove.md) .

Одновременные действия установки могут быть созданы парами, одним действием для установки и другим действием, используемым для удаления параллельной установки. Для установки обычно используется [тип настраиваемого действия 7](custom-action-type-7.md) или [тип настраиваемого действия 23](custom-action-type-23.md) . [Тип настраиваемого действия 39](custom-action-type-39.md) обычно используется для удаления параллельной установки при удалении родительского продукта. Запись для настраиваемого действия удаления в [таблице CustomAction](customaction-table.md) может содержать идентификатор GUID кода продукта в поле источника и "удалить = все" в целевом поле. Два настраиваемых действия должны быть созданы в таблице действий с взаимоисключающими условиями. Например, настраиваемое действие, устанавливающее продукт, может иметь значение "не установлено" в поле "условие", а пользовательское действие удаляет параллельную установку с параметром "Удалить =" все "в поле" условие ".

Не существует метода для выполнения запросов к пакету по его затратам. Это усложняет издержки параллельной установки. Строки необходимо добавить в [таблицу ресервекост](reservecost-table.md) , чтобы указать папки и затраты на наихудший случай для компонента, связанного с параллельной установкой.

Единственными [параметрами, возвращаемыми](custom-action-return-processing-options.md) при одновременном выполнении установки, являются "нет" (+ 0) или **мсидбкустомактионтипеконтинуе** (+ 64).

Обратите внимание, что родительская установка не может вызвать собственный пакет как параллельное действие установки.

Обратите внимание, что если установка на компьютере пытается выполнить одновременную установку для каждого пользователя, установщик регистрирует родительскую установку как по умолчанию для пользователя. Это может привести к неправильному удалению приложения установщиком, так как установщик пытается удалить приложение на компьютере, если оно действительно зарегистрировано для каждого пользователя. Чтобы принудительно выполнить одновременную установку для отслеживания состояния своей родительской установки, введите ALLUSERS = " \[ ALLUSERS \] " в столбце Target [таблицы CustomAction](customaction-table.md). В этом случае параллельная установка выполняется для каждого компьютера, если родительский компьютер находится на компьютере, а параллельная установка — для каждого пользователя.

При создании параллельных установок разработчикам следует обратить внимание на следующие предупреждения.

-   Параллельные установки не могут совместно использовать компоненты.
-   Административная установка не может также содержать параллельную установку.
-   Установка исправлений и обновления может не работать одновременно с параллельной установкой.
-   Установщик может неправильно издержки параллельной установки.
-   Интегрированные компоненты ProgressBar нельзя использовать с параллельными установками.
-   Ресурсы, которые должны быть объявлены, не могут быть установлены параллельной установкой.
-   Пакет, выполняющий параллельную установку приложения, должен также удалить параллельное приложение при удалении родительского продукта.

Чтобы предотвратить установку пакета в качестве параллельной установки, добавьте в таблицу [лаунчкондитион](launchcondition-table.md) одну из следующих условных операторов. Это предотвращает установку пакета в ходе параллельной установки, выполняемой другой установкой. Это не мешает удалению пакета с помощью действия [RemoveExistingProducts](removeexistingproducts-action.md) . См. также свойство [**паренторигиналдатабасе**](parentoriginaldatabase.md) и свойство [**парентпродукткоде**](parentproductcode.md) .

``` syntax
"Not ParentProductCode"
```

``` syntax
"Not ParentOriginalDatabase"
```

 

 



