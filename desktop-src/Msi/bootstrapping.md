---
description: В настоящее время каждая установка, которая пытается использовать установщик Windows, начинается с проверки наличия установщика на компьютере пользователя, и если он отсутствует, то будет ли пользователь и компьютер готовы к установке установщик Windows.
ms.assetid: a5174284-2a8c-4510-accf-641fda5be98d
title: Начальной загрузки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff743acbcd2dfc81b0e912e5be84c363f34614ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650714"
---
# <a name="bootstrapping"></a><span data-ttu-id="b0e01-103">Начальной загрузки</span><span class="sxs-lookup"><span data-stu-id="b0e01-103">Bootstrapping</span></span>

<span data-ttu-id="b0e01-104">В настоящее время каждая установка, которая пытается использовать установщик Windows, начинается с проверки наличия установщика на компьютере пользователя, и если он отсутствует, то будет ли пользователь и компьютер готовы к установке установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="b0e01-104">Currently every installation that attempts to use the Windows Installer begins by checking whether the installer is present on the user's computer, and if it is not present, whether the user and computer are ready to install Windows Installer.</span></span> <span data-ttu-id="b0e01-105">Приложение установки [Instmsi.exe](instmsi-exe.md) доступно в пакете SDK для установщик Windows, который содержит всю логику и функциональные возможности для установки установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="b0e01-105">A setup application [Instmsi.exe](instmsi-exe.md) is available with the Windows Installer SDK that contains all logic and functionality to install Windows Installer.</span></span> <span data-ttu-id="b0e01-106">Однако начальное приложение должно управлять этой установкой.</span><span class="sxs-lookup"><span data-stu-id="b0e01-106">However, a bootstrapping application must manage this installation.</span></span>

<span data-ttu-id="b0e01-107">Приложение начальной загрузки должно сначала проверить, установлено ли в данный момент установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="b0e01-107">The bootstrapping application must first check to see whether Windows Installer is currently installed.</span></span> <span data-ttu-id="b0e01-108">Приложения могут получить версию установщик Windows, установленную в настоящее время, с помощью [**дллжетверсион**](/windows/win32/api/shlwapi/nc-shlwapi-dllgetversionproc).</span><span class="sxs-lookup"><span data-stu-id="b0e01-108">Applications can get the version of Windows Installer currently installed by using [**DllGetVersion**](/windows/win32/api/shlwapi/nc-shlwapi-dllgetversionproc).</span></span> <span data-ttu-id="b0e01-109">Если установщик Windows в данный момент не установлен, приложение начальной загрузки должно запросить операционную систему, чтобы определить, какая версия Instmsi.exe требуется.</span><span class="sxs-lookup"><span data-stu-id="b0e01-109">If Windows Installer is not currently installed, the bootstrapping application must query the operating system to determine which version of the Instmsi.exe is required.</span></span> <span data-ttu-id="b0e01-110">После запуска установки установщик Windows приложение начальной загрузки должно выполнить обработку кодов возврата из приложения Instmsi.exe и выполнить перезагрузку, которая произошел во время установки установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="b0e01-110">Once the installation of Windows Installer has initiated, the bootstrapping application must handle return codes from the Instmsi.exe application and handle any reboot that is incurred during the Windows Installer installation.</span></span> <span data-ttu-id="b0e01-111">Дополнительные сведения см. [в разделе Определение версии установщик Windows](determining-the-windows-installer-version.md)</span><span class="sxs-lookup"><span data-stu-id="b0e01-111">For more information, see [Determining the Windows Installer Version](determining-the-windows-installer-version.md)</span></span>

<span data-ttu-id="b0e01-112">В следующем примере показано, как приложение установки, устанавливающее Microsoft Office 2000, проверяет систему пользователя и настраивает установку установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="b0e01-112">The following example demonstrates how the setup application which installs Microsoft Office 2000 checks the user's system and configures the Windows Installer installation.</span></span> <span data-ttu-id="b0e01-113">Этот пример специально написан для установки Office 2000 и должен использоваться только в качестве общего справочника.</span><span class="sxs-lookup"><span data-stu-id="b0e01-113">This example is specifically written to install Office 2000 and should be used as a general reference only.</span></span>

<span data-ttu-id="b0e01-114">Когда пользователь вставляет компакт-диск Office 2000 в компьютер, Setup.exe пытается запустить режим обслуживания, приложение установки или ничего не делает в соответствии с потребностями пользователя.</span><span class="sxs-lookup"><span data-stu-id="b0e01-114">When a user inserts an Office 2000 CD-ROM into their computer, Setup.exe attempts to launch the maintenance mode, the setup application, or does nothing at all, according to the user's needs.</span></span> <span data-ttu-id="b0e01-115">В следующем разделе описывается, как приложение установки Office 2000 с именем Setup.exe, определяет пользователя и его компьютер, конструирует командную строку и устанавливает установщик Windows с помощью приложения Msiexec.exe.</span><span class="sxs-lookup"><span data-stu-id="b0e01-115">The following section describes how the Office 2000 setup application, named Setup.exe, qualifies the user and their computer, constructs a command line and installs Windows Installer using the Msiexec.exe application.</span></span>

## <a name="how-setupexe-bootstraps-the-windows-installer-when-installing-office-2000"></a><span data-ttu-id="b0e01-116">Setup.exe начальной загрузки установщик Windows при установке Office 2000</span><span class="sxs-lookup"><span data-stu-id="b0e01-116">How Setup.exe Bootstraps the Windows Installer when Installing Office 2000</span></span>

1.  <span data-ttu-id="b0e01-117">Пользователь вставляет компакт-диск Office 2000 в компьютер.</span><span class="sxs-lookup"><span data-stu-id="b0e01-117">The user inserts an Office 2000 CD-ROM into their computer.</span></span> <span data-ttu-id="b0e01-118">Операционная система Windows инициирует Setup.exe с помощью параметра/ауторун и файла autorun. INF.</span><span class="sxs-lookup"><span data-stu-id="b0e01-118">The Windows operating system initiates Setup.exe using the /autorun switch and the Autorun.inf file.</span></span> <span data-ttu-id="b0e01-119">Файл autorun. INF находится в корне компакт-диска Office 2000 и содержит следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="b0e01-119">The Autorun.inf file is found at the root of the Office 2000 CD-ROM and contains the following sections:</span></span>

    <span data-ttu-id="b0e01-120">\[Загрузка\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-120">\[Autorun\]</span></span>

     

    <span data-ttu-id="b0e01-121">\[Возможности Office\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-121">\[Office Features\]</span></span>

     

    <span data-ttu-id="b0e01-122">\[Сведения о продукте\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-122">\[Product Information\]</span></span>

     

    <span data-ttu-id="b0e01-123">\[ServicePack \] .</span><span class="sxs-lookup"><span data-stu-id="b0e01-123">\[ServicePack\].</span></span>

    <span data-ttu-id="b0e01-124">\[Раздел автозапуска \] содержит командную строку, которая выполняет Setup.exe приложение, выполняет значок, используемый для показа диска, и содержит сведения о добавлении параметра "Install" (Настройка) в контекстное меню для компакт-диска.</span><span class="sxs-lookup"><span data-stu-id="b0e01-124">The \[Autorun\] section contains a command line that executes the Setup.exe application, executes the icon used to display the disc, and contains information to add an "Install" option and a "Configure" option to the context menu for the CD-ROM.</span></span>

    <span data-ttu-id="b0e01-125">\[Раздел функции Office \] содержит список функций и пар имен компонентов.</span><span class="sxs-lookup"><span data-stu-id="b0e01-125">The \[Office Features\] section contains a list of features and feature name pairs.</span></span>

    <span data-ttu-id="b0e01-126">В \[ разделе сведения о продукте \] указывается имя и версия приложения.</span><span class="sxs-lookup"><span data-stu-id="b0e01-126">The \[Product Information\] section specifies the name and version of the application.</span></span>

    <span data-ttu-id="b0e01-127">\[Раздел ServicePack \] позволяет администратору сети установить минимально необходимый уровень пакета обновления.</span><span class="sxs-lookup"><span data-stu-id="b0e01-127">The \[ServicePack\] section allows a network administrator to set the minimum required service pack level.</span></span> <span data-ttu-id="b0e01-128">Администратор сети может использовать этот раздел, чтобы создать текст оповещения, отображаемого, если в локальной операционной системе отсутствует необходимый пакет обновления.</span><span class="sxs-lookup"><span data-stu-id="b0e01-128">The network administrator can use this section to author the text of an alert message displayed if the local operating system does not have the required service pack.</span></span>

    <span data-ttu-id="b0e01-129">Ниже приведен пример файла autorun. INF.</span><span class="sxs-lookup"><span data-stu-id="b0e01-129">The following is a sample Autorun.inf.</span></span>

    ``` syntax
    [autorun] 
    OPEN=setup.EXE /AUTORUN /KEY:Software\Microsoft\Office\9.0\Common\General\InstallProductID
    ICON=setup.EXE,1
    shell\configure=&Configure
    shell\configure\command=setup.EXE
    shell\install=&Install
    shell\install\command=setup.EXE
    [OfficeFeatures]
    Feature1=ACCESSFiles
    Feature2=OfficeFiles
    Feature3=WORDFiles
    Feature4=EXCELFiles
    Feature5=PPTFiles
    [ProductInformation]
    DisplayName=Microsoft Office 9
    Version=9.0
    ProductCode={product guid}
    [ServicePack]
    MessageText="The operating system does not have a required service pack. Please download and install this from www.microsoft.com."
    SPLevel=3
    ```

2.  <span data-ttu-id="b0e01-130">Приложение Setup.exe проверяет \_ мьютекс мсипромптфоркд.</span><span class="sxs-lookup"><span data-stu-id="b0e01-130">The Setup.exe application checks for the \_MsiPromptForCD mutex.</span></span> <span data-ttu-id="b0e01-131">Установщик Windows создает этот мьютекс, когда он предлагает пользователю вставить компакт-диск.</span><span class="sxs-lookup"><span data-stu-id="b0e01-131">Windows Installer creates this mutex when it prompts the user to insert the CD-ROM.</span></span> <span data-ttu-id="b0e01-132">Наличие мьютекса означает, что установщик Windows выполняет установку, которая запросила компакт-диск Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-132">The presence of the mutex indicates that Windows Installer is running an installation that has requested the Office 2000 CD-ROM.</span></span> <span data-ttu-id="b0e01-133">В этом случае Setup.exe приложение немедленно завершает работу и позволяет продолжить установку Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-133">In this case, the Setup.exe application exits immediately and allows the Office 2000 installation to continue.</span></span> <span data-ttu-id="b0e01-134">Если мьютекс отсутствует, Setup.exe приложение продолжится на шаге 3, где проверяется раздел реестра, чтобы определить, установлен ли Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-134">If the mutex is absent, the Setup.exe application continues at step 3 where a registry key is evaluated to determine if Office 2000 is installed.</span></span>
3.  <span data-ttu-id="b0e01-135">Приложение Setup.exe проверяет наличие раздела реестра Office9:</span><span class="sxs-lookup"><span data-stu-id="b0e01-135">The Setup.exe application checks the presence of the Office9 registry key:</span></span>

    <span data-ttu-id="b0e01-136">**HKCU/Software/Microsoft/Office/9.0/Common/General/Инсталлпродуктид**</span><span class="sxs-lookup"><span data-stu-id="b0e01-136">**HKCU/Software/Microsoft/Office/9.0/Common/General/InstallProductID**</span></span>

    <span data-ttu-id="b0e01-137">Если этот раздел реестра не существует, Setup.exeное приложение продолжит работу на шаге 6, где операционная система проверяет, подходит ли он для установки Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-137">If this registry key does not exist, the Setup.exe application continues at step 6 where the operating system is checked to determine if it qualifies for the installation of Office 2000.</span></span>

4.  <span data-ttu-id="b0e01-138">Если раздел реестра Office 2000 существует, приложение Setup.exe проверяет текущее состояние установки, вызывая [**мсикуерипродуктстате**](/windows/desktop/api/Msi/nf-msi-msiqueryproductstatea).</span><span class="sxs-lookup"><span data-stu-id="b0e01-138">If the Office 2000 registry key exists, the Setup.exe application checks the current installation state by calling [**MsiQueryProductState**](/windows/desktop/api/Msi/nf-msi-msiqueryproductstatea).</span></span> <span data-ttu-id="b0e01-139">Возвращаемое состояние InstallState \_ по умолчанию означает, что Office 2000 уже установлен, а приложение Setup.exe будет продолжаться на шаге 5, где Office 2000 проверяется на запуск из источника.</span><span class="sxs-lookup"><span data-stu-id="b0e01-139">A return state of InstallState\_Default indicates that Office 2000 is already installed and the Setup.exe application continues at step 5 where the Office 2000 is checked for run from source.</span></span>

    <span data-ttu-id="b0e01-140">Если Office 2000 не установлен, приложение Setup.exe продолжится на шаге 6, где операционная система проверяет, подходит ли она для установки Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-140">If Office 2000 is not installed, the Setup.exe application continues at step 6 where the operating system is checked to determine if it qualifies for the installation of Office 2000.</span></span>

5.  <span data-ttu-id="b0e01-141">Setup.exe приложение вызывает [**мсикуерифеатурестате**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea) для каждого компонента в разделе **\[ оффицефеатурес \]** файла autorun. INF.</span><span class="sxs-lookup"><span data-stu-id="b0e01-141">The Setup.exe application calls [**MsiQueryFeatureState**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea) for each of the features in the **\[OfficeFeatures\]** section of the Autorun.inf file.</span></span> <span data-ttu-id="b0e01-142">Если какая-либо из этих функций возвращает INSTALLSTATE \_ Source, это означает, что компонент запускается из источника, а Setup.exe приложение немедленно завершает работу.</span><span class="sxs-lookup"><span data-stu-id="b0e01-142">If any of these features returns INSTALLSTATE\_SOURCE, this indicates that the feature is being run from source and the Setup.exe application exits immediately.</span></span>

    <span data-ttu-id="b0e01-143">Если ни одна из функций не возвращает INSTALLSTATE \_ Source, приложение Setup.exe запускает приложение установщика, Msiexec.exe и представляет режим обслуживания установщик Windows перед выходом.</span><span class="sxs-lookup"><span data-stu-id="b0e01-143">If none of the features returns INSTALLSTATE\_SOURCE, the Setup.exe application launches the installer application, Msiexec.exe, and presents the Windows Installer maintenance mode before exiting.</span></span>

6.  <span data-ttu-id="b0e01-144">Приложение Setup.exe определяет, соответствует ли операционная система установке Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-144">The Setup.exe application determines whether the operating system qualifies for an installation of Office 2000.</span></span> <span data-ttu-id="b0e01-145">Для установки Office 2000 требуется Windows XP.</span><span class="sxs-lookup"><span data-stu-id="b0e01-145">Windows XP is required to install Office 2000.</span></span> <span data-ttu-id="b0e01-146">Если операционной системе требуется обновление пакета обновления для Office 2000, в приложении Setup.exe отображается текст, указанный в файле autorun. INF.</span><span class="sxs-lookup"><span data-stu-id="b0e01-146">If the operating system requires a service pack update to qualify for Office 2000, the Setup.exe application displays the text specified in the Autorun.inf file.</span></span> <span data-ttu-id="b0e01-147">Если операционная система не является обязательной для Office 2000 или обновления Office 2000, в приложении Setup.exe отображается сообщение о том, что пользователь не сможет продолжить работу.</span><span class="sxs-lookup"><span data-stu-id="b0e01-147">If the operating system does not qualify for Office 2000 or an upgrade of Office 2000, the Setup.exe application displays a message that prevents the user from continuing.</span></span>

    <span data-ttu-id="b0e01-148">Если операционная система предназначена для Office 2000, приложение Setup.exe продолжится на шаге 7, который определяет, установлен ли установщик Windows на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="b0e01-148">If the operating system qualifies for Office 2000, the Setup.exe application continues at step 7, which determines whether Windows Installer is installed on the user's computer.</span></span>

7.  <span data-ttu-id="b0e01-149">Если установщик Windows существует на компьютере пользователя, Setup.exe приложение запускает приложение Msiexec.exe и передает ему файл Office 2000. msi.</span><span class="sxs-lookup"><span data-stu-id="b0e01-149">If Windows Installer exists on the user's machine, the Setup.exe application launches the Msiexec.exe application and passes the Office 2000 .msi file to it.</span></span>

    <span data-ttu-id="b0e01-150">Если установщик Windows не установлен на локальном компьютере, Setup.exe приложение продолжит работу на шаге 8, который определяет, соответствует ли операционная система установленной установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="b0e01-150">If Windows Installer is not installed on the local machine, the Setup.exe application continues at step 8, which determines whether the operating system qualifies to have Windows Installer installed.</span></span>

8.  <span data-ttu-id="b0e01-151">Если локальный компьютер имеет право на установку установщик Windows, то Setup.exe приложение запускает правильную версию приложения установщика Instmsi.exe для платформы.</span><span class="sxs-lookup"><span data-stu-id="b0e01-151">If the local computer is eligible to have Windows Installer installed, the Setup.exe application runs the correct version of the Instmsi.exe installer application for the platform.</span></span> <span data-ttu-id="b0e01-152">Setup.exe может передать параметр командной строки/q, чтобы отключить пользовательский интерфейс и запретить пользователю изменять параметры конфигурации установки.</span><span class="sxs-lookup"><span data-stu-id="b0e01-152">Setup.exe may pass the "/q" command line switch to suppress the user interface and prevent the user from changing any installation configuration options.</span></span>
9.  <span data-ttu-id="b0e01-153">Приложение Setup.exe загружает только что установленный файл Msi.dll и выполняет вызов функции [**мсиинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) для установки приложения пользователя.</span><span class="sxs-lookup"><span data-stu-id="b0e01-153">The Setup.exe application loads the newly installed Msi.dll file and performs a call to the [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) function to install the user's application.</span></span>

## <a name="setupexe-command-line-parameters"></a><span data-ttu-id="b0e01-154">Setup.exe параметров командной строки</span><span class="sxs-lookup"><span data-stu-id="b0e01-154">Setup.exe Command Line Parameters</span></span>

<span data-ttu-id="b0e01-155">Приложение Setup.exe позволяет администраторам и пользователям передавать параметры командной строки в приложение Msiexec.exe.</span><span class="sxs-lookup"><span data-stu-id="b0e01-155">The Setup.exe application enables administrators and users to pass command line options to the Msiexec.exe application.</span></span> <span data-ttu-id="b0e01-156">Дополнительные сведения см. в разделе [Параметры командной строки](command-line-options.md).</span><span class="sxs-lookup"><span data-stu-id="b0e01-156">For more information, see [Command Line Options](command-line-options.md).</span></span> <span data-ttu-id="b0e01-157">В следующей таблице перечислены параметры команды, которые можно использовать с Setup.exe.</span><span class="sxs-lookup"><span data-stu-id="b0e01-157">The following table lists the command options that can be used with Setup.exe.</span></span>



| <span data-ttu-id="b0e01-158">Параметр</span><span class="sxs-lookup"><span data-stu-id="b0e01-158">Option</span></span>                       | <span data-ttu-id="b0e01-159">Использование</span><span class="sxs-lookup"><span data-stu-id="b0e01-159">Usage</span></span>                                                                                                                                        | <span data-ttu-id="b0e01-160">Значение</span><span class="sxs-lookup"><span data-stu-id="b0e01-160">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b0e01-161">/ауторун</span><span class="sxs-lookup"><span data-stu-id="b0e01-161">/autorun</span></span>                     | <span data-ttu-id="b0e01-162">setup.exe/ауторун</span><span class="sxs-lookup"><span data-stu-id="b0e01-162">setup.exe /autorun</span></span>                                                                                                                           | <span data-ttu-id="b0e01-163">Запускает файл autorun. INF, описанный выше.</span><span class="sxs-lookup"><span data-stu-id="b0e01-163">Runs the Autorun.inf described above.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="b0e01-164">/a</span><span class="sxs-lookup"><span data-stu-id="b0e01-164">/a</span></span>                           | <span data-ttu-id="b0e01-165">setup.exe /a</span><span class="sxs-lookup"><span data-stu-id="b0e01-165">setup.exe /a</span></span>                                                                                                                                 | <span data-ttu-id="b0e01-166">Инициирует административную установку.</span><span class="sxs-lookup"><span data-stu-id="b0e01-166">Initiates an administrative installation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="b0e01-167">/j</span><span class="sxs-lookup"><span data-stu-id="b0e01-167">/j</span></span>                           | <span data-ttu-id="b0e01-168">\[\| \] *пакет* u m или</span><span class="sxs-lookup"><span data-stu-id="b0e01-168">\[u\|m\]*Package* or</span></span> <br/> <span data-ttu-id="b0e01-169">\[\| \] *список преобразования* *пакета* u m</span><span class="sxs-lookup"><span data-stu-id="b0e01-169">\[u\|m\]*Package* /t *Transform List*</span></span><br/> <span data-ttu-id="b0e01-170">или</span><span class="sxs-lookup"><span data-stu-id="b0e01-170">or</span></span> <br/> <span data-ttu-id="b0e01-171">\[u \| m \] *пакет* /g *LanguageID*</span><span class="sxs-lookup"><span data-stu-id="b0e01-171">\[u\|m\]*Package* /g *LanguageID*</span></span><br/> | <span data-ttu-id="b0e01-172">Объявляет продукт.</span><span class="sxs-lookup"><span data-stu-id="b0e01-172">Advertises a product.</span></span> <span data-ttu-id="b0e01-173">Этот параметр игнорирует все значения свойств, указанные в командной строке.</span><span class="sxs-lookup"><span data-stu-id="b0e01-173">This option ignores any property values entered on the command line.</span></span> <span data-ttu-id="b0e01-174">u объявление для текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="b0e01-174">u   Advertise to the current user.</span></span><br/> <span data-ttu-id="b0e01-175">m объявление для всех пользователей компьютера.</span><span class="sxs-lookup"><span data-stu-id="b0e01-175">m   Advertise to all users of machine.</span></span><br/> <span data-ttu-id="b0e01-176">Идентификатор языка g</span><span class="sxs-lookup"><span data-stu-id="b0e01-176">g   Language identifier</span></span><br/> <span data-ttu-id="b0e01-177">t применяет преобразование к объявленному пакету.</span><span class="sxs-lookup"><span data-stu-id="b0e01-177">t   Applies transform to advertised package.</span></span><br/>                                                                                                                                                                                                                        |
| <span data-ttu-id="b0e01-178">/I</span><span class="sxs-lookup"><span data-stu-id="b0e01-178">/I</span></span>                           | <span data-ttu-id="b0e01-179">setup.exe/I Office9.msi/t Программгмт. MST</span><span class="sxs-lookup"><span data-stu-id="b0e01-179">setup.exe /I Office9.msi /t ProgramMgmt.mst</span></span>                                                                                                  | <span data-ttu-id="b0e01-180">Указывает MSI-файл, который Setup.exe должен быть установлен.</span><span class="sxs-lookup"><span data-stu-id="b0e01-180">Specifies the .msi file that Setup.exe is to install.</span></span> <span data-ttu-id="b0e01-181">Если параметр/I не включен, Setup.exe использует файл Office9.msi.</span><span class="sxs-lookup"><span data-stu-id="b0e01-181">If the /I option is not included, Setup.exe uses the Office9.msi file.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="b0e01-182">/o< = *значение* свойства></span><span class="sxs-lookup"><span data-stu-id="b0e01-182">/o<*property*=*value*></span></span> | <span data-ttu-id="b0e01-183">setup.exe/o КДКЭЙ = 111111-1111</span><span class="sxs-lookup"><span data-stu-id="b0e01-183">setup.exe /o CDKEY=111111-1111</span></span>                                                                                                               | <span data-ttu-id="b0e01-184">Задает свойства в файле MSI.</span><span class="sxs-lookup"><span data-stu-id="b0e01-184">Sets properties in the .msi file.</span></span> <span data-ttu-id="b0e01-185">Setup.exe передает их в msiexec как записанный.</span><span class="sxs-lookup"><span data-stu-id="b0e01-185">Setup.exe passes these it to msiexec as written.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="b0e01-186">/q</span><span class="sxs-lookup"><span data-stu-id="b0e01-186">/q</span></span>                           | <span data-ttu-id="b0e01-187">setup.exe/q</span><span class="sxs-lookup"><span data-stu-id="b0e01-187">setup.exe /q</span></span>                                                                                                                                 | <span data-ttu-id="b0e01-188">Задайте уровень установки на уровне пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="b0e01-188">Set the UI level the installation.</span></span> <span data-ttu-id="b0e01-189">/q без пользовательского интерфейса (/Qn для msiexec)/QB Basic UI</span><span class="sxs-lookup"><span data-stu-id="b0e01-189">/q   no UI (/qn   for msiexec.) /qb   basic UI</span></span><br/> <span data-ttu-id="b0e01-190">/КР ограниченный пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="b0e01-190">/qr   reduced UI.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="b0e01-191">/m\#</span><span class="sxs-lookup"><span data-stu-id="b0e01-191">/m\#</span></span>                         | <span data-ttu-id="b0e01-192">setup.exe/M4</span><span class="sxs-lookup"><span data-stu-id="b0e01-192">setup.exe /m4</span></span>                                                                                                                                | <span data-ttu-id="b0e01-193">Поддерживает несколько лицензий в соответствии с соглашениями SELECT.</span><span class="sxs-lookup"><span data-stu-id="b0e01-193">Supports multiple licenses in accordance with Select agreements.</span></span> <span data-ttu-id="b0e01-194">Это свойство используется в настраиваемом действии проверки лицензии для записи сертификата LV.</span><span class="sxs-lookup"><span data-stu-id="b0e01-194">This property is used in by the License Verification custom action to write the LV certificate.</span></span> <span data-ttu-id="b0e01-195">За параметром/m должно следовать допустимое число разблокирований.</span><span class="sxs-lookup"><span data-stu-id="b0e01-195">The /m option must be followed by the number of unlocks allowed.</span></span> <span data-ttu-id="b0e01-196">Значение, заданное параметром/m, должно быть задано как свойство M в файле Office9.msi.</span><span class="sxs-lookup"><span data-stu-id="b0e01-196">The value specified by the /m option should be set as the "M" property in the Office9.msi file.</span></span> <span data-ttu-id="b0e01-197">Если значение не указано, но параметр/m используется вместе с программой установки, то должно быть задано значение 0.</span><span class="sxs-lookup"><span data-stu-id="b0e01-197">If no value is specified, but the /m option is used with setup, the value of 0 should be set.</span></span> <span data-ttu-id="b0e01-198">Параметр/m необходим для поддержки выбора клиентов, использующих компакт-диск или сеть.</span><span class="sxs-lookup"><span data-stu-id="b0e01-198">The /m option is required to support Select customers using a CD or network.</span></span> |
| <span data-ttu-id="b0e01-199">/Settings</span><span class="sxs-lookup"><span data-stu-id="b0e01-199">/settings</span></span>                    | <span data-ttu-id="b0e01-200">setup.exe/Settings mysettings.ini</span><span class="sxs-lookup"><span data-stu-id="b0e01-200">setup.exe /settings mysettings.ini</span></span>                                                                                                           | <span data-ttu-id="b0e01-201">Позволяет администраторам указывать ini-файл, содержащий все пользовательские параметры, которые должны быть переданы во время установки Office 2000.</span><span class="sxs-lookup"><span data-stu-id="b0e01-201">Enables administrators to specify an .ini file containing all of the customized settings to be passed during Office 2000 setup.</span></span> <span data-ttu-id="b0e01-202">См. Описание ini-файла ниже.</span><span class="sxs-lookup"><span data-stu-id="b0e01-202">See the description of the .ini file below.</span></span>                                                                                                                                                                                                                                                                                                                                  |



 

## <a name="using-an-ini-file"></a><span data-ttu-id="b0e01-203">Использование ini-файла</span><span class="sxs-lookup"><span data-stu-id="b0e01-203">Using an .ini File</span></span>

<span data-ttu-id="b0e01-204">Создание файла инициализации может оказаться проще, чем создавать длинную командную строку.</span><span class="sxs-lookup"><span data-stu-id="b0e01-204">Creating an initialization file may be easier than creating a long command line.</span></span> <span data-ttu-id="b0e01-205">С помощью параметра/Settings приложение Setup.exe считывает указанный ini-файл и конструирует командную строку для передачи в приложение Msiexec.exe.</span><span class="sxs-lookup"><span data-stu-id="b0e01-205">Using the /settings option, the Setup.exe application reads the specified .ini file and constructs a command line to pass to the Msiexec.exe application.</span></span> <span data-ttu-id="b0e01-206">В ini-файле поддерживаются только те свойства, которые поддерживаются в командной строке.</span><span class="sxs-lookup"><span data-stu-id="b0e01-206">Only properties supported on the command line are supported in the .ini file.</span></span> <span data-ttu-id="b0e01-207">Если свойство или значение найдено как в ini-файле, так и в командной строке, параметры командной строки переопределяют параметры INI-файла.</span><span class="sxs-lookup"><span data-stu-id="b0e01-207">If a property or value is found in both the .ini file and on the command line, the command line settings override the .ini file settings.</span></span>

<span data-ttu-id="b0e01-208">INI-файл имеет формат:</span><span class="sxs-lookup"><span data-stu-id="b0e01-208">The format of the .ini file is:</span></span>

<span data-ttu-id="b0e01-209">\[MSI\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-209">\[msi\]</span></span>

 

<span data-ttu-id="b0e01-210">\[осн\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-210">\[mst\]</span></span>

 

<span data-ttu-id="b0e01-211">\[options\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-211">\[options\]</span></span>

 

<span data-ttu-id="b0e01-212">\[Дисплей\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-212">\[Display\]</span></span>

<span data-ttu-id="b0e01-213">В \[ \] разделе MSI ini-файла указан путь к установочному пакету для установки.</span><span class="sxs-lookup"><span data-stu-id="b0e01-213">The \[msi\] section of the .ini file specifies the path to the installation package for the installation.</span></span> <span data-ttu-id="b0e01-214">Это соответствует параметру/I в командной строке.</span><span class="sxs-lookup"><span data-stu-id="b0e01-214">This corresponds to the /I option on the command line.</span></span>

<span data-ttu-id="b0e01-215">В \[ \] разделе MST ini-файла указан путь к преобразованиям, используемым в этой установке.</span><span class="sxs-lookup"><span data-stu-id="b0e01-215">The \[mst\] section of the .ini file specifies the path to transforms used with this installation.</span></span> <span data-ttu-id="b0e01-216">Это соответствует параметру/j в командной строке.</span><span class="sxs-lookup"><span data-stu-id="b0e01-216">This corresponds to the /j option on the command line.</span></span> <span data-ttu-id="b0e01-217">Несколько преобразований указываются в другой строке с помощью MST1 MST (N).</span><span class="sxs-lookup"><span data-stu-id="b0e01-217">Multiple transforms are each indicated on a different line, using MST1   MST(N).</span></span> <span data-ttu-id="b0e01-218">При синтаксическом анализе в командной строке список в ini-файле включается слева направо.</span><span class="sxs-lookup"><span data-stu-id="b0e01-218">When parsed into the command line, the list in the .ini file is turned from left to right.</span></span> <span data-ttu-id="b0e01-219">Обратите внимание, что номер, связанный с заголовком MST (N), существует только для поддержки уникальных идентификаторов и не имеет программного значения.</span><span class="sxs-lookup"><span data-stu-id="b0e01-219">Note that the number associated with the MST(N) title is present only to maintain unique identifiers and has no programmatic meaning.</span></span>

<span data-ttu-id="b0e01-220">\[Раздел параметров \] позволяет сетевым администраторам задавать и переопределять свойства в файлах MSI или MST.</span><span class="sxs-lookup"><span data-stu-id="b0e01-220">The \[options\] section allows network administrators to set and override properties in the .msi or .mst files.</span></span> <span data-ttu-id="b0e01-221">Параметры, заданные в ini-файле, добавляются в командную строку с помощью параметра/o.</span><span class="sxs-lookup"><span data-stu-id="b0e01-221">Options set in the .ini file are added to the command line using the /o option.</span></span> <span data-ttu-id="b0e01-222">Каждый параметр в разделе параметров должен иметь имя свойства и значение.</span><span class="sxs-lookup"><span data-stu-id="b0e01-222">Each option in the option section must have a property name and a value.</span></span>

<span data-ttu-id="b0e01-223">\[Раздел Отображение \] используется для задания уровня пользовательского интерфейса, используемого во время установки.</span><span class="sxs-lookup"><span data-stu-id="b0e01-223">The \[Display\] section is used to set the user interface level used during setup.</span></span> <span data-ttu-id="b0e01-224">Соответствует параметру/q в командной строке.</span><span class="sxs-lookup"><span data-stu-id="b0e01-224">This corresponds to the /q option on the command line.</span></span> <span data-ttu-id="b0e01-225">Допустимые значения: None, Basic, Reduced и Full.</span><span class="sxs-lookup"><span data-stu-id="b0e01-225">Valid values are   none, basic, reduced, and full.</span></span>

<span data-ttu-id="b0e01-226">Пример ini-файла</span><span class="sxs-lookup"><span data-stu-id="b0e01-226">Sample .ini file</span></span>

<span data-ttu-id="b0e01-227">\[MSI\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-227">\[MSI\]</span></span>

 

<span data-ttu-id="b0e01-228">MSI = \\ \\ саурцешаре \\ office2000 \\Office2000.msi</span><span class="sxs-lookup"><span data-stu-id="b0e01-228">MSI=\\\\sourceshare\\Office2000\\Office2000.msi</span></span>

 

<span data-ttu-id="b0e01-229">\[ОСН\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-229">\[MST\]</span></span>

 

<span data-ttu-id="b0e01-230">MST1 = \\ \\ саурцешаре \\ office2000 \\ trns1. MST</span><span class="sxs-lookup"><span data-stu-id="b0e01-230">MST1=\\\\sourceshare\\Office2000\\trns1.mst</span></span>

 

<span data-ttu-id="b0e01-231">MST2 = \\ \\ саурцешаре \\ office2000 \\ trns2. MST</span><span class="sxs-lookup"><span data-stu-id="b0e01-231">MST2=\\\\sourceshare\\Office2000\\trns2.mst</span></span>

 

<span data-ttu-id="b0e01-232">\[Параметры\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-232">\[Options\]</span></span>

 

<span data-ttu-id="b0e01-233">ПУБЛИКПРОПЕРТИ = ваше значение</span><span class="sxs-lookup"><span data-stu-id="b0e01-233">PUBLICPROPERTY=your value</span></span>

<span data-ttu-id="b0e01-234">\[Дисплей\]</span><span class="sxs-lookup"><span data-stu-id="b0e01-234">\[Display\]</span></span>

 

<span data-ttu-id="b0e01-235">Показать = нет</span><span class="sxs-lookup"><span data-stu-id="b0e01-235">Display=None</span></span>

 

