---
description: В этом разделе описывается, как разработчики пакетов установки создают пользовательский интерфейс установки с помощью базы данных установщика и внутреннего пользовательского интерфейса.
ms.assetid: c04e32ba-08a9-49fe-9a4a-db258767f0b3
title: Использование пользовательского интерфейса
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714d41ab6b91bb0f3ce519887f7004f919c5c6b2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264509"
---
# <a name="using-the-user-interface"></a><span data-ttu-id="f4af8-103">Использование пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="f4af8-103">Using the User Interface</span></span>

<span data-ttu-id="f4af8-104">В этом разделе описывается, как разработчики пакетов установки создают пользовательский интерфейс установки с помощью базы данных установщика и внутреннего пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="f4af8-104">This section is concerned primarily with how developers of installation packages author an installation user interface (UI) using the installer's database and internal UI.</span></span> <span data-ttu-id="f4af8-105">Дополнительные сведения о различиях между внутренним и внешним пользовательским ИНТЕРФЕЙСом см. [в разделе о пользовательском интерфейсе](about-the-user-interface.md).</span><span class="sxs-lookup"><span data-stu-id="f4af8-105">For more information about the difference between an internal and external UI see [About the User Interface](about-the-user-interface.md).</span></span>

<span data-ttu-id="f4af8-106">Чтобы отобразить последовательность диалоговых окон или объявление во время установки, имя этого диалогового окна необходимо указать в столбце Action соответствующей таблицы последовательности действий.</span><span class="sxs-lookup"><span data-stu-id="f4af8-106">To display a dialog box sequence or billboard during the installation, the name of the dialog box must be entered into the Action column of the appropriate action sequence table.</span></span> <span data-ttu-id="f4af8-107">Имя диалогового окна должно появиться в [таблице](adminuisequence-table.md) [инсталлуисекуенце](installuisequence-table.md) или админуисекуенце в зависимости от того, ЗАПЛАНИРОВАНО ли выполнение пользовательского интерфейса с помощью действия [установки](install-action.md), [объявления](advertise-action.md)или [администратора](admin-action.md).</span><span class="sxs-lookup"><span data-stu-id="f4af8-107">The name of the dialog box must appear in the [InstallUISequence](installuisequence-table.md) or [AdminUISequence table](adminuisequence-table.md) depending on whether the UI is scheduled to run under the [INSTALL](install-action.md), [ADVERTISE](advertise-action.md), or [ADMIN action](admin-action.md).</span></span>

<span data-ttu-id="f4af8-108">Несмотря на то, что установщик поддерживает создание пользовательских диалоговых окон и объявлений, существует также ряд зарезервированных имен для некоторых последовательностей диалоговых окон.</span><span class="sxs-lookup"><span data-stu-id="f4af8-108">Although the installer supports the authoring of custom dialog boxes and billboards, there are also a number of reserved names for certain dialog box sequences.</span></span> <span data-ttu-id="f4af8-109">Поскольку установщик использует эти имена при выполнении определенных действий, эти имена должны использоваться только с типами диалоговых окон, для которых они зарезервированы.</span><span class="sxs-lookup"><span data-stu-id="f4af8-109">Because the installer uses these names when executing certain actions, these names must only be used with the types of dialog boxes for which they are reserved.</span></span> <span data-ttu-id="f4af8-110">Список зарезервированных имен и описание каждой из специальных последовательностей диалоговых окон задаются в [диалоговых](dialog-boxes.md)окнах.</span><span class="sxs-lookup"><span data-stu-id="f4af8-110">A list of these reserved names, and a description of each of the special dialog box sequences, is given in [Dialog Boxes](dialog-boxes.md).</span></span>

<span data-ttu-id="f4af8-111">Свойства каждого диалогового окна или объявления в пользовательском интерфейсе должны быть указаны в [диалоговых окнах](dialog-table.md) и таблицах [объявлений](billboard-table.md) соответственно.</span><span class="sxs-lookup"><span data-stu-id="f4af8-111">The properties of each dialog box or billboard in the UI must be specified in the [Dialog](dialog-table.md) and [BillBoard](billboard-table.md) tables, respectively.</span></span> <span data-ttu-id="f4af8-112">Стиль каждого диалогового окна также должен быть указан в диалоговом окне путем установки флага [bit в стиле диалогового окна](dialog-style-bits.md) .</span><span class="sxs-lookup"><span data-stu-id="f4af8-112">The style of each dialog box must also be specified in the Dialog table by setting the [dialog's style bit](dialog-style-bits.md) flag.</span></span>

<span data-ttu-id="f4af8-113">Элементы управления и текст должны быть добавлены в диалоговое окно, и они должны быть привязаны к [контролевентс](controlevent-overview.md), чтобы пользователи могли взаимодействовать с процессом установки.</span><span class="sxs-lookup"><span data-stu-id="f4af8-113">Controls and text must be added to the dialog box, and these must be tied to [ControlEvents](controlevent-overview.md), to enable the user to interact with the installation process.</span></span> <span data-ttu-id="f4af8-114">Дополнительные сведения о добавлении элементов управления в диалоговое окно см. в разделе [Добавление элементов управления и текста](adding-controls-and-text.md) .</span><span class="sxs-lookup"><span data-stu-id="f4af8-114">See [Adding Controls and Text](adding-controls-and-text.md) for more information on how to add controls to a dialog box.</span></span>

<span data-ttu-id="f4af8-115">Установщик Windows внутренний обработчик пользовательского интерфейса может выборочно отображать или скрывать диалоговые окна для управления уровнем взаимодействия конечных пользователей во время установки.</span><span class="sxs-lookup"><span data-stu-id="f4af8-115">Windows Installer internal UI handler can selectively show or hide dialog boxes to control the level of end-user interactivity during the installation.</span></span> <span data-ttu-id="f4af8-116">Эти уровни взаимодействия с конечным пользователем называются Full, Reduced, Basic и None.</span><span class="sxs-lookup"><span data-stu-id="f4af8-116">These levels of end-user interactivity are referred to as full, reduced, basic, and none.</span></span> <span data-ttu-id="f4af8-117">См. раздел [уровни пользовательского интерфейса](user-interface-levels.md).</span><span class="sxs-lookup"><span data-stu-id="f4af8-117">See [User Interface Levels](user-interface-levels.md).</span></span> <span data-ttu-id="f4af8-118">полное описание этих Уилевелс.</span><span class="sxs-lookup"><span data-stu-id="f4af8-118">for a full description of these UIlevels.</span></span>

<span data-ttu-id="f4af8-119">Задать уровень пользовательского интерфейса можно двумя способами.</span><span class="sxs-lookup"><span data-stu-id="f4af8-119">There are two methods to set the UI level.</span></span> <span data-ttu-id="f4af8-120">Уровень пользовательского интерфейса можно задать программно с помощью вызова [**мсисетинтерналуи**](/windows/desktop/api/Msi/nf-msi-msisetinternalui), а первый параметр **мсисетинтерналуи** указывает уровень пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="f4af8-120">The UI level can be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui), and the first parameter of **MsiSetInternalUI** specifies the UI level.</span></span> <span data-ttu-id="f4af8-121">Разработчики пакетов также могут задать уровень пользовательского интерфейса с помощью [параметра командной строки](command-line-options.md) "/q".</span><span class="sxs-lookup"><span data-stu-id="f4af8-121">Package developers can also set the UI level using the [command line option](command-line-options.md) "/q".</span></span>

<span data-ttu-id="f4af8-122">Поведение каждого уровня пользовательского интерфейса определяется созданием MSI-файла разработчиком пакета.</span><span class="sxs-lookup"><span data-stu-id="f4af8-122">The behavior of each of the UI levels is determined by the authoring of the .msi file by the package developer.</span></span> <span data-ttu-id="f4af8-123">Автор внутреннего пользовательского интерфейса имеет гибкость в работе этих уровней для пакета.</span><span class="sxs-lookup"><span data-stu-id="f4af8-123">The author of an internal UI has flexibility in how these levels behave for a package.</span></span> <span data-ttu-id="f4af8-124">Доступность этих уровней зависит от разработки пакета установки.</span><span class="sxs-lookup"><span data-stu-id="f4af8-124">The availability of these levels depends on the authoring of the installation package.</span></span> <span data-ttu-id="f4af8-125">Автор должен указать каждое диалоговое окно и элемент управления в пользовательском интерфейсе в диалоговых таблицах и элементах управления.</span><span class="sxs-lookup"><span data-stu-id="f4af8-125">The author must specify every dialog box and control in the user interface in the Dialog and Control tables.</span></span>

-   <span data-ttu-id="f4af8-126">Полный пользовательский интерфейс обычно содержит [поведение мастера пользовательского интерфейса](user-interface-wizard-behavior.md), например каждое диалоговое окно в последовательности, содержащее кнопку со **следующей>>** .</span><span class="sxs-lookup"><span data-stu-id="f4af8-126">A full UI typically exhibits [user interface wizard behavior](user-interface-wizard-behavior.md), such as each dialog box in a sequence containing a **Next>>** button.</span></span> <span data-ttu-id="f4af8-127">Эта форма пользовательского интерфейса знакома многим пользователям и является наиболее распространенным типом пользовательского интерфейса для создаваемого автора.</span><span class="sxs-lookup"><span data-stu-id="f4af8-127">This form of UI is familiar to many users and is the most common type of UI for an author to create.</span></span> <span data-ttu-id="f4af8-128">Установщик представляет логическую последовательность диалоговых окон и предлагает пользователю взаимодействовать с элементами управления, расположенными в каждом диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="f4af8-128">The installer presents a logical sequence of dialog boxes and prompts the user to interact with controls located in each dialog box.</span></span>
-   <span data-ttu-id="f4af8-129">Сокращенный пользовательский интерфейс обычно подавляет отображение поведения мастера.</span><span class="sxs-lookup"><span data-stu-id="f4af8-129">A reduced UI typically suppresses the display of wizard behavior.</span></span>
-   <span data-ttu-id="f4af8-130">Базовый интерфейс пользователя обычно отображает сообщения о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="f4af8-130">A basic UI typically only displays progress messages to the user.</span></span>
-   <span data-ttu-id="f4af8-131">Уровень пользовательского интерфейса None означает автоматическую установку.</span><span class="sxs-lookup"><span data-stu-id="f4af8-131">A UI level of None means a silent installation.</span></span>

<span data-ttu-id="f4af8-132">Установщик Windows предоставляет уникальный индикатор индикатора выполнения в [элементе управления ProgressBar](progressbar-control.md) , который отображает пользователю оценку общего времени, оставшегося до завершения установки.</span><span class="sxs-lookup"><span data-stu-id="f4af8-132">Windows Installer provides a unique progress bar indicator in the [ProgressBar control](progressbar-control.md) that displays to the user an estimate of the total time remaining until the installation is complete.</span></span> <span data-ttu-id="f4af8-133">Дополнительные сведения о индикаторе выполнения см. в разделе [Разработка элемента управления ProgressBar](authoring-a-progressbar-control.md).</span><span class="sxs-lookup"><span data-stu-id="f4af8-133">For more information about the progress bar, see [Authoring a ProgressBar Control](authoring-a-progressbar-control.md).</span></span>

<span data-ttu-id="f4af8-134">Авторы пользовательского интерфейса должны упростить доступ к приложениям или продукту для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="f4af8-134">UI authors should facilitate the accessibility of their application or product for all users.</span></span> <span data-ttu-id="f4af8-135">Дополнительные сведения о Active Accessibility и установщик Windows см. в разделе [Специальные возможности](accessibility.md).</span><span class="sxs-lookup"><span data-stu-id="f4af8-135">To learn more about Active Accessibility and Windows Installer, see [Accessibility](accessibility.md).</span></span>

<span data-ttu-id="f4af8-136">Дополнительные сведения о создании пользовательского интерфейса см. в статьях [Добавление элементов управления и текста](adding-controls-and-text.md), [Создание элемента управления ProgressBar](authoring-a-progressbar-control.md), [Создание сообщений на диске](authoring-disk-prompt-messages.md)и создание [условного выражения "Подождите...". Окно сообщения](authoring-a-conditional-please-wait-------message-box.md)и [Предварительный просмотр пользовательского интерфейса](previewing-the-user-interface.md).</span><span class="sxs-lookup"><span data-stu-id="f4af8-136">For more information about authoring a user interface, see [Adding Controls and Text](adding-controls-and-text.md), [Authoring a ProgressBar Control](authoring-a-progressbar-control.md), [Authoring Disk Prompt Messages](authoring-disk-prompt-messages.md), [Authoring a Conditional "Please Wait . . ." Message Box](authoring-a-conditional-please-wait-------message-box.md), and [Previewing the User Interface](previewing-the-user-interface.md).</span></span> <span data-ttu-id="f4af8-137">Дополнительные сведения об объявлениях автора см. [в разделе Отображение объявлений в немодальном диалоговом окне](displaying-billboards-on-a-modeless-dialog.md) .</span><span class="sxs-lookup"><span data-stu-id="f4af8-137">For more information about author billboards see [Displaying Billboards on a Modeless Dialog](displaying-billboards-on-a-modeless-dialog.md)</span></span>

<span data-ttu-id="f4af8-138">Начиная с установщик Windows 4,5 настраиваемый пользовательский интерфейс можно внедрить в пакет установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="f4af8-138">Beginning with Windows Installer 4.5 a custom user interface can be embedded within the Windows Installer package.</span></span> <span data-ttu-id="f4af8-139">Пример встроенного пользовательского интерфейса см. в разделе [Использование встроенного пользовательского](using-an-embedded-ui.md)интерфейса.</span><span class="sxs-lookup"><span data-stu-id="f4af8-139">For an example of an embedded custom UI see [Using an Embedded UI](using-an-embedded-ui.md).</span></span>

 

 



