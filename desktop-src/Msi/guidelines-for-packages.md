---
description: Поскольку контроль учетных записей (UAC) в Windows Vista позволяет ограничивать права доступа во время установки, разработчики установщик Windowsных пакетов не должны предположить, что их установка всегда имеет доступ ко всем частям системы.
ms.assetid: 8e3b4ad8-b978-4e27-b060-1d023846718f
title: Рекомендации по пакетам
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: db228c2dff443d421ddc089074f0fcce6ae93e2f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103910940"
---
# <a name="guidelines-for-packages"></a><span data-ttu-id="91e1f-103">Рекомендации по пакетам</span><span class="sxs-lookup"><span data-stu-id="91e1f-103">Guidelines for Packages</span></span>

<span data-ttu-id="91e1f-104">Поскольку [*контроль учетных записей*](u-gly.md) (UAC) в Windows Vista позволяет ограничивать права доступа во время установки, разработчики установщик Windowsных пакетов не должны предположить, что их установка всегда имеет доступ ко всем частям системы.</span><span class="sxs-lookup"><span data-stu-id="91e1f-104">Because [*User Account Control*](u-gly.md) (UAC) in Windows Vista restricts privileges during an installation, developers of Windows Installer packages should not assume that their installation always has access to all parts of the system.</span></span>

<span data-ttu-id="91e1f-105">Пакет установщика, который может быть успешно развернут для обычных пользователей с помощью [Групповая политика](/previous-versions/windows/desktop/Policy/group-policy-start-page) , в большинстве случаев также работает с UAC в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="91e1f-105">An installer package that can be successfully deployed to standard users via [Group Policy](/previous-versions/windows/desktop/Policy/group-policy-start-page) should in most cases also work with UAC in Windows Vista.</span></span> <span data-ttu-id="91e1f-106">Исключения могут возникать, если [Таблица инсталлуисекуенце](installuisequence-table.md) содержит [действие Лаунчкондитионс](launchconditions-action.md) или [Таблица Лаунчкондитион](launchcondition-table.md) содержит условие на основе [привилегированного свойства](privileged.md).</span><span class="sxs-lookup"><span data-stu-id="91e1f-106">Exceptions to this can occur if the [InstallUISequence table](installuisequence-table.md) contains the [LaunchConditions action](launchconditions-action.md) or the [LaunchCondition table](launchcondition-table.md) contains a condition based on the [Privileged property](privileged.md).</span></span> <span data-ttu-id="91e1f-107">Разработчики пакетов установщик Windows должны соблюдать следующие рекомендации по обеспечению работы пакета с UAC и Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="91e1f-107">Windows Installer package developers should therefore adhere to the following guidelines to ensure their package works with UAC and Windows Vista.</span></span>

-   <span data-ttu-id="91e1f-108">При включении условия [*контекста установки*](i-gly.md) с действием в [таблице инсталлуисекуенце](installuisequence-table.md)используйте условную инструкцию, основанную на [привилегированном свойстве](privileged.md).</span><span class="sxs-lookup"><span data-stu-id="91e1f-108">When including an [*installation context*](i-gly.md) condition with an action in the [InstallUISequence table](installuisequence-table.md), use a conditional statement based on the [Privileged property](privileged.md).</span></span> <span data-ttu-id="91e1f-109">Не используйте условие на основе свойства [**AdminUser**](adminuser.md) .</span><span class="sxs-lookup"><span data-stu-id="91e1f-109">Do not use a condition based on the [**AdminUser**](adminuser.md) property.</span></span>
-   <span data-ttu-id="91e1f-110">При включении контекста установки с условиями запуска установки используйте [тип настраиваемого действия 19](custom-action-type-19.md) в [таблице инсталлексекутесекуенце](installexecutesequence-table.md) и сделайте настраиваемое действие условным по отношению к [привилегированному свойству](privileged.md).</span><span class="sxs-lookup"><span data-stu-id="91e1f-110">When including the installation context with the installation launch conditions, use a [Custom Action Type 19](custom-action-type-19.md) in the [InstallExecuteSequence table](installexecutesequence-table.md) and make the custom action conditional upon the [Privileged property](privileged.md).</span></span> <span data-ttu-id="91e1f-111">Не используйте действие в [таблице лаунчкондитион](launchcondition-table.md) с условием, основанным на [свойстве AdminUser](adminuser.md) или привилегированном свойстве.</span><span class="sxs-lookup"><span data-stu-id="91e1f-111">Do not use an action in the [LaunchCondition table](launchcondition-table.md) with a condition based on the [AdminUser property](adminuser.md) or Privileged property.</span></span>
-   <span data-ttu-id="91e1f-112">Чтобы прочитать или изменить конфигурацию системы, используйте [настраиваемое действие отложенного выполнения](deferred-execution-custom-actions.md) в [таблице инсталлексекутесекуенце](installexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="91e1f-112">To read or modify the system configuration, use a [deferred execution custom action](deferred-execution-custom-actions.md) in the [InstallExecuteSequence table](installexecutesequence-table.md).</span></span> <span data-ttu-id="91e1f-113">Не используйте настраиваемые действия немедленного выполнения в [таблице инсталлуисекуенце](installuisequence-table.md) для изменения конфигурации системы.</span><span class="sxs-lookup"><span data-stu-id="91e1f-113">Do not use immediate execution custom actions in the [InstallUISequence table](installuisequence-table.md) to modify the system configuration.</span></span>
-   <span data-ttu-id="91e1f-114">Чтобы изменить части системы, не относящиеся к пользователям, используйте отложенное настраиваемое действие в [таблице инсталлексекутесекуенце](installexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="91e1f-114">To modify parts of the system that are not user specific, use a deferred custom action in the [InstallExecuteSequence table](installexecutesequence-table.md).</span></span> <span data-ttu-id="91e1f-115">Необходимо включить бит msidbCustomActionTypeNoImpersonate в тип настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="91e1f-115">You should include the msidbCustomActionTypeNoImpersonate bit in the custom action type.</span></span>
-   <span data-ttu-id="91e1f-116">Опустите бит 3 со значения свойства Summary [**Count Words**](word-count-summary.md) , чтобы указать, что пакет может быть необходим для повышения прав.</span><span class="sxs-lookup"><span data-stu-id="91e1f-116">Omit Bit 3 from the value of the [**Word Count**](word-count-summary.md) Summary Property to indicate that the package can be required to be elevated.</span></span> <span data-ttu-id="91e1f-117">Не включайте этот бит, если для установки этого пакета не требуются повышенные привилегии.</span><span class="sxs-lookup"><span data-stu-id="91e1f-117">Do not include this bit unless elevated privileges are not required to install this package.</span></span>
-   <span data-ttu-id="91e1f-118">Включите манифест с запрошенным уровнем выполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="91e1f-118">Include a manifest with the application's Requested Execution Level.</span></span>
-   <span data-ttu-id="91e1f-119">Включите сертификат в таблицу [мсипатчцертификате](msipatchcertificate-table.md) исходного пакета и подпишите все исправления с тем же сертификатом.</span><span class="sxs-lookup"><span data-stu-id="91e1f-119">Include a certificate in the [MsiPatchCertificate](msipatchcertificate-table.md) table of original package and sign all patches with the same certificate.</span></span>
-   <span data-ttu-id="91e1f-120">Если для установки пакета установщик Windows требуются повышенные привилегии, автор пакета должен включать атрибут [елеватионшиелд](elevationshield-attribute.md) для [элемента управления "кнопка](pushbutton-control.md) ", используемого для запуска установки.</span><span class="sxs-lookup"><span data-stu-id="91e1f-120">If elevated privileges are required to install a Windows Installer package, the author of the package should include the [ElevationShield](elevationshield-attribute.md) attribute for the [PushButton control](pushbutton-control.md) used to start the installation.</span></span> <span data-ttu-id="91e1f-121">При этом пользователю будет выводиться предупреждение о том, что нажатие кнопки приведет к отображению диалогового окна UAC, запрашивающего авторизацию администратора для продолжения установки.</span><span class="sxs-lookup"><span data-stu-id="91e1f-121">This will alert the user that clicking on the button will display the UAC dialog box requesting administrator authorization to continue the installation.</span></span>
-   <span data-ttu-id="91e1f-122">Присвойте свойству [**мсидеплойменткомплиант**](msideploymentcompliant.md) значение 1, чтобы указать установщик Windows, что пакет был создан и протестирован в соответствии с UAC в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="91e1f-122">Set the [**MSIDEPLOYMENTCOMPLIANT**](msideploymentcompliant.md) property to 1 to indicate to the Windows Installer that the package has been authored and tested to comply with UAC in Windows Vista.</span></span> <span data-ttu-id="91e1f-123">Если это свойство не задано, установщик определяет, соответствует ли пакет контролю учетных записей.</span><span class="sxs-lookup"><span data-stu-id="91e1f-123">If this property is not set, the installer determines whether the package complies with UAC.</span></span>

<span data-ttu-id="91e1f-124">За пределами [Групповая политика](/previous-versions/windows/desktop/Policy/group-policy-start-page)в Windows XP можно использовать следующую проверку соответствия UAC.</span><span class="sxs-lookup"><span data-stu-id="91e1f-124">Outside of [Group Policy](/previous-versions/windows/desktop/Policy/group-policy-start-page), the following check for UAC compliance can be used on Windows XP.</span></span>

<span data-ttu-id="91e1f-125">**Проверка соответствия UAC за пределами групповая политика**</span><span class="sxs-lookup"><span data-stu-id="91e1f-125">**To check for UAC compliance outside of Group Policy**</span></span>

1.  <span data-ttu-id="91e1f-126">Войдите в систему с учетной записью администратора.</span><span class="sxs-lookup"><span data-stu-id="91e1f-126">Log on to the computer as an administrator.</span></span>
2.  <span data-ttu-id="91e1f-127">Объявить пакет для установки на компьютере:</span><span class="sxs-lookup"><span data-stu-id="91e1f-127">Advertise the package for a per-machine installation:</span></span>

    <span data-ttu-id="91e1f-128">**msiexec/жм** *package.msi*</span><span class="sxs-lookup"><span data-stu-id="91e1f-128">**msiexec /jm** *package.msi*</span></span>

3.  <span data-ttu-id="91e1f-129">Выйдите из системы на компьютере.</span><span class="sxs-lookup"><span data-stu-id="91e1f-129">Log off the computer.</span></span>
4.  <span data-ttu-id="91e1f-130">Войдите в систему в качестве обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="91e1f-130">Log on to the computer as a standard user.</span></span>
5.  <span data-ttu-id="91e1f-131">Попытка установить объявленный пакет:</span><span class="sxs-lookup"><span data-stu-id="91e1f-131">Attempt to install the advertised package:</span></span>

    <span data-ttu-id="91e1f-132">**msiexec/i** *package.msi*</span><span class="sxs-lookup"><span data-stu-id="91e1f-132">**msiexec /i** *package.msi*</span></span>

6.  <span data-ttu-id="91e1f-133">В большинстве случаев, если установка выполнена успешно, пакет совместим с UAC.</span><span class="sxs-lookup"><span data-stu-id="91e1f-133">In most cases, if the installation is successful, the package is UAC compliant.</span></span>
7.  <span data-ttu-id="91e1f-134">Задайте для свойства [**мсидеплойменткомплиант**](msideploymentcompliant.md) в пакете значение 1.</span><span class="sxs-lookup"><span data-stu-id="91e1f-134">Set the [**MSIDEPLOYMENTCOMPLIANT**](msideploymentcompliant.md) property in the package to 1.</span></span>
8.  <span data-ttu-id="91e1f-135">Проверьте правильность установки пакета с помощью Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="91e1f-135">Test for correct installation of the package using Windows Vista.</span></span>

 

 
