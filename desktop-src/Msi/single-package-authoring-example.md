---
description: Пример PUASample.msi — это пример пакета с двойным набором установщик Windows 5,0, который может быть установлен в контексте установки на уровне пользователя или на компьютере в Windows Server 2008 R2 и Windows 7.
ms.assetid: be018e8a-ca5f-4135-a019-970ec4173f23
title: Пример создания отдельного пакета
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0ed56b8d7aaf8793416ba3ecab24c1f2a48ffe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105650964"
---
# <a name="single-package-authoring-example"></a><span data-ttu-id="d9176-103">Пример создания отдельного пакета</span><span class="sxs-lookup"><span data-stu-id="d9176-103">Single Package Authoring Example</span></span>

<span data-ttu-id="d9176-104">Пример PUASample.msi — это пример пакета с двойным набором установщик Windows 5,0, который может быть установлен в [контексте установки](installation-context.md) на уровне пользователя или на компьютере в windows Server 2008 R2 и Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d9176-104">The sample PUASample.msi is an example of a dual-purpose Windows Installer 5.0 package that is capable of being installed in either the per-user or per-machine [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="d9176-105">Этот пример пакета соответствует рекомендациям по разработке, описанным в разделе [Создание отдельных пакетов](single-package-authoring.md).</span><span class="sxs-lookup"><span data-stu-id="d9176-105">This sample package follows the development guidelines described in [Single Package Authoring](single-package-authoring.md).</span></span>

## <a name="obtaining-a-copy-of-the-sample"></a><span data-ttu-id="d9176-106">Получение копии образца</span><span class="sxs-lookup"><span data-stu-id="d9176-106">Obtaining a copy of the sample</span></span>

<span data-ttu-id="d9176-107">Копия этого примера и установщик Windows редактор таблиц базы данных, Orca.exe, находятся в [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="d9176-107">A copy of this sample and a Windows Installer database table editor, Orca.exe, are in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="d9176-108">Редактор образцов и таблиц предоставляется вместе с пакетом средств разработки программного обеспечения Windows для Windows Server 2008 R2 и Windows 7 в качестве файлов установки установщик Windows PUASample1.msi и Orca.msi.</span><span class="sxs-lookup"><span data-stu-id="d9176-108">The sample and table editor are provided with the Windows Software Development Kit for Windows Server 2008 R2 and Windows 7 as the Windows Installer installation files PUASample1.msi and Orca.msi.</span></span>

## <a name="system-requirements"></a><span data-ttu-id="d9176-109">Требования к системе</span><span class="sxs-lookup"><span data-stu-id="d9176-109">System Requirements</span></span>

<span data-ttu-id="d9176-110">Для работы с редактором баз данных [Orca.exe](orca-exe.md)требуется windows Server 2008 R2 и более ранних версий, а также Windows 7 и более ранних версий.</span><span class="sxs-lookup"><span data-stu-id="d9176-110">The database editor, [Orca.exe](orca-exe.md), requires Windows Server 2008 R2 and earlier and Windows 7 and earlier.</span></span> <span data-ttu-id="d9176-111">Пакет с двойным назначением, PUASample1.msi, можно установить в [контексте установки](installation-context.md) на компьютере или на уровне пользователя в windows Server 2008 R2 и Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d9176-111">The dual-purpose package, PUASample1.msi, can be installed in either the per-machine or per-user [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="d9176-112">PUASample1.msi можно установить только в контексте на компьютере под управлением Windows Server 2008 и более ранних версий, а также в Windows Vista и более ранних версиях.</span><span class="sxs-lookup"><span data-stu-id="d9176-112">PUASample1.msi can be installed only in the per-machine context on Windows Server 2008 and earlier and Windows Vista and earlier.</span></span> <span data-ttu-id="d9176-113">Можно установить редактор базы данных, чтобы проверить содержимое PUASample1.msi без установки образца.</span><span class="sxs-lookup"><span data-stu-id="d9176-113">You can install the database editor to examine the contents of PUASample1.msi without installing the sample.</span></span> <span data-ttu-id="d9176-114">Чтобы установить образцы или пакеты редактора, убедитесь, что для политики [дисаблемси](disablemsi.md) не задано значение, блокирующее установку приложений.</span><span class="sxs-lookup"><span data-stu-id="d9176-114">To install the sample or editor packages, ensure that the [DisableMSI](disablemsi.md) policy is not set to a value that blocks application installations.</span></span>

## <a name="identifying-a-dual-purpose-package"></a><span data-ttu-id="d9176-115">Определение пакета Dual-Purpose</span><span class="sxs-lookup"><span data-stu-id="d9176-115">Identifying a Dual-Purpose Package</span></span>

<span data-ttu-id="d9176-116">Пакеты с двойным набором целей должны инициализировать значение свойства [**мсиинсталлперусер**](msiinstallperuser.md) равным 1.</span><span class="sxs-lookup"><span data-stu-id="d9176-116">Dual-purpose packages should initialize the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1.</span></span> <span data-ttu-id="d9176-117">Это означает, что пакет может быть установлен в контексте "на компьютер" или "на пользователя" в Windows Server 2008 R2 и Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d9176-117">This identifies the package as capable of being installed in either the per-machine or per-user context on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="d9176-118">Установите свойство **мсиинсталлперусер** в пакете только в том случае, если оно было написано согласно рекомендациям по разработке, описанным в разделе [Создание отдельных пакетов](single-package-authoring.md) , и если предполагается предоставлять пользователям возможность установки пакета в контексте для каждого пользователя или на компьютере.</span><span class="sxs-lookup"><span data-stu-id="d9176-118">Set the **MSIINSTALLPERUSER** property in the package only if it has been written following the development guidelines described in [Single Package Authoring](single-package-authoring.md) and if you intend to provide users with the option to install the package in either the per-user or per-machine context.</span></span> <span data-ttu-id="d9176-119">Пакет с двойным набором значений также должен инициализировать значение свойства [**ALLUSERS**](allusers.md) равным 2.</span><span class="sxs-lookup"><span data-stu-id="d9176-119">A dual-purpose package should also initialize the value of the [**ALLUSERS**](allusers.md) property to 2.</span></span> <span data-ttu-id="d9176-120">В этом случае для каждого пользователя в качестве контекста установки по умолчанию для приложения указывается.</span><span class="sxs-lookup"><span data-stu-id="d9176-120">This specifies per-user as the default installation context for the application.</span></span> <span data-ttu-id="d9176-121">Если значение свойства **ALLUSERS** имеет любое значение, отличное от 2, установщик Windows игнорирует свойство **мсиинсталлперусер** .</span><span class="sxs-lookup"><span data-stu-id="d9176-121">If the value of the **ALLUSERS** property is any value other than 2, Windows Installer ignores the **MSIINSTALLPERUSER** property.</span></span>

<span data-ttu-id="d9176-122">Для просмотра содержимого PUASample1.msi используйте редактор базы данных установщик Windows, например [Orca.exe](orca-exe.md).</span><span class="sxs-lookup"><span data-stu-id="d9176-122">Use a Windows Installer database editor, such as [Orca.exe](orca-exe.md), to examine the contents of PUASample1.msi.</span></span> <span data-ttu-id="d9176-123">Таблица [свойств](property-table.md) в образце пакета содержит следующие две записи.</span><span class="sxs-lookup"><span data-stu-id="d9176-123">The [Property](property-table.md) table in the sample package contains the following two entries.</span></span>

<span data-ttu-id="d9176-124">[Свойство](property-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-124">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-125">Свойство</span><span class="sxs-lookup"><span data-stu-id="d9176-125">Property</span></span>          | <span data-ttu-id="d9176-126">Значение</span><span class="sxs-lookup"><span data-stu-id="d9176-126">Value</span></span> |
|-------------------|-------|
| <span data-ttu-id="d9176-127">ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="d9176-127">ALLUSERS</span></span>          | <span data-ttu-id="d9176-128">2</span><span class="sxs-lookup"><span data-stu-id="d9176-128">2</span></span>     |
| <span data-ttu-id="d9176-129">мсиинсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-129">MSIINSTALLPERUSER</span></span> | <span data-ttu-id="d9176-130">1</span><span class="sxs-lookup"><span data-stu-id="d9176-130">1</span></span>     |



 

## <a name="custom-dialog-box-for-installation-context"></a><span data-ttu-id="d9176-131">Настраиваемое диалоговое окно для контекста установки</span><span class="sxs-lookup"><span data-stu-id="d9176-131">Custom Dialog Box for Installation Context</span></span>

<span data-ttu-id="d9176-132">[Пользовательский интерфейс](user-interface.md) примера пакета содержит пример пользовательского диалогового окна верифиреадидиалог, которое позволяет пользователям выбирать контекст установки для каждого пользователя или компьютера во время установки.</span><span class="sxs-lookup"><span data-stu-id="d9176-132">The [user interface](user-interface.md) of the sample package includes an example of a custom dialog box, VerifyReadyDialog, that enables users to select either the per-user or per-machine installation context at installation time.</span></span> <span data-ttu-id="d9176-133">[Диалоговая](dialog-table.md) таблица содержит запись, описывающую диалоговое окно верифиреадидиалог.</span><span class="sxs-lookup"><span data-stu-id="d9176-133">The [Dialog](dialog-table.md) table contains a record that describes the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="d9176-134">Значение, указанное в поле Attributes, равно 39, так как в этом диалоговом окне используются [биты стиля диалогового окна](dialog-style-bits.md)мсидбдиалогаттрибутесвисибле (1), мсидбдиалогаттрибутесмодал (2), мсидбдиалогаттрибутесминимизе (4) и msidbDialogAttributesTrackDiskSpace (32).</span><span class="sxs-lookup"><span data-stu-id="d9176-134">The value entered in the Attributes field is 39 because this dialog box uses the msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4), and msidbDialogAttributesTrackDiskSpace (32) [dialog style bits](dialog-style-bits.md).</span></span> <span data-ttu-id="d9176-135">В строке заголовка диалогового окна отображается заголовок, заданный значением свойства [**ProductName**](productname.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-135">The title bar of the dialog box displays a title given by the value of the [**ProductName**](productname.md) property.</span></span>

<span data-ttu-id="d9176-136">[Диалоговое окно](dialog-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-136">[Dialog](dialog-table.md) Table (partial)</span></span> 

| <span data-ttu-id="d9176-137">Диалог</span><span class="sxs-lookup"><span data-stu-id="d9176-137">Dialog</span></span>            | <span data-ttu-id="d9176-138">хцентеринг</span><span class="sxs-lookup"><span data-stu-id="d9176-138">HCentering</span></span> | <span data-ttu-id="d9176-139">VCentering</span><span class="sxs-lookup"><span data-stu-id="d9176-139">VCentering</span></span> | <span data-ttu-id="d9176-140">Ширина</span><span class="sxs-lookup"><span data-stu-id="d9176-140">Width</span></span> | <span data-ttu-id="d9176-141">Высота:</span><span class="sxs-lookup"><span data-stu-id="d9176-141">Height</span></span> | <span data-ttu-id="d9176-142">Атрибуты</span><span class="sxs-lookup"><span data-stu-id="d9176-142">Attributes</span></span> | <span data-ttu-id="d9176-143">Заголовок</span><span class="sxs-lookup"><span data-stu-id="d9176-143">Title</span></span>           | <span data-ttu-id="d9176-144">Сначала элемент управления \_</span><span class="sxs-lookup"><span data-stu-id="d9176-144">Control\_First</span></span> | <span data-ttu-id="d9176-145">Элемент управления \_ по умолчанию</span><span class="sxs-lookup"><span data-stu-id="d9176-145">Control\_Default</span></span> | <span data-ttu-id="d9176-146">\_Отмена управления</span><span class="sxs-lookup"><span data-stu-id="d9176-146">Control\_Cancel</span></span> |
|-------------------|------------|------------|-------|--------|------------|-----------------|----------------|------------------|-----------------|
| <span data-ttu-id="d9176-147">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-147">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-148">50</span><span class="sxs-lookup"><span data-stu-id="d9176-148">50</span></span>         | <span data-ttu-id="d9176-149">50</span><span class="sxs-lookup"><span data-stu-id="d9176-149">50</span></span>         | <span data-ttu-id="d9176-150">480</span><span class="sxs-lookup"><span data-stu-id="d9176-150">480</span></span>   | <span data-ttu-id="d9176-151">280</span><span class="sxs-lookup"><span data-stu-id="d9176-151">280</span></span>    | <span data-ttu-id="d9176-152">39</span><span class="sxs-lookup"><span data-stu-id="d9176-152">39</span></span>         | <span data-ttu-id="d9176-153">\[ProductName\]</span><span class="sxs-lookup"><span data-stu-id="d9176-153">\[ProductName\]</span></span> | <span data-ttu-id="d9176-154">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-154">InstallPerUser</span></span> | <span data-ttu-id="d9176-155">Следующая</span><span class="sxs-lookup"><span data-stu-id="d9176-155">Next</span></span>             | <span data-ttu-id="d9176-156">Отменить</span><span class="sxs-lookup"><span data-stu-id="d9176-156">Cancel</span></span>          |



 

<span data-ttu-id="d9176-157">Таблица [элементов управления](control-table.md) содержит записи для [элементов управления](controls.md) , отображаемых в диалоговом окне верифиреадидиалог.</span><span class="sxs-lookup"><span data-stu-id="d9176-157">The [Control](control-table.md) table contains entries for the [controls](controls.md) displayed by the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="d9176-158">В диалоговом окне отображаются [кнопки](pushbutton-control.md) и элементы управления " [надпись](text-control.md) ".</span><span class="sxs-lookup"><span data-stu-id="d9176-158">The dialog box displays [PushButton](pushbutton-control.md) controls and a [Text](text-control.md) control.</span></span> <span data-ttu-id="d9176-159">Все элементы управления используют [атрибуты управления](control-attributes.md)мсидбконтролаттрибутесенаблед (2) и мсидбконтролаттрибутесвисибле (1).</span><span class="sxs-lookup"><span data-stu-id="d9176-159">All the controls use the msidbControlAttributesEnabled (2) and msidbControlAttributesVisible (1) [control attributes](control-attributes.md).</span></span> <span data-ttu-id="d9176-160">Элемент управления Инсталлпермачине также использует атрибут элемента управления [елеватионшиелд](elevationshield-attribute.md) , мсидбконтролаттрибутеселеватионшиелд (8388608.) Этот атрибут элемента управления добавляет значок повышения прав контроля [*учетных записей*](u-gly.md) (UAC) (значок щита) в элемент управления инсталлпермачине и информирует пользователя о том, что для установки приложения в контексте на компьютере требуются учетные данные контроля учетных записей.</span><span class="sxs-lookup"><span data-stu-id="d9176-160">The InstallPerMachine control also uses the [ElevationShield](elevationshield-attribute.md) control attribute, msidbControlAttributesElevationShield (8388608.) This control attribute adds the [*User Account Control*](u-gly.md) (UAC) elevation icon (shield icon) to the InstallPerMachine control and informs the user that UAC credentials are required to install the application in the per-machine context.</span></span> <span data-ttu-id="d9176-161">Значение в текстовом поле таблицы управления является текстовым стилем и текстом, отображаемым элементом управления.</span><span class="sxs-lookup"><span data-stu-id="d9176-161">The value in the Text field of the Control table is the text-style and text displayed by the control.</span></span> <span data-ttu-id="d9176-162">Дополнительные сведения о добавлении текста в элемент управления с помощью предопределенных стилей см. в описании текстового поля в разделе «элемент управления».</span><span class="sxs-lookup"><span data-stu-id="d9176-162">See the description of the Text field in the Control table topic for more information about adding text to a control using predefined styles.</span></span>

<span data-ttu-id="d9176-163">[Элемент управления](control-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-163">[Control](control-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-164">Диалог\_</span><span class="sxs-lookup"><span data-stu-id="d9176-164">Dialog\_</span></span>          | <span data-ttu-id="d9176-165">Control</span><span class="sxs-lookup"><span data-stu-id="d9176-165">Control</span></span>           | <span data-ttu-id="d9176-166">Тип</span><span class="sxs-lookup"><span data-stu-id="d9176-166">Type</span></span>       | <span data-ttu-id="d9176-167">attribute</span><span class="sxs-lookup"><span data-stu-id="d9176-167">Attribute</span></span> | <span data-ttu-id="d9176-168">Текст</span><span class="sxs-lookup"><span data-stu-id="d9176-168">Text</span></span>                                                   | <span data-ttu-id="d9176-169">Управление \_ следующим</span><span class="sxs-lookup"><span data-stu-id="d9176-169">Control\_Next</span></span>     |
|-------------------|-------------------|------------|-----------|--------------------------------------------------------|-------------------|
| <span data-ttu-id="d9176-170">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-170">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-171">Отменить</span><span class="sxs-lookup"><span data-stu-id="d9176-171">Cancel</span></span>            | <span data-ttu-id="d9176-172">PushButton</span><span class="sxs-lookup"><span data-stu-id="d9176-172">PushButton</span></span> | <span data-ttu-id="d9176-173">3</span><span class="sxs-lookup"><span data-stu-id="d9176-173">3</span></span>         | <span data-ttu-id="d9176-174">{ \\ Tahoma10} &Отмена</span><span class="sxs-lookup"><span data-stu-id="d9176-174">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="d9176-175">Следующая</span><span class="sxs-lookup"><span data-stu-id="d9176-175">Next</span></span>              |
| <span data-ttu-id="d9176-176">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-176">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-177">Назад</span><span class="sxs-lookup"><span data-stu-id="d9176-177">Previous</span></span>          | <span data-ttu-id="d9176-178">PushButton</span><span class="sxs-lookup"><span data-stu-id="d9176-178">PushButton</span></span> | <span data-ttu-id="d9176-179">3</span><span class="sxs-lookup"><span data-stu-id="d9176-179">3</span></span>         | <span data-ttu-id="d9176-180">{ \\ Tahoma10} <<&назад</span><span class="sxs-lookup"><span data-stu-id="d9176-180">{\\Tahoma10}<<&Previous</span></span>                          | <span data-ttu-id="d9176-181">Отменить</span><span class="sxs-lookup"><span data-stu-id="d9176-181">Cancel</span></span>            |
| <span data-ttu-id="d9176-182">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-182">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-183">Следующая</span><span class="sxs-lookup"><span data-stu-id="d9176-183">Next</span></span>              | <span data-ttu-id="d9176-184">PushButton</span><span class="sxs-lookup"><span data-stu-id="d9176-184">PushButton</span></span> | <span data-ttu-id="d9176-185">3</span><span class="sxs-lookup"><span data-stu-id="d9176-185">3</span></span>         | <span data-ttu-id="d9176-186">{ \\ Tahoma10} &следующие >></span><span class="sxs-lookup"><span data-stu-id="d9176-186">{\\Tahoma10}&Next >></span></span>                             | <span data-ttu-id="d9176-187">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-187">InstallPerUser</span></span>    |
| <span data-ttu-id="d9176-188">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-188">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-189">Text2</span><span class="sxs-lookup"><span data-stu-id="d9176-189">Text2</span></span>             | <span data-ttu-id="d9176-190">Текст</span><span class="sxs-lookup"><span data-stu-id="d9176-190">Text</span></span>       | <span data-ttu-id="d9176-191">3</span><span class="sxs-lookup"><span data-stu-id="d9176-191">3</span></span>         | <span data-ttu-id="d9176-192">Вы готовы выполнить приостановленную установку?</span><span class="sxs-lookup"><span data-stu-id="d9176-192">Are you ready to complete your suspended installation?</span></span> |                   |
| <span data-ttu-id="d9176-193">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-193">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-194">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-194">InstallPerUser</span></span>    | <span data-ttu-id="d9176-195">PushButton</span><span class="sxs-lookup"><span data-stu-id="d9176-195">PushButton</span></span> | <span data-ttu-id="d9176-196">3</span><span class="sxs-lookup"><span data-stu-id="d9176-196">3</span></span>         | <span data-ttu-id="d9176-197">{ \\ Tahoma10} — установка только для &Me</span><span class="sxs-lookup"><span data-stu-id="d9176-197">{\\Tahoma10}Install Only for &Me</span></span>                       | <span data-ttu-id="d9176-198">инсталлпермачине</span><span class="sxs-lookup"><span data-stu-id="d9176-198">InstallPerMachine</span></span> |
| <span data-ttu-id="d9176-199">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-199">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-200">инсталлпермачине</span><span class="sxs-lookup"><span data-stu-id="d9176-200">InstallPerMachine</span></span> | <span data-ttu-id="d9176-201">PushButton</span><span class="sxs-lookup"><span data-stu-id="d9176-201">PushButton</span></span> | <span data-ttu-id="d9176-202">8388611</span><span class="sxs-lookup"><span data-stu-id="d9176-202">8388611</span></span>   | <span data-ttu-id="d9176-203">{ \\ Tahoma10} установка для &всех</span><span class="sxs-lookup"><span data-stu-id="d9176-203">{\\Tahoma10}Install for &Everyone</span></span>                      | <span data-ttu-id="d9176-204">Назад</span><span class="sxs-lookup"><span data-stu-id="d9176-204">Previous</span></span>          |
| <span data-ttu-id="d9176-205">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-205">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-206">Отменить</span><span class="sxs-lookup"><span data-stu-id="d9176-206">Cancel</span></span>            | <span data-ttu-id="d9176-207">PushButton</span><span class="sxs-lookup"><span data-stu-id="d9176-207">PushButton</span></span> | <span data-ttu-id="d9176-208">3</span><span class="sxs-lookup"><span data-stu-id="d9176-208">3</span></span>         | <span data-ttu-id="d9176-209">{ \\ Tahoma10} &Отмена</span><span class="sxs-lookup"><span data-stu-id="d9176-209">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="d9176-210">Следующая</span><span class="sxs-lookup"><span data-stu-id="d9176-210">Next</span></span>              |



 

<span data-ttu-id="d9176-211">В таблице [таблице ControlEvent событие](controlevent-table.md) указаны [контролевентс](control-events.md)или действия, выполняемые установщиком при взаимодействии пользователя с элементом управления.</span><span class="sxs-lookup"><span data-stu-id="d9176-211">The [ControlEvent](controlevent-table.md) table specifies the [ControlEvents](control-events.md), or actions, the installer performs when the user interacts with a control.</span></span> <span data-ttu-id="d9176-212">Когда пользователь активирует Инсталлперусерную кнопка, Пользовательский интерфейс отображает диалоговое окно Аутофдиск, если свойство [**аутофдискспаце**](outofdiskspace.md) равно 1, устанавливает значение свойства [**мсиинсталлперусер**](msiinstallperuser.md) равным 1, устанавливает [**для свойства**](allusers.md) [**мсифастинсталл**](msifastinstall.md) значение 1 и возвращает.</span><span class="sxs-lookup"><span data-stu-id="d9176-212">When a user activates the InstallPerUser pushbutton, the user interface displays an OutOfDisk dialog box if the [**OutOfDiskSpace**](outofdiskspace.md) property is 1, sets the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1, sets the value of the [**ALLUSERS**](allusers.md) property to 2, sets the [**MSIFASTINSTALL**](msifastinstall.md) property to 1, and returns .</span></span> <span data-ttu-id="d9176-213">Так как свойство **мсифастинсталл** задано, для установки не создается точка восстановления системы.</span><span class="sxs-lookup"><span data-stu-id="d9176-213">Because the **MSIFASTINSTALL** property is set, no System Restore point is generated for the installation.</span></span> <span data-ttu-id="d9176-214">Когда пользователь активирует Инсталлпермачиненую кнопка, Пользовательский интерфейс отображает диалоговое окно Аутофдиск, если свойство **аутофдискспаце** равно 1, устанавливает значение свойства **ALLUSERS** равным 1 и возвращает.</span><span class="sxs-lookup"><span data-stu-id="d9176-214">When a user activates the InstallPerMachine pushbutton, the user interface displays an OutOfDisk dialog box if the **OutOfDiskSpace** property is 1, sets the value of the **ALLUSERS** property to 1, and returns.</span></span>

<span data-ttu-id="d9176-215">[Таблице ControlEvent событие](controlevent-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-215">[ControlEvent](controlevent-table.md) Table (partial)</span></span> 

| <span data-ttu-id="d9176-216">Диалог\_</span><span class="sxs-lookup"><span data-stu-id="d9176-216">Dialog\_</span></span>          | <span data-ttu-id="d9176-217">элементом управления\_</span><span class="sxs-lookup"><span data-stu-id="d9176-217">Control\_</span></span>         | <span data-ttu-id="d9176-218">Событие</span><span class="sxs-lookup"><span data-stu-id="d9176-218">Event</span></span>                 | <span data-ttu-id="d9176-219">Аргумент</span><span class="sxs-lookup"><span data-stu-id="d9176-219">Argument</span></span>  | <span data-ttu-id="d9176-220">Условие</span><span class="sxs-lookup"><span data-stu-id="d9176-220">Condition</span></span>                 | <span data-ttu-id="d9176-221">Заказ</span><span class="sxs-lookup"><span data-stu-id="d9176-221">Order</span></span> |
|-------------------|-------------------|-----------------------|-----------|---------------------------|-------|
| <span data-ttu-id="d9176-222">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-222">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-223">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-223">InstallPerUser</span></span>    | <span data-ttu-id="d9176-224">спавндиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-224">SpawnDialog</span></span>           | <span data-ttu-id="d9176-225">аутофдиск</span><span class="sxs-lookup"><span data-stu-id="d9176-225">OutOfDisk</span></span> | <span data-ttu-id="d9176-226">Аутофдискспаце = 1</span><span class="sxs-lookup"><span data-stu-id="d9176-226">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="d9176-227">1</span><span class="sxs-lookup"><span data-stu-id="d9176-227">1</span></span>     |
| <span data-ttu-id="d9176-228">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-228">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-229">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-229">InstallPerUser</span></span>    | <span data-ttu-id="d9176-230">EndDialog</span><span class="sxs-lookup"><span data-stu-id="d9176-230">EndDialog</span></span>             | <span data-ttu-id="d9176-231">Возвращает</span><span class="sxs-lookup"><span data-stu-id="d9176-231">Return</span></span>    | <span data-ttu-id="d9176-232">Аутофдискспаце <> 1</span><span class="sxs-lookup"><span data-stu-id="d9176-232">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="d9176-233">5</span><span class="sxs-lookup"><span data-stu-id="d9176-233">5</span></span>     |
| <span data-ttu-id="d9176-234">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-234">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-235">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-235">InstallPerUser</span></span>    | <span data-ttu-id="d9176-236">\[мсиинсталлперусер\]</span><span class="sxs-lookup"><span data-stu-id="d9176-236">\[MSIINSTALLPERUSER\]</span></span> | <span data-ttu-id="d9176-237">1</span><span class="sxs-lookup"><span data-stu-id="d9176-237">1</span></span>         | <span data-ttu-id="d9176-238">1</span><span class="sxs-lookup"><span data-stu-id="d9176-238">1</span></span>                         | <span data-ttu-id="d9176-239">2</span><span class="sxs-lookup"><span data-stu-id="d9176-239">2</span></span>     |
| <span data-ttu-id="d9176-240">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-240">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-241">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-241">InstallPerUser</span></span>    | <span data-ttu-id="d9176-242">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="d9176-242">\[ALLUSERS\]</span></span>          | <span data-ttu-id="d9176-243">2</span><span class="sxs-lookup"><span data-stu-id="d9176-243">2</span></span>         | <span data-ttu-id="d9176-244">1</span><span class="sxs-lookup"><span data-stu-id="d9176-244">1</span></span>                         | <span data-ttu-id="d9176-245">3</span><span class="sxs-lookup"><span data-stu-id="d9176-245">3</span></span>     |
| <span data-ttu-id="d9176-246">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-246">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-247">инсталлпермачине</span><span class="sxs-lookup"><span data-stu-id="d9176-247">InstallPerMachine</span></span> | <span data-ttu-id="d9176-248">спавндиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-248">SpawnDialog</span></span>           | <span data-ttu-id="d9176-249">аутофдиск</span><span class="sxs-lookup"><span data-stu-id="d9176-249">OutOfDisk</span></span> | <span data-ttu-id="d9176-250">Аутофдискспаце = 1</span><span class="sxs-lookup"><span data-stu-id="d9176-250">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="d9176-251">1</span><span class="sxs-lookup"><span data-stu-id="d9176-251">1</span></span>     |
| <span data-ttu-id="d9176-252">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-252">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-253">инсталлпермачине</span><span class="sxs-lookup"><span data-stu-id="d9176-253">InstallPerMachine</span></span> | <span data-ttu-id="d9176-254">EndDialog</span><span class="sxs-lookup"><span data-stu-id="d9176-254">EndDialog</span></span>             | <span data-ttu-id="d9176-255">Возвращает</span><span class="sxs-lookup"><span data-stu-id="d9176-255">Return</span></span>    | <span data-ttu-id="d9176-256">Аутофдискспаце <> 1</span><span class="sxs-lookup"><span data-stu-id="d9176-256">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="d9176-257">3</span><span class="sxs-lookup"><span data-stu-id="d9176-257">3</span></span>     |
| <span data-ttu-id="d9176-258">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-258">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-259">инсталлпермачине</span><span class="sxs-lookup"><span data-stu-id="d9176-259">InstallPerMachine</span></span> | <span data-ttu-id="d9176-260">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="d9176-260">\[ALLUSERS\]</span></span>          | <span data-ttu-id="d9176-261">1</span><span class="sxs-lookup"><span data-stu-id="d9176-261">1</span></span>         | <span data-ttu-id="d9176-262">1</span><span class="sxs-lookup"><span data-stu-id="d9176-262">1</span></span>                         | <span data-ttu-id="d9176-263">2</span><span class="sxs-lookup"><span data-stu-id="d9176-263">2</span></span>     |
| <span data-ttu-id="d9176-264">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-264">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-265">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-265">InstallPerUser</span></span>    | <span data-ttu-id="d9176-266">\[мсифастинсталл\]</span><span class="sxs-lookup"><span data-stu-id="d9176-266">\[MSIFASTINSTALL\]</span></span>    | <span data-ttu-id="d9176-267">1</span><span class="sxs-lookup"><span data-stu-id="d9176-267">1</span></span>         | <span data-ttu-id="d9176-268">1</span><span class="sxs-lookup"><span data-stu-id="d9176-268">1</span></span>                         | <span data-ttu-id="d9176-269">4</span><span class="sxs-lookup"><span data-stu-id="d9176-269">4</span></span>     |



 

<span data-ttu-id="d9176-270">Элемент управления Инсталлперусер должен быть удален из пользовательского интерфейса любой установки с использованием установщик Windows версии, более ранней, чем установщик Windows установщик Windows 5,0.</span><span class="sxs-lookup"><span data-stu-id="d9176-270">The InstallPerUser control should be removed from the user interface of any installation using a Windows Installer version earlier than Windows Installer Windows Installer 5.0.</span></span> <span data-ttu-id="d9176-271">Таблица [Таблица controlcondition](controlcondition-table.md) в образце пакета содержит четыре записи, которые отключают и скрывают элемент управления инсталлперусер, если текущая версия меньше установщик Windows 5,0.</span><span class="sxs-lookup"><span data-stu-id="d9176-271">The [ControlCondition](controlcondition-table.md) table in the sample package contains four entries that disable and hide the InstallPerUser control if the current version is less than Windows Installer 5.0.</span></span> <span data-ttu-id="d9176-272">Для определения этого условия в таблице используется значение свойства [**версионмси**](versionmsi.md) и [синтаксис условного оператора](conditional-statement-syntax.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-272">The table uses the value of the [**VersionMsi**](versionmsi.md) property and the [conditional statement syntax](conditional-statement-syntax.md) to define this condition.</span></span> <span data-ttu-id="d9176-273">Действие, указанное в поле действие, выполняется только в том случае, если оператор в поле Condition имеет значение true.</span><span class="sxs-lookup"><span data-stu-id="d9176-273">The action specified in the Action field is performed only if the statement in the Condition field is true.</span></span>

<span data-ttu-id="d9176-274">[Таблица controlcondition](controlcondition-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-274">[ControlCondition](controlcondition-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-275">Диалог\_</span><span class="sxs-lookup"><span data-stu-id="d9176-275">Dialog\_</span></span>          | <span data-ttu-id="d9176-276">элементом управления\_</span><span class="sxs-lookup"><span data-stu-id="d9176-276">Control\_</span></span>      | <span data-ttu-id="d9176-277">Действие</span><span class="sxs-lookup"><span data-stu-id="d9176-277">Action</span></span>  | <span data-ttu-id="d9176-278">Условие</span><span class="sxs-lookup"><span data-stu-id="d9176-278">Condition</span></span>               |
|-------------------|----------------|---------|-------------------------|
| <span data-ttu-id="d9176-279">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-279">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-280">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-280">InstallPerUser</span></span> | <span data-ttu-id="d9176-281">Включить</span><span class="sxs-lookup"><span data-stu-id="d9176-281">Enable</span></span>  | <span data-ttu-id="d9176-282">Версионмси >= "5,00"</span><span class="sxs-lookup"><span data-stu-id="d9176-282">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="d9176-283">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-283">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-284">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-284">InstallPerUser</span></span> | <span data-ttu-id="d9176-285">Отключить</span><span class="sxs-lookup"><span data-stu-id="d9176-285">Disable</span></span> | <span data-ttu-id="d9176-286">Версионмси < "5,00"</span><span class="sxs-lookup"><span data-stu-id="d9176-286">VersionMsi < "5.00"</span></span>  |
| <span data-ttu-id="d9176-287">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-287">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-288">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-288">InstallPerUser</span></span> | <span data-ttu-id="d9176-289">Показать</span><span class="sxs-lookup"><span data-stu-id="d9176-289">Show</span></span>    | <span data-ttu-id="d9176-290">Версионмси >= "5,00"</span><span class="sxs-lookup"><span data-stu-id="d9176-290">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="d9176-291">верифиреадидиалог</span><span class="sxs-lookup"><span data-stu-id="d9176-291">VerifyReadyDialog</span></span> | <span data-ttu-id="d9176-292">инсталлперусер</span><span class="sxs-lookup"><span data-stu-id="d9176-292">InstallPerUser</span></span> | <span data-ttu-id="d9176-293">Скрыть</span><span class="sxs-lookup"><span data-stu-id="d9176-293">Hide</span></span>    | <span data-ttu-id="d9176-294">Версионмси < "5,00"</span><span class="sxs-lookup"><span data-stu-id="d9176-294">VersionMsi < "5.00"</span></span>  |



 

## <a name="specifying-directory-structure"></a><span data-ttu-id="d9176-295">Указание структуры каталогов</span><span class="sxs-lookup"><span data-stu-id="d9176-295">Specifying Directory Structure</span></span>

<span data-ttu-id="d9176-296">Используйте редактор базы данных для проверки таблицы [каталогов](directory-table.md) PUASample1.msi.</span><span class="sxs-lookup"><span data-stu-id="d9176-296">Use the database editor to examine the [Directory](directory-table.md) table of PUASample1.msi.</span></span> <span data-ttu-id="d9176-297">Запись таблицы каталога с пустой строкой в \_ родительском поле каталога представляет корневой каталог как исходного, так и целевого дерева каталогов.</span><span class="sxs-lookup"><span data-stu-id="d9176-297">The record of the Directory Table having an empty string in its Directory\_Parent field represents the root directory of both the source and target directory trees.</span></span> <span data-ttu-id="d9176-298">Если свойство [**targetDir**](targetdir.md) не определено, установщик устанавливает значение свойства [**рутдриве**](rootdrive.md) во время установки.</span><span class="sxs-lookup"><span data-stu-id="d9176-298">If the [**TARGETDIR**](targetdir.md) property is undefined, the installer sets its value at installation time to the value of the [**ROOTDRIVE**](rootdrive.md) property.</span></span> <span data-ttu-id="d9176-299">Если свойство [**SourceDir**](sourcedir.md) не определено, установщик устанавливает в качестве значения расположение каталога, содержащего пакет установщик Windows (MSI-файл). Имена каталогов задаются в коротком \| длинном формате.</span><span class="sxs-lookup"><span data-stu-id="d9176-299">If the [**SourceDir**](sourcedir.md) property is undefined, the installer sets its value to the location of the directory containing the Windows Installer package (.msi file.) The directory names are specified using the short\|long format.</span></span>

<span data-ttu-id="d9176-300">[Каталог](directory-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-300">[Directory](directory-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-301">Каталог</span><span class="sxs-lookup"><span data-stu-id="d9176-301">Directory</span></span>          | <span data-ttu-id="d9176-302">\_Родительский каталог</span><span class="sxs-lookup"><span data-stu-id="d9176-302">Directory\_Parent</span></span>  | <span data-ttu-id="d9176-303">дефаултдир</span><span class="sxs-lookup"><span data-stu-id="d9176-303">DefaultDir</span></span>               |
|--------------------|--------------------|--------------------------|
| <span data-ttu-id="d9176-304">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-304">TARGETDIR</span></span>          |                    | <span data-ttu-id="d9176-305">SourceDir</span><span class="sxs-lookup"><span data-stu-id="d9176-305">SourceDir</span></span>                |
| <span data-ttu-id="d9176-306">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="d9176-306">ProgramFilesFolder</span></span> | <span data-ttu-id="d9176-307">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-307">TARGETDIR</span></span>          | <span data-ttu-id="d9176-308">.</span><span class="sxs-lookup"><span data-stu-id="d9176-308">.</span></span>                        |
| <span data-ttu-id="d9176-309">программенуфолдер</span><span class="sxs-lookup"><span data-stu-id="d9176-309">ProgramMenuFolder</span></span>  | <span data-ttu-id="d9176-310">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-310">TARGETDIR</span></span>          | <span data-ttu-id="d9176-311">.</span><span class="sxs-lookup"><span data-stu-id="d9176-311">.</span></span>                        |
| <span data-ttu-id="d9176-312">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="d9176-312">INSTALLLOCATION</span></span>    | <span data-ttu-id="d9176-313">мивендор</span><span class="sxs-lookup"><span data-stu-id="d9176-313">MyVendor</span></span>           | <span data-ttu-id="d9176-314">Sample1 \| MSDN — PUASample1</span><span class="sxs-lookup"><span data-stu-id="d9176-314">Sample1\|MSDN-PUASample1</span></span> |
| <span data-ttu-id="d9176-315">мивендор</span><span class="sxs-lookup"><span data-stu-id="d9176-315">MyVendor</span></span>           | <span data-ttu-id="d9176-316">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="d9176-316">ProgramFilesFolder</span></span> | <span data-ttu-id="d9176-317">MSFT \| Майкрософт</span><span class="sxs-lookup"><span data-stu-id="d9176-317">Msft\|Microsoft</span></span>          |



 

<span data-ttu-id="d9176-318">В источнике эта таблица [каталогов](directory-table.md) разрешается в следующие пути к каталогам.</span><span class="sxs-lookup"><span data-stu-id="d9176-318">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="d9176-319">\[SourceDir \] \\ MSFT \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-319">\[SourceDir\]\\Msft\\Sample1</span></span>  
<span data-ttu-id="d9176-320">\[SourceDir\]</span><span class="sxs-lookup"><span data-stu-id="d9176-320">\[SourceDir\]</span></span>  
</dl>

<span data-ttu-id="d9176-321">На целевом объекте таблица [Directory](directory-table.md) разрешается в пути в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="d9176-321">At the target, the [Directory](directory-table.md) table resolves to the paths in the following table.</span></span> <span data-ttu-id="d9176-322">Установщик задает значения свойств [**ProgramFilesFolder**](programfilesfolder.md) и [**программенуфолдер**](programmenufolder.md) в местах, зависящих от [контекста установки](installation-context.md) , а также от того, является ли система 32-разрядной или 64-разрядной версией Windows Server 2008 R2 и Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d9176-322">The installer sets the values of the [**ProgramFilesFolder**](programfilesfolder.md) and [**ProgramMenuFolder**](programmenufolder.md) properties to locations that depend upon the [installation context](installation-context.md) and whether the system is the 32-bit or 64-bit versions of Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="d9176-323">Пути к целевым папкам зависят от того, выбирает ли пользователь установку на уровне пользователя или на компьютере.</span><span class="sxs-lookup"><span data-stu-id="d9176-323">The paths to the target folders depend on whether the user selects a per-user or per-machine installation.</span></span>

| <span data-ttu-id="d9176-324">Контекст установки</span><span class="sxs-lookup"><span data-stu-id="d9176-324">Installation Context</span></span> | <span data-ttu-id="d9176-325">Система</span><span class="sxs-lookup"><span data-stu-id="d9176-325">System</span></span>                                                                              | <span data-ttu-id="d9176-326">Примеры путей</span><span class="sxs-lookup"><span data-stu-id="d9176-326">Example Paths</span></span>                                                                                                                    |
|----------------------|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d9176-327">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="d9176-327">Per-Machine</span></span>          | <span data-ttu-id="d9176-328">Windows Server 2008 R2 и Windows 7</span><span class="sxs-lookup"><span data-stu-id="d9176-328">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="d9176-329">32-разрядная версия</span><span class="sxs-lookup"><span data-stu-id="d9176-329">32-bit version</span></span><br/>           | <span data-ttu-id="d9176-330">% ProgramFiles% \\ MSFT \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-330">%ProgramFiles%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="d9176-331">% ALLUSERSPROFILE% \\ \\ \\ программы меню "Пуск" Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="d9176-331">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>                  |
| <span data-ttu-id="d9176-332">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="d9176-332">Per-Machine</span></span>          | <span data-ttu-id="d9176-333">Windows Server 2008 R2 и Windows 7</span><span class="sxs-lookup"><span data-stu-id="d9176-333">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="d9176-334">64-разрядная версия</span><span class="sxs-lookup"><span data-stu-id="d9176-334">64-bit version</span></span><br/>           | <span data-ttu-id="d9176-335">% ProgramFiles (x86)% \\ MSFT \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-335">%ProgramFiles(x86)%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="d9176-336">% ALLUSERSPROFILE% \\ \\ \\ программы меню "Пуск" Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="d9176-336">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>             |
| <span data-ttu-id="d9176-337">Per-User</span><span class="sxs-lookup"><span data-stu-id="d9176-337">Per-User</span></span>             | <span data-ttu-id="d9176-338">Windows Server 2008 R2 и Windows 7</span><span class="sxs-lookup"><span data-stu-id="d9176-338">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="d9176-339">32-разрядная или 64-разрядная версия</span><span class="sxs-lookup"><span data-stu-id="d9176-339">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="d9176-340">% USERPROFILE% \\ AppData \\ Local \\ Programs \\ MSFT \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-340">%USERPROFILE%\\AppData\\Local\\Programs\\Msft\\Sample1</span></span><br/> <span data-ttu-id="d9176-341">\\ \\ \\ Программы меню "Пуск" в Microsoft Windows% AppData% \\</span><span class="sxs-lookup"><span data-stu-id="d9176-341">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/> |



 

<span data-ttu-id="d9176-342">Приложения для каждого пользователя должны храниться во вложенных папках в папке Programs, заданной значением свойства [**ProgramFilesFolder**](programfilesfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-342">Per-user applications should be stored in subfolders under the Programs folder specified by the value of [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span> <span data-ttu-id="d9176-343">Как правило, путь к приложению принимает следующую форму.</span><span class="sxs-lookup"><span data-stu-id="d9176-343">Typically, the path to the application takes the following form.</span></span>

<span data-ttu-id="d9176-344">% LocalAppData% \\ Programs \\ *ISV имя* \\ *AppName*.</span><span class="sxs-lookup"><span data-stu-id="d9176-344">%LOCALAPPDATA%\\Programs\\*ISV name*\\*AppName*.</span></span>

<span data-ttu-id="d9176-345">Данные конфигурации для каждого пользователя должны храниться в папке Programs, заданной значением свойства [**программенуфолдер**](programmenufolder.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-345">Per-user configuration data should be stored in the Programs folder specified by the value of the [**ProgramMenuFolder**](programmenufolder.md) property.</span></span> <span data-ttu-id="d9176-346">Как правило, эта папка находится по следующему пути.</span><span class="sxs-lookup"><span data-stu-id="d9176-346">Typically, this folder is located at the following path.</span></span>

<span data-ttu-id="d9176-347">\\ \\ \\ Программы меню "Пуск" в Microsoft Windows% AppData% \\</span><span class="sxs-lookup"><span data-stu-id="d9176-347">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span>

<span data-ttu-id="d9176-348">При установке [32-разрядных компонентов пакета установщик Windows](32-bit-windows-installer-packages.md) используйте свойство [**ProgramFilesFolder**](programfilesfolder.md) и [**коммонфилесфолдер**](commonfilesfolder.md) в таблице [Directory](directory-table.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-348">If installing [32-bit Windows Installer Package](32-bit-windows-installer-packages.md) components, use the [**ProgramFilesFolder**](programfilesfolder.md) and [**CommonFilesFolder**](commonfilesfolder.md) property in the [Directory](directory-table.md) table.</span></span> <span data-ttu-id="d9176-349">При установке [64-разрядных компонентов пакета установщик Windows](64-bit-windows-installer-packages.md) используйте свойства [**ProgramFiles64Folder**](programfiles64folder.md) и [**CommonFiles64Folder**](commonfiles64folder.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-349">If installing [64-bit Windows Installer Package](64-bit-windows-installer-packages.md) components, use the [**ProgramFiles64Folder**](programfiles64folder.md) and [**CommonFiles64Folder**](commonfiles64folder.md) properties.</span></span> <span data-ttu-id="d9176-350">Если приложение содержит 32-разрядные и 64-разрядные версии одного и того же компонента с одним и тем же именем, убедитесь, что эти версии сохранены в разных каталогах или присвойте им разные имена.</span><span class="sxs-lookup"><span data-stu-id="d9176-350">If your application contains 32-bit and 64-bit versions of the same component, with the same name, ensure that these versions are saved in different directories or give them different names.</span></span>

<span data-ttu-id="d9176-351">В следующей таблице [каталога](directory-table.md) приведен пример макета каталога, совместимого с пакетом, который включает 32-разрядные и 64-разрядные компоненты и включает некоторые компоненты, которые совместно используются в разных приложениях.</span><span class="sxs-lookup"><span data-stu-id="d9176-351">The following [Directory](directory-table.md) table provides an example of a directory layout compatible with a package that includes 32-bit and 64-bit components and includes some components that are shared across applications.</span></span>

| <span data-ttu-id="d9176-352">Каталог</span><span class="sxs-lookup"><span data-stu-id="d9176-352">Directory</span></span>            | <span data-ttu-id="d9176-353">\_Родительский каталог</span><span class="sxs-lookup"><span data-stu-id="d9176-353">Directory\_Parent</span></span>    | <span data-ttu-id="d9176-354">дефаултдир</span><span class="sxs-lookup"><span data-stu-id="d9176-354">DefaultDir</span></span>                        |
|----------------------|----------------------|-----------------------------------|
| <span data-ttu-id="d9176-355">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-355">TARGETDIR</span></span>            |                      | <span data-ttu-id="d9176-356">SourceDir</span><span class="sxs-lookup"><span data-stu-id="d9176-356">SourceDir</span></span>                         |
| <span data-ttu-id="d9176-357">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="d9176-357">ProgramFilesFolder</span></span>   | <span data-ttu-id="d9176-358">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-358">TARGETDIR</span></span>            | <span data-ttu-id="d9176-359">.:P rog32</span><span class="sxs-lookup"><span data-stu-id="d9176-359">.:Prog32</span></span>                          |
| <span data-ttu-id="d9176-360">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="d9176-360">ProgramFiles64Folder</span></span> | <span data-ttu-id="d9176-361">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-361">TARGETDIR</span></span>            | <span data-ttu-id="d9176-362">.:P rog64</span><span class="sxs-lookup"><span data-stu-id="d9176-362">.:Prog64</span></span>                          |
| <span data-ttu-id="d9176-363">коммонфилесфолдер</span><span class="sxs-lookup"><span data-stu-id="d9176-363">CommonFilesFolder</span></span>    | <span data-ttu-id="d9176-364">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-364">TARGETDIR</span></span>            | <span data-ttu-id="d9176-365">.:Share32</span><span class="sxs-lookup"><span data-stu-id="d9176-365">.:Share32</span></span>                         |
| <span data-ttu-id="d9176-366">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="d9176-366">CommonFiles64Folder</span></span>  | <span data-ttu-id="d9176-367">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-367">TARGETDIR</span></span>            | <span data-ttu-id="d9176-368">.:Share64</span><span class="sxs-lookup"><span data-stu-id="d9176-368">.:Share64</span></span>                         |
| <span data-ttu-id="d9176-369">программенуфолдер</span><span class="sxs-lookup"><span data-stu-id="d9176-369">ProgramMenuFolder</span></span>    | <span data-ttu-id="d9176-370">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="d9176-370">TARGETDIR</span></span>            | <span data-ttu-id="d9176-371">.: Sample1 \| MSDN — PUASample1</span><span class="sxs-lookup"><span data-stu-id="d9176-371">.:Sample1\|MSDN-PUASample1</span></span>        |
| <span data-ttu-id="d9176-372">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="d9176-372">INSTALLLOCATION</span></span>      | <span data-ttu-id="d9176-373">мивендор</span><span class="sxs-lookup"><span data-stu-id="d9176-373">MyVendor</span></span>             | <span data-ttu-id="d9176-374">Sample1 \| MSDN — PUASample1</span><span class="sxs-lookup"><span data-stu-id="d9176-374">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="d9176-375">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="d9176-375">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="d9176-376">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="d9176-376">Vendorx64</span></span>            | <span data-ttu-id="d9176-377">Sample1 \| MSDN — PUASample1</span><span class="sxs-lookup"><span data-stu-id="d9176-377">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="d9176-378">шаредлокатион</span><span class="sxs-lookup"><span data-stu-id="d9176-378">SHAREDLOCATION</span></span>       | <span data-ttu-id="d9176-379">швендор</span><span class="sxs-lookup"><span data-stu-id="d9176-379">ShVendor</span></span>             | <span data-ttu-id="d9176-380">Sample1 \| MSDN — PUASample1</span><span class="sxs-lookup"><span data-stu-id="d9176-380">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="d9176-381">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="d9176-381">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="d9176-382">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="d9176-382">ShVendorx64</span></span>          | <span data-ttu-id="d9176-383">Sample1 \| MSDN — PUASample1</span><span class="sxs-lookup"><span data-stu-id="d9176-383">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="d9176-384">мивендор</span><span class="sxs-lookup"><span data-stu-id="d9176-384">MyVendor</span></span>             | <span data-ttu-id="d9176-385">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="d9176-385">ProgramFilesFolder</span></span>   | <span data-ttu-id="d9176-386">MSFT \| Майкрософт</span><span class="sxs-lookup"><span data-stu-id="d9176-386">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="d9176-387">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="d9176-387">Vendorx64</span></span>            | <span data-ttu-id="d9176-388">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="d9176-388">ProgramFiles64Folder</span></span> | <span data-ttu-id="d9176-389">MSFT \| Майкрософт</span><span class="sxs-lookup"><span data-stu-id="d9176-389">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="d9176-390">швендор</span><span class="sxs-lookup"><span data-stu-id="d9176-390">ShVendor</span></span>             | <span data-ttu-id="d9176-391">коммонфилесфолдер</span><span class="sxs-lookup"><span data-stu-id="d9176-391">CommonFilesFolder</span></span>    | <span data-ttu-id="d9176-392">MSFT \| Майкрософт</span><span class="sxs-lookup"><span data-stu-id="d9176-392">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="d9176-393">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="d9176-393">ShVendorx64</span></span>          | <span data-ttu-id="d9176-394">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="d9176-394">CommonFiles64Folder</span></span>  | <span data-ttu-id="d9176-395">MSFT \| Майкрософт</span><span class="sxs-lookup"><span data-stu-id="d9176-395">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="d9176-396">Shrx86</span><span class="sxs-lookup"><span data-stu-id="d9176-396">Shrx86</span></span>               | <span data-ttu-id="d9176-397">шаредлокатион</span><span class="sxs-lookup"><span data-stu-id="d9176-397">SHAREDLOCATION</span></span>       | <span data-ttu-id="d9176-398">x32 \| 32-разрядные компоненты</span><span class="sxs-lookup"><span data-stu-id="d9176-398">x32\|32-bit components</span></span>            |
| <span data-ttu-id="d9176-399">Shrx64</span><span class="sxs-lookup"><span data-stu-id="d9176-399">Shrx64</span></span>               | <span data-ttu-id="d9176-400">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="d9176-400">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="d9176-401">x64 \| 64-разрядные компоненты</span><span class="sxs-lookup"><span data-stu-id="d9176-401">x64\|64-bit components</span></span>            |
| <span data-ttu-id="d9176-402">Binx86</span><span class="sxs-lookup"><span data-stu-id="d9176-402">Binx86</span></span>               | <span data-ttu-id="d9176-403">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="d9176-403">INSTALLLOCATION</span></span>      | <span data-ttu-id="d9176-404">x32 \| 32-разрядные компоненты</span><span class="sxs-lookup"><span data-stu-id="d9176-404">x32\|32-bit components</span></span>            |
| <span data-ttu-id="d9176-405">Binx64</span><span class="sxs-lookup"><span data-stu-id="d9176-405">Binx64</span></span>               | <span data-ttu-id="d9176-406">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="d9176-406">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="d9176-407">x64 \| 64-разрядные компоненты</span><span class="sxs-lookup"><span data-stu-id="d9176-407">x64\|64-bit components</span></span>            |
| <span data-ttu-id="d9176-408">App32</span><span class="sxs-lookup"><span data-stu-id="d9176-408">App32</span></span>                | <span data-ttu-id="d9176-409">Binx86</span><span class="sxs-lookup"><span data-stu-id="d9176-409">Binx86</span></span>               | <span data-ttu-id="d9176-410">MyApp \| — несовместное использование 32-разрядных компонентов</span><span class="sxs-lookup"><span data-stu-id="d9176-410">myapp\|unshared 32-bit components</span></span> |
| <span data-ttu-id="d9176-411">App64</span><span class="sxs-lookup"><span data-stu-id="d9176-411">App64</span></span>                | <span data-ttu-id="d9176-412">Binx64</span><span class="sxs-lookup"><span data-stu-id="d9176-412">Binx64</span></span>               | <span data-ttu-id="d9176-413">MyApp \| — несовместное использование 64-разрядных компонентов</span><span class="sxs-lookup"><span data-stu-id="d9176-413">myapp\|unshared 64-bit components</span></span> |
| <span data-ttu-id="d9176-414">Share32</span><span class="sxs-lookup"><span data-stu-id="d9176-414">Share32</span></span>              | <span data-ttu-id="d9176-415">Shrx86</span><span class="sxs-lookup"><span data-stu-id="d9176-415">Shrx86</span></span>               | <span data-ttu-id="d9176-416">Общие \| общие 32-разрядные компоненты</span><span class="sxs-lookup"><span data-stu-id="d9176-416">shared\|shared 32-bit components</span></span>  |
| <span data-ttu-id="d9176-417">Share64</span><span class="sxs-lookup"><span data-stu-id="d9176-417">Share64</span></span>              | <span data-ttu-id="d9176-418">Shrx64</span><span class="sxs-lookup"><span data-stu-id="d9176-418">Shrx64</span></span>               | <span data-ttu-id="d9176-419">Общие \| общие 64-разрядные компоненты</span><span class="sxs-lookup"><span data-stu-id="d9176-419">shared\|shared 64-bit components</span></span>  |



 

<span data-ttu-id="d9176-420">В источнике эта таблица [каталогов](directory-table.md) разрешается в следующие пути к каталогам.</span><span class="sxs-lookup"><span data-stu-id="d9176-420">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="d9176-421">\[SourceDir \] Prog32 \\ MSFT \\ sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-421">\[SourceDir\]Prog32\\Msft\\Sample1\\x32\\myapp</span></span>  
<span data-ttu-id="d9176-422">\[SourceDir \] Share32 \\ Common Files \\ MSFT \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-422">\[SourceDir\]Share32\\Common Files\\Msft\\Sample1\\x32\\shared</span></span>  
<span data-ttu-id="d9176-423">\[SourceDir \] Prog64 \\ MSFT \\ sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-423">\[SourceDir\]Prog64\\Msft\\Sample1\\x64\\myapp</span></span>  
<span data-ttu-id="d9176-424">\[SourceDir \] Share64 \\ Common Files \\ MSFT \\ sample1 \\ x64 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-424">\[SourceDir\]Share64\\Common Files\\Msft\\Sample1\\x64\\shared</span></span>  
<span data-ttu-id="d9176-425">\[SourceDir \] sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-425">\[SourceDir\]Sample1</span></span>  
</dl>

<span data-ttu-id="d9176-426">На целевом объекте эта таблица [каталогов](directory-table.md) разрешается в следующие пути к каталогам.</span><span class="sxs-lookup"><span data-stu-id="d9176-426">At the target, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span> <span data-ttu-id="d9176-427">Целевые пути зависят от [контекста установки](installation-context.md) и системы.</span><span class="sxs-lookup"><span data-stu-id="d9176-427">The target paths depend on the [installation context](installation-context.md) and system.</span></span>

| <span data-ttu-id="d9176-428">Контекст установки</span><span class="sxs-lookup"><span data-stu-id="d9176-428">Installation Context</span></span> | <span data-ttu-id="d9176-429">Система</span><span class="sxs-lookup"><span data-stu-id="d9176-429">System</span></span>                                                                              | <span data-ttu-id="d9176-430">Примеры путей</span><span class="sxs-lookup"><span data-stu-id="d9176-430">Example Paths</span></span>                                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d9176-431">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="d9176-431">Per-Machine</span></span>          | <span data-ttu-id="d9176-432">Windows Server 2008 R2 и Windows 7</span><span class="sxs-lookup"><span data-stu-id="d9176-432">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="d9176-433">32-разрядная версия</span><span class="sxs-lookup"><span data-stu-id="d9176-433">32-bit version</span></span><br/>           | <span data-ttu-id="d9176-434">% ProgramFiles% \\ MSFT \\ sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-434">%ProgramFiles%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="d9176-435">% ProgramFiles% \\ общих файлов \\ MSFT \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-435">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="d9176-436">% ProgramFiles (x86)% \\ MSFT \\ sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-436">%ProgramFiles(x86)%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="d9176-437">% ProgramFiles (x86)% \\ Common Files \\ MSFT \\ sample1 \\ x64 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-437">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="d9176-438">% Папка ProgramData% \\ \\ программ меню "Пуск" Microsoft Windows \\ \\ \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-438">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="d9176-439">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="d9176-439">Per-Machine</span></span>          | <span data-ttu-id="d9176-440">Windows Server 2008 R2 и Windows 7</span><span class="sxs-lookup"><span data-stu-id="d9176-440">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="d9176-441">64-разрядная версия</span><span class="sxs-lookup"><span data-stu-id="d9176-441">64-bit version</span></span><br/>           | <span data-ttu-id="d9176-442">% ProgramFiles (x86)% \\ MSFT \\ sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-442">%ProgramFiles(x86)%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="d9176-443">% ProgramFiles (x86)% \\ Common Files \\ MSFT \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-443">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="d9176-444">% ProgramFiles% \\ MSFT \\ sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-444">%ProgramFiles%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="d9176-445">% ProgramFiles% общих \\ файлов \\ MSFT \\ sample1 \\ x64 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-445">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="d9176-446">% Папка ProgramData% \\ \\ программ меню "Пуск" Microsoft Windows \\ \\ \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-446">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="d9176-447">Per-User</span><span class="sxs-lookup"><span data-stu-id="d9176-447">Per-User</span></span>             | <span data-ttu-id="d9176-448">Windows Server 2008 R2 и Windows 7</span><span class="sxs-lookup"><span data-stu-id="d9176-448">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="d9176-449">32-разрядная или 64-разрядная версия</span><span class="sxs-lookup"><span data-stu-id="d9176-449">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="d9176-450">% LOCALAPPDATA% \\ Programs \\ MSFT \\ sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-450">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="d9176-451">% LOCALAPPDATA% \\ Programs \\ Common \\ MSFT \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-451">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="d9176-452">% LOCALAPPDATA% \\ Programs \\ MSFT \\ sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="d9176-452">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="d9176-453">% LOCALAPPDATA% \\ Programs \\ Common \\ MSFT \\ sample1 \\ x64 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="d9176-453">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="d9176-454">% APPDATA% \\ \\ программ меню "Пуск" Microsoft Windows \\ \\ \\ sample1</span><span class="sxs-lookup"><span data-stu-id="d9176-454">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/> |



 

## <a name="application-registration"></a><span data-ttu-id="d9176-455">Регистрация приложения</span><span class="sxs-lookup"><span data-stu-id="d9176-455">Application Registration</span></span>

<span data-ttu-id="d9176-456">PUASample.msi добавляет подраздел в раздел реестра путей приложений для приложения и выполняет регистрации, которые позволяют сохранить сведения о приложении в реестре с этим ключом.</span><span class="sxs-lookup"><span data-stu-id="d9176-456">The PUASample.msi adds a subkey to the App Paths registry key for the application and performs registrations that enable application information to be saved in the registry under this key.</span></span> <span data-ttu-id="d9176-457">Дополнительные сведения о путях приложений и регистрации приложений см. в разделах [перцеиведтипес, системфилеассоЦиатионс и регистрация приложений](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) в разделе [расширение оболочки](https://msdn.microsoft.com/library/bb762762.aspx) в документации [разработчика оболочки](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="d9176-457">For more information about App Paths and application registration, see the [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="d9176-458">Во время установки пользователь принимает решение установить приложение в контексте установки "на пользователя" или "на компьютер".</span><span class="sxs-lookup"><span data-stu-id="d9176-458">At installation time, the user makes the decision to install the application in either the per-user or per-machine installation context.</span></span> <span data-ttu-id="d9176-459">На момент создания пакета с двойным назначением разработчику пакета не удается выяснить, должны ли регистрации выполняться на \_ локальном компьютере hKey или в разделе \_ hKey \_ текущих \_ пользователей.</span><span class="sxs-lookup"><span data-stu-id="d9176-459">At the time the dual-purpose package is authored, the package developer cannot know if the registrations should be performed under the HKEY\_LOCAL\_MACHINE or HKEY\_CURRENT\_USER keys.</span></span>

<span data-ttu-id="d9176-460">Разработчик пакета определяет идентификатор файла для исполняемого файла приложения в поле File таблицы [File](file-table.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-460">The package developer defines the file identifier for the application's executable file in the File field of the [File](file-table.md) Table.</span></span>

<span data-ttu-id="d9176-461">[Файл](file-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-461">[File](file-table.md) Table (partial)</span></span> 

| <span data-ttu-id="d9176-462">Файл</span><span class="sxs-lookup"><span data-stu-id="d9176-462">File</span></span>      | <span data-ttu-id="d9176-463">Компонент\_</span><span class="sxs-lookup"><span data-stu-id="d9176-463">Component\_</span></span>      | <span data-ttu-id="d9176-464">FileName</span><span class="sxs-lookup"><span data-stu-id="d9176-464">FileName</span></span>                     | <span data-ttu-id="d9176-465">FileSize</span><span class="sxs-lookup"><span data-stu-id="d9176-465">FileSize</span></span> | <span data-ttu-id="d9176-466">Версия</span><span class="sxs-lookup"><span data-stu-id="d9176-466">Version</span></span> | <span data-ttu-id="d9176-467">Язык</span><span class="sxs-lookup"><span data-stu-id="d9176-467">Language</span></span> | <span data-ttu-id="d9176-468">Атрибуты</span><span class="sxs-lookup"><span data-stu-id="d9176-468">Attributes</span></span> | <span data-ttu-id="d9176-469">Последовательность</span><span class="sxs-lookup"><span data-stu-id="d9176-469">Sequence</span></span> |
|-----------|------------------|------------------------------|----------|---------|----------|------------|----------|
| <span data-ttu-id="d9176-470">мяппфиле</span><span class="sxs-lookup"><span data-stu-id="d9176-470">MyAppFile</span></span> | <span data-ttu-id="d9176-471">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-471">ProductComponent</span></span> | <span data-ttu-id="d9176-472">PUASAMP1.EXE\|PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="d9176-472">PUASAMP1.EXE\|PUASample1.exe</span></span> | <span data-ttu-id="d9176-473">81920</span><span class="sxs-lookup"><span data-stu-id="d9176-473">81920</span></span>    |         |          | <span data-ttu-id="d9176-474">0</span><span class="sxs-lookup"><span data-stu-id="d9176-474">0</span></span>          | <span data-ttu-id="d9176-475">1</span><span class="sxs-lookup"><span data-stu-id="d9176-475">1</span></span>        |



 

<span data-ttu-id="d9176-476">Значения, которые необходимо сохранить в реестре, можно указать в поле значение таблицы [реестра](registry-table.md) в виде [форматированной](formatted.md) строки.</span><span class="sxs-lookup"><span data-stu-id="d9176-476">Values to be saved in the registry can be specified in the Value field of the [Registry](registry-table.md) table as a [Formatted](formatted.md) string.</span></span> <span data-ttu-id="d9176-477">Используйте идентификатор файла, определенный в поле File таблицы [File](file-table.md) , и \[ \#  \] соглашение филекэй форматированного типа, чтобы указать значение по умолчанию для раздела реестра paths приложения.</span><span class="sxs-lookup"><span data-stu-id="d9176-477">Use the file identifier defined in the File field of the [File](file-table.md) table, and the \[\#*filekey*\] convention of the Formatted type, to specify the default value for the App Paths registry key.</span></span> <span data-ttu-id="d9176-478">Действие по [установке](install-action.md) верхнего уровня выполняет действия в таблице [инсталлексекутесекуенце](installexecutesequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-478">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table.</span></span> <span data-ttu-id="d9176-479">После завершения действий [костинитиализе](costinitialize-action.md), [филекост](filecost-action.md)и [функции InstallFinalize](installfinalize-action.md) в этой таблице установщик Windows заменяет отформатированную подстроку \[ \# мяппфиле \] в таблице реестра на полный путь к файлу приложения.</span><span class="sxs-lookup"><span data-stu-id="d9176-479">After the [CostInitialize](costinitialize-action.md), [FileCost](filecost-action.md), and [InstallFinalize](installfinalize-action.md) actions in this table have completed, the Windows Installer replaces the formatted substring \[\#MyAppFile\] in the Registry table with the full path to the application file.</span></span>

<span data-ttu-id="d9176-480">В примере определяется пользовательское свойство Регрут, которое содержит расположение корневого ключа, и используется настраиваемое действие для сброса значения свойства, если пользователь выбирает установку на компьютере.</span><span class="sxs-lookup"><span data-stu-id="d9176-480">The sample defines a custom property, RegRoot, to contain the location of the root key and uses a custom action to reset the property value if the user chooses a per-machine installation.</span></span> <span data-ttu-id="d9176-481">Используйте пользовательское свойство Регрут в любых форматированных строковых значениях, которые ссылаются на корневое расположение.</span><span class="sxs-lookup"><span data-stu-id="d9176-481">Use the custom property, RegRoot, in any formatted string values that reference the root location.</span></span> <span data-ttu-id="d9176-482">В таблице [свойств](property-table.md) пакет PUASample.msi определяет пользовательское свойство и присваивает параметру РЕГРУТ значение HKCU.</span><span class="sxs-lookup"><span data-stu-id="d9176-482">In the [Property](property-table.md) table the PUASample.msi package defines the custom property and sets the value of RegRoot to HKCU.</span></span> <span data-ttu-id="d9176-483">Это Инициализирует значение свойства для контекста установки на уровне пользователя, рекомендуемый контекст по умолчанию для пакетов с двойными целями.</span><span class="sxs-lookup"><span data-stu-id="d9176-483">This initializes the value of the property for the per-user installation context, the recommended default context for dual-purpose packages.</span></span>

<span data-ttu-id="d9176-484">[Свойство](property-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-484">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-485">Свойство</span><span class="sxs-lookup"><span data-stu-id="d9176-485">Property</span></span> | <span data-ttu-id="d9176-486">Значение</span><span class="sxs-lookup"><span data-stu-id="d9176-486">Value</span></span> |
|----------|-------|
| <span data-ttu-id="d9176-487">регрут</span><span class="sxs-lookup"><span data-stu-id="d9176-487">RegRoot</span></span>  | <span data-ttu-id="d9176-488">HKCU</span><span class="sxs-lookup"><span data-stu-id="d9176-488">HKCU</span></span>  |



 

<span data-ttu-id="d9176-489">В таблице [CustomAction](customaction-table.md) пакет определяет пользовательское действие с именем Set \_ регрут \_ HKLM.</span><span class="sxs-lookup"><span data-stu-id="d9176-489">In the [CustomAction](customaction-table.md) table the package defines a custom action named Set\_RegRoot\_HKLM.</span></span> <span data-ttu-id="d9176-490">Значение в поле Тип определяет это как [настраиваемое](custom-action-type-51.md) настраиваемое действие 51 стандартного действия.</span><span class="sxs-lookup"><span data-stu-id="d9176-490">The value in the Type field identifies this as a [Custom Action Type 51](custom-action-type-51.md) standard custom action.</span></span> <span data-ttu-id="d9176-491">Значение полей Source и Target в таблице CustomAction зависит от типа настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="d9176-491">The meaning of the Source and Target fields in the CustomAction table depend upon the custom action type.</span></span> <span data-ttu-id="d9176-492">Дополнительные сведения о стандартных типах настраиваемых действий см. в разделе [типы настраиваемых действий](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="d9176-492">For more information about the standard types of custom actions, see [Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span> <span data-ttu-id="d9176-493">Поле Source для \_ \_ настраиваемого действия Set регрут HKLM указывает, что значение свойства регрут.</span><span class="sxs-lookup"><span data-stu-id="d9176-493">The Source field for the Set\_RegRoot\_HKLM custom action specifies that the value of the RegRoot property.</span></span> <span data-ttu-id="d9176-494">Если Установщик выполняет \_ \_ пользовательское действие Set регрут HKLM, значение свойства регрут сбрасывается в HKLM.</span><span class="sxs-lookup"><span data-stu-id="d9176-494">If the installer performs the Set\_RegRoot\_HKLM custom action, this resets the value of the RegRoot property to HKLM.</span></span>

<span data-ttu-id="d9176-495">[CustomAction](customaction-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-495">[CustomAction](customaction-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-496">Действие</span><span class="sxs-lookup"><span data-stu-id="d9176-496">Action</span></span>             | <span data-ttu-id="d9176-497">Тип</span><span class="sxs-lookup"><span data-stu-id="d9176-497">Type</span></span> | <span data-ttu-id="d9176-498">Источник</span><span class="sxs-lookup"><span data-stu-id="d9176-498">Source</span></span>      | <span data-ttu-id="d9176-499">Назначение</span><span class="sxs-lookup"><span data-stu-id="d9176-499">Target</span></span> |
|--------------------|------|-------------|--------|
| <span data-ttu-id="d9176-500">Set \_ регрут \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="d9176-500">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="d9176-501">51</span><span class="sxs-lookup"><span data-stu-id="d9176-501">51</span></span>   | <span data-ttu-id="d9176-502">\[регрут\]</span><span class="sxs-lookup"><span data-stu-id="d9176-502">\[RegRoot\]</span></span> | <span data-ttu-id="d9176-503">HKLM</span><span class="sxs-lookup"><span data-stu-id="d9176-503">HKLM</span></span>   |



 

<span data-ttu-id="d9176-504">Действие по [установке](install-action.md) верхнего уровня выполняет действия в таблице [инсталлексекутесекуенце](installexecutesequence-table.md) в последовательности, указанной в поле Sequence этой таблицы.</span><span class="sxs-lookup"><span data-stu-id="d9176-504">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table, in the sequence specified in the Sequence field of that table.</span></span> <span data-ttu-id="d9176-505">Значение, созданное в поле последовательности для \_ пользовательского действия Set регрут \_ HKLM (1501), указывает, что это настраиваемое действие должно выполняться после действия [инсталлинитиализе](installinitialize-action.md) (1500) и перед действием [процесскомпонентс](processcomponents-action.md) (1600.). Эта последовательность гарантирует, что запись для \_ \_ настраиваемого действия Set регрут HKLM будет оцениваться во время установки.</span><span class="sxs-lookup"><span data-stu-id="d9176-505">The value authored in the Sequence field for the Set\_RegRoot\_HKLM custom action (1501) specifies that this custom action be performed after the [InstallInitialize](installinitialize-action.md) action (1500) and before the [ProcessComponents](processcomponents-action.md) action (1600.) This sequence ensures that the record for the Set\_RegRoot\_HKLM custom action is evaluated at installation time.</span></span> <span data-ttu-id="d9176-506">Дополнительные сведения о рекомендуемой последовательности действий в таблице Инсталлексекутесекуенце см. в разделе [предлагаемый инсталлексекутесекуенце](suggested-installexecutesequence.md) .</span><span class="sxs-lookup"><span data-stu-id="d9176-506">For more information about the recommended sequence of actions in the InstallExecuteSequence table, see the [Suggested InstallExecuteSequence](suggested-installexecutesequence.md) topic.</span></span> <span data-ttu-id="d9176-507">[Синтаксис условных инструкций](conditional-statement-syntax.md) , созданных в поле Condition, указывает, что \_ действие Set регрут \_ HKLM должно выполняться, только если значение свойства [**ALLUSERS**](allusers.md) равно 1 во время установки.</span><span class="sxs-lookup"><span data-stu-id="d9176-507">The [conditional statement syntax](conditional-statement-syntax.md) authored in the Condition field specifies that the Set\_RegRoot\_HKLM action be performed only if the value of the [**ALLUSERS**](allusers.md) property evaluates to 1 at installation time.</span></span> <span data-ttu-id="d9176-508">Свойство **ALLUSERS** , равное 1, указывает установку на компьютер.</span><span class="sxs-lookup"><span data-stu-id="d9176-508">An **ALLUSERS** property value of 1 specifies a per-machine installation.</span></span>

<span data-ttu-id="d9176-509">[Инсталлексекутесекуенце](installexecutesequence-table.md) Таблица (частичная)</span><span class="sxs-lookup"><span data-stu-id="d9176-509">[InstallExecuteSequence](installexecutesequence-table.md) Table (partial)</span></span>

| <span data-ttu-id="d9176-510">Действие</span><span class="sxs-lookup"><span data-stu-id="d9176-510">Action</span></span>             | <span data-ttu-id="d9176-511">Условие</span><span class="sxs-lookup"><span data-stu-id="d9176-511">Condition</span></span>  | <span data-ttu-id="d9176-512">Последовательность</span><span class="sxs-lookup"><span data-stu-id="d9176-512">Sequence</span></span> |
|--------------------|------------|----------|
| <span data-ttu-id="d9176-513">Set \_ регрут \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="d9176-513">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="d9176-514">ALLUSERS = 1</span><span class="sxs-lookup"><span data-stu-id="d9176-514">ALLUSERS=1</span></span> | <span data-ttu-id="d9176-515">1501</span><span class="sxs-lookup"><span data-stu-id="d9176-515">1501</span></span>     |



 

<span data-ttu-id="d9176-516">Следующие записи в таблице [реестра](registry-table.md) выполняют регистрации, если установлен компонент продукткомпонент.</span><span class="sxs-lookup"><span data-stu-id="d9176-516">The following records in the [Registry](registry-table.md) table perform the registrations if the ProductComponent component is installed.</span></span> <span data-ttu-id="d9176-517">Значение-1 в корневом поле требуется для выполнения регистрации на локальном компьютере в HKEY \_ \_ для установки на уровне пользователя и в разделе hKey \_ текущий \_ пользователь для установки на уровне пользователя.</span><span class="sxs-lookup"><span data-stu-id="d9176-517">The value -1 in the Root field is required to perform the registration under HKEY\_LOCAL\_MACHINE for a per-user installation and under HKEY\_CURRENT\_USER for a per-user installation.</span></span> <span data-ttu-id="d9176-518">Запись с пустой строкой в поле реестра добавляет подраздел для приложения в раздел реестра Апппасс и устанавливает в качестве значения по умолчанию полный путь к исполняемому файлу приложения.</span><span class="sxs-lookup"><span data-stu-id="d9176-518">The record with an empty string in the Registry field adds a subkey for the application under the AppPaths registry key and sets the "(Default)" value to the full path of the application's executable file.</span></span> <span data-ttu-id="d9176-519">Регистрация Мяпппасалиас сопоставляет исполняемый файл с псевдонимом приложения и позволяет запустить приложение, если пользователь вводит псевдоним "пуапкт" в командной строке.</span><span class="sxs-lookup"><span data-stu-id="d9176-519">The MyAppPathAlias registration maps the executable file to an application alias and enables the application to be launched if the user types the alias "puapct" at a command line prompt.</span></span> <span data-ttu-id="d9176-520">Регистрация Мяпппасрегистратион сопоставляет имя исполняемого файла с полным путем к файлу.</span><span class="sxs-lookup"><span data-stu-id="d9176-520">The MyAppPathRegistration registration maps the name of the executable file to the file's full path.</span></span>



| <span data-ttu-id="d9176-521">Реестр</span><span class="sxs-lookup"><span data-stu-id="d9176-521">Registry</span></span>              | <span data-ttu-id="d9176-522">Root</span><span class="sxs-lookup"><span data-stu-id="d9176-522">Root</span></span> | <span data-ttu-id="d9176-523">Клавиши</span><span class="sxs-lookup"><span data-stu-id="d9176-523">Key</span></span>                                                                     | <span data-ttu-id="d9176-524">Название</span><span class="sxs-lookup"><span data-stu-id="d9176-524">Name</span></span> | <span data-ttu-id="d9176-525">Значение</span><span class="sxs-lookup"><span data-stu-id="d9176-525">Value</span></span>                                                                            | <span data-ttu-id="d9176-526">Компонент</span><span class="sxs-lookup"><span data-stu-id="d9176-526">Component</span></span>        |
|-----------------------|------|-------------------------------------------------------------------------|------|----------------------------------------------------------------------------------|------------------|
|                       | <span data-ttu-id="d9176-527">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-527">-1</span></span>   | <span data-ttu-id="d9176-528">Программное обеспечение \\ Microsoft \\ мяпппасрегистратионлокатион</span><span class="sxs-lookup"><span data-stu-id="d9176-528">Software\\Microsoft\\MyAppPathRegistrationLocation</span></span>                      |      | <span data-ttu-id="d9176-529">\[Регрут \] \\ программное обеспечение \\ \\ \\ \\ пути к приложению Microsoft Windows CurrentVersion \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="d9176-529">\[RegRoot\]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span> | <span data-ttu-id="d9176-530">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-530">ProductComponent</span></span> |
| <span data-ttu-id="d9176-531">мяпппасалиас</span><span class="sxs-lookup"><span data-stu-id="d9176-531">MyAppPathAlias</span></span>        | <span data-ttu-id="d9176-532">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-532">-1</span></span>   | <span data-ttu-id="d9176-533">\\ \\ \\ Пути приложений Microsoft Windows CurrentVersion по \\ \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="d9176-533">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span>     |      | <span data-ttu-id="d9176-534">\[\#мяппфиле\]</span><span class="sxs-lookup"><span data-stu-id="d9176-534">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="d9176-535">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-535">ProductComponent</span></span> |
| <span data-ttu-id="d9176-536">мяпппасрегистратион</span><span class="sxs-lookup"><span data-stu-id="d9176-536">MyAppPathRegistration</span></span> | <span data-ttu-id="d9176-537">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-537">-1</span></span>   | <span data-ttu-id="d9176-538">\\ \\ \\ Пути приложений Microsoft Windows CurrentVersion по \\ \\PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="d9176-538">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUASample1.exe</span></span> |      | <span data-ttu-id="d9176-539">\[\#мяппфиле\]</span><span class="sxs-lookup"><span data-stu-id="d9176-539">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="d9176-540">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-540">ProductComponent</span></span> |



 

## <a name="autoplay-cancel-registration"></a><span data-ttu-id="d9176-541">Автозапуск Отмена регистрации</span><span class="sxs-lookup"><span data-stu-id="d9176-541">AutoPlay Cancel Registration</span></span>

<span data-ttu-id="d9176-542">PUASample.msi выполняет регистрации, которые позволяют пользователю приложения запретить запуск [аппаратного запуска](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) для выбранных устройств.</span><span class="sxs-lookup"><span data-stu-id="d9176-542">The PUASample.msi performs registrations that enable the application user to prevent [Hardware Autoplay](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) from launching for selected devices.</span></span> <span data-ttu-id="d9176-543">Сведения о регистрации обработчика для отмены автозапуска в ответ на событие см. в разделе [Подготовка оборудования и программного обеспечения для использования с автозапуском](/previous-versions//cc144208(v=vs.85)) в разделе [расширение оболочки](https://msdn.microsoft.com/library/bb762762.aspx) в [Руководстве разработчика оболочки](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="d9176-543">For information about registering a handler to cancel Autoplay in response to an event, see the [Preparing Hardware and Software for Use with AutoPlay](/previous-versions//cc144208(v=vs.85)) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="d9176-544">Следующая запись регистрирует обработчик, указанный в поле имя, при установке компонента Продукткомпонент.</span><span class="sxs-lookup"><span data-stu-id="d9176-544">The following record registers the handler specified in the Name field when the ProductComponent component is installed.</span></span> <span data-ttu-id="d9176-545">Значение-1 в корневом поле должно указывать на установщик Windows, что регистрация должна перенаправляться в расположение, зависящее от контекста установки.</span><span class="sxs-lookup"><span data-stu-id="d9176-545">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="d9176-546">[Реестр](registry-table.md) Таблица</span><span class="sxs-lookup"><span data-stu-id="d9176-546">[Registry](registry-table.md) Table</span></span> 

| <span data-ttu-id="d9176-547">Реестр</span><span class="sxs-lookup"><span data-stu-id="d9176-547">Registry</span></span>                     | <span data-ttu-id="d9176-548">Root</span><span class="sxs-lookup"><span data-stu-id="d9176-548">Root</span></span> | <span data-ttu-id="d9176-549">Клавиши</span><span class="sxs-lookup"><span data-stu-id="d9176-549">Key</span></span>                                                                                             | <span data-ttu-id="d9176-550">Название</span><span class="sxs-lookup"><span data-stu-id="d9176-550">Name</span></span>                                 | <span data-ttu-id="d9176-551">Значение</span><span class="sxs-lookup"><span data-stu-id="d9176-551">Value</span></span> | <span data-ttu-id="d9176-552">Компонент</span><span class="sxs-lookup"><span data-stu-id="d9176-552">Component</span></span>        |
|------------------------------|------|-------------------------------------------------------------------------------------------------|--------------------------------------|-------|------------------|
| <span data-ttu-id="d9176-553">мяутоплайканцелрегистратион</span><span class="sxs-lookup"><span data-stu-id="d9176-553">MyAutoplayCancelRegistration</span></span> | <span data-ttu-id="d9176-554">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-554">-1</span></span>   | <span data-ttu-id="d9176-555">Программное обеспечение \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ аутоплайхандлерс \\ канцелаутоплай \\ CLSID</span><span class="sxs-lookup"><span data-stu-id="d9176-555">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers\\CancelAutoplay\\CLSID</span></span> | <span data-ttu-id="d9176-556">66A32FE6-229D-427b-A608-D273F40C034C</span><span class="sxs-lookup"><span data-stu-id="d9176-556">66A32FE6-229D-427b-A608-D273F40C034C</span></span> |       | <span data-ttu-id="d9176-557">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-557">ProductComponent</span></span> |



 

## <a name="preview-handler-registration"></a><span data-ttu-id="d9176-558">Предварительный просмотр регистрации обработчика</span><span class="sxs-lookup"><span data-stu-id="d9176-558">Preview Handler Registration</span></span>

<span data-ttu-id="d9176-559">PUASample.msi выполняет регистрации, необходимые для установки [обработчика просмотра](../shell/preview-handlers.md) , который позволяет просматривать PUA-файлы только для чтения без запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="d9176-559">The PUASample.msi performs registrations that are required to install a [preview handler](../shell/preview-handlers.md) that enables a read-only preview of .pua files without launching the application.</span></span> <span data-ttu-id="d9176-560">Сведения о регистрации обработчиков просмотра см. в разделе [Регистрация обработчиков просмотра](../shell/how-to-register-a-preview-handler.md) статьи [расширение оболочки](https://msdn.microsoft.com/library/bb762762.aspx) в [Руководстве разработчика оболочки](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="d9176-560">For information about registering preview handlers, see the [Registering Preview Handlers](../shell/how-to-register-a-preview-handler.md) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="d9176-561">Следующие записи в таблице [реестра](registry-table.md) регистрируют обработчик при установке компонента продукткомпонент.</span><span class="sxs-lookup"><span data-stu-id="d9176-561">The following records in the [Registry](registry-table.md) table register the handler when the ProductComponent component is installed.</span></span> <span data-ttu-id="d9176-562">Значение-1 в корневом поле должно указывать на установщик Windows, что регистрация должна перенаправляться в расположение, зависящее от контекста установки.</span><span class="sxs-lookup"><span data-stu-id="d9176-562">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="d9176-563">[Реестр](registry-table.md) Таблица</span><span class="sxs-lookup"><span data-stu-id="d9176-563">[Registry](registry-table.md) Table</span></span>

| <span data-ttu-id="d9176-564">Реестр</span><span class="sxs-lookup"><span data-stu-id="d9176-564">Registry</span></span>                       | <span data-ttu-id="d9176-565">Root</span><span class="sxs-lookup"><span data-stu-id="d9176-565">Root</span></span> | <span data-ttu-id="d9176-566">Клавиши</span><span class="sxs-lookup"><span data-stu-id="d9176-566">Key</span></span>                                                                              | <span data-ttu-id="d9176-567">Название</span><span class="sxs-lookup"><span data-stu-id="d9176-567">Name</span></span>                                   | <span data-ttu-id="d9176-568">Значение</span><span class="sxs-lookup"><span data-stu-id="d9176-568">Value</span></span>                                        | <span data-ttu-id="d9176-569">Компонент</span><span class="sxs-lookup"><span data-stu-id="d9176-569">Component</span></span>        |
|--------------------------------|------|----------------------------------------------------------------------------------|----------------------------------------|----------------------------------------------|------------------|
| <span data-ttu-id="d9176-570">MyPreviewHandlerRegistration1</span><span class="sxs-lookup"><span data-stu-id="d9176-570">MyPreviewHandlerRegistration1</span></span>  | <span data-ttu-id="d9176-571">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-571">-1</span></span>   | <span data-ttu-id="d9176-572">Классы программного обеспечения \\ \\ . PUA</span><span class="sxs-lookup"><span data-stu-id="d9176-572">Software\\Classes\\.pua</span></span>                                                          |                                        | <span data-ttu-id="d9176-573">пуафиле</span><span class="sxs-lookup"><span data-stu-id="d9176-573">puafile</span></span>                                      | <span data-ttu-id="d9176-574">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-574">ProductComponent</span></span> |
| <span data-ttu-id="d9176-575">MyPreviewHandlerRegistration2</span><span class="sxs-lookup"><span data-stu-id="d9176-575">MyPreviewHandlerRegistration2</span></span>  | <span data-ttu-id="d9176-576">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-576">-1</span></span>   | <span data-ttu-id="d9176-577">Программное обеспечение \\ Microsoft \\ Windows \\ CurrentVersion \\ превиевхандлерс</span><span class="sxs-lookup"><span data-stu-id="d9176-577">Software\\Microsoft\\Windows\\CurrentVersion\\PreviewHandlers</span></span>                    | <span data-ttu-id="d9176-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="d9176-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span> | <span data-ttu-id="d9176-579">Обработчик предварительной версии Microsoft Windows PUA TEST</span><span class="sxs-lookup"><span data-stu-id="d9176-579">Microsoft Windows PUA TEST Preview Handler</span></span>   | <span data-ttu-id="d9176-580">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-580">ProductComponent</span></span> |
| <span data-ttu-id="d9176-581">MyPreviewHandlerRegistration3</span><span class="sxs-lookup"><span data-stu-id="d9176-581">MyPreviewHandlerRegistration3</span></span>  | <span data-ttu-id="d9176-582">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-582">-1</span></span>   | <span data-ttu-id="d9176-583">Классы программного обеспечения \\ \\ пуафиле \\ шеллекс \\ {8895b1c6-b41f-4c1c-A562-0d564250836f}</span><span class="sxs-lookup"><span data-stu-id="d9176-583">Software\\Classes\\puafile\\ShellEx\\{8895b1c6-b41f-4c1c-a562-0d564250836f}</span></span>      |                                        | <span data-ttu-id="d9176-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="d9176-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>       | <span data-ttu-id="d9176-585">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-585">ProductComponent</span></span> |
| <span data-ttu-id="d9176-586">MyPreviewHandlerRegistration4</span><span class="sxs-lookup"><span data-stu-id="d9176-586">MyPreviewHandlerRegistration4</span></span>  | <span data-ttu-id="d9176-587">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-587">-1</span></span>   | <span data-ttu-id="d9176-588">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="d9176-588">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 |                                        | <span data-ttu-id="d9176-589">Обработчик предварительной версии Per-User приложения отменено Sample 1</span><span class="sxs-lookup"><span data-stu-id="d9176-589">Per-User Applicaton Sample 1 Preview Handler</span></span> | <span data-ttu-id="d9176-590">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-590">ProductComponent</span></span> |
| <span data-ttu-id="d9176-591">MyPreviewHandlerRegistration5</span><span class="sxs-lookup"><span data-stu-id="d9176-591">MyPreviewHandlerRegistration5</span></span>  | <span data-ttu-id="d9176-592">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-592">-1</span></span>   | <span data-ttu-id="d9176-593">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="d9176-593">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="d9176-594">AppID</span><span class="sxs-lookup"><span data-stu-id="d9176-594">AppID</span></span>                                  | <span data-ttu-id="d9176-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span><span class="sxs-lookup"><span data-stu-id="d9176-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span></span>       | <span data-ttu-id="d9176-596">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-596">ProductComponent</span></span> |
| <span data-ttu-id="d9176-597">MyPreviewHandlerRegistration6</span><span class="sxs-lookup"><span data-stu-id="d9176-597">MyPreviewHandlerRegistration6</span></span>  | <span data-ttu-id="d9176-598">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-598">-1</span></span>   | <span data-ttu-id="d9176-599">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="d9176-599">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="d9176-600">DisplayName</span><span class="sxs-lookup"><span data-stu-id="d9176-600">DisplayName</span></span>                            | <span data-ttu-id="d9176-601">@shell32,-38242</span><span class="sxs-lookup"><span data-stu-id="d9176-601">@shell32,-38242</span></span>                              | <span data-ttu-id="d9176-602">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-602">ProductComponent</span></span> |
| <span data-ttu-id="d9176-603">MyPreviewHandlerRegistration7</span><span class="sxs-lookup"><span data-stu-id="d9176-603">MyPreviewHandlerRegistration7</span></span>  | <span data-ttu-id="d9176-604">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-604">-1</span></span>   | <span data-ttu-id="d9176-605">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="d9176-605">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="d9176-606">Значок</span><span class="sxs-lookup"><span data-stu-id="d9176-606">Icon</span></span>                                   | <span data-ttu-id="d9176-607">notepad.exe, 2</span><span class="sxs-lookup"><span data-stu-id="d9176-607">notepad.exe,2</span></span>                                | <span data-ttu-id="d9176-608">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-608">ProductComponent</span></span> |
| <span data-ttu-id="d9176-609">MyPreviewHandlerRegistration8</span><span class="sxs-lookup"><span data-stu-id="d9176-609">MyPreviewHandlerRegistration8</span></span>  | <span data-ttu-id="d9176-610">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-610">-1</span></span>   | <span data-ttu-id="d9176-611">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="d9176-611">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="d9176-612">ThreadingModel.</span><span class="sxs-lookup"><span data-stu-id="d9176-612">ThreadingModel</span></span>                         | <span data-ttu-id="d9176-613">Разделение</span><span class="sxs-lookup"><span data-stu-id="d9176-613">Apartment</span></span>                                    | <span data-ttu-id="d9176-614">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-614">ProductComponent</span></span> |
| <span data-ttu-id="d9176-615">MyPreviewHandlerRegistration9</span><span class="sxs-lookup"><span data-stu-id="d9176-615">MyPreviewHandlerRegistration9</span></span>  | <span data-ttu-id="d9176-616">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-616">-1</span></span>   | <span data-ttu-id="d9176-617">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="d9176-617">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> |                                        | <span data-ttu-id="d9176-618">\#%% SystemRoot% \\ system32 \\shell32.dll</span><span class="sxs-lookup"><span data-stu-id="d9176-618">\#%%SystemRoot%\\system32\\shell32.dll</span></span>       | <span data-ttu-id="d9176-619">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-619">ProductComponent</span></span> |
| <span data-ttu-id="d9176-620">MyPreviewHandlerRegistration10</span><span class="sxs-lookup"><span data-stu-id="d9176-620">MyPreviewHandlerRegistration10</span></span> | <span data-ttu-id="d9176-621">-1</span><span class="sxs-lookup"><span data-stu-id="d9176-621">-1</span></span>   | <span data-ttu-id="d9176-622">Классы программного обеспечения \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="d9176-622">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="d9176-623">ProgID:</span><span class="sxs-lookup"><span data-stu-id="d9176-623">ProgID</span></span>                                 | <span data-ttu-id="d9176-624">пуафиле</span><span class="sxs-lookup"><span data-stu-id="d9176-624">puafile</span></span>                                      | <span data-ttu-id="d9176-625">продукткомпонент</span><span class="sxs-lookup"><span data-stu-id="d9176-625">ProductComponent</span></span> |



 

 

 
