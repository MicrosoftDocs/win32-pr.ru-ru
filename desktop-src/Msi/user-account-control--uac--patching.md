---
description: Исправление контроля учетных записей пользователей (UAC) позволяет авторам установщик Windows установок определять исправления с цифровой подписью, которые могут быть применены в будущем пользователями, не являющимися администраторами.
ms.assetid: f7d64f61-24c8-4037-a10b-d68d0e9e3c42
title: Исправление контроля учетных записей пользователей (UAC)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d111a39245ab15b24c1734d278a8e0a477e68a6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913451"
---
# <a name="user-account-control-uac-patching"></a><span data-ttu-id="41764-103">Исправление контроля учетных записей пользователей (UAC)</span><span class="sxs-lookup"><span data-stu-id="41764-103">User Account Control (UAC) Patching</span></span>

<span data-ttu-id="41764-104">Исправление [*контроля учетных записей пользователей*](u-gly.md) (UAC) позволяет авторам установщик Windows установок определять исправления с цифровой подписью, которые могут быть применены в будущем пользователями, не являющимися администраторами.</span><span class="sxs-lookup"><span data-stu-id="41764-104">[*User Account Control*](u-gly.md) (UAC) patching enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span>

<span data-ttu-id="41764-105">Если цифровая подпись не соответствует сертификату, Windows Vista выводит диалоговое окно UAC, запрашивающее авторизацию администратора перед установкой исправления.</span><span class="sxs-lookup"><span data-stu-id="41764-105">If the digital signature does not match the certificate, Windows Vista displays a UAC dialog box requesting administrator authorization before installing the patch.</span></span> <span data-ttu-id="41764-106">В системах, предшествующих Windows Vista, установщик не будет применять подписанное исправление, которое не соответствует сертификату.</span><span class="sxs-lookup"><span data-stu-id="41764-106">On systems earlier than Windows Vista, the installer will not apply a signed patch that does not match the certificate.</span></span>

<span data-ttu-id="41764-107">Если пользователь без прав администратора пытается применить исправление к приложению и следующие условия не выполнены, Windows Vista сообщит пользователю, что для установки исправления требуется авторизация администратора.</span><span class="sxs-lookup"><span data-stu-id="41764-107">If a non-administrator attempts to apply a patch to an application, and the following conditions have not been met, Windows Vista will notify the user that administrator authorization is required before installing the patch.</span></span> <span data-ttu-id="41764-108">Не имея прав администратора, можно продолжить установку исправления без необходимости получения дополнительной авторизации администратора, если выполняются следующие условия.</span><span class="sxs-lookup"><span data-stu-id="41764-108">A non-administrator can continue installing the patch, without needing to obtain additional administrator authorization, provided the following conditions are met.</span></span>

-   <span data-ttu-id="41764-109">Приложение было установлено в Windows Vista или Windows XP с помощью установщик Windows 3,0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="41764-109">The application was installed on Windows Vista or Windows XP using Windows Installer 3.0 or later.</span></span>

    <span data-ttu-id="41764-110">**Windows Server 2008:** Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="41764-110">**Windows Server 2008:** Not supported.</span></span>

-   <span data-ttu-id="41764-111">Если приложение было установлено в Windows XP, оно также должно быть установлено со съемного носителя, такого как компакт-диск или DVD-диск.</span><span class="sxs-lookup"><span data-stu-id="41764-111">If the application was installed on Windows XP, the application must also have been installed from removable media, such a CD-ROM or DVD disk.</span></span> <span data-ttu-id="41764-112">Это ограничение не применяется, если приложение было установлено в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="41764-112">This restriction does not apply if the application was installed on Windows Vista.</span></span>
-   <span data-ttu-id="41764-113">Приложение не было установлено из исходного образа [административной установки](administrative-installation.md) .</span><span class="sxs-lookup"><span data-stu-id="41764-113">The application was not installed from an [administrative installation](administrative-installation.md) source image.</span></span>
-   <span data-ttu-id="41764-114">Приложение первоначально устанавливалось для каждого компьютера.</span><span class="sxs-lookup"><span data-stu-id="41764-114">The application was originally installed per-machine.</span></span> <span data-ttu-id="41764-115">Сведения о том, как разрешить пользователям, не являющимся администраторами, применять исправления к управляемым пользователем приложениям после того, как администратор утверждает, что он является доверенным для администратора, см. статью об [исправлениях Per-User управляемых приложениях](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="41764-115">For information about how to enable non-administrators to apply patches to per-user-managed applications after the patch has been approved as trusted by an administrator, see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="41764-116">[Таблица мсипатчцертификате](msipatchcertificate-table.md) содержится в пакете установщика окна (MSI-файле) и содержит сведения, необходимые для включения UAC.</span><span class="sxs-lookup"><span data-stu-id="41764-116">The [MsiPatchCertificate table](msipatchcertificate-table.md) is present in the Window Installer package (.msi file) and contains the information needed to enable UAC.</span></span> <span data-ttu-id="41764-117">Таблица и информация могут быть включены в исходный пакет установки или добавлены в пакет с помощью установщик Windows файла исправления (MSP-файл).</span><span class="sxs-lookup"><span data-stu-id="41764-117">The table and information may have been be included in the original installation package or added to the package by a Windows Installer patch file (.msp file).</span></span>
-   <span data-ttu-id="41764-118">Исправления имеют цифровую подпись с помощью сертификата, указанного в [таблице мсипатчцертификате](msipatchcertificate-table.md).</span><span class="sxs-lookup"><span data-stu-id="41764-118">The patches are digitally signed by a certificate listed in the [MsiPatchCertificate table](msipatchcertificate-table.md).</span></span> <span data-ttu-id="41764-119">Дополнительные сведения о сертификатах цифровых подписей см. в статье [цифровые подписи и установщик Windows](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="41764-119">For more information about digital signature certificates, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="41764-120">Цифровую подпись пакета исправлений можно проверить на соответствие сертификату в [таблице мсипатчцертификате](msipatchcertificate-table.md).</span><span class="sxs-lookup"><span data-stu-id="41764-120">The digital signature on the patch package can be verified against the certificate in the [MsiPatchCertificate table](msipatchcertificate-table.md).</span></span> <span data-ttu-id="41764-121">Дополнительные сведения об использовании цифровых подписей, цифровых сертификатов и [**WinVerifyTrust**](/windows/win32/api/wintrust/nf-wintrust-winverifytrust)см. в разделе " [Безопасность](https://msdn.microsoft.com/library/cc527452.aspx) " пакета средств разработки программного обеспечения Microsoft Windows (SDK).</span><span class="sxs-lookup"><span data-stu-id="41764-121">For more information about the use of digital signatures, digital certificates, and [**WinVerifyTrust**](/windows/win32/api/wintrust/nf-wintrust-winverifytrust), see the [Security](https://msdn.microsoft.com/library/cc527452.aspx) section of the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="41764-122">Сертификат подписи, используемый для проверки цифровой подписи в пакете исправлений, является допустимым и не был отозван.</span><span class="sxs-lookup"><span data-stu-id="41764-122">The signer certificate used to verify the digital signature on the patch package is valid and has not been revoked.</span></span>
    > [!Note]  
    > <span data-ttu-id="41764-123">Хотя вы не можете подписать исправление с помощью сертификата с истекшим сроком действия, вычисление цифровой подписи для исправления не завершится ошибкой, если срок действия сертификата истек.</span><span class="sxs-lookup"><span data-stu-id="41764-123">Although you cannot sign a patch using an expired certificate, evaluation of a digital signature on a patch does not fail if the certificate has expired.</span></span> <span data-ttu-id="41764-124">В ходе оценки используется текущая [Таблица мсипатчцертификате](msipatchcertificate-table.md), состоящая из таблицы мсипатчцертификате в исходном пакете и любых изменений в таблице с помощью исправлений, последовательностей, предшествовавших текущей.</span><span class="sxs-lookup"><span data-stu-id="41764-124">Evaluation uses the current [MsiPatchCertificate table](msipatchcertificate-table.md), which consists of the MsiPatchCertificate table in the original package and any changes to the table by patches sequenced prior to the current one.</span></span> <span data-ttu-id="41764-125">Исправление может добавлять новые сертификаты в таблицу Мсипатчцертификате для оценки исправлений, последовательностей после текущего исправления.</span><span class="sxs-lookup"><span data-stu-id="41764-125">A patch can add new certificates to the MsiPatchCertificate table to evaluate patches sequenced after the current patch.</span></span> <span data-ttu-id="41764-126">Отозванный сертификат всегда отклоняется.</span><span class="sxs-lookup"><span data-stu-id="41764-126">A revoked certificate is always rejected.</span></span>

     

-   <span data-ttu-id="41764-127">Исправление с минимальными правами доступа не было отключено путем установки свойства [**мсидисаблелуапатчинг**](msidisableluapatching.md) или политики [дисаблелуапатчинг](disableluapatching.md) .</span><span class="sxs-lookup"><span data-stu-id="41764-127">Least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

<span data-ttu-id="41764-128">Исправление, которое было применено с помощью исправлений UAC, также может быть удалено без прав администратора.</span><span class="sxs-lookup"><span data-stu-id="41764-128">A patch that has been applied using UAC patching can also be removed by a non-administrator.</span></span>

<span data-ttu-id="41764-129">Администраторы могут применять исправления к продуктам, установленным на компьютере, независимо от параметров UAC приложения.</span><span class="sxs-lookup"><span data-stu-id="41764-129">Administrators can apply patches to per-machine installed products regardless of the application's UAC setting.</span></span>

<span data-ttu-id="41764-130">Чтобы определить, включено ли исправление с минимальными правами доступа для приложения, используйте функцию [**мсижетпродуктинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) для запроса свойства инсталлпропертиного \_ \_ приложения Lua или с \_ помощью метода [**ProductInfo**](installer-productinfo.md) для запроса свойства аусоризедлуаапп.</span><span class="sxs-lookup"><span data-stu-id="41764-130">You can determine whether least-privilege patching is enabled for an application by using the [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) function to query for the INSTALLPROPERTY\_AUTHORIZED\_LUA\_APP property, or by using the [**ProductInfo**](installer-productinfo.md) method to query for the "AuthorizedLUAApp" property.</span></span> <span data-ttu-id="41764-131">Если значение любого из этих свойств равно 1, приложение включает исправление учетной записи пользователя с минимальными правами доступа.</span><span class="sxs-lookup"><span data-stu-id="41764-131">If the value of either property is 1, the application is enabled for least-privilege user account patching.</span></span>

<span data-ttu-id="41764-132">Администратор может отключить исправление с минимальными правами доступа на компьютере, задав для политики [дисаблелуапатчинг](disableluapatching.md) значение 1.</span><span class="sxs-lookup"><span data-stu-id="41764-132">An administrator can disable least-privilege patching on the computer by setting the [DisableLUAPatching](disableluapatching.md) policy to 1.</span></span> <span data-ttu-id="41764-133">Для свойства [**мсидисаблелуапатчинг**](msidisableluapatching.md) можно задать значение 1 во время первоначальной установки приложения, чтобы предотвратить исправление с минимальными правами доступа только для этого приложения.</span><span class="sxs-lookup"><span data-stu-id="41764-133">You can set the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property to 1 during the initial installation of an application to prevent least-privilege patching for that application only.</span></span>

<span data-ttu-id="41764-134">Эта функция доступна начиная с версии установщик Windows 3,0.</span><span class="sxs-lookup"><span data-stu-id="41764-134">This functionality is available beginning with Windows Installer version 3.0.</span></span> <span data-ttu-id="41764-135">В Windows XP исправление контроля учетных записей пользователей (UAC) называлось минимальными привилегиями учетной записи пользователя (LUA).</span><span class="sxs-lookup"><span data-stu-id="41764-135">User Account Control (UAC) patching was called least-privilege user account (LUA) patching in Windows XP.</span></span> <span data-ttu-id="41764-136">Исправление LUA недоступно в Windows 2000 и Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="41764-136">LUA patching is not available on Windows 2000 and Windows Server 2003.</span></span>

<span data-ttu-id="41764-137">Дополнительные сведения о совместимости приложений и разработке приложений, совместимых с контролем учетных записей (UAC), см. в разделе Учетные данные UAC, предоставленные на [веб-узле Microsoft TechNet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="41764-137">For more information about application compatibility and developing applications that are compatible with User Account Control (UAC), see the UAC information that is provided on [Microsoft Technet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10)).</span></span>

 

 
