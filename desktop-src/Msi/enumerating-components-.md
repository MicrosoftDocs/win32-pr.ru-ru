---
description: Установщик Windows 5,0, работающем на Windows Server 2008 R2 или Windows 7, может перечислить все компоненты, установленные на компьютере, и получить путь к разделу для компонента.
ms.assetid: a6676340-1695-48c7-a1e4-7a02a7bc3fef
title: Перечисление компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea314ee91c35fb021f5a8da64b6430e8cf950ecd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103812713"
---
# <a name="enumerating-components"></a><span data-ttu-id="3b7e6-103">Перечисление компонентов</span><span class="sxs-lookup"><span data-stu-id="3b7e6-103">Enumerating Components</span></span>

<span data-ttu-id="3b7e6-104">Установщик Windows 5,0, работающем на Windows Server 2008 R2 или Windows 7, может перечислить все компоненты, установленные на компьютере, и получить путь к разделу для компонента.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-104">Windows Installer 5.0 running on Windows Server 2008 R2 or Windows 7 can enumerate all components installed on the computer and obtain the key path for the component.</span></span> <span data-ttu-id="3b7e6-105">Пакет, разработанный для установщик Windows 5,0, может использовать функции [**мсиенумкомпонентсекс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa), [**мсиенумклиентсекс**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa)и [**мсижеткомпонентпасекс**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) для поиска компонентов и продуктов в учетных записях пользователей и контекстах установки.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-105">A package authored for Windows Installer 5.0 can use the [**MsiEnumComponentsEx**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa), [**MsiEnumClientsEx**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa), and [**MsiGetComponentPathEx**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) functions to search for components and products across user accounts and installation contexts.</span></span> <span data-ttu-id="3b7e6-106">Функции [**мсиенумкомпонентс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa), [**мсиенумклиентс**](/windows/desktop/api/Msi/nf-msi-msienumclientsa)и [**мсижеткомпонентпас**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) возвращают сведения только о компонентах и продуктах, установленных для учетной записи пользователя, вызвавшей эту функцию.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-106">The [**MsiEnumComponents**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa), [**MsiEnumClients**](/windows/desktop/api/Msi/nf-msi-msienumclientsa), and [**MsiGetComponentPath**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) functions only return information for components and products installed for the user account that called the function.</span></span> <span data-ttu-id="3b7e6-107">Несколько вызовов этих функций по крайней мере один раз для каждой учетной записи пользователя необходимы для получения сведений обо всем компьютере.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-107">Multiple calls to these functions, at least once for each user account, are required to collect information for the entire computer.</span></span>

<span data-ttu-id="3b7e6-108">Функция [**мсиенумкомпонентсекс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa) перечисляет установленные компоненты.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-108">The [**MsiEnumComponentsEx**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa) function enumerates installed components.</span></span> <span data-ttu-id="3b7e6-109">Функция получает один код компонента при каждом вызове.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-109">The function retrieves one component code each time it is called.</span></span> <span data-ttu-id="3b7e6-110">[**Объект компонента**](components.md) получает сведения об установленном компоненте с помощью этой функции.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-110">The [**Component Object**](components.md) receives information about an installed component by this function.</span></span>

<span data-ttu-id="3b7e6-111">Функция [**мсиенумклиентсекс**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa) перечисляет продукты, являющиеся клиентами указанного установленного компонента.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-111">The [**MsiEnumClientsEx**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa) function enumerates products that are clients of a specified installed component.</span></span> <span data-ttu-id="3b7e6-112">[**Клиентский объект**](client.md) получает сведения о клиенте этой функцией.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-112">The [**Client Object**](client.md) receives information about a client by this function.</span></span>

<span data-ttu-id="3b7e6-113">Функция [**мсижеткомпонентпасекс**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) возвращает полный путь к установленному компоненту.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-113">The [**MsiGetComponentPathEx**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) function returns the full path to an installed component.</span></span> <span data-ttu-id="3b7e6-114">Функция возвращает раздел реестра, если путь к разделу для компонента является ключом реестра.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-114">The function returns the registry key if the key path for the component is a registry key.</span></span> <span data-ttu-id="3b7e6-115">[**Объект компонентинфо**](componentinfo.md) получает сведения об установленном компоненте с помощью этой функции.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-115">The [**ComponentInfo Object**](componentinfo.md) receives information about an installed component by this function.</span></span>

<span data-ttu-id="3b7e6-116">**[Установщик Windows 4,5 или более ранней версии](not-supported-in-windows-installer-4-5.md):** Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-116">**[Windows Installer 4.5 or earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span> <span data-ttu-id="3b7e6-117">Эта функция доступна начиная с установщик Windows 5,0, работающих под Windows 7 или Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="3b7e6-117">This functionality is available beginning with Windows Installer 5.0 running on Windows 7 or Windows Server 2008 R2.</span></span>

 

 



