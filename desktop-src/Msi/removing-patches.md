---
description: Начиная с установщик Windows&\# 160; version&\# 160; 3.0, можно создавать и устанавливать исправления, которые могут быть удалены отдельно и в любом порядке, не удаляя и не переустанавливая все приложение и другие исправления.
ms.assetid: 2ad30ac9-eac9-49cf-98ae-5c053a0b500a
title: Удаление исправлений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7cd54db3bde3a356a0c3adb299555248bbc87a0b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105650897"
---
# <a name="removing-patches"></a><span data-ttu-id="1d0ce-103">Удаление исправлений</span><span class="sxs-lookup"><span data-stu-id="1d0ce-103">Removing Patches</span></span>

<span data-ttu-id="1d0ce-104">Начиная с версии установщик Windows 3,0 можно создавать и устанавливать исправления, которые можно удалить отдельно и в любом порядке, не удаляя и не переустанавливая все приложение и другие исправления.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-104">Beginning with Windows Installer version 3.0, it is possible to create and install patches that can be uninstalled singly, and in any order, without having to uninstall and reinstall the entire application and other patches.</span></span> <span data-ttu-id="1d0ce-105">Установщик Windows 3,0 также позволяет создавать [пакеты исправлений](patch-packages.md) с помощью [таблицы мсипатчсекуенце](msipatchsequence-table.md) , содержащей сведения о последовательности исправлений.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-105">Windows Installer 3.0 also enables [Patch Packages](patch-packages.md) to be authored with a [MsiPatchSequence Table](msipatchsequence-table.md) that contains patch sequencing information.</span></span> <span data-ttu-id="1d0ce-106">В версиях установщик Windows более ранних, чем установщик Windows 3,0, единственным методом удаления отдельных исправлений из приложения является удаление всего исправленного приложения, а затем его повторная установка без повторного применения удаляемых исправлений.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-106">With versions of Windows Installer earlier than Windows Installer 3.0, the only method to remove particular patches from an application is to uninstall the entire patched application and then reinstall without reapplying any patches being removed.</span></span>

<span data-ttu-id="1d0ce-107">Возможность удаления исправления зависит от того, как было создано исправление, от версии установщик Windows, используемой для установки исправления, и от изменений, внесенных исправлением в приложение.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-107">Whether a patch can be uninstalled depends upon how the patch was authored, the version of Windows Installer used to install the patch, and the changes made by the patch to the application.</span></span> <span data-ttu-id="1d0ce-108">Если исправление не удаляется, единственным способом удаления исправления является удаление всего приложения и его повторная установка без применения исправления.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-108">If a patch is not uninstallable, then the only way to remove the patch is to uninstall the entire application and reinstall without applying the patch being removed.</span></span>

<span data-ttu-id="1d0ce-109">Можно удалить один или несколько исправлений с помощью параметра командной строки, интерфейса сценариев или путем вызова [**мсиремовепатчес**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) из другого приложения.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-109">You can uninstall one or more patches using a command line option, the scripting interface, or by calling [**MsiRemovePatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) from another application.</span></span> <span data-ttu-id="1d0ce-110">Дополнительные сведения об удалении исправлений см. в разделе Удаление [исправлений](uninstalling-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="1d0ce-110">See [Uninstalling Patches](uninstalling-patches.md) for more information about how to uninstall patches.</span></span>

<span data-ttu-id="1d0ce-111">Значение свойства [**мсипатчремове**](msipatchremove.md) содержит список исправлений для удаления.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-111">The value of the [**MSIPATCHREMOVE**](msipatchremove.md) property lists the patches to be uninstalled.</span></span> <span data-ttu-id="1d0ce-112">Для каждого исправления в списке установщик проверяет, что установка исправления недоступна.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-112">For each patch in the list, the installer verifies that the patch is uninstallable.</span></span> <span data-ttu-id="1d0ce-113">Если у пользователя нет прав для удаления исправления, это значит, что исправление неизвестно для продукта, политика исправления не позволяет удалить или исправление было помечено как недоступное, установщик возвращает ошибку, указывающую на неудачную транзакцию установки.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-113">If the user does not have privileges to remove the patch, the patch is unknown for the product, patch policy prevents removal, or the patch was marked as not uninstallable, the installer returns an error that indicates a failed installation transaction.</span></span> <span data-ttu-id="1d0ce-114">Дополнительные сведения о том, что определяет, не удается удалить исправление, см. в разделе [неустанавливаемые исправления](uninstallable-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="1d0ce-114">See [Uninstallable Patches](uninstallable-patches.md) for more information about what determines whether a patch is not uninstallable.</span></span>

<span data-ttu-id="1d0ce-115">После того как исправление будет проверено как съемное, установщик удалит исправление из последовательности приложений исправления.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-115">Once the patch is verified as removable, the installer removes the patch from the patch application sequence.</span></span> <span data-ttu-id="1d0ce-116">Дополнительные сведения о том, как установщик Windows 3,0 определяет, какую последовательность следует использовать при применении исправлений, см. в статье [виртуализация исправлений](sequencing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="1d0ce-116">For more information about how Windows Installer 3.0 determines what sequence to use when applying patches see [Sequencing Patches](sequencing-patches.md).</span></span> <span data-ttu-id="1d0ce-117">Обратите внимание, что удаление исправлений из последовательности может привести к тому, что исправления будут помечены как устаревшие или замененные на активные.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-117">Note that removing patches from the sequence can cause patches marked obsolete or superseded to become active.</span></span>

<span data-ttu-id="1d0ce-118">Все исправления, выбранные для удаления, перечислены в свойстве [**MsiPatchRemovalList**](msipatchremovallist.md) .</span><span class="sxs-lookup"><span data-stu-id="1d0ce-118">All patches selected for removal are listed in the [**MsiPatchRemovalList**](msipatchremovallist.md) property.</span></span> <span data-ttu-id="1d0ce-119">Это свойство является закрытым, которое задается установщиком и может использоваться в условных выражениях или запрашиваться [настраиваемыми действиями](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="1d0ce-119">This property is a private property that is set by the installer and can be used in conditional expressions or queried by [custom actions](custom-actions.md).</span></span> <span data-ttu-id="1d0ce-120">Свойство содержит список идентификаторов GUID кода исправления для удаляемых исправлений.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-120">The property contains the list of patch code GUIDs of patches to be removed.</span></span> <span data-ttu-id="1d0ce-121">Настраиваемое действие может определить, применяется ли состояние установки исправления, устарело или заменено путем вызова свойства [**мсижетпатчинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) или [**патчпроперти**](patch-patchproperty.md) [объекта Patch](patch-object.md).</span><span class="sxs-lookup"><span data-stu-id="1d0ce-121">A custom action can determine whether the installation state of the patch is applied, obsolete or superseded by calling the [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) or the [**PatchProperty**](patch-patchproperty.md) property of the [Patch Object](patch-object.md).</span></span>

<span data-ttu-id="1d0ce-122">После удаления исправления состояние приложения будет таким же, как если бы исправление не устанавливалось.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-122">After a patch is removed the state of the application is the same as if the patch was never installed.</span></span> <span data-ttu-id="1d0ce-123">Если это возможно, установщик ограничит процесс до подмножества компонентов, затрагиваемых удаляемым исправлением.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-123">If possible, the installer restricts the process to the subset of features affected by the patch being removed.</span></span> <span data-ttu-id="1d0ce-124">Установщик автоматически устанавливает свойство [**REINSTALL**](reinstall.md) в список затронутых компонентов.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-124">The installer automatically sets the [**REINSTALL**](reinstall.md) property to the list of affected features.</span></span> <span data-ttu-id="1d0ce-125">Файлы, добавленные исправлением, удаляются, а файлы, которые были изменены с помощью исправления, перезаписываются.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-125">Files that were added by the patch are removed and files that were modified by the patch are overwritten.</span></span> <span data-ttu-id="1d0ce-126">Файлы и записи реестра восстанавливаются до версии, ожидаемой продуктом за вычетом исправления.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-126">Files and registry entries are restored to the version expected by the product minus the patch.</span></span> <span data-ttu-id="1d0ce-127">Компоненты и компоненты, добавленные с помощью исправления, отменяют регистрацию в приложении.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-127">Features and components that were added by the patch are unregistered from the application.</span></span> <span data-ttu-id="1d0ce-128">Обратите внимание, что дополнительное содержимое, добавленное исправлением, может остаться на компьютере пользователя, если содержимое используется другим исправлением, которое по-прежнему применимо.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-128">Note that additional content added by the patch can remain on the user's computer if the content is used by another patch that is still applicable.</span></span>

<span data-ttu-id="1d0ce-129">Если файл общего компонента обновляется с помощью исправления, это изменение затрагивает все приложения, которые совместно используют этот компонент.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-129">If a file of a shared component is updated by a patch, the change affects all applications that share the component.</span></span> <span data-ttu-id="1d0ce-130">После удаления исправления это изменение затрагивает все приложения, которые совместно используют этот компонент.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-130">When the patch is removed, again, the change affects all applications that share the component.</span></span> <span data-ttu-id="1d0ce-131">Это означает, что удаление исправления одним приложением может восстановить файл общего компонента до более ранней версии, чем требуется другим приложением.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-131">This means that removal of a patch by one application can restore the file of the shared component to a lower version than required by another application.</span></span> <span data-ttu-id="1d0ce-132">Это может исправить первое приложение, но приведет к прекращению работы второго приложения.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-132">This could fix the first application, but cause the second application to stop working.</span></span> <span data-ttu-id="1d0ce-133">В этом случае второе приложение можно восстановить путем переустановки второго приложения с помощью методов, описанных в разделах [Переустановка компонента или приложения](reinstalling-a-feature-or-application.md).</span><span class="sxs-lookup"><span data-stu-id="1d0ce-133">In this case, the second application can be repaired by reinstalling the second application using the methods describe in [Reinstalling a Feature or Application](reinstalling-a-feature-or-application.md).</span></span> <span data-ttu-id="1d0ce-134">При этом будет восстановлена исправленная версия файла.</span><span class="sxs-lookup"><span data-stu-id="1d0ce-134">This will restore the patched version of the file.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1d0ce-135">См. также</span><span class="sxs-lookup"><span data-stu-id="1d0ce-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1d0ce-136">**мсиенумаппликатионсекс**</span><span class="sxs-lookup"><span data-stu-id="1d0ce-136">**MsiEnumapplicationsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)
</dt> <dt>

[<span data-ttu-id="1d0ce-137">**мсижетпатчинфоекс**</span><span class="sxs-lookup"><span data-stu-id="1d0ce-137">**MsiGetPatchInfoEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)
</dt> <dt>

[<span data-ttu-id="1d0ce-138">**мсипатчремове**</span><span class="sxs-lookup"><span data-stu-id="1d0ce-138">**MSIPATCHREMOVE**</span></span>](msipatchremove.md)
</dt> <dt>

[<span data-ttu-id="1d0ce-139">**мсиремовепатчес**</span><span class="sxs-lookup"><span data-stu-id="1d0ce-139">**MsiRemovePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)
</dt> <dt>

[<span data-ttu-id="1d0ce-140">Последовательность исправлений</span><span class="sxs-lookup"><span data-stu-id="1d0ce-140">Patch Sequencing</span></span>](sequencing-patches.md)
</dt> <dt>

[<span data-ttu-id="1d0ce-141">Настраиваемые действия при удалении исправлений</span><span class="sxs-lookup"><span data-stu-id="1d0ce-141">Patch Uninstall Custom Actions</span></span>](patch-uninstall-custom-actions.md)
</dt> <dt>

[<span data-ttu-id="1d0ce-142">Неустанавливаемые исправления</span><span class="sxs-lookup"><span data-stu-id="1d0ce-142">Uninstallable Patches</span></span>](uninstallable-patches.md)
</dt> <dt>

[<span data-ttu-id="1d0ce-143">Удаление исправлений</span><span class="sxs-lookup"><span data-stu-id="1d0ce-143">Uninstalling Patches</span></span>](uninstalling-patches.md)
</dt> </dl>

 

 



