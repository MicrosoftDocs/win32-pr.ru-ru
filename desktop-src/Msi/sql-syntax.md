---
description: Строки SQL запроса для установщик Windows ограничены следующими форматами.
ms.assetid: badee528-fa69-43ab-965e-d9e6f2529b99
title: Синтаксис SQL
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee1b7d1179a8b6035186a9a5e78f46fdc857ac18
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103908835"
---
# <a name="sql-syntax"></a>Синтаксис SQL

Строки SQL запроса для установщик Windows ограничены следующими форматами.



| Действие                             | Запрос                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Выберите группу записей          | Выберите \[ Distinct \] {Column-List} из списка {Table-List} \[ , где {Operation-List} \] \[ Упорядочить по {Column-List}\]                                                                                                                                                                                                                                                                                                                                                                                                       |
| Удаление записей из таблицы        | УДАЛИТЬ из {Table}, \[ где {Operation-List}\]                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Изменение существующих записей в таблице | Обновление {Table-List} SET {Column} = {константа} \[ , {Column} = {константа} \] \[ ,... \] \[ ГДЕ {Operation-List} \] Update запросы работают только для непервичных ключевых столбцов.<br/>                                                                                                                                                                                                                                                                                                                                      |
| Добавление записей в таблицу             | ВСТАВЛЯТЬ в {Table} ({Column-List}) значения ({Constant-List}) \[ временные \] двоичные данные не могут быть вставлены в таблицу непосредственно с помощью инструкций INSERT INTO или Update SQL. Дополнительные сведения см. [в разделе Добавление двоичных данных в таблицу с помощью SQL](adding-binary-data-to-a-table-using-sql.md).<br/>                                                                                                                                                                                                       |
| Добавление таблицы                        | CREATE TABLE {Table} ({Column} {Column Type}) \[ \] для каждого столбца необходимо указать типы столбцов при добавлении таблицы. Для создания новой таблицы необходимо указать хотя бы один первичный ключевой столбец. Возможные подстановки для {Column Type} в приведенных выше параметрах: CHAR \[ ({size}), \] \| символ \[ ({size}) \] \| лонгчар \| короткое \| \| целое \| длинный целочисленный \| объект \[ NOT NULL \] \[ временно \] \[ локализуемый \] \[ , столбец... \] \[ ,... \] ПЕРВИЧный ключевой столбец \[ , столбец \] \[ ,... \] .<br/> |
| Удаление таблицы                     | DROP TABLE {таблица}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Добавление столбца                       | ALTER TABLE {таблица} добавить {Column} {тип столбца} при добавлении столбца необходимо указать тип столбца. Возможные подстановки для {Column Type} в приведенных выше случаях: CHAR \[ ({size}), \] \| символ \[ ({size}) \] \| лонгчар \| короткое \| \| целое \| длинное целочисленное \| \[ значение не NULL \] \[ временно \] \[ локализуемое локализация \] \[ \] .<br/>                                                                                                                                                                  |
| Хранение и освобождение временных таблиц     | ALTER TABLE {таблица имя таблицы} ХОЛДАЛТЕР таблица {имя таблицы} СВОБОДна<br/> Пользователь может использовать команды, чтобы управлять жизненным периодом временной таблицы или временным столбцом, а также свободным. Число удержаний в таблице увеличивается для каждой операции SQL-сохранения в этой таблице и уменьшается для каждой операции SQL FREE в таблице. Когда число последних удержаний в таблице освобождается, все временные столбцы становятся недоступными. Если все столбцы являются временными, таблица становится недоступной.<br/>     |



 

Дополнительные сведения см. в разделе [примеры запросов к базам данных с помощью SQL и скрипта](examples-of-database-queries-using-sql-and-script.md).

### <a name="sql-grammar"></a>Грамматика SQL

Необязательные параметры отображаются в квадратных скобках \[ \] . Если перечислены несколько вариантов, необязательные параметры разделяются вертикальной чертой.

{Constant} — это либо строка, либо целое число. Строка должна быть заключена в одинарные кавычки "example". {Constant-List} — это список из одной или нескольких констант с разделителями-запятыми.

Параметр LOCALIZABLE задает атрибут столбца, который указывает, что столбец должен быть локализован.

Столбец {Column} является ссылкой на значение в поле таблицы по столбцам.

{Фломастер} — это ссылка на параметр, предоставленная записью, отправленной с помощью запроса. Он представлен в инструкции SQL вопросительным знаком?. Сведения об использовании параметров см. в разделе Функция [**мсивиевексекуте**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute) или метод [**EXECUTE**](view-execute.md) .

Синтаксис SQL установщик Windows не поддерживает экранирование одинарных кавычек (ASCII-значение 39) в строковом литерале. Однако можно получить или создать запись, задать для поля свойство [**StringData**](record-stringdata.md) или [**IntegerData**](record-integerdata.md) , а затем вызвать метод [**Modify**](view-modify.md) . Кроме того, можно создать запись и использовать маркеры параметров (?), описанные в разделе [**выполнение**](view-execute.md) метода. Это также можно сделать с помощью функций базы данных [**мсивиевексекуте**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute), [**мсирекордсетинтежер**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetinteger)и [**мсирекордсетстринг**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa).

Предложение WHERE {Operation-List} является необязательным и представляет собой группирование операций, используемых для фильтрации выбранных элементов. Операции должны иметь следующие типы:

-   {Column} = {столбец}
-   {Column} = \|  <>  \|  >  \|  <  \|  >=  \| <= {константа}
-   {Column} = \|  <>  \|  >  \|  <  \|  >=  \| <= {маркер}
-   {column} имеет значение null
-   {Column} не равно null

Для строковых значений возможны только операции = или <> . Сравнение значений объектов ограничено значением NULL и не равно NULL.

Отдельные операции можно группировать по операторам AND или or. Порядок может быть наложен с помощью круглых скобок ().

Предложение ORDER BY является необязательным и вызывает начальную задержку при сортировке. Упорядочение по строкам объединяет идентичные строки, но не будет сортировать строки по алфавиту.

Предложение DISTINCT является необязательным и не повторяет идентичные записи в возвращенном результирующем наборе.

{Table-List} — это разделенный запятыми список из одного или нескольких имен таблиц, называемых {Table} в соединении.

{Column-List} — это разделенный запятыми список из одного или нескольких столбцов таблицы, которые называются выбранным {Column}. Неоднозначные столбцы могут быть дополнительно определены как {имя_таблицы. Column}. Звездочку можно использовать в качестве списка столбцов в запросе SELECT для представления всех столбцов в таблицах, на которые имеются ссылки. При ссылке на поля по положению столбца выберите столбцы по имени вместо звездочки. Звездочку нельзя использовать в качестве списка столбцов в запросе INSERT INTO.

Для экранирования имен таблиц и столбцов, которые конфликтуют с ключевыми словами SQL, заключите имя между двумя знаками ударения \` \` (значение ASCII 96). Если имя столбца должно быть экранированным и полным в виде {имя_таблицы. Column}, то таблица и столбец должны быть экранированы по отдельности как { \` TableName \` . \` столбец \` }. Рекомендуется, чтобы все имена таблиц и столбцов были экранированы таким образом, чтобы избежать конфликта с зарезервированными словами и значительно повысить производительность.

Имена таблиц ограничены 31 символами. Дополнительные сведения см. в разделе [имена таблиц](table-names.md). В именах таблиц и столбцов учитывается регистр. В ключевых словах SQL регистр не учитывается.

Максимальное число выражений в предложении WHERE SQL-запроса ограничено значением 32.

Поддерживаются только внутренние объединения, которые задаются сравнением столбцов из разных таблиц. Циклические объединения не поддерживаются. Циклическое соединение — это SQL-запрос, который связывает три или более таблицы вместе в канал. Например, ниже приведено циклическое соединение:

``` syntax
WHERE Table1.Field1=Table2.Field1 AND Table2.Field2=Table3.Field1 AND Table3.Field2=Table1.Field2.
```

Столбцы, которые являются частью первичных ключей для таблицы, должны быть определены сначала в порядке приоритета, за которыми следуют все непервичные ключевые столбцы. Постоянные столбцы должны быть определены до временных столбцов. Последовательность сортировки текстового столбца не определена; Однако идентичные текстовые значения всегда группируются вместе.

Обратите внимание, что при добавлении или создании столбца необходимо указать тип столбца.

Таблицы не могут содержать более одного столбца типа "Object".

Максимальный размер, который можно явно указать для строкового столбца в SQL-запросе, — 255. Строковый столбец неограниченной длины представлен как имеющий размер 0. Дополнительные сведения см. в разделе [Формат определения столбца](column-definition-format.md).

Чтобы выполнить любую инструкцию SQL, необходимо создать представление. Однако представление, в котором не создается результирующий набор, например CREATE TABLE или INSERT INTO, не может использоваться с [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) или методом [**Modify**](view-modify.md) для обновления таблиц, если это представление.

Обратите внимание, что невозможно получить запись, содержащую двоичные данные из одной базы данных, а затем использовать эту запись для вставки данных в совершенно другую базу данных. Чтобы переместить двоичные данные из одной базы данных в другую, необходимо экспортировать данные в файл и затем импортировать их в новую базу данных с помощью запроса и функции [**мсирекордсетстреам**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) . Это гарантирует, что каждая база данных будет иметь собственную копию двоичных данных.

 

 




