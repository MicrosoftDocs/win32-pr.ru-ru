---
description: Обычно транзитивные компоненты используются для подготовки продукта к переустановке во время обновления системы.
ms.assetid: 73677573-945f-4646-89d8-93e28f7856fe
title: Использование транзитивных компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35982aafd486a62ce8560e507b8b6caf88e32591
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "104000020"
---
# <a name="using-transitive-components"></a><span data-ttu-id="a98f7-103">Использование транзитивных компонентов</span><span class="sxs-lookup"><span data-stu-id="a98f7-103">Using Transitive Components</span></span>

<span data-ttu-id="a98f7-104">Обычно транзитивные компоненты используются для подготовки продукта к переустановке во время обновления системы.</span><span class="sxs-lookup"><span data-stu-id="a98f7-104">A typical use for transitive components is to prepare a product to reinstall during a system upgrade.</span></span> <span data-ttu-id="a98f7-105">Автор пакета установки указывает, какие компоненты должны быть перепутаны во время обновления системы, так как у них есть перемещаемый атрибут.</span><span class="sxs-lookup"><span data-stu-id="a98f7-105">The author of the installation package specifies those components that need to be swapped out during a system upgrade as having the transitive attribute.</span></span> <span data-ttu-id="a98f7-106">Когда пользователь позднее обновляет систему, продукт необходимо переустановить.</span><span class="sxs-lookup"><span data-stu-id="a98f7-106">When the user later upgrades the system, the product must be reinstalled.</span></span> <span data-ttu-id="a98f7-107">При этой переустановке установщик удаляет более ранние компоненты и устанавливает более поздние компоненты без необходимости установки всего продукта.</span><span class="sxs-lookup"><span data-stu-id="a98f7-107">Upon this reinstall, the installer removes the earlier components and installs the later components, without having to install the entire product.</span></span>

<span data-ttu-id="a98f7-108">**Включение двух транзитивных компонентов в установочный пакет**</span><span class="sxs-lookup"><span data-stu-id="a98f7-108">**To include two transitive components in the installation package**</span></span>

1.  <span data-ttu-id="a98f7-109">Включите оба транзитивных компонента в установочный пакет.</span><span class="sxs-lookup"><span data-stu-id="a98f7-109">Include both transitive components in the installation package.</span></span>
2.  <span data-ttu-id="a98f7-110">Создавайте оба транзитных компонента в [таблице компонентов](component-table.md) так же, как обычные компоненты.</span><span class="sxs-lookup"><span data-stu-id="a98f7-110">Author both transitive components into the [Component table](component-table.md) the same as regular components.</span></span> <span data-ttu-id="a98f7-111">Каждый транзитный компонент должен иметь собственный уникальный идентификатор GUID, указанный в столбце ComponentId.</span><span class="sxs-lookup"><span data-stu-id="a98f7-111">Each transitive component must have its own unique GUID specified in the ComponentId column.</span></span>
3.  <span data-ttu-id="a98f7-112">Включите бит **мсидбкомпонентаттрибутестранситиве** в столбец Attributes таблицы Component для каждого перемещаемого компонента.</span><span class="sxs-lookup"><span data-stu-id="a98f7-112">Include the **msidbComponentAttributesTransitive** bit in the Attributes column of the Component table for each transitive component.</span></span> <span data-ttu-id="a98f7-113">Если этот бит задан, установщик повторно вычисляет значение инструкции в столбце Condition при переустановке.</span><span class="sxs-lookup"><span data-stu-id="a98f7-113">If this bit is set, the installer reevaluates the value of the statement in the Condition column upon a reinstall.</span></span>

    <span data-ttu-id="a98f7-114">Если значение было ранее false и изменилось на true, установщик установит компонент.</span><span class="sxs-lookup"><span data-stu-id="a98f7-114">If the value was previously False and has changed to True, the installer installs the component.</span></span>

    <span data-ttu-id="a98f7-115">Если значение было ранее true и изменилось на false, установщик удаляет компонент, даже если этот компонент содержит другие продукты в качестве клиентов.</span><span class="sxs-lookup"><span data-stu-id="a98f7-115">If the value was previously True and has changed to False the installer removes the component even if the component has other products as clients.</span></span>

    > [!Note]  
    > <span data-ttu-id="a98f7-116">Если не установлен транзитный бит, компонент остается включенным после установки, даже если условное выражение принимает значение false при последующем обслуживании продукта.</span><span class="sxs-lookup"><span data-stu-id="a98f7-116">Unless the transitive bit is set, the component remains enabled once installed even if the conditional statement evaluates to False on a subsequent maintenance installation of the product.</span></span> <span data-ttu-id="a98f7-117">Условия должны основываться только на состояниях компьютеров.</span><span class="sxs-lookup"><span data-stu-id="a98f7-117">The conditions must be based only on computer states.</span></span> <span data-ttu-id="a98f7-118">Не используйте с условиями на основе пользовательских состояний или свойств, заданных в командной строке, так как это может привести к тому, что установщик потребует переустановки продукта для каждого использования другим пользователем.</span><span class="sxs-lookup"><span data-stu-id="a98f7-118">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

     

4.  <span data-ttu-id="a98f7-119">Введите дополнительные условные выражения в поля условия в таблице элементов управления таким, что при изменении условия для первого транзитного компонента на значение false условие для второго транзитного компонента изменится на true.</span><span class="sxs-lookup"><span data-stu-id="a98f7-119">Enter complementary conditional expressions into the Condition fields of the Control table such that when the condition on the first transitive component changes to False the condition on the second transitive component changes to True.</span></span> <span data-ttu-id="a98f7-120">Это приводит к удалению первого компонента и установке второго компонента после переустановки приложения.</span><span class="sxs-lookup"><span data-stu-id="a98f7-120">This results in the removal of the first component and installation of the second component upon reinstallation of the application.</span></span>

<span data-ttu-id="a98f7-121">Переустановка продукта необходима для переключения транзитивных компонентов.</span><span class="sxs-lookup"><span data-stu-id="a98f7-121">A reinstallation of the product is necessary to switch the transitive components.</span></span> <span data-ttu-id="a98f7-122">Таким образом, авторы пакетов должны предоставить пользователям метод для переустановки продукта и настройки режимов свойства [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="a98f7-122">Package authors therefore need to provide users with a method for reinstalling the product and for setting the modes of the [**REINSTALLMODE**](reinstallmode.md) property.</span></span> <span data-ttu-id="a98f7-123">Существует три основных способа запуска повторной установки.</span><span class="sxs-lookup"><span data-stu-id="a98f7-123">There are basically three ways to trigger the reinstallation:</span></span>

-   <span data-ttu-id="a98f7-124">Запустите и настройте переустановку через пользовательский интерфейс путем создания пакета, использующего [*полный пользовательский*](f-gly.md)интерфейс.</span><span class="sxs-lookup"><span data-stu-id="a98f7-124">Run and configure the reinstallation through the user interface by authoring a package that uses the [*full UI*](f-gly.md).</span></span>
-   <span data-ttu-id="a98f7-125">Запустите переустановку из командной строки с помощью команды **msiexec/f** и выберите режимы из списка для [параметра командной строки](command-line-options.md) **/f** .</span><span class="sxs-lookup"><span data-stu-id="a98f7-125">Run the reinstallation from the command line by using **msiexec /f** and select the modes from the list for the **/f** [command line option](command-line-options.md).</span></span>
-   <span data-ttu-id="a98f7-126">Вызовите приложение [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) или [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="a98f7-126">Have the application call [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) or [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="a98f7-127">Этот бит следует использовать только с условиями, основанными на состояниях компьютеров.</span><span class="sxs-lookup"><span data-stu-id="a98f7-127">The bit should only be used with conditions based on computer states.</span></span> <span data-ttu-id="a98f7-128">Не используйте с условиями на основе пользовательских состояний или свойств, заданных в командной строке, так как это может привести к тому, что установщик потребует переустановки продукта для каждого использования другим пользователем.</span><span class="sxs-lookup"><span data-stu-id="a98f7-128">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

> [!Note]
> <span data-ttu-id="a98f7-129">Если для компонента не задано значение транзитного бита в столбце атрибуты, компонент остается включенным после установки, даже если условный оператор в столбце Condition имеет значение false при последующем обслуживании продукта.</span><span class="sxs-lookup"><span data-stu-id="a98f7-129">Unless the Transitive bit in the Attributes column is set for a component, the component remains enabled once installed even if the conditional statement in the Condition column evaluates to False on a subsequent maintenance installation of the product.</span></span>
> 
> <span data-ttu-id="a98f7-130">В большинстве случаев, если приложение содержит транзитивные компоненты, установщик Windows требует от источника приложения восстановить или обновить приложение.</span><span class="sxs-lookup"><span data-stu-id="a98f7-130">In most cases, if an application includes transitive components, Windows Installer requires the application's source to repair or upgrade the application.</span></span> <span data-ttu-id="a98f7-131">В таких случаях компакт-диск восстановления системы, поставляемый производителем оборудования, не работает, и необходимо предоставить фактический источник установки для приложения.</span><span class="sxs-lookup"><span data-stu-id="a98f7-131">In these cases, the system restoration CD-ROM shipped by an original equipment manufacturer does not work and an actual installation source for the application needs to be provided.</span></span>

 

 

 



