---
description: Сведения о локализации можно добавить в базу данных установки с помощью редактора таблиц баз данных, например Orca, поставляемого с установщик Windows SDK, или путем вызова функций базы данных из приложения.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Обработка кодовых страниц строк параметров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22a52872472d5509e1abdf35aa12be5afb6a8d13
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263342"
---
# <a name="code-page-handling-of-parameter-strings"></a><span data-ttu-id="0c4d0-103">Обработка кодовых страниц строк параметров</span><span class="sxs-lookup"><span data-stu-id="0c4d0-103">Code Page Handling of Parameter Strings</span></span>

<span data-ttu-id="0c4d0-104">Сведения о локализации можно добавить в базу данных установки с помощью редактора таблиц баз данных, например Orca, поставляемого с установщик Windows SDK, или путем вызова [функций базы данных](database-functions.md) из приложения.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-104">You can add localization information to an installation database by using a database table editor such as Orca that is provided with the Windows Installer SDK, or by calling the [Database Functions](database-functions.md) from an application.</span></span> <span data-ttu-id="0c4d0-105">Будьте внимательны, чтобы передавать только строковые параметры, использующие кодовую страницу локализованной базы данных.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-105">Be careful to only pass string parameters that use the code page of the database that is being localized.</span></span> <span data-ttu-id="0c4d0-106">Если строковый параметр содержит символы, которые не могут быть представлены кодовой страницей базы данных, установщик возвращает ошибку при вызове [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="0c4d0-106">If a string parameter contains characters that cannot be represented by the code page of the database, the Installer returns an error when calling [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="0c4d0-107">Список страниц с числовыми кодовыми номерами см. в разделе [Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="0c4d0-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="0c4d0-108">Дополнительные сведения см. в разделе [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="0c4d0-108">For more information, see [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

## <a name="adding-localization-information-to-a-database"></a><span data-ttu-id="0c4d0-109">Добавление сведений о локализации в базу данных</span><span class="sxs-lookup"><span data-stu-id="0c4d0-109">Adding Localization Information to a Database</span></span>

<span data-ttu-id="0c4d0-110">При добавлении сведений о локализации в базу данных эта кодовая страница должна поддерживаться операционной системой.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-110">When you add localization information to a database, the code page of the database must be supported by the operating system.</span></span> <span data-ttu-id="0c4d0-111">Она не обязательно должна быть текущей кодовой страницей системы.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-111">It does not have to be the current code page of the system.</span></span> <span data-ttu-id="0c4d0-112">[**Исвалидкодепаже**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) должен возвращать **значение true** для кодовой страницы базы данных.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) must return **TRUE** for the database code page.</span></span> <span data-ttu-id="0c4d0-113">Поскольку система преобразует строки ANSI в Юникод, возникает ошибка, если текущая кодовая страница пользователя не совпадает с кодовой страницей базы данных.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-113">Because the system converts ANSI strings to Unicode, there is an error if the current user code page is not the same as the database code page.</span></span>

<span data-ttu-id="0c4d0-114">Вызов версии ANSI установщик Windows API преобразует локализованную строку в Юникод с помощью текущей системной кодовой страницы.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-114">Calling the ANSI version of the Windows Installer API converts the localized string to Unicode by using the current system code page.</span></span> <span data-ttu-id="0c4d0-115">При фиксации базы данных строка Юникода преобразуется в ANSI с помощью кодовой страницы базы данных.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-115">When the database is committed, the Unicode string is converted to ANSI using the code page of the database.</span></span> <span data-ttu-id="0c4d0-116">Если текущая системная кодовая страница отличается от кодовой страницы локализованной строки, результат может быть потерянным и неверно преобразован строкой.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-116">If the current system code page differs from the code page of the localized string, the result can be a loss of data and incorrect string conversion.</span></span>

<span data-ttu-id="0c4d0-117">В следующей процедуре показано, как сохранить данные локализации.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-117">The following procedure shows you how to store the localization data.</span></span>

<span data-ttu-id="0c4d0-118">**Хранение данных локализации**</span><span class="sxs-lookup"><span data-stu-id="0c4d0-118">**To store localization data**</span></span>

1.  <span data-ttu-id="0c4d0-119">Задайте кодовую страницу для базы данных в виде кодовой страницы локализованной строки.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-119">Set the code page of the database to the code page of the localized string.</span></span>
2.  <span data-ttu-id="0c4d0-120">Преобразуйте строку ANSI в Юникод с помощью функции [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) и укажите кодовую страницу для локализованных данных.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-120">Convert the ANSI string to Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function, and specify the code page of the localized data.</span></span>
3.  <span data-ttu-id="0c4d0-121">Чтобы добавить локализованные данные, вызовите версию API установщик Windows для Юникода с помощью строки Юникода.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-121">Call the Unicode version of the Windows Installer API by using the Unicode string to add the localized data.</span></span>
4.  <span data-ttu-id="0c4d0-122">Зафиксируйте изменения локализации в базе данных с помощью [**мсидатабасекоммит**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="0c4d0-122">Commit the localization changes to the database by using [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="0c4d0-123">Также можно добавить сведения о локализации в базу данных установки, импортировав и экспортировав текстовые архивные файлы ASCII.</span><span class="sxs-lookup"><span data-stu-id="0c4d0-123">You can also add localization information to an installation database by importing and exporting ASCII text archive files.</span></span> <span data-ttu-id="0c4d0-124">Дополнительные сведения см. в разделе [Обработка кодовых страниц импортированных и экспортированных таблиц](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="0c4d0-124">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

 

 
