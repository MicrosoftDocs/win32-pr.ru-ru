---
description: Файл WiMakCab.vbs VBScript предоставляется в Windows SDK компонентов для установщик Windows разработчиков. В этом примере показано, как использовать скрипт для создания CAB-файлов из базы данных установщик Windows.
ms.assetid: 26671cb9-a200-4520-8b52-4cff3f71a2f2
title: Создать CAB-файл
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3df2355c247ff602d644d2865ec3b9d9a8447ca4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103998811"
---
# <a name="generate-file-cabinet"></a><span data-ttu-id="e6419-104">Создать CAB-файл</span><span class="sxs-lookup"><span data-stu-id="e6419-104">Generate File Cabinet</span></span>

<span data-ttu-id="e6419-105">Файл WiMakCab.vbs VBScript предоставляется в [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="e6419-105">The VBScript file WiMakCab.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="e6419-106">В этом примере показано, как использовать скрипт для создания CAB-файлов из базы данных установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="e6419-106">This sample shows how script is used to generate file cabinets from a Windows Installer database.</span></span>

<span data-ttu-id="e6419-107">В этом примере демонстрируются следующее:</span><span class="sxs-lookup"><span data-stu-id="e6419-107">This sample demonstrates:</span></span>

-   <span data-ttu-id="e6419-108">[**Метод опендатабасе (объект установщика)**](installer-opendatabase.md) и [**метод ластерроррекорд**](installer-lasterrorrecord.md) [**объекта установщика**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="e6419-108">[**OpenDatabase method (Installer Object)**](installer-opendatabase.md) and the [**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer Object**](installer-object.md)</span></span>
-   <span data-ttu-id="e6419-109">[**Метод Commit**](database-commit.md), [**метод OpenView**](database-openview.md) и [**свойство SummaryInformation (объект базы данных)**](database-summaryinformation.md) [**объекта базы данных**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="e6419-109">[**Commit method**](database-commit.md), the [**OpenView method**](database-openview.md) and [**SummaryInformation property (Database Object)**](database-summaryinformation.md) of the [**Database Object**](database-object.md)</span></span>
-   <span data-ttu-id="e6419-110">Метод [**Fetch**](view-fetch.md), [**метод Execute**](view-execute.md) и [**метод Modify**](view-modify.md) [**объекта View**](view-object.md)</span><span class="sxs-lookup"><span data-stu-id="e6419-110">[**Fetch method**](view-fetch.md), [**Execute method**](view-execute.md) and [**Modify method**](view-modify.md) of the [**View Object**](view-object.md)</span></span>
-   <span data-ttu-id="e6419-111">[**Свойство StringData**](record-stringdata.md) и [**свойство IntegerData**](record-integerdata.md) [**объекта Record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="e6419-111">[**StringData property**](record-stringdata.md) and [**IntegerData property**](record-integerdata.md) of the [**Record Object**](record-object.md)</span></span>
-   <span data-ttu-id="e6419-112">[**Метод DoAction**](session-doaction.md), [**свойство Property (объект Session)**](session-session.md)и [**свойство Mode**](session-mode.md) [**объекта Session**](session-object.md)</span><span class="sxs-lookup"><span data-stu-id="e6419-112">[**DoAction method**](session-doaction.md), the [**Property property (Session Object)**](session-session.md), and the [**Mode property**](session-mode.md) of the [**Session Object**](session-object.md)</span></span>

<span data-ttu-id="e6419-113">Для использования этого примера потребуется CScript.exe или WScript.exe версию сервера сценариев Windows.</span><span class="sxs-lookup"><span data-stu-id="e6419-113">You'll require the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="e6419-114">Чтобы использовать CScript.exe для запуска этого образца, введите команду в командной строке, используя следующий синтаксис.</span><span class="sxs-lookup"><span data-stu-id="e6419-114">To use CScript.exe to run this sample, type a command at the command prompt using the following syntax.</span></span> <span data-ttu-id="e6419-115">Если первый аргумент имеет значение/?, отображается справка.</span><span class="sxs-lookup"><span data-stu-id="e6419-115">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="e6419-116">или, если указано слишком мало аргументов.</span><span class="sxs-lookup"><span data-stu-id="e6419-116">or if too few arguments are specified.</span></span> <span data-ttu-id="e6419-117">Чтобы перенаправить выходные данные в файл, завершите командную строку с помощью VBS > \[ *путь к файлу* \] .</span><span class="sxs-lookup"><span data-stu-id="e6419-117">To redirect the output to a file, end the command line with VBS > \[*path to file*\].</span></span> <span data-ttu-id="e6419-118">Пример возвращает значение 0 для успешного выполнения, 1, если вызывается Справка, и 2 в случае сбоя сценария.</span><span class="sxs-lookup"><span data-stu-id="e6419-118">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="e6419-119">**cscript WiMakCab.vbs \[ путь к \] \[ базовому имени базы данных \] \[ необязательные исходные расположения\]**</span><span class="sxs-lookup"><span data-stu-id="e6419-119">**cscript WiMakCab.vbs \[path to database\]\[base name\]\[optional source locations\]**</span></span>

<span data-ttu-id="e6419-120">Чтобы создать CAB-файл, Makecab.exe должен находиться в пути.</span><span class="sxs-lookup"><span data-stu-id="e6419-120">In order to generate a cabinet, Makecab.exe must be on the PATH.</span></span> <span data-ttu-id="e6419-121">Служебная программа Makecab.exe входит в состав [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="e6419-121">The Makecab.exe utility is included in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="e6419-122">Обратите внимание, что образец не обновляет [таблицу мультимедиа](media-table.md) для обработки нескольких ящиков.</span><span class="sxs-lookup"><span data-stu-id="e6419-122">Note that the sample does not update the [Media table](media-table.md) to handle multiple cabinets.</span></span> <span data-ttu-id="e6419-123">Чтобы заменить встроенный CAB-файл, включите параметры:/R/C/U/Е.</span><span class="sxs-lookup"><span data-stu-id="e6419-123">To replace an embedded cabinet, include the options: /R /C /U /E.</span></span>

<span data-ttu-id="e6419-124">Укажите путь к базе данных установщика.</span><span class="sxs-lookup"><span data-stu-id="e6419-124">Specify the path to the installer database.</span></span> <span data-ttu-id="e6419-125">Он должен находиться в корне исходного дерева.</span><span class="sxs-lookup"><span data-stu-id="e6419-125">This must be located at the root of the source tree.</span></span> <span data-ttu-id="e6419-126">Укажите базовое имя для создаваемых CAB-файлов с учетом регистра.</span><span class="sxs-lookup"><span data-stu-id="e6419-126">Specify the case-sensitive base name for the generated cabinet files.</span></span> <span data-ttu-id="e6419-127">Если тип источника — сжатый, все файлы открываются в корне.</span><span class="sxs-lookup"><span data-stu-id="e6419-127">If the source type is compressed, all files are opened at the root.</span></span> <span data-ttu-id="e6419-128">Следующие параметры могут быть указаны в любой точке командной строки.</span><span class="sxs-lookup"><span data-stu-id="e6419-128">The following options may be specified at any point on the command line.</span></span>



| <span data-ttu-id="e6419-129">Параметр</span><span class="sxs-lookup"><span data-stu-id="e6419-129">Option</span></span>              | <span data-ttu-id="e6419-130">Описание</span><span class="sxs-lookup"><span data-stu-id="e6419-130">Description</span></span>                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e6419-131">параметр не указан</span><span class="sxs-lookup"><span data-stu-id="e6419-131">no option specified</span></span> |                                                                                                                                           |
| <span data-ttu-id="e6419-132">/C</span><span class="sxs-lookup"><span data-stu-id="e6419-132">/C</span></span>                  | <span data-ttu-id="e6419-133">Выполнить сжатие.</span><span class="sxs-lookup"><span data-stu-id="e6419-133">Run compression.</span></span> <span data-ttu-id="e6419-134">Если параметр/C не указан, WiMakCab.vbs создает файл DDF.</span><span class="sxs-lookup"><span data-stu-id="e6419-134">If /C is not specified, WiMakCab.vbs only generates the DDF file.</span></span>                                                        |
| <span data-ttu-id="e6419-135">/L</span><span class="sxs-lookup"><span data-stu-id="e6419-135">/L</span></span>                  | <span data-ttu-id="e6419-136">Использовать сжатие LZX вместо MSZIP</span><span class="sxs-lookup"><span data-stu-id="e6419-136">Use LZX compression instead of MSZIP</span></span>                                                                                                      |
| <span data-ttu-id="e6419-137">/F</span><span class="sxs-lookup"><span data-stu-id="e6419-137">/F</span></span>                  | <span data-ttu-id="e6419-138">Ограничить размер шкафа размером 1,44 МБ, а не компакт-диском</span><span class="sxs-lookup"><span data-stu-id="e6419-138">Limit cabinet size to 1.44 MB floppy size rather than CD-ROM</span></span>                                                                              |
| <span data-ttu-id="e6419-139">/U</span><span class="sxs-lookup"><span data-stu-id="e6419-139">/U</span></span>                  | <span data-ttu-id="e6419-140">Обновление базы данных для ссылки на созданный CAB-файл</span><span class="sxs-lookup"><span data-stu-id="e6419-140">Update the database to reference the generated cabinet</span></span>                                                                                    |
| <span data-ttu-id="e6419-141">/E</span><span class="sxs-lookup"><span data-stu-id="e6419-141">/E</span></span>                  | <span data-ttu-id="e6419-142">Внедрение CAB-файла в пакет установщика в виде потока</span><span class="sxs-lookup"><span data-stu-id="e6419-142">Embed the cabinet file in the installer package as a stream</span></span>                                                                               |
| <span data-ttu-id="e6419-143">/S</span><span class="sxs-lookup"><span data-stu-id="e6419-143">/S</span></span>                  | <span data-ttu-id="e6419-144">Использование порядковых номеров в таблице файлов, упорядоченной по каталогам</span><span class="sxs-lookup"><span data-stu-id="e6419-144">Use sequence numbers in the File table ordered by directories</span></span>                                                                             |
| <span data-ttu-id="e6419-145">/R</span><span class="sxs-lookup"><span data-stu-id="e6419-145">/R</span></span>                  | <span data-ttu-id="e6419-146">Вернитесь к установке, не являющейся CAB-файлом, удалите CAB-файл, если указан параметр/E (при выборе параметра/R удаляется свойство со сжатым битом Суммаринфо 15 & 2).</span><span class="sxs-lookup"><span data-stu-id="e6419-146">Revert to non-cabinet install, remove cabinet if /E is specified (The /R option removes the compressed bit - SummaryInfo property 15 & 2)</span></span> |



 

<span data-ttu-id="e6419-147">Дополнительные примеры сценариев см. в разделе [установщик Windows примеры сценариев](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="e6419-147">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="e6419-148">Примеры служебных программ, для которых не требуется сервер сценариев Windows, см. в разделе [установщик Windows средства разработки](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="e6419-148">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



