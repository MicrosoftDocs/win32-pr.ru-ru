---
description: Чтобы включить установщик Windows в приложении, необходимо использовать функции установщика. Таблицы в этом разделе определяют функции по категориям.
ms.assetid: 05a16915-6b47-4d51-b62a-5a4d92b87e50
title: Справочник по функциям установщика
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9261789f21bd559e49c4e5718ef68ce9d0bb41c8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103991142"
---
# <a name="installer-function-reference"></a>Справочник по функциям установщика

Чтобы включить установщик Windows в приложении, необходимо использовать функции установщика. Таблицы в этом разделе определяют функции по категориям.

## <a name="user-interface-and-logging-functions"></a>Пользовательский интерфейс и функции ведения журнала



| Имя                                                     | Описание                                                                           |
|----------------------------------------------------------|---------------------------------------------------------------------------------------|
| [**мсисетинтерналуи**](/windows/desktop/api/Msi/nf-msi-msisetinternalui)             | Включает внутренний пользовательский интерфейс установщика.                                 |
| [**мсисетекстерналуи**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia)             | Включает обработчик внешнего пользовательского интерфейса, который получает сообщения в строковом формате. |
| [**мсисетекстерналуирекорд**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) | Включает обработчик внешнего пользовательского интерфейса, который получает сообщения в формате записи. |
| [**мсиенаблелог**](/windows/desktop/api/Msi/nf-msi-msienableloga)                     | Задает режим ведения журнала для всех установок в вызывающем процессе.                       |



 

## <a name="handle-management-functions"></a>Функции управления обработчиками



| Имя                                             | Описание                                                   |
|--------------------------------------------------|---------------------------------------------------------------|
| [**мсиклосехандле**](/windows/desktop/api/Msi/nf-msi-msiclosehandle)         | Закрывает открытый маркер установки.                           |
| [**мсиклосеаллхандлес**](/windows/desktop/api/Msi/nf-msi-msicloseallhandles) | Закрывает все открытые дескрипторы установки. Не используйте для очистки. |



 

## <a name="installation-and-configuration-functions"></a>Функции установки и настройки



| Имя                                                                     | Описание                                                                                                                                                                                                                  |
|--------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**мсиадвертисепродукт**](/windows/desktop/api/Msi/nf-msi-msiadvertiseproducta)                       | Объявляет продукт.                                                                                                                                                                                                        |
| [**мсиадвертисепродуктекс**](/windows/desktop/api/Msi/nf-msi-msiadvertiseproductexa)                   | Объявляет продукт.                                                                                                                                                                                                        |
| [**мсиадвертисескрипт**](/windows/desktop/api/Msi/nf-msi-msiadvertisescripta)                         | Копирует файл объявленного скрипта в указанные расположения.                                                                                                                                                                    |
| [**мсиинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta)                           | Устанавливает или удаляет приложение или набор приложений.                                                                                                                                                                     |
| [**мсиконфигурепродукт**](/windows/desktop/api/Msi/nf-msi-msiconfigureproducta)                       | Устанавливает или удаляет приложение или набор приложений.                                                                                                                                                                     |
| [**мсиконфигурепродуктекс**](/windows/desktop/api/Msi/nf-msi-msiconfigureproductexa)                   | Устанавливает или удаляет приложение или набор приложений. Можно указать командную строку продукта.                                                                                                                            |
| [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta)                       | Переустанавливает или восстанавливает установку.                                                                                                                                                                                       |
| [**мсиконфигурефеатуре**](/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea)                       | Настраивает установленное состояние компонента.                                                                                                                                                                                 |
| [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea)                       | Проверяет или восстанавливает компоненты.                                                                                                                                                                                               |
| [**мсиинсталлмиссингкомпонент**](/windows/desktop/api/Msi/nf-msi-msiinstallmissingcomponenta)         | Устанавливает отсутствующие компоненты.                                                                                                                                                                                                 |
| [**мсиинсталлмиссингфиле**](/windows/desktop/api/Msi/nf-msi-msiinstallmissingfilea)                   | Устанавливает отсутствующие файлы.                                                                                                                                                                                                      |
| [**мсинотифисидчанже**](/windows/desktop/api/Msi/nf-msi-msinotifysidchangea)                         | Уведомляет и обновляет установщик Windows внутренние сведения с изменениями в SID пользователя. Доступно, начиная с установщик Windows 3,1.                                                                                   |
| [**мсипроцессадвертисескрипт**](/windows/desktop/api/Msi/nf-msi-msiprocessadvertisescripta)           | Обрабатывает файл скрипта объявления в указанных местах.                                                                                                                                                                 |
| [**мсисаурцелистаддсаурце**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourcea)                 | Добавляет или переупорядочивает источники исправления или продукта в указанном контексте.                                                                                                                                                   |
| [**мсисаурцелистаддсаурцеекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa)             | Добавляет или переупорядочивает источники исправления или продукта в указанном контексте. Создает список источников для исправления, которое не существует в указанном контексте. Доступно в установщик Windows 3,0.                                |
| [**мсисаурцелистклеарсаурце**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea)             | Удаляет существующий источник для продукта или исправления в указанном контексте. Доступно в установщик Windows 3,0.                                                                                                               |
| [**мсисаурцелистклеаралл**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearalla)                   | Удаляет все существующие источники заданного типа источника для указанного экземпляра продукта.                                                                                                                                 |
| [**мсисаурцелистклеараллекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa)               | Удаляет все существующие источники заданного типа источника для указанного экземпляра продукта. Доступно в установщик Windows 3,0.                                                                                            |
| [**мсисаурцелистфорцересолутион**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutiona)     | Удаляет регистрацию текущего источника продукта или исправления, зарегистрированного как свойство «Ластуседсаурце». Эта функция не влияет на список зарегистрированных источников.                                      |
| [**мсисаурцелистфорцересолутионекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) | Удаляет регистрацию текущего источника продукта или исправления, зарегистрированного как свойство «Ластуседсаурце». Эта функция не влияет на список зарегистрированных источников. Доступно в установщик Windows 3,0. |
| [**мсисаурцелистжетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa)                     | Извлекает сведения о списке источников для продукта или исправления в определенном контексте.                                                                                                                                    |
| [**мсисаурцелистсетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa)                     | Задает последний использованный источник для продукта или исправления в указанном контексте. Доступно в установщик Windows 3,0.                                                                                                       |
| [**мсисаурцелистенуммедиадискс**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa)       | Перечисляет список дисков, зарегистрированных для источника мультимедиа для исправления или продукта. Доступно в установщик Windows 3,0.                                                                                                    |
| [**мсисаурцелистаддмедиадиск**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska)           | Добавляет или обновляет диск источника носителя зарегистрированного продукта или исправления. Доступно в установщик Windows 3,0.                                                                                                            |
| [**мсисаурцелистклеармедиадиск**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska)      | Удаляет существующий зарегистрированный диск в источнике носителя для продукта или исправления в определенном контексте. Доступно в установщик Windows 3,0.                                                                                |
| [**мсисаурцелистенумсаурцес**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa)             | Перечисляет источники из исходного списка указанного исправления или продукта. Доступно в установщик Windows 3,0.                                                                                                              |



 

## <a name="component-specific-functions"></a>Функции Component-Specific



| Имя                                                                     | Описание                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**мсипровидеассембли**](/windows/desktop/api/Msi/nf-msi-msiprovideassemblya)                         | Устанавливает и возвращает полный путь к компоненту для сборки.                                                                                                                                                                 |
| [**мсипровидекомпонент**](/windows/desktop/api/Msi/nf-msi-msiprovidecomponenta)                       | Устанавливает и возвращает полный путь к компоненту компонента.                                                                                                                                                                  |
| [**мсипровидекуалифиедкомпонент**](/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponenta)     | Устанавливает и возвращает полный путь к компоненту квалифицированного компонента.                                                                                                                                                        |
| [**мсипровидекуалифиедкомпонентекс**](/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponentexa) | Устанавливает и возвращает полный путь к компоненту квалифицированного компонента, опубликованного продуктом.                                                                                                                         |
| [**мсижеткомпонентпас**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha)                       | Возвращает полный путь или раздел реестра для установленного компонента.                                                                                                                                                              |
| [**мсижеткомпонентпасекс**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa)                   | Возвращает полный путь или раздел реестра для установленного компонента между учетными записями пользователей и контекстом установки. **[Установщик Windows 4,5 и более ранних версий](not-supported-in-windows-installer-4-5.md):** Не поддерживается.<br/> |
| [**мсилокатекомпонент**](/windows/desktop/api/Msi/nf-msi-msilocatecomponenta)                         | Возвращает полный путь к установленному компоненту без кода продукта.                                                                                                                                                       |
| [**мсикуерикомпонентстате**](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea)                 | Возвращает состояние установки компонента. Может запрашивать компоненты экземпляра продукта, установленного под учетными записями пользователей, отличными от текущего пользователя. Доступно в установщик Windows 3,0 или более поздней версии.                        |



 

## <a name="application-only-functions"></a>Функции Application-Only



| Имя                                             | Описание                                                            |
|--------------------------------------------------|------------------------------------------------------------------------|
| [**мсиколлектусеринфо**](/windows/desktop/api/Msi/nf-msi-msicollectuserinfoa) | Сохраняет сведения о пользователе из мастера установки.                   |
| [**мсиусефеатуре**](/windows/desktop/api/Msi/nf-msi-msiusefeaturea)           | Увеличивает счетчик использования для компонента и указывает состояние установки. |
| [**мсиусефеатурикс**](/windows/desktop/api/Msi/nf-msi-msiusefeatureexa)       | Увеличивает счетчик использования для компонента и указывает состояние установки. |
| [**мсижетпродукткоде**](/windows/desktop/api/Msi/nf-msi-msigetproductcodea)   | Возвращает код продукта, используя код компонента.                         |



 

## <a name="system-status-functions"></a>Функции состояния системы



| Имя                                                             | Описание                                                                                                                                                                                                                       |
|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**мсиенумпродуктс**](/windows/desktop/api/Msi/nf-msi-msienumproductsa)                       | Перечисляет объявленные продукты.                                                                                                                                                                                                   |
| [**мсиенумпродуктсекс**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)                   | Перечисление всех экземпляров объявленных или установленных продуктов в указанном контексте. Доступно в установщик Windows 3,0 или более поздней версии.                                                                                    |
| [**мсиенумрелатедпродуктс**](/windows/desktop/api/Msi/nf-msi-msienumrelatedproductsa)         | Перечисляет продукты, установленные на данный момент с указанным кодом обновления.                                                                                                                                                          |
| [**мсиенумфеатурес**](/windows/desktop/api/Msi/nf-msi-msienumfeaturesa)                       | Перечисляет опубликованные компоненты.                                                                                                                                                                                                    |
| [**мсиенумкомпонентс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa)                   | Перечисляет установленные компоненты.                                                                                                                                                                                              |
| [**мсиенумкомпонентсекс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa)               | Перечисляет установленные компоненты по учетным записям пользователей и контексту установки. **[Установщик Windows 4,5 и более ранних версий](not-supported-in-windows-installer-4-5.md):** Не поддерживается.<br/>                                 |
| [**мсиенумклиентс**](/windows/desktop/api/Msi/nf-msi-msienumclientsa)                         | Перечисляет клиенты установленного компонента.                                                                                                                                                                                 |
| [**мсиенумклиентсекс**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa)                     | Перечисление клиентов установленного компонента по учетным записям пользователей и контексту установки. **[Установщик Windows 4,5 и более ранних версий](not-supported-in-windows-installer-4-5.md):** Не поддерживается.<br/>                    |
| [**мсиенумкомпоненткуалифиерс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentqualifiersa) | Перечисляет объявленные квалификаторы для компонента.                                                                                                                                                                             |
| [**мсикуерифеатурестате**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea)             | Возвращает состояние установки компонента.                                                                                                                                                                                         |
| [**мсикуерифеатурестатикс**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa)         | Возвращает состояние установки для компонента продукта. Может запрашивать возможности экземпляра продукта, установленного под учетными записями пользователей, отличными от текущего пользователя. Доступно в установщик Windows 3,0 или более поздней версии.                        |
| [**мсикуерипродуктстате**](/windows/desktop/api/Msi/nf-msi-msiqueryproductstatea)             | Возвращает состояние установки для приложения или набора приложений.                                                                                                                                                              |
| [**мсижетфеатуреусаже**](/windows/desktop/api/Msi/nf-msi-msigetfeatureusagea)                 | Возвращает метрики использования для компонента.                                                                                                                                                                                              |
| [**мсижетпродуктинфо**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoa)                   | Возвращает сведения о продукте для опубликованных и установленных продуктов.                                                                                                                                                                 |
| [**мсижетпродуктинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa)               | Возвращает сведения о продукте для объявленных и установленных продуктов. Может получать сведения об экземпляре продукта, установленном под учетной записью пользователя, отличной от текущего пользователя. Доступно в установщик Windows 3,0 или более поздней версии. |
| [**мсижетусеринфо**](/windows/desktop/api/Msi/nf-msi-msigetuserinfoa)                         | Возвращает сведения о зарегистрированном пользователе для установленного продукта.                                                                                                                                                                     |



 

## <a name="product-query-functions"></a>Функции запроса продукта



| Имя                                                               | Описание                                                                            |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| [**мсиопенпродукт**](/windows/desktop/api/Msi/nf-msi-msiopenproducta)                           | Открывает продукт для использования с функциями, которые обращаются к базе данных.                    |
| [**мсиопенпаккаже**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea)                           | Открывает пакет для использования с функциями, которые обращаются к базе данных.                    |
| [**мсиопенпаккажеекс**](/windows/desktop/api/Msi/nf-msi-msiopenpackageexa)                       | Открывает пакет для использования с функциями, которые обращаются к базе данных.                    |
| [**мсииспродуктелеватед**](/windows/desktop/api/Msi/nf-msi-msiisproductelevateda)               | Проверяет, установлен ли продукт с повышенными привилегиями.                      |
| [**мсижетпродуктинфофромскрипт**](/windows/desktop/api/Msi/nf-msi-msigetproductinfofromscripta) | Возвращает сведения о продукте для файла сценария установщика.                              |
| [**мсижетпродуктпроперти**](/windows/desktop/api/Msi/nf-msi-msigetproductpropertya)             | Извлекает свойства в базе данных продукта.                                          |
| [**мсижетшорткуттаржет**](/windows/desktop/api/Msi/nf-msi-msigetshortcuttargeta)               | Проверяет ярлык и возвращает его продукт, имя функции и компонент, если они доступны. |
| [**мсижетфеатуреинфо**](/windows/desktop/api/Msi/nf-msi-msigetfeatureinfoa)                     | Возвращает описательные сведения для функции.                                         |
| [**мсиверифипаккаже**](/windows/desktop/api/Msi/nf-msi-msiverifypackagea)                       | Проверяет, является ли указанный файл пакетом установки.                             |



 

## <a name="patching-functions"></a>Функции исправления



| Имя                                                                   | Описание                                                                                                                                                        |
|------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**мсиапплипатч**](/windows/desktop/api/Msi/nf-msi-msiapplypatcha)                                 | Вызывает установку и применяет пакет исправлений.                                                                                                               |
| [**мсиенумпатчес**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska)                    | Возвращает идентификатор GUID для каждого исправления, применяемого к продукту, и список преобразований каждого исправления, применимого к продукту.                                  |
| [**мсижетпатчинфо**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoa)                             | Возвращает сведения об исправлении.                                                                                                                                 |
| [**мсиремовепатчес**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)                           | Удаляет исправление из продукта. Доступно в установщик Windows 3,0.                                                                                             |
| [**мсидетерминепатчсекуенце**](/windows/desktop/api/Msi/nf-msi-msideterminepatchsequencea)         | Определяет наилучшую последовательность приложений для набора исправлений и продукта. Доступно в установщик Windows 3,0.                                                     |
| [**мсиапплимултиплепатчес**](/windows/desktop/api/Msi/nf-msi-msiapplymultiplepatchesa)             | Применяет один или несколько исправлений к продуктам. Доступно в установщик Windows 3,0.                                                                                       |
| [**мсиенумпатчесекс**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa)                           | Перечисляет все исправления, примененные к продукту в определенном контексте или во всех контекстах. Доступно в установщик Windows 3,0.                                   |
| [**мсижетпатчфилелист**](/windows/desktop/api/Msi/nf-msi-msigetpatchfilelista)                     | При указании списка MSP-файлов Эта функция извлекает список файлов, которые могут быть обновлены исправлениями для целева. Доступно в установщик Windows 4,0. |
| [**мсижетпатчинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)                         | Запрашивает сведения о применении указанного исправления к указанному продукту. Доступно в установщик Windows 3,0.                                     |
| [**мсиекстрактпатчксмлдата**](/windows/desktop/api/Msi/nf-msi-msiextractpatchxmldataa)               | Извлекает сведения из исправления. Доступно в установщик Windows 3,0.                                                                                             |
| [**мсидетерминеаппликаблепатчес**](/windows/desktop/api/Msi/nf-msi-msidetermineapplicablepatchesa) | Определяет оптимальный набор исправлений, необходимых для обновления продукта или набора продуктов. Доступно в установщик Windows 3,0.                                            |



 

## <a name="file-query-functions"></a>Функции файловых запросов



| Имя                                                                     | Описание                                                                                                 |
|--------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| [**мсижетфилехаш**](/windows/desktop/api/Msi/nf-msi-msigetfilehasha)                                 | Принимает путь к файлу и возвращает 128-разрядный хэш этого файла.                                           |
| [**мсижетфилесигнатуреинформатион**](/windows/desktop/api/Msi/nf-msi-msigetfilesignatureinformationa) | Принимает путь к файлу с цифровой подписью и возвращает сертификат и хэш-код подписавшего файла. |
| [**мсижетфилеверсион**](/windows/desktop/api/Msi/nf-msi-msigetfileversiona)                           | Возвращает строку версии и строку языка.                                                             |



 

## <a name="transaction-management-functions"></a>Функции управления транзакциями



| Имя                                               | Описание                                                                                                                                                                                         |
|----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**мсибегинтрансактион**](/windows/desktop/api/Msi/nf-msi-msibegintransactiona) | Запускает обработку транзакций для установки нескольких пакетов и возвращает идентификатор транзакции. Эта функция доступна начиная с установщик Windows 4,5.                    |
| [**мсижоинтрансактион**](/windows/desktop/api/Msi/nf-msi-msijointransaction)   | Запрашивает, что установщик Windows делает текущий процесс владельцем транзакции, устанавливая многопакетную установку. Эта функция доступна начиная с установщик Windows 4,5. |
| [**мсиендтрансактион**](/windows/desktop/api/Msi/nf-msi-msiendtransaction)     | Фиксирует или откатывает все установки, принадлежащие транзакции. Эта функция доступна начиная с установщик Windows 4,5.                                                          |



 

## <a name="database-functions"></a>Функции базы данных

В дополнение к функциям установщик Windows, указанным в предыдущих таблицах, можно управлять данными в базе данных установки с помощью функций доступа к базе данных, описанных в разделе [функции базы данных](database-functions.md) .

## <a name="installer-structures"></a>Структуры установщика

Кроме того, некоторые сведения в базе данных установки обрабатываются с помощью структур, описанных в разделе [структуры установщика](installer-structures.md) .

 

 




