---
description: Начиная с установщик Windows 3,0, авторы могут добавлять сведения о последовательности исправлений в базу данных пакета исправлений в таблице Мсипатчсекуенце.
ms.assetid: 9cdcb25f-2c3d-411e-9aae-bdd52df38a97
title: Исправления последовательности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa9cbd9aead596abfaeb50d972915bf4d618440d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272940"
---
# <a name="sequencing-patches"></a><span data-ttu-id="b21b0-103">Исправления последовательности</span><span class="sxs-lookup"><span data-stu-id="b21b0-103">Sequencing Patches</span></span>

<span data-ttu-id="b21b0-104">Начиная с установщик Windows 3,0, авторы могут добавлять сведения о последовательности исправлений в базу данных пакета исправлений в таблице [мсипатчсекуенце](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="b21b0-104">Beginning with Windows Installer 3.0, authors can add patch sequencing information to the patch package database in the [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="b21b0-105">Установщик может использовать эти сведения для определения того, какие исправления применимы к установочному пакету, для определения наилучшей последовательности исправлений и установки исправлений в постоянном порядке независимо от порядка, в котором они предоставляются системе.</span><span class="sxs-lookup"><span data-stu-id="b21b0-105">The installer can use this information to determine which patches are applicable to an installation package, to determine the best patching sequence, and to install patches in an constant order independent of the order they are provided to the system.</span></span>

<span data-ttu-id="b21b0-106">**Установщик Windows 2,0:** Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="b21b0-106">**Windows Installer 2.0:** Not supported.</span></span> <span data-ttu-id="b21b0-107">Установщик Windows версии, предшествующие установщик Windows 3,0, устанавливают исправления в том порядке, в котором они предоставляются системе, независимо от того, содержат ли они таблицу [мсипатчсекуенце](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="b21b0-107">Windows Installer versions previous to Windows Installer 3.0 install patches in the order that they are provided to the system regardless of whether they contain an [MsiPatchSequence](msipatchsequence-table.md) table.</span></span>

<span data-ttu-id="b21b0-108">Для использования функции последовательности исправлений необходимо выполнить следующие условия.</span><span class="sxs-lookup"><span data-stu-id="b21b0-108">The following are required to use the patch sequencing functionality.</span></span>

-   <span data-ttu-id="b21b0-109">[Пакеты исправлений](patch-packages.md) (MSP-файлы) должны содержать таблицу [мсипатчсекуенце](msipatchsequence-table.md) , содержащую сведения о последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-109">[Patch packages](patch-packages.md) (.msp files) must have a [MsiPatchSequence](msipatchsequence-table.md) table containing sequencing information.</span></span> <span data-ttu-id="b21b0-110">Установщик устанавливает исправления, у которых нет таблицы Мсипатчсекуенце в том порядке, в котором они передаются в систему.</span><span class="sxs-lookup"><span data-stu-id="b21b0-110">The installer installs patches that do not have a MsiPatchSequence table in the order that they are provided to the system.</span></span>
-   <span data-ttu-id="b21b0-111">Исправления устанавливаются с помощью установщик Windows 3,0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="b21b0-111">Patches are installed using Windows Installer 3.0 or later.</span></span>

<span data-ttu-id="b21b0-112">В установщик Windows версии 3,0 есть следующие функции, которые могут использоваться приложениями для определения наилучшей последовательности исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-112">Windows Installer version 3.0 has the following functions that applications can use to determine the best patching sequence.</span></span>

-   <span data-ttu-id="b21b0-113">Функция [**мсидетерминепатчсекуенце**](/windows/desktop/api/Msi/nf-msi-msideterminepatchsequencea) принимает список исправлений и определяет, в какой последовательности они могут быть применены к установленному продукту.</span><span class="sxs-lookup"><span data-stu-id="b21b0-113">The [**MsiDeterminePatchSequence**](/windows/desktop/api/Msi/nf-msi-msideterminepatchsequencea) function takes a list of patches and determines in what sequence they can be applied to an installed product.</span></span> <span data-ttu-id="b21b0-114">Эта функция учетных записей содержит исправления или продукты, уже установленные в системе.</span><span class="sxs-lookup"><span data-stu-id="b21b0-114">This function accounts for any patches or products that have already been installed on the system.</span></span>
-   <span data-ttu-id="b21b0-115">Функция [**мсидетерминеаппликаблепатчес**](/windows/desktop/api/Msi/nf-msi-msidetermineapplicablepatchesa) принимает список исправлений и определяет, в какой последовательности они могут быть применены к установленному продукту.</span><span class="sxs-lookup"><span data-stu-id="b21b0-115">The [**MsiDetermineApplicablePatches**](/windows/desktop/api/Msi/nf-msi-msidetermineapplicablepatchesa) function takes a list of patches and determines in what sequence they can be applied to an installed product.</span></span> <span data-ttu-id="b21b0-116">Эта функция не учитывает какие либо исправления или продукты, уже установленные в системе.</span><span class="sxs-lookup"><span data-stu-id="b21b0-116">This function does not account for any patches or products that have already been installed on the system.</span></span>

<span data-ttu-id="b21b0-117">Установщик Windows версии 3,0 может применять несколько исправлений к продукту в одной установке исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-117">Windows Installer version 3.0 can apply multiple patches to a product in a single patching installation.</span></span> <span data-ttu-id="b21b0-118">Группа исправлений может содержать исправления, включающие сведения о последовательности исправлений ( [мсипатчсекуенце](msipatchsequence-table.md) таблицу) и исправления, которые не имеют.</span><span class="sxs-lookup"><span data-stu-id="b21b0-118">The group of patches can contain patches that include patching sequence information (a [MsiPatchSequence](msipatchsequence-table.md) table) and patches that do not.</span></span> <span data-ttu-id="b21b0-119">Установщик Windows устанавливает пакеты исправлений без этой таблицы в том порядке, в котором они передаются в систему.</span><span class="sxs-lookup"><span data-stu-id="b21b0-119">The Windows Installer installs the patch packages without this table in the order that they are provided to the system.</span></span> <span data-ttu-id="b21b0-120">Учетные записи установщика для пакетов исправлений, в которых отсутствует таблица Мсипатчсекуенце, но помечены как устаревшие или заменяемые исправлениями методом, описанным в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="b21b0-120">The installer accounts for patch packages that lack a MsiPatchSequence table, but that have been marked as obsolete or superseded patches by the method described in the following section.</span></span>

<span data-ttu-id="b21b0-121">Если установщик Windows версии 3,0 устанавливает несколько исправлений, то для определения последовательности применения отдельных исправлений к продукту необходимо выполнить указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="b21b0-121">When Windows Installer version 3.0 installs multiple patches, it follows these steps to determine the sequence in which individual patches are applied to the product:</span></span>

1.  <span data-ttu-id="b21b0-122">Установленные исправления без таблицы [мсипатчсекуенце](msipatchsequence-table.md) помещаются в последовательность в том порядке, в котором они были применены к продукту.</span><span class="sxs-lookup"><span data-stu-id="b21b0-122">Installed patches without a [MsiPatchSequence](msipatchsequence-table.md) table are put in the sequence in the order that they were applied to the product.</span></span> <span data-ttu-id="b21b0-123">Первое примененное исправление помещается первым в последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-123">The first patch that was applied is placed first in the sequence.</span></span>
2.  <span data-ttu-id="b21b0-124">В последовательность помещаются новые исправления без [таблицы мсипатчсекуенце](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="b21b0-124">New patches without a [MsiPatchSequence table](msipatchsequence-table.md) are put in the sequence.</span></span> <span data-ttu-id="b21b0-125">Эти исправления применяются текущей установкой исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-125">These patches are being applied by the current patching installation.</span></span> <span data-ttu-id="b21b0-126">Они помещаются в том порядке, в котором они предоставляются системе, и помещаются после всех исправлений на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="b21b0-126">They are put in the order that they are provided to the system, and placed after all the patches in step 1.</span></span>
3.  <span data-ttu-id="b21b0-127">Из последовательности исправлений устраняются устаревшие исправления.</span><span class="sxs-lookup"><span data-stu-id="b21b0-127">Obsolete patches are eliminated from the sequence of patches.</span></span>
    > [!Note]  
    > <span data-ttu-id="b21b0-128">Пакет исправлений может быть указан в свойстве [**сводки номера редакции**](revision-number-summary.md) — явный список устаревших исправлений, которые будут удалены с помощью исправления.</span><span class="sxs-lookup"><span data-stu-id="b21b0-128">A patch package can specify in the [**Revision Number Summary**](revision-number-summary.md) property an explicit list of obsolete patches to be removed by the patch.</span></span> <span data-ttu-id="b21b0-129">Этот список предназначен для использования установщик Windows версиями, предшествующими версии 3,0.</span><span class="sxs-lookup"><span data-stu-id="b21b0-129">This list is intended for use by Windows Installer versions earlier than version 3.0.</span></span> <span data-ttu-id="b21b0-130">Установщик Windows версии 3,0 удаляет исправления, помеченные как устаревшие, из последовательности, только если в исправлениях нет [таблицы мсипатчсекуенце](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="b21b0-130">Windows Installer version 3.0 removes the patches marked as obsolete from the sequence, only if the patches do not have the [MsiPatchSequence table](msipatchsequence-table.md).</span></span>

     

4.  <span data-ttu-id="b21b0-131">Установщик выполняет шаги по последовательности установки и определяет, какие исправления применимы в данной последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-131">The installer steps through the patching sequence and determines which patches are applicable in the given sequence.</span></span> <span data-ttu-id="b21b0-132">При применении к продукту нескольких исправлений каждое исправление в последовательности также преобразует базу данных установки продукта (MSI-файл).</span><span class="sxs-lookup"><span data-stu-id="b21b0-132">When multiple patches are applied to a product, each patch in the sequence also transforms the product's installation database (.msi file).</span></span> <span data-ttu-id="b21b0-133">Исправление применимо в определенной последовательности только в том случае, если его преобразование базы данных способно взять [код продукта](product-codes.md), [**версию**](productversion.md), [**язык**](productlanguage.md)и свойство [**UpgradeCode**](upgradecode.md) , которые были результатом применения преобразований всех предыдущих [пакетов исправлений](patch-packages.md) к базе данных продукта.</span><span class="sxs-lookup"><span data-stu-id="b21b0-133">A patch is applicable in a particular sequence only if its database transform is capable of taking the [product code](product-codes.md), [**version**](productversion.md), [**language**](productlanguage.md), and [**upgradecode**](upgradecode.md) that result from applying the transforms of all preceding [patch packages](patch-packages.md) to the product database.</span></span> <span data-ttu-id="b21b0-134">Установщик удаляет все неприменимые исправления из последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-134">The installer eliminates any inapplicable patches from the sequence.</span></span>
5.  <span data-ttu-id="b21b0-135">Установщик начинает размещать исправления, в таблице [мсипатчсекуенце](msipatchsequence-table.md) которых есть сведения о последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-135">The installer begins placing patches that have sequencing information in their [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="b21b0-136">[Незначительные обновления](minor-upgrades.md) , которые содержат таблицу мсипатчсекуенце, помещаются в последовательность после исправлений, которые были собраны в предыдущих шагах, а также в порядке их наименьшей и максимальной версий продукта после обновления.</span><span class="sxs-lookup"><span data-stu-id="b21b0-136">[Minor upgrade](minor-upgrades.md) patches that have the MsiPatchSequence table are placed in the sequence after the patches that were sequenced in previous steps and in the order of their lowest to highest product versions after being upgraded.</span></span> <span data-ttu-id="b21b0-137">Установщик Windows устраняет незначительные исправления обновления, неприменимые в этой последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-137">Windows Installer then eliminates any minor upgrade patches that are inapplicable in this sequence.</span></span>
6.  <span data-ttu-id="b21b0-138">[Небольшие исправления обновления](small-updates.md) , предназначенные для [незначительных обновлений](minor-upgrades.md) с таблицей [мсипатчсекуенце](msipatchsequence-table.md) , назначаются в самую новую версию незначительного обновления в последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-138">[Small update](small-updates.md) patches targeting [minor upgrades](minor-upgrades.md) having a [MsiPatchSequence](msipatchsequence-table.md) table, are assigned to the highest version of the minor upgrade patch in the sequence.</span></span>
7.  <span data-ttu-id="b21b0-139">Все [небольшие исправления обновлений](small-updates.md) , которые остаются неназначенными после предыдущих шагов, и с таблицей [мсипатчсекуенце](msipatchsequence-table.md) , помещаются в последовательность перед первым [незначительным обновлением](minor-upgrades.md) с таблицей мсипатчсекуенце, а также после базы данных установки MSI и любых исправлений без таблицы мсипатчсекуенце.</span><span class="sxs-lookup"><span data-stu-id="b21b0-139">All [small update](small-updates.md) patches that remain unassigned after the previous steps, and that have the [MsiPatchSequence](msipatchsequence-table.md) table, are put in the sequence before the first [minor upgrade](minor-upgrades.md) that has the MsiPatchSequence table, and after the .msi installation database and any patches without the MsiPatchSequence table.</span></span> <span data-ttu-id="b21b0-140">Установщик Windows удаляет небольшие исправления обновлений, неприменимые в данной последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-140">Windows Installer then eliminates any small update patches that are inapplicable in this sequence.</span></span>
8.  <span data-ttu-id="b21b0-141">Установщик Windows версии 3,0 устраняет замененные исправления из последовательности.</span><span class="sxs-lookup"><span data-stu-id="b21b0-141">Windows Installer version 3.0 eliminates superseded patches from the sequence.</span></span> <span data-ttu-id="b21b0-142">Когда исправление заменяет исправления, которые происходят ранее в последовательности исправлений, исправление содержит все исправления, описанные в предыдущих исправлениях.</span><span class="sxs-lookup"><span data-stu-id="b21b0-142">When a patch supersedes patches that occur earlier in the patch sequence, the patch contains all the fixes in the earlier patches.</span></span> <span data-ttu-id="b21b0-143">Более ранние исправления больше не требуются.</span><span class="sxs-lookup"><span data-stu-id="b21b0-143">The earlier patches are no longer required.</span></span> <span data-ttu-id="b21b0-144">Установщик Windows требуется информация в таблице [мсипатчсекуенце](msipatchsequence-table.md) для устранения замененных исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-144">The Windows Installer requires the information in the [MsiPatchSequence](msipatchsequence-table.md) table to eliminate superseded patches.</span></span>
    > [!Note]  
    > <span data-ttu-id="b21b0-145">Исправления, предназначенные для замены более раннего набора исправлений, должны быть созданы для замены предыдущих исправлений во всех семействах исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-145">Patches intended to supersede an earlier set of patches must be authored to supersede the earlier patches in all patch families.</span></span> <span data-ttu-id="b21b0-146">[Небольшие исправления обновления](small-updates.md) могут заменять только небольшие обновления.</span><span class="sxs-lookup"><span data-stu-id="b21b0-146">[Small update](small-updates.md) patches can only supersede small updates.</span></span> <span data-ttu-id="b21b0-147">[Незначительные](minor-upgrades.md) обновления могут заменять как небольшие, так и другие небольшие обновления.</span><span class="sxs-lookup"><span data-stu-id="b21b0-147">[Minor upgrades](minor-upgrades.md) can supersede both small updates and other minor upgrades.</span></span>

     

9.  <span data-ttu-id="b21b0-148">[Небольшие исправления обновления](small-updates.md) , которые содержат таблицы [мсипатчсекуенце](msipatchsequence-table.md) , последовательно передаются в версии продукта в соответствии с информацией о последовательности в таблицах мсипатчсекуенце.</span><span class="sxs-lookup"><span data-stu-id="b21b0-148">[Small update](small-updates.md) patches that carry [MsiPatchSequence](msipatchsequence-table.md) tables, get sequenced within product versions according to the sequencing information in their MsiPatchSequence tables.</span></span> <span data-ttu-id="b21b0-149">Это определяет окончательную последовательность исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-149">This determines the final patching sequence.</span></span>

<span data-ttu-id="b21b0-150">Исправление, которое больше не следует использовать, можно исключить из последовательности исправлений.</span><span class="sxs-lookup"><span data-stu-id="b21b0-150">A patch that should no longer be used can be eliminated from the patching sequence.</span></span> <span data-ttu-id="b21b0-151">Дополнительные сведения об устранении исправлений из последовательности исправлений см. в разделе [Устранение исправлений](eliminating-patches.md).</span><span class="sxs-lookup"><span data-stu-id="b21b0-151">For more information about how to eliminate patches from the patching sequence, see [Eliminating Patches](eliminating-patches.md).</span></span>

<span data-ttu-id="b21b0-152">Пример использования таблицы [мсипатчсекуенце](msipatchsequence-table.md) для применения исправлений в том порядке, в котором они созданы, см. в [примере с несколькими исправлениями](multiple-patching-example.md).</span><span class="sxs-lookup"><span data-stu-id="b21b0-152">For an example of how the [MsiPatchSequence](msipatchsequence-table.md) table can be used to apply patches in the order in which they are authored, see the [Multiple Patching Example](multiple-patching-example.md).</span></span>

 

 



