---
description: Ядро любого установщика — это фактическая установка файлов.
ms.assetid: e6f6d6a5-bdb0-4866-8d2c-56313d92c94c
title: Правила управления версиями файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 67c6f8e59b4f15774f898217690dbb1c4d57b1bf
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683090"
---
# <a name="file-versioning-rules"></a><span data-ttu-id="30f81-103">Правила управления версиями файлов</span><span class="sxs-lookup"><span data-stu-id="30f81-103">File Versioning Rules</span></span>

<span data-ttu-id="30f81-104">Ядро любого установщика — это фактическая установка файлов.</span><span class="sxs-lookup"><span data-stu-id="30f81-104">At the core of any installer is the actual installation of files.</span></span> <span data-ttu-id="30f81-105">Определение необходимости установки файла — сложный процесс.</span><span class="sxs-lookup"><span data-stu-id="30f81-105">Determining whether to install a file is a complex process.</span></span> <span data-ttu-id="30f81-106">На самом верхнем уровне это определение зависит от того, отмечен ли компонент, к которому относится файл, помечен для установки.</span><span class="sxs-lookup"><span data-stu-id="30f81-106">At the highest level, this determination depends on whether the component to which a file belongs is marked for installation.</span></span> <span data-ttu-id="30f81-107">После определения того, что файл должен быть скопирован, процесс усложняется, если в целевой папке существует другой файл с таким же именем.</span><span class="sxs-lookup"><span data-stu-id="30f81-107">Once determined that a file should be copied, the process is complicated if another file with the same name exists in the target folder.</span></span> <span data-ttu-id="30f81-108">В таких ситуациях для определения требуется набор правил, включающих следующие свойства:</span><span class="sxs-lookup"><span data-stu-id="30f81-108">In such situations, making the determination requires a set of rules involving the following properties:</span></span>

-   <span data-ttu-id="30f81-109">Версия</span><span class="sxs-lookup"><span data-stu-id="30f81-109">Version</span></span>
-   <span data-ttu-id="30f81-110">Дата</span><span class="sxs-lookup"><span data-stu-id="30f81-110">Date</span></span>
-   <span data-ttu-id="30f81-111">Язык</span><span class="sxs-lookup"><span data-stu-id="30f81-111">Language</span></span>

<span data-ttu-id="30f81-112">Установщик использует эти правила только при попытке установить файл в расположение, которое уже содержит файл с тем же именем.</span><span class="sxs-lookup"><span data-stu-id="30f81-112">The installer only uses these rules when trying to install a file to a location that already contains a file with the same name.</span></span> <span data-ttu-id="30f81-113">В этом случае установщик Windows использует следующие правила: все остальные элементы равны, чтобы определить, следует ли установить.</span><span class="sxs-lookup"><span data-stu-id="30f81-113">In this case, the Windows Installer uses the following rules, all other things being equal, to determine whether to install.</span></span>

<span data-ttu-id="30f81-114">Самая высокая версия — WINS — все остальные элементы равны, файл с самой высокой версией WINS, даже если файл на компьютере имеет самую новую версию.</span><span class="sxs-lookup"><span data-stu-id="30f81-114">Highest Version Wins—All other things being equal, the file with the highest version wins, even if the file on the computer has the highest version.</span></span>

<span data-ttu-id="30f81-115">Файлы с версиями Win — файл с версиями устанавливается поверх неверсии файла.</span><span class="sxs-lookup"><span data-stu-id="30f81-115">Versioned Files Win—A versioned file gets installed over a nonversioned file.</span></span>

<span data-ttu-id="30f81-116">Предпочтение языку продукта. Если устанавливаемый файл имеет язык, отличный от языка на компьютере, следует предпочитать файл с языком, соответствующим устанавливаемому продукту.</span><span class="sxs-lookup"><span data-stu-id="30f81-116">Favor Product Language—If the file being installed has a different language than the file on the computer, favor the file with the language that matches the product being installed.</span></span> <span data-ttu-id="30f81-117">Независимые от языка файлы обрабатываются как еще один язык, поэтому устанавливаемый продукт является предпочтительным.</span><span class="sxs-lookup"><span data-stu-id="30f81-117">Language-neutral files are treated as just another language so the product being installed is favored again.</span></span>

<span data-ttu-id="30f81-118">Несовпадение нескольких языков. После того, как разрабатываются все общие языки между устанавливаемым файлом и файлом на компьютере, все остальные языки используются в соответствии с тем, что требуется для установки продукта.</span><span class="sxs-lookup"><span data-stu-id="30f81-118">Mismatched Multiple Languages—After factoring out any common languages between the file being installed and the file on the computer, any remaining languages are favored according to what is needed by the product being installed.</span></span>

<span data-ttu-id="30f81-119">Сохранить языки надмножества — сохранить файл, поддерживающий несколько языков, независимо от того, находится ли он на компьютере или устанавливается.</span><span class="sxs-lookup"><span data-stu-id="30f81-119">Preserve Superset Languages—Preserve the file that supports multiple languages regardless of whether it is already on the computer or is being installed.</span></span>

<span data-ttu-id="30f81-120">Необновленные файлы — это пользовательские данные. Если дата изменения позже даты создания файла на компьютере, не следует устанавливать этот файл, так как пользовательские настройки будут удалены.</span><span class="sxs-lookup"><span data-stu-id="30f81-120">Nonversioned Files are User Data—If the Modified date is later than the Create date for the file on the computer, do not install the file because user customizations would be deleted.</span></span> <span data-ttu-id="30f81-121">Если измененные и созданные даты совпадают, установите файл.</span><span class="sxs-lookup"><span data-stu-id="30f81-121">If the Modified and Create dates are the same, install the file.</span></span> <span data-ttu-id="30f81-122">Если Дата создания позже измененной даты, файл считается неизмененным, а затем устанавливается файл.</span><span class="sxs-lookup"><span data-stu-id="30f81-122">If the Create date is later than the Modified date, the file is considered unmodified, install the file.</span></span>

<span data-ttu-id="30f81-123">Установка [вспомогательного файла](companion-files.md) зависит не от его собственных сведений о версиях файлов, но и от управления версиями его сопутствующего родителя.</span><span class="sxs-lookup"><span data-stu-id="30f81-123">The installation of a [Companion File](companion-files.md) depends not on its own file versioning information, but on the versioning of its companion parent.</span></span> <span data-ttu-id="30f81-124">В случае сопутствующих файлов установка пропускается только в том случае, если родительский файл имеет более позднюю версию.</span><span class="sxs-lookup"><span data-stu-id="30f81-124">In the case of Companion Files, the installation is skipped only if the parent file has a higher version.</span></span> <span data-ttu-id="30f81-125">Обратите внимание, что файл, который является ключевым путем для своего компонента, не должен быть сопутствующим файлом, так как в результате логика управления версиями файла пути к ключу определяется сопутствующим родительским файлом.</span><span class="sxs-lookup"><span data-stu-id="30f81-125">Note that a file that is the key path for its component must not be a companion file because this results in the versioning logic of the key path file being determined by the companion parent file.</span></span>

<span data-ttu-id="30f81-126">Неподдерживаемые файлы с использованием [сопутствующих файлов](companion-files.md)— неподдерживаемый файл, связанный с файлами с версиями с помощью сопровождающего механизма, соответствует правилам для файла с версией.</span><span class="sxs-lookup"><span data-stu-id="30f81-126">Nonversioned Files Using [Companion Files](companion-files.md)-A nonversioned file that is associated with a versioned file using the companion mechanism abides by the rules for the versioned file.</span></span> <span data-ttu-id="30f81-127">Единственным исключением является то, что файл с версией на компьютере и устанавливаемый файл с установленными версиями имеют одинаковую версию и язык, но сопутствующий файл отсутствует на компьютере.</span><span class="sxs-lookup"><span data-stu-id="30f81-127">The only exception is if the versioned file on the computer and the versioned file being installed have the same version and language but the companion file is missing on the computer.</span></span> <span data-ttu-id="30f81-128">В этом случае устанавливаемый вспомогательный файл используется несмотря на то, что используется файл с версией на компьютере.</span><span class="sxs-lookup"><span data-stu-id="30f81-128">In this case the companion file being installed is used even though the versioned file on the computer is used.</span></span> <span data-ttu-id="30f81-129">Кроме того, если свойство [**REINSTALLMODE**](reinstallmode.md) содержит параметры перезаписи старых версий ("o" или "e"), а версия сопутствующего файла совпадает с файлом, уже установленным на компьютере, устанавливается Необновленный файл с использованием сопутствующего файла.</span><span class="sxs-lookup"><span data-stu-id="30f81-129">Additionally, a nonversioned file using a companion file is installed if the [**REINSTALLMODE**](reinstallmode.md) property includes the overwrite older versions options ("o" or "e") and the companion file's version is equal to a file already on the machine.</span></span>

<span data-ttu-id="30f81-130">Правила являются глобальными — правила определения того, когда следует устанавливать файл, находятся в одном месте в установщике и являются глобальными, то есть они применяются ко всем файлам одинаково.</span><span class="sxs-lookup"><span data-stu-id="30f81-130">Rules are Global—The rules for determining when to install a file reside in one place within the installer and are global, meaning they apply to all files equally.</span></span>

<span data-ttu-id="30f81-131">Примеры форматов, используемых для версий файлов, см. в разделе Тип данных [версии](version.md) .</span><span class="sxs-lookup"><span data-stu-id="30f81-131">For examples of the format used for file versions, see the [Version](version.md) data type.</span></span> <span data-ttu-id="30f81-132">Дополнительные сведения см. в разделе [Замена существующих файлов](replacing-existing-files.md) или [Управление версиями файлов по умолчанию](default-file-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="30f81-132">For more specific information, see [Replacing Existing Files](replacing-existing-files.md) or [Default File Versioning](default-file-versioning.md).</span></span>

 

 



