---
description: Модуль слияния может быть применен к MSI-файлу для добавления каталогов в установку, но не может заменить или удалить существующие каталоги.
ms.assetid: 5b808aa2-b2b2-4703-bd57-0b5e1e73b306
title: Создание таблиц каталога для модуля слияния
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98332f2c0bda10a5cc076f0ec80df3bf4b2e05aa
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909075"
---
# <a name="authoring-merge-module-directory-tables"></a><span data-ttu-id="efa8e-103">Создание таблиц каталога для модуля слияния</span><span class="sxs-lookup"><span data-stu-id="efa8e-103">Authoring Merge Module Directory Tables</span></span>

<span data-ttu-id="efa8e-104">Модуль слияния может быть применен к MSI-файлу для добавления каталогов в установку, но не может заменить или удалить существующие каталоги.</span><span class="sxs-lookup"><span data-stu-id="efa8e-104">A merge module can be applied to an .msi file to add directories to the installation but it cannot replace or remove any existing directories.</span></span> <span data-ttu-id="efa8e-105">В [таблице Directory](directory-table.md) указывается структура каталогов, которые модуль слияния предоставляет для целевой установки.</span><span class="sxs-lookup"><span data-stu-id="efa8e-105">The [Directory table](directory-table.md) specifies the layout of the directories the merge module provides to the target installation.</span></span> <span data-ttu-id="efa8e-106">Таблица каталогов необходима в каждом модуле слияния.</span><span class="sxs-lookup"><span data-stu-id="efa8e-106">A Directory table is required in every merge module.</span></span>

<span data-ttu-id="efa8e-107">При создании таблицы Directory в модуле слияния следуйте приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="efa8e-107">Use the following guidelines when authoring the Directory Table in a merge module.</span></span> <span data-ttu-id="efa8e-108">Дополнительные сведения см. в разделе [Таблица каталогов](directory-table.md) и [Использование таблицы Directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="efa8e-108">For more information, see [Directory Table](directory-table.md) and [Using The Directory Table](using-the-directory-table.md).</span></span>

-   <span data-ttu-id="efa8e-109">Структура каталогов, добавленная модулем слияния, должна иметь один корневой каталог.</span><span class="sxs-lookup"><span data-stu-id="efa8e-109">The directory structure added by the merge module must have a single root directory.</span></span> <span data-ttu-id="efa8e-110">Корень должен иметь имя TARGETDIR.</span><span class="sxs-lookup"><span data-stu-id="efa8e-110">The root must be named TARGETDIR.</span></span> <span data-ttu-id="efa8e-111">Пользователь может изменить значение параметра TARGETDIR во время слияния, чтобы указать, куда присоединить структуру каталогов модуля к дереву каталогов целевого объекта.</span><span class="sxs-lookup"><span data-stu-id="efa8e-111">The user may change the value of TARGETDIR during the merge to specify where to attach the module's directory structure onto the target's directory tree.</span></span>
-   <span data-ttu-id="efa8e-112">Таблицы модулей слияния, отличные от таблицы каталога, не должны напрямую ссылаться на расположения каталогов для TARGETDIR.</span><span class="sxs-lookup"><span data-stu-id="efa8e-112">Merge module tables other than the Directory table must not directly reference directory locations to TARGETDIR.</span></span> <span data-ttu-id="efa8e-113">Расположение такой ссылки изменяется при изменении значения параметра TARGETDIR пользователем.</span><span class="sxs-lookup"><span data-stu-id="efa8e-113">The location of such a reference changes if the value of TARGETDIR is changed by the user.</span></span>
-   <span data-ttu-id="efa8e-114">Таблицы в модуле слияния должны ссылаться на расположение дочернего каталога TARGETDIR или другого каталога в дереве модуля слияния.</span><span class="sxs-lookup"><span data-stu-id="efa8e-114">The tables in the merge module must reference the location of a child directory of TARGETDIR, or another directory in the merge module's tree.</span></span> <span data-ttu-id="efa8e-115">Выполните следующие действия, чтобы указать TARGETDIR в качестве родителя каталога в модуле слияния.</span><span class="sxs-lookup"><span data-stu-id="efa8e-115">Do the following to specify TARGETDIR as the parent of a directory in the merge module.</span></span> <span data-ttu-id="efa8e-116">Введите каталог в столбец Directory и введите TARGETDIR в \_ родительский столбец каталога.</span><span class="sxs-lookup"><span data-stu-id="efa8e-116">Enter the directory into the Directory column and enter TARGETDIR into the Directory\_Parent column.</span></span> <span data-ttu-id="efa8e-117">Используйте нотацию "." в столбце Дефаултдир, чтобы указать, что этот каталог расположен в TARGETDIR без подкаталога.</span><span class="sxs-lookup"><span data-stu-id="efa8e-117">Use the "." notation in the DefaultDir column to indicate that this directory is located in TARGETDIR without a subdirectory.</span></span> <span data-ttu-id="efa8e-118">Дополнительные сведения см. [в разделе Использование таблицы Directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="efa8e-118">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
-   <span data-ttu-id="efa8e-119">Имена каталогов, добавляемых модулем слияния, должны использовать соглашения об именовании, описанные в разделе [именование первичных ключей в базах данных модулей слияния](naming-primary-keys-in-merge-module-databases.md).</span><span class="sxs-lookup"><span data-stu-id="efa8e-119">The names of directories added by the merge module must use the naming conventions described in [Naming Primary Keys in Merge Module Databases](naming-primary-keys-in-merge-module-databases.md).</span></span> <span data-ttu-id="efa8e-120">К ним относятся каталоги, предопределенные свойствами, такими как свойство [**системфолдер**](systemfolder.md) и свойство [**ProgramFilesFolder**](programfilesfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="efa8e-120">This includes directories predefined by properties such as the [**SystemFolder**](systemfolder.md) property and [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span>
-   <span data-ttu-id="efa8e-121">Добавьте [*идентификатор GUID*](g-gly.md) для каждой записи в таблице Directory (за исключением TARGETDIR.) Сюда входят записи таблицы каталогов, указывающие установщик Windows свойства [**системфолдер**](systemfolder.md) , например системфолдер. 00000000 0000 0000 0000 \_ \_ \_ \_ 000000000000.</span><span class="sxs-lookup"><span data-stu-id="efa8e-121">Append a [*GUID*](g-gly.md) to every entry in the Directory table (except TARGETDIR.) This includes Directory table entries that specify Windows Installer [**SystemFolder**](systemfolder.md) properties, for example, SystemFolder.00000000\_0000\_0000\_0000\_000000000000.</span></span> <span data-ttu-id="efa8e-122">Mergemod.dll библиотеки добавляет настраиваемые действия для задания свойства **системфолдер** .</span><span class="sxs-lookup"><span data-stu-id="efa8e-122">The library Mergemod.dll adds custom actions to set the **SystemFolder** property.</span></span>
-   <span data-ttu-id="efa8e-123">При включении предопределенного каталога в модуль слияния средство слияния автоматически добавляет в целевую базу данных [Пользовательский тип действия 51](custom-action-type-51.md) .</span><span class="sxs-lookup"><span data-stu-id="efa8e-123">When a predefined directory is included in a merge module, the merge tool automatically adds a [Custom Action Type 51](custom-action-type-51.md) to the target database.</span></span> <span data-ttu-id="efa8e-124">Автор модуля слияния должен убедиться, что [Таблица CustomAction](customaction-table.md) также включена.</span><span class="sxs-lookup"><span data-stu-id="efa8e-124">The merge module author must ensure that a [CustomAction table](customaction-table.md) is also included.</span></span> <span data-ttu-id="efa8e-125">Таблица CustomAction может быть пустой, но эта таблица должна существовать в целевой базе данных и гарантировать, что измененные стандартные каталоги записываются в правильные расположения.</span><span class="sxs-lookup"><span data-stu-id="efa8e-125">The CustomAction table may be empty, but this table is required to exist in the target database and ensures that the modified predefined directories are written to the correct locations.</span></span> <span data-ttu-id="efa8e-126">Например, если системный каталог включен в модуль слияния, автор модуля слияния должен убедиться в существовании пользовательской таблицы действий.</span><span class="sxs-lookup"><span data-stu-id="efa8e-126">For example, when a system directory is included in a merge module, the merge module author must ensure that a Custom Action table exists.</span></span>

    <span data-ttu-id="efa8e-127">Обратите внимание, что алгоритм сопоставления для создания следующих настраиваемых действий типа 51 проверяет, что имя каталога начинается с одного из предопределенных свойств [**системфолдер**](systemfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="efa8e-127">Note that the matching algorithm for the generation of these type 51 custom actions only checks that the directory name begins with one of the predefined [**SystemFolder**](systemfolder.md) properties.</span></span> <span data-ttu-id="efa8e-128">Он не проверяет, совпадает ли имя каталога со свойством каталога.</span><span class="sxs-lookup"><span data-stu-id="efa8e-128">It does not verify that the directory name exactly equals the directory property.</span></span> <span data-ttu-id="efa8e-129">Любой каталог, начинающийся с одного из этих стандартных имен папок, получает настраиваемое действие типа 51, даже если остальная часть имени не является идентификатором GUID.</span><span class="sxs-lookup"><span data-stu-id="efa8e-129">Any directory beginning with one of these standard folder names gets a type 51 custom action, even if the rest of the name is not a GUID.</span></span> <span data-ttu-id="efa8e-130">Авторы должны соблюдать осторожность, чтобы это не создавало ложных положительных совпадений и непредвиденное создание настраиваемых действий в производных первичных ключах, начинающихся с одного из свойств **системфолдер** .</span><span class="sxs-lookup"><span data-stu-id="efa8e-130">Authors need to take care that this does not generate false positive matches, and unintended custom action generation, on derivative primary keys that begin with one of the **SystemFolder** properties.</span></span>

<span data-ttu-id="efa8e-131">Ниже приведен пример таблицы каталога в модуле слияния и ожидаемых разрешенных каталогов.</span><span class="sxs-lookup"><span data-stu-id="efa8e-131">The following is an example of a Directory table in a merge module and the expected resolved directories.</span></span>



| <span data-ttu-id="efa8e-132">Каталог</span><span class="sxs-lookup"><span data-stu-id="efa8e-132">Directory</span></span>                                              | <span data-ttu-id="efa8e-133">\_Родительский каталог</span><span class="sxs-lookup"><span data-stu-id="efa8e-133">Directory\_Parent</span></span>                                | <span data-ttu-id="efa8e-134">дефаултдир</span><span class="sxs-lookup"><span data-stu-id="efa8e-134">DefaultDir</span></span>  |
|--------------------------------------------------------|--------------------------------------------------|-------------|
| <span data-ttu-id="efa8e-135">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="efa8e-135">TARGETDIR</span></span>                                              |                                                  | <span data-ttu-id="efa8e-136">SourceDir</span><span class="sxs-lookup"><span data-stu-id="efa8e-136">SourceDir</span></span>   |
| <span data-ttu-id="efa8e-137">Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-137">Dir00.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="efa8e-138">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="efa8e-138">TARGETDIR</span></span>                                        | <span data-ttu-id="efa8e-139">.: MMM \_ PROG</span><span class="sxs-lookup"><span data-stu-id="efa8e-139">.:MMM\_Prog</span></span> |
| <span data-ttu-id="efa8e-140">Системфолдер. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-140">SystemFolder.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span> | <span data-ttu-id="efa8e-141">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="efa8e-141">TARGETDIR</span></span>                                        | <span data-ttu-id="efa8e-142">Ммм \_ sys</span><span class="sxs-lookup"><span data-stu-id="efa8e-142">MMM\_Sys</span></span>    |
| <span data-ttu-id="efa8e-143">Dir02. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-143">Dir02.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="efa8e-144">Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848 \_ 006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-144">Dir00.BC82E350\_ C7FC\_11d1\_ A848\_006097ABDE17</span></span> | <span data-ttu-id="efa8e-145">OCX для MFC \_</span><span class="sxs-lookup"><span data-stu-id="efa8e-145">MFC\_OCX</span></span>    |



 

<span data-ttu-id="efa8e-146">Предполагается, что модуль слияния с указанной выше таблицей каталогов будет иметь следующую структуру каталогов.</span><span class="sxs-lookup"><span data-stu-id="efa8e-146">A merge module with the above Directory table is expected to result in the following directory structure.</span></span>



| <span data-ttu-id="efa8e-147">Каталог</span><span class="sxs-lookup"><span data-stu-id="efa8e-147">Directory</span></span>                                              | <span data-ttu-id="efa8e-148">Целевой объект</span><span class="sxs-lookup"><span data-stu-id="efa8e-148">Target</span></span>                                     | <span data-ttu-id="efa8e-149">Источник</span><span class="sxs-lookup"><span data-stu-id="efa8e-149">Source</span></span>                                               |
|--------------------------------------------------------|--------------------------------------------|------------------------------------------------------|
| <span data-ttu-id="efa8e-150">Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-150">Dir00.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="efa8e-151">\[Точка установки модуля слияния\]</span><span class="sxs-lookup"><span data-stu-id="efa8e-151">\[Merge Module's Install Point\]</span></span>\\         | <span data-ttu-id="efa8e-152">\[Исходная точка модуля слияния — \] \\ \_ PROG</span><span class="sxs-lookup"><span data-stu-id="efa8e-152">\[Merge Module's Source Point\]\\MMM\_Prog</span></span>           |
| <span data-ttu-id="efa8e-153">Системфолдер. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-153">SystemFolder.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span> | <span data-ttu-id="efa8e-154">\[системфолдер\]</span><span class="sxs-lookup"><span data-stu-id="efa8e-154">\[SystemFolder\]</span></span>\\                         | <span data-ttu-id="efa8e-155">\[Исходная точка модуля слияния ( \] \\ МММ) \_ sys</span><span class="sxs-lookup"><span data-stu-id="efa8e-155">\[Merge Module's Source Point\]\\MMM\_Sys</span></span>            |
| <span data-ttu-id="efa8e-156">Dir02. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="efa8e-156">Dir02.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="efa8e-157">\[\] \\ Библиотека OCX для точки установки модуля \_ слияния</span><span class="sxs-lookup"><span data-stu-id="efa8e-157">\[Merge Module's Install Point\]\\MFC\_OCX</span></span> | <span data-ttu-id="efa8e-158">\[Исходная точка модуля слияния, модуль \] \\ MMM для \_ \\ MFC \_ OCX</span><span class="sxs-lookup"><span data-stu-id="efa8e-158">\[Merge Module's Source Point\]\\MMM\_Prog\\MFC\_OCX</span></span> |



 

 

 



