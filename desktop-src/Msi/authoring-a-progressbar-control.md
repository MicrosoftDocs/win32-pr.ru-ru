---
description: Установщик Windows содержит функциональные возможности для отображения индикатора хода выполнения в диалоговом окне отображения действий.
ms.assetid: cfc2d974-4f2d-4f52-9835-eab1dc091c9b
title: Создание элемента управления ProgressBar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b872ed2dd36fb8ed04ee48fd69e4680fce002a18
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909076"
---
# <a name="authoring-a-progressbar-control"></a><span data-ttu-id="3bae4-103">Создание элемента управления ProgressBar</span><span class="sxs-lookup"><span data-stu-id="3bae4-103">Authoring a ProgressBar Control</span></span>

<span data-ttu-id="3bae4-104">Установщик Windows содержит функциональные возможности для отображения индикатора хода выполнения в диалоговом окне отображения действий.</span><span class="sxs-lookup"><span data-stu-id="3bae4-104">Windows Installer contains functionality to display a progress indicator in an action display dialog.</span></span> <span data-ttu-id="3bae4-105">[Элемент управления ProgressBar](progressbar-control.md) графически представляет установку отдельных компонентов и сообщает либо общее время, прошедшее относительно оставшегося времени, либо приблизительное общее время, оставшееся до завершения установки.</span><span class="sxs-lookup"><span data-stu-id="3bae4-105">The [ProgressBar control](progressbar-control.md) graphically represents the installation of individual components and reports either the total time elapsed relative to time remaining or the approximate total time remaining until the installation is complete.</span></span>

<span data-ttu-id="3bae4-106">Чтобы определить общее время, ожидаемое для установки, установщик отслеживает общее число тактов хода выполнения, ожидаемое каждым действием во время создания скрипта выполнения.</span><span class="sxs-lookup"><span data-stu-id="3bae4-106">To determine the total time anticipated for the installation, the installer tracks the total progress ticks anticipated by each action during generation of the execution script.</span></span> <span data-ttu-id="3bae4-107">После завершения создания скрипта будет сохранена сумма хода выполнения и начинается установка.</span><span class="sxs-lookup"><span data-stu-id="3bae4-107">When script generation is complete, the progress tick total is stored and the installation begins.</span></span>

<span data-ttu-id="3bae4-108">Сообщения о ходе выполнения, описывающие прошедшее количество тактов прогресса, отправляются в активный обработчик сообщений по мере выполнения каждого действия в скрипте.</span><span class="sxs-lookup"><span data-stu-id="3bae4-108">Progress messages detailing the elapsed number of progress ticks are sent to the active message handler as each action in the script is executed.</span></span> <span data-ttu-id="3bae4-109">При каждом сообщении о ходе выполнения установщик передает сообщение [Сетпрогресс таблице ControlEvent событие](setprogress-controlevent.md) в текущее активное диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="3bae4-109">On each progress message, the installer broadcasts a [SetProgress ControlEvent](setprogress-controlevent.md) to the currently active dialog box.</span></span> <span data-ttu-id="3bae4-110">Последовательность пользовательского интерфейса должна быть создана для создания диалогового окна "Отображение действия" во время выполнения скрипта для получения сообщений таблице ControlEvent событие Сетпрогресс из установщика.</span><span class="sxs-lookup"><span data-stu-id="3bae4-110">The UI sequence should be authored to create the action display dialog box during script execution to receive the SetProgress ControlEvent messages from the installer.</span></span>

<span data-ttu-id="3bae4-111">Когда диалоговое окно "Отображение действия" получает Сетпрогресс таблице ControlEvent событие, оно проверяет [таблицу таблица eventmapping](eventmapping-table.md) на наличие элементов управления, подписавшихся на таблице ControlEvent событие.</span><span class="sxs-lookup"><span data-stu-id="3bae4-111">When the action display dialog box receives a SetProgress ControlEvent, it checks the [EventMapping table](eventmapping-table.md) for any controls subscribing to the ControlEvent.</span></span> <span data-ttu-id="3bae4-112">Элемент управления ProgressBar в диалоговом окне "Отображение действия" подписывается на атрибут управления ходом выполнения, указанный в столбце атрибуты.</span><span class="sxs-lookup"><span data-stu-id="3bae4-112">The ProgressBar control on the action display dialog box is subscribed to with the Progress control attribute specified in the Attributes column.</span></span> <span data-ttu-id="3bae4-113">Атрибут управления progress указывает, что элемент управления ProgressBar будет передавать значения "Тиккссофар" и "Тоталтиккс" вместе с Сетпрогресс таблице ControlEvent событие.</span><span class="sxs-lookup"><span data-stu-id="3bae4-113">The Progress Control attribute specifies that the ProgressBar control will be passed "ticksSoFar" and "totalTicks" values along with the SetProgress ControlEvent.</span></span> <span data-ttu-id="3bae4-114">Элемент управления "индикатор выполнения" использует эти сведения, чтобы переместить графическую линию слева направо для установки и справа налево для выполнения операции [отката](rollback-installation.md) .</span><span class="sxs-lookup"><span data-stu-id="3bae4-114">The progress bar control uses this information to advance the graphical bar from left to right for an installation and from right to left for a [rollback](rollback-installation.md) operation.</span></span>

<span data-ttu-id="3bae4-115">Кроме того, установщик выполняет широковещательную рассылку [TimeRemaining таблице ControlEvent событие](timeremaining-controlevent.md) для каждого сообщения о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="3bae4-115">In addition, the installer broadcasts a [TimeRemaining ControlEvent](timeremaining-controlevent.md) on each progress message.</span></span> <span data-ttu-id="3bae4-116">Общее время, оставшееся для установки, определяется первым расчетом частоты выполнения. это общее число тактов, проделенное на общее время, прошедшее с момента начала установки.</span><span class="sxs-lookup"><span data-stu-id="3bae4-116">The total time remaining for the installation is determined by first calculating the execution rate, which is the total number of ticks elapsed divided by the total time since the installation began.</span></span> <span data-ttu-id="3bae4-117">Общее количество тактов, деленное на скорость выполнения, дает приблизительное оставшееся время.</span><span class="sxs-lookup"><span data-stu-id="3bae4-117">The total ticks remaining divided by the execution rate gives the approximate time remaining.</span></span>

<span data-ttu-id="3bae4-118">Когда диалоговое окно "Отображение действия" получает TimeRemaining таблице ControlEvent событие, оно снова ищет в таблице таблица eventmapping все элементы управления, на которые оформлена подписка.</span><span class="sxs-lookup"><span data-stu-id="3bae4-118">When the action display dialog box receives the TimeRemaining ControlEvent, it again looks in the EventMapping table for any controls that are subscribed.</span></span> <span data-ttu-id="3bae4-119">Чтобы отобразить оставшееся время, [элемент управления "текст](text-control.md) " должен быть подписан на TimeRemaining таблице ControlEvent событие с помощью [атрибута элемента управления TimeRemaining](timeremaining-control-attribute.md) , указанного в столбце Attributes.</span><span class="sxs-lookup"><span data-stu-id="3bae4-119">In order to display the time remaining, a [Text control](text-control.md) must be subscribed to the TimeRemaining ControlEvent with the [TimeRemaining control attribute](timeremaining-control-attribute.md) specified in the Attributes column.</span></span>

<span data-ttu-id="3bae4-120">Элемент управления "подписанный текст" запрашивает [таблицу уитекст](uitext-table.md) для параметризованной строки шаблона с именем "TimeRemaining".</span><span class="sxs-lookup"><span data-stu-id="3bae4-120">The subscribed Text control queries the [UIText table](uitext-table.md) for a parameterized template string named "TimeRemaining".</span></span> <span data-ttu-id="3bae4-121">Эта строка имеет два параметра: \[ 1 \] для минут и \[ 2 \] для секунд.</span><span class="sxs-lookup"><span data-stu-id="3bae4-121">This string has two parameters, \[1\] for minutes, and \[2\] for seconds.</span></span> <span data-ttu-id="3bae4-122">Элемент управления "текст" преобразует каждое значение в минуты и секунды, вычисляет строку шаблона TimeRemaining и обновляет элемент управления "текст" новыми данными.</span><span class="sxs-lookup"><span data-stu-id="3bae4-122">The Text control converts each value to minutes and seconds, evaluates the TimeRemaining template string, and updates the text control with the new information.</span></span>

<span data-ttu-id="3bae4-123">Если уровень отображения пользовательского интерфейса имеет значение базовый или ниже, то установщик отображает диалоговое окно по умолчанию, содержащее индикатор выполнения и текстовое поле TimeRemaining.</span><span class="sxs-lookup"><span data-stu-id="3bae4-123">If the UI display level is set to basic or lower, the installer displays a default dialog box containing a progress bar and TimeRemaining text field.</span></span> <span data-ttu-id="3bae4-124">Дополнительные сведения см. в разделе [уровни пользовательского интерфейса](user-interface-levels.md).</span><span class="sxs-lookup"><span data-stu-id="3bae4-124">For more information, see [User Interface Levels](user-interface-levels.md).</span></span>

 

 



