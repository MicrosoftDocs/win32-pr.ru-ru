---
description: Возможность установщик Windows устанавливать разрешения доступа к службам, файлам, созданным папкам и записям реестра может помочь в обеспечении безопасности приложений установки.
ms.assetid: a25fcecf-f15f-4772-8f41-d03864484cc9
title: Защита ресурсов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 415fe7b2df343a54aa0819031f4fd22b05857618
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105650850"
---
# <a name="securing-resources"></a><span data-ttu-id="ce79c-103">Защита ресурсов</span><span class="sxs-lookup"><span data-stu-id="ce79c-103">Securing Resources</span></span>

<span data-ttu-id="ce79c-104">Возможность установщик Windows устанавливать разрешения доступа к службам, файлам, созданным папкам и записям реестра может помочь в обеспечении безопасности приложений установки.</span><span class="sxs-lookup"><span data-stu-id="ce79c-104">The capability of the Windows Installer to set access permissions on services, files, created folders, and registry entries can help make installation applications more secure.</span></span> <span data-ttu-id="ce79c-105">Использование таблиц [мсилоккпермиссионсекс](msilockpermissionsex-table.md) или [локкпермиссионс](lockpermissions-table.md) для защиты ресурсов является одним из рекомендуемых [рекомендаций по созданию безопасных установок](guidelines-for-authoring-secure-installations.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-105">The use of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) or [LockPermissions](lockpermissions-table.md) tables to secure resources is one of the recommended [Guidelines for Authoring Secure Installations](guidelines-for-authoring-secure-installations.md).</span></span> <span data-ttu-id="ce79c-106">Таблица Мсилоккпермиссионсекс может позволить автору пакета защитить ресурс без необходимости написания [настраиваемого действия](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-106">The MsiLockPermissionsEx table can enable a package author to secure a resource without having to write a [custom action](custom-actions.md).</span></span>

<span data-ttu-id="ce79c-107">Начиная с пакетов, разработанных для установщик Windows 5,0, таблица [мсилоккпермиссионсекс](msilockpermissionsex-table.md) должна заменить использование таблицы [локкпермиссионс](lockpermissions-table.md) .</span><span class="sxs-lookup"><span data-stu-id="ce79c-107">Beginning with packages developed for Windows Installer 5.0, the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table should replace the use of the [LockPermissions](lockpermissions-table.md) table.</span></span> <span data-ttu-id="ce79c-108">Расширенные функциональные возможности, предоставляемые таблицей Мсилоккпермиссионсекс, позволяют пакету защищать [службы](../services/services.md)Windows, файлы, папки и разделы реестра.</span><span class="sxs-lookup"><span data-stu-id="ce79c-108">The extended functionality provided by the MsiLockPermissionsEx table enables a package to secure Windows [Services](../services/services.md), files, folders, and registry keys.</span></span> <span data-ttu-id="ce79c-109">Пакет не должен содержать таблицы Мсилоккпермиссионсекс и Локкпермиссионс.</span><span class="sxs-lookup"><span data-stu-id="ce79c-109">A package should not contain both the MsiLockPermissionsEx and the LockPermissions tables.</span></span>

<span data-ttu-id="ce79c-110">Установщик Windows 4,5 и более ранних версий игнорирует [таблицу мсилоккпермиссионсекс](msilockpermissionsex-table.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-110">Windows Installer 4.5 and earlier ignores the [MsiLockPermissionsEx table](msilockpermissionsex-table.md).</span></span> <span data-ttu-id="ce79c-111">Начиная с установщик Windows 5,0, установка завершается с сообщением об ошибке 1941, если пакет содержит как [таблицу локкпермиссионс](lockpermissions-table.md) , так и таблицу мсилоккпермиссионсекс.</span><span class="sxs-lookup"><span data-stu-id="ce79c-111">Beginning with Windows Installer 5.0, the installation fails with an error message 1941 if the package contains both a [LockPermissions table](lockpermissions-table.md) and MsiLockPermissionsEx table.</span></span> <span data-ttu-id="ce79c-112">Существующие пакеты установки, содержащие только таблицу Локкпермиссионс, можно по-прежнему устанавливать с помощью установщик Windows 5,0.</span><span class="sxs-lookup"><span data-stu-id="ce79c-112">Existing installation packages that contain only the LockPermissions table can be still be installed using Windows Installer 5.0.</span></span>

<span data-ttu-id="ce79c-113">Установщик Windows 5,0 обрабатывает данные в таблице [мсилоккпермиссионсекс](msilockpermissionsex-table.md) при выполнении стандартных действий [инсталлфилес](installfiles-action.md), [инсталлсервицес](installservices-action.md), [вритерегистривалуес](writeregistryvalues-action.md) и [креатефолдерс](createfolders-action.md) .</span><span class="sxs-lookup"><span data-stu-id="ce79c-113">Windows Installer 5.0 processes the information in the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table when it runs the [InstallFiles](installfiles-action.md), [InstallServices](installservices-action.md), [WriteRegistryValues](writeregistryvalues-action.md) and [CreateFolders](createfolders-action.md) standard actions.</span></span> <span data-ttu-id="ce79c-114">Защищаемый объект должен быть установлен или переустановлен для защиты, поэтому невозможно добавить [список управления доступом](../secauthz/access-control-lists.md) (ACL) к существующему объекту без переустановки этого объекта.</span><span class="sxs-lookup"><span data-stu-id="ce79c-114">A securable object must be installed or reinstalled to be secured and it is not possible to append an [Access Control List](../secauthz/access-control-lists.md) (ACL) to an existing object without reinstalling that object.</span></span>

<span data-ttu-id="ce79c-115">Чтобы указать службу, файл, каталог или раздел реестра, который должен быть защищен, введите идентификационные данные в поля LockObject и table таблицы [мсилоккпермиссионсекс](msilockpermissionsex-table.md) .</span><span class="sxs-lookup"><span data-stu-id="ce79c-115">To specify the service, file, directory, or registry key that is to be secured, enter the identifying information in the LockObject and Table fields of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table.</span></span> <span data-ttu-id="ce79c-116">Объект идентифицируется по первичному ключу в [таблице сервицеинсталл](serviceinstall-table.md), [таблице файлов](file-table.md), [таблице реестра](registry-table.md)или [таблице креатефолдер](createfolder-table.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-116">An object is identified by it's primary key in the [ServiceInstall Table](serviceinstall-table.md), [File Table](file-table.md), [Registry Table](registry-table.md), or [CreateFolder Table](createfolder-table.md).</span></span>

<span data-ttu-id="ce79c-117">Чтобы запросить, чтобы указанные разрешения применялись к объекту, введите допустимую строку дескриптора безопасности в поле *сддлтекст* таблицы [мсилоккпермиссионсекс](msilockpermissionsex-table.md) , используя допустимый [язык определения дескрипторов безопасности](../secauthz/security-descriptor-definition-language.md) (SDDL).</span><span class="sxs-lookup"><span data-stu-id="ce79c-117">To request that specified permissions apply to an object, enter a valid security descriptor string in the *SDDLText* field of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table using valid [security descriptor definition language](../secauthz/security-descriptor-definition-language.md) (SDDL).</span></span> <span data-ttu-id="ce79c-118">В таблице **мсилоккпермиссионсекс** можно указать дескриптор безопасности, который запрещает разрешения, задает наследование разрешений от родительского ресурса или указывает разрешения новой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="ce79c-118">The **MsiLockPermissionsEx** table can specify a security descriptor that denies permissions, specifies inheritance of permissions from a parent resource, or specifies the permissions of a new account.</span></span> <span data-ttu-id="ce79c-119">Список всех разрешений, которые могут быть предоставлены, запрещены или унаследованы, см. в разделе [строки ACE](../secauthz/ace-strings.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-119">For a list of all the permissions that can be granted, denied, or inherited see [ACE Strings](../secauthz/ace-strings.md).</span></span> <span data-ttu-id="ce79c-120">Установщик Windows 5,0 расширяет набор доступных идентификаторов безопасности (SID). Список допустимых идентификаторов безопасности см. в разделе [строки идентификатора безопасности](../secauthz/sid-strings.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-120">Windows Installer 5.0 extends the set of available security identifiers (SIDs.) For a list of the valid SIDs, see [SID Strings](../secauthz/sid-strings.md).</span></span>

> [!NOTE]
> <span data-ttu-id="ce79c-121">Если вы хотите настроить дескриптор безопасности родительского ресурса, чтобы указать, что его разрешения наследуются дочерними объектами, установщик должен применить разрешения к родительскому ресурсу перед созданием дочерних объектов.</span><span class="sxs-lookup"><span data-stu-id="ce79c-121">If you want to configure the security descriptor of a parent resource to specify that that its permissions be inherited by child objects, your installer must apply permissions to the parent resource before it creates the child objects.</span></span> <span data-ttu-id="ce79c-122">Если установщик создает дочерние объекты до того, как он применяет наследуемые разрешения к родительскому ресурсу, разрешения родительского ресурса не будут распространяться на дочерние объекты.</span><span class="sxs-lookup"><span data-stu-id="ce79c-122">If your installer creates the child objects before it applies the inheritable permissions to the parent resource, the permissions of the parent resource will not propagate to the child objects.</span></span>

<span data-ttu-id="ce79c-123">Начиная с установщик Windows 5,0, тип данных [форматтедсддлтекст](formattedsddltext.md) расширяет [форматированный](formatted.md) тип данных.</span><span class="sxs-lookup"><span data-stu-id="ce79c-123">Beginning with Windows Installer 5.0, the [FormattedSDDLText](formattedsddltext.md) data type extends the [Formatted](formatted.md) data type.</span></span> <span data-ttu-id="ce79c-124">Установщик Windows проверяет, что строка Форматтедсддлтекст, заданная в столбце Сддлтекст таблицы [мсилоккпермиссионсекс](msilockpermissionsex-table.md) , соответствует [формату строки дескриптора безопасности](../secauthz/security-descriptor-string-format.md).</span><span class="sxs-lookup"><span data-stu-id="ce79c-124">The Windows Installer validates that the FormattedSDDLText string entered in the SDDLText column of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table conforms to the [Security Descriptor String Format](../secauthz/security-descriptor-string-format.md).</span></span>

<span data-ttu-id="ce79c-125">**[Установщик Windows 4,5 или более ранней версии](not-supported-in-windows-installer-4-5.md):** Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="ce79c-125">**[Windows Installer 4.5 or earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span> <span data-ttu-id="ce79c-126">Таблица [мсилоккпермиссионсекс](msilockpermissionsex-table.md) и тип данных [форматтедсддлтекст](formattedsddltext.md) доступны начиная с установщик Windows 5,0.</span><span class="sxs-lookup"><span data-stu-id="ce79c-126">The [MsiLockPermissionsEx](msilockpermissionsex-table.md) table and [FormattedSDDLText](formattedsddltext.md) data type are available beginning with Windows Installer 5.0.</span></span>

 

 
