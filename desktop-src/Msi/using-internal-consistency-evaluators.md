---
description: Для проверки базы данных используйте специальное средство проверки, чтобы объединить CUB-файл, содержащий внутренние средства оценки согласованности (ICEs), в базу данных, выполнить ICEs и сообщить о результатах.
ms.assetid: bdf38673-ee3d-47d8-ad6e-562cd5626918
title: Использование внутренних средств оценки согласованности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423e6dab453ae495dc6029b54eb039c8acc60f33
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673303"
---
# <a name="using-internal-consistency-evaluators"></a><span data-ttu-id="3aec3-103">Использование внутренних средств оценки согласованности</span><span class="sxs-lookup"><span data-stu-id="3aec3-103">Using Internal Consistency Evaluators</span></span>

<span data-ttu-id="3aec3-104">Для проверки базы данных используйте специальное средство проверки, чтобы объединить CUB-файл, содержащий внутренние средства [оценки согласованности](internal-consistency-evaluators-ices.md) (ICES), в базу данных, выполнить ICEs и сообщить о результатах.</span><span class="sxs-lookup"><span data-stu-id="3aec3-104">To validate a database, use a special validation tool to merge a .cub file containing the [Internal Consistency Evaluators](internal-consistency-evaluators-ices.md) (ICEs) into your database, execute the ICEs, and report the results.</span></span> <span data-ttu-id="3aec3-105">Некоторые средства предоставляются в пакете средств разработки программного обеспечения (SDK) для Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="3aec3-105">Several such tools are provided in the Microsoft Windows Software Development Kit (SDK).</span></span> <span data-ttu-id="3aec3-106">В средах разработки от сторонних поставщиков также можно включить систему проверки ICE в свою среду разработки.</span><span class="sxs-lookup"><span data-stu-id="3aec3-106">Authoring environments from third-party vendors also may incorporate the ICE validation system into their authoring environment.</span></span> <span data-ttu-id="3aec3-107">Также можно написать собственное средство для выполнения проверки на ICE.</span><span class="sxs-lookup"><span data-stu-id="3aec3-107">It is also possible to write your own tool to perform ICE validation.</span></span> <span data-ttu-id="3aec3-108">Большинство средств проверки ICE объединяют CUB-файл и базу данных в третью временную базу данных.</span><span class="sxs-lookup"><span data-stu-id="3aec3-108">Most ICE validation tools merge the .cub file and your database into a third, temporary database.</span></span> <span data-ttu-id="3aec3-109">Установщик Windows отображаются предупреждения, ошибки, отладочные сведения и ошибки API, так как они выполняют каждую ICE в файле. cub.</span><span class="sxs-lookup"><span data-stu-id="3aec3-109">Windows Installer displays warnings, errors, debugging information, and API errors as it executes each ICE in the .cub file.</span></span> <span data-ttu-id="3aec3-110">Когда установщик завершает выполнение ICEs, он закрывает MSI файл,. cub и временную базу данных без сохранения изменений.</span><span class="sxs-lookup"><span data-stu-id="3aec3-110">When the installer finishes executing the ICEs it closes the .msi file, .cub file, and temporary database without saving any changes.</span></span> <span data-ttu-id="3aec3-111">MSI-файл и CUB-файл остаются неизменными при проверке.</span><span class="sxs-lookup"><span data-stu-id="3aec3-111">The .msi file and .cub file remain unchanged by the validation test.</span></span>

<span data-ttu-id="3aec3-112">Пользовательские действия ICE обмениваются данными с пользователем, вызывая [**мсипроцессмессаже**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) и публикуя \_ сообщение пользователя инсталлмессаже.</span><span class="sxs-lookup"><span data-stu-id="3aec3-112">ICE custom actions communicate to the user by calling [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) and posting an INSTALLMESSAGE\_USER message.</span></span> <span data-ttu-id="3aec3-113">Сообщение КОМПИЛЯТОРА обычно возвращает следующую информацию:</span><span class="sxs-lookup"><span data-stu-id="3aec3-113">An ICE message commonly returns information such as the following:</span></span>

-   <span data-ttu-id="3aec3-114">Имя ICE, которое обнаружило ошибку</span><span class="sxs-lookup"><span data-stu-id="3aec3-114">Name of the ICE that has found an error</span></span>
-   <span data-ttu-id="3aec3-115">Дата создания ICE</span><span class="sxs-lookup"><span data-stu-id="3aec3-115">Date the ICE was created</span></span>
-   <span data-ttu-id="3aec3-116">Автор ICE</span><span class="sxs-lookup"><span data-stu-id="3aec3-116">Author of the ICE</span></span>
-   <span data-ttu-id="3aec3-117">Дата последнего изменения ICE.</span><span class="sxs-lookup"><span data-stu-id="3aec3-117">Date the ICE was last modified.</span></span>
-   <span data-ttu-id="3aec3-118">Описание ошибки API, вызвавшей сбой ICE</span><span class="sxs-lookup"><span data-stu-id="3aec3-118">Description of the API error causing the ICE to fail</span></span>
-   <span data-ttu-id="3aec3-119">Описание ошибки</span><span class="sxs-lookup"><span data-stu-id="3aec3-119">Description of the error</span></span>
-   <span data-ttu-id="3aec3-120">Предупреждение для пользователя</span><span class="sxs-lookup"><span data-stu-id="3aec3-120">A warning to the user</span></span>
-   <span data-ttu-id="3aec3-121">Имя таблицы базы данных, содержащей ошибку или предупреждение</span><span class="sxs-lookup"><span data-stu-id="3aec3-121">Name of the database table containing the error or warning</span></span>
-   <span data-ttu-id="3aec3-122">Имя столбца таблицы, содержащего ошибку или предупреждение</span><span class="sxs-lookup"><span data-stu-id="3aec3-122">Name of the table column containing the error or warning</span></span>
-   <span data-ttu-id="3aec3-123">Первичные ключи таблицы, содержащей ошибку или предупреждение</span><span class="sxs-lookup"><span data-stu-id="3aec3-123">Primary keys of the table containing the error or warning</span></span>
-   <span data-ttu-id="3aec3-124">URL-адрес для HTML-файла, предоставляющего предложения по отладке</span><span class="sxs-lookup"><span data-stu-id="3aec3-124">A URL to a HTML file giving debugging suggestions</span></span>
-   <span data-ttu-id="3aec3-125">Строка, которая может содержать другие сведения</span><span class="sxs-lookup"><span data-stu-id="3aec3-125">A string that can contain other information</span></span>

<span data-ttu-id="3aec3-126">Авторы пакетов установки могут создавать пользовательские действия ICE или использовать стандартный набор ICEs, включенный в файлы. CUB, поставляемые вместе с пакетом SDK.</span><span class="sxs-lookup"><span data-stu-id="3aec3-126">Authors of installation packages can write ICE custom actions or use the standard set of ICEs included in the .cub files provided with the SDK.</span></span> <span data-ttu-id="3aec3-127">Дополнительные сведения о написании ICE см. в разделе [создание внутренней сборки](building-an-ice.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-127">For more information on how to write an ICE, see [Building an ICE](building-an-ice.md).</span></span>

<span data-ttu-id="3aec3-128">После написания соответствующего значения ICEs для проверки разработчик должен объединить пользовательские действия в базу данных. msi, которая называется CUB-файлом, который содержит только ICEs и их обязательные таблицы.</span><span class="sxs-lookup"><span data-stu-id="3aec3-128">After writing the appropriate ICEs for validation, a developer must collect the custom actions together into an .msi database, called a .cub file, that contains only the ICEs and their required tables.</span></span> <span data-ttu-id="3aec3-129">Невозможно установить CUB-файл, который используется только для хранения и предоставления доступа к настраиваемым действиям ICE.</span><span class="sxs-lookup"><span data-stu-id="3aec3-129">A .cub file cannot be installed and is used only to store and provide access to ICE custom actions.</span></span> <span data-ttu-id="3aec3-130">Дополнительные сведения о создании файлов. cub см. в разделе [Создание базы данных Ice](building-an-ice-database.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-130">For more information on making .cub files, see [Building an ICE Database](building-an-ice-database.md).</span></span> <span data-ttu-id="3aec3-131">Кроме того, разработчики могут проверить свой пакет установки, используя существующее значение ICEs, описанное в [справочнике по Ice](ice-reference.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-131">Alternatively, developers can validate their installation package using the existing ICEs described in [ICE Reference](ice-reference.md).</span></span> <span data-ttu-id="3aec3-132">Эти данные по стандарту ICEs можно получить из файлов Standard. CUB, поставляемых с пакетом SDK.</span><span class="sxs-lookup"><span data-stu-id="3aec3-132">These ICEs can be obtained from standard .cub files provided with the SDK.</span></span>

<span data-ttu-id="3aec3-133">Установка редактора таблиц базы данных Orca или средства проверки msival2 предоставляет файлы Logo. CUB, Дарице. cub и Мержемод. cub.</span><span class="sxs-lookup"><span data-stu-id="3aec3-133">The installation of the database table editor Orca or the validation tool msival2 provides the Logo.cub, Darice.cub, and Mergemod.cub files.</span></span> <span data-ttu-id="3aec3-134">Набор ICEs в файле Logo. cub является подмножеством файлов в файле Дарице. cub.</span><span class="sxs-lookup"><span data-stu-id="3aec3-134">The set of ICEs in the Logo.cub file is a subset of those in the Darice.cub file.</span></span> <span data-ttu-id="3aec3-135">Если пакет проходит проверку с помощью Дарице. CUB, он передается с Logo. cub.</span><span class="sxs-lookup"><span data-stu-id="3aec3-135">If your package passes validation using Darice.cub, it will pass with Logo.cub.</span></span> <span data-ttu-id="3aec3-136">Мержемод. cub содержит набор ICEs, используемый для проверки модулей слияния.</span><span class="sxs-lookup"><span data-stu-id="3aec3-136">Mergemod.cub contains a set of ICEs used to validate merge modules.</span></span> <span data-ttu-id="3aec3-137">Дополнительные сведения см. в разделе [Справочник по модулю слияния](merge-module-ice-reference.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-137">For more information, see [Merge Module ICE Reference](merge-module-ice-reference.md).</span></span>

<span data-ttu-id="3aec3-138">**Проверка пакета установки**</span><span class="sxs-lookup"><span data-stu-id="3aec3-138">**To validate an installation package**</span></span>

1.  <span data-ttu-id="3aec3-139">Получите или создайте соответствующие пользовательские действия ICE.</span><span class="sxs-lookup"><span data-stu-id="3aec3-139">Obtain or author the appropriate ICE custom actions.</span></span> <span data-ttu-id="3aec3-140">Вы можете использовать одно или несколько существующих единиц с использованием класса ICEs, описанных в [справочнике по Ice](ice-reference.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-140">You may be able to use one or more of the existing ICEs described in the [ICE Reference](ice-reference.md).</span></span> <span data-ttu-id="3aec3-141">Если для проверки требуется, чтобы она еще не наступила в этом списке, можно создать новый объект ICE, как описано в разделе [создание внутренней сборки](building-an-ice.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-141">If your validation requires an ICE not yet in this list, you can create a new ICE as described in [Building an ICE](building-an-ice.md).</span></span>
2.  <span data-ttu-id="3aec3-142">Подготовьте базу данных ICE, содержащую все пользовательские действия ICE.</span><span class="sxs-lookup"><span data-stu-id="3aec3-142">Prepare an ICE Database containing all the ICE custom actions.</span></span> <span data-ttu-id="3aec3-143">Сведения о подготовке файла. cub см. в разделе [Создание базы данных Ice](building-an-ice-database.md) .</span><span class="sxs-lookup"><span data-stu-id="3aec3-143">See the section [Building An ICE Database](building-an-ice-database.md) for information about preparing a .cub file.</span></span>
3.  <span data-ttu-id="3aec3-144">Предоставьте файл. cub и MSI-файл средству проверки пакетов, например [Orca.exe](orca-exe.md) или [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-144">Provide the .cub file and the .msi file to a package validation tool such as [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span>

<span data-ttu-id="3aec3-145">Обратите внимание, что модули слияния должны быть проверены, как описано в разделе [Проверка модулей слияния](validating-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="3aec3-145">Note that merge modules should be validated as described in [Validating Merge Modules](validating-merge-modules.md).</span></span>

 

 



