---
description: Instmsi.exe является распространяемым пакетом для установки установщик Windows&\# 160; 2.0 и более ранних версий установщик Windows. См. установщик Windows распространяемые пакеты для распространяемых компонентов для установщик Windows&\# 160; 3.0 и более поздних версий.
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105684236"
---
# <a name="instmsiexe"></a><span data-ttu-id="9ff66-104">Instmsi.exe</span><span class="sxs-lookup"><span data-stu-id="9ff66-104">Instmsi.exe</span></span>

<span data-ttu-id="9ff66-105">Instmsi.exe — это распространяемый пакет для установки установщик Windows 2,0 и более ранних версий установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="9ff66-105">Instmsi.exe is the redistributable package for installing Windows Installer 2.0, and earlier versions of Windows Installer.</span></span> <span data-ttu-id="9ff66-106">См. [установщик Windows распространяемых](windows-installer-redistributables.md) компонентов для распространяемых компонентов для установщик Windows 3,0 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="9ff66-106">See [Windows Installer Redistributables](windows-installer-redistributables.md) for the redistributables for Windows Installer 3.0 and later versions.</span></span>

<span data-ttu-id="9ff66-107">Дополнительные сведения о версии установщик Windows, поставляемой с операционной системой, см. в разделе [выпущенные версии установщик Windows](released-versions-of-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="9ff66-107">For more information about which version of the Windows Installer was shipped with your operating system, see [Released Versions of Windows Installer](released-versions-of-windows-installer.md).</span></span>

<span data-ttu-id="9ff66-108">Некоторые распространяемые пакеты не следует запускать в определенных версиях операционной системы.</span><span class="sxs-lookup"><span data-stu-id="9ff66-108">Some redistributables should not be run on certain versions of the operating system.</span></span> <span data-ttu-id="9ff66-109">В следующей таблице описывается, какие Инстмси совместимы с операционной системой.</span><span class="sxs-lookup"><span data-stu-id="9ff66-109">The following table describes which Instmsi is compatible on which operating system.</span></span>



| <span data-ttu-id="9ff66-110">Если Instmsi.exe устанавливает эту версию установщик Windows</span><span class="sxs-lookup"><span data-stu-id="9ff66-110">If Instmsi.exe installs this version of the Windows Installer</span></span> | <span data-ttu-id="9ff66-111">Instmsi.exe может выполняться в этих операционных системах</span><span class="sxs-lookup"><span data-stu-id="9ff66-111">Instmsi.exe can be run on these operating systems</span></span>                    | <span data-ttu-id="9ff66-112">Instmsi.exe не должны выполняться в этих операционных системах</span><span class="sxs-lookup"><span data-stu-id="9ff66-112">Instmsi.exe must not be run on these operating systems</span></span>                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ff66-113">Установщик Windows версии 1,0</span><span class="sxs-lookup"><span data-stu-id="9ff66-113">Windows Installer version 1.0</span></span>                                 | <span data-ttu-id="9ff66-114">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="9ff66-114">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="9ff66-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="9ff66-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="9ff66-116">Установщик Windows версии 1,1</span><span class="sxs-lookup"><span data-stu-id="9ff66-116">Windows Installer version 1.1</span></span>                                 | <span data-ttu-id="9ff66-117">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="9ff66-117">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="9ff66-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="9ff66-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="9ff66-119">Установщик Windows версии 1,2</span><span class="sxs-lookup"><span data-stu-id="9ff66-119">Windows Installer version 1.2</span></span>                                 | <span data-ttu-id="9ff66-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="9ff66-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP3</span></span>               | <span data-ttu-id="9ff66-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="9ff66-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>             |
| <span data-ttu-id="9ff66-122">Установщик Windows версии 2,0</span><span class="sxs-lookup"><span data-stu-id="9ff66-122">Windows Installer version 2.0</span></span>                                 | <span data-ttu-id="9ff66-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0 + SP6, Windows 2000</span><span class="sxs-lookup"><span data-stu-id="9ff66-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP6, Windows 2000</span></span> | <span data-ttu-id="9ff66-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="9ff66-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>                           |



 

<span data-ttu-id="9ff66-125">Например, приложение, которое повторно распространяет установщик Windows версии 1,1, должно проверить, является ли операционная система Windows NT 4,0 SP3 или Windows 98/95 перед запуском распространяемого пакета.</span><span class="sxs-lookup"><span data-stu-id="9ff66-125">For example, an application that redistributes Windows Installer version 1.1 should check that the operating system is Windows NT 4.0 SP3 or Windows 98/95 before running the redistributable package.</span></span> <span data-ttu-id="9ff66-126">Приложения, использующие распространяемый пакет, также гарантируют, что версия ANSI установщик Windows установлена в Windows 98/95 и установлена ли версия Юникода в Windows NT или Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="9ff66-126">Applications using the redistributable package should also ensure that the ANSI version of the Windows Installer is installed on Windows 98/95, and that the Unicode version is installed on Windows NT or Windows 2000.</span></span> <span data-ttu-id="9ff66-127">Обратите внимание, что некоторые приложения переименованы версию Юникода в Инстмсив.</span><span class="sxs-lookup"><span data-stu-id="9ff66-127">Note that some applications rename the Unicode version to InstMsiW.</span></span>

## <a name="syntax"></a><span data-ttu-id="9ff66-128">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="9ff66-128">Syntax</span></span>

<span data-ttu-id="9ff66-129"> *Параметры* инстмси</span><span class="sxs-lookup"><span data-stu-id="9ff66-129">**instmsi** *options*</span></span>

## <a name="command-line-options"></a><span data-ttu-id="9ff66-130">Параметры командной строки</span><span class="sxs-lookup"><span data-stu-id="9ff66-130">Command Line Options</span></span>

<span data-ttu-id="9ff66-131">Параметры командной строки не учитывают регистр.</span><span class="sxs-lookup"><span data-stu-id="9ff66-131">The command line options are case-insensitive.</span></span>



| <span data-ttu-id="9ff66-132">Параметр</span><span class="sxs-lookup"><span data-stu-id="9ff66-132">Option</span></span>                     | <span data-ttu-id="9ff66-133">Описание</span><span class="sxs-lookup"><span data-stu-id="9ff66-133">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ff66-134">/q</span><span class="sxs-lookup"><span data-stu-id="9ff66-134">/q</span></span>                         | <span data-ttu-id="9ff66-135">Для использования приложениями, которые распространяют установщик Windows в составе приложения начальной загрузки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-135">For use by applications that redistribute the Windows Installer as part of a bootstrapping application.</span></span> <span data-ttu-id="9ff66-136">Пользователь не видит пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9ff66-136">No UI is presented to the user.</span></span> <span data-ttu-id="9ff66-137">Приложение начальной загрузки должно проверить код возврата, чтобы определить, требуется ли перезагрузка для завершения установки установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="9ff66-137">The bootstrapping application should check the return code to determine whether a reboot is needed to complete the installation of the Windows Installer.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="9ff66-138">/t</span><span class="sxs-lookup"><span data-stu-id="9ff66-138">/t</span></span>                         | <span data-ttu-id="9ff66-139">Используется только в целях отладки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-139">Used for debugging purposes only.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="9ff66-140">/c: "мсиинст/делайребут"</span><span class="sxs-lookup"><span data-stu-id="9ff66-140">/c:"msiinst /delayreboot"</span></span>  | <span data-ttu-id="9ff66-141">Параметр отложенной перезагрузки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-141">The delayed reboot option.</span></span> <span data-ttu-id="9ff66-142">Не позволяет Инстмси запрашивать у пользователя перезагрузку, даже если ей пришлось заменить файлы, которые использовались во время установки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-142">Prevents Instmsi from prompting the user for a reboot even if it had to replace files that were in use during the installation.</span></span> <span data-ttu-id="9ff66-143">Если Инстмси вызывается с этим параметром, то при необходимости \_ \_ \_ замены файлов, которые использовались, требуется перезагрузка после успешного выполнения.</span><span class="sxs-lookup"><span data-stu-id="9ff66-143">If Instmsi is invoked with this option, it returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if it had to replace files that were in use.</span></span> <span data-ttu-id="9ff66-144">Если не нужно заменять файлы, которые использовались, он возвращает ошибку \_ успешно.</span><span class="sxs-lookup"><span data-stu-id="9ff66-144">If it did not have to replace files that were in use, it returns ERROR\_SUCCESS.</span></span> <span data-ttu-id="9ff66-145">Доступно в Инстмси для установщик Windows 2,0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="9ff66-145">Available with Instmsi for Windows Installer  2.0 or later.</span></span> <span data-ttu-id="9ff66-146">Дополнительные сведения о отложенных перезагрузках см. в разделе "Примечания".</span><span class="sxs-lookup"><span data-stu-id="9ff66-146">See the remarks section for additional information on delayed reboots.</span></span><br/> |
| <span data-ttu-id="9ff66-147">/c: "мсиинст/делайребутк"</span><span class="sxs-lookup"><span data-stu-id="9ff66-147">/c:"msiinst /delayrebootq"</span></span> | <span data-ttu-id="9ff66-148">Скрытая версия параметра отложенной перезагрузки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-148">The quiet version of the delayed reboot option.</span></span> <span data-ttu-id="9ff66-149">Он не предоставляет пользователю пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9ff66-149">It does not present any UI to the user.</span></span> <span data-ttu-id="9ff66-150">В противном случае поведение идентично предыдущему параметру.</span><span class="sxs-lookup"><span data-stu-id="9ff66-150">Otherwise the behavior is identical to the previous option.</span></span> <span data-ttu-id="9ff66-151">Доступно в Инстмси для установщик Windows 2,0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="9ff66-151">Available with Instmsi for Windows Installer 2.0 or later.</span></span> <span data-ttu-id="9ff66-152">Дополнительные сведения о отложенных перезагрузках см. в разделе "Примечания".</span><span class="sxs-lookup"><span data-stu-id="9ff66-152">See the remarks section for additional information on delayed reboots.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="9ff66-153">/?</span><span class="sxs-lookup"><span data-stu-id="9ff66-153">/?</span></span>                         | <span data-ttu-id="9ff66-154">Вывод справки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-154">Displays help.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a><span data-ttu-id="9ff66-155">Комментарии</span><span class="sxs-lookup"><span data-stu-id="9ff66-155">Remarks</span></span>

<span data-ttu-id="9ff66-156">[Начальная](bootstrapping.md) Загрузка приложений, использующих Instmsi.exe для установки установщик Windows с другим приложением, может потребовать дополнительной перезагрузки системы.</span><span class="sxs-lookup"><span data-stu-id="9ff66-156">[Bootstrapping](bootstrapping.md) applications that use Instmsi.exe to install the Windows Installer with another application may require an extra system reboot.</span></span> <span data-ttu-id="9ff66-157">В дополнение к перезагрузкам, необходимым для установки приложения, это может привести к дополнительной перезагрузке.</span><span class="sxs-lookup"><span data-stu-id="9ff66-157">This is potentially an extra reboot in addition to any reboots that are needed to install the application.</span></span>

<span data-ttu-id="9ff66-158">Параметр отложенной перезагрузки рекомендуется использовать только для разработчиков, которые хотят устранить дополнительную перезагрузку, вызванную использованием Instmsi.exe с приложением установки, устанавливающим файлы, которые используются.</span><span class="sxs-lookup"><span data-stu-id="9ff66-158">The delayed reboot option is only recommended for setup developers who want to eliminate an extra reboot caused by using Instmsi.exe with a setup application that installs files that are in use.</span></span>

<span data-ttu-id="9ff66-159">Разработчики должны выполнить следующие действия в приложении установки, чтобы использовать параметр отложенной перезагрузки.</span><span class="sxs-lookup"><span data-stu-id="9ff66-159">Developers should do the following in their setup application to use the delayed reboot option.</span></span> <span data-ttu-id="9ff66-160">Этот параметр недоступен в Instmsi.exe версиях, в которых установлены версии установщика Windows, предшествующие версии 2,0:</span><span class="sxs-lookup"><span data-stu-id="9ff66-160">This option is not available with Instmsi.exe versions that install Window Installer versions earlier than version 2.0:</span></span>

<span data-ttu-id="9ff66-161">**Использование параметра отложенной перезагрузки**</span><span class="sxs-lookup"><span data-stu-id="9ff66-161">**To use the delayed reboot option**</span></span>

1.  <span data-ttu-id="9ff66-162">Вызовите Instmsi.exe с помощью одной из параметров командной строки с отложенной перезагрузкой.</span><span class="sxs-lookup"><span data-stu-id="9ff66-162">Call Instmsi.exe with one of the delayed reboot command line options.</span></span>
2.  <span data-ttu-id="9ff66-163">Обработайте возвращенные ошибки \_ или успешную \_ \_ перезагрузку при успешном выполнении \_ , так как это означает успешное выполнение.</span><span class="sxs-lookup"><span data-stu-id="9ff66-163">Treat the return of either ERROR\_SUCCESS or ERROR\_SUCCESS\_REBOOT\_REQUIRED as meaning success.</span></span>
3.  <span data-ttu-id="9ff66-164">Получите путь к папке, содержащей недавно установленные установщик Windows двоичные файлы, из значения Инсталлерлокатион в разделе:</span><span class="sxs-lookup"><span data-stu-id="9ff66-164">Get the path to the folder containing the newly installed Windows Installer binaries from the InstallerLocation value under:</span></span>

    <span data-ttu-id="9ff66-165">**HKey \_ \_** \\  \\  \\  \\  \\ **Программа установки** Microsoft Windows CurrentVersion по на локальном компьютере</span><span class="sxs-lookup"><span data-stu-id="9ff66-165">**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Installer**</span></span>

    <span data-ttu-id="9ff66-166">Это значение имеет тип **reg \_ SZ**.</span><span class="sxs-lookup"><span data-stu-id="9ff66-166">This value is of type **REG\_SZ**.</span></span>

4.  <span data-ttu-id="9ff66-167">Задайте в качестве текущего каталога путь, полученный на шаге 3.</span><span class="sxs-lookup"><span data-stu-id="9ff66-167">Set the current directory to the path obtained in step 3.</span></span>
5.  <span data-ttu-id="9ff66-168">Вызов msiexec в пакете приложения и выполнение другого кода установки, относящегося к приложению.</span><span class="sxs-lookup"><span data-stu-id="9ff66-168">Invoke Msiexec on the application's package and run other setup code specific to the application.</span></span> <span data-ttu-id="9ff66-169">Если приложение установки использует [**мсиинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), приложение должно загрузить MSI.DLL из расположения, полученного на шаге 3.</span><span class="sxs-lookup"><span data-stu-id="9ff66-169">If the setup application uses [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), then the application must load MSI.DLL from the location obtained in step 3.</span></span>
    > [!Note]  
    > <span data-ttu-id="9ff66-170">Приложения, вызывающие **LoadLibrary** для нового MSI.DLL в расположении, полученном на шаге 3, должны убедиться в том, что более старая версия MSI.DLL еще не загружена в процессе.</span><span class="sxs-lookup"><span data-stu-id="9ff66-170">Applications that call **LoadLibrary** on the new MSI.DLL in the location obtained in step 3 must ensure that an older version of MSI.DLL has not already been loaded within the process.</span></span> <span data-ttu-id="9ff66-171">Если в процессе была загружена более старая версия MSI.DLL, ее необходимо выгрузить из адресного пространства процесса до вызова **LoadLibrary** для нового MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="9ff66-171">If an older version of MSI.DLL was loaded within the process, it must be unloaded from the process address space prior to the **LoadLibrary** call for the new MSI.DLL.</span></span>

     

6.  <span data-ttu-id="9ff66-172">Если шаг (5) не требует перезагрузки, а если \_ в шаге (1) была возвращена ошибка успешная \_ перезагрузка Instmsi.exe \_ , то пользователю предлагается перезагрузить компьютер для завершения установки двоичных файлов установщик Windows в системе.</span><span class="sxs-lookup"><span data-stu-id="9ff66-172">If step (5) does not require a reboot and if Instmsi.exe had returned ERROR\_SUCCESS\_REBOOT\_REQUIRED in step (1), prompt the user for a reboot to complete the setup of the Windows Installer binaries on the system.</span></span> <span data-ttu-id="9ff66-173">Однако если в шаге (5) происходит перезагрузка, никаких дополнительных действий не требуется.</span><span class="sxs-lookup"><span data-stu-id="9ff66-173">However, if a reboot occurs in step (5), no additional steps are required.</span></span>

<span data-ttu-id="9ff66-174">Instmsi.exe доступен в [Windows SDK компонентах для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="9ff66-174">Instmsi.exe is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="9ff66-175">См. также</span><span class="sxs-lookup"><span data-stu-id="9ff66-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9ff66-176">Начальной загрузки</span><span class="sxs-lookup"><span data-stu-id="9ff66-176">Bootstrapping</span></span>](bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="9ff66-177">Начальная загрузка со скачиванием из Интернета</span><span class="sxs-lookup"><span data-stu-id="9ff66-177">Internet Download Bootstrapping</span></span>](internet-download-bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="9ff66-178">Выпущенные версии, средства и распространяемые пакеты</span><span class="sxs-lookup"><span data-stu-id="9ff66-178">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> <dt>

[<span data-ttu-id="9ff66-179">Средства разработки установщик Windows</span><span class="sxs-lookup"><span data-stu-id="9ff66-179">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> </dl>

 

 




