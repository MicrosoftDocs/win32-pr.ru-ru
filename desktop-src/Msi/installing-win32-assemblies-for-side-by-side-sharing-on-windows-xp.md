---
description: Ниже описано, как создать пакет установщик Windows для установки сборки Win32.
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: Установка сборок Win32 для параллельного совместного доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea72c9bcb7bd85ac38dfc8857030d6b9d6afbf23
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105684356"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a><span data-ttu-id="16fda-103">Установка сборок Win32 для параллельного совместного доступа</span><span class="sxs-lookup"><span data-stu-id="16fda-103">Installing Win32 Assemblies for Side-by-Side Sharing</span></span>

<span data-ttu-id="16fda-104">Ниже описано, как создать пакет установщик Windows для установки сборки Win32.</span><span class="sxs-lookup"><span data-stu-id="16fda-104">The following describes how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="16fda-105">Пакет устанавливает параллельную сборку в папку WinSxS для общего использования приложения.</span><span class="sxs-lookup"><span data-stu-id="16fda-105">The package installs a side-by-side assembly in the Winsxs folder for the shared use of the application.</span></span> <span data-ttu-id="16fda-106">После установки пакета общая сборка становится доступной глобально для любого приложения, которое определяет зависимость от сборки в файле манифеста сборки.</span><span class="sxs-lookup"><span data-stu-id="16fda-106">After installing the package, the shared assembly is globally available to any application that specifies a dependence on the assembly in an assembly manifest file.</span></span> <span data-ttu-id="16fda-107">Установщик не выполняет глобальную регистрацию параллельной сборки в системе.</span><span class="sxs-lookup"><span data-stu-id="16fda-107">The installer does not globally register the side-by-side assembly on the system.</span></span>

<span data-ttu-id="16fda-108">Обратите внимание, что вы можете установить общие параллельные сборки с помощью [модулей слияния](merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-108">Note that you may install shared side-by-side assemblies using [merge modules](merge-modules.md).</span></span>

<span data-ttu-id="16fda-109">Прежде чем продолжить, необходимо понять, как создать пакет установщик Windows без сборок.</span><span class="sxs-lookup"><span data-stu-id="16fda-109">Before continuing you should understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="16fda-110">Пример создания простой установки см. [в примере установки](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-110">For an example of how to author a simple installation, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="16fda-111">**Параллельная установка общей сборки**</span><span class="sxs-lookup"><span data-stu-id="16fda-111">**To install a shared assembly side-by-side**</span></span>

1.  <span data-ttu-id="16fda-112">Определите компонент установщик Windows, включающий сборку Win32.</span><span class="sxs-lookup"><span data-stu-id="16fda-112">Define a Windows Installer component that includes the Win32 assembly.</span></span> <span data-ttu-id="16fda-113">Этот компонент может содержать другие ресурсы, которые всегда должны устанавливаться или удаляться вместе со сборкой.</span><span class="sxs-lookup"><span data-stu-id="16fda-113">This component may contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="16fda-114">Все остальные компоненты приложения могут быть созданы так же, как и для установки без сборок.</span><span class="sxs-lookup"><span data-stu-id="16fda-114">All the other components of the application can be authored just as for an installation without assemblies.</span></span> <span data-ttu-id="16fda-115">Добавьте строку в [таблицу Component](component-table.md) для компонента, содержащего сборку Win32.</span><span class="sxs-lookup"><span data-stu-id="16fda-115">Add a row to the [Component table](component-table.md) for the component containing the Win32 assembly.</span></span> <span data-ttu-id="16fda-116">Введите допустимый установщик Windows [GUID](guid.md) для этого кода компонента.</span><span class="sxs-lookup"><span data-stu-id="16fda-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="16fda-117">Не используйте файл манифеста в качестве пути к ключу для этого компонента.</span><span class="sxs-lookup"><span data-stu-id="16fda-117">Do not use the manifest file as the key path for this component.</span></span>
2.  <span data-ttu-id="16fda-118">Добавьте строку в [таблицу феатурекомпонентс](featurecomponents-table.md) для привязки компонента к установщик Windows функции.</span><span class="sxs-lookup"><span data-stu-id="16fda-118">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="16fda-119">Дополнительные сведения см. в разделе [компоненты и компоненты](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-119">For information see, [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="16fda-120">Установщик Windows функция должна быть частью функциональных возможностей приложения, распознаваемых пользователем.</span><span class="sxs-lookup"><span data-stu-id="16fda-120">A Windows Installer feature should be a piece of the application's functionality that is recognizable to a user.</span></span> <span data-ttu-id="16fda-121">Сборка активируется, когда эта функция выбрана пользователем или произошла ошибка в приложении.</span><span class="sxs-lookup"><span data-stu-id="16fda-121">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="16fda-122">Если сборка определяет дополнительную функцию, добавьте дополнительную строку в [таблицу функций](feature-table.md) для атрибутов компонента.</span><span class="sxs-lookup"><span data-stu-id="16fda-122">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature's attributes.</span></span> <span data-ttu-id="16fda-123">Этот шаг не требуется при создании модуля слияния.</span><span class="sxs-lookup"><span data-stu-id="16fda-123">This step is not needed when authoring a merge module.</span></span>
3.  <span data-ttu-id="16fda-124">Для параллельных сборок, сведений о привязке и активации, таких как классы COM, интерфейсы и библиотеки типов, хранятся в файлах манифеста, а не в реестре.</span><span class="sxs-lookup"><span data-stu-id="16fda-124">For side-by-side assemblies, binding and activation information, such as COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="16fda-125">Общие сборки хранят эти сведения в манифесте сборки.</span><span class="sxs-lookup"><span data-stu-id="16fda-125">Shared assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="16fda-126">В системах, поддерживающих параллельные сборки, установщик пропускает обработку любых сведений о компоненте, который был задан в [таблице расширения](extension-table.md), [таблице команд](verb-table.md), [таблице typelib](typelib-table.md), [таблице MIME](mime-table.md), [таблице классов](class-table.md), таблице кодов [ProgID](progid-table.md)и [таблице AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-126">On systems that support side-by-side assemblies, the installer skips processing any information about the component entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="16fda-127">Сведения о привязке и активации могут быть указаны в этих таблицах для использования в системах, которые не поддерживают совместное использование сборок параллельно.</span><span class="sxs-lookup"><span data-stu-id="16fda-127">Binding and activation information may be entered into these tables for use by systems that do not support side-by-side assembly sharing.</span></span>
4.  <span data-ttu-id="16fda-128">Параллельная установка не регистрирует глобально сборку. установщик пропускает ее, если в [таблицу селфрег](selfreg-table.md)введены какие-либо сведения о собственной регистрации.</span><span class="sxs-lookup"><span data-stu-id="16fda-128">Side-by-side installation does not globally register the assembly, the installer skips self-registering the component if any self-registration information has been entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="16fda-129">Сведения о самостоятельной регистрации можно указать в таблице Селфрег для самостоятельной регистрации компонента в системах, которые не поддерживают совместное использование сборок параллельно.</span><span class="sxs-lookup"><span data-stu-id="16fda-129">Self-registration information may be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
5.  <span data-ttu-id="16fda-130">Добавьте любые другие сведения о реестре, за исключением привязки и активации, или самостоятельной регистрации компонента в [таблице реестра](registry-table.md), [таблице Ремоверегистри](removeregistry-table.md)и [таблице окружения](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-130">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
6.  <span data-ttu-id="16fda-131">Так как это общая сборка, не создает локальный файл.</span><span class="sxs-lookup"><span data-stu-id="16fda-131">Because this is a shared assembly do not generate a .local file.</span></span> <span data-ttu-id="16fda-132">Не включайте сведения для этого компонента в [таблицу исолатедкомпонент](isolatedcomponent-table.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-132">Do not include information for this component in the [IsolatedComponent table](isolatedcomponent-table.md).</span></span> <span data-ttu-id="16fda-133">Установщик пропускает таблицу Исолатедкомпонент для этого компонента в операционных системах, поддерживающих совместное использование.</span><span class="sxs-lookup"><span data-stu-id="16fda-133">The installer skips the IsolatedComponent table for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="16fda-134">Добавьте сведения в таблицу Исолатедкомпонент, если хотите, чтобы сборка была закрыта в системах, поддерживающих локальные файлы.</span><span class="sxs-lookup"><span data-stu-id="16fda-134">Add information to the IsolatedComponent table if you would like the assembly to be private on systems that support .local files.</span></span>
7.  <span data-ttu-id="16fda-135">Чтобы обеспечить параллельный общий доступ, сборка Win32 должна быть установлена в папку WinSxS.</span><span class="sxs-lookup"><span data-stu-id="16fda-135">To enable side-by-side sharing, the Win32 assembly must be installed into the Winsxs folder.</span></span> <span data-ttu-id="16fda-136">Это достигается за счет того, что \_ для сборки остается столбец Application File в [таблице мсиассембли](msiassembly-table.md) со значением NULL.</span><span class="sxs-lookup"><span data-stu-id="16fda-136">This is accomplished by leaving the File\_Application column of the [MsiAssembly table](msiassembly-table.md) null for the assembly.</span></span> <span data-ttu-id="16fda-137">Это указывает установщику установить сборку в папку WinSxS, а не в папку компонента.</span><span class="sxs-lookup"><span data-stu-id="16fda-137">This tells the installer to install the assembly to the WinSxS folder, instead of to the folder of the component.</span></span> <span data-ttu-id="16fda-138">Добавьте строку в [таблицу мсиассембли](msiassembly-table.md) для компонента, содержащего сборку Win32.</span><span class="sxs-lookup"><span data-stu-id="16fda-138">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="16fda-139">Введите значение 1 в поле Attributes таблицы Мсиассембли, чтобы указать, что это сборка Win32.</span><span class="sxs-lookup"><span data-stu-id="16fda-139">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="16fda-140">Для общей сборки оставьте \_ поле приложение файла пустым.</span><span class="sxs-lookup"><span data-stu-id="16fda-140">For a shared assembly, leave the File\_Application field empty.</span></span> <span data-ttu-id="16fda-141">Добавьте [действие мсипублишассемблиес](msipublishassemblies-action.md) в [таблицу Инсталлексекутесекуенце](installexecutesequence-table.md) или [таблицу адвтексекутесекуенце](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-141">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="16fda-142">Добавьте [действие мсиунпублишассемблиес](msiunpublishassemblies-action.md) в таблицу инсталлексекутесекуенце.</span><span class="sxs-lookup"><span data-stu-id="16fda-142">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span>
8.  <span data-ttu-id="16fda-143">Добавьте строки в [таблицу мсиассемблинаме](msiassemblyname-table.md) для компонента.</span><span class="sxs-lookup"><span data-stu-id="16fda-143">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="16fda-144">Добавьте по одной строке для каждой пары "имя — значение", указанной в разделе "assemblyIdentity" манифеста.</span><span class="sxs-lookup"><span data-stu-id="16fda-144">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="16fda-145">Пример см. в разделе [мсиассемблинаме Table](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="16fda-145">For an example, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



