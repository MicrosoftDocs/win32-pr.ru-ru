---
description: Этот материал предназначен для разработчиков, создающих собственные программы установки и разработчиков, желающих получить дополнительные сведения о таблицах базы данных установщика. Общие сведения об установщике см. в разделе About установщик Windows.
ms.assetid: 95516437-9708-4f4e-a5c2-7bcd4741c776
title: Функции базы данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4a4233437d24944c8bb7fe5c7de6412e700022b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103810750"
---
# <a name="database-functions"></a><span data-ttu-id="48430-104">Функции базы данных</span><span class="sxs-lookup"><span data-stu-id="48430-104">Database Functions</span></span>

<span data-ttu-id="48430-105">Этот материал предназначен для разработчиков, создающих собственные программы установки и разработчиков, желающих получить дополнительные сведения о таблицах базы данных установщика.</span><span class="sxs-lookup"><span data-stu-id="48430-105">This material is intended for developers who are writing their own setup programs and developers who want to learn more about the installer database tables.</span></span> <span data-ttu-id="48430-106">Общие сведения об установщике см. в разделе [About установщик Windows](about-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="48430-106">For general information on the installer, see [About Windows Installer](about-windows-installer.md).</span></span>

<span data-ttu-id="48430-107">Для доступа к базе данных и процессу установки можно использовать функции доступа к установщику.</span><span class="sxs-lookup"><span data-stu-id="48430-107">You can use the installer access functions to access the database and the installation process.</span></span> <span data-ttu-id="48430-108">Эти функции должны использоваться только пользовательскими действиями установки и средствами разработки.</span><span class="sxs-lookup"><span data-stu-id="48430-108">These functions should only be used by custom installation actions and authoring tools.</span></span> <span data-ttu-id="48430-109">Для некоторых функций доступа к установщику требуются строки SQL для запроса к базе данных.</span><span class="sxs-lookup"><span data-stu-id="48430-109">Some of the installer access functions require SQL query strings for querying the database.</span></span> <span data-ttu-id="48430-110">Запросы должны соответствовать [синтаксису SQL](sql-syntax.md)установщика.</span><span class="sxs-lookup"><span data-stu-id="48430-110">Queries must adhere to the installer [SQL syntax](sql-syntax.md).</span></span>

<span data-ttu-id="48430-111">В этом разделе перечислены функции доступа к базе данных установщика по категориям.</span><span class="sxs-lookup"><span data-stu-id="48430-111">This topic lists the installer database access functions by category.</span></span>

## <a name="general-database-access-functions"></a><span data-ttu-id="48430-112">Общие функции доступа к базам данных</span><span class="sxs-lookup"><span data-stu-id="48430-112">General Database Access Functions</span></span>



| <span data-ttu-id="48430-113">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-113">Function</span></span>                                                             | <span data-ttu-id="48430-114">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-114">Description</span></span>                                                                             |
|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="48430-115">**мсидатабасекоммит**</span><span class="sxs-lookup"><span data-stu-id="48430-115">**MsiDatabaseCommit**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)                       | <span data-ttu-id="48430-116">Фиксирует изменения в базе данных.</span><span class="sxs-lookup"><span data-stu-id="48430-116">Commits changes to a database.</span></span>                                                          |
| [<span data-ttu-id="48430-117">**мсидатабасежетпримарикэйс**</span><span class="sxs-lookup"><span data-stu-id="48430-117">**MsiDatabaseGetPrimaryKeys**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegetprimarykeysa)       | <span data-ttu-id="48430-118">Возвращает имена всех первичных ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="48430-118">Returns the names of all the primary key columns.</span></span>                                       |
| [<span data-ttu-id="48430-119">**мсидатабасеистаблеперсистент**</span><span class="sxs-lookup"><span data-stu-id="48430-119">**MsiDatabaseIsTablePersistent**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseistablepersistenta) | <span data-ttu-id="48430-120">Возвращает перечисление, описывающее состояние таблицы.</span><span class="sxs-lookup"><span data-stu-id="48430-120">Returns an enumeration describing the state of a table.</span></span>                                 |
| [<span data-ttu-id="48430-121">**мсидатабасеопенвиев**</span><span class="sxs-lookup"><span data-stu-id="48430-121">**MsiDatabaseOpenView**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa)                   | <span data-ttu-id="48430-122">Подготавливает запрос к базе данных и создает объект представления.</span><span class="sxs-lookup"><span data-stu-id="48430-122">Prepares a database query and creates a view object.</span></span>                                    |
| [<span data-ttu-id="48430-123">**Метод msigetactivedatabase**</span><span class="sxs-lookup"><span data-stu-id="48430-123">**MsiGetActiveDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetactivedatabase)                 | <span data-ttu-id="48430-124">Возвращает активную базу данных для установки.</span><span class="sxs-lookup"><span data-stu-id="48430-124">Returns the active database for the installation.</span></span>                                       |
| [<span data-ttu-id="48430-125">**мсивиевжетколумнинфо**</span><span class="sxs-lookup"><span data-stu-id="48430-125">**MsiViewGetColumnInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgetcolumninfo)                 | <span data-ttu-id="48430-126">Возвращает имена или определения столбцов.</span><span class="sxs-lookup"><span data-stu-id="48430-126">Returns column names or definitions.</span></span>                                                    |
| [<span data-ttu-id="48430-127">**мсиопендатабасе**</span><span class="sxs-lookup"><span data-stu-id="48430-127">**MsiOpenDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiopendatabasea)                           | <span data-ttu-id="48430-128">Открывает файл базы данных для доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="48430-128">Opens a database file for data access.</span></span>                                                  |
| [<span data-ttu-id="48430-129">**мсивиевклосе**</span><span class="sxs-lookup"><span data-stu-id="48430-129">**MsiViewClose**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewclose)                                 | <span data-ttu-id="48430-130">Освобождает результирующий набор для выполненного представления.</span><span class="sxs-lookup"><span data-stu-id="48430-130">Releases the result set for an executed view.</span></span>                                           |
| [<span data-ttu-id="48430-131">**мсивиевексекуте**</span><span class="sxs-lookup"><span data-stu-id="48430-131">**MsiViewExecute**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute)                             | <span data-ttu-id="48430-132">Выполняет запрос представления и предоставляет необходимые параметры.</span><span class="sxs-lookup"><span data-stu-id="48430-132">Executes the view query and supplies required parameters.</span></span>                               |
| [<span data-ttu-id="48430-133">**мсивиевфетч**</span><span class="sxs-lookup"><span data-stu-id="48430-133">**MsiViewFetch**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewfetch)                                 | <span data-ttu-id="48430-134">Извлекает следующую последовательную запись из представления.</span><span class="sxs-lookup"><span data-stu-id="48430-134">Fetches the next sequential record from the view.</span></span>                                       |
| [<span data-ttu-id="48430-135">**мсивиевжетеррор**</span><span class="sxs-lookup"><span data-stu-id="48430-135">**MsiViewGetError**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora)                           | <span data-ttu-id="48430-136">Возвращает ошибку, которая произошла в функции [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) .</span><span class="sxs-lookup"><span data-stu-id="48430-136">Returns the error that occurred in the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function.</span></span> |
| [<span data-ttu-id="48430-137">**мсивиевмодифи**</span><span class="sxs-lookup"><span data-stu-id="48430-137">**MsiViewModify**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify)                               | <span data-ttu-id="48430-138">Обновляет выбранную запись.</span><span class="sxs-lookup"><span data-stu-id="48430-138">Updates a fetched record.</span></span>                                                               |



 

## <a name="database-management-functions"></a><span data-ttu-id="48430-139">Функции управления базами данных</span><span class="sxs-lookup"><span data-stu-id="48430-139">Database Management Functions</span></span>



| <span data-ttu-id="48430-140">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-140">Function</span></span>                                                               | <span data-ttu-id="48430-141">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-141">Description</span></span>                                                      |
|------------------------------------------------------------------------|------------------------------------------------------------------|
| [<span data-ttu-id="48430-142">**мсикреатетрансформсуммаринфо**</span><span class="sxs-lookup"><span data-stu-id="48430-142">**MsiCreateTransformSummaryInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreatetransformsummaryinfoa) | <span data-ttu-id="48430-143">Создает сводные данные для существующего преобразования.</span><span class="sxs-lookup"><span data-stu-id="48430-143">Creates summary information for an existing transform.</span></span>           |
| [<span data-ttu-id="48430-144">**мсидатабасеапплитрансформ**</span><span class="sxs-lookup"><span data-stu-id="48430-144">**MsiDatabaseApplyTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseapplytransforma)         | <span data-ttu-id="48430-145">Применяет преобразование к базе данных.</span><span class="sxs-lookup"><span data-stu-id="48430-145">Applies a transform to a database.</span></span>                               |
| [<span data-ttu-id="48430-146">**мсидатабасикспорт**</span><span class="sxs-lookup"><span data-stu-id="48430-146">**MsiDatabaseExport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta)                         | <span data-ttu-id="48430-147">Экспортирует таблицу из открытой базы данных в текстовый файл архива.</span><span class="sxs-lookup"><span data-stu-id="48430-147">Exports a table from an open database to a text archive file.</span></span>    |
| [<span data-ttu-id="48430-148">**мсидатабасеженератетрансформ**</span><span class="sxs-lookup"><span data-stu-id="48430-148">**MsiDatabaseGenerateTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegeneratetransforma)   | <span data-ttu-id="48430-149">Создает файл преобразования различий между двумя базами данных.</span><span class="sxs-lookup"><span data-stu-id="48430-149">Generates a transform file of differences between two databases.</span></span> |
| [<span data-ttu-id="48430-150">**мсидатабасеимпорт**</span><span class="sxs-lookup"><span data-stu-id="48430-150">**MsiDatabaseImport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)                         | <span data-ttu-id="48430-151">Импортирует таблицу с текстовым архивом установщика в открытую базу данных.</span><span class="sxs-lookup"><span data-stu-id="48430-151">Imports an installer text archive table into an open database.</span></span>   |
| [<span data-ttu-id="48430-152">**мсидатабасемерже**</span><span class="sxs-lookup"><span data-stu-id="48430-152">**MsiDatabaseMerge**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea)                           | <span data-ttu-id="48430-153">Объединяет две базы данных вместе.</span><span class="sxs-lookup"><span data-stu-id="48430-153">Merges two databases together.</span></span>                                   |
| [<span data-ttu-id="48430-154">**мсижетдатабасестате**</span><span class="sxs-lookup"><span data-stu-id="48430-154">**MsiGetDatabaseState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate)                     | <span data-ttu-id="48430-155">Возвращает состояние базы данных.</span><span class="sxs-lookup"><span data-stu-id="48430-155">Returns the state of the database.</span></span>                               |



 

## <a name="record-processing-functions"></a><span data-ttu-id="48430-156">Функции обработки записей</span><span class="sxs-lookup"><span data-stu-id="48430-156">Record Processing Functions</span></span>



| <span data-ttu-id="48430-157">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-157">Function</span></span>                                                 | <span data-ttu-id="48430-158">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-158">Description</span></span>                                                     |
|----------------------------------------------------------|-----------------------------------------------------------------|
| [<span data-ttu-id="48430-159">**мсикреатерекорд**</span><span class="sxs-lookup"><span data-stu-id="48430-159">**MsiCreateRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreaterecord)               | <span data-ttu-id="48430-160">Создает новый объект Record с указанным числом полей.</span><span class="sxs-lookup"><span data-stu-id="48430-160">Creates new record object with specified number of fields.</span></span>      |
| [<span data-ttu-id="48430-161">**мсиформатрекорд**</span><span class="sxs-lookup"><span data-stu-id="48430-161">**MsiFormatRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiformatrecorda)               | <span data-ttu-id="48430-162">Форматирует данные и свойства полей записи с помощью строки формата.</span><span class="sxs-lookup"><span data-stu-id="48430-162">Formats record field data and properties using a format string.</span></span> |
| [<span data-ttu-id="48430-163">**мсирекордклеардата**</span><span class="sxs-lookup"><span data-stu-id="48430-163">**MsiRecordClearData**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordcleardata)         | <span data-ttu-id="48430-164">Задает для всех полей в записи значение null.</span><span class="sxs-lookup"><span data-stu-id="48430-164">Sets all fields in a record to null.</span></span>                            |
| [<span data-ttu-id="48430-165">**мсирекорддатасизе**</span><span class="sxs-lookup"><span data-stu-id="48430-165">**MsiRecordDataSize**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecorddatasize)           | <span data-ttu-id="48430-166">Возвращает длину поля записи.</span><span class="sxs-lookup"><span data-stu-id="48430-166">Returns the length of a record field.</span></span>                           |
| [<span data-ttu-id="48430-167">**мсирекорджетфиелдкаунт**</span><span class="sxs-lookup"><span data-stu-id="48430-167">**MsiRecordGetFieldCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetfieldcount) | <span data-ttu-id="48430-168">Возвращает число полей в записи.</span><span class="sxs-lookup"><span data-stu-id="48430-168">Returns the number of fields in a record.</span></span>                       |
| [<span data-ttu-id="48430-169">**мсирекорджетинтежер**</span><span class="sxs-lookup"><span data-stu-id="48430-169">**MsiRecordGetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetinteger)       | <span data-ttu-id="48430-170">Возвращает целочисленное значение из поля записи.</span><span class="sxs-lookup"><span data-stu-id="48430-170">Returns the integer value from a record field.</span></span>                  |
| [<span data-ttu-id="48430-171">**мсирекорджетстринг**</span><span class="sxs-lookup"><span data-stu-id="48430-171">**MsiRecordGetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetstringa)         | <span data-ttu-id="48430-172">Возвращает строковое значение поля записи.</span><span class="sxs-lookup"><span data-stu-id="48430-172">Returns the string value of a record field.</span></span>                     |
| [<span data-ttu-id="48430-173">**мсирекордиснулл**</span><span class="sxs-lookup"><span data-stu-id="48430-173">**MsiRecordIsNull**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordisnull)               | <span data-ttu-id="48430-174">Сообщает, имеет ли поле записи значение null.</span><span class="sxs-lookup"><span data-stu-id="48430-174">Reports whether a record field is null.</span></span>                         |
| [<span data-ttu-id="48430-175">**мсирекордреадстреам**</span><span class="sxs-lookup"><span data-stu-id="48430-175">**MsiRecordReadStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordreadstream)       | <span data-ttu-id="48430-176">Считывает байты из поля потока записи в буфер.</span><span class="sxs-lookup"><span data-stu-id="48430-176">Reads bytes from a record stream field into a buffer.</span></span>           |
| [<span data-ttu-id="48430-177">**мсирекордсетинтежер**</span><span class="sxs-lookup"><span data-stu-id="48430-177">**MsiRecordSetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetinteger)       | <span data-ttu-id="48430-178">Задает поле записи для целочисленного поля.</span><span class="sxs-lookup"><span data-stu-id="48430-178">Sets a record field to an integer field.</span></span>                        |
| [<span data-ttu-id="48430-179">**мсирекордсетстреам**</span><span class="sxs-lookup"><span data-stu-id="48430-179">**MsiRecordSetStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama)         | <span data-ttu-id="48430-180">Задает поле потока записей из файла.</span><span class="sxs-lookup"><span data-stu-id="48430-180">Sets a record stream field from a file.</span></span>                         |
| [<span data-ttu-id="48430-181">**мсирекордсетстринг**</span><span class="sxs-lookup"><span data-stu-id="48430-181">**MsiRecordSetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa)         | <span data-ttu-id="48430-182">Копирует строку в указанное поле.</span><span class="sxs-lookup"><span data-stu-id="48430-182">Copies a string into the designated field.</span></span>                      |



 

## <a name="summary-information-property-functions"></a><span data-ttu-id="48430-183">Функции свойств сводных данных</span><span class="sxs-lookup"><span data-stu-id="48430-183">Summary Information Property Functions</span></span>



| <span data-ttu-id="48430-184">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-184">Function</span></span>                                                                 | <span data-ttu-id="48430-185">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-185">Description</span></span>                                                            |
|--------------------------------------------------------------------------|------------------------------------------------------------------------|
| [<span data-ttu-id="48430-186">**мсижетсуммаринформатион**</span><span class="sxs-lookup"><span data-stu-id="48430-186">**MsiGetSummaryInformation**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsummaryinformationa)             | <span data-ttu-id="48430-187">Получает маркер для сводного информационного потока базы данных установщика.</span><span class="sxs-lookup"><span data-stu-id="48430-187">Obtains handle to summary information stream of installer database.</span></span>    |
| [<span data-ttu-id="48430-188">**мсисуммаринфожетпроперти**</span><span class="sxs-lookup"><span data-stu-id="48430-188">**MsiSummaryInfoGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertya)           | <span data-ttu-id="48430-189">Возвращает одно свойство из сводных данных.</span><span class="sxs-lookup"><span data-stu-id="48430-189">Gets a single property from the summary information.</span></span>                   |
| [<span data-ttu-id="48430-190">**мсисуммаринфожетпропертикаунт**</span><span class="sxs-lookup"><span data-stu-id="48430-190">**MsiSummaryInfoGetPropertyCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertycount) | <span data-ttu-id="48430-191">Возвращает число свойств в информационном потоке сводки.</span><span class="sxs-lookup"><span data-stu-id="48430-191">Returns number of properties in the summary information stream.</span></span>        |
| [<span data-ttu-id="48430-192">**мсисуммаринфоперсист**</span><span class="sxs-lookup"><span data-stu-id="48430-192">**MsiSummaryInfoPersist**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfopersist)                   | <span data-ttu-id="48430-193">Записывает измененные сводные данные обратно в информационный поток сводных данных.</span><span class="sxs-lookup"><span data-stu-id="48430-193">Writes changed summary information back to summary information stream.</span></span> |
| [<span data-ttu-id="48430-194">**мсисуммаринфосетпроперти**</span><span class="sxs-lookup"><span data-stu-id="48430-194">**MsiSummaryInfoSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfosetpropertya)           | <span data-ttu-id="48430-195">Задает одно свойство сводной информации.</span><span class="sxs-lookup"><span data-stu-id="48430-195">Sets a single summary information property.</span></span>                            |



 

## <a name="installer-state-access-functions"></a><span data-ttu-id="48430-196">Функции доступа к состоянию установщика</span><span class="sxs-lookup"><span data-stu-id="48430-196">Installer State Access Functions</span></span>



| <span data-ttu-id="48430-197">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-197">Function</span></span>                                               | <span data-ttu-id="48430-198">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-198">Description</span></span>                                                 |
|--------------------------------------------------------|-------------------------------------------------------------|
| [<span data-ttu-id="48430-199">**мсижетлангуаже**</span><span class="sxs-lookup"><span data-stu-id="48430-199">**MsiGetLanguage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage)               | <span data-ttu-id="48430-200">Возвращает числовой язык текущей установки.</span><span class="sxs-lookup"><span data-stu-id="48430-200">Returns the numeric language of the current installation.</span></span>   |
| [<span data-ttu-id="48430-201">**мсижетластерроррекорд**</span><span class="sxs-lookup"><span data-stu-id="48430-201">**MsiGetLastErrorRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlasterrorrecord) | <span data-ttu-id="48430-202">Возвращает запись об ошибке, которая была последней возвращена для вызывающего процесса.</span><span class="sxs-lookup"><span data-stu-id="48430-202">Returns error record last returned for the calling process.</span></span> |
| [<span data-ttu-id="48430-203">**мсижетмоде**</span><span class="sxs-lookup"><span data-stu-id="48430-203">**MsiGetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode)                       | <span data-ttu-id="48430-204">Возвращает одно из логических состояний внутренней установки.</span><span class="sxs-lookup"><span data-stu-id="48430-204">Returns one of the Boolean internal installation states.</span></span>    |
| [<span data-ttu-id="48430-205">**MsiGetProperty**</span><span class="sxs-lookup"><span data-stu-id="48430-205">**MsiGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya)               | <span data-ttu-id="48430-206">Возвращает значение свойства установщика.</span><span class="sxs-lookup"><span data-stu-id="48430-206">Gets the value of an installer property.</span></span>                    |
| [<span data-ttu-id="48430-207">**MsiSetProperty**</span><span class="sxs-lookup"><span data-stu-id="48430-207">**MsiSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetpropertya)               | <span data-ttu-id="48430-208">Задает значение свойства установки.</span><span class="sxs-lookup"><span data-stu-id="48430-208">Sets the value of an installation property.</span></span>                 |
| [<span data-ttu-id="48430-209">**мсисетмоде**</span><span class="sxs-lookup"><span data-stu-id="48430-209">**MsiSetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetmode)                       | <span data-ttu-id="48430-210">Задает логическое состояние внутреннего обработчика.</span><span class="sxs-lookup"><span data-stu-id="48430-210">Sets an internal engine Boolean state.</span></span>                      |



 

## <a name="installer-action-functions"></a><span data-ttu-id="48430-211">Функции действий установщика</span><span class="sxs-lookup"><span data-stu-id="48430-211">Installer Action Functions</span></span>



| <span data-ttu-id="48430-212">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-212">Function</span></span>                                             | <span data-ttu-id="48430-213">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-213">Description</span></span>                                                               |
|------------------------------------------------------|---------------------------------------------------------------------------|
| [<span data-ttu-id="48430-214">**мсидоактион**</span><span class="sxs-lookup"><span data-stu-id="48430-214">**MsiDoAction**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona)                   | <span data-ttu-id="48430-215">Выполняет Встроенное действие, настраиваемое действие или действие мастера пользовательских интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="48430-215">Executes built-in action, custom action, or user-interface wizard action.</span></span> |
| [<span data-ttu-id="48430-216">**мсиевалуатекондитион**</span><span class="sxs-lookup"><span data-stu-id="48430-216">**MsiEvaluateCondition**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msievaluateconditiona) | <span data-ttu-id="48430-217">Вычисляет условное выражение, содержащее имена и значения свойств.</span><span class="sxs-lookup"><span data-stu-id="48430-217">Evaluates a conditional expression containing property names and values.</span></span>  |
| [<span data-ttu-id="48430-218">**мсипроцессмессаже**</span><span class="sxs-lookup"><span data-stu-id="48430-218">**MsiProcessMessage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage)       | <span data-ttu-id="48430-219">Отправляет в установщик запись об ошибке для обработки.</span><span class="sxs-lookup"><span data-stu-id="48430-219">Sends an error record to the installer for processing.</span></span>                    |
| [<span data-ttu-id="48430-220">**мсисекуенце**</span><span class="sxs-lookup"><span data-stu-id="48430-220">**MsiSequence**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisequencea)                   | <span data-ttu-id="48430-221">Выполняет последовательность действий.</span><span class="sxs-lookup"><span data-stu-id="48430-221">Executes an action sequence.</span></span>                                              |



 

## <a name="installer-location-functions"></a><span data-ttu-id="48430-222">Функции расположения установщика</span><span class="sxs-lookup"><span data-stu-id="48430-222">Installer Location Functions</span></span>



| <span data-ttu-id="48430-223">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-223">Function</span></span>                                     | <span data-ttu-id="48430-224">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-224">Description</span></span>                                                       |
|----------------------------------------------|-------------------------------------------------------------------|
| [<span data-ttu-id="48430-225">**мсижетсаурцепас**</span><span class="sxs-lookup"><span data-stu-id="48430-225">**MsiGetSourcePath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsourcepatha) | <span data-ttu-id="48430-226">Возвращает полный исходный путь для папки в таблице Directory.</span><span class="sxs-lookup"><span data-stu-id="48430-226">Returns the full source path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="48430-227">**мсижеттаржетпас**</span><span class="sxs-lookup"><span data-stu-id="48430-227">**MsiGetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigettargetpatha) | <span data-ttu-id="48430-228">Возвращает полный целевой путь для папки в таблице Directory.</span><span class="sxs-lookup"><span data-stu-id="48430-228">Returns the full target path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="48430-229">**мсисеттаржетпас**</span><span class="sxs-lookup"><span data-stu-id="48430-229">**MsiSetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) | <span data-ttu-id="48430-230">Задает полный целевой путь для папки в таблице Directory.</span><span class="sxs-lookup"><span data-stu-id="48430-230">Sets the full target path for a folder in the Directory table.</span></span>    |



 

## <a name="installer-selection-functions"></a><span data-ttu-id="48430-231">Функции выбора установщика</span><span class="sxs-lookup"><span data-stu-id="48430-231">Installer Selection Functions</span></span>



| <span data-ttu-id="48430-232">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-232">Function</span></span>                                                     | <span data-ttu-id="48430-233">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-233">Description</span></span>                                                          |
|--------------------------------------------------------------|----------------------------------------------------------------------|
| [<span data-ttu-id="48430-234">**мсиенумкомпоненткостс**</span><span class="sxs-lookup"><span data-stu-id="48430-234">**MsiEnumComponentCosts**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienumcomponentcostsa)       | <span data-ttu-id="48430-235">Перечисление места на диске, необходимого для установки компонента.</span><span class="sxs-lookup"><span data-stu-id="48430-235">Enumerates the disk-space per drive required to install a component.</span></span> |
| [<span data-ttu-id="48430-236">**мсижеткомпонентстате**</span><span class="sxs-lookup"><span data-stu-id="48430-236">**MsiGetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetcomponentstatea)         | <span data-ttu-id="48430-237">Получает состояние компонента.</span><span class="sxs-lookup"><span data-stu-id="48430-237">Obtains the state of a component.</span></span>                                    |
| [<span data-ttu-id="48430-238">**мсижетфеатурекост**</span><span class="sxs-lookup"><span data-stu-id="48430-238">**MsiGetFeatureCost**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturecosta)               | <span data-ttu-id="48430-239">Возвращает место на диске, необходимое для компонента.</span><span class="sxs-lookup"><span data-stu-id="48430-239">Returns the disk space required by a feature.</span></span>                        |
| [<span data-ttu-id="48430-240">**мсижетфеатурестате**</span><span class="sxs-lookup"><span data-stu-id="48430-240">**MsiGetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturestatea)             | <span data-ttu-id="48430-241">Возвращает состояние компонента.</span><span class="sxs-lookup"><span data-stu-id="48430-241">Gets the state of a feature.</span></span>                                         |
| [<span data-ttu-id="48430-242">**мсижетфеатуревалидстатес**</span><span class="sxs-lookup"><span data-stu-id="48430-242">**MsiGetFeatureValidStates**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturevalidstatesa) | <span data-ttu-id="48430-243">Возвращает допустимое состояние установки.</span><span class="sxs-lookup"><span data-stu-id="48430-243">Returns a valid installation state.</span></span>                                  |
| [<span data-ttu-id="48430-244">**мсисеткомпонентстате**</span><span class="sxs-lookup"><span data-stu-id="48430-244">**MsiSetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetcomponentstatea)         | <span data-ttu-id="48430-245">Устанавливает компонент в указанное состояние.</span><span class="sxs-lookup"><span data-stu-id="48430-245">Sets a component to the specified state.</span></span>                             |
| [<span data-ttu-id="48430-246">**мсисетфеатуреаттрибутес**</span><span class="sxs-lookup"><span data-stu-id="48430-246">**MsiSetFeatureAttributes**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeatureattributesa)   | <span data-ttu-id="48430-247">Изменяет атрибуты компонента по умолчанию во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="48430-247">Modifies the default attributes of a feature at run time.</span></span>            |
| [<span data-ttu-id="48430-248">**мсисетфеатурестате**</span><span class="sxs-lookup"><span data-stu-id="48430-248">**MsiSetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeaturestatea)             | <span data-ttu-id="48430-249">Задает для компонента указанное состояние.</span><span class="sxs-lookup"><span data-stu-id="48430-249">Sets a feature to a specified state.</span></span>                                 |
| [<span data-ttu-id="48430-250">**мсисетинсталллевел**</span><span class="sxs-lookup"><span data-stu-id="48430-250">**MsiSetInstallLevel**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetinstalllevel)             | <span data-ttu-id="48430-251">Задает уровень установки полной версии продукта.</span><span class="sxs-lookup"><span data-stu-id="48430-251">Sets the installation level of a full product installation.</span></span>          |
| [<span data-ttu-id="48430-252">**мсиверифидискспаце**</span><span class="sxs-lookup"><span data-stu-id="48430-252">**MsiVerifyDiskSpace**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiverifydiskspace)             | <span data-ttu-id="48430-253">Проверяет наличие достаточного места на диске.</span><span class="sxs-lookup"><span data-stu-id="48430-253">Checks for sufficient disk space.</span></span>                                    |



 

## <a name="user-interface-functions"></a><span data-ttu-id="48430-254">Функции пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="48430-254">User Interface Functions</span></span>



| <span data-ttu-id="48430-255">Функция</span><span class="sxs-lookup"><span data-stu-id="48430-255">Function</span></span>                                           | <span data-ttu-id="48430-256">Описание</span><span class="sxs-lookup"><span data-stu-id="48430-256">Description</span></span>                                                             |
|----------------------------------------------------|-------------------------------------------------------------------------|
| [<span data-ttu-id="48430-257">**мсиенаблеуипревиев**</span><span class="sxs-lookup"><span data-stu-id="48430-257">**MsiEnableUIPreview**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienableuipreview)   | <span data-ttu-id="48430-258">Включает режим предварительного просмотра пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="48430-258">Enables preview mode of the user interface.</span></span>                             |
| [<span data-ttu-id="48430-259">**мсипревиевбиллбоард**</span><span class="sxs-lookup"><span data-stu-id="48430-259">**MsiPreviewBillboard**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewbillboarda) | <span data-ttu-id="48430-260">Отображает объявление с элементом управления ведущего приложения в отображаемом диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="48430-260">Displays a billboard with the host control in the displayed dialog box.</span></span> |
| [<span data-ttu-id="48430-261">**мсипревиевдиалог**</span><span class="sxs-lookup"><span data-stu-id="48430-261">**MsiPreviewDialog**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewdialoga)       | <span data-ttu-id="48430-262">Отображает диалоговое окно как немодальное и неактивное.</span><span class="sxs-lookup"><span data-stu-id="48430-262">Displays a dialog box as modeless and inactive.</span></span>                         |



 

<span data-ttu-id="48430-263">Все функции поддерживают вызовы ANSI и Unicode.</span><span class="sxs-lookup"><span data-stu-id="48430-263">All functions support both ANSI and Unicode calls.</span></span> <span data-ttu-id="48430-264">Чтобы использовать эти функции, включите Мсикуери. h и свяжите с MSI. lib.</span><span class="sxs-lookup"><span data-stu-id="48430-264">To use these functions, include MsiQuery.h and link with Msi.lib.</span></span>

## <a name="installation-functions"></a><span data-ttu-id="48430-265">Функции установки</span><span class="sxs-lookup"><span data-stu-id="48430-265">Installation Functions</span></span>

<span data-ttu-id="48430-266">Помимо перечисленных выше функций доступа к базе данных, вы создаете пакет установки для приложения с помощью функций установщика, перечисленных в разделе Справочник по [функциям установщика](installer-function-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="48430-266">In addition to the database access functions listed above, you create an installation package for an application by using the installer functions listed in the [Installer Function Reference](installer-function-reference.md) section.</span></span>

 

 



