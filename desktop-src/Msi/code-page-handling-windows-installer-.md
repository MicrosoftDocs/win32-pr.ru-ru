---
description: Установщик Windows сохраняет все строки базы данных в одном общем пуле строк, чтобы уменьшить размер базы данных и повысить производительность. Список страниц с числовыми кодовыми номерами см. в разделе Локализация таблиц ошибок и Актионтекст.
ms.assetid: 5d413fb7-99da-49f3-ace3-ec285df2e634
title: Обработка кодовой страницы (установщик Windows)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db2788a1bfc6bdb49ec1402d5bba8a1a2594b30
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662591"
---
# <a name="code-page-handling-windows-installer"></a><span data-ttu-id="abb91-104">Обработка кодовой страницы (установщик Windows)</span><span class="sxs-lookup"><span data-stu-id="abb91-104">Code Page Handling (Windows Installer)</span></span>

<span data-ttu-id="abb91-105">Установщик Windows сохраняет все строки базы данных в одном общем пуле строк, чтобы уменьшить размер базы данных и повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="abb91-105">The Windows Installer stores all database strings in a single shared string pool to reduce the size of the database, and to improve performance.</span></span> <span data-ttu-id="abb91-106">Список страниц с числовыми кодовыми номерами см. в разделе [Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-106">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="abb91-107">Дополнительные сведения см. в статье [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-107">For more information, [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

<span data-ttu-id="abb91-108">Установщик Windows использует [**исвалидкодепаже**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) , чтобы определить, является ли кодовая страница допустимой.</span><span class="sxs-lookup"><span data-stu-id="abb91-108">Windows Installer uses [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) to determine whether the code page is valid.</span></span>

### <a name="localizing-a-windows-installer-package"></a><span data-ttu-id="abb91-109">Локализация пакета установщик Windows</span><span class="sxs-lookup"><span data-stu-id="abb91-109">Localizing a Windows Installer Package</span></span>

<span data-ttu-id="abb91-110">Локализация пакета установщик Windows может привести к изменению сведений в таблицах базы данных, экспорту таблиц в текстовые архивные файлы ANSI, а затем импорту архивных файлов в локализованную базу данных.</span><span class="sxs-lookup"><span data-stu-id="abb91-110">If you localize a Windows Installer package, it may involve modifying information in database tables, exporting the tables to ANSI text archive files, and then importing the archive files into the database that is being localized.</span></span> <span data-ttu-id="abb91-111">Также можно добавить изменения локализации в базу данных с помощью редактора таблиц базы данных или [функций базы данных](database-functions.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-111">You can also add localization changes to a database by using a database table editor or the [Database Functions](database-functions.md).</span></span> <span data-ttu-id="abb91-112">Важно задать кодовую страницу для локализованной базы данных перед внесением изменений в локализацию в базу данных.</span><span class="sxs-lookup"><span data-stu-id="abb91-112">It is important to set the code page of the database that is being localized before you make any localization changes to the database.</span></span> <span data-ttu-id="abb91-113">Не устанавливайте кодовую страницу базы данных после локализации базы данных, так как это может привести к повреждению дополнительных символов.</span><span class="sxs-lookup"><span data-stu-id="abb91-113">Do not set the code page of the database after localizing the database, because this can corrupt extended characters.</span></span> <span data-ttu-id="abb91-114">Дополнительные сведения см. [в разделе Установка кодовой страницы базы данных](setting-the-code-page-of-a-database.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-114">For more information, see [Setting the Code Page of a Database](setting-the-code-page-of-a-database.md).</span></span>

<span data-ttu-id="abb91-115">Рекомендуемый подход к обработке кодовых страниц заключается в создании нейтральной базы данных, которая содержит только символы, которые можно преобразовать в любую кодовую страницу.</span><span class="sxs-lookup"><span data-stu-id="abb91-115">The recommended approach for handling code pages is to author a neutral database that only contains characters that can be translated into any code page.</span></span> <span data-ttu-id="abb91-116">Дополнительные сведения см. в разделе [Создание базы данных с нейтральной кодовой страницей](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-116">For more information, see [Creating a Database with a Neutral Code Page](creating-a-database-with-a-neutral-code-page.md).</span></span>

<span data-ttu-id="abb91-117">При добавлении сведений о локализации в файлы архива базы данных можно использовать [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) для экспорта таблиц из базы данных, содержащей изменения локализации, в текстовые архивные файлы ANSI, а затем импортировать их в базу данных, локализованную с помощью [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="abb91-117">If you add localization information with database archive files, you can use [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) to export tables from a database that contains localization changes to ANSI text archive files, and then import these into the database being localized with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="abb91-118">Кодовая страница экспортированного файла архива всегда совпадает с ее родительской базой данных.</span><span class="sxs-lookup"><span data-stu-id="abb91-118">The code page of an exported archive file is always the same as its parent database.</span></span> <span data-ttu-id="abb91-119">Кодовые страницы импортируемого файла и базы данных, получающей файл, должны быть идентичными, или хотя бы одна из двух кодовых страниц должна быть нейтральной.</span><span class="sxs-lookup"><span data-stu-id="abb91-119">The code pages of an imported file and the database that is receiving the file must be identical, or at least one of the two code pages must be neutral.</span></span> <span data-ttu-id="abb91-120">Дополнительные сведения см. в разделе [Обработка кодовых страниц импортированных и экспортированных таблиц](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-120">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="abb91-121">Если вы добавляете сведения о локализации в текстовый редактор или [функции базы данных](database-functions.md) , будьте внимательны при передаче строковых параметров в установщик Windows API, который использует кодовую страницу локализованной базы данных.</span><span class="sxs-lookup"><span data-stu-id="abb91-121">If you add localization information with a text editor or the [Database Functions](database-functions.md) be careful to only pass string parameters to the Windows Installer API that uses the code page of the database that is being localized.</span></span> <span data-ttu-id="abb91-122">Если строковый параметр содержит символы, не представленные кодовой страницей базы данных, при вызове [**мсидатабасекоммит**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="abb91-122">If a string parameter contains characters not represented by the code page of the database, an error occurs when calling [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span> <span data-ttu-id="abb91-123">Дополнительные сведения см. в разделе [Обработка кодовых страниц строк параметров](code-page-handling-of-parameter-strings.md).</span><span class="sxs-lookup"><span data-stu-id="abb91-123">For more information, see [Code Page Handling of Parameter Strings](code-page-handling-of-parameter-strings.md).</span></span>

<span data-ttu-id="abb91-124">Если один пакет используется для установки нескольких языковых версий продукта, то преобразование, используемое для локализации строк, также может изменить кодовую страницу базы данных.</span><span class="sxs-lookup"><span data-stu-id="abb91-124">If one package is used to install multiple language versions of a product, the transform that is used to localize strings can also change the code page of the database.</span></span>

 

 
