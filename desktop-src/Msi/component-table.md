---
description: В таблице Component перечислены компоненты, и они содержат следующие столбцы.
ms.assetid: 069d64e9-106a-42b7-8dea-a44fc0c6e0cd
title: Таблица компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b721996767fa98209f0e13530f8f1bb1ba8cca07
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263435"
---
# <a name="component-table"></a>Таблица компонентов

В таблице Component перечислены компоненты, и они содержат следующие столбцы.



| Столбец      | Type                         | Ключ | Допускает значения NULL |
|-------------|------------------------------|-----|----------|
| Компонент   | [Идентификатор](identifier.md) | Да   | Нет        |
| ComponentId | [GUID](guid.md)             | Нет   | Да        |
| Каталог\_ | [Идентификатор](identifier.md) | Нет   | Нет        |
| Атрибуты  | [Integer](integer.md)       | Нет   | Нет        |
| Условие   | [Condition](condition.md)   | Нет   | Да        |
| Путь     | [Идентификатор](identifier.md) | Нет   | Да        |



 

## <a name="columns"></a>Столбцы

<dl> <dt>

<span id="Component"></span><span id="component"></span><span id="COMPONENT"></span>См
</dt> <dd>

Определяет запись компонента.

Первичный ключ таблицы.

</dd> <dt>

<span id="ComponentId"></span><span id="componentid"></span><span id="COMPONENTID"></span>ComponentId
</dt> <dd>

Идентификатор GUID строки, уникальный для этого компонента, версии и языка.

Обратите внимание, что буквы этих идентификаторов GUID должны быть прописными буквами. Такие служебные программы, как GUIDGEN, могут создавать идентификаторы GUID, содержащие строчные буквы. Буквы в нижнем регистре необходимо заменить на прописные, чтобы сделать допустимыми идентификаторы GUID кода компонентов.

Если этот столбец имеет значение null, установщик не регистрирует компонент, и компонент не может быть удален или восстановлен с помощью установщика. Это может быть намеренно выполнено, если во время установки требуется только компонент, например пользовательское действие, которое очищает временные файлы или удаляет старый продукт. Он также может быть полезен при копировании файлов данных на компьютер пользователя, который не требуется регистрировать.

</dd> <dt>

<span id="Directory_"></span><span id="directory_"></span><span id="DIRECTORY_"></span>Каталоги\_
</dt> <dd>

Внешний ключ записи в [таблице Directory](directory-table.md). Это имя свойства, значение которого содержит фактический путь, который можно задать либо с помощью [действия аппсеарч](appsearch-action.md) , либо с помощью параметра по умолчанию, полученного из таблицы Directory.

Разработчики должны избегать создания компонентов, помещают файлы в одну из папок профиля пользователя. Эти файлы будут недоступны для всех пользователей в ситуациях с несколькими пользователями и могут привести к тому, что установщик будет постоянно просматривать компонент, как требуется для восстановления.

Внешний ключ к столбцу в одной из таблиц каталога.

</dd> <dt>

<span id="Attributes"></span><span id="attributes"></span><span id="ATTRIBUTES"></span>Атрибута
</dt> <dd>

Этот столбец содержит битовый флаг, указывающий параметры для удаленного выполнения. Добавьте указанный бит к общему значению в столбце, чтобы включить параметр.

> [!Note]  
> В случае с MSI-файлом, загружаемым из расположения в Интернете, флаги атрибута не следует устанавливать, чтобы разрешить запуск компонента из источника. Это ограничение установщик Windows и может возвращать состояние компонента INSTALLSTATE \_ бадконфиг.

 



<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>Битовый флаг</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутеслокалонли</strong></dt> <dt>0</dt> <dt>Символ 0x0000</dt> </dl> Не удается запустить компонент из источника. Установите этот бит для всех компонентов, принадлежащих к компоненту, чтобы предотвратить запуск компонента из сети или запуск из источника. Обратите внимание, что если компонент не содержит компонентов, в качестве допустимых параметров всегда отображается режим "Запуск от имени" и "выполнить с моего компьютера".<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>мсидбкомпонентаттрибутессаурцеонли</strong></dt> <dt>1</dt> <dt>0x0001</dt> </dl> Компонент может быть запущен только из источника. Установите этот бит для всех компонентов, принадлежащих к компоненту, чтобы предотвратить запуск компонента с компьютера. Обратите внимание, что если компонент не содержит компонентов, в качестве допустимых параметров всегда отображается режим "Запуск от имени" и "выполнить с моего компьютера".<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесоптионал</strong></dt> <dt>2</dt> <dt>0x0002</dt> </dl> Компонент может выполняться локально или из источника.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесрегистрикэйпас</strong></dt> <dt>4</dt> <dt>0x0004</dt> </dl> Если этот бит задан, значение в столбце ключевого пути используется в качестве ключа в <a href="registry-table.md">таблице реестра</a>. Если поле значения соответствующей записи в таблице реестра имеет значение null, поле Name в этой записи не должно содержать &quot; + &quot; , &quot; - &quot; или &quot; * &quot; . Дополнительные сведения см. в описании поля Name в <a href="registry-table.md">таблице реестра</a>.<br/> Этот бит рекомендуется задавать для записей реестра, записанных в куст HKCU. Это гарантирует, что установщик запишет необходимые записи реестра HKCU при наличии нескольких пользователей на одном компьютере.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесшареддллрефкаунт</strong></dt> <dt>8</dt> <dt>0x0008</dt> </dl> Если этот бит задан, установщик увеличивает счетчик ссылок в реестре общей библиотеки DLL файла ключа компонента. Если этот бит не задан, установщик увеличивает счетчик ссылок, только если число ссылок уже существует.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесперманент</strong></dt> <dt>16</dt> <dt>0x0010</dt> </dl> Если этот бит задан, установщик не удаляет компонент во время удаления. Установщик регистрирует дополнительный системный клиент для компонента в параметрах реестра установщик Windows.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесодбкдатасаурце</strong></dt> <dt>32</dt> <dt>0x0020</dt> </dl> Если этот бит задан, значение в столбце ключевого пути является ключом в <a href="odbcdatasource-table.md">таблице одбкдатасаурце</a>.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>мсидбкомпонентаттрибутестранситиве</strong></dt> <dt>64</dt> <dt>0x0040</dt> </dl> Если этот бит задан, установщик повторно вычисляет значение инструкции в столбце Condition при переустановке. Если значение было ранее false и изменилось на true, установщик установит компонент. Если значение было ранее true и изменилось на false, установщик удаляет компонент, даже если он содержит другие продукты в качестве клиентов.<br/> Этот бит следует устанавливать только для транзитивных компонентов. См. раздел <a href="using-transitive-components.md">Использование транзитивных компонентов</a>.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесневероверврите</strong></dt> <dt>128</dt> <dt>0x0080</dt> </dl> Если этот бит задан, установщик не устанавливает и не переустанавливает компонент, если файл пути к ключу или запись реестра пути к ключу для этого компонента уже существуют. Приложение регистрирует себя в качестве клиента компонента.<br/> Используйте этот флаг только для компонентов, регистрируемых в таблице реестра. Не используйте этот флаг для компонентов, зарегистрированных в таблицах <a href="appid-table.md">AppID</a>, <a href="class-table.md">класса</a>, <a href="extension-table.md">расширения</a>, <a href="progid-table.md">ProgID</a>, <a href="mime-table.md">MIME</a>и <a href="verb-table.md">глаголах</a>.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>msidbComponentAttributes64bit</strong></dt> <dt>256</dt> <dt>0x0100</dt> </dl> Установите этот бит, чтобы отметить это как 64-разрядный компонент. Этот атрибут упрощает установку пакетов, включающих как 32-разрядные, так и 64-разрядные компоненты. Если этот бит не задан, компонент регистрируется как 32-разрядный компонент.<br/> Если это 64-разрядный компонент, заменяющий 32-разрядный компонент, установите этот бит и назначьте новый идентификатор GUID в столбце ComponentId.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесдисаблерегистрирефлектион</strong></dt> <dt>512</dt> <dt>0x0200</dt> </dl> Установите этот бит, чтобы отключить <a href="/windows/desktop/WinProg64/registry-reflection">отражение реестра</a> для всех существующих и новых разделов реестра, затронутых этим компонентом. Если этот бит задан, установщик Windows вызывает <a href="/windows/desktop/api/winreg/nf-winreg-regdisablereflectionkey"><strong>регдисаблерефлектионкэй</strong></a> для каждого ключа, к которому обращается компонент. Этот бит доступен в установщик Windows версии 4,0. Этот бит не учитывается в 32-разрядных системах. Этот бит не учитывается в 64-разрядных версиях Windows XP.<br/>
<blockquote>
[!Note]<br />
32-разрядные приложения Windows, работающие на 64-разрядном эмуляторе Windows (WOW64), ссылаются на другое представление реестра, чем 64-bit Applications. Отражение реестра копирует некоторые значения реестра между этими двумя представлениями реестра.
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесунинсталлонсуперседенце</strong></dt> <dt>1024</dt> <dt>0x0400</dt> </dl> Установите этот бит для компонента в пакете исправлений, чтобы предотвратить появление потерянных компонентов на компьютере. Если последующее исправление установлено, для которого в таблице <a href="msipatchsequence-table.md">мсипатчсекуенце</a> помечается значение <strong>мсидбпатчсекуенцесуперседиарлиер</strong> , чтобы заменить первое исправление, установщик Windows 4,5 и более поздних версий могут отменить регистрацию и удаление компонентов, помеченных значением <strong>мсидбкомпонентаттрибутесунинсталлонсуперседенце</strong> . Если компонент не отмечен этим битом, установка заменяющего исправления может остаться за неиспользуемым компонентом на компьютере.<br/> Установка свойства <strong>мсиунинсталлсуперседедкомпонентс</strong> оказывает тот же результат, что и установка этого бита для всех компонентов.<br/> <strong><a href="not-supported-in-windows-installer-4-0.md">Установщик Windows 4,0 и более ранних версий</a>:</strong> значение <strong>мсидбкомпонентаттрибутесунинсталлонсуперседенце</strong> не поддерживается и игнорируется.<br/> <br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>мсидбкомпонентаттрибутесшаред</strong></dt> <dt>2048</dt> <dt>0x0800</dt> </dl> Если компонент помечен этим значением атрибута хотя бы в одном пакете, установленном в системе, установщик рассматривает компонент как помеченный во всех пакетах. Если пакет, совместно использующий отмеченный компонент, удаляется, установщик Windows 4,5 может продолжать совместно использовать самую новую версию компонента в системе, даже если пакет, который удаляется, был установлен с помощью удаляемого пакета. <br/> Если для политики Дисаблешаредкомпонент задано значение 1, то пакет не получает функций общего компонента, включенных этим битом.<br/> <strong><a href="not-supported-in-windows-installer-4-0.md">Установщик Windows 4,0 и более ранних версий</a>:</strong> значение <strong>мсидбкомпонентаттрибутесшаред</strong> не поддерживается и игнорируется.<br/> <br/></td>
</tr>
</tbody>
</table>



 

</dd> <dt>

<span id="Condition"></span><span id="condition"></span><span id="CONDITION"></span>Выполняет
</dt> <dd>

Этот столбец содержит условный оператор, который может контролировать, установлен ли компонент. Если условие имеет значение null или имеет значение true, компонент включен. Если условие принимает значение false, компонент отключается и не устанавливается.

Поле условия включает или отключает компонент только во время [действия костфинализе](costfinalize-action.md). Чтобы включить или отключить компонент после Костфинализе, необходимо использовать настраиваемое действие или [DoAction таблице ControlEvent событие](doaction-controlevent.md) для вызова [**мсисеткомпонентстате**](/windows/desktop/api/Msiquery/nf-msiquery-msisetcomponentstatea).

Обратите внимание, что если для компонента не задано транзитивное значение в столбце Attributes, компонент остается включенным после установки, даже если условный оператор в столбце Condition (условие) будет иметь значение false при последующем обслуживании продукта.

Столбец Condition в таблице Component принимает условные выражения, содержащие ссылки на установленные состояния функций и компонентов. Дополнительные сведения о синтаксисе условных операторов см. в разделе [Синтаксис условных](conditional-statement-syntax.md)инструкций.

</dd> <dt>

<span id="KeyPath"></span><span id="keypath"></span><span id="KEYPATH"></span>Путь
</dt> <dd>

Это значение указывает на файл или папку, принадлежащие компоненту, который установщик использует для обнаружения компонента. Два компонента не могут иметь одинаковое значение пути к ключу. Значение в этом столбце также является путем, возвращаемым функцией [**мсижеткомпонентпас**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) .

Если значение не равно null, то ключевой раздел является либо первичным ключом в [реестре](registry-table.md), [одбкдатасаурце](odbcdatasource-table.md), либо [таблицами файлов](file-table.md) в зависимости от значения атрибута. Если ключевой путь имеет значение null, то в \_ качестве пути к ключу используется папка столбца каталога.

Поскольку папки, созданные установщиком, удаляются, когда они становятся пустыми, необходимо создать запись в [таблице креатефолдер](createfolder-table.md) , чтобы установить компонент, состоящий из пустой папки.

Обратите внимание, что если компонент установщик Windows содержит файл или раздел реестра, защищенный [Защита ресурсов Windows](/windows/desktop/Wfp/windows-resource-protection-portal) (WRP) или файл, защищенный с помощью защиты файлов Windows (WFP), этот ресурс следует использовать в качестве ключевого пути для компонента. В этом случае установщик Windows не устанавливает, не обновляет или не удаляет компонент. В пакет установки не следует включать защищенные ресурсы. Вместо этого следует использовать [поддерживаемые механизмы замены ресурсов](/windows/desktop/Wfp/supported-file-replacement-mechanisms) для защита ресурсов Windows. Дополнительные сведения см. [в разделе использование установщик Windows и защита ресурсов Windows](windows-resource-protection-on-windows-vista.md).

</dd> </dl>

## <a name="remarks"></a>Комментарии

Описание связи между компонентами и функциями см. в разделе [Таблица функций](feature-table.md).

Установщик отслеживает общие библиотеки DLL независимо от общего числа ссылок на библиотеку DLL в реестре. Если счетчик ссылок для общей библиотеки DLL существует в реестре, установщик всегда увеличивает значение счетчика при установке файла и уменьшает его при удалении. Если параметр **мсидбкомпонентаттрибутесшареддллрефкаунт** не установлен и счетчик ссылок еще не существует, установщик не создаст его. Обратите внимание, что счетчик ссылок SharedDLLs в реестре увеличивается для всех файлов, установленных в системной папке.

Если **мсидбкомпонентаттрибутесшареддллрефкаунт** не задан, другое приложение может удалить компонент, даже если он все еще необходим. Чтобы увидеть, как это может произойти, рассмотрим следующий сценарий:

-   Приложение, использующее установщик, устанавливает общий компонент.
-   Бит **мсидбкомпонентаттрибутесшареддллрефкаунт** не задан, и счетчик ссылок отсутствует. Поэтому установщик не начинает отсчет ссылок.
-   Устаревшее приложение, использующее общий доступ к этому компоненту и не имеющее установленного установщика.
-   Устаревшее приложение создает и увеличивает счетчик ссылок для общего компонента.
-   Устаревшее приложение удаляется.
-   Число ссылок для общего компонента уменьшается до нуля, а компонент удаляется.
-   Приложение, использующее установщик, больше не имеет доступа к компоненту.

Чтобы избежать такого поведения, задайте **мсидбкомпонентаттрибутесшареддллрефкаунт**.

Обратите внимание, что компоненты системных служб не должны указываться в качестве запуска из исходного кода без специально разработанного для такого использования. Дополнительные сведения см. в [таблице сервицеинсталл](serviceinstall-table.md) .

Обратите внимание, что для компонентов, содержащих библиотеки динамической компоновки, которые находятся в системной папке, никогда не следует задавать атрибуты, включающие установку с запуском из исходного кода. Причина в том, что если для состояния установки компонента задается значение запуска от исходного кода с помощью функции или в пользовательском интерфейсе, последующие вызовы **LoadLibrary** в библиотеке DLL завершатся ошибкой.

См. также раздел [Управление состояниями выбора компонентов](controlling-feature-selection-states.md).

## <a name="validation"></a>Проверка

<dl>

[ICE02](ice02.md)  
[ICE03](ice03.md)  
[ICE06](ice06.md)  
[ICE07](ice07.md)  
[ICE08](ice08.md)  
[ICE09](ice09.md)  
[ICE18](ice18.md)  
[ICE19](ice19.md)  
[ICE21](ice21.md)  
[ICE30](ice30.md)  
[ICE32](ice32.md)  
[ICE35](ice35.md)  
[ICE38](ice38.md)  
[ICE41](ice41.md)  
[ICE42](ice42.md)  
[ICE43](ice43.md)  
[ICE46](ice46.md)  
[ICE50](ice50.md)  
[ICE54](ice54.md)  
[ICE57](ice57.md)  
[ICE59](ice59.md)  
[ICE62](ice62.md)  
[ICE67](ice67.md)  
[ICE76](ice76.md)  
[ICE79](ice79.md)  
[ICE80](ice80.md)  
[ICE83](ice83.md)  
[ICE86](ice86.md)  
[ICE88](ice88.md)  
[ICE91](ice91.md)  
[ICE92](ice92.md)  
[ICE97](ice97.md)  
</dl>

