---
description: В этом разделе приведен список советов, связанных с основной документацией по установщик Windows SDK, которая поможет разработчикам приложений, авторам программы установки, ИТ-специалистам и разработчикам инфраструктуры найти рекомендации по использованию установщик Windows.
ms.assetid: ff48d995-fe6f-4d1b-898d-67574ed3c5b7
title: Рекомендации по установщик Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ffaf6aae83afbe510f2b1eefc447e34754296ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104081059"
---
# <a name="windows-installer-best-practices"></a><span data-ttu-id="4cbfd-103">Рекомендации по установщик Windows</span><span class="sxs-lookup"><span data-stu-id="4cbfd-103">Windows Installer Best Practices</span></span>

<span data-ttu-id="4cbfd-104">В этом разделе приведен список советов, связанных с основной документацией по установщик Windows SDK, которая поможет разработчикам приложений, авторам программы установки, ИТ-специалистам и разработчикам инфраструктуры найти рекомендации по использованию установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-104">This section enumerates a list of tips, linked to the main Windows Installer SDK documentation, to help Application Developers, Setup Authors, IT Professionals, and Infrastructure Developers discover best practices for using the Windows Installer:</span></span>

-   [<span data-ttu-id="4cbfd-105">Обновите версию установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-105">Update the Windows Installer version.</span></span>](#update-the-windows-installer-version)
-   [<span data-ttu-id="4cbfd-106">Соответствие требованиям к сертификации эмблемы Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-106">Meet the Windows Logo certification requirements.</span></span>](#meet-the-windows-logo-certification-requirements)
-   [<span data-ttu-id="4cbfd-107">Подготовка пакета к локализации.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-107">Prepare the package for localization.</span></span>](#prepare-the-package-for-localization)
-   [<span data-ttu-id="4cbfd-108">Обновление средств и документации по разработке установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-108">Update your Windows Installer development tools and documentation.</span></span>](#update-your-windows-installer-development-tools-and-documentation)
-   [<span data-ttu-id="4cbfd-109">Если вы решили переупаковать устаревшее приложение установки, следуйте рекомендациям по перепакетированию.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-109">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>](#if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices)
-   [<span data-ttu-id="4cbfd-110">Не пытайтесь заменить защищенные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-110">Do not try to replace protected resources.</span></span>](#do-not-try-to-replace-protected-resources)
-   [<span data-ttu-id="4cbfd-111">Не зависят от некритических ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-111">Do not depend upon non-critical resources.</span></span>](#do-not-depend-upon-non-critical-resources)
-   [<span data-ttu-id="4cbfd-112">Используйте API для получения сведений о конфигурации установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-112">Use the API to retrieve Windows Installer configuration information.</span></span>](#use-the-api-to-retrieve-windows-installer-configuration-information)
-   [<span data-ttu-id="4cbfd-113">Организуйте установку приложения вокруг компонентов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-113">Organize the installation of your application around components.</span></span>](#organize-the-installation-of-your-application-around-components)
-   [<span data-ttu-id="4cbfd-114">Сократите размер больших пакетов установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-114">Reduce the size of large Windows Installer packages.</span></span>](#reduce-the-size-of-large-windows-installer-packages)
-   [<span data-ttu-id="4cbfd-115">При использовании настраиваемых действий следуйте хорошим рекомендациям по настраиваемым действиям.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-115">If you use custom actions, follow good custom action practices.</span></span>](#if-you-use-custom-actions-follow-good-custom-action-practices)
-   [<span data-ttu-id="4cbfd-116">Если вы используете сборки, следуйте хорошим рекомендациям по сборке</span><span class="sxs-lookup"><span data-stu-id="4cbfd-116">If you use assemblies, follow good assembly practices</span></span>](#if-you-use-assemblies-follow-good-assembly-practices)
-   [<span data-ttu-id="4cbfd-117">Не поставлять параллельные установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-117">Do not ship concurrent installations.</span></span>](#do-not-ship-concurrent-installations)
-   [<span data-ttu-id="4cbfd-118">Обеспечьте единообразие имен пакетов и кодов пакетов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-118">Keep package names and package codes consistent.</span></span>](#keep-package-names-and-package-codes-consistent)
-   [<span data-ttu-id="4cbfd-119">Не используйте таблицы Селфрег и TypeLib.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-119">Do not use the SelfReg and TypeLib tables.</span></span>](#do-not-use-the-selfreg-and-typelib-tables)
-   [<span data-ttu-id="4cbfd-120">Укажите параметр для установки без пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-120">Provide the option to install without a user interface.</span></span>](#provide-the-option-to-install-without-a-user-interface)
-   [<span data-ttu-id="4cbfd-121">Избегайте использования политики AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-121">Avoid using the AlwaysInstallElevated policy.</span></span>](#avoid-using-the-alwaysinstallelevated-policy)
-   [<span data-ttu-id="4cbfd-122">Включите политику Дисаблемедиа, чтобы ограничить несанкционированную установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-122">Enable the DisableMedia policy to limit unauthorized installation.</span></span>](#enable-the-disablemedia-policy-to-limit-unauthorized-installation)
-   [<span data-ttu-id="4cbfd-123">Обеспечьте безопасность и доступность исходных исходных файлов пакета для пользователей.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-123">Keep the original package source files secure and available to users.</span></span>](#keep-the-original-package-source-files-secure-and-available-to-users)
-   [<span data-ttu-id="4cbfd-124">Включите подробное ведение журнала на компьютере пользователя при устранении неполадок развертывания.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-124">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>](#enable-verbose-logging-on-users-computer-when-troubleshooting-deployment)
-   [<span data-ttu-id="4cbfd-125">При удалении компьютер пользователя остается в чистом состоянии.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-125">Uninstallation leaves the user's computer in a clean state.</span></span>](#uninstallation-leaves-the-users-computer-in-a-clean-state)
-   [<span data-ttu-id="4cbfd-126">Тестовые пакеты для развертывания с установкой на уровне пользователя и на компьютере.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-126">Test packages for both per-user and per-machine installation deployment.</span></span>](#test-packages-for-both-per-user-and-per-machine-installation-deployment)
-   [<span data-ttu-id="4cbfd-127">Спланируйте и протестируйте стратегию обслуживания перед отправкой приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-127">Plan and test a servicing strategy before shipping the application.</span></span>](#plan-and-test-a-servicing-strategy-before-shipping-the-application)
-   [<span data-ttu-id="4cbfd-128">Сократите зависимость обновлений от исходных источников.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-128">Reduce the dependency of updates upon the original sources.</span></span>](#reduce-the-dependency-of-updates-upon-the-original-sources)
-   [<span data-ttu-id="4cbfd-129">Не распространяйте необслуживаемые модули слияния.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-129">Do not distribute unserviceable merge modules.</span></span>](#do-not-distribute-unserviceable-merge-modules)
-   [<span data-ttu-id="4cbfd-130">Избегайте установки исправлений для административных установок.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-130">Avoid patching administrative installations.</span></span>](#avoid-patching-administrative-installations)
-   [<span data-ttu-id="4cbfd-131">Регистрация обновлений для запуска с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-131">Register updates to run with elevated privilege.</span></span>](#register-updates-to-run-with-elevated-privilege)
-   [<span data-ttu-id="4cbfd-132">Используйте таблицу Мсипатчсекуенце для последовательного исправления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-132">Use the MsiPatchSequence Table to sequence patches.</span></span>](#use-the-msipatchsequence-table-to-sequence-patches)
-   [<span data-ttu-id="4cbfd-133">Тщательно протестируйте пакет установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-133">Test the installation package thoroughly.</span></span>](#test-the-installation-package-thoroughly)
-   [<span data-ttu-id="4cbfd-134">Устраните все ошибки проверки перед развертыванием нового или измененного пакета установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-134">Fix all validation errors before deploying a new or revised installation package.</span></span>](#fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package)
-   [<span data-ttu-id="4cbfd-135">Создайте безопасную установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-135">Author a secure installation.</span></span>](#author-a-secure-installation)
-   [<span data-ttu-id="4cbfd-136">Использовать ПМСИХАНДЛЕ вместо HANDLE</span><span class="sxs-lookup"><span data-stu-id="4cbfd-136">Use PMSIHANDLE instead of HANDLE</span></span>](#use-pmsihandle-instead-of-handle)

## <a name="update-the-windows-installer-version"></a><span data-ttu-id="4cbfd-137">Обновите версию установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-137">Update the Windows Installer version.</span></span>

-   <span data-ttu-id="4cbfd-138">Используйте установщик Windows 5,0 в Windows Server 2008 R2 и Windows 7.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-138">Use Windows Installer 5.0 on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="4cbfd-139">Это установщик Windows версия, предоставляемая операционной системой.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-139">This is the Windows Installer version provided with the operating system.</span></span>
-   <span data-ttu-id="4cbfd-140">Используйте установщик Windows 4,5 в Windows Server 2008, Windows Server 2003 с пакетом обновления 1 (SP1), Windows Vista с пакетом обновления 1 (SP1) или Windows XP с пакетом обновления 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-140">Use Windows Installer 4.5 on Windows Server 2008, Windows Server 2003 with Service Pack 1 (SP1), Windows Vista with Service Pack 1 (SP1), or Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="4cbfd-141">Сведения о получении последней версии установщик Windows см. в разделе [установщик Windows распространяемые пакеты](windows-installer-redistributables.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-141">For information about obtaining the latest Windows Installer version, see [Windows Installer Redistributables](windows-installer-redistributables.md).</span></span>
-   <span data-ttu-id="4cbfd-142">Используйте установщик Windows 3,1 в Windows 2000 с пакетом обновления 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-142">Use Windows Installer 3.1 on Windows 2000 with Service Pack 3 (SP3).</span></span> <span data-ttu-id="4cbfd-143">В установщик Windows версии 3,1 есть функции, упрощающие обслуживание приложений и [установку исправлений](patching.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-143">Windows Installer version 3.1 has features that facilitate better application servicing and [patching](patching.md).</span></span>
-   <span data-ttu-id="4cbfd-144">Многие важные функции появились в версии 3,0 и перечислены в разделе, [не поддерживаемом в установщик Windows версии 2,0](not-supported-in-windows-installer-version-2-0.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-144">Many important features were introduced with version 3.0 and are listed in the section [Not Supported in Windows Installer Version 2.0](not-supported-in-windows-installer-version-2-0.md).</span></span> <span data-ttu-id="4cbfd-145">Пакеты установки и обновления, созданные для установщик Windows 2,0, можно установить с помощью установщик Windows 3,0 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-145">Installation packages and updates that were created for Windows Installer 2.0 can be installed using Windows Installer 3.0 and later.</span></span> <span data-ttu-id="4cbfd-146">Пакеты исправлений, содержащие новые таблицы, используемые установщик Windows 3,0, по-прежнему могут применяться в более ранних версиях установщик Windows но без функции исправления установщик Windows 3,0.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-146">Patch packages that contain the new tables used by Windows Installer 3.0 can still be applied using earlier versions of Windows Installer but without the Windows Installer 3.0 patching functionality.</span></span> <span data-ttu-id="4cbfd-147">Кроме того, можно создавать исправления, явно требующие установщик Windows 3,0, которые не могут быть применены в более ранних версиях установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-147">It is also possible to author patches that explicitly require the Windows Installer 3.0 that cannot be applied by earlier versions of Windows Installer.</span></span> <span data-ttu-id="4cbfd-148">Если пользователь не может обновить версию установщика, убедитесь, что приложение или обновление будет совместимо с будущим обновлением установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-148">If a user is unable to update the installer version, ensure that your application or update will be compatible with a future update of the Windows Installer.</span></span>
-   <span data-ttu-id="4cbfd-149">Список функций установщик Windows, не поддерживаемых более ранними версиями установщика Windows, см. в разделе [новые возможности установщик Windows](what-s-new-in-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-149">For a list of the Windows Installer features not supported by earlier versions of the Windows installer see [What's New in Windows Installer](what-s-new-in-windows-installer.md).</span></span>

## <a name="meet-the-windows-logo-certification-requirements"></a><span data-ttu-id="4cbfd-150">Соответствие требованиям к сертификации эмблемы Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-150">Meet the Windows Logo certification requirements.</span></span>

-   <span data-ttu-id="4cbfd-151">Даже если вы не планируете отправлять приложение в программу Logo, следуйте рекомендациям по сертификации с логотипом, чтобы повысить эффективность установщик Windows пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-151">Even if you do not intend to submit your application to the logo program, following the logo certification guidelines can help make your Windows Installer package better.</span></span> <span data-ttu-id="4cbfd-152">Общие сведения о требованиях к логотипам и ссылки на программы сертификации, относящиеся к конкретным логотипам, см. в разделе [требования к установщик Windows и логотипам](windows-installer-and-logo-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-152">For an overview of the logo requirements, and links to specific logo certification programs, see [Windows Installer and Logo Requirements](windows-installer-and-logo-requirements.md).</span></span>

## <a name="prepare-the-package-for-localization"></a><span data-ttu-id="4cbfd-153">Подготовка пакета к локализации.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-153">Prepare the package for localization.</span></span>

-   <span data-ttu-id="4cbfd-154">Рекомендуется подготовиться к будущей локализации при создании исходного пакета установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-154">It is a good practice to prepare for future localization when authoring the original installation package.</span></span> <span data-ttu-id="4cbfd-155">Вы можете выполнить предложенную процедуру локализации пакета в разделе [локализация пакета установщик Windows](localizing-a-windows-installer-package.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-155">You can follow the suggested package localization procedure in [Localizing a Windows Installer Package](localizing-a-windows-installer-package.md).</span></span>

## <a name="update-your-windows-installer-development-tools-and-documentation"></a><span data-ttu-id="4cbfd-156">Обновление средств и документации по разработке установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-156">Update your Windows Installer development tools and documentation.</span></span>

-   <span data-ttu-id="4cbfd-157">[Средства разработки установщик Windows](windows-installer-development-tools.md) не являются распространяемыми, и вы должны использовать только версии этих средств, доступные в корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-157">The [Windows Installer Development Tools](windows-installer-development-tools.md) are not redistributable, and you should only use the versions of these tools available from Microsoft.</span></span> <span data-ttu-id="4cbfd-158">Они доступны в [Windows SDK компонентов для разработчиков установщик Windows](platform-sdk-components-for-windows-installer-developers.md) в пакете средств разработки программного обеспечения (SDK) для Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-158">These are available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="4cbfd-159">Несколько независимых поставщиков программного обеспечения предлагают средства для создания или изменения пакетов установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-159">Several independent software vendors offer tools to create or modify Windows Installer packages.</span></span> <span data-ttu-id="4cbfd-160">Эти средства могут предоставлять среду для создания пакетов, которая может быть проще в использовании, чем средства, предоставляемые пакетом SDK для установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-160">These tools can provide a package authoring environment that may be easier to use than the tools provided in the Windows Installer SDK.</span></span> <span data-ttu-id="4cbfd-161">Дополнительные сведения об этих средствах можно получить из информационных ресурсов, обсуждаемых в [других источниках установщик Windows сведений](other-sources-of-windows-installer-information.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-161">You can learn more about these tools from the information resources discussed in [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md).</span></span>
-   <span data-ttu-id="4cbfd-162">Возможность создания пакета из текстовых файлов может быть более интуитивно понятной для некоторых разработчиков.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-162">The capability to build a package from text files may be more intuitive for some developers.</span></span> <span data-ttu-id="4cbfd-163">Набор средств установщик Windows XML (WiX), доступный в [SourceForge.NET](https://sourceforge.net/projects/wix) , создает пакеты установки Windows из ИСХОДНОГО кода XML.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-163">The Windows Installer XML (WiX) toolset available on [Sourceforge.net](https://sourceforge.net/projects/wix) builds Windows installation packages from XML source code.</span></span>
-   <span data-ttu-id="4cbfd-164">Документация в [пакете SDK установщик Windows](./windows-installer-portal.md) , выпущенная в библиотеке MSDN Online, наиболее часто обновляется.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-164">The documentation in the [Windows Installer SDK](./windows-installer-portal.md) released in the MSDN Online Library is updated the most frequently.</span></span>
-   <span data-ttu-id="4cbfd-165">Используйте последнюю версию [Msizap.exe](msizap-exe.md) (версии 3.1.4000.2726 или выше), которая доступна в [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md) для Windows Vista или более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-165">Use the recent version of [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 or greater) that is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) for Windows Vista or greater.</span></span> <span data-ttu-id="4cbfd-166">Более ранние версии Msizap.exe могут удалять сведения обо всех обновлениях, примененных к другим приложениям на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-166">Lesser versions of Msizap.exe can remove information about all updates that have been applied to other applications on the user's computer.</span></span> <span data-ttu-id="4cbfd-167">Если эта информация будет удалена, для получения дополнительных обновлений может потребоваться удаление и повторная установка этих приложений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-167">If this information is removed, these other applications may need to be removed and reinstalled to receive additional updates.</span></span>
-   <span data-ttu-id="4cbfd-168">Редактор таблиц базы данных [Orca.exe](orca-exe.md) является редактором таблиц базы данных для создания и редактирования пакетов установщик Windows и модулей слияния.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-168">The database table editor [Orca.exe](orca-exe.md) is a database table editor for creating and editing Windows Installer packages and merge modules.</span></span> <span data-ttu-id="4cbfd-169">Он имеет базовый графический интерфейс, но поддерживает расширенные возможности редактирования установщик Windows баз данных.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-169">It has a basic GUI interface but supports advanced editing of Windows Installer databases.</span></span> <span data-ttu-id="4cbfd-170">Даже если вы используете другое приложение в качестве основного средства разработки, вы можете использовать Orca.exe удобно при устранении неполадок и тестировании пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-170">Even if you use another application as your primary development tool, you may find using Orca.exe is convenient when troubleshooting and testing a package.</span></span>
-   <span data-ttu-id="4cbfd-171">См. [другие источники установщик Windows сведений](other-sources-of-windows-installer-information.md) о текущих установщик Windowsх, доступных в блогах, технических обсуждениях, группах новостей, технических статьях и веб-сайтах.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-171">See [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md) for current Windows Installer information available in blogs, technical chats, newsgroups, technical articles, and websites.</span></span>

## <a name="if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices"></a><span data-ttu-id="4cbfd-172">Если вы решили переупаковать устаревшее приложение установки, следуйте рекомендациям по перепакетированию.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-172">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>

<span data-ttu-id="4cbfd-173">Многие поставщики приложений предоставляют собственные пакеты установщик Windows для установки или их продуктов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-173">Many application vendors provide native Windows Installer packages for the installation or their products.</span></span> <span data-ttu-id="4cbfd-174">Программное обеспечение, преобразующее существующее приложение установки прежних версий в пакет установщик Windows, называется средством переупаковки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-174">Software that converts an existing legacy setup application into a Windows Installer package is referred to as a repackaging tool.</span></span> <span data-ttu-id="4cbfd-175">В техническом [руководстве по созданию пакетов установщик Windows и перепакетированию программного обеспечения для установщик Windows](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) описано средство перепакетирования, доступное для коммерческого доступа.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-175">The whitepaper [Step-by-Step Guide to Creating Windows Installer Packages and Repackaging Software for the Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describes a commercially available repackaging tool.</span></span> <span data-ttu-id="4cbfd-176">Перекомпоновка существующего приложения установки не является оптимальной практикой при разработке.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-176">Repackaging an existing setup application is not the best development practice.</span></span> <span data-ttu-id="4cbfd-177">Приложения, разработанные с самого начала, могут быть проще в установке и обслуживании для использования преимуществ функций установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-177">Applications that have been designed from the start to take advantage of Windows Installer features can be easier for users to install and service.</span></span> <span data-ttu-id="4cbfd-178">Если вы решили использовать переупаковку программного обеспечения, приведенные ниже рекомендации помогут вам получить более установщик Windowsный пакет.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-178">If you decide to use a repackaging software the following practices can help you produce a better Windows Installer package.</span></span>

-   <span data-ttu-id="4cbfd-179">Перепакетирование средств преобразуют устаревшие установки в установщик Windowsный пакет, используя изображение промежуточной системы до и после установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-179">Repackaging tools convert legacy installations into a Windows Installer package by taking a picture of a staging system before and after installation.</span></span> <span data-ttu-id="4cbfd-180">Все изменения в реестре, изменения файлов или системные параметры, происходящие во время процесса записи, включаются в установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-180">Any registry changes, file changes, or system setting that occurs during the capture process is included in the installation.</span></span> <span data-ttu-id="4cbfd-181">Настройте оборудование и программное обеспечение компьютера, используемого для повторной упаковки установки, как можно ближе к системе предполагаемого пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-181">Configure the hardware and software of the computer used to repackage the installation as close as possible to the intended user's system.</span></span> <span data-ttu-id="4cbfd-182">Создайте отдельный пакет для каждой конфигурации оборудования.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-182">Create a separate package for each different hardware configuration.</span></span> <span data-ttu-id="4cbfd-183">Переупаковка с помощью чистого промежуточного компьютера.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-183">Repackage using a clean staging computer.</span></span> <span data-ttu-id="4cbfd-184">Удалите все ненужные приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-184">Remove any unnecessary applications.</span></span> <span data-ttu-id="4cbfd-185">Останавливает все ненужные процессы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-185">Stop all unnecessary processes.</span></span> <span data-ttu-id="4cbfd-186">Закройте все ненужные системные службы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-186">Close all non-essential system services.</span></span>
-   <span data-ttu-id="4cbfd-187">Всегда делайте копию исходной установки перед началом работы с ней.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-187">Always make a copy of the original installation before starting to work on it.</span></span> <span data-ttu-id="4cbfd-188">Всегда работает с копией.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-188">Always work on the copy.</span></span> <span data-ttu-id="4cbfd-189">Никогда не останавливайте повторную упаковку до завершения сборки пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-189">Never stop a repackager before it finishes building the package.</span></span> <span data-ttu-id="4cbfd-190">Если пакет переупаковки будет приводить к повреждению пакета, он по-прежнему останется исходным.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-190">If the repackager damages the package you will still have the original.</span></span>
-   <span data-ttu-id="4cbfd-191">Не переупаковывайте обновления программного обеспечения Майкрософт в пакет установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-191">Do not repackage Microsoft software updates into a Windows Installer package.</span></span> <span data-ttu-id="4cbfd-192">Корпорация Майкрософт выпускает обновления программного обеспечения, такие как пакеты обновления, в виде самораскрывающихся файлов, автоматически выполняющих установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-192">Microsoft releases software updates, such as service packs, as self-extracting files that automatically runs installation.</span></span> <span data-ttu-id="4cbfd-193">Эти обновления используют разные установщики, чем установщик Windows для замены защищенных ресурсов Windows и не могут быть преобразованы в пакет установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-193">These updates use different installers than the Windows Installer to replace protected Windows resources and cannot be converted into a Windows Installer package.</span></span> <span data-ttu-id="4cbfd-194">Сведения о развертывании пакетов обновления Windows см. в статье Руководство по развертыванию пакета обновления на [сайте Microsoft TechNet](https://technet.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-194">For information about how to deploy Windows service packs, see the service pack's deployment guide on [Microsoft TechNet](https://technet.microsoft.com/).</span></span>
-   <span data-ttu-id="4cbfd-195">Не используйте средство переупаковки для преобразования пакета установщик Windows в новый пакет.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-195">Do not use a repackaging tool to convert a Windows Installer package into a new package.</span></span> <span data-ttu-id="4cbfd-196">Установщик Windows добавляет сведения о конфигурации в систему, а также ресурсы приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-196">The Windows Installer adds configuration information to the system as well as application resources.</span></span> <span data-ttu-id="4cbfd-197">Когда средство переупаковки сравнивает систему до и после установки, перепакетирование ошибочно интерпретирует сведения о конфигурации как часть приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-197">When a repackaging tool compares the system before and after the installation, the repackager misinterprets the configuration information as part of the application.</span></span> <span data-ttu-id="4cbfd-198">Это обычно повреждает переупакованное приложение.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-198">This usually damages the repackaged application.</span></span> <span data-ttu-id="4cbfd-199">Вместо этого используйте [преобразования настройки](a-customization-transform-example.md) для изменения существующего пакета установщик Windows или создания нового пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-199">Instead use [customization transforms](a-customization-transform-example.md) to modify an existing Windows Installer package, or make an new package.</span></span> <span data-ttu-id="4cbfd-200">Преобразования настройки можно создать с помощью средства [Msitran.exe](msitran-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-200">You can create customization transforms using the [Msitran.exe](msitran-exe.md) tool.</span></span>
-   <span data-ttu-id="4cbfd-201">Не используйте средство переупаковки для объединения нескольких пакетов установщик Windows в один пакет.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-201">Do not use a repackaging tool to consolidate several Windows Installer packages into a single package.</span></span> <span data-ttu-id="4cbfd-202">Вместо этого можно использовать средство [Msistuff.exe](msistuff-exe.md) , чтобы настроить исполняемый файл начальной загрузки Setup.exe для установки пакетов один за другим.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-202">Instead you can use the [Msistuff.exe](msistuff-exe.md) tool to configure the Setup.exe bootstrap executable to install the packages one after another.</span></span>
-   <span data-ttu-id="4cbfd-203">Создайте пакет установщик Windows, чтобы его можно было легко настроить с помощью клиента.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-203">Make your Windows Installer package so that it can be easily customized by the customer.</span></span> <span data-ttu-id="4cbfd-204">Глобальные переменные, используемые установщик Windows во время установки, можно задать с помощью общих [свойств](properties.md) или [преобразований настройки](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-204">Global variables used by the Windows Installer during an installation can be set using public [properties](properties.md) or [customization transforms](a-customization-transform-example.md).</span></span> <span data-ttu-id="4cbfd-205">Предоставьте документацию по использованию этих свойств и практичных значений по умолчанию для всех настраиваемых значений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-205">Provide documentation for the use of those properties and practical default values for all customizable values.</span></span> <span data-ttu-id="4cbfd-206">Дополнительные сведения о получении и установке свойств см. [в разделе Использование свойств](using-properties.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-206">For information about getting and setting properties see [Using Properties](using-properties.md).</span></span> <span data-ttu-id="4cbfd-207">Пример преобразования настройки см. [в примере преобразования настройки](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-207">For an example of a customization transform see [A Customization Transform Example](a-customization-transform-example.md).</span></span>

## <a name="do-not-try-to-replace-protected-resources"></a><span data-ttu-id="4cbfd-208">Не пытайтесь заменить защищенные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-208">Do not try to replace protected resources.</span></span>

<span data-ttu-id="4cbfd-209">Пакеты установщик Windows не должны пытаться заменить защищенные ресурсы во время установки или обновления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-209">Windows Installer packages should not attempt to replace protected resources during installation or update.</span></span> <span data-ttu-id="4cbfd-210">Установщик Windows не удаляет эти ресурсы или не заменяет их, так как Windows предотвращает замену необходимых системных файлов, папок и разделов реестра.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-210">The Windows Installer does not remove or replace these resources because Windows prevents the replacement of essential system files, folders, and registry keys.</span></span> <span data-ttu-id="4cbfd-211">Защита этих ресурсов предотвращает сбои приложений и операционных систем.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-211">Protecting these resources prevents application and operating system failures.</span></span>

-   <span data-ttu-id="4cbfd-212">При работе в Windows Server 2008 или Windows Vista установщик Windows пропускает установку любого файла или раздела реестра, защищенного [Защита ресурсов Windows](../wfp/windows-resource-protection-portal.md) (WRP), установщик вводит предупреждение в файл журнала и остается в оставшейся части установки без ошибки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-212">When running on Windows Server 2008 or Windows Vista, the Windows Installer skips the installation of any file or registry key that is protected by [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) (WRP), the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="4cbfd-213">Дополнительные сведения см. [в разделе использование установщик Windows и защита ресурсов Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-213">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>
-   <span data-ttu-id="4cbfd-214">WRP — это новое имя для защиты файлов Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-214">WRP is the new name for Windows File Protection (WFP).</span></span> <span data-ttu-id="4cbfd-215">WRP защищает разделы и папки реестра, а также ключевые системные файлы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-215">WRP protects registry keys and folders as well as essential system files.</span></span> <span data-ttu-id="4cbfd-216">В Windows Server 2003, Windows XP и Windows 2000, когда установщик Windows обнаружил файл, защищенный с помощью WFP, установщик запрашивает установку файла в WFP.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-216">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span> <span data-ttu-id="4cbfd-217">Дополнительные сведения см. [в разделе использование установщик Windows и защита ресурсов Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-217">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>

## <a name="do-not-depend-upon-non-critical-resources"></a><span data-ttu-id="4cbfd-218">Не зависят от некритических ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-218">Do not depend upon non-critical resources.</span></span>

<span data-ttu-id="4cbfd-219">Установка или обновление не должны зависеть от установки некритических ресурсов по следующим причинам.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-219">Your installation or update should not depend upon the installation of non-critical resources for the following reasons.</span></span>

-   <span data-ttu-id="4cbfd-220">Пользовательские действия могут завершаться ошибкой, если они зависят от компонента, принадлежащего функции, которую пользователь объявляет, а не устанавливает.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-220">Custom actions can fail if they depend upon a component belonging to a feature that the user advertises rather than installs.</span></span>
-   <span data-ttu-id="4cbfd-221">Пользовательские действия, упорядоченные до действия [функции InstallFinalize](installfinalize-action.md) , могут завершиться ошибкой, если они зависят от компонента, содержащего устанавливаемую сборку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-221">Custom actions sequenced before the [InstallFinalize](installfinalize-action.md) action can fail if they depend on a component containing an assembly that is being installed.</span></span> <span data-ttu-id="4cbfd-222">Установщик Windows не фиксирует сборки в глобальном кэше сборок (GAC) до тех пор, пока не завершится действие функции InstallFinalize.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-222">The Windows Installer does not commit assemblies to the Global Assembly Cache (GAC) until the InstallFinalize action completes.</span></span>

## <a name="use-the-api-to-retrieve-windows-installer-configuration-information"></a><span data-ttu-id="4cbfd-223">Используйте API для получения сведений о конфигурации установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-223">Use the API to retrieve Windows Installer configuration information.</span></span>

<span data-ttu-id="4cbfd-224">Установка приложения или обновления не должна зависеть от прямого доступа к установщик Windows сведениям о конфигурации, сохраненным на компьютере.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-224">The installation of your application or update should not depend upon direct access to Windows Installer configuration information saved on your computer.</span></span> <span data-ttu-id="4cbfd-225">Вместо этого используйте установщик Windows программный интерфейс приложения для получения сведений о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-225">Instead use the Windows Installer application programming interface to retrieve configuration information.</span></span> <span data-ttu-id="4cbfd-226">Расположение и формат сведений о конфигурации управляются службой установщик Windows и могут быть изменены.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-226">The location and format of configuration information is managed by the Windows Installer service and can change.</span></span>

-   <span data-ttu-id="4cbfd-227">Функции установки и настройки API установщик Windows описаны в [справочнике по функциям установщика](installer-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-227">The Installation and Configuration Functions of the Windows Installer API are described in the [Installer Function Reference](installer-function-reference.md).</span></span>
-   <span data-ttu-id="4cbfd-228">[Свойства конфигурации](property-reference.md) описаны в справочнике по свойствам.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-228">The [Configuration Properties](property-reference.md) are described in the Property Reference.</span></span>
-   <span data-ttu-id="4cbfd-229">Методы и свойства автоматизации описаны в [справочнике по интерфейсу автоматизации](automation-interface-reference.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-229">The automation methods and properties are described in the [Automation Interface Reference](automation-interface-reference.md).</span></span> <span data-ttu-id="4cbfd-230">Пример скрипта WiLstPrd.vbs подключается к объекту установщика и перечисляет зарегистрированные продукты и сведения о продукте.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-230">The sample script WiLstPrd.vbs connects to an Installer object and enumerates registered products and product information.</span></span> <span data-ttu-id="4cbfd-231">Дополнительные сведения см. в разделе [Список продуктов, свойств, функций и компонентов](list-products-properties-features-and-components.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-231">For information see [List Products, Properties, Features, and Components](list-products-properties-features-and-components.md).</span></span>

## <a name="organize-the-installation-of-your-application-around-components"></a><span data-ttu-id="4cbfd-232">Организуйте установку приложения вокруг компонентов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-232">Organize the installation of your application around components.</span></span>

<span data-ttu-id="4cbfd-233">Служба установщик Windows устанавливает или удаляет коллекции ресурсов, которые называются [компонентами](windows-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-233">The Windows Installer service installs or removes collections of resources referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="4cbfd-234">Поскольку компоненты обычно являются общими, автор пакета установки должен следовать правилам при указании компонентов компонента или приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-234">Because components are commonly shared, the author of an installation package must follow rules when specifying the components of a feature or application.</span></span>

-   <span data-ttu-id="4cbfd-235">Придерживайтесь правил компонентов при [организации приложений в компоненты](organizing-applications-into-components.md) , чтобы обеспечить возможность установки и удаления новых компонентов или новых версий компонентов без повреждения других приложений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-235">Adhere to the component rules when [Organizing Applications into Components](organizing-applications-into-components.md) to ensure that new components, or new versions of components, can be installed and removed without damaging other applications.</span></span> <span data-ttu-id="4cbfd-236">Вы можете выполнить процедуру, описанную в разделе [Определение компонентов установщика](defining-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-236">You can follow the procedure described in [Defining Installer Components](defining-installer-components.md).</span></span>
-   <span data-ttu-id="4cbfd-237">Установщик отслеживает каждый компонент по соответствующему идентификатору GUID компонента, указанному в [таблице Component](component-table.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-237">The installer tracks every component by the respective component ID GUID specified in the [Component table](component-table.md).</span></span> <span data-ttu-id="4cbfd-238">Это важно для работы механизма подсчета ссылок установщик Windows, что идентификатор GUID идентификатора компонента правильный.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-238">It is essential for the operation of the Windows Installer reference-counting mechanism that the component ID GUID is correct.</span></span> <span data-ttu-id="4cbfd-239">Следуйте рекомендациям по [изменению кода компонента](changing-the-component-code.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-239">Follow the guidelines in [Changing the Component Code](changing-the-component-code.md).</span></span>
-   <span data-ttu-id="4cbfd-240">Если пакет должен прерывать правила компонента, следует иметь в виду возможные последствия и убедиться, что установка не устанавливает компоненты, которые могут повредить компоненты в системе пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-240">If your package must break the component rules, be aware of the possible consequences and ensure that your installation never installs these components where they may damage components on the user's system.</span></span> <span data-ttu-id="4cbfd-241">Дополнительные сведения см. [в статье что происходит, если правила компонентов повреждены?](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="4cbfd-241">For information see [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md).</span></span>
-   <span data-ttu-id="4cbfd-242">Помните, как установщик Windows применяет [правила управления версиями файлов](file-versioning-rules.md) при [замене существующих файлов](replacing-existing-files.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-242">Be aware how the Windows Installer applies the [File Versioning Rules](file-versioning-rules.md) when [Replacing Existing Files](replacing-existing-files.md).</span></span> <span data-ttu-id="4cbfd-243">Установщик Windows сначала определяет, установлен ли файл ключа компонента, прежде чем пытаться установить какие-либо файлы компонента.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-243">The Windows Installer first determines whether the component's key file is already installed before attempting to install any of the files of the component.</span></span> <span data-ttu-id="4cbfd-244">Если установщик находит файл с тем же именем, что и файл ключей компонента, установленный в целевом расположении, он сравнивает версию, дату и язык двух ключевых файлов и использует правила управления версиями файлов, чтобы определить, следует ли установить компонент, предоставленный пакетом.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-244">If the installer finds a file with the same name as the component's key file installed in the target location, it compares the version, date, and language of the two key files and uses file versioning rules to determine whether to install the component provided by the package.</span></span> <span data-ttu-id="4cbfd-245">Если установщик определит, что он должен заменить базу компонента на файл ключа, то он использует правила управления версиями файлов для каждого установленного файла, чтобы определить, следует ли заменить этот файл.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-245">If the installer determines it needs to replace the component base upon the key file, then it uses the file versioning rules on each installed file to determine whether to replace the file.</span></span>

## <a name="reduce-the-size-of-large-windows-installer-packages"></a><span data-ttu-id="4cbfd-246">Сократите размер больших пакетов установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-246">Reduce the size of large Windows Installer packages.</span></span>

<span data-ttu-id="4cbfd-247">Очень крупные пакеты Windows принимают системные ресурсы и могут быть сложными для установки пользователями.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-247">Very large Windows Packages take system resources and can be difficult for users to install.</span></span> <span data-ttu-id="4cbfd-248">Рекомендуется уменьшить размер очень больших установщик Windows пакетов следующими методами.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-248">It is good practice to reduce the size of very large Windows Installer Packages by the following methods.</span></span>

-   <span data-ttu-id="4cbfd-249">Сжимать файлы в установке и сохранять их в CAB-файле.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-249">Compress the files in the installation and store them in a cabinet (.cab) file .</span></span> <span data-ttu-id="4cbfd-250">Установщик позволяет хранить CAB-файл в отдельном внешнем файле или в виде потока данных в самом пакете MSI.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-250">The Installer allows the .cab file to be stored as a separate external file, or as a data stream in the MSI package itself.</span></span> <span data-ttu-id="4cbfd-251">Дополнительные сведения см. [в разделе Использование ящиков и сжатых источников](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-251">For information see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>
-   <span data-ttu-id="4cbfd-252">Удалите неиспользуемое дисковое пространство в MSI-файле, используя один из параметров, описанных в разделе [уменьшение размера MSI-файла](reducing-the-size-of-an--msi-file.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-252">Remove wasted storage space in the .msi file using one of the options discussed in [Reducing the Size of an .msi File](reducing-the-size-of-an--msi-file.md).</span></span>
-   <span data-ttu-id="4cbfd-253">Если пакет установщик Windows содержит более 32767 файлов, необходимо изменить схему базы данных.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-253">If your Windows Installer package contains more than 32767 files, you must change the schema of the database.</span></span> <span data-ttu-id="4cbfd-254">Дополнительные сведения см. [в разделе Создание большого пакета](authoring-a-large-package.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-254">For information see [Authoring a Large Package](authoring-a-large-package.md).</span></span>

## <a name="if-you-use-custom-actions-follow-good-custom-action-practices"></a><span data-ttu-id="4cbfd-255">При использовании настраиваемых действий следуйте хорошим рекомендациям по настраиваемым действиям.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-255">If you use custom actions, follow good custom action practices.</span></span>

<span data-ttu-id="4cbfd-256">В установщик Windows имеется множество встроенных [стандартных действий](standard-actions-reference.md) для установки и обслуживания приложений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-256">The Windows Installer has many built-in [standard actions](standard-actions-reference.md) for the installation and maintenance of applications.</span></span> <span data-ttu-id="4cbfd-257">Разработчики должны попытаться полагаться на стандартные действия максимально практично, а не создавать собственные [пользовательские действия](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-257">Developers should attempt to rely upon the standard actions as much as practical, rather than create their own [custom actions](custom-actions.md).</span></span> <span data-ttu-id="4cbfd-258">Однако существуют ситуации, когда разработчик пакета установки находит необходимость в написании настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-258">However, there are situations where the developer of an installation package finds it necessary to write a custom action.</span></span>

-   <span data-ttu-id="4cbfd-259">Следуйте рекомендациям по [использованию настраиваемых действий](using-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-259">Follow the guidelines for [Using Custom Actions](using-custom-actions.md).</span></span>
-   <span data-ttu-id="4cbfd-260">Следуйте [рекомендациям по защите настраиваемых действий](guidelines-for-securing-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-260">Follow the [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span> <span data-ttu-id="4cbfd-261">Пользовательские действия, использующие конфиденциальные данные, не должны записывать эту информацию в журнал.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-261">Custom actions that use sensitive information should not write this information into the log.</span></span> <span data-ttu-id="4cbfd-262">Дополнительные сведения см. в статье [Безопасность настраиваемых действий](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-262">For information see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="4cbfd-263">Настраиваемые действия не должны пытаться задать точку входа для восстановления системы в рамках настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-263">Custom Actions must not attempt to set a System Restore entry point from within a custom action.</span></span> <span data-ttu-id="4cbfd-264">Дополнительные сведения см. в разделе [Установка точки восстановления из настраиваемого действия](setting-a-restore-point-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-264">For information see [Setting a restore point from a Custom Action](setting-a-restore-point-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="4cbfd-265">Возвращают сообщения об ошибках из пользовательских действий и записывают их в журнал, чтобы упростить устранение неполадок настраиваемых действий.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-265">Return error messages from custom actions and write them to the log to facilitate troubleshooting custom actions.</span></span> <span data-ttu-id="4cbfd-266">Сведения см. в разделе [сообщения об ошибках пользовательские действия](error-message-custom-actions.md) и [возвращение сообщений об ошибках из настраиваемых действий](returning-error-messages-from-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-266">For information see [Error Message Custom Actions](error-message-custom-actions.md) and [Returning Error Messages from Custom Actions](returning-error-messages-from-custom-actions.md).</span></span>
-   <span data-ttu-id="4cbfd-267">Не изменяйте состояние системы с непосредственным пользовательским действием.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-267">Do not change the system state from an immediate custom action.</span></span> <span data-ttu-id="4cbfd-268">Настраиваемые действия, которые изменяют систему напрямую или вызывают другую системную службу, должны быть отложены до момента выполнения скрипта установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-268">Custom actions that change the system directly or call another system service must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="4cbfd-269">Для каждого [отложенного выполнения настраиваемого действия](deferred-execution-custom-actions.md) , которое изменяет состояние системы, должно предшествовать [настраиваемое действие отката](rollback-custom-actions.md) для отмены изменения состояния системы при откате установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-269">Every [deferred execution custom action](deferred-execution-custom-actions.md) that changes the system state must be preceded by a [rollback custom action](rollback-custom-actions.md) to undo the system state change on an installation rollback.</span></span> <span data-ttu-id="4cbfd-270">Дополнительные сведения см. в разделе [изменение состояния системы с помощью настраиваемого действия](changing-the-system-state-using-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-270">For information see [Changing the System State Using a Custom Action](changing-the-system-state-using-a-custom-action.md).</span></span>
-   <span data-ttu-id="4cbfd-271">Настраиваемые действия, выполняющие сложные операции установки, должны быть [исполняемым файлом](executable-files.md) или [библиотекой динамической компоновки](dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-271">Custom actions that perform complex installation operations should be an [executable file](executable-files.md) or [dynamic-link library](dynamic-link-libraries.md).</span></span> <span data-ttu-id="4cbfd-272">Ограничьте использование настраиваемых действий на основе [скриптов](scripts.md) для выполнения простых операций установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-272">Limit the use of custom actions based on [scripts](scripts.md) to simple installation operations.</span></span>
-   <span data-ttu-id="4cbfd-273">Предоставьте сведения о том, что пользовательское действие делает с системой легко обнаруживаемым для системных администраторов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-273">Make the details of what your custom action does to the system easily discoverable to system administrators.</span></span> <span data-ttu-id="4cbfd-274">Добавьте сведения о записях и файлах реестра, используемых пользовательским действием, в пользовательскую таблицу и изучите настраиваемое действие из этой таблицы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-274">Put the details of registry entries and files used by your custom action into a custom table and have the custom action read from this table.</span></span> <span data-ttu-id="4cbfd-275">Это продемонстрировано в примере [использования настраиваемого действия для создания учетных записей пользователей на локальном компьютере](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-275">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span> <span data-ttu-id="4cbfd-276">Сведения о добавлении пользовательских таблиц в базу данных см. в разделе [Работа с запросами](working-with-queries.md) и [примеры запросов к базе данных с помощью SQL и скрипта](examples-of-database-queries-using-sql-and-script.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-276">For information on adding custom tables to a database, see [Working with Queries](working-with-queries.md) and [Examples of Database Queries Using SQL and Script](examples-of-database-queries-using-sql-and-script.md).</span></span>
-   <span data-ttu-id="4cbfd-277">Пользовательские действия не должны отображать диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-277">A custom actions should not display a dialog box.</span></span> <span data-ttu-id="4cbfd-278">Пользовательские действия, для которых необходим пользовательский интерфейс, могут использовать вместо этого функцию [**мсипроцессмессаже**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-278">Custom actions requiring a user interface can use the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function instead.</span></span> <span data-ttu-id="4cbfd-279">См. раздел [Отправка сообщений в установщик Windows с помощью мсипроцессмессаже](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-279">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>
-   <span data-ttu-id="4cbfd-280">Настраиваемые действия не должны использовать функции, перечисленные на странице: [функции, не предназначенные для использования в пользовательских действиях](functions-not-for-use-in-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-280">Custom actions must not use any of the functions listed on the page: [Functions Not for Use in Custom Actions](functions-not-for-use-in-custom-actions.md).</span></span>
-   <span data-ttu-id="4cbfd-281">Если установка предназначена для работы на сервере терминалов, проверьте, что все настраиваемые действия могут выполняться на сервере терминалов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-281">If the installation is intended to run on a terminal server, test that all your custom actions are capable of running on a terminal server.</span></span> <span data-ttu-id="4cbfd-282">Дополнительные сведения см. в разделе свойство [**терминалсервер**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-282">For more information see [**TerminalServer**](terminalserver.md) property.</span></span>
-   <span data-ttu-id="4cbfd-283">Чтобы пользовательское действие выполнялось при удалении определенного исправления, пользовательское действие должно присутствовать в исходном приложении или быть исправлением для продукта, который всегда применяется.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-283">To have a custom action run when a particular patch is uninstalled the custom action must either be present in the original application or be in a patch for the product that is always applied.</span></span> <span data-ttu-id="4cbfd-284">Дополнительные сведения см. в статье [Удаление исправлений с применением настраиваемых действий](patch-uninstall-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-284">For more information see [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span></span>
-   <span data-ttu-id="4cbfd-285">Пользовательские действия не должны использовать уровень пользовательского интерфейса в качестве условия для отправки сообщений об ошибках в установщик, так как это может повлиять на ведение журнала и внешние сообщения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-285">Custom actions should not use the UI level as a condition for sending error messages to the installer because this can interfere with logging and external messages.</span></span> <span data-ttu-id="4cbfd-286">Дополнительные сведения см. в разделе [Определение уровня пользовательского интерфейса из настраиваемого действия](determining-ui-level-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-286">For information see [Determining UI Level from a Custom Action](determining-ui-level-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="4cbfd-287">Используйте условные операторы и [Синтаксис условных операторов](conditional-statement-syntax.md) , чтобы убедиться, что пакет правильно запускает пользовательские действия, не выполняет пользовательские действия или выполняет другое настраиваемое действие при удалении пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-287">Use conditional statements and [Conditional Statement Syntax](conditional-statement-syntax.md) to ensure that your package correctly runs custom actions, does not run a custom actions, or runs alternate custom action when the package is uninstalled.</span></span> <span data-ttu-id="4cbfd-288">Проверка правильности работы пакета при [удалении настраиваемых действий](uninstalling-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-288">Test that the package works as expected when [uninstalling custom actions](uninstalling-custom-actions.md).</span></span> <span data-ttu-id="4cbfd-289">Дополнительные сведения см. [в статье условия выполнения действий во время удаления](conditioning-actions-to-run-during-removal.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-289">For information see [Conditioning Actions to Run During Removal](conditioning-actions-to-run-during-removal.md)</span></span>
-   <span data-ttu-id="4cbfd-290">Если установка должна быть выполнена пользователями, не имеющими прав администратора, проверьте, чтобы все настраиваемые действия выполнялись с правами, не являющимися администраторами.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-290">If the installation must be capable of being run by users that do not have administrator privileges, test to ensure that all the custom actions can be run with non-administrator privileges.</span></span> <span data-ttu-id="4cbfd-291">Настраиваемые действия требуют повышенных привилегий для изменения частей системы, не зависящих от пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-291">Custom actions require elevated privileges to modify parts of the system that are not user specific.</span></span> <span data-ttu-id="4cbfd-292">Установщик может выполнять пользовательские действия с повышенными привилегиями при установке управляемого приложения или при указании системной политики для повышенных привилегий.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-292">The installer may run custom actions with elevated privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="4cbfd-293">Любые настраиваемые действия, требующие повышенных привилегий, должны включать в себя [настраиваемое действие мсидбкустомактионтипеинскрипт и msidbCustomActionTypeNoImpersonate In-Script параметры выполнения](custom-action-in-script-execution-options.md) в типе настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-293">Any custom actions the require elevated privileges must include the msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) in the custom action type.</span></span> <span data-ttu-id="4cbfd-294">Это продемонстрировано в примере [использования настраиваемого действия для создания учетных записей пользователей на локальном компьютере](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-294">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span>

## <a name="if-you-use-assemblies-follow-good-assembly-practices"></a><span data-ttu-id="4cbfd-295">Если вы используете сборки, следуйте хорошим рекомендациям по сборке</span><span class="sxs-lookup"><span data-stu-id="4cbfd-295">If you use assemblies, follow good assembly practices</span></span>

<span data-ttu-id="4cbfd-296">Если пакет использует [сборки](assemblies.md)программного обеспечения, следуйте рекомендациям по [добавлению сборок в пакет](adding-assemblies-to-a-package.md), [обновлению сборок](updating-assemblies.md), [установке и удалению сборок](installing-and-removing-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-296">If your package uses software [assemblies](assemblies.md), follow the guidelines for [Adding Assemblies to a Package](adding-assemblies-to-a-package.md), [Updating Assemblies](updating-assemblies.md), and [Installing and Removing Assemblies](installing-and-removing-assemblies.md).</span></span>

## <a name="do-not-ship-concurrent-installations"></a><span data-ttu-id="4cbfd-297">Не поставлять параллельные установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-297">Do not ship concurrent installations.</span></span>

<span data-ttu-id="4cbfd-298">[Параллельные установки](concurrent-installations.md), также называемые вложенными установками, устанавливают другой пакет установщик Windows во время выполнения текущей установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-298">[Concurrent Installations](concurrent-installations.md), also called Nested Installations, install another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="4cbfd-299">Использование параллельных установок не является хорошей практикой, поскольку они трудно обслуживать клиентам.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-299">The use of concurrent installations is not a good practice because they are difficult for customers to service.</span></span> <span data-ttu-id="4cbfd-300">Установка исправлений и обновления может не работать одновременно с параллельной установкой.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-300">Patching and upgrading may not work with concurrent installations.</span></span> <span data-ttu-id="4cbfd-301">Вместо этого рекомендуется использовать приложение установки и внешний обработчик пользовательского интерфейса для последовательной установки нескольких пакетов установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-301">The recommended alternative to using concurrent installations is to instead use a setup application and external UI handler to install several Windows Installer packages sequentially.</span></span>

<span data-ttu-id="4cbfd-302">Дополнительные сведения об использовании внешнего обработчика пользовательского интерфейса см. в разделе [мониторинг установки с помощью мсисетекстерналуи](monitoring-an-installation-using-msisetexternalui.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-302">For more information about using an external UI handler see [Monitoring an Installation Using MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span></span> <span data-ttu-id="4cbfd-303">Дополнительные сведения об использовании внешнего обработчика на основе записей см. в разделе [мониторинг установки с помощью мсисетекстерналуирекорд](monitoring-an-installation-using-msisetexternaluirecord.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-303">For more information about using a record-based external handler, see [Monitoring an Installation Using MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span></span>

<span data-ttu-id="4cbfd-304">Параллельные установки иногда используются в контролируемых корпоративных средах для установки приложений, которые не предназначены для общего использования.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-304">Concurrent installations are sometimes used in controlled corporate environments to install applications that are not intended for the public.</span></span> <span data-ttu-id="4cbfd-305">Если вы решили использовать параллельные установки, следуйте этим рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-305">Follow these guidelines if you decide to use concurrent installations.</span></span>

-   <span data-ttu-id="4cbfd-306">Не используйте параллельные установки для установки или обновления поставляемого продукта.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-306">Do not use concurrent installations to install or update a shipping product.</span></span>
-   <span data-ttu-id="4cbfd-307">Параллельные установки не должны предоставлять общий доступ к компонентам.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-307">Concurrent installations should not share components.</span></span>
-   <span data-ttu-id="4cbfd-308">Административная установка не должна содержать параллельную установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-308">An administrative installation should not contain a concurrent installation.</span></span>
-   <span data-ttu-id="4cbfd-309">Интегрированные компоненты ProgressBar не следует использовать с параллельными установками.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-309">Integrated ProgressBars should not be used with concurrent installations.</span></span>
-   <span data-ttu-id="4cbfd-310">Ресурсы, которые должны быть объявлены, не должны устанавливаться параллельно установкой.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-310">Resources that are to be advertised should not be installed by a concurrent installation.</span></span>
-   <span data-ttu-id="4cbfd-311">Пакет, выполняющий параллельную установку приложения, должен также удалить параллельное приложение при удалении родительского продукта.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-311">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span> <span data-ttu-id="4cbfd-312">Вложенная установка находится в контексте родительского продукта в окне Установка и удаление программ на панели управления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-312">A nested installation exists under the context of the parent product in the Add/Remove Programs in Control Panel.</span></span>

## <a name="keep-package-names-and-package-codes-consistent"></a><span data-ttu-id="4cbfd-313">Обеспечьте единообразие имен пакетов и кодов пакетов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-313">Keep package names and package codes consistent.</span></span>

<span data-ttu-id="4cbfd-314">Файлу. msi можно присвоить любое имя, которое помогает пользователям определять пакет, но имя не должно изменяться без изменения кода продукта.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-314">The .msi file can be given any name that helps users identify the package, but the name should not be changed without also changing the product code.</span></span>

-   <span data-ttu-id="4cbfd-315">Присвойте файлу MSI понятное имя, которое позволяет пользователю указать содержимое пакета установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-315">Give your .msi file a user-friendly name that enables the user to identify the contents of the Windows Installer package.</span></span>
-   <span data-ttu-id="4cbfd-316">[Код продукта](product-codes.md) — это основная идентификация приложения, которая должна изменяться при полном обновлении приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-316">The [product code](product-codes.md) is the principal identification of an application and must change whenever there is a comprehensive update to the application.</span></span> <span data-ttu-id="4cbfd-317">Дополнительные сведения см. в разделе [**ProductCode**](productcode.md) и [изменение кода продукта](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-317">For information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="4cbfd-318">Изменение имени MSI-файла приложения считается исчерпывающим изменением, и для поддержания согласованности всегда требуется соответствующее изменение кода продукта.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-318">Changing the name of the application's .msi file is considered a comprehensive change and always requires a corresponding change of the product code to maintain consistency.</span></span>
-   <span data-ttu-id="4cbfd-319">[Код пакета](package-codes.md) — это основной идентификатор, используемый установщиком для поиска и проверки правильности пакета для данной установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-319">The [package code](package-codes.md) is the primary identifier used by the installer to search for and validate the correct package for a given installation.</span></span> <span data-ttu-id="4cbfd-320">Ни один из двух неидентичных MSI-файлов никогда не должен иметь одинаковый код пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-320">No two nonidentical .msi files should ever have the same package code.</span></span> <span data-ttu-id="4cbfd-321">Если пакет изменен без изменения кода пакета, установщик может не использовать более новый пакет, если оба по-прежнему доступны для установщика.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-321">If a package is changed without changing the package code, the installer may not use the newer package if both are still accessible to the installer.</span></span> <span data-ttu-id="4cbfd-322">Код пакета хранится в свойстве [**Сводка номера редакции**](revision-number-summary.md) [информационного потока сводки](summary-information-stream.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-322">The package code is stored in the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
-   <span data-ttu-id="4cbfd-323">Обратите внимание, что буквы в коде продукта и [идентификаторах GUID](guid.md) кода пакета должны быть в верхнем регистре.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-323">Note that letters in product code and package code [GUIDs](guid.md) must all be uppercase.</span></span>

## <a name="do-not-use-the-selfreg-and-typelib-tables"></a><span data-ttu-id="4cbfd-324">Не используйте таблицы Селфрег и TypeLib.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-324">Do not use the SelfReg and TypeLib tables.</span></span>

-   <span data-ttu-id="4cbfd-325">Авторы пакета установки настоятельно рекомендуется использовать собственную регистрацию и таблицу [селфрег](selfreg-table.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-325">Installation package authors are strongly advised against using self registration and the [SelfReg](selfreg-table.md) table.</span></span> <span data-ttu-id="4cbfd-326">Вместо этого они должны регистрировать модули путем создания одной или нескольких таблиц в группе « [таблицы реестра](registry-tables-group.md)».</span><span class="sxs-lookup"><span data-stu-id="4cbfd-326">Instead they should register modules by authoring one or more of the tables in the [Registry Tables Group](registry-tables-group.md).</span></span> <span data-ttu-id="4cbfd-327">Многие преимущества установщик Windows теряются при самостоятельной регистрации, так как подпрограммы самостоятельной регистрации, как правило, скрывают важную информацию о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-327">Many of the benefits of the Windows Installer are lost with self registration because self-registration routines tend to hide critical configuration information.</span></span> <span data-ttu-id="4cbfd-328">Список причин для предотвращения самостоятельной регистрации см. в [таблице селфрег](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-328">For a list of the reasons for avoiding self registration see [SelfReg table](selfreg-table.md).</span></span>
-   <span data-ttu-id="4cbfd-329">Авторы пакета установки настоятельно рекомендуем использовать таблицу [typelib](typelib-table.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-329">Installation package authors are strongly advised against using the [TypeLib](typelib-table.md) table.</span></span> <span data-ttu-id="4cbfd-330">Вместо использования таблицы TypeLib зарегистрируйте библиотеки типов с помощью таблицы [Registry](registry-table.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-330">Instead of using the TypeLib table, register type libraries by using [Registry](registry-table.md) table.</span></span> <span data-ttu-id="4cbfd-331">Если установка, использующая таблицу TypeLib, завершается ошибкой и должна быть выполнена откат, то откат может не восстановить состояние компьютера, существовавшего до отката.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-331">If an installation using the TypeLib table fails and must be rolled back, the rollback may not restore the computer to the same state that existed prior to the rollback.</span></span>

## <a name="provide-the-option-to-install-without-a-user-interface"></a><span data-ttu-id="4cbfd-332">Укажите параметр для установки без пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-332">Provide the option to install without a user interface.</span></span>

<span data-ttu-id="4cbfd-333">Администраторы часто предпочитают развертывать приложения в корпорации, не требуя вмешательства пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-333">Administrators often prefer to deploy applications within a corporation without requiring user interaction.</span></span> <span data-ttu-id="4cbfd-334">Рекомендуется предоставить приложению возможность установки с [уровнем пользовательского интерфейса](user-interface-levels.md) "нет".</span><span class="sxs-lookup"><span data-stu-id="4cbfd-334">It is good practice to enable your application to provide the option of being installed with the [user interface level](user-interface-levels.md) of None.</span></span>

-   <span data-ttu-id="4cbfd-335">Используйте [Общие свойства](public-properties.md) для получения сведений о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-335">Use [public properties](public-properties.md) for configuration information.</span></span> <span data-ttu-id="4cbfd-336">Администраторы могут предоставить эту информацию в командной строке.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-336">Administrators can provide this information on the command-line.</span></span>
-   <span data-ttu-id="4cbfd-337">Не требуется, чтобы установка зависела от сведений, собранных при взаимодействии с пользователем с диалоговыми окнами.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-337">Do not require that the installation depend upon information gathered from user interaction with dialog boxes.</span></span> <span data-ttu-id="4cbfd-338">Эта информация недоступна во время автоматической установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-338">This information is not available during a silent installation.</span></span>
-   <span data-ttu-id="4cbfd-339">Не перезапускайте компьютер пользователя автоматически во время автоматической установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-339">Do not automatically restart the user's computer during a silent installation.</span></span>
-   <span data-ttu-id="4cbfd-340">Администраторы могут задать [уровень пользовательского интерфейса](user-interface-levels.md) при установке с помощью [параметра командной строки](command-line-options.md) "/q".</span><span class="sxs-lookup"><span data-stu-id="4cbfd-340">Administrators can set the [user interface level](user-interface-levels.md) when installing by using the [command line option](command-line-options.md) "/q".</span></span> <span data-ttu-id="4cbfd-341">Уровень пользовательского интерфейса также можно настроить программно с помощью вызова [**мсисетинтерналуи**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-341">The user interface level can also be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span></span>

## <a name="avoid-using-the-alwaysinstallelevated-policy"></a><span data-ttu-id="4cbfd-342">Избегайте использования политики AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-342">Avoid using the AlwaysInstallElevated policy.</span></span>

<span data-ttu-id="4cbfd-343">Если политика [AlwaysInstallElevated](alwaysinstallelevated.md) не задана, то приложения, распространяемые администратором, устанавливаются с использованием привилегий пользователя, и только управляемые приложения получают повышенные привилегии.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-343">If the [AlwaysInstallElevated](alwaysinstallelevated.md) policy is not set, applications not distributed by the administrator are installed using the user's privileges and only managed applications get elevated privileges.</span></span> <span data-ttu-id="4cbfd-344">Установка этой политики направляет установщик Windows использовать системные разрешения при установке приложения в системе.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-344">Setting this policy directs Windows Installer to use system permissions when it installs the application on the system.</span></span> <span data-ttu-id="4cbfd-345">Этот метод может открыть компьютер под угрозу безопасности, так как при установке этой политики пользователь без прав администратора может запускать установки с [*повышенными*](e-gly.md) привилегиями и получать доступ к защищенным расположениям на компьютере.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-345">This method can open a computer to a security risk, because when this policy is set, a non-administrator user can run installations with [*elevated*](e-gly.md) privileges and access secure locations on the computer.</span></span> <span data-ttu-id="4cbfd-346">Рекомендуется использовать другой метод, отличный от политики AlwaysInstallElevated при [установке пакета с повышенными привилегиями для неадминистратора](installing-a-package-with-elevated-privileges-for-a-non-admin.md) или [исправления Per-User управляемых приложениях](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-346">It is a good practice to use another method than the AlwaysInstallElevated policy when [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) or [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

## <a name="enable-the-disablemedia-policy-to-limit-unauthorized-installation"></a><span data-ttu-id="4cbfd-347">Включите политику Дисаблемедиа, чтобы ограничить несанкционированную установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-347">Enable the DisableMedia policy to limit unauthorized installation.</span></span>

<span data-ttu-id="4cbfd-348">Политика [дисаблемедиа](disablemedia.md) может препятствовать несанкционированной установке приложений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-348">The [DisableMedia](disablemedia.md) policy can prevent unauthorized installation of applications.</span></span> <span data-ttu-id="4cbfd-349">Если эта политика включена, пользователи и администраторы, выполняющие установку одного продукта, не смогут использовать диалоговое окно "Обзор" для просмотра источников мультимедиа, таких как CD-ROM, для источников других устанавливаемых продуктов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-349">When this policy is enabled, users and administrators running a maintenance installation of one product are prevented from using the Browse Dialog to browse media sources, such as CD-ROM, for the sources of other installable products.</span></span> <span data-ttu-id="4cbfd-350">Просмотр других продуктов запрещается независимо от того, выполняется ли установка с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-350">Browsing for other products is prevented regardless of whether the installation is done with elevated privileges.</span></span> <span data-ttu-id="4cbfd-351">Пользователь по-прежнему может переустановить продукт с носителя, если у пользователя есть правильно помеченный источник мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-351">It is still possible for the user to reinstall the product from media if the user has a correctly labeled media source.</span></span>

## <a name="keep-the-original-package-source-files-secure-and-available-to-users"></a><span data-ttu-id="4cbfd-352">Обеспечьте безопасность и доступность исходных исходных файлов пакета для пользователей.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-352">Keep the original package source files secure and available to users.</span></span>

<span data-ttu-id="4cbfd-353">В некоторых случаях для установки по запросу, восстановления или обновления приложения может потребоваться исходный источник установщик Windows пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-353">In some cases the original source of the Windows Installer package may be needed to install-on-demand, repair, or update an application.</span></span> <span data-ttu-id="4cbfd-354">Если установщик не может найти доступный источник данных, пользователю предлагается предоставить носитель или подключиться к сетевому расположению, содержащему необходимые источники.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-354">If the installer is unable to locate an available source, the user is asked to provide media or to go to a network location containing the needed sources.</span></span> <span data-ttu-id="4cbfd-355">Рекомендуется убедиться, что у установщика есть необходимые вам источники, без запроса пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-355">It is a good practice to ensure that the installer has the sources it needs without having to prompt the user.</span></span>

-   <span data-ttu-id="4cbfd-356">Используйте [цифровые подписи и внешние CAB-файлы](digital-signatures-and-external-cabinet-files.md) , чтобы обеспечить безопасность используемых установщиком источников orig.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-356">Use [Digital Signatures and External Cabinet Files](digital-signatures-and-external-cabinet-files.md) to ensure that the origial sources being used by the installer are secure.</span></span> <span data-ttu-id="4cbfd-357">Несжатый исходный образ, хранящийся в общедоступном расположении, не является безопасным.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-357">An uncompressed source image stored in an public location is not secure.</span></span>
-   <span data-ttu-id="4cbfd-358">Включите полный список сетевых или URL-адресов исходных путей к пакету установки приложения в свойстве [**SourceList**](sourcelist.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-358">Include a complete list of network or URL source paths to the application's installation package in the [**SOURCELIST**](sourcelist.md) property.</span></span>
-   <span data-ttu-id="4cbfd-359">Используйте общий ресурс распределенная файловая система (DFS) для исходного пути.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-359">Use a Distributed File System (DFS) share for the source path.</span></span>
-   <span data-ttu-id="4cbfd-360">Используйте установщик Windows API для получения и изменения сведений о списке источников для установщик Windows приложений и исправлений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-360">Use the Windows Installer API to retrieve and modify source list information for Windows Installer applications and patches.</span></span> <span data-ttu-id="4cbfd-361">Дополнительные сведения см. в статье [Управление источниками установки](managing-installation-sources.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-361">For information see [Managing Installation Sources](managing-installation-sources.md).</span></span>
-   <span data-ttu-id="4cbfd-362">Используйте методы и свойства [**объекта установщика**](installer-object.md), [**объекта Product**](product-object.md)и [**объекта Patch**](patch-object.md) для получения и изменения сведений о списке источников для установщик Windows приложений и исправлений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-362">Use the methods and properties of the [**Installer Object**](installer-object.md), [**Product Object**](product-object.md), and [**Patch Object**](patch-object.md) to retrieve and modify source list information for Windows Installer applications and patches.</span></span>
-   <span data-ttu-id="4cbfd-363">Придерживайтесь с точкими, перечисленными в поле [предотвращение необходимости доступа к исходным исходным](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) точкам установки, чтобы не допустить появления необходимых исправлений доступа к исходным источникам.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-363">Adhere to points listed in [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) points to minimize the possibility that your patch will require access to the original sources.</span></span>
-   <span data-ttu-id="4cbfd-364">Храните исходные файлы пакета в расположении, которое не является временной папкой системы.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-364">Store the package source files in a location that is not the system's temporary folder.</span></span> <span data-ttu-id="4cbfd-365">Установщик Windows исходные файлы, хранящиеся во временной папке, могут стать недоступными для пользователей.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-365">Windows Installer source files stored in the temporary folder can become unavailable to users.</span></span>

## <a name="enable-verbose-logging-on-users-computer-when-troubleshooting-deployment"></a><span data-ttu-id="4cbfd-366">Включите подробное ведение журнала на компьютере пользователя при устранении неполадок развертывания.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-366">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>

<span data-ttu-id="4cbfd-367">[Установщик Windows ведение журнала](windows-installer-logging.md) включает параметр подробного ведения журнала, который можно включить на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-367">[Windows Installer Logging](windows-installer-logging.md) includes a verbose logging option that can be enabled on a user's computer.</span></span> <span data-ttu-id="4cbfd-368">Сведения в подробном журнале могут пригодиться при устранении неполадок при установщик Windows развертывания пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-368">The information in a verbose log can helpful when trying to troubleshoot Windows Installer package deployment.</span></span>

-   <span data-ttu-id="4cbfd-369">Вы можете включить подробное ведение журнала на компьютере пользователя с помощью [параметров командной строки](command-line-options.md), свойства [**Мсилоггинг**](msilogging.md) , [политики ведения журнала](logging.md), [**мсиенаблелог**](/windows/desktop/api/Msi/nf-msi-msienableloga)и метода [**EnableLog**](installer-enablelog.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-369">You can enable verbose logging on the user's computer by using [Command Line Options](command-line-options.md), the [**MsiLogging**](msilogging.md) property, [Logging policy](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga), and [**EnableLog**](installer-enablelog.md) method.</span></span>
-   <span data-ttu-id="4cbfd-370">Очень полезным ресурсом для интерпретации установщик Windows файлов журнала является [Wilogutl.exe](wilogutl-exe.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-370">A very useful resource for interpreting Windows Installer log files is [Wilogutl.exe](wilogutl-exe.md).</span></span> <span data-ttu-id="4cbfd-371">Это средство помогает анализировать файлы журнала и отображать предлагаемые решения для ошибок, обнаруженных в файле журнала.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-371">This tool assists the analysis of log files and displays suggested solutions to errors that are found in a log file.</span></span>
-   <span data-ttu-id="4cbfd-372">Дополнительные сведения об интерпретации файлов журналов установщик Windows см. в техническом документе на сайте TechNet: [установщик Windows: преимущества и реализация для системных администраторов](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-372">For more information about interpreting Windows Installer log files, see the white paper available on the TechNet site: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span></span>
-   <span data-ttu-id="4cbfd-373">Параметр подробного ведения журнала следует использовать только для устранения неполадок и не должен быть включен, поскольку он может оказать негативное воздействие на производительность системы и дисковое пространство.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-373">The verbose logging option should be used only for troubleshooting purposes and should not be left on because it can have adverse effects on system performance and disk space.</span></span> <span data-ttu-id="4cbfd-374">Каждый раз при использовании средства «Установка и удаление программ» на панели управления создается новый файл.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-374">Each time you use the Add/Remove Programs tool in Control Panel, a new file is created.</span></span>

## <a name="uninstallation-leaves-the-users-computer-in-a-clean-state"></a><span data-ttu-id="4cbfd-375">При удалении компьютер пользователя остается в чистом состоянии.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-375">Uninstallation leaves the user's computer in a clean state.</span></span>

<span data-ttu-id="4cbfd-376">Удаление приложения так же важно, как установка.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-376">Application removal is as important as installation.</span></span> <span data-ttu-id="4cbfd-377">При удалении пакета установщик Windows не следует оставлять бесполезными части самого себя на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-377">When a Windows Installer package is uninstalled it should leave no useless parts of itself behind on the user's computer.</span></span>

-   <span data-ttu-id="4cbfd-378">Если файл, который должен быть удален с компьютера пользователя, остается установленным после удаления, установщик может не удалить компонент, содержащий этот файл, по одной или нескольким причинам, описанным в разделе [Удаление потерянных файлов](removing-stranded-files.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-378">If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the reasons described in [Removing Stranded Files](removing-stranded-files.md).</span></span>
-   <span data-ttu-id="4cbfd-379">Если приложение должно быть зарегистрировано, создайте пакет для удаления данных реестра при удалении приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-379">If an application must be registered, author the package to remove registry information when the application is uninstalled.</span></span> <span data-ttu-id="4cbfd-380">Дополнительные сведения см. [в разделе Добавление или удаление разделов реестра при установке или удалении компонентов](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-380">For information see [Adding or Removing Registry Keys on the Installation or Removal of Components](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span></span> <span data-ttu-id="4cbfd-381">Если приложение не зарегистрировано, оно не отображается в компоненте Установка и удаление программ на панели управления и не может управляться с помощью установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-381">If an application is not registered, the application is not listed in the Add or Remove Programs feature in Control Panel and cannot be managed by using the Windows Installer.</span></span>
-   <span data-ttu-id="4cbfd-382">Чтобы скрыть приложение в компоненте "Установка и удаление программ" на панели управления и по-прежнему иметь возможность использовать установщик Windows для управления приложением, следуйте рекомендациям, описанным в статье [Добавление и удаление приложения и отсутствие трассировки в реестре](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-382">To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage the application, follow the guidelines described in [Adding and Removing an Application and Leaving No Trace in the Registry](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span></span>
-   <span data-ttu-id="4cbfd-383">Пользовательские действия должны быть выполнены в соответствии с требованиями при удалении.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-383">Custom actions should be conditioned to run or not as needed upon uninstallation.</span></span> <span data-ttu-id="4cbfd-384">При установке и удалении может потребоваться выполнить различные пользовательские действия.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-384">Different custom actions may need to run on install and uninstall.</span></span>
-   <span data-ttu-id="4cbfd-385">Сведения о настройке для конкретного пользователя могут храниться в текстовом файле на компьютере.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-385">User-specific customization information can be stored in a text file on the computer.</span></span> <span data-ttu-id="4cbfd-386">Это позволяет удалить файл при удалении приложения, даже если пользователь этой настройки в данный момент не вошел в систему.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-386">This has the advantage that the file can be removed when the application is uninstalled, even if the user of this customization is not currently logged on.</span></span>

## <a name="test-packages-for-both-per-user-and-per-machine-installation-deployment"></a><span data-ttu-id="4cbfd-387">Тестовые пакеты для развертывания с установкой на уровне пользователя и на компьютере.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-387">Test packages for both per-user and per-machine installation deployment.</span></span>

<span data-ttu-id="4cbfd-388">Рекомендуется позволить клиентам решить, следует ли развертывать пакет для установки в [контексте установки](installation-context.md)на компьютере или на уровне пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-388">It is good practice to enable customers to decide whether to deploy a package for installation in either the per-machine or per-user [installation context](installation-context.md).</span></span>

-   <span data-ttu-id="4cbfd-389">Определите, должно ли приложение быть доступно только отдельным пользователям или всем пользователям компьютера в процессе разработки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-389">Consider whether the application should be available to only particular users or all users of the computer during the development process.</span></span>
-   <span data-ttu-id="4cbfd-390">Проверьте, правильно ли работает пакет для контекстов установки на уровне пользователя и для каждого компьютера.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-390">Test that the package works correctly for both the per-user installation and per-machine installation contexts.</span></span>
-   <span data-ttu-id="4cbfd-391">Сделайте пакет легко настраиваемым и позвольте клиентам решить, следует ли развертывать его для каждого пользователя или для каждого компьютера.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-391">Make the package easily customizable and let customers decide whether to deploy it per-user or per-machine.</span></span>

## <a name="plan-and-test-a-servicing-strategy-before-shipping-the-application"></a><span data-ttu-id="4cbfd-392">Спланируйте и протестируйте стратегию обслуживания перед отправкой приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-392">Plan and test a servicing strategy before shipping the application.</span></span>

<span data-ttu-id="4cbfd-393">Прежде чем развертывать приложение в первый раз, необходимо решить, как вы планируете обслуживать приложение.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-393">You should decide how you intend to service the application before deploying the application for the first time.</span></span>

-   <span data-ttu-id="4cbfd-394">Примите во внимание типы обновлений, которые предполагается использовать для обслуживания приложения в будущем.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-394">Consider the types of updates you expect to use to service your application in the future.</span></span> <span data-ttu-id="4cbfd-395">Установщик Windows предоставляет три типа обновлений: [небольшое обновление](small-updates.md), [незначительное обновление](minor-upgrades.md)и [основные обновления](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-395">The Windows Installer provides three types of updates: [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="4cbfd-396">Различия между ними описаны в статье [исправление и обновление](patching-and-upgrades.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-396">The differences between these are described in [Patching and Upgrades](patching-and-upgrades.md) topic.</span></span>
-   <span data-ttu-id="4cbfd-397">Перед отправкой приложения проверьте, что оно работает правильно после обслуживания с каждым типом обновления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-397">Before shipping your application, test that it works as expected after servicing with each update type.</span></span>

## <a name="reduce-the-dependency-of-updates-upon-the-original-sources"></a><span data-ttu-id="4cbfd-398">Сократите зависимость обновлений от исходных источников.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-398">Reduce the dependency of updates upon the original sources.</span></span>

<span data-ttu-id="4cbfd-399">Если исходные файлы необходимы для обновления приложения, это может усложнить обслуживание приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-399">If the original source files are required to update your application, this can make servicing the application more difficult.</span></span> <span data-ttu-id="4cbfd-400">Следующие методы позволяют уменьшить зависимость обновлений от исходных источников.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-400">The following methods can help reduce the dependence of updates upon the original sources.</span></span>

-   <span data-ttu-id="4cbfd-401">Используйте [*разностное обновление*](d-gly.md) , чтобы обновить базовые версии приложения, такие как RTM-версия и версии пакета обновления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-401">Use a [*delta patch*](d-gly.md) to update the baseline versions of your application, such as the RTM version and the service pack versions.</span></span> <span data-ttu-id="4cbfd-402">Следуйте рекомендациям по использованию разностных исправлений, описанных в статье об [уменьшении размера исправления](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-402">Follow the guidelines for using delta patches described in the topic: [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="4cbfd-403">Следуйте рекомендациям, приведенным в разделе: [предотвращение необходимости доступа к исходному источнику установки для исправления](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-403">Follow the recommendations listed in the topic: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

## <a name="do-not-distribute-unserviceable-merge-modules"></a><span data-ttu-id="4cbfd-404">Не распространяйте необслуживаемые модули слияния.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-404">Do not distribute unserviceable merge modules.</span></span>

<span data-ttu-id="4cbfd-405">Приложения не должны зависеть от [модулей слияния](merge-modules.md) для установки компонента, если владелец модуля слияния и владелец приложения различаются.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-405">Applications should not depend on [merge modules](merge-modules.md) for the installation of component if the owner of the merge module and the owner of the application are different.</span></span> <span data-ttu-id="4cbfd-406">Это может усложнить обслуживание приложения, поскольку обоим владельцам необходимо координировать обновление приложения или модуля.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-406">This can make it difficult to service the application because both owners need to coordinate to update the application or module.</span></span> <span data-ttu-id="4cbfd-407">Не зная всех приложений, которые использовали модуль слияния, владелец приложения не сможет обновить модуль слияния без риска, что обновление может быть несовместимо с другим приложением.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-407">Without knowing all the applications that have used the merge module, the owner of the application is unable update the merge module without risking that the update might be incompatible with another application.</span></span> <span data-ttu-id="4cbfd-408">Владелец модуля слияния не имеет прямого метода для обновления пакетов установщик Windows, которые уже установили модуль слияния.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-408">The owner of the merge module has no direct method for updating Windows Installer packages that have already installed the merge module.</span></span>

-   <span data-ttu-id="4cbfd-409">Рассмотрите возможность предоставления пользователям необходимых компонентов в качестве другой установщик Windows установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-409">Consider providing the needed components to users as another Windows Installer installation.</span></span>

## <a name="avoid-patching-administrative-installations"></a><span data-ttu-id="4cbfd-410">Избегайте установки исправлений для административных установок.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-410">Avoid patching administrative installations.</span></span>

<span data-ttu-id="4cbfd-411">Укажите в сети [административную установку](administrative-installation.md) исходного пакета установщик Windows приложения, чтобы разрешить участникам рабочей группы устанавливать приложение.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-411">Provide on a network an [administrative installation](administrative-installation.md) of your application's original Windows Installer package to enable members of a workgroup to install the application.</span></span> <span data-ttu-id="4cbfd-412">Пользователи этого административного образа должны затем применить обновления к локальному экземпляру приложения, расположенному на своем компьютере.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-412">Users of this administrative image should then apply updates to the local instance of the application located on their computer.</span></span> <span data-ttu-id="4cbfd-413">Это позволяет пользователям синхронизироваться с административным образом.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-413">This keeps users in synchronization with the administrative image.</span></span> <span data-ttu-id="4cbfd-414">Применение обновлений к административной установке не рекомендуется по следующим причинам.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-414">Applying updates to the administrative installation is not recommended for the following reasons.</span></span>

-   <span data-ttu-id="4cbfd-415">Размер и задержка загрузки, необходимые пользователям для получения обновления, увеличивается по сравнению с загрузкой исправления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-415">The size and latency of the download required for users to obtain an update is increased compared to downloading a patch.</span></span> <span data-ttu-id="4cbfd-416">Все обновленные пакеты установщик Windows и исходные файлы должны загружаться, повторно кэшироваться и переустанавливаться.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-416">The entire updated Windows Installer package and source files must download, recached, and reinstalled.</span></span>
-   <span data-ttu-id="4cbfd-417">Пользователи не могут установить программу по [запросу](installation-on-demand.md) и восстановить приложения из обновленной административной установки, пока они не будут повторно кэшированы и переустановлены.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-417">Users are unable to [installation-on-demand](installation-on-demand.md) and repair applications from an updated administrative installation until they recache and reinstall the application.</span></span>
-   <span data-ttu-id="4cbfd-418">Применение исправления к административной установке удаляет цифровую подпись из пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-418">Applying a patch to an administrative installation removes the digital signature from the package.</span></span> <span data-ttu-id="4cbfd-419">Администратор должен заново подписать пакет.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-419">An administrator must resign the package.</span></span> <span data-ttu-id="4cbfd-420">Дополнительные сведения об использовании цифровых подписей см. в статье [цифровые подписи и установщик Windows](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-420">For more information about using digital signatures, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="4cbfd-421">Многие двоичные исправления предназначены для образа RTM приложения и нуждаются в предыдущей версии файла.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-421">Many binary patches target the RTM image of the application and require a previous file version.</span></span> <span data-ttu-id="4cbfd-422">Локальный экземпляр приложения, установленного из обновленной административной установки, может не работать с другими обновлениями.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-422">The local instance of an application installed from an updated administrative installation may not work with other updates.</span></span> <span data-ttu-id="4cbfd-423">Многие двоичные приложения обновления могут завершиться сбоем.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-423">Many binary patch applications can fail.</span></span>
-   <span data-ttu-id="4cbfd-424">Применение исправления к административной установке обновляет исходные файлы и MSI-файл, но не отмечает образ сети сведениями об обновлении.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-424">Applying a patch to an administrative installation updates the source files and the .msi file but does not stamp the network image with information about the update.</span></span> <span data-ttu-id="4cbfd-425">Пользователи не могут определить, какие обновления были получены от административной установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-425">Users cannot determine which updates they have received from the administrative installation.</span></span> <span data-ttu-id="4cbfd-426">Это делает невозможным последовательное обновление, применяемое на стороне пользователя, с теми, которые уже применены на стороне административного образа.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-426">This makes it impossible to sequence updates applied on the user side with those already applied on the administrative image side.</span></span>
-   <span data-ttu-id="4cbfd-427">Исправления, применяемые к административной установке, не являются [удаляемыми](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-427">Patches applied to an administrative installation are not [uninstallable patches](uninstallable-patches.md).</span></span> <span data-ttu-id="4cbfd-428">Это может препятствовать тому, что код пакета, кэшированный на компьютере пользователя, не станет отличаться от кода пакета в административной установке.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-428">This can prevent the package code cached on the user's computer from becoming different than the package code on the administrative installation.</span></span> <span data-ttu-id="4cbfd-429">Если код пакета, кэшированный на компьютере пользователя, отличается от того, который был в административной установке, переустановите приложение из административной установки, а затем Исследуйте обновление клиентского компьютера.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-429">If the package code cached on the user's computer becomes different from that on the administrative installation, reinstall the application from the administrative installation and then patch the client computer.</span></span>
-   <span data-ttu-id="4cbfd-430">Если вы решили применить небольшие обновления путем исправления административного образа, следуйте рекомендациям, описанным в разделе [применение небольших обновлений путем исправления административного образа](applying-small-updates-by-patching-an-administrative-image.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-430">If you decide to apply small updates by patching an administrative image, follow the guidelines described in the topic: [Applying Small Updates by Patching an Administrative Image](applying-small-updates-by-patching-an-administrative-image.md).</span></span>

## <a name="register-updates-to-run-with-elevated-privilege"></a><span data-ttu-id="4cbfd-431">Регистрация обновлений для запуска с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-431">Register updates to run with elevated privilege.</span></span>

<span data-ttu-id="4cbfd-432">Начиная с установщик Windows 3,0, можно применить исправления к приложению, которое было установлено в контексте, управляемом пользователем, после того как исправление будет зарегистрировано как имеющее повышенные привилегии.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-432">Beginning with Windows Installer 3.0, it is possible to apply patches to an application that has been installed in a per-user-managed context, after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="4cbfd-433">Вы не можете применить исправления к приложениям, которые установлены в контексте, управляемом пользователем, с использованием версий установщик Windows более ранних, чем 3,0.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-433">You cannot apply patches to applications that are installed in a per-user managed context using versions of Windows Installer earlier than version 3.0.</span></span>

-   <span data-ttu-id="4cbfd-434">Чтобы зарегистрировать пакет исправлений с повышенными привилегиями, используйте метод [**саурцелистаддсаурце**](patch-sourcelistaddsource.md) или функцию [**мсисаурцелистаддсаурцеекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-434">Use the [**SourceListAddSource**](patch-sourcelistaddsource.md) method or [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to register a patch package as having elevated privileges.</span></span> <span data-ttu-id="4cbfd-435">Следуйте рекомендациям и примерам, приведенным в руководстве по [установке исправлений Per-User управляемых приложений](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-435">Follow the guidelines and examples provided in [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="4cbfd-436">При запуске установщик Windows версии 4,0 в Windows Vista можно также использовать [исправление контроля учетных записей (UAC)](user-account-control--uac--patching.md) , чтобы авторы установщик Windows установки могли определять исправления с цифровой подписью, которые могут быть применены в будущем пользователями, не являющимися администраторами.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-436">When running Windows Installer version 4.0 on Windows Vista you can also use [User Account Control (UAC) Patching](user-account-control--uac--patching.md) to enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span> <span data-ttu-id="4cbfd-437">Он доступен только при установке пакетов в [контексте установки](installation-context.md) на компьютере (ALLUSERS = 1).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-437">This is only available with the installation of packages in the per-machine [installation context](installation-context.md) (ALLUSERS=1).</span></span>
-   <span data-ttu-id="4cbfd-438">Убедитесь, что исправление с минимальными правами доступа не отключено путем установки свойства [**мсидисаблелуапатчинг**](msidisableluapatching.md) или политики [дисаблелуапатчинг](disableluapatching.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-438">Ensure that least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

## <a name="use-the-msipatchsequence-table-to-sequence-patches"></a><span data-ttu-id="4cbfd-439">Используйте таблицу Мсипатчсекуенце для последовательного исправления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-439">Use the MsiPatchSequence Table to sequence patches.</span></span>

<span data-ttu-id="4cbfd-440">Включите в пакет [таблицу мсипатчсекуенце](msipatchsequence-table.md) и добавьте сведения о последовательности исправлений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-440">Include a [MsiPatchSequence Table](msipatchsequence-table.md) in your package and add patch sequencing information.</span></span> <span data-ttu-id="4cbfd-441">Начиная с версии установщик Windows 3,0, установщик может использовать таблицу Мсипатчсекуенце при [установке нескольких исправлений](installing-multiple-patches.md) для определения наилучшей последовательности приложений исправления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-441">Beginning with Windows Installer version 3.0, the installer can use the MsiPatchSequence Table when [installing multiple patches](installing-multiple-patches.md) to determine the best patch application sequence.</span></span> <span data-ttu-id="4cbfd-442">Используйте рекомендации, описанные в статье [виртуализация исправлений в установщик Windows версии 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) , чтобы определить семейства исправлений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-442">Use the guidelines described in the [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper for defining patch families.</span></span>

-   <span data-ttu-id="4cbfd-443">Если это целесообразно, укажите все исправления как относящиеся к одному семейству исправлений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-443">If practical, specify all patches as belonging to a single patch family.</span></span> <span data-ttu-id="4cbfd-444">Во многих случаях одно семейство исправлений обеспечивает достаточную гибкость для последовательного исправления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-444">In many cases a single patch family provides enough flexibility to sequence patches.</span></span> <span data-ttu-id="4cbfd-445">Сложность разработки увеличивается при использовании нескольких семейств исправлений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-445">The complexity of authoring increases when multiple patch families are used.</span></span> <span data-ttu-id="4cbfd-446">Назначьте значимое имя семейству исправлений и назначьте значения последовательности в этом семействе исправлений, которые увеличиваются со временем.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-446">Assign a meaningful name to the patch family and assign sequence values in that patch family that increase over time.</span></span> <span data-ttu-id="4cbfd-447">Чтобы применить исправления в том порядке, в котором они были выпущены, выполните [несколько примеров установки исправлений](multiple-patching-example.md) .</span><span class="sxs-lookup"><span data-stu-id="4cbfd-447">Follow the [Multiple Patching Example](multiple-patching-example.md) to apply patches in the order in which they have been issued.</span></span>
-   <span data-ttu-id="4cbfd-448">Используйте [таблицу патчсекуенце](patchsequence-table--patchwiz-dll-.md) в [Patchwiz.dll](patchwiz-dll.md) , чтобы создать сведения в [таблице мсипатчсекуенце](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-448">Use the [PatchSequence Table](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) to generate the information in [MsiPatchSequence Table](msipatchsequence-table.md).</span></span> <span data-ttu-id="4cbfd-449">Версия PATCHWIZ.DLL, выпущенная с установщик Windows 3,0, может автоматически формировать сведения о последовательности обновления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-449">The version of PATCHWIZ.DLL that was released with Windows Installer 3.0 can automatically generate patch sequencing information.</span></span> <span data-ttu-id="4cbfd-450">Дополнительные сведения о добавлении нового исправления см. в разделе [Создание сведений о последовательности исправления](generating-patch-sequence-information---patchwiz-dll-.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-450">For more information on how to add a new patch, see [Generating Patch Sequence Information](generating-patch-sequence-information---patchwiz-dll-.md).</span></span> <span data-ttu-id="4cbfd-451">Дополнительные сведения о сценариях последовательности исправлений см. в техническом документе: [последовательное обновление в установщик Windows версии 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-451">For more information about patch sequencing scenarios, see the whitepaper: [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span></span>

## <a name="test-the-installation-package-thoroughly"></a><span data-ttu-id="4cbfd-452">Тщательно протестируйте пакет установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-452">Test the installation package thoroughly.</span></span>

<span data-ttu-id="4cbfd-453">Проверьте правильность установки, восстановления и удаления пакета установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-453">Test for correct installation, repair, and removal of your Windows Installer package.</span></span> <span data-ttu-id="4cbfd-454">Процесс тестирования можно разделить на следующие части.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-454">You can divide your testing process into the following parts.</span></span>

-   <span data-ttu-id="4cbfd-455">Тестирование установки. Протестируйте установку со всеми возможными сочетаниями функций приложения.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-455">Installation Testing - Test the installation with all possible combinations of application features.</span></span> <span data-ttu-id="4cbfd-456">Протестируйте все типы установки, в том числе [административную установку](administrative-installation.md), [откат установки](rollback-installation.md)и [установку по запросу](installation-on-demand.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-456">Test all types of installation, including [Administrative Installation](administrative-installation.md), [Rollback Installation](rollback-installation.md), and [Installation-On-Demand](installation-on-demand.md).</span></span> <span data-ttu-id="4cbfd-457">Попробуйте все возможные методы установки, включая выбор MSI файла, [Параметры командной строки](command-line-options.md)и установку из панели управления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-457">Try all possible methods of installation, including clicking on the .msi file, [command line options](command-line-options.md), and installing from the control panel.</span></span> <span data-ttu-id="4cbfd-458">Проверка того, что пакет может быть установлен пользователями во всех возможных контекстах прав.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-458">Test that the package can be installed by users in all possible privilege contexts.</span></span> <span data-ttu-id="4cbfd-459">Попробуйте установить пакет после его развертывания всеми возможными методами.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-459">Try installing the package after it has been deployed by all possible methods.</span></span> <span data-ttu-id="4cbfd-460">Включите [ведение журнала установщик Windows](windows-installer-logging.md) для каждого теста и устраните все ошибки, найденные в журнале установщика и журнале событий.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-460">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="4cbfd-461">Тестирование пользовательского интерфейса. Протестируйте пакет при установке со всеми возможными [уровнями пользовательского интерфейса](user-interface-levels.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-461">User Interface Testing - Test the package when installed with all possible [user interface levels](user-interface-levels.md).</span></span> <span data-ttu-id="4cbfd-462">Протестируйте пакет, установленный без пользовательского интерфейса, и все сведения, предоставленные через пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-462">Test the package installed with no user interface and with all information provided through the user interface.</span></span> <span data-ttu-id="4cbfd-463">Обеспечьте [доступность](accessibility.md) пользовательского интерфейса и убедитесь, что пользовательский интерфейс работает так, как ожидается, для различных разрешений экрана и размеров шрифтов.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-463">Ensure the [Accessibility](accessibility.md) of the user interface and that the user interface functions as expected for different screen resolutions and font sizes.</span></span>
-   <span data-ttu-id="4cbfd-464">Обслуживание и восстановление тестирование — тестирование того, что пакет может выполнять [исправления и обновления](patching-and-upgrades.md) , доставляемые [небольшими обновлениями](small-updates.md), [незначительными обновлениями](minor-upgrades.md)и [основными обновлениями](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-464">Servicing and Repair Testing - Test that the package can handle [Patching and Upgrades](patching-and-upgrades.md) delivered by a [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="4cbfd-465">Перед развертыванием пакета напишите пробное обновление каждого типа и попробуйте применить его к исходному пакету.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-465">Before deploying the package, write a trial update of each type and try applying it to the original package.</span></span>
-   <span data-ttu-id="4cbfd-466">Удаление тестирования. Убедитесь, что при удалении пакета он не содержит бесполезные части самого себя на компьютере пользователя и что удаляются только сведения, относящиеся к пакету.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-466">Uninstall Testing - Verify that when the package is removed it leaves no useless parts of itself behind on the user's computer and that only information belonging to the package has been removed.</span></span> <span data-ttu-id="4cbfd-467">Перезагрузите тестовый компьютер после удаления пакета и проверьте целостность общих системных средств и других стандартных приложений.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-467">Reboot the test computer after uninstalling the package and verify the integrity of common system tools and other standard applications.</span></span> <span data-ttu-id="4cbfd-468">Проверка того, что пакет может быть удален пользователями во всех возможных контекстах прав.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-468">Test that the package can be removed by users in all possible privilege contexts.</span></span> <span data-ttu-id="4cbfd-469">Проверьте все методы, чтобы удалить пакет, щелкните MSI-файл, попробуйте использовать [Параметры командной строки](command-line-options.md)и попробуйте удалить пакет с помощью панели управления.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-469">Test all methods to remove the package, click the .msi file, try the [command line options](command-line-options.md), and try removing the package from the control panel.</span></span> <span data-ttu-id="4cbfd-470">Включите [ведение журнала установщик Windows](windows-installer-logging.md) для каждого теста и устраните все ошибки, найденные в журнале установщика и журнале событий.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-470">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="4cbfd-471">Тестирование функциональности продукта. Убедитесь, что приложение работает должным образом после установки, восстановления или удаления пакета.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-471">Product Functionality Testing - Ensure that the application functions as expected after the installation, repair, or removal of the package.</span></span>

## <a name="fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package"></a><span data-ttu-id="4cbfd-472">Устраните все ошибки проверки перед развертыванием нового или измененного пакета установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-472">Fix all validation errors before deploying a new or revised installation package.</span></span>

<span data-ttu-id="4cbfd-473">Выполните [проверку пакета](package-validation.md) для нового или измененного пакета установщик Windows, прежде чем пытаться установить его в первый раз.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-473">Run [package validation](package-validation.md) on a new or revised Windows Installer package before attempting to install it for the first time.</span></span> <span data-ttu-id="4cbfd-474">При проверке выполняется проверка установщик Windows базы данных на наличие ошибок разработки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-474">Validation checks the Windows Installer database for authoring errors.</span></span> <span data-ttu-id="4cbfd-475">Попытка установить пакет, который не проходит проверку, может повредить систему пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-475">Attempting to install a package that does not pass validation can damage the user's system.</span></span>

-   <span data-ttu-id="4cbfd-476">Вы можете проверить пакет с помощью [Orca.exe](orca-exe.md) или [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-476">You can validate your package using [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span> <span data-ttu-id="4cbfd-477">Оба средства предоставляются с Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-477">Both tools are provided with the Windows SDK.</span></span> <span data-ttu-id="4cbfd-478">Сторонние поставщики также могут включить систему проверки ICE в свою среду разработки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-478">Third-party vendors may also incorporate the ICE validation system into their authoring environment.</span></span>
-   <span data-ttu-id="4cbfd-479">Вы можете использовать стандартный набор средств [оценки внутренней согласованности — ICEs](internal-consistency-evaluators-ices.md) , включенных в файлы. CUB, поставляемые вместе с пакетом SDK, или настроить проверку, [создав Ice](building-an-ice.md) и добавив ее в файл. cub.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-479">You can use the standard set of [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md) included in the .cub files provided with the SDK, or customize validation by [Building an ICE](building-an-ice.md) and adding it to the .cub file.</span></span>
-   <span data-ttu-id="4cbfd-480">С помощью Evalcom2.dll можно реализовать [автоматизацию проверки](validation-automation.md) для пакетов установки и модулей слияния.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-480">You can use the Evalcom2.dll to implement [Validation Automation](validation-automation.md) for installation packages and merge modules.</span></span>

## <a name="author-a-secure-installation"></a><span data-ttu-id="4cbfd-481">Создайте безопасную установку.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-481">Author a secure installation.</span></span>

<span data-ttu-id="4cbfd-482">Следуйте приведенным ниже рекомендациям при разработке пакета, чтобы обеспечить безопасность среды во время установки.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-482">Following these guidelines when developing your package to help maintain a secure environment during installation.</span></span>

-   [<span data-ttu-id="4cbfd-483">Рекомендации по созданию безопасных установок</span><span class="sxs-lookup"><span data-stu-id="4cbfd-483">Guidelines for Authoring Secure Installations</span></span>](guidelines-for-authoring-secure-installations.md)
-   [<span data-ttu-id="4cbfd-484">Рекомендации по защите пакетов на заблокированных компьютерах</span><span class="sxs-lookup"><span data-stu-id="4cbfd-484">Guidelines for Securing Packages on Locked-Down Computers</span></span>](guidelines-for-securing-packages-on-locked-down-computers.md)
-   [<span data-ttu-id="4cbfd-485">Рекомендации по защите настраиваемых действий</span><span class="sxs-lookup"><span data-stu-id="4cbfd-485">Guidelines for Securing Custom Actions</span></span>](guidelines-for-securing-custom-actions.md)

## <a name="use-pmsihandle-instead-of-handle"></a><span data-ttu-id="4cbfd-486">Использовать ПМСИХАНДЛЕ вместо HANDLE</span><span class="sxs-lookup"><span data-stu-id="4cbfd-486">Use PMSIHANDLE instead of HANDLE</span></span>

<span data-ttu-id="4cbfd-487">Переменные типа **пмсихандле** определены в MSI. h.</span><span class="sxs-lookup"><span data-stu-id="4cbfd-487">The **PMSIHANDLE** type variables is defined in msi.h.</span></span> <span data-ttu-id="4cbfd-488">Рекомендуется, чтобы приложение использовало тип **пмсихандле** , так как установщик закрывает объекты **пмсихандле** , когда они выходят за пределы области, тогда как приложение должно закрыть объекты **мсихандле** , вызвав [**мсиклосехандле**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span><span class="sxs-lookup"><span data-stu-id="4cbfd-488">It is recommended that your application use the **PMSIHANDLE** type because the installer closes **PMSIHANDLE** objects as they go out of scope, whereas your application must close **MSIHANDLE** objects by calling [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span></span>

<span data-ttu-id="4cbfd-489">Например, при использовании следующего кода:</span><span class="sxs-lookup"><span data-stu-id="4cbfd-489">For example, if you use code like this:</span></span>

``` syntax
MSIHANDLE hRec = MsiCreateRecord(3);
```

<span data-ttu-id="4cbfd-490">Измените его на:</span><span class="sxs-lookup"><span data-stu-id="4cbfd-490">Change it to:</span></span>

``` syntax
PMSIHANDLE hRec = MsiCreateRecord(3);
```

 

 
