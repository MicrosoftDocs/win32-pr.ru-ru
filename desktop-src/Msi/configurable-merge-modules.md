---
description: Модули слияния (MSM-файлы) могут быть созданы для хранения атрибутов, настраиваемых потребителем модуля слияния.
ms.assetid: 461436f0-3a91-4a49-934a-f975bf13df40
title: Настраиваемые модули слияния
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 716688d947ae84279dc3409bf97abe4eb58a69d0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664592"
---
# <a name="configurable-merge-modules"></a><span data-ttu-id="da36e-103">Настраиваемые модули слияния</span><span class="sxs-lookup"><span data-stu-id="da36e-103">Configurable Merge Modules</span></span>

<span data-ttu-id="da36e-104">Модули слияния (MSM-файлы) могут быть созданы для хранения атрибутов, настраиваемых потребителем модуля слияния.</span><span class="sxs-lookup"><span data-stu-id="da36e-104">Merge modules (.msm files) may be authored to contain attributes that are configurable by the consumer of the merge module.</span></span> <span data-ttu-id="da36e-105">Это позволяет настроить модуль слияния во время слияния пакета установки и модуля, установленного конечным пользователем.</span><span class="sxs-lookup"><span data-stu-id="da36e-105">This enables the merge module to be configured at the time the installation package and module are merged and installed by the end-user.</span></span> <span data-ttu-id="da36e-106">Для настраиваемых модулей слияния требуется Mergemod.dll версии 2,0, но они могут запускаться в любой версии установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="da36e-106">Configurable merge modules require Mergemod.dll version 2.0 but can run on any version of the Windows Installer.</span></span>

<span data-ttu-id="da36e-107">Реализация настраиваемых модулей слияния состоит из двух частей.</span><span class="sxs-lookup"><span data-stu-id="da36e-107">The implementation of configurable merge modules consists of two parts.</span></span> <span data-ttu-id="da36e-108">Во-первых, при создании модуля слияния (MSM-файл) автор модуля слияния добавляет в базу данных модуля сведения, указывающие, какие элементы могут быть изменены, и как эти элементы могут быть настроены пользователем модуля.</span><span class="sxs-lookup"><span data-stu-id="da36e-108">First, when creating the merge module (.msm file), the merge module author adds information to the module database that specifies which items can be modified and how these items can be configured by the module user.</span></span> <span data-ttu-id="da36e-109">Автор добавляет записи в [таблицы базы данных модуля слияния](merge-module-database-tables.md) , зарезервированные для настраиваемой информации ([Модулеконфигуратион Table](moduleconfiguration-table.md) и [модулесубститутион Table](modulesubstitution-table.md)), обновляет [ \_ таблицу проверки](-validation-table.md)и добавляет записи для настраиваемых таблиц модулей слияния в [таблицу модулеигноретабле](moduleignoretable-table.md).</span><span class="sxs-lookup"><span data-stu-id="da36e-109">The author adds entries to the [Merge Module Database Tables](merge-module-database-tables.md) that are reserved for configurable information ([ModuleConfiguration table](moduleconfiguration-table.md) and [ModuleSubstitution table](modulesubstitution-table.md)), updates the [\_Validation table](-validation-table.md), and adds entries for the configurable merge module tables to the [ModuleIgnoreTable table](moduleignoretable-table.md).</span></span> <span data-ttu-id="da36e-110">Дополнения к таблице Модулеигноре необходимы для обеспечения совместимости модуля с Mergemod.dll версиями, предшествующими 2,0.</span><span class="sxs-lookup"><span data-stu-id="da36e-110">The additions to the ModuleIgnore table are required to make the module compatible with Mergemod.dll versions earlier than 2.0.</span></span>

<span data-ttu-id="da36e-111">Во-вторых, при объединении модуля в пакет установки (MSI-файл) конечный пользователь модуля использует средство слияния.</span><span class="sxs-lookup"><span data-stu-id="da36e-111">Second, when merging the module into an installation package (.msi file), the end-user of the module uses a merge tool.</span></span> <span data-ttu-id="da36e-112">Средство слияния вызывает Mergemod.dll, чтобы предоставить сведения о конфигурации в модуле средству настройки клиента.</span><span class="sxs-lookup"><span data-stu-id="da36e-112">The merge tool calls Mergemod.dll to expose the configuration information in the module to a client configuration tool.</span></span> <span data-ttu-id="da36e-113">Средство настройки может взаимодействовать с конечным пользователем, но не является обязательным для предоставления всех возможных параметров конфигурации.</span><span class="sxs-lookup"><span data-stu-id="da36e-113">The configuration tool may interact with the end-user but is not required to expose all possible configuration options.</span></span> <span data-ttu-id="da36e-114">Если пользователь отклоняет выбор для настраиваемого элемента, модуль может предоставить значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="da36e-114">If the user declines to provide a selection for a configurable item, the module may provide a default value.</span></span> <span data-ttu-id="da36e-115">После того как пользователь предоставит выбранное средство настройки, средство слияния вызывает Mergemod.dll для выполнения слияния.</span><span class="sxs-lookup"><span data-stu-id="da36e-115">After the user gives the configuration tool his selections, the merge tool calls Mergemod.dll to perform the merge.</span></span>

<span data-ttu-id="da36e-116">Настраиваемые модули слияния полностью совместимы с инструментами, предшествующими Mergemod.dll версии 2,0.</span><span class="sxs-lookup"><span data-stu-id="da36e-116">Configurable merge modules are fully compatible with tools earlier than Mergemod.dll version 2.0.</span></span> <span data-ttu-id="da36e-117">В этих случаях средство использует значения по умолчанию в модуле.</span><span class="sxs-lookup"><span data-stu-id="da36e-117">In these cases, the tool uses the default values in the module.</span></span>

<span data-ttu-id="da36e-118">Дополнительные сведения см. [в разделе Использование настраиваемых модулей слияния](using-configurable-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="da36e-118">For more information, see [Using Configurable Merge Modules](using-configurable-merge-modules.md).</span></span>

 

 



