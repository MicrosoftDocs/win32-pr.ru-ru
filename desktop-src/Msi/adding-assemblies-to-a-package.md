---
description: Установщик Windows разработчики могут использовать рекомендации в этом разделе для создания установщик Windows пакетов, содержащих сборки.
ms.assetid: 60687a4f-aaa4-4264-a3f7-0a16eb1fb336
title: Добавление сборок в пакет
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ded0795003ae8faf1b7bb945671990767d3eefb7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264206"
---
# <a name="adding-assemblies-to-a-package"></a>Добавление сборок в пакет

Установщик Windows разработчики могут использовать рекомендации в этом разделе для создания установщик Windows пакетов, содержащих сборки.

Следующие рекомендации применимы к сборкам Win32 и сборкам, используемым средой CLR платформы Microsoft .NET.

-   Компонент установщик Windows должен содержать не более одной сборки.
-   Все файлы в сборке должны находиться в одном компоненте.
-   Каждый компонент, содержащий сборку, должен иметь запись в таблице [мсиассембли](msiassembly-table.md) .
-   Строгое имя кэша сборок для каждой сборки должно быть создано в таблице [мсиассемблинаме](msiassemblyname-table.md) .
-   При регистрации COM-взаимодействия для сборки используйте таблицу [реестра](registry-table.md) вместо таблицы [класса](class-table.md) .
-   Сборки, имеющие одно и то же строгое имя, являются одной и той же сборкой. Если одна и та же сборка устанавливается разными приложениями, компоненты, содержащие сборку, должны использовать одно и то же значение для ComponentId в таблицах [компонентов](component-table.md) .

> [!Note]  
> Объявления продуктов определяют сборки, которые могут быть установлены и использованы различными приложениями. В объявлениях продуктов не определены закрытые сборки.

 

## <a name="adding-win32-assemblies"></a>Добавление сборок Win32

При включении сборок Win32 используйте следующие рекомендации.

-   Значение ключевого пути в таблице [Component](component-table.md) для компонента, содержащего сборку Win32, не должно иметь значение null.
-   Значение ключевого пути в таблице [Component](component-table.md) для компонента, содержащего сборку политики Win32, должно быть файлом манифеста.
-   Значение ключевого пути в таблице [Component](component-table.md) для компонента, содержащего сборку Win32, которая не является сборкой политики, не должна быть файлом манифеста или каталогом. Он должен быть другим файлом в сборке.
-   Добавьте строку в таблицу [мсиассемблинаме](msiassemblyname-table.md) для каждой пары "имя-значение", которая указана в разделе **assemblyIdentity** манифеста сборки Win32.

## <a name="adding-assemblies-used-with-the-net-framework"></a>Добавление сборок, используемых с платформа .NET Framework

При включении сборок, используемых платформа .NET Framework среды CLR, следуйте приведенным ниже рекомендациям.

-   Значение ключевого пути в таблице [Component](component-table.md) для компонента, содержащего сборку, не должно иметь значение null.
-   При установке сборки, используемой средой CLR, в глобальный кэш сборок, значение в \_ столбце Application File таблицы мсиассембли должно быть равно null.
-   Добавьте строку в таблицу [мсиассемблинаме](msiassemblyname-table.md) для каждого атрибута строгого имени сборки. Все сборки должны иметь имя, версию и атрибуты языка и региональных параметров, указанные в таблице Мсиассемблинаме. Для глобальной сборки требуется атрибут publicKeyToken. В следующей таблице приведен пример таблицы Мсиассемблинаме для глобальной сборки, используемой средой CLR.

[Таблица Мсиассемблинаме](msiassemblyname-table.md)



| Компонент  | Имя           | Значение            |
|------------|----------------|------------------|
| Компонент а | Имя           | простой           |
| Компонент а | version        | 1.0.0.0          |
| Компонент а | culture        | нейтральная тональность          |
| Компонент а | publicKeyToken | 9d1ec8380f483f5a |



 

 

 



