---
description: 'В таблице ниже перечислены пять настраиваемых действий, используемых для выполнения примеров спецификаций: Процессаккаунтс, Унинсталлаккаунтс, Креатеаккаунтс, Ремовеаккаунтс и Роллбаккаккаунтс.'
ms.assetid: 389ec652-243e-4392-aec9-3a7eb90e6c68
title: Создание настраиваемых действий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e09525490304762b98635bcbbe6c238ce3fe413f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103998270"
---
# <a name="authoring-the-custom-actions"></a><span data-ttu-id="5a1bf-103">Создание настраиваемых действий</span><span class="sxs-lookup"><span data-stu-id="5a1bf-103">Authoring the Custom Actions</span></span>

<span data-ttu-id="5a1bf-104">В таблице ниже перечислены пять настраиваемых действий, используемых для выполнения примеров спецификаций: Процессаккаунтс, Унинсталлаккаунтс, Креатеаккаунтс, Ремовеаккаунтс и Роллбаккаккаунтс.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-104">The table below lists the five custom actions used to meet the sample specifications: ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts, and RollbackAccounts.</span></span> <span data-ttu-id="5a1bf-105">Все эти настраиваемые действия находятся в [библиотеках динамической компоновки](dynamic-link-libraries.md) , хранящихся в [двоичной таблице](binary-table.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-105">All of these custom actions are in [dynamic-link libraries](dynamic-link-libraries.md) stored in the [Binary Table](binary-table.md).</span></span> <span data-ttu-id="5a1bf-106">Исходный код C++ для библиотек динамической компоновки, содержащих примеры настраиваемых действий, приведен в пакете SDK для установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-106">The C++ source code for the dynamic-link libraries containing the sample custom actions are provided in the Windows Installer SDK.</span></span> <span data-ttu-id="5a1bf-107">Процессаккаунтс и Унинсталлаккаунтс находятся в файле Process. cpp.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-107">ProcessAccounts and UninstallAccounts are in the file Process.cpp.</span></span> <span data-ttu-id="5a1bf-108">Креатеаккаунт находится в файле Create. cpp.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-108">CreateAccount is in the file Create.cpp.</span></span> <span data-ttu-id="5a1bf-109">RemoveAccount и Роллбаккаккаунт находятся в файле Remove. cpp.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-109">RemoveAccount and RollbackAccount are in the file Remove.cpp.</span></span> <span data-ttu-id="5a1bf-110">Эти исходные файлы можно использовать для создания файлов Process.dll, Create.dll и Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-110">These source files can be used to create the files Process.dll, Create.dll, and Remove.dll.</span></span>

<span data-ttu-id="5a1bf-111">Поскольку для создания или удаления учетной записи пользователя требуются повышенные привилегии, для создания, удаления и отката учетных записей пользователей необходимо использовать [отложенные настраиваемые действия выполнения](deferred-execution-custom-actions.md) , выполняемые в контексте системы.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-111">Because the creation or removal of a user account requires elevated privileges, [deferred execution custom actions](deferred-execution-custom-actions.md) that run in the context of the system must be used to create, remove, or roll back user accounts.</span></span> <span data-ttu-id="5a1bf-112">Немедленные настраиваемые действия выполнения, Процессаккаунтс и Унинсталлаккаунтс, создают отложенные настраиваемые действия, которые создают, удаляют или отменяют учетные записи пользователей: Креатеаккаунт, RemoveAccount и Роллбаккаккаунт.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-112">The immediate execution custom actions, ProcessAccounts and UninstallAccounts, generate the deferred custom actions that create, remove, or rollback user accounts: CreateAccount, RemoveAccount, and RollbackAccount.</span></span>

<span data-ttu-id="5a1bf-113">Поскольку отложенные настраиваемые действия не могут считывать данные в таблицах базы данных, Процессаккаунтс и Унинсталлусераккаутс должны задать свойство CustomActionData, чтобы передать сведения из таблицы UserAccounts в отложенные пользовательские действия, как описано в разделе [Получение сведений о контексте для отложенного выполнения настраиваемых](obtaining-context-information-for-deferred-execution-custom-actions.md)действий.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-113">Because deferred custom actions cannot read information in database tables, ProcessAccounts and UninstallUserAccouts must set a CustomActionData property to pass the information in the UserAccounts table to the deferred custom actions as described in [Obtaining Context Information for Deferred Execution Custom Actions](obtaining-context-information-for-deferred-execution-custom-actions.md).</span></span> <span data-ttu-id="5a1bf-114">Когда установщик запускает сценарий выполнения, отложенные настраиваемые действия обрабатывали учетные записи пользователей в соответствии со сведениями в свойстве CustomActionData.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-114">When the installer runs the execution script, the deferred custom actions handle user accounts according to the information in the CustomActionData property.</span></span>

<span data-ttu-id="5a1bf-115">Так как все пользовательские действия находятся в библиотеках динамической компоновки, хранящихся в двоичной таблице, все они включают константы Мсидбкустомактионтипедлл и Мсидбкустомактионтипебинаридата в их базовом числовом типе.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-115">Because all the custom actions are in dynamic-link libraries stored in the Binary table, they all include the constants msidbCustomActionTypeDll and msidbCustomActionTypeBinaryData in their base numeric type.</span></span> <span data-ttu-id="5a1bf-116">Процессаккаунтс и Унинсталлаккаунтс являются примерами чистого [пользовательского действия типа 1](custom-action-type-1.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-116">ProcessAccounts and UninstallAccounts are examples of pure [Custom Action Type 1](custom-action-type-1.md).</span></span> <span data-ttu-id="5a1bf-117">Сведения о других типах настраиваемых действий см. в [сводном списке всех типов пользовательских действий](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-117">For information on other custom action types see the [Summary List of All Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span>

<span data-ttu-id="5a1bf-118">Креатеаккаунт и RemoveAccount — это [отложенные пользовательские действия по выполнению](deferred-execution-custom-actions.md) , которые не позволяют службам олицетворять определенных пользователей.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-118">CreateAccount and RemoveAccount are [deferred execution custom actions](deferred-execution-custom-actions.md) that do not allow services to impersonate particular users.</span></span> <span data-ttu-id="5a1bf-119">Эти настраиваемые действия включают в себя константы Мсидбкустомактионтипеинскрипт и msidbCustomActionTypeNoImpersonate для указания этих [настраиваемых действий при выполнении в скрипте](custom-action-in-script-execution-options.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-119">These custom actions include the constants msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate to specify these [custom action in-script execution options](custom-action-in-script-execution-options.md).</span></span>

<span data-ttu-id="5a1bf-120">Роллбаккаккаунт — это [настраиваемое действие отката](rollback-custom-actions.md) , которое удаляет учетные записи пользователей только во время [установки отката](rollback-installation.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-120">RollbackAccount is a [rollback custom action](rollback-custom-actions.md) that only removes user accounts during a [rollback installation](rollback-installation.md).</span></span> <span data-ttu-id="5a1bf-121">Роллбаккаккаунт включает константы Мсидбкустомактионтипеинскрипт и Мсидбкустомактионтипероллбакк для указания этих [настраиваемых действий в скриптах выполнения](custom-action-in-script-execution-options.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-121">RollbackAccount includes the constants msidbCustomActionTypeInScript and msidbCustomActionTypeRollback to specify these [custom action in-script execution options](custom-action-in-script-execution-options.md).</span></span>

<span data-ttu-id="5a1bf-122">Эти настраиваемые действия могут обрабатывать конфиденциальные данные, такие как пароли пользователей, которые не должны записываться в файл журнала.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-122">These custom actions may handle sensitive data such as user passwords, which should not be written to the log file.</span></span> <span data-ttu-id="5a1bf-123">Поэтому отложенные настраиваемые действия должны включать Мсидбкустомактионтипехидетаржет в тип настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-123">The deferred custom actions should therefore include msidbCustomActionTypeHideTarget in the custom action type.</span></span> <span data-ttu-id="5a1bf-124">Имена отложенных настраиваемых действий также необходимо добавить в список свойств [**мсихидденпропертиес**](msihiddenproperties.md) в [таблице свойств](property-table.md) , так как немедленные настраиваемые действия передают данные для отложенных настраиваемых действий с помощью свойства CustomActionData.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-124">The names of the deferred custom actions also need to be added to the [**MsiHiddenProperties**](msihiddenproperties.md) property list in the [Property table](property-table.md) because of the way immediate custom actions pass data to deferred custom actions using the CustomActionData property.</span></span>



| <span data-ttu-id="5a1bf-125">Пользовательское действие</span><span class="sxs-lookup"><span data-stu-id="5a1bf-125">Custom action</span></span>     | <span data-ttu-id="5a1bf-126">Точка входа DLL</span><span class="sxs-lookup"><span data-stu-id="5a1bf-126">DLL entry point</span></span>                       | <span data-ttu-id="5a1bf-127">Тип настраиваемого действия</span><span class="sxs-lookup"><span data-stu-id="5a1bf-127">Custom action type</span></span>                                                                                                                                                         |
|-------------------|---------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5a1bf-128">процессаккаунтс</span><span class="sxs-lookup"><span data-stu-id="5a1bf-128">ProcessAccounts</span></span>   | <span data-ttu-id="5a1bf-129">Процессусераккаунтс в Process.dll.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-129">ProcessUserAccounts in Process.dll.</span></span>   | <span data-ttu-id="5a1bf-130">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата = 1</span><span class="sxs-lookup"><span data-stu-id="5a1bf-130">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span></span>                                                                                                             |
| <span data-ttu-id="5a1bf-131">унинсталлаккаунтс</span><span class="sxs-lookup"><span data-stu-id="5a1bf-131">UninstallAccounts</span></span> | <span data-ttu-id="5a1bf-132">Унинсталлусераккаунтс в Process.dll.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-132">UninstallUserAccounts in Process.dll.</span></span> | <span data-ttu-id="5a1bf-133">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата = 1</span><span class="sxs-lookup"><span data-stu-id="5a1bf-133">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span></span>                                                                                                             |
| <span data-ttu-id="5a1bf-134">креатеаккаунт</span><span class="sxs-lookup"><span data-stu-id="5a1bf-134">CreateAccount</span></span>     | <span data-ttu-id="5a1bf-135">Креатеусераккаунт в Create.dll.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-135">CreateUserAccount in Create.dll.</span></span>      | <span data-ttu-id="5a1bf-136">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеинскрипт + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-136">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span></span> |
| <span data-ttu-id="5a1bf-137">RemoveAccount</span><span class="sxs-lookup"><span data-stu-id="5a1bf-137">RemoveAccount</span></span>     | <span data-ttu-id="5a1bf-138">Ремовеусераккаунт в Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-138">RemoveUserAccount in Remove.dll.</span></span>      | <span data-ttu-id="5a1bf-139">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеинскрипт + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-139">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span></span> |
| <span data-ttu-id="5a1bf-140">роллбаккаккаунт</span><span class="sxs-lookup"><span data-stu-id="5a1bf-140">RollbackAccount</span></span>   | <span data-ttu-id="5a1bf-141">Ремовеусераккаунт в Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-141">RemoveUserAccount in Remove.dll.</span></span>      | <span data-ttu-id="5a1bf-142">Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеинскрипт + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.</span><span class="sxs-lookup"><span data-stu-id="5a1bf-142">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.</span></span>       |



 

<span data-ttu-id="5a1bf-143">Продолжайте [Создание таблицы CustomAction](authoring-the-customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="5a1bf-143">Continue to [Authoring the CustomAction Table](authoring-the-customaction-table.md).</span></span>

 

 



