---
description: 'В таблице ниже перечислены пять настраиваемых действий, используемых для выполнения примеров спецификаций: Процессаккаунтс, Унинсталлаккаунтс, Креатеаккаунтс, Ремовеаккаунтс и Роллбаккаккаунтс.'
ms.assetid: 389ec652-243e-4392-aec9-3a7eb90e6c68
title: Создание настраиваемых действий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e09525490304762b98635bcbbe6c238ce3fe413f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103998270"
---
# <a name="authoring-the-custom-actions"></a>Создание настраиваемых действий

В таблице ниже перечислены пять настраиваемых действий, используемых для выполнения примеров спецификаций: Процессаккаунтс, Унинсталлаккаунтс, Креатеаккаунтс, Ремовеаккаунтс и Роллбаккаккаунтс. Все эти настраиваемые действия находятся в [библиотеках динамической компоновки](dynamic-link-libraries.md) , хранящихся в [двоичной таблице](binary-table.md). Исходный код C++ для библиотек динамической компоновки, содержащих примеры настраиваемых действий, приведен в пакете SDK для установщик Windows. Процессаккаунтс и Унинсталлаккаунтс находятся в файле Process. cpp. Креатеаккаунт находится в файле Create. cpp. RemoveAccount и Роллбаккаккаунт находятся в файле Remove. cpp. Эти исходные файлы можно использовать для создания файлов Process.dll, Create.dll и Remove.dll.

Поскольку для создания или удаления учетной записи пользователя требуются повышенные привилегии, для создания, удаления и отката учетных записей пользователей необходимо использовать [отложенные настраиваемые действия выполнения](deferred-execution-custom-actions.md) , выполняемые в контексте системы. Немедленные настраиваемые действия выполнения, Процессаккаунтс и Унинсталлаккаунтс, создают отложенные настраиваемые действия, которые создают, удаляют или отменяют учетные записи пользователей: Креатеаккаунт, RemoveAccount и Роллбаккаккаунт.

Поскольку отложенные настраиваемые действия не могут считывать данные в таблицах базы данных, Процессаккаунтс и Унинсталлусераккаутс должны задать свойство CustomActionData, чтобы передать сведения из таблицы UserAccounts в отложенные пользовательские действия, как описано в разделе [Получение сведений о контексте для отложенного выполнения настраиваемых](obtaining-context-information-for-deferred-execution-custom-actions.md)действий. Когда установщик запускает сценарий выполнения, отложенные настраиваемые действия обрабатывали учетные записи пользователей в соответствии со сведениями в свойстве CustomActionData.

Так как все пользовательские действия находятся в библиотеках динамической компоновки, хранящихся в двоичной таблице, все они включают константы Мсидбкустомактионтипедлл и Мсидбкустомактионтипебинаридата в их базовом числовом типе. Процессаккаунтс и Унинсталлаккаунтс являются примерами чистого [пользовательского действия типа 1](custom-action-type-1.md). Сведения о других типах настраиваемых действий см. в [сводном списке всех типов пользовательских действий](summary-list-of-all-custom-action-types.md).

Креатеаккаунт и RemoveAccount — это [отложенные пользовательские действия по выполнению](deferred-execution-custom-actions.md) , которые не позволяют службам олицетворять определенных пользователей. Эти настраиваемые действия включают в себя константы Мсидбкустомактионтипеинскрипт и msidbCustomActionTypeNoImpersonate для указания этих [настраиваемых действий при выполнении в скрипте](custom-action-in-script-execution-options.md).

Роллбаккаккаунт — это [настраиваемое действие отката](rollback-custom-actions.md) , которое удаляет учетные записи пользователей только во время [установки отката](rollback-installation.md). Роллбаккаккаунт включает константы Мсидбкустомактионтипеинскрипт и Мсидбкустомактионтипероллбакк для указания этих [настраиваемых действий в скриптах выполнения](custom-action-in-script-execution-options.md).

Эти настраиваемые действия могут обрабатывать конфиденциальные данные, такие как пароли пользователей, которые не должны записываться в файл журнала. Поэтому отложенные настраиваемые действия должны включать Мсидбкустомактионтипехидетаржет в тип настраиваемого действия. Имена отложенных настраиваемых действий также необходимо добавить в список свойств [**мсихидденпропертиес**](msihiddenproperties.md) в [таблице свойств](property-table.md) , так как немедленные настраиваемые действия передают данные для отложенных настраиваемых действий с помощью свойства CustomActionData.



| Пользовательское действие     | Точка входа DLL                       | Тип настраиваемого действия                                                                                                                                                         |
|-------------------|---------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| процессаккаунтс   | Процессусераккаунтс в Process.dll.   | Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата = 1                                                                                                             |
| унинсталлаккаунтс | Унинсталлусераккаунтс в Process.dll. | Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата = 1                                                                                                             |
| креатеаккаунт     | Креатеусераккаунт в Create.dll.      | Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеинскрипт + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265. |
| RemoveAccount     | Ремовеусераккаунт в Remove.dll.      | Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеинскрипт + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265. |
| роллбаккаккаунт   | Ремовеусераккаунт в Remove.dll.      | Мсидбкустомактионтипедлл + Мсидбкустомактионтипебинаридата + Мсидбкустомактионтипеинскрипт + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.       |



 

Продолжайте [Создание таблицы CustomAction](authoring-the-customaction-table.md).

 

 



