---
description: Основное обновление — это комплексное обновление продукта, требующего изменения свойства ProductCode.
ms.assetid: 0c8f2aad-b301-4404-9051-694d97db1a8d
title: Основные обновления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7795695072f6c153373db914781ac4b919cd2572
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104542735"
---
# <a name="major-upgrades"></a><span data-ttu-id="ab65f-103">Основные обновления</span><span class="sxs-lookup"><span data-stu-id="ab65f-103">Major Upgrades</span></span>

<span data-ttu-id="ab65f-104">Основное обновление — это комплексное обновление продукта, требующего изменения свойства [**ProductCode**](productcode.md) .</span><span class="sxs-lookup"><span data-stu-id="ab65f-104">A major upgrade is a comprehensive update of a product that needs a change of the [**ProductCode**](productcode.md) Property.</span></span>

<span data-ttu-id="ab65f-105">Типичное крупное обновление удаляет предыдущую версию приложения и устанавливает новую версию.</span><span class="sxs-lookup"><span data-stu-id="ab65f-105">A typical major upgrade removes a previous version of an application and installs a new version.</span></span> <span data-ttu-id="ab65f-106">Основное обновление может реорганизовать дерево компонентов компонентов.</span><span class="sxs-lookup"><span data-stu-id="ab65f-106">A major upgrade can reorganize the feature component tree.</span></span> <span data-ttu-id="ab65f-107">Дополнительные сведения см. в разделе [**ProductCode**](productcode.md) и [изменение кода продукта](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-107">For more information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span>

<span data-ttu-id="ab65f-108">Во время основного обновления с помощью установщик Windows установщик ищет на компьютере пользователя приложения, связанные с ожидающим обновлением, и когда обнаруживает его, извлекает версию установленного приложения из системного реестра.</span><span class="sxs-lookup"><span data-stu-id="ab65f-108">During a major upgrade using Windows Installer, the installer searches the user's computer for applications that are related to the pending upgrade, and when it detects one, it retrieves the version of the installed application from the system registry.</span></span> <span data-ttu-id="ab65f-109">Затем установщик использует сведения в базе данных обновления, чтобы определить, следует ли обновить установленное приложение.</span><span class="sxs-lookup"><span data-stu-id="ab65f-109">The installer then uses information in the upgrade database to determine whether to upgrade the installed application.</span></span>

<span data-ttu-id="ab65f-110">Чтобы включить возможности обновления установщика, каждый пакет должен иметь свойство [**UpgradeCode**](upgradecode.md) и [таблицу обновления](upgrade-table.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-110">To enable the installer upgrade capabilities, each package should have an [**UpgradeCode**](upgradecode.md) Property and an [Upgrade Table](upgrade-table.md).</span></span> <span data-ttu-id="ab65f-111">У каждого отдельного продукта или набора продуктов должно быть собственное свойство **UpgradeCode**.</span><span class="sxs-lookup"><span data-stu-id="ab65f-111">Each stand-alone product or product suite should have its own **UpgradeCode**.</span></span> <span data-ttu-id="ab65f-112">Дополнительные сведения об использовании **UpgradeCode** см. в разделе, посвященном [использованию UpgradeCode](using-an-upgradecode.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-112">For more information about using the **UpgradeCode** see the section [Using an UpgradeCode](using-an-upgradecode.md).</span></span> <span data-ttu-id="ab65f-113">Каждая запись в таблице обновления содержит сочетание кода обновления, версии продукта и языковой информации, используемой для указания набора продуктов, затронутых обновлением.</span><span class="sxs-lookup"><span data-stu-id="ab65f-113">Each record in the Upgrade table gives a combination of the upgrade code, product version, and language information used to identify a set of products affected by the upgrade.</span></span> <span data-ttu-id="ab65f-114">Когда [действие финдрелатедпродуктс](findrelatedproducts-action.md) обнаруживает, что затронутый продукт установлен в системе, он добавляет код продукта к свойству в столбце Актионпроперти таблицы Upgrade.</span><span class="sxs-lookup"><span data-stu-id="ab65f-114">When the [FindRelatedProducts Action](findrelatedproducts-action.md) detects that an affected product is installed on the system, it appends the product code to a property in the ActionProperty column of the Upgrade table.</span></span> <span data-ttu-id="ab65f-115">[Действие RemoveExistingProducts](removeexistingproducts-action.md) и [действие мигратефеатурестатес](migratefeaturestates-action.md) удаляют или переносят продукты, перечисленные в списке актионпроперти.</span><span class="sxs-lookup"><span data-stu-id="ab65f-115">The [RemoveExistingProducts action](removeexistingproducts-action.md) and the [MigrateFeatureStates Action](migratefeaturestates-action.md) remove or migrate the products listed in the ActionProperty list.</span></span> <span data-ttu-id="ab65f-116">Авторы пакетов также могут выполнить процедуру, описанную в разделе [Подготовка приложения к последующим основным обновлениям](preparing-an-application-for-future-major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-116">Package authors can also follow the procedure described in the topic: [Preparing an Application for Future Major Upgrades](preparing-an-application-for-future-major-upgrades.md).</span></span>

<span data-ttu-id="ab65f-117">Пакеты обновления установщик Windows могут быть созданы таким, что основные обновления не будут устанавливаться, если у пользователя уже установлена более новая версия приложения.</span><span class="sxs-lookup"><span data-stu-id="ab65f-117">Windows Installer upgrade packages can be authored such that major upgrades will not install if the user already has a newer version of the application installed.</span></span> <span data-ttu-id="ab65f-118">Дополнительные сведения о создании пакета, который не будет устанавливаться более новой версией, см. в разделе [предотвращение установки старого пакета в более новой версии](preventing-an-old-package-from-installing-over-a-newer-version.md) .</span><span class="sxs-lookup"><span data-stu-id="ab65f-118">For more information about how to author a package that will not install over a newer version, see [Preventing an Old Package from Installing Over a Newer Version](preventing-an-old-package-from-installing-over-a-newer-version.md)</span></span>

> [!Note]  
> <span data-ttu-id="ab65f-119">Установщик Windows использует только первые три поля версии продукта.</span><span class="sxs-lookup"><span data-stu-id="ab65f-119">Windows Installer uses only the first three fields of the product version.</span></span> <span data-ttu-id="ab65f-120">Описания этих полей см. в описании свойства [**ProductVersion**](productversion.md) .</span><span class="sxs-lookup"><span data-stu-id="ab65f-120">See [**ProductVersion**](productversion.md) Property for descriptions of these fields.</span></span> <span data-ttu-id="ab65f-121">Если включить в версию продукта четвертое поле, установщик игнорирует четвертое поле.</span><span class="sxs-lookup"><span data-stu-id="ab65f-121">If you include a fourth field in your product version, the installer ignores the fourth field.</span></span>

 

<span data-ttu-id="ab65f-122">Рекомендуемый способ применения крупного обновления путем установки полного пакета для обновленного продукта.</span><span class="sxs-lookup"><span data-stu-id="ab65f-122">The recommended method of applying a major upgrade by installing the full package for the updated product.</span></span> <span data-ttu-id="ab65f-123">Сведения о применении основного обновления путем установки продукта см. в разделе [применение основных обновлений путем установки продукта](applying-major-upgrades-by-installing-the-product.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-123">For information about how to apply a major upgrade by installing the product, see [Applying Major Upgrades by Installing the Product](applying-major-upgrades-by-installing-the-product.md).</span></span>

<span data-ttu-id="ab65f-124">Основное обновление, применяемое в качестве [пакета исправлений](patch-packages.md) для продукта, не может быть виртуализировано с другими обновлениями и не является [удаляемым](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-124">A major upgrade applied as a [Patch Package](patch-packages.md) for the product cannot be sequenced with other updates and is not an [uninstallable patch](uninstallable-patches.md).</span></span> <span data-ttu-id="ab65f-125">Сведения о применении основного пакета исправлений для обновления к пакету установщик Windows см. в разделе [применение основных обновлений путем исправления локальной установки продукта](applying-major-upgrades-by-patching-the-local-installation-of-the-product.md).</span><span class="sxs-lookup"><span data-stu-id="ab65f-125">For information about how to apply a major upgrade patch package to a Windows Installer package see [Applying Major Upgrades by Patching the Local Installation of the Product](applying-major-upgrades-by-patching-the-local-installation-of-the-product.md).</span></span> <span data-ttu-id="ab65f-126">Применение основного обновления с помощью пакета исправлений не рекомендуется, вместо этого необходимо установить основные обновления, установив полный продукт.</span><span class="sxs-lookup"><span data-stu-id="ab65f-126">The application of a major upgrade using a patch package is not recommended, instead apply major upgrades by installing the full product.</span></span>

> [!Note]  
> <span data-ttu-id="ab65f-127">Если приложение установлено в [контексте установки](installation-context.md)«на пользователя», любое крупное обновление приложения также должно выполняться с использованием контекста «на пользователя».</span><span class="sxs-lookup"><span data-stu-id="ab65f-127">If an application is installed in the per-user [installation context](installation-context.md), any major upgrade to the application must also be performed using the per-user context.</span></span> <span data-ttu-id="ab65f-128">Если приложение установлено в контексте установки на компьютере, любое крупное обновление приложения также должно выполняться с использованием контекста на компьютер.</span><span class="sxs-lookup"><span data-stu-id="ab65f-128">If an application is installed in the per-machine installation context, any major upgrade to the application must also be performed using the per-machine context.</span></span> <span data-ttu-id="ab65f-129">Установщик Windows не будет устанавливать основные обновления в контексте установки.</span><span class="sxs-lookup"><span data-stu-id="ab65f-129">The Windows Installer will not install major upgrades across installation context.</span></span>

 

<span data-ttu-id="ab65f-130">С помощью свойства [**упградингпродукткоде**](upgradingproductcode.md) можно выполнить пользовательские действия, упорядоченные после [инсталлвалидате](installvalidate-action.md) , чтобы управлять основными обновлениями.</span><span class="sxs-lookup"><span data-stu-id="ab65f-130">You can condition custom actions that are sequenced after [InstallValidate](installvalidate-action.md) to handle major upgrades by using the [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md) property:</span></span>

-   <span data-ttu-id="ab65f-131">Если вы хотите, чтобы пользовательское действие выполнялось во время удаления продукта, но не при его удалении при значительных обновлениях, используйте это условие.</span><span class="sxs-lookup"><span data-stu-id="ab65f-131">If you want a custom action to run during an uninstallation of the product, but not during the removal of the product by a major upgrade, use this condition.</span></span>

    <span data-ttu-id="ab65f-132">Remove = "ALL", а не [ **упградингпродукткоде**](upgradingproductcode.md)</span><span class="sxs-lookup"><span data-stu-id="ab65f-132">REMOVE="ALL" AND NOT [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md)</span></span>

-   <span data-ttu-id="ab65f-133">Если вы хотите, чтобы пользовательское действие выполнялось только во время крупного обновления, используйте это условие.</span><span class="sxs-lookup"><span data-stu-id="ab65f-133">If you want a custom action to run only during a major upgrade, use this condition.</span></span>

    [<span data-ttu-id="ab65f-134">**упградингпродукткоде**</span><span class="sxs-lookup"><span data-stu-id="ab65f-134">**UPGRADINGPRODUCTCODE**</span></span>](upgradingproductcode.md)

 

 



