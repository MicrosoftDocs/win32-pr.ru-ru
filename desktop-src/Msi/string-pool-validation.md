---
description: Установщик Windows сохраняет все строки базы данных в одном общем пуле строк, чтобы уменьшить размер базы данных и повысить производительность.
ms.assetid: b627f3da-3545-4c1a-85b0-d8845fdac621
title: Проверка String-Pool
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ecb544b5c76026846f7e8b8f6f331195426ab55c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155123"
---
# <a name="string-pool-validation"></a>Проверка String-Pool

Установщик Windows сохраняет все строки базы данных в одном общем пуле строк, чтобы уменьшить размер базы данных и повысить производительность. Единственным средством проверки строкового пула является использование средства Мсиинфо, находящихся в пакете SDK для установщик Windows.

Проверка пула строк состоит из двух основных проверок:

-   [Проверки строк DBCS](#dbcs-string-tests)
-   [Проверка счетчика ссылок](#reference-count-verification)

## <a name="dbcs-string-tests"></a>Проверки строк DBCS

Проверка строк DBCS проверяет каждую строку в базе данных на наличие двух критериев: для пакетов с нейтральной кодовой страницей, если какой-либо символ является расширенным символом (больше 127), строка помечается, и отображается сообщение о том, что кодовая страница базы данных является недопустимой, так как для этих символов требуется, чтобы конкретная кодовая страница была согласована на всех системах.

Если база данных содержит кодовую страницу, каждая строка сканируется на наличие недопустимого индикатора DBCS. Если ненейтральная строка была неправильно помечена, символы не отображаются правильно. (Чаще всего это происходит из-за принудительного применения кодовой страницы к конкретному значению с помощью \_ Таблица Форцекодепаже с ненейтральными строками, уже наявляющимисяся в базе данных.) Обратите внимание, что эта проверка требует, чтобы кодовая страница базы данных была установлена в системе.

Если имеется проблема с кодовой страницей, пользователь может исправить ошибку с помощью \_ таблицы форцекодепаже, чтобы принудительно применить соответствующее значение для кодовой страницы базы данных. Дополнительные сведения см. в разделе [Обработка кодовых страниц](code-page-handling-windows-installer-.md).

## <a name="reference-count-verification"></a>Проверка счетчика ссылок

Чтобы проверить счетчик ссылок всех строк, каждая таблица сканируется на наличие строковых значений, сохраняется количество каждой отдельной строки, а результат сравнивается с сохраненным числом ссылок в пуле строк базы данных.

При наличии проблемы с числом ссылок на строки пользователь должен немедленно экспортировать каждую таблицу базы данных с помощью [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta), создать новую базу данных и импортировать таблицы в новую базу данных с помощью [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta). Новая база данных будет иметь то же содержимое, что и старая база данных, но счетчики ссылок на строки верны. Добавление или удаление данных из базы данных с поврежденным пулом строк может привести к повреждению базы данных и утрате данных, поэтому необходимо быстро выполнить эти действия, чтобы предотвратить дальнейшую потерю данных.

При перестроении баз данных не забудьте внедрить все необходимые хранилища и потоки в новую базу данных ( [ \_ см. таблицу "таблицы и](-streams-table.md) [ \_ хранилища](-storages-table.md)таблиц") и знать о проблемах с кодовыми страницами. Также не забудьте задать все необходимые свойства [потока сводных данных](summary-information-stream.md) .

 

 



