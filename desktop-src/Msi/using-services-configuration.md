---
description: Настройка служб позволяет установщик Windows настраивать службы на компьютере.
ms.assetid: 164280b2-1c75-49d2-ac04-c3654be84134
title: Использование конфигурации служб
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f6e3040d51b1056a370490fc5328a6bafe07555
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104496893"
---
# <a name="using-services-configuration"></a><span data-ttu-id="9890f-103">Использование конфигурации служб</span><span class="sxs-lookup"><span data-stu-id="9890f-103">Using Services Configuration</span></span>

<span data-ttu-id="9890f-104">Настройка служб позволяет установщик Windows настраивать [службы](../services/services.md) на компьютере.</span><span class="sxs-lookup"><span data-stu-id="9890f-104">Services configuration enables the Windows Installer to customize the [services](../services/services.md) on a computer.</span></span> <span data-ttu-id="9890f-105">Разработчики могут создать установщик Windows пакет для установки, запуска и удаления служб во время установки с помощью таблиц [ServiceControl](servicecontrol-table.md) и [сервицеинсталл](serviceinstall-table.md) , а также действий [инсталлсервицес](installservices-action.md), [стопсервицес](stopservices-action.md) и [делетесервицес](deleteservices-action.md) .</span><span class="sxs-lookup"><span data-stu-id="9890f-105">Developers can author a Windows Installer package to install, stop, start and delete services during an installation by using the [ServiceControl](servicecontrol-table.md) and [ServiceInstall](serviceinstall-table.md) tables and the [InstallServices](installservices-action.md), [StopServices](stopservices-action.md) and [DeleteServices](deleteservices-action.md) actions.</span></span>

<span data-ttu-id="9890f-106">Начиная с пакетов, написанных для установщик Windows 5,0, разработчики также могут использовать стандартное действие [мсиконфигуресервицес](msiconfigureservices-action.md) и [таблицу мсисервицеконфиг](msiserviceconfig-table.md) для настройки расширенных параметров настройки службы, доступных в Windows 7 и Windows Server 2008 R2 и Windows Vista и Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="9890f-106">Beginning with packages written for Windows Installer 5.0, developers can also use the [MsiConfigureServices](msiconfigureservices-action.md) standard action and the [MsiServiceConfig table](msiserviceconfig-table.md) to configure the extended service customization options available with Windows 7 and Windows Server 2008 R2 and Windows Vista and Windows Server 2008.</span></span> <span data-ttu-id="9890f-107">Существующие пакеты установки, написанные для версий установщик Windows, которые не включали таблицу Мсисервицеконфиг, можно по-прежнему устанавливать с помощью установщик Windows 5,0.</span><span class="sxs-lookup"><span data-stu-id="9890f-107">Existing installation packages written for versions of the Windows Installer that did not include the MsiServiceConfig table can be still be installed using Windows Installer 5.0.</span></span> <span data-ttu-id="9890f-108">Функция настройки служб установщик Windows не может настроить учетные записи сетевой службы, установить процессы узла общей службы (SVCHOST) или перезапустить службы, остановленные в ходе установки.</span><span class="sxs-lookup"><span data-stu-id="9890f-108">The services configuration feature of the Windows Installer cannot configure network service accounts, install shared service host (svchost) processes, or restart services stopped as part of the installation.</span></span>

<span data-ttu-id="9890f-109">**Windows XP и Windows Server 2003 или более ранних версий:** Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="9890f-109">**Windows XP and Windows Server 2003 or earlier:** Not supported.</span></span> <span data-ttu-id="9890f-110">Таблицы конфигурации службы и стандартные действия доступны начиная с установщик Windows 5,0, работающих в Windows 7 и Windows Server 2008 R2 и установщик Windows 4,5, работающих под управлением Windows Vista и Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="9890f-110">The service configuration tables and standard actions are available beginning with Windows Installer 5.0 running on Windows 7 and Windows Server 2008 R2 and Windows Installer 4.5 running on Windows Vista and Windows Server 2008.</span></span>

<span data-ttu-id="9890f-111">Чтобы запросить конфигурации службы, указанные в [таблице мсисервицеконфиг](msiserviceconfig-table.md), необходимо включить действие [Мсиконфигуресервицес](msiconfigureservices-action.md) в таблицу [инсталлексекутесекуенце](installexecutesequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="9890f-111">You must include the [MsiConfigureServices](msiconfigureservices-action.md) action in the [InstallExecuteSequence](installexecutesequence-table.md) table to request the service configurations that you specify in the [MsiServiceConfig table](msiserviceconfig-table.md).</span></span> <span data-ttu-id="9890f-112">Установщик Windows использует сведения из таблицы Мсисервицеконфиг только в том случае, если стандартное действие Мсиконфигуресервицес включено в таблицу последовательностей.</span><span class="sxs-lookup"><span data-stu-id="9890f-112">The Windows Installer uses the information in the MsiServiceConfig table only when the MsiConfigureServices standard action is included in a sequence table.</span></span> <span data-ttu-id="9890f-113">Стандартное действие Мсиконфигуресервицес также использует сведения в таблицах [ServiceControl](servicecontrol-table.md) и [сервицеинсталл](serviceinstall-table.md) .</span><span class="sxs-lookup"><span data-stu-id="9890f-113">The MsiConfigureServices standard action also uses information in the [ServiceControl](servicecontrol-table.md) and [ServiceInstall](serviceinstall-table.md) tables.</span></span>

<span data-ttu-id="9890f-114">Чтобы запросить, чтобы система предмсисервицеконфига только необходимые привилегии для конкретной службы, укажите в [таблице](msiserviceconfig-table.md)параметр конфигурации служба и **\_ \_ \_ \_ сведения о необходимых привилегиях настройки службы** .</span><span class="sxs-lookup"><span data-stu-id="9890f-114">To request that the system give only required privileges to a particular service, specify the service and the **SERVICE\_CONFIG\_REQUIRED\_PRIVILEGES\_INFO** configuration option in the [MsiServiceConfig table](msiserviceconfig-table.md).</span></span> <span data-ttu-id="9890f-115">Удалите ненужные права из токена процесса службы.</span><span class="sxs-lookup"><span data-stu-id="9890f-115">Remove the unneeded privileges from the service's process token.</span></span> <span data-ttu-id="9890f-116">Этот параметр можно использовать для настройки служб, выполняемых в контексте безопасности [учетных записей пользователя службы](../services/service-user-accounts.md)LocalSystem, LocalService или NetworkService.</span><span class="sxs-lookup"><span data-stu-id="9890f-116">This option can be used to configure services run in the security context of the LocalSystem, LocalService, or NetworkService [service user accounts](../services/service-user-accounts.md).</span></span>

<span data-ttu-id="9890f-117">Чтобы запросить, чтобы система запускала автоматический запуск службы в течение времени после запуска всех других автоматически запускаемых служб, укажите службу и параметр **\_ \_ отложенного \_ автоматического \_ запуска для настройки службы** в [таблице мсисервицеконфиг](msiserviceconfig-table.md).</span><span class="sxs-lookup"><span data-stu-id="9890f-117">To request that the system delay the automatic start of a service for a time after the start of all other auto-start services, specify the service and the **SERVICE\_CONFIG\_DELAYED\_AUTO\_START** option in the [MsiServiceConfig table](msiserviceconfig-table.md).</span></span> <span data-ttu-id="9890f-118">Отложенная служба должна быть установлена текущим пакетом с \_ \_ автозапуском службы, указанным в таблице [сервицеинсталл](serviceinstall-table.md) , либо служба должна быть уже установлена в качестве службы автоматического запуска.</span><span class="sxs-lookup"><span data-stu-id="9890f-118">The service being delayed must be installed by the current package with SERVICE\_AUTO\_START specified in the [ServiceInstall](serviceinstall-table.md) table or the service must already be installed as an auto-start service.</span></span>

<span data-ttu-id="9890f-119">Чтобы запросить, что система зарезервирует ресурс для монопольного использования конкретной службы, укажите службу, тип идентификатора безопасности службы и параметр конфигурации **Service \_ config Service \_ \_ \_ info** в [таблице мсисервицеконфиг](msiserviceconfig-table.md).</span><span class="sxs-lookup"><span data-stu-id="9890f-119">To request that the system reserve a resource for the exclusive use of a particular service, specify the service, the service SID type, and the **SERVICE\_CONFIG\_SERVICE\_SID\_INFO** configuration option in the [MsiServiceConfig table](msiserviceconfig-table.md).</span></span> <span data-ttu-id="9890f-120">Добавьте идентификатор безопасности службы в список управления доступом (ACL) ресурса.</span><span class="sxs-lookup"><span data-stu-id="9890f-120">Add the service's SID to the resource's Access Control List (ACL) for the resource.</span></span>

<span data-ttu-id="9890f-121">Чтобы запросить, что [Диспетчер управления службами](../services/service-control-manager.md) (SCM) должен ждать после отправки уведомления о **\_ \_ завершении работы службы управления службами** , выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9890f-121">To request that the [Service Control Manager](../services/service-control-manager.md) (SCM) wait after sending the **SERVICE\_CONTROL\_PRESHUTDOWN** notification to a service, do the following.</span></span> <span data-ttu-id="9890f-122">Укажите службу, продолжительность времени ожидания SCM, а также параметр конфигурации службы настройки предварительного **\_ \_ завершения работы \_** в [таблице мсисервицеконфиг](msiserviceconfig-table.md).</span><span class="sxs-lookup"><span data-stu-id="9890f-122">Specify the service, the length of time the SCM should wait, and the **SERVICE\_CONFIG\_PRESHUTDOWN\_INFO** configuration option in the [MsiServiceConfig table](msiserviceconfig-table.md).</span></span>

<span data-ttu-id="9890f-123">Чтобы настроить, когда система должна выполнять действия после сбоя службы, укажите параметр службы и **\_ \_ \_ \_ флаг действия при сбое настройки службы** в [таблице мсисервицеконфиг](msiserviceconfig-table.md).</span><span class="sxs-lookup"><span data-stu-id="9890f-123">To configure when the system should run actions after the failure of a service, specify the service and the **SERVICE\_CONFIG\_FAILURE\_ACTIONS\_FLAG** option in the [MsiServiceConfig table](msiserviceconfig-table.md).</span></span> <span data-ttu-id="9890f-124">Добавьте действия для выполнения в [таблицу мсисервицеконфигфаилуреактионс](msiserviceconfigfailureactions-table.md).</span><span class="sxs-lookup"><span data-stu-id="9890f-124">Add the actions to be run to the [MsiServiceConfigFailureActions table](msiserviceconfigfailureactions-table.md).</span></span>

<span data-ttu-id="9890f-125">Дополнительные сведения о возможностях расширенной настройки служб, появившихся в операционных системах Windows Vista и Windows Server 2008, см. в статье [изменения служб для Windows Vista](../services/service-changes-for-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="9890f-125">For more about the extended service customization capabilities introduced with the Windows Vista and Windows Server 2008 operating systems, see [Service Changes for Windows Vista](../services/service-changes-for-windows-vista.md).</span></span>

 

 
