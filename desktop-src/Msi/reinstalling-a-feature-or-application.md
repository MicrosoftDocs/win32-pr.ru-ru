---
description: Установщик Windows может восстанавливать, заменять и проверять файлы, содержащиеся в приложении. Частичная или полная переустановка приложения может потребоваться, если какие-либо файлы или записи реестра, связанные с любым компонентом, отсутствуют или повреждены.
ms.assetid: fab23ab9-f1ab-4743-b883-cffc29b0124b
title: Переустановка компонента или приложения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645f7dbf95204d96202c71a120eafb6e6e054ac6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156459"
---
# <a name="reinstalling-a-feature-or-application"></a><span data-ttu-id="108fb-104">Переустановка компонента или приложения</span><span class="sxs-lookup"><span data-stu-id="108fb-104">Reinstalling a Feature or Application</span></span>

<span data-ttu-id="108fb-105">Установщик Windows может восстанавливать, заменять и проверять файлы, содержащиеся в приложении.</span><span class="sxs-lookup"><span data-stu-id="108fb-105">Windows Installer can repair, replace, and verify files contained in an application.</span></span> <span data-ttu-id="108fb-106">Частичная или полная переустановка приложения может потребоваться, если какие-либо файлы или записи реестра, связанные с любым компонентом, отсутствуют или повреждены.</span><span class="sxs-lookup"><span data-stu-id="108fb-106">A partial or complete application reinstallation might be required if any files or registry entries associated with any feature are missing or corrupt.</span></span>

<span data-ttu-id="108fb-107">При повторной установке компонента или приложения все службы, переменные среды и настраиваемые действия, относящиеся к компоненту или приложению, также будут переустановлены.</span><span class="sxs-lookup"><span data-stu-id="108fb-107">When a feature or application is reinstalled, all the services, environment variables, and custom actions belonging to the feature or application are reinstalled as well.</span></span> <span data-ttu-id="108fb-108">Обратите внимание, что это означает, что все изменения, внесенные в переменные среды между исходной установкой и переустановкой, теряются.</span><span class="sxs-lookup"><span data-stu-id="108fb-108">Note that this means that any changes made to environment variables between the original installation and the reinstallation are lost.</span></span>

<span data-ttu-id="108fb-109">В следующем списке содержатся методы переустановки компонента или продукта.</span><span class="sxs-lookup"><span data-stu-id="108fb-109">The following list contains methods of reinstalling a feature or product.</span></span> <span data-ttu-id="108fb-110">Два первых метода были автоматизированы установщиком:</span><span class="sxs-lookup"><span data-stu-id="108fb-110">The first two methods have been automated by the installer:</span></span>

-   <span data-ttu-id="108fb-111">Исправьте, замените или проверьте файлы, вызвав функцию [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) .</span><span class="sxs-lookup"><span data-stu-id="108fb-111">Repair, replace, or verify files by calling the [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) function.</span></span>
-   <span data-ttu-id="108fb-112">Переустановите весь продукт, вызвав функцию [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) .</span><span class="sxs-lookup"><span data-stu-id="108fb-112">Reinstall the entire product by calling the [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) function.</span></span>
-   <span data-ttu-id="108fb-113">Переустановите, замените или проверьте файлы с помощью кнопки управления пользовательским интерфейсом установщика, выполнив [повторную установку таблице ControlEvent событие](reinstall-controlevent.md).</span><span class="sxs-lookup"><span data-stu-id="108fb-113">Reinstall, replace, or verify files with an installer UI control button through the [Reinstall ControlEvent](reinstall-controlevent.md).</span></span>
-   <span data-ttu-id="108fb-114">Переустановите, замените или проверьте файлы из командной строки, задав свойство [**REINSTALL**](reinstall.md) и свойство [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="108fb-114">Reinstall, replace, or verify files from a command line by setting the [**REINSTALL**](reinstall.md) property and the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

<span data-ttu-id="108fb-115">Дополнительные сведения о переустановке компонента или приложения см. в разделе [устойчивость](resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="108fb-115">For more information on reinstalling a feature or application, see [Resiliency](resiliency.md).</span></span>

<span data-ttu-id="108fb-116">**Повторная установка продукта с помощью установщика**</span><span class="sxs-lookup"><span data-stu-id="108fb-116">**To reinstall a product using the installer**</span></span>

-   <span data-ttu-id="108fb-117">Вызовите [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span><span class="sxs-lookup"><span data-stu-id="108fb-117">Call [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span></span>

<span data-ttu-id="108fb-118">**Повторная установка компонента с помощью установщика**</span><span class="sxs-lookup"><span data-stu-id="108fb-118">**To reinstall a feature using the installer**</span></span>

-   <span data-ttu-id="108fb-119">Вызовите [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="108fb-119">Call [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="108fb-120">**Переустановка продукта или компонента с помощью пользовательского интерфейса установщика**</span><span class="sxs-lookup"><span data-stu-id="108fb-120">**To reinstall a product or feature with an installer user interface**</span></span>

1.  <span data-ttu-id="108fb-121">Добавьте кнопку в указанное диалоговое окно, добавив запись в [таблицу управления](control-table.md).</span><span class="sxs-lookup"><span data-stu-id="108fb-121">Add a button to the specified dialog box by adding an entry to the [Control table](control-table.md).</span></span>
2.  <span data-ttu-id="108fb-122">Добавьте [таблице ControlEvent событие ReinstallMode](reinstallmode-controlevent.md) в таблицу таблице ControlEvent событие, используя поля диалогового окна \_ и элемента управления, \_ ссылающиеся на элемент управления Button, созданный на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="108fb-122">Add a [ReinstallMode ControlEvent](reinstallmode-controlevent.md) to the ControlEvent table, with the Dialog\_ and Control\_ fields referencing the button control created in step 1.</span></span> <span data-ttu-id="108fb-123">В поле argument (аргумент) введите строку, содержащую буквы, соответствующие нужным режимам переустановки (допустимые значения для этого поля идентичны параметрам, принятым для свойства [**REINSTALLMODE**](reinstallmode.md) ).</span><span class="sxs-lookup"><span data-stu-id="108fb-123">In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the [**REINSTALLMODE**](reinstallmode.md) property).</span></span> <span data-ttu-id="108fb-124">Значение в столбце упорядочения для этого события должно быть равно 1.</span><span class="sxs-lookup"><span data-stu-id="108fb-124">The value in the Ordering column for this event should be 1.</span></span>
3.  <span data-ttu-id="108fb-125">Добавьте событие [REINSTALL таблице ControlEvent событие](reinstall-controlevent.md) в [таблицу таблице ControlEvent событие](controlevent-table.md), еще раз ссылаясь на тот же элемент управления Button.</span><span class="sxs-lookup"><span data-stu-id="108fb-125">Add a [Reinstall ControlEvent](reinstall-controlevent.md) event to the [ControlEvent table](controlevent-table.md), again referencing the same button control.</span></span> <span data-ttu-id="108fb-126">Как правило, поле аргумента для этого события — все, чтобы принудительно переустановить все компоненты, но можно указать здесь имя конкретной функции.</span><span class="sxs-lookup"><span data-stu-id="108fb-126">The Argument field for this event will normally be ALL, to force reinstallation of all features, but you can place the name of a specific feature here.</span></span> <span data-ttu-id="108fb-127">Значение в столбце упорядочения для этого события должно быть равно 2.</span><span class="sxs-lookup"><span data-stu-id="108fb-127">The value in the Ordering column for this event should be 2.</span></span>
4.  <span data-ttu-id="108fb-128">Добавьте еще одно событие, привязанное к тому же элементу управления Button, чтобы начать переустановку.</span><span class="sxs-lookup"><span data-stu-id="108fb-128">Add one more event tied to the same button control, to actually initiate the reinstallation.</span></span> <span data-ttu-id="108fb-129">Это может быть событие EndDialog (с аргументом Return).</span><span class="sxs-lookup"><span data-stu-id="108fb-129">This can be an EndDialog event (with an argument of Return).</span></span> <span data-ttu-id="108fb-130">Однако, как правило, здесь будет использоваться событие Невдиалог для перехода к и **вы действительно хотите переустановить его?** диалоговое окно подтверждения.</span><span class="sxs-lookup"><span data-stu-id="108fb-130">More typically, however, a NewDialog event would be used here to jump to an **Are you sure you want to reinstall?** confirmation dialog box.</span></span> <span data-ttu-id="108fb-131">Значение в столбце упорядочения для этого события должно быть равно 3.</span><span class="sxs-lookup"><span data-stu-id="108fb-131">The value in the Ordering column for this event should be 3.</span></span>

    <span data-ttu-id="108fb-132">При необходимости можно создать [**несколько кнопок переустановки для**](reinstall.md) одного диалогового окна, позволяя пользователю выбрать тип переустановки.</span><span class="sxs-lookup"><span data-stu-id="108fb-132">If desired, several [**REINSTALL**](reinstall.md) buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed.</span></span> <span data-ttu-id="108fb-133">В этом случае каждая кнопка создается, как описано в предыдущей процедуре, с другим параметром [ReinstallMode таблице ControlEvent событие](reinstallmode-controlevent.md) для каждой кнопки.</span><span class="sxs-lookup"><span data-stu-id="108fb-133">In this case, each button is authored as outlined in the preceding procedure, with a different [ReinstallMode ControlEvent](reinstallmode-controlevent.md) parameter for each button.</span></span>

<span data-ttu-id="108fb-134">После установки определенного продукта (с некоторыми или всеми компонентами продукта) переустановку можно выполнить в командной строке:</span><span class="sxs-lookup"><span data-stu-id="108fb-134">Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed at the command line:</span></span>

<span data-ttu-id="108fb-135">**Переустановка продукта или компонента из командной строки**</span><span class="sxs-lookup"><span data-stu-id="108fb-135">**To reinstall a product or feature from a command line**</span></span>

1.  <span data-ttu-id="108fb-136">В командной строке укажите свойство [**REINSTALL**](reinstall.md) .</span><span class="sxs-lookup"><span data-stu-id="108fb-136">From the command prompt, specify the [**REINSTALL**](reinstall.md) property.</span></span>
2.  <span data-ttu-id="108fb-137">В командной строке укажите свойство [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="108fb-137">From the command prompt, specify the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

    <span data-ttu-id="108fb-138">Указание этих свойств позволяет пользователю переустановить любую или все компоненты продукта.</span><span class="sxs-lookup"><span data-stu-id="108fb-138">Specifying these properties allows the user to reinstall any or all of the product's features.</span></span> <span data-ttu-id="108fb-139">Также можно указать тип переустановки.</span><span class="sxs-lookup"><span data-stu-id="108fb-139">The type of reinstallation can also be specified.</span></span> <span data-ttu-id="108fb-140">Например, можно указать, что следует заменить только те файлы, которые полностью отсутствуют, или только поврежденные файлы (например, любой исполняемый файл, контрольная сумма которого не совпадает с фактическим содержимым файла).</span><span class="sxs-lookup"><span data-stu-id="108fb-140">For example, you can specify that only those files that are completely missing should be reinstalled, or that only corrupt files (for example, any executable file whose checksum does not match the actual file contents) be replaced.</span></span>

 

 



