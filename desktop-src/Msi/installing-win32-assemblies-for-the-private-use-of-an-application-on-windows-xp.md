---
description: Процедура, описанная в этом разделе, определяет, как создать пакет установщик Windows для установки сборки Win32.
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: Установка сборок Win32 для закрытого использования приложения в Windows XP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105682790"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a><span data-ttu-id="a0ac1-103">Установка сборок Win32 для закрытого использования приложения в Windows XP</span><span class="sxs-lookup"><span data-stu-id="a0ac1-103">Installing Win32 Assemblies for the Private Use of an Application on Windows XP</span></span>

<span data-ttu-id="a0ac1-104">Процедура, описанная в этом разделе, определяет, как создать пакет установщик Windows для установки сборки Win32.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-104">The procedure in this topic identifies how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="a0ac1-105">Пакет устанавливает сборку и файл манифеста приложения в созданную им папку, которую использует приложение.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-105">The package installs the assembly and an application manifest file into an authored folder that the application uses.</span></span> <span data-ttu-id="a0ac1-106">Манифест приложения определяет зависимость приложения от закрытой сборки.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-106">The application manifest specifies the dependence of the application on the private assembly.</span></span> <span data-ttu-id="a0ac1-107">После установки пакета закрытая сборка становится доступной для монопольного использования приложения.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-107">After installing the package, the private assembly is available for the exclusive use of the application.</span></span> <span data-ttu-id="a0ac1-108">Зависимость сборки, заданная в манифесте приложения, переопределяет (для этого приложения) любые другие глобальные зависимости сборок, указанные в файлах манифеста сборки.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-108">The assembly dependence that is specified in the application manifest overrides (for this application) any other global assembly dependencies that are specified in assembly manifest files.</span></span>

<span data-ttu-id="a0ac1-109">Прежде чем продолжить, лучше понять, как создать пакет установщик Windows без сборок.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-109">Before you continue, it is a good idea to understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="a0ac1-110">Дополнительные сведения см. [в примере установки](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-110">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="a0ac1-111">**Установка закрытой сборки в Windows XP**</span><span class="sxs-lookup"><span data-stu-id="a0ac1-111">**To install a private assembly on Windows XP**</span></span>

1.  <span data-ttu-id="a0ac1-112">Определите компонент установщик Windows, включающий сборку Win32 и файл манифеста приложения.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-112">Define a Windows Installer component that includes the Win32 assembly and the application manifest file.</span></span> <span data-ttu-id="a0ac1-113">Этот компонент может содержать другие ресурсы, которые всегда должны устанавливаться или удаляться вместе со сборкой.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-113">This component can contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="a0ac1-114">Остальные шаги этой процедуры описывают, как создать базу данных установки для установки этого компонента.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-114">The remaining steps of this procedure describe how to author the installation database to install this component.</span></span>
2.  <span data-ttu-id="a0ac1-115">Добавьте строку в [таблицу Component](component-table.md) для компонента, содержащего сборку Win32 и файл манифеста приложения.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-115">Add a row to the [Component table](component-table.md) for the component that contains the Win32 assembly and application manifest file.</span></span> <span data-ttu-id="a0ac1-116">Введите допустимый установщик Windows [GUID](guid.md) для этого кода компонента.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="a0ac1-117">Дополнительные сведения см. в разделе [изменение кода компонента](changing-the-component-code.md) и [что произойдет, если правила компонентов будут разорваны?](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="a0ac1-117">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>
3.  <span data-ttu-id="a0ac1-118">Установщик копирует файл манифеста сборки в папку, содержащую файл, указанный в поле файлового \_ приложения [таблицы мсиассембли](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-118">The installer copies the assembly manifest file into the folder that contains the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span>
4.  <span data-ttu-id="a0ac1-119">Добавьте строку в [таблицу феатурекомпонентс](featurecomponents-table.md) для привязки компонента к установщик Windows функции.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-119">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="a0ac1-120">Дополнительные сведения см. в разделе [компоненты и компоненты](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-120">For more information, see [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="a0ac1-121">Установщик Windowsная функция должна быть частью функции приложения, которую может распознать пользователь.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-121">A Windows Installer feature should be a piece of the application functionality that a user can recognize.</span></span> <span data-ttu-id="a0ac1-122">Сборка активируется, когда эта функция выбрана пользователем или произошла ошибка в приложении.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-122">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="a0ac1-123">Если сборка определяет дополнительную функцию, добавьте дополнительную строку в [таблицу функций](feature-table.md) для атрибутов компонентов.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-123">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature attributes.</span></span> <span data-ttu-id="a0ac1-124">Этот шаг не является обязательным при создании модуля слияния.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-124">This step is not required if authoring a merge module.</span></span>
5.  <span data-ttu-id="a0ac1-125">Для параллельных сборок, сведения о привязке и активации, например классы COM, интерфейсы и библиотеки типов, хранятся в файлах манифеста, а не в реестре.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-125">For side-by-side assemblies, binding and activation information, for example, COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="a0ac1-126">Закрытые сборки хранят эти сведения в манифесте сборки.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-126">Private assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="a0ac1-127">В системах, поддерживающих параллельные сборки, установщик пропускает обработку любых сведений о компоненте, который указан в [таблице расширения](extension-table.md), [таблице команд](verb-table.md), [таблице typelib](typelib-table.md), [таблице MIME](mime-table.md), [таблице классов](class-table.md), [таблице кодов ProgID](progid-table.md)и [таблице AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-127">On systems that support side-by-side assemblies, the installer skips processing any information about the component that is entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="a0ac1-128">Сведения о привязке и активации можно указать в таблицах для использования в системах, которые не поддерживают совместное использование сборок параллельно.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-128">Binding and activation information can be entered into the tables for use by systems that do not support side-by-side assembly sharing.</span></span>
6.  <span data-ttu-id="a0ac1-129">Параллельная установка не регистрирует сборку глобально.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-129">Side-by-side installation does not register the assembly globally.</span></span> <span data-ttu-id="a0ac1-130">Установщик пропускает самостоятельную регистрацию компонента, если в [таблицу селфрег](selfreg-table.md)указаны какие-либо сведения о самостоятельной регистрации.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-130">The installer skips self-registering the component if any self-registration information is entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="a0ac1-131">Сведения о самостоятельной регистрации можно указать в таблице Селфрег для самостоятельной регистрации компонента в системах, которые не поддерживают совместное использование сборок параллельно.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-131">Self-registration information can be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
7.  <span data-ttu-id="a0ac1-132">Добавьте любые другие сведения о реестре, за исключением привязки и активации, или самостоятельной регистрации компонента в [таблице реестра](registry-table.md), [таблице Ремоверегистри](removeregistry-table.md)и [таблице окружения](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-132">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
8.  <span data-ttu-id="a0ac1-133">Установщик пропускает [таблицу исолатедкомпонент](isolatedcomponent-table.md) для этого компонента в операционных системах, поддерживающих совместное использование.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-133">The installer skips the [IsolatedComponent table](isolatedcomponent-table.md) for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="a0ac1-134">Введите сведения в эту таблицу, если необходимо, чтобы сборка была закрыта в системах, поддерживающих локальные файлы.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-134">Enter information into this table if you want the assembly to be private on systems that support local files.</span></span>
9.  <span data-ttu-id="a0ac1-135">Добавьте строку в [таблицу мсиассембли](msiassembly-table.md) для компонента, содержащего сборку Win32.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-135">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="a0ac1-136">Введите значение 1 в поле Attributes таблицы Мсиассембли, чтобы указать, что это сборка Win32.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-136">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="a0ac1-137">Введите ключ закрытой сборки в \_ поле файл приложения [таблицы мсиассембли](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-137">Enter the file key of the private assembly in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="a0ac1-138">Добавьте [действие мсипублишассемблиес](msipublishassemblies-action.md) в [таблицу Инсталлексекутесекуенце](installexecutesequence-table.md) или [таблицу адвтексекутесекуенце](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-138">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="a0ac1-139">Добавьте [действие мсиунпублишассемблиес](msiunpublishassemblies-action.md) в таблицу инсталлексекутесекуенце.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-139">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span> <span data-ttu-id="a0ac1-140">Создайте папку для сборки и файла манифеста в [таблице Directory](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-140">Author a folder for the assembly and manifest file into the [Directory table](directory-table.md).</span></span> <span data-ttu-id="a0ac1-141">Эта папка должна находиться в корневом каталоге приложения и содержать файл, указанный в поле файлового \_ приложения [таблицы мсиассембли](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-141">This folder should be in the application's root directory and contain the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="a0ac1-142">Во время установки приложения установщик разрешает [таблицу каталогов](directory-table.md) для пути к этой папке.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-142">During the installation of the application, the installer resolves the [Directory table](directory-table.md) for the path to this folder.</span></span> <span data-ttu-id="a0ac1-143">Дополнительные сведения см. [в разделе Использование таблицы Directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-143">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
10. <span data-ttu-id="a0ac1-144">Добавьте строки в [таблицу мсиассемблинаме](msiassemblyname-table.md) для компонента.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-144">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="a0ac1-145">Добавьте по одной строке для каждой пары "имя — значение", указанной в разделе "assemblyIdentity" манифеста.</span><span class="sxs-lookup"><span data-stu-id="a0ac1-145">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="a0ac1-146">Дополнительные сведения см. в разделе [мсиассемблинаме Table](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="a0ac1-146">For more information, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



