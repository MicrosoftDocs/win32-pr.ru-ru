---
description: Пользователи и приложения с правами администратора могут получать и изменять сведения о сети, URL-адресах и источнике мультимедиа для установщик Windows приложений и исправлений в системе.
ms.assetid: e8c66bad-f594-4926-b3b4-c8b245dcfa83
title: Управление источниками установки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7fc45253af20ae5f9792ee3a5ec7dd318c80295
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674307"
---
# <a name="managing-installation-sources"></a><span data-ttu-id="a38b5-103">Управление источниками установки</span><span class="sxs-lookup"><span data-stu-id="a38b5-103">Managing Installation Sources</span></span>

<span data-ttu-id="a38b5-104">Пользователи и приложения с правами администратора могут получать и изменять сведения о сети, URL-адресах и источнике мультимедиа для установщик Windows приложений и исправлений в системе.</span><span class="sxs-lookup"><span data-stu-id="a38b5-104">Users and applications with administrative privileges can retrieve and modify network, URL, and media source list information for Windows Installer applications and patches on the system.</span></span>

<span data-ttu-id="a38b5-105">**Установщик Windows 2,0:** Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="a38b5-105">**Windows Installer 2.0:** Not supported.</span></span> <span data-ttu-id="a38b5-106">Администраторы не могут читать, переупорядочивать или заменять записи в исходном списке и не могут изменять или извлекать свойства исходного списка.</span><span class="sxs-lookup"><span data-stu-id="a38b5-106">Administrators cannot read, reorder, or replace entries in the source list and cannot modify or retrieve source list properties.</span></span> <span data-ttu-id="a38b5-107">Можно управлять сетевыми источниками, но не URL-адресами или источниками мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="a38b5-107">It is possible to manage Network sources, but not URL or Media sources.</span></span> <span data-ttu-id="a38b5-108">Администраторы могут управлять списками источников только для приложений на уровне компьютера или приложений, установленных в качестве каждого пользователя для текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-108">Administrators can only manage source lists for per-machine applications or applications installed as per-user for the current user.</span></span> <span data-ttu-id="a38b5-109">Это не позволяет администраторам использовать версии, предшествующие установщик Windows версии 3,0, от управления информацией списка источников для всех пользователей в системе.</span><span class="sxs-lookup"><span data-stu-id="a38b5-109">This prevents administrators using versions earlier than Windows Installer version 3.0 from managing source list information for all users in the system.</span></span>

<span data-ttu-id="a38b5-110">**Установщик Windows 3,0 и более поздних версий:** Пользователи и приложения с правами администратора могут получать и изменять сведения о списке источников для установщик Windows приложений и исправлений, установленных в системе для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="a38b5-110">**Windows Installer 3.0 and later:** Users and applications that have administrator privileges can retrieve and modify source list information for Windows Installer applications and patches installed on the system for all users.</span></span> <span data-ttu-id="a38b5-111">Функции списка источников можно использовать для управления списками источников и свойствами исходного списка для сети, URL-адресов и источников мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="a38b5-111">The source list functions can be used to manage source lists and source list properties for network, URL and media sources.</span></span> <span data-ttu-id="a38b5-112">Установщик может переупорядочить списки источников данных из внешнего процесса.</span><span class="sxs-lookup"><span data-stu-id="a38b5-112">The installer can reorder source lists from an external process.</span></span>

<span data-ttu-id="a38b5-113">Пользователи и приложения с правами администратора могут считывать и изменять следующие типы сведений о списке источников:</span><span class="sxs-lookup"><span data-stu-id="a38b5-113">Users and applications that have administrative privileges can read and modify the following types of source list information:</span></span>

-   <span data-ttu-id="a38b5-114">Списки источников для приложений и исправлений, установленных для всех пользователей в системе.</span><span class="sxs-lookup"><span data-stu-id="a38b5-114">Source lists for applications and patches installed for all users on the system.</span></span>
-   <span data-ttu-id="a38b5-115">Списки источников для источников исправлений, которые существуют отдельно от источников приложений.</span><span class="sxs-lookup"><span data-stu-id="a38b5-115">Source lists for patch sources that exist apart from the application sources.</span></span>
-   <span data-ttu-id="a38b5-116">Список источников для URL-адресов и источников мультимедиа, которые существуют отдельно от сетевых источников.</span><span class="sxs-lookup"><span data-stu-id="a38b5-116">Source lists for URL and media sources that exist apart from network sources.</span></span>
-   <span data-ttu-id="a38b5-117">Свойства исходного списка, такие как [**медиапаккажепас**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **ластуседсаурце**, **ластуседтипе** и **PackageName**.</span><span class="sxs-lookup"><span data-stu-id="a38b5-117">Source list properties such as [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType**, and **PackageName**.</span></span>

<span data-ttu-id="a38b5-118">Функции списков источников могут ограничивать область списков источников, найденных, путем указания контекста установки и контекста пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-118">The source lists functions can limit the scope of the source lists found by specifying the installation context and user context.</span></span> <span data-ttu-id="a38b5-119">Существует три возможных контекста установки: на пользователя (неуправляемый), на компьютере и на уровне пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-119">There are three possible installation contexts: per-user (unmanaged), per-machine, and per-user managed.</span></span> <span data-ttu-id="a38b5-120">Контекст пользователя может быть определенным пользователем или всеми пользователями в системе.</span><span class="sxs-lookup"><span data-stu-id="a38b5-120">The user context can be a particular user or all users on the system.</span></span>

<span data-ttu-id="a38b5-121">Пользователи, не являющиеся администраторами, не могут изменять исходный список экземпляра приложения или исправления, который существует в контексте другого пользователя (управляемого или неуправляемого).</span><span class="sxs-lookup"><span data-stu-id="a38b5-121">Non-administrators cannot modify the source list of an instance of an application or patch that exists under another user's per-user (managed or unmanaged) context.</span></span> <span data-ttu-id="a38b5-122">Администраторы, не являющиеся администраторами, могут изменять исходные списки экземпляра приложения или исправления, установленные в следующих контекстах:</span><span class="sxs-lookup"><span data-stu-id="a38b5-122">Non-administrators can modify the source lists of an instance of an application or patch installed under the following contexts:</span></span>

-   <span data-ttu-id="a38b5-123">Собственный контекст для каждого пользователя (неуправляемый).</span><span class="sxs-lookup"><span data-stu-id="a38b5-123">Their own per-user(unmanaged) context.</span></span>
-   <span data-ttu-id="a38b5-124">Контекст компьютера, но только в том случае, если политики [дисаблебровсе](disablebrowse.md), [алловлоккдовнбровсе](allowlockdownbrowse.md)и [AlwaysInstallElevated](alwaysinstallelevated.md) позволяют им просматривать источник приложения или исправления.</span><span class="sxs-lookup"><span data-stu-id="a38b5-124">The machine context, but only if the [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md), and [AlwaysInstallElevated](alwaysinstallelevated.md) policies allows them to browse for an application or patch source.</span></span>
-   <span data-ttu-id="a38b5-125">Собственный контекст, управляемый для каждого пользователя, но только в том случае, если политики [дисаблебровсе](disablebrowse.md), [алловлоккдовнбровсе](allowlockdownbrowse.md)и [AlwaysInstallElevated](alwaysinstallelevated.md) позволяют им просматривать источник приложения или исправления.</span><span class="sxs-lookup"><span data-stu-id="a38b5-125">Their own per-user managed context, but only if the [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md), and [AlwaysInstallElevated](alwaysinstallelevated.md) policies allows them to browse for an application or patch source.</span></span>

<span data-ttu-id="a38b5-126">Администраторы могут изменять любой исходный список, который не может быть изменен администратором.</span><span class="sxs-lookup"><span data-stu-id="a38b5-126">Administrators can modify any source list that a non-administrator can modify.</span></span> <span data-ttu-id="a38b5-127">Кроме того, администраторы и приложения с правами администратора могут изменять списки источников приложения или исправления, установленные в следующих контекстах:</span><span class="sxs-lookup"><span data-stu-id="a38b5-127">In addition, administrators and applications that have administrative privileges can modify the source lists of an application or patch installed under the following contexts:</span></span>

-   <span data-ttu-id="a38b5-128">Контекст для каждого компьютера.</span><span class="sxs-lookup"><span data-stu-id="a38b5-128">Per-machine context.</span></span>
-   <span data-ttu-id="a38b5-129">Собственные пользовательские и управляемые контексты для каждого пользователя (неуправляемые).</span><span class="sxs-lookup"><span data-stu-id="a38b5-129">Their own per-user (unmanaged) or their own per-user managed context.</span></span>
-   <span data-ttu-id="a38b5-130">Управляемый пользователем контекст другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-130">Another user's per-user managed context.</span></span>

> [!Note]  
> <span data-ttu-id="a38b5-131">Пользователи и приложения с правами администратора не могут изменять исходный список экземпляра приложения или исправления, установленного в контексте другого пользователя (не управляемого) для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-131">Users and applications that have administrative privileges cannot modify the source list of an instance of an application or patch installed in the per-user (unmanaged) context of another user.</span></span>

 

## <a name="managing-network-and-url-sources-for-products-and-patches"></a><span data-ttu-id="a38b5-132">Управление сетью и источниками URL-адресов для продуктов и исправлений</span><span class="sxs-lookup"><span data-stu-id="a38b5-132">Managing Network and URL sources for Products and Patches</span></span>

<span data-ttu-id="a38b5-133">Используйте функцию [**мсисаурцелистаддсаурцеекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) для добавления или изменения порядка исходного списка сетевых и URL-источников для исправления или приложения в определенном контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-133">Use the [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to add or reorder the source list of network and URL sources for a patch or application in a particular context.</span></span> <span data-ttu-id="a38b5-134">Используйте параметр *двконтекст* , чтобы указать контекст установки.</span><span class="sxs-lookup"><span data-stu-id="a38b5-134">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="a38b5-135">Используйте параметр *сзусерсид* , чтобы указать контекст пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-135">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="a38b5-136">Используйте функцию [**мсисаурцелистаддсаурцеекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) , чтобы создать список источников для исправления, которое еще не было применено к каким-либо приложениям в указанном контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-136">Use the [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to create a source list for a patch that has not yet been applied to any application in the specified context.</span></span> <span data-ttu-id="a38b5-137">Это может быть полезно при регистрации исправления для повышения привилегий.</span><span class="sxs-lookup"><span data-stu-id="a38b5-137">This can be useful when registering a patch to have elevated privileges.</span></span> <span data-ttu-id="a38b5-138">Дополнительные сведения о регистрации повышенных привилегий для исправления см. в статье об [установке исправлений Per-User управляемых приложениях](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="a38b5-138">For more information about registering elevated privileges for a patch, see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

<span data-ttu-id="a38b5-139">Используйте функцию [**мсисаурцелистклеарсаурце**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) для удаления существующего источника для приложения или исправления в указанном контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-139">Use the [**MsiSourceListClearSource**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) function to remove an existing source for an application or patch in a specified context.</span></span> <span data-ttu-id="a38b5-140">Удаление текущего источника для приложения или исправления приводит к тому, что установщик будет искать исходный список источника при следующей необходимости в источнике.</span><span class="sxs-lookup"><span data-stu-id="a38b5-140">Removing the current source for an application or patch forces the installer to search the source list for a source the next time a source is required.</span></span>

<span data-ttu-id="a38b5-141">Используйте функцию [**мсисаурцелистенумсаурцес**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) для перечисления источников в исходном списке указанного исправления или приложения.</span><span class="sxs-lookup"><span data-stu-id="a38b5-141">Use the [**MsiSourceListEnumSources**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) function to enumerate sources in the source list of a specified patch or application.</span></span>

## <a name="managing-media-sources-for-products-and-patches"></a><span data-ttu-id="a38b5-142">Управление источниками мультимедиа для продуктов и исправлений</span><span class="sxs-lookup"><span data-stu-id="a38b5-142">Managing Media sources for Products and Patches</span></span>

<span data-ttu-id="a38b5-143">Используйте функцию [**мсисаурцелистаддмедиадиск**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) для добавления или обновления сведений о диске источника носителя зарегистрированного приложения или исправления.</span><span class="sxs-lookup"><span data-stu-id="a38b5-143">Use the [**MsiSourceListAddMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) function to add or update the disk information of the media source of a registered application or patch.</span></span> <span data-ttu-id="a38b5-144">Каждая запись уникально идентифицируется с помощью идентификатора диска.</span><span class="sxs-lookup"><span data-stu-id="a38b5-144">Each entry is uniquely identified by a disk ID.</span></span> <span data-ttu-id="a38b5-145">Если диск уже существует, он будет обновлен с учетом новой метки тома и значений в строке диска.</span><span class="sxs-lookup"><span data-stu-id="a38b5-145">If the disk already exists, it is updated with the new volume label and disk prompt values.</span></span> <span data-ttu-id="a38b5-146">Если диск не существует, то создается новая запись диска с новыми значениями.</span><span class="sxs-lookup"><span data-stu-id="a38b5-146">If the disk does not exist, a new disk entry is created with the new values.</span></span>

<span data-ttu-id="a38b5-147">Используйте функцию [**мсисаурцелистклеармедиадиск**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) для удаления существующего зарегистрированного диска в источнике носителя для приложения или исправления в определенном контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-147">Use the [**MsiSourceListClearMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) function to remove an existing registered disk under the media source for an application or patch in a specific context.</span></span>

<span data-ttu-id="a38b5-148">Используйте функцию [**мсисаурцелистенуммедиадискс**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) для перечисления списка дисков, зарегистрированных в источнике мультимедиа для приложения или исправления.</span><span class="sxs-lookup"><span data-stu-id="a38b5-148">Use the [**MsiSourceListEnumMediaDisks**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) function to enumerate a list of disks registered under the media source for an application or patch.</span></span>

## <a name="retrieval-and-modification-of-source-list-information"></a><span data-ttu-id="a38b5-149">Получение и изменение сведений о списке источников</span><span class="sxs-lookup"><span data-stu-id="a38b5-149">Retrieval and modification of source list information</span></span>

<span data-ttu-id="a38b5-150">Используйте функции [**мсисаурцелистжетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) и [**мсисаурцелистсетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) , чтобы получить или изменить сведения о списке источников для приложения или исправления в определенном контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-150">Use the [**MsiSourceListGetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) and [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) functions to retrieve or modify information about the source list for an application or patch in a specific context.</span></span> <span data-ttu-id="a38b5-151">Используйте параметр *двконтекст* , чтобы указать контекст установки.</span><span class="sxs-lookup"><span data-stu-id="a38b5-151">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="a38b5-152">Используйте параметр *сзусерсид* , чтобы указать контекст пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-152">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="a38b5-153">Можно получить доступ к свойствам исходного списка, таким как [**медиапаккажепас**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **ластуседсаурце**, **ластуседтипе** и **PackageName** .</span><span class="sxs-lookup"><span data-stu-id="a38b5-153">Source list properties such as [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType**, and **PackageName** can be accessed.</span></span>

> [!Note]  
> <span data-ttu-id="a38b5-154">Свойство списка источников **ластуседтипе** может быть прочитано только.</span><span class="sxs-lookup"><span data-stu-id="a38b5-154">The **LastUsedType** source list property can only be read.</span></span> <span data-ttu-id="a38b5-155">Его нельзя задать напрямую с помощью функции [**мсисаурцелистсетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) .</span><span class="sxs-lookup"><span data-stu-id="a38b5-155">It cannot be set directly using the [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) function.</span></span>

 

## <a name="clearing-the-complete-source-list-or-forcing-a-source-resolution"></a><span data-ttu-id="a38b5-156">Очистка полного списка источников или принудительное разрешение источника</span><span class="sxs-lookup"><span data-stu-id="a38b5-156">Clearing the complete source list or forcing a source resolution</span></span>

<span data-ttu-id="a38b5-157">Используйте функцию [**мсисаурцелистклеараллекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) , чтобы удалить все существующие источники заданного типа источника для указанного приложения или экземпляра исправления.</span><span class="sxs-lookup"><span data-stu-id="a38b5-157">Use the [**MsiSourceListClearAllEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) function to remove all the existing sources of a given source type for the specified application or patch instance.</span></span> <span data-ttu-id="a38b5-158">Регистрация исправления также удаляется, если это исправление не установлено ни одним приложением в том же контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-158">The patch registration is also removed if the patch is not installed by any application in the same context.</span></span> <span data-ttu-id="a38b5-159">Используйте параметр *двконтекст* , чтобы указать контекст установки.</span><span class="sxs-lookup"><span data-stu-id="a38b5-159">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="a38b5-160">Используйте параметр *сзусерсид* , чтобы указать контекст пользователя.</span><span class="sxs-lookup"><span data-stu-id="a38b5-160">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="a38b5-161">Используйте [**мсисаурцелистфорцересолутионекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) , чтобы очистить последнюю использованную запись источника для приложения или исправления в указанном контексте.</span><span class="sxs-lookup"><span data-stu-id="a38b5-161">Use the [**MsiSourceListForceResolutionEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) to clear the last used source entry for an application or patch in the specified context.</span></span> <span data-ttu-id="a38b5-162">Эта функция удаляет регистрацию свойства с именем **ластуседсаурце**.</span><span class="sxs-lookup"><span data-stu-id="a38b5-162">This function removes the registration of the property called **LastUsedSource**.</span></span> <span data-ttu-id="a38b5-163">Эта функция не влияет на список зарегистрированных источников.</span><span class="sxs-lookup"><span data-stu-id="a38b5-163">This function does not affect the registered source list.</span></span> <span data-ttu-id="a38b5-164">Очистка регистрации **ластуседсаурце** приводит к тому, что установщик выполняет разрешение источника для зарегистрированных источников в следующий раз, когда ему потребуется источник.</span><span class="sxs-lookup"><span data-stu-id="a38b5-164">Clearing the **LastUsedSource** registration forces the installer to do a source resolution against the registered sources the next time it requires the source.</span></span>

 

 



