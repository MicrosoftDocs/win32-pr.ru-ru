---
description: Если это возможно, лучше всего указать целевое расположение для каталога, создав таблицу каталога в установочном пакете, чтобы предоставить правильное расположение. Дополнительные сведения см. в разделе Использование таблицы Directory.
ms.assetid: 2d16e036-2d7f-431d-b646-1addf2f65f3f
title: Изменение целевого расположения каталога
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 818c4e9d555244dd1637e19eb249478f13ea2d48
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264184"
---
# <a name="changing-the-target-location-for-a-directory"></a><span data-ttu-id="3b440-104">Изменение целевого расположения каталога</span><span class="sxs-lookup"><span data-stu-id="3b440-104">Changing the Target Location for a Directory</span></span>

<span data-ttu-id="3b440-105">Если это возможно, лучше всего указать целевое расположение для каталога, создав [таблицу каталога](directory-table.md) в установочном пакете, чтобы предоставить правильное расположение.</span><span class="sxs-lookup"><span data-stu-id="3b440-105">If possible, the best way to specify the target location for a directory is to author the [Directory Table](directory-table.md) in your installation package to provide the correct location.</span></span> <span data-ttu-id="3b440-106">Дополнительные сведения см. [в разделе Использование таблицы Directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="3b440-106">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>

<span data-ttu-id="3b440-107">Если необходимо изменить расположение каталога во время установки, можно выбрать один из следующих вариантов.</span><span class="sxs-lookup"><span data-stu-id="3b440-107">If you need to change the directory location at the time of the installation, you have the following options:</span></span>

-   <span data-ttu-id="3b440-108">Укажите расположение каталога, задав значение [общего свойства](public-properties.md) в командной строке.</span><span class="sxs-lookup"><span data-stu-id="3b440-108">Specify the location of a directory by setting the value of a [Public Property](public-properties.md) on the command line.</span></span> <span data-ttu-id="3b440-109">Во время [действия костфинализе](costfinalize-action.md)внутренние пути к каталогу, используемые установщиком, обновляются до значений свойств, указанных в виде ключей в [таблице Directory](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="3b440-109">During the [CostFinalize Action](costfinalize-action.md), the internal directory paths used by the installer are updated to the value of properties listed as keys in the [Directory Table](directory-table.md).</span></span> <span data-ttu-id="3b440-110">Дополнительные сведения см. в статьях [использование свойств](using-properties.md) и [Установка значений общих свойств в командной строке](setting-public-property-values-on-the-command-line.md).</span><span class="sxs-lookup"><span data-stu-id="3b440-110">For more information, see [Using Properties](using-properties.md) and [Setting Public Property Values on the Command Line](setting-public-property-values-on-the-command-line.md).</span></span>
-   <span data-ttu-id="3b440-111">Укажите расположение каталога с помощью настраиваемого действия.</span><span class="sxs-lookup"><span data-stu-id="3b440-111">Specify the location of a directory by using a custom action.</span></span> <span data-ttu-id="3b440-112">Если пользовательское действие выполняется перед [действием костфинализе](costfinalize-action.md), можно использовать [настраиваемое действие с типом 51](custom-action-type-51.md) , чтобы задать значение свойства из форматированной текстовой строки.</span><span class="sxs-lookup"><span data-stu-id="3b440-112">If the custom action is to run before the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 51](custom-action-type-51.md) to set the value of a property from a formatted text string.</span></span> <span data-ttu-id="3b440-113">Если пользовательское действие запускается после [действия костфинализе](costfinalize-action.md), можно использовать [настраиваемое действие с типом 35](custom-action-type-35.md) , чтобы задать значение пути к каталогу из форматированной текстовой строки.</span><span class="sxs-lookup"><span data-stu-id="3b440-113">If the custom action runs after the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 35](custom-action-type-35.md) to set the value of the directory path from a formatted text string.</span></span> <span data-ttu-id="3b440-114">Настраиваемые действия, которые изменяют одно из [системных свойств системной папки](property-reference.md) , должны быть включены в таблицы последовательности выполнения (таблицу [Инсталлексекутесекуенце](installexecutesequence-table.md) или таблицу [админексекутесекуенце](adminexecutesequence-table.md)) и таблицы последовательностей пользовательского интерфейса (таблицы [инсталлуисекуенце Table](installuisequence-table.md) и [админуисекуенце Table](adminuisequence-table.md)), чтобы папка была изменена во время [*полного пользовательского интерфейса*](f-gly.md) и [*базовой установки пользовательского интерфейса*](b-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="3b440-114">Custom actions that change one of the [System Folder Properties](property-reference.md) should be included in both the execution sequence tables ([InstallExecuteSequence Table](installexecutesequence-table.md) or [AdminExecuteSequence Table](adminexecutesequence-table.md)), and the user interface sequence tables ([InstallUISequence Table](installuisequence-table.md) and [AdminUISequence Table](adminuisequence-table.md)) so that the folder is changed during both [*full UI*](f-gly.md) and [*basic UI*](b-gly.md) installations.</span></span>
-   <span data-ttu-id="3b440-115">Если при установке выполняется [*полный пользовательский интерфейс*](f-gly.md), можно использовать [**Мсисеттаржетпас**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) или [сеттаржетпас таблице ControlEvent событие](settargetpath-controlevent.md) , чтобы задать путь к каталогу.</span><span class="sxs-lookup"><span data-stu-id="3b440-115">If the installation is running a [*full UI*](f-gly.md), you can use [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) or the [SetTargetPath ControlEvent](settargetpath-controlevent.md) to set the directory path.</span></span> <span data-ttu-id="3b440-116">Проверьте свойство [**продуктстате**](productstate.md) , чтобы определить, установлен ли продукт, содержащий этот компонент, перед вызовом **Мсисеттаржетпас** или сеттаржетпас таблице ControlEvent событие.</span><span class="sxs-lookup"><span data-stu-id="3b440-116">Check the [**ProductState**](productstate.md) Property to determine whether the product that contains this component is already installed before calling **MsiSetTargetPath** or the SetTargetPath ControlEvent.</span></span> <span data-ttu-id="3b440-117">Не пытайтесь изменить путь к целевому каталогу, если некоторые компоненты, использующие этот путь, уже установлены для текущего пользователя или другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="3b440-117">Do not attempt to change the target directory path if some components that use that path are already installed for the current user or a different user.</span></span>

<span data-ttu-id="3b440-118">На все указанные выше параметры распространяются следующие ограничения.</span><span class="sxs-lookup"><span data-stu-id="3b440-118">The following restrictions apply to all of the above options:</span></span>

-   <span data-ttu-id="3b440-119">Не пытайтесь изменить путь к целевому каталогу, если некоторые компоненты, использующие этот путь, уже установлены для текущего пользователя или для другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="3b440-119">Do not attempt to change the target directory path if some components that use the path are already installed for the current user or for a different user.</span></span>
-   <span data-ttu-id="3b440-120">Не пытайтесь изменить путь к целевому каталогу во время [установки обслуживания](maintenance-installation.md).</span><span class="sxs-lookup"><span data-stu-id="3b440-120">Do not attempt to change the target directory path during a [Maintenance Installation](maintenance-installation.md).</span></span>

 

 



