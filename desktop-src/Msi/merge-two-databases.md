---
description: Файл WiMerge.vbs VBScript предоставляется в Windows SDK компонентов для установщик Windows разработчиков. Этот пример скрипта выполняет слияние одной установщик Windows базы данных с другой базой данных. Дополнительные сведения см. в разделе слияния и преобразования.
ms.assetid: 31867082-7c1d-4530-a066-236d8ee5f023
title: Объединение двух баз данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0254cbe2bd0785b45d4ced3a16770023e617bc63
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105651153"
---
# <a name="merge-two-databases"></a><span data-ttu-id="7c82e-105">Объединение двух баз данных</span><span class="sxs-lookup"><span data-stu-id="7c82e-105">Merge Two Databases</span></span>

<span data-ttu-id="7c82e-106">Файл WiMerge.vbs VBScript предоставляется в [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="7c82e-106">The VBScript file WiMerge.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="7c82e-107">Этот пример скрипта выполняет слияние одной установщик Windows базы данных с другой базой данных.</span><span class="sxs-lookup"><span data-stu-id="7c82e-107">This sample script merges one Windows Installer database into another database.</span></span> <span data-ttu-id="7c82e-108">Дополнительные сведения см. в разделе [слияния и преобразования](merges-and-transforms.md).</span><span class="sxs-lookup"><span data-stu-id="7c82e-108">For more information, see [Merges and Transforms](merges-and-transforms.md).</span></span>

<span data-ttu-id="7c82e-109">Функцию [**мсидатабасемерже**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) и метод [**Merge**](database-merge.md) объекта [**Database**](database-object.md) нельзя использовать для слияния модулей, входящих в пакет установки.</span><span class="sxs-lookup"><span data-stu-id="7c82e-109">The [**MsiDatabaseMerge**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) function and the [**Merge**](database-merge.md) method of the [**Database**](database-object.md) object cannot be used to merge a module included in the installation package.</span></span> <span data-ttu-id="7c82e-110">Их не следует использовать для слияния [модулей слияния](merge-modules.md) в пакет установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="7c82e-110">They should not be used to merge [Merge Modules](merge-modules.md) into a Windows Installer package.</span></span> <span data-ttu-id="7c82e-111">Чтобы включить модуль слияния в пакет установки, авторы пакетов установки должны следовать рекомендациям, описанным в разделе [применение модулей слияния](applying-merge-modules.md) .</span><span class="sxs-lookup"><span data-stu-id="7c82e-111">To include a merge module in an installation package, authors of installation packages should follow the guidelines that are described in [Applying Merge Modules](applying-merge-modules.md) topic.</span></span>

<span data-ttu-id="7c82e-112">В примере демонстрируется использование следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="7c82e-112">The sample demonstrates the use of the following:</span></span>

-   [<span data-ttu-id="7c82e-113">**Метод Опендатабасе (объект установщика)**</span><span class="sxs-lookup"><span data-stu-id="7c82e-113">**OpenDatabase method (Installer Object)**</span></span>](installer-opendatabase.md)
-   <span data-ttu-id="7c82e-114">[**Метод ластерроррекорд**](installer-lasterrorrecord.md) [ **объекта Installer**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="7c82e-114">[**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer object**](installer-object.md)</span></span>
-   [<span data-ttu-id="7c82e-115">**Метод OpenView**</span><span class="sxs-lookup"><span data-stu-id="7c82e-115">**OpenView method**</span></span>](database-openview.md)
-   [<span data-ttu-id="7c82e-116">**Метод Merge**</span><span class="sxs-lookup"><span data-stu-id="7c82e-116">**Merge method**</span></span>](database-merge.md)
-   <span data-ttu-id="7c82e-117">[**Метод Commit**](database-commit.md) [ **объекта Database**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="7c82e-117">[**Commit method**](database-commit.md) of the [**Database object**](database-object.md)</span></span>
-   [<span data-ttu-id="7c82e-118">**Метод Fetch**</span><span class="sxs-lookup"><span data-stu-id="7c82e-118">**Fetch method**</span></span>](view-fetch.md)
-   [<span data-ttu-id="7c82e-119">**Просмотр объекта**</span><span class="sxs-lookup"><span data-stu-id="7c82e-119">**View object**</span></span>](view-object.md)
-   <span data-ttu-id="7c82e-120">[**Свойство StringData**](record-stringdata.md) [ **объекта Record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="7c82e-120">[**StringData property**](record-stringdata.md) of the [**Record object**](record-object.md)</span></span>

<span data-ttu-id="7c82e-121">Для использования этого образца необходимо иметь версию CScript.exe или WScript.exe версии сервера сценариев Windows.</span><span class="sxs-lookup"><span data-stu-id="7c82e-121">You must have the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="7c82e-122">Чтобы использовать CScript.exe для запуска этого образца, введите командную строку в командной строке, используя следующий синтаксис.</span><span class="sxs-lookup"><span data-stu-id="7c82e-122">To use CScript.exe to run this sample, type a command line at the command prompt using the following syntax.</span></span> <span data-ttu-id="7c82e-123">Если первый аргумент имеет значение/?, отображается справка.</span><span class="sxs-lookup"><span data-stu-id="7c82e-123">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="7c82e-124">или, если указано слишком мало аргументов.</span><span class="sxs-lookup"><span data-stu-id="7c82e-124">or if too few arguments are specified.</span></span> <span data-ttu-id="7c82e-125">Чтобы перенаправить выходные данные в файл, завершите командную строку с помощью VBS > \[ путь к файлу \] .</span><span class="sxs-lookup"><span data-stu-id="7c82e-125">To redirect the output to a file, end the command line with VBS > \[path to file\].</span></span> <span data-ttu-id="7c82e-126">Пример возвращает значение 0 для успешного выполнения, 1, если вызывается Справка, и 2 в случае сбоя сценария.</span><span class="sxs-lookup"><span data-stu-id="7c82e-126">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="7c82e-127">**cscript WiMerge.vbs \[ путь к пути к базе данных \] \[ для импортированной таблицы базы данных \] \[\]**</span><span class="sxs-lookup"><span data-stu-id="7c82e-127">**cscript WiMerge.vbs \[path to database\]\[path to imported database\]\[table name\]**</span></span>

<span data-ttu-id="7c82e-128">Укажите путь к установщик Windows базе данных, получающей слияние.</span><span class="sxs-lookup"><span data-stu-id="7c82e-128">Specify the path to the Windows Installer database that is receiving the merge.</span></span> <span data-ttu-id="7c82e-129">Укажите путь к базе данных, импортируемой в первую очередь.</span><span class="sxs-lookup"><span data-stu-id="7c82e-129">Specify the path to the database being imported into the first.</span></span> <span data-ttu-id="7c82e-130">Можно указать необязательное имя таблицы для хранения ошибок слияния.</span><span class="sxs-lookup"><span data-stu-id="7c82e-130">You may specify an optional name for a table to hold the merge errors.</span></span> <span data-ttu-id="7c82e-131">Если имя таблицы не указано, установщик использует имя \_ мержееррорс и удаляет таблицу после отображения содержимого.</span><span class="sxs-lookup"><span data-stu-id="7c82e-131">If no table name is specified, the installer uses the name \_MergeErrors and drops the table after displaying the contents.</span></span>

<span data-ttu-id="7c82e-132">Дополнительные примеры сценариев см. в разделе [установщик Windows примеры сценариев](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="7c82e-132">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="7c82e-133">Примеры служебных программ, для которых не требуется сервер сценариев Windows, см. в разделе [установщик Windows средства разработки](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="7c82e-133">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



