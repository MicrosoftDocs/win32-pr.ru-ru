---
description: В этом разделе приведены рекомендации по обновлению сборок с помощью установщик Windows исправлений.
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: Обновление сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104081609"
---
# <a name="updating-assemblies"></a><span data-ttu-id="03acd-103">Обновление сборок</span><span class="sxs-lookup"><span data-stu-id="03acd-103">Updating Assemblies</span></span>

<span data-ttu-id="03acd-104">В этом разделе приведены рекомендации по обновлению сборок с помощью установщик Windows исправлений.</span><span class="sxs-lookup"><span data-stu-id="03acd-104">The information in this topic identifies the recommended guidelines for updating assemblies using Windows Installer patches.</span></span>

<span data-ttu-id="03acd-105">Авторы обновлений сборок могут использовать следующие рекомендации, которые применяются ко всем типам сборок:</span><span class="sxs-lookup"><span data-stu-id="03acd-105">Authors of assembly updates can use the following guidelines, which apply to all types of assemblies:</span></span>

-   <span data-ttu-id="03acd-106">Рекомендуемым методом для обновления сборки является изменение строгого имени сборки в [таблице мсиассемблинаме](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="03acd-106">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span> <span data-ttu-id="03acd-107">Новая версия сборки может предоставляться новым компонентом или тем же компонентом, который предоставляет старую версию.</span><span class="sxs-lookup"><span data-stu-id="03acd-107">The new assembly version can be provided by a new component or by the same component that provides the old version.</span></span>
-   <span data-ttu-id="03acd-108">Если новая версия сборки предоставляется тем же компонентом, не изменяйте тип сборки с платформа .NET Framework сборки на сборку Win32 или наоборот.</span><span class="sxs-lookup"><span data-stu-id="03acd-108">If the new assembly version is provided by the same component, do not change the assembly type from a .NET Framework assembly to a Win32 assembly or vice versa.</span></span>
-   <span data-ttu-id="03acd-109">Если все приложения в системе должны использовать обновленную сборку, следует развернуть сборку политики.</span><span class="sxs-lookup"><span data-stu-id="03acd-109">If all applications on the system must use the updated assembly, you should deploy a policy assembly.</span></span> <span data-ttu-id="03acd-110">Сборка политики может перенаправлять приложения в системе для использования новой версии сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-110">A policy assembly can redirect applications on the system to use the new assembly version.</span></span> <span data-ttu-id="03acd-111">Сборки политик должны быть предоставлены путем создания нового компонента.</span><span class="sxs-lookup"><span data-stu-id="03acd-111">Policy assemblies should be provided by creating a new component.</span></span>
-   <span data-ttu-id="03acd-112">Для удаления обновлений сборки требуется установщик Windows 3,0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="03acd-112">Windows Installer 3.0 or later is required to uninstall assembly updates.</span></span> <span data-ttu-id="03acd-113">Дополнительные сведения см. в разделе [Удаление исправлений](removing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="03acd-113">For more information, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="03acd-114">Новая версия сборки должна содержать те же или более старшие версии файлов из ранее выпущенных сборок.</span><span class="sxs-lookup"><span data-stu-id="03acd-114">The newer version of the assembly should contain the same or higher versions of files from previously released assemblies.</span></span>
-   <span data-ttu-id="03acd-115">Установщик Windows 3,0 может обслуживать платформа .NET Framework и сборки Win32 с помощью полной замены файла или меньшего разностного обновления.</span><span class="sxs-lookup"><span data-stu-id="03acd-115">Windows Installer 3.0 can service .NET Framework and Win32 assemblies by a complete file replacement or by a smaller delta update.</span></span> <span data-ttu-id="03acd-116">Дополнительные сведения см. в разделе [уменьшение размера исправления](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="03acd-116">For more information, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="03acd-117">Если обновление изменяет строгое имя сборки, таблица [мсипатчолдассемблифиле](msipatcholdassemblyfile-table.md) и таблица [мсипатчолдассемблинаме](msipatcholdassemblyname-table.md) являются обязательными, если у пакета исправлений нет таблицы [мсипатчсекуенце](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="03acd-117">If your update changes the strong name of the assembly, the [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) table and [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) table are required if the patch package does not have a [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="03acd-118">Таблица Мсипатчолдассемблифиле и таблица Мсипатчолдассемблинаме не требуются, если пакет исправлений содержит сведения о последовательности исправлений в таблице Мсипатчсекуенце.</span><span class="sxs-lookup"><span data-stu-id="03acd-118">The MsiPatchOldAssemblyFile table and MsiPatchOldAssemblyName table are not required if the patch package has patch sequencing information in a MsiPatchSequence table.</span></span>
-   <span data-ttu-id="03acd-119">Перед снятием нового исправления следует проверить его, применив к нему все ранее выпущенные исправления.</span><span class="sxs-lookup"><span data-stu-id="03acd-119">Before releasing a new patch, test the patch by applying it with all previously released patches.</span></span>

## <a name="updating-win32-assemblies"></a><span data-ttu-id="03acd-120">Обновление сборок Win32</span><span class="sxs-lookup"><span data-stu-id="03acd-120">Updating Win32 Assemblies</span></span>

<span data-ttu-id="03acd-121">При обновлении сборок Win32 используйте следующие рекомендации.</span><span class="sxs-lookup"><span data-stu-id="03acd-121">Use the following guidelines when you update Win32 assemblies:</span></span>

-   <span data-ttu-id="03acd-122">Измените строгое имя новой сборки, указанной в [таблице мсиассемблинаме](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="03acd-122">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="03acd-123">Если вы хотите, чтобы приложение всегда использовало новую версию сборки, не влияя на версию сборки, используемую другими приложениями в системе, используйте тот же компонент для размещения новой версии сборки, которая использовалась для старой версии сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-123">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="03acd-124">Используйте тот же ComponentId в таблице [Component](component-table.md) .</span><span class="sxs-lookup"><span data-stu-id="03acd-124">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="03acd-125">После исправления приложения оно содержит только ссылку на новую версию сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-125">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="03acd-126">Старая версия сборки может остаться в новой версии в глобальном кэше сборок.</span><span class="sxs-lookup"><span data-stu-id="03acd-126">The old version of the assembly can remain with the new version in the global assembly cache.</span></span> <span data-ttu-id="03acd-127">Это не влияет на другие приложения в системе, которые используют старую версию сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-127">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="03acd-128">Если один и тот же компонент используется как для новой, так и для старой версий сборки, обновление может быть небольшим разностным исправлением.</span><span class="sxs-lookup"><span data-stu-id="03acd-128">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="03acd-129">Если новая версия сборки несовместима со всеми системами, в которых требуется установить приложение, можно установить новую и старую версии сборки в виде параллельных сборок.</span><span class="sxs-lookup"><span data-stu-id="03acd-129">If the new version of the assembly is not compatible with all the systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="03acd-130">Чтобы установить обе версии сборки параллельно, создайте новый компонент, который будет содержать новую версию сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-130">To install both assembly versions side-by-side, create a new component to contain the new assembly version.</span></span> <span data-ttu-id="03acd-131">Компонент ComponentId в таблице [Component](component-table.md) для нового компонента должен отличаться от ComponentID компонента с старой версией.</span><span class="sxs-lookup"><span data-stu-id="03acd-131">The ComponentId in the [Component](component-table.md) table for the new component should be different from the ComponentId of the component with the old version.</span></span> <span data-ttu-id="03acd-132">После исправления приложения оно содержит ссылки на обе версии сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-132">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="03acd-133">Затем приложение можно направить в совместимую версию сборки с помощью манифеста.</span><span class="sxs-lookup"><span data-stu-id="03acd-133">Then the application can be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="03acd-134">Если для новых и старых версий сборки используются разные компоненты, то обновление использует полную замену файлов.</span><span class="sxs-lookup"><span data-stu-id="03acd-134">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>

## <a name="updating-net-framework-assemblies"></a><span data-ttu-id="03acd-135">Обновление сборок платформа .NET Framework</span><span class="sxs-lookup"><span data-stu-id="03acd-135">Updating .NET Framework Assemblies</span></span>

<span data-ttu-id="03acd-136">При обновлении сборок платформа .NET Framework используйте следующие рекомендации.</span><span class="sxs-lookup"><span data-stu-id="03acd-136">Use the following guidelines when you update .NET Framework assemblies.</span></span>

-   <span data-ttu-id="03acd-137">Измените строгое имя новой сборки, указанной в [таблице мсиассемблинаме](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="03acd-137">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="03acd-138">Если вы хотите, чтобы приложение всегда использовало новую версию сборки, не влияя на версию сборки, используемую другими приложениями в системе, измените строгое имя новой сборки, которая указана в [таблице мсиассемблинаме](msiassemblyname-table.md), и используйте тот же компонент для размещения новой версии сборки, которая использовалась для старой версии сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-138">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="03acd-139">Используйте тот же ComponentId в таблице [Component](component-table.md) .</span><span class="sxs-lookup"><span data-stu-id="03acd-139">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="03acd-140">После исправления приложения оно содержит только ссылку на новую версию сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-140">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="03acd-141">Старая версия сборки может остаться в новой версии в глобальном кэше.</span><span class="sxs-lookup"><span data-stu-id="03acd-141">The old version of the assembly can remain with the new version in the global cache.</span></span> <span data-ttu-id="03acd-142">Это не влияет на другие приложения в системе, которые используют старую версию сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-142">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="03acd-143">Если один и тот же компонент используется как для новой, так и для старой версий сборки, обновление может быть небольшим разностным исправлением.</span><span class="sxs-lookup"><span data-stu-id="03acd-143">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="03acd-144">Если новая версия сборки несовместима со всеми системами, в которых требуется установить приложение, можно установить новую и старую версии сборки в виде параллельных сборок.</span><span class="sxs-lookup"><span data-stu-id="03acd-144">If the new version of the assembly is not compatible with all systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="03acd-145">Чтобы установить обе версии сборки параллельно, измените строгое имя новой сборки, указанной в [таблице мсиассемблинаме](msiassemblyname-table.md), и создайте новый компонент, содержащий новую версию сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-145">To install both assembly versions side-by-side, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and create a new component to contain the new assembly version.</span></span> <span data-ttu-id="03acd-146">Компонент ComponentId в таблице [Component](component-table.md) для нового компонента должен отличаться от ComponentID компонента, имеющего старую версию.</span><span class="sxs-lookup"><span data-stu-id="03acd-146">The ComponentId in the [Component](component-table.md) table for the new component should be different than the ComponentId of the component with the old version.</span></span> <span data-ttu-id="03acd-147">После исправления приложения оно содержит ссылки на обе версии сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-147">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="03acd-148">Затем приложение может быть направлено в совместимую версию сборки с помощью манифеста.</span><span class="sxs-lookup"><span data-stu-id="03acd-148">The application can then be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="03acd-149">Если для новых и старых версий сборки используются разные компоненты, то обновление использует полную замену файлов.</span><span class="sxs-lookup"><span data-stu-id="03acd-149">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>
-   <span data-ttu-id="03acd-150">Обновление на месте перезаписывает копию платформа .NET Framework сборки в глобальный кэш сборок.</span><span class="sxs-lookup"><span data-stu-id="03acd-150">An in-place update overwrites the copy of a .NET Framework Assembly in the global assembly cache.</span></span> <span data-ttu-id="03acd-151">Этот тип обновления сборки не изменяет строгое имя сборки.</span><span class="sxs-lookup"><span data-stu-id="03acd-151">This type of assembly update does not change the strong name of the assembly.</span></span> <span data-ttu-id="03acd-152">Изменяется только значение в поле FileVersion [таблицы мсиассемблинаме](msiassemblyname-table.md) .</span><span class="sxs-lookup"><span data-stu-id="03acd-152">Only the value in the FileVersion field of the [MsiAssemblyName table](msiassemblyname-table.md) is changed.</span></span> <span data-ttu-id="03acd-153">Для обновления на месте платформа .NET Framework сборки требуется платформа .NET Framework 1,1 с пакетом обновления 1 (SP1) или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="03acd-153">The in-place update of a .NET Framework Assembly requires .NET Framework 1.1 SP1 or greater.</span></span>
    > [!Note]  
    > <span data-ttu-id="03acd-154">Тип обновления на месте перезаписывает копию сборки в глобальном кэше и может разрушить работу других приложений, если новая версия сборки не полностью совместима с обратной совместимостью.</span><span class="sxs-lookup"><span data-stu-id="03acd-154">The in-place type of update overwrites the copy of the assembly in the global cache, and can break other applications if the new version of the assembly is not completely backward compatible.</span></span> <span data-ttu-id="03acd-155">Рекомендуемым методом для обновления сборки является изменение строгого имени сборки в [таблице мсиассемблинаме](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="03acd-155">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

     

 

 



