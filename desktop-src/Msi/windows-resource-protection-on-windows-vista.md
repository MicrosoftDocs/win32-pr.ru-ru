---
description: Установщик Windows придерживается защита ресурсов Windows (WRP) при установке необходимых системных файлов, папок и данных реестра в Windows Server 2008 и более поздних версиях и Windows Vista и более поздних версиях.
ms.assetid: 38865ee1-22ef-430b-99ce-1c6983c3b51f
title: Использование установщик Windows и защита ресурсов Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72808184ff11b29bfeb02dda576e9393e34189fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103998738"
---
# <a name="using-windows-installer-and-windows-resource-protection"></a>Использование установщик Windows и защита ресурсов Windows

Установщик Windows придерживается защита ресурсов Windows (WRP) при установке необходимых системных файлов, папок и данных реестра в Windows Server 2008 и более поздних версиях и Windows Vista и более поздних версиях.

WRP в Windows Server 2008 и Windows Vista заменяет защиту файлов Windows (WFP) в Windows Server 2003, Windows XP и Windows 2000. Разработчикам установщик Windows следует отметить следующие изменения в том, как установщик обрабатывает защищенные ресурсы в Windows Server 2008 и более поздних версиях, а также в Windows Vista и более поздних версиях.

-   При работе в Windows Server 2008 и более поздних версий или Windows Vista и более поздних версиях установщик Windows пропускает установку любого файла, защищенного WRP, установщик вводит предупреждение в файл журнала и продолжит выполнение оставшейся части установки без ошибки. В Windows Server 2003, Windows XP и Windows 2000, когда установщик Windows обнаружил файл, защищенный с помощью WFP, установщик запрашивает установку файла в WFP.
-   WRP в Windows Server 2008 и более поздних версиях или Windows Vista и более поздних версий может защищать разделы реестра в дополнение к файлам. Если установщик Windows обнаруживает раздел реестра, защищенный WRP, установщик пропускает установку этого раздела реестра, установщик вводит предупреждение в файл журнала и продолжит выполнение оставшейся части установки без ошибки.
-   Обратите внимание, что если компонент установщик Windows содержит файл или раздел реестра, защищенный WRP, этот ресурс должен использоваться в качестве ключевого пути для компонента. В этом случае установщик Windows не устанавливает, не обновляет или не удаляет компонент. В пакет установки не следует включать защищенные ресурсы. Вместо этого следует использовать [поддерживаемые механизмы замены ресурсов](../wfp/supported-file-replacement-mechanisms.md) для [Защита ресурсов Windows](../wfp/windows-resource-protection-portal.md).

Дополнительные сведения о WRP см. в разделе [Защита ресурсов Windows](../wfp/windows-resource-protection-portal.md) и сведения, предоставляемые [Microsoft TechNet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10)).

## <a name="wfp-for-windows-server-2003-and-windows-xp2000"></a>WFP для Windows Server 2003 и Windows XP/2000

Установщик Windows соответствует защите файлов Windows (WFP) при установке необходимых системных файлов в Windows Server 2003, Windows XP и Windows 2000. Если защищенный системный файл изменяется автоматической установкой приложения, WFP восстанавливает файл в проверенной версии.

Установщик Windows никогда не пытается установить или заменить защищенный файл. Если действие [инсталлфилес](installfiles-action.md) или любое другое действие, запланированное до инсталлфилес, пытается установить файл, защищенный на windows Server 2003, Windows XP или Windows 2000, УСТАНОВЩИК вызывает WFP с запросом на установку или замену защищенного файла. Установщик запрашивает установку файлов из WFP сразу же после выполнения действия Инсталлфилес. WFP устанавливает или заменяет файл в системе пользователя кэшированной версией защищенного файла. Обратите внимание, что это не гарантирует, что версия файла, установленного из кэша, является версией, требуемой для приложения. После установки файла WFP установщик определяет, совпадает ли эта версия с версией в пакете. Если версия файла в пакете больше установленной версии, установщик информирует пользователя, что ему не удается обновить систему и что для приложения может потребоваться обновление операционной системы.

Если какое-либо действие, упорядоченное после [инсталлфилес](installfiles-action.md) , попытается установить или заменить защищенный файл, еще не установленный в системе, установщик не сможет вызвать WFP для установки файла. В этом случае установщик информирует пользователя, что ему не удается обновить систему, и что для приложения может потребоваться обновление операционной системы.

Установщик также проверяет WFP при удалении файлов и никогда не пытается удалить защищенные системные файлы.

## <a name="component-key-files-protected-by-wfp"></a>Файлы ключей компонентов, защищенные WFP

Обратите внимание, что если компонент установщик Windows содержит файл WFP, этот файл должен быть указан в качестве пути к ключу для компонента.

Когда установщик пытается установить файл ключа компонента в Windows Server 2003, Windows XP или Windows 2000, он сначала вызывает WFP, чтобы определить, защищен ли файл ключа. Если файл ключа компонента защищен с помощью WFP и этот файл ключа уже установлен, установщик обновляет компонент, только если версия файла ключа в пакете превышает установленную версию. Если пакет установки указывает, что компонент должен быть установлен, а файл ключа компонента в данный момент не установлен, то независимо от того, защищен ли файл ключа, установщик устанавливает компонент. После установки любого компонента, защищенного с помощью WFP, он устанавливается окончательно, а установщик никогда не удаляет или не заменяет компонент.

## <a name="installation-of-assemblies-by-wfp"></a>Установка сборок с помощью WFP

WFP для сборок отличается от WFP для системных файлов.

WFP защищает системные файлы Windows Server 2003, Windows XP и Windows 2000, выявляя попытки замены защищенных системных файлов. Эта защита активируется после того, как WFP получает уведомление об изменении каталога для файла в защищенном каталоге. Когда WFP получает это уведомление, он определяет, какой файл был изменен. Если файл защищен, WFP ищет подпись файла в статическом файле каталога, чтобы определить, является ли новый файл правильной версией. Если версия файла неверна, система заменяет файл правильной версией из кэша или с дистрибутивного носителя.

Напротив, WFP сборок является динамическим. WFP распространяется на файлы по мере их добавления в общий кэш сборок параллельного использования. Если сборка повреждена, WFP запросит, что файл будет заменен установщиком. Установщик Windows может или не может заменить файл в зависимости от того, доступен ли исходный пакет. Если исходный пакет недоступен, WFP создаст диалоговое окно с сообщением о том, что не удается восстановить файл.

Обратите внимание, что неуправляемые общие параллельные сборки, установленные в% WINDIR% \\ WinSxS, защищены с помощью WFP. Неуправляемые закрытые сборки, установленные в каталоге приложения, не защищаются с помощью WFP. Управляемые глобальные сборки, установленные в каталоге приложения или сборки GAC% WINDIR% \\ \\ , не защищаются с помощью WFP.

## <a name="related-topics"></a>См. также

<dl> <dt>

[защита ресурсов Windows](../wfp/windows-resource-protection-portal.md)
</dt> </dl>

 

 
