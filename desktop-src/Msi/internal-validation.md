---
description: При создании пакета установки можно использовать функцию Мсивиевмодифи или метод View. Modify, чтобы убедиться, что введенные данные синтаксически верны.
ms.assetid: c960e9df-dcd6-44d2-8662-40a1dea81f45
title: Внутренняя проверка
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca3c1a9e6f7b7e35b4d7d91287af64eff7812de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104143840"
---
# <a name="internal-validation"></a><span data-ttu-id="0c441-103">Внутренняя проверка</span><span class="sxs-lookup"><span data-stu-id="0c441-103">Internal Validation</span></span>

<span data-ttu-id="0c441-104">При создании пакета установки можно использовать функцию [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) или метод View. Modify, чтобы убедиться, что введенные данные синтаксически верны.</span><span class="sxs-lookup"><span data-stu-id="0c441-104">When authoring an installation package, you can use the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function or the View.Modify method to ensure that the data you enter is syntactically correct.</span></span> <span data-ttu-id="0c441-105">Дополнительные сведения см. в разделе [**метод Modify**](view-modify.md).</span><span class="sxs-lookup"><span data-stu-id="0c441-105">For more information, see [**Modify method**](view-modify.md).</span></span> <span data-ttu-id="0c441-106">На самом низком уровне столбец таблицы базы данных может хранить целые числа (короткие или длинные), строки или двоичные данные.</span><span class="sxs-lookup"><span data-stu-id="0c441-106">At the lowest level, a database table's column can store integers (short or long), strings, or binary data.</span></span> <span data-ttu-id="0c441-107">Однако для пакета установки требуются определенные целые числа или строки в определенных таблицах.</span><span class="sxs-lookup"><span data-stu-id="0c441-107">However, an installation package requires specific integers or strings in certain tables.</span></span> <span data-ttu-id="0c441-108">Эти спецификации хранятся в [ \_ таблице проверки](-validation-table.md).</span><span class="sxs-lookup"><span data-stu-id="0c441-108">These specifications are maintained in the [\_Validation table](-validation-table.md).</span></span> <span data-ttu-id="0c441-109">Например, столбец FileName [таблицы File](file-table.md) представляет собой строковый столбец, но в частности, он хранит имя файла.</span><span class="sxs-lookup"><span data-stu-id="0c441-109">For example, the FileName column of the [File table](file-table.md) is a string column, but it specifically stores a file name.</span></span> <span data-ttu-id="0c441-110">Поэтому не только следует, чтобы ваша запись была строкой, но также должна соответствовать требованиям к именам файлов.</span><span class="sxs-lookup"><span data-stu-id="0c441-110">Therefore, not only should your entry be a string, but it should also follow the requirements for naming files.</span></span>

<span data-ttu-id="0c441-111">Различные значения перечисления проверки, используемые с функцией [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) , позволяют выполнять немедленную проверку на разных уровнях.</span><span class="sxs-lookup"><span data-stu-id="0c441-111">The various validation enum values used with the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function allow for immediate validation at different levels.</span></span> <span data-ttu-id="0c441-112">\_ \_ Перечисление полей мсимодифи Validate можно использовать для проверки отдельных полей записи.</span><span class="sxs-lookup"><span data-stu-id="0c441-112">The MSIMODIFY\_VALIDATE\_FIELD enum can be used to validate individual fields of a record.</span></span> <span data-ttu-id="0c441-113">Внешние ключи не проверяются.</span><span class="sxs-lookup"><span data-stu-id="0c441-113">It does not validate foreign keys.</span></span> <span data-ttu-id="0c441-114">МСИМОДИФИ \_ Validate enum проверяет всю строку и включает проверку внешнего ключа.</span><span class="sxs-lookup"><span data-stu-id="0c441-114">The MSIMODIFY\_VALIDATE enum validates an entire row and includes foreign key validation.</span></span> <span data-ttu-id="0c441-115">При вставке новой строки в таблицу используйте МСИМОДИФИ \_ проверить \_ новое перечисление, чтобы убедиться, что вы добавляете допустимые данные, а также используете уникальные первичные ключи.</span><span class="sxs-lookup"><span data-stu-id="0c441-115">If you are inserting a new row into a table, use the MSIMODIFY\_VALIDATE\_NEW enum to verify that you are adding valid data as well as using unique primary keys.</span></span> <span data-ttu-id="0c441-116">Вставка завершается ошибкой, если первичные ключи не являются уникальными.</span><span class="sxs-lookup"><span data-stu-id="0c441-116">An insert fails if the primary keys are not unique.</span></span> <span data-ttu-id="0c441-117">Если вызов **мсивиевмодифи** с одним из перечислений проверки возвращает ошибку, можно выполнить повторные вызовы [**мсивиевжетеррор**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) для диагностики проблемы.</span><span class="sxs-lookup"><span data-stu-id="0c441-117">If a call to **MsiViewModify** with one of the validation enums returns an error, you can make repeated calls to [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) for diagnosing the problem.</span></span> <span data-ttu-id="0c441-118">**Мсивиевжетеррор** указывает столбец, в котором произошла ошибка, а также значение перечисления, помогающее устранить проблему.</span><span class="sxs-lookup"><span data-stu-id="0c441-118">**MsiViewGetError** indicates the column where the error occurred as well as the enum value to help fix the problem.</span></span> <span data-ttu-id="0c441-119">Дополнительные сведения см. в разделе [**метод метода WebMethod**](view-geterror.md).</span><span class="sxs-lookup"><span data-stu-id="0c441-119">For more information, see [**GetError method**](view-geterror.md).</span></span>

<span data-ttu-id="0c441-120">Можно также использовать внутреннюю проверку, чтобы убедиться, что другие авторы правильно вводят данные в настраиваемую таблицу.</span><span class="sxs-lookup"><span data-stu-id="0c441-120">You can also use internal validation to ensure that other authors enter data correctly into your custom table.</span></span> <span data-ttu-id="0c441-121">Добавьте каждый из столбцов настраиваемой таблицы в \_ таблицу проверки, используя имя настраиваемой таблицы и имя столбца в качестве первичного ключа.</span><span class="sxs-lookup"><span data-stu-id="0c441-121">Add each of the columns of your custom table to the \_Validation table using the custom table name and column name as the primary key.</span></span> <span data-ttu-id="0c441-122">Введите описание или назначение каждого столбца в столбце Описание \_ таблицы проверки.</span><span class="sxs-lookup"><span data-stu-id="0c441-122">Provide a description or purpose of each column in the Description column of the \_Validation table.</span></span> <span data-ttu-id="0c441-123">Введите применимые требования для каждого столбца с помощью значений NULL, MinValue, MaxValue, Кэйтабле, KeyColumn, Category и Set.</span><span class="sxs-lookup"><span data-stu-id="0c441-123">Enter the applicable requirements for each column using the Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Category, and Set columns:</span></span>

-   <span data-ttu-id="0c441-124">Если столбец допускает значения NULL, введите "Y".</span><span class="sxs-lookup"><span data-stu-id="0c441-124">If the column is Nullable, enter a 'Y'.</span></span> <span data-ttu-id="0c441-125">Если это не так, введите "N".</span><span class="sxs-lookup"><span data-stu-id="0c441-125">If not, enter a 'N'.</span></span>
-   <span data-ttu-id="0c441-126">Если столбец представляет собой целочисленный столбец и может содержать диапазон целых чисел, введите этот диапазон с помощью столбцов MinValue и MaxValue.</span><span class="sxs-lookup"><span data-stu-id="0c441-126">If the column is an integer column and can contain a range of integers, enter that range using the MinValue and MaxValue columns.</span></span>
-   <span data-ttu-id="0c441-127">Внешние ключевые столбцы идентифицируются с помощью столбцов Кэйтабле и KeyColumn.</span><span class="sxs-lookup"><span data-stu-id="0c441-127">Foreign key columns are identified using the KeyTable and KeyColumn columns.</span></span>
-   <span data-ttu-id="0c441-128">Для строковых столбцов укажите категорию, например имя файла, GUID или идентификатор.</span><span class="sxs-lookup"><span data-stu-id="0c441-128">For string columns, specify a Category such as Filename, GUID, or Identifier.</span></span> <span data-ttu-id="0c441-129">Дополнительные сведения см. в разделе [типы данных столбцов](column-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="0c441-129">For more information, see [column data types](column-data-types.md).</span></span>
-   <span data-ttu-id="0c441-130">Если данные могут быть связаны только с конкретным числом значений (String или Integer), используйте столбец Set для перечисления допустимых значений.</span><span class="sxs-lookup"><span data-stu-id="0c441-130">If the data can only pertain to a specific number of values (string or integer), use the Set column to list the acceptable values.</span></span>

<span data-ttu-id="0c441-131">Ниже приведен список столбцов (в дополнение к таблице, столбцу и описанию) в \_ таблице проверки, которые могут быть заполнены, если столбец имеет указанный тип.</span><span class="sxs-lookup"><span data-stu-id="0c441-131">The following is a list of the columns (in addition to Table, Column, and Description) in the \_Validation table that can be filled in if your column is of the specified type.</span></span> <span data-ttu-id="0c441-132">(Обратите внимание, что не нужно заполнять все столбцы.)</span><span class="sxs-lookup"><span data-stu-id="0c441-132">(Note that you do not have to fill in all the columns.)</span></span>



| <span data-ttu-id="0c441-133">Тип</span><span class="sxs-lookup"><span data-stu-id="0c441-133">Type</span></span>    | <span data-ttu-id="0c441-134">Столбцы</span><span class="sxs-lookup"><span data-stu-id="0c441-134">Columns</span></span>                                                          |
|---------|------------------------------------------------------------------|
| <span data-ttu-id="0c441-135">Целочисленный тип</span><span class="sxs-lookup"><span data-stu-id="0c441-135">Integer</span></span> | <span data-ttu-id="0c441-136">Nullable, MinValue, MaxValue, Кэйтабле, KeyColumn, Set</span><span class="sxs-lookup"><span data-stu-id="0c441-136">Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Set</span></span>           |
| <span data-ttu-id="0c441-137">Строка</span><span class="sxs-lookup"><span data-stu-id="0c441-137">String</span></span>  | <span data-ttu-id="0c441-138">Nullable, Кэйтабле, KeyColumn, Category, Set, MinValue, MaxValue</span><span class="sxs-lookup"><span data-stu-id="0c441-138">Nullable, KeyTable, KeyColumn, Category, Set, MinValue, MaxValue</span></span> |
| <span data-ttu-id="0c441-139">Двоичные данные</span><span class="sxs-lookup"><span data-stu-id="0c441-139">Binary</span></span>  | <span data-ttu-id="0c441-140">Nullable, Категория (категория должна быть "binary")</span><span class="sxs-lookup"><span data-stu-id="0c441-140">Nullable, Category (Category must be "Binary")</span></span>                   |



 

<span data-ttu-id="0c441-141">В средах разработки может использоваться МСИМОДИФИ \_ Validate \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="0c441-141">Authoring environments may make use of MSIMODIFY\_VALIDATE\_DELETE.</span></span> <span data-ttu-id="0c441-142">В этом перечислении предполагается, что необходимо удалить строку.</span><span class="sxs-lookup"><span data-stu-id="0c441-142">This enum assumes that you want to delete the row.</span></span> <span data-ttu-id="0c441-143">Проверка поля или внешнего ключа не выполняется.</span><span class="sxs-lookup"><span data-stu-id="0c441-143">No field or foreign key validation is performed.</span></span> <span data-ttu-id="0c441-144">Это перечисление фактически выполняет обратную проверку внешнего ключа.</span><span class="sxs-lookup"><span data-stu-id="0c441-144">This enum actually performs a reverse foreign key validation.</span></span> <span data-ttu-id="0c441-145">Он проверяет \_ таблицу проверки на наличие ссылок в столбцах кэйтабле и KeyColumn таблицы, к которой принадлежит строка "Deleted".</span><span class="sxs-lookup"><span data-stu-id="0c441-145">It checks the \_Validation table for references in the KeyTable and KeyColumn columns for the table to which the "deleted" row belongs.</span></span> <span data-ttu-id="0c441-146">Если имеются столбцы, содержащие таблицу, содержащую строку "Deleted", в качестве возможного внешнего ключа, она циклически проходит по этому столбцу, чтобы проверить, не ссылаются ли значения на ссылочные значения в строке "удалено".</span><span class="sxs-lookup"><span data-stu-id="0c441-146">If there are columns that list the table containing the "deleted" row as a potential foreign key, it cycles through that column to see if any of the values reference values in the "deleted" row.</span></span> <span data-ttu-id="0c441-147">Возврат ошибки означает разрыв реляционной целостности базы данных путем удаления строки.</span><span class="sxs-lookup"><span data-stu-id="0c441-147">An error return means that you break the relational integrity of the database by deleting the row.</span></span>

 

 



