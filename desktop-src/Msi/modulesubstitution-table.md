---
description: В таблице Модулесубститутион указаны настраиваемые поля базы данных модуля, а также шаблон для конфигурации каждого поля.
ms.assetid: 8e94c31f-b3a7-4f3a-aec4-32b0e1dd5400
title: Таблица Модулесубститутион
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2e27789f723af87e228bada91b79a16d7dc4d2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272801"
---
# <a name="modulesubstitution-table"></a><span data-ttu-id="a5cd6-103">Таблица Модулесубститутион</span><span class="sxs-lookup"><span data-stu-id="a5cd6-103">ModuleSubstitution Table</span></span>

<span data-ttu-id="a5cd6-104">В таблице Модулесубститутион указаны настраиваемые поля базы данных модуля, а также шаблон для конфигурации каждого поля.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-104">The ModuleSubstitution table specifies the configurable fields of a module database and provides a template for the configuration of each field.</span></span> <span data-ttu-id="a5cd6-105">Пользователь или средство слияния может запросить эту таблицу, чтобы определить, какие операции конфигурации следует выполнить.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-105">The user or merge tool may query this table to determine what configuration operations are to take place.</span></span> <span data-ttu-id="a5cd6-106">Эта таблица не объединяется с целевой базой данных.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-106">This table is not merged into the target database.</span></span>

<span data-ttu-id="a5cd6-107">Следующие таблицы не могут содержать настраиваемые поля и не должны быть перечислены в этой таблице:</span><span class="sxs-lookup"><span data-stu-id="a5cd6-107">The following tables cannot contain configurable fields and must not be listed in this table:</span></span>

<span data-ttu-id="a5cd6-108">Таблица Модулесубститутион</span><span class="sxs-lookup"><span data-stu-id="a5cd6-108">ModuleSubstitution table</span></span>

[<span data-ttu-id="a5cd6-109">Таблица Модулеконфигуратион</span><span class="sxs-lookup"><span data-stu-id="a5cd6-109">ModuleConfiguration table</span></span>](moduleconfiguration-table.md)

[<span data-ttu-id="a5cd6-110">Таблица Модуликсклусион</span><span class="sxs-lookup"><span data-stu-id="a5cd6-110">ModuleExclusion table</span></span>](moduleexclusion-table.md)

[<span data-ttu-id="a5cd6-111">Таблица ModuleSignature</span><span class="sxs-lookup"><span data-stu-id="a5cd6-111">ModuleSignature table</span></span>](modulesignature-table.md)

<span data-ttu-id="a5cd6-112">Таблица Модулесубститутион содержит следующие столбцы.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-112">The ModuleSubstitution table has the following columns.</span></span>



| <span data-ttu-id="a5cd6-113">Столбец</span><span class="sxs-lookup"><span data-stu-id="a5cd6-113">Column</span></span> | <span data-ttu-id="a5cd6-114">Type</span><span class="sxs-lookup"><span data-stu-id="a5cd6-114">Type</span></span>                         | <span data-ttu-id="a5cd6-115">Ключ</span><span class="sxs-lookup"><span data-stu-id="a5cd6-115">Key</span></span> | <span data-ttu-id="a5cd6-116">Допускает значения NULL</span><span class="sxs-lookup"><span data-stu-id="a5cd6-116">Nullable</span></span> |
|--------|------------------------------|-----|----------|
| <span data-ttu-id="a5cd6-117">Таблица</span><span class="sxs-lookup"><span data-stu-id="a5cd6-117">Table</span></span>  | [<span data-ttu-id="a5cd6-118">Идентификатор</span><span class="sxs-lookup"><span data-stu-id="a5cd6-118">Identifier</span></span>](identifier.md) | <span data-ttu-id="a5cd6-119">Да</span><span class="sxs-lookup"><span data-stu-id="a5cd6-119">Y</span></span>   | <span data-ttu-id="a5cd6-120">Нет</span><span class="sxs-lookup"><span data-stu-id="a5cd6-120">N</span></span>        |
| <span data-ttu-id="a5cd6-121">Строка</span><span class="sxs-lookup"><span data-stu-id="a5cd6-121">Row</span></span>    | [<span data-ttu-id="a5cd6-122">Text</span><span class="sxs-lookup"><span data-stu-id="a5cd6-122">Text</span></span>](text.md)             | <span data-ttu-id="a5cd6-123">Да</span><span class="sxs-lookup"><span data-stu-id="a5cd6-123">Y</span></span>   | <span data-ttu-id="a5cd6-124">Нет</span><span class="sxs-lookup"><span data-stu-id="a5cd6-124">N</span></span>        |
| <span data-ttu-id="a5cd6-125">Столбец</span><span class="sxs-lookup"><span data-stu-id="a5cd6-125">Column</span></span> | [<span data-ttu-id="a5cd6-126">Идентификатор</span><span class="sxs-lookup"><span data-stu-id="a5cd6-126">Identifier</span></span>](identifier.md) | <span data-ttu-id="a5cd6-127">Да</span><span class="sxs-lookup"><span data-stu-id="a5cd6-127">Y</span></span>   | <span data-ttu-id="a5cd6-128">Нет</span><span class="sxs-lookup"><span data-stu-id="a5cd6-128">N</span></span>        |
| <span data-ttu-id="a5cd6-129">Значение</span><span class="sxs-lookup"><span data-stu-id="a5cd6-129">Value</span></span>  | [<span data-ttu-id="a5cd6-130">Text</span><span class="sxs-lookup"><span data-stu-id="a5cd6-130">Text</span></span>](text.md)             | <span data-ttu-id="a5cd6-131">Нет</span><span class="sxs-lookup"><span data-stu-id="a5cd6-131">N</span></span>   | <span data-ttu-id="a5cd6-132">Да</span><span class="sxs-lookup"><span data-stu-id="a5cd6-132">Y</span></span>        |



 

## <a name="columns"></a><span data-ttu-id="a5cd6-133">Столбцы</span><span class="sxs-lookup"><span data-stu-id="a5cd6-133">Columns</span></span>

<dl> <dt>

<span data-ttu-id="a5cd6-134"><span id="Table"></span><span id="table"></span><span id="TABLE"></span>Таблица</span><span class="sxs-lookup"><span data-stu-id="a5cd6-134"><span id="Table"></span><span id="table"></span><span id="TABLE"></span>Table</span></span>
</dt> <dd>

<span data-ttu-id="a5cd6-135">В этом столбце указывается имя таблицы, изменяемой в базе данных модуля.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-135">This column specifies the name of the table being modified in the module database.</span></span>

</dd> <dt>

<span data-ttu-id="a5cd6-136"><span id="Row"></span><span id="row"></span><span id="ROW"></span>Строки</span><span class="sxs-lookup"><span data-stu-id="a5cd6-136"><span id="Row"></span><span id="row"></span><span id="ROW"></span>Row</span></span>
</dt> <dd>

<span data-ttu-id="a5cd6-137">В этом поле указываются первичные ключи целевой строки в таблице, которая указана в столбце Таблица.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-137">This field specifies the primary keys of the target row in the table named in the Table column.</span></span> <span data-ttu-id="a5cd6-138">Несколько первичных ключей разделяются точкой с запятой.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-138">Multiple primary keys are separated by semicolons.</span></span> <span data-ttu-id="a5cd6-139">Целевые строки выбираются для изменения перед внесением изменений в целевую таблицу.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-139">Target rows are selected for modification before any changes are made to the target table.</span></span> <span data-ttu-id="a5cd6-140">Если одна запись в таблице Модулесубститутион изменяет поле первичного ключа целевой строки, другие записи в таблице Модулесубститутион применяются на основе исходных данных первичного ключа, а не в результате замены первичного ключа.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-140">If one record in the ModuleSubstitution table changes the primary key field of a target row, other records in the ModuleSubstitution table are applied based on the original primary key data, not the resulting of primary key substitutions.</span></span> <span data-ttu-id="a5cd6-141">Порядок подстановки строк не определен.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-141">The order of row substitution is undefined.</span></span>

<span data-ttu-id="a5cd6-142">Значения в этом столбце всегда находятся в [специальном формате кмсм](cmsm-special-format.md).</span><span class="sxs-lookup"><span data-stu-id="a5cd6-142">Values in this column are always in [CMSM special format](cmsm-special-format.md).</span></span> <span data-ttu-id="a5cd6-143">Литеральную точку с запятой (";") или знак равенства ("=") можно добавить путем добавления символа обратной косой черты.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-143">A literal semicolon (';') or equal sign ('=') can be added by prefixing the character with a backslash.</span></span> <span data-ttu-id="a5cd6-144">'\\'.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-144">'\\'.</span></span> <span data-ttu-id="a5cd6-145">Значение NULL для ключа обозначается значением NULL, начальной точкой с запятой, двумя последовательными точками с запятой или точкой с запятой в конце, в зависимости от того, является ли значение NULL единственным, первым, средним или последним ключевым значением столбца Key.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-145">A null value for a key is signified by a null, a leading semicolon, two consecutive semicolons, or a trailing semicolon, depending on whether the null value is a sole, first, middle, or final key column value.</span></span>

</dd> <dt>

<span data-ttu-id="a5cd6-146"><span id="Column"></span><span id="column"></span><span id="COLUMN"></span>Рубрик</span><span class="sxs-lookup"><span data-stu-id="a5cd6-146"><span id="Column"></span><span id="column"></span><span id="COLUMN"></span>Column</span></span>
</dt> <dd>

<span data-ttu-id="a5cd6-147">Это поле указывает целевой столбец в строке, названной в столбце строка.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-147">This field specifies the target column in the row named in the Row column.</span></span> <span data-ttu-id="a5cd6-148">Если несколько строк в таблице Модулесубститутион изменяют различные столбцы той же целевой строки, то перед вставкой измененной строки в базу данных выполняются все подстановки столбцов.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-148">If multiple rows in the ModuleSubstitution table change different columns of the same target row, all the column substitutions are performed before the modified row is inserted into the database.</span></span> <span data-ttu-id="a5cd6-149">Порядок подстановки столбцов не определен.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-149">The order of column substitution is undefined.</span></span>

</dd> <dt>

<span data-ttu-id="a5cd6-150"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Значений</span><span class="sxs-lookup"><span data-stu-id="a5cd6-150"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Value</span></span>
</dt> <dd>

<span data-ttu-id="a5cd6-151">Этот столбец содержит строку, которая предоставляет шаблон форматирования для данных, подставляемых в целевое поле, определяемое таблицей, строкой и столбцом.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-151">This column contains a string that provides a formatting template for the data being substituted into the target field specified by Table, Row, and Column.</span></span> <span data-ttu-id="a5cd6-152">При обнаружении строки подстановки вида \[ = элемент а \] строка, включая символы квадратной скобки, заменяется значением настраиваемого элемента a.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-152">When a substitution string of the form \[=ItemA\] is encountered, the string, including the bracket characters, is replaced by the value for the configurable "ItemA."</span></span> <span data-ttu-id="a5cd6-153">Настраиваемый элемент «item a» указывается в столбце «имя» [таблицы модулеконфигуратион](moduleconfiguration-table.md) , а его значение предоставляется средством слияния.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-153">The configurable item "ItemA" is specified in the Name column of the [ModuleConfiguration table](moduleconfiguration-table.md) and its value is provided by the merge tool.</span></span> <span data-ttu-id="a5cd6-154">Если средство слияния отклоняет предоставление значения для любого элемента в строке замены, заменяется значение по умолчанию, заданное в столбце DefaultValue таблицы Модулеконфигуратион.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-154">If the merge tool declines to provide a value for any item in a replacement string, the default value specified in the DefaultValue column of the ModuleConfiguration Table is substituted.</span></span> <span data-ttu-id="a5cd6-155">Если строка ссылается на элемент, не наявляющийся в таблице Модулеконфигуратион, происходит сбой слияния.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-155">If a string references an item not in the ModuleConfiguration table, the merge fails.</span></span>

-   <span data-ttu-id="a5cd6-156">В этом столбце используется [Специальный формат кмсм](cmsm-special-format.md).</span><span class="sxs-lookup"><span data-stu-id="a5cd6-156">This column uses [CMSM special format](cmsm-special-format.md).</span></span> <span data-ttu-id="a5cd6-157">В таблицу можно добавить литеральную точку с запятой (";") или знак равенства ("="), представив префикс обратной косой черты.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-157">A literal semicolon (';') or equals sign ('=') can be added to the table by prefixing the character with a backslash.</span></span> <span data-ttu-id="a5cd6-158">'\\'.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-158">'\\'.</span></span>
-   <span data-ttu-id="a5cd6-159">Поле значения может содержать несколько строк подстановки.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-159">The Value field may contain multiple substitution strings.</span></span> <span data-ttu-id="a5cd6-160">Например, конфигурация элементов "Food1" и "Food2" в строке: " \[ = Food1 \] хорошо, но \[ = Food2 \] лучше, так как \[ = Food2 больше \] нутритиаус".</span><span class="sxs-lookup"><span data-stu-id="a5cd6-160">For example, the configuration of items "Food1" and "Food2" in the string: "\[=Food1\] is good, but \[=Food2\] is better because \[=Food2\] is more nutritious."</span></span>
-   <span data-ttu-id="a5cd6-161">Строки замены не должны быть вложенными.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-161">Replacement strings must not be nested.</span></span> <span data-ttu-id="a5cd6-162">Недопустимый шаблон " \[ = AB \[ = CDE \] \] ".</span><span class="sxs-lookup"><span data-stu-id="a5cd6-162">The template "\[=AB\[=CDE\]\]" is invalid.</span></span>
-   <span data-ttu-id="a5cd6-163">Если поле значения имеет значение null, а целевое поле не допускает значения NULL, то слияние завершается ошибкой и создается объект ошибки типа Мсмеррорбаднуллсубститутион и добавляется в список ошибок.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-163">If the Value field evaluates to null, and the target field is not nullable, the merge fails and an error object of type msmErrorBadNullSubstitution is created and added to the error list.</span></span> <span data-ttu-id="a5cd6-164">Дополнительные сведения см. в разделе Типы ошибок, описанные в [**\_ функции Get Type**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type).</span><span class="sxs-lookup"><span data-stu-id="a5cd6-164">For details, see the error types described in [**get\_Type Function**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type).</span></span>
-   <span data-ttu-id="a5cd6-165">Если значение поля value равно значению NULL GUID: {00000000-0000-0000-0000-000000000000} , то идентификатор GUID NULL заменяется именем функции перед тем, как строка будет объединена в модуль.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-165">If the Value field evaluates to the null GUID: {00000000-0000-0000-0000-000000000000}, the null GUID is replaced by the name of the feature before the row is merged into the module.</span></span> <span data-ttu-id="a5cd6-166">Дополнительные сведения см. [в разделе ссылки на функции в модулях слияния](referencing-features-in-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="a5cd6-166">For details, see [Referencing Features in Merge Modules](referencing-features-in-merge-modules.md).</span></span>
-   <span data-ttu-id="a5cd6-167">Шаблон в поле значение вычисляется перед вставкой в целевое поле.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-167">The template in the Value field is evaluated before being inserted into the target field.</span></span> <span data-ttu-id="a5cd6-168">Подстановка в строку выполняется перед заменой каких-либо функций.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-168">Substitution into a row is done before replacing any features.</span></span>
-   <span data-ttu-id="a5cd6-169">Если в столбце значение вычисляется только строка, сопоставленная только с целыми числами (с необязательным символом + или-), строка преобразуется в целое число перед подстановкой в целевое поле [типа целочисленного формата](integer-format-types.md).</span><span class="sxs-lookup"><span data-stu-id="a5cd6-169">If the Value column evaluates to a string of only integer characters (with an optional + or -), the string is converted into an integer before being substituted into an target field of the [Integer Format Type](integer-format-types.md).</span></span> <span data-ttu-id="a5cd6-170">Если в шаблоне вычисляется строка, которая не состоит только из целых символов (и необязательно + или-), результат не может быть заменен на конечное поле целого числа.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-170">If the template evaluates to a string that does not consist only of integer characters (and an optional + or -) the result cannot be substituted into an integer target field.</span></span> <span data-ttu-id="a5cd6-171">Попытка вставить нецелое число в поле целого числа приводит к сбою слияния и добавлению объекта ошибки Мсмеррорбадсубститутионтипе в список ошибок.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-171">Attempting to insert a non-integer into an integer field causes the merge to fail and adds a msmErrorBadSubstitutionType error object to the error list.</span></span>
-   <span data-ttu-id="a5cd6-172">Если целевой столбец, указанный в полях таблица и столбец, является [типом текстового формата](text-format-types.md), а вычисление поля значения приводит к [типу целочисленного формата](integer-format-types.md), десятичное представление числа вставляется в текстовое поле Target.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-172">If the target column specified in the Table and Column fields is a [Text Format Type](text-format-types.md), and evaluation of the Value field results in an [Integer Format Type](integer-format-types.md), a decimal representation of the number is inserted into the target text field.</span></span>
-   <span data-ttu-id="a5cd6-173">Если целевое поле имеет [тип целочисленного формата](integer-format-types.md), и поле значения состоит из списка элементов в [формате битового](bitfield-format-types.md)массива без разделителей, значение в целевом поле объединяется с помощью побитового оператора **and** с обратным значением побитового **или** из всех значений маски из элементов, а затем объединяется с помощью побитового оператора **or** с каждым из элементов Integer или битового поля, маскированного соответствующими значениями маски.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-173">If the target field is an [Integer Format Type](integer-format-types.md), and the Value field consists of a non-delimited list of items in [Bitfield Format](bitfield-format-types.md), the value in the target field is combined using the bitwise **AND** operator with the inverse of the bitwise **OR** of all of the mask values from the items, then combined using the bitwise **OR** operator with each of the integer or bitfield items when masked by their corresponding mask values.</span></span> <span data-ttu-id="a5cd6-174">По сути, это явно устанавливает биты из свойств в указанные значения, но оставляет все остальные биты только в ячейке.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-174">Essentially, this explicitly sets the bits from the properties to the provided values but leaves all other bits in the cell alone.</span></span>
-   <span data-ttu-id="a5cd6-175">Если поле значения имеет [тип формата ключа](key-format-types.md)и является ключом в таблице, использующей несколько первичных ключей, то за именем элемента может следовать точка с запятой и целочисленное значение, указывающее на Отсчитываемый от 1 индекс в наборе значений, которые вместе образуют первичный ключ.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-175">If the Value field evaluates to a [Key Format Type](key-format-types.md), and is a key into a table that uses multiple primary keys, the item name may be followed by a semicolon and an integer value that indicates the 1-based index into the set of values that together make a primary key.</span></span> <span data-ttu-id="a5cd6-176">Если целое число не указано, используется значение 1.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-176">If no integer is specified, the value 1 is used.</span></span> <span data-ttu-id="a5cd6-177">Например, в [таблице элементов управления](control-table.md) есть два первичных ключевых столбца, диалоговое окно \_ и элемент управления.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-177">For example, the [Control table](control-table.md) has two primary key columns, Dialog\_ and Control.</span></span> <span data-ttu-id="a5cd6-178">Значение элемента «Item1», которое является ключом в таблице элементов управления, будет иметь вид «Диалогнаме; Контролнаме ", где Диалогнаме — это значение в таблице Dialog \_ , а контролнаме — значение в столбце Control.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-178">The value of an item "Item1" that is a key into the Control table will be of the form "DialogName;ControlName", where DialogName is the value in the Dialog\_ table and ControlName is the value in the Control column.</span></span> <span data-ttu-id="a5cd6-179">Чтобы заменить только Контролнаме, следует использовать строку подстановки \[ = Item1; 2 \] .</span><span class="sxs-lookup"><span data-stu-id="a5cd6-179">To substitute just ControlName, the substitution string \[=Item1;2\] should be used.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="a5cd6-180">Комментарии</span><span class="sxs-lookup"><span data-stu-id="a5cd6-180">Remarks</span></span>

<span data-ttu-id="a5cd6-181">Таблица Модулесубститион используется [настраиваемыми модулями слияния](configurable-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="a5cd6-181">The ModuleSubstition table is used by [Configurable Merge Modules](configurable-merge-modules.md).</span></span> <span data-ttu-id="a5cd6-182">Для создания настраиваемого модуля слияния требуется Mergemod.dll версии 2,0 или более поздней.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-182">Mergemod.dll version 2.0 or later is required to create a configurable merge module.</span></span>

<span data-ttu-id="a5cd6-183">Чтобы обеспечить совместимость с версиями Mergemod.dll более ранними, чем версия 2,0, [таблицы модулеконфигуратион](moduleconfiguration-table.md) и модулесубститутион должны быть добавлены в [таблицу модулеигноретабле](moduleignoretable-table.md) каждого модуля.</span><span class="sxs-lookup"><span data-stu-id="a5cd6-183">To ensure compatibility with versions of Mergemod.dll earlier than version 2.0, the [ModuleConfiguration table](moduleconfiguration-table.md) and ModuleSubstitution tables should be included in the [ModuleIgnoreTable table](moduleignoretable-table.md) of every module.</span></span>

 

 
