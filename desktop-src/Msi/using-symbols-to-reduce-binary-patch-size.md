---
description: Использование общедоступных символов для целевой платформы и двоичных файлов образа обновления позволяет сократить размер двоичного исправления примерно на одну половину.
ms.assetid: 83351a1b-ba70-4f0b-bacf-71ad7993a5aa
title: Использование символов для сокращения размера двоичного исправления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d5ccf33dbf3ffefbee909d99bd0204ea2f49aba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673337"
---
# <a name="using-symbols-to-reduce-binary-patch-size"></a><span data-ttu-id="ba9bb-103">Использование символов для сокращения размера двоичного исправления</span><span class="sxs-lookup"><span data-stu-id="ba9bb-103">Using Symbols to Reduce Binary Patch Size</span></span>

<span data-ttu-id="ba9bb-104">Использование общедоступных символов для целевой платформы и двоичных файлов образа обновления позволяет сократить размер двоичного исправления примерно на одну половину.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-104">Using public symbols for your target and upgrade image binaries can reduce binary patch sizes by approximately one half.</span></span> <span data-ttu-id="ba9bb-105">Фактическое сокращение зависит от используемых символов.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-105">The actual reduction depends upon the symbols used.</span></span> <span data-ttu-id="ba9bb-106">Обратите внимание, что использование символов может привести к более медленному созданию исправлений, так как обработка файлов символов занимает больше времени.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-106">Note that using symbols can result in slower patch creation times because it takes longer to process the symbol files.</span></span>

<span data-ttu-id="ba9bb-107">Чтобы уменьшить размер двоичного исправления с помощью символов, необходимо указать символы как для целевого файла, так и для файлов образа обновления.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-107">To reduce the size of a binary patch using symbols, you must provide symbols for both the target and upgrade image binaries.</span></span> <span data-ttu-id="ba9bb-108">Укажите символы в столбце Симболпасс таблицы [таржетимажес](targetimages-table-patchwiz-dll-.md) и в столбце Симболпасс таблицы [упградедимажес](upgradedimages-table-patchwiz-dll-.md) .</span><span class="sxs-lookup"><span data-stu-id="ba9bb-108">Specify the symbols in the SymbolPaths column of the [TargetImages](targetimages-table-patchwiz-dll-.md) table and the SymbolPaths column of the [UpgradedImages](upgradedimages-table-patchwiz-dll-.md) table.</span></span> <span data-ttu-id="ba9bb-109">Для создания символов в формате файла базы данных программы (PDB) необходимо использовать Visual C++.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-109">You must use Visual C++ to generate symbols in the program database (PDB) file format.</span></span> <span data-ttu-id="ba9bb-110">Более новые версии Visual C++ предоставляют всю необходимую информацию в PDB-файле.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-110">Newer versions of Visual C++ provide all of the necessary information in the PDB file.</span></span> <span data-ttu-id="ba9bb-111">Более старые версии Visual C++ также создают формат файла отладки (DBG).</span><span class="sxs-lookup"><span data-stu-id="ba9bb-111">Older versions of Visual C++ also generate the debug (DBG) file format.</span></span> <span data-ttu-id="ba9bb-112">В этом случае значение Симболспасс должно указывать расположение файлов PDB и DBG.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-112">In this case, the SymbolsPaths value should specify the location of both the PDB and DBG files.</span></span>

<span data-ttu-id="ba9bb-113">Например, Таржетимаже для исправления может быть пакетом установки, поставляемым с Windows 2000, который устанавливает 1.1.1029.0 версию MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-113">For example, the TargetImage for a patch might be the installation package that shipped with Windows 2000 and that installs the 1.1.1029.0 version of MSI.DLL.</span></span> <span data-ttu-id="ba9bb-114">Упградедимаже может быть обновленным пакетом установки, поставляемым с Windows 2000 с пакетом обновления 1 (SP1), и который устанавливает 1.11.1314.0 версию MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-114">The UpgradedImage might be the updated installation package that shipped with Windows 2000 with Service Pack 1 (SP1) and that installs the 1.11.1314.0 version of MSI.DLL.</span></span> <span data-ttu-id="ba9bb-115">Затем необходимо создать два файла свойств для создания исправлений (PCP), для которых столбец Симболпасс в таблицах [таржетимажес](targetimages-table-patchwiz-dll-.md) и [упградедимажес](upgradedimages-table-patchwiz-dll-.md) остается пустым (пустым), а другой — со столбцом Симболпасс таблиц таржетимажес и упградедимажес, заполненным расположением символов для двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-115">Two Patch Creation Properties (PCP) files would then have to be created, one with the SymbolPaths column of both the [TargetImages](targetimages-table-patchwiz-dll-.md) and [UpgradedImages](upgradedimages-table-patchwiz-dll-.md) tables left NULL (blank) and the other with the SymbolPaths column of both the TargetImages and UpgradedImages tables populated with the location of the symbols for the binaries.</span></span> <span data-ttu-id="ba9bb-116">В этом случае размер исправления, созданного без использования символов, может быть примерно в три раза больше размера исправления, созданного с помощью символов.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-116">In this case, the size of the patch generated without using symbols can be approximately three times the size of the patch generated using symbols.</span></span>

<span data-ttu-id="ba9bb-117">Служебную программу Mpatch.exe можно использовать для тестирования создания двоичных исправлений для одного файла и проверки допустимости символов.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-117">The Mpatch.exe utility can be used to test the generation of binary patches for a single file and to check whether or not the symbols are valid.</span></span> <span data-ttu-id="ba9bb-118">Служебная программа Mpatch.exe входит в состав [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="ba9bb-118">The Mpatch.exe utility is included in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="ba9bb-119">Выходные данные Mpatch.exe будут указывать, что символы не совпадают.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-119">The output of Mpatch.exe will indicate if the symbols do not match.</span></span>

<span data-ttu-id="ba9bb-120">Например, введите следующую командную строку, чтобы проверить, являются ли символы допустимыми.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-120">For example, enter the following command line to check whether or not the symbols are valid.</span></span>

<span data-ttu-id="ba9bb-121">**mpatch.exe-НЕВСИМПАС: d: \\ Update-олдсимпас: d: \\ целевой объект d: \\ целевой \\example.dll d: \\ Обновление \\example.dll example. Pat**</span><span class="sxs-lookup"><span data-stu-id="ba9bb-121">**mpatch.exe -NEWSYMPATH:d:\\update -OLDSYMPATH:d:\\target d:\\target\\example.dll d:\\update\\example.dll example.pat**</span></span>

<span data-ttu-id="ba9bb-122">Если символы находятся в неправильном расположении, выходные данные Mpatch.exe могут содержать следующее предупреждение.</span><span class="sxs-lookup"><span data-stu-id="ba9bb-122">If the symbols are not in the correct location, the output of Mpatch.exe may include the following warning.</span></span>

``` syntax
WARNING: no debug symbols for d:\update\example.dll
```

 

 



