---
title: Использование восстановления и перезапуска приложения
description: Приложение может использовать восстановление и перезагрузку приложения (ARR) для сохранения данных и сведений о состоянии до завершения работы приложения из-за необработанного исключения или зависания приложения. При запросе приложение также перезапускается.
ms.assetid: 28cbb4c0-a287-4302-b3a9-daddc69adb40
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b0d5bf0b9bd0e0f6cc257ee785ab5df6febc8fef
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103890716"
---
# <a name="using-application-recovery-and-restart"></a><span data-ttu-id="a0af7-104">Использование восстановления и перезапуска приложения</span><span class="sxs-lookup"><span data-stu-id="a0af7-104">Using Application Recovery and Restart</span></span>

<span data-ttu-id="a0af7-105">Приложение может использовать восстановление и перезагрузку приложения (ARR) для сохранения данных и сведений о состоянии до завершения работы приложения из-за необработанного исключения или зависания приложения.</span><span class="sxs-lookup"><span data-stu-id="a0af7-105">An application can use Application Recovery and Restart (ARR) to save data and state information before the application exits due to an unhandled exception or when the application stops responding.</span></span> <span data-ttu-id="a0af7-106">При запросе приложение также перезапускается.</span><span class="sxs-lookup"><span data-stu-id="a0af7-106">The application is also restarted, if requested.</span></span>

<span data-ttu-id="a0af7-107">При регистрации для восстановления или перезапуска сведения о регистрации добавляются в процесс.</span><span class="sxs-lookup"><span data-stu-id="a0af7-107">When you register for recovery or restart, the registration information is added to the process.</span></span> <span data-ttu-id="a0af7-108">[Отчеты об ошибках Windows (WER)](/windows/desktop/wer/windows-error-reporting) использует регистрационные данные для вызова функции обратного вызова восстановления и перезапуска приложения.</span><span class="sxs-lookup"><span data-stu-id="a0af7-108">[Windows Error Reporting (WER)](/windows/desktop/wer/windows-error-reporting) uses the registration information to call your recovery callback and restart your application.</span></span> <span data-ttu-id="a0af7-109">Например, если вы регистрируетесь для восстановления и приложение встречает необработанное исключение, в WER отображается диалоговое окно, в котором пользователю предоставляется возможность проверить наличие решения в сети, закрыть программу или выполнить отладку программы.</span><span class="sxs-lookup"><span data-stu-id="a0af7-109">For example, if you register for recovery and your application encounters an unhandled exception, WER displays a dialog to the user that gives the user the option of checking for a solution online, closing the program, or debugging the program.</span></span> <span data-ttu-id="a0af7-110">Если пользователь решает либо проверить наличие решения, либо закрыть программу, то WER вызывает зарегистрированный обратный вызов и дает приложению возможность сохранить данные и сведения о состоянии.</span><span class="sxs-lookup"><span data-stu-id="a0af7-110">If the user chooses to either check for a solution or close the program, WER calls the registered callback and gives the application the chance to save data and state information.</span></span> <span data-ttu-id="a0af7-111">После завершения восстановления приложение будет завершено.</span><span class="sxs-lookup"><span data-stu-id="a0af7-111">When the recovery is complete, the application is terminated.</span></span>

<span data-ttu-id="a0af7-112">Если вы регистрируетесь для перезапуска и приложение встречает необработанное исключение, программа WER отображает то же самое диалоговое окно для пользователя, но дает возможность перезапустить программу вместо закрытия программы.</span><span class="sxs-lookup"><span data-stu-id="a0af7-112">If you register for restart and your application encounters an unhandled exception, WER displays the same dialog to the user but gives the option of restarting the program instead of closing the program.</span></span> <span data-ttu-id="a0af7-113">Если вы регистрируетесь как для восстановления, так и для перезапуска, сначала выполняется восстановление. Затем приложение завершает работу и перезапускается.</span><span class="sxs-lookup"><span data-stu-id="a0af7-113">If you register for both recovery and restart, recovery occurs first; the application is then terminated and restarted.</span></span>

<span data-ttu-id="a0af7-114">Неотвечающее приложение обрабатывается аналогичным образом.</span><span class="sxs-lookup"><span data-stu-id="a0af7-114">An unresponsive application is handled in a similar fashion.</span></span> <span data-ttu-id="a0af7-115">Приложение считается неотвечающим, если оно не реагирует на сообщения Windows в течение пяти секунд, а пользователь пытается взаимодействовать с приложением. пользователь увидит (не отвечает) в заголовке окна.</span><span class="sxs-lookup"><span data-stu-id="a0af7-115">An application is considered unresponsive if it does not respond to Windows messages for five seconds and the user then tries to interact with the application; the user will see (Not Responding) in the title bar.</span></span> <span data-ttu-id="a0af7-116">WER активируется, когда пользователь нажимает кнопку закрытия системы.</span><span class="sxs-lookup"><span data-stu-id="a0af7-116">WER is activated when the user clicks the system close button.</span></span>

<span data-ttu-id="a0af7-117">Необходимо зарегистрироваться для восстановления или перезапуска или удалить регистрацию, прежде чем приложение перестанет отвечать или встречает необработанное исключение.</span><span class="sxs-lookup"><span data-stu-id="a0af7-117">You must register for recovery or restart, or remove the registration, before the application becomes unresponsive or encounters an unhandled exception.</span></span> <span data-ttu-id="a0af7-118">Однако в обратном вызове восстановления можно изменить командную строку перезапуска.</span><span class="sxs-lookup"><span data-stu-id="a0af7-118">However, in your recovery callback, you can change the restart command line.</span></span>

<span data-ttu-id="a0af7-119">Дополнительные сведения о регистрации для восстановления или перезапуска см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="a0af7-119">For details on registering for recovery or restart, see the following topics:</span></span>

-   [<span data-ttu-id="a0af7-120">Регистрация для восстановления приложения</span><span class="sxs-lookup"><span data-stu-id="a0af7-120">Registering for Application Recovery</span></span>](registering-for-application-recovery.md)
-   [<span data-ttu-id="a0af7-121">Регистрация для перезапуска приложения</span><span class="sxs-lookup"><span data-stu-id="a0af7-121">Registering for Application Restart</span></span>](registering-for-application-restart.md)

<span data-ttu-id="a0af7-122">Примеры, реализующие функции восстановления и перезапуска, см. в примерах Аппрековери и Аппрестарт в Windows SDK, расположенном в \\ папке винбасе виндовсерроррепортинг.</span><span class="sxs-lookup"><span data-stu-id="a0af7-122">For samples that implement the recovery and restart features, see the AppRecovery and AppRestart samples in the Windows SDK located in the WinBase\\WindowsErrorReporting folder.</span></span>

 

 