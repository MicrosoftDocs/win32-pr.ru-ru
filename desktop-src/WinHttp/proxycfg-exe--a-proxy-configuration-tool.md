---
description: В этом разделе объясняется использование средства настройки прокси-сервера служб Microsoft Windows HTTP (WinHTTP), &\# 0034; ProxyCfg.exe&\# 0034;.
ms.assetid: f96adf59-59be-414e-ad6f-9eac05f4b975
title: Netsh.exe и ProxyCfg.exe прокси Средства настройки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 96a33e832d324a5863652673b8e25725fba72e88
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539794"
---
# <a name="netshexe-and-proxycfgexe-proxy-configuration-tools"></a><span data-ttu-id="777f6-103">Netsh.exe и ProxyCfg.exe прокси Средства настройки</span><span class="sxs-lookup"><span data-stu-id="777f6-103">Netsh.exe and ProxyCfg.exe Proxy Configuration Tools</span></span>

<span data-ttu-id="777f6-104">\* \* Windows Vista и Windows Server 2008: \* \*</span><span class="sxs-lookup"><span data-stu-id="777f6-104">\*\*Windows Vista and Windows Server 2008:  \*\*</span></span>

<span data-ttu-id="777f6-105">ProxyCfg.exe не рекомендуется к использованию.</span><span class="sxs-lookup"><span data-stu-id="777f6-105">ProxyCfg.exe has been deprecated.</span></span> <span data-ttu-id="777f6-106">Он заменяется командами [ winhttpNetsh.exe](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731131(v=ws.10)) .</span><span class="sxs-lookup"><span data-stu-id="777f6-106">It is replaced by the [Netsh.exe winhttp](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731131(v=ws.10)) commands.</span></span>

<span data-ttu-id="777f6-107">В этом разделе объясняется использование средства настройки прокси-сервера [служб Microsoft Windows HTTP (WinHTTP)](about-winhttp.md) "ProxyCfg.exe".</span><span class="sxs-lookup"><span data-stu-id="777f6-107">This topic explains the use of the [Microsoft Windows HTTP Services (WinHTTP)](about-winhttp.md) proxy configuration tool, "ProxyCfg.exe".</span></span>

<span data-ttu-id="777f6-108">Существует два способа доступа к серверам HTTP и протоколам HTTPS через прокси-сервер с помощью служб Microsoft Windows HTTP (WinHTTP).</span><span class="sxs-lookup"><span data-stu-id="777f6-108">There are two ways to access HTTP and Secure Hypertext Transfer Protocol (HTTPS) servers through a proxy using Microsoft Windows HTTP Services (WinHTTP).</span></span> <span data-ttu-id="777f6-109">Сначала можно указать параметры прокси-сервера в приложении WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="777f6-109">First, you can specify proxy settings from within your WinHTTP application.</span></span> <span data-ttu-id="777f6-110">Во-вторых, можно указать параметры прокси по умолчанию вне приложения с помощью служебной программы настройки прокси-сервера, расположенной в каталоге% WINDIR% \\ System32.</span><span class="sxs-lookup"><span data-stu-id="777f6-110">Second, you can specify default proxy settings from outside your application using the proxy configuration utility located in the %windir%\\system32 directory.</span></span>

<span data-ttu-id="777f6-111">Вы можете программно задать данные прокси-сервера в приложении или скрипте.</span><span class="sxs-lookup"><span data-stu-id="777f6-111">You can programmatically set the proxy data from within your application or script.</span></span> <span data-ttu-id="777f6-112">Если вы пишете приложение с помощью API WinHTTP, воспользуйтесь одним из следующих двух методов изменения параметров прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-112">If you are writing an application using the WinHTTP API, use one of the following two techniques to change proxy settings.</span></span>

-   <span data-ttu-id="777f6-113">Используйте функцию [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) .</span><span class="sxs-lookup"><span data-stu-id="777f6-113">Use the [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) function.</span></span> <span data-ttu-id="777f6-114">Укажите тип доступа во втором параметре, имя прокси-сервера в третьем параметре и список пропусков в четвертом параметре.</span><span class="sxs-lookup"><span data-stu-id="777f6-114">Specify access type in the second parameter, the name of the proxy in the third parameter, and a bypass list in the fourth parameter.</span></span> <span data-ttu-id="777f6-115">В следующем примере показано, как можно использовать функцию [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) для задания данных прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-115">The following example shows how the [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) function can be used to set proxy data.</span></span>

    ``` syntax
    hSession = WinHttpOpen( L"WinHTTP Example/1.0",  
                            WINHTTP_ACCESS_TYPE_NAMED_PROXY,
                            L"proxy_name", 
                            L"<local>", 
                            0);
    ```

-   <span data-ttu-id="777f6-116">Используйте функцию [**винхттпсетоптион**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) .</span><span class="sxs-lookup"><span data-stu-id="777f6-116">Use the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function.</span></span> <span data-ttu-id="777f6-117">Флаг [**\_ \_ прокси-сервера параметра WinHTTP**](option-flags.md) позволяет указать параметры прокси-сервера с помощью структуры [**\_ \_ сведений о прокси-сервере WinHTTP**](/windows/win32/api/winhttp/ns-winhttp-winhttp_proxy_info) .</span><span class="sxs-lookup"><span data-stu-id="777f6-117">The [**WINHTTP\_OPTION\_PROXY**](option-flags.md) flag enables you to specify proxy settings with a [**WINHTTP\_PROXY\_INFO**](/windows/win32/api/winhttp/ns-winhttp-winhttp_proxy_info) structure.</span></span> <span data-ttu-id="777f6-118">В следующем примере кода показано, как можно использовать функцию [**винхттпсетоптион**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) для задания данных прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-118">The following example code shows how the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function can be used to set proxy data.</span></span>

    ``` syntax
    WINHTTP_PROXY_INFO proxyInfo;
    proxyInfo.dwAccessType = WINHTTP_ACCESS_TYPE_NAMED_PROXY;
    proxyInfo.lpszProxy = L"proxy_name";
    proxyInfo.lpszProxyBypass = L"<local>";
        
    // Set the proxy information for this session.
    WinHttpSetOption( hSession, 
                      WINHTTP_OPTION_PROXY, 
                      &proxyInfo, 
                      sizeof(proxyInfo));
    ```

<span data-ttu-id="777f6-119">При написании скрипта или приложения с помощью объекта [**WinHttpRequest**](winhttprequest.md) используйте следующую методику для изменения параметров прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-119">If you are writing a script or an application using the [**WinHttpRequest**](winhttprequest.md) object, use the following technique to change proxy settings.</span></span>

-   <span data-ttu-id="777f6-120">Используйте метод [**сетпрокси**](iwinhttprequest-setproxy.md) .</span><span class="sxs-lookup"><span data-stu-id="777f6-120">Use the [**SetProxy**](iwinhttprequest-setproxy.md) method.</span></span> <span data-ttu-id="777f6-121">Укажите тип доступа в первом параметре, имя прокси-сервера во втором параметре и список пропусков в третьем параметре.</span><span class="sxs-lookup"><span data-stu-id="777f6-121">Specify the access type in the first parameter, the name of the proxy in the second parameter, and a bypass list in the third parameter.</span></span> <span data-ttu-id="777f6-122">В следующем примере показано, как можно использовать метод [**сетпрокси**](iwinhttprequest-setproxy.md) в скрипте для задания данных прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-122">The following example shows how the [**SetProxy**](iwinhttprequest-setproxy.md) method can be used in script to set proxy data.</span></span>

    ``` syntax
    WinHttpReq.SetProxy( HTTPREQUEST_PROXYSETTING_PROXY, 
                         "proxy_server:80", 
                         "*.microsoft.com");
    ```

<span data-ttu-id="777f6-123">Чтобы указать параметры по умолчанию и исключить необходимость использования метода [**сетпрокси**](iwinhttprequest-setproxy.md) или функции [**винхттпсетоптион**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) , используйте служебную программу настройки прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-123">To specify default settings and eliminate the need to use either the [**SetProxy**](iwinhttprequest-setproxy.md) method or the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function, use the proxy configuration utility.</span></span> <span data-ttu-id="777f6-124">С помощью этой служебной программы можно указать, что приложение получает доступ к сети напрямую через прокси-сервер или через сочетание прямого и прокси-доступа, указав список обхода.</span><span class="sxs-lookup"><span data-stu-id="777f6-124">Using this utility, you can specify that your application access a network either directly, through a proxy, or through a combination of direct and proxy access by specifying a bypass list.</span></span> <span data-ttu-id="777f6-125">При использовании API WinHTTP средство настройки прокси-сервера определяет параметры только при передаче флага **\_ \_ \_ по умолчанию для типа доступа WinHTTP** в API [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) .</span><span class="sxs-lookup"><span data-stu-id="777f6-125">When you use the WinHTTP API, the proxy configuration tool only determines the settings when you pass the **WINHTTP\_ACCESS\_TYPE\_DEFAULT** flag to the [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) API.</span></span> <span data-ttu-id="777f6-126">Объект [**WinHttpRequest**](winhttprequest.md) по умолчанию использует параметры средства настройки прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-126">The [**WinHttpRequest**](winhttprequest.md) object uses the proxy configuration tool settings by default.</span></span>

<span data-ttu-id="777f6-127">Параметры прокси-сервера для WinHTTP не являются параметрами прокси-сервера для Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="777f6-127">The proxy settings for WinHTTP are not the proxy settings for Microsoft Internet Explorer.</span></span> <span data-ttu-id="777f6-128">Параметры прокси-сервера для WinHTTP нельзя настроить на панели управления Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="777f6-128">You cannot configure the proxy settings for WinHTTP in the Microsoft Windows Control Panel.</span></span> <span data-ttu-id="777f6-129">Использование служебной программы настройки прокси-сервера WinHTTP не изменяет параметры, используемые для Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="777f6-129">Using the WinHTTP proxy configuration utility does not alter the settings you use for Internet Explorer.</span></span>

> [!Note]  
> <span data-ttu-id="777f6-130">Если попытаться открыть и отправить HTTP-запрос с помощью WinHTTP, а параметры прокси-сервера неверны, возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="777f6-130">If you attempt to open and send an HTTP request using WinHTTP and the proxy settings are incorrect, an error occurs.</span></span>

 

## <a name="command-line-parameters"></a><span data-ttu-id="777f6-131">Параметры командной строки</span><span class="sxs-lookup"><span data-stu-id="777f6-131">Command Line Parameters</span></span>

<span data-ttu-id="777f6-132">В следующей таблице перечислены параметры командной строки, доступные для использования с инструментом ProxyCfg.exe.</span><span class="sxs-lookup"><span data-stu-id="777f6-132">The following table lists the command line parameters available for use with the ProxyCfg.exe tool.</span></span>



| <span data-ttu-id="777f6-133">Параметр</span><span class="sxs-lookup"><span data-stu-id="777f6-133">Parameter</span></span> | <span data-ttu-id="777f6-134">Описание</span><span class="sxs-lookup"><span data-stu-id="777f6-134">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="777f6-135">нет</span><span class="sxs-lookup"><span data-stu-id="777f6-135">none</span></span>      | <span data-ttu-id="777f6-136">Если параметры не указаны, отображаются текущие параметры прокси-сервера WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="777f6-136">When no parameters are specified, the current WinHTTP proxy settings are displayed.</span></span>                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="777f6-137">?</span><span class="sxs-lookup"><span data-stu-id="777f6-137">?</span></span>         | <span data-ttu-id="777f6-138">Откроется справочная информация.</span><span class="sxs-lookup"><span data-stu-id="777f6-138">Help information is displayed.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="777f6-139">d</span><span class="sxs-lookup"><span data-stu-id="777f6-139">d</span></span>         | <span data-ttu-id="777f6-140">Указывает, что приложения WinHTTP обращаются напрямую к сети без прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-140">Specifies that WinHTTP applications access the network directly, without a proxy.</span></span>                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="777f6-141">p</span><span class="sxs-lookup"><span data-stu-id="777f6-141">p</span></span>         | <span data-ttu-id="777f6-142">Указывает прокси-сервер.</span><span class="sxs-lookup"><span data-stu-id="777f6-142">Specifies the proxy server.</span></span> <span data-ttu-id="777f6-143">Можно также указать необязательный список серверов, доступ к которым осуществляется без использования прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-143">You can also specify an optional list of servers that are accessed without a proxy.</span></span>                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="777f6-144">u</span><span class="sxs-lookup"><span data-stu-id="777f6-144">u</span></span>         | <span data-ttu-id="777f6-145">Указывает, что приложения WinHTTP используют параметры прокси-сервера текущего пользователя для Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="777f6-145">Specifies that WinHTTP applications use the current user's proxy settings for Internet Explorer.</span></span> <span data-ttu-id="777f6-146">Этот параметр не работает, если Internet Explorer автоматически обнаруживает параметры прокси-сервера или если он использует URL-адрес автоматической настройки для установки сведений о прокси-сервере.</span><span class="sxs-lookup"><span data-stu-id="777f6-146">This parameter does not work if Internet Explorer is automatically detecting proxy settings, or if it is using an automatic configuration URL to set the proxy information.</span></span>                                                                                                                                                      |
| <span data-ttu-id="777f6-147">i</span><span class="sxs-lookup"><span data-stu-id="777f6-147">i</span></span>         | <span data-ttu-id="777f6-148">Указывает, что приложения WinHTTP используют параметры прокси-сервера текущего пользователя для Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="777f6-148">Specifies that WinHTTP applications use the current user's proxy settings for Internet Explorer.</span></span> <span data-ttu-id="777f6-149">Работает только в том случае, если ProxyCfg.exe ранее не использовался.</span><span class="sxs-lookup"><span data-stu-id="777f6-149">This only works when ProxyCfg.exe was not previously used.</span></span> <span data-ttu-id="777f6-150">Если установлен ProxyCfg.exe, укажите, что параметр командной строки "u" использует параметры вручную.</span><span class="sxs-lookup"><span data-stu-id="777f6-150">If ProxyCfg.exe is installed, specify that the "u" command line parameter use the manual settings.</span></span> <span data-ttu-id="777f6-151">Этот параметр не работает, если Internet Explorer автоматически обнаруживает параметры прокси-сервера или использует URL-адрес автоматической настройки для установки сведений о прокси-сервере.</span><span class="sxs-lookup"><span data-stu-id="777f6-151">This parameter does not work if Internet Explorer automatically detects proxy settings, or if it uses an automatic configuration URL to set the proxy information.</span></span> |



 

<span data-ttu-id="777f6-152">Вы можете указать учетные записи-посредники в строке, разделенной пробелами.</span><span class="sxs-lookup"><span data-stu-id="777f6-152">You can specify proxies in a space-delimited string.</span></span> <span data-ttu-id="777f6-153">Списки прокси-серверов могут содержать номер порта, который используется для доступа к прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="777f6-153">The proxy listings can contain the port number that is used to access the proxy.</span></span> <span data-ttu-id="777f6-154">Чтобы получить список прокси-сервера для конкретного протокола, строка должна соответствовать формату, <protocol> = https://<имя прокси-сервера \_>.</span><span class="sxs-lookup"><span data-stu-id="777f6-154">To list a proxy for a specific protocol, the string must follow the format, <protocol>=https://<proxy\_name>.</span></span> <span data-ttu-id="777f6-155">Допустимые протоколы — HTTP и HTTPS.</span><span class="sxs-lookup"><span data-stu-id="777f6-155">The valid protocols are HTTP and HTTPS.</span></span> <span data-ttu-id="777f6-156">Например, чтобы получить список прокси-сервера HTTP, допустима строка HTTP = https://http\_proxy\_name:80 , где HTTP \_ -прокси- \_ имя — это имя прокси-сервера, а 80 — номер порта, который необходимо использовать для доступа к прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="777f6-156">For example, to list an HTTP proxy, a valid string is http=https://http\_proxy\_name:80, where http\_proxy\_name is the name of the proxy server and 80 is the port number that you must use to access the proxy.</span></span> <span data-ttu-id="777f6-157">Если прокси-сервер использует номер порта по умолчанию для этого протокола, можно опустить номер порта.</span><span class="sxs-lookup"><span data-stu-id="777f6-157">If the proxy uses the default port number for that protocol, then you can omit the port number.</span></span> <span data-ttu-id="777f6-158">Если имя прокси-сервера указано отдельно, его можно использовать в качестве прокси-сервера по умолчанию для любых протоколов, у которых нет указанного прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-158">If a proxy name is listed by itself, you can use it as the default proxy for any protocols that do not have a specified proxy.</span></span> <span data-ttu-id="777f6-159">Например, HTTP = https://http\_proxy другой прокси-сервер \_ использует \_ прокси HTTP для любых операций HTTP, а протокол HTTPS использует прокси-сервер с именем другой \_ прокси-сервер.</span><span class="sxs-lookup"><span data-stu-id="777f6-159">For example, http=https://http\_proxy other\_proxy uses http\_proxy for any HTTP operations, while the HTTPS protocol uses the proxy named other\_proxy.</span></span>

<span data-ttu-id="777f6-160">В списке обхода прокси-сервера можно перечислить локально известные имена узлов или IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="777f6-160">You can list locally known host names or IP addresses in the proxy bypass list.</span></span> <span data-ttu-id="777f6-161">Этот список может содержать подстановочные знаки, например " \* ", что приводит к тому, что приложение обходит прокси-сервер для адресов, соответствующих указанному шаблону, например " \* . Microsoft.com" или " \* . org".</span><span class="sxs-lookup"><span data-stu-id="777f6-161">This list can contain wildcards, such as "\*", that cause the application to bypass the proxy server for addresses that fit the specified pattern, for example, "\*.microsoft.com" or "\*.org".</span></span> <span data-ttu-id="777f6-162">Подстановочные знаки должны быть самыми левыми символами в списке.</span><span class="sxs-lookup"><span data-stu-id="777f6-162">Wildcard characters must be the left-most characters in the list.</span></span> <span data-ttu-id="777f6-163">Например, "AAA. \* " не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="777f6-163">For example, "aaa.\*" is not supported.</span></span> <span data-ttu-id="777f6-164">Чтобы вывести несколько адресов и имен узлов, разделите их пробелами или точками с запятой в строке обхода прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-164">To list multiple addresses and host names, separate them with blank spaces or semicolons in the proxy bypass string.</span></span> <span data-ttu-id="777f6-165">При указании <local> макроса функция обходит любое имя узла, которое не содержит точку.</span><span class="sxs-lookup"><span data-stu-id="777f6-165">If you specify the <local> macro, the function bypasses any host name that does not contain a period.</span></span>

> [!WARNING]
> <span data-ttu-id="777f6-166">После выполнения Proxycfg.exe вы не сможете восстановить предыдущие параметры прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-166">After Proxycfg.exe runs, you cannot restore the previous proxy settings.</span></span> <span data-ttu-id="777f6-167">Однако можно полностью удалить параметры прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-167">However, you can remove the proxy settings entirely.</span></span>

 

## <a name="usage"></a><span data-ttu-id="777f6-168">Использование</span><span class="sxs-lookup"><span data-stu-id="777f6-168">Usage</span></span>

<span data-ttu-id="777f6-169">Чтобы использовать средство настройки прокси-сервера, откройте окно командной строки и запустите служебную программу настройки прокси-сервера с соответствующими параметрами.</span><span class="sxs-lookup"><span data-stu-id="777f6-169">To use the proxy configuration tool, open a command prompt window and run the proxy configuration utility with the appropriate command line parameters.</span></span> <span data-ttu-id="777f6-170">В следующем разделе приведены примеры синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="777f6-170">The following section provides syntax examples.</span></span>

## <a name="example-syntax"></a><span data-ttu-id="777f6-171">Пример синтаксиса</span><span class="sxs-lookup"><span data-stu-id="777f6-171">Example Syntax</span></span>

### <a name="example-1-use-a-proxy-only-for-external-resources"></a><span data-ttu-id="777f6-172">Пример 1. использование прокси-сервера только для внешних ресурсов</span><span class="sxs-lookup"><span data-stu-id="777f6-172">Example 1: Use a proxy only for external resources</span></span>

<span data-ttu-id="777f6-173">Ниже приведен наиболее распространенный пример использования Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="777f6-173">The following is the most common use for Proxycfg.exe.</span></span> <span data-ttu-id="777f6-174">Эта команда указывает, что доступ к серверам HTTP и HTTPS осуществляется через прокси-сервер с именем "прокси- \_ сервер", за исключением имен узлов, которые не содержат точки.</span><span class="sxs-lookup"><span data-stu-id="777f6-174">This command specifies that both HTTP and HTTPS servers are accessed through the proxy server named "proxy\_server", except for host names that do not contain a period.</span></span>

<span data-ttu-id="777f6-175">**proxycfg-p прокси- \_ сервер " <local> "**</span><span class="sxs-lookup"><span data-stu-id="777f6-175">**proxycfg -p proxy\_server "<local>"**</span></span>

### <a name="example-2-use-a-proxy-for-all-resources"></a><span data-ttu-id="777f6-176">Пример 2. использование прокси-сервера для всех ресурсов</span><span class="sxs-lookup"><span data-stu-id="777f6-176">Example 2: Use a proxy for all resources</span></span>

<span data-ttu-id="777f6-177">В следующем примере указывается, что доступ к серверам HTTP и HTTPS осуществляется через прокси-сервер с именем "прокси- \_ сервер".</span><span class="sxs-lookup"><span data-stu-id="777f6-177">The following example specifies that both HTTP and HTTPS servers are accessed through the proxy server named "proxy\_server".</span></span> <span data-ttu-id="777f6-178">Список обхода не указан.</span><span class="sxs-lookup"><span data-stu-id="777f6-178">No bypass list is specified.</span></span>

<span data-ttu-id="777f6-179">**proxycfg-p прокси- \_ сервер**</span><span class="sxs-lookup"><span data-stu-id="777f6-179">**proxycfg -p proxy\_server**</span></span>

### <a name="example-3-use-a-different-proxy-for-secure-resources"></a><span data-ttu-id="777f6-180">Пример 3. Использование другого прокси-сервера для защиты ресурсов</span><span class="sxs-lookup"><span data-stu-id="777f6-180">Example 3: Use a different proxy for secure resources</span></span>

<span data-ttu-id="777f6-181">В следующем примере указывается, что доступ к серверам HTTP осуществляется через прокси-сервер HTTP, \_ а серверы HTTPS — через \_ прокси-сервер HTTPS.</span><span class="sxs-lookup"><span data-stu-id="777f6-181">The following example specifies that HTTP servers are accessed through the http\_proxy proxy and HTTPS servers are accessed through https\_proxy.</span></span> <span data-ttu-id="777f6-182">Сайты локальной интрасети и любой сайт в \* домене. Microsoft.com обходят прокси-сервер.</span><span class="sxs-lookup"><span data-stu-id="777f6-182">Local intranet sites and any site in the \*.microsoft.com domain bypass the proxy.</span></span>

<span data-ttu-id="777f6-183">**proxycfg-p "HTTP = HTTP \_ прокси HTTPS = \_ прокси-сервер HTTPS" " <local> ; \* . microsoft.com "**</span><span class="sxs-lookup"><span data-stu-id="777f6-183">**proxycfg -p "http=http\_proxy https=https\_proxy" "<local>;\*.microsoft.com"**</span></span>

## <a name="removing-proxycfgexe"></a><span data-ttu-id="777f6-184">Удаление ProxyCfg.exe</span><span class="sxs-lookup"><span data-stu-id="777f6-184">Removing ProxyCfg.exe</span></span>

<span data-ttu-id="777f6-185">После использования средства настройки прокси-сервера восстановить исходные параметры прокси-сервера нельзя.</span><span class="sxs-lookup"><span data-stu-id="777f6-185">After using the proxy configuration tool, you cannot restore your original proxy settings.</span></span> <span data-ttu-id="777f6-186">Однако при необходимости можно удалить параметры реестра, создаваемые служебной программой.</span><span class="sxs-lookup"><span data-stu-id="777f6-186">However, if necessary, you can remove the registry settings that the utility creates.</span></span> <span data-ttu-id="777f6-187">Чтобы удалить записи реестра, создаваемые ProxyCfg.exe, необходимо удалить значение **винхттпсеттингс** из следующего раздела реестра.</span><span class="sxs-lookup"><span data-stu-id="777f6-187">To remove the registry entries that ProxyCfg.exe creates, you must delete the **WinHttpSettings** value from the following registry key.</span></span>

<span data-ttu-id="777f6-188">**HKey \_ \_** \\ **Программное обеспечение** локального компьютера \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **подключения параметры Интернета** \\  \\ **винхттпсеттингс**</span><span class="sxs-lookup"><span data-stu-id="777f6-188">**HKEY\_LOCAL\_MACHINE**\\**SOFTWARE**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Internet Settings**\\**Connections**\\**WinHttpSettings**</span></span>

<span data-ttu-id="777f6-189">При удалении значения *винхттпсеттингс* удаляются все конфигурации прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-189">Deleting the *WinHttpSettings* value removes all proxy configurations.</span></span>

## <a name="proxycfgexe-and-authentication"></a><span data-ttu-id="777f6-190">ProxyCfg.exe и проверка подлинности</span><span class="sxs-lookup"><span data-stu-id="777f6-190">ProxyCfg.exe and Authentication</span></span>

<span data-ttu-id="777f6-191">Служебная программа настройки прокси-сервера задает политику проверки подлинности по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="777f6-191">The proxy configuration utility sets the default authentication policy.</span></span> <span data-ttu-id="777f6-192">Так как не следует выполнять проверку подлинности NTLM с недоверенными узлами, проверка подлинности NTLM выполняется автоматически с узлами в списке обхода прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="777f6-192">Because you should not perform NTLM authentication with untrusted hosts, by default, NTLM authentication only occurs automatically with hosts on the proxy bypass list.</span></span> <span data-ttu-id="777f6-193">Если прокси-сервер отсутствует, можно по-прежнему использовать ProxyCfg.exe для указания списка обхода узлов, которым вы доверяете для выполнения проверки подлинности NTLM.</span><span class="sxs-lookup"><span data-stu-id="777f6-193">If there is no proxy, you can still use ProxyCfg.exe to specify a bypass list of hosts that you trust to perform NTLM authentication.</span></span> <span data-ttu-id="777f6-194">При использовании ProxyCfg.exe для этой цели требуется имя прокси-сервера, но вместо действительного имени прокси-сервера можно использовать любую допустимую строку.</span><span class="sxs-lookup"><span data-stu-id="777f6-194">A proxy name is required when using ProxyCfg.exe for this purpose, but you can use any valid string in place of a real proxy name.</span></span>

<span data-ttu-id="777f6-195">Дополнительные сведения о политике автоматического входа в систему см. в разделе [Автоматическая политика входа в систему](authentication-in-winhttp.md).</span><span class="sxs-lookup"><span data-stu-id="777f6-195">For more information about the auto-logon policy, see [Automatic Logon Policy](authentication-in-winhttp.md).</span></span>

 

 
