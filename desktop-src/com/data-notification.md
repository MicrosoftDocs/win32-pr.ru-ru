---
title: Уведомление об изменении данных
description: Объекты, которые используют данные из внешнего источника, иногда должны быть уведомлены об изменении данных в этом источнике.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105700947"
---
# <a name="data-notification"></a><span data-ttu-id="5cc38-103">Уведомление об изменении данных</span><span class="sxs-lookup"><span data-stu-id="5cc38-103">Data Notification</span></span>

<span data-ttu-id="5cc38-104">Объекты, которые используют данные из внешнего источника, иногда должны быть уведомлены об изменении данных в этом источнике.</span><span class="sxs-lookup"><span data-stu-id="5cc38-104">Objects that consume data from an external source sometimes need to be informed when data in that source changes.</span></span> <span data-ttu-id="5cc38-105">Например, средство просмотра ленты биржевых котировок, основанное на данных в некоторых электронных таблицах, должно получать уведомления об изменении этих данных, чтобы обновить его отображение.</span><span class="sxs-lookup"><span data-stu-id="5cc38-105">For example, a stock ticker tape viewer that relies on data in some spreadsheet needs to be notified when that data changes so it can update its display.</span></span> <span data-ttu-id="5cc38-106">Аналогично составному документу требуются сведения об изменениях данных во внедренных объектах, чтобы он мог обновить свои кэши данных.</span><span class="sxs-lookup"><span data-stu-id="5cc38-106">Similarly, a compound document needs information about data changes in its embedded objects so that it can update its data caches.</span></span> <span data-ttu-id="5cc38-107">В таких случаях, когда желательно динамическое обновление данных, источникам данных требуется некоторый механизм уведомления потребителей данных об изменениях по мере их возникновения, не требуя от потребителей удаления всех элементов для обновления данных.</span><span class="sxs-lookup"><span data-stu-id="5cc38-107">In cases such as this, where dynamic updating of data is desirable, sources of data require some mechanism of notifying data consumers of changes as they occur without obligating the consumers to drop everything in order to update their data.</span></span> <span data-ttu-id="5cc38-108">В идеале, если было получено извещение об изменении в источнике данных, использование объекта может запросить обновленную копию в свободное место.</span><span class="sxs-lookup"><span data-stu-id="5cc38-108">Ideally, having been notified that a change has occurred in the data source, a consuming object can ask for an updated copy at its leisure.</span></span>

<span data-ttu-id="5cc38-109">Механизм обработки асинхронных уведомлений этого типа с помощью COM-объекта — это объект, называемый приемником advise, который представляет собой любой COM-объект, реализующий интерфейс с именем [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span><span class="sxs-lookup"><span data-stu-id="5cc38-109">COM's mechanism for handling asynchronous notifications of this type is an object called an advise sink, which is simply any COM object that implements an interface called [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span></span> <span data-ttu-id="5cc38-110">Потребители данных реализуют **иадвисесинк**.</span><span class="sxs-lookup"><span data-stu-id="5cc38-110">Consumers of data implement the **IAdviseSink**.</span></span> <span data-ttu-id="5cc38-111">Они регистрируются для получения уведомлений, передают указатель на интересующий объект данных.</span><span class="sxs-lookup"><span data-stu-id="5cc38-111">They register to receive notifications by handing a pointer to the data object of interest.</span></span>

<span data-ttu-id="5cc38-112">Интерфейсы [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) предоставляют следующие методы получения асинхронных уведомлений:</span><span class="sxs-lookup"><span data-stu-id="5cc38-112">The [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interfaces exposes the following methods for receiving asynchronous notifications:</span></span>



| <span data-ttu-id="5cc38-113">Метод</span><span class="sxs-lookup"><span data-stu-id="5cc38-113">Method</span></span>                                                      | <span data-ttu-id="5cc38-114">Уведомляет приемник уведомлений о том, что</span><span class="sxs-lookup"><span data-stu-id="5cc38-114">Notifies the advise sink that</span></span>                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="5cc38-115">**ондатачанже**</span><span class="sxs-lookup"><span data-stu-id="5cc38-115">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | <span data-ttu-id="5cc38-116">Данные вызывающего объекта изменились.</span><span class="sxs-lookup"><span data-stu-id="5cc38-116">The calling object's data has changed.</span></span><br/>                        |
| [<span data-ttu-id="5cc38-117">**онвиевчанже**</span><span class="sxs-lookup"><span data-stu-id="5cc38-117">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | <span data-ttu-id="5cc38-118">Инструкции по рисованию вызывающего объекта были изменены.</span><span class="sxs-lookup"><span data-stu-id="5cc38-118">The instructions for drawing the calling object have changed.</span></span><br/> |
| [<span data-ttu-id="5cc38-119">**Onrename**</span><span class="sxs-lookup"><span data-stu-id="5cc38-119">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | <span data-ttu-id="5cc38-120">Моникер вызывающего объекта изменился.</span><span class="sxs-lookup"><span data-stu-id="5cc38-120">The calling object's moniker has changed.</span></span><br/>                     |
| [<span data-ttu-id="5cc38-121">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="5cc38-121">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | <span data-ttu-id="5cc38-122">Вызывающий объект сохранен в постоянное хранилище.</span><span class="sxs-lookup"><span data-stu-id="5cc38-122">The calling object has been saved to persistent storage.</span></span><br/>      |
| [<span data-ttu-id="5cc38-123">**OnClose**</span><span class="sxs-lookup"><span data-stu-id="5cc38-123">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | <span data-ttu-id="5cc38-124">Вызывающий объект закрыт.</span><span class="sxs-lookup"><span data-stu-id="5cc38-124">The calling object has been closed.</span></span><br/>                           |



 

<span data-ttu-id="5cc38-125">Как показано в таблице, интерфейс [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) предоставляет методы для уведомления приемника уведомлений о событиях, отличных от изменений в данных вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="5cc38-125">As the table indicates, the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface exposes methods for notifying the advise sink of events other than changes in the calling object's data.</span></span> <span data-ttu-id="5cc38-126">Вызывающий объект также может уведомлять приемник о том, как он проводит изменения, или переименован, сохранен или закрыт.</span><span class="sxs-lookup"><span data-stu-id="5cc38-126">The calling object can also notify the sink when the way in which it draws itself changes, or it is renamed, saved, or closed.</span></span> <span data-ttu-id="5cc38-127">Эти другие уведомления используются в основном или полностью в контексте составных документов, хотя механизм уведомления идентичен.</span><span class="sxs-lookup"><span data-stu-id="5cc38-127">These other notifications are used mainly or entirely in the context of compound documents, although the notification mechanism is identical.</span></span> <span data-ttu-id="5cc38-128">Дополнительные сведения об уведомлениях составных документов см. в разделе «составные документы».</span><span class="sxs-lookup"><span data-stu-id="5cc38-128">For more information on compound-document notifications, see "Compound Documents."</span></span>

<span data-ttu-id="5cc38-129">Чтобы воспользоваться преимуществами приемника уведомлений, источник данных должен реализовать интерфейс [**IDataObject::D advise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::D unadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)и [**IDataObject:: енумдадвисе**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span><span class="sxs-lookup"><span data-stu-id="5cc38-129">In order to take advantage of the advise sink, a data source must implement [**IDataObject::DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**IDataObject::EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span></span> <span data-ttu-id="5cc38-130">Потребитель данных вызывает **дадвисе** мосод, чтобы уведомить объект данных о том, что он желает получать уведомления при изменении данных объекта.</span><span class="sxs-lookup"><span data-stu-id="5cc38-130">A data consumer calls the **DAdvise** mothod to notify a data object that it wishes to be notified when the object's data changes.</span></span> <span data-ttu-id="5cc38-131">Потребляемый объект вызывает метод **дунадвисе** для разрыва соединения.</span><span class="sxs-lookup"><span data-stu-id="5cc38-131">The consuming object calls the **DUnadvise** method to tear down this connection.</span></span> <span data-ttu-id="5cc38-132">Любой заинтересованной стороной может быть вызван метод **енумдадвисе** , чтобы узнать количество объектов, имеющих рекомендательное соединение с объектом данных.</span><span class="sxs-lookup"><span data-stu-id="5cc38-132">Any interested party can call the **EnumDAdvise** method to learn the number of objects having an advisory connection with a data object.</span></span>

<span data-ttu-id="5cc38-133">При изменении данных в источнике объект данных вызывает [**иадвисесинк:: ондатачанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) для всех потребителей данных, зарегистрированных для получения уведомлений.</span><span class="sxs-lookup"><span data-stu-id="5cc38-133">When data changes at the source, the data object calls [**IAdviseSink::OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) on all data consumers that have registered to receive notifications.</span></span> <span data-ttu-id="5cc38-134">Для наблюдения за лицензионными соединениями и управления отправкой уведомлений источники данных полагаются на объект, называемый *держательом рекомендаций по данным*.</span><span class="sxs-lookup"><span data-stu-id="5cc38-134">To keep track of advisory connections and manage the dispatch of notifications, data sources rely on an object called a *data advise holder*.</span></span> <span data-ttu-id="5cc38-135">Вы можете создать собственный держатель для рекомендаций по данным, реализовав интерфейс [**идатаадвисехолдер**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) .</span><span class="sxs-lookup"><span data-stu-id="5cc38-135">You can create your own data advise holder by implementing the [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) interface.</span></span> <span data-ttu-id="5cc38-136">Вы также можете разрешить COM делать это за вас, вызвав вспомогательную функцию [**креатедатаадвисехолдер**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span><span class="sxs-lookup"><span data-stu-id="5cc38-136">Or, you can let COM do it for you by calling the helper function [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5cc38-137">См. также</span><span class="sxs-lookup"><span data-stu-id="5cc38-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5cc38-138">Передача данных</span><span class="sxs-lookup"><span data-stu-id="5cc38-138">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

