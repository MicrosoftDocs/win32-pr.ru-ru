---
title: Уведомление об изменении данных
description: Объекты, которые используют данные из внешнего источника, иногда должны быть уведомлены об изменении данных в этом источнике.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105700947"
---
# <a name="data-notification"></a>Уведомление об изменении данных

Объекты, которые используют данные из внешнего источника, иногда должны быть уведомлены об изменении данных в этом источнике. Например, средство просмотра ленты биржевых котировок, основанное на данных в некоторых электронных таблицах, должно получать уведомления об изменении этих данных, чтобы обновить его отображение. Аналогично составному документу требуются сведения об изменениях данных во внедренных объектах, чтобы он мог обновить свои кэши данных. В таких случаях, когда желательно динамическое обновление данных, источникам данных требуется некоторый механизм уведомления потребителей данных об изменениях по мере их возникновения, не требуя от потребителей удаления всех элементов для обновления данных. В идеале, если было получено извещение об изменении в источнике данных, использование объекта может запросить обновленную копию в свободное место.

Механизм обработки асинхронных уведомлений этого типа с помощью COM-объекта — это объект, называемый приемником advise, который представляет собой любой COM-объект, реализующий интерфейс с именем [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink). Потребители данных реализуют **иадвисесинк**. Они регистрируются для получения уведомлений, передают указатель на интересующий объект данных.

Интерфейсы [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) предоставляют следующие методы получения асинхронных уведомлений:



| Метод                                                      | Уведомляет приемник уведомлений о том, что                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [**ондатачанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | Данные вызывающего объекта изменились.<br/>                        |
| [**онвиевчанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | Инструкции по рисованию вызывающего объекта были изменены.<br/> |
| [**Onrename**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | Моникер вызывающего объекта изменился.<br/>                     |
| [**OnSave**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | Вызывающий объект сохранен в постоянное хранилище.<br/>      |
| [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | Вызывающий объект закрыт.<br/>                           |



 

Как показано в таблице, интерфейс [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) предоставляет методы для уведомления приемника уведомлений о событиях, отличных от изменений в данных вызывающего объекта. Вызывающий объект также может уведомлять приемник о том, как он проводит изменения, или переименован, сохранен или закрыт. Эти другие уведомления используются в основном или полностью в контексте составных документов, хотя механизм уведомления идентичен. Дополнительные сведения об уведомлениях составных документов см. в разделе «составные документы».

Чтобы воспользоваться преимуществами приемника уведомлений, источник данных должен реализовать интерфейс [**IDataObject::D advise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::D unadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)и [**IDataObject:: енумдадвисе**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise). Потребитель данных вызывает **дадвисе** мосод, чтобы уведомить объект данных о том, что он желает получать уведомления при изменении данных объекта. Потребляемый объект вызывает метод **дунадвисе** для разрыва соединения. Любой заинтересованной стороной может быть вызван метод **енумдадвисе** , чтобы узнать количество объектов, имеющих рекомендательное соединение с объектом данных.

При изменении данных в источнике объект данных вызывает [**иадвисесинк:: ондатачанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) для всех потребителей данных, зарегистрированных для получения уведомлений. Для наблюдения за лицензионными соединениями и управления отправкой уведомлений источники данных полагаются на объект, называемый *держательом рекомендаций по данным*. Вы можете создать собственный держатель для рекомендаций по данным, реализовав интерфейс [**идатаадвисехолдер**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) . Вы также можете разрешить COM делать это за вас, вызвав вспомогательную функцию [**креатедатаадвисехолдер**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Передача данных](data-transfer.md)
</dt> </dl>

 

