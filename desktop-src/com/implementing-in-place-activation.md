---
title: Реализация активации In-Place
description: Реализация активации In-Place
ms.assetid: 5fd67d1c-1dc5-4d83-a41e-b64d84cbf212
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c075f143c772fe34de0c494664227e892b998387
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105672071"
---
# <a name="implementing-in-place-activation"></a><span data-ttu-id="6b0e9-103">Реализация активации In-Place</span><span class="sxs-lookup"><span data-stu-id="6b0e9-103">Implementing In-Place Activation</span></span>

<span data-ttu-id="6b0e9-104">Встроенная активация позволяет пользователю взаимодействовать с внедренным объектом, не открывая документ контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-104">In-place activation enables a user to interact with an embedded object without leaving the container document.</span></span> <span data-ttu-id="6b0e9-105">Когда пользователь активирует объект, в *составной строке* меню, включающей элементы из панелей меню приложения-контейнера и сервера, заменяется Главная строка меню контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-105">When a user activates the object, a *composite menu bar* comprising elements from both the container application's and server application's menu bars replaces the container's main menu bar.</span></span> <span data-ttu-id="6b0e9-106">Доступ к командам и функциям обоих приложений предоставляется пользователю, включая контекстную справку для активного объекта.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-106">Commands and features from both applications are thus available to the user, including context sensitive help for the active object.</span></span> <span data-ttu-id="6b0e9-107">Когда пользователь начинает работать с какой-либо частью документа, не относящимся к объекту, объект деактивируется, в результате чего в исходном меню документа-контейнера заменяется составное меню.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-107">When a user begins working with some non-object portion of the document, the object is deactivated, causing the container document's original menu to replace the composite menu.</span></span>

<span data-ttu-id="6b0e9-108">Эта возможность изначально была *изменена именем на месте*.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-108">This capability originally went by the name of *in-place editing*.</span></span> <span data-ttu-id="6b0e9-109">Имя было изменено, так как редактирование является одним из способов взаимодействия пользователя с запущенным объектом.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-109">The name was changed because editing is only one way for a user to interact with a running object.</span></span> <span data-ttu-id="6b0e9-110">Например, звуковые клипы можно прослушивать вместо редактирования.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-110">Sound clips, for example, can be listened to instead of editing.</span></span> <span data-ttu-id="6b0e9-111">Видеоклипы можно просматривать вместо редактирования.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-111">Video clips can be viewed instead of editing.</span></span> <span data-ttu-id="6b0e9-112">Активация на месте особенно APT в случае видеороликов, так как она позволяет запускать их на месте, не вызывая отдельное окно.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-112">In-place activation is particularly apt in the case of video clips because it allows them to run in place, without calling up a separate window.</span></span> <span data-ttu-id="6b0e9-113">Это может быть критическим, если видео было просмотрено, скажем, в сочетании с соседними текстовыми данными в документе контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-113">This could be critical if the video were to be viewed, say, in conjunction with adjacent text data in the container document.</span></span>

<span data-ttu-id="6b0e9-114">Реализация встроенной активации является исключительно необязательной для контейнеров и серверных приложений.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-114">Implementing in-place activation is strictly optional for both container and server applications.</span></span> <span data-ttu-id="6b0e9-115">OLE по-прежнему поддерживает модель, в которой активация объекта приводит к тому, что серверное приложение открывает отдельное окно.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-115">OLE still supports the model in which activating an object causes the server application to open a separate window.</span></span> <span data-ttu-id="6b0e9-116">Связанные объекты всегда открываются в отдельном окне, чтобы подчеркнуть, что они находятся в отдельном документе.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-116">Linked objects always open in a separate window to emphasize that they reside in a separate document.</span></span>

<span data-ttu-id="6b0e9-117">Активация на месте начинается с объекта в ответ на вызов [**иолеобжект::D оверб**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) из своего контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-117">In-place activation begins with the object in response to an [**IOleObject::DoVerb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) call from its container.</span></span> <span data-ttu-id="6b0e9-118">Этот вызов обычно происходит в ответ на то, что пользователь дважды щелкает объект или выбирает команду (глагол) в меню редактирования приложения-контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-118">This call usually happens in response to a user double-clicking the object or selecting a command (verb) from the container application's Edit menu.</span></span>

<span data-ttu-id="6b0e9-119">Встроенное окно получает ввод с клавиатуры и мыши, когда внедренный объект активен.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-119">The in-place window receives keyboard and mouse input while the embedded object is active.</span></span> <span data-ttu-id="6b0e9-120">Когда пользователь выбирает команды из составной строки меню, команда и связанные с ним сообщения меню отправляются в контейнер или объектное приложение в зависимости от того, какой из них является выбранным раскрывающимся меню.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-120">When a user selects commands from the composite menu bar, the command and associated menu messages are sent to the container or object application, depending on which owns the particular drop-down menu selected.</span></span> <span data-ttu-id="6b0e9-121">Входные данные с помощью линеек, панелей инструментов или оформленных рамок объекта попадают непосредственно в внедренный объект, которому принадлежат эти окна.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-121">Input by means of an object's rulers, toolbars, or frame adornments go directly to the embedded object, which owns these windows.</span></span>

<span data-ttu-id="6b0e9-122">Внедренный объект, активированный на месте, остается активным до тех пор, пока контейнер не деактивирует его в ответ на вводимые пользователем данные, или объект добровольно придает активное состояние, как, например, видеоролик.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-122">An in-place-activated embedded object remains active until either the container deactivates it in response to user input or the object voluntarily gives up the active state, as a video clip might do, for example.</span></span> <span data-ttu-id="6b0e9-123">Пользователь может деактивировать объект, щелкнув его внутри документа контейнера, но за пределами окна «на месте» объекта или просто щелкнув другой объект.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-123">A user can deactivate an object by clicking inside the container document but outside the object's in-place-activation window, or simply by clicking another object.</span></span> <span data-ttu-id="6b0e9-124">Объект, активируемый на месте, остается активным, но если пользователь щелкает строку заголовка контейнера, полосу прокрутки или, в частности, строку меню.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-124">An in-place-activated object remains active, however, if the user clicks the container's title bar, scroll bar or, in particular, menu bar.</span></span>

<span data-ttu-id="6b0e9-125">Можно реализовать сервер обработки на месте в качестве внутрипроцессного сервера (DLL) или локального сервера (EXE).</span><span class="sxs-lookup"><span data-stu-id="6b0e9-125">You can implement an in-place-activation-object server either as an in-process server (DLL) or a local server (EXE).</span></span> <span data-ttu-id="6b0e9-126">В обоих случаях составная строка меню содержит элементы (обычно раскрывающиеся меню) из процессов сервера и контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-126">In both cases, the composite menu bar contains items (typically drop-down menus) from both the server and container processes.</span></span> <span data-ttu-id="6b0e9-127">В случае внутрипроцессного сервера окно активации на месте — это просто другое дочернее окно в иерархии окон контейнера, получающее входные данные через конвейер сообщений приложения-контейнера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-127">In the case of a in-process server, the in-place activation window is simply another child window in the container's window hierarchy, receiving its input through the container application's message pump.</span></span>

<span data-ttu-id="6b0e9-128">В случае с локальным сервером окно активации на месте относится к процессу серверного приложения внедренного объекта, но его родительское окно принадлежит контейнеру.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-128">In the case of a local server, the in-place activation window belongs to the embedded object's server application process, but its parent window belongs to the container.</span></span> <span data-ttu-id="6b0e9-129">Входные данные для окна "на месте" отображаются в очереди сообщений сервера и отправляются циклом обработки сообщений сервера.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-129">Input for the in-place-activation window appears in the server's message queue and is dispatched by the server's message loop.</span></span> <span data-ttu-id="6b0e9-130">Библиотеки OLE отвечают за то, что команды меню и сообщения отправляются правильно.</span><span class="sxs-lookup"><span data-stu-id="6b0e9-130">The OLE libraries are responsible for seeing to it that menu commands and messages are dispatched correctly.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6b0e9-131">См. также</span><span class="sxs-lookup"><span data-stu-id="6b0e9-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6b0e9-132">Составные документы</span><span class="sxs-lookup"><span data-stu-id="6b0e9-132">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 




