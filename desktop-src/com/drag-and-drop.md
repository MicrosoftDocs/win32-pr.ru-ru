---
title: Перетаскивание
description: Перетаскивание означает передачу данных, в которой используется мышь или другое указывающее устройство для указания источника данных и его назначения.
ms.assetid: bba0ddf8-fcf9-4827-bf85-7ac597d33b4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b388fc6c051fa73c72720d1f349cd50a4fa6902b8f880fbf5ccfb4cf263a4227
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119993164"
---
# <a name="drag-and-drop"></a>Перетаскивание

*Перетаскивание* означает передачу данных, в которой используется мышь или другое указывающее устройство для указания источника данных и его назначения. В обычной операции перетаскивания пользователь выбирает объект для передачи, перемещая указатель мыши на него и удерживая нажатой левую кнопку или другую кнопку, обозначенную для этой цели. Продолжая удерживать кнопку, пользователь инициирует перемещение, перетаскивая объект в место назначения, которое может быть любым контейнером OLE. Перетаскивание предоставляет те же функции, что и копирование и вставка в буфер обмена OLE, но добавляет визуальный отзыв и устраняет необходимость в меню. На самом деле, если приложение поддерживает копирование и вставку в буфер обмена, для поддержки перетаскивания требуется небольшое дополнительное значение.

Во время операции перетаскивания OLE используются следующие три отдельных фрагмента кода.



| Источник кода для перетаскивания                               | Реализация и использование                                                                                                                                                                      |
|---------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Интерфейс [**идропсаурце**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource)<br/> | Реализуется объектом, содержащим перетаскиваемые данные, называемый *источником перетаскивания*.<br/>                                                                                         |
| Интерфейс [**интерфейс IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget)<br/> | Реализуется объектом, который предназначен для принятия удаления, называемый *целью перетаскивания*.<br/>                                                                                 |
| Функция [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop)<br/>    | Реализуется OLE и используется для инициации операции перетаскивания. После выполнения операции она упрощает обмен данными между источником перетаскивания и целевым объектом перетаскивания.<br/> |



 

Интерфейсы [**идропсаурце**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) и [**интерфейс IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) могут быть реализованы либо в контейнере, либо в приложении объекта. Роль источника перетаскивания или цели перетаскивания не ограничена ни одним типом приложения OLE.

Функция OLE [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) реализует цикл, который отслеживает перемещение мыши и клавиатуры до тех пор, пока перетаскивание не будет отменено или происходит перетаскивание. **DoDragDrop** является ключевой функцией в процессе перетаскивания, что упрощает обмен данными между источником перетаскивания и целевым объектом перетаскивания.

Во время операции перетаскивания пользователю могут отображаться три типа отзывов.



| Тип отзыва            | Описание                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Отзывы об источнике<br/>  | Обратная связь источника, предоставляемая источником перетаскивания, указывает, что данные перетаскиваются и не изменяются в процессе перетаскивания. Как правило, данные выделяются, чтобы выдать сигнал выбранному.<br/>                                                                                                                                            |
| Отзыв указателя<br/> | Обратная связь указателя, предоставляемая источником перетаскивания, указывает, что произойдет, если мышь освобождается в любой момент времени. Обратная связь с указателями постоянно меняется по мере того, как пользователь перемещает мышь и/или нажимает клавишу-модификатор. Например, если указатель перемещается в окно, которое не принимает перетаскивание, указатель превращается в символ "не разрешено".<br/> |
| Отзывы о цели<br/>  | Обратная связь целевого объекта перетаскивания указывает, где будет выполняться перетаскивание.<br/>                                                                                                                                                                                                                                                                    |



 

Дополнительные сведения см. в разделе операции [перетаскивания источника](drag-source-responsibilities.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Передача данных](data-transfer.md)
</dt> </dl>

 

 





