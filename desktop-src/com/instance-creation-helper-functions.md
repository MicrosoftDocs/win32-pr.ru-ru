---
title: Вспомогательные функции для создания экземпляра
description: Вспомогательные функции для создания экземпляра
ms.assetid: 0b9b7bcf-f0f0-42c4-945e-63a532640d4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84956f6040aaba13b46dea92bea611a49d5d8de3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070667"
---
# <a name="instance-creation-helper-functions"></a><span data-ttu-id="c841a-103">Вспомогательные функции для создания экземпляра</span><span class="sxs-lookup"><span data-stu-id="c841a-103">Instance Creation Helper Functions</span></span>

<span data-ttu-id="c841a-104">В предыдущих выпусках COM основным механизмом, используемым для создания экземпляра объекта, была функция [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) .</span><span class="sxs-lookup"><span data-stu-id="c841a-104">In previous releases of COM, the primary mechanism used to create an object instance was the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span> <span data-ttu-id="c841a-105">Эта функция инкапсулирует процесс создания объекта класса, используя его для создания нового экземпляра и освобождения объекта класса.</span><span class="sxs-lookup"><span data-stu-id="c841a-105">This function encapsulates the process of creating a class object, using that to create a new instance and releasing the class object.</span></span> <span data-ttu-id="c841a-106">Другой функцией этого типа является более конкретный [**олекреате**](/windows/desktop/api/ole/nf-ole-olecreate), вспомогательный метод составного документа OLE, который создает объект класса и получает указатель на запрошенный объект.</span><span class="sxs-lookup"><span data-stu-id="c841a-106">Another function of this kind is the more specific [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate), the OLE compound document helper that creates a class object and retrieves a pointer to a requested object.</span></span>

<span data-ttu-id="c841a-107">Чтобы сгладить процесс создания экземпляров в распределенных системах, в модели COM появились четыре важных новых механизма создания экземпляров:</span><span class="sxs-lookup"><span data-stu-id="c841a-107">To smooth the process of instance creation on distributed systems, COM has introduced four important new instance creation mechanisms:</span></span>

-   <span data-ttu-id="c841a-108">Моникеры класса и [ **иклассактиватор**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span><span class="sxs-lookup"><span data-stu-id="c841a-108">Class monikers and [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span></span>
-   [<span data-ttu-id="c841a-109">**кокреатеинстанцеекс**</span><span class="sxs-lookup"><span data-stu-id="c841a-109">**CoCreateInstanceEx**</span></span>](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)
-   [<span data-ttu-id="c841a-110">**кожетинстанцефромфиле**</span><span class="sxs-lookup"><span data-stu-id="c841a-110">**CoGetInstanceFromFile**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile)
-   [<span data-ttu-id="c841a-111">**кожетинстанцефромистораже**</span><span class="sxs-lookup"><span data-stu-id="c841a-111">**CoGetInstanceFromIStorage**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage)

<span data-ttu-id="c841a-112">Моникер класса позволяет определить класс объекта и обычно используется с другим моникером, например моникером файла, для указания расположения объекта.</span><span class="sxs-lookup"><span data-stu-id="c841a-112">A class moniker permits you to identify the class of an object and is typically used with another moniker, like a file moniker, to indicate the location of the object.</span></span> <span data-ttu-id="c841a-113">Это позволяет выполнить привязку к объекту и указать сервер, который должен быть запущен для этого объекта.</span><span class="sxs-lookup"><span data-stu-id="c841a-113">This permits you to bind to an object and specify the server that is to be launched for that object.</span></span> <span data-ttu-id="c841a-114">Моникеры класса также могут состоять из имен справа от моникеров, поддерживающих привязку к интерфейсу [**иклассактиватор**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) .</span><span class="sxs-lookup"><span data-stu-id="c841a-114">Class monikers may also be composed to the right of monikers supporting binding to the [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) interface.</span></span> <span data-ttu-id="c841a-115">Дополнительные сведения см. в разделе [моникеры класса](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="c841a-115">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="c841a-116">[**Кокреатеинстанцеекс**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) расширяет [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) , чтобы можно было создать один неинициализированный объект, связанный с данным идентификатором CLSID, на указанном удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="c841a-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extends [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) to make it possible to create a single uninitialized object associated with the given CLSID on a specified remote machine.</span></span> <span data-ttu-id="c841a-117">Кроме того, вместо того, чтобы запрашивать один интерфейс и получать один указатель на этот интерфейс, **кокреатеинстанцеекс** делает возможным запрос нескольких интерфейсов и (при наличии) получать указатели на них в одном цикле приема-передачи, тем самым разрешая меньшее количество обращений между компьютерами.</span><span class="sxs-lookup"><span data-stu-id="c841a-117">In addition, rather than requesting a single interface and obtaining a single pointer to that interface, **CoCreateInstanceEx** makes it possible to query for multiple interfaces and (if available) receive pointers to them in a single round-trip, thus permitting fewer round-trips between machines.</span></span> <span data-ttu-id="c841a-118">Это может сделать взаимодействие удаленного объекта гораздо более эффективным.</span><span class="sxs-lookup"><span data-stu-id="c841a-118">This can make remote object interaction much more efficient.</span></span> <span data-ttu-id="c841a-119">Для этого в функции используется массив структур с [**несколькими \_ qiми**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) .</span><span class="sxs-lookup"><span data-stu-id="c841a-119">To do this, the function uses an array of [**MULTI\_QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) structures.</span></span>

<span data-ttu-id="c841a-120">Для создания объекта через [**кокреатеинстанцеекс**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) все равно требуется инициализировать объект с помощью вызова одного из интерфейсов инициализации (например, [**Иперсистстораже:: Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span><span class="sxs-lookup"><span data-stu-id="c841a-120">Creating an object through [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) still requires that the object be initialized through a call to one of the initialization interfaces (such as [**IPersistStorage::Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span></span> <span data-ttu-id="c841a-121">Вспомогательные функции [**кожетинстанцефромфиле**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) и [**кожетинстанцефромистораже**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) инкапсулируют возможности создания экземпляров **кокреатеинстанцеекс** и инициализации, первый из файлов и второй из хранилища.</span><span class="sxs-lookup"><span data-stu-id="c841a-121">The helper functions [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) and [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulate both the instance creation power of **CoCreateInstanceEx** and the initialization, the former from a file and the latter from a storage.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c841a-122">См. также</span><span class="sxs-lookup"><span data-stu-id="c841a-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c841a-123">Создание объекта через объект класса</span><span class="sxs-lookup"><span data-stu-id="c841a-123">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 