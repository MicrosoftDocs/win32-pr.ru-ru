---
title: Реализация диспетчера категорий компонентов
description: По мере роста количества доступных компонентов становится все сложнее управлять этими компонентами. С точки зрения предоставляемых им интерфейсов, а также задач, которые они выполняют, многие компоненты предлагают аналогичные функции.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2414567beba159c05ea08b3561f0a97ddda1cb70
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103986828"
---
# <a name="component-categories-manager-implementation"></a><span data-ttu-id="22713-104">Реализация диспетчера категорий компонентов</span><span class="sxs-lookup"><span data-stu-id="22713-104">Component Categories Manager Implementation</span></span>

<span data-ttu-id="22713-105">По мере роста количества доступных компонентов становится все сложнее управлять этими компонентами.</span><span class="sxs-lookup"><span data-stu-id="22713-105">As the number of available components grows, it becomes increasingly difficult to manage these components.</span></span> <span data-ttu-id="22713-106">С точки зрения предоставляемых им интерфейсов, а также задач, которые они выполняют, многие компоненты предлагают аналогичные функции.</span><span class="sxs-lookup"><span data-stu-id="22713-106">In terms of the interfaces they expose as well as the tasks they perform, many components offer similar functionality.</span></span>

<span data-ttu-id="22713-107">Часто бывает необходимо перечислить компоненты, которые можно использовать в определенном контексте.</span><span class="sxs-lookup"><span data-stu-id="22713-107">It is often necessary to enumerate the components that can be used in a certain context.</span></span> <span data-ttu-id="22713-108">В качестве примера можно привести диалоговое окно **Вставка объекта** , используемое в составных документах OLE, и диалоговое окно « **Вставка элемента управления** », используемое в элементах управления OLE.</span><span class="sxs-lookup"><span data-stu-id="22713-108">Examples of this are the **Insert Object** dialog box used in OLE compound documents and the **Insert Control** dialog box used in OLE controls.</span></span> <span data-ttu-id="22713-109">В этих диалоговых окнах перечислены все компоненты, которые удовлетворяют (или удовлетворяют требованиям), контракты интерфейсов для составных документов или элементов управления.</span><span class="sxs-lookup"><span data-stu-id="22713-109">These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls.</span></span> <span data-ttu-id="22713-110">Эти существующие категории (документ OLE, элемент управления OLE) не подразумевают точную сигнатуру интерфейса.</span><span class="sxs-lookup"><span data-stu-id="22713-110">These existing categories (OLE document, OLE control) do not imply an exact interface signature.</span></span> <span data-ttu-id="22713-111">Документы OLE должны предоставлять определенный набор базовых интерфейсов (например, [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) или [**иперсистстораже**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)), но также могут предоставлять дополнительные интерфейсы, такие как [**иолелинк**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span><span class="sxs-lookup"><span data-stu-id="22713-111">OLE documents have to expose a certain set of core interfaces (for example, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) but can also expose additional interfaces such as [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span></span>

<span data-ttu-id="22713-112">В прошлом компоненты были помечены путем добавления понятного имени ("inserted", "Control" и т. д.) в качестве подраздела к **\_ \_ корневому CLSID классов hKey \\ \\ {...}**</span><span class="sxs-lookup"><span data-stu-id="22713-112">In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a subkey to the **HKEY\_CLASSES\_ROOT\\CLSID\\{...}**</span></span> <span data-ttu-id="22713-113">раздел реестра, соответствующий компоненту.</span><span class="sxs-lookup"><span data-stu-id="22713-113">registry key corresponding to the component.</span></span> <span data-ttu-id="22713-114">Это хорошо работает для центрального определения категорий, но конфликты имен, когда многие независимые стороны определяют новые категории.</span><span class="sxs-lookup"><span data-stu-id="22713-114">This works well for a central definition of categories but risks name collisions when many independent parties define new categories.</span></span> <span data-ttu-id="22713-115">Как и в других областях COM, решение, обеспечивающее расширяемое пространство имен, заключается в использовании глобально уникальных идентификаторов (GUID).</span><span class="sxs-lookup"><span data-stu-id="22713-115">As in other areas of COM, the solution to providing an extensible namespace lies in the use of globally unique identifiers (GUIDs).</span></span> <span data-ttu-id="22713-116">Вместо того чтобы использовать удобное для восприятия имя, каждой категории назначается уникальный номер (CATID).</span><span class="sxs-lookup"><span data-stu-id="22713-116">Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</span></span>

<span data-ttu-id="22713-117">Еще одно ограничение, связанное с существующей классификацией, заключается в том, что оно ограничивается возможностями самого компонента.</span><span class="sxs-lookup"><span data-stu-id="22713-117">Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself.</span></span> <span data-ttu-id="22713-118">Для многих компонентов требуются определенные возможности из контейнеров.</span><span class="sxs-lookup"><span data-stu-id="22713-118">Many components require certain capabilities from the containers.</span></span> <span data-ttu-id="22713-119">Когда такой компонент вставляется в контейнер, вставка может завершиться ошибкой или неожиданно вести себя, даже если компонент выполняет контракты, подразумеваемые одной из ее категорий.</span><span class="sxs-lookup"><span data-stu-id="22713-119">When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories.</span></span> <span data-ttu-id="22713-120">Чтобы перечислить компоненты, которые могут быть использованы в определенных ситуациях, необходимо учитывать возможности как компонента, так и контейнера.</span><span class="sxs-lookup"><span data-stu-id="22713-120">To enumerate the components that can be used successfully in certain situations, the capabilities of both the component and the container must be considered.</span></span>

<span data-ttu-id="22713-121">Из-за этих рекомендаций в существующую классификацию были внесены следующие изменения:</span><span class="sxs-lookup"><span data-stu-id="22713-121">Because of these considerations, the following changes were made to the existing categorization:</span></span>

-   <span data-ttu-id="22713-122">Категории указываются с помощью CATID, которые являются глобально уникальными идентификаторами.</span><span class="sxs-lookup"><span data-stu-id="22713-122">Categories are indicated by using CATIDs that are globally unique identifiers.</span></span>
-   <span data-ttu-id="22713-123">В подразделе **Components** **\_ \_ корневого раздела реестра \\ CLSID для классов hKey** были разработаны два отдельных подраздела, "реализованные категории" и "обязательные категории".</span><span class="sxs-lookup"><span data-stu-id="22713-123">Under the **Components** subkey of the **HKEY\_CLASSES\_ROOT\\CLSID** registry key, two separate subkeys, "Implemented Categories" and "Required Categories", were developed.</span></span> <span data-ttu-id="22713-124">Эти подразделы содержат списки CATID, предоставляемые компонентом или которые должен предоставить контейнер компонента.</span><span class="sxs-lookup"><span data-stu-id="22713-124">These subkeys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</span></span>

<span data-ttu-id="22713-125">Для упрощения управления категориями компонентов категории перечислены в центральном месте в реестре: **\_ \_ категории корневых \\ компонентов классов hKey**.</span><span class="sxs-lookup"><span data-stu-id="22713-125">To ease managing the component categories, categories are listed in a central place in the registry: **HKEY\_CLASSES\_ROOT\\Component Categories**.</span></span> <span data-ttu-id="22713-126">В этом разделе перечислены установленные категории с идентификаторами CATID, а также локализованные, понятные имена.</span><span class="sxs-lookup"><span data-stu-id="22713-126">This key lists the installed categories both with their CATID and with localized, human-readable names.</span></span>

<span data-ttu-id="22713-127">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="22713-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="22713-128">Категоризация по возможностям компонентов</span><span class="sxs-lookup"><span data-stu-id="22713-128">Categorizing by Component Capabilities</span></span>](categorizing-by-component-capabilities.md)
-   [<span data-ttu-id="22713-129">Категоризация по возможностям контейнеров</span><span class="sxs-lookup"><span data-stu-id="22713-129">Categorizing by Container Capabilities</span></span>](categorizing-by-container-capabilities.md)
-   [<span data-ttu-id="22713-130">Диспетчер категорий компонентов</span><span class="sxs-lookup"><span data-stu-id="22713-130">The Component Categories Manager</span></span>](the-component-categories-manager.md)
-   [<span data-ttu-id="22713-131">Классы и ассоциации по умолчанию</span><span class="sxs-lookup"><span data-stu-id="22713-131">Default Classes and Associations</span></span>](default-classes-and-associations.md)
-   [<span data-ttu-id="22713-132">Определение категорий компонентов</span><span class="sxs-lookup"><span data-stu-id="22713-132">Defining Component Categories</span></span>](defining-component-categories.md)
-   [<span data-ttu-id="22713-133">Связывание значков с категорией</span><span class="sxs-lookup"><span data-stu-id="22713-133">Associating Icons with a Category</span></span>](associating-icons-with-a-category.md)

 

 




