---
title: Создание сценариев с помощью COM-объектов
description: Создание сценариев с помощью COM-объектов
ms.assetid: d99a561b-67dc-4fc9-adfa-cd7350eb16ba
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f2b00380a14db2d254675a5826b61f262e8cfe8
ms.sourcegitcommit: 8c981a2f4149b4a9d605ffb71fefda8d82bc696e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2019
ms.locfileid: "103783201"
---
# <a name="scripting-with-com-objects"></a><span data-ttu-id="bceb3-103">Создание сценариев с помощью COM-объектов</span><span class="sxs-lookup"><span data-stu-id="bceb3-103">Scripting with COM Objects</span></span>

<span data-ttu-id="bceb3-104">*Язык сценариев* — это язык программирования, который анализируется во время выполнения *обработчиком сценариев*, компонентом, который преобразует скрипты, написанные на этом языке, в машинный код.</span><span class="sxs-lookup"><span data-stu-id="bceb3-104">A *scripting language* is a programming language that is parsed at run time by a *scripting engine*, a component that translates scripts written in that language into machine code.</span></span> <span data-ttu-id="bceb3-105">Каждый обработчик сценариев преобразует конкретный язык сценариев.</span><span class="sxs-lookup"><span data-stu-id="bceb3-105">Each scripting engine translates a specific scripting language.</span></span> <span data-ttu-id="bceb3-106">*Сервер сценариев* — это приложение, например веб-браузер, в котором размещается обработчик скриптов для выполнения скриптов.</span><span class="sxs-lookup"><span data-stu-id="bceb3-106">A *scripting host* is an application, such as a Web browser, that hosts a scripting engine to run scripts.</span></span> <span data-ttu-id="bceb3-107">Если сервер скриптов поддерживает COM, можно написать скрипты, использующие COM-объекты.</span><span class="sxs-lookup"><span data-stu-id="bceb3-107">If your scripting host supports COM, you can write scripts that use COM objects.</span></span> <span data-ttu-id="bceb3-108">В следующих разделах описываются узлы сценариев, поддерживающие COM-объекты, общие языки сценариев и способы преобразования между языками сценариев.</span><span class="sxs-lookup"><span data-stu-id="bceb3-108">The following topics describe scripting hosts that support COM objects, common scripting languages, and how to translate between scripting languages.</span></span>

<span data-ttu-id="bceb3-109">Язык сценариев отличается от скомпилированного языка тем, что он преобразуется в машинный код во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bceb3-109">A scripting language differs from a compiled language in that it is translated into machine code at run time.</span></span> <span data-ttu-id="bceb3-110">Это означает, что каждый раз при выполнении скрипта обработчик сценариев сначала анализирует код, а затем запускает его.</span><span class="sxs-lookup"><span data-stu-id="bceb3-110">This means that each time you run a script, the scripting engine first parses the code and then runs it.</span></span> <span data-ttu-id="bceb3-111">В отличие от этого, скомпилированные языки, такие как C++, преобразуются в машинный код один раз во время компиляции.</span><span class="sxs-lookup"><span data-stu-id="bceb3-111">In contrast, compiled languages, such as C++, are translated to machine code once, during compilation.</span></span> <span data-ttu-id="bceb3-112">При запуске скомпилированного приложения операционная система просто запускает предварительно скомпилированный код.</span><span class="sxs-lookup"><span data-stu-id="bceb3-112">When you run a compiled application, the operating system simply runs the precompiled code.</span></span>

<span data-ttu-id="bceb3-113">Поскольку обработчик сценариев должен повторно анализировать сценарий при каждом его запуске, языки сценариев обычно выполняются медленнее и менее эффективно, чем их предкомпилированные аналоги.</span><span class="sxs-lookup"><span data-stu-id="bceb3-113">Because a scripting engine must reparse a script each time it runs, scripting languages are typically slower and less efficient than their precompiled counterparts.</span></span> <span data-ttu-id="bceb3-114">Тем не менее, преимущество сценариев заключается в простоте написания и обслуживания.</span><span class="sxs-lookup"><span data-stu-id="bceb3-114">The advantage of scripts, however, is they are easy to write and maintain.</span></span> <span data-ttu-id="bceb3-115">Языки сценариев обычно проще, чем предкомпилированные языки, и когда сценарий изменяется, его не нужно перекомпилировать.</span><span class="sxs-lookup"><span data-stu-id="bceb3-115">Scripting languages are usually simpler than precompiled languages, and when a script changes, it does not need to be recompiled.</span></span> <span data-ttu-id="bceb3-116">Для упрощенных и быстро меняющихся приложений, таких как веб-страницы, языки сценариев являются идеальным решением.</span><span class="sxs-lookup"><span data-stu-id="bceb3-116">For lightweight and rapidly changing applications, such as webpages, scripting languages are ideal.</span></span>

<span data-ttu-id="bceb3-117">Существует несколько сред размещения, в которых можно создавать сценарии, использующие COM-объекты, как описано ниже.</span><span class="sxs-lookup"><span data-stu-id="bceb3-117">There are several host environments in which you can write scripts that use COM objects, as described following:</span></span>

-   [<span data-ttu-id="bceb3-118">Внедрение объектов COM в веб-страницы</span><span class="sxs-lookup"><span data-stu-id="bceb3-118">Embedding COM Objects in Web Pages</span></span>](embedding-com-objects-in-web-pages.md)
-   [<span data-ttu-id="bceb3-119">Использование COM-объектов на страницах Active Server</span><span class="sxs-lookup"><span data-stu-id="bceb3-119">Using COM Objects in Active Server Pages</span></span>](using-com-objects-in-active-server-pages.md)
-   [<span data-ttu-id="bceb3-120">Использование COM-объектов в сервере сценариев Windows</span><span class="sxs-lookup"><span data-stu-id="bceb3-120">Using COM Objects in Windows Script Host</span></span>](using-com-objects-in-windows-script-host.md)
-   [<span data-ttu-id="bceb3-121">Создание скриптов для COM-объектов в пользовательских приложениях</span><span class="sxs-lookup"><span data-stu-id="bceb3-121">Scripting COM Objects in Custom Applications</span></span>](scripting-com-objects-in-custom-applications.md)

<span data-ttu-id="bceb3-122">В каждой из сред, упомянутых выше, обработчик скриптов анализирует и выполняет скрипт.</span><span class="sxs-lookup"><span data-stu-id="bceb3-122">In each of the host environments mentioned preceding, a scripting engine parses and runs the script.</span></span> <span data-ttu-id="bceb3-123">Так как подсистема для каждого языка сценариев является отдельным компонентом, можно добавить новый язык сценариев в среду, добавив новый механизм.</span><span class="sxs-lookup"><span data-stu-id="bceb3-123">Because the engine for each scripting language is a separate component, you can add a new scripting language to an environment by adding a new engine.</span></span>

<span data-ttu-id="bceb3-124">Ниже перечислены наиболее часто используемые языки сценариев.</span><span class="sxs-lookup"><span data-stu-id="bceb3-124">The most commonly used scripting languages are:</span></span>

-   <span data-ttu-id="bceb3-125">Microsoft Visual Basic Scripting Edition (VBScript) — подмножество Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="bceb3-125">Microsoft Visual Basic Scripting Edition (VBScript), a subset of Visual Basic.</span></span>
-   <span data-ttu-id="bceb3-126">JavaScript — язык сценариев Netscape, ранее известный как LiveScript.</span><span class="sxs-lookup"><span data-stu-id="bceb3-126">JavaScript, the Netscape scripting language, formerly known as LiveScript.</span></span>
-   <span data-ttu-id="bceb3-127">Программное обеспечение для разработки Microsoft JScript, реализация спецификации ECMA 262 на языке Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="bceb3-127">Microsoft JScript development software, the Microsoft implementation of the ECMA 262 language specification.</span></span>

<span data-ttu-id="bceb3-128">Корпорация Майкрософт предоставляет обработчики скриптов для JScript и VBScript.</span><span class="sxs-lookup"><span data-stu-id="bceb3-128">Microsoft provides scripting engines for JScript and VBScript.</span></span> <span data-ttu-id="bceb3-129">Другие производители программного обеспечения предоставляют обработчики скриптов ActiveX для таких языков, как Перлскрипт, Пскрипт, Python и др.</span><span class="sxs-lookup"><span data-stu-id="bceb3-129">Other software companies provide ActiveX scripting engines for languages such as PerlScript, PScript, Python, and others.</span></span>

<span data-ttu-id="bceb3-130">Дополнительные сведения см. в [спецификации языка ECMA 262](https://www.ecma-international.org/publications/standards/Ecma-262.htm).</span><span class="sxs-lookup"><span data-stu-id="bceb3-130">For more information see the [ECMA 262 language specification](https://www.ecma-international.org/publications/standards/Ecma-262.htm).</span></span>

<span data-ttu-id="bceb3-131">Обратите внимание, что большинство языков сценариев, таких как VBScript и JScript, не могут получать доступ к файлам и изменять их.</span><span class="sxs-lookup"><span data-stu-id="bceb3-131">Note that most scripting languages, such as VBScript and JScript, cannot access or modify files.</span></span> <span data-ttu-id="bceb3-132">Это не позволяет сценарию изменять данные на клиентских компьютерах.</span><span class="sxs-lookup"><span data-stu-id="bceb3-132">This inability prevents the script from altering data on client computers.</span></span> <span data-ttu-id="bceb3-133">Однако COM-объекты не имеют таких ограничений.</span><span class="sxs-lookup"><span data-stu-id="bceb3-133">COM objects, however, have no such limitations.</span></span> <span data-ttu-id="bceb3-134">После загрузки и установки на клиентских компьютерах они могут выполнять любые стандартные действия приложения.</span><span class="sxs-lookup"><span data-stu-id="bceb3-134">Once they are downloaded and installed on client computers, they can perform any standard application action.</span></span> <span data-ttu-id="bceb3-135">Таким же пользователям следует загружать и запускать элементы управления ActiveX только из надежных источников.</span><span class="sxs-lookup"><span data-stu-id="bceb3-135">Thus, users should only download and run ActiveX controls from trusted sources.</span></span>

<span data-ttu-id="bceb3-136">Сведения о преобразовании между языками сценариев см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="bceb3-136">For information on translating between scripting languages, see the following topics:</span></span>

-   [<span data-ttu-id="bceb3-137">Преобразование в VBScript</span><span class="sxs-lookup"><span data-stu-id="bceb3-137">Translating to VBScript</span></span>](translating-to-vbscript.md)
-   [<span data-ttu-id="bceb3-138">Преобразование в JScript</span><span class="sxs-lookup"><span data-stu-id="bceb3-138">Translating to JScript</span></span>](translating-to-jscript.md)
-   [<span data-ttu-id="bceb3-139">Преобразование в JavaScript</span><span class="sxs-lookup"><span data-stu-id="bceb3-139">Translating to JavaScript</span></span>](translating-to-javascript.md)

 

 




