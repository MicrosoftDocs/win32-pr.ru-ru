---
title: Составные моникеры
description: Одной из наиболее полезных функций моникеров является то, что вы можете объединить или составить моникеры.
ms.assetid: ea2453f3-7a64-4ce0-87c2-de6224ca71df
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5b5375bb505ff3737fb4e0cdea894790d93c0051
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103779811"
---
# <a name="composite-monikers"></a><span data-ttu-id="fd786-103">Составные моникеры</span><span class="sxs-lookup"><span data-stu-id="fd786-103">Composite Monikers</span></span>

<span data-ttu-id="fd786-104">Одной из наиболее полезных функций моникеров является то, что вы можете объединить или составить моникеры.</span><span class="sxs-lookup"><span data-stu-id="fd786-104">One of the most useful features of monikers is that you can concatenate or compose monikers together.</span></span> <span data-ttu-id="fd786-105">*Составной моникер* — это моникер, который является композицией других моникеров и может определять отношение между частями.</span><span class="sxs-lookup"><span data-stu-id="fd786-105">A *composite moniker* is a moniker that is a composition of other monikers and can determine the relation between the parts.</span></span> <span data-ttu-id="fd786-106">Это позволяет собрать полный путь к объекту, заданному двумя или более моникерами, эквивалентными частичным путям.</span><span class="sxs-lookup"><span data-stu-id="fd786-106">This lets you assemble the complete path to an object given two or more monikers that are the equivalent of partial paths.</span></span> <span data-ttu-id="fd786-107">Вы можете создать моникеры того же класса (например, два моникера файла) или различных классов (например, моникер файла и моникер элемента).</span><span class="sxs-lookup"><span data-stu-id="fd786-107">You can compose monikers of the same class (such as two file monikers) or of different classes (such as a file moniker and an item moniker).</span></span> <span data-ttu-id="fd786-108">Если вы написали собственный класс моникера, можно также составлять моникеры с моникерами файлов или элементов.</span><span class="sxs-lookup"><span data-stu-id="fd786-108">If you were to write your own moniker class, you could also compose your monikers with file or item monikers.</span></span> <span data-ttu-id="fd786-109">Основное преимущество составного подхода состоит в том, что он предоставляет один фрагмент кода для реализации любого возможного моникера, который представляет собой сочетание более простых моникеров.</span><span class="sxs-lookup"><span data-stu-id="fd786-109">The basic advantage of a composite is that it gives you one piece of code to implement every possible moniker that is a combination of simpler monikers.</span></span> <span data-ttu-id="fd786-110">Это значительно сокращает потребность в конкретных пользовательских классах моникера.</span><span class="sxs-lookup"><span data-stu-id="fd786-110">That significantly reduces the need for specific custom moniker classes.</span></span>

<span data-ttu-id="fd786-111">Поскольку моникеры различных классов могут состоять друг с другом, моникеры предоставляют возможность объединения нескольких пространств имен.</span><span class="sxs-lookup"><span data-stu-id="fd786-111">Because monikers of different classes can be composed with one another, monikers provide the ability to join multiple namespaces.</span></span> <span data-ttu-id="fd786-112">Файловая система определяет общее пространство имен для объектов, хранящихся в виде файлов, так как все приложения понимают имя пути файловой системы.</span><span class="sxs-lookup"><span data-stu-id="fd786-112">The file system defines a common namespace for objects stored as files because all applications understand a file system path name.</span></span> <span data-ttu-id="fd786-113">Аналогичным образом объект-контейнер также определяет частное пространство имен для содержащихся в нем объектов, так как ни один контейнер не понимает имена, созданные другим контейнером.</span><span class="sxs-lookup"><span data-stu-id="fd786-113">Similarly, a container object also defines a private namespace for the objects that it contains because no container understands the names generated by another container.</span></span> <span data-ttu-id="fd786-114">Моникеры позволяют объединять эти пространства имен, поскольку могут составляться моникеры и моникеры элементов.</span><span class="sxs-lookup"><span data-stu-id="fd786-114">Monikers allow these namespaces to be joined because file monikers and item monikers can be composed.</span></span> <span data-ttu-id="fd786-115">Клиент моникера может выполнять поиск по пространству имен для всех объектов с помощью одного механизма.</span><span class="sxs-lookup"><span data-stu-id="fd786-115">A moniker client can search the namespace for all objects using a single mechanism.</span></span> <span data-ttu-id="fd786-116">Клиент просто вызывает [**IMoniker:: биндтубжект**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) в моникере, а код моникера обрабатывает остальное.</span><span class="sxs-lookup"><span data-stu-id="fd786-116">The client simply calls [**IMoniker::BindToObject**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) on the moniker, and the moniker code handles the rest.</span></span> <span data-ttu-id="fd786-117">Вызов [**IMoniker::**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-getdisplayname) lt для составного объекта создает имя, используя объединение всех отображаемых имен отдельных моникеров.</span><span class="sxs-lookup"><span data-stu-id="fd786-117">A call to [**IMoniker::GetDisplayName**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-getdisplayname) on a composite creates a name using the concatenation of all the individual monikers' display names.</span></span>

<span data-ttu-id="fd786-118">Более того, поскольку можно написать собственный класс моникера, композиция моникера позволяет добавлять пользовательские расширения в пространство имен для объектов.</span><span class="sxs-lookup"><span data-stu-id="fd786-118">Furthermore, because you can write your own moniker class, moniker composition allows you to add customized extensions to the namespace for objects.</span></span>

<span data-ttu-id="fd786-119">Иногда два моникера конкретных классов можно комбинировать особым образом.</span><span class="sxs-lookup"><span data-stu-id="fd786-119">Sometimes two monikers of specific classes can be combined in a special way.</span></span> <span data-ttu-id="fd786-120">Например, моникер файла, представляющий неполный путь, и другой моникер файла, представляющий относительный путь, можно объединить, чтобы сформировать один моникер файла, представляющий полный путь.</span><span class="sxs-lookup"><span data-stu-id="fd786-120">For example, a file moniker representing an incomplete path and another file moniker representing a relative path can be combined to form a single file moniker representing the complete path.</span></span> <span data-ttu-id="fd786-121">Например, моникеры файла "c: \\ Рабочая \\ графика" могут состоять из относительного моникера файла ".. \\ Backup \\myfile.doc "равно" c: \\ Рабочая \\ Архивация \\myfile.doc ".</span><span class="sxs-lookup"><span data-stu-id="fd786-121">For example, the file monikers "c:\\work\\art" could be composed with the relative file moniker "..\\backup\\myfile.doc" to equal "c:\\work\\backup\\myfile.doc".</span></span> <span data-ttu-id="fd786-122">Это пример *неуниверсальной композиции*.</span><span class="sxs-lookup"><span data-stu-id="fd786-122">This is an example of *nongeneric composition*.</span></span>

<span data-ttu-id="fd786-123">*Универсальная композиция*, с другой стороны, разрешает подключение любых двух моникеров независимо от их классов.</span><span class="sxs-lookup"><span data-stu-id="fd786-123">*Generic composition*, on the other hand, permits the connection of any two monikers, no matter what their classes.</span></span> <span data-ttu-id="fd786-124">Например, можно создать моникер элемента в моникере файла, но не наоборот, в других случаях.</span><span class="sxs-lookup"><span data-stu-id="fd786-124">For example, you could compose an item moniker onto a file moniker, although not, of course, the other way around.</span></span>

<span data-ttu-id="fd786-125">Поскольку неуниверсальная композиция зависит от класса используемых моникеров, его сведения определяются реализацией конкретного класса моникера.</span><span class="sxs-lookup"><span data-stu-id="fd786-125">Because a nongeneric composition depends on the class of the monikers involved, its details are defined by the implementation of a particular moniker class.</span></span> <span data-ttu-id="fd786-126">При написании нового класса моникера можно определить новые типы неуниверсальных композиций.</span><span class="sxs-lookup"><span data-stu-id="fd786-126">You can define new types of nongeneric compositions if you write a new moniker class.</span></span> <span data-ttu-id="fd786-127">Универсальные композиции, напротив, определяются OLE.</span><span class="sxs-lookup"><span data-stu-id="fd786-127">By contrast, generic compositions are defined by OLE.</span></span> <span data-ttu-id="fd786-128">Моникеры, созданные в результате универсальной композиции, называются универсальными составными моникерами.</span><span class="sxs-lookup"><span data-stu-id="fd786-128">Monikers created as a result of generic composition are called generic composite monikers.</span></span>

<span data-ttu-id="fd786-129">Эти три класса, моникеры файлов, моникеры элементов и универсальные составные моникеры, все работают вместе и являются наиболее часто используемыми классами моникеров.</span><span class="sxs-lookup"><span data-stu-id="fd786-129">These three classes, file monikers, item monikers, and generic composite monikers, all work together, and they are the most commonly used classes of monikers.</span></span>

<span data-ttu-id="fd786-130">Клиенты моникера должны вызывать [**IMoniker:: компосевис**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-composewith) , чтобы создать составной объект с другим именем.</span><span class="sxs-lookup"><span data-stu-id="fd786-130">Moniker clients should call [**IMoniker::ComposeWith**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-composewith) to create a composite on moniker with another.</span></span> <span data-ttu-id="fd786-131">Моникер, который вызывается внутренним образом, определяет, может ли он выполнять универсальную или неуниверсальную композицию.</span><span class="sxs-lookup"><span data-stu-id="fd786-131">The moniker it is called on internally decides whether it can do a generic or nongeneric composition.</span></span> <span data-ttu-id="fd786-132">Если реализация моникера определяет, что универсальная композиция может использоваться, OLE предоставляет функцию [**креатеженериккомпосите**](/windows/desktop/api/Objbase/nf-objbase-creategenericcomposite) для упрощения этого.</span><span class="sxs-lookup"><span data-stu-id="fd786-132">If the moniker implementation determines that a generic composition is usable, OLE provides the [**CreateGenericComposite**](/windows/desktop/api/Objbase/nf-objbase-creategenericcomposite) function to facilitate this.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fd786-133">См. также</span><span class="sxs-lookup"><span data-stu-id="fd786-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fd786-134">Специальные имена</span><span class="sxs-lookup"><span data-stu-id="fd786-134">Anti-Monikers</span></span>](anti-monikers.md)
</dt> <dt>

[<span data-ttu-id="fd786-135">Моникеры класса</span><span class="sxs-lookup"><span data-stu-id="fd786-135">Class Monikers</span></span>](class-monikers.md)
</dt> <dt>

[<span data-ttu-id="fd786-136">Моникеры файлов</span><span class="sxs-lookup"><span data-stu-id="fd786-136">File Monikers</span></span>](file-monikers.md)
</dt> <dt>

[<span data-ttu-id="fd786-137">Моникеры элементов</span><span class="sxs-lookup"><span data-stu-id="fd786-137">Item Monikers</span></span>](item-monikers.md)
</dt> <dt>

[<span data-ttu-id="fd786-138">Моникеры указателей</span><span class="sxs-lookup"><span data-stu-id="fd786-138">Pointer Monikers</span></span>](pointer-monikers.md)
</dt> </dl>

 

 




