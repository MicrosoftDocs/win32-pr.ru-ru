---
title: Интерфейсы Передача данных
description: Интерфейсы Передача данных
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105710373"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="25607-103">Интерфейсы Передача данных</span><span class="sxs-lookup"><span data-stu-id="25607-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="25607-104">Интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) предоставляет потребителям данных методы для получения и установки данных объекта, определения форматов, поддерживаемых объектом, и регистрации и получения уведомлений при изменении данных в объекте.</span><span class="sxs-lookup"><span data-stu-id="25607-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="25607-105">При получении данных вызывающий объект может указать формат, в котором они хотят визуализировать данные.</span><span class="sxs-lookup"><span data-stu-id="25607-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="25607-106">Однако источник данных определяет среду хранения, которая возвращается в параметре out, предоставленном вызывающим объектом.</span><span class="sxs-lookup"><span data-stu-id="25607-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="25607-107">По себе, интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) предоставляет все средства, необходимые для реализации передачи буфера обмена Windows или передачи составных документов в приложениях.</span><span class="sxs-lookup"><span data-stu-id="25607-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="25607-108">Если также требуется поддержка перетаскивания, необходимо реализовать интерфейсы [**идропсаурце**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) и [**интерфейс IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) вместе с интерфейсом **IDataObject**.</span><span class="sxs-lookup"><span data-stu-id="25607-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="25607-109">Интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , объединенный с API-интерфейсами буфера обмена OLE, предоставляет все возможности интерфейсов API буфера обмена Windows.</span><span class="sxs-lookup"><span data-stu-id="25607-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="25607-110">Обычно не требуется использовать оба интерфейса API буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="25607-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="25607-111">Поставщики данных, поддерживающие операции перетаскивания или составные документы OLE, должны реализовать интерфейс **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="25607-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="25607-112">Если приложение поддерживает только переносы в буфер обмена, но вы собираетесь добавлять и удалять или составные документы в более поздних выпусках, вам может потребоваться реализовать интерфейс **IDataObject** и API-интерфейсы буфера обмена OLE, чтобы свести к минимальному количеству времени, затрачиваемого на перекодирование и последующий процесс отладки.</span><span class="sxs-lookup"><span data-stu-id="25607-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="25607-113">Также можно реализовать интерфейс **IDataObject** , чтобы использовать носитель для передачи, отличный от глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="25607-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="25607-114">В следующей таблице приводятся сводные сведения о том, какие из них следует использовать, в зависимости от типов данных, которые требуется поддерживать.</span><span class="sxs-lookup"><span data-stu-id="25607-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="25607-115">Для поддержки</span><span class="sxs-lookup"><span data-stu-id="25607-115">To support</span></span>                                                                       | <span data-ttu-id="25607-116">Использовать</span><span class="sxs-lookup"><span data-stu-id="25607-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="25607-117">Составные документы</span><span class="sxs-lookup"><span data-stu-id="25607-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="25607-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="25607-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="25607-119">Перетаскивание передач</span><span class="sxs-lookup"><span data-stu-id="25607-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="25607-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**идропсаурце**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**интерфейс IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (или эквивалент)</span><span class="sxs-lookup"><span data-stu-id="25607-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="25607-121">Передача из буфера обмена с монопольным использованием глобальной памяти</span><span class="sxs-lookup"><span data-stu-id="25607-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="25607-122">API буфера обмена</span><span class="sxs-lookup"><span data-stu-id="25607-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="25607-123">Передача из буфера обмена с использованием носителей Exchange, отличных от глобальной памяти.</span><span class="sxs-lookup"><span data-stu-id="25607-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="25607-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="25607-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="25607-125">Буфер обмена переносится сейчас, но перетаскивание или составные документы появятся позже</span><span class="sxs-lookup"><span data-stu-id="25607-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="25607-126">Интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) и указанные выше интерфейсы и функции для "перетаскивания передач"</span><span class="sxs-lookup"><span data-stu-id="25607-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="25607-127">Когда пользователь инициирует операцию обмена данными, исходное приложение создает экземпляр [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) и делает данные доступными в одном или нескольких форматах.</span><span class="sxs-lookup"><span data-stu-id="25607-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="25607-128">При передаче в буфер обмена приложение вызывает функцию [**олесетклипбоард**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) , чтобы передать указатель на объект данных в OLE.</span><span class="sxs-lookup"><span data-stu-id="25607-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="25607-129">(**Олесетклипбоард** также предлагает стандартные форматы данных буфера обмена для приложений OLE версии 1 и не OLE.) При перемещении перетаскивания приложение вызывает функцию [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) .</span><span class="sxs-lookup"><span data-stu-id="25607-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="25607-130">На принимающей стороне переноса назначение получает указатель [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) либо в качестве аргумента для вызова [**интерфейс IDropTarget::D верхнем**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) , либо путем вызова функции [**олесетклипбоард**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) в зависимости от способа перемещения — с помощью перетаскивания или буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="25607-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="25607-131">Получая этот указатель, назначение вызывает [**IDataObject:: енумформатетк**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) , чтобы узнать, какие форматы доступны для извлечения и для каких типов носителей они могут быть получены.</span><span class="sxs-lookup"><span data-stu-id="25607-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="25607-132">Получив эти сведения, получающее приложение запрашивает данные с помощью вызова функции [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span><span class="sxs-lookup"><span data-stu-id="25607-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="25607-133">См. также</span><span class="sxs-lookup"><span data-stu-id="25607-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="25607-134">Передача данных</span><span class="sxs-lookup"><span data-stu-id="25607-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

