---
title: Общий согласование безопасности
description: Общий согласование безопасности
ms.assetid: 5a01912d-611c-4a6e-ab9d-0243cba331f1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e51407de908eaaf0f79eea452046f8e424ccf900
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070695"
---
# <a name="security-blanket-negotiation"></a><span data-ttu-id="93fc1-103">Общий согласование безопасности</span><span class="sxs-lookup"><span data-stu-id="93fc1-103">Security Blanket Negotiation</span></span>

<span data-ttu-id="93fc1-104">Контракт безопасности — это группа значений, описывающих параметры безопасности, которые применяются ко всем учетным записям-посредникам в процессе или только к определенному прокси интерфейса.</span><span class="sxs-lookup"><span data-stu-id="93fc1-104">A security blanket is a group of values that describe the security settings that apply to all proxies in a process or to just a particular interface proxy.</span></span> <span data-ttu-id="93fc1-105">Общий уровень безопасности состоит из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="93fc1-105">A security blanket comprises the following values:</span></span>

-   <span data-ttu-id="93fc1-106">Служба проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="93fc1-106">Authentication service</span></span>
-   <span data-ttu-id="93fc1-107">Служба авторизации</span><span class="sxs-lookup"><span data-stu-id="93fc1-107">Authorization service</span></span>
-   <span data-ttu-id="93fc1-108">Имя участника</span><span class="sxs-lookup"><span data-stu-id="93fc1-108">Principal name</span></span>
-   <span data-ttu-id="93fc1-109">Уровень проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="93fc1-109">Authentication level</span></span>
-   <span data-ttu-id="93fc1-110">Уровень олицетворения</span><span class="sxs-lookup"><span data-stu-id="93fc1-110">Impersonation level</span></span>
-   <span data-ttu-id="93fc1-111">Удостоверение проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="93fc1-111">Authentication identity</span></span>
-   <span data-ttu-id="93fc1-112">Возможности</span><span class="sxs-lookup"><span data-stu-id="93fc1-112">Capabilities</span></span>
-   <span data-ttu-id="93fc1-113">Список управления доступом (ACL) (только серверы)</span><span class="sxs-lookup"><span data-stu-id="93fc1-113">An access control list (ACL) (servers only)</span></span>

<span data-ttu-id="93fc1-114">Безопасность — это процесс, используемый COM для выбора параметров безопасности прокси-сервера при его создании.</span><span class="sxs-lookup"><span data-stu-id="93fc1-114">Security blanket negotiation is the process that COM uses to choose the security settings for a proxy when it is created.</span></span> <span data-ttu-id="93fc1-115">Этот процесс подразумевает сравнение безопасности сервера, относящегося к безопасности клиента, и использование этих значений для создания соответствующей безопасности по умолчанию, применяемой для прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="93fc1-115">This process involves comparing the server's security blanket with the client's security blanket and using those values to create an appropriate default security blanket for the proxy.</span></span> <span data-ttu-id="93fc1-116">В следующих параграфах объясняется, откуда берутся контракты безопасности клиента и сервера, а также описывается, как COM согласовывает безопасность, характерную для прокси-сервера, с помощью контракта безопасности клиента и сервера.</span><span class="sxs-lookup"><span data-stu-id="93fc1-116">The following paragraphs explain where the client's and the server's security blankets come from and describe how COM negotiates the security blanket for the proxy using the client's and server's security blankets.</span></span>

<span data-ttu-id="93fc1-117">Клиент и сервер могут вызывать [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) , чтобы указать их соответствующие методы обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="93fc1-117">The client and the server can each call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to specify their respective security blankets.</span></span> <span data-ttu-id="93fc1-118">Если приложение не вызывает **CoInitializeSecurity** явным образом, COM вызывает его неявно для приложения, используя соответствующие значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="93fc1-118">If an application doesn't call **CoInitializeSecurity** explicitly, COM calls it implicitly for the application, using appropriate default values.</span></span> <span data-ttu-id="93fc1-119">Дополнительные сведения об этих значениях по умолчанию см. в разделе [Параметры безопасности COM по умолчанию](com-security-defaults.md).</span><span class="sxs-lookup"><span data-stu-id="93fc1-119">For more information about these default values, see [COM Security Defaults](com-security-defaults.md).</span></span>

<span data-ttu-id="93fc1-120">Некоторые параметры для [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) применяются, когда приложение является сервером, а некоторые применяются, когда приложение является клиентом.</span><span class="sxs-lookup"><span data-stu-id="93fc1-120">Some parameters to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) apply when the application is a server, and some apply when the application is a client.</span></span> <span data-ttu-id="93fc1-121">Если приложение выступает в роли сервера, эти параметры имеют отношение к ACL, списку кортежей службы проверки подлинности или имени участника и уровню проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="93fc1-121">When the application is acting as a server, these parameters are relevant: an ACL, a list of authentication service/authorization service/principal name tuples, and an authentication level.</span></span> <span data-ttu-id="93fc1-122">Вызов сервера **CoInitializeSecurity**, независимо от того, является ли он явным или неявным, определяет безопасность сервера, который остается фиксированным.</span><span class="sxs-lookup"><span data-stu-id="93fc1-122">A server's call to **CoInitializeSecurity**, whether implicit or explicit, determines the server's security blanket, which remains fixed.</span></span>

<span data-ttu-id="93fc1-123">Когда приложение выступает в роли клиента, важны следующие значения, передаваемые в [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) : уровень проверки подлинности, уровень олицетворения, удостоверение проверки подлинности и возможности.</span><span class="sxs-lookup"><span data-stu-id="93fc1-123">When the application is acting as a client, the following values passed to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) are relevant: an authentication level, an impersonation level, the authentication identity, and capabilities.</span></span> <span data-ttu-id="93fc1-124">Неявный или явный вызов **CoInitializeSecurity** указывает на безопасность, которую хочет клиент.</span><span class="sxs-lookup"><span data-stu-id="93fc1-124">A client's implicit or explicit call to **CoInitializeSecurity** indicates the security blanket that the client wants.</span></span>

<span data-ttu-id="93fc1-125">При создании прокси-сервера модель COM использует значения, заданные в параметрах безопасности сервера "общий" и "Клиентская безопасность", для согласования параметров безопасности по умолчанию, подходящих для прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="93fc1-125">When a proxy is created, COM uses the values specified by the server's security blanket and the client's security blanket to negotiate a default security blanket that is appropriate for the proxy.</span></span> <span data-ttu-id="93fc1-126">COM выбирает службу проверки подлинности, которая работает как на клиенте, так и на сервере.</span><span class="sxs-lookup"><span data-stu-id="93fc1-126">COM picks an authentication service that works on both the client and server.</span></span> <span data-ttu-id="93fc1-127">Служба авторизации и имя участника выбираются для работы со службой проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="93fc1-127">The authorization service and principal name are chosen to work with the authentication service.</span></span> <span data-ttu-id="93fc1-128">Для уровня проверки подлинности COM выбирает выше уровни проверки подлинности, заданные клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="93fc1-128">For the authentication level, COM chooses the higher of the authentication levels specified by the client and the server.</span></span> <span data-ttu-id="93fc1-129">Уровень олицетворения и возможности, выбранные моделью COM, задаются клиентом.</span><span class="sxs-lookup"><span data-stu-id="93fc1-129">The impersonation level and the capabilities chosen by COM are the ones specified by the client.</span></span> <span data-ttu-id="93fc1-130">Удостоверение проверки подлинности указывается клиентом для выбранной службы проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="93fc1-130">The authentication identity is the one specified by the client for the chosen authentication service.</span></span>

<span data-ttu-id="93fc1-131">После того как общий уровень безопасности по умолчанию будет вычислен, его значения будут назначены вновь созданному прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="93fc1-131">Once the default security blanket has been computed, its values are assigned to the newly created proxy.</span></span> <span data-ttu-id="93fc1-132">Клиент может переопределить параметры безопасности для прокси-сервера, вызвав [**иклиентсекурити:: сетбланкет**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket).</span><span class="sxs-lookup"><span data-stu-id="93fc1-132">The client can override the security settings for the proxy by calling [**IClientSecurity::SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket).</span></span> <span data-ttu-id="93fc1-133">Значения, указанные для **сетбланкет** , не согласовываются. они просто назначаются указанному прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="93fc1-133">The values specified to **SetBlanket** are not negotiated; they are simply assigned to the specified proxy.</span></span> <span data-ttu-id="93fc1-134">Однако, если параметры по умолчанию (такие как RPC \_ C \_ \_ \_ по умолчанию) передаются в **сетбланкет**, com использует ранее описанный алгоритм согласования безопасности контракта для расчета параметров по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="93fc1-134">However, if default parameters (such as RPC\_C\_IMP\_LEVEL\_DEFAULT) are passed to **SetBlanket**, COM uses the previously described security blanket negotiation algorithm to compute the default parameters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="93fc1-135">См. также</span><span class="sxs-lookup"><span data-stu-id="93fc1-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="93fc1-136">Безопасность в COM</span><span class="sxs-lookup"><span data-stu-id="93fc1-136">Security in COM</span></span>](security-in-com.md)
</dt> </dl>

 

 