---
title: Поддержка интерфейса означает
description: Поддержка интерфейса означает
ms.assetid: fa5eae0f-2252-43bc-b504-de00b213cb2a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 13587bd5ff6391691c0f6bf6e38b59be019dfdb6
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2021
ms.locfileid: "110549059"
---
# <a name="what-support-for-an-interface-means"></a>Поддержка интерфейса означает

Помимо интерфейса [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , элемент управления ActiveX или COM-объект для этого имеет значение, предопределяющее любые дополнительные функции, которые она поддерживает, через дополнительные интерфейсы. Это означает, что для интерфейса **IUnknown** не требуются никакие другие интерфейсы. В следующей таблице перечислены интерфейсы, которые может поддерживать элемент управления ActiveX, и что это означает для поддержки этого интерфейса.



| Интерфейс                                                                                                                                                                                                                                                                                                                                                                       | Комментарии/что означает поддержка интерфейса                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                                                                                                                                                                                                                                                                                     | Если элементу управления требуется обмен данными с его клиентским сайтом для любого другого, кроме событий (см. [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)), то [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) является обязательной. При реализации этого интерфейса элемент управления также должен поддерживать семантику следующих методов: [**сесостнамес**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-sethostnames), [**Close**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-close), [**енумвербс**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumverbs), [**Update**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-update), [**Исуптодате**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-isuptodate), [**жетусерклассид**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getuserclassid), [**жетусертипе**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getusertype), [**жетмискстатус**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus)и методы [**advise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-advise), [**unadvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-unadvise)и [**енумадвисе**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumadvise) , которые работают совместно с реализацией [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) контейнера. Элемент управления, реализующий **иолеобжект** , должен иметь возможность обрабатывать **иадвисесинк** , если контейнер предоставляет его. контейнер может не быть, в этом случае элемент управления гарантирует, что он не пытается вызвать несуществующий приемник.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**иолеинплацеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                                                                                                                                                                                                                                                                                       | Выражает возможность активации элемента управления на месте и, возможно, включения пользовательского интерфейса. Этот интерфейс означает, что элемент управления имеет пользовательский интерфейс какого-либо типа, который можно активировать, и [**метода IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject) также поддерживается. Обязательные методы [**—**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow) [**инплацедеактивате**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-inplacedeactivate), [**уидеактивате**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-uideactivate), [**сетобжектректс**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects)и [**реактиватеандундо**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo). Поддержка этого интерфейса требует поддержки [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**Метода IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)<br/>                                                                                                                                                                                                                                                                                                           | Объект с поддержкой на месте, поддерживающий [**иолеинплацеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject) , также должен предоставлять этот интерфейс, хотя сам элемент управления не обязательно реализует интерфейс напрямую.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**Метод интерфейса IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                                                                                                                                                                                                                                                                                   | Выражает возможность элемента управления и желание работать с назначенными (a) символами (a) ([**жетконтролинфо**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo) [**), (**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) b) внешними свойствами ([**онамбиентпропертичанже**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)) и (или) событиями, которые элемент управления требует, чтобы контейнер обрабатывал ([**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)). Обратите внимание, что назначенные клавиши отличаются от ускорителей, которые обрабатываются через [**метода IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject): назначенные клавиши имеют связанный пользовательский интерфейс и активны даже тогда, когда элемент управления не активен в пользовательском интерфейсе. Поддержка назначенных клавишами элемента управления означает, что элемент управления также знает, как использовать метод [**IOleControlSite:: онконтролинфочанжед**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) контейнера. Так как для этого требуется, чтобы элемент управления знал сайт контейнера, поддержка назначенных клавиш также означает поддержку [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject). Кроме того, знание назначенных клавиш требует поддержки на месте и, таким же, [**иолеинплацеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).<br/> Если элемент управления использует свойства внешнего окружения, он должен также реализовать этот интерфейс для получения уведомлений об изменениях, как в случае, когда требуется семантика изменений. Поскольку свойства окружения доступны только через интерфейс **IDispatch** сайта контейнера, поддержка внешнего свойства означает, что элемент управления поддерживает [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) (для получения сайта), а также может формировать вызовы **IDispatch:: Invoke** .<br/> Метод [**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) необходим для элементов управления, которые должны быть уверены в том, что контейнер не будет обработано событие. это единственный способ контролировать это условие. Если **FreezeEvents** требуется только в изоляции, так что другие методы [**метод интерфейса IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol) не реализованы, **метод интерфейса IOleControl** может быть изолирован без [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) или [**иолеинплацеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).<br/> |
| [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                                                                                                                                                                                                                                   | Указывает, что элемент управления может предоставить как минимум графический рендеринг (a) графического элемента управления (CF \_ метафилепикт — это минимум, если у элемента управления есть любые визуальные элементы или свойства (b), если у элемента управления есть какие-либо свойства для предоставления. Методы [**GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata), [**куерижетдата**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-querygetdata), [**енумформатетк**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), [**дадвисе**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**дунадвисе**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)и [**енумдадвисе**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) являются обязательными. Поддержка графических форматов, отличных от CF \_ метафилепикт, является необязательной.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                                                                                                                                                                                                                                                                                 | Указывает, что элемент управления имеет несколько интересных визуальных элементов, когда он не активен. Если реализуется, элемент управления должен поддерживать методы [**Draw**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-draw), [**advise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getadvise), [**сетадвисе**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-setadvise)и- [**экстент**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **IDispatch**<br/>                                                                                                                                                                                                                                                                                                                                                        | Указывает, что элемент управления имеет либо (a) пользовательские методы, либо (б) пользовательские свойства, которые доступны с помощью позднего связывания через **IDispatch:: Invoke**. Это также требует, чтобы элемент управления предоставляет сведения о типах с помощью других методов **IDispatch** . Элемент управления может поддерживать несколько реализаций **IDispatch** , в которых только один связан с IID \_ IDispatch. другие должны иметь собственные уникальные идентификаторы интерфейса.<br/> Элемент управления рекомендуется предоставлять сдвоенные интерфейсы для доступа к пользовательским методам и свойствам, но это необязательно, если существуют методы и свойства.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                                                                                                                                                                                                                                                                                       | Указывает, что элемент управления поддерживает по крайней мере один исходящий интерфейс, например события или уведомления об изменении свойств. Все методы этого интерфейса должны быть реализованы, если этот интерфейс доступен вообще, включая [**енумконнектионпоинтс**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints) , для которого требуется отдельный объект с [**иенумконнектионпоинтс**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints).<br/> Поддержка [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) означает, что объект также поддерживает один или несколько связанных объектов с помощью метода [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) , доступных через методы **IConnectionPointContainer** . Каждый объект точки подключения должен реализовывать полный интерфейс **IConnectionPoint** , включая [**енумконнектионс**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections), для которого требуется другой объект перечислителя с интерфейсом [**иенумконнектионс**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/>                                                                                                                                                                                                                                                           | Указывает, что объект может предоставлять свои собственные сведения о типе coclass непосредственно через [**IProvideClassInfo:: жетклассинфо**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo-getclassinfo). Если элемент управления поддерживает более поздний вариант [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2), он также указывает, что его способность предоставлять идентификатор IID основного источника через [**IProvideClassInfo2::**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo2-getguid). Все методы этого интерфейса должны быть реализованы.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**испеЦифипропертипажес**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                                                                                                                                                                                                                                                                               | Указывает, что у элемента управления есть страницы свойств, которые могут отображаться таким, что контейнер может координировать страницы свойств этого элемента управления с помощью страниц других элементов управления, когда страницы свойств должны отображаться для выбора нескольких элементов управления. При наличии поддержки должны быть реализованы все методы этого интерфейса.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**иперпропертибровсинг**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                                                                                                                                                                                                                                                                                 | Указывает, что возможность элемента управления (a) предоставляет отображаемую строку для свойства, (б) предопределенные строки и значения свойств и (или) (c) сопоставляют свойство DISPID с определенной страницей свойств. Поддержка этого интерфейса означает, что предоставляется поддержка свойств через IDispatch, как указано выше. Если поддерживается (c), это также означает, что страницы свойств объекта, сопоставленные через [**иперпропертибровсинг:: маппропертитопаже**](/windows/desktop/api/OCIdl/nf-ocidl-iperpropertybrowsing-mappropertytopage) , реализуют [**IPropertyPage2**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage2) в отличие от базового интерфейса [**ипропертипаже**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage) .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream)<br/> [**иперсистстреаминит**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit)<br/> [**иперсистмемори**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))<br/> [**иперсистстораже**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/> [**иперсистмоникер**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))<br/> [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag)<br/> | См. раздел [интерфейсы сохраняемости](persistence-interfaces.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**иолекаче**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                                                                                                                                                                                                                                                                           | Указывает поддержку кэширования контейнера визуальных элементов управления. Обычно элемент управления получает поддержку кэширования через функцию OLE [**креатедатакаче**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache). Только элементы управления со значимым статическим содержимым должны выбрать это действие (хотя это не обязательно). Если элемент управления поддерживает кэширование, он должен просто агрегировать кэш данных и предоставить интерфейсы [**иолекаче**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) и [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) из кэша данных. Элемент управления, реализующий [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) , должен иметь возможность обрабатывать [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) , если контейнер предоставляет его. контейнер может не быть, в этом случае элемент управления гарантирует, что он не пытается вызвать несуществующий приемник.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**иекстерналконнектион**](/windows/win32/api/objidlbase/nn-objidlbase-iexternalconnection)<br/>                                                                                                                                                                                                                                                                                                                   | Указывает, что элемент управления поддерживает внешние ссылки на себя; Это значит, что элемент управления не помечен ОЛЕМИСК \_ кантлинкинсиде и поддерживает [**иолеобжект:: Сетмоникер**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker) и [**Иолеобжект::-моникер**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker). Контейнер никогда не будет запрашивать этот интерфейс и вызывать его напрямую, так как вызовы формируются из слоя удаленного взаимодействия OLE.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**ируннаблеобжект**](/windows/desktop/api/ObjIdl/nn-objidl-irunnableobject)<br/>                                                                                                                                                                                                                                                                                                                           | Указывает, что элемент управления различает загрузку, так как в некоторых процессах выполняются объекты.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Элементы управления](controls.md)
</dt> </dl>

 

