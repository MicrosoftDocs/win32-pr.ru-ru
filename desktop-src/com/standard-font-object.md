---
title: Объект стандартного шрифта
description: Объект стандартного шрифта
ms.assetid: f9b54dc4-24d4-4eb7-b43f-c481d64e52df
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd0fbe2509dd85c1d15b40dc8008dba60d948b5c
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070658"
---
# <a name="standard-font-object"></a><span data-ttu-id="79d25-103">Объект стандартного шрифта</span><span class="sxs-lookup"><span data-stu-id="79d25-103">Standard Font Object</span></span>

<span data-ttu-id="79d25-104">Стандартное свойство шрифта окружения, предоставляемое контейнером, и стандартное свойство Font, предоставляемое элементом управления, предоставляют стандартный объект Font.</span><span class="sxs-lookup"><span data-stu-id="79d25-104">The standard ambient font property supplied by the container and the standard font property supplied by the control both provide a standard font object.</span></span> <span data-ttu-id="79d25-105">То есть эти стандартные шрифты предоставляют указатель **IDispatch** на объект стандартного шрифта.</span><span class="sxs-lookup"><span data-stu-id="79d25-105">That is, these standard fonts supply an **IDispatch** pointer to a standard font object.</span></span>

<span data-ttu-id="79d25-106">Объект Font — это предоставляемая системой реализация набора интерфейсов на основе базовой поддержки шрифтов GDI.</span><span class="sxs-lookup"><span data-stu-id="79d25-106">The font object is a system-provided implementation of a set of interfaces on top of the underlying GDI font support.</span></span> <span data-ttu-id="79d25-107">Объект Font создается с помощью функции API [**олекреатефонтиндирект**](/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect) , заданной структурой [**фонтдеск**](/windows/win32/api/olectl/ns-olectl-fontdesc) .</span><span class="sxs-lookup"><span data-stu-id="79d25-107">A font object is created through the API function [**OleCreateFontIndirect**](/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect) given a [**FONTDESC**](/windows/win32/api/olectl/ns-olectl-fontdesc) structure.</span></span> <span data-ttu-id="79d25-108">Объект Font поддерживает ряд свойств для чтения и записи, а также пользовательских методов через его интерфейс [**IFont**](/windows/desktop/api/OCIdl/nn-ocidl-ifont)и поддерживает тот же набор свойств (но не методов) через disp-интерфейс [**IFontDisp**](/windows/win32/api/ocidl/nn-ocidl-ifontdisp).</span><span class="sxs-lookup"><span data-stu-id="79d25-108">The font object supports a number of read/write properties as well as custom methods through its interface [**IFont**](/windows/desktop/api/OCIdl/nn-ocidl-ifont), and supports the same set of properties (but not the methods) through a dispinterface [**IFontDisp**](/windows/win32/api/ocidl/nn-ocidl-ifontdisp).</span></span> <span data-ttu-id="79d25-109">Диспетчерский интерфейс используется для свойств шрифта, упомянутых ранее.</span><span class="sxs-lookup"><span data-stu-id="79d25-109">The dispinterface is used for the font properties mentioned previously.</span></span> <span data-ttu-id="79d25-110">Свойства соответствуют атрибутам шрифта GDI, описанным в структуре [**LOGFONT**](/windows/win32/api/dimm/ns-dimm-logfonta) .</span><span class="sxs-lookup"><span data-stu-id="79d25-110">The properties correspond to the GDI font attributes that are described in the [**LOGFONT**](/windows/win32/api/dimm/ns-dimm-logfonta) structure.</span></span>

<span data-ttu-id="79d25-111">Объект Font также поддерживает исходящий интерфейс [**ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) , чтобы клиент мог определить, когда изменяются свойства шрифта.</span><span class="sxs-lookup"><span data-stu-id="79d25-111">The font object also supports the outgoing interface [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) so that a client can determine when font properties change.</span></span> <span data-ttu-id="79d25-112">Так как объект Font поддерживает по крайней мере один исходящий интерфейс, он также реализует [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) и одну точку подключения для **ипропертинотифисинк** для этой цели.</span><span class="sxs-lookup"><span data-stu-id="79d25-112">Since the font object supports at least one outgoing interface, it also implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) and one connection point for **IPropertyNotifySink** for this purpose.</span></span>

<span data-ttu-id="79d25-113">Объект Font предоставляет свойство Хфонт, которое является маркером шрифта Windows, который соответствует другим атрибутам, заданным для шрифта.</span><span class="sxs-lookup"><span data-stu-id="79d25-113">The font object provides an hFont property that is a Windows font handle that conforms to the other attributes specified for the font.</span></span> <span data-ttu-id="79d25-114">Объект Font задерживает этот шрифт, если это возможно, поэтому при последовательном задании двух свойств шрифта не будет реализован промежуточный шрифт.</span><span class="sxs-lookup"><span data-stu-id="79d25-114">The font object delays realizing this font when possible, so consecutively setting two properties on a font won't cause an intermediate font to be realized.</span></span> <span data-ttu-id="79d25-115">Кроме того, в качестве оптимизации объект стандартного шрифта поддерживает кэш дескрипторов шрифта.</span><span class="sxs-lookup"><span data-stu-id="79d25-115">In addition, as an optimization, the standard font object maintains a cache of font handles.</span></span> <span data-ttu-id="79d25-116">Два объекта Font в одном процессе с одинаковыми свойствами будут возвращать один и тот же маркер шрифта.</span><span class="sxs-lookup"><span data-stu-id="79d25-116">Two font objects in the same process that have identical properties will return the same font handle.</span></span> <span data-ttu-id="79d25-117">Объект Font может удалить шрифты из этого кэша в, что познакомит с особыми соображениями для клиентов, использующих это свойство Хфонт.</span><span class="sxs-lookup"><span data-stu-id="79d25-117">The font object can remove fonts from this cache at will, which introduces special considerations for clients using this hFont property.</span></span> <span data-ttu-id="79d25-118">Дополнительные сведения см. в разделе [**IFont:: Get \_ хфонт**](/windows/desktop/api/OCIdl/nf-ocidl-ifont-get_hfont) .</span><span class="sxs-lookup"><span data-stu-id="79d25-118">See [**IFont::get\_hFont**](/windows/desktop/api/OCIdl/nf-ocidl-ifont-get_hfont) for more details.</span></span>

<span data-ttu-id="79d25-119">Объект Font также поддерживает [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) , так что он может сохранять и загружать данные из экземпляра [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span><span class="sxs-lookup"><span data-stu-id="79d25-119">The font object also supports [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) such that it can save and load itself from an instance of [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span> <span data-ttu-id="79d25-120">Любой другой объект, который использует объект Font, обычно сохраняет и загружает шрифт как часть собственной обработки сохраняемости объекта.</span><span class="sxs-lookup"><span data-stu-id="79d25-120">Any other object that uses a font object internally would normally save and load the font as part of the object's own persistence handling.</span></span>

<span data-ttu-id="79d25-121">Кроме того, объект Font поддерживает [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , через который он предоставляет набор свойств, содержащий типизированные значения для каждого свойства Font.</span><span class="sxs-lookup"><span data-stu-id="79d25-121">In addition, the font object supports [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) through which it provides a property set containing typed values for each font property.</span></span>

## <a name="related-topics"></a><span data-ttu-id="79d25-122">См. также</span><span class="sxs-lookup"><span data-stu-id="79d25-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="79d25-123">Свойства элемента управления</span><span class="sxs-lookup"><span data-stu-id="79d25-123">Control Properties</span></span>](control-properties.md)
</dt> </dl>

 

 