---
title: Упрощенный обработчик Client-Side
description: Упрощенные клиентские обработчики позволяют создавать общие обработчики на стороне клиента любого размера, что помогает выполнять стандартные задачи любого рода.
ms.assetid: b712237c-55d7-4f52-9cf6-19c6e5fb3182
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f1e8df5be24e8773a660a4d0208b27a2f585e32
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103794053"
---
# <a name="the-lightweight-client-side-handler"></a><span data-ttu-id="774ea-103">Упрощенный обработчик Client-Side</span><span class="sxs-lookup"><span data-stu-id="774ea-103">The Lightweight Client-Side Handler</span></span>

<span data-ttu-id="774ea-104">Упрощенные клиентские обработчики позволяют создавать общие обработчики на стороне клиента любого размера, что помогает выполнять стандартные задачи любого рода.</span><span class="sxs-lookup"><span data-stu-id="774ea-104">Lightweight client-side handlers allow you to create general client-side handlers of any size, to help you do any kind of standard task.</span></span> <span data-ttu-id="774ea-105">Как обработчики, они могут использоваться более чем одним клиентом.</span><span class="sxs-lookup"><span data-stu-id="774ea-105">As handlers, these are usable by more than one client.</span></span> <span data-ttu-id="774ea-106">Они отличаются от обработчиков OLE тем, что они не могут быть созданы до запуска сервера, и их время существования связано с диспетчером прокси-сервера, предотвращая возможное состояние гонки, при котором обработчик может быть преждевременно освобожден.</span><span class="sxs-lookup"><span data-stu-id="774ea-106">They differ from OLE handlers in that they cannot be created before the server is launched, and their lifetime is tied to that of the proxy manager, preventing a possible race condition in which the handler could otherwise be prematurely released.</span></span>

<span data-ttu-id="774ea-107">Диспетчер прокси-сервера — это созданный системой объект, реализующий интерфейс [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) .</span><span class="sxs-lookup"><span data-stu-id="774ea-107">The proxy manager is the system-created object that implements the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface.</span></span> <span data-ttu-id="774ea-108">При использовании стандартного маршалирования система создает ее для вас при вызове [**кожетстандардмаршал**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (или [**кожетстдмаршалекс**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex)для создания агрегированного маршалером для упрощенных обработчиков), а также реализует интерфейсы [**иклиентсекурити**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) и [**имултики**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) для объекта.</span><span class="sxs-lookup"><span data-stu-id="774ea-108">If you use standard marshaling, the system creates it for you when you call [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (or [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), for creating an aggregated marshaler for lightweight handlers) and also implements the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) interfaces on the object.</span></span> <span data-ttu-id="774ea-109">На стороне сервера имеется соответствующий системный объект, который также реализует **IMarshal**.</span><span class="sxs-lookup"><span data-stu-id="774ea-109">On the server side, there is a corresponding system object that also implements **IMarshal**.</span></span> <span data-ttu-id="774ea-110">Эти объекты прозрачно обрабатывали упаковку.</span><span class="sxs-lookup"><span data-stu-id="774ea-110">These objects handle marshaling for you transparently.</span></span>

<span data-ttu-id="774ea-111">Существует два общих типа этих обработчиков, которые, возможно, потребуется реализовать:</span><span class="sxs-lookup"><span data-stu-id="774ea-111">There are two general types of these handlers that you may want to implement:</span></span>

-   <span data-ttu-id="774ea-112">Обработчик, который выполняет службу, не требующую дополнительных данных от сервера</span><span class="sxs-lookup"><span data-stu-id="774ea-112">A handler that performs a service that requires no extra data from the server</span></span>
-   <span data-ttu-id="774ea-113">Обработчик, использующий дополнительные данные с сервера</span><span class="sxs-lookup"><span data-stu-id="774ea-113">A handler that uses extra data from the server</span></span>

<span data-ttu-id="774ea-114">Ниже приведены некоторые возможные варианты использования дополнительных данных в потоке, предоставляемом сервером.</span><span class="sxs-lookup"><span data-stu-id="774ea-114">Some potential uses of the extra data in the stream supplied by the server are as follows:</span></span>

-   <span data-ttu-id="774ea-115">Статические данные с сервера.</span><span class="sxs-lookup"><span data-stu-id="774ea-115">Static data from server.</span></span> <span data-ttu-id="774ea-116">Независимо от конкретного интерфейса, сервер записывает одни и те же данные в поток.</span><span class="sxs-lookup"><span data-stu-id="774ea-116">Regardless of the particular interface being marshaled, the server writes the same data into the stream.</span></span>
-   <span data-ttu-id="774ea-117">Данные для каждого интерфейса с сервера.</span><span class="sxs-lookup"><span data-stu-id="774ea-117">Per-interface data from server.</span></span> <span data-ttu-id="774ea-118">В зависимости от того, какой именно интерфейс маршалируется, сервер может записывать в поток различные данные.</span><span class="sxs-lookup"><span data-stu-id="774ea-118">Depending on which particular interface is being marshaled, the server may write different data into the stream.</span></span>
-   <span data-ttu-id="774ea-119">Вспомогательные функции для каждого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="774ea-119">Per-interface helpers.</span></span> <span data-ttu-id="774ea-120">Компоненты COM для каждого интерфейса, Объединенные в клиентский обработчик и делегирующие стандартному прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="774ea-120">Per-interface COM components aggregated into the client handler and delegating to the standard proxy.</span></span> <span data-ttu-id="774ea-121">Например, чтобы повысить производительность сети, COM-компонент для [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) может выполнять кэширование данных на стороне клиента, упреждающее чтение, запись за пределы операций, блокировку по операциям и т. д.</span><span class="sxs-lookup"><span data-stu-id="774ea-121">For example, to improve network performance, a COM component for [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) could do client-side caching of data, read-ahead, write-behind, op-locking, and so forth.</span></span>
-   <span data-ttu-id="774ea-122">Сетевая версия интерфейса.</span><span class="sxs-lookup"><span data-stu-id="774ea-122">Network version of an interface.</span></span> <span data-ttu-id="774ea-123">Сетевая версия интерфейса отличается от интерфейса, предоставляемого кодом серверного приложения клиента и сервера.</span><span class="sxs-lookup"><span data-stu-id="774ea-123">The network version of the interface is different from the interface exposed by the client and server application code.</span></span> <span data-ttu-id="774ea-124">Это можно, например, для мультиплексирования предоставляемых интерфейсов IA и геоинетаб с одним и тем же сетевым интерфейсом, как это делает обработчик сервера внедрения.</span><span class="sxs-lookup"><span data-stu-id="774ea-124">It is possible, for example, to multiplex exposed interfaces IA and IB over the same network interface INetAB, the way the embedding server handler does.</span></span> <span data-ttu-id="774ea-125">Например, можно преобразовать интерфейс обмена данными в сетевой интерфейс, который использует каналы для эффективного обмена данными.</span><span class="sxs-lookup"><span data-stu-id="774ea-125">For example, one could convert a data transfer interface into a network interface that uses pipes for efficient data transfer.</span></span>

<span data-ttu-id="774ea-126">Клиенты нижнего уровня могут не иметь возможности распаковки интерфейсов с пользовательскими обработчиками по двум причинам: во-первых, они могут не понимать CLSID, используемый в настраиваемом упакованном пакете, когда обработчик сервера является статистическим, и объект требует обработчика.</span><span class="sxs-lookup"><span data-stu-id="774ea-126">Down-level clients may not have the capability of unmarshaling interfaces that have custom handlers, for two reasons: First, they may not understand the CLSID used in the custom marshaled packet when the server handler is aggregated and the object wants a handler.</span></span> <span data-ttu-id="774ea-127">Во-вторых, код обработчика может даже не выполняться на стороне клиента, если для создания агрегированного стандартного модуля упаковки и выполнения удаленных вызовов [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) требуется новая функция com.</span><span class="sxs-lookup"><span data-stu-id="774ea-127">Second, the handler code may not even run on the client side if it requires new functionality from COM to create the aggregated standard marshaler and to do remote [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) calls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="774ea-128">См. также</span><span class="sxs-lookup"><span data-stu-id="774ea-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="774ea-129">Обработчик OLE</span><span class="sxs-lookup"><span data-stu-id="774ea-129">The OLE Handler</span></span>](the-ole-handler.md)
</dt> </dl>

 

 