---
title: Протокол Kerberos V5
description: Протокол Kerberos V5
ms.assetid: a53a1edf-f374-4cbf-8050-7cde45284157
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68d78c4bdc457007c04ad66163e2ebfd7f5397f9
ms.sourcegitcommit: 3e70ae762629e244028b437420ed50b5850db4e3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/20/2020
ms.locfileid: "105710247"
---
# <a name="kerberos-v5-protocol"></a><span data-ttu-id="5b0c9-103">Протокол Kerberos V5</span><span class="sxs-lookup"><span data-stu-id="5b0c9-103">Kerberos v5 Protocol</span></span>

<span data-ttu-id="5b0c9-104">Протокол проверки подлинности Kerberos V5 имеет идентификатор службы проверки подлинности RPC \_ C \_ AUTHN \_ GSS (Kerberos) \_ .</span><span class="sxs-lookup"><span data-stu-id="5b0c9-104">The Kerberos v5 authentication protocol has an authentication service identifier of RPC\_C\_AUTHN\_GSS\_KERBEROS.</span></span> <span data-ttu-id="5b0c9-105">Протокол Kerberos определяет, как клиенты взаимодействуют со службой проверки подлинности сети и были стандартизованы в стандарте IETF (Internet Engineering Task Force) в сентябре 1993 в документе [RFC 1510](https://www.ietf.org/rfc/rfc1510.txt).</span><span class="sxs-lookup"><span data-stu-id="5b0c9-105">The Kerberos protocol defines how clients interact with a network authentication service and was standardized by the Internet Engineering Task Force (IETF) in September 1993, in document [RFC 1510](https://www.ietf.org/rfc/rfc1510.txt).</span></span> <span data-ttu-id="5b0c9-106">Клиенты получают билеты в центре распространения ключей Kerberos и предъявляют их серверам при установлении соединений.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-106">Clients obtain tickets from the Kerberos Key Distribution Center (KDC), and they present these tickets to servers when connections are established.</span></span> <span data-ttu-id="5b0c9-107">Билеты Kerberos представляют собой сетевые учетные данные клиента.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-107">Kerberos tickets represent the client's network credentials.</span></span>

<span data-ttu-id="5b0c9-108">Как и NTLM, протокол Kerberos использует доменное имя, имя пользователя и пароль для представления удостоверения клиента.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-108">Like NTLM, the Kerberos protocol uses the domain name, user name, and password to represent the client's identity.</span></span> <span data-ttu-id="5b0c9-109">Первоначальный билет Kerberos, полученный от KDC при входе пользователя в систему, основан на зашифрованном хэш-коде пароля пользователя.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-109">The initial Kerberos ticket obtained from the KDC when the user logs on is based on an encrypted hash of the user's password.</span></span> <span data-ttu-id="5b0c9-110">Этот первоначальный билет кэшируется.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-110">This initial ticket is cached.</span></span> <span data-ttu-id="5b0c9-111">Когда пользователь пытается подключиться к серверу, протокол Kerberos проверяет кэш билетов на наличие действительного билета для этого сервера.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-111">When the user tries to connect to a server, the Kerberos protocol checks the ticket cache for a valid ticket for that server.</span></span> <span data-ttu-id="5b0c9-112">Если он недоступен, первоначальный билет для пользователя отправляется в KDC вместе с запросом билета для указанного сервера.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-112">If one is not available, the initial ticket for the user is sent to the KDC along with a request for a ticket for the specified server.</span></span> <span data-ttu-id="5b0c9-113">Этот билет сеанса добавляется в кэш и может использоваться для подключения к тому же серверу до истечения срока действия билета.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-113">That session ticket is added to the cache, and it can be used to connect to the same server until the ticket expires.</span></span>

<span data-ttu-id="5b0c9-114">Когда сервер вызывает [**кокуериклиентбланкет**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryclientblanket) с помощью протокола Kerberos, возвращаются доменное имя и имя пользователя клиента.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-114">When a server calls [**CoQueryClientBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryclientblanket) using the Kerberos protocol, the client's domain name and user name are returned.</span></span> <span data-ttu-id="5b0c9-115">Когда сервер вызывает [**коимперсонатеклиент**](/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient), возвращается маркер клиента.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-115">When a server calls [**CoImpersonateClient**](/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient), the client's token is returned.</span></span> <span data-ttu-id="5b0c9-116">Эти поведения те же, что и при использовании NTLM.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-116">These behaviors are the same as when using NTLM.</span></span>

<span data-ttu-id="5b0c9-117">Протокол Kerberos работает через границы компьютера.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-117">The Kerberos protocol works across computer boundaries.</span></span> <span data-ttu-id="5b0c9-118">Компьютеры клиента и сервера должны быть в доменах, и эти домены должны иметь отношения доверия.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-118">The client and server computers must both be in domains, and those domains must have a trust relationship.</span></span>

<span data-ttu-id="5b0c9-119">Протокол Kerberos требует взаимной проверки подлинности и поддерживает его удаленно.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-119">The Kerberos protocol requires mutual authentication and supports it remotely.</span></span> <span data-ttu-id="5b0c9-120">Клиент должен указать имя участника сервера, и удостоверение сервера должно точно совпадать с именем субъекта.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-120">The client must specify the principal name of the server, and the server's identity must match that principal name exactly.</span></span> <span data-ttu-id="5b0c9-121">Если клиент указывает **значение NULL** для имени участника сервера или если имя участника не соответствует серверу, вызов завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-121">If the client specifies **NULL** for the server's principal name or if the principal name doesn't match the server, the call will fail.</span></span>

<span data-ttu-id="5b0c9-122">При использовании протокола Kerberos можно использовать уровни олицетворения Identify, IMPERSONATE и Delegate.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-122">With the Kerberos protocol, the impersonation levels identify, impersonate, and delegate can be used.</span></span> <span data-ttu-id="5b0c9-123">Когда сервер вызывает [**коимперсонатеклиент**](/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient), возвращенный токен действителен на компьютере в течение некоторого периода времени от 5 минут до 8 часов.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-123">When a server calls [**CoImpersonateClient**](/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient), the token returned is valid off the computer for some time period between 5 minutes and 8 hours.</span></span> <span data-ttu-id="5b0c9-124">По истечении этого времени его можно использовать только на серверном компьютере.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-124">After this time, it can be used on the server computer only.</span></span> <span data-ttu-id="5b0c9-125">Если сервер имеет значение "Запуск от имени активатора" и активация выполняется с помощью протокола Kerberos, срок действия маркера сервера истекает через 5 минут и 8 часов после активации.</span><span class="sxs-lookup"><span data-stu-id="5b0c9-125">If a server is "run as activator" and the activation is done with the Kerberos protocol, the server's token will expire between 5 minutes and 8 hours after activation.</span></span>

<span data-ttu-id="5b0c9-126">Протокол проверки подлинности Kerberos V5, реализованный Windows, поддерживает [маскировку](cloaking.md).</span><span class="sxs-lookup"><span data-stu-id="5b0c9-126">The Kerberos v5 authentication protocol implemented by WindowsÂ supports [cloaking](cloaking.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5b0c9-127">См. также</span><span class="sxs-lookup"><span data-stu-id="5b0c9-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5b0c9-128">Пакеты безопасности и COM</span><span class="sxs-lookup"><span data-stu-id="5b0c9-128">COM and Security Packages</span></span>](com-and-security-packages.md)
</dt> </dl>

 

 




