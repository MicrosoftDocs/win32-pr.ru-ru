---
title: Настройка безопасности System-Wide с помощью DCOMCNFG
description: Если требуется, чтобы все приложения на одном компьютере, не предоставляющие собственной безопасности для совместного использования параметров безопасности по умолчанию, были установлены на уровне всей системы.
ms.assetid: 23d1e222-c00b-497c-adc8-4ae14c5bdd98
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7feaaf356263a48c2c93eb9b3b3764b7352cd39
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411164"
---
# <a name="setting-system-wide-security-using-dcomcnfg"></a><span data-ttu-id="915df-103">Настройка безопасности System-Wide с помощью DCOMCNFG</span><span class="sxs-lookup"><span data-stu-id="915df-103">Setting System-Wide Security Using DCOMCNFG</span></span>

<span data-ttu-id="915df-104">Изменение параметров безопасности на уровне системы повлияет на все серверные приложения COM, не устанавливающие собственные параметры безопасности на уровне процесса.</span><span class="sxs-lookup"><span data-stu-id="915df-104">Changing the system-wide security settings will affect all COM server applications that do not set their own process-wide security.</span></span> <span data-ttu-id="915df-105">Это может препятствовать правильной работе таких приложений.</span><span class="sxs-lookup"><span data-stu-id="915df-105">This may prevent such applications from working properly.</span></span> <span data-ttu-id="915df-106">Если вы изменяете параметры безопасности на уровне системы, чтобы они влияли на параметры безопасности для конкретного приложения COM, вместо этого следует изменить параметры безопасности для этого конкретного COM-приложения.</span><span class="sxs-lookup"><span data-stu-id="915df-106">If you are changing the system-wide security settings to affect the security settings for a particular COM application, then you should instead change the process-wide security settings for that particular COM application.</span></span> <span data-ttu-id="915df-107">Дополнительные сведения о настройке безопасности на уровне процесса см. в разделе [Настройка безопасности на уровне процесса](setting-processwide-security.md).</span><span class="sxs-lookup"><span data-stu-id="915df-107">For more information about setting process-wide security, see [Setting Process-wide Security](setting-processwide-security.md).</span></span>

<span data-ttu-id="915df-108">Если требуется, чтобы все приложения на одном компьютере, не предоставляющие собственной безопасности для совместного использования параметров безопасности по умолчанию, были установлены на уровне всей системы.</span><span class="sxs-lookup"><span data-stu-id="915df-108">When you want all of the applications on one computer that do not provide their own security to share the same default security settings, you would set security on a system-wide basis.</span></span> <span data-ttu-id="915df-109">Использование Dcomcnfg.exe позволяет легко задавать значения по умолчанию в реестре, которые применяются ко всем приложениям на компьютере.</span><span class="sxs-lookup"><span data-stu-id="915df-109">Using Dcomcnfg.exe makes it easy to set default values in the registry that apply to all applications on a computer.</span></span>

<span data-ttu-id="915df-110">Важно понимать, что если клиент или сервер явно вызывает [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) для установки безопасности на уровне процесса, параметры по умолчанию в реестре будут игнорироваться, а вместо параметров безопасности процесса будут использоваться параметры для **CoInitializeSecurity** .</span><span class="sxs-lookup"><span data-stu-id="915df-110">It is important to understand that if the client or server explicitly calls [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set process-wide security, the default settings in the registry will be ignored and the parameters to **CoInitializeSecurity** will be used instead for the security settings for the process.</span></span> <span data-ttu-id="915df-111">Кроме того, при использовании Dcomcnfg.exe для указания параметров безопасности конкретного процесса параметры компьютера по умолчанию переопределяются параметрами процесса.</span><span class="sxs-lookup"><span data-stu-id="915df-111">Also, if you use Dcomcnfg.exe to specify security settings for a particular process, the default computer settings are overridden by the settings for the process.</span></span>

<span data-ttu-id="915df-112">При включении безопасности на уровне системы необходимо задать для уровня проверки подлинности значение, отличное от None, и задать разрешения на запуск и доступ.</span><span class="sxs-lookup"><span data-stu-id="915df-112">When enabling system-wide security, you must set the authentication level to a value other than None and you must set launch and access permissions.</span></span> <span data-ttu-id="915df-113">Можно задать уровень олицетворения по умолчанию, а также включить отслеживание ссылок.</span><span class="sxs-lookup"><span data-stu-id="915df-113">You have the option of setting the default impersonation level, and you also can enable reference tracking.</span></span> <span data-ttu-id="915df-114">В следующих разделах приводятся пошаговые инструкции.</span><span class="sxs-lookup"><span data-stu-id="915df-114">The following topics provide step-by-step procedures:</span></span>

-   [<span data-ttu-id="915df-115">Настройка System-Wide уровня проверки подлинности по умолчанию</span><span class="sxs-lookup"><span data-stu-id="915df-115">Setting System-Wide Default Authentication Level</span></span>](#setting-system-wide-default-authentication-level)
-   [<span data-ttu-id="915df-116">Настройка разрешений на запуск System-Wide</span><span class="sxs-lookup"><span data-stu-id="915df-116">Setting System-Wide Launch Permissions</span></span>](#setting-system-wide-launch-permissions)
-   [<span data-ttu-id="915df-117">Настройка разрешений System-Wide доступа</span><span class="sxs-lookup"><span data-stu-id="915df-117">Setting System-Wide Access Permissions</span></span>](#setting-system-wide-access-permissions)
-   [<span data-ttu-id="915df-118">Настройка уровня олицетворения System-Wide</span><span class="sxs-lookup"><span data-stu-id="915df-118">Setting System-Wide Impersonation Level</span></span>](#setting-system-wide-impersonation-level)
-   [<span data-ttu-id="915df-119">Настройка отслеживания ссылок System-Wide</span><span class="sxs-lookup"><span data-stu-id="915df-119">Setting System-Wide Reference Tracking</span></span>](#setting-system-wide-reference-tracking)
-   [<span data-ttu-id="915df-120">Включение и отключение DCOM</span><span class="sxs-lookup"><span data-stu-id="915df-120">Enabling and Disabling DCOM</span></span>](#enabling-and-disabling-dcom)
-   [<span data-ttu-id="915df-121">См. также</span><span class="sxs-lookup"><span data-stu-id="915df-121">Related topics</span></span>](#related-topics)

## <a name="setting-system-wide-default-authentication-level"></a><span data-ttu-id="915df-122">Настройка System-Wide уровня проверки подлинности по умолчанию</span><span class="sxs-lookup"><span data-stu-id="915df-122">Setting System-Wide Default Authentication Level</span></span>

<span data-ttu-id="915df-123">Уровень проверки подлинности используется, чтобы сообщить COM о том, какой уровень проверки подлинности клиента должен пройти.</span><span class="sxs-lookup"><span data-stu-id="915df-123">The authentication level is used to tell COM at what level you want the client to be authenticated.</span></span> <span data-ttu-id="915df-124">Эти уровни обеспечивают различные уровни защиты, от защиты до полного шифрования.</span><span class="sxs-lookup"><span data-stu-id="915df-124">These levels offer various levels of protection, from no protection to full encryption.</span></span> <span data-ttu-id="915df-125">Чтобы включить безопасность для компьютера, необходимо выбрать уровень проверки подлинности, отличный от «нет».</span><span class="sxs-lookup"><span data-stu-id="915df-125">To enable security for a computer, you need to choose an authentication level other than None.</span></span> <span data-ttu-id="915df-126">Вы можете выбрать такой параметр с помощью Dcomcnfg.exe, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="915df-126">You can choose such a setting, using Dcomcnfg.exe, by completing the following steps.</span></span>

<span data-ttu-id="915df-127">**Установка уровня проверки подлинности на уровне системы**</span><span class="sxs-lookup"><span data-stu-id="915df-127">**To set the authentication level on a system-wide basis**</span></span>

1.  <span data-ttu-id="915df-128">Запустите файл Dcomcnfg.exe.</span><span class="sxs-lookup"><span data-stu-id="915df-128">Run Dcomcnfg.exe.</span></span>

2.  <span data-ttu-id="915df-129">Перейдите на вкладку **свойства по умолчанию** .</span><span class="sxs-lookup"><span data-stu-id="915df-129">Choose the **Default Properties** tab.</span></span>

3.  <span data-ttu-id="915df-130">В списке **Дефаултâ Аусентикатионâ Level (уровень** ) выберите значение, отличное от **(нет)**.</span><span class="sxs-lookup"><span data-stu-id="915df-130">From the **DefaultÂ AuthenticationÂ Level** list box, choose a value other than **(None)**.</span></span>

4.  <span data-ttu-id="915df-131">Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы применить новый уровень проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="915df-131">If you will be setting more properties for the computer, click the **Apply** button to apply the new authentication level.</span></span> <span data-ttu-id="915df-132">В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.</span><span class="sxs-lookup"><span data-stu-id="915df-132">Otherwise, click **OK** to apply the changes and exit Dcomcnfg.exe.</span></span>

## <a name="setting-system-wide-launch-permissions"></a><span data-ttu-id="915df-133">Настройка разрешений на запуск System-Wide</span><span class="sxs-lookup"><span data-stu-id="915df-133">Setting System-Wide Launch Permissions</span></span>

<span data-ttu-id="915df-134">Разрешения на запуск, заданные с помощью Dcomcnfg.exe определяют список пользователей, каждый из которых явно предоставил или запретил разрешение на запуск любого сервера, который не предоставляет собственные параметры разрешения на запуск.</span><span class="sxs-lookup"><span data-stu-id="915df-134">The launch permissions you set with Dcomcnfg.exe determine a list of users, each of which is explicitly granted or denied permission to launch any server that does not provide its own launch-permission settings.</span></span> <span data-ttu-id="915df-135">При задании разрешений на запуск можно добавить или удалить одного или нескольких пользователей или группы из этого списка.</span><span class="sxs-lookup"><span data-stu-id="915df-135">When setting launch permissions, you can add or remove one or more users or groups from this list.</span></span> <span data-ttu-id="915df-136">Для каждого добавляемого пользователя необходимо указать, предоставлено ли пользователю разрешение на запуск.</span><span class="sxs-lookup"><span data-stu-id="915df-136">For each user that you add, you must specify whether the user is being granted or denied launch permission.</span></span>

<span data-ttu-id="915df-137">**Задание разрешений на запуск для компьютера**</span><span class="sxs-lookup"><span data-stu-id="915df-137">**To set launch permissions for a computer**</span></span>

1.  <span data-ttu-id="915df-138">На странице свойств **безопасность по умолчанию** в Dcomcnfg.exe нажмите кнопку **изменить значение по умолчанию** в области **разрешения на запуск по умолчанию** .</span><span class="sxs-lookup"><span data-stu-id="915df-138">On the **Default Security** property page in Dcomcnfg.exe, choose the **Edit Default** button in the **Default Launch Permissions** area.</span></span>

2.  <span data-ttu-id="915df-139">Чтобы удалить пользователей или группы, выберите пользователя или группу, которые нужно удалить, и нажмите кнопку **Удалить** .</span><span class="sxs-lookup"><span data-stu-id="915df-139">To remove users or groups, select the user or group you want to remove and choose the **Remove** button.</span></span> <span data-ttu-id="915df-140">Выбранный пользователь или группа больше не будут отображаться в списке.</span><span class="sxs-lookup"><span data-stu-id="915df-140">The selected user or group will no longer appear in the list box.</span></span> <span data-ttu-id="915df-141">Завершив удаление пользователей и групп, нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="915df-141">When you have finished removing users and groups, choose **OK**.</span></span>

3.  <span data-ttu-id="915df-142">Если вы хотите добавить пользователя или группу, нажмите кнопку **Добавить** .</span><span class="sxs-lookup"><span data-stu-id="915df-142">If you want to add a user or group, choose the **Add** button.</span></span>

4.  <span data-ttu-id="915df-143">Если известно полное имя пользователя, которое вы хотите добавить, введите его в текстовом поле **Добавить имена** .</span><span class="sxs-lookup"><span data-stu-id="915df-143">If you know the fully qualified user name you want to add, type it in the **Add Names** text box.</span></span> <span data-ttu-id="915df-144">Если имя пользователя неизвестно, см. раздел **Настройка безопасности Процессвиде с помощью DCOMCNFG** для его поиска.</span><span class="sxs-lookup"><span data-stu-id="915df-144">If you do not know the user name, see **Setting Processwide Security Using DCOMCNFG** to find it.</span></span> <span data-ttu-id="915df-145">После обнаружения имени пользователя выберите пользователя или группу в списке **имена** и нажмите кнопку **Добавить** .</span><span class="sxs-lookup"><span data-stu-id="915df-145">When you have located the user name, select the user or group from the **Names** list box and choose the **Add** button.</span></span>

5.  <span data-ttu-id="915df-146">В поле **тип списка доступа** выберите тип доступа ( **Разрешить запуск** или **запретить запуск**).</span><span class="sxs-lookup"><span data-stu-id="915df-146">From the **Type of Access** list box, select the access type (either **Allow Launch** or **Deny Launch**).</span></span> <span data-ttu-id="915df-147">Чтобы добавить других пользователей, которые также будут иметь выбранный тип доступа, повторите шаг 4.</span><span class="sxs-lookup"><span data-stu-id="915df-147">To add other users that will also have the selected type of access, repeat step 4.</span></span> <span data-ttu-id="915df-148">Завершив добавление пользователей для выбранного типа доступа, нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="915df-148">When you have finished adding users for the selected access type, choose the **OK** button.</span></span>

6.  <span data-ttu-id="915df-149">Чтобы добавить пользователей, которые будут иметь другой тип доступа, повторите шаги 4 и 5.</span><span class="sxs-lookup"><span data-stu-id="915df-149">To add users that will have a different type of access, repeat steps 4 and 5.</span></span> <span data-ttu-id="915df-150">В противном случае нажмите кнопку **ОК** , чтобы применить изменения.</span><span class="sxs-lookup"><span data-stu-id="915df-150">Otherwise, choose **OK** to apply the changes.</span></span>

## <a name="setting-system-wide-access-permissions"></a><span data-ttu-id="915df-151">Настройка разрешений System-Wide доступа</span><span class="sxs-lookup"><span data-stu-id="915df-151">Setting System-Wide Access Permissions</span></span>

<span data-ttu-id="915df-152">Dcomcnfg.exe позволяет задать разрешения на доступ для управления списком пользователей, которым предоставлен или запрещен доступ к методам этих серверов, которые не предоставляют собственные разрешения на доступ.</span><span class="sxs-lookup"><span data-stu-id="915df-152">Dcomcnfg.exe allows you to set access permissions to control the list of users who are granted or denied access to the methods of those servers that do not provide their own access permissions.</span></span> <span data-ttu-id="915df-153">В список можно добавить пользователей или группы, указав, будет ли разрешение на доступ предоставлено или запрещено.</span><span class="sxs-lookup"><span data-stu-id="915df-153">You can add users or groups to the list, specifying whether access permission is being granted or denied.</span></span> <span data-ttu-id="915df-154">Вы также можете удалить пользователей из списка.</span><span class="sxs-lookup"><span data-stu-id="915df-154">You can also remove users from the list.</span></span>

<span data-ttu-id="915df-155">При настройке разрешений доступа необходимо убедиться, что система включена в список пользователей, которым предоставлен доступ.</span><span class="sxs-lookup"><span data-stu-id="915df-155">When setting access permissions, you must ensure that SYSTEM is included in the list of users that are granted access.</span></span> <span data-ttu-id="915df-156">Если предоставлены разрешения на доступ всем, система включается неявно.</span><span class="sxs-lookup"><span data-stu-id="915df-156">If you have granted access permissions to Everyone, SYSTEM is included implicitly.</span></span>

<span data-ttu-id="915df-157">Процесс настройки разрешений на доступ к компьютеру аналогичен настройке разрешений на запуск.</span><span class="sxs-lookup"><span data-stu-id="915df-157">The process of setting access permissions for a computer is similar to setting launch permissions.</span></span> <span data-ttu-id="915df-158">Необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="915df-158">The following steps should be taken.</span></span>

<span data-ttu-id="915df-159">**Настройка разрешений доступа для компьютера**</span><span class="sxs-lookup"><span data-stu-id="915df-159">**To set access permissions for a computer**</span></span>

1.  <span data-ttu-id="915df-160">На странице свойств **безопасность по умолчанию** в Dcomcnfg.exe нажмите кнопку **изменить значение по умолчанию** в области **разрешения доступа по умолчанию** .</span><span class="sxs-lookup"><span data-stu-id="915df-160">On the **Default Security** property page in Dcomcnfg.exe, choose the **Edit Default** button in the **Default Access Permissions** area.</span></span>

2.  <span data-ttu-id="915df-161">Чтобы удалить пользователей или группы, выберите пользователя или группу, которые нужно удалить, и нажмите кнопку **Удалить** .</span><span class="sxs-lookup"><span data-stu-id="915df-161">To remove users or groups, select the user or group you want to remove and choose the **Remove** button.</span></span> <span data-ttu-id="915df-162">Выбранный пользователь или группа больше не будут отображаться в списке.</span><span class="sxs-lookup"><span data-stu-id="915df-162">The selected user or group will no longer appear in the list box.</span></span> <span data-ttu-id="915df-163">Завершив удаление пользователей и групп, нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="915df-163">When you have finished removing user and groups, choose **OK**.</span></span>

3.  <span data-ttu-id="915df-164">Если вы хотите добавить пользователя или группу, нажмите кнопку **Добавить** .</span><span class="sxs-lookup"><span data-stu-id="915df-164">If you want to add a user or a group, choose the **Add** button.</span></span>

4.  <span data-ttu-id="915df-165">Если известно полное имя пользователя, которое вы хотите добавить, введите его в текстовом поле **Добавить имена** .</span><span class="sxs-lookup"><span data-stu-id="915df-165">If you know the fully qualified user name you want to add, type it in the **Add Names** text box.</span></span> <span data-ttu-id="915df-166">Если вы не знакомы с именем пользователя, см. раздел [Настройка безопасности на уровне процесса с помощью DCOMCNFG](setting-processwide-security-using-dcomcnfg.md) , чтобы найти его.</span><span class="sxs-lookup"><span data-stu-id="915df-166">If you do not know the user name, see [Setting Process-wide Security Using DCOMCNFG](setting-processwide-security-using-dcomcnfg.md) to find it.</span></span> <span data-ttu-id="915df-167">После обнаружения имени пользователя выберите пользователя или группу в списке **имена** и нажмите кнопку **Добавить** .</span><span class="sxs-lookup"><span data-stu-id="915df-167">When you have located the user name, select the user or group from the **Names** list box and choose the **Add** button.</span></span>

5.  <span data-ttu-id="915df-168">В поле **тип списка доступа** выберите тип доступа ( **Разрешить доступ** или **запретить доступ**).</span><span class="sxs-lookup"><span data-stu-id="915df-168">From the **Type of Access** list box, select the access type (either **Allow Access** or **Deny Access**).</span></span> <span data-ttu-id="915df-169">Чтобы добавить других пользователей, которые будут иметь выбранный тип доступа, повторите шаг 4.</span><span class="sxs-lookup"><span data-stu-id="915df-169">To add other users that will have the selected type of access, repeat step 4.</span></span> <span data-ttu-id="915df-170">Завершив добавление пользователей для выбранного типа доступа, нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="915df-170">When you have finished adding users for the selected access type, choose the **OK** button.</span></span>

6.  <span data-ttu-id="915df-171">Чтобы добавить пользователей, которые будут иметь другой тип доступа, повторите шаги 4 и 5.</span><span class="sxs-lookup"><span data-stu-id="915df-171">To add users that will have a different type of access, repeat steps 4 and 5.</span></span> <span data-ttu-id="915df-172">В противном случае нажмите кнопку **ОК** , чтобы применить изменения.</span><span class="sxs-lookup"><span data-stu-id="915df-172">Otherwise, choose **OK** to apply the changes.</span></span>

## <a name="setting-system-wide-impersonation-level"></a><span data-ttu-id="915df-173">Настройка уровня олицетворения System-Wide</span><span class="sxs-lookup"><span data-stu-id="915df-173">Setting System-Wide Impersonation Level</span></span>

<span data-ttu-id="915df-174">Уровень олицетворения, заданный клиентом, определяет количество полномочий, предоставленных серверу для работы от имени клиента.</span><span class="sxs-lookup"><span data-stu-id="915df-174">The impersonation level, set by the client, determines the amount of authority given to the server to act on the client's behalf.</span></span> <span data-ttu-id="915df-175">Например, если клиент установил уровень олицетворения делегировать, сервер может получить доступ к локальным и удаленным ресурсам в качестве клиента, а сервер может скрываться на нескольких компьютерах, если задана возможность маскировки.</span><span class="sxs-lookup"><span data-stu-id="915df-175">For example, when the client has set its impersonation level to delegate, the server can access local and remote resources as the client, and the server can cloak over multiple computer boundaries if the cloaking capability is set.</span></span> <span data-ttu-id="915df-176">Чтобы определить, какой уровень олицетворения следует выбрать, см. раздел [уровни олицетворения](impersonation-levels.md) и [маскировка](cloaking.md).</span><span class="sxs-lookup"><span data-stu-id="915df-176">To help determine which impersonation level you should choose, see [Impersonation Levels](impersonation-levels.md) and [Cloaking](cloaking.md).</span></span>

<span data-ttu-id="915df-177">Установка уровня олицетворения по умолчанию для всего компьютера сообщает COM, какой уровень олицетворения следует использовать, когда конкретный клиент на компьютере не задает уровень олицетворения программным путем с помощью [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) или [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span><span class="sxs-lookup"><span data-stu-id="915df-177">Setting the default impersonation level for the whole computer tells COM what impersonation level to use when a particular client on the computer does not specify an impersonation level programmatically by using [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span></span>

<span data-ttu-id="915df-178">**Установка уровня олицетворения для компьютера**</span><span class="sxs-lookup"><span data-stu-id="915df-178">**To set the impersonation level for a computer**</span></span>

1.  <span data-ttu-id="915df-179">Если Dcomcnfg.exe работает, перейдите на вкладку **свойства по умолчанию** .</span><span class="sxs-lookup"><span data-stu-id="915df-179">With Dcomcnfg.exe running, choose the **Default Properties** tab.</span></span>

2.  <span data-ttu-id="915df-180">В списке **уровень олицетворения по умолчанию** выберите нужный уровень олицетворения.</span><span class="sxs-lookup"><span data-stu-id="915df-180">From the **Default Impersonation Level** list box, choose the impersonation level you want.</span></span>

3.  <span data-ttu-id="915df-181">Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы применить новый уровень олицетворения.</span><span class="sxs-lookup"><span data-stu-id="915df-181">If you will be setting more properties for the computer, choose the **Apply** button to apply the new impersonation level.</span></span> <span data-ttu-id="915df-182">В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.</span><span class="sxs-lookup"><span data-stu-id="915df-182">Otherwise, choose **OK** to apply the changes and exit Dcomcnfg.exe.</span></span>

## <a name="setting-system-wide-reference-tracking"></a><span data-ttu-id="915df-183">Настройка отслеживания ссылок System-Wide</span><span class="sxs-lookup"><span data-stu-id="915df-183">Setting System-Wide Reference Tracking</span></span>

<span data-ttu-id="915df-184">Когда вы включаете отслеживание ссылок, вы запрашиваете у COM дополнительные проверки безопасности и отслеживаете сведения, позволяющие избежать слишком раннего освобождения объектов.</span><span class="sxs-lookup"><span data-stu-id="915df-184">When you enable reference tracking, you are asking COM to do additional security checks and to keep track of information that will keep objects from being released too early.</span></span> <span data-ttu-id="915df-185">Помните, что эти дополнительные проверки являются дорогостоящими.</span><span class="sxs-lookup"><span data-stu-id="915df-185">Keep in mind that these additional checks are expensive.</span></span> <span data-ttu-id="915df-186">Дополнительные сведения об отслеживании ссылок см. в разделе [Отслеживание ссылок](reference-tracking.md).</span><span class="sxs-lookup"><span data-stu-id="915df-186">For more information about reference tracking, see [Reference Tracking](reference-tracking.md).</span></span> <span data-ttu-id="915df-187">Чтобы включить или отключить отслеживание ссылок, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="915df-187">Use the following steps to enable or disable reference tracking.</span></span>

<span data-ttu-id="915df-188">**Настройка отслеживания ссылок для компьютера**</span><span class="sxs-lookup"><span data-stu-id="915df-188">**To set reference tracking for a computer**</span></span>

1.  <span data-ttu-id="915df-189">Если Dcomcnfg.exe работает, перейдите на вкладку **свойства по умолчанию** .</span><span class="sxs-lookup"><span data-stu-id="915df-189">With Dcomcnfg.exe running, choose the **Default Properties** tab.</span></span>

2.  <span data-ttu-id="915df-190">Чтобы включить (или отключить) отслеживание ссылок, установите (или снимите) флажок **включить дополнительную защиту для отслеживания ссылок** в нижней части страницы.</span><span class="sxs-lookup"><span data-stu-id="915df-190">To enable (or disable) reference tracking, select (or clear) the **Provide additional security for reference tracking** check box near the bottom of the page.</span></span>

3.  <span data-ttu-id="915df-191">Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы применить новый параметр.</span><span class="sxs-lookup"><span data-stu-id="915df-191">If you will be setting more properties for the computer, choose the **Apply** button to apply the new setting.</span></span> <span data-ttu-id="915df-192">В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.</span><span class="sxs-lookup"><span data-stu-id="915df-192">Otherwise, choose **OK** to apply the changes and exit Dcomcnfg.exe.</span></span>

## <a name="enabling-and-disabling-dcom"></a><span data-ttu-id="915df-193">Включение и отключение DCOM</span><span class="sxs-lookup"><span data-stu-id="915df-193">Enabling and Disabling DCOM</span></span>

<span data-ttu-id="915df-194">Если компьютер входит в сеть, протокол связи DCOM позволяет COM-объектам на этом компьютере взаимодействовать с COM-объектами на других компьютерах.</span><span class="sxs-lookup"><span data-stu-id="915df-194">When a computer is part of a network, the DCOM wire protocol enables COM objects on that computer to communicate with COM objects on other computers.</span></span> <span data-ttu-id="915df-195">Можно отключить DCOM для определенного компьютера, но это приведет к отключению всех соединений между объектами на этом компьютере и объектами на других компьютерах.</span><span class="sxs-lookup"><span data-stu-id="915df-195">You can disable DCOM for a particular computer, but doing so will disable all communication between objects on that computer and objects on other computers.</span></span>

<span data-ttu-id="915df-196">Отключение DCOM на компьютере не влияет на локальные объекты COM.</span><span class="sxs-lookup"><span data-stu-id="915df-196">Disabling DCOM on a computer has no effect on local COM objects.</span></span> <span data-ttu-id="915df-197">COM по-прежнему ищет указанные разрешения на запуск.</span><span class="sxs-lookup"><span data-stu-id="915df-197">COM still looks for launch permissions that you have specified.</span></span> <span data-ttu-id="915df-198">Если разрешения на запуск не указаны, используются разрешения на запуск по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="915df-198">If no launch permissions have been specified, default launch permissions are used.</span></span> <span data-ttu-id="915df-199">Даже если отключить DCOM, если пользователь имеет физический доступ к компьютеру, он может запустить сервер на компьютере, если только не задано разрешение на запуск.</span><span class="sxs-lookup"><span data-stu-id="915df-199">Even if you disable DCOM, if a user has physical access to the computer, they could launch a server on the computer unless you set launch permissions not to allow it.</span></span>

> [!Note]  
> <span data-ttu-id="915df-200">Если отключить DCOM на удаленном компьютере, удаленный доступ к этому компьютеру будет невозможен для повторного включения DCOM.</span><span class="sxs-lookup"><span data-stu-id="915df-200">If you disable DCOM on a remote computer, you will not be able to remotely access that computer afterward to re-enable DCOM.</span></span> <span data-ttu-id="915df-201">Чтобы повторно включить DCOM, потребуется физический доступ к этому компьютеру.</span><span class="sxs-lookup"><span data-stu-id="915df-201">To re-enable DCOM, you will need physical access to that computer.</span></span>

 

<span data-ttu-id="915df-202">**Ручное включение (отключение) DCOM для компьютера**</span><span class="sxs-lookup"><span data-stu-id="915df-202">**To manually enable (or disable) DCOM for a computer**</span></span>

1.  <span data-ttu-id="915df-203">Запустите файл Dcomcnfg.exe.</span><span class="sxs-lookup"><span data-stu-id="915df-203">Run Dcomcnfg.exe.</span></span>

2.  <span data-ttu-id="915df-204">Перейдите на вкладку **Свойства дефаултâ** .</span><span class="sxs-lookup"><span data-stu-id="915df-204">Choose the **DefaultÂ Properties** tab.</span></span>

3.  <span data-ttu-id="915df-205">Установите (или снимите) флажок **включить распределенные комâ на этом компьютере** .</span><span class="sxs-lookup"><span data-stu-id="915df-205">Select (or clear) the **Enable Distributed COMÂ on this Computer** check box.</span></span>

4.  <span data-ttu-id="915df-206">Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы включить (или отключить) DCOM.</span><span class="sxs-lookup"><span data-stu-id="915df-206">If you will be setting more properties for the computer, click the **Apply** button to enable (or disable) DCOM.</span></span> <span data-ttu-id="915df-207">В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.</span><span class="sxs-lookup"><span data-stu-id="915df-207">Otherwise, click **OK** to apply the changes and exit Dcomcnfg.exe.</span></span>

## <a name="related-topics"></a><span data-ttu-id="915df-208">См. также</span><span class="sxs-lookup"><span data-stu-id="915df-208">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="915df-209">Настройка безопасности на уровне процесса</span><span class="sxs-lookup"><span data-stu-id="915df-209">Setting Process-wide Security</span></span>](setting-processwide-security.md)
</dt> </dl>

 

 




