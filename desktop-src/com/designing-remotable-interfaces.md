---
title: Проектирование удаленных интерфейсов
description: С появлением объектной модели распределенных компонентов важно, чтобы пользовательский интерфейс был удаленно, даже если вы планируете использовать его только в процессе.
ms.assetid: 2ee4d950-dfd5-4965-bd77-a600e878be59
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 52df6deb3f83f253fc46436ba992dc3fc10f74d84e43c6027fd4426b3171a838
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120071004"
---
# <a name="designing-remotable-interfaces"></a>Проектирование удаленных интерфейсов

С появлением объектной модели распределенных компонентов важно, чтобы пользовательский интерфейс был удаленно, даже если вы планируете использовать его только в процессе.

MIDL — это не просто способ создания файлов заголовков для интерфейсов. Это язык программирования для удаленного взаимодействия, который позволяет использовать интерфейсы в границах компьютера, процесса и потока. Это означает, что необходимо проверить поведение интерфейсов, определяемых MIDL, в этих условиях до выпуска программы для клиентов. Если в IDL была допущена ошибка, а интерфейс не удален должным образом, может быть трудно устранить эту ошибку. Необходимо изменить интерфейс с помощью нового идентификатора IID и оставить старый в для обеспечения обратной совместимости или преобразовать все клиентские и все серверные компьютеры в одно и то же время.

Даже если ваш интерфейс никогда не будет использоваться вне процесса, он может использоваться в разных потоках. Наихудшая проблема для непроверенного IDL-файла может возникнуть для внутрипроцессного сервера, которые не поддерживают несколько [однопотоковых подразделения](single-threaded-apartments.md). Сервер, не указывающий потоковую модель, неявно является однопотоковым. Все, что отмечено как однопотоковое, передается в поток, который впервые вызвал [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) или [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex). Если какой-то другой поток был активирован объектом, все интерфейсы на этом однопотоковом сервере должны быть удаленно возвращены в поток активации, что может привести к возврату РЕГДБ \_ E \_ ииднотрег в ответ на вызов [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))). Если вы не можете полностью подтвердить, что интерфейс является и в процессе, и всегда будет вызываться в том же потоке, вы будете удаленно работать в течение некоторого времени.

Наконец, в качестве конструктора интерфейсов необходимо учитывать, как клиентские приложения будут использовать ваш интерфейс. Два вещи вместе определяют, будет ли интерфейс эффективно работать на границах процессов и компьютеров: Частота вызовов методов через границу интерфейса и объем данных, которые будут переданы при указанном вызове метода. Хотя COM делает вызовы между процессами и между сетями прозрачными для программ, она не может выполнять высокочастотные вызовы с высокой пропускной способностью в адресных пространствах. В некоторых случаях лучше разработать интерфейсы, которые обычно реализуются только как внутрипроцессный сервер, в то время как другие интерфейсы более подходят для удаленного использования.

 

 




