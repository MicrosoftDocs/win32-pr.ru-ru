---
title: Классы и серверы
description: Классы и серверы
ms.assetid: cc88be56-0d96-47d2-b23b-6a6ad376bdae
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30b87ce6b52e73f8ac4e465202b787a2c65dc563f3d7c0678ef82b91601351d2
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119993804"
---
# <a name="classes-and-servers"></a>Классы и серверы

COM использует **\_ \_ корневые классы hKey** для параметров на уровне компьютера, но также позволяет настраивать идентификаторы CLSID для каждого пользователя для повышения безопасности и гибкости. Сначала модель COM обращается к **\_ \_ \\ \\ классам текущего пользовательского программного обеспечения hKey** , прежде чем искать их в **\_ \_ корне классов hKey**. COM хранит сведения о компьютере, относящиеся к CLSID в **\_ \_ корневом \\ CLSID классов hKey** , и сохраняет сведения о классе для каждого пользователя в разделе **hKey \_ Current \_ user \\ Software \\ Classes \\ CLSID**.

Серверы COM поддерживают самостоятельную регистрацию. Для внутрипроцессного сервера это означает, что библиотека DLL должна экспортировать следующие функции:

-   [**Регистрация**](/windows/win32/api/olectl/nf-olectl-dllregisterserver)
-   [**DllUnregisterServer**](/windows/win32/api/olectl/nf-olectl-dllunregisterserver)

Эти функции необходимо экспортировать явным образом с помощью файла определения модуля, переключателей компоновщика или директив компилятора. Хранилище классов использует эти функции для настройки локального реестра после загрузки файла на клиентский компьютер. В дополнение к хранилищу классов эти функции также используются другими средами для установки серверов на ведущих компьютерах.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Регистрация приложений COM](registering-com-applications.md)
</dt> </dl>

 

 