---
title: Преобразование в Visual Basic из C++
description: Преобразование в Visual Basic из C++
ms.assetid: fce7ea25-cb24-4cc4-8f36-0e8aed2f3ada
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ffba519cbdb0305fe3a2eae4cc8e658fdde1eac3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105654241"
---
# <a name="translating-to-visual-basic-from-c"></a>Преобразование в Visual Basic из C++

Используя язык программирования C++, разработчики могут напрямую обращаться к памяти, в которой хранится определенная переменная. Указатели памяти обеспечивают прямой доступ. В Visual Basic указатели обрабатываются самостоятельно. Например, параметр, объявленный как указатель на **int** в C++, эквивалентен параметру, объявленному в Visual Basic как  **целое число** **ByRef**.

Параметр, объявленный **как String** в Visual Basic, объявляется как указатель на **BSTR** в C++. Установка указателя строки на **null** в C++ эквивалентна установке строки константы **вбнуллстринг** в Visual Basic. Передача строки нулевой длины ("") в функцию, предназначенную для получения **значения NULL** , не работает, так как она передает указатель на строку нулевой длины вместо нулевого указателя.

C++ поддерживает контейнеры данных, а именно структуры и объединения, не имеющие эквивалента в ранних версиях Visual Basic. По этой причине COM-объекты обычно переносят информацию, которая обычно хранится в структурах и объединениях в классах объектов. Однако некоторые COM-объекты могут содержать структуры, что приводит к недоступности частей методов или функций объекта к Visual Basic.

Некоторые типы данных C++ не поддерживаются в Visual Basic, например неподписанные типы и типы **HWND** . Методы, которые принимают или возвращают эти типы данных, недоступны в Visual Basic.

В Visual Basic в качестве внутренних типов данных используются совместимые с автоматизацией типы данных. Поэтому типы данных C++, совместимые с автоматизацией, также совместимы с Visual Basic. Типы данных, несовместимые с автоматизацией, не могут быть преобразованы в Visual Basic.

В следующей таблице перечислены типы данных, поддерживаемые Visual Basic и их эквиваленты **VarType** . **VarType** — это перечисление, в котором перечислены типы вариантов автоматизации.



| Тип данных в Visual Basic  | Эквивалент VARTYPE                |
|-------------------------|-----------------------------------|
| **Integer**<br/>  | 16 бит, со знаком, VT \_ I2<br/> |
| **Long**<br/>     | 32 бит, с подписью, VT \_ I4<br/> |
| **Дата**<br/>     | \_Дата VT<br/>               |
| **Денежный формат**<br/> | VT \_ CY<br/>                 |
| **Объект**<br/>   | \*\_Диспетчер VT<br/>         |
| **String**<br/>   | VT \_ BSTR<br/>               |
| **Boolean**<br/>  | Логическое значение VT \_<br/>               |
| **Денежный формат**<br/> | VT \_ Decimal<br/>            |
| **Single**<br/>   | VT \_ R4<br/>                 |
| **Double**<br/>   | VT \_ R8<br/>                 |
| **Десятичное число**<br/>  | VT \_ Decimal<br/>            |
| **Byte**<br/>     | VT \_ Decimal<br/>            |
| **Значение**<br/>  | \_вариант VT<br/>            |



 

Все параметры в Visual Basic, кроме ключевого слова **ByVal**, передаются по ссылке (как указатели), а не по значению.

C++ и Visual Basic немного отличаются в том, как они представляют свойства. В C++ свойства представлены в виде набора функций доступа, который задает значение свойства и одно из них, которое получает значение свойства. В Visual Basic свойства представлены как один элемент, который можно использовать для получения или задания значения свойства.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Перевод в Visual Basic](translating-to-visual-basic.md)
</dt> </dl>

 

 





