---
title: локальная служба.
description: Устанавливает объект как приложение службы.
ms.assetid: e8086118-f956-4cc2-a0fb-3cebd2e66799
keywords:
- Значение реестра LocalService — COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e454566ac505907f66fad585062bc67f41c865df45b30405b83e5faadef7f9f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117736470"
---
# <a name="localservice"></a>локальная служба.

Устанавливает объект как приложение службы.

## <a name="registry-entry"></a>Запись реестра

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      LocalService = name
```

## <a name="remarks"></a>Remarks

Помимо запуска в качестве исполняемого файла локального сервера (EXE), COM-объект может также выбрать сам пакет для запуска в качестве приложения службы при активации с помощью локального или удаленного клиента. Службы поддерживают многочисленные полезные функции администрирования, интегрированные с интерфейсом пользователя, включая локальные и удаленные запуски, остановку, приостановку и перезапуск, а также возможность установить сервер для работы под определенной учетной записью пользователя и с помощью оконной станции.

Объект, написанный как служба, устанавливается для использования в COM путем установки значения **LocalService** и выполнения стандартной установки службы. Для параметра **LocalService** должно быть задано имя службы, настроенное в **\_ \_ \\ \\ CurrentControlSet \\ Services System локального компьютера**, в качестве значения **reg \_ SZ** по умолчанию.

Если задана **Локальная** служба, любая строка, назначенная [**сервицепараметерс**](serviceparameters.md) , передается в качестве аргумента командной строки в службу при запуске.

Конфигурация службы является предпочтительной во многих ситуациях, когда возможности локальных и удаленных интерфейсов API управления службами и пользовательского интерфейса могут быть полезны для служб, предоставляемых объектом. Например, использование существующей административной структуры архитектуры службы должна быть очевидным выбором, если объект является длительным или полностью поддерживает такие концепции, как запуск, остановка, сброс или приостановка.

Службы могут быть настроены динамически и могут быть настроены для автоматического запуска при загрузке компьютера или запуска по запросу клиентского приложения.

При реализации классов в качестве служб следует учитывать следующие моменты.

-   Это значение используется в качестве параметра для ключа [**LocalServer32**](localserver32.md) для локальной и удаленной активации рекуестсâ € **' если существует** и ссылается на допустимую службу, ключ **LocalServer32** игнорируется.
-   В настоящее время на компьютере может выполняться только один экземпляр приложения службы. Поэтому службы COM должны зарегистрировать объекты класса при запуске с помощью РЕГКЛС \_ мултиплеусе для поддержки нескольких клиентов.
-   Для правильного запуска и инициализации службы COM, настроенные для автоматического запуска при загрузке компьютера, должны содержать службы RPCSS в списке зависимых служб.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Регистрация серверов COM](registering-com-servers.md)
</dt> <dt>

[**сервицепараметерс**](serviceparameters.md)
</dt> <dt>

[Службы](/windows/desktop/Services/services)
</dt> </dl>

 

 