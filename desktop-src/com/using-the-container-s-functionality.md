---
title: Использование функциональных возможностей контейнера
description: Использование функциональных возможностей контейнера
ms.assetid: c660e529-ba1e-4f8e-a86b-7580fa1f592b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3afb03ddef96125db184d6e8774997fccf99063b
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070708"
---
# <a name="using-the-containers-functionality"></a><span data-ttu-id="39060-103">Использование функциональных возможностей контейнера</span><span class="sxs-lookup"><span data-stu-id="39060-103">Using the Container's Functionality</span></span>

<span data-ttu-id="39060-104">В предыдущих разделах были описаны некоторые из необходимых средств поддержки на стороне клиента, которые должен иметь элемент управления ActiveX для доступа к определенным функциям своего контейнера.</span><span class="sxs-lookup"><span data-stu-id="39060-104">The previous sections have described some of the necessary caller-side support that an ActiveX control must have in order to access certain features of its container.</span></span> <span data-ttu-id="39060-105">В следующей таблице описывается использование интерфейсов на стороне контейнера и при возникновении такого использования.</span><span class="sxs-lookup"><span data-stu-id="39060-105">The following table describes a control's usage of container-side interfaces and when such usage would occur.</span></span>



| <span data-ttu-id="39060-106">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="39060-106">Interface</span></span>                                                     | <span data-ttu-id="39060-107">Объект контейнера</span><span class="sxs-lookup"><span data-stu-id="39060-107">Container Object</span></span>    | <span data-ttu-id="39060-108">Использование</span><span class="sxs-lookup"><span data-stu-id="39060-108">Usage</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------------------------------------------------------|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="39060-109">**иолеклиентсите**</span><span class="sxs-lookup"><span data-stu-id="39060-109">**IOleClientSite**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)<br/>           | <span data-ttu-id="39060-110">Сайт</span><span class="sxs-lookup"><span data-stu-id="39060-110">Site</span></span><br/>     | <span data-ttu-id="39060-111">Элементы управления, реализующие [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) , вызывают [**иолеклиентсите**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite) методы в рамках стандартного протокола внедрения OLE, в частности методы [**савеобжект**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-saveobject), [**шовобжект**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-showobject), [**оншоввиндов**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-onshowwindow) (только если поддерживается состояние активации отдельного окна), [**рекуестневобжектлайаут**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout)и (если требуется обмен данными с другими элементами управления).</span><span class="sxs-lookup"><span data-stu-id="39060-111">Controls that implement [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) call [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite) methods as part of the standard OLE embedding protocol, specifically the methods [**SaveObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-saveobject), [**ShowObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-showobject), [**OnShowWindow**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-onshowwindow) (only if a separate-window activation state is supported), [**RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout), and GetContainer (if communication with other controls is desired).</span></span> <span data-ttu-id="39060-112">Метод [**WebMethod используется**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-getmoniker) только в том случае, если элемент управления может быть связан с внешним, то есть элемент управления не помечается с помощью олемиск \_ кантлинкинсиде.</span><span class="sxs-lookup"><span data-stu-id="39060-112">The [**GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-getmoniker) method is only used when the control can be linked to externally, that is, the control is not marked with OLEMISC\_CANTLINKINSIDE.</span></span><br/> |
| [<span data-ttu-id="39060-113">**иолеинплацесите**</span><span class="sxs-lookup"><span data-stu-id="39060-113">**IOleInPlaceSite**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite)<br/>         | <span data-ttu-id="39060-114">Сайт</span><span class="sxs-lookup"><span data-stu-id="39060-114">Site</span></span><br/>     | <span data-ttu-id="39060-115">Элементы управления, которые выполняют активацию на месте и, возможно, активное состояние пользовательского интерфейса, будут вызывать методы [**иолеинплацесите**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite) (обычно все они с исключением [**контекстсенситивехелп**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)) в рамках стандартного протокола внутренней активации OLE.</span><span class="sxs-lookup"><span data-stu-id="39060-115">Controls that have an in-place activate and possibly a UI active state will call [**IOleInPlaceSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite) methods (generally all of them with the exception of [**ContextSensitiveHelp**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)) as part of the standard OLE in-place activation protocol.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="39060-116">**иадвисесинк**</span><span class="sxs-lookup"><span data-stu-id="39060-116">**IAdviseSink**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)<br/>                 | <span data-ttu-id="39060-117">Сайт</span><span class="sxs-lookup"><span data-stu-id="39060-117">Site</span></span><br/>     | <span data-ttu-id="39060-118">Control вызывает [**ондатачанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) , если элемент управления поддерживает [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**онвиевчанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) , если элемент управления поддерживает [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), и [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose), [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)и [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename) , если элемент управления поддерживает [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).</span><span class="sxs-lookup"><span data-stu-id="39060-118">Control calls [**OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) if the control supports [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) if the control supports [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), and [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose), [**OnSave**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave), and [**OnRename**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename) if the control supports [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).</span></span><br/>                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="39060-119">**IOleControlSite**</span><span class="sxs-lookup"><span data-stu-id="39060-119">**IOleControlSite**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrolsite)<br/>         | <span data-ttu-id="39060-120">Сайт</span><span class="sxs-lookup"><span data-stu-id="39060-120">Site</span></span><br/>     | <span data-ttu-id="39060-121">Если поддерживается, управление вызывает [**онконтролинфочанжед**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) при изменении назначенных клавиш, [**локкинплацеактиве**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) и [**трансформкурдс**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) при срабатывании событий (второй метод используется только в том случае, если координаты передаются как аргументы события), [**onfocus**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-onfocus) и [**TranslateAccelerator**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator) , если элемент управления имеет активное состояние пользовательского интерфейса, и [**жетекстендедконтрол**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-getextendedcontrol) , если элементу управления требуется просмотреть свойства, принадлежащие расширенному контролю (принадлежащее контейнеру).</span><span class="sxs-lookup"><span data-stu-id="39060-121">If supported, control calls [**OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) when mnemonics change, [**LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) and [**TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) if events are fired (the latter method is only used if coordinates are passed as event arguments), [**OnFocus**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-onfocus) and [**TranslateAccelerator**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator) if the control has a UI active state, and [**GetExtendedControl**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-getextendedcontrol) if the control wants to look at extended-control (container-owned) properties.</span></span><br/>                                                                       |
| <span data-ttu-id="39060-122">**IDispatch** (свойства окружения)</span><span class="sxs-lookup"><span data-stu-id="39060-122">**IDispatch** (ambient properties)</span></span><br/>                 | <span data-ttu-id="39060-123">Сайт</span><span class="sxs-lookup"><span data-stu-id="39060-123">Site</span></span><br/>     | <span data-ttu-id="39060-124">Используется для доступа к внешним свойствам.</span><span class="sxs-lookup"><span data-stu-id="39060-124">Used to access ambient properties.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="39060-125">**ипропертинотифисинк**</span><span class="sxs-lookup"><span data-stu-id="39060-125">**IPropertyNotifySink**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink)<br/> | <span data-ttu-id="39060-126">Различается</span><span class="sxs-lookup"><span data-stu-id="39060-126">Varies</span></span><br/>   | <span data-ttu-id="39060-127">Элемент управления должен создавать [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) и [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) для всех свойств элемента управления, которые помечены как \[ [**связываемые**](/windows/desktop/Midl/bindable) \] и \[ [**запрашиваются**](/windows/desktop/Midl/requestedit) \] соответственно.</span><span class="sxs-lookup"><span data-stu-id="39060-127">A control must generate [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) and [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) for any control properties that are marked as \[[**bindable**](/windows/desktop/Midl/bindable)\] and \[[**request**](/windows/desktop/Midl/requestedit)\], respectively.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="39060-128">Другие интерфейсы приемника событий</span><span class="sxs-lookup"><span data-stu-id="39060-128">Other event sink interfaces</span></span><br/>                        | <span data-ttu-id="39060-129">Различается</span><span class="sxs-lookup"><span data-stu-id="39060-129">Varies</span></span><br/>   | <span data-ttu-id="39060-130">Элемент управления с исходящими интерфейсами, отличными от [**ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) , будет переносить другие указатели интерфейса правильного идентификатора IID в реализации метода [**IConnectionPoint:: Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) элемента управления (которые обычно находятся в подобъектах элемента управления).</span><span class="sxs-lookup"><span data-stu-id="39060-130">A control that has outgoing interfaces other than [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) will be handed other interface pointers of the correct IID to the control's [**IConnectionPoint::Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) implementations (which are usually found in sub-objects of the control).</span></span> <span data-ttu-id="39060-131">Элемент управления всегда знает, как вызывать собственные интерфейсы событий, поскольку элемент управления определяет эти интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="39060-131">A control always knows how to call its own event interfaces because the control defines those interfaces.</span></span><br/>                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="39060-132">**иолеинплацефраме**</span><span class="sxs-lookup"><span data-stu-id="39060-132">**IOleInPlaceFrame**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceframe)<br/>       | <span data-ttu-id="39060-133">Frame</span><span class="sxs-lookup"><span data-stu-id="39060-133">Frame</span></span><br/>    | <span data-ttu-id="39060-134">Используется, когда элемент управления имеет активное состояние пользовательского интерфейса на месте, для которого требуются инструменты уровня кадров или пункты меню.</span><span class="sxs-lookup"><span data-stu-id="39060-134">Used when a control has an in-place UI active state that requires frame-level tools or menu items.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="39060-135">**иолеинплацеуивиндов**</span><span class="sxs-lookup"><span data-stu-id="39060-135">**IOleInPlaceUIWindow**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceuiwindow)<br/> | <span data-ttu-id="39060-136">Документ</span><span class="sxs-lookup"><span data-stu-id="39060-136">Document</span></span><br/> | <span data-ttu-id="39060-137">Используется только в том случае, если элемент управления имеет активное состояние пользовательского интерфейса на месте, для которого требуются средства пользовательского интерфейса на уровне документа или на уровне панели.</span><span class="sxs-lookup"><span data-stu-id="39060-137">Used only when a control has an in-place UI active state that requires document-level or pane-level UI tools.</span></span> <span data-ttu-id="39060-138">Это случается редко.</span><span class="sxs-lookup"><span data-stu-id="39060-138">This is rare.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |



 

## <a name="related-topics"></a><span data-ttu-id="39060-139">См. также</span><span class="sxs-lookup"><span data-stu-id="39060-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="39060-140">Элементы управления</span><span class="sxs-lookup"><span data-stu-id="39060-140">Controls</span></span>](controls.md)
</dt> </dl>

 

