---
title: Обработчик OLE
description: Обработчик OLE — это библиотека DLL, содержащая несколько взаимодействующих компонентов, используемых для связывания и внедрения.
ms.assetid: 5a01b4be-38cf-4019-ba20-ee67b836a3e0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb9579f18b44a36a794ff807d9d616dd3a06dd1b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104068045"
---
# <a name="the-ole-handler"></a><span data-ttu-id="24218-103">Обработчик OLE</span><span class="sxs-lookup"><span data-stu-id="24218-103">The OLE Handler</span></span>

<span data-ttu-id="24218-104">*Обработчик OLE* — это библиотека DLL, содержащая несколько взаимодействующих компонентов, используемых для связывания и внедрения.</span><span class="sxs-lookup"><span data-stu-id="24218-104">An *OLE handler* is a DLL containing several interacting components used for linking and embedding.</span></span> <span data-ttu-id="24218-105">Чтобы избежать затрат на постоянный обмен данными между контейнером и сервером, обработчик загружается в пространство процесса контейнера для выполнения от имени сервера в качестве типа суррогатного процесса.</span><span class="sxs-lookup"><span data-stu-id="24218-105">To avoid the expense of constant interprocess communication between a container and its server, the handler is loaded into the container's process space to act on behalf of a server as a sort of surrogate process.</span></span> <span data-ttu-id="24218-106">Обработчик OLE управляет запросами контейнеров, которые не требуют внимания к серверному приложению, например запросы на рисование.</span><span class="sxs-lookup"><span data-stu-id="24218-106">The OLE handler manages container requests that do not require the attention of the server application, such as requests for drawing.</span></span> <span data-ttu-id="24218-107">Когда контейнер запрашивает, что обработчик объектов не может предоставить, обработчик взаимодействует с серверным приложением, используя механизм взаимодействия COM вне процесса.</span><span class="sxs-lookup"><span data-stu-id="24218-107">When a container requests something that the object handler cannot provide, the handler communicates with the server application using the COM out-of-process communication mechanism.</span></span>

<span data-ttu-id="24218-108">Компоненты обработчика OLE включают удаленные части для управления взаимодействием между обработчиком и его сервером, кэш для хранения данных объекта (вместе с информацией о том, как следует форматировать и отображать данные) и управляющий объект, который координирует действия других компонентов библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="24218-108">The OLE handler components include remoting pieces to manage communication between the handler and its server, a cache for storing an object's data (along with information on how that data should be formatted and displayed), and a controlling object that coordinates the activities of the DLL's other components.</span></span> <span data-ttu-id="24218-109">Кроме того, если объект является ссылкой, Библиотека DLL также включает компонент связывания или *связанный объект*, который отслеживает имя и расположение источника ссылки.</span><span class="sxs-lookup"><span data-stu-id="24218-109">In addition, if an object is a link, the DLL also includes a linking component, or *linked object*, which keeps track of the name and location of the link source.</span></span>

<span data-ttu-id="24218-110">OLE предоставляет обработчик по умолчанию, который большинство приложений используют для связывания и внедрения.</span><span class="sxs-lookup"><span data-stu-id="24218-110">OLE provides a default handler that most applications use for linking and embedding.</span></span> <span data-ttu-id="24218-111">Если значение по умолчанию не соответствует требованиям сервера, можно либо полностью заменить обработчик по умолчанию, либо использовать части предоставляемых им функций, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="24218-111">If the default does not match the requirements of your server, you can either completely replace the default handler or use parts of the functionality it provides where appropriate.</span></span> <span data-ttu-id="24218-112">В последнем случае обработчик приложения реализуется как агрегатный объект, состоящий из нового управляющего объекта и обработчика по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="24218-112">In the latter case, the application handler is implemented as an aggregate object composed of a new control object and the default handler.</span></span> <span data-ttu-id="24218-113">Сочетания приложений и обработчиков по умолчанию также называются *внутрипроцессный обработчиками*.</span><span class="sxs-lookup"><span data-stu-id="24218-113">Combination application/default handlers are also known as *in-process handlers*.</span></span> <span data-ttu-id="24218-114">*Обработчик удаленного взаимодействия* используется для объектов, которым не назначен CLSID в системном реестре или которые не имеют указанного обработчика.</span><span class="sxs-lookup"><span data-stu-id="24218-114">The *remoting handler* is used for objects that are not assigned a CLSID in the system registry or that have no specified handler.</span></span> <span data-ttu-id="24218-115">Все, что требуется из обработчика для этих типов объектов, заключается в том, что они передают информацию через границу процесса.</span><span class="sxs-lookup"><span data-stu-id="24218-115">All that is required from a handler for these types of objects is that they pass information across the process boundary.</span></span> <span data-ttu-id="24218-116">Чтобы создать новый экземпляр обработчика по умолчанию, вызовите метод [**олекреатедефаулсандлер**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler).</span><span class="sxs-lookup"><span data-stu-id="24218-116">To create a new instance of the default handler, call [**OleCreateDefaultHandler**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler).</span></span> <span data-ttu-id="24218-117">В некоторых особых обстоятельствах вызовите [**олекреатимбеддингхелпер**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).</span><span class="sxs-lookup"><span data-stu-id="24218-117">For some special circumstances, call [**OleCreateEmbeddingHelper**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).</span></span>

<span data-ttu-id="24218-118">При создании экземпляра обработчика для одного класса его нельзя использовать для другого.</span><span class="sxs-lookup"><span data-stu-id="24218-118">When you create an instance of a handler for one class, you cannot use it for another.</span></span> <span data-ttu-id="24218-119">При использовании для составного документа обработчик OLE реализует структуры данных на стороне контейнера, когда доступ к объектам определенного класса осуществляется удаленно.</span><span class="sxs-lookup"><span data-stu-id="24218-119">When used for a compound document, the OLE handler implements the container-side data structures when objects of a particular class are accessed remotely.</span></span>

<span data-ttu-id="24218-120">OLE заданный по умолчанию обработчик для клиентов составного документа локальных серверов.</span><span class="sxs-lookup"><span data-stu-id="24218-120">OLE defined the default handler for clients of compound document local servers.</span></span> <span data-ttu-id="24218-121">Обработчик по умолчанию реализовал ряд интерфейсов, которых нет на стандартном сервере.</span><span class="sxs-lookup"><span data-stu-id="24218-121">The default handler implemented a number of interfaces that the typical server did not.</span></span> <span data-ttu-id="24218-122">Когда OLE в дальнейшем позволяло обрабатывать составные документы на серверах, им пришлось создать вспомогательный модуль внедрения, который реализовал эти дополнительные интерфейсы, чтобы клиенты могли беспрепятственно работать с ними.</span><span class="sxs-lookup"><span data-stu-id="24218-122">When OLE subsequently allowed in-process servers for compound documents, they had to create an embedding helper that implemented these extra interfaces so that clients could seamlessly work with them.</span></span>

<span data-ttu-id="24218-123">Конструкторы платформы, которые определяют и реализуют обработчик на стороне клиента, должны учитывать эту ошибку в своем проекте и должны предоставлять эквивалентный внутрипроцессный вспомогательный метод по тем же причинам.</span><span class="sxs-lookup"><span data-stu-id="24218-123">Framework designers that define and implement a client-side handler should consider this issue in their design and should provide an equivalent in-process helper for the same reasons.</span></span> <span data-ttu-id="24218-124">Даже если конструкторы не реализуют интерфейсы в обработчике, который не предоставляет серверы, им может потребоваться определить вспомогательную функцию, чтобы они могли добавлять их в будущем.</span><span class="sxs-lookup"><span data-stu-id="24218-124">Even if the designers currently don't implement interfaces on the handler that the servers don't expose, they may want to define a helper now so that they can add them in the future.</span></span> <span data-ttu-id="24218-125">Кроме того, можно реализовать дополнительные интерфейсы для самого объекта сервера.</span><span class="sxs-lookup"><span data-stu-id="24218-125">Alternatively, one could implement the extra interfaces on the server object itself.</span></span>

## <a name="related-topics"></a><span data-ttu-id="24218-126">См. также</span><span class="sxs-lookup"><span data-stu-id="24218-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="24218-127">Упрощенный обработчик Client-Side</span><span class="sxs-lookup"><span data-stu-id="24218-127">The Lightweight Client-Side Handler</span></span>](the-lightweight-client-side-handler.md)
</dt> </dl>

 

 




