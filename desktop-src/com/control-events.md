---
title: События элемента управления (COM)
description: Помимо предоставления свойств и методов, элемент управления также предоставляет исходящие интерфейсы для уведомления клиента о событиях.
ms.assetid: e7085bc0-c087-4cc8-9c69-ba05b0923b74
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1833e1396847e09366d1e06193196cfcf981d330
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104070975"
---
# <a name="control-events-com"></a><span data-ttu-id="12e16-103">События элемента управления (COM)</span><span class="sxs-lookup"><span data-stu-id="12e16-103">Control Events (COM)</span></span>

<span data-ttu-id="12e16-104">Помимо предоставления свойств и методов, элемент управления также предоставляет исходящие интерфейсы для уведомления клиента о событиях.</span><span class="sxs-lookup"><span data-stu-id="12e16-104">In addition to providing properties and methods, a control also provides outgoing interfaces to notify its client of events.</span></span> <span data-ttu-id="12e16-105">Клиент должен поддерживать обработку этих событий.</span><span class="sxs-lookup"><span data-stu-id="12e16-105">The client must support handling of these events.</span></span> <span data-ttu-id="12e16-106">Дополнительные сведения о том, как работают подключаемые объекты, см. [в разделе события в com и Connected Objects](events-in-com-and-connectable-objects.md) .</span><span class="sxs-lookup"><span data-stu-id="12e16-106">See [Events in COM and Connectable Objects](events-in-com-and-connectable-objects.md) for more information on how connectable objects work.</span></span>

<span data-ttu-id="12e16-107">Элемент управления может поддерживать различные исходящие интерфейсы для разных целей.</span><span class="sxs-lookup"><span data-stu-id="12e16-107">A control can support different outgoing interfaces for different purposes.</span></span> <span data-ttu-id="12e16-108">Все исходящие интерфейсы помечаются как исходные интерфейсы в сведениях о типе элемента управления, но только один из них помечается по умолчанию, чтобы указать, что это основной исходящий интерфейс.</span><span class="sxs-lookup"><span data-stu-id="12e16-108">All outgoing interfaces are marked as source interfaces in the control's type information, but only one is marked default to indicate that it is the primary outgoing interface.</span></span>

<span data-ttu-id="12e16-109">Контейнер может поддерживать один или несколько исходящих интерфейсов, определенных элементом управления.</span><span class="sxs-lookup"><span data-stu-id="12e16-109">A container can support one or more of the outgoing interfaces defined by a control.</span></span> <span data-ttu-id="12e16-110">Элемент управления должен быть готов к работе с контейнерами, которые обеспечивают поддержку только некоторых исходящих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="12e16-110">The control should be prepared to deal with containers that only provide support for some of their outgoing interfaces.</span></span>

<span data-ttu-id="12e16-111">Элементы управления поддерживают четыре типа событий:</span><span class="sxs-lookup"><span data-stu-id="12e16-111">Controls support four kinds of events:</span></span>

-   <span data-ttu-id="12e16-112">События запроса.</span><span class="sxs-lookup"><span data-stu-id="12e16-112">Request events.</span></span> <span data-ttu-id="12e16-113">Элемент управления запрашивает разрешение от своего клиента для того, чтобы сделать что-то путем вызова метода в исходящем интерфейсе, тем самым запуская событие запроса.</span><span class="sxs-lookup"><span data-stu-id="12e16-113">A control requests permission from its client to do something by calling a method in the outgoing interface, thus triggering a request event.</span></span> <span data-ttu-id="12e16-114">Клиент передает элемент управления по логическому параметру out в методе, вызванном элементом управления.</span><span class="sxs-lookup"><span data-stu-id="12e16-114">The client signals the control through a boolean, out-parameter in the method that the control called.</span></span> <span data-ttu-id="12e16-115">Таким же клиентом можно предотвратить выполнение действия элементом управления.</span><span class="sxs-lookup"><span data-stu-id="12e16-115">The client can thus prevent the control from performing the action.</span></span>
-   <span data-ttu-id="12e16-116">События до.</span><span class="sxs-lookup"><span data-stu-id="12e16-116">Before events.</span></span> <span data-ttu-id="12e16-117">Элемент управления уведомляет клиента о необходимости выполнения действий путем вызова метода в исходящем интерфейсе, что приводит к срабатыванию события Before.</span><span class="sxs-lookup"><span data-stu-id="12e16-117">A control notifies its client hat it is going to do something by calling a method in the outgoing interface, thus triggering a before event.</span></span> <span data-ttu-id="12e16-118">Клиент не имеет возможности предотвращать действие, но может предпринять все необходимые действия, заданные выполняемым действием.</span><span class="sxs-lookup"><span data-stu-id="12e16-118">The client does not have the opportunity to prevent the action, but it can take any necessary steps given the action that is about to occur.</span></span>
-   <span data-ttu-id="12e16-119">После событий.</span><span class="sxs-lookup"><span data-stu-id="12e16-119">After events.</span></span> <span data-ttu-id="12e16-120">Элемент управления уведомляет своего клиента о том, что он только что выполнил действие путем вызова метода в исходящем интерфейсе, тем самым запуская события After.</span><span class="sxs-lookup"><span data-stu-id="12e16-120">A control notifies its client that it has just done something by calling a method in the outgoing interface, thus triggering an after event.</span></span> <span data-ttu-id="12e16-121">Опять же, клиент не может отменить это действие, но может выполнить необходимые действия, заданные в ходе выполнения действия.</span><span class="sxs-lookup"><span data-stu-id="12e16-121">Again, the client cannot cancel this action, but it can take necessary steps given the action that has occurred.</span></span>
-   <span data-ttu-id="12e16-122">События Do.</span><span class="sxs-lookup"><span data-stu-id="12e16-122">Do events.</span></span> <span data-ttu-id="12e16-123">Элемент управления активирует событие Do, чтобы позволить клиенту переопределить действие элемента управления и предоставить некоторые альтернативные или дополнительные действия.</span><span class="sxs-lookup"><span data-stu-id="12e16-123">A control triggers a do event to allow its client to override the control's action and provide some alternative or supplementary actions.</span></span> <span data-ttu-id="12e16-124">Как правило, метод, который вызывает элемент управления для события Do, имеет ряд параметров для согласования с клиентом о действиях, которые будут выполнены.</span><span class="sxs-lookup"><span data-stu-id="12e16-124">Usually, the method that a control calls for a do event has a number of parameters for negotiating with the client about the actions that will occur.</span></span>

<span data-ttu-id="12e16-125">Следующие идентификаторы DISPID определены для стандартных событий, которые могут поддерживаться элементами управления: щелчок, двойное нажатие, Клавиша вниз, нажатие клавиши, KeyUp, MouseMove, MouseUp и ошибка.</span><span class="sxs-lookup"><span data-stu-id="12e16-125">The following dispids are defined for standard events that controls can support: Click, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp, and Error.</span></span> <span data-ttu-id="12e16-126">Все эти стандартные события имеют отрицательные значения DISPID, указывающие их стандартное состояние.</span><span class="sxs-lookup"><span data-stu-id="12e16-126">All of these standard events have negative DISPID values, indicating their standard status.</span></span>

<span data-ttu-id="12e16-127">Метод [**метод интерфейса IOleControl:: FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) , когда вызывается со значением **true**, сообщает элементу управления, будет ли контейнер обрабатывать события из элемента управления до тех пор, пока **FreezeEvents** снова не будет вызываться с параметром **false**.</span><span class="sxs-lookup"><span data-stu-id="12e16-127">The [**IOleControl::FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) method, when called with **TRUE**, tells a control whether the container will bother handling events from the control until **FreezeEvents** is again called with **FALSE**.</span></span> <span data-ttu-id="12e16-128">В течение этого времени Управление не может зависеть от контейнера, который фактически обрабатывает любые события.</span><span class="sxs-lookup"><span data-stu-id="12e16-128">During this time control cannot depend on the container actually handling any events.</span></span> <span data-ttu-id="12e16-129">Если событие должно быть обработано, элемент управления должен поставить событие в очередь, чтобы его можно было запускать, когда **FreezeEvents** вызывается с параметром **false**.</span><span class="sxs-lookup"><span data-stu-id="12e16-129">If an event must be handled, the control should queue the event in order to fire it when **FreezeEvents** is called with **FALSE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="12e16-130">См. также</span><span class="sxs-lookup"><span data-stu-id="12e16-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="12e16-131">Элементы управления ActiveX</span><span class="sxs-lookup"><span data-stu-id="12e16-131">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




