---
title: Связанные объекты и моникеры
description: Связанные объекты, например внедренные объекты, используют обработчик объектов для взаимодействия с серверными приложениями.
ms.assetid: f72557b9-cd24-4d96-8144-94a5344ec2ae
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7c14f4cc74ee84fbf745e730d77203ebb4f43b0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104258921"
---
# <a name="linked-objects-and-monikers"></a><span data-ttu-id="39d9c-103">Связанные объекты и моникеры</span><span class="sxs-lookup"><span data-stu-id="39d9c-103">Linked Objects and Monikers</span></span>

<span data-ttu-id="39d9c-104">Связанные объекты, например внедренные объекты, используют обработчик объектов для взаимодействия с серверными приложениями.</span><span class="sxs-lookup"><span data-stu-id="39d9c-104">Linked objects, like embedded objects, rely on an object handler to communicate with server applications.</span></span> <span data-ttu-id="39d9c-105">Однако связанный объект управляет наименованием и отслеживанием источников ссылок.</span><span class="sxs-lookup"><span data-stu-id="39d9c-105">The linked object itself, however, manages the naming and tracking of link sources.</span></span> <span data-ttu-id="39d9c-106">Связанный объект выступает в качестве внутрипроцессного сервера.</span><span class="sxs-lookup"><span data-stu-id="39d9c-106">The linked object acts like an in-process server.</span></span> <span data-ttu-id="39d9c-107">Например, при активации связанный объект находит и запускает приложение OLE-сервера, которое является источником связи.</span><span class="sxs-lookup"><span data-stu-id="39d9c-107">For example, when activated, a linked object locates and launches the OLE server application that is the link source.</span></span>

<span data-ttu-id="39d9c-108">Обработчик связанного объекта состоит из двух основных компонентов: компонента обработчика и компонента связывания.</span><span class="sxs-lookup"><span data-stu-id="39d9c-108">A linked object's handler is made up of two main components: the handler component and the linking component.</span></span> <span data-ttu-id="39d9c-109">Компонент обработчика содержит элементы управления и функции удаленного взаимодействия, схожие с обработчиком внедренного объекта.</span><span class="sxs-lookup"><span data-stu-id="39d9c-109">The handler component contains the controlling and remoting pieces and functions much like a handler for an embedded object.</span></span> <span data-ttu-id="39d9c-110">Компонент связывания имеет собственный контроллер и кэш, а также предоставляет доступ к структурированному хранилищу объекта.</span><span class="sxs-lookup"><span data-stu-id="39d9c-110">The linking component has its own controller and cache and provides access to the object's structured storage.</span></span> <span data-ttu-id="39d9c-111">Контроллер связываемых компонентов поддерживает именование источников посредством использования моникеров и привязки, а также процесса поиска и запуска источника ссылки.</span><span class="sxs-lookup"><span data-stu-id="39d9c-111">The linking components controller supports source naming through the use of monikers, and binding, the process of locating and running the link source.</span></span> <span data-ttu-id="39d9c-112">(Дополнительные сведения о моникерах и привязке см. [в разделе Объектная модель компонента](the-component-object-model.md).)</span><span class="sxs-lookup"><span data-stu-id="39d9c-112">(For more information on monikers and binding, see [The Component Object Model](the-component-object-model.md).)</span></span>

<span data-ttu-id="39d9c-113">Когда пользователь первоначально создает связанный объект или загружает существующий из хранилища, контейнер загружает экземпляр компонента связывания в память вместе с обработчиком объектов.</span><span class="sxs-lookup"><span data-stu-id="39d9c-113">When a user initially creates a linked object or loads an existing one from storage, the container loads an instance of the linking component into memory, along with the object handler.</span></span> <span data-ttu-id="39d9c-114">Компонент связывания предоставляет интерфейсы, наиболее особенно [**иолелинк**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink), которые указывают объект как ссылку и позволяют ему управлять именованием, отслеживанием и обновлением источника ссылки.</span><span class="sxs-lookup"><span data-stu-id="39d9c-114">The linking component supplies interfaces — most notably [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink)— that identify the object as a link and enable it to manage the naming, tracking, and updating of its link source.</span></span>

<span data-ttu-id="39d9c-115">При реализации интерфейса [**иолелинк**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink) связанный объект предоставляет свой контейнер с функциями, поддерживающими компоновку.</span><span class="sxs-lookup"><span data-stu-id="39d9c-115">By implementing the [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink) interface, a linked object provides its container with functions that support linking.</span></span> <span data-ttu-id="39d9c-116">Только связанные объекты реализуют **иолелинк**, и, запрашивая этот интерфейс, контейнер может определить, является ли данный объект внедренным или связанным.</span><span class="sxs-lookup"><span data-stu-id="39d9c-116">Only linked objects implement **IOleLink**, and by querying for this interface a container can determine whether a given object is embedded or linked.</span></span> <span data-ttu-id="39d9c-117">Самая важная функция, предоставляемая **иолелинк** , позволяет контейнеру привязаться к источнику связанного объекта, то есть активировать соединение с документом, в котором хранятся собственные данные связанного объекта.</span><span class="sxs-lookup"><span data-stu-id="39d9c-117">The most important function provided by **IOleLink** enables a container to binding to the source of the linked object, that is, to activate the connection to the document that stores the linked object's native data.</span></span> <span data-ttu-id="39d9c-118">**Иолелинк** также определяет функции для управления сведениями о связанном объекте, например кэшированные данные представления и расположение источника ссылки.</span><span class="sxs-lookup"><span data-stu-id="39d9c-118">**IOleLink** also defines functions for managing information about the linked object, such as cached presentation data and the location of the link source.</span></span>

<span data-ttu-id="39d9c-119">При сохранении составного документа, содержащего связанный объект, данные ссылки сохраняются вместе с источником ссылки, а не с контейнером.</span><span class="sxs-lookup"><span data-stu-id="39d9c-119">When a compound document containing a linked object is saved, the link's data is saved with the link source, not with the container.</span></span> <span data-ttu-id="39d9c-120">Вместе с составным документом сохраняются только сведения о его имени и расположении.</span><span class="sxs-lookup"><span data-stu-id="39d9c-120">Only information about its name and location is saved along with the compound document.</span></span> <span data-ttu-id="39d9c-121">Это поведение отличается от внедренного объекта, данные которого хранятся вместе с контейнером.</span><span class="sxs-lookup"><span data-stu-id="39d9c-121">This behavior is in contrast to that of an embedded object, whose data is stored along with that of its container.</span></span>

<span data-ttu-id="39d9c-122">Приложения контейнера могут предоставлять сведения о своих внедренных объектах, так что их последние или части могут действовать как источники связей.</span><span class="sxs-lookup"><span data-stu-id="39d9c-122">Container applications can provide information about their embedded objects such that the latter, or portions thereof, can act as link sources.</span></span> <span data-ttu-id="39d9c-123">Реализуя поддержку связывания с внедренными объектами контейнера, вы делает возможным внедрение вложенных объектов, освобождая разработчика пользователю необходимость в отслеживании оригиналов каждого внедренного объекта, к которому нужна ссылка.</span><span class="sxs-lookup"><span data-stu-id="39d9c-123">By implementing support for linking to your container's embedded objects, you make nested embeddings possible, relieving the user of having to track down the originals of every embedding object to which a link is desired.</span></span> <span data-ttu-id="39d9c-124">Например, если пользователь хочет внедрить лист Microsoft Excel в Microsoft Word, а лист содержит растровое изображение, созданное на кисти, пользователь может создать ссылку на копию точечного рисунка, содержащегося на листе, а не на оригинале.</span><span class="sxs-lookup"><span data-stu-id="39d9c-124">For example, if a user wants to embed a Microsoft Excel worksheet in Microsoft Word, and the worksheet contains a bitmap created in Paintbrush, the user can link to a copy of the bitmap contained in the worksheet rather than the original.</span></span>

## <a name="related-topics"></a><span data-ttu-id="39d9c-125">См. также</span><span class="sxs-lookup"><span data-stu-id="39d9c-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="39d9c-126">Составные документы</span><span class="sxs-lookup"><span data-stu-id="39d9c-126">Compound Documents</span></span>](compound-documents.md)
</dt> <dt>

[<span data-ttu-id="39d9c-127">Внутрипроцессный сервер</span><span class="sxs-lookup"><span data-stu-id="39d9c-127">In-Process Servers</span></span>](in-process-servers.md)
</dt> <dt>

[<span data-ttu-id="39d9c-128">Обработчики объектов</span><span class="sxs-lookup"><span data-stu-id="39d9c-128">Object Handlers</span></span>](object-handlers.md)
</dt> </dl>

 

 




