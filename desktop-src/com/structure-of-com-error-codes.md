---
title: Структура кодов ошибок COM
description: Структура кодов ошибок COM
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb27143f50028592f6fe0aeb5cab9795dcd10d4a
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "104570942"
---
# <a name="structure-of-com-error-codes"></a><span data-ttu-id="47ccd-103">Структура кодов ошибок COM</span><span class="sxs-lookup"><span data-stu-id="47ccd-103">Structure of COM Error Codes</span></span>

<span data-ttu-id="47ccd-104">На следующем рисунке показан формат [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (или SCODE). числа обозначают разрядные позиции:</span><span class="sxs-lookup"><span data-stu-id="47ccd-104">The following illustration shows the format of an [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (or SCODE); the numbers indicate bit positions:</span></span>

![Отображает формат "H RESULT" или "CODE" с числами, указывающими разрядные позиции.](images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png)

<span data-ttu-id="47ccd-106">Бит высокого порядка в **HRESULT** или SCODE указывает, представляет ли возвращаемое значение успешное или неуспешное выполнение.</span><span class="sxs-lookup"><span data-stu-id="47ccd-106">The high-order bit in the **HRESULT** or SCODE indicates whether the return value represents success or failure.</span></span> <span data-ttu-id="47ccd-107">Если задано значение 0, степень серьезности \_ успеха, значение указывает на успешное выполнение.</span><span class="sxs-lookup"><span data-stu-id="47ccd-107">If set to 0, SEVERITY\_SUCCESS, the value indicates success.</span></span> <span data-ttu-id="47ccd-108">Если задано значение 1, ошибка СЕРЬЕЗНОсти \_ указывает на сбой.</span><span class="sxs-lookup"><span data-stu-id="47ccd-108">If set to 1, SEVERITY\_ERROR, it indicates failure.</span></span>

<span data-ttu-id="47ccd-109">Биты R, C, N и r зарезервированы.</span><span class="sxs-lookup"><span data-stu-id="47ccd-109">The R, C, N, and r bits are reserved.</span></span>

<span data-ttu-id="47ccd-110">В поле "оборудование" указывается системная служба, ответственная за ошибку.</span><span class="sxs-lookup"><span data-stu-id="47ccd-110">The facility field indicates the system service responsible for the error.</span></span> <span data-ttu-id="47ccd-111">Корпорация Майкрософт выделяет новые коды устройств по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="47ccd-111">Microsoft allocates new facility codes as they become necessary.</span></span> <span data-ttu-id="47ccd-112">Для большинства Скодес и значений **HRESULT** в поле "средство" задается значение \_ ИТФ, указывающее на ошибку метода интерфейса.</span><span class="sxs-lookup"><span data-stu-id="47ccd-112">Most SCODEs and **HRESULT** values set the facility field to FACILITY\_ITF, indicating an interface method error.</span></span>

<span data-ttu-id="47ccd-113">В следующей таблице описаны общие поля средств.</span><span class="sxs-lookup"><span data-stu-id="47ccd-113">Common facility fields are described in the following table.</span></span>



| <span data-ttu-id="47ccd-114">Поле "ссуда"</span><span class="sxs-lookup"><span data-stu-id="47ccd-114">Facility Field</span></span>                | <span data-ttu-id="47ccd-115">Значение</span><span class="sxs-lookup"><span data-stu-id="47ccd-115">Value</span></span>        | <span data-ttu-id="47ccd-116">Описание</span><span class="sxs-lookup"><span data-stu-id="47ccd-116">Description</span></span>                                                                                                                                                                                                                                                                                                              |
|-------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="47ccd-117">\_Доставка услуг</span><span class="sxs-lookup"><span data-stu-id="47ccd-117">FACILITY\_DISPATCH</span></span><br/> | <span data-ttu-id="47ccd-118">2</span><span class="sxs-lookup"><span data-stu-id="47ccd-118">2</span></span><br/> | <span data-ttu-id="47ccd-119">Для ошибок интерфейса **IDispatch** с поздним связыванием.</span><span class="sxs-lookup"><span data-stu-id="47ccd-119">For late-binding **IDispatch** interface errors.</span></span> <br/>                                                                                                                                                                                                                                                             |
| <span data-ttu-id="47ccd-120">\_ИТФ средства</span><span class="sxs-lookup"><span data-stu-id="47ccd-120">FACILITY\_ITF</span></span><br/>      | <span data-ttu-id="47ccd-121">4</span><span class="sxs-lookup"><span data-stu-id="47ccd-121">4</span></span><br/> | <span data-ttu-id="47ccd-122">Для большинства кодов состояния, возвращаемых методами интерфейса.</span><span class="sxs-lookup"><span data-stu-id="47ccd-122">For most status codes returned from interface methods.</span></span> <span data-ttu-id="47ccd-123">Фактическое значение ошибки определяется интерфейсом.</span><span class="sxs-lookup"><span data-stu-id="47ccd-123">The actual meaning of the error is defined by the interface.</span></span> <span data-ttu-id="47ccd-124">То есть два **HRESULT** с точностью одного и того же 32-разрядного значения, возвращаемого двумя разными интерфейсами, могут иметь разные значения.</span><span class="sxs-lookup"><span data-stu-id="47ccd-124">That is, two **HRESULT** s with exactly the same 32-bit value returned from two different interfaces might have different meanings.</span></span> <br/>                                                       |
| <span data-ttu-id="47ccd-125">СРЕДСТВО \_ со значением NULL</span><span class="sxs-lookup"><span data-stu-id="47ccd-125">FACILITY\_NULL</span></span><br/>     | <span data-ttu-id="47ccd-126">0</span><span class="sxs-lookup"><span data-stu-id="47ccd-126">0</span></span><br/> | <span data-ttu-id="47ccd-127">Для широко применяемых общих кодов состояния, таких как S \_ ОК.</span><span class="sxs-lookup"><span data-stu-id="47ccd-127">For broadly applicable common status codes such as S\_OK.</span></span> <br/>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="47ccd-128">СРЕДСТВО \_ RPC</span><span class="sxs-lookup"><span data-stu-id="47ccd-128">FACILITY\_RPC</span></span><br/>      | <span data-ttu-id="47ccd-129">1</span><span class="sxs-lookup"><span data-stu-id="47ccd-129">1</span></span><br/> | <span data-ttu-id="47ccd-130">Для кодов состояния, возвращаемых удаленными вызовами процедур.</span><span class="sxs-lookup"><span data-stu-id="47ccd-130">For status codes returned from remote procedure calls.</span></span> <br/>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="47ccd-131">\_хранилище устройств</span><span class="sxs-lookup"><span data-stu-id="47ccd-131">FACILITY\_STORAGE</span></span><br/>  | <span data-ttu-id="47ccd-132">3</span><span class="sxs-lookup"><span data-stu-id="47ccd-132">3</span></span><br/> | <span data-ttu-id="47ccd-133">Для кодов состояния, возвращаемых из вызовов методов [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) или [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) , связанных с структурированным хранилищем.</span><span class="sxs-lookup"><span data-stu-id="47ccd-133">For status codes returned from [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) method calls relating to structured storage.</span></span> <span data-ttu-id="47ccd-134">Коды состояния, код (более низкие 16 бит), находятся в диапазоне кодов ошибок MS-DOS (то есть менее 256) имеют то же значение, что и соответствующая ошибка MS-DOS.</span><span class="sxs-lookup"><span data-stu-id="47ccd-134">Status codes whose code (lower 16 bits) value is in the range of MS-DOS error codes (that is, less than 256) have the same meaning as the corresponding MS-DOS error.</span></span> <br/> |
| <span data-ttu-id="47ccd-135">СРЕДСТВО \_ Win32</span><span class="sxs-lookup"><span data-stu-id="47ccd-135">FACILITY\_WIN32</span></span><br/>    | <span data-ttu-id="47ccd-136">7</span><span class="sxs-lookup"><span data-stu-id="47ccd-136">7</span></span><br/> | <span data-ttu-id="47ccd-137">Используется для предоставления средств обработки кодов ошибок из функций в Windows API как **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="47ccd-137">Used to provide a means of handling error codes from functions in the Windows API as an **HRESULT**.</span></span> <span data-ttu-id="47ccd-138">Коды ошибок в 16-разрядных OLE, которые также были изменены с повторяющимися кодами системных ошибок, для устройств \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="47ccd-138">Error codes in 16-bit OLE that duplicated system error codes have also been changed to FACILITY\_WIN32.</span></span> <br/>                                                                                                 |
| <span data-ttu-id="47ccd-139">\_окна средств</span><span class="sxs-lookup"><span data-stu-id="47ccd-139">FACILITY\_WINDOWS</span></span><br/>  | <span data-ttu-id="47ccd-140">8</span><span class="sxs-lookup"><span data-stu-id="47ccd-140">8</span></span><br/> | <span data-ttu-id="47ccd-141">Используется для дополнительных кодов ошибок из интерфейсов, определенных корпорацией Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="47ccd-141">Used for additional error codes from Microsoft-defined interfaces.</span></span><br/>                                                                                                                                                                                                                                            |



 

<span data-ttu-id="47ccd-142">Поле кода является уникальным числом, которое назначается для представления ошибки или предупреждения.</span><span class="sxs-lookup"><span data-stu-id="47ccd-142">The code field is a unique number that is assigned to represent the error or warning.</span></span>

<span data-ttu-id="47ccd-143">По соглашению значения **HRESULT** обычно имеют имена в следующем формате:  \_ *Причина серьезности* устройства \_ .</span><span class="sxs-lookup"><span data-stu-id="47ccd-143">By convention, **HRESULT** values generally have names in the following format: *Facility*\_*Severity*\_*Reason*.</span></span>

<span data-ttu-id="47ccd-144">В качестве *устройства* можно указать имя или другой идентификатор. *Серьезность* — это одиночная буква, S или E, которая указывает, была ли вызов функции выполнен (S) или произошла ошибка (E). и *Причина* — это идентификатор, описывающий значение кода.</span><span class="sxs-lookup"><span data-stu-id="47ccd-144">*Facility* is either the facility name or some other distinguishing identifier; *Severity* is a single letter, S or E, that indicates whether the function call succeeded (S) or produced an error (E); and *Reason* is an identifier that describes the meaning of the code.</span></span> <span data-ttu-id="47ccd-145">Например, код состояния STG \_ E \_ FILENOTFOUND указывает на ошибку, связанную с хранилищем; в частности, запрошенный файл не существует.</span><span class="sxs-lookup"><span data-stu-id="47ccd-145">For example, the status code STG\_E\_FILENOTFOUND indicates a storage-related error has occurred; specifically, a requested file does not exist.</span></span> <span data-ttu-id="47ccd-146">Коды состояния из устройства \_ NULL опускаются префикс *устройства* \_ .</span><span class="sxs-lookup"><span data-stu-id="47ccd-146">Status codes from FACILITY\_NULL omit the *Facility*\_ prefix.</span></span>

<span data-ttu-id="47ccd-147">Коды ошибок определяются в контексте реализации интерфейса.</span><span class="sxs-lookup"><span data-stu-id="47ccd-147">Error codes are defined within the context of an interface implementation.</span></span> <span data-ttu-id="47ccd-148">После определения коды успешного выполнения нельзя изменить или добавить новые коды успеха.</span><span class="sxs-lookup"><span data-stu-id="47ccd-148">Once defined, success codes cannot be changed or new success codes added.</span></span> <span data-ttu-id="47ccd-149">Однако могут быть записаны новые коды ошибок.</span><span class="sxs-lookup"><span data-stu-id="47ccd-149">However, new failure codes can be written.</span></span> <span data-ttu-id="47ccd-150">Корпорация Майкрософт оставляет за собой право определять новые коды сбоев (но не коды успеха) для интерфейсов, описанных в разделе \_ ИТФ или новые средства.</span><span class="sxs-lookup"><span data-stu-id="47ccd-150">Microsoft reserves the right to define new failure codes (but not success codes) for the interfaces described in FACILITY\_ITF or in new facilities.</span></span>

## <a name="related-topics"></a><span data-ttu-id="47ccd-151">См. также</span><span class="sxs-lookup"><span data-stu-id="47ccd-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="47ccd-152">Обработка ошибок в COM</span><span class="sxs-lookup"><span data-stu-id="47ccd-152">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> <dt>

[<span data-ttu-id="47ccd-153">Протоколы Windows: HRESULT</span><span class="sxs-lookup"><span data-stu-id="47ccd-153">Windows Protocols: HRESULT</span></span>](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a)
</dt> </dl>

 

