---
title: Структура кодов ошибок COM
description: Структура кодов ошибок COM
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb27143f50028592f6fe0aeb5cab9795dcd10d4a
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "104570942"
---
# <a name="structure-of-com-error-codes"></a>Структура кодов ошибок COM

На следующем рисунке показан формат [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (или SCODE). числа обозначают разрядные позиции:

![Отображает формат "H RESULT" или "CODE" с числами, указывающими разрядные позиции.](images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png)

Бит высокого порядка в **HRESULT** или SCODE указывает, представляет ли возвращаемое значение успешное или неуспешное выполнение. Если задано значение 0, степень серьезности \_ успеха, значение указывает на успешное выполнение. Если задано значение 1, ошибка СЕРЬЕЗНОсти \_ указывает на сбой.

Биты R, C, N и r зарезервированы.

В поле "оборудование" указывается системная служба, ответственная за ошибку. Корпорация Майкрософт выделяет новые коды устройств по мере необходимости. Для большинства Скодес и значений **HRESULT** в поле "средство" задается значение \_ ИТФ, указывающее на ошибку метода интерфейса.

В следующей таблице описаны общие поля средств.



| Поле "ссуда"                | Значение        | Описание                                                                                                                                                                                                                                                                                                              |
|-------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_Доставка услуг<br/> | 2<br/> | Для ошибок интерфейса **IDispatch** с поздним связыванием. <br/>                                                                                                                                                                                                                                                             |
| \_ИТФ средства<br/>      | 4<br/> | Для большинства кодов состояния, возвращаемых методами интерфейса. Фактическое значение ошибки определяется интерфейсом. То есть два **HRESULT** с точностью одного и того же 32-разрядного значения, возвращаемого двумя разными интерфейсами, могут иметь разные значения. <br/>                                                       |
| СРЕДСТВО \_ со значением NULL<br/>     | 0<br/> | Для широко применяемых общих кодов состояния, таких как S \_ ОК. <br/>                                                                                                                                                                                                                                                    |
| СРЕДСТВО \_ RPC<br/>      | 1<br/> | Для кодов состояния, возвращаемых удаленными вызовами процедур. <br/>                                                                                                                                                                                                                                                       |
| \_хранилище устройств<br/>  | 3<br/> | Для кодов состояния, возвращаемых из вызовов методов [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) или [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) , связанных с структурированным хранилищем. Коды состояния, код (более низкие 16 бит), находятся в диапазоне кодов ошибок MS-DOS (то есть менее 256) имеют то же значение, что и соответствующая ошибка MS-DOS. <br/> |
| СРЕДСТВО \_ Win32<br/>    | 7<br/> | Используется для предоставления средств обработки кодов ошибок из функций в Windows API как **HRESULT**. Коды ошибок в 16-разрядных OLE, которые также были изменены с повторяющимися кодами системных ошибок, для устройств \_ Win32. <br/>                                                                                                 |
| \_окна средств<br/>  | 8<br/> | Используется для дополнительных кодов ошибок из интерфейсов, определенных корпорацией Майкрософт.<br/>                                                                                                                                                                                                                                            |



 

Поле кода является уникальным числом, которое назначается для представления ошибки или предупреждения.

По соглашению значения **HRESULT** обычно имеют имена в следующем формате:  \_ *Причина серьезности* устройства \_ .

В качестве *устройства* можно указать имя или другой идентификатор. *Серьезность* — это одиночная буква, S или E, которая указывает, была ли вызов функции выполнен (S) или произошла ошибка (E). и *Причина* — это идентификатор, описывающий значение кода. Например, код состояния STG \_ E \_ FILENOTFOUND указывает на ошибку, связанную с хранилищем; в частности, запрошенный файл не существует. Коды состояния из устройства \_ NULL опускаются префикс *устройства* \_ .

Коды ошибок определяются в контексте реализации интерфейса. После определения коды успешного выполнения нельзя изменить или добавить новые коды успеха. Однако могут быть записаны новые коды ошибок. Корпорация Майкрософт оставляет за собой право определять новые коды сбоев (но не коды успеха) для интерфейсов, описанных в разделе \_ ИТФ или новые средства.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Обработка ошибок в COM](error-handling-in-com.md)
</dt> <dt>

[Протоколы Windows: HRESULT](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a)
</dt> </dl>

 

