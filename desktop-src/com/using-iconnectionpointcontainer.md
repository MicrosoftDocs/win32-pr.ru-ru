---
title: Использование IConnectionPointContainer
description: Использование IConnectionPointContainer
ms.assetid: a87afb25-4d45-4ce2-9b27-840da5107bce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d0b7c691e1ba6a8445af56978b43a2ccbf33e7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "105710227"
---
# <a name="using-iconnectionpointcontainer"></a><span data-ttu-id="b1123-103">Использование IConnectionPointContainer</span><span class="sxs-lookup"><span data-stu-id="b1123-103">Using IConnectionPointContainer</span></span>

<span data-ttu-id="b1123-104">Подключаемый объект реализует [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (и предоставляет его через [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) для указания существования исходящих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="b1123-104">A connectable object implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (and exposes it through [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) to indicate the existence of outgoing interfaces.</span></span> <span data-ttu-id="b1123-105">Для каждого исходящего интерфейса объект, который подсоединяется, управляет подобъектом точки соединения, который сам реализует [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="b1123-105">For each outgoing interface, the connectable object manages a connection point sub-object, which itself implements [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span></span> <span data-ttu-id="b1123-106">Таким образом, подключаемый объект содержит точки подключения, поэтому именование **IConnectionPointContainer** и **IConnectionPoint**.</span><span class="sxs-lookup"><span data-stu-id="b1123-106">The connectable object therefore contains the connection points, hence the naming of **IConnectionPointContainer** and **IConnectionPoint**.</span></span>

<span data-ttu-id="b1123-107">С помощью [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)клиент может выполнять две операции.</span><span class="sxs-lookup"><span data-stu-id="b1123-107">Through [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), a client can perform two operations.</span></span> <span data-ttu-id="b1123-108">Во первых, если у клиента уже есть IID для исходящего интерфейса, который он поддерживает, он может разместить соответствующую точку соединения для IID с помощью [**IConnectionPointContainer:: финдконнектионпоинт**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="b1123-108">First, if the client already has the IID for an outgoing interface that it supports, it can locate the corresponding connection point for the IID using [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span> <span data-ttu-id="b1123-109">Клиент не может запросить точку соединения напрямую из-за наличия контейнера или вложенной связи между подключаемым объектом и содержащимися в нем точками соединения.</span><span class="sxs-lookup"><span data-stu-id="b1123-109">The client cannot query for the connection point directly because of the container/contained relationship between the connectable object and its contained connection points.</span></span> <span data-ttu-id="b1123-110">По сути, **финдконнектионпоинт** — это [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) для исходящих ИНТЕРФЕЙСОВ, когда идентификатор IID известен клиенту.</span><span class="sxs-lookup"><span data-stu-id="b1123-110">Basically, **FindConnectionPoint** is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for outgoing interfaces when the IID is known to the client.</span></span>

<span data-ttu-id="b1123-111">Во-вторых, клиент может перечислить все точки подключения в объекте, доступном для подключения, с помощью [**IConnectionPointContainer:: енумконнектионпоинтс**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="b1123-111">Second, the client can enumerate all connection points within the connectable object through [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="b1123-112">Этот метод возвращает указатель интерфейса [**иенумконнектионпоинтс**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) для отдельного объекта перечислителя.</span><span class="sxs-lookup"><span data-stu-id="b1123-112">This method returns an [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) interface pointer for a separate enumerator object.</span></span> <span data-ttu-id="b1123-113">С помощью [**иенумконнектионпоинтс:: Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next)клиент может получить указатели интерфейса [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) на каждую точку подключения.</span><span class="sxs-lookup"><span data-stu-id="b1123-113">Through [**IEnumConnectionPoints::Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), the client can obtain [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface pointers to each connection point.</span></span>

<span data-ttu-id="b1123-114">После того как клиент получит интерфейс [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) , он должен вызвать метод [**IConnectionPoint:: жетконнектионинтерфаце**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) , чтобы определить IID исходящего интерфейса, поддерживаемого каждой точкой подключения.</span><span class="sxs-lookup"><span data-stu-id="b1123-114">After the client obtains the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface, it must call [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) to determine the IID of the outgoing interface supported by each connection point.</span></span> <span data-ttu-id="b1123-115">Если клиент уже поддерживает этот исходящий интерфейс, он может установить соединение.</span><span class="sxs-lookup"><span data-stu-id="b1123-115">If the client already supports that outgoing interface, it can establish a connection.</span></span> <span data-ttu-id="b1123-116">В противном случае он по-прежнему может поддерживать исходящий интерфейс, используя сведения из библиотеки типов подключаемого объекта, чтобы обеспечить поддержку во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b1123-116">Otherwise, it may still be able to support the outgoing interface by using information from the connectable object's type library to provide support at run time.</span></span> <span data-ttu-id="b1123-117">Для этого метода требуется, чтобы подключаемый объект поддерживал интерфейс [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) .</span><span class="sxs-lookup"><span data-stu-id="b1123-117">This technique requires that the connectable object support the [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="b1123-118">(См. раздел [Использование IProvideClassInfo](using-iprovideclassinfo.md).)</span><span class="sxs-lookup"><span data-stu-id="b1123-118">(See [Using IProvideClassInfo](using-iprovideclassinfo.md).)</span></span>

<span data-ttu-id="b1123-119">Поскольку перечислитель является отдельным объектом, клиент должен вызвать **иенумконнектионпоинтс:: Release** , если перечислитель больше не нужен.</span><span class="sxs-lookup"><span data-stu-id="b1123-119">Because the enumerator is a separate object, the client must call **IEnumConnectionPoints::Release** when the enumerator is no longer needed.</span></span> <span data-ttu-id="b1123-120">Кроме того, каждая точка соединения является объектом с отдельным числом ссылок из содержащего объекта, доступного для соединения.</span><span class="sxs-lookup"><span data-stu-id="b1123-120">In addition, each connection point is an object with a separate reference count from the containing connectable object.</span></span> <span data-ttu-id="b1123-121">Таким образом, клиент должен также вызвать метод IConnectionPoint:: Release для каждой точки подключения, доступ к которой осуществляется через перечислитель или через [**финдконнектионпоинт**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="b1123-121">Therefore, the client must also call IConnectionPoint::Release for each connection point accessed either through the enumerator or through [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b1123-122">См. также</span><span class="sxs-lookup"><span data-stu-id="b1123-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b1123-123">Подключаемые интерфейсы объектов</span><span class="sxs-lookup"><span data-stu-id="b1123-123">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




