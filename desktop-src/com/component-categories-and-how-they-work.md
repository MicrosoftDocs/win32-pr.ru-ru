---
title: Категории компонентов и принципы их работы
description: Категории компонентов и принципы их работы
ms.assetid: efbf4a25-3c73-4d09-a172-6676c6d6501b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: faf8065584ae2dc83e470428b7345eb2d9321d32
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103986170"
---
# <a name="component-categories-and-how-they-work"></a><span data-ttu-id="ba5a7-103">Категории компонентов и принципы их работы</span><span class="sxs-lookup"><span data-stu-id="ba5a7-103">Component Categories and How they Work</span></span>

<span data-ttu-id="ba5a7-104">Категории компонентов определяют области функциональных возможностей, поддерживаемых и необходимых компонентом программного обеспечения, для каждой категории или определенной области функциональности используется запись реестра.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-104">Component categories identify those areas of functionality that a software component supports and requires, a registry entry is used for each category or identified area of functionality.</span></span> <span data-ttu-id="ba5a7-105">Каждая категория компонента определяется глобальным уникальным идентификатором (GUID). при установке элемента управления он регистрируется как элемент управления в системном реестре, используя идентификатор категории компонента для управления, см. раздел [самостоятельная регистрация для элементов](self-registration-for-controls.md)управления.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-105">Each component category is identified by a globally unique identifier (GUID), when a control is installed it registers itself as a control in the system registry using the component category ID for control, see [Self Registration for Controls](self-registration-for-controls.md).</span></span> <span data-ttu-id="ba5a7-106">В рамках самостоятельной регистрации будут также зарегистрированы реализуемые им категории компонентов и категории компонентов, для которых требуется контейнер для поддержки, чтобы успешно разместить элемент управления.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-106">Within the controls self registration it will also register those component categories that it implements and those component categories that it requires a container to support in order to successfully host the control.</span></span>

<span data-ttu-id="ba5a7-107">Когда контейнер элемента управления предоставляет пользователям элементы управления для вставки, он позволяет пользователю выбирать и создавать экземпляры этих элементов управления, которые смогут адекватно работать в этой среде.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-107">When a control container is offering controls to the user to insert, it only allows the user to select and instantiate those controls that will be able to function adequately in that environment.</span></span> <span data-ttu-id="ba5a7-108">Например, если контейнер элемента управления не поддерживает привязку данных, то он не позволит пользователю выбирать и создавать экземпляры этих элементов управления с записью в реестре, что означает, что им требуется категория компонента привязки данных.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-108">For example, if the control container does not support databinding, then the container will not allow the user to select and instantiate those controls that have an entry in the registry signifying that they require the databinding component category.</span></span> <span data-ttu-id="ba5a7-109">Доступно обычное диалоговое окно для вставки элементов управления и интерфейсов API для работы с записями реестра.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-109">A common dialog for control insertion and APIs to handle the registry entries are available.</span></span>

<span data-ttu-id="ba5a7-110">Категории компонентов не являются кумулятивными или эксклюзивными, для работы элемента управления может потребоваться любое сочетание категорий компонентов.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-110">Component categories are not cumulative or exclusive, a control can require any mix of component categories to function.</span></span> <span data-ttu-id="ba5a7-111">Элемент управления, не имеющий обязательных записей для категорий компонентов, может быть способен функционировать в любом контейнере управления и не требует какой-либо конкретной функциональности контейнера элемента управления.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-111">A control that has no required entries for component categories may be expected to be capable of functioning in any control container and not require any specific functionality of a control container to function.</span></span>

<span data-ttu-id="ba5a7-112">Следующие категории компонентов идентифицируются здесь, где могут быть доступны более подробные спецификации категорий.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-112">The following component categories are identified here, where necessary more detailed specifications of the categories may be available.</span></span>

-   <span data-ttu-id="ba5a7-113">Включение элемента управления [**исимплефрамесите**](/windows/desktop/api/OCIdl/nn-ocidl-isimpleframesite) .</span><span class="sxs-lookup"><span data-stu-id="ba5a7-113">[**ISimpleFrameSite**](/windows/desktop/api/OCIdl/nn-ocidl-isimpleframesite) control containment.</span></span>
-   <span data-ttu-id="ba5a7-114">Простая привязка данных через интерфейс [**ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) .</span><span class="sxs-lookup"><span data-stu-id="ba5a7-114">Simple Databinding through the [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) interface.</span></span>
-   <span data-ttu-id="ba5a7-115">Расширенная привязка данных (как поддерживается дополнительными интерфейсами DataBinding в VB 4.0).</span><span class="sxs-lookup"><span data-stu-id="ba5a7-115">Advanced Databinding (as supported by the additional databinding interfaces of VB4.0).</span></span>
-   <span data-ttu-id="ba5a7-116">Visual Basic закрытых интерфейсов — [**ивбформат**](/windows/desktop/api/VbInterf/nn-vbinterf-ivbformat), [**ивбжетконтрол**](/windows/desktop/api/VbInterf/nn-vbinterf-ivbgetcontrol)</span><span class="sxs-lookup"><span data-stu-id="ba5a7-116">Visual Basic private interfaces - [**IVBFormat**](/windows/desktop/api/VbInterf/nn-vbinterf-ivbformat), [**IVBGetControl**](/windows/desktop/api/VbInterf/nn-vbinterf-ivbgetcontrol)</span></span>
-   <span data-ttu-id="ba5a7-117">Элементы управления, поддерживающие Интернет.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-117">Internet aware controls.</span></span>
-   <span data-ttu-id="ba5a7-118">Безоконные элементы управления.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-118">Windowless controls.</span></span>

<span data-ttu-id="ba5a7-119">Это не самый полный список категорий. Дополнительные категории, скорее всего, будут определены в будущем по мере определения новых требований.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-119">This is not a definitive list of categories; further categories are likely to be defined in the future as new requirements are identified.</span></span> <span data-ttu-id="ba5a7-120">В Майкрософт доступен актуальный список категорий компонентов. в этом списке отражены категории компонентов, обнаруженные корпорацией Майкрософт, и другие, о которых сообщили поставщики корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-120">An up-to-date list of component categories is available from Microsoft; this list reflects those component categories that have been identified by Microsoft and any others that about which vendors have informed Microsoft.</span></span>

<span data-ttu-id="ba5a7-121">Важно помнить, что элементы управления должны попытаться работать в максимально возможном количестве сред.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-121">It is important to remember that controls should attempt to work in as many environments as possible.</span></span> <span data-ttu-id="ba5a7-122">Если возможно, элемент управления должен понизить его функциональность при помещении в контейнер, который не поддерживает определенные интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-122">If it is possible, the control should degrade its functionality when placed in a container that does not support certain interfaces.</span></span> <span data-ttu-id="ba5a7-123">Назначение категорий компонентов заключается в предотвращении ситуации, когда элемент управления помещается в непригодную для себя среду, и элемент управления не может достичь необходимой задачи.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-123">The purpose of component categories is to prevent a situation where the control is placed in an environment that is unsuitable and the control cannot achieve its desired task.</span></span> <span data-ttu-id="ba5a7-124">Как правило, элемент управления должен постепенно понижаться, если отсутствуют интерфейсы, элемент управления может указать пользователю сообщение о том, что некоторые функциональные возможности недоступны, или явно документировать функции, необходимые контейнеру элемента управления для обеспечения оптимальной производительности.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-124">Generally, a control should degrade gracefully when interfaces are not present, a control may choose to advise the user with a message box that some functionality is not available or clearly document the functionality required of a control container for optimal performance.</span></span>

<span data-ttu-id="ba5a7-125">Обратите внимание, что старые элементы управления и контейнеры не используют категории компонентов и вместо этого используют ключевое слово Control, представленное для элемента управления в реестре.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-125">Note older controls and containers do not make use of component categories and instead rely on the control keyword being present against the control in the registry.</span></span> <span data-ttu-id="ba5a7-126">Для распознавания старыми элементами управления "контейнеры" может потребоваться зарегистрировать ключевое слово элемента управления в реестре. разработчики элементов управления должны убедиться, что элемент управления может быть успешно размещен в таких контейнерах, прежде чем это сделать.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-126">In order to be recognized by older containers controls may wish to register the control keyword in the registry, control developers should check that the control can successfully be hosted in such containers before doing this.</span></span> <span data-ttu-id="ba5a7-127">Контейнеры, использующие категории компонентов, могут успешно использовать их для размещения старых элементов управления, так как библиотека DLL категории компонентов обрабатывает сопоставление. для более старых элементов управления ControlV1 существует отдельная категория, \_ чтобы контейнер мог при необходимости исключить их.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-127">Containers that use component categories may successfully use them to host older controls as the components category DLL handles the mapping, a separate category exists for older controls CATID\_ControlV1 so that a container may optionally exclude them if necessary.</span></span>

<span data-ttu-id="ba5a7-128">Так как категории компонентов идентифицируются по идентификаторам GUID, для контейнеров, предоставляющих определенные конкретные функции, можно использовать собственные идентификаторы категорий, созданные с помощью средства создания GUID.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-128">As component categories are identified by GUIDs it is possible for containers that offer particular specific functionality to have their own category IDs, generated using a GUID generation tool.</span></span> <span data-ttu-id="ba5a7-129">Однако это может противодействовать преимуществам взаимодействия элементов управления и контейнеров, поэтому предпочтительно использовать все возможные категории компонентов.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-129">However this can possibly undermine the advantage of interoperability of controls and containers so it is preferred that wherever possible existing component categories be used.</span></span> <span data-ttu-id="ba5a7-130">При определении новых категорий компонентов поставщикам рекомендуется обращаться к ним, чтобы убедиться, что они отвечают общим требованиям Marketplace, и следовать правилам взаимодействия элементов управления ActiveX.</span><span class="sxs-lookup"><span data-stu-id="ba5a7-130">Vendors are encouraged to consult together when defining new component categories to ensure that they meet the common requirements of the marketplace, and follow the spirit of interoperability of ActiveX controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ba5a7-131">См. также</span><span class="sxs-lookup"><span data-stu-id="ba5a7-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ba5a7-132">Категории компонентов</span><span class="sxs-lookup"><span data-stu-id="ba5a7-132">Component Categories</span></span>](component-categories.md)
</dt> </dl>

 

 




