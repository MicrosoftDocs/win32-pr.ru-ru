---
title: Доступ к интерфейсам в разных апартаментах
description: Доступ к интерфейсам в разных апартаментах
ms.assetid: 4e0467b9-bbf1-410c-8aab-40450a7f963a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 626707daf721aee3b440bb79ba2d1e084d154a98
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103774795"
---
# <a name="accessing-interfaces-across-apartments"></a>Доступ к интерфейсам в разных апартаментах

COM позволяет любому подразделению в процессе получить доступ к интерфейсу, реализованному для объекта в любом другом апартаменте в процессе. Это делается через интерфейс [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable) . Этот интерфейс имеет три метода, которые позволяют выполнять следующие действия:

-   Зарегистрируйте интерфейс как *глобальный* интерфейс (процессвиде).
-   Получение указателя на этот интерфейс из любого другого подразделения через файл cookie.
-   Отозвать глобальную регистрацию интерфейса.

Интерфейс [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable) — это эффективный способ хранения указателя интерфейса в памяти, доступ к которому можно получить из нескольких подконтейнеров внутри процесса, таких как переменные на уровне процесса и *гибкие* объекты (объекты с поддержкой свободных потоков), содержащие указатели интерфейсов на другие объекты.

Объект Agile не знает о базовой инфраструктуре COM, в которой она выполняется. Иными словами, подразделение, контекст и поток, на котором он выполняется. Объект может храниться в интерфейсах, относящихся к подразделению или контексту. По этой причине вызов этих интерфейсов из любого места, где выполняется компонент Agile, может не всегда работать должным образом. Глобальная таблица интерфейса позволяет избежать этой проблемы, гарантируя, что используется допустимый прокси-сервер (или прямой указатель) для объекта, основанный на месте, где работает объект Agile.

> [!Note]  
> Глобальная таблица интерфейса не переносима между процессами или границами машин, поэтому ее нельзя использовать вместо обычного механизма передачи параметров.

 

Сведения о создании и использовании глобальной таблицы интерфейса см. в следующих разделах:

-   [Создание глобальной таблицы интерфейса](creating-the-global-interface-table.md)
-   [Когда следует использовать глобальную таблицу интерфейса](when-to-use-the-global-interface-table.md)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Выбор потоковой модели](choosing-the-threading-model.md)
</dt> <dt>

[Многопоточные подразделения](multithreaded-apartments.md)
</dt> <dt>

[Проблемы потоковой обработки в процессе сервера](in-process-server-threading-issues.md)
</dt> <dt>

[Процессы, потоки и подразделения](processes--threads--and-apartments.md)
</dt> <dt>

[Однопотоковое и многопоточное взаимодействие](single-threaded-and-multithreaded-communication.md)
</dt> <dt>

[Подразделения с одним потоком](single-threaded-apartments.md)
</dt> </dl>

 

 




