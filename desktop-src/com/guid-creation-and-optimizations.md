---
title: Создание и оптимизация GUID
description: Создание и оптимизация GUID
ms.assetid: 698322f2-db89-4553-90c6-4278e96716dc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 82dc1b0cc52312768759daca35824f8e7e515629131ac2c301a17d7ae99d6455
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119731434"
---
# <a name="guid-creation-and-optimizations"></a>Создание и оптимизация GUID

Поскольку CLSID, например идентификатор интерфейса (IID), является идентификатором GUID, никакой другой класс, независимо от его записи, имеет дублирующийся идентификатор CLSID. Разработчики серверов обычно получают идентификаторы CLSID через функцию [**CoCreateGuid**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateguid) . Эта функция гарантированно создает уникальные идентификаторы CLSID, поэтому разработчики серверов в мире могут независимо разрабатывать и развертывать их программное обеспечение, не опасаясь случайного конфликта с программным обеспечением, написанным другими пользователями.

Использование уникальных идентификаторов CLSID позволяет избежать конфликтов имен между классами, так как CLSID не подключены к именам, используемым в базовой реализации. Например, два разных поставщика могут писать классы с именем "Стакккласс", но каждый из них будет иметь уникальный идентификатор CLSID, поэтому их не следует путать.

COM часто должен сопоставлять идентификаторы GUID (идентификаторов IID и CLSID) с произвольным большим набором других значений. Как разработчик приложения вы можете ускорить такой поиск и, таким образом, повысить производительность системы, создав идентификаторы GUID для приложения в виде блока последовательных значений.

Наиболее эффективный способ создания блока последовательных идентификаторов GUID — запуск служебной программы uuidgen с параметрами-n и-x, которая создает блок UUID, каждый из которых имеет первое значение DWORD, увеличенное на единицу.

Например, если необходимо ввести

**uuidgen-N5-x**

Служебная программа Uuidgen создаст блок UUID, аналогичный приведенному ниже:

``` syntax
12340001-4980-1920-6788-123456789012
12340002-4980-1920-6788-123456789012
12340003-4980-1920-6788-123456789012
12340004-4980-1920-6788-123456789012
12340005-4980-1920-6788-123456789012
 
```

Один из методов создания и отслеживания идентификаторов GUID для всего проекта начинается с создания блока некоторого произвольного большого количества UUID, скажем 500. Например, если необходимо ввести

**uuidgen-N500-x > guids.txt**

Программа создаст 500 последовательных UUID и запишет их в указанный текстовый файл. Затем этот файл можно вернуть в исходное дерево, предоставив единый репозиторий для всех идентификаторов GUID, которые будут использоваться в проекте. Так как пользователям требуются идентификаторы GUID для своих частей проекта, они могут извлечь файл, получить необходимое количество идентификаторов GUID, пометить их как выполненные и отказаться от заметок о том, где в коде или «Spec» они их используют.

Помимо повышения производительности системы, создание блоков последовательных идентификаторов GUID таким образом имеет следующие преимущества.

-   Центральный файл, содержащий все идентификаторы GUID для приложения, позволяет легко отследить, какие идентификаторы GUID предназначены для того, что и какие пользователи используют.
-   Блок последовательных идентификаторов GUID, связанных с конкретным приложением, помогает разработчикам и тестерам распознать внутренние идентификаторы GUID во время отладки и упрощает их поиск в системном реестре, поскольку они хранятся последовательно.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Обязанности сервера COM](com-server-responsibilities.md)
</dt> </dl>

 

 




