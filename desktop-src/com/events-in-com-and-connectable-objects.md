---
title: События в COM и подключаемых объектах
description: Когда программа обнаруживает что-то произошедшее, она может уведомлять ее клиентов.
ms.assetid: f6ffbd1d-4bc1-4dc2-b3ed-ee12359e3d75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa5115cfd08d57658eec879d44b4361e88965b3c
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "104069488"
---
# <a name="events-in-com-and-connectable-objects"></a><span data-ttu-id="6d02e-103">События в COM и подключаемых объектах</span><span class="sxs-lookup"><span data-stu-id="6d02e-103">Events in COM and Connectable Objects</span></span>

<span data-ttu-id="6d02e-104">Когда программа обнаруживает что-то произошедшее, она может уведомлять ее клиентов.</span><span class="sxs-lookup"><span data-stu-id="6d02e-104">When a program detects something that has happened, it can notify its clients.</span></span> <span data-ttu-id="6d02e-105">Например, если программа биржевых котировок обнаруживает изменение цены акции, она может уведомлять всех клиентов об изменении.</span><span class="sxs-lookup"><span data-stu-id="6d02e-105">For example, if a stock ticker program detects a change in the price of a stock, it can notify all clients of the change.</span></span> <span data-ttu-id="6d02e-106">Этот процесс уведомления называется *срабатыванием события*.</span><span class="sxs-lookup"><span data-stu-id="6d02e-106">This notification process is referred to as *firing an event*.</span></span>

<span data-ttu-id="6d02e-107">При использовании COM объекты сервера могут использовать события COM для запуска событий без каких-либо сведений о том, какие объекты будут уведомлены.</span><span class="sxs-lookup"><span data-stu-id="6d02e-107">With COM, server objects can use COM events to fire events without any information about what objects will be notified.</span></span> <span data-ttu-id="6d02e-108">Объекты также могут использовать *подключаемые объекты* для поддержки подробных сведений о клиентах, которые запросили уведомления.</span><span class="sxs-lookup"><span data-stu-id="6d02e-108">Objects can also use *connectable objects* to maintain detailed information about clients who have requested notifications.</span></span>

<span data-ttu-id="6d02e-109">Подключаемые объекты COM предоставляют исходящие интерфейсы своим клиентам в дополнение к входящим интерфейсам.</span><span class="sxs-lookup"><span data-stu-id="6d02e-109">COM connectable objects provide outgoing interfaces to their clients in addition to their incoming interfaces.</span></span> <span data-ttu-id="6d02e-110">В результате объекты и их клиенты могут взаимодействовать в двунаправленной связи.</span><span class="sxs-lookup"><span data-stu-id="6d02e-110">As a result, objects and their clients can engage in bidirectional communication.</span></span> <span data-ttu-id="6d02e-111">Входящие интерфейсы реализуются на объекте и получают вызовы от внешних клиентов объекта, а исходящие интерфейсы реализуются на приемнике клиента и получают вызовы от объекта.</span><span class="sxs-lookup"><span data-stu-id="6d02e-111">Incoming interfaces are implemented on an object and receive calls from external clients of an object, while outgoing interfaces are implemented on the client's sink and receive calls from the object.</span></span> <span data-ttu-id="6d02e-112">Объект определяет интерфейс, который необходимо использовать, и клиент реализует его.</span><span class="sxs-lookup"><span data-stu-id="6d02e-112">The object defines an interface it would like to use, and the client implements it.</span></span>

<span data-ttu-id="6d02e-113">Объект определяет входящие интерфейсы и предоставляет реализации этих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="6d02e-113">An object defines its incoming interfaces and provides implementations of these interfaces.</span></span> <span data-ttu-id="6d02e-114">Входящие интерфейсы доступны клиентам через метод [**IUnknown:: QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) объекта.</span><span class="sxs-lookup"><span data-stu-id="6d02e-114">Incoming interfaces are available to clients through the object's [**IUnknown::QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span> <span data-ttu-id="6d02e-115">Клиенты вызывают методы входящего интерфейса для объекта, и объект выполняет необходимые действия от имени клиента.</span><span class="sxs-lookup"><span data-stu-id="6d02e-115">Clients call the methods of an incoming interface on the object, and the object performs desired actions on behalf of the client.</span></span>

<span data-ttu-id="6d02e-116">Исходящие интерфейсы также определяются объектом, но клиент предоставляет реализации исходящих интерфейсов для объекта приемника, создаваемого клиентом.</span><span class="sxs-lookup"><span data-stu-id="6d02e-116">Outgoing interfaces are also defined by an object, but the client provides the implementations of the outgoing interfaces on a sink object that the client creates.</span></span> <span data-ttu-id="6d02e-117">Затем объект вызывает методы исходящего интерфейса для объекта приемника, чтобы уведомить клиента об изменениях в объекте, активировать события в клиенте, чтобы запросить что-либо от клиента, или, на самом деле, для любой цели, с которой поступает создатель объекта.</span><span class="sxs-lookup"><span data-stu-id="6d02e-117">The object then calls methods of the outgoing interface on the sink object to notify the client of changes in the object, to trigger events in the client, to request something from the client, or, in fact, for any purpose the object creator comes up with.</span></span>

<span data-ttu-id="6d02e-118">Примером исходящего интерфейса является интерфейс Ибуттонсинк, определенный элементом управления "Кнопка отправки" для уведомления клиентов о событиях.</span><span class="sxs-lookup"><span data-stu-id="6d02e-118">An example of an outgoing interface is an IButtonSink interface defined by a push button control to notify its clients of its events.</span></span> <span data-ttu-id="6d02e-119">Например, объект Button вызывает Ибуттонсинк:: OnClick в объекте приемника клиента, когда пользователь нажимает кнопку на экране.</span><span class="sxs-lookup"><span data-stu-id="6d02e-119">For example, the button object calls IButtonSink::OnClick on the client's sink object when the user clicks the button on the screen.</span></span> <span data-ttu-id="6d02e-120">Элемент управления "Кнопка" определяет исходящий интерфейс.</span><span class="sxs-lookup"><span data-stu-id="6d02e-120">The button control defines the outgoing interface.</span></span> <span data-ttu-id="6d02e-121">Чтобы клиент кнопки обрабатывал событие, клиент должен реализовать этот исходящий интерфейс в объекте приемника, а затем подключить этот приемник к элементу управления Button.</span><span class="sxs-lookup"><span data-stu-id="6d02e-121">For a client of the button to handle the event, the client must implement that outgoing interface on a sink object and then connect that sink to the button control.</span></span> <span data-ttu-id="6d02e-122">Затем, когда события происходят в кнопке, кнопка вызывает приемник, в то время как клиент может выполнить любое действие, которое он хочет назначить нажатию кнопки.</span><span class="sxs-lookup"><span data-stu-id="6d02e-122">Then, when events occur in the button, the button will call the sink, at which time the client can execute whatever action it wishes to assign to that button click.</span></span>

<span data-ttu-id="6d02e-123">Подключаемые объекты предоставляют общий механизм обмена данными между клиентами и объектами.</span><span class="sxs-lookup"><span data-stu-id="6d02e-123">Connectable objects provide a general mechanism for object-to-client communication.</span></span> <span data-ttu-id="6d02e-124">Любой объект, желающий предоставлять события или уведомления любого вида, может использовать эту технологию.</span><span class="sxs-lookup"><span data-stu-id="6d02e-124">Any object that wishes to expose events or notifications of any kind can use this technology.</span></span> <span data-ttu-id="6d02e-125">В дополнение к общей технологии Connected, COM предоставляет множество специальных приемников и интерфейсов сайта, используемых объектами для уведомления клиентов о конкретных событиях, интересующих клиента.</span><span class="sxs-lookup"><span data-stu-id="6d02e-125">In addition to the general connectable object technology, COM provides many special purpose sink and site interfaces used by objects to notify clients of specific events of interest to the client.</span></span> <span data-ttu-id="6d02e-126">Например, [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) может использоваться объектами для уведомления клиентов о данных и просмотра изменений в объекте.</span><span class="sxs-lookup"><span data-stu-id="6d02e-126">For example, [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) may be used by objects to notify clients of data and view changes in the object.</span></span>

<span data-ttu-id="6d02e-127">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="6d02e-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="6d02e-128">Архитектура подключаемых объектов</span><span class="sxs-lookup"><span data-stu-id="6d02e-128">Architecture of Connectable Objects</span></span>](architecture-of-connectable-objects.md)
-   [<span data-ttu-id="6d02e-129">Подключаемые интерфейсы объектов</span><span class="sxs-lookup"><span data-stu-id="6d02e-129">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)

 

 




