---
title: Регистрация класса при установке
description: Если класс должен быть доступен клиентам в любое время, как и большинство приложений, обычно его можно зарегистрировать с помощью программы установки и установки.
ms.assetid: 6d78c2ce-56d8-4866-9801-35125ec9cac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4253c40cb3feb7e737368c947c0b20715f5becbd
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104339364"
---
# <a name="registering-a-class-at-installation"></a>Регистрация класса при установке

Если класс должен быть доступен клиентам в любое время, как и большинство приложений, обычно его можно зарегистрировать с помощью программы установки и установки. Это означает, что в реестр помещаются сведения о приложении, в том числе способ и место создания экземпляров его объектов. Эти сведения должны быть зарегистрированы для всех идентификаторов CLSID. Другие сведения являются необязательными. Такие средства, как regsvr32, упрощают написание программы установки, которая регистрирует серверы при установке.

Если вы не полагаетесь на системные значения по умолчанию, в реестре есть два важных ключа: CLSID и AppID. Между важными сведениями в этих разделах описывается создание экземпляра объекта. Объекты можно назначить как внутрипроцессный, вне процесса локального или вне процесса удаленного выполнения.

В разделе AppID — это несколько значений, которые определяют сведения, относящиеся к этому приложению. К ним относятся [ремотесервернаме](remoteservername.md) и [активатеатстораже](activateatstorage.md), которые можно использовать, чтобы позволить клиенту создавать объект, при этом клиент не имеет встроенных знаний о расположении сервера. (Дополнительные сведения об удаленном создании экземпляров см. в разделе расположение [вспомогательных функций для создания](instance-creation-helper-functions.md) [удаленного объекта](locating-a-remote-object.md) и экземпляра.)

Сервер также может быть установлен как служба или выполняться с определенной учетной записью пользователя. Дополнительные сведения см. в разделе [Установка в качестве приложения службы](installing-as-a-service-application.md).

Сервер или объект ROT, который не является службой или работает под определенной учетной записью пользователя, может называться сервером "Активация в качестве активатора". Для этих серверов контекст безопасности и Оконная станция или Рабочий стол клиента должны соответствовать серверу. Клиент, пытающийся соединиться с удаленным сервером, считается, что он имеет **пустую** оконную станцию или Рабочий стол, поэтому в этом экземпляре сравнивается только контекст безопасности сервера. (Дополнительные сведения об идентификаторах безопасности см. [в разделе Security in com](security-in-com.md).) COM кэширует станцию окна или Рабочий стол процесса, когда процесс сначала подключается к распределенной службе COM. Таким образом, клиенты и серверы COM не должны изменять рабочие станции и потоки процесса после вызова функции [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) или [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).

Когда класс регистрируется как внутрипроцессный, вызов [**кожетклассобжект**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) для создания его объекта класса автоматически передается com в функцию [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) , которую класс должен реализовать, чтобы передать вызывающему объекту указатель на его объект Class.

Классы, реализованные в исполняемых файлах, могут указывать, что COM должен выполнить свой процесс и подождать, пока процесс не зарегистрирует интерфейс [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) объекта класса с помощью вызова функции [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Разделы реестра COM](com-registry-keys.md)
</dt> <dt>

[Установка в качестве приложения службы](installing-as-a-service-application.md)
</dt> <dt>

[Регистрация работающего сервера EXE](registering-a-running-exe-server.md)
</dt> <dt>

[Регистрация компонентов](registering-components.md)
</dt> <dt>

[Регистрация объектов в таблице ROT](registering-objects-in-the-rot.md)
</dt> <dt>

[Самостоятельная регистрация](self-registration.md)
</dt> </dl>

 

 