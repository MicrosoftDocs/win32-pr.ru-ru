---
title: Привязка данных через Ипропертинотифисинк
description: Привязка данных через Ипропертинотифисинк
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d39c7277d27f0df6c185fc35a926aa98b77b91a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103779799"
---
# <a name="data-binding-through-ipropertynotifysink"></a><span data-ttu-id="a23a0-103">Привязка данных через Ипропертинотифисинк</span><span class="sxs-lookup"><span data-stu-id="a23a0-103">Data Binding through IPropertyNotifySink</span></span>

<span data-ttu-id="a23a0-104">Объекты, поддерживающие свойства, например, с помощью OLE-автоматизации и интерфейса **IDispatch** , могут получать уведомления клиентов при изменении значения определенных свойств.</span><span class="sxs-lookup"><span data-stu-id="a23a0-104">Objects that support properties, for example, through OLE Automation and the **IDispatch** interface, may want to allow clients to be notified when certain properties change value.</span></span> <span data-ttu-id="a23a0-105">Такое свойство называется связываемым, так как уведомления позволяют клиенту синхронизировать собственное отображение текущих значений свойств объекта.</span><span class="sxs-lookup"><span data-stu-id="a23a0-105">Such a property is called a bindable property because the notifications allow a client to synchronize its own display of the object's current property values.</span></span> <span data-ttu-id="a23a0-106">Кроме того, одни и те же объекты могут позволить клиенту контролировать, когда разрешено изменение определенных свойств.</span><span class="sxs-lookup"><span data-stu-id="a23a0-106">In addition, the same objects may wish to allow a client to control when certain properties are allowed to change.</span></span> <span data-ttu-id="a23a0-107">Такие свойства называются свойствами запроса на изменение.</span><span class="sxs-lookup"><span data-stu-id="a23a0-107">Such properties are called request edit properties.</span></span>

<span data-ttu-id="a23a0-108">[**Ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) — это стандартный интерфейс уведомления, поддерживающий привязку и изменение свойств запроса.</span><span class="sxs-lookup"><span data-stu-id="a23a0-108">The [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) is a standard notification interface that supports bindable and request-edit properties.</span></span> <span data-ttu-id="a23a0-109">**Ипропертинотифисинк** поддерживается из объекта со свойствами в качестве исходящего интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a23a0-109">**IPropertyNotifySink** is supported from an object with properties as an outgoing interface.</span></span> <span data-ttu-id="a23a0-110">То есть интерфейс реализуется объектом приемника клиента, а клиент подключает приемник к вспомогательному объекту через механизм точки подключения, описанный выше.</span><span class="sxs-lookup"><span data-stu-id="a23a0-110">That is, the interface itself is implemented by a client's sink object, and the client connects the sink to the supporting object through the connection point mechanism described earlier.</span></span> <span data-ttu-id="a23a0-111">**Ипропертинотифисинк** определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a23a0-111">The **IPropertyNotifySink** is defined as follows:</span></span>

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

<span data-ttu-id="a23a0-112">Когда объект хочет уведомить подключенные приемники о том, что свойство, которое может быть привязано к данному идентификатору DISPID, изменилось, оно вызывает [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="a23a0-112">When an object wishes to notify its connected sinks that a bindable property identified with a given DISPID has changed, it calls [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="a23a0-113">Если объект изменяет несколько свойств одновременно, он может передать Неизвестный идентификатор DISPID \_ неизвестному для **изменения** в случае, если клиент обновляет свой кэш всех интересующих значений свойств.</span><span class="sxs-lookup"><span data-stu-id="a23a0-113">If an object changes multiple properties at once, it can pass DISPID\_UNKNOWN to **OnChanged** in which case a client refreshes its cache of all property values of interest.</span></span>

<span data-ttu-id="a23a0-114">Когда свойство запроса изменения собирается изменить, объект может попросить клиента, будет ли он допускать это изменение.</span><span class="sxs-lookup"><span data-stu-id="a23a0-114">When a request edit property is about to change, an object can ask the client whether it will allow that change to occur.</span></span> <span data-ttu-id="a23a0-115">Объект вызывает [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) , ПЕРЕДАВ идентификатор DISPID рассматриваемого свойства (или DISPID \_ Unknown для обнаружения всех свойств).</span><span class="sxs-lookup"><span data-stu-id="a23a0-115">The object calls [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passing the DISPID of the property in question (or DISPID\_UNKNOWN to identify all properties).</span></span> <span data-ttu-id="a23a0-116">Приемник клиента возвращает "S" \_ , чтобы указать, что изменение разрешено, или \_ "ложь" (или "ошибка"), чтобы указать, что изменение не разрешено.</span><span class="sxs-lookup"><span data-stu-id="a23a0-116">The client's sink returns S\_OK to indicate that the change is allowed, or S\_FALSE (or an error) to indicate that change is not allowed.</span></span> <span data-ttu-id="a23a0-117">Когда объект вызывает **уведомление OnRequestEdit**, он должен соблюдать все пожелания клиента, следуя точной семантике параметров s \_ OK и s \_ false.</span><span class="sxs-lookup"><span data-stu-id="a23a0-117">When an object calls **OnRequestEdit**, it is required to obey the client's wishes by following the exact semantics of S\_OK and S\_FALSE return values.</span></span>

<span data-ttu-id="a23a0-118">Обратите внимание, что [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) нельзя использовать для проверки данных, так как во время вызова новое значение свойства пока недоступно.</span><span class="sxs-lookup"><span data-stu-id="a23a0-118">Note that [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) cannot be used for data validation because at the time of the call, the new value of the property is not yet available.</span></span> <span data-ttu-id="a23a0-119">Уведомление может использоваться только для управления состоянием только для чтения для свойства.</span><span class="sxs-lookup"><span data-stu-id="a23a0-119">The notification can only be used to control a read-only state for a property.</span></span>

<span data-ttu-id="a23a0-120">Объекты определяют, какие свойства могут быть привязаны, и запрашивают изменение и помечают такие свойства в сведениях о типе объекта.</span><span class="sxs-lookup"><span data-stu-id="a23a0-120">Objects control which properties are bindable and request edit and mark such properties in the object's type information.</span></span> <span data-ttu-id="a23a0-121">В сведениях о типе атрибут, допускающий привязку, помечает свойство как поддерживающее [**изменение**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="a23a0-121">In the type information, the attribute bindable marks a property as supporting [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="a23a0-122">Атрибут рекуестедит помечает свойство как поддерживающее [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span><span class="sxs-lookup"><span data-stu-id="a23a0-122">The attribute requestedit marks a property as supporting [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span></span>

<span data-ttu-id="a23a0-123">Одно свойство может поддерживать оба варианта поведения, в которых [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) вызывается первым, и только если разрешено изменение с именем [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) .</span><span class="sxs-lookup"><span data-stu-id="a23a0-123">One property can support both behaviors in which case [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) is called first, and only if change is allowed is [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) called.</span></span>

<span data-ttu-id="a23a0-124">Единственным исключением поведения таких свойств является то, что уведомления не отправляются в результате инициализации или загрузки объекта.</span><span class="sxs-lookup"><span data-stu-id="a23a0-124">The one exception to the behavior of such properties is that no notifications are sent as a result of an object's initialization or loading procedures.</span></span> <span data-ttu-id="a23a0-125">В таких случаях предполагается, что все свойства меняются, и все должно быть разрешено изменять.</span><span class="sxs-lookup"><span data-stu-id="a23a0-125">At such times, it is assumed that all properties change and that all must be allowed to change.</span></span> <span data-ttu-id="a23a0-126">Поэтому уведомления для этого интерфейса имеют смысл только в контексте полностью инициализированного или загруженного объекта.</span><span class="sxs-lookup"><span data-stu-id="a23a0-126">Notifications to this interface are therefore only meaningful in the context of a fully initialized/loaded object.</span></span>

<span data-ttu-id="a23a0-127">К свойствам в сведениях о типе объекта можно применить два других атрибута.</span><span class="sxs-lookup"><span data-stu-id="a23a0-127">Two other attributes can be applied to properties in an object's type information.</span></span> <span data-ttu-id="a23a0-128">Атрибут дефаултбинд помечает связываемое свойство как одно, которое лучше всего представляет состояние объекта в целом.</span><span class="sxs-lookup"><span data-stu-id="a23a0-128">The defaultbind attribute marks a bindable property as being the one that best represents the state of the object as a whole.</span></span> <span data-ttu-id="a23a0-129">Атрибут дисплайбинд помечает связываемое свойство как подходящее для вывода в пользовательском интерфейсе клиента.</span><span class="sxs-lookup"><span data-stu-id="a23a0-129">The displaybind attribute marks a bindable property as suitable for display in a client's own user interface.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a23a0-130">См. также</span><span class="sxs-lookup"><span data-stu-id="a23a0-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a23a0-131">Страницы свойств и вкладки свойств</span><span class="sxs-lookup"><span data-stu-id="a23a0-131">Property Pages and Property Sheets</span></span>](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




