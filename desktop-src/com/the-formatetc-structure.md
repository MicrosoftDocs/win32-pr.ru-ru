---
title: Структура ФОРМАТЕТК
description: Структура ФОРМАТЕТК представляет собой обобщенный формат буфера обмена, дополненный к целевому устройству, аспекту или представлению данных, а также носителю хранилища.
ms.assetid: 46d8988a-4b97-4c86-8b1b-db87044a7e01
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ece0079cf2c0f07b7356f07ee2c53b1279b7ce7
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103794058"
---
# <a name="the-formatetc-structure"></a><span data-ttu-id="4a45f-103">Структура ФОРМАТЕТК</span><span class="sxs-lookup"><span data-stu-id="4a45f-103">The FORMATETC Structure</span></span>

<span data-ttu-id="4a45f-104">Структура ФОРМАТЕТК представляет собой обобщенный формат буфера обмена, дополненный к целевому устройству, *аспекту* или представлению данных, а также носителю хранилища.</span><span class="sxs-lookup"><span data-stu-id="4a45f-104">The FORMATETC structure is a generalized clipboard format, enhanced to encompass a target device, an *aspect* or view of the data, and a storage medium.</span></span> <span data-ttu-id="4a45f-105">Потребитель данных, например приложение-контейнер OLE, передает структуру [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) в качестве аргумента в вызовах [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , чтобы указать тип данных, которые он желает из источника данных, например объект составного документа.</span><span class="sxs-lookup"><span data-stu-id="4a45f-105">A data consumer, such as an OLE container application, passes the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as an argument in calls to [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) to indicate the type of data it wants from a data source, such as a compound document object.</span></span> <span data-ttu-id="4a45f-106">Источник использует структуру **форматетк** для описания форматов, которые он может предоставить.</span><span class="sxs-lookup"><span data-stu-id="4a45f-106">The source uses the **FORMATETC** structure to describe what formats it can provide.</span></span>

<span data-ttu-id="4a45f-107">[**Форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) может описывать практически любые данные, в том числе другие объекты, такие как моникеры.</span><span class="sxs-lookup"><span data-stu-id="4a45f-107">[**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) can describe virtually any data, including other objects such as monikers.</span></span> <span data-ttu-id="4a45f-108">Контейнер может запросить один из своих внедренных объектов, чтобы получить список его форматов данных, вызвав [**IDataObject:: енумформатетк**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), который возвращает объект перечислителя, реализующий интерфейс [**иенумформатетк**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) .</span><span class="sxs-lookup"><span data-stu-id="4a45f-108">A container can ask one of its embedded objects to list its data formats by calling [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), which returns an enumerator object that implements the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface.</span></span> <span data-ttu-id="4a45f-109">Вместо ответа просто, что он имеет текст и точечный рисунок, объект может предоставить подробное описание данных, включая устройство (обычно экран или принтер), для которого он отображается, аспект, отображаемый пользователю (полное содержимое, эскиз, значок или отформатированный для печати), и носитель, содержащий данные (глобальная память, дисковый файл, объект хранилища или Stream).</span><span class="sxs-lookup"><span data-stu-id="4a45f-109">Instead of replying merely that it has "text and a bitmap," the object can provide a detailed description of the data, including the device (normally screen or printer) for which it is rendered, the aspect to be presented to the user (full contents, thumbnail, icon, or formatted for printing), and the storage medium containing the data (global memory, disk file, storage object, or stream).</span></span> <span data-ttu-id="4a45f-110">Эта возможность тесно описывать данные, в то же время, обеспечивает более высокое качество вывода на печать и на экране, а также повышает эффективность просмотра данных, где эскиз эскиза гораздо быстрее извлекается и отображается, чем полностью детализированная отрисовка.</span><span class="sxs-lookup"><span data-stu-id="4a45f-110">This ability to tightly describe data will, in time, result in higher quality printer and screen output as well as more efficiency in data browsing, where a thumbnail sketch is much faster to retrieve and display than a fully detailed rendering.</span></span>

<span data-ttu-id="4a45f-111">В следующей таблице перечислены поля структуры данных [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) и указанная ими информация.</span><span class="sxs-lookup"><span data-stu-id="4a45f-111">The following table lists fields of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) data structure and the information that they specify.</span></span>



| <span data-ttu-id="4a45f-112">Поле</span><span class="sxs-lookup"><span data-stu-id="4a45f-112">Field</span></span>                   | <span data-ttu-id="4a45f-113">Что определяет</span><span class="sxs-lookup"><span data-stu-id="4a45f-113">Specifies</span></span>                                                                                                                                                                                                                                                                    |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4a45f-114">**кфформат**</span><span class="sxs-lookup"><span data-stu-id="4a45f-114">**cfFormat**</span></span><br/> | <span data-ttu-id="4a45f-115">Формат, в котором данные должны быть визуализированы, что может быть стандартным форматом буфера обмена, собственным форматом или форматом OLE.</span><span class="sxs-lookup"><span data-stu-id="4a45f-115">The format in which the data is to be rendered, which can be a standard clipboard format, a proprietary format, or an OLE format.</span></span> <span data-ttu-id="4a45f-116">Дополнительные сведения о форматах OLE см. в разделе [составные документы](compound-documents.md).</span><span class="sxs-lookup"><span data-stu-id="4a45f-116">For more information on OLE formats, see [Compound Documents](compound-documents.md).</span></span><br/>                                          |
| <span data-ttu-id="4a45f-117">**ptd**</span><span class="sxs-lookup"><span data-stu-id="4a45f-117">**ptd**</span></span><br/>      | <span data-ttu-id="4a45f-118">Структура [**двтаржетдевице**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , которая содержит достаточно информации о целевом устройстве Windows, таком как экран или принтер, чтобы можно было создать обработчик контекста устройства (HDC) с помощью функции [**креатедк**](/windows/desktop/api/wingdi/nf-wingdi-createdca) .</span><span class="sxs-lookup"><span data-stu-id="4a45f-118">A [**DVTARGETDEVICE**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) structure, which contains enough information about a Windows target device, such as a screen or printer, so that a handle to its device context (hDC) can be created using the [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) function.</span></span> <br/> |
| <span data-ttu-id="4a45f-119">**дваспект**</span><span class="sxs-lookup"><span data-stu-id="4a45f-119">**dwAspect**</span></span><br/> | <span data-ttu-id="4a45f-120">Аспект или представление данных для подготовки к просмотру; может быть полным содержимым, эскизом эскиза, значком или отформатированным для печати.</span><span class="sxs-lookup"><span data-stu-id="4a45f-120">The aspect or view of the data to be rendered; can be the full contents, a thumbnail sketch, an icon, or formatted for printing.</span></span><br/>                                                                                                                                  |
| <span data-ttu-id="4a45f-121">**линдекс**</span><span class="sxs-lookup"><span data-stu-id="4a45f-121">**lindex**</span></span><br/>   | <span data-ttu-id="4a45f-122">Часть аспекта, представляющая интерес; в настоящее время значение должно быть равно-1, что означает, что все представление является интересным.</span><span class="sxs-lookup"><span data-stu-id="4a45f-122">The part of the aspect that is of interest; for the present, the value must be -1, indicating that the entire view is of interest.</span></span><br/>                                                                                                                                |
| <span data-ttu-id="4a45f-123">**тимед**</span><span class="sxs-lookup"><span data-stu-id="4a45f-123">**tymed**</span></span><br/>    | <span data-ttu-id="4a45f-124">Среда хранения данных, которая может представлять собой глобальную память, дисковый файл или экземпляр одного из интерфейсов структурированного хранилища COM.</span><span class="sxs-lookup"><span data-stu-id="4a45f-124">The data's storage medium, which can be global memory, disk file, or an instance of one of COM's structured-storage interfaces.</span></span><br/>                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="4a45f-125">См. также</span><span class="sxs-lookup"><span data-stu-id="4a45f-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4a45f-126">Форматы данных и передачи мультимедиа</span><span class="sxs-lookup"><span data-stu-id="4a45f-126">Data Formats and Transfer Media</span></span>](data-formats-and-transfer-media.md)
</dt> </dl>

 

