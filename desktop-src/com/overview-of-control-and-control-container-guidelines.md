---
title: Общие сведения о рекомендациях для контейнеров управления и управления
description: Общие сведения о рекомендациях для контейнеров управления и управления
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fd72851775898f4fd140c7d101d72993c34e3eb
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "103785587"
---
# <a name="overview-of-control-and-control-container-guidelines"></a><span data-ttu-id="35d3d-103">Общие сведения о рекомендациях для контейнеров управления и управления</span><span class="sxs-lookup"><span data-stu-id="35d3d-103">Overview of Control and Control Container Guidelines</span></span>

<span data-ttu-id="35d3d-104">Элемент управления ActiveX — это, по сути, простой объект OLE, поддерживающий интерфейс [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="35d3d-104">An ActiveX control is essentially a simple OLE object that supports the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="35d3d-105">Как правило, он поддерживает больше интерфейсов, чтобы обеспечить функциональность, но все дополнительные интерфейсы можно просматривать как необязательные и, таким образом, контейнер элемента управления не должен полагаться на поддерживаемые дополнительные интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="35d3d-105">It will usually support more interfaces in order to offer functionality, but all additional interfaces may be viewed as optional and as such, a control container should not rely on any additional interfaces being supported.</span></span> <span data-ttu-id="35d3d-106">Если не указать дополнительные интерфейсы, которые должен поддерживать элемент управления, элемент управления может эффективно ориентироваться на конкретную область функциональности без необходимости поддержки определенных интерфейсов для определения в качестве элемента управления.</span><span class="sxs-lookup"><span data-stu-id="35d3d-106">By not specifying additional interfaces that a control must support, a control may efficiently target a particular area of functionality without having to support particular interfaces to qualify as a control.</span></span> <span data-ttu-id="35d3d-107">Как и в случае с OLE, как в элементе управления, так и в контейнере элемента управления, никогда не следует предполагать, что интерфейс доступен и стандартные соглашения проверки возврата должны выполняться всегда.</span><span class="sxs-lookup"><span data-stu-id="35d3d-107">As always with OLE, whether in a control or a control container, it should never be assumed that an interface is available and standard return-checking conventions should always be followed.</span></span> <span data-ttu-id="35d3d-108">Очень важно, чтобы контейнер элемента управления или элемента управления был корректно отключен и предлагал другие функциональные возможности, если необходимый интерфейс недоступен.</span><span class="sxs-lookup"><span data-stu-id="35d3d-108">It is important for a control or control container to degrade gracefully and offer alternative functionality if an interface required is not available.</span></span>

<span data-ttu-id="35d3d-109">Контейнер элементов управления ActiveX должен иметь возможность размещения минимального элемента управления ActiveX; Он также будет поддерживать ряд дополнительных интерфейсов, как указано в [контейнерах](containers.md).</span><span class="sxs-lookup"><span data-stu-id="35d3d-109">An ActiveX control container must be able to host a minimal ActiveX control; it will also support a number of additional interfaces as specified in [Containers](containers.md).</span></span> <span data-ttu-id="35d3d-110">Существует ряд интерфейсов и методов, которые контейнер может дополнительно поддерживать, которые группируются в функциональные области, известные как *категории компонентов*.</span><span class="sxs-lookup"><span data-stu-id="35d3d-110">There are a number of interfaces and methods that a container may optionally support, which are grouped into functional areas known as *component categories*.</span></span> <span data-ttu-id="35d3d-111">Контейнер может поддерживать любое сочетание категорий компонентов, например, существует категория компонента для привязки данных, а контейнер может или не поддерживать функциональность привязки данных в зависимости от потребностей рынка контейнера.</span><span class="sxs-lookup"><span data-stu-id="35d3d-111">A container may support any combination of component categories, for example, a component category exists for databinding and a container may or may not support the databinding functionality, depending on the market needs of the container.</span></span> <span data-ttu-id="35d3d-112">Если элементу управления требуется поддержка привязки данных из контейнера для функционирования, это требование будет введено в реестр.</span><span class="sxs-lookup"><span data-stu-id="35d3d-112">If a control needs databinding support from a container to function, then it will enter this requirement in the registry.</span></span> <span data-ttu-id="35d3d-113">Это позволяет контейнеру элемента управления предлагать только вставку элементов управления, которые он может успешно разместить.</span><span class="sxs-lookup"><span data-stu-id="35d3d-113">This allows a control container to only offer for insertion those controls that it knows it can successfully host.</span></span> <span data-ttu-id="35d3d-114">Важно отметить, что категории компонентов задаются как часть OLE и не относятся к элементам управления ActiveX. Архитектура элементов управления использует категории компонентов для указания областей функциональности, которые может поддерживать компонент OLE.</span><span class="sxs-lookup"><span data-stu-id="35d3d-114">It is important to note that component categories are specified as part of OLE and are not specific to ActiveX controls, the controls architecture uses component categories to identify areas of functionality that an OLE component may support.</span></span> <span data-ttu-id="35d3d-115">Категории компонентов не являются кумулятивными или эксклюзивными, поэтому контейнер элементов управления может поддерживать одну категорию без обязательной поддержки другой.</span><span class="sxs-lookup"><span data-stu-id="35d3d-115">Component categories are not cumulative or exclusive, so a control container can support one category without necessarily supporting another.</span></span>

<span data-ttu-id="35d3d-116">Важно, чтобы элементы управления, требующие дополнительных функций, были четко упакованы и вырынке с этими требованиями.</span><span class="sxs-lookup"><span data-stu-id="35d3d-116">It is important for controls that require optional features, or features specific to a certain container to be clearly packaged and marketed with those requirements.</span></span> <span data-ttu-id="35d3d-117">Аналогичные контейнеры, которые предлагают определенные функции или категории компонентов, должны быть вырынке и упакованы как предложения этих уровней поддержки при размещении элементов управления ActiveX.</span><span class="sxs-lookup"><span data-stu-id="35d3d-117">Similarly containers that offer certain features or component categories must be marketed and packaged as offering those levels of support when hosting ActiveX controls.</span></span> <span data-ttu-id="35d3d-118">Рекомендуется, чтобы элементы управления настраиваются и проверяются с максимально возможной подмножеством контейнеров, что может привести к снижению или альтернативной функциональности, если интерфейсы или методы недоступны.</span><span class="sxs-lookup"><span data-stu-id="35d3d-118">It is recommended that controls target and test with as many containers as possible and degrade gracefully to offer less or alternative functionality if interfaces or methods are not available.</span></span> <span data-ttu-id="35d3d-119">В ситуации, когда элемент управления не может выполнить назначенную функцию задания без поддержки категории компонента, эта категория должна быть введена как требование в реестре, чтобы предотвратить вставку элемента управления в недопустимый контейнер.</span><span class="sxs-lookup"><span data-stu-id="35d3d-119">In a situation where a control cannot perform its designated job function without the support of a component category, that category should be entered as a requirement in the registry in order to prevent the control being inserted in an inappropriate container.</span></span>

<span data-ttu-id="35d3d-120">Эти рекомендации определяют интерфейсы и методы, которые элемент управления может использовать для поддержки контейнера элемента управления, хотя, как всегда элемент управления должен проверять возвращаемые значения при использовании [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) или других методов для получения указателей на эти интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="35d3d-120">These guidelines define those interfaces and methods that a control may expect a control container to support, although as always a control should check the return values when using [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) or other methods to obtain pointers to these interfaces.</span></span> <span data-ttu-id="35d3d-121">Контейнер не должен предполагать, что элемент управления поддерживает что-либо больше, чем интерфейс [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , и эти рекомендации определяют, какие интерфейсы могут поддерживаться элементом управления, и каково присутствие определенного интерфейса.</span><span class="sxs-lookup"><span data-stu-id="35d3d-121">A container should not expect a control to support anything more than the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, and these guidelines identify what interfaces a control may support and what the presence of a particular interface means.</span></span>

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a><span data-ttu-id="35d3d-122">Почему важны рекомендации по использованию элементов управления ActiveX и контейнеров</span><span class="sxs-lookup"><span data-stu-id="35d3d-122">Why the ActiveX Control and Control Container Guidelines Are Important</span></span>

<span data-ttu-id="35d3d-123">Элементы управления ActiveX стали основной архитектурой для разработки программируемых программных компонентов для использования в различных контейнерах, начиная от средств разработки программного обеспечения до средств повышения производительности конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="35d3d-123">ActiveX Controls have become the primary architecture for developing programmable software components for use in a variety of different containers ranging from software development tools to end-user productivity tools.</span></span> <span data-ttu-id="35d3d-124">Чтобы элемент управления хорошо работал в различных контейнерах, элемент управления должен иметь возможность предполагать некоторый минимальный уровень функциональности, который может полагаться на все контейнеры.</span><span class="sxs-lookup"><span data-stu-id="35d3d-124">In order for a control to operate well in a variety of containers, the control must be able to assume some minimum level of functionality that it can rely on in all containers.</span></span>

<span data-ttu-id="35d3d-125">Следуя этим рекомендациям, разработчики элементов управления и контейнеров делают свои элементы управления и контейнеры более надежными и совместимыми, а в конечном итоге — более удобные и более удобные компоненты для создания решений на основе компонентов.</span><span class="sxs-lookup"><span data-stu-id="35d3d-125">By following these guidelines, control and container developers make their controls and containers more reliable and interoperable, and ultimately, better and more usable components for building component-based solutions.</span></span>

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a><span data-ttu-id="35d3d-126">Что делать, если необходимый интерфейс недоступен</span><span class="sxs-lookup"><span data-stu-id="35d3d-126">What to Do When an Interface You Need Is Not Available</span></span>

<span data-ttu-id="35d3d-127">Программы OLE должны использовать [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) для получения указателей на интерфейсы и должны проверять возвращаемое значение.</span><span class="sxs-lookup"><span data-stu-id="35d3d-127">OLE programs should use [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) to acquire interface pointers, and must check the return value.</span></span> <span data-ttu-id="35d3d-128">Приложения OLE не могут безопасно предположить, что **QueryInterface** будет успешно выполнен.</span><span class="sxs-lookup"><span data-stu-id="35d3d-128">OLE applications cannot safely assume that **QueryInterface** will succeed.</span></span>

<span data-ttu-id="35d3d-129">Это требование относится ко всем приложениям OLE.</span><span class="sxs-lookup"><span data-stu-id="35d3d-129">This requirement applies to all OLE applications.</span></span> <span data-ttu-id="35d3d-130">Если запрашиваемый интерфейс недоступен (т. е. [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) возвращает E \_ -интерфейс), элемент управления или контейнер должен быть корректно устранен, даже если это означает, что он не может выполнить назначенную функцию задания.</span><span class="sxs-lookup"><span data-stu-id="35d3d-130">If the requested interface is not available (that is, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE), the control or container must degrade gracefully, even if that means that it cannot perform its designated job function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="35d3d-131">См. также</span><span class="sxs-lookup"><span data-stu-id="35d3d-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="35d3d-132">Рекомендации по контейнерам элементов управления и элементов управления ActiveX</span><span class="sxs-lookup"><span data-stu-id="35d3d-132">ActiveX Control and Control Container Guidelines</span></span>](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




