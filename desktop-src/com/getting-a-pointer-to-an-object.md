---
title: Получение указателя на объект
description: Получение указателя на объект
ms.assetid: 4af9d356-402b-4e69-9f6e-8589057d3ac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fc588518d5c3da884755d7db122738ca2fca257d76a1f8219867da357ef8444f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117736703"
---
# <a name="getting-a-pointer-to-an-object"></a>Получение указателя на объект

Поскольку модель COM не имеет классической модели, существует четыре способа создания экземпляра или получения указателя на интерфейс объекта.

-   Вызов функции библиотеки COM, которая создает объект предопределенного типа; то есть функция возвращает указатель на только один конкретный интерфейс для конкретного класса объектов.
-   Вызов функции библиотеки COM, которая может создать объект на основе идентификатора класса (CLSID) и возвращать любой тип запрошенного указателя интерфейса.
-   Вызовите метод некоторого интерфейса, который создает другой объект (или соединяется с существующим) и возвращает указатель интерфейса на этот отдельный объект.
-   Реализуйте объект с интерфейсом, через который другие объекты передают указатель интерфейса непосредственно клиенту.

Сведения о получении указателей на другие интерфейсы объекта после получения первого из них см. [в разделе QueryInterface: Навигация в объекте](queryinterface--navigating-in-an-object.md).

## <a name="creating-an-object-of-a-predetermined-type"></a>Создание объекта предопределенного типа

Существует множество функций COM, таких как [**кожетмаллок**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), которые возвращают указатели на определенные реализации интерфейса. (**Кожетмаллок** получает указатель на стандартный распределитель памяти com.) Большинство из них являются вспомогательными функциями, и большинство этих функций описаны в разделах справки этой документации в определенной области, с которой они связаны, например в хранилище или при переносе данных.

## <a name="creating-an-object-based-on-a-clsid"></a>Создание объекта на основе идентификатора CLSID

Существует несколько функций, которые могут вызываться клиентом для создания экземпляра объекта и получения указателя на него. Все эти функции основаны на функции [**кожетклассобжект**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), которая создает объект класса и предоставляет указатель на интерфейс, который позволяет создавать экземпляры этого класса. Хотя должны быть сведения, указывающие, в какой системе находится сервер, не требуется, чтобы эта информация содержалась в клиенте. Клиент должен быть в курсе только идентификатора CLSID и никогда не является абсолютным путем к серверному коду. Дополнительные сведения см. в разделе [Создание объекта с помощью объекта класса](creating-an-object-through-a-class-object.md).

## <a name="returning-a-pointer-to-a-separate-object"></a>Возвращение указателя на отдельный объект

Между многими методами интерфейса, которые возвращают указатель на отдельный объект, относятся несколько, которые создают и возвращают указатель на *объект перечислителя*, который позволяет определить, сколько элементов данного типа поддерживается объектом. COM определяет интерфейсы для перечисления широкого спектра элементов, таких как строки, важные структуры, моникеры и указатели интерфейса [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) . Типичным способом создания экземпляра перечислителя и получения указателя на его интерфейс является вызов метода из другого интерфейса. Например, интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) определяет два метода, [**енумдадвисе**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) и [**енумформатетк**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), которые возвращают указатели на интерфейсы двух различных объектов перечисления. Существует множество других примеров в COM методов, которые возвращают указатели на объекты, например интерфейс составного документа OLE [**иолеобжект:: жетклиентсите**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), который при вызове для внедренного или связанного объекта возвращает указатель на реализацию [**иолеклиентсите**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)объекта контейнера.

## <a name="implementing-an-object-through-which-to-pass-an-interface-pointer-directly-to-the-client"></a>Реализация объекта, через который передается указатель интерфейса непосредственно клиенту

Когда двум объектам, например контейнеру составного документа OLE и серверу, требуется двунаправленная связь, каждый из них реализует объект, содержащий метод интерфейса, с помощью которого он может передать указатель интерфейса другому объекту. Реализующий объект, который также является клиентом созданного объекта, может затем вызвать метод и получить переданный указатель.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[COM-клиенты и серверы](com-clients-and-servers.md)
</dt> <dt>

[Обязанности сервера COM](com-server-responsibilities.md)
</dt> </dl>

 

 




