---
title: Моникеры элементов
description: Другим реализованным OLE классом моникера является моникер элемента, который можно использовать для обнаружения объекта, содержащегося в другом объекте.
ms.assetid: ddcf3669-4ad0-4a4e-80a6-eb78058cff09
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57b692502ba44519a2c51a661ef62a51e133ac04
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105700473"
---
# <a name="item-monikers"></a><span data-ttu-id="af645-103">Моникеры элементов</span><span class="sxs-lookup"><span data-stu-id="af645-103">Item Monikers</span></span>

<span data-ttu-id="af645-104">Другим реализованным OLE классом моникера является *моникер элемента*, который можно использовать для обнаружения объекта, содержащегося в другом объекте.</span><span class="sxs-lookup"><span data-stu-id="af645-104">Another OLE-implemented moniker class is the *item moniker*, which can be used to identify an object contained in another object.</span></span> <span data-ttu-id="af645-105">Один из типов содержащих объектов — это объект OLE, внедренный в составной документ.</span><span class="sxs-lookup"><span data-stu-id="af645-105">One type of contained object is an OLE object embedded in a compound document.</span></span> <span data-ttu-id="af645-106">Составной документ может обозначать внедренные содержащиеся в нем объекты, назначив каждому из них произвольное имя, например "embedobj1", "embedobj2" и т. д.</span><span class="sxs-lookup"><span data-stu-id="af645-106">A compound document could identify the embedded objects it contains by assigning each one an arbitrary name, such as "embedobj1," "embedobj2," and so forth.</span></span> <span data-ttu-id="af645-107">Другой тип автономного объекта — это выбор пользователя в документе, например диапазон ячеек в электронной таблице или диапазон символов в текстовом документе.</span><span class="sxs-lookup"><span data-stu-id="af645-107">Another type of contained object is a user selection in a document, such as a range of cells in a spreadsheet or a range of characters in a text document.</span></span> <span data-ttu-id="af645-108">Объект, состоящий из выделенного фрагмента, называется *псевдо-объектом* , так как он не обрабатывается как отдельный объект, пока пользователь не помечает выделение.</span><span class="sxs-lookup"><span data-stu-id="af645-108">An object that consists of a selection is called a *pseudo-object* because it isn't treated as a distinct object until a user marks the selection.</span></span> <span data-ttu-id="af645-109">Электронная таблица может обозначать диапазон ячеек с помощью имени «1A: 7F», а документ обработки текста может обозначать диапазон символов, используя имя закладки.</span><span class="sxs-lookup"><span data-stu-id="af645-109">A spreadsheet might identify a cell range using a name such as "1A:7F," while a word processing document might identify a range of characters using the name of a bookmark.</span></span>

<span data-ttu-id="af645-110">Моникер элемента полезен в основном при объединении или *составлении* с другим моникером, который идентифицирует контейнер.</span><span class="sxs-lookup"><span data-stu-id="af645-110">An item moniker is useful primarily when concatenated, or *composed*, with another moniker, one that identifies the container.</span></span> <span data-ttu-id="af645-111">Обычно создается моникер элемента, который затем состоялся в (например,) моникере файла для создания эквивалента полного пути к объекту.</span><span class="sxs-lookup"><span data-stu-id="af645-111">An item moniker is usually created and then composed onto (for example) a file moniker to create the equivalent of a complete path to the object.</span></span> <span data-ttu-id="af645-112">Например, можно составить моникер файла "c: \\ рабочий \\report.doc" (который идентифицирует объект-контейнер) с моникером элемента "embedobj1" (который определяет объект в контейнере) для формирования моникера "c: \\ Рабочий \\report.doc\\ embedobj1", который однозначно определяет конкретный объект в определенном файле.</span><span class="sxs-lookup"><span data-stu-id="af645-112">For example, you can compose the file moniker "c:\\work\\report.doc" (which identifies the container object) with the item moniker "embedobj1" (which identifies an object within the container) to form the moniker "c:\\work\\report.doc\\embedobj1," which uniquely identifies a particular object within a particular file.</span></span> <span data-ttu-id="af645-113">Кроме того, можно объединять дополнительные моникеры элементов для обнаружения глубоко вложенных объектов.</span><span class="sxs-lookup"><span data-stu-id="af645-113">You can also concatenate additional item monikers to identify deeply nested objects.</span></span> <span data-ttu-id="af645-114">Например, если "embedobj1" является именем объекта электронной таблицы, для обнаружения определенного диапазона ячеек в этом объекте электронной таблицы можно добавить моникер другого элемента, чтобы создать моникер, эквивалентный "c: \\ рабочий \\report.doc\\ Embedobj1 \\ 1a: 7F."</span><span class="sxs-lookup"><span data-stu-id="af645-114">For example, if "embedobj1" is the name of a spreadsheet object, to identify a certain range of cells in that spreadsheet object you could append another item moniker to create a moniker that would be the equivalent of "c:\\work\\report.doc\\embedobj1\\1A:7F."</span></span>

<span data-ttu-id="af645-115">При объединении с моникером файла моникер элемента формирует полный путь.</span><span class="sxs-lookup"><span data-stu-id="af645-115">When combined with a file moniker, an item moniker forms a complete path.</span></span> <span data-ttu-id="af645-116">Таким же моникеры элементов расширяют понятие имен путей за пределами файловой системы, определяя имена путей для определения отдельных объектов, а не только файлов.</span><span class="sxs-lookup"><span data-stu-id="af645-116">Item monikers thus extend the notion of path names beyond the file system, defining path names to identify individual objects, not just files.</span></span>

<span data-ttu-id="af645-117">Между моникером элемента и моникером файла существует существенная разница.</span><span class="sxs-lookup"><span data-stu-id="af645-117">There is a significant difference between an item moniker and a file moniker.</span></span> <span data-ttu-id="af645-118">Путь, содержащийся в моникере файла, имеет смысл для всех, кто понимает файловую систему, а частичный путь, содержащийся в моникере элемента, имеет смысл только для конкретного контейнера.</span><span class="sxs-lookup"><span data-stu-id="af645-118">The path contained in a file moniker is meaningful to anyone who understands the file system, while the partial path contained in an item moniker is meaningful only to a particular container.</span></span> <span data-ttu-id="af645-119">Все знают, на что ссылается "c: \\ рабочая \\report.doc", но только один конкретный объект контейнера знает, на что ссылается "1a: 7F".</span><span class="sxs-lookup"><span data-stu-id="af645-119">Everyone knows what "c:\\work\\report.doc" refers to, but only one particular container object knows what "1A:7F" refers to.</span></span> <span data-ttu-id="af645-120">Один контейнер не может интерпретировать моникер элемента, созданный другим приложением; единственный контейнер, который знает, на какой объект ссылается моникер элемента, — это контейнер, который в первую очередь назначил моникер элемента для объекта.</span><span class="sxs-lookup"><span data-stu-id="af645-120">One container cannot interpret an item moniker created by another application; the only container that knows which object is referred to by an item moniker is the container that assigned the item moniker to the object in the first place.</span></span> <span data-ttu-id="af645-121">По этой причине источник объекта, именуемый сочетанием моникера файла и элемента, должен не только реализовывать [**IPersistFile**](/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile), чтобы упростить привязку моникера файла, но также [**иолеитемконтаинер**](/windows/desktop/api/OleIdl/nn-oleidl-ioleitemcontainer) , чтобы упростить разрешение имени моникера элемента в соответствующий объект в контексте файла.</span><span class="sxs-lookup"><span data-stu-id="af645-121">For this reason, the source of the object named by the combination of a file and item moniker must not only implement [**IPersistFile**](/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile), to facilitate binding the file moniker, but also [**IOleItemContainer**](/windows/desktop/api/OleIdl/nn-oleidl-ioleitemcontainer) to facilitate resolving the name of the item moniker into the appropriate object, in the context of a file.</span></span>

<span data-ttu-id="af645-122">Преимуществом моникеров является то, что кто-то, использующий моникер для размещения объекта, не должен знать имя, которое содержится в моникере элемента, если моникер элемента является частью составного.</span><span class="sxs-lookup"><span data-stu-id="af645-122">The advantage of monikers is that someone using a moniker to locate an object doesn't need to understand the name contained within the item moniker, as long as the item moniker is part of a composite.</span></span> <span data-ttu-id="af645-123">Как правило, существование моникера элемента не имеет смысла.</span><span class="sxs-lookup"><span data-stu-id="af645-123">Generally, it would not make sense for an item moniker to exist on its own.</span></span> <span data-ttu-id="af645-124">Вместо этого следует составить моникер элемента в моникер файла.</span><span class="sxs-lookup"><span data-stu-id="af645-124">Instead, you would compose an item moniker onto a file moniker.</span></span> <span data-ttu-id="af645-125">Затем следует вызвать [**IMoniker:: биндтубжект**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) для составного, который привязывает отдельные моникеры внутри него, обрабатывая имена.</span><span class="sxs-lookup"><span data-stu-id="af645-125">You would then call [**IMoniker::BindToObject**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) on the composite, which binds the individual monikers within it, interpreting the names.</span></span>

<span data-ttu-id="af645-126">Чтобы создать объект моникера элемента и вернуть его указатель на поставщика моникера, OLE предоставляет вспомогательную функцию [**креатеитеммоникер**](/windows/desktop/api/Objbase/nf-objbase-createitemmoniker).</span><span class="sxs-lookup"><span data-stu-id="af645-126">To create an item moniker object and return its pointer to the moniker provider, OLE provides the helper function [**CreateItemMoniker**](/windows/desktop/api/Objbase/nf-objbase-createitemmoniker).</span></span> <span data-ttu-id="af645-127">Эта функция создает объект моникера элемента и возвращает его указатель на поставщик.</span><span class="sxs-lookup"><span data-stu-id="af645-127">This function creates an item moniker object and returns its pointer to the provider.</span></span>

## <a name="related-topics"></a><span data-ttu-id="af645-128">См. также</span><span class="sxs-lookup"><span data-stu-id="af645-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="af645-129">Специальные имена</span><span class="sxs-lookup"><span data-stu-id="af645-129">Anti-Monikers</span></span>](anti-monikers.md)
</dt> <dt>

[<span data-ttu-id="af645-130">Моникеры класса</span><span class="sxs-lookup"><span data-stu-id="af645-130">Class Monikers</span></span>](class-monikers.md)
</dt> <dt>

[<span data-ttu-id="af645-131">Составные моникеры</span><span class="sxs-lookup"><span data-stu-id="af645-131">Composite Monikers</span></span>](composite-monikers.md)
</dt> <dt>

[<span data-ttu-id="af645-132">Моникеры файлов</span><span class="sxs-lookup"><span data-stu-id="af645-132">File Monikers</span></span>](file-monikers.md)
</dt> <dt>

[<span data-ttu-id="af645-133">Моникеры указателей</span><span class="sxs-lookup"><span data-stu-id="af645-133">Pointer Monikers</span></span>](pointer-monikers.md)
</dt> </dl>

 

 




