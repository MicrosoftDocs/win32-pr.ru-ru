---
title: Стратегии обработки ошибок
description: Стратегии обработки ошибок
ms.assetid: 8d03ede8-0661-43dc-adaf-3c1f5fc1687e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36c594a8b1e5baf0eab3d928b8f1b861b7f0160d
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "104487268"
---
# <a name="error-handling-strategies"></a><span data-ttu-id="59b6f-103">Стратегии обработки ошибок</span><span class="sxs-lookup"><span data-stu-id="59b6f-103">Error Handling Strategies</span></span>

<span data-ttu-id="59b6f-104">Поскольку методы интерфейса являются виртуальными, вызывающий объект не может получить информацию о полном наборе значений, которые могут быть возвращены из любого вызова.</span><span class="sxs-lookup"><span data-stu-id="59b6f-104">Because interface methods are virtual, it is not possible for a caller to know the full set of values that may be returned from any one call.</span></span> <span data-ttu-id="59b6f-105">Одна реализация метода может возвращать пять значений; другой может вернуть восемь.</span><span class="sxs-lookup"><span data-stu-id="59b6f-105">One implementation of a method may return five values; another may return eight.</span></span>

<span data-ttu-id="59b6f-106">В документации перечислены общие значения, которые могут возвращаться для каждого метода. Это значения, которые необходимо проверить и обрабатывать в коде, так как они имеют особые значения.</span><span class="sxs-lookup"><span data-stu-id="59b6f-106">The documentation lists common values that may be returned for each method; these are the values that you must check for and handle in your code because they have special meanings.</span></span> <span data-ttu-id="59b6f-107">Другие значения могут быть возвращены, но, поскольку они не имеют смысла, писать специальный код для их обработке не требуется.</span><span class="sxs-lookup"><span data-stu-id="59b6f-107">Other values may be returned, but because they are not meaningful, you do not need to write special code to handle them.</span></span> <span data-ttu-id="59b6f-108">Простая проверка нулевого или ненулевого значения является достаточной.</span><span class="sxs-lookup"><span data-stu-id="59b6f-108">A simple check for zero or nonzero is adequate.</span></span>

## <a name="hresult-values"></a><span data-ttu-id="59b6f-109">Значения HRESULT</span><span class="sxs-lookup"><span data-stu-id="59b6f-109">HRESULT Values</span></span>

<span data-ttu-id="59b6f-110">Возвращаемое значение функций и методов COM является значением **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="59b6f-110">The return value of COM functions and methods is an **HRESULT**.</span></span> <span data-ttu-id="59b6f-111">Значения некоторых значений HRESULT были изменены в COM, чтобы исключить все дублирование и перекрытие с кодами системных ошибок.</span><span class="sxs-lookup"><span data-stu-id="59b6f-111">The values of some HRESULTs have been changed in COM to eliminate all duplication and overlapping with the system error codes.</span></span> <span data-ttu-id="59b6f-112">Те, которые дублируют дублирование кодов системных ошибок, были изменены на \_ Win32 устройств, а те, которые перекрываются, остаются в \_ неопределенном виде.</span><span class="sxs-lookup"><span data-stu-id="59b6f-112">Those that duplicate system error codes have been changed to FACILITY\_WIN32, and those that overlap remain in FACILITY\_NULL.</span></span> <span data-ttu-id="59b6f-113">В следующей таблице перечислены общие значения **HRESULT** и их значения.</span><span class="sxs-lookup"><span data-stu-id="59b6f-113">Common **HRESULT** values and their values are listed in the following table.</span></span>



| <span data-ttu-id="59b6f-114">HRESULT</span><span class="sxs-lookup"><span data-stu-id="59b6f-114">HRESULT</span></span>                    | <span data-ttu-id="59b6f-115">Значение</span><span class="sxs-lookup"><span data-stu-id="59b6f-115">Value</span></span>                 | <span data-ttu-id="59b6f-116">Описание</span><span class="sxs-lookup"><span data-stu-id="59b6f-116">Description</span></span>                                                                                                                                        |
|----------------------------|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="59b6f-117">\_прервать</span><span class="sxs-lookup"><span data-stu-id="59b6f-117">E\_ABORT</span></span><br/>        | <span data-ttu-id="59b6f-118">0x80004004</span><span class="sxs-lookup"><span data-stu-id="59b6f-118">0x80004004</span></span><br/> | <span data-ttu-id="59b6f-119">Операция прервана из-за неизвестной ошибки.</span><span class="sxs-lookup"><span data-stu-id="59b6f-119">The operation was aborted because of an unspecified error.</span></span><br/>                                                                              |
| <span data-ttu-id="59b6f-120">E \_ ACCESSDENIED</span><span class="sxs-lookup"><span data-stu-id="59b6f-120">E\_ACCESSDENIED</span></span><br/> | <span data-ttu-id="59b6f-121">0x80070005</span><span class="sxs-lookup"><span data-stu-id="59b6f-121">0x80070005</span></span><br/> | <span data-ttu-id="59b6f-122">Общая ошибка отказа в доступе.</span><span class="sxs-lookup"><span data-stu-id="59b6f-122">A general access-denied error.</span></span><br/>                                                                                                          |
| <span data-ttu-id="59b6f-123">\_Ошибка E</span><span class="sxs-lookup"><span data-stu-id="59b6f-123">E\_FAIL</span></span><br/>         | <span data-ttu-id="59b6f-124">0x80004005</span><span class="sxs-lookup"><span data-stu-id="59b6f-124">0x80004005</span></span><br/> | <span data-ttu-id="59b6f-125">Произошла неопределенная ошибка.</span><span class="sxs-lookup"><span data-stu-id="59b6f-125">An unspecified failure has occurred.</span></span><br/>                                                                                                    |
| <span data-ttu-id="59b6f-126">E, \_ маркер</span><span class="sxs-lookup"><span data-stu-id="59b6f-126">E\_HANDLE</span></span><br/>       | <span data-ttu-id="59b6f-127">0x80070006</span><span class="sxs-lookup"><span data-stu-id="59b6f-127">0x80070006</span></span><br/> | <span data-ttu-id="59b6f-128">Использован недопустимый маркер.</span><span class="sxs-lookup"><span data-stu-id="59b6f-128">An invalid handle was used.</span></span><br/>                                                                                                             |
| <span data-ttu-id="59b6f-129">E \_ INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="59b6f-129">E\_INVALIDARG</span></span><br/>   | <span data-ttu-id="59b6f-130">0x80070057</span><span class="sxs-lookup"><span data-stu-id="59b6f-130">0x80070057</span></span><br/> | <span data-ttu-id="59b6f-131">Один или несколько аргументов недопустимы.</span><span class="sxs-lookup"><span data-stu-id="59b6f-131">One or more arguments are invalid.</span></span><br/>                                                                                                      |
| <span data-ttu-id="59b6f-132">\_интерфейс E</span><span class="sxs-lookup"><span data-stu-id="59b6f-132">E\_NOINTERFACE</span></span><br/>  | <span data-ttu-id="59b6f-133">0x80004002</span><span class="sxs-lookup"><span data-stu-id="59b6f-133">0x80004002</span></span><br/> | <span data-ttu-id="59b6f-134">Метод [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) не распознал запрошенный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="59b6f-134">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method did not recognize the requested interface.</span></span> <span data-ttu-id="59b6f-135">Интерфейс не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="59b6f-135">The interface is not supported.</span></span><br/> |
| <span data-ttu-id="59b6f-136">E \_ нотимпл</span><span class="sxs-lookup"><span data-stu-id="59b6f-136">E\_NOTIMPL</span></span><br/>      | <span data-ttu-id="59b6f-137">0x80004001</span><span class="sxs-lookup"><span data-stu-id="59b6f-137">0x80004001</span></span><br/> | <span data-ttu-id="59b6f-138">Метод не реализован.</span><span class="sxs-lookup"><span data-stu-id="59b6f-138">The method is not implemented.</span></span><br/>                                                                                                          |
| <span data-ttu-id="59b6f-139">E \_ OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="59b6f-139">E\_OUTOFMEMORY</span></span><br/>  | <span data-ttu-id="59b6f-140">0x8007000E</span><span class="sxs-lookup"><span data-stu-id="59b6f-140">0x8007000E</span></span><br/> | <span data-ttu-id="59b6f-141">Методу не удалось выделить необходимую память.</span><span class="sxs-lookup"><span data-stu-id="59b6f-141">The method failed to allocate necessary memory.</span></span><br/>                                                                                         |
| <span data-ttu-id="59b6f-142">\_в ожидании</span><span class="sxs-lookup"><span data-stu-id="59b6f-142">E\_PENDING</span></span><br/>      | <span data-ttu-id="59b6f-143">0x8000000A</span><span class="sxs-lookup"><span data-stu-id="59b6f-143">0x8000000A</span></span><br/> | <span data-ttu-id="59b6f-144">Данные, необходимые для завершения операции, пока недоступны.</span><span class="sxs-lookup"><span data-stu-id="59b6f-144">The data necessary to complete the operation is not yet available.</span></span><br/>                                                                      |
| <span data-ttu-id="59b6f-145">\_указатель E</span><span class="sxs-lookup"><span data-stu-id="59b6f-145">E\_POINTER</span></span><br/>      | <span data-ttu-id="59b6f-146">0x80004003</span><span class="sxs-lookup"><span data-stu-id="59b6f-146">0x80004003</span></span><br/> | <span data-ttu-id="59b6f-147">Использован недопустимый указатель.</span><span class="sxs-lookup"><span data-stu-id="59b6f-147">An invalid pointer was used.</span></span><br/>                                                                                                            |
| <span data-ttu-id="59b6f-148">\_непредвиденная E</span><span class="sxs-lookup"><span data-stu-id="59b6f-148">E\_UNEXPECTED</span></span><br/>   | <span data-ttu-id="59b6f-149">0x8000FFFF</span><span class="sxs-lookup"><span data-stu-id="59b6f-149">0x8000FFFF</span></span><br/> | <span data-ttu-id="59b6f-150">Произошла фатальная ошибка.</span><span class="sxs-lookup"><span data-stu-id="59b6f-150">A catastrophic failure has occurred.</span></span><br/>                                                                                                    |
| <span data-ttu-id="59b6f-151">S \_ false</span><span class="sxs-lookup"><span data-stu-id="59b6f-151">S\_FALSE</span></span><br/>        | <span data-ttu-id="59b6f-152">0x00000001</span><span class="sxs-lookup"><span data-stu-id="59b6f-152">0x00000001</span></span><br/> | <span data-ttu-id="59b6f-153">Метод завершился удачно и вернул логическое значение **false**.</span><span class="sxs-lookup"><span data-stu-id="59b6f-153">The method succeeded and returned the boolean value **FALSE**.</span></span><br/>                                                                          |
| <span data-ttu-id="59b6f-154">\_ОК</span><span class="sxs-lookup"><span data-stu-id="59b6f-154">S\_OK</span></span><br/>           | <span data-ttu-id="59b6f-155">0x00000000</span><span class="sxs-lookup"><span data-stu-id="59b6f-155">0x00000000</span></span><br/> | <span data-ttu-id="59b6f-156">Метод выполнен успешно.</span><span class="sxs-lookup"><span data-stu-id="59b6f-156">The method succeeded.</span></span> <span data-ttu-id="59b6f-157">Если ожидается логическое возвращаемое значение, возвращается значение **true**.</span><span class="sxs-lookup"><span data-stu-id="59b6f-157">If a boolean return value is expected, the returned value is **TRUE**.</span></span><br/>                                            |



 

## <a name="network-errors"></a><span data-ttu-id="59b6f-158">Ошибки сети</span><span class="sxs-lookup"><span data-stu-id="59b6f-158">Network Errors</span></span>

<span data-ttu-id="59b6f-159">Если первые четыре цифры кода ошибки 8007, это указывает на системную или сетевую ошибку.</span><span class="sxs-lookup"><span data-stu-id="59b6f-159">If the first four digits of the error code are 8007, this indicates a system or network error.</span></span> <span data-ttu-id="59b6f-160">Для декодирования ошибок этих типов можно использовать команду **net** .</span><span class="sxs-lookup"><span data-stu-id="59b6f-160">You can use the **net** command to decode these types of errors.</span></span> <span data-ttu-id="59b6f-161">Чтобы декодировать ошибку, сначала преобразуйте последние четыре цифры шестнадцатеричного кода ошибки в тип Decimal.</span><span class="sxs-lookup"><span data-stu-id="59b6f-161">To decode the error, first convert the last four digits of the hexadecimal error code to decimal.</span></span> <span data-ttu-id="59b6f-162">Затем в командной строке введите следующую команду, где десятичный код заменяется возвращаемым значением, которое необходимо декодировать:</span><span class="sxs-lookup"><span data-stu-id="59b6f-162">Then, at the command prompt, type the following, where decimal code is replaced with the return value you want to decode:</span></span>

<span data-ttu-id="59b6f-163">**NET HELPMSG <***десятичный \_ код***>**</span><span class="sxs-lookup"><span data-stu-id="59b6f-163">**net helpmsg <***decimal\_code***>**</span></span>

<span data-ttu-id="59b6f-164">Команда NET возвращает описание ошибки.</span><span class="sxs-lookup"><span data-stu-id="59b6f-164">The net command returns a description of the error.</span></span> <span data-ttu-id="59b6f-165">Например, если COM возвращает ошибку 8007054B, преобразуйте 054B в Decimal (1355).</span><span class="sxs-lookup"><span data-stu-id="59b6f-165">For example, if COM returns the error 8007054B, convert the 054B to decimal (1355).</span></span> <span data-ttu-id="59b6f-166">Затем введите следующую команду.</span><span class="sxs-lookup"><span data-stu-id="59b6f-166">Then type the following:</span></span>

<span data-ttu-id="59b6f-167">**NET HELPMSG 1355**</span><span class="sxs-lookup"><span data-stu-id="59b6f-167">**net helpmsg 1355**</span></span>

<span data-ttu-id="59b6f-168">Команда NET возвращает описание ошибки: "указанный домен не существует".</span><span class="sxs-lookup"><span data-stu-id="59b6f-168">The net command returns the error description: "The specified domain did not exist".</span></span>

## <a name="related-topics"></a><span data-ttu-id="59b6f-169">См. также</span><span class="sxs-lookup"><span data-stu-id="59b6f-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="59b6f-170">Обработка ошибок в COM</span><span class="sxs-lookup"><span data-stu-id="59b6f-170">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> </dl>

 

 





