---
title: Поддержка всплывающего меню
description: Поддержка всплывающего меню
ms.assetid: a8a1cf91-c18a-497f-89a7-b47536eaca0a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 890d7eab6595200cb00e8422644b10f39807bab2
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337345"
---
# <a name="pop-up-menu-support"></a><span data-ttu-id="6dd77-103">Поддержка всплывающего меню</span><span class="sxs-lookup"><span data-stu-id="6dd77-103">Pop-up Menu Support</span></span>

<span data-ttu-id="6dd77-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="6dd77-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="6dd77-105">Microsoft Agent включает в себя всплывающее меню (также называемое контекстным меню) для каждого символа.</span><span class="sxs-lookup"><span data-stu-id="6dd77-105">Microsoft Agent includes a pop-up menu (also known as a contextual menu) for each character.</span></span> <span data-ttu-id="6dd77-106">Сервер отображает это всплывающее меню автоматически, когда пользователь щелкает символ правой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="6dd77-106">The server displays this pop-up menu automatically when a user right-clicks the character.</span></span> <span data-ttu-id="6dd77-107">Вы можете добавить команды для клиентского приложения в меню, определив коллекцию [**команд**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="6dd77-107">You can add commands for your client application to the menu by defining a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="6dd77-108">Для каждой команды в заданной коллекции можно указать свойства [**Caption**](caption-property.md) и [**Visible**](visible-property.md) .</span><span class="sxs-lookup"><span data-stu-id="6dd77-108">For each command in the collection that you define, you can specify [**Caption**](caption-property.md) and [**Visible**](visible-property.md) properties.</span></span> <span data-ttu-id="6dd77-109">**Заголовок** — это текст, отображаемый в меню, если свойство **Visible** имеет значение **true**.</span><span class="sxs-lookup"><span data-stu-id="6dd77-109">The **Caption** is the text that appears in the menu when the **Visible** property is set to **True**.</span></span> <span data-ttu-id="6dd77-110">Можно также использовать свойство [**Enabled**](enabled-property.md) , чтобы отобразить команду в меню как отключенную и [**Хелпконтекстид**](helpcontextid-property.md) для поддержки справки для свойства.</span><span class="sxs-lookup"><span data-stu-id="6dd77-110">You can also use the [**Enabled**](enabled-property.md) property to display the command in the menu as disabled and the [**HelpContextID**](helpcontextid-property.md) to support Help support for the property.</span></span> <span data-ttu-id="6dd77-111">Определите ключ доступа для текста меню, добавив амперсанд (&) перед текстовым символом параметра **заголовка** текста.</span><span class="sxs-lookup"><span data-stu-id="6dd77-111">Define the access key for the menu text by including an ampersand (&) before the text character of the **Caption** text setting.</span></span>

<span data-ttu-id="6dd77-112">Сервер автоматически добавляет в меню команды для открытия окна «Voice Commands» и скрывает этот символ, а также заголовки [**команд**](/windows/desktop/lwef/the-commands-collection-object) других клиентов символа, позволяющие пользователям переключаться между клиентами.</span><span class="sxs-lookup"><span data-stu-id="6dd77-112">The server automatically adds to the menu commands for opening the Voice Commands Window and hiding the character as well as the [**Commands**](/windows/desktop/lwef/the-commands-collection-object) captions of other clients of the character to enable users to switch between clients.</span></span> <span data-ttu-id="6dd77-113">Сервер автоматически добавляет в меню разделитель между записями меню и элементами, определенными клиентом.</span><span class="sxs-lookup"><span data-stu-id="6dd77-113">The server automatically adds a separator to the menu between its menu entries and those defined by the client.</span></span> <span data-ttu-id="6dd77-114">Разделители отображаются, только если в меню есть элементы для разделения.</span><span class="sxs-lookup"><span data-stu-id="6dd77-114">Separators appear only when there are items in the menu to separate.</span></span>

<span data-ttu-id="6dd77-115">Чтобы удалить команды из меню, используйте метод [**Remove**](remove-method.md) .</span><span class="sxs-lookup"><span data-stu-id="6dd77-115">To remove commands from a menu, use the [**Remove**](remove-method.md) method.</span></span> <span data-ttu-id="6dd77-116">Обратите внимание, что при отображении меню записи меню не меняются.</span><span class="sxs-lookup"><span data-stu-id="6dd77-116">Note that menu entries do not change while the menu displays.</span></span> <span data-ttu-id="6dd77-117">При добавлении или удалении команд или изменении их свойств меню отображает изменения, когда пользователь повторно отображает меню.</span><span class="sxs-lookup"><span data-stu-id="6dd77-117">If you add or remove commands or change their properties, the menu displays the changes when the user redisplays the menu.</span></span>

<span data-ttu-id="6dd77-118">Если вы предпочитаете использовать для символа собственные всплывающие службы меню, можно воспользоваться свойством [**аутопопупмену**](autopopupmenu-property.md) , чтобы отключить обработку сервером действия, выполняемого щелчком правой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="6dd77-118">If you prefer to provide your own pop-up menu services for a character, you can use the [**AutoPopupMenu**](autopopupmenu-property.md) property to turn off server handling of the right-click action.</span></span> <span data-ttu-id="6dd77-119">Затем можно использовать уведомление о событии [**щелчка**](click-event.md) , чтобы создать собственное поведение при обработке меню.</span><span class="sxs-lookup"><span data-stu-id="6dd77-119">You can then use the [**Click**](click-event.md) event notification to create your own menu handling behavior.</span></span>

<span data-ttu-id="6dd77-120">Когда пользователь выбирает команду во всплывающем меню символа или в окне "Voice Commands", сервер запускает [**командное**](command-event.md) событие связанного клиента и передает обратно параметры входных данных с помощью объекта [**UserInput**](/windows/desktop/lwef/iagentuserinput) .</span><span class="sxs-lookup"><span data-stu-id="6dd77-120">When the user selects a command from a character's pop-up menu or the Voice Commands Window, the server triggers the [**Command**](command-event.md) event of the associated client and passes back the parameters of the input using the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object.</span></span>

<span data-ttu-id="6dd77-121">Сервер также предоставляет всплывающее меню для значка панели задач "символ".</span><span class="sxs-lookup"><span data-stu-id="6dd77-121">The server also provides a pop-up menu for the character's taskbar icon.</span></span> <span data-ttu-id="6dd77-122">Когда символ отображается, его щелчок правой кнопкой мыши выводит те же команды, которые отображаются щелчком правой кнопкой мыши по символу.</span><span class="sxs-lookup"><span data-stu-id="6dd77-122">When the character is visible, right-clicking this menu displays the same commands as those displayed by right-clicking the character.</span></span> <span data-ttu-id="6dd77-123">Однако если символ скрыт, в него включаются только команды, предоставляемые сервером.</span><span class="sxs-lookup"><span data-stu-id="6dd77-123">However, when the character is hidden, only the server-supplied commands are included.</span></span>

 

 