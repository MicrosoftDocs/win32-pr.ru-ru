---
title: Создание обработчиков столбцов
description: В представлении сведений в проводнике Windows обычно отображается несколько стандартных столбцов.
ms.assetid: 805e0e13-d09e-40f8-955b-c585f388e07e
keywords:
- обработчики столбцов
- регистрация, обработчики столбцов
- GetColumnInfo
- жетитемдата
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940796e75f29ba0fcfa025d9a56267e14bdff38f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104569150"
---
# <a name="creating-column-handlers"></a><span data-ttu-id="9538f-107">Создание обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-107">Creating Column Handlers</span></span>

<span data-ttu-id="9538f-108">\[Эта функция поддерживается только в Windows XP и более ранних версиях.</span><span class="sxs-lookup"><span data-stu-id="9538f-108">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="9538f-109">\]</span><span class="sxs-lookup"><span data-stu-id="9538f-109">\]</span></span>

<span data-ttu-id="9538f-110">В представлении сведений в проводнике Windows обычно отображается несколько стандартных столбцов.</span><span class="sxs-lookup"><span data-stu-id="9538f-110">The Details view in the Windows Windows Explorer normally displays several standard columns.</span></span> <span data-ttu-id="9538f-111">В каждом столбце содержится информация, например размер файла или тип, для каждого файла в текущей папке.</span><span class="sxs-lookup"><span data-stu-id="9538f-111">Each column lists information, such as the file size or type, for each file in the current folder.</span></span> <span data-ttu-id="9538f-112">Путем реализации и регистрации обработчика столбца можно сделать пользовательские столбцы доступными для вывода.</span><span class="sxs-lookup"><span data-stu-id="9538f-112">By implementing and registering a column handler, you can make custom columns available for display.</span></span>

<span data-ttu-id="9538f-113">Общие процедуры для реализации и регистрации обработчика расширений оболочки обсуждаются в разделе [Создание обработчиков расширений оболочки](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="9538f-113">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="9538f-114">В этом документе рассматриваются аспекты реализации, характерные для обработчиков столбцов.</span><span class="sxs-lookup"><span data-stu-id="9538f-114">This document focuses on those aspects of implementation that are specific to column handlers.</span></span>

<span data-ttu-id="9538f-115">Обсуждаются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="9538f-115">The following topics are discussed.</span></span>

-   [<span data-ttu-id="9538f-116">Принципы работы обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-116">How Column Handlers Work</span></span>](#how-column-handlers-work)
-   [<span data-ttu-id="9538f-117">Регистрация обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-117">Registering Column Handlers</span></span>](#registering-column-handlers)
-   [<span data-ttu-id="9538f-118">Реализация обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-118">Implementing Column Handlers</span></span>](#implementing-column-handlers)
    -   [<span data-ttu-id="9538f-119">Метод Initialize</span><span class="sxs-lookup"><span data-stu-id="9538f-119">The Initialize Method</span></span>](#the-initialize-method)
    -   [<span data-ttu-id="9538f-120">Метод GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="9538f-120">The GetColumnInfo Method</span></span>](#the-getcolumninfo-method)
    -   [<span data-ttu-id="9538f-121">Метод Жетитемдата</span><span class="sxs-lookup"><span data-stu-id="9538f-121">The GetItemData Method</span></span>](#the-getitemdata-method)

## <a name="how-column-handlers-work"></a><span data-ttu-id="9538f-122">Принципы работы обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-122">How Column Handlers Work</span></span>

<span data-ttu-id="9538f-123">На следующем рисунке показан проводник Windows в представлении Details.</span><span class="sxs-lookup"><span data-stu-id="9538f-123">The following illustration shows Windows Explorer in Details view.</span></span>

![снимок экрана проводника Windows в представлении сведений](images/columnproviderhandler1.jpg)

<span data-ttu-id="9538f-125">В Windows 2000 эта папка также может поддерживать ряд столбцов, которые по умолчанию не отображаются.</span><span class="sxs-lookup"><span data-stu-id="9538f-125">With Windows 2000, the folder can also support a number of columns that, by default, are not displayed.</span></span> <span data-ttu-id="9538f-126">Пользователь может отобразить дополнительные столбцы, щелкнув один из заголовков столбцов правой кнопкой мыши и выбрав команду **More...** в меню.</span><span class="sxs-lookup"><span data-stu-id="9538f-126">The user can display additional columns by right-clicking one of the column headers and selecting the **More...** command from the menu.</span></span> <span data-ttu-id="9538f-127">Откроется диалоговое окно со списком доступных столбцов для папки и позволяет пользователю выбрать отображаемые столбцы.</span><span class="sxs-lookup"><span data-stu-id="9538f-127">A dialog box then appears that lists the available columns for the folder and allows the user to select which columns to display.</span></span> <span data-ttu-id="9538f-128">На следующем рисунке показано это диалоговое окно для предыдущего примера.</span><span class="sxs-lookup"><span data-stu-id="9538f-128">The following illustration shows this dialog box for the preceding example.</span></span>

![снимок экрана окна проводника Windows с отображаемым диалоговым окном "Выбор сведений"](images/columnproviderhandler2.jpg)

<span data-ttu-id="9538f-130">Создавая обработчик столбца, можно создавать пользовательские столбцы и добавлять их в этот список.</span><span class="sxs-lookup"><span data-stu-id="9538f-130">By creating a column handler, you can create custom columns and add them to that list.</span></span> <span data-ttu-id="9538f-131">Например, коллекция файлов, содержащих музыку, может использовать обработчик столбца для отображения столбцов, содержащих сведения об исполнителе и элементе, содержащемся в каждом файле.</span><span class="sxs-lookup"><span data-stu-id="9538f-131">For example, a collection of files that contain music could use a column handler to display columns listing the artist and piece contained by each file.</span></span>

<span data-ttu-id="9538f-132">Обработчик столбца — это глобальный объект, который вызывается каждый раз, когда Проводник Windows отображает подробное представление.</span><span class="sxs-lookup"><span data-stu-id="9538f-132">A column handler is a global object that is called every time Windows Explorer displays the Details view.</span></span> <span data-ttu-id="9538f-133">Однако обработчики столбцов обычно используются для вывода пользовательских столбцов только для членов определенного [типа файлов](/windows/desktop/shell/fa-file-types).</span><span class="sxs-lookup"><span data-stu-id="9538f-133">However, column handlers are typically used to display custom columns only for members of a particular [file type](/windows/desktop/shell/fa-file-types).</span></span> <span data-ttu-id="9538f-134">Перед отображением подробного представления Проводник Windows запрашивает все зарегистрированные обработчики столбцов для их характеристик столбцов.</span><span class="sxs-lookup"><span data-stu-id="9538f-134">Before it displays the Details view, Windows Explorer queries all registered column handlers for their column characteristics.</span></span> <span data-ttu-id="9538f-135">Если пользователь выбрал один из столбцов обработчика, проводник Windows запрашивает обработчик для связанных данных.</span><span class="sxs-lookup"><span data-stu-id="9538f-135">If the user has selected one of the handler's columns, Windows Explorer queries the handler for the associated data.</span></span> <span data-ttu-id="9538f-136">Когда обработчик столбца получает запрос на данные, он предоставляет его, если файл является членом поддерживаемого типа.</span><span class="sxs-lookup"><span data-stu-id="9538f-136">When a column handler receives a request for data, it provides it if the file is a member of its supported type.</span></span> <span data-ttu-id="9538f-137">В противном случае запрос игнорируется путем возвращения значения \_ false.</span><span class="sxs-lookup"><span data-stu-id="9538f-137">Otherwise, it ignores the request by returning S\_FALSE.</span></span>

## <a name="registering-column-handlers"></a><span data-ttu-id="9538f-138">Регистрация обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-138">Registering Column Handlers</span></span>

<span data-ttu-id="9538f-139">Обработчики столбцов регистрируются в следующем подразделе.</span><span class="sxs-lookup"><span data-stu-id="9538f-139">Column handlers are registered under the following subkey.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
```

<span data-ttu-id="9538f-140">Создайте подраздел **колумнхандлерс** с именем в виде строки GUID идентификатора класса обработчика (CLSID).</span><span class="sxs-lookup"><span data-stu-id="9538f-140">Create a subkey of **ColumnHandlers** named with the string form of the handler's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="9538f-141">Общие сведения о регистрации обработчиков расширений оболочки см. в статье [Создание обработчиков расширений](/windows/desktop/shell/handlers)оболочки.</span><span class="sxs-lookup"><span data-stu-id="9538f-141">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="9538f-142">В следующем примере показано, как зарегистрировать обработчик столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-142">The following example illustrates how to register a column handler.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
            {My Column Handler CLSID GUID}
```

## <a name="implementing-column-handlers"></a><span data-ttu-id="9538f-143">Реализация обработчиков столбцов</span><span class="sxs-lookup"><span data-stu-id="9538f-143">Implementing Column Handlers</span></span>

<span data-ttu-id="9538f-144">Как и все обработчики расширений оболочки, обработчики столбцов — это объекты модели COM, реализованные в виде библиотек DLL.</span><span class="sxs-lookup"><span data-stu-id="9538f-144">Like all Shell extension handlers, column handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="9538f-145">В дополнение к [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown), они экспортируют интерфейс [**иколумнпровидер**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) .</span><span class="sxs-lookup"><span data-stu-id="9538f-145">They export the [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) interface in addition to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>

<span data-ttu-id="9538f-146">Проводник Windows вызывает три метода, экспортированные с помощью [**иколумнпровидер**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) , для запроса сведений, необходимых для вывода столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-146">Windows Explorer calls the three methods exported by [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) to request the information it needs to display the column.</span></span> <span data-ttu-id="9538f-147">Ниже приведена процедура, используемая проводником Windows.</span><span class="sxs-lookup"><span data-stu-id="9538f-147">The procedure used by Windows Explorer is:</span></span>

1.  <span data-ttu-id="9538f-148">Вызовите [**иколумнпровидер:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) , чтобы указать папку, которая будет отображаться.</span><span class="sxs-lookup"><span data-stu-id="9538f-148">Call [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to specify the folder that is about to be displayed.</span></span>
2.  <span data-ttu-id="9538f-149">Вызовите метод [**иколумнпровидер:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) , чтобы получить идентификатор и характеристики столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-149">Call [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to retrieve the column's identifier and characteristics.</span></span>
3.  <span data-ttu-id="9538f-150">Если столбец выбран пользователем, вызовите [**иколумнпровидер:: жетитемдата**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) для каждого файла в папке, чтобы получить данные, которые принадлежат записи столбца файла.</span><span class="sxs-lookup"><span data-stu-id="9538f-150">If the column has been selected by the user, call [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder to retrieve the data that belongs in the file's column entry.</span></span>

### <a name="the-initialize-method"></a><span data-ttu-id="9538f-151">Метод Initialize</span><span class="sxs-lookup"><span data-stu-id="9538f-151">The Initialize Method</span></span>

<span data-ttu-id="9538f-152">Проводник Windows вызывает метод [**иколумнпровидер:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) для инициализации обработчика столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-152">Windows Explorer calls [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to initialize the column handler.</span></span> <span data-ttu-id="9538f-153">Метод имеет три параметра, но в настоящее время используется только *всзфолдер* .</span><span class="sxs-lookup"><span data-stu-id="9538f-153">The method has three parameters, but only *wszFolder* is currently used.</span></span> <span data-ttu-id="9538f-154">Задана папка, представление сведений о которой будет отображаться.</span><span class="sxs-lookup"><span data-stu-id="9538f-154">It is set to the folder whose Details view is about to be displayed.</span></span> <span data-ttu-id="9538f-155">Сохраните имя папки для последующего использования и инициализируйте объект обработчика по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="9538f-155">Store the folder name for later use and initialize the handler object as needed.</span></span>

### <a name="the-getcolumninfo-method"></a><span data-ttu-id="9538f-156">Метод GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="9538f-156">The GetColumnInfo Method</span></span>

<span data-ttu-id="9538f-157">Проводник Windows Next вызывает [**иколумнпровидер:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) , чтобы запросить идентификатор и характеристики столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-157">Windows Explorer next calls [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to request the column's identifier and characteristics.</span></span> <span data-ttu-id="9538f-158">Он передает индекс для столбца в параметре *двиндекс* .</span><span class="sxs-lookup"><span data-stu-id="9538f-158">It passes in an index for the column in the *dwIndex* parameter.</span></span> <span data-ttu-id="9538f-159">Этот индекс является произвольным значением, используемым для перечисления столбцов.</span><span class="sxs-lookup"><span data-stu-id="9538f-159">This index is an arbitrary value that is used to enumerate columns.</span></span> <span data-ttu-id="9538f-160">Проводник Windows также передает указатель на структуру [**школумнинфо**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) .</span><span class="sxs-lookup"><span data-stu-id="9538f-160">Windows Explorer also passes in a pointer to an [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure.</span></span> <span data-ttu-id="9538f-161">Эта структура используется для возвращения идентификатора и характеристик столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-161">This structure is used to return the column's identifier and characteristics.</span></span> <span data-ttu-id="9538f-162">**Иколумнпровидер:: GetColumnInfo** должен назначать соответствующие значения членам структуры и возвращать.</span><span class="sxs-lookup"><span data-stu-id="9538f-162">**IColumnProvider::GetColumnInfo** should assign appropriate values to the members of the structure and return.</span></span>

<span data-ttu-id="9538f-163">Столбцы идентифицируются по ИДЕНТИФИКАТОРу набора свойств OLE (FMTID) и связанному ИДЕНТИФИКАТОРу свойства (PID).</span><span class="sxs-lookup"><span data-stu-id="9538f-163">Columns are identified by their OLE property set ID (FMTID) and an associated property ID (PID).</span></span> <span data-ttu-id="9538f-164">Первый элемент структуры [**школумнинфо**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) , **сЦид**, является указателем на структуру [**школумнид**](/windows/desktop/shell/objects) , которая используется для задания столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-164">The first member of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure, **scid**, is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that is used to identify the column.</span></span> <span data-ttu-id="9538f-165">Его член **fmtid** содержит fmtid столбца, а его элемент **PID** содержит идентификатор процесса столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-165">Its **fmtid** member holds the column's FMTID, and its **pid** member holds the column's PID.</span></span> <span data-ttu-id="9538f-166">Например, стандартная пара FMTID/PID, которая обычно используется для задания столбцов, — это идентификатор автора набора свойств сводных данных.</span><span class="sxs-lookup"><span data-stu-id="9538f-166">For example, a standard FMTID/PID pair that is commonly used to identify columns is the Author PID of the Summary Information property set.</span></span>

<span data-ttu-id="9538f-167">Если это возможно, обработчик должен использовать существующие Фмтидс и идентификаторы PID, чтобы указать столбец, который он поддерживает.</span><span class="sxs-lookup"><span data-stu-id="9538f-167">If possible, your handler should use existing FMTIDs and PIDs to identify the column it supports.</span></span> <span data-ttu-id="9538f-168">Если используется пользовательская структура [**школумнид**](/windows/desktop/shell/objects) , в столбце будут отображаться данные только для тех файлов, которые поддерживаются обработчиком.</span><span class="sxs-lookup"><span data-stu-id="9538f-168">If you use a custom [**SHCOLUMNID**](/windows/desktop/shell/objects) structure, the column will display data only for those files that are supported by the handler.</span></span> <span data-ttu-id="9538f-169">Если в папке содержатся другие файлы, их записи будут пустыми.</span><span class="sxs-lookup"><span data-stu-id="9538f-169">If the folder contains other files, their entries will be blank.</span></span> <span data-ttu-id="9538f-170">Если папка содержит файлы более чем из одного типа, использование стандартных значений FMTID/PID может привести к объединению данных из разных типов в один столбец.</span><span class="sxs-lookup"><span data-stu-id="9538f-170">If a folder contains files from more than one file type, using standard FMTID/PID values could make it possible to merge data from different types into the same column.</span></span>

<span data-ttu-id="9538f-171">Присвойте элементу **VT** тип [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant)для   данных, которые должны отображаться в столбце.</span><span class="sxs-lookup"><span data-stu-id="9538f-171">Set the **vt** member to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type of the data you want to display in the column.</span></span> <span data-ttu-id="9538f-172">Чаще всего используется тип VT \_ LPSTR, так как в большинстве столбцов данные отображаются в виде символьных строк.</span><span class="sxs-lookup"><span data-stu-id="9538f-172">The most commonly used type is VT\_LPSTR, as most columns display their data as character strings.</span></span> <span data-ttu-id="9538f-173">Остальные элементы структуры [**школумнинфо**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) используются для определения характеристик столбца.</span><span class="sxs-lookup"><span data-stu-id="9538f-173">The remaining members of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure are used to define the characteristics of the column.</span></span> <span data-ttu-id="9538f-174">Присвойте значения соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="9538f-174">Assign values as appropriate.</span></span>

### <a name="the-getitemdata-method"></a><span data-ttu-id="9538f-175">Метод Жетитемдата</span><span class="sxs-lookup"><span data-stu-id="9538f-175">The GetItemData Method</span></span>

<span data-ttu-id="9538f-176">Если выбран столбец обработчика столбца, проводник Windows вызывает [**иколумнпровидер:: жетитемдата**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) для каждого файла в отображаемой папке.</span><span class="sxs-lookup"><span data-stu-id="9538f-176">If the column handler's column has been selected, Windows Explorer calls [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder that is to be displayed.</span></span> <span data-ttu-id="9538f-177">Параметр *псЦид* является указателем на структуру [**школумнид**](/windows/desktop/shell/objects) , которая идентифицирует столбец.</span><span class="sxs-lookup"><span data-stu-id="9538f-177">The *pscid* parameter is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that identifies the column.</span></span> <span data-ttu-id="9538f-178">Параметр *пскд* указывает на структуру [**школумндата**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) , определяющую конкретный файл.</span><span class="sxs-lookup"><span data-stu-id="9538f-178">The *pscd* parameter points to an [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) structure that identifies the particular file.</span></span>

<span data-ttu-id="9538f-179">Параметр *пвардата* возвращает данные, которые должны отображаться в столбце обработчика для файла, заданного параметром *пскд*.</span><span class="sxs-lookup"><span data-stu-id="9538f-179">The *pvarData* parameter returns the data that should be displayed in the handler's column for the file specified by *pscd*.</span></span> <span data-ttu-id="9538f-180">Если этот файл поддерживается обработчиком столбцов, присвойте ему значение *пвардата* и возвратите S \_ ОК.</span><span class="sxs-lookup"><span data-stu-id="9538f-180">If that file is supported by your column handler, assign its data value to *pvarData* and return S\_OK.</span></span> <span data-ttu-id="9538f-181">Если этот файл не поддерживается обработчиком столбцов, возвратите \_ значение false, не присваивая значения *пвардата*.</span><span class="sxs-lookup"><span data-stu-id="9538f-181">If the file is not supported by your column handler, return S\_FALSE without assigning a value to *pvarData*.</span></span>

<span data-ttu-id="9538f-182">Во многих папках будет содержаться несколько файлов, которые не поддерживаются каким-либо конкретным обработчиком столбцов.</span><span class="sxs-lookup"><span data-stu-id="9538f-182">Many folders will contain a number of files that are not supported by any particular column handler.</span></span> <span data-ttu-id="9538f-183">Чтобы повысить эффективность, [**иколумнпровидер:: жетитемдата**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) должен сначала проверить элемент **пвсзекст** структуры, на который указывает *пскд*.</span><span class="sxs-lookup"><span data-stu-id="9538f-183">To improve efficiency, [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) should first check the **pwszExt** member of the structure pointed to by *pscd*.</span></span> <span data-ttu-id="9538f-184">Этот член содержит расширение имени файла.</span><span class="sxs-lookup"><span data-stu-id="9538f-184">This member holds the file name extension.</span></span> <span data-ttu-id="9538f-185">Если расширение указывает, что файл не является членом типа файла, поддерживаемого обработчиком, следует избегать ненужной обработки, немедленно возвращая \_ false.</span><span class="sxs-lookup"><span data-stu-id="9538f-185">If the extension indicates that the file is not a member of a file type supported by your handler, avoid unnecessary processing by immediately returning S\_FALSE.</span></span>

 

 