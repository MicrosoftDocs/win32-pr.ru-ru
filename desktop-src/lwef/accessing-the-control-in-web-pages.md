---
title: Доступ к элементу управления в веб-страницах
description: Доступ к элементу управления в веб-страницах
ms.assetid: 0c799c60-c81a-44ea-a9e0-1a385208528f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a965d73f7277b2b4a62c08a949782488f1e4dba4
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103790044"
---
# <a name="accessing-the-control-in-web-pages"></a><span data-ttu-id="9bb96-103">Доступ к элементу управления в веб-страницах</span><span class="sxs-lookup"><span data-stu-id="9bb96-103">Accessing the Control in Web Pages</span></span>

<span data-ttu-id="9bb96-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="9bb96-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="9bb96-105">Чтобы получить доступ к службам агента Майкрософт с веб-страницы, используйте <OBJECT> тег HTML в элементе</span><span class="sxs-lookup"><span data-stu-id="9bb96-105">To access the Microsoft Agent services from a webpage, use the HTML <OBJECT> tag within the</span></span> <HEAD> <span data-ttu-id="9bb96-106">или</span><span class="sxs-lookup"><span data-stu-id="9bb96-106">or</span></span> <BODY> <span data-ttu-id="9bb96-107">, в котором указывается идентификатор класса (CLSID) для элемента управления (Майкрософт).</span><span class="sxs-lookup"><span data-stu-id="9bb96-107">element of the page, specifying the Microsoft CLSID (class identifier) for the control.</span></span> <span data-ttu-id="9bb96-108">Кроме того, используйте параметр CODEBASE, чтобы указать расположение файла установки Microsoft Agent и его номер версии.</span><span class="sxs-lookup"><span data-stu-id="9bb96-108">In addition, use a CODEBASE parameter to specify the location of the Microsoft Agent installation file and its version number.</span></span>

<span data-ttu-id="9bb96-109">Если в системе установлен Microsoft Internet Explorer (версии 3,02 или более поздней), но Microsoft Agent еще не установлен и пользователь обращается к веб-странице с <OBJECT> ТЕГОМ CLSID агента, браузер автоматически попытается загрузить агент с веб-сайта Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="9bb96-109">If Microsoft Internet Explorer (version 3.02 or later) is installed on the system, but Microsoft Agent is not yet installed and the user accesses a webpage that has the <OBJECT> tag with the Agent CLSID, the browser will automatically attempt to download Agent from the Microsoft website.</span></span> <span data-ttu-id="9bb96-110">Затем пользователь получит запрос на продолжение установки.</span><span class="sxs-lookup"><span data-stu-id="9bb96-110">Then, the user will be asked whether to proceed with installation.</span></span> <span data-ttu-id="9bb96-111">Для других браузеров обратитесь к поставщику за информацией о поддержке или сторонней поддержке элементов управления ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9bb96-111">For other browsers, contact the supplier for information regarding their support or third-party support for ActiveX controls.</span></span>

<span data-ttu-id="9bb96-112">В следующем примере показано, как использовать параметр CODEBASE для автозагрузки английской версии 2,0 Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="9bb96-112">The following example illustrates how to use the CODEBASE parameter to autodownload the English language version 2.0 of Microsoft Agent.</span></span>

``` syntax
<OBJECT
classid="clsid: D45FD31B-5C6E-11D1-9EC1-00C04FD7081F"
CODEBASE = "#VERSION=2,0,0,0"
 id=Agent
>
</OBJECT>
```

<span data-ttu-id="9bb96-113">Кроме того, агент можно установить с помощью собственного HTTP-сервера или в рамках процесса установки приложения.</span><span class="sxs-lookup"><span data-stu-id="9bb96-113">Agent can also be installed from your own HTTP server or as part of an application's installation process.</span></span> <span data-ttu-id="9bb96-114">Для поддержки установки с собственного HTTP-сервера необходимо опубликовать CAB-файл самостоятельной установки Microsoft Agent. EXE-файл и указать его URL в теге CODEBASE.</span><span class="sxs-lookup"><span data-stu-id="9bb96-114">To support installation from your own HTTP server, you need to post the Microsoft Agent self-installing cabinet .Exe file and specify its URL in the CODEBASE tag.</span></span>

``` syntax
<OBJECT
classid="clsid: D45FD31B-5C6E-11D1-9EC1-00C04FD7081F"
CODEBASE = "https://your server/msagent.exe#VERSION=2,0,0,0"
 id=Agent
>
</OBJECT>
```

<span data-ttu-id="9bb96-115">Чтобы обеспечить автоматическую загрузку языкового компонента агента Майкрософт с веб-страницы, включите тег объекта языка на страницу перед тегом объекта управления агента:</span><span class="sxs-lookup"><span data-stu-id="9bb96-115">To support automatic download of a Microsoft Agent language component from a webpage, include the language component's Object tag on the page before the Agent control Object tag:</span></span>

``` syntax
<OBJECT width=0 height=0
CLASSID="CLSID: C348XXXX-A7F8-11D1-AA75-00C04FA34D72"
CODEBASE = "#VERSION=2,0,0,0">
</OBJECT>
```

<span data-ttu-id="9bb96-116">где XXXX заменяется ИДЕНТИФИКАТОРом языка.</span><span class="sxs-lookup"><span data-stu-id="9bb96-116">where XXXX is replaced with a Language ID.</span></span> <span data-ttu-id="9bb96-117">Чтобы узнать, какие языки поддерживаются в настоящее время, посетите веб-сайт Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="9bb96-117">For the languages currently supported, check the Microsoft Agent website.</span></span>

-   <span data-ttu-id="9bb96-118"><OBJECT>Тег для компонента языка должен предшествовать <OBJECT> тегу для компонента ядра агента Microsoft.</span><span class="sxs-lookup"><span data-stu-id="9bb96-118">The <OBJECT> tag for a language component must precede the <OBJECT> tag for the Microsoft Agent core component.</span></span>
-   <span data-ttu-id="9bb96-119">На одном клиенте можно установить несколько языков.</span><span class="sxs-lookup"><span data-stu-id="9bb96-119">Multiple languages can be installed on the same client.</span></span>
-   <span data-ttu-id="9bb96-120">Перед настройкой [**LanguageID**](https://www.bing.com/search?q=**LanguageID**) символа рекомендуется убедиться, что языковой стандарт браузера, доступный в свойстве [**усерлангуаже**](https://www.bing.com/search?q=**userLanguage**) , соответствует заданному языку.</span><span class="sxs-lookup"><span data-stu-id="9bb96-120">Before setting the [**LanguageID**](https://www.bing.com/search?q=**LanguageID**) of a character, we recommend that your script verify that the locale of the browser, available in the [**userLanguage**](https://www.bing.com/search?q=**userLanguage**) property, matches the language being set.</span></span>

<span data-ttu-id="9bb96-121">Для поддержки других языковых версий агента используется другой тег объекта, указывающий языковой компонент.</span><span class="sxs-lookup"><span data-stu-id="9bb96-121">To support other language versions of Agent, you use another Object tag specifying the language component.</span></span> <span data-ttu-id="9bb96-122">Однако имейте в виду, что попытка установить несколько языков может потребовать перезагрузки пользователя.</span><span class="sxs-lookup"><span data-stu-id="9bb96-122">However, be aware that attempting to install multiple languages at the same time may require the user to reboot.</span></span> <span data-ttu-id="9bb96-123">Компоненты языка агента можно получить на веб-сайте агента, используя ту же процедуру, что и для компонента ядра агента.</span><span class="sxs-lookup"><span data-stu-id="9bb96-123">The Agent language components can be obtained from the Agent website using the same procedure as for the Agent core component.</span></span> <span data-ttu-id="9bb96-124">Лицензирование распространения для компонентов языка распространяется на стандартную лицензию на распространение агента. Чтобы начать использовать символ, необходимо загрузить символ с помощью метода [**Load**](/previous-versions/visualstudio/foxpro/h1tx7zt1(v=vs.71)) .</span><span class="sxs-lookup"><span data-stu-id="9bb96-124">Distribution licensing for the language components are covered in the standard Agent distribution license.To begin using a character, you must load the character using the [**Load**](/previous-versions/visualstudio/foxpro/h1tx7zt1(v=vs.71)) method.</span></span> <span data-ttu-id="9bb96-125">Символ может быть загружен из локального хранилища пользователя или HTTP-сервера.</span><span class="sxs-lookup"><span data-stu-id="9bb96-125">A character can be loaded from the user's local storage or an HTTP server.</span></span> <span data-ttu-id="9bb96-126">Дополнительные сведения о синтаксисе загрузки символов см. в описании метода **Load** .</span><span class="sxs-lookup"><span data-stu-id="9bb96-126">For more information about the syntax for loading a character, see the **Load** method.</span></span> <span data-ttu-id="9bb96-127">После успешной загрузки символа можно использовать методы, свойства и события, предоставляемые элементом управления агента для программирования символа.</span><span class="sxs-lookup"><span data-stu-id="9bb96-127">Once the character has been successful loaded you can use the methods, properties, and events exposed by the Agent control to program the character.</span></span> <span data-ttu-id="9bb96-128">Для программирования символа можно также использовать методы, свойства и события, предоставляемые вашим языком программирования и браузером. Например, чтобы запрограммировать реакцию на нажатие кнопки.</span><span class="sxs-lookup"><span data-stu-id="9bb96-128">You can also use the methods, properties, and events exposed by your programming language and the browser to program the character; for example, to program its reaction to a button click.</span></span> <span data-ttu-id="9bb96-129">Обратитесь к документации по вашему браузеру, чтобы определить, какие функции он предоставляет в своей модели сценариев.</span><span class="sxs-lookup"><span data-stu-id="9bb96-129">Consult the documentation for your browser to determine what features it exposes in its scripting model.</span></span> <span data-ttu-id="9bb96-130">Для обозревателя Microsoft Internet Explorer см. раздел Объектная модель скриптов, доступная в пакете SDK для ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9bb96-130">For Microsoft Internet Explorer, see the Scripting Object Model, which is available in the ActiveX SDK.</span></span>

<span data-ttu-id="9bb96-131">Службы агента остаются загруженными только при наличии хотя бы одного клиентского приложения с подключением.</span><span class="sxs-lookup"><span data-stu-id="9bb96-131">Agent's services remain loaded only when there is at least one client application with a connection.</span></span> <span data-ttu-id="9bb96-132">Это означает, что при перемещении пользователя между веб-страницами с поддержкой агентов работа агента будет завершена, а все загруженные символы будут исчезнуть.</span><span class="sxs-lookup"><span data-stu-id="9bb96-132">This means that when a user moves between Agent-enabled webpages, Agent will shut down and any characters you loaded will disappear.</span></span> <span data-ttu-id="9bb96-133">Чтобы агент выполнялся между страницами (и, таким образом, оставался видимым), создайте другой клиент, который остается загруженным между изменениями страницы.</span><span class="sxs-lookup"><span data-stu-id="9bb96-133">To keep Agent running between pages (and thereby keep a character visible), create another client that remains loaded between page changes.</span></span> <span data-ttu-id="9bb96-134">Например, можно создать набор рамок HTML и объявить <OBJECT> тег для агента в родительском фрейме.</span><span class="sxs-lookup"><span data-stu-id="9bb96-134">For example, you can create an HTML frameset and declare an <OBJECT> tag for Agent in the parent frame.</span></span> <span data-ttu-id="9bb96-135">Затем можно создать скрипт для страниц, загружаемых в дочерние фреймы, для вызова скрипта родителя.</span><span class="sxs-lookup"><span data-stu-id="9bb96-135">You can then script the pages you load into the child frame(s), to call into the parent's script.</span></span> <span data-ttu-id="9bb96-136">Кроме того, можно включить <OBJECT> тег на каждой странице, загружаемой в дочерний фрейм.</span><span class="sxs-lookup"><span data-stu-id="9bb96-136">Alternatively, you can also include an <OBJECT> tag on each page you load into the child frame.</span></span> <span data-ttu-id="9bb96-137">В этом случае следует помнить, что каждая страница будет иметь собственный клиент.</span><span class="sxs-lookup"><span data-stu-id="9bb96-137">In this case, remember that each page will be its own client.</span></span> <span data-ttu-id="9bb96-138">Может потребоваться использовать метод [**Activate**](/previous-versions/visualstudio/foxpro/01ayxx68(v=vs.71)) , чтобы задать, какой клиент имеет право управлять тем, когда пользователь взаимодействует с родительской или дочерней страницей.</span><span class="sxs-lookup"><span data-stu-id="9bb96-138">You may need to use the [**Activate**](/previous-versions/visualstudio/foxpro/01ayxx68(v=vs.71)) method to set which client has control when the user interacts with the parent or child page.</span></span>

 

 