---
title: Часто задаваемые вопросы по программированию сценариев
description: Часто задаваемые вопросы по программированию сценариев
ms.assetid: 84078c5b-7b04-48fa-9d0a-d95393c323eb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28dec468eb5147968ca0db774f081212a78cf40d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067230"
---
# <a name="programming-scripting-faq"></a><span data-ttu-id="1d066-103">Часто задаваемые вопросы по программированию сценариев</span><span class="sxs-lookup"><span data-stu-id="1d066-103">Programming Scripting FAQ</span></span>

<span data-ttu-id="1d066-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="1d066-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

### <a name="when-i-use-microsoft-visual-basic-or-other-development-tools-for-scripting-microsoft-agent-i-do-not-see-all-the-properties-and-events-used-in-your-samples-how-do-i-access-them"></a><span data-ttu-id="1d066-105">При использовании Microsoft Visual Basic (или других средств разработки) для создания сценариев Microsoft Agent я не вижу всех свойств и событий, используемых в примерах.</span><span class="sxs-lookup"><span data-stu-id="1d066-105">When I use Microsoft Visual Basic (or other development tools) for scripting Microsoft Agent, I do not see all the properties and events used in your samples.</span></span> <span data-ttu-id="1d066-106">Разделы справки получить к ним доступ?</span><span class="sxs-lookup"><span data-stu-id="1d066-106">How do I access them?</span></span>

<span data-ttu-id="1d066-107">Большинство событий, методов и свойств, поддерживаемых элементом управления Microsoft Agent, доступны только во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="1d066-107">Most of the events, methods, and properties supported by the Microsoft Agent control are exposed only at run time.</span></span> <span data-ttu-id="1d066-108">Дополнительные сведения см. [в справке по программированию элемента управления Microsoft Agent](programming-the-microsoft-agent-control.md) .</span><span class="sxs-lookup"><span data-stu-id="1d066-108">Consult [Programming the Microsoft Agent Control](programming-the-microsoft-agent-control.md) for further information.</span></span>

### <a name="the-map-tag-or-some-other-tag-doesnt-seem-to-work"></a><span data-ttu-id="1d066-109">Тег Map (или другой тег) не работает.</span><span class="sxs-lookup"><span data-stu-id="1d066-109">The Map tag (or some other tag) doesn't seem to work.</span></span>

<span data-ttu-id="1d066-110">Некоторые теги содержат строки в кавычках.</span><span class="sxs-lookup"><span data-stu-id="1d066-110">Some tags include quoted strings.</span></span> <span data-ttu-id="1d066-111">Для некоторых языков программирования, таких как Microsoft Visual Basic и Visual Basic Scripting Edition, может потребоваться использовать две кавычки для обозначения параметра тега или сцепление символа двойной кавычки в составе строки.</span><span class="sxs-lookup"><span data-stu-id="1d066-111">For some programming languages, such as Microsoft Visual Basic and Visual Basic Scripting Edition, you may have to use two quote marks to designate the tag's parameter or concatenate a double-quote character as part of the string.</span></span> <span data-ttu-id="1d066-112">Последнее показано в этом Visual Basic примере:</span><span class="sxs-lookup"><span data-stu-id="1d066-112">The latter is shown in this Visual Basic example:</span></span>

<span data-ttu-id="1d066-113">Agent1. characters ("Genie"). Говорите: "это \\ Map =" + Chr (34) + "произнесенный текст" \_ + Chr (34) + "=" + Chr (34) + "текст всплывающего окна" + Chr (34) + " \\ ."</span><span class="sxs-lookup"><span data-stu-id="1d066-113">Agent1.Characters("Genie").Speak "This is \\map=" + chr(34) + "Spoken text" \_ + chr(34) + "=" + chr(34) + "Balloon text" + chr(34) + "\\."</span></span>

<span data-ttu-id="1d066-114">Для программирования C, C++ и Java перед символами обратной косой черты и двойными кавычками следует указать обратную косую черту.</span><span class="sxs-lookup"><span data-stu-id="1d066-114">For C, C++, and Java programming, precede backslashes and double quotes with a backslash.</span></span> <span data-ttu-id="1d066-115">Пример:</span><span class="sxs-lookup"><span data-stu-id="1d066-115">For example:</span></span>

<span data-ttu-id="1d066-116">BSTR Бсзспеак = Сисаллокстринг (L "это \\ \\ Map = \\ " произнесенный текст \\ "= \\ " текст выноски \\ " \\ \\ ");</span><span class="sxs-lookup"><span data-stu-id="1d066-116">BSTR bszSpeak = SysAllocString(L"This is \\\\map=\\"Spoken text\\"=\\"Balloon text\\"\\\\");</span></span>

<span data-ttu-id="1d066-117">Пчарактер — >говорите (Бсзспеак,......);</span><span class="sxs-lookup"><span data-stu-id="1d066-117">pCharacter->Speak(bszSpeak, ......);</span></span>

> [!Note]  
> <span data-ttu-id="1d066-118">Microsoft Agent не поддерживает все теги, указанные в Microsoft Speech API.</span><span class="sxs-lookup"><span data-stu-id="1d066-118">Microsoft Agent does not support all the tags specified in the Microsoft Speech API.</span></span> <span data-ttu-id="1d066-119">Кроме того, поддержка некоторых параметров может зависеть от установленного модуля преобразования текста в речь.</span><span class="sxs-lookup"><span data-stu-id="1d066-119">In addition, support for some parameters may depend on the text-to-speech engine installed.</span></span> <span data-ttu-id="1d066-120">Дополнительные сведения см. в [статье Теги речевого вывода Microsoft Agent](microsoft-agent-speech-output-tags.md).</span><span class="sxs-lookup"><span data-stu-id="1d066-120">For further information, see [Microsoft Agent Speech Output Tags](microsoft-agent-speech-output-tags.md).</span></span>

 

### <a name="i-dont-seem-to-get-requeststart-and-requestcomplete-events-in-my-script-or-program"></a><span data-ttu-id="1d066-121">Я не буду получать события Рекуестстарт и Рекуесткомплете в моем сценарии (или программе).</span><span class="sxs-lookup"><span data-stu-id="1d066-121">I don't seem to get RequestStart and RequestComplete events in my script (or program).</span></span>

<span data-ttu-id="1d066-122">Это может быть вызвано одной из следующих причин.</span><span class="sxs-lookup"><span data-stu-id="1d066-122">This could be caused by one of the following problems:</span></span>

-   <span data-ttu-id="1d066-123">Ваш язык программирования не полностью поддерживает элементы управления ActiveX.</span><span class="sxs-lookup"><span data-stu-id="1d066-123">Your programming language doesn't fully support ActiveX controls.</span></span> <span data-ttu-id="1d066-124">Проверьте документацию, чтобы убедиться, что она поддерживает интерфейс ActiveX и события для объектов ActiveX.</span><span class="sxs-lookup"><span data-stu-id="1d066-124">Check your documentation to ensure that it supports the ActiveX interface and events for ActiveX objects.</span></span>
-   <span data-ttu-id="1d066-125">На веб-странице со скриптами не удалось установить или загрузить другой элемент управления.</span><span class="sxs-lookup"><span data-stu-id="1d066-125">On a scripted webpage, another control has failed to install or load.</span></span> <span data-ttu-id="1d066-126">Убедитесь, что все остальные элементы управления установлены и правильно загружаются без агента Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="1d066-126">Check to ensure that all other controls are installed and loading properly without Microsoft Agent.</span></span>
-   <span data-ttu-id="1d066-127">На веб-странице скрипта с кадрами у вас есть `<OBJECT>` тег для элемента управления Microsoft Agent на одной странице и события, внесенные на другой странице.</span><span class="sxs-lookup"><span data-stu-id="1d066-127">On a scripted webpage with frames, you have the `<OBJECT>` tag for the Microsoft Agent control on one page, and the events scripted on another page.</span></span> <span data-ttu-id="1d066-128">События отправляются только на страницу, на которой размещен элемент управления.</span><span class="sxs-lookup"><span data-stu-id="1d066-128">Events are sent only to the page that hosts the control.</span></span>

### <a name="i-am-using-the-microsoft-agent-control-with-other-activex-controls-on-my-webpage-and-i-dont-seem-to-get-any-events"></a><span data-ttu-id="1d066-129">Я использую элемент управления Microsoft Agent с другими элементами управления ActiveX на моей веб-странице, и мне кажется, что я не получаю никаких событий.</span><span class="sxs-lookup"><span data-stu-id="1d066-129">I am using the Microsoft Agent control with other ActiveX controls on my webpage, and I don't seem to get any events.</span></span>

<span data-ttu-id="1d066-130">Проверьте, правильно ли установлены другие элементы управления.</span><span class="sxs-lookup"><span data-stu-id="1d066-130">Check to see if the other controls are correctly installed.</span></span> <span data-ttu-id="1d066-131">Если другой элемент управления ActiveX не может правильно зарегистрироваться, элемент управления агента Microsoft Agent может получить свои события.</span><span class="sxs-lookup"><span data-stu-id="1d066-131">If another ActiveX control fails to correctly register itself, the Microsoft Agent control may receive its events.</span></span>

### <a name="what-programming-languages-can-i-use-to-program-the-microsoft-agent-control"></a><span data-ttu-id="1d066-132">Какие языки программирования можно использовать для программного управления Microsoft Agent?</span><span class="sxs-lookup"><span data-stu-id="1d066-132">What programming languages can I use to program the Microsoft Agent control?</span></span>

<span data-ttu-id="1d066-133">Microsoft Agent должен поддерживаться на любом языке, поддерживающем интерфейс ActiveX.</span><span class="sxs-lookup"><span data-stu-id="1d066-133">Microsoft Agent should be supportable from any language that supports the ActiveX interface.</span></span> <span data-ttu-id="1d066-134">Он включает примеры кода для Visual Basic, VBScript, JScript, C/C++ и Java.</span><span class="sxs-lookup"><span data-stu-id="1d066-134">It includes code samples for Visual Basic, VBScript, JScript, C/C++, and Java.</span></span>

### <a name="can-i-access-the-parameters-returned-from-microsoft-agent-using-jscript"></a><span data-ttu-id="1d066-135">Можно ли получить доступ к параметрам, возвращенным Microsoft Agent с помощью JScript?</span><span class="sxs-lookup"><span data-stu-id="1d066-135">Can I access the parameters returned from Microsoft Agent using JScript?</span></span>

<span data-ttu-id="1d066-136">Да, но в настоящее время единственным способом сделать это является использование `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="1d066-136">Yes, but currently the only way to do this is using the `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` syntax.</span></span> <span data-ttu-id="1d066-137">Хотя этот синтаксис поддерживается для Microsoft Internet Explorer, другие браузеры не поддерживают его, поэтому может потребоваться избегать использования JScript для этой части скрипта страницы.</span><span class="sxs-lookup"><span data-stu-id="1d066-137">Although this syntax is supported for Microsoft Internet Explorer, other browsers do not support it, so you may want to avoid using JScript for this part of your page's script.</span></span>

### <a name="can-microsoft-agent-be-used-with-speech-recognition-or-speech-synthesis-text-to-speech-or-tts-engines-other-than-those-supplied-by-microsoft"></a><span data-ttu-id="1d066-138">Можно ли использовать Microsoft Agent с механизмом распознавания речи или синтезом речи (преобразования текста в речь или TTS), кроме тех, которые предоставлены корпорацией Майкрософт?</span><span class="sxs-lookup"><span data-stu-id="1d066-138">Can Microsoft Agent be used with speech recognition or speech synthesis (text-to-speech, or TTS) engines other than those supplied by Microsoft?</span></span>

<span data-ttu-id="1d066-139">Да, при условии, что подсистема поддерживает интерфейсы Microsoft Speech API (SAPI) 4,0, необходимые для Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="1d066-139">Yes, provided that the engine supports the Microsoft Speech API (SAPI) 4.0 interfaces required by Microsoft Agent.</span></span> <span data-ttu-id="1d066-140">Обратитесь к поставщику подсистемы.</span><span class="sxs-lookup"><span data-stu-id="1d066-140">Check with the engine supplier.</span></span> <span data-ttu-id="1d066-141">Полные сведения о интерфейсах SAPI, необходимых для Microsoft Agent, см. в разделе [требования поддержки обработчика речи](speech-engine-support-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="1d066-141">For complete details on the SAPI interfaces required by Microsoft Agent, see [Speech Engine Support Requirements](speech-engine-support-requirements.md).</span></span>

### <a name="my-page-includes-html-object-tags-for-microsoft-agent-the-lernout--hauspie-truvoice-tts-engine-and-the-microsoft-command-and-control-speech-recognition-engine-but-not-all-the-components-install"></a><span data-ttu-id="1d066-142">Страница содержит теги HTML-объектов для Microsoft Agent, модуль Lernout & Hauspie Трувоице TTS, а также команды Майкрософт и средство распознавания речи, но не все компоненты.</span><span class="sxs-lookup"><span data-stu-id="1d066-142">My page includes HTML Object tags for Microsoft Agent, the Lernout & Hauspie TruVoice TTS engine, and the Microsoft Command and Control speech recognition engine, but not all the components install.</span></span>

<span data-ttu-id="1d066-143">Как правило, проблему можно исправить, обновив страницу.</span><span class="sxs-lookup"><span data-stu-id="1d066-143">Typically, the problem can be corrected by refreshing the page.</span></span> <span data-ttu-id="1d066-144">Как правило, рекомендуется сначала указать тег управления Microsoft Agent `<OBJECT>` , а затем Lernout & Hauspie трувоице Engine, а затем команду и управлять подсистемой распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="1d066-144">As a general practice, it is best to specify the Microsoft Agent Control `<OBJECT>` tag first, then the Lernout & Hauspie TruVoice engine, then the Command and Control speech recognition engine.</span></span>

### <a name="after-calling-the-moveto-method-my-character-seems-to-freeze-even-though-i-have-return-animations-assigned-to-moving-state-animations"></a><span data-ttu-id="1d066-145">После вызова метода MoveTo мой символ зависает, несмотря на то, что у меня есть анимации, назначенные для перемещения анимации состояния.</span><span class="sxs-lookup"><span data-stu-id="1d066-145">After calling the MoveTo method, my character seems to freeze even though I have Return animations assigned to Moving state animations.</span></span>

<span data-ttu-id="1d066-146">При воспроизведении анимации службы анимации продолжают отображать последний кадр до тех пор, пока не будет вызвана другая анимация.</span><span class="sxs-lookup"><span data-stu-id="1d066-146">When you play an animation, the animation services continue to display its last frame until another animation is called.</span></span> <span data-ttu-id="1d066-147">Поэтому после вызова [**MoveTo**](moveto-method.md)следует воспроизвести другую анимацию.</span><span class="sxs-lookup"><span data-stu-id="1d066-147">Therefore, you should play another animation after calling [**MoveTo**](moveto-method.md).</span></span> <span data-ttu-id="1d066-148">Если вы определили анимацию **возврата** для анимации с **перемещением** состояния, сервер сначала воспроизведет его.</span><span class="sxs-lookup"><span data-stu-id="1d066-148">If you defined a **Return** animation for the **Moving** state animation, the server will play it first.</span></span>

### <a name="when-i-query-the-characters-pitch-property-it-returns-a-value-of--1"></a><span data-ttu-id="1d066-149">При запросе свойства "шаг" для символа возвращается значение-1.</span><span class="sxs-lookup"><span data-stu-id="1d066-149">When I query the character's Pitch property, it returns a value of -1.</span></span>

<span data-ttu-id="1d066-150">Это происходит, если символ был скомпилирован с помощью свойства «тон» обработчика речи по умолчанию; то есть при построении символа шаг не был изменен.</span><span class="sxs-lookup"><span data-stu-id="1d066-150">This occurs if the character has been compiled using a speech engine's default pitch property; that is, the pitch was not changed when the character was built.</span></span>

### <a name="when-my-code-attempts-to-set-the-tts-mode-id-for-a-text-to-speech-engine-i-get-the-following-error-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-input-synchronous-call"></a><span data-ttu-id="1d066-151">Когда мой код пытается установить идентификатор режима TTS для модуля преобразования текста в речь, возникает следующая ошибка: исходящий вызов не может быть выполнен, так как приложение отправляет входящий синхронный вызов.</span><span class="sxs-lookup"><span data-stu-id="1d066-151">When my code attempts to set the TTS mode ID for a text-to-speech engine, I get the following error: An outgoing call cannot be made since the application is dispatching an input-synchronous call.</span></span>

<span data-ttu-id="1d066-152">Чтобы задать свойство Ттсмодеид, необходимо установить Speech.dll.</span><span class="sxs-lookup"><span data-stu-id="1d066-152">To set the TTSModeID property, you must have Speech.dll installed.</span></span> <span data-ttu-id="1d066-153">Обычно это часть кода установки модуля распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="1d066-153">This is typically a part of the speech engine's installation code.</span></span> <span data-ttu-id="1d066-154">Вы также можете установить это, установив панель управления речевыми объектами, доступную на странице загрузки Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="1d066-154">You may also install this by installing the Speech object control panel , available from the Microsoft Agent Downloads page.</span></span>

### <a name="when-i-retry-loading-a-character-that-failed-to-load-the-call-fails-with-a-character-already-loaded-error"></a><span data-ttu-id="1d066-155">При попытке повторной загрузки символа, который не удалось загрузить, вызов завершается с ошибкой "символ уже загружен".</span><span class="sxs-lookup"><span data-stu-id="1d066-155">When I retry loading a character that failed to load, the call fails with a "Character already loaded" error.</span></span>

<span data-ttu-id="1d066-156">Элемент управления Microsoft Agent не выгружает объект символа (освобождает ссылку), если не удается загрузить соответствующий ему символьный файл.</span><span class="sxs-lookup"><span data-stu-id="1d066-156">The Microsoft Agent control does not unload a character object (release the reference) when its associated character file fails to load.</span></span> <span data-ttu-id="1d066-157">Если вы хотите повторить попытку загрузки символа, необходимо явно вызвать метод [**unload**](unload-method.md) перед вызовом [**Load**](load-method.md) во второй раз.</span><span class="sxs-lookup"><span data-stu-id="1d066-157">If you want to retry loading the character, you must explicitly call [**Unload**](unload-method.md) before you call [**Load**](load-method.md) the second time.</span></span> <span data-ttu-id="1d066-158">При попытке выполнить это из скрипта веб-страницы необходимо также выполнить вызов **unload** с оператором On Error Resume Next, иначе вызов **unload** также завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="1d066-158">If you attempt this from a webpage script, you also need to precede the **Unload** call with an On Error Resume Next statement, or the **Unload** call will also fail.</span></span> <span data-ttu-id="1d066-159">(Обратите внимание, что в JScript не указан оператор On Error Resume Next.)</span><span class="sxs-lookup"><span data-stu-id="1d066-159">(Note that JScript has no On Error Resume Next statement.)</span></span>

<span data-ttu-id="1d066-160">Однако может отсутствовать необходимость в включении кода для немедленного повтора загрузки символа, когда не удается загрузить файл.</span><span class="sxs-lookup"><span data-stu-id="1d066-160">However, you may not need to include code to immediately retry loading a character when the file fails to load.</span></span> <span data-ttu-id="1d066-161">Microsoft Internet Explorer и компонент сервера Microsoft Agent автоматически пытаются повторить попытку несколько раз, поэтому вероятность того, что повторная загрузка приведет к успешной нагрузке, будет удалена.</span><span class="sxs-lookup"><span data-stu-id="1d066-161">Microsoft Internet Explorer and the Microsoft Agent server component automatically attempt to retry several times, so the chances that your retry will result in a successful load are remote.</span></span> <span data-ttu-id="1d066-162">Перед повторным выполнением рекомендуется подождать (установить таймер) несколько секунд.</span><span class="sxs-lookup"><span data-stu-id="1d066-162">A better strategy is to wait (set a timer) a few seconds before you retry.</span></span>

### <a name="how-can-i-install-microsoft-agent-as-part-of-my-application-or-from-my-web-server"></a><span data-ttu-id="1d066-163">Как можно установить Microsoft Agent как часть приложения или с моего веб-сервера?</span><span class="sxs-lookup"><span data-stu-id="1d066-163">How can I install Microsoft Agent as part of my application or from my web server?</span></span>

<span data-ttu-id="1d066-164">Агент можно установить с веб-сайта Майкрософт, включив его *идентификатор CLSID в тег объекта HTML*.</span><span class="sxs-lookup"><span data-stu-id="1d066-164">You can install Agent from the Microsoft website by including its *CLSID in an HTML Object tag*.</span></span> <span data-ttu-id="1d066-165">Однако если вы хотите включить и установить агент из собственной программы установки приложения или с собственного сервера, скачайте CAB-файл самоустановки Microsoft Agent, загрузив его со страницы загрузки.</span><span class="sxs-lookup"><span data-stu-id="1d066-165">However, if you want to include and install Agent from your own application installation program or from your own server, you must download the Microsoft Agent self-installing cabinet file, by downloading it from the Downloads page.</span></span> <span data-ttu-id="1d066-166">При скачивании выберите параметр Сохранить в браузере, а не запустить.</span><span class="sxs-lookup"><span data-stu-id="1d066-166">When downloading, choose the browser's Save rather than Run option.</span></span> <span data-ttu-id="1d066-167">При каждом запуске этот файл автоматически установит Microsoft Agent на целевой компьютер.</span><span class="sxs-lookup"><span data-stu-id="1d066-167">Whenever this file is run, it automatically will install Microsoft Agent on the target machine.</span></span> <span data-ttu-id="1d066-168">Поэтому можно указать файл в сценарии установки.</span><span class="sxs-lookup"><span data-stu-id="1d066-168">Therefore you can specify the file in your installation script.</span></span>

<span data-ttu-id="1d066-169">Не пытайтесь установить Microsoft Agent, скопировав его различные. Библиотеки DLL и попытка зарегистрироваться самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="1d066-169">Do not attempt to install Microsoft Agent by copying its various .DLLs and attempting to register it yourself.</span></span> <span data-ttu-id="1d066-170">Попытка установить агент другими способами означает, что запуск автономного CAB-файла не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="1d066-170">Attempting to install Agent by any other means then executing its self-installing cabinet file is not supported.</span></span>

<span data-ttu-id="1d066-171">Целевая система должна также включать последние версии MSVCRT.DLL (среда выполнения VC + +), REGSVR32.EXE (средство регистрации, включенное в Microsoft VC + +) и COM.</span><span class="sxs-lookup"><span data-stu-id="1d066-171">The target system must also include recent versions of MSVCRT.DLL (VC++ runtime), REGSVR32.EXE (registration tool included with Microsoft VC++), and COM.</span></span> <span data-ttu-id="1d066-172">Чтобы обеспечить установку правильных версий, необходимо установить Microsoft Internet Explorer 3,02 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="1d066-172">The best way to ensure that the correct versions are installed is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="1d066-173">Однако можно также лицензировать эти требования среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="1d066-173">However, you can also license these runtime requirements.</span></span> <span data-ttu-id="1d066-174">(Для получения последней версии COM получите доступ к обновлению DCOM с веб-сайта Майкрософт.)</span><span class="sxs-lookup"><span data-stu-id="1d066-174">(For the latest version of COM, access the DCOM update from the Microsoft website.)</span></span>

<span data-ttu-id="1d066-175">Microsoft Agent 2,0 не будет устанавливаться в Microsoft Windows 2000, так как эта версия операционной системы уже содержит агент.</span><span class="sxs-lookup"><span data-stu-id="1d066-175">Microsoft Agent 2.0 will not install on Microsoft Windows 2000 since this version of the operating system already includes Agent.</span></span>

### <a name="can-i-use-the-visual-basic-setup-wizard-to-install-microsoft-agent"></a><span data-ttu-id="1d066-176">Можно ли использовать мастер установки Visual Basic для установки Microsoft Agent?</span><span class="sxs-lookup"><span data-stu-id="1d066-176">Can I use the Visual Basic Setup Wizard to install Microsoft Agent?</span></span>

<span data-ttu-id="1d066-177">Хотя вы можете создать собственную программу установки с помощью кода Visual Basic (VB), для этого нельзя использовать мастер установки Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="1d066-177">While you can create your own installation program using Visual Basic (VB) code you can't use the Visual Basic Setup Wizard to do this.</span></span> <span data-ttu-id="1d066-178">Чтобы установить агент из VB, можно использовать команду оболочки, указав самоустанавливающийся CAB-файл Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="1d066-178">To install Agent from VB, you can use Shell command, specifying the Microsoft Agent self-installing cabinet file.</span></span>

### <a name="how-do-i-install-microsoft-agent-on-windows-2000"></a><span data-ttu-id="1d066-179">Разделы справки установить Microsoft Agent в Windows 2000?</span><span class="sxs-lookup"><span data-stu-id="1d066-179">How do I install Microsoft Agent on Windows 2000?</span></span>

<span data-ttu-id="1d066-180">Microsoft Agent 2,0 не устанавливается в Windows 2000, так как он уже включен в состав операционной системы.</span><span class="sxs-lookup"><span data-stu-id="1d066-180">Microsoft Agent 2.0 does not install on Windows 2000 because it is already included as a part of the operating system.</span></span>

### <a name="agentsvr-crashes-when-speak-is-called-with-a-wav-file"></a><span data-ttu-id="1d066-181">Ажентсвр аварийно завершает работу, когда говорите вызывается с помощью WAV-файла.</span><span class="sxs-lookup"><span data-stu-id="1d066-181">AgentSvr crashes when Speak is called with a WAV file.</span></span>

<span data-ttu-id="1d066-182">Это может произойти, если символ использует TTS для речевого вывода, а затем изменяется на использование WAV-файла.</span><span class="sxs-lookup"><span data-stu-id="1d066-182">This may result when the character has been using TTS for spoken output, then changes to use a WAV file.</span></span> <span data-ttu-id="1d066-183">В первом параметре метода говорите текст не был указан.</span><span class="sxs-lookup"><span data-stu-id="1d066-183">Text was not supplied in the first parameter of the Speak method.</span></span>

<span data-ttu-id="1d066-184">Чтобы избежать сбоя, включите пробел в первый параметр метода говорите, даже если текстовый вывод отсутствует.</span><span class="sxs-lookup"><span data-stu-id="1d066-184">To avoid the crash, include a space character in the first parameter of the Speak method, even if you have no text output.</span></span>

### <a name="even-though-i-have-already-installed-the-agent-language-component-dll-for-a-particular-language-i-still-got-an-error-that-the-component-is-missing-when-i-set-the-characters-language-to-that-language"></a><span data-ttu-id="1d066-185">Несмотря на то, что для определенного языка уже установлен компонент языка агента (DLL), я по-прежнему получаю сообщение об ошибке, отсутствующее в компоненте, когда я устанавливаю язык символа.</span><span class="sxs-lookup"><span data-stu-id="1d066-185">Even though I have already installed the Agent language component (DLL) for a particular language, I still got an error that the component is missing when I set the character's language to that language.</span></span>

<span data-ttu-id="1d066-186">Обычно это происходит при наличии таких приложений агента, как Microsoft Office 2000, открытыми при установке компонента языка агента.</span><span class="sxs-lookup"><span data-stu-id="1d066-186">This usually happens when you have Agent applications such as Microsoft Office 2000 open when you install the Agent language component.</span></span> <span data-ttu-id="1d066-187">Закройте все приложения и повторите попытку.</span><span class="sxs-lookup"><span data-stu-id="1d066-187">Close all applications and try again.</span></span> <span data-ttu-id="1d066-188">Если проблема будет повторяться, перезагрузите компьютер, и вы сможете задать идентификатор языка сейчас.</span><span class="sxs-lookup"><span data-stu-id="1d066-188">If the problem persists, restart your computer and you should be able to set the language ID now.</span></span>

### <a name="when-i-use-the-ampersand--symbol-the-text-around-the-symbol-in-the-characters-word-balloons-is-truncated"></a><span data-ttu-id="1d066-189">При использовании символа амперсанда "&" текст, окружающий символ в выносках со словом символа, усекается.</span><span class="sxs-lookup"><span data-stu-id="1d066-189">When I use the ampersand "&" symbol, the text around the symbol in the character's word balloons is truncated.</span></span>

<span data-ttu-id="1d066-190">Это известная проблема.</span><span class="sxs-lookup"><span data-stu-id="1d066-190">This is a known issue.</span></span> <span data-ttu-id="1d066-191">Это можно обойти с помощью тега map.</span><span class="sxs-lookup"><span data-stu-id="1d066-191">You can work around this by using the map tag.</span></span> <span data-ttu-id="1d066-192">Например, чтобы отобразить "A & B" в тексте всплывающего окна символа, используйте "A \\ Map =" и "=" && " \\ B" в операторе говорите.</span><span class="sxs-lookup"><span data-stu-id="1d066-192">For example to display "A & B" in the character's word balloon, use "A \\map="and"="&&"\\ B" in the Speak statement.</span></span>

### <a name="my-application-allows-users-to-change-the-default-character-and-when-they-do-the-program-crashes"></a><span data-ttu-id="1d066-193">Мое приложение позволяет пользователям изменять символ по умолчанию, а когда это происходит, программа завершается сбоем.</span><span class="sxs-lookup"><span data-stu-id="1d066-193">My application allows users to change the default character and when they do, the program crashes.</span></span>

<span data-ttu-id="1d066-194">Существуют две возможные причины.</span><span class="sxs-lookup"><span data-stu-id="1d066-194">There are two possible causes:</span></span>

<span data-ttu-id="1d066-195">Если изменить идентификатор режима TTS для символа по умолчанию, а затем разрешить пользователю изменять символ по умолчанию через Шовдефаултчарактерпропертиес, Ажентсвр приведет к сбою.</span><span class="sxs-lookup"><span data-stu-id="1d066-195">If you change the TTS Mode ID of the default character and then allow the user to change the default character through ShowDefaultCharacterProperties, AgentSvr will crash.</span></span>

<span data-ttu-id="1d066-196">Эта проблема исправлена в операционных системах Windows 2000 и Windows XP.</span><span class="sxs-lookup"><span data-stu-id="1d066-196">This problem has been fixed in the Windows 2000 and Windows XP operating systems.</span></span> <span data-ttu-id="1d066-197">Чтобы избежать сбоя на других платформах, не следует разрешать пользователю изменять символ по умолчанию после изменения идентификатора режима TTS для символа по умолчанию или не использовать символ по умолчанию в приложении или веб-странице.</span><span class="sxs-lookup"><span data-stu-id="1d066-197">To avoid the crash on other platforms, you should either not allow the user to change the default character after you change the default character's TTS Mode ID, or do not use the default character in your application or webpage.</span></span>

<span data-ttu-id="1d066-198">Если в приложении не используются символы агента, предоставляемые корпорацией Майкрософт, убедитесь, что в настраиваемом символе используется палитра с полной палитрой 256 цветов.</span><span class="sxs-lookup"><span data-stu-id="1d066-198">If your application does not use Microsoft-supplied Agent characters, make sure that your customized character uses a palette with a full palette of 256 colors.</span></span> <span data-ttu-id="1d066-199">Дополнительные сведения см. в документе разработка символов для Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="1d066-199">For more information see the Designing Characters for Microsoft Agent document.</span></span>

### <a name="my-page-loads-the-agent-character-from-multiple-frames-with-ie-5-i-get-the-microsoft-agent-failed-to-load-error"></a><span data-ttu-id="1d066-200">Страница загружает символ агента из нескольких кадров.</span><span class="sxs-lookup"><span data-stu-id="1d066-200">My page loads the Agent character from multiple frames.</span></span> <span data-ttu-id="1d066-201">При использовании обозревателя Internet Explorer 5 я получаю, что агенту Майкрософт не удалось загрузить сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="1d066-201">With IE 5, I get the Microsoft Agent failed to load error.</span></span>

<span data-ttu-id="1d066-202">Это известная проблема с IE 5.</span><span class="sxs-lookup"><span data-stu-id="1d066-202">This is a known issue with IE 5.</span></span> <span data-ttu-id="1d066-203">Было изменено, как браузер обрабатывает определенное событие, что приводит к запуску скрипта HTML до начала Ажентсвр.</span><span class="sxs-lookup"><span data-stu-id="1d066-203">There was a change in how the browser handles a certain event, which causes the HTML script to begin running before AgentSvr is started.</span></span> <span data-ttu-id="1d066-204">Чтобы страница работала во всех версиях браузера, необходимо добавить следующую строку в скрипт:</span><span class="sxs-lookup"><span data-stu-id="1d066-204">In order to make your page work with all versions of the browser, you need to add this line to your script:</span></span>

<span data-ttu-id="1d066-205">Ажентконтрол. Connected = true</span><span class="sxs-lookup"><span data-stu-id="1d066-205">AgentControl.Connected = True</span></span>

<span data-ttu-id="1d066-206">который явно создает подключение к Ажентсвр.</span><span class="sxs-lookup"><span data-stu-id="1d066-206">which explicitly creates a connection to the AgentSvr.</span></span> <span data-ttu-id="1d066-207">Обратите внимание, что это необходимо сделать, только если страница загружает агент из нескольких кадров.</span><span class="sxs-lookup"><span data-stu-id="1d066-207">Note that you only need to do this if your page loads Agent from multiple frames.</span></span>

### <a name="when-my-application-tries-to-install-microsoft-agent-on-windows-2000-or-windows-xp-i-get-the-error-that-agent-is-not-compatible-with-windows-2000-or-windows-xp"></a><span data-ttu-id="1d066-208">Когда приложение пытается установить Microsoft Agent в Windows 2000 (или Windows XP), я получаю сообщение об ошибке: агент несовместим с Windows 2000 (или Windows XP).</span><span class="sxs-lookup"><span data-stu-id="1d066-208">When my application tries to install Microsoft Agent on Windows 2000 (or Windows XP), I get the error that Agent is not compatible with Windows 2000 (or Windows XP).</span></span>

<span data-ttu-id="1d066-209">Предыдущая версия CAB-файла компонента агента MSAGENT.exe, при выполнении в Windows 2000 (и Windows XP), блокирует установку и отображает неверное сообщение об ошибке, которое агент несовместим с версией операционной системы, которую вы используете.</span><span class="sxs-lookup"><span data-stu-id="1d066-209">A previous version of the Agent core component cabinet file MSAGENT.exe, when executed on Windows 2000 (and Windows XP), will block installation and display an inaccurate error message that Agent is not compatible with the version of the operating system you are running.</span></span> <span data-ttu-id="1d066-210">Фактически компоненты ядра Microsoft Agent 2,0 входят в состав Windows 2000 (и Windows XP) и уже устанавливаются по умолчанию с помощью программы установки Windows.</span><span class="sxs-lookup"><span data-stu-id="1d066-210">In fact, Microsoft Agent 2.0 core components are included as part of Windows 2000 (and Windows XP), and are already installed by default through Windows setup.</span></span>

<span data-ttu-id="1d066-211">В этой версии проверка удаляется, и файл установки не отображает вышеупомянутое сообщение об ошибке в Windows 2000 (или Windows XP).</span><span class="sxs-lookup"><span data-stu-id="1d066-211">In this version, the check is removed and the installation file will not display the aforementioned error message under Windows 2000 (or Windows XP).</span></span> <span data-ttu-id="1d066-212">Обратите внимание, что это единственное изменение в файле установки, и в самих основных компонентах агента нет изменений кода.</span><span class="sxs-lookup"><span data-stu-id="1d066-212">Note that this is the only change to the installation file, and there are no code changes to the Agent core components themselves.</span></span> <span data-ttu-id="1d066-213">Поэтому это обновление не затрагивается, если у вас уже установлен агент 2,0 или если ваш веб-сайт использует тег объекта для активации автоматической загрузки компонентов ядра агента из хранилища объектов Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="1d066-213">Therefore, you are not affected by this update if you already have Agent 2.0 installed, or if your website uses an object tag to trigger automatic downloads of the Agent core components from the Microsoft Object Store.</span></span>

<span data-ttu-id="1d066-214">Если вы включили файл установки ядра агента в приложение или при публикации файла установки на сервере, может потребоваться загрузить это обновление.</span><span class="sxs-lookup"><span data-stu-id="1d066-214">If you include the Agent core component installation file with your application, or if you post the installation file on your server, you may want to download this update.</span></span> <span data-ttu-id="1d066-215">Для этого щелкните здесь и выберите параметр "сохранить эту программу на диск".</span><span class="sxs-lookup"><span data-stu-id="1d066-215">To do so, click here and select the "Save this program to disk" option.</span></span> <span data-ttu-id="1d066-216">Для этих случаев необходимо иметь действительную и текущую лицензию на распространение агента.</span><span class="sxs-lookup"><span data-stu-id="1d066-216">You must have a valid and current Agent distribution license for these circumstances.</span></span>

<span data-ttu-id="1d066-217">Кроме того, эту проблему можно обойти, используя параметр Silent при установке предыдущей версии файла установки MSAGENT.exe.</span><span class="sxs-lookup"><span data-stu-id="1d066-217">Alternately, you can also work around this problem by using the silent option when installing the previous version of the MSAGENT.exe installation file.</span></span> <span data-ttu-id="1d066-218">Команда Shell:</span><span class="sxs-lookup"><span data-stu-id="1d066-218">The shell command is:</span></span>

<span data-ttu-id="1d066-219">**MSAGENT.exe/q: a**</span><span class="sxs-lookup"><span data-stu-id="1d066-219">**MSAGENT.exe /q:a**</span></span>

<span data-ttu-id="1d066-220">То же самое относится к компонентам языка агента, первоначально выпущенным в октябре 1998.</span><span class="sxs-lookup"><span data-stu-id="1d066-220">The same applies to the Agent language components that were originally released in October 1998.</span></span> <span data-ttu-id="1d066-221">В Windows 2000 (и Windows XP) была выполнена проверка, которая не позволила бы установить арабский, французский, немецкий, иврит, итальянский, японский, корейский, упрощенный китайский, испанский и традиционный языковые компоненты.</span><span class="sxs-lookup"><span data-stu-id="1d066-221">There was a check that would prevent the Arabic, French, German, Hebrew, Italian, Japanese, Korean, Simplified Chinese, Spanish, and Traditional Chinese language components from installing under Windows 2000 (and Windows XP).</span></span> <span data-ttu-id="1d066-222">Новые версии этих файлов установки, а также дополнительные 19 языков, добавленные в марте 2000, не содержат эту проверку и будут успешно устанавливаться в Windows 2000 (и Windows XP).</span><span class="sxs-lookup"><span data-stu-id="1d066-222">The newer versions of these installation files, along with the additional 19 languages added in March 2000, do not contain this check and will install successfully on Windows 2000 (and Windows XP).</span></span>

### <a name="my-customized-character-exhibits-some-unexpected-behavior-with-its-transparency-color-on-windows-2000-and-windows-xp"></a><span data-ttu-id="1d066-223">Мой настроенный символ ведет к непредвиденному поведению с цветом прозрачности в Windows 2000 (и Windows XP).</span><span class="sxs-lookup"><span data-stu-id="1d066-223">My customized character exhibits some unexpected behavior with its transparency color on Windows 2000 (and Windows XP).</span></span>

<span data-ttu-id="1d066-224">Это известная проблема для символов, созданных с помощью палитры, которая имеет размер менее 256 цветов.</span><span class="sxs-lookup"><span data-stu-id="1d066-224">This is a known issue for characters created with a palette of less than 256 colors.</span></span> <span data-ttu-id="1d066-225">Проблемы с такими символами включают цвет прозрачности, отображаемый в фоновом режиме, прозрачный текст, прозрачная выноска или прозрачный фон.</span><span class="sxs-lookup"><span data-stu-id="1d066-225">Issues with these characters include the transparency color showing in the background, transparent balloon text, transparent balloon border, or transparent balloon background.</span></span> <span data-ttu-id="1d066-226">Обратите внимание, что такие символы могут привести к сбою приложений при загрузке в диалоговом окне средства выбора символов агента или в коллекции помощников Microsoft Office.</span><span class="sxs-lookup"><span data-stu-id="1d066-226">Note that such characters may cause your applications to crash when loaded in the Agent character picker dialog or the Microsoft Office Assistant gallery.</span></span> <span data-ttu-id="1d066-227">Пользовательские символы должны использовать полную палитру с 256 цветами.</span><span class="sxs-lookup"><span data-stu-id="1d066-227">Your customized characters must use a full palette with 256 colors.</span></span> <span data-ttu-id="1d066-228">В качестве отправной точки с полной цветовой палитрой 256 можно использовать образец палитры, предоставленный для символов помощника по Office.</span><span class="sxs-lookup"><span data-stu-id="1d066-228">You can use the sample palette provided for Office Assistant characters as a starting point with a full 256 color palette.</span></span>

### <a name="the-character-does-not-use-the-british-english-tts-engine-even-though-i-have-set-its-language-id-to-british-english-h0809"></a><span data-ttu-id="1d066-229">Этот символ не использует английский модуль TTS для английского языка, несмотря на то, что для его идентификатора языка задано значение Британский английский &h0809.</span><span class="sxs-lookup"><span data-stu-id="1d066-229">The character does not use the British English TTS engine even though I have set its language ID to British English &h0809.</span></span>

<span data-ttu-id="1d066-230">Сначала убедитесь, что установлены все необходимые компоненты — основные компоненты агента, двоичные файлы среды выполнения SAPI и модуль TTS SAPI4, совместимый с английским языком, например TTS3000 English (английский язык), доступный для загрузки на странице загрузки агента.</span><span class="sxs-lookup"><span data-stu-id="1d066-230">First make sure you have all the necessary components installed—Agent core components, the SAPI runtime binaries, and a SAPI4 compliant British English TTS engine like the TTS3000 British English engine, available for download on the Agent Downloads page.</span></span> <span data-ttu-id="1d066-231">Если ваш символ по-прежнему не использует английский модуль TTS для английского языка, то, скорее всего, у вас также установлен модуль TTS для английского языка (США).</span><span class="sxs-lookup"><span data-stu-id="1d066-231">If your character is still not using the British English TTS engine, it's likely you also have an American English TTS engine installed.</span></span> <span data-ttu-id="1d066-232">Так как на английском и американском языках используется один и тот же основной язык (английский) и американский английский по умолчанию, агент выберет первый доступный модуль TTS для английского языка (США), возвращенный SAPI.</span><span class="sxs-lookup"><span data-stu-id="1d066-232">Since both British and American English share the same primary language (English) and American English is the default, Agent will pick the first available American English TTS engine as returned by SAPI.</span></span> <span data-ttu-id="1d066-233">Чтобы использовать модуль TTS для английского языка, используйте вместо него свойство Ттсмодеид символа.</span><span class="sxs-lookup"><span data-stu-id="1d066-233">To use a British English TTS engine, use the character's TTSModeID property instead.</span></span> <span data-ttu-id="1d066-234">Например, Ттсмодеид для английского языка TTS3000 (английский) — {227A0E41-A92A-11d1-B17B-0020AFED142E}.</span><span class="sxs-lookup"><span data-stu-id="1d066-234">For example, the TTSModeID for the TTS3000 British English male voice is {227A0E41-A92A-11d1-B17B-0020AFED142E}.</span></span> <span data-ttu-id="1d066-235">В Microsoft Visual Basic можно использовать этот механизм, установив Ттсмодеид Мерлин следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1d066-235">In Microsoft Visual Basic you can use this engine by setting Merlin's TTSModeID as follows:</span></span>

<span data-ttu-id="1d066-236">Ажентконтрол. characters ("Мерлин"). Ттсмодеид = {227A0E41-A92A-11d1-B17B-0020AFED142E}</span><span class="sxs-lookup"><span data-stu-id="1d066-236">AgentControl.Characters("Merlin").TTSModeID = {227A0E41-A92A-11d1-B17B-0020AFED142E}</span></span>

### <a name="when-the-characters-volume-is-set-to-zero-using-the-speech-tag-vol0-it-either-has-no-effects-or-crashes-the-agentsvr"></a><span data-ttu-id="1d066-237">Если том для этого символа имеет нулевое значение, а тег " \\ VOL" имеет метку "громкость = 0" \\ , он либо не оказывает влияния, либо не завершает работу ажентсвр.</span><span class="sxs-lookup"><span data-stu-id="1d066-237">When the character's volume is set to zero using the speech tag \\Vol=0\\, it either has no effects or crashes the AgentSvr.</span></span>

<span data-ttu-id="1d066-238">Это известная проблема.</span><span class="sxs-lookup"><span data-stu-id="1d066-238">This is a known problem.</span></span> <span data-ttu-id="1d066-239">В операционных системах Windows 95, Windows 98 и Windows Me том с символом не изменяется, но остается на установленном ранее уровне.</span><span class="sxs-lookup"><span data-stu-id="1d066-239">On Windows 95, Windows 98, and Windows Me operating systems, the character's volume does not change but will remain at the previously set level.</span></span> <span data-ttu-id="1d066-240">На платформах Windows NT 4,0, Windows 2000 и Windows XP это приведет к сбою Ажентсвр, даже если не установлен модуль TTS.</span><span class="sxs-lookup"><span data-stu-id="1d066-240">On Windows NT 4.0, Windows 2000 and Windows XP platforms, this will cause AgentSvr to crash, even when a TTS engine is not installed.</span></span> <span data-ttu-id="1d066-241">Так как диапазон томов символов, от 0 (тишины) до 65535 (максимальный том), имеет большой размер, и различие между последовательными уровнями не является более понятным, простое решение заключается в том, чтобы задать для тома значение 1, а не 0, если требуется, чтобы неразборчиво символа был в качестве голоса.</span><span class="sxs-lookup"><span data-stu-id="1d066-241">Since the range of the character's volume, from 0 (silence) to 65535 (maximum volume), is large and the difference between successive levels is hardly discernable, the easy workaround is to set the volume to 1 instead of 0 when you want the character's voice to be inaudible.</span></span>

### <a name="my-customized-characters-return-animation-does-not-play-correctly-after-the-movedown-moveleft-moveright-andor-moveup-animations"></a><span data-ttu-id="1d066-242">Анимация возврата настраиваемого символа не воспроизводится правильно после анимации вниз, Мовелефт, Моверигхт и (или) MoveUp.</span><span class="sxs-lookup"><span data-stu-id="1d066-242">My customized character's Return animation does not play correctly after the MoveDown, MoveLeft, MoveRight and/or MoveUp animations.</span></span>

<span data-ttu-id="1d066-243">Убедитесь, что для состояния диктовки назначена простая анимация речи.</span><span class="sxs-lookup"><span data-stu-id="1d066-243">Make sure a simple speaking animation is assigned to the Speaking State.</span></span> <span data-ttu-id="1d066-244">Например, можно использовать один кадр, состоящий из нейтральной позиции символа с наложением рот.</span><span class="sxs-lookup"><span data-stu-id="1d066-244">For example, you can use a single frame consisting of the character's neutral position with mouth overlays.</span></span>

 

 




