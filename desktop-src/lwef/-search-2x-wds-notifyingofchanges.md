---
title: Уведомление индекса изменений (устаревшие функции среды Windows)
description: С помощью службы Microsoft Windows Desktop Search (WDS) 2,6 обработчики протоколов для заданного хранилища данных могут сообщить индексатору WDS об изменении данных в их хранилище.
ms.assetid: 700b1707-dd11-4a30-8f00-5c4aae1173ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6021cfe5cd7061a3d3255e56d08e665a6caedf03
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104262179"
---
# <a name="notifying-the-index-of-changes-legacy-windows-environment-features"></a><span data-ttu-id="2cbc8-103">Уведомление индекса изменений (устаревшие функции среды Windows)</span><span class="sxs-lookup"><span data-stu-id="2cbc8-103">Notifying the Index of Changes (Legacy Windows Environment Features)</span></span>

> [!NOTE]
> <span data-ttu-id="2cbc8-104">Windows Desktop Search 2. x — это устаревшая технология, которая изначально была доступна в качестве надстройки для Windows XP и Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="2cbc8-105">В более поздних выпусках используйте вместо этого [Поиск Windows](../search/-search-3x-wds-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="2cbc8-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="2cbc8-106">С помощью службы Microsoft Windows Desktop Search (WDS) 2,6 обработчики протоколов для заданного хранилища данных могут сообщить индексатору WDS об изменении данных в их хранилище.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-106">With Microsoft Windows Desktop Search (WDS) 2.6, protocol handlers for a given data store can tell the WDS Indexer when data in their store has changed.</span></span> <span data-ttu-id="2cbc8-107">Это повышает производительность, гарантируя, что индексатор не выполняет сканирование всего хранилища по добавочным индексам.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-107">This improves performance by ensuring the Indexer doesn't crawl the entire store on incremental indexes.</span></span> <span data-ttu-id="2cbc8-108">С помощью API уведомления обработчики протоколов могут уведомлять индексатор о перемещении или удалении элемента, а также добавлять области в очередь сканирования индексатора WDS URL-адресов, для которых требуется индексирование.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-108">Using notification APIs, protocol handlers can notify the Indexer that an item has been moved or deleted, and they can add scopes to the WDS Indexer's crawl queue of URLs requiring indexing.</span></span> <span data-ttu-id="2cbc8-109">Уведомление полезно для таких приложений, как электронная почта, где обработчик протокола отслеживает хранилище и уведомляет индексатор об изменении элементов и требует индексирования.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-109">Notification is helpful for applications such as email, where the protocol handler monitors the store and notifies the Indexer that items have changed and require indexing.</span></span>

## <a name="isearchitemschangedsink"></a><span data-ttu-id="2cbc8-110">исеарчитемсчанжедсинк</span><span class="sxs-lookup"><span data-stu-id="2cbc8-110">ISearchItemsChangedSink</span></span>

<span data-ttu-id="2cbc8-111">Обработчики протоколов уведомляют индексатор об изменениях через интерфейс [**исеарчитемсчанжедсинк**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) .</span><span class="sxs-lookup"><span data-stu-id="2cbc8-111">Protocol handlers notify the Indexer of changes through the [**ISearchItemsChangedSink**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) interface.</span></span> <span data-ttu-id="2cbc8-112">Сведения об изменениях данных должны собираться в \_ \_ структурах изменения элементов поиска, а также в \_ типе поиска \_ \_ типов перечислений изменений, а затем передавать их индексатору через метод **онитемсчанжед** интерфейса **исеарчитемсчанжедсинк** .</span><span class="sxs-lookup"><span data-stu-id="2cbc8-112">Information about data changes should be collected in SEARCH\_ITEM\_CHANGE structs and SEARCH\_KIND\_OF\_CHANGE enumeration types and then communicated to the Indexer through the **OnItemsChanged** method of the **ISearchItemsChangedSink** interface.</span></span>

<span data-ttu-id="2cbc8-113">Для доступа к этому интерфейсу обработчики настраиваемых протоколов должны сначала создать экземпляр объекта [**исеарчманажер**](/windows/desktop/api/searchapi/nn-searchapi-isearchmanager) для получения доступа к объекту [**исеарчкаталогманажер**](/windows/desktop/api/searchapi/nn-searchapi-isearchcatalogmanager) .</span><span class="sxs-lookup"><span data-stu-id="2cbc8-113">To access this interface, a custom protocol handlers must first instantiate an [**ISearchManager**](/windows/desktop/api/searchapi/nn-searchapi-isearchmanager) object to gain access to the [**ISearchCatalogManager**](/windows/desktop/api/searchapi/nn-searchapi-isearchcatalogmanager) object.</span></span> <span data-ttu-id="2cbc8-114">В нем можно создать экземпляр объекта [**исеарчитемсчанжедсинк**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) и уведомить индексатор об изменениях данных.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-114">From there, one can instantiate an [**ISearchItemsChangedSink**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) object and notify the Indexer of the data changes.</span></span>

<span data-ttu-id="2cbc8-115">Метод Онитемсчанжед позволяет получать и передавать изменения данных в хранилище данных клиента для инициирования индексирования.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-115">The OnItemsChanged method lets you collect and communicate data changes to your customer data store to initiate indexing.</span></span>



| <span data-ttu-id="2cbc8-116">Направление</span><span class="sxs-lookup"><span data-stu-id="2cbc8-116">Direction</span></span> | <span data-ttu-id="2cbc8-117">Переменная</span><span class="sxs-lookup"><span data-stu-id="2cbc8-117">Variable</span></span>              | <span data-ttu-id="2cbc8-118">Описание</span><span class="sxs-lookup"><span data-stu-id="2cbc8-118">Description</span></span>                                                              |
|-----------|-----------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="2cbc8-119">В</span><span class="sxs-lookup"><span data-stu-id="2cbc8-119">In</span></span>        | <span data-ttu-id="2cbc8-120">двнумберофчанжес</span><span class="sxs-lookup"><span data-stu-id="2cbc8-120">dwNumberofChanges</span></span>     | <span data-ttu-id="2cbc8-121">Общее число изменений в уведомлении.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-121">Total number of changes in the notification.</span></span>                             |
| <span data-ttu-id="2cbc8-122">В</span><span class="sxs-lookup"><span data-stu-id="2cbc8-122">In</span></span>        | <span data-ttu-id="2cbc8-123">датачанжеентриес\[\]</span><span class="sxs-lookup"><span data-stu-id="2cbc8-123">DataChangeEntries\[\]</span></span> | <span data-ttu-id="2cbc8-124">Все уведомления об изменениях в массиве \_ \_ структур изменения элементов поиска.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-124">All change notifications in an array of SEARCH\_ITEM\_CHANGE structures.</span></span> |
| <span data-ttu-id="2cbc8-125">Исходящий</span><span class="sxs-lookup"><span data-stu-id="2cbc8-125">Out</span></span>       | <span data-ttu-id="2cbc8-126">двбатчид</span><span class="sxs-lookup"><span data-stu-id="2cbc8-126">dwBatchId</span></span>             | <span data-ttu-id="2cbc8-127">Идентификатор пакета, который будет передан с ошибками.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-127">The batch ID that will be passed back with errors.</span></span>                       |
| <span data-ttu-id="2cbc8-128">Исходящий</span><span class="sxs-lookup"><span data-stu-id="2cbc8-128">Out</span></span>       | <span data-ttu-id="2cbc8-129">хркомплетионкодес\[\]</span><span class="sxs-lookup"><span data-stu-id="2cbc8-129">hrCompletionCodes\[\]</span></span> | <span data-ttu-id="2cbc8-130">Указывает, был ли каждый URL-адрес принят для индексирования.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-130">Indicates whether each URL was accepted for indexing.</span></span>                    |



 

<span data-ttu-id="2cbc8-131">\_ \_ Структура изменения элемента поиска определяет тип произошедших изменений, а также текущий URL-адрес и предыдущий URL-адрес элемента, если применимо.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-131">The SEARCH\_ITEM\_CHANGE structure identifies the kind of change that occurred as well as the item's current URL and previous URL, if applicable.</span></span> <span data-ttu-id="2cbc8-132">Структура определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="2cbc8-132">The structure is defined as follows:</span></span>



| <span data-ttu-id="2cbc8-133">Имя свойства</span><span class="sxs-lookup"><span data-stu-id="2cbc8-133">Property Name</span></span> | <span data-ttu-id="2cbc8-134">Тип свойства</span><span class="sxs-lookup"><span data-stu-id="2cbc8-134">Property Type</span></span>                  | <span data-ttu-id="2cbc8-135">Описание</span><span class="sxs-lookup"><span data-stu-id="2cbc8-135">Description</span></span>                                                                |
|---------------|--------------------------------|----------------------------------------------------------------------------|
| <span data-ttu-id="2cbc8-136">Change</span><span class="sxs-lookup"><span data-stu-id="2cbc8-136">Change</span></span>        | <span data-ttu-id="2cbc8-137">\_тип поиска \_ \_ изменений</span><span class="sxs-lookup"><span data-stu-id="2cbc8-137">SEARCH\_KIND\_OF\_CHANGE</span></span>       | <span data-ttu-id="2cbc8-138">Тип изменения, для которого выполняется оповещение.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-138">The type of change that is being notified.</span></span>                                 |
| <span data-ttu-id="2cbc8-139">URL-адрес</span><span class="sxs-lookup"><span data-stu-id="2cbc8-139">URL</span></span>           | <span data-ttu-id="2cbc8-140">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="2cbc8-140">LPWSTR</span></span>                         | <span data-ttu-id="2cbc8-141">URL-адрес объекта, который был изменен.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-141">The URL for the object that has changed.</span></span>                                   |
| <span data-ttu-id="2cbc8-142">олдурл</span><span class="sxs-lookup"><span data-stu-id="2cbc8-142">OldURL</span></span>        | <span data-ttu-id="2cbc8-143">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="2cbc8-143">LPWSTR</span></span>                         | <span data-ttu-id="2cbc8-144">Если уведомление является перемещением, старый URL-адрес предоставляется и должен быть уникальным.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-144">If the notification is a move, the old URL is provided and must be unique.</span></span> |
| <span data-ttu-id="2cbc8-145">Приоритет</span><span class="sxs-lookup"><span data-stu-id="2cbc8-145">Priority</span></span>      | <span data-ttu-id="2cbc8-146">\_приоритет уведомления \_ поиска</span><span class="sxs-lookup"><span data-stu-id="2cbc8-146">SEARCH\_NOTIFICATION\_PRIORITY</span></span> | <span data-ttu-id="2cbc8-147">Приоритет изменения.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-147">The priority of the change.</span></span>                                                |



 

<span data-ttu-id="2cbc8-148">Тип поиска \_ \_ для \_ перечисления изменений определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="2cbc8-148">The SEARCH\_KIND\_OF\_CHANGE enumeration is defined as follows:</span></span>



| <span data-ttu-id="2cbc8-149">Значение перечисления</span><span class="sxs-lookup"><span data-stu-id="2cbc8-149">Enum Value</span></span>                           | <span data-ttu-id="2cbc8-150">Значение</span><span class="sxs-lookup"><span data-stu-id="2cbc8-150">Value</span></span>   | <span data-ttu-id="2cbc8-151">Описание</span><span class="sxs-lookup"><span data-stu-id="2cbc8-151">Description</span></span>                                                                                     |
|--------------------------------------|---------|-------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2cbc8-152">Поиск \_ изменений \_ Добавить</span><span class="sxs-lookup"><span data-stu-id="2cbc8-152">SEARCH\_CHANGE\_ADD</span></span>                  | <span data-ttu-id="2cbc8-153">0</span><span class="sxs-lookup"><span data-stu-id="2cbc8-153">0</span></span>       | <span data-ttu-id="2cbc8-154">Уведомление предназначено для дополнительного URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-154">The notification is for an additional URL.</span></span>                                                      |
| <span data-ttu-id="2cbc8-155">Поиск \_ изменений, \_ Удаление</span><span class="sxs-lookup"><span data-stu-id="2cbc8-155">SEARCH\_CHANGE\_DELETE</span></span>               | <span data-ttu-id="2cbc8-156">1</span><span class="sxs-lookup"><span data-stu-id="2cbc8-156">1</span></span>       | <span data-ttu-id="2cbc8-157">Уведомление предназначено для удаления URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-157">The notification is for the deletion of a URL.</span></span>                                                  |
| <span data-ttu-id="2cbc8-158">Поиск \_ изменений \_ изменить</span><span class="sxs-lookup"><span data-stu-id="2cbc8-158">SEARCH\_CHANGE\_MODIFY</span></span>               | <span data-ttu-id="2cbc8-159">2</span><span class="sxs-lookup"><span data-stu-id="2cbc8-159">2</span></span>       | <span data-ttu-id="2cbc8-160">Уведомление заключается в том, что URL-адрес был изменен.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-160">The notification is that a URL has been modified.</span></span>                                               |
| <span data-ttu-id="2cbc8-161">Поиск \_ изменений \_ Перемещение \_ Переименование</span><span class="sxs-lookup"><span data-stu-id="2cbc8-161">SEARCH\_CHANGE\_MOVE\_RENAME</span></span>         | <span data-ttu-id="2cbc8-162">3</span><span class="sxs-lookup"><span data-stu-id="2cbc8-162">3</span></span>       | <span data-ttu-id="2cbc8-163">Уведомление предназначено для перемещения и переименования объекта на новый URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-163">The notification is for the move and rename of an object to a new URL.</span></span>                          |
| <span data-ttu-id="2cbc8-164">Поиск \_ в \_ каталоге семантики изменения \_</span><span class="sxs-lookup"><span data-stu-id="2cbc8-164">SEARCH\_CHANGE\_SEMANTICS\_DIRECTORY</span></span> | <span data-ttu-id="2cbc8-165">0x10000</span><span class="sxs-lookup"><span data-stu-id="2cbc8-165">0x10000</span></span> | <span data-ttu-id="2cbc8-166">Уведомление предназначено для URL-адреса контейнера.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-166">The notification is for a container URL.</span></span>                                                        |
| <span data-ttu-id="2cbc8-167">\_неполная \_ семантика изменения поиска \_</span><span class="sxs-lookup"><span data-stu-id="2cbc8-167">SEARCH\_CHANGE\_SEMANTICS\_SHALLOW</span></span>   | <span data-ttu-id="2cbc8-168">0x20000</span><span class="sxs-lookup"><span data-stu-id="2cbc8-168">0x20000</span></span> | <span data-ttu-id="2cbc8-169">Уведомление предназначено для URL-адреса контейнера, который должен индексировать только его свойства контейнера.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-169">The notification is for a container URL that should only have its container properties indexed.</span></span> |
| <span data-ttu-id="2cbc8-170">\_ \_ Безопасность семантики изменений \_ поиска</span><span class="sxs-lookup"><span data-stu-id="2cbc8-170">SEARCH\_CHANGE\_SEMANTICS\_SECURITY</span></span>  | <span data-ttu-id="2cbc8-171">0x40000</span><span class="sxs-lookup"><span data-stu-id="2cbc8-171">0x40000</span></span> | <span data-ttu-id="2cbc8-172">Уведомление предназначено для URL-адреса или URL-адреса контейнера, свойства безопасности которого изменились.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-172">The notification is for a URL or container URL that has had its security properties changed.</span></span>    |



 

<span data-ttu-id="2cbc8-173">\_ \_ Перечисление приоритета уведомлений поиска определяется следующим образом.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-173">The SEARCH\_NOTIFICATION\_PRIORITY enumeration is defined as follows:</span></span>



| <span data-ttu-id="2cbc8-174">Значение перечисления</span><span class="sxs-lookup"><span data-stu-id="2cbc8-174">Enum Value</span></span>               | <span data-ttu-id="2cbc8-175">Значение</span><span class="sxs-lookup"><span data-stu-id="2cbc8-175">Value</span></span> | <span data-ttu-id="2cbc8-176">Описание</span><span class="sxs-lookup"><span data-stu-id="2cbc8-176">Description</span></span>                                                                                                                                                                    |
|--------------------------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2cbc8-177">Поиск \_ обычного \_ приоритета</span><span class="sxs-lookup"><span data-stu-id="2cbc8-177">SEARCH\_NORMAL\_PRIORITY</span></span> | <span data-ttu-id="2cbc8-178">0</span><span class="sxs-lookup"><span data-stu-id="2cbc8-178">0</span></span>     | <span data-ttu-id="2cbc8-179">При индексировании URL-адреса следует использовать только обычные приоритеты.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-179">Only a normal priority should be used when indexing the URL.</span></span> <span data-ttu-id="2cbc8-180">Эти уведомления обрабатываются перед обычным фоновым добавочным индексированием файлов и хранилищ пользователя.</span><span class="sxs-lookup"><span data-stu-id="2cbc8-180">These notifications are processed before the normal background incremental indexing of a user's files and stores.</span></span> |



 

 

 
