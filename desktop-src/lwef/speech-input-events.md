---
title: События речевого ввода
description: События речевого ввода
ms.assetid: d7b621fe-9274-4b16-af8a-664b0b296c89
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0dc75bb010286b7645c206d192913017472829d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104068644"
---
# <a name="speech-input-events"></a><span data-ttu-id="1f386-103">События речевого ввода</span><span class="sxs-lookup"><span data-stu-id="1f386-103">Speech Input Events</span></span>

<span data-ttu-id="1f386-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="1f386-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="1f386-105">Кроме того, в уведомление о событии [**команды**](command-event.md) агент также уведомляет клиент ввода, когда сервер включает или выключает режим прослушивания с помощью событий [**листенстарт**](listenstart-event.md) и [**Листенкомплете**](listencomplete-event.md) ([**иажентнотифисинкекс:: листенингстате**](iagentnotifysinkex--listeningstate.md)).</span><span class="sxs-lookup"><span data-stu-id="1f386-105">In addition, to the [**Command**](command-event.md) event notification, Agent also notifies the input-active client when the server turns the Listening mode on or off, using the [**ListenStart**](listenstart-event.md) and [**ListenComplete**](listencomplete-event.md) events ([**IAgentNotifySinkEx::ListeningState**](iagentnotifysinkex--listeningstate.md)).</span></span> <span data-ttu-id="1f386-106">Тем не менее, если пользователь нажимает клавишу режима прослушивания и отсутствует соответствующий механизм распознавания речи для верхнего символа клиента input-Active, сервер запускает режим быстрого нажатия, но не создает событие **листенстарт** для активного клиента символа.</span><span class="sxs-lookup"><span data-stu-id="1f386-106">However, if the user presses the Listening mode key and there is no matching speech recognition engine available for the topmost character of the input-active client, the server starts the Listening hotkey mode time-out, but does not generate a **ListenStart** event for the active client of the character.</span></span> <span data-ttu-id="1f386-107">Если до завершения времени ожидания пользователь активирует другой символ с поддержкой модуля распознавания речи, сервер пытается активировать речевой ввод и создает событие **листенстарт** .</span><span class="sxs-lookup"><span data-stu-id="1f386-107">If, before the time-out completes, the user activates another character with speech recognition engine support, the server attempts to activate speech input and generates the **ListenStart** event.</span></span>

<span data-ttu-id="1f386-108">Аналогичным образом, если клиент пытается включить режим прослушивания с помощью метода [**Listen**](listen-method.md) и не существует соответствующего механизма распознавания речи, происходит сбой вызова и сервер не создает событие [**листенстарт**](listenstart-event.md).</span><span class="sxs-lookup"><span data-stu-id="1f386-108">Similarly, if a client attempts to turn on the Listening mode using the [**Listen**](listen-method.md) method and there is no matching speech recognition engine available, the call fails and the server does not generate a [**ListenStart**](listenstart-event.md)event.</span></span> <span data-ttu-id="1f386-109">В элементе управления Microsoft Agent метод **Listen** возвращает **значение false**, но вызов не вызывает ошибку.</span><span class="sxs-lookup"><span data-stu-id="1f386-109">In the Microsoft Agent control, the **Listen** method returns **False**, but the call does not raise an error.</span></span>

<span data-ttu-id="1f386-110">Если включен режим прослушивания ключей и пользователь переключается на символ, использующий другой модуль распознавания речи, сервер переключается на и активирует этот модуль и запускает [**листенкомплете**](listencomplete-event.md) , а затем событие [**листенстарт**](listenstart-event.md) .</span><span class="sxs-lookup"><span data-stu-id="1f386-110">When the Listening key mode is on and the user switches to a character that uses a different speech recognition engine, the server switches to and activates that engine and triggers a [**ListenComplete**](listencomplete-event.md) and then a [**ListenStart**](listenstart-event.md) event.</span></span> <span data-ttu-id="1f386-111">Если активированный символ не имеет доступного модуля распознавания речи (так как он не установлен или не соответствует параметру идентификатора языка активированного символа), сервер активирует событие **листенкомплете** для ранее активированного символа и передает обратно значение в параметре **причины** .</span><span class="sxs-lookup"><span data-stu-id="1f386-111">If the activated character does not have an available speech recognition engine (because one is not installed or none match the activated character's language ID setting), the server will trigger the **ListenComplete** event for the previously activated character and passes back a value in the **Cause** parameter.</span></span> <span data-ttu-id="1f386-112">Однако сервер не создает события **листенстарт** или **листенкомплете** для клиентов, не поддерживающих распознавание речи.</span><span class="sxs-lookup"><span data-stu-id="1f386-112">However, the server does not generate **ListenStart** or **ListenComplete** events for the clients that do not have speech recognition support.</span></span>

<span data-ttu-id="1f386-113">Если клиент успешно вызывает метод [**Listen**](listen-method.md) , а символ без поддержки модуля распознавания речи становится входным, до завершения ожидания, а затем пользователь возвращается к символу исходного клиента, сервер создает событие [**листенстарт**](listenstart-event.md) для этого клиента.</span><span class="sxs-lookup"><span data-stu-id="1f386-113">If a client successfully calls the [**Listen**](listen-method.md) method and a character without speech recognition engine support becomes input-active before the Listening mode time-out completes, and then the user switches back to the character of the original client, the server will generate a [**ListenStart**](listenstart-event.md) event for that client.</span></span>

<span data-ttu-id="1f386-114">Если входной-активный клиент переключает модули распознавания речи, изменяя [**срмодеид**](srmodeid-property.md) в режиме прослушивания, сервер переключается на этот модуль и активирует его без повторного запуска события [**листенстарт**](listenstart-event.md) .</span><span class="sxs-lookup"><span data-stu-id="1f386-114">If the input-active client switches speech recognition engines by changing [**SRModeID**](srmodeid-property.md) while in Listening mode, the server switches to and activates that engine without re-triggering the [**ListenStart**](listenstart-event.md) event.</span></span> <span data-ttu-id="1f386-115">Однако если указанный обработчик недоступен, вызов завершается неудачно (вызывает ошибку в элементе управления), а сервер также вызывает событие [**листенкомплете**](listencomplete-event.md) .</span><span class="sxs-lookup"><span data-stu-id="1f386-115">However, if the specified engine is not available, the call fails (raises an error in the control) and the server also calls the [**ListenComplete**](listencomplete-event.md) event.</span></span>

 

 




