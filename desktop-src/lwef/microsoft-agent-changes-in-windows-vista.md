---
title: Изменения Microsoft Agent в Windows Vista
description: Изменения Microsoft Agent в Windows Vista
ms.assetid: 2498e8d5-2274-477c-a807-77443c76afb7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 440fb8afb7acb0118c1e48669089c083e935db5b
ms.sourcegitcommit: 967ba3a2a618e6088cb607164a2a924530278645
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/30/2021
ms.locfileid: "113102153"
---
# <a name="microsoft-agent-changes-in-windows-vista"></a><span data-ttu-id="b2f21-103">Изменения Microsoft Agent в Windows Vista</span><span class="sxs-lookup"><span data-stu-id="b2f21-103">Microsoft Agent Changes in Windows Vista</span></span>

<span data-ttu-id="b2f21-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="b2f21-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="b2f21-105">В Windows Vista появились некоторые изменения в способах взаимодействия распознавания речи и речи с Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="b2f21-105">Windows Vista introduces some changes in how speech and speech recognition interact with Windows Vista.</span></span>

<span data-ttu-id="b2f21-106">Теперь Microsoft Agent поддерживает компоненты преобразования текста в речь 5 и распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="b2f21-106">Microsoft Agent now supports SAPI 5 Text-to-Speech and Speech Recognition components.</span></span> <span data-ttu-id="b2f21-107">Свойства Ттсмодеид и Срмодеид объекта Agent по-прежнему используются для определения выбранного голоса или распознавателя для агента и для изменения этого выбора.</span><span class="sxs-lookup"><span data-stu-id="b2f21-107">The TTSModeID and SRModeID properties of the Agent object are still used to determine which voice or recognizer is selected for the agent and to alter this selection.</span></span> <span data-ttu-id="b2f21-108">Режимы SAPI 4 отображаются как строки GUID, такие как "{ca141fd0-ac7f-11D1-97a3-006008273000}", а токены SAPI 5 (эквивалентно режимам) отображаются как обычные имена, например "Microsoft Анна".</span><span class="sxs-lookup"><span data-stu-id="b2f21-108">SAPI 4 modes appear as GUID strings such as "{ca141fd0-ac7f-11d1-97a3-006008273000}", while SAPI 5 tokens (equivalent to modes) appear as regular names, such as "Microsoft Anna".</span></span> <span data-ttu-id="b2f21-109">Как и в предыдущих выпусках, агент по умолчанию будет использовать механизмы TTS и SR.</span><span class="sxs-lookup"><span data-stu-id="b2f21-109">As in earlier releases, the agent will make a default choice of TTS and SR engines.</span></span> <span data-ttu-id="b2f21-110">Если установлены ядра SAPI 5, они всегда будут предпочтительнее всех ядер SAPI 4, которые могут быть установлены.</span><span class="sxs-lookup"><span data-stu-id="b2f21-110">If SAPI 5 engines are installed then these will always be preferred over any SAPI 4 engines that may be installed.</span></span> <span data-ttu-id="b2f21-111">Модуль преобразования текста в речь по умолчанию, как указано на панели управления, используется, если его пол соответствует символу, в противном случае выбирается ядро SAPI 5 того же пола, если таковой имеется.</span><span class="sxs-lookup"><span data-stu-id="b2f21-111">The user's default Text-to-Speech engine, as specified in the control panel, is used if its gender matches that of the character, otherwise a SAPI 5 engine of the same gender is chosen if one is available.</span></span> <span data-ttu-id="b2f21-112">Идентификаторы режима, указанные непосредственно в символе, игнорируются, если имеются обработчики SAPI 5.</span><span class="sxs-lookup"><span data-stu-id="b2f21-112">Mode ids specified directly on the character are ignored if SAPI 5 engines are present.</span></span> <span data-ttu-id="b2f21-113">Параметры по умолчанию можно проверить, прочитав свойства Ттсмодеид и Срмодеид в начале скрипта.</span><span class="sxs-lookup"><span data-stu-id="b2f21-113">The default selections can be verified by reading the TTSModeID and SRModeID properties at the beginning of your script.</span></span>

<span data-ttu-id="b2f21-114">Как и ранее, Ттсмодеид и Срмодеид будут возвращать пустую строку, если отсутствует возможность распознавания текста или речи.</span><span class="sxs-lookup"><span data-stu-id="b2f21-114">As before, TTSModeID and SRModeID will return a blank string if the Text-to-Speech or Speech Recognition capability is not present.</span></span> <span data-ttu-id="b2f21-115">Чтобы выбрать конкретный голосовой или распознаватель, необходимо задать для этих свойств соответствующую строку режима SAPI 4 или имя токена SAPI 5.</span><span class="sxs-lookup"><span data-stu-id="b2f21-115">A specific voice or recognizer can be selected by setting these properties to the appropriate SAPI 4 mode string or SAPI 5 token name.</span></span> <span data-ttu-id="b2f21-116">После настройки определенного режима или токена можно также снова прочитать свойство, чтобы убедиться, что его значение было принято, что означает, что новый режим или маркер действительно был доступен и был успешно выбран.</span><span class="sxs-lookup"><span data-stu-id="b2f21-116">After setting a specific mode or token, you can also read the property back again to verify that its value has taken, which indicates that the new mode or token was indeed available, and was successfully selected.</span></span> <span data-ttu-id="b2f21-117">Для разработчиков, занимающихся развертыванием агента через Интернет, обратите внимание, что у многих пользователей Vista уже установлен один или несколько голосов SAPI 5, поэтому вам может потребоваться избежать автоматической загрузки голосов SAPI 4, если только сценарий не запрашивает их, так как загруженный голос не будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="b2f21-117">For developers deploying Agent over the web, please note that many Vista users will have one or more SAPI 5 voices installed already, so you may want to avoid auto-downloading SAPI 4 voices unless your script specifically requests them, as the downloaded voice would not end up being used.</span></span>

<span data-ttu-id="b2f21-118">Модули преобразования текста в SAPI 5 используют разные наборы стандартов по сравнению с SAPI 4 для аннотирования речи с разметкой, например для изменения высоты или скорости распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="b2f21-118">SAPI 5 Text-to-Speech engines use a different set of standards than SAPI 4 for annotating speech with markup, for example to change the pitch or rate of the speech.</span></span> <span data-ttu-id="b2f21-119">В SAPI 4 используются команды "косая черта", такие как/Пит = 170/.</span><span class="sxs-lookup"><span data-stu-id="b2f21-119">In SAPI 4 you use "slash" commands, such as /pit=170/.</span></span> <span data-ttu-id="b2f21-120">В SAPI 5 используются XML-теги, такие как \<PITCH MIDDLE="5"/> .</span><span class="sxs-lookup"><span data-stu-id="b2f21-120">In SAPI 5 you use XML tags, such as \<PITCH MIDDLE="5"/>.</span></span> <span data-ttu-id="b2f21-121">В Vista агент принимает оба типа заметок в виде команд "косая черта", которые не будут пропускаться механизмами SAPI 5, а XML-теги будут игнорироваться механизмами SAPI 4.</span><span class="sxs-lookup"><span data-stu-id="b2f21-121">In Vista, Agent will accept both types of annotations in Speak method strings "slash" commands will be ignored by SAPI 5 engines, and XML tags will be ignored by SAPI 4 engines.</span></span> <span data-ttu-id="b2f21-122">Как и в случае с маркерами косой черты, поддержка XML-тегов SAPI 5 отличается от поставщика к поставщику, а некоторые поставщики могут поддерживать дополнительные теги.</span><span class="sxs-lookup"><span data-stu-id="b2f21-122">As with slash tags, support for SAPI 5 XML tags varies from vendor to vendor, and some vendors may support additional tags.</span></span> <span data-ttu-id="b2f21-123">Дополнительные сведения о XML-тегах SAPI 5 см. в спецификации SAPI 5.</span><span class="sxs-lookup"><span data-stu-id="b2f21-123">For more information on SAPI 5 XML tags, please see the SAPI 5 Specification.</span></span>

<span data-ttu-id="b2f21-124">Агент больше не поддерживает несколько языков.</span><span class="sxs-lookup"><span data-stu-id="b2f21-124">Agent no longer includes support for multiple languages.</span></span> <span data-ttu-id="b2f21-125">Язык, используемый агентом, всегда считается текущим языком пользователя, зарегистрированным в операционной системе.</span><span class="sxs-lookup"><span data-stu-id="b2f21-125">The language used by Agent is always assumed to be the user's current language, as registered with the operating system.</span></span> <span data-ttu-id="b2f21-126">Свойство LanguageID объекта агента по-прежнему доступно для записи, но его значение игнорируется агентом в Vista.</span><span class="sxs-lookup"><span data-stu-id="b2f21-126">The LanguageID property of the Agent object is still writable, but its value is ignored by Agent on Vista.</span></span> <span data-ttu-id="b2f21-127">Например, если язык пользователя задан как английский (&H0409), и он использует программу, которая устанавливает для LanguageID значение французский (&H040C), то текст подсказки голоса и дополнительные параметры символов по-прежнему будут отображаться на английском языке.</span><span class="sxs-lookup"><span data-stu-id="b2f21-127">For example if the user's language is set to US English (&H0409), and he or she uses a program that sets the LanguageID to French (&H040C), then the voice tip text, and Advanced Character Options dialogs will still appear in English.</span></span>

 

 




