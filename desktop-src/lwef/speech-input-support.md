---
title: Поддержка речевого ввода
description: Поддержка речевого ввода
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "105654311"
---
# <a name="speech-input-support"></a><span data-ttu-id="81049-103">Поддержка речевого ввода</span><span class="sxs-lookup"><span data-stu-id="81049-103">Speech Input Support</span></span>

<span data-ttu-id="81049-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="81049-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="81049-105">Помимо поддержки взаимодействия мыши и клавиатуры, Microsoft Agent включает прямую поддержку речевого ввода.</span><span class="sxs-lookup"><span data-stu-id="81049-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="81049-106">Поскольку поддержка Microsoft Agent для речевого ввода основана на Microsoft SAPI (интерфейс программирования речевых приложений), вы можете использовать Microsoft Agent с командами распознавания речи и механизмами управления, включающими поддержку SAPI.</span><span class="sxs-lookup"><span data-stu-id="81049-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="81049-107">Дополнительные сведения о требованиях к речевому подсистеме см. в разделе [требования поддержки обработчика речи](requirements-for-speech-recognition-engines.md).</span><span class="sxs-lookup"><span data-stu-id="81049-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="81049-108">Корпорация Майкрософт предоставляет механизм распознавания речи для команд и управления, который можно использовать с Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="81049-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="81049-109">Дополнительные сведения см. в разделе [Выбор модуля распознавания речи](speech-engine-selection.md).</span><span class="sxs-lookup"><span data-stu-id="81049-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="81049-110">Пользователь может инициировать речевой ввод, нажимая и удерживая клавишу прослушивания Push-to-разговора.</span><span class="sxs-lookup"><span data-stu-id="81049-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="81049-111">В этом режиме прослушивания, если обработчик речи получает начало речевого ввода, он удерживает канал звука открытым до тех пор, пока не обнаружит конец utterance.</span><span class="sxs-lookup"><span data-stu-id="81049-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="81049-112">Однако, когда вход не получен, он не блокирует выходные данные звука.</span><span class="sxs-lookup"><span data-stu-id="81049-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="81049-113">Это позволяет пользователю выдавать несколько голосовых команд, удерживая нажатой клавишу, и символ может ответить, когда пользователь не говорит.</span><span class="sxs-lookup"><span data-stu-id="81049-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="81049-114">Время ожидания истекает, когда пользователь отпускает ключ прослушивания.</span><span class="sxs-lookup"><span data-stu-id="81049-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="81049-115">Пользователь может настроить время ожидания для этого режима с помощью дополнительных параметров символов.</span><span class="sxs-lookup"><span data-stu-id="81049-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="81049-116">Вы не можете задать это время ожидания в коде клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="81049-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="81049-117">Если символ попытается говорить во время диктовки, то звуковая выводится не будет, хотя текст может по-прежнему отображаться в всплывающей подсказке.</span><span class="sxs-lookup"><span data-stu-id="81049-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="81049-118">Если в качестве символа используется звуковой канал во время нажатия клавиши прослушивания, сервер автоматически передает управление пользователю после обработки текста в методе [**говорите**](speak-method.md) .</span><span class="sxs-lookup"><span data-stu-id="81049-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="81049-119">Необязательный тон MIDI позволяет пользователю начать говорить.</span><span class="sxs-lookup"><span data-stu-id="81049-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="81049-120">Это позволяет пользователю вводить входные данные даже в том случае, если приложению, управляющему символом, не удалось предоставить логические паузы в выходных данных.</span><span class="sxs-lookup"><span data-stu-id="81049-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="81049-121">Можно также использовать метод [**Listen**](listen-method.md) для инициации речевого ввода.</span><span class="sxs-lookup"><span data-stu-id="81049-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="81049-122">Вызов этого метода включает распознавание речи для стандартного периода времени.</span><span class="sxs-lookup"><span data-stu-id="81049-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="81049-123">Если в течение этого интервала нет входных данных, Microsoft Agent автоматически отключает модуль распознавания речи и освобождает канал звука.</span><span class="sxs-lookup"><span data-stu-id="81049-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="81049-124">Это позволяет избежать блокировки входных данных и вывода данных с аудио устройства, а также минимизирует нагрузку на процессор, которую использует распознавание речи.</span><span class="sxs-lookup"><span data-stu-id="81049-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="81049-125">Для отключения речевого ввода можно также использовать метод **Listen** .</span><span class="sxs-lookup"><span data-stu-id="81049-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="81049-126">Однако имейте в виду, что так как модуль распознавания речи работает асинхронно, этот результат может оказаться немедленным.</span><span class="sxs-lookup"><span data-stu-id="81049-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="81049-127">В результате вы можете получить [**командное**](command-event.md) событие, даже если код, именуемый **Listen** , отключает речевой ввод.</span><span class="sxs-lookup"><span data-stu-id="81049-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="81049-128">Для поддержки речевого ввода вы определяете *грамматику*, набор слов, которые модуль распознавания речи должен прослушивать и сопоставлять как **голосовую** настройку для [**команды**](/windows/desktop/lwef/the-command-object) в коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="81049-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="81049-129">В грамматику можно включить необязательные и альтернативные слова и повторяющиеся последовательности.</span><span class="sxs-lookup"><span data-stu-id="81049-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="81049-130">Обратите внимание, что агент не включает клавишу прослушивания, пока один из его клиентов не загрузил модуль распознавания речи или не создал **голос** для одного из **командных** объектов.</span><span class="sxs-lookup"><span data-stu-id="81049-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="81049-131">Когда пользователь нажимает клавишу прослушивания или клиентское приложение вызывает метод [**Listen**](listen-method.md) для инициации речевого ввода, модуль распознавания речи пытается сопоставить входные данные utterance с грамматикой для определенных команд и передает информацию обратно серверу.</span><span class="sxs-lookup"><span data-stu-id="81049-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="81049-132">Затем сервер уведомляет клиентское приложение с помощью [**командного**](command-event.md) события ([**Иажентнотифисинк:: Command**](iagentnotifysink--command.md)); передача объекта [**UserInput**](/windows/desktop/lwef/iagentuserinput) , включающего идентификатор команды наилучшего соответствия и следующих двух альтернативных совпадений (если они есть), Оценка достоверности и соответствующий текст для каждого совпадения.</span><span class="sxs-lookup"><span data-stu-id="81049-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="81049-133">Сервер также уведомляет клиентское приложение о том, что оно соответствует речевому входу, одной из предоставляемых команд.</span><span class="sxs-lookup"><span data-stu-id="81049-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="81049-134">Хотя идентификатор команды равен **null**, вы по-прежнему получаете оценку достоверности и совпадение текста.</span><span class="sxs-lookup"><span data-stu-id="81049-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="81049-135">В режиме прослушивания сервер автоматически воспроизводит анимацию, назначенную для состояния **прослушивания** символа.</span><span class="sxs-lookup"><span data-stu-id="81049-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="81049-136">Затем, когда обнаруживается utterance, сервер воспроизводит анимацию состояния **слуха** символа.</span><span class="sxs-lookup"><span data-stu-id="81049-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="81049-137">Сервер сохранит символ в состоянии внимательный до завершения utterance.</span><span class="sxs-lookup"><span data-stu-id="81049-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="81049-138">Это предоставляет соответствующие социальные отзывы, которые позволят пользователю вводить данные.</span><span class="sxs-lookup"><span data-stu-id="81049-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="81049-139">Если пользователь отключает речевой ввод в дополнительных параметрах символов, клавиша прослушивания также будет отключена.</span><span class="sxs-lookup"><span data-stu-id="81049-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="81049-140">Аналогичным образом, попытка вызова метода [**Listen**](listen-method.md) при отключенном речевом вводе приведет к сбою метода.</span><span class="sxs-lookup"><span data-stu-id="81049-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 