---
title: Создание обработчиков поиска
description: Оболочка поддерживает несколько служебных программ поиска, позволяющих пользователям находить объекты пространства имен, такие как файлы или принтеры. Вы можете создать пользовательскую подсистему поиска и сделать ее доступной для пользователей, реализовав и зарегистрировав обработчик поиска.
ms.assetid: ffd023bb-16ab-43ce-b00b-5e32656c8013
keywords:
- Поиск обработчиков
- регистрация, обработчики поиска
- Статические обработчики поиска
- Регистр, статические обработчики поиска
- динамические обработчики поиска
- регистрация, динамические обработчики поиска
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6476109302a176822137747353b2762b0caea8a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337340"
---
# <a name="creating-search-handlers"></a><span data-ttu-id="2b706-110">Создание обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-110">Creating Search Handlers</span></span>

<span data-ttu-id="2b706-111">\[Эта функция поддерживается только в Windows XP и более ранних версиях.</span><span class="sxs-lookup"><span data-stu-id="2b706-111">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="2b706-112">Используйте вместо этого Поиск Windows.\]</span><span class="sxs-lookup"><span data-stu-id="2b706-112">Use Windows Search instead.\]</span></span>

<span data-ttu-id="2b706-113">Оболочка поддерживает несколько служебных программ поиска, позволяющих пользователям находить объекты пространства имен, такие как файлы или принтеры.</span><span class="sxs-lookup"><span data-stu-id="2b706-113">The Shell supports several search utilities that allow users to locate namespace objects such as files or printers.</span></span> <span data-ttu-id="2b706-114">Вы можете создать пользовательскую подсистему поиска и сделать ее доступной для пользователей, реализовав и зарегистрировав *обработчик поиска*.</span><span class="sxs-lookup"><span data-stu-id="2b706-114">You can create a custom search engine and make it available to users by implementing and registering a *search handler*.</span></span>

<span data-ttu-id="2b706-115">Общие процедуры для реализации и регистрации обработчика расширений оболочки обсуждаются в разделе [Создание обработчиков расширений оболочки](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="2b706-115">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="2b706-116">В этом документе рассматриваются аспекты реализации, характерные для обработчиков поиска.</span><span class="sxs-lookup"><span data-stu-id="2b706-116">This document focuses on those aspects of implementation that are specific to search handlers.</span></span>

-   [<span data-ttu-id="2b706-117">Принципы работы обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-117">How Search Handlers Work</span></span>](#how-search-handlers-work)
-   [<span data-ttu-id="2b706-118">Регистрация обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-118">Registering Search Handlers</span></span>](#registering-search-handlers)
    -   [<span data-ttu-id="2b706-119">Регистрация статического обработчика поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-119">Registering a Static Search Handler</span></span>](#registering-a-static-search-handler)
    -   [<span data-ttu-id="2b706-120">Регистрация динамического обработчика поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-120">Registering a Dynamic Search Handler</span></span>](#registering-a-dynamic-search-handler)
-   [<span data-ttu-id="2b706-121">Реализация обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-121">Implementing Search Handlers</span></span>](#implementing-search-handlers)

## <a name="how-search-handlers-work"></a><span data-ttu-id="2b706-122">Принципы работы обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-122">How Search Handlers Work</span></span>

<span data-ttu-id="2b706-123">Пользователи могут выбрать поисковую подсистему двумя способами.</span><span class="sxs-lookup"><span data-stu-id="2b706-123">Users have two ways to select a search engine.</span></span> <span data-ttu-id="2b706-124">Первый способ — из меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="2b706-124">The first way is from the Start menu.</span></span> <span data-ttu-id="2b706-125">В системах, предшествующих Windows 2000, при выборе команды **найти** в меню **Пуск** отображается подменю доступных поисковых систем.</span><span class="sxs-lookup"><span data-stu-id="2b706-125">With systems earlier than Windows 2000, selecting the **Find** command on the **Start** menu displays a submenu of the available search engines.</span></span> <span data-ttu-id="2b706-126">В Windows 2000 и более поздних версиях команда Find **меню «** **найти** » переименована в область поиска.</span><span class="sxs-lookup"><span data-stu-id="2b706-126">With Windows 2000 and later, the **St** art menu's **Find** command is renamed Search.</span></span> <span data-ttu-id="2b706-127">На следующем рисунке показана кнопка **поиска** в системе Windows XP.</span><span class="sxs-lookup"><span data-stu-id="2b706-127">The following illustration shows the **Search** button on a Windows XP system.</span></span>

![подменю "Поиск" в меню "Пуск"](images/searchhandler1.jpg)

<span data-ttu-id="2b706-129">Пользователи также могут запускать поиск в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="2b706-129">Users can also launch a search from Windows Explorer.</span></span> <span data-ttu-id="2b706-130">В системах, предшествующих Windows 2000, они **находят** в меню **Сервис** команду найти, чтобы отобразить практически то же меню, которое было связано с меню **Пуск** .</span><span class="sxs-lookup"><span data-stu-id="2b706-130">On systems earlier than Windows 2000, they click the **Find** command on the **Tools** menu to display essentially the same menu as the one associated with the **Start** menu.</span></span> <span data-ttu-id="2b706-131">Однако проводник Windows для Windows 2000 обрабатывает поисковые системы по-другому.</span><span class="sxs-lookup"><span data-stu-id="2b706-131">However, Windows Explorer for Windows 2000 handles search engines in a very different way.</span></span> <span data-ttu-id="2b706-132">Вместо того чтобы обрабатывать поисковые системы в виде подменю меню **Сервис** , теперь на панели инструментов появилась кнопка **поиска** .</span><span class="sxs-lookup"><span data-stu-id="2b706-132">Instead of handling search engines as a submenu of the **Tools** menu, there is now a **Search** button on the toolbar.</span></span> <span data-ttu-id="2b706-133">Нажатие этой кнопки открывает панель **поиска** панели обозревателя.</span><span class="sxs-lookup"><span data-stu-id="2b706-133">Clicking this button opens the Explorer bar's **Search** pane.</span></span> <span data-ttu-id="2b706-134">На следующем рисунке показан **Поиск по панели поиска файлов и папок** .</span><span class="sxs-lookup"><span data-stu-id="2b706-134">The following illustration shows the **Search For Files And Folders** search pane.</span></span>

![панель "Поиск" панели проводника Windows](images/searchhandler2.jpg)

<span data-ttu-id="2b706-136">Существует ряд различий в том, как Windows 2000 и более ранние системы управляют обработчиками поиска, которые влияют на реализацию и регистрацию.</span><span class="sxs-lookup"><span data-stu-id="2b706-136">There are a number of differences in how Windows 2000 and earlier systems manage search handlers that affect both implementation and registration.</span></span>



| <span data-ttu-id="2b706-137">Пред-Windows 2000</span><span class="sxs-lookup"><span data-stu-id="2b706-137">Pre-Windows 2000</span></span>                                                                                                                                                                                                       | <span data-ttu-id="2b706-138">Windows 2000 и более поздние версии</span><span class="sxs-lookup"><span data-stu-id="2b706-138">Windows 2000 and later</span></span>                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2b706-139">Обработчики поиска реализуются как тип [обработчика контекстного меню](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="2b706-139">Search handlers are implemented as a type of [shortcut menu handler](/windows/desktop/shell/context-menu-handlers).</span></span>                                                                                                                     | <span data-ttu-id="2b706-140">Обработчики поиска могут быть реализованы в виде обработчиков контекстного меню или в виде динамических HTML-документов (DHTML).</span><span class="sxs-lookup"><span data-stu-id="2b706-140">Search handlers can be implemented as shortcut menu handlers, or as Dynamic HTML (DHTML) documents.</span></span>                                                                                                                                                                                                               |
| <span data-ttu-id="2b706-141">Обработчики поиска могут быть либо статическими, либо динамическими.</span><span class="sxs-lookup"><span data-stu-id="2b706-141">Search handlers can be either static or dynamic.</span></span> <span data-ttu-id="2b706-142">Статические обработчики загружаются только в том случае, если они выбраны пользователем.</span><span class="sxs-lookup"><span data-stu-id="2b706-142">Static handlers are loaded only when they are selected by the user.</span></span> <span data-ttu-id="2b706-143">Динамические обработчики загружаются оболочкой при запуске и не завершаются до тех пор, пока оболочка не завершит работу.</span><span class="sxs-lookup"><span data-stu-id="2b706-143">Dynamic handlers are loaded by the Shell at startup and are not terminated until the Shell exits.</span></span> | <span data-ttu-id="2b706-144">Обработчики, реализованные как обработчики контекстного меню, могут быть либо статическими, либо динамическими.</span><span class="sxs-lookup"><span data-stu-id="2b706-144">Handlers implemented as shortcut menu handlers can be either static or dynamic.</span></span> <span data-ttu-id="2b706-145">Обработчики, реализованные как документы DHTML, должны быть статическими.</span><span class="sxs-lookup"><span data-stu-id="2b706-145">Handlers implemented as DHTML documents must be static.</span></span>                                                                                                                                                                           |
| <span data-ttu-id="2b706-146">Обработчики поиска отображаются в подменю " **найти** " меню " **Пуск** " и подменю " **найти** " меню " **Сервис** " проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="2b706-146">Search handlers appear on the **Find** submenu of the **Start** menu and the **Find** submenu of the Windows Explorer **Tools** menu.</span></span>                                                                                  | <span data-ttu-id="2b706-147">Обработчики поиска отображаются только в подменю **Поиск** меню **Пуск** .</span><span class="sxs-lookup"><span data-stu-id="2b706-147">Search handlers appear only on the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="2b706-148">Чтобы сделать настраиваемую панель поиска доступной в строке меню проводника Windows, необходимо реализовать ее как [объект диапазона](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2b706-148">To make a custom search pane available through the Windows Explorer menu bar, you must implement it as a [band object](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span> <span data-ttu-id="2b706-149">Затем она отображается в подменю **панели обозревателя** в меню  **вид** проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="2b706-149">It is then listed on the **Explorer Bar** submenu of the Windows Explorer **View** menu.</span></span> |



 

## <a name="registering-search-handlers"></a><span data-ttu-id="2b706-150">Регистрация обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-150">Registering Search Handlers</span></span>

<span data-ttu-id="2b706-151">Обработчики поиска регистрируются в подразделе **финдекстенсионс** типов файлов.</span><span class="sxs-lookup"><span data-stu-id="2b706-151">Search handlers are registered under the file types's **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="2b706-152">С этого момента процедура регистрации зависит от того, должен ли обработчик быть статическим или динамическим.</span><span class="sxs-lookup"><span data-stu-id="2b706-152">From this point, the registration procedure depends on whether the handler is to be static or dynamic.</span></span> <span data-ttu-id="2b706-153">Общие сведения о регистрации обработчиков расширений оболочки см. в статье [Создание обработчиков расширений](/windows/desktop/shell/handlers)оболочки.</span><span class="sxs-lookup"><span data-stu-id="2b706-153">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span>

### <a name="registering-a-static-search-handler"></a><span data-ttu-id="2b706-154">Регистрация статического обработчика поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-154">Registering a Static Search Handler</span></span>

<span data-ttu-id="2b706-155">Статические обработчики поиска загружаются только при запуске пользователем.</span><span class="sxs-lookup"><span data-stu-id="2b706-155">Static search handlers are loaded only when they are launched by the user.</span></span> <span data-ttu-id="2b706-156">Этот подход лучше подходит для небольших библиотек DLL, которые можно быстро загрузить.</span><span class="sxs-lookup"><span data-stu-id="2b706-156">This approach works best for DLLs that are small and can be loaded quickly.</span></span> <span data-ttu-id="2b706-157">Если для реализации обработчика используется DHTML, он должен быть статическим.</span><span class="sxs-lookup"><span data-stu-id="2b706-157">If you are using DHTML to implement your handler, it must be static.</span></span> <span data-ttu-id="2b706-158">Чтобы зарегистрировать статический обработчик расширений, создайте подраздел с именем для обработчика в **статическом** подразделе подраздела **финдекстенсионс** .</span><span class="sxs-lookup"><span data-stu-id="2b706-158">To register a static extension handler, create a subkey named for the handler under the **Static** subkey of the **FindExtensions** subkey.</span></span> <span data-ttu-id="2b706-159">Имя не используется системой, но оно не должно совпадать с другими именами обработчиков поиска в подразделе **финдекстенсионс** .</span><span class="sxs-lookup"><span data-stu-id="2b706-159">The name is not used by the system, but it must not be identical to other search handler names under the **FindExtensions** subkey.</span></span>

### <a name="shortcut-menu-based-search-handlers"></a><span data-ttu-id="2b706-160">Обработчики поиска на основе контекстного меню</span><span class="sxs-lookup"><span data-stu-id="2b706-160">Shortcut menu-based search handlers</span></span>

<span data-ttu-id="2b706-161">Если обработчик реализуется как [обработчик контекстного меню](/windows/desktop/shell/context-menu-handlers), установите значение по умолчанию для подраздела имени обработчика в GUID идентификатора класса (CLSID) объекта.</span><span class="sxs-lookup"><span data-stu-id="2b706-161">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), set the default value of the handler's name subkey to the object's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="2b706-162">В подразделе имени обработчика создайте подраздел с именем **0**   (ноль) и задайте в качестве значения по умолчанию строку, которая будет отображаться в подменю **Поиск** или **найти** .</span><span class="sxs-lookup"><span data-stu-id="2b706-162">Under the handler's name subkey, create a subkey named **0** (zero) and set its default value to the string that will be displayed in the **Search** or **Find** submenu.</span></span> <span data-ttu-id="2b706-163">Сочетания клавиш можно включить обычным способом, добавив перед ним символ амперсанда (&).</span><span class="sxs-lookup"><span data-stu-id="2b706-163">You can enable keyboard shortcuts in the usual way, by preceding the shortcut character with an ampersand (&).</span></span> <span data-ttu-id="2b706-164">Можно отобразить необязательный маленький значок справа от текста меню, создав подраздел **дефаултикон** в подразделе **0** .</span><span class="sxs-lookup"><span data-stu-id="2b706-164">You can have an optional small icon displayed to the right of the menu text by creating a **DefaultIcon** subkey under the **0** subkey.</span></span> <span data-ttu-id="2b706-165">Присвойте значение по умолчанию строке, содержащей путь к файлу, содержащему значок, за которым следует запятая, а затем — Отсчитываемый от нуля индекс.</span><span class="sxs-lookup"><span data-stu-id="2b706-165">Set its default value to a string containing the path of the file containing the icon, followed by a comma, followed by the icon's zero-based index.</span></span>

<span data-ttu-id="2b706-166">В следующем примере регистрируется обработчик поиска **мисеарченгине** .</span><span class="sxs-lookup"><span data-stu-id="2b706-166">The following example registers the **MySearchEngine** search handler.</span></span> <span data-ttu-id="2b706-167">Текст меню — "Моя поисковая система", а в качестве сочетания клавиш задано значение M.</span><span class="sxs-lookup"><span data-stu-id="2b706-167">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="2b706-168">Значок находится в C: \\ MyDir \\MySearch.dll с индексом 2.</span><span class="sxs-lookup"><span data-stu-id="2b706-168">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {MySearchEngine CLSID GUID}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
```

### <a name="dhtml-based-search-handlers"></a><span data-ttu-id="2b706-169">Обработчики поиска на основе DHTML</span><span class="sxs-lookup"><span data-stu-id="2b706-169">DHTML-based search handlers</span></span>

<span data-ttu-id="2b706-170">В Windows 2000 можно также реализовать обработчик поиска в виде документа DHTML.</span><span class="sxs-lookup"><span data-stu-id="2b706-170">With Windows 2000, you can also implement a search handler as a DHTML document.</span></span> <span data-ttu-id="2b706-171">Его имя указано в подменю **Поиск** в меню **Пуск** .</span><span class="sxs-lookup"><span data-stu-id="2b706-171">Its name is listed in the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="2b706-172">Когда пользователь выбирает его, он запускает проводник Windows с открытой в нем панелью обозревателя.</span><span class="sxs-lookup"><span data-stu-id="2b706-172">When the user selects it, it launches Windows Explorer with the Explorer bar opened to the search document.</span></span> <span data-ttu-id="2b706-173">Можно также указать документ DHTML, который будет отображаться справа от панели обозревателя.</span><span class="sxs-lookup"><span data-stu-id="2b706-173">You can also specify a DHTML document to be displayed to the right of the Explorer bar.</span></span> <span data-ttu-id="2b706-174">Невозможно запустить другой обработчик из панели поиска по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="2b706-174">There is no way to launch a different handler from the default Search pane.</span></span> <span data-ttu-id="2b706-175">Поисковые системы можно запустить непосредственно из проводника Windows, но только в том случае, если они реализованы как [объекты полос](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2b706-175">Search engines can be launched directly from Windows Explorer, but only if they are implemented as as [band objects](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span>

<span data-ttu-id="2b706-176">Чтобы зарегистрировать обработчик поиска на основе DHTML, задайте для подраздела имени обработчика форму строки CLSID \_ шеллсеарчекст (в настоящее время {169A0691-8DF9-11D1-A1C4-00C04FD75D13}) и создайте следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="2b706-176">To register a DHTML-based search handler, set the handler's name subkey to the string form of CLSID\_ShellSearchExt (currently {169A0691-8DF9-11d1-A1C4-00C04FD75D13}) and create the following subkeys.</span></span>

1.  <span data-ttu-id="2b706-177">Создайте подраздел **0**(нуль) в подразделе "имя обработчика" и задайте в качестве значения по умолчанию текст меню.</span><span class="sxs-lookup"><span data-stu-id="2b706-177">Create a **0**(zero) subkey under the handler name subkey and set its default value to the menu text.</span></span>
2.  <span data-ttu-id="2b706-178">Чтобы значок отображался рядом с текстом меню, создайте подраздел **дефаултикон** в разделе **0** и задайте в качестве значения по умолчанию путь и индекс значка.</span><span class="sxs-lookup"><span data-stu-id="2b706-178">To have an icon displayed next to the menu text, create a **DefaultIcon** subkey under **0** and set its default value to the icon's path and index.</span></span>
3.  <span data-ttu-id="2b706-179">Создайте подраздел **сеарчгуид** в разделе **0**.</span><span class="sxs-lookup"><span data-stu-id="2b706-179">Create a **SearchGUID** subkey under **0**.</span></span> <span data-ttu-id="2b706-180">Назначьте идентификатор GUID для документа DHTML и задайте в качестве значения по умолчанию **сеарчгуид** строку.</span><span class="sxs-lookup"><span data-stu-id="2b706-180">Assign a GUID to the DHTML document and set the default value of **SearchGUID** to its string form.</span></span> <span data-ttu-id="2b706-181">Этот идентификатор GUID не требуется регистрировать в **\_ \_ корневом \\ идентификаторе CLSID классов hKey**.</span><span class="sxs-lookup"><span data-stu-id="2b706-181">This GUID does not need to be registered under **HKEY\_CLASSES\_ROOT\\CLSID**.</span></span>
4.  <span data-ttu-id="2b706-182">Создайте подраздел **URL-адреса** в разделе **сеарчгуид**.</span><span class="sxs-lookup"><span data-stu-id="2b706-182">Create a **Url** subkey under **SearchGUID**.</span></span> <span data-ttu-id="2b706-183">Задайте в качестве значения по умолчанию путь к HTML-документу, который будет отображаться на панели обозревателя.</span><span class="sxs-lookup"><span data-stu-id="2b706-183">Set its default value to the path of the HTML document that will appear in the Explorer bar.</span></span>
5.  <span data-ttu-id="2b706-184">Создайте подраздел **урлнавнев** в разделе **сеарчгуид**.</span><span class="sxs-lookup"><span data-stu-id="2b706-184">Create a **UrlNavNew** subkey under **SearchGUID**.</span></span> <span data-ttu-id="2b706-185">Задайте в качестве значения по умолчанию путь к HTML-документу, который будет отображаться справа от панели обозревателя.</span><span class="sxs-lookup"><span data-stu-id="2b706-185">Set its default value to the path of the HTML document that will appear to the right of the Explorer bar.</span></span>

<span data-ttu-id="2b706-186">В следующем примере выполняется регистрация обработчика поиска **мисеарченгине** , реализованного в виде документа DHTML.</span><span class="sxs-lookup"><span data-stu-id="2b706-186">The following example registers the **MySearchEngine** search handler implemented as a DHTML document.</span></span> <span data-ttu-id="2b706-187">Текст меню — "Моя поисковая система", а в качестве сочетания клавиш задано значение M.</span><span class="sxs-lookup"><span data-stu-id="2b706-187">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="2b706-188">Значок находится в C: \\ MyDir \\MySearch.dll с индексом 2.</span><span class="sxs-lookup"><span data-stu-id="2b706-188">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span> <span data-ttu-id="2b706-189">HTML-документ панели обозревателя имеет значение C: \\ MyDir \\MySearch.htm, а документ, который будет отображаться справа от панели обозревателя, — c: \\ MyDir \\MySearchPage.htm.</span><span class="sxs-lookup"><span data-stu-id="2b706-189">The Explorer bar's DHTML document is C:\\MyDir\\MySearch.htm, and the document that will be displayed to the right of the Explorer bar is C:\\MyDir\\MySearchPage.htm.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {169A0691-8DF9-11d1-A1C4-00C04FD75D13}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
                                 SearchGUID
                                    (Default) = {My Search GUID}
                                    Url
                                       (Default) = C:\MyDir\MySearch.htm
                                    UrlNavNew
                                       (Default) = C:\MyDir\MySearchPage.htm
```

### <a name="registering-a-dynamic-search-handler"></a><span data-ttu-id="2b706-190">Регистрация динамического обработчика поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-190">Registering a Dynamic Search Handler</span></span>

<span data-ttu-id="2b706-191">Если обработчик реализуется как [обработчик контекстного меню](/windows/desktop/shell/context-menu-handlers), его также можно зарегистрировать как динамический обработчик.</span><span class="sxs-lookup"><span data-stu-id="2b706-191">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), you can also register it as a dynamic handler.</span></span> <span data-ttu-id="2b706-192">В этом случае он будет загружен с оболочкой и завершится только после выхода из оболочки.</span><span class="sxs-lookup"><span data-stu-id="2b706-192">In that case, it will be loaded with the Shell and will terminate only when the Shell exits.</span></span> <span data-ttu-id="2b706-193">Динамические обработчики поиска отвечают гораздо быстрее, чем статические обработчики, когда они запускаются пользователем.</span><span class="sxs-lookup"><span data-stu-id="2b706-193">Dynamic search handlers respond much more quickly than static handlers when they are launched by the user.</span></span> <span data-ttu-id="2b706-194">Такой подход лучше всего подходит, если загрузка DLL-библиотеки обработчика может занять много времени или часто вызывается.</span><span class="sxs-lookup"><span data-stu-id="2b706-194">This approach works best if your handler's DLL might take a long time to load, or if it is likely to be called frequently.</span></span>

<span data-ttu-id="2b706-195">Динамические обработчики поиска регистрируются в подразделе **финдекстенсионс** .</span><span class="sxs-lookup"><span data-stu-id="2b706-195">Dynamic search handlers are registered under the **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="2b706-196">Создайте подраздел **финдекстенсионс** с именем для обработчика и задайте для его значения по умолчанию идентификатор CLSID обработчика.</span><span class="sxs-lookup"><span data-stu-id="2b706-196">Create a subkey of **FindExtensions** named for the handler, and set its default value to the handler's CLSID GUID.</span></span> <span data-ttu-id="2b706-197">Значки меню не поддерживаются для обработчиков динамического поиска.</span><span class="sxs-lookup"><span data-stu-id="2b706-197">Menu icons are not supported for dynamic search handlers.</span></span> <span data-ttu-id="2b706-198">В следующем примере Мисеарченгине регистрируется в качестве динамического обработчика поиска.</span><span class="sxs-lookup"><span data-stu-id="2b706-198">The following example registers MySearchEngine as a dynamic search handler.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     MySearchEngine
                        (Default) = {MySearchEngine CLSID GUID}
                        0
                           (Default) = &My Search Engine
```

<span data-ttu-id="2b706-199">В отличие от статических обработчиков поиска, текст меню не указывается в реестре.</span><span class="sxs-lookup"><span data-stu-id="2b706-199">Unlike static search handlers, you do not specify the menu text in the registry.</span></span> <span data-ttu-id="2b706-200">Когда обработчик загружен, оболочка вызывает метод обработчика [**IContextMenu:: куериконтекстмену**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) , чтобы добавить элементы в подменю **Поиск** или **Поиск** .</span><span class="sxs-lookup"><span data-stu-id="2b706-200">When the handler is loaded, the Shell will call the handler's [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) method to add items to the **Find** or **Search** submenu.</span></span>

## <a name="implementing-search-handlers"></a><span data-ttu-id="2b706-201">Реализация обработчиков поиска</span><span class="sxs-lookup"><span data-stu-id="2b706-201">Implementing Search Handlers</span></span>

<span data-ttu-id="2b706-202">Обработчики поиска могут быть реализованы как обработчики контекстного меню для всех версий Windows.</span><span class="sxs-lookup"><span data-stu-id="2b706-202">Search handlers can be implemented as shortcut menu handlers for all versions of Windows.</span></span> <span data-ttu-id="2b706-203">Для Windows 2000 они также могут быть реализованы в виде документов DHTML.</span><span class="sxs-lookup"><span data-stu-id="2b706-203">For Windows 2000, they can also be implemented as DHTML documents.</span></span>

<span data-ttu-id="2b706-204">Общее описание способов реализации обработчиков контекстного меню см. в разделе [Создание обработчиков контекстного](/windows/desktop/shell/context-menu-handlers)меню.</span><span class="sxs-lookup"><span data-stu-id="2b706-204">For a general discussion of how to implement shortcut menu handlers, see [Creating Context Menu Handlers](/windows/desktop/shell/context-menu-handlers).</span></span> <span data-ttu-id="2b706-205">Обработчики поиска отличаются от стандартных обработчиков контекстного меню только несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="2b706-205">Search handlers differ from standard shortcut menu handlers in only a few ways.</span></span>

<span data-ttu-id="2b706-206">Для обработчиков статического меню подменю **Поиск** или **Поиск** создается на основе сведений в реестре.</span><span class="sxs-lookup"><span data-stu-id="2b706-206">For static menu handlers, the **Find** or **Search** submenu is created from the information in the registry.</span></span> <span data-ttu-id="2b706-207">Обработчику не нужно добавлять элемент меню в качестве обычного обработчика контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="2b706-207">There is no need to have the handler add a menu item, as a normal shortcut menu handler would.</span></span> <span data-ttu-id="2b706-208">Оболочка управляет обработчиками статических меню следующим образом.</span><span class="sxs-lookup"><span data-stu-id="2b706-208">The Shell manages static menu handlers in the following way.</span></span>

-   <span data-ttu-id="2b706-209">Когда пользователь запускает пункт меню обработчика, оболочка загружает DLL-библиотеку обработчика и вызывает [**IContextMenu:: инвокекомманд**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) , чтобы уведомить обработчик о необходимости запуска поисковой системы.</span><span class="sxs-lookup"><span data-stu-id="2b706-209">When the user launches the handler's menu item, the Shell loads the handler's DLL and calls [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to notify the handler to launch the search engine.</span></span> <span data-ttu-id="2b706-210">Методы [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) и [**IContextMenu:: куериконтекстмену**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) не вызываются.</span><span class="sxs-lookup"><span data-stu-id="2b706-210">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) methods are not called.</span></span>
-   <span data-ttu-id="2b706-211">При вызове [**IContextMenu:: инвокекомманд**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) элемент **лпверб** структуры [**кминвокекоммандинфо**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) , который передается, идентифицирует команду.</span><span class="sxs-lookup"><span data-stu-id="2b706-211">When [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) is called, the **lpVerb** member of the [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) structure that is passed in identifies the command.</span></span> <span data-ttu-id="2b706-212">Младшее слово **лпверб** устанавливается равным числовому эквиваленту имени подраздела команды.</span><span class="sxs-lookup"><span data-stu-id="2b706-212">The low-order word of **lpVerb** is set to the numerical equivalent of the command's subkey name.</span></span> <span data-ttu-id="2b706-213">Так как этот подраздел обычно называется **0**, **лпверб** обычно имеет нулевое значение.</span><span class="sxs-lookup"><span data-stu-id="2b706-213">Since this subkey is normally named **0**, **lpVerb** is usually set to zero.</span></span> <span data-ttu-id="2b706-214">Затем обработчик должен запустить поисковую подсистему.</span><span class="sxs-lookup"><span data-stu-id="2b706-214">The handler should then launch the search engine.</span></span>

<span data-ttu-id="2b706-215">Динамические обработчики поиска реализуются во многом так же, как и обычные обработчики контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="2b706-215">Dynamic search handlers are implemented in much the same way as normal shortcut menu handlers.</span></span> <span data-ttu-id="2b706-216">Основное исключение заключается в том, что при вызове [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) для аргументов *пидлфолдер* и *лпдобж* устанавливается **значение NULL**.</span><span class="sxs-lookup"><span data-stu-id="2b706-216">The primary exception is that when [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) is called, the *pidlFolder* and *lpdobj* arguments are set to **NULL**.</span></span>

<span data-ttu-id="2b706-217">Обработчики поиска на основе DHTML реализуются как обычные документы DHTML.</span><span class="sxs-lookup"><span data-stu-id="2b706-217">DHTML-based search handlers are implemented as a normal DHTML document.</span></span> <span data-ttu-id="2b706-218">Они могут включать в себя любую технологию HTML, DHTML или сценарии, поддерживаемую Windows Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="2b706-218">They can include any HTML, DHTML, or scripting technology that is supported by Windows Internet Explorer.</span></span>

 

 