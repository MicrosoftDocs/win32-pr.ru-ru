---
title: Иаженткоммандс Сетвоице
description: Иаженткоммандс Сетвоице
ms.assetid: dfb3b58a-7f24-4366-8f04-93a9e956fdc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a8e29936dbca65ffded5f8a5e5ea5297b28362e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104487593"
---
# <a name="iagentcommandssetvoice"></a><span data-ttu-id="f005d-103">Иаженткоммандс:: Сетвоице</span><span class="sxs-lookup"><span data-stu-id="f005d-103">IAgentCommands::SetVoice</span></span>

<span data-ttu-id="f005d-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="f005d-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

``` syntax
HRESULT SetVoice(
   BSTR bszVoice  // the Voice setting for Command collection
);
```

<span data-ttu-id="f005d-105">Задает свойство текста [**голоса**](voice-property.md) для [**команды**](/windows/desktop/lwef/the-command-object).</span><span class="sxs-lookup"><span data-stu-id="f005d-105">Sets the [**Voice**](voice-property.md) text property for a [**Command**](/windows/desktop/lwef/the-command-object).</span></span>

-   <span data-ttu-id="f005d-106">Возвращает значение S \_ , чтобы указать, что операция выполнена успешно.</span><span class="sxs-lookup"><span data-stu-id="f005d-106">Returns S\_OK to indicate the operation was successful.</span></span>

<dl> <dt>

<span data-ttu-id="f005d-107"><span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*бсзвоице*</span><span class="sxs-lookup"><span data-stu-id="f005d-107"><span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*bszVoice*</span></span>
</dt> <dd>

<span data-ttu-id="f005d-108">Объект BSTR, указывающий значение для свойства "текст [**голоса**](voice-property.md) " коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="f005d-108">A BSTR that specifies the value for the [**Voice**](voice-property.md) text property of a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span>

</dd> </dl>

<span data-ttu-id="f005d-109">Для коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) свойство " [**голосовое**](voice-property.md) сообщение" должно иметь значение "доступ к голосовым данным".</span><span class="sxs-lookup"><span data-stu-id="f005d-109">A [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection must have its [**Voice**](voice-property.md) text property set to be voice-accessible.</span></span> <span data-ttu-id="f005d-110">Кроме того, свойство [**воицекаптион**](voicecaption-property.md) или [**Caption**](caption-property.md) должно иметь значение, отображаемое в окне "Voice Commands", а свойство [**Visible**](visible-property.md) — значение **true** , чтобы оно отображалось во всплывающем меню символа.</span><span class="sxs-lookup"><span data-stu-id="f005d-110">It also must have its [**VoiceCaption**](voicecaption-property.md) or [**Caption**](caption-property.md) property set to appear in the Voice Commands Window and its [**Visible**](visible-property.md) property set to **True** to appear on the character's pop-up menu.</span></span>

<span data-ttu-id="f005d-111">Указываемое выражение BSTR может включать в себя квадратные скобки ( \[ \] ) для обозначения дополнительных слов и символов вертикальной черты ( \| ) для указания альтернативных строк.</span><span class="sxs-lookup"><span data-stu-id="f005d-111">The BSTR expression you supply can include square bracket characters (\[ \]) to indicate optional words and vertical bar characters (\|) to indicate alternative strings.</span></span> <span data-ttu-id="f005d-112">Альтернативные варианты должны быть заключены в круглые скобки.</span><span class="sxs-lookup"><span data-stu-id="f005d-112">Alternates must be enclosed in parentheses.</span></span> <span data-ttu-id="f005d-113">Например, "(Привет! \[ \] \| Привет!)" говорит обработчику распознавания речи, что для команды нужно принять "Hello," Hello "или" Hi ".</span><span class="sxs-lookup"><span data-stu-id="f005d-113">For example, "(hello \[there\] \| hi)" tells the speech engine to accept "hello," "hello there," or "hi" for the command.</span></span> <span data-ttu-id="f005d-114">Не забывайте включать в скобки, а также другие текстовые пробелы.</span><span class="sxs-lookup"><span data-stu-id="f005d-114">Remember to include appropriate spaces between words you include in brackets or parentheses as well as other text.</span></span> <span data-ttu-id="f005d-115">Не забывайте включать в скобки и скобки соответствующие пробелы, а также текст, заключенный в квадратные скобки.</span><span class="sxs-lookup"><span data-stu-id="f005d-115">Remember to include appropriate spaces between the text that's in brackets or parentheses and the text that's not in brackets or parentheses.</span></span>

<span data-ttu-id="f005d-116">Оператор Star () можно использовать, \* чтобы указать ноль или несколько экземпляров слов, входящих в группу, или оператор «плюс» (+), чтобы указать один или несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="f005d-116">You can use the star (\*) operator to specify zero or more instances of the words included in the group or the plus (+) operator to specify one or more instances.</span></span> <span data-ttu-id="f005d-117">Например, следующий пример приводит к грамматике, которая поддерживает команду "попробовать это", "Попробуйте" и "Попробуйте", с неограниченными итерациями ".</span><span class="sxs-lookup"><span data-stu-id="f005d-117">For example, the following results in a grammar that supports "try this", "please try this", and "please please try this", with unlimited iterations of "please":</span></span>

``` syntax
   "please* try this"
```

<span data-ttu-id="f005d-118">Следующий формат грамматики исключает "попробовать это", так как оператор + определяет по крайней мере один экземпляр ".</span><span class="sxs-lookup"><span data-stu-id="f005d-118">The following grammar format excludes "try this" because the + operator defines at least one instance of "please":</span></span>

``` syntax
   "please+ try this"
```

<span data-ttu-id="f005d-119">Операторы повторения следуют обычным правилам приоритета и применяются к непосредственно предшествующему текстовому элементу.</span><span class="sxs-lookup"><span data-stu-id="f005d-119">The repetition operators follow normal rules of precedence and apply to the immediately preceding text item.</span></span> <span data-ttu-id="f005d-120">Например, следующая грамматика приводит к последующим результатам: "Нью Йорк" и "Нью Йорк York", но не "Нью Москва".</span><span class="sxs-lookup"><span data-stu-id="f005d-120">For example, the following grammar results in "New York" and "New York York", but not "New York New York":</span></span>

``` syntax
   "New York+"
```

<span data-ttu-id="f005d-121">Поэтому обычно следует использовать эти операторы с символами группирования.</span><span class="sxs-lookup"><span data-stu-id="f005d-121">Therefore, you typically want to use these operators with the grouping characters.</span></span> <span data-ttu-id="f005d-122">Например, следующая грамматика включает в себя "Нью Йорк" и "Нью Йорк":</span><span class="sxs-lookup"><span data-stu-id="f005d-122">For example, the following grammar includes both "New York" and "New York New York":</span></span>

``` syntax
   "(New York)+"
```

<span data-ttu-id="f005d-123">Операторы повторения полезны, если необходимо составить грамматику, которая включает повторяющиеся последовательности, такие как номер телефона или спецификация списка элементов:</span><span class="sxs-lookup"><span data-stu-id="f005d-123">Repetition operators are useful when you want to compose a grammar that includes a repeated sequence such as a phone number or specification of a list of items:</span></span>

``` syntax
   "call (one|two|three|four|five|six|seven|eight|nine|zero|oh)*"
   "I'd like (cheese|pepperoni|pineapple|canadian bacon|mushrooms|and)+"
```

<span data-ttu-id="f005d-124">Хотя операторы также можно использовать с квадратными скобками (необязательный символ группирования), это может снизить эффективность обработки грамматики агента.</span><span class="sxs-lookup"><span data-stu-id="f005d-124">Although the operators can also be used with square brackets (an optional grouping character), doing so may reduce the efficiency of Agent's processing of the grammar.</span></span>

<span data-ttu-id="f005d-125">Кроме того, можно использовать многоточие (...) для поддержки поиска *слов*, то есть сообщить модулю распознавания речи о необходимости пропускать слова, пропускаемые в этой должности, в фразе (иногда называемых словами- *мусором* ).</span><span class="sxs-lookup"><span data-stu-id="f005d-125">You can also use an ellipsis (...) to support *word spotting*, that is, telling the speech recognition engine to ignore words spoken in this position in the phrase (sometimes called *garbage* words).</span></span> <span data-ttu-id="f005d-126">При использовании многоточия подсистема распознавания речи распознает только определенные слова в строке, независимо от того, говорят ли они с соседними словами или фразами.</span><span class="sxs-lookup"><span data-stu-id="f005d-126">When you use ellipses, the speech engine recognizes only specific words in the string regardless of when spoken with adjacent words or phrases.</span></span> <span data-ttu-id="f005d-127">Например, если для этого свойства задано значение " \[ ... \] проверить почту \[ ... \] "модуль распознавания речи будет сопоставлять такие фразы, как" проверить почту "или" проверить почту ", с помощью этой команды.</span><span class="sxs-lookup"><span data-stu-id="f005d-127">For example, if you set this property to "\[...\] check mail \[...\]" the speech recognition engine will match phrases like "please check mail" or "check mail please" to this command.</span></span> <span data-ttu-id="f005d-128">Многоточие можно использовать в любом месте строки.</span><span class="sxs-lookup"><span data-stu-id="f005d-128">Ellipses can be used anywhere within a string.</span></span> <span data-ttu-id="f005d-129">Однако будьте внимательны при использовании этой методики, так как параметры голоса с многоточием могут увеличить потенциальные нежелательные совпадения.</span><span class="sxs-lookup"><span data-stu-id="f005d-129">However, be careful using this technique as voice settings with ellipses may increase the potential of unwanted matches.</span></span>

<span data-ttu-id="f005d-130">При определении слов и грамматики для команды включите по крайней мере одно необходимое слово; то есть не указывайте только необязательные слова.</span><span class="sxs-lookup"><span data-stu-id="f005d-130">When defining the words and grammar for your command, include at least one word that is required; that is, avoid supplying only optional words.</span></span> <span data-ttu-id="f005d-131">Кроме того, убедитесь, что слово содержит только произношенные слова и буквы.</span><span class="sxs-lookup"><span data-stu-id="f005d-131">In addition, make sure that the word includes only pronounceable words and letters.</span></span> <span data-ttu-id="f005d-132">Для чисел лучше использовать слово, а не однозначное представление.</span><span class="sxs-lookup"><span data-stu-id="f005d-132">For numbers, it is better to spell out the word rather than use an ambiguous representation.</span></span> <span data-ttu-id="f005d-133">Например, "345" не является хорошей формой грамматики.</span><span class="sxs-lookup"><span data-stu-id="f005d-133">For example, "345" is not a good grammar form.</span></span> <span data-ttu-id="f005d-134">Аналогичным образом вместо «IEEE» используется «I Triple E».</span><span class="sxs-lookup"><span data-stu-id="f005d-134">Similarly, instead of "IEEE", use "I triple E".</span></span> <span data-ttu-id="f005d-135">Кроме того, не указывайте знаки препинания и символы.</span><span class="sxs-lookup"><span data-stu-id="f005d-135">Also, omit any punctuation or symbols.</span></span> <span data-ttu-id="f005d-136">Например, вместо "The \# $1 Пицца!" используйте "число 1 10 доллара пиццы".</span><span class="sxs-lookup"><span data-stu-id="f005d-136">For example, instead of "the \#1 $10 pizza!", use "the number one ten dollar pizza".</span></span> <span data-ttu-id="f005d-137">Включение нерегулярных символов или символов для одной команды может привести к тому, что обработчику речи не удастся скомпилировать грамматику для всех команд.</span><span class="sxs-lookup"><span data-stu-id="f005d-137">Including non-pronounceable characters or symbols for one command may cause the speech engine to fail to compile the grammar for all your commands.</span></span> <span data-ttu-id="f005d-138">Наконец, сделайте свой параметр голоса как можно более отличающимся от других определяемых вами речевых команд.</span><span class="sxs-lookup"><span data-stu-id="f005d-138">Finally, make your voice parameter as distinct as reasonably possible from other voice commands you define.</span></span> <span data-ttu-id="f005d-139">Чем больше сходство между грамматикой голоса для команд, тем выше вероятность того, что обработчик речи выполнит ошибку распознавания.</span><span class="sxs-lookup"><span data-stu-id="f005d-139">The greater the similarity between the voice grammar for commands, the more likely the speech engine will make a recognition error.</span></span> <span data-ttu-id="f005d-140">Можно также использовать оценку достоверности, чтобы лучше отличать две команды, которые могут иметь схожую или подобную грамматику голоса.</span><span class="sxs-lookup"><span data-stu-id="f005d-140">You can also use the confidence scores to better distinguish between two commands that may have similar or similar-sounding voice grammar.</span></span>

<span data-ttu-id="f005d-141">Вы можете включить слова в грамматику в *тексте " \\ произношение текста*", где "текст" — это отображаемый текст, а "произношение" — текст, поясняющий произношение.</span><span class="sxs-lookup"><span data-stu-id="f005d-141">You can include in your grammar words in the form of "*text\\pronunciation*", where "text" is the text displayed and "pronunciation" is text that clarifies the pronunciation.</span></span> <span data-ttu-id="f005d-142">Например, грамматика «первое \\ Начало» будет распознается, когда пользователь говорит «First», но [**командное**](/windows/desktop/lwef/the-command-object) событие возвратит текст « \\ первое имя».</span><span class="sxs-lookup"><span data-stu-id="f005d-142">For example, the grammar, "1st\\first", would be recognized when the user says "first," but the [**Command**](/windows/desktop/lwef/the-command-object) event will return the text, "1st\\first".</span></span> <span data-ttu-id="f005d-143">Можно также использовать IPA (Международный фонетический алфавит), чтобы указать произношение, начинающееся с символа решетки (" \# "), а затем текст, представляющий произношение IPA.</span><span class="sxs-lookup"><span data-stu-id="f005d-143">You can also use IPA (International Phonetic Alphabet) to specify a pronunciation by beginning the pronunciation with a pound-sign character ("\#"), then the text representing the IPA pronunciation.</span></span>

<span data-ttu-id="f005d-144">Для модулей распознавания речи японского языка можно определить грамматику в формате "*Кана \\*", уменьшая альтернативные произношение и увеличивая точность.</span><span class="sxs-lookup"><span data-stu-id="f005d-144">For Japanese speech recognition engines, you can define grammar in the form "*kana\\kanji*," reducing the alternative pronunciations and increasing the accuracy.</span></span> <span data-ttu-id="f005d-145">(Порядок сортировки обратно для обеспечения обратной совместимости.) Это особенно важно для произношения правильных имен в канджи.</span><span class="sxs-lookup"><span data-stu-id="f005d-145">(The ordering is reversed for backward compatibility.) This is particularly important for the pronunciation of proper names in Kanji.</span></span> <span data-ttu-id="f005d-146">Однако можно просто передать "кандзи" без японской азбуки, в этом случае подсистема должна прослушивать все приемлемые произношения для кандзи.</span><span class="sxs-lookup"><span data-stu-id="f005d-146">However, you can just pass in "kanji," without the Kana, in which case the engine should listen for all acceptable pronunciations for the Kanji.</span></span> <span data-ttu-id="f005d-147">Можно также передать только символ Кана.</span><span class="sxs-lookup"><span data-stu-id="f005d-147">You can also pass in just Kana.</span></span>

<span data-ttu-id="f005d-148">Кроме ошибок, использующих символы форматирования при группировании или повторении, Microsoft Agent не будет сообщать об ошибках в грамматике, если только сама система не сообщит об ошибке.</span><span class="sxs-lookup"><span data-stu-id="f005d-148">Except for errors using the grouping or repetition formatting characters, Microsoft Agent will not report errors in your grammar, unless the engine itself reports the error.</span></span> <span data-ttu-id="f005d-149">Если вы передали текст в грамматике, которую модуль не смог скомпилировать, но обработчик не сможет обрабатывать и возвращать ошибку, агент не может сообщить об ошибке.</span><span class="sxs-lookup"><span data-stu-id="f005d-149">If you pass text in your grammar that the engine fails to compile, but the engine does not handle and return as an error, Agent cannot report the error.</span></span> <span data-ttu-id="f005d-150">Поэтому клиентское приложение должно быть аккуратным определением грамматики для свойства [**Voice**](voice-property.md) .</span><span class="sxs-lookup"><span data-stu-id="f005d-150">Therefore, the client application must be careful defining the grammar for the [**Voice**](voice-property.md) property.</span></span>

> [!Note]  
> <span data-ttu-id="f005d-151">Доступные функции грамматики могут зависеть от модуля распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="f005d-151">The grammar features available may depend on the speech recognition engine.</span></span> <span data-ttu-id="f005d-152">Чтобы определить, какие параметры грамматики поддерживаются, вы можете узнать у поставщика подсистемы.</span><span class="sxs-lookup"><span data-stu-id="f005d-152">You may want to check with the engine's vendor to determine what grammar options are supported.</span></span> <span data-ttu-id="f005d-153">Используйте [**срмодеид**](srmodeid-property.md) для использования определенного механизма.</span><span class="sxs-lookup"><span data-stu-id="f005d-153">Use the [**SRModeID**](srmodeid-property.md) to use a specific engine.</span></span>

 

<span data-ttu-id="f005d-154">Работа этого свойства зависит от состояния состояния распознавания речи на сервере Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="f005d-154">The operation of this property depends on the state of Microsoft Agent server's speech recognition state.</span></span> <span data-ttu-id="f005d-155">Например, если распознавание речи отключено или не установлено, эта функция не оказывает немедленного воздействия.</span><span class="sxs-lookup"><span data-stu-id="f005d-155">For example, if speech recognition is disabled or not installed, this function has no immediate effect.</span></span> <span data-ttu-id="f005d-156">Однако если во время сеанса включено распознавание речи, команда будет доступна, когда клиентское приложение найдет на вход.</span><span class="sxs-lookup"><span data-stu-id="f005d-156">If speech recognition is enabled during a session, however, the command will become accessible when its client application is input-active.</span></span>

## <a name="see-also"></a><span data-ttu-id="f005d-157">См. также:</span><span class="sxs-lookup"><span data-stu-id="f005d-157">See Also</span></span>

<span data-ttu-id="f005d-158">[**Иаженткоммандс:: Voice**](iagentcommands--getvoice.md), [**Иаженткоммандс:: сеткаптион**](iagentcommands--setcaption.md), [**иаженткоммандс:: сетвисибле**](iagentcommands--setvisible.md)</span><span class="sxs-lookup"><span data-stu-id="f005d-158">[**IAgentCommands::GetVoice**](iagentcommands--getvoice.md), [**IAgentCommands::SetCaption**](iagentcommands--setcaption.md), [**IAgentCommands::SetVisible**](iagentcommands--setvisible.md)</span></span>


 

 