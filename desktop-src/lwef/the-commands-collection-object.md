---
title: Объект коллекции Commands
description: Объект коллекции Commands
ms.assetid: 8726ce04-77d3-4ae3-bd46-e75f42b36d6f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2367035d86f92d57dc459564943b9e7797ecb04
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104412799"
---
# <a name="the-commands-collection-object"></a><span data-ttu-id="4d2dd-103">Объект коллекции Commands</span><span class="sxs-lookup"><span data-stu-id="4d2dd-103">The Commands Collection Object</span></span>

<span data-ttu-id="4d2dd-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="4d2dd-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="4d2dd-105">Сервер Microsoft Agent поддерживает список команд, доступных пользователю в данный момент.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-105">The Microsoft Agent server maintains a list of commands that are currently available to the user.</span></span> <span data-ttu-id="4d2dd-106">В этот список входят команды, определяемые сервером для общего взаимодействия (например, скрытие и открытие окна "Voice Commands"), список доступных (но не входящих в систему) клиентов и команды, определенные текущим активным клиентом.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-106">This list includes commands that the server defines for general interaction (such as Hide and Open The Voice Commands Window), the list of available (but non-input-active) clients, and the commands defined by the current active client.</span></span> <span data-ttu-id="4d2dd-107">Первые два набора команд являются глобальными командами. Это значит, что они доступны в любое время, независимо от клиента ввода-активности.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-107">The first two sets of commands are global commands; that is, they are available at any time, regardless of the input-active client.</span></span> <span data-ttu-id="4d2dd-108">Определяемые клиентом команды доступны только в том случае, если этот клиент является входным, а сам символ является видимым.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-108">Client-defined commands are available only when that client is input-active and the character is visible.</span></span>

<span data-ttu-id="4d2dd-109">Каждое клиентское приложение может определять коллекцию команд, называемых коллекцией [**Commands**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="4d2dd-109">Each client application can define a collection of commands called the [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="4d2dd-110">Чтобы добавить команду в коллекцию, используйте метод [**Add**](add-method.md) или [**INSERT**](insert-method.md) .</span><span class="sxs-lookup"><span data-stu-id="4d2dd-110">To add a command to the collection, use the [**Add**](add-method.md) or [**Insert**](insert-method.md) method.</span></span> <span data-ttu-id="4d2dd-111">Хотя свойства команды можно указать с помощью отдельных инструкций, для оптимальной производительности кода укажите все свойства команды в инструкции **Add** или **INSERT** .</span><span class="sxs-lookup"><span data-stu-id="4d2dd-111">Although you can specify a command's properties with separate statements, for optimum code performance, specify all of a command's properties in the **Add** or **Insert** method statement.</span></span> <span data-ttu-id="4d2dd-112">Для каждой команды в коллекции можно определить, отображается ли пользовательский доступ к команде во всплывающем меню символа, в окне "голоса" в обоих случаях или в любом из них.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-112">For each command in the collection, you can determine whether user access to the command appears in the character's pop-up menu, in the Voice Commands Window, in both, or in neither.</span></span> <span data-ttu-id="4d2dd-113">Например, если вы хотите, чтобы команда отображалась во всплывающем меню для символа, задайте [**заголовок**](caption-property.md) и [**видимые**](visible-property.md) свойства команды.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-113">For example, if you want a command to appear on the pop-up menu for the character, set the command's [**Caption**](caption-property.md) and [**Visible**](visible-property.md) properties.</span></span> <span data-ttu-id="4d2dd-114">Чтобы отобразить команду в окне "Voice Commands", задайте свойства [**воицекаптион**](voicecaption-property.md) и [**Voice**](voice-property.md) команды.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-114">To display the command in the Voice Commands Window, set the command's [**VoiceCaption**](voicecaption-property.md) and [**Voice**](voice-property.md) properties.</span></span>

<span data-ttu-id="4d2dd-115">Пользователь может получить доступ к отдельным [**командам**](/windows/desktop/lwef/the-commands-collection-object)and в коллекции, только если клиентское приложение является входным.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-115">A user can access the individual comm [**Commands**](/windows/desktop/lwef/the-commands-collection-object)ands in your collection only when your client application is input-active.</span></span> <span data-ttu-id="4d2dd-116">Поэтому при совместном использовании символа с другими клиентскими приложениями, как правило, необходимо задать свойства [**Caption**](caption-property.md), [**воицекаптион**](voicecaption-property.md)и [**Voice**](voice-property.md) для объекта коллекции **Commands** , а также для команд в коллекции.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-116">Therefore, when you may be sharing the character with other client applications you'll typically want to set the [**Caption**](caption-property.md), [**VoiceCaption**](voicecaption-property.md), and [**Voice**](voice-property.md) properties for the **Commands** collection object as well as for the commands in the collection.</span></span> <span data-ttu-id="4d2dd-117">Это помещает запись для коллекции **команд** во всплывающем меню символа и в окне "Voice Commands".</span><span class="sxs-lookup"><span data-stu-id="4d2dd-117">This places an entry for your **Commands** collection in a character's pop-up menu and in the Voice Commands Window.</span></span>

<span data-ttu-id="4d2dd-118">Когда пользователь переключается на клиент, выбрав запись [**команды**](/windows/desktop/lwef/the-commands-collection-object) , сервер автоматически делает ввод клиента активным, уведомляя клиентское приложение с помощью события [**активатеинпут**](activateinput-event.md) и делает команды в коллекции доступными.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-118">When the user switches to your client by choosing its [**Commands**](/windows/desktop/lwef/the-commands-collection-object) entry, the server automatically makes your client input-active, notifying your client application using the [**ActivateInput**](activateinput-event.md) event and makes the commands in its collection available.</span></span> <span data-ttu-id="4d2dd-119">Сервер также уведомляет клиента о том, что он больше не является входным и не является активным с событием [**деактиватеинпут**](deactivateinput-event.md) .</span><span class="sxs-lookup"><span data-stu-id="4d2dd-119">The server also notifies the client that it is no longer input-active with the [**DeActivateInput**](deactivateinput-event.md) event.</span></span> <span data-ttu-id="4d2dd-120">Это позволяет серверу предоставлять и принимать только команды, которые применяются к текущему контексту ввода-активного клиента.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-120">This enables the server to present and accept only the commands that apply to the current input-active client's context.</span></span> <span data-ttu-id="4d2dd-121">Это также позволяет избежать конфликтов имен команд между клиентами.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-121">It also serves to avoid command-name collisions between clients.</span></span>

<span data-ttu-id="4d2dd-122">Клиент также может явным образом запросить, чтобы сделать клиент ввода активным клиентом с помощью метода [**Activate**](activate-method.md) .</span><span class="sxs-lookup"><span data-stu-id="4d2dd-122">A client can also explicitly request to make itself the input-active client using the [**Activate**](activate-method.md) method.</span></span> <span data-ttu-id="4d2dd-123">Этот метод также поддерживает настройку приложения так, чтобы он не был клиентом input-Active.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-123">This method also supports setting your application to not be the input-active client.</span></span> <span data-ttu-id="4d2dd-124">Этот метод можно использовать при совместном использовании символа с другим приложением, настроив приложение в качестве входных данных, если окно приложения получает фокус и не является активным при потере фокуса.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-124">You may want to use this method when you are sharing a character with another application, setting your application to be input-active when your application window gets focus and not input-active when it loses focus.</span></span>

<span data-ttu-id="4d2dd-125">Аналогичным образом можно использовать метод [**Activate**](activate-method.md) , чтобы задать для приложения (или не быть) активный клиент символа.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-125">Similarly, you can use the [**Activate**](activate-method.md) method to set your application to be (or not be) the active client of the character.</span></span> <span data-ttu-id="4d2dd-126">Активный клиент — это клиент, который получает входные данные, когда его символ является самым верхним.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-126">The active client is the client that receives input when its character is the topmost character.</span></span> <span data-ttu-id="4d2dd-127">При изменении этого состояния сервер уведомляет ваше приложение с событием [**активеклиентчанже**](activeclientchange-event.md) .</span><span class="sxs-lookup"><span data-stu-id="4d2dd-127">When this status changes, the server notifies your application with the [**ActiveClientChange**](activeclientchange-event.md) event.</span></span>

<span data-ttu-id="4d2dd-128">При отображении всплывающего меню символа изменения свойств коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) или команд в ее коллекции не отображаются, пока пользователь не отобразит меню.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-128">When a character's pop-up menu displays, changes to the properties of a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection or the commands in its collection do not appear until the user redisplays the menu.</span></span> <span data-ttu-id="4d2dd-129">Однако окно команд отображает изменения по мере их возникновения.</span><span class="sxs-lookup"><span data-stu-id="4d2dd-129">However, the Commands Window does display changes as they happen.</span></span>

-   [<span data-ttu-id="4d2dd-130">Методы объекта Commands</span><span class="sxs-lookup"><span data-stu-id="4d2dd-130">Commands Object Methods</span></span>](commands-object-methods.md)
-   [<span data-ttu-id="4d2dd-131">Свойства объекта Commands</span><span class="sxs-lookup"><span data-stu-id="4d2dd-131">Commands Object Properties</span></span>](commands-object-properties.md)

 

 