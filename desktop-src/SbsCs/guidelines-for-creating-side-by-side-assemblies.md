---
description: Следующие рекомендации описывают, как создавать собственные параллельные сборки COM или Win32.
ms.assetid: e10fe92c-bce8-420e-a84c-2748e929eb1b
title: Рекомендации по созданию параллельных сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af8e8fd2bd31a65477b44d3afcf2156d5160a72a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144521"
---
# <a name="guidelines-for-creating-side-by-side-assemblies"></a><span data-ttu-id="fc54b-103">Рекомендации по созданию параллельных сборок</span><span class="sxs-lookup"><span data-stu-id="fc54b-103">Guidelines for Creating Side-by-side Assemblies</span></span>

<span data-ttu-id="fc54b-104">Следующие рекомендации описывают, как создавать собственные параллельные сборки COM или Win32.</span><span class="sxs-lookup"><span data-stu-id="fc54b-104">The following guidelines discuss how to author your own COM or Win32 side-by-side assemblies.</span></span> <span data-ttu-id="fc54b-105">Если необходимая функциональность предоставляется одной из [поддерживаемых параллельных сборок Майкрософт](supported-microsoft-side-by-side-assemblies.md), вам может не потребоваться создавать собственные параллельные сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-105">You may not need to create your own side-by-side assemblies if the functionality needed is provided by one of the [supported Microsoft side-by-side assemblies](supported-microsoft-side-by-side-assemblies.md).</span></span> <span data-ttu-id="fc54b-106">В этом случае используйте сборки, предоставляемые корпорацией Майкрософт, и выполните процедуры по использованию параллельных сборок в [с помощью изолированных приложений и параллельных сборок](using-isolated-applications-and-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="fc54b-106">In this case, use the assemblies provided by Microsoft and follow the procedures for using side-by-side assemblies in [Using Isolated Applications and Side-by-side Assemblies](using-isolated-applications-and-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="fc54b-107">Во-первых, определите, является ли ваш компонент подходящим кандидатом для параллельной сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-107">First, consider whether your component makes a suitable candidate for a side-by-side assembly.</span></span> <span data-ttu-id="fc54b-108">Дополнительные сведения см [. в разделе следует ли предоставлять общий компонент в качестве параллельной сборки?](should-you-provide-a-shared-component-as-a-side-by-side-assembly.md)</span><span class="sxs-lookup"><span data-stu-id="fc54b-108">For more information, see [Should you provide a shared component as a side-by-side assembly?](should-you-provide-a-shared-component-as-a-side-by-side-assembly.md)</span></span>

<span data-ttu-id="fc54b-109">Чтобы создать параллельную сборку, следуйте приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="fc54b-109">To create a side-by-side assembly, follow these guidelines:</span></span>

-   <span data-ttu-id="fc54b-110">Решите, какие ресурсы включать в сборку.</span><span class="sxs-lookup"><span data-stu-id="fc54b-110">Decide which resources to include in the assembly.</span></span> <span data-ttu-id="fc54b-111">Помните, что сборка состоит из одного или нескольких файлов, которые всегда предоставляются приложениям и клиентам вместе.</span><span class="sxs-lookup"><span data-stu-id="fc54b-111">Keep in mind that an assembly consists of one or more files that are always provided to applications and customers together.</span></span> <span data-ttu-id="fc54b-112">Эта сборка выступает в качестве основной единицы, используемой для именования, привязки, управления версиями, развертывания и [конфигурации по умолчанию](default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="fc54b-112">The assembly serves as the fundamental unit used for naming, binding, versioning, deployment, and [default configuration](default-configuration.md).</span></span> <span data-ttu-id="fc54b-113">Как правило, если не определено, входят ли два ресурса в одну сборку, рекомендуется создать их для перехода в отдельные сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-113">As a general rule, when uncertain about whether two resources belong in the same assembly, it is recommended that they be authored to go into separate assemblies.</span></span> <span data-ttu-id="fc54b-114">Как правило, параллельная сборка состоит из одной библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="fc54b-114">Typically, a side-by-side assembly consists of a single DLL.</span></span>
-   <span data-ttu-id="fc54b-115">Создайте [Манифест](manifests.md) сборки для сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-115">Create an assembly [manifest](manifests.md) for the assembly.</span></span> <span data-ttu-id="fc54b-116">Манифест должен описывать COM-объект или библиотеки типов в сборке.</span><span class="sxs-lookup"><span data-stu-id="fc54b-116">The manifest should describe the COM object or type libraries in the assembly.</span></span> <span data-ttu-id="fc54b-117">Дополнительные сведения о том, что следует создать в манифесте сборки, см. в разделе [Манифесты сборки](assembly-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="fc54b-117">For more information about what should be authored into an assembly manifest, see [assembly manifests](assembly-manifests.md).</span></span>
-   <span data-ttu-id="fc54b-118">Оцените использование объектов, когда в системе выполняется несколько версий сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-118">Evaluate the usage of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="fc54b-119">Определите, требуются ли для разных версий сборки отдельные структуры данных, такие как размещенные в памяти файлы, именованные каналы, зарегистрированные сообщения Windows и классы, Общая память, семафоры, мьютексы и драйверы оборудования.</span><span class="sxs-lookup"><span data-stu-id="fc54b-119">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="fc54b-120">Все структуры данных, используемые в версиях сборок, должны быть обратно совместимыми версиями.</span><span class="sxs-lookup"><span data-stu-id="fc54b-120">Any data structures used across assembly versions must be backward-compatible versions.</span></span> <span data-ttu-id="fc54b-121">Решите, какие структуры данных можно использовать в разных версиях и какие структуры данных должны быть частными для версии.</span><span class="sxs-lookup"><span data-stu-id="fc54b-121">Decide which data structures can be used across versions and which data structures must be private to a version.</span></span> <span data-ttu-id="fc54b-122">Определите, требуются ли для общих структур данных отдельные объекты синхронизации, такие как семафоры и мьютексы.</span><span class="sxs-lookup"><span data-stu-id="fc54b-122">Determine whether shared data structures require separate synchronization objects such as semaphores and mutexes.</span></span>
-   <span data-ttu-id="fc54b-123">Создайте библиотеку DLL, которая будет работать как параллельная сборка, придерживаясь рекомендаций по [созданию библиотеки DLL для параллельной сборки](authoring-a-dll-for-a-side-by-side-assembly.md).</span><span class="sxs-lookup"><span data-stu-id="fc54b-123">Author your DLL to work well as a side-by-side assembly by adhering to the guidelines in [Authoring a DLL for a Side-by-Side Assembly](authoring-a-dll-for-a-side-by-side-assembly.md).</span></span>
-   <span data-ttu-id="fc54b-124">Создайте набор файлов заголовков и вспомогательных функций, чтобы обеспечить простой способ создания разделов реестра, содержащих состояние сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-124">Author a set of header files and helper functions to provide an easy way to version registry keys containing the assembly state.</span></span> <span data-ttu-id="fc54b-125">Сборки обычно сохраняют свои параметры состояния в разделах реестра.</span><span class="sxs-lookup"><span data-stu-id="fc54b-125">Assemblies commonly save their state settings in registry keys.</span></span> <span data-ttu-id="fc54b-126">Параметры реестра должны быть записаны на отдельной версии, чтобы изолировать несколько версий сборки, которые могут выполняться одновременно.</span><span class="sxs-lookup"><span data-stu-id="fc54b-126">Registry settings must be written on an individual version basis to isolate multiple assembly versions that may be run at the same time.</span></span> <span data-ttu-id="fc54b-127">Разработка параллельной сборки и библиотеки DLL для правильного хранения и обработки состояния сборки во время параллельного предоставления общего доступа.</span><span class="sxs-lookup"><span data-stu-id="fc54b-127">Design your side-by-side assembly and DLL to correctly store and handle the state of the assembly during side-by-side sharing scenarios.</span></span> <span data-ttu-id="fc54b-128">Следуйте рекомендациям по [созданию хранилища состояний для параллельных сборок](authoring-state-storage-for-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="fc54b-128">Follow the guidelines in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>
-   <span data-ttu-id="fc54b-129">Разработчики приложений, использующих [закрытые сборки](/windows/desktop/Msi/private-assemblies) , должны защищать каталог приложения.</span><span class="sxs-lookup"><span data-stu-id="fc54b-129">Developers of applications that use [private assemblies](/windows/desktop/Msi/private-assemblies) should secure the application directory.</span></span> <span data-ttu-id="fc54b-130">Если приложение установлено с помощью [установщик Windows](../msi/windows-installer-portal.md), то каталог приложения можно защитить с помощью таблицы локкпермиссионс.</span><span class="sxs-lookup"><span data-stu-id="fc54b-130">If the application is installed using the [Windows Installer](../msi/windows-installer-portal.md), then the application directory can be secured by using the LockPermissions table.</span></span> <span data-ttu-id="fc54b-131">Как правило, системе предоставляется доступ на чтение, запись и выполнение для закрытых сборок; все остальные процессы получают доступ только для выполнения и чтения.</span><span class="sxs-lookup"><span data-stu-id="fc54b-131">Typically, the system is given read, write, and execute access to private assemblies; all other processes are given only execute and read access.</span></span>
-   <span data-ttu-id="fc54b-132">Протестируйте сборку с помощью сценариев с параллельным предоставлением общего доступа, чтобы убедиться, что это допустимая параллельная сборка.</span><span class="sxs-lookup"><span data-stu-id="fc54b-132">Test the assembly using scenarios with side-by-side sharing to ensure that it is a valid side-by-side assembly.</span></span> <span data-ttu-id="fc54b-133">Для успешной установки сборки недостаточно, чтобы гарантировать, что она будет работать должным образом.</span><span class="sxs-lookup"><span data-stu-id="fc54b-133">Successful installation of the assembly is not sufficient to guarantee that it will work as expected.</span></span>
-   <span data-ttu-id="fc54b-134">Применяйте метод для нумерации обновлений для сборки.</span><span class="sxs-lookup"><span data-stu-id="fc54b-134">Adopt a method for numbering updates for your assembly.</span></span> <span data-ttu-id="fc54b-135">Каждая сборка связана с номером версии, сопоставленным с четырьмя частями.</span><span class="sxs-lookup"><span data-stu-id="fc54b-135">Each assembly is associated with a four-part version number.</span></span> <span data-ttu-id="fc54b-136">Слева направо основной, дополнительный, номер сборки и номер редакции разделены точками.</span><span class="sxs-lookup"><span data-stu-id="fc54b-136">Left-to-right, the major, minor, build, and revision parts are separated by periods.</span></span> <span data-ttu-id="fc54b-137">Измените основной или дополнительный номер сборки для версии, которая несовместима с предыдущими версиями.</span><span class="sxs-lookup"><span data-stu-id="fc54b-137">Change the major or minor number of an assembly for a version that is incompatible with earlier versions.</span></span> <span data-ttu-id="fc54b-138">Изменение только частей сборки и редакции для обратно совместимых изменений в сборке.</span><span class="sxs-lookup"><span data-stu-id="fc54b-138">Change only the build and revision parts for backward-compatible changes to the assembly.</span></span> <span data-ttu-id="fc54b-139">Например, разработчик может применять метод нумерации, в котором все 1.0.0. \* Номера версий относятся к версиям обновления для сборки 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="fc54b-139">For example, a developer might adopt a numbering method in which all 1.0.0.\* version numbers refer to update versions to assembly version 1.0.0.0.</span></span>

 

 
