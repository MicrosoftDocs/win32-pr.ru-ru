---
description: Перенаправление библиотек DLL/COM — это стратегия изоляции приложений, применяемая корпоративными администраторами в Windows XP.
ms.assetid: 5bbb0bee-d457-4dfa-93a0-82537fe11f2d
title: Перенаправление библиотек DLL/COM в Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e356c7b4cc6e5616a03eba60439c7478d65e626a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911887"
---
# <a name="dllcom-redirection-on-windows"></a><span data-ttu-id="2af61-103">Перенаправление библиотек DLL/COM в Windows</span><span class="sxs-lookup"><span data-stu-id="2af61-103">DLL/COM Redirection on Windows</span></span>

<span data-ttu-id="2af61-104">Перенаправление библиотек DLL/COM — это стратегия изоляции приложений, применяемая корпоративными администраторами в Windows XP.</span><span class="sxs-lookup"><span data-stu-id="2af61-104">DLL/COM redirection is an application isolation strategy employed by corporate administrators on Windows XP.</span></span>

<span data-ttu-id="2af61-105">\* \* Windows Server 2008, Windows Vista, Windows Server 2003 и Windows XP с пакетом обновления 2 (SP2): \* \* использование стратегий перенаправления библиотек DLL и COM не рекомендуется, так как изолированные приложения, использующие манифесты и [Параллельные сборки](about-side-by-side-assemblies-.md) , могут быть проще в обновлении и обслуживании.</span><span class="sxs-lookup"><span data-stu-id="2af61-105">\*\*Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP with SP2:  \*\* The use of DLL/COM redirection strategies is not recommended because isolated applications that use manifests and [side-by-side assemblies](about-side-by-side-assemblies-.md) can be easier to update and service.</span></span> <span data-ttu-id="2af61-106">Наличие локального файла пропускается, если манифест присутствует.</span><span class="sxs-lookup"><span data-stu-id="2af61-106">The presence of a .local file is ignored if a manifest is present.</span></span> <span data-ttu-id="2af61-107">Стратегия перенаправления библиотек DLL/COM, использующая локальные файлы, работает, если приложение не имеет манифеста.</span><span class="sxs-lookup"><span data-stu-id="2af61-107">The DLL/COM Redirection strategy using .local files works if the application does not have a manifest.</span></span>

<span data-ttu-id="2af61-108">Перенаправление библиотек DLL/COM привязывает приложение к локальной версии компонента.</span><span class="sxs-lookup"><span data-stu-id="2af61-108">DLL/COM redirection binds an application to a local version of a component.</span></span> <span data-ttu-id="2af61-109">Файлы локального компонента могут храниться отдельно от версии системы компонента в расположении, которое является частным для приложения.</span><span class="sxs-lookup"><span data-stu-id="2af61-109">The local component's files can be kept separate from the system's version of the component in a location that is private to the application.</span></span> <span data-ttu-id="2af61-110">Системная версия компонента глобально зарегистрирована и доступна для любых других приложений, привязанных к нему.</span><span class="sxs-lookup"><span data-stu-id="2af61-110">The system's version of the component is globally registered and available to any other applications that bind to it.</span></span> <span data-ttu-id="2af61-111">Локальная версия компонента зарезервирована для монопольного использования приложения.</span><span class="sxs-lookup"><span data-stu-id="2af61-111">The local version of the component is reserved for the exclusive use of the application.</span></span> <span data-ttu-id="2af61-112">При необходимости файлы компонентов, используемые приложением, могут быть загружены в память в то же время, что и файлы компонентов системы.</span><span class="sxs-lookup"><span data-stu-id="2af61-112">If necessary, the component files used by the application can be loaded into memory at the same time as the system's component files.</span></span>

<span data-ttu-id="2af61-113">Перенаправление DLL/COM активируется путем установки специального файла вместе с копией файла локального компонента в тот же каталог, что и исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="2af61-113">DLL/COM redirection is activated by installing a special file along with a copy of the local component file into the same directory as the application's executable file.</span></span> <span data-ttu-id="2af61-114">Специальный файл представляет собой пустой файл, имя которого после имени исполняемого файла приложения и добавляется к. local.</span><span class="sxs-lookup"><span data-stu-id="2af61-114">The special file is an empty file named after the application executable's file name and appended with .local.</span></span> <span data-ttu-id="2af61-115">Например, чтобы активировать перенаправление библиотеки DLL или COM для приложения с именем MyApp, локальная версия компонента и пустой файл с именем Myapp.exe. local должны быть скопированы в папку, содержащую Myapp.exe.</span><span class="sxs-lookup"><span data-stu-id="2af61-115">For example, to activate DLL/COM redirection for an application named Myapp, the local version of the component and an empty file named Myapp.exe.local must be copied into the folder containing Myapp.exe.</span></span> <span data-ttu-id="2af61-116">Это привязывает приложение к локальной версии компонента, а не глобально общей версии компонента.</span><span class="sxs-lookup"><span data-stu-id="2af61-116">This binds the application to the local version of the component rather than the globally shared version of the component.</span></span>

<span data-ttu-id="2af61-117">Когда приложение загружает файл компонента, например DLL или OCX-файл, Windows сначала ищет его в папке, в которой установлен локальный и исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="2af61-117">When an application loads a component file, such as a DLL or .ocx file, Windows first searches for it in the folder where the application's .local and executable file is installed.</span></span> <span data-ttu-id="2af61-118">При обнаружении приложение использует этот файл компонента независимо от любого пути поиска в каталоге, определенного в приложении или реестре.</span><span class="sxs-lookup"><span data-stu-id="2af61-118">If found, the application uses that component file regardless of any directory search path defined in the application or the registry.</span></span> <span data-ttu-id="2af61-119">Если объект не найден, используется файл компонента в указанном пути поиска.</span><span class="sxs-lookup"><span data-stu-id="2af61-119">If not found, the component file in the defined search path is used.</span></span>

<span data-ttu-id="2af61-120">Программа установки должна выполнить следующие действия, чтобы установить приложение с перенаправлением библиотек DLL или COM:</span><span class="sxs-lookup"><span data-stu-id="2af61-120">The installation utility must do the following to install the application with DLL/COM redirection:</span></span>

-   <span data-ttu-id="2af61-121">Пустой локальный файл должен быть скопирован в ту же папку, что и исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="2af61-121">An empty .local file must be copied into the same folder as the application's executable file.</span></span>
-   <span data-ttu-id="2af61-122">Все файлы компонентов, DLL и OCX, используемые приложением, должны быть скопированы в ту же папку, что и исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="2af61-122">All of the components, DLL, and .ocx files used by the application must be copied into the same folder as the application's executable file.</span></span>
-   <span data-ttu-id="2af61-123">Изолированные COM-компоненты должны быть зарегистрированы в Windows, чтобы разные версии сборки не конфликтовали друг с другом при загрузке в память в то же время.</span><span class="sxs-lookup"><span data-stu-id="2af61-123">Isolated COM components must be registered with Windows so that different versions of the assembly will not conflict with each other when loaded into memory at the same time.</span></span> <span data-ttu-id="2af61-124">Процесс регистрации требует, что хотя реализация компонента может меняться между версиями, определенные метаданные COM, такие как CLSID, ProgID, Библиотека типов и модель потоков, не могут.</span><span class="sxs-lookup"><span data-stu-id="2af61-124">The registration process requires that, while the implementation of the component can change between versions, certain COM metadata such as CLSID, ProgID, Type Library, and Threading Model cannot.</span></span>
-   <span data-ttu-id="2af61-125">Если приложение установлено с помощью установщик Windows, то каталог приложения можно защитить с помощью таблицы Локкпермиссионс.</span><span class="sxs-lookup"><span data-stu-id="2af61-125">If the application is installed using the Windows Installer, then the application directory can be secured by using the LockPermissions table.</span></span> <span data-ttu-id="2af61-126">Как правило, системе предоставляется доступ для чтения, записи и выполнения; все остальные процессы получают доступ только для выполнения и чтения.</span><span class="sxs-lookup"><span data-stu-id="2af61-126">Typically, the system is given read, write, and execute access; all other processes are given only execute and read access.</span></span>

 

 



