---
description: Перенаправление библиотек DLL/COM — это стратегия изоляции приложений, применяемая корпоративными администраторами в Windows XP.
ms.assetid: 5bbb0bee-d457-4dfa-93a0-82537fe11f2d
title: Перенаправление библиотек DLL/COM в Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e356c7b4cc6e5616a03eba60439c7478d65e626a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911887"
---
# <a name="dllcom-redirection-on-windows"></a>Перенаправление библиотек DLL/COM в Windows

Перенаправление библиотек DLL/COM — это стратегия изоляции приложений, применяемая корпоративными администраторами в Windows XP.

* * Windows Server 2008, Windows Vista, Windows Server 2003 и Windows XP с пакетом обновления 2 (SP2): * * использование стратегий перенаправления библиотек DLL и COM не рекомендуется, так как изолированные приложения, использующие манифесты и [Параллельные сборки](about-side-by-side-assemblies-.md) , могут быть проще в обновлении и обслуживании. Наличие локального файла пропускается, если манифест присутствует. Стратегия перенаправления библиотек DLL/COM, использующая локальные файлы, работает, если приложение не имеет манифеста.

Перенаправление библиотек DLL/COM привязывает приложение к локальной версии компонента. Файлы локального компонента могут храниться отдельно от версии системы компонента в расположении, которое является частным для приложения. Системная версия компонента глобально зарегистрирована и доступна для любых других приложений, привязанных к нему. Локальная версия компонента зарезервирована для монопольного использования приложения. При необходимости файлы компонентов, используемые приложением, могут быть загружены в память в то же время, что и файлы компонентов системы.

Перенаправление DLL/COM активируется путем установки специального файла вместе с копией файла локального компонента в тот же каталог, что и исполняемый файл приложения. Специальный файл представляет собой пустой файл, имя которого после имени исполняемого файла приложения и добавляется к. local. Например, чтобы активировать перенаправление библиотеки DLL или COM для приложения с именем MyApp, локальная версия компонента и пустой файл с именем Myapp.exe. local должны быть скопированы в папку, содержащую Myapp.exe. Это привязывает приложение к локальной версии компонента, а не глобально общей версии компонента.

Когда приложение загружает файл компонента, например DLL или OCX-файл, Windows сначала ищет его в папке, в которой установлен локальный и исполняемый файл приложения. При обнаружении приложение использует этот файл компонента независимо от любого пути поиска в каталоге, определенного в приложении или реестре. Если объект не найден, используется файл компонента в указанном пути поиска.

Программа установки должна выполнить следующие действия, чтобы установить приложение с перенаправлением библиотек DLL или COM:

-   Пустой локальный файл должен быть скопирован в ту же папку, что и исполняемый файл приложения.
-   Все файлы компонентов, DLL и OCX, используемые приложением, должны быть скопированы в ту же папку, что и исполняемый файл приложения.
-   Изолированные COM-компоненты должны быть зарегистрированы в Windows, чтобы разные версии сборки не конфликтовали друг с другом при загрузке в память в то же время. Процесс регистрации требует, что хотя реализация компонента может меняться между версиями, определенные метаданные COM, такие как CLSID, ProgID, Библиотека типов и модель потоков, не могут.
-   Если приложение установлено с помощью установщик Windows, то каталог приложения можно защитить с помощью таблицы Локкпермиссионс. Как правило, системе предоставляется доступ для чтения, записи и выполнения; все остальные процессы получают доступ только для выполнения и чтения.

 

 



