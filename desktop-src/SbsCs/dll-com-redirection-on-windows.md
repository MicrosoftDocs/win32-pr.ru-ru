---
description: перенаправление библиотек DLL/COM — это стратегия изоляции приложений, применяемая корпоративными администраторами в Windows XP.
ms.assetid: 5bbb0bee-d457-4dfa-93a0-82537fe11f2d
title: Перенаправление DLL/COM на Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ce6b55c2a66d298b7b80248613eab7cefe96c25f8f53dd9218966e235ea267f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119142267"
---
# <a name="dllcom-redirection-on-windows"></a>Перенаправление DLL/COM на Windows

перенаправление библиотек DLL/COM — это стратегия изоляции приложений, применяемая корпоративными администраторами в Windows XP.

* * Windows server 2008, Windows Vista, Windows server 2003 и Windows XP с пакетом обновления 2 (SP2): * * использование стратегий перенаправления библиотек DLL и COM не рекомендуется, так как изолированные приложения, использующие манифесты и [параллельные сборки](about-side-by-side-assemblies-.md) , могут быть проще в обновлении и обслуживании. Наличие локального файла пропускается, если манифест присутствует. Стратегия перенаправления библиотек DLL/COM, использующая локальные файлы, работает, если приложение не имеет манифеста.

Перенаправление библиотек DLL/COM привязывает приложение к локальной версии компонента. Файлы локального компонента могут храниться отдельно от версии системы компонента в расположении, которое является частным для приложения. Системная версия компонента глобально зарегистрирована и доступна для любых других приложений, привязанных к нему. Локальная версия компонента зарезервирована для монопольного использования приложения. При необходимости файлы компонентов, используемые приложением, могут быть загружены в память в то же время, что и файлы компонентов системы.

Перенаправление DLL/COM активируется путем установки специального файла вместе с копией файла локального компонента в тот же каталог, что и исполняемый файл приложения. Специальный файл представляет собой пустой файл, имя которого после имени исполняемого файла приложения и добавляется к. local. Например, чтобы активировать перенаправление библиотеки DLL или COM для приложения с именем MyApp, локальная версия компонента и пустой файл с именем Myapp.exe. local должны быть скопированы в папку, содержащую Myapp.exe. Это привязывает приложение к локальной версии компонента, а не глобально общей версии компонента.

когда приложение загружает файл компонента, например DLL или ocx-файл, Windows сначала ищет его в папке, в которой установлен локальный и исполняемый файл приложения. При обнаружении приложение использует этот файл компонента независимо от любого пути поиска в каталоге, определенного в приложении или реестре. Если объект не найден, используется файл компонента в указанном пути поиска.

Программа установки должна выполнить следующие действия, чтобы установить приложение с перенаправлением библиотек DLL или COM:

-   Пустой локальный файл должен быть скопирован в ту же папку, что и исполняемый файл приложения.
-   Все файлы компонентов, DLL и OCX, используемые приложением, должны быть скопированы в ту же папку, что и исполняемый файл приложения.
-   изолированные COM-компоненты должны быть зарегистрированы в Windows, чтобы разные версии сборки не конфликтовали друг с другом при загрузке в память в то же время. Процесс регистрации требует, что хотя реализация компонента может меняться между версиями, определенные метаданные COM, такие как CLSID, ProgID, Библиотека типов и модель потоков, не могут.
-   если приложение установлено с помощью установщик Windows, то каталог приложения можно защитить с помощью таблицы локкпермиссионс. Как правило, системе предоставляется доступ для чтения, записи и выполнения; все остальные процессы получают доступ только для выполнения и чтения.

 

 



