---
description: Поиск файлов сборки
ms.assetid: 6e6c1104-5cde-4c07-9ee2-d87062675dac
title: Поиск файлов сборки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b55614278d58913c8fb92371e302ffd71fd28b48b7828351d8ce6b37ae0eddc
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119884874"
---
# <a name="searching-for-assembly-files"></a>Поиск файлов сборки

Контексты активации могут помочь загрузчику найти файлы сборки. Когда загрузчик ищет файл для загрузки по имени, он сначала выполняет поиск файлов с указанным именем, на которые ссылаются сборки, являющиеся членами текущего активного контекста активации. Вызов [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) также сначала находит эти файлы. Файлы с указанным именем и текущим контекстом активации обнаруживаются и загружаются перед файлами с именем в локальном каталоге или переменной среды PATH. Это означает, что при создании манифестов необходимо перечислить все файлы, которые планируется использовать с помощью **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)или статических импортов.

Обратите внимание, что эти файлы не размещаются автоматически при использовании функции [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) или других функций, которые не выполняют поиск файлов. Чтобы использовать эти файлы с помощью **CreateFile**, сначала используйте [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) , чтобы найти путь к изолированному файлу, а затем используйте **CreateFile** в возвращенном пути.

Этот метод поиска файлов помогает отделять изолированные приложения друг от друга, так как несколько файлов с одним и тем же именем могут отличаться только их связью с сборками с разными номерами версий. Операционная система может найти правильный файл для использования во время операций с файлами.

Если библиотека DLL загружается таким образом с помощью [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), то точка входа этой библиотеки DLL (DllMain) вызывается, пока исходный контекст активации остается активным, за исключением случаев, когда сама библиотека DLL содержит манифест по ОПРЕДЕЛЕННОму идентификатору ресурса ( \_ идентификатор ресурса манифеста исолатионаваре \_ \_ или 2).

 

 
