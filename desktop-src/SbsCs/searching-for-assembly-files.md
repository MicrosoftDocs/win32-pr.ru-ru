---
description: Поиск файлов сборки
ms.assetid: 6e6c1104-5cde-4c07-9ee2-d87062675dac
title: Поиск файлов сборки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d7be73b162ea41fd9eeb0a042a1fc2e202b8115
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272055"
---
# <a name="searching-for-assembly-files"></a><span data-ttu-id="7c6b8-103">Поиск файлов сборки</span><span class="sxs-lookup"><span data-stu-id="7c6b8-103">Searching for Assembly Files</span></span>

<span data-ttu-id="7c6b8-104">Контексты активации могут помочь загрузчику найти файлы сборки.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-104">Activation contexts can help the loader find assembly files.</span></span> <span data-ttu-id="7c6b8-105">Когда загрузчик ищет файл для загрузки по имени, он сначала выполняет поиск файлов с указанным именем, на которые ссылаются сборки, являющиеся членами текущего активного контекста активации.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-105">When the loader searches for a file to load by name, it first searches for files with the specified name that are referenced by assemblies that are members of the currently active activation context.</span></span> <span data-ttu-id="7c6b8-106">Вызов [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) также сначала находит эти файлы.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-106">A call to [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) also locates these files first.</span></span> <span data-ttu-id="7c6b8-107">Файлы с указанным именем и текущим контекстом активации обнаруживаются и загружаются перед файлами с именем в локальном каталоге или переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-107">Files having the specified name and the current activation context are found and loaded before files with the name in the local directory or in the PATH environment variable.</span></span> <span data-ttu-id="7c6b8-108">Это означает, что при создании манифестов необходимо перечислить все файлы, которые планируется использовать с помощью **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)или статических импортов.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-108">This means that when you create manifests you need to list all files you plan to use with **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), or static imports.</span></span>

<span data-ttu-id="7c6b8-109">Обратите внимание, что эти файлы не размещаются автоматически при использовании функции [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) или других функций, которые не выполняют поиск файлов.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-109">Note that these files are not automatically located when using [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or other functions that do not search for files.</span></span> <span data-ttu-id="7c6b8-110">Чтобы использовать эти файлы с помощью **CreateFile**, сначала используйте [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) , чтобы найти путь к изолированному файлу, а затем используйте **CreateFile** в возвращенном пути.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-110">To use these files with **CreateFile**, use [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) first to find the path to the isolated file, and then use **CreateFile** on the returned path.</span></span>

<span data-ttu-id="7c6b8-111">Этот метод поиска файлов помогает отделять изолированные приложения друг от друга, так как несколько файлов с одним и тем же именем могут отличаться только их связью с сборками с разными номерами версий.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-111">This method of file searching helps to keep isolated applications separate because multiple files with the same name can then differ only by their association with assemblies of different version numbers.</span></span> <span data-ttu-id="7c6b8-112">Операционная система может найти правильный файл для использования во время операций с файлами.</span><span class="sxs-lookup"><span data-stu-id="7c6b8-112">The operating system can find the correct file to use during file operations.</span></span>

<span data-ttu-id="7c6b8-113">Если библиотека DLL загружается таким образом с помощью [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), то точка входа этой библиотеки DLL (DllMain) вызывается, пока исходный контекст активации остается активным, за исключением случаев, когда сама библиотека DLL содержит манифест по ОПРЕДЕЛЕННОму идентификатору ресурса ( \_ идентификатор ресурса манифеста исолатионаваре \_ \_ или 2).</span><span class="sxs-lookup"><span data-stu-id="7c6b8-113">If a DLL is loaded in this manner using [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), that DLL's entry point (DllMain) is called while the original activation context is kept active, except if the DLL itself contains a manifest at a certain resource ID (ISOLATIONAWARE\_MANIFEST\_RESOURCE\_ID, or 2)</span></span>

 

 
