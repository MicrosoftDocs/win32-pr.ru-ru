---
description: Указание контекста активации по умолчанию
ms.assetid: 4d9a8552-7098-458d-a592-45524871cce5
title: Указание контекста активации по умолчанию
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 32cf0225a8e4290a09f7e6524a4b3ef47f9c4c4e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103999310"
---
# <a name="specifying-a-default-activation-context"></a><span data-ttu-id="7d25b-103">Указание контекста активации по умолчанию</span><span class="sxs-lookup"><span data-stu-id="7d25b-103">Specifying a Default Activation Context</span></span>

<span data-ttu-id="7d25b-104">Когда приложение или компонент создает новый процесс, Windows выполняет поиск манифеста приложения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="7d25b-104">When your application or component creates a new process, Windows searches for a default application manifest.</span></span> <span data-ttu-id="7d25b-105">Обратите внимание, что манифест, входящий в состав приложения в качестве ресурса, имеет приоритет над внешним манифестом.</span><span class="sxs-lookup"><span data-stu-id="7d25b-105">Note that a manifest included as a resource in the application takes precedence over an external manifest.</span></span> <span data-ttu-id="7d25b-106">Контекст активации по умолчанию — это первый контекст активации, который активен до активации любого другого контекста активации.</span><span class="sxs-lookup"><span data-stu-id="7d25b-106">The default activation context is the first activation context that is active before any other activation context has been activated.</span></span> <span data-ttu-id="7d25b-107">Этот контекст активации всегда активен, если не активировать другие контексты.</span><span class="sxs-lookup"><span data-stu-id="7d25b-107">This activation context is always active unless you activate other contexts.</span></span> <span data-ttu-id="7d25b-108">Если \_ \_ во время компиляции приложения или компонента вы определили поддержку режима изоляции, то такие вызовы, как [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)и [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) , могут выполнять автоматическое управление контекстом.</span><span class="sxs-lookup"><span data-stu-id="7d25b-108">If you define ISOLATION\_AWARE\_ENABLED when you compile your application or component, calls like [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), and [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) can perform automatic context management.</span></span>

<span data-ttu-id="7d25b-109">Загрузчик позволяет приложению указать контекст активации по умолчанию двумя методами.</span><span class="sxs-lookup"><span data-stu-id="7d25b-109">The loader allows an application to specify its default activation context by two methods.</span></span> <span data-ttu-id="7d25b-110">Файл манифеста можно разместить в ресурсах исполняемого файла, и загрузчик обнаружит его.</span><span class="sxs-lookup"><span data-stu-id="7d25b-110">You can put the manifest file in the resources of the executable and the loader will find it.</span></span> <span data-ttu-id="7d25b-111">Это аналогично размещению файла манифеста в таблице ресурсов исполняемого объекта.</span><span class="sxs-lookup"><span data-stu-id="7d25b-111">This is the same as putting the manifest file in the executable's resource table.</span></span> <span data-ttu-id="7d25b-112">Манифест можно поместить в файл *MyApp*. exe. Манифест находится в том же каталоге, что и *MyApp*. exe, и загрузчик находит его при поиске файла *MyApp*. exe.</span><span class="sxs-lookup"><span data-stu-id="7d25b-112">You can place the manifest in a file named *Myapp*.exe.Manifest in the same directory as *Myapp*.exe, and the loader finds it while looking for *Myapp*.exe.</span></span>

<span data-ttu-id="7d25b-113">Если ни один из этих методов не используется, приложение запускается с системным контекстом активации по умолчанию, который содержит минимальный набор сборок.</span><span class="sxs-lookup"><span data-stu-id="7d25b-113">If you use none of these methods, the application starts with the system default activation context, which contains a minimal set of assemblies.</span></span>

<span data-ttu-id="7d25b-114">Лучший способ использования автоматического управления контекстом — это компиляция приложения с \_ \_ включенной поддержкой режима изоляции.</span><span class="sxs-lookup"><span data-stu-id="7d25b-114">A better way of using automatic context management is by compiling your application with ISOLATION\_AWARE\_ENABLED defined.</span></span> <span data-ttu-id="7d25b-115">Рекомендуется задать это значение в командной строке компилятора для всего создаваемого проекта, а не задавать в отдельных исходных файлах или заголовках.</span><span class="sxs-lookup"><span data-stu-id="7d25b-115">The recommended method is to set this on the compiler's command line for the entire project being built rather than being set in individual source files or headers.</span></span> <span data-ttu-id="7d25b-116">Это делает большинство интерфейсов API Win32 осведомленными о контекстах активации и способах управления ими.</span><span class="sxs-lookup"><span data-stu-id="7d25b-116">This makes most Win32 APIs aware of activation contexts and how to manage them.</span></span> <span data-ttu-id="7d25b-117">Вместо того, чтобы выполнять собственное управление контекстами активации, нужно просто поместить манифест в таблицу ресурсов с идентификатором ресурса ИСОЛАТИОНАВАРЕ \_ манифеста Resource ID \_ \_ (числовое значение 2) типа "Манифест RT" \_ (числовое значение 24). Затем такие функции, как [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)и [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) , автоматически активируют этот контекст перед выполнением фактического вызова.</span><span class="sxs-lookup"><span data-stu-id="7d25b-117">Instead of having to do your own activation context management, you simply need to place a manifest in your resource table at resource ID ISOLATIONAWARE\_MANIFEST\_RESOURCE\_ID (numeric value 2), of type RT\_MANIFEST (numeric value 24.) Functions such as [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), and [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) then automatically activate this context before making the actual call.</span></span>

<span data-ttu-id="7d25b-118">Обратите внимание, что при компиляции \_ с \_ включенной поддержкой режима изоляции нельзя также выполнять собственное управление контекстом активации.</span><span class="sxs-lookup"><span data-stu-id="7d25b-118">Note that if you compile with ISOLATION\_AWARE\_ENABLED defined, you cannot also do your own activation context management.</span></span> <span data-ttu-id="7d25b-119">Если параметр \_ \_ Enabled с поддержкой изоляции определен, Windows игнорирует любой контекст динамической активации, который приложение может попытаться выполнить между вызовами [**активатеакткткс**](/windows/desktop/api/Winbase/nf-winbase-activateactctx) и [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) .</span><span class="sxs-lookup"><span data-stu-id="7d25b-119">With ISOLATION\_AWARE\_ENABLED defined, Windows ignores any dynamic activation context creation your application may attempt to do between [**ActivateActCtx**](/windows/desktop/api/Winbase/nf-winbase-activateactctx) and [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) calls.</span></span> <span data-ttu-id="7d25b-120">Это означает, что если приложение использует режим \_ поддержки изоляции, \_ необходимо убедиться, что манифест содержит полный список всех сборок, необходимых для компонента.</span><span class="sxs-lookup"><span data-stu-id="7d25b-120">This means that when your application uses ISOLATION\_AWARE\_ENABLED you must make sure that the manifest contains a complete list of all assemblies that your component requires.</span></span>

 

 
