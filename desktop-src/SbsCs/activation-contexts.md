---
description: Контексты активации — это структуры данных в памяти, содержащие сведения, которые система может использовать для перенаправления приложения для загрузки конкретной версии DLL, экземпляра объекта COM или пользовательской версии окна.
ms.assetid: 5416f8c0-d99b-4a5d-a689-a47bd0cf1a88
title: Контексты активации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f1f20d747f63ba71eee73fc17c0d5543003e5f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104345332"
---
# <a name="activation-contexts"></a><span data-ttu-id="047d2-103">Контексты активации</span><span class="sxs-lookup"><span data-stu-id="047d2-103">Activation Contexts</span></span>

<span data-ttu-id="047d2-104">[*Контексты активации*](a-sbscs-gly.md) — это структуры данных в памяти, содержащие сведения, которые система может использовать для перенаправления приложения для загрузки конкретной версии DLL, экземпляра объекта COM или пользовательской версии окна.</span><span class="sxs-lookup"><span data-stu-id="047d2-104">[*Activation contexts*](a-sbscs-gly.md) are data structures in memory containing information that the system can use to redirect an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="047d2-105">Один раздел контекста активации может содержать сведения о перенаправлении библиотек DLL, которые используются загрузчиком DLL. другой раздел может содержать сведения о COM-сервере.</span><span class="sxs-lookup"><span data-stu-id="047d2-105">One section of the activation context may contain DLL redirection information which is used by the DLL loader; another section may contain COM server information.</span></span> <span data-ttu-id="047d2-106">Функции контекста активации используют, создают, активируют и деактивируют контексты активации.</span><span class="sxs-lookup"><span data-stu-id="047d2-106">The activation context functions use, create, activate, and deactivate activation contexts.</span></span> <span data-ttu-id="047d2-107">Функции активации могут перенаправить привязку приложения к объектам с именованием версий, которые указывают определенные версии DLL, классы окон, серверы COM, библиотеки типов и интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="047d2-107">The activation functions can redirect the binding of an application to version-named objects that specify particular DLL versions, window classes, COM servers, type libraries, and interfaces.</span></span> <span data-ttu-id="047d2-108">Дополнительные сведения о функциях контекста активации и структурах см. в разделе [Справочник по контексту активации](activation-context-reference.md).</span><span class="sxs-lookup"><span data-stu-id="047d2-108">For more information about the activation context functions and structures, see the [Activation Context Reference](activation-context-reference.md).</span></span>

<span data-ttu-id="047d2-109">Начиная с Windows XP, функции контекста активации позволяют Windows использовать сведения в [манифестах](manifests.md) для создания объектов с именами версий.</span><span class="sxs-lookup"><span data-stu-id="047d2-109">Beginning with Windows XP, activation context functions enable Windows to use information in [manifests](manifests.md) to create version-named objects.</span></span> <span data-ttu-id="047d2-110">Если приложение создает процесс путем вызова функции [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows проверяет наличие [манифеста приложения](application-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="047d2-110">If an application creates a process by calling [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows checks for the existence of an [application manifest](application-manifests.md).</span></span> <span data-ttu-id="047d2-111">Если манифест существует, Windows использует сведения в манифесте для заполнения контекста активации.</span><span class="sxs-lookup"><span data-stu-id="047d2-111">If a manifest exists, Windows uses the information in the manifest to populate the activation context.</span></span> <span data-ttu-id="047d2-112">Поскольку манифесты описывают зависимость приложения от [параллельных версий сборок](about-side-by-side-assemblies-.md) , объекты, указанные без версий в манифесте, сопоставляются с именами объектов версии.</span><span class="sxs-lookup"><span data-stu-id="047d2-112">Because manifests describe an application's dependence on [side-by-side assembly](about-side-by-side-assemblies-.md) versions, objects specified without versions in the manifest are mapped to version-named objects.</span></span> <span data-ttu-id="047d2-113">Например, манифест может описывать библиотеки DLL, файлы, классы окон, серверы COM, библиотеки типов и интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="047d2-113">For example, the manifest may describe DLLs, files, window classes, COM servers, type libraries, and interfaces.</span></span>

<span data-ttu-id="047d2-114">Когда глобальный объект создается в контексте активации, система автоматически присваивает объекту имя, зависящее от версии, путем консультации с манифестом.</span><span class="sxs-lookup"><span data-stu-id="047d2-114">When a global object is created within the activation context, the system automatically gives the object a version-specific name by consulting the manifest.</span></span> <span data-ttu-id="047d2-115">Когда приложение выполняет и запрашивает именованный объект, он получает объект с именем версии.</span><span class="sxs-lookup"><span data-stu-id="047d2-115">When the application executes and requests a named object, it gets the version-named object.</span></span> <span data-ttu-id="047d2-116">Это позволяет нескольким версиям модуля кода запускаться в системе одновременно, не мешая друг другу.</span><span class="sxs-lookup"><span data-stu-id="047d2-116">This enables multiple versions of a code module to run on the system at the same time without interfering with each other.</span></span> <span data-ttu-id="047d2-117">Например, [оболочка Windows](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) использует манифест для описания зависимости от версии 6,0 Comctl32 и создания версий классов окон.</span><span class="sxs-lookup"><span data-stu-id="047d2-117">For example, [Windows Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) uses a manifest to describe a dependence on version 6.0 of COMCTL32 and to create versions of window classes.</span></span>

<span data-ttu-id="047d2-118">Если приложение создает ресурс путем вызова [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), этот процесс указывает имя класса для этой функции.</span><span class="sxs-lookup"><span data-stu-id="047d2-118">If an application creates a resource by calling [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), the process specifies a class name to that function.</span></span> <span data-ttu-id="047d2-119">Вызов [**жеткуррентакткткс**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) получает текущий контекст активации и проверяет существование сопоставления для данного имени класса.</span><span class="sxs-lookup"><span data-stu-id="047d2-119">The call to [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) gets the current activation context and checks to see if a mapping exists for the given class name.</span></span> <span data-ttu-id="047d2-120">Если сопоставление существует, оно будет использовать эту версию вызывающего процесса для разрешения сопоставления и предоставления имени класса, зависящего от версии.</span><span class="sxs-lookup"><span data-stu-id="047d2-120">If a mapping exists, it will use that version of the calling process to resolve the mapping and provide the version-specific class name.</span></span> <span data-ttu-id="047d2-121">Windows создает окно с процедурой окна, стилями и другими атрибутами, связанными с именем и версией этого класса.</span><span class="sxs-lookup"><span data-stu-id="047d2-121">Windows creates a window with the window procedure, styles, and other attributes associated with that class name and version.</span></span>

<span data-ttu-id="047d2-122">Контекст активации управляется системой в большинстве случаев.</span><span class="sxs-lookup"><span data-stu-id="047d2-122">The activation context is managed by the system in most cases.</span></span> <span data-ttu-id="047d2-123">Разработчикам приложений и поставщикам сборок обычно не требуется вызывать стек.</span><span class="sxs-lookup"><span data-stu-id="047d2-123">Application developers and assembly providers do not commonly need to make calls to the stack.</span></span> <span data-ttu-id="047d2-124">Приложения могут управлять контекстом активации путем прямого вызова контекста активации.</span><span class="sxs-lookup"><span data-stu-id="047d2-124">Applications can manage an activation context by directly calling the activation context.</span></span> <span data-ttu-id="047d2-125">Дополнительные сведения см. [в разделе Использование API контекста активации](using-the-activation-context-api.md).</span><span class="sxs-lookup"><span data-stu-id="047d2-125">For more information, see [Using the Activation Context API](using-the-activation-context-api.md).</span></span>

 

 
