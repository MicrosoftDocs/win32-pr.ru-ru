---
description: Частная сборка — это сборка, которая развертывается вместе с приложением и доступна для монопольного использования этого приложения.
ms.assetid: 5E0E7423-85BD-4ED0-9149-9541F4D2371F
title: О закрытых сборках
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c785b30ca8654071a9816aaf9a11ecc69a029f605d06f39f44a6a490a2a7aef
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119142617"
---
# <a name="about-private-assemblies"></a>О закрытых сборках

Частная сборка — это сборка, которая развертывается вместе с приложением и доступна для монопольного использования этого приложения. То есть другие приложения не имеют общего доступа к закрытой сборке. Закрытые сборки — это один из методов, которые можно использовать для создания [изолированных приложений](isolated-applications.md). Дополнительные сведения см. в разделе [о изолированных приложениях и параллельных сборках](about-isolated-applications-and-side-by-side-assemblies.md).

Закрытые сборки должны быть предназначены для параллельной работы с другими версиями сборки в системе. Дополнительные сведения см. в разделе [рекомендации по созданию параллельных сборок](guidelines-for-creating-side-by-side-assemblies.md).

Закрытые сборки должны сопровождаться [манифестом сборки](assembly-manifests.md). обратите внимание, что ограничения имен применяются при упаковке библиотеки DLL как закрытой сборки, чтобы соответствовать способу Windows поиска закрытых сборок. При поиске закрытых сборок рекомендуемым методом является включение манифеста сборки в библиотеку DLL в качестве ресурса. В этом случае идентификатор ресурса должен равняться 1, а имя закрытой сборки может совпадать с именем библиотеки DLL. Например, если имя библиотеки DLL MICROSOFT.WINDOWS.MYSAMPLE.DLL, то значение атрибута Name, используемое в элементе **assemblyIdentity** манифеста, также может быть равно Microsoft. Windows. mysample. Альтернативным методом поиска закрытых сборок является предоставление манифеста сборки в отдельном файле. В этом случае имя сборки и ее манифеста должны отличаться от имени библиотеки DLL. Например, Microsoft. Windows. мисамплеасм, Microsoft. Windows. мисамплеасм. manifest и Microsoft.Windows.mysample.dll. Дополнительные сведения о параллельном поиске закрытых сборок см. в разделе [последовательность поиска сборок](assembly-searching-sequence.md).

Закрытые сборки устанавливаются в папку структуры каталогов приложения. Как правило, это папка, содержащая исполняемый файл приложения. Закрытые сборки могут быть развернуты в той же папке, что и приложение, в папке с тем же именем, что и сборка, или в подпапке, зависящей от языка, с тем же именем, что и у сборки. Например, используйте одну из следующих структур каталогов для развертывания закрытой сборки, Microsoft. Tools. POP без указания языка.



| Структура каталогов                                       | Описание                                                                                            |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| APPDIR \\MICROSOFT.TOOLS.POP.DLL                           | Манифест развертывается как ресурс в библиотеке DLL.                                                     |
| Appdir \\ Microsoft. Tools. POP. manifest                      | Манифест развертывается как отдельный файл.                                                           |
| APPDIR \\ Майкрософт. Инструментари. \\MICROSOFT.TOOLS.POP.DLL POP      | Манифест развертывается как ресурс в библиотеке DLL, который находится во вложенной папке с именем сборки. |
| Appdir \\ Майкрософт. Tools. Pop \\ Microsoft. Tools. POP. manifest | Манифест развертывается как отдельный файл во вложенной папке с именем сборки.                 |



 

> [!IMPORTANT]
>
> для версий операционной системы Windows до Windows 7 и Windows Server 2008 R2 собственные закрытые сборки должны быть развернуты в папке, содержащей исполняемый файл приложения. Установка в папке на определенном языке или в папке с тем же именем, что и сборка, не поддерживается для собственных закрытых сборок.

 

Используйте одну из следующих структур каталогов для развертывания закрытой сборки Microsoft. Tools. POP с указанным языком. В следующем примере язык, используемый Microsoft. Tools. POP, — Английский (США), а код языка — en-US. Необходимо заменить правильный код языка DHTML для сборки.

``` syntax
appdir\en-us\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop.MANIFEST
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.MANIFEST
```

Закрытые сборки могут быть установлены любым методом установки, который может скопировать файл сборки в эту папку, например команду **xcopy** . дополнительные сведения об установке закрытых сборок с помощью установщик Windows см. в разделе [установка сборок Win32](../msi/installation-of-win32-assemblies.md).

закрытые сборки также можно устанавливать в операционных системах, предшествующих Windows XP. В этом случае сборка должна быть зарегистрирована и в этих операционных системах манифест не используется. Копия закрытой сборки устанавливается в личную папку для монопольного использования приложения. Другая версия сборки может быть глобально зарегистрирована в системе и доступна для любого приложения, которое привязывается к ней. Глобальная версия сборки может быть версией, установленной с приложением или более ранней версией. Дополнительные сведения см. [в разделе Перенаправление DLL/COM на Windows](dll-com-redirection-on-windows.md). Сборку также можно установить как общую сборку для использования несколькими приложениями. Дополнительные сведения см. в разделе [Общие сборки](/windows/desktop/Msi/shared-assemblies).

Обратите внимание, что шаги по созданию закрытой сборки идентичны тем, что необходимо для создания общей сборки с двумя исключениями:

-   Закрытая сборка не обязательно должна быть подписана, а **publickeyToken** не требуется в элементе **assemblyIdentity** манифеста сборки.
-   Закрытые сборки можно установить в папку приложения с помощью любой технологии установки. закрытые сборки не обязательно устанавливать с помощью установщик Windows.

 

 
