---
description: Частная сборка — это сборка, которая развертывается вместе с приложением и доступна для монопольного использования этого приложения.
ms.assetid: 5E0E7423-85BD-4ED0-9149-9541F4D2371F
title: О закрытых сборках
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7c7ccfe8c63a8435a33085f607c2040a0a42345c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105647351"
---
# <a name="about-private-assemblies"></a><span data-ttu-id="c0a6f-103">О закрытых сборках</span><span class="sxs-lookup"><span data-stu-id="c0a6f-103">About Private Assemblies</span></span>

<span data-ttu-id="c0a6f-104">Частная сборка — это сборка, которая развертывается вместе с приложением и доступна для монопольного использования этого приложения.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-104">A private assembly is an assembly that is deployed with an application and is available for the exclusive use of that application.</span></span> <span data-ttu-id="c0a6f-105">То есть другие приложения не имеют общего доступа к закрытой сборке.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-105">That is, other applications do not share the private assembly.</span></span> <span data-ttu-id="c0a6f-106">Закрытые сборки — это один из методов, которые можно использовать для создания [изолированных приложений](isolated-applications.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-106">Private assemblies are one of the methods that can be used to create [isolated applications](isolated-applications.md).</span></span> <span data-ttu-id="c0a6f-107">Дополнительные сведения см. в разделе [о изолированных приложениях и параллельных сборках](about-isolated-applications-and-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-107">For more information, see [About Isolated Applications and Side-by-Side Assemblies](about-isolated-applications-and-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="c0a6f-108">Закрытые сборки должны быть предназначены для параллельной работы с другими версиями сборки в системе.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-108">Private assemblies must be designed to work side-by-side with other versions of the assembly on the system.</span></span> <span data-ttu-id="c0a6f-109">Дополнительные сведения см. в разделе [рекомендации по созданию параллельных сборок](guidelines-for-creating-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-109">For more information, see [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="c0a6f-110">Закрытые сборки должны сопровождаться [манифестом сборки](assembly-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-110">Private assemblies must be accompanied by an [assembly manifest](assembly-manifests.md).</span></span> <span data-ttu-id="c0a6f-111">Обратите внимание, что ограничения имен применяются при упаковке библиотеки DLL как закрытой сборки в соответствии с тем, как Windows ищет закрытые сборки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-111">Note that name restrictions apply when packaging a DLL as a private assembly to accommodate the way in which Windows searches for private assemblies.</span></span> <span data-ttu-id="c0a6f-112">При поиске закрытых сборок рекомендуемым методом является включение манифеста сборки в библиотеку DLL в качестве ресурса.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-112">When searching for private assemblies, the recommended method is to include the assembly manifest in the DLL as a resource.</span></span> <span data-ttu-id="c0a6f-113">В этом случае идентификатор ресурса должен равняться 1, а имя закрытой сборки может совпадать с именем библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-113">In this case, the resource ID must equal 1 and the name of the private assembly may be the same as the name of the DLL.</span></span> <span data-ttu-id="c0a6f-114">Например, если имя библиотеки DLL MICROSOFT.WINDOWS.MYSAMPLE.DLL, то значение атрибута Name, используемое в элементе **assemblyIdentity** манифеста, также может быть Microsoft. Windows. MySample.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-114">For example, if the name of the DLL is MICROSOFT.WINDOWS.MYSAMPLE.DLL, the value of the name attribute used in the **assemblyIdentity** element of the manifest may also be Microsoft.Windows.mysample.</span></span> <span data-ttu-id="c0a6f-115">Альтернативным методом поиска закрытых сборок является предоставление манифеста сборки в отдельном файле.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-115">An alternate method of searching for private assemblies is to provide the assembly manifest in a separate file.</span></span> <span data-ttu-id="c0a6f-116">В этом случае имя сборки и ее манифеста должны отличаться от имени библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-116">In this case, the name of the assembly and its manifest must be different than the name of the DLL.</span></span> <span data-ttu-id="c0a6f-117">Например, Microsoft. Windows. Мисамплеасм, Microsoft. Windows. Мисамплеасм. manifest и Microsoft.Windows.mysample.dll.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-117">For example, Microsoft.Windows.mysampleAsm, Microsoft.Windows.mysampleAsm.manifest, and Microsoft.Windows.mysample.dll.</span></span> <span data-ttu-id="c0a6f-118">Дополнительные сведения о параллельном поиске закрытых сборок см. в разделе [последовательность поиска сборок](assembly-searching-sequence.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-118">For more information about how side-by-side searches for private assemblies see [Assembly Searching Sequence](assembly-searching-sequence.md).</span></span>

<span data-ttu-id="c0a6f-119">Закрытые сборки устанавливаются в папку структуры каталогов приложения.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-119">Private assemblies are installed in a folder of the application's directory structure.</span></span> <span data-ttu-id="c0a6f-120">Как правило, это папка, содержащая исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-120">Typically, this is the folder containing the application's executable file.</span></span> <span data-ttu-id="c0a6f-121">Закрытые сборки могут быть развернуты в той же папке, что и приложение, в папке с тем же именем, что и сборка, или в подпапке, зависящей от языка, с тем же именем, что и у сборки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-121">Private assemblies may be deployed in the same folder as the application, in a folder with the same name as the assembly, or in a language specific subfolder with the same name as the assembly.</span></span> <span data-ttu-id="c0a6f-122">Например, используйте одну из следующих структур каталогов для развертывания закрытой сборки, Microsoft. Tools. POP без указания языка.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-122">For example, use one of the following directory structures to deploy a private assembly, Microsoft.tools.pop, with no language specified.</span></span>



| <span data-ttu-id="c0a6f-123">Структура каталогов</span><span class="sxs-lookup"><span data-stu-id="c0a6f-123">Directory structure</span></span>                                       | <span data-ttu-id="c0a6f-124">Описание</span><span class="sxs-lookup"><span data-stu-id="c0a6f-124">Description</span></span>                                                                                            |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c0a6f-125">APPDIR \\MICROSOFT.TOOLS.POP.DLL</span><span class="sxs-lookup"><span data-stu-id="c0a6f-125">APPDIR\\MICROSOFT.TOOLS.POP.DLL</span></span>                           | <span data-ttu-id="c0a6f-126">Манифест развертывается как ресурс в библиотеке DLL.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-126">The manifest is deployed as a resource in the DLL.</span></span>                                                     |
| <span data-ttu-id="c0a6f-127">Appdir \\ Microsoft. Tools. POP. manifest</span><span class="sxs-lookup"><span data-stu-id="c0a6f-127">Appdir\\Microsoft.Tools.Pop.MANIFEST</span></span>                      | <span data-ttu-id="c0a6f-128">Манифест развертывается как отдельный файл.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-128">The manifest is deployed as a separate file.</span></span>                                                           |
| <span data-ttu-id="c0a6f-129">APPDIR \\ Майкрософт. Инструментари. \\MICROSOFT.TOOLS.POP.DLL POP</span><span class="sxs-lookup"><span data-stu-id="c0a6f-129">APPDIR\\MICROSOFT.TOOLS.POP\\MICROSOFT.TOOLS.POP.DLL</span></span>      | <span data-ttu-id="c0a6f-130">Манифест развертывается как ресурс в библиотеке DLL, который находится во вложенной папке с именем сборки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-130">The manifest is deployed as a resource in the DLL, which is in a subfolder having the assembly's name.</span></span> |
| <span data-ttu-id="c0a6f-131">Appdir \\ Майкрософт. Tools. Pop \\ Microsoft. Tools. POP. manifest</span><span class="sxs-lookup"><span data-stu-id="c0a6f-131">Appdir\\Microsoft.Tools.Pop\\Microsoft.Tools.Pop.MANIFEST</span></span> | <span data-ttu-id="c0a6f-132">Манифест развертывается как отдельный файл во вложенной папке с именем сборки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-132">The manifest is deployed as a separate file in a subfolder having the assembly's name.</span></span>                 |



 

> [!IMPORTANT]
>
> <span data-ttu-id="c0a6f-133">Для версий операционной системы Windows до Windows 7 и Windows Server 2008 R2 собственные закрытые сборки должны быть развернуты в папке, содержащей исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-133">For versions of the Windows operating system before Windows 7 and Windows Server 2008 R2, native private assemblies must be deployed in the folder that contains the application's executable file.</span></span> <span data-ttu-id="c0a6f-134">Установка в папке на определенном языке или в папке с тем же именем, что и сборка, не поддерживается для собственных закрытых сборок.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-134">Installation in a language specific folder or in the folder with same name as assembly is not supported for native private assemblies.</span></span>

 

<span data-ttu-id="c0a6f-135">Используйте одну из следующих структур каталогов для развертывания закрытой сборки Microsoft. Tools. POP с указанным языком.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-135">Use one of the following directory structures to deploy a private assembly, Microsoft.tools.pop, with a specified language.</span></span> <span data-ttu-id="c0a6f-136">В следующем примере язык, используемый Microsoft. Tools. POP, — Английский (США), а код языка — en-US.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-136">In the following example, the language used by Microsoft.Tools.Pop is English (United States) and the language code is en-us.</span></span> <span data-ttu-id="c0a6f-137">Необходимо заменить правильный код языка DHTML для сборки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-137">You should substitute the correct DHTML language code for your assembly.</span></span>

``` syntax
appdir\en-us\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop.MANIFEST
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.MANIFEST
```

<span data-ttu-id="c0a6f-138">Закрытые сборки могут быть установлены любым методом установки, который может скопировать файл сборки в эту папку, например команду **xcopy** .</span><span class="sxs-lookup"><span data-stu-id="c0a6f-138">Private assemblies can be installed by any installation method that can copy the assembly's file into this folder, such as the **xcopy** command.</span></span> <span data-ttu-id="c0a6f-139">Дополнительные сведения об установке закрытых сборок с помощью установщик Windows см. в разделе [Установка сборок Win32](../msi/installation-of-win32-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-139">For more information about how to install private assemblies using the Windows Installer, see [Installation of Win32 Assemblies](../msi/installation-of-win32-assemblies.md).</span></span>

<span data-ttu-id="c0a6f-140">Закрытые сборки также можно устанавливать в операционных системах, предшествующих Windows XP.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-140">Private assemblies can also be installed on operating systems earlier than Windows XP.</span></span> <span data-ttu-id="c0a6f-141">В этом случае сборка должна быть зарегистрирована и в этих операционных системах манифест не используется.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-141">In this case, the assembly must be registered and on these operating systems the manifest is not used.</span></span> <span data-ttu-id="c0a6f-142">Копия закрытой сборки устанавливается в личную папку для монопольного использования приложения.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-142">A copy of the private assembly is installed into a private folder for the exclusive use of the application.</span></span> <span data-ttu-id="c0a6f-143">Другая версия сборки может быть глобально зарегистрирована в системе и доступна для любого приложения, которое привязывается к ней.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-143">Another version of the assembly can be globally registered on the system and available to any application that binds to it.</span></span> <span data-ttu-id="c0a6f-144">Глобальная версия сборки может быть версией, установленной с приложением или более ранней версией.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-144">The global version of the assembly may be the version installed with the application or an earlier version.</span></span> <span data-ttu-id="c0a6f-145">Дополнительные сведения см. [в разделе Перенаправление библиотек DLL и com в Windows](dll-com-redirection-on-windows.md).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-145">For more information, see [DLL/COM Redirection on Windows](dll-com-redirection-on-windows.md).</span></span> <span data-ttu-id="c0a6f-146">Сборку также можно установить как общую сборку для использования несколькими приложениями.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-146">An assembly can also be installed as a shared assembly for use by multiple applications.</span></span> <span data-ttu-id="c0a6f-147">Дополнительные сведения см. в разделе [Общие сборки](/windows/desktop/Msi/shared-assemblies).</span><span class="sxs-lookup"><span data-stu-id="c0a6f-147">For more information, see [Shared Assemblies](/windows/desktop/Msi/shared-assemblies).</span></span>

<span data-ttu-id="c0a6f-148">Обратите внимание, что шаги по созданию закрытой сборки идентичны тем, что необходимо для создания общей сборки с двумя исключениями:</span><span class="sxs-lookup"><span data-stu-id="c0a6f-148">Note that the steps for creating a private assembly are identical to those for creating a shared assembly with two exceptions:</span></span>

-   <span data-ttu-id="c0a6f-149">Закрытая сборка не обязательно должна быть подписана, а **publickeyToken** не требуется в элементе **assemblyIdentity** манифеста сборки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-149">A private assembly is not required to be signed, and **publickeyToken** is not required in the **assemblyIdentity** element of the assembly manifest.</span></span>
-   <span data-ttu-id="c0a6f-150">Закрытые сборки можно установить в папку приложения с помощью любой технологии установки.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-150">Private assemblies can be installed into the application's folder using any installation technology.</span></span> <span data-ttu-id="c0a6f-151">Закрытые сборки не обязательно устанавливать с помощью установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="c0a6f-151">Private assemblies are not required to be installed using the Windows Installer.</span></span>

 

 
