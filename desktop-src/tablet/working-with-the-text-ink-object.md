---
description: Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, которые могут быть внедрены и поддерживаются любыми контейнерами OLE, объектом рукописного ввода текста (Тинк) и объектом рукописного ввода эскиза (приемником).
ms.assetid: 0202e91c-c7a0-4e7b-a1c6-a2f58c11c0be
title: Работа с объектом рукописного ввода текста
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 082323f7e67e76f7ae39c6b592a86f2be0945a86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692498"
---
# <a name="working-with-the-text-ink-object"></a><span data-ttu-id="c9dc0-103">Работа с объектом рукописного ввода текста</span><span class="sxs-lookup"><span data-stu-id="c9dc0-103">Working with the Text Ink Object</span></span>

<span data-ttu-id="c9dc0-104">Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, которые могут быть внедрены и поддерживаются любыми контейнерами OLE, объектом рукописного ввода текста (Тинк) и объектом рукописного ввода эскиза (приемником).</span><span class="sxs-lookup"><span data-stu-id="c9dc0-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container, the text ink object (tInk) and the sketch ink object (sInk).</span></span>

<span data-ttu-id="c9dc0-105">Объект рукописного ввода текста — это объект OLE, представляющий рукописный ввод, который должен образовывать слова.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-105">The text ink object is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="c9dc0-106">Объект рукописного ввода текста позволяет преобразовать рукописный ввод в текст путем выбора из списка вариантов.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-106">A text ink object enables the handwritten ink to be converted to text by choosing from a list of alternates.</span></span> <span data-ttu-id="c9dc0-107">Цвет и размер объекта рукописного ввода текста могут быть заданы программно и могут основываться на атрибутах текста вокруг объекта.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-107">The color and size of the text ink object can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="c9dc0-108">Объект рукописного ввода текста должен содержать одно слово.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-108">The text ink object is intended to contain a single word.</span></span>

<span data-ttu-id="c9dc0-109">Объект рукописного ввода текста поддерживает стандартный набор интерфейсов OLE, необходимых для внедрения и поддержки буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-109">The text ink object supports the standard set of OLE interfaces required for embedding and clipboard support.</span></span> <span data-ttu-id="c9dc0-110">Интерфейс [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) считывает данные из потока и выполняет запись в него в сериализованном формате (ISF).</span><span class="sxs-lookup"><span data-stu-id="c9dc0-110">The [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface reads from and writes to a stream in ink serialized format (ISF).</span></span> <span data-ttu-id="c9dc0-111">Объект рукописного ввода текста предоставляет интерфейс [**иинклинеинфо**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) для доступа к его свойствам экрана и списку результатов распознавания.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-111">The text ink object provides the [**IInkLineInfo**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) interface to access its display properties, and recognition result list.</span></span>

<span data-ttu-id="c9dc0-112">Объект рукописного ввода текста может использоваться для взаимодействия между приложениями путем помещения его в область объектов OLE в буфер обмена, путем его встраивания в формат RTF или сохранения в потоке ISF.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-112">The text ink object can be used for interoperability between applications either by placing it in the OLE object slot on the Clipboard, by embedding it in RTF, or by persisting it in an ISF stream.</span></span>

<span data-ttu-id="c9dc0-113">Объект рукописного ввода текста может быть создан следующими способами.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-113">A text ink object can be generated in the following ways.</span></span>

-   <span data-ttu-id="c9dc0-114">Элемент управления [InkEdit](inkedit-control-reference.md) использует объект рукописного ввода текста.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-114">The [InkEdit](inkedit-control-reference.md) control makes use of the text ink object.</span></span> <span data-ttu-id="c9dc0-115">Функциональные возможности элемента управления InkEdit — это супер-набор стандартных функциональных возможностей элемента управления RichEdit.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-115">The InkEdit control's functionality is a super-set of the standard RichEdit control functionality.</span></span> <span data-ttu-id="c9dc0-116">Рукописный ввод вставляется в поток RTF элемента управления InkEdit как объект рукописного ввода текста.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-116">Ink is inserted into the InkEdit control's RTF stream as a text ink object.</span></span>
-   <span data-ttu-id="c9dc0-117">Когда приложение копирует объект [инкстрокес](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) или [InkEdit](inkedit-control-reference.md) в буфер обмена и задается формат [**перечисления инкклипбоардформатс**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) , слот буфера обмена объекта OLE содержит объект рукописного ввода текста OLE.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-117">When an application copies an [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) or an [InkEdit](inkedit-control-reference.md) object onto the Clipboard and the [**InkClipboardFormats Enumeration**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) format is set, the OLE object Clipboard slot contains a text ink OLE object.</span></span>
-   <span data-ttu-id="c9dc0-118">Панель ввода Tablet PC может создавать объекты рукописного ввода текста.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-118">Tablet PC Input Panel can generate text ink objects.</span></span>

<span data-ttu-id="c9dc0-119">Например, приложение может распознать рукописный ввод и добавить результат распознавания в штрихи.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-119">For example, your application can recognize handwriting and add the recognition result to the strokes.</span></span> <span data-ttu-id="c9dc0-120">Затем, если скопировать и вставить штрихи в Microsoft Word как объект рукописного ввода, варианты для этого слова будут доступны в Word 2003 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-120">Then, if you copy and paste the strokes to Microsoft Word as a text ink object, alternates for that word is available in Word 2003 and later versions.</span></span>

<span data-ttu-id="c9dc0-121">Чтобы успешно содержать текстовые объекты рукописного ввода, приложение должно реализовать поддержку контейнера OLE для внедренных объектов.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-121">In order to successfully contain text ink objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="c9dc0-122">Затем, чтобы сделать контейнер полностью поддерживаемым текстом, необходимо заинститутировать:</span><span class="sxs-lookup"><span data-stu-id="c9dc0-122">Then, to make the container fully support text ink, you must institute:</span></span>

-   <span data-ttu-id="c9dc0-123">Изменения в приложении для поиска и замены.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-123">Modifications to the application for Find and Replace.</span></span> <span data-ttu-id="c9dc0-124">Вместо того чтобы пропускать внедренные объекты в поиске, эти объекты должны быть опрошены для типа.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-124">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="c9dc0-125">Если они являются объектом рукописного ввода текста, они должны быть созданы и запрошены для соответствующего текста.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-125">If they are a text ink object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="c9dc0-126">Изменения в поведении выбора.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-126">Modifications to selection behavior.</span></span> <span data-ttu-id="c9dc0-127">Выбор объектов рукописного ввода текста никогда не должен появляться с маркерами изменения размера.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-127">Selection of text ink objects should never appear with sizing handles.</span></span> <span data-ttu-id="c9dc0-128">Они должны быть выбраны точно так же, как текст выбирается в документе.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-128">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="c9dc0-129">Код выбора для объектов должен определять, является ли тип текстовым рукописным текстом, и отображать выбор соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-129">Selection code for objects must detect if the type is text ink and display the selection appropriately.</span></span>
-   <span data-ttu-id="c9dc0-130">Использование внешних свойств.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-130">Use of ambient properties.</span></span> <span data-ttu-id="c9dc0-131">Свойства окружающей среды, такие как размер шрифта, цвет и полужирное начертание, необходимо передать в объект рукописного ввода текста.</span><span class="sxs-lookup"><span data-stu-id="c9dc0-131">Ambient properties such as font size, color, and bold formatting need to be transmitted to the text ink object.</span></span> <span data-ttu-id="c9dc0-132">Приложение этих свойств изменяет ширину рукописных рукописных данных, поэтому требуется обновление размера путем вызова метода [**иинклинеинфо:: жетинкекстент**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) или [**иолеобжект::-экстента**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .</span><span class="sxs-lookup"><span data-stu-id="c9dc0-132">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**IInkLineInfo::GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [**IOleObject::GetExtent**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="c9dc0-133">в этом разделе</span><span class="sxs-lookup"><span data-stu-id="c9dc0-133">In This Section</span></span>

-   [<span data-ttu-id="c9dc0-134">Преобразование объекта рукописного ввода текста в рукописный текст</span><span class="sxs-lookup"><span data-stu-id="c9dc0-134">Converting a Text Ink Object to Ink</span></span>](converting-a-text-ink-object-to-ink.md)
-   [<span data-ttu-id="c9dc0-135">Интерфейсы API рукописного ввода текста</span><span class="sxs-lookup"><span data-stu-id="c9dc0-135">Text Ink APIs</span></span>](text-ink-apis.md)
-   [<span data-ttu-id="c9dc0-136">Приемники и объекты Тинк</span><span class="sxs-lookup"><span data-stu-id="c9dc0-136">sInk and tInk Objects</span></span>](sink-and-tink-objects.md)

 

 
