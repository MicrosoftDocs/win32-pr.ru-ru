---
description: Как упоминалось в обзоре анализа рукописного ввода, технология анализа рукописного ввода внутренне поддерживает модель документа на основе дерева для хранения результатов и отношений анализа.
ms.assetid: 33ba9292-3bc7-41ba-a602-e2fc94cd3a57
title: Прокси-сервер данных с анализом рукописного ввода
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 52717b955625e67f50c20703dd0e84449aa1037f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103912916"
---
# <a name="data-proxy-with-ink-analysis"></a><span data-ttu-id="cc091-103">Прокси-сервер данных с анализом рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="cc091-103">Data Proxy with Ink Analysis</span></span>

<span data-ttu-id="cc091-104">Как упоминалось в [обзоре анализа рукописного ввода](ink-analysis-overview.md), технология анализа рукописного ввода внутренне поддерживает модель документа на основе дерева для хранения результатов и отношений анализа.</span><span class="sxs-lookup"><span data-stu-id="cc091-104">As mentioned in [Ink Analysis Overview](ink-analysis-overview.md), the ink analysis technology internally maintains a tree-based document model to contain analysis results and relationships.</span></span> <span data-ttu-id="cc091-105">Если в приложении уже есть хранилище документов, которое отличается, необходимо использовать функции анализа рукописного ввода, предназначенные для данных прокси-сервера между разнородными моделями документов.</span><span class="sxs-lookup"><span data-stu-id="cc091-105">If your application already has an established document store that is different, you will need to make use of the ink analysis features designed to proxy data between disparate document models.</span></span>

## <a name="types-of-data-proxy"></a><span data-ttu-id="cc091-106">Типы прокси-сервера данных</span><span class="sxs-lookup"><span data-stu-id="cc091-106">Types of Data Proxy</span></span>

<span data-ttu-id="cc091-107">Функции прокси-сервера данных позволяют приложению выполнять следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="cc091-107">The data proxy features enable your application to:</span></span>

-   <span data-ttu-id="cc091-108">Интегрируйте данные результатов анализа обратно в существующую модель документа.</span><span class="sxs-lookup"><span data-stu-id="cc091-108">Integrate analysis results data back into an existing document model.</span></span>
-   <span data-ttu-id="cc091-109">Передача предыдущих результатов (или состояния) обратно в [**InkAnalyzer**](inkanalyzer.md).</span><span class="sxs-lookup"><span data-stu-id="cc091-109">Communicate previous results (or state) back into the [**InkAnalyzer**](inkanalyzer.md).</span></span>
-   <span data-ttu-id="cc091-110">Передает данные о нерукописном состоянии в [**InkAnalyzer**](inkanalyzer.md).</span><span class="sxs-lookup"><span data-stu-id="cc091-110">Communicate non-ink state into the [**InkAnalyzer**](inkanalyzer.md).</span></span>
-   <span data-ttu-id="cc091-111">Передавать только минимальный набор данных (как для предыдущего, так и для нерукописного ввода), необходимый для выполнения операции анализа.</span><span class="sxs-lookup"><span data-stu-id="cc091-111">Communicate only the minimum set of data (both previous and non-ink state) needed to complete the analysis operation.</span></span>
-   <span data-ttu-id="cc091-112">Легко обновляйте внутреннюю модель документа приложения с помощью результатов анализа.</span><span class="sxs-lookup"><span data-stu-id="cc091-112">Easily update the internal application document model with analysis results.</span></span>

<span data-ttu-id="cc091-113">Существует два основных подхода к прокси-серверу данных анализа рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="cc091-113">There are two basic approaches to ink analysis data proxy.</span></span> <span data-ttu-id="cc091-114">Различия в деталях, когда и как происходит синхронизация между моделями документов.</span><span class="sxs-lookup"><span data-stu-id="cc091-114">The differences lay in the details of when and how the synchronization between the document models occurs.</span></span> <span data-ttu-id="cc091-115">Первый подход, синхронное обновление, требует изменения модели документа анализа рукописного ввода при внесении изменений в документ приложения.</span><span class="sxs-lookup"><span data-stu-id="cc091-115">The first approach, synchronous update, requires the modification of the ink analysis document model as changes occur in the application document.</span></span> <span data-ttu-id="cc091-116">Второй подход, обновление по запросу, требует, чтобы только данные, затрагиваемые изменениями в модели документа приложения, передавались в [**InkAnalyzer**](inkanalyzer.md).</span><span class="sxs-lookup"><span data-stu-id="cc091-116">The second approach, on-demand update, requires only the data affected by changes to the application document model to be passed to the [**InkAnalyzer**](inkanalyzer.md).</span></span> <span data-ttu-id="cc091-117">Таким образом, в **InkAnalyzer** должны быть переданы только данные для частей модели документа для анализа рукописного ввода, которые находятся в той же области, что и изменения документа приложения.</span><span class="sxs-lookup"><span data-stu-id="cc091-117">That is, only the data for the parts of the Ink Analysis document model that are in the same area as modifications to the application document need be passed to the **InkAnalyzer** as it needs them.</span></span>

### <a name="synchronous-update"></a><span data-ttu-id="cc091-118">Синхронное обновление</span><span class="sxs-lookup"><span data-stu-id="cc091-118">Synchronous Update</span></span>

<span data-ttu-id="cc091-119">Метод синхронного обновления требует изменения (создания и удаления) узлов в коллекции объектов [**контекстноде**](icontextnode.md) объекта [**InkAnalyzer**](inkanalyzer.md) , как они встречаются в документе приложения.</span><span class="sxs-lookup"><span data-stu-id="cc091-119">The synchronous update approach requires the modification (creation and deletion) of nodes in the [**InkAnalyzer**](inkanalyzer.md) object's collection of [**ContextNode**](icontextnode.md) objects as they occur in the application document.</span></span> <span data-ttu-id="cc091-120">Например, при каждом добавлении текстового слова в приложение в **InkAnalyzer** создается соответствующий **Текстворд** в стиле **контекстноде** .</span><span class="sxs-lookup"><span data-stu-id="cc091-120">For example, each time a text word is added to the application, a corresponding **TextWord** styled **ContextNode** is created in the **InkAnalyzer**.</span></span> <span data-ttu-id="cc091-121">Если изменяется расположение текстового слова на странице, то расположение соответствующего **контекстноде** обновляется одновременно.</span><span class="sxs-lookup"><span data-stu-id="cc091-121">If the location of the text word on the page changes, then the location of the corresponding **ContextNode** is updated at the same time.</span></span> <span data-ttu-id="cc091-122">Этот метод менее эффективен в плане вычислительных ресурсов, чем метод по запросу, поскольку каждое изменение документа включает обновление **InkAnalyzer**, даже если изменение не влияет на анализируемые рукописные данные.</span><span class="sxs-lookup"><span data-stu-id="cc091-122">This method is less efficient in terms of computing resources than the on-demand method because every document change involves an update to the **InkAnalyzer**, even if the change does not affect the ink being analyzed.</span></span>

<span data-ttu-id="cc091-123">В следующем примере показано, как работает синхронное обновление.</span><span class="sxs-lookup"><span data-stu-id="cc091-123">The following example is meant to show how synchronous update works.</span></span> <span data-ttu-id="cc091-124">Представьте себе приложение, имеющее существующую модель документа.</span><span class="sxs-lookup"><span data-stu-id="cc091-124">Imagine an application that has an existing document model.</span></span> <span data-ttu-id="cc091-125">Когда конечный пользователь вносит изменения в документ, например добавляет новый текст, изменение обрабатывается следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cc091-125">When the end-user makes a change to the document, such as adding new text, the change is processed as follows:</span></span>

1.  <span data-ttu-id="cc091-126">Конечный пользователь создает новые данные.</span><span class="sxs-lookup"><span data-stu-id="cc091-126">The end user creates the new data.</span></span>
2.  <span data-ttu-id="cc091-127">Приложение определяет способ обработки данных, сохраняет их и готовит к просмотру.</span><span class="sxs-lookup"><span data-stu-id="cc091-127">The application determines how to process the data, stores it, and renders it.</span></span>
3.  <span data-ttu-id="cc091-128">В практических целях следующие шаги выполняются одновременно.</span><span class="sxs-lookup"><span data-stu-id="cc091-128">For practical purposes, the following steps take place simultaneously.</span></span>
    1.  <span data-ttu-id="cc091-129">Приложение помещает данные в модель документа.</span><span class="sxs-lookup"><span data-stu-id="cc091-129">The application places the data into its document model.</span></span>
    2.  <span data-ttu-id="cc091-130">Приложение создает [**InkAnalyzer**](inkanalyzer.md) и обновляет его.</span><span class="sxs-lookup"><span data-stu-id="cc091-130">The application creates an [**InkAnalyzer**](inkanalyzer.md) and updates it.</span></span> <span data-ttu-id="cc091-131">Это гарантирует, что **InkAnalyzer** всегда содержит самые последние сведения.</span><span class="sxs-lookup"><span data-stu-id="cc091-131">Doing this simultaneously assures that the **InkAnalyzer** always has the most recent information.</span></span>
    3.  <span data-ttu-id="cc091-132">Приложение вызывает [**баккграунданализе**](iinkanalyzer-backgroundanalyze.md) для [**InkAnalyzer**](inkanalyzer.md) , чтобы начать анализ.</span><span class="sxs-lookup"><span data-stu-id="cc091-132">The application calls [**BackgroundAnalyze**](iinkanalyzer-backgroundanalyze.md) on the [**InkAnalyzer**](inkanalyzer.md) to begin analysis.</span></span>
4.  <span data-ttu-id="cc091-133">Если изменение включает рукописный ввод и [**InkAnalyzer**](inkanalyzer.md) определяет новые результаты, запускается ряд событий.</span><span class="sxs-lookup"><span data-stu-id="cc091-133">A series of events is fired if the change involves ink and the [**InkAnalyzer**](inkanalyzer.md) determines new results.</span></span> <span data-ttu-id="cc091-134">Для каждого изменения, внесенного в коллекцию объектов [**контекстноде**](icontextnode.md) в **InkAnalyzer**, срабатывает одно событие.</span><span class="sxs-lookup"><span data-stu-id="cc091-134">One event is fired for each change made to the collection of [**ContextNode**](icontextnode.md) objects in the **InkAnalyzer**.</span></span> <span data-ttu-id="cc091-135">К этим событиям относятся [**контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md), [**контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md), [**контекстнодемовингтопоситион**](-ianalysisproxyevents-contextnodemovingtoposition.md), [**контекстнодепропертиесупдатед**](-ianalysisproxyevents-contextnodepropertiesupdated.md), [**ContextNodeLinkAdding**](-ianalysisproxyevents-contextnodelinkadding.md), [**ContextNodeLinkDeleting**](-ianalysisproxyevents-contextnodelinkdeleting.md)и [**ContextNodeReparenting**](-ianalysisproxyevents-contextnodereparenting.md).</span><span class="sxs-lookup"><span data-stu-id="cc091-135">These events include [**ContextNodeCreated**](-ianalysisproxyevents-contextnodecreated.md), [**ContextNodeDeleting**](-ianalysisproxyevents-contextnodedeleting.md), [**ContextNodeMovingToPosition**](-ianalysisproxyevents-contextnodemovingtoposition.md), [**ContextNodePropertiesUpdated**](-ianalysisproxyevents-contextnodepropertiesupdated.md), [**ContextNodeLinkAdding**](-ianalysisproxyevents-contextnodelinkadding.md), [**ContextNodeLinkDeleting**](-ianalysisproxyevents-contextnodelinkdeleting.md), and [**ContextNodeReparenting**](-ianalysisproxyevents-contextnodereparenting.md).</span></span> <span data-ttu-id="cc091-136">Приложение обрабатывает эти события для прокси результатов операции анализа обратно в модель документа, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="cc091-136">The application handles these events to proxy the results of the analysis operation back into the document model as appropriate.</span></span>
5.  <span data-ttu-id="cc091-137">Приложение обновляет макет документа, потянув новые данные из модели документа.</span><span class="sxs-lookup"><span data-stu-id="cc091-137">The application updates the layout of the document, pulling the new data from the document model.</span></span>
6.  <span data-ttu-id="cc091-138">Новые данные отготовятся к конечному пользователю.</span><span class="sxs-lookup"><span data-stu-id="cc091-138">The new data is rendered back to the end user.</span></span>

### <a name="on-demand-update"></a><span data-ttu-id="cc091-139">Обновление по запросу</span><span class="sxs-lookup"><span data-stu-id="cc091-139">On-Demand Update</span></span>

<span data-ttu-id="cc091-140">Подход по запросу требует передачи данных только для тех объектов [**контекстноде**](icontextnode.md) , которые находятся в анализируемых областях.</span><span class="sxs-lookup"><span data-stu-id="cc091-140">The on-demand approach only requires the data to be passed for those [**ContextNode**](icontextnode.md) objects that are in the areas that are being analyzed.</span></span> <span data-ttu-id="cc091-141">Необходимые объекты **контекстноде** извлекаются из модели документа приложения сразу после вызова операции анализа, а также перед согласованием результатов.</span><span class="sxs-lookup"><span data-stu-id="cc091-141">The needed **ContextNode** objects are extracted from the application's document model just after the analysis operation is invoked, and again just prior to reconciling the results.</span></span> <span data-ttu-id="cc091-142">Хотя реализация по сравнению с синхронными обновлениями сложнее, этот подход дает лучшие результаты производительности.</span><span class="sxs-lookup"><span data-stu-id="cc091-142">While more complicated to implement than synchronous updates, this approach yields better performance results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cc091-143">См. также</span><span class="sxs-lookup"><span data-stu-id="cc091-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cc091-144">Обзор анализа рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="cc091-144">Ink Analysis Overview</span></span>](ink-analysis-overview.md)
</dt> <dt>

[<span data-ttu-id="cc091-145">**Класс InkAnalyzer (C++)**</span><span class="sxs-lookup"><span data-stu-id="cc091-145">**InkAnalyzer Class (C++)**</span></span>](inkanalyzer.md)
</dt> <dt>

<span data-ttu-id="cc091-146">[**Microsoft. Ink. InkAnalyzer**](/previous-versions/ms583671(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="cc091-146">[**Microsoft.Ink.InkAnalyzer**](/previous-versions/ms583671(v=vs.100))</span></span>
</dt> <dt>

<span data-ttu-id="cc091-147">[**Microsoft. Ink. Контекстноде**](/previous-versions/ms551996(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="cc091-147">[**Microsoft.Ink.ContextNode**](/previous-versions/ms551996(v=vs.100))</span></span>
</dt> </dl>

 

 
