---
description: Панель ввода Microsoft Tablet PC — это мощный инструмент для ввода рукописного текста с помощью пера и исправления текста без использования клавиатуры.
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: Включение исправления текста для пользовательских сборов рукописных данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104568450"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a><span data-ttu-id="a26af-103">Включение исправления текста для пользовательских сборов рукописных данных</span><span class="sxs-lookup"><span data-stu-id="a26af-103">Enabling Text Correction for Custom Ink Collectors</span></span>

<span data-ttu-id="a26af-104">Панель ввода Microsoft Tablet PC — это мощный инструмент для ввода рукописного текста с помощью пера и исправления текста без использования клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="a26af-104">Microsoft Tablet PC Input Panel is a powerful tool for entering handwritten text with a pen and correcting text without the use of a keyboard.</span></span> <span data-ttu-id="a26af-105">При использовании панели ввода пользователь вводит текст путем ввода текста на поверхности рукописного ввода, что заставляет панель ввода распознавать рукописный ввод пользователя как текст.</span><span class="sxs-lookup"><span data-stu-id="a26af-105">When using Input Panel, a user enters text by handwriting onto Input Panel's inking surfaces, which causes Input Panel to recognize the user's handwriting as text.</span></span> <span data-ttu-id="a26af-106">После того как текст будет распознан, пользователь нажмет «вставить» на панели ввода, чтобы вставить текст в приложение или документ.</span><span class="sxs-lookup"><span data-stu-id="a26af-106">Once the text has been recognized, the user taps Insert on Input Panel to insert the text into an application or document.</span></span> <span data-ttu-id="a26af-107">Перед вставкой текста пользователь имеет доступ к набору средств исправления на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="a26af-107">Prior to inserting the text, a user has access to a set of correction tools in Input Panel.</span></span> <span data-ttu-id="a26af-108">В их число входит выбор альтернативного результата распознавания, возможность перезаписи одного символа или даже для вычеркивания всего слова и перезаписи.</span><span class="sxs-lookup"><span data-stu-id="a26af-108">These include the selection of an alternative recognition result, the ability to rewrite a single character, or even to scratch-out the entire word and rewrite.</span></span> <span data-ttu-id="a26af-109">Эти средства исправления позволяют пользователю исправить как ошибки распознавания, так и человеческие ошибки.</span><span class="sxs-lookup"><span data-stu-id="a26af-109">These correction tools enable a user to correct both recognition errors and human errors.</span></span>

<span data-ttu-id="a26af-110">После того, как текст, введенный с помощью панели ввода, находится в документе, пользователи получают доступ к тем же функциям исправления, которые доступны до вставки в приложения, основанные на [платформах текстовых служб](/windows/desktop/TSF/text-services-framework)Windows и приложениях с поддержкой текстовых служб.</span><span class="sxs-lookup"><span data-stu-id="a26af-110">Once the text entered using Input Panel is in the document, users have access to the same correction functionality that is available prior to insertion in Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)-based and Text Services-enabled applications.</span></span> <span data-ttu-id="a26af-111">Начиная с Microsoft Windows XP с пакетом обновления 2 Tablet PC Edition все приложения с богатыми возможностями редактирования являются текстовыми службами. по умолчанию в Windows Vista приложения HTML являются текстовыми службами, по умолчанию включенными.</span><span class="sxs-lookup"><span data-stu-id="a26af-111">Starting in Microsoft Windows XP Service Pack 2 Tablet PC Edition all Rich Edit applications are Text Services-enabled by default, and starting in Windows Vista, HTML applications are Text Services-enabled by default.</span></span> <span data-ttu-id="a26af-112">Исправление в документе доступно только в приложениях, основанных на службах текста и поддерживающих текстовые службы. Это обусловлено тем, что панель ввода зависит от возможности службы текста для хранения связанных текстовых свойств, включая рукописные объекты и варианты распознавания, чтобы обеспечить возможность внесения изменений в документ.</span><span class="sxs-lookup"><span data-stu-id="a26af-112">In-document correction is only available in Text Service based and enabled applications; this is because Input Panel is dependent on Text Service's capability to store associated text properties, including ink objects and recognition alternates, in order to provide in-document correction.</span></span>

![панель ввода Tablet PC с исправлением текста](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

<span data-ttu-id="a26af-114">Однако существует множество сценариев, в том числе исправление распознавания речи или исправления введенного текста в дороге, которые не начинаются с текстового ввода с помощью панели ввода, но для пользователей планшетных ПК может оказаться очень полезным исправление в документе.</span><span class="sxs-lookup"><span data-stu-id="a26af-114">There are, however, numerous scenarios, including correcting speech recognition or correcting typed text on the go, that do not start with text entry using Input Panel but in which in-document correction can be extremely useful for Tablet PC users.</span></span> <span data-ttu-id="a26af-115">Простым примером является использование приложений, предоставляющих пользовательские поверхности рукописного ввода для ввода текста с помощью пера.</span><span class="sxs-lookup"><span data-stu-id="a26af-115">A prime example is in applications that provide custom inking surfaces for entering text using a pen.</span></span> <span data-ttu-id="a26af-116">Пользовательские поверхности рукописного ввода — это отличный способ предоставить приложениям уникально специализированную функциональность, относящуюся к задачам ввода текста для каждого приложения.</span><span class="sxs-lookup"><span data-stu-id="a26af-116">Custom inking surfaces are a great way for applications to provide uniquely tailored functionality specific to the text entry tasks of each application.</span></span> <span data-ttu-id="a26af-117">Кроме того, пользовательские поверхности для рукописного ввода предоставляют полностью интегрированный пользовательский интерфейс Tablet PC, что делает его более четким, чем первое устройство ввода в приложениях, содержащих их.</span><span class="sxs-lookup"><span data-stu-id="a26af-117">Additionally, custom inking surfaces provide a fully integrated Tablet PC user experience, which makes it clear the pen is a first class input device in applications that contain them.</span></span> <span data-ttu-id="a26af-118">Однако приложения, предоставляющие пользовательские поверхности для рукописного ввода, могут не допускать и не предоставлять такой же уровень поддержки исправлений, который доступен при исправлении в документе на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="a26af-118">However, applications that provide custom inking surfaces may not allow or may not be able to provide the same level of correction support that is available from Input Panel in-document correction.</span></span>

![Пользовательский сборщик рукописных данных](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

<span data-ttu-id="a26af-120">Приложения, основанные на текстовых службах, в которых функция исправления в документе полезна для исправления текста, не введенного с помощью панели ввода, может использовать [**ихандвриттентекстинсертион**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API панели ввода (класс [Microsoft. TextInput. хандвриттентекстинсертион](/previous-versions/ms573516(v=vs.100)) в управляемом коде) для включения исправления в документе для текста, введенного другими средствами.</span><span class="sxs-lookup"><span data-stu-id="a26af-120">Text Services based or enabled applications in which in-document correction is useful for correction of text not entered using Input Panel are able to use Input Panel's [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API ([Microsoft.TextInput.HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) class in managed code)to enable in-document correction for text entered by other means.</span></span> <span data-ttu-id="a26af-121">Таким образом, приложения могут в значительной мере добавить мощную поддержку исправления для собственных поверхностей рукописного ввода или других сценариев ввода текста, а также округлить историю ввода текста Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="a26af-121">In this way, applications can cheaply add powerful correction support to their custom inking surfaces or other text entry scenarios, and round out their Tablet PC text entry story.</span></span> <span data-ttu-id="a26af-122">API панели ввода Ихандвриттентекстинсертион входит в состав операционной системы Windows Vista и в составе пакета SDK для платформы планшетов версии 1,9 или более поздней.</span><span class="sxs-lookup"><span data-stu-id="a26af-122">The Input Panel IHandWrittenTextInsertion API is included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or newer.</span></span> <span data-ttu-id="a26af-123">Включены версии API на основе .NET и COM.</span><span class="sxs-lookup"><span data-stu-id="a26af-123">Both a .NET and COM based version of the API are included.</span></span> <span data-ttu-id="a26af-124">Включение исправления в документе для текста, не введенного с помощью панели ввода, поддерживается в Windows Vista и более новых версиях.</span><span class="sxs-lookup"><span data-stu-id="a26af-124">Enabling in-document correction for text not entered using Input Panel is supported on Windows Vista and newer.</span></span> <span data-ttu-id="a26af-125">Исправление в документе доступно только для латинских языков и не может отображать любой символ за пределами Латинской кодировки.</span><span class="sxs-lookup"><span data-stu-id="a26af-125">In-document correction is only available for Latin languages and is unable to display any character outside the Latin character set.</span></span>

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a><span data-ttu-id="a26af-126">Как использовать API Хандвриттентекстинсертион в приложении</span><span class="sxs-lookup"><span data-stu-id="a26af-126">How to Use the HandwrittenTextInsertion API in an Application</span></span>

<span data-ttu-id="a26af-127">Необходимые изменения в приложении, позволяющие интегрировать панель ввода в документ исправление для текста, не введенного с помощью панели ввода, и использовать API [**ихандвриттентекстинсертион**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) очень просто.</span><span class="sxs-lookup"><span data-stu-id="a26af-127">The required changes to an application in order to integrate Input Panel in-document correction for text not entered using Input Panel and using the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API are straightforward.</span></span> <span data-ttu-id="a26af-128">Все пользовательские коды ввода текста в приложении остаются без изменений, за исключением последнего шага.</span><span class="sxs-lookup"><span data-stu-id="a26af-128">All of the application's custom text entry code remains unchanged except for the last step.</span></span> <span data-ttu-id="a26af-129">В момент, когда текст, указанный с помощью пользовательской области рукописного ввода, распознавания речи или других средств, отображается в текстовом поле Text Services Enabled (текстовые поля с поддержкой текста), приложение отправляет текст в интерфейс **ихандвриттентекстинсертион** , а не отправляет его непосредственно в текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="a26af-129">At the point at which text entered using a custom inking surface, speech recognition, or other means is to be displayed in a text services enabled text field, the application sends the text to the **IHandWrittenTextInsertion** interface instead of sending it directly to the text field.</span></span> <span data-ttu-id="a26af-130">Затем компонент программируемой панели ввода обрабатывает вставку текста в текстовое поле и в резервное хранилище текстовых служб.</span><span class="sxs-lookup"><span data-stu-id="a26af-130">The Input Panel programmability component then handles inserting the text into both the text field and the Text Services backing-store.</span></span> <span data-ttu-id="a26af-131">При добавлении текста в резервное хранилище текстовых служб компонент "программирование" панели ввода обрабатывает свойства текста, необходимые для панели ввода для исправления в документе, которое должно быть включено для этого текста.</span><span class="sxs-lookup"><span data-stu-id="a26af-131">When adding the text to the Text Services backing-store, the Input Panel programmability component handles setting the text properties that are required by Input Panel for in-document correction to be enabled for that text.</span></span>

<span data-ttu-id="a26af-132">В следующем разделе подробно описывается этот процесс для приложения C++, использующего COM-версию API [**ихандвриттентекстинсертион**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) .</span><span class="sxs-lookup"><span data-stu-id="a26af-132">The following section walks through this process in detail for a C++ application using the COM version of the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API.</span></span> <span data-ttu-id="a26af-133">Существуют примечания в любом месте, где вы используете версию платформа .NET Framework API в языке C, \# отличаются для использования версии COM в C++.</span><span class="sxs-lookup"><span data-stu-id="a26af-133">There are notes anywhere the steps for using the .NET Framework version of the API in C\# differ for the using COM version in C++.</span></span> <span data-ttu-id="a26af-134">Управляемый API **хандвриттентекстинсертион** включает один COM-интерфейс **ихандвриттентекстинсертион**.</span><span class="sxs-lookup"><span data-stu-id="a26af-134">The managed **HandwrittenTextInsertion** API includes a single COM interface, **IHandwrittenTextInsertion**.</span></span> <span data-ttu-id="a26af-135">Определение этого интерфейса находится в Пенинпутпанел. h и Пенинпутпанел \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="a26af-135">The definition for this interface is located in PenInputPanel.h and PenInputPanel\_i.c.</span></span>

<span data-ttu-id="a26af-136">Во первых, приложение должно использовать функцию [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) для создания экземпляра [**ихандвриттентекстинсертион**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) с идентификатором класса **CLSID \_ хандвриттентекстинсертион**.</span><span class="sxs-lookup"><span data-stu-id="a26af-136">First, the application should use the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) with class id **CLSID\_HandwrittenTextInsertion**.</span></span> <span data-ttu-id="a26af-137">Обратите внимание, что создание объекта **CLSID \_ хандвриттентекстинсертион** будет выполнено только после создания окна и получения фокуса, так как пока не будет активировано резервное хранилище текстовых служб.</span><span class="sxs-lookup"><span data-stu-id="a26af-137">Note that the creation of a **CLSID\_HandwrittenTextInsertion** object will succeed only after a window is created and given focus, because until then the Text Services backing-store is not activated.</span></span> <span data-ttu-id="a26af-138">Кроме того, если tiptsf.dll отсутствует в системе, функция **CoCreateInstance** завершается с ошибкой и возвращает **регдб \_ E \_ класснотрег**, что указывает на то, что в системе не поддерживается исправление в документе для панели ввода.</span><span class="sxs-lookup"><span data-stu-id="a26af-138">Additionally, if tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**, indicating that Input Panel in-document correction is not supported on the system.</span></span> <span data-ttu-id="a26af-139">На этом этапе приложение должно быть продолжено без попытки включить исправление для панели ввода в документе.</span><span class="sxs-lookup"><span data-stu-id="a26af-139">At this point the application should proceed without trying to enable Input Panel in-document correction.</span></span> <span data-ttu-id="a26af-140">Экземпляр **хандвриттентекстинсертион** должен быть доступен из кода приложения, который обрабатывает вставку текста в текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="a26af-140">The instance of **HandwrittenTextInsertion** must be accessible from the application's code that handles inserting text into a text field.</span></span>

> [!Note]  
> <span data-ttu-id="a26af-141">При работе с платформа .NET Frameworkной версией API приложение должно добавить инструкцию using, чтобы разрешить доступ к пространству имен [Microsoft. Ink. TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) , а затем создать объект напрямую.</span><span class="sxs-lookup"><span data-stu-id="a26af-141">When working with the .NET Framework version of the API, the application should add a using statement to allow access to the [Microsoft.Ink.TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) namespace and then create the object directly.</span></span>

 

<span data-ttu-id="a26af-142">Во-вторых, код приложения, отвечающий за вставку текста в текстовое поле, должен быть изменен таким образом, чтобы он больше не вставил текст в текстовое поле, но вместо этого вызывается один или второй из двух методов вставки [**ихандвриттентекстинсертион**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion).</span><span class="sxs-lookup"><span data-stu-id="a26af-142">Second, the application's code that is responsible for inserting text into a text field must be altered so that it no longer inserts text into a text field directly, but calls one or the other of [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)'s two insertion methods instead.</span></span> <span data-ttu-id="a26af-143">Должны ли приложения вызывать [**инсертрекогнитионресултсаррай**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) или [**инсертрекогнитионресултс**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) , зависит от того, имеет ли приложение варианты распознавания для текста, хранящегося как массив или как объект [**иинкрекогнитионресулт**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) .</span><span class="sxs-lookup"><span data-stu-id="a26af-143">Whether the applications should choose to call [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) or [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depends on whether the application has the recognition alternates for the text stored as an array or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) object.</span></span>

> [!Note]  
> <span data-ttu-id="a26af-144">При работе в управляемом коде соответствующий объект поощрения, используемый Инсертрекогнитионресултсаррай, — это [рекогнитионресулт](/previous-versions/ms552537(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="a26af-144">When working in managed code, the corresponding recognition object consumed by InsertRecognitionResultsArray is [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span></span> <span data-ttu-id="a26af-145">Оба метода используют следующие три параметра:</span><span class="sxs-lookup"><span data-stu-id="a26af-145">Both methods consume the following three parameters:</span></span>

 

-   <span data-ttu-id="a26af-146">*альтернативные варианты* — Это многомерная коллекция строк, сохраненная либо в виде массива массивов, либо в виде объекта [**иинкрекогнитионресулт**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (или [рекогнитионресулт](/previous-versions/ms552537(v=vs.100))).</span><span class="sxs-lookup"><span data-stu-id="a26af-146">*alternates* Is a two dimensional collection of strings, stored either as an array of arrays or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (or [RecognitionResult](/previous-versions/ms552537(v=vs.100))) object.</span></span> <span data-ttu-id="a26af-147">Если альтернативные варианты хранятся в виде массива массивов, то они должны передаваться как указатель безопасного массива.</span><span class="sxs-lookup"><span data-stu-id="a26af-147">If the alternates are stored as an array of arrays, then it should be passed as a safe array pointer.</span></span> <span data-ttu-id="a26af-148">Каждая запись в массиве верхнего уровня представляет собой список вариантов для одного слова в вставке.</span><span class="sxs-lookup"><span data-stu-id="a26af-148">Each entry in the top level array is a list of alternates for a single word in the insertion.</span></span> <span data-ttu-id="a26af-149">Запись в позиции нуль в подмассивах альтернативы — это текст, вставляемый в текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="a26af-149">The entry at position zero in the sub-arrays of alternates is the text that is inserted into the text field.</span></span> <span data-ttu-id="a26af-150">Дополнительные варианты (индексы 1 – n в каждом подмассиве) хранятся в резервном хранилище текстовых служб и предлагаются пользователю в качестве параметров в процессе исправления в документе.</span><span class="sxs-lookup"><span data-stu-id="a26af-150">The additional alternates (indices 1 through n in each sub-array) are stored in the Text Services backing-store and offered to the user as choices as part of in-document correction.</span></span> <span data-ttu-id="a26af-151">Если альтернативы не включены, пользователь увидит вместо списка вариантов вариант "без предложения".</span><span class="sxs-lookup"><span data-stu-id="a26af-151">If alternates are not included, then the user sees 'No suggestion' in place of the list of alternates.</span></span> <span data-ttu-id="a26af-152">Если вставка содержит несколько слов с пробелами, то каждое пространство должно быть указано в качестве записи в массиве верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="a26af-152">If an insertion contains multiple words with spaces between them, then each space must be included as an entry in the top level array.</span></span>
-   <span data-ttu-id="a26af-153">*языковая* [Код](/previous-versions/ms221397(v=vs.71)) языка ввода, соответствующий тексту, содержащемуся в параметре " *альтернативные* ".</span><span class="sxs-lookup"><span data-stu-id="a26af-153">*language* The Input Language [LCID](/previous-versions/ms221397(v=vs.71)) that corresponds to the text contained in the *alternates* parameter.</span></span> <span data-ttu-id="a26af-154">В случае, когда содержимое *альтернативы* было создано распознавателем рукописного ввода или распознавания речи, это также свойство [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) , связанное с используемым распознавателем.</span><span class="sxs-lookup"><span data-stu-id="a26af-154">In the case in which the contents of *alternates* was generated by a handwriting or speech recognizer, this is also the [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) property associated with the recognizer used.</span></span>
-   <span data-ttu-id="a26af-155">*флаттицеконтаинсаутоспаЦингинформатион* Флаг, указывающий, был ли текст, содержащийся в параметре *alternate* , создан распознавателем с включенным автоматическим промежутком.</span><span class="sxs-lookup"><span data-stu-id="a26af-155">*fLatticeContainsAutoSpacingInformation* A flag indicating whether the text contained in the *alternates* parameter was generated by a recognizer with auto-spacing enabled.</span></span> <span data-ttu-id="a26af-156">Если включен автоматический отступ, то флаг должен иметь значение **true**.</span><span class="sxs-lookup"><span data-stu-id="a26af-156">If auto-spacing was enabled, then the flag should be set to **TRUE**.</span></span> <span data-ttu-id="a26af-157">Если автоматическое разделение отключено, то флагу должно быть присвоено значение **false**.</span><span class="sxs-lookup"><span data-stu-id="a26af-157">If auto-spacing was disabled, then the flag should be set to **FALSE**.</span></span> <span data-ttu-id="a26af-158">В случае, когда содержимое *альтернативных* элементов было создано распознавателем, который не поддерживает автоматическое создание интервалов или не был создан распознавателем, то флаг должен иметь значение **false**.</span><span class="sxs-lookup"><span data-stu-id="a26af-158">In the case in which the contents of *alternates* was generated by a recognizer that does not support auto-spacing, or was not generated by a recognizer at all, then the flag should be set to **FALSE**.</span></span>

<span data-ttu-id="a26af-159">Модель программируемости панели ввода может вставить текст в документ или приложение из позиции системного курсора.</span><span class="sxs-lookup"><span data-stu-id="a26af-159">Input Panel's programmability model is able to insert the text in the document or application from the position of the system caret.</span></span>

<span data-ttu-id="a26af-160">При успешном вставке оба метода возвращают значение **S \_ ОК** .</span><span class="sxs-lookup"><span data-stu-id="a26af-160">Both methods return **S\_OK** if the insertion succeeds.</span></span> <span data-ttu-id="a26af-161">Они возвращают **E без \_ интерфейса** , если приложение не основано на текстовых службах и не включено, а **E \_ INVALIDARG** , если *варианты* неверно форматированы или недоступны.</span><span class="sxs-lookup"><span data-stu-id="a26af-161">They return **E\_NOINTERFACE** if the application is not Text Services based or enabled, and **E\_INVALIDARG** if *alternates* is improperly formatted or inaccessible.</span></span> <span data-ttu-id="a26af-162">Они также могут возвращать **E \_ OUTOFMEMORY** , если в системе не хватает памяти **, или после неустранимого сбоя, \_ например** при отключении платформы текстовых служб.</span><span class="sxs-lookup"><span data-stu-id="a26af-162">They may also return **E\_OUTOFMEMORY** if there is not enough memory available on the system, or **E\_FAIL** after a catastrophic failure such as the Text Services Framework not being enabled.</span></span>

### <a name="conclusion"></a><span data-ttu-id="a26af-163">Заключение</span><span class="sxs-lookup"><span data-stu-id="a26af-163">Conclusion</span></span>

<span data-ttu-id="a26af-164">Включение исправления в документе на панели ввода для текста, не введенного с помощью панели ввода, является недорогым и простым способом для приложения, основанного на текстовых службах или поддерживающего пользовательскую функцию рукописного ввода или входа с мощными функциями исправления на основе пера.</span><span class="sxs-lookup"><span data-stu-id="a26af-164">Enabling Input Panel in-document correction for text not entered using Input Panel is a cheap and easy way for a Text Services based or enabled application to supplement a custom inking or input method with powerful pen-based correction functionality.</span></span> <span data-ttu-id="a26af-165">В Windows Vista все приложения с расширенными возможностями редактирования и Trident являются включенными текстовыми службами.</span><span class="sxs-lookup"><span data-stu-id="a26af-165">On Windows Vista, all Rich Edit and Trident applications are Text Services enabled.</span></span> <span data-ttu-id="a26af-166">В то время как встроенные поверхности рукописного ввода являются отличным вариантом для добавления пользовательского интерфейса Tablet PC в приложение, они поддерживают только половину текстового ввода, если они не включают возможности исправления.</span><span class="sxs-lookup"><span data-stu-id="a26af-166">While integrated inking surfaces are a great option for adding a custom Tablet PC user experience to an application, they only support half of text entry if they do not include correction capabilities.</span></span> <span data-ttu-id="a26af-167">Функция исправления в документе позволяет пользователям с другой половиной, добавив возможность поменять местами выбранный вариант распознавания или переписать часть или весь выбор.</span><span class="sxs-lookup"><span data-stu-id="a26af-167">In-document correction provides users with the other half of the story by adding the ability to swap a selection for a recognition alternate, or to rewrite part or all of the selection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a26af-168">См. также</span><span class="sxs-lookup"><span data-stu-id="a26af-168">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a26af-169">Программирование панели ввода текста</span><span class="sxs-lookup"><span data-stu-id="a26af-169">Programming the Text Input Panel</span></span>](programming-the-text-input-panel.md)
</dt> </dl>

 

 
