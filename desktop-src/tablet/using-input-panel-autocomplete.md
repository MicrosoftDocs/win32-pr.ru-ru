---
description: В Windows Vista панель ввода Tablet PC интегрирует новые возможности автозаполнения, позволяющие обновлять список автозаполнения приложения в режиме реального времени по мере того, как рукописный ввод пользователя распознается на панели ввода.
ms.assetid: 0f01f546-f76b-4c61-a204-2a06079a374a
title: Использование автозаполнения панели ввода
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9e7f108631eb2723b71bf8ed919c17a0eabff5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144767"
---
# <a name="using-input-panel-autocomplete"></a><span data-ttu-id="4f0bb-103">Использование автозаполнения панели ввода</span><span class="sxs-lookup"><span data-stu-id="4f0bb-103">Using Input Panel AutoComplete</span></span>

<span data-ttu-id="4f0bb-104">В Windows Vista панель ввода Tablet PC интегрирует новые возможности автозаполнения, позволяющие обновлять список автозаполнения приложения в режиме реального времени по мере того, как рукописный ввод пользователя распознается на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-104">In Windows Vista, Tablet PC Input Panel integrates new Autocomplete capabilities that enable an application's Autocomplete list to update in real time as a user's ink is recognized in Input Panel.</span></span> <span data-ttu-id="4f0bb-105">Кроме того, список автозаполнения приложения располагается в удобном месте для пользователей панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-105">Additionally, the application's Autocomplete list is positioned in a convenient location for users of Input Panel.</span></span> <span data-ttu-id="4f0bb-106">Без автозаполнения панели ввода, использование функций автозаполнения с панелью ввода является сложным процессом, требующим от пользователей вставки одного символа за раз и перемещения панели ввода для доступа к предложениям автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-106">Without Input Panel Autocomplete, using Autocomplete features with Input Panel is a difficult process, requiring users to insert one character at a time and move Input Panel in order to access Autocomplete suggestions.</span></span> <span data-ttu-id="4f0bb-107">Благодаря интеграции Автозаполнение — это мощное средство для пользователей планшетных ПК, которое ускоряет и повышает удобство ввода текста с помощью панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-107">With integration, Autocomplete is a powerful tool for Tablet PC users that speeds up and increases the ease of entering text with Input Panel.</span></span>

![панель ввода с помощью списка автозаполнения в IE](images/9e769482-543a-4e29-b274-8f19ae10250d.jpg)

<span data-ttu-id="4f0bb-109">Существует три способа, с помощью которых приложение может использовать преимущества интеграции автозаполнения на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-109">There are three options for how an application can take advantage of Input Panel Autocomplete integration.</span></span> <span data-ttu-id="4f0bb-110">Приложения, которые содержат функции автозаполнения, созданные с помощью автозаполнения оболочки (через интерфейс [**иаутокомплете**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) ) или платформа .NET Framework Автозаполнение (через перечисление [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) ), получают интеграцию с автозаполнением на панели ввода, не требуя изменения кода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-110">Applications that contain Autocomplete functionality built using Shell Autocomplete (through the [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) interface) or .NET Framework Autocomplete (through the [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) Enumeration) receive Input Panel Autocomplete integration without the need for code changes.</span></span> <span data-ttu-id="4f0bb-111">Приложения, содержащие пользовательские текстовые поля автозаполнения, могут использовать API автозаполнения панели ввода для получения тех же функций.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-111">Applications that include custom Autocomplete text fields can use the Input Panel Autocomplete API to get the same functionality.</span></span>

<span data-ttu-id="4f0bb-112">Во всех случаях эти изменения можно внести в список автозаполнения приложения без дублирования или изменения пользовательского интерфейса или логики прогноза, используемой приложением для создания списка автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-112">In all cases, you can make these modifications to the application's Autocomplete list without duplicating or modifying the UI or prediction logic used by an application to generate an Autocomplete list.</span></span> <span data-ttu-id="4f0bb-113">Список автозаполнения по своим владельцам будет отображаться в приложении, а содержимое списка автозаполнения будет таким же, как если бы текст был введен непосредственно в поле редактирования.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-113">The Autocomplete list continues to be owner drawn by the application and the contents of the Autocomplete list are the same as if the text were typed directly into the edit field.</span></span>

<span data-ttu-id="4f0bb-114">Интеграция автозаполнения на панели ввода поддерживается в операционной системе Windows Vista или более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-114">Input Panel Autocomplete integration is supported on the Windows Vista operating system or later versions.</span></span> <span data-ttu-id="4f0bb-115">Интеграция автозаполнения на панели ввода встроена в оболочку PowerShell, начиная с Windows Vista и Windows Forms разработки, начиная с версии платформа .NET Framework 3,0.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-115">Input Panel Autocomplete integration is built into Shell Autocomplete starting with Windows Vista and into Windows Forms development starting with .NET Framework version 3.0.</span></span> <span data-ttu-id="4f0bb-116">Хотя [**иаутокомплете**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) и [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) работают в более ранних версиях Windows, интеграция автозаполнения на панели ввода не поддерживается в Microsoft Windows XP Tablet PC Edition или более ранних операционных системах.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-116">While [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) both run on earlier versions of Windows, Input Panel Autocomplete integration is not supported on Microsoft Windows XP Tablet PC Edition or earlier operating systems.</span></span> <span data-ttu-id="4f0bb-117">Если автозаполнение панели ввода выполняется в более ранних версиях Tablet PC, приложения возвращаются к поведению до интеграции.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-117">If you run Input Panel Autocomplete on earlier versions of Tablet PC, applications revert to the pre-integration behavior.</span></span>

## <a name="reasons-to-integrate-application-autocomplete-lists-with-input-panel"></a><span data-ttu-id="4f0bb-118">Причины для интеграции списков автозаполнения приложений с панелью ввода</span><span class="sxs-lookup"><span data-stu-id="4f0bb-118">Reasons to Integrate Application Autocomplete Lists with Input Panel</span></span>

<span data-ttu-id="4f0bb-119">Интеграция списка автозаполнения приложения обеспечивает максимальную простоту и скорость ввода для пользователей, которые вводит текст в текстовое поле, включающее функцию автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-119">Integration of an application's Autocomplete list enables the maximum ease and speed of input for users who are entering text into a text field that includes Autocomplete functionality.</span></span> <span data-ttu-id="4f0bb-120">Кроме того, приложение, включающее в себя интеграцию с автозаполнением панели ввода, сразу же выглядит так, как если бы оно было разработано с планшетным ПК, что делает приложение более привлекательным для пользователей планшетных ПК.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-120">Furthermore, an application that includes Input Panel Autocomplete integration immediately appears as if it were developed with the Tablet PC in mind, making the application more appealing to Tablet PC users.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interact-without-integration"></a><span data-ttu-id="4f0bb-121">Взаимодействие панели ввода и списка автозаполнения без интеграции</span><span class="sxs-lookup"><span data-stu-id="4f0bb-121">How Input Panel and Autocomplete List Interact without Integration</span></span>

<span data-ttu-id="4f0bb-122">Использование панели ввода для ввода текста в текстовое поле, включающее список автозаполнения, но не интегрированную с панелью ввода:</span><span class="sxs-lookup"><span data-stu-id="4f0bb-122">Using Input Panel to enter text into a text field that includes an Autocomplete list but that is not integrated with Input Panel:</span></span>

1.  <span data-ttu-id="4f0bb-123">Пользователь помещает фокус в текстовое поле и открывает панель ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-123">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="4f0bb-124">Пользователь записывает один или два символа.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-124">The user writes one or two characters.</span></span>
3.  <span data-ttu-id="4f0bb-125">Пользователь касается **вставки**.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-125">The user taps **Insert**.</span></span> <span data-ttu-id="4f0bb-126">Панель ввода вводит текст в текстовое поле приложения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-126">Input Panel enters the text into the application's text field.</span></span> <span data-ttu-id="4f0bb-127">Отображается список автозаполнения приложения, который, скорее всего, частично или полностью скрыт панелью ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-127">The application's Autocomplete list appears and is most likely partially or completely obscured by Input Panel.</span></span>
4.  <span data-ttu-id="4f0bb-128">Пользователь перетаскивает панель ввода для обнаружения списка автозаполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-128">The user drags Input Panel to uncover the application's Autocomplete list.</span></span>
5.  <span data-ttu-id="4f0bb-129">Если в список автозаполнения включена правильная запись, пользователь может выбрать эту запись. в противном случае пользователь должен повторить шаги 2 и 3.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-129">Assuming the correct entry is included in the Autocomplete list, the user can now select that entry; otherwise the user must repeat steps 2 and 3.</span></span>

<span data-ttu-id="4f0bb-130">Это, очевидно, громоздкий процесс.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-130">This is clearly a cumbersome process.</span></span> <span data-ttu-id="4f0bb-131">Ожидание работы пользователя в списке автозаполнения имеет вид штриха и возможность выполнения задач.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-131">The user's expectations of how an Autocomplete list should work are dashed, and their ability to perform tasks suffers.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interaction-improves-with-integration"></a><span data-ttu-id="4f0bb-132">Улучшение взаимодействия с панелью ввода и списком автозаполнения с интеграцией</span><span class="sxs-lookup"><span data-stu-id="4f0bb-132">How Input Panel and Autocomplete List Interaction Improves with Integration</span></span>

<span data-ttu-id="4f0bb-133">Использование панели ввода для ввода текста в текстовое поле, включающее список автозаполнения, интегрированный с панелью ввода:</span><span class="sxs-lookup"><span data-stu-id="4f0bb-133">Using Input Panel to enter text into a text field that includes an Autocomplete list that is integrated with Input Panel:</span></span>

1.  <span data-ttu-id="4f0bb-134">Пользователь помещает фокус в текстовое поле и открывает панель ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-134">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="4f0bb-135">Пользователь записывает один или два символа.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-135">The user writes one or two characters.</span></span> <span data-ttu-id="4f0bb-136">Список автозаполнения приложения отображается непосредственно над панелью ввода или непосредственно под ней при записи текста пользователем.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-136">The application's Autocomplete list appears directly above or directly below Input Panel as the user writes text.</span></span>
3.  <span data-ttu-id="4f0bb-137">Пользователь выбирает запись из списка автозаполнения; запись вставляется непосредственно в текстовое поле приложения, или пользователь повторяет шаг 2, пока не появится правильная запись.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-137">The user selects the entry from the Autocomplete list; the entry is inserted directly into the application's text field, or the user repeats step 2 until the correct entry appears.</span></span>

<span data-ttu-id="4f0bb-138">Из-за интеграции список автозаполнения отображается и обновляется во время записи пользователем на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-138">Due to the integration, the Autocomplete list appears and updates while the user is writing in Input Panel.</span></span> <span data-ttu-id="4f0bb-139">Кроме того, список располагается таким образом, чтобы он был удобен для доступа пользователю при записи, а не скрытой панелью ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-139">Additionally, the list is positioned so that it is both convenient for the user to access while writing and not obscured by Input Panel.</span></span> <span data-ttu-id="4f0bb-140">Наконец, когда пользователь выбирает элемент из списка автозаполнения, элемент вставляется непосредственно в поле ввода текста приложения, тем самым позволяя пользователю обходить шаг вставки текста с панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-140">Lastly, when the user selects an item from an Autocomplete list the item is inserted directly into the application's text entry field, thus enabling the user to bypass the step of inserting text from Input Panel.</span></span>

![панель ввода с перечнем автозаполнения Outlook Express](images/ba59a513-e538-4092-89a6-6d691424dc3d.jpg)

## <a name="standard-autocomplete-components-that-include-input-panel-autocomplete-integration"></a><span data-ttu-id="4f0bb-142">Стандартные компоненты автозаполнения, включающие интеграцию с автозаполнением панели ввода</span><span class="sxs-lookup"><span data-stu-id="4f0bb-142">Standard Autocomplete Components that include Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="4f0bb-143">Как [**иаутокомплете**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) , так и [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) включают встроенную интеграцию автозаполнения панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-143">Both [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) include built-in integration of Input Panel Autocomplete.</span></span> <span data-ttu-id="4f0bb-144">Приложения, использующие любой из этих стандартных компонентов автозаполнения, могут воспользоваться преимуществами функции автозаполнения на панели ввода без дополнительной работы.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-144">Applications using either of these standard Autocomplete components can take advantage of Input Panel Autocomplete functionality with little to no additional work.</span></span> <span data-ttu-id="4f0bb-145">Кроме того, хотя Автозаполнение панели ввода поддерживается только в Windows Vista или в новых версиях операционной системы Windows, приложения, созданные с помощью **иаутокомплете** до выпуска Windows Vista, автоматически выполняют интеграцию с автозаполнением панели ввода при запуске в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-145">Additionally, while Input Panel Autocomplete is only supported on Windows Vista or new versions of the Windows operating system, applications that were built using **IAutoComplete** prior to the release of Windows Vista get Input Panel Autocomplete integration automatically when run on Windows Vista.</span></span> <span data-ttu-id="4f0bb-146">В следующих разделах содержатся дополнительные сведения о конкретных элементах **иаутокомплете** и AutoCompleteMode, включающих интеграцию автозаполнения на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-146">The following sections contain more information about the specific **IAutoComplete** and AutoCompleteMode elements that include Input Panel Autocomplete integration.</span></span>

### <a name="shell-autocomplete-with-input-panel-autocomplete-integration"></a><span data-ttu-id="4f0bb-147">Интеграция автозаполнения оболочки с автозаполнением панели ввода</span><span class="sxs-lookup"><span data-stu-id="4f0bb-147">Shell Autocomplete with Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="4f0bb-148">Приложения, использующие [**иаутокомплете**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) , применяют интеграцию автозаполнения на панели ввода бесплатно.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-148">Applications that use [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) get Input Panel Autocomplete integration for free.</span></span> <span data-ttu-id="4f0bb-149">Хотя интерфейсы API автозаполнения для оболочки включены в Windows 2000, интеграция автозаполнения на панели ввода поддерживается только в Windows Vista и более новых версиях.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-149">While the Shell Autocomplete APIs are included in Windows 2000 onward, Input Panel Autocomplete integration is only support on Windows Vista and newer versions.</span></span> <span data-ttu-id="4f0bb-150">Однако приложения, созданные до выпуска Windows Vista, которые используют **иаутокомплете** , автоматически получают интеграцию автозаполнения панели ввода при запуске в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-150">However, applications built prior to the release of Windows Vista that use **IAutoComplete** automatically get Input Panel Autocomplete integration when run on Windows Vista.</span></span>

<span data-ttu-id="4f0bb-151">Чтобы воспользоваться преимуществами автозаполнения планшета таким образом, необходимо использовать объект автозаполнения (**\_ Автозаполнение CLSID**).</span><span class="sxs-lookup"><span data-stu-id="4f0bb-151">In order to take advantage of Tablet Autocomplete in this way, you must use the autocomplete object (**CLSID\_Autocomplete**).</span></span> <span data-ttu-id="4f0bb-152">Если вы хотите предоставить функцию автозаполнения для URL-адресов или имен файлов, используйте функцию [**шаутокомплете**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) для создания объекта автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-152">If you wish to provide autocomplete functionality for URLs or file names, use the [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) function to create the autocomplete object.</span></span>

<span data-ttu-id="4f0bb-153">В дополнение к [**иаутокомплете**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete)можно напрямую реализовать [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) или [**иаутокомплетедропдовн**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s и по-прежнему автоматически получать автоматическую интеграцию панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-153">In addition to [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete), you can implement [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) or [**IAutoCompleteDropDown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s directly and still get Input Panel Autocomplete integration automatically.</span></span>

### <a name="input-panel-autocomplete-integration-with-net-framework-applications"></a><span data-ttu-id="4f0bb-154">Интеграция автозаполнения панели ввода с приложениями платформа .NET Framework</span><span class="sxs-lookup"><span data-stu-id="4f0bb-154">Input Panel Autocomplete Integration with .NET Framework Applications</span></span>

<span data-ttu-id="4f0bb-155">Начиная с платформа .NET Framework 3,0, Windows Forms текстовые поля включают Автозаполнение.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-155">Starting in .NET Framework 3.0, Windows Forms textboxes include Autocomplete.</span></span> <span data-ttu-id="4f0bb-156">Windows Forms Автозаполнение текстового поля построено на основе автозаполнения оболочки, что означает, что интеграция автозаполнения на панели ввода также встроена.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-156">Windows Forms textbox Autocomplete is built on top of Shell Autocomplete, which means Input Panel Autocomplete integration is built in, too.</span></span> <span data-ttu-id="4f0bb-157">Платформа .NET Framework 3,0 поддерживается в выпусках Windows, выпущенных до Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-157">.NET Framework 3.0 is supported down level on Windows editions released prior to Windows Vista.</span></span> <span data-ttu-id="4f0bb-158">Однако поскольку интеграция автозаполнения на панели ввода поддерживается только в Windows Vista или более поздних версиях, интеграция автозаполнения на панели ввода работает только в приложении платформа .NET Framework 3,0, если оно установлено в Windows Vista или более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-158">However, because Input Panel Autocomplete integration is only supported on Windows Vista or later versions, Input Panel Autocomplete integration only works in a .NET Framework 3.0 application when it is installed on Windows Vista or later versions.</span></span>

<span data-ttu-id="4f0bb-159">Приложения, желающие воспользоваться преимуществами интеграции автозаполнения на панели ввода в платформа .NET Framework 3,0, должны использовать [текстовое поле](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) Windows Forms с включенным свойством [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) .</span><span class="sxs-lookup"><span data-stu-id="4f0bb-159">Applications wishing to take advantage of Input Panel Autocomplete integration in .NET Framework 3.0 must use a Windows Forms [TextBox](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) with the [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) property enabled.</span></span> <span data-ttu-id="4f0bb-160">Чтобы воспользоваться преимуществами интеграции автозаполнения на панели ввода, вам не нужно выполнять дополнительную работу, помимо Windows Forms автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-160">You need not do any additional work beyond getting Windows Forms Autocomplete to work to take advantage of Input Panel Autocomplete integration.</span></span>

## <a name="using-input-panel-autocomplete-apis-directly"></a><span data-ttu-id="4f0bb-161">Непосредственное использование интерфейсов API автозаполнения панели ввода</span><span class="sxs-lookup"><span data-stu-id="4f0bb-161">Using Input Panel Autocomplete APIs Directly</span></span>

<span data-ttu-id="4f0bb-162">Разработчики настраиваемых полей автозаполнения должны работать с интерфейсами API автозаполнения панели ввода напрямую, чтобы получить Улучшенный интерфейс ввода текста, который обеспечивает интеграция автозаполнения на панели ввода в приложениях.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-162">Developers of custom Autocomplete textboxes need to work with the Input Panel Autocomplete APIs directly in order to get the improved text input experience that Input Panel Autocomplete integration enables in their applications.</span></span> <span data-ttu-id="4f0bb-163">Интерфейсы API автозаполнения панели ввода входят в состав операционной системы Windows Vista и в составе пакета SDK для платформы планшетов версии 1,9 или более поздней.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-163">The Input Panel Autocomplete APIs are included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or later.</span></span> <span data-ttu-id="4f0bb-164">Интерфейсы автозаполнения на панели ввода являются интерфейсами на основе COM.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-164">The Input Panel Autocomplete interfaces are COM-based interfaces.</span></span>

<span data-ttu-id="4f0bb-165">В следующем разделе подробно описывается работа этих интерфейсов в приложении C++.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-165">The following section describes working these interfaces in detail for a C++ application.</span></span> <span data-ttu-id="4f0bb-166">Однако эти COM-интерфейсы могут быть реализованы на большинстве языков, включая C \# , с помощью COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-166">However, these COM interfaces can be implemented in most languages, including C\#, through the use of COM Interop.</span></span>

<span data-ttu-id="4f0bb-167">Для реализации интеграции автозаполнения панели ввода в пользовательском текстовом поле автозаполнения необходимы два интерфейса: [**интерфейс итипаутокомплетепровидер**](itipautocompleteprovider.md) и [**интерфейс итипаутокомплетеклиент**](itipautocompleteclient.md).</span><span class="sxs-lookup"><span data-stu-id="4f0bb-167">In order to implement Input Panel Autocomplete integration in a custom Autocomplete text box, the two required interfaces are the [**ITipAutocompleteProvider Interface**](itipautocompleteprovider.md) and the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md).</span></span> <span data-ttu-id="4f0bb-168">Определения этих интерфейсов находятся в Типаутокомплете. h и Типаутокомплете \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-168">The definitions for these interfaces are found in TipAutoComplete.h and TipAutoComplete\_i.c.</span></span>

<span data-ttu-id="4f0bb-169">Сначала приложение должно определить и создать экземпляр класса поставщика автозаполнения, который реализует [**итипаутокомплетепровидер**](itipautocompleteprovider.md) для каждого текстового поля ввода, включающего список автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-169">First, an application must define and instantiate an Autocomplete provider class, which implements [**ITipAutocompleteProvider**](itipautocompleteprovider.md) for each text entry field that includes an Autocomplete list.</span></span> <span data-ttu-id="4f0bb-170">Этот класс управляет стороны приложения в интеграции автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-170">This class manages the application's side of the Autocomplete integration.</span></span> <span data-ttu-id="4f0bb-171">Все запросы автозаполнения из панели ввода выполняются из клиента автозаполнения в приложение с помощью поставщика автозаполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-171">All Autocomplete requests from Input Panel are made from the Autocomplete client to the application via the application's Autocomplete provider.</span></span> <span data-ttu-id="4f0bb-172">Поставщик автозаполнения приложения должен иметь доступ к HWND для списка автозаполнения приложения и ХВИНД для связанного поля ввода текста.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-172">The application's Autocomplete provider must have access to both the HWND for the application's Autocomplete list and the HWIND for the associated text entry field.</span></span> <span data-ttu-id="4f0bb-173">Кроме того, должны быть реализованы следующие методы **итипаутокомплетепровидер** :</span><span class="sxs-lookup"><span data-stu-id="4f0bb-173">Additionally, the following methods of **ITipAutocompleteProvider** must be implemented:</span></span>

-   <span data-ttu-id="4f0bb-174">[**Метод итипаутокомплетепровидер:: упдатепендингтекст**](itipautocompleteprovider-updatependingtext.md). Этот метод используется клиентом автозаполнения для уведомления приложения о том, что текст написан пользователем на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-174">[**ITipAutocompleteProvider::UpdatePendingText Method**](itipautocompleteprovider-updatependingtext.md): This method is used by the Autocomplete client to notify the application of the text a user has written into Input Panel.</span></span> <span data-ttu-id="4f0bb-175">После получения этого уведомления поставщик отвечает за создание списка автозаполнения, как если бы текст был введен в поле ввода текста приложения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-175">Upon receiving this notification, the provider is responsible for generating an Autocomplete list as if the text had been typed into the application's text entry field.</span></span> <span data-ttu-id="4f0bb-176">Строка, передаваемая поставщику автозаполнения с помощью **метода итипаутокомплетепровидер:: упдатепендингтекст** , включает только текст, находящиеся на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-176">The string pass to the Autocomplete provider by means of **ITipAutocompleteProvider::UpdatePendingText Method** only includes the text currently in Input Panel.</span></span> <span data-ttu-id="4f0bb-177">Таким образом, если в поле ввода текста есть дополнительный текст, ответственность за его правильное добавление к тексту, отправленному клиентом, несет поставщик.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-177">Therefore, if there is additional text in the text entry field, it is the responsibility of the provider to properly append it to the text sent by the client.</span></span> <span data-ttu-id="4f0bb-178">Строка, передаваемая **методом итипаутокомплетепровидер:: упдатепендингтекст** , должна рассматриваться как замена для текущего выбора в поле.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-178">The string pass by **ITipAutocompleteProvider::UpdatePendingText Method** should be treated as a replacement for the current selection in the field.</span></span> <span data-ttu-id="4f0bb-179">Если текущее выделение отсутствует, оно должно располагаться в позиции текущей точки вставки.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-179">If there is no current selection, it should be placed at the position of the current insertion point.</span></span> <span data-ttu-id="4f0bb-180">После создания списка автозаполнения поставщик должен вызвать [**метод итипаутокомплетепровидер:: Показать**](itipautocompleteprovider-show.md) , передавая **значение true** для отображения списка автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-180">Once the Autocomplete list is generated, the provider should call the [**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md) passing in **TRUE** to display the Autocomplete list.</span></span> <span data-ttu-id="4f0bb-181">Приложение не должно кэшировать вызовы **упдатепендингтекст** , а вместо этого обрабатывать каждый дополнительный вызов **упдатепендингтекст** как отмену предыдущего вызова, чтобы избежать МИГАНИЯ устаревшего пользовательского интерфейса списка автозаполнения. Эти рекомендации иллюстрируются в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-181">The application should not cache calls to **UpdatePendingText** but rather treat each additional call to **UpdatePendingText** as a cancellation of the previous call to avoid flashing an out-of-date Autocomplete list UI.The following example code illustrates these practices.</span></span>

    ```C++
    HRESULT SampleProvider::UpdatePendingText(BSTR bstrPendingText)
    {
       //Discard previously cached pending text from Input Panel
       m_bstrPending.Empty();
        //Store the new pending text from Input Panel as m_bstrPending
    m_bstrPending = bstrPendingText;

        //Get the text from the field in two chunks. The characters to
    //the left of the selection and the characters to the right.
    CComBSTR bstrLeftContext = //Text to the left of the selection
            CComBSTR bstrRightContext = //Text to the right of the selection

    //Discard previously cached complete text
        m_bstrCompleteText.Empty();
        //Append to the field text from the left of the selection
        //the text from Input Panel and then append to that
        //the field text to the right of the selection
        m_bstrCompleteText.Append(bstrLeftContext);
        m_bstrCompleteText.Append(m_bstrPending);
        m_bstrCompleteText.Append(bstrRigtContext);

        //Update the app's AC list based on m_bstrCompleteText
        //...

        //Show the updated AC list by calling the provider's Show method
       Show(true);
       return S_OK;
    }
    ```

    

-   <span data-ttu-id="4f0bb-182">[**Метод итипаутокомплетепровидер:: "**](itipautocompleteprovider-show.md). Этот метод вызывается из [**упдатепендингтекст**](itipautocompleteprovider-updatependingtext.md), но он может вызываться клиентом автозаполнения в любое время.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-182">[**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md): This method is called from [**UpdatePendingText**](itipautocompleteprovider-updatependingtext.md), but also can be called by the Autocomplete client at anytime.</span></span> <span data-ttu-id="4f0bb-183">При получении этого вызова поставщик автозаполнения должен скрыть или показать поставщик автозаполнения, как указано в параметре.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-183">Upon receiving this call, the Autocomplete provider must hide or show the Autocomplete provider as indicated by the parameter.</span></span> <span data-ttu-id="4f0bb-184">Перед отображением списка автозаполнения поставщик автозаполнения должен обратиться к клиенту автозаполнения о месте расположения списка автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-184">Prior to showing the Autocomplete list the Autocomplete provider is expected to consult the Autocomplete client about where to position the Autocomplete list.</span></span> <span data-ttu-id="4f0bb-185">Дополнительные сведения о расположении списка автозаполнения см. Далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-185">More information about positioning the Autocomplete list appears later in this article.</span></span>

<span data-ttu-id="4f0bb-186">Затем приложение должно использовать функцию [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) (ATL), чтобы создать экземпляр [**интерфейса итипаутокомплетеклиент**](itipautocompleteclient.md) с идентификатором класса **CLSID \_ типаутокомплетеклиент** в качестве внутрипроцессного сервера, а затем зарегистрировать поставщик в клиенте.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-186">Next, the application should use the Active Template Library (ATL) [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md) with class id **CLSID\_TipAutoCompleteClient** as an in-process server, and then register the provider with the client.</span></span> <span data-ttu-id="4f0bb-187">Метод автозаполнения Client [**итипаутокомплетеклиент:: адвисепровидер**](itipautocompleteclient-adviseprovider.md) регистрирует поставщик в клиенте, чтобы позволить клиенту вызывать объект поставщика автозаполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-187">The Autocomplete client [**ITipAutocompleteClient::AdviseProvider Method**](itipautocompleteclient-adviseprovider.md) registers the provider with the client to enable the client to call the application's Autocomplete provider object.</span></span> <span data-ttu-id="4f0bb-188">Если tiptsf.dll отсутствует в системе, функция **CoCreateInstance** завершается ошибкой и возвращает **регдб \_ E \_ класснотрег**.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-188">If tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**.</span></span> <span data-ttu-id="4f0bb-189">На этом этапе приложение может удалить объект [**итипаутокомплетепровидер**](itipautocompleteprovider.md) и продолжать работу, как если бы панель ввода не существовала, так как она не находится в такой системе.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-189">At this point the application can discard its [**ITipAutocompleteProvider**](itipautocompleteprovider.md) object and proceed as if Input Panel does not exist, because it does not on such a system.</span></span>

<span data-ttu-id="4f0bb-190">Приложение может выбрать создание одного экземпляра [**итипаутокомплетеклиент**](itipautocompleteclient.md) или одного экземпляра на текстовом поле.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-190">The application can choose to create one instance of [**ITipAutocompleteClient**](itipautocompleteclient.md) or one instance per text field.</span></span> <span data-ttu-id="4f0bb-191">Для первого параметра требуется, чтобы поставщик был отменен и зарегистрирован при каждом изменении фокуса.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-191">The first option requires the provider to be unregistered and registered each time the focus is changed.</span></span> <span data-ttu-id="4f0bb-192">Дополнительные сведения об отмене регистрации поставщика автозаполнения см. Далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-192">More information about unregistering the Autocomplete provider appears later in this topic.</span></span>

<span data-ttu-id="4f0bb-193">Существует несколько шагов, связанных с размещением списка автозаполнения, который необходимо координировать между поставщиком автозаполнения (приложение) и клиентом автозаполнения (панель ввода).</span><span class="sxs-lookup"><span data-stu-id="4f0bb-193">There are several steps involved in positioning the Autocomplete list that must be coordinated between the Autocomplete provider (application) and the Autocomplete client (Input Panel).</span></span> <span data-ttu-id="4f0bb-194">Перед отображением списка автозаполнения в результате вызова метода " [**Показать**](itipautocompleteprovider-show.md) " поставщика автозаполнения или из-за ввода текста пользователем с помощью клавиатуры поставщик должен обратиться к клиенту, чтобы узнать, где разместить список автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-194">Before the Autocomplete list is shown, either as a result of a call to the Autocomplete provider's [**Show**](itipautocompleteprovider-show.md) method or due to the user entering text using the keyboard, the provider is required to consult the client about where to position the Autocomplete list.</span></span> <span data-ttu-id="4f0bb-195">Поставщик должен выполнить следующие действия:</span><span class="sxs-lookup"><span data-stu-id="4f0bb-195">The provider should take the following steps:</span></span>

-   <span data-ttu-id="4f0bb-196">Используйте [**метод итипаутокомплетеклиент:: рекуестшовуи**](itipautocompleteclient-requestshowui.md) клиента автозаполнения, чтобы определить, готова ли панель ввода к отображению списка автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-196">Use the Autocomplete client's [**ITipAutocompleteClient::RequestShowUI Method**](itipautocompleteclient-requestshowui.md) to determine whether Input Panel is ready to have the Autocomplete list shown.</span></span> <span data-ttu-id="4f0bb-197">**Рекуестшовуи** принимает параметр *HWND* , который является HWND для окна списка автозаполнения, и метод возвращает **значение true** или **false** , чтобы указать, является ли он состоянием, в котором можно отобразить список автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-197">**RequestShowUI** takes the *HWND* parameter that is the HWND for the Autocomplete list window, and the method returns **TRUE** or **FALSE** to indicate if it is the state in which the Autocomplete list can be shown.</span></span> <span data-ttu-id="4f0bb-198">Если клиент возвращает **значение false**, поставщик не должен пытаться отобразить список автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-198">If the client returns **FALSE**, the provider should not attempt to show the Autocomplete list.</span></span>
-   <span data-ttu-id="4f0bb-199">Вызовите [**рекуестшовуи**](itipautocompleteclient-requestshowui.md) , чтобы задать окно списка автозаполнения для всплывающих окон перед вызовом [**метода Итипаутокомплетеклиент::P реферредректс**](itipautocompleteclient-preferredrects.md).</span><span class="sxs-lookup"><span data-stu-id="4f0bb-199">Call [**RequestShowUI**](itipautocompleteclient-requestshowui.md) to set the popup Autocomplete list window handle before you call the [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="4f0bb-200">Несоблюдение этого действия приведет к ошибке **E \_ INVALIDARG** при вызове **преферредректс**.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-200">Failure to do so will cause an **E\_INVALIDARG** error when calling **PreferredRects**.</span></span>
-   <span data-ttu-id="4f0bb-201">Если [**рекуестшовуи**](itipautocompleteclient-requestshowui.md) возвращает **значение true**, поставщик должен вычислить прямоугольник координат экрана по умолчанию в списке автозаполнения на основе расположения поля ввода текста, а затем вызвать [**метод итипаутокомплетеклиент::P реферредректс**](itipautocompleteclient-preferredrects.md)клиента автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-201">If [**RequestShowUI**](itipautocompleteclient-requestshowui.md) returns **TRUE**, the provider should calculate the default screen coordinate rectangle of the Autocomplete list based on the location of the text entry field, and then call the Autocomplete client's [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="4f0bb-202">Это позволяет клиенту автозаполнения настраивать прямоугольник, чтобы избежать перекрытия списка автозаполнения с помощью панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-202">This allows the Autocomplete client to adjust the rectangle to avoid the Autocomplete list overlapping with Input Panel.</span></span> <span data-ttu-id="4f0bb-203">Метод **преферредректс** принимает четыре параметра:</span><span class="sxs-lookup"><span data-stu-id="4f0bb-203">The **PreferredRects** method takes four parameters:</span></span>

    -   <span data-ttu-id="4f0bb-204">RECT *ркаклист*: прямоугольник координат экрана по умолчанию в списке автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-204">RECT *rcACList*: The default screen coordinate rectangle of the Autocomplete list.</span></span>
    -   <span data-ttu-id="4f0bb-205">RECT *ркфиелд*: прямоугольник координат экрана соответствующего поля ввода текста.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-205">RECT *rcField*: The screen coordinate rectangle of the corresponding text entry field.</span></span>
    -   <span data-ttu-id="4f0bb-206">RECT *\* пркмодифиедаклист*: скорректированный экранный прямоугольник координат для автозаполнения</span><span class="sxs-lookup"><span data-stu-id="4f0bb-206">RECT *\*prcModifiedACList*: The adjusted screen coordinate rectangle for the Autocomplete</span></span>
    -   <span data-ttu-id="4f0bb-207">BOOL *\* пфшовабове*. Этот параметр указывает поставщику, размещает ли прямоугольник *пркмодифиедаклист* список автозаполнения выше или ниже панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-207">BOOL *\*pfShowAbove*: This parameter indicates to the provider whether the *prcModifiedACList* rectangle positions the Autocomplete list above or below Input Panel.</span></span> <span data-ttu-id="4f0bb-208">Приложение может использовать эти сведения для правильной отрисовки элементов пользовательского интерфейса, таких как маркеры изменения размера и полосы прокрутки.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-208">The application can use this information to correctly draw UI elements such as resize handles and scroll bars.</span></span> <span data-ttu-id="4f0bb-209">Поставщик должен сначала передать в направлении, в котором список автозаполнения будет располагать относительно поля ввода текста с помощью *ркаклист*.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-209">The provider should initially pass in the direction that the Autocomplete list would be positioned relative to the text entry field by *rcACList*.</span></span> <span data-ttu-id="4f0bb-210">Клиент не изменяет *пфшовабове* , если он задает *пркмодифиедаклист* , равный *ркаклист*.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-210">The client does not change *pfShowAbove* if it sets *prcModifiedACList* equal to *rcACList*.</span></span>

    <span data-ttu-id="4f0bb-211">Для позиционирования и отображения окна списка автозаполнения используйте возвращаемые значения аргументов *пркмодифиедаклист* и *пфшовабове* out.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-211">Use the return values of the *prcModifiedACList* and *pfShowAbove* out arguments to position and show the Autocomplete list window.</span></span> <span data-ttu-id="4f0bb-212">Если панель ввода не используется, [**рекуестшовуи**](itipautocompleteclient-requestshowui.md) всегда возвращает **значение true** , а *пркмодифиедаклист* всегда совпадает с *ркаклист*.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-212">If Input Panel is not in use, [**RequestShowUI**](itipautocompleteclient-requestshowui.md) always returns **TRUE** and *prcModifiedACList* is always the same as *rcACList*.</span></span> <span data-ttu-id="4f0bb-213">*пфшовабове* также не изменяется, результат заключается в том, что вызовы не влияют на поведение приложения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-213">*pfShowAbove* is also unchanged, the result being that the calls have no affect on the application behavior.</span></span> <span data-ttu-id="4f0bb-214">Эти рекомендации иллюстрируются в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-214">The following example code illustrates these practices.</span></span>


```C++
HRESULT SampleProvider::Show(BOOL fShow)
{
    //Ask the AC client if it is OK to show the Autocomplete list.
    BOOL fAllowShowing = FALSE;
    m_spACClient->RequestShowUI(m_hWndList, &fAllowShowing);

    if (fShow && fAllowingShowing)
        {
            // Create the parameters required to call PreferredRects
            RECT rcField = //Rectangle for app's text field
            RECT rcACList = //Default rectangle for app's AC list
            RECT rcModifiedACList = {0, 0, 0, 0};
            BOOL fShowAbove = TRUE;

//Ask the AC client to modify the position of the AC list
m_spACClient->PreferredRects(&rcACList, &rcField,
&rcModifiedACList, &fShowAbove);

            //Show the Autocomplete UI at the modified preferred rectangle
            //from rcModifiedACList and the directional info provide by
//fShowAbove
            //...
        }
    else
        {
        //Hide the Autocomplete list and clean up
        //...
        }
    return S_OK;
}
```



<span data-ttu-id="4f0bb-215">Когда пользователь выбирает элемент в списке автозаполнения, поставщику необходимо вызвать [**метод итипаутокомплетеклиент:: усерселектион**](itipautocompleteclient-userselection.md) клиента в дополнение к вставке текста выбранного элемента в поле ввода текста.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-215">When the user selects an item in the Autocomplete list, the provider needs to call the client's [**ITipAutocompleteClient::UserSelection Method**](itipautocompleteclient-userselection.md) in addition to inserting the selected item text into the text entry field.</span></span> <span data-ttu-id="4f0bb-216">Панель ввода использует это уведомление для удаления оставшегося текста, который еще не был вставлен на панели ввода.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-216">Input Panel uses this notification to discard all remaining text that has not yet been inserted from Input Panel.</span></span>

<span data-ttu-id="4f0bb-217">Наконец, когда поставщик больше не нужен, поставщик должен быть связан с клиентом автозаполнения путем вызова [**метода итипаутокомплетеклиент:: унадвисепровидер**](itipautocompleteclient-unadviseprovider.md) клиента автозаполнения, чтобы отменить регистрацию поставщика.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-217">Finally, when the provider is no longer necessary, the provider should be unlinked from the Autocomplete client by calling the Autocomplete client's [**ITipAutocompleteClient::UnadviseProvider Method**](itipautocompleteclient-unadviseprovider.md) to unregister the provider.</span></span> <span data-ttu-id="4f0bb-218">Поставщику может потребоваться отменить регистрацию по одной из двух причин: поскольку поле ввода текста, с которым связан поставщик, было удалено, или потому, что приложение выбирает создание только одного клиента автозаполнения, а не по одному полю ввода текста.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-218">The provider may need to be unregistered for one of two reasons: because the text entry field the provider is associated with has been destroyed, or because the application chooses to create only one Autocomplete client, instead of one per text entry field.</span></span> <span data-ttu-id="4f0bb-219">В этом экземпляре поставщик должен быть отменен из регистрации при каждом переключении фокуса с текстового поля.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-219">In this instance the provider must be unregistered every time that focus is switched away from the text field.</span></span>

## <a name="conclusion"></a><span data-ttu-id="4f0bb-220">Заключение</span><span class="sxs-lookup"><span data-stu-id="4f0bb-220">Conclusion</span></span>

<span data-ttu-id="4f0bb-221">Интеграция автозаполнения на панели ввода — это мощное средство для улучшения взаимодействия с пользователем в приложениях Windows, содержащих списки автозаполнения на планшетных ПК.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-221">Input Panel Autocomplete integration is a powerful tool for improving the user experience in Windows applications that include Autocomplete lists on Tablet PCs.</span></span> <span data-ttu-id="4f0bb-222">Без интеграции пользователи панели ввода должны пройти трудоемкий процесс вставки текста по одному символу за раз и изменить расположение панели ввода, чтобы использовать автозаполнение.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-222">Without integration, Input Panel users are required to go through a tedious process of inserting text one character at a time and repositioning Input Panel in order to use Autocomplete.</span></span> <span data-ttu-id="4f0bb-223">При интеграции списки автозаполнения отображаются в удобном месте как рукописный ввод пользователей на панели ввода, увеличивая скорость и простоту ввода текста.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-223">With integration, Autocomplete lists appear in a convenient location as users ink in Input Panel, increasing both the speed and the ease of text entry.</span></span> <span data-ttu-id="4f0bb-224">В приложениях, которые включают функции автозаполнения, основанные на автозаполнении оболочки или платформа .NET Framework 3,0 Автозаполнение, интеграция автозаполнения панели ввода является бесплатной и привлекательной функцией.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-224">In applications that include Autocomplete functionality built on top of Shell Autocomplete or .NET Framework 3.0 Autocomplete, Input Panel Autocomplete integration is a free and compelling feature.</span></span> <span data-ttu-id="4f0bb-225">Кроме того, предоставляется простой набор интерфейсов на основе COM, обеспечивающий единую интегрированную среду для приложений, использующих пользовательские элементы управления автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="4f0bb-225">Furthermore, a simple set of COM-based interfaces are provided to enable the same integrated experience for applications that choose to use custom Autocomplete controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4f0bb-226">См. также</span><span class="sxs-lookup"><span data-stu-id="4f0bb-226">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4f0bb-227">Справочник по панели ввода текста</span><span class="sxs-lookup"><span data-stu-id="4f0bb-227">Text Input Panel Reference</span></span>](text-input-panel-reference.md)
</dt> </dl>

 

 
