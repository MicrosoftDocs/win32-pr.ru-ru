---
description: API-интерфейсы Инканалисис предоставляют разработчикам планшетных ПК мощные средства для программного анализа рукописного ввода. API классифицирует рукописный ввод на осмысленные категории, такие как слова, линии, абзацы и рисунки.
ms.assetid: d9521a8c-f61a-40ea-8603-e8afbba75a4e
title: Обзор анализа рукописного ввода
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8e383d16c01cd9475d4c54587b4b5fb4c09791a0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104540439"
---
# <a name="ink-analysis-overview"></a><span data-ttu-id="30d7a-104">Обзор анализа рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="30d7a-104">Ink Analysis Overview</span></span>

<span data-ttu-id="30d7a-105">API-интерфейсы Инканалисис предоставляют разработчикам планшетных ПК мощные средства для программного анализа рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-105">The InkAnalysis APIs provide Tablet PC developers with powerful tools to programmatically examine ink input.</span></span> <span data-ttu-id="30d7a-106">API классифицирует рукописный ввод на осмысленные категории, такие как слова, линии, абзацы и рисунки.</span><span class="sxs-lookup"><span data-stu-id="30d7a-106">The API classifies ink into meaningful categories such as words, lines, paragraphs, and drawings.</span></span>

<span data-ttu-id="30d7a-107">Вы можете использовать каждую классификацию различными способами, в том числе улучшая результаты распознавания рукописного текста.</span><span class="sxs-lookup"><span data-stu-id="30d7a-107">You can use each classification in a variety of ways, including improving recognition results for handwriting.</span></span>

## <a name="ink-analysis-basics"></a><span data-ttu-id="30d7a-108">Основы анализа рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="30d7a-108">Ink Analysis Basics</span></span>

<span data-ttu-id="30d7a-109">В этом разделе описывается технология анализа рукописного ввода Tablet PC Platform и объясняется, когда и как его использовать.</span><span class="sxs-lookup"><span data-stu-id="30d7a-109">This section introduces the Tablet PC Platform ink analysis technology and explains when and how to use it.</span></span>

<span data-ttu-id="30d7a-110">Интерфейсы API Инканалисис эффективно объединяют две отдельные, но бесплатные технологии: распознавание рукописного текста и классификация макета.</span><span class="sxs-lookup"><span data-stu-id="30d7a-110">The InkAnalysis APIs effectively combine two distinct but complimentary technologies: handwriting recognition and layout classification.</span></span> <span data-ttu-id="30d7a-111">Объединение этих двух технологий дает более высокий результат по сравнению с частями, созданными отдельно.</span><span class="sxs-lookup"><span data-stu-id="30d7a-111">Combining these two technologies gives definitively greater results than the parts taken alone.</span></span>

<span data-ttu-id="30d7a-112">Распознавание рукописного ввода — это Вычислительный анализ рукописного цифрового рукописного ввода для возврата символьной интерпретации на заданном языке.</span><span class="sxs-lookup"><span data-stu-id="30d7a-112">Handwriting recognition is the computational analysis of handwritten digital ink to return character-based interpretation in a given language.</span></span> <span data-ttu-id="30d7a-113">То есть распознавание рукописного ввода — это то, как компьютер читает рукописный ввод.</span><span class="sxs-lookup"><span data-stu-id="30d7a-113">That is, handwriting recognition is how the computer "reads" a person's handwriting.</span></span>

<span data-ttu-id="30d7a-114">Анализ рукописного ввода можно дополнительно разделить на классификацию рукописного ввода и анализ макета.</span><span class="sxs-lookup"><span data-stu-id="30d7a-114">Ink Analysis can be further broken down into ink classification and layout analysis.</span></span> <span data-ttu-id="30d7a-115">Классификация рукописного ввода — это вычислительное деление рукописного ввода на семантически значимые единицы, такие как абзацы, линии, слова и рисунки.</span><span class="sxs-lookup"><span data-stu-id="30d7a-115">Ink classification is the computational division of ink into semantically meaningful units such as paragraphs, lines, words, and drawings.</span></span> <span data-ttu-id="30d7a-116">Анализ макета — это вычислительное исследование рукописного ввода, которое определяет положение чернил на поверхности рукописного ввода и то, как штрихи связаны друг с другом пространственно и даже семантически.</span><span class="sxs-lookup"><span data-stu-id="30d7a-116">Layout analysis is the computational examination of ink input to determine the position of the ink on the inking surface and how the strokes relate to each other spatially and even semantically.</span></span> <span data-ttu-id="30d7a-117">Например, анализ макета может сообщить, что определенный фрагмент рукописного ввода является заметкой или вызовом.</span><span class="sxs-lookup"><span data-stu-id="30d7a-117">For example, layout analysis can tell you that a particular piece of ink is an annotation or a call out.</span></span>

### <a name="recognition"></a><span data-ttu-id="30d7a-118">Распознавание</span><span class="sxs-lookup"><span data-stu-id="30d7a-118">Recognition</span></span>

<span data-ttu-id="30d7a-119">Один из примеров того, как сочетание распознавания с анализом рукописного текста в API Инканалисис помогает разработчику улучшить результаты распознавания.</span><span class="sxs-lookup"><span data-stu-id="30d7a-119">One example of how the combination of recognition with ink analysis in the InkAnalysis API helps the developer is the improvement in recognition results.</span></span> <span data-ttu-id="30d7a-120">Модули распознавания рукописного ввода Tablet PC разрабатывались в основном для распознавания одной горизонтальной линии рукописного текста.</span><span class="sxs-lookup"><span data-stu-id="30d7a-120">The Tablet PC handwriting recognition engines have been primarily designed to recognize a single horizontal line of ink.</span></span> <span data-ttu-id="30d7a-121">Тем не менее, люди, как правило, пишут несколько строк при создании заметок, и эти линии не обязательно должны быть горизонтально по отношению к странице.</span><span class="sxs-lookup"><span data-stu-id="30d7a-121">However, people tend to write multiple lines when taking notes, and those lines are not guaranteed to be horizontal in relation to the page.</span></span> <span data-ttu-id="30d7a-122">С помощью API Инканалисис рукописный ввод предварительно обрабатывается анализатором рукописного ввода перед отправкой распознавателю.</span><span class="sxs-lookup"><span data-stu-id="30d7a-122">With the InkAnalysis API, ink is preprocessed by the ink analyzer before being sent to the recognizer.</span></span> <span data-ttu-id="30d7a-123">Перед распознанием проанализированные рукописные данные преобразуются в горизонтальный, что позволяет улучшить результаты распознавания.</span><span class="sxs-lookup"><span data-stu-id="30d7a-123">The analyzed ink is transformed to horizontal before being recognized, improving the recognition results.</span></span>

<span data-ttu-id="30d7a-124">Другие преимущества распознавания производятся путем того, что анализатор рукописного ввода исправляет неверные сведения о заказе на обводку перед отправкой рукописного ввода распознавателю.</span><span class="sxs-lookup"><span data-stu-id="30d7a-124">Other benefits to recognition are derived by having the ink analyzer correct incorrect stroke order information before sending the ink to the recognizer.</span></span> <span data-ttu-id="30d7a-125">Кроме того, результаты распознавания теперь доступны в выборочном режиме.</span><span class="sxs-lookup"><span data-stu-id="30d7a-125">Further, recognition results are now available in a selective manner.</span></span> <span data-ttu-id="30d7a-126">Это значит, что разработчик может быстро получить результаты распознавания одного слова, строки или абзаца в одном вызове.</span><span class="sxs-lookup"><span data-stu-id="30d7a-126">That is, the developer can quickly retrieve the recognition results for a single word, line, or paragraph in one call.</span></span>

### <a name="ink-classification"></a><span data-ttu-id="30d7a-127">Классификация рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="30d7a-127">Ink Classification</span></span>

<span data-ttu-id="30d7a-128">Конечно, существует множество сценариев, в которых вы можете не преобразовывать рукописные данные, а не непосредственно в текст.</span><span class="sxs-lookup"><span data-stu-id="30d7a-128">There are, of course, a variety of scenarios in which you may to keep the ink data intact, rather than converting it immediately to text.</span></span> <span data-ttu-id="30d7a-129">Анализ рукописного ввода также дает здесь преимущества.</span><span class="sxs-lookup"><span data-stu-id="30d7a-129">Ink analysis provides benefits here as well.</span></span> <span data-ttu-id="30d7a-130">В частности, интерфейсы API Инканалисис позволяют разбивать рукописные штрихи в зависимости от того, являются ли они написанными или рисунками.</span><span class="sxs-lookup"><span data-stu-id="30d7a-130">Specifically, the InkAnalysis APIs provide the ability to split ink strokes according to whether they are writing or drawings.</span></span> <span data-ttu-id="30d7a-131">Рукописные штрихи, которые классифицируются как записи, — это те, которые составляют слово или символы.</span><span class="sxs-lookup"><span data-stu-id="30d7a-131">Ink strokes that are classified as writing are those that make up a word or characters.</span></span> <span data-ttu-id="30d7a-132">Все остальные штрихи являются рисунками.</span><span class="sxs-lookup"><span data-stu-id="30d7a-132">All other strokes are drawings.</span></span> <span data-ttu-id="30d7a-133">Это обеспечивает новый способ доступа к данным рукописного ввода, что позволяет использовать новые пользовательские сценарии.</span><span class="sxs-lookup"><span data-stu-id="30d7a-133">This provides you with a new way to access ink data, enabling new user scenarios.</span></span> <span data-ttu-id="30d7a-134">Например, можно реализовать выбор, чтобы он отличался в зависимости от типа штриха, на который пользователь наследует. Если пользователь нажимает рукописный штрих, приложение выбирает весь набор штрихов, образующих слово, если пользователь нажимает рисунок необходимо, приложение выбирает только этот росчерк.</span><span class="sxs-lookup"><span data-stu-id="30d7a-134">For instance, you may implement selection so that it is different based on which type of stroke the user taps on; if a user taps a writing stroke, the application selects the entire set of strokes that compose the word, if the user taps a drawing stoke, the application selects only that stroke.</span></span>

### <a name="layout-analysis"></a><span data-ttu-id="30d7a-135">Анализ макета</span><span class="sxs-lookup"><span data-stu-id="30d7a-135">Layout Analysis</span></span>

<span data-ttu-id="30d7a-136">Полезный анализ макета на самом деле далеко выходит за рамки относительно простого разбиения рукописного ввода на компоненты для написания и рисования.</span><span class="sxs-lookup"><span data-stu-id="30d7a-136">Useful layout analysis actually goes far beyond the relatively simple breakdown of ink into writing and drawing components.</span></span>

<span data-ttu-id="30d7a-137">Анализ рукописного ввода также включает в себя более широкие возможности для создания и прорисовки штрихов.</span><span class="sxs-lookup"><span data-stu-id="30d7a-137">Ink analysis also includes a richer breakdown of the writing and drawing strokes.</span></span> <span data-ttu-id="30d7a-138">В качестве простого примера возьмем большой двоичный объект рукописного ввода, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="30d7a-138">As a very simple example, take a blob of ink as shown in the following illustration.</span></span>

![две простые строки рукописного ввода](images/12e7a221-59c1-4d69-b7aa-67f2caebe375.jpg)

<span data-ttu-id="30d7a-140">После того как платформа проанализировала эти штрихи, она возвращает древовидное представление этих штрихов, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="30d7a-140">After the platform has analyzed these strokes, it returns a tree representation of these strokes as shown in the following illustration.</span></span> <span data-ttu-id="30d7a-141">В этом простом случае дерево содержит только сведения о абзацах, строках и словах, но насыщенность этого дерева увеличивается по мере роста сложности документа рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-141">For this simple case, the tree contains only paragraph, line, and word information, but the richness of this tree increases as the complexity of the ink document increases.</span></span>

![древовидное представление корня, абзаца, строк и слов](images/be5a7635-0abc-45ad-bcb5-98fddee5e148.jpg)

<span data-ttu-id="30d7a-143">Так как эти сведения теперь разделены на управляемые единицы, теперь можно создавать более эффективные функции.</span><span class="sxs-lookup"><span data-stu-id="30d7a-143">Because this information is now separated into manageable units, you can now create more powerful features.</span></span> <span data-ttu-id="30d7a-144">Например, приложение может расширить функцию, в которой пользователь выбирает слово, в функцию, в которой пользователь выбирает слово, дважды касанием, чтобы выделить всю строку, и нажмет три раза, чтобы выделить весь абзац.</span><span class="sxs-lookup"><span data-stu-id="30d7a-144">As an example, the application can extend the feature in which the user taps to select a word into a feature in which the user taps once to select the word, taps twice to select the entire line, and taps three times to select the entire paragraph.</span></span> <span data-ttu-id="30d7a-145">С помощью древовидной структуры, возвращаемой операцией анализа, приложение может связать выделенную область с обводкой в дереве.</span><span class="sxs-lookup"><span data-stu-id="30d7a-145">By leveraging the tree structure returned by the analysis operation, the application can relate the tapped area back to a stroke in the tree.</span></span> <span data-ttu-id="30d7a-146">После того, как приложение найдет штрих, оно может пройти по дереву, чтобы определить, как и какие соседние штрихи следует выбрать.</span><span class="sxs-lookup"><span data-stu-id="30d7a-146">After the application finds a stroke, it can walk up the tree to determine how and which neighboring strokes to select.</span></span>

<span data-ttu-id="30d7a-147">Выбор целой строки — это упрощенный пример преимуществ анализа рукописного ввода, но возможности становятся великолепной, если один из них учитывает различные типы иерархических структур, которые анализатор рукописного ввода может обнаружить:</span><span class="sxs-lookup"><span data-stu-id="30d7a-147">Selecting an entire line is a simplistic example of the benefits of ink analysis, but the possibilities become great when one considers the different types of hierarchical structures the ink analyzer is capable of detecting:</span></span>

-   <span data-ttu-id="30d7a-148">Упорядоченные и неупорядоченные списки</span><span class="sxs-lookup"><span data-stu-id="30d7a-148">Ordered and unordered lists</span></span>
-   <span data-ttu-id="30d7a-149">Фигуры</span><span class="sxs-lookup"><span data-stu-id="30d7a-149">Shapes</span></span>
-   <span data-ttu-id="30d7a-150">Примечания, написанные с помощью текста</span><span class="sxs-lookup"><span data-stu-id="30d7a-150">Annotative comments written inline with the text</span></span>

<span data-ttu-id="30d7a-151">Типы функций изменяются от приложения к приложению и основываются на требованиях, доступных средствах анализа рукописного ввода и распознавания.</span><span class="sxs-lookup"><span data-stu-id="30d7a-151">The types of features vary from application to application and are based on requirements and the available ink analysis and recognition engines.</span></span>

### <a name="key-ink-analysis-features"></a><span data-ttu-id="30d7a-152">Основные функции анализа рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="30d7a-152">Key Ink Analysis Features</span></span>

<span data-ttu-id="30d7a-153">Ниже перечислены основные возможности API Инканалисис.</span><span class="sxs-lookup"><span data-stu-id="30d7a-153">The key capabilities of the InkAnalysis API include the following features:</span></span>

-   <span data-ttu-id="30d7a-154">Добавочный анализ</span><span class="sxs-lookup"><span data-stu-id="30d7a-154">Incremental Analysis</span></span>
-   <span data-ttu-id="30d7a-155">Сохраняемость</span><span class="sxs-lookup"><span data-stu-id="30d7a-155">Persistence</span></span>
-   <span data-ttu-id="30d7a-156">Прокси-сервер данных</span><span class="sxs-lookup"><span data-stu-id="30d7a-156">Data Proxy</span></span>
-   <span data-ttu-id="30d7a-157">Процессе</span><span class="sxs-lookup"><span data-stu-id="30d7a-157">Reconciliation</span></span>
-   <span data-ttu-id="30d7a-158">Расширение среды</span><span class="sxs-lookup"><span data-stu-id="30d7a-158">Extensibility</span></span>

### <a name="incremental-analysis"></a><span data-ttu-id="30d7a-159">Добавочный анализ</span><span class="sxs-lookup"><span data-stu-id="30d7a-159">Incremental Analysis</span></span>

<span data-ttu-id="30d7a-160">Когда конечные пользователи работают с рукописным вводом, они обычно обрабатываются как рукописный ввод.</span><span class="sxs-lookup"><span data-stu-id="30d7a-160">When end users work with ink, they usually treat it like handwriting.</span></span> <span data-ttu-id="30d7a-161">Рукописные данные постоянно подвергаются операциям редактирования, таким как добавление новых рукописных данных, удаление существующих рукописных данных и изменение свойств рукописного ввода. все это выполняется таким же образом, как рукописный ввод постоянно редактируется.</span><span class="sxs-lookup"><span data-stu-id="30d7a-161">The ink is continually subject to editing operations such as the addition of new ink, deletion of existing ink, and the modification of ink properties, all done in the same way that handwriting is continually edited.</span></span> <span data-ttu-id="30d7a-162">Эти операции редактирования влияют на результаты анализа.</span><span class="sxs-lookup"><span data-stu-id="30d7a-162">These editing operations affect the analysis results.</span></span> <span data-ttu-id="30d7a-163">При внесении изменений они обычно могут быть изолированы по разделам документа в определенные моменты времени.</span><span class="sxs-lookup"><span data-stu-id="30d7a-163">When edits occur, they can usually be isolated to sections of the document at specific points in time.</span></span> <span data-ttu-id="30d7a-164">Например, предположим, что пользователь записывает пять строк рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-164">For example, assume a user writes five lines of ink.</span></span> <span data-ttu-id="30d7a-165">Стандартный способ, которым приложения анализируют рукописные данные, — подождать, пока пользователь не закончит писать все пять строк рукописного ввода (например, параграф), а затем проанализирует результаты синхронно или асинхронно.</span><span class="sxs-lookup"><span data-stu-id="30d7a-165">The standard way that applications analyze ink is to wait until the user has finished writing all five lines of ink—a paragraph, for instance—and then analyze the results, either synchronously or asynchronously.</span></span>

<span data-ttu-id="30d7a-166">Вы можете оптимизировать общее время, затраченное на анализ этих пяти строк, изолируя анализируемые области по мере их написания, а затем повторно анализируя только те части результатов, которые были изменены.</span><span class="sxs-lookup"><span data-stu-id="30d7a-166">You can optimize the overall time spent analyzing these five lines by isolating the areas that are analyzed as they are being written, and then reanalyzing only the parts of the results that have changed.</span></span> <span data-ttu-id="30d7a-167">После анализа первой строки она никогда не будет распознаваться снова, если она не была изменена конечным пользователем.</span><span class="sxs-lookup"><span data-stu-id="30d7a-167">After the first line is analyzed, it will never be recognized again unless it is modified by the end user.</span></span> <span data-ttu-id="30d7a-168">Распознавание второй строки рассматривается как независимая операция распознавания.</span><span class="sxs-lookup"><span data-stu-id="30d7a-168">Recognition of the second line is treated as an independent recognition operation.</span></span>

<span data-ttu-id="30d7a-169">Этот инкрементный подход хорошо работает на уровне строк для операций распознавания, но он должен работать на более высоком уровне для операции анализа рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-169">This incremental approach works well at the line level for the recognition operations, but it needs to work at a higher level for the ink analysis operation.</span></span> <span data-ttu-id="30d7a-170">Так как анализатор рукописного ввода может обнаруживать разные классификации более высокого уровня для этих пяти рукописных строк (например, это может быть Стандартный абзац или пять элементов в списке), инкрементный подход к анализатору рукописного ввода заключается в том, что он должен анализировать более высокие структуры.</span><span class="sxs-lookup"><span data-stu-id="30d7a-170">Because the ink analyzer can detect different higher level classifications for these five lines of ink (for example, it could be a standard paragraph or five items in a list), the incremental approach for the ink analyzer is that it has to analyze these higher structures.</span></span> <span data-ttu-id="30d7a-171">Это означает, что после того, как анализатор рукописного ввода классифицирует первую строку рукописного ввода как строку, он дважды проверяет, что он по-прежнему является линией, когда он классифицирует вторую строку.</span><span class="sxs-lookup"><span data-stu-id="30d7a-171">That is to say, after the ink analyzer classifies the first line of ink as a line, it double-checks that it is still a line when it classifies the second line.</span></span> <span data-ttu-id="30d7a-172">Однако анализатор рукописного ввода изолирует этот двойной Поиск в абзаце и пропускает первый абзац при анализе второго абзаца, рассматривая второй абзац как независимую операцию анализатора рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-172">However, the ink analyzer isolates this double-checking to the paragraph and ignores the first paragraph when analyzing a second paragraph, treating the second paragraph as an independent ink analyzer operation.</span></span> <span data-ttu-id="30d7a-173">Такой инкрементный подход к анализу значительно экономит время обработки, когда в приложении уже есть большие объемы рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-173">This incremental approach to analysis dramatically saves processing time when large amounts of ink already exist in the application.</span></span>

### <a name="persistence"></a><span data-ttu-id="30d7a-174">Сохраняемость</span><span class="sxs-lookup"><span data-stu-id="30d7a-174">Persistence</span></span>

<span data-ttu-id="30d7a-175">Добавочный анализ хорошо работает в пределах заданного сеанса или экземпляра объекта [**InkAnalyzer**](inkanalyzer.md) .</span><span class="sxs-lookup"><span data-stu-id="30d7a-175">Incremental analysis works well within a given session or instance of an [**InkAnalyzer**](inkanalyzer.md) object.</span></span> <span data-ttu-id="30d7a-176">Однако API платформы планшетных ПК первого поколения не могут выполнить добавочный анализ после сохранения рукописного ввода на диск.</span><span class="sxs-lookup"><span data-stu-id="30d7a-176">However, the first generation Tablet PC Platform APIs cannot perform incremental analysis after the ink is persisted to disk.</span></span> <span data-ttu-id="30d7a-177">API Инканалисис позволяет сохранять рукописные данные на диск вместе с сохраненной формой результатов анализа.</span><span class="sxs-lookup"><span data-stu-id="30d7a-177">The InkAnalysis API enables saving ink to disk along with a persisted form of the analysis results.</span></span> <span data-ttu-id="30d7a-178">Результаты анализа могут быть загружены при загрузке рукописного ввода и могут быть добавлены в новый экземпляр **InkAnalyzer**.</span><span class="sxs-lookup"><span data-stu-id="30d7a-178">The analysis results can be loaded when the ink is loaded and can be injected into a new instance of an **InkAnalyzer**.</span></span> <span data-ttu-id="30d7a-179">Новый экземпляр объекта **InkAnalyzer** имеет те же результаты, что и его состояние ранее было и теперь может принимать любые изменения в виде добавочных изменений в существующем состоянии, а не анализировать все еще.</span><span class="sxs-lookup"><span data-stu-id="30d7a-179">A new instance of the **InkAnalyzer** object then has the same results state it previously had and can now accept any modifications as incremental changes to the existing state, rather than analyzing everything again.</span></span>

### <a name="data-proxy"></a><span data-ttu-id="30d7a-180">Прокси-сервер данных</span><span class="sxs-lookup"><span data-stu-id="30d7a-180">Data Proxy</span></span>

<span data-ttu-id="30d7a-181">Многие приложения уже имеют определенную структуру документа в своих приложениях. Например, диаграмма или база данных.</span><span class="sxs-lookup"><span data-stu-id="30d7a-181">Many applications already have some sort of existing document structure in their applications; for instance, a graph or a database.</span></span> <span data-ttu-id="30d7a-182">[**InkAnalyzer**](inkanalyzer.md) также представляет результаты в структурированной форме в виде дерева объектов [**контекстноде**](icontextnode.md) .</span><span class="sxs-lookup"><span data-stu-id="30d7a-182">The [**InkAnalyzer**](inkanalyzer.md) also presents results in a structured form, in a tree of [**ContextNode**](icontextnode.md) objects.</span></span> <span data-ttu-id="30d7a-183">Структура **InkAnalyzer** и существующая структура приложения должны взаимодействовать в двух направлениях: результаты извлекаются из **InkAnalyzer** в приложение и состояние помещается из приложения в **InkAnalyzer**.</span><span class="sxs-lookup"><span data-stu-id="30d7a-183">The **InkAnalyzer** structure and the application's existing structure need to interoperate in two directions: results are pulled from the **InkAnalyzer** into the application and state is pushed from the application into the **InkAnalyzer**.</span></span>

<span data-ttu-id="30d7a-184">Если извлечь результаты из [**InkAnalyzer**](inkanalyzer.md) в структуру приложения все, что требовалось, это было бы сравнительно просто.</span><span class="sxs-lookup"><span data-stu-id="30d7a-184">If pulling the results from the [**InkAnalyzer**](inkanalyzer.md) into the application's structure were all that was needed, it would be relatively simple.</span></span> <span data-ttu-id="30d7a-185">Приложения будут перебирать дерево результатов и копировать (интегрировать) все необходимые результаты в существующую структуру данных.</span><span class="sxs-lookup"><span data-stu-id="30d7a-185">Applications would iterate through the results tree and copy (integrate) all pieces of the results they need into their existing data structure.</span></span> <span data-ttu-id="30d7a-186">Однако так как многие горизонтальные приложения нуждаются в добавочном анализе и сохранении данных на диске, проблема превращается в два направления.</span><span class="sxs-lookup"><span data-stu-id="30d7a-186">However, because many horizontal applications require incremental analysis and persistence to disk, the problem becomes two-directional.</span></span> <span data-ttu-id="30d7a-187">Состояние (прошлые результаты) должно быть извлечено из структуры приложения и помещено в **InkAnalyzer**.</span><span class="sxs-lookup"><span data-stu-id="30d7a-187">State (past results) needs to be pulled from the application's structure and pushed into the **InkAnalyzer**.</span></span>

<span data-ttu-id="30d7a-188">Чтобы удовлетворить это требование, [**InkAnalyzer**](inkanalyzer.md) содержит ряд событий, которые он вызывает в нужное время во время операции анализа, чтобы позволить приложениям прокси-серверу запрашивать данные обратно в существующие структуры.</span><span class="sxs-lookup"><span data-stu-id="30d7a-188">To meet this requirement, the [**InkAnalyzer**](inkanalyzer.md) contains a series of events that it raises at the appropriate time during an analysis operation to allow applications to proxy the request for data back to their existing structures.</span></span> <span data-ttu-id="30d7a-189">Эти события вызываются только для тех объектов [**контекстноде**](icontextnode.md) , которые требуются для добавочной операции.</span><span class="sxs-lookup"><span data-stu-id="30d7a-189">These events are raised only for those [**ContextNode**](icontextnode.md) objects required by the incremental operation.</span></span>

### <a name="reconciliation"></a><span data-ttu-id="30d7a-190">Процессе</span><span class="sxs-lookup"><span data-stu-id="30d7a-190">Reconciliation</span></span>

<span data-ttu-id="30d7a-191">Большинству приложений потребуется проанализировать рукописный ввод в фоновом режиме, чтобы предотвратить прерывание пользовательского интерфейса как минимум.</span><span class="sxs-lookup"><span data-stu-id="30d7a-191">Most applications will want to analyze the ink in the background to keep user interface interruptions to a minimum.</span></span> <span data-ttu-id="30d7a-192">Анализ рукописного ввода в фоновом режиме вызывает проблемы, если пользователь изменяет рукописный ввод (или соседний рукописный фрагмент), который анализируется.</span><span class="sxs-lookup"><span data-stu-id="30d7a-192">Analyzing ink in the background causes problems, however, if the user changes the ink (or neighboring ink) that is being analyzed.</span></span> <span data-ttu-id="30d7a-193">Например, если пользователь удаляет рукописный ввод во время фоновой операции, полученная структура будет отражать состояние документа при запуске фоновой операции, а не после ее завершения.</span><span class="sxs-lookup"><span data-stu-id="30d7a-193">For example, if the user deletes the ink during the background operation, the resulting structure would reflect the state of the document when the background operation started, rather than when it was completed.</span></span>

<span data-ttu-id="30d7a-194">Чтобы помочь приложениям, [**InkAnalyzer**](inkanalyzer.md) согласовывает различия в состоянии документа между началом и концом операции анализа.</span><span class="sxs-lookup"><span data-stu-id="30d7a-194">To assist applications, the [**InkAnalyzer**](inkanalyzer.md) reconciles the differences in document state between the beginning and end of the analysis operation.</span></span> <span data-ttu-id="30d7a-195">Изменения, внесенные пользователем или приложением во время анализа в фоновом режиме, всегда переопределяют результаты, вычисленные в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="30d7a-195">Changes made by the user or application while the analysis is running in the background always override the results calculated in the background.</span></span> <span data-ttu-id="30d7a-196">После сверки выводятся только части структуры результатов, которые не конфликтуют с изменениями документа, а конфликтующие штрихи помечаются для будущего анализа.</span><span class="sxs-lookup"><span data-stu-id="30d7a-196">After reconciliation, only the parts of the results structure that do not conflict with document changes are reported, and the conflicting strokes are tagged for future analysis.</span></span> <span data-ttu-id="30d7a-197">В следующий раз при выполнении операции фонового анализа результаты пересчитываются на основе нового состояния.</span><span class="sxs-lookup"><span data-stu-id="30d7a-197">The next time the background analysis operation is run, the results are recalculated based on the new state.</span></span>

<span data-ttu-id="30d7a-198">Этот процесс показан на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="30d7a-198">The following diagram shows this process.</span></span> <span data-ttu-id="30d7a-199">Время выражается линейно сверху вниз на схеме.</span><span class="sxs-lookup"><span data-stu-id="30d7a-199">Time is expressed linearly from top to bottom in the diagram.</span></span>

![процесс согласования изменений состояния документа во время операции анализа](images/6323e0b5-b6b3-4adc-8c73-da3fad5b4bc2.jpg)

1.  <span data-ttu-id="30d7a-201">Во время 1 (T1) приложение собирает рукописные данные от конечного пользователя, включая любые изменения рукописного ввода, такие как добавление, удаление или изменение.</span><span class="sxs-lookup"><span data-stu-id="30d7a-201">At time 1 (t1), the application is collecting ink from the end-user, including any kind of ink modification, such as adding, removing, or modifying.</span></span>
2.  <span data-ttu-id="30d7a-202">В T2 приложение вызывает операцию фонового анализа.</span><span class="sxs-lookup"><span data-stu-id="30d7a-202">At t2, the application invokes the background analysis operation.</span></span> <span data-ttu-id="30d7a-203">[**InkAnalyzer**](inkanalyzer.md) определяет, какие рукописные данные не имеют результатов и какие рукописные данные необходимо дважды проверить.</span><span class="sxs-lookup"><span data-stu-id="30d7a-203">The [**InkAnalyzer**](inkanalyzer.md) determines what ink does not have results and what ink needs to be double-checked.</span></span> <span data-ttu-id="30d7a-204">Он копирует необходимые данные рукописного ввода, что позволяет фоновому потоку выполняться независимо друг от друга.</span><span class="sxs-lookup"><span data-stu-id="30d7a-204">It copies the needed ink data to allow the background thread to execute independently.</span></span>
3.  <span data-ttu-id="30d7a-205">В T3 [**InkAnalyzer**](inkanalyzer.md) возвращает выполнение потока пользовательского интерфейса в приложение.</span><span class="sxs-lookup"><span data-stu-id="30d7a-205">At t3, the [**InkAnalyzer**](inkanalyzer.md) returns the user interface thread execution to the application.</span></span> <span data-ttu-id="30d7a-206">**InkAnalyzer** создает второй поток, поток фонового анализа, а также механизмы анализа и распознавания рукописного текста, анализируя скопированные данные рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="30d7a-206">The **InkAnalyzer** creates a second thread, the background analysis thread, and the ink analysis and recognition engines analyze the copied ink data.</span></span>
4.  <span data-ttu-id="30d7a-207">Пока операция анализа выполняется во втором фоновом потоке, конечный пользователь продолжит редактировать документ, добавляя и удаляя данные о штрихах в T4 и T5.</span><span class="sxs-lookup"><span data-stu-id="30d7a-207">While the analysis operation is occurring on the second background thread, the end user continues to edit the document, adding and removing stroke data, at t4 and t5.</span></span> <span data-ttu-id="30d7a-208">Эти изменения могут конфликтовать с работой, которая обрабатывается в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="30d7a-208">These edits can conflict with the work that is being process in the background.</span></span>
5.  <span data-ttu-id="30d7a-209">В T6 фоновый поток завершил операцию анализа, и результаты готовы.</span><span class="sxs-lookup"><span data-stu-id="30d7a-209">At t6, the background thread has finished the analysis operation, and results are ready.</span></span> <span data-ttu-id="30d7a-210">Прежде чем [**InkAnalyzer**](inkanalyzer.md) передает результаты в приложение, он запускает алгоритм сверки, чтобы определить, что пользователь внес во время вычисления операции анализа (T4 и T5).</span><span class="sxs-lookup"><span data-stu-id="30d7a-210">Before the [**InkAnalyzer**](inkanalyzer.md) communicates the results to the application, it runs a reconciliation algorithm to determine if the user edits made while the analysis operation was being calculated (t4 and t5) conflict with the results.</span></span> <span data-ttu-id="30d7a-211">Если обнаружены конфликты, конфликтующие штрихи помечаются для повторного анализа, что происходит при следующем вызове приложением фоновой операции анализа.</span><span class="sxs-lookup"><span data-stu-id="30d7a-211">If any collisions are detected, the colliding strokes are flagged for re-analysis, which occurs the next time the application invokes the background analysis operation.</span></span>
6.  <span data-ttu-id="30d7a-212">Наконец, в T7, где обнаружены все конфликты, [**InkAnalyzer**](inkanalyzer.md) представляет результаты для приложения.</span><span class="sxs-lookup"><span data-stu-id="30d7a-212">Finally, at t7, with all the collisions detected, the [**InkAnalyzer**](inkanalyzer.md) presents the results to the application.</span></span>

### <a name="extensibility"></a><span data-ttu-id="30d7a-213">Расширение среды</span><span class="sxs-lookup"><span data-stu-id="30d7a-213">Extensibility</span></span>

<span data-ttu-id="30d7a-214">Интерфейсы API Инканалисис позволяют приложениям использовать новые типы обработчиков анализа, таким образом, чтобы приложение не пришлось переписывать все преимущества API Инканалисис, включая сверку, прокси-сервер данных, сохраняемость и добавочный анализ.</span><span class="sxs-lookup"><span data-stu-id="30d7a-214">The InkAnalysis APIs allow new types of analysis engines to be used by applications, in such a way as to prevent the application from having to rewrite all of the benefits of the InkAnalysis API, including reconciliation, data proxy, persistence, and incremental analysis.</span></span>

## <a name="related-topics"></a><span data-ttu-id="30d7a-215">См. также</span><span class="sxs-lookup"><span data-stu-id="30d7a-215">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="30d7a-216">[Microsoft. Ink](/previous-versions/dotnet/netframework-3.5/ms581553(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="30d7a-216">[Microsoft.Ink](/previous-versions/dotnet/netframework-3.5/ms581553(v=vs.90))</span></span>
</dt> <dt>

[<span data-ttu-id="30d7a-217">Справочник по анализу рукописного ввода</span><span class="sxs-lookup"><span data-stu-id="30d7a-217">Ink Analysis Reference</span></span>](ink-analysis-reference.md)
</dt> </dl>

 

 
