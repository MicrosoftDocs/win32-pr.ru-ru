---
description: Общие сведения о общих вопросах многопоточности.
ms.assetid: cf35724f-5f80-4b3e-992a-a9d5ea99aae9
title: Общие рекомендации по потокам
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 21f825ec7a1397dae7d60aa14b31603ee76a2f59
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104542138"
---
# <a name="general-threading-considerations"></a><span data-ttu-id="0e548-103">Общие рекомендации по потокам</span><span class="sxs-lookup"><span data-stu-id="0e548-103">General Threading Considerations</span></span>

<span data-ttu-id="0e548-104">Ниже приведены общие рекомендации по работе с потоками при разработке для планшетных ПК.</span><span class="sxs-lookup"><span data-stu-id="0e548-104">The following are general threading considerations when developing for Tablet PC.</span></span>

-   [<span data-ttu-id="0e548-105">Приложения и потоки, не относящиеся к приложениям</span><span class="sxs-lookup"><span data-stu-id="0e548-105">Application and Non-Application Threads</span></span>](#application-and-non-application-threads)
-   [<span data-ttu-id="0e548-106">Вопросы производительности</span><span class="sxs-lookup"><span data-stu-id="0e548-106">Performance Considerations</span></span>](#performance-considerations)
    -   [<span data-ttu-id="0e548-107">Обработчики событий</span><span class="sxs-lookup"><span data-stu-id="0e548-107">Event Handlers</span></span>](#event-handlers)
    -   [<span data-ttu-id="0e548-108">Ауторедрав, свойство</span><span class="sxs-lookup"><span data-stu-id="0e548-108">AutoRedraw Property</span></span>](#autoredraw-property)
    -   [<span data-ttu-id="0e548-109">Динамикрендеринг, свойство</span><span class="sxs-lookup"><span data-stu-id="0e548-109">DynamicRendering Property</span></span>](#dynamicrendering-property)
-   [<span data-ttu-id="0e548-110">Рекомендации по потокам событий</span><span class="sxs-lookup"><span data-stu-id="0e548-110">Event Threading Considerations</span></span>](#event-threading-considerations)
    -   [<span data-ttu-id="0e548-111">События объектов InkCollector и InkOverlay</span><span class="sxs-lookup"><span data-stu-id="0e548-111">InkCollector and InkOverlay Objects Events</span></span>](#inkcollector-and-inkoverlay-objects-events)
    -   [<span data-ttu-id="0e548-112">События сбора рукописных объектов и штрихов</span><span class="sxs-lookup"><span data-stu-id="0e548-112">Ink Object and Strokes Collection Events</span></span>](#ink-object-and-strokes-collection-events)
    -   [<span data-ttu-id="0e548-113">События распознавания</span><span class="sxs-lookup"><span data-stu-id="0e548-113">Recognition Events</span></span>](#recognition-events)
    -   [<span data-ttu-id="0e548-114">События панели ввода пера</span><span class="sxs-lookup"><span data-stu-id="0e548-114">Pen Input Panel Events</span></span>](#pen-input-panel-events)
-   [<span data-ttu-id="0e548-115">См. также</span><span class="sxs-lookup"><span data-stu-id="0e548-115">Related topics</span></span>](#related-topics)

## <a name="application-and-non-application-threads"></a><span data-ttu-id="0e548-116">Приложения и потоки, не относящиеся к приложениям</span><span class="sxs-lookup"><span data-stu-id="0e548-116">Application and Non-Application Threads</span></span>

<span data-ttu-id="0e548-117">Все события рукописного ввода создаются в отдельном потоке рукописного ввода с высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="0e548-117">All ink events are generated on a separate, high-priority ink thread.</span></span> <span data-ttu-id="0e548-118">Это позволяет работать с рукописным вводом плавно, даже если приложение работает медленно.</span><span class="sxs-lookup"><span data-stu-id="0e548-118">This allows ink to flow smoothly even when an application is running slowly.</span></span> <span data-ttu-id="0e548-119">Однако обработчики событий могут замедлить работу или заблокировать отрисовку рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="0e548-119">However, event handlers can slow down or block the rendering of ink.</span></span>

<span data-ttu-id="0e548-120">Все события распознавания, создаваемые вызовами метода распознавания фона, обрабатываются в отдельном потоке фонового распознавания текста с нормальным приоритетом.</span><span class="sxs-lookup"><span data-stu-id="0e548-120">All recognition events generated by background recognition method calls are handled on a separate, normal-priority background recognition thread.</span></span>

<span data-ttu-id="0e548-121">Все события мыши создаются в основном потоке пользовательского интерфейса приложения.</span><span class="sxs-lookup"><span data-stu-id="0e548-121">All mouse events are generated on the application's main user interface (UI) thread.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="0e548-122">Вопросы производительности</span><span class="sxs-lookup"><span data-stu-id="0e548-122">Performance Considerations</span></span>

### <a name="event-handlers"></a><span data-ttu-id="0e548-123">Обработчики событий</span><span class="sxs-lookup"><span data-stu-id="0e548-123">Event Handlers</span></span>

<span data-ttu-id="0e548-124">Прикладной программный интерфейс (API) платформы Tablet PC имеет интерактивную модель для событий, а не для модели уведомления.</span><span class="sxs-lookup"><span data-stu-id="0e548-124">The Tablet PC Platform application programming interface (API) has an interactive model for events rather than a notification model.</span></span> <span data-ttu-id="0e548-125">Не заключайте код в обработчики событий, чтобы сократить время блокировки отрисовки рукописных данных.</span><span class="sxs-lookup"><span data-stu-id="0e548-125">Keep code in event handlers short to reduce the time that ink rendering is blocked.</span></span> <span data-ttu-id="0e548-126">Набор рукописных данных Tablet PC не блокируется, но приложение не получает рукописный ввод, пока приложение заблокировано.</span><span class="sxs-lookup"><span data-stu-id="0e548-126">The collection of ink by the Tablet PC is not blocked, but your application does not receive the ink while your application is blocked.</span></span>

### <a name="autoredraw-property"></a><span data-ttu-id="0e548-127">Ауторедрав, свойство</span><span class="sxs-lookup"><span data-stu-id="0e548-127">AutoRedraw Property</span></span>

<span data-ttu-id="0e548-128">Когда приложение выполняет пользовательскую отрисовку или если ваше приложение чувствительно к проблемам рисования, можно выполнить перерисовку самостоятельно и установить свойство [**ауторедрав**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_autoredraw) в **значение false** для объекта [**InkCollector**](inkcollector-class.md) , объекта [**InkOverlay**](inkoverlay-class.md) или элемента управления [InkPicture](inkpicture-control.md) .</span><span class="sxs-lookup"><span data-stu-id="0e548-128">When your application is performing custom rendering or when your application is sensitive to painting issues, you can handle the repainting yourself and set the [**AutoRedraw**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_autoredraw) property to **false** for the [**InkCollector**](inkcollector-class.md) object, the [**InkOverlay**](inkoverlay-class.md) object, or the [InkPicture](inkpicture-control.md) control.</span></span> <span data-ttu-id="0e548-129">Используйте события, приведенные в следующей таблице, для управления перерисовкой.</span><span class="sxs-lookup"><span data-stu-id="0e548-129">Use the events in the following table to handle the repainting.</span></span>



| <span data-ttu-id="0e548-130">Объект или элемент управления</span><span class="sxs-lookup"><span data-stu-id="0e548-130">Object or Control</span></span>                                            | <span data-ttu-id="0e548-131">Событие</span><span class="sxs-lookup"><span data-stu-id="0e548-131">Event</span></span>                                                                                                                                                                                                                     |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0e548-132">[**InkCollector**](inkcollector-class.md) Объектами</span><span class="sxs-lookup"><span data-stu-id="0e548-132">[**InkCollector**](inkcollector-class.md) Object</span></span><br/> | <span data-ttu-id="0e548-133">Элемент управления базового элемента управления [. недействительные](/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1) события и [Control. Paint](/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1) .</span><span class="sxs-lookup"><span data-stu-id="0e548-133">The underlying control's [Control.Invalidated](/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1) and [Control.Paint](/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1) events.</span></span><br/>                                 |
| <span data-ttu-id="0e548-134">[**InkOverlay**](inkoverlay-class.md) Объектами</span><span class="sxs-lookup"><span data-stu-id="0e548-134">[**InkOverlay**](inkoverlay-class.md) Object</span></span><br/>     | <span data-ttu-id="0e548-135">Элемент управления базового элемента управления [. недействительные](/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1) события и [Control. Paint](/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1) .</span><span class="sxs-lookup"><span data-stu-id="0e548-135">The underlying control's [Control.Invalidated](/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1) and [Control.Paint](/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1) events.</span></span><br/>                                 |
| <span data-ttu-id="0e548-136">[InkPicture](inkpicture-control.md) Элемента</span><span class="sxs-lookup"><span data-stu-id="0e548-136">[InkPicture](inkpicture-control.md) Control</span></span><br/>      | <span data-ttu-id="0e548-137">Элементы управления, наследуемые элементом управления [InkPicture](inkpicture-control.md) [. недействительны](/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1) и события [Control. Paint](/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1) .</span><span class="sxs-lookup"><span data-stu-id="0e548-137">[InkPicture](inkpicture-control.md) control's inherited [Control.Invalidated](/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1) and [Control.Paint](/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1) events.</span></span><br/> |



 

### <a name="dynamicrendering-property"></a><span data-ttu-id="0e548-138">Динамикрендеринг, свойство</span><span class="sxs-lookup"><span data-stu-id="0e548-138">DynamicRendering Property</span></span>

<span data-ttu-id="0e548-139">Когда приложение выполняет пользовательскую отрисовку или требуется, чтобы информация, но не рукописный ввод, можно было самостоятельно обменять и отключать отрисовку рукописного ввода в режиме реального времени, присвоив свойству [**динамикрендеринг**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_dynamicrendering) **значение false** для объекта [**InkCollector**](inkcollector-class.md) , объекта [**InkOverlay**](inkoverlay-class.md) или элемента управления [InkPicture](inkpicture-control.md) .</span><span class="sxs-lookup"><span data-stu-id="0e548-139">When your application is performing custom rendering or when you want the information, but not the ink, you can handle the laying down of ink yourself and turn off real-time rendering of ink by setting the [**DynamicRendering**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_dynamicrendering) property to **false** for the [**InkCollector**](inkcollector-class.md) object, the [**InkOverlay**](inkoverlay-class.md) object, or the [InkPicture](inkpicture-control.md) control.</span></span>

## <a name="event-threading-considerations"></a><span data-ttu-id="0e548-140">Рекомендации по потокам событий</span><span class="sxs-lookup"><span data-stu-id="0e548-140">Event Threading Considerations</span></span>

<span data-ttu-id="0e548-141">События API платформы планшетных ПК вызываются в различных потоках.</span><span class="sxs-lookup"><span data-stu-id="0e548-141">Tablet PC Platform API events are raised on various threads.</span></span>

### <a name="inkcollector-and-inkoverlay-objects-events"></a><span data-ttu-id="0e548-142">События объектов InkCollector и InkOverlay</span><span class="sxs-lookup"><span data-stu-id="0e548-142">InkCollector and InkOverlay Objects Events</span></span>

<span data-ttu-id="0e548-143">Большинство событий объекта [**InkCollector**](inkcollector-class.md) и [**InkOverlay**](inkoverlay-class.md) вызываются в потоке рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="0e548-143">Most [**InkCollector**](inkcollector-class.md) and [**InkOverlay**](inkoverlay-class.md) object events are raised on the ink thread.</span></span> <span data-ttu-id="0e548-144">В потоке пользовательского интерфейса вызываются только события мыши для этих объектов.</span><span class="sxs-lookup"><span data-stu-id="0e548-144">Only the mouse events for these objects are raised on the UI thread.</span></span> <span data-ttu-id="0e548-145">Например, для объекта **InkCollector** в ПОТОКЕ пользовательского интерфейса возникает событие [**MouseDown**](inkcollector-mousedown.md) , а в потоке рукописного ввода возникает событие [**курсордовн**](inkcollector-cursordown.md) .</span><span class="sxs-lookup"><span data-stu-id="0e548-145">For example, for the **InkCollector** object, the [**MouseDown**](inkcollector-mousedown.md) event is raised on the UI thread, and the [**CursorDown**](inkcollector-cursordown.md) event is raised on the ink thread.</span></span>

### <a name="ink-object-and-strokes-collection-events"></a><span data-ttu-id="0e548-146">События сбора рукописных объектов и штрихов</span><span class="sxs-lookup"><span data-stu-id="0e548-146">Ink Object and Strokes Collection Events</span></span>

<span data-ttu-id="0e548-147">События [**рукописного ввода**](inkdisp-class.md) и сбора [**штрихов**](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) могут поступать из потока рукописного ввода или из потока пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0e548-147">The [**Ink**](inkdisp-class.md) object and [**Strokes**](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) collection events may come from the ink thread or the UI thread.</span></span> <span data-ttu-id="0e548-148">Когда приложение манипулирует объектом **рукописного ввода** или коллекцией **штрихов** , событие создается в потоке пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0e548-148">When your application manipulates the **Ink** object or **Strokes** collection, the event is generated in the UI thread.</span></span> <span data-ttu-id="0e548-149">Когда объект [**InkCollector**](inkcollector-class.md) или [**InkOverlay**](inkoverlay-class.md) обновляет коллекцию объектов **Ink** или **Stroke** , событие создается в потоке рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="0e548-149">When the [**InkCollector**](inkcollector-class.md) or the [**InkOverlay**](inkoverlay-class.md) object updates the **Ink** object or **Strokes** collection, the event is generated in the ink thread.</span></span>

<span data-ttu-id="0e548-150">Элементы управления [InkPicture](inkpicture-control-reference.md) и [InkEdit](inkedit-control-reference.md) работают в однопотоковом подразделении (STA).</span><span class="sxs-lookup"><span data-stu-id="0e548-150">The [InkPicture](inkpicture-control-reference.md) and [InkEdit](inkedit-control-reference.md) controls operate in a single-threaded apartment (STA).</span></span> <span data-ttu-id="0e548-151">Когда элемент управления InkPicture или InkEdit обновляет коллекцию объектов [**рукописного ввода**](inkdisp-class.md) или [**штрихов**](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) , в потоке пользовательского интерфейса возникает событие.</span><span class="sxs-lookup"><span data-stu-id="0e548-151">When the InkPicture or InkEdit control updates the [**Ink**](inkdisp-class.md) object or [**Strokes**](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) collection, the event is raised on the UI thread.</span></span>

### <a name="recognition-events"></a><span data-ttu-id="0e548-152">События распознавания</span><span class="sxs-lookup"><span data-stu-id="0e548-152">Recognition Events</span></span>

<span data-ttu-id="0e548-153">События распознавания вызываются в потоке пользовательского интерфейса или в потоке распознавания фона.</span><span class="sxs-lookup"><span data-stu-id="0e548-153">Recognition events are raised on the UI thread or the background recognition thread.</span></span>

-   <span data-ttu-id="0e548-154">Метод [**Recognize**](/windows/desktop/api/inked/nf-inked-iinkedit-recognize) элемента управления [InkEdit](inkedit-control-reference.md) вызывает событие [распознавания](/previous-versions/ms836436(v=msdn.10)) (только управляемая библиотека) или [**рекогнитионресулт**](inkedit-recognitionresult.md) (только автоматизация) в потоке пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0e548-154">The [InkEdit](inkedit-control-reference.md) control's [**Recognize**](/windows/desktop/api/inked/nf-inked-iinkedit-recognize) method raises the [Recognition](/previous-versions/ms836436(v=msdn.10)) (Managed Library only) or [**RecognitionResult**](inkedit-recognitionresult.md) (Automation only) event on the UI thread.</span></span>
-   <span data-ttu-id="0e548-155">Методы [**баккграундрекогнизе**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognize) и [**баккграундрекогнизевисалтернатес**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) объекта [**Рекогнизерконтекст**](inkrecognizercontext-class.md) вызывают события [**распознавания**](inkrecognizercontext-recognition.md) и [**рекогнитионвисалтернатес**](inkrecognizercontext-recognitionwithalternates.md) в потоке распознавания фона.</span><span class="sxs-lookup"><span data-stu-id="0e548-155">The [**RecognizerContext**](inkrecognizercontext-class.md) object's [**BackgroundRecognize**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognize) and [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) methods raise the [**Recognition**](inkrecognizercontext-recognition.md) and [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md) events on the background recognition thread.</span></span>

### <a name="pen-input-panel-events"></a><span data-ttu-id="0e548-156">События панели ввода пера</span><span class="sxs-lookup"><span data-stu-id="0e548-156">Pen Input Panel Events</span></span>

<span data-ttu-id="0e548-157">События [**пенинпутпанел**](peninputpanel-class.md) вызываются в потоке, в котором создается объект **пенинпутпанел** .</span><span class="sxs-lookup"><span data-stu-id="0e548-157">[**PenInputPanel**](peninputpanel-class.md) events are raised on the thread in which the **PenInputPanel** object is created.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0e548-158">См. также</span><span class="sxs-lookup"><span data-stu-id="0e548-158">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="0e548-159">[Microsoft. Ink. InkCollector. Динамикрендеринг](/previous-versions/ms836502(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="0e548-159">[Microsoft.Ink.InkCollector.DynamicRendering](/previous-versions/ms836502(v=msdn.10))</span></span>
</dt> <dt>

<span data-ttu-id="0e548-160">[Microsoft. Ink. InkOverlay. Динамикрендеринг](/previous-versions/ms833104(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="0e548-160">[Microsoft.Ink.InkOverlay.DynamicRendering](/previous-versions/ms833104(v=msdn.10))</span></span>
</dt> <dt>

<span data-ttu-id="0e548-161">[Microsoft. Ink. InkPicture. Динамикрендеринг](/previous-versions/ms582188(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="0e548-161">[Microsoft.Ink.InkPicture.DynamicRendering](/previous-versions/ms582188(v=vs.100))</span></span>
</dt> <dt>

<span data-ttu-id="0e548-162">[Microsoft. Ink. InkCollector. Ауторедрав](/previous-versions/ms836495(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="0e548-162">[Microsoft.Ink.InkCollector.AutoRedraw](/previous-versions/ms836495(v=msdn.10))</span></span>
</dt> <dt>

<span data-ttu-id="0e548-163">[Microsoft. Ink. InkOverlay. Ауторедрав](/previous-versions/ms833082(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="0e548-163">[Microsoft.Ink.InkOverlay.AutoRedraw](/previous-versions/ms833082(v=msdn.10))</span></span>
</dt> <dt>

<span data-ttu-id="0e548-164">[Microsoft. Ink. InkPicture. Ауторедрав](/previous-versions/ms582180(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="0e548-164">[Microsoft.Ink.InkPicture.AutoRedraw](/previous-versions/ms582180(v=vs.100))</span></span>
</dt> </dl>

 

