---
description: Чтобы распространить приложение с поддержкой рукописного ввода на компьютеры, не работающие под управлением Windows Vista или Windows XP Tablet PC Edition 2005 (т. е. компьютеров под управлением Windows XP, Windows Server 2003 или Windows 2000), необходимо включить необходимые модули слияния в программу установки.
ms.assetid: 97515703-0bf4-4230-ae35-181b48b70c40
title: Создание распространяемой программы установки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d1ad9b9ec8b10032d4a2bb44cca52e5c2f4178b6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539440"
---
# <a name="creating-a-redistributable-setup"></a><span data-ttu-id="1b423-103">Создание распространяемой программы установки</span><span class="sxs-lookup"><span data-stu-id="1b423-103">Creating a Redistributable Setup</span></span>

<span data-ttu-id="1b423-104">Чтобы распространить приложение с поддержкой рукописного ввода на компьютеры, не работающие под управлением Windows Vista или Windows XP Tablet PC Edition 2005 (т. е. компьютеров под управлением Windows XP, Windows Server 2003 или Windows 2000), необходимо включить необходимые модули слияния в программу установки.</span><span class="sxs-lookup"><span data-stu-id="1b423-104">To distribute an ink-enabled application to computers that are not running either Windows Vista or Windows XP Tablet PC Edition 2005 (that is, computers running Windows XP, Windows Server 2003, or Windows 2000), you must include the necessary merge modules in your setup.</span></span>

<span data-ttu-id="1b423-105">Модуль Мстпкрт. MSM merge включает все файлы, ресурсы, записи реестра и логику установки, необходимые для установщик Windows установки общих файлов, которые требуются другим платформам для запуска неуправляемых приложений, разработанных для планшетных ПК.</span><span class="sxs-lookup"><span data-stu-id="1b423-105">The Mstpcrt.msm merge module includes all of the files, resources, registry entries, and setup logic necessary for Windows Installer to install the shared files that other platforms require to run unmanaged applications developed for the Tablet PC.</span></span> <span data-ttu-id="1b423-106">Мстпкрт. MSM использует файлы установщик Windows (. msi).</span><span class="sxs-lookup"><span data-stu-id="1b423-106">Mstpcrt.msm is consumed by Windows Installer (.msi) files.</span></span> <span data-ttu-id="1b423-107">Для приложений, использующих объект [**инкдивидер**](inkdivider-class.md) , необходимо также повторно распространить инкдив. msm.</span><span class="sxs-lookup"><span data-stu-id="1b423-107">For applications that use the [**InkDivider**](inkdivider-class.md) object, you must also redistribute InkDiv.msm.</span></span> <span data-ttu-id="1b423-108">Для приложений, использующих управляемые компоненты, необходимо также включить файлы модулей слияния для этих управляемых компонентов.</span><span class="sxs-lookup"><span data-stu-id="1b423-108">For applications that use managed components, you must also include the merge module files for those managed components.</span></span>

<span data-ttu-id="1b423-109">В следующей таблице описаны файлы модулей слияния, поставляемые с пакетом SDK для Windows XP Tablet PC Edition.</span><span class="sxs-lookup"><span data-stu-id="1b423-109">The following table describes the merge module files that ship with the Windows XP Tablet PC Edition Software Development Kit (SDK).</span></span>



| <span data-ttu-id="1b423-110">Распространяемый модуль слияния</span><span class="sxs-lookup"><span data-stu-id="1b423-110">Redistributable Merge Module</span></span> | <span data-ttu-id="1b423-111">Описание</span><span class="sxs-lookup"><span data-stu-id="1b423-111">Description</span></span>                                                                                                                    | <span data-ttu-id="1b423-112">Файлы</span><span class="sxs-lookup"><span data-stu-id="1b423-112">Files</span></span>                                                       |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
| <span data-ttu-id="1b423-113">Инкдив. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-113">InkDiv.msm</span></span><br/>        | <span data-ttu-id="1b423-114">Устанавливает неуправляемую версию объекта [**инкдивидер**](inkdivider-class.md) .</span><span class="sxs-lookup"><span data-stu-id="1b423-114">Installs the unmanaged version of the [**InkDivider**](inkdivider-class.md) object.</span></span><br/>                                | <span data-ttu-id="1b423-115">InkDiv.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-115">InkDiv.dll</span></span><br/>                                       |
| <span data-ttu-id="1b423-116">Мстпкрт. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-116">Mstpcrt.msm</span></span><br/>       | <span data-ttu-id="1b423-117">Устанавливает неуправляемые компоненты платформы Tablet PC версии 1,0.</span><span class="sxs-lookup"><span data-stu-id="1b423-117">Installs the unmanaged components of the Tablet PC Platform version 1.0.</span></span><br/>                                            | <span data-ttu-id="1b423-118">Gdiplus.dll, InkEd.dll, Tpcps.dll, Wisptis.exe</span><span class="sxs-lookup"><span data-stu-id="1b423-118">Gdiplus.dll, InkEd.dll, Tpcps.dll, Wisptis.exe</span></span><br/>   |
| <span data-ttu-id="1b423-119">Msvcp60. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-119">Msvcp60.msm</span></span><br/>       | <span data-ttu-id="1b423-120">Устанавливает компоненты среды выполнения Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="1b423-120">Installs components of the Microsoft Visual C++ runtime.</span></span><br/>                                                            | <span data-ttu-id="1b423-121">Msvcp60.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-121">Msvcp60.dll</span></span><br/>                                      |
| <span data-ttu-id="1b423-122">Msvcrt. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-122">Msvcrt.msm</span></span><br/>        | <span data-ttu-id="1b423-123">Устанавливает компоненты среды выполнения Microsoft Visual C.</span><span class="sxs-lookup"><span data-stu-id="1b423-123">Installs components of the Microsoft Visual C runtime.</span></span><br/>                                                              | <span data-ttu-id="1b423-124">Msvcrt.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-124">Msvcrt.dll</span></span><br/>                                       |
| <span data-ttu-id="1b423-125">Tpcman17. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-125">Tpcman17.msm</span></span><br/>      | <span data-ttu-id="1b423-126">Устанавливает управляемые компоненты среды выполнения платформы Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="1b423-126">Installs the managed components of the Tablet PC Platform runtime.</span></span> <span data-ttu-id="1b423-127">Требует, чтобы был установлен файл мстпкрт. msm.</span><span class="sxs-lookup"><span data-stu-id="1b423-127">Requires that the mstpcrt.msm file is installed.</span></span><br/> | <span data-ttu-id="1b423-128">Microsoft.Ink.dll, Microsoft.Ink.resources.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-128">Microsoft.Ink.dll, Microsoft.Ink.resources.dll</span></span><br/>   |
| <span data-ttu-id="1b423-129">Иаком. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-129">iaCOM.msm</span></span><br/>         | <span data-ttu-id="1b423-130">Устанавливает компоненты автоматизации API Инканалисис.</span><span class="sxs-lookup"><span data-stu-id="1b423-130">Installs the Automation components of the InkAnalysis API.</span></span><br/>                                                          | <span data-ttu-id="1b423-131">IACom.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-131">IACom.dll</span></span><br/>                                        |
| <span data-ttu-id="1b423-132">IACore. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-132">iacore.msm</span></span><br/>        | <span data-ttu-id="1b423-133">Устанавливает компоненты базового класса API Инканалисис.</span><span class="sxs-lookup"><span data-stu-id="1b423-133">Installs the base class components of the InkAnalysis API.</span></span><br/>                                                          | <span data-ttu-id="1b423-134">IACore.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-134">IACore.dll</span></span><br/> <span data-ttu-id="1b423-135">IALoader.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-135">IALoader.dll</span></span><br/>               |
| <span data-ttu-id="1b423-136">Иавинфрм. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-136">IAWinFrm.msm</span></span><br/>      | <span data-ttu-id="1b423-137">Устанавливает компоненты управляемой библиотеки API Инканалисис.</span><span class="sxs-lookup"><span data-stu-id="1b423-137">Installs the managed library components of the InkAnalysis API.</span></span><br/>                                                     | <span data-ttu-id="1b423-138">Microsoft.Ink.Analysis.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-138">Microsoft.Ink.Analysis.dll</span></span><br/>                       |
| <span data-ttu-id="1b423-139">IAWinFX. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-139">IAWinFX.msm</span></span><br/>       | <span data-ttu-id="1b423-140">Устанавливает Windows Presentation Foundation компонентов API Инканалисис.</span><span class="sxs-lookup"><span data-stu-id="1b423-140">Installs the Windows Presentation Foundation components of the InkAnalysis API.</span></span><br/>                                     | <span data-ttu-id="1b423-141">IAWinFX.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-141">IAWinFX.dll</span></span><br/>                                      |
| <span data-ttu-id="1b423-142">журнал. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-142">journal.msm</span></span><br/>       | <span data-ttu-id="1b423-143">Устанавливает компоненты модуля чтения журнала.</span><span class="sxs-lookup"><span data-stu-id="1b423-143">Installs the Journal Reader components.</span></span><br/>                                                                             | <span data-ttu-id="1b423-144">Journal.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-144">Journal.dll</span></span><br/> <span data-ttu-id="1b423-145">Microsoft.ink.journal.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-145">Microsoft.ink.journal.dll</span></span><br/> |
| <span data-ttu-id="1b423-146">ртском. MSM</span><span class="sxs-lookup"><span data-stu-id="1b423-146">rtscom.msm</span></span><br/>        | <span data-ttu-id="1b423-147">Устанавливает компоненты автоматизации пространства имен Стилусинпут.</span><span class="sxs-lookup"><span data-stu-id="1b423-147">Installs the Automation components of the StylusInput namespace.</span></span><br/>                                                    | <span data-ttu-id="1b423-148">Rtscom.dll</span><span class="sxs-lookup"><span data-stu-id="1b423-148">Rtscom.dll</span></span><br/>                                       |



 

> [!Note]  
> <span data-ttu-id="1b423-149">Чтобы использовать функциональные возможности платформы Microsoft .NET, включенной в модули слияния для управляемых компонентов, необходимо установить пакет обновления 2 (SP2) для платформы на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="1b423-149">To use the functionality of the Microsoft .NET Framework that is included in merge modules for managed components, you must have installed Service Pack 2 of the Framework on the target computer.</span></span>

 

## <a name="reduced-feature-set"></a><span data-ttu-id="1b423-150">Сокращенный набор функций</span><span class="sxs-lookup"><span data-stu-id="1b423-150">Reduced Feature Set</span></span>

<span data-ttu-id="1b423-151">Приложения с поддержкой рукописного ввода обрабатывают события мыши как движения пером для имитации работы с планшетным пером.</span><span class="sxs-lookup"><span data-stu-id="1b423-151">Ink-enabled applications treat mouse events as pen movements to simulate working with a tablet pen.</span></span> <span data-ttu-id="1b423-152">Пользователи могут добавлять рукописный ввод, стирать рукописный ввод и сохранять документы с рукописным вводом.</span><span class="sxs-lookup"><span data-stu-id="1b423-152">Users can add ink, erase ink, and save ink documents.</span></span> <span data-ttu-id="1b423-153">Однако распознавание и жесты недоступны для пользователей, не использующих Windows XP Tablet PC Edition.</span><span class="sxs-lookup"><span data-stu-id="1b423-153">However, recognition and gestures are not available for users other than those running Windows XP Tablet PC Edition.</span></span>

<span data-ttu-id="1b423-154">Мстпкрт. MSM не включает в себя журнал Windows или панель ввода Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="1b423-154">Mstpcrt.msm does not include Windows Journal or Tablet PC Input Panel.</span></span>

<span data-ttu-id="1b423-155">Объект [**пенинпутпанел**](peninputpanel-class.md) не работает ни в каких операционных системах, кроме Windows XP Tablet PC Edition.</span><span class="sxs-lookup"><span data-stu-id="1b423-155">The [**PenInputPanel**](peninputpanel-class.md) object does not function on any operating systems besides Windows XP Tablet PC Edition.</span></span>

## <a name="deployment"></a><span data-ttu-id="1b423-156">Развертывание</span><span class="sxs-lookup"><span data-stu-id="1b423-156">Deployment</span></span>

> [!Note]  
> <span data-ttu-id="1b423-157">Если приложение использует управляемый код, необходимо также развернуть платформу.</span><span class="sxs-lookup"><span data-stu-id="1b423-157">If your application uses managed code, you must also deploy the Framework.</span></span> <span data-ttu-id="1b423-158">Платформа должна быть установлена до установки управляемых сборок для планшетных ПК.</span><span class="sxs-lookup"><span data-stu-id="1b423-158">The Framework must be installed before your Tablet PC managed assemblies are installed.</span></span>

 

<span data-ttu-id="1b423-159">Чтобы включить Мстпкрт. msm в проект установки Microsoft Visual Studio .NET, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="1b423-159">To include Mstpcrt.msm in a Microsoft Visual Studio .NET Setup project:</span></span>

1.  <span data-ttu-id="1b423-160">В обозреватель решений выберите проект установки.</span><span class="sxs-lookup"><span data-stu-id="1b423-160">In the Solution Explorer, select your Setup project.</span></span>
2.  <span data-ttu-id="1b423-161">В меню Проект выберите команду **Добавить**, а затем щелкните **модуль слияния**.</span><span class="sxs-lookup"><span data-stu-id="1b423-161">On the Project menu, click **Add**, and then click **Merge Module**.</span></span>
    > [!Note]  
    > <span data-ttu-id="1b423-162">Можно также открыть диалоговое окно **Добавление модулей** , щелкнув правой кнопкой мыши имя проекта установщика в Обозреватель решений, нажать кнопку **Добавить**, а затем выбрать **модуль слияния**.</span><span class="sxs-lookup"><span data-stu-id="1b423-162">You can also reach the **Add Modules** dialog box by right-clicking the installer project name in the Solution Explorer, clicking **Add**, and then selecting **Merge Module**.</span></span>

     

3.  <span data-ttu-id="1b423-163">В диалоговом окне **Добавление модулей** перейдите к и выберите **мстпкрт. MSM**.</span><span class="sxs-lookup"><span data-stu-id="1b423-163">In the **Add Modules** dialog box, navigate to and select **Mstpcrt.msm**.</span></span>
4.  <span data-ttu-id="1b423-164">Нажмите кнопку **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="1b423-164">Click **Open**.</span></span>

<span data-ttu-id="1b423-165">Мстпкрт. MSM добавляется в проект установки и отображается в окне обозреватель решений.</span><span class="sxs-lookup"><span data-stu-id="1b423-165">Mstpcrt.msm is added to your Setup project and appears in the Solution Explorer window.</span></span>

<span data-ttu-id="1b423-166">Установщик Windows добавляет файлы, содержащиеся в модуле слияния, в папку Program Files.</span><span class="sxs-lookup"><span data-stu-id="1b423-166">Windows Installer adds the files contained in the merge module to the Program Files folder.</span></span> <span data-ttu-id="1b423-167">Чтобы использовать эти файлы, конечные пользователи должны войти в систему с учетной записью, имеющей доступ к папке Program Files.</span><span class="sxs-lookup"><span data-stu-id="1b423-167">To use these files, end users must be logged on with an account that has access to the Program Files folder.</span></span>

> [!Note]  
> <span data-ttu-id="1b423-168">В последовательность установки необходимо добавить действия [селфрегмодулес](../msi/selfregmodules-action.md) и действия [селфунрегмодулес](../msi/selfunregmodules-action.md) .</span><span class="sxs-lookup"><span data-stu-id="1b423-168">You must add [SelfRegModules Action](../msi/selfregmodules-action.md) and [SelfUnregModules Action](../msi/selfunregmodules-action.md) actions to the installation sequence.</span></span> <span data-ttu-id="1b423-169">Действия [мсипублишассемблиес](../msi/msipublishassemblies-action.md) и действия [мсиунпублишассемблиес](/windows/desktop/Msi/msiunpublishassemblies-action) получают их порядок в последовательности установки из этих действий.</span><span class="sxs-lookup"><span data-stu-id="1b423-169">The [MsiPublishAssemblies Action](../msi/msipublishassemblies-action.md) and [MsiUnpublishAssemblies Action](/windows/desktop/Msi/msiunpublishassemblies-action) actions receive their order in the installation sequence from these actions.</span></span>

 

 

