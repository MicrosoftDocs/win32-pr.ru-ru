---
description: Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, оба из которых могут быть внедрены и поддерживаются любым контейнером OLE.
ms.assetid: fbd7bdf0-63b4-48d1-be91-eabbbb3f1618
title: Приемники и объекты Тинк
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ef7ed1c06d256fe8eda9fad4bf15afa19fcb833
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674403"
---
# <a name="sink-and-tink-objects"></a><span data-ttu-id="6a124-103">Приемники и объекты Тинк</span><span class="sxs-lookup"><span data-stu-id="6a124-103">sInk and tInk Objects</span></span>

<span data-ttu-id="6a124-104">Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, оба из которых могут быть внедрены и поддерживаются любым контейнером OLE.</span><span class="sxs-lookup"><span data-stu-id="6a124-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container.</span></span> <span data-ttu-id="6a124-105">Они создаются путем вызова **метода Ink. клипбоардкопи (прямоугольника, инкклипбоардформатс, инкклипбоардмодес)** или **метода Ink. клипбоардкопи (штрихов, инкклипбоардформатс, InkClipboardModes)** .</span><span class="sxs-lookup"><span data-stu-id="6a124-105">They are produced by calling either the **Ink.ClipboardCopy Method (Rectangle, InkClipboardFormats, InkClipboardModes)** or the **Ink.ClipboardCopy Method (Strokes, InkClipboardFormats, InkClipboardModes)** method and are:</span></span>

-   <span data-ttu-id="6a124-106">Объект рукописного ввода текста (Тинк).</span><span class="sxs-lookup"><span data-stu-id="6a124-106">Text ink object (tInk).</span></span> <span data-ttu-id="6a124-107">Это объект OLE, представляющий рукописный ввод, который должен образовывать слова.</span><span class="sxs-lookup"><span data-stu-id="6a124-107">This is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="6a124-108">Объект Тинк позволяет преобразовать рукописный ввод в текст в виде текста, возвращаемого распознавателем, или выбора, полученного из списка вариантов распознавания.</span><span class="sxs-lookup"><span data-stu-id="6a124-108">A tInk object allows the handwritten ink to be converted to text, either as the text returned by a recognizer or the choice taken from a list of recognition alternates.</span></span> <span data-ttu-id="6a124-109">Цвет и размер рукописного ввода могут быть заданы программно и могут основываться на атрибутах текста вокруг объекта.</span><span class="sxs-lookup"><span data-stu-id="6a124-109">The color and size of the ink can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="6a124-110">Объект Тинк должен содержать одно слово. Объект Тинк — это небольшой легковесный объект, который может выполнять простые операции вроде отрисовки (с заданными маркерами контекста устройства (HDC) и RECT) и сохранения самого себя (при наличии потока).</span><span class="sxs-lookup"><span data-stu-id="6a124-110">The tInk object is intended to contain a single word.The tInk object is a small, lightweight object that can perform simple operations like rendering (given a handle to a device context (HDC) and a RECT), and persisting itself (given a stream).</span></span> <span data-ttu-id="6a124-111">Использование объекта Тинк обеспечивает удобство работы пользователя при работе в приложении, использующем входные и рукописные данные и текст.</span><span class="sxs-lookup"><span data-stu-id="6a124-111">Using a tInk object allows a seamless user experience when working in an application that uses input of both handwriting and text.</span></span>
-   <span data-ttu-id="6a124-112">Объект рукописного ввода эскиза (приемник).</span><span class="sxs-lookup"><span data-stu-id="6a124-112">Sketch ink object (sInk).</span></span> <span data-ttu-id="6a124-113">Это объект OLE, представляющий рукописный ввод, который не должен сообразовывать слова.</span><span class="sxs-lookup"><span data-stu-id="6a124-113">This is an OLE object representing ink that is not expected to form words.</span></span> <span data-ttu-id="6a124-114">Объект-приемник интерпретируется как рисунок.</span><span class="sxs-lookup"><span data-stu-id="6a124-114">A sInk object is interpreted as a drawing.</span></span> <span data-ttu-id="6a124-115">Объект-приемник также полезен для представления нескольких слов.</span><span class="sxs-lookup"><span data-stu-id="6a124-115">A sInk object is also useful for representing multiple words.</span></span>

<span data-ttu-id="6a124-116">Эти объекты можно использовать для взаимодействия приложений либо путем их помещения в область объектов OLE в буфере обмена, либо путем их внедрения в формате RTF.</span><span class="sxs-lookup"><span data-stu-id="6a124-116">These objects can be used for interoperability between applications, either by placing them in the OLE object slot on the Clipboard or by embedding them in Rich Text Format (RTF).</span></span>

<span data-ttu-id="6a124-117">Объекты Тинк и sInk можно использовать следующими способами.</span><span class="sxs-lookup"><span data-stu-id="6a124-117">You can use tInk and sInk objects in the following ways:</span></span>

-   <span data-ttu-id="6a124-118">В Microsoft Word 2002 поддерживаются объекты Тинк и sInk.</span><span class="sxs-lookup"><span data-stu-id="6a124-118">Both tInk and sInk objects are supported in Microsoft Word 2002.</span></span> <span data-ttu-id="6a124-119">Пользователи могут вставлять рукописные данные в документ Word с помощью панелей рукописного ввода и вывода текста, представленных в Word 2002.</span><span class="sxs-lookup"><span data-stu-id="6a124-119">Users can insert ink into a Word document by using the writing and drawing text input panels provided in Word 2002.</span></span> <span data-ttu-id="6a124-120">Этот рукописный ввод внедряется в файл Word как объект OLE с идентификатором CLSID объекта приемника или Тинк.</span><span class="sxs-lookup"><span data-stu-id="6a124-120">This ink is embedded into the Word file as an OLE object with the CLSID of either the sInk or tInk object.</span></span>
-   <span data-ttu-id="6a124-121">Элемент управления [InkEdit](/previous-versions/ms552265(v=vs.100)) планшетного ПК использует объект Тинк.</span><span class="sxs-lookup"><span data-stu-id="6a124-121">The Tablet PC [InkEdit](/previous-versions/ms552265(v=vs.100)) control makes use of the tInk object.</span></span> <span data-ttu-id="6a124-122">Элемент управления InkEdit является подклассом стандартного элемента управления [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) .</span><span class="sxs-lookup"><span data-stu-id="6a124-122">The InkEdit control is a subclass of the standard [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) control.</span></span> <span data-ttu-id="6a124-123">Рукописный ввод вставляется в поток RTF элемента управления InkEdit в виде объекта Тинк.</span><span class="sxs-lookup"><span data-stu-id="6a124-123">Ink is inserted into the InkEdit control's RTF stream as a tInk object.</span></span>
-   <span data-ttu-id="6a124-124">Когда приложение перемещает выбранный объект [рукописного ввода](/previous-versions/aa515768(v=msdn.10)) в буфер обмена, в слоте буфера обмена объектов OLE СОДЕРЖИТСЯ объект OLE Тинк или Sink.</span><span class="sxs-lookup"><span data-stu-id="6a124-124">When an application moves a selected [Ink](/previous-versions/aa515768(v=msdn.10)) object onto the Clipboard, the OLE object Clipboard slot contains a tInk or sInk OLE object.</span></span>

<span data-ttu-id="6a124-125">Например, приложение может распознать рукописный ввод и пометить любой объект [рукописного](/previous-versions/aa515768(v=msdn.10)) ввода как объект Тинк.</span><span class="sxs-lookup"><span data-stu-id="6a124-125">For example, your application can recognize handwriting and mark any [Ink](/previous-versions/aa515768(v=msdn.10)) object as a tInk object.</span></span> <span data-ttu-id="6a124-126">Если выбрать слово в рукописном вводе, скопировать и вставить его в Word, варианты для этого слова будут показаны в Word 2002.</span><span class="sxs-lookup"><span data-stu-id="6a124-126">Then, if you select a word in ink and copy and paste it to Word, alternates for that word are shown in Word 2002.</span></span>

> [!Note]  
> <span data-ttu-id="6a124-127">При помещении в буфер обмена объекта приемника или Тинк в качестве объекта OLE в буфере обмена для платформы Tablet PC поддерживается автоматический выбор флага расширенный метафайл (EMF).</span><span class="sxs-lookup"><span data-stu-id="6a124-127">The Tablet PC Platform's Clipboard support automatically selects the Enhanced Metafile (EMF) flag for you when you place a sInk or tInk object on the Clipboard as an OLE object.</span></span> <span data-ttu-id="6a124-128">Сам объект хранится в буфере обмена в слотах источника и объекта внедрения.</span><span class="sxs-lookup"><span data-stu-id="6a124-128">The object itself is stored on the Clipboard in the embed source and object descriptor slots.</span></span>

 

<span data-ttu-id="6a124-129">В качестве другого примера с помощью объекта sInk можно нарисовать набросок в приложении, скопировать и вставить эскиз в Word 2002, а затем редактировать рисунок с помощью панели ввода Tablet PC в Word.</span><span class="sxs-lookup"><span data-stu-id="6a124-129">As another example, by using the sInk object, you can draw an ink sketch in an application, copy and paste the sketch to Word 2002, and then edit the drawing by using Tablet PC Input Panel in Word.</span></span>

<span data-ttu-id="6a124-130">Чтобы успешно содержать объекты Тинк, приложение должно реализовать поддержку контейнера OLE для внедренных объектов.</span><span class="sxs-lookup"><span data-stu-id="6a124-130">In order to successfully contain tInk objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="6a124-131">Затем, чтобы сделать контейнер полностью поддерживаемым Тинк, необходимо Институт:</span><span class="sxs-lookup"><span data-stu-id="6a124-131">Then, to make the container fully support tInk, you must institute:</span></span>

-   <span data-ttu-id="6a124-132">Изменения в коде для поиска и замены.</span><span class="sxs-lookup"><span data-stu-id="6a124-132">Modifications to the code for Find and Replace.</span></span> <span data-ttu-id="6a124-133">Вместо того чтобы пропускать внедренные объекты в поиске, эти объекты должны быть опрошены для типа.</span><span class="sxs-lookup"><span data-stu-id="6a124-133">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="6a124-134">Если они являются объектом Тинк, они должны быть созданы и запрошены для соответствующего текста.</span><span class="sxs-lookup"><span data-stu-id="6a124-134">If they are a tInk object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="6a124-135">Изменения в поведении выбора.</span><span class="sxs-lookup"><span data-stu-id="6a124-135">Modifications to selection behavior.</span></span> <span data-ttu-id="6a124-136">Выбор объектов Тинк никогда не должен появляться с маркерами изменения размера.</span><span class="sxs-lookup"><span data-stu-id="6a124-136">Selection of tInk objects should never appear with sizing handles.</span></span> <span data-ttu-id="6a124-137">Они должны быть выбраны точно так же, как текст выбирается в документе.</span><span class="sxs-lookup"><span data-stu-id="6a124-137">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="6a124-138">Код выбора для объектов должен определять, является ли тип Тинк, и отображать выбор соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="6a124-138">Selection code for objects must detect if the type is tInk and display the selection appropriately.</span></span>
-   <span data-ttu-id="6a124-139">Использование внешних свойств.</span><span class="sxs-lookup"><span data-stu-id="6a124-139">Use of ambient properties.</span></span> <span data-ttu-id="6a124-140">Свойства окружающей среды, такие как размер шрифта, цвет и полужирное начертание, должны передаваться в объект Тинк.</span><span class="sxs-lookup"><span data-stu-id="6a124-140">Ambient properties such as font size, color, and bold formatting need to be transmitted to the tInk object.</span></span> <span data-ttu-id="6a124-141">Приложение этих свойств изменяет ширину рукописных рукописных данных, поэтому требуется обновление размера путем вызова [**метода жетинкекстент**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) или метода [иолеобжект::-экстента](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .</span><span class="sxs-lookup"><span data-stu-id="6a124-141">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**GetInkExtent Method**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>
-   <span data-ttu-id="6a124-142">Переопределите метод обработки [иолеобжект::D оверб](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6a124-142">Override the default [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) method processing.</span></span> <span data-ttu-id="6a124-143">Это позволяет преобразовать в текст, чтобы передать в распознаватель пакет объектов Тинк, который затем может разбивать слова на сегменты распознавания.</span><span class="sxs-lookup"><span data-stu-id="6a124-143">This allows conversion to text to pass a batch of tInk objects to the recognizer, which can then break the words into recognition segments.</span></span>

<span data-ttu-id="6a124-144">Дополнительные сведения о разбиении слов на сегменты распознавания см. в разделе [сегменты распознавания](recognition-segments.md).</span><span class="sxs-lookup"><span data-stu-id="6a124-144">For more information about breaking words into recognition segments, see [Recognition Segments](recognition-segments.md).</span></span>

 

 
