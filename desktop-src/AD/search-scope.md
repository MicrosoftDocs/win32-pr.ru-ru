---
title: Указание области поиска
description: Область поиска можно указать как в базовом, на одном уровне, так и в поддереве.
ms.assetid: b02354c2-7b95-4911-8ae3-4a261d3ca2d3
ms.tgt_platform: multiple
keywords:
- Указание области поиска AD
- Active Directory, поиск, указание области поиска
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7ff076e0410088c69eace25f204241c1c51c6fb
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789475"
---
# <a name="specifying-the-search-scope"></a><span data-ttu-id="6529f-105">Указание области поиска</span><span class="sxs-lookup"><span data-stu-id="6529f-105">Specifying the Search Scope</span></span>

<span data-ttu-id="6529f-106">Область поиска можно указать как в базовом, на одном уровне, так и в поддереве.</span><span class="sxs-lookup"><span data-stu-id="6529f-106">You can specify the scope of a search as either a base, one-level, or subtree search.</span></span> <span data-ttu-id="6529f-107">Используйте флаг **\_ \_ \_ области поиска ADS Сеарчпреф** со значениями перечисления [**ADS \_ скопинум**](/windows/win32/api/iads/ne-iads-ads_scopeenum) , чтобы указать область поиска.</span><span class="sxs-lookup"><span data-stu-id="6529f-107">Use the **ADS\_SEARCHPREF\_SEARCH\_SCOPE** flag with the values of the [**ADS\_SCOPEENUM**](/windows/win32/api/iads/ne-iads-ads_scopeenum) enumeration to specify the search scope.</span></span> <span data-ttu-id="6529f-108">В следующем списке содержатся описания типов поиска:</span><span class="sxs-lookup"><span data-stu-id="6529f-108">The following list includes descriptions of the search types:</span></span>

-   <span data-ttu-id="6529f-109">**Базовый**.</span><span class="sxs-lookup"><span data-stu-id="6529f-109">**Base**.</span></span> <span data-ttu-id="6529f-110">Базовый поиск ограничивает поиск базовым объектом.</span><span class="sxs-lookup"><span data-stu-id="6529f-110">A base search limits the search to the base object.</span></span> <span data-ttu-id="6529f-111">Максимальное число возвращаемых объектов всегда равно единице.</span><span class="sxs-lookup"><span data-stu-id="6529f-111">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="6529f-112">Этот поиск полезен для проверки существования объекта для получения членства в группе.</span><span class="sxs-lookup"><span data-stu-id="6529f-112">This search is useful to verify the existence of an object for retrieving group membership.</span></span> <span data-ttu-id="6529f-113">Например, если имеется различающееся имя объекта и необходимо проверить существование объекта на основе пути, можно использовать одноуровневый поиск.</span><span class="sxs-lookup"><span data-stu-id="6529f-113">For example, if you have an object distinguished name, and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="6529f-114">Если поиск завершается неудачно, можно предположить, что объект был переименован или перемещен в другое расположение, или вы получили неверные сведения об объекте.</span><span class="sxs-lookup"><span data-stu-id="6529f-114">If the search fails, you can assume that the object may have been renamed or moved to a different location, or you were given the wrong information about the object.</span></span> <span data-ttu-id="6529f-115">Имейте в виду, что вместо различающегося имени следует хранить глобальный уникальный идентификатор (GUID) объекта, если вы хотите повторно посетить объект.</span><span class="sxs-lookup"><span data-stu-id="6529f-115">Be aware that you should store the globally unique identifier (GUID) of the object instead of the distinguished name, if you wish to revisit an object.</span></span> <span data-ttu-id="6529f-116">Идентификатор GUID всегда будет ссылаться на тот же объект, независимо от того, где находится объект в иерархии каталогов.</span><span class="sxs-lookup"><span data-stu-id="6529f-116">The GUID will always reference the same object, regardless of where the object is located within the directory hierarchy.</span></span>
-   <span data-ttu-id="6529f-117">**Один уровень**.</span><span class="sxs-lookup"><span data-stu-id="6529f-117">**One-level**.</span></span> <span data-ttu-id="6529f-118">Одноуровневый поиск ограничивается непосредственными дочерними элементами базового объекта, но исключает сам базовый объект.</span><span class="sxs-lookup"><span data-stu-id="6529f-118">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="6529f-119">Этот параметр может выполнять целевой поиск непосредственных дочерних объектов родительского объекта.</span><span class="sxs-lookup"><span data-stu-id="6529f-119">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="6529f-120">Например, рассмотрим родительский объект P1 и его непосредственные дочерние элементы: C1, C2 и C3.</span><span class="sxs-lookup"><span data-stu-id="6529f-120">For example, consider a parent object P1 and its immediate children: C1, C2, and C3.</span></span> <span data-ttu-id="6529f-121">Одноуровневый поиск вычисляет C1, C2 и C3 в соответствии с критериями поиска, но не вычисляет P1.</span><span class="sxs-lookup"><span data-stu-id="6529f-121">A one-level search evaluates C1, C2, and C3 against the search criteria, but does not evaluate P1.</span></span> <span data-ttu-id="6529f-122">Используйте одноуровневый поиск для перечисления всех дочерних элементов объекта.</span><span class="sxs-lookup"><span data-stu-id="6529f-122">Use a one-level search to enumerate all children of an object.</span></span> <span data-ttu-id="6529f-123">Перечисление [**иадсконтаинер**](/windows/desktop/api/iads/nn-iads-iadscontainer) преобразуется в одноуровневый поиск.</span><span class="sxs-lookup"><span data-stu-id="6529f-123">An [**IADsContainer**](/windows/desktop/api/iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>
-   <span data-ttu-id="6529f-124">**Поддерево**.</span><span class="sxs-lookup"><span data-stu-id="6529f-124">**Subtree**.</span></span> <span data-ttu-id="6529f-125">Поиск в поддереве (или глубоком поиске) включает все дочерние объекты, а также базовый объект.</span><span class="sxs-lookup"><span data-stu-id="6529f-125">A subtree search (or a deep search) includes all child objects as well as the base object.</span></span> <span data-ttu-id="6529f-126">Вы можете запросить у поставщика LDAP отследить ссылки на другие службы каталогов LDAP, включая другие домены или леса каталога.</span><span class="sxs-lookup"><span data-stu-id="6529f-126">You can request the LDAP provider to chase referrals to other LDAP directory services, including other directory domains or forests.</span></span>

 

 