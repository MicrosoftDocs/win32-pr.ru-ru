---
title: Модель репликации программиста в службах домен Active Directory Services
description: Ниже приведено описание модели репликации для служб домен Active Directory.
ms.assetid: 45baf7ff-9474-4f86-81c8-03336901fec2
ms.tgt_platform: multiple
keywords:
- Модель программиста Active Directory репликации AD
- Модель репликации программиста в службах домен Active Directory Services
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9ada20bc07411528eaea4b7ff8c773c50ae8b6ec
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067281"
---
# <a name="a-programmers-model-of-replication-in-active-directory-domain-services"></a><span data-ttu-id="665a3-105">Модель репликации программиста в службах домен Active Directory Services</span><span class="sxs-lookup"><span data-stu-id="665a3-105">A Programmer's Model of Replication in Active Directory Domain Services</span></span>

<span data-ttu-id="665a3-106">Ниже приведено описание модели репликации для служб домен Active Directory.</span><span class="sxs-lookup"><span data-stu-id="665a3-106">The following is a description of the replication model for Active Directory Domain Services.</span></span>

<span data-ttu-id="665a3-107">Все обновления контроллера домен Active Directory (DC) выполняются с помощью запросов LDAP, которые создают, изменяют или удаляют один объект для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="665a3-107">All updates to the Active Directory Domain Controller (DC) are performed using LDAP requests that create, modify, or delete one object for each request.</span></span> <span data-ttu-id="665a3-108">Один запрос может устанавливать или изменять несколько атрибутов объекта.</span><span class="sxs-lookup"><span data-stu-id="665a3-108">A single request can set or modify multiple attributes on an object.</span></span>

<span data-ttu-id="665a3-109">Запрос на обновление обрабатывается как атомарная транзакция на некотором контроллере домена.</span><span class="sxs-lookup"><span data-stu-id="665a3-109">An update request is processed as an atomic transaction at some DC.</span></span> <span data-ttu-id="665a3-110">Происходит либо все обновление, либо ни одно из них.</span><span class="sxs-lookup"><span data-stu-id="665a3-110">Either the entire update happens or none of it does.</span></span> <span data-ttu-id="665a3-111">Если инициатор запроса получает успешный ответ на запрос на обновление, весь запрос успешно выполнен (фиксируется).</span><span class="sxs-lookup"><span data-stu-id="665a3-111">If the requester receives a successful response to an update request, that entire request has succeeded (committed).</span></span> <span data-ttu-id="665a3-112">Это называется «исходной записью».</span><span class="sxs-lookup"><span data-stu-id="665a3-112">This is called an "originating write."</span></span> <span data-ttu-id="665a3-113">Несколько LDAP-запросов нельзя сгруппировать в одну более крупную транзакцию.</span><span class="sxs-lookup"><span data-stu-id="665a3-113">Multiple LDAP requests cannot be grouped into a single larger transaction.</span></span>

<span data-ttu-id="665a3-114">В исходной записи контроллер домена рассчитывает «отметку» для каждого нового или измененного значения атрибута и прикрепляет эту отметку к значению, поэтому при репликации значения отметка также реплицируется.</span><span class="sxs-lookup"><span data-stu-id="665a3-114">In an originating write, a DC computes a "stamp" for each new or modified attribute value, and attaches this stamp to the value so when the value is replicated, the stamp is replicated too.</span></span> <span data-ttu-id="665a3-115">Новая метка является уникальной, и в случае обновления новая отметка больше, чем метка старого значения на этом контроллере домена.</span><span class="sxs-lookup"><span data-stu-id="665a3-115">The new stamp is unique, and in case of an update, the new stamp is larger than the stamp on the old value at that DC.</span></span>

<span data-ttu-id="665a3-116">Иногда контроллер домена выбирает набор объектов, которые были изменены с момента последнего выполнения репликации контроллером домена.</span><span class="sxs-lookup"><span data-stu-id="665a3-116">Occasionally, a DC selects the set of objects that have changed since the last time the DC performed replication.</span></span> <span data-ttu-id="665a3-117">Затем для каждого объекта он отправляет одно сообщение всем другим контроллерам домена, содержащим все текущие значения атрибутов, измененных с момента последнего выполнения репликации объекта.</span><span class="sxs-lookup"><span data-stu-id="665a3-117">Then, for each object, it sends a single message to all other DCs that contain all the current values of attributes changed since the last time the object was replicated.</span></span> <span data-ttu-id="665a3-118">Сообщения репликации являются надежными и доставляются по порядку, но для их доставки может потребоваться больше времени.</span><span class="sxs-lookup"><span data-stu-id="665a3-118">Replication messages are reliable and are delivered in order, but may require more time to be delivered.</span></span>

<span data-ttu-id="665a3-119">Когда один контроллер домена получает сообщение репликации от другого контроллера домена, он обрабатывает его следующим образом: для каждого измененного атрибута, если метка значения в сообщении репликации больше, чем метка на текущем значении, контроллер домена применяет обновление. в противном случае контроллер домена отклоняет обновление.</span><span class="sxs-lookup"><span data-stu-id="665a3-119">When one DC receives a replication message from another DC, it processes it as follows: For each modified attribute, if the stamp on the value in the replication message is larger than the stamp on the current value, the DC applies the update; otherwise the DC discards the update.</span></span> <span data-ttu-id="665a3-120">Каждое сообщение репликации применяется как атомарная транзакция, как и исходная запись.</span><span class="sxs-lookup"><span data-stu-id="665a3-120">Each replication message is applied as an atomic transaction, just like an originating write.</span></span>

<span data-ttu-id="665a3-121">Это модель репликации служб домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="665a3-121">That is the Active Directory Domain Services replication model.</span></span> <span data-ttu-id="665a3-122">К ключевым свойствам этой модели относятся:</span><span class="sxs-lookup"><span data-stu-id="665a3-122">Key properties of this model include:</span></span>

-   <span data-ttu-id="665a3-123">Исходная запись в один объект является атомарной.</span><span class="sxs-lookup"><span data-stu-id="665a3-123">An originating write to a single object is atomic.</span></span>
-   <span data-ttu-id="665a3-124">При репликации изменений отправляются либо все изменения, внесенные в исходной записи, либо ни одно из них.</span><span class="sxs-lookup"><span data-stu-id="665a3-124">When replicating changes, either all the changes made by an originating write are sent or none of them are.</span></span>
-   <span data-ttu-id="665a3-125">Реплицированная запись в один объект является атомарной, но конфликты разрешаются атрибутом по атрибуту.</span><span class="sxs-lookup"><span data-stu-id="665a3-125">A replicated write to a single object is atomic, but conflicts are resolved attribute-by-attribute.</span></span>

<span data-ttu-id="665a3-126">Модель не гарантирует порядок репликации изменений, внесенных в различные объекты.</span><span class="sxs-lookup"><span data-stu-id="665a3-126">The model does not guarantee the replication ordering of changes made to different objects.</span></span> <span data-ttu-id="665a3-127">Не создавайте приложения, которые предполагают, что изменения реплицируются в исходном порядке записи.</span><span class="sxs-lookup"><span data-stu-id="665a3-127">Do not write applications that assume that changes are replicated in originating-write order.</span></span> <span data-ttu-id="665a3-128">Модель не гарантирует, что если атрибут объекта изменяется дважды, будут реплицированы оба значения. Репликация отправляет только текущее значение во время репликации.</span><span class="sxs-lookup"><span data-stu-id="665a3-128">The model does not guarantee that if an attribute of an object is changed twice, both values will be replicated; Replication sends only the current value at the time of replication.</span></span>

<span data-ttu-id="665a3-129">Модель отличается от реальности несколькими способами, которые влияют только на производительность.</span><span class="sxs-lookup"><span data-stu-id="665a3-129">The model differs from reality in several ways that only affect performance.</span></span> <span data-ttu-id="665a3-130">Например, сервер Active Directory отправляет сообщения репликации, содержащие изменения, в несколько объектов, но обрабатывает содержимое такого сообщения, как если бы оно было набором сообщений одного объекта.</span><span class="sxs-lookup"><span data-stu-id="665a3-130">For example, the Active Directory Server sends replication messages containing the changes to multiple objects, but processes the contents of such a multi-object message as if it were a series of single-object messages.</span></span> <span data-ttu-id="665a3-131">Сервер Active Directory не выполняет репликацию "точка-точка", как описано в модели, а выполняет более сложную и эффективную транзитную репликацию, которая функционально эквивалентна модели.</span><span class="sxs-lookup"><span data-stu-id="665a3-131">The Active Directory Server does not perform point-to-point replication as described in the model, but instead performs a more complex and more efficient transitive replication that is functionally equivalent to the model.</span></span>

 

 




