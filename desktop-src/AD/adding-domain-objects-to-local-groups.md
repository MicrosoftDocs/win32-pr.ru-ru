---
title: Добавление объектов домена в локальные группы
description: Пользователи и группы, принадлежащие к домену, можно добавить в группы на локальном компьютере, чтобы предоставить права пользователю или группе домена на данном компьютере.
ms.assetid: 07287190-88a1-4d4d-a91c-1e95d9903a4d
ms.tgt_platform: multiple
keywords:
- Active Directory примеры Active Directory, добавление объектов домена в локальные группы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 52e956d1cf076f4c33c46700e52798463b7e1d2c
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789648"
---
# <a name="adding-domain-objects-to-local-groups"></a><span data-ttu-id="8c9c2-104">Добавление объектов домена в локальные группы</span><span class="sxs-lookup"><span data-stu-id="8c9c2-104">Adding Domain Objects to Local Groups</span></span>

<span data-ttu-id="8c9c2-105">Если рядовой сервер или компьютер, работающий под Windows 2000 Professional, является членом домена Windows 2000, пользователи и группы, принадлежащие к домену, можно добавить в группы на локальном компьютере, чтобы предоставить права пользователю или группе домена на этом конкретном компьютере.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-105">When a member server or a computer running on Windows 2000 Professional is a member of a Windows 2000 domain, the users and groups that belong to the domain can be added to groups on the local computer to grant rights to the domain user or group on that particular computer.</span></span>

<span data-ttu-id="8c9c2-106">При управлении локальными группами домена в домене Windows 2000 с помощью ADSI поставщик LDAP обычно используется.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-106">When managing domain local groups on a Windows 2000 domain using ADSI, the LDAP provider is normally used.</span></span> <span data-ttu-id="8c9c2-107">Однако при управлении локальными группами на рядовых серверах и на компьютере под управлением Windows 2000 Professional необходимо использовать поставщик WinNT.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-107">When managing local groups on member servers and a computer running Windows 2000 Professional, however, the WinNT provider must be used.</span></span>

<span data-ttu-id="8c9c2-108">На рядовых серверах и Windows 2000 Professional можно создавать только локальные группы.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-108">Only local groups can be created on member servers and Windows 2000 Professional.</span></span> <span data-ttu-id="8c9c2-109">Однако локальные группы могут содержать:</span><span class="sxs-lookup"><span data-stu-id="8c9c2-109">However, the local groups can contain:</span></span>

-   <span data-ttu-id="8c9c2-110">Универсальные и глобальные группы из леса, содержащего домен, членом которого является компьютер.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-110">Universal and global groups from the forest that contains the domain that the computer is a member.</span></span>
-   <span data-ttu-id="8c9c2-111">Локальные группы домена из этого домена компьютера.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-111">Domain local groups from that computer domain.</span></span>
-   <span data-ttu-id="8c9c2-112">Пользователи из любого домена в лесу.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-112">Users from any domain in the forest.</span></span>

<span data-ttu-id="8c9c2-113">**Добавление объекта домена в локальную группу**</span><span class="sxs-lookup"><span data-stu-id="8c9c2-113">**To add a domain object to a local group**</span></span>

1.  <span data-ttu-id="8c9c2-114">Выполните привязку к интерфейсу [**иадсконтаинер**](/windows/desktop/api/iads/nn-iads-iadscontainer) компьютера, который содержит локальную группу для добавления участника.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-114">Bind to the [**IADsContainer**](/windows/desktop/api/iads/nn-iads-iadscontainer) interface of the computer that contains the local group to add a member to.</span></span> <span data-ttu-id="8c9c2-115">Привязка должна выполняться с использованием учетной записи, обладающей достаточными правами для доступа к этому компьютеру.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-115">The binding must be performed using an account that has sufficient rights to access that computer.</span></span> <span data-ttu-id="8c9c2-116">Строка привязки должна иметь форму "WinNT:// <computer name> , Computer", где " &lt; имя компьютера &gt; " — имя группы компьютеров, в которую добавляется член.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-116">The binding string must take the form "WinNT://<computer name>,computer" where "&lt;computer name&gt;" is the name of the computer group to add a member to.</span></span> <span data-ttu-id="8c9c2-117">Параметр ", компьютер" указывает ADSI, что он привязывается к компьютеру.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-117">The ",computer" parameter instructs ADSI that it is binding to a computer.</span></span> <span data-ttu-id="8c9c2-118">ADSI предоставляет эти данные средству синтаксического анализа поставщика WinNT, чтобы можно было пропустить некоторые запросы на разрешение неоднозначности, чтобы определить тип объекта, к которому выполняется привязка.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-118">ADSI exposes this data to the WinNT provider's parser so that it can skip some ambiguity-resolution queries to determine what type of object you are binding to.</span></span> <span data-ttu-id="8c9c2-119">Это может сохранить пользователя с 5 до 20 секунд, ожидая устранения неоднозначности.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-119">This can save the user a 5 to 20 second wait for the ambiguity to be resolved.</span></span>
2.  <span data-ttu-id="8c9c2-120">Используйте метод [**иадсконтаинер. GetObject**](/windows/desktop/api/iads/nf-iads-iadscontainer-getobject) с "Group" в качестве класса, а имя локальной группы — как имя объекта для привязки к группе.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-120">Use the [**IADsContainer.GetObject**](/windows/desktop/api/iads/nf-iads-iadscontainer-getobject) method with "group" as the class and the local group name as the name of the object to bind to the group.</span></span>
3.  <span data-ttu-id="8c9c2-121">Выполните привязку к интерфейсу [**иадсграуп**](/windows/desktop/api/iads/nn-iads-iadsgroup) локальной группы, в которую будет добавлен член.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-121">Bind to the [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) interface of the local group to which a member will be added.</span></span>
4.  <span data-ttu-id="8c9c2-122">Создайте путь к объекту для добавления в локальную группу в форме "WinNT:// <domain> / <name> ", где " &lt; domain &gt; " — это имя домена, содержащего добавляемый объект, а " &lt; Name &gt; " — имя добавляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-122">Construct the ADsPath of the object to add to the local group in the form "WinNT://<domain>/<name>", where "&lt;domain&gt;" is the name of the domain that contains the object to add and "&lt;name&gt;" is the name of the object to add.</span></span>
5.  <span data-ttu-id="8c9c2-123">Добавьте пользователя или группу в локальную группу с помощью метода [**иадсграуп. Add**](/windows/desktop/api/iads/nf-iads-iadsgroup-add) , передав путь ADsPath, созданный на шаге 4.</span><span class="sxs-lookup"><span data-stu-id="8c9c2-123">Add the user or group to the local group with the [**IADsGroup.Add**](/windows/desktop/api/iads/nf-iads-iadsgroup-add) method, passing the ADsPath constructed in Step 4.</span></span>

<span data-ttu-id="8c9c2-124">Дополнительные сведения и пример кода, демонстрирующий Добавление объекта пользователя или группы домена в локальную группу, см. в разделе [пример кода для добавления пользователя или группы домена в локальную группу](example-code-for-adding-a-domain-user-or-group-to-a-local-group.md).</span><span class="sxs-lookup"><span data-stu-id="8c9c2-124">For more information and a code example that shows how to add a domain user or group object to a local group, see [Example Code for Adding a Domain User or Group to a Local Group](example-code-for-adding-a-domain-user-or-group-to-a-local-group.md).</span></span>

 

 