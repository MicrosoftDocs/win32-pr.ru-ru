---
title: Точки подключения службы для реплицированных, основанных на узлах служб и баз данных
description: При публикации службы с помощью точки подключения службы (SCP) рассмотрите, как клиенты будут искать точку подключения службы.
ms.assetid: 944e8ecd-f8ea-4506-992c-bbbfc82d11f3
ms.tgt_platform: multiple
keywords:
- Точки подключения службы для реплицированных, размещенных на узлах служб и службы баз данных AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63b69491dd84a9367f8fd05e9d23ca771551dfbb
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104069745"
---
# <a name="service-connection-points-for-replicated-host-based-and-database-services"></a><span data-ttu-id="495b3-104">Точки подключения службы для реплицированных, основанных на узлах служб и баз данных</span><span class="sxs-lookup"><span data-stu-id="495b3-104">Service Connection Points for Replicated, Host-based, and Database Services</span></span>

<span data-ttu-id="495b3-105">При публикации службы с помощью точки подключения службы (SCP) рассмотрите, как клиенты будут искать точку подключения службы.</span><span class="sxs-lookup"><span data-stu-id="495b3-105">When you publish a service using a service connection point (SCP), consider how clients will locate the SCP for your service.</span></span> <span data-ttu-id="495b3-106">Если существует несколько экземпляров службы, подумайте, как клиенты будут отличать службу с помощью требуемых функций аналогичных служб с разными функциями.</span><span class="sxs-lookup"><span data-stu-id="495b3-106">If multiple instances of the service exist, consider how clients will distinguish the service with the desired features from similar services with different features.</span></span> <span data-ttu-id="495b3-107">Если вы публикуете реплицированную службу, подумайте, как клиент будет выбирать реплику.</span><span class="sxs-lookup"><span data-stu-id="495b3-107">If you publish a replicated service, consider how a client will choose a replica.</span></span> <span data-ttu-id="495b3-108">В этом разделе обсуждаются эти проблемы для различных типов служб.</span><span class="sxs-lookup"><span data-stu-id="495b3-108">This topic discusses these issues for various types of services.</span></span>

## <a name="replicable-services"></a><span data-ttu-id="495b3-109">Реплицируемые службы</span><span class="sxs-lookup"><span data-stu-id="495b3-109">Replicable services</span></span>

<span data-ttu-id="495b3-110">Для реплицируемой службы может существовать один или несколько экземпляров (реплик) службы, а клиенты не волнует, к какой реплике они подключаются, так как каждая из них предоставляет одну и ту же службу.</span><span class="sxs-lookup"><span data-stu-id="495b3-110">For a replicable service there can be one or many instances, or replicas, of the service, and clients do not care which replica they connect to because each provides the same service.</span></span> <span data-ttu-id="495b3-111">Домен Active Directory служб — примеры реплицированных служб: все контроллеры домена для данного домена содержат идентичные данные, в зависимости от задержки репликации и предоставления идентичных служб.</span><span class="sxs-lookup"><span data-stu-id="495b3-111">Active Directory Domain Services are examples of replicated services: all domain controllers for a given domain hold identical data, subject to replication latency, and provide identical services.</span></span>

<span data-ttu-id="495b3-112">Реплицируемые службы могут хранить запрашивая и другие объекты, зависящие от конкретной службы, для нескольких реплик в одном контейнере.</span><span class="sxs-lookup"><span data-stu-id="495b3-112">Replicable services can store the SCPs and other service-specific objects for multiple replicas in a single container.</span></span> <span data-ttu-id="495b3-113">Приложение установки для первой реплики может создать контейнер в качестве дочернего для системного контейнера локального домена.</span><span class="sxs-lookup"><span data-stu-id="495b3-113">The setup application for the first replica can create the container as a child of the local domain's System container.</span></span> <span data-ttu-id="495b3-114">Дополнительные сведения см. [в разделе Публикация в контейнере системы домена](publishing-in-a-domain-system-container.md).</span><span class="sxs-lookup"><span data-stu-id="495b3-114">For more information, see [Publishing in a Domain System Container](publishing-in-a-domain-system-container.md).</span></span> <span data-ttu-id="495b3-115">Убедитесь, что дескриптор безопасности для контейнера позволяет программам установки последующих реплик создавать свои объекты в одном контейнере.</span><span class="sxs-lookup"><span data-stu-id="495b3-115">Ensure that the security descriptor for your container allows the setup programs for subsequent replicas to create their objects in the same container.</span></span> <span data-ttu-id="495b3-116">Предоставьте разрешения на установку администратору, чтобы указать пользователей или группы, которые могут создавать или изменять объекты в контейнере.</span><span class="sxs-lookup"><span data-stu-id="495b3-116">Grant permissions for the installing administrator to specify the users or groups that can create or modify objects in the container.</span></span>

<span data-ttu-id="495b3-117">Одной из стратегий для реплицируемой службы является создание SCP для каждой реплики.</span><span class="sxs-lookup"><span data-stu-id="495b3-117">One strategy for a replicable service is to create an SCP for each replica.</span></span> <span data-ttu-id="495b3-118">Когда клиент запрашивает идентификатор GUID продукта службы или другое определение ключевого слова, он находит объекты SCP для всех реплик и выбирает одну из них случайным образом или с помощью какого-либо алгоритма балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="495b3-118">When a client queries for the service's product GUID or other identifying keyword, it finds the SCP objects for all replicas and selects one at random or using some load-balancing algorithm.</span></span> <span data-ttu-id="495b3-119">Например, администратор может указать приоритет и данные балансировки нагрузки для каждой реплики аналогично полям приоритет и вес записи SRV DNS.</span><span class="sxs-lookup"><span data-stu-id="495b3-119">For example, an administrator could specify priority and load-balancing data for each replica, similar to the priority and weight fields of a DNS SRV record.</span></span> <span data-ttu-id="495b3-120">Приложение установки службы может хранить эти данные в атрибуте **СЕРВИЦЕБИНДИНГИНФОРМАТИОН** SCP каждой реплики.</span><span class="sxs-lookup"><span data-stu-id="495b3-120">The service's setup application can store this data in the **serviceBindingInformation** attribute of each replica's SCP.</span></span> <span data-ttu-id="495b3-121">Клиенты получают данные из каждой точки подключения службы и используют их для выбора реплики.</span><span class="sxs-lookup"><span data-stu-id="495b3-121">Clients retrieve the data from each SCP and use it to select a replica.</span></span>

<span data-ttu-id="495b3-122">Другой стратегией является создание одной точки подключения службы для всех реплик и установка для атрибута **SERVICEDNSNAME** SCP имени DNS-записи SRV.</span><span class="sxs-lookup"><span data-stu-id="495b3-122">Another strategy is to create a single SCP for all replicas and set the SCP **serviceDNSName** attribute to the name of a DNS SRV record.</span></span> <span data-ttu-id="495b3-123">Затем приложение установки для каждой реплики регистрирует запись SRV с таким именем.</span><span class="sxs-lookup"><span data-stu-id="495b3-123">Then the setup application for each replica registers a SRV record with that name.</span></span> <span data-ttu-id="495b3-124">Когда клиент идентифицирует одиночную SCP службы, клиент получает имя записи SRV и использует функцию [**днскуери**](/windows/desktop/api/windns/nf-windns-dnsquery_a) для получения массива записей SRV для реплик.</span><span class="sxs-lookup"><span data-stu-id="495b3-124">When a client identifies the service's lone SCP, the client retrieves the name of the SRV record and uses the [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) function to retrieve the array of SRV records for the replicas.</span></span> <span data-ttu-id="495b3-125">Каждая запись SRV содержит имя главного компьютера и дополнительные данные, которые клиент может использовать для выбора реплики.</span><span class="sxs-lookup"><span data-stu-id="495b3-125">Each SRV record contains the name of a host computer and additional data that the client can use to select a replica.</span></span>

## <a name="database-services"></a><span data-ttu-id="495b3-126">Службы баз данных</span><span class="sxs-lookup"><span data-stu-id="495b3-126">Database services</span></span>

<span data-ttu-id="495b3-127">Различные экземпляры службы базы данных могут содержать совершенно разные данные, даже если они относятся к одному типу службы, обычно именуемому классом службы.</span><span class="sxs-lookup"><span data-stu-id="495b3-127">Different instances of a database service may contain entirely different data, even though they are all the same kind of service, usually called service class.</span></span> <span data-ttu-id="495b3-128">Для публикации этого типа службы атрибут **ключевых слов** SCP может обозначать как класс службы, так и конкретную базу данных.</span><span class="sxs-lookup"><span data-stu-id="495b3-128">To publish this kind of service, the **keywords** attribute of the SCP can identify both the service class and the specific database.</span></span> <span data-ttu-id="495b3-129">Клиент общего назначения, который знает только идентификатор GUID класса службы, может запрашивать все базы данных, опубликованные этим классом службы, а затем предоставлять пользовательский интерфейс, позволяющий пользователю выбрать один из них.</span><span class="sxs-lookup"><span data-stu-id="495b3-129">A general-purpose client that knows only the GUID of the service class can query for all databases published by that service class, and then present a user interface to allow the user to select one.</span></span> <span data-ttu-id="495b3-130">Для клиента, разработанного специально для целевой базы данных, идентификатор GUID базы данных можно жестко закодировать в код клиента.</span><span class="sxs-lookup"><span data-stu-id="495b3-130">For a client that is designed specifically for the target database, you can hard-code the database GUID into the client code.</span></span>

## <a name="host-based-services"></a><span data-ttu-id="495b3-131">Службы на основе узла</span><span class="sxs-lookup"><span data-stu-id="495b3-131">Host-based services</span></span>

<span data-ttu-id="495b3-132">Службы на основе узлов являются службами, тесно связанными с одним ведущим компьютером.</span><span class="sxs-lookup"><span data-stu-id="495b3-132">Host-based services are services that are closely tied to a single host computer.</span></span> <span data-ttu-id="495b3-133">Экземпляры класса службы можно установить на многих компьютерах, и каждый экземпляр предоставляет службы, которые определяются с его главным компьютером.</span><span class="sxs-lookup"><span data-stu-id="495b3-133">You can install instances of the service class on many computers and each instance provides services that are identified with its host computer.</span></span>

<span data-ttu-id="495b3-134">Каждый экземпляр службы на основе узла должен создать собственную SCP в объекте Computer своего узла.</span><span class="sxs-lookup"><span data-stu-id="495b3-134">Each instance of a host-based service should create its own SCP under the computer object of its host.</span></span> <span data-ttu-id="495b3-135">Клиенты, использующие идентификатор GUID продукта для поиска точки подключения службы на основе узла, обычно находят много экземпляров класса службы в пределах леса предприятия.</span><span class="sxs-lookup"><span data-stu-id="495b3-135">Clients who use a product GUID to search for the SCP of a host-based service typically find many instances of the service class throughout the enterprise forest.</span></span> <span data-ttu-id="495b3-136">Затем клиенты могут использовать атрибут **serviceDNSName** объекта запрашивая, чтобы найти SCP для экземпляра службы на нужном главном компьютере.</span><span class="sxs-lookup"><span data-stu-id="495b3-136">Clients can then use the **serviceDNSName** attribute of the SCPs to find the SCP for the service instance on the desired host computer.</span></span>

 

 