---
title: Сведения об учетных записях входа в службу
description: При запуске службы на основе Win32 она входит в систему на локальном компьютере.
ms.assetid: 637ad0c0-118f-43e8-9d21-a93f6886f546
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 328b33d5dab36ccc5a803eb7c43ca3112e96ecf8
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104133638"
---
# <a name="about-service-logon-accounts"></a><span data-ttu-id="67c21-103">Сведения об учетных записях входа в службу</span><span class="sxs-lookup"><span data-stu-id="67c21-103">About Service Logon Accounts</span></span>

<span data-ttu-id="67c21-104">При запуске службы на основе Win32 она входит в систему на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="67c21-104">When a Win32-based service starts, it logs on to the local computer.</span></span> <span data-ttu-id="67c21-105">Он может войти как:</span><span class="sxs-lookup"><span data-stu-id="67c21-105">It can log on as:</span></span>

-   <span data-ttu-id="67c21-106">Локальная или доменная учетная запись пользователя.</span><span class="sxs-lookup"><span data-stu-id="67c21-106">A local or domain user account.</span></span>
-   <span data-ttu-id="67c21-107">Учетная запись LocalSystem.</span><span class="sxs-lookup"><span data-stu-id="67c21-107">The LocalSystem account.</span></span>

<span data-ttu-id="67c21-108">Учетная запись входа определяет удостоверение безопасности службы во время выполнения, то есть основной контекст безопасности службы.</span><span class="sxs-lookup"><span data-stu-id="67c21-108">The logon account determines the security identity of the service at run time, that is, the service's primary security context.</span></span> <span data-ttu-id="67c21-109">Контекст безопасности определяет способность службы к доступу к локальным и сетевым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="67c21-109">The security context determines the service's ability to access local and network resources.</span></span> <span data-ttu-id="67c21-110">Например, служба, работающая в контексте безопасности локальной учетной записи пользователя, не может получить доступ к сетевым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="67c21-110">For example, a service running in the security context of a local user account cannot access network resources.</span></span> <span data-ttu-id="67c21-111">И наоборот, служба, работающая в контексте безопасности учетной записи LocalSystem на контроллере домена Windows 2000, будет иметь неограниченный доступ к КОНТРОЛЛЕРу доменов.</span><span class="sxs-lookup"><span data-stu-id="67c21-111">Conversely, a service running in the security context of the LocalSystem account on a Windows 2000 domain controller (DC), would have unrestricted access to the DC.</span></span> <span data-ttu-id="67c21-112">Дополнительные сведения и описание преимуществ и ограничений учетных записей пользователей и LocalSystem см. в разделе [контексты безопасности и службы домен Active Directory](security-contexts-and-active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="67c21-112">For more information, and a discussion of the benefits and limitations between user accounts and LocalSystem, see [Security Contexts and Active Directory Domain Services](security-contexts-and-active-directory-domain-services.md).</span></span>

<span data-ttu-id="67c21-113">В конечном счете, администраторы системы, в которой установлена служба, имеют контроль над учетной записью входа в службу.</span><span class="sxs-lookup"><span data-stu-id="67c21-113">Ultimately, administrators on the system where the service is installed have control over the service's logon account.</span></span> <span data-ttu-id="67c21-114">По соображениям безопасности некоторые администраторы могут запретить установку службы под учетной записью LocalSystem.</span><span class="sxs-lookup"><span data-stu-id="67c21-114">For security reasons, some administrators may not allow you to install your service under the LocalSystem account.</span></span> <span data-ttu-id="67c21-115">Служба должна иметь возможность запуска от имени учетной записи пользователя домена.</span><span class="sxs-lookup"><span data-stu-id="67c21-115">Your service must be able to run under a domain user account.</span></span> <span data-ttu-id="67c21-116">В качестве программиста можно использовать некоторый контроль над учетной записью входа в службу.</span><span class="sxs-lookup"><span data-stu-id="67c21-116">As a programmer, you can exercise some control over your service's logon account.</span></span> <span data-ttu-id="67c21-117">Установщик службы задает учетную запись входа службы при вызове функции [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea) для установки службы на главном компьютере.</span><span class="sxs-lookup"><span data-stu-id="67c21-117">Your service installer specifies the service's logon account when it calls the [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea) function to install the service on a host computer.</span></span> <span data-ttu-id="67c21-118">Установщик может предложить учетную запись входа по умолчанию, но она должна позволять администратору указать фактическую учетную запись.</span><span class="sxs-lookup"><span data-stu-id="67c21-118">Your installer can suggest a default logon account, but it should allow an administrator to specify the actual account.</span></span>

<span data-ttu-id="67c21-119">Установщик также может выполнять следующие задачи, связанные с учетной записью входа в службу.</span><span class="sxs-lookup"><span data-stu-id="67c21-119">Your installer can also perform the following tasks relating to your service's logon account:</span></span>

-   <span data-ttu-id="67c21-120">Установка.</span><span class="sxs-lookup"><span data-stu-id="67c21-120">Installation.</span></span> <span data-ttu-id="67c21-121">При установке службы для запуска от имени учетной записи пользователя учетная запись должна существовать до вызова [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea).</span><span class="sxs-lookup"><span data-stu-id="67c21-121">If installing your service to run under a user account, the account must exist before you call [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea).</span></span> <span data-ttu-id="67c21-122">Вы можете использовать существующую учетную запись или создать ее как часть главного компьютера инсталлрт.</span><span class="sxs-lookup"><span data-stu-id="67c21-122">You can use an existing account or create one as part of the host-computer installrt.</span></span> <span data-ttu-id="67c21-123">Дополнительные сведения см. в разделе [Настройка учетной записи пользователя службы](setting-up-a-serviceampaposs-user-account.md).</span><span class="sxs-lookup"><span data-stu-id="67c21-123">For more information, see [Setting up a Service's User Account](setting-up-a-serviceampaposs-user-account.md).</span></span>
-   <span data-ttu-id="67c21-124">Аутентификация.</span><span class="sxs-lookup"><span data-stu-id="67c21-124">Authentication.</span></span> <span data-ttu-id="67c21-125">Если требуется, чтобы клиенты использовали взаимную проверку подлинности Kerberos, зарегистрируйте имена участников-служб в учетной записи входа службы.</span><span class="sxs-lookup"><span data-stu-id="67c21-125">If you want clients to use Kerberos mutual authentication, register the SPNs on the service's logon account.</span></span> <span data-ttu-id="67c21-126">Если служба выполняется под учетной записью LocalSystem, учетная запись входа в службу является учетной записью компьютера главного компьютера.</span><span class="sxs-lookup"><span data-stu-id="67c21-126">If the service runs under the LocalSystem account, the service's logon account is the computer account of the host computer.</span></span> <span data-ttu-id="67c21-127">Дополнительные сведения об именах субъектов-служб см. в [этом разделе](service-principal-names.md).</span><span class="sxs-lookup"><span data-stu-id="67c21-127">For more information, see [Service Principal Names](service-principal-names.md).</span></span>
-   <span data-ttu-id="67c21-128">Предоставление доступа.</span><span class="sxs-lookup"><span data-stu-id="67c21-128">Grant Access.</span></span> <span data-ttu-id="67c21-129">Убедитесь, что служба во время выполнения имеет права доступа и привилегии, необходимые для выполнения своих задач.</span><span class="sxs-lookup"><span data-stu-id="67c21-129">Ensure that the service at run time has the access rights and privileges that it requires to perform its tasks.</span></span> <span data-ttu-id="67c21-130">Это может потребовать настройки записей управления доступом (ACE) в дескрипторах безопасности различных ресурсов, то есть объектов каталога, общих файловых ресурсов и т. д., чтобы разрешить необходимые права доступа учетной записи пользователя или компьютера.</span><span class="sxs-lookup"><span data-stu-id="67c21-130">This can require setting access-control entries (ACEs) in the security descriptors of various resources, that is directory objects, file shares, and so on, to allow the necessary access rights to the user or computer account.</span></span> <span data-ttu-id="67c21-131">Дополнительные сведения см. в разделе [предоставление прав доступа учетной записи входа в службу](granting-access-rights-to-the-service-logon-account.md).</span><span class="sxs-lookup"><span data-stu-id="67c21-131">For more information, see [Granting Access Rights to the Service Logon Account](granting-access-rights-to-the-service-logon-account.md).</span></span>
-   <span data-ttu-id="67c21-132">Задайте привилегии.</span><span class="sxs-lookup"><span data-stu-id="67c21-132">Set Privileges.</span></span> <span data-ttu-id="67c21-133">Назначьте привилегии указанной учетной записи входа, например право на вход в качестве службы на главный компьютер.</span><span class="sxs-lookup"><span data-stu-id="67c21-133">Assign privileges to the specified logon account, such as the right to logon as a service to the host computer.</span></span> <span data-ttu-id="67c21-134">Дополнительные сведения см. в разделе [предоставление входных данных в качестве службы непосредственно на главном компьютере](granting-logon-as-service-right-on-the-host-computer.md).</span><span class="sxs-lookup"><span data-stu-id="67c21-134">For more information, see [Granting Logon as Service Right on the Host Computer](granting-logon-as-service-right-on-the-host-computer.md).</span></span>

<span data-ttu-id="67c21-135">После установки службы существуют задачи обслуживания, связанные с учетной записью входа в службу.</span><span class="sxs-lookup"><span data-stu-id="67c21-135">After a service is installed, there are maintenance tasks that relate to your service logon account.</span></span> <span data-ttu-id="67c21-136">Дополнительные сведения см. в разделе [задачи обслуживания учетной записи входа](logon-account-maintenance-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="67c21-136">For more information, see [Logon Account Maintenance Tasks](logon-account-maintenance-tasks.md).</span></span>

-   <span data-ttu-id="67c21-137">Обслуживание пароля.</span><span class="sxs-lookup"><span data-stu-id="67c21-137">Password maintenance.</span></span> <span data-ttu-id="67c21-138">Для службы, работающей под учетной записью пользователя, необходимо периодически менять пароль и синхронизировать пароль с паролем, используемым одним или несколькими локальными диспетчерами управления службами для запуска службы.</span><span class="sxs-lookup"><span data-stu-id="67c21-138">For a service that runs under a user account, you must periodically change the password and keep the password in sync with the password used by one or more local service control managers to start the service.</span></span>
-   <span data-ttu-id="67c21-139">Обслуживание имени участника-службы.</span><span class="sxs-lookup"><span data-stu-id="67c21-139">SPN maintenance.</span></span> <span data-ttu-id="67c21-140">Если учетная запись входа в службу изменяется, удалите имена участников-служб, зарегистрированные в старой учетной записи, и зарегистрируйте их в новой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="67c21-140">If a service logon account changes, remove the SPNs registered on the old account and register them on the new account.</span></span> <span data-ttu-id="67c21-141">Имейте в виду, что при установке службы Администратор домена может изменить учетную запись, под которой выполняется служба. Используйте функции Win32 или пользовательский интерфейс средства администрирования "Управление компьютером".</span><span class="sxs-lookup"><span data-stu-id="67c21-141">Be aware that when a service is installed, a domain administrator can change the account under which your service runs; use Win32 functions or the user interface of the Computer Management administrative tool.</span></span>
-   <span data-ttu-id="67c21-142">Обслуживание ACE.</span><span class="sxs-lookup"><span data-stu-id="67c21-142">ACE maintenance.</span></span> <span data-ttu-id="67c21-143">Если учетная запись входа в службу изменится, необходимо обновить записи ACE и членство в группах, чтобы служба по-прежнему могла получить доступ к необходимым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="67c21-143">If a service logon account changes, you need to update ACEs and group memberships to ensure that the service can still access the necessary resources.</span></span>

 

 