---
title: Перечисление групп в домене
description: Группы можно разместить в любом контейнере или подразделении (OU) в домене, а также в корне домена.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Перечисление групп в доменных службах Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789571"
---
# <a name="enumerating-groups-in-a-domain"></a><span data-ttu-id="1a4cd-104">Перечисление групп в домене</span><span class="sxs-lookup"><span data-stu-id="1a4cd-104">Enumerating Groups in a Domain</span></span>

<span data-ttu-id="1a4cd-105">Группы можно разместить в любом контейнере или подразделении (OU) в домене, а также в корне домена.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-105">Groups can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="1a4cd-106">Это означает, что группы могут находиться в нескольких местах иерархии каталогов.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-106">This means that groups can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="1a4cd-107">Поэтому у вас есть два варианта перечисления групп:</span><span class="sxs-lookup"><span data-stu-id="1a4cd-107">Therefore, you have two choices for enumerating groups:</span></span>

1.  <span data-ttu-id="1a4cd-108">Перечислите группы, непосредственно содержащиеся в контейнере, подразделении или в корне домена.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-108">Enumerate the groups directly contained in a container, OU, or at the root of the domain.</span></span>

    <span data-ttu-id="1a4cd-109">Явная привязка к объекту-контейнеру, содержащему группы для перечисления, установите фильтр, содержащий "groups", в качестве класса с помощью свойства [**иадсконтаинер. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) и используйте метод [**иадсконтаинер:: Get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) , чтобы перечислить объекты группы.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-109">Explicitly bind to the container object that contains the groups to enumerate, set a filter that contains "groups" as the class using the [**IADsContainer.Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the group objects.</span></span>

    <span data-ttu-id="1a4cd-110">Этот метод перечисляет группы, содержащиеся непосредственно в контейнере или объекте OU.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-110">This technique enumerates groups contained directly in a container or OU object.</span></span> <span data-ttu-id="1a4cd-111">Если контейнер содержит другие контейнеры, которые потенциально могут содержать другие группы, необходимо выполнить привязку к этим контейнерам и рекурсивно перечислить группы в этих контейнерах.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-111">If the container contains other containers that can potentially contain other groups, you must bind to those containers and recursively enumerate the groups on those containers.</span></span> <span data-ttu-id="1a4cd-112">Чтобы управлять объектами группы и только для чтения конкретными свойствами, используйте глубокий поиск, описанный в варианте 2.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-112">To manipulate the group objects and read only specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="1a4cd-113">Поскольку перечисление Возвращает указатели на COM-объекты ADSI, представляющие каждый объект группы, можно вызвать метод [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) , чтобы получить указатели интерфейса [**iAds**](/windows/desktop/api/iads/nn-iads-iads), [**иадсграуп**](/windows/desktop/api/iads/nn-iads-iadsgroup)и [**иадспропертилист**](/windows/desktop/api/iads/nn-iads-iadspropertylist) для объекта Group. Таким образом, можно получить указатели интерфейса для каждого объекта перечисляемой группы в контейнере, не прибегая к явной привязке к каждому объекту группы.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-113">Because enumeration returns pointers to ADSI COM objects representing each group object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the group object; that is, you can get interface pointers to each enumerated group object in a container without having to explicitly bind to each group object.</span></span> <span data-ttu-id="1a4cd-114">Для выполнения операций со всеми группами непосредственно в контейнере для вызова методов **iAds** или **иадсграуп** перечисление не требует привязки к каждой группе.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-114">To perform operations on all the groups directly within a container, enumeration does not require binding to each group in order to call **IADs** or **IADsGroup** methods.</span></span> <span data-ttu-id="1a4cd-115">Чтобы получить определенные свойства из групп, используйте [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) , как описано во втором варианте.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-115">To retrieve specific properties from groups, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in the second option.</span></span>

    <span data-ttu-id="1a4cd-116">Исключение в этом случае возникает при попытке перечисления группы, содержащей члены, которые являются wellKnown субъектами безопасности, такими как все пользователи, прошедшие проверку подлинности пользователей, пакетная обработка и т. д.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-116">An exception to this occurs when you attempt to enumerate a group that contains members that are wellKnown security principals, such as Everyone, Authenticated users, BATCH, and so on.</span></span> <span data-ttu-id="1a4cd-117">Поскольку невозможно выполнить привязку к этим типам объектов, они не перечисляются при перечислении групп в области WinNT, даже если они могут привязываться, так как определенные методы IADs, такие как Class, ADsPath и Name, возвращают правильные результаты при вызове перечисленных членов.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-117">Because you cannot bind to these types of objects, they are not listed when you enumerate groups in the WinNT scope, even though it may appear to bind, because certain IADs methods such as Class, ADsPath, and Name return correct results when invoked on enumerated members.</span></span>

2.  <span data-ttu-id="1a4cd-118">Выполните глубокий поиск по запросу "objectCategory = Group", чтобы найти все группы в дереве.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-118">Perform a deep search for "objectCategory=group" to find all groups in a tree.</span></span>

    <span data-ttu-id="1a4cd-119">Сначала выполните привязку к объекту контейнера, с которого начинается поиск.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-119">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="1a4cd-120">Например, чтобы найти все группы в домене, выполните привязку к корню домена. чтобы найти все группы в лесу, выполните привязку к глобальному каталогу и выполните поиск из корня GC.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-120">For example, to find all groups in a domain, bind to root of the domain; to find all groups in the forest, bind to global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="1a4cd-121">Затем используйте [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) для запроса с помощью фильтра поиска, содержащего (objectCategory = Group), и предпочтения поиска **в \_ \_ поддереве области объявлений**.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-121">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter that contains (objectCategory=group) and search preference of **ADS\_SCOPE\_SUBTREE**.</span></span>

    > [!Note]  
    > <span data-ttu-id="1a4cd-122">Вы можете выполнить поиск с помощью предпочтения поиска **\_ области объявлений \_ одноуровневой** , чтобы ограничить поиск прямым содержимым объекта контейнера, к которому вы привязаны.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-122">You can perform a search with a search preference of **ADS\_SCOPE\_ONELEVEL** to limit the search to the direct contents of the container object that you bound to.</span></span>

     

    <span data-ttu-id="1a4cd-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) извлекает только значения конкретных свойств из групп.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from groups.</span></span> <span data-ttu-id="1a4cd-124">Чтобы получить значения, используйте **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-124">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="1a4cd-125">Для управления объектами Group, возвращаемыми из поиска, то есть для использования методов [**iAds**](/windows/desktop/api/iads/nn-iads-iads) или [**иадсграуп**](/windows/desktop/api/iads/nn-iads-iadsgroup) , следует явно привязать к ним.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-125">To manipulate the group objects returned from a search, that is, to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) methods, explicitly bind to them.</span></span> <span data-ttu-id="1a4cd-126">Для этого укажите **distinguishedName** в качестве одного из свойств, возвращаемых при поиске, и используйте возвращенные различающиеся имена для привязки к каждой группе, возвращаемой при поиске.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-126">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each group returned in the search.</span></span>

    <span data-ttu-id="1a4cd-127">Извлекаются только определенные свойства.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-127">Only specific properties are retrieved.</span></span> <span data-ttu-id="1a4cd-128">Невозможно получить все атрибуты без явного указания всех возможных атрибутов класса Group.</span><span class="sxs-lookup"><span data-stu-id="1a4cd-128">You cannot retrieve all attributes without explicitly specifying every possible attribute of the group class.</span></span>

 

 