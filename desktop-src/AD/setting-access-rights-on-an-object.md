---
title: Установка прав доступа для объекта
description: В этом разделе описывается, как создать запись ACE для права доступа и задать эту запись ACE в списке DACL объекта.
ms.assetid: c0b45709-4652-46c7-8d52-44076802d109
ms.tgt_platform: multiple
keywords:
- Установка прав доступа для объекта AD
- Объекты Active Directory, установка прав доступа для объекта
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bcf54de381dab2af1dab4ea44654fb0a5682f06
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104487396"
---
# <a name="setting-access-rights-on-an-object"></a><span data-ttu-id="7d5dd-105">Установка прав доступа для объекта</span><span class="sxs-lookup"><span data-stu-id="7d5dd-105">Setting Access Rights on an Object</span></span>

<span data-ttu-id="7d5dd-106">При использовании объектов ADSI COM [**иадссекуритидескриптор**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (дескриптор безопасности), [**иадсакцессконтроллист**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACL и SACL) и [**иадсакцессконтролентри**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) для добавления элемента ACE в список ACL вы вносите изменения в свойство **нтсекуритидескриптор** указанного объекта в кэше свойств.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-106">When using the ADSI COM objects [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (security descriptor), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACLs and SACLs), and [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) to add an ACE to a ACL, you are making changes to the **nTSecurityDescriptor** property of the specified object in the property cache.</span></span> <span data-ttu-id="7d5dd-107">Это означает, что для записи обновленного дескриптора безопасности в каталог из кэша свойств необходимо вызвать методы добавления для объектов, содержащих новый элемент ACE, и метод [**iAds. сетинфо**](/windows/desktop/api/iads/nf-iads-iads-setinfo) .</span><span class="sxs-lookup"><span data-stu-id="7d5dd-107">This means put methods on the objects that contain the new ACE and the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method must be called in order to write the updated security descriptor to the directory from the property cache.</span></span>

<span data-ttu-id="7d5dd-108">Дополнительные сведения и пример кода, который задает запись ACE для объекта в домен Active Directory Services, см. в разделе [пример кода для настройки записи ACE в объекте каталога](example-code-for-setting-an-ace-on-a-directory-object.md).</span><span class="sxs-lookup"><span data-stu-id="7d5dd-108">For more information and a code example that sets an ACE on an object in Active Directory Domain Services, see [Example Code for Setting an ACE on a Directory Object](example-code-for-setting-an-ace-on-a-directory-object.md).</span></span>

<span data-ttu-id="7d5dd-109">Используйте следующий общий процесс, чтобы создать ACE для права доступа и задать этот элемент управления доступом в списке DACL объекта.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-109">Use the following general process to create an ACE for an access right and setting that ACE on the DACL of an object.</span></span>

1.  <span data-ttu-id="7d5dd-110">Получите указатель интерфейса [**iAds**](/windows/desktop/api/iads/nn-iads-iads) для объекта.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-110">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="7d5dd-111">Используйте метод [**iAds. Get**](/windows/desktop/api/iads/nf-iads-iads-get) для получения дескриптора безопасности объекта.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-111">Use the [**IADs.Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="7d5dd-112">Имя свойства, содержащего дескриптор безопасности, — **нтсекуритидескриптор**.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-112">The name of the property containing the security descriptor is **nTSecurityDescriptor**.</span></span> <span data-ttu-id="7d5dd-113">Свойство будет возвращено как [**значение типа Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , содержащее указатель [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (элемент **VT** является отправкой **VT \_**).</span><span class="sxs-lookup"><span data-stu-id="7d5dd-113">The property will be returned as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) containing an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer (the **vt** member is **VT\_DISPATCH**).</span></span> <span data-ttu-id="7d5dd-114">Вызовите **QueryInterface** на этом указателе **IDispatch** , чтобы получить интерфейс [**иадссекуритидескриптор**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) для использования методов этого интерфейса для доступа к ACL дескриптора безопасности.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-114">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor's ACL.</span></span>
3.  <span data-ttu-id="7d5dd-115">Чтобы получить список DACL, используйте свойство [**иадссекуритидескриптор. дискретионарякл**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) .</span><span class="sxs-lookup"><span data-stu-id="7d5dd-115">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to get the DACL.</span></span> <span data-ttu-id="7d5dd-116">Метод возвращает указатель [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="7d5dd-116">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="7d5dd-117">Вызовите метод **QueryInterface** для этого указателя **IDispatch** , чтобы получить интерфейс [**иадсакцессконтроллист**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) , чтобы использовать методы этого интерфейса для доступа к отдельным записям ACE в списке управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-117">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="7d5dd-118">Используйте [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для создания com-объекта ADSI для нового элемента ACE и получения указателя интерфейса [**иадсакцессконтролентри**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) на этот объект.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-118">Use [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to create the ADSI COM object for the new ACE and get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface pointer to that object.</span></span> <span data-ttu-id="7d5dd-119">Имейте в виду, что ИДЕНТИФИКАТОРом класса является CLSID \_ акцессконтролентри.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-119">Be aware that the class ID is CLSID\_AccessControlEntry.</span></span>
5.  <span data-ttu-id="7d5dd-120">Задайте свойства элемента управления доступом с помощью методов [**иадсакцессконтролентри**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) :</span><span class="sxs-lookup"><span data-stu-id="7d5dd-120">Set the properties of the ACE using the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) methods:</span></span>

    1.  <span data-ttu-id="7d5dd-121">Используйте [**иадсакцессконтролентри::p UT \_**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , чтобы задать доверенное лицо, к которому применяется ACE.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-121">Use [**IADsAccessControlEntry::put\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) to set the trustee to whom this ACE applies.</span></span> <span data-ttu-id="7d5dd-122">Доверенное лицо — это пользователь, группа или другой субъект безопасности.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-122">The trustee is a user, group, or other security principal.</span></span> <span data-ttu-id="7d5dd-123">Приложение должно использовать значение из соответствующего свойства из объекта пользователя или группы доверенного лица, к которому требуется применить ACE.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-123">Your application should use the value from the appropriate property from the user or group object of the trustee to which you want to apply the ACE.</span></span> <span data-ttu-id="7d5dd-124">Доверенное лицо указывается как **BSTR** и может принимать следующие формы:</span><span class="sxs-lookup"><span data-stu-id="7d5dd-124">The trustee is specified as a **BSTR** and can take the following forms:</span></span>
        -   <span data-ttu-id="7d5dd-125">Учетная запись домена (имя входа, используемое в предыдущей версии Windows NT) в форме " <domain> \\ <user account> ", где " &lt; домен &gt; " — имя домена Windows NT, содержащего пользователя, а " &lt; учетная запись пользователя &gt; " — свойство **SamAccountName** указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-125">Domain account (the logon name used in a previous version of Windows NT) of the form "<domain>\\<user account>" where "&lt;domain&gt;" is the name of the Windows NT domain that contains the user and "&lt;user account&gt;" is the **sAMAccountName** property of the specified user.</span></span> <span data-ttu-id="7d5dd-126">Например: "Fabrikam \\ жеффсмис".</span><span class="sxs-lookup"><span data-stu-id="7d5dd-126">For example: "fabrikam\\jeffsmith".</span></span>
        -   <span data-ttu-id="7d5dd-127">Известный субъект безопасности, представляющий специальные удостоверения, определенные системой безопасности Windows NT, такие как все, локальная система, участник Self, прошедший проверку пользователь, владелец-Создатель и т. д.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-127">Well-known security principal that represents special identities defined by the Windows NT security system, such as everyone, local system, principal self, authenticated user, creator owner, and so on.</span></span> <span data-ttu-id="7d5dd-128">Объекты, представляющие хорошо известные субъекты безопасности, хранятся в контейнере "известные субъекты безопасности" под контейнером конфигурации.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-128">The objects representing the well-known security principals are stored in the Well Known Security Principals container beneath the Configuration container.</span></span> <span data-ttu-id="7d5dd-129">Например, анонимный вход в систему.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-129">For example, anonymous logon.</span></span>
        -   <span data-ttu-id="7d5dd-130">Встроенная группа, представляющая встроенные группы пользователей, определенные системой безопасности Windows NT.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-130">Built-in group that represent the built-in user groups defined by the Windows NT security system.</span></span> <span data-ttu-id="7d5dd-131">Он имеет форму «Builtin», \\ <group name> где « &lt; имя группы &gt; » — это имя встроенной группы пользователей.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-131">It has the form "BUILTIN\\<group name>" where "&lt;group name&gt;" is the name of the built-in user group.</span></span> <span data-ttu-id="7d5dd-132">Объекты, представляющие встроенные группы, хранятся в контейнере Builtin под контейнером домена.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-132">The objects representing the built-in groups are stored in the Builtin container beneath the domain container.</span></span> <span data-ttu-id="7d5dd-133">Например, «Builtin \\ Администраторы».</span><span class="sxs-lookup"><span data-stu-id="7d5dd-133">For example, "BUILTIN\\Administrators".</span></span>
        -   <span data-ttu-id="7d5dd-134">Идентификатор безопасности (формат строки) указанного пользователя, который является свойством **objectSid** указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-134">SID (string format) of the specified user, which is the **objectSID** property of the specified user.</span></span> <span data-ttu-id="7d5dd-135">Преобразовать в форму строки можно с помощью функции [**функция ConvertSidToStringSid вернула**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) в API безопасности Win32.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-135">You can convert to string form using the [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) function in the Win32 Security API.</span></span> <span data-ttu-id="7d5dd-136">Например: "S-1-5-32-548".</span><span class="sxs-lookup"><span data-stu-id="7d5dd-136">For example: "S-1-5-32-548".</span></span>
    2.  <span data-ttu-id="7d5dd-137">Используйте свойство [**иадсакцессконтролентри. AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , чтобы задать маску, определяющую право доступа.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-137">Use the [**IADsAccessControlEntry.AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to set the mask that specifies the access right.</span></span> <span data-ttu-id="7d5dd-138">Перечисление [**прав на рекламу \_ \_**](/windows/win32/api/iads/ne-iads-ads_rights_enum) определяет права доступа, которые можно задать для объекта каталога.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-138">The [**ADS\_RIGHTS\_ENUM**](/windows/win32/api/iads/ne-iads-ads_rights_enum) enumeration specifies the access rights you can set on a directory object.</span></span>
    3.  <span data-ttu-id="7d5dd-139">Используйте свойство [**иадсакцессконтролентри. AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , чтобы указать, следует ли разрешать или запрещать права доступа, установленные **AccessMask**.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-139">Use the [**IADsAccessControlEntry.AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether to allow or deny the access rights set by **AccessMask**.</span></span> <span data-ttu-id="7d5dd-140">Для стандартных прав это может быть **AD \_ ACETYPE \_ Access \_ Allowed** или **AD \_ ACETYPE \_ Access \_ Denied**.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-140">For standard rights, this can be **ADS\_ACETYPE\_ACCESS\_ALLOWED** or **ADS\_ACETYPE\_ACCESS\_DENIED**.</span></span> <span data-ttu-id="7d5dd-141">Для зависящих от объекта прав (прав, которые применяются к определенной части объекта или к конкретному типу объекта) используйте **ADS \_ ACETYPE \_ доступ к \_ \_** объекту или **ADS \_ ACETYPE \_ доступ к \_ \_ объекту**.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-141">For object-specific rights (rights that apply to a specific part of an object or to a specific type of object), use **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT**.</span></span> <span data-ttu-id="7d5dd-142">Перечисление [**ADS \_ ACETYPE \_ enum**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) указывает типы доступа, которые можно задать для элемента управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-142">The [**ADS\_ACETYPE\_ENUM**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) enumeration specifies the access types you can set on an ACE.</span></span>
    4.  <span data-ttu-id="7d5dd-143">Используйте свойство [**иадсакцессконтролентри. AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , чтобы указать, могут ли другие контейнеры или объекты, расположенные ниже указанного объекта, наследовать элемент управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-143">Use the [**IADsAccessControlEntry.AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether other containers or objects beneath the specified object can inherit the ACE.</span></span> <span data-ttu-id="7d5dd-144">Перечисление [**ADS \_ ацефлаг \_ enum**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) указывает флаги наследования, которые можно задать для элемента управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-144">The [**ADS\_ACEFLAG\_ENUM**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) enumeration specifies the inheritance flags you can set on an ACE.</span></span>
    5.  <span data-ttu-id="7d5dd-145">Используйте свойство [**иадсакцессконтролентри. flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , чтобы указать, применяется ли право к определенной части объекта, типу наследуемого объекта или к обоим.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-145">Use the [**IADsAccessControlEntry.Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether the right applies to a specific part of the object, an inherited object type, or both.</span></span>
    6.  <span data-ttu-id="7d5dd-146">Если параметр **flags** имеет **значение \_ \_ тип объекта \_ \_ флага ADS**, установите свойство [**иадсакцессконтролентри. ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) o Укажите строку, содержащую идентификатор GUID класса объекта (для **ADS \_ справа \_ DS \_ Создание \_ дочернего** элемента **DS или ADS \_ право \_ доменного \_ удаления \_**), свойства, набора свойств, проверенной записи или расширенного права, к которому применяется ACE.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-146">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property o specify a string containing the GUID of the object class (for **ADS\_RIGHT\_DS\_CREATE\_CHILD** or **ADS\_RIGHT\_DS\_DELETE\_CHILD**), property, property set, validated write, or extended right that the ACE applies to.</span></span> <span data-ttu-id="7d5dd-147">Идентификатор GUID должен быть указан в виде строки формы, созданной функцией [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) в библиотеке COM.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-147">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>
    7.  <span data-ttu-id="7d5dd-148">Если для **флагов** установлено значение флага **ADS, \_ \_ унаследованный \_ \_ тип объекта \_**, установите свойство [**иадсакцессконтролентри. инхеритедобжекттипе**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , чтобы указать строку, содержащую идентификатор GUID наследуемого класса объекта, к которому применяется ACE.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-148">If **Flags** is set to **ADS\_FLAG\_INHERITED\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify a string that contains the GUID of the inherited object class that the ACE applies to.</span></span> <span data-ttu-id="7d5dd-149">Идентификатор GUID должен быть указан в виде строки формы, созданной функцией [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) в библиотеке COM.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-149">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>

6.  <span data-ttu-id="7d5dd-150">Используйте метод **QueryInterface** объекта [**иадсакцессконтролентри**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) для получения указателя [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="7d5dd-150">Use the **QueryInterface** method on the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) object to get an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="7d5dd-151">Для метода [**иадсакцессконтроллист. аддаце**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) требуется указатель интерфейса **IDispatch** на элемент управления доступом.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-151">The [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) method requires an **IDispatch** interface pointer to the ACE.</span></span>
7.  <span data-ttu-id="7d5dd-152">Используйте [**иадсакцессконтроллист. аддаце**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) , чтобы добавить новый элемент управления доступом в список DACL.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-152">Use [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) to add the new ACE to the DACL.</span></span> <span data-ttu-id="7d5dd-153">Имейте в виду, что порядок элементов ACE в списке ACL может повлиять на оценку доступа к объекту.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-153">Be aware that the order of the ACEs within the ACL can affect the evaluation of access to the object.</span></span> <span data-ttu-id="7d5dd-154">Для правильного доступа к объекту может потребоваться создать новый список ACL, добавить записи ACE из существующего списка ACL в правильном порядке в новый список управления доступом, а затем заменить существующий список ACL в дескрипторе безопасности новым ACL.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-154">The correct access to the object may require you to create an new ACL, add the ACEs from the existing ACL in the correct order to the new ACL, and then replace the existing ACL in the security descriptor with the new ACL.</span></span> <span data-ttu-id="7d5dd-155">Дополнительные сведения см. [в разделе порядок элементов ACE в списке DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span><span class="sxs-lookup"><span data-stu-id="7d5dd-155">For more information, see [Order of ACEs in a DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span></span>
8.  <span data-ttu-id="7d5dd-156">Используйте свойство [**иадссекуритидескриптор. дискретионарякл**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) для записи списка DACL, содержащего новый элемент ACE, в дескриптор безопасности.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-156">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to write the DACL containing the new ACE to the security descriptor.</span></span> <span data-ttu-id="7d5dd-157">Дополнительные сведения о списках DACL см. в разделе пустые [списки DACL и пустой список DACL](null-dacls-and-empty-dacls.md).</span><span class="sxs-lookup"><span data-stu-id="7d5dd-157">For more information about DACLs, see [Null DACLs and Empty DACLs](null-dacls-and-empty-dacls.md).</span></span>
9.  <span data-ttu-id="7d5dd-158">Используйте метод [**iAds. помещаем**](/windows/desktop/api/iads/nf-iads-iads-put) для записи дескриптора безопасности в свойство **нтсекуритидескриптор** объекта в кэш свойств.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-158">Use the [**IADs.Put**](/windows/desktop/api/iads/nf-iads-iads-put) method to write the security descriptor to the object's **nTSecurityDescriptor** property to the property cache.</span></span>
10. <span data-ttu-id="7d5dd-159">Используйте метод [**iAds. сетинфо**](/windows/desktop/api/iads/nf-iads-iads-setinfo) для обновления свойства объекта в каталоге.</span><span class="sxs-lookup"><span data-stu-id="7d5dd-159">Use the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method to update the property on the object in the directory.</span></span>

 

 