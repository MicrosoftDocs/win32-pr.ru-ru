---
title: Опрос изменений с помощью элемента управления DirSync
description: Элемент управления Active Directory Directory Synchronization (DirSync) — это расширение LDAP-сервера, которое позволяет приложению выполнять поиск объектов, измененных с момента предыдущего состояния, в разделе каталога.
ms.assetid: f77caeb3-bfc9-4ae6-8d1d-73f4ee554336
ms.tgt_platform: multiple
keywords:
- Опрос изменений с помощью элемента управления DirSync AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3d105757d39bc25bd10df21ab68c4d1d1202be
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789504"
---
# <a name="polling-for-changes-using-the-dirsync-control"></a><span data-ttu-id="880d4-104">Опрос изменений с помощью элемента управления DirSync</span><span class="sxs-lookup"><span data-stu-id="880d4-104">Polling for Changes Using the DirSync Control</span></span>

<span data-ttu-id="880d4-105">Элемент управления Active Directory Directory Synchronization (DirSync) — это расширение LDAP-сервера, которое позволяет приложению выполнять поиск объектов, измененных с момента предыдущего состояния, в разделе каталога.</span><span class="sxs-lookup"><span data-stu-id="880d4-105">Active Directory directory synchronization (DirSync) control is an LDAP server extension that enables an application to search an directory partition for objects that have changed since a previous state.</span></span>

<span data-ttu-id="880d4-106">Используйте элемент управления DirSync через интерфейс ADSI, указав параметры поиска **\_ сеарчпреф \_ DirSync в ADS** при использовании [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span><span class="sxs-lookup"><span data-stu-id="880d4-106">Use the DirSync control through ADSI by specifying the **ADS\_SEARCHPREF\_DIRSYNC** search preference when using [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span></span> <span data-ttu-id="880d4-107">Дополнительные сведения и пример кода см. в разделе [пример кода с использованием ADS \_ сеарчпреф \_ DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span><span class="sxs-lookup"><span data-stu-id="880d4-107">For more information and a code example, see [Example Code Using ADS\_SEARCHPREF\_DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span></span> <span data-ttu-id="880d4-108">Можно также выполнить поиск DirSync с помощью API LDAP.</span><span class="sxs-lookup"><span data-stu-id="880d4-108">You can also perform a DirSync search using the LDAP API.</span></span> <span data-ttu-id="880d4-109">Ниже описана реализация интерфейса ADSI, большинство из которых также применимо непосредственно к использованию LDAP, за исключением случаев, описанных в конце этого раздела.</span><span class="sxs-lookup"><span data-stu-id="880d4-109">The following describes the ADSI implementation, most of which also applies to using LDAP directly, except as discussed at the end of this topic.</span></span>

<span data-ttu-id="880d4-110">При выполнении поиска DirSync передается элемент данных (cookie) конкретного поставщика, который определяет состояние каталога во время предыдущего поиска DirSync.</span><span class="sxs-lookup"><span data-stu-id="880d4-110">When you perform a DirSync search, you pass in a provider-specific data element (cookie) that identifies the directory state at the time of the previous DirSync search.</span></span> <span data-ttu-id="880d4-111">При первом поиске вы передаете файл cookie со значением NULL, и поиск возвращает все объекты, соответствующие фильтру.</span><span class="sxs-lookup"><span data-stu-id="880d4-111">For the first search, you pass in a null cookie, and the search returns all objects that match the filter.</span></span> <span data-ttu-id="880d4-112">Поиск также возвращает допустимый файл cookie.</span><span class="sxs-lookup"><span data-stu-id="880d4-112">The search also returns a valid cookie.</span></span> <span data-ttu-id="880d4-113">Сохраните файл cookie в том же хранилище, которое синхронизируется с сервером Active Directory.</span><span class="sxs-lookup"><span data-stu-id="880d4-113">Store the cookie in the same storage that you are synchronizing with the Active Directory server.</span></span> <span data-ttu-id="880d4-114">При последующих операциях поиска получите файл cookie из хранилища и передайте его в поисковый запрос.</span><span class="sxs-lookup"><span data-stu-id="880d4-114">On subsequent searches, get the cookie from storage and pass it with the search request.</span></span> <span data-ttu-id="880d4-115">Результаты поиска теперь включают только те объекты и атрибуты, которые изменились с момента предыдущего состояния, определенного файлом cookie.</span><span class="sxs-lookup"><span data-stu-id="880d4-115">The search results now include only the objects and attributes that have changed since the previous state identified by the cookie.</span></span> <span data-ttu-id="880d4-116">Поиск также возвращает новый файл cookie для хранения в следующем поиске.</span><span class="sxs-lookup"><span data-stu-id="880d4-116">The search also returns a new cookie to store for the next search.</span></span>

<span data-ttu-id="880d4-117">В следующей таблице перечислены параметры поиска, которые может указывать запрос поиска клиента.</span><span class="sxs-lookup"><span data-stu-id="880d4-117">The following table lists search parameters that the client search request can specify.</span></span>



| <span data-ttu-id="880d4-118">Параметр</span><span class="sxs-lookup"><span data-stu-id="880d4-118">Parameter</span></span>          | <span data-ttu-id="880d4-119">Описание</span><span class="sxs-lookup"><span data-stu-id="880d4-119">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="880d4-120">База поиска</span><span class="sxs-lookup"><span data-stu-id="880d4-120">Base of the search</span></span> | <span data-ttu-id="880d4-121">База поиска DirSync должна быть корнем раздела каталога, который может быть разделом домена, разделом конфигурации или Секцией схемы.</span><span class="sxs-lookup"><span data-stu-id="880d4-121">The base of a DirSync search must be the root of a directory partition, which can be a domain partition, the configuration partition, or the schema partition.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="880d4-122">Область</span><span class="sxs-lookup"><span data-stu-id="880d4-122">Scope</span></span>              | <span data-ttu-id="880d4-123">Область поиска DirSync должна быть **\_ \_ поддеревом области объявлений**, то есть всем поддеревом секции.</span><span class="sxs-lookup"><span data-stu-id="880d4-123">The scope of a DirSync search must be **ADS\_SCOPE\_SUBTREE**, that is, the entire subtree of the partition.</span></span> <span data-ttu-id="880d4-124">Имейте в виду, что при поиске в разделе предметной области поддерево включает в себя заголовки, но не содержимое разделов конфигурации и схемы.</span><span class="sxs-lookup"><span data-stu-id="880d4-124">Be aware that for a search of a domain partition, the subtree includes the heads, but not the contents, of the configuration and schema partitions.</span></span> <span data-ttu-id="880d4-125">Для опроса изменений в области меньшего размера используйте метод **USNChanged** вместо DirSync.</span><span class="sxs-lookup"><span data-stu-id="880d4-125">To poll for changes in a smaller scope, use the **USNChanged** technique instead of DirSync.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="880d4-126">Фильтр</span><span class="sxs-lookup"><span data-stu-id="880d4-126">Filter</span></span>             | <span data-ttu-id="880d4-127">Можно указать любой допустимый фильтр поиска.</span><span class="sxs-lookup"><span data-stu-id="880d4-127">You can specify any valid search filter.</span></span> <span data-ttu-id="880d4-128">Для первоначального поиска с нулевым файлом cookie результаты включают все объекты, соответствующие фильтру.</span><span class="sxs-lookup"><span data-stu-id="880d4-128">For an initial search with a null cookie, the results include all objects that match the filter.</span></span> <span data-ttu-id="880d4-129">Для последующих поисков с допустимым файлом cookie результаты поиска включают только те объекты, которые соответствуют фильтру и были изменены после состояния, указанного в файле cookie.</span><span class="sxs-lookup"><span data-stu-id="880d4-129">For subsequent searches with a valid cookie, the search results include data only for objects that match the filter and have changed since the state indicated by the cookie.</span></span> <span data-ttu-id="880d4-130">Дополнительные сведения о фильтрах поиска см. [в разделе Создание фильтра запросов](creating-a-query-filter.md).</span><span class="sxs-lookup"><span data-stu-id="880d4-130">For more information about search filters, see [Creating a Query Filter](creating-a-query-filter.md).</span></span>                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="880d4-131">Атрибуты</span><span class="sxs-lookup"><span data-stu-id="880d4-131">Attributes</span></span>         | <span data-ttu-id="880d4-132">Можно указать список атрибутов, возвращаемых при возникновении изменений.</span><span class="sxs-lookup"><span data-stu-id="880d4-132">You can specify a list of attributes to be returned when a change occurs.</span></span> <span data-ttu-id="880d4-133">Для каждого объекта первоначальные результаты включают все запрошенные атрибуты, заданные для объекта.</span><span class="sxs-lookup"><span data-stu-id="880d4-133">For each object, the initial results include all the requested attributes set on the object.</span></span> <span data-ttu-id="880d4-134">Последующие результаты поиска включают только указанные атрибуты, которые были изменены.</span><span class="sxs-lookup"><span data-stu-id="880d4-134">Subsequent search results include only the specified attributes that have changed.</span></span> <span data-ttu-id="880d4-135">Неизмененные атрибуты не включаются в результаты поиска.</span><span class="sxs-lookup"><span data-stu-id="880d4-135">Unchanged attributes are not included in the search results.</span></span> <span data-ttu-id="880d4-136">В реализации ADSI результаты поиска всегда содержат **objectGUID** и **instanceType** каждого объекта.</span><span class="sxs-lookup"><span data-stu-id="880d4-136">In the ADSI implementation, the search results always include the **objectGUID** and **instanceType** of each object.</span></span> <span data-ttu-id="880d4-137">Кроме того, указанный список атрибутов выступает в качестве дополнительного фильтра: первоначальные результаты поиска включают только объекты, для которых установлен хотя бы один из указанных атрибутов. последующие поисковые запросы включают только те объекты, в которых изменился один или несколько атрибутов (добавленные или удаленные значения).</span><span class="sxs-lookup"><span data-stu-id="880d4-137">Also, the specified attribute list acts as an additional filter: the initial search results include only objects that have at least one of the specified attributes set; subsequent searches include only objects on which one or more of the attributes have changed (values added or deleted).</span></span> |



 

<span data-ttu-id="880d4-138">Кроме того, имейте в виду, что:</span><span class="sxs-lookup"><span data-stu-id="880d4-138">Also, be aware that:</span></span>

-   <span data-ttu-id="880d4-139">Для добавочного поиска рекомендуется выполнить привязку к тому же контроллеру домена, который использовался в предыдущем поиске, то есть КОНТРОЛЛЕРом домена, создавшим файл cookie.</span><span class="sxs-lookup"><span data-stu-id="880d4-139">For incremental searches, the best practice is to bind to the same domain controller (DC) used in the previous search, that is, the DC that generated the cookie.</span></span> <span data-ttu-id="880d4-140">Если один и тот же контроллер домена недоступен, дождитесь его завершения или выполните привязку к новому контроллеру домена и выполните полную синхронизацию.</span><span class="sxs-lookup"><span data-stu-id="880d4-140">If the same DC is unavailable, either wait until it is, or bind to a new DC and perform a full synchronization.</span></span> <span data-ttu-id="880d4-141">Сохраните DNS-имя контроллера домена в дополнительном хранилище с помощью файла cookie.</span><span class="sxs-lookup"><span data-stu-id="880d4-141">Store the DNS name of the DC in the secondary storage with the cookie.</span></span>

    <span data-ttu-id="880d4-142">Файл cookie, созданный одним контроллером домена, можно передать другому контроллеру домена, содержащему реплику того же раздела каталога.</span><span class="sxs-lookup"><span data-stu-id="880d4-142">You can pass a cookie generated by one DC to a different DC hosting a replica of the same directory partition.</span></span> <span data-ttu-id="880d4-143">Не существует шанса, что клиент будет пропускать изменения с помощью файла cookie с одного контроллера домена на другом.</span><span class="sxs-lookup"><span data-stu-id="880d4-143">There is no chance that a client will miss changes by using a cookie from one DC on another DC.</span></span> <span data-ttu-id="880d4-144">Однако возможно, что результаты поиска с нового контроллера домена могут содержать сведения об изменениях старого контроллера домена. в некоторых случаях новый контроллер домена может возвращать все объекты и атрибуты, как и при полной синхронизации.</span><span class="sxs-lookup"><span data-stu-id="880d4-144">However, it is possible that the search results from the new DC may include reported changes by the old DC; in some cases, the new DC may return all objects and attributes, as with a full synchronization.</span></span> <span data-ttu-id="880d4-145">Клиент должен просто сделать свою базу данных в соответствии с полученными результатами поиска для любого вызова DirSync, то есть обрабатывали все добавочные результаты, как если бы они были последними состояниями.</span><span class="sxs-lookup"><span data-stu-id="880d4-145">The client should just make its database consistent with reported search results for any given DirSync call, that is, handle all incremental results as if they were the latest state.</span></span> <span data-ttu-id="880d4-146">Не имеет значения, было ли рассмотрено изменение до или даже переход к предыдущему состоянию, так как повторные добавочные синхронизации будут согласованы по сравнению.</span><span class="sxs-lookup"><span data-stu-id="880d4-146">It does not matter whether you have seen the change before or are even going back to a previous state because repeated incremental synchronizations will converge on consistency.</span></span>

-   <span data-ttu-id="880d4-147">При переименовании или перемещении объекта его дочерние объекты (если таковые имеются) не включаются в результаты поиска, несмотря на то, что изменились различающиеся имена дочерних объектов.</span><span class="sxs-lookup"><span data-stu-id="880d4-147">When an object is renamed or moved, its child objects, if any, are not included in the search results, even though the distinguished names of the child objects have changed.</span></span> <span data-ttu-id="880d4-148">Аналогично, при изменении наследуемого ACE в дескрипторе безопасности объекта дочерние объекты объекта не включаются в результаты поиска, даже если изменились дескрипторы безопасности дочерних объектов.</span><span class="sxs-lookup"><span data-stu-id="880d4-148">Similarly, when an inheritable ACE is modified in an object security-descriptor, the child objects of the object are not included in the search results, even though the security-descriptors of the child objects have changed.</span></span>
-   <span data-ttu-id="880d4-149">Используйте атрибут **objectGUID** для обнаружения объектов, на которые отписываются объекты.</span><span class="sxs-lookup"><span data-stu-id="880d4-149">Use the **objectGUID** attribute to identify the tracked objects.</span></span> <span data-ttu-id="880d4-150">**ObjectGUID** каждого объекта остается неизменным независимо от места перемещения объекта в пределах леса.</span><span class="sxs-lookup"><span data-stu-id="880d4-150">The **objectGUID** of each object remains unchanged regardless of where the object is moved within the forest.</span></span>
-   <span data-ttu-id="880d4-151">Имейте в виду, что результаты поиска DirSync указывают состояние объектов в реплике раздела каталога на момент поиска.</span><span class="sxs-lookup"><span data-stu-id="880d4-151">Be aware that the search results of a DirSync search indicate the state of the objects on a replica of the directory partition at the time of the search.</span></span> <span data-ttu-id="880d4-152">Это означает, что изменения, внесенные в другие контроллеры домена, не будут включены, если они не были реплицированы на целевой контроллер домена.</span><span class="sxs-lookup"><span data-stu-id="880d4-152">This means that changes made on other DCs will not be included if they have not been replicated to the target DC.</span></span> <span data-ttu-id="880d4-153">Это также означает, что атрибуты объекта могли измениться несколько раз с момента предыдущего поиска DirSync, но поиск будет показывать только конечное состояние, а не последовательность изменений.</span><span class="sxs-lookup"><span data-stu-id="880d4-153">It also means that an object's attributes may have changed several times since the previous DirSync search, but the search will show only the final state, not the sequence of changes.</span></span>
-   <span data-ttu-id="880d4-154">В реализации ADSI приложение должно управлять файлом cookie как непрозрачным и не делать никаких предположений относительно внутренней организации или ценности.</span><span class="sxs-lookup"><span data-stu-id="880d4-154">In the ADSI implementation, the application must handle the cookie as opaque and not make any assumptions about its internal organization or value.</span></span>
-   <span data-ttu-id="880d4-155">Имейте в виду, что клиент сохраняет файлы cookie, длину файлов cookie и DNS-имя контроллера домена в том же хранилище, которое содержит синхронизированные данные объекта.</span><span class="sxs-lookup"><span data-stu-id="880d4-155">Be aware that the client stores the cookie, cookie length, and DNS name of the DC in the same storage that contains the synchronized object data.</span></span> <span data-ttu-id="880d4-156">Это гарантирует, что файлы cookie и другие параметры будут синхронизированы с данными объекта, если хранилище восстанавливается из резервной копии.</span><span class="sxs-lookup"><span data-stu-id="880d4-156">This ensures that the cookie and other parameters remain in sync with the object data if the storage is ever restored from a backup.</span></span>
-   <span data-ttu-id="880d4-157">Чтобы получить атрибут [**парентгуид**](/windows/desktop/ADSchema/a-parentguid) , который создается для элемента управления DirSync, также необходимо запросить атрибут [**Name**](/windows/desktop/ADSchema/a-name) .</span><span class="sxs-lookup"><span data-stu-id="880d4-157">To retrieve the [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) attribute, which is constructed for the DirSync control, it is also necessary to request the [**name**](/windows/desktop/ADSchema/a-name) attribute.</span></span>

<span data-ttu-id="880d4-158">Чтобы использовать элемент управления DirSync, вызывающий объект должен иметь право "Directory Get Changes", назначенное в корне отслеживаемой секции.</span><span class="sxs-lookup"><span data-stu-id="880d4-158">To use the DirSync control, caller must have the "directory get changes" right assigned on the root of the partition being monitored.</span></span> <span data-ttu-id="880d4-159">По умолчанию это право назначается учетным записям администратора и LocalSystem на контроллерах домена.</span><span class="sxs-lookup"><span data-stu-id="880d4-159">By default, this right is assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span> <span data-ttu-id="880d4-160">У вызывающего объекта также должна быть права на расширенный контроль доступа [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) .</span><span class="sxs-lookup"><span data-stu-id="880d4-160">The caller must also have the [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) extended control access right.</span></span> <span data-ttu-id="880d4-161">Дополнительные сведения о реализации механизма отслеживания изменений для приложений, которые должны выполняться под учетной записью, не имеющей этого права, см. в разделе [опрос изменений с помощью USNChanged](polling-for-changes-using-usnchanged.md).</span><span class="sxs-lookup"><span data-stu-id="880d4-161">For more information about implementing a change-tracking mechanism for applications that must run under an account that does not have this right, see [Polling for Changes Using USNChanged](polling-for-changes-using-usnchanged.md).</span></span> <span data-ttu-id="880d4-162">Дополнительные сведения о привилегиях см. в разделе [привилегии](/windows/desktop/SecAuthZ/privileges).</span><span class="sxs-lookup"><span data-stu-id="880d4-162">For more information about privileges, see [Privileges](/windows/desktop/SecAuthZ/privileges).</span></span>

## <a name="retrieving-deleted-objects-with-a-dirsync-search"></a><span data-ttu-id="880d4-163">Получение удаленных объектов с помощью поиска DirSync</span><span class="sxs-lookup"><span data-stu-id="880d4-163">Retrieving Deleted Objects With a DirSync Search</span></span>

<span data-ttu-id="880d4-164">Результаты поиска в **ADS \_ сеарчпреф \_ DIRSYNC** автоматически включают удаленные объекты (захоронения), соответствующие заданному фильтру поиска.</span><span class="sxs-lookup"><span data-stu-id="880d4-164">The **ADS\_SEARCHPREF\_DIRSYNC** search results automatically include deleted objects (tombstones) that match the specified search filter.</span></span> <span data-ttu-id="880d4-165">Однако фильтр поиска, который будет сопоставлять объект в режиме реального времени, может не соответствовать объекту после его удаления.</span><span class="sxs-lookup"><span data-stu-id="880d4-165">However, a search filter that will match an object when it is live may not match the object after it is deleted.</span></span> <span data-ttu-id="880d4-166">Это обусловлено тем, что объекты-захоронения сохранены только подмножество атрибутов, имеющихся в исходном объекте.</span><span class="sxs-lookup"><span data-stu-id="880d4-166">This is because tombstones retain only a subset of the attributes present on the original object.</span></span> <span data-ttu-id="880d4-167">Например, для объектов User обычно используется следующий фильтр.</span><span class="sxs-lookup"><span data-stu-id="880d4-167">For example, you would typically use the following filter for user objects.</span></span>


```C++
(&(objectClass=user)(objectCategory=person))
```



<span data-ttu-id="880d4-168">Атрибут **objectCategory** удаляется при удалении объекта, поэтому приведенный выше фильтр не будет соответствовать ни одному из объектов-захоронений.</span><span class="sxs-lookup"><span data-stu-id="880d4-168">The **objectCategory** attribute is removed when an object is deleted, so the filter above would not match any tombstone objects.</span></span> <span data-ttu-id="880d4-169">И наоборот, атрибут **objectClass** сохраняется для объектов-захоронений, поэтому фильтр "(objectClass = User)" будет соответствовать удаленным пользовательским объектам.</span><span class="sxs-lookup"><span data-stu-id="880d4-169">Conversely, the **objectClass** attribute is retained on tombstone objects, so a filter of "(objectClass=user)" would match deleted user objects.</span></span>

<span data-ttu-id="880d4-170">Список атрибутов, указываемый с помощью поиска DirSync, также выступает в качестве фильтра. Результаты поиска включают только те объекты, в которых один или несколько указанных атрибутов были изменены с момента предыдущего поиска DirSync.</span><span class="sxs-lookup"><span data-stu-id="880d4-170">The attribute list that you specify with a DirSync search also acts as a filter; search results include only objects on which one or more of the specified attributes have changed since the previous DirSync search.</span></span> <span data-ttu-id="880d4-171">Если список атрибутов не включает атрибуты, которые хранятся на отметках полного удаления, результаты поиска не будут включать отметки полного удаления.</span><span class="sxs-lookup"><span data-stu-id="880d4-171">If the attribute list does not include any attributes that are retained on tombstones, the search results will not include tombstones.</span></span> <span data-ttu-id="880d4-172">Чтобы справиться с этим, запросите все атрибуты, указав список атрибутов со значением NULL. или же можно запросить атрибут **IsDeleted** , задать значение **true** для всех объектов-захоронений.</span><span class="sxs-lookup"><span data-stu-id="880d4-172">To handle this, request all attributes by specifying a null attribute list; or you can request the **isDeleted** attribute, set to **TRUE** on all tombstones.</span></span> <span data-ttu-id="880d4-173">Атрибуты захоронения имеют бит 0x8, заданный в атрибуте **searchFlags** определения **attributeSchema** .</span><span class="sxs-lookup"><span data-stu-id="880d4-173">Tombstone attributes have the 0x8 bit set in the **searchFlags** attribute of the **attributeSchema** definition.</span></span>

<span data-ttu-id="880d4-174">Дополнительные сведения см. в разделе [получение удаленных объектов](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="880d4-174">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

## <a name="ldap-implementation-of-the-dirsync-control"></a><span data-ttu-id="880d4-175">Реализация LDAP элемента управления DirSync</span><span class="sxs-lookup"><span data-stu-id="880d4-175">LDAP Implementation of the DirSync Control</span></span>

<span data-ttu-id="880d4-176">Можно также выполнить поиск DirSync с помощью API LDAP с элементом управления [ \_ \_ DirSync \_ сервера LDAP](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) .</span><span class="sxs-lookup"><span data-stu-id="880d4-176">You can also perform a DirSync search by using the LDAP API with the [LDAP\_SERVER\_DIRSYNC\_OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) control.</span></span> <span data-ttu-id="880d4-177">При использовании API LDAP также укажите для LDAP- [ \_ сервера \_ Расширенное \_ DN \_ OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) и [сервер LDAP \_ \_ Отображение \_ удаленных \_ ](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) элементов управления OID.</span><span class="sxs-lookup"><span data-stu-id="880d4-177">If you use the LDAP API, also specify the [LDAP\_SERVER\_EXTENDED\_DN\_OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) and [LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) controls.</span></span> <span data-ttu-id="880d4-178">\_ \_ Управляющий элемент расширенного DN-объекта LDAP-сервера \_ \_ позволяет поисковому протоколу LDAP вернуть расширенную форму различающегося имени, включающее **objectGUID** и **objectSid** для объектов субъекта безопасности, таких как пользователи, группы и компьютеры.</span><span class="sxs-lookup"><span data-stu-id="880d4-178">The LDAP\_SERVER\_EXTENDED\_DN\_OID control causes an LDAP search to return an extended form of the distinguished name that includes the **objectGUID** and **objectSID** for security principal objects such as users, groups, and computers.</span></span> <span data-ttu-id="880d4-179">Сервер LDAP \_ \_ отображает \_ Удаленный \_ элемент управления OID, в результате чего результаты поиска включаются в данные удаленных объектов.</span><span class="sxs-lookup"><span data-stu-id="880d4-179">The LDAP\_SERVER\_SHOW\_DELETED\_OID control causes the search results to include data for deleted objects.</span></span> <span data-ttu-id="880d4-180">Имейте в виду, что эти элементы управления автоматически включаются в реализацию ADSI.</span><span class="sxs-lookup"><span data-stu-id="880d4-180">Be aware that these controls are automatically included in the ADSI implementation.</span></span>

 

 