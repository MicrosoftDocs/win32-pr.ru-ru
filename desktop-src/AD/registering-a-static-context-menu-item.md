---
title: Регистрация статического элемента контекстного меню
description: В этом разделе описывается регистрация элемента статического контекстного меню, отображаемого для Active Directory объектов.
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Регистрация элемента статического контекстного меню в Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "105654279"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="ddde8-104">Регистрация статического элемента контекстного меню</span><span class="sxs-lookup"><span data-stu-id="ddde8-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="ddde8-105">Административные оснастки MMC служб домен Active Directory и оболочка Windows предоставляют механизм для добавления элемента в контекстное меню, отображаемое для объектов в службах домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="ddde8-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="ddde8-106">Контекстное меню может вызвать любой файл, который можно запустить с помощью API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , такого как URL-адрес приложения или веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="ddde8-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="ddde8-107">Регистрация в домен Active Directory Services</span><span class="sxs-lookup"><span data-stu-id="ddde8-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="ddde8-108">Регистрация расширения контекстного меню зависит от одного языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="ddde8-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="ddde8-109">Если расширение контекстного меню применяется ко всем языкам, оно должно быть зарегистрировано в объекте [**дисплайспеЦифиер**](/windows/desktop/ADSchema/c-displayspecifier) класса объекта во всех вложенных компонентах языкового стандарта в контейнере описатели вывода.</span><span class="sxs-lookup"><span data-stu-id="ddde8-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="ddde8-110">Если расширение контекстного меню локализовано для определенного языкового стандарта, оно должно быть зарегистрировано в объекте **дисплайспеЦифиер** в этом вложенном элементе locale.</span><span class="sxs-lookup"><span data-stu-id="ddde8-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="ddde8-111">Дополнительные сведения о контейнерах и языковых стандартах для описателей вывода см. в разделе [описатели](display-specifiers.md) и [контейнеры дисплайспеЦифиерс](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="ddde8-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="ddde8-112">Существует два атрибута спецификаторов вывода, которые можно зарегистрировать в элементе статического контекстного меню в, [**админконтекстмену**](/windows/desktop/ADSchema/a-admincontextmenu) и [**шеллконтекстмену**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="ddde8-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="ddde8-113">Атрибут [**админконтекстмену**](/windows/desktop/ADSchema/a-admincontextmenu) определяет административные контекстные меню, отображаемые в административных оснастках служб домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="ddde8-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="ddde8-114">Контекстное меню появляется, когда пользователь отображает контекстное меню для объектов соответствующего класса в одной из оснасток администрирования MMC.</span><span class="sxs-lookup"><span data-stu-id="ddde8-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="ddde8-115">Атрибут [**шеллконтекстмену**](/windows/desktop/ADSchema/a-shellcontextmenu) определяет контекстные меню конечных пользователей, отображаемых в оболочке Windows.</span><span class="sxs-lookup"><span data-stu-id="ddde8-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="ddde8-116">Контекстное меню появляется, когда пользователь просматривает контекстное меню для объектов соответствующего класса в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="ddde8-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="ddde8-117">Начиная с Windows Server 2003, оболочка Windows больше не отображает объекты из домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="ddde8-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="ddde8-118">Все эти атрибуты являются многозначными.</span><span class="sxs-lookup"><span data-stu-id="ddde8-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="ddde8-119">При регистрации статического элемента контекстного меню значения для атрибутов [**админконтекстмену**](/windows/desktop/ADSchema/a-admincontextmenu) и [**шеллконтекстмену**](/windows/desktop/ADSchema/a-shellcontextmenu) должны иметь следующий формат.</span><span class="sxs-lookup"><span data-stu-id="ddde8-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="ddde8-120">&lt;Порядковый номер &gt; — это число без знака, представляющее позицию элемента в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="ddde8-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="ddde8-121">При отображении контекстного меню значения сортируются с помощью сравнения "номер заказа" каждого значения &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="ddde8-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="ddde8-122">Если несколько значений имеют одинаковый &lt; порядковый номер, то &gt; расширения контекстного меню загружаются в том порядке, в котором они считываются с Active Directory сервера.</span><span class="sxs-lookup"><span data-stu-id="ddde8-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="ddde8-123">Если возможно, используйте несуществующий " &lt; номер заказа &gt; ", то есть тот, который не использовался другими значениями в свойстве.</span><span class="sxs-lookup"><span data-stu-id="ddde8-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="ddde8-124">Нет предписанной начальной должности, и в &lt; последовательности "номер заказа" могут пропуски &gt; .</span><span class="sxs-lookup"><span data-stu-id="ddde8-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="ddde8-125">&lt;Текст меню &gt; — это строка, отображаемая в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="ddde8-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="ddde8-126">&lt;Текст меню &gt; может содержать один символ «&», который предшествует сочетанию клавиш для пункта меню.</span><span class="sxs-lookup"><span data-stu-id="ddde8-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="ddde8-127">Это вызовет подчеркивание предшествующего символа.</span><span class="sxs-lookup"><span data-stu-id="ddde8-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="ddde8-128">Например, если " &lt; текст меню &gt; " имеет значение "&файл", то текст меню будет отображаться как "файл", а "f" будет подчеркнут, а "f" будет сочетанием клавиш для элемента меню.</span><span class="sxs-lookup"><span data-stu-id="ddde8-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="ddde8-129">" &lt; Команда &gt; " — это программа или файл, выполняемые оснасткой.</span><span class="sxs-lookup"><span data-stu-id="ddde8-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="ddde8-130">Либо должен быть указан полный путь, либо файл должен существовать в переменной среды PATH компьютера.</span><span class="sxs-lookup"><span data-stu-id="ddde8-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="ddde8-131">Файл вызывается с помощью функции [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="ddde8-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="ddde8-132">" &lt; Команда &gt; " не может содержать дополнительные параметры, например Notepad.exe Myfile.txt.</span><span class="sxs-lookup"><span data-stu-id="ddde8-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="ddde8-133">Поскольку используется **ShellExecute** , любой файл или адрес, который можно передать в **ShellExecute** , можно использовать для команды " &lt; Command &gt; ".</span><span class="sxs-lookup"><span data-stu-id="ddde8-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="ddde8-134">Например, если " &lt; Command &gt; " содержит "d: \\file.txt", d: \\file.txt будет открыт с приложением, связанным с расширением txt.</span><span class="sxs-lookup"><span data-stu-id="ddde8-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="ddde8-135">Аналогично, если " &lt; команда &gt; " содержит " https://www.fabrikam.com ", открывается веб-браузер по умолчанию и отображается указанная страница.</span><span class="sxs-lookup"><span data-stu-id="ddde8-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="ddde8-136">Разрешены пути и имена приложений с пробелами.</span><span class="sxs-lookup"><span data-stu-id="ddde8-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="ddde8-137">Если " &lt; команда &gt; " является приложением, то путь к выбранному объекту и класс передаются как аргументы командной строки, разделенные пробелом.</span><span class="sxs-lookup"><span data-stu-id="ddde8-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="ddde8-138">В оболочке Windows поддерживаются элементы контекстного меню с множественным выбором.</span><span class="sxs-lookup"><span data-stu-id="ddde8-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="ddde8-139">В этом случае &lt; команда &gt; вызывается для каждого выбранного объекта.</span><span class="sxs-lookup"><span data-stu-id="ddde8-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="ddde8-140">В оснастке "Администрирование" домен Active Directory Services не поддерживаются статические элементы контекстного меню с множественным выбором.</span><span class="sxs-lookup"><span data-stu-id="ddde8-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ddde8-141">Для оболочки Windows данные описателя экрана извлекаются при входе пользователя в систему и кэшируются для сеанса пользователя.</span><span class="sxs-lookup"><span data-stu-id="ddde8-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="ddde8-142">Для административных оснасток данные описателя просмотра извлекаются при загрузке оснастки и кэшируются в течение этого процесса.</span><span class="sxs-lookup"><span data-stu-id="ddde8-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="ddde8-143">Для оболочки Windows это означает, что изменения описателей экрана вступают в силу после выхода пользователя из системы и обратного входа.</span><span class="sxs-lookup"><span data-stu-id="ddde8-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="ddde8-144">Для административных оснасток изменения вступают в силу при перезагрузке оснастки или файла консоли; Это значит, что при запуске нового экземпляра файла консоли или нового экземпляра Mmc.exe и добавлении оснастки извлекаются последние данные описателя вывода.</span><span class="sxs-lookup"><span data-stu-id="ddde8-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="ddde8-145">Дополнительные сведения и пример кода см. в разделе [пример кода для установки статического элемента контекстного меню](example-code-for-installing-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="ddde8-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 