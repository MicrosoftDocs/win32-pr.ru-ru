---
title: Обработка результатов поиска
description: После первого вызова IDirectorySearch Жетфирстров или IDirectorySearch GetNextRow, либо ОК, либо \_ \_ \_ все \_ строки, либо возвращается результат ошибки.
ms.assetid: 3a84f394-a256-4815-901c-eaaae3d54b75
ms.tgt_platform: multiple
keywords:
- Обработка результатов поиска
- Active Directory, поиск, обработка результатов поиска
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 732128438162f5ee8f6fe75bb4d2ce53e0d43070
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "105654283"
---
# <a name="processing-the-search-results"></a><span data-ttu-id="e3b66-105">Обработка результатов поиска</span><span class="sxs-lookup"><span data-stu-id="e3b66-105">Processing the Search Results</span></span>

<span data-ttu-id="e3b66-106">После первого вызова [**IDirectorySearch:: жетфирстров**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) или [**IDirectorySearch:: GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), **s \_ ОК**, **s \_ баннеры \_ \_** не со строки или возвращается результат ошибки.</span><span class="sxs-lookup"><span data-stu-id="e3b66-106">After the first call to [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) or [**IDirectorySearch::GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), either **S\_OK**, **S\_ADS\_NOMORE\_ROWS**, or an error result is returned.</span></span>

<span data-ttu-id="e3b66-107">Если возвращаемое значение равно S, то больше **\_ \_ \_ строк** не найдено ни одного объекта, соответствующего фильтру.</span><span class="sxs-lookup"><span data-stu-id="e3b66-107">If the return value is **S\_ADS\_NOMORE\_ROWS**, no more objects matching the filter were found.</span></span> <span data-ttu-id="e3b66-108">Если возвращается результат ошибки, запрос не выполнен.</span><span class="sxs-lookup"><span data-stu-id="e3b66-108">If an error result is returned, the query failed.</span></span> <span data-ttu-id="e3b66-109">В обоих случаях обработка строк в результате не требуется, так как ничего не было возвращено.</span><span class="sxs-lookup"><span data-stu-id="e3b66-109">In both cases, you are not required to process the rows in the result because nothing was returned.</span></span>

<span data-ttu-id="e3b66-110">Если возвращается значение **S \_ ОК** , то была получена строка.</span><span class="sxs-lookup"><span data-stu-id="e3b66-110">If **S\_OK** is returned, a row has been retrieved.</span></span> <span data-ttu-id="e3b66-111">Столбцы можно анализировать по имени с помощью [**IDirectorySearch:: column**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span><span class="sxs-lookup"><span data-stu-id="e3b66-111">You can parse the columns by name using [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span></span> <span data-ttu-id="e3b66-112">Имя является атрибутом **lDAPDisplayName** атрибута в столбце.</span><span class="sxs-lookup"><span data-stu-id="e3b66-112">The name is the **lDAPDisplayName** of the attribute in the column.</span></span> <span data-ttu-id="e3b66-113">Набор всех столбцов был определен параметром Паттрибутенамес метода [**IDirectorySearch:: ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) .</span><span class="sxs-lookup"><span data-stu-id="e3b66-113">The set of all columns was defined by the pAttributeNames parameter of the [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) method.</span></span> <span data-ttu-id="e3b66-114">Если указано **значение NULL** , набор всех столбцов является объединением всех свойств, найденных для всех возвращаемых объектов.</span><span class="sxs-lookup"><span data-stu-id="e3b66-114">If **NULL** was specified, the set of all columns is the union of all properties found for all the objects returned.</span></span> <span data-ttu-id="e3b66-115">Чтобы считать весь набор столбцов, возвращаемых для объекта, используйте [**IDirectorySearch:: жетнекстколумннаме**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) для итерации каждого столбца и используйте имя столбца, возвращенное для вызова **IDirectorySearch::** GetObject.</span><span class="sxs-lookup"><span data-stu-id="e3b66-115">To read the entire set of columns returned for an object, use the [**IDirectorySearch::GetNextColumnName**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) to iterate each column, and use the column name returned to call **IDirectorySearch::GetColumn**.</span></span>

<span data-ttu-id="e3b66-116">Метод [**IDirectorySearch:: DataColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) возвращает структуру [**\_ \_ столбца поиска ADS**](/windows/desktop/api/iads/ns-iads-ads_search_column) , содержащую имя атрибута, тип атрибута, число значений и указатель на массив структур [**адсвалуе**](/windows/desktop/api/iads/ns-iads-adsvalue) , содержащих значения.</span><span class="sxs-lookup"><span data-stu-id="e3b66-116">The [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) method returns an [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/iads/ns-iads-ads_search_column) structure that contains the attribute name, the type of the attribute, count of values, and a pointer to an array of [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) structures that contain the values.</span></span> <span data-ttu-id="e3b66-117">Структуры **адсвалуе** можно прокручивать, чтобы считать значения для свойства, возвращаемого столбцом.</span><span class="sxs-lookup"><span data-stu-id="e3b66-117">You can loop through the **ADSVALUE** structures to read the values for the property returned by the column.</span></span> <span data-ttu-id="e3b66-118">Необходимо прочитать соответствующий элемент структуры **адсвалуе** , основанный на [**адстипе**](/windows/win32/api/iads/ne-iads-adstypeenum) , заданном элементом **двадстипе** структуры **\_ \_ столбцов поиска баннеров** (или членом **двтипе** структуры **адсвалуе** ).</span><span class="sxs-lookup"><span data-stu-id="e3b66-118">You must read the appropriate member of the **ADSVALUE** structure based on the [**ADSTYPE**](/windows/win32/api/iads/ne-iads-adstypeenum) specified by the **dwADsType** member of the **ADS\_SEARCH\_COLUMN** structure (or the **dwType** member of the **ADSVALUE** structure).</span></span> <span data-ttu-id="e3b66-119">Например, если **двадстипе** было **адстипе \_ Integer**, то вы бы читали **целочисленный** элемент каждой структуры **адсвалуе** .</span><span class="sxs-lookup"><span data-stu-id="e3b66-119">For example, if **dwADsType** was **ADSTYPE\_INTEGER**, you would read the **Integer** member of each **ADSVALUE** structure.</span></span>

<span data-ttu-id="e3b66-120">Дополнительные сведения и пример кода см. в разделе [пример кода для поиска пользователей](example-code-for-searching-for-users.md).</span><span class="sxs-lookup"><span data-stu-id="e3b66-120">For more information and a code example, see [Example Code for Searching for Users](example-code-for-searching-for-users.md).</span></span>

 

 