---
title: Контекстные меню для использования с описателем экрана
description: Оснастки администрирования MMC Active Directory и оболочка Windows 2000 предоставляют механизм для добавления элемента в контекстное меню, отображаемое для объектов в службах домен Active Directory Services.
ms.assetid: 0b0691f5-321d-4f22-b39c-bc528db9e707
ms.tgt_platform: multiple
keywords:
- Описатели экрана AD, контекстные меню для
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f28fbf703f17ea5c0fa7938365d485998be77e8d
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103987349"
---
# <a name="context-menus-for-use-with-display-specifiers"></a><span data-ttu-id="4f624-104">Контекстные меню для использования с описателем экрана</span><span class="sxs-lookup"><span data-stu-id="4f624-104">Context Menus for Use with Display Specifiers</span></span>

<span data-ttu-id="4f624-105">Оснастки администрирования MMC Active Directory и оболочка Windows 2000 предоставляют механизм для добавления элемента в контекстное меню, отображаемое для объектов в службах домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="4f624-105">The Active Directory administrative MMC snap-ins and Windows 2000 shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="4f624-106">Элемент контекстного меню можно добавить, реализовав сервер COM in-proc, известный как *Расширение контекстного меню*.</span><span class="sxs-lookup"><span data-stu-id="4f624-106">A context menu item can be added by implementing an COM in-proc server known as a *context menu extension*.</span></span> <span data-ttu-id="4f624-107">Также можно добавить элемент контекстного меню, который вызывает любой файл, запущенный с помощью API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , например, URL-адрес приложения или веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="4f624-107">A context menu item can also be added that invokes any file started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span> <span data-ttu-id="4f624-108">Это называется *статическим пунктом контекстного меню*.</span><span class="sxs-lookup"><span data-stu-id="4f624-108">This is known as a *static context menu item*.</span></span>

## <a name="developer-audience"></a><span data-ttu-id="4f624-109">Аудитория разработчиков</span><span class="sxs-lookup"><span data-stu-id="4f624-109">Developer Audience</span></span>

<span data-ttu-id="4f624-110">В этой документации предполагается, что читатель знаком с разработкой COM-операций и компонентов с помощью C++.</span><span class="sxs-lookup"><span data-stu-id="4f624-110">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="4f624-111">В настоящее время невозможно создать расширение контекстного меню служб домен Active Directory с помощью Visual Basic Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="4f624-111">It is not currently possible to create an Active Directory Domain Services context menu extension using Microsoft Visual Basic.</span></span>

## <a name="extending-the-context-menu-with-a-context-menu-extension"></a><span data-ttu-id="4f624-112">Расширение контекстного меню с помощью расширения контекстного меню</span><span class="sxs-lookup"><span data-stu-id="4f624-112">Extending the Context Menu With a Context Menu Extension</span></span>

<span data-ttu-id="4f624-113">Расширение контекстного меню — это внутрипроцессный сервер COM, который реализует определенные интерфейсы и регистрируется в службах домен Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4f624-113">A context menu extension is a COM in-proc server that implements certain interfaces and is registered with Active Directory Domain Services.</span></span>

<span data-ttu-id="4f624-114">**Создание и установка расширения контекстного меню**</span><span class="sxs-lookup"><span data-stu-id="4f624-114">**To create and install a context menu extension**</span></span>

1.  <span data-ttu-id="4f624-115">Создайте библиотеку DLL расширения контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="4f624-115">Create the context menu extension DLL.</span></span> <span data-ttu-id="4f624-116">Расширение контекстного меню — это внутрипроцессный сервер COM, который, как минимум, реализует интерфейсы [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) и [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="4f624-116">A context menu extension is a COM in-proc server that, at a minimum, implements the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) interfaces.</span></span> <span data-ttu-id="4f624-117">Дополнительные сведения см. [в разделе реализация COM-объекта контекстного меню](implementing-the-context-menu-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="4f624-117">For more information, see [Implementing the Context Menu COM Object](implementing-the-context-menu-com-object.md).</span></span>
2.  <span data-ttu-id="4f624-118">Установите расширение таблицы контекстного меню на компьютерах, где используется расширение контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="4f624-118">Install the context menu sheet extension on computers where the context menu extension is used.</span></span> <span data-ttu-id="4f624-119">Это достигается путем создания пакета Microsoft установщик Windows для библиотеки DLL расширения контекстного меню и надлежащего развертывания пакета с помощью групповой политики.</span><span class="sxs-lookup"><span data-stu-id="4f624-119">This is accomplished by creating a Microsoft Windows Installer package for the context menu extension DLL and deploying the package appropriately using the group policy.</span></span> <span data-ttu-id="4f624-120">Дополнительные сведения см. в разделе [распространение компонентов пользовательского интерфейса](distributing-user-interface-components.md).</span><span class="sxs-lookup"><span data-stu-id="4f624-120">For more information, see [Distributing User Interface Components](distributing-user-interface-components.md).</span></span>
3.  <span data-ttu-id="4f624-121">Зарегистрируйте расширение контекстного меню в реестре Windows и с домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="4f624-121">Register the context menu extension in the Windows registry and with Active Directory Domain Services.</span></span> <span data-ttu-id="4f624-122">Дополнительные сведения см. [в разделе Регистрация COM-объекта контекстного меню в описателе экрана](registering-the-context-menu-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="4f624-122">For more information, see [Registering the Context Menu COM Object in a Display Specifier](registering-the-context-menu-com-object-in-a-display-specifier.md).</span></span>

## <a name="extending-the-context-menu-with-a-static-context-menu-item"></a><span data-ttu-id="4f624-123">Расширение контекстного меню с помощью статического пункта контекстного меню</span><span class="sxs-lookup"><span data-stu-id="4f624-123">Extending the Context Menu With a Static Context Menu Item</span></span>

<span data-ttu-id="4f624-124">Статический элемент контекстного меню можно использовать для вызова любого файла, запущенного с помощью API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , например для приложения или URL-адреса веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="4f624-124">A static context menu item can be used to invoke any file started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span> <span data-ttu-id="4f624-125">Для этого необходимо зарегистрировать статический элемент контекстного меню для конкретного класса объектов таким образом, чтобы в контекстное меню объектов этого класса добавлялся элемент статического контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="4f624-125">To accomplished this, the static context menu item for a particular object class must be registered so that the static context menu item is added to the context menu of objects of that class.</span></span> <span data-ttu-id="4f624-126">Дополнительные сведения см. [в разделе Регистрация статического элемента контекстного меню](registering-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="4f624-126">For more information, see [Registering a Static Context Menu Item](registering-a-static-context-menu-item.md).</span></span>

 

 