---
title: Средство выбора объектов каталога
description: Диалоговое окно Выбор объектов каталога позволяет пользователю выбрать один или несколько объектов из глобального каталога, домена, компьютера или рабочей группы.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- Средство выбора объектов каталога Active Directory
- средство выбора объектов Active Directory
- объекты Active Directory, средство выбора объектов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104069781"
---
# <a name="directory-object-picker"></a><span data-ttu-id="74678-106">Средство выбора объектов каталога</span><span class="sxs-lookup"><span data-stu-id="74678-106">Directory Object Picker</span></span>

<span data-ttu-id="74678-107">Диалоговое окно Выбор объектов каталога позволяет пользователю выбрать один или несколько объектов из глобального каталога, домена, компьютера или рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="74678-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="74678-108">Типы объектов, из которых пользователь может выбрать, включают объекты пользователя, контакта, группы и компьютера.</span><span class="sxs-lookup"><span data-stu-id="74678-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="74678-109">Дополнительные сведения о службах домен Active Directory см. в разделе [домен Active Directory Services](active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="74678-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="74678-110">Для вывода диалогового окна Выбор объектов:</span><span class="sxs-lookup"><span data-stu-id="74678-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="74678-111">Вызовите функцию [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) или [**кокреатеинстанцеекс**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) , чтобы создать экземпляр интерфейса [**идсобжектпиккер**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) .</span><span class="sxs-lookup"><span data-stu-id="74678-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="74678-112">Вызовите метод [**идсобжектпиккер:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) , чтобы инициализировать диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="74678-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="74678-113">Вызовите метод [**идсобжектпиккер:: инвокедиалог**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) , чтобы отобразить диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="74678-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="74678-114">Вызовите метод [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) экземпляра [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) , возвращенного диалоговым окном Выбор объектов, для получения [**данных \_ \_ \_ \_ списка выбора кфстр ДСОП DS**](cfstr-dsop-ds-selection-list.md) .</span><span class="sxs-lookup"><span data-stu-id="74678-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="74678-115">Формат буфера обмена **\_ \_ \_ \_ списка выбора кфстр ДСОП DS** предоставляет **Хглобал** , который содержит структуру [**\_ \_ списка выбора DS**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) .</span><span class="sxs-lookup"><span data-stu-id="74678-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="74678-116">Структура **\_ \_ списка выбора DS** содержит данные об элементах, выбранных в диалоговом окне Выбор объектов.</span><span class="sxs-lookup"><span data-stu-id="74678-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="74678-117">Если для объекта требуется идентификатор безопасности (SID), он должен быть запрошен непосредственно из средства выбора объектов путем добавления атрибута **objectSid** в список извлекаемых атрибутов для выбранного объекта.</span><span class="sxs-lookup"><span data-stu-id="74678-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="74678-118">Не рекомендуется передавать возвращенное имя объекта в функцию [**лсалукупнамес**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) или [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) , так как поиск в имени будет избыточным и может завершиться ошибкой в некоторых случаях.</span><span class="sxs-lookup"><span data-stu-id="74678-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="74678-119">Если будет сохранена ссылка на какие-либо выбранные объекты, то различающееся имя не должно сохраняться, так как объект может перемещаться, переименовано или может изменяться из-за различий в языковых стандартах.</span><span class="sxs-lookup"><span data-stu-id="74678-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="74678-120">Для субъектов безопасности **objectSid** должен быть запрошен для объекта и безопасно сохранен.</span><span class="sxs-lookup"><span data-stu-id="74678-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="74678-121">Если имя субъекта безопасности потребуется позже, его можно получить с помощью функции [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) .</span><span class="sxs-lookup"><span data-stu-id="74678-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="74678-122">Для всех остальных объектов необходимо запросить и сохранить **objectGUID** .</span><span class="sxs-lookup"><span data-stu-id="74678-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="74678-123">Инициализация</span><span class="sxs-lookup"><span data-stu-id="74678-123">Initialization</span></span>

<span data-ttu-id="74678-124">При инициализации диалогового окна «Выбор объектов» задается набор типов и фильтров области.</span><span class="sxs-lookup"><span data-stu-id="74678-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="74678-125">Указанные типы областей определяют расположения, домены или компьютеры, например, из которых пользователь может выбирать объекты.</span><span class="sxs-lookup"><span data-stu-id="74678-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="74678-126">Фильтры определяют типы объектов, которые пользователь может выбрать из определенного типа области.</span><span class="sxs-lookup"><span data-stu-id="74678-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="74678-127">Дополнительные сведения см. в разделе области и фильтры ниже.</span><span class="sxs-lookup"><span data-stu-id="74678-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="74678-128">По умолчанию пользователь может выбрать один объект в диалоговом окне Выбор объектов каталога.</span><span class="sxs-lookup"><span data-stu-id="74678-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="74678-129">Чтобы включить несколько вариантов выбора, установите флаг **ДСОП \_ флага множественного \_ выбора** в элементе **флоптионс** структуры [**ДСОП \_ \_ info**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) при инициализации этого диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="74678-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="74678-130">Области и фильтры</span><span class="sxs-lookup"><span data-stu-id="74678-130">Scopes and Filters</span></span>

<span data-ttu-id="74678-131">В раскрывающемся списке **Искать в** содержатся области, из которых пользователь может выбирать объекты.</span><span class="sxs-lookup"><span data-stu-id="74678-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="74678-132">Областью действия является домен, компьютер, Рабочая группа или глобальный каталог, в котором хранятся данные и предоставляется доступ к набору доступных объектов.</span><span class="sxs-lookup"><span data-stu-id="74678-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="74678-133">Записи в списке область зависят от типов области и целевого компьютера, указанного при последнем вызове метода [**идсобжектпиккер:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) для инициализации диалогового окна Выбор объектов.</span><span class="sxs-lookup"><span data-stu-id="74678-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="74678-134">Тип области — это универсальная Категория областей, например все домены в Организации, к которым принадлежит целевой компьютер, или глобальный каталог для предприятия целевого компьютера или сам конечный компьютер.</span><span class="sxs-lookup"><span data-stu-id="74678-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="74678-135">Для каждого указанного типа области в диалоговом окне используется контекст целевого компьютера для определения записей списка областей.</span><span class="sxs-lookup"><span data-stu-id="74678-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="74678-136">Метод [**идсобжектпиккер:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) принимает указатель на структуру [**ДСОП \_ init \_ info**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) , содержащую массив структур [**\_ \_ \_ сведений о области ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) .</span><span class="sxs-lookup"><span data-stu-id="74678-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="74678-137">Каждая запись в массиве **\_ \_ \_ сведений ДСОП Scope init** указывает один или несколько типов областей, а также применимые фильтры и другие атрибуты.</span><span class="sxs-lookup"><span data-stu-id="74678-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="74678-138">Фильтры определяют типы объектов, таких как пользователи, группы, контакты и компьютеры, которые пользователь может выбрать из определенного типа области.</span><span class="sxs-lookup"><span data-stu-id="74678-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="74678-139">Когда пользователь выбирает область из списка, диалоговое окно применяет фильтры для этого типа области для вывода списка объектов, из которых пользователь может выбрать.</span><span class="sxs-lookup"><span data-stu-id="74678-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="74678-140">Каждая [**Структура \_ \_ \_ сведений ДСОП Scope init**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) содержит структуру [**\_ \_ флагов фильтра ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) , которая задает фильтры для этого типа области.</span><span class="sxs-lookup"><span data-stu-id="74678-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="74678-141">Структура **\_ \_ флагов фильтра ДСОП** различает области действия верхнего и нижнего уровней:</span><span class="sxs-lookup"><span data-stu-id="74678-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="74678-142">Область верхнего уровня — это глобальный каталог или домен, поддерживающий [поставщик LDAP](/windows/desktop/ADSI/adsi-ldap-provider)ADSI.</span><span class="sxs-lookup"><span data-stu-id="74678-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="74678-143">Область нижнего уровня включает рабочие группы и все индивидуальные компьютеры.</span><span class="sxs-lookup"><span data-stu-id="74678-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="74678-144">В диалоговом окне для доступа к области нижнего уровня используется поставщик ADSI WinNT.</span><span class="sxs-lookup"><span data-stu-id="74678-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="74678-145">Существует два набора флагов фильтров, определенных для использования в структуре [**\_ \_ флагов фильтра ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) : один для областей верхнего уровня и один для областей нижнего уровня.</span><span class="sxs-lookup"><span data-stu-id="74678-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="74678-146">Элемент **верхнего уровня** структуры **\_ \_ флагов фильтра ДСОП** является структурой [**\_ \_ \_ флагов фильтрации верхнего уровня ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) , которая задает фильтры для областей верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="74678-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="74678-147">Элемент **флдовнлевел** структуры **\_ \_ флагов фильтра ДСОП** представляет собой набор флагов, задающих фильтры для областей нижнего уровня.</span><span class="sxs-lookup"><span data-stu-id="74678-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 