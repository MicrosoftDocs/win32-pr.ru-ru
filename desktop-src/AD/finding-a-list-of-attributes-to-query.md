---
title: Поиск списка атрибутов для запроса
description: При поиске объектов определенного класса сравнения в фильтре поиска должны указывать атрибуты, которые фактически существуют в объектах этого класса.
ms.assetid: 19d52933-e4b0-414f-9785-871e624da07b
ms.tgt_platform: multiple
keywords:
- Поиск списка атрибутов для запроса AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b4b6fb6b4d948a7cbc4d76caba9b78e189324eaa
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789535"
---
# <a name="finding-a-list-of-attributes-to-query"></a><span data-ttu-id="d7851-104">Поиск списка атрибутов для запроса</span><span class="sxs-lookup"><span data-stu-id="d7851-104">Finding a List of Attributes To Query</span></span>

<span data-ttu-id="d7851-105">При поиске объектов определенного класса сравнения в фильтре поиска должны указывать атрибуты, которые фактически существуют в объектах этого класса.</span><span class="sxs-lookup"><span data-stu-id="d7851-105">When searching for objects of a particular class, comparisons in your search filter should specify attributes that actually exist on the objects of that class.</span></span> <span data-ttu-id="d7851-106">Чтобы получить атрибуты списка для объекта определенного класса, выполните привязку к этому классу в абстрактной схеме и извлеките свойства [**иадскласс. мандаторипропертиес**](/windows/desktop/ADSI/iadsclass-property-methods) и **иадскласс. OptionalProperties** .</span><span class="sxs-lookup"><span data-stu-id="d7851-106">To get the list attributes on an object of a particular class, bind to that class in the abstract schema and retrieve the [**IADsClass.MandatoryProperties**](/windows/desktop/ADSI/iadsclass-property-methods) and **IADsClass.OptionalProperties** properties.</span></span> <span data-ttu-id="d7851-107">Дополнительные сведения см. [в разделе чтение абстрактной схемы](reading-the-abstract-schema.md).</span><span class="sxs-lookup"><span data-stu-id="d7851-107">For more information, see [Reading the Abstract Schema](reading-the-abstract-schema.md).</span></span>

<span data-ttu-id="d7851-108">Кроме того, все объекты наследуются от самого верхнего абстрактного класса.</span><span class="sxs-lookup"><span data-stu-id="d7851-108">In addition, all objects inherit from the top abstract class.</span></span> <span data-ttu-id="d7851-109">Таким образом, любой атрибут **Top** может существовать, хотя он не может быть задан для любого объекта.</span><span class="sxs-lookup"><span data-stu-id="d7851-109">Therefore, any attribute in **top** can exist, although it may not be set, on any object.</span></span>

<span data-ttu-id="d7851-110">При поиске в глобальном каталоге убедитесь, что в глобальном каталоге указаны атрибуты.</span><span class="sxs-lookup"><span data-stu-id="d7851-110">If searching the global catalog, ensure that you specify attributes in the global catalog.</span></span> <span data-ttu-id="d7851-111">Атрибуты, включенные в глобальный каталог, имеют для **исмемберофпартиалаттрибутесет** в своих объектах **attributeSchema** значение **true** .</span><span class="sxs-lookup"><span data-stu-id="d7851-111">Attributes included in the global catalog have the **isMemberOfPartialAttributeSet** set to **TRUE** on their **attributeSchema** objects.</span></span> <span data-ttu-id="d7851-112">Имейте в виду, что эти данные недоступны в абстрактной схеме. Прочтите его из объекта **attributeSchema** в контейнере схемы.</span><span class="sxs-lookup"><span data-stu-id="d7851-112">Be aware that this data is not available in the abstract schema; read it from the **attributeSchema** object in the schema container.</span></span>

<span data-ttu-id="d7851-113">В глобальном каталоге атрибут ссылки назад можно запросить только в том случае, если выполняются оба следующих условия: во-первых, атрибут помечен для включения в глобальный каталог.</span><span class="sxs-lookup"><span data-stu-id="d7851-113">In the global catalog, a back link attribute can be queried only if both of the following conditions are met: First, the attribute is marked for inclusion in the global catalog.</span></span> <span data-ttu-id="d7851-114">Во-вторых, соответствующая прямая ссылка также помечена для включения в глобальный каталог.</span><span class="sxs-lookup"><span data-stu-id="d7851-114">Second, the corresponding forward link is also marked for inclusion in the global catalog.</span></span> <span data-ttu-id="d7851-115">Это относится к фильтрам запросов, а также к результатам запросов.</span><span class="sxs-lookup"><span data-stu-id="d7851-115">This applies to query filters as well as query results.</span></span> <span data-ttu-id="d7851-116">Дополнительные сведения см. в разделе [связанные атрибуты](linked-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="d7851-116">For more information, see [Linked Attributes](linked-attributes.md).</span></span>

<span data-ttu-id="d7851-117">Кроме того, создаются некоторые атрибуты, в основном основанные на пользовательском объекте.</span><span class="sxs-lookup"><span data-stu-id="d7851-117">In addition, some attributes, mostly on the user object, are constructed.</span></span> <span data-ttu-id="d7851-118">Фильтры запросов не могут содержать сконструированные атрибуты.</span><span class="sxs-lookup"><span data-stu-id="d7851-118">Query filters cannot contain constructed attributes.</span></span> <span data-ttu-id="d7851-119">Сконструированные атрибуты не могут вычисляться в фильтрах запросов; Однако они могут возвращаться в результатах запроса.</span><span class="sxs-lookup"><span data-stu-id="d7851-119">Constructed attributes cannot be evaluated in query filters; however, they can be returned in query results.</span></span> <span data-ttu-id="d7851-120">Это относится ко всем контекстам именования и глобальному каталогу.</span><span class="sxs-lookup"><span data-stu-id="d7851-120">This applies to all the naming contexts and the global catalog.</span></span> <span data-ttu-id="d7851-121">Создаваемые атрибуты имеют **рекламу \_ системфлаг \_ attr \_ \_** (0x00000004) в свойстве **systemFlags** в своих объектах **attributeSchema** .</span><span class="sxs-lookup"><span data-stu-id="d7851-121">Attributes that are constructed have **ADS\_SYSTEMFLAG\_ATTR\_IS\_CONSTRUCTED** (0x00000004) in the **systemFlags** property on their **attributeSchema** objects.</span></span>

> [!Note]  
> <span data-ttu-id="d7851-122">Дополнительные сведения о предопределенных классах и атрибутах, входящих в систему, см. в разделе [Справочник по службам домен Active Directory](active-directory-domain-services-reference.md).</span><span class="sxs-lookup"><span data-stu-id="d7851-122">For more information about predefined classes and attributes included with the system, see [Active Directory Domain Services Reference](active-directory-domain-services-reference.md).</span></span> <span data-ttu-id="d7851-123">На этих страницах перечислены обязательные и необязательные атрибуты каждого класса объектов.</span><span class="sxs-lookup"><span data-stu-id="d7851-123">These pages list mandatory and optional attributes of each object class.</span></span> <span data-ttu-id="d7851-124">Для атрибутов эталонная страница указывает, является ли атрибут индексированным, сконструированным, связанным или в глобальном каталоге.</span><span class="sxs-lookup"><span data-stu-id="d7851-124">For attributes, the reference page indicates whether the attribute is indexed, constructed, linked, or in the global catalog.</span></span>

 

 

 