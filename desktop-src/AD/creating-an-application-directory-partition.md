---
title: Создание раздела каталога приложений
description: Раздел каталога приложений представляется объектом Домаинднс с атрибутом instanceType, равным DS \_ instanceType \_ — \_ NC \_ head в сочетании с DS \_ instanceType \_ NC \_ является \_ записываемым.
ms.assetid: 5e90f316-9d67-484d-98b8-0632dd3c2c43
ms.tgt_platform: multiple
keywords:
- Создание раздела каталога приложений (AD)
- Разделы каталога приложений AD, создание
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9a17471696825179b6e49230b5168abbaf88b8e2
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104487473"
---
# <a name="creating-an-application-directory-partition"></a><span data-ttu-id="5f150-105">Создание раздела каталога приложений</span><span class="sxs-lookup"><span data-stu-id="5f150-105">Creating an Application Directory Partition</span></span>

<span data-ttu-id="5f150-106">Раздел каталога приложений представляется объектом [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) с атрибутом [**instanceType**](/windows/desktop/ADSchema/a-instancetype) , равным **DS \_ instanceType \_ — \_ NC \_ head** в сочетании с **DS \_ instanceType \_ NC \_ является \_ записываемым**.</span><span class="sxs-lookup"><span data-stu-id="5f150-106">An application directory partition is represented by a [**domainDNS**](/windows/desktop/ADSchema/c-domaindns) object with an [**instanceType**](/windows/desktop/ADSchema/a-instancetype) attribute value of **DS\_INSTANCETYPE\_IS\_NC\_HEAD** combined with **DS\_INSTANCETYPE\_NC\_IS\_WRITEABLE**.</span></span> <span data-ttu-id="5f150-107">Этот объект **домаинднс** представляет корень раздела каталога приложений (заголовок NC) и имеет имя, аналогичное обычному разделу домена, например "DC = DYNAMICDATA, DC = Fabrikam, DC = com", который соответствует DNS-имени "DynamicData.fabrikam.com".</span><span class="sxs-lookup"><span data-stu-id="5f150-107">This **domainDNS** object represents the application directory partition root (NC head), and is named similar to a regular domain partition, for example, "DC=dynamicdata,DC=fabrikam,DC=com", which corresponds to a DNS name of "dynamicdata.fabrikam.com".</span></span> <span data-ttu-id="5f150-108">Таким образом, можно создать экземпляр раздела каталога приложений в любом месте, где можно создать экземпляр раздела домена.</span><span class="sxs-lookup"><span data-stu-id="5f150-108">An application directory partition can, therefore, be instantiated anywhere a domain partition can be instantiated.</span></span> <span data-ttu-id="5f150-109">Отсутствует имя NetBIOS, связанное с разделом каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-109">There is no NetBIOS name associated with an application directory partition.</span></span>

<span data-ttu-id="5f150-110">Можно вкладывать разделы каталога приложений, т. е. раздел каталога приложений может иметь дочерние разделы каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-110">It is possible to nest application directory partitions, that is, an application directory partition can have child application directory partitions.</span></span> <span data-ttu-id="5f150-111">Поиск с областью поддерева с корнем в заголовке раздела каталога приложений приведет к созданию ссылок продолжения для разделов каталога дочерних приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-111">Searches with subtree scope rooted at an application directory partition head will generate continuation references to the child application directory partitions.</span></span>

<span data-ttu-id="5f150-112">Реплику раздела каталога приложений можно создать только на контроллере домена, работающем под управлением Windows Server 2003 и более поздних версий, и только в то время, когда роль FSMO Domain-Naming удерживается контроллером домена Windows Server 2003 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="5f150-112">An application directory partition replica can only be created on a domain controller that is running on Windows Server 2003 and later and only while the Domain-Naming FSMO role is held by a Windows Server 2003 and later domain controller.</span></span> <span data-ttu-id="5f150-113">В смешанном лесу, в котором есть контроллеры домена Windows Server 2003 и контроллеры домена нижнего уровня (контроллеры домена Windows 2000 или основные контроллеры домена Windows NT 4,0), попытка создать реплику раздела каталога приложений на контроллере домена нижнего уровня завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="5f150-113">In a mixed forest that has both Windows Server 2003 domain controllers and down-level domain controllers (Windows 2000 domain controllers or Windows NT 4.0 primary domain controllers), an attempt to create an application directory partition replica on a down-level domain controller will fail.</span></span>

<span data-ttu-id="5f150-114">Раздел каталога приложений также имеет соответствующий объект [**crossRef**](/windows/desktop/ADSchema/c-crossref) в контейнере разделов раздела конфигурации.</span><span class="sxs-lookup"><span data-stu-id="5f150-114">An application directory partition also has a corresponding [**crossRef**](/windows/desktop/ADSchema/c-crossref) object in the Partitions container of the configuration partition.</span></span> <span data-ttu-id="5f150-115">Перед созданием объекта [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) можно создать предварительно созданный параметр **crossRef** вручную.</span><span class="sxs-lookup"><span data-stu-id="5f150-115">The **crossRef** can be pre-created manually before creating the [**domainDNS**](/windows/desktop/ADSchema/c-domaindns) object.</span></span> <span data-ttu-id="5f150-116">Предварительно созданный объект **crossRef** должен иметь значения атрибутов, приведенные в следующей таблице, иначе создание секции завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="5f150-116">The pre-created **crossRef** object must have the attribute values shown in the following table or the partition creation will fail.</span></span> <span data-ttu-id="5f150-117">Если объект **crossRef** не существует, сервер Active Directory создаст его при создании раздела каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-117">If the **crossRef** object does not exist, the Active Directory server will create one when the application directory partition is created.</span></span>

| <span data-ttu-id="5f150-118">attribute</span><span class="sxs-lookup"><span data-stu-id="5f150-118">Attribute</span></span>                          | <span data-ttu-id="5f150-119">Описание</span><span class="sxs-lookup"><span data-stu-id="5f150-119">Description</span></span>                                                                                                                               |
|------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5f150-120">**днсрут**</span><span class="sxs-lookup"><span data-stu-id="5f150-120">**dnsRoot**</span></span>](/windows/desktop/ADSchema/a-dnsroot) | <span data-ttu-id="5f150-121">Содержит путь DNS контроллера домена, на котором будет создан раздел каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-121">Contains the DNS path of the domain controller that the application directory partition will be created on.</span></span>                               |
| [<span data-ttu-id="5f150-122">**Активировано**</span><span class="sxs-lookup"><span data-stu-id="5f150-122">**Enabled**</span></span>](/windows/desktop/ADSchema/a-enabled) | <span data-ttu-id="5f150-123">Содержит **значение false**.</span><span class="sxs-lookup"><span data-stu-id="5f150-123">Contains **FALSE**.</span></span>                                                                                                                       |
| [<span data-ttu-id="5f150-124">**Параметрами**</span><span class="sxs-lookup"><span data-stu-id="5f150-124">**nCName**</span></span>](/windows/desktop/ADSchema/a-ncname)   | <span data-ttu-id="5f150-125">Содержит различающееся имя секции.</span><span class="sxs-lookup"><span data-stu-id="5f150-125">Contains the distinguished name of the partition.</span></span> <span data-ttu-id="5f150-126">В приведенном выше примере этот атрибут будет содержать "DC = DynamicData, DC = MyDomain, DC = com".</span><span class="sxs-lookup"><span data-stu-id="5f150-126">In the example above, this attribute would contain "DC=dynamicdata,DC=mydomain,DC=com".</span></span> |



 

<span data-ttu-id="5f150-127">**Чтобы создать новый раздел каталога приложений с первой репликой, выполните следующие действия.**</span><span class="sxs-lookup"><span data-stu-id="5f150-127">**To create a new application directory partition with its first replica, perform the following steps**</span></span>

1.  <span data-ttu-id="5f150-128">Выполните привязку к пространству имен для новой секции, указав контроллер домена, на котором будет размещаться раздел каталога приложений в папке ADsPath.</span><span class="sxs-lookup"><span data-stu-id="5f150-128">Bind to the namespace for the new partition, specifying the domain controller that will host the application directory partition in the ADsPath.</span></span> <span data-ttu-id="5f150-129">Например, чтобы создать секцию с параметром ADsPath "DC = DynamicData, DC = MyDomain, DC = com", значение ADsPath — "LDAP:// <domain controller> /DC = MyDomain, DC = com", где " &lt; контроллер домена &gt; " — это DNS-имя контроллера домена, на котором будет размещена секция.</span><span class="sxs-lookup"><span data-stu-id="5f150-129">For example, to create a partition with an ADsPath of "DC=dynamicdata,DC=mydomain,DC=com", the binding ADsPath would be "LDAP://<domain controller>/DC=mydomain,DC=com", where "&lt;domain controller&gt;" is the DNS name of the domain controller that will host the partition.</span></span>

    <span data-ttu-id="5f150-130">Операция привязки должна указывать параметры быстрого и делегирования.</span><span class="sxs-lookup"><span data-stu-id="5f150-130">The bind operation must specify the fast and delegation options.</span></span> <span data-ttu-id="5f150-131">Быстрый параметр позволяет выполнить привязку, даже если пространство имен не существует.</span><span class="sxs-lookup"><span data-stu-id="5f150-131">The fast option allows the bind to succeed even if the namespace does not exist.</span></span> <span data-ttu-id="5f150-132">Параметр делегирования необходим, чтобы разрешить контроллеру домена обращаться к владельцу роли FSMO Domain-Naming, используя те же учетные данные.</span><span class="sxs-lookup"><span data-stu-id="5f150-132">The delegation option is required to allow the domain controller to contact the Domain-Naming FSMO role holder using the same credentials.</span></span>

    <span data-ttu-id="5f150-133">Системная версия контроллера домена должна быть операционной системой Windows Server 2003 и более поздними версиями.</span><span class="sxs-lookup"><span data-stu-id="5f150-133">The system version of the domain controller must be Windows Server 2003 operating system and later.</span></span>

2.  <span data-ttu-id="5f150-134">Создайте объект [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) с соответствующим именем для секции, например "DC = DynamicData", чтобы представить заголовок контекста именования для новой секции.</span><span class="sxs-lookup"><span data-stu-id="5f150-134">Create a [**domainDNS**](/windows/desktop/ADSchema/c-domaindns) object with an appropriate name for the partition, for example, "DC=dynamicdata", to represent the naming context head for the new partition.</span></span> <span data-ttu-id="5f150-135">Объект **домаинднс** должен иметь атрибут [**instanceType**](/windows/desktop/ADSchema/a-instancetype) со значением 5 (**DS \_ instanceType \_ — \_ NC \_ head** \| **DS \_ instanceType \_ NC \_ , \_ доступный для записи**).</span><span class="sxs-lookup"><span data-stu-id="5f150-135">The **domainDNS** object must have an [**instanceType**](/windows/desktop/ADSchema/a-instancetype) attribute with a value of 5 (**DS\_INSTANCETYPE\_IS\_NC\_HEAD** \| **DS\_INSTANCETYPE\_NC\_IS\_WRITEABLE**).</span></span> <span data-ttu-id="5f150-136">Атрибут **instanceType** может быть задан только во время создания, так как он является системным атрибутом.</span><span class="sxs-lookup"><span data-stu-id="5f150-136">The **instanceType** attribute can only be set at creation time because it is a system-only attribute.</span></span>

<span data-ttu-id="5f150-137">При создании объекта [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) сервер Active Directory выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="5f150-137">When the [**domainDNS**](/windows/desktop/ADSchema/c-domaindns) object is created, the Active Directory server will perform the following steps:</span></span>

1.  <span data-ttu-id="5f150-138">Выполняет поиск объекта [**crossRef**](/windows/desktop/ADSchema/c-crossref) в контейнере partitions, имеющего значение атрибута [**NCName**](/windows/desktop/ADSchema/a-ncname) , совпадающее с различающимся именем секции, а при обнаружении совпадения изменяет объект **crossRef** для представления раздела каталога приложения.</span><span class="sxs-lookup"><span data-stu-id="5f150-138">Searches for a [**crossRef**](/windows/desktop/ADSchema/c-crossref) object in the Partitions container that has an [**nCName**](/windows/desktop/ADSchema/a-ncname) attribute value that matches the distinguished name of the partition and, if a match is found, modifies the **crossRef** object to represent the application directory partition.</span></span> <span data-ttu-id="5f150-139">Если соответствующий объект **crossRef** не найден, сервер Active Directory создает новый объект **crossRef** для представления раздела каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-139">If a matching **crossRef** object is not found, the Active Directory server creates a new **crossRef** object to represent the application directory partition.</span></span>

    <span data-ttu-id="5f150-140">В следующей таблице перечислены важные атрибуты объекта [**crossRef**](/windows/desktop/ADSchema/c-crossref) .</span><span class="sxs-lookup"><span data-stu-id="5f150-140">The following table lists important attributes of the [**crossRef**](/windows/desktop/ADSchema/c-crossref) object.</span></span>

    | <span data-ttu-id="5f150-141">attribute</span><span class="sxs-lookup"><span data-stu-id="5f150-141">Attribute</span></span>                                                              | <span data-ttu-id="5f150-142">Описание</span><span class="sxs-lookup"><span data-stu-id="5f150-142">Description</span></span>                                                                                                                                        |
    |------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
    | [<span data-ttu-id="5f150-143">**Параметрами**</span><span class="sxs-lookup"><span data-stu-id="5f150-143">**nCName**</span></span>](/windows/desktop/ADSchema/a-ncname)                                       | <span data-ttu-id="5f150-144">Содержит различающееся имя секции.</span><span class="sxs-lookup"><span data-stu-id="5f150-144">Contains the distinguished name of the partition.</span></span>                                                                                                  |
    | [<span data-ttu-id="5f150-145">**днсрут**</span><span class="sxs-lookup"><span data-stu-id="5f150-145">**dnsRoot**</span></span>](/windows/desktop/ADSchema/a-dnsroot)                                     | <span data-ttu-id="5f150-146">Содержит DNS-имя секции.</span><span class="sxs-lookup"><span data-stu-id="5f150-146">Contains the DNS name of the partition.</span></span>                                                                                                            |
    | [<span data-ttu-id="5f150-147">**msDS-NC-Replica-Locations**</span><span class="sxs-lookup"><span data-stu-id="5f150-147">**msDS-NC-Replica-Locations**</span></span>](/windows/desktop/ADSchema/a-msds-nc-replica-locations) | <span data-ttu-id="5f150-148">Различающееся имя объекта [**нтдсдса**](/windows/desktop/ADSchema/c-ntdsdsa) контроллера домена для первой реплики добавляется к этому атрибуту.</span><span class="sxs-lookup"><span data-stu-id="5f150-148">The distinguished name of the [**nTDSDSA**](/windows/desktop/ADSchema/c-ntdsdsa) object of the domain controller for the first replica is added to this attribute.</span></span> |

    

     

2.  <span data-ttu-id="5f150-149">Запустите синхронизацию секции конфигурации и дождитесь завершения.</span><span class="sxs-lookup"><span data-stu-id="5f150-149">Initiate a synchronization of the configuration partition and wait for completion.</span></span> <span data-ttu-id="5f150-150">Это позволяет клиентскому приложению изменять параметры конфигурации для вновь созданного раздела каталога приложений, применяя тот же контроллер домена, который используется для создания раздела каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-150">This enables the client application to modify configuration parameters for the newly created application directory partition while bound to the same domain controller used for creating the application directory partition.</span></span>
3.  <span data-ttu-id="5f150-151">Создайте объект [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) с **\_ INSTANCETYPE DS \_ — \_ \_ head NC** , а **DS \_ INSTANCETYPE \_ NC \_ — это \_** флаги записи, заданные для свойства [**INSTANCETYPE**](/windows/desktop/ADSchema/a-instancetype) .</span><span class="sxs-lookup"><span data-stu-id="5f150-151">Create the [**domainDNS**](/windows/desktop/ADSchema/c-domaindns) object with the **DS\_INSTANCETYPE\_IS\_NC\_HEAD** and **DS\_INSTANCETYPE\_NC\_IS\_WRITEABLE** flags set on the [**instanceType**](/windows/desktop/ADSchema/a-instancetype) property.</span></span> <span data-ttu-id="5f150-152">Свойство **instanceType** может также содержать другие, закрытые флаги.</span><span class="sxs-lookup"><span data-stu-id="5f150-152">The **instanceType** property may contain other, private flags as well.</span></span>
4.  <span data-ttu-id="5f150-153">Заполните атрибут [**MS-DS-с-Master-NC**](/windows/desktop/ADSchema/a-msds-hasmasterncs) объекта [**нтдсдса**](/windows/desktop/ADSchema/c-ntdsdsa) для целевого контроллера домена с различающимся именем только что созданного раздела каталога приложений.</span><span class="sxs-lookup"><span data-stu-id="5f150-153">Populate the [**ms-DS-Has-Master-NCs**](/windows/desktop/ADSchema/a-msds-hasmasterncs) attribute of the [**nTDSDSA**](/windows/desktop/ADSchema/c-ntdsdsa) object for the target domain controller with the distinguished name of the newly created application directory partition.</span></span>

<span data-ttu-id="5f150-154">При создании раздела каталога приложений или добавлении и полной синхронизации новой реплики раздела каталога приложений Active Directory сервер правильно регистрирует реплику с помощью NetLogon и DNS.</span><span class="sxs-lookup"><span data-stu-id="5f150-154">When the application directory partition is created, or when a new replica of the application directory partition is added and fully synchronized, the Active Directory server correctly registers the replica with NetLogon and DNS.</span></span> <span data-ttu-id="5f150-155">Дополнительные сведения и список зарегистрированных записей SRV см. в разделе [Поиск сервера узла раздела каталога приложений](locating-an-application-directory-partition-host-server.md).</span><span class="sxs-lookup"><span data-stu-id="5f150-155">For more information, and a list of the registered SRV records, see [Locating an Application Directory Partition Host Server](locating-an-application-directory-partition-host-server.md).</span></span>

<span data-ttu-id="5f150-156">Дополнительные сведения о создании раздела каталога приложений см. в разделе [пример кода для создания раздела каталога приложений](example-code-for-creating-an-application-directory-partition.md).</span><span class="sxs-lookup"><span data-stu-id="5f150-156">For more information about creating an application directory partition, see [Example Code for Creating an Application Directory Partition](example-code-for-creating-an-application-directory-partition.md).</span></span>

## <a name="locating-the-partitions-container"></a><span data-ttu-id="5f150-157">Поиск контейнера секций</span><span class="sxs-lookup"><span data-stu-id="5f150-157">Locating the Partitions Container</span></span>

<span data-ttu-id="5f150-158">Различающееся имя контейнера секций можно найти одним из двух способов.</span><span class="sxs-lookup"><span data-stu-id="5f150-158">The distinguished name of the Partitions container can be found in one of two ways.</span></span> <span data-ttu-id="5f150-159">Первый из них более сложен, но всегда дает точный результат:</span><span class="sxs-lookup"><span data-stu-id="5f150-159">The first is more complicated to perform, but will always provide an accurate result:</span></span>

1.  <span data-ttu-id="5f150-160">Привяжите к RootDSE и получите атрибут **конфигуратионнамингконтекст** .</span><span class="sxs-lookup"><span data-stu-id="5f150-160">Bind to RootDSE and obtain the **configurationNamingContext** attribute.</span></span>
2.  <span data-ttu-id="5f150-161">Используйте атрибут **конфигуратионнамингконтекст** для привязки к контейнеру конфигурации.</span><span class="sxs-lookup"><span data-stu-id="5f150-161">Use the **configurationNamingContext** attribute to bind to the configuration container.</span></span>
3.  <span data-ttu-id="5f150-162">Найдите в контейнере конфигурации объект, имеющий тип [**кроссрефконтаинер**](/windows/desktop/ADSchema/c-crossrefcontainer) .</span><span class="sxs-lookup"><span data-stu-id="5f150-162">Search in the configuration container for an object that is of the [**crossRefContainer**](/windows/desktop/ADSchema/c-crossrefcontainer) type.</span></span>
4.  <span data-ttu-id="5f150-163">Получите значение атрибута **distinguishedName** объекта [**кроссрефконтаинер**](/windows/desktop/ADSchema/c-crossrefcontainer) .</span><span class="sxs-lookup"><span data-stu-id="5f150-163">Obtain the **distinguishedName** attribute value of the [**crossRefContainer**](/windows/desktop/ADSchema/c-crossrefcontainer) object.</span></span> <span data-ttu-id="5f150-164">Это будет различающееся имя контейнера секций.</span><span class="sxs-lookup"><span data-stu-id="5f150-164">This will be the distinguished name of the Partitions container.</span></span>

<span data-ttu-id="5f150-165">Дополнительные сведения и пример кода, демонстрирующий этот метод для поиска контейнера секций, см. в описании функции **жетпартитионсднсеарч** в [примере кода для поиска контейнера секций](example-code-for-locating-the-partitions-container.md).</span><span class="sxs-lookup"><span data-stu-id="5f150-165">For more information and a code example that shows this method for locating the Partitions container, see the **GetPartitionsDNSearch** function in [Example Code for Locating the Partitions Container](example-code-for-locating-the-partitions-container.md).</span></span>

<span data-ttu-id="5f150-166">Второй метод проще реализовать, но использует контейнер секций с определенным относительном различающимся именем.</span><span class="sxs-lookup"><span data-stu-id="5f150-166">The second method is easier to implement, but relies on the Partitions container having a particular relative distinguished name.</span></span> <span data-ttu-id="5f150-167">Сейчас невозможно изменить имя контейнера секций, но если эта возможность будет добавлена в будущем, приведенная ниже процедура не будет работать правильно, если контейнер секций был переименован.</span><span class="sxs-lookup"><span data-stu-id="5f150-167">It is not currently possible to change the name of the Partitions container, but if this capability is added in the future, the procedure below will not work correctly if the Partitions container has been renamed.</span></span>

1.  <span data-ttu-id="5f150-168">Привяжите к RootDSE и получите атрибут **конфигуратионнамингконтекст** .</span><span class="sxs-lookup"><span data-stu-id="5f150-168">Bind to RootDSE and obtain the **configurationNamingContext** attribute.</span></span>
2.  <span data-ttu-id="5f150-169">Объедините строку "CN = Partitions", за которой следует атрибут **конфигуратионнамингконтекст** , чтобы сформировать различающееся имя контейнера секций.</span><span class="sxs-lookup"><span data-stu-id="5f150-169">Combine the string "CN=Partitions," followed by the **configurationNamingContext** attribute to form the distinguished name of the Partitions container.</span></span> <span data-ttu-id="5f150-170">Различающееся имя будет иметь вид "CN = Partitions <configuration DN> ".</span><span class="sxs-lookup"><span data-stu-id="5f150-170">The distinguished name will be in the form "CN=Partitions,<configuration DN>".</span></span>

<span data-ttu-id="5f150-171">Дополнительные сведения и пример кода, демонстрирующий этот метод для поиска контейнера секций, см. в описании функции **жетпартитионсднмануал** в [примере кода для поиска контейнера секций](example-code-for-locating-the-partitions-container.md).</span><span class="sxs-lookup"><span data-stu-id="5f150-171">For more information and a code example that shows this method for locating the Partitions container, see the **GetPartitionsDNManual** function in [Example Code for Locating the Partitions Container](example-code-for-locating-the-partitions-container.md).</span></span>

 

 