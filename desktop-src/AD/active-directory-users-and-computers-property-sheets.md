---
title: Вкладки свойств «пользователи и компьютеры Active Directory»
description: Оснастка MMC "Active Directory пользователи и компьютеры" предназначена для вывода страницы свойств для различных объектов на сервере Active Directory.
ms.assetid: 38032d89-9549-475c-90aa-dac5cfe11084
ms.tgt_platform: multiple
keywords:
- Active Directory страниц свойств пользователей и компьютеров Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea24f34e86f21af178e975852accb667bb69e4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789649"
---
# <a name="active-directory-users-and-computers-property-sheets"></a><span data-ttu-id="7fd17-104">Вкладки свойств «пользователи и компьютеры Active Directory»</span><span class="sxs-lookup"><span data-stu-id="7fd17-104">Active Directory Users and Computers Property Sheets</span></span>

<span data-ttu-id="7fd17-105">Оснастка MMC "Active Directory пользователи и компьютеры" предназначена для вывода страницы свойств для различных объектов на сервере Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7fd17-105">The Active Directory Users and Computers MMC snap-in is designed to display a property sheet for various objects in an Active Directory server.</span></span> <span data-ttu-id="7fd17-106">Страница свойств содержит одну или несколько страниц, используемых для просмотра и изменения данных объекта.</span><span class="sxs-lookup"><span data-stu-id="7fd17-106">The property sheet contains one or more pages that are used to view and modify object data.</span></span> <span data-ttu-id="7fd17-107">Для разных типов объектов отображаются разные наборы страниц.</span><span class="sxs-lookup"><span data-stu-id="7fd17-107">Different object types have different sets of pages displayed for them.</span></span> <span data-ttu-id="7fd17-108">Оснастка MMC "Active Directory пользователи и компьютеры" также позволяет сторонним поставщикам добавлять пользовательские страницы в страницу свойств для определенного типа объектов.</span><span class="sxs-lookup"><span data-stu-id="7fd17-108">The Active Directory Users and Computers MMC snap-in also enables third party vendors to add custom pages to the property sheet for a specific type of object.</span></span> <span data-ttu-id="7fd17-109">Дополнительные сведения см. в разделе [страницы свойств для использования с описателями экрана](property-pages-for-use-with-display-specifiers.md).</span><span class="sxs-lookup"><span data-stu-id="7fd17-109">For more information, see [Property Pages for Use with Display Specifiers](property-pages-for-use-with-display-specifiers.md).</span></span>

<span data-ttu-id="7fd17-110">Некоторые приложения, кроме оснастки MMC "Active Directory пользователи и компьютеры", должны предоставить пользователю возможность просматривать и изменять атрибуты объекта на сервере Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7fd17-110">Some applications, other than the Active Directory Users and Computers MMC snap-in, must provide the user with the ability view and edit attributes for an object in an Active Directory server.</span></span> <span data-ttu-id="7fd17-111">Приложение может реализовать собственные страницы свойств, но лучше предложить согласованный пользовательский интерфейс для сокращения времени путаницы и обучения.</span><span class="sxs-lookup"><span data-stu-id="7fd17-111">The application could implement its own property sheets, but it is better to offer a consistent user interface to reduce confusion and learning time.</span></span> <span data-ttu-id="7fd17-112">К счастью, оснастка MMC "Active Directory пользователи и компьютеры" позволяет любому приложению OLE COM отображать страницу свойств для объекта, идентичного на странице свойств, которая будет отображаться оснасткой консоли управления Active Directory пользователи и компьютеры для одного и того же объекта.</span><span class="sxs-lookup"><span data-stu-id="7fd17-112">Fortunately, the Active Directory Users and Computers MMC snap-in allows any OLE COM application to display a property sheet for an object that is identical to the property sheet that would be displayed by the Active Directory Users and Computers MMC snap-in for the same object.</span></span>

<span data-ttu-id="7fd17-113">Дополнительные сведения и пример кода, в котором размещена страница свойств Active Directory Users and Computers, см. в образце Пропшисост в пакете SDK для платформы.</span><span class="sxs-lookup"><span data-stu-id="7fd17-113">For more information and a code example that hosts an Active Directory Users and Computers property sheet, see the PropSheetHost sample in the Platform Software Development Kit (SDK).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="7fd17-114">Аудитория разработчиков</span><span class="sxs-lookup"><span data-stu-id="7fd17-114">Developer Audience</span></span>

<span data-ttu-id="7fd17-115">В этой документации предполагается, что читатель знаком с разработкой COM-операций и компонентов с помощью C++.</span><span class="sxs-lookup"><span data-stu-id="7fd17-115">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="7fd17-116">В настоящее время невозможно создать Active Directory расширение вкладки свойств с помощью Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="7fd17-116">Currently, it is not possible to create an Active Directory property sheet extension using Visual Basic.</span></span>

## <a name="hosting-an-active-directory-users-and-computers-property-sheet"></a><span data-ttu-id="7fd17-117">Размещение страницы свойств "пользователи и компьютеры" Active Directory</span><span class="sxs-lookup"><span data-stu-id="7fd17-117">Hosting an Active Directory Users and Computers Property Sheet</span></span>

<span data-ttu-id="7fd17-118">**Отображение страницы свойств объекта на сервере Active Directory**</span><span class="sxs-lookup"><span data-stu-id="7fd17-118">**To display a property sheet for an object in an Active Directory server**</span></span>

1.  <span data-ttu-id="7fd17-119">Создайте окно, которое может использоваться для обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="7fd17-119">Create a window that can be used to process messages.</span></span> <span data-ttu-id="7fd17-120">Это может быть существующее окно или специальное окно специального назначения.</span><span class="sxs-lookup"><span data-stu-id="7fd17-120">This can be an existing window or a special purpose window.</span></span> <span data-ttu-id="7fd17-121">Это называется *скрытым окном*.</span><span class="sxs-lookup"><span data-stu-id="7fd17-121">This is known as the *hidden window*.</span></span>
2.  <span data-ttu-id="7fd17-122">Создайте объект OLE COM, производный от [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span><span class="sxs-lookup"><span data-stu-id="7fd17-122">Create an OLE COM object that is derived from [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span></span> <span data-ttu-id="7fd17-123">Этот объект данных должен поддерживать следующие форматы данных:</span><span class="sxs-lookup"><span data-stu-id="7fd17-123">This data object must support the following data formats:</span></span>

    -   <span data-ttu-id="7fd17-124">[**Кфстр \_ ДСОБЖЕКТНАМЕС**](cfstr-dsobjectnames.md) . Этот формат данных содержит [**дсобжектнамес**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) , определяющий объект, к которому применяется страница свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-124">[**CFSTR\_DSOBJECTNAMES**](cfstr-dsobjectnames.md) This data format contains a [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) that identifies the object that the property sheet applies to.</span></span> <span data-ttu-id="7fd17-125">При размещении страницы свойств в следующем списке показаны более значимые элементы структуры **дсобжектнамес** .</span><span class="sxs-lookup"><span data-stu-id="7fd17-125">When hosting a property sheet, the more significant members of the **DSOBJECTNAMES** structure are shown in the following list.</span></span>

        <span data-ttu-id="7fd17-126">**клсиднамеспаце** Процессу.</span><span class="sxs-lookup"><span data-stu-id="7fd17-126">**clsidNamespace** Reserved.</span></span> <span data-ttu-id="7fd17-127">Задайте здесь идентификатор GUID приложения, если он используется в будущем.</span><span class="sxs-lookup"><span data-stu-id="7fd17-127">Set this to a GUID for your application here in case that it is used in the future.</span></span>
        
        <span data-ttu-id="7fd17-128">**аобжектс** Содержит массив структур [**дсбожект**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-128">**aObjects** Contains an array of [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structures.</span></span> <span data-ttu-id="7fd17-129">Каждая структура **дсбожект** представляет один объект каталога.</span><span class="sxs-lookup"><span data-stu-id="7fd17-129">Each **DSBOJECT** structure represents a single directory object.</span></span> <span data-ttu-id="7fd17-130">Элемент **Цитемс** содержит количество элементов в массиве.</span><span class="sxs-lookup"><span data-stu-id="7fd17-130">The **cItems** member contains the number of elements in the array.</span></span> <span data-ttu-id="7fd17-131">Используется только первый объект в этом массиве.</span><span class="sxs-lookup"><span data-stu-id="7fd17-131">Only the first object in this array is used.</span></span> <span data-ttu-id="7fd17-132">Другие объекты игнорируются.</span><span class="sxs-lookup"><span data-stu-id="7fd17-132">Other objects are ignored.</span></span>

    -   <span data-ttu-id="7fd17-133">[**Кфстр \_ ДСДИСПЛАЙСПЕКОПТИОНС**](cfstr-ds-display-spec-options.md) этот формат данных содержит структуру [**дсдисплайспекоптионс**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) , содержащую данные, которые будут использоваться страницами свойств, например место загрузки страниц свойств с сервера, используемые учетные данные и т. д.</span><span class="sxs-lookup"><span data-stu-id="7fd17-133">[**CFSTR\_DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) This data format contains a [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) structure that contains data that will be used by the property pages, such as where to load the property pages from, the server and credentials to use, and so on.</span></span> <span data-ttu-id="7fd17-134">Более значимые члены **дсдисплайспекоптионс** показаны в следующем списке.</span><span class="sxs-lookup"><span data-stu-id="7fd17-134">The more significant members of the **DSDISPLAYSPECOPTIONS** are shown in the following list.</span></span>

        <span data-ttu-id="7fd17-135">**оффсетаттрибпрефикс** Строка префикса атрибута определяет место получения списка страниц свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-135">**offsetAttribPrefix** The attribute prefix string determines where the list of property pages is obtained.</span></span> <span data-ttu-id="7fd17-136">Он должен содержать одну из следующих строк.</span><span class="sxs-lookup"><span data-stu-id="7fd17-136">This must contain one of the following strings.</span></span>

        

        | <span data-ttu-id="7fd17-137">Строка префикса атрибута</span><span class="sxs-lookup"><span data-stu-id="7fd17-137">Attribute prefix string</span></span> | <span data-ttu-id="7fd17-138">Описание</span><span class="sxs-lookup"><span data-stu-id="7fd17-138">Description</span></span>                                              |
        |-------------------------|----------------------------------------------------------------------------------------------------------------------|
        | <span data-ttu-id="7fd17-139">группы</span><span class="sxs-lookup"><span data-stu-id="7fd17-139">"admin"</span></span><br/>      | <span data-ttu-id="7fd17-140">Страницы свойств загружаются из атрибута [**админпропертипажес**](/windows/desktop/ADSchema/a-adminpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-140">The property pages are loaded from the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) attribute.</span></span><br/> |
        | <span data-ttu-id="7fd17-141">консоль</span><span class="sxs-lookup"><span data-stu-id="7fd17-141">"shell"</span></span><br/>      | <span data-ttu-id="7fd17-142">Страницы свойств загружаются из атрибута [**шеллпропертипажес**](/windows/desktop/ADSchema/a-shellpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-142">The property pages are loaded from the [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute.</span></span><br/> |

        


    -   <span data-ttu-id="7fd17-143">[**Кфстр \_ DS \_ пропшитконфиг**](cfstr-ds-propsheetconfig.md) . Этот формат данных содержит структуру [**пропшиткфг**](propsheetcfg.md) , содержащую данные узла страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-143">[**CFSTR\_DS\_PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) This data format contains a [**PROPSHEETCFG**](propsheetcfg.md) structure that contains property sheet host data.</span></span> <span data-ttu-id="7fd17-144">При размещении страницы свойств более значимые элементы структуры **пропшиткфг** содержат данные, показанные в следующем списке.</span><span class="sxs-lookup"><span data-stu-id="7fd17-144">When hosting a property sheet, the more significant members of the **PROPSHEETCFG** structure contain the data shown in the following list.</span></span>

        <span data-ttu-id="7fd17-145">**лнотифихандле** Должно быть равно нулю.</span><span class="sxs-lookup"><span data-stu-id="7fd17-145">**lNotifyHandle** Must be zero.</span></span>
        <span data-ttu-id="7fd17-146">**хвндпарентшит**  Содержит маркер окна для получения сообщений [**\_ \_ об \_ изменениях в WM адспроп**](wm-adsprop-notify-change.md) , когда что-либо на одной из страниц изменяется и применяется.</span><span class="sxs-lookup"><span data-stu-id="7fd17-146">**hwndParentSheet**  Contains the handle of the window to receive [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) messages when something in one of the pages changes and is applied.</span></span> <span data-ttu-id="7fd17-147">Может иметь **значение NULL** , если это сообщение не требуется.</span><span class="sxs-lookup"><span data-stu-id="7fd17-147">Can be **NULL** if this message is not desired.</span></span>

        <span data-ttu-id="7fd17-148">**хвндхидден** Содержит маркер окна для получения [**\_ листа WM DSA \_ \_ Создание \_ уведомления**](wm-dsa-sheet-create-notify.md) и сообщения [**\_ \_ \_ \_ о закрытии**](wm-dsa-sheet-close-notify.md) окна.</span><span class="sxs-lookup"><span data-stu-id="7fd17-148">**hwndHidden** Contains the handle of the window to receive [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) and [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) messages.</span></span> <span data-ttu-id="7fd17-149">Задайте для него маркер скрытого окна.</span><span class="sxs-lookup"><span data-stu-id="7fd17-149">Set this to the handle of your hidden window.</span></span>

        <span data-ttu-id="7fd17-150">**впарамшитклосе** Содержит определяемый приложением идентификатор, возвращаемый в параметре *wParam* в сообщении [**\_ \_ \_ о закрытии \_ уведомления на листе WM DSA**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-150">**wParamSheetClose** Contains an application-defined identifier that is returned in the *wParam* in the [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="7fd17-151">Если этот член равен нулю, то в скрытом окне не будет отправлено сообщение об ошибке **\_ \_ \_ \_ закрытия листа WM DSA** .</span><span class="sxs-lookup"><span data-stu-id="7fd17-151">If this member is zero, the **WM\_DSA\_SHEET\_CLOSE\_NOTIFY** message will not be posted to the hidden window.</span></span>


3.  <span data-ttu-id="7fd17-152">Создайте экземпляр объекта [**\_ дспропертипажес CLSID**](guids-of-user-interface-elements.md) и получите интерфейс [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) для объекта.</span><span class="sxs-lookup"><span data-stu-id="7fd17-152">Create an instance of the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and obtain the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface for the object.</span></span> <span data-ttu-id="7fd17-153">Также можно дублировать поведение объекта **\_ дспропертипажес CLSID** .</span><span class="sxs-lookup"><span data-stu-id="7fd17-153">It is also possible to duplicate the behavior of the **CLSID\_DsPropertyPages** object.</span></span> <span data-ttu-id="7fd17-154">Дополнительные сведения см. в разделе дублирование поведения \_ объекта ДСПРОПЕРТИПАЖЕС CLSID.</span><span class="sxs-lookup"><span data-stu-id="7fd17-154">For more information, see Duplicating the Behavior of the CLSID\_DsPropertyPages Object.</span></span>
4.  <span data-ttu-id="7fd17-155">Инициализируйте объект [**CLSID \_ дспропертипажес**](guids-of-user-interface-elements.md) , вызвав метод [**ишеллекстинит:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-155">Initialize the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object by calling the [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method.</span></span> <span data-ttu-id="7fd17-156">Параметры *пидлфолдер* и *хкэйпрогид* не используются в этом методе.</span><span class="sxs-lookup"><span data-stu-id="7fd17-156">The *pidlFolder* and *hkeyProgID* parameters are not used in this method.</span></span> <span data-ttu-id="7fd17-157">Параметр *пдтобж* — это указатель на объект данных, созданный на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="7fd17-157">The *pdtobj* parameter is the pointer to the data object created in Step 2.</span></span> <span data-ttu-id="7fd17-158">При вызове метода **ишеллекстинит:: Initialize** объект **CLSID \_ дспропертипажес** сохранит ссылку на объект данных.</span><span class="sxs-lookup"><span data-stu-id="7fd17-158">When the **IShellExtInit::Initialize** method is called, the **CLSID\_DsPropertyPages** object will save a reference to the data object.</span></span>
5.  <span data-ttu-id="7fd17-159">Получите интерфейс [**ишеллпропшитекст**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) для объекта [**CLSID \_ дспропертипажес**](guids-of-user-interface-elements.md) и вызовите метод [**ишеллпропшитекст:: аддпажес**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-159">Obtain the [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface for the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and call the [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method.</span></span> <span data-ttu-id="7fd17-160">Параметр *лпфнаддпаже* — это адрес функции обратного вызова, которую необходимо реализовать.</span><span class="sxs-lookup"><span data-stu-id="7fd17-160">The *lpfnAddPage* parameter is the address of a callback function that you must implement.</span></span> <span data-ttu-id="7fd17-161">Формат этой функции показан ниже.</span><span class="sxs-lookup"><span data-stu-id="7fd17-161">The format of this function is shown below.</span></span> <span data-ttu-id="7fd17-162">Если функция обратного вызова объявлена как член класса C++, функция обратного вызова должна быть объявлена как **статическая**.</span><span class="sxs-lookup"><span data-stu-id="7fd17-162">If the callback function is declared as a member of a C++ class, the callback function must be declared as **static**.</span></span> <span data-ttu-id="7fd17-163">Параметр *lParam* — это определяемое приложением значение, которое может использоваться для определения объекта, реализующего функцию обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="7fd17-163">The *lParam* parameter is an application-defined value that can be used to identify the object that implements the callback function.</span></span> <span data-ttu-id="7fd17-164">При вызове метода **ишеллпропшитекст:: аддпажес** объект **CLSID \_ дспропертипажес** получит данные из объекта данных и перечислит страницы свойств, зарегистрированные для описателей объекта.</span><span class="sxs-lookup"><span data-stu-id="7fd17-164">When the **IShellPropSheetExt::AddPages** method is called, the **CLSID\_DsPropertyPages** object will obtain the data from the data object and enumerate the property pages registered for the object display specifiers.</span></span> <span data-ttu-id="7fd17-165">Затем **объект \_ дспропертипажес CLSID** перечисляет объекты страницы свойств, вызывая метод **ишеллпропшитекст:: аддпажес** для каждого объекта.</span><span class="sxs-lookup"><span data-stu-id="7fd17-165">The **CLSID\_DsPropertyPages** object will then enumerate the property page objects, calling each object's **IShellPropSheetExt::AddPages** method.</span></span>

    ```C++
    BOOL CALLBACK AddPagesCallback(HPROPSHEETPAGE, LPARAM)
    ```

    

6.  <span data-ttu-id="7fd17-166">Каждая страница, добавленная объектами страницы свойств, приведет к вызову функции обратного вызова с помощью маркера для страницы свойств и значения, определенного приложением.</span><span class="sxs-lookup"><span data-stu-id="7fd17-166">Each page added by the property page objects will result in your callback function being called with the handle to the property page and the application-defined value.</span></span> <span data-ttu-id="7fd17-167">Функция обратного вызова должна хранить каждый передаваемый обработчик страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-167">Your callback function must store each property page handle that is passed.</span></span> <span data-ttu-id="7fd17-168">Когда метод [**ишеллпропшитекст:: аддпажес**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) объекта [**CLSID \_ дспропертипажес**](guids-of-user-interface-elements.md) возвращает, все страницы будут добавлены с помощью функции обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="7fd17-168">When the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method returns, all pages will have been added via your callback function.</span></span>
7.  <span data-ttu-id="7fd17-169">Заполните структуру [**пропшисеадер**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) для вывода страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-169">Fill in a [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) structure to display the property sheet.</span></span> <span data-ttu-id="7fd17-170">Член **фпаже** получает указатель на массив дескрипторов страниц, собранных функцией обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="7fd17-170">The **phpage** member receives a pointer to an array of page handles that were collected by your callback function.</span></span> <span data-ttu-id="7fd17-171">Элемент **нпажес** получает количество страниц в массиве обработчиков страниц.</span><span class="sxs-lookup"><span data-stu-id="7fd17-171">The **nPages** member receives the number of pages in the page handle array.</span></span>
8.  <span data-ttu-id="7fd17-172">Отобразите страницу свойств, вызвав функцию [**Страница свойств**](/windows/win32/api/prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-172">Display the property sheet by calling the [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="7fd17-173">Если данные на любой странице изменяются и нажаты кнопки **ОК** или **Применить** , окно, определяемое элементом **хвндпарентшит** структуры [**пропшиткфг**](propsheetcfg.md) , будет получать сообщение об [**\_ \_ \_ изменении уведомления WM адспроп**](wm-adsprop-notify-change.md) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-173">If the data in any page is changed and the **OK** or **Apply** buttons are clicked, the window identified by the **hwndParentSheet** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) message.</span></span> <span data-ttu-id="7fd17-174">Это сообщение является исключительно уведомлением и не требует каких-либо действий.</span><span class="sxs-lookup"><span data-stu-id="7fd17-174">This message is strictly a notification and requires no specific action.</span></span>

<span data-ttu-id="7fd17-175">Когда страница закрывается, окно, определяемое членом **хвндхидден** структуры [**пропшиткфг**](propsheetcfg.md) , получит сообщение [**\_ \_ \_ о закрытии \_ уведомления для листа WM DSA**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-175">When the page is closed, the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="7fd17-176">Это сообщение является исключительно уведомлением и не требует выполнения каких-либо действий.</span><span class="sxs-lookup"><span data-stu-id="7fd17-176">This message is strictly a notification and requires no specific action to be performed.</span></span>

<span data-ttu-id="7fd17-177">В некоторых случаях для существующих страниц свойств потребуется отобразить вторичную страницу свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-177">In some cases, the existing property sheets will need to display a secondary property sheet.</span></span> <span data-ttu-id="7fd17-178">Например, при отображении страницы свойств для объекта пользователя и выборе **элемента** страница будет отображен список групп, членом которых является пользователь.</span><span class="sxs-lookup"><span data-stu-id="7fd17-178">For example, if you display the property sheet for a user object and select the **Member Of** page, a list of groups that the user is a member of will be displayed.</span></span> <span data-ttu-id="7fd17-179">Если дважды щелкнуть одну из этих групп в списке, отобразится страница свойств этой группы.</span><span class="sxs-lookup"><span data-stu-id="7fd17-179">If you double-click one of these groups in the list, the property sheet for that group will be displayed.</span></span> <span data-ttu-id="7fd17-180">Основная страница свойств не отображает вспомогательный лист сама по себе.</span><span class="sxs-lookup"><span data-stu-id="7fd17-180">The primary property sheet does not display the secondary sheet by itself.</span></span> <span data-ttu-id="7fd17-181">Он запрашивает отображение дополнительного листа на узле, отправив [**лист WM \_ DSA \_ \_ Create \_ уведомление**](wm-dsa-sheet-create-notify.md) в окно, определяемое элементом **хвндхидден** структуры [**пропшиткфг**](propsheetcfg.md) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-181">It requests that the host display the secondary sheet by sending a [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) message to the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure.</span></span> <span data-ttu-id="7fd17-182">Параметр *wParam* сообщения о **\_ \_ \_ создании \_ уведомления для листа WM DSA** — это указатель на структуру [**\_ \_ \_ сведений о странице DSA sec**](dsa-sec-page-info.md) , которая содержит сведения о вторичной вкладке свойств и объекте, который она представляет.</span><span class="sxs-lookup"><span data-stu-id="7fd17-182">The *wParam* of the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message is a pointer to a [**DSA\_SEC\_PAGE\_INFO**](dsa-sec-page-info.md) structure that contains information about the secondary property sheet and the object that it represents.</span></span> <span data-ttu-id="7fd17-183">В ответ на это сообщение узел страницы свойств должен отображать дополнительную страницу свойств точно так же, как показано выше.</span><span class="sxs-lookup"><span data-stu-id="7fd17-183">In response to this message, the property sheet host must display the secondary property sheet in the same manner as shown above.</span></span> <span data-ttu-id="7fd17-184">После обработки сообщения **\_ \_ \_ \_ о создании уведомления на листе WM DSA** получатель сообщения должен освободить структуру **\_ \_ \_ сведений о странице DSA sec** , передав значение *wParam* в функцию [**функции LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-184">After processing the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message, the message receiver must free the **DSA\_SEC\_PAGE\_INFO** structure by passing the *wParam* value to the [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) function.</span></span>

## <a name="duplicating-the-behavior-of-the-clsid_dspropertypages-object"></a><span data-ttu-id="7fd17-185">Дублирование поведения \_ объекта ДСПРОПЕРТИПАЖЕС CLSID</span><span class="sxs-lookup"><span data-stu-id="7fd17-185">Duplicating the Behavior of the CLSID\_DsPropertyPages Object</span></span>

<span data-ttu-id="7fd17-186">**Дублирование поведения \_ объекта ДСПРОПЕРТИПАЖЕС CLSID**</span><span class="sxs-lookup"><span data-stu-id="7fd17-186">**To duplicate the behavior of the CLSID\_DsPropertyPages object**</span></span>

1.  <span data-ttu-id="7fd17-187">Перечислите значения в атрибуте [**админпропертипажес**](/windows/desktop/ADSchema/a-adminpropertypages) или [**шеллпропертипажес**](/windows/desktop/ADSchema/a-shellpropertypages) для описателя вывода класса Object.</span><span class="sxs-lookup"><span data-stu-id="7fd17-187">Enumerate the values in the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) or [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute for the display specifier for the object class.</span></span> <span data-ttu-id="7fd17-188">Каждое значение представляет собой строку, содержащую число, за которым следует запятая, а затем строковое представление идентификатора класса для расширения страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="7fd17-188">Each value is a string that contains a number, followed by a comma, followed by the string representation of the class identifier of the property page extension.</span></span> <span data-ttu-id="7fd17-189">Дополнительные сведения о формате значений описателей, отображаемых на страницах свойств, см. [в разделе Регистрация COM-объекта страницы свойств в описателе экрана](registering-the-property-page-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="7fd17-189">For more information about the format of the property pages display specifier values, see [Registering the Property Page COM Object in a Display Specifier](registering-the-property-page-com-object-in-a-display-specifier.md).</span></span>
2.  <span data-ttu-id="7fd17-190">Преобразуйте каждую строку идентификатора класса в **CLSID** с помощью функции [**клсидфромстринг**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="7fd17-190">Convert each class identifier string into a **CLSID** using the [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>
3.  <span data-ttu-id="7fd17-191">Отсортируйте идентификаторы класса расширения по номеру, который предшествует каждой строке идентификатора класса в значении атрибута.</span><span class="sxs-lookup"><span data-stu-id="7fd17-191">Sort the extension class identifiers by the number that precedes each class identifier string in the attribute value.</span></span> <span data-ttu-id="7fd17-192">Если два числа идентичны, следует сортировать идентификаторы классов в порядке получения значений атрибутов с Active Directory сервера.</span><span class="sxs-lookup"><span data-stu-id="7fd17-192">If two numbers are identical, sort the class identifiers in the order that the attribute values are obtained from the Active Directory server.</span></span>
4.  <span data-ttu-id="7fd17-193">Перечислите идентификаторы классов расширений, создавая экземпляр каждого расширения.</span><span class="sxs-lookup"><span data-stu-id="7fd17-193">Enumerate the extension class identifiers, creating an instance of each extension.</span></span>
5.  <span data-ttu-id="7fd17-194">Для каждого расширения в порядке, указанном выше, вызовите расширение [**ишеллекстинит:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) с теми же сведениями, которые описаны на шаге 4 процедуры размещения страницы свойств Active Directory Users and Computers.</span><span class="sxs-lookup"><span data-stu-id="7fd17-194">For each extension, in the order sorted above, call the extension's [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) with the same information described in Step 4 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>
6.  <span data-ttu-id="7fd17-195">Для каждого расширения в порядке, указанном выше, вызовите расширение [**ишеллпропшитекст:: аддпажес**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) с теми же сведениями, которые описаны на шаге 5 процедуры размещения страницы свойств Active Directory Users and Computers.</span><span class="sxs-lookup"><span data-stu-id="7fd17-195">For each extension, in the order sorted above, call the extension's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) with the same information described in Step 5 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>

<span data-ttu-id="7fd17-196">По возможности используйте объект [**CLSID \_ дспропертипажес**](guids-of-user-interface-elements.md) для создания страниц вместо того, чтобы делать это вручную.</span><span class="sxs-lookup"><span data-stu-id="7fd17-196">If possible, use the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object to create the pages rather than do this manually.</span></span> <span data-ttu-id="7fd17-197">**\_ Дспропертипажес CLSID** оптимизирован и правильно обрабатывает случаи сбоев, например, если для текущего языкового стандарта не доступен спецификатор вывода.</span><span class="sxs-lookup"><span data-stu-id="7fd17-197">The **CLSID\_DsPropertyPages** has been optimized and will correctly handle failure cases, such as when no display specifier is available for the current locale.</span></span> <span data-ttu-id="7fd17-198">Кроме того, объект **CLSID \_ дспропертипажес** может измениться в будущем. Это означает, что страницы свойств могут не совпадать в точности с параметрами, отображаемыми оснасткой консоли управления Active Directory пользователи и компьютеры.</span><span class="sxs-lookup"><span data-stu-id="7fd17-198">Also, the **CLSID\_DsPropertyPages** object may change in the future, which means your property sheets may not exactly match those displayed by the Active Directory Users and Computers MMC snap-in.</span></span>

## <a name="special-programming-elements"></a><span data-ttu-id="7fd17-199">Специальные программные элементы</span><span class="sxs-lookup"><span data-stu-id="7fd17-199">Special Programming Elements</span></span>

<span data-ttu-id="7fd17-200">В настоящее время в опубликованном файле заголовка не определены следующие элементы программирования.</span><span class="sxs-lookup"><span data-stu-id="7fd17-200">Currently, the following programming elements are not defined in a published header file.</span></span> <span data-ttu-id="7fd17-201">Чтобы использовать эти элементы, необходимо определить их самостоятельно в точном формате, показанном на конкретной справочной странице.</span><span class="sxs-lookup"><span data-stu-id="7fd17-201">To use these elements, you must define them yourself in the exact format shown in the particular reference page.</span></span>

-   [<span data-ttu-id="7fd17-202">**\_ПРОПШИТКОНФИГ кфстр DS \_**</span><span class="sxs-lookup"><span data-stu-id="7fd17-202">**CFSTR\_DS\_PROPSHEETCONFIG**</span></span>](cfstr-ds-propsheetconfig.md)
-   [<span data-ttu-id="7fd17-203">**пропшиткфг**</span><span class="sxs-lookup"><span data-stu-id="7fd17-203">**PROPSHEETCFG**</span></span>](propsheetcfg.md)
-   [<span data-ttu-id="7fd17-204">**\_ \_ \_ уведомление о закрытии листа WM DSA \_**</span><span class="sxs-lookup"><span data-stu-id="7fd17-204">**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**</span></span>](wm-dsa-sheet-close-notify.md)
-   [<span data-ttu-id="7fd17-205">**\_ \_ \_ уведомление о создании листа WM DSA \_**</span><span class="sxs-lookup"><span data-stu-id="7fd17-205">**WM\_DSA\_SHEET\_CREATE\_NOTIFY**</span></span>](wm-dsa-sheet-create-notify.md)
-   [<span data-ttu-id="7fd17-206">**\_ \_ сведения о странице DSA sec \_**</span><span class="sxs-lookup"><span data-stu-id="7fd17-206">**DSA\_SEC\_PAGE\_INFO**</span></span>](dsa-sec-page-info.md)

## <a name="example-code"></a><span data-ttu-id="7fd17-207">Пример кода</span><span class="sxs-lookup"><span data-stu-id="7fd17-207">Example Code</span></span>

<span data-ttu-id="7fd17-208">В следующем примере кода C++ показан надежный способ определения этих элементов, которые будут продолжать работать, даже если эти элементы определены в опубликованном файле заголовка в будущем.</span><span class="sxs-lookup"><span data-stu-id="7fd17-208">The following C++ code example shows a safe way to define these elements that will continue to work even if these elements are defined in a published header file in the future.</span></span>


```C++
#ifndef CFSTR_DS_PROPSHEETCONFIG
    #define CFSTR_DS_PROPSHEETCONFIG_W L"DsPropSheetCfgClipFormat"
    #define CFSTR_DS_PROPSHEETCONFIG_A "DsPropSheetCfgClipFormat"

    #ifdef UNICODE
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_W
    #else
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_A
    #endif //UNICODE
#endif //CFSTR_DS_PROPSHEETCONFIG


#ifndef WM_ADSPROP_SHEET_CREATE
    #define WM_ADSPROP_SHEET_CREATE (WM_USER + 1108)
#endif


#ifndef WM_DSA_SHEET_CREATE_NOTIFY
    #define WM_DSA_SHEET_CREATE_NOTIFY (WM_USER + 6)
#endif


#ifndef WM_DSA_SHEET_CLOSE_NOTIFY
    #define WM_DSA_SHEET_CLOSE_NOTIFY (WM_USER + 5) 
#endif


#ifndef DSA_SEC_PAGE_INFO
    typedef struct _DSA_SEC_PAGE_INFO
    {
        HWND    hwndParentSheet;
        DWORD   offsetTitle;
        DSOBJECTNAMES dsObjectNames;
    } DSA_SEC_PAGE_INFO, *PDSA_SEC_PAGE_INFO;
#endif //DSA_SEC_PAGE_INFO

#ifndef PROPSHEETCFG
    typedef struct _PROPSHEETCFG
    {  
        LONG_PTR lNotifyHandle;  
        HWND hwndParentSheet;  
        HWND hwndHidden;  
        WPARAM wParamSheetClose;
    } PROPSHEETCFG, *PPROPSHEETCFG;
#endif //PROPSHEETCFG
```



 

