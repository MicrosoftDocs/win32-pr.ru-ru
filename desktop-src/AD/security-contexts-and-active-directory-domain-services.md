---
title: Контексты безопасности и службы домен Active Directory
description: Когда приложение привязывается к контроллеру домен Active Directory (DC), оно делает это в контексте безопасности субъекта безопасности, который может быть пользователем или сущностью, например компьютером или системной службой.
ms.assetid: 7ad0acbe-f81b-46d6-be87-3526b0bfbd1b
ms.tgt_platform: multiple
keywords:
- Active Directory Active Directory, контексты безопасности
- контексты безопасности Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c337cb05f8158dbb90f231652c42fb10a486aef4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104069746"
---
# <a name="security-contexts-and-active-directory-domain-services"></a><span data-ttu-id="84990-105">Контексты безопасности и службы домен Active Directory</span><span class="sxs-lookup"><span data-stu-id="84990-105">Security Contexts and Active Directory Domain Services</span></span>

<span data-ttu-id="84990-106">Когда приложение привязывается к контроллеру домен Active Directory (DC), оно делает это в контексте безопасности субъекта безопасности, который может быть пользователем или сущностью, например компьютером или системной службой.</span><span class="sxs-lookup"><span data-stu-id="84990-106">When an application binds to an Active Directory Domain Controller (DC), it does so in the security context of a security principal, which can be a user or an entity such as a computer or a system service.</span></span> <span data-ttu-id="84990-107">Контекст безопасности — это учетная запись пользователя, используемая системой для обеспечения безопасности, когда поток пытается получить доступ к защищаемому объекту.</span><span class="sxs-lookup"><span data-stu-id="84990-107">The security context is the user account that the system uses to enforce security when a thread attempts to access a securable object.</span></span> <span data-ttu-id="84990-108">Эти данные включают идентификатор безопасности пользователя (SID), членство в группах и привилегии.</span><span class="sxs-lookup"><span data-stu-id="84990-108">This data includes the user security identifier (SID), group memberships, and privileges.</span></span>

<span data-ttu-id="84990-109">Пользователь устанавливает контекст безопасности, представляя учетные данные для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="84990-109">A user establishes a security context by presenting credentials for authentication.</span></span> <span data-ttu-id="84990-110">Если учетные данные проходят проверку подлинности, система создает маркер доступа, который определяет членство в группах и привилегии, связанные с учетной записью пользователя.</span><span class="sxs-lookup"><span data-stu-id="84990-110">If the credentials are authenticated, the system produces an access token that identifies the group memberships and privileges associated with the user account.</span></span> <span data-ttu-id="84990-111">Система проверяет маркер доступа при попытке доступа к объекту каталога.</span><span class="sxs-lookup"><span data-stu-id="84990-111">The system verifies your access token when you attempt to access a directory object.</span></span> <span data-ttu-id="84990-112">Он сравнивает данные в маркере доступа с учетными записями и группами, которым предоставлен или запрещен доступ дескриптором безопасности объекта.</span><span class="sxs-lookup"><span data-stu-id="84990-112">It compares the data in your access token to the accounts and groups granted or denied access by the object security descriptor.</span></span>

<span data-ttu-id="84990-113">Используйте следующие методы для управления контекстом безопасности, с которым выполняется привязка к Active Directory контроллеру домена:</span><span class="sxs-lookup"><span data-stu-id="84990-113">Use the following methods to control the security context with which you bind to an Active Directory DC:</span></span>

-   <span data-ttu-id="84990-114">Выполните привязку с помощью параметра **\_ безопасной \_ проверки подлинности ADS** с помощью функции [**ADsOpenObject**](/windows/desktop/api/adshlp/nf-adshlp-adsopenobject) или метода [**иадсопендсобжект:: опендсобжект**](/windows/desktop/api/iads/nf-iads-iadsopendsobject-opendsobject) и явно укажите имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="84990-114">Bind using the **ADS\_SECURE\_AUTHENTICATION** option with the [**ADsOpenObject**](/windows/desktop/api/adshlp/nf-adshlp-adsopenobject) function or [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/iads/nf-iads-iadsopendsobject-opendsobject) method and explicitly specify a user name and password.</span></span> <span data-ttu-id="84990-115">Система проверяет подлинность этих учетных данных и создает маркер доступа, который используется для проверки доступа на время этой привязки.</span><span class="sxs-lookup"><span data-stu-id="84990-115">The system authenticates these credentials and generates an access token that it uses for access verification for the duration of that binding.</span></span> <span data-ttu-id="84990-116">Дополнительные сведения см. в разделе [Authenticate to the Speech API](authentication.md) (Аутентификация в API речи).</span><span class="sxs-lookup"><span data-stu-id="84990-116">For more information, see [Authentication](authentication.md).</span></span>
-   <span data-ttu-id="84990-117">Привяжите с помощью параметра **\_ безопасной \_ проверки подлинности ADS** , но без указания учетных данных.</span><span class="sxs-lookup"><span data-stu-id="84990-117">Bind using the **ADS\_SECURE\_AUTHENTICATION** option, but without specifying credentials.</span></span> <span data-ttu-id="84990-118">Если вы не олицетворять пользователя, система использует основной контекст безопасности приложения, то есть контекст безопасности пользователя, запустившего приложение.</span><span class="sxs-lookup"><span data-stu-id="84990-118">If you are not impersonating a user, the system uses the primary security context of your application, that is, the security context of the user who started your application.</span></span> <span data-ttu-id="84990-119">В случае системной службы это контекст безопасности учетной записи службы или учетной записи LocalSystem.</span><span class="sxs-lookup"><span data-stu-id="84990-119">In the case of a system service, this is the security context of the service account or the LocalSystem account.</span></span>
-   <span data-ttu-id="84990-120">Выполните олицетворение пользователя, а затем привяжите его к **\_ безопасной \_ проверке подлинности**, но без указания учетных данных.</span><span class="sxs-lookup"><span data-stu-id="84990-120">Impersonate a user and then bind with **ADS\_SECURE\_AUTHENTICATION**, but without specifying credentials.</span></span> <span data-ttu-id="84990-121">В этом случае система использует контекст безопасности клиента, который является олицетворенным.</span><span class="sxs-lookup"><span data-stu-id="84990-121">In this case, the system uses the security context of the client that is impersonated.</span></span> <span data-ttu-id="84990-122">Дополнительные сведения см. в разделе [олицетворение клиента](/windows/desktop/SecAuthZ/client-impersonation).</span><span class="sxs-lookup"><span data-stu-id="84990-122">For more information, see [Client Impersonation](/windows/desktop/SecAuthZ/client-impersonation).</span></span>
-   <span data-ttu-id="84990-123">Выполните привязку с помощью [**ADsOpenObject**](/windows/desktop/api/adshlp/nf-adshlp-adsopenobject) или [**Иадсопендсобжект:: опендсобжект**](/windows/desktop/api/iads/nf-iads-iadsopendsobject-opendsobject) с параметром **ADS \_ без \_ проверки подлинности** .</span><span class="sxs-lookup"><span data-stu-id="84990-123">Bind using [**ADsOpenObject**](/windows/desktop/api/adshlp/nf-adshlp-adsopenobject) or [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/iads/nf-iads-iadsopendsobject-opendsobject) with the **ADS\_NO\_AUTHENTICATION** option.</span></span> <span data-ttu-id="84990-124">Этот метод выполняет привязку без проверки подлинности и в качестве контекста безопасности получает "все".</span><span class="sxs-lookup"><span data-stu-id="84990-124">This method binds without authentication and results in "Everyone" as the security context.</span></span> <span data-ttu-id="84990-125">Этот параметр поддерживается только поставщиком LDAP.</span><span class="sxs-lookup"><span data-stu-id="84990-125">Only the LDAP provider supports this option.</span></span>

<span data-ttu-id="84990-126">Если возможно, выполните привязку без указания учетных данных.</span><span class="sxs-lookup"><span data-stu-id="84990-126">If possible, bind without specifying credentials.</span></span> <span data-ttu-id="84990-127">То есть используйте контекст безопасности вошедшего в систему пользователя или олицетворенного клиента.</span><span class="sxs-lookup"><span data-stu-id="84990-127">That is, use the security context of the logged-on user or the impersonated client.</span></span> <span data-ttu-id="84990-128">Это позволяет избежать кэширования учетных данных.</span><span class="sxs-lookup"><span data-stu-id="84990-128">This enables you to avoid caching credentials.</span></span> <span data-ttu-id="84990-129">Если необходимо использовать альтернативные учетные данные пользователя, запросите учетные данные, привяжите их к ним, но не кэшировать их.</span><span class="sxs-lookup"><span data-stu-id="84990-129">If you must use alternate user credentials, prompt for the credentials, bind with them, but do not cache them.</span></span> <span data-ttu-id="84990-130">Чтобы использовать один и тот же контекст безопасности в нескольких операциях привязки, можно указать имя пользователя и пароль для первой операции привязки, а затем указать только имя пользователя для выполнения последующих привязок.</span><span class="sxs-lookup"><span data-stu-id="84990-130">To use the same security context in multiple bind operations, you can specify the user name and password for the first bind operation and then specify only the user name to make subsequent binds.</span></span> <span data-ttu-id="84990-131">Дополнительные сведения об использовании этого метода см. в разделе [Проверка подлинности](authentication.md).</span><span class="sxs-lookup"><span data-stu-id="84990-131">For more information about using this technique, see [Authentication](authentication.md).</span></span>

<span data-ttu-id="84990-132">Некоторые контексты безопасности являются более мощными, чем другие.</span><span class="sxs-lookup"><span data-stu-id="84990-132">Some security contexts are more powerful than others.</span></span> <span data-ttu-id="84990-133">Например, учетная запись LocalSystem на контроллере домена имеет полный доступ к службам домен Active Directory, тогда как обычный пользователь имеет ограниченный доступ к некоторым объектам в каталоге.</span><span class="sxs-lookup"><span data-stu-id="84990-133">For example, the LocalSystem account on a domain controller has complete access to Active Directory Domain Services, whereas a typical user has only limited access to a some of the objects in the directory.</span></span> <span data-ttu-id="84990-134">В общем случае приложение не должно работать в мощном контексте безопасности, например LocalSystem, если для выполнения операций достаточно более мощный контекст безопасности.</span><span class="sxs-lookup"><span data-stu-id="84990-134">In general, your application should not run in a powerful security context, such as LocalSystem, when a less powerful security context is sufficient to perform the operations.</span></span> <span data-ttu-id="84990-135">Это означает, что вам может потребоваться разделить приложение на отдельные компоненты, каждый из которых выполняется в контексте безопасности, соответствующем выполняемым операциям.</span><span class="sxs-lookup"><span data-stu-id="84990-135">This means that you may want to divide your application into separate components, each of which runs in a security context appropriate to the operations to perform.</span></span> <span data-ttu-id="84990-136">Например, настройку приложения можно разделить следующим образом:</span><span class="sxs-lookup"><span data-stu-id="84990-136">For example, your application setup can be divided as follows:</span></span>

-   <span data-ttu-id="84990-137">Выполнение изменений схемы и расширений в контексте пользователя, который является членом группы "Администраторы схемы".</span><span class="sxs-lookup"><span data-stu-id="84990-137">Perform schema changes and extensions in the context of a user who is a member of the Schema Administrators group.</span></span>
-   <span data-ttu-id="84990-138">Изменения контейнера конфигурации выполняются в контексте пользователя, который является членом группы администраторов предприятия.</span><span class="sxs-lookup"><span data-stu-id="84990-138">Perform configuration container changes in the context of a user who is a member of the Enterprise Administrators group.</span></span>
-   <span data-ttu-id="84990-139">Выполняйте изменения контейнера домена в контексте пользователя, который является членом группы "Администраторы домена".</span><span class="sxs-lookup"><span data-stu-id="84990-139">Perform domain container changes in the context of a user who is a member of the Domain Administrators group.</span></span>

 

 