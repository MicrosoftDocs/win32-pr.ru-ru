---
title: Отладка расширения Active Directory
description: Вкладки свойств службы каталогов Microsoft Active Directory, контекстного меню и мастера создания объектов, описанные в этом разделе, реализуются как COM-серверы в процессе.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104069790"
---
# <a name="debugging-an-active-directory-extension"></a><span data-ttu-id="28e31-103">Отладка расширения Active Directory</span><span class="sxs-lookup"><span data-stu-id="28e31-103">Debugging an Active Directory Extension</span></span>

<span data-ttu-id="28e31-104">Вкладки свойств службы каталогов Microsoft Active Directory, контекстного меню и мастера создания объектов, описанные в этом разделе, реализуются как COM-серверы в процессе.</span><span class="sxs-lookup"><span data-stu-id="28e31-104">The Microsoft Active Directory directory service property sheet, context menu, and object creation wizard extensions documented in this topic are implemented as COM in-proc servers.</span></span> <span data-ttu-id="28e31-105">Это значит, что каждое расширение является библиотекой DLL, которая выполняется в контексте хост-процесса.</span><span class="sxs-lookup"><span data-stu-id="28e31-105">That is, each extension is a DLL that runs in the context of the host process.</span></span> <span data-ttu-id="28e31-106">Чтобы выполнить отладку расширения, необходимо связать расширение с приложением и запустить приложение в отладчике.</span><span class="sxs-lookup"><span data-stu-id="28e31-106">To debug the extension, it is necessary to associate the extension with an application and run the application in a debugger.</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a><span data-ttu-id="28e31-107">Отладка расширений Active Directory, отображаемых в оболочке Windows</span><span class="sxs-lookup"><span data-stu-id="28e31-107">Debugging Active Directory Extensions Displayed in the Windows Shell</span></span>

<span data-ttu-id="28e31-108">Расширения Active Directory, отображаемые в оболочке Windows, загружаются в контексте процесса Explorer.exe.</span><span class="sxs-lookup"><span data-stu-id="28e31-108">Active Directory extensions displayed in the Windows shell are loaded in the context of the Explorer.exe process.</span></span> <span data-ttu-id="28e31-109">Эти расширения можно отлаживать как стандартное расширение оболочки.</span><span class="sxs-lookup"><span data-stu-id="28e31-109">These extensions can be debugged like a standard shell extension.</span></span> <span data-ttu-id="28e31-110">Дополнительные сведения об отладке расширений оболочки см. [в разделе Отладка с помощью оболочки](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="28e31-110">For more information about debugging shell extensions, see [Debugging with the Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a><span data-ttu-id="28e31-111">Отладка расширений Active Directory, отображаемых в Active Directory MMC Snap-Ins</span><span class="sxs-lookup"><span data-stu-id="28e31-111">Debugging Active Directory Extensions Displayed in the Active Directory MMC Snap-Ins</span></span>

<span data-ttu-id="28e31-112">Расширения Active Directory, отображаемые в оснастке Active Directory администрирования консоли MMC, загружаются в контексте консоли управления (Майкрософт).</span><span class="sxs-lookup"><span data-stu-id="28e31-112">Active Directory extensions displayed in the Active Directory administrative MMC snap-ins are loaded in the context of the Microsoft Management Console.</span></span> <span data-ttu-id="28e31-113">Чтобы выполнить отладку расширения, выполните поиск Mmc.exe в локальной системе и настройте отладчик для использования его в качестве приложения для отладки.</span><span class="sxs-lookup"><span data-stu-id="28e31-113">To debug an extension, locate Mmc.exe on the local system and set the debugger to use this as the application for debugging.</span></span> <span data-ttu-id="28e31-114">В большинстве систем Mmc.exe находится в системном каталоге Windows, например C: \\ WinNT \\ System32.</span><span class="sxs-lookup"><span data-stu-id="28e31-114">On most systems, Mmc.exe is located in the Windows system directory, for example, C:\\WINNT\\System32.</span></span> <span data-ttu-id="28e31-115">В зависимости от отладчика также может быть необязательно задавать DLL расширения для загрузки отладчиком.</span><span class="sxs-lookup"><span data-stu-id="28e31-115">Depending on the debugger, you may or may not have to set the extension DLL to also be loaded by the debugger.</span></span> <span data-ttu-id="28e31-116">Многие отладчики также позволяют подключать отладчик к выполняющемуся процессу MMC.</span><span class="sxs-lookup"><span data-stu-id="28e31-116">Many debuggers also allow you to attach the debugger to a running MMC process.</span></span> <span data-ttu-id="28e31-117">Дополнительные сведения см. в разделе, посвященном пользователю отладчика.</span><span class="sxs-lookup"><span data-stu-id="28e31-117">For more information, see your debugger User's Guide.</span></span>

<span data-ttu-id="28e31-118">Может быть удобно, чтобы MMC автоматически загружала определенную оснастку.</span><span class="sxs-lookup"><span data-stu-id="28e31-118">It can be convenient to have MMC automatically load a specific snap-in.</span></span> <span data-ttu-id="28e31-119">Для этого задайте для аргументов приложения путь и имя файла MSC.</span><span class="sxs-lookup"><span data-stu-id="28e31-119">To do this, set the application arguments to the path and file name of an MSC file.</span></span> <span data-ttu-id="28e31-120">Это может быть либо установленный системой MSC-файл, либо созданный вами.</span><span class="sxs-lookup"><span data-stu-id="28e31-120">This can either be a system-installed MSC file or one you create.</span></span> <span data-ttu-id="28e31-121">Файл MSC можно создать, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28e31-121">An MSC file can be created by following these steps.</span></span>

1.  <span data-ttu-id="28e31-122">Запустите Mmc.exe.</span><span class="sxs-lookup"><span data-stu-id="28e31-122">Run Mmc.exe.</span></span>
2.  <span data-ttu-id="28e31-123">Загрузите нужную оснастку, выбрав **файл**  -  **Добавить или удалить оснастку...** в меню MMC выберите нужную оснастку.</span><span class="sxs-lookup"><span data-stu-id="28e31-123">Load the desired snap-in by selecting **File** - **Add/Remove Snap-in...** in the MMC menu and select the desired snap-in.</span></span>
3.  <span data-ttu-id="28e31-124">Сохраните файл MSC, выбрав **файл**  -  **Сохранить как...** в меню MMC.</span><span class="sxs-lookup"><span data-stu-id="28e31-124">Save the MSC file by selecting **File** - **Save As...** in the MMC menu.</span></span>

<span data-ttu-id="28e31-125">Если не задать файл автозапуска MSC, необходимо вручную загрузить нужную оснастку при запуске приложения в отладчике.</span><span class="sxs-lookup"><span data-stu-id="28e31-125">If you do not set a start-up MSC file, you must manually load the desired snap-in when you run the application in the debugger.</span></span>

<span data-ttu-id="28e31-126">Когда ведущее приложение запускается в отладчике, отладчик может отобразить предупреждающее сообщение о том, что выполняемое приложение не содержит отладочных символов.</span><span class="sxs-lookup"><span data-stu-id="28e31-126">When the host application is run in the debugger, the debugger may display a warning message stating that the application being run does not contain any debug symbols.</span></span> <span data-ttu-id="28e31-127">Это ожидаемое значение, и его можно спокойно проигнорировать, так как на самом деле выполняется отладка библиотеки DLL, а не ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="28e31-127">This is expected and can safely be ignored because you are actually debugging the DLL, not the host application.</span></span>

<span data-ttu-id="28e31-128">В большинстве случаев расширение не будет вызываться до тех пор, пока пользователь не выполнит какое бы то ни было действие, которое вызывает загрузку и инициализацию расширения.</span><span class="sxs-lookup"><span data-stu-id="28e31-128">In most cases, the extension will not be called until the user performs some action that causes the extension to be loaded and initialized.</span></span> <span data-ttu-id="28e31-129">Например, при отладке расширения контекстного меню, отображаемого для объектов пользователя, расширение не будет загружаться до тех пор, пока не отобразится контекстное меню для объекта пользователя.</span><span class="sxs-lookup"><span data-stu-id="28e31-129">For example, if you are debugging a context menu extension displayed for user objects, the extension will not load until the first time the context menu for a user object is displayed.</span></span>

<span data-ttu-id="28e31-130">Теперь вы можете задавать точки останова и просматривать выходные данные отладки.</span><span class="sxs-lookup"><span data-stu-id="28e31-130">You should now be able to set breakpoints and view debug output.</span></span> <span data-ttu-id="28e31-131">Если расширение не будет загружено, установите точку останова в функции [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) расширения.</span><span class="sxs-lookup"><span data-stu-id="28e31-131">If the extension does not appear to load, set a breakpoint in the extension's [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) function.</span></span> <span data-ttu-id="28e31-132">Если **DllGetClassObject** не вызван, возможно, расширение не зарегистрировано должным образом.</span><span class="sxs-lookup"><span data-stu-id="28e31-132">If **DllGetClassObject** is not called, the extension is probably not registered correctly.</span></span>

<span data-ttu-id="28e31-133">После завершения отладки выйдите из консоли MMC, и отладчик должен выгружаться обычным образом.</span><span class="sxs-lookup"><span data-stu-id="28e31-133">When the debug is complete, exit MMC and the debugger should unload normally.</span></span>

 

 