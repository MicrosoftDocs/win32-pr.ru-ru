---
title: Мастера создания объектов
description: В оснастке администрирования MMC служб домен Active Directory Services пользователь может создавать новые объекты в каталоге, открыв контекстное меню для контейнера, в котором будет создан новый объект, выбрав пункт Создать и выбрав класс создаваемого объекта. Создание новых экземпляров объекта запускает мастер создания объектов. Каждый класс объектов может определять использование определенного мастера создания или использовать мастер универсального создания. Для распространенных классов, таких как User и organizationalUnit, оснастка "пользователи и компьютеры Active Directory" предоставляет стандартный набор мастеров создания. Существует два способа расширить мастер создания, заменить существующий мастер или указать один из них, если он не существует для класса, который заменил существующий мастер, создав модуль создания основного объекта. Первичное расширение создания предоставляет первый набор страниц и размещается так же, как и собственные страницы. Первичное расширение создания также поддерживает механизм расширяемости, чтобы можно было вызывать другие расширения мастера создания. Пример основного расширения см. в образце скпвизард в пакете SDK для платформы. Расширение существующего мастера. существующий мастер можно расширить с помощью расширения создания дополнительного объекта. Вторичное расширение создания добавляет страницы мастера к собственным страницам или первичному расширению. Дополнительные сведения и пример дополнительного расширения создания см. в примере усервизард в пакете Platform SDK.
ms.assetid: 7ac7ec21-72a9-4d1f-80f1-1eb5bfa2b296
ms.tgt_platform: multiple
keywords:
- объекты AD, мастера создания
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3bc3dbacaf6eee5670fdacd9a587a497397c4d1b
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104133675"
---
# <a name="object-creation-wizards"></a><span data-ttu-id="d988b-112">Мастера создания объектов</span><span class="sxs-lookup"><span data-stu-id="d988b-112">Object Creation Wizards</span></span>

<span data-ttu-id="d988b-113">В оснастке администрирования MMC служб домен Active Directory Services пользователь может создавать новые объекты в каталоге, открыв контекстное меню для контейнера, в котором будет создан новый объект, выбрав пункт **создать** и выбрав класс создаваемого объекта.</span><span class="sxs-lookup"><span data-stu-id="d988b-113">In the administrative MMC snap-ins of Active Directory Domain Services, the user can create new objects in a directory by opening the context menu for the container where the new object will be created, choosing **New**, and choosing the class of object to create.</span></span> <span data-ttu-id="d988b-114">Создание новых экземпляров объекта запускает мастер создания объектов.</span><span class="sxs-lookup"><span data-stu-id="d988b-114">Creating new instances of an object starts the object creation wizard.</span></span> <span data-ttu-id="d988b-115">Каждый класс объектов может определять использование определенного мастера создания или использовать мастер универсального создания.</span><span class="sxs-lookup"><span data-stu-id="d988b-115">Each object class may specify the use of a specific creation wizard, or it may use a generic creation wizard.</span></span> <span data-ttu-id="d988b-116">Для распространенных классов, таких как [**User**](/windows/desktop/ADSchema/c-user) и [**OrganizationalUnit**](/windows/desktop/ADSchema/c-organizationalunit), оснастка "пользователи и компьютеры Active Directory" предоставляет стандартный набор мастеров создания.</span><span class="sxs-lookup"><span data-stu-id="d988b-116">For common classes, such as [**user**](/windows/desktop/ADSchema/c-user) and [**organizationalUnit**](/windows/desktop/ADSchema/c-organizationalunit), the Active Directory Users and Computers snap-in provides a standard set of creation wizards.</span></span>

<span data-ttu-id="d988b-117">Существует два способа расширения мастера создания:</span><span class="sxs-lookup"><span data-stu-id="d988b-117">There are two ways to extend a creation wizard:</span></span>

-   <span data-ttu-id="d988b-118">Замените существующий мастер или укажите один из них, если он не существует для класса: существующий мастер заменяется созданием расширения для *создания первичного объекта*.</span><span class="sxs-lookup"><span data-stu-id="d988b-118">Replace an existing wizard, or provide one if one does not exist for the class: The existing wizard is replaced by creating a *primary object creation extension*.</span></span> <span data-ttu-id="d988b-119">Первичное расширение создания предоставляет первый набор страниц и размещается так же, как и собственные страницы.</span><span class="sxs-lookup"><span data-stu-id="d988b-119">A primary creation extension provides the first set of pages and is hosted in the same way as native pages.</span></span> <span data-ttu-id="d988b-120">Первичное расширение создания также поддерживает механизм расширяемости, чтобы можно было вызывать другие расширения мастера создания.</span><span class="sxs-lookup"><span data-stu-id="d988b-120">A primary creation extension also supports the extensibility mechanism so that other creation wizard extensions can be invoked.</span></span> <span data-ttu-id="d988b-121">Пример основного расширения см. в образце скпвизард в пакете SDK для платформы.</span><span class="sxs-lookup"><span data-stu-id="d988b-121">For an example of a primary extension, see the scpwizard sample in the Platform Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="d988b-122">Расширение существующего мастера. существующий мастер можно расширить с помощью *расширения создания дополнительного объекта*.</span><span class="sxs-lookup"><span data-stu-id="d988b-122">Extend an existing wizard: An existing wizard can be extended with an *secondary object creation extension*.</span></span> <span data-ttu-id="d988b-123">Вторичное расширение создания добавляет страницы мастера к собственным страницам или первичному расширению.</span><span class="sxs-lookup"><span data-stu-id="d988b-123">A secondary creation extension adds wizard pages to the native pages or primary extension.</span></span> <span data-ttu-id="d988b-124">Дополнительные сведения и пример дополнительного расширения создания см. в примере усервизард в пакете Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="d988b-124">For more information and an example of a secondary creation extension, see the userwizard sample in the Platform SDK.</span></span>

## <a name="developer-audience"></a><span data-ttu-id="d988b-125">Аудитория разработчиков</span><span class="sxs-lookup"><span data-stu-id="d988b-125">Developer Audience</span></span>

<span data-ttu-id="d988b-126">В этой документации предполагается, что читатель знаком с разработкой COM-операций и компонентов с помощью C++.</span><span class="sxs-lookup"><span data-stu-id="d988b-126">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="d988b-127">В настоящее время невозможно создать расширение для мастера создания объектов Active Directory с помощью Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="d988b-127">It is not currently possible to create an extension to the Active Directory object creation wizard using Visual Basic.</span></span>

## <a name="creating-an-active-directory-object-creation-extension"></a><span data-ttu-id="d988b-128">Создание расширения для создания объектов Active Directory</span><span class="sxs-lookup"><span data-stu-id="d988b-128">Creating an Active Directory Object Creation Extension</span></span>

<span data-ttu-id="d988b-129">Расширения первичного и дополнительного объектов — это внутренние серверы COM, которые реализуют определенные интерфейсы и регистрируются в службах домен Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d988b-129">Both primary and secondary object creation extensions are COM in-proc servers that implement certain interfaces and are registered with Active Directory Domain Services.</span></span>

<span data-ttu-id="d988b-130">**Создание и установка расширения для создания объектов**</span><span class="sxs-lookup"><span data-stu-id="d988b-130">**To create and install an object creation extension**</span></span>

1.  <span data-ttu-id="d988b-131">Создайте библиотеку DLL расширения для создания объектов.</span><span class="sxs-lookup"><span data-stu-id="d988b-131">Create the object creation extension DLL.</span></span> <span data-ttu-id="d988b-132">Модуль создания объектов — это внутрипроцессный сервер COM, который, как минимум, реализует интерфейс [**идсадминневобжекст**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjext) .</span><span class="sxs-lookup"><span data-stu-id="d988b-132">An object creation extension is a COM in-proc server that, at a minimum, implements the [**IDsAdminNewObjExt**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjext) interface.</span></span> <span data-ttu-id="d988b-133">Дополнительные сведения см. [в разделе Реализация объекта COM для расширения создания объекта](implementing-the-object-creation-extension-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="d988b-133">For more information, see [Implementing the Object Creation Extension COM Object](implementing-the-object-creation-extension-com-object.md).</span></span>
2.  <span data-ttu-id="d988b-134">Установите расширение создания на компьютерах, где будет использоваться расширение для создания.</span><span class="sxs-lookup"><span data-stu-id="d988b-134">Install the creation extension on computers where the creation extension is to be used.</span></span> <span data-ttu-id="d988b-135">Для этого создайте пакет Microsoft установщик Windows для библиотеки DLL расширения создания и разверните пакет соответствующим образом с помощью групповой политики.</span><span class="sxs-lookup"><span data-stu-id="d988b-135">To do this, create a Microsoft Windows Installer package for the creation extension DLL and deploy the package appropriately using the group policy.</span></span> <span data-ttu-id="d988b-136">Дополнительные сведения см. в разделе [распространение компонентов пользовательского интерфейса](distributing-user-interface-components.md).</span><span class="sxs-lookup"><span data-stu-id="d988b-136">For more information, see [Distributing User Interface Components](distributing-user-interface-components.md).</span></span>
3.  <span data-ttu-id="d988b-137">Зарегистрируйте расширение создания в реестре Windows и в службах домен Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d988b-137">Register the creation extension in the Windows registry and with Active Directory Domain Services.</span></span> <span data-ttu-id="d988b-138">Дополнительные сведения см. [в разделе Регистрация расширения для создания объекта](registering-the-object-creation-extension.md).</span><span class="sxs-lookup"><span data-stu-id="d988b-138">For more information, see [Registering the Object Creation Extension](registering-the-object-creation-extension.md).</span></span>

## <a name="using-an-object-creation-wizard"></a><span data-ttu-id="d988b-139">Использование мастера создания объектов</span><span class="sxs-lookup"><span data-stu-id="d988b-139">Using an Object Creation Wizard</span></span>

<span data-ttu-id="d988b-140">Мастер создания объектов также можно вызвать из приложения, отличного от оснастки администрирования MMC служб домен Active Directory Services.</span><span class="sxs-lookup"><span data-stu-id="d988b-140">An object creation wizard can also be invoked from an application other than the administrative MMC snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="d988b-141">Дополнительные сведения см. [в разделе Вызов мастеров создания из приложения](invoking-creation-wizards-from-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="d988b-141">For more information, see [Invoking Creation Wizards from Your Application](invoking-creation-wizards-from-your-application.md).</span></span>

<span data-ttu-id="d988b-142">Если мастер создания не зарегистрирован для класса объектов, то административные оснастки предоставляют общий мастер создания.</span><span class="sxs-lookup"><span data-stu-id="d988b-142">If a creation wizard is not registered for an object class, the administrative snap-ins provide a generic creation wizard.</span></span> <span data-ttu-id="d988b-143">Мастер универсального создания создается во время выполнения из списка обязательных свойств для класса созданного объекта.</span><span class="sxs-lookup"><span data-stu-id="d988b-143">The generic creation wizard is built at run time from the list of mandatory properties for the class of object created.</span></span> <span data-ttu-id="d988b-144">Для каждого обязательного свойства в пользовательский интерфейс добавляется страница.</span><span class="sxs-lookup"><span data-stu-id="d988b-144">For each mandatory property, a page is added to the UI.</span></span> <span data-ttu-id="d988b-145">Мастер универсального создания не является расширяемым.</span><span class="sxs-lookup"><span data-stu-id="d988b-145">The generic creation wizard is not extensible.</span></span> <span data-ttu-id="d988b-146">Если требуется расширяемость, ее необходимо заменить на расширение создания основного объекта.</span><span class="sxs-lookup"><span data-stu-id="d988b-146">If extensibility is required, it must be replaced with a primary object creation extension.</span></span>

 

 