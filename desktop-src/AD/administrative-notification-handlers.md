---
title: Административные обработчики уведомлений
description: Оснастка MMC "пользователи и компьютеры Microsoft Active Directory" предоставляет механизм, позволяющий компонентам получать уведомления, когда пользователь удаляет, переименовывает, перемещает или изменяет свойства объекта с помощью оснастки.
ms.assetid: 49dbb995-c760-4fac-a72f-d5d94afb63c7
ms.tgt_platform: multiple
keywords:
- Административные обработчики уведомлений Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baa6f48f8b56ab8e4a1d64d0fe15543bfee6c09e
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103890451"
---
# <a name="administrative-notification-handlers"></a><span data-ttu-id="78d18-104">Административные обработчики уведомлений</span><span class="sxs-lookup"><span data-stu-id="78d18-104">Administrative Notification Handlers</span></span>

<span data-ttu-id="78d18-105">Оснастка MMC "пользователи и компьютеры Microsoft Active Directory" предоставляет механизм, позволяющий компонентам получать уведомления, когда пользователь удаляет, переименовывает, перемещает или изменяет свойства объекта с помощью оснастки.</span><span class="sxs-lookup"><span data-stu-id="78d18-105">The Microsoft Active Directory Users and Computers MMC snap-in provides a mechanism to enable components to receive notifications when the user deletes, renames, moves, or changes the properties of an object using the snap-in.</span></span> <span data-ttu-id="78d18-106">Компонент, получающий уведомления, называется "обработчиком уведомлений".</span><span class="sxs-lookup"><span data-stu-id="78d18-106">The component that receives the notifications is known as a "notification handler".</span></span>

<span data-ttu-id="78d18-107">Это полезно, когда несколько объектов связаны друг с другом и должны существовать в одном контейнере.</span><span class="sxs-lookup"><span data-stu-id="78d18-107">This is useful when multiple objects are linked together and must exist within the same container.</span></span> <span data-ttu-id="78d18-108">При перемещении одного из связанных объектов в обработчик уведомлений передается уведомление, а обработчик уведомлений может переместить другие связанные объекты в ту же папку.</span><span class="sxs-lookup"><span data-stu-id="78d18-108">If one of the linked objects is moved, a notification is supplied to the notification handler and the notification handler can move the other linked objects to the same folder.</span></span>

<span data-ttu-id="78d18-109">При выполнении одной из операций и установке одного или нескольких обработчиков уведомления оснастка "пользователи и компьютеры" отобразит диалоговое окно подтверждения, в котором перечислены обработчики уведомлений и флажки для каждого обработчика.</span><span class="sxs-lookup"><span data-stu-id="78d18-109">When one of the operations is performed and one or more notification handlers is installed, the Users and Computers snap-in will display a confirmation dialog box that lists the notification handlers and a check box for each handler.</span></span> <span data-ttu-id="78d18-110">Если установлен флажок для обработчика, будет уведомлен обработчик.</span><span class="sxs-lookup"><span data-stu-id="78d18-110">If the check box for a handler is selected, the handler is notified.</span></span> <span data-ttu-id="78d18-111">Если флажок не установлен, обработчик не получает уведомления.</span><span class="sxs-lookup"><span data-stu-id="78d18-111">If the check box is not selected, the handler is not notified.</span></span>

## <a name="implementing-a-notification-handler"></a><span data-ttu-id="78d18-112">Реализация обработчика уведомлений</span><span class="sxs-lookup"><span data-stu-id="78d18-112">Implementing a Notification Handler</span></span>

<span data-ttu-id="78d18-113">Обработчик уведомлений — это COM-объект, реализованный как внутрипроцессный сервер.</span><span class="sxs-lookup"><span data-stu-id="78d18-113">A notification handler is a COM object implemented as an in-proc server.</span></span> <span data-ttu-id="78d18-114">Обработчик уведомлений должен реализовывать интерфейс [**идсадминнотифихандлер**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) .</span><span class="sxs-lookup"><span data-stu-id="78d18-114">The notification handler must implement the [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) interface.</span></span>

<span data-ttu-id="78d18-115">При возникновении события, которое вызовет уведомление, оснастка "пользователи и компьютеры" перечисляет зарегистрированные обработчики уведомлений и создает каждый из них с помощью идентификатора CLSID для обработчика.</span><span class="sxs-lookup"><span data-stu-id="78d18-115">When an event occurs that will cause a notification, the Users and Computers snap-in enumerates the registered notification handlers and creates each one using the CLSID for the handler.</span></span> <span data-ttu-id="78d18-116">После того как обработчик создан, оснастка вызывает метод [**идсадминнотифихандлер:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) .</span><span class="sxs-lookup"><span data-stu-id="78d18-116">After the handler is created, the snap-in calls the [**IDsAdminNotifyHandler::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) method.</span></span> <span data-ttu-id="78d18-117">Метод **Initialize** предоставляет оснастку события, которые должен получить обработчик.</span><span class="sxs-lookup"><span data-stu-id="78d18-117">The **Initialize** method supplies the snap-in with the events the handler should receive.</span></span>

<span data-ttu-id="78d18-118">Если событием является сообщение, которое должно быть отправлено обработчику уведомлений, то оснастка вызывает метод [**идсадминнотифихандлер:: Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) .</span><span class="sxs-lookup"><span data-stu-id="78d18-118">If the event is one that should be sent to the notification handler, the snap-in calls the [**IDsAdminNotifyHandler::Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method.</span></span> <span data-ttu-id="78d18-119">Метод **Begin** предоставляет обработчик с событием, данные о объекте, на котором происходит событие, и, в зависимости от события, данные о том, что будет преобразовано в объект.</span><span class="sxs-lookup"><span data-stu-id="78d18-119">The **Begin** method provides the handler with the event occurring, data about the object that the event is occurring on and, depending on the event, data about what the object will become.</span></span> <span data-ttu-id="78d18-120">Метод **Begin** также предоставляет оснастку с текстом, который должен отображаться для обработчика в диалоговом окне подтверждения.</span><span class="sxs-lookup"><span data-stu-id="78d18-120">The **Begin** method also provides the snap-in with the text that should be displayed for the handler in the confirmation dialog box.</span></span>

<span data-ttu-id="78d18-121">Когда вызывается метод [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) для каждого обработчика, оснастка отображает диалоговое окно подтверждения.</span><span class="sxs-lookup"><span data-stu-id="78d18-121">When the [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method for each handler has been called, the snap-in displays the confirmation dialog box.</span></span> <span data-ttu-id="78d18-122">Появится диалоговое окно подтверждения, предлагающее пользователю выбрать обработчики, которые будут принимать уведомление.</span><span class="sxs-lookup"><span data-stu-id="78d18-122">The confirmation dialog box prompts the user to select which handlers will receive the notification.</span></span> <span data-ttu-id="78d18-123">Если пользователь нажмет кнопку **без** отправки в диалоговом окне подтверждения, никакие обработчики не будут уведомлены.</span><span class="sxs-lookup"><span data-stu-id="78d18-123">If the user presses the **No** push button in the confirmation dialog, none of the handlers are notified.</span></span> <span data-ttu-id="78d18-124">Если пользователь нажмет кнопку **"Да** ", все обработчики, выбранные в диалоговом окне подтверждения, получат уведомление.</span><span class="sxs-lookup"><span data-stu-id="78d18-124">If the user presses the **Yes** push button, each of the handlers selected in the confirmation dialog box receive the notification.</span></span> <span data-ttu-id="78d18-125">Оснастка отправляет уведомление обработчику, вызывая метод [**идсадминнотифихандлер:: notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) .</span><span class="sxs-lookup"><span data-stu-id="78d18-125">The snap-in sends the notification to the handler by calling the [**IDsAdminNotifyHandler::Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method.</span></span>

<span data-ttu-id="78d18-126">После уведомления всех обработчиков оснастка вызывает метод [**идсадминнотифихандлер:: end**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) .</span><span class="sxs-lookup"><span data-stu-id="78d18-126">After all of the handlers have been notified, the snap-in calls the [**IDsAdminNotifyHandler::End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) method.</span></span> <span data-ttu-id="78d18-127">Метод **End** вызывается всегда, даже если метод [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) не вызывается.</span><span class="sxs-lookup"><span data-stu-id="78d18-127">The **End** method is always called, even if the [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method is not called.</span></span>

## <a name="registering-a-notification-handler-in-the-windows-registry"></a><span data-ttu-id="78d18-128">Регистрация обработчика уведомлений в реестре Windows</span><span class="sxs-lookup"><span data-stu-id="78d18-128">Registering a Notification Handler in the Windows Registry</span></span>

<span data-ttu-id="78d18-129">Как и все серверы COM, обработчик уведомлений должен быть зарегистрирован в реестре Windows.</span><span class="sxs-lookup"><span data-stu-id="78d18-129">Like all COM servers, a notification handler must be registered in the Windows registry.</span></span> <span data-ttu-id="78d18-130">Обработчик регистрируется в следующем разделе:</span><span class="sxs-lookup"><span data-stu-id="78d18-130">The handler is registered under the following key:</span></span>


```C++
HKEY_CLASSES_ROOT - CLSID - <CLSID>
```



<span data-ttu-id="78d18-131">**<CLSID>** Строковое представление идентификатора CLSID, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="78d18-131">**<CLSID>** is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="78d18-132">В **<CLSID>** ключе имеется ключ **InprocServer32** , который идентифицирует объект как 32-разрядный сервер in-proc.</span><span class="sxs-lookup"><span data-stu-id="78d18-132">Under the **<CLSID>** key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="78d18-133">В ключе **InprocServer32** расположение библиотеки DLL указывается в значении по умолчанию, а модель потоков указывается в значении **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="78d18-133">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="78d18-134">Все обработчики уведомлений должны использовать модель потоков **подразделений** .</span><span class="sxs-lookup"><span data-stu-id="78d18-134">All notification handlers must use the **Apartment** threading model.</span></span>

## <a name="registering-a-notification-handler-with-an-active-directory-server"></a><span data-ttu-id="78d18-135">Регистрация обработчика уведомлений с сервером Active Directory</span><span class="sxs-lookup"><span data-stu-id="78d18-135">Registering a Notification Handler with an Active Directory Server</span></span>

<span data-ttu-id="78d18-136">В домен Active Directory Services регистрация обработчика уведомлений относится только к одному языку.</span><span class="sxs-lookup"><span data-stu-id="78d18-136">Within Active Directory Domain Services, notification handler registration is specific to one locale.</span></span> <span data-ttu-id="78d18-137">Если обработчик уведомлений применяется ко всем языкам, он должен быть зарегистрирован в объекте **дисплайспеЦифиер** во всех подконтейнерах языкового стандарта контейнера дисплайспеЦифиерс.</span><span class="sxs-lookup"><span data-stu-id="78d18-137">If the notification handler applies to all locales, it must be registered in the **displaySpecifier** object in all of the locale subcontainers in the DisplaySpecifiers container.</span></span> <span data-ttu-id="78d18-138">Если обработчик уведомлений локализован для определенного языкового стандарта, он регистрируется в объекте **дисплайспеЦифиер** в подконтейнере этого языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="78d18-138">If the notification handler is localized for a certain locale, it is registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="78d18-139">Дополнительные сведения о контейнере ДисплайспеЦифиерс и языковых стандартах см. в разделе [описатели экрана](display-specifiers.md) и [контейнеры дисплайспеЦифиерс](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="78d18-139">For more information about the DisplaySpecifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="78d18-140">Обработчики уведомлений регистрируются в атрибуте **дсуиадминнотификатион** в контейнере **DS-UI-Default-Settings** .</span><span class="sxs-lookup"><span data-stu-id="78d18-140">Notification handlers are registered under the **dsUIAdminNotification** attribute in the **DS-UI-Default-Settings** container.</span></span> <span data-ttu-id="78d18-141">Это многозначное строковое значение Юникода, в котором каждому значению требуется следующий формат:</span><span class="sxs-lookup"><span data-stu-id="78d18-141">This a multi-valued Unicode string value where each value requires the following format:</span></span>


```C++
<order number>,<CLSID>
```



<span data-ttu-id="78d18-142">&lt;Порядковый номер &gt; — это число без знака, представляющее расположение обработчика в диалоговом окне подтверждения.</span><span class="sxs-lookup"><span data-stu-id="78d18-142">The "&lt;order number&gt;" is an unsigned number that represents the position of the handler in the confirmation dialog.</span></span> <span data-ttu-id="78d18-143">При отображении диалогового окна подтверждения значения сортируются с помощью сравнения "номер заказа" каждого значения &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="78d18-143">When the confirmation dialog is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="78d18-144">Если несколько значений имеют одинаковый &lt; порядковый номер &gt; , эти обработчики отображаются в том порядке, в котором они считываются с Active Directory сервера.</span><span class="sxs-lookup"><span data-stu-id="78d18-144">If more than one value has the same "&lt;order number&gt;", those handlers are displayed in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="78d18-145">Несуществующий, то есть, не используется другими значениями в свойстве, по &lt; возможности следует использовать "номер заказа &gt; ".</span><span class="sxs-lookup"><span data-stu-id="78d18-145">A non-existing, that is, one not used by other values in the property, "&lt;order number&gt;" should be used if possible.</span></span> <span data-ttu-id="78d18-146">Нет предписанной начальной должности, и пропуски могут отображаться в последовательности " &lt; номер заказа &gt; ".</span><span class="sxs-lookup"><span data-stu-id="78d18-146">There is no prescribed starting position, and gaps can appear in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="78d18-147">" &lt; CLSID &gt; " — это строковое представление идентификатора CLSID, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="78d18-147">The "&lt;CLSID&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

 

 