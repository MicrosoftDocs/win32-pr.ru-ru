---
title: Рекомендации по проектированию сервера состояний
description: В зависимости от проекта может потребоваться сервер для наблюдения за пользователями, которые в настоящее время вошли в сеть.
ms.assetid: 2f8d268b-5518-4ad2-aed6-5971c913db6d
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7a0ef654f3641138075acc667d733b20c94c4840
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411188"
---
# <a name="state-server-design-considerations"></a><span data-ttu-id="97125-103">Рекомендации по проектированию сервера состояний</span><span class="sxs-lookup"><span data-stu-id="97125-103">State Server Design Considerations</span></span>

> [!Note]  
> <span data-ttu-id="97125-104">Служба проверки подлинности в Интернете (IAS) переименовала сервер политики сети (NPS), начиная с Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="97125-104">Internet Authentication Service (IAS) was renamed Network Policy Server (NPS) starting with Windows Server 2008.</span></span> <span data-ttu-id="97125-105">Содержимое этого раздела относится как к IAS, так и к NPS.</span><span class="sxs-lookup"><span data-stu-id="97125-105">The content of this topic applies to both IAS and NPS.</span></span> <span data-ttu-id="97125-106">По всему тексту NPS используется для ссылки на все версии службы, включая версии, изначально называемые IAS.</span><span class="sxs-lookup"><span data-stu-id="97125-106">Throughout the text, NPS is used to refer to all versions of the service, including the versions originally referred to as IAS.</span></span>

 

<span data-ttu-id="97125-107">В зависимости от проекта может потребоваться сервер для наблюдения за пользователями, которые в настоящее время вошли в сеть.</span><span class="sxs-lookup"><span data-stu-id="97125-107">Depending on your design, you may need a server to track the users that are currently logged onto the network.</span></span> <span data-ttu-id="97125-108">Основная проблема с сервером состояний заключается в том, что данные в базе данных сервера состояний синхронизируются с тем, кто на самом деле вошел в систему.</span><span class="sxs-lookup"><span data-stu-id="97125-108">The main challenge with the state server is keeping the information in the state server database in-sync with who is actually logged on.</span></span> <span data-ttu-id="97125-109">Если данные на сервере состояний не синхронизированы, пользователи могут пройти проверку в случае нескольких сеансов, если им не разрешено делать это.</span><span class="sxs-lookup"><span data-stu-id="97125-109">If the information in the state server is out of sync, users may succeed in having multiple sessions when they aren't authorized to do so.</span></span> <span data-ttu-id="97125-110">Кроме того, пользователи, не имеющие нескольких сеансов, могут случайно получить штраф.</span><span class="sxs-lookup"><span data-stu-id="97125-110">Also, users who do not have multiple sessions could be inadvertently penalized.</span></span>

<span data-ttu-id="97125-111">При реализации сервера состояний следует учитывать следующее:</span><span class="sxs-lookup"><span data-stu-id="97125-111">The following should be taken into consideration in implementing the state server:</span></span>

-   <span data-ttu-id="97125-112">Сервер состояний должен принимать решение в сети через несколько секунд.</span><span class="sxs-lookup"><span data-stu-id="97125-112">The state server must make the decision online in a few seconds.</span></span> <span data-ttu-id="97125-113">По этой причине серверу состояний требуется масштабируемая инфраструктура, поддерживающая множество обновлений и запросов в секунду.</span><span class="sxs-lookup"><span data-stu-id="97125-113">For this reason the state server requires a scaleable infrastructure that can support many updates and queries per second.</span></span> <span data-ttu-id="97125-114">Реляционные базы данных не подходят для таких больших запросов с одновременными обновлениями.</span><span class="sxs-lookup"><span data-stu-id="97125-114">Relational databases are not appropriate for such large queries with simultaneous updates.</span></span> <span data-ttu-id="97125-115">Реляционные базы данных в основном создаются для обеспечения единообразия данных и обеспечения единообразного представления данных для всех потребителей.</span><span class="sxs-lookup"><span data-stu-id="97125-115">Relational databases are primarily built to keep data consistent and to provide a consistent view of the data to all consumers.</span></span> <span data-ttu-id="97125-116">Они не предназначены для быстрого обновления.</span><span class="sxs-lookup"><span data-stu-id="97125-116">They are not built for quick updates.</span></span>
-   <span data-ttu-id="97125-117">Согласованность транзакций при обновлениях между несколькими объектами не имеет значения.</span><span class="sxs-lookup"><span data-stu-id="97125-117">Transactional consistency on updates between multiple objects is not important.</span></span> <span data-ttu-id="97125-118">Это связано с тем, что сервер состояний может допускать небольшое окно возможности.</span><span class="sxs-lookup"><span data-stu-id="97125-118">This is because the state server can tolerate a small window of opportunity.</span></span> <span data-ttu-id="97125-119">Тем не менее, согласованность транзакций одного обновления важна, чтобы снизить вероятность того, что сервер состояний будет находиться в несогласованном состоянии, если один из серверов RADIUS завершит работу в середине обновления.</span><span class="sxs-lookup"><span data-stu-id="97125-119">However, transactional consistency of a single update is important to reduce the chances of leaving the state server in an inconsistent state if one of the RADIUS servers is shut down in the middle of the update.</span></span>
-   <span data-ttu-id="97125-120">Сохраняемость (сохранение состояния сети в постоянное хранилище) не имеет значения, так как постоянная информация будет быстро несинхронизирована с фактическим состоянием сети.</span><span class="sxs-lookup"><span data-stu-id="97125-120">Persistence (saving the state of the network to persistent storage) is not important because the persistent information will quickly fall out of sync with the actual state of the network.</span></span>
-   <span data-ttu-id="97125-121">Если в сети поддерживаются ISDN или другие формы многоканального подключения, сервер состояний должен иметь возможность обрабатывать сценарии, использующие эти функции.</span><span class="sxs-lookup"><span data-stu-id="97125-121">If ISDN or other forms of multilink are supported on the network, the state server should be able to handle scenarios that use these features.</span></span>

<span data-ttu-id="97125-122">Одна из возможных архитектур — реализовать библиотеку DLL расширения проверки подлинности и библиотеку DLL расширения авторизации.</span><span class="sxs-lookup"><span data-stu-id="97125-122">One possible design is to implement both an Authentication Extension DLL and an Authorization Extension DLL.</span></span> <span data-ttu-id="97125-123">Каждая из этих библиотек DLL может взаимодействовать по сети с базой данных.</span><span class="sxs-lookup"><span data-stu-id="97125-123">Each of these DLLs can communicate over the network with a database.</span></span> <span data-ttu-id="97125-124">Библиотека DLL расширения авторизации может обновить базу данных, указав сведения о том, кто в данный момент вошел в сеть.</span><span class="sxs-lookup"><span data-stu-id="97125-124">The Authorization Extension DLL can update the database with information about who is currently logged onto the network.</span></span> <span data-ttu-id="97125-125">Библиотека DLL расширения проверки подлинности может запрашивать эти сведения в базе данных, чтобы принять решение о принятии или отклонении запроса на проверку подлинности конкретного пользователя. Если пользователь уже вошел в систему, запрос отклоняется.</span><span class="sxs-lookup"><span data-stu-id="97125-125">The Authentication Extension DLL can query the database for this information to decide whether to accept or reject a particular user's authentication request; if the user is already logged on, the request is rejected.</span></span>

<span data-ttu-id="97125-126">Преимущество обновления библиотеки DLL расширения авторизации в базе данных сервера состояний — это то, что библиотека DLL расширения авторизации имеет доступ к дополнительным сведениям о прошедшем проверку подлинности пользователе.</span><span class="sxs-lookup"><span data-stu-id="97125-126">The advantage of having the Authorization Extension DLL update the state-server database is that the Authorization Extension DLL has access to more information about the authenticated user.</span></span> <span data-ttu-id="97125-127">Библиотека DLL расширения авторизации имеет доступ ко всем атрибутам авторизации из механизма авторизации NPS.</span><span class="sxs-lookup"><span data-stu-id="97125-127">The Authorization Extension DLL has access to all of the authorization attributes from the NPS Authorization mechanism.</span></span> <span data-ttu-id="97125-128">Например, некоторые пользователи могут иметь разрешения, позволяющие им иметь несколько сеансов.</span><span class="sxs-lookup"><span data-stu-id="97125-128">For example, some users may have authorizations that allow them to have multiple sessions.</span></span> <span data-ttu-id="97125-129">Сервер состояний должен рассматривать таких пользователей как особый случай.</span><span class="sxs-lookup"><span data-stu-id="97125-129">The state server should treat such users as a special case.</span></span>

 

 




