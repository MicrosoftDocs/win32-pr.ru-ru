---
description: Драйвер МСДВ
ms.assetid: 146ca753-fe41-49d3-8b1c-077e10a28192
title: Драйвер МСДВ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b7c1bda24980abe84a11613126476ccfe35380d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104416432"
---
# <a name="msdv-driver"></a><span data-ttu-id="b5116-103">Драйвер МСДВ</span><span class="sxs-lookup"><span data-stu-id="b5116-103">MSDV Driver</span></span>

<span data-ttu-id="b5116-104">МСДВ — это драйвер Microsoft WDM (WDM) для видеокамер DV.</span><span class="sxs-lookup"><span data-stu-id="b5116-104">MSDV is the Microsoft Windows Driver Model (WDM) driver for DV camcorders.</span></span> <span data-ttu-id="b5116-105">Драйвер отображается как фильтр DirectShow, когда устройство подключено к сети.</span><span class="sxs-lookup"><span data-stu-id="b5116-105">The driver appears as a DirectShow filter when the device is plugged in.</span></span> <span data-ttu-id="b5116-106">Он перечисляется в двух категориях фильтров:</span><span class="sxs-lookup"><span data-stu-id="b5116-106">It is enumerated in two filter categories:</span></span>

-   <span data-ttu-id="b5116-107">CLSID \_ видеоинпутдевицекатегори ("источники видеозаписей")</span><span class="sxs-lookup"><span data-stu-id="b5116-107">CLSID\_VideoInputDeviceCategory ("Video Capture Sources")</span></span>
-   <span data-ttu-id="b5116-108">\_Кскатегори \_ отрисовка ("устройства рендеринга потоковой передачи WDM")</span><span class="sxs-lookup"><span data-stu-id="b5116-108">AM\_KSCATEGORY\_RENDER ("WDM Streaming Rendering Devices")</span></span>

<span data-ttu-id="b5116-109">Понятное имя фильтра — `Microsoft DV Camera and VCR` или локализованный эквивалент.</span><span class="sxs-lookup"><span data-stu-id="b5116-109">The filter's friendly name is `Microsoft DV Camera and VCR`, or a localized equivalent.</span></span> <span data-ttu-id="b5116-110">В некоторых устройствах свойство **Description** содержит описание конкретной модели, которую можно использовать вместо универсального понятного имени.</span><span class="sxs-lookup"><span data-stu-id="b5116-110">In some devices, the **Description** property contains a description of the specific model, which can be used instead of the generic friendly name.</span></span> <span data-ttu-id="b5116-111">Дополнительные сведения см. [в разделе Выбор устройства записи](selecting-a-capture-device.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-111">For more information, see [Selecting a Capture Device](selecting-a-capture-device.md).</span></span>

<span data-ttu-id="b5116-112">МСДВ имеет два выходных контакта.</span><span class="sxs-lookup"><span data-stu-id="b5116-112">MSDV has two output pins.</span></span> <span data-ttu-id="b5116-113">Один ПИН-код предоставляет кадры DV, которые содержат чередующиеся аудио-и видеоданные.</span><span class="sxs-lookup"><span data-stu-id="b5116-113">One pin delivers DV frames that contain interleaved audio and video data.</span></span> <span data-ttu-id="b5116-114">Другой ПИН-код предоставляет кадры только для видео без звука.</span><span class="sxs-lookup"><span data-stu-id="b5116-114">The other pin delivers video-only frames with no audio.</span></span> <span data-ttu-id="b5116-115">МСДВ не может выполнять потоковую передачу обоих ПИН-кодов одновременно, поэтому одновременно может быть подключен только один выходной контакт.</span><span class="sxs-lookup"><span data-stu-id="b5116-115">MSDV cannot stream from both pins at once, so only one output pin can be connected at a time.</span></span> <span data-ttu-id="b5116-116">Дополнительные сведения о записи видео с устройства DV см. в разделе [запись DV в файл](capture-dv-to-file.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-116">For more information about capturing video from a DV device, see [Capture DV to File](capture-dv-to-file.md).</span></span>

![запись данных DV с устройства](images/dv-filters4.png)

<span data-ttu-id="b5116-118">Большинство видеокамер с цифровой видеомагнитофоной имеют подединицу записи видеомагнитофонов (Втр), которая может передавать данные с ленты на компьютер.</span><span class="sxs-lookup"><span data-stu-id="b5116-118">Most DV camcorders have a video tape recorder (VTR) subunit, which can transmit data from tape to the computer.</span></span> <span data-ttu-id="b5116-119">Для приложения запись с ленты работает так же, как и запись видео в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="b5116-119">For the application, capturing from tape works the same as capturing live video.</span></span> <span data-ttu-id="b5116-120">Единственное отличие заключается в том, что приложение должно управлять внешним транспортом ленты — запуском и остановкой ленты, перемотки назад и т. д.</span><span class="sxs-lookup"><span data-stu-id="b5116-120">The only difference is that the application must control the external tape transport — start and stop the tape, rewind, and so forth.</span></span> <span data-ttu-id="b5116-121">Для этой цели МСДВ предоставляет интерфейсы [**иамекстдевице**](/windows/desktop/api/Strmif/nn-strmif-iamextdevice), [**иамексттранспорт**](/windows/desktop/api/Strmif/nn-strmif-iamexttransport)и [**иамтимекодереадер**](/windows/desktop/api/Strmif/nn-strmif-iamtimecodereader) .</span><span class="sxs-lookup"><span data-stu-id="b5116-121">For this purpose, MSDV exposes the [**IAMExtDevice**](/windows/desktop/api/Strmif/nn-strmif-iamextdevice), [**IAMExtTransport**](/windows/desktop/api/Strmif/nn-strmif-iamexttransport), and [**IAMTimecodeReader**](/windows/desktop/api/Strmif/nn-strmif-iamtimecodereader) interfaces.</span></span> <span data-ttu-id="b5116-122">Дополнительные сведения об управлении Втр см. в разделе [Управление ВИДЕОкамерой](controlling-a-dv-camcorder.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-122">For more information about controlling a VTR, see [Controlling a DV Camcorder](controlling-a-dv-camcorder.md).</span></span>

<span data-ttu-id="b5116-123">Можно также передать DV с компьютера на видеокамеру.</span><span class="sxs-lookup"><span data-stu-id="b5116-123">You can also transmit DV from the computer to the camcorder.</span></span> <span data-ttu-id="b5116-124">Затем видео можно просмотреть на экране портативной видеокамеры или записать на ленту.</span><span class="sxs-lookup"><span data-stu-id="b5116-124">The video can then be viewed in the camcorder's onboard screen, or recorded to tape.</span></span> <span data-ttu-id="b5116-125">Для поддержки этой функции МСДВ имеет входной ПИН-код, который может принимать поток с чередованием.</span><span class="sxs-lookup"><span data-stu-id="b5116-125">To support this functionality, MSDV has an input pin that can receive an interleaved DV stream.</span></span> <span data-ttu-id="b5116-126">Когда входной ПИН-код подключен, МСДВ выступает в качестве фильтра модуля подготовки отчетов вместо фильтра записи.</span><span class="sxs-lookup"><span data-stu-id="b5116-126">When the input pin is connected, MSDV acts as a renderer filter instead of a capture filter.</span></span> <span data-ttu-id="b5116-127">МСДВ не поддерживает поиск в этом режиме.</span><span class="sxs-lookup"><span data-stu-id="b5116-127">MSDV does not support seeking in this mode.</span></span> <span data-ttu-id="b5116-128">Дополнительные сведения о отправке DV на устройство см. [в разделе Передача DV из файла на ленту](transmit-dv-from-file-to-tape.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-128">For more information about sending DV to the device, see [Transmit DV from File to Tape](transmit-dv-from-file-to-tape.md).</span></span>

![Передача DV данных на устройство](images/dv-filters5.png)

<span data-ttu-id="b5116-130">Обратите внимание, что входные и выходные контакты не могут быть подключены одновременно, так как устройство не может выполнять потоковую передачу одновременно в обоих направлениях.</span><span class="sxs-lookup"><span data-stu-id="b5116-130">Note that the input and output pins cannot be connected at the same time, because the device cannot stream in both directions at the same time.</span></span>

<span data-ttu-id="b5116-131">Во многих видеокамерах переключение между режимом Втр и режимом камеры приводит к отключению устройства.</span><span class="sxs-lookup"><span data-stu-id="b5116-131">In many camcorders, switching between VTR mode and camera mode causes the device to switch off.</span></span> <span data-ttu-id="b5116-132">Поэтому DirectShow может потерять устройство, когда пользователь переключает режимы.</span><span class="sxs-lookup"><span data-stu-id="b5116-132">Therefore, DirectShow may lose the device when the user switches modes.</span></span> <span data-ttu-id="b5116-133">Сведения о событиях удаления устройств см. в разделе [уведомление об удалении устройства](device-removal-notification.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-133">For information about device removal events, see [Device Removal Notification](device-removal-notification.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="b5116-134">Комментарии</span><span class="sxs-lookup"><span data-stu-id="b5116-134">Remarks</span></span>

<span data-ttu-id="b5116-135">Сведения о форматах DV, поддерживаемых драйвером МСДВ, см. в статье [**подтипы видео DV**](dv-video-subtypes.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-135">For information about which DV formats are supported by the MSDV driver, see [**DV Video Subtypes**](dv-video-subtypes.md).</span></span>

<span data-ttu-id="b5116-136">Некоторые советы по созданию графов фильтра с помощью МСДВ:</span><span class="sxs-lookup"><span data-stu-id="b5116-136">Some tips on building filter graphs with MSDV:</span></span>

-   <span data-ttu-id="b5116-137">Нельзя использовать [**играфбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) для отрисовки выходного ПИН-кода в мсдв.</span><span class="sxs-lookup"><span data-stu-id="b5116-137">You cannot use [**IGraphBuilder::Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) to render an output pin on MSDV.</span></span> <span data-ttu-id="b5116-138">(Диспетчер графов фильтров пытается подключить выходной закрепление к входному ПИН-коду МСДВ, который завершается ошибкой.) Вместо этого используйте [**играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) или [**ICaptureGraphBuilder2:: RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream).</span><span class="sxs-lookup"><span data-stu-id="b5116-138">(The Filter Graph Manager tries to connect the output pin to MSDV's input pin, which fails.) Instead, use [**IGraphBuilder::Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) or [**ICaptureGraphBuilder2::RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream).</span></span>
-   <span data-ttu-id="b5116-139">Если граф фильтра содержит МСДВ, МСДВ должен предоставлять эталонные часы для графа.</span><span class="sxs-lookup"><span data-stu-id="b5116-139">When a filter graph contains MSDV, MSDV should supply the reference clock for the graph.</span></span> <span data-ttu-id="b5116-140">Начиная с DirectX 8,0, диспетчер графа фильтров автоматически выбирает МСДВ в качестве эталонного времени.</span><span class="sxs-lookup"><span data-stu-id="b5116-140">As of DirectX 8.0, the Filter Graph Manager will automatically choose MSDV as the reference clock.</span></span> <span data-ttu-id="b5116-141">В более ранних версиях необходимо вызвать метод [**имедиафилтер:: сетсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) в диспетчере графов фильтров.</span><span class="sxs-lookup"><span data-stu-id="b5116-141">With earlier versions, you should call the [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method on the Filter Graph Manager.</span></span> <span data-ttu-id="b5116-142">Дополнительные сведения о часах см. в статье [время и часы в DirectShow](time-and-clocks-in-directshow.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-142">For more information about clocks, see [Time and Clocks in DirectShow](time-and-clocks-in-directshow.md).</span></span>
-   <span data-ttu-id="b5116-143">В зависимости от устройства некоторые методы в **иамекстдевице**, **иамексттранспорт** и **иамтимекодереадер** могут возвращать коды ошибок Windows вместо значений **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="b5116-143">Depending on the device, some methods in **IAMExtDevice**, **IAMExtTransport**, and **IAMTimeCodeReader** might return Windows error codes instead of **HRESULT** values.</span></span> <span data-ttu-id="b5116-144">Ниже перечислены возможные коды ошибок.</span><span class="sxs-lookup"><span data-stu-id="b5116-144">Possible error codes include the following.</span></span>

    | <span data-ttu-id="b5116-145">Код ошибки</span><span class="sxs-lookup"><span data-stu-id="b5116-145">Error Code</span></span>              | <span data-ttu-id="b5116-146">Описание</span><span class="sxs-lookup"><span data-stu-id="b5116-146">Description</span></span>                                                                                      |
    |-------------------------|--------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="b5116-147">\_время ожидания ошибки</span><span class="sxs-lookup"><span data-stu-id="b5116-147">ERROR\_TIMEOUT</span></span>          | <span data-ttu-id="b5116-148">Истекло время ожидания для команды внешнего устройства.</span><span class="sxs-lookup"><span data-stu-id="b5116-148">An external device command has timed out.</span></span>                                                        |
    | <span data-ttu-id="b5116-149">Ошибка \_ req \_ не \_ акцеп</span><span class="sxs-lookup"><span data-stu-id="b5116-149">ERROR\_REQ\_NOT\_ACCEP</span></span>  | <span data-ttu-id="b5116-150">Устройство не приняло эту команду внешнего устройства.</span><span class="sxs-lookup"><span data-stu-id="b5116-150">The device did not accept this external device command.</span></span>                                          |
    | <span data-ttu-id="b5116-151">Ошибка \_ не \_ поддерживается</span><span class="sxs-lookup"><span data-stu-id="b5116-151">ERROR\_NOT\_SUPPORTED</span></span>   | <span data-ttu-id="b5116-152">Устройство не поддерживает эту команду внешнего устройства.</span><span class="sxs-lookup"><span data-stu-id="b5116-152">The device does not support this external device command.</span></span>                                        |
    | <span data-ttu-id="b5116-153">запрос на ошибку \_ \_ прерван</span><span class="sxs-lookup"><span data-stu-id="b5116-153">ERROR\_REQUEST\_ABORTED</span></span> | <span data-ttu-id="b5116-154">Команда внешнего устройства прервана.</span><span class="sxs-lookup"><span data-stu-id="b5116-154">An external device command was aborted.</span></span> <span data-ttu-id="b5116-155">Возможно, устройство было удалено, или произошла сброс шины.</span><span class="sxs-lookup"><span data-stu-id="b5116-155">Possibly the device was removed or a bus reset occurred.</span></span> |

    

     

### <a name="device-information"></a><span data-ttu-id="b5116-156">Сведения об устройстве</span><span class="sxs-lookup"><span data-stu-id="b5116-156">Device Information</span></span>

<span data-ttu-id="b5116-157">В Windows Millennium Edition и Windows XP моникер устройства DV-фильтра поддерживает свойство **Description** в дополнение к свойству **FriendlyName** .</span><span class="sxs-lookup"><span data-stu-id="b5116-157">In Windows Millennium Edition and Windows XP, the DV filter's device moniker supports a **Description** property in addition to the **FriendlyName** property.</span></span> <span data-ttu-id="b5116-158">Это свойство возвращает описание устройства, взятое из INF-файла, которое обычно содержит фирменное название устройства.</span><span class="sxs-lookup"><span data-stu-id="b5116-158">This property returns a description of the device, taken from the INF file, which usually contains the brand name of the device.</span></span> <span data-ttu-id="b5116-159">Однако это свойство не поддерживается для всех моделей устройств.</span><span class="sxs-lookup"><span data-stu-id="b5116-159">This property is not supported for all device models, however.</span></span>

<span data-ttu-id="b5116-160">Дополнительные сведения об моникерах устройств см. [в разделе Использование перечислителя системных устройств](using-the-system-device-enumerator.md).</span><span class="sxs-lookup"><span data-stu-id="b5116-160">For more information about device monikers, see [Using the System Device Enumerator](using-the-system-device-enumerator.md).</span></span>

### <a name="clock-times"></a><span data-ttu-id="b5116-161">Время суток</span><span class="sxs-lookup"><span data-stu-id="b5116-161">Clock Times</span></span>

<span data-ttu-id="b5116-162">Драйвер МСДВ использует часы шины 1394, содержащиеся в пакетах данных 1394, чтобы получить данные о часах.</span><span class="sxs-lookup"><span data-stu-id="b5116-162">The MSDV driver uses the 1394 bus clock that is contained in the 1394 data packets to derive the clock.</span></span> <span data-ttu-id="b5116-163">Эти значения используются для отметки времени образцами DV Media.</span><span class="sxs-lookup"><span data-stu-id="b5116-163">It uses these values to time stamp the DV media samples.</span></span> <span data-ttu-id="b5116-164">Так как часы этого источника не являются часами компьютерной системы, время в конечном итоге будет отменяться от системных часов системы.</span><span class="sxs-lookup"><span data-stu-id="b5116-164">Because this source clock is not the computer system clock, the times will eventually drift from the computer system clock.</span></span> <span data-ttu-id="b5116-165">Как отмечалось выше, по умолчанию диспетчер графов фильтров выберет МСДВ в качестве времени ссылки на граф.</span><span class="sxs-lookup"><span data-stu-id="b5116-165">As noted above, however, by default the Filter Graph Manager will select MSDV as the graph reference clock.</span></span>

<span data-ttu-id="b5116-166">Интерфейс [**иамдроппедфрамес**](/windows/desktop/api/Strmif/nn-strmif-iamdroppedframes) сообщает текущую меру драйвера о пропущенных кадрах. Это значение может быть идеально синхронизировано с фактическим числом удаленных кадров в заданный момент времени.</span><span class="sxs-lookup"><span data-stu-id="b5116-166">The [**IAMDroppedFrames**](/windows/desktop/api/Strmif/nn-strmif-iamdroppedframes) interface reports the driver's current measure of dropped frames; this value may not be perfectly synchronized with the actual number of dropped frames at a given time.</span></span> <span data-ttu-id="b5116-167">Если фреймы удалены, это означает, что система не сбалансирована (объем данных в производстве превышает потребление).</span><span class="sxs-lookup"><span data-stu-id="b5116-167">If frames are dropped, it indicates that the system is not balanced (data production exceeds data consumption).</span></span> <span data-ttu-id="b5116-168">Например, жесткий диск пользователя может быть недостаточно быстрым для поддержки скорости записи DV.</span><span class="sxs-lookup"><span data-stu-id="b5116-168">For example, the user's hard disk may not be fast enough to support DV capture rates.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b5116-169">См. также</span><span class="sxs-lookup"><span data-stu-id="b5116-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b5116-170">Фильтры DirectShow</span><span class="sxs-lookup"><span data-stu-id="b5116-170">DirectShow Filters</span></span>](directshow-filters.md)
</dt> <dt>

[<span data-ttu-id="b5116-171">Цифровое видео в DirectShow</span><span class="sxs-lookup"><span data-stu-id="b5116-171">Digital Video in DirectShow</span></span>](digital-video-in-directshow.md)
</dt> </dl>

 

 



