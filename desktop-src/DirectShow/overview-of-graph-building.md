---
description: обзор Graph здания
ms.assetid: 5753f06c-ecfd-48d7-a8e9-768b798e9279
title: обзор Graph здания
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c16b943714e2e559286b805a8489152805d9b0e037a77603bacd00f8b0135cc9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118152950"
---
# <a name="overview-of-graph-building"></a>обзор Graph здания

чтобы создать граф фильтра, начните с создания экземпляра фильтра Graph Manager:


```C++
IGraphBuilder* pIGB;
HRESULT hr = CoCreateInstance(CLSID_FilterGraph,
    NULL, CLSCTX_INPROC_SERVER, IID_IGraphBuilder,
    (void **)&pIGB);
```



диспетчер Graph фильтров поддерживает следующие методы построения диаграмм:

-   [**Ифилтерграф:: коннектдирект**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-connectdirect) пытается установить прямое соединение между двумя контактами. Если ПИН-коды не могут подключиться, метод завершается с ошибкой.
-   [**играфбуилдер:: Подключение**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) соединяет два контакта. По возможности он устанавливает прямое соединение. В противном случае для завершения подключения используются промежуточные фильтры.
-   [**Играфбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) начинается с выходного ПИН-кода и создает оставшуюся часть графа. Эти методы добавляют фильтры по мере необходимости, работают нисходящими, пока не достигнет фильтра модуля подготовки отчетов.
-   [**Играфбуилдер:: renderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) создает полный граф воспроизведения файлов.
-   [**Ифилтерграф:: аддфилтер**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-addfilter) добавляет фильтр в граф. Он не подключается к фильтру. Перед вызовом этого метода необходимо создать фильтр, вызвав **CoCreateInstance** или перечислителя фильтров или перечислитель системных устройств.

Эти методы предоставляют три основных подхода к построению графа:

1.  фильтр Graph Manager строит весь граф.
2.  фильтр Graph Manager строит часть графа.
3.  Приложение создает весь граф.

**фильтр Graph Manager выполняет сборку всего Graph**

Если нужно просто воспроизвести файл, созданный в известном формате, например AVI, MPEG, WAV или MP3, используйте метод **RenderFile** . В статье [как воспроизвести файл](how-to-play-a-file.md) показано, как это сделать.

Метод **RenderFile** начинается с просмотра в реестре исходного фильтра, который может проанализировать файл. Он использует протокол (например `https://` , в URL-адресе), расширение файла или предварительно определенные шаблоны байтов в файле для определения фильтра источника. Дополнительные сведения см. [в разделе Регистрация пользовательского типа файлов](registering-a-custom-file-type.md).

чтобы построить оставшуюся часть графа, диспетчер Graph Manager использует итеративный процесс, где он принимает типы мультимедиа, поддерживаемые фильтром, на закреплениях вывода, а также выполняет поиск фильтров в реестре, которые принимают этот тип мультимедиа в качестве входных данных. Он использует несколько критериев, чтобы сократить количество фильтров поиска и приоритизации:

-   *Категория фильтра* определяет общие функциональные возможности фильтра.
-   Тип носителя описывает, какие данные может принимать фильтр в качестве входных данных или доставки в качестве выходных данных.
-   Неудача *определяет порядок* , в котором будут применяться фильтры. если два фильтра в одной и той же категории фильтров поддерживают одни и те же входные типы, фильтр Graph Manager выбирает его с наибольшим значением. Некоторым фильтрам назначено небольшое значение, поскольку они предназначены для специализированных целей и должны добавляться только в граф приложения.

фильтр Graph Manager использует объект [сопоставителя фильтров](filter-mapper.md) для поиска в реестре.

при добавлении каждого фильтра диспетчер Graph Manager пытается подключить его к выходному пин-коду предыдущего фильтра. Фильтры согласовываются, чтобы определить, могут ли они подключаться, и, если да, какой тип носителя использовать для соединения. если новый фильтр не может подключиться, фильтр Graph диспетчер отклоняет его и пытается выполнить другой фильтр. Этот процесс продолжится до подготовки каждого потока.

**фильтр Graph Manager создает часть Graph**

Чтобы сделать что-то, помимо простого воспроизведения файла, приложение должно выполнить по крайней мере некоторые операции построения графа. Например, приложение для записи видео должно выбрать фильтр источника захвата и добавить его в граф. Если данные записываются в файл AVI, на диаграмму необходимо добавить фильтры мультиплексора и модуль записи файлов AVI. однако часто можно позволить фильтру Graph Manager завершить граф. Например, можно отобразить ПИН-код для предварительного просмотра, вызвав метод **Render** .

**Приложение создает весь Graph**

В некоторых сценариях приложению может потребоваться построить граф, добавив и подключив каждый фильтр. В этом случае, возможно, вам известно, какие фильтры следует добавить к диаграмме. при таком подходе приложение добавляет каждый фильтр путем вызова **аддфилтер**, перечисляет контакты в фильтрах и подключает их, вызывая либо **Подключение** , либо **коннектдирект**.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[построение диаграмм с помощью построителя Graph Capture](building-graphs-with-the-capture-graph-builder.md)
</dt> <dt>

[Перечисление устройств и фильтров](enumerating-devices-and-filters.md)
</dt> <dt>

[Перечисление объектов в фильтре Graph](enumerating-objects-in-a-filter-graph.md)
</dt> <dt>

[Общие методы Graph-Building](general-graph-building-techniques.md)
</dt> <dt>

[Создание фильтра Graph](building-the-filter-graph.md)
</dt> </dl>

 

 



