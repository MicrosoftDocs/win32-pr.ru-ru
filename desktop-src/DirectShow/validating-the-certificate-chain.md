---
description: Проверка цепочки сертификатов
ms.assetid: e0c36f04-1694-40d8-94a1-06ee7de08777
title: Проверка цепочки сертификатов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 13436513ae9199feb7ba5fcba399537da198ba85
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104265259"
---
# <a name="validating-the-certificate-chain"></a><span data-ttu-id="f912c-103">Проверка цепочки сертификатов</span><span class="sxs-lookup"><span data-stu-id="f912c-103">Validating the Certificate Chain</span></span>

<span data-ttu-id="f912c-104">В этом разделе описано, как проверить цепочку сертификатов драйвера при использовании протокола сертифицированной выходной защиты (Копп).</span><span class="sxs-lookup"><span data-stu-id="f912c-104">This topic describes how to validate the driver's certificate chain when using Certified Output Protection Protocol (COPP).</span></span>

<span data-ttu-id="f912c-105">Цепочка сертификатов графического драйвера — это XML-документ.</span><span class="sxs-lookup"><span data-stu-id="f912c-105">The graphic driver's certificate chain is an XML document.</span></span> <span data-ttu-id="f912c-106">Цепочка сертификатов содержит три сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-106">The certificate chain contains three certificates.</span></span> <span data-ttu-id="f912c-107">Первый сертификат называется *конечным сертификатом*, а — сертификатом Копп драйвера.</span><span class="sxs-lookup"><span data-stu-id="f912c-107">The first certificate is called the *leaf certificate*, and is the driver's COPP certificate.</span></span> <span data-ttu-id="f912c-108">Следующий сертификат является сертификатом подписи независимого поставщика оборудования (IHV).</span><span class="sxs-lookup"><span data-stu-id="f912c-108">The next certificate is the signing certificate of the Independent Hardware Vendor (IHV).</span></span> <span data-ttu-id="f912c-109">Последний сертификат — сертификат подписи Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="f912c-109">The last certificate is Microsoft's signing certificate.</span></span> <span data-ttu-id="f912c-110">Чтобы убедиться, что графический драйвер является легальным устройством Копп, приложение должно проверить все три из этих сертификатов.</span><span class="sxs-lookup"><span data-stu-id="f912c-110">To ensure that the graphics driver is a legitimate COPP device, the application must validate all three of these certificates.</span></span> <span data-ttu-id="f912c-111">Вредоносная программа может препятствовать работе Копп, если приложение неправильно проверяет сертификаты в цепочке.</span><span class="sxs-lookup"><span data-stu-id="f912c-111">A malicious program can prevent COPP from working if an application does not correctly validate the certificates in the chain.</span></span>

<span data-ttu-id="f912c-112">Цепочки сертификатов Копп используют кодировку UTF-8.</span><span class="sxs-lookup"><span data-stu-id="f912c-112">COPP certificate chains use the UTF-8 character set.</span></span> <span data-ttu-id="f912c-113">Двоичные данные в сертификатах, например открытый ключ RSA, кодируются в кодировке Base64 и хранятся в порядке с обратным порядком байтов.</span><span class="sxs-lookup"><span data-stu-id="f912c-113">Binary data in the certificates, such as the RSA public key, are base64-encoded and stored in big-endian order.</span></span> <span data-ttu-id="f912c-114">(*Big-endian* означает, что наиболее значимый байт хранится в памяти с наименьшим адресом.)</span><span class="sxs-lookup"><span data-stu-id="f912c-114">(*Big-endian* means that the most significant byte is stored in the memory location with the lowest address.)</span></span>

<span data-ttu-id="f912c-115">Некоторые элементы в сертификате содержат логические значения, которые указывают на существование компонента сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-115">Some elements within a certificate contain Boolean values to denote that a feature of the certificate exists.</span></span> <span data-ttu-id="f912c-116">Если функция существует, соответствующему дочернему элементу присваивается значение 1.</span><span class="sxs-lookup"><span data-stu-id="f912c-116">If the feature exists, the corresponding child element value is set to 1.</span></span> <span data-ttu-id="f912c-117">Если компонент отсутствует, этот дочерний элемент отсутствует в сертификате.</span><span class="sxs-lookup"><span data-stu-id="f912c-117">If a feature is not present, that child element is not present in the certificate.</span></span>

### <a name="xml-element-definitions"></a><span data-ttu-id="f912c-118">Определения XML-элементов</span><span class="sxs-lookup"><span data-stu-id="f912c-118">XML Element Definitions</span></span>

<span data-ttu-id="f912c-119">Ниже приведены определения для элементов в схеме сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-119">The following are definitions for elements in the certificate schema:</span></span>

-   <span data-ttu-id="f912c-120">**Цертификатеколлектион**.</span><span class="sxs-lookup"><span data-stu-id="f912c-120">**CertificateCollection**.</span></span> <span data-ttu-id="f912c-121">Корневой элемент XML-документа.</span><span class="sxs-lookup"><span data-stu-id="f912c-121">The root element of the XML document.</span></span> <span data-ttu-id="f912c-122">Он содержит элементы сертификата, по одному для каждого сертификата в цепочке.</span><span class="sxs-lookup"><span data-stu-id="f912c-122">It contains Certificate elements, one for each certificate in the chain.</span></span>
-   <span data-ttu-id="f912c-123">**Сертификат**.</span><span class="sxs-lookup"><span data-stu-id="f912c-123">**Certificate**.</span></span> <span data-ttu-id="f912c-124">Содержит один сертификат.</span><span class="sxs-lookup"><span data-stu-id="f912c-124">Contains one certificate.</span></span> <span data-ttu-id="f912c-125">Этот элемент содержит данные и элементы сигнатуры.</span><span class="sxs-lookup"><span data-stu-id="f912c-125">This element contains Data and Signature elements.</span></span>
-   <span data-ttu-id="f912c-126">**Данные**.</span><span class="sxs-lookup"><span data-stu-id="f912c-126">**Data**.</span></span> <span data-ttu-id="f912c-127">Содержит сведения о сертификате.</span><span class="sxs-lookup"><span data-stu-id="f912c-127">Contains information about the certificate.</span></span> <span data-ttu-id="f912c-128">В частности, он содержит открытый ключ сертификата и тип.</span><span class="sxs-lookup"><span data-stu-id="f912c-128">In particular, it contains the certificate's public key and type.</span></span> <span data-ttu-id="f912c-129">Элемент Data содержит следующие дочерние элементы:</span><span class="sxs-lookup"><span data-stu-id="f912c-129">The Data element contains the following child elements:</span></span>
    -   <span data-ttu-id="f912c-130">**PublicKey**.</span><span class="sxs-lookup"><span data-stu-id="f912c-130">**PublicKey**.</span></span> <span data-ttu-id="f912c-131">Содержит открытый ключ RSA сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-131">Contains the certificate's RSA public key.</span></span> <span data-ttu-id="f912c-132">Элемент PublicKey содержит элемент KeyValue, который содержит элемент Рсакэйвалуе.</span><span class="sxs-lookup"><span data-stu-id="f912c-132">The PublicKey element contains a KeyValue element, which contains an RSAKeyValue element.</span></span> <span data-ttu-id="f912c-133">У элемента Рсакэйвалуе есть два дочерних элемента, модуль и экспонента, и они определяют открытый ключ.</span><span class="sxs-lookup"><span data-stu-id="f912c-133">The RSAKeyValue element has two child elements, Modulus and Exponent, and these define the public key.</span></span> <span data-ttu-id="f912c-134">Элементы модуля и экспоненты кодируются в кодировке Base64 и хранятся в порядке с обратным порядком байтов.</span><span class="sxs-lookup"><span data-stu-id="f912c-134">The Modulus and Exponent elements are base64-encoded and stored in big-endian order.</span></span>
    -   <span data-ttu-id="f912c-135">**Кэйусаже**.</span><span class="sxs-lookup"><span data-stu-id="f912c-135">**KeyUsage**.</span></span> <span data-ttu-id="f912c-136">Если сертификат является сертификатом Копп драйвера, этот элемент должен содержать дочерний элемент с именем Енкрипткэй.</span><span class="sxs-lookup"><span data-stu-id="f912c-136">If the certificate is the driver's COPP certificate, this element should contain a child element called EncryptKey.</span></span> <span data-ttu-id="f912c-137">Если сертификат является сертификатом подписи независимого поставщика оборудования или сертификатом подписи Майкрософт, он должен содержать дочерний элемент с именем Сигнцертификате.</span><span class="sxs-lookup"><span data-stu-id="f912c-137">If the certificate is the IHV's signing certificate or Microsoft's signing certificate, it should contain a child element called SignCertificate.</span></span> <span data-ttu-id="f912c-138">Оба этих дочерних элемента содержат логические значения.</span><span class="sxs-lookup"><span data-stu-id="f912c-138">Both of these child elements contain Boolean values.</span></span>
    -   <span data-ttu-id="f912c-139">**Секуритилевел**.</span><span class="sxs-lookup"><span data-stu-id="f912c-139">**SecurityLevel**.</span></span> <span data-ttu-id="f912c-140">Этот элемент следует игнорировать.</span><span class="sxs-lookup"><span data-stu-id="f912c-140">This element should be ignored.</span></span>
    -   <span data-ttu-id="f912c-141">**Мануфактурердата**.</span><span class="sxs-lookup"><span data-stu-id="f912c-141">**ManufacturerData**.</span></span> <span data-ttu-id="f912c-142">Указывает изготовителя и модель графического устройства.</span><span class="sxs-lookup"><span data-stu-id="f912c-142">Specifies the manufacturer and model of the graphics device.</span></span> <span data-ttu-id="f912c-143">Этот элемент является только информационным.</span><span class="sxs-lookup"><span data-stu-id="f912c-143">This element is informational only.</span></span>
    -   <span data-ttu-id="f912c-144">**Features**.</span><span class="sxs-lookup"><span data-stu-id="f912c-144">**Features**.</span></span> <span data-ttu-id="f912c-145">Содержит дочерние элементы, которые указывают на использование сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-145">Contains child elements that specify the usage of the certificate.</span></span> <span data-ttu-id="f912c-146">Единственным, что относится к Копп, является элемент Коппцертификате.</span><span class="sxs-lookup"><span data-stu-id="f912c-146">The only one relevant to COPP is the COPPCertificate element.</span></span> <span data-ttu-id="f912c-147">Могут присутствовать другие дочерние элементы; Если это так, их следует игнорировать.</span><span class="sxs-lookup"><span data-stu-id="f912c-147">Other child elements might be present; if so, they should be ignored.</span></span> <span data-ttu-id="f912c-148">Если элемент Коппцертификате существует, сертификат является сертификатом Копп.</span><span class="sxs-lookup"><span data-stu-id="f912c-148">If the COPPCertificate element exists, the certificate is a COPP certificate.</span></span> <span data-ttu-id="f912c-149">Этот элемент должен присутствовать в конечном узле допустимого сертификата Копп.</span><span class="sxs-lookup"><span data-stu-id="f912c-149">This element must be present in the leaf node of a valid COPP certificate.</span></span> <span data-ttu-id="f912c-150">Этот элемент содержит логическое значение.</span><span class="sxs-lookup"><span data-stu-id="f912c-150">This element contains a Boolean value.</span></span>
-   <span data-ttu-id="f912c-151">**Сигнатура**.</span><span class="sxs-lookup"><span data-stu-id="f912c-151">**Signature**.</span></span> <span data-ttu-id="f912c-152">Содержит подпись для этого сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-152">Contains the signature for this certificate.</span></span> <span data-ttu-id="f912c-153">Он содержит следующие дочерние элементы:</span><span class="sxs-lookup"><span data-stu-id="f912c-153">It contains the following child elements:</span></span>
    -   <span data-ttu-id="f912c-154">**SignedInfo**.</span><span class="sxs-lookup"><span data-stu-id="f912c-154">**SignedInfo**.</span></span> <span data-ttu-id="f912c-155">Содержит сведения о сигнатуре.</span><span class="sxs-lookup"><span data-stu-id="f912c-155">Contains information about the signature.</span></span> <span data-ttu-id="f912c-156">Важным дочерним элементом этого элемента является элемент Дижествалуе, который содержит значение хэша SHA-1 в кодировке Base64 для элемента данных.</span><span class="sxs-lookup"><span data-stu-id="f912c-156">The important child element of this element is the DigestValue element, which contains the base64-encoded value of the SHA-1 hash over the Data element.</span></span> <span data-ttu-id="f912c-157">Значение дайджеста используется при проверке сертификата по списку отзыва сертификатов (CRL).</span><span class="sxs-lookup"><span data-stu-id="f912c-157">The digest value is used when checking the certificate against the certificate revocation list (CRL).</span></span>
    -   <span data-ttu-id="f912c-158">**Сигнатуревалуе**.</span><span class="sxs-lookup"><span data-stu-id="f912c-158">**SignatureValue**.</span></span> <span data-ttu-id="f912c-159">Это значение вычислено для элемента данных и вычислено в соответствии со схемой цифровых подписей РСАССА-PSS, определенной в Public-Key криптографических стандартах (PKCS) \# 1 (версия 2,1).</span><span class="sxs-lookup"><span data-stu-id="f912c-159">This value is computed over the Data element and is computed according to the RSASSA-PSS digital signature scheme defined in Public-Key Cryptography Standards (PKCS) \#1 (version 2.1).</span></span> <span data-ttu-id="f912c-160">Сведения о PKCS \# 1 см. в статье [https://www.rsa.com/](https://www.rsa.com/) .</span><span class="sxs-lookup"><span data-stu-id="f912c-160">For information about PKCS \#1, visit [https://www.rsa.com/](https://www.rsa.com/).</span></span>
    -   <span data-ttu-id="f912c-161">**KeyInfo**.</span><span class="sxs-lookup"><span data-stu-id="f912c-161">**KeyInfo**.</span></span> <span data-ttu-id="f912c-162">Содержит открытый ключ RSA следующего сертификата в цепочке.</span><span class="sxs-lookup"><span data-stu-id="f912c-162">Contains the RSA public key of the next certificate in the chain.</span></span> <span data-ttu-id="f912c-163">Этот элемент используется для проверки того, что данные в элементе Data не были изменены.</span><span class="sxs-lookup"><span data-stu-id="f912c-163">This element is used to verify that the data in the Data element has not been tampered with.</span></span> <span data-ttu-id="f912c-164">Этот элемент имеет тот же формат, что и элемент PublicKey.</span><span class="sxs-lookup"><span data-stu-id="f912c-164">This element has the same format as the PublicKey element.</span></span>

### <a name="certificate-validation"></a><span data-ttu-id="f912c-165">Проверка сертификата</span><span class="sxs-lookup"><span data-stu-id="f912c-165">Certificate Validation</span></span>

<span data-ttu-id="f912c-166">Чтобы правильно проверить цепочку сертификатов, приложение должно выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="f912c-166">The application must perform the following steps to correctly validate the certificate chain.</span></span> <span data-ttu-id="f912c-167">В случае сбоя любого из шагов или если какой либо элемент, на который ссылается в этих процедурах, не существует, проверка завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="f912c-167">If any step fails, or if any element referred to in these procedures does not exist, the validation fails.</span></span>

### <a name="validate-certificate-collection-procedure"></a><span data-ttu-id="f912c-168">Процедура проверки коллекции сертификатов</span><span class="sxs-lookup"><span data-stu-id="f912c-168">Validate Certificate Collection Procedure</span></span>

<span data-ttu-id="f912c-169">Чтобы проверить цепочку сертификатов, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="f912c-169">To validate the certificate chain, perform the following steps:</span></span>

1.  <span data-ttu-id="f912c-170">Убедитесь, что Цертификатеколлектион имеет правильный формат XML.</span><span class="sxs-lookup"><span data-stu-id="f912c-170">Verify that the CertificateCollection is well-formed XML.</span></span>
2.  <span data-ttu-id="f912c-171">Убедитесь, что Цертификатеколлектион кодируется в формате UTF-8.</span><span class="sxs-lookup"><span data-stu-id="f912c-171">Verify that the CertificateCollection is encoded in UTF-8 format.</span></span>
3.  <span data-ttu-id="f912c-172">Убедитесь, что атрибут Version в элементе Цертификатеколлектион имеет значение 2,0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="f912c-172">Check that the Version attribute in the CertificateCollection element is 2.0 or later.</span></span>
4.  <span data-ttu-id="f912c-173">Убедитесь, что цепочка сертификатов содержит ровно три элемента сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-173">Verify that the certificate chain contains exactly three Certificate elements.</span></span>
5.  <span data-ttu-id="f912c-174">Пройдите по каждому элементу сертификата в цепочке сертификатов и выполните процедуру проверки сертификата, описанную ниже, для каждой из них.</span><span class="sxs-lookup"><span data-stu-id="f912c-174">Loop through each Certificate element in the certificate chain and perform the Validate Certificate procedure, described below, on each.</span></span>

### <a name="validate-certificate-procedure"></a><span data-ttu-id="f912c-175">Процедура проверки сертификата</span><span class="sxs-lookup"><span data-stu-id="f912c-175">Validate Certificate Procedure</span></span>

<span data-ttu-id="f912c-176">Чтобы проверить сертификат в цепочке, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="f912c-176">To validate a certificate in the chain, perform the following steps:</span></span>

1.  <span data-ttu-id="f912c-177">Убедитесь, что ни один из дочерних элементов в элементе Data не повторяется.</span><span class="sxs-lookup"><span data-stu-id="f912c-177">Verify that none of the child elements in the Data element is duplicated.</span></span> <span data-ttu-id="f912c-178">Например, должен быть только один элемент PublicKey.</span><span class="sxs-lookup"><span data-stu-id="f912c-178">For example, there should be only one PublicKey element.</span></span>
2.  <span data-ttu-id="f912c-179">Убедитесь, что элемент Data/PublicKey/KeyValue/Рсакэйвалуе/модуль существует.</span><span class="sxs-lookup"><span data-stu-id="f912c-179">Ensure that the Data/PublicKey/KeyValue/RSAKeyValue/Modulus element exists.</span></span> <span data-ttu-id="f912c-180">Значение декодированной Base64 должно быть 256 байт для всех сертификатов, кроме корневого.</span><span class="sxs-lookup"><span data-stu-id="f912c-180">The base64-decoded value must be 256 bytes long for all certificates except the root.</span></span> <span data-ttu-id="f912c-181">В корневом сертификате этот элемент должен иметь длину 128 байт.</span><span class="sxs-lookup"><span data-stu-id="f912c-181">In the root certificate, this element must be 128 bytes long.</span></span>
3.  <span data-ttu-id="f912c-182">Убедитесь, что элемент Data/PublicKey/KeyValue/Рсакэйвалуе/экспонента существует.</span><span class="sxs-lookup"><span data-stu-id="f912c-182">Ensure that the Data/PublicKey/KeyValue/RSAKeyValue/Exponent element exists.</span></span> <span data-ttu-id="f912c-183">Декодированное значение Base64 не должно быть больше 4 байт.</span><span class="sxs-lookup"><span data-stu-id="f912c-183">The base64-decoded value must not be larger than 4 bytes.</span></span>
4.  <span data-ttu-id="f912c-184">Если этот сертификат является конечным, проверьте следующее:</span><span class="sxs-lookup"><span data-stu-id="f912c-184">If this certificate is the leaf certificate, verify the following:</span></span>
    -   <span data-ttu-id="f912c-185">Элемент Кэйусаже содержит элемент Енкрипткэй со значением 1.</span><span class="sxs-lookup"><span data-stu-id="f912c-185">The KeyUsage element contains an EncryptKey element with the value 1.</span></span>
    -   <span data-ttu-id="f912c-186">Элемент features содержит элемент Коппцертификате со значением 1.</span><span class="sxs-lookup"><span data-stu-id="f912c-186">The Features element contains a COPPCertificate element with the value 1.</span></span>
5.  <span data-ttu-id="f912c-187">Если этот сертификат не является конечным сертификатом, проверьте следующее:</span><span class="sxs-lookup"><span data-stu-id="f912c-187">If this certificate is not the leaf certificate, verify the following:</span></span>
    -   <span data-ttu-id="f912c-188">Модуль и показатель степени из элемента Data/PublicKey точно соответствуют модулю и экспоненте из элемента Signature/KeyInfo предыдущего сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-188">The modulus and exponent from the Data/PublicKey element exactly match the modulus and exponent from the Signature/KeyInfo element of the previous certificate.</span></span>
    -   <span data-ttu-id="f912c-189">Элемент Кэйусаже содержит элемент Сигнцертификате со значением 1.</span><span class="sxs-lookup"><span data-stu-id="f912c-189">The KeyUsage element contains a SignCertificate element, with the value 1.</span></span>
6.  <span data-ttu-id="f912c-190">Используйте хэш-алгоритм SHA-1 для хэширования каждого байта в элементе данных сертификата.</span><span class="sxs-lookup"><span data-stu-id="f912c-190">Use the SHA-1 hash algorithm to hash every byte in the certificate's Data element.</span></span> <span data-ttu-id="f912c-191">Каждый байт из первого символа в <Data> теге к последнему символу в закрывающем </Data> теге должен быть хэширован.</span><span class="sxs-lookup"><span data-stu-id="f912c-191">Every byte from the first character in the <Data> tag to the last character in the closing </Data> tag should be hashed.</span></span> <span data-ttu-id="f912c-192">Хэш-значение используется для проверки сертификата по списку отзыва сертификатов (CRL), как описано в [списках отзыва сертификатов](certificate-revocation-lists.md) .</span><span class="sxs-lookup"><span data-stu-id="f912c-192">The hash value is used to check the certificate against the certificate revocation list (CRL), as described in [Certificate Revocation Lists](certificate-revocation-lists.md)</span></span>
7.  <span data-ttu-id="f912c-193">Сравните значение хэша из шага 6 с декодированным значением SignedInfo/Reference/Дижествалуе в формате Base64.</span><span class="sxs-lookup"><span data-stu-id="f912c-193">Compare the hash value from step 6 with the base64-decoded value of the Signature/SignedInfo/Reference/DigestValue element.</span></span> <span data-ttu-id="f912c-194">Эти значения должны совпадать.</span><span class="sxs-lookup"><span data-stu-id="f912c-194">These values must match.</span></span>
8.  <span data-ttu-id="f912c-195">Выполните процедуру проверки подписи, описанную ниже.</span><span class="sxs-lookup"><span data-stu-id="f912c-195">Perform the Verify Signature procedure, described below.</span></span>
9.  <span data-ttu-id="f912c-196">Если этот сертификат не является окончательным сертификатом в цепочке, сохраните значение Signature/KeyInfo/KeyValue/Рсакэйвалуе для следующей итерации цикла.</span><span class="sxs-lookup"><span data-stu-id="f912c-196">If this certificate is not the final certificate in the chain, save the Signature/KeyInfo/KeyValue/RSAKeyValue value for the next iteration of the loop.</span></span>
10. <span data-ttu-id="f912c-197">Если этот сертификат является окончательным сертификатом в цепочке, убедитесь, что значение Signature/KeyInfo/KeyValue/Рсакэйвалуе соответствует открытому ключу Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="f912c-197">If this certificate is the final certificate in the chain, ensure that the value of Signature/KeyInfo/KeyValue/RSAKeyValue matches Microsoft's public key.</span></span> <span data-ttu-id="f912c-198">Открытый ключ Майкрософт имеет следующие значения в кодировке Base64:</span><span class="sxs-lookup"><span data-stu-id="f912c-198">The Microsoft public key has the following base64-encoded values:</span></span>
    -   <span data-ttu-id="f912c-199">Модул</span><span class="sxs-lookup"><span data-stu-id="f912c-199">Modulus:</span></span>

        `pjoeWLSTLDonQG8She6QhkYbYott9fPZ8tHdB128ZETcghn5KHoyin7HkJEcPJ0Eg4UdSv a0KDIYDjA3EXd69R3CN2Wp/QyOo0ZPYWYp3NXpJ700tKPgIplzo5wVd/69g7j+j8M66W7V NmDwaNs9mDc1p2+VVMsDhOsV/Au6E+E=`

    -   <span data-ttu-id="f912c-200">Числа `AQAB`</span><span class="sxs-lookup"><span data-stu-id="f912c-200">Exponent: `AQAB`</span></span>

### <a name="verify-signature-procedure"></a><span data-ttu-id="f912c-201">Проверка процедуры подписи</span><span class="sxs-lookup"><span data-stu-id="f912c-201">Verify Signature Procedure</span></span>

<span data-ttu-id="f912c-202">Значение элемента Сигнатуревалуе вычислено для элемента данных в соответствии со схемой цифровых подписей РСАССА-PSS, определенной в PKCS \# 1 версии 2,1 (здесь и далее НАЗЫВАЕТСЯ PKCS).</span><span class="sxs-lookup"><span data-stu-id="f912c-202">The value of the SignatureValue element is computed over the Data element according to the RSASSA-PSS digital signature scheme defined in PKCS \#1 version 2.1 (hereinafter referred to as PKCS).</span></span> <span data-ttu-id="f912c-203">Чтобы проверить эту подпись, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="f912c-203">To verify this signature, perform the following steps:</span></span>

1.  <span data-ttu-id="f912c-204">Декодирование значений модуля и экспоненты в элементе Signature/KeyInfo/KeyValue/Рсакэйвалуе.</span><span class="sxs-lookup"><span data-stu-id="f912c-204">Decode the Modulus and Exponent values in the Signature/KeyInfo/KeyValue/RSAKeyValue element.</span></span> <span data-ttu-id="f912c-205">Эти значения определяют открытый ключ RSA сертификата подписи.</span><span class="sxs-lookup"><span data-stu-id="f912c-205">These values define the RSA public key of the signing certificate.</span></span>
2.  <span data-ttu-id="f912c-206">Декодирование элемента Signature/Сигнатуревалуе.</span><span class="sxs-lookup"><span data-stu-id="f912c-206">Decode the Signature/SignatureValue element.</span></span>
3.  <span data-ttu-id="f912c-207">Вычислите операцию РСАССА-PSS-Verify, определенную в разделе BIND 8.1.2 файла PKCS.</span><span class="sxs-lookup"><span data-stu-id="f912c-207">Compute the RSASSA-PSS-Verify operation, defined in section 8.1.2 of PKCS.</span></span>

<span data-ttu-id="f912c-208">Для операции РСАССА-PSS-Verify используйте следующие входные данные:</span><span class="sxs-lookup"><span data-stu-id="f912c-208">For the RSASSA-PSS-Verify operation, use the following inputs:</span></span>

-   <span data-ttu-id="f912c-209">(*n*,*e*) — это открытый ключ из шага 1.</span><span class="sxs-lookup"><span data-stu-id="f912c-209">(*n*,*e*) is the public key from step 1.</span></span>
-   <span data-ttu-id="f912c-210">*M* — все байты в элементе Data, включая теги <Data> и</Data> , которые заключают элемент.</span><span class="sxs-lookup"><span data-stu-id="f912c-210">*M* is all of the bytes in the Data element, including the <Data> and </Data> tags that enclose the element.</span></span>
-   <span data-ttu-id="f912c-211">*S* — это декодированное значение сигнатуры из шага 2.</span><span class="sxs-lookup"><span data-stu-id="f912c-211">*S* is the decoded signature value from step 2.</span></span>

<span data-ttu-id="f912c-212">Операция РСАССА-PSS-Verify использует операцию ЕМСА-PSS-ENCODED, определенную в разделе 9.1.1.</span><span class="sxs-lookup"><span data-stu-id="f912c-212">The RSASSA-PSS-Verify operation uses the EMSA-PSS-ENCODE operation, defined in section 9.1.1.</span></span> <span data-ttu-id="f912c-213">из PKCS.</span><span class="sxs-lookup"><span data-stu-id="f912c-213">of PKCS.</span></span> <span data-ttu-id="f912c-214">Для этой операции Копп использует следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="f912c-214">For this operation, COPP uses the following options:</span></span>

-   <span data-ttu-id="f912c-215">Hash = SHA-1</span><span class="sxs-lookup"><span data-stu-id="f912c-215">Hash = SHA-1</span></span>
-   <span data-ttu-id="f912c-216">*хлен* = 20</span><span class="sxs-lookup"><span data-stu-id="f912c-216">*hLen* = 20</span></span>
-   <span data-ttu-id="f912c-217">МГФ (функция формирования маски) = ГЕНЕРАЦИИ маски MGF1</span><span class="sxs-lookup"><span data-stu-id="f912c-217">MGF (mask generation function) = MGF1</span></span>
-   <span data-ttu-id="f912c-218">*слен* = 0</span><span class="sxs-lookup"><span data-stu-id="f912c-218">*sLen* = 0</span></span>

<span data-ttu-id="f912c-219">Функция создания маски ГЕНЕРАЦИИ маски MGF1 определена в приложении B. 2 из PKCS.</span><span class="sxs-lookup"><span data-stu-id="f912c-219">The mask generation function MGF1 is defined in Appendix B.2 of PKCS.</span></span> <span data-ttu-id="f912c-220">Для этой функции Копп использует следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="f912c-220">For this function, COPP uses the following options:</span></span>

-   <span data-ttu-id="f912c-221">Hash = SHA-1</span><span class="sxs-lookup"><span data-stu-id="f912c-221">Hash = SHA-1</span></span>
-   <span data-ttu-id="f912c-222">*хлен* = 20</span><span class="sxs-lookup"><span data-stu-id="f912c-222">*hLen* = 20</span></span>

<span data-ttu-id="f912c-223">Выходные данные операции РСАССА-PSS-Verify указывают, является ли подпись допустимой или недопустимой.</span><span class="sxs-lookup"><span data-stu-id="f912c-223">The output of the RSASSA-PSS-Verify operation indicates whether the signature is valid or invalid.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f912c-224">См. также</span><span class="sxs-lookup"><span data-stu-id="f912c-224">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f912c-225">Использование протокола сертифицированной выходной защиты (Копп)</span><span class="sxs-lookup"><span data-stu-id="f912c-225">Using Certified Output Protection Protocol (COPP)</span></span>](using-certified-output-protection-protocol--copp.md)
</dt> </dl>

 

 



