---
description: Типы видео H. 264
ms.assetid: aa3166b2-6b04-44fa-bc9d-c8ff46f99201
title: Типы видео H. 264
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 692a751e197e2e7bbb088b30dd2a3f5f199d56de
ms.sourcegitcommit: 63753fcfb0afbbe5ec283fb8316e62c2dc950f66
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2021
ms.locfileid: "107909022"
---
# <a name="h264-video-types"></a>Типы видео H. 264

Для видео H. 264 определены следующие подтипы мультимедиа.



| Subtype                | FOURCC | Описание                                                    |
|------------------------|--------|----------------------------------------------------------------|
| **МЕДИАСУБТИПЕ \_ AVC1** | 'AVC1' | H. 264 битовый поток без начальных кодов.                           |
| **МЕДИАСУБТИПЕ \_ H264 Single bitrate** | H264 Single bitrate | H. 264 битовый поток с начальными кодами.                              |
| **МЕДИАСУБТИПЕ \_ H264 Single bitrate** | H264 Single bitrate | Эквивалентно **медиасубтипе \_ H264 Single bitrate** с другим FourCC. |
| **МЕДИАСУБТИПЕ \_ X264** | 'X264' | Эквивалентно **медиасубтипе \_ H264 Single bitrate** с другим FourCC. |
| **МЕДИАСУБТИПЕ \_ x264** | 'x264' | Эквивалентно **медиасубтипе \_ H264 Single bitrate** с другим FourCC. |



 

Эти идентификаторы GUID подтипа объявляются в вмкодекдсп. h.

Основное различие между этими типами носителей заключается в наличии начальных кодов в битовый поток. Если подтип имеет значение **медиасубтипе \_ AVC1**, битовый поток не содержит начальных кодов.

### <a name="h264-bitstream-with-start-codes"></a>H. 264 битовый поток с начальными кодами

H. 264 битстреамс, передаваемые по воздуху или содержащиеся в программе MPEG-2 или в потоках транспорта или записанных на HD-DVD, форматируются в соответствии с описанием в приложении B из ITU-T Rec. H. 264. В соответствии с этой спецификацией битовый поток состоит из последовательности единиц уровня абстракции сети (Налус), каждый из которых имеет префикс начального кода, равный 0x000001 или 0x00000001.

Если в битовый поток имеются начальные коды, используется следующий тип носителя:



| Метка | Значение |
|-------------|---------------------------------------------------------------------------------------------------|
| Основной тип  | **\_Видео MEDIATYPE**                                                                              |
| Подтипы    | **Медиасубтипе \_ H264 Single bitrate**, **медиасубтипе \_ H264 Single bitrate**, **медиасубтипе \_ X264** или **медиасубтипе \_ X264** |
| Тип формата | **Формат \_ Видеоинфо**, **Format \_ VideoInfo2**, **Format \_ MPEG2Video** или **GUID \_ null**          |



 

Если тип формата — **GUID \_ null**, структура формата отсутствует.

Если битовый поток содержит начальные коды, все типы форматов, перечисленные здесь, достаточно, поскольку декодеру не требуются дополнительные сведения для синтаксического анализа потока. Битовый поток уже содержит всю информацию, необходимую декодеру, а коды запуска позволяют декодеру определять начало каждого налу.

Следующие подтипы эквивалентны:

### <a name="h264-bitstream-without-start-codes"></a>H. 264 битовый поток без начальных кодов

Формат контейнера MP4 хранит данные H. 264 без начальных кодов. Вместо этого каждый налу имеет префикс в поле длины, который задает длину налу в байтах. Размер поля Длина может быть разным, но обычно это 1, 2 или 4 байта.

Если в битовый поток отсутствуют начальные коды, используется следующий тип носителя.



| Метка | Значение |
|-------------|------------------------|
| Основной тип  | **\_Видео MEDIATYPE**   |
| Subtype     | **МЕДИАСУБТИПЕ \_ AVC1** |
| Тип формата | **ФОРМАТ \_ MPEG2Video** |



 

Блок формата является структурой [**MPEG2VIDEOINFO**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-mpeg2videoinfo) . Эта структура должна быть заполнена следующим образом:

-   **HDR**: структура [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) , описывающая битовый поток. После [**битмапинфохеадер**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) части структуры отсутствует таблица цветов, а **биклрусед** должна быть равна нулю.
-   **двстарттимекоде**: не используется. Задайте нулевое значение.
-   **кбсекуенцехеадер**: длина массива **двсекуенцехеадер** в байтах.
-   **двпрофиле**: указывает профиль H. 264.
-   **двлевел**: указывает уровень H. 264.
-   **dwFlags**: число байтов, используемых для поля length, которое появляется перед каждым **налу**. Поле Длина указывает размер следующего налу в байтах. Например, если **dwFlags** имеет значение 4, то каждому налуу предшествует 4-байтовое поле длины. Допустимые значения: 1, 2 и 4.
-   **двсекуенцехеадер**: массив байтов, который может содержать набор параметров последовательности (SPS) и набор параметров Picture (PPS) налус.

Контейнер MP4 может содержать наборы параметров последовательности (SPS) или наборы параметров изображений (PPS) в виде специальных единиц NAL в заголовках файлов или в отдельном потоке (отличном от видеопотока). При установке формата тип носителя может указывать единицы SPS и PPS NAL в массиве **двсекуенцехеадер** . Если **кбсекуенцехеадер** больше нуля, **двсекуенцехеадер** является началом массива байтов, содержащего SPS и PPS налус, разделенных полями длиной в 2 байта, все в сетевом порядке байтов (Big-endian). Можно использовать как SPS, так и PPS, либо только один из этих типов, либо None. Реальный тип каждого налу можно определить с помощью проверки поля **\_ \_ типа "NAL** " в самом налу.

При использовании этого типа носителя каждый пример носителя начинается в начале налу, а NAL-единицы не охватывают образцы. Это позволяет декодеру восстанавливать данные из поврежденных или пропущенных примеров.

 

 



