---
description: Фильтр модуля записи WM ASF
ms.assetid: 1b12f65f-8d77-4d38-aad9-92bb15cc0426
title: Фильтр модуля записи WM ASF (DirectShow)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0bf09a99673b07e88198fd57b95a766ce821eb02
ms.sourcegitcommit: 63753fcfb0afbbe5ec283fb8316e62c2dc950f66
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2021
ms.locfileid: "107909282"
---
# <a name="wm-asf-writer-filter-directshow"></a><span data-ttu-id="b15a8-103">Фильтр модуля записи WM ASF (DirectShow)</span><span class="sxs-lookup"><span data-stu-id="b15a8-103">WM ASF Writer Filter (DirectShow)</span></span>

<span data-ttu-id="b15a8-104">Модуль записи WM ASF является фильтром оболочки для объекта модуля записи, поставляемого с пакетом SDK Windows Media™ Format.</span><span class="sxs-lookup"><span data-stu-id="b15a8-104">The WM ASF Writer is a wrapper filter for the writer object provided with the Windows Media™ Format SDK.</span></span> <span data-ttu-id="b15a8-105">Фильтр принимает переменное число входных потоков и создает файл расширенного формата системы (ASF).</span><span class="sxs-lookup"><span data-stu-id="b15a8-105">The filter accepts a variable number of input streams and creates an Advanced Systems Format (ASF) file.</span></span> <span data-ttu-id="b15a8-106">Фильтр обрабатывает все сжатие и мультиплексирование (хотя механизм сжатия можно обойти).</span><span class="sxs-lookup"><span data-stu-id="b15a8-106">The filter handles all compression and multiplexing (although the compression mechanism can be bypassed).</span></span> <span data-ttu-id="b15a8-107">Модуль записи WM ASF можно использовать в различных сценариях, включая видеозапись цифрового видео (DV), повторное сжатие звука и преобразование Audio-Video файлов мультимедиа с чередованием (AVI) или MPEG для потоковой передачи в сети.</span><span class="sxs-lookup"><span data-stu-id="b15a8-107">You can use the WM ASF Writer in various scenarios including digital video (DV) capture, audio recompression, and conversion of Audio-Video Interleaved (AVI) or MPEG multimedia files for network streaming.</span></span> <span data-ttu-id="b15a8-108">Этот фильтр предоставляет единственный способ создания файлов Microsoft® Windows Media™ аудио и Windows Media Video в Microsoft DirectShow.</span><span class="sxs-lookup"><span data-stu-id="b15a8-108">This filter provides the only way to create Microsoft® Windows Media™ Audio and Windows Media Video files in Microsoft DirectShow.</span></span>

<span data-ttu-id="b15a8-109">Дополнительные сведения см. [в разделе Создание файлов ASF в DirectShow](creating-asf-files-in-directshow.md).</span><span class="sxs-lookup"><span data-stu-id="b15a8-109">For more information, see [Creating ASF Files in DirectShow](creating-asf-files-in-directshow.md).</span></span>



| <span data-ttu-id="b15a8-110">Метка</span><span class="sxs-lookup"><span data-stu-id="b15a8-110">Label</span></span> | <span data-ttu-id="b15a8-111">Значение</span><span class="sxs-lookup"><span data-stu-id="b15a8-111">Value</span></span> |
|------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b15a8-112">Интерфейсы фильтра</span><span class="sxs-lookup"><span data-stu-id="b15a8-112">Filter interfaces</span></span>                        | <span data-ttu-id="b15a8-113">[**Иамфилтермискфлагс**](/windows/desktop/api/Strmif/nn-strmif-iamfiltermiscflags), [**ибасефилтер**](/windows/desktop/api/Strmif/nn-strmif-ibasefilter), [**иконфигасфвритер**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iconfigasfwriter), [**IConfigAsfWriter2**](/previous-versions/windows/desktop/api/dshowasf/nn-dshowasf-iconfigasfwriter2), [**IFileSinkFilter2**](/windows/desktop/api/Strmif/nn-strmif-ifilesinkfilter2), [**имедиасикинг**](/windows/desktop/api/Strmif/nn-strmif-imediaseeking), **IPersistStream**, **IServiceProvider**, **испеЦифипропертипажес** Кроме того, фильтр предоставляет следующие интерфейсы пакета SDK Windows Media Format: **IWMIndexer2**, **IWMHeaderInfo**, **IWMWriterAdvanced2**</span><span class="sxs-lookup"><span data-stu-id="b15a8-113">[**IAMFilterMiscFlags**](/windows/desktop/api/Strmif/nn-strmif-iamfiltermiscflags), [**IBaseFilter**](/windows/desktop/api/Strmif/nn-strmif-ibasefilter), [**IConfigAsfWriter**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iconfigasfwriter), [**IConfigAsfWriter2**](/previous-versions/windows/desktop/api/dshowasf/nn-dshowasf-iconfigasfwriter2), [**IFileSinkFilter2**](/windows/desktop/api/Strmif/nn-strmif-ifilesinkfilter2), [**IMediaSeeking**](/windows/desktop/api/Strmif/nn-strmif-imediaseeking), **IPersistStream**, **IServiceProvider**, **ISpecifyPropertyPages** In addition, the filter exposes the following Windows Media Format SDK interfaces: **IWMIndexer2**, **IWMHeaderInfo**, **IWMWriterAdvanced2**</span></span><br/> |
| <span data-ttu-id="b15a8-114">Типы носителей входных закрепления</span><span class="sxs-lookup"><span data-stu-id="b15a8-114">Input pin media types</span></span>                    | <span data-ttu-id="b15a8-115">Зависит от профиля ASF.</span><span class="sxs-lookup"><span data-stu-id="b15a8-115">Depends on the ASF profile.</span></span> <span data-ttu-id="b15a8-116">Обычно несжатые аудио и видео типы, хотя фильтр принимает сжатые типы, если они соответствуют профилю ASF.</span><span class="sxs-lookup"><span data-stu-id="b15a8-116">Typically uncompressed audio and video types, although the filter will accept compressed types if they match the ASF profile.</span></span>                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="b15a8-117">Интерфейсы входных закрепления</span><span class="sxs-lookup"><span data-stu-id="b15a8-117">Input pin interfaces</span></span>                     | <span data-ttu-id="b15a8-118">[**Иамстреамконфиг**](/windows/desktop/api/Strmif/nn-strmif-iamstreamconfig), [**иамвмбуфферпасс**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iamwmbufferpass), [**имеминпутпин**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin), [**Ипин**](/windows/desktop/api/Strmif/nn-strmif-ipin), **IServiceProvider** Кроме того, ПИН-код предоставляет следующий интерфейс пакета SDK Windows Media Format: **IWMStreamConfig2** (через **IServiceProvider**).</span><span class="sxs-lookup"><span data-stu-id="b15a8-118">[**IAMStreamConfig**](/windows/desktop/api/Strmif/nn-strmif-iamstreamconfig), [**IAMWMBufferPass**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iamwmbufferpass), [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin), [**IPin**](/windows/desktop/api/Strmif/nn-strmif-ipin), **IServiceProvider** In addition, the pin exposes the following Windows Media Format SDK interface: **IWMStreamConfig2** (through **IServiceProvider**)</span></span><br/>                                                                                                                                                                                 |
| <span data-ttu-id="b15a8-119">Типы носителей для выходного ПИН-кода</span><span class="sxs-lookup"><span data-stu-id="b15a8-119">Output pin media types</span></span>                   | <span data-ttu-id="b15a8-120">Не применяется</span><span class="sxs-lookup"><span data-stu-id="b15a8-120">Not applicable.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b15a8-121">Интерфейсы выходного ПИН-кода</span><span class="sxs-lookup"><span data-stu-id="b15a8-121">Output pin interfaces</span></span>                    | <span data-ttu-id="b15a8-122">Не применяется</span><span class="sxs-lookup"><span data-stu-id="b15a8-122">Not applicable.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b15a8-123">Фильтровать CLSID</span><span class="sxs-lookup"><span data-stu-id="b15a8-123">Filter CLSID</span></span>                             | <span data-ttu-id="b15a8-124">\_ВМАСФВРИТЕР CLSID</span><span class="sxs-lookup"><span data-stu-id="b15a8-124">CLSID\_WMAsfWriter</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="b15a8-125">CLSID страницы свойств</span><span class="sxs-lookup"><span data-stu-id="b15a8-125">Property page CLSID</span></span>                      | <span data-ttu-id="b15a8-126">\_АСФВРИТЕРПРОПЕРТИЕС CLSID</span><span class="sxs-lookup"><span data-stu-id="b15a8-126">CLSID\_AsfWriterProperties</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="b15a8-127">Исполняемый объект</span><span class="sxs-lookup"><span data-stu-id="b15a8-127">Executable</span></span>                               | <span data-ttu-id="b15a8-128">Qasf.dll</span><span class="sxs-lookup"><span data-stu-id="b15a8-128">Qasf.dll</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="b15a8-129">Заслуживают</span><span class="sxs-lookup"><span data-stu-id="b15a8-129">Merit</span></span>](merit.md)                       | <span data-ttu-id="b15a8-130">\_ \_ не \_ использовать</span><span class="sxs-lookup"><span data-stu-id="b15a8-130">MERIT\_DO\_NOT\_USE</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="b15a8-131">Категория фильтра</span><span class="sxs-lookup"><span data-stu-id="b15a8-131">Filter Category</span></span>](filter-categories.md) | <span data-ttu-id="b15a8-132">Не указано</span><span class="sxs-lookup"><span data-stu-id="b15a8-132">Not specified</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |



 

## <a name="remarks"></a><span data-ttu-id="b15a8-133">Комментарии</span><span class="sxs-lookup"><span data-stu-id="b15a8-133">Remarks</span></span>

<span data-ttu-id="b15a8-134">Для этого фильтра требуется пакет средств разработки программного обеспечения (SDK) Windows Media Format и его зависимые компоненты.</span><span class="sxs-lookup"><span data-stu-id="b15a8-134">The filter requires the Windows Media Format Software Development Kit (SDK) and its underlying dependencies.</span></span>

<span data-ttu-id="b15a8-135">Количество входных ПИН-кодов в фильтре в зависимости от профиля или идентификатора профиля потока ASF.</span><span class="sxs-lookup"><span data-stu-id="b15a8-135">The number of input pins on the filter dependings on the profile or profile identifier of the ASF stream.</span></span>

<span data-ttu-id="b15a8-136">Входные сигналы поддерживают один метод из интерфейса **иамстреамконфиг** : [**иамстреамконфиг::-Format**](/windows/desktop/api/Strmif/nf-strmif-iamstreamconfig-getformat).</span><span class="sxs-lookup"><span data-stu-id="b15a8-136">The input pins support one method from the **IAMStreamConfig** interface: [**IAMStreamConfig::GetFormat**](/windows/desktop/api/Strmif/nf-strmif-iamstreamconfig-getformat).</span></span> <span data-ttu-id="b15a8-137">Все остальные методы возвращают E \_ нотимпл.</span><span class="sxs-lookup"><span data-stu-id="b15a8-137">All other methods return E\_NOTIMPL.</span></span> <span data-ttu-id="b15a8-138">Вызовите метод **OnFormat** , чтобы запросить формат сжатия целевого объекта ПИН-кода, который определяется текущим профилем ASF.</span><span class="sxs-lookup"><span data-stu-id="b15a8-138">Call the **GetFormat** method to query the pin's destination compression format, which is defined by the current ASF profile.</span></span> <span data-ttu-id="b15a8-139">Чтобы задать профиль, используйте интерфейс [**иконфигасфвритер**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iconfigasfwriter) .</span><span class="sxs-lookup"><span data-stu-id="b15a8-139">Use the [**IConfigAsfWriter**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iconfigasfwriter) interface to set the profile.</span></span>

<span data-ttu-id="b15a8-140">Можно использовать интерфейс **IServiceProvider** фильтра для получения указателя на интерфейс **IWMWriterAdvanced2** , который определен в пакете SDK формата Windows Media.</span><span class="sxs-lookup"><span data-stu-id="b15a8-140">You can use the filter's **IServiceProvider** interface to get a pointer to the **IWMWriterAdvanced2** interface, which is defined in the Windows Media Format SDK.</span></span> <span data-ttu-id="b15a8-141">Вы можете использовать интерфейс **IWMWriterAdvanced2** для управления воспроизведением видео при чередовании исходного видео.</span><span class="sxs-lookup"><span data-stu-id="b15a8-141">You can use the **IWMWriterAdvanced2** interface to control video deinterlacing when the source video is interlaced.</span></span> <span data-ttu-id="b15a8-142">Чтобы задать режим разчередования, вызовите метод **IWMWriterAdvanced2:: сетинпутсеттинг**.</span><span class="sxs-lookup"><span data-stu-id="b15a8-142">To set the deinterlacing mode, call **IWMWriterAdvanced2::SetInputSetting**.</span></span> <span data-ttu-id="b15a8-143">Для параметра *двинпутнум* используйте Отсчитываемый от нуля индекс входного ПИН-кода, перечисленный интерфейсом [**иенумпинс**](/windows/desktop/api/Strmif/nn-strmif-ienumpins) .</span><span class="sxs-lookup"><span data-stu-id="b15a8-143">For the *dwInputNum* parameter, use the zero-based index of the video input pin, as enumerated by the [**IEnumPins**](/windows/desktop/api/Strmif/nn-strmif-ienumpins) interface.</span></span>

<span data-ttu-id="b15a8-144">В следующем примере показано, как запросить этот интерфейс:</span><span class="sxs-lookup"><span data-stu-id="b15a8-144">The following example shows how to query for this interface:</span></span>


```C++
// Assume that pAsfWriter is a valid IBaseFilter pointer.
IServiceProvider *pProvider = NULL;
IWMWriterAdvanced2 *pWMWA2 = NULL;

hr = pAsfWriter->QueryInterface(
    IID_IServiceProvider, 
    (void**)&pProvider
    );
if (SUCCEEDED(hr))
{
    hr = pProvider->QueryService(
        IID_IWMWriterAdvanced2,
        IID_IWMWriterAdvanced2, 
        (void**)&pWMWA2
        );
    pProvider->Release();
    if (SUCCEEDED(hr))
    {
        // Use pWMWA2. (Not shown.)
        pWMWA2->Release();
    }
}
```



<span data-ttu-id="b15a8-145">Приложения не должны использовать методы **ивмвритерадванцед** , наследуемые интерфейсом **IWMWriterAdvanced2** .</span><span class="sxs-lookup"><span data-stu-id="b15a8-145">Applications should not use any of the **IWMWriterAdvanced** methods that the **IWMWriterAdvanced2** interface inherits.</span></span> <span data-ttu-id="b15a8-146">Вызов любых этих методов может интерере с операцией фильтра.</span><span class="sxs-lookup"><span data-stu-id="b15a8-146">Calling any these methods could interere with the operation of the filter.</span></span>

<span data-ttu-id="b15a8-147">Единственный режим записи в файл, поддерживаемый этим фильтром, — это \_ \_ Перезапись файла.</span><span class="sxs-lookup"><span data-stu-id="b15a8-147">The only file-writing mode supported by this filter is AM\_FILE\_OVERWRITE.</span></span> <span data-ttu-id="b15a8-148">См. раздел [**IFileSinkFilter2:: onmode**](/windows/desktop/api/Strmif/nf-strmif-ifilesinkfilter2-getmode).</span><span class="sxs-lookup"><span data-stu-id="b15a8-148">See [**IFileSinkFilter2::GetMode**](/windows/desktop/api/Strmif/nf-strmif-ifilesinkfilter2-getmode).</span></span>

<span data-ttu-id="b15a8-149">Когда среда выполнения пакета SDK Windows Media Format отправляет \_ сообщения о состоянии ВМТ в фильтр модуля записи WM ASF, фильтр пересылает их в виде событий [**\_ \_ событий EC ВМТ**](ec-wmt-event.md) .</span><span class="sxs-lookup"><span data-stu-id="b15a8-149">When the Windows Media Format SDK runtime sends WMT\_STATUS messages to the WM ASF Writer filter, the filter forwards them as [**EC\_WMT\_EVENT**](ec-wmt-event.md) events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b15a8-150">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="b15a8-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b15a8-151">Фильтры DirectShow</span><span class="sxs-lookup"><span data-stu-id="b15a8-151">DirectShow Filters</span></span>](directshow-filters.md)
</dt> </dl>

 

 




