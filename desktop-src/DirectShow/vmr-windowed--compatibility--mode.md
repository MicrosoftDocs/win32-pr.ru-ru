---
description: Режим с окнами VMR (совместимость)
ms.assetid: e9fb1c83-860a-44c1-9633-c86f5d0fdadd
title: Режим с окнами VMR (совместимость)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7312274881642d15b844e0fa950f72e52f92db8f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104567498"
---
# <a name="vmr-windowed-compatibility-mode"></a><span data-ttu-id="065f3-103">Режим с окнами VMR (совместимость)</span><span class="sxs-lookup"><span data-stu-id="065f3-103">VMR Windowed (Compatibility) Mode</span></span>

<span data-ttu-id="065f3-104">VMR разработан для совместимости со всеми существующими приложениями DirectShow.</span><span class="sxs-lookup"><span data-stu-id="065f3-104">The VMR is designed to be compatible with all existing DirectShow applications.</span></span> <span data-ttu-id="065f3-105">При использовании с существующим приложением VMR работает в оконном режиме с одним потоком видео, также называемым режимом совместимости.</span><span class="sxs-lookup"><span data-stu-id="065f3-105">When it is used with an existing application, the VMR operates in windowed mode with a single video stream, also called compatibility mode.</span></span> <span data-ttu-id="065f3-106">Этот режим предоставляется, так как VMR-7 является модулем подготовки отчетов по умолчанию в Windows XP и поэтому автоматически используется в вызовах [интеллектуальных методов соединения](intelligent-connect.md) , таких как [**Играфбуилдер:: renderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile).</span><span class="sxs-lookup"><span data-stu-id="065f3-106">This mode is provided because the VMR-7 is the default renderer on Windows XP, and is therefore automatically used in calls to [Intelligent Connect](intelligent-connect.md) methods such as [**IGraphBuilder::RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile).</span></span> <span data-ttu-id="065f3-107">Если приложение использует интеллектуальное подключение и требует только базовых возможностей рендеринга, Специальный код для корректной отрисовки с помощью VMR-7 в Windows XP не требуется.</span><span class="sxs-lookup"><span data-stu-id="065f3-107">If your application uses Intelligent Connect and requires only basic rendering capabilities, you do not need any special code to render correctly with the VMR-7 on Windows XP.</span></span>

<span data-ttu-id="065f3-108">VMR-9 также работает в режиме окон и совместимости по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="065f3-108">The VMR-9 also runs in windowed/compatibility mode by default.</span></span> <span data-ttu-id="065f3-109">Однако VMR-9 никогда не является модулем подготовки видео по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="065f3-109">However, the VMR-9 is never the default video renderer.</span></span> <span data-ttu-id="065f3-110">Чтобы использовать VMR-9 в приложении, необходимо явно добавить его в граф фильтра.</span><span class="sxs-lookup"><span data-stu-id="065f3-110">To use the VMR-9 in an application, you must explicitly add it to the filter graph.</span></span> <span data-ttu-id="065f3-111">По этой причине, поскольку режим без окон обеспечивает лучшую функциональность по сравнению с оконным режимом, использование VMR-9 в режиме окон и совместимости не имеет смысла.</span><span class="sxs-lookup"><span data-stu-id="065f3-111">For that reason, and because windowless mode provides better functionality than windowed mode, there is no particular advantage to using the VMR-9 in windowed/compatibility mode.</span></span>

<span data-ttu-id="065f3-112">**Использование VMR-7 в режиме окон и совместимости**</span><span class="sxs-lookup"><span data-stu-id="065f3-112">**Using the VMR-7 in Windowed/Compatibility Mode**</span></span>

<span data-ttu-id="065f3-113">Для установки и управления VMR-7 в режиме окон и совместимости специальное программирование не требуется.</span><span class="sxs-lookup"><span data-stu-id="065f3-113">No special programming is required to set up or control the VMR-7 in windowed/compatibility mode.</span></span> <span data-ttu-id="065f3-114">Просто создайте граф фильтра с помощью стандартных вызовов построения графа, и VMR-7 будет по умолчанию использовать этот режим.</span><span class="sxs-lookup"><span data-stu-id="065f3-114">Simply build the filter graph using the standard graph-building calls, and the VMR-7 will default to this mode.</span></span>

<span data-ttu-id="065f3-115">В режиме окон и совместимости VMR-7 создает собственное окно для показа видео.</span><span class="sxs-lookup"><span data-stu-id="065f3-115">In windowed/compatibility mode, the VMR-7 creates its own window to display the video.</span></span> <span data-ttu-id="065f3-116">Для этого загружается компонент диспетчера окон, который предоставляет интерфейсы [**ивидеовиндов**](/windows/desktop/api/Control/nn-control-ivideowindow) и [**ибасиквидео**](/windows/desktop/api/Control/nn-control-ibasicvideo) .</span><span class="sxs-lookup"><span data-stu-id="065f3-116">To do so, it loads the Window Manager component, which exposes the [**IVideoWindow**](/windows/desktop/api/Control/nn-control-ivideowindow) and [**IBasicVideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) interfaces.</span></span> <span data-ttu-id="065f3-117">Приложение может запрашивать диспетчер графа фильтров для этих интерфейсов точно так же, как и старый фильтр модуля подготовки отчетов видео.</span><span class="sxs-lookup"><span data-stu-id="065f3-117">Your application can query the Filter Graph Manager for these interfaces, exactly as you would with the old Video Renderer filter.</span></span> <span data-ttu-id="065f3-118">Дополнительные сведения см. [в разделе Использование оконного режима](using-windowed-mode.md).</span><span class="sxs-lookup"><span data-stu-id="065f3-118">For more information, see [Using Windowed Mode](using-windowed-mode.md).</span></span>

<span data-ttu-id="065f3-119">На следующем рисунке показан фильтр VMR-7 в режиме окон и совместимости.</span><span class="sxs-lookup"><span data-stu-id="065f3-119">The following illustration shows the VMR-7 in windowed/compatibility mode.</span></span>

![VMR в режиме совместимости](images/vmr-compat-mode.png)

<span data-ttu-id="065f3-121">Чтобы обеспечить максимальный уровень совместимости, окно видео имеет то же имя класса, которое было создано старым фильтром модуля подготовки отчетов, и большая часть кода диспетчера окон из старого модуля подготовки видео по-прежнему используется фильтром VMR.</span><span class="sxs-lookup"><span data-stu-id="065f3-121">To guarantee the maximum level of compatibility, the video window has the same class name as the one created by the old Video Renderer filter, and most of the Window Manager code from the old Video Renderer is still used by the VMR.</span></span> <span data-ttu-id="065f3-122">В режиме окон и совместимости VMR использует не больше системных ресурсов, чем у старого модуля подготовки видео.</span><span class="sxs-lookup"><span data-stu-id="065f3-122">In windowed/compatibility mode, the VMR consumes no more system resources than the old Video Renderer.</span></span> <span data-ttu-id="065f3-123">Поскольку VMR-7 имеет только один входной поток в режиме «в Windows» или «совместимость», он не загружает компоненты микшера или компоновщика.</span><span class="sxs-lookup"><span data-stu-id="065f3-123">Since the VMR-7 has only one input stream in windowed/compatibility mode, it does not load its mixer or compositor components.</span></span>

<span data-ttu-id="065f3-124">По умолчанию VMR растягивает изображение, чтобы заполнить окно видео.</span><span class="sxs-lookup"><span data-stu-id="065f3-124">By default, the VMR stretches the image to fill the video window.</span></span> <span data-ttu-id="065f3-125">Чтобы сохранить пропорции источника, вызовите метод [**ивмраспектратиоконтрол:: сетаспектратиомоде**](/windows/desktop/api/Strmif/nf-strmif-ivmraspectratiocontrol-setaspectratiomode) с \_ \_ \_ флагом поля VMR армоде Letter.</span><span class="sxs-lookup"><span data-stu-id="065f3-125">To preserve the aspect ratio of the source, call the [**IVMRAspectRatioControl::SetAspectRatioMode**](/windows/desktop/api/Strmif/nf-strmif-ivmraspectratiocontrol-setaspectratiomode) method with the VMR\_ARMODE\_LETTER\_BOX flag.</span></span>

> [!Note]  
> <span data-ttu-id="065f3-126">Приложения MFC, которые размещают окно видео в дочернем окне, должны определять пустой \_ обработчик сообщений WM ерасебкгнд, иначе область видеоизображения не будет правильно перерисовываться.</span><span class="sxs-lookup"><span data-stu-id="065f3-126">MFC applications that place the video window in a child window must define an empty WM\_ERASEBKGND message handler, or the video display area will not repaint correctly.</span></span>

 

<span data-ttu-id="065f3-127">**Использование VMR-7 в режиме окон и совместимости с несколькими потоками**</span><span class="sxs-lookup"><span data-stu-id="065f3-127">**Using the VMR-7 in Windowed/Compatibility Mode with Multiple Streams**</span></span>

<span data-ttu-id="065f3-128">В режиме «в Windows» и «совместимость» VMR-7 по умолчанию создает один закрепление ввода и отключает режим смешения.</span><span class="sxs-lookup"><span data-stu-id="065f3-128">In windowed/compatibility mode, the VMR-7 creates a single input pin by default, and disables mixing mode.</span></span> <span data-ttu-id="065f3-129">Чтобы включить режим смешения, необходимо настроить VMR перед его подключением.</span><span class="sxs-lookup"><span data-stu-id="065f3-129">To enable mixing mode, you must configure the VMR before you connect it.</span></span> <span data-ttu-id="065f3-130">Дополнительные сведения см. [в разделе VMR с несколькими потоками (режим смешения)](vmr-with-multiple-streams--mixing-mode.md).</span><span class="sxs-lookup"><span data-stu-id="065f3-130">For more information, see [VMR with Multiple Streams (Mixing Mode)](vmr-with-multiple-streams--mixing-mode.md).</span></span> <span data-ttu-id="065f3-131">В режиме смешения VMR загружает компоненты смешения и композиции, требующие больше системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="065f3-131">In mixing mode, the VMR loads the mixing and compositor components, which require more system resources.</span></span>

<span data-ttu-id="065f3-132">**Использование VMR-9 в оконном режиме**</span><span class="sxs-lookup"><span data-stu-id="065f3-132">**Using the VMR-9 in Windowed Mode**</span></span>

<span data-ttu-id="065f3-133">Так как VMR-9 не является модулем подготовки отчетов по умолчанию, он не имеет режима совместимости.</span><span class="sxs-lookup"><span data-stu-id="065f3-133">Because the VMR-9 is not the default renderer, it does not have a compatibility mode as such.</span></span> <span data-ttu-id="065f3-134">Вместо этого VMR-9 по умолчанию принимает оконный режим с четырьмя входными контактами.</span><span class="sxs-lookup"><span data-stu-id="065f3-134">Instead, the VMR-9 defaults to windowed mode with four input pins.</span></span> <span data-ttu-id="065f3-135">Этот режим можно использовать для смешивания до четырех потоков видео.</span><span class="sxs-lookup"><span data-stu-id="065f3-135">You can use this mode to mix up to four video streams.</span></span> <span data-ttu-id="065f3-136">Если необходимо смешать большее количество потоков, необходимо настроить его, как описано в [VMR с несколькими потоками (режим смешения)](vmr-with-multiple-streams--mixing-mode.md).</span><span class="sxs-lookup"><span data-stu-id="065f3-136">If you need to mix a larger number of streams, you must configure it as described in [VMR with Multiple Streams (Mixing Mode)](vmr-with-multiple-streams--mixing-mode.md).</span></span> <span data-ttu-id="065f3-137">В противном случае VMR-9 в оконном режиме ведет себя точно так же, как VMR-7 в режиме окон и совместимости.</span><span class="sxs-lookup"><span data-stu-id="065f3-137">Otherwise, the VMR-9 in windowed mode behaves exactly like the VMR-7 in windowed/compatibility mode.</span></span>

 

 



