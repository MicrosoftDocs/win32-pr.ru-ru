---
description: Фильтровать цепочки
ms.assetid: c17b3b58-65ab-4e83-91f2-54a995f22ddf
title: Фильтровать цепочки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d22ee33f7bc24495bc5099d0abeca7b8c70bc6d4
ms.sourcegitcommit: 63753fcfb0afbbe5ec283fb8316e62c2dc950f66
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2021
ms.locfileid: "107909062"
---
# <a name="filter-chains"></a>Фильтровать цепочки

*Цепочка фильтров* — это последовательность фильтров, которая соответствует следующим условиям.

-   Каждый фильтр в цепочке имеет не более одного подключенного входного ПИН-кода и одного подключенного выходного контакта.
-   Можно просмотреть каждый фильтр в цепочке без прохода по фильтрам за пределами цепочки.

Например, на следующей схеме фильтры A – B, C – D и F-G-H являются цепочками фильтров. Каждая подцепочка в F – G – H (F – G и G – H) также является цепочкой фильтров. Цепочка фильтров может состоять из одного фильтра, поэтому фильтры A, B, C, D, F, G и H также являются отдельными цепочками фильтров. Фильтр E имеет два входных соединения, поэтому любая последовательность фильтров, включающая фильтр E, не является цепочкой фильтров.

![цепочка фильтров (пример 1)](images/filter-chain1.png)

Интерфейс [**ифилтерчаин**](/windows/desktop/api/Strmif/nn-strmif-ifilterchain) предоставляет следующие методы управления цепочками фильтров:



| Метка | Значение |
|---------------------------------------------------------------|---------------------------------|
| [**Ифилтерчаин:: Стартчаин**](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-startchain)   | Запускает цепочку.                 |
| [**Ифилтерчаин:: Стопчаин**](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-stopchain)     | Останавливает цепочку.                  |
| [**Ифилтерчаин::P Аусечаин**](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-pausechain)   | Приостанавливает цепочку.                 |
| [**Ифилтерчаин:: Ремовечаин**](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-removechain) | Удаляет цепочку из графа. |



 

Нет определенного метода для добавления цепочки. Чтобы добавить цепочку, вставьте новые фильтры с помощью метода [**ифилтерграф:: аддфилтер**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-addfilter) . Затем соедините фильтры, вызвав [**играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect), [**Играфбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render)или аналогичные методы.

При выполнении графа цепочка фильтров может переключаться между выполнением и остановкой. Когда граф приостанавливается, он может переключаться между приостановкой и остановкой. Это единственные возможные переходы состояния с цепочками фильтров.

## <a name="filter-chain-guidelines"></a>Рекомендации по использованию цепочки фильтров

При использовании методов **ифилтерчаин** важно убедиться, что фильтры в графе могут поддерживать операции цепочки фильтров. В противном случае могут возникнуть ошибки взаимоблокировки или графа. Фильтры, подключенные к цепочке, должны работать правильно после изменения состояния цепочки.

Лучшим способом использования **ифилтерчаин** является набор фильтров, разработанных специально для цепочки. Используйте следующие рекомендации, чтобы убедиться, что фильтры являются надежными для операций фильтрации по цепочке. Эти точки относятся к схеме ниже.

![цепочка фильтров (пример 2)](images/filter-chain2.png)

-   Перед изменением состояния цепочки фильтров необходимо завершить все вызовы обработки данных на границе цепи фильтров. Это правило применяется к методам [**имеминпутпин:: Receive**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receive), [**Ипин:: невсегмент**](/windows/desktop/api/Strmif/nf-strmif-ipin-newsegment)и [**Ипин:: EndOfStream**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream). Фильтры в цепочке должны возвращать из вызовов этих методов, сделанных фильтрами за пределами цепочки. фильтры, находящиеся за пределами цепочки, должны возвращать вызовы, сделанные фильтрами в цепочке.

Например, на предыдущей схеме фильтр б должен выполнить все вызовы обработки данных из фильтра а, а фильтр E должен завершить любые вызовы из фильтра D. Если ПИН-коды предоставляют интерфейсы [**ипинфловконтрол**](/windows/desktop/api/Strmif/nn-strmif-ipinflowcontrol) и [**ипинконнектион**](/windows/desktop/api/Strmif/nn-strmif-ipinconnection) , можно передать данные через граф, вызвав методы [**Ипинфловконтрол:: Block**](/windows/desktop/api/Strmif/nf-strmif-ipinflowcontrol-block) и [**играфконфиг::P ушсраугхдата**](/windows/desktop/api/Strmif/nf-strmif-igraphconfig-pushthroughdata) , как описано в разделе [динамическое](dynamic-reconnection.md)повторное подключение. Фильтры также могут поддерживать закрытые методы для передачи данных.

-   Вышестоящее фильтры должны ждать изменения состояния цепочки. Например, на предыдущей схеме Предположим, что цепочка остановлена, но фильтрация вызывает **имеминпутпин:: Receive**. Вызов завершается ошибкой, а ответ фильтра а — на потоковую передачу. Когда приложение перезапускает цепочку, оно не действует, поскольку фильтр A больше не использует потоковую передачу данных.
-   Нисходящие фильтры также должны ждать изменения состояния цепочки. В противном случае нисходящий фильтр может блокироваться, пока не будет ожидать выборки, которые не поступают. Например, для фильтров мультиплексора (МУЛЬТИПЛЕКСОРа) часто требуются данные из всех входных ПИН-кодов. Остановка потока данных из одного входного ПИН-кода может препятствовать обработке других потоков. Это может привести к взаимоблокировке графа.
-   Каждое подключение закрепления от фильтра за пределами цепочки к фильтру в пределах цепочки должно иметь собственный распределитель, который не используется другими соединениями. При изменении состояния цепочки или удалении из графа распределитель может быть отменен. Если другие соединения использовали один распределитель, они больше не смогут обрабатывать образцы.
-   Не удаляйте цепочку, если только фильтры, подключенные к цепочке, поддерживают динамическое отключение. Как правило, подключенные фильтры поддерживают интерфейс **ипинконнектион** или **ипинфловконтрол** , но вместо этого могут поддерживать частные интерфейсы.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Построение динамического графа](dynamic-graph-building.md)
</dt> </dl>

 

 



