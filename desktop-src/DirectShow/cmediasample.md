---
description: Класс Кмедиасампле определяет пример носителя, поддерживающий интерфейс IMediaSample2. Пример носителя содержит указатель на буфер памяти и различные свойства, хранящиеся как защищенные переменные-члены.
ms.assetid: 1e609c7c-3200-4540-904e-7659976df0da
title: Класс Кмедиасампле (Амфилтер. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CMediaSample
api_type:
- COM
api_location:
- Strmbase.lib
- Strmbase.dll
- Strmbasd.lib
- Strmbasd.dll
ms.openlocfilehash: 72cfe0f86ff6b6643f2f7793822899136a5c6454
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105665063"
---
# <a name="cmediasample-class"></a><span data-ttu-id="eb910-104">Класс Кмедиасампле</span><span class="sxs-lookup"><span data-stu-id="eb910-104">CMediaSample class</span></span>

![Иерархия классов кмедиасампле](images/wutil03.png)

<span data-ttu-id="eb910-106">`CMediaSample`Класс определяет пример носителя, поддерживающий интерфейс [**IMediaSample2**](/windows/desktop/api/Strmif/nn-strmif-imediasample2) .</span><span class="sxs-lookup"><span data-stu-id="eb910-106">The `CMediaSample` class defines a media sample that supports the [**IMediaSample2**](/windows/desktop/api/Strmif/nn-strmif-imediasample2) interface.</span></span> <span data-ttu-id="eb910-107">Пример носителя содержит указатель на буфер памяти и различные свойства, хранящиеся как защищенные переменные-члены.</span><span class="sxs-lookup"><span data-stu-id="eb910-107">The media sample contains a pointer to a memory buffer, and various properties stored as protected member variables.</span></span>

<span data-ttu-id="eb910-108">Примеры носителей создаются распределителями, которые являются производными от класса [**кбасеаллокатор**](cbaseallocator.md) .</span><span class="sxs-lookup"><span data-stu-id="eb910-108">Media samples are created by allocators, which are derived from the [**CBaseAllocator**](cbaseallocator.md) class.</span></span> <span data-ttu-id="eb910-109">`CMediaSample`Конструктор получает указатель на выделенный буфер вместе с размером буфера.</span><span class="sxs-lookup"><span data-stu-id="eb910-109">The `CMediaSample` constructor receives a pointer to an allocated buffer, along with the size of the buffer.</span></span> <span data-ttu-id="eb910-110">Другие свойства обычно задаются и извлекаются с помощью методов интерфейса [**имедиасампле**](/windows/desktop/api/Strmif/nn-strmif-imediasample) .</span><span class="sxs-lookup"><span data-stu-id="eb910-110">Other properties are typically set and retrieved through [**IMediaSample**](/windows/desktop/api/Strmif/nn-strmif-imediasample) interface methods.</span></span>

<span data-ttu-id="eb910-111">Жизненный цикл примера мультимедиа отличается от большинства COM-объектов:</span><span class="sxs-lookup"><span data-stu-id="eb910-111">The life cycle of a media sample differs from that of most COM objects:</span></span>

-   <span data-ttu-id="eb910-112">Распределитель содержит список бесплатных выборок.</span><span class="sxs-lookup"><span data-stu-id="eb910-112">The allocator holds a list of free samples.</span></span> <span data-ttu-id="eb910-113">Если для фильтра требуется новый пример, вызывается метод распределителя [**имемаллокатор::-buffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-getbuffer) .</span><span class="sxs-lookup"><span data-stu-id="eb910-113">When a filter needs a new sample, it calls the allocator's [**IMemAllocator::GetBuffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-getbuffer) method.</span></span> <span data-ttu-id="eb910-114">Распределитель получает пример из свободного списка, увеличивает счетчик ссылок выборки и возвращает указатель на образец.</span><span class="sxs-lookup"><span data-stu-id="eb910-114">The allocator retrieves a sample from its free list, increments the sample's reference count, and returns a pointer to the sample.</span></span>
-   <span data-ttu-id="eb910-115">После того как фильтр выполнен в примере, он вызывает метод **IUnknown:: Release** для примера.</span><span class="sxs-lookup"><span data-stu-id="eb910-115">After the filter is done with the sample, it calls the **IUnknown::Release** method on the sample.</span></span> <span data-ttu-id="eb910-116">В отличие от большинства объектов, образец не удаляет себя, когда счетчик ссылок достигает нуля.</span><span class="sxs-lookup"><span data-stu-id="eb910-116">Unlike most objects, the sample does not delete itself when its reference count reaches zero.</span></span> <span data-ttu-id="eb910-117">Вместо этого он вызывает метод [**имемаллокатор:: релеасебуффер**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-releasebuffer) для распределителя, и распределитель возвращает пример в свободный список.</span><span class="sxs-lookup"><span data-stu-id="eb910-117">Instead, it calls the [**IMemAllocator::ReleaseBuffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-releasebuffer) method on the allocator, and the allocator returns the sample to its free list.</span></span>
-   <span data-ttu-id="eb910-118">Распределитель не уничтожает образцы до тех пор, пока не будет вызван метод [**имемаллокатор::D екоммит**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-decommit) .</span><span class="sxs-lookup"><span data-stu-id="eb910-118">The allocator does not destroy samples until the [**IMemAllocator::Decommit**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-decommit) method is called.</span></span>



| <span data-ttu-id="eb910-119">Защищенные переменные членов</span><span class="sxs-lookup"><span data-stu-id="eb910-119">Protected Member Variables</span></span>                                           | <span data-ttu-id="eb910-120">Описание</span><span class="sxs-lookup"><span data-stu-id="eb910-120">Description</span></span>                                                                                     |
|----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="eb910-121">**m \_ dwFlags**</span><span class="sxs-lookup"><span data-stu-id="eb910-121">**m\_dwFlags**</span></span>](cmediasample-m-dwflags.md)                         | <span data-ttu-id="eb910-122">Примеры флагов свойств.</span><span class="sxs-lookup"><span data-stu-id="eb910-122">Sample property flags.</span></span>                                                                          |
| [<span data-ttu-id="eb910-123">**m \_ двтипеспеЦификфлагс**</span><span class="sxs-lookup"><span data-stu-id="eb910-123">**m\_dwTypeSpecificFlags**</span></span>](cmediasample-m-dwtypespecificflags.md) | <span data-ttu-id="eb910-124">Флаги, зависящие от типа.</span><span class="sxs-lookup"><span data-stu-id="eb910-124">Type-specific flags.</span></span>                                                                            |
| [<span data-ttu-id="eb910-125">**m \_ pBuffer**</span><span class="sxs-lookup"><span data-stu-id="eb910-125">**m\_pBuffer**</span></span>](cmediasample-m-pbuffer.md)                         | <span data-ttu-id="eb910-126">Указатель на буфер памяти, содержащий данные мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="eb910-126">Pointer to the memory buffer that contains the media data.</span></span>                                      |
| [<span data-ttu-id="eb910-127">**m \_ лактуал**</span><span class="sxs-lookup"><span data-stu-id="eb910-127">**m\_lActual**</span></span>](cmediasample-m-lactual.md)                         | <span data-ttu-id="eb910-128">Длина допустимых данных в буфере в байтах.</span><span class="sxs-lookup"><span data-stu-id="eb910-128">Length of the valid data in the buffer, in bytes.</span></span>                                               |
| [<span data-ttu-id="eb910-129">**m \_ кббуффер**</span><span class="sxs-lookup"><span data-stu-id="eb910-129">**m\_cbBuffer**</span></span>](cmediasample-m-cbbuffer.md)                       | <span data-ttu-id="eb910-130">Размер буфера в байтах.</span><span class="sxs-lookup"><span data-stu-id="eb910-130">Size of the buffer, in bytes.</span></span>                                                                   |
| [<span data-ttu-id="eb910-131">**m \_ паллокатор**</span><span class="sxs-lookup"><span data-stu-id="eb910-131">**m\_pAllocator**</span></span>](cmediasample-m-pallocator.md)                   | <span data-ttu-id="eb910-132">Указатель на распределитель, создавший этот образец.</span><span class="sxs-lookup"><span data-stu-id="eb910-132">Pointer to the allocator that created this sample.</span></span>                                              |
| [<span data-ttu-id="eb910-133">**m \_ пнекст**</span><span class="sxs-lookup"><span data-stu-id="eb910-133">**m\_pNext**</span></span>](cmediasample-m-pnext.md)                             | <span data-ttu-id="eb910-134">Указатель на следующий образец в списке выборок распределителя.</span><span class="sxs-lookup"><span data-stu-id="eb910-134">Pointer to the next sample in the allocator's list of samples.</span></span>                                  |
| [<span data-ttu-id="eb910-135">**м. \_ Начало**</span><span class="sxs-lookup"><span data-stu-id="eb910-135">**m\_Start**</span></span>](cmediasample-m-start.md)                             | <span data-ttu-id="eb910-136">Время начала выборки.</span><span class="sxs-lookup"><span data-stu-id="eb910-136">Sample start time.</span></span>                                                                              |
| [<span data-ttu-id="eb910-137">**\_конец m**</span><span class="sxs-lookup"><span data-stu-id="eb910-137">**m\_End**</span></span>](cmediasample-m-end.md)                                 | <span data-ttu-id="eb910-138">Время окончания выборки.</span><span class="sxs-lookup"><span data-stu-id="eb910-138">Sample end time.</span></span>                                                                                |
| [<span data-ttu-id="eb910-139">**m \_ медиастарт**</span><span class="sxs-lookup"><span data-stu-id="eb910-139">**m\_MediaStart**</span></span>](cmediasample-m-mediastart.md)                   | <span data-ttu-id="eb910-140">Время начала носителя.</span><span class="sxs-lookup"><span data-stu-id="eb910-140">Media start time.</span></span>                                                                               |
| [<span data-ttu-id="eb910-141">**m \_ медиаенд**</span><span class="sxs-lookup"><span data-stu-id="eb910-141">**m\_MediaEnd**</span></span>](cmediasample-m-mediaend.md)                       | <span data-ttu-id="eb910-142">Время окончания носителя.</span><span class="sxs-lookup"><span data-stu-id="eb910-142">Media stop time.</span></span>                                                                                |
| [<span data-ttu-id="eb910-143">**m \_ пмедиатипе**</span><span class="sxs-lookup"><span data-stu-id="eb910-143">**m\_pMediaType**</span></span>](cmediasample-m-pmediatype.md)                   | <span data-ttu-id="eb910-144">Указатель на тип мультимедиа, если тип был изменен из предыдущего примера в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="eb910-144">Pointer to the media type, if the type has changed from the previous sample in the data stream.</span></span> |
| [<span data-ttu-id="eb910-145">**m \_ двстреамид**</span><span class="sxs-lookup"><span data-stu-id="eb910-145">**m\_dwStreamId**</span></span>](cmediasample-m-dwstreamid.md)                   | <span data-ttu-id="eb910-146">Идентификатор потока.</span><span class="sxs-lookup"><span data-stu-id="eb910-146">Stream identifier.</span></span>                                                                              |
| <span data-ttu-id="eb910-147">Открытые переменные члена</span><span class="sxs-lookup"><span data-stu-id="eb910-147">Public Member Variables</span></span>                                              | <span data-ttu-id="eb910-148">Описание</span><span class="sxs-lookup"><span data-stu-id="eb910-148">Description</span></span>                                                                                     |
| [<span data-ttu-id="eb910-149">**«m», \_ cref**</span><span class="sxs-lookup"><span data-stu-id="eb910-149">**m\_cRef**</span></span>](cmediasample-m-cref.md)                               | <span data-ttu-id="eb910-150">Число ссылок.</span><span class="sxs-lookup"><span data-stu-id="eb910-150">Reference count.</span></span>                                                                                |
| <span data-ttu-id="eb910-151">Открытые методы</span><span class="sxs-lookup"><span data-stu-id="eb910-151">Public Methods</span></span>                                                       | <span data-ttu-id="eb910-152">Описание</span><span class="sxs-lookup"><span data-stu-id="eb910-152">Description</span></span>                                                                                     |
| [<span data-ttu-id="eb910-153">**кмедиасампле**</span><span class="sxs-lookup"><span data-stu-id="eb910-153">**CMediaSample**</span></span>](cmediasample-cmediasample.md)                    | <span data-ttu-id="eb910-154">Метод конструктора.</span><span class="sxs-lookup"><span data-stu-id="eb910-154">Constructor method.</span></span>                                                                             |
| [<span data-ttu-id="eb910-155">**~ Кмедиасампле**</span><span class="sxs-lookup"><span data-stu-id="eb910-155">**~ CMediaSample**</span></span>](cmediasample--cmediasample.md)                 | <span data-ttu-id="eb910-156">Метод деструктора.</span><span class="sxs-lookup"><span data-stu-id="eb910-156">Destructor method.</span></span> <span data-ttu-id="eb910-157">Виртуализаци.</span><span class="sxs-lookup"><span data-stu-id="eb910-157">Virtual.</span></span>                                                                     |
| [<span data-ttu-id="eb910-158">**сетпоинтер**</span><span class="sxs-lookup"><span data-stu-id="eb910-158">**SetPointer**</span></span>](cmediasample-setpointer.md)                        | <span data-ttu-id="eb910-159">Задает указатель на буфер памяти.</span><span class="sxs-lookup"><span data-stu-id="eb910-159">Sets the pointer to the memory buffer.</span></span>                                                          |
| <span data-ttu-id="eb910-160">Методы Имедиасампле</span><span class="sxs-lookup"><span data-stu-id="eb910-160">IMediaSample Methods</span></span>                                                 | <span data-ttu-id="eb910-161">Описание</span><span class="sxs-lookup"><span data-stu-id="eb910-161">Description</span></span>                                                                                     |
| [<span data-ttu-id="eb910-162">**"Уточняющий указатель"**</span><span class="sxs-lookup"><span data-stu-id="eb910-162">**GetPointer**</span></span>](cmediasample-getpointer.md)                        | <span data-ttu-id="eb910-163">Извлекает указатель чтения/записи в буфер.</span><span class="sxs-lookup"><span data-stu-id="eb910-163">Retrieves a read/write pointer to the buffer.</span></span>                                                   |
| [<span data-ttu-id="eb910-164">**GetSize**</span><span class="sxs-lookup"><span data-stu-id="eb910-164">**GetSize**</span></span>](cmediasample-getsize.md)                              | <span data-ttu-id="eb910-165">Возвращает размер буфера.</span><span class="sxs-lookup"><span data-stu-id="eb910-165">Retrieves the size of the buffer.</span></span>                                                               |
| [<span data-ttu-id="eb910-166">**GetTime**</span><span class="sxs-lookup"><span data-stu-id="eb910-166">**GetTime**</span></span>](cmediasample-gettime.md)                              | <span data-ttu-id="eb910-167">Извлекает время потока, с которого должен начинаться этот образец.</span><span class="sxs-lookup"><span data-stu-id="eb910-167">Retrieves the stream times at which this sample should begin and finish.</span></span>                        |
| [<span data-ttu-id="eb910-168">**SetTime**</span><span class="sxs-lookup"><span data-stu-id="eb910-168">**SetTime**</span></span>](cmediasample-settime.md)                              | <span data-ttu-id="eb910-169">Задает время в потоке, в течение которого этот пример должен начинаться и заканчиваться.</span><span class="sxs-lookup"><span data-stu-id="eb910-169">Sets the stream times at which this sample should start and finish.</span></span>                             |
| [<span data-ttu-id="eb910-170">**иссинкпоинт**</span><span class="sxs-lookup"><span data-stu-id="eb910-170">**IsSyncPoint**</span></span>](cmediasample-issyncpoint.md)                      | <span data-ttu-id="eb910-171">Определяет, является ли начало образца точкой синхронизации.</span><span class="sxs-lookup"><span data-stu-id="eb910-171">Determines if the beginning of the sample is a synchronization point.</span></span>                           |
| [<span data-ttu-id="eb910-172">**сетсинкпоинт**</span><span class="sxs-lookup"><span data-stu-id="eb910-172">**SetSyncPoint**</span></span>](cmediasample-setsyncpoint.md)                    | <span data-ttu-id="eb910-173">Указывает, является ли начало этого образца точкой синхронизации.</span><span class="sxs-lookup"><span data-stu-id="eb910-173">Specifies whether the beginning of this sample is a synchronization point.</span></span>                      |
| [<span data-ttu-id="eb910-174">**испреролл**</span><span class="sxs-lookup"><span data-stu-id="eb910-174">**IsPreroll**</span></span>](cmediasample-ispreroll.md)                          | <span data-ttu-id="eb910-175">Определяет, является ли этот образец примером предобразца.</span><span class="sxs-lookup"><span data-stu-id="eb910-175">Determines if this sample is a preroll sample.</span></span>                                                  |
| [<span data-ttu-id="eb910-176">**сетпреролл**</span><span class="sxs-lookup"><span data-stu-id="eb910-176">**SetPreroll**</span></span>](cmediasample-setpreroll.md)                        | <span data-ttu-id="eb910-177">Указывает, является ли этот пример примером предобразца.</span><span class="sxs-lookup"><span data-stu-id="eb910-177">Specifies whether this sample is a preroll sample.</span></span>                                              |
| [<span data-ttu-id="eb910-178">**жетактуалдаталенгс**</span><span class="sxs-lookup"><span data-stu-id="eb910-178">**GetActualDataLength**</span></span>](cmediasample-getactualdatalength.md)      | <span data-ttu-id="eb910-179">Возвращает длину допустимых данных в буфере.</span><span class="sxs-lookup"><span data-stu-id="eb910-179">Retrieves the length of the valid data in the buffer.</span></span>                                           |
| [<span data-ttu-id="eb910-180">**сетактуалдаталенгс**</span><span class="sxs-lookup"><span data-stu-id="eb910-180">**SetActualDataLength**</span></span>](cmediasample-setactualdatalength.md)      | <span data-ttu-id="eb910-181">Задает длину допустимых данных в буфере.</span><span class="sxs-lookup"><span data-stu-id="eb910-181">Sets the length of the valid data in the buffer.</span></span>                                                |
| [<span data-ttu-id="eb910-182">**жетмедиатипе**</span><span class="sxs-lookup"><span data-stu-id="eb910-182">**GetMediaType**</span></span>](cmediasample-getmediatype.md)                    | <span data-ttu-id="eb910-183">Извлекает тип мультимедиа, если тип мультимедиа отличается от предыдущего примера.</span><span class="sxs-lookup"><span data-stu-id="eb910-183">Retrieves the media type, if the media type differs from the previous sample.</span></span>                   |
| [<span data-ttu-id="eb910-184">**сетмедиатипе**</span><span class="sxs-lookup"><span data-stu-id="eb910-184">**SetMediaType**</span></span>](cmediasample-setmediatype.md)                    | <span data-ttu-id="eb910-185">Задает тип носителя для образца.</span><span class="sxs-lookup"><span data-stu-id="eb910-185">Sets the media type for the sample.</span></span>                                                             |
| [<span data-ttu-id="eb910-186">**исдисконтинуити**</span><span class="sxs-lookup"><span data-stu-id="eb910-186">**IsDiscontinuity**</span></span>](cmediasample-isdiscontinuity.md)              | <span data-ttu-id="eb910-187">Определяет, представляет ли этот образец разрыв в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="eb910-187">Determines if this sample represents a break in the data stream.</span></span>                                |
| [<span data-ttu-id="eb910-188">**сетдисконтинуити**</span><span class="sxs-lookup"><span data-stu-id="eb910-188">**SetDiscontinuity**</span></span>](cmediasample-setdiscontinuity.md)            | <span data-ttu-id="eb910-189">Указывает, представляет ли этот образец разрыв в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="eb910-189">Specifies whether this sample represents a break in the data stream.</span></span>                            |
| [<span data-ttu-id="eb910-190">**жетмедиатиме**</span><span class="sxs-lookup"><span data-stu-id="eb910-190">**GetMediaTime**</span></span>](cmediasample-getmediatime.md)                    | <span data-ttu-id="eb910-191">Возвращает время носителя для этого образца.</span><span class="sxs-lookup"><span data-stu-id="eb910-191">Retrieves the media times for this sample.</span></span>                                                      |
| [<span data-ttu-id="eb910-192">**сетмедиатиме**</span><span class="sxs-lookup"><span data-stu-id="eb910-192">**SetMediaTime**</span></span>](cmediasample-setmediatime.md)                    | <span data-ttu-id="eb910-193">Задает время носителя для этого образца.</span><span class="sxs-lookup"><span data-stu-id="eb910-193">Sets the media times for this sample.</span></span>                                                           |
| <span data-ttu-id="eb910-194">Методы IMediaSample2</span><span class="sxs-lookup"><span data-stu-id="eb910-194">IMediaSample2 Methods</span></span>                                                | <span data-ttu-id="eb910-195">Описание</span><span class="sxs-lookup"><span data-stu-id="eb910-195">Description</span></span>                                                                                     |
| [<span data-ttu-id="eb910-196">**GetProperties**</span><span class="sxs-lookup"><span data-stu-id="eb910-196">**GetProperties**</span></span>](cmediasample-getproperties.md)                  | <span data-ttu-id="eb910-197">Извлекает свойства образца.</span><span class="sxs-lookup"><span data-stu-id="eb910-197">Retrieves the properties of the sample.</span></span>                                                         |
| [<span data-ttu-id="eb910-198">**SetProperties**</span><span class="sxs-lookup"><span data-stu-id="eb910-198">**SetProperties**</span></span>](cmediasample-setproperties.md)                  | <span data-ttu-id="eb910-199">Задает свойства образца.</span><span class="sxs-lookup"><span data-stu-id="eb910-199">Sets the properties of the sample.</span></span>                                                              |



 

## <a name="requirements"></a><span data-ttu-id="eb910-200">Требования</span><span class="sxs-lookup"><span data-stu-id="eb910-200">Requirements</span></span>



| <span data-ttu-id="eb910-201">Требование</span><span class="sxs-lookup"><span data-stu-id="eb910-201">Requirement</span></span> | <span data-ttu-id="eb910-202">Значение</span><span class="sxs-lookup"><span data-stu-id="eb910-202">Value</span></span> |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="eb910-203">Header</span><span class="sxs-lookup"><span data-stu-id="eb910-203">Header</span></span><br/>  | <dl> <span data-ttu-id="eb910-204"><dt>Амфилтер. h (включение Streams. h)</dt></span><span class="sxs-lookup"><span data-stu-id="eb910-204"><dt>Amfilter.h (include Streams.h)</dt></span></span> </dl>                                                                                  |
| <span data-ttu-id="eb910-205">Библиотека</span><span class="sxs-lookup"><span data-stu-id="eb910-205">Library</span></span><br/> | <dl> <span data-ttu-id="eb910-206"><dt>Стрмбасе. lib (розничные сборки); </dt> <dt>Стрмбасд. lib (отладочные сборки)</dt></span><span class="sxs-lookup"><span data-stu-id="eb910-206"><dt>Strmbase.lib (retail builds); </dt> <dt>Strmbasd.lib (debug builds)</dt></span></span> </dl> |



 

 




