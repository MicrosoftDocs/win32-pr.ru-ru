---
description: Задание свойств для эффектов и переходов
ms.assetid: ce773140-7e50-4b72-8cb5-e34cba51644d
title: Задание свойств для эффектов и переходов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1305eb7860b5519b14cfeebc349643c2662db3f133c0bf3424d1d71ccf85753c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119904264"
---
# <a name="setting-properties-on-effects-and-transitions"></a>Задание свойств для эффектов и переходов

\[Этот API не поддерживается и может быть изменен или недоступен в будущем.\]

многие [DirectShow редактирования](directshow-editing-services.md) эффектов и переходов служб поддерживают свойства, управляющие их поведением. Приложение может задать значение свойства с помощью интерфейса [**ипропертисеттер**](ipropertysetter.md) . Базовый результат или объект перехода должен поддерживать интерфейс **IDispatch** для установки свойств. С помощью видеоэффектов и переходов приложение может задать диапазон значений, которые изменяются со временем. (Например, можно задать переход на очистку, чтобы перемещаться назад и вперед по кадру.) При использовании звуковых эффектов значение свойства является статическим и не может меняться со временем. Единственным исключением является действие [конверта тома](volume-envelope-effect.md) , которое поддерживает динамическое свойство для уровня громкости.

Чтобы задать свойство, выполните следующие действия.

1.  Создайте экземпляр метода задания свойства (CLSID \_ пропертисеттер).
2.  Заполните структуры [**Декстер \_ param**](dexter-param.md) и [**Декстер \_ value**](dexter-value.md) данными свойства. Эти структуры обсуждаются ниже.
3.  Передайте структуры [**\_ значений**](dexter-value.md) [**Декстер \_**](dexter-param.md) и Декстер в метод [**ипропертисеттер:: аддпроп**](ipropertysetter-addprop.md) .
4.  Повторите шаги 2 и 3 для каждого свойства, которое необходимо задать.
5.  Передайте указатель интерфейса [**ипропертисеттер**](ipropertysetter.md) в метод [**Иамтимелинеобж:: сетпропертисеттер**](iamtimelineobj-setpropertysetter.md) .

Структура [**\_ param Декстер**](dexter-param.md) указывает, какое свойство задается. Он содержит следующие члены.

-   **Name**: имя свойства.
-   **DISPID**: reserved, должен быть равен нулю
-   **nзначения**: число значений

\_Структура значения Декстер задает значение свойства в определенный момент времени. Он содержит следующие члены.

-   **v**: тип Variant, указывающий новое значение для свойства. Элемент **VT** в этом варианте определяет тип данных свойства. дополнительные сведения о типе **варианта** см. в Windows SDK.
-   **RT**: время ссылки, когда свойство принимает это значение относительно времени начала действия или перехода. Время начала действия или перехода задается относительно времени начала родительского объекта.
-   **двинтерп**: флаг, указывающий, каким образом свойство меняет предыдущее значение на новое значение. При использовании \_ флага перехода декстерф свойство немедленно переходит к новому значению в указанное время. При использовании \_ флага интерполяции декстерф свойство линейно передается из предыдущего значения.

Если присвоить элементу **VT** значение VT \_ BSTR, метод задания свойств выполняет все необходимые преобразования. Для значений с плавающей запятой включите начальный ноль перед десятичной запятой. Например, 0,3, а не. 3.

> [!Note]  
> Приложения не должны полагаться на преобразование из **BSTR** s в числовые значения. Если свойство имеет числовое значение, возможно использование соответствующего числового типа **Variant** .

 

Значение свойства может изменяться со временем, поэтому метод [**ипропертисеттер:: аддпроп**](ipropertysetter-addprop.md) принимает одну структуру [**\_ param Декстер**](dexter-param.md) и указатель на массив [**декстерных структур \_ значений**](dexter-value.md) . Массив определяет набор значений, основанных на времени для свойства. Элементы массива должны быть в порядке возрастания времени, а элемент **nзначения** \_ структуры param Декстер должен равняться длине массива.

В следующем примере кода создаются данные свойства для перехода на [очистку SMPTE](smpte-wipe-transition.md) . Он устанавливает для кода очистки значение 120, при котором создается очистка овала. Он устанавливает время ссылки равным нулю, указывая начало перехода.


```C++
IPropertySetter     *pProp;   // Property setter
IAMTimelineObj      *pTransObj;  // Transition object
// Create an SMPTE Wipe transition object. (Not shown)

hr = CoCreateInstance(CLSID_PropertySetter, NULL, CLSCTX_INPROC_SERVER,
    IID_IPropertySetter, (void**) &pProp);

// Error checking is omitted for clarity...

DEXTER_PARAM param;
DEXTER_VALUE *pValue = (DEXTER_VALUE*)CoTaskMemAlloc(sizeof(DEXTER_VALUE));

// Initialize the parameter. 
param.Name = SysAllocString(L"MaskNum");
param.dispID = 0;
param.nValues = 1;

// Initialize the value.
pValue->v.vt = VT_I4;
pValue->v.lVal = 120; // Oval
pValue->rt = 0;
pValue->dwInterp = DEXTERF_JUMP;

pProp->AddProp(param, pValue);

// Free allocated resources.
SysFreeString(param.Name);
VariantClear(&(pValue->v));
CoTaskMemFree(pValue);

// Set the property on the transition.
pTransObj->SetPropertySetter(pProp);
pProp->Release();
```



**Динамическое изменение свойств**

После отрисовки проекта редактирования видео можно изменить свойства эффектов или объекта перехода во время работы графа. Однако это возможно только в том случае, если задать свойства для этого объекта до того, как приложение будет называться [**ирендеренгине:: коннектфронтенд**](irenderengine-connectfrontend.md). Если это так, можно вызвать [**иамтимелинеобж:: жетпропертисеттер**](iamtimelineobj-getpropertysetter.md) для действия или перехода, очистить или изменить свойства, и изменения будут выполняться динамически при выполнении графа. В процессе изменения могут возникать визуальные аномалии, поэтому рекомендуется только для предварительной версии. Не изменяйте свойства при записи проекта в файл.

Если вы не устанавливали какие-либо свойства для объекта Effect или Transition перед вызовом **коннектфронтенд**, вы не сможете добавить свойства в него во время работы графа.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Работа с эффектами и переходами](working-with-effects-and-transitions.md)
</dt> </dl>

 

 



