---
description: Повторное подключение ПИН-кодов
ms.assetid: 34b3e4de-e4eb-48c5-aaef-fc99b63e8691
title: Повторное подключение ПИН-кодов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9fc71b4d5a62ee066edaa5f97b4cc3332b2231d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104537142"
---
# <a name="reconnecting-pins"></a><span data-ttu-id="b84c2-103">Повторное подключение ПИН-кодов</span><span class="sxs-lookup"><span data-stu-id="b84c2-103">Reconnecting Pins</span></span>

<span data-ttu-id="b84c2-104">При подключении через ПИН-код фильтр может отключиться и повторно подключить один из его других ПИН-кодов, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="b84c2-104">During a pin connection, a filter can disconnect and reconnect one of its other pins, as follows:</span></span>

1.  <span data-ttu-id="b84c2-105">Фильтр вызывает [**Ипин:: куерякцепт**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) в ПИН-коде другого фильтра и указывает новый тип носителя.</span><span class="sxs-lookup"><span data-stu-id="b84c2-105">The filter calls [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) on the other filter's pin, and specifies the new media type.</span></span>
2.  <span data-ttu-id="b84c2-106">Если **куерякцепт** возвращает " \_ ОК", фильтр вызывает [**IFilterGraph2:: реконнектекс**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph2-reconnectex) для повторного подключения ПИН-кодов.</span><span class="sxs-lookup"><span data-stu-id="b84c2-106">If **QueryAccept** returns S\_OK, the filter calls [**IFilterGraph2::ReconnectEx**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph2-reconnectex) to reconnect the pins.</span></span>

<span data-ttu-id="b84c2-107">Ниже приведены некоторые примеры того, когда для фильтра может потребоваться повторное подключение ПИН-кодов.</span><span class="sxs-lookup"><span data-stu-id="b84c2-107">The following are some examples of when a filter might need to reconnect pins:</span></span>

-   <span data-ttu-id="b84c2-108">**Фильтры Tee.**</span><span class="sxs-lookup"><span data-stu-id="b84c2-108">**Tee filters.**</span></span> <span data-ttu-id="b84c2-109">*Фильтр tee* разделяет входной поток на несколько выходов без изменения данных в потоке.</span><span class="sxs-lookup"><span data-stu-id="b84c2-109">A *tee filter* splits an input stream into multiple outputs without changing the data in the stream.</span></span> <span data-ttu-id="b84c2-110">Фильтр tee может принимать ряд типов мультимедиа, но типы должны совпадать во всех соединениях ПИН-кода.</span><span class="sxs-lookup"><span data-stu-id="b84c2-110">A tee filter can accept a range of media types, but the types must match across all pin connections.</span></span> <span data-ttu-id="b84c2-111">Поэтому при подключении входного ПИН-кода фильтру может потребоваться повторное согласование существующих соединений с выходными контактами и наоборот.</span><span class="sxs-lookup"><span data-stu-id="b84c2-111">Therefore, when the input pin connects, the filter might need to renegotiate any existing connections on the output pins, and vice versa.</span></span> <span data-ttu-id="b84c2-112">Пример см. в примере [фильтра инфти](inftee-filter-sample.md).</span><span class="sxs-lookup"><span data-stu-id="b84c2-112">For an example, see the [InfTee Filter Sample](inftee-filter-sample.md).</span></span>
-   <span data-ttu-id="b84c2-113">**Фильтры на месте.**</span><span class="sxs-lookup"><span data-stu-id="b84c2-113">**Trans-in-place filters.**</span></span> <span data-ttu-id="b84c2-114">Фильтр *на месте* изменяет входные данные в исходном буфере вместо копирования данных в отдельный выходной буфер.</span><span class="sxs-lookup"><span data-stu-id="b84c2-114">A *trans-in-place* filter modifies the input data in the original buffer instead of copying the data to a separate output buffer.</span></span> <span data-ttu-id="b84c2-115">Фильтр переноса на месте должен использовать один и тот же распределитель как для вышестоящего, так и для подчиненного подключений.</span><span class="sxs-lookup"><span data-stu-id="b84c2-115">A trans-in-place filter must use the same allocator for both the upstream and the downstream connections.</span></span> <span data-ttu-id="b84c2-116">Первый ПИН-код для подключения (входной или выходной) согласовывает распределитель обычным способом.</span><span class="sxs-lookup"><span data-stu-id="b84c2-116">The first pin to connect (input or output) negotiates an allocator in the usual way.</span></span> <span data-ttu-id="b84c2-117">Однако при подключении другого ПИН-кода первый распределитель может оказаться неприемлемым.</span><span class="sxs-lookup"><span data-stu-id="b84c2-117">When the other pin connects, however, the first allocator might not be acceptable.</span></span> <span data-ttu-id="b84c2-118">В этом случае второй ПИН-код выбирает другой распределитель, и первый ПИН-код повторно подключается с помощью нового распределителя.</span><span class="sxs-lookup"><span data-stu-id="b84c2-118">In that case, the second pin chooses a different allocator, and the first pin reconnects using the new allocator.</span></span> <span data-ttu-id="b84c2-119">Пример реализации см. в описании класса [**ктрансинплацефилтер**](ctransinplacefilter.md) .</span><span class="sxs-lookup"><span data-stu-id="b84c2-119">For an example implementation, see the [**CTransInPlaceFilter**](ctransinplacefilter.md) class.</span></span>

<span data-ttu-id="b84c2-120">В методе **Реконнектекс** диспетчер графа фильтров асинхронно отключает и повторно подключает ПИН-коды.</span><span class="sxs-lookup"><span data-stu-id="b84c2-120">In the **ReconnectEx** method, the Filter Graph Manager asynchronously disconnects and reconnects the pins.</span></span> <span data-ttu-id="b84c2-121">Фильтр не должен предпринимать попытки повторного подключения, если **куерякцепт** не возвращает значение " \_ ОК".</span><span class="sxs-lookup"><span data-stu-id="b84c2-121">The filter must not attempt the reconnection unless **QueryAccept** returns S\_OK.</span></span> <span data-ttu-id="b84c2-122">В противном случае ПИН-код останется отключенным, что приведет к ошибкам графа.</span><span class="sxs-lookup"><span data-stu-id="b84c2-122">Otherwise, the pin will be left disconnected, causing graph errors.</span></span> <span data-ttu-id="b84c2-123">Кроме того, фильтр должен запросить повторное подключение из метода [**Ипин:: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) в том же потоке.</span><span class="sxs-lookup"><span data-stu-id="b84c2-123">Also, the filter should request the reconnection from inside the [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) method, on the same thread.</span></span> <span data-ttu-id="b84c2-124">Если метод **Connect** возвращается в одном потоке, в то время как другой поток выполняет запрос на повторное подключение, диспетчер графа фильтров может запустить граф до того, как будет выполнено повторное подключение, что приведет к ошибкам графа.</span><span class="sxs-lookup"><span data-stu-id="b84c2-124">If the **Connect** method returns on one thread, while another thread makes the reconnection request, the Filter Graph Manager might run the graph before it makes the reconnection, causing graph errors.</span></span>

 

 



