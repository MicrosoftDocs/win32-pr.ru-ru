---
description: Использование потоков мультимедиа в приложениях
ms.assetid: 73cfe89b-df46-445a-92c7-2f7323672441
title: Использование потоков мультимедиа в приложениях
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f30dab204bc7b0bddbdc293708daecbe0558e8f9
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "103999923"
---
# <a name="using-multimedia-streams-in-applications"></a><span data-ttu-id="cf318-103">Использование потоков мультимедиа в приложениях</span><span class="sxs-lookup"><span data-stu-id="cf318-103">Using Multimedia Streams in Applications</span></span>

> [!Note]  
> <span data-ttu-id="cf318-104">Эти API-интерфейсы являются устаревшими.</span><span class="sxs-lookup"><span data-stu-id="cf318-104">These APIs are deprecated.</span></span> <span data-ttu-id="cf318-105">Приложения должны использовать [**образец фильтра захвата**](sample-grabber-filter.md) или реализовать настраиваемый фильтр для получения данных из графа фильтра DirectShow.</span><span class="sxs-lookup"><span data-stu-id="cf318-105">Applications should use the [**Sample Grabber**](sample-grabber-filter.md) filter or implement a custom filter to get data from a DirectShow filter graph.</span></span>

 

<span data-ttu-id="cf318-106">Интерфейсы потоковой передачи мультимедиа значительно упрощают процесс манипулирования данными мультимедиа за счет удаления зависимости от конкретных характеристик оборудования или программного обеспечения и предоставления поддержки всех форматов мультимедиа Microsoft DirectX®.</span><span class="sxs-lookup"><span data-stu-id="cf318-106">The multimedia streaming interfaces greatly simplify the process of manipulating multimedia data by removing the dependency on specific characteristics of the hardware or software source and providing support for all Microsoft DirectX® media formats.</span></span> <span data-ttu-id="cf318-107">Потоки применяют данные к очень высокому уровню. приложения могут даже перемещать данные из одного потока в другой, не зная никаких сведений о формате данных.</span><span class="sxs-lookup"><span data-stu-id="cf318-107">Streams abstract the data to a very high level; applications can even move data from one stream to another without knowing anything about the data's format.</span></span>

<span data-ttu-id="cf318-108">Чтобы создать поток мультимедиа, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="cf318-108">Perform the following steps to create a multimedia stream.</span></span>

1.  <span data-ttu-id="cf318-109">Создайте поток мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="cf318-109">Create the multimedia stream.</span></span> <span data-ttu-id="cf318-110">Метод создания и инициализации потока зависит от архитектуры.</span><span class="sxs-lookup"><span data-stu-id="cf318-110">The method of creation and initialization of the stream is architecture specific.</span></span> <span data-ttu-id="cf318-111">DirectShow поддерживает интерфейс [**иаммултимедиастреам**](/previous-versions/windows/desktop/api/amstream/nn-amstream-iammultimediastream) , который используется для инициализации потока.</span><span class="sxs-lookup"><span data-stu-id="cf318-111">DirectShow supports the [**IAMMultiMediaStream**](/previous-versions/windows/desktop/api/amstream/nn-amstream-iammultimediastream) interface, which is used to initialize the stream.</span></span> <span data-ttu-id="cf318-112">Другие реализации внутрипроцессного сервера [**имултимедиастреам**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-imultimediastream) будут созданы и инициализированы с помощью различных механизмов.</span><span class="sxs-lookup"><span data-stu-id="cf318-112">Other in-process server implementations of [**IMultiMediaStream**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-imultimediastream) will be created and initialized using different mechanisms.</span></span>
2.  <span data-ttu-id="cf318-113">После инициализации объекта потока мультимедиа приложение будет использовать **QueryInterface** для получения интерфейса **имултимедиастреам** для объекта.</span><span class="sxs-lookup"><span data-stu-id="cf318-113">After the multimedia stream object is initialized, the application will use **QueryInterface** to retrieve the **IMultiMediaStream** interface for the object.</span></span> <span data-ttu-id="cf318-114">Используйте этот интерфейс для определения свойств потока и перечисления самих потоков.</span><span class="sxs-lookup"><span data-stu-id="cf318-114">Use this interface to determine the stream's properties and enumerate the streams themselves.</span></span> <span data-ttu-id="cf318-115">Вы можете получить конкретный поток, вызвав метод [**имултимедиастреам:: жетмедиастреам**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) с конкретным идентификатором цели.</span><span class="sxs-lookup"><span data-stu-id="cf318-115">You can retrieve a specific stream by calling the [**IMultiMediaStream::GetMediaStream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) method with a specific purpose ID.</span></span> <span data-ttu-id="cf318-116">МСПИД \_ примаривидео и мспид \_ примаряудио, которые представляют основные видеопотоки и звуковые потоки, являются наиболее часто используемыми идентификаторами целей.</span><span class="sxs-lookup"><span data-stu-id="cf318-116">MSPID\_PrimaryVideo and MSPID\_PrimaryAudio, which represent the primary video and audio streams, are the most commonly used purpose IDs.</span></span>
3.  <span data-ttu-id="cf318-117">Вызовите метод **IUnknown:: QueryInterface** для интерфейса, относящегося к типу мультимедиа потока.</span><span class="sxs-lookup"><span data-stu-id="cf318-117">Call **IUnknown::QueryInterface** for an interface specific to the stream's media type.</span></span> <span data-ttu-id="cf318-118">Например, если необходимо отобразить видеопоток, то можно получить его интерфейс [**идиректдравмедиастреам**](/previous-versions/windows/desktop/api/ddstream/nn-ddstream-idirectdrawmediastream) .</span><span class="sxs-lookup"><span data-stu-id="cf318-118">If you want to render a video stream, for example, retrieve its [**IDirectDrawMediaStream**](/previous-versions/windows/desktop/api/ddstream/nn-ddstream-idirectdrawmediastream) interface.</span></span> <span data-ttu-id="cf318-119">Интерфейсы для конкретных носителей определяют дополнительные методы, необходимые для полного использования возможностей формата.</span><span class="sxs-lookup"><span data-stu-id="cf318-119">Media-specific interfaces define additional methods necessary for taking full advantage of a format's capabilities.</span></span>
4.  <span data-ttu-id="cf318-120">Создайте один или несколько выборок из потоковых данных.</span><span class="sxs-lookup"><span data-stu-id="cf318-120">Create one or more samples from the stream data.</span></span> <span data-ttu-id="cf318-121">Каждый поток мультимедиа поддерживает метод [**имедиастреам:: креатешаредсампле**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) для создания образца.</span><span class="sxs-lookup"><span data-stu-id="cf318-121">Every media stream supports the [**IMediaStream::CreateSharedSample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) method for sample creation.</span></span> <span data-ttu-id="cf318-122">Полученный пример поддерживает интерфейс [**истреамсампле**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-istreamsample) , который обеспечивает контроль над образцом и его характеристиками.</span><span class="sxs-lookup"><span data-stu-id="cf318-122">The resulting sample supports the [**IStreamSample**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-istreamsample) interface, which provides control over the sample and its characteristics.</span></span> <span data-ttu-id="cf318-123">Как правило, поток мультимедиа поддерживает метод образца создания, зависящий от формата, который является более мощным, чем вышеупомянутые методы **истреамсампле** .</span><span class="sxs-lookup"><span data-stu-id="cf318-123">Typically, the media stream supports a format-specific method of sample creation that is more powerful than the aforementioned **IStreamSample** methods.</span></span> <span data-ttu-id="cf318-124">**Идиректдравмедиастреам**, например, может создавать образцы, присоединенные к нужной поверхности DirectDraw и прямоугольнику обрезки.</span><span class="sxs-lookup"><span data-stu-id="cf318-124">**IDirectDrawMediaStream**, for example, can create samples attached to a desired DirectDraw surface and clipping rectangle.</span></span> <span data-ttu-id="cf318-125">Однако в некоторых ситуациях необходимо выполнять обработку данных, не зная о своем формате данных.</span><span class="sxs-lookup"><span data-stu-id="cf318-125">In some situations, however, you must handle data without knowing about its data format.</span></span> <span data-ttu-id="cf318-126">Если требуется потоковая передача данных независимо от их формата, используйте метод **имедиастреам:: креатешаредсампле** для создания образцов данных.</span><span class="sxs-lookup"><span data-stu-id="cf318-126">If you want to stream data independent of its format, use the **IMediaStream::CreateSharedSample** method to create the data samples.</span></span>
5.  <span data-ttu-id="cf318-127">После создания всех требуемых примеров потока Запустите поток, вызвав метод [**имултимедиастреам:: setState**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-setstate) и передав в \_ качестве параметра флаг запуска стреамстате.</span><span class="sxs-lookup"><span data-stu-id="cf318-127">After creating all desired stream samples, start the stream by calling the [**IMultiMediaStream::SetState**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-setstate) method and pass in the STREAMSTATE\_RUN flag as its parameter.</span></span>
6.  <span data-ttu-id="cf318-128">Вызовите метод [**истреамсампле:: Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) , чтобы обновить пример потока.</span><span class="sxs-lookup"><span data-stu-id="cf318-128">Call [**IStreamSample::Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) to update the stream sample.</span></span> <span data-ttu-id="cf318-129">При выходе из метода **истреамсампле:: Update** можно получить доступ к данным примера.</span><span class="sxs-lookup"><span data-stu-id="cf318-129">When the **IStreamSample::Update** method exits, you can access the sample's data.</span></span> <span data-ttu-id="cf318-130">Если требуется активировать определенное событие или вызов функции при возврате обновления, передайте соответствующие указатели методу **истреамсампле:: Update** .</span><span class="sxs-lookup"><span data-stu-id="cf318-130">If you want a trigger a specific event or function call when the update returns, pass the appropriate pointers to the **IStreamSample::Update** method.</span></span>

<span data-ttu-id="cf318-131">Дополнительные сведения об интерфейсах потоковой передачи мультимедиа см. в разделе [потоковая передача мультимедиа](multimedia-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="cf318-131">For more information on the multimedia streaming interfaces, see [Multimedia Streaming](multimedia-streaming.md).</span></span>

 

 



