---
description: Закрепление подключений
ms.assetid: 1406ade4-77d8-49a7-8f36-cc49ff007a26
title: Закрепление подключений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b509abddf4a915b65dfd322f76b4afb132a7f835
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104416589"
---
# <a name="pin-connections"></a><span data-ttu-id="4ea83-103">Закрепление подключений</span><span class="sxs-lookup"><span data-stu-id="4ea83-103">Pin Connections</span></span>

<span data-ttu-id="4ea83-104">Фильтры подключаются к своим ПИН-кода через интерфейс [**Ипин**](/windows/desktop/api/Strmif/nn-strmif-ipin) .</span><span class="sxs-lookup"><span data-stu-id="4ea83-104">Filters connect at their pins, through the [**IPin**](/windows/desktop/api/Strmif/nn-strmif-ipin) interface.</span></span> <span data-ttu-id="4ea83-105">Выходные контакты подключаются к входным креплениям.</span><span class="sxs-lookup"><span data-stu-id="4ea83-105">Output pins connect to input pins.</span></span> <span data-ttu-id="4ea83-106">Каждое подключение к ПИН-коду имеет тип носителя, который описывается структурой [**\_ \_ типа носителя AM**](/windows/win32/api/strmif/ns-strmif-am_media_type) .</span><span class="sxs-lookup"><span data-stu-id="4ea83-106">Each pin connection has a media type, described by the [**AM\_MEDIA\_TYPE**](/windows/win32/api/strmif/ns-strmif-am_media_type) structure.</span></span>

<span data-ttu-id="4ea83-107">Приложение подключается к фильтрам, вызывая методы в диспетчере графов фильтров, никогда не вызывая методы для самих фильтров или ПИН-кодов.</span><span class="sxs-lookup"><span data-stu-id="4ea83-107">An application connects filters by calling methods on the Filter Graph Manager, never by calling methods on the filters or pins themselves.</span></span> <span data-ttu-id="4ea83-108">Приложение может непосредственно указать, какие фильтры следует подключить, вызвав метод [**ифилтерграф:: коннектдирект**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-connectdirect) или [**Играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) ; Кроме того, он может напрямую подключать фильтры с помощью метода построения графа, такого как [**играфбуилдер:: renderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile).</span><span class="sxs-lookup"><span data-stu-id="4ea83-108">The application can directly specify which filters to connect, by calling the [**IFilterGraph::ConnectDirect**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-connectdirect) or [**IGraphBuilder::Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) method; or it can connect filters indirectly, using a graph-building method such as [**IGraphBuilder::RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile).</span></span>

<span data-ttu-id="4ea83-109">Для успешности соединения оба фильтра должны находиться в графе фильтра.</span><span class="sxs-lookup"><span data-stu-id="4ea83-109">For the connection to succeed, both filters must be in the filter graph.</span></span> <span data-ttu-id="4ea83-110">Приложение может добавить фильтр к графу, вызвав метод [**ифилтерграф:: аддфилтер**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-addfilter) .</span><span class="sxs-lookup"><span data-stu-id="4ea83-110">The application can add a filter to the graph by calling the [**IFilterGraph::AddFilter**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-addfilter) method.</span></span> <span data-ttu-id="4ea83-111">Диспетчер графов фильтров может также добавлять фильтры на диаграмму.</span><span class="sxs-lookup"><span data-stu-id="4ea83-111">The Filter Graph Manager may add filters to the graph, as well.</span></span> <span data-ttu-id="4ea83-112">При добавлении фильтра диспетчер графа фильтров вызывает метод [**ибасефилтер:: жоинфилтерграф**](/windows/desktop/api/Strmif/nf-strmif-ibasefilter-joinfiltergraph) фильтра, чтобы уведомить фильтр.</span><span class="sxs-lookup"><span data-stu-id="4ea83-112">When a filter is added, the Filter Graph Manager calls the filter's [**IBaseFilter::JoinFilterGraph**](/windows/desktop/api/Strmif/nf-strmif-ibasefilter-joinfiltergraph) method to notify the filter.</span></span>

<span data-ttu-id="4ea83-113">Общая структура процесса подключения следующая:</span><span class="sxs-lookup"><span data-stu-id="4ea83-113">The general outline of the connection process is the following:</span></span>

1.  <span data-ttu-id="4ea83-114">Диспетчер графов фильтров вызывает [**Ипин:: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) на выходном закрепление, передавая указатель на входной ПИН-код.</span><span class="sxs-lookup"><span data-stu-id="4ea83-114">The Filter Graph Manager calls [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) on the output pin, passing a pointer to the input pin.</span></span>
2.  <span data-ttu-id="4ea83-115">Если выходной ПИН-код принимает соединение, он вызывает [**Ипин:: рецеивеконнектион**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) для входного ПИН-кода.</span><span class="sxs-lookup"><span data-stu-id="4ea83-115">If the output pin accepts the connection, it calls [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) on the input pin.</span></span>
3.  <span data-ttu-id="4ea83-116">Если входной ПИН-код также принимает подключение, то попытки подключения будут выполнены, а контакты будут подключены.</span><span class="sxs-lookup"><span data-stu-id="4ea83-116">If the input pin also accepts the connection, the connection attempt succeeds and the pins are connected.</span></span>

<span data-ttu-id="4ea83-117">Некоторые ПИН-коды могут быть отключены и повторно подключены, пока фильтр активен.</span><span class="sxs-lookup"><span data-stu-id="4ea83-117">Some pins can be disconnected and reconnected while the filter is active.</span></span> <span data-ttu-id="4ea83-118">Этот тип повторного подключения называется *динамическим* переподключением.</span><span class="sxs-lookup"><span data-stu-id="4ea83-118">This type of reconnection is called a *dynamic* reconnection.</span></span> <span data-ttu-id="4ea83-119">Дополнительные сведения см. в разделе [динамическое построение графа](dynamic-graph-building.md).</span><span class="sxs-lookup"><span data-stu-id="4ea83-119">For more information, see [Dynamic Graph Building](dynamic-graph-building.md).</span></span> <span data-ttu-id="4ea83-120">Однако большинство фильтров не поддерживают динамическое повторное подключение.</span><span class="sxs-lookup"><span data-stu-id="4ea83-120">However, most filters do not support dynamic reconnection.</span></span>

<span data-ttu-id="4ea83-121">Фильтры обычно соединяются в нисходящем порядке — иными словами, входные сигналы фильтра соединяются до закрепления выходных данных.</span><span class="sxs-lookup"><span data-stu-id="4ea83-121">Filters are usually connected in downstream order—in other words, the filter's input pins are connected before its output pins.</span></span> <span data-ttu-id="4ea83-122">Фильтр должен всегда поддерживать этот порядок соединения.</span><span class="sxs-lookup"><span data-stu-id="4ea83-122">A filter should always support this order of connection.</span></span> <span data-ttu-id="4ea83-123">Некоторые фильтры также поддерживают соединения в обратном порядке — сначала закрепления вывода, а затем входные ПИН-коды.</span><span class="sxs-lookup"><span data-stu-id="4ea83-123">Some filters also support connections in the opposite order—output pins first, followed by input pins.</span></span> <span data-ttu-id="4ea83-124">Например, можно подключить выходную закрепление фильтра МУЛЬТИПЛЕКСОРа к фильтру записи файлов, прежде чем подключать входные сигналы фильтра МУЛЬТИПЛЕКСОРа.</span><span class="sxs-lookup"><span data-stu-id="4ea83-124">For example, it might be possible to connect a MUX filter's output pin to the file-writer filter, before connecting the MUX filter's input pins.</span></span>

<span data-ttu-id="4ea83-125">При вызове метода **Connect** или **рецеивеконнектион** ПИН-код должен проверить, может ли он поддерживать подключение.</span><span class="sxs-lookup"><span data-stu-id="4ea83-125">When a pin's **Connect** or **ReceiveConnection** method is called, the pin must verify that it can support the connection.</span></span> <span data-ttu-id="4ea83-126">Подробные сведения зависят от конкретного фильтра.</span><span class="sxs-lookup"><span data-stu-id="4ea83-126">The details depend on the particular filter.</span></span> <span data-ttu-id="4ea83-127">Ниже перечислены наиболее распространенные задачи.</span><span class="sxs-lookup"><span data-stu-id="4ea83-127">The most common tasks include the following:</span></span>

-   <span data-ttu-id="4ea83-128">Проверка допустимости типа носителя</span><span class="sxs-lookup"><span data-stu-id="4ea83-128">Check that the media type is acceptable</span></span>
-   <span data-ttu-id="4ea83-129">Согласование распределителя</span><span class="sxs-lookup"><span data-stu-id="4ea83-129">Negotiate an allocator</span></span>
-   <span data-ttu-id="4ea83-130">Запросите другой ПИН-код для требуемых интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="4ea83-130">Query the other pin for required interfaces.</span></span>

 

 



