---
description: Необязательные потоки
ms.assetid: 94477a71-c267-4602-893b-1bd1256b34ef
title: Необязательные потоки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940be49196396aa2d1fa71502213b0d4fbacb5ea
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "105682219"
---
# <a name="optional-streams"></a><span data-ttu-id="738d4-103">Необязательные потоки</span><span class="sxs-lookup"><span data-stu-id="738d4-103">Optional Streams</span></span>

<span data-ttu-id="738d4-104">DMO может обозначать некоторые из его выходных потоков как необязательные.</span><span class="sxs-lookup"><span data-stu-id="738d4-104">A DMO can designate some of its output streams as optional.</span></span> <span data-ttu-id="738d4-105">Необязательный поток создает данные, которые приложение может отбросить, полностью или в случайном виде.</span><span class="sxs-lookup"><span data-stu-id="738d4-105">An optional stream produces data that the application can discard, either completely or on occasional samples.</span></span> <span data-ttu-id="738d4-106">Например, необязательный поток может содержать дополнительные сведения о первичном потоке.</span><span class="sxs-lookup"><span data-stu-id="738d4-106">For example, an optional stream might contain additional information about a primary stream.</span></span>

<span data-ttu-id="738d4-107">Чтобы запросить, является ли поток необязательным, вызовите метод [**имедиаобжект:: жетаутпутстреаминфо**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputstreaminfo) и проверьте параметр *пдвфлагс* .</span><span class="sxs-lookup"><span data-stu-id="738d4-107">To query whether a stream is optional, call the [**IMediaObject::GetOutputStreamInfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputstreaminfo) method and check the *pdwFlags* parameter.</span></span> <span data-ttu-id="738d4-108">Необязательные потоки возвращают \_ либо \_ флаг стреамф, либо \_ \_ \_ \_ необязательный флаг DMO Output стреамф.</span><span class="sxs-lookup"><span data-stu-id="738d4-108">Optional streams return either the DMO\_OUTPUT\_STREAMF\_DISCARDABLE flag or the DMO\_OUTPUT\_STREAMF\_OPTIONAL flag.</span></span> <span data-ttu-id="738d4-109">Эти флаги означают почти то же самое; одно небольшое различие между ними будет объяснено чуть ниже.</span><span class="sxs-lookup"><span data-stu-id="738d4-109">These flags mean almost the same thing; one minor difference between them will be explained shortly.</span></span>

<span data-ttu-id="738d4-110">Если поток является необязательным, клиент может указать, что DMO будет отбрасывать данные из этого потока при обработке выходных данных.</span><span class="sxs-lookup"><span data-stu-id="738d4-110">If a stream is optional, the client can instruct the DMO to discard data from that stream when it processes the output.</span></span> <span data-ttu-id="738d4-111">Для этого вызовите метод [**имедиаобжект::P роцессаутпут**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-processoutput) и установите для выходного буфера **значение NULL** для каждого потока, который нужно отменить.</span><span class="sxs-lookup"><span data-stu-id="738d4-111">To do so, call the [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-processoutput) method and set the output buffer to **NULL** for each stream that you wish to discard.</span></span> <span data-ttu-id="738d4-112">(Выходной буфер указывается в элементе **pBuffer** [**\_ \_ \_ буфера выходных данных DMO**](/previous-versions/windows/desktop/api/Mediaobj/ns-mediaobj-dmo_output_data_buffer).) Кроме того, задайте \_ для \_ параметра выходные данные процесса DMO значение \_ отбросить, \_ Если \_ \_ в параметре *dwFlags* не задан флаг буфера.</span><span class="sxs-lookup"><span data-stu-id="738d4-112">(The output buffer is specified in the **pBuffer** member of the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/Mediaobj/ns-mediaobj-dmo_output_data_buffer).) Also set the DMO\_PROCESS\_OUTPUT\_DISCARD\_WHEN\_NO\_BUFFER flag in the *dwFlags* parameter.</span></span>

<span data-ttu-id="738d4-113">Для каждого потока, в котором указатель *pBuffer* имеет **значение NULL**, DMO предпримет попытку удалить данные.</span><span class="sxs-lookup"><span data-stu-id="738d4-113">For each stream where the *pBuffer* pointer is **NULL**, the DMO will attempt to discard the data.</span></span> <span data-ttu-id="738d4-114">Если поток необязателен, DMO гарантирует отклонять данные.</span><span class="sxs-lookup"><span data-stu-id="738d4-114">If the stream is optional, the DMO is guaranteed to discard the data.</span></span> <span data-ttu-id="738d4-115">Если поток не является необязательным, DMO удаляет данные, когда это возможно, но не гарантирует это.</span><span class="sxs-lookup"><span data-stu-id="738d4-115">If the stream is not optional, the DMO discards the data when possible, but is not guaranteed to do so.</span></span> <span data-ttu-id="738d4-116">Если данные не могут быть потеряны, задается \_ \_ \_ \_ флаг незавершенных выходных данных DMO буфферф.</span><span class="sxs-lookup"><span data-stu-id="738d4-116">If it cannot discard the data, it sets the DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE flag.</span></span> <span data-ttu-id="738d4-117">Если задать в качестве указателя *PBuffer* **значение NULL** , но не задать для параметра "вывод процесса DMO" значение "нет" \_ \_ \_ \_ , если не задан \_ \_ флаг буфера, то DMO не отбрасывает данные.</span><span class="sxs-lookup"><span data-stu-id="738d4-117">If you set a *pBuffer* pointer to **NULL** but do not set the DMO\_PROCESS\_OUTPUT\_DISCARD\_WHEN\_NO\_BUFFER flag, the DMO does not discard the data.</span></span> <span data-ttu-id="738d4-118">В этом случае DMO либо помещает выходные данные в буфер на внутреннем уровне, либо просто завершает вызов **ProcessOutput** .</span><span class="sxs-lookup"><span data-stu-id="738d4-118">In that case, the DMO either buffers the output internally, or simply fails the **ProcessOutput** call.</span></span>

<span data-ttu-id="738d4-119">Единственное функциональное различие между \_ \_ необязательным флагом стреамф для выходных данных DMO \_ и \_ \_ \_ отброшенным флагом стреамфа DMO имеет следующий результат:</span><span class="sxs-lookup"><span data-stu-id="738d4-119">The only functional difference between the DMO\_OUTPUT\_STREAMF\_OPTIONAL flag and the DMO\_OUTPUT\_STREAMF\_DISCARDABLE flag is the following:</span></span>

-   <span data-ttu-id="738d4-120">\_ \_ Необязательный флаг DMO Output стреамф \_ указывает, что клиенту не нужно задавать тип мультимедиа в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="738d4-120">The DMO\_OUTPUT\_STREAMF\_OPTIONAL flag indicates that the client does not have to set a media type on that stream.</span></span> <span data-ttu-id="738d4-121">Однако если клиент начинает обработку данных без задания типа носителя для этого потока, он должен отбросить данные из этого потока на всю длительность потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="738d4-121">However, if the client begins processing data without setting the media type for that stream, then it must discard the data from that stream for the entire duration of streaming.</span></span> <span data-ttu-id="738d4-122">Если требуется отменить выбор образцов, необходимо задать тип носителя.</span><span class="sxs-lookup"><span data-stu-id="738d4-122">If you want to discard samples selectively, then you must set the media type.</span></span>
-   <span data-ttu-id="738d4-123">\_ \_ Флаг СТРЕАМФ вывода DMO \_ указывает, что, хотя поток является необязательным, ему всегда требуется тип мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="738d4-123">The DMO\_OUTPUT\_STREAMF\_DISCARDABLE flag indicates that, although the stream is optional, it always requires a media type.</span></span>

## <a name="related-topics"></a><span data-ttu-id="738d4-124">См. также</span><span class="sxs-lookup"><span data-stu-id="738d4-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="738d4-125">Непосредственное размещение DMO</span><span class="sxs-lookup"><span data-stu-id="738d4-125">Directly Hosting a DMO</span></span>](directly-hosting-a-dmo.md)
</dt> </dl>

 

 



