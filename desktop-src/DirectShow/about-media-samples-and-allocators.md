---
description: О примерах носителей и распределителях
ms.assetid: d6283bf0-0460-4519-9a56-fd4c78cfaabc
title: О примерах носителей и распределителях
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b9105228e70f82aaa7c36b7e7d28cf7e748e1e2f
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "105684739"
---
# <a name="about-media-samples-and-allocators"></a>О примерах носителей и распределителях

Фильтры обеспечивают доставку данных по ПИН-соединениям. Данные перемещаются из выходного контакта одного фильтра в входной ПИН-код другого фильтра. Наиболее распространенным способом для доставки данных является вызов метода [**имеминпутпин:: Receive**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receive) на входе, хотя также существуют и некоторые другие механизмы.

В зависимости от фильтра память для данных мультимедиа может быть распределена различными способами: в куче, на поверхности DirectDraw, с использованием общей памяти GDI или с помощью другого механизма выделения. Объект, ответственный за выделение памяти, называется *распределителем*, который представляет собой COM-объект, предоставляющий интерфейс [**имемаллокатор**](/windows/desktop/api/Strmif/nn-strmif-imemallocator) .

При подключении двух контактов один из ПИН-кодов должен предоставлять распределитель. DirectShow определяет последовательность вызовов методов, которая используется для определения того, какой ПИН-код предоставляет распределитель. ПИН-коды также договариваются о количестве буферов, которые будут созданы распределителем, и размере буферов.

Перед началом потоковой передачи распределитель создает пул буферов. Во время потоковой передачи вышестоящий фильтр заполняет буферы данными и доставляет их в нисходящий фильтр. Но вышестоящий фильтр не предоставляет необработанные указатели подчиненного фильтра для буферов. Вместо этого он использует COM-объекты, называемые *примерами мультимедиа*, которые распределитель создает для управления буферами. Примеры носителей предоставляют интерфейс [**имедиасампле**](/windows/desktop/api/Strmif/nn-strmif-imediasample) . Пример носителя содержит:

-   Указатель на базовый буфер
-   Метка времени
-   различные флаги
-   При необходимости тип мультимедиа

Метка времени определяет время презентации, используемое фильтром модуля подготовки отчетов для планирования подготовки к просмотру. Флаги указывают на такие вещи, как наличие перерыва в данных с момента предыдущего примера. Тип мультимедиа позволяет фильтрам изменять форматы среднего потока. Обычно образец не имеет типа мультимедиа, что означает, что этот формат не изменился со времени предыдущего примера.

Хотя фильтр использует буфер, он содержит счетчик ссылок на выборку. Распределитель использует счетчик ссылок, чтобы определить, когда он может повторно использовать буфер. Это предотвращает перезапись буфера, который по-прежнему используется другим фильтром, в фильтре. Пример не возвращает доступ к пулу доступных выборок распределителя, пока не будет выпущен каждый фильтр.

Дополнительные сведения см. в следующих разделах:

-   В разделах [Samples and распределительы](samples-and-allocators.md) содержится более подробное описание работы распределительов.
-   В разделе [поток данных в графе фильтра](data-flow-in-the-filter-graph.md) представлены общие сведения о потоке данных в DirectShow.

Следующие разделы предназначены для разработчиков, создающих собственные настраиваемые фильтры:

-   [Поток данных для разработчиков фильтров](data-flow-for-filter-developers.md)
-   [Потоки и критические разделы](threads-and-critical-sections.md)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Граф фильтра и его компоненты](the-filter-graph-and-its-components.md)
</dt> </dl>

 

 



