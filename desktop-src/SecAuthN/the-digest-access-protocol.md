---
description: Протокол дайджест-доступа
ms.assetid: 7b2fd75e-dd0d-4a63-a84b-a64f08f883f2
title: Протокол дайджест-доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86aa8f05580c27c866c0568dbc67c4d5ba5c2016
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104569325"
---
# <a name="the-digest-access-protocol"></a><span data-ttu-id="9980e-103">Протокол дайджест-доступа</span><span class="sxs-lookup"><span data-stu-id="9980e-103">The Digest Access Protocol</span></span>

<span data-ttu-id="9980e-104">Протокол дайджест-доступа, указанный в [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt) , реализуется с помощью [*поставщика службы поддержки*](../secgloss/s-gly.md) Microsoft Digest Security (SSP).</span><span class="sxs-lookup"><span data-stu-id="9980e-104">The Digest Access protocol specified by [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt) is implemented by the Microsoft Digest [*security support provider*](../secgloss/s-gly.md) (SSP).</span></span> <span data-ttu-id="9980e-105">Реализация состоит из набора функций безопасности [интерфейса поставщика поддержки безопасности](sspi.md) (SSPI), которые вызываются клиентскими и серверными приложениями:</span><span class="sxs-lookup"><span data-stu-id="9980e-105">The implementation consists of a set of [Microsoft Security Support Provider Interface](sspi.md) (SSPI) security context functions that client/server applications call to:</span></span>

-   <span data-ttu-id="9980e-106">Установите [*контекст безопасности*](../secgloss/s-gly.md) для обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="9980e-106">Establish a [*security context*](../secgloss/s-gly.md) for message exchange.</span></span>
-   <span data-ttu-id="9980e-107">Получите объекты данных, необходимые для дайджест-SSP, например [*учетные данные*](../secgloss/c-gly.md) и дескрипторы контекста.</span><span class="sxs-lookup"><span data-stu-id="9980e-107">Obtain data objects required by the Digest SSP, such as [*credentials*](../secgloss/c-gly.md) and context handles.</span></span>
-   <span data-ttu-id="9980e-108">Доступ к механизмам [*обеспечения целостности*](../secgloss/i-gly.md) и конфиденциальности сообщений.</span><span class="sxs-lookup"><span data-stu-id="9980e-108">Access message [*integrity*](../secgloss/i-gly.md) and confidentiality mechanisms.</span></span>

<span data-ttu-id="9980e-109">Проверка подлинности с доступом выполняется в парных транзакциях запросов и ответов с запросами, происходящими на стороне клиента и ответов, происходящих на сервере.</span><span class="sxs-lookup"><span data-stu-id="9980e-109">Digest Access authentication takes place within paired request/response transactions, with requests originating on the client and responses originating on the server.</span></span> <span data-ttu-id="9980e-110">Успешная проверка подлинности с доступом дайджеста требует наличия двух пар "запрос-ответ".</span><span class="sxs-lookup"><span data-stu-id="9980e-110">A successful Digest Access authentication requires two request/response pairs.</span></span>

<span data-ttu-id="9980e-111">Если для проверки подлинности HTTP используется дайджест-поставщик, то соединение между первой и второй парой "запрос-ответ" не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="9980e-111">When the Digest SSP is used for HTTP authentication, there is no connection maintained between the first and second request/response pair.</span></span> <span data-ttu-id="9980e-112">Иными словами, сервер не ждет второго запроса после отправки первого ответа.</span><span class="sxs-lookup"><span data-stu-id="9980e-112">In other words, the server does not wait for the second request after it sends the first response.</span></span>

<span data-ttu-id="9980e-113">На следующем рисунке показаны действия, выполняемые на HTTP-пути клиентом и сервером для выполнения проверки подлинности с помощью дайджеста SSP.</span><span class="sxs-lookup"><span data-stu-id="9980e-113">The following illustration shows the steps taken on the HTTP path by a client and server to complete an authentication using the Digest SSP.</span></span> <span data-ttu-id="9980e-114">Механизм SASL использует взаимную проверку подлинности, поэтому данные проверки подлинности отправляются обратно на обратный вызов по УБЫВАНИЮ сервера клиенту, который проверяет, что клиент взаимодействует с правильным сервером.</span><span class="sxs-lookup"><span data-stu-id="9980e-114">The SASL mechanism makes use of mutual authentication, so authentication data is sent back on the final ASC server call to the client that verifies that the client is communicating with the correct server.</span></span>

![Протокол дайджест-доступа](images/digest1.png)

<span data-ttu-id="9980e-116">Процесс начинается с клиента, запрашивающего защищенный доступ к ресурсу с сервера путем отправки HTTP-запроса 1.</span><span class="sxs-lookup"><span data-stu-id="9980e-116">The process starts with the client requesting an access-protected resource from the server by sending HTTP Request 1.</span></span>

<span data-ttu-id="9980e-117">Сервер получает HTTP-запрос 1 и определяет, что ресурсу требуются данные проверки подлинности, которые не были добавлены в запрос.</span><span class="sxs-lookup"><span data-stu-id="9980e-117">The server receives HTTP Request 1 and determines that the resource requires authentication information that was not included in the request.</span></span> <span data-ttu-id="9980e-118">Сервер создает запрос для клиента следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9980e-118">The server generates a challenge for the client as follows:</span></span>

1.  <span data-ttu-id="9980e-119">Сервер получает свои [*учетные данные*](../secgloss/c-gly.md) , вызывая функцию [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) .</span><span class="sxs-lookup"><span data-stu-id="9980e-119">The server obtains its [*credentials*](../secgloss/c-gly.md) by calling the [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) function.</span></span>
2.  <span data-ttu-id="9980e-120">Сервер создает запрос дайджеста, вызывая функцию [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="9980e-120">The server generates the Digest challenge by calling the [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span>
3.  <span data-ttu-id="9980e-121">Сервер отправляет заголовок WWW-Authenticate в ответ на запрос клиента (отображается как HTTP-ответ 1).</span><span class="sxs-lookup"><span data-stu-id="9980e-121">The server sends a WWW-Authenticate header as its response to the client's request (shown as HTTP Response 1).</span></span> <span data-ttu-id="9980e-122">Заголовок содержит запрос дайджеста и непрозрачную директиву, содержащую ссылку на частичный [*контекст безопасности*](../secgloss/s-gly.md) , установленный для клиента.</span><span class="sxs-lookup"><span data-stu-id="9980e-122">The header contains the Digest challenge and an opaque directive that contains a reference to a partial [*security context*](../secgloss/s-gly.md) established for the client.</span></span> <span data-ttu-id="9980e-123">Заголовок отправляется с кодом состояния 401, указывающим на то, что клиентский запрос создал ошибку несанкционированного доступа.</span><span class="sxs-lookup"><span data-stu-id="9980e-123">The header is sent with a 401 status code that indicates that the client request generated an unauthorized access error.</span></span> <span data-ttu-id="9980e-124">Дополнительные сведения о дайджест-запросах см. в разделе [содержание запроса дайджеста](contents-of-a-digest-challenge.md) и [Создание запроса дайджеста](generating-the-digest-challenge.md).</span><span class="sxs-lookup"><span data-stu-id="9980e-124">For more information about the Digest challenge, see [Contents of a Digest Challenge](contents-of-a-digest-challenge.md) and [Generating the Digest Challenge](generating-the-digest-challenge.md).</span></span>
4.  <span data-ttu-id="9980e-125">Клиент получает ответ HTTP 1, извлекает запрос дайджеста, отправленный сервером, и создает ответ на запрос дайджеста следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9980e-125">The client receives HTTP Response 1, extracts the Digest challenge sent by the server, and generates a Digest challenge response as follows:</span></span>
    1.  <span data-ttu-id="9980e-126">Учетные данные пользователя получаются либо путем вызова функции [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) , либо посредством интерактивного запроса учетных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="9980e-126">The user's credentials are obtained either by calling the [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) function or by interactively prompting the user for credentials.</span></span>
    2.  <span data-ttu-id="9980e-127">Сведения о запросах и учетных данных передаются в функцию [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) , которая создает ответ на запрос дайджеста.</span><span class="sxs-lookup"><span data-stu-id="9980e-127">The challenge and credentials information are passed to the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) function, which generates the Digest challenge response.</span></span>
5.  <span data-ttu-id="9980e-128">Клиент отправляет заголовок авторизации, содержащий ответ на запрос к серверу (показанный в виде HTTP-запроса 2).</span><span class="sxs-lookup"><span data-stu-id="9980e-128">The client sends an Authorization header that contains the challenge response to the server (shown as HTTP Request 2).</span></span> <span data-ttu-id="9980e-129">Дополнительные сведения о ответе на запрос дайджеста см. в разделе [содержимое ответа на запрос дайджеста](contents-of-a-digest-challenge-response.md) и [Создание ответа на запрос дайджеста](generating-the-digest-challenge-response.md).</span><span class="sxs-lookup"><span data-stu-id="9980e-129">For more information about the Digest challenge response, see [Contents of a Digest Challenge Response](contents-of-a-digest-challenge-response.md) and [Generating the Digest Challenge Response](generating-the-digest-challenge-response.md).</span></span>
6.  <span data-ttu-id="9980e-130">Сервер получает HTTP-запрос 2, извлекает ответ на запрос, отправленный клиентом, и проверяет подлинность данных, вызывая функцию [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="9980e-130">The server receives HTTP Request 2, extracts the challenge response sent by the client, and authenticates the information by calling the [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="9980e-131">Дополнительные сведения о процессе проверки подлинности см. в [статье Начальная проверка подлинности с помощью Microsoft Digest](initial-authentication-using-microsoft-digest.md).</span><span class="sxs-lookup"><span data-stu-id="9980e-131">For details about the authentication process, see [Initial Authentication using Microsoft Digest](initial-authentication-using-microsoft-digest.md).</span></span>
7.  <span data-ttu-id="9980e-132">Сервер отправляет ответ HTTP 2 обратно клиенту в качестве второго и последнего ответа, необходимого для протокола дайджест-доступа.</span><span class="sxs-lookup"><span data-stu-id="9980e-132">The server sends HTTP Response 2 back to the client as the second and final response required by the Digest Access protocol.</span></span> <span data-ttu-id="9980e-133">Если проверка подлинности прошла успешно, этот ответ содержит запрошенный ресурс.</span><span class="sxs-lookup"><span data-stu-id="9980e-133">If the authentication is successful, this response contains the requested resource.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9980e-134">См. также</span><span class="sxs-lookup"><span data-stu-id="9980e-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9980e-135">Содержимое ответа на запрос дайджеста</span><span class="sxs-lookup"><span data-stu-id="9980e-135">Contents of a Digest Challenge Response</span></span>](contents-of-a-digest-challenge-response.md)
</dt> </dl>

 

 
