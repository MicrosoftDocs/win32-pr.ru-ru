---
description: Начальная проверка подлинности выполняется, когда сервер получает ответ на запрос от клиента.
ms.assetid: 8a5cf26b-0b2a-4f19-807b-9ec4d533cdd4
title: Начальная проверка подлинности с помощью Microsoft Digest
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8ed4960d947bbc60df962e6a9b71be755e158c8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103912479"
---
# <a name="initial-authentication-using-microsoft-digest"></a><span data-ttu-id="859a3-103">Начальная проверка подлинности с помощью Microsoft Digest</span><span class="sxs-lookup"><span data-stu-id="859a3-103">Initial Authentication Using Microsoft Digest</span></span>

<span data-ttu-id="859a3-104">Начальная проверка подлинности выполняется, когда сервер получает ответ на запрос от клиента.</span><span class="sxs-lookup"><span data-stu-id="859a3-104">The initial authentication takes place when the server receives a challenge response from a client.</span></span> <span data-ttu-id="859a3-105">Проверка подлинности ответа на запрос обычно включает в себя не менее двух серверов:</span><span class="sxs-lookup"><span data-stu-id="859a3-105">Authenticating a challenge response typically involves a minimum of two servers:</span></span>

-   <span data-ttu-id="859a3-106">Сервер-источник — получает запрос от клиента и выдает проблему, а затем получает ответ на запрос от клиента, который должен пройти проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="859a3-106">The originating server—receives the request from the client and issues a challenge, and then receives the challenge response from the client which must be authenticated.</span></span>
-   <span data-ttu-id="859a3-107">Сервер проверки подлинности — получает сведения об авторизации от сервера-источника и выполняет проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="859a3-107">The authenticating server—receives authorization information from the originating server, and performs the authentication.</span></span> <span data-ttu-id="859a3-108">Этот сервер обычно является контроллером домена, поддерживающим несколько серверов источника.</span><span class="sxs-lookup"><span data-stu-id="859a3-108">This server is typically a domain controller that supports multiple originating servers.</span></span>

<span data-ttu-id="859a3-109">Когда исходный сервер получает запрос с заголовком авторизации, содержащим ответ на запрос дайджеста, проверка подлинности продолжается следующим образом:</span><span class="sxs-lookup"><span data-stu-id="859a3-109">When the originating server receives a request with an Authorization header containing a Digest challenge response, the authentication proceeds as follows:</span></span>

-   <span data-ttu-id="859a3-110">Удостоверение исходного сервера проверяется по отношению к серверу, закодированному в nonce запроса.</span><span class="sxs-lookup"><span data-stu-id="859a3-110">The identity of the originating server is checked against the server encoded in the challenge's nonce.</span></span>
-   <span data-ttu-id="859a3-111">Проверяется метка времени, закодированная в nonce.</span><span class="sxs-lookup"><span data-stu-id="859a3-111">The time stamp encoded in the nonce is checked.</span></span> <span data-ttu-id="859a3-112">Если срок действия nonce истек, а сведения о имени пользователя и пароля действительны, то исходный сервер завершает проверку подлинности, выполняя новый дайджест-запрос с устаревшей директивой со значением "true".</span><span class="sxs-lookup"><span data-stu-id="859a3-112">If the nonce has expired and the user name/password information is valid, the originating server ends the authentication by issuing a new Digest challenge with the stale directive set to "true".</span></span> <span data-ttu-id="859a3-113">Это означает, что только nonce был "устаревшим", и клиент может ответить на новый запрос, используя пароль, использованный в предыдущем ответе.</span><span class="sxs-lookup"><span data-stu-id="859a3-113">This indicates that only the nonce was "stale" and the client can respond to the new challenge using the password it used in the previous response.</span></span> <span data-ttu-id="859a3-114">Если клиент получает новую задачу после отправки ответа на запрос для устаревшей задачи, клиент должен создать новый ответ на запрос.</span><span class="sxs-lookup"><span data-stu-id="859a3-114">If the client receives a new challenge after sending the challenge response for the stale challenge, the client must generate a new challenge response.</span></span>
-   <span data-ttu-id="859a3-115">Если включено обнаружение воспроизведения, директива NC (число nonce) проверяется на соответствие базе данных сеансов nonce, обслуживаемой сервером.</span><span class="sxs-lookup"><span data-stu-id="859a3-115">If replay detection is enforced, the nc directive (nonce count) is checked against the nonce session database maintained by the server.</span></span>
-   <span data-ttu-id="859a3-116">Сервер проверки подлинности идентифицирует и отправляет сведения об авторизации клиента.</span><span class="sxs-lookup"><span data-stu-id="859a3-116">The authenticating server is identified and sent the client's authorization information.</span></span>
-   <span data-ttu-id="859a3-117">Сервер проверки подлинности проверяет удостоверение сервера, закодированное в nonce, на идентификатор исходного сервера.</span><span class="sxs-lookup"><span data-stu-id="859a3-117">The authenticating server checks the identity of the server encoded in the nonce against the identity of the originating server.</span></span>
-   <span data-ttu-id="859a3-118">Сервер проверки подлинности, который является контроллером домена, получает пароль пользователя.</span><span class="sxs-lookup"><span data-stu-id="859a3-118">The authenticating server, which is a domain controller, retrieves the user's password.</span></span>
-   <span data-ttu-id="859a3-119">Используя данные авторизации, пароль и идентификатор исходного сервера, сервер проверки подлинности выполняет вычисление значения, которое клиент должен предоставить в директиве ответа ответа на запрос.</span><span class="sxs-lookup"><span data-stu-id="859a3-119">Using the authorization information, password, and originating server identification, the authenticating server computes the value that the client should have supplied in the challenge response's response directive.</span></span> <span data-ttu-id="859a3-120">Сервер проверки подлинности сравнивает вычисленное значение с ответом клиента, чтобы определить успешность или сбой проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="859a3-120">The authenticating server compares the computed value to the client's response to determine the success or failure of the authentication.</span></span>

<span data-ttu-id="859a3-121">Если проверка подлинности прошла успешно, [*контекст безопасности*](../secgloss/s-gly.md) пользователя и [*ключ сеанса*](../secgloss/s-gly.md) дайджеста возвращаются на сервер-источник.</span><span class="sxs-lookup"><span data-stu-id="859a3-121">If authentication is successful, the user's [*security context*](../secgloss/s-gly.md) and a Digest [*session key*](../secgloss/s-gly.md) are returned to the originating server.</span></span> <span data-ttu-id="859a3-122">Если проверка подлинности завершается неудачно, на исходном сервере должен выдаваться ответ об ошибке.</span><span class="sxs-lookup"><span data-stu-id="859a3-122">If authentication fails, the originating server must generate an error response.</span></span> <span data-ttu-id="859a3-123">После успешной проверки подлинности исходный сервер возвращает клиенту запрошенный ресурс.</span><span class="sxs-lookup"><span data-stu-id="859a3-123">After a successful authentication the originating server returns the requested resource to the client.</span></span>

<span data-ttu-id="859a3-124">Ключ сеанса дайджеста, возвращенный сервером проверки подлинности, кэшируется исходным сервером для использования при проверке подлинности будущих запросов.</span><span class="sxs-lookup"><span data-stu-id="859a3-124">The Digest session key returned by the authenticating server is cached by the originating server for use in authenticating future requests.</span></span> <span data-ttu-id="859a3-125">Дополнительные сведения см. в разделе [Проверка подлинности последующих запросов с помощью Microsoft Digest](authenticating-subsequent-requests-using-microsoft-digest.md).</span><span class="sxs-lookup"><span data-stu-id="859a3-125">For more information, see [Authenticating Subsequent Requests using Microsoft Digest](authenticating-subsequent-requests-using-microsoft-digest.md).</span></span>

 

 
