---
description: Метод проверки подлинности с помощью секретного ключа не объясняет, как клиент и сервер получают секретный ключ сеанса для использования в сеансах.
ms.assetid: 90ab0359-5079-49e9-809c-0c0005cc61bf
title: Распределение ключей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9f04a2968e8b7b978bc7b325d65b4a2acf08e1f6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103814369"
---
# <a name="key-distribution"></a><span data-ttu-id="0ac62-103">Распределение ключей</span><span class="sxs-lookup"><span data-stu-id="0ac62-103">Key Distribution</span></span>

<span data-ttu-id="0ac62-104">Метод проверки подлинности с помощью секретного ключа не объясняет, как клиент и сервер получают секретный [*ключ сеанса*](../secgloss/s-gly.md) для использования в сеансах.</span><span class="sxs-lookup"><span data-stu-id="0ac62-104">The secret key authentication technique does not explain how the client and server get the secret [*session key*](../secgloss/s-gly.md) to use in sessions with each other.</span></span> <span data-ttu-id="0ac62-105">Если это люди, они могут соблюсти секрет и принять ключ.</span><span class="sxs-lookup"><span data-stu-id="0ac62-105">If they are people, they could meet in secret and agree on the key.</span></span> <span data-ttu-id="0ac62-106">Но если клиент является программой, работающей на рабочей станции, а сервер является службой, работающей на сетевом сервере, этот метод не будет работать.</span><span class="sxs-lookup"><span data-stu-id="0ac62-106">But if the client is a program running on a workstation and the server is a service running on a network server, that method will not work.</span></span>

<span data-ttu-id="0ac62-107">Клиент хочет взаимодействовать с большим количеством серверов и потребует различных ключей для каждого из них.</span><span class="sxs-lookup"><span data-stu-id="0ac62-107">A client will want to communicate with many servers and will need different keys for each of them.</span></span> <span data-ttu-id="0ac62-108">Сервер взаимодействует с несколькими клиентами и нуждается в различных ключах для каждого из них.</span><span class="sxs-lookup"><span data-stu-id="0ac62-108">A server communicates with many clients and needs different keys for each of them, as well.</span></span> <span data-ttu-id="0ac62-109">Если каждому клиенту требуется отдельный ключ для каждого сервера, и каждому серверу требуется отдельный ключ для каждого клиента, распространение ключей станет проблемой.</span><span class="sxs-lookup"><span data-stu-id="0ac62-109">If each client needs a different key for every server, and each server needs a different key for every client, key distribution becomes a problem.</span></span> <span data-ttu-id="0ac62-110">Кроме того, необходимость хранить и защищать многие ключи на многих компьютерах создает огромную угрозу безопасности.</span><span class="sxs-lookup"><span data-stu-id="0ac62-110">In addition, the need to store and protect many keys on many computers creates an enormous security risk.</span></span>

<span data-ttu-id="0ac62-111">Имя [*протокола Kerberos*](../secgloss/k-gly.md) предлагает решению проблемы при распространении ключей.</span><span class="sxs-lookup"><span data-stu-id="0ac62-111">The name of the [*Kerberos protocol*](../secgloss/k-gly.md) suggests its solution to the problem of key distribution.</span></span> <span data-ttu-id="0ac62-112">Kerberos (или Cerberus) был представлен в классической греческой мифологии — свирепые, трехуровневой собаки, который не позволяет злоумышленникам войти в подсветку.</span><span class="sxs-lookup"><span data-stu-id="0ac62-112">Kerberos (or Cerberus) was a figure in classical Greek mythology—a fierce, three-headed dog who kept living intruders from entering the Underworld.</span></span> <span data-ttu-id="0ac62-113">Как и в случае с вымышенной Guard, протокол Kerberos имеет три головки: Клиент, сервер и доверенную третью сторону для исправлять между ними.</span><span class="sxs-lookup"><span data-stu-id="0ac62-113">Like the mythical guard, the Kerberos protocol has three heads: a client, a server, and a trusted third party to mediate between them.</span></span> <span data-ttu-id="0ac62-114">Доверенным посредником в этом протоколе является центр распространения ключей (KDC).</span><span class="sxs-lookup"><span data-stu-id="0ac62-114">The trusted intermediary in this protocol is the Key Distribution Center (KDC).</span></span>

<span data-ttu-id="0ac62-115">KDC — это служба, работающая на физическом безопасном сервере.</span><span class="sxs-lookup"><span data-stu-id="0ac62-115">The KDC is a service running on a physically secure server.</span></span> <span data-ttu-id="0ac62-116">Он поддерживает базу данных со сведениями об учетной записи для всех [*субъектов безопасности*](../secgloss/s-gly.md) в своей сфере.</span><span class="sxs-lookup"><span data-stu-id="0ac62-116">It maintains a database with account information for all [*security principals*](../secgloss/s-gly.md) in its realm.</span></span> <span data-ttu-id="0ac62-117">Область — это эквивалент Kerberos домена в Windows.</span><span class="sxs-lookup"><span data-stu-id="0ac62-117">A realm is the Kerberos equivalent of a domain in Windows.</span></span>

<span data-ttu-id="0ac62-118">Наряду с другими сведениями о каждом субъекте безопасности, KDC хранит криптографический ключ, известный только основному и KDC.</span><span class="sxs-lookup"><span data-stu-id="0ac62-118">Along with other information about each security principal, the KDC stores a cryptographic key known only to the principal and the KDC.</span></span> <span data-ttu-id="0ac62-119">Это [*главный ключ*](../secgloss/m-gly.md) , используемый в обмене данными между каждым субъектом безопасности и KDC.</span><span class="sxs-lookup"><span data-stu-id="0ac62-119">This is the [*master key*](../secgloss/m-gly.md) used in exchanges between each security principal and the KDC.</span></span> <span data-ttu-id="0ac62-120">В большинстве реализаций протокола Kerberos этот главный ключ извлекается с помощью [*хэш-*](../secgloss/h-gly.md) функции из пароля субъекта безопасности.</span><span class="sxs-lookup"><span data-stu-id="0ac62-120">In most implementations of the Kerberos protocol, this master key is derived using a [*hash*](../secgloss/h-gly.md) function from a security principal's password.</span></span>

<span data-ttu-id="0ac62-121">Когда клиент хочет создать безопасное подключение к серверу, клиент начинает с отправки запроса к KDC, а не к серверу, к которому требуется получить доступ.</span><span class="sxs-lookup"><span data-stu-id="0ac62-121">When a client wants to create a secure connection with a server, the client begins by sending a request to the KDC, not to the server that it wants to reach.</span></span> <span data-ttu-id="0ac62-122">KDC создает и отправляет клиенту уникальный [*ключ сеанса*](../secgloss/s-gly.md) для клиента и сервер, который используется для проверки подлинности друг друга.</span><span class="sxs-lookup"><span data-stu-id="0ac62-122">The KDC creates and sends to the client a unique [*session key*](../secgloss/s-gly.md) for the client and a server to use to authenticate each other.</span></span> <span data-ttu-id="0ac62-123">KDC имеет доступ как к главному ключу клиента, так и к главному ключу сервера.</span><span class="sxs-lookup"><span data-stu-id="0ac62-123">The KDC has access to both the client's master key and the server's master key.</span></span> <span data-ttu-id="0ac62-124">KDC шифрует копию ключа сеанса на сервере с помощью главного ключа сервера и копирует клиент с помощью главного ключа клиента.</span><span class="sxs-lookup"><span data-stu-id="0ac62-124">The KDC encrypts the server's copy of the session key using the server's master key, and the client's copy using the client's master key.</span></span>

<span data-ttu-id="0ac62-125">KDC может выполнить свою роль в качестве доверенного посредника, отправив ключ сеанса непосредственно каждому из участвующих участников безопасности, но на практике эта процедура не будет работать по ряду причин.</span><span class="sxs-lookup"><span data-stu-id="0ac62-125">The KDC could fulfill its role as trusted intermediary by sending the session key directly to each of the security principals involved, but in practice this procedure will not work, for a number of reasons.</span></span> <span data-ttu-id="0ac62-126">Вместо этого KDC отправляет клиенту оба зашифрованных ключа сеанса.</span><span class="sxs-lookup"><span data-stu-id="0ac62-126">Instead, the KDC sends both encrypted session keys to the client.</span></span> <span data-ttu-id="0ac62-127">Ключ сеанса для сервера включен в [билет сеанса](session-tickets.md).</span><span class="sxs-lookup"><span data-stu-id="0ac62-127">The session key for the server is included in a [session ticket](session-tickets.md).</span></span>

 

 
