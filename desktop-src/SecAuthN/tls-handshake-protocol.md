---
description: Протокол подтверждения протокола TLS отвечает за проверку подлинности и обмен ключами, необходимые для установки или возобновления безопасных сеансов.
ms.assetid: 65fb4db3-e505-457a-9159-dba0b506ea0b
title: Протокол подтверждения TLS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e0c7cfa9e9db54a6035abe147ce00bbde59bcc86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664154"
---
# <a name="tls-handshake-protocol"></a>Протокол подтверждения TLS

Протокол [*подтверждения протокола TLS*](../secgloss/t-gly.md) отвечает за проверку подлинности и обмен ключами, необходимые для установки или возобновления безопасных сеансов. При установке безопасного [*сеанса*](../secgloss/s-gly.md)протокол подтверждения управляет следующими параметрами:

-   Согласование комплекта шифров
-   Проверка подлинности сервера и, при необходимости, клиента
-   Обмен сведениями о ключе сеанса.

## <a name="cipher-suite-negotiation"></a>Согласование комплекта шифров

Клиент и сервер делают контакт и выбирают комплект шифров, который будет использоваться в процессе обмена сообщениями.

## <a name="authentication"></a>Аутентификация

В протоколе TLS сервер подтверждает свою подлинность клиенту. Клиенту также может потребоваться подтвердить свою личность на сервер. PKI, использование [*пар открытого и закрытого ключей*](../secgloss/p-gly.md)является основанием этой проверки подлинности. Точный метод, используемый для проверки подлинности, определяется согласованным комплектом шифров.

## <a name="key-exchange"></a>Обмен ключами

Клиент и сервер обмениваются случайными числами и специальным числом, которое называется секретом предварительного главного компьютера. Эти числа объединяются с дополнительными данными, позволяющими клиенту и серверу создавать свои общие секреты, называемые главным секретом. Главный секрет используется клиентом и сервером для создания секрета для записи MAC, который является ключом сеанса, используемым для [*хэширования*](../secgloss/h-gly.md), и ключом записи, который является [*ключом сеанса*](../secgloss/s-gly.md) , используемым для шифрования.

## <a name="establishing-a-secure-session-by-using-tls"></a>Установка безопасного сеанса с помощью TLS

Протокол подтверждения TLS включает следующие шаги.

1.  Клиент отправляет на сервер сообщение Hello Client, а также случайное значение клиента и поддерживаемые комплекты шифров.
2.  Сервер отвечает, отправляя клиенту сообщение "Server Hello", а также случайное значение сервера.
3.  Сервер отправляет клиенту сертификат для проверки подлинности и может запросить сертификат у клиента. Сервер отправляет сообщение "Hello Server Done".
4.  Если сервер запросил сертификат от клиента, клиент отправляет его.
5.  Клиент создает случайный предварительный секретный ключ и шифрует его с помощью [*открытого ключа*](../secgloss/p-gly.md) из сертификата сервера и отправляет зашифрованный предварительный основной секрет на сервер.
6.  Сервер получает секрет предварительного главного сервера. Каждый сервер и клиент создают главный секретный и [*сеансовый ключи*](../secgloss/s-gly.md) на основе предварительной версии секрета.
7.  Клиент отправляет уведомление "изменение спецификации шифра" на сервер, чтобы указать, что клиент начнет использовать новые [*ключи сеанса*](../secgloss/s-gly.md) для [*хэширования*](../secgloss/h-gly.md) и шифрования сообщений. Клиент также отправляет сообщение "клиент завершен".
8.  Сервер получает "изменить спецификацию шифра" и переключает состояние безопасности уровня записи на [*симметричное шифрование*](../secgloss/s-gly.md) с помощью [*ключей сеанса*](../secgloss/s-gly.md). Сервер отправляет клиенту сообщение "Server Finished".
9.  Теперь клиент и сервер могут обмениваться данными приложения через защищенный канал, который они установили. Все сообщения, отправляемые от клиента серверу и от сервера к клиенту, шифруются с помощью ключа сеанса.

## <a name="resuming-a-secure-session-by-using-tls"></a>Возобновление безопасного сеанса с помощью TLS

1.  Клиент отправляет сообщение "клиент Hello", используя идентификатор сеанса для возобновления сеанса.
2.  Сервер проверяет кэш сеанса на соответствие ИДЕНТИФИКАТОРу сеанса. Если совпадение найдено, и сервер способен возобновить сеанс, он отправляет сообщение "Server Hello" с ИДЕНТИФИКАТОРом сеанса.
    > [!Note]  
    > Если идентификатор сеанса не найден, сервер создает новый идентификатор сеанса, а клиент и сервер TLS выполняют полное подтверждение.

     

3.  Клиент и сервер должны обмениваться сообщениями "изменить спецификацию шифра" и отправить сообщения "клиент завершен" и "сервер завершен".
4.  Теперь клиент и сервер могут возобновить обмен данными приложения по безопасному каналу.

 

 
