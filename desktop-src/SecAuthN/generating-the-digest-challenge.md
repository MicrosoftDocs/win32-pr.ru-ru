---
description: Запрос Microsoft Digest создается начальным вызовом на сервере функции AcceptSecurityContext (Digest).
ms.assetid: d33383c2-5c0d-401f-ab28-2a985f6508e0
title: Создание запроса дайджеста
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 511ec4f01c90acf08669835f9728cc711dfd1023
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272044"
---
# <a name="generating-the-digest-challenge"></a><span data-ttu-id="23130-103">Создание запроса дайджеста</span><span class="sxs-lookup"><span data-stu-id="23130-103">Generating the Digest Challenge</span></span>

<span data-ttu-id="23130-104">Запрос Microsoft Digest создается начальным вызовом на сервере функции [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="23130-104">The Microsoft Digest challenge is generated by the server's initial call to the [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="23130-105">Этот вызов функции создает nonce, который является уникальным значением, содержащим сведения, которые можно использовать для обнаружения нарушений безопасности.</span><span class="sxs-lookup"><span data-stu-id="23130-105">This function call generates a nonce, which is a unique value that contains information that can be used to detect security violations.</span></span> <span data-ttu-id="23130-106">Этот вызов также создает частичный [*контекст безопасности*](/windows/desktop/SecGloss/s-gly) , который используется для сохранения сведений о состоянии.</span><span class="sxs-lookup"><span data-stu-id="23130-106">This call also generates a partial [*security context*](/windows/desktop/SecGloss/s-gly) which is used to maintain state information.</span></span> <span data-ttu-id="23130-107">При вызове **AcceptSecurityContext (Digest)** задаются флаги требований контекста для управления поведением Microsoft Digest и настройки качества защиты.</span><span class="sxs-lookup"><span data-stu-id="23130-107">When calling **AcceptSecurityContext (Digest)** you specify context requirements flags to control the behavior of Microsoft Digest and to set the quality of protection.</span></span> <span data-ttu-id="23130-108">Дополнительные сведения см. в разделе [требования к контексту дайджест-запроса](#digest-challenge-context-requirements).</span><span class="sxs-lookup"><span data-stu-id="23130-108">For more information, see [Digest Challenge Context Requirements](#digest-challenge-context-requirements).</span></span>

<span data-ttu-id="23130-109">Выходным результатом начального вызова [*функции*](/windows/desktop/SecGloss/c-gly) [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) является буфер безопасности, содержащий маркер, отправленный клиенту с ответом HTTP 401 (отказано в доступе).</span><span class="sxs-lookup"><span data-stu-id="23130-109">The output from the initial call to the [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) [*function*](/windows/desktop/SecGloss/c-gly) is a security buffer that contains a token that is sent to the client with an HTTP 401 response (Access Denied).</span></span>

> [!Note]  
> <span data-ttu-id="23130-110">Вызовы [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) , которые не содержат сведений во входных буферах, возвращают дайджест-запрос.</span><span class="sxs-lookup"><span data-stu-id="23130-110">Calls to [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) that do not contain information in the input buffers return a Digest challenge.</span></span>

 

## <a name="digest-challenge-context-requirements"></a><span data-ttu-id="23130-111">Требования к контексту запроса дайджеста</span><span class="sxs-lookup"><span data-stu-id="23130-111">Digest Challenge Context Requirements</span></span>

<span data-ttu-id="23130-112">Требования к контексту — это флаги, которые определяют:</span><span class="sxs-lookup"><span data-stu-id="23130-112">Context requirements are flags that determine:</span></span>

-   <span data-ttu-id="23130-113">Определяет, функционируют ли Microsoft Digest как механизм SASL или протокол проверки подлинности HTTP.</span><span class="sxs-lookup"><span data-stu-id="23130-113">Whether Microsoft Digest functions as a SASL mechanism or HTTP authentication protocol.</span></span>
-   <span data-ttu-id="23130-114">Качество защиты, поддерживаемое контекстом безопасности, совместно используемым клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="23130-114">The quality of protection supported by the security context shared by the client and server.</span></span>

<span data-ttu-id="23130-115">По умолчанию Microsoft Digest функционирует как механизм SASL.</span><span class="sxs-lookup"><span data-stu-id="23130-115">By default, Microsoft Digest functions as a SASL mechanism.</span></span> <span data-ttu-id="23130-116">Чтобы использовать его для проверки подлинности HTTP \_ , \_ сервер должен установить флаг ASC HTTP (0x10000000).</span><span class="sxs-lookup"><span data-stu-id="23130-116">To use it for HTTP authentication, the ASC\_REQ\_HTTP ( 0x10000000) flag must be set by the server.</span></span>

<span data-ttu-id="23130-117">Требования к контексту указываются как флаги, передаваемые в параметр *фконтекстрек* функции [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="23130-117">Context requirements are specified as flags passed to the *fContextReq* parameter of the [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="23130-118">Флаги влияют на качество защиты контекста безопасности, управляя директивой КОП в задаче запроса.</span><span class="sxs-lookup"><span data-stu-id="23130-118">The flags affect the security context's quality of protection by controlling the qop directive in the challenge.</span></span>

<span data-ttu-id="23130-119">По умолчанию директива КОП имеет значение "auth".</span><span class="sxs-lookup"><span data-stu-id="23130-119">By default, the qop directive is set to "auth".</span></span> <span data-ttu-id="23130-120">Чтобы создать запрос, который задает для директивы КОП значение "auth-int", сервер должен указать один или несколько из следующих флагов:</span><span class="sxs-lookup"><span data-stu-id="23130-120">To generate a challenge that sets the qop directive to "auth-int", the server must specify one or more of the following flags:</span></span>

-   <span data-ttu-id="23130-121">\_ \_ целостность требований ASC</span><span class="sxs-lookup"><span data-stu-id="23130-121">ASC\_REQ\_INTEGRITY</span></span>
-   <span data-ttu-id="23130-122">Обнаружение повторного \_ воспроизведения требований ASC \_ \_</span><span class="sxs-lookup"><span data-stu-id="23130-122">ASC\_REQ\_REPLAY\_DETECT</span></span>
-   <span data-ttu-id="23130-123">\_ \_ Обнаружение последовательности "ASC req" \_</span><span class="sxs-lookup"><span data-stu-id="23130-123">ASC\_REQ\_SEQUENCE\_DETECT</span></span>

<span data-ttu-id="23130-124">Только для SASL: Создайте задачу с директивой КОП, для которой задано значение "auth-conf", \_ указав \_ флаг требования к контексту для обеспечения конфиденциальности ASC.</span><span class="sxs-lookup"><span data-stu-id="23130-124">For SASL only: Generate a challenge with the qop directive set to "auth-conf" by specifying the ASC\_REQ\_CONFIDENTIALITY context requirement flag.</span></span> <span data-ttu-id="23130-125">Поскольку этот флаг является недопустимым для проверки подлинности HTTP, его нельзя использовать \_ с \_ флагом HTTP ASC.</span><span class="sxs-lookup"><span data-stu-id="23130-125">Because this flag is not valid for HTTP authentication, it cannot be used with the ASC\_REQ\_HTTP flag.</span></span>

<span data-ttu-id="23130-126">Дополнительные сведения об директиве КОП см. в разделе [качество защиты и шифров](quality-of-protection-and-ciphers.md).</span><span class="sxs-lookup"><span data-stu-id="23130-126">For more information about the qop directive, see [Quality of Protection and Ciphers](quality-of-protection-and-ciphers.md).</span></span>

<span data-ttu-id="23130-127">Дополнительные сведения о проблемах см. [в разделе содержание запроса дайджеста](contents-of-a-digest-challenge.md).</span><span class="sxs-lookup"><span data-stu-id="23130-127">For more information about challenges, see [Contents of a Digest Challenge](contents-of-a-digest-challenge.md).</span></span>

 

 
