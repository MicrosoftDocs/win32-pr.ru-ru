---
description: Чтобы уменьшить трафик контроллера домена и повысить производительность, клиентская часть Microsoft Digest кэширует сведения, полученные после успешной проверки подлинности на сервере.
ms.assetid: cd928266-889a-494c-a94b-4ea7b1dcc241
title: Поддержание контекста безопасности между соединениями
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aeb450dde789f17f46397cb56fe74b94adcf8ea6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104347145"
---
# <a name="maintaining-the-security-context-between-connections"></a>Поддержание контекста безопасности между соединениями

Чтобы уменьшить трафик контроллера домена и повысить производительность, клиентская часть Microsoft Digest кэширует сведения, полученные после успешной проверки подлинности на сервере. Клиентским приложениям необходимо кэшировать только те маркеры, которые были установлены в [*контексте безопасности*](../secgloss/s-gly.md) . В следующей таблице описаны сведения, кэшированные пакетом безопасности.



| Сведения                                                       | Описание                                                                                                                                         |
|-------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| Имя сервера                                                       | Сервер, успешно создавший контекст безопасности для пользователя.                                                                           |
| Область или домен                                                      | Имя домена, используемое для успешной проверки подлинности.                                                                                              |
| [*Требуем*](../secgloss/n-gly.md) | Элемент Server nonce, связанный с успешной проверкой подлинности.                                                                               |
| Число nonce                                                       | Количество раз, когда клиент включил nonce в запросы к серверу. Используется для обнаружения воспроизведения.                                 |
| Непрозрачное значение                                                      | Значение, возвращаемое для непрозрачной директивы после успешной проверки подлинности. Это значение содержит ссылку на контекст безопасности пользователя. |



 

Когда клиент отправляет сообщение на сервер, сервер должен определить, имеет ли клиент существующий контекст безопасности. Для этого сервер передает каждый клиентский запрос функции [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) . Эта функция извлекает значение непрозрачной директивы из запроса, если оно есть, и использует его для поиска контекста безопасности клиента. Если контекст безопасности найден, то на сервер возвращается маркер контекста. Связанные сведения см. в разделе [Проверка подлинности последующих запросов](authenticating-subsequent-requests-using-microsoft-digest.md).

Как средство обнаружения атак с подменой и воспроизведением, клиент вызывает функцию [**макесигнатуре**](/windows/desktop/api/Sspi/nf-sspi-makesignature) , которая использует контекст безопасности для подписания сообщения. Когда сообщения защищаются с помощью функции **макесигнатуре** , сервер использует функцию [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) с кэшированным контекстом, чтобы проверить происхождение и [*целостность*](../secgloss/i-gly.md)сообщения. Дополнительные сведения см. в разделе [Защита сообщений](protecting-messages-using-microsoft-digest.md).

 

 
