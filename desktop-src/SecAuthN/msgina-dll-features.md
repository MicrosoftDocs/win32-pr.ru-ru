---
description: При написании модели GINA для замены стандартной библиотеки DLL Microsoft GINA (MSGina.dll) может потребоваться предоставить некоторые или все стандартные функции GINA.
ms.assetid: cd2ce7b7-6167-4451-9f6e-881676a2145c
title: MSGina.dll функции
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 51833ab92e47dad01c13df004797e3ab3552b09a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911872"
---
# <a name="msginadll-features"></a><span data-ttu-id="309e8-103">MSGina.dll функции</span><span class="sxs-lookup"><span data-stu-id="309e8-103">MSGina.dll Features</span></span>

<span data-ttu-id="309e8-104">При написании [*модели GINA*](../secgloss/g-gly.md) для замены стандартной библиотеки DLL Microsoft gina (MSGina.dll) может потребоваться предоставить некоторые или все стандартные функции GINA.</span><span class="sxs-lookup"><span data-stu-id="309e8-104">If you are writing a [*GINA*](../secgloss/g-gly.md) to replace the Microsoft standard GINA DLL (MSGina.dll), you may want to provide some or all of the standard GINA functionality.</span></span> <span data-ttu-id="309e8-105">Ниже приведен список стандартных функций и краткое описание их управления.</span><span class="sxs-lookup"><span data-stu-id="309e8-105">Following is a list of standard features and a brief description of how they are controlled.</span></span>

> [!Note]  
> <span data-ttu-id="309e8-106">Библиотеки DLL GINA не учитываются в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="309e8-106">GINA DLLs are ignored in Windows Vista.</span></span>

 

<span data-ttu-id="309e8-107">Значения разделов реестра управляют доступностью или поведением многих из этих стандартных функций GINA.</span><span class="sxs-lookup"><span data-stu-id="309e8-107">Registry key values control the availability or behavior of many of these standard GINA features.</span></span> <span data-ttu-id="309e8-108">Если не указано иное, эти ключевые значения относятся к разделу реестра Winlogon и имеют тип значения \[ reg \_ SZ \] .</span><span class="sxs-lookup"><span data-stu-id="309e8-108">Unless otherwise noted, these key values belong to the Winlogon registry key and have a value type of \[REG\_SZ\].</span></span> <span data-ttu-id="309e8-109">Фактический путь к ключу [*Winlogon*](../secgloss/w-gly.md) :</span><span class="sxs-lookup"><span data-stu-id="309e8-109">The actual path of the [*Winlogon*](../secgloss/w-gly.md) key is:</span></span>

<span data-ttu-id="309e8-110">**\\HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows NT \\ CurrentVersion \\ Winlogon**</span><span class="sxs-lookup"><span data-stu-id="309e8-110">**\\HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon**</span></span>

-   <span data-ttu-id="309e8-111">**Диалоговое окно с юридическим уведомлением**</span><span class="sxs-lookup"><span data-stu-id="309e8-111">**Legal Notification Dialog Box**</span></span>

    <span data-ttu-id="309e8-112">В некоторых случаях у всех, кто имеет доступ к рабочей станции для входа в систему, и приступить к работе, если нет уведомления о том, что система предназначена только для полномочных пользователей.</span><span class="sxs-lookup"><span data-stu-id="309e8-112">In some places, it is legal for anyone who has access to a workstation to log on and begin working unless there is a notice that indicates that the system is for authorized users only.</span></span> <span data-ttu-id="309e8-113">Кроме того, многие пользователи хотят, чтобы сообщения, относящиеся к конкретной компании, отображались перед нормальным входом.</span><span class="sxs-lookup"><span data-stu-id="309e8-113">Also, many users want company-specific messages displayed before normal logon.</span></span> <span data-ttu-id="309e8-114">Стандартная функция GINA использует два значения ключа реестра Winlogon, чтобы система отображала информацию перед входом в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-114">The standard GINA uses two Winlogon registry key values to allow a system to display information before logon.</span></span> <span data-ttu-id="309e8-115">Если какое-либо значение ключа имеется и содержит строку, отличную от NULL, то перед обычным экраном приветствия отображается диалоговое окно с юридическим уведомлением.</span><span class="sxs-lookup"><span data-stu-id="309e8-115">If either key value is present and contains a non-null string, then a Legal Notice dialog box is displayed before the usual Welcome screen.</span></span> <span data-ttu-id="309e8-116">Эти имена значений ключей показаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="309e8-116">These key value names are shown in the following table.</span></span>

    

    | <span data-ttu-id="309e8-117">Имя значения ключа</span><span class="sxs-lookup"><span data-stu-id="309e8-117">Key value name</span></span>         | <span data-ttu-id="309e8-118">Содержимое</span><span class="sxs-lookup"><span data-stu-id="309e8-118">Contents</span></span>                                                            |
    |------------------------|---------------------------------------------------------------------|
    | <span data-ttu-id="309e8-119">**легалнотицекаптион**</span><span class="sxs-lookup"><span data-stu-id="309e8-119">**LegalNoticeCaption**</span></span> | <span data-ttu-id="309e8-120">Строка, отображаемая в качестве заголовка диалогового окна юридического уведомления</span><span class="sxs-lookup"><span data-stu-id="309e8-120">The string to display as the caption of the legal notice dialog box</span></span> |
    | <span data-ttu-id="309e8-121">**легалнотицетекст**</span><span class="sxs-lookup"><span data-stu-id="309e8-121">**LegalNoticeText**</span></span>    | <span data-ttu-id="309e8-122">Строка, отображаемая как сообщение в диалоговом окне "Юридическая информация"</span><span class="sxs-lookup"><span data-stu-id="309e8-122">The string to display as the message of the legal notice dialog box</span></span> |

    

     

-   <span data-ttu-id="309e8-123">**Отобразить имя последнего пользователя**</span><span class="sxs-lookup"><span data-stu-id="309e8-123">**Display Last User Name**</span></span>

    <span data-ttu-id="309e8-124">По умолчанию на экране входа в систему отображается имя последнего пользователя для успешного входа на рабочую станцию.</span><span class="sxs-lookup"><span data-stu-id="309e8-124">By default, the logon screen displays the name of the last user to successfully log on to the workstation.</span></span> <span data-ttu-id="309e8-125">Эта функция управляется значением раздела реестра **донтдисплайластусернаме** .</span><span class="sxs-lookup"><span data-stu-id="309e8-125">This feature is controlled by the **DontDisplayLastUserName** registry key value.</span></span> <span data-ttu-id="309e8-126">Если для этого параметра задано значение 1, то имя пользователя не отображается в диалоговом окне входа в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-126">When this key value is set to one, the user name is not displayed in the logon dialog box.</span></span>

-   <span data-ttu-id="309e8-127">**Автоматический вход**</span><span class="sxs-lookup"><span data-stu-id="309e8-127">**Automatic Logon**</span></span>

    <span data-ttu-id="309e8-128">Эта функция позволяет системе автоматически входить в систему пользователя при каждом запуске системы, используя сведения по умолчанию и отключая клавиши CTRL + ALT + DEL для входа.</span><span class="sxs-lookup"><span data-stu-id="309e8-128">This feature allows a system to log on a user automatically every time the system starts by using default information and disabling the CTRL+ALT+DEL logon box.</span></span>

    <span data-ttu-id="309e8-129">Эта функция использует следующие значения ключа Winlogon.</span><span class="sxs-lookup"><span data-stu-id="309e8-129">This feature uses the following values of the Winlogon key.</span></span>

    

    | <span data-ttu-id="309e8-130">Значение</span><span class="sxs-lookup"><span data-stu-id="309e8-130">Value</span></span>                 | <span data-ttu-id="309e8-131">Содержимое</span><span class="sxs-lookup"><span data-stu-id="309e8-131">Contents</span></span>                                           |
    |-----------------------|----------------------------------------------------|
    | <span data-ttu-id="309e8-132">**аутоадминлогон**</span><span class="sxs-lookup"><span data-stu-id="309e8-132">**AutoAdminLogon**</span></span>    | <span data-ttu-id="309e8-133">1</span><span class="sxs-lookup"><span data-stu-id="309e8-133">1</span></span>                                                  |
    | <span data-ttu-id="309e8-134">**аутологонкаунт**</span><span class="sxs-lookup"><span data-stu-id="309e8-134">**AutoLogonCount**</span></span>    | <span data-ttu-id="309e8-135">Число попыток автоматического входа в систему</span><span class="sxs-lookup"><span data-stu-id="309e8-135">The number of times to do an automatic logon</span></span>       |
    | <span data-ttu-id="309e8-136">**дефаултусернаме**</span><span class="sxs-lookup"><span data-stu-id="309e8-136">**DefaultUserName**</span></span>   | <span data-ttu-id="309e8-137">Имя учетной записи пользователя</span><span class="sxs-lookup"><span data-stu-id="309e8-137">The name of the user account</span></span>                       |
    | <span data-ttu-id="309e8-138">**дефаултдомаиннаме**</span><span class="sxs-lookup"><span data-stu-id="309e8-138">**DefaultDomainName**</span></span> | <span data-ttu-id="309e8-139">Имя домена, в котором находится учетная запись пользователя</span><span class="sxs-lookup"><span data-stu-id="309e8-139">The name of the domain that the user account is in</span></span> |

    

     

    <span data-ttu-id="309e8-140">Если значение ключа **аутоадминлогон** имеется и содержит его, а значение ключа **аутологонкаунт** отсутствует, автоматический вход выполняется каждый раз, когда текущий пользователь выходит из системы или перезагружается.</span><span class="sxs-lookup"><span data-stu-id="309e8-140">If the **AutoAdminLogon** key value is present and contains a one, and the **AutoLogonCount** key value is not present, an automatic logon will occur every time the current user logs off or the system is restarted.</span></span> <span data-ttu-id="309e8-141">Учетная запись, на которую выполняется вход, указывается с помощью значений ключа **дефаултусернаме** и **дефаултдомаиннаме** .</span><span class="sxs-lookup"><span data-stu-id="309e8-141">The account being logged onto is specified using the **DefaultUserName** and **DefaultDomainName** key values.</span></span> <span data-ttu-id="309e8-142">Пароль для учетной записи можно указать одним из двух способов.</span><span class="sxs-lookup"><span data-stu-id="309e8-142">The password for the account can be specified in one of two ways.</span></span> <span data-ttu-id="309e8-143">Для компьютеров, работающих под управлением одной из операционных систем Windows Server 2003 или Windows XP, пароль должен храниться как секрет с помощью функции [**лсастореприватедата**](/windows/win32/api/ntsecapi/nf-ntsecapi-lsastoreprivatedata) .</span><span class="sxs-lookup"><span data-stu-id="309e8-143">For computers running one of the Windows Server 2003 or Windows XP operating systems, the password should be stored as a secret using the [**LsaStorePrivateData**](/windows/win32/api/ntsecapi/nf-ntsecapi-lsastoreprivatedata) function.</span></span> <span data-ttu-id="309e8-144">Дополнительные сведения см. [в разделе Защита пароля автоматического входа](protecting-the-automatic-logon-password.md).</span><span class="sxs-lookup"><span data-stu-id="309e8-144">For details, see [Protecting the Automatic Logon Password](protecting-the-automatic-logon-password.md).</span></span> <span data-ttu-id="309e8-145">Другой способ сохранения пароля — это открытый текст в записи **DefaultPassword** ключа Winlogon. в целях безопасности этот метод следует избегать.</span><span class="sxs-lookup"><span data-stu-id="309e8-145">The other way to store the password is in plaintext in the **DefaultPassword** entry of the Winlogon key; for security purposes, this technique should be avoided.</span></span> <span data-ttu-id="309e8-146">Если пароль сохраняется с помощью функции **лсастореприватедата** , не следует указывать параметр **DefaultPassword** в разделе Winlogon.</span><span class="sxs-lookup"><span data-stu-id="309e8-146">If you store the password using the **LsaStorePrivateData** function, then do not provide a **DefaultPassword** entry in the Winlogon key.</span></span>

    <span data-ttu-id="309e8-147">Если значение ключа **аутоадминлогон** имеется и содержит один, и если значение ключа **аутологонкаунт** имеется и не равно нулю, **аутологонкаунт** определит количество выполняемых автоматически входов в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-147">If the **AutoAdminLogon** key value is present and contains a one, and if the **AutoLogonCount** key value is present and is not zero, **AutoLogonCount** will determine the number of automatic logons that occur.</span></span> <span data-ttu-id="309e8-148">При каждом перезапуске системы значение **аутологонкаунт** будет уменьшено на единицу до тех пор, пока не достигнет нуля.</span><span class="sxs-lookup"><span data-stu-id="309e8-148">Each time the system is restarted, the value of **AutoLogonCount** will be decremented by one, until it reaches zero.</span></span> <span data-ttu-id="309e8-149">Если **аутологонкаунт** достигает нуля, учетная запись не будет автоматически входить в систему, значение ключа **аутологонкаунт** и значение параметра **DefaultPassword** , если оно используется, будет удалено из реестра, а **аутоадминлогон** будет установлено в 0.</span><span class="sxs-lookup"><span data-stu-id="309e8-149">When **AutoLogonCount** reaches zero, no account will be logged on automatically, the **AutoLogonCount** key value and **DefaultPassword** key value, if used, will be deleted from the registry, and **AutoAdminLogon** will be set to zero.</span></span>

    <span data-ttu-id="309e8-150">Существует одно дополнительное предостережение по использованию **аутоадминлогон**: по умолчанию MSGina.dll проверяет состояние клавиши Shift, если **аутоадминлогон** имеет значение One.</span><span class="sxs-lookup"><span data-stu-id="309e8-150">There is one additional caveat to using **AutoAdminLogon**: By default, MSGina.dll checks the state of the SHIFT key when **AutoAdminLogon** is one.</span></span> <span data-ttu-id="309e8-151">Если во время загрузки удерживается клавиша SHIFT, MSGina.dll будет игнорировать значение ключа **аутоадминлогон** и запросить у пользователя сведения о идентификации и проверке подлинности в интерактивном режиме.</span><span class="sxs-lookup"><span data-stu-id="309e8-151">If the SHIFT key is held down during the boot process, MSGina.dll will ignore the **AutoAdminLogon** key value and prompt the user for identification and authentication information interactively.</span></span> <span data-ttu-id="309e8-152">Эта функция полезна при отладке выделенного приложения.</span><span class="sxs-lookup"><span data-stu-id="309e8-152">This is a useful feature when you are debugging a dedicated application.</span></span> <span data-ttu-id="309e8-153">Чтобы отключить значение клавиши SHIFT, задайте для **игнорешифтоверриде** значения ключа.</span><span class="sxs-lookup"><span data-stu-id="309e8-153">To disable the meaning of the SHIFT key, set the **IgnoreShiftOverride** key value to one.</span></span>

-   <span data-ttu-id="309e8-154">**Разрешить завершение работы без проверки подлинности**</span><span class="sxs-lookup"><span data-stu-id="309e8-154">**Allow Unauthenticated Shutdown**</span></span>

    <span data-ttu-id="309e8-155">Можно настроить [*GINA*](../secgloss/g-gly.md) по умолчанию, включив в диалоговом окне входа кнопку **Завершение работы** .</span><span class="sxs-lookup"><span data-stu-id="309e8-155">You can configure the default [*GINA*](../secgloss/g-gly.md) to include a **Shutdown** button in the logon dialog box.</span></span> <span data-ttu-id="309e8-156">Это позволяет пользователям завершать работу системы без предварительного входа в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-156">This lets users shut down the system without first logging on.</span></span> <span data-ttu-id="309e8-157">Следующее значение ключа определяет, включена ли эта кнопка.</span><span class="sxs-lookup"><span data-stu-id="309e8-157">The following key value controls whether this button is included.</span></span>

    

    | <span data-ttu-id="309e8-158">Значение</span><span class="sxs-lookup"><span data-stu-id="309e8-158">Value</span></span>                    | <span data-ttu-id="309e8-159">Описание</span><span class="sxs-lookup"><span data-stu-id="309e8-159">Description</span></span>                                           |
    |--------------------------|-------------------------------------------------------|
    | <span data-ttu-id="309e8-160">**шутдовнвисаутлогон**</span><span class="sxs-lookup"><span data-stu-id="309e8-160">**ShutdownWithoutLogon**</span></span> | <span data-ttu-id="309e8-161">Один для включения кнопки; ноль для исключения кнопки</span><span class="sxs-lookup"><span data-stu-id="309e8-161">One to include the button; zero to exclude the button</span></span> |

    

     

-   <span data-ttu-id="309e8-162">**АктивацияUserinit.exe**</span><span class="sxs-lookup"><span data-stu-id="309e8-162">**Userinit.exe Activation**</span></span>

    <span data-ttu-id="309e8-163">Userinit.exe — это приложение, выполняемое MSGina.dll, когда пользователь вошел в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-163">Userinit.exe is an application that is executed by MSGina.dll when the user has logged on.</span></span> <span data-ttu-id="309e8-164">Она выполняется в [*контексте*](../secgloss/c-gly.md) пользователя, вошедшего в систему, и на рабочем столе приложения.</span><span class="sxs-lookup"><span data-stu-id="309e8-164">It runs in the newly logged-on user's [*context*](../secgloss/c-gly.md) and on the application desktop.</span></span> <span data-ttu-id="309e8-165">Его целью является настройка среды пользователя, включая восстановление использования сети, установку параметров профиля, таких как шрифты и цвета экрана, а также выполнение сценариев входа в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-165">Its purpose is to set up the user's environment, including restoring network uses, establishing profile settings such as fonts and screen colors, and running logon scripts.</span></span> <span data-ttu-id="309e8-166">После выполнения этих задач Userinit.exe выполняет программы оболочки пользователя.</span><span class="sxs-lookup"><span data-stu-id="309e8-166">After completing those tasks, Userinit.exe executes the user shell programs.</span></span> <span data-ttu-id="309e8-167">Программы оболочки наследуют среду, которая Userinit.exe настраивается.</span><span class="sxs-lookup"><span data-stu-id="309e8-167">The shell programs inherit the environment that Userinit.exe sets up.</span></span> <span data-ttu-id="309e8-168">Конкретные программы оболочки, которые Userinit.exe выполняются, сохраняются в значении ключа **оболочки** в разделе реестра Winlogon.</span><span class="sxs-lookup"><span data-stu-id="309e8-168">The specific shell programs that Userinit.exe executes are stored in the **Shell** key value under the Winlogon registry key.</span></span>

    <span data-ttu-id="309e8-169">Значение ключа **оболочки** может содержать разделенный запятыми список выполняемых программ.</span><span class="sxs-lookup"><span data-stu-id="309e8-169">The **Shell** key value can contain a comma-separated list of programs to be executed.</span></span> <span data-ttu-id="309e8-170">Проводник Windows является программой оболочки по умолчанию и будет выполняться, если значение ключа **оболочки** равно null или отсутствует.</span><span class="sxs-lookup"><span data-stu-id="309e8-170">Windows Explorer is the default shell program and will be executed if the **Shell** key value is null or not present.</span></span> <span data-ttu-id="309e8-171">По умолчанию отображается проводник Windows.</span><span class="sxs-lookup"><span data-stu-id="309e8-171">By default, Windows Explorer is listed.</span></span>

-   <span data-ttu-id="309e8-172">**Параметры безопасности, вошедшие в систему**</span><span class="sxs-lookup"><span data-stu-id="309e8-172">**Logged-On Security Options**</span></span>

    <span data-ttu-id="309e8-173">При входе в систему, если пользователь вводит контрольную [*последовательность*](../secgloss/s-gly.md) (SAS), пользователю предлагается экран с параметрами безопасности.</span><span class="sxs-lookup"><span data-stu-id="309e8-173">When logged on, if a user enters a [*secure attention sequence*](../secgloss/s-gly.md) (SAS), the user is presented with a security options screen.</span></span> <span data-ttu-id="309e8-174">Ниже перечислены возможные параметры.</span><span class="sxs-lookup"><span data-stu-id="309e8-174">Among the options listed are:</span></span>

    -   <span data-ttu-id="309e8-175">Завершите работу системы.</span><span class="sxs-lookup"><span data-stu-id="309e8-175">Shut down the system.</span></span>
    -   <span data-ttu-id="309e8-176">Выйдите из системы.</span><span class="sxs-lookup"><span data-stu-id="309e8-176">Log off.</span></span>
    -   <span data-ttu-id="309e8-177">Измените пароль.</span><span class="sxs-lookup"><span data-stu-id="309e8-177">Change the password.</span></span>
    -   <span data-ttu-id="309e8-178">Перейдите к списку задач.</span><span class="sxs-lookup"><span data-stu-id="309e8-178">Go to the task list.</span></span>
    -   <span data-ttu-id="309e8-179">Блокировка рабочей станции.</span><span class="sxs-lookup"><span data-stu-id="309e8-179">Lock the workstation.</span></span>

    <span data-ttu-id="309e8-180">Замена модели GINA может обеспечить аналогичные параметры при получении события SAS при входе пользователя в систему.</span><span class="sxs-lookup"><span data-stu-id="309e8-180">A replacement GINA can provide similar options when a SAS event is received while a user is logged on.</span></span>

 

 
