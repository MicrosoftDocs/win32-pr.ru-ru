---
description: Список пакетов безопасности, которые могут использоваться с SSPI.
ms.assetid: f5999d41-b334-49be-8883-d9b9042d20dc
title: Использование пакетов безопасности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df24bba0f910ba74a633e8a43f961cee4fb505db
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664029"
---
# <a name="using-security-packages"></a><span data-ttu-id="8b2f9-103">Использование пакетов безопасности</span><span class="sxs-lookup"><span data-stu-id="8b2f9-103">Using Security Packages</span></span>

<span data-ttu-id="8b2f9-104">[*Интерфейс поставщика поддержки безопасности*](../secgloss/s-gly.md) (SSPI) можно использовать со следующими [*пакетами безопасности*](../secgloss/s-gly.md):</span><span class="sxs-lookup"><span data-stu-id="8b2f9-104">The [*Security Support Provider Interface*](../secgloss/s-gly.md) (SSPI) can be used with the following [*security packages*](../secgloss/s-gly.md):</span></span>

-   [<span data-ttu-id="8b2f9-105">Пакет безопасности Kerberos</span><span class="sxs-lookup"><span data-stu-id="8b2f9-105">Kerberos Security Package</span></span>](#kerberos-security-package)
-   [<span data-ttu-id="8b2f9-106">Пакет безопасности NTLM</span><span class="sxs-lookup"><span data-stu-id="8b2f9-106">NTLM Security Package</span></span>](#ntlm-security-package)

<span data-ttu-id="8b2f9-107">Протоколы [*Kerberos*](../secgloss/k-gly.md) и NTLM реализуются как пакеты безопасности от Secur32.dll [*поставщика поддержки безопасности*](../secgloss/s-gly.md) (SSP), предоставляемого вместе с операционной системой.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-107">The [*Kerberos*](../secgloss/k-gly.md) and NTLM protocols are implemented as security packages from the Secur32.dll [*security support provider*](../secgloss/s-gly.md) (SSP) supplied with the operating system.</span></span> <span data-ttu-id="8b2f9-108">По умолчанию поддержка проверки подлинности Kerberos и NTLM загружается [*локальным администратором безопасности*](../secgloss/l-gly.md) на компьютере при запуске системы.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-108">By default, support for both Kerberos and NTLM authentication are loaded by the [*local security authority*](../secgloss/l-gly.md) (LSA) on a computer when the system starts.</span></span> <span data-ttu-id="8b2f9-109">В Windows Server или доменах Windows любой пакет можно использовать для проверки подлинности сетевых входов и подключений клиентов и серверов.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-109">In Windows Server or Windows domains, either package can be used to authenticate network logons and client/server connections.</span></span> <span data-ttu-id="8b2f9-110">Какой из них используется, зависит от возможностей компьютера на другой стороне соединения.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-110">Which one is used depends on the capabilities of the computer on the other side of the connection.</span></span> <span data-ttu-id="8b2f9-111">Протокол Kerberos всегда предпочтителен, если он доступен.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-111">The Kerberos protocol is always preferred, if available.</span></span>

<span data-ttu-id="8b2f9-112">После установки контекста безопасности для интерактивного пользователя другой экземпляр пакета Kerberos или NTLM может быть загружен процессом, запущенным в контексте безопасности пользователя, для поддержки обмена, подписывания, проверки, шифрования и расшифровки сообщений.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-112">After a security context for an interactive user has been established, another instance of the Kerberos or NTLM package can be loaded by a process running in the security context of the user to support the exchanging, signing, verifying, encrypting, and decrypting of messages.</span></span> <span data-ttu-id="8b2f9-113">Однако ни один из процессов, кроме LSA, всегда имеет доступ к [*ключам сеанса*](../secgloss/s-gly.md) или билетам в кэше учетных данных.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-113">However, no process other than the LSA is ever permitted access to [*session keys*](../secgloss/s-gly.md) or tickets in the credentials cache.</span></span>

<span data-ttu-id="8b2f9-114">Системные службы и приложения транспортного уровня получают доступ к SSP через SSPI, который предоставляет функции для перечисления пакетов безопасности, доступных в системе, выбора пакета и использования этого пакета для получения проверенного подключения.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-114">System services and transport-level applications access an SSP through SSPI, which provides functions for enumerating the security packages available on a system, selecting a package, and using that package to obtain an authenticated connection.</span></span>

<span data-ttu-id="8b2f9-115">Методы в SSPI — это универсальные подпрограммы, которые разработчики могут использовать без знания сведений о конкретном [*протоколе безопасности*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="8b2f9-115">The methods in SSPI are generic routines that developers can use without knowing the details of a particular [*security protocol*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="8b2f9-116">Например, при проверке подлинности подключения клиента/сервера:</span><span class="sxs-lookup"><span data-stu-id="8b2f9-116">For example, when a client/server connection is authenticated:</span></span>

1.  <span data-ttu-id="8b2f9-117">Приложение на клиентской стороне подключения отправляет [*учетные данные*](../secgloss/c-gly.md) на сервер с помощью функции SSPI [**InitializeSecurityContext (Общие)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta).</span><span class="sxs-lookup"><span data-stu-id="8b2f9-117">The application on the client side of the connection sends [*credentials*](../secgloss/c-gly.md) to the server using the SSPI function [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta).</span></span>
2.  <span data-ttu-id="8b2f9-118">Приложение на стороне сервера соединения отвечает с помощью функции SSPI [**AcceptSecurityContext (Общие)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext).</span><span class="sxs-lookup"><span data-stu-id="8b2f9-118">The application on the server side of the connection responds with the SSPI function [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext).</span></span>
3.  <span data-ttu-id="8b2f9-119">После проверки подлинности подключения LSA на сервере использует сведения от клиента для создания [*маркера доступа*](../secgloss/a-gly.md).</span><span class="sxs-lookup"><span data-stu-id="8b2f9-119">After the connection has been authenticated, the LSA on the server uses information from the client to build an [*access token*](../secgloss/a-gly.md).</span></span>
4.  <span data-ttu-id="8b2f9-120">Затем сервер может вызвать функцию SSPI [**имперсонатесекуритиконтекст**](/windows/desktop/api/Sspi/nf-sspi-impersonatesecuritycontext) , чтобы присоединить маркер доступа к потоку олицетворения для службы.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-120">The server can then call the SSPI function [**ImpersonateSecurityContext**](/windows/desktop/api/Sspi/nf-sspi-impersonatesecuritycontext) to attach the access token to an impersonation thread for the service.</span></span>

## <a name="kerberos-security-package"></a><span data-ttu-id="8b2f9-121">Пакет безопасности Kerberos</span><span class="sxs-lookup"><span data-stu-id="8b2f9-121">Kerberos Security Package</span></span>

<span data-ttu-id="8b2f9-122">[*Пакет безопасности*](../secgloss/s-gly.md) Kerberos основан на [*протоколе проверки подлинности Kerberos*](../secgloss/k-gly.md).</span><span class="sxs-lookup"><span data-stu-id="8b2f9-122">The Kerberos [*security package*](../secgloss/s-gly.md) is based on the [*Kerberos authentication protocol*](../secgloss/k-gly.md).</span></span>

<span data-ttu-id="8b2f9-123">Если протокол Kerberos используется для проверки подлинности подключения клиента или сервера, [**InitializeSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) создает сообщение GSSAPI, которое содержит \_ сообщение о требованиях КРБ AP \_ от клиента.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-123">If the Kerberos protocol is being used to authenticate a client/server connection, [**InitializeSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) generates a GSSAPI message that includes a KRB\_AP\_REQ message from the client.</span></span> <span data-ttu-id="8b2f9-124">[**AcceptSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) затем создает сообщение GSSAPI, которое содержит сообщение о КРБ \_ AP \_ от сервера.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-124">[**AcceptSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) then generates a GSSAPI message that includes a KRB\_AP\_REP message from the server.</span></span>

<span data-ttu-id="8b2f9-125">Дополнительные сведения о действиях, выполняемых в фоновом режиме в реализации протокола Kerberos, см. в разделе [Microsoft Kerberos](microsoft-kerberos.md).</span><span class="sxs-lookup"><span data-stu-id="8b2f9-125">For background information on the steps that take place behind the scenes in the implementation of a Kerberos protocol, see [Microsoft Kerberos](microsoft-kerberos.md).</span></span>

<span data-ttu-id="8b2f9-126">Все распределенные службы используют SSPI для доступа к протоколу Kerberos.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-126">All distributed services use SSPI to access the Kerberos protocol.</span></span> <span data-ttu-id="8b2f9-127">Частичный список способов использования протокола Kerberos для проверки подлинности включает следующие способы.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-127">A partial list of the ways in which the Kerberos protocol is used for authentication includes:</span></span>

-   <span data-ttu-id="8b2f9-128">Службы диспетчера очереди печати</span><span class="sxs-lookup"><span data-stu-id="8b2f9-128">Print spooler services</span></span>
-   <span data-ttu-id="8b2f9-129">Удаленный доступ к файлам CIFS/SMB</span><span class="sxs-lookup"><span data-stu-id="8b2f9-129">CIFS/SMB remote file access</span></span>
-   <span data-ttu-id="8b2f9-130">Запросы [*LDAP*](../secgloss/l-gly.md) к Active Directory</span><span class="sxs-lookup"><span data-stu-id="8b2f9-130">[*LDAP*](../secgloss/l-gly.md) queries to the Active Directory</span></span>
-   <span data-ttu-id="8b2f9-131">Распределенное управление файловой системой и ссылки</span><span class="sxs-lookup"><span data-stu-id="8b2f9-131">Distributed file system management and referrals</span></span>
-   <span data-ttu-id="8b2f9-132">Проверка подлинности "узел — узел безопасности" между узлами IPsec</span><span class="sxs-lookup"><span data-stu-id="8b2f9-132">IPsec host-to-host security authority authentication</span></span>
-   <span data-ttu-id="8b2f9-133">Запросы на резервирование для сетевого качества обслуживания</span><span class="sxs-lookup"><span data-stu-id="8b2f9-133">Reservation requests for network Quality of Service</span></span>
-   <span data-ttu-id="8b2f9-134">Проверка подлинности в интрасети для службы IIS</span><span class="sxs-lookup"><span data-stu-id="8b2f9-134">Intranet authentication to Internet Information Services</span></span>
-   <span data-ttu-id="8b2f9-135">Удаленное управление сервером или рабочей станцией с помощью RPC с проверкой подлинности</span><span class="sxs-lookup"><span data-stu-id="8b2f9-135">Remote server or workstation management using authenticated RPC</span></span>
-   <span data-ttu-id="8b2f9-136">[*Запросы сертификатов*](../secgloss/c-gly.md) службам сертификации для пользователей и компьютеров домена</span><span class="sxs-lookup"><span data-stu-id="8b2f9-136">[*Certificate requests*](../secgloss/c-gly.md) to Certificate Services for domain users and computers</span></span>

## <a name="ntlm-security-package"></a><span data-ttu-id="8b2f9-137">Пакет безопасности NTLM</span><span class="sxs-lookup"><span data-stu-id="8b2f9-137">NTLM Security Package</span></span>

<span data-ttu-id="8b2f9-138">Пакет безопасности NTLM основан на протоколе проверки подлинности NTLM.</span><span class="sxs-lookup"><span data-stu-id="8b2f9-138">The NTLM security package is based on the NTLM authentication protocol.</span></span>

 

 
