---
description: Поставщики учетных данных в Windows 10
ms.assetid: BCF69196-D4E4-41D0-B372-5000FD50164B
title: Поставщики учетных данных в Windows 10
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 12a7947000e5d5a989f71dcdddd808a8e1d5ab3f
ms.sourcegitcommit: cd9672511263d04c0e4bc41758dd1d9e89ea92b4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2021
ms.locfileid: "104350825"
---
# <a name="credential-providers-in-windows-10"></a><span data-ttu-id="24fc0-103">Поставщики учетных данных в Windows 10</span><span class="sxs-lookup"><span data-stu-id="24fc0-103">Credential Providers in Windows 10</span></span>

<span data-ttu-id="24fc0-104">Поставщики учетных данных являются основным механизмом проверки подлинности пользователей — они в настоящее время являются единственным способом подтвердить свою личность, необходимую для входа в систему и других сценариев проверки подлинности системы.</span><span class="sxs-lookup"><span data-stu-id="24fc0-104">Credential providers are the primary mechanism for user authentication—they currently are the only method for users to prove their identity which is required for logon and other system authentication scenarios.</span></span> <span data-ttu-id="24fc0-105">С Windows 10 и с появлением Microsoft Passport поставщики учетных данных важнее, чем когда-либо. они будут использоваться для проверки подлинности в приложениях, веб-сайтах и других.</span><span class="sxs-lookup"><span data-stu-id="24fc0-105">With Windows 10 and the introduction of Microsoft Passport, credential providers are more important than ever; they will be used for authentication into apps, websites, and more.</span></span>

<span data-ttu-id="24fc0-106">Корпорация Майкрософт предоставляет разнообразные поставщики учетных данных в составе Windows, такие как пароль, ПИН-код, карта и подсистема Windows Hello (отпечаток, лиц и распознавание IRI).</span><span class="sxs-lookup"><span data-stu-id="24fc0-106">Microsoft provides a variety of credential providers as part of Windows, such as password, PIN, smartcard, and Windows Hello (Fingerprint, Face, and Iris recognition).</span></span> <span data-ttu-id="24fc0-107">Они называются "системными поставщиками учетных данных" в этой статье.</span><span class="sxs-lookup"><span data-stu-id="24fc0-107">These are referred to as "system credential providers" in this article.</span></span> <span data-ttu-id="24fc0-108">Поставщики вычислительной техники, предприятия и другие сущности могут создавать собственные поставщики учетных данных и легко интегрировать их в Windows.</span><span class="sxs-lookup"><span data-stu-id="24fc0-108">OEMs, Enterprises, and other entities can write their own credential providers and integrate them easily into Windows.</span></span> <span data-ttu-id="24fc0-109">Они называются "сторонними поставщиками учетных данных" в этой статье.</span><span class="sxs-lookup"><span data-stu-id="24fc0-109">These are referred to as "third-party credential providers" in this article.</span></span> <span data-ttu-id="24fc0-110">Обратите внимание, что оба поставщика учетных данных v1 и v2 поддерживаются в Windows 10.</span><span class="sxs-lookup"><span data-stu-id="24fc0-110">Note that both V1 and V2 credential providers are supported in Windows 10.</span></span> <span data-ttu-id="24fc0-111">Для понимания этих рекомендаций важно быть создателями и руководителями сторонних поставщиков учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-111">It is important for creators and managers of third-party credential providers to understand these recommendations.</span></span>

## <a name="system-credential-providers"></a><span data-ttu-id="24fc0-112">Поставщики системных учетных данных</span><span class="sxs-lookup"><span data-stu-id="24fc0-112">System credential providers</span></span>

<span data-ttu-id="24fc0-113">Мы настоятельно рекомендуем всегда иметь по крайней мере один системный поставщик учетных данных, доступный для каждого пользователя на устройстве в дополнение к сторонним поставщикам учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-113">We strongly recommend that there always be at least one system credential provider available for every user on the device in addition to any third-party credential providers.</span></span> <span data-ttu-id="24fc0-114">Кроме того, во время установки стороннего поставщика учетных данных каждому пользователю на устройстве должно быть предложено настроить по крайней мере один системный поставщик учетных данных (если другие варианты восстановления недоступны). см. сценарий а ниже.</span><span class="sxs-lookup"><span data-stu-id="24fc0-114">Additionally, during the set-up of the third-party credential provider, each user on the device should be prompted to set up at least one system credential provider (if no other recovery options are available; see Scenario A, below).</span></span>

### <a name="scenario-a"></a><span data-ttu-id="24fc0-115">Сценарий А</span><span class="sxs-lookup"><span data-stu-id="24fc0-115">Scenario A</span></span>

<span data-ttu-id="24fc0-116">Пользователь локальной учетной записи настроил стороннего поставщика учетных данных и регулярно использует его для входа на устройство.</span><span class="sxs-lookup"><span data-stu-id="24fc0-116">A local account user has set up a third-party credential provider and regularly uses it to log into the device.</span></span> <span data-ttu-id="24fc0-117">Один день, пользователь устанавливает на устройстве некоторое обновление, которое прерывает работу стороннего поставщика учетных данных, и пользователь не знает об этом изменении перед перезапуском компьютера.</span><span class="sxs-lookup"><span data-stu-id="24fc0-117">One day, the user installs some update to the device that breaks the third-party credential provider, and the user is unaware of this change before restarting the machine.</span></span>

<span data-ttu-id="24fc0-118">При следующей перезагрузке пользователь находится на экране входа в систему и не может использовать ожидаемого стороннего поставщика учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-118">On the next restart, the user is on the logon screen and is unable to use the expected third-party credential provider.</span></span> <span data-ttu-id="24fc0-119">Если пользователь настроил системный поставщик учетных данных, он сможет войти на компьютер с его помощью.</span><span class="sxs-lookup"><span data-stu-id="24fc0-119">If the user has set up a system credential provider, the user will be able to log into the machine using it.</span></span> <span data-ttu-id="24fc0-120">В противном случае у пользователя нет возможности восстановить учетную запись на компьютере.</span><span class="sxs-lookup"><span data-stu-id="24fc0-120">If not, the user has no way to recover the account on the machine.</span></span>

### <a name="scenario-b"></a><span data-ttu-id="24fc0-121">Сценарий Б</span><span class="sxs-lookup"><span data-stu-id="24fc0-121">Scenario B</span></span>

<span data-ttu-id="24fc0-122">Пользователь учетной записи MSA/AD/AAD настроил стороннего поставщика учетных данных и регулярно использует его для входа на устройство.</span><span class="sxs-lookup"><span data-stu-id="24fc0-122">An MSA/AD/AAD account user has set up a third-party credential provider and regularly uses it to log into the device.</span></span> <span data-ttu-id="24fc0-123">Один день, пользователь устанавливает на устройстве некоторое обновление, которое прерывает работу стороннего поставщика учетных данных, и пользователь не знает об этом изменении перед перезапуском компьютера.</span><span class="sxs-lookup"><span data-stu-id="24fc0-123">One day, the user installs some update to the device that breaks the third -party credential provider, and the user is unaware of this change before restarting the machine.</span></span>

<span data-ttu-id="24fc0-124">При следующей перезагрузке пользователь находится на экране входа в систему и не может использовать ожидаемого стороннего поставщика учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-124">On the next restart, the user is on the logon screen and is unable to use the expected third-party credential provider.</span></span> <span data-ttu-id="24fc0-125">Если пользователь настроил системный поставщик учетных данных, он сможет войти на компьютер с его помощью.</span><span class="sxs-lookup"><span data-stu-id="24fc0-125">If the user has set up a system credential provider, the user will be able to log into the machine using it.</span></span> <span data-ttu-id="24fc0-126">Кроме того, если доступен поставщик учетных данных пароля системы, пользователь может удаленно запросить или сбросить пароль и использовать его для входа на компьютер.</span><span class="sxs-lookup"><span data-stu-id="24fc0-126">Alternatively, if the system's password credential provider is available, the user can remotely request/reset the password and use that to log into the machine.</span></span> <span data-ttu-id="24fc0-127">Если ни один из этих параметров недоступен, у пользователя нет возможности восстановить учетную запись на компьютере.</span><span class="sxs-lookup"><span data-stu-id="24fc0-127">If neither option is available, the user has no way to recover the account on the machine.</span></span>

### <a name="conclusion"></a><span data-ttu-id="24fc0-128">Заключение</span><span class="sxs-lookup"><span data-stu-id="24fc0-128">Conclusion</span></span>

<span data-ttu-id="24fc0-129">В заключение мы хотим запретить отключение всех системных поставщиков учетных данных на устройстве.</span><span class="sxs-lookup"><span data-stu-id="24fc0-129">In summary, we want to discourage the disabling of all system credential providers on a device.</span></span> <span data-ttu-id="24fc0-130">Хотя сторонние поставщики учетных данных могут выполнять дополнительные требования к проверке подлинности для определенных групп пользователей, очень важно убедиться, что пользователь всегда может восстановить доступ к своему компьютеру при возникновении критических изменений.</span><span class="sxs-lookup"><span data-stu-id="24fc0-130">While third-party credential providers may fulfill additional authentication requirements for particular groups of users, it is very important to ensure that the user can always regain access to their machine when a breaking change occurs.</span></span> <span data-ttu-id="24fc0-131">Эта гарантия обеспечивается системными поставщиками учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-131">System credential providers provide this guarantee.</span></span>

## <a name="custom-credential-providers"></a><span data-ttu-id="24fc0-132">Настраиваемые поставщики учетных данных</span><span class="sxs-lookup"><span data-stu-id="24fc0-132">Custom credential providers</span></span>

<span data-ttu-id="24fc0-133">Платформа поставщика учетных данных Windows позволяет разработчикам создавать пользовательские поставщики учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-133">The Windows credential provider framework enables developers to create custom credential providers.</span></span> <span data-ttu-id="24fc0-134">Когда служба [Winlogon](winlogon.md) хочет получить учетные данные, Пользовательский интерфейс входа в систему запрашивает у каждого поставщика учетных данных количество учетных записей, которые он хочет перечислить.</span><span class="sxs-lookup"><span data-stu-id="24fc0-134">When [Winlogon](winlogon.md) wants to collect credentials, the Logon UI queries each credential provider for the number of credentials that it wishes to enumerate.</span></span> <span data-ttu-id="24fc0-135">После того как все поставщики перечисляют плитки, Пользовательский интерфейс входа отображает их пользователю.</span><span class="sxs-lookup"><span data-stu-id="24fc0-135">After all providers have enumerated their tiles, the Logon UI displays them to the user.</span></span> <span data-ttu-id="24fc0-136">Затем пользователь взаимодействует с плиткой для предоставления необходимых учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-136">The user then interacts with a tile to supply the necessary credentials.</span></span> <span data-ttu-id="24fc0-137">Пользовательский интерфейс входа отправляет эти учетные данные для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="24fc0-137">The Logon UI submits these credentials for authentication.</span></span> <span data-ttu-id="24fc0-138">Поставщики учетных данных также могут использоваться в пользовательском интерфейсе учетных данных, если требуются учетные данные.</span><span class="sxs-lookup"><span data-stu-id="24fc0-138">Credential providers can also be used by the Credential UI when credentials are necessary.</span></span> <span data-ttu-id="24fc0-139">Список сценариев, в которых может поддерживаться поставщик учетных данных, см. в разделе [**\_ \_ \_ сценарий использования поставщика учетных данных**](/windows/desktop/api/credentialprovider/ne-credentialprovider-credential_provider_usage_scenario) .</span><span class="sxs-lookup"><span data-stu-id="24fc0-139">See [**CREDENTIAL\_PROVIDER\_USAGE\_SCENARIO**](/windows/desktop/api/credentialprovider/ne-credentialprovider-credential_provider_usage_scenario) for a list of scenarios where a credential provider can be supported.</span></span>

<span data-ttu-id="24fc0-140">Благодаря этой системе гораздо проще создать поставщик учетных данных, чем в прошлом.</span><span class="sxs-lookup"><span data-stu-id="24fc0-140">Thanks to this system, it is much easier to create a credential provider than it was historically.</span></span> <span data-ttu-id="24fc0-141">Большая часть работы обрабатывается сочетанием [Winlogon](winlogon.md), пользовательского интерфейса входа и пользовательского интерфейса учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-141">Much of the work is handled by the combination of [Winlogon](winlogon.md), the Logon UI and the Credential UI.</span></span> <span data-ttu-id="24fc0-142">Для этого необходимо создать собственную реализацию [**икредентиалпровидер**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovider) и [**ICredentialProviderCredential**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential).</span><span class="sxs-lookup"><span data-stu-id="24fc0-142">In order to do so, you will need to create your own implementation of [**ICredentialProvider**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovider) and [**ICredentialProviderCredential**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential).</span></span> <span data-ttu-id="24fc0-143">Если вы реализуете поставщик учетных данных версии 2 (рекомендуется), необходимо также реализовать [**ICredentialProviderCredential2**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential2).</span><span class="sxs-lookup"><span data-stu-id="24fc0-143">If you are implementing a V2 credential provider, which is recommended, you will also need to implement [**ICredentialProviderCredential2**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential2).</span></span>

<span data-ttu-id="24fc0-144">Важно отметить, что поставщики учетных данных не являются механизмами принудительного применения.</span><span class="sxs-lookup"><span data-stu-id="24fc0-144">It is important to note that credential providers are not enforcement mechanisms.</span></span> <span data-ttu-id="24fc0-145">Они просто используются для сбора и сериализации учетных данных, а также их отправки для авторизации.</span><span class="sxs-lookup"><span data-stu-id="24fc0-145">They are simply used to gather and serialize credentials, submitting them for authorization.</span></span> <span data-ttu-id="24fc0-146">Локальные полномочия и пакеты проверки подлинности будут обработаны и все необходимое обеспечение безопасности.</span><span class="sxs-lookup"><span data-stu-id="24fc0-146">The local authority and authentication packages will handle and any necessary security enforcement.</span></span>

<span data-ttu-id="24fc0-147">Объединив поставщики учетных данных с поддерживаемым оборудованием, вы можете расширить возможности Windows для поддержки входа в систему с помощью биометрических данных, паролей, ПИН-кодов, сертификатов или любого настраиваемого пакета проверки подлинности, который вы решили создать.</span><span class="sxs-lookup"><span data-stu-id="24fc0-147">Combining credential providers with supported hardware, you can extend Windows to support logging on with biometric information, passwords, PINs, Smart Card certificates, or any custom authentication package you choose to create.</span></span> <span data-ttu-id="24fc0-148">Вы также можете настроить процедуру входа для пользователя различными способами.</span><span class="sxs-lookup"><span data-stu-id="24fc0-148">You can customize the logon experience for the user in a variety of ways as well.</span></span> <span data-ttu-id="24fc0-149">Например, когда пользовательский интерфейс входа в систему запрашивает у поставщика учетных данных сведения о плитках с учетными данными, можно указать плитку по умолчанию, чтобы обеспечить пользовательский интерфейс для пользователя.</span><span class="sxs-lookup"><span data-stu-id="24fc0-149">For example, when the Logon UI queries your credential provider for the credential tiles, you can specify a default tile to provide a customized experience for a user.</span></span> <span data-ttu-id="24fc0-150">Поставщики учетных данных могут быть даже разработаны для поддержки единого входа (SSO), проверки подлинности пользователей в защищенной точке доступа, а также для входа на компьютер.</span><span class="sxs-lookup"><span data-stu-id="24fc0-150">Credential providers can even be designed to support single sign on (SSO), authenticating users to a secure access point as well as machine logon.</span></span>

<span data-ttu-id="24fc0-151">Поставщики учетных данных регистрируются на компьютере Windows и отвечают следующим.</span><span class="sxs-lookup"><span data-stu-id="24fc0-151">Credential providers are registered on a Windows machine and are responsible for the following.</span></span>

-   <span data-ttu-id="24fc0-152">Описание учетных данных, необходимых для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="24fc0-152">Describing the credential information required for authentication.</span></span>
-   <span data-ttu-id="24fc0-153">Обработка связи и логики с любыми внешними центрами проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="24fc0-153">Handling the communication and logic with any external authentication authorities.</span></span>
-   <span data-ttu-id="24fc0-154">Упаковка учетных данных для интерактивного входа и подключения к сети.</span><span class="sxs-lookup"><span data-stu-id="24fc0-154">Packaging the credentials for interactive and network logon.</span></span>

> [!TIP]
>
> <span data-ttu-id="24fc0-155">Помните, что на одном компьютере можно установить несколько поставщиков учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-155">Keep in mind that multiple credential providers can be installed on a single machine.</span></span>

## <a name="wrapping-credential-providers"></a><span data-ttu-id="24fc0-156">Создание оболочек для поставщиков учетных данных</span><span class="sxs-lookup"><span data-stu-id="24fc0-156">Wrapping credential providers</span></span>

<span data-ttu-id="24fc0-157">Оболочка для системного поставщика учетных данных может быть реализована для добавления к этому поставщику учетных данных функций, которые изначально не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="24fc0-157">Wrapping a system credential provider can be done to add functionality to that credential provider that is not natively supported.</span></span> <span data-ttu-id="24fc0-158">Это не рекомендуется, так как может привести к возникновению проблем в работе.</span><span class="sxs-lookup"><span data-stu-id="24fc0-158">This is not recommended because it can lead to problematic behavior.</span></span> <span data-ttu-id="24fc0-159">К поставщику учетных данных могут быть внесены изменения, которые могут конфликтовать с оболочкой, которая вызывает неудобство работы пользователя или даже предотвращает переход пользователя на устройство.</span><span class="sxs-lookup"><span data-stu-id="24fc0-159">Changes can be made to the credential provider which may conflict with the wrapper causing a poor user experience or even preventing the user from getting into their device.</span></span> <span data-ttu-id="24fc0-160">Это особенно верно для частоты обновления Windows 10.</span><span class="sxs-lookup"><span data-stu-id="24fc0-160">This is especially true with the frequent update cadence of Windows 10.</span></span>

<span data-ttu-id="24fc0-161">Если необходима функциональность поставщика учетных данных, которая не включена изначально, рекомендуемым путем является создание настраиваемого поставщика учетных данных.</span><span class="sxs-lookup"><span data-stu-id="24fc0-161">If functionality in a credential provider is needed that is not included natively, the recommended path is to create a custom credential provider.</span></span> <span data-ttu-id="24fc0-162">Это более стабильный подход, который не принимает зависимости от системных поставщиков.</span><span class="sxs-lookup"><span data-stu-id="24fc0-162">This is a more stable approach that does not take dependencies on the system providers.</span></span>

## <a name="related-topics"></a><span data-ttu-id="24fc0-163">См. также</span><span class="sxs-lookup"><span data-stu-id="24fc0-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="24fc0-164">Интерфейс входа Windows, управляемый поставщиком учетных данных</span><span class="sxs-lookup"><span data-stu-id="24fc0-164">Credential Provider driven Windows Logon Experience</span></span>](https://go.microsoft.com/fwlink/?LinkId=717287)
</dt> <dt>

[<span data-ttu-id="24fc0-165">икредентиалпровидер</span><span class="sxs-lookup"><span data-stu-id="24fc0-165">ICredentialProvider</span></span>](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovider)
</dt> <dt>

[<span data-ttu-id="24fc0-166">\_ \_ Сериализация учетных данных поставщика УЧЕТных данных \_</span><span class="sxs-lookup"><span data-stu-id="24fc0-166">CREDENTIAL\_PROVIDER\_CREDENTIAL\_SERIALIZATION</span></span>](/windows/desktop/api/credentialprovider/ns-credentialprovider-credential_provider_credential_serialization)
</dt> <dt>

[<span data-ttu-id="24fc0-167">\_ \_ сценарий использования поставщика УЧЕТных данных \_</span><span class="sxs-lookup"><span data-stu-id="24fc0-167">CREDENTIAL\_PROVIDER\_USAGE\_SCENARIO</span></span>](/windows/desktop/api/credentialprovider/ne-credentialprovider-credential_provider_usage_scenario)
</dt> </dl>

 

 
