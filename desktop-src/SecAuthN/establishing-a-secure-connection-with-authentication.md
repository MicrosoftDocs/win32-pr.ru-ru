---
description: В протоколе клиентских и серверных приложений сервер привязывается к коммуникационному порту, например к сокету или интерфейсу RPC.
ms.assetid: 176d4ca5-83dd-42ef-b116-227d4badc0dd
title: Установление безопасного подключения с проверкой подлинности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0a43483893c8dcf56e6db6b3c7d7aa1451bf9540
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105647623"
---
# <a name="establishing-a-secure-connection-with-authentication"></a><span data-ttu-id="ba686-103">Установление безопасного подключения с проверкой подлинности</span><span class="sxs-lookup"><span data-stu-id="ba686-103">Establishing a Secure Connection with Authentication</span></span>

<span data-ttu-id="ba686-104">В [*протоколе*](/windows/desktop/SecGloss/a-gly)клиентских и серверных приложений сервер привязывается к коммуникационному порту, например к сокету или интерфейсу RPC.</span><span class="sxs-lookup"><span data-stu-id="ba686-104">In a client/server [*application protocol*](/windows/desktop/SecGloss/a-gly), a server binds to a communication port such as a socket or an RPC interface.</span></span> <span data-ttu-id="ba686-105">Затем сервер ожидает подключения клиента и запроса службы.</span><span class="sxs-lookup"><span data-stu-id="ba686-105">The server then waits for a client to connect and request service.</span></span> <span data-ttu-id="ba686-106">Роль безопасности при настройке подключения состоит из двух сверток в случае взаимной проверки подлинности:</span><span class="sxs-lookup"><span data-stu-id="ba686-106">The role of security at connection setup is two-fold in the case of mutual authentication:</span></span>

-   <span data-ttu-id="ba686-107">Проверка подлинности клиента сервером.</span><span class="sxs-lookup"><span data-stu-id="ba686-107">Client authentication by the server.</span></span>
-   <span data-ttu-id="ba686-108">Проверка подлинности сервера клиентом.</span><span class="sxs-lookup"><span data-stu-id="ba686-108">Server authentication by the client.</span></span>

<span data-ttu-id="ba686-109">Клиентские и серверные компоненты транспортного приложения используют [*пакет безопасности*](/windows/desktop/SecGloss/s-gly) для установления безопасного подключения для передачи сообщений.</span><span class="sxs-lookup"><span data-stu-id="ba686-109">The client and server components of a transport application use a [*security package*](/windows/desktop/SecGloss/s-gly) to establish a secure connection for transmitting messages.</span></span> <span data-ttu-id="ba686-110">Первым шагом в установке безопасного соединения является создание [*контекста безопасности*](/windows/desktop/SecGloss/s-gly). то есть непрозрачная структура данных, содержащая данные безопасности, относящиеся к соединению, такие как [*сеансовый ключ*](/windows/desktop/SecGloss/s-gly) и продолжительность сеанса.</span><span class="sxs-lookup"><span data-stu-id="ba686-110">The first step in establishing a secure connection is to create a [*security context*](/windows/desktop/SecGloss/s-gly); that is, an opaque data structure that contains the security data relevant to a connection, such as a [*session key*](/windows/desktop/SecGloss/s-gly) and the duration of the session.</span></span>

<span data-ttu-id="ba686-111">Контекст безопасности — это, по сути, сообщение от пакета безопасности, связанного с клиентом, с пакетом безопасности, связанным с сервером.</span><span class="sxs-lookup"><span data-stu-id="ba686-111">A security context is essentially a message from the security package associated with the client to the security package associated with the server.</span></span> <span data-ttu-id="ba686-112">Следовательно, для создания контекста безопасности обычно требуется как клиент, так и сервер, чтобы выполнять вызовы соответствующих пакетов безопасности.</span><span class="sxs-lookup"><span data-stu-id="ba686-112">Consequently, creating a security context typically requires both client and server to make calls to their respective security packages.</span></span> <span data-ttu-id="ba686-113">Дополнительные сведения о контекстных функциях см. в разделе [Управление контекстами](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="ba686-113">For more information on context functions, see [Context Management](authentication-functions.md).</span></span>

<span data-ttu-id="ba686-114">Протокол, используемый для установления защищенного подключения с проверкой подлинности, включает в себя обмен одним или несколькими маркерами безопасности между клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="ba686-114">The protocol used to establish a secure, authenticated connection involves the exchange of one or more "security tokens" between the client and the server.</span></span> <span data-ttu-id="ba686-115">Эти маркеры отправляются в виде непрозрачных сообщений по двум сторонам вместе с другими сведениями, зависящими от [*протокола приложения*](/windows/desktop/SecGloss/a-gly).</span><span class="sxs-lookup"><span data-stu-id="ba686-115">These tokens are sent as opaque messages by the two sides along with any other [*application protocol*](/windows/desktop/SecGloss/a-gly)-specific information.</span></span> <span data-ttu-id="ba686-116">Как непрозрачное сообщение, маркер получается от функции пакета безопасности клиентом, который не может интерпретировать или изменить его и переслать в качестве сообщения на сервер.</span><span class="sxs-lookup"><span data-stu-id="ba686-116">As an opaque message, the token is received from a security package function by the client, which cannot interpret or change it, and forwarded as a message to the server.</span></span> <span data-ttu-id="ba686-117">Маркер также является непрозрачным для сервера, который не может ни интерпретировать, ни изменять маркер.</span><span class="sxs-lookup"><span data-stu-id="ba686-117">The token is also opaque to the server, which can neither interpret nor change the token.</span></span> <span data-ttu-id="ba686-118">Сервер пересылает непрозрачный маркер в пакет безопасности для интерпретации.</span><span class="sxs-lookup"><span data-stu-id="ba686-118">The server forwards the opaque token to its security package for interpretation.</span></span> <span data-ttu-id="ba686-119">Затем пакет информирует сервер о проверке подлинности клиента или о сбое проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="ba686-119">The package then informs the server of the client authentication or failure to authenticate.</span></span>

<span data-ttu-id="ba686-120">Клиент получает маркер сервера в сообщении, получает маркер из полученного сообщения и использует этот маркер в вызове пакета безопасности.</span><span class="sxs-lookup"><span data-stu-id="ba686-120">The client receives the server's token in a message, retrieves the token from the received message, and uses that token in a call to its security package.</span></span> <span data-ttu-id="ba686-121">Затем клиент вызывает пакет безопасности еще раз, указывая, установлено ли безопасное соединение или требуется ли дальнейший обмен, прежде чем безопасное подключение будет готово.</span><span class="sxs-lookup"><span data-stu-id="ba686-121">The client then calls the security package again indicating whether a secure connection has been established or whether further exchanges are needed before a secure connection is ready.</span></span> <span data-ttu-id="ba686-122">Теоретически нет ограничений на количество обменов маркерами безопасности.</span><span class="sxs-lookup"><span data-stu-id="ba686-122">Theoretically, there is no limit to the number of exchanges of security tokens needed.</span></span> <span data-ttu-id="ba686-123">На практике требуется только ограниченное количество Exchange.</span><span class="sxs-lookup"><span data-stu-id="ba686-123">In practice, only a limited number of exchanges is required.</span></span> <span data-ttu-id="ba686-124">Проверка подлинности NTLM основана на схеме «запрос/ответ» и использует три нечего для проверки подлинности клиента на сервере.</span><span class="sxs-lookup"><span data-stu-id="ba686-124">NTLM authentication is based on the challenge/response scheme, and uses three legs to authenticate a client to the server.</span></span> <span data-ttu-id="ba686-125">Протокол [*Kerberos*](/windows/desktop/SecGloss/k-gly) версии 5,0 может потребовать дополнительных обменов сообщениями.</span><span class="sxs-lookup"><span data-stu-id="ba686-125">The [*Kerberos*](/windows/desktop/SecGloss/k-gly) version 5.0 protocol can require additional message exchanges.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ba686-126">См. также</span><span class="sxs-lookup"><span data-stu-id="ba686-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ba686-127">Инициализация контекста клиента</span><span class="sxs-lookup"><span data-stu-id="ba686-127">Client Context Initialization</span></span>](client-context-initialization.md)
</dt> <dt>

[<span data-ttu-id="ba686-128">Инициализация контекста сервера</span><span class="sxs-lookup"><span data-stu-id="ba686-128">Server Context Initialization</span></span>](server-context-initialization.md)
</dt> </dl>

 

 
