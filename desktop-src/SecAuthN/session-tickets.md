---
description: Вместо отправки зашифрованных ключей сеанса обоим участникам, KDC отправляет клиенту и серверу клиентские и серверные ключи сеанса.
ms.assetid: 6b20ab30-2cd9-4f2e-a26b-316980c4bc78
title: Билеты сеансов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7b514abc76eabcbe70f00c1e879b9389c83ad333d7b5c10d4150478f03db6a6
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118918073"
---
# <a name="session-tickets"></a>Билеты сеансов

Вместо отправки зашифрованных ключей сеанса обоим участникам, [KDC](key-distribution-center.md) отправляет клиенту и серверу клиентские и серверные ключи [*сеанса*](../secgloss/s-gly.md) . Копия ключа сеанса клиента шифруется с помощью [*главного ключа*](../secgloss/m-gly.md) клиента и поэтому не может быть расшифрована любой другой сущностью. Копия ключа сеанса сервера внедряется вместе с данными авторизации о клиенте в структуре данных, именуемой билетом. Билет полностью шифруется с помощью главного ключа сервера и поэтому не может быть прочитан или изменен клиентом или любой другой сущностью, не имеющей доступа к главному ключу сервера. Клиент должен безопасно хранить билет до обращения к серверу.

> [!Note]  
> KDC предоставляет только службу предоставления билетов. Клиент и сервер отвечают за поддержание безопасности соответствующих главных ключей.

 

Когда клиент получает ответ KDC, он извлекает билет и собственную копию ключа сеанса, помещая ее в безопасный кэш. Чтобы установить безопасный сеанс с сервером, он отправляет серверу сообщение, состоящее из билета, по-прежнему зашифрованного с помощью главного ключа сервера, и [сообщение средства проверки подлинности](authenticator-messages.md) , зашифрованное с помощью ключа сеанса. В совокупности сообщение с билетом и средством проверки подлинности — это [*учетные данные*](../secgloss/c-gly.md) клиента на сервере.

Когда сервер получает учетные данные от клиента, он расшифровывает билет с помощью его [*главного ключа*](../secgloss/m-gly.md), извлекает [*ключ сеанса*](../secgloss/s-gly.md)и использует сеансовый ключ для расшифровки сообщения средства проверки подлинности клиента. Если все проверяются, сервер знает, что учетные данные клиента были выданы центром распространения ключей, доверенным центром сертификации. Для взаимной проверки подлинности сервер отвечает путем шифрования метки времени из сообщения средства проверки подлинности клиента с помощью ключа сеанса. Это зашифрованное сообщение отправляется клиенту. Затем клиент расшифровывает сообщение. Если возвращаемое сообщение совпадает с меткой времени исходного сообщения средства проверки подлинности, сервер проходит проверку подлинности.

В качестве дополнительного преимущества серверу не нужно хранить ключи сеансов, которые он использует для своих клиентов. Ответственность за управление билетом сервера в кэше билетов и на предоставление этого билета при каждом доступе к серверу осуществляется каждой обязанностью клиента. Каждый раз, когда сервер получает билет от клиента, он использует его главный ключ для расшифровки билета и извлечения ключа сеанса. Если серверу больше не требуется ключ сеанса, ключ удаляется.

Клиенту не требуется доступ к KDC каждый раз, когда ему нужен доступ к этому конкретному серверу. Билеты можно использовать повторно. В качестве меры предосторожности при краже билетов у билетов есть срок действия, заданный KDC в структуре билетов. Срок действия билета зависит от политики Kerberos для области. Как правило, билеты хорошо подходят не более восьми часов, о продолжительности обычного [*сеанса входа в систему*](../secgloss/l-gly.md). Когда пользователь на клиентской рабочей станции выходит из системы, кэш билетов клиента очищается, и все билеты и ключи сеанса клиента уничтожаются.

 

 
