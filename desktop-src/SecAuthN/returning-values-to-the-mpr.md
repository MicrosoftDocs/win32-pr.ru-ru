---
description: Сетевые функции Windows возвращают WN \_ успешно при успешном выполнении или возвращают уникальное ненулевое значение, если функция встречает ошибку. Кроме того, они возвращают расширенные сведения об ошибках с помощью Внетсетластеррор и Сетластеррор.
ms.assetid: cb9d29a1-b3a5-4440-a069-3cd1565b1699
title: Возвращение значений к многопротокольному маршрутизатору
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c96a5636f57d5c926af4e43e676f0b6db75d164
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103998399"
---
# <a name="returning-values-to-the-mpr"></a><span data-ttu-id="d9d1d-104">Возвращение значений к многопротокольному маршрутизатору</span><span class="sxs-lookup"><span data-stu-id="d9d1d-104">Returning Values to the MPR</span></span>

<span data-ttu-id="d9d1d-105">Сетевые функции Windows возвращают WN \_ успешно при успешном выполнении или возвращают уникальное ненулевое значение, если функция встречает ошибку.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-105">The Windows Networking functions return WN\_SUCCESS on success, or they return a unique nonzero value if the function encounters an error.</span></span> <span data-ttu-id="d9d1d-106">Кроме того, они возвращают расширенные сведения об ошибках с помощью [**внетсетластеррор**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) и [**сетластеррор**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror).</span><span class="sxs-lookup"><span data-stu-id="d9d1d-106">In addition, they return extended error information using [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) and [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror).</span></span>

<span data-ttu-id="d9d1d-107">Для поддержки описанного выше поведения функции поставщика сети не должны вызывать [**сетластеррор**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) перед возвратом.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-107">To support the above behavior, network provider functions should not call [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) before returning.</span></span> <span data-ttu-id="d9d1d-108">Это обусловлено тем, что многопротокольный маршрутизатор вызывает **сетластеррор** для функций в API поставщика сети после возврата.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-108">This is because the MPR calls **SetLastError** for the functions in the Network Provider API after they return.</span></span> <span data-ttu-id="d9d1d-109">Если поставщики сети напрямую вызывают **сетластеррор** , они будут делать лишние вызовы функций.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-109">If the network providers call **SetLastError** directly, they will be making redundant function calls.</span></span> <span data-ttu-id="d9d1d-110">Функции поставщика сети должны просто возвращать код ошибки.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-110">Network provider functions should simply return an error code.</span></span> <span data-ttu-id="d9d1d-111">Коды ошибок указываются в описании функции или [возвращаемых значениях](network-security-return-values.md).</span><span class="sxs-lookup"><span data-stu-id="d9d1d-111">The error codes are specified in the function description or [Return Values](network-security-return-values.md).</span></span> <span data-ttu-id="d9d1d-112">Кроме того, функции поставщика сети могут возвращать [коды системных ошибок](../debug/system-error-codes.md), например недостаток памяти.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-112">Also, network provider functions may return any [System Error Codes](../debug/system-error-codes.md), such as insufficient memory.</span></span> <span data-ttu-id="d9d1d-113">Единственным исключением является [**нпжеткапс**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps), которое должно возвращать маску, указывающую функции, поддерживаемые поставщиком сети.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-113">The only exception is [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps), which should return a mask indicating the functions supported by the network provider.</span></span>

<span data-ttu-id="d9d1d-114">Если функция поставщика сети должна возвращать расширенные сведения об ошибке, она должна вызывать [**внетсетластеррор**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora).</span><span class="sxs-lookup"><span data-stu-id="d9d1d-114">If a network provider function needs to return extended error information, it should call [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora).</span></span> <span data-ttu-id="d9d1d-115">Эта функция предоставляется операционной системой Windows для использования поставщиками сети.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-115">This function is provided by the Windows operating system for use by network providers.</span></span> <span data-ttu-id="d9d1d-116">Когда поставщик вызывает **внетсетластеррор**, он может задать строку, содержащую дополнительные сведения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-116">When the provider calls **WNetSetLastError**, it can set a string containing additional information about the error.</span></span> <span data-ttu-id="d9d1d-117">Эти сведения хранятся отдельно для каждого потока.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-117">This information is stored on a per-thread basis.</span></span> <span data-ttu-id="d9d1d-118">Это аналогично [**сетластеррор**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) для приложений Windows.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-118">This is analogous to [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) for Windows applications.</span></span> <span data-ttu-id="d9d1d-119">Операционная система Windows вызывает **внетсетластеррор** для проверки строки, хранящейся с помощью **внетсетластеррор** , и, если она найдена, возвращает расширенные сведения об ошибке вызывающему приложению, которое инициировало сетевой запрос.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-119">The Windows operating system calls **WNetSetLastError** to check for a string stored using **WNetSetLastError** and, if found, returns the extended error information to the calling application that initiated the network request.</span></span>

> [!Note]  
> <span data-ttu-id="d9d1d-120">Префикс Внет [**внетсетластеррор**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) является ошибочным, так как этот API, в отличие от **внетсетластеррор**, не входит в набор API сетевых интерфейсов Windows.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-120">The WNet prefix of [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) is misleading since this API, unlike **WNetSetLastError**, is not part of the Windows Networking API set.</span></span> <span data-ttu-id="d9d1d-121">**Внетсетластеррор** предназначен для использования только поставщиками сети.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-121">**WNetSetLastError** is intended for use only by network providers.</span></span> <span data-ttu-id="d9d1d-122">Имя **внетсетластеррор** сохраняется для совместимости с существующими поставщиками.</span><span class="sxs-lookup"><span data-stu-id="d9d1d-122">The name, **WNetSetLastError**, is retained for compatibility with existing providers.</span></span>

 

 

 
