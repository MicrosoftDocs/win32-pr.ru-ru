---
description: Пользовательский интерфейс смарт-карты — это одно общее диалоговое окно, которое позволяет пользователю указать или найти смарт-карту, которую нужно открыть (то есть подключиться и использовать в приложении).
ms.assetid: a64a617a-b2ae-471f-a88f-a73f0fc3a791
title: Пользовательский интерфейс смарт-карты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3b94a82889d196b01f8a1d1ca6af7b4788398d9508accc2d5ca245f7929d9d0
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118917334"
---
# <a name="smart-card-user-interface"></a>Пользовательский интерфейс смарт-карты

[*Пользовательский интерфейс*](../secgloss/u-gly.md) смарт-карты — это одно [*общее диалоговое окно*](../secgloss/s-gly.md) , которое позволяет пользователю указать или найти смарт-карту, которую нужно открыть (то есть подключиться и использовать в приложении).

Ниже приведены два способа использования диалогового окна общее. Оба варианта предполагают, что будет отображаться пользовательский интерфейс диалогового окна. Дополнительные сведения см. в разделе [**опенкарднаме**](/windows/desktop/api/Winscard/ns-winscard-opencardnamea).

**Выбор смарт-карты для открытия**

1.  Объявите переменную типа **опенкарднаме**.
2.  Укажите достаточно информации в общем диалоговом окне, чтобы уточнить поиск смарт-карты, которую ищет вызывающее приложение. Это включает в себя указание **лпстрграупнамес**, **лпстркарднамес** и **рггуидинтерфацес**. Сюда также входит указание предпочтительного режима общего доступа и используемого протокола, когда общее диалоговое окно подключается к карточке с помощью членов **двшаремоде** и **двпреферредпротоколс** структуры [**опенкарднаме**](/windows/desktop/api/Winscard/ns-winscard-opencardnamea) .
3.  Вызовите функцию [**жетопенкарднаме**](/windows/desktop/api/Winscard/nf-winscard-getopencardnamea) , чтобы отобразить общее диалоговое окно для пользователя. Будет отображена простая строка справочной информации, и если одна из запрашиваемых карточек найдена, карточка будет выделена на экране. При поиске нескольких имен карт будет выделено первое средство чтения, содержащее одну из предпочтительных карточек.
4.  Затем пользователь выбирает карту, нажимает кнопку **ОК** и подключается к смарт-карте.

**Поиск конкретной карточки**

1.  Объявите переменную типа **опенкарднаме**.
2.  Укажите достаточно информации в общем диалоговом окне, чтобы уточнить поиск смарт-карты, которую ищет вызывающее приложение. Это включает в себя указание **лпстрграупнамес**, **лпстркарднамес** и **рггуидинтерфацес**.
3.  создайте **Подключение**, **проверьте** и **отключите** функции обратного вызова и задайте соответствующие элементы данных **лпфнконнект**, **лпфнчекк** и **лпфндисконнект** .
    > [!Note]  
    > Все три функции и члены должны быть доступны при использовании общего диалогового окна таким образом.

     

4.  Вызов функции общего диалогового окна [**жетопенкарднаме**](/windows/desktop/api/Winscard/nf-winscard-getopencardnamea) .
5.  Затем общее диалоговое окно будет искать запрошенные карточки. если найдено совпадающее имя карты или [*строка ATR*](../secgloss/a-gly.md) , функции обратного вызова **Подключение**, **проверки** и **отключения** будут вызываться последовательно. Если карта передает подпрограммы **проверки** (то есть функция обратного вызова **проверки** возвращает **значение true**), эта карточка выделяется пользователю на экране.
    > [!Note]  
    > Если задано несколько имен карточек, то первый модуль чтения, который содержит одну из запрошенных карточек, и передает подпрограмму **проверки** , будет выбранной картой.

     

6.  Если совпадений не найдено, появится общее диалоговое окно.

 

 
