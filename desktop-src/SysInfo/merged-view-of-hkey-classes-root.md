---
description: Функция Регопенусерклассесрут предоставляет объединенное представление для процессов, таких как службы, которые работают с клиентами, отличными от интерактивного пользователя.
ms.assetid: 3815d487-2d58-4ba8-85d2-cae6a642a791
title: Объединенное представление HKEY_CLASSES_ROOT
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8597db976922db9ca348488b0092c41ba7c7489
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664351"
---
# <a name="merged-view-of-hkey_classes_root"></a><span data-ttu-id="02abd-103">Объединенное представление \_ корня классов \_ hKey</span><span class="sxs-lookup"><span data-stu-id="02abd-103">Merged View of HKEY\_CLASSES\_ROOT</span></span>

<span data-ttu-id="02abd-104">Функция [**регопенусерклассесрут**](/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot) предоставляет объединенное представление для процессов, таких как службы, которые работают с клиентами, отличными от интерактивного пользователя.</span><span class="sxs-lookup"><span data-stu-id="02abd-104">The [**RegOpenUserClassesRoot**](/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot) function provides a merged view for processes, such as services, that are dealing with clients other than the interactive user.</span></span> <span data-ttu-id="02abd-105">В этом случае **\_ \_ корневой ключ классов hKey** предоставляет представление реестра, которое объединяет информацию из **\_ \_ \\ \\ классов программного обеспечения локального компьютера hKey** с информацией из разделов **hKey \_ текущего \_ пользователя \\ \\**.</span><span class="sxs-lookup"><span data-stu-id="02abd-105">In this case, the **HKEY\_CLASSES\_ROOT** key provides a view of the registry that merges the information from **HKEY\_LOCAL\_MACHINE\\Software\\Classes** with the information from **HKEY\_CURRENT\_USER\\Software\\Classes**.</span></span>

<span data-ttu-id="02abd-106">Система использует следующие правила для слияния данных из двух источников:</span><span class="sxs-lookup"><span data-stu-id="02abd-106">The system uses the following rules to merge information from the two sources:</span></span>

-   <span data-ttu-id="02abd-107">Объединенное представление включает все подразделы ключа **\_ \_ \\ \\ классов программного обеспечения hKey текущего пользователя** .</span><span class="sxs-lookup"><span data-stu-id="02abd-107">The merged view includes all subkeys of the **HKEY\_CURRENT\_USER\\Software\\Classes** key.</span></span>
-   <span data-ttu-id="02abd-108">Объединенное представление включает в себя все непосредственные подразделы ключа **\_ \_ \\ \\ классов программного обеспечения файла hKey** , которые не дублируют подразделы программных **\_ \_ \\ \\ классов hKey текущего пользователя**.</span><span class="sxs-lookup"><span data-stu-id="02abd-108">The merged view includes all immediate subkeys of the **HKEY\_LOCAL\_MACHINE\\Software\\Classes** key that do not duplicate the subkeys of **HKEY\_CURRENT\_USER\\Software\\Classes**.</span></span>
-   <span data-ttu-id="02abd-109">В конце этого раздела вы найдете список подразделов, которые находятся в **\_ \_ \\ \\ классах программного обеспечения на локальном компьютере** и **разделе \_ hKey \_ текущих \\ пользовательских \\ классов программного обеспечения**.</span><span class="sxs-lookup"><span data-stu-id="02abd-109">At the end of this topic is a list of subkeys that are found in both **HKEY\_LOCAL\_MACHINE\\Software\\Classes** and **HKEY\_CURRENT\_USER\\Software\\Classes**.</span></span> <span data-ttu-id="02abd-110">Непосредственные подразделы этих разделов из **дерева \_ локальных \_ компьютеров hKey** включаются в объединенное представление только в том случае, если они не дублируют непосредственные подразделы из дерева **\_ текущего \_ пользователя hKey** .</span><span class="sxs-lookup"><span data-stu-id="02abd-110">The immediate subkeys of these keys from the **HKEY\_LOCAL\_MACHINE** tree are included in the merged view only if they are not duplicates of immediate subkeys from the **HKEY\_CURRENT\_USER** tree.</span></span> <span data-ttu-id="02abd-111">Объединенное представление не включает содержимое файла **hKey на \_ локальном \_ компьютере** с повторяющимися подразделами.</span><span class="sxs-lookup"><span data-stu-id="02abd-111">The merged view does not include the **HKEY\_LOCAL\_MACHINE** contents of duplicate subkeys.</span></span>

<span data-ttu-id="02abd-112">Если приложение запускается с правами администратора, а Управление учетными записями пользователей отключено, среда выполнения COM игнорирует конфигурацию COM для каждого пользователя и обращается только к конфигурации COM на уровне компьютера.</span><span class="sxs-lookup"><span data-stu-id="02abd-112">If an application is run with administrator rights and User Account Control is disabled, the COM runtime ignores per-user COM configuration and accesses only per-machine COM configuration.</span></span> <span data-ttu-id="02abd-113">Приложения, для которых требуются права администратора, должны регистрировать зависимые COM-объекты во время установки в хранилище конфигураций COM для каждого компьютера (**hKey, \_ \_ \\ \\ классы программного обеспечения для локального компьютера**).</span><span class="sxs-lookup"><span data-stu-id="02abd-113">Applications that require administrator rights should register dependent COM objects during installation to the per-machine COM configuration store (**HKEY\_LOCAL\_MACHINE\\Software\\Classes**).</span></span> <span data-ttu-id="02abd-114">Дополнительные сведения см. в разделе [AC: UAC: конфигурация Per-User com](/previous-versions/bb756926(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="02abd-114">For more information, see [AC: UAC: COM Per-User Configuration](/previous-versions/bb756926(v=msdn.10)).</span></span>

<span data-ttu-id="02abd-115">**Windows Server 2003 и Windows XP/2000:** Приложения могут регистрировать зависимые COM-объекты в хранилище конфигураций COM на уровне компьютера или на уровне пользователя (в **\_ \_ \\ \\ классе "программное обеспечение локального компьютера** " или в **hKey \_ текущих \_ пользовательских \\ \\ классов**).</span><span class="sxs-lookup"><span data-stu-id="02abd-115">**Windows Server 2003 and Windows XP/2000:** Applications can register dependent COM objects to either the per-machine or per-user COM configuration store (**HKEY\_LOCAL\_MACHINE\\Software\\Classes** or **HKEY\_CURRENT\_USER\\Software\\Classes**).</span></span>

<span data-ttu-id="02abd-116">В следующем примере показан набор подразделов в разделе " **\_ локальный \_ компьютер" hKey** и разделы **\_ текущего \_ пользователя hKey** , а также объединенное **представление \_ \_ корня классов hKey**.</span><span class="sxs-lookup"><span data-stu-id="02abd-116">The following example shows a set of subkeys under the **HKEY\_LOCAL\_MACHINE** and **HKEY\_CURRENT\_USER** keys and the resulting merged view of **HKEY\_CLASSES\_ROOT**.</span></span>

<span data-ttu-id="02abd-117">**HKey \_ \_ \\ \\ Классы программного обеспечения локального компьютера**    **CLSID**       *2*       *4*          **InprocServer32**          **LocalServer32**       *7*</span><span class="sxs-lookup"><span data-stu-id="02abd-117">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes**    **CLSID**       *2*       *4*          **inprocserver32**          **localserver32**       *7*</span></span>

<span data-ttu-id="02abd-118">**HKey \_ Классы с текущим \_ пользовательским \\ программным обеспечением \\**    **CLSID**       *1*       *4*          **локалсервер**       *6*       *10*          **локалсервер**</span><span class="sxs-lookup"><span data-stu-id="02abd-118">**HKEY\_CURRENT\_USER\\Software\\Classes**    **CLSID**       *1*       *4*          **localserver**       *6*       *10*          **localserver**</span></span>

<span data-ttu-id="02abd-119">**HKey \_ \_Корневой\*\*\*\*CLSID** классов *1**2**4***InprocServer32\*\*\*\*локалсервер\*\*\*\*LocalServer32***6**7**10\*\*\*локалсервер*\*                                                                                      </span><span class="sxs-lookup"><span data-stu-id="02abd-119">**HKEY\_CLASSES\_ROOT**    **CLSID**       *1*       *2*       *4*          **inprocserver32**          **localserver**          **localserver32**       *6*       *7*       *10*          **localserver**</span></span>

<span data-ttu-id="02abd-120">Следующие подразделы находятся в **\_ \_ \\ \\ классах программного обеспечения локального компьютера hKey** и в **hKey \_ текущих \_ пользовательских \\ \\ классов программного обеспечения**.</span><span class="sxs-lookup"><span data-stu-id="02abd-120">The following subkeys are found in both **HKEY\_LOCAL\_MACHINE\\Software\\Classes** and **HKEY\_CURRENT\_USER\\Software\\Classes**.</span></span> <span data-ttu-id="02abd-121">В дереве **\_ локальных \_ компьютеров hKey** непосредственные подразделы этих ключей включаются в объединенное представление только в том случае, если они не дублируют непосредственные подразделы из дерева **\_ текущего \_ пользователя hKey** .</span><span class="sxs-lookup"><span data-stu-id="02abd-121">From the **HKEY\_LOCAL\_MACHINE** tree, the immediate subkeys of these keys are included in the merged view only if they are not duplicates of immediate subkeys from the **HKEY\_CURRENT\_USER** tree.</span></span> <span data-ttu-id="02abd-122">Объединенное представление не включает содержимое файла **hKey на \_ локальном \_ компьютере** с повторяющимися подразделами.</span><span class="sxs-lookup"><span data-stu-id="02abd-122">The merged view does not include the **HKEY\_LOCAL\_MACHINE** contents of duplicate subkeys.</span></span>

<span data-ttu-id="02abd-123">**\**_ _*\*\\ шеллекс**</span><span class="sxs-lookup"><span data-stu-id="02abd-123">**\**_ _*\*\\shellex**</span></span>  
<span data-ttu-id="02abd-124">**\*\\шеллекс \\ контекстменухандлерс**</span><span class="sxs-lookup"><span data-stu-id="02abd-124">**\*\\shellex\\ContextMenuHandlers**</span></span>  
<span data-ttu-id="02abd-125">**\*\\шеллекс \\ пропертишисандлерс**</span><span class="sxs-lookup"><span data-stu-id="02abd-125">**\*\\shellex\\PropertySheetHandlers**</span></span>  
<span data-ttu-id="02abd-126">**AppID**</span><span class="sxs-lookup"><span data-stu-id="02abd-126">**AppID**</span></span>  
<span data-ttu-id="02abd-127">**Этому**</span><span class="sxs-lookup"><span data-stu-id="02abd-127">**ClsID**</span></span>  
<span data-ttu-id="02abd-128">**Категории компонентов**</span><span class="sxs-lookup"><span data-stu-id="02abd-128">**Component Categories**</span></span>  
<span data-ttu-id="02abd-129">**Накопитель**</span><span class="sxs-lookup"><span data-stu-id="02abd-129">**Drive**</span></span>  
<span data-ttu-id="02abd-130">**\\Шеллекс диска**</span><span class="sxs-lookup"><span data-stu-id="02abd-130">**Drive\\shellex**</span></span>  
<span data-ttu-id="02abd-131">**Диск \\ шеллекс \\ контекстменухандлерс**</span><span class="sxs-lookup"><span data-stu-id="02abd-131">**Drive\\shellex\\ContextMenuHandlers**</span></span>  
<span data-ttu-id="02abd-132">**Диск \\ шеллекс \\ пропертишисандлерс**</span><span class="sxs-lookup"><span data-stu-id="02abd-132">**Drive\\shellex\\PropertySheetHandlers**</span></span>  
<span data-ttu-id="02abd-133">**FileType**</span><span class="sxs-lookup"><span data-stu-id="02abd-133">**FileType**</span></span>  
<span data-ttu-id="02abd-134">**Папка**</span><span class="sxs-lookup"><span data-stu-id="02abd-134">**Folder**</span></span>  
<span data-ttu-id="02abd-135">**Папка \\ шеллекс**</span><span class="sxs-lookup"><span data-stu-id="02abd-135">**Folder\\shellex**</span></span>  
<span data-ttu-id="02abd-136">**Папка \\ шеллекс \\ колумнхандлер**</span><span class="sxs-lookup"><span data-stu-id="02abd-136">**Folder\\shellex\\ColumnHandler**</span></span>  
<span data-ttu-id="02abd-137">**Папка \\ шеллекс \\ контекстменухандлерс**</span><span class="sxs-lookup"><span data-stu-id="02abd-137">**Folder\\shellex\\ContextMenuHandlers**</span></span>  
<span data-ttu-id="02abd-138">**Папка \\ шеллекс \\ екстшеллфолдервиевс**</span><span class="sxs-lookup"><span data-stu-id="02abd-138">**Folder\\shellex\\ExtShellFolderViews**</span></span>  
<span data-ttu-id="02abd-139">**Папка \\ шеллекс \\ пропертишисандлерс**</span><span class="sxs-lookup"><span data-stu-id="02abd-139">**Folder\\shellex\\PropertySheetHandlers**</span></span>  
<span data-ttu-id="02abd-140">**\\Компоненты установщика**</span><span class="sxs-lookup"><span data-stu-id="02abd-140">**Installer\\Components**</span></span>  
<span data-ttu-id="02abd-141">**\\Функции установщика**</span><span class="sxs-lookup"><span data-stu-id="02abd-141">**Installer\\Features**</span></span>  
<span data-ttu-id="02abd-142">**\\Продукты установщика**</span><span class="sxs-lookup"><span data-stu-id="02abd-142">**Installer\\Products**</span></span>  
<span data-ttu-id="02abd-143">**Интерфейс**</span><span class="sxs-lookup"><span data-stu-id="02abd-143">**Interface**</span></span>  
<span data-ttu-id="02abd-144">**Формата**</span><span class="sxs-lookup"><span data-stu-id="02abd-144">**Mime**</span></span>  
<span data-ttu-id="02abd-145">**\\База данных MIME**</span><span class="sxs-lookup"><span data-stu-id="02abd-145">**Mime\\Database**</span></span>  
<span data-ttu-id="02abd-146">**\\CharSet базы данных MIME \\**</span><span class="sxs-lookup"><span data-stu-id="02abd-146">**Mime\\Database\\Charset**</span></span>  
<span data-ttu-id="02abd-147">**\\ \\ Кодовая страница базы данных MIME**</span><span class="sxs-lookup"><span data-stu-id="02abd-147">**Mime\\Database\\Codepage**</span></span>  
<span data-ttu-id="02abd-148">**\\Тип содержимого базы данных MIME \\**</span><span class="sxs-lookup"><span data-stu-id="02abd-148">**Mime\\Database\\Content Type**</span></span>  
<span data-ttu-id="02abd-149">**Экспорт Typelib**</span><span class="sxs-lookup"><span data-stu-id="02abd-149">**Typelib**</span></span>  


 

 
