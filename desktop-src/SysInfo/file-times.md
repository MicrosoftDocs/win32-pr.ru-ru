---
description: Время файла — это 64-разрядное значение, представляющее число 100-наносекундных интервалов, прошедших с 12:00 утра. 1 января 1601 скоординированного всемирного времени (UTC). Система записывает время файла, когда приложения создают файлы, обращаются к ним и записывают их.
ms.assetid: 52d80b82-9ab0-4631-9e70-85df21da4946
title: Время файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5919a2378e08798e4cd64d8f8357cb55692bd22e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913839"
---
# <a name="file-times"></a><span data-ttu-id="e2f32-105">Время файла</span><span class="sxs-lookup"><span data-stu-id="e2f32-105">File Times</span></span>

<span data-ttu-id="e2f32-106">*Время файла* — это 64-разрядное значение, представляющее число 100-наносекундных интервалов, прошедших с 12:00 утра.</span><span class="sxs-lookup"><span data-stu-id="e2f32-106">A *file time* is a 64-bit value that represents the number of 100-nanosecond intervals that have elapsed since 12:00 A.M.</span></span> <span data-ttu-id="e2f32-107">1 января 1601 скоординированного всемирного времени (UTC).</span><span class="sxs-lookup"><span data-stu-id="e2f32-107">January 1, 1601 Coordinated Universal Time (UTC).</span></span> <span data-ttu-id="e2f32-108">Система записывает время файла, когда приложения создают файлы, обращаются к ним и записывают их.</span><span class="sxs-lookup"><span data-stu-id="e2f32-108">The system records file times when applications create, access, and write to files.</span></span>

<span data-ttu-id="e2f32-109">В файловой системе NTFS значения времени хранятся в формате UTC, поэтому изменения в часовом поясе и летнем времени не затрагиваются.</span><span class="sxs-lookup"><span data-stu-id="e2f32-109">The NTFS file system stores time values in UTC format, so they are not affected by changes in time zone or daylight saving time.</span></span> <span data-ttu-id="e2f32-110">Файловая система FAT хранит значения времени на основе местного времени компьютера.</span><span class="sxs-lookup"><span data-stu-id="e2f32-110">The FAT file system stores time values based on the local time of the computer.</span></span> <span data-ttu-id="e2f32-111">Например, файл, сохраненный в 3:12:00 PST в Вашингтоне, отображается как 6:12:00 EST в Нью-Йорке на томе NTFS, но он отображается как 3:12:00 EST в Нью-Йорке на томе FAT.</span><span class="sxs-lookup"><span data-stu-id="e2f32-111">For example, a file that is saved at 3:00pm PST in Washington is seen as 6:00pm EST in New York on an NTFS volume, but it is seen as 3:00pm EST in New York on a FAT volume.</span></span>

<span data-ttu-id="e2f32-112">Метки времени обновляются в различные моменты времени и по различным причинам.</span><span class="sxs-lookup"><span data-stu-id="e2f32-112">Time stamps are updated at various times and for various reasons.</span></span> <span data-ttu-id="e2f32-113">Единственной гарантией метки времени файла является то, что время файла правильно отражается при закрытии маркера, который вносит изменения.</span><span class="sxs-lookup"><span data-stu-id="e2f32-113">The only guarantee about a file time stamp is that the file time is correctly reflected when the handle that makes the change is closed.</span></span>

<span data-ttu-id="e2f32-114">Не все файловые системы могут записывать время создания и последнего доступа, а не все файловые системы записывают их одинаковым образом.</span><span class="sxs-lookup"><span data-stu-id="e2f32-114">Not all file systems can record creation and last access times, and not all file systems record them in the same manner.</span></span> <span data-ttu-id="e2f32-115">Например, разрешение на создание времени в файловой системе FAT составляет 10 миллисекунд, а время записи имеет разрешение в 2 секунды, а время доступа — 1 день, поэтому на самом деле это Дата доступа.</span><span class="sxs-lookup"><span data-stu-id="e2f32-115">For example, the resolution of create time on FAT is 10 milliseconds, while write time has a resolution of 2 seconds and access time has a resolution of 1 day, so it is really the access date.</span></span> <span data-ttu-id="e2f32-116">Файловая система NTFS задерживает обновление времени последнего доступа к файлу до 1 часа после последнего доступа.</span><span class="sxs-lookup"><span data-stu-id="e2f32-116">The NTFS file system delays updates to the last access time for a file by up to 1 hour after the last access.</span></span>

<span data-ttu-id="e2f32-117">Чтобы получить время файла для указанного файла, используйте функцию [**функции getFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-getfiletime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-117">To retrieve the file times for a specified file, use the [**GetFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-getfiletime) function.</span></span> <span data-ttu-id="e2f32-118">**Функции getFileTime** копирует создание, Последний доступ и время последней записи в отдельные структуры [**fileTime**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-118">**GetFileTime** copies the creation, last access, and last write times to individual [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) structures.</span></span> <span data-ttu-id="e2f32-119">Кроме того, можно получить время файла с помощью функций [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) и [**FindNextFile**](/windows/desktop/api/fileapi/nf-fileapi-findnextfilea) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-119">You can also retrieve file times using the [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) and [**FindNextFile**](/windows/desktop/api/fileapi/nf-fileapi-findnextfilea) functions.</span></span> <span data-ttu-id="e2f32-120">Эти функции копируют время файла в структуры **fileTime** в структуре [**данных Win32 \_ Find \_**](/windows/desktop/api/minwinbase/ns-minwinbase-win32_find_dataa) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-120">These functions copy the file times to **FILETIME** structures in a [**WIN32\_FIND\_DATA**](/windows/desktop/api/minwinbase/ns-minwinbase-win32_find_dataa) structure.</span></span> <span data-ttu-id="e2f32-121">При записи в файл последнее время записи не обновляется полностью до тех пор, пока не будут закрыты все дескрипторы, используемые для записи.</span><span class="sxs-lookup"><span data-stu-id="e2f32-121">When writing to a file, the last write time is not fully updated until all handles that are used for writing are closed.</span></span>

<span data-ttu-id="e2f32-122">Чтобы задать время файла для файла, используйте функцию [**сетфилетиме**](/windows/desktop/api/FileAPI/nf-fileapi-setfiletime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-122">To set the file times for a file, use the [**SetFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-setfiletime) function.</span></span> <span data-ttu-id="e2f32-123">Эта функция позволяет изменять время создания, последнего доступа и времени последней записи без изменения содержимого файла.</span><span class="sxs-lookup"><span data-stu-id="e2f32-123">This function lets you modify creation, last access, and last write times without changing the content of the file.</span></span> <span data-ttu-id="e2f32-124">Можно сравнить время различных файлов с помощью функции [**компарефилетиме**](/windows/desktop/api/FileAPI/nf-fileapi-comparefiletime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-124">You can compare the times of different files by using the [**CompareFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-comparefiletime) function.</span></span> <span data-ttu-id="e2f32-125">Функция сравнивает два файловых времени и возвращает значение, указывающее, какое время позже или возвращает 0 (нуль), если значения времени равны.</span><span class="sxs-lookup"><span data-stu-id="e2f32-125">The function compares two file times and returns a value that indicates which time is later or returns 0 (zero) if the times are equal.</span></span>

<span data-ttu-id="e2f32-126">Если планируется изменить время файла для указанных файлов, можно преобразовать дату и время суток в файловый момент с помощью функции [**SystemTimeToFileTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetofiletime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-126">If you plan to modify file times for specified files, you can convert a date and time of day to a file time by using the [**SystemTimeToFileTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetofiletime) function.</span></span> <span data-ttu-id="e2f32-127">Можно также получить системное время в структуре [**fileTime**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , вызвав функцию [**GetSystemTimeAsFileTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsystemtimeasfiletime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-127">You can also obtain the system time in a [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) structure by calling the [**GetSystemTimeAsFileTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsystemtimeasfiletime) function.</span></span>

<span data-ttu-id="e2f32-128">Чтобы упростить отображение времени в файле для пользователя, используйте функцию [**филетиметосистемтиме**](/windows/win32/api/timezoneapi/nf-timezoneapi-filetimetosystemtime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-128">To make a file time easy to display to a user, use the [**FileTimeToSystemTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-filetimetosystemtime) function.</span></span> <span data-ttu-id="e2f32-129">**Филетиметосистемтиме** преобразует время файла и копирует месяц, день, год и время суток из времени файла в структуру [**SYSTEMTIME**](/windows/win32/api/minwinbase/ns-minwinbase-systemtime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-129">**FileTimeToSystemTime** converts the file time and copies the month, day, year, and time of day from the file time to a [**SYSTEMTIME**](/windows/win32/api/minwinbase/ns-minwinbase-systemtime) structure.</span></span>

## <a name="file-times-and-daylight-saving-time"></a><span data-ttu-id="e2f32-130">Время файла и летнее время</span><span class="sxs-lookup"><span data-stu-id="e2f32-130">File Times and Daylight Saving Time</span></span>

<span data-ttu-id="e2f32-131">Необходимо соблюдать осторожность при использовании файлового времени, если пользователь установил автоматическую регулировку перехода на летнее время.</span><span class="sxs-lookup"><span data-stu-id="e2f32-131">You must take care when using file times if the user has set the system to automatically adjust for daylight saving time.</span></span>

<span data-ttu-id="e2f32-132">Чтобы преобразовать время файла в местное время, используйте функцию [**филетиметолокалфилетиме**](/windows/desktop/api/FileAPI/nf-fileapi-filetimetolocalfiletime) .</span><span class="sxs-lookup"><span data-stu-id="e2f32-132">To convert a file time to local time, use the [**FileTimeToLocalFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-filetimetolocalfiletime) function.</span></span> <span data-ttu-id="e2f32-133">Однако **филетиметолокалфилетиме** использует текущие настройки часового пояса и летнего времени.</span><span class="sxs-lookup"><span data-stu-id="e2f32-133">However, **FileTimeToLocalFileTime** uses the current settings for the time zone and daylight saving time.</span></span> <span data-ttu-id="e2f32-134">Таким образом, если это летнее время, оно принимает на себя переход на летнее время, даже если время преобразования файла — стандартное время.</span><span class="sxs-lookup"><span data-stu-id="e2f32-134">Therefore, if it is daylight saving time, it takes daylight saving time into account, even if the file time you are converting is in standard time.</span></span>

<span data-ttu-id="e2f32-135">Файловая система FAT записывает время на диск по местному времени.</span><span class="sxs-lookup"><span data-stu-id="e2f32-135">The FAT file system records times on disk in local time.</span></span> <span data-ttu-id="e2f32-136">[**Функции getFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-getfiletime) извлекает кэшированные значения времени в формате UTC из файловой системы FAT.</span><span class="sxs-lookup"><span data-stu-id="e2f32-136">[**GetFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-getfiletime) retrieves cached UTC times from the FAT file system.</span></span> <span data-ttu-id="e2f32-137">Когда он переходит на летнее время, время, полученное **функции getFileTime** , будет отключено в течение часа, так как кэш не обновляется.</span><span class="sxs-lookup"><span data-stu-id="e2f32-137">When it becomes daylight saving time, the time retrieved by **GetFileTime** is off an hour, because the cache is not updated.</span></span> <span data-ttu-id="e2f32-138">При перезагрузке компьютера в кэшированное время, которое **функции getFileTime** извлекает, верно.</span><span class="sxs-lookup"><span data-stu-id="e2f32-138">When you restart the computer, the cached time that **GetFileTime** retrieves is correct.</span></span> <span data-ttu-id="e2f32-139">[**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) извлекает местное время из файловой системы FAT и преобразует его в формат UTC с использованием текущих параметров часового пояса и летнего времени.</span><span class="sxs-lookup"><span data-stu-id="e2f32-139">[**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) retrieves the local time from the FAT file system and converts it to UTC by using the current settings for the time zone and daylight saving time.</span></span> <span data-ttu-id="e2f32-140">Таким образом, если это летнее время, **FindFirstFile** принимает на себя летнее время, даже если время преобразования файла — стандартное время.</span><span class="sxs-lookup"><span data-stu-id="e2f32-140">Therefore, if it is daylight saving time, **FindFirstFile** takes daylight saving time into account, even if the file time you are converting is in standard time.</span></span>

<span data-ttu-id="e2f32-141">Файловая система NTFS записывает время на диск в формате UTC.</span><span class="sxs-lookup"><span data-stu-id="e2f32-141">The NTFS file system records times on disk in UTC.</span></span> <span data-ttu-id="e2f32-142">Чтобы учитывать переход на летнее время при преобразовании файлового времени в местное время, используйте следующую последовательность функций вместо использования [**филетиметолокалфилетиме**](/windows/desktop/api/FileAPI/nf-fileapi-filetimetolocalfiletime):</span><span class="sxs-lookup"><span data-stu-id="e2f32-142">To account for daylight saving time when converting a file time to a local time, use the following sequence of functions instead of using [**FileTimeToLocalFileTime**](/windows/desktop/api/FileAPI/nf-fileapi-filetimetolocalfiletime):</span></span>

-   [<span data-ttu-id="e2f32-143">**филетиметосистемтиме**</span><span class="sxs-lookup"><span data-stu-id="e2f32-143">**FileTimeToSystemTime**</span></span>](/windows/win32/api/timezoneapi/nf-timezoneapi-filetimetosystemtime)
-   [<span data-ttu-id="e2f32-144">**системтиметотзспеЦификлокалтиме**</span><span class="sxs-lookup"><span data-stu-id="e2f32-144">**SystemTimeToTzSpecificLocalTime**</span></span>](/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetotzspecificlocaltime)
-   [<span data-ttu-id="e2f32-145">**SystemTimeToFileTime**</span><span class="sxs-lookup"><span data-stu-id="e2f32-145">**SystemTimeToFileTime**</span></span>](/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetofiletime)

## <a name="file-times-and-cdfs"></a><span data-ttu-id="e2f32-146">Время файла и CDFS</span><span class="sxs-lookup"><span data-stu-id="e2f32-146">File Times and CDFS</span></span>

<span data-ttu-id="e2f32-147">Метки даты и времени для файлов, расположенных на носителе или исходящих из носителя с использованием файловой системы компакт-диска (CDFS), корректируются для местного часового пояса.</span><span class="sxs-lookup"><span data-stu-id="e2f32-147">The date and time stamps of files that are located on or originate from media using Compact Disc File System (CDFS) are adjusted for the local time zone.</span></span> <span data-ttu-id="e2f32-148">ISO 9660 указывает на то, что CDFS правильно отображает сведения о дате для местного часового пояса.</span><span class="sxs-lookup"><span data-stu-id="e2f32-148">ISO 9660 states that CDFS is to display the date information correctly for the local time zone.</span></span> <span data-ttu-id="e2f32-149">Это делается так, что даты для файлов в CDFS отображаются так же, как и в формате универсального диска (UDF).</span><span class="sxs-lookup"><span data-stu-id="e2f32-149">This is done so that dates for files on CDFS are displayed the same as those on Universal Disk Format (UDF).</span></span> <span data-ttu-id="e2f32-150">UDF — это новый стандарт для дистрибутивного носителя.</span><span class="sxs-lookup"><span data-stu-id="e2f32-150">UDF is the newer standard for distribution media.</span></span> <span data-ttu-id="e2f32-151">Если код зависит от сведений о неизмененной дате для файла, который находится на носителе или исходит из него с помощью CDFS, возможно, он работает неправильно.</span><span class="sxs-lookup"><span data-stu-id="e2f32-151">If your code depends on the unmodified date information for a file that resides on or originates from media using CDFS, it may not function correctly.</span></span>

 

 
