---
description: Служба "Диспетчер классов мультимедиа" (MMCSS) позволяет приложениям мультимедиа гарантировать, что их обработка с учетом времени получает приоритетный доступ к ресурсам ЦП.
ms.assetid: a7169938-1c72-4c4c-881a-cb08ad6182c7
title: Служба планировщика классов мультимедиа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80656276af30495c084d0964534a04e11896bcd2
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "103999894"
---
# <a name="multimedia-class-scheduler-service"></a><span data-ttu-id="aff25-103">Служба планировщика классов мультимедиа</span><span class="sxs-lookup"><span data-stu-id="aff25-103">Multimedia Class Scheduler Service</span></span>

<span data-ttu-id="aff25-104">Служба "Диспетчер классов мультимедиа" (MMCSS) позволяет приложениям мультимедиа гарантировать, что их обработка с учетом времени получает приоритетный доступ к ресурсам ЦП.</span><span class="sxs-lookup"><span data-stu-id="aff25-104">The Multimedia Class Scheduler service (MMCSS) enables multimedia applications to ensure that their time-sensitive processing receives prioritized access to CPU resources.</span></span> <span data-ttu-id="aff25-105">Эта служба позволяет приложениям мультимедиа использовать как можно больше ресурсов ЦП, не отменяя ресурсы ЦП более низким приоритетным приложениям.</span><span class="sxs-lookup"><span data-stu-id="aff25-105">This service enables multimedia applications to utilize as much of the CPU as possible without denying CPU resources to lower-priority applications.</span></span>

<span data-ttu-id="aff25-106">Служба MMCSS использует сведения, хранящиеся в реестре, для определения поддерживаемых задач и определения относительных приоритетов потоков, выполняющих эти задачи.</span><span class="sxs-lookup"><span data-stu-id="aff25-106">MMCSS uses information stored in the registry to identify supported tasks and determine the relative priority of threads performing these tasks.</span></span> <span data-ttu-id="aff25-107">Каждый поток, выполняющий работу, связанный с определенной задачей, вызывает функцию [**авсетмммакссреадчарактеристикс**](/windows/desktop/api/Avrt/nf-avrt-avsetmmmaxthreadcharacteristicsa) или [**авсетммсреадчарактеристикс**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadcharacteristicsa) для информирования MMCSS о том, что он работает над этой задачей.</span><span class="sxs-lookup"><span data-stu-id="aff25-107">Each thread that is performing work related to a particular task calls the [**AvSetMmMaxThreadCharacteristics**](/windows/desktop/api/Avrt/nf-avrt-avsetmmmaxthreadcharacteristicsa) or [**AvSetMmThreadCharacteristics**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadcharacteristicsa) function to inform MMCSS that it is working on that task.</span></span>

<span data-ttu-id="aff25-108">Пример программы, использующей MMCSS, см. в разделе [потоки с монопольным режимом](/previous-versions//bb614507(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="aff25-108">For an example of a program that uses MMCSS, see [Exclusive-Mode Streams](/previous-versions//bb614507(v=vs.85)).</span></span>

<span data-ttu-id="aff25-109">**Windows Server 2003 и Windows XP:** Служба MMCSS недоступна.</span><span class="sxs-lookup"><span data-stu-id="aff25-109">**Windows Server 2003 and Windows XP:** MMCSS is not available.</span></span>

## <a name="registry-settings"></a><span data-ttu-id="aff25-110">Параметры реестра</span><span class="sxs-lookup"><span data-stu-id="aff25-110">Registry Settings</span></span>

<span data-ttu-id="aff25-111">Параметры MMCSS хранятся в следующем разделе реестра:</span><span class="sxs-lookup"><span data-stu-id="aff25-111">The MMCSS settings are stored in the following registry key:</span></span>

<span data-ttu-id="aff25-112">**HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows NT \\ CurrentVersion \\ мультимедиа \\ SystemProfile**</span><span class="sxs-lookup"><span data-stu-id="aff25-112">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile**</span></span>

<span data-ttu-id="aff25-113">Этот раздел содержит значение **reg \_ DWORD** с именем **системреспонсивенесс** , которое определяет процент ресурсов ЦП, которые должны быть гарантированы задачами с низким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="aff25-113">This key contains a **REG\_DWORD** value named **SystemResponsiveness** that determines the percentage of CPU resources that should be guaranteed to low-priority tasks.</span></span> <span data-ttu-id="aff25-114">Например, если это значение равно 20, то 20% ресурсов ЦП зарезервированы для задач с низким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="aff25-114">For example, if this value is 20, then 20% of CPU resources are reserved for low-priority tasks.</span></span> <span data-ttu-id="aff25-115">Обратите внимание, что значения, которые не делятся на 10, округляются до ближайшего числа, кратного 10.</span><span class="sxs-lookup"><span data-stu-id="aff25-115">Note that values that are not evenly divisible by 10 are rounded up to the nearest multiple of 10.</span></span> <span data-ttu-id="aff25-116">Значение 0 также обрабатывается как 10.</span><span class="sxs-lookup"><span data-stu-id="aff25-116">A value of 0 is also treated as 10.</span></span>

<span data-ttu-id="aff25-117">Ключ также содержит подраздел с именем **tasks** , содержащий список задач.</span><span class="sxs-lookup"><span data-stu-id="aff25-117">The key also contains a subkey named **Tasks** that contains the list of tasks.</span></span> <span data-ttu-id="aff25-118">По умолчанию Windows поддерживает следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="aff25-118">By default, Windows supports the following tasks:</span></span>

-   <span data-ttu-id="aff25-119">**Аудиосигнал**</span><span class="sxs-lookup"><span data-stu-id="aff25-119">**Audio**</span></span>
-   <span data-ttu-id="aff25-120">**возможность использования функции записи**.</span><span class="sxs-lookup"><span data-stu-id="aff25-120">**Capture**</span></span>
-   <span data-ttu-id="aff25-121">**Distribution**</span><span class="sxs-lookup"><span data-stu-id="aff25-121">**Distribution**</span></span>
-   <span data-ttu-id="aff25-122">**Игры**</span><span class="sxs-lookup"><span data-stu-id="aff25-122">**Games**</span></span>
-   <span data-ttu-id="aff25-123">**Воспроизведение**</span><span class="sxs-lookup"><span data-stu-id="aff25-123">**Playback**</span></span>
-   <span data-ttu-id="aff25-124">**Звук Pro**</span><span class="sxs-lookup"><span data-stu-id="aff25-124">**Pro Audio**</span></span>
-   <span data-ttu-id="aff25-125">**Диспетчер окон**</span><span class="sxs-lookup"><span data-stu-id="aff25-125">**Window Manager**</span></span>

<span data-ttu-id="aff25-126">Изготовители оборудования могут добавлять дополнительные задачи по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="aff25-126">OEMs can add additional tasks as required.</span></span>

<span data-ttu-id="aff25-127">Каждый ключ задачи содержит следующий набор значений, которые представляют характеристики, применяемые к потокам, связанным с задачей.</span><span class="sxs-lookup"><span data-stu-id="aff25-127">Each task key contains the following set of values that represent characteristics to be applied to threads that are associated with the task.</span></span>

| <span data-ttu-id="aff25-128">Значение</span><span class="sxs-lookup"><span data-stu-id="aff25-128">Value</span></span>                   | <span data-ttu-id="aff25-129">Формат</span><span class="sxs-lookup"><span data-stu-id="aff25-129">Format</span></span>         | <span data-ttu-id="aff25-130">Возможные значения</span><span class="sxs-lookup"><span data-stu-id="aff25-130">Possible values</span></span>                                                                                                                                                                                                                                                                                                                                                         |
|-------------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="aff25-131">**Родств**</span><span class="sxs-lookup"><span data-stu-id="aff25-131">**Affinity**</span></span>            | <span data-ttu-id="aff25-132">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="aff25-132">**REG\_DWORD**</span></span> | <span data-ttu-id="aff25-133">Битовая маска, указывающая соответствие процессора.</span><span class="sxs-lookup"><span data-stu-id="aff25-133">A bitmask that indicates the processor affinity.</span></span> <span data-ttu-id="aff25-134">Значения 0x00 и 0xFFFFFFFF указывают, что сходство процессоров не используется.</span><span class="sxs-lookup"><span data-stu-id="aff25-134">Both 0x00 and 0xFFFFFFFF indicate that processor affinity is not used.</span></span>                                                                                                                                                                                                                                                 |
| <span data-ttu-id="aff25-135">**Только фон**</span><span class="sxs-lookup"><span data-stu-id="aff25-135">**Background Only**</span></span>     | <span data-ttu-id="aff25-136">**REG \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="aff25-136">**REG\_SZ**</span></span>    | <span data-ttu-id="aff25-137">Указывает, является ли это фоновой задачей (без пользовательского интерфейса).</span><span class="sxs-lookup"><span data-stu-id="aff25-137">Indicates whether this is a background task (no user interface).</span></span> <span data-ttu-id="aff25-138">Потоки фоновой задачи не изменяются из-за изменения фокуса окна.</span><span class="sxs-lookup"><span data-stu-id="aff25-138">The threads of a background task do not change because of a change in window focus.</span></span> <span data-ttu-id="aff25-139">Этому значению можно присвоить значение true или false.</span><span class="sxs-lookup"><span data-stu-id="aff25-139">This value can be set to True or False.</span></span>                                                                                                                                                                            |
| <span data-ttu-id="aff25-140">**баккграундприорити**</span><span class="sxs-lookup"><span data-stu-id="aff25-140">**BackgroundPriority**</span></span>  | <span data-ttu-id="aff25-141">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="aff25-141">**REG\_DWORD**</span></span> | <span data-ttu-id="aff25-142">Приоритет фона.</span><span class="sxs-lookup"><span data-stu-id="aff25-142">The background priority.</span></span> <span data-ttu-id="aff25-143">Диапазон значений — 1-8.</span><span class="sxs-lookup"><span data-stu-id="aff25-143">The range of values is 1-8.</span></span>                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="aff25-144">**Частота синхронизации**</span><span class="sxs-lookup"><span data-stu-id="aff25-144">**Clock Rate**</span></span>          | <span data-ttu-id="aff25-145">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="aff25-145">**REG\_DWORD**</span></span> | <span data-ttu-id="aff25-146">Подсказка, используемая службой MMCSS для определения степени детализации планирования ресурсов процессора. **Windows Server 2008 и Windows Vista:** Максимальная гарантированная частота часов, используемая системой, если поток присоединяется к этой задаче, в интервалах 100 нс.</span><span class="sxs-lookup"><span data-stu-id="aff25-146">A hint used by MMCSS to determine the granularity of processor resource scheduling.**Windows Server 2008 and Windows Vista:** The maximum guaranteed clock rate the system uses if a thread joins this task, in 100-nanosecond intervals.</span></span> <span data-ttu-id="aff25-147">Начиная с Windows 7 и Windows Server 2008 R2 эта гарантия была удалена, чтобы сократить энергопотребление системы.</span><span class="sxs-lookup"><span data-stu-id="aff25-147">Starting with Windows 7 and Windows Server 2008 R2, this guarantee was removed to reduce system power consumption.</span></span><br/> |
| <span data-ttu-id="aff25-148">**Приоритет GPU**</span><span class="sxs-lookup"><span data-stu-id="aff25-148">**GPU Priority**</span></span>        | <span data-ttu-id="aff25-149">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="aff25-149">**REG\_DWORD**</span></span> | <span data-ttu-id="aff25-150">Приоритет GPU.</span><span class="sxs-lookup"><span data-stu-id="aff25-150">The GPU priority.</span></span> <span data-ttu-id="aff25-151">Диапазон значений — 0-31.</span><span class="sxs-lookup"><span data-stu-id="aff25-151">The range of values is 0-31.</span></span> <span data-ttu-id="aff25-152">Этот приоритет еще не используется.</span><span class="sxs-lookup"><span data-stu-id="aff25-152">This priority is not yet used.</span></span>                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="aff25-153">**Приоритет**</span><span class="sxs-lookup"><span data-stu-id="aff25-153">**Priority**</span></span>            | <span data-ttu-id="aff25-154">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="aff25-154">**REG\_DWORD**</span></span> | <span data-ttu-id="aff25-155">Приоритет задачи.</span><span class="sxs-lookup"><span data-stu-id="aff25-155">The task priority.</span></span> <span data-ttu-id="aff25-156">Диапазон значений — от 1 (низкий) до 8 (высокий). Для задач с **категорией** с высоким приоритетом это значение всегда обрабатывается как 2.</span><span class="sxs-lookup"><span data-stu-id="aff25-156">The range of values is 1 (low) to 8 (high).For tasks with a **Scheduling Category** of High, this value is always treated as 2.</span></span><br/>                                                                                                                                                                                                           |
| <span data-ttu-id="aff25-157">**Категория планирования**</span><span class="sxs-lookup"><span data-stu-id="aff25-157">**Scheduling Category**</span></span> | <span data-ttu-id="aff25-158">**REG \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="aff25-158">**REG\_SZ**</span></span>    | <span data-ttu-id="aff25-159">Категория планирования.</span><span class="sxs-lookup"><span data-stu-id="aff25-159">The scheduling category.</span></span> <span data-ttu-id="aff25-160">Для этого параметра можно задать значение высокий, средний или низкий.</span><span class="sxs-lookup"><span data-stu-id="aff25-160">This value can be set to High, Medium, or Low.</span></span>                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="aff25-161">**Приоритет СФИО**</span><span class="sxs-lookup"><span data-stu-id="aff25-161">**SFIO Priority**</span></span>       | <span data-ttu-id="aff25-162">**REG \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="aff25-162">**REG\_SZ**</span></span>    | <span data-ttu-id="aff25-163">Запланированный приоритет ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="aff25-163">The scheduled I/O priority.</span></span> <span data-ttu-id="aff25-164">Это значение можно установить в режим простоя, низкий, нормальный или высокий.</span><span class="sxs-lookup"><span data-stu-id="aff25-164">This value can be set to Idle, Low, Normal, or High.</span></span> <span data-ttu-id="aff25-165">Это значение не используется.</span><span class="sxs-lookup"><span data-stu-id="aff25-165">This value is not used.</span></span>                                                                                                                                                                                                                                                                |



 

> [!Note]  
> <span data-ttu-id="aff25-166">Для экономии энергии приложения не должны задавать небольшое значение для разрешения системного таймера, если это не является абсолютно необходимым.</span><span class="sxs-lookup"><span data-stu-id="aff25-166">To conserve power, applications should not set the resolution of the system-wide timer to a small value unless absolutely necessary.</span></span> <span data-ttu-id="aff25-167">Дополнительные сведения см. в статье [производительность](../win7devguide/performance.md) для [разработчиков Windows 7](../win7devguide/windows-7-developer-guide.md).</span><span class="sxs-lookup"><span data-stu-id="aff25-167">For more information, see [Performance](../win7devguide/performance.md) in the [Windows 7 Developers Guide](../win7devguide/windows-7-developer-guide.md).</span></span>

 

## <a name="thread-priorities"></a><span data-ttu-id="aff25-168">Приоритеты потоков</span><span class="sxs-lookup"><span data-stu-id="aff25-168">Thread Priorities</span></span>

<span data-ttu-id="aff25-169">Служба MMCSS повышает приоритет потоков, работающих над задачами мультимедиа с высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="aff25-169">The MMCSS boosts the priority of threads that are working on high-priority multimedia tasks.</span></span>

<span data-ttu-id="aff25-170">Служба MMCSS определяет приоритет потока, используя следующие факторы:</span><span class="sxs-lookup"><span data-stu-id="aff25-170">MMCSS determines the priority of a thread using the following factors:</span></span>

-   <span data-ttu-id="aff25-171">Базовый приоритет задачи.</span><span class="sxs-lookup"><span data-stu-id="aff25-171">The base priority of the task.</span></span>
-   <span data-ttu-id="aff25-172">Параметр *Priority* функции [**авсетммсреадприорити**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadpriority) .</span><span class="sxs-lookup"><span data-stu-id="aff25-172">The *Priority* parameter of the [**AvSetMmThreadPriority**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadpriority) function.</span></span>
-   <span data-ttu-id="aff25-173">Находится ли приложение на переднем плане.</span><span class="sxs-lookup"><span data-stu-id="aff25-173">Whether the application is in the foreground.</span></span>
-   <span data-ttu-id="aff25-174">Объем времени ЦП, потребляемый потоками в каждой категории.</span><span class="sxs-lookup"><span data-stu-id="aff25-174">How much CPU time is being consumed by the threads in each category.</span></span>

<span data-ttu-id="aff25-175">Служба MMCSS устанавливает приоритет клиентских потоков в зависимости от категории их планирования.</span><span class="sxs-lookup"><span data-stu-id="aff25-175">MMCSS sets the priority of client threads depending on their scheduling category.</span></span>

| <span data-ttu-id="aff25-176">Категория</span><span class="sxs-lookup"><span data-stu-id="aff25-176">Category</span></span> | <span data-ttu-id="aff25-177">Приоритет</span><span class="sxs-lookup"><span data-stu-id="aff25-177">Priority</span></span> | <span data-ttu-id="aff25-178">Описание</span><span class="sxs-lookup"><span data-stu-id="aff25-178">Description</span></span>                                                                                                                               |
|----------|----------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="aff25-179">Высокий</span><span class="sxs-lookup"><span data-stu-id="aff25-179">High</span></span>     | <span data-ttu-id="aff25-180">23-26</span><span class="sxs-lookup"><span data-stu-id="aff25-180">23-26</span></span>    | <span data-ttu-id="aff25-181">Эти потоки выполняются с приоритетом потока, который меньше, чем определенные задачи на уровне системы.</span><span class="sxs-lookup"><span data-stu-id="aff25-181">These threads run at a thread priority that is lower than only certain system-level tasks.</span></span> <span data-ttu-id="aff25-182">Эта категория предназначена для задач профессиональной аудио.</span><span class="sxs-lookup"><span data-stu-id="aff25-182">This category is designed for Pro Audio tasks.</span></span> |
| <span data-ttu-id="aff25-183">Средний</span><span class="sxs-lookup"><span data-stu-id="aff25-183">Medium</span></span>   | <span data-ttu-id="aff25-184">16-22</span><span class="sxs-lookup"><span data-stu-id="aff25-184">16-22</span></span>    | <span data-ttu-id="aff25-185">Эти потоки являются частью приложения, расположенного на переднем плане.</span><span class="sxs-lookup"><span data-stu-id="aff25-185">These threads are part of the application that is in the foreground.</span></span>                                                                      |
| <span data-ttu-id="aff25-186">Низкий</span><span class="sxs-lookup"><span data-stu-id="aff25-186">Low</span></span>      | <span data-ttu-id="aff25-187">8-15</span><span class="sxs-lookup"><span data-stu-id="aff25-187">8-15</span></span>     | <span data-ttu-id="aff25-188">Эта категория содержит оставшуюся часть потоков.</span><span class="sxs-lookup"><span data-stu-id="aff25-188">This category contains the remainder of the threads.</span></span> <span data-ttu-id="aff25-189">При необходимости они гарантированно задают минимальный процент ресурсов ЦП.</span><span class="sxs-lookup"><span data-stu-id="aff25-189">They are guaranteed a minimum percentage of the CPU resources if required.</span></span>           |
|          | <span data-ttu-id="aff25-190">1-7</span><span class="sxs-lookup"><span data-stu-id="aff25-190">1-7</span></span>      | <span data-ttu-id="aff25-191">Эти потоки используют квоту ресурсов ЦП.</span><span class="sxs-lookup"><span data-stu-id="aff25-191">These threads have used their quota of CPU resource.</span></span> <span data-ttu-id="aff25-192">Они могут продолжать работу, если потоки с низким приоритетом не готовы к выполнению.</span><span class="sxs-lookup"><span data-stu-id="aff25-192">They can continue to run if no low-priority threads are ready to run.</span></span>                |



 

 

 
