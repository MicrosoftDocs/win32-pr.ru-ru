---
description: 'Компьютеры с несколькими процессорами обычно разрабатываются для одной из двух архитектур: неоднородный доступ к памяти (NUMA) или симметричная многопроцессорная обработка (SMP).'
ms.assetid: 3c9186c8-a54d-4536-8237-bfff78cc7d11
title: Несколько процессоров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0093404a0df653a153823915f1ac72b5e41d50c0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673763"
---
# <a name="multiple-processors"></a>Несколько процессоров

Компьютеры с несколькими процессорами обычно разрабатываются для одной из двух архитектур: неоднородный доступ к памяти (NUMA) или симметричная многопроцессорная обработка (SMP).

На компьютере NUMA каждый процессор находится ближе к некоторым частям памяти, чем другие, что позволяет ускорить доступ к памяти для некоторых частей памяти, чем другие части. В модели NUMA система пытается запланировать потоки на процессоры, близкие к используемой памяти. Дополнительные сведения о NUMA см. в разделе [Поддержка NUMA](numa-support.md).

На компьютере SMP два или более идентичных процессоров или ядер подключаются к одной общей основной памяти. В модели SMP любой поток может быть назначен любому процессору. Поэтому планирование потоков на компьютере SMP аналогично планированию потоков на компьютере с одним процессором. Однако планировщик имеет пул процессоров, что позволяет планировать параллельное выполнение потоков. Планирование по-прежнему определяется приоритетом потоков, но на него можно повлиять, установив сходство потоков и идеальный процессор для потоков, как описано в этом разделе.

## <a name="thread-affinity"></a>Сходство потоков

*Сходство потоков* заставляет поток выполняться на определенном подмножестве процессоров. Обычно следует избегать установки сходства потоков, так как это может помешать планировщику эффективно планировать потоки между процессорами. Это может снизить производительность, вызванную параллельной обработкой. Правильное использование сходства потоков — тестирование каждого процессора.

Система представляет сходство с битовой маской, называемой маской сходства процессоров. Маска сходства — это размер максимального числа процессоров в системе, для которых задано значение BITS для распознавания подмножества процессоров. Изначально система определяет подмножество процессоров в маске.

Можно получить текущее сходство потоков для всех потоков процесса, вызвав функцию [**жетпроцессаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-getprocessaffinitymask) . Используйте функцию [**сетпроцессаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-setprocessaffinitymask) , чтобы указать сходство потоков для всех потоков процесса. Чтобы задать сходство потоков для одного потока, используйте функцию [**сетсреадаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-setthreadaffinitymask) . Сходство потоков должно быть подмножеством сходства процесса.

В системах с более чем 64 процессорами маска сходства изначально представляет процессоры в одной группе процессоров. Однако сходство потоков можно задать для процессора в другой группе, которая изменяет маску сходства для процесса. Дополнительные сведения см. в разделе [группы процессоров](processor-groups.md).

## <a name="thread-ideal-processor"></a>Идеальный для потоков процессор

При указании *идеального обработчика потока* планировщик по возможности запускает поток на указанном процессоре. Используйте функцию [**сетсреадидеалпроцессор**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadidealprocessor) , чтобы указать предпочтительный процессор для потока. Это не гарантирует, что идеальный процессор будет выбран, но вы получите полезное указание планировщику. В системах с более чем 64 процессорами можно использовать функцию [**сетсреадидеалпроцессорекс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadidealprocessorex) для указания предпочтительного процессора в определенной группе процессоров.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Поддержка NUMA](numa-support.md)
</dt> <dt>

[Группы процессоров](processor-groups.md)
</dt> </dl>

 

 
