---
description: Рекомендуемое правило — использовать как можно меньше потоков, тем самым уменьшая использование системных ресурсов.
ms.assetid: ed9bd3cf-b10c-49f9-bf62-7332517350b7
title: Рекомендации по многозадачности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ec64bf1b7d59a42a1aec3511a72328f18bfaa88
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156515"
---
# <a name="multitasking-considerations"></a><span data-ttu-id="b4b80-103">Рекомендации по многозадачности</span><span class="sxs-lookup"><span data-stu-id="b4b80-103">Multitasking Considerations</span></span>

<span data-ttu-id="b4b80-104">Рекомендуемое правило — использовать как можно меньше потоков, тем самым уменьшая использование системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b4b80-104">The recommended guideline is to use as few threads as possible, thereby minimizing the use of system resources.</span></span> <span data-ttu-id="b4b80-105">Это повышает производительность.</span><span class="sxs-lookup"><span data-stu-id="b4b80-105">This improves performance.</span></span> <span data-ttu-id="b4b80-106">При разработке приложения для многозадачности необходимо учитывать требования к ресурсам и потенциальные конфликты.</span><span class="sxs-lookup"><span data-stu-id="b4b80-106">Multitasking has resource requirements and potential conflicts to be considered when designing your application.</span></span> <span data-ttu-id="b4b80-107">Действуют следующие требования к ресурсам:</span><span class="sxs-lookup"><span data-stu-id="b4b80-107">The resource requirements are as follows:</span></span>

-   <span data-ttu-id="b4b80-108">Система потребляет память для контекстных данных, необходимых как для процессов, так и для потоков.</span><span class="sxs-lookup"><span data-stu-id="b4b80-108">The system consumes memory for the context information required by both processes and threads.</span></span> <span data-ttu-id="b4b80-109">Таким образом, количество процессов и потоков, которые могут быть созданы, ограничено доступной памятью.</span><span class="sxs-lookup"><span data-stu-id="b4b80-109">Therefore, the number of processes and threads that can be created is limited by available memory.</span></span>
-   <span data-ttu-id="b4b80-110">Для отслеживания работы большого числа потоков требуется много процессорного времени.</span><span class="sxs-lookup"><span data-stu-id="b4b80-110">Keeping track of a large number of threads consumes significant processor time.</span></span> <span data-ttu-id="b4b80-111">Если количество потоков слишком велико, большинство из них не сможет выполнить значительный ход выполнения.</span><span class="sxs-lookup"><span data-stu-id="b4b80-111">If there are too many threads, most of them will not be able to make significant progress.</span></span> <span data-ttu-id="b4b80-112">Если большинство потоков относятся к одному процессу, потоки других процессов назначаются для выполнения реже.</span><span class="sxs-lookup"><span data-stu-id="b4b80-112">If most of the current threads are in one process, threads in other processes are scheduled less frequently.</span></span>

<span data-ttu-id="b4b80-113">Предоставление общего доступа к ресурсам может приводить к конфликтам.</span><span class="sxs-lookup"><span data-stu-id="b4b80-113">Providing shared access to resources can create conflicts.</span></span> <span data-ttu-id="b4b80-114">Чтобы избежать их появления, необходимо синхронизировать доступ к общим ресурсам.</span><span class="sxs-lookup"><span data-stu-id="b4b80-114">To avoid them, you must synchronize access to shared resources.</span></span> <span data-ttu-id="b4b80-115">Это справедливо для системных ресурсов (например, портов связи), ресурсов, совместно используемых несколькими процессами (например, дескрипторов файлов), или ресурсов одного процесса (например, глобальных переменных), к которым обращаются несколько потоков.</span><span class="sxs-lookup"><span data-stu-id="b4b80-115">This is true for system resources (such as communications ports), resources shared by multiple processes (such as file handles), or the resources of a single process (such as global variables) accessed by multiple threads.</span></span> <span data-ttu-id="b4b80-116">Неправильное выполнение синхронизации доступа (в том же или в разных процессах) может привести к проблемам, таким как взаимоблокировка и конкуренция.</span><span class="sxs-lookup"><span data-stu-id="b4b80-116">Failure to synchronize access properly (in the same or in different processes) can lead to problems such as deadlock and race conditions.</span></span> <span data-ttu-id="b4b80-117">Объекты и функции синхронизации, которые можно использовать для координации совместного использования ресурсов несколькими потоками.</span><span class="sxs-lookup"><span data-stu-id="b4b80-117">The synchronization objects and functions you can use to coordinate resource sharing among multiple threads.</span></span> <span data-ttu-id="b4b80-118">Дополнительные сведения о синхронизации см. в разделе [Синхронизация выполнения нескольких потоков](synchronizing-execution-of-multiple-threads.md).</span><span class="sxs-lookup"><span data-stu-id="b4b80-118">For more information about synchronization, see [Synchronizing Execution of Multiple Threads](synchronizing-execution-of-multiple-threads.md).</span></span> <span data-ttu-id="b4b80-119">Уменьшение числа потоков упрощает и повышает эффективность синхронизации ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b4b80-119">Reducing the number of threads makes it easier and more effective to synchronize resources.</span></span>

<span data-ttu-id="b4b80-120">Хорошим проектированием многопоточного приложения является сервер конвейера.</span><span class="sxs-lookup"><span data-stu-id="b4b80-120">A good design for a multithreaded application is the pipeline server.</span></span> <span data-ttu-id="b4b80-121">В этой структуре создается один поток для каждого процессора и создаются очереди запросов, для которых приложение хранит сведения о контексте.</span><span class="sxs-lookup"><span data-stu-id="b4b80-121">In this design, you create one thread per processor and build queues of requests for which the application maintains the context information.</span></span> <span data-ttu-id="b4b80-122">Поток будет обрабатывать все запросы в очереди перед обработкой запросов в следующей очереди.</span><span class="sxs-lookup"><span data-stu-id="b4b80-122">A thread would process all requests in a queue before processing requests in the next queue.</span></span>

 

 



