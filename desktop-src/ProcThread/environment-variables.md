---
description: 'Каждый процесс имеет блок среды, содержащий набор переменных среды и их значений. Существует два типа переменных среды: пользовательские переменные среды (устанавливаются для каждого пользователя) и системные переменные среды (задаются для всех).'
ms.assetid: 6732b12f-ced1-4769-b947-79da8fd2237a
title: Переменные среды
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f50226d12286d01c77025d1cc38e33e2778392a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673768"
---
# <a name="environment-variables"></a><span data-ttu-id="a4e13-104">Переменные среды</span><span class="sxs-lookup"><span data-stu-id="a4e13-104">Environment Variables</span></span>

<span data-ttu-id="a4e13-105">Каждый процесс имеет блок среды, содержащий набор переменных среды и их значений.</span><span class="sxs-lookup"><span data-stu-id="a4e13-105">Every process has an environment block that contains a set of environment variables and their values.</span></span> <span data-ttu-id="a4e13-106">Существует два типа переменных среды: пользовательские переменные среды (устанавливаются для каждого пользователя) и системные переменные среды (задаются для всех).</span><span class="sxs-lookup"><span data-stu-id="a4e13-106">There are two types of environment variables: user environment variables (set for each user) and system environment variables (set for everyone).</span></span>

<span data-ttu-id="a4e13-107">По умолчанию дочерний процесс наследует переменные среды своего родительского процесса.</span><span class="sxs-lookup"><span data-stu-id="a4e13-107">By default, a child process inherits the environment variables of its parent process.</span></span> <span data-ttu-id="a4e13-108">Программы, запущенные процессором командной строки, наследуют переменные среды обработчика команд.</span><span class="sxs-lookup"><span data-stu-id="a4e13-108">Programs started by the command processor inherit the command processor's environment variables.</span></span> <span data-ttu-id="a4e13-109">Чтобы указать другую среду для дочернего процесса, создайте новый блок среды и передайте указатель на него в качестве параметра функции [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="a4e13-109">To specify a different environment for a child process, create a new environment block and pass a pointer to it as a parameter to the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span>

<span data-ttu-id="a4e13-110">Обработчик команд предоставляет команду **Set** для вывода его блока среды или для создания новых переменных среды.</span><span class="sxs-lookup"><span data-stu-id="a4e13-110">The command processor provides the **set** command to display its environment block or to create new environment variables.</span></span> <span data-ttu-id="a4e13-111">Можно также просмотреть или изменить переменные среды, выбрав пункт **система** в **панели управления**, выбрав **Дополнительные параметры системы** и щелкнув **переменные среды**.</span><span class="sxs-lookup"><span data-stu-id="a4e13-111">You can also view or modify the environment variables by selecting **System** from the **Control Panel**, selecting **Advanced system settings**, and clicking **Environment Variables**.</span></span>

<span data-ttu-id="a4e13-112">Каждый блок среды содержит переменные среды в следующем формате:</span><span class="sxs-lookup"><span data-stu-id="a4e13-112">Each environment block contains the environment variables in the following format:</span></span><dl> <span data-ttu-id="a4e13-113">*Var1* = *Значение1* \\ 0,0</span><span class="sxs-lookup"><span data-stu-id="a4e13-113">*Var1*=*Value1*\\0</span></span>  
<span data-ttu-id="a4e13-114">*Var2* = *Значение2* \\ 0,0</span><span class="sxs-lookup"><span data-stu-id="a4e13-114">*Var2*=*Value2*\\0</span></span>  
<span data-ttu-id="a4e13-115">*Var3* = *Значение3* \\ 0,0</span><span class="sxs-lookup"><span data-stu-id="a4e13-115">*Var3*=*Value3*\\0</span></span>  
<span data-ttu-id="a4e13-116">...</span><span class="sxs-lookup"><span data-stu-id="a4e13-116">...</span></span>  
<span data-ttu-id="a4e13-117">*Варн* = *Контрольное* \\ 0 \\ 0</span><span class="sxs-lookup"><span data-stu-id="a4e13-117">*VarN*=*ValueN*\\0\\0</span></span>  
</dl>

<span data-ttu-id="a4e13-118">Имя переменной среды не может содержать знак равенства (=).</span><span class="sxs-lookup"><span data-stu-id="a4e13-118">The name of an environment variable cannot include an equal sign (=).</span></span>

<span data-ttu-id="a4e13-119">Функция [**жетенвиронментстрингс**](/windows/win32/api/processenv/nf-processenv-getenvironmentstrings) возвращает указатель на блок среды вызывающего процесса.</span><span class="sxs-lookup"><span data-stu-id="a4e13-119">The [**GetEnvironmentStrings**](/windows/win32/api/processenv/nf-processenv-getenvironmentstrings) function returns a pointer to the environment block of the calling process.</span></span> <span data-ttu-id="a4e13-120">Он должен рассматриваться как блок только для чтения. не изменяйте его напрямую.</span><span class="sxs-lookup"><span data-stu-id="a4e13-120">This should be treated as a read-only block; do not modify it directly.</span></span> <span data-ttu-id="a4e13-121">Вместо этого используйте функцию [**SetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-setenvironmentvariable) для изменения переменной среды.</span><span class="sxs-lookup"><span data-stu-id="a4e13-121">Instead, use the [**SetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-setenvironmentvariable) function to change an environment variable.</span></span> <span data-ttu-id="a4e13-122">По завершении работы с блоком среды, полученным из **жетенвиронментстрингс**, вызовите функцию [**фриенвиронментстрингс**](/windows/win32/api/processenv/nf-processenv-freeenvironmentstringsa) , чтобы освободить блок.</span><span class="sxs-lookup"><span data-stu-id="a4e13-122">When you are finished with the environment block obtained from **GetEnvironmentStrings**, call the [**FreeEnvironmentStrings**](/windows/win32/api/processenv/nf-processenv-freeenvironmentstringsa) function to free the block.</span></span>

<span data-ttu-id="a4e13-123">Вызов [**SetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-setenvironmentvariable) не влияет на системные переменные среды.</span><span class="sxs-lookup"><span data-stu-id="a4e13-123">Calling [**SetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-setenvironmentvariable) has no effect on the system environment variables.</span></span> <span data-ttu-id="a4e13-124">Чтобы программным путем добавить или изменить системные переменные среды, добавьте их в раздел реестра **\_ \_ \\ \\ \\ \\ \\ окружения CurrentControlSet Control System диспетчера сеансов** , а затем выполните широковещательную рассылку сообщения [**WM \_ сеттингчанже**](/windows/desktop/winmsg/wm-settingchange) с параметром *lParam* в строку "среда".</span><span class="sxs-lookup"><span data-stu-id="a4e13-124">To programmatically add or modify system environment variables, add them to the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Environment** registry key, then broadcast a [**WM\_SETTINGCHANGE**](/windows/desktop/winmsg/wm-settingchange) message with *lParam* set to the string "Environment".</span></span> <span data-ttu-id="a4e13-125">Это позволяет приложениям, например оболочке, принимать обновления.</span><span class="sxs-lookup"><span data-stu-id="a4e13-125">This allows applications, such as the shell, to pick up your updates.</span></span>

<span data-ttu-id="a4e13-126">Максимальный размер определяемой пользователем переменной среды — 32 767 символов.</span><span class="sxs-lookup"><span data-stu-id="a4e13-126">The maximum size of a user-defined environment variable is 32,767 characters.</span></span> <span data-ttu-id="a4e13-127">Нет технического ограничения на размер блока среды.</span><span class="sxs-lookup"><span data-stu-id="a4e13-127">There is no technical limitation on the size of the environment block.</span></span> <span data-ttu-id="a4e13-128">Однако существуют практические ограничения в зависимости от механизма, используемого для доступа к блоку.</span><span class="sxs-lookup"><span data-stu-id="a4e13-128">However, there are practical limits depending on the mechanism used to access the block.</span></span> <span data-ttu-id="a4e13-129">Например, пакетный файл не может установить переменную, длина которой превышает максимальную длину командной строки.</span><span class="sxs-lookup"><span data-stu-id="a4e13-129">For example, a batch file cannot set a variable that is longer than the maximum command line length.</span></span>

<span data-ttu-id="a4e13-130">**Windows Server 2003 и Windows XP:** Максимальный размер блока среды для процесса составляет 32 767 символов.</span><span class="sxs-lookup"><span data-stu-id="a4e13-130">**Windows Server 2003 and Windows XP:** The maximum size of the environment block for the process is 32,767 characters.</span></span> <span data-ttu-id="a4e13-131">Начиная с Windows Vista и Windows Server 2008, нет технического ограничения на размер блока среды.</span><span class="sxs-lookup"><span data-stu-id="a4e13-131">Starting with Windows Vista and Windows Server 2008, there is no technical limitation on the size of the environment block.</span></span>

<span data-ttu-id="a4e13-132">Функция [**GetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-getenvironmentvariable) определяет, определена ли указанная переменная в среде вызывающего процесса, и, если да, то что ее значение равно.</span><span class="sxs-lookup"><span data-stu-id="a4e13-132">The [**GetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-getenvironmentvariable) function determines whether a specified variable is defined in the environment of the calling process, and, if so, what its value is.</span></span>

<span data-ttu-id="a4e13-133">Чтобы получить копию блока среды для данного пользователя, используйте функцию [**креатинвиронментблокк**](/windows/win32/api/userenv/nf-userenv-createenvironmentblock) .</span><span class="sxs-lookup"><span data-stu-id="a4e13-133">To retrieve a copy of the environment block for a given user, use the [**CreateEnvironmentBlock**](/windows/win32/api/userenv/nf-userenv-createenvironmentblock) function.</span></span>

<span data-ttu-id="a4e13-134">Чтобы развернуть строки переменных среды, используйте функцию [**експанденвиронментстрингс**](/windows/desktop/api/processenv/nf-processenv-expandenvironmentstringsa) .</span><span class="sxs-lookup"><span data-stu-id="a4e13-134">To expand environment-variable strings, use the [**ExpandEnvironmentStrings**](/windows/desktop/api/processenv/nf-processenv-expandenvironmentstringsa) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a4e13-135">См. также</span><span class="sxs-lookup"><span data-stu-id="a4e13-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a4e13-136">Изменение переменных среды</span><span class="sxs-lookup"><span data-stu-id="a4e13-136">Changing Environment Variables</span></span>](changing-environment-variables.md)
</dt> <dt>

[<span data-ttu-id="a4e13-137">Переменные среды пользователя</span><span class="sxs-lookup"><span data-stu-id="a4e13-137">User Environment Variables</span></span>](../shell/user-environment-variables.md)
</dt> </dl>

 

 
