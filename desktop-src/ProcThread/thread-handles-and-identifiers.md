---
description: При создании нового потока функцией CreateThread или Креатеремотесреад возвращается маркер потока.
ms.assetid: ff91fe27-9773-4185-bc1e-57e897be3821
title: Дескрипторы потоков и идентификаторы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 501d449bdb34d158ad14e52409967d4ef17f62f3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909672"
---
# <a name="thread-handles-and-identifiers"></a><span data-ttu-id="f2d5f-103">Дескрипторы потоков и идентификаторы</span><span class="sxs-lookup"><span data-stu-id="f2d5f-103">Thread Handles and Identifiers</span></span>

<span data-ttu-id="f2d5f-104">При создании нового потока функцией [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) или [**креатеремотесреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread) возвращается маркер потока.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-104">When a new thread is created by the [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) or [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread) function, a handle to the thread is returned.</span></span> <span data-ttu-id="f2d5f-105">По умолчанию этот обработчик имеет права полного доступа и — подлежит проверке доступа безопасности — может использоваться в любой функции, принимающей обработчик потока.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-105">By default, this handle has full access rights, and—subject to security access checking—can be used in any of the functions that accept a thread handle.</span></span> <span data-ttu-id="f2d5f-106">Этот маркер может наследоваться дочерними процессами в зависимости от флага наследования, заданного при его создании.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-106">This handle can be inherited by child processes, depending on the inheritance flag specified when it is created.</span></span> <span data-ttu-id="f2d5f-107">Этот маркер можно дублировать с помощью [**дупликатехандле**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle), что позволяет создать обработчик потока с подмножеством прав доступа.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-107">The handle can be duplicated by [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle), which enables you to create a thread handle with a subset of the access rights.</span></span> <span data-ttu-id="f2d5f-108">Этот маркер действителен до закрытия, даже после завершения потока, который он представляет.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-108">The handle is valid until closed, even after the thread it represents has been terminated.</span></span>

<span data-ttu-id="f2d5f-109">Функции [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) и [**креатеремотесреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread) также возвращают идентификатор, который уникальным образом идентифицирует поток во всей системе.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-109">The [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) and [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread) functions also return an identifier that uniquely identifies the thread throughout the system.</span></span> <span data-ttu-id="f2d5f-110">Поток может использовать функцию [**GetCurrentThreadId**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthreadid) для получения собственного идентификатора потока.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-110">A thread can use the [**GetCurrentThreadId**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthreadid) function to get its own thread identifier.</span></span> <span data-ttu-id="f2d5f-111">Идентификаторы действительны с момента создания потока до завершения потока.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-111">The identifiers are valid from the time the thread is created until the thread has been terminated.</span></span> <span data-ttu-id="f2d5f-112">Обратите внимание, что идентификатор потока никогда не будет равен 0.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-112">Note that no thread identifier will ever be 0.</span></span>

<span data-ttu-id="f2d5f-113">Если у вас есть идентификатор потока, можно получить его обработчик, вызвав функцию [**опенсреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthread) .</span><span class="sxs-lookup"><span data-stu-id="f2d5f-113">If you have a thread identifier, you can get the thread handle by calling the [**OpenThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthread) function.</span></span> <span data-ttu-id="f2d5f-114">**Опенсреад** позволяет указать права доступа маркера и возможность наследования.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-114">**OpenThread** enables you to specify the handle's access rights and whether it can be inherited.</span></span>

<span data-ttu-id="f2d5f-115">Поток может использовать функцию [**жеткуррентсреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) для извлечения *псевдо-обработчика* в собственный объект потока.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-115">A thread can use the [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) function to retrieve a *pseudo handle* to its own thread object.</span></span> <span data-ttu-id="f2d5f-116">Этот псевдо-обработчик допустим только для вызывающего процесса; Он не может наследоваться или дублироваться для использования другими процессами.</span><span class="sxs-lookup"><span data-stu-id="f2d5f-116">This pseudo handle is valid only for the calling process; it cannot be inherited or duplicated for use by other processes.</span></span> <span data-ttu-id="f2d5f-117">Чтобы получить реальный маркер для потока с учетом псевдо-обработчика, используйте функцию [**дупликатехандле**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) .</span><span class="sxs-lookup"><span data-stu-id="f2d5f-117">To get the real handle to the thread, given a pseudo handle, use the [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) function.</span></span>

<span data-ttu-id="f2d5f-118">Чтобы перечислить потоки процесса, используйте функции [**Thread32First**](/windows/win32/api/tlhelp32/nf-tlhelp32-thread32first) и [**Thread32Next**](/windows/win32/api/tlhelp32/nf-tlhelp32-thread32next) .</span><span class="sxs-lookup"><span data-stu-id="f2d5f-118">To enumerate the threads of a process, use the [**Thread32First**](/windows/win32/api/tlhelp32/nf-tlhelp32-thread32first) and [**Thread32Next**](/windows/win32/api/tlhelp32/nf-tlhelp32-thread32next) functions.</span></span>

 

 
