---
description: 64-разрядные версии Windows 7 и Windows Server 2008 R2 и более поздних версий Windows поддерживают более 64 логических процессоров на одном компьютере. Эта функция недоступна в 32-разрядных версиях Windows.
ms.assetid: c627ac0f-96e8-48b5-9103-4316f487e173
title: Группы процессоров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cebc5b9ab1b386847b6561a9f6322c2fca0e2ae5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104080786"
---
# <a name="processor-groups"></a><span data-ttu-id="7e06c-104">Группы процессоров</span><span class="sxs-lookup"><span data-stu-id="7e06c-104">Processor Groups</span></span>

<span data-ttu-id="7e06c-105">64-разрядные версии Windows 7 и Windows Server 2008 R2 и более поздних версий Windows поддерживают более 64 логических процессоров на одном компьютере.</span><span class="sxs-lookup"><span data-stu-id="7e06c-105">The 64-bit versions of Windows 7 and Windows Server 2008 R2 and later versions of Windows support more than 64 logical processors on a single computer.</span></span> <span data-ttu-id="7e06c-106">Эта функция недоступна в 32-разрядных версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="7e06c-106">This functionality is not available on 32-bit versions of Windows.</span></span>

<span data-ttu-id="7e06c-107">Системы с более чем одним физическим процессором или системами с физическими процессорами, имеющими несколько ядер, предоставляют операционной системе несколько логических процессоров.</span><span class="sxs-lookup"><span data-stu-id="7e06c-107">Systems with more than one physical processor or systems with physical processors that have multiple cores provide the operating system with multiple logical processors.</span></span> <span data-ttu-id="7e06c-108">*Логический процессор* — это одна логическая вычислительная система с точки зрения операционной системы, приложения или драйвера.</span><span class="sxs-lookup"><span data-stu-id="7e06c-108">A *logical processor* is one logical computing engine from the perspective of the operating system, application or driver.</span></span> <span data-ttu-id="7e06c-109">*Ядро* — это одна единица процессора, которая может состоять из одного или нескольких логических процессоров.</span><span class="sxs-lookup"><span data-stu-id="7e06c-109">A *core* is one processor unit, which can consist of one or more logical processors.</span></span> <span data-ttu-id="7e06c-110">*Физический процессор* может состоять из одного или нескольких ядер.</span><span class="sxs-lookup"><span data-stu-id="7e06c-110">A *physical processor* can consist of one or more cores.</span></span> <span data-ttu-id="7e06c-111">Физический процессор аналогичен пакету процессора, сокету или ЦП.</span><span class="sxs-lookup"><span data-stu-id="7e06c-111">A physical processor is the same as a processor package, a socket, or a CPU.</span></span>

<span data-ttu-id="7e06c-112">Поддержка систем, имеющих более 64 логических процессоров, основана на концепции *группы процессоров*, которая является статическим набором до 64 логических процессоров, который рассматривается как единая сущность планирования.</span><span class="sxs-lookup"><span data-stu-id="7e06c-112">Support for systems that have more than 64 logical processors is based on the concept of a *processor group*, which is a static set of up to 64 logical processors that is treated as a single scheduling entity.</span></span> <span data-ttu-id="7e06c-113">Нумерация групп процессоров начинается с 0.</span><span class="sxs-lookup"><span data-stu-id="7e06c-113">Processor groups are numbered starting with 0.</span></span> <span data-ttu-id="7e06c-114">Системы с менее чем 64 логическими процессорами всегда имеют одну группу, равную 0.</span><span class="sxs-lookup"><span data-stu-id="7e06c-114">Systems with fewer than 64 logical processors always have a single group, Group 0.</span></span>

<span data-ttu-id="7e06c-115">Windows **server 2008, Windows Vista, Windows server 2003 и Windows XP:** Группы процессоров не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="7e06c-115">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:** Processor groups are not supported.</span></span>

<span data-ttu-id="7e06c-116">При запуске системы операционная система создает группы процессоров и назначает логические процессоры группам.</span><span class="sxs-lookup"><span data-stu-id="7e06c-116">When the system starts, the operating system creates processor groups and assigns logical processors to the groups.</span></span> <span data-ttu-id="7e06c-117">Если система поддерживает горячее добавление процессоров, операционная система предоставляет пространство в группах для процессоров, которые могут поступать во время работы системы.</span><span class="sxs-lookup"><span data-stu-id="7e06c-117">If the system is capable of hot-adding processors, the operating system allows space in groups for processors that might arrive while the system is running.</span></span> <span data-ttu-id="7e06c-118">Операционная система уменьшает количество групп в системе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-118">The operating system minimizes the number of groups in a system.</span></span> <span data-ttu-id="7e06c-119">Например, система с 128 логических процессоров будет иметь две группы процессоров с 64 процессоров в каждой группе, а не четыре группы с 32 логических процессоров в каждой группе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-119">For example, a system with 128 logical processors would have two processor groups with 64 processors in each group, not four groups with 32 logical processors in each group.</span></span>

<span data-ttu-id="7e06c-120">Для повышения производительности операционная система учитывает физическую локализацию при назначении логических процессоров группам.</span><span class="sxs-lookup"><span data-stu-id="7e06c-120">For better performance, the operating system takes physical locality into account when assigning logical processors to groups.</span></span> <span data-ttu-id="7e06c-121">Все логические процессоры в ядре, а также все ядра физического процессора назначаются одной группе, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="7e06c-121">All of the logical processors in a core, and all of the cores in a physical processor, are assigned to the same group, if possible.</span></span> <span data-ttu-id="7e06c-122">Физические процессоры, физически близкие друг к другу, назначаются одной группе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-122">Physical processors that are physically close to one another are assigned to the same group.</span></span> <span data-ttu-id="7e06c-123">Узел NUMA назначается одной группе, если емкость узла не превышает максимальный размер группы.</span><span class="sxs-lookup"><span data-stu-id="7e06c-123">A NUMA node is assigned to a single group unless the capacity of the node exceeds the maximum group size.</span></span> <span data-ttu-id="7e06c-124">Дополнительные сведения см. в разделе [Поддержка NUMA](numa-support.md).</span><span class="sxs-lookup"><span data-stu-id="7e06c-124">For more information, see [NUMA Support](numa-support.md).</span></span>

<span data-ttu-id="7e06c-125">В системах с 64 или менее процессорами существующие приложения будут правильно работать без изменений.</span><span class="sxs-lookup"><span data-stu-id="7e06c-125">On systems with 64 or fewer processors, existing applications will operate correctly without modification.</span></span> <span data-ttu-id="7e06c-126">Приложения, которые не вызывают никаких функций, использующих маски соответствия процессоров или номера процессоров, будут правильно работать на всех системах, независимо от числа процессоров.</span><span class="sxs-lookup"><span data-stu-id="7e06c-126">Applications that do not call any functions that use processor affinity masks or processor numbers will operate correctly on all systems, regardless of the number of processors.</span></span> <span data-ttu-id="7e06c-127">Для правильной работы в системах с более чем 64 логическими процессорами может потребоваться изменение следующих типов приложений:</span><span class="sxs-lookup"><span data-stu-id="7e06c-127">To operate correctly on systems with more than 64 logical processors, the following kinds of applications might require modification:</span></span>

-   <span data-ttu-id="7e06c-128">Приложения, которые управляют, обслуживают или отображают сведения о процессоре для всей системы, должны быть изменены для поддержки более чем 64 логических процессоров.</span><span class="sxs-lookup"><span data-stu-id="7e06c-128">Applications that manage, maintain, or display per-processor information for the entire system must be modified to support more than 64 logical processors.</span></span> <span data-ttu-id="7e06c-129">Примером такого приложения является диспетчер задач Windows, который отображает рабочую нагрузку каждого процессора в системе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-129">An example of such an application is Windows Task Manager, which displays the workload of each processor in the system.</span></span>
-   <span data-ttu-id="7e06c-130">Приложения, для которых важна производительность, и которые могут эффективно масштабироваться за пределами 64 логических процессоров, должны быть изменены для работы в таких системах.</span><span class="sxs-lookup"><span data-stu-id="7e06c-130">Applications for which performance is critical and that can scale efficiently beyond 64 logical processors must be modified to run on such systems.</span></span> <span data-ttu-id="7e06c-131">Например, изменения могут быть полезны для приложений базы данных.</span><span class="sxs-lookup"><span data-stu-id="7e06c-131">For example, database applications might benefit from modifications.</span></span>
-   <span data-ttu-id="7e06c-132">Если приложение использует библиотеку DLL, которая содержит структуры данных для каждого процессора, а библиотека DLL не была изменена для поддержки более 64 логических процессоров, все потоки в приложении, которые вызывают функции, экспортированные библиотекой DLL, должны быть назначены одной группе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-132">If an application uses a DLL that has per-processor data structures, and the DLL has not been modified to support more than 64 logical processors, all threads in the application that call functions exported by the DLL must be assigned to the same group.</span></span>

<span data-ttu-id="7e06c-133">По умолчанию приложение ограничено одной группой, что должно обеспечить достаточную вычислительную мощность для обычного приложения.</span><span class="sxs-lookup"><span data-stu-id="7e06c-133">By default, an application is constrained to a single group, which should provide ample processing capability for the typical application.</span></span> <span data-ttu-id="7e06c-134">Операционная система изначально назначает каждый процесс для одной группы циклическим перебором по группам в системе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-134">The operating system initially assigns each process to a single group in a round-robin manner across the groups in the system.</span></span> <span data-ttu-id="7e06c-135">Процесс начинает выполнение, назначенное одной группе.</span><span class="sxs-lookup"><span data-stu-id="7e06c-135">A process begins its execution assigned to one group.</span></span> <span data-ttu-id="7e06c-136">Первый поток процесса изначально выполняется в группе, которой назначен процесс.</span><span class="sxs-lookup"><span data-stu-id="7e06c-136">The first thread of a process initially runs in the group to which the process is assigned.</span></span> <span data-ttu-id="7e06c-137">Каждый созданный поток назначается той же группе, что и создавший его поток.</span><span class="sxs-lookup"><span data-stu-id="7e06c-137">Each newly created thread is assigned to the same group as the thread that created it.</span></span>

<span data-ttu-id="7e06c-138">Приложение, которое требует использования нескольких групп для выполнения на более чем 64 процессорах, должно явно определить место выполнения своих потоков и отвечает за присвоение процессору потоков соответствия требуемым группам.</span><span class="sxs-lookup"><span data-stu-id="7e06c-138">An application that requires the use of multiple groups so that it can run on more than 64 processors must explicitly determine where to run its threads and is responsible for setting the threads' processor affinities to the desired groups.</span></span> <span data-ttu-id="7e06c-139">Флаг [наследования \_ родительского \_ сходства](process-creation-flags.md) можно использовать для указания родительского процесса (который может отличаться от текущего процесса), из которого создается сходство для нового процесса.</span><span class="sxs-lookup"><span data-stu-id="7e06c-139">The [INHERIT\_PARENT\_AFFINITY](process-creation-flags.md) flag can be used to specify a parent process (which can be different than the current process) from which to generate the affinity for a new process.</span></span> <span data-ttu-id="7e06c-140">Если процесс выполняется в одной группе, он может считывать и изменять его сходство с помощью [**жетпроцессаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-getprocessaffinitymask) и [**сетпроцессаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-setprocessaffinitymask) , пока остается в той же группе. При изменении сходства процесса к его потокам применяется новое сходство.</span><span class="sxs-lookup"><span data-stu-id="7e06c-140">If the process is running in a single group, it can read and modify its affinity using [**GetProcessAffinityMask**](/windows/desktop/api/WinBase/nf-winbase-getprocessaffinitymask) and [**SetProcessAffinityMask**](/windows/desktop/api/WinBase/nf-winbase-setprocessaffinitymask) while remaining in the same group; if the process affinity is modified, the new affinity is applied to its threads.</span></span>

<span data-ttu-id="7e06c-141">Сходство потоков можно указать при создании, используя расширенный атрибут [**\_ \_ \_ \_ сходства группы атрибутов потока**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) с функцией [**креатеремотесреадекс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethreadex) .</span><span class="sxs-lookup"><span data-stu-id="7e06c-141">A thread's affinity can be specified at creation using the [**PROC\_THREAD\_ATTRIBUTE\_GROUP\_AFFINITY**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) extended attribute with the [**CreateRemoteThreadEx**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethreadex) function.</span></span> <span data-ttu-id="7e06c-142">После создания потока его сходство можно изменить, вызвав [**сетсреадаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-setthreadaffinitymask) или [**сетсреадграупаффинити**](/windows/win32/api/processtopologyapi/nf-processtopologyapi-setthreadgroupaffinity).</span><span class="sxs-lookup"><span data-stu-id="7e06c-142">After the thread is created, its affinity can be changed by calling [**SetThreadAffinityMask**](/windows/desktop/api/WinBase/nf-winbase-setthreadaffinitymask) or [**SetThreadGroupAffinity**](/windows/win32/api/processtopologyapi/nf-processtopologyapi-setthreadgroupaffinity).</span></span> <span data-ttu-id="7e06c-143">Если поток назначен другой группе по сравнению с процессом, сходство процесса обновляется, чтобы включить сходство потока, и процесс становится многогрупповым процессом.</span><span class="sxs-lookup"><span data-stu-id="7e06c-143">If a thread is assigned to a different group than the process, the process's affinity is updated to include the thread's affinity and the process becomes a multi-group process.</span></span> <span data-ttu-id="7e06c-144">Дальнейшие изменения сходства должны выполняться для отдельных потоков. Сопоставление нескольких групповых процессов нельзя изменить с помощью [**сетпроцессаффинитимаск**](/windows/desktop/api/WinBase/nf-winbase-setprocessaffinitymask).</span><span class="sxs-lookup"><span data-stu-id="7e06c-144">Further affinity changes must be made for individual threads; a multi-group process's affinity cannot be modified using [**SetProcessAffinityMask**](/windows/desktop/api/WinBase/nf-winbase-setprocessaffinitymask).</span></span> <span data-ttu-id="7e06c-145">Функция [**жетпроцессграупаффинити**](/windows/win32/api/processtopologyapi/nf-processtopologyapi-getprocessgroupaffinity) извлекает набор групп, которым назначен процесс и его потоки.</span><span class="sxs-lookup"><span data-stu-id="7e06c-145">The [**GetProcessGroupAffinity**](/windows/win32/api/processtopologyapi/nf-processtopologyapi-getprocessgroupaffinity) function retrieves the set of groups to which a process and its threads are assigned.</span></span>

<span data-ttu-id="7e06c-146">Чтобы указать сходство для всех процессов, связанных с объектом задания, используйте функцию [**сетинформатионжобобжект**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) с классом сведений **жобобжектграупинформатион** или **жобобжектграупинформатионекс** .</span><span class="sxs-lookup"><span data-stu-id="7e06c-146">To specify affinity for all processes associated with a job object, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function with the **JobObjectGroupInformation** or **JobObjectGroupInformationEx** information class.</span></span>

<span data-ttu-id="7e06c-147">Логический процессор определяется по номеру группы и его номеру процессора относительно группы.</span><span class="sxs-lookup"><span data-stu-id="7e06c-147">A logical processor is identified by its group number and its group-relative processor number.</span></span> <span data-ttu-id="7e06c-148">Он представляется структурой [**\_ номеров процессоров**](/windows/desktop/api/WinNT/ns-winnt-processor_number) .</span><span class="sxs-lookup"><span data-stu-id="7e06c-148">This is represented by a [**PROCESSOR\_NUMBER**](/windows/desktop/api/WinNT/ns-winnt-processor_number) structure.</span></span> <span data-ttu-id="7e06c-149">Числовые номера процессоров, используемые устаревшими функциями, относительные группы.</span><span class="sxs-lookup"><span data-stu-id="7e06c-149">Numeric processor numbers used by legacy functions are group-relative.</span></span>

<span data-ttu-id="7e06c-150">Описание изменений архитектуры операционной системы, поддерживающих более 64 процессоров, см. в техническом документе [, поддерживающем более 64 процессоров](https://www.microsoft.com/whdc/system/Sysinternals/MoreThan64proc.mspx).</span><span class="sxs-lookup"><span data-stu-id="7e06c-150">For a discussion of operating system architecture changes to support more than 64 processors, see the white paper [Supporting Systems That Have More Than 64 Processors](https://www.microsoft.com/whdc/system/Sysinternals/MoreThan64proc.mspx).</span></span>

<span data-ttu-id="7e06c-151">Список новых функций и структур, поддерживающих группы процессоров, см. [в разделе новые возможности процессов и потоков](what-s-new-in-processes-and-threads.md).</span><span class="sxs-lookup"><span data-stu-id="7e06c-151">For a list of new functions and structures that support processor groups, see [What's New in Processes and Threads](what-s-new-in-processes-and-threads.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7e06c-152">См. также</span><span class="sxs-lookup"><span data-stu-id="7e06c-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7e06c-153">Несколько процессоров</span><span class="sxs-lookup"><span data-stu-id="7e06c-153">Multiple Processors</span></span>](multiple-processors.md)
</dt> <dt>

[<span data-ttu-id="7e06c-154">Поддержка NUMA</span><span class="sxs-lookup"><span data-stu-id="7e06c-154">NUMA Support</span></span>](numa-support.md)
</dt> </dl>

 

 
