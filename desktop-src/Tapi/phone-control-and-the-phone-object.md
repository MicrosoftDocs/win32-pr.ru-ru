---
description: В интерфейсе TAPI 3,1 появились элементы управления телефоном на основе COM. Предполагается, что вы знакомы с COM, OLE-автоматизацией и скриптами, как и знание объектной модели TAPI 3. Знания о функциях управления телефоном TAPI 2 также полезны.
ms.assetid: e56aef54-e358-429b-9f0f-c8776507d95f
title: Элемент управления телефоном и объект Phone
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b5e9344d54a63efcf1692af361a5f8e88121981e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683266"
---
# <a name="phone-control-and-the-phone-object"></a><span data-ttu-id="a8d51-105">Элемент управления телефоном и объект Phone</span><span class="sxs-lookup"><span data-stu-id="a8d51-105">Phone Control and the Phone Object</span></span>

<span data-ttu-id="a8d51-106">В интерфейсе TAPI 3,1 появились элементы управления телефоном на основе COM.</span><span class="sxs-lookup"><span data-stu-id="a8d51-106">TAPI 3.1 introduces COM-based phone controls.</span></span> <span data-ttu-id="a8d51-107">Предполагается, что вы знакомы с COM, OLE-автоматизацией и скриптами, как и знание объектной модели TAPI 3.</span><span class="sxs-lookup"><span data-stu-id="a8d51-107">Familiarity with COM, OLE Automation, and scripting is assumed, as is knowledge of the TAPI 3 object model.</span></span> <span data-ttu-id="a8d51-108">Знания о функциях управления телефоном TAPI 2 также полезны.</span><span class="sxs-lookup"><span data-stu-id="a8d51-108">Knowledge of the TAPI 2 phone control functions is also helpful.</span></span>

<span data-ttu-id="a8d51-109">Элемент управления телефоном реализуется на трех уровнях, каждый из которых строится на основе предыдущего:</span><span class="sxs-lookup"><span data-stu-id="a8d51-109">Phone control is implemented at three levels of features, each of which builds upon the previous one:</span></span>

-   <span data-ttu-id="a8d51-110">Объект Phone.</span><span class="sxs-lookup"><span data-stu-id="a8d51-110">Phone object.</span></span> <span data-ttu-id="a8d51-111">Первый уровень определяет, как телефонные устройства TAPI 2. x (API, константы и сообщения, начинающиеся с "Phone") представлены в объектной модели TAPI 3,1.</span><span class="sxs-lookup"><span data-stu-id="a8d51-111">The first level defines how TAPI 2.x's phone devices (APIs, constants, and messages beginning with "phone") are exposed in the TAPI 3.1 object model.</span></span> <span data-ttu-id="a8d51-112">Это включает новый объект Phone, предоставляемый из TAPI 3,1, с [**итфоне**](/windows/desktop/api/tapi3if/nn-tapi3if-itphone) в качестве интерфейса по умолчанию для нового объекта.</span><span class="sxs-lookup"><span data-stu-id="a8d51-112">This involves a new phone object exposed from TAPI 3.1, with [**ITPhone**](/windows/desktop/api/tapi3if/nn-tapi3if-itphone) as the default interface on the new object.</span></span> <span data-ttu-id="a8d51-113">Интерфейс **итфоне** вместе со связанными с ним константами, перечисляемыми типами и событиями обычно предоставляет тот же уровень детализации и функций, что и функции, константы, структуры и сообщения TAPI 2. x, которые начинаются со слова Phone.</span><span class="sxs-lookup"><span data-stu-id="a8d51-113">The **ITPhone** interface, along with its associated constants, enumerated types, and events, generally exposes the same level of detail and functionality as the TAPI 2.x functions, constants, structures, and messages that begin with the word "phone."</span></span> <span data-ttu-id="a8d51-114">Этот уровень также включает новые интерфейсы на нескольких существующих объектах TAPI 3. x для упрощения создания телефонных объектов и сопоставления телефонных объектов с другими объектами, к которым они относятся.</span><span class="sxs-lookup"><span data-stu-id="a8d51-114">This level also involves new interfaces on several existing TAPI 3.x objects to facilitate creation of phone objects and association of phone objects with other objects to which they are related.</span></span>
-   <span data-ttu-id="a8d51-115">Автоматическое управление телефоном и обработка вызовов.</span><span class="sxs-lookup"><span data-stu-id="a8d51-115">Automated phone control and call handling.</span></span> <span data-ttu-id="a8d51-116">Второй уровень состоит из дополнительного интерфейса с именем [**итаутоматедфонеконтрол**](/windows/desktop/api/tapi3if/nn-tapi3if-itautomatedphonecontrol) и связанных с ним констант, перечисляемых типов и событий.</span><span class="sxs-lookup"><span data-stu-id="a8d51-116">The second level consists of an additional interface called [**ITAutomatedPhoneControl**](/windows/desktop/api/tapi3if/nn-tapi3if-itautomatedphonecontrol) and its associated constants, enumerated types, and events.</span></span> <span data-ttu-id="a8d51-117">Это дополнительный интерфейс для объекта Phone.</span><span class="sxs-lookup"><span data-stu-id="a8d51-117">This is a secondary interface on the phone object.</span></span> <span data-ttu-id="a8d51-118">Если телефонное устройство было открыто с правами владельца, используйте метод **QueryInterface** в интерфейсе [**итфоне**](/windows/desktop/api/tapi3if/nn-tapi3if-itphone) , чтобы получить указатель на интерфейс **итаутоматедфонеконтрол** .</span><span class="sxs-lookup"><span data-stu-id="a8d51-118">If the phone device was opened with owner privilege, use the **QueryInterface** method on the [**ITPhone**](/windows/desktop/api/tapi3if/nn-tapi3if-itphone) interface to obtain an **ITAutomatedPhoneControl** interface pointer.</span></span>
-   <span data-ttu-id="a8d51-119">Windows 2000 Phone номеронабирателя.</span><span class="sxs-lookup"><span data-stu-id="a8d51-119">Windows 2000 Phone Dialer.</span></span> <span data-ttu-id="a8d51-120">Третий уровень состоит из изменений в приложении телефонного номеронабирателя Windows 2000, чтобы реализовать определенные взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="a8d51-120">The third level consists of changes to the Windows 2000 Phone Dialer application to implement specific user interactions.</span></span>

<span data-ttu-id="a8d51-121">Разработчики Майкрософт и сторонних разработчиков могут использовать объектную модель TAPI 3,1 для реализации более сложных приложений или служб, включающих телефоны, включая службу, которая позволяет использовать сотовые телефоны (USB), например, для телефонных звонков, даже если никто из пользователей не вошел в систему, а другие приложения TAPI не были запущены явным образом.</span><span class="sxs-lookup"><span data-stu-id="a8d51-121">Microsoft or third party developers can use the TAPI 3.1 object model to implement more advanced applications or services involving phones, including a service that enables universal serial bus (USB) handsets, for example, to be used for phone calls even if no user is logged in and no other TAPI application has been explicitly started.</span></span>

<span data-ttu-id="a8d51-122">В TAPI 3,0 попытка выполнить телефонный MSP для улучшения телефонных устройств, связанных со строками, используемыми для вызовов TAPI 3,0.</span><span class="sxs-lookup"><span data-stu-id="a8d51-122">In TAPI 3.0, a Phone MSP attempted to improve phone devices associated with lines used for TAPI 3.0 calls.</span></span> <span data-ttu-id="a8d51-123">Эта разработка предназначена для поддержки модемов с динамиками с программным переключением.</span><span class="sxs-lookup"><span data-stu-id="a8d51-123">This development intended to support modems with software-switchable speakerphones.</span></span> <span data-ttu-id="a8d51-124">Приложения TAPI 3,1, использующие этот тип модема, должны использовать телефонные объекты TAPI 3,1 для управления состоянием модема хуксвитч.</span><span class="sxs-lookup"><span data-stu-id="a8d51-124">TAPI 3.1 applications that use this modem type should use the TAPI 3.1 phone objects to manipulate the modem hookswitch state.</span></span>

<span data-ttu-id="a8d51-125">Дополнительные сведения и список всех интерфейсов, связанных с объектом Phone, см. в разделе [интерфейсы объекта Phone](phone-object-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="a8d51-125">For more information and a list of all interfaces associated with the Phone object, see [Phone Object Interfaces](phone-object-interfaces.md).</span></span> <span data-ttu-id="a8d51-126">Интерфейсы управления телефоном предоставляют методы, позволяющие управлять наборами телефонов с помощью COM.</span><span class="sxs-lookup"><span data-stu-id="a8d51-126">The phone control interfaces expose methods that enable control over phone sets using COM.</span></span>

 

 



