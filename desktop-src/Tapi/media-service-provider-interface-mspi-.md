---
description: Интерфейс поставщика услуг мультимедиа (МСПИ) — это набор интерфейсов и методов, реализованных с помощью MSP, которые позволяют управлять приложениями TAPI 3 во время сеанса связи.
ms.assetid: 53b7bcbd-571a-44da-a6db-10d4c3e5d30a
title: Интерфейс поставщика службы мультимедиа (МСПИ)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b1ce09e626ede14515c0abbbd5c3a35921026d6
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "105674543"
---
# <a name="media-service-provider-interface-mspi"></a><span data-ttu-id="8876b-103">Интерфейс поставщика службы мультимедиа (МСПИ)</span><span class="sxs-lookup"><span data-stu-id="8876b-103">Media Service Provider Interface (MSPI)</span></span>

<span data-ttu-id="8876b-104">Интерфейс поставщика услуг мультимедиа (МСПИ) — это набор интерфейсов и методов, реализованных с помощью MSP, которые позволяют управлять приложениями TAPI 3 во время сеанса связи.</span><span class="sxs-lookup"><span data-stu-id="8876b-104">The Media Service Provider Interface (MSPI) is a set of interfaces and methods implemented by an MSP to allow a TAPI 3 application control over media transport during a communications session.</span></span> <span data-ttu-id="8876b-105">MSP обрабатывает механизмы для конкретных устройств и протоколов, необходимые для внедрения этих элементов управления, и взаимодействует со связанным TSP или приложением с помощью методов, предоставляемых в МСПИ.</span><span class="sxs-lookup"><span data-stu-id="8876b-105">An MSP handles the device-specific and protocol-specific mechanisms needed to enact these controls, and communicates with its paired TSP or an application through use of the methods provided in the MSPI.</span></span>

<span data-ttu-id="8876b-106">В следующем разделе ( [Справочник по интерфейсу поставщика услуг мультимедиа (мспи)](media-service-provider-interface-mspi-reference.md)) подробно описываются интерфейсы, предоставляемые MSP для взаимодействия со средой телефонии Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="8876b-106">The following section ( [Media Service Provider Interface (MSPI) Reference](media-service-provider-interface-mspi-reference.md)) details the interfaces an MSP exposes in order to interact with the Microsoft Telephony environment.</span></span>

<span data-ttu-id="8876b-107">Кроме того, MSP может предоставлять частные интерфейсы и методы, относящиеся к поставщику, для дальнейшей помощи в управлении мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="8876b-107">In addition, an MSP may expose provider-specific private interfaces and methods to further assist in media control.</span></span> <span data-ttu-id="8876b-108">Например, [MSP-конференция IP](ipconf-msp.md) предоставляет интерфейсы, обеспечивающие управление участниками.</span><span class="sxs-lookup"><span data-stu-id="8876b-108">For example, the [IP Conference MSP](ipconf-msp.md) exposes interfaces that provide participant control.</span></span> <span data-ttu-id="8876b-109">Сведения о том, как работают частные объекты и [ИПКОНФ MSP-интерфейсы](ipconf-msp-interfaces.md) для справочного списка ипконф, см. в разделе [интерфейсы, зависящие от поставщика](provider-specific-interfaces.md) .</span><span class="sxs-lookup"><span data-stu-id="8876b-109">See [Provider-Specific Interfaces](provider-specific-interfaces.md) for information on how private objects work and [IPConf MSP Interfaces](ipconf-msp-interfaces.md) for a reference listing of IPConf.</span></span>

<span data-ttu-id="8876b-110">Большая часть усилий по программированию в процессе создания MSP очень специфична для конкретной платформы, устройства и транспортного протокола и выходит за рамки этого документа.</span><span class="sxs-lookup"><span data-stu-id="8876b-110">The majority of the programming effort in creating an MSP is highly specific to a given platform, device, and transport protocol, and is outside the scope of this document.</span></span> <span data-ttu-id="8876b-111">Однако корпорация Майкрософт предоставляет ряд базовых классов MSP, которые будут полезны большинству MSP-авторов.</span><span class="sxs-lookup"><span data-stu-id="8876b-111">However, Microsoft supplies a set of MSP base classes, which will be useful to most MSP authors.</span></span> <span data-ttu-id="8876b-112">Сведения об использовании этих классов см. в разделе [базовые классы MSP TAPI 3](tapi-3-msp-base-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="8876b-112">See [TAPI 3 MSP Base Classes](tapi-3-msp-base-classes.md) for information on using these classes.</span></span>

<span data-ttu-id="8876b-113">Интерфейс [**итмспаддресс**](/windows/desktop/api/msp/nn-msp-itmspaddress) представляет поставщика службы мультимедиа для библиотеки DLL TAPI.</span><span class="sxs-lookup"><span data-stu-id="8876b-113">The [**ITMSPAddress**](/windows/desktop/api/msp/nn-msp-itmspaddress) interface represents a media service provider to the TAPI DLL.</span></span> <span data-ttu-id="8876b-114">Этот интерфейс не используется или предоставляется приложению конечного пользователя.</span><span class="sxs-lookup"><span data-stu-id="8876b-114">This interface is not used by or exposed to an end-user application.</span></span> <span data-ttu-id="8876b-115">Библиотека DLL TAPI 3 вызывает **CoCreateInstance** на этом интерфейсе для создания основного объекта MSP.</span><span class="sxs-lookup"><span data-stu-id="8876b-115">The TAPI 3 DLL calls **CoCreateInstance** on this interface to create the main MSP object.</span></span> <span data-ttu-id="8876b-116">Методы этого объекта позволяют приложению загружать и выгружать MSP, принимать сведения от TSP и создавать интерфейс [**итстреамконтрол**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) , который предоставляется в объекте Call.</span><span class="sxs-lookup"><span data-stu-id="8876b-116">Methods on this object allow an application to load and unload the MSP, receive information from a TSP, and create the [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) interface, which is exposed on the call object.</span></span>

<span data-ttu-id="8876b-117">Интерфейсы [**итсубстреамконтрол**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) и [**итсубстреам**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstream) предоставляют параллельные методы относительно подпотоков.</span><span class="sxs-lookup"><span data-stu-id="8876b-117">The [**ITSubStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) and [**ITSubStream**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstream) interfaces provide parallel methods with respect to substreams.</span></span> <span data-ttu-id="8876b-118">Поддержка подпотока является необязательной.</span><span class="sxs-lookup"><span data-stu-id="8876b-118">Substream support is optional.</span></span> <span data-ttu-id="8876b-119">Все остальные интерфейсы должны быть реализованы с помощью MSP.</span><span class="sxs-lookup"><span data-stu-id="8876b-119">All other interfaces must be implemented by an MSP.</span></span>

> [!Note]  
> <span data-ttu-id="8876b-120">Операции, реализованные парой TSP/MSP, должны находиться в одной библиотеке DLL, чтобы разрешить пользователю обновлять поставщик службы без перезагрузки своей системы.</span><span class="sxs-lookup"><span data-stu-id="8876b-120">Operations implemented by a TSP/MSP pair must be located in one DLL to allow a user to update the service provider without rebooting his or her system.</span></span>

 

 

 
