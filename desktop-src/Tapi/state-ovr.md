---
description: Состояние сеанса или вызова указывает текущее состояние сеанса, например &\# 0034; предложение&\# 0034; или &\# 0034; connected. &\# 0034; Правильная работа большинства приложений TAPI крайне важна для правильной обработки сведений о состоянии.
ms.assetid: a6a49b77-4e9b-4f23-bfe6-26f26549b18f
title: Состояние
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 88fb9c482fcb9e432b5bfb5d36f77cd09f538086
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105684525"
---
# <a name="state"></a><span data-ttu-id="dad9a-103">Состояние</span><span class="sxs-lookup"><span data-stu-id="dad9a-103">State</span></span>

<span data-ttu-id="dad9a-104">Состояние сеанса или вызова указывает текущее состояние сеанса, например "предложение" или "подключено".</span><span class="sxs-lookup"><span data-stu-id="dad9a-104">Session or call state indicates the current status of a session, such as "offering" or "connected."</span></span> <span data-ttu-id="dad9a-105">Правильная работа большинства приложений TAPI крайне важна для правильной обработки сведений о состоянии.</span><span class="sxs-lookup"><span data-stu-id="dad9a-105">Proper handling of state information is vital to the proper functioning of most TAPI applications.</span></span> <span data-ttu-id="dad9a-106">Например, операция ответа может быть выполнена только в предложенном сеансе, но перемещение завершится ошибкой, если сеанс находится в этом состоянии.</span><span class="sxs-lookup"><span data-stu-id="dad9a-106">For example, the answer operation can be performed only on an offered session, but a transfer will fail if the session is in that state.</span></span>

<span data-ttu-id="dad9a-107">Состояние сеанса изменяется в результате событий.</span><span class="sxs-lookup"><span data-stu-id="dad9a-107">A session's state changes as a result of events.</span></span> <span data-ttu-id="dad9a-108">События могут быть запрошены или незапрошенными.</span><span class="sxs-lookup"><span data-stu-id="dad9a-108">Events can be solicited or unsolicited.</span></span> <span data-ttu-id="dad9a-109">*Запрашиваемые события* вызываются приложением, управляющим сеансом, например при вызове операции сеанса TAPI.</span><span class="sxs-lookup"><span data-stu-id="dad9a-109">*Solicited events* are caused by the application controlling the session, such as when it invokes a TAPI session operation.</span></span> <span data-ttu-id="dad9a-110">*Незапрошенные события* вызываются коммутатором, телефонной сетью, пользователем нажатием кнопок на локальном телефоне или действиями удаленной стороны.</span><span class="sxs-lookup"><span data-stu-id="dad9a-110">*Unsolicited events* are caused by the switch, the telephone network, the user pressing buttons on the local phone, or the actions of the remote party.</span></span>

<span data-ttu-id="dad9a-111">Каждый раз, когда поставщик услуг обнаруживает изменение состояния сеанса, он сообщает об изменении в TAPI и TAPI выдает уведомление о событии всем приложениям-владельцам и мониторам.</span><span class="sxs-lookup"><span data-stu-id="dad9a-111">Whenever a service provider detects a session state change, it reports the change to TAPI and TAPI issues an event notification to all owner and monitor applications.</span></span> <span data-ttu-id="dad9a-112">Приложение должно соответствующим образом реагировать на эти уведомления.</span><span class="sxs-lookup"><span data-stu-id="dad9a-112">The application must react to these notifications appropriately.</span></span> <span data-ttu-id="dad9a-113">Сведения об управлении событиями, о которых сообщается в приложении, см. в уведомлении о событии в разделе [Инициализация TAPI](tapi-initialization.md) .</span><span class="sxs-lookup"><span data-stu-id="dad9a-113">Please see Event Notification under [TAPI Initialization](tapi-initialization.md) for information on controlling which events are reported to an application.</span></span>

<span data-ttu-id="dad9a-114">Приложение должно всегда обрабатывать уведомления о событиях состояния.</span><span class="sxs-lookup"><span data-stu-id="dad9a-114">An application should always process state event notifications.</span></span> <span data-ttu-id="dad9a-115">Допустимые переходы состояния для одной физической конфигурации могут быть недопустимыми для другой.</span><span class="sxs-lookup"><span data-stu-id="dad9a-115">State transitions valid for one physical configuration may be invalid for another.</span></span> <span data-ttu-id="dad9a-116">Например, рассмотрим строку, которая физически завершается как на компьютере, так и на отдельном наборе телефонов, создавая конфигурацию линий сторон между компьютером и набором телефонов.</span><span class="sxs-lookup"><span data-stu-id="dad9a-116">For example, consider a line that physically terminates both at the computer and at a separate phone set, creating a party line configuration between the computer and the phone set.</span></span> <span data-ttu-id="dad9a-117">Приложение, работающее на компьютере, может не узнать о действиях телефонного набора.</span><span class="sxs-lookup"><span data-stu-id="dad9a-117">An application running on the computer may not know about phone set activities.</span></span> <span data-ttu-id="dad9a-118">То есть строка может быть использована без уведомления поставщика услуг.</span><span class="sxs-lookup"><span data-stu-id="dad9a-118">That is, the line may be in use without the service provider being aware of it.</span></span> <span data-ttu-id="dad9a-119">Приложение, которое пытается выполнить исходящий вызов, будет выполняться при выделении внешнего вида вызова из TAPI, но это приведет к совместному использованию активного вызова в строке.</span><span class="sxs-lookup"><span data-stu-id="dad9a-119">An application that attempts to make an outgoing call will succeed in allocating a call appearance from TAPI, but this results in sharing the active call on the line.</span></span> <span data-ttu-id="dad9a-120">Некоторая Отправка строки набора DTMF без предварительной проверки на гудок может не привести к предполагаемому (или вежливо) поведению.</span><span class="sxs-lookup"><span data-stu-id="dad9a-120">Blindly sending a DTMF dial string without first checking for a dial tone may not result in intended (or polite) behavior.</span></span>

<span data-ttu-id="dad9a-121">Приложение не должно считаться жестким ходом выполнения из одного состояния в другое.</span><span class="sxs-lookup"><span data-stu-id="dad9a-121">An application should not assume a rigid progression from one state to another.</span></span> <span data-ttu-id="dad9a-122">События состояния прибывают и пересылаются асинхронно, и уведомления могут быть не получены в прогнозируемом порядке.</span><span class="sxs-lookup"><span data-stu-id="dad9a-122">State events arrive and are forwarded asynchronously and notifications may not be received in a predictable order.</span></span> <span data-ttu-id="dad9a-123">Таким образом, уведомления о состоянии вызова следует рассматривать как сообщать приложению о новом состоянии вызова, а не о переходах между двумя состояниями.</span><span class="sxs-lookup"><span data-stu-id="dad9a-123">Therefore, call-state notifications should be viewed as telling the application the call's new state instead of as reporting the transitions between two states.</span></span>

<span data-ttu-id="dad9a-124">Эти сведения должны быть предоставлены всем поставщикам услуг телефонии.</span><span class="sxs-lookup"><span data-stu-id="dad9a-124">All telephony service providers must supply this information.</span></span>

<span data-ttu-id="dad9a-125">\* \* TAPI 2. x: \* \*[**линежеткаллстатус**](/windows/win32/api/tapi/nf-tapi-linegetcallstatus), [**линежеткаллинфо**](/windows/win32/api/tapi/nf-tapi-linegetcallinfo), [**строка \_ каллстате**](./line-callstate.md) сообщение, [ \_ константы линекаллстате](./linecallstate--constants.md)</span><span class="sxs-lookup"><span data-stu-id="dad9a-125">\*\*TAPI 2.x:  \*\*[**lineGetCallStatus**](/windows/win32/api/tapi/nf-tapi-linegetcallstatus), [**lineGetCallInfo**](/windows/win32/api/tapi/nf-tapi-linegetcallinfo), [**LINE\_CALLSTATE**](./line-callstate.md) message, [LINECALLSTATE\_ Constants](./linecallstate--constants.md)</span></span>

<span data-ttu-id="dad9a-126">**TAPI 3. x: **[**иткаллинфо:: Get \_ каллинфолонг**](/windows/desktop/api/tapi3if/nf-tapi3if-itcallinfo-get_callinfolong) (** член CIL \_ Каллид** [**каллинфо \_ Long**](/windows/desktop/api/Tapi3if/ne-tapi3if-callinfo_long)), уведомление [**иткаллстативент**](/windows/desktop/api/tapi3if/nn-tapi3if-itcallstateevent) , перечислитель [**\_ состояния вызова**](/windows/desktop/api/Tapi3if/ne-tapi3if-call_state)</span><span class="sxs-lookup"><span data-stu-id="dad9a-126">**TAPI 3.x:  **[**ITCallInfo::get\_CallInfoLong**](/windows/desktop/api/tapi3if/nf-tapi3if-itcallinfo-get_callinfolong) (** CIL\_CALLID** member of [**CALLINFO\_LONG**](/windows/desktop/api/Tapi3if/ne-tapi3if-callinfo_long)), [**ITCallStateEvent**](/windows/desktop/api/tapi3if/nn-tapi3if-itcallstateevent) notification, [**CALL\_STATE**](/windows/desktop/api/Tapi3if/ne-tapi3if-call_state) enumerator</span></span>

 

 
