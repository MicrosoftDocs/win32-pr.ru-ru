---
description: В рамках абстракции телефонного устройства, определяемой ТСПИ, TAPI и поставщик услуг должны сначала выполнить базовую инициализацию.
ms.assetid: cd8bb328-fbd0-409c-8471-34ad4c2c8d93
title: Инициализация SPI на телефоне
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1d0c54e313c2be3846aeb604217f5324ec0d8a8d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683906"
---
# <a name="phone-spi-initialization"></a><span data-ttu-id="b45df-103">Инициализация SPI на телефоне</span><span class="sxs-lookup"><span data-stu-id="b45df-103">Phone SPI Initialization</span></span>

<span data-ttu-id="b45df-104">В рамках абстракции телефонного устройства, определяемой ТСПИ, TAPI и поставщик услуг должны сначала выполнить базовую инициализацию.</span><span class="sxs-lookup"><span data-stu-id="b45df-104">As part of the phone device abstraction defined by TSPI, TAPI and the service provider must first undergo basic initialization.</span></span> <span data-ttu-id="b45df-105">Эта базовая инициализация выполняется как для линий, так и для половины телефонного интерфейса с помощью одного набора шагов.</span><span class="sxs-lookup"><span data-stu-id="b45df-105">This basic initialization is accomplished both for the line and phone halves of the interface by the same set of steps.</span></span> <span data-ttu-id="b45df-106">Первый из этих шагов — согласование версии интерфейса.</span><span class="sxs-lookup"><span data-stu-id="b45df-106">The first of these steps is interface version negotiation.</span></span> <span data-ttu-id="b45df-107">TAPI выполняет это путем вызова функции [**тспи \_ линенеготиатетспиверсион**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiatetspiversion) .</span><span class="sxs-lookup"><span data-stu-id="b45df-107">TAPI performs this by calling the [**TSPI\_lineNegotiateTSPIVersion**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiatetspiversion) function.</span></span> <span data-ttu-id="b45df-108">Эта функция обычно используется для согласования от имени отдельного устройства. различные линейные устройства в пределах одного поставщика услуг могут действовать в соответствии с различными версиями интерфейса.</span><span class="sxs-lookup"><span data-stu-id="b45df-108">This function is usually used to negotiate on behalf of an individual line device; different line devices within the same service provider may operate according to different interface versions.</span></span> <span data-ttu-id="b45df-109">TAPI передает специальное зарезервированное значение идентификатора устройства, [**инициализирует \_ согласование**](initialize-negotiation.md), чтобы указать, что он выполняет согласование общей версии интерфейса для функций инициализации, влияющих на всех поставщиков служб, как для линий, так и для телефонов.</span><span class="sxs-lookup"><span data-stu-id="b45df-109">TAPI passes a special reserved device identifier value, [**INITIALIZE\_NEGOTIATION**](initialize-negotiation.md), to indicate that it is negotiating an overall interface version for initialization functions that affect the entire service provider, both for lines and phones.</span></span>

<span data-ttu-id="b45df-110">Результат этого согласования передается в последующие процедуры до тех пор, пока не будет открыто телефонное устройство.</span><span class="sxs-lookup"><span data-stu-id="b45df-110">The result of this negotiation is passed to subsequent procedures until a phone device is opened.</span></span> <span data-ttu-id="b45df-111">В это время телефонное устройство зафиксируется в определенной версии интерфейса.</span><span class="sxs-lookup"><span data-stu-id="b45df-111">At that time, the phone device becomes committed to a particular interface version.</span></span> <span data-ttu-id="b45df-112">Эта версия интерфейса является неявной до закрытия телефона и не требует передачи дальнейшим функциям, работающим на открытом телефоне.</span><span class="sxs-lookup"><span data-stu-id="b45df-112">This interface version is implicit until the phone is closed, and does not need to be passed to subsequent functions that operate on an opened phone.</span></span>

<span data-ttu-id="b45df-113">После согласования общей версии интерфейса TAPI вызывает функцию [**тспи \_ провидеринит**](/windows/win32/api/tspi/nf-tspi-tspi_providerinit) .</span><span class="sxs-lookup"><span data-stu-id="b45df-113">Following overall interface version negotiation, TAPI calls the [**TSPI\_providerInit**](/windows/win32/api/tspi/nf-tspi-tspi_providerinit) function.</span></span> <span data-ttu-id="b45df-114">Эта функция инициализирует поставщик службы, а также предоставляет параметры, необходимые для последующей операции.</span><span class="sxs-lookup"><span data-stu-id="b45df-114">This function initializes the service provider, also giving it parameters required for subsequent operation.</span></span> <span data-ttu-id="b45df-115">К этим параметрам относятся следующие.</span><span class="sxs-lookup"><span data-stu-id="b45df-115">These parameters include the following:</span></span>

-   <span data-ttu-id="b45df-116">*двперманентпровидерид*: указывает постоянный идентификатор инициализированного поставщика услуг, уникальный в пределах поставщиков служб в этой системе.</span><span class="sxs-lookup"><span data-stu-id="b45df-116">*dwPermanentProviderID*: Specifies the permanent identifier of the service provider being initialized, unique within the service providers on this system.</span></span>
-   <span data-ttu-id="b45df-117">*двлинедевицеидбасе*: Указывает самый низкий идентификатор устройства для устройств, поддерживаемых этим поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="b45df-117">*dwLineDeviceIDBase*: Specifies the lowest device identifier for the line devices supported by this service provider.</span></span>
-   <span data-ttu-id="b45df-118">*двфонедевицеидбасе*: Указывает самый низкий идентификатор устройства для телефонных устройств, поддерживаемых этим поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="b45df-118">*dwPhoneDeviceIDBase*: Specifies the lowest device identifier for the phone devices supported by this service provider.</span></span> <span data-ttu-id="b45df-119">Устройства класса телефонных устройств телефонии обозначаются целыми числами, начинающимися с нуля.</span><span class="sxs-lookup"><span data-stu-id="b45df-119">Devices of the telephony phone device class are identified by integers starting from zero.</span></span> <span data-ttu-id="b45df-120">Этот диапазон идентификаторов является непрерывным по всему диапазону телефонных устройств.</span><span class="sxs-lookup"><span data-stu-id="b45df-120">This range of identifiers is contiguous across the full range of phone devices.</span></span> <span data-ttu-id="b45df-121">Поскольку в одной системе может быть несколько поставщиков услуг, управляющих телефонными устройствами, каждый поставщик услуг получает непрерывную часть общего диапазона.</span><span class="sxs-lookup"><span data-stu-id="b45df-121">Because there may be multiple service providers managing phone devices in a single system, each service provider gets a contiguous portion of the total range.</span></span> <span data-ttu-id="b45df-122">Этот параметр сообщает поставщику службы наименьшее значение в его части диапазона.</span><span class="sxs-lookup"><span data-stu-id="b45df-122">This parameter tells the service provider the lowest value in its portion of the range.</span></span> <span data-ttu-id="b45df-123">Поставщик услуг, а не TAPI, отвечает за сопоставление этого диапазона переменных с собственными внутренними идентификаторами устройств.</span><span class="sxs-lookup"><span data-stu-id="b45df-123">The service provider, rather than TAPI, is responsible for mapping this variable range to its own internal device identifiers.</span></span> <span data-ttu-id="b45df-124">Это дает поставщику поставщика услуг достаточную гибкость при использовании идентификаторов устройств в расширениях для конкретных устройств, если это требуется.</span><span class="sxs-lookup"><span data-stu-id="b45df-124">This gives the service-provider vendor sufficient flexibility to use device identifiers in device-specific extensions if it wants.</span></span> <span data-ttu-id="b45df-125">Так как поставщик служб знает, какие идентификаторы устройств отображаются в параметрах и структурах данных, определенных интерфейсом TAPI, он может использовать последовательные идентификаторы устройств в параметрах модуля и структурах данных для конкретных устройств.</span><span class="sxs-lookup"><span data-stu-id="b45df-125">Because the service provider knows what device identifiers appear in TAPI-defined parameters and data structures, it can use consistent device identifiers in device-specific extension parameters and data structures.</span></span>
-   <span data-ttu-id="b45df-126">*двнумлинес*: определяет, сколько линий устройства поддерживает этот поставщик услуг.</span><span class="sxs-lookup"><span data-stu-id="b45df-126">*dwNumLines*: Specifies how many line devices this service provider supports.</span></span>
-   <span data-ttu-id="b45df-127">*двнумфонес*: определяет, сколько телефонных устройств поддерживает этот поставщик услуг.</span><span class="sxs-lookup"><span data-stu-id="b45df-127">*dwNumPhones*: Specifies how many phone devices this service provider supports.</span></span>
-   <span data-ttu-id="b45df-128">*лпфнкомплетионпрок*: Указывает процедуру, с помощью которой поставщик услуг сообщает о завершении всех асинхронных процедур в телефонах и телефонных устройствах.</span><span class="sxs-lookup"><span data-stu-id="b45df-128">*lpfnCompletionProc*: Specifies the procedure the service provider calls to report completion of all asynchronously operating procedures on line and phone devices.</span></span>

<span data-ttu-id="b45df-129">После [**тспи \_ провидеринит**](/windows/win32/api/tspi/nf-tspi-tspi_providerinit)могут быть выполнены нормальные операции, такие как открытие телефонов.</span><span class="sxs-lookup"><span data-stu-id="b45df-129">Following [**TSPI\_providerInit**](/windows/win32/api/tspi/nf-tspi-tspi_providerinit), normal operations such as opening phones can be carried out.</span></span>

 

 
