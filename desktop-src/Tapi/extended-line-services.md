---
description: Расширенные службы линии (или специальные службы для конкретных устройств) включают все расширения, определенные поставщиком услуг, в ТСПИ.
ms.assetid: 23519d23-27bd-422e-b3c4-00e0d0d93f9e
title: Расширенные службы линии
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbc1ce08d25633d33fd518d8686271c198ca5034
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683417"
---
# <a name="extended-line-services"></a><span data-ttu-id="eb97b-103">Расширенные службы линии</span><span class="sxs-lookup"><span data-stu-id="eb97b-103">Extended Line Services</span></span>

<span data-ttu-id="eb97b-104">Расширенные службы линии (или специальные службы для конкретных устройств) включают все расширения, определенные поставщиком услуг, в ТСПИ.</span><span class="sxs-lookup"><span data-stu-id="eb97b-104">Extended line services (or device-specific line services) include all service-provider defined extensions to TSPI.</span></span> <span data-ttu-id="eb97b-105">ТСПИ определяет механизм, позволяющий поставщикам поставщиков услуг расширить индекс SPI телефонии с помощью расширений для конкретных устройств.</span><span class="sxs-lookup"><span data-stu-id="eb97b-105">TSPI defines a mechanism that enables service-provider vendors to extend the Telephony SPI using device-specific extensions.</span></span> <span data-ttu-id="eb97b-106">ТСПИ определяет только механизм расширения, и это обеспечивает доступ к модулям, связанным с устройствами, но ТСПИ не определяет их поведение.</span><span class="sxs-lookup"><span data-stu-id="eb97b-106">TSPI only defines the extension mechanism, and by doing so provides access to device-specific extensions, but TSPI does not define their behavior.</span></span> <span data-ttu-id="eb97b-107">Поведение полностью определяется поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="eb97b-107">Behavior is completely defined by the service provider.</span></span>

<span data-ttu-id="eb97b-108">SPI телефонии состоит из скалярных и битовых определений констант флагов, структур данных, функций и сообщений обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="eb97b-108">The Telephony SPI consists of scalar and bit flag constant definitions, data structures, functions, and callback messages.</span></span> <span data-ttu-id="eb97b-109">Определяются процедуры, которые позволяют поставщику расширить большинство из них следующим образом.</span><span class="sxs-lookup"><span data-stu-id="eb97b-109">Procedures are defined that enable a vendor to extend most of these as follows.</span></span>

<span data-ttu-id="eb97b-110">Для расширяемых скалярных констант данных поставщик поставщика услуг может определять новые значения в указанном диапазоне.</span><span class="sxs-lookup"><span data-stu-id="eb97b-110">For extensible scalar data constants, a service-provider vendor can define new values in a specified range.</span></span> <span data-ttu-id="eb97b-111">Так как большинство констант данных имеют значение **DWORD**, обычно диапазон от 0X00000000 до 0x7FFFFFFF зарезервирован для распространенных будущих расширений, а 0x80000000 — по 0xFFFFFFFF — для расширений, зависящих от поставщика.</span><span class="sxs-lookup"><span data-stu-id="eb97b-111">As most data constants are **DWORD** s, typically the range 0x00000000 through 0x7FFFFFFF is reserved for common future extensions, while 0x80000000 through 0xFFFFFFFF are available for vendor-specific extensions.</span></span> <span data-ttu-id="eb97b-112">Предполагается, что поставщик определит значения, которые являются естественными расширениями типов данных, определенных ТСПИ.</span><span class="sxs-lookup"><span data-stu-id="eb97b-112">The assumption is that a vendor would define values that are natural extensions of the datatypes defined by TSPI.</span></span>

<span data-ttu-id="eb97b-113">Для переменных с расширенными битовыми флагами поставщик поставщика услуг может определять новые значения для указанных битов.</span><span class="sxs-lookup"><span data-stu-id="eb97b-113">For extensible bit flag data constants, a service-provider vendor can define new values for specified bits.</span></span> <span data-ttu-id="eb97b-114">Как большинство констант флагов имеют значение **DWORD**, обычно зарезервировано определенное число младших битов для распространенных расширений, а оставшиеся верхние доступны для расширений, зависящих от поставщика.</span><span class="sxs-lookup"><span data-stu-id="eb97b-114">As most bit flag constants are **DWORD** s, typically a specific number of the lower bits are reserved for common extensions while the remaining upper bits are available for vendor-specific extensions.</span></span> <span data-ttu-id="eb97b-115">Распространенным битовым флагам присваивается нулевой разряд. расширения, зависящие от поставщика, должны быть назначены с 31 бита.</span><span class="sxs-lookup"><span data-stu-id="eb97b-115">Common bit flags are assigned from bit zero up; vendor-specific extensions should be assigned from bit 31 down.</span></span> <span data-ttu-id="eb97b-116">Это обеспечивает максимальную гибкость при назначении битовых позиций общим расширениям и расширениям, зависящим от поставщика.</span><span class="sxs-lookup"><span data-stu-id="eb97b-116">This provides maximum flexibility in assigning bit positions to common extensions versus vendor-specific extensions.</span></span> <span data-ttu-id="eb97b-117">Предполагается, что поставщик определяет новые значения, которые являются естественными расширениями битовых флагов, определенных ТСПИ.</span><span class="sxs-lookup"><span data-stu-id="eb97b-117">A vendor is expected to define new values that are natural extensions of the bit flags defined by TSPI.</span></span>

<span data-ttu-id="eb97b-118">Расширяемые структуры данных имеют поле размера вариабли, зарезервированное для использования в конкретных устройствах.</span><span class="sxs-lookup"><span data-stu-id="eb97b-118">Extensible data structures have a variably sized field that is reserved for device-specific use.</span></span> <span data-ttu-id="eb97b-119">Вариабли размер, поставщик услуг определяет объем информации и интерпретацию.</span><span class="sxs-lookup"><span data-stu-id="eb97b-119">Being variably sized, the service provider decides the amount of information and the interpretation.</span></span> <span data-ttu-id="eb97b-120">Поставщик, определяющий поле для конкретного устройства, должен сделать эти естественные расширения исходной структуры данных, определенной ТСПИ.</span><span class="sxs-lookup"><span data-stu-id="eb97b-120">A vendor that defines a device-specific field is expected to make these natural extensions of the original data structure defined by TSPI.</span></span>

<span data-ttu-id="eb97b-121">Две функции, [**тспи \_ ЛинедевспеЦифик**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) и [**тспи \_ линедевспеЦификфеатуре**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature)и четыре связанных сообщения, [**Line \_ ДевспеЦифик**](/previous-versions/windows/desktop/legacy/ms725225(v=vs.85)), [**Line \_ каллдевспеЦифик**](line-calldevspecific.md), [**Line \_ девспеЦификфеатуре**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85))и [**Line \_ CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md), предлагают механизм расширения, зависящий от поставщика.</span><span class="sxs-lookup"><span data-stu-id="eb97b-121">Two functions, [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) and [**TSPI\_lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature), and four related messages, [**LINE\_DEVSPECIFIC**](/previous-versions/windows/desktop/legacy/ms725225(v=vs.85)), [**LINE\_CALLDEVSPECIFIC**](line-calldevspecific.md), [**LINE\_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)), and [**LINE\_CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md), offer a vendor-specific extension mechanism.</span></span> <span data-ttu-id="eb97b-122">Операция **\_ линедевспеЦифик тспи** и связанные строки \_ девспеЦифик и Line \_ каллдевспеЦифик позволяют клиентскому приложению Tapi32.dll доступ к строке, адресу или вызову функций, которые недоступны в базовых или дополнительных службах телефонии.</span><span class="sxs-lookup"><span data-stu-id="eb97b-122">The **TSPI\_lineDevSpecific** operation and associated LINE\_DEVSPECIFIC and LINE\_CALLDEVSPECIFIC messages allow the Tapi32.dll client application to access device-specific line, address, or call features that are unavailable in the Basic or Supplementary Telephony services.</span></span> <span data-ttu-id="eb97b-123">Профиль параметров функции [**тспи \_ линедевспеЦифик**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) является универсальным в этой незначительной интерпретации параметров с помощью тспи.</span><span class="sxs-lookup"><span data-stu-id="eb97b-123">The parameter profile of the [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) function is generic in that little interpretation of the parameters is made by TSPI.</span></span> <span data-ttu-id="eb97b-124">Параметры обработчика устройства имеют значения, определяемые ТСПИ, и переводятся соответствующим образом между приложением и поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="eb97b-124">Device-handle parameters have TSPI-defined meanings and are translated appropriately between the application and the service provider.</span></span> <span data-ttu-id="eb97b-125">Универсальные параметры просто передаются без изменений.</span><span class="sxs-lookup"><span data-stu-id="eb97b-125">Generic parameters are simply passed through unmodified.</span></span> <span data-ttu-id="eb97b-126">Интерпретация универсальных параметров определяется поставщиком услуг и должна быть понята любым приложениям, использующим их.</span><span class="sxs-lookup"><span data-stu-id="eb97b-126">The interpretation of the generic parameters is defined by the service provider and must be understood by any applications that use them.</span></span> <span data-ttu-id="eb97b-127">Приложение, которое использует расширения для конкретных устройств, обычно не работает с другими поставщиками служб.</span><span class="sxs-lookup"><span data-stu-id="eb97b-127">An application that relies on device-specific extensions generally does not work with other service providers.</span></span> <span data-ttu-id="eb97b-128">Однако приложения, полностью написанные для базовых и дополнительных служб телефонии, должны работать с расширенным поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="eb97b-128">However, applications written entirely to the Basic and Supplementary Telephony services should work with the extended service provider.</span></span>

<span data-ttu-id="eb97b-129">Реализация интерфейса TAPI для функций и сообщений конкретного устройства является сквозной.</span><span class="sxs-lookup"><span data-stu-id="eb97b-129">The TAPI implementation of the device-specific functions and messages is "pass-through."</span></span> <span data-ttu-id="eb97b-130">TAPI не проверяет и не изменяет универсальные параметры и буферы для конкретного устройства, но сопоставляет значения прозрачности на уровне приложения (используемые на уровне TAPI) со значениями непрозрачных обработчиков на уровне поставщика услуг (используемые на уровне ТСПИ).</span><span class="sxs-lookup"><span data-stu-id="eb97b-130">TAPI does not examine or modify the generic device-specific parameters and buffers, but it does map application-level opaque handle values (used at the TAPI level) to service-provider-level opaque handle values (used at the TSPI level).</span></span>

<span data-ttu-id="eb97b-131">В отношении преобразования маркеров транзитная природа универсальных частей расширений для конкретных устройств имеет важное следствие.</span><span class="sxs-lookup"><span data-stu-id="eb97b-131">Regarding handle translation, the passthrough nature of the generic parts of device-specific extensions has an important consequence.</span></span> <span data-ttu-id="eb97b-132">Поставщик услуг не имеет возможности связывать дескрипторы, используемые на уровне ТСПИ, с ними на уровне TAPI, за исключением передачи их через предопределенные параметры и поля дескриптора.</span><span class="sxs-lookup"><span data-stu-id="eb97b-132">A service provider has no way to relate the handles used at the TSPI level to those at the TAPI level except by passing them through the predefined handle parameters and fields.</span></span> <span data-ttu-id="eb97b-133">Все маркеры, помещаемые в область универсального расширения, не переводятся TAPI, так как он передается между приложением и поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="eb97b-133">Any handle put into the generic extension area is untranslated by TAPI as it is passed between application and service provider.</span></span> <span data-ttu-id="eb97b-134">Разработчик расширения поставщика услуг обычно не должен определять расширения, которые передают дескрипторы таким образом.</span><span class="sxs-lookup"><span data-stu-id="eb97b-134">The designer of a service-provider extension should generally not define extensions that pass handles in this way.</span></span>

<span data-ttu-id="eb97b-135">При определении расширения для конкретного устройства, которое должно ссылаться на конкретные устройства без использования дескрипторов, следует ссылаться на них, используя абсолютную идентификацию устройства.</span><span class="sxs-lookup"><span data-stu-id="eb97b-135">The appropriate approach when defining a device-specific extension that must refer to specific devices without using handles is to refer to them using their absolute device identification.</span></span> <span data-ttu-id="eb97b-136">Например, идентификатор устройства, используемый при открытии строки на уровне TAPI, является строго тем же значением, которое используется на уровне ТСПИ для открытия строки.</span><span class="sxs-lookup"><span data-stu-id="eb97b-136">The device identifier used in opening a line at the TAPI level, for example, is strictly the same value that is used at the TSPI level to open the line.</span></span> <span data-ttu-id="eb97b-137">Аналогичным образом, кортеж (идентификатор устройства линии, идентификатор адреса), однозначно определяющий адрес на уровне TAPI, использует те же значения для идентификации на уровне ТСПИ.</span><span class="sxs-lookup"><span data-stu-id="eb97b-137">Similarly, a (line device identifier, address identifier) tuple that uniquely identifies an address at the TAPI level uses the same values to identify the same thing at the TSPI level.</span></span>

<span data-ttu-id="eb97b-138">Для удобства также предоставляется более специализированная Escape-функция.</span><span class="sxs-lookup"><span data-stu-id="eb97b-138">For convenience, a more specialized escape function is also provided.</span></span> <span data-ttu-id="eb97b-139">Он похож на [**тспи \_ линедевспеЦифик**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific), но раскладывает интерпретацию некоторых параметров.</span><span class="sxs-lookup"><span data-stu-id="eb97b-139">It is similar to [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific), but places interpretation on some of the parameters.</span></span> <span data-ttu-id="eb97b-140">Функция [**тспи \_ линедевспеЦификфеатуре**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) и связанные [**строки \_ девспеЦификфеатуре**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) и [**Line \_ каллдевспеЦификфеатуре**](line-calldevspecificfeature.md) messages позволяют TAPI имитировать нажатия кнопки в телефоне функции.</span><span class="sxs-lookup"><span data-stu-id="eb97b-140">The [**TSPI\_lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) function and associated [**LINE\_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) and [**LINE\_CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md) messages allow TAPI to emulate button presses at the line's feature phone.</span></span> <span data-ttu-id="eb97b-141">По мере того, как телефоны функций и их кнопки относятся к конкретному поставщику, вызов функции с помощью **тспи \_ линедевспеЦификфеатуре** также зависит от поставщика.</span><span class="sxs-lookup"><span data-stu-id="eb97b-141">As feature phones and the meanings of their buttons are vendor-specific, feature invocation using **TSPI\_lineDevSpecificFeature** is also vendor specific.</span></span>

<span data-ttu-id="eb97b-142">Для суммирования функция [**тспи \_ линедевспеЦификфеатуре**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) — это функция экранирования для конкретного устройства, позволяющая отправлять функции переключения в коммутатор.</span><span class="sxs-lookup"><span data-stu-id="eb97b-142">To summarize, the [**TSPI\_lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) function is a device-specific escape function to allow sending switch features to the switch.</span></span> <span data-ttu-id="eb97b-143">Сообщение [**Line \_ каллдевспеЦификфеатуре**](line-calldevspecificfeature.md) — это сообщение для конкретного устройства, отправляемое в ответный вызов приложения, как указание функций, относящихся к вызову, отправляемых в коммутатор.</span><span class="sxs-lookup"><span data-stu-id="eb97b-143">The [**LINE\_CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md) message is a device-specific message sent to the application's callback as an indication of call-related features sent to the switch.</span></span> <span data-ttu-id="eb97b-144">[**Строка \_ ДЕВСПЕЦИФИКФЕАТУРЕ**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) — это сообщение для конкретного устройства, отправляемое в ответный вызов приложения, в качестве обозначения функций, относящихся к строке, отправляемых в коммутатор.</span><span class="sxs-lookup"><span data-stu-id="eb97b-144">[**LINE\_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) is a device-specific message sent to the application's callback as an indication of line-related features sent to the switch.</span></span>

<span data-ttu-id="eb97b-145">Отсутствует центральный реестр для идентификаторов производителей.</span><span class="sxs-lookup"><span data-stu-id="eb97b-145">There is no central registry for manufacturer identifiers.</span></span> <span data-ttu-id="eb97b-146">Вместо этого можно использовать уникальный генератор идентификаторов, именуемый Extidgen.exe, в составе ТСПИ.</span><span class="sxs-lookup"><span data-stu-id="eb97b-146">Instead a unique identifier generator called Extidgen.exe is made available as part of TSPI.</span></span> <span data-ttu-id="eb97b-147">Поставщик, который разрабатывает набор расширений для конкретных устройств, использует эту служебную программу для получения уникальных идентификаторов для этих расширений.</span><span class="sxs-lookup"><span data-stu-id="eb97b-147">The vendor that designs a set of device-specific extensions uses this utility to obtain a unique identifier for those extensions.</span></span>

 

 
