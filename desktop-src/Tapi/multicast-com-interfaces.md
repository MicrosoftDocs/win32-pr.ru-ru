---
description: Многоадресные интерфейсы COM обеспечивают доступ к сети для выделения, продления и освобождения аренд на адресах многоадресной рассылки.
ms.assetid: d4da9616-bdb4-4919-96aa-9e45582b05dd
title: Многоадресные COM-интерфейсы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 01370372e3ea05b27dc789f90918b148075c28f5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103808297"
---
# <a name="multicast-com-interfaces"></a><span data-ttu-id="f0d8d-103">Многоадресные COM-интерфейсы</span><span class="sxs-lookup"><span data-stu-id="f0d8d-103">Multicast COM Interfaces</span></span>

<span data-ttu-id="f0d8d-104">\[ В Windows Vista, Windows Server 2008 и последующих версиях операционной системы нельзя использовать встречные средства и элементы управления Конференц-телефонией и интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-104">\[ Rendezvous IP Telephony Conferencing controls and interfaces are not available for use in Windows Vista, Windows Server 2008, and subsequent versions of the operating system.</span></span> <span data-ttu-id="f0d8d-105">API клиента RTC предоставляет аналогичные функциональные возможности.\]</span><span class="sxs-lookup"><span data-stu-id="f0d8d-105">The RTC Client API provides similar functionality.\]</span></span>

<span data-ttu-id="f0d8d-106">Многоадресные интерфейсы COM обеспечивают доступ к сетевому оборудованию для выделения, продления и освобождения аренд на адресах многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-106">The multicast COM interfaces allow access to the network's facility for allocating, renewing, and releasing leases on multicast addresses.</span></span> <span data-ttu-id="f0d8d-107">Они инкапсулируют набор определений функций и структур данных.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-107">They encapsulate a set of function and data structure definitions.</span></span> <span data-ttu-id="f0d8d-108">COM-интерфейсы освобождают программиста от затрат на понимание и управление этими структурами данных.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-108">The COM interfaces free the programmer from the burden of understanding and manipulating these data structures.</span></span> <span data-ttu-id="f0d8d-109">Более того, поскольку интерфейс TAPI 3 является основанным на COM, эти интерфейсы обеспечивают доступ к распределению адресов по адресу таким образом, который согласуется с другими средствами, предоставляемыми TAPI 3.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-109">Moreover, because TAPI 3 itself is COM-based, these interfaces make multicast address allocation accessible in a way that is consistent with the other facilities provided by TAPI 3.</span></span> <span data-ttu-id="f0d8d-110">Приложения, написанные с использованием Visual Basic, Java или языков сценариев, которые обычно не обращаются к API Windows напрямую, могут использовать эти интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-110">Applications written using Visual Basic, Java, or scripting languages that cannot normally access the Windows API directly are able to use these interfaces.</span></span>

<span data-ttu-id="f0d8d-111">Распределение адресов многоадресной рассылки в настоящее время является темой рабочей группы IETF.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-111">Multicast address allocation is currently the subject of an IETF working group.</span></span> <span data-ttu-id="f0d8d-112">Чтобы получить доступ к текущим сведениям, выполните запрос по запросу "МДХКП" или "MADCAP" и "Internet черновик" с помощью любой поисковой системы в Интернете.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-112">To access current information, query on "MDHCP" or "MADCAP" and "Internet draft" using any Internet search engine.</span></span> <span data-ttu-id="f0d8d-113">Помимо MADCAP, Предлагаемая архитектура включает протокол для координации между серверами в домене или как, а также протокол для междоменной координации.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-113">In addition to MADCAP, the proposed architecture includes a protocol for server-to-server coordination within a domain or AS, as well as a protocol for interdomain coordination.</span></span> <span data-ttu-id="f0d8d-114">Несмотря на то, что эта архитектура в настоящее время развивается, клиенту не нужно придуматься к деталям этой схемы.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-114">While this architecture is currently evolving, the client need not concern itself with the details of this scheme.</span></span>

<span data-ttu-id="f0d8d-115">Сейчас этот компонент поддерживает только IP-адреса версии 4.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-115">This component currently supports only IP version 4 addresses.</span></span>

> [!Note]  
> <span data-ttu-id="f0d8d-116">Протокол, используемый для этих интерфейсов, в настоящее время называется MADCAP.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-116">The protocol used for these interfaces is currently named MADCAP.</span></span> <span data-ttu-id="f0d8d-117">В предыдущих версиях он назывался МДХКП.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-117">In previous versions it was known as MDHCP.</span></span>

 

<span data-ttu-id="f0d8d-118">Объект многоадресной рассылки создается путем вызова **CoCreateInstance** для интерфейса [**имкастаддрессаллокатион**](/windows/desktop/api/Mdhcp/nn-mdhcp-imcastaddressallocation) .</span><span class="sxs-lookup"><span data-stu-id="f0d8d-118">The multicast object is created by calling **CoCreateInstance** on the [**IMcastAddressAllocation**](/windows/desktop/api/Mdhcp/nn-mdhcp-imcastaddressallocation) interface.</span></span> <span data-ttu-id="f0d8d-119">Интерфейс **имкастаддрессаллокатион** предоставляет метод [**енумератескопес**](/windows/desktop/api/Mdhcp/nf-mdhcp-imcastaddressallocation-enumeratescopes) , позволяющий приложению получить список всех доступных многоадресных областей.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-119">The **IMcastAddressAllocation** interface exposes the [**EnumerateScopes**](/windows/desktop/api/Mdhcp/nf-mdhcp-imcastaddressallocation-enumeratescopes) method, which allows an application to get a list of all available multicast scopes.</span></span>

<span data-ttu-id="f0d8d-120">После получения рабочей области метод [**рекуестаддресс**](/windows/desktop/api/Mdhcp/nf-mdhcp-imcastaddressallocation-requestaddress) используется для запроса адреса многоадресной рассылки с сервера.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-120">Once a working scope has been obtained, the [**RequestAddress**](/windows/desktop/api/Mdhcp/nf-mdhcp-imcastaddressallocation-requestaddress) method is used to request a multicast address from the server.</span></span> <span data-ttu-id="f0d8d-121">Если запрос выполнен успешно, возвращается указатель [**имкастлеасеинфо**](/windows/desktop/api/Mdhcp/nn-mdhcp-imcastleaseinfo) .</span><span class="sxs-lookup"><span data-stu-id="f0d8d-121">If the request is successful, an [**IMcastLeaseInfo**](/windows/desktop/api/Mdhcp/nn-mdhcp-imcastleaseinfo) pointer is returned.</span></span> <span data-ttu-id="f0d8d-122">Затем метод [**енумератеаддрессес**](/windows/desktop/api/Mdhcp/nf-mdhcp-imcastleaseinfo-enumerateaddresses) , предоставляемый этим интерфейсом, можно использовать для получения адресов.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-122">The [**EnumerateAddresses**](/windows/desktop/api/Mdhcp/nf-mdhcp-imcastleaseinfo-enumerateaddresses) method exposed by this interface can then be used to obtain the addresses.</span></span>

<span data-ttu-id="f0d8d-123">Каждый объект мультимедиа, связанный с Конференцией, предоставляет интерфейс [**итконнектион**](itconnection.md) .</span><span class="sxs-lookup"><span data-stu-id="f0d8d-123">Each Media object associated with the conference exposes an [**ITConnection**](itconnection.md) interface.</span></span> <span data-ttu-id="f0d8d-124">Метод [**итконнектион:: сетаддрессинфо**](itconnection-setaddressinfo.md) позволяет назначать адреса многоадресной рассылки, полученные для носителя Конференции.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-124">The [**ITConnection::SetAddressInfo**](itconnection-setaddressinfo.md) method allows assignment of the multicast addresses obtained to the media of the conference.</span></span> <span data-ttu-id="f0d8d-125">Адрес должен быть задан для каждого интерфейса **итконнектион** каждого объекта мультимедиа, связанного с Конференцией.</span><span class="sxs-lookup"><span data-stu-id="f0d8d-125">The address must be set for each **ITConnection** interface of every Media object associated with the conference.</span></span>

 

 



