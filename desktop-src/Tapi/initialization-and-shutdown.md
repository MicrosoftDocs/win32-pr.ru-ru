---
description: Чтобы приложение использовало любую из интерфейсов TAPI, поддерживающих 30 дополнительных телефонных функций, ему требуется подключение к TAPI, через которое он может получить сообщения.
ms.assetid: c0211f64-4f73-4348-ae49-9a898d3aa093
title: Инициализация и завершение работы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6831b8cfda84ac564450caec554191198fd4c21f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673413"
---
# <a name="initialization-and-shutdown"></a><span data-ttu-id="b555c-103">Инициализация и завершение работы</span><span class="sxs-lookup"><span data-stu-id="b555c-103">Initialization and Shutdown</span></span>

<span data-ttu-id="b555c-104">Чтобы приложение использовало любой из 30 дополнительных функций телефона TAPI, ему требуется подключение к TAPI, через которое он может получить сообщения.</span><span class="sxs-lookup"><span data-stu-id="b555c-104">For an application to use any of TAPI's 30 supplementary phone functions, it needs a connection to TAPI, through which it can receive messages.</span></span> <span data-ttu-id="b555c-105">Приложение устанавливает это подключение с помощью функции [**фонеинитиализикс**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) .</span><span class="sxs-lookup"><span data-stu-id="b555c-105">The application establishes this connection using the [**phoneInitializeEx**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) function.</span></span> <span data-ttu-id="b555c-106">В этой функции приложение указывает механизм уведомления, по которому TAPI информирует приложение об изменениях в состоянии телефона и асинхронном завершении телефонных функций.</span><span class="sxs-lookup"><span data-stu-id="b555c-106">In this function, the application specifies the notification mechanism by which TAPI informs the application of changes in the state of the phone and of asynchronous completion of phone functions.</span></span>

<span data-ttu-id="b555c-107">Функция [**фонеинитиализикс**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) возвращает приложению два фрагмента информации: *обработчик приложения* и число телефонных устройств.</span><span class="sxs-lookup"><span data-stu-id="b555c-107">The [**phoneInitializeEx**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) function returns two pieces of information to the application: an *application handle*, and the number of phone devices.</span></span> <span data-ttu-id="b555c-108">Маркер приложения представляет использование приложения TAPI.</span><span class="sxs-lookup"><span data-stu-id="b555c-108">The application handle represents the application's usage of TAPI.</span></span> <span data-ttu-id="b555c-109">Функции TAPI, использующие дескрипторы телефона, не нуждаются в дескрипторе приложения, так как этот дескриптор является производным от указанного дескриптора телефона.</span><span class="sxs-lookup"><span data-stu-id="b555c-109">The TAPI functions that use phone handles do not require the application handle, as this handle is derived from the specified phone handle.</span></span>

<span data-ttu-id="b555c-110">Второй фрагмент данных, возвращаемых функцией [**фонеинитиализикс**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) , — число телефонных устройств, доступных для TAPI.</span><span class="sxs-lookup"><span data-stu-id="b555c-110">The second piece of information returned by [**phoneInitializeEx**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) is the number of phone devices available to TAPI.</span></span> <span data-ttu-id="b555c-111">Телефонные устройства идентифицируются по идентификатору устройства (*идентификатору устройства*).</span><span class="sxs-lookup"><span data-stu-id="b555c-111">Phone devices are identified by their device identifier (*device ID*).</span></span> <span data-ttu-id="b555c-112">Допустимые идентификаторы устройств находятся в диапазоне от нуля до количества телефонных устройств минус единица.</span><span class="sxs-lookup"><span data-stu-id="b555c-112">Valid device identifiers range from zero to the number of phone devices minus one.</span></span> <span data-ttu-id="b555c-113">Например, если **фонеинитиализикс** сообщает о наличии двух телефонных устройств в системе, допустимые идентификаторы телефонных устройств: 0 и 1.</span><span class="sxs-lookup"><span data-stu-id="b555c-113">For example, if **phoneInitializeEx** reports that there are two phone devices in a system, then valid phone device identifiers are 0 and 1.</span></span> <span data-ttu-id="b555c-114">После завершения работы приложения с помощью функций телефона TAPI вызывает [**фонешутдовн**](/windows/desktop/api/Tapi/nf-tapi-phoneshutdown), передавая его обработчику приложения, чтобы завершить использование TAPI.</span><span class="sxs-lookup"><span data-stu-id="b555c-114">After an application is finished using the phone functions of TAPI, it invokes [**phoneShutdown**](/windows/desktop/api/Tapi/nf-tapi-phoneshutdown), passing its application handle to shut down its usage of TAPI.</span></span> <span data-ttu-id="b555c-115">Это позволяет TAPI освобождать все ресурсы, назначенные приложению.</span><span class="sxs-lookup"><span data-stu-id="b555c-115">This allows TAPI to free any resources assigned to the application.</span></span>

<span data-ttu-id="b555c-116">Приложения не должны вызывать [**фонеинитиализикс**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) , не открывая телефон (по крайней мере для мониторинга).</span><span class="sxs-lookup"><span data-stu-id="b555c-116">Applications should not invoke [**phoneInitializeEx**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) without subsequently opening a phone (at least for monitoring).</span></span> <span data-ttu-id="b555c-117">Если приложение не отслеживает и не использует какие-либо устройства, оно должно вызывать [**фонешутдовн**](/windows/desktop/api/Tapi/nf-tapi-phoneshutdown) , чтобы ресурсы памяти, выделенные библиотекой динамической КОМПОНОВКИ (TAPI), могли быть освобождены в случае ненадобности, а сама библиотека может быть выгружена из памяти, пока не потребуется.</span><span class="sxs-lookup"><span data-stu-id="b555c-117">If the application is not monitoring and not using any devices, it should call [**phoneShutdown**](/windows/desktop/api/Tapi/nf-tapi-phoneshutdown) so that memory resources allocated by the TAPI dynamic-link library can be released if unneeded, and the library itself can be unloaded from memory while not needed.</span></span>

<span data-ttu-id="b555c-118">Как [**фонеинитиализикс**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) , так и [**фонешутдовн**](/windows/desktop/api/Tapi/nf-tapi-phoneshutdown) работают синхронно.</span><span class="sxs-lookup"><span data-stu-id="b555c-118">Both [**phoneInitializeEx**](/windows/desktop/api/Tapi/nf-tapi-phoneinitializeexa) and [**phoneShutdown**](/windows/desktop/api/Tapi/nf-tapi-phoneshutdown) operate synchronously.</span></span> <span data-ttu-id="b555c-119">То есть эти функции возвращают сведения об успешном или неудачном завершении и никогда не возвращают идентификатор асинхронного запроса.</span><span class="sxs-lookup"><span data-stu-id="b555c-119">That is, these functions either return a success or failure indication, and never return an asynchronous request identifier.</span></span>

 

 



