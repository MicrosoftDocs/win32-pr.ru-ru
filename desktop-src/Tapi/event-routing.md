---
description: С помощью функции Линесеттерминал приложение может контролировать или подавлять маршрутизацию указанных низкоуровневых событий (обмен между коммутатором и станцией) к устройству.
ms.assetid: 36658d83-0ea4-4f62-b2e5-c0f6d6569d0d
title: Маршрутизация событий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df6749969faf89ac0212c19049fe02c9dad57a96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105682691"
---
# <a name="event-routing"></a><span data-ttu-id="2db72-103">Маршрутизация событий</span><span class="sxs-lookup"><span data-stu-id="2db72-103">Event Routing</span></span>

<span data-ttu-id="2db72-104">С помощью функции [**линесеттерминал**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal) приложение может контролировать или подавлять маршрутизацию указанных низкоуровневых событий (обмен между коммутатором и станцией) к устройству.</span><span class="sxs-lookup"><span data-stu-id="2db72-104">With the [**lineSetTerminal**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal) function, the application can control or suppress the routing of specified low-level events (exchanged between the switch and the station) to a device.</span></span> <span data-ttu-id="2db72-105">При использовании **линесеттерминал** в приложении указывается устройство терминала, на которое направляются эти события (например, линия, адрес или потоковые события потока мультимедиа).</span><span class="sxs-lookup"><span data-stu-id="2db72-105">With **lineSetTerminal**, the application specifies the terminal device to which these events (such as line, address, or call media-stream events) are routed.</span></span>

<span data-ttu-id="2db72-106">Маршрутизацию различных классов событий можно контролировать по отдельности, что позволяет указывать отдельные терминалы для каждого класса событий.</span><span class="sxs-lookup"><span data-stu-id="2db72-106">The routing of the different classes of events can be individually controlled, allowing separate terminals to be specified for each event class.</span></span> <span data-ttu-id="2db72-107">Классы событий включают ламп, кнопки, экран, круг, хуксвитч и поток мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="2db72-107">Event classes include lamps, buttons, display, ringer, hookswitch, and media stream.</span></span>

<span data-ttu-id="2db72-108">Например, поток мультимедиа вызова (например, голоса) может быть отправлен на любое устройство преобразователя, если поставщик услуг и оборудование способны это сделать.</span><span class="sxs-lookup"><span data-stu-id="2db72-108">For example, the media stream of a call (voice, for example) can be sent to any transducer device if the service provider and the hardware is capable of doing so.</span></span> <span data-ttu-id="2db72-109">Как правило, *преобразователь* означает то же, что и устройство *хуксвитч* в TAPI, что имеет микрофон и докладчик.</span><span class="sxs-lookup"><span data-stu-id="2db72-109">In general, a *transducer* means the same as what is referred to as a *hookswitch* device in TAPI, something that has a microphone and a speaker.</span></span> <span data-ttu-id="2db72-110">События звонка с коммутатора на телефон можно сопоставить с визуальным оповещением на экране компьютера или направить на телефонное устройство.</span><span class="sxs-lookup"><span data-stu-id="2db72-110">Ring events from the switch to the phone can be mapped into a visual alert on the computer's screen or they can be routed to a phone device.</span></span> <span data-ttu-id="2db72-111">События лампы и события отображения могут быть пропущены или направлены на телефонное устройство (которое кажется обычным телефонным набором).</span><span class="sxs-lookup"><span data-stu-id="2db72-111">Lamp events and display events can be ignored or routed to a phone device (which appears to behave as a normal phone set).</span></span> <span data-ttu-id="2db72-112">Наконец, нажатие кнопки на телефонном устройстве может быть или не передано в строку.</span><span class="sxs-lookup"><span data-stu-id="2db72-112">Finally, button presses at a phone device may or may not be passed to the line.</span></span> <span data-ttu-id="2db72-113">В любом случае такая маршрутизация низкоуровневых сигналов из линии не влияет на работу строки в интерфейсе TAPI, которая всегда сопоставляет низкоуровневые события с их функциональным аналогом.</span><span class="sxs-lookup"><span data-stu-id="2db72-113">In any case, this routing of low-level signals from the line does not affect the operation of the line portion of TAPI, which always maps low-level events to their functional equivalent.</span></span> <span data-ttu-id="2db72-114">Чтобы определить терминалы, доступные для линейного устройства (и их возможности), изучите возможности линейного устройства с помощью [**линежетдевкапс**](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps).</span><span class="sxs-lookup"><span data-stu-id="2db72-114">To determine the terminals a line device has available (and their capabilities), consult the line device's capabilities with [**lineGetDevCaps**](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps).</span></span>

<span data-ttu-id="2db72-115">Сначала предположим, что приложение подавляет маршрутизацию всех событий (с помощью [**линесеттерминал**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal)), и пользователь выбирает гарнитуру в качестве текущего устройства ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="2db72-115">Assume initially that the application has suppressed the routing of all events (with [**lineSetTerminal**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal)), and the user selects a headset as the current I/O device.</span></span> <span data-ttu-id="2db72-116">Входящий вызов отправляет сообщение [**Line \_ каллстате**](line-callstate.md) и сообщение [**Line \_ линедевстате**](line-linedevstate.md) с индикатором *звонка* .</span><span class="sxs-lookup"><span data-stu-id="2db72-116">An incoming call sends a [**LINE\_CALLSTATE**](line-callstate.md) message, and a [**LINE\_LINEDEVSTATE**](line-linedevstate.md) message with the *ringing* indication.</span></span> <span data-ttu-id="2db72-117">Так как маршрутизация всех событий подавляется, события кольца не направляются на телефон, поэтому звонок подавляется.</span><span class="sxs-lookup"><span data-stu-id="2db72-117">Because routing of all events is suppressed, ring events are not routed to the phone, so ringing is suppressed.</span></span> <span data-ttu-id="2db72-118">Вместо этого приложение уведомляет пользователя с помощью всплывающего диалогового окна и системного звукового сигнала на гарнитуре.</span><span class="sxs-lookup"><span data-stu-id="2db72-118">Instead, the application notifies the user with a pop-up dialog box and a system beep in the headset.</span></span>

<span data-ttu-id="2db72-119">Пользователь решает ответить на вызов.</span><span class="sxs-lookup"><span data-stu-id="2db72-119">The user decides to answer the call.</span></span> <span data-ttu-id="2db72-120">Поскольку текущее устройство ввода-вывода пользователя является гарнитурой, приложение телефонии вызывает [**линесеттерминал**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal) во входящем вызове для направления носителя звонка на гарнитуру и ответа на вызов.</span><span class="sxs-lookup"><span data-stu-id="2db72-120">Because the user's current I/O device is the headset, the telephony application invokes [**lineSetTerminal**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal) on the incoming call to route the call's media to the headset and answer the call.</span></span> <span data-ttu-id="2db72-121">Приложение может также вызвать **линесеттерминал** , чтобы перенаправить лампу и отобразить события информации в набор телефонных номеров, чтобы он будет вести себя как обычно.</span><span class="sxs-lookup"><span data-stu-id="2db72-121">The application may also invoke **lineSetTerminal** to route lamp and display information events to the phone set so that it will behave as usual.</span></span>

<span data-ttu-id="2db72-122">Во втором примере предположим, что входящий вызов уведомляется на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="2db72-122">As a second example, assume that an incoming call is alerting at the user's computer.</span></span> <span data-ttu-id="2db72-123">Вместо того чтобы выбирать вариант ответа с помощью мыши, пользователь решает просто выбрать телефонную трубку для ответа на звонок.</span><span class="sxs-lookup"><span data-stu-id="2db72-123">Instead of selecting the answer option with the mouse, the user decides to just pick up the phone's handset to answer the call.</span></span> <span data-ttu-id="2db72-124">Состояние оффхук на телефоне отправляет в приложение сообщение.</span><span class="sxs-lookup"><span data-stu-id="2db72-124">The offhook status at the phone sends a message to the application.</span></span> <span data-ttu-id="2db72-125">Приложение может интерпретировать это состояние как запрос от пользователя, чтобы выбрать телефонную трубку для проведения диалога.</span><span class="sxs-lookup"><span data-stu-id="2db72-125">The application can interpret this status as a request by the user to select the phone handset to conduct the conversation.</span></span> <span data-ttu-id="2db72-126">Затем приложение вызывает [**линесеттерминал**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal) для маршрутизации голоса данных при вызове к набору телефонных номеров.</span><span class="sxs-lookup"><span data-stu-id="2db72-126">The application then invokes [**lineSetTerminal**](/windows/desktop/api/Tapi/nf-tapi-linesetterminal) to route the voice data on the call to the phone set.</span></span>

 

 



