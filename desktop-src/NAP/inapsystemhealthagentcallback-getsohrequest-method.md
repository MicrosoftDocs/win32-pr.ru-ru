---
title: Метод Инапсистемхеалсаженткаллбакк Жетсохрекуест (Напсистемхеалсажент. h)
description: Вызывается с помощью Напажент для запроса агента работоспособности системы.
ms.assetid: 4161a3e7-2f7a-40d1-b973-47f991bba5d0
keywords:
- Метод Жетсохрекуест NAP
- Метод Жетсохрекуест NAP, интерфейс Инапсистемхеалсаженткаллбакк
- Инапсистемхеалсаженткаллбакк интерфейса NAP, метод Жетсохрекуест
topic_type:
- apiref
api_name:
- INapSystemHealthAgentCallback.GetSoHRequest
api_location:
- NapSystemHealthAgent.h
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: d6c9203a782be34be66e84fa8238a678647a4359df8cde3408aa8de99e73fcce
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118133773"
---
# <a name="inapsystemhealthagentcallbackgetsohrequest-method"></a>Метод Инапсистемхеалсаженткаллбакк:: Жетсохрекуест

> [!Note]  
> Платформа защиты доступа к сети недоступна начиная с Windows 10

 

Метод **инапсистемхеалсаженткаллбакк:: жетсохрекуест** вызывается напажент, чтобы запросить запрос SoH агента работоспособности системы.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT GetSoHRequest(
  [in] INapSystemHealthAgentRequest *request
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*запрос* \[ окне\]
</dt> <dd>

Указатель COM на объект [**инапсистемхеалсажентрекуест**](inapsystemhealthagentrequest.md) , который идентифицирует объект запроса.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение



| Код возврата                                                                                                                      | Описание                                                                                                                                        |
|----------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>**\_ОК**</dt> </dl>                                             | Указывает на успешное завершение.<br/>                                                                                                                      |
| <dl> <dt>**HRESULT \_ из \_ Win32 ( \_ сервер RPC \_ S \_ недоступен)**</dt> </dl> | Если этот код возвращается вашей реализацией, Напажент удаляет SHA из списка связанных-SHA и очищает его запись кэша.<br/> |



 

Если ваша реализация возвращает любое возвращаемое значение (за исключением **HRESULT \_ из \_ Win32 ( \_ сервер RPC S \_ \_ недоступен)**), система защиты доступа к сети конструирует и возвращает [**сохрекуест**](/windows/win32/api/naptypes/ns-naptypes-soh) соответствующему SHV со следующими типами атрибутов и значениями:

-   [**сохаттрибутетипесистемхеалсид**](sohattributetype-enum.md)= <id>
-   [**сохаттрибутетипефаилурекатегори**](sohattributetype-enum.md) =  [ **фаилурекатегориклиенткомпонент**](/windows/win32/api/naptypes/ne-naptypes-failurecategory)
-   [**сохаттрибутетипирроркодес**](sohattributetype-enum.md) = <ошибка — код>

## <a name="remarks"></a>Remarks

Этот метод обратного вызова объявляется системой защиты доступа к сети и реализуется модулем записи SHA.

Этот метод должен обработать запрос и вернуться немедленно. Задержка возврата этого метода негативно влияет на производительность и скорость реагирования системы и может привести к истечению времени ожидания других частей операционной системы.

Наблюдение за состоянием работоспособности не следует выполнять в рамках этого вызова, особенно в случае интенсивного выполнения вычислений и занимает много времени. Наблюдение за состоянием работоспособности и вычисление работоспособности следует выполнять в отдельном потоке или службе. Единственной функцией этого метода должно быть задание SoH SHA и возврат.

Если агент SHA создаст состояние работоспособности, то в Напажент будет возвращено кэшированное состояние работоспособности. Если нет кэшированного состояния работоспособности для возврата, SHA должен немедленно вернуть SoH со следующими типами атрибутов и значениями:

-   [**сохаттрибутетипесистемхеалсид**](sohattributetype-enum.md)= <id>
-   [**сохаттрибутетипефаилурекатегори**](sohattributetype-enum.md) =  [ **фаилурекатегориклиенткоммуникатион**](/windows/win32/api/naptypes/ne-naptypes-failurecategory)
-   [**сохаттрибутетипирроркодес**](sohattributetype-enum.md)  =  [ **Защита доступа к сети \_ E \_ без \_ кэшированного \_ состояния работоспособности**](nap-error-constants.md)

После создания SoH агент SHA должен вызвать [**инапсистемхеалсажентбиндинг:: нотифисохчанже**](inapsystemhealthagentbinding-notifysohchange-method.md) , чтобы уведомить напажент об изменении работоспособности системы.

Напажент вызывает этот метод для запроса Сохрекуест агента работоспособности системы. SHA может запросить переданный объект [**инапсистемхеалсажентрекуест**](inapsystemhealthagentrequest.md) для параметров, необходимых для расчета сохрекуест. SHA должен установить вычисленный Сохрекуест для объекта запроса. По завершении этого вызова SHA не должен содержать ссылки на объект запроса.

При вызове этого метода, если имеется SoH в кэше Напажент, он задается в объекте запроса. SHA может запросить его с помощью **жетсохрекуест**. Если агент SHA не устанавливает новое состояние работоспособности, используется кэшированный.

Для несвязанных SHA, зарегистрированных в системе, система защиты доступа к сети конструирует и отправляет Сохрекуест в соответствующий SHV со следующими типами атрибутов и значениями:

-   [**сохаттрибутетипесистемхеалсид**](sohattributetype-enum.md)= <id>
-   [**сохаттрибутетипефаилурекатегори**](sohattributetype-enum.md) =  [ **фаилурекатегориклиенткомпонент**](/windows/win32/api/naptypes/ne-naptypes-failurecategory)
-   [**сохаттрибутетипирроркодес**](sohattributetype-enum.md)  =  [ **Защита доступа к сети \_ E \_ не \_ инициализирована**](nap-error-constants.md)

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения Vista\]<br/>                                                      |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2008\]<br/>                                                |
| Заголовок<br/>                   | <dl> <dt>Напсистемхеалсажент. h</dt> </dl>   |
| IDL<br/>                      | <dl> <dt>Напсистемхеалсажент. idl</dt> </dl> |



## <a name="see-also"></a>См. также

<dl> <dt>

[**инапсистемхеалсаженткаллбакк**](inapsystemhealthagentcallback.md)
</dt> </dl>

 

 





