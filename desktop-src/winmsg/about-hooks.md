---
description: В этом разделе обсуждается использование обработчиков.
ms.assetid: 9ced0ac4-e602-425f-b954-6af9c741699a
title: Обзор обработчиков
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36c5d89f111604418d1dc3ea9a4ebce6fe0a8124
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105656661"
---
# <a name="hooks-overview"></a><span data-ttu-id="5ffe9-103">Обзор обработчиков</span><span class="sxs-lookup"><span data-stu-id="5ffe9-103">Hooks Overview</span></span>

<span data-ttu-id="5ffe9-104">*Обработчик* — это механизм, с помощью которого приложение может перехватить события, такие как сообщения, действия мыши и нажатия клавиш.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-104">A *hook* is a mechanism by which an application can intercept events, such as messages, mouse actions, and keystrokes.</span></span> <span data-ttu-id="5ffe9-105">Функция, которая перехватывает события определенного типа, называется *процедурой-обработчиком*.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-105">A function that intercepts a particular type of event is known as a *hook procedure*.</span></span> <span data-ttu-id="5ffe9-106">Процедура-обработчик может действовать для каждого получаемого события, а затем изменить или отменить событие.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-106">A hook procedure can act on each event it receives, and then modify or discard the event.</span></span>

<span data-ttu-id="5ffe9-107">В следующем примере используется для перехватчиков:</span><span class="sxs-lookup"><span data-stu-id="5ffe9-107">The following some example uses for hooks:</span></span>

-   <span data-ttu-id="5ffe9-108">Мониторинг сообщений в целях отладки</span><span class="sxs-lookup"><span data-stu-id="5ffe9-108">Monitor messages for debugging purposes</span></span>
-   <span data-ttu-id="5ffe9-109">Предоставление поддержки для записи и воспроизведения макросов</span><span class="sxs-lookup"><span data-stu-id="5ffe9-109">Provide support for recording and playback of macros</span></span>
-   <span data-ttu-id="5ffe9-110">Предоставление поддержки для клавиши справки (F1)</span><span class="sxs-lookup"><span data-stu-id="5ffe9-110">Provide support for a help key (F1)</span></span>
-   <span data-ttu-id="5ffe9-111">Имитация ввода с помощью мыши и клавиатуры</span><span class="sxs-lookup"><span data-stu-id="5ffe9-111">Simulate mouse and keyboard input</span></span>
-   <span data-ttu-id="5ffe9-112">Реализация приложения для обучения на основе компьютеров (CBT)</span><span class="sxs-lookup"><span data-stu-id="5ffe9-112">Implement a computer-based training (CBT) application</span></span>

> [!Note]  
> <span data-ttu-id="5ffe9-113">Обработчики обычно замедляют работу системы, так как они увеличивают объем обработки, которую должна выполнить система для каждого сообщения.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-113">Hooks tend to slow down the system because they increase the amount of processing the system must perform for each message.</span></span> <span data-ttu-id="5ffe9-114">Обработчик следует устанавливать только при необходимости и удалять его как можно скорее.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-114">You should install a hook only when necessary, and remove it as soon as possible.</span></span>

 

<span data-ttu-id="5ffe9-115">В этом разделе рассматриваются следующие вопросы:</span><span class="sxs-lookup"><span data-stu-id="5ffe9-115">This section discusses the following:</span></span>

-   [<span data-ttu-id="5ffe9-116">Цепочки обработчиков</span><span class="sxs-lookup"><span data-stu-id="5ffe9-116">Hook Chains</span></span>](#hook-chains)
-   [<span data-ttu-id="5ffe9-117">Процедуры-обработчики</span><span class="sxs-lookup"><span data-stu-id="5ffe9-117">Hook Procedures</span></span>](#hook-procedures)
-   [<span data-ttu-id="5ffe9-118">Типы обработчиков</span><span class="sxs-lookup"><span data-stu-id="5ffe9-118">Hook Types</span></span>](#hook-types)
    -   [<span data-ttu-id="5ffe9-119">Что такое каллвндпрок и т. д. \_ \_ каллвндпрокрет</span><span class="sxs-lookup"><span data-stu-id="5ffe9-119">WH\_CALLWNDPROC and WH\_CALLWNDPROCRET</span></span>](#wh_callwndproc-and-wh_callwndprocret)
    -   [<span data-ttu-id="5ffe9-120">что такое \_ CBT</span><span class="sxs-lookup"><span data-stu-id="5ffe9-120">WH\_CBT</span></span>](#wh_cbt)
    -   [<span data-ttu-id="5ffe9-121">что такое \_ Отладка</span><span class="sxs-lookup"><span data-stu-id="5ffe9-121">WH\_DEBUG</span></span>](#wh_debug)
    -   [<span data-ttu-id="5ffe9-122">что такое \_ фореграундидле</span><span class="sxs-lookup"><span data-stu-id="5ffe9-122">WH\_FOREGROUNDIDLE</span></span>](#wh_foregroundidle)
    -   [<span data-ttu-id="5ffe9-123">что такое \_ сообщение</span><span class="sxs-lookup"><span data-stu-id="5ffe9-123">WH\_GETMESSAGE</span></span>](#wh_getmessage)
    -   [<span data-ttu-id="5ffe9-124">что такое \_ жаурналплайбакк</span><span class="sxs-lookup"><span data-stu-id="5ffe9-124">WH\_JOURNALPLAYBACK</span></span>](#wh_journalplayback)
    -   [<span data-ttu-id="5ffe9-125">что такое \_ жаурналрекорд</span><span class="sxs-lookup"><span data-stu-id="5ffe9-125">WH\_JOURNALRECORD</span></span>](#wh_journalrecord)
    -   [<span data-ttu-id="5ffe9-126">что такое \_ сочетание клавиш \_</span><span class="sxs-lookup"><span data-stu-id="5ffe9-126">WH\_KEYBOARD\_LL</span></span>](#wh_keyboard_ll)
    -   [<span data-ttu-id="5ffe9-127">что такое \_ клавиатура</span><span class="sxs-lookup"><span data-stu-id="5ffe9-127">WH\_KEYBOARD</span></span>](#wh_keyboard)
    -   [<span data-ttu-id="5ffe9-128">что такое \_ мышь \_</span><span class="sxs-lookup"><span data-stu-id="5ffe9-128">WH\_MOUSE\_LL</span></span>](#wh_mouse_ll)
    -   [<span data-ttu-id="5ffe9-129">что такое \_ мышь</span><span class="sxs-lookup"><span data-stu-id="5ffe9-129">WH\_MOUSE</span></span>](#wh_mouse)
    -   [<span data-ttu-id="5ffe9-130">Что такое мсгфилтер и т. д. \_ \_ сисмсгфилтер</span><span class="sxs-lookup"><span data-stu-id="5ffe9-130">WH\_MSGFILTER and WH\_SYSMSGFILTER</span></span>](#wh_msgfilter-and-wh_sysmsgfilter)
    -   [<span data-ttu-id="5ffe9-131">что такое \_ оболочка</span><span class="sxs-lookup"><span data-stu-id="5ffe9-131">WH\_SHELL</span></span>](#wh_shell)

## <a name="hook-chains"></a><span data-ttu-id="5ffe9-132">Цепочки обработчиков</span><span class="sxs-lookup"><span data-stu-id="5ffe9-132">Hook Chains</span></span>

<span data-ttu-id="5ffe9-133">Система поддерживает множество различных типов обработчиков. Каждый тип предоставляет доступ к разным аспектам механизма обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-133">The system supports many different types of hooks; each type provides access to a different aspect of its message-handling mechanism.</span></span> <span data-ttu-id="5ffe9-134">Например, приложение может использовать обработчик [ \_ мыши](#wh_mouse) , который позволяет отслеживать трафик сообщений для сообщений мыши.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-134">For example, an application can use the [WH\_MOUSE](#wh_mouse) hook to monitor the message traffic for mouse messages.</span></span>

<span data-ttu-id="5ffe9-135">Система поддерживает отдельную цепочку обработчиков для каждого типа обработчика.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-135">The system maintains a separate hook chain for each type of hook.</span></span> <span data-ttu-id="5ffe9-136">*Цепочка обработчиков* представляет собой список указателей на специальные, определяемые приложением функции обратного вызова, называемые *процедурами обработчика*.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-136">A *hook chain* is a list of pointers to special, application-defined callback functions called *hook procedures*.</span></span> <span data-ttu-id="5ffe9-137">При возникновении сообщения, связанного с определенным типом обработчика, система передает сообщение каждой процедуре подключения, упоминаемой в цепочке обработчиков, один за другим.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-137">When a message occurs that is associated with a particular type of hook, the system passes the message to each hook procedure referenced in the hook chain, one after the other.</span></span> <span data-ttu-id="5ffe9-138">Действие, которое может выполнить процедура-ловушка, зависит от типа вовлеченного обработчика.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-138">The action a hook procedure can take depends on the type of hook involved.</span></span> <span data-ttu-id="5ffe9-139">Процедуры-обработчики для некоторых типов обработчиков могут отслеживать только сообщения. другие пользователи могут изменять сообщения или прекращать их выполнение через цепочку, предотвращая переход к следующей процедуре обработки или конечному окну.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-139">The hook procedures for some types of hooks can only monitor messages; others can modify messages or stop their progress through the chain, preventing them from reaching the next hook procedure or the destination window.</span></span>

## <a name="hook-procedures"></a><span data-ttu-id="5ffe9-140">Процедуры-обработчики</span><span class="sxs-lookup"><span data-stu-id="5ffe9-140">Hook Procedures</span></span>

<span data-ttu-id="5ffe9-141">Чтобы воспользоваться преимуществами определенного типа обработчика, разработчик предоставляет процедуру-обработчик и использует функцию [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) , чтобы установить ее в цепочку, связанную с обработчиком.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-141">To take advantage of a particular type of hook, the developer provides a hook procedure and uses the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function to install it into the chain associated with the hook.</span></span> <span data-ttu-id="5ffe9-142">Процедура-обработчик должна иметь следующий синтаксис:</span><span class="sxs-lookup"><span data-stu-id="5ffe9-142">A hook procedure must have the following syntax:</span></span>

``` syntax
LRESULT CALLBACK HookProc(
  int nCode, 
  WPARAM wParam, 
  LPARAM lParam
)
{
   // process event
   ...

   return CallNextHookEx(NULL, nCode, wParam, lParam);
}
```

<span data-ttu-id="5ffe9-143">*Хукпрок* — это заполнитель для определяемого приложением имени.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-143">*HookProc* is a placeholder for an application-defined name.</span></span>

<span data-ttu-id="5ffe9-144">Параметр *нкоде* — это код обработчика, используемый процедурой-обработчиком для определения выполняемого действия.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-144">The *nCode* parameter is a hook code that the hook procedure uses to determine the action to perform.</span></span> <span data-ttu-id="5ffe9-145">Значение кода обработчика зависит от типа обработчика; Каждый тип имеет собственный набор характеристик кодов обработчиков.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-145">The value of the hook code depends on the type of the hook; each type has its own characteristic set of hook codes.</span></span> <span data-ttu-id="5ffe9-146">Значения параметров *wParam* и *lParam* зависят от кода обработчика, но обычно содержат сведения о отправленном или опубликованном сообщении.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-146">The values of the *wParam* and *lParam* parameters depend on the hook code, but they typically contain information about a message that was sent or posted.</span></span>

<span data-ttu-id="5ffe9-147">Функция [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) всегда устанавливает процедуру-обработчик в начале цепочки обработчиков.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-147">The [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function always installs a hook procedure at the beginning of a hook chain.</span></span> <span data-ttu-id="5ffe9-148">При возникновении события, отслеживаемого определенным типом обработчика, система вызывает процедуру в начале цепочки перехватчиков, связанной с обработчиком.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-148">When an event occurs that is monitored by a particular type of hook, the system calls the procedure at the beginning of the hook chain associated with the hook.</span></span> <span data-ttu-id="5ffe9-149">Каждая процедура-ловушка в цепочке определяет, следует ли передавать событие в следующую процедуру.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-149">Each hook procedure in the chain determines whether to pass the event to the next procedure.</span></span> <span data-ttu-id="5ffe9-150">Процедура-обработчик передает событие следующей процедуре, вызывая функцию [**каллнекссукекс**](/windows/win32/api/winuser/nf-winuser-callnexthookex) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-150">A hook procedure passes an event to the next procedure by calling the [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex) function.</span></span>

<span data-ttu-id="5ffe9-151">Обратите внимание, что процедуры-обработчики для некоторых типов обработчиков могут наблюдать только за сообщениями.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-151">Note that the hook procedures for some types of hooks can only monitor messages.</span></span> <span data-ttu-id="5ffe9-152">система передает сообщения каждой процедуре-обработчику независимо от того, вызывает ли конкретная процедура [**каллнекссукекс**](/windows/win32/api/winuser/nf-winuser-callnexthookex).</span><span class="sxs-lookup"><span data-stu-id="5ffe9-152">the system passes messages to each hook procedure, regardless of whether a particular procedure calls [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex).</span></span>

<span data-ttu-id="5ffe9-153">*Глобальный обработчик* отслеживает сообщения для всех потоков на том же рабочем столе, что и вызывающий поток.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-153">A *global hook* monitors messages for all threads in the same desktop as the calling thread.</span></span> <span data-ttu-id="5ffe9-154">*Привязанный к конкретному потоку обработчик* отслеживает сообщения только для отдельного потока.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-154">A *thread-specific hook* monitors messages for only an individual thread.</span></span> <span data-ttu-id="5ffe9-155">Глобальную процедуру-ловушку можно вызвать в контексте любого приложения на том же рабочем столе, что и вызывающий поток, поэтому процедура должна находиться в отдельном модуле DLL.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-155">A global hook procedure can be called in the context of any application in the same desktop as the calling thread, so the procedure must be in a separate DLL module.</span></span> <span data-ttu-id="5ffe9-156">Процедура обработчика, относящаяся к конкретному потоку, вызывается только в контексте связанного потока.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-156">A thread-specific hook procedure is called only in the context of the associated thread.</span></span> <span data-ttu-id="5ffe9-157">Если приложение устанавливает процедуру-обработчик для одного из своих собственных потоков, процедура обработки может находиться в том же модуле, что и остальная часть кода приложения или в библиотеке DLL.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-157">If an application installs a hook procedure for one of its own threads, the hook procedure can be in either the same module as the rest of the application's code or in a DLL.</span></span> <span data-ttu-id="5ffe9-158">Если приложение устанавливает процедуру-обработчик для потока другого приложения, процедура должна быть в библиотеке DLL.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-158">If the application installs a hook procedure for a thread of a different application, the procedure must be in a DLL.</span></span> <span data-ttu-id="5ffe9-159">Дополнительные сведения см. в разделе [библиотеки динамической компоновки](../dlls/dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="5ffe9-159">For information, see [Dynamic-Link Libraries](../dlls/dynamic-link-libraries.md).</span></span>

> [!Note]  
> <span data-ttu-id="5ffe9-160">Глобальные перехватчики следует использовать только в целях отладки. в противном случае следует избегать их.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-160">You should use global hooks only for debugging purposes; otherwise, you should avoid them.</span></span> <span data-ttu-id="5ffe9-161">Глобальные перехватчики снижают производительность системы и вызывают конфликты с другими приложениями, которые реализуют тот же тип глобального обработчика.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-161">Global hooks hurt system performance and cause conflicts with other applications that implement the same type of global hook.</span></span>

 

## <a name="hook-types"></a><span data-ttu-id="5ffe9-162">Типы обработчиков</span><span class="sxs-lookup"><span data-stu-id="5ffe9-162">Hook Types</span></span>

<span data-ttu-id="5ffe9-163">Каждый тип ловушки позволяет приложению отслеживать различные аспекты механизма обработки сообщений системы.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-163">Each type of hook enables an application to monitor a different aspect of the system's message-handling mechanism.</span></span> <span data-ttu-id="5ffe9-164">В следующих разделах описываются доступные обработчики.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-164">The following sections describe the available hooks.</span></span>

-   [<span data-ttu-id="5ffe9-165">Что такое каллвндпрок и т. д. \_ \_ каллвндпрокрет</span><span class="sxs-lookup"><span data-stu-id="5ffe9-165">WH\_CALLWNDPROC and WH\_CALLWNDPROCRET</span></span>](#wh_callwndproc-and-wh_callwndprocret)
-   [<span data-ttu-id="5ffe9-166">что такое \_ CBT</span><span class="sxs-lookup"><span data-stu-id="5ffe9-166">WH\_CBT</span></span>](#wh_cbt)
-   [<span data-ttu-id="5ffe9-167">что такое \_ Отладка</span><span class="sxs-lookup"><span data-stu-id="5ffe9-167">WH\_DEBUG</span></span>](#wh_debug)
-   [<span data-ttu-id="5ffe9-168">что такое \_ фореграундидле</span><span class="sxs-lookup"><span data-stu-id="5ffe9-168">WH\_FOREGROUNDIDLE</span></span>](#wh_foregroundidle)
-   [<span data-ttu-id="5ffe9-169">что такое \_ сообщение</span><span class="sxs-lookup"><span data-stu-id="5ffe9-169">WH\_GETMESSAGE</span></span>](#wh_getmessage)
-   [<span data-ttu-id="5ffe9-170">что такое \_ жаурналплайбакк</span><span class="sxs-lookup"><span data-stu-id="5ffe9-170">WH\_JOURNALPLAYBACK</span></span>](#wh_journalplayback)
-   [<span data-ttu-id="5ffe9-171">что такое \_ жаурналрекорд</span><span class="sxs-lookup"><span data-stu-id="5ffe9-171">WH\_JOURNALRECORD</span></span>](#wh_journalrecord)
-   [<span data-ttu-id="5ffe9-172">что такое \_ сочетание клавиш \_</span><span class="sxs-lookup"><span data-stu-id="5ffe9-172">WH\_KEYBOARD\_LL</span></span>](#wh_keyboard_ll)
-   [<span data-ttu-id="5ffe9-173">что такое \_ клавиатура</span><span class="sxs-lookup"><span data-stu-id="5ffe9-173">WH\_KEYBOARD</span></span>](#wh_keyboard)
-   [<span data-ttu-id="5ffe9-174">что такое \_ мышь \_</span><span class="sxs-lookup"><span data-stu-id="5ffe9-174">WH\_MOUSE\_LL</span></span>](#wh_mouse_ll)
-   [<span data-ttu-id="5ffe9-175">что такое \_ мышь</span><span class="sxs-lookup"><span data-stu-id="5ffe9-175">WH\_MOUSE</span></span>](#wh_mouse)
-   [<span data-ttu-id="5ffe9-176">Что такое мсгфилтер и т. д. \_ \_ сисмсгфилтер</span><span class="sxs-lookup"><span data-stu-id="5ffe9-176">WH\_MSGFILTER and WH\_SYSMSGFILTER</span></span>](#wh_msgfilter-and-wh_sysmsgfilter)
-   [<span data-ttu-id="5ffe9-177">что такое \_ оболочка</span><span class="sxs-lookup"><span data-stu-id="5ffe9-177">WH\_SHELL</span></span>](#wh_shell)

### <a name="wh_callwndproc-and-wh_callwndprocret"></a><span data-ttu-id="5ffe9-178">Что такое каллвндпрок и т. д. \_ \_ каллвндпрокрет</span><span class="sxs-lookup"><span data-stu-id="5ffe9-178">WH\_CALLWNDPROC and WH\_CALLWNDPROCRET</span></span>

<span data-ttu-id="5ffe9-179">**\_ Каллвндпрок** и **\_ предкаллвндпрокретные** перехватчики, позволяющие отслеживать сообщения, отправленные в процедуры окна.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-179">The **WH\_CALLWNDPROC** and **WH\_CALLWNDPROCRET** hooks enable you to monitor messages sent to window procedures.</span></span> <span data-ttu-id="5ffe9-180">Система вызывает процедуру- **обработчик \_ каллвндпрок** перед передачей сообщения в процедуру получения окна и вызывает процедуру **\_ каллвндпрокрет** -обработчика после того, как процедура Window обработала сообщение.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-180">The system calls a **WH\_CALLWNDPROC** hook procedure before passing the message to the receiving window procedure, and calls the **WH\_CALLWNDPROCRET** hook procedure after the window procedure has processed the message.</span></span>

<span data-ttu-id="5ffe9-181">Обработчик **\_ каллвндпрокрет** передает указатель на структуру [**квпретструкт**](/windows/win32/api/winuser/ns-winuser-cwpretstruct) в процедуру-обработчик.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-181">The **WH\_CALLWNDPROCRET** hook passes a pointer to a [**CWPRETSTRUCT**](/windows/win32/api/winuser/ns-winuser-cwpretstruct) structure to the hook procedure.</span></span> <span data-ttu-id="5ffe9-182">Структура содержит возвращаемое значение из процедуры окна, которая обработала сообщение, а также параметры сообщения, связанные с сообщением.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-182">The structure contains the return value from the window procedure that processed the message, as well as the message parameters associated with the message.</span></span> <span data-ttu-id="5ffe9-183">Подклассировать окно не работает для сообщений, настроенных между процессами.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-183">Subclassing the window does not work for messages set between processes.</span></span>

<span data-ttu-id="5ffe9-184">Дополнительные сведения см. в разделе функции обратного вызова [*каллвндпрок*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85)) и [*каллвндретпрок*](/windows/win32/api/winuser/nc-winuser-hookproc) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-184">For more information, see the [*CallWndProc*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85)) and [*CallWndRetProc*](/windows/win32/api/winuser/nc-winuser-hookproc) callback functions.</span></span>

### <a name="wh_cbt"></a><span data-ttu-id="5ffe9-185">что такое \_ CBT</span><span class="sxs-lookup"><span data-stu-id="5ffe9-185">WH\_CBT</span></span>

<span data-ttu-id="5ffe9-186">Система вызывает процедуру- **обработчик \_ CBT** перед активацией, созданием, уничтожением, свертыванием, развертыванием, перемещением или изменением размера окна; перед выполнением системной команды; перед удалением события мыши или клавиатуры из очереди системных сообщений перед тем, как установить фокус ввода или перед синхронизацией с системной очередью сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-186">The system calls a **WH\_CBT** hook procedure before activating, creating, destroying, minimizing, maximizing, moving, or sizing a window; before completing a system command; before removing a mouse or keyboard event from the system message queue; before setting the input focus; or before synchronizing with the system message queue.</span></span> <span data-ttu-id="5ffe9-187">Значение, возвращаемое процедурой-обработчиком, определяет, разрешает ли система выполнение одной из этих операций.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-187">The value the hook procedure returns determines whether the system allows or prevents one of these operations.</span></span> <span data-ttu-id="5ffe9-188">**\_ CBTный** обработчик предназначен главным образом для приложений обучения на основе компьютеров (CBT).</span><span class="sxs-lookup"><span data-stu-id="5ffe9-188">The **WH\_CBT** hook is intended primarily for computer-based training (CBT) applications.</span></span>

<span data-ttu-id="5ffe9-189">Дополнительные сведения см. в описании функции обратного вызова [*кбтпрок*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-189">For more information, see the [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85)) callback function.</span></span>

<span data-ttu-id="5ffe9-190">Дополнительные сведения см. в разделе [виневентс](/windows/desktop/WinAuto/winevents-infrastructure).</span><span class="sxs-lookup"><span data-stu-id="5ffe9-190">For information, see [WinEvents](/windows/desktop/WinAuto/winevents-infrastructure).</span></span>

### <a name="wh_debug"></a><span data-ttu-id="5ffe9-191">что такое \_ Отладка</span><span class="sxs-lookup"><span data-stu-id="5ffe9-191">WH\_DEBUG</span></span>

<span data-ttu-id="5ffe9-192">Система вызывает процедуру-ловушку **\_ отладки** перед вызовом процедур-обработчиков, связанных с любым другим обработчиком в системе.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-192">The system calls a **WH\_DEBUG** hook procedure before calling hook procedures associated with any other hook in the system.</span></span> <span data-ttu-id="5ffe9-193">С помощью этого обработчика можно определить, следует ли разрешить системе вызывать процедуры-обработчики, связанные с другими типами обработчиков.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-193">You can use this hook to determine whether to allow the system to call hook procedures associated with other types of hooks.</span></span>

<span data-ttu-id="5ffe9-194">Дополнительные сведения см. в описании функции обратного вызова [*дебугпрок*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-194">For more information, see the [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) callback function.</span></span>

### <a name="wh_foregroundidle"></a><span data-ttu-id="5ffe9-195">что такое \_ фореграундидле</span><span class="sxs-lookup"><span data-stu-id="5ffe9-195">WH\_FOREGROUNDIDLE</span></span>

<span data-ttu-id="5ffe9-196">**\_ Фореграундидленый** обработчик позволяет выполнять задачи с низким приоритетом во время бездействия основного потока.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-196">The **WH\_FOREGROUNDIDLE** hook enables you to perform low priority tasks during times when its foreground thread is idle.</span></span> <span data-ttu-id="5ffe9-197">Система вызывает процедуру **\_ фореграундидле** -обработчика, когда передний поток приложения собирается стать неактивным.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-197">The system calls a **WH\_FOREGROUNDIDLE** hook procedure when the application's foreground thread is about to become idle.</span></span>

<span data-ttu-id="5ffe9-198">Дополнительные сведения см. в описании функции обратного вызова [*фореграундидлепрок*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-198">For more information, see the [*ForegroundIdleProc*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85)) callback function.</span></span>

### <a name="wh_getmessage"></a><span data-ttu-id="5ffe9-199">что такое \_ сообщение</span><span class="sxs-lookup"><span data-stu-id="5ffe9-199">WH\_GETMESSAGE</span></span>

<span data-ttu-id="5ffe9-200">Функция, включающая обработчик **\_ сообщений** , позволяет приложению отслеживать [**сообщения,**](/windows/win32/api/winuser/nf-winuser-getmessage) возвращаемые функцией [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-200">The **WH\_GETMESSAGE** hook enables an application to monitor messages about to be returned by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="5ffe9-201">**С помощью этого обработчика \_** можно отслеживать ввод с помощью мыши и клавиатуры, а также другие сообщения, размещенные в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-201">You can use the **WH\_GETMESSAGE** hook to monitor mouse and keyboard input and other messages posted to the message queue.</span></span>

<span data-ttu-id="5ffe9-202">Дополнительные сведения см. в описании функции обратного вызова [*жетмсгпрок*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-202">For more information, see the [*GetMsgProc*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)) callback function.</span></span>

### <a name="wh_journalplayback"></a><span data-ttu-id="5ffe9-203">что такое \_ жаурналплайбакк</span><span class="sxs-lookup"><span data-stu-id="5ffe9-203">WH\_JOURNALPLAYBACK</span></span>

<span data-ttu-id="5ffe9-204">**\_ Жаурналплайбаккющий** обработчик позволяет приложению вставлять сообщения в очередь системных сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-204">The **WH\_JOURNALPLAYBACK** hook enables an application to insert messages into the system message queue.</span></span> <span data-ttu-id="5ffe9-205">Этот обработчик можно использовать для воспроизведения ряда событий мыши и клавиатуры, записанных ранее, с помощью функции [ \_ жаурналрекорд](#wh_journalrecord).</span><span class="sxs-lookup"><span data-stu-id="5ffe9-205">You can use this hook to play back a series of mouse and keyboard events recorded earlier by using [WH\_JOURNALRECORD](#wh_journalrecord).</span></span> <span data-ttu-id="5ffe9-206">Обычная мышь и ввод с клавиатуры отключаются при условии, что установлен обработчик **\_ жаурналплайбакк** .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-206">Regular mouse and keyboard input is disabled as long as a **WH\_JOURNALPLAYBACK** hook is installed.</span></span> <span data-ttu-id="5ffe9-207">**\_ Жаурналплайбакк** обработчик — это глобальный обработчик — он не может использоваться в качестве обработчика для конкретного потока.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-207">A **WH\_JOURNALPLAYBACK** hook is a global hook—it cannot be used as a thread-specific hook.</span></span>

<span data-ttu-id="5ffe9-208">**\_ Жаурналплайбаккющий** обработчик возвращает значение времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-208">The **WH\_JOURNALPLAYBACK** hook returns a time-out value.</span></span> <span data-ttu-id="5ffe9-209">Это значение указывает системе, сколько миллисекунд следует ожидать перед обработкой текущего сообщения от обработчика воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-209">This value tells the system how many milliseconds to wait before processing the current message from the playback hook.</span></span> <span data-ttu-id="5ffe9-210">Это позволяет обработчику управлять временем воспроизводимых событий.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-210">This enables the hook to control the timing of the events it plays back.</span></span>

<span data-ttu-id="5ffe9-211">Дополнительные сведения см. в описании функции обратного вызова [*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-211">For more information, see the [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) callback function.</span></span>

### <a name="wh_journalrecord"></a><span data-ttu-id="5ffe9-212">что такое \_ жаурналрекорд</span><span class="sxs-lookup"><span data-stu-id="5ffe9-212">WH\_JOURNALRECORD</span></span>

<span data-ttu-id="5ffe9-213">**\_ Жаурналрекордющий** обработчик позволяет отслеживать и записывать события ввода.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-213">The **WH\_JOURNALRECORD** hook enables you to monitor and record input events.</span></span> <span data-ttu-id="5ffe9-214">Как правило, этот обработчик используется для записи последовательности событий мыши и клавиатуры для последующего воспроизведения с помощью [ \_ жаурналплайбакк](#wh_journalplayback).</span><span class="sxs-lookup"><span data-stu-id="5ffe9-214">Typically, you use this hook to record a sequence of mouse and keyboard events to play back later by using [WH\_JOURNALPLAYBACK](#wh_journalplayback).</span></span> <span data-ttu-id="5ffe9-215">**\_ Жаурналрекорд** -обработчик является глобальным обработчиком — он не может использоваться в качестве обработчика для конкретного потока.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-215">The **WH\_JOURNALRECORD** hook is a global hook—it cannot be used as a thread-specific hook.</span></span>

<span data-ttu-id="5ffe9-216">Дополнительные сведения см. в описании функции обратного вызова [*жаурналрекордпрок*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-216">For more information, see the [*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) callback function.</span></span>

### <a name="wh_keyboard_ll"></a><span data-ttu-id="5ffe9-217">что такое \_ сочетание клавиш \_</span><span class="sxs-lookup"><span data-stu-id="5ffe9-217">WH\_KEYBOARD\_LL</span></span>

<span data-ttu-id="5ffe9-218">С **помощью \_ этого \_** обработчика можно отслеживать события ввода с клавиатуры, которые будут публиковаться в очереди входных потоков.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-218">The **WH\_KEYBOARD\_LL** hook enables you to monitor keyboard input events about to be posted in a thread input queue.</span></span>

<span data-ttu-id="5ffe9-219">Дополнительные сведения см. в описании функции обратного вызова [*ловлевелкэйбоардпрок*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-219">For more information, see the [*LowLevelKeyboardProc*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85)) callback function.</span></span>

### <a name="wh_keyboard"></a><span data-ttu-id="5ffe9-220">что такое \_ клавиатура</span><span class="sxs-lookup"><span data-stu-id="5ffe9-220">WH\_KEYBOARD</span></span>

<span data-ttu-id="5ffe9-221">Функция, включающая **\_ клавиатурный** обработчик, позволяет приложению отслеживать трафик сообщений для [**WM \_ KeyDown**](/windows/desktop/inputdev/wm-keydown) и [**WM \_ KEYUP**](/windows/desktop/inputdev/wm-keyup) для [**сообщений,**](/windows/win32/api/winuser/nf-winuser-getmessage) возвращаемых функцией [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-221">The **WH\_KEYBOARD** hook enables an application to monitor message traffic for [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) and [**WM\_KEYUP**](/windows/desktop/inputdev/wm-keyup) messages about to be returned by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="5ffe9-222">Для мониторинга ввода с клавиатуры, помещенного в очередь сообщений, можно использовать **\_ клавиатурный** обработчик.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-222">You can use the **WH\_KEYBOARD** hook to monitor keyboard input posted to a message queue.</span></span>

<span data-ttu-id="5ffe9-223">Дополнительные сведения см. в описании функции обратного вызова [*кэйбоардпрок*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-223">For more information, see the [*KeyboardProc*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85)) callback function.</span></span>

### <a name="wh_mouse_ll"></a><span data-ttu-id="5ffe9-224">что такое \_ мышь \_</span><span class="sxs-lookup"><span data-stu-id="5ffe9-224">WH\_MOUSE\_LL</span></span>

<span data-ttu-id="5ffe9-225">Включение обработчика событий мыши позволяет отслеживать события ввода мыши, которые должны быть размещены в очереди входных потоков. **\_ \_**</span><span class="sxs-lookup"><span data-stu-id="5ffe9-225">The **WH\_MOUSE\_LL** hook enables you to monitor mouse input events about to be posted in a thread input queue.</span></span>

<span data-ttu-id="5ffe9-226">Дополнительные сведения см. в описании функции обратного вызова [*ловлевелмаусепрок*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-226">For more information, see the [*LowLevelMouseProc*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85)) callback function.</span></span>

### <a name="wh_mouse"></a><span data-ttu-id="5ffe9-227">что такое \_ мышь</span><span class="sxs-lookup"><span data-stu-id="5ffe9-227">WH\_MOUSE</span></span>

<span data-ttu-id="5ffe9-228">При помощи обработчика **\_ мыши** можно отслеживать сообщения [**мыши,**](/windows/win32/api/winuser/nf-winuser-getmessage) возвращаемые функцией [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-228">The **WH\_MOUSE** hook enables you to monitor mouse messages about to be returned by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="5ffe9-229">Для отслеживания ввода мыши, помещенного в очередь сообщений, можно использовать обработчик **\_ мыши** .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-229">You can use the **WH\_MOUSE** hook to monitor mouse input posted to a message queue.</span></span>

<span data-ttu-id="5ffe9-230">Дополнительные сведения см. в описании функции обратного вызова [*маусепрок*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-230">For more information, see the [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)) callback function.</span></span>

### <a name="wh_msgfilter-and-wh_sysmsgfilter"></a><span data-ttu-id="5ffe9-231">Что такое мсгфилтер и т. д. \_ \_ сисмсгфилтер</span><span class="sxs-lookup"><span data-stu-id="5ffe9-231">WH\_MSGFILTER and WH\_SYSMSGFILTER</span></span>

<span data-ttu-id="5ffe9-232">**\_ Мсгфилтерные** и предопределяющие перехватчики **\_ сисмсгфилтер** позволяют отслеживать сообщения, обрабатываемые меню, полосой прокрутки, окном сообщения или диалоговыми окнами, а также определять, когда в результате нажатия пользователем клавиши ALT + TAB или Alt + Esc будет активировано другое окно.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-232">The **WH\_MSGFILTER** and **WH\_SYSMSGFILTER** hooks enable you to monitor messages about to be processed by a menu, scroll bar, message box, or dialog box, and to detect when a different window is about to be activated as a result of the user's pressing the ALT+TAB or ALT+ESC key combination.</span></span> <span data-ttu-id="5ffe9-233">**\_ Мсгфилтерющий** обработчик может отслеживать только сообщения, переданные в меню, полосу прокрутки, окно сообщения или диалоговое окно, созданное приложением, которое установило процедуру-обработчик.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-233">The **WH\_MSGFILTER** hook can only monitor messages passed to a menu, scroll bar, message box, or dialog box created by the application that installed the hook procedure.</span></span> <span data-ttu-id="5ffe9-234">То есть обработчик **\_ сисмсгфилтер** отслеживает такие сообщения для всех приложений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-234">The **WH\_SYSMSGFILTER** hook monitors such messages for all applications.</span></span>

<span data-ttu-id="5ffe9-235">**\_ Мсгфилтерные** и **\_ предсисмсгфилтерные** Перехватчики позволяют выполнять фильтрацию сообщений во время модальных циклов, эквивалентных фильтрации в главном цикле обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-235">The **WH\_MSGFILTER** and **WH\_SYSMSGFILTER** hooks enable you to perform message filtering during modal loops that is equivalent to the filtering done in the main message loop.</span></span> <span data-ttu-id="5ffe9-236">Например, приложение часто проверяет новое сообщение в основном цикле между моментом получения сообщения из очереди и временем, когда он отправляет сообщение, выполняя специальную обработку соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-236">For example, an application often examines a new message in the main loop between the time it retrieves the message from the queue and the time it dispatches the message, performing special processing as appropriate.</span></span> <span data-ttu-id="5ffe9-237">Однако во время модального цикла система извлекает и отправляет сообщения, не позволяя приложению фильтровать сообщения в основном цикле обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-237">However, during a modal loop, the system retrieves and dispatches messages without allowing an application the chance to filter the messages in its main message loop.</span></span> <span data-ttu-id="5ffe9-238">Если приложение устанавливает **\_ мсгфилтер** или **\_ предсисмсгфилтер** процедуру-обработчик, система вызывает эту процедуру во время выполнения модального цикла.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-238">If an application installs a **WH\_MSGFILTER** or **WH\_SYSMSGFILTER** hook procedure, the system calls the procedure during the modal loop.</span></span>

<span data-ttu-id="5ffe9-239">Приложение может вызвать непосредственный обработчик **\_ мсгфилтер** , вызвав функцию [**каллмсгфилтер**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-239">An application can call the **WH\_MSGFILTER** hook directly by calling the [**CallMsgFilter**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) function.</span></span> <span data-ttu-id="5ffe9-240">С помощью этой функции приложение может использовать тот же код для фильтрации сообщений во время модальных циклов, как он используется в главном цикле обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-240">By using this function, the application can use the same code to filter messages during modal loops as it uses in the main message loop.</span></span> <span data-ttu-id="5ffe9-241">Для этого необходимо инкапсулировать операции фильтрации в виде процедуры **\_ мсгфилтер** -обработчика и вызвать **каллмсгфилтер** между вызовами [**функций и**](/windows/win32/api/winuser/nf-winuser-getmessage) [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-241">To do so, encapsulate the filtering operations in a **WH\_MSGFILTER** hook procedure and call **CallMsgFilter** between the calls to the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) and [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) functions.</span></span>

``` syntax
while (GetMessage(&msg, (HWND) NULL, 0, 0)) 
{ 
    if (!CallMsgFilter(&qmsg, 0)) 
        DispatchMessage(&qmsg); 
} 
```

<span data-ttu-id="5ffe9-242">Последний аргумент [**каллмсгфилтер**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) просто передается в процедуру-обработчик; можно ввести любое значение.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-242">The last argument of [**CallMsgFilter**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) is simply passed to the hook procedure; you can enter any value.</span></span> <span data-ttu-id="5ffe9-243">Процедура обработки, определяющая константу, такую как **мсгф \_ маинлуп**, может использовать это значение для определения места вызова процедуры.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-243">The hook procedure, by defining a constant such as **MSGF\_MAINLOOP**, can use this value to determine where the procedure was called from.</span></span>

<span data-ttu-id="5ffe9-244">Дополнительные сведения см. в разделе функции обратного вызова [*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)) и [*сисмсгпрок*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-244">For more information, see the [*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)) and [*SysMsgProc*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85)) callback functions.</span></span>

### <a name="wh_shell"></a><span data-ttu-id="5ffe9-245">что такое \_ оболочка</span><span class="sxs-lookup"><span data-stu-id="5ffe9-245">WH\_SHELL</span></span>

<span data-ttu-id="5ffe9-246">Приложение оболочки может использовать обработчик **\_ оболочки** для получения важных уведомлений.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-246">A shell application can use the **WH\_SHELL** hook to receive important notifications.</span></span> <span data-ttu-id="5ffe9-247">Система вызывает процедуру- **обработчик \_ оболочки** при активации приложения оболочки и создании или уничтожении окна верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-247">The system calls a **WH\_SHELL** hook procedure when the shell application is about to be activated and when a top-level window is created or destroyed.</span></span>

<span data-ttu-id="5ffe9-248">Обратите внимание, что пользовательские приложения оболочки не получают сообщения **\_ оболочки** .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-248">Note that custom shell applications do not receive **WH\_SHELL** messages.</span></span> <span data-ttu-id="5ffe9-249">Таким образом, любое приложение, которое регистрирует себя как оболочку по умолчанию, должно вызывать функцию [**системпараметерсинфо**](/windows/desktop/api/winuser/nf-winuser-systemparametersinfoa) , прежде чем она (или любое другое приложение) сможет получить сообщения **\_ оболочки** .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-249">Therefore, any application that registers itself as the default shell must call the [**SystemParametersInfo**](/windows/desktop/api/winuser/nf-winuser-systemparametersinfoa) function before it (or any other application) can receive **WH\_SHELL** messages.</span></span> <span data-ttu-id="5ffe9-250">Эта функция должна вызываться с **индексом SPI \_ сетминимизедметрикс** и структурой [**минимизедметрикс**](/windows/win32/api/winuser/ns-winuser-minimizedmetrics) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-250">This function must be called with **SPI\_SETMINIMIZEDMETRICS** and a [**MINIMIZEDMETRICS**](/windows/win32/api/winuser/ns-winuser-minimizedmetrics) structure.</span></span> <span data-ttu-id="5ffe9-251">Задайте для элемента **иарранже** этой структуры значение **АРВ \_ Hide**.</span><span class="sxs-lookup"><span data-stu-id="5ffe9-251">Set the **iArrange** member of this structure to **ARW\_HIDE**.</span></span>

<span data-ttu-id="5ffe9-252">Дополнительные сведения см. в описании функции обратного вызова [*шеллпрок*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="5ffe9-252">For more information, see the [*ShellProc*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85)) callback function.</span></span>

 

 
