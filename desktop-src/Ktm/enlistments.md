---
description: Диспетчер ресурсов прикрепляется в транзакции, когда она начинает участие в этой конкретной транзакции.
ms.assetid: 9c201699-c00b-4efe-9f30-8d4e182de785
title: Зачислений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 52820af2a7b280bc4740d0309fb627725e648685
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272472"
---
# <a name="enlistments"></a><span data-ttu-id="931df-103">Зачислений</span><span class="sxs-lookup"><span data-stu-id="931df-103">Enlistments</span></span>

<span data-ttu-id="931df-104">Диспетчер ресурсов прикрепляется в транзакции, когда она начинает участие в этой конкретной транзакции.</span><span class="sxs-lookup"><span data-stu-id="931df-104">A resource manager enlists in a transaction when it begins participation in that particular transaction.</span></span> <span data-ttu-id="931df-105">Прикрепление определяет, какие уведомления принимает диспетчер ресурсов.</span><span class="sxs-lookup"><span data-stu-id="931df-105">The enlistment defines which notifications the resource manager accepts.</span></span> <span data-ttu-id="931df-106">Диспетчер ресурсов создает объект прикрепления, когда он закрепляется в транзакции.</span><span class="sxs-lookup"><span data-stu-id="931df-106">A resource manager creates an enlistment object when it enlists in a transaction.</span></span> <span data-ttu-id="931df-107">Этот объект сообщает KTM, что диспетчер ресурсов (RM) запрашивает уведомления об указанной транзакции.</span><span class="sxs-lookup"><span data-stu-id="931df-107">This object signals to KTM that the resource manager (RM) is requesting notifications about the specified transaction.</span></span>

<span data-ttu-id="931df-108">RM предоставляет структуру [**\_ маски уведомлений**](notification-mask.md) , которая содержит сведения о том, какие уведомления запрашиваются.</span><span class="sxs-lookup"><span data-stu-id="931df-108">The RM provides a [**NOTIFICATION\_MASK**](notification-mask.md) structure that details which notifications it is requesting.</span></span>

## <a name="enlistment-functions"></a><span data-ttu-id="931df-109">Функции прикрепления</span><span class="sxs-lookup"><span data-stu-id="931df-109">Enlistment Functions</span></span>

<span data-ttu-id="931df-110">Для зачислений используются следующие функции.</span><span class="sxs-lookup"><span data-stu-id="931df-110">The following functions are used with enlistments.</span></span>



| <span data-ttu-id="931df-111">Функция</span><span class="sxs-lookup"><span data-stu-id="931df-111">Function</span></span>                                                                          | <span data-ttu-id="931df-112">Описание</span><span class="sxs-lookup"><span data-stu-id="931df-112">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="931df-113">**коммиткомплете**</span><span class="sxs-lookup"><span data-stu-id="931df-113">**CommitComplete**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-commitcomplete)                                          | <span data-ttu-id="931df-114">Указывает, что диспетчер ресурсов (RM) завершил фиксацию транзакции, запрошенной диспетчером транзакций (TM).</span><span class="sxs-lookup"><span data-stu-id="931df-114">Indicates that a resource manager (RM) has finished committing a transaction that was requested by the transaction manager (TM).</span></span>                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="931df-115">**креатинлистмент**</span><span class="sxs-lookup"><span data-stu-id="931df-115">**CreateEnlistment**</span></span>](/windows/desktop/api/KtmW32/nf-ktmw32-createenlistment)                                      | <span data-ttu-id="931df-116">Создает прикрепление, устанавливает его начальное состояние и открывает в зачислении маркер с указанным доступом.</span><span class="sxs-lookup"><span data-stu-id="931df-116">Creates an enlistment, sets its initial state, and opens a handle to the enlistment with the specified access.</span></span>                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="931df-117">**жетенлистментрековеринформатион**</span><span class="sxs-lookup"><span data-stu-id="931df-117">**GetEnlistmentRecoveryInformation**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation) | <span data-ttu-id="931df-118">Извлекает непрозрачную структуру данных восстановления от KTM.</span><span class="sxs-lookup"><span data-stu-id="931df-118">Retrieves an opaque structure of recovery data from KTM.</span></span> <span data-ttu-id="931df-119">Сведения о восстановлении хранятся в журнале от имени диспетчера ресурсов (RM) путем вызова функции [**сетенлистментрековеринформатион**](/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation) .</span><span class="sxs-lookup"><span data-stu-id="931df-119">Recovery information is stored in a log on behalf of a resource manager (RM) by calling the [**SetEnlistmentRecoveryInformation**](/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation) function.</span></span> <span data-ttu-id="931df-120">После сбоя диспетчер ресурсов может использовать функцию [**жетенлистментрековеринформатион**](/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation) для получения информации.</span><span class="sxs-lookup"><span data-stu-id="931df-120">After a failure, the RM can use the [**GetEnlistmentRecoveryInformation**](/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation) function to retrieve the information.</span></span> |
| [<span data-ttu-id="931df-121">**опененлистмент**</span><span class="sxs-lookup"><span data-stu-id="931df-121">**OpenEnlistment**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-openenlistment)                                          | <span data-ttu-id="931df-122">Открывает существующий объект прикрепления и возвращает маркер в зачисление.</span><span class="sxs-lookup"><span data-stu-id="931df-122">Opens an existing enlistment object, and returns a handle to the enlistment.</span></span>                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="931df-123">**реадонленлистмент**</span><span class="sxs-lookup"><span data-stu-id="931df-123">**ReadOnlyEnlistment**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-readonlyenlistment)                                  | <span data-ttu-id="931df-124">Запрашивает преобразование указанного прикрепления в прикрепление только для чтения.</span><span class="sxs-lookup"><span data-stu-id="931df-124">Requests that the specified enlistment be converted to a read-only enlistment.</span></span> <span data-ttu-id="931df-125">Прикрепление, доступное только для чтения, не может участвовать в результатах транзакции и не надежно записано для восстановления.</span><span class="sxs-lookup"><span data-stu-id="931df-125">A read-only enlistment cannot participate in the outcome of the transaction and is not durably recorded for recovery.</span></span>                                                                                                                                                                                                    |
| [<span data-ttu-id="931df-126">**роллбаккенлистмент**</span><span class="sxs-lookup"><span data-stu-id="931df-126">**RollbackEnlistment**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackenlistment)                                  | <span data-ttu-id="931df-127">Выполняет откат указанной транзакции, связанной с зачислением.</span><span class="sxs-lookup"><span data-stu-id="931df-127">Rolls back the specified transaction that is associated with an enlistment.</span></span> <span data-ttu-id="931df-128">Эта функция не может быть вызвана для прикрепления только для чтения.</span><span class="sxs-lookup"><span data-stu-id="931df-128">This function cannot be called for read-only enlistments.</span></span>                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="931df-129">**сетенлистментрековеринформатион**</span><span class="sxs-lookup"><span data-stu-id="931df-129">**SetEnlistmentRecoveryInformation**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation)      | <span data-ttu-id="931df-130">Задает непрозрачную, определяемую пользователем структуру данных восстановления от KTM.</span><span class="sxs-lookup"><span data-stu-id="931df-130">Sets an opaque, user-defined structure of recovery data from KTM.</span></span> <span data-ttu-id="931df-131">Сведения о восстановлении хранятся в журнале от имени диспетчера ресурсов (RM) путем вызова [**сетенлистментрековеринформатион**](/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation).</span><span class="sxs-lookup"><span data-stu-id="931df-131">Recovery information is stored in a log on behalf of a resource manager (RM) by calling [**SetEnlistmentRecoveryInformation**](/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation).</span></span> <span data-ttu-id="931df-132">После сбоя диспетчер ресурсов может использовать [**жетенлистментрековеринформатион**](/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation) для получения информации.</span><span class="sxs-lookup"><span data-stu-id="931df-132">After a failure, the RM can use [**GetEnlistmentRecoveryInformation**](/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation) to retrieve the information.</span></span>                  |
| [<span data-ttu-id="931df-133">**синглефасережект**</span><span class="sxs-lookup"><span data-stu-id="931df-133">**SinglePhaseReject**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-singlephasereject)                                    | <span data-ttu-id="931df-134">Указывает, что диспетчер ресурсов (RM) отказывается от однофазного запроса.</span><span class="sxs-lookup"><span data-stu-id="931df-134">Indicates that the resource manager (RM) is refusing a single-phase request.</span></span> <span data-ttu-id="931df-135">Когда диспетчер транзакций (TM) получает этот вызов, он инициирует двухфазной фиксацию и отправляет запрос на подготовку во все прикрепленные RMs.</span><span class="sxs-lookup"><span data-stu-id="931df-135">When a transaction manager (TM) receives this call, it initiates a two-phase commit and sends a prepare request to all enlisted RMs.</span></span>                                                                                                                                                                                       |



 

 

 



