---
description: API датчика предоставляет метод, с помощью которого пользователь может запрашивать у пользователя разрешения на использование датчика или коллекции датчиков.
ms.assetid: c755edcf-18c1-43d5-9dfe-c073e1f96b5f
title: Управление разрешениями пользователей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ecb65fa5a9962be4850aa4711cafa03fb7658212
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103991010"
---
# <a name="managing-user-permissions"></a><span data-ttu-id="7fb74-103">Управление разрешениями пользователей</span><span class="sxs-lookup"><span data-stu-id="7fb74-103">Managing User Permissions</span></span>

<span data-ttu-id="7fb74-104">API датчика предоставляет метод, с помощью которого пользователь может запрашивать у пользователя разрешения на использование датчика или коллекции датчиков.</span><span class="sxs-lookup"><span data-stu-id="7fb74-104">The Sensor API provides a method you can use to prompt the user for permissions to use a sensor or collection of sensors.</span></span>

<span data-ttu-id="7fb74-105">Так как датчики могут раскрывать конфиденциальную информацию, Windows требует, чтобы пользователи включили датчики, прежде чем программа сможет получить доступ к любым данным.</span><span class="sxs-lookup"><span data-stu-id="7fb74-105">Because sensors can reveal sensitive information, Windows requires that users enable sensors before your program can access any data.</span></span>

<span data-ttu-id="7fb74-106">Вы можете запросить разрешение, если вы хотите использовать датчики, для которых в текущем [**сенсорстате**](/windows/win32/api/sensorsapi/ne-sensorsapi-sensorstate) нет \_ доступа к состоянию датчика \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="7fb74-106">You may want to request permission when you want to use sensors for which the current [**SensorState**](/windows/win32/api/sensorsapi/ne-sensorsapi-sensorstate) is SENSOR\_STATE\_ACCESS\_DENIED.</span></span>

<span data-ttu-id="7fb74-107">Чтобы запросить разрешения, вызовите метод [**исенсорманажер:: рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) .</span><span class="sxs-lookup"><span data-stu-id="7fb74-107">To request permissions, call the [**ISensorManager::RequestPermissions**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) method.</span></span> <span data-ttu-id="7fb74-108">При вызове этого метода Windows открывает диалоговое окно **Включение датчиков** , в котором пользователю предлагается включить запрошенные датчики.</span><span class="sxs-lookup"><span data-stu-id="7fb74-108">When you call this method, Windows opens the **Enable sensors** dialog box to prompt the user to enable the sensors you requested.</span></span> <span data-ttu-id="7fb74-109">Это диалоговое окно предоставляет пользователю имена запрошенных датчиков.</span><span class="sxs-lookup"><span data-stu-id="7fb74-109">This dialog box provides the user with the names of the sensors you requested.</span></span> <span data-ttu-id="7fb74-110">Пользователь может выбрать один из следующих вариантов:</span><span class="sxs-lookup"><span data-stu-id="7fb74-110">The user can choose one of the following options:</span></span>

-   <span data-ttu-id="7fb74-111">**Включите эти датчики**.</span><span class="sxs-lookup"><span data-stu-id="7fb74-111">**Enable these sensors**.</span></span>
-   <span data-ttu-id="7fb74-112">**Не включайте эти датчики**.</span><span class="sxs-lookup"><span data-stu-id="7fb74-112">**Don't enable these sensors**.</span></span>
-   <span data-ttu-id="7fb74-113">**Откройте панель управления для получения дополнительных параметров**.</span><span class="sxs-lookup"><span data-stu-id="7fb74-113">**Open Control Panel for more options**.</span></span>

<span data-ttu-id="7fb74-114">Если пользователь выбрал **параметр не включать эти датчики**, Windows больше не будет отображать диалоговое окно " **Включение датчиков** " для этих датчиков, даже если программа вызывает [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions).</span><span class="sxs-lookup"><span data-stu-id="7fb74-114">If a user chooses **Don't enable these sensors**, Windows will not show the **Enable sensors** dialog box again for those particular sensors, even if your program calls [**RequestPermissions**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions).</span></span> <span data-ttu-id="7fb74-115">Если пользователь выбрал любой другой параметр, Windows разрешит отображение диалогового окна при запросе.</span><span class="sxs-lookup"><span data-stu-id="7fb74-115">If the user chooses any other option, Windows will allow the dialog box to be displayed when requested.</span></span> <span data-ttu-id="7fb74-116">Если ваш вызов **рекуестпермиссионс** содержит датчики, которые пользователь ранее выбрал для отключения, API датчика удалит эти датчики из списка датчиков, которые видит пользователь.</span><span class="sxs-lookup"><span data-stu-id="7fb74-116">If your call to **RequestPermissions** contains some sensors that the user has previously chosen to keep disabled, the Sensor API will remove these sensors from the list of sensors the user sees.</span></span>

### <a name="modal-or-modeless-behavior"></a><span data-ttu-id="7fb74-117">Модальное или немодальное поведение</span><span class="sxs-lookup"><span data-stu-id="7fb74-117">Modal or Modeless Behavior</span></span>

<span data-ttu-id="7fb74-118">Метод [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) принимает **логический** аргумент, который определяет, отображается ли диалоговое окно **Включение датчиков** в виде модального или немодального окна.</span><span class="sxs-lookup"><span data-stu-id="7fb74-118">The [**RequestPermissions**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) method takes a **Boolean** argument that determines whether the **Enable sensors** dialog box is displayed as a modal or modeless window.</span></span> <span data-ttu-id="7fb74-119">Этот параметр также влияет на то, является ли поведение возвращаемого кода диалогового окна синхронным или асинхронным.</span><span class="sxs-lookup"><span data-stu-id="7fb74-119">This setting also affects whether the behavior of the dialog box return code is synchronous or asynchronous.</span></span>

<span data-ttu-id="7fb74-120">При модальности диалоговое окно имеет эксклюзивный фокус между окнами приложения, пока пользователь не выберет параметр, а код возврата **HRESULT** из вызова [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) указывает на выбор пользователя.</span><span class="sxs-lookup"><span data-stu-id="7fb74-120">When modal, the dialog box has exclusive focus among application windows until the user chooses an option, and the **HRESULT** return code from your call to [**RequestPermissions**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) indicates the user choice.</span></span> <span data-ttu-id="7fb74-121">При немодальном режиме диалоговое окно не имеет монопольного фокуса и вызов **рекуестпермиссионс** возвращает немедленно.</span><span class="sxs-lookup"><span data-stu-id="7fb74-121">When modeless, the dialog box does not have exclusive focus and your call to **RequestPermissions** returns immediately.</span></span> <span data-ttu-id="7fb74-122">В этом случае код возврата указывает, был ли метод обработан удачно, но не может быть использован для определения выбора пользователя.</span><span class="sxs-lookup"><span data-stu-id="7fb74-122">In this case, the return code indicates whether the method succeeded, but cannot be used to ascertain the user's choice.</span></span> <span data-ttu-id="7fb74-123">Затем можно определить, какие датчики были включены, обрабатывая событие [**онстатечанжед**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensorevents-onstatechanged) и проверив каждый датчик на \_ готовность датчика \_ .</span><span class="sxs-lookup"><span data-stu-id="7fb74-123">You can then determine which sensors have been enabled by handling the [**OnStateChanged**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensorevents-onstatechanged) event and checking each sensor for SENSOR\_STATE\_READY.</span></span>

<span data-ttu-id="7fb74-124">Дополнительные сведения о кодах возврата см. на странице справочника по [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) .</span><span class="sxs-lookup"><span data-stu-id="7fb74-124">For more information about return codes, see the [**RequestPermissions**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) reference page.</span></span>

### <a name="best-practice-avoid-multiple-modeless-calls-to-requestpermissions"></a><span data-ttu-id="7fb74-125">Рекомендации. Избегайте нескольких немодальных вызовов Рекуестпермиссионс</span><span class="sxs-lookup"><span data-stu-id="7fb74-125">Best Practice: Avoid Multiple Modeless Calls to RequestPermissions</span></span>

<span data-ttu-id="7fb74-126">Повторяющиеся немодальные вызовы [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) будут отображать несколько экземпляров диалогового окна **Включение этих датчиков** и могут привести к переполнению экрана с помощью диалоговых окон, что приведет к плохому взаиморезультату с пользователем.</span><span class="sxs-lookup"><span data-stu-id="7fb74-126">Repeated modeless calls to [**RequestPermissions**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) will display multiple instances of the **Enable these sensors** dialog box, and can potentially flood the screen with dialog boxes, resulting in a poor user experience.</span></span> <span data-ttu-id="7fb74-127">Если вы считаете, что после первого вызова **рекуестпермиссионс** можно установить другие датчики расположения, что требует другого вызова **рекуестпермиссионс**, необходимо либо вызвать **рекуестпермиссионс** в модальном режиме, либо подождать, пока все датчики расположения не будут установлены для выполнения немодального вызова.</span><span class="sxs-lookup"><span data-stu-id="7fb74-127">If you think that after your first call to **RequestPermissions**, other location sensors might be installed, requiring another call to **RequestPermissions**, you should either call **RequestPermissions** modally, or wait until all location sensors are installed to make a modeless call.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7fb74-128">См. также</span><span class="sxs-lookup"><span data-stu-id="7fb74-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7fb74-129">Конфиденциальность и безопасность на платформе датчиков и расположений</span><span class="sxs-lookup"><span data-stu-id="7fb74-129">Privacy and Security in the Sensor and Location Platform</span></span>](privacy-and-security-in-the-sensor-and-location-platform.md)
</dt> <dt>

[<span data-ttu-id="7fb74-130">Запрос разрешений пользователя</span><span class="sxs-lookup"><span data-stu-id="7fb74-130">Requesting User Permissions</span></span>](requesting-user-permissions.md)
</dt> </dl>

 

 
