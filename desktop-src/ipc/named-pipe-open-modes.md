---
description: Сервер канала определяет доступ к каналу, перекрытие и режимы записи в параметре Двопенмоде функции Креатенамедпипе. Клиенты канала могут задавать эти открытые режимы для обработки канала с помощью функции CreateFile.
ms.assetid: 88824566-93c7-4941-a4fc-3a7ae9a332a4
title: Режимы открытия именованных каналов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 97f51d41ea98a47a269634b06ccdad869bd649fa
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103999434"
---
# <a name="named-pipe-open-modes"></a><span data-ttu-id="a687c-104">Режимы открытия именованных каналов</span><span class="sxs-lookup"><span data-stu-id="a687c-104">Named Pipe Open Modes</span></span>

<span data-ttu-id="a687c-105">Сервер канала определяет доступ к каналу, перекрытие и режимы записи в параметре *двопенмоде* функции [**креатенамедпипе**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) .</span><span class="sxs-lookup"><span data-stu-id="a687c-105">The pipe server specifies the pipe access, overlap, and write-through modes in the *dwOpenMode* parameter of the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function.</span></span> <span data-ttu-id="a687c-106">Клиенты канала могут задавать эти открытые режимы для обработки канала с помощью функции [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="a687c-106">The pipe clients can specify these open modes for their pipe handles using the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

## <a name="access-mode"></a><span data-ttu-id="a687c-107">Режим доступа</span><span class="sxs-lookup"><span data-stu-id="a687c-107">Access Mode</span></span>

<span data-ttu-id="a687c-108">Установка режима доступа канала эквивалентна указанию доступа для чтения или записи, связанного с дескрипторами сервера канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-108">Setting the pipe access mode is equivalent to specifying read or write access associated with the pipe server's handles.</span></span> <span data-ttu-id="a687c-109">В следующей таблице показано эквивалентное универсальное право доступа для каждого режима доступа, который можно указать с помощью [**креатенамедпипе**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea).</span><span class="sxs-lookup"><span data-stu-id="a687c-109">The following table shows the equivalent generic access right for each access mode you can specify with [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea).</span></span>



| <span data-ttu-id="a687c-110">Режим доступа</span><span class="sxs-lookup"><span data-stu-id="a687c-110">Access mode</span></span>            | <span data-ttu-id="a687c-111">Эквивалент универсального права доступа</span><span class="sxs-lookup"><span data-stu-id="a687c-111">Equivalent generic access right</span></span> |
|------------------------|---------------------------------|
| <span data-ttu-id="a687c-112">\_входящий доступ к каналу \_</span><span class="sxs-lookup"><span data-stu-id="a687c-112">PIPE\_ACCESS\_INBOUND</span></span>  | <span data-ttu-id="a687c-113">УНИВЕРСАЛЬНое \_ чтение</span><span class="sxs-lookup"><span data-stu-id="a687c-113">GENERIC\_READ</span></span>                   |
| <span data-ttu-id="a687c-114">\_исходящий доступ к каналу \_</span><span class="sxs-lookup"><span data-stu-id="a687c-114">PIPE\_ACCESS\_OUTBOUND</span></span> | <span data-ttu-id="a687c-115">УНИВЕРСАЛЬНая \_ запись</span><span class="sxs-lookup"><span data-stu-id="a687c-115">GENERIC\_WRITE</span></span>                  |
| <span data-ttu-id="a687c-116">\_дуплексный доступ к каналу \_</span><span class="sxs-lookup"><span data-stu-id="a687c-116">PIPE\_ACCESS\_DUPLEX</span></span>   | <span data-ttu-id="a687c-117">универсальное \_ Чтение \| универсальной \_ записи</span><span class="sxs-lookup"><span data-stu-id="a687c-117">GENERIC\_READ \| GENERIC\_WRITE</span></span> |



 

<span data-ttu-id="a687c-118">Если сервер канала создает канал с входящим доступом по КАНАЛу \_ \_ , он доступен только для чтения для сервера канала и предназначен только для записи для клиента канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-118">If the pipe server creates a pipe with PIPE\_ACCESS\_INBOUND, the pipe is read-only for the pipe server and write-only for the pipe client.</span></span> <span data-ttu-id="a687c-119">Если сервер канала создает канал с \_ исходящим доступом к каналу \_ , он доступен только для записи для сервера канала и доступен только для чтения для клиента канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-119">If the pipe server creates a pipe with PIPE\_ACCESS\_OUTBOUND, the pipe is write-only for the pipe server and read-only for the pipe client.</span></span> <span data-ttu-id="a687c-120">Канал, созданный с помощью \_ дуплексного доступа к каналу \_ , доступен для чтения и записи как для сервера канала, так и для клиента канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-120">A pipe created with PIPE\_ACCESS\_DUPLEX is read/write for both the pipe server and the pipe client.</span></span>

<span data-ttu-id="a687c-121">Клиенты канала, использующие [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) для подключения к именованному каналу, должны указать право доступа в параметре *двдесиредакцесс* , совместимом с режимом доступа, заданным сервером канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-121">Pipe clients using [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) to connect to a named pipe must specify an access right in the *dwDesiredAccess* parameter that is compatible with the access mode specified by the pipe server.</span></span> <span data-ttu-id="a687c-122">Например, клиент должен указать универсальный \_ доступ на чтение, чтобы открыть маркер для канала, который сервер канала создал с \_ исходящим доступом к каналу \_ .</span><span class="sxs-lookup"><span data-stu-id="a687c-122">For example, a client must specify GENERIC\_READ access to open a handle for a pipe that the pipe server created with PIPE\_ACCESS\_OUTBOUND.</span></span> <span data-ttu-id="a687c-123">Режимы доступа должны быть одинаковыми для всех экземпляров канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-123">The access modes must be the same for all instances of a pipe.</span></span>

<span data-ttu-id="a687c-124">Для чтения атрибутов канала, например режима чтения или блокировки, обработчик канала должен иметь \_ \_ право доступа к атрибутам чтения файла. для записи атрибутов канала обработчик канала должен иметь \_ \_ право доступа к атрибутам записи файла.</span><span class="sxs-lookup"><span data-stu-id="a687c-124">To read pipe attributes such as the read mode or blocking mode, the pipe handle must have the FILE\_READ\_ATTRIBUTES access right; to write pipe attributes, the pipe handle must have the FILE\_WRITE\_ATTRIBUTES access right.</span></span> <span data-ttu-id="a687c-125">Эти права доступа можно сочетать с универсальным правом доступа, подходящим для канала: УНИВЕРСАЛЬНое \_ Чтение с \_ \_ атрибутами записи файла для канала только для чтения или универсальная \_ запись с \_ атрибутами чтения файла для канала, доступного \_ только для записи.</span><span class="sxs-lookup"><span data-stu-id="a687c-125">These access rights can be combined with the generic access right that is appropriate for the pipe: GENERIC\_READ with FILE\_WRITE\_ATTRIBUTES for a read-only pipe, or GENERIC\_WRITE with FILE\_READ\_ATTRIBUTES for a write-only pipe.</span></span> <span data-ttu-id="a687c-126">Таким образом, ограничиваются права доступа, что обеспечивает лучшую безопасность канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-126">Restricting access rights in this way provides better security for the pipe.</span></span>

## <a name="overlapped-mode"></a><span data-ttu-id="a687c-127">Режим перекрытия</span><span class="sxs-lookup"><span data-stu-id="a687c-127">Overlapped Mode</span></span>

<span data-ttu-id="a687c-128">В режиме OVERLAPPED функции, выполняющие длительные операции чтения, записи и подключения, могут возвращать немедленно.</span><span class="sxs-lookup"><span data-stu-id="a687c-128">In overlapped mode, functions performing lengthy read, write, and connect operations can return immediately.</span></span> <span data-ttu-id="a687c-129">Это позволяет потоку выполнять другие операции во время выполнения длительной операции в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="a687c-129">This enables the thread to perform other operations while a time-consuming operation is executing in the background.</span></span> <span data-ttu-id="a687c-130">Чтобы задать режим перекрытия, используйте \_ \_ флаг перекрытия флага файла.</span><span class="sxs-lookup"><span data-stu-id="a687c-130">To specify overlapped mode, use the FILE\_FLAG\_OVERLAPPED flag.</span></span> <span data-ttu-id="a687c-131">Дополнительные сведения см. в разделе [синхронные и перекрывающиеся входные и выходные](synchronous-and-overlapped-input-and-output.md)данные.</span><span class="sxs-lookup"><span data-stu-id="a687c-131">For more information, see [Synchronous and Overlapped Input and Output](synchronous-and-overlapped-input-and-output.md).</span></span>

<span data-ttu-id="a687c-132">Функция [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) позволяет клиенту канала задать режим перекрытия ( \_ Перекрытие флагов файлов \_ ) для дескрипторов канала с помощью параметра *двфлагсандаттрибутес* .</span><span class="sxs-lookup"><span data-stu-id="a687c-132">The [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function allows the pipe client to set overlapped mode (FILE\_FLAG\_OVERLAPPED) for its pipe handles using the *dwFlagsAndAttributes* parameter.</span></span>

## <a name="write-through-mode"></a><span data-ttu-id="a687c-133">Режим Write-Through</span><span class="sxs-lookup"><span data-stu-id="a687c-133">Write-Through Mode</span></span>

<span data-ttu-id="a687c-134">Укажите режим сквозной записи с \_ записью флага файла с \_ \_ помощью.</span><span class="sxs-lookup"><span data-stu-id="a687c-134">Specify write-through mode with FILE\_FLAG\_WRITE\_THROUGH.</span></span> <span data-ttu-id="a687c-135">Этот режим влияет только на операции записи для каналов типа Byte между клиентами канала и серверами каналов на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="a687c-135">This mode affects only write operations to byte-type pipes between pipe clients and pipe servers on different computers.</span></span> <span data-ttu-id="a687c-136">В режиме сквозной записи функции, которые выполняют запись в именованный канал, не возвращают данные, пока они не передаются по сети и в буфер канала на удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="a687c-136">In write-through mode, the functions that write to a named pipe do not return until the data is transmitted across the network and into the pipe's buffer on the remote computer.</span></span> <span data-ttu-id="a687c-137">Режим сквозной записи удобен для приложений, требующих синхронизации при каждой операции записи.</span><span class="sxs-lookup"><span data-stu-id="a687c-137">Write-through mode is useful for applications that require synchronization for every write operation.</span></span>

<span data-ttu-id="a687c-138">Если режим сквозной записи не включен, система повышает эффективность сетевых операций путем буферизации данных до тех пор, пока не будет накоплено минимальное число байтов или пока не истечет максимальный период времени.</span><span class="sxs-lookup"><span data-stu-id="a687c-138">If write-through mode is not enabled, the system enhances the efficiency of network operations by buffering data until a minimum number of bytes have accumulated or until a maximum time period has elapsed.</span></span> <span data-ttu-id="a687c-139">Буферизация позволяет системе объединить несколько операций записи в одну сетевую передачу.</span><span class="sxs-lookup"><span data-stu-id="a687c-139">Buffering enables the system to combine multiple write operations into a single network transmission.</span></span> <span data-ttu-id="a687c-140">Это означает, что операция записи может быть успешно завершена после того, как система поместит данные в исходящий буфер, но до того, как система передаст их по сети.</span><span class="sxs-lookup"><span data-stu-id="a687c-140">This means that a write operation can be successfully completed after the system puts the data in the outbound buffer, but before the system transmits it across the network.</span></span>

<span data-ttu-id="a687c-141">Функция [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) позволяет клиенту канала установить режим сквозной записи ( \_ флаг \_ записи \_ в файл) для дескрипторов канала с помощью параметра *двфлагсандаттрибутес* .</span><span class="sxs-lookup"><span data-stu-id="a687c-141">The [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function allows the pipe client to set write-through mode (FILE\_FLAG\_WRITE\_THROUGH) for its pipe handles using the *dwFlagsAndAttributes* parameter.</span></span> <span data-ttu-id="a687c-142">Режим сквозной записи для обработчика канала нельзя изменить после создания маркера канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-142">The write-through mode of a pipe handle cannot be changed after the pipe handle has been created.</span></span> <span data-ttu-id="a687c-143">Режим сквозной записи может отличаться для обработки сервером и клиентом одного и того же экземпляра канала.</span><span class="sxs-lookup"><span data-stu-id="a687c-143">The write-through mode can be different for server and client handles to the same pipe instance.</span></span>

<span data-ttu-id="a687c-144">Клиент канала может использовать функцию [**сетнамедпипехандлестате**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) для управления числом байтов и периодом ожидания перед передачей для канала, в котором отключен режим сквозной записи.</span><span class="sxs-lookup"><span data-stu-id="a687c-144">A pipe client can use the [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) function to control the number of bytes and the time-out period before transmission for a pipe on which write-through mode is disabled.</span></span> <span data-ttu-id="a687c-145">Для канала, доступного только для чтения, обработчик канала должен быть открыт с общими \_ \_ \_ правами доступа к атрибутам чтения и записи файла.</span><span class="sxs-lookup"><span data-stu-id="a687c-145">For a read-only pipe, the pipe handle must be opened with the GENERIC\_READ and FILE\_WRITE\_ATTRIBUTES access rights.</span></span>

 

 
