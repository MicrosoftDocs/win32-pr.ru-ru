---
description: При вызове функции Креатенамедпипе можно указать дескриптор безопасности для именованного канала. Дескриптор безопасности управляет доступом к клиентским и серверным концам именованного канала.
ms.assetid: f9ea97c9-9a97-4083-82d8-29ffb8be5a77
title: Безопасность именованного канала и права доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11cada606d8197ac2f64943aa742bbfd614fa4ef
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105647399"
---
# <a name="named-pipe-security-and-access-rights"></a><span data-ttu-id="6375d-104">Безопасность именованного канала и права доступа</span><span class="sxs-lookup"><span data-stu-id="6375d-104">Named Pipe Security and Access Rights</span></span>

<span data-ttu-id="6375d-105">Система безопасности Windows позволяет управлять доступом к именованным каналам.</span><span class="sxs-lookup"><span data-stu-id="6375d-105">Windows security enables you to control access to named pipes.</span></span> <span data-ttu-id="6375d-106">Дополнительные сведения о безопасности см. в разделе [модель управления доступом](/windows/desktop/SecAuthZ/access-control-model).</span><span class="sxs-lookup"><span data-stu-id="6375d-106">For more information about security, see [Access-Control Model](/windows/desktop/SecAuthZ/access-control-model).</span></span>

<span data-ttu-id="6375d-107">При вызове функции [**креатенамедпипе**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) можно указать [дескриптор безопасности](/windows/desktop/SecAuthZ/security-descriptors) для именованного канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-107">You can specify a [security descriptor](/windows/desktop/SecAuthZ/security-descriptors) for a named pipe when you call the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function.</span></span> <span data-ttu-id="6375d-108">Дескриптор безопасности управляет доступом к клиентским и серверным концам именованного канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-108">The security descriptor controls access to both client and server ends of the named pipe.</span></span> <span data-ttu-id="6375d-109">Если указано **значение NULL**, именованный канал получает дескриптор безопасности по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6375d-109">If you specify **NULL**, the named pipe gets a default security descriptor.</span></span> <span data-ttu-id="6375d-110">Списки управления доступом в дескрипторе безопасности по умолчанию для именованного канала предоставляют полный доступ учетной записи LocalSystem, администраторам и владельцу создателя.</span><span class="sxs-lookup"><span data-stu-id="6375d-110">The ACLs in the default security descriptor for a named pipe grant full control to the LocalSystem account, administrators, and the creator owner.</span></span> <span data-ttu-id="6375d-111">Они также предоставляют доступ на чтение членам группы "все" и анонимной учетной записи.</span><span class="sxs-lookup"><span data-stu-id="6375d-111">They also grant read access to members of the Everyone group and the anonymous account.</span></span>

<span data-ttu-id="6375d-112">Чтобы получить дескриптор безопасности именованного канала, вызовите функцию [**жетсекуритинфо**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="6375d-112">To retrieve a named pipe's security descriptor, call the [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="6375d-113">Чтобы изменить дескриптор безопасности именованного канала, вызовите функцию [**сетсекуритинфо**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="6375d-113">To change the security descriptor of a named pipe, call the [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="6375d-114">Когда поток вызывает [**креатенамедпипе**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) для открытия маркера на стороне сервера существующего именованного канала, система выполняет проверку доступа перед возвратом маркера.</span><span class="sxs-lookup"><span data-stu-id="6375d-114">When a thread calls [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) to open a handle to the server end of an existing named pipe, the system performs an access check before returning the handle.</span></span> <span data-ttu-id="6375d-115">Проверка доступа сравнивает маркер доступа потока и запрашиваемые [права доступа](/windows/desktop/SecAuthZ/access-rights-and-access-masks) с DACL в дескрипторе безопасности именованного канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-115">The access check compares the thread's access token and the requested [access rights](/windows/desktop/SecAuthZ/access-rights-and-access-masks) against the DACL in the named pipe's security descriptor.</span></span> <span data-ttu-id="6375d-116">Помимо запрошенных прав доступа, список DACL должен разрешить файлу вызывающего потока \_ создать \_ экземпляр канала, \_ обращающийся к именованному каналу.</span><span class="sxs-lookup"><span data-stu-id="6375d-116">In addition to the requested access rights, the DACL must allow the calling thread FILE\_CREATE\_PIPE\_INSTANCE access to the named pipe.</span></span>

<span data-ttu-id="6375d-117">Аналогично, когда клиент вызывает функцию [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) или [**каллнамедпипе**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) для подключения к клиентской части именованного канала, система выполняет проверку доступа перед предоставлением доступа клиенту.</span><span class="sxs-lookup"><span data-stu-id="6375d-117">Similarly, when a client calls the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) function to connect to the client end of a named pipe, the system performs an access check before granting access to the client.</span></span>

<span data-ttu-id="6375d-118">Маркер, возвращаемый функцией [**креатенамедпипе**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) , всегда имеет доступ к синхронизации.</span><span class="sxs-lookup"><span data-stu-id="6375d-118">The handle returned by the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function always has SYNCHRONIZE access.</span></span> <span data-ttu-id="6375d-119">Он также имеет УНИВЕРСАЛЬНое \_ чтение, универсальную \_ запись или и то, и другое, в зависимости от режима открытия канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-119">It also has GENERIC\_READ, GENERIC\_WRITE, or both, depending on the open mode of the pipe.</span></span> <span data-ttu-id="6375d-120">Ниже приведены права доступа для каждого открытого режима.</span><span class="sxs-lookup"><span data-stu-id="6375d-120">The following are the access rights for each open mode.</span></span>



| <span data-ttu-id="6375d-121">Режим открытия</span><span class="sxs-lookup"><span data-stu-id="6375d-121">Open mode</span></span>                           | <span data-ttu-id="6375d-122">Права доступа</span><span class="sxs-lookup"><span data-stu-id="6375d-122">Access rights</span></span>                                              |
|-------------------------------------|------------------------------------------------------------|
| <span data-ttu-id="6375d-123">\_Дуплексный доступ к каналу \_ (0x00000003)</span><span class="sxs-lookup"><span data-stu-id="6375d-123">PIPE\_ACCESS\_DUPLEX (0x00000003)</span></span>   | <span data-ttu-id="6375d-124">\_Общий \_ доступ для чтения, \_ Общая \_ запись и синхронизация файлов</span><span class="sxs-lookup"><span data-stu-id="6375d-124">FILE\_GENERIC\_READ, FILE\_GENERIC\_WRITE, and SYNCHRONIZE</span></span> |
| <span data-ttu-id="6375d-125">\_Входящий доступ к каналу \_ (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="6375d-125">PIPE\_ACCESS\_INBOUND (0x00000001)</span></span>  | <span data-ttu-id="6375d-126">Общий файл для \_ \_ чтения и синхронизации</span><span class="sxs-lookup"><span data-stu-id="6375d-126">FILE\_GENERIC\_READ and SYNCHRONIZE</span></span>                        |
| <span data-ttu-id="6375d-127">\_Исходящий доступ к каналу \_ (0x00000002)</span><span class="sxs-lookup"><span data-stu-id="6375d-127">PIPE\_ACCESS\_OUTBOUND (0x00000002)</span></span> | <span data-ttu-id="6375d-128">\_Общая \_ запись и синхронизация файла</span><span class="sxs-lookup"><span data-stu-id="6375d-128">FILE\_GENERIC\_WRITE and SYNCHRONIZE</span></span>                       |



 

<span data-ttu-id="6375d-129">\_Общий \_ доступ на чтение файлов для именованного канала объединяет права на чтение данных из канала, чтение атрибутов канала, чтение расширенных атрибутов и чтение списка DACL канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-129">FILE\_GENERIC\_READ access for a named pipe combines the rights to read data from the pipe, read pipe attributes, read extended attributes, and read the pipe's DACL.</span></span>

<span data-ttu-id="6375d-130">ФАЙЛовый \_ \_ доступ на запись для именованного канала объединяет права на запись данных в канал, добавляет к нему данные, записывает атрибуты канала, записывает расширенные атрибуты и считывает список DACL канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-130">FILE\_GENERIC\_WRITE access for a named pipe combines the rights to write data to the pipe, append data to it, write pipe attributes, write extended attributes, and read the pipe's DACL.</span></span> <span data-ttu-id="6375d-131">Так как \_ файл \_ для добавления данных и файл \_ создания \_ канала \_ имеют одинаковое определение, так что файл с \_ общей \_ записью предоставляет разрешение на создание канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-131">Because FILE\_APPEND\_DATA and FILE\_CREATE\_PIPE\_INSTANCE have the same definition, so FILE\_GENERIC\_WRITE enables permission to create the pipe.</span></span> <span data-ttu-id="6375d-132">Чтобы избежать этой проблемы, используйте индивидуальные права вместо использования \_ обычного файла \_ для записи.</span><span class="sxs-lookup"><span data-stu-id="6375d-132">To avoid this problem, use the individual rights instead of using FILE\_GENERIC\_WRITE.</span></span>

<span data-ttu-id="6375d-133">Можно запросить \_ право доступа к системе \_ безопасности системы доступа к объекту именованного канала, если требуется прочитать или записать список SACL объекта.</span><span class="sxs-lookup"><span data-stu-id="6375d-133">You can request the ACCESS\_SYSTEM\_SECURITY access right to a named pipe object if you want to read or write the object's SACL.</span></span> <span data-ttu-id="6375d-134">Дополнительные сведения см. в разделе [списки управления доступом (ACL)](/windows/desktop/SecAuthZ/access-control-lists) и [права доступа к спискам SACL](/windows/desktop/SecAuthZ/sacl-access-right).</span><span class="sxs-lookup"><span data-stu-id="6375d-134">For more information, see [Access-Control Lists (ACLs)](/windows/desktop/SecAuthZ/access-control-lists) and [SACL Access Right](/windows/desktop/SecAuthZ/sacl-access-right).</span></span>

<span data-ttu-id="6375d-135">Чтобы запретить удаленным пользователям или пользователям, использующим разные сеансы служб терминалов, доступ к именованному каналу, используйте идентификатор SID входа в список DACL для канала.</span><span class="sxs-lookup"><span data-stu-id="6375d-135">To prevent remote users or users on a different terminal services session from accessing a named pipe, use the logon SID on the DACL for the pipe.</span></span> <span data-ttu-id="6375d-136">Идентификатор безопасности входа в систему используется также в качестве входов в систему. Это идентификатор безопасности, используемый для защиты пространства имен объектов для каждого сеанса.</span><span class="sxs-lookup"><span data-stu-id="6375d-136">The logon SID is used in run-as logons as well; it is the SID used to protect the per-session object namespace.</span></span> <span data-ttu-id="6375d-137">Дополнительные сведения см. [в разделе Получение идентификатора безопасности для входа в C++](/previous-versions//aa446670(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6375d-137">For more information, see [Getting the Logon SID in C++](/previous-versions//aa446670(v=vs.85)).</span></span>

 

 
