---
description: Неправильно настроенный брандмауэр может привести к сбою приложений WSD.
ms.assetid: eba61235-29b4-463a-b7c5-d34d3b39b095
title: Проверка параметров адаптера и брандмауэра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 490909c9f3acdc3025e72350118f303bfdae73d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104344875"
---
# <a name="inspecting-adapter-and-firewall-settings"></a><span data-ttu-id="9901c-103">Проверка параметров адаптера и брандмауэра</span><span class="sxs-lookup"><span data-stu-id="9901c-103">Inspecting Adapter and Firewall Settings</span></span>

<span data-ttu-id="9901c-104">Неправильно настроенный брандмауэр может привести к сбою приложений WSD.</span><span class="sxs-lookup"><span data-stu-id="9901c-104">A misconfigured firewall can cause WSD applications to fail.</span></span> <span data-ttu-id="9901c-105">В этом разделе приведены некоторые процедуры устранения неполадок, которые можно использовать, когда клиенты и узлы WSD не могут видеть друг друга в сети.</span><span class="sxs-lookup"><span data-stu-id="9901c-105">This topic provides some troubleshooting procedures to use when WSD clients and hosts cannot see each other on the network.</span></span> <span data-ttu-id="9901c-106">Перед использованием любых других процедур устранения неполадок приложений необходимо проверить параметры брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="9901c-106">The firewall settings should be inspected before using any other application troubleshooting procedure.</span></span>

<span data-ttu-id="9901c-107">**Проверка параметров адаптера и брандмауэра**</span><span class="sxs-lookup"><span data-stu-id="9901c-107">**To inspect the adapter and firewall settings**</span></span>

1.  <span data-ttu-id="9901c-108">Убедитесь, что исключение **обнаружения сети** включено.</span><span class="sxs-lookup"><span data-stu-id="9901c-108">Verify that the **Network Discovery** exception is enabled.</span></span>
2.  <span data-ttu-id="9901c-109">Убедитесь, что приложение не блокирует правила брандмауэра, зависящие от приложения.</span><span class="sxs-lookup"><span data-stu-id="9901c-109">Check that there are no application-specific firewall rules blocking the application.</span></span>
3.  <span data-ttu-id="9901c-110">Явно включите порты, используемые для обнаружения и обмена метаданными.</span><span class="sxs-lookup"><span data-stu-id="9901c-110">Explicitly enable the ports used for discovery and metadata exchange.</span></span>
4.  <span data-ttu-id="9901c-111">Отключите брандмауэр и повторно протестируйте приложение.</span><span class="sxs-lookup"><span data-stu-id="9901c-111">Disable the firewall and retest the application.</span></span>
    > [!Note]  
    > <span data-ttu-id="9901c-112">После завершения этого шага необходимо снова включить брандмауэр.</span><span class="sxs-lookup"><span data-stu-id="9901c-112">The firewall should be re-enabled after completing this step.</span></span>

     

## <a name="verifying-that-the-network-discovery-exception-is-enabled"></a><span data-ttu-id="9901c-113">Проверка того, что исключение обнаружения сети включено</span><span class="sxs-lookup"><span data-stu-id="9901c-113">Verifying that the Network Discovery exception is enabled</span></span>

<span data-ttu-id="9901c-114">Если выполняются какие WS-Discovery приложения, необходимо разрешить исключение брандмауэра **сетевого обнаружения** .</span><span class="sxs-lookup"><span data-stu-id="9901c-114">If any WS-Discovery applications are running, the **Network Discovery** firewall exception must be allowed.</span></span>

<span data-ttu-id="9901c-115">**Включение исключения брандмауэра сетевого обнаружения**</span><span class="sxs-lookup"><span data-stu-id="9901c-115">**To enable the Network Discovery firewall exception**</span></span>

1.  <span data-ttu-id="9901c-116">Нажмите кнопку **Пуск**, выберите пункт **выполнить** и введите **firewall.cpl**.</span><span class="sxs-lookup"><span data-stu-id="9901c-116">Click **Start**, click **Run**, and then type **firewall.cpl**.</span></span> <span data-ttu-id="9901c-117">Откроется окно приложения **панели управления Брандмауэр Windows** .</span><span class="sxs-lookup"><span data-stu-id="9901c-117">This opens the **Windows Firewall Control Panel** applet.</span></span>
2.  <span data-ttu-id="9901c-118">Выберите **Разрешить программу через брандмауэр Windows**.</span><span class="sxs-lookup"><span data-stu-id="9901c-118">Choose **Allow a program through Windows Firewall**.</span></span>
3.  <span data-ttu-id="9901c-119">На вкладке **исключения** установите флажок **Обнаружение сети** .</span><span class="sxs-lookup"><span data-stu-id="9901c-119">On the **Exceptions** tab, select the **Network Discovery** check box.</span></span>
4.  <span data-ttu-id="9901c-120">Нажмите кнопку **ОК** , чтобы закрыть приложение брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="9901c-120">Click **OK** to close the firewall applet.</span></span>

<span data-ttu-id="9901c-121">Повторно протестируйте программу после внесения этого изменения в брандмауэр.</span><span class="sxs-lookup"><span data-stu-id="9901c-121">Retest the program after making this firewall change.</span></span> <span data-ttu-id="9901c-122">Если программа теперь успешно работает, причина проблемы определена, и дальнейшие действия по устранению неполадок не требуются.</span><span class="sxs-lookup"><span data-stu-id="9901c-122">If the program now works successfully, the cause of the problem has been identified and no further troubleshooting steps are necessary.</span></span> <span data-ttu-id="9901c-123">В противном случае переходите к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="9901c-123">Otherwise, move on to the next step.</span></span>

## <a name="checking-for-application-specific-firewall-rules"></a><span data-ttu-id="9901c-124">Проверка правил брандмауэра, зависящих от приложения</span><span class="sxs-lookup"><span data-stu-id="9901c-124">Checking for application-specific firewall rules</span></span>

<span data-ttu-id="9901c-125">Расширенная настройка брандмауэра Windows может выполняться в оснастке Microsoft Management Control (MMC) с именем " **Брандмауэр Windows в области повышенной безопасности**".</span><span class="sxs-lookup"><span data-stu-id="9901c-125">Advanced configuration of the Windows Firewall can take place in a Microsoft Management Control (MMC) snap-in named **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="9901c-126">Эту оснастку можно использовать для устранения возможных проблем с брандмауэром.</span><span class="sxs-lookup"><span data-stu-id="9901c-126">This snap-in can be used to troubleshoot suspected firewall problems.</span></span>

<span data-ttu-id="9901c-127">Для создания правил брандмауэра, применяемых к приложениям WSD, разработчики могут использовать [Брандмауэр Windows в составе](/previous-versions/windows/desktop/ics/windows-firewall-with-advanced-security-reference) API-интерфейсов повышенной безопасности.</span><span class="sxs-lookup"><span data-stu-id="9901c-127">Developers can use the [Windows Firewall with Advanced Security](/previous-versions/windows/desktop/ics/windows-firewall-with-advanced-security-reference) APIs to create firewall rules that apply to their WSD applications.</span></span> <span data-ttu-id="9901c-128">В частности, метод [**Add**](/previous-versions/windows/desktop/api/netfw/nf-netfw-inetfwrules-add) интерфейса [**инетфврулес**](/previous-versions/windows/desktop/api/netfw/nn-netfw-inetfwrules) можно использовать для добавления нового правила брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="9901c-128">Specifically, the [**Add**](/previous-versions/windows/desktop/api/netfw/nf-netfw-inetfwrules-add) method of the [**INetFwRules**](/previous-versions/windows/desktop/api/netfw/nn-netfw-inetfwrules) interface can be used to add a new firewall rule.</span></span> <span data-ttu-id="9901c-129">Если правила брандмауэра созданы неправильно, клиенты и узлы могут не видеть друг друга в сети.</span><span class="sxs-lookup"><span data-stu-id="9901c-129">If firewall rules are created incorrectly, clients and hosts may not be able to see each other on the network.</span></span>

<span data-ttu-id="9901c-130">**Проверка правил брандмауэра, зависящих от приложения**</span><span class="sxs-lookup"><span data-stu-id="9901c-130">**To check for application-specific firewall rules**</span></span>

1.  <span data-ttu-id="9901c-131">Нажмите кнопку **Пуск**, выберите пункт **выполнить** и введите **WF. msc**.</span><span class="sxs-lookup"><span data-stu-id="9901c-131">Click **Start**, click **Run**, and then type **wf.msc**.</span></span>
2.  <span data-ttu-id="9901c-132">Найдите правила для конкретного приложения, которые могут блокировать трафик.</span><span class="sxs-lookup"><span data-stu-id="9901c-132">Look for application-specific rules that may be blocking traffic.</span></span> <span data-ttu-id="9901c-133">Дополнительные сведения см. в разделе [Брандмауэр Windows в расширенной безопасности — средства диагностики и устранения неполадок](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc722062(v=ws.10)?ocid=fwlink).</span><span class="sxs-lookup"><span data-stu-id="9901c-133">For more information, see [Windows Firewall with Advanced Security - Diagnostics and Troubleshooting Tools](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc722062(v=ws.10)?ocid=fwlink).</span></span>
3.  <span data-ttu-id="9901c-134">Удалите правила для конкретных приложений.</span><span class="sxs-lookup"><span data-stu-id="9901c-134">Remove application-specific rules.</span></span>

<span data-ttu-id="9901c-135">Если правила для конкретного приложения не найдены, переходите к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="9901c-135">If no application-specific rules were found, move on to the next step.</span></span> <span data-ttu-id="9901c-136">Если правило для конкретного приложения было найдено и удалено, повторно протестируйте программу после внесения изменений в брандмауэр.</span><span class="sxs-lookup"><span data-stu-id="9901c-136">If an application-specific rule was found and removed, retest the program after making the firewall change.</span></span> <span data-ttu-id="9901c-137">Если программа теперь успешно работает, причина проблемы определена, и дальнейшие действия по устранению неполадок не требуются.</span><span class="sxs-lookup"><span data-stu-id="9901c-137">If the program now works successfully, the cause of the problem has been identified and no further troubleshooting steps are necessary.</span></span> <span data-ttu-id="9901c-138">В противном случае переходите к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="9901c-138">Otherwise, move on to the next step.</span></span>

## <a name="enabling-the-ports-used-for-discovery-and-metadata-exchange"></a><span data-ttu-id="9901c-139">Включение портов, используемых для обнаружения и обмена метаданными</span><span class="sxs-lookup"><span data-stu-id="9901c-139">Enabling the ports used for discovery and metadata exchange</span></span>

<span data-ttu-id="9901c-140">WS-Discovery использует UDP-порт 3702 для обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="9901c-140">WS-Discovery uses the UDP port 3702 for message exchange.</span></span> <span data-ttu-id="9901c-141">Кроме того, для обмена метаданными иногда используются TCP-порты 5357 и 5358.</span><span class="sxs-lookup"><span data-stu-id="9901c-141">In addition, TCP ports 5357 and 5358 are sometimes used for metadata exchange.</span></span> <span data-ttu-id="9901c-142">Эти порты можно явно открыть в брандмауэре, выполнив процедуры, описанные в разделе [Открытие порта в брандмауэре Windows](https://windowshelp.microsoft.com/Windows/Help/4da18300-9044-47b6-9038-595c78db81ab1033.mspx).</span><span class="sxs-lookup"><span data-stu-id="9901c-142">These ports can be explicitly opened on the firewall using the procedures described in [Open a port in Windows Firewall](https://windowshelp.microsoft.com/Windows/Help/4da18300-9044-47b6-9038-595c78db81ab1033.mspx).</span></span>

<span data-ttu-id="9901c-143">Повторно протестируйте программу после внесения этого изменения в брандмауэр.</span><span class="sxs-lookup"><span data-stu-id="9901c-143">Retest the program after making this firewall change.</span></span> <span data-ttu-id="9901c-144">Если программа теперь успешно работает, причина проблемы определена, и дальнейшие действия по устранению неполадок не требуются.</span><span class="sxs-lookup"><span data-stu-id="9901c-144">If the program now works successfully, the cause of the problem has been identified and no further troubleshooting steps are necessary.</span></span> <span data-ttu-id="9901c-145">В противном случае переходите к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="9901c-145">Otherwise, move on to the next step.</span></span>

## <a name="disabling-the-firewall"></a><span data-ttu-id="9901c-146">Отключение брандмауэра</span><span class="sxs-lookup"><span data-stu-id="9901c-146">Disabling the firewall</span></span>

<span data-ttu-id="9901c-147">Брандмауэр Windows можно отключить, чтобы помочь в устранении возможных проблем.</span><span class="sxs-lookup"><span data-stu-id="9901c-147">The Windows Firewall can be disabled to help troubleshoot suspected problems.</span></span> <span data-ttu-id="9901c-148">Другие применимые брандмауэры (например, брандмауэр на маршрутизаторе) также можно отключить в целях устранения неполадок.</span><span class="sxs-lookup"><span data-stu-id="9901c-148">Other applicable firewalls (such as the firewall on a router) can also be disabled for troubleshooting purposes.</span></span> <span data-ttu-id="9901c-149">Сведения о включении и отключении брандмауэра Windows см. [в разделе Включение или отключение брандмауэра](https://windowshelp.microsoft.com/Windows/Help/bfe523a9-7eec-4d3f-add1-2f68b9cfa1c01033.mspx)Windows.</span><span class="sxs-lookup"><span data-stu-id="9901c-149">For information about enabling and disabling the Windows Firewall, see [Turn Windows Firewall on or off](https://windowshelp.microsoft.com/Windows/Help/bfe523a9-7eec-4d3f-add1-2f68b9cfa1c01033.mspx).</span></span>

<span data-ttu-id="9901c-150">Повторно протестируйте приложение после отключения всех применимых брандмауэров.</span><span class="sxs-lookup"><span data-stu-id="9901c-150">Retest the application after disabling any applicable firewalls.</span></span> <span data-ttu-id="9901c-151">Если программа теперь работает успешно, брандмауэр блокирует трафик.</span><span class="sxs-lookup"><span data-stu-id="9901c-151">If the program now works successfully, then the firewall was blocking the traffic.</span></span> <span data-ttu-id="9901c-152">Существует несколько возможных причин блокировки трафика.</span><span class="sxs-lookup"><span data-stu-id="9901c-152">There are a few possible causes of blocked traffic.</span></span>

-   <span data-ttu-id="9901c-153">Трафик блокируется исключениями, специфичными для приложения.</span><span class="sxs-lookup"><span data-stu-id="9901c-153">Application-specific exceptions blocked the traffic.</span></span> <span data-ttu-id="9901c-154">Проверьте правила брандмауэра, зависящие от приложения, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="9901c-154">Check for application-specific firewall rules as described above.</span></span>
-   <span data-ttu-id="9901c-155">Устройство заняло слишком много времени для ответа на UDP-запросы.</span><span class="sxs-lookup"><span data-stu-id="9901c-155">The device took too long to respond to UDP requests.</span></span> <span data-ttu-id="9901c-156">Брандмауэр Windows может блокировать UDP-ответы, которые возвращают более 4 секунд после отправки первоначального запроса.</span><span class="sxs-lookup"><span data-stu-id="9901c-156">The Windows Firewall may block UDP responses that return more than 4 seconds after the initial request was sent.</span></span> <span data-ttu-id="9901c-157">Продолжайте устранение неполадок, выполнив процедуры, описанные в разделе [Использование универсального узла и клиента для UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md) , чтобы узнать, не возникает ли проблема с узлом, который реагирует менее чем на 4 секунды.</span><span class="sxs-lookup"><span data-stu-id="9901c-157">Continue troubleshooting by following the procedures given in [Using a Generic Host and Client for UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md) to see if the problem reproduces with a host that responds in less than 4 seconds.</span></span>

<span data-ttu-id="9901c-158">Если после отключения брандмауэра приложение по-прежнему не работает, брандмауэр не вызывает сбой приложения.</span><span class="sxs-lookup"><span data-stu-id="9901c-158">If the application still fails after the firewall is disabled, then the firewall is not causing the application failure.</span></span> <span data-ttu-id="9901c-159">Повторно включите брандмауэры и продолжайте устранение неполадок, выполнив процедуры, описанные в статье [Использование универсального узла и клиента для протокола UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="9901c-159">Re-enable the firewalls and continue troubleshooting by following the procedures given in [Using a Generic Host and Client for UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md).</span></span>

<span data-ttu-id="9901c-160">После устранения неполадок брандмауэры всегда должны быть включены снова.</span><span class="sxs-lookup"><span data-stu-id="9901c-160">Firewalls should always be re-enabled after troubleshooting has finished.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9901c-161">См. также</span><span class="sxs-lookup"><span data-stu-id="9901c-161">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9901c-162">Процедуры диагностики WSDAPI</span><span class="sxs-lookup"><span data-stu-id="9901c-162">WSDAPI Diagnostic Procedures</span></span>](wsdapi-diagnostic-procedures.md)
</dt> <dt>

[<span data-ttu-id="9901c-163">начало работы с разрешениями WSDAPI</span><span class="sxs-lookup"><span data-stu-id="9901c-163">Getting Started with WSDAPI Troubleshooting</span></span>](getting-started-with-wsdapi-troubleshooting.md)
</dt> </dl>

 

 
