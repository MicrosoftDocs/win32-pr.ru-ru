---
description: В этом разделе описывается поддержка многосетевой поддержки устройств в WSDAPI и предоставляются рекомендации по реализации для разработчиков клиентов и устройств.
ms.assetid: d30ed536-d477-4f50-8c80-aacc35f948b9
title: Реализация многосетевого устройства WSD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ac3537b96a577db47419d55cb5c6f732f8f7906
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272424"
---
# <a name="implementing-a-multi-homed-wsd-device"></a><span data-ttu-id="b2d7b-103">Реализация многосетевого устройства WSD</span><span class="sxs-lookup"><span data-stu-id="b2d7b-103">Implementing a Multi-Homed WSD Device</span></span>

<span data-ttu-id="b2d7b-104">[WS-Discovery](https://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf) и [профиль устройств для веб-служб](https://specs.xmlsoap.org/ws/2006/02/devprof/) (DPWS) не описывают реализацию устройств с несколькими сетевыми интерфейсами.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-104">[WS-Discovery](https://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf) and the [Devices Profile for Web Services](https://specs.xmlsoap.org/ws/2006/02/devprof/) (DPWS) do not describe the implementation of multi-homed devices.</span></span> <span data-ttu-id="b2d7b-105">В этом разделе описывается поддержка многосетевой поддержки устройств в WSDAPI и предоставляются рекомендации по реализации для разработчиков клиентов и устройств.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-105">This topic describes multi-homed device support in WSDAPI, and provides implementation recommendations to client and device developers.</span></span> <span data-ttu-id="b2d7b-106">В этом разделе предполагается, что сообщения обнаружения отправляются по протоколам IPv4 и IPv6 (если они доступны) с одинаковым ИДЕНТИФИКАТОРом сообщения и сведениями о последовательности приложений.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-106">In this topic, it is assumed that discovery messages are sent over both IPv4 and IPv6 (if available) with the same message ID and application sequencing information.</span></span>

## <a name="discovery-in-a-multi-homed-environment"></a><span data-ttu-id="b2d7b-107">Обнаружение в среде с несколькими сетевыми интерфейсами</span><span class="sxs-lookup"><span data-stu-id="b2d7b-107">Discovery in a multi-homed environment</span></span>

<span data-ttu-id="b2d7b-108">Как упоминалось в разделе [Hello](hello-message.md) и [ксаддрс](xaddr-validation-rules.md) [дополнительных функций WS-Discovery](additional-ws-discovery-functionality.md), WSDAPI никогда не предоставляет ксаддрс в сообщении Hello.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-108">As mentioned in [Hello](hello-message.md) and [XAddrs](xaddr-validation-rules.md) section of [Additional WS-Discovery Functionality](additional-ws-discovery-functionality.md), WSDAPI never provides XAddrs in a Hello message.</span></span> <span data-ttu-id="b2d7b-109">Это означает, что одно и то же сообщение Hello можно отправить по всем сетевым интерфейсам с одинаковым ИДЕНТИФИКАТОРом сообщения и сведениями о последовательности приложений.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-109">That means the same Hello message can be sent on all network interfaces with the same message ID and application sequencing information.</span></span> <span data-ttu-id="b2d7b-110">Это упрощает обнаружение конфликтов клиентов для удаления нескольких сообщений Hello с одного и того же устройства, когда клиент и устройство совместно используют более одной подсети.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-110">This makes it easier for client collision detection to discard multiple Hello messages from the same device when a client and the device share more than one subnet.</span></span>

<span data-ttu-id="b2d7b-111">Так как [ксаддрс](xaddr-validation-rules.md) не отправляются в сообщении [Hello](hello-message.md) , клиентские реализации должны отправить сообщение с [разрешением](resolve-message.md) , чтобы получить соответствующий адрес устройства.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-111">Because the [XAddrs](xaddr-validation-rules.md) are not sent in the [Hello](hello-message.md) message, client implementations must send a [Resolve](resolve-message.md) message to get the relevant device address.</span></span> <span data-ttu-id="b2d7b-112">Разрешение следует отправлять для всех клиентских интерфейсов с тем же ИДЕНТИФИКАТОРом сообщения, и устройство должно фильтровать дублирующиеся сообщения по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-112">The Resolve should be sent on all client interfaces with the same message ID, and the device should filter duplicate messages as needed.</span></span> <span data-ttu-id="b2d7b-113">Использование того же идентификатора сообщения для сообщения с разрешением позволяет устройству выбрать предпочтительный интерфейс для взаимодействия с клиентами, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-113">Using the same message ID for the Resolve message allows the device to pick a preferred interface for communicating with clients if necessary.</span></span>

<span data-ttu-id="b2d7b-114">При отправке сообщения [ресолвематч](resolvematches-message.md) устройство должно предоставлять [ксаддрс](xaddr-validation-rules.md) , относящиеся к сетевому интерфейсу, для которого он является одноадресным.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-114">When sending a [ResolveMatch](resolvematches-message.md) message, a device should provide [XAddrs](xaddr-validation-rules.md) that relate to the network interface over which it is unicasting the message.</span></span> <span data-ttu-id="b2d7b-115">Такой подход позволяет избежать множественных попыток подключения клиентов и сложной логики повторных попыток.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-115">This practice helps to avoid multiple client connection attempts and complicated retry logic.</span></span>

## <a name="metadata-exchange-in-a-multi-homed-environment"></a><span data-ttu-id="b2d7b-116">Обмен метаданными в среде с несколькими сетевыми интерфейсами</span><span class="sxs-lookup"><span data-stu-id="b2d7b-116">Metadata exchange in a multi-homed environment</span></span>

<span data-ttu-id="b2d7b-117">Реализация обмена метаданными в среде с несколькими сетевыми средами сложнее, чем реализация обнаружения из-за управления версиями метаданных.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-117">Implementing metadata exchange in a multi-homed environment is more difficult than implementing discovery because of metadata versioning.</span></span> <span data-ttu-id="b2d7b-118">Если клиент запрашивает метаданные через несколько интерфейсов, клиент может получить несколько сообщений [GetResponse](getresponse--metadata-exchange--message.md) через различные интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-118">If a client requests metadata over multiple interfaces, then the client can receive multiple [GetResponse](getresponse--metadata-exchange--message.md) messages over different interfaces.</span></span> <span data-ttu-id="b2d7b-119">Эти сообщения GetResponse могут содержать разные разделы метаданных **отношений** с одинаковой версией метаданных.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-119">These GetResponse messages can contain different **Relationship** metadata sections with the same metadata version.</span></span> <span data-ttu-id="b2d7b-120">Это сокращает значение номера версии метаданных.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-120">This reduces the value of the metadata version number.</span></span>

<span data-ttu-id="b2d7b-121">Существует альтернативный подход, в котором в ответ на все адреса службы отправляется одно сообщение с методом [GetResponse](getresponse--metadata-exchange--message.md) .</span><span class="sxs-lookup"><span data-stu-id="b2d7b-121">There is an alternative approach, where a single [GetResponse](getresponse--metadata-exchange--message.md) message is sent in response with all addresses for the service.</span></span> <span data-ttu-id="b2d7b-122">Недостаток этого метода заключается в том, что частная информация, например топология непрямо доступных сетей, может быть раскрываться.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-122">The disadvantage of this method is that private information, such as the topology of indirectly accessible networks, may be disclosed.</span></span>

<span data-ttu-id="b2d7b-123">В Windows Vista метаданные, предоставляемые WSDAPI, содержат только адреса, допустимые для интерфейса, на основе которого был получен запрос метаданных.</span><span class="sxs-lookup"><span data-stu-id="b2d7b-123">On Windows Vista, the metadata provided by WSDAPI contains only addresses that are valid for the interface upon which the metadata request was received.</span></span>

 

 



