---
title: Настройка потоков
description: Настройка потоков
ms.assetid: d119362f-e23c-4985-aff5-8c084106df30
keywords:
- Windows Media Format SDK, потоки
- профили, потоки
- потоки, Настройка
- кодеки, Настройка потоков
- профили, интерфейс Ивмстреамконфиг
- потоки, интерфейс Ивмстреамконфиг
- ивмстреамконфиг
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bc159fbd5390eb430e035db676685153d0cf174
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104487728"
---
# <a name="configuring-streams"></a><span data-ttu-id="3946f-110">Настройка потоков</span><span class="sxs-lookup"><span data-stu-id="3946f-110">Configuring Streams</span></span>

<span data-ttu-id="3946f-111">Единственное, что требуется в профиле, — это хотя бы один поток.</span><span class="sxs-lookup"><span data-stu-id="3946f-111">The only thing that is required in a profile is at least one stream.</span></span> <span data-ttu-id="3946f-112">Другие параметры предоставляют доступ к более продвинутым функциям, но с минимальным числом из одного потока можно создать файл ASF.</span><span class="sxs-lookup"><span data-stu-id="3946f-112">The other options provide access to more advanced features, but with the minimum of one stream you can make an ASF file.</span></span> <span data-ttu-id="3946f-113">Важно понимать, как настроить потоки перед созданием сложных профилей.</span><span class="sxs-lookup"><span data-stu-id="3946f-113">It is essential that you understand how to configure streams before creating complex profiles.</span></span>

<span data-ttu-id="3946f-114">В целях профилей потоки можно разделить на два типа: те, которые сжимаются с помощью кодеков Windows Media и произвольных потоков, которые не обрабатываются ни с одним кодеком.</span><span class="sxs-lookup"><span data-stu-id="3946f-114">For the purpose of profiles, streams can be divided into two types: those that are compressed with Windows Media codecs and arbitrary streams that are not processed with any codecs.</span></span> <span data-ttu-id="3946f-115">Звуковые потоки и видеопотоки — это типы, использующие кодеки Windows Media.</span><span class="sxs-lookup"><span data-stu-id="3946f-115">Audio streams and video streams are the types that use the Windows Media codecs.</span></span> <span data-ttu-id="3946f-116">Конечно, потоки могут содержать звук или видео, сжатые с помощью стороннего кодека, но процесс настройки такого потока является особым случаем.</span><span class="sxs-lookup"><span data-stu-id="3946f-116">Of course, streams can contain audio or video compressed with a third-party codec, but the process of configuring such a stream is a special case.</span></span> <span data-ttu-id="3946f-117">Дополнительные сведения см. [в разделе Создание файлов ASF с помощью сторонних кодеков](to-create-asf-files-using-third-party-codecs.md).</span><span class="sxs-lookup"><span data-stu-id="3946f-117">For more information, see [To Create ASF Files Using Third-Party Codecs](to-create-asf-files-using-third-party-codecs.md).</span></span>

<span data-ttu-id="3946f-118">В следующем списке приведена сводка процесса настройки потока.</span><span class="sxs-lookup"><span data-stu-id="3946f-118">The following list summarizes the process of configuring a stream.</span></span>

1.  <span data-ttu-id="3946f-119">Получение объекта конфигурации потока для потока.</span><span class="sxs-lookup"><span data-stu-id="3946f-119">Obtain a stream configuration object for the stream.</span></span>
    -   <span data-ttu-id="3946f-120">При создании потока с помощью одного из кодеков Windows Media необходимо получить объект конфигурации потока в формате кодека, используя методы [**IWMCodecInfo3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo3).</span><span class="sxs-lookup"><span data-stu-id="3946f-120">If you are creating a stream using one of the Windows Media codecs, you must obtain the stream configuration object as a codec format using the methods of [**IWMCodecInfo3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo3).</span></span>
    -   <span data-ttu-id="3946f-121">Если поток является произвольным типом, получите пустой объект конфигурации потока с помощью [**ивмпрофиле:: креатеневстреам**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-createnewstream).</span><span class="sxs-lookup"><span data-stu-id="3946f-121">If the stream is an arbitrary type, get an empty stream configuration object using [**IWMProfile::CreateNewStream**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-createnewstream).</span></span>
2.  <span data-ttu-id="3946f-122">Настройте поток в соответствии с вашими потребностями.</span><span class="sxs-lookup"><span data-stu-id="3946f-122">Configure the stream to meet your needs.</span></span>
    -   <span data-ttu-id="3946f-123">Потокам всех типов должно быть присвоено имя, имя соединения и номер потока.</span><span class="sxs-lookup"><span data-stu-id="3946f-123">Streams of all types should be assigned a name, connection name, and stream number.</span></span>
    -   <span data-ttu-id="3946f-124">Потоки, использующие кодеки Windows Media, следует изменять только в предопределенных способах из формата кодека.</span><span class="sxs-lookup"><span data-stu-id="3946f-124">Streams using Windows Media codecs should be altered only in predefined ways from the codec format.</span></span> <span data-ttu-id="3946f-125">Для звуковых потоков необходимо изменить только параметры переменной скорости (VBR) для двух проходов.</span><span class="sxs-lookup"><span data-stu-id="3946f-125">For audio streams, only variable bit rate (VBR) settings for two-pass VBR should be changed.</span></span> <span data-ttu-id="3946f-126">Для видеопотоков необходимо настроить нужные свойства фрейма.</span><span class="sxs-lookup"><span data-stu-id="3946f-126">Video streams need to be configured with the desired frame properties.</span></span>
    -   <span data-ttu-id="3946f-127">Произвольные потоки имеют различные требования к конфигурации по типу.</span><span class="sxs-lookup"><span data-stu-id="3946f-127">Arbitrary streams have varying configuration requirements by type.</span></span> <span data-ttu-id="3946f-128">Для всех требуется окно с побитовой скоростью и буфер.</span><span class="sxs-lookup"><span data-stu-id="3946f-128">All require a bit rate and buffer window.</span></span>
3.  <span data-ttu-id="3946f-129">Добавьте поток в профиль, вызвав [**ивмпрофиле:: аддстреам**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-addstream).</span><span class="sxs-lookup"><span data-stu-id="3946f-129">Add the stream to the profile by calling [**IWMProfile::AddStream**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-addstream).</span></span>

<span data-ttu-id="3946f-130">Все потоки определяются с помощью объектов конфигурации потока.</span><span class="sxs-lookup"><span data-stu-id="3946f-130">All streams are defined using stream configuration objects.</span></span> <span data-ttu-id="3946f-131">Основным интерфейсом для объекта конфигурации потока является [**ивмстреамконфиг**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig), который предоставляет методы для установки основных параметров потока, таких как номер потока, скорость работы с битах и т. д.</span><span class="sxs-lookup"><span data-stu-id="3946f-131">The main interface for a stream configuration object is [**IWMStreamConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig), which provides methods for setting the basic settings of a stream, such as the stream number, bit rate, and so on.</span></span> <span data-ttu-id="3946f-132">**Ивмстреамконфиг** наследуется новыми интерфейсами, [**IWMStreamConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig2) и [**IWMStreamConfig3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig3).</span><span class="sxs-lookup"><span data-stu-id="3946f-132">**IWMStreamConfig** is inherited by the newer interfaces, [**IWMStreamConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig2) and [**IWMStreamConfig3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig3).</span></span> <span data-ttu-id="3946f-133">Как и для всех пронумерованных редакций интерфейса, всегда следует получать самую последнюю версию с помощью метода **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="3946f-133">As with all numbered interface revisions, you should always retrieve the most recent version using the **QueryInterface** method.</span></span>

<span data-ttu-id="3946f-134">Доступ к большинству параметров в потоке осуществляется через [**ивммедиапропс**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops).</span><span class="sxs-lookup"><span data-stu-id="3946f-134">Most settings in a stream are accessed through [**IWMMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops).</span></span> <span data-ttu-id="3946f-135">Эти параметры инкапсулируются в структуре [**\_ \_ типа мультимедиа WM**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) .</span><span class="sxs-lookup"><span data-stu-id="3946f-135">These settings are encapsulated in a [**WM\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) structure.</span></span> <span data-ttu-id="3946f-136">Для аудио и видео структура **\_ \_ типа мультимедиа WM** указывает на другую структуру с дополнительной информацией, относящейся к типу носителя.</span><span class="sxs-lookup"><span data-stu-id="3946f-136">For audio and video, the **WM\_MEDIA\_TYPE** structure points to another structure with further information specific to the type of media.</span></span> <span data-ttu-id="3946f-137">Эта дополнительная структура обычно [**вавеформатекс**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) для аудио и [**вмвидеоинфохеадер**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) для видео.</span><span class="sxs-lookup"><span data-stu-id="3946f-137">This secondary structure is typically [**WAVEFORMATEX**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) for audio and [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) for video.</span></span> <span data-ttu-id="3946f-138">Кроме того, видеопотоки имеют третичную структуру **битмапинфохеадер**, которая описывает характеристики отдельного кадра видео.</span><span class="sxs-lookup"><span data-stu-id="3946f-138">In addition, video streams have a tertiary structure, **BITMAPINFOHEADER**, which describes the characteristics of an individual frame of video.</span></span> <span data-ttu-id="3946f-139">**Битмапинфохеадер** — это общая структура, которую можно найти в разделе Интерфейс графических устройств (GDI) пакета Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="3946f-139">**BITMAPINFOHEADER** is a common structure and can be found in the Graphics Device Interface (GDI) section of the Platform SDK.</span></span>

<span data-ttu-id="3946f-140">В следующих разделах описывается настройка потоков.</span><span class="sxs-lookup"><span data-stu-id="3946f-140">The following sections describe how to configure streams.</span></span>



| <span data-ttu-id="3946f-141">Section</span><span class="sxs-lookup"><span data-stu-id="3946f-141">Section</span></span>                                                                                                          | <span data-ttu-id="3946f-142">Описание</span><span class="sxs-lookup"><span data-stu-id="3946f-142">Description</span></span>                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="3946f-143">Общая конфигурация для всех потоков</span><span class="sxs-lookup"><span data-stu-id="3946f-143">Configuration Common to All Streams</span></span>](configuration-common-to-all-streams.md)                                   | <span data-ttu-id="3946f-144">Описывает основную конфигурацию потока, общую для всех типов потоков.</span><span class="sxs-lookup"><span data-stu-id="3946f-144">Describes the basic stream configuration common to all types of streams.</span></span>                                                                                        |
| [<span data-ttu-id="3946f-145">Получение сведений о конфигурации потока из кодеков</span><span class="sxs-lookup"><span data-stu-id="3946f-145">Getting Stream Configuration Information from Codecs</span></span>](getting-stream-configuration-information-from-codecs.md) | <span data-ttu-id="3946f-146">Описывает, как получить сведения о конфигурации потока из кодеков, чтобы обеспечить правильную настройку потоков с помощью аудиокодеков Windows Media Audio и Video.</span><span class="sxs-lookup"><span data-stu-id="3946f-146">Describes how to get stream configuration information from the codecs to ensure proper configuration of streams using the Windows Media Audio and Video codecs.</span></span> |
| [<span data-ttu-id="3946f-147">Настройка звуковых потоков</span><span class="sxs-lookup"><span data-stu-id="3946f-147">Configuring Audio Streams</span></span>](configuring-audio-streams.md)                                                       | <span data-ttu-id="3946f-148">Описывает настройку звуковых потоков.</span><span class="sxs-lookup"><span data-stu-id="3946f-148">Describes how to configure audio streams.</span></span>                                                                                                                       |
| [<span data-ttu-id="3946f-149">Настройка потоков видео</span><span class="sxs-lookup"><span data-stu-id="3946f-149">Configuring Video Streams</span></span>](configuring-video-streams.md)                                                       | <span data-ttu-id="3946f-150">Описание настройки потоков видео.</span><span class="sxs-lookup"><span data-stu-id="3946f-150">Describes how to configure video streams.</span></span>                                                                                                                       |
| [<span data-ttu-id="3946f-151">Настройка потоков видео для поиска производительности</span><span class="sxs-lookup"><span data-stu-id="3946f-151">Configuring Video Streams for Seeking Performance</span></span>](configuring-video-streams-for-seeking-performance.md)       | <span data-ttu-id="3946f-152">Описание настройки видеопотоков, для которых важно эффективное Поиск.</span><span class="sxs-lookup"><span data-stu-id="3946f-152">Describes how to configure video streams for which efficient seeking is important.</span></span>                                                                              |
| [<span data-ttu-id="3946f-153">Настройка потоков снимка экрана</span><span class="sxs-lookup"><span data-stu-id="3946f-153">Configuring Screen Capture Streams</span></span>](configuring-screen-capture-streams.md)                                     | <span data-ttu-id="3946f-154">Описание настройки видеопотоков для снимка экрана.</span><span class="sxs-lookup"><span data-stu-id="3946f-154">Describes how to configure video streams for screen capture.</span></span>                                                                                                    |
| [<span data-ttu-id="3946f-155">Настройка потоков изображений</span><span class="sxs-lookup"><span data-stu-id="3946f-155">Configuring Image Streams</span></span>](configuring-image-streams.md)                                                       | <span data-ttu-id="3946f-156">Описывает настройку потоков изображений.</span><span class="sxs-lookup"><span data-stu-id="3946f-156">Describes how to configure image streams.</span></span>                                                                                                                       |
| [<span data-ttu-id="3946f-157">Использование несжатых потоков аудио и видео</span><span class="sxs-lookup"><span data-stu-id="3946f-157">Using Uncompressed Audio and Video Streams</span></span>](using-uncompressed-audio-and-video-streams.md)                     | <span data-ttu-id="3946f-158">Описание настройки несжатого аудио или видеопотока.</span><span class="sxs-lookup"><span data-stu-id="3946f-158">Describes how to set up an uncompressed audio or video stream.</span></span>                                                                                                  |
| [<span data-ttu-id="3946f-159">Настройка произвольных типов потоков</span><span class="sxs-lookup"><span data-stu-id="3946f-159">Configuring Arbitrary Stream Types</span></span>](configuring-arbitrary-stream-types.md)                                     | <span data-ttu-id="3946f-160">Описывает настройку потоков для использования предопределенных произвольных типов потоков.</span><span class="sxs-lookup"><span data-stu-id="3946f-160">Describes how to configure streams to use the predefined arbitrary stream types.</span></span>                                                                                |
| [<span data-ttu-id="3946f-161">Настройка потоков с VBR</span><span class="sxs-lookup"><span data-stu-id="3946f-161">Configuring VBR Streams</span></span>](configuring-vbr-streams.md)                                                           | <span data-ttu-id="3946f-162">Описывает, как настроить потоки для использования кодирования с переменной скоростью (VBR).</span><span class="sxs-lookup"><span data-stu-id="3946f-162">Describes how to configure streams to use variable bit rate encoding (VBR).</span></span>                                                                                     |
| [<span data-ttu-id="3946f-163">Настройка расширений модуля данных</span><span class="sxs-lookup"><span data-stu-id="3946f-163">Configuring Data Unit Extensions</span></span>](configuring-data-unit-extensions.md)                                         | <span data-ttu-id="3946f-164">Описывает, как настроить поток таким образом, чтобы расширения модулей данных можно было прикреплять при написании файла.</span><span class="sxs-lookup"><span data-stu-id="3946f-164">Describes how to configure a stream so that data unit extensions can be attached when the file is written.</span></span>                                                      |
| [<span data-ttu-id="3946f-165">Повторное использование конфигураций потоков</span><span class="sxs-lookup"><span data-stu-id="3946f-165">Reusing Stream Configurations</span></span>](reusing-stream-configurations.md)                                               | <span data-ttu-id="3946f-166">Описывает способы использования объектов конфигурации Stream из существующих профилей для создания новых профилей.</span><span class="sxs-lookup"><span data-stu-id="3946f-166">Describes the ways in which you can use stream configuration objects from existing profiles to make new profiles.</span></span>                                               |



 

## <a name="related-topics"></a><span data-ttu-id="3946f-167">См. также</span><span class="sxs-lookup"><span data-stu-id="3946f-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3946f-168">**Входы, потоки и выходные данные**</span><span class="sxs-lookup"><span data-stu-id="3946f-168">**Inputs, Streams and Outputs**</span></span>](inputs-streams-and-outputs.md)
</dt> <dt>

[<span data-ttu-id="3946f-169">**Работа с профилями**</span><span class="sxs-lookup"><span data-stu-id="3946f-169">**Working with Profiles**</span></span>](working-with-profiles.md)
</dt> </dl>

 

 