---
title: Воспроизведение файлов из сетевого источника
description: Воспроизведение файлов из сетевого источника
ms.assetid: 72f2d685-56fc-4da2-8372-3774cc65f59d
keywords:
- Windows Media Format SDK, чтение данных ASF
- Windows Media Format SDK, воспроизведение файлов из сетевых источников
- Расширенный формат систем (ASF), чтение данных
- ASF (Расширенный системный формат), чтение данных
- Расширенный формат систем (ASF), воспроизведение файлов из сетевых источников
- ASF (Расширенный системный формат), воспроизведение файлов из сетевых источников
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f1e4e41ddf94498ddeddf90e64439c1b11b7ba8
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2020
ms.locfileid: "105700830"
---
# <a name="playing-files-from-a-network-source"></a><span data-ttu-id="e3ca8-109">Воспроизведение файлов из сетевого источника</span><span class="sxs-lookup"><span data-stu-id="e3ca8-109">Playing Files from a Network Source</span></span>

<span data-ttu-id="e3ca8-110">Чтение из сети не имеет фундаментального отличия от чтения локального файла.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-110">Reading from a network is not fundamentally different from reading a local file.</span></span> <span data-ttu-id="e3ca8-111">Приложение передает URL-адрес методу [**ивмреадер:: Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-open) объекта Reader, и объект модуля чтения обрабатывает сведения о сетевых протоколах.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-111">The application passes the URL to the reader object's [**IWMReader::Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-open) method, and the reader object handles the details of the network protocols.</span></span> <span data-ttu-id="e3ca8-112">Объект "читатель" использует интеллектуальное управление буферами для обеспечения максимально плавного воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-112">The reader object uses intelligent buffer management to provide the smoothest playback possible.</span></span> <span data-ttu-id="e3ca8-113">Если приложению требуется больший контроль над сетевыми параметрами объекта чтения, они доступны через интерфейсы [**ивмреадернетворкконфиг**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig) и [**IWMReaderNetworkConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig2) .</span><span class="sxs-lookup"><span data-stu-id="e3ca8-113">If the application needs more control over the reader object's network settings, these are available through the [**IWMReaderNetworkConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig) and [**IWMReaderNetworkConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig2) interfaces.</span></span>

<span data-ttu-id="e3ca8-114">Содержимое из сетевого источника попадает в одну из следующих двух категорий:</span><span class="sxs-lookup"><span data-stu-id="e3ca8-114">Content from a network source falls into one of the following two categories:</span></span>

-   <span data-ttu-id="e3ca8-115">Потоки.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-115">Streaming.</span></span> <span data-ttu-id="e3ca8-116">Данные передаются в течение времени для воспроизведения на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-116">The data is transmitted just in time to be played on the local machine.</span></span> <span data-ttu-id="e3ca8-117">Серверы, на которых работают службы Windows Media, могут предоставлять потоковые данные.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-117">Servers running Windows Media Services can provide streaming data.</span></span> <span data-ttu-id="e3ca8-118">Если содержимое с несколькими потоками (MBR) передается потоком, клиент может запросить другую скорость передачи данных с сервера при потоковой передаче.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-118">If multiple bit rate (MBR) content is streamed, the client can request a different bit rate from the server as streaming progresses.</span></span>
-   <span data-ttu-id="e3ca8-119">Download.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-119">Downloaded.</span></span> <span data-ttu-id="e3ca8-120">Все данные передаются как можно быстрее, чтобы их можно было сохранить в виде файла на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-120">All the data is transmitted as quickly as possible so that it can be saved as a file on the local machine.</span></span> <span data-ttu-id="e3ca8-121">Веб-серверы предоставляют Скачанные данные.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-121">Web servers provide downloaded data.</span></span> <span data-ttu-id="e3ca8-122">После начала загрузки обмен данными между клиентом и сервером отсутствует.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-122">There is no communication from the client to the server after the download begins.</span></span>

<span data-ttu-id="e3ca8-123">Когда объект Reader скачивает файл с веб-сервера, он использует метод, называемый прогрессивной потоковой передачей, который позволяет проигрывателю начать отрисовку содержимого до завершения загрузки.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-123">When the reader object downloads a file from a Web server, it uses a technique called progressive streaming, which allows a player to begin rendering the content before downloading is complete.</span></span> <span data-ttu-id="e3ca8-124">Данные помещаются в буфер, чтобы обеспечить непрерывный поток данных для проигрывателя.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-124">Data is buffered to provide an uninterrupted flow of data to the player.</span></span> <span data-ttu-id="e3ca8-125">Такие сведения, как скорость передачи и длительность содержимого, используются для определения продолжительности буферизации данных перед их передачей проигрывателю.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-125">Information such as the transfer rate and duration of the content is used to determine how long to buffer the data before giving it to the player.</span></span>

<span data-ttu-id="e3ca8-126">Чтобы открыть файл или поток по сети, вызовите метод **ивмреадер:: Open** объекта Reader с соответствующим URL-адресом.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-126">To open a file or stream over a network, call the reader object's **IWMReader::Open** method with the appropriate URL.</span></span> <span data-ttu-id="e3ca8-127">**Open** является асинхронным вызовом, поэтому он возвращается немедленно.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-127">**Open** is an asynchronous call, so it returns immediately.</span></span> <span data-ttu-id="e3ca8-128">Когда источник готов к чтению, объект Reader отправляет ВМТ \_ открытое уведомление в метод обратного вызова [**ивмстатускаллбакк:: OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) приложения.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-128">When the source is ready for reading, the reader object sends a WMT\_OPENED notification to the application's [**IWMStatusCallback::OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) callback method.</span></span> <span data-ttu-id="e3ca8-129">На этом этапе приложение может запросить модуль чтения для режима доставки, вызвав [**IWMReaderAdvanced2:: жетплаймоде**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getplaymode).</span><span class="sxs-lookup"><span data-stu-id="e3ca8-129">At this point, the application can query the reader for the delivery mode by calling [**IWMReaderAdvanced2::GetPlayMode**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getplaymode).</span></span> <span data-ttu-id="e3ca8-130">Для сетевого содержимого этот метод возвращает либо \_ \_ загрузку в режиме воспроизведения ВМТ \_ , которая указывает загруженное содержимое, либо \_ \_ \_ потоковую передачу в режиме воспроизведения ВМТ, указывая потоковый контент.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-130">For network content, this method will return either WMT\_PLAY\_MODE\_DOWNLOAD, indicating downloaded content, or WMT\_PLAY\_MODE\_STREAMING, indicating streamed content.</span></span>

<span data-ttu-id="e3ca8-131">Чтобы начать чтение файла или потока, вызовите метод [**ивмреадер:: Start**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-start) .</span><span class="sxs-lookup"><span data-stu-id="e3ca8-131">To begin reading the file or stream, call the [**IWMReader::Start**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-start) method.</span></span> <span data-ttu-id="e3ca8-132">Модуль чтения отправляет \_ \_ уведомление о начале буферизации ВМТ, когда он начинает буферизацию содержимого, и \_ \_ уведомление об ошибке буферизации ВМТ при завершении буферизации.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-132">The reader sends a WMT\_BUFFERING\_START notification when it starts to buffer the content, and a WMT\_BUFFERING\_STOP notification when buffering is complete.</span></span> <span data-ttu-id="e3ca8-133">Пока средство чтения помещает содержимое в буфер (то есть между этими двумя уведомлениями), может потребоваться отобразить ход выполнения буферизации пользователю.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-133">While the reader is buffering content (that is, between these two notifications), you might want to display the buffering progress to the user.</span></span> <span data-ttu-id="e3ca8-134">Метод [**IWMReaderAdvanced2:: жетбуфферпрогресс**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getbufferprogress) Возвращает процент данных, которые были помещены в буфер, и предполагаемое оставшееся время.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-134">The [**IWMReaderAdvanced2::GetBufferProgress**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getbufferprogress) method returns the percentage of data that has been buffered and the estimated time that remains.</span></span> <span data-ttu-id="e3ca8-135">Для скачанного содержимого можно также вызвать [**IWMReaderAdvanced2:: жетдовнлоадпрогресс**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getdownloadprogress) , чтобы получить сведения о ходе загрузки.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-135">For downloaded content, you can also call [**IWMReaderAdvanced2::GetDownloadProgress**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getdownloadprogress) to get the download progress.</span></span> <span data-ttu-id="e3ca8-136">Вызывайте эти методы повторно для обновления экрана до завершения буферизации.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-136">Call these methods repeatedly to update your display, until buffering has completed.</span></span> <span data-ttu-id="e3ca8-137">Буферизация может произойти снова во время воспроизведения из-за таких факторов, как перегрузка сети.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-137">Buffering can occur again during playback, due to factors such as network congestion.</span></span> <span data-ttu-id="e3ca8-138">Если это происходит, приложение получает другое \_ \_ уведомление о начале буферизации ВМТ.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-138">If this occurs, the application receives another WMT\_BUFFERING\_START notification.</span></span>

<span data-ttu-id="e3ca8-139">Когда объект модуля чтения начинает воспроизводить содержимое, он отправляет \_ уведомление Started ВМТ.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-139">When the reader object begins to play the content, it sends a WMT\_STARTED notification.</span></span> <span data-ttu-id="e3ca8-140">Каждый пример декодирован и становится доступным для подготовки к просмотру, модуль чтения передает его в приложение с помощью метода обратного вызова [**ивмреадеркаллбакк:: OnSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreadercallback-onsample) .</span><span class="sxs-lookup"><span data-stu-id="e3ca8-140">As each sample is decoded and becomes available for rendering, the reader passes it to the application through the [**IWMReaderCallback::OnSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreadercallback-onsample) callback method.</span></span> <span data-ttu-id="e3ca8-141">На этом этапе процесс выполняется так же, как и для локального воспроизведения файлов.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-141">At this point, the process is the same as it is for local file playback.</span></span> <span data-ttu-id="e3ca8-142">При остановке воспроизведения модуль чтения отправляет уведомление ВМТ \_ конца \_ \_ потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="e3ca8-142">When playback stops, the reader sends a WMT\_END\_OF\_STREAMING notification.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e3ca8-143">См. также</span><span class="sxs-lookup"><span data-stu-id="e3ca8-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e3ca8-144">**Чтение файлов ASF**</span><span class="sxs-lookup"><span data-stu-id="e3ca8-144">**Reading ASF Files**</span></span>](reading-asf-files.md)
</dt> </dl>

 

 




