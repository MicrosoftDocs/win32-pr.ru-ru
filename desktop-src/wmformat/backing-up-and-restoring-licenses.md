---
title: Резервное копирование и восстановление лицензий
description: Резервное копирование и восстановление лицензий
ms.assetid: 59be02fe-f207-4161-8765-9a88a8050248
keywords:
- Windows Пакет SDK для формата мультимедиа, резервное копирование лицензий
- Windows Пакет SDK для формата мультимедиа, восстановление лицензий
- Windows Пакет SDK для формата мультимедиа, резервное копирование и восстановление лицензий
- Расширенный формат систем (ASF), резервное копирование лицензий
- ASF (Расширенный системный формат), резервное копирование лицензий
- Расширенный формат систем (ASF), восстановление лицензий
- ASF (Расширенный системный формат), восстановление лицензий
- Расширенный формат систем (ASF), резервное копирование и восстановление лицензий
- ASF (Расширенный системный формат), резервное копирование и восстановление лицензий
- Управление цифровыми правами (DRM), резервное копирование лицензий
- DRM (Управление цифровыми правами), резервное копирование лицензий
- Управление цифровыми правами (DRM), восстановление лицензий
- DRM (Управление цифровыми правами), восстановление лицензий
- Управление цифровыми правами (DRM), резервное копирование и восстановление лицензий
- DRM (Управление цифровыми правами), резервное копирование и восстановление лицензий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 378a41d975e8f19d38c637d585759d0038f5b86550769ae49d6a6490844f223e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119028142"
---
# <a name="backing-up-and-restoring-licenses"></a>Резервное копирование и восстановление лицензий

Процессы резервного копирования и восстановления являются асинхронными. Они запускаются, когда пользователь выбирает команду меню или параметр в приложении для резервного копирования или восстановления лицензий. Необходимо разрешить пользователю указывать расположения для резервного копирования и восстановления лицензий.

Для резервного копирования лицензий выполните следующие действия.

1.  Для создания объекта резервного хранилища используйте функцию [**вмкреатебаккупресторер**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreatebackuprestorer) .
2.  Вызовите метод [**ивмбаккупресторепропс:: сбой setprop**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmbackuprestoreprops-setprop) , чтобы задать путь резервного копирования (расположение, в котором будут записываться файлы, например: \\ или D: \\ Licenses).
3.  Вызовите метод [**ивмлиценсебаккуп:: баккуплиценсес**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmlicensebackup-backuplicenses) , чтобы создать резервную копию лицензий по указанному пути.

В метод [**ивмстатускаллбакк:: OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) отправляются следующие события:

-   **ВМТ \_ БАККУПРЕСТОРЕ \_ Begin** указывает, что процесс резервного копирования запущен.
-   **ВМТ \_ БАККУПРЕСТОРЕ \_ конец** указывает, что процесс резервного копирования завершен.
-   **ВМТ \_ \_Лицензия с ограниченным доступом** указывает, что не удается создать резервную копию одной или нескольких лицензий, так как право владельца содержимого не разрешено.

Идентификатор ключа также включается в сообщение. Если вы реализовали базу данных для защищенных файлов, содержащую идентификатор ключа и метаданные, можно отобразить сообщение для пользователя с указанным названием (например, название песни), для которого невозможно создать резервную копию лицензии. В противном случае сообщение должно быть универсальным и информировать пользователя о том, что не удается создать резервную копию некоторых лицензий.

Чтобы восстановить лицензии, выполните следующие действия.

1.  Для создания объекта резервного хранилища используйте функцию **вмкреатебаккупресторер** .
2.  Вызовите метод **ивмбаккупресторепропс:: сбой setprop** , чтобы задать путь восстановления к расположению, в котором выполняется резервное копирование лицензий.
3.  Вызовите метод [**ивмлиценсересторе:: ресторелиценсес**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmlicenserestore-restorelicenses) , чтобы восстановить лицензии из этого расположения.

В метод [**ивмстатускаллбакк:: OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) отправляются следующие события:

-   **ВМТ \_ \_Подключение баккупресторе** указывает, что приложение подключается к службе управления лицензиями.
-   **ВМТ \_ БАККУПРЕСТОРЕ \_ Отключение** указывает, что приложение отключается от службы управления лицензиями.
-   **ВМТ \_ БАККУПРЕСТОРЕ \_ Begin** указывает, что процесс восстановления запущен.
-   **ВМТ \_ БАККУПРЕСТОРЕ \_** указывает на завершение процесса восстановления.

> [!Note]  
> DRM не поддерживает версию этого пакета SDK на базе x64.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Функции цифровых Rights Management**](digital-rights-management-features.md)
</dt> <dt>

[**Интерфейс Ивмбаккупресторепропс**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmbackuprestoreprops)
</dt> <dt>

[**Интерфейс Ивмлиценсебаккуп**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmlicensebackup)
</dt> <dt>

[**Интерфейс Ивмлиценсересторе**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmlicenserestore)
</dt> </dl>

 

 




