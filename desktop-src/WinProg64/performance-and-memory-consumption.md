---
title: Производительность и использование памяти в эмуляторе WOW64
description: Производительность и использование памяти в эмуляторе WOW64 определяются следующими факторами.
ms.assetid: 77759840-7b1a-4956-a038-d6374b6ec354
keywords:
- производительность в рамках WOW64 64-разрядного программирования Windows
- использование памяти в WOW64 64-разрядном программировании Windows
- WOW64 64-разрядное программирование Windows, производительность
- WOW64 64-разрядное программирование Windows, использование памяти
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8928e7d50c8396aa2b5b34081af3e4ee2719e044
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413520"
---
# <a name="performance-and-memory-consumption-under-wow64"></a><span data-ttu-id="0bc52-107">Производительность и использование памяти в эмуляторе WOW64</span><span class="sxs-lookup"><span data-stu-id="0bc52-107">Performance and Memory Consumption Under WOW64</span></span>

<span data-ttu-id="0bc52-108">Производительность и использование памяти в эмуляторе WOW64 определяются следующими факторами.</span><span class="sxs-lookup"><span data-stu-id="0bc52-108">Performance and memory consumption under WOW64 are determined by the following factors:</span></span>

-   <span data-ttu-id="0bc52-109">Оборудование процессора.</span><span class="sxs-lookup"><span data-stu-id="0bc52-109">Processor hardware.</span></span> <span data-ttu-id="0bc52-110">Эмуляция инструкций выполняется на микросхеме.</span><span class="sxs-lookup"><span data-stu-id="0bc52-110">Instruction emulation is performed on the chip.</span></span> <span data-ttu-id="0bc52-111">На процессоре x64 инструкции x86 выполняются в собственном процессоре.</span><span class="sxs-lookup"><span data-stu-id="0bc52-111">On the x64 processor, x86 instructions are executed natively by the processor.</span></span> <span data-ttu-id="0bc52-112">Следовательно, скорость выполнения в эмуляторе WOW64 на x64 аналогична скорости в 32-разрядной Windows.</span><span class="sxs-lookup"><span data-stu-id="0bc52-112">Therefore, execution speed under WOW64 on x64 is similar to its speed under 32-bit Windows.</span></span> <span data-ttu-id="0bc52-113">На процессорах Intel Itanium и любых процессорах ARM64 больше программного обеспечения, вовлеченное в эмуляцию, и в результате производительность снижается.</span><span class="sxs-lookup"><span data-stu-id="0bc52-113">On the Intel Itanium processor and any ARM64 processors, more software is involved in the emulation, and performance suffers as a result.</span></span>
-   <span data-ttu-id="0bc52-114">Издержки преобразователей API.</span><span class="sxs-lookup"><span data-stu-id="0bc52-114">API thunk overhead.</span></span> <span data-ttu-id="0bc52-115">Эти издержки невелики по сравнению с системными вызовами ядра NT.</span><span class="sxs-lookup"><span data-stu-id="0bc52-115">This overhead is small compared to system calls to the NT kernel.</span></span> <span data-ttu-id="0bc52-116">Функции ядра NT должны вызываться редко.</span><span class="sxs-lookup"><span data-stu-id="0bc52-116">NT kernel functions are intended to be called infrequently.</span></span>
-   <span data-ttu-id="0bc52-117">Размер виртуальной памяти.</span><span class="sxs-lookup"><span data-stu-id="0bc52-117">Virtual memory size.</span></span> <span data-ttu-id="0bc52-118">В процессоре Intel Itanium Подсистема WOW64 добавляет значительные издержки, если два или более экземпляра одного и того же 32-разрядного приложения работают одновременно.</span><span class="sxs-lookup"><span data-stu-id="0bc52-118">On the Intel Itanium processor, WOW64 adds significant overhead if two or more instances of the same 32-bit application are running concurrently.</span></span> <span data-ttu-id="0bc52-119">Это связано с нестандартными страницами размером 8 КБ в Intel Itanium, что усложняет эмуляцию собственных страниц размером 4 КБ в архитектуре x86 (дополнительные страницы помечены как доступные для записи; все страницы, доступные для записи, являются частными для процесса).</span><span class="sxs-lookup"><span data-stu-id="0bc52-119">This is due to the native 8 KB pages on the Intel Itanium, which complicates the emulation of the native 4 KB pages on the x86 architecture (more pages are marked as writable; all writable pages are private to the process).</span></span> <span data-ttu-id="0bc52-120">Это может негативно сказаться на масштабируемости служб терминалов на определенных процессорах.</span><span class="sxs-lookup"><span data-stu-id="0bc52-120">This can adversely affect the scalability of Terminal Services on certain processors.</span></span> <span data-ttu-id="0bc52-121">Это не так для процессора x64.</span><span class="sxs-lookup"><span data-stu-id="0bc52-121">This is not the case for the x64 processor.</span></span>
-   <span data-ttu-id="0bc52-122">Рабочий набор.</span><span class="sxs-lookup"><span data-stu-id="0bc52-122">Working set.</span></span> <span data-ttu-id="0bc52-123">WOW64 увеличивает размер рабочего набора приложения.</span><span class="sxs-lookup"><span data-stu-id="0bc52-123">WOW64 increases the size of the application's working set.</span></span>

<span data-ttu-id="0bc52-124">WOW64 позволяет 32-разрядным приложениям использовать преимущества 64-разрядного ядра.</span><span class="sxs-lookup"><span data-stu-id="0bc52-124">WOW64 enables 32-bit applications to take advantage of the 64-bit kernel.</span></span> <span data-ttu-id="0bc52-125">Поэтому в 32-разрядных приложениях может использоваться большее количество дескрипторов ядра и окон.</span><span class="sxs-lookup"><span data-stu-id="0bc52-125">Therefore, 32-bit applications can use a larger number of kernel handles and window handles.</span></span> <span data-ttu-id="0bc52-126">Однако 32-разрядные приложения могут не иметь возможности создавать столько потоков в эмуляторе WOW64, сколько это возможно при работе в системах на базе x86, так как WOW64 выделяет дополнительный 64-битный стек (обычно 512 КБ) для каждого потока.</span><span class="sxs-lookup"><span data-stu-id="0bc52-126">However, 32-bit applications may not be able to create as many threads under WOW64 as they can when running natively on x86-based systems because WOW64 allocates an additional 64-bit stack (usually 512 KB) for each thread.</span></span> <span data-ttu-id="0bc52-127">Кроме того, некоторое количество адресного пространства резервируется для самого подсистемы WOW64 и используемых им структур данных.</span><span class="sxs-lookup"><span data-stu-id="0bc52-127">In addition, some amount of address space is reserved for WOW64 itself and the data structures it uses.</span></span> <span data-ttu-id="0bc52-128">Зарезервированное значение зависит от процессора; Дополнительные сведения зарезервированы на процессорах Intel Itanium, чем на процессорах x64 или ARM64.</span><span class="sxs-lookup"><span data-stu-id="0bc52-128">The amount reserved depends on the processor; more is reserved on the Intel Itanium than on the x64 or ARM64 processors.</span></span>

<span data-ttu-id="0bc52-129">Если в приложении задан флаг с большим количеством адресов для [**\_ файла \_ \_ \_ образа**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) , установленный в заголовке образа, каждое 32-разрядное приложение получает 4 ГБ виртуального адресного пространства в среде WOW64.</span><span class="sxs-lookup"><span data-stu-id="0bc52-129">If the application has the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag set in the image header, each 32-bit application receives 4 GB of virtual address space in the WOW64 environment.</span></span> <span data-ttu-id="0bc52-130">Если флаг **с \_ \_ большим \_ адресом \_ файла изображения** не установлен, каждое 32-разрядное приложение получает 2 ГБ виртуального адресного пространства в среде WOW64.</span><span class="sxs-lookup"><span data-stu-id="0bc52-130">If the **IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE** flag is not set, each 32-bit application receives 2 GB of virtual address space in the WOW64 environment.</span></span>

 

 