---
description: Система свойств Windows — это расширяемая система чтения и записи определений данных, которая обеспечивает единообразный способ представления метаданных об элементах оболочки.
ms.assetid: eb2dc2be-fc53-40aa-81f6-f353ab1d3a57
title: Обзор системы свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dab3a17eacdbaa9a5d0255004ba544b7c3f7ff2b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105702021"
---
# <a name="property-system-overview"></a><span data-ttu-id="c4e8e-103">Обзор системы свойств</span><span class="sxs-lookup"><span data-stu-id="c4e8e-103">Property System Overview</span></span>

<span data-ttu-id="c4e8e-104">Система свойств Windows — это расширяемая система чтения и записи определений данных, которая обеспечивает единообразный способ представления метаданных об элементах оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-104">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="c4e8e-105">Система свойств Windows в Windows Vista и более поздних версиях позволяет хранить и извлекать метаданные для элементов оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-105">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="c4e8e-106">Элемент оболочки — это любой отдельный фрагмент содержимого, например файл, папка, электронная почта или контакт.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-106">A Shell item is any single piece of content, such as a file, folder, email, or contact.</span></span> <span data-ttu-id="c4e8e-107">Свойство — это отдельный элемент метаданных, связанный с элементом оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-107">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="c4e8e-108">Значения свойств выражаются в виде структуры [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="c4e8e-108">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="c4e8e-109">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="c4e8e-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="c4e8e-110">Введение</span><span class="sxs-lookup"><span data-stu-id="c4e8e-110">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="c4e8e-111">Сценарии разработки</span><span class="sxs-lookup"><span data-stu-id="c4e8e-111">Development Scenarios</span></span>](#development-scenarios)
-   [<span data-ttu-id="c4e8e-112">Свойства и поиск Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-112">Properties and Windows Search</span></span>](#properties-and-windows-search)
-   [<span data-ttu-id="c4e8e-113">Примечание для разработчиков</span><span class="sxs-lookup"><span data-stu-id="c4e8e-113">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="c4e8e-114">Документация системы свойств Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-114">Windows Property System Documentation</span></span>](#windows-property-system-documentation)
-   [<span data-ttu-id="c4e8e-115">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="c4e8e-115">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="c4e8e-116">См. также</span><span class="sxs-lookup"><span data-stu-id="c4e8e-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="c4e8e-117">Введение</span><span class="sxs-lookup"><span data-stu-id="c4e8e-117">Introduction</span></span>

<span data-ttu-id="c4e8e-118">Свойства уникально идентифицируются по их каноническому имени (например, `System.Document.LastAuthor` ) и ключу свойства (например, `PKEY_Document_LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-118">Properties are uniquely identified by their canonical name (such as `System.Document.LastAuthor`) and property key (such as `PKEY_Document_LastAuthor`).</span></span> <span data-ttu-id="c4e8e-119">Ключ свойства (PKEY) — это имя части пары "имя-значение", которое состоит из имени PKEY/ПРОПВАРИАНТ или строки или ПРОПВАРИАНТ, где строка является каноническим именем PKEY (например, `System.Document.LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-119">A property key (PKEY) is the name portion of a name-value pair that consists of a PKEY/PROPVARIANT or a string/PROPVARIANT, where the string is the canonical name of the PKEY (such as `System.Document.LastAuthor`).</span></span> <span data-ttu-id="c4e8e-120">PKEY — это определение, которое сообщает системе свойств о свойстве все, что необходимо, а значение является фактическим экземпляром свойства.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-120">A PKEY is a definition that tells the property system everything it needs to know about the property, whereas the value is an actual instance of the property.</span></span> <span data-ttu-id="c4e8e-121">Внутренний PKEY содержит Форматид и propID.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-121">A PKEY internally contains a formatID and propID.</span></span>

<span data-ttu-id="c4e8e-122">Отдельное свойство состоит из следующих трех частей:</span><span class="sxs-lookup"><span data-stu-id="c4e8e-122">An individual property consists of the following three pieces:</span></span>

-   <span data-ttu-id="c4e8e-123">Каноническое имя, например `System.Music.Artist` .</span><span class="sxs-lookup"><span data-stu-id="c4e8e-123">A canonical name, such as `System.Music.Artist`.</span></span>
-   <span data-ttu-id="c4e8e-124">Описание схемы, которое указывается в формате XML-файла пропдеск и выражается программно через [**ипропертидескриптион**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-124">A schema description, which is specified in the .propdesc XML file format and expressed programmatically through [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span></span>
-   <span data-ttu-id="c4e8e-125">Значение типа, например имя Сингера.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-125">A value, such as the name of a singer.</span></span>

<span data-ttu-id="c4e8e-126">Описание схемы состоит из сведений о свойстве, таких как имя свойства, тип данных, ограничения, сведения о взаимодействии свойства с представлениями и системой поиска и т. д.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-126">The schema description consists of information about the property, such as the property name, data type, constraints, information on how the property interacts with views and the search system, and so forth.</span></span> <span data-ttu-id="c4e8e-127">Имя и описание схемы определяются глобально и одинаковы для всех элементов и типов.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-127">The name and schema description are defined globally, and are the same for all items and types.</span></span> <span data-ttu-id="c4e8e-128">Значение зависит от отдельного элемента.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-128">A value is specific to an individual item.</span></span> <span data-ttu-id="c4e8e-129">Это значит, что `System.Music.Artist` свойство всегда определено как строка с несколькими значениями, но может иметь другое значение (или вообще не иметь значения) для каждого элемента.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-129">That is, the `System.Music.Artist` property is always defined as a multi-value string, but may have a different value (or no value at all) for each item.</span></span>

<span data-ttu-id="c4e8e-130">Обработчик свойств преобразует данные, хранящиеся в файле, в структурированную схему, которая распознается и может быть доступна в проводнике Windows, Windows Search и других приложениях.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-130">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="c4e8e-131">Затем эти системы могут взаимодействовать с обработчиком свойств для записи и чтения свойств в файле и из него.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-131">These systems can then interact with the property handler to write and read properties to and from the file.</span></span> <span data-ttu-id="c4e8e-132">Переведенные данные предоставляются программно и отображаются для пользователя через проводник в различных контекстах, включая представление Details, инфотипс, область сведений, страницы свойств и т. д.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-132">The translated data is exposed programmatically and shown to the user through Windows Explorer in a variety of contexts including details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="c4e8e-133">Каждый обработчик свойств связан с определенным типом файла, который определяется расширением имени файла.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-133">Each property handler is associated with a particular file type, which is identified by the file name extension.</span></span> <span data-ttu-id="c4e8e-134">Разработчики должны реализовать обработчик свойств, который создает и использует собственный формат типа файла, например JPG или PNG, или используйте хранилище свойств In-Memory, которое создает и использует двоичный формат MS-ПРОПСТОРЕ.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-134">Developers should implement a property handler that produces and consumes their file type's native format, such as .jpg or .png, or use the In-Memory Property Store, which produces and consumes the MS-PROPSTORE binary format.</span></span>

<span data-ttu-id="c4e8e-135">Система свойств Windows создает абстрактную модель данных, которая предоставляет уровень абстракции из отдельных форматов файлов.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-135">The Windows Property System creates an abstract data model that provides a level of abstraction from individual file formats.</span></span> <span data-ttu-id="c4e8e-136">Абстрактная модель данных, предоставляемая системой свойств Windows, — это метод чтения и записи расширяемого набора именованных значений, связанных с элементом оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-136">The abstract data model provided by the Windows Property System is a method for reading and writing an extensible set of named values that are associated with a Shell item.</span></span> <span data-ttu-id="c4e8e-137">Выражение значения является гибким, поддерживает множество типов данных и является расширяемым, позволяя использовать произвольные данные (**\_ объект VT**) и объекты в качестве значения.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-137">The value expression is flexible, supporting many data types, and is extensible, enabling arbitrary data (**VT\_BLOB**) and objects to be expressed as a value.</span></span>

<span data-ttu-id="c4e8e-138">Из-за абстракции можно запрашивать атрибуты или метаданные любого элемента.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-138">Due to the abstraction, you can query the attributes or metadata of any item.</span></span> <span data-ttu-id="c4e8e-139">Примеры элементов, которые могут быть абстрактными, включают Microsoft Office документы, теги ID3, AutoCAD и другое стороннее программное обеспечение.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-139">Examples of items that can be abstracted include Microsoft Office documents, ID3 tags, and AutoCAD and other third-party proprietary software.</span></span> <span data-ttu-id="c4e8e-140">Аналогично, при наличии JPEG-файла можно использовать кодеки. JPEG и EXIF, чтобы прочитать байты файла, чтобы узнать, что такое размеры изображения.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-140">Similarly, if you have a .jpeg file, you can use the .jpeg and EXIF codecs to read the bytes of the file to discover what the dimensions of the image are.</span></span> <span data-ttu-id="c4e8e-141">Если вместо этого у вас есть PNG-файл, для этого нужен отдельный кодек и другой код.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-141">If you have a .png file instead, you need a different codec and different code to do so.</span></span> <span data-ttu-id="c4e8e-142">Использование системы свойств Windows позволяет избежать такого рода проблем.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-142">Using the Windows Property System avoids this sort of problem.</span></span> <span data-ttu-id="c4e8e-143">Если вы реализуете новый тип файла, то можете подключаться к единообразной абстракции, предлагаемой системой свойств Windows, и указать, как сделать метаданные более потребленными.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-143">If you implement a new file type, you have the option to plug into the uniform abstraction offered by the Windows Property System and specify how to make your metadata consumable.</span></span> <span data-ttu-id="c4e8e-144">По этим причинам всегда предпочтительнее использовать общую платформу, предоставляемую системой свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-144">For these reasons, it is always preferable to use the common platform provided by the Windows Property System.</span></span>

## <a name="development-scenarios"></a><span data-ttu-id="c4e8e-145">Сценарии разработки</span><span class="sxs-lookup"><span data-stu-id="c4e8e-145">Development Scenarios</span></span>

<span data-ttu-id="c4e8e-146">Свойства выражаются производителями и потребителями.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-146">Properties are expressed by producers and by consumers.</span></span> <span data-ttu-id="c4e8e-147">В этом контексте производители являются перечнем свойств в системе свойств Windows, а потребители — приложениями (и их разработчиками), которые используют сведения о свойствах из этой системы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-147">In this context, producers are the inventors of properties in the Windows Property System and consumers are applications (and their developers) that consume property information from this system.</span></span> <span data-ttu-id="c4e8e-148">В следующей таблице приведены варианты использования и участников системы свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-148">Uses of and participants in the Windows Property System are identified in the following table.</span></span>



| <span data-ttu-id="c4e8e-149">Использование системы свойств Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-149">Use of the Windows Property System</span></span>                                                                                                                                                                                            | <span data-ttu-id="c4e8e-150">Участник</span><span class="sxs-lookup"><span data-stu-id="c4e8e-150">Participant</span></span> |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| <span data-ttu-id="c4e8e-151">Стандартный блок, предоставляющий расширяемый реестр описаний свойств, реализацию хранилища свойств в памяти и службы для привязки к обработчикам свойств, преобразования типов и сериализации хранилищ свойств.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-151">A building block that provides an extensible registry of property descriptions, an in-memory property store implementation, and services for binding to property handlers, converting types, and serializing property stores.</span></span> | <span data-ttu-id="c4e8e-152">Потребители</span><span class="sxs-lookup"><span data-stu-id="c4e8e-152">Consumer</span></span>    |
| <span data-ttu-id="c4e8e-153">Приложения, которые хотят считывать и записывать свойства абстрактным способом.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-153">Applications that want to read and write properties in an abstract way.</span></span>                                                                                                                                                       | <span data-ttu-id="c4e8e-154">Потребители</span><span class="sxs-lookup"><span data-stu-id="c4e8e-154">Consumer</span></span>    |
| <span data-ttu-id="c4e8e-155">Свойство выполняет инвентаризацию, определяющую новые свойства для системы свойств, определяя схемы пользовательских свойств и разрабатывая собственные обработчики свойств.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-155">Property inventors who define new properties for the property system by defining custom property schemas and developing their own property handlers.</span></span>                                                                          | <span data-ttu-id="c4e8e-156">Производитель</span><span class="sxs-lookup"><span data-stu-id="c4e8e-156">Producer</span></span>    |
| <span data-ttu-id="c4e8e-157">Владельцы форматов файлов, которым требуется разрешить доступ к свойствам, хранящимся в пользовательских форматах файлов.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-157">File format owners who want to enable access to the properties stored in their custom file formats.</span></span>                                                                                                                           | <span data-ttu-id="c4e8e-158">Производитель</span><span class="sxs-lookup"><span data-stu-id="c4e8e-158">Producer</span></span>    |



 

<span data-ttu-id="c4e8e-159">Потребители используют существующие свойства, схемы и обработчики свойств.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-159">Consumers consume existing properties, schemas, and property handlers.</span></span> <span data-ttu-id="c4e8e-160">Свойства, доступные для использования, включают свойства чтения и записи из обработчиков свойств для поддерживаемых типов файлов, а также могут включать некоторые пользовательские свойства.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-160">Properties available for consumption include read/write properties from property handlers for supported file types and may also include some custom properties.</span></span> <span data-ttu-id="c4e8e-161">Доступные схемы включают как минимум системную схему, а иногда и другие.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-161">Available schemas include at least the system schema, and sometimes others, too.</span></span> <span data-ttu-id="c4e8e-162">Потребитель может создать приложение для использования метаданных и создать представление на основе исполнителя, независимо от того, в каких папках хранятся элементы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-162">A consumer can create an application to consume metadata and build a view based on artist, regardless of what folders the items are stored in.</span></span> <span data-ttu-id="c4e8e-163">Иерархия папок файлов не имеет значения.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-163">The file folder hierarchy is irrelevant.</span></span> <span data-ttu-id="c4e8e-164">Например, можно указать все элементы песни определенным Сингера, не заботясь о расположении таких элементов.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-164">For example, you can specify all song items by a particular singer without being concerned about the location of such items.</span></span> <span data-ttu-id="c4e8e-165">Этот комплексный, сквозной сценарий не ограничивается системой свойств Windows, но включает несколько различных компонентов, таких как индексирование и папки поиска.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-165">This complex, end-to-end scenario is not limited to the Windows Property System, but involves several different components, such as the indexing and search folders.</span></span>

<span data-ttu-id="c4e8e-166">Инвентаризация свойств или сторонних разработчиков — это производители в системе свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-166">Property inventors, or third-party developers, are producers in the Windows Property System.</span></span> <span data-ttu-id="c4e8e-167">При подготовке к определению нового свойства сначала проверьте набор свойств, которые определяет Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-167">When preparing to define a new property, first inspect the set of properties that Windows defines.</span></span> <span data-ttu-id="c4e8e-168">Если вы нашли нужный тип и семантику, которые соответствуют вашим потребностям, используйте это свойство и не изменяйте его.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-168">If you find one that meets your needs, of the type and semantics that match your required use, use that property and do not invent a new one.</span></span> <span data-ttu-id="c4e8e-169">При определении нового пользовательского свойства попробуйте получить соглашение с другими разработчиками, которые могут использовать его, и опубликуйте результат этого соглашения, чтобы он мог присоединиться к сообществу пользователей этого свойства.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-169">If you are defining a new custom property, try to obtain agreement with other developers that might want to use it and publish the result of that agreement so that they can join the community of users of that property.</span></span>

<span data-ttu-id="c4e8e-170">Производители могут воспользоваться возможностями проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-170">Producers can take advantage of Windows Explorer functionality.</span></span> <span data-ttu-id="c4e8e-171">Например, если вы создаете новый формат изображения и реализуете обработчик свойства, новый формат файла станет доступен в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-171">For example, if you are writing a new image format, and implement a property handler, your new file format becomes available in Windows Explorer.</span></span> <span data-ttu-id="c4e8e-172">Пользователи могут помечать свои фотографии и собирать их коллекции фотографий на основе любого свойства в системе свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-172">Users can then tag their photographs and pivot their collection of photographs based on any property in the Windows Property System.</span></span> <span data-ttu-id="c4e8e-173">На самом деле, все, что делает оболочкой со свойствами, сторонние разработчики могут делать в своих приложениях.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-173">In fact, anything that Shell does with properties, third-party developers can do in their own applications.</span></span> <span data-ttu-id="c4e8e-174">К ним относятся группирование, сортировка, запрос и отображение полных свойств.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-174">This includes grouping, sorting, querying, and displaying full properties.</span></span> <span data-ttu-id="c4e8e-175">Взаимодействие с пользователем, предоставляемое проводником Windows, может значительно реализовываться сторонними производителями с общедоступными интерфейсами API.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-175">The user experience that Windows Explorer provides can be largely implemented by third parties with publically available APIs.</span></span> <span data-ttu-id="c4e8e-176">Проводник Windows можно заменить или расширить с помощью этих API-интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-176">Windows Explorer can be replaced or extended using these APIs.</span></span>

<span data-ttu-id="c4e8e-177">С точки зрения приложения, использующего модель данных оболочки, существует множество сценариев, использующих систему свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-177">From the point of view of an application that uses the Shell data model, there are a huge variety of scenarios that involve the use of the Windows property system.</span></span> <span data-ttu-id="c4e8e-178">Примерами являются приложения для управления носителями.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-178">Media management applications are a prominent example.</span></span> <span data-ttu-id="c4e8e-179">Основные сценарии системы свойств включают такие сценарии, как чтение свойства ключевого слова фотографии или задание свойства датетакен.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-179">Core property system scenarios include scenarios such as reading the keyword property of a photograph or setting the datetaken property.</span></span> <span data-ttu-id="c4e8e-180">Примеры комплексных сценариев интеграции, которые включает система свойств Windows, но для работы которых требуется несколько других компонентов, включая отображение всех изображений или Поиск документа, содержащего ключевое слово.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-180">Examples of end-to-end integration scenarios that the Windows Property System enables, but that require several other components to function, include showing all pictures, or finding a document that contains a keyword.</span></span>

## <a name="properties-and-windows-search"></a><span data-ttu-id="c4e8e-181">Свойства и поиск Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-181">Properties and Windows Search</span></span>

<span data-ttu-id="c4e8e-182">Свойства служат производителями и потребителями при работе с поиском и индексированием Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-182">Properties serve both producers and consumers when they interface with Windows Search and indexing.</span></span> <span data-ttu-id="c4e8e-183">В Windows Search имеется кэш значений свойств, которые используются в реализации Служба поиска Windows (WSS).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-183">Windows Search has a cache of property values that are used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="c4e8e-184">Эти значения свойств можно запрашивать программным способом с помощью поставщика OLE DB поиска Windows или с помощью [**исеарчфолдеритемфактори**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), который представляет элементы в результатах поиска и представлениях на основе запросов.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-184">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="c4e8e-185">Затем поиск Windows собирает и сохраняет свойства, созданные обработчиками фильтров или обработчиками свойств при индексировании элемента, такого как документ Word.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-185">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="c4e8e-186">Это хранилище отбрасывается и перестраивается при перестроении индекса.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-186">This store is discarded and rebuilt when the index is rebuilt.</span></span>

> [!Note]  
> <span data-ttu-id="c4e8e-187">Помните, что при повторной регистрации схемы изменения, внесенные в атрибуты ранее определенных свойств, могут не рассматриваться в качестве индексатора.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-187">Remember that when you reregister a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="c4e8e-188">Решением может быть перестроение индекса или появление новых свойств, отражающих изменения вместо обновления старых (не рекомендуется).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-188">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="c4e8e-189">Дополнительные сведения см. в подразделе " [Примечание для разработчиков](#note-to-implementers) " Далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-189">For more information, see [Note to Implementers](#note-to-implementers) later in this topic.</span></span>

 

<span data-ttu-id="c4e8e-190">Например, разработчик, создающий приложение мультимедиа, хочет показать пользователям приложения всю доступную музыку по определенному исполнителю.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-190">For example, a developer creating a media application wants to show users of the application all available music by a particular artist.</span></span> <span data-ttu-id="c4e8e-191">Приложение предоставит пользователю список доступных исполнителей, а затем создаст список всех доступных музыкальных файлов по исполнителю, выбранному пользователем.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-191">The application would provide the user with a list of available artists, and then generate a list of all available music by the artist that the user selects.</span></span> <span data-ttu-id="c4e8e-192">Или конечному пользователю может потребоваться выполнить запрос для? исполнителя: Бисовен? и предоставить полный список доступных свойств в процессе поиска.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-192">Or an end user might want to do a query for ?artist:Beethoven?, and be exposed to the full list of available properties in the course of their searche.</span></span> <span data-ttu-id="c4e8e-193">В этом примере используется пространство имен оболочки, обработчики свойств и/или запрос индекса одним из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="c4e8e-193">This example involves the use of the Shell namespace, property handlers, and/or querying the index through one of the following:</span></span>

-   <span data-ttu-id="c4e8e-194">Источник данных оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-194">A Shell data source.</span></span>
-   <span data-ttu-id="c4e8e-195">Поставщик OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-195">An OLE DB provider.</span></span>
-   <span data-ttu-id="c4e8e-196">Файл сохраненного поиска (. Search-MS), который используется для инициации запроса путем перехода к файлу поиска в проводнике Windows или привязки к [**ишеллфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) программным способом.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-196">A Saved Search file (.search-ms) that is used to initiate a query by navigating to the search file in Windows Explorer or binding to [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) programmatically.</span></span>

> [!Note]  
> <span data-ttu-id="c4e8e-197">Несмотря на то `System.Kind` , что свойство не участвует в этом сценарии приложения мультимедиа, его можно использовать для создания запроса, возвращающего все файлы. Search-MS в определенной области.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-197">Although the `System.Kind` property does not participate in this media application scenario, it could be used to build a query that would return all of the .search-ms files in a particular scope.</span></span>

 

<span data-ttu-id="c4e8e-198">Предпочтительный способ доступа к API поиска и создания приложений Windows Search — через источник данных оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-198">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="c4e8e-199">[**Исеарчфолдеритемфактори**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) — это компонент, который может создавать экземпляры источника данных папки поиска, т. е. "виртуальный" источник данных, предоставляемый оболочкой, который может выполнять запросы к другим источникам данных в пространстве имен оболочки и перечислять результаты.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the Search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="c4e8e-200">Это можно сделать либо с помощью индексатора, либо путем перечисления и проверки элементов в указанных областях вручную.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-200">It can do so either by using the indexer, or by manually enumerating and inspecting items in the specified scopes.</span></span>

<span data-ttu-id="c4e8e-201">Сторонние разработчики могут создавать приложения, которые используют данные в индексе через программные запросы, и могут расширять данные в индексе для пользовательских файлов и типов элементов, индексируемых службой поиска Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-201">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="c4e8e-202">Если необходимо отобразить результаты запроса в проводнике Windows, необходимо реализовать источник данных оболочки, прежде чем можно будет создать обработчик протокола для расширения индекса.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-202">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="c4e8e-203">Однако если все запросы будут программно (например, OLE DB) и интерпретироваться кодом приложения? s, а не оболочкой, то пространство имен оболочки по-прежнему является предпочтительным, но не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-203">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application?s code rather than the Shell, then a Shell namespace is still preferred but not required.</span></span> <span data-ttu-id="c4e8e-204">Для получения сведений о содержимом файлов, таких как элементы в базах данных или пользовательские типы файлов, необходим обработчик протокола.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-204">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="c4e8e-205">Хотя поиск Windows может индексировать имя и свойства файла, Windows не содержит сведений о содержимом файла.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-205">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="c4e8e-206">В результате такие элементы не могут индексироваться или быть представлены в оболочке Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-206">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="c4e8e-207">Реализуя пользовательский обработчик протокола, вы можете предоставить эти элементы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-207">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="c4e8e-208">Список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь получить, см. в разделе «Обзор обработчиков» в [Windows Search как платформа разработки](../search/-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-208">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](../search/-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="c4e8e-209">Источник данных оболочки иногда называют расширением пространства имен оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-209">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="c4e8e-210">Обработчик иногда называют расширением оболочки или обработчиком расширения оболочки.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-210">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

## <a name="note-to-implementers"></a><span data-ttu-id="c4e8e-211">Примечание для разработчиков</span><span class="sxs-lookup"><span data-stu-id="c4e8e-211">Note to Implementers</span></span>

<span data-ttu-id="c4e8e-212">Из-за потенциальных проблем, которые может иметь индексатор при использовании схемы системы свойств, очень важно определить атрибуты внимательно и стратегически для первого выпуска схемы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-212">Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema.</span></span> <span data-ttu-id="c4e8e-213">Любые изменения атрибутов (тип, ширина столбца, будь то индексибле) не будут отражаться в базе данных после регистрации схемы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-213">Any changes to attributes (type, column width, whether indexible) will not be reflected in the database after a schema has been registered.</span></span> <span data-ttu-id="c4e8e-214">Единственным способом определения этих изменений после регистрации схемы в системе может быть либо перестроение индекса, а затем регистрация новой схемы или регистрация схемы, а затем создание нового свойства для каждого последующего выпуска. Например, `PKEY_GroupName_PropertyNameV2` `PKEY_GroupName_PropertyNameV3` и т. д.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-214">The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example `PKEY_GroupName_PropertyNameV2`, `PKEY_GroupName_PropertyNameV3`, and so forth.</span></span> <span data-ttu-id="c4e8e-215">Не рекомендуется создавать новые свойства таким образом, поскольку несколько внешних столбцов могут повлиять на производительность системы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-215">We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</span></span>

## <a name="windows-property-system-documentation"></a><span data-ttu-id="c4e8e-216">Документация системы свойств Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-216">Windows Property System Documentation</span></span>

<span data-ttu-id="c4e8e-217">Оставшаяся часть этой документации содержит следующие разделы.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-217">The remainder of this documentation contains the following sections:</span></span>

-   [<span data-ttu-id="c4e8e-218">Руководством разработчика системы свойств Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-218">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)

    <span data-ttu-id="c4e8e-219">Подробное описание реализации основных сценариев разработки с использованием системы свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-219">Describes in detail how to implement the main development scenarios using the Windows Property System.</span></span>

-   [<span data-ttu-id="c4e8e-220">Справочник по свойствам системы</span><span class="sxs-lookup"><span data-stu-id="c4e8e-220">Property System Reference</span></span>](property-system-reference.md)

    <span data-ttu-id="c4e8e-221">Документирует [Свойства Windows](props.md), [схему описания свойств](property-description-schema.md), [интерфейсы](interfaces.md), [функции](functions.md), [структуры](structures.md)и [константы, перечисления и флаги](constants--enumerations--and-flags.md) системы свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-221">Documents the [Windows Properties](props.md), [Property Description Schema](property-description-schema.md), [Interfaces](interfaces.md), [Functions](functions.md), [Structures](structures.md), and [Constants, Enumerations, and Flags](constants--enumerations--and-flags.md) of the Windows Property System.</span></span>

-   [<span data-ttu-id="c4e8e-222">Образцы кода системы свойств</span><span class="sxs-lookup"><span data-stu-id="c4e8e-222">Property System Code Samples</span></span>](property-system-code-samples.md)

    <span data-ttu-id="c4e8e-223">Содержит описание примеров, демонстрирующих использование системы свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-223">Describes samples that demonstrate how to use the Windows Property System.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="c4e8e-224">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="c4e8e-224">Additional Resources</span></span>

-   <span data-ttu-id="c4e8e-225">Дополнительные сведения о повторном использовании хранилища свойств In-Memory см. в разделе [инициализация обработчиков свойств](building-property-handlers-property-handlers.md) и [**пскреатемеморипропертисторе**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-225">For information about reusing the In-Memory Property Store, see [Initializing Property Handlers](building-property-handlers-property-handlers.md) and [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span></span>
-   <span data-ttu-id="c4e8e-226">Описание формата двоичных файлов в хранилище свойств Майкрософт см. в разделе [ \[ MS \_ пропсторе \] ](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-226">For a specification of the Microsoft Property Store Binary File Format, see [\[MS\_PROPSTORE\]](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span></span>
-   <span data-ttu-id="c4e8e-227">Связь между поиском и индексацией Windows и расширением индекса описывается в следующих разделах, посвященных поиску в Windows.</span><span class="sxs-lookup"><span data-stu-id="c4e8e-227">The relationship between Windows Search and indexing, and how to extend the index, are explained in the following topics in Windows Search:</span></span>
    -   [<span data-ttu-id="c4e8e-228">Разработка обработчиков фильтров для поиска Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-228">Developing Filter Handlers for Windows Search</span></span>](../search/-search-ifilter-conceptual.md)
    -   [<span data-ttu-id="c4e8e-229">Разработка обработчиков протоколов для поиска Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-229">Developing Protocol Handlers for Windows Search</span></span>](../search/-search-3x-wds-phaddins.md)
    -   [<span data-ttu-id="c4e8e-230">Разработка обработчиков свойств для поиска Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-230">Developing Property Handlers for Windows Search</span></span>](../search/-search-3x-wds-extidx-propertyhandlers.md)
    -   <span data-ttu-id="c4e8e-231">Для загрузки Windows 7 или обновления пакета SDK для Windows Vista см. [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span><span class="sxs-lookup"><span data-stu-id="c4e8e-231">For the Windows 7 or updated Windows Vista SDK download, see the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c4e8e-232">См. также</span><span class="sxs-lookup"><span data-stu-id="c4e8e-232">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c4e8e-233">Руководством разработчика системы свойств Windows</span><span class="sxs-lookup"><span data-stu-id="c4e8e-233">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)
</dt> <dt>

[<span data-ttu-id="c4e8e-234">Справочник по свойствам системы</span><span class="sxs-lookup"><span data-stu-id="c4e8e-234">Property System Reference</span></span>](property-system-reference.md)
</dt> <dt>

[<span data-ttu-id="c4e8e-235">Образцы кода системы свойств</span><span class="sxs-lookup"><span data-stu-id="c4e8e-235">Property System Code Samples</span></span>](property-system-code-samples.md)
</dt> </dl>

 

 
