---
description: В этом разделе объясняется, как создавать и регистрировать обработчики свойств для работы с системой свойств Windows.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Рекомендации и вопросы и ответы по обработчикам свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5188e66f08f3c6cf449f8bc61feb6aac829d37c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272367"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="b8242-103">Рекомендации и вопросы и ответы по обработчикам свойств</span><span class="sxs-lookup"><span data-stu-id="b8242-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="b8242-104">В этом разделе объясняется, как создавать и регистрировать обработчики свойств для работы с системой свойств Windows.</span><span class="sxs-lookup"><span data-stu-id="b8242-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="b8242-105">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b8242-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="b8242-106">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="b8242-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="b8242-107">Переопределение свойств файловой системы</span><span class="sxs-lookup"><span data-stu-id="b8242-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="b8242-108">Хранение свойств в форматах файлов на основе XML</span><span class="sxs-lookup"><span data-stu-id="b8242-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="b8242-109">Вычисленные свойства</span><span class="sxs-lookup"><span data-stu-id="b8242-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="b8242-110">Часто задаваемые вопросы</span><span class="sxs-lookup"><span data-stu-id="b8242-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="b8242-111">См. также</span><span class="sxs-lookup"><span data-stu-id="b8242-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="b8242-112">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="b8242-112">Best Practices</span></span>

<span data-ttu-id="b8242-113">Рекомендации, описанные здесь, содержат полезные советы по реализации.</span><span class="sxs-lookup"><span data-stu-id="b8242-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="b8242-114">Переопределение свойств файловой системы</span><span class="sxs-lookup"><span data-stu-id="b8242-114">Overriding File System Properties</span></span>

<span data-ttu-id="b8242-115">Некоторые свойства файлов предоставляются источником данных файловой системы, например:</span><span class="sxs-lookup"><span data-stu-id="b8242-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="b8242-116">\_Имя файла PKEY</span><span class="sxs-lookup"><span data-stu-id="b8242-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="b8242-117">\_Расширение PKEY</span><span class="sxs-lookup"><span data-stu-id="b8242-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="b8242-118">PKEY \_ ModifiedTime</span><span class="sxs-lookup"><span data-stu-id="b8242-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="b8242-119">Как правило, обработчики свойств не могут предоставлять значения для этих свойств.</span><span class="sxs-lookup"><span data-stu-id="b8242-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="b8242-120">Однако в некоторых случаях эти свойства могут быть переопределены на основе сведений о регистрации, предоставленных обработчиком свойств.</span><span class="sxs-lookup"><span data-stu-id="b8242-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="b8242-121">Обработчики свойств заполняют **\_ классы hKey \_ корневого** \\ **CLSID** \\ *{handler CLSID}* \\ **оверридефилесистемпропертиес** именами свойств, которые требуется переопределить.</span><span class="sxs-lookup"><span data-stu-id="b8242-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="b8242-122">Это ограничено фиксированным набором свойств, показанных в следующем списке, в котором система имеет набор знаний.</span><span class="sxs-lookup"><span data-stu-id="b8242-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="b8242-123">Переопределение поддерживается для следующих значений свойств:</span><span class="sxs-lookup"><span data-stu-id="b8242-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="b8242-124">System. Kind</span><span class="sxs-lookup"><span data-stu-id="b8242-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="b8242-125">System. имя_файла</span><span class="sxs-lookup"><span data-stu-id="b8242-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="b8242-126">System. Испиннедтонамеспацетри</span><span class="sxs-lookup"><span data-stu-id="b8242-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="b8242-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="b8242-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="b8242-128">System. Сфгаофлагс</span><span class="sxs-lookup"><span data-stu-id="b8242-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="b8242-129">System. Итемпасдисплай</span><span class="sxs-lookup"><span data-stu-id="b8242-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="b8242-130">System. Итемпасдисплайнарров</span><span class="sxs-lookup"><span data-stu-id="b8242-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="b8242-131">System. Итемфолдернамедисплай</span><span class="sxs-lookup"><span data-stu-id="b8242-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="b8242-132">System. Итемфолдерпасдисплай</span><span class="sxs-lookup"><span data-stu-id="b8242-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="b8242-133">System. Итемфолдерпасдисплайнарров</span><span class="sxs-lookup"><span data-stu-id="b8242-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="b8242-134">Полный список всех свойств оболочки см. в разделе [свойства оболочки](./props.md).</span><span class="sxs-lookup"><span data-stu-id="b8242-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b8242-135">Переопределенные значения свойств используются только при индексировании файлов.</span><span class="sxs-lookup"><span data-stu-id="b8242-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="b8242-136">Таким путем, просмотр файлов из источника данных файловой системы не приводит к раскрытию переопределенных значений.</span><span class="sxs-lookup"><span data-stu-id="b8242-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="b8242-137">Хранение свойств в форматах файлов на основе XML</span><span class="sxs-lookup"><span data-stu-id="b8242-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="b8242-138">Существует два основных варианта хранения свойств в форматах файлов на основе XML:</span><span class="sxs-lookup"><span data-stu-id="b8242-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="b8242-139">Сохраните каждое свойство, используя XML-элементы и атрибуты в соответствии со схемой XML документа.</span><span class="sxs-lookup"><span data-stu-id="b8242-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="b8242-140">Этот подход является более «XML-понятным».</span><span class="sxs-lookup"><span data-stu-id="b8242-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="b8242-141">Выполните сериализацию всего хранилища свойств в большой двоичный объект в памяти (BLOB), преобразуйте большой двоичный объект в строку в кодировке Base64, а затем сохраните эту строку в XML.</span><span class="sxs-lookup"><span data-stu-id="b8242-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="b8242-142">Это более простой из двух подходов и может использоваться для упрощенного предоставления поддержки открытых метаданных.</span><span class="sxs-lookup"><span data-stu-id="b8242-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="b8242-143">Некоторые обработчики могут сочетать эти подходы, сохраняя некоторые важные значения в стандартном формате XML и сохраняя остальные в большом двоичном объекте, например.</span><span class="sxs-lookup"><span data-stu-id="b8242-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="b8242-144">Вычисляемые свойства</span><span class="sxs-lookup"><span data-stu-id="b8242-144">Computed Properties</span></span>

<span data-ttu-id="b8242-145">Некоторые свойства являются производными от определенных атрибутов файла.</span><span class="sxs-lookup"><span data-stu-id="b8242-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="b8242-146">Например, свойство [System. Image. Dimensions](./props-system-image-dimensions.md) определяется фактическими размерами изображения в файле изображения.</span><span class="sxs-lookup"><span data-stu-id="b8242-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="b8242-147">Так как эти значения свойств не могут быть изменены обработчиком свойств, они помечаются `isInnate="true"` в описании свойства.</span><span class="sxs-lookup"><span data-stu-id="b8242-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="b8242-148">Другие свойства вычисляются из части определенного свойства или путем статистической обработки значений нескольких свойств.</span><span class="sxs-lookup"><span data-stu-id="b8242-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="b8242-149">Поскольку обновления для этих "вычисленных" свойств могут привести к неоднозначности при изменении значений "Source", вычисленные свойства должны быть помечены `isInnate="true"` в описании свойства или переданы только для чтения.</span><span class="sxs-lookup"><span data-stu-id="b8242-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="b8242-150">Второй вариант доступен путем указания обработчику возвращать S \_ false из [**ипропертисторекапабилитиес:: испропертивритабле**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span><span class="sxs-lookup"><span data-stu-id="b8242-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="b8242-151">Вопросы и ответы</span><span class="sxs-lookup"><span data-stu-id="b8242-151">Frequently Asked Questions</span></span>

<span data-ttu-id="b8242-152">В этом разделе содержатся ответы на часто задаваемые вопросы о свойствах и обработчиках свойств, а также сопутствующие ответы.</span><span class="sxs-lookup"><span data-stu-id="b8242-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="b8242-153">**Вопрос:** Почему обработчик службы "Поиск Windows" не загружает дескриптор моего свойства?</span><span class="sxs-lookup"><span data-stu-id="b8242-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="b8242-154">Индексатор службы поиска Windows запускается как системная служба и не может загружать библиотеки DLL, которые хранятся в каталоге профиля пользователя.</span><span class="sxs-lookup"><span data-stu-id="b8242-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="b8242-155">Если сборка и отладка выполняется с помощью Microsoft Visual Studio, то библиотека DLL будет размещена в профиле пользователя (и, следовательно, не будет загружена индексатором).</span><span class="sxs-lookup"><span data-stu-id="b8242-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="b8242-156">Чтобы обойти это, Скопируйте библиотеку DLL вне папки профиля (например, в **C: \\ Program Files \\ YourAppName**) и зарегистрируйте ее там.</span><span class="sxs-lookup"><span data-stu-id="b8242-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="b8242-157">Дополнительные сведения о разработке обработчиков свойств для работы с индексатором поиска Windows см. в разделе [Разработка обработчиков свойств для службы поиска Windows](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="b8242-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="b8242-158">**Вопрос:** Какие свойства должны обнаруживаться с помощью методов перечисления [**ипропертисторе:: NOCOUNT**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) и [**Ипропертисторе:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ?</span><span class="sxs-lookup"><span data-stu-id="b8242-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="b8242-159">Эти методы используются не всеми клиентами объектов хранилища свойств.</span><span class="sxs-lookup"><span data-stu-id="b8242-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="b8242-160">Некоторые клиенты знают о свойствах, которые планируется запрашивать напрямую (по имени PKEY), или получать сведения о свойствах с помощью списка описания свойства.</span><span class="sxs-lookup"><span data-stu-id="b8242-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="b8242-161">Методы обнаружения свойств встроенная несколько других сценариев.</span><span class="sxs-lookup"><span data-stu-id="b8242-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="b8242-162">Если свойству не требуется участвовать в этих сценариях, его не нужно перечислять.</span><span class="sxs-lookup"><span data-stu-id="b8242-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="b8242-163">Таким образом, обработчик свойства может создать \_ пустое значение, отличное от VT, для свойств, которые не обнаруживаются с помощью методов [**ипропертисторе:: NOCOUNT**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) и [**ипропертисторе:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="b8242-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="b8242-164">Однако свойства должны быть видимыми через эти методы, если выполняются следующие условия.</span><span class="sxs-lookup"><span data-stu-id="b8242-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="b8242-165">**Если свойство индексируется так, чтобы оно было доступно для поиска:** Это означает, что оно включено в хранилище свойств поиска Windows (обозначено `isColumn = "true"` в схеме описания свойства) или доступно для полнотекстового поиска ( `inInvertedIndex = "true"` ).</span><span class="sxs-lookup"><span data-stu-id="b8242-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="b8242-166">При отсутствии этих флагов или отсутствия описания свойства свойства типа "строка" будут автоматически добавлены в инвертированный индекс, чтобы обеспечить возможность поиска.</span><span class="sxs-lookup"><span data-stu-id="b8242-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="b8242-167">Поскольку список известных свойств (с описаниями установленных свойств) в системе свойств очень большой (более 800 свойств), было бы нецелесообразным задавать каждый обработчик свойств для каждого свойства, зарегистрированного в системе свойств.</span><span class="sxs-lookup"><span data-stu-id="b8242-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="b8242-168">Вместо этого процесс индексирования перечисляет соответствующие свойства из обработчика свойств для каждого элемента, который он индексирует, и использует значения перечислимых свойств для создания полнотекстового индекса.</span><span class="sxs-lookup"><span data-stu-id="b8242-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="b8242-169">Значение **, если свойство должно быть скопировано при дублировании набора свойств элемента:** Чтобы реализовать функцию "Копировать набор свойств", исходный элемент делает свойства, которые должны быть скопированы, видимыми с помощью методов [**ипропертисторе:: NOCOUNT**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) и [**Ипропертисторе:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="b8242-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="b8242-170">Не следует включать свойства, которые не нужно копировать или копировать в смысл.</span><span class="sxs-lookup"><span data-stu-id="b8242-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="b8242-171">**Если значение свойства не пусто (VT \_ Empty):** пустые значения свойств не подходят для клиентов.</span><span class="sxs-lookup"><span data-stu-id="b8242-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="b8242-172">Когда клиенты пытаются вернуть пустые значения свойств, возвращается значение VT \_ Empty.</span><span class="sxs-lookup"><span data-stu-id="b8242-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="b8242-173">Поэтому не следует перечислять свойства с пустыми значениями.</span><span class="sxs-lookup"><span data-stu-id="b8242-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="b8242-174">Значение **, если свойство должно быть удалено при вызове функции "Remove Properties":** Эта функция существует для защиты конфиденциальности. Он находит все значения из обработчика свойств через перечисление и удаляет каждое из них, выбранное для удаления пользователем.</span><span class="sxs-lookup"><span data-stu-id="b8242-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="b8242-175">Перечисление свойств не передает набор свойств, поддерживаемых определенным обработчиком свойств, если обработчик поддерживает фиксированную схему (а не открытые метаданные).</span><span class="sxs-lookup"><span data-stu-id="b8242-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="b8242-176">Вместо этого такие обработчики должны документировать набор свойств, которые они поддерживают.</span><span class="sxs-lookup"><span data-stu-id="b8242-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="b8242-177">**Вопрос:** Разделы справки выяснить, какие форматы файлов поддерживают открытые метаданные?</span><span class="sxs-lookup"><span data-stu-id="b8242-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="b8242-178">Дополнительные сведения о поддержке открытых метаданных см. в разделе "типы файлов, поддерживающие открытые метаданные" раздела [типы файлов](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="b8242-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="b8242-179">**Вопрос:** Можно \_ ли хранить значения NULL VT с помощью обработчика свойств?</span><span class="sxs-lookup"><span data-stu-id="b8242-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="b8242-180">Нет.</span><span class="sxs-lookup"><span data-stu-id="b8242-180">No.</span></span> <span data-ttu-id="b8242-181">\_Значения NULL VT будут преобразованы в VT \_ Empty при вызовах функций [**Ипропертисторе:: GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) и [**ипропертисторе:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b8242-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="b8242-182">**Вопрос:** Какие форматы строк даты поддерживаются функцией [**пропвариантчанжетипе**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) ?</span><span class="sxs-lookup"><span data-stu-id="b8242-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="b8242-183">Как правило, свойства, представляющие значения даты и времени, должны быть представлены с помощью VT \_ fileTime.</span><span class="sxs-lookup"><span data-stu-id="b8242-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="b8242-184">Однако многие источники данных предоставляют эту информацию в виде строки.</span><span class="sxs-lookup"><span data-stu-id="b8242-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="b8242-185">Вспомогательный API [**пропвариантчанжетипе**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) поддерживает приведение некоторых строковых форматов даты к значениям [**fileTime**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="b8242-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="b8242-186">Формат</span><span class="sxs-lookup"><span data-stu-id="b8242-186">Format</span></span>                  | <span data-ttu-id="b8242-187">Windows Vista, Windows XP и Microsoft Windows Desktop Search (WDS)</span><span class="sxs-lookup"><span data-stu-id="b8242-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="b8242-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="b8242-188">Windows 7</span></span> | <span data-ttu-id="b8242-189">Примечания</span><span class="sxs-lookup"><span data-stu-id="b8242-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="b8242-190">гггг/мм/дд: чч: мм: СС. ууу</span><span class="sxs-lookup"><span data-stu-id="b8242-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="b8242-191">Да</span><span class="sxs-lookup"><span data-stu-id="b8242-191">Yes</span></span>                                                                   | <span data-ttu-id="b8242-192">Да</span><span class="sxs-lookup"><span data-stu-id="b8242-192">Yes</span></span>       | <span data-ttu-id="b8242-193">ФОРМАТА y = year, m = месяц, d = Дата, h = часы (24-часовой формат), m = минуты, s = секунды, u = микросекунды</span><span class="sxs-lookup"><span data-stu-id="b8242-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="b8242-194">гггг-мм-ddThh: мм: ссZ</span><span class="sxs-lookup"><span data-stu-id="b8242-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="b8242-195">Нет</span><span class="sxs-lookup"><span data-stu-id="b8242-195">No</span></span>                                                                    | <span data-ttu-id="b8242-196">Да</span><span class="sxs-lookup"><span data-stu-id="b8242-196">Yes</span></span>       | <span data-ttu-id="b8242-197">**Спецификация формата ISO8601** Время в формате UTC (обозначено индикатором часового пояса "Z"); y = year, m = месяц, d = Дата, h = часы (24-часовой формат), m = минуты, s = секунды; 'T ' является разделителем для временной части.</span><span class="sxs-lookup"><span data-stu-id="b8242-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="b8242-198">**Вопрос:** Можно ли создать обработчик свойств только для чтения?</span><span class="sxs-lookup"><span data-stu-id="b8242-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="b8242-199">Да.</span><span class="sxs-lookup"><span data-stu-id="b8242-199">Yes.</span></span> <span data-ttu-id="b8242-200">Некоторые реализации обработчиков свойств не поддерживают запись значений свойств.</span><span class="sxs-lookup"><span data-stu-id="b8242-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="b8242-201">Эти обработчики свойств должны возвращать СТГМ \_ E \_ ACCESSDENIED при вызовах **Иинитиализекскскс:: Initialize** , прошедших стгм \_ ReadWrite, или при любом вызове метода [**ипропертисторе:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b8242-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="b8242-202">Все обработчики свойств, открытые в \_ режиме чтения стгм, должны возвращать стгм \_ E \_ ACCESSDENIED при вызовах [**ипропертисторе:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b8242-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="b8242-203">**Вопрос:** Может ли обработчик свойства обрабатывать свойство как доступное только для чтения, даже если схема указывает, что свойство доступно для записи?</span><span class="sxs-lookup"><span data-stu-id="b8242-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="b8242-204">Да.</span><span class="sxs-lookup"><span data-stu-id="b8242-204">Yes.</span></span> <span data-ttu-id="b8242-205">В системе схемы свойства записываются как доступные только для чтения (включая элементы с `isInnate = "true"` ) или для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="b8242-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="b8242-206">Обработчики свойств, которые не поддерживают запись определенного свойства, которое должно быть доступно для записи в схеме, должны реализовывать [**ипропертисторекапабилитиес**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) и возвращать \_ значение false для вызовов [**ипропертисторекапабилитиес:: испропертивритабле**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) для этого свойства.</span><span class="sxs-lookup"><span data-stu-id="b8242-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="b8242-207">Это означает, что в контексте этого обработчика и этого файла свойство недоступно для записи.</span><span class="sxs-lookup"><span data-stu-id="b8242-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="b8242-208">Обратная операция невозможна.</span><span class="sxs-lookup"><span data-stu-id="b8242-208">The reverse action is not possible.</span></span> <span data-ttu-id="b8242-209">Нельзя включить обработчик свойств для записи свойства, которое помечено как доступное только для чтения в схеме</span><span class="sxs-lookup"><span data-stu-id="b8242-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="b8242-210">См. также</span><span class="sxs-lookup"><span data-stu-id="b8242-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b8242-211">Основные сведения о обработчиках свойств</span><span class="sxs-lookup"><span data-stu-id="b8242-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="b8242-212">Использование имен видов</span><span class="sxs-lookup"><span data-stu-id="b8242-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="b8242-213">Использование списков свойств</span><span class="sxs-lookup"><span data-stu-id="b8242-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="b8242-214">Инициализация обработчиков свойств</span><span class="sxs-lookup"><span data-stu-id="b8242-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="b8242-215">Регистрация и распространение обработчиков свойств</span><span class="sxs-lookup"><span data-stu-id="b8242-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
