---
title: Реализация модели безопасности Teredo
description: Модель безопасности Teredo основана на технологии платформы фильтрации Windows (WFP), встроенной в Windows Vista. Поэтому рекомендуется, чтобы брандмауэры сторонних производителей использовали WFP для реализации модели безопасности Teredo.
ms.assetid: ee81e5f1-e3e0-440e-a53f-2accced476bc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a39668f8e1c86e0cd5b12056df5eb9a5fd9cd3ee
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103792937"
---
# <a name="implementing-the-teredo-security-model"></a><span data-ttu-id="72163-104">Реализация модели безопасности Teredo</span><span class="sxs-lookup"><span data-stu-id="72163-104">Implementing the Teredo Security Model</span></span>

<span data-ttu-id="72163-105">Модель безопасности Teredo основана на технологии [платформы фильтрации Windows](/windows/desktop/FWP/windows-filtering-platform-start-page) (WFP), встроенной в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="72163-105">The Teredo security model is based on the [Windows Filtering Platform](/windows/desktop/FWP/windows-filtering-platform-start-page) (WFP) technology built into Windows Vista.</span></span> <span data-ttu-id="72163-106">Поэтому рекомендуется, чтобы брандмауэры сторонних производителей использовали WFP для реализации модели безопасности [Teredo](about-teredo.md) .</span><span class="sxs-lookup"><span data-stu-id="72163-106">As a result, it is recommended that third-party firewalls use WFP to enforce the [Teredo](about-teredo.md) security model.</span></span>

<span data-ttu-id="72163-107">Общая реализация [модели безопасности Teredo](the-teredo-security-model.md) требует следующего:</span><span class="sxs-lookup"><span data-stu-id="72163-107">The general implementation of the [Teredo Security Model](the-teredo-security-model.md) requires the following:</span></span>

-   <span data-ttu-id="72163-108">На компьютере должен быть зарегистрирован брандмауэр узла с поддержкой IPv6 в центре безопасности Windows (WSC).</span><span class="sxs-lookup"><span data-stu-id="72163-108">An IPv6-capable host firewall must be registered with Windows Security Center (WSC) on the machine.</span></span> <span data-ttu-id="72163-109">В отсутствие брандмауэра на основе узла или самого интерфейса WSC интерфейс Teredo будет недоступен для использования.</span><span class="sxs-lookup"><span data-stu-id="72163-109">In the absence of a host-based firewall, or WSC itself, the Teredo interface will not be available for use.</span></span> <span data-ttu-id="72163-110">Это единственное требование для получения запрошенного трафика из Интернета через интерфейс Teredo.</span><span class="sxs-lookup"><span data-stu-id="72163-110">This is the only requirement to receive solicited traffic from the Internet over the Teredo interface.</span></span>
-   <span data-ttu-id="72163-111">Любое приложение, которое получает незапрошенный трафик из Интернета через интерфейс Teredo, должно зарегистрироваться в брандмауэре с поддержкой IPv6, например в [брандмауэре Windows](/previous-versions/windows/desktop/ics/windows-firewall-start-page), прежде чем получать нежелательный трафик.</span><span class="sxs-lookup"><span data-stu-id="72163-111">Any application that receives unsolicited traffic from the Internet over the Teredo interface must register with an IPv6-capable firewall, like [Windows Firewall](/previous-versions/windows/desktop/ics/windows-firewall-start-page), before receiving the unsolicited traffic.</span></span>

<span data-ttu-id="72163-112">Адрес Teredo становится неактивным, если трафик не был отправлен или получен через интерфейс Teredo в течение одного часа, а приложения, удовлетворяющие необходимым критериям безопасности для незапрошенного трафика, не запущены или не имеют открытых сокетов прослушивания.</span><span class="sxs-lookup"><span data-stu-id="72163-112">A Teredo address will become dormant if traffic has not been sent or received over the Teredo interface for one hour and if applications that meet the required security criteria for unsolicited traffic are not running or do not have listening sockets open.</span></span>

<span data-ttu-id="72163-113">После перезагрузки компьютера или если адрес Teredo теряет свои квалификации, Windows Vista автоматически уточняет адрес и сделает его доступным для использования, как только приложение привязывается к сокетам, поддерживающим IPv6.</span><span class="sxs-lookup"><span data-stu-id="72163-113">After the reboot of a machine, or if the Teredo address loses its qualifications, Windows Vista will automatically qualify the address and makes it available for use as soon as an application binds to IPv6-capable sockets.</span></span> <span data-ttu-id="72163-114">Важно отметить, что параметр брандмауэра Windows "обход узлов", заданный приложением, чтобы разрешить незапрошенный трафик через Teredo, сохраняется в процессе перезагрузки.</span><span class="sxs-lookup"><span data-stu-id="72163-114">It is important to note that the Windows Firewall "Edge Traversal" option set by an application to allow unsolicited traffic via Teredo is persistent across reboots.</span></span>

## <a name="firewall-requirements-for-teredo"></a><span data-ttu-id="72163-115">Требования к брандмауэру для Teredo</span><span class="sxs-lookup"><span data-stu-id="72163-115">Firewall Requirements for Teredo</span></span>

<span data-ttu-id="72163-116">Поставщики брандмауэра могут без труда включить поддержку Teredo в своих продуктах и защитить их пользователей, используя возможности платформы фильтрации Windows.</span><span class="sxs-lookup"><span data-stu-id="72163-116">Firewall vendors can easily incorporate Teredo support in their products and protect their users by using the capabilities of the Windows Filtering Platform.</span></span> <span data-ttu-id="72163-117">Это можно сделать, зарегистрировав брандмауэр с поддержкой IPv6 в центре безопасности Windows, добавляя соответствующие правила в подуровень Teredo WFP и используя встроенные API в Windows для перечисления приложений, которые могут прослушивать незапрошенный трафик через Teredo.</span><span class="sxs-lookup"><span data-stu-id="72163-117">This can be accomplished by registering the IPv6-capable firewall with the Windows Security Center, adding appropriate rules into the WFP Teredo sublayer, and using built-in APIs in Windows to enumerate applications that might listen to unsolicited traffic over Teredo.</span></span> <span data-ttu-id="72163-118">В ситуациях, когда приложению не требуется прослушивать запрашиваемый трафик через Teredo, брандмауэры не требуют дополнительных правил, добавленных в WFP.</span><span class="sxs-lookup"><span data-stu-id="72163-118">In situations where an application does not need to listen to solicited traffic over Teredo, firewalls do not require additional rules added to the WFP.</span></span> <span data-ttu-id="72163-119">Однако регистрация брандмауэра, поддерживающая IPv6 с помощью центра безопасности Windows, по-прежнему является обязательным требованием сделать адрес Teredo доступным для использования.</span><span class="sxs-lookup"><span data-stu-id="72163-119">However an IPv6 capable firewall registration with Windows Security Center is still a requirement to make the Teredo address to available for use.</span></span>

<span data-ttu-id="72163-120">Для поддержки этого сценария брандмауэр должен поддерживать IPv6 и быть зарегистрированным в центре безопасности Windows.</span><span class="sxs-lookup"><span data-stu-id="72163-120">In order to support this scenario, the firewall must be IPv6-capable and registered with the Windows Security Center.</span></span> <span data-ttu-id="72163-121">Кроме того, брандмауэр не должен изменять состояние запуска или запуска службы центра безопасности Windows (всксвк), так как Teredo зависит от сведений о состоянии, предоставленных через API-интерфейсы WSC.</span><span class="sxs-lookup"><span data-stu-id="72163-121">Additionally, the firewall must not change the running or startup state of the Windows Security Center service (wscsvc), as Teredo is dependent on the state information provided through the WSC APIs.</span></span>

<span data-ttu-id="72163-122">API, используемый для регистрации брандмауэра в WSC, можно получить, обратившись в корпорацию Майкрософт по адресу wscisv@microsoft.com .</span><span class="sxs-lookup"><span data-stu-id="72163-122">The API utilized to register a firewall with the WSC can be obtained by contacting Microsoft at wscisv@microsoft.com.</span></span> <span data-ttu-id="72163-123">Для раскрытия этого API в связи с проблемами безопасности требуется соглашение о неразглашении (НЕРАЗГЛАШЕНИИ).</span><span class="sxs-lookup"><span data-stu-id="72163-123">A Non-Disclosure Agreement (NDA) is required for the disclosure of this API due to security concerns.</span></span>

<span data-ttu-id="72163-124">В следующей документации описаны фильтры и исключения, используемые для обеспечения оптимальной совместимости с Teredo.</span><span class="sxs-lookup"><span data-stu-id="72163-124">The following documentation details the filters and exceptions utilized to ensure optimal compatibility with Teredo:</span></span>

-   [<span data-ttu-id="72163-125">Реализация фильтров брандмауэра для Teredo</span><span class="sxs-lookup"><span data-stu-id="72163-125">Implementing Firewall Filters for Teredo</span></span>](implementing-firewall-filters-for-teredo.md)
-   [<span data-ttu-id="72163-126">Требуемые исключения брандмауэра для Teredo</span><span class="sxs-lookup"><span data-stu-id="72163-126">Required Firewall Exceptions for Teredo</span></span>](required-firewall-exceptions-for-teredo.md)
-   [<span data-ttu-id="72163-127">Требуемые исключения платформы фильтрации Windows для Teredo</span><span class="sxs-lookup"><span data-stu-id="72163-127">Required Windows Filtering Platform Exceptions for Teredo</span></span>](required-windows-filtering-platform-exceptions-for-teredo.md)

## <a name="firewall-requirements-for-other-ipv6-transition-technologies"></a><span data-ttu-id="72163-128">Требования к брандмауэру для других технологий туннелирования IPv6</span><span class="sxs-lookup"><span data-stu-id="72163-128">Firewall Requirements for Other IPv6 Transition Technologies</span></span>

<span data-ttu-id="72163-129">Для поддержки других технологий туннелирования IPv6 (таких как 6to4 и ISATAP) программный брандмауэр узла должен поддерживать обработку трафика IPv6.</span><span class="sxs-lookup"><span data-stu-id="72163-129">In order to support other IPv6 transition technologies (such as 6to4 and ISATAP), the host firewall product must be capable of processing IPv6 traffic.</span></span> <span data-ttu-id="72163-130">IP-протокол 41 указывает, что заголовок IPv6 следует за заголовком IPv4.</span><span class="sxs-lookup"><span data-stu-id="72163-130">The IP Protocol 41 indicates when an IPv6 header follows an IPv4 header.</span></span> <span data-ttu-id="72163-131">Когда брандмауэр узла встречает протокол 41, он должен распознать, что пакет является инкапсулированным в IPv6 пакетом, и, как следствие, должен правильно обрабатывать пакет и принимать решения Accept/DENY на основе правил IPv6 в его политике.</span><span class="sxs-lookup"><span data-stu-id="72163-131">When a host firewall encounters protocol 41, it must recognize that the packet is an IPv6-encapsulated packet and as a result must process the packet appropriately and make the accept/deny decisions based on the IPv6 rules in its policy.</span></span>

 

 