---
title: Адреса Teredo
ms.assetid: e2e185c2-e53d-471d-aedb-54d75f9db0bb
description: 'Дополнительные сведения: адреса Teredo'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc08a53da2f710423d948e9479df2aeb08f20178
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104349645"
---
# <a name="teredo-addresses"></a><span data-ttu-id="34cd3-103">Адреса Teredo</span><span class="sxs-lookup"><span data-stu-id="34cd3-103">Teredo Addresses</span></span>

<span data-ttu-id="34cd3-104">Адрес Teredo состоит из следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="34cd3-104">A Teredo address consists of the following:</span></span>

-   <span data-ttu-id="34cd3-105">**Префикс Teredo**</span><span class="sxs-lookup"><span data-stu-id="34cd3-105">**Teredo prefix**</span></span>

    <span data-ttu-id="34cd3-106">Первые 32 бит предназначены для префикса Teredo, который одинаков для всех адресов Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-106">The first 32 bits are for the Teredo prefix, which is the same for all Teredo addresses.</span></span> <span data-ttu-id="34cd3-107">В Windows XP и Windows Server 2003 изначально использовался префикс Teredo 3FFE: 831F::/32.</span><span class="sxs-lookup"><span data-stu-id="34cd3-107">Windows XP and Windows Server 2003 initially used the 3FFE:831F::/32 Teredo prefix.</span></span> <span data-ttu-id="34cd3-108">Префикс, определенный для Teredo в RFC 4380, — это 2001::/32, а — префикс, используемый Teredo в Windows Vista и Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="34cd3-108">The prefix defined for Teredo in RFC 4380 is 2001::/32 and is the prefix used by Teredo in Windows Vista and Windows Server 2008.</span></span> <span data-ttu-id="34cd3-109">Компьютеры под управлением Windows XP и Windows Server 2003 будут использовать префикс 2001::/32 Teredo при обновлении с бюллетенем по безопасности Microsoft MS06-064.</span><span class="sxs-lookup"><span data-stu-id="34cd3-109">Computers running Windows XP and Windows Server 2003 will use the 2001::/32 Teredo prefix when updated with Microsoft Security Bulletin MS06-064.</span></span>

-   <span data-ttu-id="34cd3-110">**IPv4-адрес сервера Teredo**</span><span class="sxs-lookup"><span data-stu-id="34cd3-110">**Teredo server IPv4 address**</span></span>

    <span data-ttu-id="34cd3-111">Следующие 32 бит содержат общедоступный IPv4-адрес сервера Teredo, который помог настроить этот адрес Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-111">The next 32 bits contain the IPv4 public address of the Teredo server that helped configure this Teredo address.</span></span> <span data-ttu-id="34cd3-112">Дополнительные сведения см. в разделе «Начальная настройка для клиентов Teredo» этой статьи.</span><span class="sxs-lookup"><span data-stu-id="34cd3-112">For more information, see "Initial configuration for Teredo clients" in this article.</span></span>

-   <span data-ttu-id="34cd3-113">**Флаги**</span><span class="sxs-lookup"><span data-stu-id="34cd3-113">**Flags**</span></span>

    <span data-ttu-id="34cd3-114">Следующие 16 битов для зарезервированы для флагов Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-114">The next 16 bits for are reserved for Teredo flags.</span></span> <span data-ttu-id="34cd3-115">Для клиентов Teredo на основе Windows XP единственным определенным флагом является бит высокого порядка, известный как флаг конуса.</span><span class="sxs-lookup"><span data-stu-id="34cd3-115">For Windows XP-based Teredo clients, the only defined flag is the high order bit known as the Cone flag.</span></span> <span data-ttu-id="34cd3-116">Флаг конуса устанавливается, когда клиент Teredo находится за конусным NAT.</span><span class="sxs-lookup"><span data-stu-id="34cd3-116">The Cone flag is set when Teredo client is behind a cone NAT.</span></span> <span data-ttu-id="34cd3-117">Определение того, является ли NAT, подключенный к Интернету, проконусным NAT происходит во время начальной настройки клиента Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-117">The determination of whether the NAT connected to the Internet is a cone NAT occurs during the Teredo client's initial configuration.</span></span> <span data-ttu-id="34cd3-118">Дополнительные сведения см. в разделе «Начальная настройка для клиентов Teredo» этой статьи.</span><span class="sxs-lookup"><span data-stu-id="34cd3-118">For more information, see "Initial configuration for Teredo clients" in this article.</span></span>

    <span data-ttu-id="34cd3-119">Для клиентов Teredo на основе Windows Vista и Windows Server 2008 неиспользуемые биты в поле Flags обеспечивают уровень защиты от просмотра адресов пользователями-злоумышленниками.</span><span class="sxs-lookup"><span data-stu-id="34cd3-119">For Windows Vista and Windows Server 2008-based Teredo clients, unused bits within the Flags field provide a level of protection from address scans by malicious users.</span></span> <span data-ttu-id="34cd3-120">16 бит в поле Flags для клиентов Teredo на основе Windows Vista и Windows Server 2008 состоит из следующих компонентов: КРААААУГ АААААААА.</span><span class="sxs-lookup"><span data-stu-id="34cd3-120">The 16 bits within the Flags field for Windows Vista and Windows Server 2008-based Teredo clients consists of the following: CRAAAAUG AAAAAAAA.</span></span> <span data-ttu-id="34cd3-121">Бит C предназначен для флага конуса.</span><span class="sxs-lookup"><span data-stu-id="34cd3-121">The C bit is for the Cone flag.</span></span> <span data-ttu-id="34cd3-122">Бит R зарезервирован для будущего использования.</span><span class="sxs-lookup"><span data-stu-id="34cd3-122">The R bit is reserved for future use.</span></span> <span data-ttu-id="34cd3-123">Бит U предназначен для флага универсального или локального (значение 0).</span><span class="sxs-lookup"><span data-stu-id="34cd3-123">The U bit is for the Universal/Local flag (set to 0).</span></span> <span data-ttu-id="34cd3-124">Бит G — это флаг отдельных или групп (значение 0).</span><span class="sxs-lookup"><span data-stu-id="34cd3-124">The G bit is Individual/Group flag (set to 0).</span></span> <span data-ttu-id="34cd3-125">Биты задаются в виде 12-битного случайного числа.</span><span class="sxs-lookup"><span data-stu-id="34cd3-125">The A bits are set to a 12-bit randomly generated number.</span></span> <span data-ttu-id="34cd3-126">Используя случайное число для битов, пользователь-злоумышленник, который определил оставшуюся часть адреса Teredo, записывая начальный обмен конфигурацией пакетов между клиентом Teredo и сервером Teredo, должен попробовать до 4 096 (212) различных адресов, чтобы определить адрес клиента Teredo во время сканирования адреса.</span><span class="sxs-lookup"><span data-stu-id="34cd3-126">By using a random number for the A bits, a malicious user that has determined the rest of the Teredo address by capturing the initial configuration exchange of packets between the Teredo client and Teredo server will have to try up to 4,096 (212) different addresses to determine a Teredo client's address during an address scan.</span></span>

-   <span data-ttu-id="34cd3-127">**Незамаскированный внешний порт**</span><span class="sxs-lookup"><span data-stu-id="34cd3-127">**Obscured external port**</span></span>

    <span data-ttu-id="34cd3-128">Следующие 16 бит хранят скрытую версию внешнего порта UDP, соответствующую всем трафикам Teredo для этого клиента Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-128">The next 16 bits store an obscured version of the external UDP port corresponding to all Teredo traffic for this Teredo client.</span></span> <span data-ttu-id="34cd3-129">Когда клиент Teredo отправляет первоначальный пакет серверу Teredo, исходный UDP-порт пакета сопоставляется NAT с другим внешним UDP-портом.</span><span class="sxs-lookup"><span data-stu-id="34cd3-129">When the Teredo client sends its initial packet to a Teredo server, the source UDP port of the packet is mapped by the NAT to a different, external UDP port.</span></span> <span data-ttu-id="34cd3-130">Клиент Teredo поддерживает это сопоставление портов, чтобы оно оставалось в таблице преобразования NAT.</span><span class="sxs-lookup"><span data-stu-id="34cd3-130">The Teredo client maintains this port mapping so that it remains in the NAT's translation table.</span></span> <span data-ttu-id="34cd3-131">Таким образом, весь трафик Teredo для узла использует один и тот же внешний, сопоставленный UDP-порт.</span><span class="sxs-lookup"><span data-stu-id="34cd3-131">Therefore, all Teredo traffic for the host uses the same external, mapped UDP port.</span></span> <span data-ttu-id="34cd3-132">Внешний UDP-порт определяется сервером Teredo с исходного UDP-порта входящего первого пакета, отправленного клиентом Teredo, и отправляется обратно клиенту Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-132">The external UDP port is determined by the Teredo server from the source UDP port of the incoming initial packet sent by the Teredo client and sent back to the Teredo client.</span></span>

    <span data-ttu-id="34cd3-133">Внешний порт скрыт, Ксоринг внешний порт с 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="34cd3-133">The external port is obscured by XORing the external port with 0xFFFF.</span></span> <span data-ttu-id="34cd3-134">Например, скрытая версия внешнего порта 5000 в шестнадцатеричном формате — EC77 (5000 = 0x1388, 0x1388 XOR 0xFFFF = 0xEC77).</span><span class="sxs-lookup"><span data-stu-id="34cd3-134">For example, the obscured version of the external port 5000 in hexadecimal format is EC77 (5000 = 0x1388, 0x1388 XOR 0xFFFF = 0xEC77).</span></span> <span data-ttu-id="34cd3-135">Маскировка внешнего порта не домешает NAT перевести внешний порт в полезные данные пересылаемых пакетов.</span><span class="sxs-lookup"><span data-stu-id="34cd3-135">Obscuring the external port prevents NATs from translating the external port within the payload of the packets that they are forwarding.</span></span>

-   <span data-ttu-id="34cd3-136">**Непонятный внешний адрес**</span><span class="sxs-lookup"><span data-stu-id="34cd3-136">**Obscured external address**</span></span>

    <span data-ttu-id="34cd3-137">Последние 32 бит хранят скрытую версию внешнего IPv4-адреса, соответствующего всем трафикам Teredo для этого клиента Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-137">The last 32 bits store an obscured version of the external IPv4 address corresponding to all Teredo traffic for this Teredo client.</span></span> <span data-ttu-id="34cd3-138">Как и внешний порт, когда клиент Teredo отправляет первоначальный пакет серверу Teredo, исходный IP-адрес пакета сопоставляется NAT с другим внешним (общедоступным) адресом.</span><span class="sxs-lookup"><span data-stu-id="34cd3-138">Just like the external port, when the Teredo client sends its initial packet to a Teredo server, the source IP address of the packet is mapped by the NAT to a different, external (public) address.</span></span> <span data-ttu-id="34cd3-139">Клиент Teredo поддерживает это сопоставление адресов, чтобы оно оставалось в таблице преобразования NAT.</span><span class="sxs-lookup"><span data-stu-id="34cd3-139">The Teredo client maintains this address mapping so that it remains in the NAT's translation table.</span></span> <span data-ttu-id="34cd3-140">Таким образом, весь трафик Teredo для узла использует один внешний, сопоставленный общедоступный IPv4-адрес.</span><span class="sxs-lookup"><span data-stu-id="34cd3-140">Therefore, all Teredo traffic for the host uses the same external, mapped, public IPv4 address.</span></span> <span data-ttu-id="34cd3-141">Внешний IPv4-адрес определяется сервером Teredo с исходного IPv4-адреса входящего исходного пакета, отправленного клиентом Teredo, и отправляется обратно клиенту Teredo.</span><span class="sxs-lookup"><span data-stu-id="34cd3-141">The external IPv4 address is determined by the Teredo server from the source IPv4 address of the incoming initial packet sent by the Teredo client and sent back to the Teredo client.</span></span>

    <span data-ttu-id="34cd3-142">Внешний адрес скрыт, Ксоринг внешний адрес с 0xFFFFFFFF.</span><span class="sxs-lookup"><span data-stu-id="34cd3-142">The external address is obscured by XORing the external address with 0xFFFFFFFF.</span></span> <span data-ttu-id="34cd3-143">Например, скрытая версия общедоступного IPv4-адреса 131.107.0.1 в шестнадцатеричном формате — 7C94: ФФФЕ (131.107.0.1 = 0x836B0001, 0x836B0001 XOR 0xFFFFFFFF = 0x7C94FFFE).</span><span class="sxs-lookup"><span data-stu-id="34cd3-143">For example, the obscured version of the public IPv4 address 131.107.0.1 in colon-hexadecimal format is 7C94:FFFE (131.107.0.1 = 0x836B0001, 0x836B0001 XOR 0xFFFFFFFF = 0x7C94FFFE).</span></span> <span data-ttu-id="34cd3-144">Маскировка внешнего адреса не домешает NAT перевести внешний адрес в полезную нагрузку пересылаемых пакетов.</span><span class="sxs-lookup"><span data-stu-id="34cd3-144">Obscuring the external address prevents NATs from translating the external address within the payload of the packets that they are forwarding.</span></span>

 

 




