---
title: Свойства расширения IIS BITS
description: Фоновая интеллектуальная служба передачи (BITS) использует ISAPI для расширения служб IIS для поддержки заданий отправки.
ms.assetid: 08a40cc1-ec6d-4b65-971a-15c7b06df148
keywords:
- БИТЫ свойств расширения IIS BITS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c09412f6aa0be1ab76e6e45ea0920e1caf1054d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104533356"
---
# <a name="bits-iis-extension-properties"></a><span data-ttu-id="4f659-104">Свойства расширения IIS BITS</span><span class="sxs-lookup"><span data-stu-id="4f659-104">BITS IIS Extension Properties</span></span>

<span data-ttu-id="4f659-105">Фоновая интеллектуальная служба передачи (BITS) использует ISAPI для расширения служб IIS для поддержки [**заданий отправки**](/windows/win32/api/bits/ne-bits-bg_job_type).</span><span class="sxs-lookup"><span data-stu-id="4f659-105">Background Intelligent Transfer Service (BITS) uses an ISAPI to extend IIS to support [**upload jobs**](/windows/win32/api/bits/ne-bits-bg_job_type).</span></span> <span data-ttu-id="4f659-106">В следующей таблице перечислены свойства, которые служба BITS добавляет в метабазу IIS для компонента виртуального каталога.</span><span class="sxs-lookup"><span data-stu-id="4f659-106">The following table lists the properties that BITS adds to the IIS metabase for the virtual directory component.</span></span> <span data-ttu-id="4f659-107">Службы BITS используют эти свойства для определения способа передачи файлов.</span><span class="sxs-lookup"><span data-stu-id="4f659-107">BITS uses these properties to determine how to upload the files.</span></span> <span data-ttu-id="4f659-108">Свойства расширения IIS BITS наследуются, за исключением **битсуплоаденаблед**.</span><span class="sxs-lookup"><span data-stu-id="4f659-108">The BITS IIS extension properties are inheritable, except for **BITSUploadEnabled**.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="4f659-109">Свойство</span><span class="sxs-lookup"><span data-stu-id="4f659-109">Property</span></span></th>
<th><span data-ttu-id="4f659-110">Описание</span><span class="sxs-lookup"><span data-stu-id="4f659-110">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="4f659-111"><strong>Битсуплоаденаблед</strong> Тип данных: <strong>логический</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-111"><strong>BITSUploadEnabled</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-112">Указывает, включены ли передачи BITS в виртуальном каталоге.</span><span class="sxs-lookup"><span data-stu-id="4f659-112">Indicates whether BITS uploads are enabled on the virtual directory.</span></span> <span data-ttu-id="4f659-113">Если параметр отсутствует или равен 0, отправки BITS отключаются.</span><span class="sxs-lookup"><span data-stu-id="4f659-113">If the setting is not present or is 0, BITS uploads are disabled.</span></span><br/> <span data-ttu-id="4f659-114">Это свойство доступно только для чтения.</span><span class="sxs-lookup"><span data-stu-id="4f659-114">This is a read-only property.</span></span> <span data-ttu-id="4f659-115">Чтобы задать это свойство, вызовите метод <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>енаблебитсуплоадс</strong></a> или <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>дисаблебитсуплоадс</strong></a> интерфейса <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>ибитсекстенсионсетуп</strong></a> .</span><span class="sxs-lookup"><span data-stu-id="4f659-115">To set this property, call the <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> or <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> method of the <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> interface.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4f659-116"><strong>Битссессионтимеаут</strong> Тип данных: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-116"><strong>BITSSessionTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-117">Количество секунд, в течение которых соединение сохраняется, если не выполняется отправка файла. во время выполнения таймер сбрасывается.</span><span class="sxs-lookup"><span data-stu-id="4f659-117">Number of seconds the connection is maintained if no progress is made uploading the file; the timer is reset when progress is made.</span></span> <span data-ttu-id="4f659-118">Служба BITS закрывает подключение, если истекло время ожидания и выполняется очистка данных, связанных с сеансом.</span><span class="sxs-lookup"><span data-stu-id="4f659-118">BITS closes the connection if the time-out is reached and cleans up data associated with the session.</span></span><br/> <span data-ttu-id="4f659-119">Установка короткого времени ожидания сеанса может быть проблемой для заданий отправки и ответа, так как ответ загружается только после того, как пользователь вошел в систему и подключен к сети.</span><span class="sxs-lookup"><span data-stu-id="4f659-119">Setting a short session time-out can be an issue for upload-reply jobs because the reply is only downloaded when the user is logged on and connected to the network.</span></span> <span data-ttu-id="4f659-120">Время ожидания сеанса может истекает до скачивания ответа. в этом случае сеанс отменяется и файл ответов удаляется.</span><span class="sxs-lookup"><span data-stu-id="4f659-120">It is possible for the session to time out before the reply is downloaded, in which case the session is canceled and the reply file is deleted.</span></span><br/> <span data-ttu-id="4f659-121">Обратите внимание, что служба BITS отменяет задание при достижении значения <a href="/windows/win32/bits/group-policies">жобинактивититимеаут</a> групповая политика (по умолчанию 90 дней), независимо от этого параметра.</span><span class="sxs-lookup"><span data-stu-id="4f659-121">Note that BITS cancels the job if the <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> Group Policy value (default is 90 days) is reached, regardless of this setting.</span></span><br/> <span data-ttu-id="4f659-122">Значение по умолчанию — 1 209 600 (14 дней).</span><span class="sxs-lookup"><span data-stu-id="4f659-122">Default value is 1,209,600 (14 days).</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4f659-123"><strong>Битсмаксимумуплоадсизе</strong> Тип данных: <strong>строка</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-123"><strong>BITSMaximumUploadSize</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-124">Максимальное число байтов, которое можно передать на задание.</span><span class="sxs-lookup"><span data-stu-id="4f659-124">Maximum number of bytes that can be uploaded per job.</span></span> <span data-ttu-id="4f659-125">Укажите максимальное число байтов в виде десятичной строки. Строковое значение должно быть меньше или равно &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="4f659-125">Specify the maximum number of bytes as a decimal string; the string value must be less than or equal to &quot;1844674407370955&quot;.</span></span> <span data-ttu-id="4f659-126">Пустая строка совпадает с указанием &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="4f659-126">An empty string is the same as specifying &quot;1844674407370955&quot;.</span></span><br/> <span data-ttu-id="4f659-127">Значение по умолчанию — пустая строка.</span><span class="sxs-lookup"><span data-stu-id="4f659-127">Default value is an empty string.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="4f659-128">В IIS 7 предел передачи по умолчанию составляет 30 000 000 байт.</span><span class="sxs-lookup"><span data-stu-id="4f659-128">In IIS 7, the default upload limit is 30 million bytes.</span></span> <span data-ttu-id="4f659-129">Значение свойства <strong>битсмаксимумуплоадсизе</strong> не может превышать ограничение IIS.</span><span class="sxs-lookup"><span data-stu-id="4f659-129">The value of the <strong>BITSMaximumUploadSize</strong> property cannot exceed the IIS limit.</span></span> <span data-ttu-id="4f659-130">Дополнительные сведения и сведения об изменении параметров IIS по умолчанию см. в разделе <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span><span class="sxs-lookup"><span data-stu-id="4f659-130">For details and information on changing the IIS default, see <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4f659-131"><strong>Битссервернотификатионтипе</strong> Тип данных: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-131"><strong>BITSServerNotificationType</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-132">Указывает способ отправки файла отправки в серверное приложение.</span><span class="sxs-lookup"><span data-stu-id="4f659-132">Specifies how to send the upload file to the server application.</span></span> <span data-ttu-id="4f659-133">Возможные значения: 0, 1 и 2.</span><span class="sxs-lookup"><span data-stu-id="4f659-133">The possible values are: 0, 1, and 2.</span></span><br/> <span data-ttu-id="4f659-134">Значение 0 означает, что файл не отправляется в серверное приложение.</span><span class="sxs-lookup"><span data-stu-id="4f659-134">A value of 0 means the file is not sent to the server application.</span></span> <span data-ttu-id="4f659-135">BITS помещает файл отправки в каталог, указанный в удаленном имени (удаленное имя, указанное при <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">добавлении файла</a> в задание), не уведомляя серверное приложение.</span><span class="sxs-lookup"><span data-stu-id="4f659-135">BITS puts the upload file in the directory specified in the remote name (the remote name specified when you <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">added the file</a> to the job) without notifying the server application.</span></span> <span data-ttu-id="4f659-136">Если файл в данный момент существует в целевом каталоге, он заменяется файлом отправки.</span><span class="sxs-lookup"><span data-stu-id="4f659-136">If the file currently exists in the destination directory, it is replaced with the upload file.</span></span><br/> <span data-ttu-id="4f659-137">Значение 1 означает, что BITS передает расположение файла отправки в серверное приложение, указанное в свойстве <strong>битссервернотификатионурл</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-137">A value of 1 means BITS passes the location of the upload file to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="4f659-138">Серверное приложение обрабатывает файл и создает ответный файл при необходимости.</span><span class="sxs-lookup"><span data-stu-id="4f659-138">The server application processes the file and generates a reply file, if needed.</span></span> <span data-ttu-id="4f659-139">По умолчанию служба BITS удаляет файлы отправки и ответа с сервера после получения ответа от серверного приложения.</span><span class="sxs-lookup"><span data-stu-id="4f659-139">By default, BITS removes the upload and reply files from the server after it receives the response from the server application.</span></span> <span data-ttu-id="4f659-140">Чтобы служба BITS скопировала файл отправки в расположение, указанное именем удаленного файла в задании, включите в ответ заголовок <a href="/windows/win32/bits/notification-protocol-for-server-applications">BITS-Copy-File-to-Destination</a> .</span><span class="sxs-lookup"><span data-stu-id="4f659-140">To have BITS copy the upload file to the location specified by the remote file name in the job, include the <a href="/windows/win32/bits/notification-protocol-for-server-applications">BITS-Copy-File-To-Destination</a> header in your response.</span></span> <span data-ttu-id="4f659-141">Если вы не включаете заголовок и хотите сохранить файлы для отправки и ответа, необходимо скопировать файлы отправки и ответа в новое расположение перед ответом.</span><span class="sxs-lookup"><span data-stu-id="4f659-141">If you do not include the header and you want to save the upload and reply files, you must copy the upload and reply files to a new location before responding.</span></span><br/> <span data-ttu-id="4f659-142">Значение 2 означает, что BITS передает файл отправки в тексте запроса в серверное приложение, указанное в свойстве <strong>битссервернотификатионурл</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-142">A value of 2 means BITS passes the upload file in the body of the request to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="4f659-143">Серверное приложение обрабатывает файл и передает обратно ответ в тексте ответа, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="4f659-143">The server application processes the file and passes back the reply in the body of the response, if needed.</span></span><br/> <span data-ttu-id="4f659-144">Дополнительные сведения о заголовках запросов и ответов см. в разделе <a href="/windows/win32/bits/notification-protocol-for-server-applications">протокол уведомлений для серверных приложений</a>.</span><span class="sxs-lookup"><span data-stu-id="4f659-144">For details on the request and response headers, see <a href="/windows/win32/bits/notification-protocol-for-server-applications">Notification Protocol for Server Applications</a>.</span></span><br/> <span data-ttu-id="4f659-145">Серверное приложение должно предоставить ответ в течение пяти минут.</span><span class="sxs-lookup"><span data-stu-id="4f659-145">The server application must provide a response within five minutes.</span></span> <span data-ttu-id="4f659-146">Если серверное приложение не отвечает в течение пяти минут, оно переходит в состояние временной ошибки.</span><span class="sxs-lookup"><span data-stu-id="4f659-146">If the server application does not reply within five minutes, the job enters the transient error state.</span></span> <span data-ttu-id="4f659-147">По истечении <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>задержки повторных попыток</strong></a> сервер BITS будет отправлять в серверное приложение еще одно уведомление (серверное приложение должно быть написано для обслуживания повторяющихся уведомлений). <strong>BITS 1,5:</strong> Время ожидания уведомления составляет 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="4f659-147">When the <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>retry delay</strong></a> expires, the BITS server will send another notification to the server application (the server application should be written to handle duplicate notifications).<strong>BITS 1.5:</strong> The notification time-out is 30 seconds.</span></span><br/> <br/> <span data-ttu-id="4f659-148">По умолчанию установлено значение 0.</span><span class="sxs-lookup"><span data-stu-id="4f659-148">Default value is 0.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4f659-149"><strong>Битссервернотификатионурл</strong> Тип данных: <strong>строка</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-149"><strong>BITSServerNotificationURL</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-150">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="4f659-150">Optional.</span></span> <span data-ttu-id="4f659-151">Содержит URL-адрес серверного приложения, в котором BITS отправляет файл отправки.</span><span class="sxs-lookup"><span data-stu-id="4f659-151">Contains the URL of the server application to which BITS posts the upload file.</span></span> <span data-ttu-id="4f659-152">Если свойство <strong>битссервернотификатионтипе</strong> имеет значение 1 или 2, необходимо указать URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="4f659-152">You must specify a URL if the value of the <strong>BITSServerNotificationType</strong> property is 1 or 2.</span></span> <span data-ttu-id="4f659-153">Длина URL-адреса ограничена 2 200 символами, не включая знак завершения null.</span><span class="sxs-lookup"><span data-stu-id="4f659-153">The URL is limited to 2,200 characters, not including the null terminator.</span></span> <span data-ttu-id="4f659-154">URL-адрес должен быть URL-адресом HTTP. Служба BITS не поддерживает URL-адреса уведомлений HTTPS.</span><span class="sxs-lookup"><span data-stu-id="4f659-154">The URL must be an HTTP URL; BITS does not support HTTPS notification URLs.</span></span><br/> <span data-ttu-id="4f659-155">Если URL-адрес недоступен во время отправки, служба BITS повторит попытку отправки, пока не будет существует URL-адрес уведомления или пока не истечет период повтора.</span><span class="sxs-lookup"><span data-stu-id="4f659-155">If the URL is not available at the time of upload, BITS will retry the upload until the notification URL exists or until the retry period expires.</span></span><br/> <span data-ttu-id="4f659-156">Обратите внимание, что если удаленное имя, указанное в задании, содержит строку запроса, строка запроса добавляется к указанному URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="4f659-156">Note that if the remote name specified in the job contains a query string, the query string is appended to the URL that you specify.</span></span> <span data-ttu-id="4f659-157">Например, если удаленное имя содержит, https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 а параметр <strong>битссервернотификатионурл</strong> задан как https://otherserver/myvdir2/bag.asp , то URL-адрес, на который отсылается BITS https://otherserver/myvdir2/bag.asp?ACCOUNT=86433 .</span><span class="sxs-lookup"><span data-stu-id="4f659-157">For example, if the remote name contains https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 and you specify the <strong>BITSServerNotificationURL</strong> setting as https://otherserver/myvdir2/bag.asp, the URL to which BITS posts is https://otherserver/myvdir2/bag.asp?ACCOUNT=86433.</span></span><br/> <span data-ttu-id="4f659-158">Если исходный URL-адрес имеет значение, https://myserver/myvdir/file.txt а URL-адрес уведомления — мясп. ASP, BITS использует HTTP//MyServer/мивдир/мясп. ASP в качестве URL-адреса уведомления.</span><span class="sxs-lookup"><span data-stu-id="4f659-158">If the original URL is https://myserver/myvdir/file.txt and the notification URL is myasp.asp, BITS uses http//myserver/myvdir/myasp.asp as the notification URL.</span></span><br/> <span data-ttu-id="4f659-159">Если путь и имя файла в URL-адресе содержат символы Юникода, не являющиеся общими для кодовой страницы как клиента, так и сервера, преобразование URL-адресов на сервере завершится ошибкой, а задание BITS будет помещено в состояние ошибки.</span><span class="sxs-lookup"><span data-stu-id="4f659-159">If the path and file name portion of the URL contains Unicode characters not in common to the code page on both the client and server, the URL translation will fail on the server and the BITS job will be placed in the error state.</span></span> <span data-ttu-id="4f659-160">Если серверная часть URL-адреса содержит символы Юникода, необходимо закодировать серверную часть с использованием <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">международных доменных имен</a> (IDN).</span><span class="sxs-lookup"><span data-stu-id="4f659-160">If the server portion of the URL contains Unicode characters, you must encode the server portion using <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">Internationalized Domain Names</a> (IDN).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4f659-161"><strong>Битшостид</strong> Тип данных: <strong>строка</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-161"><strong>BITSHostId</strong>Data Type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-162">Задайте это свойство, если установка сервера является веб-фермой, которая не использует общее хранилище.</span><span class="sxs-lookup"><span data-stu-id="4f659-162">Set this property if the server installation is a web farm that does not use shared storage.</span></span><br/> <span data-ttu-id="4f659-163">Укажите имя сервера или IP-адрес сервера для повторного подключения после прерывания процесса отправки.</span><span class="sxs-lookup"><span data-stu-id="4f659-163">Specify the server name or IP address of the server to reconnect to after the upload process is interrupted.</span></span> <span data-ttu-id="4f659-164">Как правило, указывается имя настраиваемого сервера.</span><span class="sxs-lookup"><span data-stu-id="4f659-164">Typically, you specify the name of the server you are configuring.</span></span> <span data-ttu-id="4f659-165">Длина URL-адреса ограничена 300 символами, не включая знак завершения null.</span><span class="sxs-lookup"><span data-stu-id="4f659-165">The URL is limited to 300 characters, not including the null terminator.</span></span><br/> <span data-ttu-id="4f659-166">Если это свойство не указано и процесс отправки прерван, то возможно, что служба BITS возобновит задание на другом сервере фермы.</span><span class="sxs-lookup"><span data-stu-id="4f659-166">If you do not specify this property and the upload process is interrupted, it is possible that BITS will resume the job on another server in the farm.</span></span> <span data-ttu-id="4f659-167">Однако предыдущий сервер по-прежнему содержит частичный файл отправки перед прерыванием.</span><span class="sxs-lookup"><span data-stu-id="4f659-167">However, the previous server still contains the partial upload file from before the interruption.</span></span> <span data-ttu-id="4f659-168">Служба BITS удаляет частичный файл после истечения срока действия <strong>битссессионтимеаут</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-168">BITS removes the partial file after the <strong>BITSSessionTimeout</strong> expires.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="4f659-169">Не используйте свойство <strong>битшостид</strong> , если в веб-ферме используется протокол SSL, использующий балансировку сетевой нагрузки (NLB) или DNS-имена с несколькими IP-адресами, если не указать имя кластера и отдельные имена серверов в сертификате.</span><span class="sxs-lookup"><span data-stu-id="4f659-169">Do not use the <strong>BITSHostId</strong> property if SSL is used in a web farm that uses Network Load Balancing (NLB) or DNS names with multiple IP addresses, unless you include the cluster name and individual server names in the certificate.</span></span> <span data-ttu-id="4f659-170">(Если имя сервера, указанное в <strong>битшостид</strong> , не соответствует общему имени в сертификате, задание завершится ошибкой.) Вместо этого для балансировки сетевой нагрузки задайте для параметра <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">affinity</a> значение <strong>Single</strong> , чтобы обеспечить взаимодействие клиента с тем же сервером в будущем.</span><span class="sxs-lookup"><span data-stu-id="4f659-170">(If the server name specified in <strong>BITSHostId</strong> does not match the common name on the certificate, the job will fail.) Instead, for NLB, set the <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> parameter to <strong>Single</strong> to ensure that the client communicates with the same server in the future.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4f659-171"><strong>Битшостидфаллбакктимеаут</strong> Тип данных: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-171"><strong>BITSHostIdFallbackTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-172">Количество секунд, в течение которых клиент BITS пытается повторно подключиться к серверу <strong>битшостид</strong> , прежде чем вернуться к имени узла, указанному в имени удаленного файла задания.</span><span class="sxs-lookup"><span data-stu-id="4f659-172">Number of seconds the BITS client tries to reconnect to the <strong>BITSHostId</strong> server name before reverting to the host name specified in the remote file name of the job.</span></span> <span data-ttu-id="4f659-173">Таймер запускается, когда службе BITS не удается подключиться к серверу <strong>битшостид</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-173">The timer begins when BITS is unable to connect to the <strong>BITSHostId</strong> server.</span></span> <span data-ttu-id="4f659-174">Таймер сбрасывается, когда клиент успешно подключается к серверу.</span><span class="sxs-lookup"><span data-stu-id="4f659-174">The timer is reset when the client successfully connects to the server.</span></span><br/> <span data-ttu-id="4f659-175">Обратите внимание, что время ожидания выполнения задания (см. <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>использованием метода ibackgroundcopyjob:: сетнопрогресстимеаут</strong></a>) должно быть больше этого значения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="4f659-175">Note that the no progress timeout value of the job (see <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>IBackgroundCopyJob::SetNoProgressTimeout</strong></a>) should be longer than this timeout value.</span></span> <span data-ttu-id="4f659-176">В противном случае задание завершится ошибкой до истечения времени ожидания резервного значения.</span><span class="sxs-lookup"><span data-stu-id="4f659-176">If not, the job will fail before fallback timeout value expires.</span></span><br/> <span data-ttu-id="4f659-177">Устанавливайте это свойство только в том случае, если задано свойство <strong>битшостид</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-177">Set this property only if you set the <strong>BITSHostId</strong> property.</span></span><br/> <span data-ttu-id="4f659-178">Значение по умолчанию — 86 400 (1 день).</span><span class="sxs-lookup"><span data-stu-id="4f659-178">Default value is 86,400 (1 day).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4f659-179"><strong>Битсаллововервритес</strong> Тип данных: <strong>целое число</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-179"><strong>BITSAllowOverwrites</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-180">Указывает, может ли файл отправки перезаписать существующий файл с тем же именем.</span><span class="sxs-lookup"><span data-stu-id="4f659-180">Indicates whether an upload file can overwrite an existing file with the same name.</span></span> <span data-ttu-id="4f659-181">Файл отправки перезаписывает существующий файл, если <strong>битсаллововервритес</strong> имеет значение 1.</span><span class="sxs-lookup"><span data-stu-id="4f659-181">The upload file overwrites the existing file if <strong>BITSAllowOverwrites</strong> is 1.</span></span><br/> <span data-ttu-id="4f659-182">По умолчанию установлено значение 0.</span><span class="sxs-lookup"><span data-stu-id="4f659-182">Default value is 0.</span></span><br/> <span data-ttu-id="4f659-183"><strong>IIS 6,0:</strong> Это свойство можно задать только из скрипта. его нельзя задать с помощью страницы свойств расширения BITS в пользовательском интерфейсе IIS.</span><span class="sxs-lookup"><span data-stu-id="4f659-183"><strong>IIS 6.0:</strong> You can set this property only from a script, you cannot set it using the BITS extension properties page in the IIS user interface.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4f659-184"><strong>Битсклеанупуседефаулт</strong> Тип данных: <strong>логический</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-184"><strong>BITSCleanupUseDefault</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-185">Указывает, использует ли задача очистки расписания по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4f659-185">Indicates whether the cleanup task uses the default schedules.</span></span> <span data-ttu-id="4f659-186">По умолчанию задача очистки выполняется каждые 12 часов.</span><span class="sxs-lookup"><span data-stu-id="4f659-186">By default, the cleanup task is run every 12 hours.</span></span><br/> <span data-ttu-id="4f659-187">Задайте значение 1, чтобы использовать расписание по умолчанию. в противном случае — значение 0, чтобы указать расписание.</span><span class="sxs-lookup"><span data-stu-id="4f659-187">Set to 1 to use the default schedule; otherwise, 0 to specify a schedule.</span></span><br/> <span data-ttu-id="4f659-188">Чтобы задать расписание, используйте свойства <strong>битсклеанупкаунт</strong> и <strong>битсклеанупунитс</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-188">To specify a schedule, use the <strong>BITSCleanupCount</strong> and <strong>BITSCleanupUnits</strong> properties.</span></span><br/> <span data-ttu-id="4f659-189">Задача очистки очищает виртуальный каталог путем удаления заданий, которые не были изменены в течение времени ожидания сеанса (см. <strong>битссессионтимеаут</strong>).</span><span class="sxs-lookup"><span data-stu-id="4f659-189">The cleanup task cleans up the virtual directory by deleting jobs that have not been modified within the session time-out period (see <strong>BITSSessionTimeout</strong>).</span></span><br/> <span data-ttu-id="4f659-190">Значение по умолчанию — 1 — использовать расписание по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4f659-190">The default is 1 use the default schedule.</span></span><br/> <span data-ttu-id="4f659-191"><strong>IIS 6,0:</strong> Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="4f659-191"><strong>IIS 6.0:</strong> Not supported.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4f659-192"><strong>Битсклеанупкаунт</strong> Тип данных: <strong>целое число</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-192"><strong>BITSCleanupCount</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-193">Указывает интервал ожидания между запуском задачи очистки.</span><span class="sxs-lookup"><span data-stu-id="4f659-193">Specifies the interval to wait between running the cleanup task.</span></span> <span data-ttu-id="4f659-194">Интервал, который можно указать, зависит от единиц.</span><span class="sxs-lookup"><span data-stu-id="4f659-194">The interval that you can specify depends on the units.</span></span> <span data-ttu-id="4f659-195">Возможные значения интервала см. в описании свойства <strong>битсклеанупунитс</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-195">For possible interval values, see the <strong>BITSCleanupUnits</strong> property.</span></span><br/> <span data-ttu-id="4f659-196">Это свойство игнорируется, если <strong>битсклеанупуседефаулт</strong> имеет значение 0.</span><span class="sxs-lookup"><span data-stu-id="4f659-196">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="4f659-197"><strong>IIS 6,0:</strong> Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="4f659-197"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4f659-198"><strong>Битсклеанупунитс</strong> Тип данных: <strong>целое число</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-198"><strong>BITSCleanupUnits</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-199">Указывает единицы для интервала очистки, указанного в свойстве <strong>битсклеанупкаунт</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-199">Specifies the units for the cleanup interval specified in the <strong>BITSCleanupCount</strong> property.</span></span> <span data-ttu-id="4f659-200">Это свойство игнорируется, если <strong>битсклеанупуседефаулт</strong> имеет значение 0.</span><span class="sxs-lookup"><span data-stu-id="4f659-200">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="4f659-201">Допустимые значения:</span><span class="sxs-lookup"><span data-stu-id="4f659-201">The possible values are:</span></span><dl> <span data-ttu-id="4f659-202">0 — единицы измерения — минуты.</span><span class="sxs-lookup"><span data-stu-id="4f659-202">0: The units are minutes.</span></span> <span data-ttu-id="4f659-203">Возможные значения: от 1 до 60.</span><span class="sxs-lookup"><span data-stu-id="4f659-203">Possible values are 1 to 60.</span></span><br />
<span data-ttu-id="4f659-204">1: единицы измерения — часы.</span><span class="sxs-lookup"><span data-stu-id="4f659-204">1: The units are hours.</span></span> <span data-ttu-id="4f659-205">Это значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4f659-205">This is the default.</span></span> <span data-ttu-id="4f659-206">Возможные значения: от 1 до 24.</span><span class="sxs-lookup"><span data-stu-id="4f659-206">Possible values are 1 to 24.</span></span><br />
<span data-ttu-id="4f659-207">2: единицы измерения — дни.</span><span class="sxs-lookup"><span data-stu-id="4f659-207">2: The units are days.</span></span> <span data-ttu-id="4f659-208">Возможные значения: от 1 до 360.</span><span class="sxs-lookup"><span data-stu-id="4f659-208">Possible values are 1 to 360.</span></span><br />
</dl> <br/> <span data-ttu-id="4f659-209"><strong>IIS 6,0:</strong> Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="4f659-209"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4f659-210"><strong>Битснумберофсессионслимит</strong> Тип данных: <strong>целое число</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-210"><strong>BITSNumberOfSessionsLimit</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-211">Ограничивает количество сеансов передачи, которые могут существовать одновременно для пользователя.</span><span class="sxs-lookup"><span data-stu-id="4f659-211">Limits the number of upload sessions that can exist concurrently for a user.</span></span> <span data-ttu-id="4f659-212">Если число сеансов для пользователя превышает это ограничение, при выполнении задачи очистки будут удалены последние сеансы, пока число сеансов для пользователя не превысит предельное значение.</span><span class="sxs-lookup"><span data-stu-id="4f659-212">If the number of sessions for a user is more than this limit, when the cleanup task runs it will delete the most recent sessions until the number of sessions for the user is below the limit.</span></span><br/> <span data-ttu-id="4f659-213">Значение по умолчанию — 50 сеансов.</span><span class="sxs-lookup"><span data-stu-id="4f659-213">The default is 50 sessions.</span></span><br/> <span data-ttu-id="4f659-214"><strong>IIS 6,0:</strong> Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="4f659-214"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4f659-215"><strong>Битссессионлимитенабле</strong> Тип данных: <strong>логический</strong></span><span class="sxs-lookup"><span data-stu-id="4f659-215"><strong>BITSSessionLimitEnable</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="4f659-216">Указывает, ограничивает ли BITS количество сеансов передачи на пользователя.</span><span class="sxs-lookup"><span data-stu-id="4f659-216">Indicates whether BITS limits the number of upload sessions per user.</span></span> <span data-ttu-id="4f659-217">Если параметр отсутствует или равен 0, это ограничение отключено.</span><span class="sxs-lookup"><span data-stu-id="4f659-217">If the setting is not present or is 0, the limit is disabled.</span></span><br/> <span data-ttu-id="4f659-218">Чтобы задать ограничение, задайте свойство <strong>битснумберофсессионслимит</strong> .</span><span class="sxs-lookup"><span data-stu-id="4f659-218">To specify the limit, set the <strong>BITSNumberOfSessionsLimit</strong> property.</span></span><br/> <span data-ttu-id="4f659-219">Значение по умолчанию — 1.</span><span class="sxs-lookup"><span data-stu-id="4f659-219">The default is 1.</span></span><br/> <span data-ttu-id="4f659-220"><strong>IIS 6,0:</strong> Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="4f659-220"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="4f659-221">В следующем примере показано, как задать свойства расширения IIS BITS с помощью сервера сценариев Windows.</span><span class="sxs-lookup"><span data-stu-id="4f659-221">The following example shows how to set the BITS IIS extension properties using Windows Script Host.</span></span> <span data-ttu-id="4f659-222">Если виртуальный каталог указывает на удаленный общий ресурс, также задайте свойства IIS **ункусернаме** и **ункпассворд** .</span><span class="sxs-lookup"><span data-stu-id="4f659-222">If the virtual directory points to a remote share, also set the **UNCUserName** and **UNCPassword** IIS properties.</span></span>


```JScript
if (WScript.Arguments.length < 2)
{
    WScript.Echo("Usage: bitsvdir virtual_directory local_directory");
    WScript.Quit(1);
}

VirtualDirectoryName = WScript.Arguments(0);
LocalDirectoryName = WScript.Arguments(1);

ServerObj = GetObject("IIS://LocalHost/W3SVC/1/ROOT");
VirtualDir = ServerObj.Create("IIsWebVirtualDir", VirtualDirectoryName );

VirtualDir.Path = LocalDirectoryName;
VirtualDir.AppIsolated = 0;
VirtualDir.AccessScript = true;
VirtualDir.AccessRead = false;
VirtualDir.AccessWrite = false;
VirtualDir.SetInfo();

// Set BITS specific IIS configuration settings
VirtualDir.EnableBITSUploads();
VirtualDir.BITSMaximumUploadSize = "4294967296";
VirtualDir.SetInfo();

WScript.Echo( "Created virtual directory " + VirtualDirectoryName + 
              " with a local directory of " + LocalDirectoryName );
WScript.Quit( 0 );
```



 

