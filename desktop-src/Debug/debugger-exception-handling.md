---
description: Обработка исключений в пользовательском режиме в системе обеспечивает поддержку сложных отладчиков.
ms.assetid: c45a7dc6-e6b2-4fc4-9522-12d96893f4c7
title: Обработка исключений отладчика
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a6aff6d566e8798aaf4f3113ce6d8f44a3bc71ba
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104495810"
---
# <a name="debugger-exception-handling"></a><span data-ttu-id="abb41-103">Обработка исключений отладчика</span><span class="sxs-lookup"><span data-stu-id="abb41-103">Debugger Exception Handling</span></span>

<span data-ttu-id="abb41-104">Обработка исключений в пользовательском режиме в системе обеспечивает поддержку сложных отладчиков.</span><span class="sxs-lookup"><span data-stu-id="abb41-104">The system's handling of user-mode exceptions provides support for sophisticated debuggers.</span></span> <span data-ttu-id="abb41-105">Если выполняется отладка процесса, в котором возникает исключение, система создает событие отладки.</span><span class="sxs-lookup"><span data-stu-id="abb41-105">If the process in which an exception occurs is being debugged, the system generates a debug event.</span></span> <span data-ttu-id="abb41-106">Если отладчик использует функцию [**ваитфордебужевент**](/windows/win32/api/debugapi/nf-debugapi-waitfordebugevent) , событие Debug вызывает возврат этой функции с указателем на структуру [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) .</span><span class="sxs-lookup"><span data-stu-id="abb41-106">If the debugger is using the [**WaitForDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-waitfordebugevent) function, the debug event causes that function to return with a pointer to a [**DEBUG\_EVENT**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) structure.</span></span> <span data-ttu-id="abb41-107">Эта структура содержит идентификаторы процессов и потоков, которые отладчик может использовать для доступа к записи контекста потока.</span><span class="sxs-lookup"><span data-stu-id="abb41-107">This structure contains the process and thread identifiers the debugger can use to access the thread's context record.</span></span> <span data-ttu-id="abb41-108">Структура также содержит структуру [**\_ \_ сведений об отладке исключения**](/windows/win32/api/minwinbase/ns-minwinbase-exception_debug_info) , содержащую копию записи исключения.</span><span class="sxs-lookup"><span data-stu-id="abb41-108">The structure also contains an [**EXCEPTION\_DEBUG\_INFO**](/windows/win32/api/minwinbase/ns-minwinbase-exception_debug_info) structure that includes a copy of the exception record.</span></span>

<span data-ttu-id="abb41-109">Когда система выполняет поиск обработчика исключений, она выполняет две попытки уведомления отладчика процесса.</span><span class="sxs-lookup"><span data-stu-id="abb41-109">When the system is searching for an exception handler, it makes two attempts to notify a process's debugger.</span></span> <span data-ttu-id="abb41-110">Первая попытка уведомления предоставляет отладчику возможность выполнять обработку исключений точек останова или отдельных шагов.</span><span class="sxs-lookup"><span data-stu-id="abb41-110">The first notification attempt provides the debugger with an opportunity to handle breakpoint or single-step exceptions.</span></span> <span data-ttu-id="abb41-111">Это называется *первым шансом уведомления*.</span><span class="sxs-lookup"><span data-stu-id="abb41-111">This is known as *first-chance notification*.</span></span> <span data-ttu-id="abb41-112">После этого пользователь может выдавать команды отладчика для управления средой процесса до выполнения любых обработчиков исключений.</span><span class="sxs-lookup"><span data-stu-id="abb41-112">The user can then issue debugger commands to manipulate the process's environment before any exception handlers are executed.</span></span> <span data-ttu-id="abb41-113">Вторая попытка уведомления отладчика возникает только в том случае, если системе не удается найти обработчик исключений на основе кадров, обрабатывающий исключение.</span><span class="sxs-lookup"><span data-stu-id="abb41-113">The second attempt to notify the debugger occurs only if the system is unable to find a frame-based exception handler that handles the exception.</span></span> <span data-ttu-id="abb41-114">Это называется *уведомлением о последнем шансе*.</span><span class="sxs-lookup"><span data-stu-id="abb41-114">This is known as *last-chance notification*.</span></span> <span data-ttu-id="abb41-115">Если отладчик не обрабатывает исключение после уведомления о последнем шансе, система завершает отлаживаемый процесс.</span><span class="sxs-lookup"><span data-stu-id="abb41-115">If the debugger does not handle the exception after the last-chance notification, the system terminates the process being debugged.</span></span>

<span data-ttu-id="abb41-116">При каждой попытке уведомления отладчик использует функцию [**континуедебужевент**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) , чтобы вернуть управление системе.</span><span class="sxs-lookup"><span data-stu-id="abb41-116">At each notification attempt, the debugger uses the [**ContinueDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) function to return control to the system.</span></span> <span data-ttu-id="abb41-117">Перед возвратом управления отладчик может выполнить обработку исключения и изменить состояние потока соответствующим образом или отказаться от обработки исключения.</span><span class="sxs-lookup"><span data-stu-id="abb41-117">Before returning control, the debugger can handle the exception and modify the thread state as appropriate, or it can choose not to handle the exception.</span></span> <span data-ttu-id="abb41-118">С помощью **континуедебужевент** отладчик может указать, что он обработал исключение. в этом случае состояние компьютера восстанавливается и выполнение потока продолжается в момент возникновения исключения.</span><span class="sxs-lookup"><span data-stu-id="abb41-118">Using **ContinueDebugEvent**, the debugger can indicate that it has handled the exception, in which case the machine state is restored and thread execution is continued at the point at which the exception occurred.</span></span> <span data-ttu-id="abb41-119">Отладчик может также указать, что он не обрабатывал исключение, что приводит к тому, что система продолжит поиск обработчика исключений.</span><span class="sxs-lookup"><span data-stu-id="abb41-119">The debugger can also indicate that it did not handle the exception, which causes the system to continue its search for an exception handler.</span></span>

 

 
