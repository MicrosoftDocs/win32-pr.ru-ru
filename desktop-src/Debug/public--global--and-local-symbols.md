---
description: Возможности обработки символов API DbgHelp были изменены за годы.
ms.assetid: 6dc41682-6104-418b-b045-7afe8c2b11e9
title: Открытые, глобальные и локальные символы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 623bf93ec8f11d1cec9c5fec64e2479dd91ee5cd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072408"
---
# <a name="public-global-and-local-symbols"></a><span data-ttu-id="d015e-103">Открытые, глобальные и локальные символы</span><span class="sxs-lookup"><span data-stu-id="d015e-103">Public, Global, and Local Symbols</span></span>

<span data-ttu-id="d015e-104">Возможности обработки символов API DbgHelp были изменены за годы.</span><span class="sxs-lookup"><span data-stu-id="d015e-104">The symbol handling capabilities of the DbgHelp API have evolved over the years.</span></span> <span data-ttu-id="d015e-105">Чтобы обеспечить работу кода в различных сценариях и предоставить полные сведения о символах, используйте новейшие функции, когда это возможно.</span><span class="sxs-lookup"><span data-stu-id="d015e-105">To ensure that your code works in a variety of scenarios and provides full details on the symbols, use the newest functions whenever possible.</span></span> <span data-ttu-id="d015e-106">Например, [**сименумсимболс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols) заменяет [**SymEnumerateSymbols64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumeratesymbols), [**Симфромнаме**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromname) заменяет [**SymGetSymFromName64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromname), а [**симфромаддр**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromaddr) заменяет [**SymGetSymFromAddr64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromaddr).</span><span class="sxs-lookup"><span data-stu-id="d015e-106">For example, [**SymEnumSymbols**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols) replaces [**SymEnumerateSymbols64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumeratesymbols), [**SymFromName**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromname) replaces [**SymGetSymFromName64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromname), and [**SymFromAddr**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromaddr) replaces [**SymGetSymFromAddr64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromaddr).</span></span>

## <a name="public-symbols"></a><span data-ttu-id="d015e-107">Открытые символы</span><span class="sxs-lookup"><span data-stu-id="d015e-107">Public Symbols</span></span>

<span data-ttu-id="d015e-108">Начальные версии DbgHelp.dll поддерживали проверку только открытых символов.</span><span class="sxs-lookup"><span data-stu-id="d015e-108">Initial versions of DbgHelp.dll supported examining only public symbols.</span></span> <span data-ttu-id="d015e-109">Эти символы формируются для любого элемента в коде, который должен быть предоставлен между различными исходными файлами.</span><span class="sxs-lookup"><span data-stu-id="d015e-109">These symbols are generated for any item in the code that must be exposed between different source files.</span></span> <span data-ttu-id="d015e-110">Они также включают все элементы, экспортированные из модуля.</span><span class="sxs-lookup"><span data-stu-id="d015e-110">They also include all items that are exported out of the module.</span></span>

<span data-ttu-id="d015e-111">Символы либо внедряются в изображение, либо хранятся отдельно в файле. dbg или. pdb.</span><span class="sxs-lookup"><span data-stu-id="d015e-111">The symbols are either embedded in the image, or stored separately in a .dbg or .pdb file.</span></span> <span data-ttu-id="d015e-112">Единственная Хранимая информация — это имя и адрес символа.</span><span class="sxs-lookup"><span data-stu-id="d015e-112">The only information stored is the symbol name and address.</span></span> <span data-ttu-id="d015e-113">Имена доступны в виде декорированных имен.</span><span class="sxs-lookup"><span data-stu-id="d015e-113">The names are available as decorated names.</span></span> <span data-ttu-id="d015e-114">Чтобы просмотреть недекорированные имена, вызовите функцию [**симсетоптионс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) с помощью симопт \_ UNDNAME или используйте функцию [**ундекоратесимболнаме**](/windows/desktop/api/Dbghelp/nf-dbghelp-undecoratesymbolname) .</span><span class="sxs-lookup"><span data-stu-id="d015e-114">To view undecorated names, call the [**SymSetOptions**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) function with SYMOPT\_UNDNAME, or use the [**UnDecorateSymbolName**](/windows/desktop/api/Dbghelp/nf-dbghelp-undecoratesymbolname) function.</span></span>

<span data-ttu-id="d015e-115">Обратите внимание, что API DbgHelp изначально не разрабатывался для поддержки нескольких экземпляров одного и того же символа в модуле.</span><span class="sxs-lookup"><span data-stu-id="d015e-115">Note that the DbgHelp API was not initially designed to support multiple instances of the same symbol within a module.</span></span> <span data-ttu-id="d015e-116">Это обусловлено тем, что открытые символы ограничены уникальными именами внутри модуля.</span><span class="sxs-lookup"><span data-stu-id="d015e-116">This is because public symbols are restricted to unique names within a module.</span></span> <span data-ttu-id="d015e-117">Поэтому [**SymGetSymFromName64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromname) возвращает только первый символ, который соответствует.</span><span class="sxs-lookup"><span data-stu-id="d015e-117">Therefore, [**SymGetSymFromName64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromname) returns only the first symbol that matches.</span></span> <span data-ttu-id="d015e-118">Чтобы получить все символы, соответствующие, вызовите [**сименумсимболс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols).</span><span class="sxs-lookup"><span data-stu-id="d015e-118">To retrieve all symbols that match, call [**SymEnumSymbols**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols).</span></span>

## <a name="global-and-local-symbols"></a><span data-ttu-id="d015e-119">Глобальные и локальные символы</span><span class="sxs-lookup"><span data-stu-id="d015e-119">Global and Local Symbols</span></span>

<span data-ttu-id="d015e-120">Новые версии DbgHelp.dll поддерживают глобальные и локальные символы при использовании PDB-файлов.</span><span class="sxs-lookup"><span data-stu-id="d015e-120">Newer versions of DbgHelp.dll support global and local symbols when using .pdb files.</span></span> <span data-ttu-id="d015e-121">Эти новые версии включают в себя статические функции, функции, ограниченные в исходном файле, параметрах функций и локальных переменных.</span><span class="sxs-lookup"><span data-stu-id="d015e-121">These new versions include static functions, functions scoped within a source file, function parameters, and local variables.</span></span> <span data-ttu-id="d015e-122">Когда DbgHelp ищет символ, он проверяет глобальные и локальные таблицы символов перед проверкой таблицы общедоступных символов.</span><span class="sxs-lookup"><span data-stu-id="d015e-122">When DbgHelp searches for a symbol, it checks the global and local symbol tables before checking the public symbol table.</span></span> <span data-ttu-id="d015e-123">Это связано с тем, что для этих типов символов доступно больше информации, чем для общедоступных символов.</span><span class="sxs-lookup"><span data-stu-id="d015e-123">This is because there is more information available for these types of symbols than is available for public symbols.</span></span>

<span data-ttu-id="d015e-124">Глобальные и локальные символы хранятся с недекорированными именами.</span><span class="sxs-lookup"><span data-stu-id="d015e-124">Global and local symbols are stored with undecorated names.</span></span> <span data-ttu-id="d015e-125">Поэтому \_ флаг симопт UNDNAME не действует.</span><span class="sxs-lookup"><span data-stu-id="d015e-125">Therefore, the SYMOPT\_UNDNAME flag has no effect.</span></span> <span data-ttu-id="d015e-126">Чтобы получить декорированные имена символов, необходимо использовать флаг " \_ только общие" симопт \_ .</span><span class="sxs-lookup"><span data-stu-id="d015e-126">To get decorated symbol names, you must use the SYMOPT\_PUBLICS\_ONLY flag.</span></span> <span data-ttu-id="d015e-127">В результате DbgHelp будет искать только открытые символы.</span><span class="sxs-lookup"><span data-stu-id="d015e-127">This causes DbgHelp to search only the public symbols.</span></span>

<span data-ttu-id="d015e-128">Чтобы просмотреть локальные символы или параметры функции, вызовите функцию [**симсетконтекст**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetcontext) с элементом **инструктионоффсет** в структуре [**\_ \_ кадра стека Imagehlp**](/windows/desktop/api/DbgHelp/ns-dbghelp-imagehlp_stack_frame) , равным адресу любого символа функции.</span><span class="sxs-lookup"><span data-stu-id="d015e-128">To view local symbols or function parameters, call the [**SymSetContext**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetcontext) function with the **InstructionOffset** member of the [**IMAGEHLP\_STACK\_FRAME**](/windows/desktop/api/DbgHelp/ns-dbghelp-imagehlp_stack_frame) structure set to the address of any function symbol.</span></span> <span data-ttu-id="d015e-129">Последующие вызовы [**симфромнаме**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromname) и [**сименумсимболс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols) могут действовать в контексте этого адреса.</span><span class="sxs-lookup"><span data-stu-id="d015e-129">Subsequent calls to [**SymFromName**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromname) and [**SymEnumSymbols**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols) can operate within the context of this address.</span></span> <span data-ttu-id="d015e-130">Для этого присвойте параметру *Басеофдлл* **значение NULL** и опустите спецификатор модуля из параметра *Name* или *Mask* .</span><span class="sxs-lookup"><span data-stu-id="d015e-130">To do so, set the *BaseOfDll* parameter to **NULL** and omit the module specifier from the *Name* or *Mask* parameter.</span></span> <span data-ttu-id="d015e-131">Это заставляет DbgHelp искать совпадающие символы в области, указанной параметром **симсетконтекст**.</span><span class="sxs-lookup"><span data-stu-id="d015e-131">This forces DbgHelp to search for matching symbols within the scope indicated by **SymSetContext**.</span></span>

<span data-ttu-id="d015e-132">Чтобы определить, является ли символ параметром, проверьте элемент **flags** в структуре [**\_ сведений о символах**](/windows/desktop/api/DbgHelp/ns-dbghelp-symbol_info) .</span><span class="sxs-lookup"><span data-stu-id="d015e-132">To determine if a symbol is a parameter, check the **Flags** member of the [**SYMBOL\_INFO**](/windows/desktop/api/DbgHelp/ns-dbghelp-symbol_info) structure.</span></span> <span data-ttu-id="d015e-133">Если символ является параметром, член содержит \_ параметр симфлаг.</span><span class="sxs-lookup"><span data-stu-id="d015e-133">If the symbol is a parameter, the member contains SYMFLAG\_PARAMETER.</span></span> <span data-ttu-id="d015e-134">Если это локальный символ, член содержит СИМФЛАГ \_ Local.</span><span class="sxs-lookup"><span data-stu-id="d015e-134">If it is a local symbol, the member contains SYMFLAG\_LOCAL.</span></span>

 

 



