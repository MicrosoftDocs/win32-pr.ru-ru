---
description: Обработчик символов загрузит символы при вызове функции Симинитиализе с параметром Финвадепроцесс, установленным в значение TRUE, или при вызове функции Симлоадмодуликс для указания модуля.
ms.assetid: fae1895e-9fed-45e3-8ecf-4c6cc67a6094
title: Загрузка символов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 705a7af3525c784b2bbcd512b267309a466a11c1
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423222"
---
# <a name="symbol-loading"></a><span data-ttu-id="a5fb0-103">Загрузка символов</span><span class="sxs-lookup"><span data-stu-id="a5fb0-103">Symbol Loading</span></span>

<span data-ttu-id="a5fb0-104">Обработчик символов загрузит символы при вызове функции [**симинитиализе**](/windows/desktop/api/Dbghelp/nf-dbghelp-syminitialize) с параметром *финвадепроцесс* , установленным в **значение true** , или при вызове функции [**симлоадмодуликс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symloadmoduleex) для указания модуля.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-104">The symbol handler will load symbols when you call the [**SymInitialize**](/windows/desktop/api/Dbghelp/nf-dbghelp-syminitialize) function with the *fInvadeProcess* parameter set to **TRUE** or when you call the [**SymLoadModuleEx**](/windows/desktop/api/Dbghelp/nf-dbghelp-symloadmoduleex) function to specify a module.</span></span> <span data-ttu-id="a5fb0-105">В любом случае обработчик символов либо загружает символы, либо откладывает загрузку символов, пока символы не запрашиваются, в зависимости от параметров, заданных функцией [**симсетоптионс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) .</span><span class="sxs-lookup"><span data-stu-id="a5fb0-105">In either case, the symbol handler either loads the symbols or defers symbol loading until symbols are requested, depending on the options set by the [**SymSetOptions**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) function.</span></span>

<span data-ttu-id="a5fb0-106">Обработчик символов можно использовать для получения символьной информации для любого модуля. его не нужно связывать с процессом, указанным в вызове [**симинитиализе**](/windows/desktop/api/Dbghelp/nf-dbghelp-syminitialize) .</span><span class="sxs-lookup"><span data-stu-id="a5fb0-106">The symbol handler can be used to retrieve symbolic information for any module; it does not need to be associated with a process specified in the [**SymInitialize**](/windows/desktop/api/Dbghelp/nf-dbghelp-syminitialize) call.</span></span> <span data-ttu-id="a5fb0-107">Чтобы использовать произвольный модуль, укажите полный путь к образу модуля в параметре *imageName* .</span><span class="sxs-lookup"><span data-stu-id="a5fb0-107">To use an arbitrary module, specify the full path to the module image in the *ImageName* parameter.</span></span> <span data-ttu-id="a5fb0-108">Можно использовать путь к любому исполняемому модулю, который содержит отладочную информацию (exe, DLL, DRV, sys, SCR,. cpl или. com).</span><span class="sxs-lookup"><span data-stu-id="a5fb0-108">You can use a path to any executable module that has debugging information (.exe, .dll, .drv, .sys, .scr, .cpl, or .com).</span></span> <span data-ttu-id="a5fb0-109">Используйте параметр *басеофдлл* , чтобы указать любой адрес загрузки, а адреса символов будут основываться на этом адресе.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-109">Use the *BaseOfDll* parameter to specify any load address, then symbol addresses will be based from that address.</span></span>

<span data-ttu-id="a5fb0-110">Возможно, не потребуется хранить модуль символов, загруженный с течением времени приложения.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-110">It may not be necessary to keep a symbol module loaded through the duration of an application.</span></span> <span data-ttu-id="a5fb0-111">Чтобы освободить модуль символов из списка модулей обработчика символов, используйте функцию [**SymUnloadModule64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symunloadmodule) .</span><span class="sxs-lookup"><span data-stu-id="a5fb0-111">To release the symbol module from the symbol handler's list of modules, use the [**SymUnloadModule64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symunloadmodule) function.</span></span> <span data-ttu-id="a5fb0-112">Эта функция освобождает память, выделенную для модуля символов.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-112">This function releases the memory allocated for the symbol module.</span></span> <span data-ttu-id="a5fb0-113">Чтобы снова использовать символы для этого модуля, необходимо вызвать функцию [**симлоадмодуликс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symloadmoduleex) , даже если установлен параметр символа отложенной загрузки.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-113">To use symbols for that module again, you must call the [**SymLoadModuleEx**](/windows/desktop/api/Dbghelp/nf-dbghelp-symloadmoduleex) function even if the symbol deferred load option is set.</span></span>

## <a name="diagnosing-symbol-load-problems"></a><span data-ttu-id="a5fb0-114">Диагностика проблем с загрузкой символов</span><span class="sxs-lookup"><span data-stu-id="a5fb0-114">Diagnosing Symbol Load Problems</span></span>

<span data-ttu-id="a5fb0-115">Чтобы просмотреть все попытки загрузки символов, вызовите [**симсетоптионс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) с помощью симопт \_ Debug.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-115">To view all attempts to load symbols, call [**SymSetOptions**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) with SYMOPT\_DEBUG.</span></span> <span data-ttu-id="a5fb0-116">Это приводит к тому, что DbgHelp вызывает функцию [**OutputDebugString**](/windows/win32/api/debugapi/nf-debugapi-outputdebugstringa) с подробными сведениями о поиске символов, например в каталогах, в которых выполняется поиск, и сообщения об ошибках.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-116">This causes DbgHelp to call the [**OutputDebugString**](/windows/win32/api/debugapi/nf-debugapi-outputdebugstringa) function with detailed information on symbol searches, such as the directories it is searching and and error messages.</span></span> <span data-ttu-id="a5fb0-117">Если в коде используется [**SymRegisterCallback64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symregistercallback), DBGHELP будет вызывать функцию обратного вызова вместо вызова **OutputDebugString**.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-117">If your code uses [**SymRegisterCallback64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symregistercallback), DbgHelp will call your callback function instead of calling **OutputDebugString**.</span></span> <span data-ttu-id="a5fb0-118">Параметр *актионкоде* имеет значение CBA \_ Debug info, \_ а параметр *каллбаккдата* — строка, которую можно отобразить.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-118">The *ActionCode* parameter is set to CBA\_DEBUG\_INFO and the *CallbackData* parameter is a string that can be displayed.</span></span>

<span data-ttu-id="a5fb0-119">Чтобы обеспечить отображение выходных данных отладки в консоли без изменения исходного кода, \_ перед вызовом функции [**симинитиализе**](/windows/desktop/api/Dbghelp/nf-dbghelp-syminitialize) задайте для переменной среды DBGHELP дбгаут значение, отличное от **null** .</span><span class="sxs-lookup"><span data-stu-id="a5fb0-119">To enable this debug output to be displayed to the console without changing your source code, set the DBGHELP\_DBGOUT environment variable to a non-**NULL** value before calling the [**SymInitialize**](/windows/desktop/api/Dbghelp/nf-dbghelp-syminitialize) function.</span></span> <span data-ttu-id="a5fb0-120">Чтобы записать сведения в файл, задайте для \_ переменной среды журнала DBGHELP имя файла журнала, который будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-120">To log the information to a file, set the DBGHELP\_LOG environment variable to the name of the log file to be used.</span></span>

<span data-ttu-id="a5fb0-121">Обратите внимание, что эти функции следует использовать только при необходимости.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-121">Note that these features should be used only when needed.</span></span> <span data-ttu-id="a5fb0-122">Они могут замедлить загрузку символов для модулей, содержащих много символов.</span><span class="sxs-lookup"><span data-stu-id="a5fb0-122">They may slow down symbol loading of modules that contain many symbols.</span></span>

 

 
