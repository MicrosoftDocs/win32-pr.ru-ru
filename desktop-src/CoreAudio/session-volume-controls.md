---
description: Элементы управления громкостью
ms.assetid: e6d112f9-08c9-4d95-b37b-267beebd0d7f
title: Элементы управления громкостью
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: add29b18b39c942c54926190ef9c0f85e447bb88
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103896069"
---
# <a name="session-volume-controls"></a><span data-ttu-id="98c9e-103">Элементы управления громкостью</span><span class="sxs-lookup"><span data-stu-id="98c9e-103">Session Volume Controls</span></span>

<span data-ttu-id="98c9e-104">Как упоминалось ранее, клиенты ВАСАПИ могут отдельно контролировать уровень громкости каждого [сеанса аудио](audio-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="98c9e-104">As explained previously, WASAPI clients can individually control the volume level of each [audio session](audio-sessions.md).</span></span> <span data-ttu-id="98c9e-105">ВАСАПИ применяет параметр тома для сеанса единообразно для всех потоков в сеансе.</span><span class="sxs-lookup"><span data-stu-id="98c9e-105">WASAPI applies the volume setting for a session uniformly to all of the streams in the session.</span></span> <span data-ttu-id="98c9e-106">Каждый уровень громкости — это значение в диапазоне от 0,0 до 1,0, где 0,0 означает тишину, а 1,0 — полный том (без затухания).</span><span class="sxs-lookup"><span data-stu-id="98c9e-106">Each volume level is a value in the range 0.0 to 1.0, where 0.0 indicates silence and 1.0 indicates full volume (no attenuation).</span></span>

<span data-ttu-id="98c9e-107">Клиент неявно создает сеанс, назначая первый поток этому сеансу.</span><span class="sxs-lookup"><span data-stu-id="98c9e-107">A client implicitly creates a session by assigning the first stream to that session.</span></span> <span data-ttu-id="98c9e-108">Уровень громкости нового сеанса по умолчанию — 1,0.</span><span class="sxs-lookup"><span data-stu-id="98c9e-108">The default volume level of the new session is 1.0.</span></span> <span data-ttu-id="98c9e-109">Как обсуждалось ранее, пользователь может настроить уровень громкости сеанса с помощью пользовательского интерфейса управляющей программы (например, Сндвол), которая является клиентом ВАСАПИ.</span><span class="sxs-lookup"><span data-stu-id="98c9e-109">As discussed previously, the user can adjust the volume level of the session through the user interface of a control program (for example, Sndvol) that is a WASAPI client.</span></span> <span data-ttu-id="98c9e-110">Параметры элемента управления являются постоянными.</span><span class="sxs-lookup"><span data-stu-id="98c9e-110">The control settings are persistent.</span></span>

<span data-ttu-id="98c9e-111">В дополнение к параметрам, управляемым клиентом, система применяет собственные параметры тома к сеансам.</span><span class="sxs-lookup"><span data-stu-id="98c9e-111">In addition to the client-controlled volume settings, the system applies its own volume settings to sessions.</span></span> <span data-ttu-id="98c9e-112">Эти параметры основаны на политике аудио и динамически изменяются в ответ на изменения в потоках, составляющих глобальные звуковые МИКШЕРЫ.</span><span class="sxs-lookup"><span data-stu-id="98c9e-112">These settings are based on audio policy and change dynamically in response to changes in the streams that make up the global audio mix.</span></span> <span data-ttu-id="98c9e-113">Дополнительные сведения о политике аудио см. в разделе [звуковые компоненты пользовательского режима](user-mode-audio-components.md).</span><span class="sxs-lookup"><span data-stu-id="98c9e-113">For more information about audio policy, see [User-Mode Audio Components](user-mode-audio-components.md).</span></span>

<span data-ttu-id="98c9e-114">Системное программное обеспечение, реализующее регулятор громкости для каждого потока, умножает примеры PCM в потоке на действующий уровень громкости.</span><span class="sxs-lookup"><span data-stu-id="98c9e-114">The system software that implements the volume control for each stream multiplies the PCM samples in the stream by the effective volume level.</span></span> <span data-ttu-id="98c9e-115">Эффективный уровень громкости — это результат умножения параметров "клиент" и "системный том".</span><span class="sxs-lookup"><span data-stu-id="98c9e-115">The effective volume level is the result of multiplying the client and system volume settings.</span></span> <span data-ttu-id="98c9e-116">Таким результатом, результирующее изменение в амплитуде сигнала — это линейное сочетание уровней громкости клиента и системного тома.</span><span class="sxs-lookup"><span data-stu-id="98c9e-116">Thus, the resulting change in signal amplitude is a linear combination of the client and system volume levels.</span></span> <span data-ttu-id="98c9e-117">Например, если уровень громкости клиента — 0,8, а системный уровень громкости — 0,5, то действует действующий уровень громкости (0,8)<sup>.</sup> (0,5) = 0,4.</span><span class="sxs-lookup"><span data-stu-id="98c9e-117">For example, if the client volume level is 0.8 and the system volume level is 0.5, the effective volume level is (0.8)<sup>.</sup>(0.5) = 0.4.</span></span>

<span data-ttu-id="98c9e-118">Обратите внимание, что воспринимаемая громкость не является линейной по отношению к амплитуде сигнала.</span><span class="sxs-lookup"><span data-stu-id="98c9e-118">Note that perceived loudness is not linear with respect to signal amplitude.</span></span> <span data-ttu-id="98c9e-119">Вместо этого громкость варьируется примерно как логарифм уровня громкости v:</span><span class="sxs-lookup"><span data-stu-id="98c9e-119">Instead, loudness varies approximately as the logarithm of the volume level v:</span></span>

<span data-ttu-id="98c9e-120">громкость в децибел = 20<sup>.</sup> log ₁ ₀ (v)</span><span class="sxs-lookup"><span data-stu-id="98c9e-120">loudness in decibels = 20<sup>.</sup>log₁₀(v)</span></span>

<span data-ttu-id="98c9e-121">Таким образом, установка v = 0,5 ослабления громкости исходного сигнала (сигнала до применения уровня громкости) на 6 децибел, установка v = 0,25 ослабление сигнала на 12 децибел и т. д.</span><span class="sxs-lookup"><span data-stu-id="98c9e-121">Thus, setting v = 0.5 attenuates the loudness of the original signal (the signal before the volume level is applied) by 6 decibels, setting v = 0.25 attenuates the signal by 12 decibels, and so on.</span></span> <span data-ttu-id="98c9e-122">Уровень громкости v = 1,0, соответствующий 0 децибел, не изменяет исходный уровень сигнала.</span><span class="sxs-lookup"><span data-stu-id="98c9e-122">A volume level v = 1.0, corresponding to 0 decibels, does not alter the original signal level.</span></span>

<span data-ttu-id="98c9e-123">Звуковые приложения с пользовательскими интерфейсами для управления уровнем громкости обычно отображают ползунки, которые создают изменения в воспринимаемом звуке, линейно пропорционально изменениям в положении ползунка.</span><span class="sxs-lookup"><span data-stu-id="98c9e-123">Audio applications with user interfaces for controlling the volume level typically display sliders that generate changes in perceived loudness that are linearly proportional to changes in slider position.</span></span> <span data-ttu-id="98c9e-124">Чтобы создать линейную связь между наблюдаемой громкостью и положением ползунка, приложение должно определить нелинейную связь между уровнями громкости v и ползунком.</span><span class="sxs-lookup"><span data-stu-id="98c9e-124">To produce a linear relationship between perceived loudness and slider position, the application must define a nonlinear relationship between the volume level v and the slider position.</span></span> <span data-ttu-id="98c9e-125">Дополнительные сведения см. в разделе [регуляторы громкости звука](audio-tapered-volume-controls.md).</span><span class="sxs-lookup"><span data-stu-id="98c9e-125">For more information, see [Audio-Tapered Volume Controls](audio-tapered-volume-controls.md).</span></span>

<span data-ttu-id="98c9e-126">Как упоминалось ранее, программа системного управления громкостью, Сндвол, отображает ползунки громкости для звуковых сеансов, которые воспроизводятся на каждом устройстве отображения звука.</span><span class="sxs-lookup"><span data-stu-id="98c9e-126">As explained previously, the system volume-control program, Sndvol, displays volume sliders for the audio sessions that are playing on each audio rendering device.</span></span> <span data-ttu-id="98c9e-127">Эти ползунки отображаются в поле Группа под названием **приложения** в окне сндвол.</span><span class="sxs-lookup"><span data-stu-id="98c9e-127">These sliders appear in the group box labeled **Applications** in the SndVol window.</span></span> <span data-ttu-id="98c9e-128">Как правило, каждый сеанс содержит все потоки воспроизведения из определенного окна приложения.</span><span class="sxs-lookup"><span data-stu-id="98c9e-128">Typically, each session contains all of the playback streams from a particular application window.</span></span> <span data-ttu-id="98c9e-129">С помощью ползунков в окне Сндвол пользователи управляют уровнями громкости отдельных звуковых приложений.</span><span class="sxs-lookup"><span data-stu-id="98c9e-129">Through the sliders in the Sndvol window, users control the volume levels of individual audio applications.</span></span>

<span data-ttu-id="98c9e-130">Как правило, приложение должно назначить все потоки воспроизведения одному и тому же сеансу звука.</span><span class="sxs-lookup"><span data-stu-id="98c9e-130">As a general rule, an application should assign all of its playback streams to the same audio session.</span></span> <span data-ttu-id="98c9e-131">ВАСАПИ не мешает приложению распространять потоки воспроизведения между несколькими сеансами.</span><span class="sxs-lookup"><span data-stu-id="98c9e-131">WASAPI does not prevent an application from distributing its playback streams among multiple sessions.</span></span> <span data-ttu-id="98c9e-132">Однако итоговый рост количества ползунков громкости в Сндвол может запутать пользователей.</span><span class="sxs-lookup"><span data-stu-id="98c9e-132">However, the resulting proliferation of volume sliders in Sndvol might confuse users.</span></span>

<span data-ttu-id="98c9e-133">Как вариант, окно приложения может отображать ползунок громкости.</span><span class="sxs-lookup"><span data-stu-id="98c9e-133">As an option, an application window can display a volume slider.</span></span> <span data-ttu-id="98c9e-134">Ползунок приложения должен всегда отражать состояние соответствующего ползунка Сндвол.</span><span class="sxs-lookup"><span data-stu-id="98c9e-134">The application slider should reflect the state of the corresponding Sndvol slider at all times.</span></span> <span data-ttu-id="98c9e-135">Таким образом, если пользователь изменяет уровень громкости, перемещая ползунок в окне приложения, соответствующий ползунок в окне Сндвол должен перемещаться в одновременном с помощью ползунка приложения.</span><span class="sxs-lookup"><span data-stu-id="98c9e-135">Thus, if the user changes the volume level by moving the slider in the application window, then the corresponding slider in the Sndvol window should move in unison with the application slider.</span></span> <span data-ttu-id="98c9e-136">Аналогичным образом, если пользователь перемещает ползунок Сндвол, то ползунок приложения должен перемещаться в одновременном с помощью ползунка Сндвол.</span><span class="sxs-lookup"><span data-stu-id="98c9e-136">Similarly, if the user moves the Sndvol slider, then the application slider should move in unison with the Sndvol slider.</span></span>

<span data-ttu-id="98c9e-137">Для поддержки такого поведения ВАСАПИ реализует интерфейс [**исимплеаудиоволуме**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) .</span><span class="sxs-lookup"><span data-stu-id="98c9e-137">To support this behavior, WASAPI implements the [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) interface.</span></span> <span data-ttu-id="98c9e-138">Когда пользователь перемещает ползунок приложения, приложение вызывает метод [**исимплеаудиоволуме:: сетмастерволуме**](/windows/desktop/api/Audioclient/nf-audioclient-isimpleaudiovolume-setmastervolume) , чтобы соответствующим образом настроить уровень громкости сеанса.</span><span class="sxs-lookup"><span data-stu-id="98c9e-138">When the user moves the application slider, the application calls the [**ISimpleAudioVolume::SetMasterVolume**](/windows/desktop/api/Audioclient/nf-audioclient-isimpleaudiovolume-setmastervolume) method to adjust the session volume level accordingly.</span></span> <span data-ttu-id="98c9e-139">Сндвол отслеживает изменения тома, сделанные с помощью этого метода, и отражает изменения в ползунках громкости, которые он отображает.</span><span class="sxs-lookup"><span data-stu-id="98c9e-139">Sndvol monitors volume changes made through this method and reflects the changes in the volume sliders that it displays.</span></span> <span data-ttu-id="98c9e-140">Кроме того, приложение может получать уведомления об изменениях в томе сеанса, которые пользователь выполняет через Сндвол.</span><span class="sxs-lookup"><span data-stu-id="98c9e-140">In addition, an application can receive notifications of session volume changes that the user makes through Sndvol.</span></span> <span data-ttu-id="98c9e-141">Для этой цели приложение реализует интерфейс [**иаудиосессионевентс**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) и регистрирует интерфейс с помощью васапи.</span><span class="sxs-lookup"><span data-stu-id="98c9e-141">For this purpose, the application implements an [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface and registers the interface with WASAPI.</span></span> <span data-ttu-id="98c9e-142">Затем каждый раз, когда пользователь изменяет уровень громкости сеанса через Сндвол, приложение получает вызов уведомления через метод [**иаудиосессионевентс:: онсимплеволумечанжед**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsimplevolumechanged) .</span><span class="sxs-lookup"><span data-stu-id="98c9e-142">Thereafter, each time the user changes the session volume level through Sndvol, the application receives a notification call through the [**IAudioSessionEvents::OnSimpleVolumeChanged**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsimplevolumechanged) method.</span></span> <span data-ttu-id="98c9e-143">Пример кода, в котором реализуется интерфейс **иаудиосессионевентс** , см. в разделе [события сеанса звука](audio-session-events.md).</span><span class="sxs-lookup"><span data-stu-id="98c9e-143">For a code example that implements an **IAudioSessionEvents** interface, see [Audio Session Events](audio-session-events.md).</span></span> <span data-ttu-id="98c9e-144">Пример кода, который регистрирует интерфейс **иаудиосессионевентс** , см. в разделе [события аудио для устаревших аудио приложений](audio-events-for-legacy-audio-applications.md).</span><span class="sxs-lookup"><span data-stu-id="98c9e-144">For a code example that registers an **IAudioSessionEvents** interface, see [Audio Events for Legacy Audio Applications](audio-events-for-legacy-audio-applications.md).</span></span>

<span data-ttu-id="98c9e-145">Интерфейс **исимплеаудиоволуме** применяет одинаковый уровень громкости ко всем каналам в сеансе аудио.</span><span class="sxs-lookup"><span data-stu-id="98c9e-145">The **ISimpleAudioVolume** interface applies the same volume level uniformly to all of the channels in an audio session.</span></span> <span data-ttu-id="98c9e-146">Несмотря на то что этот интерфейс должен удовлетворять требованиям к управлению томами большинства приложений, для некоторых приложений может потребоваться более специализированный набор возможностей управления томами.</span><span class="sxs-lookup"><span data-stu-id="98c9e-146">Although this interface should satisfy the volume-control requirements of most applications, a few applications might require more specialized volume-control capabilities.</span></span> <span data-ttu-id="98c9e-147">Интерфейс [**иаудиостреамволуме**](/windows/desktop/api/Audioclient/nn-audioclient-iaudiostreamvolume) управляет объемом отдельного потока в сеансе относительно других потоков в сеансе.</span><span class="sxs-lookup"><span data-stu-id="98c9e-147">The [**IAudioStreamVolume**](/windows/desktop/api/Audioclient/nn-audioclient-iaudiostreamvolume) interface controls the volume of an individual stream in a session relative to the other streams in the session.</span></span> <span data-ttu-id="98c9e-148">**Иаудиостреамволуме** также позволяет клиенту отдельно управлять уровнями громкости всех каналов в потоке.</span><span class="sxs-lookup"><span data-stu-id="98c9e-148">**IAudioStreamVolume** also enables a client to individually control the volume levels of all the channels in the stream.</span></span> <span data-ttu-id="98c9e-149">Например, приложение может использовать эту возможность для достижения звуковых эффектов, таких как имитация пространственного перемещения источника звука путем панорамирования слева направо.</span><span class="sxs-lookup"><span data-stu-id="98c9e-149">For example, an application might use this capability to achieve audio effects such as simulating spatial movement of an audio source by panning from left to right.</span></span> <span data-ttu-id="98c9e-150">Другой специализированный интерфейс, [**ичаннелаудиоволуме**](/windows/desktop/api/Audioclient/nn-audioclient-ichannelaudiovolume), управляет уровнями громкости отдельных каналов в сеансе.</span><span class="sxs-lookup"><span data-stu-id="98c9e-150">Another specialized interface, [**IChannelAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-ichannelaudiovolume), controls the volume levels of the individual channels in a session.</span></span> <span data-ttu-id="98c9e-151">Например, приложение может использовать **ичаннелаудиоволуме** для реализации контроля баланса для звуковой системы стереофоник.</span><span class="sxs-lookup"><span data-stu-id="98c9e-151">For example, an application might use **IChannelAudioVolume** to implement balance controls for a stereophonic sound system.</span></span>

<span data-ttu-id="98c9e-152">Ползунки громкости в поле **приложения** в сндвол отражает только изменения томов, сделанные через интерфейс **исимплеаудиоволуме** .</span><span class="sxs-lookup"><span data-stu-id="98c9e-152">The volume sliders in the **Applications** box in Sndvol reflect only volume changes that are made through the **ISimpleAudioVolume** interface.</span></span> <span data-ttu-id="98c9e-153">Они не отображают изменения томов, сделанные через интерфейсы **иаудиостреамволуме** и **ичаннелаудиоволуме** .</span><span class="sxs-lookup"><span data-stu-id="98c9e-153">They do not reflect volume changes that are made through the **IAudioStreamVolume** and **IChannelAudioVolume** interfaces.</span></span> <span data-ttu-id="98c9e-154">Хотя некоторые приложения могут позволить пользователям напрямую или косвенно управлять параметрами тома с помощью **иаудиостреамволуме** и **ичаннелаудиоволуме**, разработчикам следует избегать показа ползунков приложения для этих параметров, которые пользователи могут запутать с ползунками громкости в сндвол.</span><span class="sxs-lookup"><span data-stu-id="98c9e-154">Although some applications might enable users to directly or indirectly control volume settings through **IAudioStreamVolume** and **IChannelAudioVolume**, developers should avoid presenting application sliders for these volume settings that users are likely to confuse with the volume sliders in Sndvol.</span></span> <span data-ttu-id="98c9e-155">В противном случае пользователь может переместить ползунок приложения, ожидаемый, чтобы увидеть изменение, отраженное в Сндволм ползунке, и стать запутанным, если такое изменение не происходит.</span><span class="sxs-lookup"><span data-stu-id="98c9e-155">Otherwise, a user might move an application slider expecting to see the change reflected in a Sndvol slider and become confused when no such change occurs.</span></span> <span data-ttu-id="98c9e-156">Разработчики могут избежать этой проблемы с помощью тщательного проектирования пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="98c9e-156">Developers can avoid this problem through careful user interface design.</span></span>

<span data-ttu-id="98c9e-157">Эффективный уровень громкости любого канала в сеансе субмикс, как слышал на динамиках, — это произведение следующих четырех факторов уровня громкости:</span><span class="sxs-lookup"><span data-stu-id="98c9e-157">The effective volume level of any channel in the session submix, as heard at the speakers, is the product of the following four volume-level factors:</span></span>

-   <span data-ttu-id="98c9e-158">Уровни громкости на одном канале потоков в сеансе, которые клиенты могут контролировать с помощью методов в интерфейсе **иаудиостреамволуме** .</span><span class="sxs-lookup"><span data-stu-id="98c9e-158">The per-channel volume levels of the streams in the session, which clients can control through the methods in the **IAudioStreamVolume** interface.</span></span>
-   <span data-ttu-id="98c9e-159">Уровень громкости на уровне канала, который клиенты могут контролировать с помощью методов в интерфейсе **ичаннелаудиоволуме** .</span><span class="sxs-lookup"><span data-stu-id="98c9e-159">The per-channel volume level of the session, which clients can control through the methods in the **IChannelAudioVolume** interface.</span></span>
-   <span data-ttu-id="98c9e-160">Главный уровень громкости сеанса, который клиенты могут контролировать с помощью методов в интерфейсе **исимплеаудиоволуме** .</span><span class="sxs-lookup"><span data-stu-id="98c9e-160">The master volume level of the session, which clients can control through the methods in the **ISimpleAudioVolume** interface.</span></span>
-   <span data-ttu-id="98c9e-161">Уровень громкости сеанса, основанный на политиках, который динамически изменяется при изменении глобальных наборов.</span><span class="sxs-lookup"><span data-stu-id="98c9e-161">The policy-based volume level of the session, which the system dynamically modifies as the global mix changes.</span></span>

<span data-ttu-id="98c9e-162">Каждый из четырех факторов уровня громкости в приведенном выше списке представляет собой значение в диапазоне от 0,0 до 1,0, где 0,0 означает тишину, а 1,0 — полный том (без затухания).</span><span class="sxs-lookup"><span data-stu-id="98c9e-162">Each of the four volume-level factors in the preceding list is a value in the range 0.0 to 1.0, where 0.0 indicates silence and 1.0 indicates full volume (no attenuation).</span></span> <span data-ttu-id="98c9e-163">Действующий уровень громкости также является значением в диапазоне от 0,0 до 1,0.</span><span class="sxs-lookup"><span data-stu-id="98c9e-163">The effective volume level is also a value in the range 0.0 to 1.0.</span></span>

<span data-ttu-id="98c9e-164">Обработчик звука применяет действующий уровень громкости для каждого канала к каналам в потоке, прежде чем смешивать поток с другими потоками в сеансе аудио.</span><span class="sxs-lookup"><span data-stu-id="98c9e-164">The audio engine applies the effective volume level for each channel to the channels in a stream before mixing the stream with the other streams in the audio session.</span></span> <span data-ttu-id="98c9e-165">Если любые примеры значений в канале превышают 0 децибел после того, как звуковая подсистема умножает их на действующий уровень громкости, подсистема обрезает примеры перед их добавлением в сеанс субмикс.</span><span class="sxs-lookup"><span data-stu-id="98c9e-165">If any sample values in a channel exceed 0 decibels after the audio engine has multiplied them by the effective volume level, the engine clips the samples before adding them to the session submix.</span></span>

## <a name="related-topics"></a><span data-ttu-id="98c9e-166">См. также</span><span class="sxs-lookup"><span data-stu-id="98c9e-166">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="98c9e-167">Регуляторы громкости</span><span class="sxs-lookup"><span data-stu-id="98c9e-167">Volume Controls</span></span>](volume-controls.md)
</dt> </dl>

 

 



