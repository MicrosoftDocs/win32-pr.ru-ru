---
description: Перечисление звуковых устройств
ms.assetid: 20110ffc-5eff-4279-abea-53115803b6ee
title: Перечисление звуковых устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 707b9a88181c83344757c711af1c0199c19ebc16
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072471"
---
# <a name="enumerating-audio-devices"></a>Перечисление звуковых устройств

Первая задача клиентского звукового приложения — найти подходящее звуковое устройство для использования. [API ммдевице](mmdevice-api.md) позволяет клиентам обнаруживать [устройства конечных точек аудио](audio-endpoint-devices.md) в системе и определять, какие устройства подходят для использования приложением. Этот API позволяет клиентам получать коллекции доступных оконечных устройств и получать возможности каждого устройства. Файл заголовка Ммдевицеапи. h определяет интерфейсы в API Ммдевице.

Звуковой адаптер может содержать несколько устройств, например устройство отображения звуковых данных и устройство записи звука. Это устройства адаптеров, а не конечные устройства. Как упоминалось ранее, устройства адаптеров регистрируются диспетчером самонастраивающийся, в отличие от устройств конечных точек, зарегистрированных диспетчером конечных точек. Каждое устройство адаптера обычно поддерживает одно или несколько конечных устройств. Устройство конечной точки отрисовки (например, наушники) может получать поток звуковых данных из клиентского приложения, а устройство с конечной точкой записи (например, микрофон) может отправлять аудиопоток в клиентское приложение.

Перед перечислением устройств конечной точки в системе Клиент должен сначала вызвать функцию Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) , чтобы создать перечислитель устройства. Перечислитель устройств — это объект с интерфейсом [**иммдевицеенумератор**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) . Дополнительные сведения о **CoCreateInstance** см. в документации по Windows SDK.

Клиент вызывает метод [**иммдевицеенумератор:: енумаудиоендпоинтс**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) для создания коллекции объектов Endpoint. Каждый объект конечной точки представляет устройство звуковой конечной точки в системе. В этом вызове клиент указывает, должна ли коллекция содержать все устройства отрисовки в системе, все устройства записи или и то, и другое.

Коллекция устройств — это объект с интерфейсом [**иммдевицеколлектион**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) . Каждый элемент в коллекции устройств является объектом конечной точки по крайней мере с двумя следующими интерфейсами:

-   Интерфейс [**иммдевице**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) . Клиент получает ссылку на интерфейс **иммдевице** объекта конечной точки в коллекции устройств, вызывая метод [**Иммдевицеколлектион:: Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) .
-   Интерфейс [**иммендпоинт**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) . Клиент получает ссылку на интерфейс **иммендпоинт** объекта конечной точки, вызывая метод [**Иммдевице:: QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) .

После получения коллекции устройств конечной точки клиент может запросить свойства отдельных устройств в коллекции, чтобы определить их пригодность для использования. Пример кода, показывающий, как перечислить устройства конечной точки и запрашивать их свойства, см. в разделе [Свойства устройства](device-properties.md).

После выбора подходящего устройства клиент может вызвать метод [**иммдевице:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) для активации интерфейсов, зависящих от устройства, в [Васапи](wasapi.md), [API девицетопологи](devicetopology-api.md)и [API ендпоинтволуме](endpointvolume-api.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Устройства конечных точек звука](audio-endpoint-devices.md)
</dt> </dl>

 

 
