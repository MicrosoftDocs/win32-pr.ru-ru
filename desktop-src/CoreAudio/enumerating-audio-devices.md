---
description: Перечисление звуковых устройств
ms.assetid: 20110ffc-5eff-4279-abea-53115803b6ee
title: Перечисление звуковых устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 707b9a88181c83344757c711af1c0199c19ebc16
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072471"
---
# <a name="enumerating-audio-devices"></a><span data-ttu-id="82e72-103">Перечисление звуковых устройств</span><span class="sxs-lookup"><span data-stu-id="82e72-103">Enumerating Audio Devices</span></span>

<span data-ttu-id="82e72-104">Первая задача клиентского звукового приложения — найти подходящее звуковое устройство для использования.</span><span class="sxs-lookup"><span data-stu-id="82e72-104">The first task of a client audio application is to find a suitable audio device to use.</span></span> <span data-ttu-id="82e72-105">[API ммдевице](mmdevice-api.md) позволяет клиентам обнаруживать [устройства конечных точек аудио](audio-endpoint-devices.md) в системе и определять, какие устройства подходят для использования приложением.</span><span class="sxs-lookup"><span data-stu-id="82e72-105">The [MMDevice API](mmdevice-api.md) lets clients discover the [audio endpoint devices](audio-endpoint-devices.md) in the system and determine which devices are suitable for the application to use.</span></span> <span data-ttu-id="82e72-106">Этот API позволяет клиентам получать коллекции доступных оконечных устройств и получать возможности каждого устройства.</span><span class="sxs-lookup"><span data-stu-id="82e72-106">This API enables clients to retrieve collections of the available endpoint devices and get the capabilities of each device.</span></span> <span data-ttu-id="82e72-107">Файл заголовка Ммдевицеапи. h определяет интерфейсы в API Ммдевице.</span><span class="sxs-lookup"><span data-stu-id="82e72-107">Header file Mmdeviceapi.h defines the interfaces in the MMDevice API.</span></span>

<span data-ttu-id="82e72-108">Звуковой адаптер может содержать несколько устройств, например устройство отображения звуковых данных и устройство записи звука.</span><span class="sxs-lookup"><span data-stu-id="82e72-108">An audio adapter might contain several devices—for example, a wave-rendering device and a wave-capture device.</span></span> <span data-ttu-id="82e72-109">Это устройства адаптеров, а не конечные устройства.</span><span class="sxs-lookup"><span data-stu-id="82e72-109">These are adapter devices rather than endpoint devices.</span></span> <span data-ttu-id="82e72-110">Как упоминалось ранее, устройства адаптеров регистрируются диспетчером самонастраивающийся, в отличие от устройств конечных точек, зарегистрированных диспетчером конечных точек.</span><span class="sxs-lookup"><span data-stu-id="82e72-110">As mentioned previously, adapter devices are registered by the Plug and Play manager, in contrast with endpoint devices, which are registered by the endpoint manager.</span></span> <span data-ttu-id="82e72-111">Каждое устройство адаптера обычно поддерживает одно или несколько конечных устройств.</span><span class="sxs-lookup"><span data-stu-id="82e72-111">Each adapter device typically supports one or more endpoint devices.</span></span> <span data-ttu-id="82e72-112">Устройство конечной точки отрисовки (например, наушники) может получать поток звуковых данных из клиентского приложения, а устройство с конечной точкой записи (например, микрофон) может отправлять аудиопоток в клиентское приложение.</span><span class="sxs-lookup"><span data-stu-id="82e72-112">A rendering endpoint device (for example, headphones) can receive a stream of audio data from a client application, and a capture endpoint device (for example, a microphone) can send an audio stream to a client application.</span></span>

<span data-ttu-id="82e72-113">Перед перечислением устройств конечной точки в системе Клиент должен сначала вызвать функцию Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) , чтобы создать перечислитель устройства.</span><span class="sxs-lookup"><span data-stu-id="82e72-113">Before enumerating the endpoint devices in the system, the client must first call the Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to create a device enumerator.</span></span> <span data-ttu-id="82e72-114">Перечислитель устройств — это объект с интерфейсом [**иммдевицеенумератор**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) .</span><span class="sxs-lookup"><span data-stu-id="82e72-114">A device enumerator is an object with an [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) interface.</span></span> <span data-ttu-id="82e72-115">Дополнительные сведения о **CoCreateInstance** см. в документации по Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="82e72-115">For information about **CoCreateInstance**, see the Windows SDK documentation.</span></span>

<span data-ttu-id="82e72-116">Клиент вызывает метод [**иммдевицеенумератор:: енумаудиоендпоинтс**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) для создания коллекции объектов Endpoint.</span><span class="sxs-lookup"><span data-stu-id="82e72-116">The client calls the [**IMMDeviceEnumerator::EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) method to create a collection of endpoint objects.</span></span> <span data-ttu-id="82e72-117">Каждый объект конечной точки представляет устройство звуковой конечной точки в системе.</span><span class="sxs-lookup"><span data-stu-id="82e72-117">Each endpoint object represents an audio endpoint device in the system.</span></span> <span data-ttu-id="82e72-118">В этом вызове клиент указывает, должна ли коллекция содержать все устройства отрисовки в системе, все устройства записи или и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="82e72-118">In this call, the client specifies whether the collection should contain all of the rendering devices in the system, all of the capture devices, or both.</span></span>

<span data-ttu-id="82e72-119">Коллекция устройств — это объект с интерфейсом [**иммдевицеколлектион**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) .</span><span class="sxs-lookup"><span data-stu-id="82e72-119">A device collection is an object with an [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) interface.</span></span> <span data-ttu-id="82e72-120">Каждый элемент в коллекции устройств является объектом конечной точки по крайней мере с двумя следующими интерфейсами:</span><span class="sxs-lookup"><span data-stu-id="82e72-120">Each item in a device collection is an endpoint object with at least the following two interfaces:</span></span>

-   <span data-ttu-id="82e72-121">Интерфейс [**иммдевице**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) .</span><span class="sxs-lookup"><span data-stu-id="82e72-121">An [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) interface.</span></span> <span data-ttu-id="82e72-122">Клиент получает ссылку на интерфейс **иммдевице** объекта конечной точки в коллекции устройств, вызывая метод [**Иммдевицеколлектион:: Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) .</span><span class="sxs-lookup"><span data-stu-id="82e72-122">A client obtains a reference to the **IMMDevice** interface of an endpoint object in a device collection by calling the [**IMMDeviceCollection::Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) method.</span></span>
-   <span data-ttu-id="82e72-123">Интерфейс [**иммендпоинт**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) .</span><span class="sxs-lookup"><span data-stu-id="82e72-123">An [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) interface.</span></span> <span data-ttu-id="82e72-124">Клиент получает ссылку на интерфейс **иммендпоинт** объекта конечной точки, вызывая метод [**Иммдевице:: QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) .</span><span class="sxs-lookup"><span data-stu-id="82e72-124">A client obtains a reference to the **IMMEndpoint** interface of an endpoint object by calling the [**IMMDevice::QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span>

<span data-ttu-id="82e72-125">После получения коллекции устройств конечной точки клиент может запросить свойства отдельных устройств в коллекции, чтобы определить их пригодность для использования.</span><span class="sxs-lookup"><span data-stu-id="82e72-125">After retrieving a collection of endpoint devices, the client can query the properties of the individual devices in the collection to determine their suitability for use.</span></span> <span data-ttu-id="82e72-126">Пример кода, показывающий, как перечислить устройства конечной точки и запрашивать их свойства, см. в разделе [Свойства устройства](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="82e72-126">For a code example that shows how to enumerate endpoint devices and query their properties, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="82e72-127">После выбора подходящего устройства клиент может вызвать метод [**иммдевице:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) для активации интерфейсов, зависящих от устройства, в [Васапи](wasapi.md), [API девицетопологи](devicetopology-api.md)и [API ендпоинтволуме](endpointvolume-api.md).</span><span class="sxs-lookup"><span data-stu-id="82e72-127">After selecting a suitable device, the client can call the [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) method to activate the device-specific interfaces in [WASAPI](wasapi.md), the [DeviceTopology API](devicetopology-api.md), and the [EndpointVolume API](endpointvolume-api.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="82e72-128">См. также</span><span class="sxs-lookup"><span data-stu-id="82e72-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="82e72-129">Устройства конечных точек звука</span><span class="sxs-lookup"><span data-stu-id="82e72-129">Audio Endpoint Devices</span></span>](audio-endpoint-devices.md)
</dt> </dl>

 

 
