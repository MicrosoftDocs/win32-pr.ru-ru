---
description: Устройства конечных точек звука
ms.assetid: 773714fb-3b00-4f03-988f-05c5835f87cf
title: Устройства конечных точек звука
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c14d21aa174e34f8cb4ddab520819446a0e0ec89
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103990775"
---
# <a name="audio-endpoint-devices"></a><span data-ttu-id="6b7af-103">Устройства конечных точек звука</span><span class="sxs-lookup"><span data-stu-id="6b7af-103">Audio Endpoint Devices</span></span>

<span data-ttu-id="6b7af-104">Термин *устройство конечной точки* относится к аппаратному устройству, которое находится на одном конце пути данных, который создается или завершается в прикладной программе.</span><span class="sxs-lookup"><span data-stu-id="6b7af-104">The term *endpoint device* refers to a hardware device that lies at one end of a data path that originates or terminates at an application program.</span></span> <span data-ttu-id="6b7af-105">Примеры устройств конечных точек аудио — это динамики, наушники, микрофоны и проигрыватели компакт-дисков.</span><span class="sxs-lookup"><span data-stu-id="6b7af-105">Examples of audio endpoint devices are speakers, headphones, microphones, and CD players.</span></span> <span data-ttu-id="6b7af-106">Звуковые данные, перемещаемые по пути к данным, могут перемещаться по количеству программных и аппаратных компонентов во время его поездки между приложением и конечным устройством.</span><span class="sxs-lookup"><span data-stu-id="6b7af-106">The audio data that moves along the data path might traverse a number of software and hardware components during its journey between the application and endpoint device.</span></span> <span data-ttu-id="6b7af-107">Хотя эти компоненты являются важными для работы устройства конечной точки, они, как правило, являются невидимыми для пользователей.</span><span class="sxs-lookup"><span data-stu-id="6b7af-107">Although these components are essential to the operation of the endpoint device, they tend to be invisible to users.</span></span> <span data-ttu-id="6b7af-108">Пользователи, скорее всего, будут думать об устройствах конечных точек, которые они напрямую управляют, а не с точки зрения устройств на звуковых адаптерах, подключаемых к конечным устройствам или в терминах программных компонентов, обрабатывающих звуковые потоки и из этих адаптеров.</span><span class="sxs-lookup"><span data-stu-id="6b7af-108">Users are more likely to think in terms of endpoint devices that they directly manipulate rather than in terms of the devices on audio adapters that the endpoint devices plug into or in terms of the software components that process the audio streams that flow to and from these adapters.</span></span>

<span data-ttu-id="6b7af-109">Чтобы избежать путаницы с устройствами конечных точек, эта документация относится к устройству на звуковом адаптере в качестве *устройства адаптера*.</span><span class="sxs-lookup"><span data-stu-id="6b7af-109">To avoid confusion with endpoint devices, this documentation refers to a device on an audio adapter as an *adapter device*.</span></span>

<span data-ttu-id="6b7af-110">На следующей схеме показано, как устройства конечных точек аудио отличаются от устройств адаптеров.</span><span class="sxs-lookup"><span data-stu-id="6b7af-110">The following diagram shows how audio endpoint devices differ from adapter devices.</span></span>

![Примеры устройств конечных точек аудио и адаптеров](images/devices.jpg)

<span data-ttu-id="6b7af-112">Ниже приведены примеры устройств конечной точки на предыдущей схеме.</span><span class="sxs-lookup"><span data-stu-id="6b7af-112">In the preceding diagram, the following are examples of endpoint devices:</span></span>

-   <span data-ttu-id="6b7af-113">Speakers</span><span class="sxs-lookup"><span data-stu-id="6b7af-113">Speakers</span></span>
-   <span data-ttu-id="6b7af-114">Микрофон</span><span class="sxs-lookup"><span data-stu-id="6b7af-114">Microphone</span></span>
-   <span data-ttu-id="6b7af-115">Дополнительное устройство ввода</span><span class="sxs-lookup"><span data-stu-id="6b7af-115">Auxiliary input device</span></span>

<span data-ttu-id="6b7af-116">Ниже приведены примеры устройств адаптеров.</span><span class="sxs-lookup"><span data-stu-id="6b7af-116">The following are examples of adapter devices:</span></span>

-   <span data-ttu-id="6b7af-117">Устройство вывода Wave (содержит цифровой, аналоговый преобразователь)</span><span class="sxs-lookup"><span data-stu-id="6b7af-117">Wave output device (contains digital-to-analog converter)</span></span>
-   <span data-ttu-id="6b7af-118">Устройство вывода элементы управления (содержит тома и элементы управления выключением)</span><span class="sxs-lookup"><span data-stu-id="6b7af-118">Output controls device (contains volume and mute controls)</span></span>
-   <span data-ttu-id="6b7af-119">Устройство ввода звука (содержит аналогово-цифровой преобразователь)</span><span class="sxs-lookup"><span data-stu-id="6b7af-119">Wave input device (contains analog-to-digital converter)</span></span>
-   <span data-ttu-id="6b7af-120">Устройство элементов управления вводом (содержит регулятор громкости и мультиплексор)</span><span class="sxs-lookup"><span data-stu-id="6b7af-120">Input controls device (contains volume control and multiplexer)</span></span>

<span data-ttu-id="6b7af-121">Как правило, пользовательские интерфейсы звуковых приложений ссылаются на устройства конечных точек аудио, а не на адаптеры устройств.</span><span class="sxs-lookup"><span data-stu-id="6b7af-121">Typically, the user interfaces of audio applications refer to audio endpoint devices, not to adapter devices.</span></span> <span data-ttu-id="6b7af-122">Windows Vista упрощает проектирование ориентированных на пользователей приложений, напрямую поддерживая абстракцию устройства конечной точки.</span><span class="sxs-lookup"><span data-stu-id="6b7af-122">Windows Vista simplifies the design of user-friendly applications by directly supporting the endpoint device abstraction.</span></span>

<span data-ttu-id="6b7af-123">Некоторые конечные устройства могут постоянно подключаться к устройству адаптера.</span><span class="sxs-lookup"><span data-stu-id="6b7af-123">Some endpoint devices might permanently connect to an adapter device.</span></span> <span data-ttu-id="6b7af-124">Например, компьютер может содержать внутренние устройства, такие как проигрыватель компакт-дисков, микрофон или динамики, интегрированные в корпус системы.</span><span class="sxs-lookup"><span data-stu-id="6b7af-124">For example, a computer might contain internal devices such as a CD player, a microphone, or speakers that are integrated into the system chassis.</span></span> <span data-ttu-id="6b7af-125">Как правило, пользователь физически не удаляет эти устройства конечных точек.</span><span class="sxs-lookup"><span data-stu-id="6b7af-125">Typically, the user does not physically remove these endpoint devices.</span></span>

<span data-ttu-id="6b7af-126">Другие конечные устройства могут подключаться к звуковому адаптеру через аудиоразъемы.</span><span class="sxs-lookup"><span data-stu-id="6b7af-126">Other endpoint devices might connect to an audio adapter through audio jacks.</span></span> <span data-ttu-id="6b7af-127">Пользователь подключает и отсоединяет эти внешние устройства.</span><span class="sxs-lookup"><span data-stu-id="6b7af-127">The user plugs in and unplugs these external devices.</span></span> <span data-ttu-id="6b7af-128">Например, устройство конечной точки звука, такое как внешний микрофон или наушники, находится на одном конце кабеля, а другой завершает подключение к гнезду на устройстве адаптера.</span><span class="sxs-lookup"><span data-stu-id="6b7af-128">For example, an audio endpoint device such as an external microphone or headphones lies at one end of a cable whose other end plugs into a jack on an adapter device.</span></span>

<span data-ttu-id="6b7af-129">Адаптер взаимодействует с системным процессором через системную шину (как правило, PCI или PCI Express) или внешнюю шину (USB или IEEE 1394), которая поддерживает самонастраивающийся (PnP).</span><span class="sxs-lookup"><span data-stu-id="6b7af-129">The adapter communicates with the system processor through a system bus (typically, PCI or PCI Express) or external bus (USB or IEEE 1394) that supports Plug and Play (PnP).</span></span> <span data-ttu-id="6b7af-130">Во время перечисления устройств диспетчер самонастраивающийся определяет устройства в звуковом адаптере и регистрирует эти устройства, чтобы сделать их доступными для использования операционной системой и приложениями.</span><span class="sxs-lookup"><span data-stu-id="6b7af-130">During device enumeration, the Plug and Play manager identifies the devices in the audio adapter and registers those devices to make them available for use by the operating system and by applications.</span></span>

<span data-ttu-id="6b7af-131">В отличие от подключения между адаптером и внешней шиной, такой как USB или шина IEEE 1394, подключение между устройством конечной точки и устройством адаптера не поддерживает обнаружение устройств PnP.</span><span class="sxs-lookup"><span data-stu-id="6b7af-131">Unlike the connection between an adapter and an external bus such as USB or the IEEE 1394 bus, the connection between an endpoint device and an adapter device does not support PnP device detection.</span></span> <span data-ttu-id="6b7af-132">Однако некоторые звуковые адаптеры поддерживают *обнаружение наличия разъемов*: при вставке или удалении подключаемого модуля из гнезда оборудование создает прерывание, чтобы уведомить драйвер адаптера об изменении в конфигурации оборудования.</span><span class="sxs-lookup"><span data-stu-id="6b7af-132">However, some audio adapters support *jack-presence detection*: when a plug is inserted into or removed from a jack, the hardware generates an interrupt to notify the adapter driver of the change in the hardware configuration.</span></span> <span data-ttu-id="6b7af-133">Диспетчер конечных точек в Windows Vista может использовать эту возможность оборудования для уведомления приложений о наличии конечных устройств в любое время.</span><span class="sxs-lookup"><span data-stu-id="6b7af-133">The endpoint manager in Windows Vista can exploit this hardware capability to notify applications which endpoint devices are present at any time.</span></span> <span data-ttu-id="6b7af-134">Таким образом, операция диспетчера конечных точек аналогична работе диспетчера самонастраивающийся, который отслеживает устройства адаптеров, имеющиеся в системе.</span><span class="sxs-lookup"><span data-stu-id="6b7af-134">In this way, the operation of the endpoint manager is analogous to that of the Plug and Play manager, which keeps track of the adapter devices that are present in the system.</span></span>

<span data-ttu-id="6b7af-135">В Windows Vista звуковая система отслеживает как оконечные устройства, так и адаптеры.</span><span class="sxs-lookup"><span data-stu-id="6b7af-135">In Windows Vista, the audio system keeps track of both endpoint devices and adapter devices.</span></span> <span data-ttu-id="6b7af-136">Диспетчер конечных точек регистрирует устройства конечных точек, а диспетчер самонастраивающийся регистрирует устройства адаптеров.</span><span class="sxs-lookup"><span data-stu-id="6b7af-136">The endpoint manager registers endpoint devices and the Plug and Play manager registers adapter devices.</span></span> <span data-ttu-id="6b7af-137">Регистрация устройств конечных точек упрощает работу с пользовательскими приложениями, позволяя пользователям обращаться к устройствам конечных точек, которые непосредственно манипулируют пользователями, вместо того, чтобы ссылаться на устройства адаптеров, которые могут быть скрыты внутри корпуса компьютера.</span><span class="sxs-lookup"><span data-stu-id="6b7af-137">Registering endpoint devices makes it easier for user-friendly applications to enable users to refer to the endpoint devices that users directly manipulate instead of referring to adapter devices that might be hidden inside the computer chassis.</span></span> <span data-ttu-id="6b7af-138">Устройства конечных точек, сообщаемые операционной системой, точно следят за динамическими изменениями в конфигурации звукового оборудования с обнаружением присутствия.</span><span class="sxs-lookup"><span data-stu-id="6b7af-138">The endpoint devices that are reported by the operating system faithfully track dynamic changes in the configuration of audio hardware that has jack-presence detection.</span></span> <span data-ttu-id="6b7af-139">Когда устройство конечной точки остается подключенным, система перечисляет это устройство.</span><span class="sxs-lookup"><span data-stu-id="6b7af-139">While an endpoint device remains plugged in, the system enumerates that device.</span></span> <span data-ttu-id="6b7af-140">Когда пользователь отключается от устройства конечной точки, система прекращает его перечисление.</span><span class="sxs-lookup"><span data-stu-id="6b7af-140">When the user unplugs an endpoint device, the system ceases to enumerate it.</span></span>

<span data-ttu-id="6b7af-141">В более ранних версиях Windows, включая Windows 98, Windows Me, Windows 2000 и Windows XP, система явным образом предоставляет приложениям только устройства PnP.</span><span class="sxs-lookup"><span data-stu-id="6b7af-141">In earlier versions of Windows, including Windows 98, Windows Me, Windows 2000, and Windows XP, the system explicitly presents only PnP devices to applications.</span></span> <span data-ttu-id="6b7af-142">Таким же приложениям необходимо определить существование конечных устройств.</span><span class="sxs-lookup"><span data-stu-id="6b7af-142">Thus, applications must infer the existence of endpoint devices.</span></span> <span data-ttu-id="6b7af-143">Операционная система, в которой отсутствует явная поддержка для конечных устройств, заставляет клиентские приложения выполнять большую часть работы.</span><span class="sxs-lookup"><span data-stu-id="6b7af-143">An operating system that lacks explicit support for endpoint devices forces client applications to do more of the work themselves.</span></span> <span data-ttu-id="6b7af-144">Например, приложение для записи звука должно выполнить следующие действия, чтобы включить запись из внешнего микрофона:</span><span class="sxs-lookup"><span data-stu-id="6b7af-144">For example, an audio capture application must perform the following steps to enable capturing from an external microphone:</span></span>

1.  <span data-ttu-id="6b7af-145">Перечислите все устройства записи звука (это устройства адаптеров), которые ранее были зарегистрированы диспетчером PnP.</span><span class="sxs-lookup"><span data-stu-id="6b7af-145">Enumerate all the audio capture devices (these are adapter devices) that were previously registered by the PnP manager.</span></span>
2.  <span data-ttu-id="6b7af-146">После выбора устройства записи откройте поток записи на устройстве, вызвав функцию **вавеинопен** или используя API **директсаундкаптуре** или DirectShow.</span><span class="sxs-lookup"><span data-stu-id="6b7af-146">After selecting a capture device, open a capture stream on the device by either calling the **waveInOpen** function or by using the **DirectSoundCapture** or DirectShow API.</span></span>
3.  <span data-ttu-id="6b7af-147">Вызовите функцию Миксеропен и используйте другие функции **миксеркскскс** , чтобы найти \_ \_ \_ строку микрофона миксерлине параметра ComponentType src, соответствующую устройству записи, открытому на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="6b7af-147">Call the mixerOpen function and use the other **mixerXxx** functions to look for a MIXERLINE\_COMPONENTTYPE\_SRC\_MICROPHONE line that corresponds to the capture device opened in step 2.</span></span> <span data-ttu-id="6b7af-148">Это обоснованное предположение.</span><span class="sxs-lookup"><span data-stu-id="6b7af-148">This is an educated guess.</span></span>
4.  <span data-ttu-id="6b7af-149">Разблокируйте путь к данным с микрофона.</span><span class="sxs-lookup"><span data-stu-id="6b7af-149">Unblock the data path from the microphone.</span></span> <span data-ttu-id="6b7af-150">Если путь к данным включает в себя узел со звуком, то клиент должен отключить микрофон сигнала с микрофона.</span><span class="sxs-lookup"><span data-stu-id="6b7af-150">If the data path includes a mute node, then the client must disable muting of the signal from the microphone.</span></span> <span data-ttu-id="6b7af-151">Если устройство записи содержит мультиплексор для выбора из нескольких входных данных, клиент должен выбрать входной микрофон.</span><span class="sxs-lookup"><span data-stu-id="6b7af-151">If the capture device contains a multiplexer for selecting from among several inputs, then the client must select the microphone input.</span></span>

<span data-ttu-id="6b7af-152">Этот процесс является подверженным ошибкам, так как программное обеспечение, выполняющее эти операции, может завершиться ошибкой, если обнаруживает конфигурацию оборудования, которую конструкторы не ожидали или для которых она не была протестирована.</span><span class="sxs-lookup"><span data-stu-id="6b7af-152">This process is error-prone because the software that performs these operations might fail if it encounters a hardware configuration that its designers did not anticipate or for which it was not tested.</span></span>

<span data-ttu-id="6b7af-153">В Windows Vista, поддерживающем устройства конечных точек, процесс подключения к тому же устройству конечной точки гораздо проще:</span><span class="sxs-lookup"><span data-stu-id="6b7af-153">In Windows Vista, which supports endpoint devices, the process of connecting to the same endpoint device is much simpler:</span></span>

1.  <span data-ttu-id="6b7af-154">Выберите микрофон из коллекции устройств конечной точки.</span><span class="sxs-lookup"><span data-stu-id="6b7af-154">Select a microphone from a collection of endpoint devices.</span></span>
2.  <span data-ttu-id="6b7af-155">Активируйте интерфейс захвата звука на этом микрофоне.</span><span class="sxs-lookup"><span data-stu-id="6b7af-155">Activate an audio-capture interface on that microphone.</span></span>

<span data-ttu-id="6b7af-156">Операционная система выполняет всю работу, необходимую для обнаружения и включения устройства конечной точки.</span><span class="sxs-lookup"><span data-stu-id="6b7af-156">The operating system does all the work necessary to identify and enable the endpoint device.</span></span> <span data-ttu-id="6b7af-157">Например, если путь к данным из микрофона включает мультиплексор, система автоматически выбирает входные данные микрофона для мультиплексора.</span><span class="sxs-lookup"><span data-stu-id="6b7af-157">For example, if the data path from the microphone includes a multiplexer, the system automatically selects the microphone input to the multiplexer.</span></span>

<span data-ttu-id="6b7af-158">Поведение звуковой подсистемы является более надежным и детерминированным, если приложения вместо реализации собственных алгоритмов идентификации конечных точек могут низводить задачу определения устройств конечной точки операционной системе.</span><span class="sxs-lookup"><span data-stu-id="6b7af-158">The behavior of the audio subsystem is more reliable and deterministic if applications, instead of implementing their own endpoint-identification algorithms, can relegate the task of identifying endpoint devices to the operating system.</span></span> <span data-ttu-id="6b7af-159">Поставщикам программного обеспечения больше не нужно проверять, правильно ли работают алгоритмы идентификации конечных точек со всеми доступными устройствами и конфигурациями звуковых устройств. они могут просто полагаться на операционную систему для идентификации конечных точек.</span><span class="sxs-lookup"><span data-stu-id="6b7af-159">Software vendors no longer need to verify that their endpoint-identification algorithms work correctly with all available audio hardware devices and configurations—they can simply rely on the operating system for endpoint identification.</span></span> <span data-ttu-id="6b7af-160">Аналогичным образом поставщики оборудования больше не нуждаются в проверке того, что каждое соответствующее клиентское приложение может легко определить любое устройство конечной точки, подключенное к своему звуковому адаптеру. это необходимо только для того, чтобы убедиться, что операционная система может определить устройство конечной точки, подключенное к своему звуковому адаптеру.</span><span class="sxs-lookup"><span data-stu-id="6b7af-160">Similarly, hardware vendors no longer need to verify that every relevant client application can readily identify any endpoint device that is connected to their audio adapter—they need only to verify that the operating system can identify an endpoint device that is connected to their audio adapter.</span></span>

<span data-ttu-id="6b7af-161">В следующих разделах приведены дополнительные сведения об устройствах аудио конечных точек.</span><span class="sxs-lookup"><span data-stu-id="6b7af-161">The following topics provide additional information about audio endpoint devices:</span></span>

-   [<span data-ttu-id="6b7af-162">Сведения об API Ммдевице</span><span class="sxs-lookup"><span data-stu-id="6b7af-162">About MMDevice API</span></span>](mmdevice-api.md)
-   [<span data-ttu-id="6b7af-163">Перечисление звуковых устройств</span><span class="sxs-lookup"><span data-stu-id="6b7af-163">Enumerating Audio Devices</span></span>](enumerating-audio-devices.md)
-   [<span data-ttu-id="6b7af-164">Строки идентификатора конечной точки</span><span class="sxs-lookup"><span data-stu-id="6b7af-164">Endpoint ID Strings</span></span>](endpoint-id-strings.md)
-   [<span data-ttu-id="6b7af-165">Свойства устройства</span><span class="sxs-lookup"><span data-stu-id="6b7af-165">Device Properties</span></span>](device-properties.md)
-   [<span data-ttu-id="6b7af-166">События устройства</span><span class="sxs-lookup"><span data-stu-id="6b7af-166">Device Events</span></span>](device-events.md)
-   [<span data-ttu-id="6b7af-167">Роли устройств</span><span class="sxs-lookup"><span data-stu-id="6b7af-167">Device Roles</span></span>](device-roles.md)
-   [<span data-ttu-id="6b7af-168">Форматы устройств</span><span class="sxs-lookup"><span data-stu-id="6b7af-168">Device Formats</span></span>](device-formats.md)

## <a name="related-topics"></a><span data-ttu-id="6b7af-169">См. также</span><span class="sxs-lookup"><span data-stu-id="6b7af-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6b7af-170">Руководство по программированию</span><span class="sxs-lookup"><span data-stu-id="6b7af-170">Programming Guide</span></span>](programming-guide.md)
</dt> </dl>

 

 



