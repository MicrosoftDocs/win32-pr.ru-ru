---
description: Пространственный звук Майкрософт — это решение на уровне платформы для поддержки пространственного звука в Xbox, Windows и HoloLens 2, обеспечивающее как окружающие, так и повышенные звуковые подсказки (выше или ниже прослушивателя).
ms.assetid: 4F962F1A-CA4A-4018-BA97-516EA3519650
title: 'Spatial Sound для разработчиков '
ms.custom: contperf-fy21q1
ms.topic: article
ms.date: 09/18/2020
ms.openlocfilehash: 9db3614ea7932af874da351e7a92980d51b90011
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/04/2021
ms.locfileid: "104560851"
---
# <a name="spatial-sound-for-developers"></a>Spatial Sound для разработчиков 
> [!Note] 
> Эта документация предназначена для аудитории разработчиков. Сведения о поддержке конечных пользователей для включения пространственного звука на устройстве см. [в статье Включение пространственного звука в Windows 10](https://support.microsoft.com/help/4563140/how-to-turn-on-spatial-sound-in-windows-10).

Пространственный звук Майкрософт — это решение на уровне платформы для поддержки пространственного звука в Xbox, Windows и HoloLens 2, обеспечивающее как окружающие, так и повышенные звуковые подсказки (выше или ниже прослушивателя). Пространственный звук можно использовать в приложениях Windows Desktop (Win32), а также в приложениях универсальная платформа Windows (UWP) на поддерживаемых платформах. API-интерфейсы пространственного звука позволяют разработчикам создавать звуковые объекты, которые выдают звук из положения в трехмерном пространстве. Динамические объекты Audio позволяют выдавать звук из произвольного места в пространстве, что может меняться со временем. Также можно указать, что звуковые объекты выдают звук с одного из 17 стандартных статических каналов (8.1.4.4), которые могут представлять реальные или виртуализованные динамики. Текущий выходной формат выбирается пользователем и может быть абстрактным от реализаций пространственного звука Майкрософт. звук будет представлен существующим докладчикам, наушникам и получателям домашнего кинотеатра без изменения кода или содержимого. Платформа полностью поддерживает кодировку Dolby атмос в режиме реального времени для выходных и стереофонических наушников, DTS: X для наушников и кодирование Windows Sonic для наушников для стерео-наушников. Наконец, пространственные звуковые приложения Майкрософт придерживается политики смешанного смешения системы, и их звук также будет смешиваться с приложениями, не поддерживающими пространственное использование. Поддержка пространственного звука Майкрософт также интегрирована в Media Foundation; приложения, использующие Media Foundation, могут успешно воспроизводить содержимое Dolby атмос без дополнительной реализации.

Пространственный звук с пространственным звуковым сопровождением Майкрософт поддерживает телевизоры, Домашние кинотеатры и звуковые панели, поддерживающие Dolby атмос. Пространственный звук можно также использовать с любой парой наушников, которыми может владеть потребитель, с помощью аудио, отображаемой платформой, с использованием Windows Sonic для наушников, Dolby атмос для наушников или служб DTS: X.


## <a name="enabling-microsoft-spatial-sound"></a>Включение пространственного звука Майкрософт

Независимо от того, как разработчик или потребитель, пользователь должен включить Пространственный звук Майкрософт на устройстве, чтобы прослушать Пространственный звук.

### <a name="windows"></a>Windows
На компьютерах с Windows это делается через страницу свойств для заданного звукового устройства вывода. На панели управления **звуком** выберите выходное устройство и щелкните **Свойства устройства**. В разделе " **Пространственный звук** " страницы, если устройство поддерживает Пространственный звук, можно выбрать один из доступных форматов в раскрывающемся списке **пространственный звуковой формат** .

![Включение пространственного звука на панели управления звуком](images/spatialsoundsettingswindows1.png)

Можно также включить Пространственный звук Майкрософт, щелкнув правой кнопкой мыши значок **тома** на панели задач.

![Включение пространственного звука с панели задач](images/spatialsoundsettingswindows2.png)

### <a name="xbox-one"></a>Xbox One
На Xbox One функции пространственного звука Microsoft всегда доступны для потребителя и доступны через приложение "Параметры" в разделе **Общие — > том & звуковые выходные данные**.


![Включение пространственного звука на Xbox One в приложении "Параметры" ](images/audiosettingsbitstream.png)

После того как Dolby атмос для домашнего кинотеатра выбран в качестве формата битовый поток, поддержка этого формата проверяется с помощью расширенных отображаемых идентификационных данных HDMI (EDID). Если устройство HDMI не поддерживает этот формат, пользователю выводится сообщение об ошибке. Обратите внимание, что при первом выборе этого параметра пользователю необходимо скачать приложение Dolby Access.

Если для **аудиоустройства HDMI** выбран формат, отличный от "битовый поток Out", раскрывающийся список **формата битовый поток** отключен.

![Пространственный звук отключен на Xbox One в приложении "Параметры" ](images/audiosettingsplain.png)

Выберите Dolby атмос для наушников, DTS Наушники: X или Windows Sonic для наушников в раскрывающемся списке в **формате гарнитуры** в поле **Аудио гарнитура**

![Включение пространственного звука для наушников на Xbox One в приложении "Параметры" ](images/audiosettingsheadphone.png)

Если Пространственный звук Майкрософт недоступен (например, при воспроизведении на встроенных стереодинамиках ноутбука или если пользователь явно не включил Пространственный звук Майкрософт в указанное выше поле), число доступных динамических объектов, возвращаемых функцией [**испатиалаудиоклиент:: жетмаксдинамикобжекткаунт**](/windows/desktop/api/spatialaudioclient/nf-spatialaudioclient-ispatialaudioclient-getmaxdynamicobjectcount) в приложение, будет равно 0.

### <a name="hololens-2"></a>HoloLens 2

В HoloLens 2 Пространственный звук Майкрософт включен по умолчанию и использует разгрузку DSP оборудования, разработанную специально для Windows Sonic для наушников.

## <a name="microsoft-spatial-sound-and-audio-middleware"></a>По промежуточного звукового и звукового по (Майкрософт)

Многие разработчики приложений и игр используют сторонние решения для обработки аудио, которые часто включают в себя сложные средства разработки и аудитионинг. Корпорация Майкрософт сотрудничает с несколькими из этих поставщиков решений для реализации пространственного звука Майкрософт в существующих средах разработки. Это часто означает, что интерфейсы API, обсуждаемые здесь, являются абстрактными в представлении приложения. они упаковываются в виде подключаемых модулей для обработки цифровых сигналов (DSP), которые могут создавать экземпляры приложения, и которые могут использоваться разработчиком звука приложения для смешения с субмиксом Microsoft пространственного звукового канала, а также для передачи отдельных голосов в подключаемые модули динамического экземпляра объекта по мере необходимости. Свяжитесь с поставщиком решений по промежуточного слоя для своего уровня поддержки для пространственного звука Майкрософт.

## <a name="microsoft-spatial-sound-for-audio-renderers"></a>Пространственный звук для модулей подготовки звука (Майкрософт)

Многие модули подготовки звука нацелены на конечную точку [**Иаудиоклиент**](/windows/desktop/api/Audioclient/nn-audioclient-iaudioclient) Windows Audio Session API (васапи), где буферы каналов приложений смешанных и форматных звуковых данных передаются в приемник аудио васапи. затем доставленные буферы используются для смешивания с другими клиентами, окончательной обработки на уровне системы и отрисовки.

Пространственные конечные точки Microsoft Пространственный звук реализуются как [**испатиалаудиоклиент**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioclient), что имеет много сходства с **иаудиоклиент**. Он поддерживает *статические* звуковые объекты, формирующие плату каналов, с поддержкой до 8.1.4.4 каналов (8 каналов вокруг прослушивателя, слева, справа, центром, слева, сбоку справа, сзади слева, справа и сзади); 1 канал эффектов с низкой частотой; 4 канала выше прослушивателя, 4 канала ниже прослушивателя). Он поддерживает *динамические* объекты Sound, которые можно произвольно размещать в трехмерном пространстве.

Общий шаблон написания кода реализации для **испатиалаудиоклиент** :

-   Создание статических и (или) динамических звуковых объектов.
-   Передавать звуковой буфер каждого объекта каждому кадру, чтобы система могла их визуализировать.
-   Обновляйте трехмерные позиции динамических объектов по запросу — как часто (или редко) в качестве спроса на приложения.

Обратите внимание, что текущий формат вывода (динамики или Наушники; Windows Sonic для наушников, Dolby атмос или наушников DTS: X) является абстрактным по отношению к приведенной выше реализации. разработчик приложения может сосредоточиться на пространственном звуковом уровне, не выполняя сведение на основе формата. Приложения, которые должны быть расходятся на основе формата вывода, могут запрашивать используемый формат, но абстракция означает, что приложение не обязательно должно работать с этими форматами.

## <a name="microsoft-spatial-sound-integration-with-audio-renderers"></a>Интеграция с пространственными звуками (Майкрософт) с модулями подготовки звука

Так как [**испатиалаудиоклиент**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioclient) — это приемник звука, использующий данные, модуль подготовки звука имеет несколько вариантов взаимодействия с и доставки звуковых данных. Существует три часто используемых метода интеграции (и для заголовков, использующих по промежуточного слоя звука, на основе этих параметров могут быть доступны эквивалентные подключаемые модули):

-   **7.1.4 паннерс и Главная речь**: модули подготовки, которые уже поддерживают конечные точки 7,1, могут просто добавить поддержку четырех дополнительных каналов высоты, поддерживаемых микропрограммой **испатиалаудиоклиент** static Channel. Любые прокрутки канала, которые ранее были выполнены (вероятно, уже использовали координаты x, y, z), можно обновить, чтобы они включали эти каналы высоты. Это часто обеспечивает наименьший перерыв в работе с потоками операций визуализации и воспроизведения аудио, сигналов, потоков и элементов управления Mix. На наушниках Обратите внимание, что полная комбинация приложений будет пространственной, поэтому даже стереосистема может рассматриваться как "внешнее" от прослушивателя.
-   **Поддержка существующей конечной точки, а также добавление шины 7.1.4 (и паннерс)**. Некоторые названия могут поддерживать две конечные точки: их существующую стереосистему стерео васапи (для содержимого "Direct to ушки", которое не должно быть пространственно) наряду с **испатиалаудиоклиент** статическим каналом, поддерживающим 7.1.4 (или даже до 8.1.4.4). Конечно, управление взаимодействием между двумя наборами предоставляет дополнительные трудности создателям содержимого, хотя синхронизация поддерживается, так как экземпляры ВАСАПИ и Исак активны в определенный момент времени, используют один и тот же размер буфера и часы для обработки.
-   **Использование динамических звуковых объектов для определенных голосов или** поднаборов: предложение, возможно, наиболее подробное или точное позиционирование, но потенциальное создание непрозрачности Mix, этот метод предполагает использование динамических звуковых объектов **испатиалаудиоклиент** . Обратите внимание, что метаданные и звуковой буфер доставляются в модуль подготовки отчетов, поэтому эти звуки будут непрозрачны для остальной части набора приложений. Кроме того, поскольку существует ограниченное количество доступных динамических звуковых объектов, модулю подготовки отчетов необходимо рассмотреть методы определения приоритетов: отбора, совместное размещение звука, смешивание с помощью статического канала и т. д. Игры часто использовали этот метод для отдельных heroных звуков, таких как хеликоптер, который перемещается над прослушивателем.

Модули подготовки отчетов также могут смешивать и сопоставлять эти подходы.

## <a name="microsoft-spatial-sound-runtime-resource-implications"></a>Влияние на ресурсы среды выполнения пространственных звуков Майкрософт

В Windows и Xbox количество доступных голосов зависит от используемого формата. Форматы Dolby атмос поддерживают 32 общего числа активных объектов (например, если используется 7.1.4 канала), то могут быть активны 20 дополнительных динамических звуковых объектов. Windows Sonic для наушников поддерживает 128 общего числа активных объектов, при этом канал с низкими частотами (НИЗКОЧАСТОТный) не считается объектом, поэтому при использовании 8.1.4.4 канала 112 динамические звуковые объекты могут быть активными.

Для универсальная платформа Windows приложений, работающих на одной игровой консоли Xbox, кодирование в реальном времени (для Dolby атмос для домашнего кинотеатра, Dolby атмос для наушников, наушники для служб DTS: X и Windows Sonic для наушников) выполняется в аппаратном обеспечении без затрат на ЦП.

| Формат                       | Максимальное число статических объектов (канал каналов) | Максимальное число динамических объектов <br> Xbox One | Максимальное число динамических объектов <br> Windows | Максимальное число динамических объектов <br> HoloLens 2
|------------------------------|----------------------------------|-------------------------------------------|------------------------------------------|------------------------------------------|
| Dolby атмос (HDMI)           | 12 (7.1.4)                       | 20                                        | 20                                       | Н/Д |
| Dolby атмос (наушники & встроенные динамики)     | 17 (8.1.4.4)                     | 16                                        | 16                                       | Н/Д |
| Наушники служб DTS: X (наушники) | 17 (8.1.4.4)        | 16                                        | 32                                      | Н/Д |
| Windows Sonic для наушников | 17 (8.1.4.4)        | 15                                        | 112                                      | 31 |


Приложения также должны учитывать следующие аспекты ресурсов:

-   **Пропускная способность хранилища и диска**. линейное содержимое, предварительно созданное в 7.1.4, обычно составляет более 7,1 линейного содержимого (хотя искусственного кодеки уже часто используют преимущества корреляции каналов, чтобы сделать это гораздо меньше 50% более реальных каналов аудиоданных).
-   **Другие затраты на обработку цифровых сигналов**. Теперь некоторые ранее глобальные эффекты могут быть экземплярами для каждого динамического звукового объекта. Кроме того, некоторым создателям содержимого может потребоваться обновить некоторые эффекты DSP для поддержки дополнительных каналов или их уникального использования.

## <a name="microsoft-spatial-sound-and-sound-spatialization-cues"></a>Подсказки по пространственному звуку и звуку в Microsoft

Пространственный звук Майкрософт фокусируется на моделировании положения звука в идеальной сфере, окружающей прослушиватель. Windows Sonic для наушников, наушники служб DTS: X и Dolby атмос реализуют сопоставление и виртуализацию динамиков с наушниками, но обратите внимание, что многие другие аспекты пространственного моделирования, уже как правило, реализованы в способах создания содержимого, остаются доступными для существующих ядер. Авторы содержимого продолжают использовать существующие инструменты игры и процессы, которые ранее использовались для таких пространственных подсказок, как Doppler, ослабление и фильтрация на основе расстояния, а также перекрытия и препятствий, а также ревербератион окружающей среды.

## <a name="additional-resources"></a>Дополнительные ресурсы

-   [Репозиторий Microsoft для выборки пространственных звука GitHub](https://github.com/Microsoft/Xbox-ATG-Samples/tree/master/UWPSamples/Audio)
-   Dolby предлагает ряд ресурсов поддержки, касающихся Dolby атмос и приложения Dolby Access в <https://developer.dolby.com> .

## <a name="spatial-sound-interfaces"></a>Интерфейсы пространственного звука



| Интерфейс                                                                              | Описание                                                                                                                    |
|----------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------|
| [**испатиалаудиоклиент**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioclient)                                     | Позволяет клиенту создавать звуковые потоки, которые выдают звук из расположения в трехмерном пространстве.                                          |
| [**испатиалаудиубжект**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioobject)                                     | Представляет объект, предоставляющий звуковые данные, отображаемые из положения в трехмерном пространстве относительно пользователя.                |
| [**испатиалаудиубжектрендерстреам**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioobjectrenderstream)             | Предоставляет методы для управления объектом пространственного звукового потока визуализации, включая запуск, остановку и сброс потока. |
| [**испатиалаудиубжектрендерстреамнотифи**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioobjectrenderstreamnotify) | Предоставляет уведомления для клиентов пространственных аудио, чтобы реагировать на изменения в состоянии Испатиалаудиубжектрендерстреам.     |



 

> [!Note]  
> При использовании интерфейсов [**испатиалаудиоклиент**](/windows/desktop/api/spatialaudioclient/nn-spatialaudioclient-ispatialaudioclient) в заголовке Xbox One Development Kit (XDK) сначала необходимо вызвать **енаблеспатиалаудио** перед вызовом [**Иммдевицеенумератор:: Енумаудиоендпоинтс**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) или [**иммдевицеенумератор:: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint). Несоблюдение этого действия приведет к тому, что при \_ вызове функции активации будет возвращена ошибка "E Interface". **Енаблеспатиалаудио** доступен только для заголовков XDK, и его не нужно вызывать для универсальная платформа Windows приложений, работающих на Xbox One, а также для устройств, не являющихся устройствами Xbox.

 

## <a name="spatial-sound-structures"></a>Пространственные звуковые структуры



| Структура                                                                                                 | Описание                                                                  |
|-----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|
| [**спатиалаудиубжектрендерстреамактиватионпарамс**](/windows/desktop/api/spatialaudioclient/ns-spatialaudioclient-spatialaudioobjectrenderstreamactivationparams) | Представляет параметры активации для потока обработки пространственных аудиозаписей.          |
| [**спатиалаудиоклиентактиватионпарамс**](/windows/desktop/api/spatialaudioclient/ns-spatialaudioclient-spatialaudioclientactivationparams)                          | Представляет необязательные параметры активации для потока обработки пространственных аудиозаписей. |



 

## <a name="spatial-sound-enumerations"></a>Перечисления пространственных звуков



| Перечисление                                | Описание                                   |
|--------------------------------------------|-----------------------------------------------|
| [**аудиубжекттипе**](/windows/desktop/api/spatialaudioclient/ne-spatialaudioclient-audioobjecttype) | Указывает тип Испатиалаудиубжект. |



 

 

 



