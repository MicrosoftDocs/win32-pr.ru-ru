---
title: Схема и алгоритмы схемы профиля модели карт гаммы WCS
description: Схема и алгоритмы схемы профиля модели карт гаммы WCS
ms.assetid: 64b9871a-1b4f-4e9a-be4d-4c25b3198b91
keywords:
- Цветовая система Windows (WCS), профиль модели карт цветов (ГММП)
- WCS (цветовая система Windows), профиль модели карт цветов (ГММП)
- Управление цветом изображений, профиль модели карт цветов (ГММП)
- Управление цветом, профиль модели карт цветов (ГММП)
- цвета, профиль модели соответствия цветовой палитры (ГММП)
- Цветовая система Windows (WCS), профили
- WCS (цветовая система Windows), профили
- Управление цветом изображений, профили
- Управление цветом, профили
- цвета, профили
- Профиль модели карт цветов (ГММП)
- ГММП (профиль модели карт цветов)
- Профиль модели карт цветовой гаммы WCS
- схемы, профиль модели карт цветов (ГММП)
- алгоритмы, профиль модели карт CMYK (ГММП)
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3714e5d7592cb1fbbbfa98e238642a2fcb38bafd
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "104571816"
---
# <a name="wcs-gamut-map-model-profile-schema-and-algorithms"></a><span data-ttu-id="45bad-118">Схема и алгоритмы схемы профиля модели карт гаммы WCS</span><span class="sxs-lookup"><span data-stu-id="45bad-118">WCS Gamut Map Model Profile Schema and Algorithms</span></span>

-   [<span data-ttu-id="45bad-119">Обзор</span><span class="sxs-lookup"><span data-stu-id="45bad-119">Overview</span></span>](#overview)
-   [<span data-ttu-id="45bad-120">Архитектура профиля модели карт цветов</span><span class="sxs-lookup"><span data-stu-id="45bad-120">Gamut Map Model Profile Architecture</span></span>](#gamut-map-model-profile-architecture)
-   [<span data-ttu-id="45bad-121">Создание границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-121">Generation of the Gamut Boundary</span></span>](#generation-of-the-gamut-boundary)
-   [<span data-ttu-id="45bad-122">Схема ГММП</span><span class="sxs-lookup"><span data-stu-id="45bad-122">The GMMP Schema</span></span>](#the-gmmp-schema)
-   [<span data-ttu-id="45bad-123">Элементы схемы ГММП</span><span class="sxs-lookup"><span data-stu-id="45bad-123">The GMMP Schema Elements</span></span>](#the-gmmp-schema-elements)
-   [<span data-ttu-id="45bad-124">гамутмапмодел</span><span class="sxs-lookup"><span data-stu-id="45bad-124">GamutMapModel</span></span>](#defaultbaselinegamutmapmodel-type)
    -   [<span data-ttu-id="45bad-125">Пространство имен</span><span class="sxs-lookup"><span data-stu-id="45bad-125">Namespace</span></span>](#namespace)
    -   [<span data-ttu-id="45bad-126">Version</span><span class="sxs-lookup"><span data-stu-id="45bad-126">Version</span></span>](#version)
    -   [<span data-ttu-id="45bad-127">Документация</span><span class="sxs-lookup"><span data-stu-id="45bad-127">Documentation</span></span>](#documentation)
    -   [<span data-ttu-id="45bad-128">Тип Дефаултбаселинегамутмапмодел</span><span class="sxs-lookup"><span data-stu-id="45bad-128">DefaultBaselineGamutMapModel type</span></span>](#defaultbaselinegamutmapmodel-type)
    -   [<span data-ttu-id="45bad-129">плугингамутмаптипе</span><span class="sxs-lookup"><span data-stu-id="45bad-129">PlugInGamutMapType</span></span>](#plugingamutmaptype)
    -   [<span data-ttu-id="45bad-130">ExtensionType</span><span class="sxs-lookup"><span data-stu-id="45bad-130">ExtensionType</span></span>](#extensiontype)
-   [<span data-ttu-id="45bad-131">Базовые алгоритмы ГММП</span><span class="sxs-lookup"><span data-stu-id="45bad-131">The GMMP Baseline Algorithms</span></span>](#the-gmmp-baseline-algorithms)
-   [<span data-ttu-id="45bad-132">Согласование нейтральных осей</span><span class="sxs-lookup"><span data-stu-id="45bad-132">Aligning the Neutral Axes</span></span>](#aligning-the-neutral-axes)
    -   [<span data-ttu-id="45bad-133">Минимальная цветовая разница (Минкд)</span><span class="sxs-lookup"><span data-stu-id="45bad-133">Minimum Color Difference (MinCD)</span></span>](#minimum-color-difference-mincd)
    -   [<span data-ttu-id="45bad-134">басикфото</span><span class="sxs-lookup"><span data-stu-id="45bad-134">BasicPhoto</span></span>](#basicphoto)
    -   [<span data-ttu-id="45bad-135">Обзор</span><span class="sxs-lookup"><span data-stu-id="45bad-135">Overview</span></span>](#overview)
    -   [<span data-ttu-id="45bad-136">При использовании оболочки одного цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-136">The case of single gamut shell</span></span>](#the-case-of-single-gamut-shell)
    -   [<span data-ttu-id="45bad-137">Черное расширение</span><span class="sxs-lookup"><span data-stu-id="45bad-137">Black enhancement</span></span>](#black-enhancement)
    -   [<span data-ttu-id="45bad-138">Случаи использования оболочек с двойным охватом</span><span class="sxs-lookup"><span data-stu-id="45bad-138">The case of dual gamut shells</span></span>](#the-case-of-dual-gamut-shells)
    -   [<span data-ttu-id="45bad-139">Причины изменений в рекомендациях ЦИЕ TC8-03</span><span class="sxs-lookup"><span data-stu-id="45bad-139">Reasons for changes from the CIE TC8-03 recommendations</span></span>](#reasons-for-changes-from-the-cie-tc8-03-recommendations)
    -   [<span data-ttu-id="45bad-140">Сопоставление оттенков</span><span class="sxs-lookup"><span data-stu-id="45bad-140">Hue mapping</span></span>](#hue-mapping)
-   [<span data-ttu-id="45bad-141">Описание границы палитры и алгоритмы оболочки</span><span class="sxs-lookup"><span data-stu-id="45bad-141">Gamut Boundary Description and Gamut Shell Algorithms</span></span>](#gamut-boundary-description-and-gamut-shell-algorithms)
    -   [<span data-ttu-id="45bad-142">Триангуляция границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-142">Triangulation of the Gamut Boundary</span></span>](#triangulation-of-the-gamut-boundary)
    -   [<span data-ttu-id="45bad-143">Элементы линии границ</span><span class="sxs-lookup"><span data-stu-id="45bad-143">Boundary Line Elements</span></span>](#boundary-line-elements)
    -   [<span data-ttu-id="45bad-144">Операция с охватом: Чеккгамут</span><span class="sxs-lookup"><span data-stu-id="45bad-144">Gamut Operation: CheckGamut</span></span>](#gamut-operation-checkgamut)
    -   [<span data-ttu-id="45bad-145">Плоскость полного оттенка: Intersect</span><span class="sxs-lookup"><span data-stu-id="45bad-145">Full Hue Plane: Intersect</span></span>](#full-hue-plane-intersect)
    -   [<span data-ttu-id="45bad-146">Операция с охватом: Чеккгамут (продолжение)</span><span class="sxs-lookup"><span data-stu-id="45bad-146">Gamut Operation: CheckGamut (continued)</span></span>](#gamut-operation-checkgamut-continued)
    -   [<span data-ttu-id="45bad-147">Сопоставление палитры минимальных цветовых различий</span><span class="sxs-lookup"><span data-stu-id="45bad-147">Minimum Color Difference Gamut Mapping</span></span>](#minimum-color-difference-gamut-mapping)
    -   [<span data-ttu-id="45bad-148">Сглаживание оттенков</span><span class="sxs-lookup"><span data-stu-id="45bad-148">Hue Smoothing</span></span>](#hue-smoothing)
    -   [<span data-ttu-id="45bad-149">Настройка первичных и вторичных баз данных в описании границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-149">Setting Primaries and Secondaries in the Gamut Boundary Description</span></span>](#setting-primaries-and-secondaries-in-the-gamut-boundary-description)
    -   [<span data-ttu-id="45bad-150">Задание нейтральной оси в описании границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-150">Setting the Neutral Axis in the Gamut Boundary Description</span></span>](#setting-the-neutral-axis-in-the-gamut-boundary-description)
-   [<span data-ttu-id="45bad-151">См. также</span><span class="sxs-lookup"><span data-stu-id="45bad-151">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="45bad-152">Обзор</span><span class="sxs-lookup"><span data-stu-id="45bad-152">Overview</span></span>

<span data-ttu-id="45bad-153">Эта схема используется для указания содержимого профиля модели карт для цветового охвата (ГММП).</span><span class="sxs-lookup"><span data-stu-id="45bad-153">This schema is used to specify the content of a gamut map model profile (GMMP).</span></span> <span data-ttu-id="45bad-154">Связанные базовые алгоритмы описаны в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="45bad-154">The associated baseline algorithms are described in the following topic.</span></span>

<span data-ttu-id="45bad-155">Базовая схема ГММП состоит из общих сведений о заголовках, необязательной ссылки на предпочтительный подключаемый модуль модели карт цветов и тегов расширений.</span><span class="sxs-lookup"><span data-stu-id="45bad-155">The basic GMMP schema consists of common header information, an optional reference to a preferred Gamut Map Model plug-in, and extension tags.</span></span>

<span data-ttu-id="45bad-156">Кроме того, ГММП предоставляет явную информацию о целевой модели карт цветов и предоставляет политику для базовой модели резервного отображения цветового элемента, которая используется, если Целевая модель недоступна.</span><span class="sxs-lookup"><span data-stu-id="45bad-156">In addition, the GMMP provides explicit information on the targeted Gamut Map Model, and provides a policy on the baseline fallback Gamut Map Model to use if the targeted model is unavailable.</span></span> <span data-ttu-id="45bad-157">Схема может включать в себя закрытые сведения о расширении, но не будет содержать другие лишние сведения.</span><span class="sxs-lookup"><span data-stu-id="45bad-157">The schema can include private extensional information, but will include no other extraneous information.</span></span>

## <a name="gamut-map-model-profile-architecture"></a><span data-ttu-id="45bad-158">Архитектура профиля модели карт цветов</span><span class="sxs-lookup"><span data-stu-id="45bad-158">Gamut Map Model Profile Architecture</span></span>

![Схема, на которой показан профиль модели карт цветов.](images/gmmp-image002.png)

<span data-ttu-id="45bad-160">Выборка колорантного дискового пространства выполняется путем прохода по колорантс с 0,0 до 1,0 с помощью дробного шага, накопления всех сочетаний колорант на каждом шаге, а затем преобразования их из колорант пространства устройства в область отображения цвета с помощью метода DM::D Евицетоколориметрикколорс, за которым следует метод «Камера:: Колориметриктоаппеаранцеколорс».</span><span class="sxs-lookup"><span data-stu-id="45bad-160">The sampling of the output device colorant space is done by iterating through the colorants from 0.0 to 1.0 with a fractional step, accumulating all combinations of each colorant at each step, and then converting them from device colorant space to color appearance space using the DM::DeviceToColorimetricColors method followed by the CAM::ColorimetricToAppearanceColors method.</span></span> <span data-ttu-id="45bad-161">Ниже приведен пример того, как это делается для RGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-161">The following is an example of how this is done for RGB.</span></span>


```C++
For (red= 0.0; red <= 1.0; red += redStep) {

     For (green = 0.0; green <= 1.0; green += greenStep) {

          For (blue = 0.0; blue <= 1.0; blue += blueStep) {

               Colorants[0] = red; colorants[1] = green; colorants[2] = blue;

               pRGBDM->DeviceToColorimetricColors(1, colorants, &amp;XYZ);

               pCAM->ColorimetricToAppearanceColors(1, &amp;XYZ, &amp;JCh);

          }

     }

}

```



## <a name="generation-of-the-gamut-boundary"></a><span data-ttu-id="45bad-162">Создание границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-162">Generation of the Gamut Boundary</span></span>

<span data-ttu-id="45bad-163">Существует три компонента границы цветового охвата: первичные, нейтральные выборки и оболочки.</span><span class="sxs-lookup"><span data-stu-id="45bad-163">There are three components to the gamut boundary: the primaries, the neutral samples, and the shells.</span></span> <span data-ttu-id="45bad-164">Первичные цвета создаются путем создания основных первичных устройств и применения преобразования Девицетоколориметрик/Колориметриктоаппеаранце.</span><span class="sxs-lookup"><span data-stu-id="45bad-164">The primaries are generated by taking the device primaries and applying the DeviceToColorimetric/ColorimetricToAppearance transformation.</span></span> <span data-ttu-id="45bad-165">Нейтральные примеры создаются путем выборки пространства колоранта устройства в нейтральной области и применения того же преобразования.</span><span class="sxs-lookup"><span data-stu-id="45bad-165">The neutral samples are generated by sampling the device colorant space in the neutral area and applying the same transformation.</span></span> <span data-ttu-id="45bad-166">Для трех устройств колорант (RGB или КМИ) нейтральные образцы определяются так, что все колорантс равны, например, R = = G = = B. Для CMYK нейтральные выборки определяются как наличие C = = M = = Y = = 0.</span><span class="sxs-lookup"><span data-stu-id="45bad-166">For three colorant devices (RGB or CMY), the neutral samples are defined as having all of the colorants equal, for example, R == G == B. For CMYK, the neutral samples are defined as having C == M == Y == 0.</span></span>

<span data-ttu-id="45bad-167">Факторы, влияющие на данные, используемые для создания границы палитры, — это образцы данных (только базовые устройства) и условия просмотра.</span><span class="sxs-lookup"><span data-stu-id="45bad-167">The factors that influence the data used to create the gamut boundary are the data samples (baseline devices only) and the viewing conditions.</span></span> <span data-ttu-id="45bad-168">Размер шага, используемый для полной выборки пространства колорант (для мониторов и для оболочки правдоподобные), является внутренней константой и недоступен для внешней манипуляции.</span><span class="sxs-lookup"><span data-stu-id="45bad-168">The step size used to do the full sampling of the colorant space (for monitors and for plausible shell) is an internal constant and isn't available for outside manipulation.</span></span> <span data-ttu-id="45bad-169">Изменение условий просмотра изменяет поведение модели цветового оформления (камера) и изменяет форму границы палитры, поэтому необходимо создать границу цветового охвата, привязанную к профилю условий просмотра.</span><span class="sxs-lookup"><span data-stu-id="45bad-169">Changing the viewing conditions changes the behavior of the color appearance model (CAM) and alters the shape of the gamut boundary, so you must generate a gamut boundary tied to the viewing conditions profile.</span></span> <span data-ttu-id="45bad-170">Если используется образец данных, как в случае с базовыми принтерами и устройствами записи, то выборка будет оказывать значительное влияние на форму эталонного уровня и влияет на поведение самой модели.</span><span class="sxs-lookup"><span data-stu-id="45bad-170">If sample data is used, as in the case of baseline printers and capture devices, then the samples will have a lot of impact on the shape of the reference gamut and affect the behavior of the model itself.</span></span>

<span data-ttu-id="45bad-171">Для устройств ввода, таких как камеры и сканеры, используются различные выборки для создания справочной оболочки и оболочки правдоподобные.</span><span class="sxs-lookup"><span data-stu-id="45bad-171">For input devices, such as cameras and scanners, different samplings are used to generate the reference shell and the plausible shell.</span></span> <span data-ttu-id="45bad-172">Эталонная оболочка создается на основе измерений, используемых для инициализации модели устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-172">The reference shell is generated from the measurements used to initialize the device model.</span></span> <span data-ttu-id="45bad-173">Оболочка правдоподобные создается аналогично предыдущему изображению для выходных устройств.</span><span class="sxs-lookup"><span data-stu-id="45bad-173">The plausible shell is generated similar to the prior illustration for output devices.</span></span> <span data-ttu-id="45bad-174">Различие заключается в том, что при вводе типичного целевого объекта не получаются полностью насыщенные значения (где R, G или B = 255).</span><span class="sxs-lookup"><span data-stu-id="45bad-174">The difference it that when you input a typical target, you don't get fully saturated values (where R, G, or B = 255).</span></span> <span data-ttu-id="45bad-175">Для оценки этих значений необходимо выполнить экстраполяцию с использованием модели устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-175">You must extrapolate using the device model to estimate those values.</span></span>

## <a name="the-gmmp-schema"></a><span data-ttu-id="45bad-176">Схема ГММП</span><span class="sxs-lookup"><span data-stu-id="45bad-176">The GMMP Schema</span></span>


```C++
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema 
  xmlns:gmm="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"
  xmlns:wcs="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes"
  targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified"
  blockDefault="#all"
  version="1.0">

  <xs:annotation>
    <xs:documentation>
      Gamut Map Model profile schema.
      Copyright (C) Microsoft. All rights reserved.
    </xs:documentation>
  </xs:annotation>

  <xs:import namespace="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes" />

  <xs:element name="GamutMapModel">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="ProfileName" type="wcs:MultiLocalizedTextType"/>
        <xs:element name="Description" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="Author" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="DefaultBaselineGamutMapModel">
          <xs:simpleType>
            <xs:restriction base="xs:string">
              <xs:enumeration value="HPMinCD_Absolute"/>
              <xs:enumeration value="HPMinCD_Relative"/>
              <xs:enumeration value="SGCK"/>
              <xs:enumeration value="HueMap"/>
            </xs:restriction>
          </xs:simpleType>
        </xs:element>
        <xs:element name="PlugInGamutMapModel" minOccurs="0">
          <xs:complexType>
            <xs:sequence>
              <xs:any namespace="##other" processContents="skip"
                minOccurs="0" maxOccurs="unbounded" />
            </xs:sequence>
            <xs:attribute name="GUID" type="wcs:GUIDType" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="ID" type="xs:string" use="optional" />
    </xs:complexType>
  </xs:element>
</xs:schema>
```



## <a name="the-gmmp-schema-elements"></a><span data-ttu-id="45bad-177">Элементы схемы ГММП</span><span class="sxs-lookup"><span data-stu-id="45bad-177">The GMMP Schema Elements</span></span>

## <a name="gamutmapmodel"></a><span data-ttu-id="45bad-178">гамутмапмодел</span><span class="sxs-lookup"><span data-stu-id="45bad-178">GamutMapModel</span></span>

<span data-ttu-id="45bad-179">Этот элемент является последовательностью следующих вложенных элементов:</span><span class="sxs-lookup"><span data-stu-id="45bad-179">This element is a sequence of the following sub-elements:</span></span>

1.  <span data-ttu-id="45bad-180">Строка имени файла,</span><span class="sxs-lookup"><span data-stu-id="45bad-180">ProfileName string,</span></span>
2.  <span data-ttu-id="45bad-181">Дефаултбаселинегамутмапмодел,</span><span class="sxs-lookup"><span data-stu-id="45bad-181">DefaultBaselineGamutMapModel,</span></span>
3.  <span data-ttu-id="45bad-182">Необязательная строка описания</span><span class="sxs-lookup"><span data-stu-id="45bad-182">Optional Description string,</span></span>
4.  <span data-ttu-id="45bad-183">Необязательная строка автора</span><span class="sxs-lookup"><span data-stu-id="45bad-183">Optional Author string,</span></span>
5.  <span data-ttu-id="45bad-184">Необязательный Плугингамутмап и</span><span class="sxs-lookup"><span data-stu-id="45bad-184">Optional PlugInGamutMap, and</span></span>
6.  <span data-ttu-id="45bad-185">Необязательный ExtensionType.</span><span class="sxs-lookup"><span data-stu-id="45bad-185">Optional ExtensionType.</span></span>

<span data-ttu-id="45bad-186">**Условия проверки** : каждый вложенный элемент проверяется по собственному типу.</span><span class="sxs-lookup"><span data-stu-id="45bad-186">**Validation conditions** : Each sub-element is validated by its own type.</span></span>

### <a name="namespace"></a><span data-ttu-id="45bad-187">Пространство имен</span><span class="sxs-lookup"><span data-stu-id="45bad-187">Namespace</span></span>

<span data-ttu-id="45bad-188">xmlns: ГММ = " http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel "</span><span class="sxs-lookup"><span data-stu-id="45bad-188">xmlns:gmm="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"</span></span>

<span data-ttu-id="45bad-189">targetNamespace = " http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel "</span><span class="sxs-lookup"><span data-stu-id="45bad-189">targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"</span></span>

### <a name="version"></a><span data-ttu-id="45bad-190">Версия</span><span class="sxs-lookup"><span data-stu-id="45bad-190">Version</span></span>

<span data-ttu-id="45bad-191">Версия "1,0" в первом выпуске Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="45bad-191">Version "1.0" with the first release of Windows Vista.</span></span>

<span data-ttu-id="45bad-192">**Условия проверки** : 1,0 в Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="45bad-192">**Validation conditions** : 1.0 in Windows Vista.</span></span> <span data-ttu-id="45bad-193">Версии &lt; 2,0 также являются допустимыми для поддержки некритических изменений формата.</span><span class="sxs-lookup"><span data-stu-id="45bad-193">Versions &lt;2.0 are also valid in order to support non-breaking changes to the format.</span></span>

### <a name="documentation"></a><span data-ttu-id="45bad-194">Документация</span><span class="sxs-lookup"><span data-stu-id="45bad-194">Documentation</span></span>

<span data-ttu-id="45bad-195">Схема профиля модели карт цветов.</span><span class="sxs-lookup"><span data-stu-id="45bad-195">Gamut Map Model Profile schema.</span></span>

<span data-ttu-id="45bad-196">(C) корпорация Майкрософт (Microsoft Corporation).</span><span class="sxs-lookup"><span data-stu-id="45bad-196">Copyright (C) Microsoft.</span></span> <span data-ttu-id="45bad-197">Все права защищены.</span><span class="sxs-lookup"><span data-stu-id="45bad-197">All rights reserved.</span></span>

<span data-ttu-id="45bad-198">**Условия проверки** : каждый вложенный элемент проверяется по собственному типу.</span><span class="sxs-lookup"><span data-stu-id="45bad-198">**Validation conditions** : Each sub-element is validated by its own type.</span></span>

### <a name="defaultbaselinegamutmapmodel-type"></a><span data-ttu-id="45bad-199">Тип Дефаултбаселинегамутмапмодел</span><span class="sxs-lookup"><span data-stu-id="45bad-199">DefaultBaselineGamutMapModel type</span></span>

<span data-ttu-id="45bad-200">Тип UINT</span><span class="sxs-lookup"><span data-stu-id="45bad-200">UINT type</span></span>

<span data-ttu-id="45bad-201">Значения перечисления:</span><span class="sxs-lookup"><span data-stu-id="45bad-201">Enumeration values:</span></span>

<dl> <span data-ttu-id="45bad-202">"Минкд \_ Absolute"</span><span class="sxs-lookup"><span data-stu-id="45bad-202">"MinCD\_Absolute"</span></span>  
<span data-ttu-id="45bad-203">"Минкд \_ относительный"</span><span class="sxs-lookup"><span data-stu-id="45bad-203">"MinCD\_Relative"</span></span>  
<span data-ttu-id="45bad-204">"SIG \_ завяз"</span><span class="sxs-lookup"><span data-stu-id="45bad-204">"SIG\_KNEE"</span></span>  
<span data-ttu-id="45bad-205">"Хуемап"</span><span class="sxs-lookup"><span data-stu-id="45bad-205">"HueMap"</span></span>  
</dl>

<span data-ttu-id="45bad-206">**Условия проверки** : значения должны соответствовать одному из перечисленных выше перечислений.</span><span class="sxs-lookup"><span data-stu-id="45bad-206">**Validation conditions** : The values must match one of the enumerations above.</span></span>

### <a name="plugingamutmaptype"></a><span data-ttu-id="45bad-207">плугингамутмаптипе</span><span class="sxs-lookup"><span data-stu-id="45bad-207">PlugInGamutMapType</span></span>

<span data-ttu-id="45bad-208">Этот элемент является последовательностью Гуидтипе GUID и всех вложенных элементов.</span><span class="sxs-lookup"><span data-stu-id="45bad-208">This element is a sequence of a GUID GUIDType and any sub-elements.</span></span>

<span data-ttu-id="45bad-209">**Условия проверки** : идентификатор GUID используется для сопоставления GUID подключаемого модуля ГММ DLL.</span><span class="sxs-lookup"><span data-stu-id="45bad-209">**Validation conditions** : The GUID is used to match the GMM PlugIn DLL GUID.</span></span> <span data-ttu-id="45bad-210">Существует не более 100 000 настраиваемых вложенных элементов.</span><span class="sxs-lookup"><span data-stu-id="45bad-210">There are a maximum of 100,000 custom sub-elements.</span></span>

### <a name="extensiontype"></a><span data-ttu-id="45bad-211">ExtensionType</span><span class="sxs-lookup"><span data-stu-id="45bad-211">ExtensionType</span></span>

<span data-ttu-id="45bad-212">Этот элемент является необязательной последовательностью всех вложенных элементов.</span><span class="sxs-lookup"><span data-stu-id="45bad-212">This element is a optional sequence of any sub-elements.</span></span>

<span data-ttu-id="45bad-213">**Условия проверки** : может быть не более 100 000 вложенных элементов.</span><span class="sxs-lookup"><span data-stu-id="45bad-213">**Validation conditions** : There can be a maximum of 100,000 sub-elements.</span></span>

## <a name="the-gmmp-baseline-algorithms"></a><span data-ttu-id="45bad-214">Базовые алгоритмы ГММП</span><span class="sxs-lookup"><span data-stu-id="45bad-214">The GMMP Baseline Algorithms</span></span>

## <a name="aligning-the-neutral-axes"></a><span data-ttu-id="45bad-215">Согласование нейтральных осей</span><span class="sxs-lookup"><span data-stu-id="45bad-215">Aligning the Neutral Axes</span></span>

<span data-ttu-id="45bad-216">Большинство алгоритмов сопоставления цветовой палитры имеют цель сопоставления нейтральной оси исходного устройства с нейтральной осью целевого устройства: то есть белый цвет переключается в белый, черный на черный, а серый — на серый.</span><span class="sxs-lookup"><span data-stu-id="45bad-216">Most gamut mapping algorithms have a goal of mapping the neutral axis of the source device to the neutral axis of the destination device: that is, white goes to white, black to black, and gray to gray.</span></span> <span data-ttu-id="45bad-217">Это устранено в части путем масштабирования яркости исходных цветов в соответствии с диапазоном освещенности целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-217">This is addressed in part by scaling the lightness of source colors to match the lightness range of the destination device.</span></span> <span data-ttu-id="45bad-218">Но это не полностью решает проблему.</span><span class="sxs-lookup"><span data-stu-id="45bad-218">But that does not completely address the problem.</span></span>

<span data-ttu-id="45bad-219">Это физическое свойство большинства устройств для работы с образами, которое не совпадает с цветовым изображением устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-219">It is a physical property of most imaging devices that the chromaticity of the device white does not exactly match the chromaticity of the device black.</span></span> <span data-ttu-id="45bad-220">Например, белый цвет зависит от суммы цветов и относительных светимости трех первичных элементов, а монитор черного зависит от отражения поверхности отображения.</span><span class="sxs-lookup"><span data-stu-id="45bad-220">For example, monitor white depends on the sum of the chromaticities and relative luminances of the three primaries, while monitor black depends on the reflectance of the display surface.</span></span> <span data-ttu-id="45bad-221">Белый принтер зависит от насыщенности бумаги, тогда как черный принтер зависит от используемой краски или тонера.</span><span class="sxs-lookup"><span data-stu-id="45bad-221">Printer white depends on the chromaticity of the paper, while printer black depends on the ink or toner used.</span></span> <span data-ttu-id="45bad-222">Модель внешнего вида, которая сопоставляет устройство в точности с нейтральной осью пространства внешнего вида (чрома точно равно нулю), не сопоставляет черный объект с нейтральной осью.</span><span class="sxs-lookup"><span data-stu-id="45bad-222">An appearance model that maps device white exactly to the neutral axis of the appearance space (chroma exactly equal to zero) will not map device black to the neutral axis.</span></span> <span data-ttu-id="45bad-223">Так как степень освещенности более важна для чроманых различий, то средние оттенки серого будут представлены еще больше, чем черные устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-223">Because the eye is more sensitive to chroma differences as lightness increases, mid-grays will be represented as even more chromatic than device black.</span></span> <span data-ttu-id="45bad-224">(На рис. 1 показана кривизна нейтральных осей в двух измерениях.</span><span class="sxs-lookup"><span data-stu-id="45bad-224">(Figure 1 illustrates the curvature of the neutral axes in two dimensions.</span></span> <span data-ttu-id="45bad-225">Фактически, нейтральные оси формируют более сложную кривую в трех измерениях.)</span><span class="sxs-lookup"><span data-stu-id="45bad-225">In fact, the neutral axes form a more complex curve in three dimensions.)</span></span>

<span data-ttu-id="45bad-226">Хотя Камера прогнозирует, что эти нейтральные цвета устройства будут выглядеть как цветное, фактические наблюдатели кажутся компенсировать это.</span><span class="sxs-lookup"><span data-stu-id="45bad-226">While the CAM predicts that these device neutral colors will appear chromatic, actual observers seem to compensate for this.</span></span> <span data-ttu-id="45bad-227">Большинство пользователей не рассматривайте эти нейтральные значения устройства как цветные.</span><span class="sxs-lookup"><span data-stu-id="45bad-227">Most people do not consider these device neutral values to be chromatic.</span></span> <span data-ttu-id="45bad-228">Поэтому для большинства моделей сопоставления цветовых диапазонов следует по прежнему сопоставлять нейтральные источники с нейтральными к устройствам.</span><span class="sxs-lookup"><span data-stu-id="45bad-228">For most gamut mapping models, therefore, you should continue to map source neutrals to device neutrals.</span></span>

<span data-ttu-id="45bad-229">Чтобы сопоставить исходные нейтральные значения с нейтральными устройствами, настройте границы исходного и целевого диапазонов и каждый пиксель при применении алгоритма сопоставления палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-229">To map source neutrals to device neutrals, adjust the source and destination gamut boundaries and each pixel when you apply the gamut mapping algorithm.</span></span> <span data-ttu-id="45bad-230">Сначала скорректируйте каждое значение в исходном цвете, чтобы нейтральная ось исходного устройства на свете исходного цвета нападает непосредственно на нейтральную ось области внешнего вида.</span><span class="sxs-lookup"><span data-stu-id="45bad-230">First adjust each value in the source color so that the source device's neutral axis at the source color's lightness falls directly on the neutral axis of the appearance space.</span></span> <span data-ttu-id="45bad-231">(См. левую часть рис. 1.) Затем измените описание границы цветовой гаммы устройства назначения таким образом, чтобы каждый цвет на нейтральной оси целевого устройства на уровне границы цветовой области конечного устройства направляться непосредственно на нейтральную ось пространства внешнего вида.</span><span class="sxs-lookup"><span data-stu-id="45bad-231">(See the left side of Figure 1.) Then adjust the destination device's gamut boundary description so that each color on the destination device's neutral axis at the destination device gamut boundary color's lightness falls directly on the neutral axis of the appearance space.</span></span> <span data-ttu-id="45bad-232">(См. правую часть на рис. 1.)</span><span class="sxs-lookup"><span data-stu-id="45bad-232">(See the right side of Figure 1.)</span></span>

![Диаграмма, на которой показана исходная диаграмма границы цветовой гаммы слева, а также Целевая граница цветовой гаммы справа.](images/gmmp-image004.png)

<span data-ttu-id="45bad-234">**Рисунок 1** . проиллюстрированное выравнивание нейтральных осей.</span><span class="sxs-lookup"><span data-stu-id="45bad-234">**Figure 1** : Alignment of the neutral axes illustrated.</span></span> <span data-ttu-id="45bad-235">Left: корректировка исходных точек относительно нейтральной оси исходного устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-235">Left: Adjusting source points relative to the source device neutral axis.</span></span> <span data-ttu-id="45bad-236">Right: изменение описания границы целевой палитры в соответствии с описанием границы целевой палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-236">Right: Adjusting the destination gamut boundary description relative to the destination gamut boundary description.</span></span>

<span data-ttu-id="45bad-237">Обратите внимание, что каждое значение исходного пикселя изменяется относительно нейтральной оси в этом значении освещенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-237">Note that you adjust each source pixel value relative to the neutral axis at that lightness value.</span></span> <span data-ttu-id="45bad-238">Это гарантирует, что нейтральность исходного устройства будет попадать в нейтральную ось модели внешнего вида.</span><span class="sxs-lookup"><span data-stu-id="45bad-238">This assures that source device neutrals will fall on the neutral axis of the appearance model.</span></span> <span data-ttu-id="45bad-239">Вы также сдвигаете все остальные цвета на тот же самый уровень, чтобы в представлении исходного диапазона не было ненепрерывных отработок.</span><span class="sxs-lookup"><span data-stu-id="45bad-239">You also shift all other colors at that lightness by the same amount, so that there are no discontinuities in the representation of the source gamut.</span></span> <span data-ttu-id="45bad-240">Необходимо сдвинуть различные суммы на разных уровнях освещенности, так как нейтральные исходные устройства не представляются как цветовые значения на разных уровнях освещенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-240">You have to shift by different amounts at different lightness levels, because the source device neutrals are not represented as equally chromatic at the different lightness levels.</span></span> <span data-ttu-id="45bad-241">Очевидно, что это не является тривиальным преобразованием.</span><span class="sxs-lookup"><span data-stu-id="45bad-241">Clearly, this is not a trivial transformation.</span></span>

<span data-ttu-id="45bad-242">Обработка значений целевых устройств немного сложнее.</span><span class="sxs-lookup"><span data-stu-id="45bad-242">Handling the destination device values is a little more tricky.</span></span> <span data-ttu-id="45bad-243">Изначально все границы целевой палитры настраиваются аналогичным образом, но относительно нейтральной оси целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-243">Initially, you adjust the entire destination gamut boundary in a similar manner, but relative to the destination device neutral axis.</span></span> <span data-ttu-id="45bad-244">Это показано на рис. 1 в правой части.</span><span class="sxs-lookup"><span data-stu-id="45bad-244">This is illustrated in Figure 1 on the right side.</span></span> <span data-ttu-id="45bad-245">Эта корректировка гарантирует, что значения серого источника будут сопоставляться с целевыми значениями серого.</span><span class="sxs-lookup"><span data-stu-id="45bad-245">That adjustment assures that source gray values will map to destination gray values.</span></span> <span data-ttu-id="45bad-246">Это пространство, в котором работают алгоритмы сопоставления палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-246">This is the space in which the gamut mapping algorithms operate.</span></span>

<span data-ttu-id="45bad-247">Однако это пространство не точно описывает истинное поведение целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-247">However, this space does not accurately describe the true behavior of the destination device.</span></span> <span data-ttu-id="45bad-248">Необходимо обратить сопоставление, прежде чем сопоставленные цветовые значения будут переданы модели внешнего вида и модели целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-248">You must invert the mapping before gamut mapped colors are handed to the appearance model and destination device model.</span></span> <span data-ttu-id="45bad-249">Все сопоставленные значения будут смещены на противоположное смещению, примененному ранее, к нейтральной оси целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-249">You offset all the mapped values by the opposite of the offset applied earlier to the destination device neutral axis.</span></span> <span data-ttu-id="45bad-250">После этого Целевая Нейтральная ось преобразуется обратно к значению, представленному с помощью камера.</span><span class="sxs-lookup"><span data-stu-id="45bad-250">This maps the destination neutral axis back to the value represented originally by the CAM.</span></span> <span data-ttu-id="45bad-251">Она делает то же самое для границы цветового охвата и всех промежуточных значений.</span><span class="sxs-lookup"><span data-stu-id="45bad-251">It does the same for the gamut boundary and all intermediate values.</span></span>

![Схема, на которой показан график отмены выравнивания нейтральной оси целевого устройства.](images/gmmp-image008.png)

<span data-ttu-id="45bad-253">**Рис. 2** . Отмена выравнивания нейтральной оси на целевом устройстве</span><span class="sxs-lookup"><span data-stu-id="45bad-253">**Figure 2** : Undoing the alignment of the destination device neutral axis</span></span>

### <a name="minimum-color-difference-mincd"></a><span data-ttu-id="45bad-254">Минимальная цветовая разница (Минкд)</span><span class="sxs-lookup"><span data-stu-id="45bad-254">Minimum Color Difference (MinCD)</span></span>

<span data-ttu-id="45bad-255">Минимальная и абсолютная цветовая разница (Минкд), эквивалентная намерению ICC-изображения.</span><span class="sxs-lookup"><span data-stu-id="45bad-255">Minimum Color Difference(MinCD) Relative and Absolute versions - equivalent to the ICC colorimetric intent.</span></span>

> [!Note]  
> <span data-ttu-id="45bad-256">Минкд ГММ подходит для сопоставления графики и штрихового изображения с цветами "Logo" (плашечными цветами), градиентами цвета эмблемы с некоторыми цветами, которые выходят за пределы цветового охвата, а также для последнего этапа преобразований для подтверждения.</span><span class="sxs-lookup"><span data-stu-id="45bad-256">The MinCD GMM is suitable for mapping graphics and line art containing "logo" colors (spot colors), logo color gradients with some out-of-gamut colors, and for the final stage of proofing transforms.</span></span> <span data-ttu-id="45bad-257">Хотя Минкд ГММ может использоваться для фотографических изображений, полностью находящихся в пределах целевого диапазона, не рекомендуется для общей отрисовки фотографических изображений.</span><span class="sxs-lookup"><span data-stu-id="45bad-257">While the MinCD GMM could be used for photographic images that are entirely within the destination gamut, it is not recommended for general rendering of photographic images.</span></span> <span data-ttu-id="45bad-258">Сопоставление цветов вне цветового охвата с цветами на поверхности целевой палитры может привести к нежелательным артефактам, таким как тоновые или чромае искажения, в плавных градиентах, пересекающих границы палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-258">The mapping of out-of-gamut colors to colors on the destination gamut surface can result in unwanted artifacts, such as tone or chroma irregularities in smooth gradients that cross the gamut boundary.</span></span> <span data-ttu-id="45bad-259">Басикфото рекомендуется использовать для фотографических изображений.</span><span class="sxs-lookup"><span data-stu-id="45bad-259">BasicPhoto is recommended for photographic images.</span></span> <span data-ttu-id="45bad-260">Если для фотографического или полутонового изображения требуется сопоставление цветов, отличное от Басикфото, то в качестве альтернативы необходимо создать подключаемый модуль ГММ, реализующий это сопоставление, вместо использования Минкд.</span><span class="sxs-lookup"><span data-stu-id="45bad-260">If a photographic or contone image requires a gamut mapping other than BasicPhoto, then the alternative should be to create a plug-in GMM implementing that mapping, instead of using MinCD.</span></span>

 

<span data-ttu-id="45bad-261">Цвета в цветовой палитре остались без изменений.</span><span class="sxs-lookup"><span data-stu-id="45bad-261">In-gamut colors are left unchanged.</span></span> <span data-ttu-id="45bad-262">Для цветов вне цветового охвата освещение и чрома настраиваются путем нахождения точки в целевом наборе данных с минимальным расстоянием по цвету от входных точек вне цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-262">For out-of-gamut colors, lightness and chroma are adjusted by finding the point in the destination gamut that has the minimum color distance from out-of-gamut input points.</span></span> <span data-ttu-id="45bad-263">Расстояние цвета вычислено в ЖЧ пространстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-263">The color distance is computed in JCh space.</span></span> <span data-ttu-id="45bad-264">Тем не менее вы завесови расстояние на свете (J) и расстоянии в чрома (C) или оттенке (h) по-разному.</span><span class="sxs-lookup"><span data-stu-id="45bad-264">However, you weight the distance in lightness (J) and the distance in chroma (C) or hue (h) differently.</span></span> <span data-ttu-id="45bad-265">Функция веса, зависящая от чрома, используется для расстояния в свете, чтобы вес был меньше для мелких чрома и больше для крупных чрома, пока не будет достигнут порог чрома, после которого вес остается равным 1, то есть таким же весом, как расстояние в чрома или оттенке.</span><span class="sxs-lookup"><span data-stu-id="45bad-265">A chroma-dependent weight function is used for the distance in lightness so that the weight is smaller for small chroma and larger for large chroma until a threshold chroma is reached, after which the weight stays at 1, that is, the same weight as distance in chroma or hue.</span></span> <span data-ttu-id="45bad-266">Это следует за рекомендуемым использованием для CMC и CIEDE2000.</span><span class="sxs-lookup"><span data-stu-id="45bad-266">This follows recommended usage for CMC and CIEDE2000.</span></span> <span data-ttu-id="45bad-267">Существует два варианта: относительный и абсолютный.</span><span class="sxs-lookup"><span data-stu-id="45bad-267">There are two variants: Relative colorimetric and absolute colorimetric.</span></span>

<span data-ttu-id="45bad-268">**Относительная цветопередача:** Сначала выровняйте нейтральные исходные и конечные оси, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="45bad-268">**Relative colorimetric:** First, align the source and destination neutral axes as described previously.</span></span> <span data-ttu-id="45bad-269">Затем обрезает скорректированный исходный цвет до скорректированной границы цветовой области назначения.</span><span class="sxs-lookup"><span data-stu-id="45bad-269">Then clip the adjusted source color to the adjusted destination gamut boundary.</span></span> <span data-ttu-id="45bad-270">(См. рис. 4.</span><span class="sxs-lookup"><span data-stu-id="45bad-270">(See Figure 4.</span></span> <span data-ttu-id="45bad-271">Чрома сопоставление и постоянное освещение.) Измените значения целевых устройств, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="45bad-271">Chroma mapping along constant lightness.) Readjust the destination device values as described previously.</span></span> <span data-ttu-id="45bad-272">В случае границы цветовой палитры назначения Монохромная обрезка чрома означает, что значение чрома (C) установлено в ноль (0,0).</span><span class="sxs-lookup"><span data-stu-id="45bad-272">In the case of a monochrome destination gamut boundary, the chroma clipping means that the chroma value (C) is set to zero (0.0).</span></span>

<span data-ttu-id="45bad-273">**Абсолютная цветопередача:** Это похоже на относительную цветопередачу, но без выравнивания исходной и целевой нейтральных осей.</span><span class="sxs-lookup"><span data-stu-id="45bad-273">**Absolute colorimetric:** This is similar to relative colorimetric, but without the alignment of the source and destination neutral axis.</span></span> <span data-ttu-id="45bad-274">Исходное значение обрезается непосредственно на нейтральную независимую ось.</span><span class="sxs-lookup"><span data-stu-id="45bad-274">The source value is clipped directly to the destination neutral axis.</span></span> <span data-ttu-id="45bad-275">Обратите внимание, что, если границы исходного и целевого диапазонов являются монохромными, поведение идентично относительным вариантам. то есть выполняется выравнивание нейтральных осей, а затем чрома обрезается до нуля.</span><span class="sxs-lookup"><span data-stu-id="45bad-275">Note that if both the source and destination gamut boundaries are monochrome, the behavior is identical to the relative colorimetric variant; that is, the neutral axes alignment is performed, and then the chroma is clipped to zero.</span></span> <span data-ttu-id="45bad-276">Это гарантирует достижение приемлемого результата, даже если носители и колорантс значительно отличаются.</span><span class="sxs-lookup"><span data-stu-id="45bad-276">This ensures that a reasonable output is attained even if the media and colorants are significantly different.</span></span>

![Схема, на которой показан граф для Минкд обрезки в скорректированный цветовой охват.](images/gmmp-image010.png)

<span data-ttu-id="45bad-278">**Рис. 3** . минкд Обрезка до скорректированного цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-278">**Figure 3** : MinCD clipping to the adjusted gamut</span></span>

### <a name="basicphoto"></a><span data-ttu-id="45bad-279">басикфото</span><span class="sxs-lookup"><span data-stu-id="45bad-279">BasicPhoto</span></span>

### <a name="overview"></a><span data-ttu-id="45bad-280">Обзор</span><span class="sxs-lookup"><span data-stu-id="45bad-280">Overview</span></span>

<span data-ttu-id="45bad-281">Басикфото — эквивалент предпочтительной цели ICC, виде рисунков или искусственного.</span><span class="sxs-lookup"><span data-stu-id="45bad-281">BasicPhoto - equivalent to the ICC preferred, pictorial, or perceptual intent.</span></span>

<span data-ttu-id="45bad-282">Этот алгоритм является вариантом сопоставления чроманости сигмоидал и КУСП завяз масштабирования (СГКК), описанного ЦИЕ TC8-03 в CIE156:2004.</span><span class="sxs-lookup"><span data-stu-id="45bad-282">This algorithm is a variant of the chroma-dependent sigmoidal lightness mapping and cusp knee scaling (SGCK) described by CIE TC8-03 in CIE156:2004.</span></span> <span data-ttu-id="45bad-283">Этот вариант алгоритма поддерживает дескрипторы границ цветовой гаммы (Гбдс) с двумя оболочками. то есть Гбдс со справочной оболочкой и оболочкой правдоподобные.</span><span class="sxs-lookup"><span data-stu-id="45bad-283">This variant algorithm supports gamut boundary descriptors (GBDs) with dual gamut shells; that is, GBDs with a reference shell and a plausible shell.</span></span> <span data-ttu-id="45bad-284">Алгоритм СГКК, изначально использующий только одну оболочку в ГБД, основан на \_ алгоритме SIG завяз (браун 1999), включающем в себя сопоставление несоответствий сигмоидал и функцию масштабирования завяз, предложенную Браун и фаирчилд (1999), в сочетании с чрома, зависящим от гкусп (моровик, 1998).</span><span class="sxs-lookup"><span data-stu-id="45bad-284">The SGCK algorithm, which originally assumes only one gamut shell in the GBD, is based on the SIG\_KNEE algorithm (Braun 1999), that incorporates the sigmoidal lightness mapping and knee function scaling proposed by Braun and Fairchild (1999), combined with the chroma dependence from GCUSP (Morovic, 1998).</span></span> <span data-ttu-id="45bad-285">Она удерживает воспринимаемую константу оттенка, например угол оттенка в исправленном Jab, и использует универсальное (независимое от изображения) масштабирование сигмоидал, которое применяется в зависимости от чрома и 90% завяз функции чрома.</span><span class="sxs-lookup"><span data-stu-id="45bad-285">It keeps perceived hue constant, for example, hue angle in hue-corrected Jab, and uses a generic (image-independent) sigmoidal lightness scaling which is applied in a chroma-dependent way and a 90 percent knee function chroma.</span></span> <span data-ttu-id="45bad-286">Вариант масштабируется вдоль линий постоянной освещенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-286">The variant scales along lines of constant lightness.</span></span>

### <a name="the-case-of-single-gamut-shell"></a><span data-ttu-id="45bad-287">При использовании оболочки одного цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-287">The case of single gamut shell</span></span>

<span data-ttu-id="45bad-288">Рекомендуется проверять алгоритм в случае, когда исходный и целевой Гбдс имеют только одну оболочку цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-288">It is helpful to review the algorithm in the case where both source and destination GBDs have only one gamut shell.</span></span> <span data-ttu-id="45bad-289">В этом случае алгоритм состоит из следующих вычислений.</span><span class="sxs-lookup"><span data-stu-id="45bad-289">In this case, the algorithm consists of the following calculations.</span></span>

<span data-ttu-id="45bad-290">Сначала выполните начальное сопоставление освещения, используя следующую формулу:</span><span class="sxs-lookup"><span data-stu-id="45bad-290">First, perform initial lightness mapping using the following formula:</span></span>

![Показывает формулу для первоначального сопоставления освещенности.](images/gmmp-image012.png) <span data-ttu-id="45bad-292">(1)</span><span class="sxs-lookup"><span data-stu-id="45bad-292">(1)</span></span>

<span data-ttu-id="45bad-293">где *j ₒ* — исходная лампочка, а *j <sub>R</sub>* — это освещение воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="45bad-293">where *Jₒ* is the original lightness and *J<sub>R</sub>* is the reproduction lightness.</span></span>

![Показывает вторую формулу сопоставления освещения.](images/gmmp-image014.png) <span data-ttu-id="45bad-295">(2)</span><span class="sxs-lookup"><span data-stu-id="45bad-295">(2)</span></span>

<span data-ttu-id="45bad-296">Если исходная цветовая гамма является монохромной, значение чрома будет равно нулю для границы монохромной рамки из-за выравнивания нейтральной оси.</span><span class="sxs-lookup"><span data-stu-id="45bad-296">When the source gamut boundary is monochrome, the chroma value will be zero for the monochrome boundary due to neutral axis alignment.</span></span> <span data-ttu-id="45bad-297">Это приведет к вырождению случая, когда C равно нулю.</span><span class="sxs-lookup"><span data-stu-id="45bad-297">This will result in the degenerate case where C is equal to zero.</span></span> <span data-ttu-id="45bad-298">В этом случае *p <sub>C</sub>* имеет значение 1.</span><span class="sxs-lookup"><span data-stu-id="45bad-298">In this case, *p<sub>C</sub>* is set to 1.</span></span>

<span data-ttu-id="45bad-299">*p <sub>C</sub>* — это чромай коэффициент взвешивания (моровик, 1998), зависящий от чрома исходного цвета, C и *J <sub>S</sub>* является результатом сопоставления исходной освещенности с помощью функции сигмоидал.</span><span class="sxs-lookup"><span data-stu-id="45bad-299">*p <sub>C</sub>* is a chroma-dependent weighting factor (Morovic, 1998) that depends on the chroma of the original color, C and *J<sub>S</sub>* are the result of the original lightness being mapped using a sigmoidal function.</span></span>

 

<span data-ttu-id="45bad-300">Чтобы вычислить *J <sub>S</sub>* (браун и фаирчилд, 1999), таблица одномерного уточняющего запроса (LUT) между значениями освещения исходного и воспроизведения сначала настраивается на основе дискретных кумулятивных функций.</span><span class="sxs-lookup"><span data-stu-id="45bad-300">To calculate *J<sub>S</sub>* (Braun and Fairchild, 1999), a one-dimensional lookup table (LUT) between original and reproduction lightness values is first set up on the basis of a discrete cumulative normal function (S).</span></span>

![Показывает формулу для вычисления J s.](images/gmmp-image016.png) <span data-ttu-id="45bad-302">(3)</span><span class="sxs-lookup"><span data-stu-id="45bad-302">(3)</span></span>

<span data-ttu-id="45bad-303">где x ₀ и S — среднее и стандартное отклонение нормального распределения соответственно, а *i* = 0, 1, 2... *m*,*m* — число точек, используемых в LUT.</span><span class="sxs-lookup"><span data-stu-id="45bad-303">where x ₀ and S are the mean and standard deviation of the normal distribution respectively and *i* = 0,1,2... *m*,*m* is the number of points used in the LUT.</span></span> <span data-ttu-id="45bad-304">*S <sub></sub>* — это значение совокупной нормальной *функции для*  / *m* %.</span><span class="sxs-lookup"><span data-stu-id="45bad-304">*S <sub>i</sub>* is the value of the cumulative normal function for *i* /*m* percent.</span></span> <span data-ttu-id="45bad-305">Параметры зависят от яркости черной точки в палитре воспроизведения и могут быть интерполяции из таблицы 1.</span><span class="sxs-lookup"><span data-stu-id="45bad-305">The parameters depend on the lightness of the black point of the reproduction gamut and can be interpolated from Table 1.</span></span> <span data-ttu-id="45bad-306">Дополнительные сведения о вычислении этих параметров см. в разделе Браун and Фаирчилд (1999, p.</span><span class="sxs-lookup"><span data-stu-id="45bad-306">For details of calculating these parameters see Braun and Fairchild (1999, p.</span></span> <span data-ttu-id="45bad-307">391).</span><span class="sxs-lookup"><span data-stu-id="45bad-307">391).</span></span>

:::row:::
    :::column:::
        <span data-ttu-id="45bad-308">J <sub>минаут</sub></span><span class="sxs-lookup"><span data-stu-id="45bad-308">J <sub>minOut</sub></span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="45bad-309">5.0</span><span class="sxs-lookup"><span data-stu-id="45bad-309">5.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-310">10.0</span><span class="sxs-lookup"><span data-stu-id="45bad-310">10.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-311">15.0</span><span class="sxs-lookup"><span data-stu-id="45bad-311">15.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-312">20,0</span><span class="sxs-lookup"><span data-stu-id="45bad-312">20.0</span></span>
    :::column-end:::
:::row-end:::
:::row:::
    :::column:::
        <span data-ttu-id="45bad-313">₀ x</span><span class="sxs-lookup"><span data-stu-id="45bad-313">x ₀</span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="45bad-314">53,7</span><span class="sxs-lookup"><span data-stu-id="45bad-314">53.7</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-315">56,8</span><span class="sxs-lookup"><span data-stu-id="45bad-315">56.8</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-316">58,2</span><span class="sxs-lookup"><span data-stu-id="45bad-316">58.2</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-317">60,6</span><span class="sxs-lookup"><span data-stu-id="45bad-317">60.6</span></span>
    :::column-end:::
:::row-end:::
:::row:::
    :::column:::
        <span data-ttu-id="45bad-318">S</span><span class="sxs-lookup"><span data-stu-id="45bad-318">S</span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="45bad-319">43,0</span><span class="sxs-lookup"><span data-stu-id="45bad-319">43.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-320">40,0</span><span class="sxs-lookup"><span data-stu-id="45bad-320">40.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-321">35,0</span><span class="sxs-lookup"><span data-stu-id="45bad-321">35.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="45bad-322">34,5</span><span class="sxs-lookup"><span data-stu-id="45bad-322">34.5</span></span>
    :::column-end:::
:::row-end:::


<span data-ttu-id="45bad-323">**Таблица 1** . Вычисление параметров басикфото освещенности</span><span class="sxs-lookup"><span data-stu-id="45bad-323">**Table 1** : BasicPhoto lightness compression parameter calculation</span></span>

<span data-ttu-id="45bad-324">Чтобы использовать S как LUT (S <sub>LUT</sub> ), его сначала необходимо нормализовать в диапазон освещенности \[ 0100 \] .</span><span class="sxs-lookup"><span data-stu-id="45bad-324">To use S as a lightness mapping LUT (S <sub>LUT</sub> ) it must first be normalized into the lightness range of \[0,100\].</span></span> <span data-ttu-id="45bad-325">Нормализованные данные затем масштабируются в динамический диапазон целевого устройства, как показано в уравнении 4, где *j*<sub>min/ *out*</sub> и *J*<sub>Max \ *out*</sub> — это значения яркости черной точки и белой точки на носителе воспроизведения соответственно.</span><span class="sxs-lookup"><span data-stu-id="45bad-325">The normalized data is then scaled into the dynamic range of the destination device, as shown in Equation 4, where *J*<sub>min\ *Out*</sub> and *J*<sub>max\ *Out*</sub> are the values of lightness of the black point and the white point of the reproduction medium, respectively.</span></span>

![Показывает формулу для S в качестве LUT сопоставления.](images/gmmp-image018.png) <span data-ttu-id="45bad-327">(4)</span><span class="sxs-lookup"><span data-stu-id="45bad-327">(4)</span></span>

<span data-ttu-id="45bad-328">На этом этапе значения *J s* можно получить из <sub>LUT</sub> , выполнив интерполяцию между точками *m* соответствующих значений *j O* и *j S* , которые он содержит, и используя в качестве входных данных следующее уравнение.</span><span class="sxs-lookup"><span data-stu-id="45bad-328">At this point, the *J S* values can be obtained from the S <sub>LUT</sub> by interpolating between the *m* points of corresponding *J O'* and *J S* values it contains, and using the following equation as the input.</span></span>

![Показывает формулу для получения значений J S.](images/gmmp-image020.png) <span data-ttu-id="45bad-330">(5)</span><span class="sxs-lookup"><span data-stu-id="45bad-330">(5)</span></span>

<span data-ttu-id="45bad-331">J <sub>Минин</sub> — это значение освещенности черной точки исходного носителя, j <sub>Максин</sub> — это значение освещенности белой точки исходного носителя, а j <sub>O</sub> — исходная лампочка.</span><span class="sxs-lookup"><span data-stu-id="45bad-331">J <sub>minIn</sub> is the lightness value of the black point of the original medium, J <sub>maxIn</sub> is the lightness value of the white point of the original medium, and J <sub>O</sub> is the original lightness.</span></span> <span data-ttu-id="45bad-332">Для последующего использования можно обозначить функцию *сигмоидал,* определенную в описанной выше форме, как показано на следующем рисунке 4.</span><span class="sxs-lookup"><span data-stu-id="45bad-332">For later reference, you can denote by *S* the sigmoidal function defined in the manner just outlined, as illustrated in the following Figure 4.</span></span>

![Схема, показывающая граф для сопоставления чрома и постоянной освещенности.](images/gmmp-image024.png)

<span data-ttu-id="45bad-334">**Рисунок 4** . Сопоставление чрома вдоль постоянной освещенности</span><span class="sxs-lookup"><span data-stu-id="45bad-334">**Figure 4** : Chroma mapping along constant lightness</span></span>

<span data-ttu-id="45bad-335">Во-вторых, если граница целевой палитры имеет цвет «цвет», сжимать чрома вдоль линий постоянной освещенности (l) и выполнять сжатие следующим образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-335">Second, if the destination gamut boundary is chromatic, compress chroma along lines of constant lightness (l) and perform the compression as follows.</span></span>

![Показывает формулу для выполнения сжатия чрома.](images/gmmp-image026.png) <span data-ttu-id="45bad-337"> (6)</span><span class="sxs-lookup"><span data-stu-id="45bad-337">(6)</span></span>

<span data-ttu-id="45bad-338">где *d* представляет расстояние от *E* на *l*; *g* представляет границу средней границы; *r* представляет воспроизведение; и *o* на исходном рисунке 5.</span><span class="sxs-lookup"><span data-stu-id="45bad-338">where *d* represents distance from *E* on *l*;*g* represents the medium gamut boundary; *r* represents the reproduction; and *o* the original Figure 5.</span></span>

![Схема, показывающая диаграмму для чрома и сжатия яркости в Басикфото.](images/gmmp-image028.png)

<span data-ttu-id="45bad-340">**Рис. 5** . сжатие чрома и освещения в басикфото</span><span class="sxs-lookup"><span data-stu-id="45bad-340">**Figure 5** : Chroma and lightness compression in BasicPhoto</span></span>

<span data-ttu-id="45bad-341">Если граница цветовой гаммы назначения является монохромной, то значение чрома обрезается до нуля.</span><span class="sxs-lookup"><span data-stu-id="45bad-341">If the destination gamut boundary is monochrome, then the chroma value is clipped to zero.</span></span>

<span data-ttu-id="45bad-342">В-третьих, используйте клип Минкд (описан ранее), чтобы устранить ошибку остатка.</span><span class="sxs-lookup"><span data-stu-id="45bad-342">Third, use a MinCD clip (described earlier) to eliminate any residual error.</span></span>

### <a name="black-enhancement"></a><span data-ttu-id="45bad-343">Черное расширение</span><span class="sxs-lookup"><span data-stu-id="45bad-343">Black enhancement</span></span>

<span data-ttu-id="45bad-344">Предыдущий алгоритм можно изменить, чтобы улучшить черный цвет, если назначением является устройство принтера.</span><span class="sxs-lookup"><span data-stu-id="45bad-344">The preceding algorithm can be modified to improve the black when the destination is a printer device.</span></span> <span data-ttu-id="45bad-345">Эта ошибка связана с выбором *J <sub>минаут</sub>*, который обычно не соответствует темному цвету, который может быть создан принтером.</span><span class="sxs-lookup"><span data-stu-id="45bad-345">The issue has to do with the choice of *J<sub>minOut</sub>*, which usually does not correspond to the darkest color a printer can produce.</span></span>

<span data-ttu-id="45bad-346">В частности, цвет с наибольшей плотностью, полученный путем размещения 100 процентов красок (или максимально возможного покрытия, если действует ограничение ГКР/Ink), обычно не является нейтральным в области отображения цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-346">More specifically, the color with highest density, obtained by putting 100 percent inks (or maximum possible coverage, if GCR/ink limiting is in effect), is usually not "neutral" in the color appearance space.</span></span> <span data-ttu-id="45bad-347">См. рис. 6.</span><span class="sxs-lookup"><span data-stu-id="45bad-347">See Figure 6.</span></span> <span data-ttu-id="45bad-348">Иными словами, если для целевого устройства используется нейтральная Минимальная освещенность, то создаваемый масштабируемый элемент будет сопоставляться с минимальным значением плотности, которое может быть достигнуто принтером.</span><span class="sxs-lookup"><span data-stu-id="45bad-348">In other words, if neutral minimum lightness is used for the destination device, the lightness scaler constructed will map to a minimum lightness that is not the highest density that can be achieved by the printer.</span></span> <span data-ttu-id="45bad-349">Рассмотрим дальнейший вариант использования монитора для печати.</span><span class="sxs-lookup"><span data-stu-id="45bad-349">Consider the further use case of monitor to printer.</span></span> <span data-ttu-id="45bad-350">Черный монитор, R = G = B = 0, будет распечатан как не самая высокая плотность.</span><span class="sxs-lookup"><span data-stu-id="45bad-350">The monitor black, R=G=B=0, will then be printed as not the highest density.</span></span> <span data-ttu-id="45bad-351">Влияние на качество изображения заключается в том, что существует нехватка глубины и контрастности.</span><span class="sxs-lookup"><span data-stu-id="45bad-351">The impact on the image quality is that there is a lack of depth and contrast.</span></span>

![Схема, показывающая, как черная точка устройства может быть темнее, чем нейтральная Минимальная освещенность.](images/gmmp-seqfigure01.png)

<span data-ttu-id="45bad-353">**Рис. 6** . Черная точка устройства может быть темнее, чем нейтральная Минимальная освещенность.</span><span class="sxs-lookup"><span data-stu-id="45bad-353">**Figure 6** : The device black point may be darker than the neutral minimum lightness.</span></span>

<span data-ttu-id="45bad-354">Предположим, что местом назначения "Черная точка устройства" является Жкакбк/Жкккх k.</span><span class="sxs-lookup"><span data-stu-id="45bad-354">Suppose the destination "device black point" is Jₖaₖbₖ/JₖCₖh ₖ.</span></span> <span data-ttu-id="45bad-355">Если параметр C k не равен нулю, то черная точка устройства не нейтральна относительно CAM02.</span><span class="sxs-lookup"><span data-stu-id="45bad-355">If C ₖ is not zero, then the device black point is not neutral relative to CAM02.</span></span> <span data-ttu-id="45bad-356">При использовании J k для назначения «нейтральная Минимальная освещенность» в построении масштабируемых элементов; то есть, параметр</span><span class="sxs-lookup"><span data-stu-id="45bad-356">If you use J ₖ for the destination "neutral minimum lightness" in the construction of the lightness scaler; that is, setting</span></span>

<span data-ttu-id="45bad-357">*J <sub>минаут</sub> = ЖК*</span><span class="sxs-lookup"><span data-stu-id="45bad-357">*J<sub>minOut</sub> = Jₖ*</span></span>

<span data-ttu-id="45bad-358">и применить его к исходной оболочке палитры, вы получаете конфигурацию, показанную на рис. 7.</span><span class="sxs-lookup"><span data-stu-id="45bad-358">and apply it to the source gamut shell, you obtain the configuration depicted in Figure 7.</span></span> <span data-ttu-id="45bad-359">На рисунке плоскость оттенок соответствует h k.</span><span class="sxs-lookup"><span data-stu-id="45bad-359">In the figure, the hue plane corresponds to h ₖ.</span></span>

![Схема, на которой показан измененный масштабируемый элемент с черной точкой устройства назначения.](images/gmmp-seqfigure02.png)

<span data-ttu-id="45bad-361">**Рис. 7** . Геометрическая схема с помощью измененного средства масштабирования яркости с конечной точкой устройства назначения</span><span class="sxs-lookup"><span data-stu-id="45bad-361">**Figure 7** : Geometry using the modified lightness scaler with destination device black point</span></span>

<span data-ttu-id="45bad-362">Чтобы использовать последующий алгоритм сжатия чрома, необходимо согласовать максимальный и минимальный лигхтнессес в исходных и конечных оболочках.</span><span class="sxs-lookup"><span data-stu-id="45bad-362">To allow the subsequent chroma compression algorithm to proceed, you want to align the maximum and minimum lightnesses on the source and destination shells.</span></span> <span data-ttu-id="45bad-363">Это можно сделать, настроив конечную оболочку между J <sub>неутралмин</sub> и j k, перемещая точки влево.</span><span class="sxs-lookup"><span data-stu-id="45bad-363">This can be achieved by adjusting the destination shell between J <sub>neutralMin</sub> and J ₖ by shifting points to the left.</span></span> <span data-ttu-id="45bad-364">Кроме того, это преобразование должно применяться ко всему Jab пространству, а не только к плоскости оттенка, соответствующей h k.</span><span class="sxs-lookup"><span data-stu-id="45bad-364">Furthermore, this transformation must be applied on the whole Jab space, not just the hue plane corresponding to h ₖ.</span></span>

<span data-ttu-id="45bad-365">Преобразование имеет значение</span><span class="sxs-lookup"><span data-stu-id="45bad-365">The transformation is</span></span>

![Показывает формулу преобразования.](images/gmmp-seqfigure03.png)

<span data-ttu-id="45bad-367">На рис. 8 показан результат преобразования.</span><span class="sxs-lookup"><span data-stu-id="45bad-367">Figure 8 shows the effect of the transformation.</span></span>

![Схема, на которой показан результат измененной масштабируемости освещения с помощью черной точки устройства назначения.](images/gmmp-seqfigure04.png)

<span data-ttu-id="45bad-369">**Рис. 8** . Геометрическая схема с помощью измененного средства масштабирования яркости с конечной точкой устройства назначения</span><span class="sxs-lookup"><span data-stu-id="45bad-369">**Figure 8** : Geometry using the modified lightness scaler with destination device black point</span></span>

<span data-ttu-id="45bad-370">После применения обычного алгоритма сжатия чрома точка должна быть перемещена обратно; это значит, что для получения окончательного сопоставленного цвета необходимо применить обратное преобразование.</span><span class="sxs-lookup"><span data-stu-id="45bad-370">After applying the usual chroma compression algorithm, the point must then be "shifted back;" that is, the inverse transformation must be applied to obtain the final mapped color.</span></span>

![Показывает формулу для обратного преобразования для получения окончательного сопоставленного цвета.](images/gmmp-seqfigure05.png)

### <a name="the-case-of-dual-gamut-shells"></a><span data-ttu-id="45bad-372">Случаи использования оболочек с двойным охватом</span><span class="sxs-lookup"><span data-stu-id="45bad-372">The case of dual gamut shells</span></span>

<span data-ttu-id="45bad-373">Целью является обобщение SIG \_ завяз для одной оболочки палитры, если исходное устройство ГБД или целевое устройство ГБД имеют структуру из двух оболочек.</span><span class="sxs-lookup"><span data-stu-id="45bad-373">The goal is to generalize SIG\_KNEE for single gamut shell to the case where either the source device GBD or the destination device GBD has a two-shell structure.</span></span> <span data-ttu-id="45bad-374">Внутренняя оболочка будет называться справочной оболочкой, а внешняя оболочка будет называться оболочкой правдоподобные.</span><span class="sxs-lookup"><span data-stu-id="45bad-374">The inner shell will be called the Reference Shell, while the outer shell will be called the Plausible Shell.</span></span> <span data-ttu-id="45bad-375">Необходимо учитывать следующие случаи.</span><span class="sxs-lookup"><span data-stu-id="45bad-375">You want to consider the following cases.</span></span>

<span data-ttu-id="45bad-376">(a) как исходный ГБД, так и целевой ГБД имеют структуру с двумя оболочками.</span><span class="sxs-lookup"><span data-stu-id="45bad-376">(a) Both the source GBD and destination GBD have a two-shell structure.</span></span>

<span data-ttu-id="45bad-377">(б) источник ГБД имеет структуру с двумя оболочками; Целевой ГБД имеет только одну оболочку.</span><span class="sxs-lookup"><span data-stu-id="45bad-377">(b) The source GBD has a two-shell structure; the destination GBD has only one shell.</span></span>

<span data-ttu-id="45bad-378">(c) источник ГБД имеет только одну оболочку; Целевой ГБД имеет структуру из двух оболочек.</span><span class="sxs-lookup"><span data-stu-id="45bad-378">(c) The source GBD has only one shell; the destination GBD has a two-shell structure.</span></span>

<span data-ttu-id="45bad-379">(d) как исходный ГБД, так и целевой ГБД имеют только одну оболочку.</span><span class="sxs-lookup"><span data-stu-id="45bad-379">(d) Both the source GBD and destination GBD have only one shell.</span></span>

<span data-ttu-id="45bad-380">Вариант (d) — это случай оболочки одной палитры, которая обсуждалась ранее.</span><span class="sxs-lookup"><span data-stu-id="45bad-380">Case (d) is the case of single gamut shell that was discussed previously.</span></span> <span data-ttu-id="45bad-381">В случаях (a), (b) и (c) можно обобщить перемасштабирование, чтобы использовать дополнительную информацию из двойной структуры оболочки.</span><span class="sxs-lookup"><span data-stu-id="45bad-381">For cases (a), (b), and (c), you can generalize the lightness rescaling to use the extra information from the dual shell structure.</span></span> <span data-ttu-id="45bad-382">В случаях (b) и (c), где либо источник, либо назначение имеют только одну оболочку, вы привлечете «инициированную оболочку ссылок», которая будет рассмотрена в следующем разделе «Принудительная оболочка ссылок».</span><span class="sxs-lookup"><span data-stu-id="45bad-382">In cases (b) and (c) where either the source or the destination has only one shell, you introduce an "induced reference shell" which will be discussed in a subsequent section, "Induced Reference Shell."</span></span> <span data-ttu-id="45bad-383">Общий алгоритм для двух оболочек будет описан для случая (a).</span><span class="sxs-lookup"><span data-stu-id="45bad-383">The general algorithm for two shells will be described for case (a).</span></span> <span data-ttu-id="45bad-384">После объяснения созданной эталонной оболочки можно применить алгоритм к регистру (b) и (c).</span><span class="sxs-lookup"><span data-stu-id="45bad-384">After the Induced Reference Shell construction is explained, the algorithm can be applied to case (b) and (c), as well.</span></span> <span data-ttu-id="45bad-385">Как и для сжатия чрома, коэффициент сжатия определяется максимальными доступными оболочками.</span><span class="sxs-lookup"><span data-stu-id="45bad-385">As for chroma compression, the compression ratio will be determined by the largest shells available.</span></span> <span data-ttu-id="45bad-386">Иными словами, если доступны как оболочка правдоподобные, так и справочная оболочка, будет использоваться оболочка правдоподобные. в противном случае будет использоваться ссылка на оболочку.</span><span class="sxs-lookup"><span data-stu-id="45bad-386">In other words, if both the Plausible Shell and Reference Shell are available, the Plausible Shell will be used; otherwise, the Reference Shell will be used.</span></span>

<span data-ttu-id="45bad-387">*Обобщенное перемасштабирование освещенности*</span><span class="sxs-lookup"><span data-stu-id="45bad-387">*Generalized Lightness Rescaling*</span></span>

<span data-ttu-id="45bad-388">Существование двух оболочек как для источника, так и для назначения ГБД означает, что необходимо соотнести набор из четырех точек из источника ГБД с соответствующим набором в целевом ГБД.</span><span class="sxs-lookup"><span data-stu-id="45bad-388">The existence of two shells for both source and destination GBD means that you must map a set of four points from the source GBD to a corresponding set in the destination GBD.</span></span>

![Показывает, как сопоставлять набор из четырех точек с соответствующим набором.](images/gmmp-image030.png)

<span data-ttu-id="45bad-390">Индексы имеют следующие значения.</span><span class="sxs-lookup"><span data-stu-id="45bad-390">The subscripts have the following meanings.</span></span>

<span data-ttu-id="45bad-391">o или r: "Original" (источник) или "Воспроизведение" (назначение)</span><span class="sxs-lookup"><span data-stu-id="45bad-391">o or r: "original" (source) or "reproduction" (destination)</span></span>

<span data-ttu-id="45bad-392">min или Max: минимальная нейтральная освещенность или максимальная нейтральная освещенность</span><span class="sxs-lookup"><span data-stu-id="45bad-392">min or max: minimum neutral lightness or maximum neutral lightness</span></span>

<span data-ttu-id="45bad-393">PLA или ref: оболочка правдоподобные или эталонная оболочка</span><span class="sxs-lookup"><span data-stu-id="45bad-393">pla or ref: Plausible Shell or Reference Shell</span></span>

<span data-ttu-id="45bad-394">Упорядочение в каждом четвере также является ожидаемой относительной величиной этих точек.</span><span class="sxs-lookup"><span data-stu-id="45bad-394">The ordering in each quadruple is also the expected relative magnitude of these points.</span></span>

<span data-ttu-id="45bad-395">В сопоставлении «Автомасштабирование» используются те же первые уравнения, что и в одной оболочке, но *J S* определяется кусочно-способом следующим образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-395">The Lightness Rescaling map uses the same first two equations as the single shell, but *J S* is defined in a piecewise manner as follows.</span></span>

![Показывает формулу для J S кусочно-способом.](images/gmmp-image032.png) <span data-ttu-id="45bad-397">(7)</span><span class="sxs-lookup"><span data-stu-id="45bad-397">(7)</span></span>

<span data-ttu-id="45bad-398">Иными словами, он сигмоидал в оболочке справочника и линейный за пределами.</span><span class="sxs-lookup"><span data-stu-id="45bad-398">In other words, it is sigmoidal within the reference shell, and linear outside.</span></span> <span data-ttu-id="45bad-399">См. рис. 9.</span><span class="sxs-lookup"><span data-stu-id="45bad-399">See Figure 9.</span></span>

![Схема, на которой показан график для функции повторного масштабирования для двух оболочек Гбдс.](images/gmmp-image033.png)

<span data-ttu-id="45bad-401">**Рис. 9** . Функция повторного масштабирования для двух оболочек гбдс</span><span class="sxs-lookup"><span data-stu-id="45bad-401">**Figure 9** : Lightness Rescaling function for two-shell GBDs</span></span>

<span data-ttu-id="45bad-402">**ОБОЛОЧКА ПРИНУДИТЕЛЬНОЙ ССЫЛКИ**</span><span class="sxs-lookup"><span data-stu-id="45bad-402">**INDUCED REFERENCE SHELL**</span></span>

<span data-ttu-id="45bad-403">Если один ГБД имеет одну оболочку, а другая ГБД имеет две оболочки, необходимо создать "ссылку на оболочку" для ГБД только с одной оболочкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-403">Where one GBD has one shell and the other GBD has two shells, you must create a "Reference Shell" for the GBD with only one shell.</span></span> <span data-ttu-id="45bad-404">Существующая оболочка, которая вызывалась как ссылка на оболочку, будет заменена на "оболочка правдоподобные". На самом деле, нет необходимости создавать оболочку в полном Jab пространстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-404">The existing shell, which would be called the Reference Shell, will be changed to the "Plausible Shell."In fact, you don't actually have to create a shell in the full Jab space.</span></span> <span data-ttu-id="45bad-405">Так как в перемасштабировании освещенности используются только значения *j Max* и *j min*, то необходимо только сделать это значение для принудительной оболочки.</span><span class="sxs-lookup"><span data-stu-id="45bad-405">Because the lightness rescaling only uses *J max* and *J min*, you only have to make up these values for the induced Reference Shell.</span></span> <span data-ttu-id="45bad-406">Существует два варианта, в зависимости от того, какие ГБД имеют две оболочки.</span><span class="sxs-lookup"><span data-stu-id="45bad-406">There are two cases, depending on which GBD has two shells.</span></span>

<span data-ttu-id="45bad-407">Вариант 1. источник ГБД имеет две оболочки; Назначение ГБД имеет одну оболочку.</span><span class="sxs-lookup"><span data-stu-id="45bad-407">Case 1: Source GBD has two shells; destination GBD has one shell.</span></span>

<span data-ttu-id="45bad-408">Определите конечную оболочку, принудительно вызывающую ссылку на нейтральную ось. то есть к оболочке J <sub>r, \ min, \ ref</sub> и J <sub>r, \ Max, \ ref</sub> .</span><span class="sxs-lookup"><span data-stu-id="45bad-408">Determine the destination induced Reference Shell on the neutral axis; that is, the J <sub>r,\ min,\ ref</sub> and J <sub>r,\ max,\ ref</sub> of the shell.</span></span> <span data-ttu-id="45bad-409">Это делается с помощью следующего алгоритма.</span><span class="sxs-lookup"><span data-stu-id="45bad-409">This is done using the following algorithm.</span></span>

![Показывает алгоритм определения целевой оболочки, вызывающей привязку.](images/gmmp-induced01.png)

<span data-ttu-id="45bad-411">Факторы</span><span class="sxs-lookup"><span data-stu-id="45bad-411">The factors ?</span></span> <span data-ttu-id="45bad-412"><sub>низкая</sub> и?</span><span class="sxs-lookup"><span data-stu-id="45bad-412"><sub>low</sub> and ?</span></span> <span data-ttu-id="45bad-413"><sub>Управление</sub> разделением между оболочкой правдоподобные и справочной оболочкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-413"><sub>high</sub> control the separation between the Plausible Shell and the Reference Shell.</span></span> <span data-ttu-id="45bad-414">Значение 1 означает, что значения, указанные в параметре J <sub>min</sub> или j m ₐ ₓ совпадают.</span><span class="sxs-lookup"><span data-stu-id="45bad-414">A value of 1 means that the J <sub>min</sub> values or J ₘₐₓ values coincide.</span></span> <span data-ttu-id="45bad-415">Их значения — "принудительно" из исходной справочной оболочки и исходной оболочки правдоподобные.</span><span class="sxs-lookup"><span data-stu-id="45bad-415">Their values are "induced" from the source Reference Shell and source Plausible Shell.</span></span>

![Показывает формулу для значений исходной оболочки и исходной оболочки правдоподобные.](images/gmmp-induced02.png)

<span data-ttu-id="45bad-417">«Параметрные факторы» F <sub>Low</sub> и f <sub>High</sub> являются *настраиваемыми параметрами* , которые должны находиться в диапазоне от 0 до 1.</span><span class="sxs-lookup"><span data-stu-id="45bad-417">The "fudge factors" F <sub>low</sub> and F <sub>high</sub> are *tunable parameters* that must lie between 0 and 1.</span></span> <span data-ttu-id="45bad-418">Если значение равно 0, то значения J <sub>min</sub> или j m ₐ ₓ напрямую помещаются из оболочек-источников.</span><span class="sxs-lookup"><span data-stu-id="45bad-418">If the value is 0, then the J <sub>min</sub> or J ₘₐₓ are directly induced from the source shells.</span></span> <span data-ttu-id="45bad-419">В этом случае выберите F <sub>Low</sub> = 0,95 и F <sub>High</sub> = 0,1.</span><span class="sxs-lookup"><span data-stu-id="45bad-419">For this case, choose F <sub>low</sub> = 0.95, and F <sub>high</sub> = 0.1.</span></span>

<span data-ttu-id="45bad-420">Вариант 2. источник ГБД имеет одну оболочку; Назначение ГБД имеет две оболочки.</span><span class="sxs-lookup"><span data-stu-id="45bad-420">Case 2: Source GBD has one shell; destination GBD has two shells.</span></span>

<span data-ttu-id="45bad-421">Определите исходную вызывающую оболочку на нейтральной оси. то есть с оболочкой J <sub>o, \ min, \ ref</sub> и J <sub>o, \ Max, \ ref</sub> .</span><span class="sxs-lookup"><span data-stu-id="45bad-421">Determine the source induced Reference Shell on the neutral axis; that is, the J <sub>o,\ min,\ ref</sub> and J <sub>o,\ max,\ ref</sub> of the shell.</span></span> <span data-ttu-id="45bad-422">Это делается с помощью следующего алгоритма.</span><span class="sxs-lookup"><span data-stu-id="45bad-422">This is done using the following algorithm.</span></span>

![Показывает алгоритм определения целевой оболочки на нейтральной оси.](images/gmmp-induced03.png)

<span data-ttu-id="45bad-424">Опять же, факторы?</span><span class="sxs-lookup"><span data-stu-id="45bad-424">Again, the factors ?</span></span> <span data-ttu-id="45bad-425"><sub>низкая</sub> и?</span><span class="sxs-lookup"><span data-stu-id="45bad-425"><sub>low</sub> and ?</span></span> <span data-ttu-id="45bad-426"><sub>Управление</sub> разделением между оболочкой правдоподобные и справочной оболочкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-426"><sub>high</sub> control the separation between the Plausible Shell and Reference Shell.</span></span> <span data-ttu-id="45bad-427">Значение 1 означает, что значения параметра J <sub>min</sub> или j m ₐ ₓ совпадают.</span><span class="sxs-lookup"><span data-stu-id="45bad-427">A value of 1 means the J <sub>min</sub> values or J ₘₐₓ values coincide.</span></span> <span data-ttu-id="45bad-428">Их значения — "принудительно" из исходной справочной оболочки и исходной оболочки правдоподобные:</span><span class="sxs-lookup"><span data-stu-id="45bad-428">Their values are "induced" from the source Reference Shell and source Plausible Shell:</span></span>

![Показывает алгоритм управления разделением между справочной оболочкой и исходной оболочкой правдоподобные.](images/gmmp-induced04.png)

### <a name="reasons-for-changes-from-the-cie-tc8-03-recommendations"></a><span data-ttu-id="45bad-430">Причины изменений в рекомендациях ЦИЕ TC8-03</span><span class="sxs-lookup"><span data-stu-id="45bad-430">Reasons for changes from the CIE TC8-03 recommendations</span></span>

<span data-ttu-id="45bad-431">Басикфото отличается от рекомендаций ЦИЕ TC8-03 следующими способами.</span><span class="sxs-lookup"><span data-stu-id="45bad-431">BasicPhoto differs from the CIE TC8-03 recommendations in the following ways.</span></span>

1.  <span data-ttu-id="45bad-432">Чрома не сжимается в КУСП, но вдоль линий постоянной освещенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-432">Chroma is not compressed toward the cusp but along lines of constant lightness.</span></span>
2.  <span data-ttu-id="45bad-433">Диапазон освещенности использует освещение самого темного цвета в цветовой гамме, а не точку, в которой граница цветового охвата пересекает нейтральную ось.</span><span class="sxs-lookup"><span data-stu-id="45bad-433">The lightness range uses the lightness of the darkest color in the gamut rather than the point at which the gamut boundary crosses the neutral axis.</span></span>
3.  <span data-ttu-id="45bad-434">Басикфото поддерживает как эталонную оболочку, так и оболочку правдоподобные-палитры, если какая-либо граница палитры в преобразовании имеет две оболочки.</span><span class="sxs-lookup"><span data-stu-id="45bad-434">BasicPhoto supports both a reference gamut shell and a plausible gamut shell, if either gamut boundary in the transform has two shells.</span></span>
4.  <span data-ttu-id="45bad-435">Басикфото использует CIECAM02; Вместо использования CIECAM97s для преобразования в D65 на компакт-диске 400 CD/m2 и последующем использовании цветового пространства рит скрип.</span><span class="sxs-lookup"><span data-stu-id="45bad-435">BasicPhoto uses CIECAM02; instead of using CIECAM97s to convert to D65 at 400 cd/m2, and then using RIT IPT color space.</span></span>

<span data-ttu-id="45bad-436">Было сделано первое изменение, чтобы избежать проблем с инверсией тона, которые могут возникнуть при использовании сжатия в КУСП.</span><span class="sxs-lookup"><span data-stu-id="45bad-436">The first change was made to prevent tone inversion problems that can occur when using compression toward a cusp.</span></span> <span data-ttu-id="45bad-437">Как показано на рис. 10, сжатие КУСП может привести к инверсии тона.</span><span class="sxs-lookup"><span data-stu-id="45bad-437">As shown in Figure 10, cusp compression can cause tone inversions.</span></span> <span data-ttu-id="45bad-438">Это может произойти, когда цвета высокого чрома светлее, чем цвета более низкого чрома.</span><span class="sxs-lookup"><span data-stu-id="45bad-438">This can happen when colors of high chroma are lighter than colors of lower chroma.</span></span> <span data-ttu-id="45bad-439">Так как СГКК сжимает каждый пиксель независимо друг от друга и чрома, не гарантируется сохранение отношения падения между значениями пикселя после сжатия.</span><span class="sxs-lookup"><span data-stu-id="45bad-439">Because SGCK compresses each pixel independently in both lightness and chroma, it is not guaranteed to preserve the lightness relationship between the pixel values after the compression.</span></span> <span data-ttu-id="45bad-440">Хорошо известное негативное противопоставление этому решению при сжатии по строкам постоянной освещенности заключается в том, что вы можете негативно пострадать от чрома, особенно в тех областях, где граница целевого диапазона является очень плоской, как это происходит с ярко-желтым цветом.</span><span class="sxs-lookup"><span data-stu-id="45bad-440">The well-known downside to this decision to compress on lines of constant lightness is that you can suffer losses of chroma, particular in areas where the destination gamut boundary is very flat, as happens with bright yellows.</span></span>

![Схема, показывающая инверсию тона, вызванную СГКК.](images/gmmp-toneinversion.png)

<span data-ttu-id="45bad-442">**Рис. 10** . Инверсия сигнала, ВЫЗВАНная сгкк</span><span class="sxs-lookup"><span data-stu-id="45bad-442">**Figure 10** : Tone inversion caused by SGCK</span></span>

![Показывает исходный образ чайник.](images/originalteapot.jpg)![Показывает СГККный результат изображения чайник.](images/badteapot.jpg)![Показывает Басикфотоный результат изображения чайник.](images/betterteapot.jpg)

<span data-ttu-id="45bad-446">**Рис. 11** . исходный образ, результат сгкк и результат басикфото</span><span class="sxs-lookup"><span data-stu-id="45bad-446">**Figure 11** : Original image, SGCK result, and BasicPhoto result</span></span>

<span data-ttu-id="45bad-447">На рис. 11 показана эта инверсия сигнала.</span><span class="sxs-lookup"><span data-stu-id="45bad-447">Figure 11 illustrates this tone inversion.</span></span> <span data-ttu-id="45bad-448">Слева находится исходный образ, захваченный цифровой камерой. в центре образ воспроизводится с помощью СГКК; как и справа, образ воспроизводится Басикфото.</span><span class="sxs-lookup"><span data-stu-id="45bad-448">On the left is an original image captured by a digital camera; in the center, the image as reproduced by SGCK; and on the right, the image as reproduced by BasicPhoto.</span></span> <span data-ttu-id="45bad-449">Изображение слева находится в цветовой области цифровой камеры, а центральные и правые изображения — в цветовом пространстве ЖК-дисплея.</span><span class="sxs-lookup"><span data-stu-id="45bad-449">The image on the left is in the digital camera's color space, the center and right images are in the color space of an LCD video display.</span></span> <span data-ttu-id="45bad-450">В исходном изображении верхняя часть чайник темнее нижней, так как в нижней части отражена скатерть, в которой он находится.</span><span class="sxs-lookup"><span data-stu-id="45bad-450">In the original image, the top part of the teapot is darker than the bottom, because the bottom is reflecting the tablecloth that it is sitting upon.</span></span> <span data-ttu-id="45bad-451">В изображении СГКК верхняя часть на самом деле светлее, чем нижняя, из-за инверсии тона.</span><span class="sxs-lookup"><span data-stu-id="45bad-451">In the SGCK image, the top part is actually lighter than the bottom, because of the tone inversion.</span></span> <span data-ttu-id="45bad-452">Кроме того, элементы, отображаемые в нижней части чайник, трудно увидеть.</span><span class="sxs-lookup"><span data-stu-id="45bad-452">Also, it is difficult to see the items reflected in the lower part of the teapot.</span></span> <span data-ttu-id="45bad-453">В правой версии Басикфото была исправлена инверсия тона, а отраженные статьи более четко различимы.</span><span class="sxs-lookup"><span data-stu-id="45bad-453">On the right, BasicPhoto has fixed the tone inversion and the reflected articles are more clearly distinguishable.</span></span>

<span data-ttu-id="45bad-454">Было сделано второе изменение, чтобы улучшить воспроизведение почти черных цветов на принтерах, где черный черный не попадает непосредственно на нейтральную ось CIECAM02.</span><span class="sxs-lookup"><span data-stu-id="45bad-454">The second change was made to improve the reproduction of nearly black colors on printers where the blackest black does not fall directly on the CIECAM02 neutral axis.</span></span> <span data-ttu-id="45bad-455">На следующем рис. 12 показан образ, преобразованный в sRGB; воспроизводится для струйного принтера RGB с помощью СГКК; и воспроизводится для того же принтера с помощью Басикфото.</span><span class="sxs-lookup"><span data-stu-id="45bad-455">The following Figure 12 shows an image converted to sRGB; reproduced for an RGB inkjet printer using SGCK; and reproduced for the same printer using BasicPhoto.</span></span> <span data-ttu-id="45bad-456">Изображение в центре не использует полный черный на устройстве и поэтому не имеет контраста, показанного в оригинале.</span><span class="sxs-lookup"><span data-stu-id="45bad-456">The image in the center is not using the full device black, and so it lacks the contrast seen in the original.</span></span> <span data-ttu-id="45bad-457">Контраст восстанавливается с помощью Басикфото.</span><span class="sxs-lookup"><span data-stu-id="45bad-457">The contrast is restored with BasicPhoto.</span></span>

![Показывает исходное изображение набора воспроизведения.](images/playstructure.jpg)![Показывает изображение набора воспроизведения, воспроизводимого для струйного принтера R G B с помощью СГКК.](images/playstructurebad.jpg)![Показывает изображение набора воспроизведения, воспроизводимого для струйного принтера R G B с помощью Басикфото.](images/betterplaystructure.jpg)

<span data-ttu-id="45bad-461">**Рис. 12** . Расширенный черный</span><span class="sxs-lookup"><span data-stu-id="45bad-461">**Figure 12** : Enhanced black</span></span>

<span data-ttu-id="45bad-462">Было внесено третье изменение для улучшения воспроизведения цветов для цифровых камер.</span><span class="sxs-lookup"><span data-stu-id="45bad-462">The third change was made to improve the color reproduction for digital cameras.</span></span> <span data-ttu-id="45bad-463">В частности, в случаях, когда цифровая камера была профилирована с помощью эталонной цели, описание границы палитры, построенное на основе измеренных цветов, может не включать все цвета, которые могут быть записаны в реальной сцене.</span><span class="sxs-lookup"><span data-stu-id="45bad-463">Particularly in cases where the digital camera has been profiled using a reference target, a gamut boundary description built from measured colors might not include all the colors that might be captured in a real world scene.</span></span> <span data-ttu-id="45bad-464">Вместо того чтобы обрезать все цвета до цветового охвата целевого объекта «измеряемый цвет», можно использовать экстраполяцию для создания границы правдоподобные-диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-464">Rather than clipping all colors to the gamut of the measured color target, you allow for extrapolation to produce a plausible gamut boundary.</span></span> <span data-ttu-id="45bad-465">Алгоритм Басикфото предназначен для поддержки такой экстраполяции границы охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-465">The BasicPhoto algorithm is designed to support such an extrapolated gamut boundary.</span></span>

<span data-ttu-id="45bad-466">Было сделано четвертое изменение, так как CIECAM02 хорошо работает при сопоставлении цветовых диапазонов.</span><span class="sxs-lookup"><span data-stu-id="45bad-466">The fourth change was made because CIECAM02 works well for gamut mapping.</span></span> <span data-ttu-id="45bad-467">Процесс, рекомендованный TC8-03 преобразования цветов устройства в D65 на компакт-диске 400 CD/m2, и последующее использование цветового пространства рит скрип — это как ресурсоемкие, так и длительные вычисления.</span><span class="sxs-lookup"><span data-stu-id="45bad-467">The process recommended by TC8-03 of converting device colors to D65 at 400 cd/m2, and then using the RIT IPT color space is both computation-intensive and time-consuming.</span></span>

### <a name="hue-mapping"></a><span data-ttu-id="45bad-468">Сопоставление оттенков</span><span class="sxs-lookup"><span data-stu-id="45bad-468">Hue mapping</span></span>

<span data-ttu-id="45bad-469">Хуемап является аналогом цели ICC-насыщенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-469">HueMap is the equivalent of the ICC Saturation intent.</span></span>

<span data-ttu-id="45bad-470">Если исходная или конечная границы исходного диапазона не содержат первичных значений, эта модель возвращается к модели Минкд (относительной), описанной в предыдущем разделе. Например, устройства, для которых не могут быть определены первичные элементы (профили ICC с более чем четырьмя каналами) или монохромные ICC-профили.</span><span class="sxs-lookup"><span data-stu-id="45bad-470">If either the source gamut boundary or the destination gamut boundary does not contain primaries, this model reverts to the MinCD (relative) model described in a preceding section; for example, devices for which the primaries cannot be determined (ICC profiles with more than four channels) or monochrome ICC profiles.</span></span>

<span data-ttu-id="45bad-471">Этот алгоритм сначала корректирует цветовой тон значения входного цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-471">This algorithm first adjusts the hue of the input color value.</span></span> <span data-ttu-id="45bad-472">Затем он одновременно корректирует освещение и чрома с помощью сопоставленного сдвига.</span><span class="sxs-lookup"><span data-stu-id="45bad-472">Then it simultaneously adjusts the lightness and chroma, using a shearing mapping.</span></span> <span data-ttu-id="45bad-473">Наконец, он обрезает значение цвета, чтобы убедиться, что он находится в пределах цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-473">Finally, it clips color value to make sure it is within gamut.</span></span>

<span data-ttu-id="45bad-474">Первым шагом является определение «колес оттенков».</span><span class="sxs-lookup"><span data-stu-id="45bad-474">The first step is to determine the "Hue Wheels."</span></span> <span data-ttu-id="45bad-475">Найдите значения ЖЧ для основного и дополнительного цветов для исходного и целевого устройств.</span><span class="sxs-lookup"><span data-stu-id="45bad-475">Find the JCh values for primary and secondary colors for both source and destination device.</span></span> <span data-ttu-id="45bad-476">Вы просматриваете только компоненты оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-476">You are only considering the hue components.</span></span> <span data-ttu-id="45bad-477">В результате получается первичный или вторичный колесо оттенка с шестью цветовыми точками для каждого устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-477">This results in a primary or secondary hue wheel with six color points for each device.</span></span> <span data-ttu-id="45bad-478">(См. рис. 13.)</span><span class="sxs-lookup"><span data-stu-id="45bad-478">(See Figure 13.)</span></span>

![Схема, на которой показаны колеса оттенков с шестью цветными точками.](images/gmmp-figure12.png)

<span data-ttu-id="45bad-480">**Рис. 13** . коцветовые колеса</span><span class="sxs-lookup"><span data-stu-id="45bad-480">**Figure 13** : Hue wheels</span></span>

<span data-ttu-id="45bad-481">Лучшие результаты можно получить, если источник синего источника не повернут на целевой синий первичный.</span><span class="sxs-lookup"><span data-stu-id="45bad-481">Better results can be obtained if the source blue primary is not rotated to the destination blue primary.</span></span> <span data-ttu-id="45bad-482">Вместо этого исходный синий цвет основного оттенка используется в качестве целевого угла синего основного оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-482">Instead, the source blue primary hue angle is used as the destination blue primary hue angle.</span></span>

<span data-ttu-id="45bad-483">Затем выполните поворот оттенка для каждого цвета ввода из исходного изображения,</span><span class="sxs-lookup"><span data-stu-id="45bad-483">Next, perform the hue rotations for each input color from the source image,</span></span>

<span data-ttu-id="45bad-484">а), используя угол оттенок входного цвета, определите расположение цвета на колесо исходного оттенка относительно двух смежных первичных или вторичных цветов.</span><span class="sxs-lookup"><span data-stu-id="45bad-484">a)Using the hue angle of the input color, determine the location of the color on the source hue wheel relative to the two adjacent primary or secondary color.</span></span> <span data-ttu-id="45bad-485">Расположение можно рассматривать как процент от расстояния между первичными элементами.</span><span class="sxs-lookup"><span data-stu-id="45bad-485">The location can be thought of as a percentage of the distance between the primaries.</span></span> <span data-ttu-id="45bad-486">Например, цветовой тон входного цвета составляет 40 процентов от значения оттенка пурпурного к значению оттенка Red.</span><span class="sxs-lookup"><span data-stu-id="45bad-486">For example, the input color hue is 40 percent of the way from the hue value of Magenta to the hue value of Red.</span></span>

<span data-ttu-id="45bad-487">b) на целевом колесе оттенок найдите связанный угол оттенок, например 40 процентов от пурпурного к красному.</span><span class="sxs-lookup"><span data-stu-id="45bad-487">b)On the destination hue wheel, find the associated hue angle, for example, 40 percent from Magenta to Red.</span></span> <span data-ttu-id="45bad-488">Это значение будет иметь угол оттенок назначения.</span><span class="sxs-lookup"><span data-stu-id="45bad-488">This value will be the destination hue angle.</span></span>

<span data-ttu-id="45bad-489">Как правило, исходные первичные и вторичные реплики не будут иметь те же углы оттенков, что и целевые первичные и вторичные реплики. то есть угол оттенок назначения обычно будет отличаться от угла оттенок источника.</span><span class="sxs-lookup"><span data-stu-id="45bad-489">In general, the source primaries and secondaries will not be at the same hue angles as the destination primaries and secondaries; that is, the destination hue angle usually will be different from the source hue angle.</span></span>

<span data-ttu-id="45bad-490">Например, предположим, что колеса оттенков создают следующие значения:</span><span class="sxs-lookup"><span data-stu-id="45bad-490">For example, suppose the hue wheels produce the following values:</span></span>

<span data-ttu-id="45bad-491">Источник M = 295 градусов, источник R = 355 градусов.</span><span class="sxs-lookup"><span data-stu-id="45bad-491">Source M = 295 degrees, Source R = 355 degrees.</span></span>

<span data-ttu-id="45bad-492">Назначение M = 290 градусов, назначение R = 346 градусов.</span><span class="sxs-lookup"><span data-stu-id="45bad-492">Destination M = 290 degrees, Destination R = 346 degrees.</span></span>

<span data-ttu-id="45bad-493">Если угол оттенок входного цвета равен 319 градусам, он составляет 40 процентов от угла (24 градуса) от источника M к исходному R. Угол от M до R — 60 градусов, а угол от M до входного оттенка — 24 градуса.</span><span class="sxs-lookup"><span data-stu-id="45bad-493">If the hue angle of the input color is 319 degrees, it is 40 percent of the angle (24 degrees) from source M to source R. The angle from M to R is 60 degrees, and the angle from M to input hue is 24 degrees.</span></span> <span data-ttu-id="45bad-494">Вычислите угол в назначении, 40% от назначения M до целевого R (22 градуса), чтобы угол оттенок целевого цвета был равен 312 градусам.</span><span class="sxs-lookup"><span data-stu-id="45bad-494">Calculate the angle on the destination that is 40 percent from destination M to destination R (22 degrees), so the hue angle of the destination color is 312 degrees.</span></span>

<span data-ttu-id="45bad-495">Затем вычислите опорные точки оттенок для исходного и целевого оттенков.</span><span class="sxs-lookup"><span data-stu-id="45bad-495">Next, calculate the hue reference points for the source hue and the destination hue.</span></span> <span data-ttu-id="45bad-496">Чтобы вычислить контрольную точку оттенок для конкретного значения h (оттенка), необходимо найти значение J (Light) и C (чрома).</span><span class="sxs-lookup"><span data-stu-id="45bad-496">To calculate the hue reference point for a particular h (hue) value, you want to find the J (lightness) value and C (chroma) value.</span></span>

-   <span data-ttu-id="45bad-497">Найдите значение J контрольной точки оттенок путем интерполяции между значениями J для смежной первичной или вторичной точки, используя относительное расположение оттенка; Например, в этом примере 40%.</span><span class="sxs-lookup"><span data-stu-id="45bad-497">Find the J value of the hue reference point by interpolating between the J values for the adjacent primary or secondary points, using the relative position of the hue; for example, 40 percent in this example.</span></span>
-   <span data-ttu-id="45bad-498">Найти максимальное значение C в этом значении J и h.</span><span class="sxs-lookup"><span data-stu-id="45bad-498">Find the maximum C value at this J value and h value.</span></span> <span data-ttu-id="45bad-499">Теперь у вас есть ЖЧ контрольной точки оттенок для этого оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-499">You now have the JCh of the hue reference point for that hue.</span></span>

![Схема, на которой показан лист оттенков.](images/gmmp-figure13.png)

<span data-ttu-id="45bad-501">**Рис. 14** . лист оттенок (визуализация среза границы цветовой гаммы в заданном оттенке)</span><span class="sxs-lookup"><span data-stu-id="45bad-501">**Figure 14** : A hue leaf (visualization of a gamut boundary slice at a specific hue)</span></span>

<span data-ttu-id="45bad-502">Следующим шагом является вычисление распределения сдвига для каждого пикселя.</span><span class="sxs-lookup"><span data-stu-id="45bad-502">The next step is to compute the shear mapping for each pixel.</span></span> <span data-ttu-id="45bad-503">Во-первых, визуализируйте лист оттенка из исходного диапазона для угла цветового оттенка исходного цвета, а конечный цветовой диапазон — для угла оттенка назначения, вычисленного во время поворота оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-503">First, visualize a hue leaf from the source gamut for the source color hue angle, and a hue leaf from the destination gamut for the destination hue angle computed during hue rotation.</span></span> <span data-ttu-id="45bad-504">Листья оттенков создаются с помощью "среза" из области границы ЖЧ на уровне отдельных оттенков (см. рис. 14).</span><span class="sxs-lookup"><span data-stu-id="45bad-504">The hue leaves are created by taking a "slice" from the JCh gamut boundary surface at a specific hue angle (see Figure 14).</span></span>

<span data-ttu-id="45bad-505">Примечание. в целях оптимизации производительности не создаются листья оттенков. они описаны и показаны здесь только в целях визуализации.</span><span class="sxs-lookup"><span data-stu-id="45bad-505">NOTE: For performance optimization reasons, hue leaves are not actually created; they are described and shown here for visualization purposes only.</span></span> <span data-ttu-id="45bad-506">Операции выполняются непосредственно на поверхности границы палитры в указанном оттенке.</span><span class="sxs-lookup"><span data-stu-id="45bad-506">The operations are performed directly on the gamut boundary surface at the specified hue.</span></span> <span data-ttu-id="45bad-507">Затем вы Вычислите контрольные точки оттенок, чтобы определить сопоставление сдвига.</span><span class="sxs-lookup"><span data-stu-id="45bad-507">You then compute the hue reference points to determine the shear mapping.</span></span>

-   <span data-ttu-id="45bad-508">Выполните перемасштабирование, чтобы связать черные и белые точки исходного листа с конечным конечным листом (см. рис. 15).</span><span class="sxs-lookup"><span data-stu-id="45bad-508">Perform a lightness rescaling to map the black and white points of the source leaf to the destination leaf (see Figure 15).</span></span> <span data-ttu-id="45bad-509">Черные и белые точки на конечном уровне источника оттенок сопоставляются линейно с черно-белыми точками конечного оттенок, путем масштабирования всех координат J исходной границы.</span><span class="sxs-lookup"><span data-stu-id="45bad-509">The black and white points of the source hue leaf are mapped linearly to the black and white points of the destination hue leaf, by scaling all the J coordinates of the source boundary.</span></span> <span data-ttu-id="45bad-510">Значение цвета, сопоставленное с оттенокм, масштабируется таким же образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-510">The hue-mapped input color value is scaled in the same manner.</span></span>

![Схема, показывающая сопоставление освещенности.](images/gmmp-figure14.png)

<span data-ttu-id="45bad-512">**Рис. 15** . Сопоставление освещенности</span><span class="sxs-lookup"><span data-stu-id="45bad-512">**Figure 15** : Lightness mapping</span></span>

-   <span data-ttu-id="45bad-513">Определите опорные точки оттенок для каждого листа оттенков.</span><span class="sxs-lookup"><span data-stu-id="45bad-513">Determine the hue reference points for each hue leaf.</span></span> <span data-ttu-id="45bad-514">Примените сопоставление сдвига к исходному листу, чтобы исходная и Целевая эталонные точки совпадали (см. рис. 16).</span><span class="sxs-lookup"><span data-stu-id="45bad-514">Apply a shear mapping to the source leaf so that the source and destination reference points coincide (see Figure 16).</span></span> <span data-ttu-id="45bad-515">Опорная точка для цветового охвата в определенном оттенке — это контрольная точка интерполяции между смежными первичными элементами.</span><span class="sxs-lookup"><span data-stu-id="45bad-515">The reference point for a gamut at a specific hue is the interpolated hue reference point between the adjacent primaries.</span></span> <span data-ttu-id="45bad-516">Опорная точка исходного оттенка источника сопоставляется линейно с контрольной точкой конечного оттенок, используя операцию сдвига, которая блокирует ось J, сохраняя черные точки и белые точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-516">The reference point of the source hue leaf is mapped linearly to the reference point of the destination hue leaf, using a "shear" operation that locks the J axis, keeping the black points and the white points stationary.</span></span> <span data-ttu-id="45bad-517">Черные точки, белые точки и опорные точки исходного и целевого оттенков должны совпадать.</span><span class="sxs-lookup"><span data-stu-id="45bad-517">The black points, white points, and reference points of the source and destination hue leaves should coincide.</span></span>
-   <span data-ttu-id="45bad-518">Примените сопоставление сдвига к значению цвета ввода "светло-скорректированный".</span><span class="sxs-lookup"><span data-stu-id="45bad-518">Apply the shear mapping to the lightness-adjusted input color value.</span></span> <span data-ttu-id="45bad-519">Координаты J и C исходного значения цвета пропорционально масштабируются относительно расстояния от оси J.</span><span class="sxs-lookup"><span data-stu-id="45bad-519">The J and C coordinates of the source color value are proportionally scaled, relative to its distance from the J axis.</span></span>
-   <span data-ttu-id="45bad-520">Далее, незаметное сжатие светлых чрома, направленное к значению J-value контрольной точки оттенок, выполняется на цветовой точке с сопоставленным сдвигом.</span><span class="sxs-lookup"><span data-stu-id="45bad-520">Next, a subtle chroma-dependent lightness compression toward the J-value of the hue reference point is performed on the shear-mapped color point.</span></span> <span data-ttu-id="45bad-521">Сжатие к ссылке оттенка J выполняется на основе гамма-фактора, где белый, черный, серый и точки на ссылке на оттенок J не затрагиваются.</span><span class="sxs-lookup"><span data-stu-id="45bad-521">The compression toward hue reference J is done in a gamma-like fashion, where white, black, grays, and points on the hue reference J are not affected.</span></span> <span data-ttu-id="45bad-522">Все остальные точки обычно имеют ссылку на оттенок J в гладком режиме, слегка расходуясь на ссылку на оттенок J, с чрома оставшейся константой.</span><span class="sxs-lookup"><span data-stu-id="45bad-522">All other points tend toward the hue reference J in a smooth fashion, slightly bunching up near the hue reference J, with chroma remaining constant.</span></span> <span data-ttu-id="45bad-523">Зависимость чрома гарантирует, что нейтральные цвета не затрагиваются, и результат увеличивается на цвет с более высоким чрома.</span><span class="sxs-lookup"><span data-stu-id="45bad-523">The chroma dependency assures that neutral colors are not affected, and the effect is increased on colors with higher chroma.</span></span>

<span data-ttu-id="45bad-524">Ниже приведено математическое описание сжатия яркости к ссылке на оттенок J или корректировка значения J в точке назначения.</span><span class="sxs-lookup"><span data-stu-id="45bad-524">The following is a mathematical description of the lightness compression toward the hue reference J, or adjusting the J-value of the destination point.</span></span> <span data-ttu-id="45bad-525">Он называется точкой назначения, так как он был преобразован в целевой цветовой охват.</span><span class="sxs-lookup"><span data-stu-id="45bad-525">It is called the destination point because it has been shear mapped into the destination gamut.</span></span>

<span data-ttu-id="45bad-526">Во-первых, вычислите «Факторк» (коэффициент зависимостей чрома) для целевой точки, который определяет, насколько эффективно будет сжиматься степень освещенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-526">First, compute "factorC" (chroma dependency factor) for the destination point, which determines how much effect the lightness compression will have.</span></span> <span data-ttu-id="45bad-527">Точки, расположенные рядом или на оси J, будут иметь немалое сжатие; несколько точек, отброшенных от оси J (High-чрома), будут применены к большему сжатию.</span><span class="sxs-lookup"><span data-stu-id="45bad-527">Points near or on the J-axis will have little or no compression; points farther away from the J-axis (high-chroma) will have more compression applied.</span></span> <span data-ttu-id="45bad-528">Умножьте на 0,5, чтобы убедиться, что Факторк меньше 1, так как Саурцек может быть немного больше Референцек, но не в два раза шире.</span><span class="sxs-lookup"><span data-stu-id="45bad-528">Multiply by 0.5 to ensure that factorC is less than 1, because it is possible that sourceC could be slightly greater than referenceC, but not twice as great.</span></span>

<span data-ttu-id="45bad-529">Факторк = (Дестинатионк/Референцек)?</span><span class="sxs-lookup"><span data-stu-id="45bad-529">factorC = (destinationC / referenceC) ?</span></span> <span data-ttu-id="45bad-530">0,5</span><span class="sxs-lookup"><span data-stu-id="45bad-530">0.5</span></span>

<span data-ttu-id="45bad-531">где:</span><span class="sxs-lookup"><span data-stu-id="45bad-531">where:</span></span>

<span data-ttu-id="45bad-532">Дестинатионк — это значение точки назначения в C.</span><span class="sxs-lookup"><span data-stu-id="45bad-532">destinationC is the C-value of the destination point.</span></span>

<span data-ttu-id="45bad-533">Референцек — это значение точки ссылки оттенок в C.</span><span class="sxs-lookup"><span data-stu-id="45bad-533">referenceC is the C-value of the Hue Reference point.</span></span>

<span data-ttu-id="45bad-534">Затем определите, находится ли точка назначения J выше или ниже ссылки на оттенок J. Если это так, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="45bad-534">Next, determine whether the destination point J is above or below the hue reference J. If it is above, do the following:</span></span>

1.  <span data-ttu-id="45bad-535">Вычисление "Факторж" для целевой точки относительно Референцеж.</span><span class="sxs-lookup"><span data-stu-id="45bad-535">Compute "factorJ" for the destination point relative to the referenceJ.</span></span> <span data-ttu-id="45bad-536">Это значение Факторж будет находиться в диапазоне от 0 до 1 (0, если на Референцеж; 1, если в Максж).</span><span class="sxs-lookup"><span data-stu-id="45bad-536">This factorJ value will be between 0 and 1 (0 if on the referenceJ; 1 if at maxJ).</span></span>
2.  <span data-ttu-id="45bad-537">Факторж = (Дестинатионж-Референцеж)/(Максж-Референцеж)</span><span class="sxs-lookup"><span data-stu-id="45bad-537">factorJ = (destinationJ - referenceJ) / (maxJ - referenceJ)</span></span>

    <span data-ttu-id="45bad-538">где:</span><span class="sxs-lookup"><span data-stu-id="45bad-538">where:</span></span>

    <span data-ttu-id="45bad-539">Дестинатионж — значение J точки назначения.</span><span class="sxs-lookup"><span data-stu-id="45bad-539">destinationJ is the J-value of the destination point.</span></span>

    <span data-ttu-id="45bad-540">Референцеж — это значение J-value контрольной точки оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-540">referenceJ is the J-value of the hue reference point.</span></span>

    <span data-ttu-id="45bad-541">Максж — это максимальное значение параметра J-Value для цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-541">maxJ is the maximum J-value of the gamut.</span></span>

3.  <span data-ttu-id="45bad-542">Примените функцию питания, подобную гамме, к Факторж, которая уменьшит Факторж на определенный объем.</span><span class="sxs-lookup"><span data-stu-id="45bad-542">Apply a gamma-like power function to factorJ, which will reduce factorJ by a certain amount.</span></span> <span data-ttu-id="45bad-543">В этом примере используется степень 2 (квадрат).</span><span class="sxs-lookup"><span data-stu-id="45bad-543">This example uses the power of 2 (the square).</span></span> <span data-ttu-id="45bad-544">Вычтите уменьшенный Факторж из исходного Факторж и умножьте результат на общее значение J-Range над основным Референцеж, чтобы найти "Делтаж", который представляет изменение в J после сжатия яркости, но не включает зависимость чрома.</span><span class="sxs-lookup"><span data-stu-id="45bad-544">Subtract the reduced factorJ from the original factorJ and multiply the result by the total J-range above the primary referenceJ to find the "deltaJ," which represents the change in J after the lightness compression, but not including the chroma dependency.</span></span>
4.  <span data-ttu-id="45bad-545">Делтаж = (Факторж-(Факторж?</span><span class="sxs-lookup"><span data-stu-id="45bad-545">deltaJ = (factorJ - (factorJ ?</span></span> <span data-ttu-id="45bad-546">Факторж))?</span><span class="sxs-lookup"><span data-stu-id="45bad-546">factorJ)) ?</span></span> <span data-ttu-id="45bad-547">(Максж-Референцеж)</span><span class="sxs-lookup"><span data-stu-id="45bad-547">(maxJ - referenceJ)</span></span>

5.  <span data-ttu-id="45bad-548">Примените Факторк к Делтаж (чем выше чрома, чем больше результат) и вычислите новое значение J-Value для целевой точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-548">Apply factorC to the deltaJ (the higher the chroma, the greater the effect), and compute the new J-value for the destination point.</span></span>
6.  <span data-ttu-id="45bad-549">Дестинатионж = Дестинатионж — (Делтаж?</span><span class="sxs-lookup"><span data-stu-id="45bad-549">destinationJ = destinationJ - (deltaJ ?</span></span> <span data-ttu-id="45bad-550">Факторк)</span><span class="sxs-lookup"><span data-stu-id="45bad-550">factorC)</span></span>

<span data-ttu-id="45bad-551">Если значение J-Value для целевой точки ниже Референцеж, то аналогичное вычисление на предыдущих шагах A-C выполняется с помощью Минж вместо Максж, чтобы найти диапазон в J для вычисления Факторж и учитывать полярность операций ниже Референцеж.</span><span class="sxs-lookup"><span data-stu-id="45bad-551">If J-value for the destination point is below referenceJ, then a similar computation to the preceding steps A-C is performed, using minJ instead of maxJ to find the range in J to compute the factorJ, and taking into account the polarity of the operations "underneath" the referenceJ.</span></span>

<span data-ttu-id="45bad-552">Факторж = (Референцеж-Дестинатионж)/(Референцеж-Минж)</span><span class="sxs-lookup"><span data-stu-id="45bad-552">factorJ = (referenceJ - destinationJ) / (referenceJ - minJ)</span></span>

<span data-ttu-id="45bad-553">Делтаж = (Факторж-(Факторж?</span><span class="sxs-lookup"><span data-stu-id="45bad-553">deltaJ = (factorJ - (factorJ ?</span></span> <span data-ttu-id="45bad-554">Факторж))?</span><span class="sxs-lookup"><span data-stu-id="45bad-554">factorJ)) ?</span></span> <span data-ttu-id="45bad-555">(Референцеж-Минж)</span><span class="sxs-lookup"><span data-stu-id="45bad-555">(referenceJ - minJ)</span></span>

<span data-ttu-id="45bad-556">Дестинатионж = Дестинатионж + (Делтаж?</span><span class="sxs-lookup"><span data-stu-id="45bad-556">destinationJ = destinationJ + (deltaJ ?</span></span> <span data-ttu-id="45bad-557">Факторк)</span><span class="sxs-lookup"><span data-stu-id="45bad-557">factorC)</span></span>

<span data-ttu-id="45bad-558">где:</span><span class="sxs-lookup"><span data-stu-id="45bad-558">where:</span></span>

<span data-ttu-id="45bad-559">Минж — это минимальное значение параметра J-Value для цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-559">minJ is the minimum J-value of the gamut.</span></span>

<span data-ttu-id="45bad-560">Чрома для цветовых точек ввода разворачивается линейно (по возможности), а постоянная освещенность пропорциональна максимальному значению чрома в исходном и конечном охвате этого оттенка и яркости.</span><span class="sxs-lookup"><span data-stu-id="45bad-560">The chroma for input color points is expanded linearly (when possible) along constant lightness proportional to the maximum chroma value of the source and destination gamuts at that hue and lightness.</span></span> <span data-ttu-id="45bad-561">В сочетании с предыдущим сжатием, зависящим от чрома, это помогает сохранить насыщенность, так как при сопоставлении наклона с помощью опорных точек в чрома (см. рис. 16) происходит чрезмерное сжатие.</span><span class="sxs-lookup"><span data-stu-id="45bad-561">Combined with the preceding chroma-dependent lightness compression, this helps preserve the saturation because shear mapping using the reference points sometimes causes the source point to over-compress in chroma (see Figure 16).</span></span>

![Схема, показывающая сопоставление сдвига с опорными точками оттенок, до сдвига влево после сдвига вправо.](images/gmmp-shearmapping.png)

<span data-ttu-id="45bad-563">**Рис. 16** . Сопоставление наклона, сжатие яркости к ссылке на оттенок J и расширение чрома</span><span class="sxs-lookup"><span data-stu-id="45bad-563">**Figure 16** : Shear mapping, lightness compression toward hue reference J, and chroma expansion</span></span>

<span data-ttu-id="45bad-564">Ниже приведено математическое описание процесса расширения чрома или корректировка C-value конечной точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-564">The following is a mathematical description of the chroma expansion process, or adjusting the C-value of the destination point.</span></span> <span data-ttu-id="45bad-565">Она называется точкой назначения, так как она была сопоставлена и в целевом охвате сжато значение яркости.</span><span class="sxs-lookup"><span data-stu-id="45bad-565">It is called the destination point because it has been shear mapped and lightness compressed into the destination gamut.</span></span>

1.  <span data-ttu-id="45bad-566">Прежде чем приступить к сопоставлению, определите Саурцеекстентк (экстент чрома в светлых и темных цветах исходной точки).</span><span class="sxs-lookup"><span data-stu-id="45bad-566">Before the shear mapping, determine sourceExtentC (the chroma extent at the lightness and hue of the source point).</span></span>
2.  <span data-ttu-id="45bad-567">После того как распределение сдвига и сжатие яркости, преобразуя исходную точку в конечную точку, определяют Дестекстентк (экстент чрома на свете и цветовой тон конечной точки).</span><span class="sxs-lookup"><span data-stu-id="45bad-567">After the shear mapping and lightness compression which transforms the source point into the destination point, determine the destExtentC (the chroma extent at the lightness and hue of the destination point).</span></span>
3.  <span data-ttu-id="45bad-568">Если Саурцеекстентк больше, чем Дестекстентк, Настройка чрома для целевой точки не требуется, и вы можете пропустить следующий шаг.</span><span class="sxs-lookup"><span data-stu-id="45bad-568">If the sourceExtentC is greater than the destExtentC, no chroma adjustment to the destination point is necessary, and you can skip the next step.</span></span>
4.  <span data-ttu-id="45bad-569">Настройте Дестинатионк (чрома конечной точки) для размещения в целевом экстенте чрома на этом освещении и оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-569">Adjust destinationC (the chroma of the destination point) to fit within the destination chroma extent at this lightness and hue.</span></span>
5.  <span data-ttu-id="45bad-570">Дестинатионк = Дестинатионк?</span><span class="sxs-lookup"><span data-stu-id="45bad-570">destinationC = destinationC ?</span></span> <span data-ttu-id="45bad-571">(Дестекстентк/Саурцеекстентк)</span><span class="sxs-lookup"><span data-stu-id="45bad-571">(destExtentC / sourceExtentC)</span></span>

    <span data-ttu-id="45bad-572">где:</span><span class="sxs-lookup"><span data-stu-id="45bad-572">where:</span></span>

    <span data-ttu-id="45bad-573">Дестинатионк — это точка назначения C-value.</span><span class="sxs-lookup"><span data-stu-id="45bad-573">destinationC is the destination point C-value.</span></span>

    <span data-ttu-id="45bad-574">Саурцеекстентк — это максимальное значение в C-значении исходного диапазона в светлых и темных цветах исходной точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-574">sourceExtentC is the maximum C-value of the source gamut at the lightness and hue of the source point.</span></span>

    <span data-ttu-id="45bad-575">Дестекстентк — это максимальное значение C-Value для целевого диапазона в светлых и темных цветах целевой точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-575">destExtentC is the maximum C-value of the destination gamut at the lightness and hue of the destination point.</span></span>

<span data-ttu-id="45bad-576">Наконец, выполните минимальный шаг с вырезой.</span><span class="sxs-lookup"><span data-stu-id="45bad-576">Finally, perform the mimimum distance clipping.</span></span> <span data-ttu-id="45bad-577">Если цветовой тон, повернутый, затемненный и находящийся на сдвиге, все еще немного выходит за пределы целевого диапазона, обрежьте его (переместите) в ближайшую точку на границе целевой палитры (см. рис. 17).</span><span class="sxs-lookup"><span data-stu-id="45bad-577">If the hue-rotated, lightness-adjusted, and shear-mapped input color is still slightly outside the destination gamut, clip it (move it) to the closest point on the destination gamut boundary (see Figure 17).</span></span>

![Схема, показывающая минимальную отрезку расстояния.](images/gmmp-figure15.png)

<span data-ttu-id="45bad-579">**Рис. 17** . Обрезка минимального расстояния</span><span class="sxs-lookup"><span data-stu-id="45bad-579">**Figure 17** : Minimum distance clipping</span></span>

## <a name="gamut-boundary-description-and-gamut-shell-algorithms"></a><span data-ttu-id="45bad-580">Описание границы палитры и алгоритмы оболочки</span><span class="sxs-lookup"><span data-stu-id="45bad-580">Gamut Boundary Description and Gamut Shell Algorithms</span></span>

<span data-ttu-id="45bad-581">Функция границы цветовой области устройства использует механизм модели устройства и аналитические параметры для получения границы цветовой палитры устройства, описанной в виде индексированного списка вершин поверхности в области охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-581">The device gamut boundary function uses the device model engine and analytical parameters to derive a color device gamut boundary, described as an indexed vertex list of the hull of the device gamut.</span></span> <span data-ttu-id="45bad-582">Поверхности вычисляется по-разному в зависимости от того, работаете ли вы с аддитивными устройствами, такими как мониторы, проекторы или вычитание устройств.</span><span class="sxs-lookup"><span data-stu-id="45bad-582">The hull is computed differently depending on whether you are working with additive devices, such as monitors and projectors, or subtractive devices.</span></span> <span data-ttu-id="45bad-583">Индексированный список вершин хранится в Циежаб.</span><span class="sxs-lookup"><span data-stu-id="45bad-583">The indexed vertex list is stored in CIEJab.</span></span> <span data-ttu-id="45bad-584">Структура индексированного списка вершин оптимизирована для аппаратного ускорения DirectX.</span><span class="sxs-lookup"><span data-stu-id="45bad-584">The structure of the indexed vertex list is optimized for hardware acceleration by DirectX.</span></span>

<span data-ttu-id="45bad-585">Этот подход имеет множество хорошо известных решений.</span><span class="sxs-lookup"><span data-stu-id="45bad-585">This approach has many well-known solutions.</span></span> <span data-ttu-id="45bad-586">При поиске "выпуклой поверхности DirectX" в Интернете вы получаете более 100 попаданий.</span><span class="sxs-lookup"><span data-stu-id="45bad-586">If you search for "convex hull DirectX" on the Web, you get more than 100 hits.</span></span> <span data-ttu-id="45bad-587">Например, имеется ссылка из 1983 по этой теме (компьютерные теории и приложения, Шифуллс, b-сплайновые поверхности и кадкам, PP. 34-49) со ссылками датировано от 1970 до 1982 в разделе.</span><span class="sxs-lookup"><span data-stu-id="45bad-587">For example, there is a reference from 1983 on this specific topic (Computer Graphics Theory and Application, "Shiphulls, b-spline surfaces, and cadcam," pp. 34-49) with references dating from 1970 to 1982 on the topic.</span></span>

<span data-ttu-id="45bad-588">Коллекцию точек можно определить из внешней доступной информации следующим образом:</span><span class="sxs-lookup"><span data-stu-id="45bad-588">The collection of points can be determined from externally available information, as follows:</span></span>

-   <span data-ttu-id="45bad-589">Точки для Справочника по мониторам создаются с помощью выборки цветового Куба в колоранте устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-589">Points for the reference shell for monitors are generated using a sampling of the color cube in device colorant space.</span></span>
-   <span data-ttu-id="45bad-590">Точки для Справочника по принтерам и устройствам записи получаются из образца данных, используемого для инициализации модели.</span><span class="sxs-lookup"><span data-stu-id="45bad-590">Points for the reference shell for printers and capture devices are obtained from the sample data used to initialize the model.</span></span>
-   <span data-ttu-id="45bad-591">Точки для ссылки на оболочку для scRGB и sRGB создаются с помощью выборки цветового Куба для sRGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-591">Points for the reference shell for scRGB and sRGB are generated using a sampling of the color cube for sRGB.</span></span>
-   <span data-ttu-id="45bad-592">Точки для оболочки правдоподобные для устройств записи создаются с помощью выборки цветового Куба в пространстве колорант устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-592">Points for the plausible shell for capture devices are generated using a sampling of the color cube in device colorant space.</span></span>
-   <span data-ttu-id="45bad-593">Точки для Справочника по проекторам создаются с помощью выборки многогранника в Кубе цветов в пространстве колорант устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-593">Points for the reference shell for projectors are generated using a sampling of a polyhedron in the color cube in device colorant space.</span></span>
-   <span data-ttu-id="45bad-594">Точки для возможной оболочки для расширенных цветовых пространств диапазонов создаются с помощью выборки цветового Куба в самом пространстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-594">Points for the possible shell for wide dynamic range color spaces are generated using a sampling of the color cube in the space itself.</span></span>

<span data-ttu-id="45bad-595">Вы можете создать список вершин, который эффективно описывает цветовой охват устройства, учитывая профиль устройства и службы поддержки системы.</span><span class="sxs-lookup"><span data-stu-id="45bad-595">You can create a vertex list that efficiently describes the color device gamut, given a device profile and system support services.</span></span>

<span data-ttu-id="45bad-596">Для выходных устройств граница цветового охвата описывает диапазон цветов, которые могут отображаться устройством.</span><span class="sxs-lookup"><span data-stu-id="45bad-596">For output devices, the gamut boundary describes the range of colors that can be displayed by the device.</span></span> <span data-ttu-id="45bad-597">Граница цветового охвата создается на основе тех же данных, которые используются для моделирования поведения устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-597">A gamut boundary is generated from the same data used to model the behavior of the device.</span></span> <span data-ttu-id="45bad-598">По сути, вы выводите выборку диапазона цветов, которые может создать устройство, измеряют цвета, преобразуют измерения в область внешнего вида, а затем используете результаты для создания границы цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-598">Conceptually, you output a sampling of the range of colors the device can produce, measure the colors, convert the measurements into appearance space, and then use the results to create the gamut boundary.</span></span>

<span data-ttu-id="45bad-599">Устройства ввода сложнее.</span><span class="sxs-lookup"><span data-stu-id="45bad-599">Input devices are trickier.</span></span> <span data-ttu-id="45bad-600">Каждый пиксель входного изображения должен иметь какое бы то ни было значение.</span><span class="sxs-lookup"><span data-stu-id="45bad-600">Each pixel in an input image must have some value.</span></span> <span data-ttu-id="45bad-601">Каждый пиксель должен иметь возможность представить любой цвет в реальном мире каким бы то ни было образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-601">Each pixel must be able to represent any color found in the real world in some way.</span></span> <span data-ttu-id="45bad-602">В этом смысле цвета для входного устройства не имеют цветов "вне диапазона", так как они всегда могут быть представлены.</span><span class="sxs-lookup"><span data-stu-id="45bad-602">In this sense, no colors are "out of gamut" for an input device, because they can always be represented.</span></span>

<span data-ttu-id="45bad-603">Все форматы цифровых изображений имеют фиксированный динамический диапазон.</span><span class="sxs-lookup"><span data-stu-id="45bad-603">All digital image formats have some fixed dynamic range.</span></span> <span data-ttu-id="45bad-604">Из-за этого ограничения всегда существует несколько уникальных VisualStateManager, которые сопоставляются с одним и тем же цифровым значением.</span><span class="sxs-lookup"><span data-stu-id="45bad-604">Because of this limitation, there is always some distinct stimuli that map to the same digital value.</span></span> <span data-ttu-id="45bad-605">Таким образом, нельзя установить однозначное сопоставление между реальными цветами и значениями цифровой камеры.</span><span class="sxs-lookup"><span data-stu-id="45bad-605">So, you cannot establish a one-to-one mapping between real-world colors and digital camera values.</span></span> <span data-ttu-id="45bad-606">Вместо этого граница палитры формируется путем оценки диапазона реальных цветов, которые могут создавать цифровые ответы камеры.</span><span class="sxs-lookup"><span data-stu-id="45bad-606">Instead, the gamut boundary is formed by estimating a range of real-world colors that can produce the digital responses of the camera.</span></span> <span data-ttu-id="45bad-607">Этот предполагаемый диапазон используется в качестве цветового охвата для устройства ввода.</span><span class="sxs-lookup"><span data-stu-id="45bad-607">You use that estimated range as the gamut for the input device.</span></span>

<span data-ttu-id="45bad-608">Включены первичные элементы для обеспечения соответствия цветовой палитры с намерениями для бизнес-графики.</span><span class="sxs-lookup"><span data-stu-id="45bad-608">Primaries are included to provide for business graphics intent-type gamut mapping.</span></span>

<span data-ttu-id="45bad-609">В true объектно-ориентированный стиль является абстрактным базовым представлением границы палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-609">In true object-oriented style, you abstract the underlying representation of the gamut boundary.</span></span> <span data-ttu-id="45bad-610">Это дает возможность изменять представление в будущем.</span><span class="sxs-lookup"><span data-stu-id="45bad-610">This allows you the flexibility to change the representation in the future.</span></span> <span data-ttu-id="45bad-611">Чтобы понять дескриптор границы цветовой палитры (ГБД), используемый в новом CTE-выражении, необходимо сначала понять, как работают алгоритмы сопоставления палитры (Гмас).</span><span class="sxs-lookup"><span data-stu-id="45bad-611">To understand the gamut boundary descriptor (GBD) used in the new CTE, you must first understand how gamut mapping algorithms (GMAs) work.</span></span> <span data-ttu-id="45bad-612">Как правило, Гмас разрабатывались в соответствии с потребностями сообщества графических изображений; то есть, для воспроизведения образов, которые уже были правильно подготовлены для устройства, на котором был создан входной образ.</span><span class="sxs-lookup"><span data-stu-id="45bad-612">Traditionally, GMAs have been designed to meet the needs of the graphic art community; that is, to reproduce images that have already been properly rendered for the device on which the input image was created.</span></span> <span data-ttu-id="45bad-613">Цель графического искусство Гмас — обеспечить лучшее воспроизведение входного изображения на выходном устройстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-613">The goal of graphic arts GMAs is to make the best possible reproduction of the input image on the output device.</span></span> <span data-ttu-id="45bad-614">Новое ОТВ ГБД предназначено для решения четырех основных проблем.</span><span class="sxs-lookup"><span data-stu-id="45bad-614">The new CTE GBD is designed to solve four key problems.</span></span>

<span data-ttu-id="45bad-615">Поскольку входное изображение отображается для устройства ввода, все цвета помещаются в пределах диапазона между белой точкой и черной точкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-615">Because the input image is rendered for the input device, all colors fit within the range between the medium's white point and black point.</span></span> <span data-ttu-id="45bad-616">Предположим, что изображение представляет собой фотографию сцены, в которой есть рассеянный белый цвет, такой как человек в белой teeной футболе, и отраженный свет, такой как светлое отражение окна или хрома Chrome.</span><span class="sxs-lookup"><span data-stu-id="45bad-616">Suppose that the image is a photograph of a scene in which there is a diffuse white, such as a person in a white tee shirt, and a specular highlight, such as light reflecting off a window or chrome bumper.</span></span> <span data-ttu-id="45bad-617">Сцена будет подготовлена к просмотру на носителе входных данных, чтобы зеркальное отображение сопоставлялось с белой точкой среднего, а рассеянный белый сопоставляется с некоторыми нейтральными цветами, чем в белой точке средней точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-617">The scene will be rendered to the input medium so that the specular highlight is mapped to the medium's white point, and the diffuse white is mapped to some neutral color darker than the medium's white point.</span></span> <span data-ttu-id="45bad-618">Выбор способа преобразования цветов из сцены во входной носитель — это как зависимое от сцены решение, так и Aesthetic решение.</span><span class="sxs-lookup"><span data-stu-id="45bad-618">The choice of how to map colors from the scene to the input medium is both a scene-dependent decision and an aesthetic decision.</span></span> <span data-ttu-id="45bad-619">Если в исходной сцене отсутствовала отраженная подсветка, то, вероятно, рассеянный белый объект был бы сопоставлен с белой точкой средней точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-619">If the specular highlight was missing from the original scene, then the diffuse white would probably be mapped to the medium's white point.</span></span> <span data-ttu-id="45bad-620">В сцене с большим количеством выделенных элементов будет оставлено больше диапазонов между отражающим белым и рассеянным белым цветом.</span><span class="sxs-lookup"><span data-stu-id="45bad-620">In a scene with a lot of highlight detail, more range would be left between the specular white and the diffuse white.</span></span> <span data-ttu-id="45bad-621">В сцене, в которой выделение не имеет значения, может остаться совсем немного диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-621">In a scene where the highlight is not significant, very little range might be left.</span></span>

<span data-ttu-id="45bad-622">Для предварительно визуализированных изображений сопоставление цветового охвата относительно просто.</span><span class="sxs-lookup"><span data-stu-id="45bad-622">For pre-rendered images, gamut mapping is relatively straightforward.</span></span> <span data-ttu-id="45bad-623">По сути, исходная белая точка среднего цвета сопоставлена с белой точкой воспроизведения, черная точка источника сопоставляется с черной точкой назначения, и большая часть сопоставления завершена.</span><span class="sxs-lookup"><span data-stu-id="45bad-623">Basically, the original medium's white point is mapped to the reproduction medium's white point, the source black point is mapped to the destination black point, and most of the mapping is complete.</span></span> <span data-ttu-id="45bad-624">Различные Гмас в наличии предоставляют варианты для сопоставления других точек на тональной шкале исходного носителя и различные способы обработки значений чрома, выходящих за пределы охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-624">The different GMAs in existence provide variations for mapping other points on the source medium's tone scale and different ways to handle out-of-gamut chroma values.</span></span> <span data-ttu-id="45bad-625">Но сопоставление белого и белого и черного к черному параметрам согласовано во всех этих вариантах.</span><span class="sxs-lookup"><span data-stu-id="45bad-625">But the mapping of white to white and black to black is consistent throughout these variations.</span></span> <span data-ttu-id="45bad-626">Для этой реализации требуется, чтобы белый цвет был выше a J \* 50 и черного цвета ниже a j \* из 50.</span><span class="sxs-lookup"><span data-stu-id="45bad-626">This implementation requires that white be above a J\* of 50 and black below a J\* of 50.</span></span>

<span data-ttu-id="45bad-627">Не все кодировки цвета ограничивают диапазоны цветов для входных изображений.</span><span class="sxs-lookup"><span data-stu-id="45bad-627">Not all color encodings limit color ranges for input images.</span></span> <span data-ttu-id="45bad-628">Стандартная цветовая кодировка IEC (IEC 61966-2-2) предоставляет 16 бит для каждого из трех цветовых каналов: красный, зеленый и синий (RGB).</span><span class="sxs-lookup"><span data-stu-id="45bad-628">The IEC standard color encoding scRGB (IEC 61966-2-2) provides 16 bits for each of the three color channels red, green, and blue (RGB).</span></span> <span data-ttu-id="45bad-629">В этой кодировке ссылка Black не кодируется как тройной RGB (0, 0, 0), но как (4096, 4096, 4096).</span><span class="sxs-lookup"><span data-stu-id="45bad-629">In that encoding, reference black is not encoded as the RGB triple (0, 0, 0), but as (4096, 4096, 4096).</span></span> <span data-ttu-id="45bad-630">Ссылка белого кодируется как (12288, 12288, 12288).</span><span class="sxs-lookup"><span data-stu-id="45bad-630">Reference white is encoded as (12288, 12288, 12288).</span></span> <span data-ttu-id="45bad-631">Кодирование scRGB можно использовать для представления отраженных светов и деталей тени.</span><span class="sxs-lookup"><span data-stu-id="45bad-631">The scRGB encoding can be used to represent specular highlights and shadow detail.</span></span> <span data-ttu-id="45bad-632">Он включает в себя RGB-триадные цвета, которые не являются физически возможными, так как для них требуются отрицательные объемы освещения и кодировки, находящиеся за пределами ЦИЕ Спектрал очага.</span><span class="sxs-lookup"><span data-stu-id="45bad-632">It includes RGB triples that are not physically possible because they require negative amounts of light, and encodings that are outside the CIE spectral locus.</span></span> <span data-ttu-id="45bad-633">Очевидно, что ни одно устройство не может создать все цвета в охвате scRGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-633">Clearly, no device can possibly produce all the colors in the scRGB gamut.</span></span> <span data-ttu-id="45bad-634">На самом деле, ни одно из устройств не может создать все цвета, которые может видеть человек.</span><span class="sxs-lookup"><span data-stu-id="45bad-634">In fact, no device can produce all the colors that a human being can see.</span></span> <span data-ttu-id="45bad-635">Таким образом, устройства не могут заполнить охват scRGB, и было бы полезно иметь возможность представить часть цветового охвата, заполняемого ими.</span><span class="sxs-lookup"><span data-stu-id="45bad-635">So, devices cannot fill the scRGB gamut, and it would be useful to be able to represent the part of the gamut that they do fill.</span></span> <span data-ttu-id="45bad-636">Каждое устройство имеет диапазон значений в пространстве scRGB, которые он может создать.</span><span class="sxs-lookup"><span data-stu-id="45bad-636">Each device has a range of values in scRGB space that it can produce.</span></span> <span data-ttu-id="45bad-637">Это "ожидаемое" цветовое значение для устройства; устройство будет выдавать цвета за пределами этого диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-637">These are the "expected" colors for the device; it would be surprising for the device to produce colors outside this gamut.</span></span> <span data-ttu-id="45bad-638">Существует определенное преобразование из пространства scRGB для отображения пространства, поэтому каждое устройство также имеет диапазон значений внешнего вида, которые предполагается воспроизвести.</span><span class="sxs-lookup"><span data-stu-id="45bad-638">There is a defined transformation from scRGB space to appearance space, so each device also has a range of appearance values that it is expected to reproduce.</span></span>

<span data-ttu-id="45bad-639">Как в scRGB, так и во входных данных из устройств захвата с фиксированным целевым объектом можно получить значение за пределами диапазона ожидаемых значений.</span><span class="sxs-lookup"><span data-stu-id="45bad-639">In both scRGB and input from capture devices characterized with a fixed target, it is possible to get a value outside the range of expected values.</span></span> <span data-ttu-id="45bad-640">При калибровке камеры до целевого объекта тестирования; а затем захватывает сцену с отраженными световыми фрагментами, могут быть более яркие Пиксели, чем белая точка целевого объекта.</span><span class="sxs-lookup"><span data-stu-id="45bad-640">If someone calibrates a camera to a test target; and then captures a scene with specular highlights, there might be pixels that are brighter than the target's white point.</span></span> <span data-ttu-id="45bad-641">То же самое может произойти, если естественное значение красного цвета является более цветным, чем у целевого красного цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-641">The same thing can happen if a naturally occurring red is more chromatic than the target red.</span></span> <span data-ttu-id="45bad-642">Если кто-то принимает изображение scRGB с устройства, а затем вручную изменяет цвета в изображении, можно создать Пиксели, которые выходят за пределы ожидаемого диапазона в пределах области охвата устройства, даже если они находятся внутри полного охвата scRGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-642">If someone takes an scRGB image from a device, and then manually edits the colors in the image, it is possible to create pixels that fall outside the expected range of the device gamut, even though they are within the full scRGB gamut.</span></span>

<span data-ttu-id="45bad-643">Вторая проблема, по-видимому, может быть связана с этим.</span><span class="sxs-lookup"><span data-stu-id="45bad-643">A second problem may not, at first, seem to be related to this.</span></span> <span data-ttu-id="45bad-644">Это возникает при использовании целевого объекта цвета для определения устройства ввода, например камеры или сканера.</span><span class="sxs-lookup"><span data-stu-id="45bad-644">It arises when you use a color target to characterize an input device, such as a camera or scanner.</span></span> <span data-ttu-id="45bad-645">Отражающие цели обычно создаются на бумаге и содержат ряд цветных исправлений.</span><span class="sxs-lookup"><span data-stu-id="45bad-645">Reflective targets are typically produced on paper and contain a number of colored patches.</span></span> <span data-ttu-id="45bad-646">Мануфатурерс предоставляют файлы данных с цветовыми измерениями, созданными при фиксированном условии просмотра для каждого исправления цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-646">Manufaturers provide data files with color measurements taken under a fixed viewing condition for each color patch.</span></span> <span data-ttu-id="45bad-647">Средства профилирования цветов создают сопоставление между этими измеряемыми значениями и значениями, возвращаемыми датчиками цветов на устройствах.</span><span class="sxs-lookup"><span data-stu-id="45bad-647">Color profiling tools create a mapping between these measured values and the values returned by the color sensors in the devices.</span></span> <span data-ttu-id="45bad-648">Проблема в том, что часто эти целевые объекты цветов не охватывают весь спектр значений устройств.</span><span class="sxs-lookup"><span data-stu-id="45bad-648">The problem is that often these color targets do not cover the full range of device values.</span></span> <span data-ttu-id="45bad-649">Например, сканер или камера могут возвращать значение (253, 253, 253) для ссылки на белую точку, а для ссылки Red-Patch — значение RGB (254, 12, 4).</span><span class="sxs-lookup"><span data-stu-id="45bad-649">For example, the scanner or camera might return a value of (253, 253, 253) for the reference white point, and a reference red patch might have an RGB value of (254, 12, 4).</span></span> <span data-ttu-id="45bad-650">Они представляют собой диапазон ожидаемых значений для устройства ввода на основе целевых значений.</span><span class="sxs-lookup"><span data-stu-id="45bad-650">These represent the range of expected values for the input device, based on the target values.</span></span> <span data-ttu-id="45bad-651">Если вы характеризуют устройство ввода на основе ответов на целевой объект, то ожидаются только цвета в пределах этого ограниченного диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-651">If you characterize the input device based on the responses to the target, then you only expect colors within this narrow range.</span></span> <span data-ttu-id="45bad-652">Этот диапазон не только меньше, чем диапазон цветов, которые видят люди, но меньше, чем диапазон цветов, которые может создать устройство.</span><span class="sxs-lookup"><span data-stu-id="45bad-652">This range is not only smaller than the range of colors humans can see, it is smaller than the range of colors the device can produce.</span></span>

<span data-ttu-id="45bad-653">В обоих случаях сложно оценить охват входного устройства или изображения, несмотря на существование эталонной палитры или измерений.</span><span class="sxs-lookup"><span data-stu-id="45bad-653">In both cases, it is difficult to estimate the gamut of the input device or image, despite the existence of a reference gamut or measurements.</span></span> <span data-ttu-id="45bad-654">В первой проблеме цветовой охват правдоподобные для входного устройства меньше, чем полный охват scRGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-654">In the first problem, the plausible gamut of the input device is less than the full gamut of scRGB.</span></span> <span data-ttu-id="45bad-655">Во второй сложности эталонный охват целевого объекта меньше, чем полный возможный охват входного устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-655">In the second problem, the reference gamut of the target is less than the full possible gamut of the input device.</span></span>

<span data-ttu-id="45bad-656">Третья проблема заключается в сопоставлении тонов.</span><span class="sxs-lookup"><span data-stu-id="45bad-656">The third problem involves tone mapping.</span></span> <span data-ttu-id="45bad-657">Многие модели границ цветовых диапазонов, которые могут адекватно представлять предварительно подготовленные изображения, используемые в графическом изображении, были предложены, например, Браун и Фаирчилд Mountain Range ГБД (Браун \[ 97 \] ) и сегмент моровик сегмента прыжка (моровик \[ 98 \] ).</span><span class="sxs-lookup"><span data-stu-id="45bad-657">Many models of gamut boundaries that can adequately represent pre-rendered images used in the graphic arts have been proposed, for example, the Braun and Fairchild Mountain range GBD (Braun\[97\]), and Morovic's Segment Maxima boundary descriptor (Morovic\[98\]).</span></span> <span data-ttu-id="45bad-658">Но эти модели предоставляют только сведения о экстремальных цветах для каждого устройства. в них отсутствуют сведения о других точках в сопоставлении тональности.</span><span class="sxs-lookup"><span data-stu-id="45bad-658">But these models only provide information about the extremes of the device's gamut; they are missing information about other points in the tonal mapping.</span></span> <span data-ttu-id="45bad-659">Без такой информации Гмас может делать только приблизительные оценки оптимального сопоставления тонов.</span><span class="sxs-lookup"><span data-stu-id="45bad-659">Without such information, GMAs can only make rough estimates of optimal tone mapping.</span></span> <span data-ttu-id="45bad-660">Что еще хуже, эти модели не предоставляют справку для расширенного динамического диапазона в scRGB и в изображениях цифровой камеры.</span><span class="sxs-lookup"><span data-stu-id="45bad-660">Worse, these models provide no help for the extended dynamic range in scRGB and in digital camera images.</span></span>

<span data-ttu-id="45bad-661">Как эта проблема решена в фотографике и видеографик отраслях?</span><span class="sxs-lookup"><span data-stu-id="45bad-661">How is this problem resolved in the photographic and videographic industries?</span></span> <span data-ttu-id="45bad-662">Камера захватывает изображение.</span><span class="sxs-lookup"><span data-stu-id="45bad-662">The camera captures an image.</span></span> <span data-ttu-id="45bad-663">Эксперты могут спорить, какой объем отрисовки выполняется на устройстве записи; но они договариваются о том, что это не значительный объем.</span><span class="sxs-lookup"><span data-stu-id="45bad-663">Experts might debate how much rendering occurs in the capture device; but they agree that it is not a significant amount.</span></span> <span data-ttu-id="45bad-664">Обе технологии не сопоставляют белый в захваченном монтажном кадре с белой точкой средней точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-664">Both technologies do not map a diffuse white in a captured scene to the medium's white point.</span></span> <span data-ttu-id="45bad-665">Аналогичным образом они не сопоставляют черную точку из сцены с черной точкой среднего цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-665">Similarly, they do not map the black point from the scene to the medium's black point.</span></span> <span data-ttu-id="45bad-666">Поведение фотопленки описывается в области плотности с помощью кривой характеристик, которая часто называется «вред» и «Дриффиелд» или «H&D».</span><span class="sxs-lookup"><span data-stu-id="45bad-666">The behavior of photographic film is described in density space using a characteristic curve, often called a Hurter and Driffield, or H&D curve.</span></span> <span data-ttu-id="45bad-667">Кривая показывает плотность исходной сцены и полученную плотность на пленке.</span><span class="sxs-lookup"><span data-stu-id="45bad-667">The curve shows the density of the original scene and the resulting density on the film.</span></span> <span data-ttu-id="45bad-668">На рис. 18 показана типичная кривая H&D.</span><span class="sxs-lookup"><span data-stu-id="45bad-668">Figure 18 shows a typical H&D curve.</span></span> <span data-ttu-id="45bad-669">Ось x представляет увеличение уровня уязвимости журнала.</span><span class="sxs-lookup"><span data-stu-id="45bad-669">The x-axis represents increasing log exposure.</span></span> <span data-ttu-id="45bad-670">Ось y представляет плотность слайда.</span><span class="sxs-lookup"><span data-stu-id="45bad-670">The y-axis represents the density on the slide.</span></span> <span data-ttu-id="45bad-671">Пять опорных точек отмечены на кривой: черный без подробностей, что представляет минимальную плотность отрицательного числа; черный с подробностями; Ссылка на среднюю серую карту; белый с подробностями; и белый без подробностей.</span><span class="sxs-lookup"><span data-stu-id="45bad-671">Five reference points are marked on the curve: black without detail, which represents the minimum density on the negative; black with detail; reference mid-gray card; white with detail; and white without detail.</span></span> <span data-ttu-id="45bad-672">Обратите внимание, что между черным пространством нет сведений (что представляет черный цвет) и черного с подробностями (затемнение черного цвета).</span><span class="sxs-lookup"><span data-stu-id="45bad-672">Note that there is space between black without detail (which represents device black) and black with detail (shadow black).</span></span> <span data-ttu-id="45bad-673">Аналогичным образом между белыми и подробными сведениями (а также белыми) имеется пробел.</span><span class="sxs-lookup"><span data-stu-id="45bad-673">Similarly, there is space between white with detail (diffuse white) and white without detail (which represents device white).</span></span>

![Схема, показывающая кривую H и D для слайдовой пленки.](images/gmmp-image079.png)

<span data-ttu-id="45bad-675">**Рисунок 18** . H&ная кривая для слайдовой пленки</span><span class="sxs-lookup"><span data-stu-id="45bad-675">**Figure 18** : H&D curve for slide film</span></span>

<span data-ttu-id="45bad-676">Видеоотрасль предоставляет "запас" и "футрум" в образах.</span><span class="sxs-lookup"><span data-stu-id="45bad-676">The video industry provides "headroom" and "footroom" in images.</span></span> <span data-ttu-id="45bad-677">В спецификации ITU 709 светимость (с именем Y) кодируется в 8 бит с диапазоном от 0 до 255.</span><span class="sxs-lookup"><span data-stu-id="45bad-677">In the ITU 709 specification, luminance (called Y) is encoded in 8 bits, with a range of 0 to 255.</span></span> <span data-ttu-id="45bad-678">Однако ссылка Black кодируется на 15, а ссылка белого кодируется как 235.</span><span class="sxs-lookup"><span data-stu-id="45bad-678">However, reference black is encoded at 15 and reference white is encoded as 235.</span></span> <span data-ttu-id="45bad-679">Это оставляет диапазон кодирования между 236 и 255 для представления отраженных светов.</span><span class="sxs-lookup"><span data-stu-id="45bad-679">This leaves the encoding range between 236 and 255 to represent specular highlights.</span></span>

<span data-ttu-id="45bad-680">Видеоотрасль представляет собой по сути замкнутую систему циклов.</span><span class="sxs-lookup"><span data-stu-id="45bad-680">The video industry presents an essentially closed loop system.</span></span> <span data-ttu-id="45bad-681">Хотя существует множество различных поставщиков оборудования, видеосистемы основаны на ссылочных устройствах.</span><span class="sxs-lookup"><span data-stu-id="45bad-681">While there are many different equipment vendors, video systems are based upon reference devices.</span></span> <span data-ttu-id="45bad-682">Для видеороликов предусмотрена стандартная кодировка.</span><span class="sxs-lookup"><span data-stu-id="45bad-682">There is a standard encoding for video images.</span></span> <span data-ttu-id="45bad-683">Нет необходимости связывать границы цветового охвата с изображениями видео, так как все изображения кодируются для воспроизведения на одном и том же устройстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-683">There is no need to communicate a gamut boundary with video images, because all images are encoded for reproduction on the same reference device.</span></span> <span data-ttu-id="45bad-684">Пленка также является замкнутым циклом, так как нет необходимости передавать промежуточные данные между различными компонентами.</span><span class="sxs-lookup"><span data-stu-id="45bad-684">Film is also closed loop because there is no need to convey intermediate data between different components.</span></span> <span data-ttu-id="45bad-685">Требуется решение, которое позволяет изображениям с устройств с разными охватами и представить как предварительно визуализированные, так и необработанные сцены, которые будут воспроизведены на выходе с различными охватами.</span><span class="sxs-lookup"><span data-stu-id="45bad-685">You want a solution that enables images from devices with varying gamuts and representing both pre-rendered and unrendered scenes to be reproduced on output with varying gamuts.</span></span>

<span data-ttu-id="45bad-686">Четвертая проблема, которую должно решить новое ОТВ, заключается в том, что визуально серые цвета, создаваемые устройством, например, когда красный = зеленый = синий на мониторе, часто не попадают на нейтральную ось (если чрома = 0,0).</span><span class="sxs-lookup"><span data-stu-id="45bad-686">A fourth problem that the new CTE must resolve is that the visually gray colors produced by a device, for example, when red=green=blue on a monitor, frequently do not fall upon the neutral axis of the CAM (when the chroma = 0.0).</span></span> <span data-ttu-id="45bad-687">Это вызывает значительные трудности для Гмас.</span><span class="sxs-lookup"><span data-stu-id="45bad-687">This causes great difficulties for GMAs.</span></span> <span data-ttu-id="45bad-688">Чтобы сделать Гмас хорошо работать, необходимо скорректировать описание цветового охвата устройства и точек входа, чтобы нейтральная ось устройства настроилась на нейтральную ось пространства внешнего вида.</span><span class="sxs-lookup"><span data-stu-id="45bad-688">To make GMAs work well, you have to adjust the description of the device's gamut and of the input points so that the device's neutral axis falls on the appearance space's neutral axis.</span></span> <span data-ttu-id="45bad-689">Необходимо скорректировать точки с нейтральной оси на одинаковую величину.</span><span class="sxs-lookup"><span data-stu-id="45bad-689">You have to adjust points off the neutral axis by a similar amount.</span></span> <span data-ttu-id="45bad-690">В противном случае плавное увеличение изображения невозможно.</span><span class="sxs-lookup"><span data-stu-id="45bad-690">Otherwise, you cannot make smooth gradations through the image.</span></span> <span data-ttu-id="45bad-691">После выхода из платформы GMA вы отменяют это сопоставление относительно нейтральной оси выходного устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-691">On the way out of the GMA, you undo this mapping, relative to the output device's neutral axis.</span></span> <span data-ttu-id="45bad-692">Это называется выпрямлением оси «чиропрактик».</span><span class="sxs-lookup"><span data-stu-id="45bad-692">This is referred to as a "chiropractic" straightening of the axis.</span></span> <span data-ttu-id="45bad-693">Как и в случае с Чиропрактор, вы не только выравниваете скелет (нейтральную ось), но настраиваете остальную часть текста для перемещения вместе с скелетом.</span><span class="sxs-lookup"><span data-stu-id="45bad-693">Like a chiropractor, you not only straighten the skeleton (neutral axis), but you adjust the rest of the body to move along with the skeleton.</span></span> <span data-ttu-id="45bad-694">Как и в случае с Чиропрактор, вы не корректируете скелет с учетом того же объема, что и все пространство.</span><span class="sxs-lookup"><span data-stu-id="45bad-694">Like a chiropractor, you do not adjust the skeleton by the same amount through the entire space.</span></span> <span data-ttu-id="45bad-695">Вместо этого вы настраиваете разные разделы по-разному.</span><span class="sxs-lookup"><span data-stu-id="45bad-695">Instead, you adjust different sections differently.</span></span>

![Схема, показывающая кривизну нейтральной оси устройства относительно нейтральной оси ЦИЕКАМ.](images/gmmp-image081.png)

<span data-ttu-id="45bad-697">**Рис. 19.** Кривизна нейтральной оси устройства относительно нейтральной оси ЦИЕКАМ</span><span class="sxs-lookup"><span data-stu-id="45bad-697">**Figure 19:** Curvature of the device neutral axis relative to the CIECAM neutral axis</span></span>

<span data-ttu-id="45bad-698">Новое выражение CTE — это модель границы цветового охвата, которая может использоваться для представления как визуализированных, так и невизуализированных исходных изображений, предоставления сведений о внешнем интерфейсе устройства и предоставления сведений для изображений сопоставления тонов с широким диапазоном освещенности.</span><span class="sxs-lookup"><span data-stu-id="45bad-698">What the new CTE requires is a model of a gamut boundary that can be used to represent both rendered and unrendered source images, provide information about the appearance of device neutrals, and provide information for tone mapping images with a wide luminance range.</span></span>

![Схема, на которой показаны три интерпретатора цветов.](images/gmmp-image083.png)

<span data-ttu-id="45bad-700">**Рис. 20** . три оболочек с охватом</span><span class="sxs-lookup"><span data-stu-id="45bad-700">**Figure 20** : Three gamut shells</span></span>

<span data-ttu-id="45bad-701">Граница палитры состоит из трех оболочек, которые определяют три области.</span><span class="sxs-lookup"><span data-stu-id="45bad-701">The gamut boundary is composed of three shells that define three regions.</span></span>

<span data-ttu-id="45bad-702">В новом CTE-выражении внешняя оболочка в цветовой области формируется с помощью выпуклой поверхности, сделанного из образцов точек в области охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-702">In the new CTE, the outer shell of the gamut is formed with a convex hull made from sample points in the device gamut.</span></span> <span data-ttu-id="45bad-703">Поверхности формируется с помощью набора образцов и окружающих их поверхностью.</span><span class="sxs-lookup"><span data-stu-id="45bad-703">A hull is formed by taking a set of sample points and surrounding them by a surface.</span></span> <span data-ttu-id="45bad-704">Выпуклой поверхности имеет дополнительное свойство выпуклой везде.</span><span class="sxs-lookup"><span data-stu-id="45bad-704">A convex hull has the additional property of being convex everywhere.</span></span> <span data-ttu-id="45bad-705">Таким образом, это не самый маленький возможный поверхности, который можно вписать в данные.</span><span class="sxs-lookup"><span data-stu-id="45bad-705">Therefore, this is not the smallest possible hull that can be fit to the data.</span></span> <span data-ttu-id="45bad-706">Однако эксперименты показывают, что подгонка точек выборки слишком тесно приводит к непривлекательным артефактам в изображениях, например отсутствию плавной заливки.</span><span class="sxs-lookup"><span data-stu-id="45bad-706">But experimentation has shown that fitting the sample points too tightly causes unappealing artifacts in images, such as a lack of smooth shading.</span></span> <span data-ttu-id="45bad-707">Выпуклой поверхности, вероятно, решил эти проблемы.</span><span class="sxs-lookup"><span data-stu-id="45bad-707">The convex hull seems to solve these problems.</span></span>

<span data-ttu-id="45bad-708">В алгоритме значения цвета получаются для набора точек, взятых с устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-708">In the algorithm, color appearance values are obtained for a set of points sampled from the device.</span></span> <span data-ttu-id="45bad-709">Для мониторов и принтеров значения цвета получаются путем вывода образцов и последующего их измерения.</span><span class="sxs-lookup"><span data-stu-id="45bad-709">For monitors and printers, the color appearance values are obtained by outputting samples, and then measuring them.</span></span> <span data-ttu-id="45bad-710">Можно также создать модель устройства, а затем выполнить искусственные данные с помощью модели устройства для прогнозирования измеряемых значений.</span><span class="sxs-lookup"><span data-stu-id="45bad-710">You can also create a device model, and then run synthetic data through the device model to predict measured values.</span></span> <span data-ttu-id="45bad-711">Затем измеряемые значения преобразуются из скрытого пространства (XYZ) в область отображения (Jab), а поверхности — вокруг точек.</span><span class="sxs-lookup"><span data-stu-id="45bad-711">The measured values are then converted from colorimetric space (XYZ) to appearance space (Jab), and the hull is wrapped around the points.</span></span>

<span data-ttu-id="45bad-712">Ключевым моментом этого алгоритма является то, что принятая белая точка, используемая при преобразовании от + + до пространства внешнего вида, не должна быть белой точкой средней точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-712">The key point to this algorithm is that the adopted white point used in the conversion from colorimetric to appearance space does not have to be the medium's white point.</span></span> <span data-ttu-id="45bad-713">Вместо этого можно выбрать точку в пределах области, а также на нейтральной оси (или почти).</span><span class="sxs-lookup"><span data-stu-id="45bad-713">Instead, you can select a point farther inside the gamut and on (or near) the neutral axis.</span></span> <span data-ttu-id="45bad-714">После этого точка будет иметь значение J-100.</span><span class="sxs-lookup"><span data-stu-id="45bad-714">That point will then have a J-value of 100.</span></span> <span data-ttu-id="45bad-715">Выборки с измеряемым значением Y, превышающим принятые белые точки, будут заканчиваться значением J-value больше 100.</span><span class="sxs-lookup"><span data-stu-id="45bad-715">Samples with a measured Y-value higher than the adopted white point will end up with a J-value greater than 100.</span></span>

<span data-ttu-id="45bad-716">Если поместить белую точку рассеяния сцены в качестве принятой белой точки для преобразования цветового пространства, то отраженные блики в сцене будут легко определяться как имеющие значение J-value больше 100.</span><span class="sxs-lookup"><span data-stu-id="45bad-716">If you place the scene's diffuse white point as the adopted white point for the color space conversion, then specular highlights in the scene will be easily detected as having a J-value greater than 100.</span></span>

<span data-ttu-id="45bad-717">Так как цветовая модель CIECAM02 основана на системе человеческого визуальных элементов, после выбора принятого белого уровень яркости черной точки (J = 0) определяется моделью автоматически.</span><span class="sxs-lookup"><span data-stu-id="45bad-717">Because the CIECAM02 color model is based on the human visual system, after an adopted white is selected, the luminance level of the black point (J = 0) is automatically determined by the model.</span></span> <span data-ttu-id="45bad-718">Если входной образ имеет широкий динамический диапазон, возможно, имеются значения, сопоставленные со значениями J, меньшими нуля.</span><span class="sxs-lookup"><span data-stu-id="45bad-718">If the input image has a wide dynamic range, it is possible that there might be values that map to J-values less than zero.</span></span>

<span data-ttu-id="45bad-719">На следующем рисунке 21 показаны нейтральные устройства, выполняемые через центр правдоподобные и эталонных цветов.</span><span class="sxs-lookup"><span data-stu-id="45bad-719">The following Figure 21 shows the device neutrals running through the center of the plausible and reference gamuts.</span></span>

![Схема, на которой показана Нейтральная ось устройства, добавленная в границы палитры.](images/gmmp-image085.png)

<span data-ttu-id="45bad-721">**Рис. 21** . Добавление нейтральной оси устройства в границу палитры</span><span class="sxs-lookup"><span data-stu-id="45bad-721">**Figure 21** : Device neutral axis added to gamut boundary</span></span>

<span data-ttu-id="45bad-722">Все сопоставления цветовой гаммы обрезают входной диапазон до выходного диапазона или сжимают входной охват для размещения в пределах выходного диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-722">All gamut mappings involve either clipping an input range to an output gamut, or compressing the input gamut to fit within the output gamut.</span></span> <span data-ttu-id="45bad-723">Более сложные алгоритмы формируются путем сжатия и обрезки в разных направлениях или путем деления цветового охвата на разные регионы, а затем для выполнения обрезки или сжатия в разных регионах.</span><span class="sxs-lookup"><span data-stu-id="45bad-723">More complex algorithms are formed by compressing and clipping in different directions, or by dividing the gamut into different regions, and then performing clipping or compression in the different regions.</span></span>

<span data-ttu-id="45bad-724">Новое ОТВ расширяет эту концепцию для поддержки регионов возможного цветового охвата, правдоподобныего и эталонного региона, а также позволяет Гмас сопоставлять их различными способами.</span><span class="sxs-lookup"><span data-stu-id="45bad-724">The new CTE extends this concept to support the regions of a possible gamut, a plausible gamut, and a reference gamut, and enables GMAs to map them in different ways.</span></span> <span data-ttu-id="45bad-725">Кроме того, у Гмас есть сведения о независимой оси устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-725">In addition, the GMAs have information about the device neutral axis.</span></span> <span data-ttu-id="45bad-726">В следующем обсуждении рассматривается работа с ситуациями, когда правдоподобныеные и эталонные охваты свернуты друг над другом.</span><span class="sxs-lookup"><span data-stu-id="45bad-726">The following discussion addresses how to handle situations where the plausible gamuts and reference gamuts have collapsed on each other.</span></span>

![Схема, показывающая G M A с двумя несвернутыми дескрипторами цветовой гаммы.](images/gmmp-image091.png)

<span data-ttu-id="45bad-728">**Рис. 22** . GMA с двумя несвернутыми дескрипторами цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-728">**Figure 22** : GMA with two un-collapsed gamut descriptors</span></span>

<span data-ttu-id="45bad-729">Этот пример можно увидеть, если вы сопоставляется с устройством ввода, например с камерой или сканером, которое характеризуется отражающим целевым объектом, до пространства scRGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-729">You might see this example if you map from an input device, such as a camera or scanner that is characterized with a reflective target, to scRGB space.</span></span> <span data-ttu-id="45bad-730">Здесь цвета правдоподобные, которые светлее ссылки на белый, являются отраженными.</span><span class="sxs-lookup"><span data-stu-id="45bad-730">Here the plausible colors that are lighter than reference white are specular highlights.</span></span> <span data-ttu-id="45bad-731">На практике характеризующие камера с целевым объектом может не создать полный диапазон значений, возможных на камере. Однако отраженные блики и очень яркие цвета будут обнаружены в природе.</span><span class="sxs-lookup"><span data-stu-id="45bad-731">In practice, characterizing a camera with a target might not generate the full range of values possible in the camera; however, specular highlights and very chromatic colors found in nature would.</span></span> <span data-ttu-id="45bad-732">(Для передаваемой цели обычно используется исправление, которое является минимальной допустимой плотностью на носителе.</span><span class="sxs-lookup"><span data-stu-id="45bad-732">(Transmissive targets usually have a patch that is the minimum density possible on the medium.</span></span> <span data-ttu-id="45bad-733">При использовании такого целевого объекта отраженные блики будут находиться в пределах целевого диапазона.) Ссылка черного для отраженного целевого объекта будет начинаться с темной черной области.</span><span class="sxs-lookup"><span data-stu-id="45bad-733">With such a target, specular highlights would fall within the target's range.) The reference black for a reflective target would be the beginning of the shadow black region.</span></span> <span data-ttu-id="45bad-734">То есть, скорее всего, в тенях цвета темнее, чем черный на целевом объекте.</span><span class="sxs-lookup"><span data-stu-id="45bad-734">That is, there are likely to be colors in the shadows that are darker than the black on the target.</span></span> <span data-ttu-id="45bad-735">Если изображение содержит много интересного содержимого в этом регионе, может быть целесообразно сохранить этот вариант тона.</span><span class="sxs-lookup"><span data-stu-id="45bad-735">If the image contains a lot of interesting content in that region, it may be worthwhile preserving that tonal variation.</span></span>

![Схема, показывающая G M а с свернутым целевым диапазоном.](images/gmmp-image095.png)

<span data-ttu-id="45bad-737">**Рисунок 23** . цвет GMA с свернутым целевым диапазоном</span><span class="sxs-lookup"><span data-stu-id="45bad-737">**Figure 23** : GMA with collapsed destination gamut</span></span>

<span data-ttu-id="45bad-738">На рис. 23 показан один из возможных алгоритмов сопоставления цветового охвата, когда целевой цветовой охват предоставляет диапазон от белого устройства к черному, и нет возможных цветов вне этого диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-738">Figure 23 shows one possible gamut mapping algorithm when the destination gamut only provides the range from device white to black, and there are no possible colors outside this gamut.</span></span> <span data-ttu-id="45bad-739">Это может быть вызвано обычными устройствами вывода, такими как принтеры.</span><span class="sxs-lookup"><span data-stu-id="45bad-739">This is likely to happen for typical output devices, such as printers.</span></span> <span data-ttu-id="45bad-740">Возможные цвета сопоставлены с границей целевого диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-740">The possible colors are mapped to the edge of the destination gamut.</span></span> <span data-ttu-id="45bad-741">Но у него отсутствует кривая тона для выходного устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-741">But it lacks a tone curve for the output device.</span></span> <span data-ttu-id="45bad-742">GMA должен выбрать независимую точку низкого уровня освещенности для использования в качестве назначения для ссылки на белый.</span><span class="sxs-lookup"><span data-stu-id="45bad-742">The GMA must select some neutral point of lower luminance to use as a mapping destination for the reference white.</span></span> <span data-ttu-id="45bad-743">Для этого можно воспользоваться сложным алгоритмом, хистограмминг лигхтнессес в исходном изображении и увидеть, сколько попадают в диапазон ожидаемого, но более светлого, чем пустая ссылка.</span><span class="sxs-lookup"><span data-stu-id="45bad-743">A sophisticated algorithm can do this by histogramming the lightnesses in the source image and seeing how many fall in the range of expected but lighter than the reference white.</span></span> <span data-ttu-id="45bad-744">Чем больше лигхтнессес, тем больше места требуется на целевом устройстве между сопоставленными точками отраженных светов и ссылки белого.</span><span class="sxs-lookup"><span data-stu-id="45bad-744">The more lightnesses, the more space is required in the destination device between the mapped points for the specular highlights and reference white.</span></span> <span data-ttu-id="45bad-745">Более простой алгоритм может выбрать произвольное расстояние вниз от белого устройства, например 5 процентов.</span><span class="sxs-lookup"><span data-stu-id="45bad-745">A simpler algorithm might pick an arbitrary distance down the lightness scale from device white, such as 5 percent.</span></span> <span data-ttu-id="45bad-746">Аналогичный подход применяется к сопоставлению максимального черного и темного черного.</span><span class="sxs-lookup"><span data-stu-id="45bad-746">A similar approach applies for the mapping of the maximum black and shadow black.</span></span>

<span data-ttu-id="45bad-747">После создания кривой тонов назначения можно сопоставлять в методе, аналогичном тому, который использовался на предыдущем рис. 23.</span><span class="sxs-lookup"><span data-stu-id="45bad-747">After you generate the destination tone curve, you can map in a method similar to that used in the preceding Figure 23.</span></span> <span data-ttu-id="45bad-748">Все точки в кривой тонов назначения попадают в цветовую гамму устройства, и все точки в сопоставлении должны попадать в цветовой охват устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-748">All points in the destination tone curve will fall within the device gamut, and all points in the mapping must fall within the device gamut.</span></span>

<span data-ttu-id="45bad-749">Если вы меняете значения слева и справа, а также направления стрелок на рис. 23, можно описать случай, когда исходное изображение имеет только эталонный охват, а три цветовых элемента устройства вывода не свернуты друг с другом.</span><span class="sxs-lookup"><span data-stu-id="45bad-749">If you reverse the left figures and right figures, and the directions of the arrows in Figure 23, you can describe the case where the source image has only a reference gamut, and the three gamuts of the output device have not collapsed onto each other.</span></span> <span data-ttu-id="45bad-750">Например, можно сопоставить монитор с scRGB.</span><span class="sxs-lookup"><span data-stu-id="45bad-750">An example of this might be mapping from a monitor to scRGB.</span></span> <span data-ttu-id="45bad-751">И опять же, он должен создать элементы управления для пяти точек на кривой тона для исходного изображения.</span><span class="sxs-lookup"><span data-stu-id="45bad-751">Again, the GMA must synthesize the control points for the five points on the tone curve for the source image.</span></span> <span data-ttu-id="45bad-752">Некоторые сопоставления могут содержать все точки кривой тона в пределах области охвата устройства scRGB, в то время как другие сопоставления могут использовать больше цветового охвата scRGB путем сопоставления рассеянного белого со ссылкой белого и допустить отражение белого для сопоставления с более светлым значением.</span><span class="sxs-lookup"><span data-stu-id="45bad-752">Some mappings might put all points of the tone curve within the scRGB device gamut, while other mappings might use more of the scRGB gamut by mapping diffuse white to the reference white and allowing specular white to map to a lighter value.</span></span>

<span data-ttu-id="45bad-753">Наконец, существует ситуация, когда оба устройства имеют только эталонный охват, то есть как работают все алгоритмы сопоставления палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-753">Finally, you have the case where both devices have only the reference gamut, which is how most gamut mapping algorithms work.</span></span> <span data-ttu-id="45bad-754">Это можно разрешить, просто вернувшись к текущим алгоритмам.</span><span class="sxs-lookup"><span data-stu-id="45bad-754">So you can resolve this by just falling back to current algorithms.</span></span> <span data-ttu-id="45bad-755">Кроме того, если имеется разумный способ определения пяти опорных точек для исходных и целевых устройств, то можно выполнить упорядочивание для соответствия опорных точек.</span><span class="sxs-lookup"><span data-stu-id="45bad-755">Alternatively, if you have a reasonable way to determine the five reference points for the source and destination devices, then you can arrange to map the reference points.</span></span>

<span data-ttu-id="45bad-756">В палитрах устройств содержится более пяти опорных точек на нейтральной оси.</span><span class="sxs-lookup"><span data-stu-id="45bad-756">Device gamuts contain more than the five reference points on the neutral axis.</span></span> <span data-ttu-id="45bad-757">Они просто представляют границы между потенциальными регионами в изображении.</span><span class="sxs-lookup"><span data-stu-id="45bad-757">These just represent the boundaries between potential regions in the image.</span></span> <span data-ttu-id="45bad-758">Между каждой контрольной точкой можно использовать любой из существующих методов сопоставления палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-758">Between each of the reference points, you can use any of the existing gamut mapping techniques.</span></span> <span data-ttu-id="45bad-759">Таким образом, можно обрезать диапазон непредвиденных цветов и сжимать все цвета между предполагаемым белым и черным элементами или вырезать все цвета за пределами диапазона ссылок и сжимать их в пределах этого диапазона.</span><span class="sxs-lookup"><span data-stu-id="45bad-759">So you might clip the range of unexpected colors, and compress all colors between the expected white and black, or you might clip all colors outside the reference range and compress within that range.</span></span> <span data-ttu-id="45bad-760">Существует множество возможностей, которые могут быть реализованы в разных Гмас.</span><span class="sxs-lookup"><span data-stu-id="45bad-760">There are many possibilities, which can be implemented in different GMAs.</span></span> <span data-ttu-id="45bad-761">Кроме того, Гмас может сжимать и обрезать различные способы.</span><span class="sxs-lookup"><span data-stu-id="45bad-761">Further, the GMAs can compress and clip in different ways.</span></span> <span data-ttu-id="45bad-762">Все эти сочетания описаны в этом Invention.</span><span class="sxs-lookup"><span data-stu-id="45bad-762">All of those combinations are covered within this invention.</span></span>

<span data-ttu-id="45bad-763">До сих пор в этом обсуждении цветовой охват считался только функцией устройства, на котором было создано, записано или отображено изображение.</span><span class="sxs-lookup"><span data-stu-id="45bad-763">So far in this discussion, the gamut has been treated as if it were solely a function of the device on which the image was created, captured, or displayed.</span></span> <span data-ttu-id="45bad-764">Однако нет причин того, что все изображения на устройстве должны иметь один и тот же цветовой охват.</span><span class="sxs-lookup"><span data-stu-id="45bad-764">However, there is no reason why all images for a device must have the same gamut.</span></span> <span data-ttu-id="45bad-765">Гмас зависит от данных в ГБД.</span><span class="sxs-lookup"><span data-stu-id="45bad-765">The GMAs depend on the data in the GBD.</span></span> <span data-ttu-id="45bad-766">Если дескриптор изменяется между изображениями, Гмас не может быть осведомлена о них.</span><span class="sxs-lookup"><span data-stu-id="45bad-766">If the descriptor is changed between images, there is no way for the GMAs to know.</span></span> <span data-ttu-id="45bad-767">В частности, если изображения не имеют отраженных светов, Гмас работает лучше, если дескриптор цветового охвата не показывает, что цвета светлее рассеянного белого.</span><span class="sxs-lookup"><span data-stu-id="45bad-767">In particular, if images have no specular highlights, GMAs perform better if the gamut descriptor does not show that there are colors lighter than diffuse white.</span></span>

<span data-ttu-id="45bad-768">В новой архитектуре CTE можно использовать более одной GMA.</span><span class="sxs-lookup"><span data-stu-id="45bad-768">In the new CTE architecture, it is possible to use more than one GMA.</span></span> <span data-ttu-id="45bad-769">Использование нескольких Гмас по своей природе неверно определено.</span><span class="sxs-lookup"><span data-stu-id="45bad-769">Using multiple GMAs is inherently ill-defined.</span></span> <span data-ttu-id="45bad-770">Например, если устройство записи связывает элемент GMA с его "внешним видом", он, как правило, имеет целевой цветовой охват.</span><span class="sxs-lookup"><span data-stu-id="45bad-770">For example, if a capture device associates a GMA with its "look and feel," it tends to do so with a "targeted" destination gamut.</span></span> <span data-ttu-id="45bad-771">То же самое касается и выходных устройств, и «целевых» исходных диапазонов.</span><span class="sxs-lookup"><span data-stu-id="45bad-771">The same is true for output devices and "targeted" source gamuts.</span></span> <span data-ttu-id="45bad-772">Цветовой охват sRGB — это один из наиболее часто нацеленных подразумеваемых цветов.</span><span class="sxs-lookup"><span data-stu-id="45bad-772">The sRGB gamut is one commonly targeted implied gamut.</span></span> <span data-ttu-id="45bad-773">Поэтому настоятельно рекомендуется использовать один элемент GMA, если предсказуемость является приоритетной.</span><span class="sxs-lookup"><span data-stu-id="45bad-773">Therefore, it is strongly recommended that you use a single GMA, if predictability is a priority.</span></span> <span data-ttu-id="45bad-774">Один рабочий процесс GMA должен быть значением по умолчанию для всех рабочих процессов, особенно потребительских и профпотребителя рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="45bad-774">A single GMA workflow should be the default for all workflows, especially consumer and prosumer workflows.</span></span> <span data-ttu-id="45bad-775">Хотя сопоставление цветового охвата для предпочтительного воспроизведения должно выполняться один раз, существуют экземпляры, в которых включены несколько процессов сопоставления.</span><span class="sxs-lookup"><span data-stu-id="45bad-775">While gamut mapping for preferred reproduction should be done one time, there are instances where multiple mapping processes are included.</span></span> <span data-ttu-id="45bad-776">Во-первых, для подтверждения, вы выполняете предварительное сопоставление с цветовым охватом конечного целевого устройства, а затем передаете цветовую гамму устройства для подтверждения.</span><span class="sxs-lookup"><span data-stu-id="45bad-776">First, for proofing, you do a preferred mapping to the gamut of the final target device, and then a colorimetric rendering to the gamut of the proofing device.</span></span> <span data-ttu-id="45bad-777">Во-вторых, некоторые типы сопоставления используются для изменения характеристик изображения, но не включаются для сопоставления с палитрой устройства, например для регулировки кривой тона или цветовой характеристики.</span><span class="sxs-lookup"><span data-stu-id="45bad-777">Second, some types of mapping are used to alter the characteristics of the image, but aren't included to map to a device gamut, for example, adjusting the tone curve or the chromaticity.</span></span> <span data-ttu-id="45bad-778">Если используется несколько Гмас, интерфейс преобразования принимает массив привязанных сопоставлений цветов, т. е. сопоставлений палитры, которые были инициализированы парой описаний границ палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-778">If multiple GMAs are used, the transform interface takes an array of bound gamut maps, that is, gamut maps that have been initialized with a pair of gamut boundary descriptions.</span></span> <span data-ttu-id="45bad-779">При наличии нескольких сопоставлений цветовой гаммы граница входного диапазона для успешности сопоставленного диапазона должна совпадать с границей выходного диапазона для его предшественника.</span><span class="sxs-lookup"><span data-stu-id="45bad-779">When there is more than one gamut map, the input gamut boundary for a succeeding gamut map must be the same as the output gamut boundary of its predecessor.</span></span>

<span data-ttu-id="45bad-780">Функция границы цветовой гаммы устройства принимает модуль модели устройства и аналитические параметры и извлекает цветовую границу палитры устройства, описанную в виде упорядоченного списка вершин выпуклой поверхности в области охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-780">The device gamut boundary function takes the device model engine and analytical parameters and derives a color device gamut boundary described as an ordered vertex list of the convex hull of the device gamut.</span></span> <span data-ttu-id="45bad-781">Упорядоченный список вершин хранится в Циежаб.</span><span class="sxs-lookup"><span data-stu-id="45bad-781">The ordered vertex list is stored in CIEJab.</span></span> <span data-ttu-id="45bad-782">Структура упорядоченного списка вершин оптимизирована для аппаратного ускорения с помощью DirectX.</span><span class="sxs-lookup"><span data-stu-id="45bad-782">The structure of the ordered vertex list is optimized for hardware acceleration by DirectX.</span></span> <span data-ttu-id="45bad-783">Этот подход имеет множество хорошо известных решений (ищите «выпуклой поверхности DirectX» в Интернете и вы получаете более 100 попаданий).</span><span class="sxs-lookup"><span data-stu-id="45bad-783">This approach has many well known solutions (search for "convex hull DirectX" on the web and you get well over 100 hits).</span></span> <span data-ttu-id="45bad-784">Кроме того, в этой статье содержится ссылка на 1983 по этой теме (компьютерные и видеоподсистемы и приложения, "Шифуллс, b-сплайновые поверхности и кадкам" PP. 34-49) со ссылками датировано от 1970 до 1982 в разделе.</span><span class="sxs-lookup"><span data-stu-id="45bad-784">There is also a reference from 1983 on this topic (Computer Graphics Theory and Application, "Shiphulls, b-spline surfaces and cadcam" pp. 34-49), with references dating from 1970 to 1982 on the topic.</span></span>

<span data-ttu-id="45bad-785">Для расчета треугольников в оболочке цветовой области можно использовать два разных метода.</span><span class="sxs-lookup"><span data-stu-id="45bad-785">Two different techniques can be used to compute the triangles in the gamut shell.</span></span> <span data-ttu-id="45bad-786">Для других устройств, кроме дополнительных устройств RGB, вы Вычислите выпуклой поверхности.</span><span class="sxs-lookup"><span data-stu-id="45bad-786">For other devices other than additive RGB devices, you compute a convex hull.</span></span> <span data-ttu-id="45bad-787">Вы можете исследовать невыпуклойную поддержку поверхности для других устройств, если у вас есть прямой доступ к таким устройствам для проверки надежности, производительности и точности алгоритмов.</span><span class="sxs-lookup"><span data-stu-id="45bad-787">You can consider investigating non-convex hull support for other devices if you have direct access to such devices to validate the robustness, performance, and fidelity of the algorithms.</span></span> <span data-ttu-id="45bad-788">Это хорошо известный процесс, который не требует дальнейшего описания.</span><span class="sxs-lookup"><span data-stu-id="45bad-788">This is a well-known process that does not require further description.</span></span> <span data-ttu-id="45bad-789">Метод, используемый для аддитивных устройств RGB, описан ниже.</span><span class="sxs-lookup"><span data-stu-id="45bad-789">The technique used for additive RGB devices is described as follows.</span></span>

<span data-ttu-id="45bad-790">Разные Гбдс имеют свои преимущества и недостатки.</span><span class="sxs-lookup"><span data-stu-id="45bad-790">Different GBDs have advantages and drawbacks.</span></span> <span data-ttu-id="45bad-791">Представление выпуклой поверхности гарантирует привлекательные геометрические свойства, такие как выпуклой срезы оттенков, которые обеспечивают уникальную точку пересечения с лучом оптимизации от точки на нейтральной оси.</span><span class="sxs-lookup"><span data-stu-id="45bad-791">The convex hull representation guarantees nice geometric properties, such as convex hue slices that provide a unique intersection point with a ray emanating from a point on the neutral axis.</span></span> <span data-ttu-id="45bad-792">Недостатком представления выпуклой поверхности является также конвексити.</span><span class="sxs-lookup"><span data-stu-id="45bad-792">The downside of the convex hull representation is also convexity.</span></span> <span data-ttu-id="45bad-793">Известно, что многие устройства, в частности, отображают устройства, имеют охваты, которые далеко не выпуклой.</span><span class="sxs-lookup"><span data-stu-id="45bad-793">It is known that many devices, specifically display devices, have gamuts that are far from being convex.</span></span> <span data-ttu-id="45bad-794">Если фактический охват сильно отличается от предположения конвексити, представление поверхности выпуклой будет неточным, возможно, в том, что он не представляет реальность.</span><span class="sxs-lookup"><span data-stu-id="45bad-794">If the actual gamut deviates significantly from the convexity assumption, the convex hull representation would be inaccurate, possibly to the extent that it doesn't represent reality.</span></span>

<span data-ttu-id="45bad-795">После внедрения ГБД, который дает достаточно точное представление о фактическом охвате, возникают другие проблемы, некоторые из-за очень концепции среза оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-795">After you adopt a GBD that gives a reasonably accurate representation of the actual gamut, other problems arise, some due to the very concept of hue slice.</span></span> <span data-ttu-id="45bad-796">Существует по крайней мере две патология ситуации.</span><span class="sxs-lookup"><span data-stu-id="45bad-796">There are at least two pathological situations.</span></span> <span data-ttu-id="45bad-797">На следующем рис. 24 цветовой охват CRT выдает срезы с «островами».</span><span class="sxs-lookup"><span data-stu-id="45bad-797">In the following Figure 24, a CRT gamut gives rise to hue slices with "islands."</span></span> <span data-ttu-id="45bad-798">На рис. 25 цветовой охват выводится на срез оттенка, а часть нейтральной оси отсутствует.</span><span class="sxs-lookup"><span data-stu-id="45bad-798">In Figure 25, a printer gamut gives rise to a hue slice with part of the neutral axis missing.</span></span> <span data-ttu-id="45bad-799">В таких случаях срезы патология оттенок не вызываются особенно патологияными границами.</span><span class="sxs-lookup"><span data-stu-id="45bad-799">The pathological hue slices are not caused by particularly pathological gamut boundaries in these cases.</span></span> <span data-ttu-id="45bad-800">Они вызваны очень концепцией среза «оттенок», так как (а) он принимается вместе с постоянным оттенком и (б) он занимает одну половину плоскости, которая соответствует значению угла оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-800">They are caused by the very concept of hue slice, because (a) it is taken along constant hue, and (b) it only takes one-half of the plane that corresponds to the hue angle.</span></span>

![Схема, на которой показано верхнее представление и боковое представление "изгиб в" синих оттенков.](images/gmmp-image097.jpg)

<span data-ttu-id="45bad-802">**Рис. 24** . ТИПИЧный ЭЛТ-монитор имеет цветовой охват, который показывает довольно необычная «изгиб» в синих тона.</span><span class="sxs-lookup"><span data-stu-id="45bad-802">**Figure 24** : A typical CRT monitor has a gamut that shows peculiar "curving in" in the blue hues.</span></span> <span data-ttu-id="45bad-803">Если в пределах этого диапазона оттенок помещаются срезы оттенка, то изолированные острова могут отображаться на срезах оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-803">If hue slices are taken within this hue range, isolated islands may appear in the hue slices.</span></span>

![Схема цветового охвата с пропуском в нейтральной оси.](images/gmmp-image099.jpg)

<span data-ttu-id="45bad-805">**Рис. 25** . принтер может иметь цветовой охват, имеющий "зазор" в нейтральной оси.</span><span class="sxs-lookup"><span data-stu-id="45bad-805">**Figure 25** : A printer may have a gamut that has "gap" in its neutral axis.</span></span> <span data-ttu-id="45bad-806">При создании среза оттенок (который состоит только из одной половины плоскости) в части границы, которая является нейтральной, добавляется "выступ".</span><span class="sxs-lookup"><span data-stu-id="45bad-806">When a hue slice is taken (which is only one-half the plane), there is a "dent" on the part of the boundary that is the neutral axis.</span></span> <span data-ttu-id="45bad-807">Это может быть трудно устранить алгоритмически.</span><span class="sxs-lookup"><span data-stu-id="45bad-807">This can be hard to resolve algorithmically.</span></span>

<span data-ttu-id="45bad-808">Чтобы устранить эти пасологиес, предлагается новая платформа, которая отменяет концепцию среза оттенка, который используется в качестве начальной точки.</span><span class="sxs-lookup"><span data-stu-id="45bad-808">To resolve these pathologies, a new framework is proposed that abandons the concept of hue slice that used as the starting point.</span></span> <span data-ttu-id="45bad-809">Вместо этого платформа использует набор "элементы линии границы" или линии, которые находятся на границе цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-809">Instead, the framework uses the set of "boundary line elements," or lines that lie on the gamut boundary.</span></span> <span data-ttu-id="45bad-810">Они не обязательно обеспечивают согласованную геометрическую визуализацию, например срезы оттенков, но поддерживают все общие операции с охватом.</span><span class="sxs-lookup"><span data-stu-id="45bad-810">They do not necessarily provide a coherent geometric visualization like hue slices, but they support all the common gamut operations.</span></span> <span data-ttu-id="45bad-811">Помимо решения проблем, упомянутых выше, этот подход также предполагает, что создание срезов оттенков, даже если это возможно, является вычислительно непроизводительна.</span><span class="sxs-lookup"><span data-stu-id="45bad-811">Besides solving the problems mentioned previously, this approach also suggests that the construction of hue slices, even when it is possible, is computationally wasteful.</span></span>

### <a name="triangulation-of-the-gamut-boundary"></a><span data-ttu-id="45bad-812">Триангуляция границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-812">Triangulation of the Gamut Boundary</span></span>

<span data-ttu-id="45bad-813">Начальная точка — это ГБД, состоящий из триангуляции границы цветовой области.</span><span class="sxs-lookup"><span data-stu-id="45bad-813">The starting point is a GBD consisting of a triangulation of the gamut boundary.</span></span> <span data-ttu-id="45bad-814">Известные методы создания Гбдс обычно обеспечивают эту триангуляцию.</span><span class="sxs-lookup"><span data-stu-id="45bad-814">Known methods of constructing GBDs usually provide that triangulation.</span></span> <span data-ttu-id="45bad-815">В частности, один из способов создания Гбдс для добавочных устройств описывается здесь.</span><span class="sxs-lookup"><span data-stu-id="45bad-815">For concreteness, one method of constructing GBDs for additive devices its device space is described here.</span></span> <span data-ttu-id="45bad-816">К этим устройствам относятся мониторы (на основе CRT и ЖК) и проекторы.</span><span class="sxs-lookup"><span data-stu-id="45bad-816">These devices include monitors (both CRT-based and LCD-based) and projectors.</span></span> <span data-ttu-id="45bad-817">Простая геометрия Куба позволяет ввести обычный Lattice в Кубе.</span><span class="sxs-lookup"><span data-stu-id="45bad-817">The simple geometry of the cube enables you to introduce a regular lattice on the cube.</span></span> <span data-ttu-id="45bad-818">Границы куба могут быть триангуляции в несколько приемов, например показанные на рис. 26.</span><span class="sxs-lookup"><span data-stu-id="45bad-818">The boundary faces of the cube can be triangulated in a number of fashions, such as the one shown in Figure 26.</span></span> <span data-ttu-id="45bad-819">Архитектура предоставляет модель устройства для устройства, чтобы можно было получить значение, равное Lattice точкам алгоритмически, или измерения были сделаны непосредственно для этих точек.</span><span class="sxs-lookup"><span data-stu-id="45bad-819">The architecture provides either a device model for the device so that colorimetric values of the lattice points can be obtained algorithmically, or measurements have been made directly for those points.</span></span> <span data-ttu-id="45bad-820">Архитектура также предоставляет CIECAM02, чтобы можно было предположить, что начальные данные уже были сопоставлены с CIECAM02 Jab пространством.</span><span class="sxs-lookup"><span data-stu-id="45bad-820">The architecture also provides CIECAM02, so that you can assume the starting data has already been mapped into CIECAM02 Jab space.</span></span> <span data-ttu-id="45bad-821">Затем каждая точка Lattice на границах Куба RGB имеет соответствующую точку в Jab пространстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-821">Then each lattice point on the boundary faces of the RGB cube has a corresponding point in Jab space.</span></span> <span data-ttu-id="45bad-822">Соединения точек, образующих набор треугольников в пространстве RGB, также применяют набор треугольников в Jab пространстве.</span><span class="sxs-lookup"><span data-stu-id="45bad-822">The connections of points that form the set of triangles in RGB space also induces a set of triangles in Jab space.</span></span> <span data-ttu-id="45bad-823">Этот набор треугольников образует разумное триангуляцию границы палитры, если (а) Lattice в Кубе RGB достаточно, и (б) преобразование из пространства устройства в равномерное цветовое пространство топологически правильно. то есть он сопоставляет границу с границей и не перемещает охват внутрь, чтобы внутренние точки стали точками границ.</span><span class="sxs-lookup"><span data-stu-id="45bad-823">This set of triangles forms a reasonable triangulation of the gamut boundary if (a) the lattice on the RGB cube is fine enough, and (b) the transformation from device space to the uniform color space is topologically well-behaved; that is, it maps boundary to boundary, and it doesn't turn the gamut inside out so that interior points become boundary points.</span></span>

![Схема, на которой показан простой метод для трианглуате границы цветового охвата устройства с R G B в качестве пространства устройства.](images/gmmp-image100.png)

<span data-ttu-id="45bad-825">**Рис. 26** . простой способ триангуляции границы цветового охвата устройства с RGB в качестве пространства устройства</span><span class="sxs-lookup"><span data-stu-id="45bad-825">**Figure 26** : A simple method to triangulate the gamut boundary of a device with RGB as its device space</span></span>

### <a name="boundary-line-elements"></a><span data-ttu-id="45bad-826">Элементы линии границ</span><span class="sxs-lookup"><span data-stu-id="45bad-826">Boundary Line Elements</span></span>

<span data-ttu-id="45bad-827">Центральным по отношению к этой платформе является концепция элементов границ линий; набор линейных сегментов, которые (a) находятся на границе цветового охвата, а (б) находится на плоскости.</span><span class="sxs-lookup"><span data-stu-id="45bad-827">Central to this framework is the concept of boundary line elements; a set of line segments that (a) lie on the gamut boundary, and (b) lie on a plane.</span></span> <span data-ttu-id="45bad-828">В этом случае плоскость является плоскостью оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-828">In this case, the plane is a hue plane.</span></span> <span data-ttu-id="45bad-829">Каждый сегмент линии является результатом пересечения плоскости с треугольником границы цветовой гаммы.</span><span class="sxs-lookup"><span data-stu-id="45bad-829">Each line segment is the result of intersecting the plane with a gamut boundary triangle.</span></span> <span data-ttu-id="45bad-830">Хотя многие исследователи использовали конструкцию пересечения плоскости с границами треугольников, они обычно анализируют связь между этими сегментами линии и пытаются создать согласованный геометрический объект за пределами линейных сегментов.</span><span class="sxs-lookup"><span data-stu-id="45bad-830">Although many researchers have used the construction of intersecting a plane with boundary triangles, they generally analyze the relationship among these line segments, and attempt to construct a coherent geometric object out of the line segments.</span></span> <span data-ttu-id="45bad-831">Разрабатываются разные алгоритмы, чтобы следовать этим сегментам строки один за другим, пока не будет получен весь срез оттенка, и для ускорения процесса поиска были сделаны многие попытки.</span><span class="sxs-lookup"><span data-stu-id="45bad-831">Different algorithms have been devised to follow these line segments one after the other until a whole hue slice is obtained, and many attempts have been made to speed up the process of searching.</span></span>

<span data-ttu-id="45bad-832">Этот подход отличается.</span><span class="sxs-lookup"><span data-stu-id="45bad-832">This approach is different.</span></span> <span data-ttu-id="45bad-833">Вы пересекаете плоскость с треугольниками для получения сегментов линии.</span><span class="sxs-lookup"><span data-stu-id="45bad-833">You intersect the plane with the triangles to obtain the line segments.</span></span> <span data-ttu-id="45bad-834">Затем эти линейные сегменты следует рассматривать как *основные* концептуальные объекты.</span><span class="sxs-lookup"><span data-stu-id="45bad-834">You then consider these line segments as the *basic* conceptual objects.</span></span> <span data-ttu-id="45bad-835">Необходимо проанализировать связь между сегментами линии; Вам не нужно уметь связываться друг с другом.</span><span class="sxs-lookup"><span data-stu-id="45bad-835">It is necessary to analyze the relationship among the line segments; you don't have to know how they are interconnected with each other.</span></span> <span data-ttu-id="45bad-836">Эта точка зрения решает проблему среза оттенок с островами.</span><span class="sxs-lookup"><span data-stu-id="45bad-836">This point of view solves the problem of hue slice with islands.</span></span> <span data-ttu-id="45bad-837">Известные подходы, которые попытаются создать срез оттенка, предполагают, что, если один из них начинается с одного сегмента линии и находится за ним в следующем сегменте строки и т. д. в итоге он вернется к начальной точке, после чего будет создан весь срез оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-837">The known approaches that attempt to construct hue slice assume that, if one starts with one line segment and follows it to the next line segment, and so on; it eventually leads back to the starting point, at which point a whole hue slice would be constructed.</span></span> <span data-ttu-id="45bad-838">К сожалению, этот подход будет пропускать остров (а в худшем случае — континент).</span><span class="sxs-lookup"><span data-stu-id="45bad-838">Unfortunately, this approach would miss the island (and in the worst scenario, the continent).</span></span> <span data-ttu-id="45bad-839">Не настаивает на получении четкого геометрического изображения; Это значит, что можно легко справиться с проблемой острова.</span><span class="sxs-lookup"><span data-stu-id="45bad-839">By not insisting on obtaining a coherent geometric picture; that is, hue slice, you can handle the island problem effortlessly.</span></span> <span data-ttu-id="45bad-840">Еще одно важное различие в этом подходе заключается в том, что для ускорения построения сегментов линии используется «треугольный фильтр».</span><span class="sxs-lookup"><span data-stu-id="45bad-840">Another important difference in this approach is that, to speed up the construction of line segments, it uses a "triangle filter."</span></span> <span data-ttu-id="45bad-841">Фильтр треугольника выдает определенные треугольники, которые в определенном случае не создают сегменты линии, которые могут быть полезны в текущей операции цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-841">The triangle filter throws out certain triangles that will definitely not produce line segments that would be useful in the current gamut operation.</span></span> <span data-ttu-id="45bad-842">Поскольку пересечение треугольника с плоскостью требует дорогостоящих вычислений, это повышает скорость.</span><span class="sxs-lookup"><span data-stu-id="45bad-842">Because intersecting a triangle with the plane is expensive computationally, this improves speed.</span></span> <span data-ttu-id="45bad-843">Побочным действием является то, что нельзя создать срез оттенок, так как некоторые сегменты линии будут отсутствовать из-за фильтрации по треугольнику.</span><span class="sxs-lookup"><span data-stu-id="45bad-843">A side effect is that, you cannot construct hue slice because some line segments would be missing due to the triangle filtering.</span></span>

### <a name="gamut-operation-checkgamut"></a><span data-ttu-id="45bad-844">Операция с охватом: Чеккгамут</span><span class="sxs-lookup"><span data-stu-id="45bad-844">Gamut Operation: CheckGamut</span></span>

<span data-ttu-id="45bad-845">В следующем примере объясняется, как работает платформа, и как выполняется Чеккгамут, т. е. операция проверки того, находится ли цвет в цветовом охвате.</span><span class="sxs-lookup"><span data-stu-id="45bad-845">The following example will explain how the framework works, and how CheckGamut is carried out, that is, the operation of checking if a color is in-gamut.</span></span>

<span data-ttu-id="45bad-846">Общая инфраструктура показана на следующем рисунке 27.</span><span class="sxs-lookup"><span data-stu-id="45bad-846">The general framework is illustrated in the following Figure 27.</span></span> <span data-ttu-id="45bad-847">Существуют различные компоненты.</span><span class="sxs-lookup"><span data-stu-id="45bad-847">There are various components.</span></span> <span data-ttu-id="45bad-848">Компоненты, отмеченные курсивом, — это компоненты, которые могут различаться в реализации в зависимости от рассматриваемой операции с охватом.</span><span class="sxs-lookup"><span data-stu-id="45bad-848">The components labeled in italics are components that may be different in implementation depending on the gamut operation in question.</span></span> <span data-ttu-id="45bad-849">Другие компоненты являются инвариантными для всех операций с охватом.</span><span class="sxs-lookup"><span data-stu-id="45bad-849">The other components are invariant across all gamut operations.</span></span> <span data-ttu-id="45bad-850">Для начала ***входными данными*** является набор атрибутов цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-850">To begin, the ***Input*** is a set of color attributes.</span></span> <span data-ttu-id="45bad-851">В случае с Чеккгамут это цвет запроса.</span><span class="sxs-lookup"><span data-stu-id="45bad-851">In the case of CheckGamut, it is the query color.</span></span> <span data-ttu-id="45bad-852">На рис. 27 и следующем обсуждении предполагается, что угол оттенка является либо из атрибутов цветового ввода, либо из них.</span><span class="sxs-lookup"><span data-stu-id="45bad-852">In Figure 27 and the following discussion, it is assumed that the hue angle is either among the input color attributes, or can be obtained from them.</span></span> <span data-ttu-id="45bad-853">Это очевидно, если входные данные являются всей цветовой точкой в Jab или ЖЧ, из которой можно вычислить угол оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-853">This is clearly the case if the input is the whole color point, either in Jab or JCh, from which you can then compute the hue angle.</span></span> <span data-ttu-id="45bad-854">Обратите внимание, что угол оттенка необходим только в том случае, если используются плоскости оттенков.</span><span class="sxs-lookup"><span data-stu-id="45bad-854">Note that the hue angle is only needed because hue planes are being used.</span></span> <span data-ttu-id="45bad-855">В зависимости от заданной операции с охватом, возможно, не потребуется использовать плоскость оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-855">Depending on the gamut operation in question, it might not be necessary to use the hue plane.</span></span> <span data-ttu-id="45bad-856">Например, при создании подпрограммы Чеккгамут может потребоваться использовать плоскости с константой J. Это общая возможность, которая не будет использоваться или обсуждаться дальше; но может быть полезно помнить об этой гибкости методологии для поддержки других операций с охватом, когда плоскость оттенков может быть не лучшим выбором.</span><span class="sxs-lookup"><span data-stu-id="45bad-856">For example, in the construction of the routine CheckGamut, you might want to use planes of constant J. This is a generality that will not be used or discussed further; but it might be helpful to remember this flexibility of the methodology to support other gamut operations when hue plane might not be the best choice.</span></span>

![Схема, показывающая последовательность для поддержки операций с охватом.](images/gmmp-image112.jpg)

<span data-ttu-id="45bad-858">**Рис. 27** . платформа для поддержки операций с охватом</span><span class="sxs-lookup"><span data-stu-id="45bad-858">**Figure 27** : The framework to support gamut operations</span></span>

<span data-ttu-id="45bad-859">Угол оттенка, полученный непосредственно из входных данных или вычисленных на основе входных данных, используется для инициализации плоскости оттенков, помеченной как **полная плоскость оттенков** на рисунке.</span><span class="sxs-lookup"><span data-stu-id="45bad-859">The hue angle, which is obtained directly from the inputs or computed from the inputs, is used to initialize the hue plane labeled **Full Hue Plane** in the figure.</span></span> <span data-ttu-id="45bad-860">«Full» выделена, так как это полная плоскость, а не только половина плоскости, содержащей оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-860">"Full" is emphasized because this is the full plane, not just the half-plane containing the hue.</span></span> <span data-ttu-id="45bad-861">Полная плоскость содержит как угол оттенок ввода, так и угол 180 градусов в противоположном направлении.</span><span class="sxs-lookup"><span data-stu-id="45bad-861">The full plane contains both the input hue angle and the angle 180 degrees opposite to it.</span></span> <span data-ttu-id="45bad-862">Ключевыми функциями плоскости оттенка является функция INTERSECT, которая описывается в следующем подразделе «полная плоскость оттенка»: «Intersect».</span><span class="sxs-lookup"><span data-stu-id="45bad-862">The key functionality of the hue plane is the Intersect function, which is explained in the following subsection, Full Hue Plane: Intersect.</span></span> <span data-ttu-id="45bad-863">Предположим, что ГБД уже был создан и доступен набор **треугольников границ цветовой** области.</span><span class="sxs-lookup"><span data-stu-id="45bad-863">Assume that the GBD has already been constructed, and the set of **Gamut Boundary Triangles** is available.</span></span> <span data-ttu-id="45bad-864">Пересекает треугольники, которые были несохранившикой \**_треугольника_* _ с плоскостью оттенок с помощью Intersect.</span><span class="sxs-lookup"><span data-stu-id="45bad-864">Intersect the triangles that have survived the \**_Triangle Filter_* _ with the hue plane using Intersect.</span></span> <span data-ttu-id="45bad-865">_Компонент «фильтр треугольников» отмечен курсивом, что означает, что компонент различается в реализации для различных операций с охватом. *Фильтр треугольника* для чеккгамут объясняется в разделе операция с охватом: чеккгамут (продолжение). Результат пересечения треугольника с плоскостью оттенка пуст или является **элементом границы линии** , то есть парой уникальных точек. Если результат не пуст, он передается в \*_обработчик элемента строки_\* \*_ , который опять же выполняет различные действия в зависимости от операции с охватом.</span><span class="sxs-lookup"><span data-stu-id="45bad-865">The _Triangle Filter\* component is labeled in italics, which means that the component varies in implementation for different gamut operations. The *Triangle Filter* for CheckGamut is explained in the section, Gamut Operation: CheckGamut (continued). The result of intersecting a triangle with the hue plane is either empty or a **Boundary Line Element** , that is, a pair of distinct points. If the result is non-empty, it is passed into the \**_Line Element Processor_*_ , which again does different things depending on the gamut operation.</span></span> <span data-ttu-id="45bad-866">_Процессор элемента строки \* обновляет внутреннюю структуру данных \***внутренние обработанные данные**_ , содержимое или макет которых также зависит от операции выбора цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-866">The _Line Element Processor\* updates the internal data structure, \***Internal Processed Data**_ , whose content or layout also depends on the gamut operation.</span></span> <span data-ttu-id="45bad-867">Как правило, _внутренние обработанные данные \* содержат ответ на проблему, который постоянно обновляется при обнаружении каждого нового элемента границы линии. После обработки всех элементов границ линии ответ был найден. Он продолжает обращаться к нему через **адаптер вывода**\*_.</span><span class="sxs-lookup"><span data-stu-id="45bad-867">Generally, the _Internal Processed Data\* contains the "answer" to the problem, which is continually updated with each new Boundary Line Element found. When all the Boundary Line Elements have been processed, the answer has been found. It remains to access it through the \***Output Adaptor**_.</span></span> <span data-ttu-id="45bad-868">Так как _Internal обработанные данные \* являются специфическими для операций с охватом, *выходной адаптер* также будет зависят от операций с цветовой палитрой.</span><span class="sxs-lookup"><span data-stu-id="45bad-868">Because the _Internal Processed Data\* is gamut operation specific, the *Output Adaptor* is also gamut operation specific.</span></span>

### <a name="full-hue-plane-intersect"></a><span data-ttu-id="45bad-869">Плоскость полного оттенка: Intersect</span><span class="sxs-lookup"><span data-stu-id="45bad-869">Full Hue Plane: Intersect</span></span>

<span data-ttu-id="45bad-870">Функция Intersect вычисляет пересечение плоскости оттенок и треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-870">The Intersect function calculates the intersection of the hue plane and a triangle.</span></span> <span data-ttu-id="45bad-871">По мере того, как это звучит, эта функция важна по двум причинам.</span><span class="sxs-lookup"><span data-stu-id="45bad-871">As simple as it sounds, this function is important for two reasons.</span></span>

<span data-ttu-id="45bad-872">Во-первых, пересечение каждого края треугольника с плоскостью может привести к порядку трех точек пересечения — геопоказательно невозможность.</span><span class="sxs-lookup"><span data-stu-id="45bad-872">First, intersecting each edge of the triangle with the plane might yield three intersection points, a geometrically impossible situation.</span></span> <span data-ttu-id="45bad-873">Причина, по которой это может произойти в вычислениях, заключается в том, что при выполнении вычислений в плавающей точке, например в формате IEEE, унцертаинтиес или «числовой шум» на каждом шаге влияет на то, пересекаются ли границы плоскости.</span><span class="sxs-lookup"><span data-stu-id="45bad-873">The reason why this might happen in the computation is that, when calculations are done in floating point, for example, IEEE format, there are uncertainties, or "numeric noise," in each step that affects the conclusion of whether an edge intersects the plane.</span></span> <span data-ttu-id="45bad-874">Когда плоскость пересекает края в ближайшем к промаху ситуации, точки пересечения близки друг к другу, а определение того, находится ли точка пересечения в границах, является случайным.</span><span class="sxs-lookup"><span data-stu-id="45bad-874">When the plane intersects the edges in a near-miss situation, the intersection points are close to each other, and the determination whether an intersection point lies within the edge is random.</span></span> <span data-ttu-id="45bad-875">Несмотря на то, что шум в числовых значениях точек невелик, качественное заключение, что существует более двух точек пересечения, является геометрически невозможным и сложно правильно обработано в алгоритме.</span><span class="sxs-lookup"><span data-stu-id="45bad-875">Although noise in the numeric values of the points is small, the qualitative conclusion that there are more than two intersection points is geometrically impossible and difficult to handle correctly in the algorithm.</span></span>

<span data-ttu-id="45bad-876">Во-вторых, эта функция находится в критическом цикле для каждого края каждого отфильтрованного треугольника, поэтому важно оптимизировать его эффективность как можно больше.</span><span class="sxs-lookup"><span data-stu-id="45bad-876">Second, this function is in the critical loop for each edge of each filtered triangle, so it is important that you optimize its efficiency as much as possible.</span></span>

<span data-ttu-id="45bad-877">Чтобы устранить первую выдачу числового шума, выполните вычисления в целых числах.</span><span class="sxs-lookup"><span data-stu-id="45bad-877">To address the first issue Of numeric noise, perform the calculations in integers.</span></span> <span data-ttu-id="45bad-878">Для устранения второй проблемы, связанной с оптимизацией своей эффективности, следует кэшировать наиболее часто используемый атрибут каждой вершины или "элемент" марка ", связанный с каждой вершиной.</span><span class="sxs-lookup"><span data-stu-id="45bad-878">To address the second issue of optimizing its efficiency, cache the most used attribute of each vertex, or the "dot product" associated with each vertex.</span></span> <span data-ttu-id="45bad-879">Передача в целые числа — типичный способ гарантировать геометрическую согласованность.</span><span class="sxs-lookup"><span data-stu-id="45bad-879">Passing into integers is a typical way to guarantee geometric consistency.</span></span> <span data-ttu-id="45bad-880">Основная идея заключается в том, что если вам нужно квантуем, сделайте это в начале.</span><span class="sxs-lookup"><span data-stu-id="45bad-880">The basic idea is that if you have to quantize, do it at the beginning.</span></span> <span data-ttu-id="45bad-881">Затем последующие вычисления могут выполняться в целых числах, а если целые числа достаточно широкие, чтобы избежать переполнения, вычисления можно выполнять с бесконечной точностью.</span><span class="sxs-lookup"><span data-stu-id="45bad-881">Then subsequent calculations can be performed in integers, and if the integers are wide enough so that there is no danger of overflow, the calculations can be done with infinite precision.</span></span> <span data-ttu-id="45bad-882">Для этой цели полезна Следующая функция дискретизация.</span><span class="sxs-lookup"><span data-stu-id="45bad-882">The following quantization function useful for this purpose.</span></span>

<span data-ttu-id="45bad-883">Скалеандтрункате (x) = целая часть x \* 10000</span><span class="sxs-lookup"><span data-stu-id="45bad-883">ScaleAndTruncate(x) = Integer part of x\*10000</span></span>

<span data-ttu-id="45bad-884">Коэффициент масштабирования 10000 означает, что входное число с плавающей запятой имеет четыре десятичных знака, что достаточно точно для этого приложения.</span><span class="sxs-lookup"><span data-stu-id="45bad-884">The scaling factor 10000 means that the input floating-point number has four decimal places, which is precise enough for this application.</span></span> <span data-ttu-id="45bad-885">В зависимости от диапазона значений области отображения цвета необходимо выбрать целочисленный тип с битовым пространством, достаточным для хранения промежуточных вычислений.</span><span class="sxs-lookup"><span data-stu-id="45bad-885">Depending on the range of values of the color appearance space, you want to choose an integer type with bits wide enough to hold the intermediate calculations.</span></span> <span data-ttu-id="45bad-886">В большинстве пространств цветового представления диапазон каждой координаты находится в диапазоне от-1 000 до 1 000.</span><span class="sxs-lookup"><span data-stu-id="45bad-886">In most color appearance spaces, the range of each coordinate is within the range -1,000 to 1,000.</span></span> <span data-ttu-id="45bad-887">Координата квантования имеет максимально возможное абсолютное значение 1 000 \* 10 000 = 10 000 000.</span><span class="sxs-lookup"><span data-stu-id="45bad-887">The quantized coordinate has a maximum possible absolute value of 1,000\*10,000 = 10,000,000.</span></span> <span data-ttu-id="45bad-888">Как вы увидите, промежуточное количество представляет собой точку, которая является суммой двух продуктов координат, поэтому она имеет максимально возможное абсолютное значение 2 \* (10 000 000) ₂ = 2? 10 ₁ ₄.</span><span class="sxs-lookup"><span data-stu-id="45bad-888">As you will see, the intermediate quantity is a dot product, which is a sum of two products of coordinates, so it has a maximum possible absolute value of 2\*(10,000,000) ₂ = 2?10 ₁₄.</span></span> <span data-ttu-id="45bad-889">Требуемое число битов — log ₂ (2? 10 ₁ ₄) = 47,51.</span><span class="sxs-lookup"><span data-stu-id="45bad-889">The number of bits required is log ₂ (2?10 ₁₄ ) = 47.51.</span></span> <span data-ttu-id="45bad-890">Очень удобно выбрать целочисленный тип, поэтому 64-разрядные целые числа.</span><span class="sxs-lookup"><span data-stu-id="45bad-890">A convenient choice for the integer type is, therefore, 64-bit integers.</span></span>

<span data-ttu-id="45bad-891">Чтобы гарантировать, что при пересечении плоскости с треугольником всегда предоставляется пустой набор или набор из двух точек, необходимо рассматривать треугольник как целый, а не как отдельные края треугольника отдельно.</span><span class="sxs-lookup"><span data-stu-id="45bad-891">To guarantee that intersecting a plane with a triangle always gives either empty set or a set of two points, you must consider the triangle as a whole, not as individual edges of the triangle separately.</span></span> <span data-ttu-id="45bad-892">Чтобы разобраться в геометрической ситуации, рассмотрим «расстояния со знаком» вершин треугольника из плоскости «оттенок».</span><span class="sxs-lookup"><span data-stu-id="45bad-892">To understand the geometric situation, consider the "signed distances" of the vertices of the triangle from the hue plane.</span></span> <span data-ttu-id="45bad-893">Не вычислить эти расстояния со знаком напрямую; Вместо этого Вычислите пунктирные произведения векторов позиций вершин с квантованияным вектором нормали к плоскости.</span><span class="sxs-lookup"><span data-stu-id="45bad-893">Do not calculate these signed distances directly; instead calculate the dot products of the position vectors of the vertices with the quantized normal vector to the plane.</span></span> <span data-ttu-id="45bad-894">В частности, при инициализации плоскости оттенков квантованияный вектор нормали вычисляется следующим образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-894">More specifically, during the initialization of the hue plane, the quantized normal vector is calculated as follows.</span></span>

<span data-ttu-id="45bad-895">Нормалвектор = (Скалеандтрункате (-sin (тон)), Скалеандтрункате (cos (оттенок)))</span><span class="sxs-lookup"><span data-stu-id="45bad-895">NormalVector = (ScaleAndTruncate(-sin(hue)), ScaleAndTruncate(cos(hue)))</span></span>

<span data-ttu-id="45bad-896">Обратите внимание, что этот вектор является двумерным вектором.</span><span class="sxs-lookup"><span data-stu-id="45bad-896">Note that this vector is a two-dimensional vector.</span></span> <span data-ttu-id="45bad-897">Можно использовать двухмерный вектор, поскольку плоскость оттенок является вертикальной, поэтому третий компонент обычного вектора всегда равен нулю.</span><span class="sxs-lookup"><span data-stu-id="45bad-897">You can use a two-dimensional vector because the hue plane is vertical, so the third component of the normal vector is always zero.</span></span> <span data-ttu-id="45bad-898">Более того, таблица уточняющих запросов с точками инициализируется таким образом, чтобы иметь запись для каждой вершины из треугольников границы цветовой гаммы, а соответствующий продукт с точкой имеет недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="45bad-898">Moreover, a lookup table of dot products is initialized to have an entry for each vertex from the Gamut Boundary Triangles and the corresponding dot product set to an invalid value.</span></span>

<span data-ttu-id="45bad-899">Во время одной операции пересечения плоскости оттенка с треугольником выполняется поиск точки на каждой вершине треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-899">During one operation of intersecting the hue plane with a triangle, the dot product of each vertex of the triangle is looked up.</span></span> <span data-ttu-id="45bad-900">Если значение в таблице уточняющих запросов является недопустимым, то произведение точки будет вычислено с помощью следующего выражения.</span><span class="sxs-lookup"><span data-stu-id="45bad-900">If the value in the lookup table is the invalid value, then the dot product is computed using the following expression.</span></span>

<span data-ttu-id="45bad-901">Нормалвектор. \* скалеандтрункате (вершина a) + нормалвектор. b \* скалеандтрункате (вершина. b)</span><span class="sxs-lookup"><span data-stu-id="45bad-901">NormalVector.a\*ScaleAndTruncate(vertex.a) + NormalVector.b\*ScaleAndTruncate(vertex.b)</span></span>

<span data-ttu-id="45bad-902">Опять же, компонент J-Component вершины никогда не используется, так как стандартный вектор является горизонтальным.</span><span class="sxs-lookup"><span data-stu-id="45bad-902">Again, the J-component of the vertex is never used, because the normal vector is horizontal.</span></span> <span data-ttu-id="45bad-903">После этого эта точка будет сохранена в таблице уточняющих запросов, чтобы ее не нужно было вычислить снова при запросе точки на вершине.</span><span class="sxs-lookup"><span data-stu-id="45bad-903">This dot product is then saved in the lookup table so that it doesn't have to be computed again if the dot product of the vertex is queried later.</span></span>

<span data-ttu-id="45bad-904">Кэширование позволяет быстро определить, пересекаются ли границы плоскости, после того, как в таблице уточняющих запросов будут отображаться пограничные продукты с точками, которые создаются последовательно по мере обработки вершин.</span><span class="sxs-lookup"><span data-stu-id="45bad-904">Caching allows for a quick determination of whether an edge intersects the plane, after the dot products are tabulated in the lookup table, which is built progressively as the vertices are processed.</span></span>

![Схема, на которой показана пересечение плоскости оттенок с треугольником.](images/gmmp-image114.jpg)

<span data-ttu-id="45bad-906">**Рис. 28** . пересечение плоскости оттенок с треугольником</span><span class="sxs-lookup"><span data-stu-id="45bad-906">**Figure 28** : Intersecting the hue plane with a triangle</span></span>

<span data-ttu-id="45bad-907">Для треугольника на рисунке 28, пересекающего плоскость оттенка в сегменте вырожденной линии, при сортировке в возрастающем порядке должны находиться точки в одном из следующих шаблонов.</span><span class="sxs-lookup"><span data-stu-id="45bad-907">For the triangle in Figure 28 to intersect the hue plane in a non-degenerate line segment, the dot products of the vertices must be in one of the following patterns, when sorted in ascending order.</span></span>

<span data-ttu-id="45bad-908">0, 0, +; -, 0, 0; -, 0, +; -,-,+; -,+,+</span><span class="sxs-lookup"><span data-stu-id="45bad-908">0,0,+; -,0,0; -,0,+; -,-,+; -,+,+</span></span>

<span data-ttu-id="45bad-909">Конечная точка сегмента линии возникает, когда плоскость пересекается с вершинами с разными знаками в составе произведения с точкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-909">An end point of the line segment arises when the plane is intersected by an edge with vertices that have different signs in the dot product.</span></span> <span data-ttu-id="45bad-910">Если знак равен нулю, вершина находится непосредственно на плоскости, а пересечение границы с плоскостью является самой вершиной.</span><span class="sxs-lookup"><span data-stu-id="45bad-910">If the sign is zero, then the vertex lies right on the plane, and the intersection of the edge with the plane is the vertex itself.</span></span> <span data-ttu-id="45bad-911">Обратите внимание, что в случаях 0, 0, 0; -,-, 0; 0, +, + не отображаются.</span><span class="sxs-lookup"><span data-stu-id="45bad-911">Note also that the cases 0,0,0; -,-,0; 0,+,+ are not reported.</span></span> <span data-ttu-id="45bad-912">Первый случай (0, 0, 0) означает, что весь треугольник находится на плоскости.</span><span class="sxs-lookup"><span data-stu-id="45bad-912">The first case (0,0,0) means the whole triangle lies on the plane.</span></span> <span data-ttu-id="45bad-913">Это не сообщается, так как каждая граница треугольника должна относиться к соседнему треугольнику, который также не попадает на плоскость полностью.</span><span class="sxs-lookup"><span data-stu-id="45bad-913">This is not reported because each edge of the triangle should belong to a neighboring triangle that does not also lie entirely on the plane.</span></span> <span data-ttu-id="45bad-914">При рассмотрении этого треугольника появится сообщение о границе.</span><span class="sxs-lookup"><span data-stu-id="45bad-914">The edge will be reported when that triangle is considered.</span></span> <span data-ttu-id="45bad-915">Два других варианта (-,-, 0 и 0, +, +) соответствуют геометрической конфигурации, которую треугольник касается плоскости в одной вершине.</span><span class="sxs-lookup"><span data-stu-id="45bad-915">The other two cases (-,-,0 and 0,+,+) correspond to the geometric configuration that the triangle touches the plane in one vertex.</span></span> <span data-ttu-id="45bad-916">Эти случаи не передаются, так как они не приводят к появлению вырожденного сегмента линии.</span><span class="sxs-lookup"><span data-stu-id="45bad-916">These cases are not reported because they don't give rise to a non-degenerate line segment.</span></span>

<span data-ttu-id="45bad-917">Предыдущий алгоритм определяет, когда следует вычислить пересечение между границей треугольника и плоскостью оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-917">The preceding algorithm determines when to calculate an intersection between an edge of the triangle and the hue plane.</span></span> <span data-ttu-id="45bad-918">После определения границы пересечение вычисляется с помощью параметрической формулы.</span><span class="sxs-lookup"><span data-stu-id="45bad-918">After an edge is determined, the intersection is calculated using parametric equations.</span></span> <span data-ttu-id="45bad-919">Если один из таких продуктов имеет нулевое значение, то пересечением является сама вершина, поэтому вычисление не требуется.</span><span class="sxs-lookup"><span data-stu-id="45bad-919">If one of the dot products is zero, the intersection is the vertex itself, so no calculation is necessary.</span></span> <span data-ttu-id="45bad-920">Предполагая, что обе точки в обеих вершинах ребра не равны нулю, vertex1 является вершиной с *отрицательной* точкой dotProduct1а продукта; и VERTEX2 — это вершина с *положительной* точкой dotProduct2.</span><span class="sxs-lookup"><span data-stu-id="45bad-920">Assuming that both dot products of the vertices of the edge are non-zero , vertex1 is the vertex with *negative* dot product dotProduct1; and vertex2 is the vertex with *positive* dot product dotProduct2.</span></span> <span data-ttu-id="45bad-921">Этот порядок важен для того, чтобы вычисляемая точка пересечения не зависела от того, как упорядочение вершин отображается в представлении границы.</span><span class="sxs-lookup"><span data-stu-id="45bad-921">This order is important to ensure that the calculated intersection point does not depend on how the ordering of the vertices appears in the representation of the edge.</span></span> <span data-ttu-id="45bad-922">Геометрическое понятие границы является симметричным по отношению к его вершинам.</span><span class="sxs-lookup"><span data-stu-id="45bad-922">The geometric concept of the edge is symmetrical with respect to its vertices.</span></span> <span data-ttu-id="45bad-923">Вычислительный аспект использования параметрической формулы в пограничных элементах представляет асимметрию (Выбор начальной вершины), что может привести к слегка отличающимся точкам пересечения из-за числового шума и условий линейных уравнений, которые должны быть решены.</span><span class="sxs-lookup"><span data-stu-id="45bad-923">The computational aspect of using parametric equations of the edge introduces asymmetry (choice of starting vertex), which may give a slightly different intersection point due to numeric noise and conditioning of the linear equations to be solved.</span></span> <span data-ttu-id="45bad-924">В этом случае точка пересечения, пересечение, задается следующим образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-924">With this said, the intersection point, intersection,is given by the following.</span></span>

<span data-ttu-id="45bad-925">t = dotProduct1/(dotProduct1-dotProduct2)</span><span class="sxs-lookup"><span data-stu-id="45bad-925">t = dotProduct1/(dotProduct1 - dotProduct2)</span></span>

<span data-ttu-id="45bad-926">крайне. J = vertex1. J + t \* (VERTEX2. J-vertex1. Б</span><span class="sxs-lookup"><span data-stu-id="45bad-926">intersection.J = vertex1.J + t \* (vertex2.J - vertex1.J)</span></span>

<span data-ttu-id="45bad-927">пересечение. a = vertex1. a + t \* (VERTEX2. a-vertex1. a)</span><span class="sxs-lookup"><span data-stu-id="45bad-927">intersection.a = vertex1.a + t \* (vertex2.a - vertex1.a)</span></span>

<span data-ttu-id="45bad-928">пересечение. b = vertex1. b + t \* (VERTEX2. b-vertex1. b)</span><span class="sxs-lookup"><span data-stu-id="45bad-928">intersection.b = vertex1.b + t \* (vertex2.b - vertex1.b)</span></span>

### <a name="gamut-operation-checkgamut-continued"></a><span data-ttu-id="45bad-929">Операция с охватом: Чеккгамут (продолжение)</span><span class="sxs-lookup"><span data-stu-id="45bad-929">Gamut Operation: CheckGamut (continued)</span></span>

<span data-ttu-id="45bad-930">Базовый геометрический алгоритм, используемый для проверки цветовой гаммы, заключается в подсчете числа пересечений лучей.</span><span class="sxs-lookup"><span data-stu-id="45bad-930">The basic geometric algorithm used for gamut checking is to count the number of ray crossings.</span></span> <span data-ttu-id="45bad-931">Для данной точки запроса рассмотрим луч, начинающийся с точки запроса и направленный вверх (направление J-Direction).</span><span class="sxs-lookup"><span data-stu-id="45bad-931">For a given query point, consider a ray starting with the query point and pointing upwards (J-direction).</span></span> <span data-ttu-id="45bad-932">Подсчитайте, сколько раз этот луч пересекает границу цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-932">Count the number of times this ray crosses the gamut boundary.</span></span> <span data-ttu-id="45bad-933">Если это число четное, то точка запроса находится вне области охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-933">If this number is even, then the query point is out-of-gamut.</span></span> <span data-ttu-id="45bad-934">Если это число нечетное, то точка находится внутри.</span><span class="sxs-lookup"><span data-stu-id="45bad-934">If this number is odd, the point is inside.</span></span> <span data-ttu-id="45bad-935">В принципе, этот алгоритм может быть реализован в трехмерном виде, он обычно сталкивались с трудностями, вызванными вырожденными ситуациями, например с лучом (частично) на границе треугольника, или с меньшим измерением деженераци, например лучом (частично) на границе граничного треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-935">In principle, this algorithm can be implemented in 3-D, it is generally plagued by difficulties caused by degenerate situations, such as the ray lying (partly) on a boundary triangle, or lower dimensional degeneracy, such as the ray lying (partly) on an edge of a boundary triangle.</span></span> <span data-ttu-id="45bad-936">Даже в 2-D, вам придется обходиться с использованием таких ситуаций. но эта проблема проще и была устранена удовлетворительным образом.</span><span class="sxs-lookup"><span data-stu-id="45bad-936">Even in 2-D, you have to deal with these degenerate situations; but the problem is simpler and has been addressed in a satisfactory manner.</span></span> <span data-ttu-id="45bad-937">См \[ \] . о'раурке.</span><span class="sxs-lookup"><span data-stu-id="45bad-937">See \[O'Rourke\].</span></span>

<span data-ttu-id="45bad-938">Для заданной входной точки Jab определите его угол оттенок h, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="45bad-938">For a given input point Jab, determine its hue angle h as follows.</span></span>

<span data-ttu-id="45bad-939">h = ATAN (b/a),</span><span class="sxs-lookup"><span data-stu-id="45bad-939">h = atan(b/a),</span></span>

<span data-ttu-id="45bad-940">Инициализируйте плоскость оттенок, а затем определите элементы границ линии, соответствующие этой плоскости оттенков.</span><span class="sxs-lookup"><span data-stu-id="45bad-940">Initialize the hue plane, and then determine the Boundary Line Elements corresponding to this hue plane.</span></span> <span data-ttu-id="45bad-941">Так как элементы линии границ связаны только в том случае, если они пересекаются вверх вверх, настройте фильтр треугольника для удаления треугольников, которые предоставляют элементам линии, которые определенно не пересекаются вверх, вверх.</span><span class="sxs-lookup"><span data-stu-id="45bad-941">Because the Boundary Line Elements are only relevant if they intersect the upward ray, set up a Triangle Filter to remove triangles that give line elements that definitely will not intersect the upward ray.</span></span> <span data-ttu-id="45bad-942">В этом случае рассмотрите ограничивающий прямоугольник треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-942">In this case, consider the bounding box of the triangle.</span></span> <span data-ttu-id="45bad-943">Покрывающий луч не пересекается с треугольником, если точка запроса находится за пределами "теневого" с помощью ограничивающего прямоугольника, если источник освещения был непосредственно выше.</span><span class="sxs-lookup"><span data-stu-id="45bad-943">The upward ray will not intersect the triangle if the query point is outside the "shadow" cast by the bounding box if a light source was directly above.</span></span> <span data-ttu-id="45bad-944">Это немного с предварительно фиксированной допускной подготовкой для цифрового шума, чтобы случайно не создавать треугольники, которые могут дать полезные элементы линии.</span><span class="sxs-lookup"><span data-stu-id="45bad-944">Inflate this slightly with a pre-fixed tolerance to allow for numeric noise so that you don't inadvertently throw away triangles that might give useful line elements.</span></span> <span data-ttu-id="45bad-945">Результатом является прямоугольный цилиндр с частичным бесконечностью, показанный на рис. 29.</span><span class="sxs-lookup"><span data-stu-id="45bad-945">The result is the semi-infinite rectangular cylinder shown in Figure 29.</span></span> <span data-ttu-id="45bad-946">Проверка того, находится ли точка запроса внутри или снаружи этого цилиндра, может быть эффективно реализована с помощью простых неравенства.</span><span class="sxs-lookup"><span data-stu-id="45bad-946">Checking whether the query point is inside or outside this cylinder can be efficiently implemented using simple inequalities.</span></span>

![Показывает фильтр треугольника для Чеккгамут.](images/gmmp-image116.jpg)

<span data-ttu-id="45bad-948">**Рис. 29** . фильтр треугольника для чеккгамут</span><span class="sxs-lookup"><span data-stu-id="45bad-948">**Figure 29** : Triangle Filter for CheckGamut</span></span>

<span data-ttu-id="45bad-949">Чеккгамут имеет три отдельных компонента для операций с охватом: *внутренние обработанные данные*,*обработчик элементов линии* и *выходной адаптер*.</span><span class="sxs-lookup"><span data-stu-id="45bad-949">CheckGamut has three gamut operation specific components: *Internal Processed Data*,*Line Element Processor*, and *Output Adaptor*.</span></span> <span data-ttu-id="45bad-950">*Внутренние обработанные данные* — это список элементов Line, обработанных *обработчиком элементов линии*.</span><span class="sxs-lookup"><span data-stu-id="45bad-950">The *Internal Processed Data* is a list of line elements that have been processed by *Line Element Processor*.</span></span> <span data-ttu-id="45bad-951">В этом случае *обработчик элементов линии* просто добавляет в список элемент Line.</span><span class="sxs-lookup"><span data-stu-id="45bad-951">In this case, the *Line Element Processor* simply adds a line element to the list.</span></span> <span data-ttu-id="45bad-952">Внутренней структурой данных для *внутренних обработанных данных* может быть либо связанный список, либо массив, размер которого может увеличиваться.</span><span class="sxs-lookup"><span data-stu-id="45bad-952">The internal data structure for *Internal Processed Data* can be either a linked list or an array that can grow in size.</span></span>

<span data-ttu-id="45bad-953">*Выходной адаптер* — это модуль, который обращается к списку элементов Line, определяет, пересекаются ли элементы строки вверх вверх (число 1) или нет (число 0).</span><span class="sxs-lookup"><span data-stu-id="45bad-953">The *Output Adaptor* is a module that accesses the list of line elements, determines if a line element crosses the upward ray (count 1) or not (count 0).</span></span> <span data-ttu-id="45bad-954">Суммирование всех этих счетчиков дает общее количество.</span><span class="sxs-lookup"><span data-stu-id="45bad-954">Summing all these counts gives a total count.</span></span> <span data-ttu-id="45bad-955">*Выходной адаптер* в конечном итоге выводит ответ "Да" (в палитре) или "нет" (вне зависимости от того, является ли общий счетчик нечетным или четным).</span><span class="sxs-lookup"><span data-stu-id="45bad-955">The *Output Adaptor* ultimately outputs an answer of "yes" (in-gamut) or "no" (out-of-gamut), depending on whether the total count is odd or even.</span></span> <span data-ttu-id="45bad-956">Шаг, на котором определяется, является ли элемент линии пересечением вверх вверх, заслуживает некоторого внимания, поскольку именно здесь возникает проблема деженераци, а также проблема пересчета.</span><span class="sxs-lookup"><span data-stu-id="45bad-956">The step where you determine if a line element crosses the upward ray deserves some attention because this is where the problem of degeneracy arises and also the problem of over-counting arises.</span></span> <span data-ttu-id="45bad-957">После \[ о'раурке \] для элемента Line, пересекающего луч, правая конечная точка (конечная точка с большим чрома) должна быть строго расположена в правой части луча.</span><span class="sxs-lookup"><span data-stu-id="45bad-957">Following \[O'Rourke\], for a line element to cross the ray, the right end point (the end point with larger chroma) must be strictly on the right side of the ray.</span></span> <span data-ttu-id="45bad-958">Это гарантирует, что, если конечная точка когда-либо полагается на луч, она будет считаться только один раз.</span><span class="sxs-lookup"><span data-stu-id="45bad-958">This guarantees that, if an end point ever lies exactly on the ray, it is only counted one time.</span></span> <span data-ttu-id="45bad-959">Это же правило позволяет устранить ситуацию, когда элемент Line находится в точности на луч.</span><span class="sxs-lookup"><span data-stu-id="45bad-959">The same rule also solves the degenerate situation where the line element lies exactly on the ray.</span></span> <span data-ttu-id="45bad-960">Значение счетчика для этого элемента строки не увеличивается.</span><span class="sxs-lookup"><span data-stu-id="45bad-960">You do not increment the count for this line element.</span></span>

<span data-ttu-id="45bad-961">На рис. 30 показаны результирующие элементы строки образца охвата с точкой запроса в различных позициях.</span><span class="sxs-lookup"><span data-stu-id="45bad-961">Figure 30 shows the resulting line elements of a sample gamut with the query point in various positions.</span></span>

![Схема, показывающая результирующие элементы в примере цветового охвата с точкой запроса в различных позициях.](images/gmmp-image118.jpg)

<span data-ttu-id="45bad-963">**Рис. 30** . принцип работы чеккгамут</span><span class="sxs-lookup"><span data-stu-id="45bad-963">**Figure 30** : How CheckGamut works</span></span>

### <a name="minimum-color-difference-gamut-mapping"></a><span data-ttu-id="45bad-964">Сопоставление палитры минимальных цветовых различий</span><span class="sxs-lookup"><span data-stu-id="45bad-964">Minimum Color Difference Gamut Mapping</span></span>

<span data-ttu-id="45bad-965">Минимальное соответствие цветовой гаммы в сопоставлении палитры Миндемап имеет простую спецификацию: Если цвет находится в-охвате, ничего делать не нужно.</span><span class="sxs-lookup"><span data-stu-id="45bad-965">The Minimum Color Difference Gamut Mapping, MinDEMap, has a simple specification: If a color is in-gamut, do nothing.</span></span> <span data-ttu-id="45bad-966">Если цвет выходит за пределы цветового охвата, выведите его в "ближайшую" точку на границе цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-966">If a color is out-of-gamut, project it to the "nearest" point on the gamut boundary.</span></span> <span data-ttu-id="45bad-967">Ключевое слово "ближайшего" не определено четко, пока вы не укажете, какое уравнение различия цветов будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="45bad-967">The keyword "nearest" is not well-defined until you specify which color difference equation to use.</span></span> <span data-ttu-id="45bad-968">На практике, чтобы упростить и ускорить вычисления, евклидово расстояние выбранного пространства отображения цвета или его разновидность используется в качестве метрики цветовой разницы.</span><span class="sxs-lookup"><span data-stu-id="45bad-968">In practice, to make computation easier and faster, the Euclidean distance of the chosen color appearance space, or a variant of it, is used as the color difference metric.</span></span> <span data-ttu-id="45bad-969">Преимуществом метрики евклидово является то, что он совместим с точкой произведения пространства, что позволяет использовать линейную перерезку.</span><span class="sxs-lookup"><span data-stu-id="45bad-969">The advantage of the Euclidean metric is that it is compatible with the dot product of the space, which makes it possible to use linear algebra.</span></span> <span data-ttu-id="45bad-970">В частности, если в пространстве определено ««марка», то расстояние может быть определено как квадратный корень от скалярного произведения вектора разницы с самим собой.</span><span class="sxs-lookup"><span data-stu-id="45bad-970">In detail, if a "dot product" is defined in the space, then a distance can be defined as the square root of the dot product of the difference vector with itself.</span></span> <span data-ttu-id="45bad-971">Как правило, в качестве точки может быть определена положительная матрица 3x3 A.</span><span class="sxs-lookup"><span data-stu-id="45bad-971">A dot product can generally be defined by a positive definite 3x3 matrix A.</span></span>

<span data-ttu-id="45bad-972">u? v = u <sub>T</sub> AV</span><span class="sxs-lookup"><span data-stu-id="45bad-972">u?v = u <sub>T</sub> Av</span></span>

<span data-ttu-id="45bad-973">где правая часть — это обычное умножение матрицы.</span><span class="sxs-lookup"><span data-stu-id="45bad-973">where the right hand side is the usual matrix multiplication.</span></span> <span data-ttu-id="45bad-974">Если A является матрицей идентификаторов, то восстанавливается стандартная точка.</span><span class="sxs-lookup"><span data-stu-id="45bad-974">If A is the identity matrix, the standard dot product is recovered.</span></span> <span data-ttu-id="45bad-975">На практике, если Jab является цветовым пространством, вы не хотите смешивать компоненты, поэтому можно использовать диагональную матрицу, отличную от матрицы идентификации.</span><span class="sxs-lookup"><span data-stu-id="45bad-975">In practice, if Jab is the color space, you do not want to mix up the components, so a diagonal matrix other than the identity matrix can be used.</span></span> <span data-ttu-id="45bad-976">Кроме того, может потребоваться сохранить масштаб на и b без изменений, чтобы была сохранена мера оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-976">In addition, you might want to keep the scale on a and b unchanged so that the measure of hue is preserved.</span></span> <span data-ttu-id="45bad-977">Поэтому полезным вариантом стандартного продукта евклидово Dot является следующее.</span><span class="sxs-lookup"><span data-stu-id="45bad-977">So a useful variation of the standard Euclidean dot product is the following.</span></span>

<span data-ttu-id="45bad-978">w <sub>j</sub> (j-мой компонент) (j component of v) + (компонент для вас) (компонент v) + (b компонента v)</span><span class="sxs-lookup"><span data-stu-id="45bad-978">w <sub>J</sub> (J component of u)(J component of v) + (a component of u)(a component of v) + (b component of u)(b component of v)</span></span>

<span data-ttu-id="45bad-979">где w <sub>J</sub> — положительное число.</span><span class="sxs-lookup"><span data-stu-id="45bad-979">where w <sub>J</sub> is a positive number.</span></span> <span data-ttu-id="45bad-980">Еще один вариант — Разрешить w <sub>J</sub> зависеть от входной точки запроса:</span><span class="sxs-lookup"><span data-stu-id="45bad-980">One further variation is to let w <sub>J</sub> vary with the input query point:</span></span>

<span data-ttu-id="45bad-981">w <sub>j \ =</sub> w <sub>j</sub> (куерипоинт)</span><span class="sxs-lookup"><span data-stu-id="45bad-981">w <sub>J\ =</sub> w <sub>J</sub> (queryPoint)</span></span>

<span data-ttu-id="45bad-982">Конечный результат представляет собой меру расстояния, которое асимметрично по отношению к двум точкам, с различными относительными весовыми коэффициентами освещения, чрома или оттенками, когда точка входного запроса изменяется.</span><span class="sxs-lookup"><span data-stu-id="45bad-982">The end result is a measure of distance that is asymmetric with respect to the two points, and with different relative weights on lightness and chroma or hue as the input query point varies.</span></span> <span data-ttu-id="45bad-983">Это в соответствии с некоторыми наблюдениями, связанными с человеческими цветами, в которых различия цветов не имеют одинаковых весов во всех измерениях.</span><span class="sxs-lookup"><span data-stu-id="45bad-983">This is in accordance with some observations about human color perception that color differences are not weighted equally in all dimensions.</span></span> <span data-ttu-id="45bad-984">Было обнаружено, что люди менее чувствительны к различиям в освещенности, чем различия в оттенокх и чрома.</span><span class="sxs-lookup"><span data-stu-id="45bad-984">It has been found that people are less sensitive to differences in lightness than they are to differences in hue and chroma.</span></span>

<span data-ttu-id="45bad-985">Следующая функция веса полезна.</span><span class="sxs-lookup"><span data-stu-id="45bad-985">The following weight function is useful.</span></span>

<span data-ttu-id="45bad-986">w <sub>J</sub> = k ₂-k ₁ (C-C m ₐ ₓ) n</span><span class="sxs-lookup"><span data-stu-id="45bad-986">w <sub>J</sub> = k ₂ - k ₁ (C - C ₘₐₓ ) ₙ</span></span>

<span data-ttu-id="45bad-987">где k ₂ = 1, k ₁ = 0,75/(C m ₐ ₓ) n, C m ₐ ₓ = 100, n = 2 и C — это меньшее из чрома в точке запроса и C m ₐ ₓ.</span><span class="sxs-lookup"><span data-stu-id="45bad-987">where k ₂ = 1, k ₁ = 0.75/(C ₘₐₓ ) ₙ, C ₘₐₓ = 100, n = 2 and C is the smaller of chroma of the query point and C ₘₐₓ.</span></span>

<span data-ttu-id="45bad-988">так что вес 0,25 помещается в термине J, когда чрома равен нулю, и вес 1, если чрома — 100.</span><span class="sxs-lookup"><span data-stu-id="45bad-988">so that a weight of 0.25 is put on the J term when chroma is zero, and a weight of 1 when chroma is 100.</span></span> <span data-ttu-id="45bad-989">Тенденция размещения меньшего веса в J, когда чрома невелика, и более вес на J, если чрома является большим, соответствует рекомендуемому использованию для CMC и CIEDE2000.</span><span class="sxs-lookup"><span data-stu-id="45bad-989">The trend of putting less weight on J when chroma is small, and more weight on J when chroma is large follows the recommended usage for CMC and CIEDE2000.</span></span>

![Граф, демонстрирующий функцию веса для компонента J метрики.](images/gmmp-image119.png)

<span data-ttu-id="45bad-991">**Рис. 31** . функция Weight для компонента J метрики</span><span class="sxs-lookup"><span data-stu-id="45bad-991">**Figure 31** : The weight function on the J component of the metric</span></span>

<span data-ttu-id="45bad-992">Используйте Jab пространство в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="45bad-992">Use Jab space for the following example.</span></span> <span data-ttu-id="45bad-993">Для определения ближайшей точки в метрике евклидово требуется поиск по всем граничным треугольникам.</span><span class="sxs-lookup"><span data-stu-id="45bad-993">It is computationally demanding to search through all the boundary triangles to determine the closest point in the Euclidean metric.</span></span> <span data-ttu-id="45bad-994">Ниже приведен простой подход к максимально эффективному использованию этого процесса без введения дополнительных предположений, которые могут ускорить процесс, но также можно получить лишь приблизительный ответ.</span><span class="sxs-lookup"><span data-stu-id="45bad-994">The following is a simple approach to make this process as efficient as possible, without introducing additional assumptions that may speed up the process but also end up in only an approximate answer.</span></span> <span data-ttu-id="45bad-995">Во-первых, необходимо понимать геометрическую процедуру проецирования точки на заданный треугольник.</span><span class="sxs-lookup"><span data-stu-id="45bad-995">First, it is necessary to understand the geometric procedure of projecting a point onto the given triangle.</span></span> <span data-ttu-id="45bad-996">Здесь дается описание.</span><span class="sxs-lookup"><span data-stu-id="45bad-996">A description is given here.</span></span>

<span data-ttu-id="45bad-997">Сначала выполняется ортогональная проекция на бесконечную плоскость, содержащую треугольник.</span><span class="sxs-lookup"><span data-stu-id="45bad-997">An orthogonal projection onto the infinite plane containing the triangle is first performed.</span></span> <span data-ttu-id="45bad-998">Кратчайшее расстояние точки запроса от плоскости можно определить в двух шагах.</span><span class="sxs-lookup"><span data-stu-id="45bad-998">The shortest distance of the query point from the plane can be determined in two steps.</span></span>

<span data-ttu-id="45bad-999">**(a)** вычисление вектора обычной единицы к треугольнику.</span><span class="sxs-lookup"><span data-stu-id="45bad-999">**(a)** Calculate the unit normal vector to the triangle.</span></span>

<span data-ttu-id="45bad-1000">**(б)** Рассчитайте скалярное произведение вектора базовой единицы и вектор, сформированный из точки запроса, и точку на треугольнике; то есть один из его вершин.</span><span class="sxs-lookup"><span data-stu-id="45bad-1000">**(b)** Calculate the dot product of the unit normal vector and a vector formed from the query point and a point on the triangle; that is, one of its vertices.</span></span> <span data-ttu-id="45bad-1001">Так как у обычного вектора есть длина единицы, абсолютное значение этого произведения точки — это расстояние точки запроса от плоскости.</span><span class="sxs-lookup"><span data-stu-id="45bad-1001">Because the normal vector has unit length, the absolute value of this dot product is the distance of the query point from the plane.</span></span>

<span data-ttu-id="45bad-1002">Предполагаемая точка может не быть ответом, так как она может находиться за пределами треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-1002">The projected point might not be the answer, because it might lie outside the triangle.</span></span> <span data-ttu-id="45bad-1003">Поэтому сначала необходимо выполнить проверку.</span><span class="sxs-lookup"><span data-stu-id="45bad-1003">So, you must perform a check first.</span></span> <span data-ttu-id="45bad-1004">Вычисление эквивалентно вычислению координат барицентрик в проектируемой точке относительно треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-1004">The calculation is equivalent to calculating the barycentric coordinates of the projected point relative to the triangle.</span></span> <span data-ttu-id="45bad-1005">Если предполагаемая точка определена в пределах треугольника, это ответ.</span><span class="sxs-lookup"><span data-stu-id="45bad-1005">If the projected point is determined to be inside the triangle, it is the answer.</span></span> <span data-ttu-id="45bad-1006">Если нет, то ближайшая точка запрашивается на одном из краев треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-1006">If not, the closest point is acquired on one of the edges of the triangle.</span></span> <span data-ttu-id="45bad-1007">Выполните поиск по каждому из трех краев.</span><span class="sxs-lookup"><span data-stu-id="45bad-1007">Perform a search on each of the three edges.</span></span> <span data-ttu-id="45bad-1008">Определение проекции точки запроса на границе — это процесс, схожий с проекцией на треугольник, но с одним измерением меньше.</span><span class="sxs-lookup"><span data-stu-id="45bad-1008">Determining the projection of the query point onto an edge is a process similar to projection onto the triangle, but one dimension less.</span></span> <span data-ttu-id="45bad-1009">Сначала вычисляется ортогональная проекция.</span><span class="sxs-lookup"><span data-stu-id="45bad-1009">An orthogonal projection is first calculated.</span></span> <span data-ttu-id="45bad-1010">Если предполагаемая точка находится на границе, это ответ.</span><span class="sxs-lookup"><span data-stu-id="45bad-1010">If the projected point lies on the edge, it is the answer.</span></span> <span data-ttu-id="45bad-1011">Если нет, то ближайшая точка запрашивается в одной из двух конечных точек.</span><span class="sxs-lookup"><span data-stu-id="45bad-1011">If not, the closest point is acquired on one of the two end points.</span></span> <span data-ttu-id="45bad-1012">Выполните поиск по двум конечным точкам; то есть Вычислите расстояние от точки запроса до каждого из них и сравните, какой из них меньше.</span><span class="sxs-lookup"><span data-stu-id="45bad-1012">Perform a search on the two end points; that is, calculate the distance of query point from each one, and compare which one is smaller.</span></span>

<span data-ttu-id="45bad-1013">Тщательный анализ показывает, что при прокрутке всех треугольников существует много повторяющихся результатов поиска, так как край всегда совместно используется двумя треугольниками, а вершина — по крайней мере на трех краях.</span><span class="sxs-lookup"><span data-stu-id="45bad-1013">Careful examination reveals that there is a lot of repeated searching when you go through all the triangles because an edge is always shared by two triangles, and a vertex shared by at least three edges.</span></span> <span data-ttu-id="45bad-1014">Кроме того, вы не заинтересованы в поиске ближайших точек до одного конкретного треугольника. Вместо этого вы заинтересованы в поиске ближайшей точки для всей границы палитры.</span><span class="sxs-lookup"><span data-stu-id="45bad-1014">In addition, you are not much interested in finding the closest point to one particular triangle; instead you are interested in finding the closest point to the whole gamut boundary.</span></span> <span data-ttu-id="45bad-1015">Однако одним из таких треугольников является тот, в котором это достигается.</span><span class="sxs-lookup"><span data-stu-id="45bad-1015">However,one particular triangle would be the one in which this is achieved.</span></span> <span data-ttu-id="45bad-1016">Существует две стратегии, которые можно использовать для ускорения поиска.</span><span class="sxs-lookup"><span data-stu-id="45bad-1016">There are two strategies that you can use to speed up the search.</span></span>

<span data-ttu-id="45bad-1017">**Стратегия I**. Каждая вершина будет обрабатываться не чаще одного раза.</span><span class="sxs-lookup"><span data-stu-id="45bad-1017">**Strategy I**. Each vertex will be processed, at most, once.</span></span> <span data-ttu-id="45bad-1018">Каждый ребр будет обрабатываться не чаще одного раза.</span><span class="sxs-lookup"><span data-stu-id="45bad-1018">Each edge will be processed, at most, once.</span></span>

<span data-ttu-id="45bad-1019">**Стратегия II**.</span><span class="sxs-lookup"><span data-stu-id="45bad-1019">**Strategy II**.</span></span> <span data-ttu-id="45bad-1020">В любой точке поиска вы получите лучший кандидат с соответствующим лучшим расстоянием.</span><span class="sxs-lookup"><span data-stu-id="45bad-1020">At any point in the search, you have a best candidate with the corresponding best distance.</span></span> <span data-ttu-id="45bad-1021">Если вы можете определить, по быстрой проверке, что треугольник не способен добиться лучшего расстояния, больше не нужно продолжать вычисление.</span><span class="sxs-lookup"><span data-stu-id="45bad-1021">If you can determine, by a quick check, that a triangle is not capable of giving a better distance, there is no need to continue the calculation further.</span></span> <span data-ttu-id="45bad-1022">Для этого треугольника не требуется ближайшая точка и расстояние.</span><span class="sxs-lookup"><span data-stu-id="45bad-1022">You do not need the closest point and distance for this triangle.</span></span>

![Схема, показывающая последовательность минимального сопоставления.](images/gmmp-image120.png)

<span data-ttu-id="45bad-1024">**Рис. 32** . минимальное число сопоставлений схем</span><span class="sxs-lookup"><span data-stu-id="45bad-1024">**Figure 32** : Minimum DE Mapping schematics</span></span>

<span data-ttu-id="45bad-1025">На рисунке 32 показан общий поток логики для Миндемапа карт цветов.</span><span class="sxs-lookup"><span data-stu-id="45bad-1025">Figure 32 shows the general flow of logic for the gamut map MinDEMap.</span></span> <span data-ttu-id="45bad-1026">Для точки запроса сначала вызывается функция Чеккгамут.</span><span class="sxs-lookup"><span data-stu-id="45bad-1026">For a query point, the CheckGamut function is first invoked.</span></span> <span data-ttu-id="45bad-1027">Если точка находится в цветном охвате, то Map является оператором No-Op.</span><span class="sxs-lookup"><span data-stu-id="45bad-1027">If the point is in-gamut, the map is a no-op.</span></span> <span data-ttu-id="45bad-1028">Если точка находится вне области охвата, вызовите Прожектпоинттобаундари.</span><span class="sxs-lookup"><span data-stu-id="45bad-1028">If the point is out-of-gamut, call ProjectPointToBoundary.</span></span> <span data-ttu-id="45bad-1029">Теперь перейдите на рис. 33.</span><span class="sxs-lookup"><span data-stu-id="45bad-1029">Now move on to Figure 33.</span></span> <span data-ttu-id="45bad-1030">На этом этапе предполагается, что были вычислены следующие значения.</span><span class="sxs-lookup"><span data-stu-id="45bad-1030">At this point, it is assumed that the following values have been computed.</span></span>

<span data-ttu-id="45bad-1031">**(a)** вектор базовой единицы для каждого треугольника границы цветовой гаммы по отношению к стандартному продукту с точкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-1031">**(a)** Unit normal vector to each Gamut Boundary Triangle with respect to the standard dot product.</span></span>

<span data-ttu-id="45bad-1032">**(б)** список вершин и список кромок в дополнение к списку треугольников.</span><span class="sxs-lookup"><span data-stu-id="45bad-1032">**(b)** Vertex list and edge list, in addition to the triangle list.</span></span>

![Схема, показывающая подпрограммы «Прожектпоинттобаундари».](images/gmmp-image122.jpg)

<span data-ttu-id="45bad-1034">**Рис. 33** . подпрограммы прожектпоинттобаундари</span><span class="sxs-lookup"><span data-stu-id="45bad-1034">**Figure 33** : The ProjectPointToBoundary routine</span></span>

<span data-ttu-id="45bad-1035">Все это является постоянной нагрузкой и снижение затрат при наличии достаточного количества запросов к этой границе.</span><span class="sxs-lookup"><span data-stu-id="45bad-1035">All these are constant overhead, and would have diminishing cost if sufficient queries to this gamut boundary are made.</span></span> <span data-ttu-id="45bad-1036">Как правило, это происходит при создании преобразования LUT с одного устройства на другое, где имеется только два фиксированных цветовых охвата, а преобразование LUT выполняется через точки в сетке с одинаковой выборкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-1036">Usually, this is the case when you build a transform LUT from one device to another, where there are only two fixed gamuts, and the transform LUT runs through points on the uniformly sampled grid.</span></span> <span data-ttu-id="45bad-1037">Вы заранее Вычислите обычные векторы по отношению к стандартному продукту с точкой, даже если понятие перпендикулярности будет основано на продукте с взвешенной точкой, который зависит от точки запроса, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="45bad-1037">You pre-compute the normal vectors with respect to the standard dot product, even though the notion of perpendicularity will be based on the weighted dot product, which depends on the query point as explained previously.</span></span> <span data-ttu-id="45bad-1038">Причина заключается в том, что обычный вектор по отношению к продукту с взвешенной точкой можно легко получить из обычного вектора относительно стандартного продукта с точкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-1038">The reason is because a normal vector with respect to the weighted dot product can be obtained easily from the normal vector with respect to the standard dot product.</span></span> <span data-ttu-id="45bad-1039">Если n ₀ является нормальным вектором по отношению к стандартному продукту с точкой, то</span><span class="sxs-lookup"><span data-stu-id="45bad-1039">If n ₀ is a normal vector with respect to the standard dot product, then</span></span>

<span data-ttu-id="45bad-1040">n = (J-компонент n ₀/w <sub>J</sub>, a – компонент n ₀, b-компонент n ₀)</span><span class="sxs-lookup"><span data-stu-id="45bad-1040">n = (J-component of n ₀ /w <sub>J</sub>, a-component of n ₀, b-component of n ₀ )</span></span>

<span data-ttu-id="45bad-1041">является нормальным для треугольника по отношению к продукту с взвешенной точкой.</span><span class="sxs-lookup"><span data-stu-id="45bad-1041">is normal to the triangle with respect to the weighted dot product.</span></span> <span data-ttu-id="45bad-1042">Из-за этой связи все равно полезно предварительно вычислить n ₀, хотя он должен быть скорректирован на основе точки запроса.</span><span class="sxs-lookup"><span data-stu-id="45bad-1042">Because of this relationship, it is still beneficial to pre-compute n ₀ even though it must be adjusted based on the query point.</span></span>

<span data-ttu-id="45bad-1043">Подпрограммы Прожектпоинттобаундари начинаются с сброса "обработанного журнала" вершин и ребер.</span><span class="sxs-lookup"><span data-stu-id="45bad-1043">The ProjectPointToBoundary routine starts by resetting the "processed history" of the vertices and edges.</span></span> <span data-ttu-id="45bad-1044">Это таблицы ЛОГИЧЕСКИХ флагов, которые определяют, была ли посещена вершина или ребро.</span><span class="sxs-lookup"><span data-stu-id="45bad-1044">These are tables of BOOLEAN flags that track whether a vertex or edge has been visited before.</span></span> <span data-ttu-id="45bad-1045">Он также сбрасывает переменную Шортестдистанце в значение "Infinity", которое является максимальным закодированным значением в используемой системе счисления с плавающей запятой.</span><span class="sxs-lookup"><span data-stu-id="45bad-1045">It also resets the variable ShortestDistance to "INFINITY," which is the maximum encoded value in the floating-point number system used.</span></span> <span data-ttu-id="45bad-1046">Затем он выполняется с помощью цикла, который ищет ближайшую точку каждого треугольника с помощью вызова Процесстриангле.</span><span class="sxs-lookup"><span data-stu-id="45bad-1046">Then it runs through a loop, searching for the closest point from each triangle using the ProcessTriangle call.</span></span> <span data-ttu-id="45bad-1047">Процесстриангле является подпрограммы для обновления переменной Шортестдистанце и явно находится в критическом цикле.</span><span class="sxs-lookup"><span data-stu-id="45bad-1047">ProcessTriangle is the routine to update the ShortestDistance variable and is clearly in the critical loop.</span></span> <span data-ttu-id="45bad-1048">Одна из оптимизаций — завершение, если результат достаточно хорош.</span><span class="sxs-lookup"><span data-stu-id="45bad-1048">One optimization is to stop when the result is good enough.</span></span> <span data-ttu-id="45bad-1049">После каждого вызова Процесстриангле проверяется переменная Шортестдистанце.</span><span class="sxs-lookup"><span data-stu-id="45bad-1049">After each call to ProcessTriangle, the variable ShortestDistance is examined.</span></span> <span data-ttu-id="45bad-1050">Если он соответствует предопределенному пороговому значению, его можно отключить.</span><span class="sxs-lookup"><span data-stu-id="45bad-1050">If it satisfies a predefined threshold, you can stop.</span></span> <span data-ttu-id="45bad-1051">Предопределенное пороговое значение зависит от используемого цветового пространства и от необходимой точности системы создания образов цветов.</span><span class="sxs-lookup"><span data-stu-id="45bad-1051">The predefined threshold is dependent on the color space used and on the required accuracy of the color imaging system.</span></span> <span data-ttu-id="45bad-1052">Для типичного приложения не нужно выполнять ненужную работу, если цветовая разница меньше, чем может быть определено человеческим зрением.</span><span class="sxs-lookup"><span data-stu-id="45bad-1052">For a typical application, you do not want to do unnecessary work if the color difference is less than what can be discerned by human vision.</span></span> <span data-ttu-id="45bad-1053">Для CIECAM02 это цветовое отличие равно 1.</span><span class="sxs-lookup"><span data-stu-id="45bad-1053">For CIECAM02, this color difference is 1.</span></span> <span data-ttu-id="45bad-1054">Однако используйте пороговое значение 0,005 в реализации, чтобы сохранить точность вычислений, так как это может быть только промежуточный шаг в цепочке преобразований.</span><span class="sxs-lookup"><span data-stu-id="45bad-1054">Use a threshold value of 0.005 in the implementation, however, to preserve the precision of computations, because this might be only an intermediate step in a chain of transforms.</span></span>

<span data-ttu-id="45bad-1055">Процесстриангле реализует предыдущую стратегию II.</span><span class="sxs-lookup"><span data-stu-id="45bad-1055">ProcessTriangle implements the preceding Strategy II.</span></span> <span data-ttu-id="45bad-1056">Получение обычного вектора от вектора обычной предварительно вычисленного блока к треугольнику по отношению к стандартному продукту с точкой, он рассчитывает расстояние от точки запроса до бесконечной плоскости, содержащей треугольник, путем формирования точки произведения вектора нормали единицы и Куеривектор, вектора от одной из вершин треугольника, vertex1 к точке запроса. , Куерипоинт.</span><span class="sxs-lookup"><span data-stu-id="45bad-1056">Obtaining a normal vector from the pre-computed unit normal vector to the triangle with respect to the standard dot product, it computes the distance of the query point to the infinite plane containing the triangle by forming the dot product of the unit normal vector and the queryVector, the vector from one of the vertices of the triangle, vertex1, to the query point, queryPoint.</span></span>

<span data-ttu-id="45bad-1057">Куеривектор = Куерипоинт — vertex1</span><span class="sxs-lookup"><span data-stu-id="45bad-1057">queryVector = queryPoint - vertex1</span></span>

<span data-ttu-id="45bad-1058">Distance = \| нормалвектор \* куеривектор \| / \| \| нормалвектор\|\|</span><span class="sxs-lookup"><span data-stu-id="45bad-1058">distance = \| normalVector \* queryVector \|/\|\|normalVector\|\|</span></span>

<span data-ttu-id="45bad-1059">Это относительно недорогое вычисление, и расстояние требуется для выполнения дальнейших вычислений.</span><span class="sxs-lookup"><span data-stu-id="45bad-1059">This is a relatively inexpensive calculation, and the distance is required to carry out further calculations.</span></span> <span data-ttu-id="45bad-1060">Если это расстояние не меньше текущего наилучшего расстояния, Шортестдистанце, этот треугольник не даст лучшего расстояния, так как он не будет больше расстояния, чем плоскость, содержащая ее.</span><span class="sxs-lookup"><span data-stu-id="45bad-1060">If this distance is not less than the current best distance, ShortestDistance, this triangle will not produce a better distance, because it will not give a better distance than the plane containing it.</span></span> <span data-ttu-id="45bad-1061">В этом случае вы возвращаете управление в цикле треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-1061">In this case, you return control to the triangle loop.</span></span> <span data-ttu-id="45bad-1062">Если расстояние меньше Шортестдистанце, возможно, у вас есть более близкая точка, если эта точка находится внутри треугольника.</span><span class="sxs-lookup"><span data-stu-id="45bad-1062">If the distance is smaller than ShortestDistance, potentially, you have a closer point, if this point lies inside the triangle.</span></span> <span data-ttu-id="45bad-1063">Чтобы определить это, необходимо выполнить некоторые "сложные" вычисления (но не все линейные).</span><span class="sxs-lookup"><span data-stu-id="45bad-1063">You must perform some "hard" calculations (though nothing beyond linear algebra) to determine that.</span></span> <span data-ttu-id="45bad-1064">Если две другие вершины треугольника являются VERTEX2 и vertex3, то формируют основные векторы Фирстбасисвектор и Секондбасисвектор.</span><span class="sxs-lookup"><span data-stu-id="45bad-1064">If the other two vertices of the triangle are vertex2 and vertex3, then form the basis vectors firstBasisVector and secondBasisVector.</span></span>

<span data-ttu-id="45bad-1065">Фирстбасисвектор = VERTEX2 — vertex1</span><span class="sxs-lookup"><span data-stu-id="45bad-1065">firstBasisVector = vertex2 - vertex1</span></span>

<span data-ttu-id="45bad-1066">Секондбасисвектор = vertex3 — vertex1</span><span class="sxs-lookup"><span data-stu-id="45bad-1066">secondBasisVector = vertex3 - vertex1</span></span>

<span data-ttu-id="45bad-1067">Используйте следующую линейную систему уравнений для решения неизвестных задач и v.</span><span class="sxs-lookup"><span data-stu-id="45bad-1067">Use the following linear system of equations to solve for unknowns u and v.</span></span>

<span data-ttu-id="45bad-1068">Фирстбасисвектор \* куеривектор = (фирстбасисвектор \* фирстбасисвектор) u + (фирстбасисвектор \* secondBasisVector) v</span><span class="sxs-lookup"><span data-stu-id="45bad-1068">firstBasisVector \* queryVector = (firstBasisVector \* firstBasisVector)u + (firstBasisVector \* secondBasisVector)v</span></span>

<span data-ttu-id="45bad-1069">Секондбасисвектор \* куеривектор = (секондбасисвектор \* фирстбасисвектор) u + (секондбасисвектор \* secondBasisVector) v</span><span class="sxs-lookup"><span data-stu-id="45bad-1069">secondBasisVector \* queryVector = (secondBasisVector \* firstBasisVector)u + (secondBasisVector \* secondBasisVector)v</span></span>

<span data-ttu-id="45bad-1070">а условия для проецированной точки должны находиться внутри треугольника:</span><span class="sxs-lookup"><span data-stu-id="45bad-1070">and the conditions for the projected point to lie inside the triangle are:</span></span>

<span data-ttu-id="45bad-1071">0 ≤ u ≤ 1, 0 ≤ v ≤ 1 и + v ≤ 1</span><span class="sxs-lookup"><span data-stu-id="45bad-1071">0 ≤ u ≤ 1, 0 ≤ v ≤ 1 and u + v ≤ 1</span></span>

<span data-ttu-id="45bad-1072">Если после этого вычисления определяется, что предполагаемая точка находится внутри треугольника, значит, обнаружена новая ближайшая точка; расстояние, вычисленное в начале, является новым кратчайшим расстоянием.</span><span class="sxs-lookup"><span data-stu-id="45bad-1072">After this calculation, if it is determined that the projected point lies within the triangle, then you have found a new closest point; the distance that you calculated at the beginning is the new shortest distance.</span></span> <span data-ttu-id="45bad-1073">В этом случае обновите переменные Шортестдистанце и Клосестпоинт.</span><span class="sxs-lookup"><span data-stu-id="45bad-1073">In this case, update the variables ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="45bad-1074">Если предполагаемая точка находится за пределами треугольника, вы можете найти более близкую точку на одном из ее краев.</span><span class="sxs-lookup"><span data-stu-id="45bad-1074">If the projected point lies outside the triangle, you might find a closer point on one of its edges.</span></span> <span data-ttu-id="45bad-1075">Таким образом, можно вызвать подпрограммы Процесседже для каждого из трех краев.</span><span class="sxs-lookup"><span data-stu-id="45bad-1075">So, you can call the ProcessEdge routine on each of the three edges.</span></span>

![Схема, показывающая поток подпрограмм Процесседже и Процессвертекс.](images/gmmp-image124.jpg)

<span data-ttu-id="45bad-1077">**Рис. 34** . подпрограммы Процесседже и процессвертекс</span><span class="sxs-lookup"><span data-stu-id="45bad-1077">**Figure 34** : ProcessEdge and ProcessVertex routines</span></span>

<span data-ttu-id="45bad-1078">Подпрограммы Процесседже реализуют стратегию I, которая проиллюстрирована на рис. 34.</span><span class="sxs-lookup"><span data-stu-id="45bad-1078">The ProcessEdge routine implements Strategy I, which is illustrated in Figure 34.</span></span> <span data-ttu-id="45bad-1079">Процесседже начинает с проверки того, был ли обработано ребро.</span><span class="sxs-lookup"><span data-stu-id="45bad-1079">ProcessEdge starts by checking whether the edge has been processed before.</span></span> <span data-ttu-id="45bad-1080">Если это так, дальнейшие действия не предпринимаются.</span><span class="sxs-lookup"><span data-stu-id="45bad-1080">If so, no further action is taken.</span></span> <span data-ttu-id="45bad-1081">В противном случае он продолжает вычислять ортогональную проекцию точки запроса на бесконечную линию, содержащую ребро.</span><span class="sxs-lookup"><span data-stu-id="45bad-1081">If not, it proceeds to calculate the orthogonal projection of the query point onto the infinite line containing the edge.</span></span> <span data-ttu-id="45bad-1082">Линейная переработка, участвующая в вычислении, аналогична предыдущей формуле треугольников.</span><span class="sxs-lookup"><span data-stu-id="45bad-1082">The linear algebra involved in the calculation is similar to the previous triangle equations.</span></span> <span data-ttu-id="45bad-1083">Однако вычисление проще, но не описывается здесь.</span><span class="sxs-lookup"><span data-stu-id="45bad-1083">However, the calculation is simpler, it is not described here.</span></span> <span data-ttu-id="45bad-1084">Если предполагаемая точка находится внутри границы, вы увидите расстояние от предполагаемой точки до точки запроса.</span><span class="sxs-lookup"><span data-stu-id="45bad-1084">If the projected point lies within the edge, you find the distance of the projected point from the query point.</span></span> <span data-ttu-id="45bad-1085">Если это расстояние меньше Шортестдистанце, вы нашли новую ближайшую точку.</span><span class="sxs-lookup"><span data-stu-id="45bad-1085">If this distance is smaller than ShortestDistance, you have found a new closest point.</span></span> <span data-ttu-id="45bad-1086">Обновите Шортестдистанце и Клосестпоинт.</span><span class="sxs-lookup"><span data-stu-id="45bad-1086">Update both ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="45bad-1087">Если предполагаемая точка находится за пределами границы, вызовите Процессвертекс в двух конечных точках.</span><span class="sxs-lookup"><span data-stu-id="45bad-1087">If the projected point lies outside the edge, call ProcessVertex on the two end points.</span></span> <span data-ttu-id="45bad-1088">Перед возвратом управления Обновите журнал пограничных элементов таким образом, чтобы он был помечен как ОБРАБОТАНный.</span><span class="sxs-lookup"><span data-stu-id="45bad-1088">Before returning control, update the edge history so that this edge is marked as "PROCESSED."</span></span>

<span data-ttu-id="45bad-1089">Наконец, вы получите описание Процессвертекс.</span><span class="sxs-lookup"><span data-stu-id="45bad-1089">Finally, you give a description of ProcessVertex.</span></span> <span data-ttu-id="45bad-1090">Подпрограммы Прожектвертекс также реализуют стратегию I и поддерживает таблицу журнала вершин.</span><span class="sxs-lookup"><span data-stu-id="45bad-1090">The ProjectVertex routine also implements Strategy I and maintains a vertex history table.</span></span> <span data-ttu-id="45bad-1091">Как показано на рисунке 34, сначала он проверяет, была ли ранее обработана вершина.</span><span class="sxs-lookup"><span data-stu-id="45bad-1091">As illustrated in Figure 34, it first checks whether the vertex has been processed before.</span></span> <span data-ttu-id="45bad-1092">Если это так, дальнейшие действия не предпринимаются.</span><span class="sxs-lookup"><span data-stu-id="45bad-1092">If so, no further action is taken.</span></span> <span data-ttu-id="45bad-1093">В противном случае он продолжает вычислять расстояние от вершины до точки запроса.</span><span class="sxs-lookup"><span data-stu-id="45bad-1093">If not, it proceeds to calculate the distance of the vertex from the query point.</span></span> <span data-ttu-id="45bad-1094">Если расстояние меньше Шортестдистанце, обновите как Шортестдистанце, так и Клосестпоинт.</span><span class="sxs-lookup"><span data-stu-id="45bad-1094">If the distance is smaller than ShortestDistance, update both ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="45bad-1095">В итоге он обновляет журнал вершин, чтобы эта вершина была помечена как ОБРАБОТАНная.</span><span class="sxs-lookup"><span data-stu-id="45bad-1095">At the end, it updates the vertex history so that this vertex is marked as "PROCESSED."</span></span>

<span data-ttu-id="45bad-1096">Если во внешнем цикле управления исчерпаны все треугольники или выходы до порогового значения цветовой разницы, доступ к переменной Клосестпоинт осуществляется.</span><span class="sxs-lookup"><span data-stu-id="45bad-1096">When the outer control loop has either exhausted all the triangles or exited before color difference threshold has been met, the variable ClosestPoint is accessed.</span></span> <span data-ttu-id="45bad-1097">Это результат Миндемап.</span><span class="sxs-lookup"><span data-stu-id="45bad-1097">This is the result of MinDEMap.</span></span> <span data-ttu-id="45bad-1098">Вызывающий объект также может получить Шортестдистанце, если интересно, насколько сопоставленный цвет относится к цвету запроса.</span><span class="sxs-lookup"><span data-stu-id="45bad-1098">The caller can also retrieve ShortestDistance if interested in how far the mapped color is from the query color.</span></span>

### <a name="hue-smoothing"></a><span data-ttu-id="45bad-1099">Сглаживание оттенков</span><span class="sxs-lookup"><span data-stu-id="45bad-1099">Hue Smoothing</span></span>

![Диаграмма, на которой показаны два верхних представления сглаживания оттенков, оригинал сверху и цветовой тон, сглаженный по нижнему краю.](images/gmmp-image125.png)

<span data-ttu-id="45bad-1101">**Рисунок 35** . сглаживание оттенков</span><span class="sxs-lookup"><span data-stu-id="45bad-1101">**Figure 35** : Hue Smoothing</span></span>

<span data-ttu-id="45bad-1102">Возникла ошибка в операциях с ограниченным оттенком. то есть операция учитывает только переменные в пределах плоскости оттенок.</span><span class="sxs-lookup"><span data-stu-id="45bad-1102">An issue arises with operations that are hue constrained; that is, the operation only considers variables within a hue plane.</span></span> <span data-ttu-id="45bad-1103">На рис. 35 показан пример цветового охвата срезов «непрерывного» оттенков синего цвета.</span><span class="sxs-lookup"><span data-stu-id="45bad-1103">Figure 35 shows an example of a gamut exhibiting "discontinuous" hue slices in the blue hues.</span></span> <span data-ttu-id="45bad-1104">В пределах этого диапазона оттенков для определенных углов оттенка граница палитры отношения к плоскости оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-1104">Within this hue range, for certain hue angles, the gamut boundary is tangential to the hue plane.</span></span> <span data-ttu-id="45bad-1105">Фактически это приводит к изменению структуры топологическом срезов оттенков.</span><span class="sxs-lookup"><span data-stu-id="45bad-1105">In effect, this causes a change in the topological structure of the hue slices.</span></span> <span data-ttu-id="45bad-1106">В приведенном примере, когда плоскость оттенок выводится в пределах этого диапазона оттенков, выводятся «островки» и подобъединения.</span><span class="sxs-lookup"><span data-stu-id="45bad-1106">In the example shown, as the hue plane sweeps across this hue range, an "island" emerges and submerges.</span></span> <span data-ttu-id="45bad-1107">Это изменение топологии приведет к разрыву конкретных операций оттенка.</span><span class="sxs-lookup"><span data-stu-id="45bad-1107">This change in topology will cause hue specific operations to be discontinuous.</span></span> <span data-ttu-id="45bad-1108">Например, КУСП на фиксированном оттенке будет резко меняться, когда изменяется угол оттенок в этом диапазоне.</span><span class="sxs-lookup"><span data-stu-id="45bad-1108">For example, the cusp at fixed hue will change abruptly as the hue angle changes across this range.</span></span>

<span data-ttu-id="45bad-1109">Существует причина, по которой предпочтительно сохранять оттенок при определенных операциях.</span><span class="sxs-lookup"><span data-stu-id="45bad-1109">There is a color science reason why it is desirable to preserve hue in certain operations.</span></span> <span data-ttu-id="45bad-1110">Чтобы устранить описанную выше проблему, исходные треугольники границ цветовых диапазонов должны быть сглажены.</span><span class="sxs-lookup"><span data-stu-id="45bad-1110">To resolve the preceding issue, the original Gamut Boundary Triangles must be "hue smoothed."</span></span> <span data-ttu-id="45bad-1111">Как правило, сглаживание оттенков набора треугольников границ цветовой палитры представляет собой набор треугольников, в котором (a) образуется граница нового "палитры", которая может не соответствовать реальному спектру устройств, и содержит цветовой охват, определенный исходным набором треугольников. и (б) треугольники в новом наборе связаны от параллельного к плоскости оттенков.</span><span class="sxs-lookup"><span data-stu-id="45bad-1111">Generally speaking, a hue smoothing of a set of Gamut Boundary Triangles is a set of triangles such that (a) it forms the boundary of a new "gamut," which might not correspond to the actual device gamut, and that contains the gamut defined by the original set of triangles; and (b) the triangles in the new set are bounded away from being parallel to the hue planes.</span></span>

<span data-ttu-id="45bad-1112">Одним из практических способов получения сглаженного набора треугольников является получение выпуклой поверхности из исходных вершин.</span><span class="sxs-lookup"><span data-stu-id="45bad-1112">One practical way to obtain a hue smoothed set of triangles is to take the convex hull of the original vertices.</span></span> <span data-ttu-id="45bad-1113">Как показано на рисунке 35, срезы оттенок выпуклой поверхности в диапазоне оттенок проблем незначительно меняются, не внося внезапного изменения в топологию.</span><span class="sxs-lookup"><span data-stu-id="45bad-1113">As illustrated in Figure 35, the hue slices of the convex hull vary smoothly in the problematic hue range without a sudden change in topology.</span></span>

### <a name="setting-primaries-and-secondaries-in-the-gamut-boundary-description"></a><span data-ttu-id="45bad-1114">Настройка первичных и вторичных баз данных в описании границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-1114">Setting Primaries and Secondaries in the Gamut Boundary Description</span></span>

<span data-ttu-id="45bad-1115">Некоторые методы сопоставления палитры, такие как Хуемап, зависят от расположения первичных и вторичных реплик устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-1115">Certain gamut mapping methods, such as HueMap, depend on the location of the device primaries and secondaries.</span></span> <span data-ttu-id="45bad-1116">Для аддитивных устройств первичным, зеленым и синим цветами являются "красный", "зеленый" и "синий" (R, G и B); а вторичные базы данных — голубой, пурпурный и желтый (C, M и Y).</span><span class="sxs-lookup"><span data-stu-id="45bad-1116">For additive devices, the primaries are red, green, and blue (R, G, and B); and the secondaries are cyan, magenta, and yellow (C, M, and Y).</span></span> <span data-ttu-id="45bad-1117">Для вычитания устройств первичный элемент — C, M и Y; а вторичные базы данных — R, G и B. ГБД отслеживает все шесть этих значений, плюс белые и черные (W и K) в массиве значений цвета Jab.</span><span class="sxs-lookup"><span data-stu-id="45bad-1117">For subtractive devices, the primaries are C, M, and Y; and the secondaries are R, G, and B. The GBD keeps track of all six of those values, plus white and black (W and K), in a array of Jab color values.</span></span> <span data-ttu-id="45bad-1118">Эти значения задаются в описании границы цветового охвата при их создании.</span><span class="sxs-lookup"><span data-stu-id="45bad-1118">These values are set into the gamut boundary description when it is created.</span></span> <span data-ttu-id="45bad-1119">Для устройств вывода первичные элементы можно определить, запустив сочетания значений элементов управления устройствами с помощью модели устройства.</span><span class="sxs-lookup"><span data-stu-id="45bad-1119">For output devices, the primaries can be determined by running combinations of device control values through the device model.</span></span> <span data-ttu-id="45bad-1120">Для устройств записи этот подход плохо подходит для создания ссылочного ГБД, поскольку почти невозможно записать образ, который возвращает полностью насыщенное значение чистого устройства, например (0,0, 0,0, 1,0).</span><span class="sxs-lookup"><span data-stu-id="45bad-1120">For capture devices, this approach is not well-suited for creating the reference GBD, because it is almost impossible to capture an image that yields a fully saturated pure device value, such as (0.0, 0.0, 1.0).</span></span> <span data-ttu-id="45bad-1121">Профили устройств WCS содержат индексы первичных элементов в целевом объекте захвата.</span><span class="sxs-lookup"><span data-stu-id="45bad-1121">WCS device profiles contain the indices of the primaries in the capture target.</span></span> <span data-ttu-id="45bad-1122">Так как эти значения не содержатся в ICC-профиле, используйте значения, измеренные из типичного целевого объекта сканера, после преобразования в Jab, относительно условий просмотра ICC.</span><span class="sxs-lookup"><span data-stu-id="45bad-1122">Because these values are not contained in an ICC profile, use values measured from a typical scanner target after converting to Jab, relative to the ICC viewing conditions.</span></span>

### <a name="setting-the-neutral-axis-in-the-gamut-boundary-description"></a><span data-ttu-id="45bad-1123">Задание нейтральной оси в описании границы цветового охвата</span><span class="sxs-lookup"><span data-stu-id="45bad-1123">Setting the Neutral Axis in the Gamut Boundary Description</span></span>

<span data-ttu-id="45bad-1124">Хуемап и относительные методы сопоставления гаммы Минкд используют независимую ось устройства для выпрямления.</span><span class="sxs-lookup"><span data-stu-id="45bad-1124">The HueMap and the Relative MinCD gamut mapping methods use the device neutral axis for straightening.</span></span> <span data-ttu-id="45bad-1125">Для базовых выходных устройств можно определить нейтральную ось, запустив нейтральные значения устройства (R = G = B или C = M = Y) через метод Девицетоколориметрик, а затем через метод Колориметриктоаппеаранце объекта CIECAM02.</span><span class="sxs-lookup"><span data-stu-id="45bad-1125">For the baseline output devices, the neutral axis can be determined by running device neutral values (R=G=B or C=M=Y) through the DeviceToColorimetric method, and then through the ColorimetricToAppearance method of the CIECAM02 object.</span></span> <span data-ttu-id="45bad-1126">Однако устройства записи не всегда возвращают нейтральное значение устройства при представлении с нейтральным примером.</span><span class="sxs-lookup"><span data-stu-id="45bad-1126">However, capture devices do not always return a device neutral value when presented with a neutral sample.</span></span> <span data-ttu-id="45bad-1127">Это особенно справедливо, если окружающее освещение не является строго нейтральным.</span><span class="sxs-lookup"><span data-stu-id="45bad-1127">This is particularly true when the ambient lighting is not perfectly neutral.</span></span> <span data-ttu-id="45bad-1128">Профили устройств WCS содержат индексы нейтральных выборок в целевом объекте.</span><span class="sxs-lookup"><span data-stu-id="45bad-1128">WCS device profiles contain the indices of the neutral samples in the target.</span></span> <span data-ttu-id="45bad-1129">Используйте эти примеры для установки нейтральной оси.</span><span class="sxs-lookup"><span data-stu-id="45bad-1129">Use those samples to set the neutral axis.</span></span> <span data-ttu-id="45bad-1130">Поскольку эти сведения недоступны для профилей ICC, необходимо использовать тот же метод, который используется для выходных устройств. Запустите образцы с независимыми устройствами с помощью метода Девицетоколориметрик, а затем присоедините входные значения и + +.</span><span class="sxs-lookup"><span data-stu-id="45bad-1130">Because this information is not available for ICC profiles, you must use the same method that is used for output devices; run device neutral samples through the DeviceToColorimetric method, and then couple the input values and the colorimetric results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="45bad-1131">См. также</span><span class="sxs-lookup"><span data-stu-id="45bad-1131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45bad-1132">Основные понятия управления цветом</span><span class="sxs-lookup"><span data-stu-id="45bad-1132">Basic color management concepts</span></span>](basic-color-management-concepts.md)
</dt> <dt>

[<span data-ttu-id="45bad-1133">Схемы и алгоритмы цветовой системы Windows</span><span class="sxs-lookup"><span data-stu-id="45bad-1133">Windows Color System Schemas and Algorithms</span></span>](windows-color-system-schemas-and-algorithms.md)
</dt> </dl>

 

 




