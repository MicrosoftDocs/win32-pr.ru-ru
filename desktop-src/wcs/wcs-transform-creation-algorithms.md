---
title: Алгоритмы создания преобразования WCS
description: Алгоритмы создания преобразования WCS
ms.assetid: 526bbbfc-fb60-415d-b4f0-6a44a5d11a55
keywords:
- Цветовая система Windows (WCS), создание преобразования
- WCS (цветовая система Windows), создание преобразования
- Управление цветом изображений, создание преобразований
- Управление цветом, создание преобразований
- цвета, создание преобразования
- Создание преобразования
- Создание преобразования WCS
- алгоритмы, создание преобразований
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 418596c0e57571f3e504727d4606921d36ff9461
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "104550251"
---
# <a name="wcs-transform-creation-algorithms"></a><span data-ttu-id="258ec-111">Алгоритмы создания преобразования WCS</span><span class="sxs-lookup"><span data-stu-id="258ec-111">WCS Transform Creation Algorithms</span></span>

[<span data-ttu-id="258ec-112">Создание преобразований</span><span class="sxs-lookup"><span data-stu-id="258ec-112">Creation of Transforms</span></span>](#creation-of-transforms)

 

[<span data-ttu-id="258ec-113">Выполнение последовательного преобразования</span><span class="sxs-lookup"><span data-stu-id="258ec-113">Sequential Transform Execution</span></span>](#sequential-transform-execution)

 

[<span data-ttu-id="258ec-114">Создание оптимизированных преобразований</span><span class="sxs-lookup"><span data-stu-id="258ec-114">Creation of Optimized Transforms</span></span>](#creation-of-optimized-transforms)

 

[<span data-ttu-id="258ec-115">иккпрофилефромвкспрофиле</span><span class="sxs-lookup"><span data-stu-id="258ec-115">ICCProfileFromWCSProfile</span></span>](#iccprofilefromwcsprofile)

 

[<span data-ttu-id="258ec-116">Черная сохранность и создание черной версии</span><span class="sxs-lookup"><span data-stu-id="258ec-116">Black Preservation and Black Generation</span></span>](#black-preservation-and-black-generation)

 

[<span data-ttu-id="258ec-117">Проверить цветовой охват</span><span class="sxs-lookup"><span data-stu-id="258ec-117">Check Gamut</span></span>](#checkgamut)

## <a name="creation-of-transforms"></a><span data-ttu-id="258ec-118">Создание преобразований</span><span class="sxs-lookup"><span data-stu-id="258ec-118">Creation of Transforms</span></span>

<span data-ttu-id="258ec-119">Чтобы правильно объяснить, как работают преобразования цветов, полезно объяснить полный путь обработки с помощью ICM 2,0 и внутренних компонентов отв.</span><span class="sxs-lookup"><span data-stu-id="258ec-119">To properly explain how color transforms work, it is helpful to explain the complete processing path through both ICM 2.0 and the internals of the CTE.</span></span> <span data-ttu-id="258ec-120">Функция ICM 2,0 [**креатеколортрансформв**](/windows/win32/api/icm/nf-icm-createcolortransformw) создает цветное преобразование, которое приложения могут использовать для выполнения управления цветом.</span><span class="sxs-lookup"><span data-stu-id="258ec-120">The ICM 2.0 [**CreateColorTransformW**](/windows/win32/api/icm/nf-icm-createcolortransformw) function creates a color transform that applications can use to perform color management.</span></span> <span data-ttu-id="258ec-121">Эта функция создает контекст цвета на основе входных данных [**логколорспаце**](/windows/desktop/api/Wingdi/ns-wingdi-taglogcolorspacea) и намерения.</span><span class="sxs-lookup"><span data-stu-id="258ec-121">This function creates a color context from the [**LOGCOLORSPACE**](/windows/desktop/api/Wingdi/ns-wingdi-taglogcolorspacea) and intent inputs.</span></span> <span data-ttu-id="258ec-122">Способы сопоставляются с базовым алгоритмом сопоставления цветового охвата ICC.</span><span class="sxs-lookup"><span data-stu-id="258ec-122">The intents are mapped to baseline ICC gamut mapping algorithm correlates.</span></span> <span data-ttu-id="258ec-123">Затем функция вызывает ICM 2,0 Function [**креатемултипрофилетрансформ**](/windows/desktop/api/Wingdi/) для единообразной обработки цвета.</span><span class="sxs-lookup"><span data-stu-id="258ec-123">The function then calls ICM 2.0 function [**CreateMultiProfileTransform**](/windows/desktop/api/Wingdi/) for consistent color processing.</span></span> <span data-ttu-id="258ec-124">Функция **креатеколортрансформ** обычно копирует данные во внутреннюю оптимизированную структуру преобразования.</span><span class="sxs-lookup"><span data-stu-id="258ec-124">The **CreateColorTransform** function generally copies data into the internal optimized transform structure.</span></span>

<span data-ttu-id="258ec-125">Функция ICM 2,0 Креатемултипрофилетрансформ принимает массив профилей и массив целей или один профиль связи устройства и создает цветное преобразование, которое приложения могут использовать для выполнения сопоставления цветов.</span><span class="sxs-lookup"><span data-stu-id="258ec-125">The ICM 2.0 CreateMultiProfileTransform function accepts an array of profiles and an array of intents or a single device link profile and creates a color transform that applications can use to perform color mapping.</span></span> <span data-ttu-id="258ec-126">Он обрабатывает эти входные профили и способы создания моделей устройств, моделей отображения цветов, описаний границ палитры и моделей сопоставления палитры.</span><span class="sxs-lookup"><span data-stu-id="258ec-126">It processes those input profiles and intents to create device models, color appearance models, gamut boundary descriptions, and gamut mapping models.</span></span> <span data-ttu-id="258ec-127">Вот как это делается:</span><span class="sxs-lookup"><span data-stu-id="258ec-127">Here's how this is done:</span></span>

-   <span data-ttu-id="258ec-128">Модели устройств инициализируются непосредственно из профилей DM.</span><span class="sxs-lookup"><span data-stu-id="258ec-128">Device models are initialized directly from DM profiles.</span></span> <span data-ttu-id="258ec-129">Для каждого профиля создается одна модель устройства в вызове [**креатемултипрофилетрансформ**](/windows/desktop/api/Wingdi/).</span><span class="sxs-lookup"><span data-stu-id="258ec-129">There is one device model created for each profile in the call to [**CreateMultiProfileTransform**](/windows/desktop/api/Wingdi/).</span></span>
-   <span data-ttu-id="258ec-130">Модели цветового оформления инициализируются непосредственно из профилей камера.</span><span class="sxs-lookup"><span data-stu-id="258ec-130">Color appearance models are initialized directly from CAM profiles.</span></span> <span data-ttu-id="258ec-131">Для каждого профиля в вызове [**креатемултипрофилетрансформ**](/windows/desktop/api/Wingdi/)имеется один профиль фотокамера.</span><span class="sxs-lookup"><span data-stu-id="258ec-131">There is one CAM profile for each profile in the call to [**CreateMultiProfileTransform**](/windows/desktop/api/Wingdi/).</span></span> <span data-ttu-id="258ec-132">Тем не менее можно указать один и тот же профиль фотокамера для более чем одного профиля.</span><span class="sxs-lookup"><span data-stu-id="258ec-132">The same CAM profile can be specified for more than one profile, however.</span></span>
-   <span data-ttu-id="258ec-133">Описания границ цветовой палитры инициализируются из объекта модели устройства и объекта «камера».</span><span class="sxs-lookup"><span data-stu-id="258ec-133">Gamut boundary descriptions are initialized from a device model object and a CAM object.</span></span> <span data-ttu-id="258ec-134">Для каждого профиля в вызове [**креатемултипрофилетрансформ**](/windows/desktop/api/Wingdi/)имеется одно описание границы цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="258ec-134">There is one gamut boundary description for each profile in the call to [**CreateMultiProfileTransform**](/windows/desktop/api/Wingdi/).</span></span>
-   <span data-ttu-id="258ec-135">Модели сопоставления цветовых диапазонов инициализируются из двух границ цветового охвата и намерений.</span><span class="sxs-lookup"><span data-stu-id="258ec-135">Gamut mapping models are initialized from two gamut boundaries and an intent.</span></span> <span data-ttu-id="258ec-136">Необходимо создать модель сопоставления цветового охвата между каждой парой моделей устройств, созданных из вызова в [**креатемултипрофилетрансформ**](/windows/desktop/api/Wingdi/).</span><span class="sxs-lookup"><span data-stu-id="258ec-136">You must create a gamut mapping model between each pair of device models created from the call to [**CreateMultiProfileTransform**](/windows/desktop/api/Wingdi/).</span></span> <span data-ttu-id="258ec-137">Обратите внимание, что это означает, что используется одна модель отображения цветового охвата, отличная от модели устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-137">Note that this means that you use one fewer gamut map model than device model.</span></span> <span data-ttu-id="258ec-138">Так как количество целей соответствует количеству моделей устройств, существует еще одна цель, чем требуется.</span><span class="sxs-lookup"><span data-stu-id="258ec-138">Because the number of intents matches the number of device models, there is also one more intent than required.</span></span> <span data-ttu-id="258ec-139">Первая цель в списке пропускается.</span><span class="sxs-lookup"><span data-stu-id="258ec-139">The first intent in the list is skipped.</span></span> <span data-ttu-id="258ec-140">Вы просматриваете список моделей и целей устройств, создавая модели сопоставления цветовых диапазонов.</span><span class="sxs-lookup"><span data-stu-id="258ec-140">You walk through the list of device models and intents, creating gamut mapping models.</span></span> <span data-ttu-id="258ec-141">Выберите первую и вторую модели устройств и второе намерение, а затем инициализируйте первую модель сопоставления цветов.</span><span class="sxs-lookup"><span data-stu-id="258ec-141">Pick up the first and second device models and the second intent, and then initialize the first gamut mapping model.</span></span> <span data-ttu-id="258ec-142">Выберите вторую и третью модели устройств и третью намерение, а затем инициализируйте вторую модель сопоставления цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="258ec-142">Pick up the second and third device models and the third intent, and then initialize the second gamut mapping model.</span></span> <span data-ttu-id="258ec-143">Продолжайте таким образом, пока не будут созданы все модели сопоставления цветовой гаммы.</span><span class="sxs-lookup"><span data-stu-id="258ec-143">Continue in this manner until you have created all the gamut mapping models.</span></span>

<span data-ttu-id="258ec-144">После того как профили были правильно обработаны и были созданы и инициализированы все промежуточные объекты, можно создать ЦИТИРУЕМое преобразование с помощью следующего вызова.</span><span class="sxs-lookup"><span data-stu-id="258ec-144">When the profiles have been properly processed and all intermediate objects have been created and initialized, then you can create the CITE transform with the following call.</span></span> <span data-ttu-id="258ec-145">*Пдесткам* и *пдестдм* — это связанные с последним профилем в вызове [**креатемултипрофилетрансформ**](/windows/desktop/api/Wingdi/).</span><span class="sxs-lookup"><span data-stu-id="258ec-145">The *pDestCAM* and *pDestDM* are those associated with the last profile in the call to [**CreateMultiProfileTransform**](/windows/desktop/api/Wingdi/).</span></span>


```C++
HRESULT CreateCITEColorTransform(
 __inout     IDeviceModel          *pSourceDM,
 __inout     IColorAppearanceModel *pSourceCAM,
 __in        GamutMapArray         *pGamutMapArray,
 __inout     IColorAppearanceModel *pDestCAM,
 __inout     IDeviceModel          *pDestDM,
             EColorTransformMode    eTransformMode,
 __deref_out IColorTransform      **ppCTS
 );
```



## <a name="support-for-plug-ins"></a><span data-ttu-id="258ec-146">Поддержка подключаемых модулей</span><span class="sxs-lookup"><span data-stu-id="258ec-146">Support for plug-ins</span></span>

<span data-ttu-id="258ec-147">Одной из проблем, связанных с настройкой списка преобразований, является проверка доступности требуемого подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="258ec-147">One issue involved in setting up the transform list is to validate whether a required plug-in is available.</span></span> <span data-ttu-id="258ec-148">Следующий параметр модели предоставляет эту политику для управления этим поведением.</span><span class="sxs-lookup"><span data-stu-id="258ec-148">The following model switch provides this policy to control this behavior.</span></span> <span data-ttu-id="258ec-149">Управление этим списком преобразований является методом во внутренней оптимизированной структуре преобразования, но каждый метод модели предоставляет указатель на себя и собственный набор значений параметров.</span><span class="sxs-lookup"><span data-stu-id="258ec-149">The management of this transform list is a method in the internal optimized transform structure, but each model method provides the pointer to itself and its own set of parameter values.</span></span>

<span data-ttu-id="258ec-150">Режим должен быть одним из следующих.</span><span class="sxs-lookup"><span data-stu-id="258ec-150">The mode must be one of the following.</span></span>

-   <span data-ttu-id="258ec-151">Тфмробуст: Если профиль измерения указывает предпочтительный подключаемый модуль и подключаемый модуль недоступен, Новая система CTE будет использовать подключаемый модуль базового уровня.</span><span class="sxs-lookup"><span data-stu-id="258ec-151">TfmRobust: If a measurement profile specifies a preferred plug-in and the plug-in is not available, the new CTE system will use the baseline plug-in.</span></span> <span data-ttu-id="258ec-152">Если ни один из подключаемых модулей недоступен, преобразование сообщит об ошибке.</span><span class="sxs-lookup"><span data-stu-id="258ec-152">If neither plug-in is available, the transform will report an error.</span></span>
-   <span data-ttu-id="258ec-153">Тфмстрикт: Если Колорконтекст указывает предпочтительный подключаемый модуль, подключаемый модуль должен быть доступен.</span><span class="sxs-lookup"><span data-stu-id="258ec-153">TfmStrict: If the ColorContext specifies a preferred plug-in, the plug-in must be available.</span></span> <span data-ttu-id="258ec-154">Если предпочтительный подключаемый модуль не найден, будет использоваться базовый подключаемый модуль.</span><span class="sxs-lookup"><span data-stu-id="258ec-154">If no preferred plug-in is found, the baseline plug-in will be used.</span></span> <span data-ttu-id="258ec-155">Если ни один из подключаемых модулей недоступен, преобразование сообщит об ошибке.</span><span class="sxs-lookup"><span data-stu-id="258ec-155">If neither plug-in is available, the transform will report an error.</span></span>
-   <span data-ttu-id="258ec-156">Тфмбаселине: в Аддмеасурементстеп можно использовать только подключаемые модули базового уровня.</span><span class="sxs-lookup"><span data-stu-id="258ec-156">TfmBaseline: Only baseline plug-ins can be used in AddMeasurementStep.</span></span> <span data-ttu-id="258ec-157">Если Колорконтекст указывает предпочтительный подключаемый модуль, подключаемый модуль будет проигнорирован.</span><span class="sxs-lookup"><span data-stu-id="258ec-157">If the ColorContext specifies a preferred plug-in, the plug-in will be ignored.</span></span> <span data-ttu-id="258ec-158">Если подключаемый модуль базового уровня недоступен, преобразование сообщит об ошибке.</span><span class="sxs-lookup"><span data-stu-id="258ec-158">If the baseline plug-in is not available, the transform will report an error.</span></span>

## <a name="transform-execution"></a><span data-ttu-id="258ec-159">Выполнение преобразования</span><span class="sxs-lookup"><span data-stu-id="258ec-159">Transform execution</span></span>

<span data-ttu-id="258ec-160">Функция [**ТРАНСЛАТЕКОЛОРС**](/windows/win32/api/icm/nf-icm-translatecolors) API ICM 2,0 преобразует массив цветов из исходного [цветового](c.md) пространства в цветовое пространство назначения, как определено в преобразовании цвета.</span><span class="sxs-lookup"><span data-stu-id="258ec-160">The ICM 2.0 API [**TranslateColors**](/windows/win32/api/icm/nf-icm-translatecolors) function translates an array of colors from the source [color space](c.md) to the destination color space as defined by a color transform.</span></span> <span data-ttu-id="258ec-161">Эта функция внутренне проверяет массив кэшированных цветов, чтобы обеспечить немедленное сопоставление часто преобразованных цветов.</span><span class="sxs-lookup"><span data-stu-id="258ec-161">This function internally checks against an array of cached colors to enable immediate matching of commonly transformed colors.</span></span> <span data-ttu-id="258ec-162">Это преобразование поддерживает 8-битные массивы байтов на канал и 32 бит на массив с плавающей точкой на канале.</span><span class="sxs-lookup"><span data-stu-id="258ec-162">This transform supports 8-bit per channel byte arrays and 32-bit per channel float arrays.</span></span> <span data-ttu-id="258ec-163">Все остальные форматы будут преобразованы перед передачей в новое отв.</span><span class="sxs-lookup"><span data-stu-id="258ec-163">All other formats will be converted prior to passing off to the new CTE.</span></span>

<span data-ttu-id="258ec-164">Функция [**ТРАНСЛАТЕБИТМАПБИТС**](/windows/win32/api/icm/nf-icm-translatebitmapbits) API ICM 2,0 преобразует цвета точечного рисунка, имеющего определенный формат, для создания другого точечного рисунка в запрошенном формате.</span><span class="sxs-lookup"><span data-stu-id="258ec-164">The ICM 2.0 API [**TranslateBitmapBits**](/windows/win32/api/icm/nf-icm-translatebitmapbits) function translates the colors of a bitmap having a defined format to produce another bitmap in a requested format.</span></span> <span data-ttu-id="258ec-165">Эта функция внутренне проверяет массив кэшированных цветов, чтобы обеспечить немедленное сопоставление часто преобразованных цветов.</span><span class="sxs-lookup"><span data-stu-id="258ec-165">This function internally checks against an array of cached colors to enable immediate matching of commonly transformed colors.</span></span> <span data-ttu-id="258ec-166">Чтобы избежать слишком большого количества путей кода, поддержки и сложности тестирования, в подсистеме преобразования и интерполяции фактически поддерживается только ограниченное количество форматов битовых рисунков.</span><span class="sxs-lookup"><span data-stu-id="258ec-166">To avoid too many code paths, support, and testing complexity, only a limited number of bitmap formats are actually supported in the transform and interpolation engine.</span></span> <span data-ttu-id="258ec-167">Эта функция должна переводить несобственные форматы входящего и исходящего растрового изображения в формат, поддерживаемый в собственном формате для обработки.</span><span class="sxs-lookup"><span data-stu-id="258ec-167">This function must translate the non-native incoming and outgoing bitmap formats into natively supported formats for processing.</span></span> <span data-ttu-id="258ec-168">Это преобразование поддерживает только 8-битные битовые байты на канал и 32 бит на канал с точечными рисунками с плавающей запятой.</span><span class="sxs-lookup"><span data-stu-id="258ec-168">This transform only supports 8-bit per channel byte bitmaps and 32-bit per channel float bitmaps.</span></span> <span data-ttu-id="258ec-169">Все остальные форматы будут преобразованы перед передачей в новое отв.</span><span class="sxs-lookup"><span data-stu-id="258ec-169">All other formats will be converted prior to passing off to the new CTE.</span></span>

 

### <a name="sequential-transform-execution"></a><span data-ttu-id="258ec-170">Выполнение последовательного преобразования</span><span class="sxs-lookup"><span data-stu-id="258ec-170">Sequential Transform Execution</span></span>

<span data-ttu-id="258ec-171">Если параметр *dwFlags* имеет бит последовательного \_ преобразования, установленный при вызове функций [**креатеколортрансформв**](/windows/win32/api/icm/nf-icm-createcolortransformw) или **креатемултипрофилетрансформ** ICM, шаги преобразования выполняются последовательно.</span><span class="sxs-lookup"><span data-stu-id="258ec-171">If the *dwFlags* parameter has the SEQUENTIAL\_TRANSFORM bit set when the ICM functions [**CreateColorTransformW**](/windows/win32/api/icm/nf-icm-createcolortransformw) or **CreateMultiProfileTransform** are called, then the transform steps are executed sequentially.</span></span> <span data-ttu-id="258ec-172">Это означает, что код проходит через каждую модель устройства, модель внешнего вида и модель сопоставления цветового охвата отдельно, как указано в вызове **креатеколортрансформ** или **креатемултипрофилетрансформ** .</span><span class="sxs-lookup"><span data-stu-id="258ec-172">This means that the code steps through each device model, color appearance model, and gamut mapping model separately, as specified by the **CreateColorTransform** or **CreateMultiProfileTransform** call.</span></span> <span data-ttu-id="258ec-173">Это может быть полезно при отладке подключаемых модулей, но намного медленнее, чем с помощью оптимизированного преобразования.</span><span class="sxs-lookup"><span data-stu-id="258ec-173">This may be helpful for debugging plug-in modules, but it is much slower than executing through an optimized transform.</span></span> <span data-ttu-id="258ec-174">Поэтому запуск в последовательном режиме не рекомендуется для рабочего программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="258ec-174">Running in sequential mode is therefore not recommended for production software.</span></span> <span data-ttu-id="258ec-175">Кроме того, результаты, полученные в последовательном и оптимизированном режиме, могут быть незначительными.</span><span class="sxs-lookup"><span data-stu-id="258ec-175">Also, there may be slight differences in the results obtained in sequential mode and in optimized mode.</span></span> <span data-ttu-id="258ec-176">Это обусловлено вариациями, появившимися при объединении функций.</span><span class="sxs-lookup"><span data-stu-id="258ec-176">This is due to variations introduced when the functions are concatenated together.</span></span>

### <a name="creation-of-optimized-transforms"></a><span data-ttu-id="258ec-177">Создание оптимизированных преобразований</span><span class="sxs-lookup"><span data-stu-id="258ec-177">Creation of Optimized Transforms</span></span>

<span data-ttu-id="258ec-178">Оптимизированное преобразование — это таблица многомерных уточняющих запросов.</span><span class="sxs-lookup"><span data-stu-id="258ec-178">An optimized transform is a multi-dimensional lookup table.</span></span> <span data-ttu-id="258ec-179">Таблица может быть обработана многомерной подсистемой интерполяции, например интерполяцией тетрахедрал, которая применяет цвета ввода к преобразованию.</span><span class="sxs-lookup"><span data-stu-id="258ec-179">The table can be processed by a multi-dimensional interpolation engine, such as tetrahedral interpolation, that applies the input colors to the transform.</span></span> <span data-ttu-id="258ec-180">В следующем разделе описывается создание оптимизированных таблиц подстановки.</span><span class="sxs-lookup"><span data-stu-id="258ec-180">The following section describes how the optimized lookup tables are created.</span></span> <span data-ttu-id="258ec-181">В разделе после этого описано, как выполнить интерполяцию в оптимизированных таблицах подстановки.</span><span class="sxs-lookup"><span data-stu-id="258ec-181">The section after that describes how to interpolate within the optimized lookup tables.</span></span>

## <a name="sparse-lookup-tables"></a><span data-ttu-id="258ec-182">Разреженные таблицы подстановки</span><span class="sxs-lookup"><span data-stu-id="258ec-182">Sparse lookup tables</span></span>

<span data-ttu-id="258ec-183">Обычные принтеры имеют CMYK красок.</span><span class="sxs-lookup"><span data-stu-id="258ec-183">Conventional printers have CMYK inks.</span></span> <span data-ttu-id="258ec-184">Чтобы расширить охват, одним из подходов является добавление новых красок в систему.</span><span class="sxs-lookup"><span data-stu-id="258ec-184">To extend the gamut, one approach is to add new inks to the system.</span></span> <span data-ttu-id="258ec-185">Обычно в триадных цветах красок CMYK возникают проблемы при воспроизведении.</span><span class="sxs-lookup"><span data-stu-id="258ec-185">The inks typically added are colors that CMYK inks have difficulty reproducing.</span></span> <span data-ttu-id="258ec-186">Распространенные варианты: оранжевый, зеленый, красный, синий и т. д. Чтобы увеличить «очевидное разрешение», можно использовать краски с различными оттенками, например светло-голубой, светло-пурпурный и т. д.</span><span class="sxs-lookup"><span data-stu-id="258ec-186">Common choices are orange, green, red, blue, etc. To increase the "apparent resolution," inks with different tints can be used, for example, light cyan, light magenta, and so on.</span></span> <span data-ttu-id="258ec-187">По сути, устройство принтера имеет более четырех каналов.</span><span class="sxs-lookup"><span data-stu-id="258ec-187">In effect, the printer device has more than four channels.</span></span>

<span data-ttu-id="258ec-188">Хотя принтеры являются устройствами вывода, они также выполняют преобразование цветов из пространства устройства в другое цветовое пространство.</span><span class="sxs-lookup"><span data-stu-id="258ec-188">Although printers are output devices, they also perform the color conversion from the device space to another color space.</span></span> <span data-ttu-id="258ec-189">В случае с принтером CMYK это преобразование будет преобразовано из CMYK в XYZ или «прямая модель» принтера.</span><span class="sxs-lookup"><span data-stu-id="258ec-189">In the case of a CMYK printer, this would be a transformation from CMYK to XYZ, or the "forward model" of the printer.</span></span> <span data-ttu-id="258ec-190">Комбинируя модель прямого с другими преобразованиями, можно эмулировать печать CMYK на другом устройстве.</span><span class="sxs-lookup"><span data-stu-id="258ec-190">By combining the forward model with other transformations, it is possible to emulate a CMYK print on another device.</span></span> <span data-ttu-id="258ec-191">Например, цвет CMYK принтера для монитора RGB делает возможным механизм проверки, эмулирующий печать принтера CMYK на мониторе.</span><span class="sxs-lookup"><span data-stu-id="258ec-191">For example, a printer CMYK to a monitor RGB would make possible a proofing mechanism that emulates a print of that CMYK printer on a monitor.</span></span> <span data-ttu-id="258ec-192">Аналогичным образом также применяется для принтеров Hi-Fi.</span><span class="sxs-lookup"><span data-stu-id="258ec-192">Similarly, the same also applies for hi-fi printers.</span></span> <span data-ttu-id="258ec-193">Преобразование КМИКОГ в RGB позволяет выполнять проверку принтера КМИКОГ на мониторе.</span><span class="sxs-lookup"><span data-stu-id="258ec-193">A CMYKOG to RGB conversion allows proofing of the CMYKOG printer on a monitor.</span></span>

<span data-ttu-id="258ec-194">Традиционным подходом к реализации такого преобразования цвета является использование единообразного LUT.</span><span class="sxs-lookup"><span data-stu-id="258ec-194">The conventional approach to implementing such color conversion is by using a uniform LUT.</span></span> <span data-ttu-id="258ec-195">Например, в профиле ICC для принтера КМИКОГ, спецификация ICC требует тег A2B1, в котором хранится унифицированный LUT, представляющий унифицированную выборку в пространстве устройства КМИКОГ модели прямого, которая переходит от КМИКОГ к пространству подключения профиля ICC (ЦИЕЛАБ или ЦИЕКСИЗ).</span><span class="sxs-lookup"><span data-stu-id="258ec-195">For example, in an ICC profile for a CMYKOG printer, the ICC specification mandates an A2B1 tag that stores a uniform LUT representing a uniform sampling in the CMYKOG device space of the forward model, which goes from CMYKOG to the ICC profile connection space (either CIELAB or CIEXYZ).</span></span> <span data-ttu-id="258ec-196">Профиль связи для устройства ICC обеспечивает прямое преобразование из пространства устройства КМИКОГ в любое цветовое пространство, включая пространство устройства, а также в виде LUT, который равномерно используется в КМИКОГ пространстве.</span><span class="sxs-lookup"><span data-stu-id="258ec-196">The ICC device link profile enables a direct transformation from CMYKOG device space to any color space including a device space, also in the form of a LUT sampled uniformly in CMYKOG space.</span></span> <span data-ttu-id="258ec-197">Выборка никогда не выполняется с уровнями 256 (глубина бит 8) из-за большого LUTа, за исключением случаев использования монохромных устройств (1 канал).</span><span class="sxs-lookup"><span data-stu-id="258ec-197">Sampling is never done with 256 levels (bit depth 8) because of the huge LUT resulting, except in the case of monochrome devices (1 channel).</span></span> <span data-ttu-id="258ec-198">Вместо этого используется выборка с более низким уровнем глубины. Некоторые типичные варианты выбора: 9 (битовая глубина 3), 17 (битовая глубина 4), 33 (глубина бит 5).</span><span class="sxs-lookup"><span data-stu-id="258ec-198">Instead, sampling with lower bit depth is used; some typical choices are 9 (bit depth 3), 17 (bit depth 4), 33 (bit depth 5).</span></span> <span data-ttu-id="258ec-199">С числом уровней менее 256 в каждом канале LUT используется в сочетании с алгоритмом интерполяции для получения результата, если уровень находится между двумя уровнями выборки.</span><span class="sxs-lookup"><span data-stu-id="258ec-199">With the number of levels less than 256 in each channel, the LUT is used in conjunction with an interpolation algorithm to produce the result if a level is between two sampled levels.</span></span>

<span data-ttu-id="258ec-200">Хотя единообразный LUT является концептуально простым для реализации, и интерполяция на единообразном LUT обычно является эффективной, размер LUT увеличивается экспоненциально с входным измерением.</span><span class="sxs-lookup"><span data-stu-id="258ec-200">While a uniform LUT is conceptually simple to implement, and interpolation on a uniform LUT is generally efficient, the LUT size increases exponentially with the input dimension.</span></span> <span data-ttu-id="258ec-201">Фактически, если *d* — число шагов, используемых в унифицированном LUT, а *n* — число каналов в исходном цветовом пространстве, то число узлов в LUT — это ![ ПЕРЕМЕННАЯ для количества узлов в LUT. ](images/transformcreation-image002.gif) .</span><span class="sxs-lookup"><span data-stu-id="258ec-201">In fact, if *d* is the number of steps used in the uniform LUT, and *n* is the number of channels in the source color space, then the number of nodes in the LUT is ![Shows the variable for the number of nodes in an LUT.](images/transformcreation-image002.gif).</span></span> <span data-ttu-id="258ec-202">Очевидно, что количество узлов быстро требует большого объема памяти, что даже самые популярные вычислительные системы испытывают трудности при обработке спроса.</span><span class="sxs-lookup"><span data-stu-id="258ec-202">Clearly, the number of nodes quickly demands so much storage in memory that even top-of-the-line computing systems have difficulty handling the demand.</span></span> <span data-ttu-id="258ec-203">Для устройств с шестью или восемью каналами, реализация ICC профиля устройства требует нескольких шагов в LUT, иногда даже до пяти шагов в таблице A2B1 для сохранения профиля в мегабайтах вместо гигабайтов.</span><span class="sxs-lookup"><span data-stu-id="258ec-203">For devices with six or eight channels, an ICC implementation of the device profile requires using few steps in the LUT, sometimes even down to five steps in the A2B1 table to keep the profile within megabytes instead of gigabytes.</span></span> <span data-ttu-id="258ec-204">Очевидно, что использование меньшего количества шагов увеличивает ошибку интерполяции, так как теперь существует меньшее число выборок.</span><span class="sxs-lookup"><span data-stu-id="258ec-204">Clearly, using a smaller number of steps increases interpolation error, because there are now fewer samples.</span></span> <span data-ttu-id="258ec-205">Так как LUT должен быть однородным, точность в пределах всего цветового пространства снижается даже в тех областях пространства, где существенное различие цветов может быть вызвано небольшим изменением в значении устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-205">Because the LUT must be uniform, accuracy over the whole color space is degraded even in those regions of the space where a significant color difference can be caused by small change in the device value.</span></span>

<span data-ttu-id="258ec-206">На устройствах с более чем четырьмя колорантс некоторые подпространства всего пространства устройства являются более важными, чем другие.</span><span class="sxs-lookup"><span data-stu-id="258ec-206">In devices with more than four colorants, certain subspaces of the whole device space are more important than others.</span></span> <span data-ttu-id="258ec-207">Например, в КМИКОГ пространстве цвета голубой и зеленой красок редко используются, так как их оттенки во многом пересекаются друг с другом.</span><span class="sxs-lookup"><span data-stu-id="258ec-207">For example, in CMYKOG space, cyan and green inks are seldom used together because their hues largely overlap each other.</span></span> <span data-ttu-id="258ec-208">Аналогичным образом, желтые и оранжевые краски во многом пересекаются друг с другом.</span><span class="sxs-lookup"><span data-stu-id="258ec-208">Similarly, yellow and orange inks largely overlap each other.</span></span> <span data-ttu-id="258ec-209">Равномерное число шагов можно просмотреть в виде общего ухудшения качества в масштабе всего цветового пространства, что можно позволить себе для невероятных сочетаний рукописного ввода, но не для наиболее вероятных или важных сочетаний.</span><span class="sxs-lookup"><span data-stu-id="258ec-209">A uniform reduction in the number of steps can be viewed as an overall degradation in quality across the whole color space, which is something you can afford for the improbable ink combinations, but not for the likely or important combinations.</span></span>

<span data-ttu-id="258ec-210">Несмотря на то, что единообразный выбор LUT является простым и эффективным для интерполяции, он накладывает требования к огромному объему памяти при увеличении размера измерения.</span><span class="sxs-lookup"><span data-stu-id="258ec-210">While a uniformly sampled LUT is simple and efficient for interpolation, it imposes huge memory requirements as dimension increases.</span></span> <span data-ttu-id="258ec-211">На практике, хотя у устройства может быть шесть или восемь каналов, они редко используются одновременно.</span><span class="sxs-lookup"><span data-stu-id="258ec-211">In reality, while a device might have six or eight channels, they are rarely used simultaneously.</span></span> <span data-ttu-id="258ec-212">В большинстве случаев преобразование «входные цвета в цвет» имеет только несколько «активных» колорантс и, следовательно, находится в более низких цветовых пространствах.</span><span class="sxs-lookup"><span data-stu-id="258ec-212">In most cases, the input color to color transformation has only a few "active" colorants and so resides in a lower dimensional color space.</span></span> <span data-ttu-id="258ec-213">Это также означает, что интерполяцию можно сделать более эффективной в этом пространстве меньшего размера, так как интерполяция выполняется быстрее, если измерение меньше.</span><span class="sxs-lookup"><span data-stu-id="258ec-213">This also means that interpolation can be done more efficiently in that lower dimensional space because interpolation is faster when the dimension is lower.</span></span>

<span data-ttu-id="258ec-214">Таким образом, подход заключается в стратифи всего пространства устройства в подпространства различных измерений.</span><span class="sxs-lookup"><span data-stu-id="258ec-214">Therefore, the approach is to stratify the whole device space into subspaces of various dimensions.</span></span> <span data-ttu-id="258ec-215">Так как более низкие размеры (объединяющие три или четыре колорантс) более важны, стратифинг пространство, можно также применять разные частоты выборки. то есть различное количество шагов, на части; повышение частоты выборки для более низких размеров, уменьшая их для более высоких измерений.</span><span class="sxs-lookup"><span data-stu-id="258ec-215">And because lower dimensions (those combining three or four colorants) are more important, by stratifying the space, you can also apply different sampling rates; that is, a different number of steps, to the pieces; increasing sampling rates for lower dimensions, reducing them for higher dimensions.</span></span>

<span data-ttu-id="258ec-216">Чтобы исправить нотацию, *n* — число каналов в исходном цветовом пространстве преобразования цвета, которое нужно вычислить.</span><span class="sxs-lookup"><span data-stu-id="258ec-216">To fix notations, *n* is the number of channels in the source color space of the color transformation that you want to sample.</span></span> <span data-ttu-id="258ec-217">Можно также в качестве входного измерения указать *n* , а значение ![ n больше или равно 5.](images/transformcreation-image004.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-217">You can also refer to *n* as the input dimension, and ![Shows n greater than or equal to 5.](images/transformcreation-image004.gif)</span></span> <span data-ttu-id="258ec-218">, если не указано иное.</span><span class="sxs-lookup"><span data-stu-id="258ec-218">, unless otherwise specified.</span></span>

<span data-ttu-id="258ec-219">Основные стандартные блоки — это Лутс различных входных *измерений* и размеров вместо одного унифицированного LUT с входным измерением *n*.</span><span class="sxs-lookup"><span data-stu-id="258ec-219">The basic building blocks are LUTs of various input *dimensions* and sizes, instead of one uniform LUT with input dimension *n*.</span></span> <span data-ttu-id="258ec-220">Чтобы быть более точным,*LUT* представляет собой прямоугольную Lattice, накладываемую на единичный куб. то есть все координаты устройства нормализованы до диапазона \[ 0, 1 \] ).</span><span class="sxs-lookup"><span data-stu-id="258ec-220">To be more precise, a *LUT* is a rectangular lattice imposed on a unit cube; that is, all the device coordinates are normalized to the range \[0, 1\]).</span></span> <span data-ttu-id="258ec-221">Если является входным измерением LUT (Обратите внимание, что не должно быть равно *n*, хотя ![ выводится V меньше или равно n).](images/transformcreation-image006.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-221">if   is the input dimension of the lut (note that   does not have to be equal to *n*, although ![Shows V less than or equal to n.](images/transformcreation-image006.gif)</span></span> <span data-ttu-id="258ec-222">является обязательным), то он состоит из ν одномерной сетки выборки:</span><span class="sxs-lookup"><span data-stu-id="258ec-222">is required), then it consists of ν one-dimensional sampling grids:</span></span>

<span data-ttu-id="258ec-223">SAMP *i*: ![ показывает сетку с одномерной выборкой.](images/transformcreation-image008.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-223">Samp *i*: ![Shows a one-dimensional sampling grid.](images/transformcreation-image008.gif)</span></span>

<span data-ttu-id="258ec-224">Если все *x <sub>j</sub>s* должны находиться в диапазоне от \[ 0 до 1, \] будет ![ показан Надстрочный знак d (i).](images/transformcreation-image010.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-224">where all the *x<sub>j</sub>s* must lie in the range \[0, 1\], ![Shows a superscript d(i).](images/transformcreation-image010.gif)</span></span> <span data-ttu-id="258ec-225">число шагов для выборки *i* -канального типа, которое должно быть не меньше 1 и ![ показывает спуперскрипт X (индекс) d (i).](images/transformcreation-image012.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-225">is the number of steps for the *i* th channel sampling which must be at least 1, and ![Shows a spuperscript of X (subscript) d(i).](images/transformcreation-image012.gif)</span></span> <span data-ttu-id="258ec-226">должно быть равно 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-226">must be 1.</span></span> <span data-ttu-id="258ec-227">С другой стороны, ![ показывает Надстрочный знак X (индекс 1).](images/transformcreation-image014.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-227">On the other hand, ![Shows a superscript X (subscript 1).](images/transformcreation-image014.gif)</span></span> <span data-ttu-id="258ec-228">не обязательно должен быть равен 0.</span><span class="sxs-lookup"><span data-stu-id="258ec-228">is not required to be 0.</span></span>

<span data-ttu-id="258ec-229">Будут определены только следующие два особых случая LUT.</span><span class="sxs-lookup"><span data-stu-id="258ec-229">Only the following two special cases of LUT will be defined.</span></span>

<span data-ttu-id="258ec-230">*Закрытые LUT*: это LUT с дополнительным требованием, которое для каждого *<sub></sub>* SAMP i ![ показывает Надстрочный знак X (индекс 1) равным 0.](images/transformcreation-image016.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-230">*Closed LUT*: This is a LUT with the additional requirement that for each Samp *<sub>i</sub>*, ![Shows a superscript X (subscript 1) equals 0.](images/transformcreation-image016.gif)</span></span> <span data-ttu-id="258ec-231">и ![ показывает Надстрочный знак d (i), который больше или равен 2.](images/transformcreation-image018.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-231">, and ![Shows a superscript d(i) greater than or equal to 2.](images/transformcreation-image018.gif)</span></span> <span data-ttu-id="258ec-232">.</span><span class="sxs-lookup"><span data-stu-id="258ec-232">.</span></span> <span data-ttu-id="258ec-233">Равномерное закрытое LUT — это закрытая LUT, которая содержит один и тот же ![ Надстрочный знак d (i).](images/transformcreation-image010.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-233">A uniform closed LUT is a closed LUT that has the same ![Shows a superscript d(i).](images/transformcreation-image010.gif)</span></span> <span data-ttu-id="258ec-234">для каждого канала, и узлы устанавливаются по единому интервалу между 0 и 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-234">for each channel, and the nodes are uniformly spaced between 0 and 1.</span></span>

<span data-ttu-id="258ec-235">*Open LUT*: это LUT с дополнительным требованием, которое для каждого SAMP *i* ![ показывает Надстрочный знак X (индекс 1) больше 0.](images/transformcreation-image020.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-235">*Open LUT*: This is a LUT with the additional requirement that for each Samp *i*, ![SHows a superscript X (subscript 1) greater than 0.](images/transformcreation-image020.gif)</span></span> <span data-ttu-id="258ec-236">.</span><span class="sxs-lookup"><span data-stu-id="258ec-236">.</span></span> <span data-ttu-id="258ec-237">Теперь можно ![ Показать Надстрочный знак d (i), равный 1.](images/transformcreation-image022.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-237">It is OK to have ![Shows a superscript d(i) equal to 1.](images/transformcreation-image022.gif)</span></span> <span data-ttu-id="258ec-238">.</span><span class="sxs-lookup"><span data-stu-id="258ec-238">.</span></span>

<span data-ttu-id="258ec-239">Целью является стратифи единицы измерения \[ 0, 1 \] *n* в коллекцию закрытых Лутс и Open Лутс, чтобы вся коллекция покрыта куб единицы.</span><span class="sxs-lookup"><span data-stu-id="258ec-239">The goal is to stratify the unit cube \[0, 1\] *n* into a collection of closed LUTs and open LUTs, such that the whole collection will cover the unit cube.</span></span> <span data-ttu-id="258ec-240">Концептуально проще организовать эти "LUT Strata" по их размерам, чтобы на верхнем уровне:</span><span class="sxs-lookup"><span data-stu-id="258ec-240">It is conceptually simpler to organize these "LUT strata" by their dimensions, so that on the top level:</span></span>

![Показывает верхний уровень для организации L T Strata по их измерениям.](images/transformcreation-image024.png)

<span data-ttu-id="258ec-242">где ![ отображается подстрочный индекс k.](images/transformcreation-image026.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-242">where ![Shows sigma subscript k.](images/transformcreation-image026.gif)</span></span> <span data-ttu-id="258ec-243">является коллекцией «*k* -мерный Strata».</span><span class="sxs-lookup"><span data-stu-id="258ec-243">is the "*k* -dimensional strata collection."</span></span> <span data-ttu-id="258ec-244">Обратите внимание, что измерение Strata начинается от 3 вместо 0; то есть, указывает, что интерполяция трех-колорант комбинаций может быть обработана без чрезмерного требования к памяти.</span><span class="sxs-lookup"><span data-stu-id="258ec-244">Note that the strata dimension starts from 3 instead of 0; that is, points, because interpolation of three-colorant combinations can be handled without too much memory requirement.</span></span>

## <a name="description-of-the-lut-strata"></a><span data-ttu-id="258ec-245">Описание LUT Strata</span><span class="sxs-lookup"><span data-stu-id="258ec-245">Description of the LUT strata</span></span>

<span data-ttu-id="258ec-246">В этой реализации:</span><span class="sxs-lookup"><span data-stu-id="258ec-246">In this implementation:</span></span>

1. <span data-ttu-id="258ec-247">![Содержит подстрочный индекс 3.](images/transformcreation-image028.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-247">![Shows sigma subscript 3.](images/transformcreation-image028.gif)</span></span> <span data-ttu-id="258ec-248">состоит из закрытых Лутс с тремя входными данными, по одному из всех возможных комбинаций трех колорантс, выбранных из *n* колорантс.</span><span class="sxs-lookup"><span data-stu-id="258ec-248">consists of closed LUTs with three inputs, one from every possible combination of three colorants chosen out of the *n* colorants.</span></span>

2. ![Содержит подстрочный индекс 4.](images/transformcreation-image030.gif) <span data-ttu-id="258ec-250">состоит из одного закрытого LUTа в сочетании CMYK (или первых четырех колорантс) вместе с</span><span class="sxs-lookup"><span data-stu-id="258ec-250">consists of one closed LUT for the combination CMYK (or the first four colorants), together with</span></span> ![Показывает (n более 4) минус 1.](images/transformcreation-image032.png) <span data-ttu-id="258ec-252">Откройте Лутс для всех остальных комбинаций из четырех колорант.</span><span class="sxs-lookup"><span data-stu-id="258ec-252">open LUTs for all other four-colorant combinations.</span></span> <span data-ttu-id="258ec-253">Синглинг комбинацию CMYK, вы подтверждаете, что это важное сочетание.</span><span class="sxs-lookup"><span data-stu-id="258ec-253">By singling out the CMYK combination, you acknowledge that it is an important combination.</span></span>

3. <span data-ttu-id="258ec-254">Для ![ отображает k равным 5,..., n.](images/transformcreation-image034.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-254">For ![Shows k equal to 5, ..., n.](images/transformcreation-image034.gif)</span></span> <span data-ttu-id="258ec-255">, ![ Показывает Сигма в подстрочном k.](images/transformcreation-image026.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-255">, ![Shows sigma subscript k.](images/transformcreation-image026.gif)</span></span> <span data-ttu-id="258ec-256">состоит из ![ выводов (n поверх k).](images/transformcreation-image037.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-256">consists of ![Shows (n over k).](images/transformcreation-image037.gif)</span></span> <span data-ttu-id="258ec-257">Откройте Лутс, по одному для каждого возможного сочетания выбора *k* колорантс в сумме *n* колорантс.</span><span class="sxs-lookup"><span data-stu-id="258ec-257">open LUTs, one for each possible combination of choosing *k* colorants from the total of *n* colorants.</span></span>

<span data-ttu-id="258ec-258">В нем остается указать размеры Лутс.</span><span class="sxs-lookup"><span data-stu-id="258ec-258">It remains to specify the sizes of the LUTs.</span></span> <span data-ttu-id="258ec-259">Основное различие между открытыми и закрытыми Лутс заключается в том, что открытая Лутс не перекрываются, а замкнутые Лутс могут перекрываться на границах.</span><span class="sxs-lookup"><span data-stu-id="258ec-259">The key difference between open and closed LUTs is that open LUTs don't overlap, and closed LUTs might overlap at the boundary faces.</span></span> <span data-ttu-id="258ec-260">Тот факт, что одномерный выборка в открытом LUT не содержит 0, по сути означает, что в открытом LUT не хватает половины граней, поэтому имя "Open".</span><span class="sxs-lookup"><span data-stu-id="258ec-260">The fact that the one-dimensional sampling in an open LUT does not contain 0, essentially means that an open LUT is missing half of the boundary faces, hence the name "open."</span></span> <span data-ttu-id="258ec-261">Если два Лутс не перекрываются, можно использовать разное количество шагов или расположений узлов в каждом канале.</span><span class="sxs-lookup"><span data-stu-id="258ec-261">If two LUTs don't overlap, you can use a different number of steps or node locations in each channel.</span></span> <span data-ttu-id="258ec-262">То же самое не верно, если два Лутс перекрываются.</span><span class="sxs-lookup"><span data-stu-id="258ec-262">The same is not true if two LUTs overlap.</span></span> <span data-ttu-id="258ec-263">В этом случае, если число шагов или расположений узлов отличается, точка пересечения двух Лутс будет принимать разное значение интерполяции в зависимости от того, какой LUT используется в интерполяции.</span><span class="sxs-lookup"><span data-stu-id="258ec-263">In that case, if the number of steps or the node locations are different, a point lying in the intersection of the two LUTs will receive a different interpolation value depending on which LUT is used in the interpolation.</span></span> <span data-ttu-id="258ec-264">Простое решение этой проблемы — использование унифицированной выборки с одинаковым количеством шагов, когда два Лутс перекрываются.</span><span class="sxs-lookup"><span data-stu-id="258ec-264">A simple solution to this problem is to use uniform sampling with the same number of steps whenever two LUTs overlap.</span></span> <span data-ttu-id="258ec-265">Другими словами:</span><span class="sxs-lookup"><span data-stu-id="258ec-265">In other words:</span></span>

<span data-ttu-id="258ec-266">Все закрытые Лутс (все три колорант Лутс и CMYK LUT в этой реализации) должны быть однородными и иметь одинаковое число шагов, которые обозначены как *d*.</span><span class="sxs-lookup"><span data-stu-id="258ec-266">All closed LUTs (all three-colorant LUTs and the CMYK LUT in this implementation) must be uniform and have the same number of steps, which are denoted *d*.</span></span>

<span data-ttu-id="258ec-267">Для определения количества шагов *d* для закрытого Лутс и количества шагов для Open Лутс можно использовать следующие два алгоритма.</span><span class="sxs-lookup"><span data-stu-id="258ec-267">The following two algorithms can be used to determine the number of steps *d* for closed LUTs and the number of steps for open LUTs.</span></span>

## <a name="algorithm-1"></a><span data-ttu-id="258ec-268">Алгоритм \# 1</span><span class="sxs-lookup"><span data-stu-id="258ec-268">Algorithm \#1</span></span>

<span data-ttu-id="258ec-269">Этот алгоритм не требует внешних входных данных.</span><span class="sxs-lookup"><span data-stu-id="258ec-269">This algorithm does not require external input.</span></span>

<span data-ttu-id="258ec-270">Все закрытые Лутс будут однородными с *d* числом шагов.</span><span class="sxs-lookup"><span data-stu-id="258ec-270">All the closed LUTs will be uniform with *d* number of steps.</span></span>

<span data-ttu-id="258ec-271">Все открытые Лутс в измерении *k* будут иметь одинаковое число шагов: ![ d (k).](images/transformcreation-image039.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-271">All the open LUTs of dimension *k* will have same number of steps ![Shows d(k).](images/transformcreation-image039.gif)</span></span> <span data-ttu-id="258ec-272">в каждом входном канале, и узлы имеют одинаковый размер. то есть, для каждой ![ показывает i, равное 1, 2,..., k.](images/transformcreation-image041.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-272">in each input channel, and the nodes are equally spaced; that is, for each ![Shows i equal to 1, 2, ..., k.](images/transformcreation-image041.gif)</span></span> <span data-ttu-id="258ec-273">.</span><span class="sxs-lookup"><span data-stu-id="258ec-273">.</span></span>

<span data-ttu-id="258ec-274">SAMP *i*: ![ показывает алгоритм SAMP i.](images/transformcreation-image043.png)</span><span class="sxs-lookup"><span data-stu-id="258ec-274">Samp *i*: ![Shows samp i algorithm.](images/transformcreation-image043.png)</span></span>

<span data-ttu-id="258ec-275">Наконец, укажите *d* и *d* (*k* ) в следующей таблице 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-275">Finally, specify *d* and *d* (*k* ) in the following Table 1.</span></span> <span data-ttu-id="258ec-276">Три режима: «proof», «обычная» и «лучшая» — параметры качества ICM 2,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-276">The three modes, "proof," "normal," and "best" are the ICM 2.0 quality settings.</span></span> <span data-ttu-id="258ec-277">В этой реализации режим цветопробы имеет наименьший объем памяти, а оптимальный режим — наибольший объем памяти.</span><span class="sxs-lookup"><span data-stu-id="258ec-277">In this implementation, the proof mode has the smallest memory footprint, and best mode has the largest memory footprint.</span></span>

<span data-ttu-id="258ec-278">Для реализации этого алгоритма необходимо вызвать следующий алгоритм \# 2.</span><span class="sxs-lookup"><span data-stu-id="258ec-278">To implement this algorithm, you must call the following Algorithm \#2.</span></span> <span data-ttu-id="258ec-279">Пользователи могут указать собственные расположения выборки, используя таблицы в качестве руководств.</span><span class="sxs-lookup"><span data-stu-id="258ec-279">Users can specify their own sampling locations, using the tables as a guide.</span></span>

## <a name="algorithm-2"></a><span data-ttu-id="258ec-280">Алгоритм \# 2</span><span class="sxs-lookup"><span data-stu-id="258ec-280">Algorithm \#2</span></span>

<span data-ttu-id="258ec-281">Для этого алгоритма требуются внешние входные данные в виде списка "важных" расположений выборки, но это более Адаптивное и может сэкономить место в памяти.</span><span class="sxs-lookup"><span data-stu-id="258ec-281">This algorithm requires external input in the form of a list of "important" sampling locations, but it is more adaptive and can save memory space potentially.</span></span>

<span data-ttu-id="258ec-282">Обязательный вход — это массив значений устройств, предоставленных пользователем.</span><span class="sxs-lookup"><span data-stu-id="258ec-282">The required input is an array of device values supplied by the user.</span></span> <span data-ttu-id="258ec-283">Эти значения устройств указывают, какой регион цветового пространства устройства важен; то есть, какой регион следует использовать в качестве примера.</span><span class="sxs-lookup"><span data-stu-id="258ec-283">These device values indicate which region of the device color space is important; that is, which region should be sampled more.</span></span>

<span data-ttu-id="258ec-284">Все закрытые Лутс будут однородными с *d* количеством шагов, как описано в разделе алгоритм \# 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-284">All the closed LUTs will be uniform with *d* number of steps as described in Algorithm \#1.</span></span> <span data-ttu-id="258ec-285">Значения для *d* приведены в таблице 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-285">Values for *d* are provided in Table 1.</span></span>

<span data-ttu-id="258ec-286">*(a) универсальное закрытое LUT*</span><span class="sxs-lookup"><span data-stu-id="258ec-286">*(a) Uniform Closed LUT*</span></span>



|         | <span data-ttu-id="258ec-287">Режим цветопробы</span><span class="sxs-lookup"><span data-stu-id="258ec-287">Proof mode</span></span> | <span data-ttu-id="258ec-288">Нормальный режим</span><span class="sxs-lookup"><span data-stu-id="258ec-288">Normal mode</span></span> | <span data-ttu-id="258ec-289">Лучший режим</span><span class="sxs-lookup"><span data-stu-id="258ec-289">Best mode</span></span> |
|---------|------------|-------------|-----------|
| <span data-ttu-id="258ec-290">***d***</span><span class="sxs-lookup"><span data-stu-id="258ec-290">***d***</span></span> | <span data-ttu-id="258ec-291">9</span><span class="sxs-lookup"><span data-stu-id="258ec-291">9</span></span>          | <span data-ttu-id="258ec-292">17</span><span class="sxs-lookup"><span data-stu-id="258ec-292">17</span></span>          | <span data-ttu-id="258ec-293">33</span><span class="sxs-lookup"><span data-stu-id="258ec-293">33</span></span>        |



 

<span data-ttu-id="258ec-294">*(б) Open LUT*</span><span class="sxs-lookup"><span data-stu-id="258ec-294">*(b) Open LUT*</span></span>



| <span data-ttu-id="258ec-295">Входное измерение</span><span class="sxs-lookup"><span data-stu-id="258ec-295">Input dimension</span></span> | <span data-ttu-id="258ec-296">Режим цветопробы</span><span class="sxs-lookup"><span data-stu-id="258ec-296">Proof mode</span></span> | <span data-ttu-id="258ec-297">Нормальный режим</span><span class="sxs-lookup"><span data-stu-id="258ec-297">Normal mode</span></span> | <span data-ttu-id="258ec-298">Лучший режим</span><span class="sxs-lookup"><span data-stu-id="258ec-298">Best mode</span></span> |
|-----------------|------------|-------------|-----------|
| <span data-ttu-id="258ec-299">4</span><span class="sxs-lookup"><span data-stu-id="258ec-299">4</span></span>               | <span data-ttu-id="258ec-300">5</span><span class="sxs-lookup"><span data-stu-id="258ec-300">5</span></span>          | <span data-ttu-id="258ec-301">7</span><span class="sxs-lookup"><span data-stu-id="258ec-301">7</span></span>           | <span data-ttu-id="258ec-302">9</span><span class="sxs-lookup"><span data-stu-id="258ec-302">9</span></span>         |
| <span data-ttu-id="258ec-303">5</span><span class="sxs-lookup"><span data-stu-id="258ec-303">5</span></span>               | <span data-ttu-id="258ec-304">2</span><span class="sxs-lookup"><span data-stu-id="258ec-304">2</span></span>          | <span data-ttu-id="258ec-305">3</span><span class="sxs-lookup"><span data-stu-id="258ec-305">3</span></span>           | <span data-ttu-id="258ec-306">3</span><span class="sxs-lookup"><span data-stu-id="258ec-306">3</span></span>         |
| <span data-ttu-id="258ec-307">6</span><span class="sxs-lookup"><span data-stu-id="258ec-307">6</span></span>               | <span data-ttu-id="258ec-308">2</span><span class="sxs-lookup"><span data-stu-id="258ec-308">2</span></span>          | <span data-ttu-id="258ec-309">3</span><span class="sxs-lookup"><span data-stu-id="258ec-309">3</span></span>           | <span data-ttu-id="258ec-310">3</span><span class="sxs-lookup"><span data-stu-id="258ec-310">3</span></span>         |
| <span data-ttu-id="258ec-311">7</span><span class="sxs-lookup"><span data-stu-id="258ec-311">7</span></span>               | <span data-ttu-id="258ec-312">2</span><span class="sxs-lookup"><span data-stu-id="258ec-312">2</span></span>          | <span data-ttu-id="258ec-313">2</span><span class="sxs-lookup"><span data-stu-id="258ec-313">2</span></span>           | <span data-ttu-id="258ec-314">2</span><span class="sxs-lookup"><span data-stu-id="258ec-314">2</span></span>         |
| <span data-ttu-id="258ec-315">8 или более</span><span class="sxs-lookup"><span data-stu-id="258ec-315">8 or more</span></span>       | <span data-ttu-id="258ec-316">2</span><span class="sxs-lookup"><span data-stu-id="258ec-316">2</span></span>          | <span data-ttu-id="258ec-317">2</span><span class="sxs-lookup"><span data-stu-id="258ec-317">2</span></span>           | <span data-ttu-id="258ec-318">2</span><span class="sxs-lookup"><span data-stu-id="258ec-318">2</span></span>         |



 

<span data-ttu-id="258ec-319">**Таблица 1.** Размеры LUT, используемые в алгоритме</span><span class="sxs-lookup"><span data-stu-id="258ec-319">**Table 1:** LUT sizes used in the algorithm</span></span>

<span data-ttu-id="258ec-320">Каждый открытый LUT может иметь различное количество шагов в каждом входном канале, а расположения выборки не должны иметь одинаковых пробелов.</span><span class="sxs-lookup"><span data-stu-id="258ec-320">Each open LUT can have a different number of steps in each input channel, and the sampling locations do not have to be equally spaced.</span></span> <span data-ttu-id="258ec-321">Для данного открытого LUT Стратум имеется связанное сочетание колорант, например, ![ содержит подстрочный индекс 1,..., c подстрочной буквой k.](images/transformcreation-image045.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-321">For a given open LUT stratum, there is an associated colorant combination, for example, ![Shows C subscript 1, ..., C subscript k.](images/transformcreation-image045.gif)</span></span> <span data-ttu-id="258ec-322">, где ![ содержит подстрочный знак C.](images/transformcreation-image047.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-322">, where the ![Shows C subscript i.](images/transformcreation-image047.gif)</span></span> <span data-ttu-id="258ec-323">— Это отдельные целые числа от 1 до *n*.</span><span class="sxs-lookup"><span data-stu-id="258ec-323">s are distinct integers between 1 and *n*.</span></span> <span data-ttu-id="258ec-324">Это индексы каналов, соответствующие "Active" колорантс в этом Strata.</span><span class="sxs-lookup"><span data-stu-id="258ec-324">They are the channel indices corresponding to the "active" colorants in this strata.</span></span>

<span data-ttu-id="258ec-325">Шаг 1. Отфильтруйте выведенный массив значений устройств, которые не содержатся в этом Strata.</span><span class="sxs-lookup"><span data-stu-id="258ec-325">STEP 1: Filter out the inputted array of device values that are not contained in this strata.</span></span> <span data-ttu-id="258ec-326">Значение устройства ![ показывает x-индекс 1, x-индекс 2,..., подстрочный индекс n.](images/transformcreation-image049.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-326">A device value ![Shows X subscript 1, X subscript 2, ..., X subscript n.](images/transformcreation-image049.gif)</span></span> <span data-ttu-id="258ec-327">содержится в Strata, только если ![ отображает набор значений для канала.](images/transformcreation-image051.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-327">is contained in the strata, if and only if ![Shows a set of values for a channel.](images/transformcreation-image051.gif)</span></span> <span data-ttu-id="258ec-328">и все остальные каналы равны 0.</span><span class="sxs-lookup"><span data-stu-id="258ec-328">and all other channels are 0.</span></span> <span data-ttu-id="258ec-329">Если в отфильтрованном наборе есть *N* записей, Let</span><span class="sxs-lookup"><span data-stu-id="258ec-329">If the filtered set has *N* entries, let</span></span>

![Показывает формулу, используемую, если отфильтрованный набор содержит N записей.](images/transformcreation-image053.png)

<span data-ttu-id="258ec-331">Для каждого </span><span class="sxs-lookup"><span data-stu-id="258ec-331">For each</span></span> ![Показывает, что i равно 1, 2,..., k.](images/transformcreation-image041.gif) <span data-ttu-id="258ec-333">, выполните следующие шаги 2-5.</span><span class="sxs-lookup"><span data-stu-id="258ec-333">, iterate the following steps 2-5:</span></span>

<span data-ttu-id="258ec-334">Шаг 2. Если ![ отображается подстрочный нижний индекс (k), равный 1.](images/transformcreation-image055.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-334">STEP 2: If ![Shows d subscript tentative (k) equal to 1.](images/transformcreation-image055.gif)</span></span> <span data-ttu-id="258ec-335">, SAMP *i* имеет только 1 точку, которая должна быть 1,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-335">, Samp *i* has only 1 point, which must be 1.0.</span></span> <span data-ttu-id="258ec-336">Перейти *к следующему.*</span><span class="sxs-lookup"><span data-stu-id="258ec-336">Move on to the next *i*.</span></span> <span data-ttu-id="258ec-337">В противном случае перейдите к ШАГУ 3.</span><span class="sxs-lookup"><span data-stu-id="258ec-337">Otherwise, continue to STEP 3.</span></span>

<span data-ttu-id="258ec-338">Шаг 3. Сортировка отфильтрованных образцов в возрастающем порядке в</span><span class="sxs-lookup"><span data-stu-id="258ec-338">STEP 3: Sort the filtered samples in ascending order in the</span></span> ![Показывает подстрочную i в C.](images/transformcreation-image047.gif) <span data-ttu-id="258ec-340">канал.</span><span class="sxs-lookup"><span data-stu-id="258ec-340">channel.</span></span>

<span data-ttu-id="258ec-341">Шаг 4. Определение сетки выборки "под вопросом" с помощью узлов</span><span class="sxs-lookup"><span data-stu-id="258ec-341">STEP 4: Define the "tentative" sampling grid using the nodes</span></span>

![Показывает узлы, используемые для определения сетки выборки "под вопросом".](images/transformcreation-image057.png)

<span data-ttu-id="258ec-343">where</span><span class="sxs-lookup"><span data-stu-id="258ec-343">where</span></span> ![Показывает j равно 1, 2,..., d подстрочный индекс под вопросом (k).](images/transformcreation-image059.gif) <span data-ttu-id="258ec-345">.</span><span class="sxs-lookup"><span data-stu-id="258ec-345">.</span></span>

<span data-ttu-id="258ec-346">Шаг 5. Регуларизе предварительную сетку, чтобы убедиться, что она соответствует ограниченному монотону, а также в том, что она заканчивается на 1,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-346">STEP 5: Regularize the tentative grid to ensure that it conforms with strict monotonicity and also that it ends with 1.0.</span></span> <span data-ttu-id="258ec-347">Поскольку массив уже отсортирован, узлы в предварительной сетке уже являются монотонными нондекреасинг.</span><span class="sxs-lookup"><span data-stu-id="258ec-347">Because the array is already sorted, the nodes in the tentative grid are already monotonic nondecreasing.</span></span> <span data-ttu-id="258ec-348">Однако соседние узлы могут быть идентичными.</span><span class="sxs-lookup"><span data-stu-id="258ec-348">However, adjacent nodes might be identical.</span></span> <span data-ttu-id="258ec-349">Это можно исправить, удалив идентичные узлы, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="258ec-349">You can fix this by removing identical nodes, if necessary.</span></span> <span data-ttu-id="258ec-350">Наконец, после выполнения этой процедуры, если конечная точка меньше 1,0, замените ее на 1,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-350">Finally, after this procedure, if the end point is less than 1.0, replace it with 1.0.</span></span>

<span data-ttu-id="258ec-351">Обратите внимание, что шаг 5 является причиной того, что LUT Strata может иметь различное количество шагов в каждом канале.</span><span class="sxs-lookup"><span data-stu-id="258ec-351">Note that STEP 5 is the reason that the LUT strata may have a different number of steps in each channel.</span></span> <span data-ttu-id="258ec-352">После этого число шагов в канале может быть меньше</span><span class="sxs-lookup"><span data-stu-id="258ec-352">After the regularization, the number of steps in a channel may be less than</span></span> ![Отображение d подстрочных индексов под вопросом (k).](images/transformcreation-image061.gif) <span data-ttu-id="258ec-354">.</span><span class="sxs-lookup"><span data-stu-id="258ec-354">.</span></span>

## <a name="interpolation"></a><span data-ttu-id="258ec-355">Интерполяции</span><span class="sxs-lookup"><span data-stu-id="258ec-355">Interpolation</span></span>

<span data-ttu-id="258ec-356">Вы можете создать соотношением Куба единицы, открыв LUT Strata и закрыв LUT Strata.</span><span class="sxs-lookup"><span data-stu-id="258ec-356">You can construct the stratification of the unit cube by open LUT strata and closed LUT strata.</span></span> <span data-ttu-id="258ec-357">Чтобы выполнить интерполяцию с помощью этой "разреженной LUT структуры", выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="258ec-357">To perform interpolation using this "sparse LUT structure," follow these steps.</span></span> <span data-ttu-id="258ec-358">Предполагается заданное значение входного устройства</span><span class="sxs-lookup"><span data-stu-id="258ec-358">Assume a given input device value</span></span> ![Показывает (X-индекс 1, X подстрочных и 2,..., X, подстрочность n).](images/transformcreation-image049.gif) <span data-ttu-id="258ec-360">.</span><span class="sxs-lookup"><span data-stu-id="258ec-360">.</span></span>

<span data-ttu-id="258ec-361">Шаг 1. Определение количества активных каналов.</span><span class="sxs-lookup"><span data-stu-id="258ec-361">STEP 1: Determine the number of "active" channels.</span></span> <span data-ttu-id="258ec-362">Это число ненулевых каналов.</span><span class="sxs-lookup"><span data-stu-id="258ec-362">This is the number of non-zero channels.</span></span> <span data-ttu-id="258ec-363">Это определяет Strata измерение *k* для поиска содержащего Стратум.</span><span class="sxs-lookup"><span data-stu-id="258ec-363">This determines the strata dimension *k* to search for the containing stratum.</span></span> <span data-ttu-id="258ec-364">Точнее, измерение Strata равно 3, если число активных каналов ![ отображается меньше или равно 3.](images/transformcreation-image063.gif)</span><span class="sxs-lookup"><span data-stu-id="258ec-364">More precisely, the strata dimension is 3 if the number of active channels is ![Shows less than or equal to 3.](images/transformcreation-image063.gif)</span></span> <span data-ttu-id="258ec-365">в противном случае измерение Strata будет таким же, как и число активных каналов.</span><span class="sxs-lookup"><span data-stu-id="258ec-365">, otherwise, the strata dimension is the same as the number of active channels.</span></span>

<span data-ttu-id="258ec-366">Шаг 2. в</span><span class="sxs-lookup"><span data-stu-id="258ec-366">STEP 2: Within</span></span> ![Показывает подстрочный индекс k.](images/transformcreation-image026.gif) <span data-ttu-id="258ec-368">, найдите содержащий Стратум.</span><span class="sxs-lookup"><span data-stu-id="258ec-368">, search for the containing stratum.</span></span> <span data-ttu-id="258ec-369">Значение устройства содержится в открытом Стратум, если все каналы, соответствующие Стратум, имеют ненулевое значение, а все остальные каналы равны нулю.</span><span class="sxs-lookup"><span data-stu-id="258ec-369">A device value is contained in an open stratum if all the channels corresponding to the stratum have non-zero value, and all other channels are zero.</span></span> <span data-ttu-id="258ec-370">Значение устройства содержится в закрытом Стратум, если каждый канал, не представленный Стратум, равен нулю.</span><span class="sxs-lookup"><span data-stu-id="258ec-370">A device value is contained in a closed stratum if every channel not represented by the stratum is zero.</span></span> <span data-ttu-id="258ec-371">Если не найдено ни одного содержащего Стратум, возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="258ec-371">If no containing stratum is found, there is an error condition.</span></span> <span data-ttu-id="258ec-372">Отменяет и сообщайте об ошибке.</span><span class="sxs-lookup"><span data-stu-id="258ec-372">Cancel and report failure.</span></span> <span data-ttu-id="258ec-373">Если найден объект, содержащий Стратум, перейдите к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="258ec-373">If a containing stratum is found, proceed to the next step.</span></span>

<span data-ttu-id="258ec-374">Шаг 3. Если объект, содержащий Стратум, закрыт, то интерполяция в Стратум может выполняться любым известным алгоритмом интерполяции.</span><span class="sxs-lookup"><span data-stu-id="258ec-374">STEP 3: If the containing stratum is closed, then interpolation within the stratum can be done by any known interpolation algorithm.</span></span> <span data-ttu-id="258ec-375">В этой реализации для выбора алгоритма используется тетрахедрал интерполяция.</span><span class="sxs-lookup"><span data-stu-id="258ec-375">In this implementation, the choice of algorithm is tetrahedral interpolation.</span></span> <span data-ttu-id="258ec-376">Если объект, содержащий Стратум, открыт, а значение устройства находится строго в пределах Стратум, то есть</span><span class="sxs-lookup"><span data-stu-id="258ec-376">If the containing stratum is open, and the device value lies strictly within the stratum, that is,</span></span>

<span data-ttu-id="258ec-377">![Показывает X, нижний индекс, который больше или равен... ](images/transformcreation-image065.gif) Первый узел в *i* -ом канале</span><span class="sxs-lookup"><span data-stu-id="258ec-377">![Shows X subscript i greater than or equal to...](images/transformcreation-image065.gif) first node in *i* th channel</span></span>

<span data-ttu-id="258ec-378">где *i* является индексом канала для Стратум, то работает стандартный алгоритм интерполяции, например тетрахедрал интерполяцию.</span><span class="sxs-lookup"><span data-stu-id="258ec-378">where *i* is a channel index for the stratum, then standard interpolation algorithm, such as tetrahedral interpolation, works.</span></span>

<span data-ttu-id="258ec-379">Если этот ![ ](images/transformcreation-image067.gif) параметр имеет значение X, а не первый узел в *i* -й канале, то в качестве значения устройства попадают «зазор» между Стратум и более низкими размерами.</span><span class="sxs-lookup"><span data-stu-id="258ec-379">If ![Shows X subscript i less than...](images/transformcreation-image067.gif) first node in *i* th channel for some *i*, then the device value falls into the "gap" between the stratum and the lower dimensional subspaces.</span></span> <span data-ttu-id="258ec-380">Этот мои не имеет дело с алгоритмом интерполяции на SE, поэтому любой алгоритм интерполяции можно использовать для интерполяции в этом «пропуске», хотя Предпочтительный алгоритм — это следующая ограниченная интерполяция.</span><span class="sxs-lookup"><span data-stu-id="258ec-380">This MOI is not concerned with an interpolation algorithm per se, so any interpolation algorithm can be used to interpolate within this "gap," although the preferred algorithm is the following transfinite interpolation.</span></span>

<span data-ttu-id="258ec-381">Архитектура модуля интерполяции показана в двух частях рис. 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-381">The architecture of the interpolation module is illustrated in the two parts of Figure 1.</span></span>

![Схема, которая показывает часть одной из архитектур модуля интерполяции.](images/transformcreation-image068.png)

![На схеме показана вторая часть архитектуры модуля интерполяции.](images/transformcreation-image070.png)

<span data-ttu-id="258ec-384">**Рис. 1.** Архитектура модуля интеполатион</span><span class="sxs-lookup"><span data-stu-id="258ec-384">**Figure 1:** Intepolation module architecture</span></span>

<span data-ttu-id="258ec-385">Как упоминалось ранее, этот алгоритм способен достичь достаточно плотной выборки в регионах пространства устройства, которые содержат важное сочетание колорантс, и свести к минимуму общий размер Лутс.</span><span class="sxs-lookup"><span data-stu-id="258ec-385">As explained earlier, this algorithm is able to achieve reasonably dense sampling in regions of the device space that contain important combination of colorants, while minimizing the total size of LUTs needed.</span></span> <span data-ttu-id="258ec-386">В следующей таблице показано сравнение количества узлов, необходимых для разреженной LUT реализации (с использованием алгоритма \# 1 и обычного режима) и соответствующей единообразной реализации LUT.</span><span class="sxs-lookup"><span data-stu-id="258ec-386">The following table shows a comparison of the number of nodes needed for the sparse LUT implementation (using Algorithm \#1 and normal mode) and the corresponding uniform LUT implementation.</span></span>



| <span data-ttu-id="258ec-387">**Число входных каналов**</span><span class="sxs-lookup"><span data-stu-id="258ec-387">**Number of input channels**</span></span> | <span data-ttu-id="258ec-388">**Разреженные LUT**</span><span class="sxs-lookup"><span data-stu-id="258ec-388">**Sparse LUT**</span></span> | <span data-ttu-id="258ec-389">**Унифицированный LUT**</span><span class="sxs-lookup"><span data-stu-id="258ec-389">**Uniform LUT**</span></span> |
|------------------------------|----------------|-----------------|
| <span data-ttu-id="258ec-390">5</span><span class="sxs-lookup"><span data-stu-id="258ec-390">5</span></span>                            | <span data-ttu-id="258ec-391">142498</span><span class="sxs-lookup"><span data-stu-id="258ec-391">142498</span></span>         | <span data-ttu-id="258ec-392">1419857</span><span class="sxs-lookup"><span data-stu-id="258ec-392">1419857</span></span>         |
| <span data-ttu-id="258ec-393">6</span><span class="sxs-lookup"><span data-stu-id="258ec-393">6</span></span>                            | <span data-ttu-id="258ec-394">217582</span><span class="sxs-lookup"><span data-stu-id="258ec-394">217582</span></span>         | <span data-ttu-id="258ec-395">24137567</span><span class="sxs-lookup"><span data-stu-id="258ec-395">24137567</span></span>        |
| <span data-ttu-id="258ec-396">7</span><span class="sxs-lookup"><span data-stu-id="258ec-396">7</span></span>                            | <span data-ttu-id="258ec-397">347444</span><span class="sxs-lookup"><span data-stu-id="258ec-397">347444</span></span>         | <span data-ttu-id="258ec-398">410338673</span><span class="sxs-lookup"><span data-stu-id="258ec-398">410338673</span></span>       |
| <span data-ttu-id="258ec-399">8</span><span class="sxs-lookup"><span data-stu-id="258ec-399">8</span></span>                            | <span data-ttu-id="258ec-400">559618</span><span class="sxs-lookup"><span data-stu-id="258ec-400">559618</span></span>         | <span data-ttu-id="258ec-401">6975757441</span><span class="sxs-lookup"><span data-stu-id="258ec-401">6975757441</span></span>      |



 

## <a name="interpolation-within-a-unit-cube"></a><span data-ttu-id="258ec-402">Интерполяция внутри единичного Куба</span><span class="sxs-lookup"><span data-stu-id="258ec-402">Interpolation within a unit cube</span></span>

<span data-ttu-id="258ec-403">Базовым шагом в случае прямоугольной сетки является интерполяция внутри окружающей ячейки.</span><span class="sxs-lookup"><span data-stu-id="258ec-403">A basic step in the case of rectangular grid is interpolation within an enclosing cell.</span></span> <span data-ttu-id="258ec-404">Для входной точки можно легко определить окружающую ячейку.</span><span class="sxs-lookup"><span data-stu-id="258ec-404">For an input point, you can determine the enclosing cell easily.</span></span> <span data-ttu-id="258ec-405">В прямоугольной сетке указано выходное значение в каждой из вершин (угловых точек) заданной ячейки.</span><span class="sxs-lookup"><span data-stu-id="258ec-405">In a rectangular grid, the output value at each of the vertices (corner points) of the enclosing cell is specified.</span></span> <span data-ttu-id="258ec-406">Они также являются единственными условиями границ (BCs), которым должен соответствовать интерполант: интерполант должен пройти все эти точки.</span><span class="sxs-lookup"><span data-stu-id="258ec-406">They are also the only boundary conditions (BCs) that an interpolant must satisfy: The interpolant must pass through all these points.</span></span> <span data-ttu-id="258ec-407">Обратите внимание, что эти граничные условия относятся к дискретным точкам, в данном случае 2N угловые точки ячейки, где n — это измерение цветового пространства.</span><span class="sxs-lookup"><span data-stu-id="258ec-407">Note that these boundary conditions are on "discrete" points, in this case the 2n corner points of the cell, where n is the dimension of the color space.</span></span>

<span data-ttu-id="258ec-408">Перед переходом полезно вынести концепцию граничных условий.</span><span class="sxs-lookup"><span data-stu-id="258ec-408">It is useful to formalize the concept of boundary conditions before moving on.</span></span> <span data-ttu-id="258ec-409">Для любого подмножества из границы окружающей ячейки (Куба единицы измерения в n измерений) условие границы в S является спецификацией функции BC: S → RM, где m — выходное измерение.</span><span class="sxs-lookup"><span data-stu-id="258ec-409">For any subset S of the boundary of the enclosing cell (the unit cube in n dimensions), a boundary condition on S is a specification of a function BC: S → Rm, where m is the output dimension.</span></span> <span data-ttu-id="258ec-410">Иными словами, интерполант, который может быть отмечен интерп: \[ 0, 1 \] n → RM, должен соответствовать следующим требованиям: интерп (x) = BC (x) для всех x в S.</span><span class="sxs-lookup"><span data-stu-id="258ec-410">In other words, an interpolant, which may be denoted Interp: \[0,1\]n→ Rm, is required to satisfy: Interp(x) = BC(x) for all x in S.</span></span>

<span data-ttu-id="258ec-411">В стандартном сценарии интерполяции в Кубе единиц измерения — это набор дискретных точек, которые являются вершинами 2N Куба.</span><span class="sxs-lookup"><span data-stu-id="258ec-411">In the standard scenario of interpolation on the unit cube, S is the set of discrete points that are the 2n vertices of the cube.</span></span>

<span data-ttu-id="258ec-412">Теперь можно обобщить граничные условия, чтобы решить проблемы, описанные выше, и предоставить новый алгоритм интерполяции в Кубе единицы.</span><span class="sxs-lookup"><span data-stu-id="258ec-412">You can now generalize the boundary conditions to solve the issues described earlier and provide a new interpolation algorithm within the unit cube.</span></span> <span data-ttu-id="258ec-413">Вместо того чтобы разрешать только дискретные точки границ, можно налагать граничные условия на всю границу в Кубе.</span><span class="sxs-lookup"><span data-stu-id="258ec-413">Instead of allowing only discrete boundary points, boundary conditions can be imposed on a whole boundary face of the cube.</span></span> <span data-ttu-id="258ec-414">Ниже приведены точные предположения.</span><span class="sxs-lookup"><span data-stu-id="258ec-414">The precise assumptions are as follows:</span></span>

<span data-ttu-id="258ec-415">(a) точка VN = (1, 1,..., 1) является специальной, и допускается только дискретное условие границы.</span><span class="sxs-lookup"><span data-stu-id="258ec-415">(a) The point vn =(1,1,…,1) is special and only a discrete boundary condition is allowed.</span></span> <span data-ttu-id="258ec-416">Иными словами, ни одно из постоянных границ не может быть наложено на n границ, равное XI = 1 (i = 1,..., n).</span><span class="sxs-lookup"><span data-stu-id="258ec-416">In other words, no continuous boundary conditions can be imposed on the n boundary faces xi=1 (i=1,…,n).</span></span>

<span data-ttu-id="258ec-417">(б) для каждого из оставшихся n границ, равных 0 (i = 1,..., n), условие границы может быть наложено на всю грань, с условием совместимости, которое при пересечении двух фрагментов не должно быть согласовано с пересечением.</span><span class="sxs-lookup"><span data-stu-id="258ec-417">(b) For each of the remaining n boundary faces xi=0 (i=1,…,n), boundary condition can be imposed on the whole face, with the compatibility condition that if two faces intersect, the boundary conditions on the faces should agree on the intersection.</span></span>

<span data-ttu-id="258ec-418">(c) все вершины, не содержащиеся в гранях с условием границы, будут иметь отдельное (дискретное) условие границы.</span><span class="sxs-lookup"><span data-stu-id="258ec-418">(c) Any vertices not contained in the faces with boundary condition will have an individual (discrete) boundary condition.</span></span>

<span data-ttu-id="258ec-419">Можно ссылаться на дискретное условие границы в качестве конечных данных и непрерывное условие границы в качестве изолированных данных в обсуждении интерполяции конечных и ограниченных данных.</span><span class="sxs-lookup"><span data-stu-id="258ec-419">You can refer to a discrete boundary condition as finite data, and a continuous boundary condition as transfinite data in discussing interpolation on finite and transfinite data.</span></span>

<span data-ttu-id="258ec-420">Во-первых, проверьте стандартную интерполяцию тетрахедрал (например, используемую в патентах Сакамото), которая помогает установить нотации для этого конкретного формулировку проблемы.</span><span class="sxs-lookup"><span data-stu-id="258ec-420">First, review the standard tetrahedral interpolation (such as that used in Sakamoto's patent) which helps set the notations for this particular formulation of the problem.</span></span> <span data-ttu-id="258ec-421">Известно, что куб единицы \[ 0, 1 \] n можно разделить на n!</span><span class="sxs-lookup"><span data-stu-id="258ec-421">It is known that the unit cube \[0,1\]n can be subdivided into n!</span></span> <span data-ttu-id="258ec-422">тетрахедра, параметризованный набором перестановок на n символов.</span><span class="sxs-lookup"><span data-stu-id="258ec-422">tetrahedra, parameterized by the set of permutations on n symbols.</span></span> <span data-ttu-id="258ec-423">В частности, каждый такой тетрахедрон определяется неравенствами.</span><span class="sxs-lookup"><span data-stu-id="258ec-423">More specifically, each such tetrahedron is defined by inequalities</span></span>

![Показывает формулу для инекуалитес тетрахедронс.](images/transformcreation-image073.gif)

<span data-ttu-id="258ec-425">где σ: {1, 2,.., n} > {1, 2,..., n} — это перестановка "Symbols" 1, 2,..., n, т. е. это бижективе сопоставление набора n символов.</span><span class="sxs-lookup"><span data-stu-id="258ec-425">where σ:{1,2,..,n}→{1,2,…,n} is a permutation of "symbols" 1, 2, …, n, that is, it is a bijective mapping of the set of n symbols.</span></span> <span data-ttu-id="258ec-426">Например, если n = 3 и σ = (3, 2, 1), то есть σ (1) = 3, σ (2) = 2, σ (3) = 1, соответствующий тетрахедрон определяется z ≥ x, где для x1, x2, X3 используется стандартная нотация x, y, z.</span><span class="sxs-lookup"><span data-stu-id="258ec-426">For example, if n = 3 and σ = (3, 2, 1), meaning σ(1)=3, σ(2)=2, σ(3)=1, then the corresponding tetrahedron is defined by z≥y≥x, where the common notation x, y, z is used for x1, x2, x3.</span></span> <span data-ttu-id="258ec-427">Обратите внимание, что эти тетрахедронс не являются отсоединенными друг от друга.</span><span class="sxs-lookup"><span data-stu-id="258ec-427">Note that these tetrahedrons are not disjoint from each other.</span></span> <span data-ttu-id="258ec-428">Для интерполяции точки, которые полагаются на общее лицо двух различных тетрахедронс, будут иметь одинаковое значение интерполяции независимо от того, какой тетрахедрон используется в интерполяции.</span><span class="sxs-lookup"><span data-stu-id="258ec-428">For the purpose of interpolation, points lying on a common face of two distinct tetrahedrons will have the same interpolation value regardless of which tetrahedron is used in the interpolation.</span></span> <span data-ttu-id="258ec-429">По-прежнему, в стандартном сценарии интерполяции в конечных точках для заданной входной точки (x1,..., xn), сначала определяется, в какой тетрахедрон он входит, или аналогично соответствующая σ перестановки, а тетрахедрал интерполант определяется как</span><span class="sxs-lookup"><span data-stu-id="258ec-429">Still, in the standard scenario of interpolating on finite points, for a given input point (x1, …, xn), first determine which tetrahedron it lies in, or equivalently, the corresponding permutation σ, then the tetrahedral interpolant is defined as</span></span>

![Показывает уравнение, определяющее тетрахедрал интерполант.](images/transformcreation-image075.png)

<span data-ttu-id="258ec-431">where</span><span class="sxs-lookup"><span data-stu-id="258ec-431">where</span></span> ![Показывает уравнение для стандартных векторов.](images/transformcreation-image077.png) <span data-ttu-id="258ec-433">для i = 1,..., n и E1,..., EN — это стандартные векторы.</span><span class="sxs-lookup"><span data-stu-id="258ec-433">for i=1, …, n, and e1, …, en are the standard basis vectors.</span></span> <span data-ttu-id="258ec-434">Прежде чем перейти к обобщением, обратите внимание, что v0, v1,..., VN являются вершинами тетрахедрон и</span><span class="sxs-lookup"><span data-stu-id="258ec-434">Before moving on to the generalization, note that v0, v1, …, vn are the vertices of the tetrahedron, and</span></span> ![Показывает координаты барицентрик.](images/transformcreation-image079.png) <span data-ttu-id="258ec-436">— Это «барицентрик координаты».</span><span class="sxs-lookup"><span data-stu-id="258ec-436">are the "barycentric coordinates."</span></span>

<span data-ttu-id="258ec-437">В общем случае BCs на граничных лицах можно использовать концепцию барицентрик проекции.</span><span class="sxs-lookup"><span data-stu-id="258ec-437">For the general case of BCs on boundary faces, you can use the concept of barycentric projection.</span></span> <span data-ttu-id="258ec-438">Как и ранее, для заданной входной точки (x1,..., xn) сначала определяется, в каком тетрахедрон он находится, или аналогично соответствующая σ перестановки.</span><span class="sxs-lookup"><span data-stu-id="258ec-438">As before, for a given input point (x1, …, xn), first determine in which tetrahedron it lies, or equivalently, the corresponding permutation σ.</span></span> <span data-ttu-id="258ec-439">Затем выполните ряд проекций барицентрик, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="258ec-439">Then perform a series of barycentric projections, as follows.</span></span> <span data-ttu-id="258ec-440">Первая проекция</span><span class="sxs-lookup"><span data-stu-id="258ec-440">The first projection</span></span> ![Показывает Бпрож подстрочный 1 (x).](images/transformcreation-image081.gif) <span data-ttu-id="258ec-442">отправляет точку на плоскость</span><span class="sxs-lookup"><span data-stu-id="258ec-442">sends the point to the plane</span></span> ![Показывает значение индекса X Дельта (1), равное 0.](images/transformcreation-image083.gif) <span data-ttu-id="258ec-444">иное</span><span class="sxs-lookup"><span data-stu-id="258ec-444">unless</span></span> ![Показывает X равным V индексу n.](images/transformcreation-image085.gif) <span data-ttu-id="258ec-446">в этом случае он не изменяется.</span><span class="sxs-lookup"><span data-stu-id="258ec-446">in which case it is not changed.</span></span> <span data-ttu-id="258ec-447">Точное определение Map Бпрож определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="258ec-447">The precise definition of the map BProj is defined as follows:</span></span>

![Показывает уравнение для точного определения Бпрожа Map.](images/transformcreation-image087.png)

<span data-ttu-id="258ec-449">на</span><span class="sxs-lookup"><span data-stu-id="258ec-449">with</span></span> ![Показывает уравнение для P надстрочного знака k.](images/transformcreation-image089.png) <span data-ttu-id="258ec-451">и k = 1, 2,..., n.</span><span class="sxs-lookup"><span data-stu-id="258ec-451">and k = 1, 2, …, n.</span></span>

<span data-ttu-id="258ec-452">В случае</span><span class="sxs-lookup"><span data-stu-id="258ec-452">In the case</span></span> ![Показывает X равным V индексу n.](images/transformcreation-image085.gif) <span data-ttu-id="258ec-454">, можно приостанавливаться, поскольку BC определяется в VN с помощью предположения (a).</span><span class="sxs-lookup"><span data-stu-id="258ec-454">, you can stop, because BC is defined at vn by Assumption (a).</span></span> <span data-ttu-id="258ec-455">В случае</span><span class="sxs-lookup"><span data-stu-id="258ec-455">In the case</span></span> ![Показывает, что X не равно V индексу n.](images/transformcreation-image091.gif) <span data-ttu-id="258ec-457">, ясно, что</span><span class="sxs-lookup"><span data-stu-id="258ec-457">, it is clear that</span></span> ![Показывает Бпрож подстрочный 1 (X).](images/transformcreation-image081.gif) <span data-ttu-id="258ec-459">имеет σ (1) a-й компонент аннихилатед.</span><span class="sxs-lookup"><span data-stu-id="258ec-459">has the σ(1)th component annihilated.</span></span> <span data-ttu-id="258ec-460">Иными словами, он находится на одном из граничных граней.</span><span class="sxs-lookup"><span data-stu-id="258ec-460">In other words, it is on one of boundary faces.</span></span> <span data-ttu-id="258ec-461">Либо он находится на лицевой стороне, на которой определен BC. в этом случае вы можете приостанавливаться или выполнить другую проекцию барицентрик.</span><span class="sxs-lookup"><span data-stu-id="258ec-461">Either it is on a face on which BC is defined, in which case you can stop, or you perform another barycentric projection</span></span> ![Показывает Бпрож индекс 2 (X).](images/transformcreation-image093.gif) <span data-ttu-id="258ec-463">where</span><span class="sxs-lookup"><span data-stu-id="258ec-463">where</span></span> ![Показывает X "равно Бпрож подстрочному индексу 1 (X).](images/transformcreation-image095.gif) <span data-ttu-id="258ec-465">.</span><span class="sxs-lookup"><span data-stu-id="258ec-465">.</span></span> <span data-ttu-id="258ec-466">И если</span><span class="sxs-lookup"><span data-stu-id="258ec-466">And if</span></span> ![Показывает X ' ' = Бпрож подстрочный 1 (X ').](images/transformcreation-image097.gif) <span data-ttu-id="258ec-468&quot;>находится на лицевой стороне, на которой определен BC, можно приостанавливаться. в противном случае выполните еще одну проекцию</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;258ec-468&quot;>is on a face on which BC is defined, you can stop; otherwise, perform yet another projection</span></span> ![Показывает Бпрож индекс 3 (X &quot;").](images/transformcreation-image099.gif) <span data-ttu-id="258ec-470">.</span><span class="sxs-lookup"><span data-stu-id="258ec-470">.</span></span> <span data-ttu-id="258ec-471">Так как каждая проекция аннихилатес один компонент, эффективное измерение уменьшается, поэтому вы узнаете, что процесс должен останавливаться в конечном итоге.</span><span class="sxs-lookup"><span data-stu-id="258ec-471">Because every projection annihilates one component, the effective dimension decreases, so you know the process must eventually stop.</span></span> <span data-ttu-id="258ec-472">В худшем случае вы выполняете n проекций в измерение 0, то есть вершины в Кубе, которые в соответствии с предположением (c), вам известно, что будет определено BC.</span><span class="sxs-lookup"><span data-stu-id="258ec-472">In the worst case scenario, you perform n projections down to dimension 0, that is, vertices on the cube, which according to Assumption (c), you know BC will be defined on.</span></span>

<span data-ttu-id="258ec-473">Если предположить, что были выполнены проекции, с</span><span class="sxs-lookup"><span data-stu-id="258ec-473">Assuming that K projections have been performed, with</span></span>

![Показывает формулу, используемую при условии, что была выполнена проекция.](images/transformcreation-image101.png)

<span data-ttu-id="258ec-475">x (0) = x, точка входа и BC определены в x (k).</span><span class="sxs-lookup"><span data-stu-id="258ec-475">x(0)= x, the input point, and BC is defined at x(k).</span></span> <span data-ttu-id="258ec-476">Затем прокрутить проекции, определив ряд выходных векторов:</span><span class="sxs-lookup"><span data-stu-id="258ec-476">Then unwind the projections by defining a series of output vectors:</span></span>

![Показывает уравнения для ряда выходных векторов.](images/transformcreation-image103.png)

<span data-ttu-id="258ec-478">where</span><span class="sxs-lookup"><span data-stu-id="258ec-478">where</span></span> ![Показывает уравнение для надстрочного знака Y (K).](images/transformcreation-image105.gif) <span data-ttu-id="258ec-480">и, наконец, вы получаете ответ</span><span class="sxs-lookup"><span data-stu-id="258ec-480">, and you finally obtain the answer</span></span>

![Показывает интерп (x), равный надстрочными знакам y (0).](images/transformcreation-image107.gif)

## <a name="worked-example"></a><span data-ttu-id="258ec-482">Пример</span><span class="sxs-lookup"><span data-stu-id="258ec-482">Worked example</span></span>

![Схема, на которой показан пример интерполяции с кубом единицы.](images/transformcreation-image108.png)

<span data-ttu-id="258ec-484">**Рис. 2.** Пример "работает"</span><span class="sxs-lookup"><span data-stu-id="258ec-484">**Figure 2:** Worked example</span></span>

<span data-ttu-id="258ec-485">Рассмотрим ситуацию, показанную на рис. 2, где n = 3, m = 1, и у вас есть следующий BCs:</span><span class="sxs-lookup"><span data-stu-id="258ec-485">Consider the situation depicted in Figure 2, where n = 3, m = 1, and you have the following BCs:</span></span>

<span data-ttu-id="258ec-486">(a) четыре дискретных BCs в вершинах</span><span class="sxs-lookup"><span data-stu-id="258ec-486">(a) Four discrete BCs on the vertices</span></span>

<span data-ttu-id="258ec-487">(0, 0, 1): β001</span><span class="sxs-lookup"><span data-stu-id="258ec-487">(0, 0, 1): β001</span></span>

<span data-ttu-id="258ec-488">(0, 1, 1): β011</span><span class="sxs-lookup"><span data-stu-id="258ec-488">(0, 1, 1): β011</span></span>

<span data-ttu-id="258ec-489">(1, 0, 1): β 101</span><span class="sxs-lookup"><span data-stu-id="258ec-489">(1, 0, 1): β101</span></span>

<span data-ttu-id="258ec-490">(1, 1, 1): β 111</span><span class="sxs-lookup"><span data-stu-id="258ec-490">(1, 1, 1): β111</span></span>

<span data-ttu-id="258ec-491">(b) непрерывный BC на лицевой стороне X3 = 0: F (x1, x2)</span><span class="sxs-lookup"><span data-stu-id="258ec-491">(b) A continuous BC on the face x3=0: F(x1, x2)</span></span>

<span data-ttu-id="258ec-492">Вычисление \# 1. точка ввода x = (0,8, 0,5, 0,2).</span><span class="sxs-lookup"><span data-stu-id="258ec-492">Computation \#1: Input point x = (0.8, 0.5, 0.2).</span></span> <span data-ttu-id="258ec-493">Включающий тетрахедрон связывается с перестановкой &lt; 1, 2, 3 &gt; .</span><span class="sxs-lookup"><span data-stu-id="258ec-493">The enclosing tetrahedron is associated with the permutation &lt;1, 2, 3&gt;.</span></span>

<span data-ttu-id="258ec-494">1-я проекция:</span><span class="sxs-lookup"><span data-stu-id="258ec-494">1st projection:</span></span> ![Показывает уравнение для первой проекции.](images/transformcreation-image110.png)

<span data-ttu-id="258ec-496">Это уже находится на стороне X3 = 0, поэтому вы можете приостанавливаться.</span><span class="sxs-lookup"><span data-stu-id="258ec-496">This is already on the face x3=0, so you can stop.</span></span> <span data-ttu-id="258ec-497">Затем обратная подстановка дает</span><span class="sxs-lookup"><span data-stu-id="258ec-497">Backward substitution then gives</span></span>

![Показывает ответ для первой проекции.](images/transformcreation-image112.png) <span data-ttu-id="258ec-499">ответ.</span><span class="sxs-lookup"><span data-stu-id="258ec-499">which is the answer.</span></span>

<span data-ttu-id="258ec-500">Вычисление \# 2. точка ввода x = (0,2, 0,5, 0,8).</span><span class="sxs-lookup"><span data-stu-id="258ec-500">Computation \#2 : Input point x = (0.2, 0.5, 0.8).</span></span> <span data-ttu-id="258ec-501">Включающий тетрахедрон связывается с перестановкой &lt; 3, 2, 1 &gt; .</span><span class="sxs-lookup"><span data-stu-id="258ec-501">The enclosing tetrahedron is associated with the permutation &lt;3, 2, 1&gt;.</span></span>

<span data-ttu-id="258ec-502">1-я проекция:</span><span class="sxs-lookup"><span data-stu-id="258ec-502">1st projection:</span></span> ![Показывает уравнение для первой проекции вычисления 2.](images/transformcreation-image113.png)

<span data-ttu-id="258ec-504">вторая проекция:</span><span class="sxs-lookup"><span data-stu-id="258ec-504">2nd projection:</span></span> ![Показывает уравнение для второй проекции вычисления 2.](images/transformcreation-image115.png)

<span data-ttu-id="258ec-506">Третья проекция:</span><span class="sxs-lookup"><span data-stu-id="258ec-506">3rd projection:</span></span> ![Показывает уравнение для третьей проекции вычисления 2.](images/transformcreation-image117.png) <span data-ttu-id="258ec-508">, который находится на стороне X3 = 0.</span><span class="sxs-lookup"><span data-stu-id="258ec-508">, which is on the face x3=0.</span></span> <span data-ttu-id="258ec-509">Затем обратная подстановка дает</span><span class="sxs-lookup"><span data-stu-id="258ec-509">Backward substitution then gives</span></span>

![Показывает первые два уравнения для обратной подстановки.](images/transformcreation-image119.png)

![Показывает Третье уравнение для обратной подстановки.](images/transformcreation-image123.png)<span data-ttu-id="258ec-512">, который является окончательным ответом.</span><span class="sxs-lookup"><span data-stu-id="258ec-512">, which is the final answer.</span></span>

## <a name="applications"></a><span data-ttu-id="258ec-513">Приложения</span><span class="sxs-lookup"><span data-stu-id="258ec-513">Applications</span></span>

<span data-ttu-id="258ec-514">*(a) последовательная Тетрахедрал интерполяция*</span><span class="sxs-lookup"><span data-stu-id="258ec-514">*(a) Sequential Tetrahedral Interpolation*</span></span>

![Схема, показывающая последовательную интерполяцию тетрахедрал.](images/transformcreation-image124.png)

<span data-ttu-id="258ec-516">**Рис. 3.** Последовательная тетрахедрал интерполяция</span><span class="sxs-lookup"><span data-stu-id="258ec-516">**Figure 3:** Sequential tetrahedral interpolation</span></span>

<span data-ttu-id="258ec-517">См. рис. 3.</span><span class="sxs-lookup"><span data-stu-id="258ec-517">Refer to Figure 3.</span></span> <span data-ttu-id="258ec-518">Чтобы выполнить интерполяцию между двумя плоскостями, на которых были наложены несовместимые сетки, рассмотрим ячейку, включающую заданную точку P, показанную на рисунке.</span><span class="sxs-lookup"><span data-stu-id="258ec-518">To interpolate between two planes on which incompatible grids have been imposed, consider a cell enclosing a given point P shown in the figure.</span></span> <span data-ttu-id="258ec-519">Верхние вершины ячейки поступают непосредственно из сетки в верхней плоскости.</span><span class="sxs-lookup"><span data-stu-id="258ec-519">The "top" vertices of the cell come directly from the grid in the top plane.</span></span> <span data-ttu-id="258ec-520">Вершины в нижней части не совместимы с сеткой в нижней плоскости, поэтому вся грань обрабатывается как BC с значениями, полученными с помощью интерполяции на сетке в нижней плоскости.</span><span class="sxs-lookup"><span data-stu-id="258ec-520">The vertices in the bottom face are not compatible with the grid in the bottom plane, so the whole face is treated as having a BC with values obtained by interpolation on the grid in the bottom plane.</span></span> <span data-ttu-id="258ec-521">Затем он ясно, что эта программа установки удовлетворяет предположениям (a), (b) и (c) выше, и вы можете применить алгоритм интерполяции.</span><span class="sxs-lookup"><span data-stu-id="258ec-521">It is then clear that this setup satisfies Assumptions (a), (b), and (c) above, and you can apply the interpolation algorithm.</span></span>

<span data-ttu-id="258ec-522">Также ясно, что алгоритм уменьшил измерение проблемы интерполяции на 1, поскольку результат представляет собой линейное сочетание значений в вершинах в верхней сетке и интерполяцию в нижней плоскости, у которой измерение меньше 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-522">It is also clear that the algorithm has reduced the dimension of the interpolation problem by 1, because the result is a linear combination of values at the vertices in the upper grid, and interpolation in the lower plane, which has dimension less 1.</span></span> <span data-ttu-id="258ec-523">Если в нижней плоскости существует аналогичная конфигурация плоскости, можно применить эту процедуру в этой плоскости, еще более уменьшая измерение на 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-523">If a similar sandwiching plane configuration exists in the lower plane, you can apply the procedure in that plane, further reducing the dimension by 1.</span></span> <span data-ttu-id="258ec-524">Эта процедура может продолжаться до тех пор, пока не будет достигнуто измерение 0.</span><span class="sxs-lookup"><span data-stu-id="258ec-524">This procedure can continue until you reach dimension 0.</span></span> <span data-ttu-id="258ec-525">Этот Каскад проекций и интерполяции можно назвать «последовательной Тетрахедрал интерполяцией».</span><span class="sxs-lookup"><span data-stu-id="258ec-525">This cascade of projections and interpolations can be called "Sequential Tetrahedral Interpolation."</span></span>

<span data-ttu-id="258ec-526">*(б) интерполяция зазоров*</span><span class="sxs-lookup"><span data-stu-id="258ec-526">*(b) Gap Interpolation*</span></span>

![Схема, в которой показана интерполяция зазоров.](images/transformcreation-image126.jpg)

<span data-ttu-id="258ec-528">**Рис. 4.** Интерполяция зазоров</span><span class="sxs-lookup"><span data-stu-id="258ec-528">**Figure 4:** Gap interpolation</span></span>

<span data-ttu-id="258ec-529">Это сетка, накладываемая на куб, расположенный строго внутри положительного квадранта.</span><span class="sxs-lookup"><span data-stu-id="258ec-529">This is a grid imposed on a cube sitting strictly inside the positive quadrant.</span></span> <span data-ttu-id="258ec-530">Сам куб содержит сетку, и у каждой плоскости координат есть сетки, которые не обязательно являются совместимыми.</span><span class="sxs-lookup"><span data-stu-id="258ec-530">The cube itself has a grid on it, and each coordinate plane has grids that are not necessarily compatible.</span></span> <span data-ttu-id="258ec-531">«Зазор» между кубом и плоскостями координат имеет кросс-участок, который является «L-фигурой» и не податлива со стандартными методами.</span><span class="sxs-lookup"><span data-stu-id="258ec-531">The "gap" between the cube and the coordinate planes has a cross-section that is "L-shaped" and is not amenable to standard techniques.</span></span> <span data-ttu-id="258ec-532">Тем не менее, с помощью появившегося метода можно легко добавить ячейки, охватывающие этот зазор.</span><span class="sxs-lookup"><span data-stu-id="258ec-532">However, with the technique introduced here, you can easily introduce cells that cover this gap.</span></span> <span data-ttu-id="258ec-533">На рисунке 4 изображен один из этих элементов.</span><span class="sxs-lookup"><span data-stu-id="258ec-533">Figure 4 depicts one of these.</span></span> <span data-ttu-id="258ec-534">Сетки на плоскостях координат поддерживают интерполяцию, которая предоставляет необходимые службы BCs для всех нижних граней ячейки, с одной оставшейся вершиной, BC которой обеспечивается в нижнем углу Куба.</span><span class="sxs-lookup"><span data-stu-id="258ec-534">The grids on the coordinate planes support interpolation that provides the necessary BCs for all the bottom faces of the cell, with one remaining vertex whose BC is provided by the lower corner of the cube.</span></span>

## <a name="final-note-on-implementation"></a><span data-ttu-id="258ec-535">Последнее примечание о реализации</span><span class="sxs-lookup"><span data-stu-id="258ec-535">Final note on implementation</span></span>

<span data-ttu-id="258ec-536">В фактическом приложении «модульный куб», являющийся базовым значением алгоритма, извлекается из более крупного латтицес, а значения в вершинах могут требовать дорогостоящих вычислений.</span><span class="sxs-lookup"><span data-stu-id="258ec-536">In actual application, the "unit cube" that is the basic setting of the algorithm is extracted from larger lattices, and the values at the vertices may require expensive calculation.</span></span> <span data-ttu-id="258ec-537">С другой стороны, также ясно, что для интерполяции тетрахедрал требуются только значения в вершинах тетрахедрон, которые являются подмножеством всех вершин Куба единиц измерения.</span><span class="sxs-lookup"><span data-stu-id="258ec-537">On the other hand, it is also clear that tetrahedral interpolation requires only the values at the vertices of the tetrahedron, which is a subset of all the vertices of the unit cube.</span></span> <span data-ttu-id="258ec-538">Таким образом, более эффективно реализовать то, что можно назвать «отложенным вычислением».</span><span class="sxs-lookup"><span data-stu-id="258ec-538">Therefore, it is more efficient to implement what can be called "deferred evaluation."</span></span> <span data-ttu-id="258ec-539">В программной реализации предыдущего алгоритма обычно используется подпрограмма, которая принимает куб единицы и значения на его вершинах в качестве входных данных.</span><span class="sxs-lookup"><span data-stu-id="258ec-539">In a software implementation of the preceding algorithm, it is typical to have a subroutine that takes the unit cube and values at its vertices as input.</span></span> <span data-ttu-id="258ec-540">Отложенное вычисление означает, что вместо передачи значений в вершинам передается необходимая информация для оценки значений вершин, без фактического выполнения оценки.</span><span class="sxs-lookup"><span data-stu-id="258ec-540">Deferred evaluation means that instead of passing the values at the vertices, the necessary information to evaluate the values of the vertices is passed, without actually carrying out the evaluation.</span></span> <span data-ttu-id="258ec-541">Внутри подпрограммы фактическое вычисление этих значений будет выполняться только для тех вершин, которые принадлежат к окружающему тетрахедрон, после того, как будет определено заключенный тетрахедрон.</span><span class="sxs-lookup"><span data-stu-id="258ec-541">Inside the subroutine, actual evaluation of these values will be carried out only for those vertices that belong to the enclosing tetrahedron, after the enclosing tetrahedron is determined.</span></span>

## <a name="lookup-table-for-use-with-high-dynamic-range-virtual-rgb-source-devices"></a><span data-ttu-id="258ec-542">Таблица подстановки для использования с динамическим диапазоном виртуальных RGB исходные устройства</span><span class="sxs-lookup"><span data-stu-id="258ec-542">Lookup table for use with high dynamic range virtual RGB source devices</span></span>

<span data-ttu-id="258ec-543">Если преобразование создается с исходным устройством, которое моделируется как виртуальное устройство RGB, возможно, что исходные значения колорант могут быть отрицательными или больше Unity (1,0).</span><span class="sxs-lookup"><span data-stu-id="258ec-543">In the case where a transform is constructed with a source device that is modeled as a virtual RGB device, it is possible that source colorant values may be negative or greater than unity (1.0).</span></span> <span data-ttu-id="258ec-544">В этом случае исходное устройство называется высоким динамическим диапазоном (HDR).</span><span class="sxs-lookup"><span data-stu-id="258ec-544">When this occurs, the source device is referred to as having a high dynamic range(HDR).</span></span> <span data-ttu-id="258ec-545">В этом случае будет сделано особое внимание.</span><span class="sxs-lookup"><span data-stu-id="258ec-545">Special consideration is made for this case.</span></span>

<span data-ttu-id="258ec-546">В случае преобразований HDR минимальное и максимальное значения для каждого канала колорант можно определить на основе границы цветового охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-546">In the case of HDR transforms, the minimum and maximum values for each colorant channel can be determined from the gamut boundary of the device.</span></span> <span data-ttu-id="258ec-547">Используя эти значения, можно выполнить простое масштабирование для каждого канала колорант, чтобы колорант значения, равные минимуму колорант, были преобразованы в 0,0, а колорант значения, равные максимальному значению колорант, будут преобразованы в 1,0. линейное масштабирование значений между 0,0 и 1,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-547">By using these values, a simple scaling for each colorant channel is applied so that colorant values equal to the minimum colorant would be converted to 0.0, and colorant values equal to the maximum colorant would be converted to 1.0, with a linear scaling of values between to map linearly between 0.0 and 1.0.</span></span>

### <a name="iccprofilefromwcsprofile"></a><span data-ttu-id="258ec-548">иккпрофилефромвкспрофиле</span><span class="sxs-lookup"><span data-stu-id="258ec-548">ICCProfileFromWCSProfile</span></span>

<span data-ttu-id="258ec-549">Так как основная цель этой функции — поддержка версий Windows, предшествующих Vista, необходимо создать профили ICC версии 2,2, как указано в спецификации ICC ICC. 1:1998-09.</span><span class="sxs-lookup"><span data-stu-id="258ec-549">Because the main purpose of this feature is to support pre-Vista versions of Windows, you must generate Version 2.2 ICC profiles as defined in ICC Specification ICC.1:1998-09.</span></span> <span data-ttu-id="258ec-550">В некоторых случаях (см. следующую таблицу: "базовое устройство для сопоставления класса ICC-профиля") можно создать матрицу или профиль ICC на основе TRC из профиля WCS.</span><span class="sxs-lookup"><span data-stu-id="258ec-550">In certain cases (see the following table "Baseline Device To ICC Profile Class Mapping"), you can create a matrix or TRC-based ICC profile from a WCS profile.</span></span> <span data-ttu-id="258ec-551">В других случаях профиль ICC состоит из Лутс.</span><span class="sxs-lookup"><span data-stu-id="258ec-551">In other cases, the ICC profile consists of LUTs.</span></span> <span data-ttu-id="258ec-552">В следующей процедуре описывается создание АТОБ и Бтоа Лутс.</span><span class="sxs-lookup"><span data-stu-id="258ec-552">The following process describes how to create the AToB and BToA LUTs.</span></span> <span data-ttu-id="258ec-553">Разумеется, профили ICC также имеют и другие поля.</span><span class="sxs-lookup"><span data-stu-id="258ec-553">Of course, ICC profiles have other fields as well.</span></span> <span data-ttu-id="258ec-554">Некоторые данные могут быть получены из профиля WCS.</span><span class="sxs-lookup"><span data-stu-id="258ec-554">Some of the data can be derived from the WCS profile.</span></span> <span data-ttu-id="258ec-555">Для других данных необходимо разработать интеллектуальные значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="258ec-555">For other data, you'll have to develop intelligent defaults.</span></span> <span data-ttu-id="258ec-556">Авторские права будут назначены корпорации Майкрософт; так как это технология Майкрософт, которая используется для создания Лутс.</span><span class="sxs-lookup"><span data-stu-id="258ec-556">The copyright will be assigned to Microsoft; since it is Microsoft technology that is being used to create the LUTs.</span></span>

<span data-ttu-id="258ec-557">Эта схема должна работать для всех типов моделей устройств, включая подключаемые модули. Если подключаемый модуль имеет связанную модель базовых устройств, можно определить тип базового устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-557">This design should work for all types of device models, including plug-ins. As long as the plug-in has an associated baseline device model, the underlying device type can be determined.</span></span>

<span data-ttu-id="258ec-558">Сложная часть создания профиля ICC заключается в создании таблиц подстановки АТОБ и Бтоа.</span><span class="sxs-lookup"><span data-stu-id="258ec-558">The hard part of creating an ICC profile is creating the AToB and BToA lookup tables.</span></span> <span data-ttu-id="258ec-559">Эти таблицы сопоставлены между пространством устройства, например RGB или CMYK, и пространством подключения профиля (ПК), которое является вариантом ЦИЕЛАБ.</span><span class="sxs-lookup"><span data-stu-id="258ec-559">These tables map between the device space, for example, RGB or CMYK, and the Profile Connection Space (PCS), which is a variant of CIELAB.</span></span> <span data-ttu-id="258ec-560">Это по сути то же самое, что и процесс управления цветом, используемый при преобразовании, чтобы сопоставлять пространство устройства с местом на устройстве.</span><span class="sxs-lookup"><span data-stu-id="258ec-560">This is fundamentally the same as the color management process used in the CITE transform to map from device space to device space.</span></span> <span data-ttu-id="258ec-561">Однако для выполнения преобразования необходимо иметь следующие сведения.</span><span class="sxs-lookup"><span data-stu-id="258ec-561">However, you must have the following information to make the transformation.</span></span>

1) <span data-ttu-id="258ec-562">Условия просмотра ссылок для компьютеров.</span><span class="sxs-lookup"><span data-stu-id="258ec-562">Reference viewing conditions for the PCS.</span></span>

2) <span data-ttu-id="258ec-563">Палитра эталонных компьютеров.</span><span class="sxs-lookup"><span data-stu-id="258ec-563">Reference PCS gamut.</span></span>

3) <span data-ttu-id="258ec-564">Модель устройства, преобразующая значения между компьютерами и колориметри.</span><span class="sxs-lookup"><span data-stu-id="258ec-564">Device model that converts between PCS values and colorimetry.</span></span>

<span data-ttu-id="258ec-565">Профиль WCS и связанная с ним Камера предоставляются в качестве параметров.</span><span class="sxs-lookup"><span data-stu-id="258ec-565">The WCS profile and its associated CAM are provided as parameters.</span></span> <span data-ttu-id="258ec-566">Существует две модели базовых устройств, которые преобразуют между колориметри и кодировкой ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-566">There are two baseline device models that convert between colorimetry and the PCS encoding.</span></span> <span data-ttu-id="258ec-567">Причины, по которым вам нужны два, описаны ниже.</span><span class="sxs-lookup"><span data-stu-id="258ec-567">The reason you need two is explained below.</span></span>

1) <span data-ttu-id="258ec-568">Можно получить условия просмотра ссылок для компьютеров из спецификации формата ICC.</span><span class="sxs-lookup"><span data-stu-id="258ec-568">You can obtain the reference viewing conditions for the PCS from the ICC profile format specification.</span></span> <span data-ttu-id="258ec-569">Сведения, предоставленные в спецификации формата ICC, достаточно для расчета всех данных, необходимых для инициализации Canvas, используемой CMS.</span><span class="sxs-lookup"><span data-stu-id="258ec-569">The information provided in the ICC profile format specification is sufficient to compute all the data required to initialize the CAM used by the CMS.</span></span> <span data-ttu-id="258ec-570">Для обеспечения согласованности и гибкости эта информация хранится в цветном профиле WCS.</span><span class="sxs-lookup"><span data-stu-id="258ec-570">For consistency and flexibility, this information is stored in a WCS color profile.</span></span>

2) <span data-ttu-id="258ec-571">Профиль WCS также можно использовать для хранения образцов, определяющих эталонный охват компьютеров.</span><span class="sxs-lookup"><span data-stu-id="258ec-571">You can also use a WCS profile to store samples that define the reference gamut of the PCS.</span></span> <span data-ttu-id="258ec-572">В УПОМИНАЕМой системе управления цветом (CMS) предусмотрено два способа создания границ цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="258ec-572">The CITE color management system (CMS) has two ways to create gamut boundaries.</span></span> <span data-ttu-id="258ec-573">Одним из них является выборка полного пространства на устройстве и использование модели устройства для создания значений измерений.</span><span class="sxs-lookup"><span data-stu-id="258ec-573">One is to sample the complete device space and use the device model to create measurement values.</span></span> <span data-ttu-id="258ec-574">Второй способ — использовать измеряемые образцы из профиля для создания границы эталонного цвета.</span><span class="sxs-lookup"><span data-stu-id="258ec-574">The second method is to use measured samples from the profile to create a reference gamut boundary.</span></span> <span data-ttu-id="258ec-575">Поскольку цветовой охват на компьютерах ICC слишком велик для создания полезного цветового охвата, первый метод является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="258ec-575">Because the gamut of the ICC PCS is too large to make a useful reference gamut, the first method is inappropriate.</span></span> <span data-ttu-id="258ec-576">Но второй метод является гибким подходом на основе профиля.</span><span class="sxs-lookup"><span data-stu-id="258ec-576">But the second method is a flexible, profile-based approach.</span></span> <span data-ttu-id="258ec-577">Чтобы переопределить цветовой охват эталонных компьютеров, можно изменить данные измерения в профиле устройства ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-577">To redefine the reference PCS gamut, you can change the measurement data in the PCS device profile.</span></span>

3) <span data-ttu-id="258ec-578">Компьютеры ICC — это моделирование идеального устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-578">The ICC PCS is a modeling of an ideal device.</span></span> <span data-ttu-id="258ec-579">Создавая модель компьютеров как реальное устройство, вы можете воспользоваться процессом управления цветом, используемым в смарт-CMM.</span><span class="sxs-lookup"><span data-stu-id="258ec-579">By creating a model of the PCS as a real device, you can take advantage of the color management process used in the Smart CMM.</span></span> <span data-ttu-id="258ec-580">Создание модели устройства из колориметри в кодировке ПК — это просто.</span><span class="sxs-lookup"><span data-stu-id="258ec-580">Creating a device model from colorimetry to the PCS encoding is straightforward.</span></span> <span data-ttu-id="258ec-581">Вы просто сопоставляете значения true и закодированные значения ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-581">You simply map between the true colorimetric values and the PCS encoded values.</span></span> <span data-ttu-id="258ec-582">Поскольку интерфейс CMS для моделей устройств поддерживает только значения XYZ, также может потребоваться сопоставление между XYZ и LAB.</span><span class="sxs-lookup"><span data-stu-id="258ec-582">Since the CMS interface for device models only supports XYZ values, you might also have to map between XYZ and LAB.</span></span> <span data-ttu-id="258ec-583">Это хорошо известное преобразование.</span><span class="sxs-lookup"><span data-stu-id="258ec-583">This is a well-known transformation.</span></span> <span data-ttu-id="258ec-584">Эта модель описана в документе 2.2.02 "базовые модели устройств" в разделах 7,9 и 7,10.</span><span class="sxs-lookup"><span data-stu-id="258ec-584">This model is described in the document 2.2.02 "Baseline Device Models" in sections 7.9 and 7.10.</span></span>

<span data-ttu-id="258ec-585">Может потребоваться выполнить определенное сопоставление цветового охвата, если цветовой охват устройства больше, чем цветовой охват ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-585">You might have to perform some gamut mapping, if the gamut of the device is larger than the gamut of the PCS.</span></span> <span data-ttu-id="258ec-586">Для этой цели можно использовать базовые ГММС.</span><span class="sxs-lookup"><span data-stu-id="258ec-586">The baseline GMMs can be used for this purpose.</span></span> <span data-ttu-id="258ec-587">Обратите внимание, что правильно созданный профиль ICC содержит таблицы уточняющих запросов для относительных, искусственного и насыщенных цветов, хотя они могут указывать на один и тот же LUT внутренне.</span><span class="sxs-lookup"><span data-stu-id="258ec-587">Note that a properly created ICC profile has lookup tables for the Relative Colorimetric, Perceptual, and Saturation intents, although these may all point to the same LUT internally.</span></span>

![Схема, на которой показано создание A T o B L T.](images/transformcreation-image128.png)

<span data-ttu-id="258ec-589">**Рис. 5.** Создание LUT АТОБ</span><span class="sxs-lookup"><span data-stu-id="258ec-589">**Figure 5:** Creation of an AToB LUT</span></span>

<span data-ttu-id="258ec-590">Этот процесс показан на рис. 5.</span><span class="sxs-lookup"><span data-stu-id="258ec-590">This process is illustrated in Figure 5.</span></span> <span data-ttu-id="258ec-591">Сначала модель устройства инициализируется из данных в профиле DM.</span><span class="sxs-lookup"><span data-stu-id="258ec-591">First, the device model is initialized from the data in the DM profile.</span></span> <span data-ttu-id="258ec-592">Затем создайте границу для палитры устройства, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="258ec-592">Then, construct a device gamut boundary as follows.</span></span> <span data-ttu-id="258ec-593">Выборка данных из модели устройства выполняется с помощью модели устройства для получения данных с + +.</span><span class="sxs-lookup"><span data-stu-id="258ec-593">A sampling of data from the device model is run through the device model to obtain colorimetric data.</span></span> <span data-ttu-id="258ec-594">Для создания данных с изображением на основе изображения используется камера.</span><span class="sxs-lookup"><span data-stu-id="258ec-594">The colorimetric data is run through the CAM to create appearance data.</span></span> <span data-ttu-id="258ec-595">Данные внешнего вида используются для создания границы области охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-595">The appearance data is used to create the device gamut boundary.</span></span>

<span data-ttu-id="258ec-596">Затем используйте данные из профиля измерения "эталонные компьютеры", чтобы создать границу для компьютеров.</span><span class="sxs-lookup"><span data-stu-id="258ec-596">Next, use data from the reference PCS measurement profile to create a gamut boundary for the PCS.</span></span>

<span data-ttu-id="258ec-597">Используйте только что созданные границы цветового охвата для инициализации ГММ.</span><span class="sxs-lookup"><span data-stu-id="258ec-597">Use the two gamut boundaries just created to initialize a GMM.</span></span> <span data-ttu-id="258ec-598">Затем используйте модель устройства, ГММ и модель устройства ПК для создания преобразования.</span><span class="sxs-lookup"><span data-stu-id="258ec-598">Then, use the device model, the GMM, and the PCS device model to create a transform.</span></span> <span data-ttu-id="258ec-599">Выполните выборку пространства устройства с помощью преобразования, чтобы создать LUT АТОБ.</span><span class="sxs-lookup"><span data-stu-id="258ec-599">Run a sampling of device space through the transform to create an AToB LUT.</span></span>

![Схема, на которой показано создание A T o B L T с использованием выборки пространства P C S.](images/transformcreation-image130.png)

<span data-ttu-id="258ec-601">**Рис. 6.** Создание LUT Бтоа</span><span class="sxs-lookup"><span data-stu-id="258ec-601">**Figure 6:** Creation of a BToA LUT</span></span>

<span data-ttu-id="258ec-602">На рис. 6 показано создание Бтоа LUT.</span><span class="sxs-lookup"><span data-stu-id="258ec-602">Figure 6 illustrates the creation of the BToA LUT.</span></span> <span data-ttu-id="258ec-603">Это практически идентично созданию АТОБ LUT с ролями исходного и целевого обмена.</span><span class="sxs-lookup"><span data-stu-id="258ec-603">This is almost identical to creating an AToB LUT, with the roles of source and destination exchanged.</span></span> <span data-ttu-id="258ec-604">Кроме того, для создания LUT необходимо выполнить выборку полного спектра ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-604">Also, you must sample the full PCS gamut to create the LUT.</span></span>

<span data-ttu-id="258ec-605">Обратите внимание, что, поскольку камера (CIECAM02 в WCS) вовлечена в процесс, адаптация цветовой адаптации между белой точкой носителя и белой точкой ПК (которая задается ICC в D50) влияет на прозрачность.</span><span class="sxs-lookup"><span data-stu-id="258ec-605">Note that because the CAM (CIECAM02 in WCS) is involved in the process, chromatic adaptation between the media white point and the PCS white point (mandated by ICC to be that of D50) is effected transparently by the CAM.</span></span>

## <a name="hdr-virtual-rgb-devices"></a><span data-ttu-id="258ec-606">Виртуальные устройства RGB HDR</span><span class="sxs-lookup"><span data-stu-id="258ec-606">HDR virtual RGB devices</span></span>

<span data-ttu-id="258ec-607">Необходимо учитывать особое внимание при создании профилей для виртуальных устройств RGB HDR. то есть устройства, для которых значения колорант могут быть меньше 0,0 или больше 1,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-607">Special consideration must be given when generating profiles for HDR virtual RGB devices; that is, devices for which the colorant values may be less than 0.0 or greater than 1.0.</span></span> <span data-ttu-id="258ec-608">В поколении АТОБ LUT создается больший набор из 1D входных Лутс.</span><span class="sxs-lookup"><span data-stu-id="258ec-608">In the generation of the ATOB LUT, a larger set of 1D input LUTs is built.</span></span> <span data-ttu-id="258ec-609">Значения колорант масштабируются и смещаются до диапазона 0.</span><span class="sxs-lookup"><span data-stu-id="258ec-609">Colorant values are scaled and offset to the range 0 ..</span></span> <span data-ttu-id="258ec-610">1, используя минимальное и максимальное значения колорант в профиле WCS.</span><span class="sxs-lookup"><span data-stu-id="258ec-610">1 using the minimum and maximum colorant values in the WCS profile.</span></span>

<span data-ttu-id="258ec-611">Поскольку пространство колорант для HDR-устройств, скорее всего, не будет полностью заполнено, в трехмерной LUT для тега также предоставляется специальная поддержка.</span><span class="sxs-lookup"><span data-stu-id="258ec-611">Because the colorant space for HDR devices is not likely to be completely populated, special support is provided in the 3-D LUT for the tag as well.</span></span> <span data-ttu-id="258ec-612">Чтобы обрабатывать цвета в разреженном регионе, колорантс перекодированы, чтобы можно было достичь экстраполяции свыше 0,0 и 1,0.</span><span class="sxs-lookup"><span data-stu-id="258ec-612">In order to handle colors in the sparsely populated region, the colorants are recoded so that extrapolation beyond 0.0 and 1.0 can be achieved.</span></span> <span data-ttu-id="258ec-613">Используемый диапазон — 1..</span><span class="sxs-lookup"><span data-stu-id="258ec-613">The range used is -1 ..</span></span> <span data-ttu-id="258ec-614">+ 4.</span><span class="sxs-lookup"><span data-stu-id="258ec-614">+4.</span></span>

<span data-ttu-id="258ec-615">Из-за повторного масштабирования, применяемого для трехмерной LUT, создается набор из 1D выходного Лутс, который сопоставляет результат с диапазоном 0.</span><span class="sxs-lookup"><span data-stu-id="258ec-615">Because of the rescaling applied for the 3-D LUT, a set of 1D output LUTs is built to map the result back to the range 0 ..</span></span> <span data-ttu-id="258ec-616">1.</span><span class="sxs-lookup"><span data-stu-id="258ec-616">1.</span></span>

## <a name="more-than-one-pcs"></a><span data-ttu-id="258ec-617">Более одного ПК</span><span class="sxs-lookup"><span data-stu-id="258ec-617">More than one PCS</span></span>

<span data-ttu-id="258ec-618">ICC обнаружил, что один компьютер был недостаточно гибким для удовлетворения всех предполагаемых применений CMS.</span><span class="sxs-lookup"><span data-stu-id="258ec-618">The ICC found that one PCS was not sufficiently flexible to meet all the intended uses of a CMS.</span></span> <span data-ttu-id="258ec-619">В версии 4 спецификации профиля ICC разъяснено, что на самом деле есть две кодировки ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-619">In version 4 of the Profile Specification, the ICC clarified that there are actually two PCS encodings.</span></span> <span data-ttu-id="258ec-620">Один используется для изображения с + +. другой используется для цели искусственного.</span><span class="sxs-lookup"><span data-stu-id="258ec-620">One is used for the colorimetric intents; another is used for the perceptual intent.</span></span> <span data-ttu-id="258ec-621">(Для цели насыщенности не указаны компьютеры.</span><span class="sxs-lookup"><span data-stu-id="258ec-621">(No PCS is specified for the Saturation intent.</span></span> <span data-ttu-id="258ec-622">Этот компонент не является неоднозначным.) На компьютере с + + установлена минимальная и максимальная освещенность, но значения чрома и оттенков задаются примерно ± 127.</span><span class="sxs-lookup"><span data-stu-id="258ec-622">The ICC has left this part ambiguous.) The colorimetric PCS has a minimum and maximum lightness specified, but the chroma and hue values range to roughly ± 127.</span></span> <span data-ttu-id="258ec-623">Эти ПК выглядят как прямоугольный Prism.</span><span class="sxs-lookup"><span data-stu-id="258ec-623">This PCS looks like a rectangular prism.</span></span> <span data-ttu-id="258ec-624">Как упоминалось ранее, том ПК искусственного напоминает цветовой охват струйного принтера.</span><span class="sxs-lookup"><span data-stu-id="258ec-624">As mentioned previously, the perceptual PCS volume resembles the gamut of an inkjet printer.</span></span>

<span data-ttu-id="258ec-625">Два Пксса ICC также имеют две различные цифровые кодировки.</span><span class="sxs-lookup"><span data-stu-id="258ec-625">The two ICC PCSs also have two different digital encodings.</span></span> <span data-ttu-id="258ec-626">На искусственного ПК нулевое значение представляет собой индикацию нуля.</span><span class="sxs-lookup"><span data-stu-id="258ec-626">In the perceptual PCS, a value of zero represents a lightness of zero.</span></span> <span data-ttu-id="258ec-627">На компьютерах с + + нулевое значение соответствует минимальной освещенности ПК, что больше нуля.</span><span class="sxs-lookup"><span data-stu-id="258ec-627">In the colorimetric PCS, a value of zero represents the minimum lightness of the PCS, which is greater than zero.</span></span> <span data-ttu-id="258ec-628">Эту проблему можно решить, настраивая другую модель устройства для каждой кодировки ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-628">You can solve this problem by having a different device model for each of the PCS encodings.</span></span>

## <a name="gamut-mapping"></a><span data-ttu-id="258ec-629">Сопоставление палитры</span><span class="sxs-lookup"><span data-stu-id="258ec-629">Gamut mapping</span></span>

<span data-ttu-id="258ec-630">Чтобы создать Лутс АТОБ в профиле ICC, необходимо соотнесение между охватом устройства и соответствующим пространством на компьютерах.</span><span class="sxs-lookup"><span data-stu-id="258ec-630">To create the AToB LUTs in an ICC profile, you map from the device gamut to the appropriate PCS space.</span></span> <span data-ttu-id="258ec-631">Чтобы создать Лутс Бтоа, вы сопоставляете пространство ПК с областью охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-631">To create the BToA LUTs, you map from the PCS space to the device gamut.</span></span> <span data-ttu-id="258ec-632">Сопоставление для АТОБ Лутс весьма похоже на то, что используется в CMS на основе измерения.</span><span class="sxs-lookup"><span data-stu-id="258ec-632">The mapping for the AToB LUTs is quite similar to that used in a measurement-based CMS.</span></span> <span data-ttu-id="258ec-633">Для искусственного ПК сопоставьте цветовой охват устройства правдоподобные с границей палитры искусственного ПК с помощью обрезки или сжатия для любых цветов, выходящих за пределы цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="258ec-633">For the perceptual PCS, map the device plausible gamut to the perceptual PCS gamut boundary, using either clipping or compression for any out-of-gamut colors.</span></span> <span data-ttu-id="258ec-634">Для того, чтобы отрезаться от экологичных целей, может возникнуть необходимость в обрезке, но значения чрома и оттенков будут помещаться в цветовой охват "темно-PCS".</span><span class="sxs-lookup"><span data-stu-id="258ec-634">For the colorimetric intents, you might have to clip lightness, but the chroma and hue values are all going to fit in the colorimetric PCS gamut.</span></span>

<span data-ttu-id="258ec-635">Сопоставление для Бтоа Лутс немного отличается.</span><span class="sxs-lookup"><span data-stu-id="258ec-635">The mapping for the BToA LUTs is a little different.</span></span> <span data-ttu-id="258ec-636">Изображения с + + по-прежнему просты. Вы просто зарезаете значения для компьютеров в цветовой охват устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-636">The colorimetric intents are still easy; you just clip PCS values to the device gamut.</span></span> <span data-ttu-id="258ec-637">Но ICC требует, чтобы все возможные значения компьютеров сопоставлялись с определенными значениями устройств, а не просто в пределах эталонного спектра искусственного ПК.</span><span class="sxs-lookup"><span data-stu-id="258ec-637">But the ICC requires that all possible PCS values map to some device value, not merely those within the reference gamut of the perceptual PCS.</span></span> <span data-ttu-id="258ec-638">Поэтому необходимо убедиться, что ГММС может управлять исходными цветами, находящимися за пределами опорной гаммы.</span><span class="sxs-lookup"><span data-stu-id="258ec-638">So, you must make sure that the GMMs can handle source colors that are outside the reference gamut.</span></span> <span data-ttu-id="258ec-639">Это можно обработать, обрезать эти цвета с границей области охвата устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-639">This can be handled by clipping those colors to the device gamut boundary.</span></span>

## <a name="baseline-device-to-icc-profile-class-mapping"></a><span data-ttu-id="258ec-640">Сопоставление класса базового устройства с классом ICC Profile</span><span class="sxs-lookup"><span data-stu-id="258ec-640">Baseline device to ICC profile class mapping</span></span>



| <span data-ttu-id="258ec-641">Базовый тип устройства</span><span class="sxs-lookup"><span data-stu-id="258ec-641">Baseline Device Type</span></span>              | <span data-ttu-id="258ec-642">Класс профиля ICC</span><span class="sxs-lookup"><span data-stu-id="258ec-642">ICC Profile Class</span></span>       | <span data-ttu-id="258ec-643">Комментарий</span><span class="sxs-lookup"><span data-stu-id="258ec-643">Remark</span></span>                                                                      |
|-----------------------------------|-------------------------|-----------------------------------------------------------------------------|
| <span data-ttu-id="258ec-644">Устройство для записи RGB</span><span class="sxs-lookup"><span data-stu-id="258ec-644">RGB Capture Device</span></span>                | <span data-ttu-id="258ec-645">Устройство ввода ("скнр")</span><span class="sxs-lookup"><span data-stu-id="258ec-645">Input Device ("scnr")</span></span>   | <span data-ttu-id="258ec-646">ПК — ЦИЕЛАБ.</span><span class="sxs-lookup"><span data-stu-id="258ec-646">PCS is CIELAB.</span></span> <span data-ttu-id="258ec-647">AToB0Tag — это устройство для компьютеров с относительным намерением.</span><span class="sxs-lookup"><span data-stu-id="258ec-647">AToB0Tag is Device to PCS with relative colorimetric intent.</span></span> |
| <span data-ttu-id="258ec-648">CRT, ЖК-монитор</span><span class="sxs-lookup"><span data-stu-id="258ec-648">CRT, LCD monitor</span></span>                  | <span data-ttu-id="258ec-649">Отображение устройства ("мнтр")</span><span class="sxs-lookup"><span data-stu-id="258ec-649">Display Device ("mntr")</span></span> | <span data-ttu-id="258ec-650">ПК — ЦИЕКСИЗ.</span><span class="sxs-lookup"><span data-stu-id="258ec-650">PCS is CIEXYZ.</span></span> <span data-ttu-id="258ec-651">См. следующие сведения о преобразовании модели.</span><span class="sxs-lookup"><span data-stu-id="258ec-651">See the following for model conversion.</span></span>                      |
| <span data-ttu-id="258ec-652">Проектор с RGB</span><span class="sxs-lookup"><span data-stu-id="258ec-652">RGB Projector</span></span>                     | <span data-ttu-id="258ec-653">Цветовое пространство ("Спак")</span><span class="sxs-lookup"><span data-stu-id="258ec-653">Color Space ("spac")</span></span>    | <span data-ttu-id="258ec-654">ПК — ЦИЕЛАБ.</span><span class="sxs-lookup"><span data-stu-id="258ec-654">PCS is CIELAB.</span></span>                                                              |
| <span data-ttu-id="258ec-655">Принтер RGB и CMYK</span><span class="sxs-lookup"><span data-stu-id="258ec-655">RGB and CMYK printer</span></span>              | <span data-ttu-id="258ec-656">Выходное устройство ("ПРТР")</span><span class="sxs-lookup"><span data-stu-id="258ec-656">Output Device ("prtr")</span></span>  | <span data-ttu-id="258ec-657">ПК — ЦИЕЛАБ.</span><span class="sxs-lookup"><span data-stu-id="258ec-657">PCS is CIELAB.</span></span>                                                              |
| <span data-ttu-id="258ec-658">Виртуальное устройство RGB (без использования HDR)</span><span class="sxs-lookup"><span data-stu-id="258ec-658">RGB Virtual Device (non-HDR case)</span></span> | <span data-ttu-id="258ec-659">Отображение устройства ("мнтр")</span><span class="sxs-lookup"><span data-stu-id="258ec-659">Display Device ("mntr")</span></span> | <span data-ttu-id="258ec-660">ПК — ЦИЕКСИЗ.</span><span class="sxs-lookup"><span data-stu-id="258ec-660">PCS is CIEXYZ.</span></span>                                                              |
| <span data-ttu-id="258ec-661">Виртуальное устройство RGB (регистр HDR)</span><span class="sxs-lookup"><span data-stu-id="258ec-661">RGB Virtual Device (HDR case)</span></span>     | <span data-ttu-id="258ec-662">Цветовое пространство ("Спак")</span><span class="sxs-lookup"><span data-stu-id="258ec-662">Color Space ("spac")</span></span>    | <span data-ttu-id="258ec-663">ПК — ЦИЕЛАБ.</span><span class="sxs-lookup"><span data-stu-id="258ec-663">PCS is CIELAB.</span></span>                                                              |



 

<span data-ttu-id="258ec-664">Преобразование профилей монитора не включает сборку Лутс, а состоит из создания модели матрицы или TRC.</span><span class="sxs-lookup"><span data-stu-id="258ec-664">The conversion of monitor profiles does not involving building LUTs, but instead consists of building a matrix or TRC model.</span></span> <span data-ttu-id="258ec-665">Модель, используемая в ICC, немного отличается от модели, используемой в модели CRT или ЖК-моделирования в том, что термин «черная коррекция» отсутствует.</span><span class="sxs-lookup"><span data-stu-id="258ec-665">The model used in ICC is slightly different from the one used in the WCS CRT or LCD modeling in that the "black correction" term is missing.</span></span> <span data-ttu-id="258ec-666"> В частности:</span><span class="sxs-lookup"><span data-stu-id="258ec-666">Specifically,</span></span>

<span data-ttu-id="258ec-667">Модель WCS:</span><span class="sxs-lookup"><span data-stu-id="258ec-667">WCS model:</span></span> ![Показывает модель W C S.](images/transformcreation-image132.png)

<span data-ttu-id="258ec-669">Модель ICC:</span><span class="sxs-lookup"><span data-stu-id="258ec-669">ICC model:</span></span> ![Показывает модель I C C.](images/transformcreation-image134.png)

<span data-ttu-id="258ec-671">Преобразование из модели WCS в модель ICC выполняется следующим образом.</span><span class="sxs-lookup"><span data-stu-id="258ec-671">The conversion from WCS model to ICC model is done as follows.</span></span>

<span data-ttu-id="258ec-672">Определите новые кривые:</span><span class="sxs-lookup"><span data-stu-id="258ec-672">Define new curves:</span></span>

![Показывает матрицу для определения новых кривых.](images/transformcreation-image136.png)

<span data-ttu-id="258ec-674">Это не оттенки воспроизведения, так как они не сопоставлены 1 с 1.</span><span class="sxs-lookup"><span data-stu-id="258ec-674">These are not tone reproduction curves because they do not map 1 to 1.</span></span> <span data-ttu-id="258ec-675">Это достигается нормализацией.</span><span class="sxs-lookup"><span data-stu-id="258ec-675">A normalization will achieve that.</span></span> <span data-ttu-id="258ec-676">Ниже приведены окончательные определения модели ICC.</span><span class="sxs-lookup"><span data-stu-id="258ec-676">The final definitions of the ICC model are:</span></span>

![Показывает окончательные определения модели I в c.](images/transformcreation-image138.png)

![Показывает последнюю матрицу для модели I C C.](images/transformcreation-image140.png)

<span data-ttu-id="258ec-679">Для виртуальных устройств RGB, отличных от HDR, вы также создаете экранный профиль ICC для эффективного использования пространства.</span><span class="sxs-lookup"><span data-stu-id="258ec-679">For non-HDR RGB virtual devices, you are also generating a display ICC profile for space efficiency.</span></span> <span data-ttu-id="258ec-680">В этом случае тристимулус матрицу *M ICC* можно получить непосредственно из первичных элементов профиля WCS без приведенного выше преобразования модели.</span><span class="sxs-lookup"><span data-stu-id="258ec-680">In that case, the tristimulus matrix *M ICC* can be obtained directly from the primaries of the WCS profile without the above model conversion.</span></span> <span data-ttu-id="258ec-681">Один последний, но важно, обратите внимание, что эта тристимулус матрица должна быть адаптирована к D50, чтобы соответствовать спецификации ICC компьютеров.</span><span class="sxs-lookup"><span data-stu-id="258ec-681">One final, but important, note is that this tristimulus matrix must be chromatically adapted to D50 to conform with the ICC specification of the PCS.</span></span> <span data-ttu-id="258ec-682">Иными словами, записи в каждой строке матрицы, которая должна быть закодирована в профиле ICC, должны суммироваться соответственно в 96,42, 100 и 82,49.</span><span class="sxs-lookup"><span data-stu-id="258ec-682">In other words, the entries on each row of the matrix to be encoded in the ICC profile must sum respectively to 96.42, 100, and 82.49.</span></span> <span data-ttu-id="258ec-683">В текущей реализации адаптация цветовой палитры выполняется CAT02, что также является преобразованием «адаптация», используемой в CAM02.</span><span class="sxs-lookup"><span data-stu-id="258ec-683">In the current implementation, the chromatic adaptation is done by CAT02, which is also the chromatic adaptation transform used in CAM02.</span></span>

## <a name="black-preservation-and-black-generation"></a><span data-ttu-id="258ec-684">Черная сохранность и создание черной версии</span><span class="sxs-lookup"><span data-stu-id="258ec-684">Black Preservation and Black Generation</span></span>

<span data-ttu-id="258ec-685">Реализация черной сохранности связана вместе с поколением черного канала на устройствах, поддерживающих черный канал.</span><span class="sxs-lookup"><span data-stu-id="258ec-685">Implementation of black preservation is tied together with the generation of the black channel in devices that support a black channel.</span></span> <span data-ttu-id="258ec-686">Для этого сведения о каждом исходном цвете собираются, чтобы разрешить модели устройств, поддерживающие черный канал, чтобы определить, как лучше установить черный канал на выходе.</span><span class="sxs-lookup"><span data-stu-id="258ec-686">To accomplish this, information about each source color is collected to allow device models that support a black channel to determine how best to set the black channel on output.</span></span> <span data-ttu-id="258ec-687">Несмотря на то, что для преобразований цветов, преобразуемых с одного устройства черного канала в другое, используется черная подмножество, для всех преобразований, в которых используется устройство назначения с черным каналом, применяется черная генерация.</span><span class="sxs-lookup"><span data-stu-id="258ec-687">While black preservation is pertinent for color transforms that convert between one black-channel device to another, black generation is implemented for all transform involving a black-channel destination device.</span></span>

<span data-ttu-id="258ec-688">Сведения о черном канале записываются в структуру данных с именем [**блаккинформатион**](/previous-versions/windows/desktop/api/WcsPlugIn/ns-wcsplugin-_blackinformation).</span><span class="sxs-lookup"><span data-stu-id="258ec-688">Black channel information is recorded in a data structure called [**BlackInformation**](/previous-versions/windows/desktop/api/WcsPlugIn/ns-wcsplugin-_blackinformation).</span></span> <span data-ttu-id="258ec-689">Структура **блаккинформатион** содержит логическое значение, указывающее, содержит ли цвет только черный колорант, и числовое значения, обозначающее степень «черной», называемую черным весом.</span><span class="sxs-lookup"><span data-stu-id="258ec-689">The **BlackInformation** structure contains a boolean indicating whether the color contains only black colorant and a numeric value indicating the degree of "blackness" called black weight.</span></span> <span data-ttu-id="258ec-690">Для устройств источника, поддерживающих черный канал, черный вес — это процентная доля черного колорант в исходном цвете.</span><span class="sxs-lookup"><span data-stu-id="258ec-690">For source devices that support a black channel, the black weight is the percentage of black colorant in the source color.</span></span> <span data-ttu-id="258ec-691">Для устройств источника, которые не содержат черного канала, черный вес вычисляются с помощью других колорантс и значения Appearance.</span><span class="sxs-lookup"><span data-stu-id="258ec-691">For source devices that do not contain a black channel, the black weight is computed using the other colorants and the appearance value.</span></span> <span data-ttu-id="258ec-692">Значение "чистота цвета" выдается путем вычисления разницы между максимальным колорант значением и минимальным значением колорант, деленным на максимальное значение колорант.</span><span class="sxs-lookup"><span data-stu-id="258ec-692">A value called "color purity" is computed by taking the difference between the maximum colorant value and the minimum colorant value divided by the maximum colorant value.</span></span> <span data-ttu-id="258ec-693">Значение "относительная освещенность" выдается путем различия между освещенностью цвета и минимальным освещением для целевого устройства, деленного на разность между минимальным и максимальным освещением для целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-693">A value called "relative lightness" is computed by taking the difference between the lightness of the color and the minimum lightness for the destination device divided by the difference between the minimum and maximum lightness for the destination device.</span></span> <span data-ttu-id="258ec-694">Если исходное устройство является аддитивным (монитор или проектор), то черный вес определяется как 1,0 минус цветовой чистоты, умноженной на относительное освещение.</span><span class="sxs-lookup"><span data-stu-id="258ec-694">If the source device is an additive device (monitor or projector), the black weight is determined to be the 1.0 minus the color purity multiplied by the relative lightness.</span></span> <span data-ttu-id="258ec-695">Например, если исходное устройство является монитором RGB, максимальное значение и минимальное значение R, G и B для каждого цвета вычисляются, а черный вес определяется формулой:</span><span class="sxs-lookup"><span data-stu-id="258ec-695">For example, if the source device is an RGB monitor, the maximum value and minimum value of R, G, and B for each color is computed and the black weight is determined by the formula:</span></span>

<span data-ttu-id="258ec-696">BW = (1,0 – (Max (R, G, B) – min (R, G, B))/max (R, G, B)) \* относительное освещение</span><span class="sxs-lookup"><span data-stu-id="258ec-696">BW = (1.0 – (max(R,G,B) – min(R,G,B)) / max(R, G, B)) \* relative lightness</span></span>

<span data-ttu-id="258ec-697">Если исходное устройство поддерживает вычитание разметка, например принтер КМИ, то отдельные колорантс должны быть дополнены (вычитаются из 1,0) перед использованием в предыдущей формуле.</span><span class="sxs-lookup"><span data-stu-id="258ec-697">If the source device supports subtractive coloration, for example, a CMY printer, then the individual colorants must be "ones complemented" (subtracted from 1.0) before use in the preceding formula.</span></span> <span data-ttu-id="258ec-698">Таким образом, для принтера КМИ R = 1,0 – C, G = 1,0 – M и B = 1,0 – Y.</span><span class="sxs-lookup"><span data-stu-id="258ec-698">Therefore, for a CMY printer, R = 1.0 – C, G = 1.0 – M, and B = 1.0 – Y.</span></span>

<span data-ttu-id="258ec-699">Черная информация для каждого цвета, обрабатываемого преобразователем цветов, определяется во время преобразования цвета.</span><span class="sxs-lookup"><span data-stu-id="258ec-699">The black information for each color processed by the color transform is determined during the color translation process.</span></span> <span data-ttu-id="258ec-700">Только черная информация определяется только в том случае, если задано значение «черная сохранение».</span><span class="sxs-lookup"><span data-stu-id="258ec-700">The black-only information is only determined if black preservation is specified.</span></span> <span data-ttu-id="258ec-701">Черный вес всегда определяется, если модель целевого устройства поддерживает черный колорант.</span><span class="sxs-lookup"><span data-stu-id="258ec-701">Black weight is always determined if the destination device model support a black colorant.</span></span> <span data-ttu-id="258ec-702">Черная информация передается в модель целевого устройства с помощью метода [**колориметриктодевицеколорсвисблакк**](/previous-versions/windows/desktop/api/WcsPlugIn/nf-wcsplugin-idevicemodelplugin-colorimetrictodevicecolorswithblack) , который использует итоговый LUT.</span><span class="sxs-lookup"><span data-stu-id="258ec-702">The black information is passed to the destination device model via the [**ColorimetricToDeviceColorsWithBlack**](/previous-versions/windows/desktop/api/WcsPlugIn/nf-wcsplugin-idevicemodelplugin-colorimetrictodevicecolorswithblack) method, which uses the resulting LUT.</span></span>

<span data-ttu-id="258ec-703">Обратите внимание, что из-за оптимизации преобразования цветов описанный выше процесс выполняется только во время создания оптимизированного преобразования LUT, а не во время выполнения метода Транслатеколорс.</span><span class="sxs-lookup"><span data-stu-id="258ec-703">Note that, because of color transform optimization, the above process occurs only during the creation of the optimized transform LUT, not during the execution of the TranslateColors method.</span></span>

## <a name="optimization-for-transforms-with-more-than-three-source-channels"></a><span data-ttu-id="258ec-704">Оптимизация для преобразований с более чем тремя каналами источника</span><span class="sxs-lookup"><span data-stu-id="258ec-704">Optimization for transforms with more than three source channels</span></span>

<span data-ttu-id="258ec-705">Размер оптимизированного преобразования определяется несколькими факторами: количеством цветовых каналов на исходном устройстве, количеством шагов в таблице для каждого исходного цветового канала и количеством цветовых каналов на выходном устройстве.</span><span class="sxs-lookup"><span data-stu-id="258ec-705">The size of the optimized transform is determined by several factors: the number of color channels in the source device, the number of steps in the table for each source color channel, and the number of color channels in the output device.</span></span> <span data-ttu-id="258ec-706">Для определения размера таблицы преобразования используется следующая формула:</span><span class="sxs-lookup"><span data-stu-id="258ec-706">The formula for determining the transform table size is:</span></span>

<span data-ttu-id="258ec-707">Размер = число шагов на один <sub>Источник канала \ устройство (число \ из \ каналы \ в \ исходное \ устройство)</sub> x число каналов на выходном устройстве</span><span class="sxs-lookup"><span data-stu-id="258ec-707">Size = Number of steps per channel <sub>source\ device(Number\ of\ channels\ in\ source\ device)</sub> x number of channels in output device</span></span>

<span data-ttu-id="258ec-708">Как видите, размер таблицы растет экспоненциально в зависимости от количества каналов на исходном устройстве.</span><span class="sxs-lookup"><span data-stu-id="258ec-708">As you can see, the size of the table grows exponentially depending on the number of channels in the source device.</span></span> <span data-ttu-id="258ec-709">Многие исходные устройства поддерживают три цветовых канала, например красный, зеленый и синий.</span><span class="sxs-lookup"><span data-stu-id="258ec-709">Many source devices support three color channels, for example,Red, Green, and Blue.</span></span> <span data-ttu-id="258ec-710">Однако если исходное устройство поддерживает четыре канала, например CMYK, размер таблицы и время, необходимое для создания таблицы, увеличиваются с учетом количества шагов.</span><span class="sxs-lookup"><span data-stu-id="258ec-710">However, if a source device supports four channels, such as CMYK, the size of the table and the time required to construct the table grow by a factor of the number of steps.</span></span> <span data-ttu-id="258ec-711">В CMS на основе измерения, где преобразования создаются "на лету", это время может быть неприемлемым.</span><span class="sxs-lookup"><span data-stu-id="258ec-711">In a measurement-based CMS where transforms are constructed "on the fly," this time may well be unacceptable.</span></span>

<span data-ttu-id="258ec-712">Чтобы сократить время, необходимое для создания таблицы преобразования цветов, можно воспользоваться преимуществами двух фактов.</span><span class="sxs-lookup"><span data-stu-id="258ec-712">To reduce the time required to construct the color conversion table, it is possible to take advantage of two facts.</span></span> <span data-ttu-id="258ec-713">Во-первых, хотя исходное устройство может поддерживать более трех цветовых каналов, в промежуточном аппаратном пространстве (CIECAM02 ja <sub>c</sub> b <sub>c</sub> ) имеется только три цветовых канала.</span><span class="sxs-lookup"><span data-stu-id="258ec-713">First, while the source device may support more than three color channels, the intermediate device-independent color space (CIECAM02 Ja <sub>C</sub> b <sub>C</sub> ) has only three color channels.</span></span> <span data-ttu-id="258ec-714">Во-вторых, наиболее трудоемкая часть обработки не является моделированием устройств (преобразование из цветовых координат устройства в значения тристимулус), но сопоставление палитры.</span><span class="sxs-lookup"><span data-stu-id="258ec-714">Second, the most time-consuming part of the processing is not the device modeling (converting from device color coordinates to tristimulus values), but the gamut mapping.</span></span> <span data-ttu-id="258ec-715">Используя эти факты, можно создать предварительную таблицу преобразования цветов, которая преобразует цвета в аппаратно-независимом цветовом пространстве с помощью шагов сопоставления палитры и, наконец, через цветовую модель устройства вывода.</span><span class="sxs-lookup"><span data-stu-id="258ec-715">Using these facts, you can construct a preliminary color conversion table that converts colors in the device-independent color space through the gamut mapping steps, and finally, through the output device color model.</span></span> <span data-ttu-id="258ec-716">Конструкция этой таблицы состоит из трех измерений.</span><span class="sxs-lookup"><span data-stu-id="258ec-716">Construction of this table is of dimension three.</span></span> <span data-ttu-id="258ec-717">Затем мы создаем измерение четыре итоговые таблицы преобразования цветов путем преобразования сочетаний исходных цветов в промежуточное, независимое от устройства пространство, а затем, используя предварительную таблицу преобразования цветов, завершите преобразование в цветовое пространство выходного устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-717">Then we construct the dimension four final color-conversion table by converting the source color combinations to intermediate device-independent space, and then, using the preliminary color-conversion table, finish the conversion to the output device color space.</span></span> <span data-ttu-id="258ec-718">Таким образом, сокращение от вычислений (число шагов в таблице подстановки) при сопоставлении цветовой гаммы " <sub>число \ из \ каналов</sub> " вычисляется до количества шагов в промежуточной таблице, вычисленных при сопоставлении палитры ₃.</span><span class="sxs-lookup"><span data-stu-id="258ec-718">So you reduce from computing (number of steps in the lookup table) <sub>number\ of\ channels</sub> gamut mapping computations to the number of steps in the intermediate table ₃ gamut mapping computations.</span></span> <span data-ttu-id="258ec-719">Несмотря на то, что в таблице (таблица уточняющих запросов) с <sub>числом вычислений \ of-Channels</sub> для моделирования устройств и трехмерных уточняющих запросов необходимо выполнить ряд действий, это по-прежнему выполняется гораздо быстрее, чем в исходном вычислении.</span><span class="sxs-lookup"><span data-stu-id="258ec-719">Even though you have to perform number of steps in the (lookup table) <sub>number\ of\ channels</sub> computations of device modeling and three-dimensional table lookups, this is still much faster than the original calculation.</span></span>

<span data-ttu-id="258ec-720">Предыдущий процесс будет хорошо работать при условии, что нет необходимости передавать информацию между моделью исходного устройства и любым другим компонентом преобразования цветов.</span><span class="sxs-lookup"><span data-stu-id="258ec-720">The preceding process will work well provided that there is no need for information to pass between the source device model and any other component in the color transform.</span></span> <span data-ttu-id="258ec-721">Однако если устройство вывода и исходное устройство поддерживают черный колорант, а исходный черный колорант используется при определении выходного черного колорант, то процесс не сможет правильно передать исходные сведения о черном потоке.</span><span class="sxs-lookup"><span data-stu-id="258ec-721">However, if the output device and the source device both support a black colorant, and the source black colorant is used in determining the output black colorant, the process will fail to properly communicate the source black information.</span></span> <span data-ttu-id="258ec-722">Альтернативным процессом является создание предварительной таблицы преобразования цветов, которая преобразует цвета в аппаратно-независимом цветовом пространстве с помощью шагов сопоставления палитры.</span><span class="sxs-lookup"><span data-stu-id="258ec-722">An alternative process is to construct a preliminary color conversion table that converts colors in the device-independent color space through the gamut mapping steps only.</span></span> <span data-ttu-id="258ec-723">Затем создайте таблицу Dimension с четырьмя таблицами преобразования цветов, выполнив следующие действия. а) преобразование сочетаний цветов источника в промежуточное независимое от устройства пространство б) выполнение шагов сопоставления палитры путем интерполяции в предварительной таблице цветов вместо применения фактических процессов сопоставления цветовой гаммы и c) Используйте результирующие значения из шагов сопоставления палитры и любые исходные данные черного канала, чтобы вычислить выходное устройство колорантс с помощью модели выходного устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-723">Then construct the dimension four final color-conversion table using the following steps: a) convert the source color combinations to intermediate device-independent space, b) perform the gamut mapping steps by interpolating in the preliminary color table instead of applying the actual gamut mapping processes, and c) use the resulting values from the gamut mapping steps and any source black channel information to compute the output device colorants using the output device model.</span></span> <span data-ttu-id="258ec-724">Этот процесс также можно использовать при передаче данных между моделями исходного и выходного устройств, даже если отсутствует черный канал. Например, если два модуля реализуются с помощью подключаемой архитектуры, обеспечивающей обмен данными между модулями.</span><span class="sxs-lookup"><span data-stu-id="258ec-724">This process also can be used when there is information transferred between the source and output device models even if there is no black channel; for example, if the two modules are implemented with a plug-in architecture that allows for data interchange between modules.</span></span>

<span data-ttu-id="258ec-725">Описанные выше два процесса можно использовать для эффективного увеличения времени, необходимого для создания таблицы преобразования объемом четырех цветов.</span><span class="sxs-lookup"><span data-stu-id="258ec-725">The preceding two processes can be used to effectively improve the time required to construct the four-dimensional color transform table.</span></span>

### <a name="checkgamut"></a><span data-ttu-id="258ec-726">чеккгамут</span><span class="sxs-lookup"><span data-stu-id="258ec-726">CheckGamut</span></span>

<span data-ttu-id="258ec-727">ICM вызывает Креатетрансформ и **креатемултипрофилетрансформ** принимает слова значений флагов, одно из которых включает \_ проверку цветовой гаммы \_ .</span><span class="sxs-lookup"><span data-stu-id="258ec-727">The ICM calls CreateTransform and **CreateMultiProfileTransform** take a word of flag values, one of which is ENABLE\_GAMUT\_CHECKING.</span></span> <span data-ttu-id="258ec-728">Если этот флаг установлен, в параметре set необходимо создать преобразование по-другому.</span><span class="sxs-lookup"><span data-stu-id="258ec-728">When this flag is set, CITE must create the transform differently.</span></span> <span data-ttu-id="258ec-729">Начальные шаги одинаковы: исходный и целевой видеорегистраторов должны быть инициализированы, а затем должны быть инициализированы исходные и целевые дескрипторы границ цветового охвата.</span><span class="sxs-lookup"><span data-stu-id="258ec-729">The initial steps are the same: the source and destination CAMs must be initialized, then the source and destination gamut boundary descriptors must be initialized.</span></span> <span data-ttu-id="258ec-730">Независимо от указанного намерения необходимо использовать Чеккгамут ГММ.</span><span class="sxs-lookup"><span data-stu-id="258ec-730">Regardless of the specified intent, the CheckGamut GMM must be used.</span></span> <span data-ttu-id="258ec-731">Чеккгамут ГММ должен быть инициализирован с использованием исходных и целевых моделей устройств и дескрипторов границ цветовой гаммы.</span><span class="sxs-lookup"><span data-stu-id="258ec-731">The CheckGamut GMM should be initialized using the source and destination device models and gamut boundary descriptors.</span></span> <span data-ttu-id="258ec-732">Однако преобразование должно создать усеченное преобразование, включающее в себя модель исходного устройства, исходную камера, все промежуточные ГММС и Чеккгамут ГММ.</span><span class="sxs-lookup"><span data-stu-id="258ec-732">However, the transform should then create a truncated transform comprising the source device model, the source CAM, any intervening GMMs, and the CheckGamut GMM.</span></span> <span data-ttu-id="258ec-733">Это гарантирует, что выходные данные Дельта J, Дельта C и Дельта h, выводимые модулями CMM Чеккгамут, становятся окончательными результирующими значениями.</span><span class="sxs-lookup"><span data-stu-id="258ec-733">This assures that the delta J, delta C, and delta h values output by the CheckGamut CMM become the final resulting values.</span></span>

<span data-ttu-id="258ec-734">Значение Чеккгамут ясно, если в преобразовании имеется только два профиля устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-734">The meaning of CheckGamut is clear when there are only two device profiles in the transform.</span></span> <span data-ttu-id="258ec-735">Если имеется более двух профилей устройств и более двух ГММС, то Чеккгамут сообщает о том, были ли цвета, преобразованные с помощью первой модели устройства, а также все ГММ, кроме последней, попадают в охват целевого устройства.</span><span class="sxs-lookup"><span data-stu-id="258ec-735">When there are more than two device profiles and more than two GMMs, then CheckGamut reports whether the colors which have been transformed through the first device model and all but the last GMM fall within the gamut of the destination device.</span></span>

## <a name="related-topics"></a><span data-ttu-id="258ec-736">См. также</span><span class="sxs-lookup"><span data-stu-id="258ec-736">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="258ec-737">Основные понятия управления цветом</span><span class="sxs-lookup"><span data-stu-id="258ec-737">Basic color management concepts</span></span>](basic-color-management-concepts.md)
</dt> <dt>

[<span data-ttu-id="258ec-738">Схемы и алгоритмы цветовой системы Windows</span><span class="sxs-lookup"><span data-stu-id="258ec-738">Windows Color System Schemas and Algorithms</span></span>](windows-color-system-schemas-and-algorithms.md)
</dt> </dl>

 

 




