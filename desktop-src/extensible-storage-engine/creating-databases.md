---
description: 'Дополнительные сведения: создание баз данных'
title: Создание баз данных
TOCTitle: Creating Databases
ms:assetid: d221144d-f777-4f8a-80ca-2ebdb77108dc
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294100(v=EXCHG.10)
ms:contentKeyID: 32765715
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eac708b64837fc79fa8a5060df7deb93ec552e49
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711320"
---
# <a name="creating-databases"></a><span data-ttu-id="5dc33-103">Создание баз данных</span><span class="sxs-lookup"><span data-stu-id="5dc33-103">Creating Databases</span></span>


<span data-ttu-id="5dc33-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="5dc33-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="creating-databases"></a><span data-ttu-id="5dc33-105">Создание баз данных</span><span class="sxs-lookup"><span data-stu-id="5dc33-105">Creating Databases</span></span>

<span data-ttu-id="5dc33-106">База данных ESE состоит из одной или нескольких таблиц, которые упорядочивают данные по столбцам и строкам.</span><span class="sxs-lookup"><span data-stu-id="5dc33-106">The ESE database comprises one or more tables that organize data by columns and rows.</span></span> <span data-ttu-id="5dc33-107">База данных ESE идентифицируется по имени и ИДЕНТИФИКАТОРу базы данных.</span><span class="sxs-lookup"><span data-stu-id="5dc33-107">The ESE database is identified by name and database ID.</span></span> <span data-ttu-id="5dc33-108">База данных ESE выглядит как один файл в операционной системе Microsoft Windows; Однако внутренняя база данных хранится в виде коллекции страниц.</span><span class="sxs-lookup"><span data-stu-id="5dc33-108">An ESE database looks like a single file to the Microsoft Windows operating system; however, internally the database is stored as a collection of pages.</span></span> <span data-ttu-id="5dc33-109">Эти страницы содержат метаданные, описывающие данные в базе данных, сами данные и один или несколько индексов, которые хранят различные заказы данных.</span><span class="sxs-lookup"><span data-stu-id="5dc33-109">These pages contain metadata that describe the data in the database, the data itself, and one or more indices that store different orders of the data.</span></span> <span data-ttu-id="5dc33-110">База данных может содержать до 2 ^ 31 страниц или 16 терабайт данных для базы данных с 8 КБ страниц.</span><span class="sxs-lookup"><span data-stu-id="5dc33-110">The database may contain up to 2^31 pages, or 16 Terabytes of data for a database with 8 KB pages.</span></span>

<span data-ttu-id="5dc33-111">Приложение создает экземпляр ядра СУБД, затем создает базу данных и прикрепляет ее к экземпляру.</span><span class="sxs-lookup"><span data-stu-id="5dc33-111">The application creates an instance of the database engine, then creates a database and attaches it to the instance.</span></span> <span data-ttu-id="5dc33-112">К экземпляру с [жеткреатедатабасе](./jetcreatedatabase-function.md) или [жетаттачдатабасе](./jetattachdatabase-function.md)можно одновременно подключить до 6 баз данных.</span><span class="sxs-lookup"><span data-stu-id="5dc33-112">Up to 6 databases can be simultaneously attached to an instance with [JetCreateDatabase](./jetcreatedatabase-function.md) or [JetAttachDatabase](./jetattachdatabase-function.md).</span></span> <span data-ttu-id="5dc33-113">В базе данных должен быть запущен один или несколько сеансов, так как все последующие операции ESE выполняются в контексте сеанса.</span><span class="sxs-lookup"><span data-stu-id="5dc33-113">One or more sessions should be started within the database, because all subsequent ESE operations are performed in the context of a session.</span></span> <span data-ttu-id="5dc33-114">Для каждого потока, использующего ESE, должен быть открыт отдельный сеанс.</span><span class="sxs-lookup"><span data-stu-id="5dc33-114">A separate session should be opened for each thread using ESE.</span></span>

<span data-ttu-id="5dc33-115">Эта процедура позволяет инициализировать ESE и создать базу данных.</span><span class="sxs-lookup"><span data-stu-id="5dc33-115">This procedure will initialize ESE and create a database.</span></span>

### <a name="to-initialize-ese-and-create-a-database"></a><span data-ttu-id="5dc33-116">Инициализация ESE и создание базы данных</span><span class="sxs-lookup"><span data-stu-id="5dc33-116">To initialize ESE and create a database</span></span>

1.  <span data-ttu-id="5dc33-117">[Жеткреатеинстанце](./jetcreateinstance-function.md): создает экземпляр ядра СУБД.</span><span class="sxs-lookup"><span data-stu-id="5dc33-117">[JetCreateInstance](./jetcreateinstance-function.md): Creates an instance of the database engine.</span></span>
    
    <span data-ttu-id="5dc33-118">**Windows XP и более поздние версии:** Эта функция доступна в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="5dc33-118">**Windows XP and later:** This function is available in Windows XP and later.</span></span> <span data-ttu-id="5dc33-119">В Windows 2000 поддерживается только один экземпляр, и этот экземпляр создается неявно</span><span class="sxs-lookup"><span data-stu-id="5dc33-119">On Windows 2000, only one instance is supported and that instance is created implicitly</span></span>

2.  <span data-ttu-id="5dc33-120">[Жетсетсистемпараметер](./jetsetsystemparameter-function.md): системные параметры, влияющие на физическую структуру, такие как JET_paramLogFilePath и JET_paramSystemPath, должны быть установлены перед инициализацией экземпляра с помощью [жетинит](./jetinit-function.md).</span><span class="sxs-lookup"><span data-stu-id="5dc33-120">[JetSetSystemParameter](./jetsetsystemparameter-function.md): System parameters that the affect the physical layout such as the JET_paramLogFilePath and JET_paramSystemPath must be set before initializing the instance with [JetInit](./jetinit-function.md).</span></span> <span data-ttu-id="5dc33-121">Параметры, заданные на этом этапе, задаются для всех баз данных, создаваемых в экземпляре.</span><span class="sxs-lookup"><span data-stu-id="5dc33-121">The parameters set at this stage are set for all databases created in the instance.</span></span> <span data-ttu-id="5dc33-122">[Жетсетсистемпараметер](./jetsetsystemparameter-function.md) — это единственная функция, которая может использовать экземпляр перед его инициализацией с помощью [жетинит](./jetinit-function.md).</span><span class="sxs-lookup"><span data-stu-id="5dc33-122">[JetSetSystemParameter](./jetsetsystemparameter-function.md) is the only function that can use the instance before it is initialized with [JetInit](./jetinit-function.md).</span></span>

3.  <span data-ttu-id="5dc33-123">[Жетинит](./jetinit-function.md): Инициализирует экземпляр.</span><span class="sxs-lookup"><span data-stu-id="5dc33-123">[JetInit](./jetinit-function.md): Initializes the instance.</span></span> <span data-ttu-id="5dc33-124">Экземпляр должен быть инициализирован с помощью [жетинит](./jetinit-function.md) , прежде чем его можно будет использовать с другими функциями.</span><span class="sxs-lookup"><span data-stu-id="5dc33-124">Instance must be initialized with [JetInit](./jetinit-function.md) before it can be used with any other functions.</span></span>

4.  <span data-ttu-id="5dc33-125">[Жетбегинсессион](./jetbeginsession-function.md): создает сеанс для всех последующих транзакций.</span><span class="sxs-lookup"><span data-stu-id="5dc33-125">[JetBeginSession](./jetbeginsession-function.md): Creates the session for all subsequent transactions.</span></span> <span data-ttu-id="5dc33-126">Все транзакции базы данных выполняются в контексте сеанса ([JET_SESID](./jet-sesid.md)).</span><span class="sxs-lookup"><span data-stu-id="5dc33-126">All database transactions take place in the context of the session ([JET_SESID](./jet-sesid.md)).</span></span>

5.  <span data-ttu-id="5dc33-127">[Жеткреатедатабасе](./jetcreatedatabase-function.md): создает базу данных и возвращает маркер в идентификатор базы данных ([JET_DBID](./jet-dbid.md)).</span><span class="sxs-lookup"><span data-stu-id="5dc33-127">[JetCreateDatabase](./jetcreatedatabase-function.md): Creates the database and returns a handle to the database ID ([JET_DBID](./jet-dbid.md)).</span></span>
    
    <span data-ttu-id="5dc33-128">Если база данных уже существует, шаг 5 выше заменяется следующими двумя шагами.</span><span class="sxs-lookup"><span data-stu-id="5dc33-128">If the database already exists, step 5 above is replaced by the following two steps:</span></span>
    
    1.  <span data-ttu-id="5dc33-129">[Жетаттачдатабасе](./jetattachdatabase-function.md): присоединение базы данных по имени к сеансу</span><span class="sxs-lookup"><span data-stu-id="5dc33-129">[JetAttachDatabase](./jetattachdatabase-function.md): Attaches the database by name to the session</span></span>
    
    2.  <span data-ttu-id="5dc33-130">[Жетопендатабасе](./jetopendatabase-function.md): Возвращает идентификатор базы данных, используемый в последующих операциях с базой данных.</span><span class="sxs-lookup"><span data-stu-id="5dc33-130">[JetOpenDatabase](./jetopendatabase-function.md): Returns the database ID that is used in subsequent database operations.</span></span>

<span data-ttu-id="5dc33-131">Базу данных можно отсоединить от одного экземпляра ESE с помощью [жетдетачдатабасе](./jetdetachdatabase-function.md) и более поздних присоединенных к другому экземпляру с помощью [жетаттачдатабасе](./jetattachdatabase-function.md).</span><span class="sxs-lookup"><span data-stu-id="5dc33-131">A database can be detached from one ESE instance using [JetDetachDatabase](./jetdetachdatabase-function.md) and later attached to another instance with [JetAttachDatabase](./jetattachdatabase-function.md).</span></span> <span data-ttu-id="5dc33-132">При отсоединении базы данных ее можно скопировать как один файл с помощью стандартных служебных программ Windows.</span><span class="sxs-lookup"><span data-stu-id="5dc33-132">When the database is detached, it can be copied as a single file using standard Windows utilities.</span></span> <span data-ttu-id="5dc33-133">Однако если база данных подключена к экземпляру ESE, она не может быть скопирована, так как ESE открывает только файлы базы данных.</span><span class="sxs-lookup"><span data-stu-id="5dc33-133">However, when the database is attached to an ESE instance it cannot be copied since ESE opens database files exclusively.</span></span> <span data-ttu-id="5dc33-134">Кроме того, в случае сбоя экземпляра файл базы данных не может быть скопирован отдельно, так как для восстановления после сбоя требуется, чтобы файлы журнала транзакций были связаны с ним.</span><span class="sxs-lookup"><span data-stu-id="5dc33-134">Also, if the instance crashes then the database file cannot be copied alone because it needs the transaction log files associated with it to recover from that crash.</span></span>
