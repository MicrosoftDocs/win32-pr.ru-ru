---
description: 'Дополнительные сведения: ключ индекса'
title: Ключ индекса
TOCTitle: Index Key
ms:assetid: 104bdb1c-71ac-44f4-bbda-c553131aaad4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269188(v=EXCHG.10)
ms:contentKeyID: 32765491
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eff0812f363fa83d133ab087140d415d8e2dbad3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104549789"
---
# <a name="index-key"></a><span data-ttu-id="f93ee-103">Ключ индекса</span><span class="sxs-lookup"><span data-stu-id="f93ee-103">Index Key</span></span>


<span data-ttu-id="f93ee-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="f93ee-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="index-key"></a><span data-ttu-id="f93ee-105">Ключ индекса</span><span class="sxs-lookup"><span data-stu-id="f93ee-105">Index Key</span></span>

<span data-ttu-id="f93ee-106">Индекс создается для данных в таблице с [жеткреатеиндекс](./jetcreateindex-function.md) или несколько индексов можно создать одновременно с помощью [JetCreateIndex2](./jetcreateindex2-function.md) , используя структуру [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="f93ee-106">An index is created over data in the table with [JetCreateIndex](./jetcreateindex-function.md) or multiple indexes may be created simultaneously with [JetCreateIndex2](./jetcreateindex2-function.md) using the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="f93ee-107">Индекс определяется в виде массива столбцов в порядке очередности.</span><span class="sxs-lookup"><span data-stu-id="f93ee-107">The index is defined in terms of an array of columns, in precedence order.</span></span> <span data-ttu-id="f93ee-108">Этот массив столбцов также называется ключом индекса.</span><span class="sxs-lookup"><span data-stu-id="f93ee-108">This array of columns is also called the index key.</span></span> <span data-ttu-id="f93ee-109">Ключ индекса может быть определен как первичный индекс, если параметр JET_bitIndexPrimary задан в параметре *Грбит* [жеткреатеиндекс](./jetcreateindex-function.md) или [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span><span class="sxs-lookup"><span data-stu-id="f93ee-109">The index key may be defined as the primary index when the JET_bitIndexPrimary option is set in the *grbit* parameter of [JetCreateIndex](./jetcreateindex-function.md) or [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span></span> <span data-ttu-id="f93ee-110">Ключ индекса является пустой строкой, завершающейся нулем, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="f93ee-110">The index key is a null terminated string of null terminated tokens as shown in the following example:</span></span>

<span data-ttu-id="f93ee-111">\+Col1 \\ 0-Col2 \\ 0 + Col3 \\ 0 \\ 0</span><span class="sxs-lookup"><span data-stu-id="f93ee-111">\+Col1\\0-Col2\\0+Col3\\0\\0</span></span>

<span data-ttu-id="f93ee-112">Ключ в примере можно использовать для создания индекса более чем для трех столбцов в таблице.</span><span class="sxs-lookup"><span data-stu-id="f93ee-112">The key in the example may be used to create an index over three columns in the table.</span></span> <span data-ttu-id="f93ee-113">Каждый столбец, указанный в индексе, называется "сегментом индекса" или "ключевым столбцом".</span><span class="sxs-lookup"><span data-stu-id="f93ee-113">Each column specified in the index is referred to as the "index segment" or "key column".</span></span> <span data-ttu-id="f93ee-114">Сегмент индекса может быть как по возрастанию, так и по убыванию в плане его вклада в порядок.</span><span class="sxs-lookup"><span data-stu-id="f93ee-114">The index segment may be either ascending or descending in terms of its ordering contribution.</span></span> <span data-ttu-id="f93ee-115">В приведенном выше примере имя первого столбца в индексе — col1.</span><span class="sxs-lookup"><span data-stu-id="f93ee-115">In the example above, the name of the first column in the index is Col1.</span></span> <span data-ttu-id="f93ee-116">Значение + указывает, что col1 индексируется в возрастающем порядке.</span><span class="sxs-lookup"><span data-stu-id="f93ee-116">The + indicates that Col1 is indexed in ascending order.</span></span> <span data-ttu-id="f93ee-117">Столбец "– Before" указывает, что он индексируется в убывающем порядке.</span><span class="sxs-lookup"><span data-stu-id="f93ee-117">The – before Col2 indicates that it is indexed in descending order.</span></span>

<span data-ttu-id="f93ee-118">Если в индексе имеются условные столбцы, то для указания того, как они индексируются, используется структура [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="f93ee-118">When conditional columns are present in the index, the [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) structure is used to indicate how they are indexed.</span></span> <span data-ttu-id="f93ee-119">Условный столбец может использоваться для управления присутствием или отсутствием записи индекса в индексе на основе значения в соответствующем условном столбце, не влияя на порядок сортировки индекса.</span><span class="sxs-lookup"><span data-stu-id="f93ee-119">A conditional column may be used to control the presence or absence of an index entry in an index based on the value in the corresponding conditional column without affecting the sort order of the index.</span></span> <span data-ttu-id="f93ee-120">Условный столбец может включать или исключать запись индекса из индекса, если значение этого условного столбца равно NULL для соответствующей записи.</span><span class="sxs-lookup"><span data-stu-id="f93ee-120">A conditional column may include or exclude an index entry from the index if the value of that conditional column is NULL for the corresponding record.</span></span>

<span data-ttu-id="f93ee-121">По умолчанию максимальный размер ключа индекса задается JET_cbKeyMost константе, которая всегда составляет 255 байт нормализованных данных (в байтах данных, включая затраты на индексирование).</span><span class="sxs-lookup"><span data-stu-id="f93ee-121">By default, the maximum size of the index key is given by the JET_cbKeyMost constant which has always been 255 bytes of normalized data (bytes of data including the indexing overhead).</span></span> <span data-ttu-id="f93ee-122">Начиная с Windows Vista, максимальный размер ключа индекса можно задать с помощью структуры [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="f93ee-122">Starting with Windows Vista, the maximum size of the index key can be set with the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="f93ee-123">Максимальный размер ключа индекса соответствует размеру страницы базы данных.</span><span class="sxs-lookup"><span data-stu-id="f93ee-123">The maximum size of the index key corresponds to the database page size.</span></span> <span data-ttu-id="f93ee-124">Чтобы включить настраиваемый максимальный размер ключа, укажите параметр Jet_bitIndexKeyMost в элементе грбитс в [JET_INDEXCREATE](./jet-indexcreate-structure.md)и присвойте элементу **кбкэймост** одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="f93ee-124">To enable a custom maximum key size, specify the Jet_bitIndexKeyMost option in the grbits member of [JET_INDEXCREATE](./jet-indexcreate-structure.md), and set the **cbKeyMost** member to one of the following values:</span></span>

  - <span data-ttu-id="f93ee-125">JET_cbKeyMost2KBytePage: Если размер страницы базы данных составляет 2048 байт, максимальный размер ключа индекса может составлять от 255 до 500 минимум байт.</span><span class="sxs-lookup"><span data-stu-id="f93ee-125">JET_cbKeyMost2KBytePage: When the database page size is 2048 bytes, the maximum index key size can be between 255 bytes minimum, and 500 bytes maximum.</span></span>

  - <span data-ttu-id="f93ee-126">JET_cbKeyMost4KBytePage: Если размер страницы базы данных составляет 4096 байт, максимальный размер ключа индекса может составлять от 255 до 1000 минимум байт.</span><span class="sxs-lookup"><span data-stu-id="f93ee-126">JET_cbKeyMost4KBytePage: When the database page size is 4096 bytes, the maximum index key size can be between 255 bytes minimum, and 1000 bytes maximum.</span></span>

  - <span data-ttu-id="f93ee-127">JET_cbKeyMost8KBytePage: Если размер страницы базы данных составляет 8196 байт, максимальный размер ключа индекса может составлять от 255 до 2000 минимум байт.</span><span class="sxs-lookup"><span data-stu-id="f93ee-127">JET_cbKeyMost8KBytePage: When the database page size is 8196 bytes, the maximum index key size can be between 255 bytes minimum, and 2000 bytes maximum.</span></span>

<span data-ttu-id="f93ee-128">В примере на схеме ниже показана таблица, содержащая сведения о сотрудниках.</span><span class="sxs-lookup"><span data-stu-id="f93ee-128">The example in the diagram below shows a table containing employee information.</span></span> <span data-ttu-id="f93ee-129">Таблица содержит 6 столбцов, каждый из которых определяет определенный атрибут Employee.</span><span class="sxs-lookup"><span data-stu-id="f93ee-129">The table has 6 columns, each defining a specific employee attribute.</span></span> <span data-ttu-id="f93ee-130">Запись в таблице содержит значения для сотрудника, например имя сотрудника в столбце 1 и идентификатор сотрудника в столбце 2.</span><span class="sxs-lookup"><span data-stu-id="f93ee-130">A record in the table contains values for an employee, such as the employee name in column 1 and employee ID in column 2.</span></span> <span data-ttu-id="f93ee-131">Первичный индекс, созданный для этой таблицы, упорядочивает данные в соответствии с именем сотрудника, а второй — с ИДЕНТИФИКАТОРом сотрудника.</span><span class="sxs-lookup"><span data-stu-id="f93ee-131">A primary index created for this table organizes the data according to the employee name first, and the employee ID second.</span></span> <span data-ttu-id="f93ee-132">Имя и идентификатор индексируются в возрастающем порядке.</span><span class="sxs-lookup"><span data-stu-id="f93ee-132">Both name and ID are indexed in ascending order.</span></span> <span data-ttu-id="f93ee-133">Например, запись, содержащая имя Джонсон и идентификатор сотрудника 12345, будет указана перед записью с именем сотрудника Jones и ИДЕНТИФИКАТОРом 10000.</span><span class="sxs-lookup"><span data-stu-id="f93ee-133">For example, a record containing the name Johnson and employee ID 12345 will be listed before of a record with an employee name Jones and an ID of 10000.</span></span> <span data-ttu-id="f93ee-134">Все записи для Jones хранятся в таблице вместе с идентификаторами сотрудников в возрастающем порядке, как показано в таблице.</span><span class="sxs-lookup"><span data-stu-id="f93ee-134">All the records for Jones are stored together in the table, with their employee IDs in ascending order as shown in the table.</span></span>

<span data-ttu-id="f93ee-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span><span class="sxs-lookup"><span data-stu-id="f93ee-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span></span>

<span data-ttu-id="f93ee-136">Ключ в первичном индексе должен быть уникальным, но ключи в дополнительном индексе могут быть повторяющимися.</span><span class="sxs-lookup"><span data-stu-id="f93ee-136">The key in the primary index must be unique, but the keys in the secondary index can be duplicates.</span></span> <span data-ttu-id="f93ee-137">Например, если индекс создан над фамилией и в базе данных есть два человека с Стивенс, то ESE возвращает ошибку Jet_errKeyDuplicate из [жетупдате](./jetupdate-function.md) или [JetUpdate2](./jetupdate2-function.md), когда приложение пытается вставить второй "Стивенс".</span><span class="sxs-lookup"><span data-stu-id="f93ee-137">For example, if an index is created over last name, and there are two people with Stevens in the database, ESE returns a Jet_errKeyDuplicate error from [JetUpdate](./jetupdate-function.md) or [JetUpdate2](./jetupdate2-function.md), when the application attempts to insert the second "Stevens".</span></span> <span data-ttu-id="f93ee-138">Если фактический ключ больше, чем максимальный размер ключа, ключ усекается.</span><span class="sxs-lookup"><span data-stu-id="f93ee-138">When the actual key is larger than the maximum key size, the key is truncated.</span></span> <span data-ttu-id="f93ee-139">Результаты усечения ключа осуществляют поиск и уникальность и должны управляться приложением.</span><span class="sxs-lookup"><span data-stu-id="f93ee-139">Key truncation effects searching and uniqueness and should be managed by the application.</span></span> <span data-ttu-id="f93ee-140">Например, если "Стивенс" и "Стевенсон" хранились в индексе по фамилии, а максимальный размер ключа был слишком мал для хранения "on" части "Стевенсон", то при усечении ключа будет обнаружено, что ядро СУБД объявило, что "Стивенс" и "Стевенсон" дублируются, даже если это не так.</span><span class="sxs-lookup"><span data-stu-id="f93ee-140">For example, if "Stevens" and "Stevenson" were stored in an index over last name and the max key size were too small to store the "on" portion of "Stevenson" then key truncation would result in the database engine declaring that "Stevens" and "Stevenson" are duplicates even though they are not.</span></span> <span data-ttu-id="f93ee-141">Приложение должно быть подготовлено для обработки подобных ситуаций во время поиска и обновления, если определение индекса и значения столбцов, которые он индексирует, имеют такое усечение ключа.</span><span class="sxs-lookup"><span data-stu-id="f93ee-141">The application must be prepared to handle cases like this during search and update if the index definition and the column values it indexes are such that key truncation is a possibility.</span></span> <span data-ttu-id="f93ee-142">Начиная с Windows Vista, приложения могут указать параметр Jet_bitIndexDisallowTruncation в [JET_INDEXCREATE](./jet-indexcreate-structure.md) или [жетмакекэй](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="f93ee-142">Starting in Windows Vista, applications can specify the Jet_bitIndexDisallowTruncation option in [JET_INDEXCREATE](./jet-indexcreate-structure.md) or [JetMakeKey](./jetmakekey-function.md).</span></span> <span data-ttu-id="f93ee-143">При указании этого флага любое обновление индекса приведет к сбою усечения ключа с JET_errKeyTruncated.</span><span class="sxs-lookup"><span data-stu-id="f93ee-143">Specifying this flag will cause any update to the index that would result in a truncated key to fail with JET_errKeyTruncated.</span></span> <span data-ttu-id="f93ee-144">В противном случае ключи будут обрезаны без уведомления.</span><span class="sxs-lookup"><span data-stu-id="f93ee-144">Otherwise, keys will be silently truncated.</span></span> <span data-ttu-id="f93ee-145">Это позволит приложению работать без проблем для артефактов, вызванных усечением ключа, описанным выше.</span><span class="sxs-lookup"><span data-stu-id="f93ee-145">This will allow the application to function without concern for the artifacts caused by key truncation that were previously described.</span></span>
