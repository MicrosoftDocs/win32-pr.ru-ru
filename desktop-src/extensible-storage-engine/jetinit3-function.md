---
description: Дополнительные сведения о функции JetInit3
title: Функция JetInit3
TOCTitle: JetInit3 Function
ms:assetid: 752589b6-1b8f-4b6f-a14a-00f4b1405db5
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269296(v=EXCHG.10)
ms:contentKeyID: 32765588
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetInit3
- JetInit3A
- JetInit3W
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 0a0c73343550768a9ccd061c702fae89d562d095
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122477910"
---
# <a name="jetinit3-function"></a>Функция JetInit3


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetinit3-function"></a>Функция JetInit3

Функция **JetInit3** помещает ядро СУБД в состояние, в котором оно может поддерживать использование файлов базы данных приложением. Подсистема уже должна быть правильно настроена для инициализации, которую можно выполнить с помощью функции [жетсетсистемпараметер](./jetsetsystemparameter-function.md) . Обратите внимание, что восстановление после сбоя базы данных происходит автоматически в рамках процесса инициализации.

**Windows vista:****JetInit3** появился в Windows Vista.  

```cpp
    JET_ERR JET_API JetInit3(
      __in_out_opt  JET_INSTANCE* pinstance,
      __in_opt      JET_RSTINFO* prstInfo,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*пинстанце*

Экземпляр, используемый для конкретного вызова. Использование этого параметра зависит от режима работы ядра. если ядро работает в режиме legacy (Windows 2000), в котором поддерживается только один экземпляр, можно установить этот параметр в **значение NULL** или в допустимый выходной буфер, содержащий **null** или JET_instanceNil, который возвращает глобальный экземпляр, созданный в качестве побочного результата инициализации. Этот экземпляр можно передать в любой другой API, который принимает экземпляр. Если ядро работает в режиме с несколькими экземплярами, необходимо присвоить этому параметру Допустимый входной буфер, содержащий экземпляр, возвращаемый функцией [жеткреатеинстанце](./jetcreateinstance-function.md) , которая инициализируется.

*прстинфо*

Дополнительные параметры восстановления, используемые для повторного сопоставления баз данных во время восстановления, для задания расположения, в котором будет прерываться восстановление, или для определения текущего состояния восстановления.

*грбит*

Группа битов, указывающая ноль или более параметров, указанных в следующей таблице.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitReplayReplicatedLogFiles</p> | <p>Это значение зарезервировано для использования в будущем.</p> | 
| <p>JET_bitCreateSFSVolumeIfNotExist</p> | <p>Это значение зарезервировано для использования в будущем.</p> | 
| <p>JET_bitReplayIgnoreMissingDB</p> | <p>Это значение позволяет пользователю запускать восстановление на наборе файлов журнала даже в случае отсутствия баз данных, которые были присоединены к набору файлов журнала в некоторый момент.</p> | 
| <p>JET_bitRecoveryWithoutUndo</p> | <p>Это значение позволяет пользователю выполнять восстановление, но только до (и не включая) этапа отката. С помощью этого значения можно копировать и применять дополнительные журналы транзакций.</p> | 
| <p>JET_bitTruncateLogsAfterRecovery</p> | <p>Это значение приводит к усечению файлов журнала при успешном мягком восстановлении.</p> | 
| <p>JET_bitReplayMissingMapEntryDB</p> | <p>Это значение приводит к тому, что в отсутствующей записи схемы базы данных по умолчанию устанавливается одно и то же расположение.</p> | 
| <p>JET_bitReplayIgnoreLostLogs</p> | <p>Это значение приводит к тому, что журналы, потерянные от конца потока журнала, будут игнорироваться во время восстановления.</p><p><strong>Windows 7: JET_bitReplayIgnoreLostLogs</strong> введен в Windows 7.</p> | 



### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) тип данных с одним из следующих кодов возврата. дополнительные сведения о служба хранилища возможных ошибках ESE см. в разделе [ошибки расширяемых](./extensible-storage-engine-errors.md) подсистемы служба хранилища и [параметры обработки ошибок](./error-handling-parameters.md).


#### <a name="remarks"></a>Комментарии

Экземпляр должен быть инициализирован вызовом функции **JetInit3** до того, как он может использоваться любым другим, кроме функции [жетсетсистемпараметер](./jetsetsystemparameter-function.md) .

Экземпляр уничтожается вызовом функции [жеттерм](./jetterm-function.md) , даже если этот экземпляр никогда не был инициализирован с помощью функции [жетинит](./jetinit-function.md) . Экземпляр — это единица восстановления для ядра СУБД. Он управляет жизненным циклом всех файлов, используемых для защиты целостности данных в наборе файлов базы данных. Эти файлы включают файл контрольных точек и файлы журнала транзакций. Обратите внимание, что [жеттерм](./jetterm-function.md) не следует вызывать, если происходит сбой функции **JetInit3** . Однако [жеттерм](./jetterm-function.md) должен вызываться для всех экземпляров, созданных с помощью **JetCreateInstance2** , если **JetInit3** никогда не вызывался, или если **JetInit3** успешно.

Если восстановление выполняется на наборе журналов, для которых имеются не все связанные базы данных (возвращающие ошибку JET_errAttachedDatabaseMismatch в нормальных обстоятельствах), и клиент хочет, чтобы восстановление продолжалось, несмотря на отсутствующие базы данных, то JET_bitReplayIgnoreMissingDB ошибка используется для продолжения восстановления доступных баз данных.

Так как восстановление после сбоя обычно происходит не на том же компьютере (и с той же конфигурацией), что и во время сбоя, база данных обычно не меняет расположение. В некоторых сценариях, таких как перемещение файлов на другой компьютер или восстановление резервной копии моментальных снимков в разные места, это не так. Функция **JetInit3** позволяет указать сопоставление (с использованием структур [JET_RSTINFO](./jet-rstinfo-structure.md) и [JET_RSTMAP](./jet-rstmap-structure.md) ) между старым расположением базы данных и ее новым расположением. На самом деле требуется только новое расположение, если файлы базы данных находятся в этом расположении. Как только вы узнаете о расположении восстановленных баз данных, подпись базы данных будет использоваться для обнаружения базы данных в процессе восстановления. Исходное расположение базы данных потребуется только в том случае, если необходимо повторно создать базу данных, в этом случае подпись будет известна.

Кроме того, если необходимо отменить восстановление после операции отмены, можно указать конкретную точку, в которой будет прерываться восстановление. Обратите внимание, что сюда входит возможность отмены в конце конкретного создания журнала, если указанная позиция является частью поколения, но находится за концом фактического журнала.

Дополнительные сведения см. в подразделе "Примечания" раздела [жетинит](./jetinit-function.md) .

#### <a name="requirements"></a>Требования


| | | <p>Клиент</p> | <p>требуется Windows Vista.</p> | | <p>Сервер</p> | <p>требуется Windows Server 2008.</p> | | <p>Заголовок</p> | <p>Объявлено в ESENT. h.</p> | | <p>Библиотека</p> | <p>Использует ESENT. lib.</p> | | <p>DLL</p> | <p>Требуется ESENT.dll.</p> | | <p>Юникод</p> | <p>Реализуется как <strong>JetInit3W</strong> (Юникод) и <strong>JetInit3A</strong> (ANSI).</p> | 



#### <a name="see-also"></a>См. также:

[расширяемые файлы служба хранилища Engine](./extensible-storage-engine-files.md)  
[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_INSTANCE](./jet-instance.md)  
[JET_RSTINFO](./jet-rstinfo-structure.md)  
[JET_RSTMAP](./jet-rstmap-structure.md)  
[жеткреатеинстанце](./jetcreateinstance-function.md)  
[жетинит](./jetinit-function.md)  
[JetInit2](./jetinit2-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)  
[Параметры ресурсов](./resource-parameters.md)
