---
description: 'Дополнительные сведения о: дескрипторы ESE'
title: Дескрипторы ESE
TOCTitle: ESE Handles
ms:assetid: 969ae14f-3548-431d-a19d-5df92891441d
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269349(v=EXCHG.10)
ms:contentKeyID: 32765636
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: cc91a4586fc1619c55b5f45afbca39ce04c0c6cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104266211"
---
# <a name="ese-handles"></a><span data-ttu-id="48230-103">Дескрипторы ESE</span><span class="sxs-lookup"><span data-stu-id="48230-103">ESE Handles</span></span>


<span data-ttu-id="48230-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="48230-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="ese-handles"></a><span data-ttu-id="48230-105">Дескрипторы ESE</span><span class="sxs-lookup"><span data-stu-id="48230-105">ESE Handles</span></span>

<span data-ttu-id="48230-106">Дескрипторы ESE используются для создания сеансов и доступа к базам данных.</span><span class="sxs-lookup"><span data-stu-id="48230-106">ESE handles are used to create sessions and access databases.</span></span> <span data-ttu-id="48230-107">Они хранятся в иерархии. Это означает, что выходные данные одного уровня используются для доступа к ресурсам на следующем уровне.</span><span class="sxs-lookup"><span data-stu-id="48230-107">They are maintained in a hierarchy, which means that the output from one level is used to access resources at the next level.</span></span>

<span data-ttu-id="48230-108">На схеме здесь показана иерархия дескрипторов и соответствующие функции, которые создают дескрипторы.</span><span class="sxs-lookup"><span data-stu-id="48230-108">The diagram here shows the hierarchy of handles and the corresponding functions that create the handles.</span></span> <span data-ttu-id="48230-109">Кроме того, вместе с функциями обозначаются дескрипторы, которые используются в вызове для создания нового дескриптора.</span><span class="sxs-lookup"><span data-stu-id="48230-109">Also indicated along with the functions are the handles that are used in the call to create the new handle.</span></span>

<span data-ttu-id="48230-110">![ESE_Documentation_handles2](images/Gg269349.ESE_Documentation_handles2(EXCHG.10).gif "ESE_Documentation_handles2")</span><span class="sxs-lookup"><span data-stu-id="48230-110">![ESE_Documentation_handles2](images/Gg269349.ESE_Documentation_handles2(EXCHG.10).gif "ESE_Documentation_handles2")</span></span>

<span data-ttu-id="48230-111">Как показано на схеме, экземпляр — это корневой обработчик и уровень, на котором база данных восстанавливается в случае непредвиденного завершения процесса или завершения работы системы.</span><span class="sxs-lookup"><span data-stu-id="48230-111">As shown in the diagram, the instance is the root handle and the level at which the database is recovered in the event of an unexpected process termination or system shutdown.</span></span> <span data-ttu-id="48230-112">Обработчик экземпляра, JET_INSTANCE, создается [жеткреатеинстанце](./jetcreateinstance-function.md) и [JetCreateInstance2](./jetcreateinstance2-function.md).</span><span class="sxs-lookup"><span data-stu-id="48230-112">The instance handle, JET_INSTANCE, is created by [JetCreateInstance](./jetcreateinstance-function.md) and [JetCreateInstance2](./jetcreateinstance2-function.md).</span></span> <span data-ttu-id="48230-113">Следующий уровень, уровень сеанса, — это контекст транзакции ядра СУБД и уровень, под которым выполняются все операции базы данных.</span><span class="sxs-lookup"><span data-stu-id="48230-113">The next level, the session level, is the transaction context of the database engine and the level under which all database operations are performed.</span></span> <span data-ttu-id="48230-114">Обработчик сеанса, JET_SESID, создается в контексте экземпляра в вызове [жетбегинсессион](./jetbeginsession-function.md).</span><span class="sxs-lookup"><span data-stu-id="48230-114">The session handle, JET_SESID, is created in the context of the instance in the call to [JetBeginSession](./jetbeginsession-function.md).</span></span> <span data-ttu-id="48230-115">Идентификатор сеанса используется во всех последующих вызовах для доступа к таблицам и базам данных.</span><span class="sxs-lookup"><span data-stu-id="48230-115">The session ID is used in all subsequent calls to access tables and databases.</span></span> <span data-ttu-id="48230-116">Если экземпляр используется более чем одним потоком за раз, каждый поток должен использовать собственный обработчик сеанса.</span><span class="sxs-lookup"><span data-stu-id="48230-116">If the instance is being used by more than one thread at a time then each thread must use its own session handle.</span></span> <span data-ttu-id="48230-117">Маркер базы данных создается с помощью обработчика сеанса и в основном используется для управления схемой базы данных, но также может использоваться для управления таблицами в базе данных.</span><span class="sxs-lookup"><span data-stu-id="48230-117">The database handle is created using the session handle and primarily used to manage the schema of the database, but it can also be used to manage tables inside the database.</span></span> <span data-ttu-id="48230-118">Дескрипторы базы данных можно использовать только в том сеансе, в котором они созданы.</span><span class="sxs-lookup"><span data-stu-id="48230-118">Database handles can only be used in the session under which they are created.</span></span> <span data-ttu-id="48230-119">Обработчик базы данных создается при вызове [жеткреатедатабасе](./jetcreatedatabase-function.md) или [жетопендатабасе](./jetopendatabase-function.md).</span><span class="sxs-lookup"><span data-stu-id="48230-119">The handle to the database is created in the call to [JetCreateDatabase](./jetcreatedatabase-function.md) or [JetOpenDatabase](./jetopendatabase-function.md).</span></span> <span data-ttu-id="48230-120">Таблицы связаны с ИДЕНТИФИКАТОРом базы данных, в котором они были созданы.</span><span class="sxs-lookup"><span data-stu-id="48230-120">Tables are associated with the database ID under which they are created.</span></span>

<span data-ttu-id="48230-121">Тип данных JET_TABLEID содержит указатель на курсор базы данных.</span><span class="sxs-lookup"><span data-stu-id="48230-121">The JET_TABLEID data type contains a handle to a database cursor.</span></span> <span data-ttu-id="48230-122">Он используется для сканирования записей, поиска записей или создания записей обновления и удаления.</span><span class="sxs-lookup"><span data-stu-id="48230-122">It is used to scan records, search records or create update and delete records.</span></span> <span data-ttu-id="48230-123">Маркер таблицы создается в вызове [жетопентабле](./jetopentable-function.md)или [жеткреатетабле](./jetcreatetable-function.md).</span><span class="sxs-lookup"><span data-stu-id="48230-123">The table handle is created in the call to [JetOpenTable](./jetopentable-function.md), or [JetCreateTable](./jetcreatetable-function.md).</span></span> <span data-ttu-id="48230-124">[Жетопентемптабле](./jetopentemptable-function.md), [JetOpenTempTable2](./jetopentemptable2-function.md)и [JetOpenTempTable3](./jetopentemptable3-function.md) также создают идентификаторы таблиц для временных таблиц, а [жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md) и [JetCreateTableColumnIndex2](./jetcreatetablecolumnindex2-function.md) возвращают идентификаторы таблиц в выходной структуре.</span><span class="sxs-lookup"><span data-stu-id="48230-124">[JetOpenTempTable](./jetopentemptable-function.md), [JetOpenTempTable2](./jetopentemptable2-function.md), and [JetOpenTempTable3](./jetopentemptable3-function.md) also create table IDs for temporary tables, and [JetCreateTableColumnIndex](./jetcreatetablecolumnindex-function.md) and [JetCreateTableColumnIndex2](./jetcreatetablecolumnindex2-function.md) return table IDs in the out structure.</span></span> <span data-ttu-id="48230-125">Столбцы, создаваемые в таблице, имеют уникальный идентификатор столбца или COLUMN_ID.</span><span class="sxs-lookup"><span data-stu-id="48230-125">The columns created within the table each have a unique column identifier or COLUMN_ID.</span></span> <span data-ttu-id="48230-126">Идентификаторы столбцов создаются в вызовах [жетаддколумн](./jetaddcolumn-function.md)или в вызовах [жетопентемптабле](./jetopentemptable-function.md), [JetOpenTempTable2](./jetopentemptable2-function.md)или [JetOpenTempTable3](./jetopentemptable3-function.md) для временных таблиц.</span><span class="sxs-lookup"><span data-stu-id="48230-126">The columns IDs are created in the calls to [JetAddColumn](./jetaddcolumn-function.md), or in calls to [JetOpenTempTable](./jetopentemptable-function.md), [JetOpenTempTable2](./jetopentemptable2-function.md), or [JetOpenTempTable3](./jetopentemptable3-function.md) for temporary tables.</span></span> <span data-ttu-id="48230-127">Идентификаторы столбцов также могут быть извлечены для указанного столбца по имени с помощью API-интерфейсов, таких как [жетжеттаблеколумнинфо](./jetgettablecolumninfo-function.md).</span><span class="sxs-lookup"><span data-stu-id="48230-127">Column IDs may also be retrieved for a given column by name with APIs such as [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md).</span></span>
