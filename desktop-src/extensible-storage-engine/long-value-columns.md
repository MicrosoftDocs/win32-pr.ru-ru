---
description: Дополнительные сведения о столбцах с длинными значениями
title: Столбцы с длинными значениями
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072652"
---
# <a name="long-value-columns"></a>Столбцы с длинными значениями


_**Применимо к:** Windows | Windows Server_

## <a name="long-value-columns"></a>Столбцы с длинными значениями

Типы столбцов ESE JET_coltypLongText и JET_coltypLongBinary называются типами столбцов длинных значений. Эти столбцы представляют собой большие строковые и большие двоичные объекты, которые могут храниться в отдельных деревьях B + вне основного индекса. Если значения long хранятся отдельно от первичной записи, они внутренне определяются с помощью идентификатора длинных значений (крышка) и смещения в байтах и доступны в виде потока. Столбцы с длинными значениями добавляются в таблицу в вызове [жетаддколумн](./jetaddcolumn-function.md) с элементом **колтип** структуры [JET_COLUMNDEF](./jet-columndef-structure.md) , для которого задано значение JET_coltypLongText или JET_coltypLongBinary. Максимальный размер длинного текстового или длинного двоичного столбца равен 2 ГБ-1.

ESE поддерживает операции добавления, перезаписи диапазона байтов и задания размера для столбцов с длинными значениями для поддержки эффективных реализаций потоков для этих типов столбцов. По умолчанию данные длинных значений хранятся в отдельном дереве B +, если это значение превышает 1024 байт, или если запись не умещается на отдельной странице базы данных, если данные длинных значений хранятся в записи. Приложение может переопределить поведение по умолчанию, установив параметры хранения длинных значений в записи (JET_bitSetIntrinsicLV) или принудительно сохранить их в отдельном дереве B + (JET_bitSetIntrinsicLV). Эти значения задаются в параметре *грбит* в [жетсетколумн](./jetsetcolumn-function.md)или члене **грбит** , который [JET_SETCOLUMN](./jet-setcolumn-structure.md) использовать в вызове [жетсетколумнс](./jetsetcolumns-function.md) следующим образом:

  - Добавление: (JET_bitSetAppendLV)

  - Перезапись диапазона байтов: (JET_bitSetOverwriteLV)

  - Задать размер: (JET_bitSetSizeLV)

  - Принудительно разделить: (JET_bitSetSeparateLV)

  - Сохранить в записи: (JET_bitSetIntrinsicLV)

Данные о длинных значениях задаются путем указания смещения в большом двоичном объекте большого двоичного значения и длины данных длинных значений в большом двоичном объекте. Смещение для большого двоичного объекта длинного значения задается в элементе **иблонгвалуе** структуры [JET_SETINFO](./jet-setinfo-structure.md) (для [Жетсетколумн](./jetsetcolumn-function.md)) или в элементе **иблонгвалуе** структуры [JET_SETCOLUMN](./jet-setcolumn-structure.md) (для [жетсетколумнс](./jetsetcolumns-function.md)). Член **пвдата** параметра [JET_SETCOLUMN](./jet-setcolumn-structure.md)и *пвдата* в вызове [жетсетколумн](./jetsetcolumn-function.md) содержит данные типа long. Обновления столбцов длинных значений должны выполняться внутри транзакции.

Данные типа Long всегда хранятся в отдельной таблице, когда приложение задает JET_bitSetSeparateLV или JET_bitSetIntrinsicLV, в противном случае это эвристическе решение. ESE хранит длинное значение, если оно превышает 1024 байт или если запись не умещается на отдельной странице базы данных, если она хранится в записи.

На следующей диаграмме показаны данные длинных значений, хранящиеся в отдельной таблице. Если значение типа Long хранится за пределами записи, для ссылки на его значение создается новый идентификатор с длинным значением. Это позволяет нескольким записям ссылаться на одно и то же значение столбца. Счетчики ссылок на данные увеличиваются, если несколько записей точек данных указывают на одни и те же данные с длинным значением.

![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")

ESE также поддерживает функцию хранилища единственных копий, которая позволяет нескольким записям ссылаться на один большой двоичный объект, как если бы каждая запись имела собственную копию информации. таким исключением, предотвращение повторяющихся копий данных значений столбца. Эта функция включена в вызове [жетпрепареупдате](./jetprepareupdate-function.md) с параметром JET_prepInsertCopy, заданным в параметре *подготовки* .
