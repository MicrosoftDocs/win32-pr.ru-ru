---
description: Дополнительные сведения о столбцах с длинными значениями
title: Столбцы с длинными значениями
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072652"
---
# <a name="long-value-columns"></a><span data-ttu-id="5c644-103">Столбцы с длинными значениями</span><span class="sxs-lookup"><span data-stu-id="5c644-103">Long Value Columns</span></span>


<span data-ttu-id="5c644-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="5c644-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="long-value-columns"></a><span data-ttu-id="5c644-105">Столбцы с длинными значениями</span><span class="sxs-lookup"><span data-stu-id="5c644-105">Long Value Columns</span></span>

<span data-ttu-id="5c644-106">Типы столбцов ESE JET_coltypLongText и JET_coltypLongBinary называются типами столбцов длинных значений.</span><span class="sxs-lookup"><span data-stu-id="5c644-106">The ESE column types JET_coltypLongText and JET_coltypLongBinary are called long value column types.</span></span> <span data-ttu-id="5c644-107">Эти столбцы представляют собой большие строковые и большие двоичные объекты, которые могут храниться в отдельных деревьях B + вне основного индекса.</span><span class="sxs-lookup"><span data-stu-id="5c644-107">These columns are large string and large binary objects that may be stored in separate B+ trees away from the primary index.</span></span> <span data-ttu-id="5c644-108">Если значения long хранятся отдельно от первичной записи, они внутренне определяются с помощью идентификатора длинных значений (крышка) и смещения в байтах и доступны в виде потока.</span><span class="sxs-lookup"><span data-stu-id="5c644-108">When long values are stored separate from the primary record, they are internally keyed on a long value ID (LID) and byte offset and accessed as a stream.</span></span> <span data-ttu-id="5c644-109">Столбцы с длинными значениями добавляются в таблицу в вызове [жетаддколумн](./jetaddcolumn-function.md) с элементом **колтип** структуры [JET_COLUMNDEF](./jet-columndef-structure.md) , для которого задано значение JET_coltypLongText или JET_coltypLongBinary.</span><span class="sxs-lookup"><span data-stu-id="5c644-109">Long value columns are added to the table in the call to [JetAddColumn](./jetaddcolumn-function.md) with the **coltyp** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure set to either JET_coltypLongText or JET_coltypLongBinary.</span></span> <span data-ttu-id="5c644-110">Максимальный размер длинного текстового или длинного двоичного столбца равен 2 ГБ-1.</span><span class="sxs-lookup"><span data-stu-id="5c644-110">The maximum size of a Long Text or Long Binary column value is 2 GB -1.</span></span>

<span data-ttu-id="5c644-111">ESE поддерживает операции добавления, перезаписи диапазона байтов и задания размера для столбцов с длинными значениями для поддержки эффективных реализаций потоков для этих типов столбцов.</span><span class="sxs-lookup"><span data-stu-id="5c644-111">ESE supports append, byte range overwrite, and set size operations for long value columns to support efficient stream implementations on these column types.</span></span> <span data-ttu-id="5c644-112">По умолчанию данные длинных значений хранятся в отдельном дереве B +, если это значение превышает 1024 байт, или если запись не умещается на отдельной странице базы данных, если данные длинных значений хранятся в записи.</span><span class="sxs-lookup"><span data-stu-id="5c644-112">By default, long value data is stored in a separate B+ tree if it is larger than 1024 bytes, or if the record does not fit on a single database page when the long value data is stored in the record.</span></span> <span data-ttu-id="5c644-113">Приложение может переопределить поведение по умолчанию, установив параметры хранения длинных значений в записи (JET_bitSetIntrinsicLV) или принудительно сохранить их в отдельном дереве B + (JET_bitSetIntrinsicLV).</span><span class="sxs-lookup"><span data-stu-id="5c644-113">The application has the option to override the default behavior by setting options to store long value data in the record (JET_bitSetIntrinsicLV) or to force them to be stored in the separate B+ tree (JET_bitSetIntrinsicLV).</span></span> <span data-ttu-id="5c644-114">Эти значения задаются в параметре *грбит* в [жетсетколумн](./jetsetcolumn-function.md)или члене **грбит** , который [JET_SETCOLUMN](./jet-setcolumn-structure.md) использовать в вызове [жетсетколумнс](./jetsetcolumns-function.md) следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5c644-114">These values are set in the *grbit* parameter in [JetSetColumn](./jetsetcolumn-function.md), or the **grbit** member [JET_SETCOLUMN](./jet-setcolumn-structure.md) used in the call to [JetSetColumns](./jetsetcolumns-function.md) as follows:</span></span>

  - <span data-ttu-id="5c644-115">Добавление: (JET_bitSetAppendLV)</span><span class="sxs-lookup"><span data-stu-id="5c644-115">Append: (JET_bitSetAppendLV)</span></span>

  - <span data-ttu-id="5c644-116">Перезапись диапазона байтов: (JET_bitSetOverwriteLV)</span><span class="sxs-lookup"><span data-stu-id="5c644-116">Byte Range Overwrite: (JET_bitSetOverwriteLV)</span></span>

  - <span data-ttu-id="5c644-117">Задать размер: (JET_bitSetSizeLV)</span><span class="sxs-lookup"><span data-stu-id="5c644-117">Set Size: (JET_bitSetSizeLV)</span></span>

  - <span data-ttu-id="5c644-118">Принудительно разделить: (JET_bitSetSeparateLV)</span><span class="sxs-lookup"><span data-stu-id="5c644-118">Force Separate: (JET_bitSetSeparateLV)</span></span>

  - <span data-ttu-id="5c644-119">Сохранить в записи: (JET_bitSetIntrinsicLV)</span><span class="sxs-lookup"><span data-stu-id="5c644-119">Store In Record: (JET_bitSetIntrinsicLV)</span></span>

<span data-ttu-id="5c644-120">Данные о длинных значениях задаются путем указания смещения в большом двоичном объекте большого двоичного значения и длины данных длинных значений в большом двоичном объекте.</span><span class="sxs-lookup"><span data-stu-id="5c644-120">The long value data is set by indicating the offset into the long value blob, and the length of the long value data in the blob.</span></span> <span data-ttu-id="5c644-121">Смещение для большого двоичного объекта длинного значения задается в элементе **иблонгвалуе** структуры [JET_SETINFO](./jet-setinfo-structure.md) (для [Жетсетколумн](./jetsetcolumn-function.md)) или в элементе **иблонгвалуе** структуры [JET_SETCOLUMN](./jet-setcolumn-structure.md) (для [жетсетколумнс](./jetsetcolumns-function.md)).</span><span class="sxs-lookup"><span data-stu-id="5c644-121">The offset to the long value blob is set in the **ibLongValue** member of [JET_SETINFO](./jet-setinfo-structure.md) structure (for [JetSetColumn](./jetsetcolumn-function.md)) or the **ibLongValue** member of the [JET_SETCOLUMN](./jet-setcolumn-structure.md) structure (for [JetSetColumns](./jetsetcolumns-function.md)).</span></span> <span data-ttu-id="5c644-122">Член **пвдата** параметра [JET_SETCOLUMN](./jet-setcolumn-structure.md)и *пвдата* в вызове [жетсетколумн](./jetsetcolumn-function.md) содержит данные типа long.</span><span class="sxs-lookup"><span data-stu-id="5c644-122">The **pvData** member of [JET_SETCOLUMN](./jet-setcolumn-structure.md), and *pvData* parameter in the call to [JetSetColumn](./jetsetcolumn-function.md) contains the long value data.</span></span> <span data-ttu-id="5c644-123">Обновления столбцов длинных значений должны выполняться внутри транзакции.</span><span class="sxs-lookup"><span data-stu-id="5c644-123">Updates to long value columns must be performed inside a transaction.</span></span>

<span data-ttu-id="5c644-124">Данные типа Long всегда хранятся в отдельной таблице, когда приложение задает JET_bitSetSeparateLV или JET_bitSetIntrinsicLV, в противном случае это эвристическе решение.</span><span class="sxs-lookup"><span data-stu-id="5c644-124">The long value data is always stored in a separate table is when the application sets the JET_bitSetSeparateLV or JET_bitSetIntrinsicLV, otherwise it is heuristically decided.</span></span> <span data-ttu-id="5c644-125">ESE хранит длинное значение, если оно превышает 1024 байт или если запись не умещается на отдельной странице базы данных, если она хранится в записи.</span><span class="sxs-lookup"><span data-stu-id="5c644-125">ESE stores the long value separated if it is larger than 1024 bytes or if the record would not fit on a single database page if stored in record.</span></span>

<span data-ttu-id="5c644-126">На следующей диаграмме показаны данные длинных значений, хранящиеся в отдельной таблице.</span><span class="sxs-lookup"><span data-stu-id="5c644-126">The following diagram shows the long value data stored in separate table.</span></span> <span data-ttu-id="5c644-127">Если значение типа Long хранится за пределами записи, для ссылки на его значение создается новый идентификатор с длинным значением.</span><span class="sxs-lookup"><span data-stu-id="5c644-127">When a long value is stored outside the record, a new long valued ID is created to refer to its value.</span></span> <span data-ttu-id="5c644-128">Это позволяет нескольким записям ссылаться на одно и то же значение столбца.</span><span class="sxs-lookup"><span data-stu-id="5c644-128">This allows multiple records to refer to the same column value.</span></span> <span data-ttu-id="5c644-129">Счетчики ссылок на данные увеличиваются, если несколько записей точек данных указывают на одни и те же данные с длинным значением.</span><span class="sxs-lookup"><span data-stu-id="5c644-129">Reference counts to the data are increased if more than one record in the data points to the same long value data.</span></span>

<span data-ttu-id="5c644-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span><span class="sxs-lookup"><span data-stu-id="5c644-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span></span>

<span data-ttu-id="5c644-131">ESE также поддерживает функцию хранилища единственных копий, которая позволяет нескольким записям ссылаться на один большой двоичный объект, как если бы каждая запись имела собственную копию информации. таким исключением, предотвращение повторяющихся копий данных значений столбца.</span><span class="sxs-lookup"><span data-stu-id="5c644-131">ESE also supports a single instance store feature that allows multiple records to reference the same large binary object as though each record had its own copy of the information; thus avoiding duplicate copies of the column value data.</span></span> <span data-ttu-id="5c644-132">Эта функция включена в вызове [жетпрепареупдате](./jetprepareupdate-function.md) с параметром JET_prepInsertCopy, заданным в параметре *подготовки* .</span><span class="sxs-lookup"><span data-stu-id="5c644-132">This feature is enabled in the call to [JetPrepareUpdate](./jetprepareupdate-function.md) with the JET_prepInsertCopy option set in the *prep* parameter.</span></span>
