---
description: Дополнительные сведения о функции Жетмакекэй
title: Функция JetMakeKey
TOCTitle: JetMakeKey Function
ms:assetid: 8c1cff2f-2f24-4990-a9d8-fb4f822e50b1
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269329(v=EXCHG.10)
ms:contentKeyID: 32765619
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetMakeKey
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: e3d121ed83f096baad249aab8677bb9f5e72e301
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272115"
---
# <a name="jetmakekey-function"></a><span data-ttu-id="97255-103">Функция JetMakeKey</span><span class="sxs-lookup"><span data-stu-id="97255-103">JetMakeKey Function</span></span>


<span data-ttu-id="97255-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="97255-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="jetmakekey-function"></a><span data-ttu-id="97255-105">Функция JetMakeKey</span><span class="sxs-lookup"><span data-stu-id="97255-105">JetMakeKey Function</span></span>

<span data-ttu-id="97255-106">Функция **жетмакекэй** конструирует ключи поиска, которые затем могут использоваться для поиска набора записей в индексе с помощью некоторых простых условий поиска по значениям ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-106">The **JetMakeKey** function constructs search keys that may then be used to find a set of entries in an index by some simple search criteria on their key column values.</span></span> <span data-ttu-id="97255-107">Ключ поиска является также одним из внутренних свойств курсора и используется операциями [жетсик](./jetseek-function.md) и [жетсетиндексранже](./jetsetindexrange-function.md) для поиска записей индекса, соответствующих этим критериям поиска в текущем индексе курсора.</span><span class="sxs-lookup"><span data-stu-id="97255-107">A search key is also one of the intrinsic properties of a cursor and is used by the [JetSeek](./jetseek-function.md) and [JetSetIndexRange](./jetsetindexrange-function.md) operations to locate index entries matching these search criteria on the current index of that cursor.</span></span> <span data-ttu-id="97255-108">Полный ключ поиска создается в серии вызовов **жетмакекэй** , где каждый вызов используется для загрузки значения столбца для следующего ключевого столбца текущего индекса курсора.</span><span class="sxs-lookup"><span data-stu-id="97255-108">A complete search key is built up in a series of **JetMakeKey** calls where each call is used to load the column value for the next key column of the current index of a cursor.</span></span> <span data-ttu-id="97255-109">Также можно загрузить ранее созданный ключ поиска, полученный из курсора с помощью [жетретриевекэй](./jetretrievekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="97255-109">It is also possible to load a previously constructed search key that has been retrieved from the cursor using [JetRetrieveKey](./jetretrievekey-function.md).</span></span>

```cpp
    JET_ERR JET_API JetMakeKey(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in_opt      const void* pvData,
      __in          unsigned long cbData,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a><span data-ttu-id="97255-110">Параметры</span><span class="sxs-lookup"><span data-stu-id="97255-110">Parameters</span></span>

<span data-ttu-id="97255-111">*сесид*</span><span class="sxs-lookup"><span data-stu-id="97255-111">*sesid*</span></span>

<span data-ttu-id="97255-112">Сеанс, используемый для этого вызова.</span><span class="sxs-lookup"><span data-stu-id="97255-112">The session to use for this call.</span></span>

<span data-ttu-id="97255-113">*TableID*</span><span class="sxs-lookup"><span data-stu-id="97255-113">*tableid*</span></span>

<span data-ttu-id="97255-114">Курсор, используемый для этого вызова.</span><span class="sxs-lookup"><span data-stu-id="97255-114">The cursor to use for this call.</span></span>

<span data-ttu-id="97255-115">*пвдата*</span><span class="sxs-lookup"><span data-stu-id="97255-115">*pvData*</span></span>

<span data-ttu-id="97255-116">Входной буфер, содержащий данные столбца для текущего ключевого столбца текущего индекса курсора, для которого создается ключ поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-116">The input buffer containing the column data for the current key column of the current index of the cursor for which the search key is being constructed.</span></span>

<span data-ttu-id="97255-117">Тип данных столбца во входном буфере должен точно совпадать с типом данных и другими свойствами определения столбца текущего ключевого столбца.</span><span class="sxs-lookup"><span data-stu-id="97255-117">The data type of the column data in the input buffer must exactly match the data type and other properties of the column definition of the current key column.</span></span> <span data-ttu-id="97255-118">Для данных столбца не выполняется приведение типов.</span><span class="sxs-lookup"><span data-stu-id="97255-118">No type coercion is performed on the column data whatsoever.</span></span>

<span data-ttu-id="97255-119">Если в параметре *грбит* указано значение JET_bitNormalizedKey, входной буфер должен содержать ранее созданный ключ поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-119">If JET_bitNormalizedKey is specified in the *grbit* parameter, the input buffer must contain a previously constructed search key.</span></span> <span data-ttu-id="97255-120">Такие ключи получаются с помощью вызова [жетретриевекэй](./jetretrievekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="97255-120">Such keys are obtained using a call to [JetRetrieveKey](./jetretrievekey-function.md).</span></span>

<span data-ttu-id="97255-121">*cbData*</span><span class="sxs-lookup"><span data-stu-id="97255-121">*cbData*</span></span>

<span data-ttu-id="97255-122">Размер в байтах данных столбца, указанных во входном буфере.</span><span class="sxs-lookup"><span data-stu-id="97255-122">The size in bytes of the column data provided in the input buffer.</span></span>

<span data-ttu-id="97255-123">Если в параметре *грбит* указано значение JET_bitNormalizedKey, то это размер ключа поиска, предоставленного во входном буфере.</span><span class="sxs-lookup"><span data-stu-id="97255-123">If JET_bitNormalizedKey is specified in the *grbit* parameter, this is the size of the search key provided in the input buffer.</span></span>

<span data-ttu-id="97255-124">Если размер данных столбца равен нулю, содержимое входного буфера игнорируется.</span><span class="sxs-lookup"><span data-stu-id="97255-124">If the size of the column data is zero then the contents of the input buffer are ignored.</span></span> <span data-ttu-id="97255-125">Если в параметре *грбит* указано значение JET_bitKeyDataZeroLength и текущий ключевой столбец текущего индекса курсора является столбцом переменной длины, то данные входного столбца считаются нулевой длиной.</span><span class="sxs-lookup"><span data-stu-id="97255-125">If JET_bitKeyDataZeroLength is specified in the *grbit* parameter and the current key column of the current index of the cursor is a variable length column, the input column data is presumed to be a zero length value.</span></span> <span data-ttu-id="97255-126">В противном случае данные входного столбца предположительно будут иметь значение NULL.</span><span class="sxs-lookup"><span data-stu-id="97255-126">Otherwise, the input column data is presumed to be a NULL value.</span></span>

<span data-ttu-id="97255-127">*грбит*</span><span class="sxs-lookup"><span data-stu-id="97255-127">*grbit*</span></span>

<span data-ttu-id="97255-128">Группа битов, задающая ноль или более следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="97255-128">A group of bits specifying zero or more of the following options.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p><span data-ttu-id="97255-129">Значение</span><span class="sxs-lookup"><span data-stu-id="97255-129">Value</span></span></p></th>
<th><p><span data-ttu-id="97255-130">Значение</span><span class="sxs-lookup"><span data-stu-id="97255-130">Meaning</span></span></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><span data-ttu-id="97255-131">JET_bitFullColumnEndLimit</span><span class="sxs-lookup"><span data-stu-id="97255-131">JET_bitFullColumnEndLimit</span></span></p></td>
<td><p><span data-ttu-id="97255-132">Ключ поиска должен быть создан таким образом, чтобы все ключевые столбцы, поступающие после текущего ключевого столбца, считались подстановочными знаками.</span><span class="sxs-lookup"><span data-stu-id="97255-132">The search key should be constructed in such a way that any key columns that come after the current key column are considered to be wildcards.</span></span> <span data-ttu-id="97255-133">Это означает, что созданный ключ поиска можно использовать для сопоставления записей индекса, имеющих следующее:</span><span class="sxs-lookup"><span data-stu-id="97255-133">This means that the constructed search key can be used to match index entries that have the following:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-134">Точные значения столбцов, предоставленные для этого ключевого столбца и всех предыдущих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-134">The exact column values provided for this key column and all previous key columns.</span></span></p></li>
<li><p><span data-ttu-id="97255-135">Все значения столбцов, необходимые для последующих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-135">Any column values needed for subsequent key columns.</span></span></p></li>
</ul>
<p><span data-ttu-id="97255-136">Этот параметр следует использовать при создании ключей поиска с подстановочными знаками, которые будут использоваться для поиска записей индекса, ближайших к концу индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-136">This option should be used when building wildcard search keys to use for finding index entries closest to the end of an index.</span></span> <span data-ttu-id="97255-137">Конец индекса — это элемент индекса, найденный при переходе к последней записи в этом индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-137">The end of the index is the index entry that is found when moving to the last record in that index.</span></span> <span data-ttu-id="97255-138">Конец индекса не совпадает с верхним концом индекса, который может изменяться в зависимости от порядка сортировки ключевых столбцов в индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-138">The end of the index is not the same as the high end of the index, which can change depending on the sort order of the key columns in the index.</span></span></p>
<p><span data-ttu-id="97255-139">Этот параметр доступен только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-139">This option is only available on Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-140">жетбитфуллколумнстартлимит</span><span class="sxs-lookup"><span data-stu-id="97255-140">JETbitFullColumnStartLimit</span></span></p></td>
<td><p><span data-ttu-id="97255-141">Ключ поиска должен быть создан таким, чтобы все ключевые столбцы, поступающие после текущего ключевого столбца, считались подстановочными знаками.</span><span class="sxs-lookup"><span data-stu-id="97255-141">The search key should be constructed such that any key columns that come after the current key column should be considered to be wildcards.</span></span> <span data-ttu-id="97255-142">Это означает, что созданный ключ поиска можно использовать для сопоставления записей индекса, имеющих следующее:</span><span class="sxs-lookup"><span data-stu-id="97255-142">This means that the constructed search key can be used to match index entries that have the following:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-143">Точные значения столбцов, предоставленные для этого ключевого столбца и всех предыдущих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-143">The exact column values provided for this key column and all previous key columns.</span></span></p></li>
<li><p><span data-ttu-id="97255-144">Все значения столбцов, необходимые для последующих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-144">Any column values needed for subsequent key columns.</span></span></p></li>
</ul>
<p><span data-ttu-id="97255-145">Этот параметр следует использовать при создании ключей поиска с подстановочными знаками, которые будут использоваться для поиска записей индекса, ближайших к началу индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-145">This option should be used when building wildcard search keys to use for finding index entries closest to the start of an index.</span></span> <span data-ttu-id="97255-146">Начало индекса — это элемент индекса, найденный при переходе к первой записи в этом индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-146">The start of the index is the index entry that is found when moving to the first record in that index.</span></span> <span data-ttu-id="97255-147">Начало индекса не совпадает с младшим концом индекса, который может изменяться в зависимости от порядка сортировки ключевых столбцов в индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-147">The start of the index is not the same as the low end of the index, which can change depending on the sort order of the key columns in the index.</span></span></p>
<p><span data-ttu-id="97255-148">Этот параметр доступен только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-148">This option is only available on Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-149">JET_bitKeyDataZeroLength</span><span class="sxs-lookup"><span data-stu-id="97255-149">JET_bitKeyDataZeroLength</span></span></p></td>
<td><p><span data-ttu-id="97255-150">Если размер входного буфера равен нулю, а текущий ключевой столбец является столбцом переменной длины, этот параметр указывает, что входной буфер содержит значение нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="97255-150">If the size of the input buffer is zero and the current key column is a variable length column, this option indicates that the input buffer contains a zero length value.</span></span> <span data-ttu-id="97255-151">В противном случае размер входного буфера, равный нулю, будет означать значение NULL.</span><span class="sxs-lookup"><span data-stu-id="97255-151">Otherwise, an input buffer size of zero would indicate a NULL value.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-152">JET_bitNewKey</span><span class="sxs-lookup"><span data-stu-id="97255-152">JET_bitNewKey</span></span></p></td>
<td><p><span data-ttu-id="97255-153">Должен быть создан новый ключ поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-153">A new search key should be constructed.</span></span> <span data-ttu-id="97255-154">Любой ранее существующий ключ поиска отклоняется.</span><span class="sxs-lookup"><span data-stu-id="97255-154">Any previously existing search key is discarded.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-155">JET_bitNormalizedKey</span><span class="sxs-lookup"><span data-stu-id="97255-155">JET_bitNormalizedKey</span></span></p></td>
<td><p><span data-ttu-id="97255-156">Если указан этот параметр, все остальные параметры игнорируются, любой ранее существующий ключ поиска отбрасывается, а содержимое входного буфера загружается в качестве нового ключа поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-156">When this option is specified, all other options are ignored, any previously existing search key is discarded, and the contents of the input buffer are loaded as the new search key.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-157">JET_bitPartialColumnEndLimit</span><span class="sxs-lookup"><span data-stu-id="97255-157">JET_bitPartialColumnEndLimit</span></span></p></td>
<td><p><span data-ttu-id="97255-158">Ключ поиска должен быть создан таким, что текущий ключевой столбец считается подстановочным знаком, а все ключевые столбцы, поступающие после текущего ключевого столбца, должны рассматриваться как подстановочные знаки.</span><span class="sxs-lookup"><span data-stu-id="97255-158">The search key should be constructed such that the current key column is considered to be a prefix wildcard and that any key columns that come after the current key column should be considered to be wildcards.</span></span> <span data-ttu-id="97255-159">Это означает, что созданный ключ поиска можно использовать для сопоставления записей индекса, имеющих следующее:</span><span class="sxs-lookup"><span data-stu-id="97255-159">This means that the constructed search key can be used to match index entries that have the following:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-160">Точные значения столбцов, предоставленные для этого ключевого столбца и всех предыдущих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-160">The exact column values provided for this key column and all previous key columns.</span></span></p></li>
<li><p><span data-ttu-id="97255-161">Все значения столбцов, необходимые для последующих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-161">Any column values needed for subsequent key columns.</span></span></p></li>
</ul>
<p><span data-ttu-id="97255-162">Этот параметр следует использовать при создании ключей поиска с подстановочными знаками, которые будут использоваться для поиска записей индекса, ближайших к концу индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-162">This option should be used when building wildcard search keys to use for finding index entries closest to the end of an index.</span></span> <span data-ttu-id="97255-163">Конец индекса — это элемент индекса, найденный при переходе к последней записи в этом индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-163">The end of the index is the index entry that is found when moving to the last record in that index.</span></span> <span data-ttu-id="97255-164">Конец индекса не совпадает с верхним концом индекса, который может изменяться в зависимости от порядка сортировки ключевых столбцов в индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-164">The end of the index is not the same as the high end of the index, which can change depending on the sort order of the key columns in the index.</span></span></p>
<p><span data-ttu-id="97255-165">Этот параметр нельзя использовать, если текущий ключевой столбец не является текстовым столбцом или переменным двоичным столбцом.</span><span class="sxs-lookup"><span data-stu-id="97255-165">This option cannot be used when the current key column is not a text column or a variable binary column.</span></span> <span data-ttu-id="97255-166">Операция завершится ошибкой с JET_errInvalidgrbit при попытке.</span><span class="sxs-lookup"><span data-stu-id="97255-166">The operation will fail with JET_errInvalidgrbit if this is attempted.</span></span></p>
<p><span data-ttu-id="97255-167">Этот параметр доступен только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-167">This option is only available on Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-168">JET_bitPartialColumnStartLimit</span><span class="sxs-lookup"><span data-stu-id="97255-168">JET_bitPartialColumnStartLimit</span></span></p></td>
<td><p><span data-ttu-id="97255-169">Этот параметр указывает, что ключ поиска должен быть создан таким, что текущий ключевой столбец считается подстановочным знаком, а все ключевые столбцы, поступающие после текущего ключевого столбца, должны считаться подстановочными знаками.</span><span class="sxs-lookup"><span data-stu-id="97255-169">This option indicates that the search key should be constructed such that the current key column is considered to be a prefix wildcard and that any key columns that come after the current key column should be considered to be wildcards.</span></span> <span data-ttu-id="97255-170">Это означает, что созданный ключ поиска можно использовать для сопоставления записей индекса, имеющих следующее:</span><span class="sxs-lookup"><span data-stu-id="97255-170">This means that the constructed search key can be used to match index entries that have the following:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-171">Точные значения столбцов, предоставленные для этого ключевого столбца и всех предыдущих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-171">The exact column values provided for this key column and all previous key columns.</span></span></p></li>
<li><p><span data-ttu-id="97255-172">Все значения столбцов, необходимые для последующих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-172">Any column values needed for subsequent key columns.</span></span></p></li>
</ul>
<p><span data-ttu-id="97255-173">Этот параметр следует использовать при создании ключей поиска с подстановочными знаками, которые будут использоваться для поиска записей индекса, ближайших к началу индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-173">This option should be used when building wildcard search keys to use for finding index entries closest to the start of an index.</span></span> <span data-ttu-id="97255-174">Начало индекса — это элемент индекса, найденный при переходе к первой записи в этом индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-174">The start of the index is the index entry that is found when moving to the first record in that index.</span></span> <span data-ttu-id="97255-175">Начало индекса не совпадает с младшим концом индекса, который может изменяться в зависимости от порядка сортировки ключевых столбцов в индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-175">The start of the index is not the same as the low end of the index, which can change depending on the sort order of the key columns in the index.</span></span></p>
<p><span data-ttu-id="97255-176">Этот параметр нельзя использовать, если текущий ключевой столбец не является текстовым столбцом или переменным двоичным столбцом.</span><span class="sxs-lookup"><span data-stu-id="97255-176">This option cannot be used when the current key column is not a text column or a variable binary column.</span></span> <span data-ttu-id="97255-177">Операция завершится ошибкой с JET_errInvalidgrbit при попытке.</span><span class="sxs-lookup"><span data-stu-id="97255-177">The operation will fail with JET_errInvalidgrbit if this is attempted.</span></span></p>
<p><span data-ttu-id="97255-178">Этот параметр доступен только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-178">This option is only available on Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-179">JET_bitStrLimit</span><span class="sxs-lookup"><span data-stu-id="97255-179">JET_bitStrLimit</span></span></p></td>
<td><p><span data-ttu-id="97255-180">Этот параметр указывает, что ключ поиска должен быть создан таким, чтобы все ключевые столбцы, поступающие после текущего ключевого столбца, считались подстановочными знаками.</span><span class="sxs-lookup"><span data-stu-id="97255-180">This option indicates that the search key should be constructed such that any key columns that come after the current key column should be considered to be wildcards.</span></span> <span data-ttu-id="97255-181">Это означает, что созданный ключ поиска можно использовать для сопоставления записей индекса, имеющих следующее:</span><span class="sxs-lookup"><span data-stu-id="97255-181">This means that the constructed search key can be used to match index entries that have the following:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-182">Точные значения столбцов, предоставленные для этого ключевого столбца и всех предыдущих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-182">The exact column values provided for this key column and all previous key columns.</span></span></p></li>
<li><p><span data-ttu-id="97255-183">Все значения столбцов, необходимые для последующих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-183">Any column values needed for subsequent key columns.</span></span></p></li>
</ul>
<p><span data-ttu-id="97255-184">Этот параметр следует использовать при создании ключей поиска с подстановочными знаками, которые будут использоваться для поиска записей индекса, ближайших к концу индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-184">This option should be used when building wildcard search keys to use for finding index entries closest to the end of an index.</span></span> <span data-ttu-id="97255-185">Конец индекса — это элемент индекса, найденный при переходе к последней записи в этом индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-185">The end of the index is the index entry that is found when moving to the last record in that index.</span></span> <span data-ttu-id="97255-186">Конец индекса не совпадает с верхним концом индекса, который может изменяться в зависимости от порядка сортировки ключевых столбцов в индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-186">The end of the index is not the same as the high end of the index, which can change depending on the sort order of the key columns in the index.</span></span></p>
<p><span data-ttu-id="97255-187">Если этот параметр указан в сочетании с JET_bitSubStrLimit а текущий ключевой столбец является текстовым столбцом, этот параметр будет проигнорирован.</span><span class="sxs-lookup"><span data-stu-id="97255-187">When this option is specified in combination with JET_bitSubStrLimit and the current key column is a text column, this option will be ignored.</span></span> <span data-ttu-id="97255-188">Это поведение предназначено для того, чтобы разрешить выводимый тип текущего ключевого столбца при построении ключа поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-188">This behavior is intended to allow the type of the current key column to be inferred when building the search key.</span></span></p>
<p><span data-ttu-id="97255-189">Если вы хотите создать аналогичный поисковый ключ для начала индекса, для последнего ключевого столбца, который не является подстановочным знаком, необходимо выполнить аналогичный вызов <strong>жетмакекэй</strong> , но без указания подстановочных знаков.</span><span class="sxs-lookup"><span data-stu-id="97255-189">If you want to build a similar search key for the start of an index, a similar call to <strong>JetMakeKey</strong> should be made for the last key column that is not a wildcard, but with no wildcard options specified.</span></span> <span data-ttu-id="97255-190">Затем ключ поиска находится в соответствующем состоянии, чтобы использовать его для такого поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-190">The search key is then in an appropriate state to use for such a search.</span></span> <span data-ttu-id="97255-191">Это аналогично использованию JET_bitFullColumnStartLimit, за исключением того, что поисковый ключ не завершается четко, как после использования параметра подстановочного знака.</span><span class="sxs-lookup"><span data-stu-id="97255-191">This is analogous to using JET_bitFullColumnStartLimit, except that the search key is not cleanly finished as it is after the use of a wildcard option.</span></span></p>
<p><span data-ttu-id="97255-192">Этот параметр является устаревшим для Windows XP и более поздних версий, чтобы устранить эту неудобную семантику.</span><span class="sxs-lookup"><span data-stu-id="97255-192">This option has been deprecated for Windows XP and later releases in order to address this awkward semantic.</span></span> <span data-ttu-id="97255-193">По возможности вместо них следует использовать JET_bitFullColumnStartLimit и JET_bitFullColumnEndLimit.</span><span class="sxs-lookup"><span data-stu-id="97255-193">JET_bitFullColumnStartLimit and JET_bitFullColumnEndLimit should be used instead wherever possible.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-194">JET_bitSubStrLimit</span><span class="sxs-lookup"><span data-stu-id="97255-194">JET_bitSubStrLimit</span></span></p></td>
<td><p><span data-ttu-id="97255-195">Этот параметр указывает, что ключ поиска должен быть создан таким, что текущий ключевой столбец считается подстановочным знаком, а все ключевые столбцы, поступающие после текущего ключевого столбца, должны считаться подстановочными знаками.</span><span class="sxs-lookup"><span data-stu-id="97255-195">This option indicates that the search key should be constructed such that the current key column is considered to be a prefix wildcard and that any key columns that come after the current key column should be considered to be wildcards.</span></span> <span data-ttu-id="97255-196">Это означает, что созданный ключ поиска можно использовать для сопоставления записей индекса, имеющих следующее:</span><span class="sxs-lookup"><span data-stu-id="97255-196">This means that the constructed search key can be used to match index entries that have the following:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-197">Точные значения столбцов, предоставленные для всех предыдущих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-197">The exact column values provided for all previous key columns.</span></span></p></li>
<li><p><span data-ttu-id="97255-198">Указанные данные столбца в качестве префикса значения столбца для текущего ключевого столбца.</span><span class="sxs-lookup"><span data-stu-id="97255-198">The specified column data as a prefix of their column value for the current key column.</span></span></p></li>
<li><p><span data-ttu-id="97255-199">Все значения столбцов для последующих ключевых столбцов.</span><span class="sxs-lookup"><span data-stu-id="97255-199">Any column values for subsequent key columns.</span></span></p></li>
</ul>
<p><span data-ttu-id="97255-200">Этот параметр следует использовать при создании ключей поиска с подстановочными знаками, которые будут использоваться для поиска записей индекса, ближайших к концу индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-200">This option should be used when building wildcard search keys to use for finding index entries closest to the end of an index.</span></span> <span data-ttu-id="97255-201">Конец индекса — это элемент индекса, найденный при переходе к последней записи в этом индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-201">The end of the index is the index entry that is found when moving to the last record in that index.</span></span> <span data-ttu-id="97255-202">Конец индекса не совпадает с верхним концом индекса, который может изменяться в зависимости от порядка сортировки ключевых столбцов в индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-202">The end of the index is not the same as the high end of the index, which can change depending on the sort order of the key columns in the index.</span></span></p>
<p><span data-ttu-id="97255-203">Если этот параметр указан в сочетании с JET_bitStrLimit, а текущий ключевой столбец является текстовым столбцом, то этот параметр имеет приоритет.</span><span class="sxs-lookup"><span data-stu-id="97255-203">When this option is specified in combination with JET_bitStrLimit and the current key column is a text column, this option will take precedence.</span></span> <span data-ttu-id="97255-204">Этот параметр игнорируется, если текущий ключевой столбец не является текстовым столбцом.</span><span class="sxs-lookup"><span data-stu-id="97255-204">This option is ignored when the current key column is not a text column.</span></span> <span data-ttu-id="97255-205">Это поведение предназначено для того, чтобы разрешить выводимый тип текущего ключевого столбца при построении ключа поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-205">This behavior is intended to allow the type of the current key column to be inferred when building the search key.</span></span></p>
<p><span data-ttu-id="97255-206">Если вы хотите создать аналогичный поисковый ключ для начала индекса, для ключевого столбца необходимо выполнить аналогичный вызов <strong>жетмакекэй</strong> , который должен быть подстановочным знаком, но с параметром подстановочных знаков не указано.</span><span class="sxs-lookup"><span data-stu-id="97255-206">If you want to build a similar search key for the start of an index, a similar call to <strong>JetMakeKey</strong> should be made for the key column that is to be the prefix wildcard, but with that no wildcard options specified.</span></span> <span data-ttu-id="97255-207">Затем ключ поиска находится в соответствующем состоянии, чтобы использовать его для такого поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-207">The search key is then in an appropriate state to use for such a search.</span></span> <span data-ttu-id="97255-208">Это аналогично использованию JET_bitPartialColumnStartLimit, за исключением того, что поисковый ключ не завершается четко, как после использования параметра подстановочного знака.</span><span class="sxs-lookup"><span data-stu-id="97255-208">This is analogous to using JET_bitPartialColumnStartLimit, except that the search key is not cleanly finished as it is after the use of a wildcard option.</span></span></p>
<p><span data-ttu-id="97255-209">Этот параметр является устаревшим для Windows XP и более поздних версий, чтобы устранить эту неудобную семантику.</span><span class="sxs-lookup"><span data-stu-id="97255-209">This option has been deprecated for Windows XP and later releases in order to address this awkward semantic.</span></span> <span data-ttu-id="97255-210">Вместо этого по возможности следует использовать JET_bitPartialColumnStartLimit и JET_bitPartialColumnEndLimit.</span><span class="sxs-lookup"><span data-stu-id="97255-210">JET_bitPartialColumnStartLimit and JET_bitPartialColumnEndLimit should be used instead, when possible.</span></span></p></td>
</tr>
</tbody>
</table>


### <a name="return-value"></a><span data-ttu-id="97255-211">Возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="97255-211">Return Value</span></span>

<span data-ttu-id="97255-212">Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата.</span><span class="sxs-lookup"><span data-stu-id="97255-212">This function returns the [JET_ERR](./jet-err.md) datatype with one of the following return codes.</span></span> <span data-ttu-id="97255-213">Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="97255-213">For more information about the possible ESE errors, see [Extensible Storage Engine Errors](./extensible-storage-engine-errors.md) and [Error Handling Parameters](./error-handling-parameters.md).</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p><span data-ttu-id="97255-214">Код возврата</span><span class="sxs-lookup"><span data-stu-id="97255-214">Return code</span></span></p></th>
<th><p><span data-ttu-id="97255-215">Описание</span><span class="sxs-lookup"><span data-stu-id="97255-215">Description</span></span></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><span data-ttu-id="97255-216">JET_errSuccess</span><span class="sxs-lookup"><span data-stu-id="97255-216">JET_errSuccess</span></span></p></td>
<td><p><span data-ttu-id="97255-217">Операция выполнена успешно.</span><span class="sxs-lookup"><span data-stu-id="97255-217">The operation completed successfully.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-218">JET_errClientRequestToStopJetService</span><span class="sxs-lookup"><span data-stu-id="97255-218">JET_errClientRequestToStopJetService</span></span></p></td>
<td><p><span data-ttu-id="97255-219">Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</span><span class="sxs-lookup"><span data-stu-id="97255-219">It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <a href="gg269240(v=exchg.10).md">JetStopService</a>.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-220">JET_errIndexTuplesKeyTooSmall</span><span class="sxs-lookup"><span data-stu-id="97255-220">JET_errIndexTuplesKeyTooSmall</span></span></p></td>
<td><p><span data-ttu-id="97255-221">Указанные данные столбца слишком малы для создания допустимого ключа для текущего индекса, так как этот индекс является индексом кортежа, а минимальный размер кортежа больше, чем предоставленные данные столбца.</span><span class="sxs-lookup"><span data-stu-id="97255-221">The provided column data was too small to build a valid key for the current index because that index is a tuple index and the minimum tuple size was larger than the provided column data.</span></span> <span data-ttu-id="97255-222">Дополнительные сведения о индексах кортежей см. в разделе <a href="gg294099(v=exchg.10).md">жеткреатеиндекс</a> .</span><span class="sxs-lookup"><span data-stu-id="97255-222">See <a href="gg294099(v=exchg.10).md">JetCreateIndex</a> for more information on tuple indexes.</span></span> <span data-ttu-id="97255-223">Эта ошибка будет возвращена только Windows XP и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="97255-223">This error will only be returned by Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-224">JET_errInstanceUnavailable</span><span class="sxs-lookup"><span data-stu-id="97255-224">JET_errInstanceUnavailable</span></span></p></td>
<td><p><span data-ttu-id="97255-225">Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</span><span class="sxs-lookup"><span data-stu-id="97255-225">It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data.</span></span> <span data-ttu-id="97255-226">Эта ошибка будет возвращена только Windows XP и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="97255-226">This error will only be returned by Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-227">JET_errInvalidBufferSize</span><span class="sxs-lookup"><span data-stu-id="97255-227">JET_errInvalidBufferSize</span></span></p></td>
<td><p><span data-ttu-id="97255-228">Предоставленные данные столбца не соответствуют размеру, требуемому для определения столбца.</span><span class="sxs-lookup"><span data-stu-id="97255-228">The column data provided did not match the size required by the column definition.</span></span> <span data-ttu-id="97255-229">Это может произойти, если тип данных столбца является внутренним определенным размером.</span><span class="sxs-lookup"><span data-stu-id="97255-229">This can happen if the column's data type is intrinsically a certain size.</span></span> <span data-ttu-id="97255-230">Это также может произойти, если тип данных столбца не является каким-либо определенным размером, но определение столбца объявляет его фиксированной длиной.</span><span class="sxs-lookup"><span data-stu-id="97255-230">This can also happen if the column's data type is not intrinsically a certain size but the column's definition declares it to be of fixed length.</span></span> <span data-ttu-id="97255-231">Единственным исключением является то, что эта ошибка не возникает, если для столбца с фиксированной длиной текста указано слишком мало данных, так как любые отсутствующие данные будут автоматически дополнены пробелами.</span><span class="sxs-lookup"><span data-stu-id="97255-231">One exception to this is that this error will not occur when too little data is provided for a fixed length text column because any missing data will be automatically padded with spaces.</span></span> <span data-ttu-id="97255-232">Вторым исключением является то, что эта ошибка не возникает, если для двоичного столбца фиксированной длины задано слишком мало данных, так как любые отсутствующие данные будут автоматически заполнены нулями.</span><span class="sxs-lookup"><span data-stu-id="97255-232">A second exception to this is that this error will not occur when too little data is provided for a fixed length binary column because any missing data will be automatically padded with zeroes.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-233">JET_errInvalidgrbit</span><span class="sxs-lookup"><span data-stu-id="97255-233">JET_errInvalidgrbit</span></span></p></td>
<td><p><span data-ttu-id="97255-234">Один из запрошенных параметров недопустим, используется недопустимым образом или не реализован.</span><span class="sxs-lookup"><span data-stu-id="97255-234">One of the options requested was invalid, used in an illegal manner, or not implemented.</span></span> <span data-ttu-id="97255-235">Это может произойти для <strong>жетмакекэй</strong> в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="97255-235">This can happen for <strong>JetMakeKey</strong> when:</span></span></p>
<ul>
<li><p><span data-ttu-id="97255-236">Указаны JET_bitPartialColumnStartLimit или JET_bitPartialColumnEndLimit, а соответствующий ключевой столбец не является текстовым столбцом и не является двоичным столбцом переменной длины.</span><span class="sxs-lookup"><span data-stu-id="97255-236">JET_bitPartialColumnStartLimit or JET_bitPartialColumnEndLimit are specified and the corresponding key column is not a text column and is not a variable length binary column.</span></span> <span data-ttu-id="97255-237">Этот вариант происходит только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-237">This case only occurs on Windows XP and later releases.</span></span></p></li>
<li><p><span data-ttu-id="97255-238">Предпринята попытка использовать несколько следующих параметров вместе: JET_bitPartialColumnStartLimit, JET_bitPartialColumnEndLimit, JET_bitFullColumnStartLimit и JET_bitFullColumnEndLimit.</span><span class="sxs-lookup"><span data-stu-id="97255-238">An attempt is made to use more than one of the following options together: JET_bitPartialColumnStartLimit, JET_bitPartialColumnEndLimit, JET_bitFullColumnStartLimit, and JET_bitFullColumnEndLimit.</span></span> <span data-ttu-id="97255-239">Этот вариант происходит только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-239">This case only occurs on Windows XP and later releases.</span></span></p></li>
<li><p><span data-ttu-id="97255-240">Предпринята попытка использовать JET_bitStrLimit или JET_bitSubStrLimit при использовании одного из следующих параметров: JET_bitPartialColumnStartLimit, JET_bitPartialColumnEndLimit, JET_bitFullColumnStartLimit и JET_bitFullColumnEndLimit.</span><span class="sxs-lookup"><span data-stu-id="97255-240">An attempt is made to use JET_bitStrLimit or JET_bitSubStrLimit when one of the following options is used: JET_bitPartialColumnStartLimit, JET_bitPartialColumnEndLimit, JET_bitFullColumnStartLimit and JET_bitFullColumnEndLimit.</span></span> <span data-ttu-id="97255-241">Этот вариант происходит только в Windows XP и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="97255-241">This case only occurs on Windows XP and later releases.</span></span></p></li>
</ul></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-242">JET_errInvalidParameter</span><span class="sxs-lookup"><span data-stu-id="97255-242">JET_errInvalidParameter</span></span></p></td>
<td><p><span data-ttu-id="97255-243">Один из указанных параметров содержит непредвиденное значение или содержит значение, которое не имеет смысла при объединении со значением другого параметра.</span><span class="sxs-lookup"><span data-stu-id="97255-243">One of the parameters provided contained an unexpected value or contained a value that did not make sense when combined with the value of another parameter.</span></span></p>
<p><span data-ttu-id="97255-244">Это может произойти для <strong>жетмакекэй</strong> , когда было указано JET_bitNormalizedKey и значение, указанное во входном буфере, слишком велико, чтобы быть допустимым ключом поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-244">This can happen for <strong>JetMakeKey</strong> when JET_bitNormalizedKey was specified and the value provided in the input buffer was too large to be a valid search key.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-245">JET_errKeyIsMade</span><span class="sxs-lookup"><span data-stu-id="97255-245">JET_errKeyIsMade</span></span></p></td>
<td><p><span data-ttu-id="97255-246">Данные столбца, предоставленные в <strong>жетмакекэй</strong> , были отклонены, так как данные столбца уже были предоставлены для всех ключевых столбцов в текущем индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-246">The column data provided to <strong>JetMakeKey</strong> was rejected because column data has already been provided for all the key columns in the current index.</span></span> <span data-ttu-id="97255-247">Это может произойти тремя способами.</span><span class="sxs-lookup"><span data-stu-id="97255-247">This can happen in three ways.</span></span> <span data-ttu-id="97255-248">Первый способ — если данные столбца предоставляются для каждого ключевого столбца в текущем индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-248">The first way is if column data is provided for each key column in the current index.</span></span> <span data-ttu-id="97255-249">Второй способ — если данные столбца были предоставлены по крайней мере для одного ключевого столбца и для последнего вызова был выбран параметр с подстановочным знаком.</span><span class="sxs-lookup"><span data-stu-id="97255-249">The second way is if column data has been provided for at least one key column and a wildcard option was chosen for the last call.</span></span> <span data-ttu-id="97255-250">Третий способ — если ранее созданный ключ поиска был предоставлен с помощью JET_bitNormalizedKey, охватывающего все ключевые столбцы.</span><span class="sxs-lookup"><span data-stu-id="97255-250">The third way is if a previously constructed search key was provided using JET_bitNormalizedKey, which covers all key columns.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-251">JET_errKeyNotMade</span><span class="sxs-lookup"><span data-stu-id="97255-251">JET_errKeyNotMade</span></span></p></td>
<td><p><span data-ttu-id="97255-252">Для курсора отсутствует текущий ключ поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-252">There is no current search key for the cursor.</span></span> <span data-ttu-id="97255-253">Это произойдет для <strong>жетмакекэй</strong> , если не указан параметр JET_bitNewKey и для этого курсора не был создан ключ поиска, используя перед ним вызов <strong>жетмакекэй</strong>.</span><span class="sxs-lookup"><span data-stu-id="97255-253">This will happen for <strong>JetMakeKey</strong> if JET_bitNewKey is not specified and a search key has not been constructed for this cursor using a prior call to <strong>JetMakeKey</strong>.</span></span> <span data-ttu-id="97255-254">Ключ поиска будет удален при предыдущем вызове любого API навигации в курсоре, отличном от <a href="gg294117(v=exchg.10).md">жетмове</a>.</span><span class="sxs-lookup"><span data-stu-id="97255-254">The search key will be deleted by a prior call to any navigational API on the cursor other than <a href="gg294117(v=exchg.10).md">JetMove</a>.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-255">JET_errNoCurrentIndex</span><span class="sxs-lookup"><span data-stu-id="97255-255">JET_errNoCurrentIndex</span></span></p></td>
<td><p><span data-ttu-id="97255-256">Для курсора отсутствует текущий индекс.</span><span class="sxs-lookup"><span data-stu-id="97255-256">There is no current index for the cursor.</span></span> <span data-ttu-id="97255-257">Это произойдет для <strong>жетмакекэй</strong> , если курсор находится на кластеризованном индексе таблицы, первичный индекс не был определен и JET_bitNormalizedKey не был указан.</span><span class="sxs-lookup"><span data-stu-id="97255-257">This will happen for <strong>JetMakeKey</strong> if the cursor is on the clustered index of a table, a primary index has not been defined, and JET_bitNormalizedKey was not specified.</span></span> <span data-ttu-id="97255-258">Невозможно создать ключ поиска, если курсор находится на индексе, который не имеет ключевых столбцов, если не предоставлен ранее созданный ключ поиска.</span><span class="sxs-lookup"><span data-stu-id="97255-258">It is not possible to construct a search key if the cursor is on an index that does not have any key columns unless a previously constructed search key is provided.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-259">JET_errNotInitialized</span><span class="sxs-lookup"><span data-stu-id="97255-259">JET_errNotInitialized</span></span></p></td>
<td><p><span data-ttu-id="97255-260">Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</span><span class="sxs-lookup"><span data-stu-id="97255-260">It is not possible to complete the operation because the instance associated with the session has not been initialized yet.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-261">JET_errRestoreInProgress</span><span class="sxs-lookup"><span data-stu-id="97255-261">JET_errRestoreInProgress</span></span></p></td>
<td><p><span data-ttu-id="97255-262">Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</span><span class="sxs-lookup"><span data-stu-id="97255-262">It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-263">JET_errSessionSharingViolation</span><span class="sxs-lookup"><span data-stu-id="97255-263">JET_errSessionSharingViolation</span></span></p></td>
<td><p><span data-ttu-id="97255-264">Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</span><span class="sxs-lookup"><span data-stu-id="97255-264">The same session cannot be used for more than one thread at the same time.</span></span> <span data-ttu-id="97255-265">Эта ошибка будет возвращена только Windows XP и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="97255-265">This error will only be returned by Windows XP and later releases.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-266">JET_errTermInProgress</span><span class="sxs-lookup"><span data-stu-id="97255-266">JET_errTermInProgress</span></span></p></td>
<td><p><span data-ttu-id="97255-267">Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</span><span class="sxs-lookup"><span data-stu-id="97255-267">It is not possible to complete the operation because the instance associated with the session is being shut down.</span></span></p></td>
</tr>
</tbody>
</table>


<span data-ttu-id="97255-268">При успешном выполнении, если не указаны JET_bitNormalizedKey и JET_bitNewKey, ключ поиска будет построен в соответствии с критериями поиска для одного и того же ключевого столбца в текущем индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-268">On success, if JET_bitNormalizedKey and JET_bitNewKey were not specified, the search key will have been built up by the search criteria for one more key column in the current index.</span></span> <span data-ttu-id="97255-269">Если параметр JET_bitNormalizedKey не был указан и JET_bitNewKey был указан, то любой ранее существующий ключ поиска был отклонен, а новый ключ будет создан в соответствии с критериями поиска для первого ключевого столбца в текущем индексе.</span><span class="sxs-lookup"><span data-stu-id="97255-269">If JET_bitNormalizedKey was not specified and JET_bitNewKey was specified, any previously existing search key was discarded and a new one will have been built up by the search criteria for the first key column in the current index.</span></span> <span data-ttu-id="97255-270">Если указан JET_bitNormalizedKey, то любой ранее существующий ключ поиска был отклонен, а новый был загружен из входного буфера.</span><span class="sxs-lookup"><span data-stu-id="97255-270">If JET_bitNormalizedKey was specified, any previously existing search key was discarded and a new one loaded from the input buffer.</span></span> <span data-ttu-id="97255-271">В любом случае изменение состояния базы данных не выполняется.</span><span class="sxs-lookup"><span data-stu-id="97255-271">In any case, no change to the database state will occur.</span></span>

<span data-ttu-id="97255-272">В случае сбоя, если был указан JET_bitNormalizedKey или JET_bitNewKey, состояние ключа поиска не определено.</span><span class="sxs-lookup"><span data-stu-id="97255-272">On failure, if JET_bitNormalizedKey or JET_bitNewKey was specified, the state of the search key is undefined.</span></span> <span data-ttu-id="97255-273">Если не указаны ни JET_bitNormalizedKey, ни JET_bitNewKey, то не произойдет никаких изменений в состоянии поискового ключа.</span><span class="sxs-lookup"><span data-stu-id="97255-273">If neither JET_bitNormalizedKey nor JET_bitNewKey were specified, no change to the state of the search key will occur.</span></span> <span data-ttu-id="97255-274">В любом случае изменение состояния базы данных не выполняется.</span><span class="sxs-lookup"><span data-stu-id="97255-274">In any case, no change to the database state will occur.</span></span>

#### <a name="remarks"></a><span data-ttu-id="97255-275">Комментарии</span><span class="sxs-lookup"><span data-stu-id="97255-275">Remarks</span></span>

<span data-ttu-id="97255-276">Ключи следует рассматривать как непрозрачные фрагменты данных.</span><span class="sxs-lookup"><span data-stu-id="97255-276">Keys should be treated as opaque chunks of data.</span></span> <span data-ttu-id="97255-277">Для использования внутренней структуры этих данных не нужно предпринимать никаких попыток.</span><span class="sxs-lookup"><span data-stu-id="97255-277">No attempt should be made to exploit the internal structure of this data.</span></span> <span data-ttu-id="97255-278">Тем не менее, известны следующие сведения обо всех ключах ESENT:</span><span class="sxs-lookup"><span data-stu-id="97255-278">However, the following is known about all ESENT keys:</span></span>

  - <span data-ttu-id="97255-279">Ключи можно сравнить друг с другом с помощью [memcmp](/previous-versions/visualstudio/visual-studio-6.0/aa246467(v=vs.60)) , чтобы установить их относительное упорядочение в исходном индексе по таблице записей исходного индекса.</span><span class="sxs-lookup"><span data-stu-id="97255-279">Keys may be compared against each other using [memcmp](/previous-versions/visualstudio/visual-studio-6.0/aa246467(v=vs.60)) to establish their relative ordering in the originating index over the table of the source index entries.</span></span>

  - <span data-ttu-id="97255-280">Нет смысла сравнивать ключи индексов из разных индексов друг с другом.</span><span class="sxs-lookup"><span data-stu-id="97255-280">It is meaningless to compare keys of index entries from different indexes against each other.</span></span>

  - <span data-ttu-id="97255-281">Длина ключа всегда меньше или равна JET_cbKeyMost (255) байт до Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="97255-281">A key is always less than or equal to JET_cbKeyMost (255) bytes in length prior to Windows Vista.</span></span> <span data-ttu-id="97255-282">В Windows Vista и более поздних выпусках ключи могут быть больше.</span><span class="sxs-lookup"><span data-stu-id="97255-282">On Windows Vista and later releases, keys can be larger.</span></span> <span data-ttu-id="97255-283">Максимальный размер ключа равен текущему значению JET_paramKeyMost.</span><span class="sxs-lookup"><span data-stu-id="97255-283">The maximum size of a key is equal to the current value of JET_paramKeyMost.</span></span>

<span data-ttu-id="97255-284">При использовании подстановочных знаков в ключах поиска может быть больше одного байта.</span><span class="sxs-lookup"><span data-stu-id="97255-284">Search keys can be one byte longer if a wildcard option was used.</span></span> <span data-ttu-id="97255-285">В этом случае ключ поиска будет JET_cbLimitKeyMost (256) байт для выпусков до Windows Vista, а JET_paramKeyMost + 1 байт для Windows Vista и более поздних выпусков.</span><span class="sxs-lookup"><span data-stu-id="97255-285">In that case, the search key will be up to JET_cbLimitKeyMost (256) bytes for releases prior to Windows Vista and JET_paramKeyMost + 1 bytes for Windows Vista and later releases.</span></span>

<span data-ttu-id="97255-286">Существует очень важное влияние на этот максимальный размер ключа.</span><span class="sxs-lookup"><span data-stu-id="97255-286">There is a very important ramification to this maximum key size.</span></span> <span data-ttu-id="97255-287">Всякий раз, когда имеется запись индекса, имеющая достаточно большой размер для создания ключа для этого индекса, который в противном случае был бы больше этого максимального размера, этот ключ автоматически усекается по этому максимальному размеру.</span><span class="sxs-lookup"><span data-stu-id="97255-287">Whenever there is an index entry that has column values that are large enough to cause a key to be generated for that index that would otherwise be larger than this maximum size, that key is silently truncated at that maximum size.</span></span> <span data-ttu-id="97255-288">Это приводит к двум последствиям:</span><span class="sxs-lookup"><span data-stu-id="97255-288">This causes two effects:</span></span>

  - <span data-ttu-id="97255-289">Для записей в уникальном индексе это приведет к тому, что записи, которые в противном случае были бы уникальными, будут объявлены как повторяющиеся.</span><span class="sxs-lookup"><span data-stu-id="97255-289">For entries in a unique index, it will cause entries that would otherwise be unique to be declared as duplicates.</span></span>

  - <span data-ttu-id="97255-290">Для записей во всех индексах усечение ключа приведет к тому, что элементы индекса, которые в противном случае не будут соответствовать критериям поиска данного ключа поиска, будут объявлены как совпадения.</span><span class="sxs-lookup"><span data-stu-id="97255-290">For entries in all indexes, key truncation will cause index entries that would otherwise not match the search criteria of a given search key to be declared as matches.</span></span>

<span data-ttu-id="97255-291">Приложения должны предвидеть это усечение и либо избегать, либо компенсировать его влияние.</span><span class="sxs-lookup"><span data-stu-id="97255-291">Applications must anticipate this truncation and either avoid it or compensate for its effects.</span></span> <span data-ttu-id="97255-292">В Windows Vista добавлен новый флаг индекса, JET_bitIndexDisallowTruncation, чтобы упростить для приложений предотвращение усечения ключей.</span><span class="sxs-lookup"><span data-stu-id="97255-292">In Windows Vista, a new index flag, JET_bitIndexDisallowTruncation, has been added to make it easier for applications to prevent key truncations.</span></span> <span data-ttu-id="97255-293">Дополнительные сведения об этом параметре индексирования см. в разделе Структура [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="97255-293">See the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure for more information on this indexing option.</span></span>

#### <a name="requirements"></a><span data-ttu-id="97255-294">Требования</span><span class="sxs-lookup"><span data-stu-id="97255-294">Requirements</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><span data-ttu-id="97255-295"><strong>Клиент</strong></span><span class="sxs-lookup"><span data-stu-id="97255-295"><strong>Client</strong></span></span></p></td>
<td><p><span data-ttu-id="97255-296">Требуется Windows Vista, Windows XP или Windows 2000 Professional.</span><span class="sxs-lookup"><span data-stu-id="97255-296">Requires Windows Vista, Windows XP, or Windows 2000 Professional.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-297"><strong>Server</strong></span><span class="sxs-lookup"><span data-stu-id="97255-297"><strong>Server</strong></span></span></p></td>
<td><p><span data-ttu-id="97255-298">Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</span><span class="sxs-lookup"><span data-stu-id="97255-298">Requires Windows Server 2008, Windows Server 2003, or Windows 2000 Server.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-299"><strong>Header</strong></span><span class="sxs-lookup"><span data-stu-id="97255-299"><strong>Header</strong></span></span></p></td>
<td><p><span data-ttu-id="97255-300">Объявлено в ESENT. h.</span><span class="sxs-lookup"><span data-stu-id="97255-300">Declared in Esent.h.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="97255-301"><strong>Библиотека</strong></span><span class="sxs-lookup"><span data-stu-id="97255-301"><strong>Library</strong></span></span></p></td>
<td><p><span data-ttu-id="97255-302">Используйте ESENT. lib.</span><span class="sxs-lookup"><span data-stu-id="97255-302">Use ESENT.lib.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="97255-303"><strong>КОМПОНОВКИ</strong></span><span class="sxs-lookup"><span data-stu-id="97255-303"><strong>DLL</strong></span></span></p></td>
<td><p><span data-ttu-id="97255-304">Требуется ESENT.dll.</span><span class="sxs-lookup"><span data-stu-id="97255-304">Requires ESENT.dll.</span></span></p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a><span data-ttu-id="97255-305">См. также:</span><span class="sxs-lookup"><span data-stu-id="97255-305">See Also</span></span>

[<span data-ttu-id="97255-306">JET_ERR</span><span class="sxs-lookup"><span data-stu-id="97255-306">JET_ERR</span></span>](./jet-err.md)  
[<span data-ttu-id="97255-307">JET_GRBIT</span><span class="sxs-lookup"><span data-stu-id="97255-307">JET_GRBIT</span></span>](./jet-grbit.md)  
[<span data-ttu-id="97255-308">JET_SESID</span><span class="sxs-lookup"><span data-stu-id="97255-308">JET_SESID</span></span>](./jet-sesid.md)  
[<span data-ttu-id="97255-309">JET_TABLEID</span><span class="sxs-lookup"><span data-stu-id="97255-309">JET_TABLEID</span></span>](./jet-tableid.md)  
[<span data-ttu-id="97255-310">жеткреатеиндекс</span><span class="sxs-lookup"><span data-stu-id="97255-310">JetCreateIndex</span></span>](./jetcreateindex-function.md)  
[<span data-ttu-id="97255-311">жетретриевекэй</span><span class="sxs-lookup"><span data-stu-id="97255-311">JetRetrieveKey</span></span>](./jetretrievekey-function.md)  
[<span data-ttu-id="97255-312">жетсик</span><span class="sxs-lookup"><span data-stu-id="97255-312">JetSeek</span></span>](./jetseek-function.md)  
[<span data-ttu-id="97255-313">жетсетиндексранже</span><span class="sxs-lookup"><span data-stu-id="97255-313">JetSetIndexRange</span></span>](./jetsetindexrange-function.md)
