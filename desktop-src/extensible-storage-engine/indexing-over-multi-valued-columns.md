---
description: 'Дополнительные сведения: индексирование по столбцам с несколькими значениями'
title: Индексирование по столбцам с несколькими значениями
TOCTitle: Indexing over Multi-Valued Columns
ms:assetid: 90e31df2-2f5b-47a8-84c1-ece6bcc40858
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269341(v=EXCHG.10)
ms:contentKeyID: 32765630
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: aea24e8423b704b7e0345898bcb6ae4b6d7c057b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692552"
---
# <a name="indexing-over-multi-valued-columns"></a><span data-ttu-id="b99c4-103">Индексирование по столбцам с несколькими значениями</span><span class="sxs-lookup"><span data-stu-id="b99c4-103">Indexing over Multi-Valued Columns</span></span>


<span data-ttu-id="b99c4-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="b99c4-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="indexing-over-multi-valued-columns"></a><span data-ttu-id="b99c4-105">Индексирование по столбцам с несколькими значениями</span><span class="sxs-lookup"><span data-stu-id="b99c4-105">Indexing over Multi-Valued Columns</span></span>

<span data-ttu-id="b99c4-106">Индексирование по столбцам с несколькими значениями выполняется только для первого многозначного столбца в индексе.</span><span class="sxs-lookup"><span data-stu-id="b99c4-106">Indexing over multi-valued columns is only performed over the first multi-valued column in the index.</span></span> <span data-ttu-id="b99c4-107">Первый многозначный столбец разворачивается таким образом, что каждое значение в столбце индексируется.</span><span class="sxs-lookup"><span data-stu-id="b99c4-107">The first multi-valued column is expanded so that every value in the column is indexed.</span></span> <span data-ttu-id="b99c4-108">Все другие столбцы с несколькими значениями индексируются только по первому значению в столбце.</span><span class="sxs-lookup"><span data-stu-id="b99c4-108">All other multi-valued columns are indexed only over the first value in the column.</span></span> <span data-ttu-id="b99c4-109">Например, индекс определяется по столбцу A и столбцу B, где оба этих столбца являются многозначными.</span><span class="sxs-lookup"><span data-stu-id="b99c4-109">For example, an index is defined over Column A, and Column B, where both of these columns are multi-valued.</span></span> <span data-ttu-id="b99c4-110">В заданной записи столбец A имеет значения красного, синего, а столбец B имеет значения 1, 2 и 3.</span><span class="sxs-lookup"><span data-stu-id="b99c4-110">In a given record, Column A has the values red, and blue, and Column B has the values 1, 2, and 3.</span></span> <span data-ttu-id="b99c4-111">Результирующий индекс будет давать записи для Red-1 и Blue-1.</span><span class="sxs-lookup"><span data-stu-id="b99c4-111">The resulting index would give entries for red-1 and blue-1.</span></span> <span data-ttu-id="b99c4-112">Значения во втором столбце column B не разворачиваются.</span><span class="sxs-lookup"><span data-stu-id="b99c4-112">The values in the second column, Column B, are not expanded.</span></span> <span data-ttu-id="b99c4-113">Обратите внимание, что несмотря на то, что каждый столбец с тегами может содержать только столбцы с несколькими значениями, помеченные как многозначные с помощью JET_bitColumnMultiValued развертываются таким образом.</span><span class="sxs-lookup"><span data-stu-id="b99c4-113">Note that even though every tagged column may be multi-valued only tagged columns that are explicitly flagged as multi-valued via JET_bitColumnMultiValued are expanded in this way.</span></span> <span data-ttu-id="b99c4-114">Кроме того, из-за того, что первичные записи индекса содержат записи, не допускается наличие первичного индекса по столбцу с несколькими значениями, так как это приведет к созданию нескольких расположений в индексе, в котором должна находиться запись.</span><span class="sxs-lookup"><span data-stu-id="b99c4-114">Also, due to the fact that primary index entries contain records, it is not permitted to have a primary index over a multi-valued column because that would result in multiple locations in the index in which the record would have to reside.</span></span> <span data-ttu-id="b99c4-115">Дополнительные сведения см. в разделе [помеченные, фиксированные и переменные столбцы](./tagged-fixed-and-variable-columns.md) .</span><span class="sxs-lookup"><span data-stu-id="b99c4-115">For more information, see the [Tagged, Fixed and Variable Columns](./tagged-fixed-and-variable-columns.md) topic.</span></span>

<span data-ttu-id="b99c4-116">Начиная с Windows Vista, пользователи могут задавать параметр JET_bitIndexCrossProduct при создании индекса с помощью [жеткреатеиндекс](./jetcreateindex-function.md) или [JetCreateIndex2](./jetcreateindex2-function.md) , используя структуру [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="b99c4-116">Starting in Windows Vista, users have the option to set the JET_bitIndexCrossProduct option when the index is created with [JetCreateIndex](./jetcreateindex-function.md) or [JetCreateIndex2](./jetcreateindex2-function.md) using the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="b99c4-117">Если этот параметр задан для индекса, все многозначные ключевые столбцы в индексе развертываются, а в индексе для каждого значения в этих столбцах создается перекрестное произведение.</span><span class="sxs-lookup"><span data-stu-id="b99c4-117">When this option is set on an index, all multi-valued key columns in the index are expanded, and a cross product is created in the index for every value in those columns.</span></span> <span data-ttu-id="b99c4-118">Приведенный выше пример теперь возвращает записи для красного-1, Красного-2, Red-3, синего-1, синего-2, Blue-3.</span><span class="sxs-lookup"><span data-stu-id="b99c4-118">The example above now yields entries for red-1, red-2, red-3, blue-1, blue-2, blue-3.</span></span> <span data-ttu-id="b99c4-119">Опять же, каждый ключевой столбец должен быть явно объявлен как многозначный с помощью JET_bitColumnMultiValued для расширения в индексе.</span><span class="sxs-lookup"><span data-stu-id="b99c4-119">Again, each key column must be explicitly declared to be multi-valued via JET_bitColumnMultiValued to be expanded in the index.</span></span>
