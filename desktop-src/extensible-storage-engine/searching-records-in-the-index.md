---
description: 'Дополнительные сведения: Поиск записей в индексе'
title: Поиск записей в индексе
TOCTitle: Searching Records in the Index
ms:assetid: 9141b1d6-81b6-49ad-a5d4-2409fe0d511a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269342(v=EXCHG.10)
ms:contentKeyID: 32765631
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 89a4ffe1f1c13280f236442ae218580fa5699741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683579"
---
# <a name="searching-records-in-the-index"></a><span data-ttu-id="a24aa-103">Поиск записей в индексе</span><span class="sxs-lookup"><span data-stu-id="a24aa-103">Searching Records in the Index</span></span>


<span data-ttu-id="a24aa-104">_**Применимо к:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="a24aa-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="searching-records-in-the-index"></a><span data-ttu-id="a24aa-105">Поиск записей в индексе</span><span class="sxs-lookup"><span data-stu-id="a24aa-105">Searching Records in the Index</span></span>

<span data-ttu-id="a24aa-106">Ключи поиска создаются для поиска одной записи или набора записей в индексе.</span><span class="sxs-lookup"><span data-stu-id="a24aa-106">Search keys are created to search for a single entry or a set of entries in an index.</span></span> <span data-ttu-id="a24aa-107">Ключи поиска могут быть созданы только для ключевых столбцов индекса и могут содержать одно или несколько значений столбцов.</span><span class="sxs-lookup"><span data-stu-id="a24aa-107">Search keys may only be constructed for the key columns in the index, and may contain one or more column values.</span></span> <span data-ttu-id="a24aa-108">Ключ поиска создается с помощью одного вызова или ряда вызовов [жетмакекэй](./jetmakekey-function.md), и их можно получить с помощью [жетретриевекэй](./jetretrievekey-function.md) , используя JET_bitRetrieveCopy.</span><span class="sxs-lookup"><span data-stu-id="a24aa-108">The search key is constructed with a single call or a series of calls to [JetMakeKey](./jetmakekey-function.md), and may be retrieved with [JetRetrieveKey](./jetretrievekey-function.md) using JET_bitRetrieveCopy.</span></span> <span data-ttu-id="a24aa-109">После создания ключа поиска его можно использовать для перемещения курсора в запись в индексе.</span><span class="sxs-lookup"><span data-stu-id="a24aa-109">After the search key is constructed it can be used to move the cursor to the record in the index.</span></span>

<span data-ttu-id="a24aa-110">Существует три метода поиска записей в таблице:</span><span class="sxs-lookup"><span data-stu-id="a24aa-110">There are three methods of finding records in a table:</span></span>

1.  <span data-ttu-id="a24aa-111">Поиск одной записи индекса.</span><span class="sxs-lookup"><span data-stu-id="a24aa-111">Search for a single index entry.</span></span> <span data-ttu-id="a24aa-112">Для этого создайте ключ поиска с помощью [жетмакекэй](./jetmakekey-function.md), а затем перейдите к этой записи с помощью [жетсик](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-112">To do this, create the search key with [JetMakeKey](./jetmakekey-function.md), and then move to that record with [JetSeek](./jetseek-function.md).</span></span>

2.  <span data-ttu-id="a24aa-113">Поиск записей в индексе по записям.</span><span class="sxs-lookup"><span data-stu-id="a24aa-113">Search the index record-by-record.</span></span> <span data-ttu-id="a24aa-114">Записи можно просматривать по одной записи за раз путем вызова [жетмове](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-114">Records can be traversed one record at a time by calling [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="a24aa-115">Курсор можно переместить в первую запись в индексе, указав JET_MoveFirst в параметре *CRowset* объекта [жетмове](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-115">The cursor can be moved to the first record in the index by specifying JET_MoveFirst in the *cRow* parameter of [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="a24aa-116">Таким же образом курсор можно перемещать вперед, назад или к последней записи в индексе.</span><span class="sxs-lookup"><span data-stu-id="a24aa-116">In the same way, the cursor can be moved forward, backward, or to the last entry in the index.</span></span>

3.  <span data-ttu-id="a24aa-117">Поиск по набору записей.</span><span class="sxs-lookup"><span data-stu-id="a24aa-117">Search through a set of records.</span></span> <span data-ttu-id="a24aa-118">Для этого задайте диапазон записей индекса для поиска, а затем последовательно Прокрутите записи.</span><span class="sxs-lookup"><span data-stu-id="a24aa-118">To do this, set a range of index entries to search, then move through the records sequentially.</span></span> <span data-ttu-id="a24aa-119">Дополнительные сведения см. [в разделе Поиск по набору записей]() этой статьи.</span><span class="sxs-lookup"><span data-stu-id="a24aa-119">For more information, see [Searching Through a Set of Records]() section of this topic.</span></span>

### <a name="searching-through-a-set-of-records"></a><span data-ttu-id="a24aa-120">Поиск по набору записей</span><span class="sxs-lookup"><span data-stu-id="a24aa-120">Searching Through a Set of Records</span></span>

<span data-ttu-id="a24aa-121">На схеме здесь показан курсор, продвигаясь по диапазону записей индекса, определенных вызовами [жетсик](./jetseek-function.md) и [жетсетиндексранже](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-121">The diagram here shows the cursor moving through a range of index entries defined by calls to [JetSeek](./jetseek-function.md) and [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>

<span data-ttu-id="a24aa-122">Используйте следующую процедуру для поиска по набору записей в индексе.</span><span class="sxs-lookup"><span data-stu-id="a24aa-122">Use the following procedure to search through a set of records in an index.</span></span>

### <a name="to-search-a-set-of-records-in-an-index"></a><span data-ttu-id="a24aa-123">Поиск набора записей в индексе</span><span class="sxs-lookup"><span data-stu-id="a24aa-123">To search a set of records in an index</span></span>

1.  <span data-ttu-id="a24aa-124">Создайте ключ поиска для первой записи в наборе записей для поиска с помощью [жетмакекэй](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-124">Create the search key for the first record in the set of records to be searched with [JetMakeKey](./jetmakekey-function.md).</span></span>

2.  <span data-ttu-id="a24aa-125">Переместите курсор к записи, указанной в ключе поиска, с помощью [жетсик](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-125">Move the cursor to the record indicated in the search key with [JetSeek](./jetseek-function.md).</span></span>

3.  <span data-ttu-id="a24aa-126">Создайте еще один ключ поиска для последней записи индекса в диапазоне с помощью [жетмакекэй](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-126">Create another search key for the last index entry in the range with [JetMakeKey](./jetmakekey-function.md).</span></span>

4.  <span data-ttu-id="a24aa-127">Задайте диапазон индексов с помощью [жетсетиндексранже](./jetsetindexrange-function.md) , используя ключ, созданный на шаге 3.</span><span class="sxs-lookup"><span data-stu-id="a24aa-127">Set the index range with [JetSetIndexRange](./jetsetindexrange-function.md) using the key created in step 3.</span></span>

5.  <span data-ttu-id="a24aa-128">Вызовите [жетмове](./jetmove-function.md) , чтобы последовательно перемещаться по каждой записи в диапазоне индекса, как показано на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="a24aa-128">Call [JetMove](./jetmove-function.md) to move sequentially through each record in the index range as shown in the following diagram.</span></span>

<span data-ttu-id="a24aa-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span><span class="sxs-lookup"><span data-stu-id="a24aa-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span></span>

<span data-ttu-id="a24aa-130">Курсор на схеме здесь может перемещаться только по диапазонам индексов, заданным в вызове [жетсетиндексранже](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-130">The cursor in the diagram here may only move through the range of indices set in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span> <span data-ttu-id="a24aa-131">Если приложение пытается переместить курсор за пределы диапазона индекса, функция ESE возвращает Jet_errNoCurrentRecord ошибку из вызова [жетмове](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-131">If the application attempts to move the cursor beyond the index range, ESE returns a Jet_errNoCurrentRecord error from the call to [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="a24aa-132">Обратите внимание, что любой тип навигации с этим курсором, отличный от перемещения на следующую или предыдущую запись, отменит диапазон индексов.</span><span class="sxs-lookup"><span data-stu-id="a24aa-132">Note that any type of navigation with this cursor other than moving to the next or previous record will cancel the index range.</span></span> <span data-ttu-id="a24aa-133">Дополнительные сведения см. в разделе [жетсетиндексранже](./jetsetindexrange-function.md) .</span><span class="sxs-lookup"><span data-stu-id="a24aa-133">See [JetSetIndexRange](./jetsetindexrange-function.md) for more information.</span></span>

<span data-ttu-id="a24aa-134">Тип данных, вводимых в параметре *пвдата* для [жетмакекэй](./jetmakekey-function.md) , должен соответствовать типу данных и свойствам, указанным для столбца.</span><span class="sxs-lookup"><span data-stu-id="a24aa-134">The type of data entered in the *pvData* parameter for [JetMakeKey](./jetmakekey-function.md) must match the type of data and properties specified for the column.</span></span> <span data-ttu-id="a24aa-135">Например, вызов [жетмакекэй](./jetmakekey-function.md) с "Бен Миллер", указанным в параметре *пвдата* для типа столбца JET_coltypText является допустимым соответствием типа данных.</span><span class="sxs-lookup"><span data-stu-id="a24aa-135">For example, calling [JetMakeKey](./jetmakekey-function.md) with "Ben Miller" specified in the *pvData* parameter for a column type JET_coltypText is a valid data type match.</span></span> <span data-ttu-id="a24aa-136">Если вы хотите создать ключ поиска для поиска между именами "Бен Миллер" и "Max Стивенс" в индексе, переместите курсор к записи с именем "Бен Миллер", вызвав [жетсик](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-136">If you want to create a search key to search between the names "Ben Miller" and "Max Stevens" in an index, move the cursor to the record with the name "Ben Miller" by calling [JetSeek](./jetseek-function.md).</span></span> <span data-ttu-id="a24aa-137">Вызовите [жетмакекэй](./jetmakekey-function.md) во второй раз и укажите указатель на строку, содержащую имя "Max Стивенс".</span><span class="sxs-lookup"><span data-stu-id="a24aa-137">Call [JetMakeKey](./jetmakekey-function.md) a second time and specify a pointer to a string containing the name "Max Stevens".</span></span> <span data-ttu-id="a24aa-138">Диапазон индексов установлен так, чтобы курсор был перемещен между именами "Бен Миллер" и "Max Стивенс" в вызове [жетсетиндексранже](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="a24aa-138">The index range is set to limit the cursor to move between the names "Ben Miller" and "Max Stevens" in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>
