---
description: 'Дополнительные сведения: Поиск записей в индексе'
title: Поиск записей в индексе
TOCTitle: Searching Records in the Index
ms:assetid: 9141b1d6-81b6-49ad-a5d4-2409fe0d511a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269342(v=EXCHG.10)
ms:contentKeyID: 32765631
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 89a4ffe1f1c13280f236442ae218580fa5699741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683579"
---
# <a name="searching-records-in-the-index"></a>Поиск записей в индексе


_**Применимо к:** Windows | Windows Server_

## <a name="searching-records-in-the-index"></a>Поиск записей в индексе

Ключи поиска создаются для поиска одной записи или набора записей в индексе. Ключи поиска могут быть созданы только для ключевых столбцов индекса и могут содержать одно или несколько значений столбцов. Ключ поиска создается с помощью одного вызова или ряда вызовов [жетмакекэй](./jetmakekey-function.md), и их можно получить с помощью [жетретриевекэй](./jetretrievekey-function.md) , используя JET_bitRetrieveCopy. После создания ключа поиска его можно использовать для перемещения курсора в запись в индексе.

Существует три метода поиска записей в таблице:

1.  Поиск одной записи индекса. Для этого создайте ключ поиска с помощью [жетмакекэй](./jetmakekey-function.md), а затем перейдите к этой записи с помощью [жетсик](./jetseek-function.md).

2.  Поиск записей в индексе по записям. Записи можно просматривать по одной записи за раз путем вызова [жетмове](./jetmove-function.md). Курсор можно переместить в первую запись в индексе, указав JET_MoveFirst в параметре *CRowset* объекта [жетмове](./jetmove-function.md). Таким же образом курсор можно перемещать вперед, назад или к последней записи в индексе.

3.  Поиск по набору записей. Для этого задайте диапазон записей индекса для поиска, а затем последовательно Прокрутите записи. Дополнительные сведения см. [в разделе Поиск по набору записей]() этой статьи.

### <a name="searching-through-a-set-of-records"></a>Поиск по набору записей

На схеме здесь показан курсор, продвигаясь по диапазону записей индекса, определенных вызовами [жетсик](./jetseek-function.md) и [жетсетиндексранже](./jetsetindexrange-function.md).

Используйте следующую процедуру для поиска по набору записей в индексе.

### <a name="to-search-a-set-of-records-in-an-index"></a>Поиск набора записей в индексе

1.  Создайте ключ поиска для первой записи в наборе записей для поиска с помощью [жетмакекэй](./jetmakekey-function.md).

2.  Переместите курсор к записи, указанной в ключе поиска, с помощью [жетсик](./jetseek-function.md).

3.  Создайте еще один ключ поиска для последней записи индекса в диапазоне с помощью [жетмакекэй](./jetmakekey-function.md).

4.  Задайте диапазон индексов с помощью [жетсетиндексранже](./jetsetindexrange-function.md) , используя ключ, созданный на шаге 3.

5.  Вызовите [жетмове](./jetmove-function.md) , чтобы последовательно перемещаться по каждой записи в диапазоне индекса, как показано на следующей схеме.

![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")

Курсор на схеме здесь может перемещаться только по диапазонам индексов, заданным в вызове [жетсетиндексранже](./jetsetindexrange-function.md). Если приложение пытается переместить курсор за пределы диапазона индекса, функция ESE возвращает Jet_errNoCurrentRecord ошибку из вызова [жетмове](./jetmove-function.md). Обратите внимание, что любой тип навигации с этим курсором, отличный от перемещения на следующую или предыдущую запись, отменит диапазон индексов. Дополнительные сведения см. в разделе [жетсетиндексранже](./jetsetindexrange-function.md) .

Тип данных, вводимых в параметре *пвдата* для [жетмакекэй](./jetmakekey-function.md) , должен соответствовать типу данных и свойствам, указанным для столбца. Например, вызов [жетмакекэй](./jetmakekey-function.md) с "Бен Миллер", указанным в параметре *пвдата* для типа столбца JET_coltypText является допустимым соответствием типа данных. Если вы хотите создать ключ поиска для поиска между именами "Бен Миллер" и "Max Стивенс" в индексе, переместите курсор к записи с именем "Бен Миллер", вызвав [жетсик](./jetseek-function.md). Вызовите [жетмакекэй](./jetmakekey-function.md) во второй раз и укажите указатель на строку, содержащую имя "Max Стивенс". Диапазон индексов установлен так, чтобы курсор был перемещен между именами "Бен Миллер" и "Max Стивенс" в вызове [жетсетиндексранже](./jetsetindexrange-function.md).
