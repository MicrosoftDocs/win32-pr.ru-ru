---
description: Регистрация обработчика контекстного меню
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: Регистрация обработчика контекстного меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aafd2798683b4bc291653bca34996f143fc36842
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105647471"
---
# <a name="registering-your-context-menu-handler"></a><span data-ttu-id="e09b3-103">Регистрация обработчика контекстного меню</span><span class="sxs-lookup"><span data-stu-id="e09b3-103">Registering Your Context Menu Handler</span></span>

<span data-ttu-id="e09b3-104">Чтобы обработчик контекстного меню был распознан пространством имен WPD, необходимо правильно зарегистрировать его в реестре Windows.</span><span class="sxs-lookup"><span data-stu-id="e09b3-104">In order for your context menu handler to be recognized by the WPD namespace you must register it properly in the Windows registry.</span></span> <span data-ttu-id="e09b3-105">Записи регистрации для обработчика контекстного меню WPD похожи на те, которые относятся к оболочке, но регистрируются как особые типы файлов.</span><span class="sxs-lookup"><span data-stu-id="e09b3-105">The registration entries for a WPD context menu handler are similar to those for the shell, but they are registered as special file types.</span></span> <span data-ttu-id="e09b3-106">Обработчики контекстного меню WPD регистрируются в соответствии с типом содержимого, который они представляют.</span><span class="sxs-lookup"><span data-stu-id="e09b3-106">WPD context menu handlers are registered according to the content type they represent.</span></span> <span data-ttu-id="e09b3-107">Ниже приведен пример дерева регистрации для обработчика контекстного меню WPD:</span><span class="sxs-lookup"><span data-stu-id="e09b3-107">Below is a sample registration tree for a WPD context menu handler:</span></span>


```C++
HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

```



<span data-ttu-id="e09b3-108">В приведенном выше примере средство просмотра образов оболочки регистрируется в пространстве имен WPD.</span><span class="sxs-lookup"><span data-stu-id="e09b3-108">The above example registers the shell image viewer with the WPD namespace.</span></span> <span data-ttu-id="e09b3-109">Когда пользователь щелкает правой кнопкой мыши содержимое устройства с помощью оболочки Windows Vista, оно вызывает этот обработчик контекстного меню.</span><span class="sxs-lookup"><span data-stu-id="e09b3-109">When a user right-clicks or double-clicks content on a device through the Windows Vista Shell, it invokes this context menu handler.</span></span> <span data-ttu-id="e09b3-110">Пространство имен WPD использует \_ тип содержимого WPD \_ , чтобы определить, какие обработчики контекстного меню загружать.</span><span class="sxs-lookup"><span data-stu-id="e09b3-110">The WPD namespace uses WPD\_CONTENT\_TYPE to determine which context menu handlers to load.</span></span> <span data-ttu-id="e09b3-111">Если \_ тип содержимого WPD \_ РАВЕН \_ \_ неуказанному типу содержимого WPD, тип содержимого \_ WPD \_ \_ \_ Generic \_ File или \_ программа типа содержимого WPD, то пространство имен WPD попытается \_ \_ найти наилучшее соответствие на основе расширения выбранного файла.</span><span class="sxs-lookup"><span data-stu-id="e09b3-111">If WPD\_CONTENT\_TYPE is equal to WPD\_CONTENT\_TYPE\_UNSPECIFIED, WPD\_CONTENT\_TYPE\_GENERIC\_FILE or WPD\_CONTENT\_TYPE\_PROGRAM, then the WPD namespace will try to find the best match based on the extension of the selected file.</span></span> <span data-ttu-id="e09b3-112">Если ни расширение файла, ни тип содержимого не предоставляют полезную классификацию, пространство имен WPD загрузит обработчики контекстного меню в раздел реестра **впдконтекстмену. Generic** .</span><span class="sxs-lookup"><span data-stu-id="e09b3-112">If neither the file extension nor the content type provides a useful classification, the WPD namespace will load the context menu handlers under the **WPDContextMenu.Generic** registry key.</span></span> <span data-ttu-id="e09b3-113">В следующей таблице перечислены все классы файлов, доступные для обработчика контекстного меню, а также типы содержимого и расширения файлов, которые они представляют.</span><span class="sxs-lookup"><span data-stu-id="e09b3-113">The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent:</span></span>



| <span data-ttu-id="e09b3-114">Ключ реестра</span><span class="sxs-lookup"><span data-stu-id="e09b3-114">Registry Key</span></span>                           | <span data-ttu-id="e09b3-115">Тип содержимого WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-115">WPD Content Type</span></span>                                                                                               | <span data-ttu-id="e09b3-116">Расширение файла</span><span class="sxs-lookup"><span data-stu-id="e09b3-116">File Extension</span></span>                                                                                           |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e09b3-117">**Впдконтекстмену. Device**</span><span class="sxs-lookup"><span data-stu-id="e09b3-117">**WPDContextMenu.Device**</span></span>              | <span data-ttu-id="e09b3-118">Регистрация в этом ключе позволяет обработчику контекстного меню на уровне устройства.</span><span class="sxs-lookup"><span data-stu-id="e09b3-118">Registering under this key enables your context menu handler at the device level.</span></span> <span data-ttu-id="e09b3-119">(Щелкните устройство правой кнопкой мыши.)</span><span class="sxs-lookup"><span data-stu-id="e09b3-119">(Right-click on a device.)</span></span>   | <span data-ttu-id="e09b3-120">(не определено)</span><span class="sxs-lookup"><span data-stu-id="e09b3-120">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="e09b3-121">**Впдконтекстмену. хранилище**</span><span class="sxs-lookup"><span data-stu-id="e09b3-121">**WPDContextMenu.Storage**</span></span>             | <span data-ttu-id="e09b3-122">Регистрация в этом ключе позволяет обработчику контекстного меню на уровне хранилища.</span><span class="sxs-lookup"><span data-stu-id="e09b3-122">Registering under this key enables your context menu handler at the storage level.</span></span> <span data-ttu-id="e09b3-123">(Щелкните хранилище правой кнопкой мыши.)</span><span class="sxs-lookup"><span data-stu-id="e09b3-123">(Right-click on a storage.)</span></span> | <span data-ttu-id="e09b3-124">(не определено)</span><span class="sxs-lookup"><span data-stu-id="e09b3-124">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="e09b3-125">**Впдконтекстмену. папка**</span><span class="sxs-lookup"><span data-stu-id="e09b3-125">**WPDContextMenu.Folder**</span></span>              | <span data-ttu-id="e09b3-126">\_ \_ Папка типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-126">WPD\_CONTENT\_TYPE\_FOLDER</span></span>                                                                                     | <span data-ttu-id="e09b3-127">(не определено)</span><span class="sxs-lookup"><span data-stu-id="e09b3-127">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="e09b3-128">**Впдконтекстмену. Image**</span><span class="sxs-lookup"><span data-stu-id="e09b3-128">**WPDContextMenu.Image**</span></span>               | <span data-ttu-id="e09b3-129">\_ \_ изображение типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-129">WPD\_CONTENT\_TYPE\_IMAGE</span></span>                                                                                      | <span data-ttu-id="e09b3-130">BMP</span><span class="sxs-lookup"><span data-stu-id="e09b3-130">.bmp</span></span> <br/> <span data-ttu-id="e09b3-131">.gif</span><span class="sxs-lookup"><span data-stu-id="e09b3-131">.gif</span></span> <br/> <span data-ttu-id="e09b3-132">.png</span><span class="sxs-lookup"><span data-stu-id="e09b3-132">.png</span></span> <br/> <span data-ttu-id="e09b3-133">.jpg</span><span class="sxs-lookup"><span data-stu-id="e09b3-133">.jpg</span></span> <br/> <span data-ttu-id="e09b3-134">JPE</span><span class="sxs-lookup"><span data-stu-id="e09b3-134">.jpe</span></span> <br/> <span data-ttu-id="e09b3-135">JPEG</span><span class="sxs-lookup"><span data-stu-id="e09b3-135">.jpeg</span></span> <br/>   |
| <span data-ttu-id="e09b3-136">**Впдконтекстмену. Audio**</span><span class="sxs-lookup"><span data-stu-id="e09b3-136">**WPDContextMenu.Audio**</span></span>               | <span data-ttu-id="e09b3-137">\_тип содержимого \_ WPD \_ Audio</span><span class="sxs-lookup"><span data-stu-id="e09b3-137">WPD\_CONTENT\_TYPE\_AUDIO</span></span>                                                                                      | <span data-ttu-id="e09b3-138">.aiff</span><span class="sxs-lookup"><span data-stu-id="e09b3-138">.aiff</span></span> <br/> <span data-ttu-id="e09b3-139">.mp3</span><span class="sxs-lookup"><span data-stu-id="e09b3-139">.mp3</span></span> <br/> <span data-ttu-id="e09b3-140">.wav</span><span class="sxs-lookup"><span data-stu-id="e09b3-140">.wav</span></span> <br/> <span data-ttu-id="e09b3-141">.wma</span><span class="sxs-lookup"><span data-stu-id="e09b3-141">.wma</span></span> <br/>                                     |
| <span data-ttu-id="e09b3-142">**Впдконтекстмену. видео**</span><span class="sxs-lookup"><span data-stu-id="e09b3-142">**WPDContextMenu.Video**</span></span>               | <span data-ttu-id="e09b3-143">\_ \_ видео типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-143">WPD\_CONTENT\_TYPE\_VIDEO</span></span>                                                                                      | <span data-ttu-id="e09b3-144">.asf</span><span class="sxs-lookup"><span data-stu-id="e09b3-144">.asf</span></span><br/> <span data-ttu-id="e09b3-145">.avi</span><span class="sxs-lookup"><span data-stu-id="e09b3-145">.avi</span></span> <br/> <span data-ttu-id="e09b3-146">. DVR-MS</span><span class="sxs-lookup"><span data-stu-id="e09b3-146">.dvr-ms</span></span> <br/> <span data-ttu-id="e09b3-147">.mpeg</span><span class="sxs-lookup"><span data-stu-id="e09b3-147">.mpeg</span></span> <br/> <span data-ttu-id="e09b3-148">.mpg</span><span class="sxs-lookup"><span data-stu-id="e09b3-148">.mpg</span></span> <br/> <span data-ttu-id="e09b3-149">.wmv</span><span class="sxs-lookup"><span data-stu-id="e09b3-149">.wmv</span></span> <br/> |
| <span data-ttu-id="e09b3-150">**Впдконтекстмену. список воспроизведения**</span><span class="sxs-lookup"><span data-stu-id="e09b3-150">**WPDContextMenu.Playlist**</span></span><br/> | <span data-ttu-id="e09b3-151">\_ \_ список воспроизведения типов содержимого WPD \_</span><span class="sxs-lookup"><span data-stu-id="e09b3-151">WPD\_CONTENT\_TYPE\_PLAYLIST</span></span>                                                                                   | <span data-ttu-id="e09b3-152">. wpl</span><span class="sxs-lookup"><span data-stu-id="e09b3-152">.wpl</span></span> <br/> <span data-ttu-id="e09b3-153">.m3u</span><span class="sxs-lookup"><span data-stu-id="e09b3-153">.m3u</span></span> <br/> <span data-ttu-id="e09b3-154">. МПЛ</span><span class="sxs-lookup"><span data-stu-id="e09b3-154">.mpl</span></span> <br/> <span data-ttu-id="e09b3-155">.asx</span><span class="sxs-lookup"><span data-stu-id="e09b3-155">.asx</span></span> <br/> <span data-ttu-id="e09b3-156">. областей</span><span class="sxs-lookup"><span data-stu-id="e09b3-156">.pls</span></span> <br/>                     |
| <span data-ttu-id="e09b3-157">**WPDContextMenu.Docумент**</span><span class="sxs-lookup"><span data-stu-id="e09b3-157">**WPDContextMenu.Document**</span></span>            | <span data-ttu-id="e09b3-158">\_ \_ документ типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-158">WPD\_CONTENT\_TYPE\_DOCUMENT</span></span>                                                                                   | <span data-ttu-id="e09b3-159">.doc</span><span class="sxs-lookup"><span data-stu-id="e09b3-159">.doc</span></span> <br/> <span data-ttu-id="e09b3-160">.txt</span><span class="sxs-lookup"><span data-stu-id="e09b3-160">.txt</span></span> <br/> <span data-ttu-id="e09b3-161">.rtf</span><span class="sxs-lookup"><span data-stu-id="e09b3-161">.rtf</span></span> <br/> <span data-ttu-id="e09b3-162">.xls</span><span class="sxs-lookup"><span data-stu-id="e09b3-162">.xls</span></span> <br/> <span data-ttu-id="e09b3-163">.ppt</span><span class="sxs-lookup"><span data-stu-id="e09b3-163">.ppt</span></span> <br/>                     |
| <span data-ttu-id="e09b3-164">**Впдконтекстмену. контакт**</span><span class="sxs-lookup"><span data-stu-id="e09b3-164">**WPDContextMenu.Contact**</span></span><br/>  | <span data-ttu-id="e09b3-165">\_ \_ контакт типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-165">WPD\_CONTENT\_TYPE\_CONTACT</span></span>                                                                                    | <span data-ttu-id="e09b3-166">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-166">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-167">**WPDContextMenu.Email**</span><span class="sxs-lookup"><span data-stu-id="e09b3-167">**WPDContextMenu.Email**</span></span>               | <span data-ttu-id="e09b3-168">\_ \_ \_ адрес электронной почты типа содержимого WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-168">WPD\_CONTENT\_TYPE\_EMAIL</span></span>                                                                                      | <span data-ttu-id="e09b3-169">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-169">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-170">**Впдконтекстмену. Встреча**</span><span class="sxs-lookup"><span data-stu-id="e09b3-170">**WPDContextMenu.Appointment**</span></span>         | <span data-ttu-id="e09b3-171">\_тип содержимого WPD — \_ \_ встреча</span><span class="sxs-lookup"><span data-stu-id="e09b3-171">WPD\_CONTENT\_TYPE\_APPOINTMENT</span></span>                                                                                | <span data-ttu-id="e09b3-172">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-172">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-173">**Впдконтекстмену. задача**</span><span class="sxs-lookup"><span data-stu-id="e09b3-173">**WPDContextMenu.Task**</span></span>                | <span data-ttu-id="e09b3-174">\_ \_ задача типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-174">WPD\_CONTENT\_TYPE\_TASK</span></span>                                                                                       | <span data-ttu-id="e09b3-175">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-175">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-176">**Впдконтекстмену. МЕМО**</span><span class="sxs-lookup"><span data-stu-id="e09b3-176">**WPDContextMenu.Memo**</span></span>                | <span data-ttu-id="e09b3-177">\_ \_ МЕМО типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-177">WPD\_CONTENT\_TYPE\_MEMO</span></span>                                                                                       | <span data-ttu-id="e09b3-178">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-178">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-179">**Впдконтекстмену. Имажеалбум**</span><span class="sxs-lookup"><span data-stu-id="e09b3-179">**WPDContextMenu.ImageAlbum**</span></span>          | <span data-ttu-id="e09b3-180">\_тип содержимого WPD — \_ \_ \_ альбом изображений</span><span class="sxs-lookup"><span data-stu-id="e09b3-180">WPD\_CONTENT\_TYPE\_IMAGE\_ALBUM</span></span>                                                                               | <span data-ttu-id="e09b3-181">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-181">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-182">**Впдконтекстмену. Аудиоалбум**</span><span class="sxs-lookup"><span data-stu-id="e09b3-182">**WPDContextMenu.AudioAlbum**</span></span>          | <span data-ttu-id="e09b3-183">\_ \_ \_ звуковой \_ альбом типа содержимого WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-183">WPD\_CONTENT\_TYPE\_AUDIO\_ALBUM</span></span>                                                                               | <span data-ttu-id="e09b3-184">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-184">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-185">**Впдконтекстмену. Видеоалбум**</span><span class="sxs-lookup"><span data-stu-id="e09b3-185">**WPDContextMenu.VideoAlbum**</span></span>          | <span data-ttu-id="e09b3-186">\_видеоадаптер \_ типа \_ содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-186">WPD\_CONTENT\_TYPE\_VIDEO\_ALBUM</span></span>                                                                               | <span data-ttu-id="e09b3-187">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-187">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-188">**Впдконтекстмену. Микседалбум**</span><span class="sxs-lookup"><span data-stu-id="e09b3-188">**WPDContextMenu.MixedAlbum**</span></span>          | <span data-ttu-id="e09b3-189">\_ \_ \_ альбом смешанного \_ содержимого типа содержимого \_ WPD</span><span class="sxs-lookup"><span data-stu-id="e09b3-189">WPD\_CONTENT\_TYPE\_MIXED\_CONTENT\_ALBUM</span></span>                                                                      | <span data-ttu-id="e09b3-190">Нет</span><span class="sxs-lookup"><span data-stu-id="e09b3-190">None</span></span>                                                                                                     |
| <span data-ttu-id="e09b3-191">**Впдконтекстмену. Generic**</span><span class="sxs-lookup"><span data-stu-id="e09b3-191">**WPDContextMenu.Generic**</span></span>             | <span data-ttu-id="e09b3-192">\_тип содержимого WPD не \_ \_ указан</span><span class="sxs-lookup"><span data-stu-id="e09b3-192">WPD\_CONTENT\_TYPE\_UNSPECIFIED</span></span>                                                                                | <span data-ttu-id="e09b3-193">Все прочие расширения файлов</span><span class="sxs-lookup"><span data-stu-id="e09b3-193">All other file extensions</span></span>                                                                                |



 

 

 




