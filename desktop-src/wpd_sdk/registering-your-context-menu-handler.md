---
description: Регистрация обработчика контекстного меню
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: Регистрация обработчика контекстного меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aafd2798683b4bc291653bca34996f143fc36842
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105647471"
---
# <a name="registering-your-context-menu-handler"></a>Регистрация обработчика контекстного меню

Чтобы обработчик контекстного меню был распознан пространством имен WPD, необходимо правильно зарегистрировать его в реестре Windows. Записи регистрации для обработчика контекстного меню WPD похожи на те, которые относятся к оболочке, но регистрируются как особые типы файлов. Обработчики контекстного меню WPD регистрируются в соответствии с типом содержимого, который они представляют. Ниже приведен пример дерева регистрации для обработчика контекстного меню WPD:


```C++
HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

```



В приведенном выше примере средство просмотра образов оболочки регистрируется в пространстве имен WPD. Когда пользователь щелкает правой кнопкой мыши содержимое устройства с помощью оболочки Windows Vista, оно вызывает этот обработчик контекстного меню. Пространство имен WPD использует \_ тип содержимого WPD \_ , чтобы определить, какие обработчики контекстного меню загружать. Если \_ тип содержимого WPD \_ РАВЕН \_ \_ неуказанному типу содержимого WPD, тип содержимого \_ WPD \_ \_ \_ Generic \_ File или \_ программа типа содержимого WPD, то пространство имен WPD попытается \_ \_ найти наилучшее соответствие на основе расширения выбранного файла. Если ни расширение файла, ни тип содержимого не предоставляют полезную классификацию, пространство имен WPD загрузит обработчики контекстного меню в раздел реестра **впдконтекстмену. Generic** . В следующей таблице перечислены все классы файлов, доступные для обработчика контекстного меню, а также типы содержимого и расширения файлов, которые они представляют.



| Ключ реестра                           | Тип содержимого WPD                                                                                               | Расширение файла                                                                                           |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| **Впдконтекстмену. Device**              | Регистрация в этом ключе позволяет обработчику контекстного меню на уровне устройства. (Щелкните устройство правой кнопкой мыши.)   | (не определено)                                                                                                    |
| **Впдконтекстмену. хранилище**             | Регистрация в этом ключе позволяет обработчику контекстного меню на уровне хранилища. (Щелкните хранилище правой кнопкой мыши.) | (не определено)                                                                                                    |
| **Впдконтекстмену. папка**              | \_ \_ Папка типа содержимого \_ WPD                                                                                     | (не определено)                                                                                                    |
| **Впдконтекстмену. Image**               | \_ \_ изображение типа содержимого \_ WPD                                                                                      | BMP <br/> .gif <br/> .png <br/> .jpg <br/> JPE <br/> JPEG <br/>   |
| **Впдконтекстмену. Audio**               | \_тип содержимого \_ WPD \_ Audio                                                                                      | .aiff <br/> .mp3 <br/> .wav <br/> .wma <br/>                                     |
| **Впдконтекстмену. видео**               | \_ \_ видео типа содержимого \_ WPD                                                                                      | .asf<br/> .avi <br/> . DVR-MS <br/> .mpeg <br/> .mpg <br/> .wmv <br/> |
| **Впдконтекстмену. список воспроизведения**<br/> | \_ \_ список воспроизведения типов содержимого WPD \_                                                                                   | . wpl <br/> .m3u <br/> . МПЛ <br/> .asx <br/> . областей <br/>                     |
| **WPDContextMenu.Docумент**            | \_ \_ документ типа содержимого \_ WPD                                                                                   | .doc <br/> .txt <br/> .rtf <br/> .xls <br/> .ppt <br/>                     |
| **Впдконтекстмену. контакт**<br/>  | \_ \_ контакт типа содержимого \_ WPD                                                                                    | Нет                                                                                                     |
| **WPDContextMenu.Email**               | \_ \_ \_ адрес электронной почты типа содержимого WPD                                                                                      | Нет                                                                                                     |
| **Впдконтекстмену. Встреча**         | \_тип содержимого WPD — \_ \_ встреча                                                                                | Нет                                                                                                     |
| **Впдконтекстмену. задача**                | \_ \_ задача типа содержимого \_ WPD                                                                                       | Нет                                                                                                     |
| **Впдконтекстмену. МЕМО**                | \_ \_ МЕМО типа содержимого \_ WPD                                                                                       | Нет                                                                                                     |
| **Впдконтекстмену. Имажеалбум**          | \_тип содержимого WPD — \_ \_ \_ альбом изображений                                                                               | Нет                                                                                                     |
| **Впдконтекстмену. Аудиоалбум**          | \_ \_ \_ звуковой \_ альбом типа содержимого WPD                                                                               | Нет                                                                                                     |
| **Впдконтекстмену. Видеоалбум**          | \_видеоадаптер \_ типа \_ содержимого \_ WPD                                                                               | Нет                                                                                                     |
| **Впдконтекстмену. Микседалбум**          | \_ \_ \_ альбом смешанного \_ содержимого типа содержимого \_ WPD                                                                      | Нет                                                                                                     |
| **Впдконтекстмену. Generic**             | \_тип содержимого WPD не \_ \_ указан                                                                                | Все прочие расширения файлов                                                                                |



 

 

 




