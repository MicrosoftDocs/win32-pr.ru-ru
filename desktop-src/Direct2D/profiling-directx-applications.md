---
title: Про приложения DirectX
description: Показано, как измерять некоторые из наиболее важных измерений времени производительности для приложения DirectX с помощью средств XPerf и GPUView, поставляемых в составе набора средств производительности Windows.
ms.assetid: 4B2F7273-C9B0-4DD3-B559-6220CDE62129
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0280389d4f8f2161e5e07f8906df7ea0484ad458
ms.sourcegitcommit: 37f276b5d887a3aad04b1ba86e390dea9d87e591
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2021
ms.locfileid: "104568042"
---
# <a name="profiling-directx-apps"></a><span data-ttu-id="f562a-103">Про приложения DirectX</span><span class="sxs-lookup"><span data-stu-id="f562a-103">Profiling DirectX Apps</span></span>

<span data-ttu-id="f562a-104">Здесь показано, как измерять некоторые из наиболее важных измерений времени производительности для приложения [DirectX](/previous-versions/windows/apps/jj262109(v=win.10)) с помощью средств **Xperf** и **GPUView** , поставляемых в составе набора средств производительности Windows.</span><span class="sxs-lookup"><span data-stu-id="f562a-104">This shows you how to measure some of the most important performance time measurements for a [DirectX](/previous-versions/windows/apps/jj262109(v=win.10)) app using the **XPerf** and **GPUView** tools that ship as part of the Windows Performance Toolkit.</span></span> <span data-ttu-id="f562a-105">Это не исчерпывающее представление о средствах, а об их особенностях для анализа производительности приложений DirectX.</span><span class="sxs-lookup"><span data-stu-id="f562a-105">This is not a comprehensive guide for understanding the tools, rather their specific applicability for analyzing DirectX app performance.</span></span> <span data-ttu-id="f562a-106">Хотя большинство обсуждаемых методик относятся ко всем приложениям DirectX, оно особенно важно для приложений, использующих цепочки подкачки, а не для приложений DirectX, созданных на основе XAML, использующих анимацию SIS/ВСИС и XAML.</span><span class="sxs-lookup"><span data-stu-id="f562a-106">While most of the techniques discussed here are relevant to all DirectX apps, it is most relevant to apps that use swap chains and not to DirectX applications built on XAML that use SIS/VSIS and XAML animations.</span></span> <span data-ttu-id="f562a-107">Мы расскажу вам о ключевых измерениях времени производительности, о том, как получить и установить средства, а затем взять трассировку измерения производительности, а затем проанализировать их, чтобы понять узкие места приложений.</span><span class="sxs-lookup"><span data-stu-id="f562a-107">We walk you through key performance time measurements, how to acquire and install the tools, and take performance measurement traces then analyze them to understand app bottlenecks.</span></span>

## <a name="about-the-tools"></a><span data-ttu-id="f562a-108">О средствах</span><span class="sxs-lookup"><span data-stu-id="f562a-108">About the Tools</span></span>

### <a name="xperf"></a><span data-ttu-id="f562a-109">**XPerf**</span><span class="sxs-lookup"><span data-stu-id="f562a-109">**XPerf**</span></span>

<span data-ttu-id="f562a-110">**Xperf** — это набор средств анализа производительности, построенных на основе трассировки событий для Windows (ETW), предназначенной для измерения и анализа подробной производительности системы и приложений и использования ресурсов.</span><span class="sxs-lookup"><span data-stu-id="f562a-110">**XPerf** is a set of performance analysis tools built on top of Event Tracing for Windows (ETW) designed for measuring and analyzing detailed system and app performance and resource usage.</span></span> <span data-ttu-id="f562a-111">Начиная с Windows 8, это средство командной строки имеет графический пользовательский интерфейс и называется записью производительности Windows (ЗВЧ) и анализатором производительности Windows (WPA).</span><span class="sxs-lookup"><span data-stu-id="f562a-111">Starting in Windows 8 this command line tool has a graphical user interface and is called the Windows Performance Recorder (WPR) and Windows Performance Analyzer (WPA).</span></span> <span data-ttu-id="f562a-112">Дополнительные сведения об этих средствах можно найти на веб-странице для [Windows Performance Toolkit](/previous-versions/windows/it-pro/windows-8.1-and-8/hh162945(v=win.10)) (WPT): [набор средств производительности Windows](/previous-versions/windows/it-pro/windows-8.1-and-8/hh162945(v=win.10)).</span><span class="sxs-lookup"><span data-stu-id="f562a-112">More information about these tools can be found at the web page for [Windows Performance Toolkit](/previous-versions/windows/it-pro/windows-8.1-and-8/hh162945(v=win.10)) (WPT): [Windows Performance Toolkit](/previous-versions/windows/it-pro/windows-8.1-and-8/hh162945(v=win.10)).</span></span>

<span data-ttu-id="f562a-113">ETW собирает запрошенные события ядра и сохраняет их в файл, называемый файлом журнала трассировки событий (ETL).</span><span class="sxs-lookup"><span data-stu-id="f562a-113">An ETW collects requested kernel events and saves them into a file called an event trace log (ETL) file.</span></span> <span data-ttu-id="f562a-114">Эти события ядра предоставляют подробные сведения о характеристиках приложения и системы при запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="f562a-114">These kernel events provide extensive information about an app and system characteristics when running the app.</span></span> <span data-ttu-id="f562a-115">Сбор данных осуществляется путем включения захвата трассировки, выполнения требуемого сценария приложения, требующего анализа, прекращения записи, которая сохраняет данные в ETL-файле.</span><span class="sxs-lookup"><span data-stu-id="f562a-115">Data is collected by enabling trace capture, performing the desired app scenario that needs analysis, stopping the capture which saves the data in an ETL file.</span></span> <span data-ttu-id="f562a-116">Затем можно проанализировать файл на том же или на другом компьютере с помощью программы командной строки **xperf.exe** или средства анализа визуальной трассировки **xperfview.exe**.</span><span class="sxs-lookup"><span data-stu-id="f562a-116">You can then analyze the file on the same or a different machine using either the command line tool **xperf.exe** or the visual trace analysis tool **xperfview.exe**.</span></span>

### <a name="gpuview"></a><span data-ttu-id="f562a-117">GPUView;</span><span class="sxs-lookup"><span data-stu-id="f562a-117">GPUView</span></span>

<span data-ttu-id="f562a-118">**GPUView** — это средство разработки для определения производительности графического процессора и ЦП.</span><span class="sxs-lookup"><span data-stu-id="f562a-118">**GPUView** is a development tool for determining the performance of the graphics processing unit (GPU) and CPU.</span></span> <span data-ttu-id="f562a-119">Он рассматривает производительность с точки зрения обработки буфера прямого доступа к памяти (DMA) и других видеоматериалов на видеооборудовании.</span><span class="sxs-lookup"><span data-stu-id="f562a-119">It looks at performance with regard to direct memory access (DMA) buffer processing and all other video processing on the video hardware.</span></span>

<span data-ttu-id="f562a-120">Для приложений [DirectX](/previous-versions/windows/apps/jj262109(v=win.10)) , которые сильно полагаются на GPU, **GPUView** является мощным средством для понимания отношений между работой, выполненной на ЦП и GPU.</span><span class="sxs-lookup"><span data-stu-id="f562a-120">For [DirectX](/previous-versions/windows/apps/jj262109(v=win.10)) apps that rely heavily on the GPU, **GPUView** is a powerful tool for understanding the relationship between work done on the CPU vs. GPU.</span></span> <span data-ttu-id="f562a-121">Дополнительные сведения о **GPUView** см. [в разделе Использование GPUView](/windows-hardware/drivers/display/using-gpuview).</span><span class="sxs-lookup"><span data-stu-id="f562a-121">For more info about **GPUView** see [Using GPUView](/windows-hardware/drivers/display/using-gpuview).</span></span>

<span data-ttu-id="f562a-122">Как и в случае с **Xperf**, трассировка ETW сначала выполняется запуском службы трассировки, с использованием сценария, который требует анализа для рассматриваемого приложения, и останавливает службу и сохраняет данные в ETL-файле.</span><span class="sxs-lookup"><span data-stu-id="f562a-122">Similar to **XPerf**, an ETW trace is first taken by starting the tracing service, exercising the scenario that needs analysis for the app under consideration, stopping the service and saving the information in an ETL file.</span></span> <span data-ttu-id="f562a-123">**GPUView** представляет данные, представленные в ETL-файле в графическом формате.</span><span class="sxs-lookup"><span data-stu-id="f562a-123">**GPUView** presents the data present in the ETL file in a graphical format.</span></span>

<span data-ttu-id="f562a-124">После установки средства **GPUView** мы рекомендуем ознакомиться с разделом "главное отображение **GPUView**" в меню "Справка"**GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-124">After installing the **GPUView** tool, it is we recommend you read the "**GPUView**’s Main Display" topic under the "**GPUView** Help" menu.</span></span> <span data-ttu-id="f562a-125">Он содержит полезную информацию о том, как интерпретировать пользовательский интерфейс **GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-125">It contains useful information about how to interpret the **GPUView** UI.</span></span>

## <a name="installing-the-tools"></a><span data-ttu-id="f562a-126">Установка средств</span><span class="sxs-lookup"><span data-stu-id="f562a-126">Installing the Tools</span></span>

<span data-ttu-id="f562a-127">**Xperf** и **GPUView** включены в набор средств Windows Performance Toolkit (WPT).</span><span class="sxs-lookup"><span data-stu-id="f562a-127">Both **XPerf** and **GPUView** are included in the Windows Performance Toolkit (WPT).</span></span>

<span data-ttu-id="f562a-128">**Xperf** поставляется в составе пакета средств разработки программного обеспечения (SDK) для Windows.</span><span class="sxs-lookup"><span data-stu-id="f562a-128">**XPerf** ships as part of the Windows Software Development Kit (SDK) for Windows.</span></span> <span data-ttu-id="f562a-129">[Скачайте Windows SDK](https://dev.windows.com/downloads).</span><span class="sxs-lookup"><span data-stu-id="f562a-129">[Download the Windows SDK](https://dev.windows.com/downloads).</span></span>

<span data-ttu-id="f562a-130">**GPUView** доступен в комплекте средств для развертывания и оценки Windows (Windows ADK).</span><span class="sxs-lookup"><span data-stu-id="f562a-130">**GPUView** is available in the Windows Assessment and Deployment Kit (Windows ADK).</span></span> <span data-ttu-id="f562a-131">[Загрузите Windows ADK](/windows-hardware/get-started/adk-install).</span><span class="sxs-lookup"><span data-stu-id="f562a-131">[Download the Windows ADK](/windows-hardware/get-started/adk-install).</span></span>

<span data-ttu-id="f562a-132">После установки необходимо добавить в системную переменную "Path" каталоги, содержащие **Xperf** и **GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-132">After installation, you must add the directories that contain **XPerf** and **GPUView** to the system "Path" variable.</span></span>

<span data-ttu-id="f562a-133">Нажмите кнопку "Пуск" и введите "Системные переменные".</span><span class="sxs-lookup"><span data-stu-id="f562a-133">Click the Start button and type "System Variables".</span></span> <span data-ttu-id="f562a-134">Откроется системное окно свойств.</span><span class="sxs-lookup"><span data-stu-id="f562a-134">The System Properties window opens.</span></span> <span data-ttu-id="f562a-135">Щелкните "изменить системные переменные среды".</span><span class="sxs-lookup"><span data-stu-id="f562a-135">Click "Edit the system environment variables".</span></span> <span data-ttu-id="f562a-136">Выберите "переменные среды" в диалоговом окне "Свойства системы".</span><span class="sxs-lookup"><span data-stu-id="f562a-136">Select "Environment Variables" from the "System Properties" dialog box.</span></span> <span data-ttu-id="f562a-137">Переменная "Path" находится в разделе "Системные переменные".</span><span class="sxs-lookup"><span data-stu-id="f562a-137">The "Path" variable is found under "System variables".</span></span> <span data-ttu-id="f562a-138">Добавьте в путь Каталог, содержащий **xperf.exe** и **GPUView.exe** .</span><span class="sxs-lookup"><span data-stu-id="f562a-138">Append the directory containing **xperf.exe** and **GPUView.exe** to the path.</span></span> <span data-ttu-id="f562a-139">Эти исполняемые файлы находятся в каталоге "Windows Performance Toolkit" в подсистеме "комплекты Windows".</span><span class="sxs-lookup"><span data-stu-id="f562a-139">These executables are found in the "Windows Performance Toolkit" directory inside the "Windows Kits".</span></span> <span data-ttu-id="f562a-140">Расположение по умолчанию: **C: \\ Program Files (x86) \\ наборы Windows с \\ \\ набором средств производительности Windows 10**.</span><span class="sxs-lookup"><span data-stu-id="f562a-140">The default location is: **C:\\Program Files (x86)\\Windows Kits\\10\\Windows Performance Toolkit**.</span></span>

## <a name="performance-time-measurements"></a><span data-ttu-id="f562a-141">Измерения времени производительности</span><span class="sxs-lookup"><span data-stu-id="f562a-141">Performance Time Measurements</span></span>

<span data-ttu-id="f562a-142">Большинство приложений должны работать плавно и реагировать на ввод данных пользователем.</span><span class="sxs-lookup"><span data-stu-id="f562a-142">Most apps expect to run smoothly and be responsive to user input.</span></span> <span data-ttu-id="f562a-143">Однако в зависимости от нужного сценария один аспект производительности может быть более важным, чем другой.</span><span class="sxs-lookup"><span data-stu-id="f562a-143">However, depending upon the scenario the you want, one aspect of performance might be more important than another.</span></span> <span data-ttu-id="f562a-144">Например, для приложения для чтения новостей, работающего на сенсорном планшетном ПК, наиболее важным аспектом является просмотр одной статьи за раз, а также сдвиг/масштаб и прокрутку одной или другой статьи.</span><span class="sxs-lookup"><span data-stu-id="f562a-144">For instance, for a news reader app running on a touch tablet PC, the most important aspect is to view a single article at a time and to pan/zoom/scroll through the same or a different article.</span></span> <span data-ttu-id="f562a-145">В этом сценарии возможность просмотра всего содержимого для каждого кадра не требуется.</span><span class="sxs-lookup"><span data-stu-id="f562a-145">In this scenario the ability to render all the content every frame is not necessary.</span></span> <span data-ttu-id="f562a-146">Однако очень важно иметь возможность плавно прокручивать статью по сенсорному жесту.</span><span class="sxs-lookup"><span data-stu-id="f562a-146">However, the ability to scroll through the article smoothly upon a touch gesture is extremely important.</span></span>

<span data-ttu-id="f562a-147">В другом экземпляре, в игре или в приложении для отрисовки видео, использующем большое количество анимаций, производятся сбои при удалении кадров.</span><span class="sxs-lookup"><span data-stu-id="f562a-147">In another instance, a game or a video rendering app that uses lots of animations glitches if frames are dropped.</span></span> <span data-ttu-id="f562a-148">В этом случае очень важно иметь возможность предоставлять содержимое на экране, не интеруптион от вводимых пользователем данных.</span><span class="sxs-lookup"><span data-stu-id="f562a-148">In this case, the ability to present content on the screen without interuption from user input is extremely important.</span></span>

<span data-ttu-id="f562a-149">Чтобы понять, какая часть приложения является проблематичной, первым шагом является выбор наиболее важных сценариев.</span><span class="sxs-lookup"><span data-stu-id="f562a-149">In order to understand which part of the app is problematic, the first step is to decide on the most important scenarios.</span></span> <span data-ttu-id="f562a-150">После того как основные аспекты приложения понятны и как они будут применяться, поиск проблем с помощью средств становится проще.</span><span class="sxs-lookup"><span data-stu-id="f562a-150">Once the core aspects of the app are understood and how they will be exercised, looking for problems using the tools becomes easier.</span></span>

<span data-ttu-id="f562a-151">Ниже приведены некоторые из наиболее распространенных метрик времени производительности.</span><span class="sxs-lookup"><span data-stu-id="f562a-151">Some of the most common performance time metrics are as follows:</span></span>

### <a name="startup-time"></a><span data-ttu-id="f562a-152">Время запуска</span><span class="sxs-lookup"><span data-stu-id="f562a-152">Startup-time</span></span>

<span data-ttu-id="f562a-153">Время от запуска процесса до первого присутствия на экране.</span><span class="sxs-lookup"><span data-stu-id="f562a-153">Time measured from process launch to first present hitting the screen.</span></span> <span data-ttu-id="f562a-154">Это измерение более полезно, если система является теплой, что означает, что измерение берется после запуска приложения несколько раз.</span><span class="sxs-lookup"><span data-stu-id="f562a-154">This measurement is more useful when the system is warm meaning the measurement is taken after the app is launched a few times.</span></span>

### <a name="cpu-time-per-frame"></a><span data-ttu-id="f562a-155">Время ЦП на кадр</span><span class="sxs-lookup"><span data-stu-id="f562a-155">CPU time per frame</span></span>

<span data-ttu-id="f562a-156">Время, когда ЦП активно обрабатывает рабочую нагрузку приложения для одного кадра.</span><span class="sxs-lookup"><span data-stu-id="f562a-156">The time for which CPU actively processes the app workload for one frame.</span></span> <span data-ttu-id="f562a-157">Если приложение работает без проблем, вся обработка, необходимая для одного кадра, происходит в течение одного интервала v-Sync.</span><span class="sxs-lookup"><span data-stu-id="f562a-157">If the app is running smoothly, all the processing required for one frame happens within one v-sync interval.</span></span> <span data-ttu-id="f562a-158">При частоте обновления монитора 60 Гц это 16ms на кадр.</span><span class="sxs-lookup"><span data-stu-id="f562a-158">With the monitor refresh rate of 60Hz, this comes to 16ms per frame.</span></span> <span data-ttu-id="f562a-159">Если время или кадр ЦП больше 16ms, то для создания безошибочного приложения может потребоваться оптимизация центрального процессора.</span><span class="sxs-lookup"><span data-stu-id="f562a-159">If CPU time/frame is greater than 16ms, CPU optimizations might be needed to produce a glitch free app experience.</span></span>

### <a name="gpu-time-per-frame"></a><span data-ttu-id="f562a-160">Время GPU на кадр</span><span class="sxs-lookup"><span data-stu-id="f562a-160">GPU time per frame</span></span>

<span data-ttu-id="f562a-161">Время, когда GPU активно обрабатывает рабочую нагрузку приложения для одного кадра.</span><span class="sxs-lookup"><span data-stu-id="f562a-161">The time for which GPU actively processes the app workload for one frame.</span></span> <span data-ttu-id="f562a-162">Приложение — это привязка GPU, когда время, затрачиваемое на обработку данных кадра, превышает 16ms.</span><span class="sxs-lookup"><span data-stu-id="f562a-162">An app is GPU bound when the time taken to process a frame worth of data is more than 16ms.</span></span>

<span data-ttu-id="f562a-163">Возможность понять, является ли приложение привязанным к ЦП или GPU, будет ограничивать проблемную часть кода.</span><span class="sxs-lookup"><span data-stu-id="f562a-163">Being able to understand whether an app is CPU or GPU bound will narrow the problematic part of the code.</span></span>

## <a name="taking-performance-time-measurement-trace"></a><span data-ttu-id="f562a-164">Выполняется трассировка измерения времени производительности</span><span class="sxs-lookup"><span data-stu-id="f562a-164">Taking performance time measurement trace</span></span>

<span data-ttu-id="f562a-165">Выполните следующие действия, чтобы выполнить трассировку:</span><span class="sxs-lookup"><span data-stu-id="f562a-165">Perform these steps to take a trace:</span></span>

1.  <span data-ttu-id="f562a-166">Откройте командное окно от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="f562a-166">Open a command window as an administrator.</span></span>
2.  <span data-ttu-id="f562a-167">Закройте приложение, если оно уже запущено.</span><span class="sxs-lookup"><span data-stu-id="f562a-167">Close the app if it is already running.</span></span>
3.  <span data-ttu-id="f562a-168">Измените каталоги на каталог *gpuview* в папке Windows Performance Toolkit.</span><span class="sxs-lookup"><span data-stu-id="f562a-168">Change directories to the *gpuview* directory inside the Windows Performance Toolkit folder.</span></span>
4.  <span data-ttu-id="f562a-169">Введите "log. cmd", чтобы запустить трассировку событий.</span><span class="sxs-lookup"><span data-stu-id="f562a-169">Type "log.cmd" to start event tracing.</span></span> <span data-ttu-id="f562a-170">Этот параметр записывает в журнал наиболее интересные события.</span><span class="sxs-lookup"><span data-stu-id="f562a-170">This option logs the most interesting events.</span></span> <span data-ttu-id="f562a-171">Другие доступные параметры регистрируют различные области событий.</span><span class="sxs-lookup"><span data-stu-id="f562a-171">Other available options log different scope of the events.</span></span> <span data-ttu-id="f562a-172">Для экземпляра ' v ' или режима подробного протоколирования захватываются все события, о которых **GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-172">For instance ‘v’ or verbose log mode captures all events that the **GPUView** is aware of.</span></span>
5.  <span data-ttu-id="f562a-173">Запустите пример и выполните пример таким образом, который охватывает путь производительности, который необходимо проанализировать.</span><span class="sxs-lookup"><span data-stu-id="f562a-173">Launch the sample, and exercise the sample in a manner that covers the performance path that you need to analyze.</span></span>
6.  <span data-ttu-id="f562a-174">Вернитесь в окно командной строки и введите "log. cmd" еще раз, чтобы отключить ведение журнала.</span><span class="sxs-lookup"><span data-stu-id="f562a-174">Go back to the command windows and type "log.cmd" again to stop logging.</span></span>
7.  <span data-ttu-id="f562a-175">В папке *gpuview* будет выводится файл с именем Merged. ETL.</span><span class="sxs-lookup"><span data-stu-id="f562a-175">This outputs a file called "merged.etl" in the *gpuview* folder.</span></span> <span data-ttu-id="f562a-176">Этот файл можно сохранить в другом расположении. его можно проанализировать на том же или на другом компьютере.</span><span class="sxs-lookup"><span data-stu-id="f562a-176">You can save this file to another location and you can analyze it on the same or a different machine.</span></span> <span data-ttu-id="f562a-177">Чтобы просмотреть сведения о захвате стека, сохраните файл символов (. pdb), связанный с приложением.</span><span class="sxs-lookup"><span data-stu-id="f562a-177">In order to view stack capture details, save the symbol file (.pdb) associated with the app.</span></span>

## <a name="measurements"></a><span data-ttu-id="f562a-178">Измерения</span><span class="sxs-lookup"><span data-stu-id="f562a-178">Measurements</span></span>


> [!Note]  
> <span data-ttu-id="f562a-179">Пример использования геометрических измерений приведен на четырехъядерном компьютере с интегрированной графической картой DirectX11.</span><span class="sxs-lookup"><span data-stu-id="f562a-179">The measurements for geometry realization sample are taken on a Quad Core machine with an integrated DirectX11 graphics card.</span></span> <span data-ttu-id="f562a-180">Измерения зависят от конфигурации компьютера.</span><span class="sxs-lookup"><span data-stu-id="f562a-180">The measurements vary depending upon the machine configuration.</span></span>

 

<span data-ttu-id="f562a-181">В этом разделе показано, как измерять время запуска, ЦП и GPU на единицах измерения кадра.</span><span class="sxs-lookup"><span data-stu-id="f562a-181">This section demonstrates how to measure the startup-time, CPU and GPU time per frame measurements.</span></span> <span data-ttu-id="f562a-182">Вы можете записать трассировку производительности для того же примера на компьютере и увидеть различия в различных измерениях.</span><span class="sxs-lookup"><span data-stu-id="f562a-182">You can capture a performance trace for the same sample on your machine and see the differences in the various measurements.</span></span>

<span data-ttu-id="f562a-183">Чтобы проанализировать трассировку в **GPUView**, откройте файл "Merged. ELT" с помощью **GPUView.exe**.</span><span class="sxs-lookup"><span data-stu-id="f562a-183">To analyze the trace in **GPUView**, open the "merged.elt" file using **GPUView.exe**.</span></span>

### <a name="startup-time"></a><span data-ttu-id="f562a-184">Время запуска</span><span class="sxs-lookup"><span data-stu-id="f562a-184">Startup-time</span></span>

<span data-ttu-id="f562a-185">Время запуска измеряется общим временем запуска приложения до первого появления содержимого на экране.</span><span class="sxs-lookup"><span data-stu-id="f562a-185">The startup time is measured by the total time spent from the app start until the content first appears on the screen.</span></span>

<span data-ttu-id="f562a-186">Измерения времени запуска лучше использовать, выполнив действия, описанные в предыдущем разделе, с этими вариантами.</span><span class="sxs-lookup"><span data-stu-id="f562a-186">The startup-time measurement is best taken by following the steps listed in the previous section with these variations:</span></span>

-   <span data-ttu-id="f562a-187">Если вы задаете измерения запуска при первом запуске приложения, это называется холодный запуском.</span><span class="sxs-lookup"><span data-stu-id="f562a-187">If the you take the start-up measurements the very first time you launch the app, it is called cold startup.</span></span> <span data-ttu-id="f562a-188">Это может отличаться от измерений, сделанных после запуска приложения несколько раз в течение небольшого промежутка времени.</span><span class="sxs-lookup"><span data-stu-id="f562a-188">This may vary from measurements taken after you launch the app a few times over in a small duration of time.</span></span> <span data-ttu-id="f562a-189">Это называется горячим запуском.</span><span class="sxs-lookup"><span data-stu-id="f562a-189">This is called warm startup.</span></span> <span data-ttu-id="f562a-190">В зависимости от количества ресурсов, создаваемых приложением при запуске, между двумя значениями времени запуска может быть большая разница.</span><span class="sxs-lookup"><span data-stu-id="f562a-190">Depending upon how many resources an app creates at launch, there can be a big difference between the two startup times.</span></span> <span data-ttu-id="f562a-191">В зависимости от целей приложения измерение одного или другого может быть желательным.</span><span class="sxs-lookup"><span data-stu-id="f562a-191">Depending upon app goals, measuring one or the other might be desirable.</span></span>
-   <span data-ttu-id="f562a-192">При регистрации сведений о производительности завершите работу приложения, как только первый кадр появится на экране.</span><span class="sxs-lookup"><span data-stu-id="f562a-192">When you log performance information, terminate the app as soon as the first frame shows up on the screen.</span></span>

### <a name="calculating-start-up-time-using-gpuview"></a><span data-ttu-id="f562a-193">Вычисление времени запуска с помощью **GPUView**</span><span class="sxs-lookup"><span data-stu-id="f562a-193">Calculating start-up time using **GPUView**</span></span>

1.  <span data-ttu-id="f562a-194">В **GPUView** прокрутите вниз до соответствующего процесса, в данном случае GeometryRealization.exe.</span><span class="sxs-lookup"><span data-stu-id="f562a-194">In **GPUView**, scroll down to the relevant process, in this case GeometryRealization.exe.</span></span>

    ![Снимок экрана, на котором показан пример процессов в GPUView.](images/profile1.png)

2.  <span data-ttu-id="f562a-196">Контекстная очередь ЦП представляет рабочую нагрузку графики, поставленную в очередь на оборудование, но не обязательно обрабатывалась оборудованием.</span><span class="sxs-lookup"><span data-stu-id="f562a-196">The context CPU queue represents the graphics workload queued to the hardware, but not necessarily being processed by the hardware.</span></span> <span data-ttu-id="f562a-197">При открытии файла трассировки отображаются все события, зарегистрированные между моментом, когда была сделана трассировка.</span><span class="sxs-lookup"><span data-stu-id="f562a-197">When the trace file is opened, it shows all the events logged between the time the trace was taken.</span></span> <span data-ttu-id="f562a-198">Чтобы вычислить время запуска, выберите нужный регион и перейдите к начальной части очереди ЦП первого контекста (это то, что показывает действие), нажав клавиши CTRL + Z.</span><span class="sxs-lookup"><span data-stu-id="f562a-198">In order to calculate the startup-time, select the region of interest, zoom into the initial portion of the first Context CPU Queue (this is the one that shows activity) using Ctrl +Z.</span></span> <span data-ttu-id="f562a-199">Дополнительные сведения об элементах управления **GPUView** можно найти в разделе "Сводка по элементам управления **GPUView** " в файле справки **GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-199">More information about **GPUView** Controls can be found in the **GPUView** Help file section "Summary of **GPUView** Controls".</span></span> <span data-ttu-id="f562a-200">На рисунке ниже показан только GeometryRealization.exe процесс, уменьшенный до первой части очереди ЦП контекста.</span><span class="sxs-lookup"><span data-stu-id="f562a-200">The figure below only shows the GeometryRealization.exe process zoomed in to the first part of the Context CPU Queue.</span></span> <span data-ttu-id="f562a-201">Цвет очереди ЦП контекста обозначается прямоугольником, расположенным непосредственно под очередью, и теми же пакетами данных в очереди отображать GPU, работающие в очереди на оборудование.</span><span class="sxs-lookup"><span data-stu-id="f562a-201">The color of the Context CPU Queue is denoted by the rectangle right below the queue and same color data packets in the queue show GPU work queued up on the hardware.</span></span> <span data-ttu-id="f562a-202">Пакет шаблона штриховки в очереди контекста показывает текущий пакет, что означает, что приложение хочет, чтобы оборудование представлю содержимое на экране.</span><span class="sxs-lookup"><span data-stu-id="f562a-202">The hatch pattern packet in the context queue shows the present packet which means that the app wants the hardware to present the content on the screen.</span></span>

    ![Снимок экрана, на котором показаны примеры контекста C P U Queue.](images/profile2.png)

3.  <span data-ttu-id="f562a-204">Время запуска — это время первого запуска приложения (в этом случае модуль точки входа потока пользовательского интерфейса SHCORE.dll) до момента первого отображения контекста (отмеченного пакетом штриховки).</span><span class="sxs-lookup"><span data-stu-id="f562a-204">The startup-time is the time when the app first starts (in this case UI thread entry point module SHCORE.dll) till the time the context first appears (marked by a hatch packet).</span></span> <span data-ttu-id="f562a-205">На рисунке здесь выделяется Интересующая область.</span><span class="sxs-lookup"><span data-stu-id="f562a-205">The figure here highlights the area of interest.</span></span>

    > [!Note]  
    > <span data-ttu-id="f562a-206">Фактические сведения представлены в очереди перелистывания, поэтому время выполнения увеличивается до тех пор, пока текущий пакет фактически завершается в очереди перелистывания.</span><span class="sxs-lookup"><span data-stu-id="f562a-206">The actual present info is represented in the flip queue and thus the time take is extended till the present packet actually completes in the flip queue.</span></span>

     

    <span data-ttu-id="f562a-207">Полная строка состояния не отображается на рисунке ниже, где также показано время, прошедшее между выделенными частями.</span><span class="sxs-lookup"><span data-stu-id="f562a-207">The complete status bar is not visible in the figure below which also shows the elapsed time between the highlighted portions.</span></span> <span data-ttu-id="f562a-208">Это время запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="f562a-208">This is the startup-time of the app.</span></span> <span data-ttu-id="f562a-209">В этом случае для компьютера, упомянутого выше, 240ms.</span><span class="sxs-lookup"><span data-stu-id="f562a-209">In this case for the machine mentioned above, it came out to be around 240ms.</span></span>

    ![Снимок экрана, на котором показаны области, касающиеся времени запуска, в "контексте C P U Queue".](images/profile3.png)

### <a name="cpu-and-gpu-time-per-frame"></a><span data-ttu-id="f562a-211">Время ЦП и GPU на кадр</span><span class="sxs-lookup"><span data-stu-id="f562a-211">CPU and GPU Time per frame</span></span>

<span data-ttu-id="f562a-212">При измерении времени ЦП необходимо учесть несколько моментов.</span><span class="sxs-lookup"><span data-stu-id="f562a-212">There are a few things to think about when measuring CPU time.</span></span> <span data-ttu-id="f562a-213">Найдите области в трассировке, в которых был охвачен сценарий для анализа.</span><span class="sxs-lookup"><span data-stu-id="f562a-213">Look for the areas in the trace where you have exercised the scenario to be analyzed.</span></span> <span data-ttu-id="f562a-214">Например, в примере реализации Geometry один из сценариев, которые были проанализированы, — это переход между примитивами отрисовки 2048 и 8192, все нереально (как в, геометрия не размещается на каждом кадре).</span><span class="sxs-lookup"><span data-stu-id="f562a-214">For instance, in the geometry realization sample one of the scenarios that has been analyzed is the transition between rendering 2048 and 8192 primitives, all unrealized (as in, geometry is not tessellated every frame).</span></span> <span data-ttu-id="f562a-215">Трассировка четко показывает разницу в действиях ЦП и GPU до и после перехода в количестве примитивов.</span><span class="sxs-lookup"><span data-stu-id="f562a-215">The trace clearly shows difference in CPU and GPU activity before and after the transition in the number of primitives.</span></span>

<span data-ttu-id="f562a-216">Два сценария анализируются для вычисления времени ЦП и GPU на кадр.</span><span class="sxs-lookup"><span data-stu-id="f562a-216">Two scenarios are being analyzed to calculate CPU and GPU time per frame.</span></span> <span data-ttu-id="f562a-217">Они приведены ниже.</span><span class="sxs-lookup"><span data-stu-id="f562a-217">They are as follows.</span></span>

-   <span data-ttu-id="f562a-218">Переход от подготовки к просмотру 2048 нереализованные примитивы до 8192 нереализованных примитивов.</span><span class="sxs-lookup"><span data-stu-id="f562a-218">Transitioning from rendering 2048 unrealized primitives to 8192 unrealized primitives.</span></span>
-   <span data-ttu-id="f562a-219">Переход от подготовки к просмотру 8192 реализованные примитивы до 8192 нереализованных примитивов.</span><span class="sxs-lookup"><span data-stu-id="f562a-219">Transitioning from rendering 8192 realized primitives to 8192 unrealized primitives.</span></span>

<span data-ttu-id="f562a-220">В обоих случаях было замечено, что частота кадров была удалена радикально.</span><span class="sxs-lookup"><span data-stu-id="f562a-220">In both the cases, it was observed that the frame rate dropped drastically.</span></span> <span data-ttu-id="f562a-221">Измеряя время ЦП и GPU, связь между ними и несколькими другими шаблонами в трассировке может дать полезную информацию о проблемных областях в приложении.</span><span class="sxs-lookup"><span data-stu-id="f562a-221">Measuring CPU and GPU time, the relationship between the two as well as a few other patterns in the trace can give useful info about problematic areas in the app.</span></span>

### <a name="calculating-cpu-and-gpu-time-when-2048-primitives-are-being-rendered-unrealized"></a><span data-ttu-id="f562a-222">Вычисление времени ЦП и GPU, когда выводятся нереалны примитивы 2048</span><span class="sxs-lookup"><span data-stu-id="f562a-222">Calculating CPU and GPU time when 2048 primitives are being rendered unrealized</span></span>

1.  <span data-ttu-id="f562a-223">Откройте файл трассировки с помощью **GPUView.exe**.</span><span class="sxs-lookup"><span data-stu-id="f562a-223">Open the trace file using **GPUView.exe**.</span></span>
2.  <span data-ttu-id="f562a-224">Прокрутите вниз до GeometryRealization.exe процесса.</span><span class="sxs-lookup"><span data-stu-id="f562a-224">Scroll down to the GeometryRealization.exe process.</span></span>
3.  <span data-ttu-id="f562a-225">Выберите область для вычисления времени ЦП и задайте для него масштаб с помощью клавиш CTRL + Z.</span><span class="sxs-lookup"><span data-stu-id="f562a-225">Select an area for calculating CPU time and zoom into it using CTRL + Z.</span></span>

    ![Снимок экрана, на котором показана область, выбранная для вычисления времени в C P в "контекстная очередь ЦП".](images/profile4.png)

4.  <span data-ttu-id="f562a-227">Отображение данных v-Sync путем переключения между F8.</span><span class="sxs-lookup"><span data-stu-id="f562a-227">Show v-sync information by toggling between F8.</span></span> <span data-ttu-id="f562a-228">При уменьшении масштаба можно легко увидеть один вертикальной синхронизации данных.</span><span class="sxs-lookup"><span data-stu-id="f562a-228">Keeping zooming in till it is easy to see one vsync worth of data clearly.</span></span> <span data-ttu-id="f562a-229">Синие линии — это время синхронизации v-Sync.</span><span class="sxs-lookup"><span data-stu-id="f562a-229">The blue lines are where the v-sync times.</span></span> <span data-ttu-id="f562a-230">Как правило, они происходят каждые 16 мс (60 кадров/с), но если DWM сталкивается с проблемой с производительностью, она выполняется медленнее, поэтому она будет выполняться каждые 32 мс (30 кадров/с).</span><span class="sxs-lookup"><span data-stu-id="f562a-230">Usually, these occur once every 16 ms (60 fps), but if DWM is encountering a performance problem, it runs slower so they will occur once every 32 ms (30 fps).</span></span> <span data-ttu-id="f562a-231">Чтобы получить представление о времени, выберите одну из синих полосок, а затем посмотрите на число МС в правом нижнем углу окна **GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-231">To get a sense of time, select from one blue bar to the next and then look at the number of ms reported in the lower right hand corner of the **GPUView** window.</span></span>

    ![Снимок экрана, на котором показан пример времени v-Sync.](images/profile5.png)

5.  <span data-ttu-id="f562a-233">Для измерения времени ЦП на кадр измеряет продолжительность времени, занимаемого всеми потоками, участвующими в подготовке к просмотру.</span><span class="sxs-lookup"><span data-stu-id="f562a-233">To measure the CPU time per frame, measure the length of time taken by all the threads involved in rendering.</span></span> <span data-ttu-id="f562a-234">Может быть целесообразно уменьшить ожидаемый поток, который будет наиболее важен с точки зрения производительности.</span><span class="sxs-lookup"><span data-stu-id="f562a-234">It might be worthwhile to narrow down the thread that is expected to be most relevant from a performance standpoint.</span></span> <span data-ttu-id="f562a-235">Например, в примере реализации геометрии содержимое является анимацией и должно отображаться на экране каждый кадр, который делает поток пользовательского интерфейса важным.</span><span class="sxs-lookup"><span data-stu-id="f562a-235">For instance in the geometry realization sample, the content is animating and needs to be rendered on the screen every frame making the UI thread the important one.</span></span> <span data-ttu-id="f562a-236">Определив, какой поток следует искать, Измерьте длину столбцов в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="f562a-236">Once you determine which thread to look at, measure the length of the bars on this thread.</span></span> <span data-ttu-id="f562a-237">Усреднение некоторых из них дает время ЦП на кадр.</span><span class="sxs-lookup"><span data-stu-id="f562a-237">Averaging a few of these yields CPU time per frame.</span></span> <span data-ttu-id="f562a-238">На рисунке ниже показано время, затраченное на поток пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="f562a-238">The figure below shows time taken up on the UI thread.</span></span> <span data-ttu-id="f562a-239">Также показывается, что это время подходит для двух последовательных виртуальных синхронизаций, что означает достижение 60FPS.</span><span class="sxs-lookup"><span data-stu-id="f562a-239">It also shows that this time fits well between two consecutive v-syncs which mean that it is hitting 60FPS.</span></span>

    ![Снимок экрана, показывающий время, затраченное на поток U I.](images/profile6.png)

    <span data-ttu-id="f562a-241">Можно также проверить, просмотрев очередь перелистывания для соответствующего кадра времени, который показывает, что DWM может представлять каждый кадр.</span><span class="sxs-lookup"><span data-stu-id="f562a-241">You can also verify by looking at the flip queue for the corresponding time frame which shows that DWM is able to present every frame.</span></span>

    ![Снимок экрана, на котором показан пример "очереди перелистывания".](images/profile7.png)

6.  <span data-ttu-id="f562a-243">Время GPU можно измерять так же, как и время ЦП.</span><span class="sxs-lookup"><span data-stu-id="f562a-243">The GPU time can be measured in the same way as the CPU time.</span></span> <span data-ttu-id="f562a-244">При измерении времени ЦП увеличивайте масштаб соответствующей области.</span><span class="sxs-lookup"><span data-stu-id="f562a-244">Zoom into the relevant area as in the case of measuring CPU time.</span></span> <span data-ttu-id="f562a-245">Измеряет длину столбцов в очереди оборудования GPU с тем же цветом, что и цвет очереди ЦП контекста.</span><span class="sxs-lookup"><span data-stu-id="f562a-245">Measure the length of the bars in the GPU hardware Queue with the same color as the color of the Context CPU Queue.</span></span> <span data-ttu-id="f562a-246">Если столбцы соответствуют последовательным v-синхронизациям, приложение работает плавно на 60FPS.</span><span class="sxs-lookup"><span data-stu-id="f562a-246">As long as the bars fit within consecutive v-syncs, the app is running smoothly at 60FPS.</span></span>

    ![Снимок экрана, на котором показан пример использования "очереди оборудования GPU" для отображения информации, выполняемой приложением в 60 F P S.](images/profile8.png)

### <a name="calculating-cpu-and-gpu-time-when-8192-primitives-are-being-rendered-unrealized"></a><span data-ttu-id="f562a-248">Вычисление времени ЦП и GPU, когда выводятся нереалны примитивы 8192</span><span class="sxs-lookup"><span data-stu-id="f562a-248">Calculating CPU and GPU time when 8192 primitives are being rendered unrealized</span></span>

1.  <span data-ttu-id="f562a-249">Если выполнить те же действия снова, трассировка показывает, что вся работа ЦП для одного кадра не помещается между одной и той же v-Sync и следующей.</span><span class="sxs-lookup"><span data-stu-id="f562a-249">If you follow the same steps again, the trace shows that all the CPU work for one frame does not fit between one v-sync and the next.</span></span> <span data-ttu-id="f562a-250">Это означает, что приложение привязано к ЦП.</span><span class="sxs-lookup"><span data-stu-id="f562a-250">This means that the app is CPU bound.</span></span> <span data-ttu-id="f562a-251">Поток пользовательского интерфейса является перегруженным ПРОЦЕССОРом.</span><span class="sxs-lookup"><span data-stu-id="f562a-251">The UI thread is saturating the CPU.</span></span>

    ![Снимок экрана, на котором показан пример потока пользовательского интерфейса с насыщенностью в C P U.](images/profile9.png)

    <span data-ttu-id="f562a-253">Просматривая очередь перелистывания, также ясно, что DWM не может представлять каждый кадр.</span><span class="sxs-lookup"><span data-stu-id="f562a-253">Looking at the flip queue, it is also clear that DWM is not able to present every frame.</span></span>

    ![Снимок экрана, на котором показан пример D W M, который не может представлять каждый кадр.](images/profile10.png)

2.  <span data-ttu-id="f562a-255">Чтобы проанализировать, где затратится время, откройте трассировку в **Xperf**.</span><span class="sxs-lookup"><span data-stu-id="f562a-255">In order to analyze where the time is getting spent, open the trace in **XPerf**.</span></span> <span data-ttu-id="f562a-256">Чтобы проанализировать время запуска в **Xperf**, сначала найдите интервал времени в **GPUView**.</span><span class="sxs-lookup"><span data-stu-id="f562a-256">To analyze startup time in **XPerf**, first find the time interval in **GPUView**.</span></span> <span data-ttu-id="f562a-257">Наведите указатель мыши на левую часть интервала и вправо и запишите абсолютное время, показанное в нижней части окна **GPUView** .</span><span class="sxs-lookup"><span data-stu-id="f562a-257">Mouse over the left of the interval and the right and take note of the absolute time shown in the bottom of the **GPUView** window.</span></span> <span data-ttu-id="f562a-258">Затем откройте один и тот же ETL-файл в **Xperf** и прокрутите вниз до диаграммы "Выбор ЦП по ЦП", щелкните правой кнопкой мыши и выберите команду "выбрать интервал...". Это позволяет ввести интересующий вас интервал, который был обнаружен при просмотре трассировки GPU.</span><span class="sxs-lookup"><span data-stu-id="f562a-258">Then open the same .etl file in **XPerf** and, scroll down to the "CPU Sampling by CPU" graph, right click and select "Select Interval…" This allows for typing in the interval of interest which was discovered by looking at the GPU trace.</span></span>

    ![Снимок экрана, на котором показана "C P U выборка" в C P U "в" анализе производительности Windows ".](images/profile11.png)

3.  <span data-ttu-id="f562a-260">Перейдите в меню трассировка и убедитесь, что установлен флажок "загрузить символы".</span><span class="sxs-lookup"><span data-stu-id="f562a-260">Go to the Trace menu, and make sure "Load Symbols" is checked.</span></span> <span data-ttu-id="f562a-261">Кроме того, перейдите в раздел трассировка — > настройте пути к символам и введите путь к символам приложения.</span><span class="sxs-lookup"><span data-stu-id="f562a-261">Also, go to Trace -> Configure Symbol Paths, and type in the app symbol path.</span></span> <span data-ttu-id="f562a-262">Файл символов содержит отладочную информацию о скомпилированном исполняемом файле в отдельной базе данных (. pdb).</span><span class="sxs-lookup"><span data-stu-id="f562a-262">A symbol file contains debugging information about a compiled executable in a separate database (.pdb).</span></span> <span data-ttu-id="f562a-263">Этот файл обычно называют PDB-файлом.</span><span class="sxs-lookup"><span data-stu-id="f562a-263">This file is commonly referred to as a PDB.</span></span> <span data-ttu-id="f562a-264">Дополнительные сведения о файлах символов можно найти здесь: [файлы символов](/windows/desktop/Debug/symbol-files).</span><span class="sxs-lookup"><span data-stu-id="f562a-264">More on symbol files can be found here: [Symbol Files](/windows/desktop/Debug/symbol-files).</span></span> <span data-ttu-id="f562a-265">Этот файл можно найти в папке "Отладка" каталога приложения.</span><span class="sxs-lookup"><span data-stu-id="f562a-265">This file can be located in the "Debug" folder of the app directory.</span></span>

4.  <span data-ttu-id="f562a-266">Чтобы получить сведения о том, где в приложении будет затрачено время, щелкните правой кнопкой мыши интервал, выбранный на предыдущем шаге, и выберите Сводная таблица.</span><span class="sxs-lookup"><span data-stu-id="f562a-266">In order to get the breakdown of where the time is being spent in the app, right click on the interval selected in the previous step and click Summary Table.</span></span> <span data-ttu-id="f562a-267">Чтобы получить общие сведения о том, сколько времени тратится на каждую библиотеку DLL, снимите флажок "стек" в меню "столбцы".</span><span class="sxs-lookup"><span data-stu-id="f562a-267">To get an overview of how much time is spent in each dll, uncheck "Stack" from the "Columns" menu.</span></span> <span data-ttu-id="f562a-268">Обратите внимание, что в столбце "число" показано количество выборок в данной библиотеке DLL или функции.</span><span class="sxs-lookup"><span data-stu-id="f562a-268">Note that the "Count" column here shows how many samples are within the given dll/function.</span></span> <span data-ttu-id="f562a-269">Так как на каждую МС берется примерно один пример, этот номер можно использовать в качестве лучшего предположения о том, сколько времени тратится на каждую библиотеку DLL или функцию.</span><span class="sxs-lookup"><span data-stu-id="f562a-269">Because approximately one sample is taken per ms, this number can be used as a best guess for how much time is spent in each dll/function.</span></span> <span data-ttu-id="f562a-270">При проверке меню "стек" из столбцов будет выдаваться инклюзивное время, затраченное на каждую функцию в графе вызовов.</span><span class="sxs-lookup"><span data-stu-id="f562a-270">Checking the "Stack" from Columns menu will give the inclusive time spent in each function in the call graph.</span></span> <span data-ttu-id="f562a-271">Это поможет далее разорвать проблемные точки.</span><span class="sxs-lookup"><span data-stu-id="f562a-271">This will help to break down the problem points further.</span></span>

5.  <span data-ttu-id="f562a-272">Информация трассировки стека для 2048 нереализованных примитивов показывает, что 30% времени ЦП затрачены на процесс реализации геометрии.</span><span class="sxs-lookup"><span data-stu-id="f562a-272">Stack trace information for 2048 unrealized primitives reveals that 30% of CPU time is spent in geometry realization process.</span></span> <span data-ttu-id="f562a-273">Из этого около 36% времени тратится на тесселяцию геометрии и обводки.</span><span class="sxs-lookup"><span data-stu-id="f562a-273">Of that around 36% of the time is being spent in geometry tessellation and stroking.</span></span>

6.  <span data-ttu-id="f562a-274">Информация трассировки стека для 8192 нереализованных примитивов показывает, что около 60% времени ЦП (4 ядра) тратится на реализацию геометрии.</span><span class="sxs-lookup"><span data-stu-id="f562a-274">Stack trace information for 8192 unrealized primitives reveals that around 60% of the CPU time (4 cores) is spent in the geometry realization.</span></span>

    ![Снимок экрана, показывающий сведения о трассировке стека для времени в C P U.](images/profile12.png)

### <a name="calculating-cpu-time-when-8192-primitives-are-being-rendered-realized"></a><span data-ttu-id="f562a-276">Вычисление времени ЦП при отрисовке примитивов 8192</span><span class="sxs-lookup"><span data-stu-id="f562a-276">Calculating CPU time when 8192 primitives are being rendered realized</span></span>

<span data-ttu-id="f562a-277">Это ясно из профилей, с которыми приложение привязано к ЦП.</span><span class="sxs-lookup"><span data-stu-id="f562a-277">It is clear from the profiles that the app is CPU bound.</span></span> <span data-ttu-id="f562a-278">Чтобы сократить время, затрачиваемое ЦП, геометрические объекты можно создать один раз и кэшировать.</span><span class="sxs-lookup"><span data-stu-id="f562a-278">In order to reduce the time spent by the CPU, geometries can be created once and cached.</span></span> <span data-ttu-id="f562a-279">Кэшированное содержимое может подготавливаться к просмотру в каждом кадре без затрат на тесселяцию геометрии для каждого кадра.</span><span class="sxs-lookup"><span data-stu-id="f562a-279">The cached content can be rendered every frame without incurring the geometry tessellation cost per frame.</span></span> <span data-ttu-id="f562a-280">При просмотре трассировки в **GPUView** для реализованной части приложения ясно, что DWM может представлять каждый кадр, а время ЦП значительно уменьшилось.</span><span class="sxs-lookup"><span data-stu-id="f562a-280">When looking at the trace in **GPUView** for the realized part of the app, it is clear that DWM is able to present every frame and the CPU time has reduced drastically.</span></span>

![Снимок экрана, на котором показан пример трассировки в GPUView, где D W M может представлять каждый кадр.](images/profile13.png)

<span data-ttu-id="f562a-282">В первой части диаграммы показаны реализованные примитивы 8192.</span><span class="sxs-lookup"><span data-stu-id="f562a-282">The first part of the graph shows realized 8192 primitives.</span></span> <span data-ttu-id="f562a-283">Соответствующее время ЦП на кадр может соответствовать двум последовательным v-синхронизациям.</span><span class="sxs-lookup"><span data-stu-id="f562a-283">The corresponding CPU time per frame is able to fit within two consecutive v-syncs.</span></span> <span data-ttu-id="f562a-284">В более поздней части графа это не так.</span><span class="sxs-lookup"><span data-stu-id="f562a-284">In the later part of the graph this is not true.</span></span>

<span data-ttu-id="f562a-285">Глядя на **Xperf**, ЦП находится в неактивном состоянии в течение более чем 25% времени ЦП, затраченного на выполнение приложения по реализации геометрии.</span><span class="sxs-lookup"><span data-stu-id="f562a-285">Looking in **XPerf**, CPU is sitting idle for the longest time with only about 25% of the CPU time being spent on the geometry realization app.</span></span>

![снимок экрана gpuview.](images/profile14.png)

## <a name="summary"></a><span data-ttu-id="f562a-287">Сводка</span><span class="sxs-lookup"><span data-stu-id="f562a-287">Summary</span></span>

<span data-ttu-id="f562a-288">**GPUView** и **Xperf** и мощные средства для анализа производительности приложений [DirectX](/previous-versions/windows/apps/jj262109(v=win.10)) .</span><span class="sxs-lookup"><span data-stu-id="f562a-288">Both **GPUView** and **XPerf** and powerful tools for analyzing performance of [DirectX](/previous-versions/windows/apps/jj262109(v=win.10)) apps.</span></span> <span data-ttu-id="f562a-289">Эта статья представляет собой учебник по использованию этих средств и пониманию базовых показателей производительности и характеристик приложений.</span><span class="sxs-lookup"><span data-stu-id="f562a-289">This article is a primer for using these tools and understanding basic performance measurements and app characteristics.</span></span> <span data-ttu-id="f562a-290">Помимо понимания использования инструментов, сначала важно понять анализируемое приложение.</span><span class="sxs-lookup"><span data-stu-id="f562a-290">Apart from understanding usage of tools, it is first important to understand the app being analyzed.</span></span> <span data-ttu-id="f562a-291">Начните с поиска ответов на такие вопросы, как приложение, которое пытается достичь?</span><span class="sxs-lookup"><span data-stu-id="f562a-291">Start with finding answers to questions like what is the app trying to achieve?</span></span> <span data-ttu-id="f562a-292">Какие потоки в системе наиболее важны?</span><span class="sxs-lookup"><span data-stu-id="f562a-292">Which threads in the system are most important?</span></span> <span data-ttu-id="f562a-293">Какие компромиссы вы желаете сделать?</span><span class="sxs-lookup"><span data-stu-id="f562a-293">What trade-offs are you willing to make?</span></span> <span data-ttu-id="f562a-294">При анализе трассировок производительности Начните с рассмотрения очевидных проблемных мест.</span><span class="sxs-lookup"><span data-stu-id="f562a-294">When analyzing performance traces, start by looking at obvious problematic places.</span></span> <span data-ttu-id="f562a-295">Привязан ли процессор приложения или GPU?</span><span class="sxs-lookup"><span data-stu-id="f562a-295">Is the app CPU or GPU bound?</span></span> <span data-ttu-id="f562a-296">Может ли приложение представлять каждый кадр?</span><span class="sxs-lookup"><span data-stu-id="f562a-296">Is the app able to present every frame?</span></span> <span data-ttu-id="f562a-297">Средства вместе с пониманием приложения могут предоставить очень полезную информацию в понимании, поиске и устранении проблем с производительностью.</span><span class="sxs-lookup"><span data-stu-id="f562a-297">Tools together with an understanding of the app can give very useful information in understanding, finding and finally solving performance problems.</span></span>

 

 