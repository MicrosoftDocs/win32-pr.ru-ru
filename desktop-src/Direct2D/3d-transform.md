---
title: Эффект трехмерного преобразования
description: Используйте эффект трехмерного преобразования, чтобы применить произвольную матрицу преобразования 4x4 к изображению.
ms.assetid: BC2F2837-40F0-4293-A190-8B5F81BB01B6
keywords:
- трехмерное преобразование, эффект
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fabe0c2c220038802b5218b54187a1ff89268bfa
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "104559171"
---
# <a name="3d-transform-effect"></a>Эффект трехмерного преобразования

Используйте эффект трехмерного преобразования, чтобы применить произвольную матрицу преобразования 4x4 к изображению.

Этот результат применяет матрицу (M?), которую вы предоставляете для угловых вершин исходного изображения ( \[ x y z 1 \] ), используя это вычисление:

\[x<sub>r</sub> y<sub>r</sub> z<sub>r</sub> 1 \] = \[ x y z 1 \] \* M?

Идентификатором CLSID для этого действия является CLSID \_ D2D13DTransform.

-   [Пример изображения](#example-image)
-   [Свойства эффектов](#effect-properties)
    -   [Режимы интерполяции](#interpolation-modes)
    -   [Режимы границ](#border-modes)
-   [Класс Matrix преобразования 4x4](#4x4-transform-matrix-class)
-   [Требования](#requirements)
-   [См. также](#related-topics)

## <a name="example-image"></a>Пример изображения



| До                                                        |
|---------------------------------------------------------------|
| ![изображение перед преобразованием.](images/default-before.jpg) |
| После                                                         |
| ![изображение после преобразования.](images/24-3dtransform.png)  |



 


```C++
ComPtr<ID2D1Effect> D2D13DTransformEffect;
m_d2dContext->CreateEffect(CLSID_D2D13DTransform, &D2D13DTransformEffect);

D2D13DTransformEffect->SetInput(0, bitmap);

// You can use the helper methods in D2D1::Matrix4x4F to create common matrix transformations.
D2D1_MATRIX_4X4_F matrix = 
    D2D1::Matrix4x4F::Translation(0.0f, -192.0f, 0.0f) *
    D2D1::Matrix4x4F::RotationY(30.0f) *
    D2D1::Matrix4x4F::Translation(0.0f, 192.0f, 0.0f);

D2D13DTransformEffect->SetValue(D2D1_3DTRANSFORM_PROP_TRANSFORM_MATRIX, matrix);

m_d2dContext->BeginDraw();
m_d2dContext->DrawImage(D2D13DTransformEffect.Get());
m_d2dContext->EndDraw();
```



## <a name="effect-properties"></a>Свойства эффектов



<table>
<thead>
<tr class="header">
<th>Отображаемое имя и перечисление индекса</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>интерполатионмоде<br/> D2D1_3DTRANSFORM_PROP_INTERPOLATION_MODE<br/></td>
<td>Режим интерполяции, используемый в изображении в результате применения. Существует 5 режимов масштабирования, имеющих высокое качество и скорость.<br/> Тип — D2D1_3DTRANSFORM_INTERPOLATION_MODE.<br/> Значение по умолчанию — D2D1_3DTRANSFORM_INTERPOLATION_MODE_LINEAR.<br/></td>
</tr>
<tr class="even">
<td>бордермоде<br/> D2D1_3DTRANSFORM_PROP_BORDER_MODE<br/></td>
<td>Режим, используемый для вычисления границы изображения: Soft или Hard. Дополнительные сведения см. в разделе <a href="https://www.bing.com/search?q=Border+modes">режимы границ</a> .<br/> Тип — D2D1_BORDER_MODE.<br/> Значение по умолчанию — D2D1_BORDER_MODE_SOFT.<br/></td>
</tr>
<tr class="odd">
<td>трансформматрикс<br/> D2D1_3DTRANSFORM_PROP_TRANSFORM_MATRIX<br/></td>
<td>Матрица преобразования 4x4, применяемая к плоскости проекции. Приведенное ниже вычисление матрицы используется для отображения точек из одной трехмерной системы координат в преобразованную двухмерную систему координат. <br/><img src="images/3d-transform-matrix1.png" alt="3D Depth Matrix" />Где:<dl> Координаты X, Y, Z = входная плоскость проекции<br />
Элементы матрицы M<sub>x, y</sub> = Transform<br />
X, Y, Z = выходные координаты плоскости проекции<br />
</dl> <br/> Отдельные элементы матрицы не привязаны и не имеют модулей. <br/> Тип — D2D1_MATRIX_4X4_F.<br/> Значение по умолчанию — Matrix4x4F (1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1).<br/></td>
</tr>
</tbody>
</table>



 

### <a name="interpolation-modes"></a>Режимы интерполяции



| Перечисление                                                   | Описание                                                                                                                                                |
|---------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_ \_ \_ \_ Ближайший сосед в режиме интерполяции D2D1 3DTRANSFORM \_     | Выбирает ближайшую одиночную точку и использует ее. В этом режиме используется меньше времени на обработку, но выводится изображение самого низкого качества.                                 |
| \_ \_ Линейный режим интерполяции D2D1 3DTRANSFORM \_ \_                | Использует выборку с четырьмя точками и линейную интерполяцию. Этот режим использует больше времени на обработку, чем ближайший соседний режим, но выводит изображение более высокого качества. |
| D2D1 \_ 3DTRANSFORM \_ Режим интерполяции ( \_ \_ кубический)                 | Использует 16-примерный ядро кубических для интерполяции. Этот режим использует наибольшее время обработки, но выводит изображение с более высоким качеством.                              |
| D2D1 \_ 3DTRANSFORM \_ Режим интерполяции — \_ \_ \_ многопримерная \_ линейная | Использует 4 линейных образца в пределах одного пикселя для удобного сглаживания. Этот режим хорошо подходит для уменьшения масштаба по небольшим объемам на изображениях с небольшими пикселями.    |
| D2D1 \_ 3DTRANSFORM \_ Режим интерполяции — \_ \_ анизотропная           | Использует анизотропную фильтрацию для выборки шаблона в соответствии с преобразованной формой точечного рисунка.                                                           |



 

> [!Note]  
> Если не выбрать режим, то по умолчанию будет применяться \_ \_ линейный режим интерполяции D2D1 3DTRANSFORM \_ \_ .

 

> [!Note]  
> В режиме анизотропного масштабирования создается MIP-карты при масштабировании, однако если для свойства **кэширования** задано значение true для эффектов, вводимых в результате этого эффекта, MIP-карты не будет создаваться каждый раз для достаточного размера изображений.

 

### <a name="border-modes"></a>Режимы границ



| Имя                     | Описание                                                                                                      |
|--------------------------|------------------------------------------------------------------------------------------------------------------|
| \_ \_ Мягкий режим границы \_ D2D1 | При интерполяции изображение получает прозрачные черные пиксели, что приводит к мягкому пограничным границе.<br/> |
| Жесткое D2D1 в \_ \_ режиме границы \_ | В результате выходные данные заменяются на размер входного изображения. <br/>                                         |



 

## <a name="4x4-transform-matrix-class"></a>Класс Matrix преобразования 4x4

Direct2D предоставляет класс матрицы 4x4 для предоставления вспомогательных функций для преобразования изображения в 3 измерения. Дополнительные сведения и описание всех членов класса см. в разделе [**Matrix4x4F**](/windows/desktop/api/d2d1_1helper/nl-d2d1_1helper-matrix4x4f) .



| Функция                                | Описание                                                                                    | Матрица                                                 |
|-----------------------------------------|------------------------------------------------------------------------------------------------|--------------------------------------------------------|
| Matrix4x4F:: Scale (X, Y, Z)              | Формирует матрицу преобразования, которая масштабирует плоскость проекции в направлении X, Y и (или) Z. | ![Матрица scale3d](images/3d-transform-matrix2.png)     |
| Скевкс (X)                                | Формирует матрицу преобразования, которая наклоняет плоскость проекции по оси X.               | ![Показывает матрицу смещения в направлении по оси X.](images/matrix4x4-skewx.png)             |
| Отклонение (Y)                                | Формирует матрицу преобразования, которая наклоняет плоскость проекции в направлении Y.               | ![Матрица отклонений](images/matrix4x4-skewy.png)             |
| Преобразование (X, Y, Z)                    | Формирует матрицу преобразования, преобразующую плоскость проекции в направлении X, Y или Z. | ![Преобразование матрицы](images/3d-transform-matrix4.png)   |
| Ротатионкс (X)                            | Формирует матрицу преобразования, которая поворачивает плоскость проекции по оси X.               | ![повернуть x матрицу](images/3d-transform-matrix5.png)    |
| Вращение (Y)                            | Формирует матрицу преобразования, которая поворачивает плоскость проекции по оси Y.               | ![повернуть матрицу y](images/3d-transform-matrix6.png)    |
| Ротатионз (Z)                            | Формирует матрицу преобразования, которая поворачивает плоскость проекции по оси Z.               | ![повернуть матрицу z](images/3d-transform-matrix7.png)    |
| Перспективепрожектион (г)                | Преобразование «перспектива» со значением глубины «D».                                          | ![Матрица перспективы](images/3d-transform-matrix8.png) |
| Ротатионарбитраряксис (X, Y, Z, градусы) | Поворачивает плоскость проекции относительно указанной оси.                                       |                                                        |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента | Windows 8 и обновление платформы для \[ классических приложений Windows 7 \| приложения для Магазина Windows\] |
| Минимальная версия сервера | Windows 8 и обновление платформы для \[ классических приложений Windows 7 \| приложения для Магазина Windows\] |
| Header                   | d2d1effects. h                                                                      |
| Библиотека                  | D2D1. lib, дксгуид. lib                                                               |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**ID2D1Effect**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1effect)
</dt> </dl>

 

