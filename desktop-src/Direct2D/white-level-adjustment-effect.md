---
title: Результат отображения белого сигнала
description: Этот результат позволяет линейно масштабировать белый уровень изображения. Это особенно полезно при преобразовании между пространством светимости, на которое ссылаются на сцены, или с пространством светимости, или наоборот.
ms.topic: article
ms.date: 02/01/2019
ms.openlocfilehash: 70a38f37f5a5461b968099bebe4be120a727c053
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103988893"
---
# <a name="white-level-adjustment-effect"></a><span data-ttu-id="8cc99-104">Корректировка белого уровня</span><span class="sxs-lookup"><span data-stu-id="8cc99-104">White level adjustment effect</span></span>

<span data-ttu-id="8cc99-105">Этот результат позволяет линейно масштабировать белый уровень изображения.</span><span class="sxs-lookup"><span data-stu-id="8cc99-105">This effect allows the white level of an image to be linearly scaled.</span></span> <span data-ttu-id="8cc99-106">Это особенно полезно при преобразовании между пространством светимости, на которое ссылаются на сцены, или с пространством светимости, или наоборот.</span><span class="sxs-lookup"><span data-stu-id="8cc99-106">This is especially helpful when you convert between display-referred luminance space and scene-referred luminance space, or vice versa.</span></span>

<span data-ttu-id="8cc99-107">Свойства для этого действия определяются [**перечислением D2D1_WHITELEVELADJUSTMENT_PROP**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop), а идентификатором CLSID является **CLSID_D2D1WhiteLevelAdjustment**.</span><span class="sxs-lookup"><span data-stu-id="8cc99-107">The properties for this effect are identified by the [**D2D1_WHITELEVELADJUSTMENT_PROP enumeration**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop), and the CLSID is **CLSID_D2D1WhiteLevelAdjustment**.</span></span>

## <a name="effect-properties"></a><span data-ttu-id="8cc99-108">Свойства эффектов</span><span class="sxs-lookup"><span data-stu-id="8cc99-108">Effect properties</span></span>

| <span data-ttu-id="8cc99-109">Отображаемое имя и перечисление индекса</span><span class="sxs-lookup"><span data-stu-id="8cc99-109">Display name and index enumeration</span></span> | <span data-ttu-id="8cc99-110">Тип и значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="8cc99-110">Type and default value</span></span> | <span data-ttu-id="8cc99-111">Описание</span><span class="sxs-lookup"><span data-stu-id="8cc99-111">Description</span></span> |
|-|-|-|
| <span data-ttu-id="8cc99-112">Инпутвхителевел, D2D1_WHITELEVELADJUSTMENT_PROP_INPUT_WHITE_LEVEL</span><span class="sxs-lookup"><span data-stu-id="8cc99-112">InputWhiteLevel, D2D1_WHITELEVELADJUSTMENT_PROP_INPUT_WHITE_LEVEL</span></span> | <span data-ttu-id="8cc99-113">FLOAT</span><span class="sxs-lookup"><span data-stu-id="8cc99-113">FLOAT</span></span> | <span data-ttu-id="8cc99-114">Белый уровень входного изображения в НИТС.</span><span class="sxs-lookup"><span data-stu-id="8cc99-114">The white level of the input image, in nits.</span></span> |
| <span data-ttu-id="8cc99-115">Аутпутвхителевел, D2D1_WHITELEVELADJUSTMENT_PROP_OUTPUT_WHITE_LEVEL</span><span class="sxs-lookup"><span data-stu-id="8cc99-115">OutputWhiteLevel, D2D1_WHITELEVELADJUSTMENT_PROP_OUTPUT_WHITE_LEVEL</span></span> | <span data-ttu-id="8cc99-116">FLOAT</span><span class="sxs-lookup"><span data-stu-id="8cc99-116">FLOAT</span></span> | <span data-ttu-id="8cc99-117">Белый уровень выходного изображения в НИТС.</span><span class="sxs-lookup"><span data-stu-id="8cc99-117">The white level of the output image, in nits.</span></span> |

## <a name="remarks"></a><span data-ttu-id="8cc99-118">Комментарии</span><span class="sxs-lookup"><span data-stu-id="8cc99-118">Remarks</span></span>
<span data-ttu-id="8cc99-119">Этот результат предназначен для совмещения с [результатом карты тона HDR](hdr-tone-map-effect.md) , что позволяет визуализировать HDR-изображения в Direct2D с правильным управлением цветом и сопоставлением тонов.</span><span class="sxs-lookup"><span data-stu-id="8cc99-119">This effect is intended to be combined with the [HDR tone map effect](hdr-tone-map-effect.md) to allow you to render HDR images in Direct2D with proper color management and tone mapping.</span></span> <span data-ttu-id="8cc99-120">Дополнительные сведения см. в **комментариях** этого раздела.</span><span class="sxs-lookup"><span data-stu-id="8cc99-120">See that topic's **Remarks** for more details.</span></span> <span data-ttu-id="8cc99-121">Эти эффекты нацелены на любую платформу, которая хочет предоставить лучшее в своем классе представление HDR-изображений, которое обрабатывает все форматы изображений Windows HDR и адаптируется к возможностям отображения (будь то HDR или ВКГ/SDR).</span><span class="sxs-lookup"><span data-stu-id="8cc99-121">The effects are aimed at any framework that wants to provide a best-in-class HDR image viewing experience that handles all of the Windows HDR image formats, and adapts to the capabilities of the display (whether that's HDR or WCG/SDR).</span></span>

<span data-ttu-id="8cc99-122">В Windows все содержимое SDR/ВКГ предполагается в пространстве светимости, которое означает, что белый уровень содержимого должен масштабироваться до белого уровня отображения, прежде чем он будет представлен в конечном итоге.</span><span class="sxs-lookup"><span data-stu-id="8cc99-122">On Windows, all SDR/WCG content is assumed to be in a display-referred luminance space, meaning that the white level of the content should be scaled up to the display's white level before it is ultimately presented.</span></span> <span data-ttu-id="8cc99-123">Однако это не всегда отвечает вашему приложению.</span><span class="sxs-lookup"><span data-stu-id="8cc99-123">However, it's not always your application's responsibility to do this.</span></span> <span data-ttu-id="8cc99-124">В отличие от этого, содержимое HDR предполагается в пространстве светимости, которое, в свою очередь, не должно масштабироваться в соответствии с белым уровнем экрана.</span><span class="sxs-lookup"><span data-stu-id="8cc99-124">In contrast, HDR content is assumed to be in a scene-referred luminance space, meaning that it shouldn't ultimately be scaled to match the display's white level.</span></span> <span data-ttu-id="8cc99-125">Таким образом, приложению может потребоваться выполнить масштабирование в некоторых обстоятельствах при отрисовке HDR-содержимого, чтобы убедиться в том, что это в итоге.</span><span class="sxs-lookup"><span data-stu-id="8cc99-125">That said, your application may need to perform scaling in some circumstances when rendering HDR content to ensure that this is the net result.</span></span>

<span data-ttu-id="8cc99-126">Когда настольная система Windows находится в режиме SDR или ВКГ, Рабочий стол состоит из области светимости, на которой отображаются ссылки.</span><span class="sxs-lookup"><span data-stu-id="8cc99-126">When the Windows desktop is in SDR or WCG mode, the desktop is composed in a display-referred luminance space.</span></span> <span data-ttu-id="8cc99-127">Но если Настольный компьютер Windows находится в режиме HDR, то компоновка рабочего стола происходит в пространстве светимости.</span><span class="sxs-lookup"><span data-stu-id="8cc99-127">But if the Windows desktop is in HDR mode, then desktop composition happens in scene-referred luminance space.</span></span> <span data-ttu-id="8cc99-128">С другой стороны, диспетчер окон рабочего стола (DWM) выполняет корректировки светимости (часто именуемые Сдрбуст) для 8-разрядных поверхностей композиции, что упрощает приложение для этого случая.</span><span class="sxs-lookup"><span data-stu-id="8cc99-128">That said, the Desktop Window Manager (DWM) itself performs luminance adjustments (often called SDRBoost) for 8-bit composition surfaces, and that simplifies your application for that case.</span></span> <span data-ttu-id="8cc99-129">Несмотря на это, автоматическое повышение означает, что роль приложения при преобразовании из одного пространства светимости в другую зависит от формата композиции, используемого приложением для представления его содержимого.</span><span class="sxs-lookup"><span data-stu-id="8cc99-129">Even so, the automatic boost means that your application's role in converting from one luminance space to another is dependent upon the composition format that your application is using to present its content.</span></span>

<span data-ttu-id="8cc99-130">В приведенной ниже таблице описаны случаи, когда приложение должно не выполнять коррекцию белого уровня, а также то, что должно быть скорректировано.</span><span class="sxs-lookup"><span data-stu-id="8cc99-130">The table below describes the cases when your application should and should not perform a white level adjustment, as well as what that adjustment should be.</span></span> <span data-ttu-id="8cc99-131">Как правило, корректировка зависит от трех факторов.</span><span class="sxs-lookup"><span data-stu-id="8cc99-131">In general, the adjustment depends on three factors.</span></span>

1. <span data-ttu-id="8cc99-132">Входное содержимое колорспаце.</span><span class="sxs-lookup"><span data-stu-id="8cc99-132">Input content colorspace.</span></span> <span data-ttu-id="8cc99-133">Содержит ли Ваше входное содержимое значения светимости высокой динамической области (HDR) или нет.</span><span class="sxs-lookup"><span data-stu-id="8cc99-133">Whether your input content contains high dynamic range (HDR) luminance values or not.</span></span> <span data-ttu-id="8cc99-134">Содержимое ВКГ работает так же, как и SDR для поведения светимости.</span><span class="sxs-lookup"><span data-stu-id="8cc99-134">WCG content behaves the same as SDR for luminance behavior.</span></span>
2. <span data-ttu-id="8cc99-135">Формат композиции.</span><span class="sxs-lookup"><span data-stu-id="8cc99-135">Composition format.</span></span> <span data-ttu-id="8cc99-136">Формат пикселей целевой поверхности, представленный в DWM, &mdash; например [цепочка](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) буферов или [область композиции](/uwp/api/Windows.UI.Composition.ICompositionSurface).</span><span class="sxs-lookup"><span data-stu-id="8cc99-136">The pixel format of the target surface that is presented to the DWM&mdash;for example, a [swap chain](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) or a [composition surface](/uwp/api/Windows.UI.Composition.ICompositionSurface).</span></span> <span data-ttu-id="8cc99-137">При подготовке к просмотру с помощью Direct2D это значение **UINT8** или **FP16**.</span><span class="sxs-lookup"><span data-stu-id="8cc99-137">When rendering using Direct2D, this is either **UINT8** or **FP16**.</span></span>
3. <span data-ttu-id="8cc99-138">Расширенный цветовой режим рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="8cc99-138">Desktop advanced color mode.</span></span> <span data-ttu-id="8cc99-139">Выполняется ли DWM в режиме SDR, ВКГ или HDR для текущего экрана.</span><span class="sxs-lookup"><span data-stu-id="8cc99-139">Whether the DWM is running in SDR, WCG, or HDR mode for the current display.</span></span> <span data-ttu-id="8cc99-140">Получите эти сведения с помощью [**DXGI_OUTPUT_DESC1:: колорспаце**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1) или [**адванцедколоринфо. куррентадванцедколоркинд**](/uwp/api/windows.graphics.display.advancedcolorinfo.currentadvancedcolorkind).</span><span class="sxs-lookup"><span data-stu-id="8cc99-140">Obtain this information via [**DXGI_OUTPUT_DESC1::ColorSpace**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1) or [**AdvancedColorInfo.CurrentAdvancedColorKind**](/uwp/api/windows.graphics.display.advancedcolorinfo.currentadvancedcolorkind).</span></span>

<span data-ttu-id="8cc99-141">На основе этих трех факторов необходимо задать соответствующие значения для `InputWhiteLevel` `OutputWhiteLevel` свойств и.</span><span class="sxs-lookup"><span data-stu-id="8cc99-141">Based on these three factors, you should set the appropriate values for the `InputWhiteLevel` and `OutputWhiteLevel` properties.</span></span>

|<span data-ttu-id="8cc99-142">Входное содержимое</span><span class="sxs-lookup"><span data-stu-id="8cc99-142">Input content</span></span>|<span data-ttu-id="8cc99-143">Формат композиции</span><span class="sxs-lookup"><span data-stu-id="8cc99-143">Composition format</span></span>|<span data-ttu-id="8cc99-144">Расширенный цветовой режим</span><span class="sxs-lookup"><span data-stu-id="8cc99-144">Advanced color mode</span></span>|<span data-ttu-id="8cc99-145">инпутвхителевел</span><span class="sxs-lookup"><span data-stu-id="8cc99-145">InputWhiteLevel</span></span>|<span data-ttu-id="8cc99-146">аутпутвхителевел</span><span class="sxs-lookup"><span data-stu-id="8cc99-146">OutputWhiteLevel</span></span>|
|-|-|-|-|-|
|<span data-ttu-id="8cc99-147">SDR/ВКГ</span><span class="sxs-lookup"><span data-stu-id="8cc99-147">SDR/WCG</span></span>|<span data-ttu-id="8cc99-148">**UINT8**</span><span class="sxs-lookup"><span data-stu-id="8cc99-148">**UINT8**</span></span>|<span data-ttu-id="8cc99-149">Любой</span><span class="sxs-lookup"><span data-stu-id="8cc99-149">Any</span></span>|<span data-ttu-id="8cc99-150">Н/Д</span><span class="sxs-lookup"><span data-stu-id="8cc99-150">N/A</span></span>|<span data-ttu-id="8cc99-151">Н/Д</span><span class="sxs-lookup"><span data-stu-id="8cc99-151">N/A</span></span>|
|<span data-ttu-id="8cc99-152">SDR/ВКГ</span><span class="sxs-lookup"><span data-stu-id="8cc99-152">SDR/WCG</span></span>|<span data-ttu-id="8cc99-153">**FP16**</span><span class="sxs-lookup"><span data-stu-id="8cc99-153">**FP16**</span></span>|<span data-ttu-id="8cc99-154">SDR/ВКГ</span><span class="sxs-lookup"><span data-stu-id="8cc99-154">SDR/WCG</span></span>|<span data-ttu-id="8cc99-155">Н/Д</span><span class="sxs-lookup"><span data-stu-id="8cc99-155">N/A</span></span>|<span data-ttu-id="8cc99-156">Н/Д</span><span class="sxs-lookup"><span data-stu-id="8cc99-156">N/A</span></span>|
|<span data-ttu-id="8cc99-157">SDR/ВКГ</span><span class="sxs-lookup"><span data-stu-id="8cc99-157">SDR/WCG</span></span>|<span data-ttu-id="8cc99-158">**FP16**</span><span class="sxs-lookup"><span data-stu-id="8cc99-158">**FP16**</span></span>|<span data-ttu-id="8cc99-159">HDR</span><span class="sxs-lookup"><span data-stu-id="8cc99-159">HDR</span></span>|<span data-ttu-id="8cc99-160">сдрвхите</span><span class="sxs-lookup"><span data-stu-id="8cc99-160">SDRWhite</span></span>|<span data-ttu-id="8cc99-161">80</span><span class="sxs-lookup"><span data-stu-id="8cc99-161">80</span></span>|
|<span data-ttu-id="8cc99-162">HDR</span><span class="sxs-lookup"><span data-stu-id="8cc99-162">HDR</span></span>|<span data-ttu-id="8cc99-163">Любой</span><span class="sxs-lookup"><span data-stu-id="8cc99-163">Any</span></span>|<span data-ttu-id="8cc99-164">SDR/ВКГ</span><span class="sxs-lookup"><span data-stu-id="8cc99-164">SDR/WCG</span></span>|<span data-ttu-id="8cc99-165">80</span><span class="sxs-lookup"><span data-stu-id="8cc99-165">80</span></span>|[<span data-ttu-id="8cc99-166">**DXGI_OUTPUT_DESC1:: Макслуминанце**</span><span class="sxs-lookup"><span data-stu-id="8cc99-166">**DXGI_OUTPUT_DESC1::MaxLuminance**</span></span>](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1)|
|<span data-ttu-id="8cc99-167">HDR</span><span class="sxs-lookup"><span data-stu-id="8cc99-167">HDR</span></span>|<span data-ttu-id="8cc99-168">**UINT8**</span><span class="sxs-lookup"><span data-stu-id="8cc99-168">**UINT8**</span></span>|<span data-ttu-id="8cc99-169">HDR</span><span class="sxs-lookup"><span data-stu-id="8cc99-169">HDR</span></span>|<span data-ttu-id="8cc99-170">80</span><span class="sxs-lookup"><span data-stu-id="8cc99-170">80</span></span>|<span data-ttu-id="8cc99-171">сдрвхите</span><span class="sxs-lookup"><span data-stu-id="8cc99-171">SDRWhite</span></span>|
|<span data-ttu-id="8cc99-172">HDR</span><span class="sxs-lookup"><span data-stu-id="8cc99-172">HDR</span></span>|<span data-ttu-id="8cc99-173">**FP16**</span><span class="sxs-lookup"><span data-stu-id="8cc99-173">**FP16**</span></span>|<span data-ttu-id="8cc99-174">HDR</span><span class="sxs-lookup"><span data-stu-id="8cc99-174">HDR</span></span>|<span data-ttu-id="8cc99-175">Н/Д</span><span class="sxs-lookup"><span data-stu-id="8cc99-175">N/A</span></span>|<span data-ttu-id="8cc99-176">Н/Д</span><span class="sxs-lookup"><span data-stu-id="8cc99-176">N/A</span></span>|

<span data-ttu-id="8cc99-177">В таблице значением 80 является белый уровень ссылки в НИТС для содержимого sRGB или scRGB.</span><span class="sxs-lookup"><span data-stu-id="8cc99-177">In the table, the value 80 is the reference white level, in nits, for sRGB or scRGB content.</span></span> <span data-ttu-id="8cc99-178">Для этого можно использовать константную [**D2D1_SCENE_REFERRED_SDR_WHITE_LEVEL**](/windows/desktop/direct2d/direct2d-constants), которая определена в `d2d1effects_2.h` .</span><span class="sxs-lookup"><span data-stu-id="8cc99-178">For this, you can use the constant [**D2D1_SCENE_REFERRED_SDR_WHITE_LEVEL**](/windows/desktop/direct2d/direct2d-constants), which is defined in `d2d1effects_2.h`.</span></span> <span data-ttu-id="8cc99-179">Значение `SDRWhite` — это число НИТС, которое должно использоваться для вывода белого содержимого sRGB.</span><span class="sxs-lookup"><span data-stu-id="8cc99-179">The value `SDRWhite` is the number of nits that the display should use to display white sRGB content.</span></span> <span data-ttu-id="8cc99-180">Это значение можно получить, обратившись к свойству [**адванцедколоринфо. сдрвхителевелиннитс**](/uwp/api/windows.graphics.display.advancedcolorinfo.sdrwhitelevelinnits) .</span><span class="sxs-lookup"><span data-stu-id="8cc99-180">You can retrieve this value by accessing the [**AdvancedColorInfo.SdrWhiteLevelInNits**](/uwp/api/windows.graphics.display.advancedcolorinfo.sdrwhitelevelinnits) property.</span></span> <span data-ttu-id="8cc99-181">Значение N/A означает, что в этом сценарии корректировка белого уровня не используется. можно либо удалить результат из графа, либо задать значения для отсутствия операций.</span><span class="sxs-lookup"><span data-stu-id="8cc99-181">The value N/A means that white level adjustment is not used in this scenario; you can either remove the effect from your graph, or set values for a no-op.</span></span>

<span data-ttu-id="8cc99-182">Обратите внимание, что в случаях, когда для приложения не требуется корректировка белого уровня, DWM или дисплей могут обрабатывать преобразование из пространства светимости, на котором они ссылаются, в область светимости, на которую ссылается сцена.</span><span class="sxs-lookup"><span data-stu-id="8cc99-182">Note that, in cases where a white level adjustment is not needed by the application, the DWM or the display may be handling the conversion from display-referred luminance space to scene-referred luminance space.</span></span>

- <span data-ttu-id="8cc99-183">В режиме SDR/ВКГ преобразование происходит после композиции DWM и применяется ко всему содержимому, представленному для этого отображения.</span><span class="sxs-lookup"><span data-stu-id="8cc99-183">In SDR/WCG mode, the conversion happens after DWM composition, and applies to all content presented to that display.</span></span> <span data-ttu-id="8cc99-184">На экране неявным образом выполняется это преобразование.</span><span class="sxs-lookup"><span data-stu-id="8cc99-184">The display implicitly performs this conversion.</span></span>
- <span data-ttu-id="8cc99-185">В режиме HDR преобразование выполняется автоматически с помощью DWM перед композицией, если область композиции приложения — SDR.</span><span class="sxs-lookup"><span data-stu-id="8cc99-185">In HDR mode, the conversion is performed automatically by the DWM before composition, so long as your application's composition surface is SDR.</span></span>

## <a name="requirements"></a><span data-ttu-id="8cc99-186">Требования</span><span class="sxs-lookup"><span data-stu-id="8cc99-186">Requirements</span></span>

| <span data-ttu-id="8cc99-187">Требование</span><span class="sxs-lookup"><span data-stu-id="8cc99-187">Requirement</span></span> | <span data-ttu-id="8cc99-188">Значение</span><span class="sxs-lookup"><span data-stu-id="8cc99-188">Value</span></span> |
|-|-|
| <span data-ttu-id="8cc99-189">Минимальная версия клиента</span><span class="sxs-lookup"><span data-stu-id="8cc99-189">Minimum supported client</span></span> | <span data-ttu-id="8cc99-190">Windows 10, версия 1809 (10,0; Сборка 17763) \[ приложения UWP для классических приложений \|\]</span><span class="sxs-lookup"><span data-stu-id="8cc99-190">Windows 10, version 1809 (10.0; Build 17763) \[desktop apps \| UWP apps\]</span></span> |
| <span data-ttu-id="8cc99-191">Header</span><span class="sxs-lookup"><span data-stu-id="8cc99-191">Header</span></span> | <span data-ttu-id="8cc99-192">d2d1effects \_ 2. h</span><span class="sxs-lookup"><span data-stu-id="8cc99-192">d2d1effects\_2.h</span></span> |
| <span data-ttu-id="8cc99-193">Библиотека</span><span class="sxs-lookup"><span data-stu-id="8cc99-193">Library</span></span> | <span data-ttu-id="8cc99-194">D2D1. lib, дксгуид. lib</span><span class="sxs-lookup"><span data-stu-id="8cc99-194">d2d1.lib, dxguid.lib</span></span> |

## <a name="related-topics"></a><span data-ttu-id="8cc99-195">См. также</span><span class="sxs-lookup"><span data-stu-id="8cc99-195">Related topics</span></span>

* [<span data-ttu-id="8cc99-196">Интерфейс ID2D1Effect</span><span class="sxs-lookup"><span data-stu-id="8cc99-196">ID2D1Effect interface</span></span>](/windows/desktop/api/d2d1_1/nn-d2d1_1-id2d1effect)
* [<span data-ttu-id="8cc99-197">Перечисление D2D1_WHITELEVELADJUSTMENT_PROP</span><span class="sxs-lookup"><span data-stu-id="8cc99-197">D2D1_WHITELEVELADJUSTMENT_PROP enumeration</span></span>](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop)
