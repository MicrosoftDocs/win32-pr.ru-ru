---
title: Сравнение аппаратного ускорения Direct2D и GDI
description: Direct2D и GDI являются API-интерфейсами двухмерной отрисовки в режиме интерпретации и имеют некоторую степень аппаратного ускорения.
ms.assetid: 0028a0c3-445d-46b7-b55b-46dff3bce9ae
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f05dce8719f4d07d3160c65b88570391c3eb736
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104337641"
---
# <a name="comparing-direct2d-and-gdi-hardware-acceleration"></a><span data-ttu-id="64937-103">Сравнение аппаратного ускорения Direct2D и GDI</span><span class="sxs-lookup"><span data-stu-id="64937-103">Comparing Direct2D and GDI Hardware Acceleration</span></span>

<span data-ttu-id="64937-104">[Direct2D](./direct2d-portal.md) и [GDI](/windows/desktop/gdi/windows-gdi) являются API-интерфейсами двухмерной отрисовки в режиме интерпретации и имеют некоторую степень аппаратного ускорения.</span><span class="sxs-lookup"><span data-stu-id="64937-104">[Direct2D](./direct2d-portal.md) and [GDI](/windows/desktop/gdi/windows-gdi) are both immediate mode 2D rendering APIs and both offer some degree of hardware acceleration.</span></span> <span data-ttu-id="64937-105">В этом разделе рассматриваются различия между Direct2D и GDI, включая предыдущие и представляющие различия в функциях аппаратного ускорения обоих API.</span><span class="sxs-lookup"><span data-stu-id="64937-105">This topic explores the differences between Direct2D and GDI, including past and present differences in the hardware acceleration features of both APIs.</span></span>

<span data-ttu-id="64937-106">Этот раздел содержит следующие компоненты.</span><span class="sxs-lookup"><span data-stu-id="64937-106">This topic has the following parts:</span></span>

-   [<span data-ttu-id="64937-107">Различия между Direct2D и GDI</span><span class="sxs-lookup"><span data-stu-id="64937-107">Differences between Direct2D and GDI</span></span>](#differences-between-direct2d-and-gdi)
-   [<span data-ttu-id="64937-108">Аппаратное ускорение GDI и Direct2D</span><span class="sxs-lookup"><span data-stu-id="64937-108">GDI and Direct2D hardware acceleration</span></span>](#gdi-and-direct2d-hardware-acceleration)
    -   [<span data-ttu-id="64937-109">Повышение сложности и размера драйверов экрана</span><span class="sxs-lookup"><span data-stu-id="64937-109">Increasing complexity and size of display drivers</span></span>](#increasing-complexity-and-size-of-display-drivers)
    -   [<span data-ttu-id="64937-110">Трудности при синхронизации сеанса и глобальных адресных пространств ядра</span><span class="sxs-lookup"><span data-stu-id="64937-110">Difficulty in synchronizing session and global kernel address spaces</span></span>](#difficulty-in-synchronizing-session-and-global-kernel-address-spaces)
    -   [<span data-ttu-id="64937-111">Управление составным окном</span><span class="sxs-lookup"><span data-stu-id="64937-111">Composited window management</span></span>](#composited-window-management)
-   [<span data-ttu-id="64937-112">Визуализация GDI в Windows 7</span><span class="sxs-lookup"><span data-stu-id="64937-112">GDI rendering in Windows 7</span></span>](#gdi-rendering-in-windows-7)
-   [<span data-ttu-id="64937-113">Сравните Direct2D и ускорение GDI в Windows 7</span><span class="sxs-lookup"><span data-stu-id="64937-113">Contrasting Direct2D and GDI acceleration in Windows 7</span></span>](#contrasting-direct2d-and-gdi-acceleration-in-windows-7)
    -   [<span data-ttu-id="64937-114">Расположение ресурсов</span><span class="sxs-lookup"><span data-stu-id="64937-114">Location of resources</span></span>](#location-of-resources)
    -   [<span data-ttu-id="64937-115">Метод подготовки к просмотру</span><span class="sxs-lookup"><span data-stu-id="64937-115">Rendering method</span></span>](#rendering-method)
    -   [<span data-ttu-id="64937-116">Масштабируемость</span><span class="sxs-lookup"><span data-stu-id="64937-116">Scalability</span></span>](#scalability)
    -   [<span data-ttu-id="64937-117">Расположение</span><span class="sxs-lookup"><span data-stu-id="64937-117">Location</span></span>](#location-of-resources)
    -   [<span data-ttu-id="64937-118">Доступность аппаратного ускорения</span><span class="sxs-lookup"><span data-stu-id="64937-118">Availability of Hardware Acceleration</span></span>](#availability-of-hardware-acceleration)
    -   [<span data-ttu-id="64937-119">Модель представления</span><span class="sxs-lookup"><span data-stu-id="64937-119">Presentation Model</span></span>](#presentation-model)
-   [<span data-ttu-id="64937-120">Заключение</span><span class="sxs-lookup"><span data-stu-id="64937-120">Conclusion</span></span>](#conclusion)

## <a name="differences-between-direct2d-and-gdi"></a><span data-ttu-id="64937-121">Различия между Direct2D и GDI</span><span class="sxs-lookup"><span data-stu-id="64937-121">Differences between Direct2D and GDI</span></span>

<span data-ttu-id="64937-122">[GDI](/windows/desktop/gdi/windows-gdi) отображает непрозрачные геометрические объекты, такие как многоугольники, эллипсы и линии.</span><span class="sxs-lookup"><span data-stu-id="64937-122">[GDI](/windows/desktop/gdi/windows-gdi) renders opaque, aliased geometries such as polygons, ellipses and lines.</span></span> <span data-ttu-id="64937-123">Он отображает текст с псевдонимами и ClearType, а также поддерживает прозрачное смешение через API Алфабленд.</span><span class="sxs-lookup"><span data-stu-id="64937-123">It renders aliased and ClearType text, and it can support transparency blending through the AlphaBlend API.</span></span> <span data-ttu-id="64937-124">Однако его обработка прозрачности не согласуется, и большинство интерфейсов API GDI просто игнорируют альфа-канал.</span><span class="sxs-lookup"><span data-stu-id="64937-124">However, its handling of transparency is inconsistent and most GDI APIs simply ignore the alpha channel.</span></span> <span data-ttu-id="64937-125">Несколько интерфейсов API GDI гарантируют, что альфа-канал будет содержать после операции.</span><span class="sxs-lookup"><span data-stu-id="64937-125">Few GDI APIs guarantee what the alpha channel will contain after an operation.</span></span> <span data-ttu-id="64937-126">Что более важно, отрисовка GDI не позволяет легко сопоставляться с трехмерными операциями, а современный GPU эффективно визуализируется в трехмерной части его подсистемы визуализации.</span><span class="sxs-lookup"><span data-stu-id="64937-126">More importantly, GDI's rendering does not map easily to 3D operations, and a modern GPU renders most efficiently on the 3D portion of its rendering engine.</span></span> <span data-ttu-id="64937-127">Например, строки с псевдонимами [Direct2D](./direct2d-portal.md)предназначены для реализации просто как два треугольника, отображаемых на GPU, в то время как GDI использует алгоритм рисования линий бресенхам.</span><span class="sxs-lookup"><span data-stu-id="64937-127">For example, [Direct2D](./direct2d-portal.md)'s aliased lines are designed to be implemented simply as two triangles rendered on the GPU, whereas GDI uses Bresenham's line drawing algorithm.</span></span>

<span data-ttu-id="64937-128">[Direct2D](./direct2d-portal.md) отображает непрозрачные, прозрачные, псевдонимы и сглаженные примитивы.</span><span class="sxs-lookup"><span data-stu-id="64937-128">[Direct2D](./direct2d-portal.md) renders opaque, transparent, aliased and anti-aliased primitives.</span></span> <span data-ttu-id="64937-129">Современные интерфейсы пользователя часто используют прозрачность и анимацию.</span><span class="sxs-lookup"><span data-stu-id="64937-129">Modern UIs often make use of transparency and animation.</span></span> <span data-ttu-id="64937-130">Direct2D упрощает создание современного пользовательского интерфейса, поскольку он имеет ограниченную гарантию того, как он принимает и визуализирует прозрачное содержимое, а все его примитивы подготавливаются к просмотру с помощью аппаратного ускорения.</span><span class="sxs-lookup"><span data-stu-id="64937-130">Direct2D makes it easier to create a modern UI because it has strict guarantees on how it accepts and renders transparent content, and all of its primitives are rendered using hardware acceleration.</span></span> <span data-ttu-id="64937-131">Direct2D не является чистым надмножеством [GDI](/windows/desktop/gdi/windows-gdi): примитивы, которые были бы неоправданными при реализации в GPU, отсутствуют в Direct2D.</span><span class="sxs-lookup"><span data-stu-id="64937-131">Direct2D is not a pure superset of [GDI](/windows/desktop/gdi/windows-gdi): primitives that would have been unreasonably slow when implemented on a GPU aren't present in Direct2D.</span></span> <span data-ttu-id="64937-132">Так как Direct2D построен с помощью этого акцента на трехмерном ускорении, его также легко использовать с Direct3D.</span><span class="sxs-lookup"><span data-stu-id="64937-132">Because Direct2D is built with this emphasis on 3D acceleration it is also easy to use with Direct3D.</span></span>

<span data-ttu-id="64937-133">Начиная с Windows NT 4, [GDI](/windows/desktop/gdi/windows-gdi) работает в режиме ядра.</span><span class="sxs-lookup"><span data-stu-id="64937-133">Since Windows NT 4, [GDI](/windows/desktop/gdi/windows-gdi) has run in kernel mode.</span></span> <span data-ttu-id="64937-134">Приложение вызывает GDI, который затем вызывает аналог режима ядра, который передает примитивы в собственную модель драйвера.</span><span class="sxs-lookup"><span data-stu-id="64937-134">The application calls GDI which then calls its kernel mode counterpart which passes the primitives to its own driver model.</span></span> <span data-ttu-id="64937-135">Затем этот драйвер отправляет результаты в глобальный драйвер монитора режима ядра.</span><span class="sxs-lookup"><span data-stu-id="64937-135">This driver then sends the results to the global kernel mode display driver.</span></span>

<span data-ttu-id="64937-136">Начиная с Windows 2000, [GDI](/windows/desktop/gdi/windows-gdi) и драйверы GDI были запущены в независимом пространстве ядра, называемом "пространство сеанса".</span><span class="sxs-lookup"><span data-stu-id="64937-136">Starting with Windows 2000, [GDI](/windows/desktop/gdi/windows-gdi) and the GDI drivers have run in an independent space in the kernel called "session space."</span></span> <span data-ttu-id="64937-137">Адресное пространство сеанса создается для каждого сеанса входа в систему, и каждый экземпляр GDI выполняется независимо в этом отдельном адресном пространстве режима ядра.</span><span class="sxs-lookup"><span data-stu-id="64937-137">A session address space is created for each logon session, and each instance of GDI runs independently in this distinct kernel mode address space.</span></span> <span data-ttu-id="64937-138">Однако Direct2D работает в пользовательском режиме и передает команды рисования с помощью драйвера Direct3D пользовательского режима в драйвер режима ядра.</span><span class="sxs-lookup"><span data-stu-id="64937-138">Direct2D, however, runs in user mode and passes drawing commands through the user mode Direct3D driver to the kernel mode driver.</span></span>

![рис. 1. Direct2D по сравнению с GDI](images/direct2d-vs-gdi1.png)

## <a name="gdi-and-direct2d-hardware-acceleration"></a><span data-ttu-id="64937-140">Аппаратное ускорение GDI и Direct2D</span><span class="sxs-lookup"><span data-stu-id="64937-140">GDI and Direct2D hardware acceleration</span></span>

<span data-ttu-id="64937-141">Самое важное различие между [Direct2D](./direct2d-portal.md) и аппаратным ускорением [GDI](/windows/desktop/gdi/windows-gdi) — это базовая технология, которая их выполняет.</span><span class="sxs-lookup"><span data-stu-id="64937-141">The most important difference between [Direct2D](./direct2d-portal.md) and [GDI](/windows/desktop/gdi/windows-gdi) hardware acceleration is the underlying technology that drives them.</span></span> <span data-ttu-id="64937-142">Direct2D находится на вершине Direct3D, а GDI имеет собственную модель драйвера, интерфейс драйвера устройства GDI (DDI), соответствующий примитивам GDI.</span><span class="sxs-lookup"><span data-stu-id="64937-142">Direct2D is layered on top Direct3D and GDI has its own driver model, the GDI Device Driver Interface (DDI), which corresponds to the GDI primitives.</span></span> <span data-ttu-id="64937-143">Модель драйвера Direct3D соответствует тому, что отображает оборудование для отрисовки трехмерной графики в GPU.</span><span class="sxs-lookup"><span data-stu-id="64937-143">The Direct3D driver model corresponds to what the 3D rendering hardware in a GPU renders.</span></span> <span data-ttu-id="64937-144">Когда DDI GDI был впервые определен, большинство устройств ускорения экрана нацелены на примитивы GDI.</span><span class="sxs-lookup"><span data-stu-id="64937-144">When the GDI DDI was first defined, most display acceleration hardware targeted the GDI primitives.</span></span> <span data-ttu-id="64937-145">Со временем в ускорении трехмерной игры было включено больше и больше, чем при ускорении приложения.</span><span class="sxs-lookup"><span data-stu-id="64937-145">Over time, more and more emphasis was placed on 3D game acceleration and less on application acceleration.</span></span> <span data-ttu-id="64937-146">Как следствие, API BitBlt был аппаратным ускорением, а большинство других операций GDI — нет.</span><span class="sxs-lookup"><span data-stu-id="64937-146">As a consequence the BitBlt API was hardware accelerated and most other GDI operations were not.</span></span>

<span data-ttu-id="64937-147">Это позволяет настроить этап для последовательности изменений в способе отображения [GDI](/windows/desktop/gdi/windows-gdi) на экране.</span><span class="sxs-lookup"><span data-stu-id="64937-147">This set the stage for a sequence of changes to how [GDI](/windows/desktop/gdi/windows-gdi) renders to the display.</span></span> <span data-ttu-id="64937-148">На следующем рисунке показано, как визуализация отображения GDI изменилась с Windows XP на Windows 7.</span><span class="sxs-lookup"><span data-stu-id="64937-148">The following illustration shows how GDI display rendering has changed from Windows XP to Windows 7.</span></span>

![рис. 2. развитие отрисовки отображения GDI](images/direct2d-vs-gdi2.png)

<span data-ttu-id="64937-150">Существует также ряд дополнительных факторов, которые привели к изменению модели драйвера [GDI](/windows/desktop/gdi/windows-gdi) , как описано ниже.</span><span class="sxs-lookup"><span data-stu-id="64937-150">There were also a number of additional factors that caused changes to the [GDI](/windows/desktop/gdi/windows-gdi) driver model, as explained below.</span></span>

### <a name="increasing-complexity-and-size-of-display-drivers"></a><span data-ttu-id="64937-151">Повышение сложности и размера драйверов экрана</span><span class="sxs-lookup"><span data-stu-id="64937-151">Increasing complexity and size of display drivers</span></span>

<span data-ttu-id="64937-152">с течением времени трехмерные драйверы стали более сложными.</span><span class="sxs-lookup"><span data-stu-id="64937-152">3D drivers have become more complex over time.</span></span> <span data-ttu-id="64937-153">Более сложный код имеет больше дефектов, что дает возможность использовать драйвер в пользовательском режиме, где ошибка драйвера не может привести к перезагрузке системы.</span><span class="sxs-lookup"><span data-stu-id="64937-153">More complex code tends to have more defects making it beneficial for the driver to exist in user-mode where a driver bug can't cause a system reboot.</span></span> <span data-ttu-id="64937-154">Как видно на рисунке выше, драйвер экрана делится на компонент сложного пользовательского режима и на более простой компонент режима ядра.</span><span class="sxs-lookup"><span data-stu-id="64937-154">As can be seen in the figure above, the display driver is divided into a complex user mode component and a simpler kernel mode component.</span></span>

### <a name="difficulty-in-synchronizing-session-and-global-kernel-address-spaces"></a><span data-ttu-id="64937-155">Трудности при синхронизации сеанса и глобальных адресных пространств ядра</span><span class="sxs-lookup"><span data-stu-id="64937-155">Difficulty in synchronizing session and global kernel address spaces</span></span>

<span data-ttu-id="64937-156">В Windows XP драйвер экрана существует в двух разных адресных пространствах: пространстве сеанса и пространстве ядра.</span><span class="sxs-lookup"><span data-stu-id="64937-156">In Windows XP, a display driver exists in two different address spaces: session space and kernel space.</span></span> <span data-ttu-id="64937-157">Компоненты драйвера должны реагировать на события, такие как события управления питанием.</span><span class="sxs-lookup"><span data-stu-id="64937-157">Parts of the driver need to respond to events such as power management events.</span></span> <span data-ttu-id="64937-158">Это необходимо синхронизировать с состоянием драйвера в адресном пространстве сеанса.</span><span class="sxs-lookup"><span data-stu-id="64937-158">This needs to be synchronized with the driver state in the session address space.</span></span> <span data-ttu-id="64937-159">Это сложная задача, которая может привести к дефектам, когда драйверы экрана пытаются работать с этими отдельными адресными пространствами.</span><span class="sxs-lookup"><span data-stu-id="64937-159">This is a difficult task and can lead to defects when display drivers attempt to deal with these distinct address spaces.</span></span>

### <a name="composited-window-management"></a><span data-ttu-id="64937-160">Управление составным окном</span><span class="sxs-lookup"><span data-stu-id="64937-160">Composited window management</span></span>

<span data-ttu-id="64937-161">Диспетчер окон рабочего стола (DWM), диспетчер окон компоновки, появившийся в Windows 7, отображает все окна в области экрана, а затем объединяет их для отображения на экране.</span><span class="sxs-lookup"><span data-stu-id="64937-161">The Desktop Window Manager (DWM), the compositing window manager introduced in Windows 7, renders all windows to off-screen surfaces and then composes them together to be displayed on screen.</span></span> <span data-ttu-id="64937-162">Для этого необходимо, чтобы [GDI](/windows/desktop/gdi/windows-gdi) мог подготовиться к просмотру на поверхности, которая затем будет отображена Direct3D для отображения.</span><span class="sxs-lookup"><span data-stu-id="64937-162">This requires [GDI](/windows/desktop/gdi/windows-gdi) to be able to render to a surface which will then be rendered by Direct3D to display.</span></span> <span data-ttu-id="64937-163">Это потребовало проблемы в модели драйвера XP, поскольку GDI и Direct3D были стеками драйверов параллельного выполнения.</span><span class="sxs-lookup"><span data-stu-id="64937-163">This posed a problem in the XP driver model, since GDI and Direct3D were parallel driver stacks.</span></span>

<span data-ttu-id="64937-164">В результате в Windows Vista драйвер отображения DDI для [GDI](/windows/desktop/gdi/windows-gdi) был реализован как Предуказанный корпорацией Майкрософт стандартный видеодрайвер (CDC), который ВИЗУАЛИЗИРУЕТ содержимое GDI в битовую карту системной памяти, которая должна состоять на экране.</span><span class="sxs-lookup"><span data-stu-id="64937-164">As a result, in Windows Vista, the [GDI](/windows/desktop/gdi/windows-gdi) DDI display driver was implemented as the Microsoft supplied Canonical Display Driver (CDD) which rendered GDI content to a system memory bitmap to be composed to the screen.</span></span>

## <a name="gdi-rendering-in-windows-7"></a><span data-ttu-id="64937-165">Визуализация GDI в Windows 7</span><span class="sxs-lookup"><span data-stu-id="64937-165">GDI rendering in Windows 7</span></span>

<span data-ttu-id="64937-166">Модель драйвера, используемая в Windows Vista, требует, чтобы каждое окно [GDI](/windows/desktop/gdi/windows-gdi) было использовано как поверхность видеопамяти, так и область системной памяти.</span><span class="sxs-lookup"><span data-stu-id="64937-166">The driver model used in Windows Vista required that every [GDI](/windows/desktop/gdi/windows-gdi) window be backed by both a video memory surface and a system memory surface.</span></span> <span data-ttu-id="64937-167">Это привело к тому, что системная память использовалась для каждого окна GDI.</span><span class="sxs-lookup"><span data-stu-id="64937-167">This resulted in system memory being used for every GDI window.</span></span>

<span data-ttu-id="64937-168">По этой причине [GDI](/windows/desktop/gdi/windows-gdi) снова был изменен в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="64937-168">For this reason, [GDI](/windows/desktop/gdi/windows-gdi) was changed again in Windows 7.</span></span> <span data-ttu-id="64937-169">.</span><span class="sxs-lookup"><span data-stu-id="64937-169">.</span></span> <span data-ttu-id="64937-170">Вместо подготовки к просмотру на поверхности системной памяти GDI был изменен для отрисовки в сегмент памяти апертуры.</span><span class="sxs-lookup"><span data-stu-id="64937-170">Instead of rendering to a system memory surface, GDI was modified to render to an aperture memory segment.</span></span> <span data-ttu-id="64937-171">Память апертуры можно обновить с поверхности видеопамяти, содержащей содержимое окна.</span><span class="sxs-lookup"><span data-stu-id="64937-171">The aperture memory can be updated from the video memory surface holding the window contents.</span></span> <span data-ttu-id="64937-172">GDI может вернуться в память апертуры, и результат можно будет отправить обратно в область окна.</span><span class="sxs-lookup"><span data-stu-id="64937-172">GDI can render back to the aperture memory, and the result can then be sent back to the window surface.</span></span> <span data-ttu-id="64937-173">Поскольку сегмент памяти апертуры можно устранить с помощью GPU, GPU может ускорить эти обновления на поверхности видеопамяти.</span><span class="sxs-lookup"><span data-stu-id="64937-173">Since the aperture memory segment is addressable by the GPU, the GPU can accelerate these updates to the video memory surface.</span></span> <span data-ttu-id="64937-174">Например, в таких случаях ускорение отрисовки текста, Битблтс, Алфабленд, Транспарентблт и Стретчблт.</span><span class="sxs-lookup"><span data-stu-id="64937-174">For example, text rendering, BitBlts, AlphaBlend, TransparentBlt, and StretchBlt are all accelerated in these cases.</span></span>

## <a name="contrasting-direct2d-and-gdi-acceleration-in-windows-7"></a><span data-ttu-id="64937-175">Сравните Direct2D и ускорение GDI в Windows 7</span><span class="sxs-lookup"><span data-stu-id="64937-175">Contrasting Direct2D and GDI acceleration in Windows 7</span></span>

<span data-ttu-id="64937-176">[Direct2D](./direct2d-portal.md) и [GDI](/windows/desktop/gdi/windows-gdi) являются как плоскими API-интерфейсами рендеринга в режиме ожидания, так и аппаратным ускорением.</span><span class="sxs-lookup"><span data-stu-id="64937-176">[Direct2D](./direct2d-portal.md) and [GDI](/windows/desktop/gdi/windows-gdi) are both 2D immediate-mode rendering APIs and are hardware accelerated.</span></span> <span data-ttu-id="64937-177">Однако существует ряд различий, которые остаются в обоих API.</span><span class="sxs-lookup"><span data-stu-id="64937-177">However, there are a number of differences that remain in both APIs.</span></span>

### <a name="location-of-resources"></a><span data-ttu-id="64937-178">Расположение ресурсов</span><span class="sxs-lookup"><span data-stu-id="64937-178">Location of resources</span></span>

<span data-ttu-id="64937-179">По умолчанию [GDI](/windows/desktop/gdi/windows-gdi) сохраняет свои ресурсы в определенных точечных рисунках в системной памяти.</span><span class="sxs-lookup"><span data-stu-id="64937-179">[GDI](/windows/desktop/gdi/windows-gdi) maintains its resources, in particular bitmaps, in system memory by default.</span></span> <span data-ttu-id="64937-180">[Direct2D](./direct2d-portal.md) сохраняет свои ресурсы в видеопамяти видеоадаптера.</span><span class="sxs-lookup"><span data-stu-id="64937-180">[Direct2D](./direct2d-portal.md) maintains its resources in video memory on the display adapter.</span></span> <span data-ttu-id="64937-181">Когда GDI требуется обновить видеопамять, это необходимо сделать на шине, если ресурс уже не находится в сегменте памяти апертуры или если операция может быть выражена напрямую.</span><span class="sxs-lookup"><span data-stu-id="64937-181">When GDI needs to update video memory, this must be done over the bus, unless the resource is already in the aperture memory segment or if the operation can be expressed directly.</span></span> <span data-ttu-id="64937-182">В отличие от этого, Direct2D может просто перевести свои примитивы в примитивы Direct3D, так как ресурсы уже находятся в видеопамяти.</span><span class="sxs-lookup"><span data-stu-id="64937-182">In contrast, Direct2D can simply translate its primitives to Direct3D primitives because the resources are already in video memory.</span></span>

### <a name="rendering-method"></a><span data-ttu-id="64937-183">Метод подготовки к просмотру</span><span class="sxs-lookup"><span data-stu-id="64937-183">Rendering method</span></span>

<span data-ttu-id="64937-184">Для обеспечения совместимости [GDI](/windows/desktop/gdi/windows-gdi) выполняет большую часть его отрисовки для апертуры памяти с помощью ЦП.</span><span class="sxs-lookup"><span data-stu-id="64937-184">In order to maintain compatibility, [GDI](/windows/desktop/gdi/windows-gdi) performs a large part of its rendering to aperture memory using the CPU.</span></span> <span data-ttu-id="64937-185">В отличие от этого, [Direct2D](./direct2d-portal.md) преобразует вызовы API в примитивы Direct3D и операции рисования.</span><span class="sxs-lookup"><span data-stu-id="64937-185">In contrast, [Direct2D](./direct2d-portal.md) translates its APIs calls into Direct3D primitives and drawing operations.</span></span> <span data-ttu-id="64937-186">Затем результат отображается на GPU.</span><span class="sxs-lookup"><span data-stu-id="64937-186">The result is then rendered on the GPU.</span></span> <span data-ttu-id="64937-187">Некоторые из модулей отрисовки GDI. s выполняются на GPU при копировании памяти апертуры на поверхность видеопамяти, представляющая окно GDI.</span><span class="sxs-lookup"><span data-stu-id="64937-187">Some of GDI?s rendering is performed on the GPU when the aperture memory is copied to the video memory surface representing the GDI window.</span></span>

### <a name="scalability"></a><span data-ttu-id="64937-188">Масштабируемость</span><span class="sxs-lookup"><span data-stu-id="64937-188">Scalability</span></span>

<span data-ttu-id="64937-189">Вызовы отрисовки [Direct2D](./direct2d-portal.md)— это все независимые потоки команд для GPU.</span><span class="sxs-lookup"><span data-stu-id="64937-189">[Direct2D](./direct2d-portal.md)'s rendering calls are all independent command streams to the GPU.</span></span> <span data-ttu-id="64937-190">Каждая фабрика Direct2D представляет собой другое устройство Direct3D.</span><span class="sxs-lookup"><span data-stu-id="64937-190">Each Direct2D factory represents a different Direct3D device.</span></span> <span data-ttu-id="64937-191">[GDI](/windows/desktop/gdi/windows-gdi) использует один командный поток для всех приложений в системе.</span><span class="sxs-lookup"><span data-stu-id="64937-191">[GDI](/windows/desktop/gdi/windows-gdi) uses one command stream for all of the applications on the system.</span></span> <span data-ttu-id="64937-192">Метод GDI может привести к накруткиию ресурсов GPU и контекста рендеринга ЦП.</span><span class="sxs-lookup"><span data-stu-id="64937-192">GDI's method can result in a buildup of GPU and CPU rendering context overhead.</span></span>

### <a name="location"></a><span data-ttu-id="64937-193">Расположение</span><span class="sxs-lookup"><span data-stu-id="64937-193">Location</span></span>

<span data-ttu-id="64937-194">[Direct2D](./direct2d-portal.md) работает полностью в пользовательском режиме, включая время выполнения Direct3D и драйвер пользовательского режима Direct3D.</span><span class="sxs-lookup"><span data-stu-id="64937-194">[Direct2D](./direct2d-portal.md) operates entirely in user mode, including the Direct3D run time and the user mode Direct3D driver.</span></span> <span data-ttu-id="64937-195">Это помогает предотвратить системные сбои, вызванные дефектами кода в ядре.</span><span class="sxs-lookup"><span data-stu-id="64937-195">This helps prevent system crashes caused by code defects in the kernel.</span></span> <span data-ttu-id="64937-196">Однако [GDI](/windows/desktop/gdi/windows-gdi)имеет большую часть функциональных возможностей в пространстве сеанса в режиме ядра и его поверхность API в пользовательском режиме.</span><span class="sxs-lookup"><span data-stu-id="64937-196">[GDI](/windows/desktop/gdi/windows-gdi), however, has most of its functionality in session space in kernel mode, with its API surface in user mode.</span></span>

### <a name="availability-of-hardware-acceleration"></a><span data-ttu-id="64937-197">Доступность аппаратного ускорения</span><span class="sxs-lookup"><span data-stu-id="64937-197">Availability of Hardware Acceleration</span></span>

<span data-ttu-id="64937-198">[GDI](/windows/desktop/gdi/windows-gdi) — это аппаратное ускорение в Windows XP, которое ускоряется в Windows 7, когда работает диспетчер окон рабочего стола и используется драйвер WDDM 1,1.</span><span class="sxs-lookup"><span data-stu-id="64937-198">[GDI](/windows/desktop/gdi/windows-gdi) is hardware accelerated on Windows XP, and accelerated on Windows 7 when the Desktop Window Manager is running and a WDDM 1.1 driver is in use.</span></span> <span data-ttu-id="64937-199">[Direct2D](./direct2d-portal.md) является аппаратным ускорением практически любого драйвера WDDM и независимо от того, используется ли DWM.</span><span class="sxs-lookup"><span data-stu-id="64937-199">[Direct2D](./direct2d-portal.md) is hardware accelerated on almost any WDDM driver and whether or not DWM is in use.</span></span> <span data-ttu-id="64937-200">В Vista GDI всегда отображается в ЦП.</span><span class="sxs-lookup"><span data-stu-id="64937-200">On Vista, GDI will always render on the CPU.</span></span>

### <a name="presentation-model"></a><span data-ttu-id="64937-201">Модель представления</span><span class="sxs-lookup"><span data-stu-id="64937-201">Presentation Model</span></span>

<span data-ttu-id="64937-202">Когда система Windows была разработана впервые, недостаточно памяти для того, чтобы все окна сохранялись в своем собственном растровом изображении.</span><span class="sxs-lookup"><span data-stu-id="64937-202">When Windows was first designed, there was insufficient memory to allow every window to be stored in its own bitmap.</span></span> <span data-ttu-id="64937-203">В результате [GDI](/windows/desktop/gdi/windows-gdi) всегда отображается логически непосредственно на экране, при этом применяются различные области отсечения, чтобы убедиться, что приложение не было отображено за пределами окна.</span><span class="sxs-lookup"><span data-stu-id="64937-203">As a result, [GDI](/windows/desktop/gdi/windows-gdi) always rendered logically directly to the screen, with various clipping regions applied to ensure that an application did not render outside of its window.</span></span> <span data-ttu-id="64937-204">В модели [Direct2D](./direct2d-portal.md) приложение подготавливается к просмотру в буфере, а результат отображается при прорисовке приложения.</span><span class="sxs-lookup"><span data-stu-id="64937-204">In the [Direct2D](./direct2d-portal.md) model, an application renders to a back-buffer, and the result is displayed when the application is done drawing.</span></span> <span data-ttu-id="64937-205">Это позволяет Direct2D выполнять сценарии анимации гораздо более плавно, чем GDI.</span><span class="sxs-lookup"><span data-stu-id="64937-205">This allows Direct2D to handle animation scenarios much more fluidly than GDI can.</span></span>

## <a name="conclusion"></a><span data-ttu-id="64937-206">Заключение</span><span class="sxs-lookup"><span data-stu-id="64937-206">Conclusion</span></span>

<span data-ttu-id="64937-207">Существующий код [GDI](/windows/desktop/gdi/windows-gdi) продолжит работать в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="64937-207">Existing [GDI](/windows/desktop/gdi/windows-gdi) code will continue to work well under Windows 7.</span></span> <span data-ttu-id="64937-208">Однако при написании нового кода отрисовки графики следует учитывать [Direct2D](./direct2d-portal.md) , поскольку он использует преимущества современных графических процессоров.</span><span class="sxs-lookup"><span data-stu-id="64937-208">However, when writing new graphics rendering code, [Direct2D](./direct2d-portal.md) should be considered, as it takes better advantage of modern GPUs.</span></span>

 

 