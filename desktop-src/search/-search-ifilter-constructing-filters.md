---
description: Важно понимать необходимую структуру DLL обработчика фильтров (реализацию интерфейса IFilter).
ms.assetid: a2b5a813-573a-44d3-8780-99603e3246c1
title: Реализация обработчиков фильтров в поиске Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc5f326440b31b62ff5697274962f4d4a2cfe7c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105719314"
---
# <a name="implementing-filter-handlers-in-windows-search"></a><span data-ttu-id="0ffde-103">Реализация обработчиков фильтров в поиске Windows</span><span class="sxs-lookup"><span data-stu-id="0ffde-103">Implementing Filter Handlers in Windows Search</span></span>

<span data-ttu-id="0ffde-104">Важно понимать необходимую структуру DLL обработчика фильтров (реализацию интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ).</span><span class="sxs-lookup"><span data-stu-id="0ffde-104">It is important that you understand the required DLL structure of a filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span>

<span data-ttu-id="0ffde-105">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0ffde-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="0ffde-106">Реализация и экспорт точек входа библиотеки DLL</span><span class="sxs-lookup"><span data-stu-id="0ffde-106">Implementing and Exporting the DLL Entry Points</span></span>](#implementing-and-exporting-the-dll-entry-points)
- [<span data-ttu-id="0ffde-107">Реализация класса IFilter и фабрики классов</span><span class="sxs-lookup"><span data-stu-id="0ffde-107">Implementing the IFilter Class and Class Factory</span></span>](#implementing-the-ifilter-class-and-class-factory)
- [<span data-ttu-id="0ffde-108">Наследование COM-интерфейсов</span><span class="sxs-lookup"><span data-stu-id="0ffde-108">Inheriting the COM Interfaces</span></span>](#inheriting-the-com-interfaces)
- [<span data-ttu-id="0ffde-109">Реализация методов COM-интерфейса</span><span class="sxs-lookup"><span data-stu-id="0ffde-109">Implementing the COM Interface Methods</span></span>](#implementing-the-com-interface-methods)
  - [<span data-ttu-id="0ffde-110">Нереализованные методы COM</span><span class="sxs-lookup"><span data-stu-id="0ffde-110">COM Methods that are not Implemented</span></span>](#com-methods-that-are-not-implemented)
- [<span data-ttu-id="0ffde-111">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="0ffde-111">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="0ffde-112">См. также</span><span class="sxs-lookup"><span data-stu-id="0ffde-112">Related topics</span></span>](#related-topics)

## <a name="implementing-and-exporting-the-dll-entry-points"></a><span data-ttu-id="0ffde-113">Реализация и экспорт точек входа библиотеки DLL</span><span class="sxs-lookup"><span data-stu-id="0ffde-113">Implementing and Exporting the DLL Entry Points</span></span>

<span data-ttu-id="0ffde-114">Каждая библиотека DLL [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) (обозначенная Ifilter.dll в этом разделе) должна реализовывать и экспортировать следующие точки входа.</span><span class="sxs-lookup"><span data-stu-id="0ffde-114">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL (denoted by Ifilter.dll in this section) must implement and export the following entry points.</span></span> <span data-ttu-id="0ffde-115">Эти точки входа обычно экспортируются с помощью файла определения модуля (DEF) для интерфейса **IFilter** или с помощью ключевого слова **\_ \_ declspec (dllexport)** .</span><span class="sxs-lookup"><span data-stu-id="0ffde-115">These entry points are typically exported using a module-definition (.def) file for the **IFilter** interface or by using the **\_\_declspec(dllexport)** keyword.</span></span> <span data-ttu-id="0ffde-116">DLL-файл может быть зарегистрирован в любой папке, но обычно находится в папке% SystemRoot% \\ System32.</span><span class="sxs-lookup"><span data-stu-id="0ffde-116">The DLL file can be registered to be in any folder, but it usually resides in the %SystemRoot%\\system32 folder.</span></span>

<span data-ttu-id="0ffde-117">Точки входа библиотеки DLL перечислены и описаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="0ffde-117">DLL entry points are listed and described in the following table.</span></span>

| <span data-ttu-id="0ffde-118">Имя DLL</span><span class="sxs-lookup"><span data-stu-id="0ffde-118">DLL name</span></span>                                                                                     | <span data-ttu-id="0ffde-119">Описание библиотеки DLL</span><span class="sxs-lookup"><span data-stu-id="0ffde-119">DLL description</span></span>                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="0ffde-120">Регистрация</span><span class="sxs-lookup"><span data-stu-id="0ffde-120">DllRegisterServer</span></span>](/windows/win32/api/olectl/nf-olectl-dllregisterserver)            | <span data-ttu-id="0ffde-121">Точка входа [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) регистрирует библиотеку DLL в качестве фильтра в реестре.</span><span class="sxs-lookup"><span data-stu-id="0ffde-121">The [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) entry point registers the DLL as a filter in the registry.</span></span> <span data-ttu-id="0ffde-122">Вы регистрируете библиотеку DLL, запустив программу regsvr32.exe с именем DLL-файла интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) в качестве аргумента: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="0ffde-122">You register the DLL by running the regsvr32.exe program with the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface DLL file name as an argument: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span></span>                                              |
| [<span data-ttu-id="0ffde-123">Функция DllUnregisterServer</span><span class="sxs-lookup"><span data-stu-id="0ffde-123">DllUnregisterServer Function</span></span>](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) | <span data-ttu-id="0ffde-124">Точка входа [функции DllUnregisterServer](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) удаляет библиотеку DLL в качестве постоянного обработчика в реестре.</span><span class="sxs-lookup"><span data-stu-id="0ffde-124">The [DllUnregisterServer Function](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entry point removes the DLL as a persistent handler in the registry.</span></span> <span data-ttu-id="0ffde-125">Отмените регистрацию библиотеки DLL, запустив программу regsvr32.exe с `/u` флагом: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="0ffde-125">You unregister the DLL by running the regsvr32.exe program with the `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span></span>                                                                                    |
| [<span data-ttu-id="0ffde-126">Функция DllGetClassObject</span><span class="sxs-lookup"><span data-stu-id="0ffde-126">DllGetClassObject Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)   | <span data-ttu-id="0ffde-127">Клиент индексирования содержимого вызывает точку входа [функции DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) с помощью модели COM, чтобы создать объект фабрики класса для интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) и получить указатель на интерфейс фабрики класса этого объекта.</span><span class="sxs-lookup"><span data-stu-id="0ffde-127">The content indexing client calls the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point, through Component Object Model (COM), to create a class factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface and to get a pointer to the class factory interface of that object.</span></span>                                               |
| [<span data-ttu-id="0ffde-128">Функция DllCanUnloadNow</span><span class="sxs-lookup"><span data-stu-id="0ffde-128">DllCanUnloadNow Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)     | <span data-ttu-id="0ffde-129">Клиент индексирования содержимого вызывает точку входа [функции DllCanUnloadNow](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) через COM, чтобы определить, возможно ли выгрузить DLL-библиотеку [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  .</span><span class="sxs-lookup"><span data-stu-id="0ffde-129">The content-indexing client calls the [DllCanUnloadNow Function](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) entry point, through COM, to determine whether it is possible to unload the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL.</span></span> <span data-ttu-id="0ffde-130">Интерфейс **IFilter** выгружается после того, как он не используется в течение интервала времени, как указано в значении реестра филтеридлетимеаут.</span><span class="sxs-lookup"><span data-stu-id="0ffde-130">The **IFilter** interface is unloaded after it is unused for an interval of time, as specified by the FilterIdleTimeOut registry value.</span></span> |

## <a name="implementing-the-ifilter-class-and-class-factory"></a><span data-ttu-id="0ffde-131">Реализация класса IFilter и фабрики классов</span><span class="sxs-lookup"><span data-stu-id="0ffde-131">Implementing the IFilter Class and Class Factory</span></span>

<span data-ttu-id="0ffde-132">По крайней мере два класса, такие как Кфилтер и Кфилтеркф, обычно реализуются каждой DLL-библиотекой [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="0ffde-132">At least two classes, such as CFilter and CFilterCF, are typically implemented by each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL.</span></span> <span data-ttu-id="0ffde-133">Класс Кфилтер создает объект интерфейса **IFilter** , реализующий функцию фильтрации содержимого.</span><span class="sxs-lookup"><span data-stu-id="0ffde-133">The CFilter class produces the **IFilter** interface object that implements the content-filtering functionality.</span></span> <span data-ttu-id="0ffde-134">Его функции члена реализуют методы интерфейса интерфейса **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="0ffde-134">Its member functions implement the interface methods of the **IFilter** interface.</span></span> <span data-ttu-id="0ffde-135">Каждый класс **IFilter** требует уникального идентификатора класса (CLSID), создаваемого реализацией интерфейса **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="0ffde-135">Each **IFilter** class requires a unique class identifier (CLSID), which the **IFilter** interface implementer generates.</span></span>

<span data-ttu-id="0ffde-136">Класс Кфилтеркф создает объект фабрики класса для интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="0ffde-136">The CFilterCF class produces the class-factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="0ffde-137">Фабрика класса вызывается через интерфейс [интерфейса IClassFactory](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) в точке входа [функции DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="0ffde-137">The class factory is called, through its [IClassFactory Interface](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, by the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point of the DLL.</span></span> <span data-ttu-id="0ffde-138">Класс Кфилтеркф создает объект Кфилтер и возвращает указатель на [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="0ffde-138">The CFilterCF class creates the CFilter object and returns a pointer to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="0ffde-139">В более сложных случаях **IFilter** может реализовать иерархию классов вместо одного класса кфилтер.</span><span class="sxs-lookup"><span data-stu-id="0ffde-139">In more complex cases, an **IFilter** can implement a class hierarchy in place of the single CFilter class.</span></span>

## <a name="inheriting-the-com-interfaces"></a><span data-ttu-id="0ffde-140">Наследование COM-интерфейсов</span><span class="sxs-lookup"><span data-stu-id="0ffde-140">Inheriting the COM Interfaces</span></span>

<span data-ttu-id="0ffde-141">Windows Search 3,0 и более поздних версий требует использования [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) по следующим причинам:</span><span class="sxs-lookup"><span data-stu-id="0ffde-141">Windows Search 3.0 and later require that you use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) for the following reasons:</span></span>

- <span data-ttu-id="0ffde-142">Для обеспечения производительности и будущей совместимости.</span><span class="sxs-lookup"><span data-stu-id="0ffde-142">To ensure performance and future compatibility.</span></span>
- <span data-ttu-id="0ffde-143">Для повышения безопасности.</span><span class="sxs-lookup"><span data-stu-id="0ffde-143">To help increase security.</span></span> <span data-ttu-id="0ffde-144">IFilter, реализованные с помощью [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) , более безопасны, так как контекст, в котором выполняется интерфейс [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , не требует наличия прав на открытие файлов на диске или по сети.</span><span class="sxs-lookup"><span data-stu-id="0ffde-144">IFilters implemented with [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) are more secure because the context in which the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface runs does not need the rights to open files on the disk or over the network.</span></span>
- <span data-ttu-id="0ffde-145">Хотя в Windows Search используется только [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), класс интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) также может наследовать реализации интерфейса [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) и (или) интерфейсов [иперсистстораже](/windows/win32/api/objidl/nn-objidl-ipersiststorage) для обратной совместимости.</span><span class="sxs-lookup"><span data-stu-id="0ffde-145">While Windows Search uses only [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface class can also inherit the [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) and/or [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface implementations for backward compatibility.</span></span>

<span data-ttu-id="0ffde-146">Эти интерфейсы объявляются в файлах, включаемых из \\ каталога мссдк include, и имеют предварительно определенные идентификаторы интерфейса (идентификаторов IID).</span><span class="sxs-lookup"><span data-stu-id="0ffde-146">These interfaces are declared in files included from the mssdk\\include directory and have pre-defined interface identifiers (IIDs).</span></span> <span data-ttu-id="0ffde-147">Клиент индексирования содержимого запрашивает интерфейс [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) через [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , чтобы определить, какой из этих интерфейсов следует использовать при фильтрации содержимого.</span><span class="sxs-lookup"><span data-stu-id="0ffde-147">The content-indexing client queries the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface through [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) to determine which of these interfaces to use when filtering content.</span></span>

## <a name="implementing-the-com-interface-methods"></a><span data-ttu-id="0ffde-148">Реализация методов COM-интерфейса</span><span class="sxs-lookup"><span data-stu-id="0ffde-148">Implementing the COM Interface Methods</span></span>

<span data-ttu-id="0ffde-149">Интерфейс [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) реализует методы [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) как для класса интерфейса **IFilter** , так и для фабрики класса интерфейса **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="0ffde-149">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface implements the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) methods for both the **IFilter** interface class and the **IFilter** interface-class factory.</span></span> <span data-ttu-id="0ffde-150">В следующей таблице перечислены интерфейсы и методы интерфейса **IFilter** , которые должны реализовываться **интерфейсом IFilter,** в порядке vtable.</span><span class="sxs-lookup"><span data-stu-id="0ffde-150">The following table lists, in vtable order, the **IFilter** interface-specific interfaces and methods that the **IFilter** interface should implement.</span></span> <span data-ttu-id="0ffde-151">Интерфейс **IFilter** должен реализовывать не менее [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), но может реализовывать дополнительные интерфейсы, производные от IPersist.</span><span class="sxs-lookup"><span data-stu-id="0ffde-151">The **IFilter** interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but can implement additional IPersist-derived interfaces.</span></span>

| <span data-ttu-id="0ffde-152">Интерфейс COM</span><span class="sxs-lookup"><span data-stu-id="0ffde-152">COM interface</span></span>                                                                             | <span data-ttu-id="0ffde-153">Метод</span><span class="sxs-lookup"><span data-stu-id="0ffde-153">Method</span></span>                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="0ffde-154">Интерфейс IClassFactory</span><span class="sxs-lookup"><span data-stu-id="0ffde-154">IClassFactory Interface</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)   | <span data-ttu-id="0ffde-155">CreateInstance, Локксервер</span><span class="sxs-lookup"><span data-stu-id="0ffde-155">CreateInstance, LockServer</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="0ffde-156">Интерфейс IClassFactory2</span><span class="sxs-lookup"><span data-stu-id="0ffde-156">IClassFactory2 Interface</span></span>](/windows/win32/api/ocidl/nn-ocidl-iclassfactory2)  | <span data-ttu-id="0ffde-157">ЖетлиЦинфо, Рекуестликкэй, Креатеинстанцелик</span><span class="sxs-lookup"><span data-stu-id="0ffde-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="0ffde-158">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="0ffde-158">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)                                                        | <span data-ttu-id="0ffde-159">[**IFilter:: init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::**](/windows/win32/api/filter/nf-filter-ifilter-getchunk)GetText, [**IFilter:: GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter:: GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter:: биндрегион**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span><span class="sxs-lookup"><span data-stu-id="0ffde-159">[**IFilter::Init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter::GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter::BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span></span> |
| [<span data-ttu-id="0ffde-160">Интерфейс IPersist</span><span class="sxs-lookup"><span data-stu-id="0ffde-160">IPersist Interface</span></span>](/windows/desktop/api/objidl/nn-objidl-ipersist)               | <span data-ttu-id="0ffde-161">GetClassID</span><span class="sxs-lookup"><span data-stu-id="0ffde-161">GetClassID</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="0ffde-162">Интерфейс IPersistFile</span><span class="sxs-lookup"><span data-stu-id="0ffde-162">IPersistFile Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)    | <span data-ttu-id="0ffde-163">IsDirty, Load, Save, Савекомплетед, Жеткурфиле</span><span class="sxs-lookup"><span data-stu-id="0ffde-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span></span>                                                                                                                                                                                                                                 |
| [<span data-ttu-id="0ffde-164">Интерфейс Иперсистстораже</span><span class="sxs-lookup"><span data-stu-id="0ffde-164">IPersistStorage Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststorage) | <span data-ttu-id="0ffde-165">IsDirty, Load, Save, Жетсиземакс</span><span class="sxs-lookup"><span data-stu-id="0ffde-165">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="0ffde-166">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="0ffde-166">IPersistStream</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststream)            | <span data-ttu-id="0ffde-167">IsDirty, Load, Save, Жетсиземакс</span><span class="sxs-lookup"><span data-stu-id="0ffde-167">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |

<span data-ttu-id="0ffde-168">На странице ссылки для каждого метода указаны параметры и поведение для этого метода.</span><span class="sxs-lookup"><span data-stu-id="0ffde-168">The reference page for each method specifies the parameters and functional behavior for that method.</span></span> <span data-ttu-id="0ffde-169">Каждая эталонная страница также предоставляет коды результатов для реализации этого метода.</span><span class="sxs-lookup"><span data-stu-id="0ffde-169">Each reference page also gives the result codes to implement for that method.</span></span> <span data-ttu-id="0ffde-170">Справочные страницы для методов [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) предоставляют коды, зависящие от интерфейса, [в \_ итфах](../com/codes-in-facility-itf.md) результатов, которые должны быть реализованы, а клиент индексирования содержимого также может обрабатывать любые общие коды результатов, такие как устройства \_ null и устройства \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="0ffde-170">The reference pages for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) methods give the interface-specific [Codes in FACILITY\_ITF](../com/codes-in-facility-itf.md) result codes to be implemented, and the content-indexing client can also handle any of the generic result codes, such as FACILITY\_NULL and FACILITY\_WIN32.</span></span> <span data-ttu-id="0ffde-171">Дополнительные сведения см. в разделе [структура кодов ошибок COM](../com/structure-of-com-error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="0ffde-171">For more information, see [Structure of COM Error Codes](../com/structure-of-com-error-codes.md).</span></span>

### <a name="com-methods-that-are-not-implemented"></a><span data-ttu-id="0ffde-172">Нереализованные методы COM</span><span class="sxs-lookup"><span data-stu-id="0ffde-172">COM Methods that are not Implemented</span></span>

<span data-ttu-id="0ffde-173">Интерфейс [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) должен реализовывать по меньшей мере [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), но не должен реализовывать дополнительные интерфейсы, производные от IPersist.</span><span class="sxs-lookup"><span data-stu-id="0ffde-173">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but does not need to implement additional IPersist-derived interfaces.</span></span>

<span data-ttu-id="0ffde-174">Поиску Windows не требуется реализовывать методы COM, перечисленные в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="0ffde-174">Windows Search does not need to implement the COM methods listed in the following table.</span></span>

| <span data-ttu-id="0ffde-175">Необязательный метод</span><span class="sxs-lookup"><span data-stu-id="0ffde-175">Method that is not required</span></span>                               | <span data-ttu-id="0ffde-176">Описание</span><span class="sxs-lookup"><span data-stu-id="0ffde-176">Description</span></span>                       |
|-----------------------------------------------------------|-----------------------------------|
| <span data-ttu-id="0ffde-177">IPersistStream:: IsDirty</span><span class="sxs-lookup"><span data-stu-id="0ffde-177">IPersistStream::IsDirty</span></span>                                   | <span data-ttu-id="0ffde-178">Фильтры должны возвращать E \_ нотимпл.</span><span class="sxs-lookup"><span data-stu-id="0ffde-178">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="0ffde-179">IPersistStream:: Save</span><span class="sxs-lookup"><span data-stu-id="0ffde-179">IPersistStream::Save</span></span>                                      | <span data-ttu-id="0ffde-180">Фильтры должны возвращать E \_ нотимпл.</span><span class="sxs-lookup"><span data-stu-id="0ffde-180">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="0ffde-181">IPersistStream:: Жетсиземакс</span><span class="sxs-lookup"><span data-stu-id="0ffde-181">IPersistStream::GetSizeMax</span></span>                                | <span data-ttu-id="0ffde-182">Фильтры должны возвращать E \_ нотимпл.</span><span class="sxs-lookup"><span data-stu-id="0ffde-182">Filters should return E\_NOTIMPL.</span></span> |
| [<span data-ttu-id="0ffde-183">**IFilter:: Биндрегион**</span><span class="sxs-lookup"><span data-stu-id="0ffde-183">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="0ffde-184">Фильтры должны возвращать E \_ нотимпл.</span><span class="sxs-lookup"><span data-stu-id="0ffde-184">Filters should return E\_NOTIMPL.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="0ffde-185">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="0ffde-185">Additional Resources</span></span>

- <span data-ttu-id="0ffde-186">Пример кода [ифилтерсампле](-search-sample-ifiltersample.md) , доступный на [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), демонстрирует создание базового класса IFilter для реализации интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="0ffde-186">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="0ffde-187">Общие сведения о процессе индексирования см. [в разделе процесс индексирования](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0ffde-187">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="0ffde-188">Общие сведения о типах файлов см. в разделе [типы файлов](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="0ffde-188">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="0ffde-189">Сведения о запросе атрибутов сопоставления файлов для типа файлов см. в разделе [перцеиведтипес, системфилеассоЦиатионс и регистрация приложения](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="0ffde-189">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="0ffde-190">См. также</span><span class="sxs-lookup"><span data-stu-id="0ffde-190">Related topics</span></span>

[<span data-ttu-id="0ffde-191">Разработка обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="0ffde-191">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="0ffde-192">Основные сведения о обработчиках фильтров в поиске Windows</span><span class="sxs-lookup"><span data-stu-id="0ffde-192">Understanding Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="0ffde-193">Рекомендации по созданию обработчиков фильтров в поиске Windows</span><span class="sxs-lookup"><span data-stu-id="0ffde-193">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="0ffde-194">Возвращение свойств из обработчика фильтра</span><span class="sxs-lookup"><span data-stu-id="0ffde-194">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="0ffde-195">Обработчики фильтров, поставляемые с Windows</span><span class="sxs-lookup"><span data-stu-id="0ffde-195">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="0ffde-196">Регистрация обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="0ffde-196">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="0ffde-197">Тестирование обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="0ffde-197">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
