---
description: С помощью компонентов API уведомления можно уведомлять индексатор о том, что элемент был изменен, перемещен или удален, и может добавлять области поиска в очередь URL-адресов индексатора поиска Windows, для которых требуется индексирование.
ms.assetid: 817550e2-a256-48d5-9fa6-1ea04f8b8589
title: Уведомление индекса изменений (Поиск Windows)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5a89112da20c4010e1fc23fab16778309195d20
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144179"
---
# <a name="notifying-the-index-of-changes-windows-search"></a><span data-ttu-id="2ae96-103">Уведомление индекса изменений (Поиск Windows)</span><span class="sxs-lookup"><span data-stu-id="2ae96-103">Notifying the Index of Changes (Windows Search)</span></span>

<span data-ttu-id="2ae96-104">С помощью компонентов API уведомления можно уведомлять индексатор о том, что элемент был изменен, перемещен или удален, и может добавлять области поиска в очередь URL-адресов индексатора поиска Windows, для которых требуется индексирование.</span><span class="sxs-lookup"><span data-stu-id="2ae96-104">By using the notification APIs components can notify the indexer that an item has been changed, moved or deleted, and can add search scopes to the Windows Search indexer's queue of URLs that require indexing.</span></span>

<span data-ttu-id="2ae96-105">Компоненты могут уведомлять индексатор службы поиска Windows об изменении данных в их хранилище.</span><span class="sxs-lookup"><span data-stu-id="2ae96-105">Components can notify the Windows Search indexer that data in their store has changed.</span></span> <span data-ttu-id="2ae96-106">Как правило, можно полагаться на запланированные обходные сканирование индексатора.</span><span class="sxs-lookup"><span data-stu-id="2ae96-106">Typically, you can rely on the indexer's scheduled crawls.</span></span> <span data-ttu-id="2ae96-107">Однако предоставление уведомлений индексатору может повысить производительность, гарантируя, что индексатор не будет выполнять сканирование всего хранилища по добавочным индексам.</span><span class="sxs-lookup"><span data-stu-id="2ae96-107">However, providing notifications to the indexer can improve performance by ensuring the indexer doesn't crawl the entire store on incremental indexes.</span></span> <span data-ttu-id="2ae96-108">Например, это может быть рекомендовано, если вы ожидаете, что хранилище данных будет очень большим и/или сильно загруженным, например хранилищем данных электронной почты, например.</span><span class="sxs-lookup"><span data-stu-id="2ae96-108">For example, this might recommended if you expect your data store to be exceptionally large and/or exceptionally busy, such as an email data store for example.</span></span>

-   [<span data-ttu-id="2ae96-109">Реализация уведомлений, управляемых индексатором</span><span class="sxs-lookup"><span data-stu-id="2ae96-109">Implementing Indexer-managed Notifications</span></span>](#implementing-indexer-managed-notifications)
    -   [<span data-ttu-id="2ae96-110">Очередь уведомлений</span><span class="sxs-lookup"><span data-stu-id="2ae96-110">Notifications Queue</span></span>](#notifications-queue)
    -   [<span data-ttu-id="2ae96-111">исеарчперсистентитемсчанжедсинк</span><span class="sxs-lookup"><span data-stu-id="2ae96-111">ISearchPersistentItemsChangedSink</span></span>](#isearchpersistentitemschangedsink)
-   [<span data-ttu-id="2ae96-112">Реализация уведомлений, управляемых поставщиком</span><span class="sxs-lookup"><span data-stu-id="2ae96-112">Implementing Provider-managed Notifications</span></span>](#implementing-provider-managed-notifications)
    -   [<span data-ttu-id="2ae96-113">Очередь уведомлений</span><span class="sxs-lookup"><span data-stu-id="2ae96-113">Notifications Queue</span></span>](#notifications-queue)
    -   [<span data-ttu-id="2ae96-114">исеарчитемсчанжедсинк</span><span class="sxs-lookup"><span data-stu-id="2ae96-114">ISearchItemsChangedSink</span></span>](#isearchitemschangedsink)
    -   [<span data-ttu-id="2ae96-115">исеарчнотифинлинесите</span><span class="sxs-lookup"><span data-stu-id="2ae96-115">ISearchNotifyInlineSite</span></span>](#isearchnotifyinlinesite)
-   [<span data-ttu-id="2ae96-116">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="2ae96-116">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="2ae96-117">См. также</span><span class="sxs-lookup"><span data-stu-id="2ae96-117">Related topics</span></span>](#related-topics)

## <a name="implementing-indexer-managed-notifications"></a><span data-ttu-id="2ae96-118">Реализация уведомлений, управляемых индексатором</span><span class="sxs-lookup"><span data-stu-id="2ae96-118">Implementing Indexer-managed Notifications</span></span>

<span data-ttu-id="2ae96-119">Уведомления, управляемые индексатором, позволяют управлять доступом к хранилищу данных, в то же время освобождая очередь уведомлений в течение всего процесса индексирования.</span><span class="sxs-lookup"><span data-stu-id="2ae96-119">Indexer-managed notifications enable you to control access to your data store while freeing you of maintaining the notifications queue throughout the entire indexing process.</span></span> <span data-ttu-id="2ae96-120">Поставщик уведомлений должен отслеживать изменения в хранилище данных и создавать очередь уведомлений.</span><span class="sxs-lookup"><span data-stu-id="2ae96-120">Your notifications provider must monitor changes to the data store and create a notifications queue.</span></span> <span data-ttu-id="2ae96-121">Периодически поставщик отправляет пакет уведомлений об изменениях в индексатор.</span><span class="sxs-lookup"><span data-stu-id="2ae96-121">Periodically, your provider sends a batch of change notifications to the indexer.</span></span> <span data-ttu-id="2ae96-122">Когда индексатор получает уведомления, он возвращает подтверждение, и вы можете удалить элементы из очереди.</span><span class="sxs-lookup"><span data-stu-id="2ae96-122">When the indexer receives your notifications, it returns an acknowledgement and you can remove the item(s) from your queue.</span></span> <span data-ttu-id="2ae96-123">Если по истечении определенного периода времени вы не получаете подтверждение, вы можете повторно отправить уведомления.</span><span class="sxs-lookup"><span data-stu-id="2ae96-123">If after a period of time you do not receive an acknowledgement, you can re-send the notifications.</span></span> <span data-ttu-id="2ae96-124">В случае сбоя индексатор перестраивает внутреннюю очередь элементов для сканирования или выполняет добавочное сканирование хранилища.</span><span class="sxs-lookup"><span data-stu-id="2ae96-124">In case of failure, the indexer rebuilds its internal queue of items to crawl or performs an incremental crawl of the store.</span></span>

<span data-ttu-id="2ae96-125">Для реализации уведомлений, управляемых индексатором, необходимо реализовать следующее:</span><span class="sxs-lookup"><span data-stu-id="2ae96-125">To implement indexer-managed notifications, you need to implement the following:</span></span>

-   <span data-ttu-id="2ae96-126">Механизм мониторинга изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="2ae96-126">A mechanism for monitoring changes in your data store.</span></span>
-   <span data-ttu-id="2ae96-127">Структура данных для постановки в очередь информации (несколько структур [**\_ \_ постоянных \_ изменений элементов поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_persistent_change) ) об этих изменениях.</span><span class="sxs-lookup"><span data-stu-id="2ae96-127">A data structure to queue up information (multiple [**SEARCH\_ITEM\_PERSISTENT\_CHANGE**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_persistent_change) structures) about those changes.</span></span>
-   <span data-ttu-id="2ae96-128">Интерфейс [**исеарчперсистентитемсчанжедсинк**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink) для отправки уведомлений в индексатор и получения подтверждений уведомлений от индексатора.</span><span class="sxs-lookup"><span data-stu-id="2ae96-128">[**ISearchPersistentItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink) interface to send your notifications to the indexer and to get notification acknowledgements from the indexer.</span></span>

### <a name="notifications-queue"></a><span data-ttu-id="2ae96-129">Очередь уведомлений</span><span class="sxs-lookup"><span data-stu-id="2ae96-129">Notifications Queue</span></span>

<span data-ttu-id="2ae96-130">Для отправки в индексатор в качестве уведомления необходимо отслеживать и ставить в очередь все изменения в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="2ae96-130">You need to monitor and queue up every change in your data store to send to the indexer as a notification.</span></span> <span data-ttu-id="2ae96-131">Количество уведомлений, которые вы помещаете в очередь и как часто их отправляют в индексатор, зависит от вашего обстоятельств.</span><span class="sxs-lookup"><span data-stu-id="2ae96-131">How many notifications you queue up and how frequently you send them to the indexer depends on your circumstance.</span></span> <span data-ttu-id="2ae96-132">Возможно, вы отправляете пакет уведомлений для каждых *n* изменений или после некоторого интервала времени *t* или сочетание двух.</span><span class="sxs-lookup"><span data-stu-id="2ae96-132">Perhaps you send a batch of notifications for every *n* number of changes or after some *t* time interval, or a combination of the two.</span></span>

<span data-ttu-id="2ae96-133">Индексатор предполагает, что уведомления поступают в массив [**\_ \_ сохраненных структур \_ изменений элемента поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_persistent_change) , поэтому вы можете выбрать подобную реализацию очереди.</span><span class="sxs-lookup"><span data-stu-id="2ae96-133">The indexer expects the notifications to come in an array of [**SEARCH\_ITEM\_PERSISTENT\_CHANGE**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_persistent_change) structures, so you may choose to implement your queue similarly.</span></span>

### <a name="isearchpersistentitemschangedsink"></a><span data-ttu-id="2ae96-134">исеарчперсистентитемсчанжедсинк</span><span class="sxs-lookup"><span data-stu-id="2ae96-134">ISearchPersistentItemsChangedSink</span></span>

<span data-ttu-id="2ae96-135">Для доступа к этому интерфейсу сначала создается объект [**исеарчманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchmanager) для получения доступа к объекту [**исеарчкаталогманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) .</span><span class="sxs-lookup"><span data-stu-id="2ae96-135">To access this interface, you first instantiate an [**ISearchManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchmanager) object to gain access to an [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) object.</span></span> <span data-ttu-id="2ae96-136">Из этого объекта **исеарчкаталогманажер** создается экземпляр объекта [**исеарчперсистентитемсчанжедсинк**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink) и уведомляется об изменении индексатора данных с помощью вызова метода **онитемсчанжед** .</span><span class="sxs-lookup"><span data-stu-id="2ae96-136">From that **ISearchCatalogManager** object, you instantiate an [**ISearchPersistentItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink) object and notify the indexer of the data changes with a call to the **OnItemsChanged** method.</span></span>

<span data-ttu-id="2ae96-137">При вызове этого метода вы включаете число сообщаемых изменений и массив [**\_ \_ сохраненных структур \_ изменений элемента поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_persistent_change) .</span><span class="sxs-lookup"><span data-stu-id="2ae96-137">In the call to this method, you include the number of changes being reported and an array of [**SEARCH\_ITEM\_PERSISTENT\_CHANGE**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_persistent_change) structures.</span></span> <span data-ttu-id="2ae96-138">Вы получаете массив кодов завершения HR, указывающий, был ли каждый URL-адрес принят для индексирования.</span><span class="sxs-lookup"><span data-stu-id="2ae96-138">You get back an array of HR completion codes indicating whether each URL was accepted for indexing.</span></span> <span data-ttu-id="2ae96-139">Это подтверждение от индексатора.</span><span class="sxs-lookup"><span data-stu-id="2ae96-139">This is your acknowledgement from the indexer.</span></span>

## <a name="implementing-provider-managed-notifications"></a><span data-ttu-id="2ae96-140">Реализация уведомлений, управляемых поставщиком</span><span class="sxs-lookup"><span data-stu-id="2ae96-140">Implementing Provider-managed Notifications</span></span>

<span data-ttu-id="2ae96-141">Уведомления, управляемые поставщиком, позволяют управлять доступом к хранилищу данных и отслеживать ход работы индексатора при обновлении каталога Windows Search.</span><span class="sxs-lookup"><span data-stu-id="2ae96-141">Provider-managed notifications enable you to control access to your data store and to monitor the progress of the indexer as it updates the Windows Search catalog.</span></span> <span data-ttu-id="2ae96-142">Поставщик должен отслеживать изменения в хранилище данных и создавать очередь уведомлений.</span><span class="sxs-lookup"><span data-stu-id="2ae96-142">Your provider must monitor changes to the data store and create a notifications queue.</span></span> <span data-ttu-id="2ae96-143">Периодически поставщик отправляет пакет уведомлений об изменениях в индексатор.</span><span class="sxs-lookup"><span data-stu-id="2ae96-143">Periodically, your provider sends a batch of change notifications to the indexer.</span></span> <span data-ttu-id="2ae96-144">Когда индексатор получает уведомления, он возвращает подтверждение.</span><span class="sxs-lookup"><span data-stu-id="2ae96-144">When the indexer receives your notifications, it returns an acknowledgement.</span></span> <span data-ttu-id="2ae96-145">Если по истечении определенного периода времени вы не получаете подтверждение, вы можете повторно отправить уведомления.</span><span class="sxs-lookup"><span data-stu-id="2ae96-145">If after a period of time you do not receive an acknowledgement, you can re-send the notifications.</span></span> <span data-ttu-id="2ae96-146">Когда индексатор выполняет сканирование хранилища данных и обновляет каталог Windows Search, он уведомляет поставщика о каждом обновлении каталога и вы можете удалить эти элементы из очереди.</span><span class="sxs-lookup"><span data-stu-id="2ae96-146">As the indexer crawls the data store and updates the Windows Search catalog, it notifies your provider of each catalog update and you can remove the item(s) from your queue.</span></span> <span data-ttu-id="2ae96-147">Ваш поставщик хранит свою очередь уведомлений на протяжении всего процесса, поэтому в случае сбоя можно повторно отправить уведомления индексатору.</span><span class="sxs-lookup"><span data-stu-id="2ae96-147">Your provider maintains its notification queue throughout this process so that in case of failure, you can resend notifications to the indexer.</span></span>

<span data-ttu-id="2ae96-148">Чтобы реализовать управляемые поставщиком уведомления, необходимо реализовать следующее:</span><span class="sxs-lookup"><span data-stu-id="2ae96-148">To implement provider-managed notifications, you need to implement the following:</span></span>

-   <span data-ttu-id="2ae96-149">Механизм мониторинга изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="2ae96-149">A mechanism for monitoring changes in your data store.</span></span>
-   <span data-ttu-id="2ae96-150">Структура данных для постановки в очередь информации (нескольких структур [**\_ \_ изменения элементов поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_change) ) об этих изменениях.</span><span class="sxs-lookup"><span data-stu-id="2ae96-150">A data structure to queue up information (multiple [**SEARCH\_ITEM\_CHANGE**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_change) structures) about those changes.</span></span>
-   <span data-ttu-id="2ae96-151">Интерфейс [**исеарчитемсчанжедсинк**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) для отправки уведомлений в индексатор и получения подтверждений уведомлений от индексатора.</span><span class="sxs-lookup"><span data-stu-id="2ae96-151">[**ISearchItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) interface to send your notifications to the indexer and to get notification acknowledgements from the indexer.</span></span>
-   <span data-ttu-id="2ae96-152">Интерфейс [**исеарчнотифинлинесите**](/windows/desktop/api/Searchapi/nn-searchapi-isearchnotifyinlinesite) для получения обновлений о состоянии индексирования.</span><span class="sxs-lookup"><span data-stu-id="2ae96-152">[**ISearchNotifyInlineSite**](/windows/desktop/api/Searchapi/nn-searchapi-isearchnotifyinlinesite) interface to receive updates about the status of indexing.</span></span>

### <a name="notifications-queue"></a><span data-ttu-id="2ae96-153">Очередь уведомлений</span><span class="sxs-lookup"><span data-stu-id="2ae96-153">Notifications Queue</span></span>

<span data-ttu-id="2ae96-154">Для отправки в индексатор в качестве уведомления необходимо отслеживать и ставить в очередь все изменения в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="2ae96-154">You need to monitor and queue up every change in your data store to send to the indexer as a notification.</span></span> <span data-ttu-id="2ae96-155">Количество уведомлений, которые вы помещаете в очередь и как часто их отправляют в индексатор, зависит от вашего обстоятельств.</span><span class="sxs-lookup"><span data-stu-id="2ae96-155">How many notifications you queue up and how frequently you send them to the indexer depends on your circumstance.</span></span> <span data-ttu-id="2ae96-156">Возможно, вы отправляете пакет уведомлений для каждых *n* изменений или после некоторого интервала времени *t* или сочетание двух.</span><span class="sxs-lookup"><span data-stu-id="2ae96-156">Perhaps you send a batch of notifications for every *n* number of changes or after some *t* time interval, or a combination of the two.</span></span>

<span data-ttu-id="2ae96-157">Индексатор предполагает, что уведомления поступают в массив структур [**\_ \_ изменения элементов поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_change) , поэтому вы можете сохранить информацию об изменениях аналогичным образом.</span><span class="sxs-lookup"><span data-stu-id="2ae96-157">The indexer expects the notifications to come in an array of [**SEARCH\_ITEM\_CHANGE**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_change) structures, so you may choose to store change information similarly.</span></span> <span data-ttu-id="2ae96-158">Однако также необходимо иметь возможность сопоставлять уведомления, которые вы отправляете, с подтверждениями и обновлениями, возвращаемыми индексатором.</span><span class="sxs-lookup"><span data-stu-id="2ae96-158">However, you also need to be able to match the notifications you send with the acknowledgements and updates returned by the indexer.</span></span> <span data-ttu-id="2ae96-159">Также может потребоваться определить, сколько времени требуется для получения подтверждений, чтобы вы могли решить, следует ли повторно отправлять уведомления.</span><span class="sxs-lookup"><span data-stu-id="2ae96-159">You may also want to be able to detect how long it takes to get acknowledgements, so you can decide if/when to resend notifications.</span></span>

### <a name="isearchitemschangedsink"></a><span data-ttu-id="2ae96-160">исеарчитемсчанжедсинк</span><span class="sxs-lookup"><span data-stu-id="2ae96-160">ISearchItemsChangedSink</span></span>

<span data-ttu-id="2ae96-161">Для доступа к этому интерфейсу сначала создается объект [**исеарчманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchmanager) для получения доступа к объекту [**исеарчкаталогманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) .</span><span class="sxs-lookup"><span data-stu-id="2ae96-161">To access this interface, you first instantiate an [**ISearchManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchmanager) object to gain access to an [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) object.</span></span> <span data-ttu-id="2ae96-162">Из этого объекта **исеарчкаталогманажер** создается экземпляр объекта [**исеарчитемсчанжедсинк**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) и уведомляется об изменении индексатора данных с помощью вызова метода **онитемсчанжед** .</span><span class="sxs-lookup"><span data-stu-id="2ae96-162">From that **ISearchCatalogManager** object, you instantiate an [**ISearchItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) object and notify the indexer of the data changes with a call to the **OnItemsChanged** method.</span></span>

<span data-ttu-id="2ae96-163">В вызове этого метода вы включаете число сообщаемых изменений и массив структур [**\_ \_ изменения элементов поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_change) .</span><span class="sxs-lookup"><span data-stu-id="2ae96-163">In the call to this method, you include the number of changes being reported and an array of [**SEARCH\_ITEM\_CHANGE**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_change) structures.</span></span> <span data-ttu-id="2ae96-164">Вы получаете массив назначенных индексаторами ДоЦидс, которые представляют каждое изменение, а также массив кодов завершения HR, указывающих, был ли каждый URL-адрес принят для индексирования.</span><span class="sxs-lookup"><span data-stu-id="2ae96-164">You get back an array of indexer-assigned DocIds that represent each change as well as an array of HR completion codes indicating whether each URL was accepted for indexing.</span></span> <span data-ttu-id="2ae96-165">Это подтверждение от индексатора, который получил ваши уведомления, и готовится к индексированию элементов.</span><span class="sxs-lookup"><span data-stu-id="2ae96-165">This is your acknowledgement from the indexer that it has received your notifications and is preparing to index the items.</span></span>

<span data-ttu-id="2ae96-166">С этого момента индексатор отправляет обновления с помощью интерфейса [**исеарчнотифинлинесите**](/windows/desktop/api/Searchapi/nn-searchapi-isearchnotifyinlinesite) .</span><span class="sxs-lookup"><span data-stu-id="2ae96-166">From that point forward the indexer sends updates using the [**ISearchNotifyInlineSite**](/windows/desktop/api/Searchapi/nn-searchapi-isearchnotifyinlinesite) interface.</span></span>

### <a name="isearchnotifyinlinesite"></a><span data-ttu-id="2ae96-167">исеарчнотифинлинесите</span><span class="sxs-lookup"><span data-stu-id="2ae96-167">ISearchNotifyInlineSite</span></span>

<span data-ttu-id="2ae96-168">Чтобы получать обновления о состоянии элементов и каталога, необходимо зарегистрировать интерфейс [**исеарчнотифинлинесите**](/windows/desktop/api/Searchapi/nn-searchapi-isearchnotifyinlinesite) с помощью индексатора, чтобы он мог отправить ответные вызовы.</span><span class="sxs-lookup"><span data-stu-id="2ae96-168">In order to get updates about the status of both your items and the catalog, you must register your [**ISearchNotifyInlineSite**](/windows/desktop/api/Searchapi/nn-searchapi-isearchnotifyinlinesite) interface with the indexer so it can send you callbacks.</span></span> <span data-ttu-id="2ae96-169">Каждое обновление, отправленное с помощью [**исеарчнотифинлинесите:: онитеминдекседстатусчанже**](/windows/desktop/api/Searchapi/nf-searchapi-isearchnotifyinlinesite-onitemindexedstatuschange) , определяет элементы по DocId, состояние каждого элемента [**( \_ \_ \_ Состояние индексирования элемента поиска**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_indexing_status)) и фазу индексирования ([**\_ \_ этап индексирования поиска**](/windows/desktop/api/Searchapi/ne-searchapi-search_indexing_phase)), в которых находятся элементы.</span><span class="sxs-lookup"><span data-stu-id="2ae96-169">Each update sent using [**ISearchNotifyInlineSite::OnItemIndexedStatusChange**](/windows/desktop/api/Searchapi/nf-searchapi-isearchnotifyinlinesite-onitemindexedstatuschange) identifies the items by DocId, the status of each item ([**SEARCH\_ITEM\_INDEXING\_STATUS**](/windows/desktop/api/Searchapi/ns-searchapi-search_item_indexing_status)) and the indexing phase ([**SEARCH\_INDEXING\_PHASE**](/windows/desktop/api/Searchapi/ne-searchapi-search_indexing_phase)) the items are in.</span></span>

<span data-ttu-id="2ae96-170">Не только вы получаете обновления состояния каждого элемента, как описано выше, также получаете важные сведения о состоянии самого каталога.</span><span class="sxs-lookup"><span data-stu-id="2ae96-170">Not only do you receive updates on the status of each item, as described earlier, you also get important information about the status of the catalog itself.</span></span> <span data-ttu-id="2ae96-171">Служба Windows Search может быть прервана или перезапущена конечным пользователем, сторонним приложением или другим сбоем.</span><span class="sxs-lookup"><span data-stu-id="2ae96-171">The Windows Search service can be interrupted or restarted by the end user, a third party application, or some other failure.</span></span> <span data-ttu-id="2ae96-172">В этом случае вам нужен способ определить, какие уведомления следует отправить в индексатор.</span><span class="sxs-lookup"><span data-stu-id="2ae96-172">When this happens, you need a way to determine what notifications to repush to the indexer.</span></span>

<span data-ttu-id="2ae96-173">Метод [**исеарчнотифинлинесите:: онкаталогстатусчанже**](/windows/desktop/api/Searchapi/nf-searchapi-isearchnotifyinlinesite-oncatalogstatuschange) , вызываемый службой поиска Windows, информирует клиентов о состоянии каталога, используя параметры, описанные в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="2ae96-173">The [**ISearchNotifyInlineSite::OnCatalogStatusChange**](/windows/desktop/api/Searchapi/nf-searchapi-isearchnotifyinlinesite-oncatalogstatuschange) method, called by the Windows Search service, informs clients about the status of the catalog using the parameters described in the following table.</span></span>



| <span data-ttu-id="2ae96-174">Параметр</span><span class="sxs-lookup"><span data-stu-id="2ae96-174">Parameter</span></span>                 | <span data-ttu-id="2ae96-175">Описание</span><span class="sxs-lookup"><span data-stu-id="2ae96-175">Description</span></span>                                                                                                                                           |
|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2ae96-176">гуидкаталогресетсигнатуре</span><span class="sxs-lookup"><span data-stu-id="2ae96-176">guidCatalogResetSignature</span></span> | <span data-ttu-id="2ae96-177">Идентификатор GUID, представляющий Сброс каталога.</span><span class="sxs-lookup"><span data-stu-id="2ae96-177">A GUID representing the catalog reset.</span></span> <span data-ttu-id="2ae96-178">При изменении этого идентификатора GUID необходимо повторно отправить все уведомления.</span><span class="sxs-lookup"><span data-stu-id="2ae96-178">If this GUID changes, all notifications must be resent.</span></span>                                                        |
| <span data-ttu-id="2ae96-179">гуидчеккпоинтсигнатуре</span><span class="sxs-lookup"><span data-stu-id="2ae96-179">guidCheckPointSignature</span></span>   | <span data-ttu-id="2ae96-180">Идентификатор GUID, представляющий последнюю восстановленную контрольную точку.</span><span class="sxs-lookup"><span data-stu-id="2ae96-180">A GUID representing the last checkpoint restored.</span></span> <span data-ttu-id="2ae96-181">При изменении этого идентификатора GUID все уведомления, накопленные с момента последней сохраненной контрольной точки, должны быть повторно отправлены.</span><span class="sxs-lookup"><span data-stu-id="2ae96-181">If this GUID changes, all notifications accumulated since the last saved checkpoint must be resent.</span></span> |
| <span data-ttu-id="2ae96-182">двластчеккпоинтнумбер</span><span class="sxs-lookup"><span data-stu-id="2ae96-182">dwLastCheckPointNumber</span></span>    | <span data-ttu-id="2ae96-183">Число, указывающее последнюю сохраненную контрольную точку.</span><span class="sxs-lookup"><span data-stu-id="2ae96-183">A number indicating the last checkpoint saved.</span></span>                                                                                                        |



 

 

<span data-ttu-id="2ae96-184">При возникновении контрольной точки каталога Служба поиска обновляет *двластчеккпоинтнумбер*, а все уведомления, отправленные до этой контрольной точки, являются надежными и восстанавливаемыми в случае сбоя службы.</span><span class="sxs-lookup"><span data-stu-id="2ae96-184">When a catalog checkpoint occurs, the search service updates the *dwLastCheckPointNumber*, and all notifications sent prior to that checkpoint are safe and recoverable in the event of a service failure.</span></span> <span data-ttu-id="2ae96-185">Поставщики уведомлений должны отслеживании только тех уведомлений, которые передаются между контрольными точками и принудительной отправкой при восстановлении или сбросе каталога.</span><span class="sxs-lookup"><span data-stu-id="2ae96-185">Notifications providers need to track only those notifications sent between checkpoints and repush in case of a catalog restore or reset.</span></span>

<span data-ttu-id="2ae96-186">Если выполняется восстановление каталога, служба поиска выполняет откат каталога к последней сохраненной контрольной точке и обновляет *гуидчеккпоинтсигнатуре*.</span><span class="sxs-lookup"><span data-stu-id="2ae96-186">If a catalog restore occurs, the search service rolls back the catalog to the last saved checkpoint and updates the *guidCheckPointSignature*.</span></span> <span data-ttu-id="2ae96-187">В этом случае поставщики уведомлений должны переотправить все уведомления, накопленные с момента последней сохраненной контрольной точки, как определено в *двластчеккпоинтнумбер*.</span><span class="sxs-lookup"><span data-stu-id="2ae96-187">In this situation, notifications providers must repush all notifications accumulated since the most recent saved checkpoint as identified by the *dwLastCheckPointNumber*.</span></span>

<span data-ttu-id="2ae96-188">Если должен произойти Сброс каталога, служба поиска сбрасывает весь каталог и обновляет *гуидкаталогресетсигнатуре*.</span><span class="sxs-lookup"><span data-stu-id="2ae96-188">If a catalog reset should occur, the search service resets the entire catalog and updates the *guidCatalogResetSignature*.</span></span> <span data-ttu-id="2ae96-189">Поставщик уведомлений должен снова отправить всю область сканирования.</span><span class="sxs-lookup"><span data-stu-id="2ae96-189">Notifications provider must repush its entire crawl scope again.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="2ae96-190">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="2ae96-190">Additional Resources</span></span>

-   <span data-ttu-id="2ae96-191">Общие сведения о процессе индексирования см. [в разделе процесс индексирования](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2ae96-191">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
-   <span data-ttu-id="2ae96-192">Обзоры диспетчера каталога и диспетчера поиска в каталоге (CSM) см. в разделе [Использование диспетчера каталогов](-search-3x-wds-mngidx-catalog-manager.md) и [диспетчера области сканирования](-search-3x-wds-extidx-csm.md).</span><span class="sxs-lookup"><span data-stu-id="2ae96-192">For overviews of the Catalog Manager and Catalog Search Manager (CSM), see [Using the Catalog Manager](-search-3x-wds-mngidx-catalog-manager.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>
-   <span data-ttu-id="2ae96-193">Сведения о создании хранилища данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2ae96-193">For information about creating a Shell data store, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="2ae96-194">См. также</span><span class="sxs-lookup"><span data-stu-id="2ae96-194">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="2ae96-195">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="2ae96-195">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="2ae96-196">Разработка обработчиков протоколов</span><span class="sxs-lookup"><span data-stu-id="2ae96-196">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)
</dt> <dt>

[<span data-ttu-id="2ae96-197">Основные сведения о обработчиках протоколов</span><span class="sxs-lookup"><span data-stu-id="2ae96-197">Understanding Protocol Handlers</span></span>](-search-3x-wds-extidx-prot-implementing.md)
</dt> <dt>

[<span data-ttu-id="2ae96-198">Добавление значков и контекстных меню</span><span class="sxs-lookup"><span data-stu-id="2ae96-198">Adding Icons and Context Menus</span></span>](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="2ae96-199">Пример кода: расширения оболочки для обработчиков протоколов</span><span class="sxs-lookup"><span data-stu-id="2ae96-199">Code Sample: Shell Extensions for Protocol Handlers</span></span>](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[<span data-ttu-id="2ae96-200">Установка и регистрация обработчиков протоколов</span><span class="sxs-lookup"><span data-stu-id="2ae96-200">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="2ae96-201">Создание соединителя поиска для обработчика протокола</span><span class="sxs-lookup"><span data-stu-id="2ae96-201">Creating a Search Connector for a Protocol Handler</span></span>](-search-3x-wds-ph-search-connector.md)
</dt> <dt>

[<span data-ttu-id="2ae96-202">Обработчики протокола отладки</span><span class="sxs-lookup"><span data-stu-id="2ae96-202">Debugging Protocol Handlers</span></span>](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
