---
description: Запрос процесса в Windows Search
ms.assetid: 0e5a633e-1703-4b72-8a04-6da71aec0ae2
title: Запрос процесса в Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3585f2cca2a6d5d8548a85ae8fac759ec94b4fa
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2021
ms.locfileid: "108117332"
---
# <a name="querying-process-in-windows-search"></a><span data-ttu-id="bf2fa-103">Запрос процесса в Windows Search</span><span class="sxs-lookup"><span data-stu-id="bf2fa-103">Querying Process in Windows Search</span></span>

<span data-ttu-id="bf2fa-104">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="bf2fa-105">О запросах в Windows Search</span><span class="sxs-lookup"><span data-stu-id="bf2fa-105">About Querying in Windows Search</span></span>](#about-querying-in-windows-search)
    -   [<span data-ttu-id="bf2fa-106">Локальные и удаленные запросы</span><span class="sxs-lookup"><span data-stu-id="bf2fa-106">Local and Remote Queries</span></span>](#local-and-remote-queries)
    -   [<span data-ttu-id="bf2fa-107">Общие сведения об API структурированных запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-107">Structured Query API Overview</span></span>](#structured-query-api-overview)
-   [<span data-ttu-id="bf2fa-108">Сценарии запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-108">Querying Scenarios</span></span>](#querying-scenarios)
    -   [<span data-ttu-id="bf2fa-109">Извлечение условий и синтаксический анализ запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-109">Condition Extraction and Query Parsing</span></span>](#condition-extraction-and-query-parsing)
    -   [<span data-ttu-id="bf2fa-110">Запрос индекса</span><span class="sxs-lookup"><span data-stu-id="bf2fa-110">Querying the Index</span></span>](#querying-the-index)
-   [<span data-ttu-id="bf2fa-111">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="bf2fa-111">Related topics</span></span>](#related-topics)

## <a name="about-querying-in-windows-search"></a><span data-ttu-id="bf2fa-112">О запросах в Windows Search</span><span class="sxs-lookup"><span data-stu-id="bf2fa-112">About Querying in Windows Search</span></span>

<span data-ttu-id="bf2fa-113">Запросы в Windows Search основаны на следующих четырех подходах:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-113">Querying in Windows Search is based on the following four approaches:</span></span>

-   <span data-ttu-id="bf2fa-114">[Расширенный синтаксис запросов](-search-3x-advancedquerysyntax.md) (АКС)</span><span class="sxs-lookup"><span data-stu-id="bf2fa-114">[Advanced Query Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span></span>
-   <span data-ttu-id="bf2fa-115">Синтаксис естественного запроса (НКС)</span><span class="sxs-lookup"><span data-stu-id="bf2fa-115">Natural Query Syntax (NQS)</span></span>
-   <span data-ttu-id="bf2fa-116">язык SQL</span><span class="sxs-lookup"><span data-stu-id="bf2fa-116">Structured Query Language (SQL)</span></span>
-   <span data-ttu-id="bf2fa-117">Интерфейсы структурированных запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-117">Structured query interfaces</span></span>

<span data-ttu-id="bf2fa-118">АКС — это синтаксис запроса по умолчанию, используемый службой поиска Windows для запроса индекса и уточнения и сужения параметров поиска.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-118">AQS is the default query syntax used by Windows Search to query the index and to refine and narrow search parameters.</span></span> <span data-ttu-id="bf2fa-119">АКС в основном используется для пользователя и может использоваться пользователями для создания запросов АКС, но может также использоваться разработчиками для программной сборки запросов.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-119">AQS is primarily user facing, and can be used by users to build AQS queries, but can also be used by developers to build queries programmatically.</span></span> <span data-ttu-id="bf2fa-120">В Windows 7 был введен канонический АКС, который должен использоваться для программного создания запросов АКС.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-120">In Windows 7, canonical AQS was introduced and must be used to programmatically generate AQS queries.</span></span> <span data-ttu-id="bf2fa-121">В Windows 7 и более поздних версиях параметр контекстного меню может быть доступен в зависимости от того, выполнено ли условие АКС.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-121">In Windows 7 and later, a shortcut menu option can be available based on whether an AQS condition is met.</span></span> <span data-ttu-id="bf2fa-122">Дополнительные сведения см. в разделе «получение динамического поведения для статических команд с помощью расширенного синтаксиса запросов» раздела [Создание обработчиков контекстного меню](../shell/context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-122">For more information, see "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" in [Creating Context Menu Handlers](../shell/context-menu-handlers.md).</span></span> <span data-ttu-id="bf2fa-123">Запросы АКС могут быть ограничены определенными типами файлов, которые называются типами файлов.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-123">AQS queries can be limited to specific types of files, which are known as file kinds.</span></span> <span data-ttu-id="bf2fa-124">Дополнительные сведения см. в разделе [типы файлов и ассоциации](../shell/fa-intro.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-124">For more information, see [File Types and Associations](../shell/fa-intro.md).</span></span> <span data-ttu-id="bf2fa-125">Справочную документацию по соответствующим свойствам см. в разделе [System. Kind](../properties/props-system-kind.md)и [System. киндтекст](../properties/props-system-kindtext.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-125">For reference documentation on the relevant properties, see [System.Kind](../properties/props-system-kind.md), and [System.KindText](../properties/props-system-kindtext.md).</span></span>

<span data-ttu-id="bf2fa-126">НКС — это синтаксис запроса, который является более ослабленным, чем АКС, и похож на естественный язык.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-126">NQS is a query syntax that is more relaxed than AQS, and is similar to human language.</span></span> <span data-ttu-id="bf2fa-127">НКС может использоваться службой поиска Windows для запроса индекса, если выбран параметр НКС, а не значение по умолчанию, АКС.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-127">NQS can be used by Windows Search to query the index if NQS is selected instead of the default, AQS.</span></span>

<span data-ttu-id="bf2fa-128">SQL — это язык текста, определяющий запросы.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-128">SQL is a text language that defines queries.</span></span> <span data-ttu-id="bf2fa-129">SQL является общим для различных технологий баз данных.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-129">SQL is common across many different database technologies.</span></span> <span data-ttu-id="bf2fa-130">Поиск Windows использует SQL, реализует его подмножество и расширяет его путем добавления элементов на язык.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-130">Windows Search uses SQL, implements a subset of it, and extends it by adding elements to the language.</span></span> <span data-ttu-id="bf2fa-131">SQL Search для Windows расширяет стандартный синтаксис запросов к базе данных SQL-92 и SQL-99, что позволяет повысить его полезность при поиске на основе текста.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-131">Windows Search SQL extends the standard SQL-92 and SQL-99 database query syntax to enhance its usefulness with text-based searches.</span></span> <span data-ttu-id="bf2fa-132">Все функции SQL службы поиска Windows совместимы с Windows Search в Windows XP и Windows Server 2003 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-132">All features of Windows Search SQL are compatible with Windows Search on Windows XP and Windows Server 2003, and later.</span></span> <span data-ttu-id="bf2fa-133">Дополнительные сведения о SQL Search см. в разделе [запрос индекса с помощью синтаксиса SQL для поиска Windows](-search-sql-windowssearch-entry.md)и [обзор синтаксиса SQL Search](-search-sql-ovwofsearchquery.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-133">For more information about Windows Search SQL, see [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md), and [Overview of Windows Search SQL Syntax](-search-sql-ovwofsearchquery.md).</span></span>

<span data-ttu-id="bf2fa-134">Интерфейсы API структурированных запросов описаны далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-134">The structured query APIs are described later in this topic.</span></span> <span data-ttu-id="bf2fa-135">Справочную документацию по API-интерфейсам структурированных запросов см. в разделе [запросы интерфейсов](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-135">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="bf2fa-136">Такие интерфейсы, как [**исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) , позволяют КОНСТРУИРОВАТЬ строки SQL из набора входных значений.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-136">Interfaces such as [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) help construct SQL strings from a set of input values.</span></span> <span data-ttu-id="bf2fa-137">Этот интерфейс преобразует запросы пользователей АКС в SQL Search в Windows и определяет ограничения запросов, которые могут быть выражены в SQL, но не в АКС.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-137">This interface converts AQS user queries to Windows Search SQL and specifies query restrictions that can be expressed in SQL but not in AQS.</span></span> <span data-ttu-id="bf2fa-138">[**Исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) также получает строку подключения OLE DB для подключения к базе данных Windows Search.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) also obtains an OLE DB connection string to connect to the Windows Search database.</span></span>

### <a name="local-and-remote-queries"></a><span data-ttu-id="bf2fa-139">Локальные и удаленные запросы</span><span class="sxs-lookup"><span data-stu-id="bf2fa-139">Local and Remote Queries</span></span>

<span data-ttu-id="bf2fa-140">Запросы можно выполнять как локально, так и удаленно.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-140">You can execute your queries either locally or remotely.</span></span> <span data-ttu-id="bf2fa-141">В следующем примере показан локальный запрос с [предложением from](-search-sql-from.md) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-141">A local query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="bf2fa-142">Локальный запрос запрашивает только локальный каталог Системиндекс.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-142">A local query queries the local SystemIndex catalog only.</span></span>


```
FROM SystemIndex
```



<span data-ttu-id="bf2fa-143">В следующем примере показан удаленный запрос с [предложением from](-search-sql-from.md) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-143">A remote query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="bf2fa-144">Добавление ComputerName преобразует предыдущий пример в удаленный запрос.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-144">Adding ComputerName transforms the previous example into a remote query.</span></span>


```
FROM [<ComputerName>.]SystemIndex
```



<span data-ttu-id="bf2fa-145">По умолчанию в Windows XP и Windows Server 2003 не установлен Windows Search.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-145">By default, Windows XP and Windows Server 2003 do not have Windows Search installed.</span></span> <span data-ttu-id="bf2fa-146">Только Windows Search 4 (WS4) предоставляет поддержку удаленного запроса.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-146">Only Windows Search 4 (WS4) provides remote query support.</span></span> <span data-ttu-id="bf2fa-147">Предыдущие версии Windows Desktop Search (WDS), например 3,01 и более ранних версий, не поддерживают удаленный запрос.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-147">Previous versions of Windows Desktop Search (WDS), such as 3.01 and earlier, do not support remote querying.</span></span> <span data-ttu-id="bf2fa-148">С помощью проводника Windows можно запрашивать локальный индекс удаленного компьютера для элементов файловой системы (элементы, обрабатываемые протоколом file:).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-148">With Windows Explorer you can query the local index of a remote computer for file system items (items handled by the "file:" protocol).</span></span>

<span data-ttu-id="bf2fa-149">Чтобы получить элемент по удаленному запросу, элемент должен удовлетворять следующим требованиям.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-149">To retrieve an item by remote query, the item must meet the following requirements:</span></span>

-   <span data-ttu-id="bf2fa-150">Быть доступным через UNC-путь.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-150">Be accessible via Universal Naming Convention (UNC) path.</span></span>
-   <span data-ttu-id="bf2fa-151">Существует на удаленном компьютере, к которому имеет доступ клиент.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-151">Exist on the remote computer to which the client has access.</span></span>
-   <span data-ttu-id="bf2fa-152">Имеет свой набор безопасности, позволяющий клиенту иметь доступ на чтение.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-152">Have its security set to allow the client to have Read access.</span></span>

<span data-ttu-id="bf2fa-153">В проводнике Windows есть функции для совместного использования элементов, включая общедоступный общий ресурс (общедоступный \\ \\ компьютер \\ \\ ...) в **центре управления сетями и общим доступом**, а также общий ресурс пользователей ( \\ \\ \\ пользователей компьютеров.. \\ .) для элементов, общих через мастер общего доступа.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-153">Windows Explorer has features for sharing items, including a "Public" share (\\\\Machine\\Public\\...) in the **Network and Sharing Center**, and a "Users" share (\\\\Machine\\Users\\...) for items shared via the Sharing Wizard.</span></span> <span data-ttu-id="bf2fa-154">После предоставления общего доступа к папкам можно запросить локальный индекс, указав имя компьютера удаленного компьютера в предложении FROM, и UNC-путь на удаленном компьютере в предложении SCOPE.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-154">After you share the folder(s), you can query the local index by specifying the remote computer's machine name in the FROM clause, and a UNC path on the remote computer in the SCOPE clause.</span></span> <span data-ttu-id="bf2fa-155">В следующем примере показан удаленный запрос, использующий предложения FROM и SCOPE.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-155">A remote query using the FROM and SCOPE clauses is shown in the following example.</span></span>


```
SELECT System.ItemName FROM MachineName.SystemIndex WHERE SCOPE='file://MachineName/<path>' 
```



<span data-ttu-id="bf2fa-156">В приведенных здесь примерах используется SQL.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-156">The examples provided here use SQL.</span></span>

### <a name="structured-query-api-overview"></a><span data-ttu-id="bf2fa-157">Общие сведения об API структурированных запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-157">Structured Query API Overview</span></span>

<span data-ttu-id="bf2fa-158">Структурированный запрос предоставляет возможность поиска информации по логическим комбинациям запросов по отдельным свойствам.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-158">A structured query provides the ability to search for information by Boolean combinations of queries over individual properties.</span></span> <span data-ttu-id="bf2fa-159">В этом разделе описаны функциональные возможности наиболее важных интерфейсов API и методов структурированных запросов.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-159">In this topic we outline the functionality of the most important structured query APIs and methods.</span></span> <span data-ttu-id="bf2fa-160">Справочную документацию по API-интерфейсам структурированных запросов см. в разделе [запросы интерфейсов](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-160">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span>

### <a name="iqueryparser"></a><span data-ttu-id="bf2fa-161">икуерипарсер</span><span class="sxs-lookup"><span data-stu-id="bf2fa-161">IQueryParser</span></span>

<span data-ttu-id="bf2fa-162">Метод [**икуерипарсер::P Арсе**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) анализирует входную строку пользователя и формирует интерпретацию в форме [**икуерисолутион**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-162">The [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method parses a user input string, and produces an interpretation in the form of an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span></span> <span data-ttu-id="bf2fa-163">Если параметр *пкустомпропертиес* этого метода не равен null, то это перечисление объектов [**ириччунк**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) (по одному для каждого распознанного пользовательского свойства).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-163">If the *pCustomProperties* parameter of that method is not null, then it is an enumeration of [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) objects(one for each recognized custom property).</span></span> <span data-ttu-id="bf2fa-164">Другие методы [**икуерипарсер**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) позволяют приложению задавать несколько параметров, таких как языковой стандарт, схема, средство разбиения по словам и обработчики для различных типов именованных сущностей.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-164">The other [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) methods permit the application to set several options, such as locale, a schema, a word breaker, and handlers for various types of named entities.</span></span> <span data-ttu-id="bf2fa-165">[**Икуерипарсер:: жетсчемапровидер**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) возвращает интерфейс [**исчемапровидер**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) для обзора загруженной схемы.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-165">[**IQueryParser::GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) returns an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface for browsing the loaded schema.</span></span>

### <a name="iquerysolution--iconditionfactory"></a><span data-ttu-id="bf2fa-166">Икуерисолутион: Икондитионфактори</span><span class="sxs-lookup"><span data-stu-id="bf2fa-166">IQuerySolution : IConditionFactory</span></span>

<span data-ttu-id="bf2fa-167">Интерфейс [**икуерисолутион**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) предоставляет всю информацию о результатах синтаксического анализа входной строки.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-167">The [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface provides all information about the result of parsing an input string.</span></span> <span data-ttu-id="bf2fa-168">Так как **икуерисолутион** также является интерфейсом [**икондитионфактори**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) , можно создавать дополнительные узлы дерева условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-168">Because **IQuerySolution** is also an [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) interface, additional condition tree nodes can be created.</span></span> <span data-ttu-id="bf2fa-169">Метод [**икуерисолутион::-Query**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) создает дерево условий для интерпретации.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-169">The [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) method produces a condition tree for the interpretation.</span></span> <span data-ttu-id="bf2fa-170">**Икуерисолутион::** также возвращает семантический тип.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-170">**IQuerySolution::GetQuery** also returns the semantic type.</span></span>

### <a name="iconditionfactory"></a><span data-ttu-id="bf2fa-171">икондитионфактори</span><span class="sxs-lookup"><span data-stu-id="bf2fa-171">IConditionFactory</span></span>

<span data-ttu-id="bf2fa-172">[**Икондитионфактори**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) создает узлы дерева условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) creates condition tree nodes.</span></span> <span data-ttu-id="bf2fa-173">Если параметр *упрощения* [**Икондитионфактори:: Макенот**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) имеет значение **Variant \_ true**, то результирующий [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) упрощен и не должен быть узлом отрицания.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-173">If the *simplify* parameter of [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) is **VARIANT\_TRUE**, then the resulting [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) is simplified, and need not be a negation node.</span></span> <span data-ttu-id="bf2fa-174">Если параметр *псубкондитионс* параметра [**Икондитионфактори:: макеандор**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) не равен null, то этот параметр должен быть перечислением объектов [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) и стать поддеревьями. [**Икондитионфактори:: макелеаф**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) конструирует конечный узел с указанным именем свойства, операцией и значением.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-174">If the *pSubConditions* parameter of [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) is not null, then that parameter should be an enumeration of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) objects, and become subtrees.[**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constructs a leaf node with a specified property name, operation, and value.</span></span> <span data-ttu-id="bf2fa-175">Строка в параметре *пвалуетипе* должна быть именем семантического типа из схемы.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-175">The string in the *pValueType* parameter should be the name of a semantic type from the schema.</span></span> <span data-ttu-id="bf2fa-176">Если параметр *expand* имеет значение **Variant \_ true** и свойство является виртуальным, то результирующее дерево условий обычно является отсоединением, полученным от расширения свойства до определенных составляющих.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-176">If the *expand* parameter is **VARIANT\_TRUE** and the property is virtual, the resulting condition tree is typically a disjunction resulting from expanding the property to its defined constituents.</span></span> <span data-ttu-id="bf2fa-177">Если значение не равно null, параметры *ппропертинаметерм*, *поператортерм* и *пвалуетерм* должны обозначать термины, указывающие свойство, операцию и значение.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-177">If not null, the *pPropertyNameTerm*, *pOperatorTerm*, and *pValueTerm* parameters should identify terms indicating the property, operation, and value.</span></span>

### <a name="icondition--ipersiststream"></a><span data-ttu-id="bf2fa-178">Икондитион: IPersistStream</span><span class="sxs-lookup"><span data-stu-id="bf2fa-178">ICondition : IPersistStream</span></span>

<span data-ttu-id="bf2fa-179">Интерфейс [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) — это отдельный узел в дереве условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-179">The [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface is a single node in a condition tree.</span></span> <span data-ttu-id="bf2fa-180">Узел может быть узлом отрицания, узлом, узлом или конечным узлом.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-180">The node can be a negation node, AND node, OR node, or a leaf node.</span></span> <span data-ttu-id="bf2fa-181">Для неоконечного узла [**икондитион:: жетсубкондитионс**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) возвращает перечисление поддеревьев.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-181">For a non-leaf node [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) returns an enumeration of the subtrees.</span></span> <span data-ttu-id="bf2fa-182">Для конечного узла следующие методы [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) возвращают следующие значения:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-182">For a leaf node the following methods of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) return the following values:</span></span>

-   <span data-ttu-id="bf2fa-183">[**Жеткомпарисонинфо**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) возвращает имя свойства, операцию и значение.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) returns the property name, operation, and value.</span></span>
-   <span data-ttu-id="bf2fa-184">Функция [**ValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) возвращает семантический тип значения, который был спеЦифиЦиед в параметре *псзвалуетипе* объекта [**икондитионфактори:: макелеаф**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) returns the semantic type of the value, which was specificied in the *pszValueType* parameter of [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span></span>
-   <span data-ttu-id="bf2fa-185">[**Жетвалуенормализатион**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) возвращает строковый формат значения.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) returns a string form of the value.</span></span> <span data-ttu-id="bf2fa-186">(Если значение было уже строкой, эта форма будет нормализована в зависимости от регистра, диакритических знаков и т. д.).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-186">(If the value was already a string, this form will be normalized with regard to case, accents, and so forth.)</span></span>
-   <span data-ttu-id="bf2fa-187">[**Жетинпуттермс**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) возвращает сведения о том, какие части входного предложения создали имя свойства, операцию и значение.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) returns information about which parts of the input sentence generated the property name, the operation, and the value.</span></span>
-   <span data-ttu-id="bf2fa-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) Возвращает глубокую копию дерева условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) returns a deep copy of a condition tree.</span></span>

### <a name="irichchunk"></a><span data-ttu-id="bf2fa-189">ириччунк</span><span class="sxs-lookup"><span data-stu-id="bf2fa-189">IRichChunk</span></span>

<span data-ttu-id="bf2fa-190">Каждый объект [**ириччунк**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) определяет диапазон токена и строку.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-190">Each [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) object identifies a token span and a string.</span></span> <span data-ttu-id="bf2fa-191">**Ириччунк** — это служебный интерфейс, который представляет сведения о диапазоне (обычно это диапазон токенов), определяемый начальной позицией и длиной.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-191">**IRichChunk** is a utility interface that represents information about a span (typically a span of tokens) identified by a starting position and length.</span></span> <span data-ttu-id="bf2fa-192">Эти сведения о диапазоне включают строку и (или) **вариант**.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-192">This span information includes a string and/or a **VARIANT**.</span></span>

### <a name="iconditiongenerator"></a><span data-ttu-id="bf2fa-193">икондитионженератор</span><span class="sxs-lookup"><span data-stu-id="bf2fa-193">IConditionGenerator</span></span>

<span data-ttu-id="bf2fa-194">Интерфейс [**икондитионженератор**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) предоставляется приложением для управления созданием дерева условий распознавания и условия для именованного типа сущности.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-194">The [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) interface is provided by the application to handle recognition and condition tree generation for a named entity type.</span></span> <span data-ttu-id="bf2fa-195">Генератор условий передается [**икуерипарсер**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) через [**Икуерипарсер:: сетмултиоптион**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-195">A condition generator is given to an [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) through [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span></span> <span data-ttu-id="bf2fa-196">[**Икуерипарсер**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) вызывает [**Икондитионженератор:: Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) с [**исчемапровидер**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) для текущей загруженной схемы.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) calls [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) with an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) for the currently loaded schema.</span></span> <span data-ttu-id="bf2fa-197">Это позволяет [**икондитионженератор**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) получить все необходимые сведения о схеме.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-197">Doing so permits [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) to obtain any schema information that is required.</span></span> <span data-ttu-id="bf2fa-198">При синтаксическом анализе входной строки **икуерипарсер** вызывает метод [**Икондитионженератор:: рекогнизенамедентитиес**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) каждого [**икондитионженератор**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), чтобы можно было сообщить о возникновении именованных сущностей, распознаваемых во входной строке.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-198">When parsing an input string, **IQueryParser** calls the [**IConditionGenerator::RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) method of each [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), so that the occurrence of named entities it recognizes in the input string can be reported.</span></span> <span data-ttu-id="bf2fa-199">**Икуерипарсер** может использовать текущий языковой стандарт и использовать разметку входных данных, так как они должны сообщать о диапазонах маркеров любых именованных сущностей.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-199">**IQueryParser** can make use of the current locale and should make use of the tokenization of the input as it needs to report the token spans of any named entities.</span></span>

<span data-ttu-id="bf2fa-200">Когда [**икуерипарсер**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) собирается выдать конечный узел, а семантический тип значения соответствует именованному типу сущности для [**икондитионженератор**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **Икуерипарсер** вызывает [**икондитионженератор:: женератефорлеаф**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) со сведениями для создаваемого узла.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-200">When [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) is about to emit a leaf node, and the semantic type of the value matches the named entity type for an [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** calls [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) with the information for the node to be generated.</span></span> <span data-ttu-id="bf2fa-201">Если [**икондитионженератор**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) возвращает " \_ ОК", он должен возвращать дерево условий (которое не обязательно должно быть конечным узлом) и информировать **икуерипарсер** , следует ли подавлять альтернативную интерпретацию строки, которая обычно создается в качестве меры предосторожности.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-201">If the [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) returns S\_OK, it should return a condition tree (which does not have to be a leaf node), and inform **IQueryParser** whether to suppress the alternative string interpretation that it would normally generate as a precaution.</span></span>

### <a name="itokencollection"></a><span data-ttu-id="bf2fa-202">итокенколлектион</span><span class="sxs-lookup"><span data-stu-id="bf2fa-202">ITokenCollection</span></span>

<span data-ttu-id="bf2fa-203">Метод [**итокенколлектион:: нумберофтокенс**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) возвращает число токенов. [**Итокенколлектион::-Token**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) возвращает сведения о *i*-ом маркере.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-203">The [**ITokenCollection::NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) method returns the number of tokens.[**ITokenCollection::GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) returns information about the *i* th token.</span></span> <span data-ttu-id="bf2fa-204">Начало и длина являются позициями символов во входной строке.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-204">The beginning and length are character positions in the input string.</span></span> <span data-ttu-id="bf2fa-205">Возвращаемый текст будет иметь значение, отличное от NULL, только если имеется текст, переопределяющий символы из входной строки.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-205">The returned text will be non-null only if there is a text overriding the characters from the input string.</span></span> <span data-ttu-id="bf2fa-206">Это используется, например, для переопределения тире во входной строке, если этот дефис находится в контексте, где его следует интерпретировать как отрицание.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-206">This is used, for example, to override a dash in the input string with NOT when that dash is in a context where it should be interpreted as a negation.</span></span>

### <a name="inamedentitycollector"></a><span data-ttu-id="bf2fa-207">инамедентитиколлектор</span><span class="sxs-lookup"><span data-stu-id="bf2fa-207">INamedEntityCollector</span></span>

<span data-ttu-id="bf2fa-208">[**Икондитионженератор**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) вызывает [**Инамедентитиколлектор:: Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) для каждой распознанной известной сущности.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) calls [**INamedEntityCollector::Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) for each named entity it recognized.</span></span> <span data-ttu-id="bf2fa-209">Диапазоны — это диапазоны маркеров.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-209">The spans are token spans.</span></span> <span data-ttu-id="bf2fa-210">Это всегда должно быть так, как *бегинспан* ?</span><span class="sxs-lookup"><span data-stu-id="bf2fa-210">It must always be the case that *beginSpan* ?</span></span> <span data-ttu-id="bf2fa-211">*бегинактуал*  <  *ендактуал* ?</span><span class="sxs-lookup"><span data-stu-id="bf2fa-211">*beginActual* < *endActual* ?</span></span> <span data-ttu-id="bf2fa-212">*ендспан*.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-212">*endSpan*.</span></span> <span data-ttu-id="bf2fa-213">*бегинспан* и *ендспан* могут отличаться от *бегинактуал* и *ендактуал* , если именованная сущность начинается и (или) заканчивается на семантически незначимых маркерах, таких как кавычки (которые, тем не менее, покрываемые именованной сущностью).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-213">*beginSpan* and *endSpan* may differ from *beginActual* and *endActual* if the named entity begins and/or ends with semantically insignificant tokens such as quotation marks (that are nevertheless covered by the named entity).</span></span> <span data-ttu-id="bf2fa-214">Значение должно быть выражено в виде строки и впоследствии появиться в вызове [**икондитионженератор:: женератефорлеаф**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-214">The value must be expressed as a string and will subsequently appear in a call to [**IConditionGenerator::GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span></span>

### <a name="ischemaprovider"></a><span data-ttu-id="bf2fa-215">исчемапровидер</span><span class="sxs-lookup"><span data-stu-id="bf2fa-215">ISchemaProvider</span></span>

<span data-ttu-id="bf2fa-216">Интерфейс [**исчемапровидер**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) можно использовать для просмотра загруженной схемы для сущностей (типов) и связей (свойств).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-216">The [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface can be used to browse a loaded schema for entities (types) and relations (properties).</span></span> <span data-ttu-id="bf2fa-217">Вот как это делают отдельные методы:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-217">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="bf2fa-218">[**Сущности**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) возвращают перечисление всех сущностей ([**иентити**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) в схеме.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-218">[**Entities**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) returns an enumeration of every entity ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) in the schema.</span></span>
-   <span data-ttu-id="bf2fa-219">[**Рутентити**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) Возвращает корневую сущность схемы.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) returns the root entity of the schema.</span></span> <span data-ttu-id="bf2fa-220">Для плоской схемы возвращается основной тип каждого [**икуерисолутион**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-220">For a flat schema, the main type of every [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) is returned.</span></span>
-   <span data-ttu-id="bf2fa-221">[](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) Функция GetSchema находит сущность по имени и возвращает \_ значение S false, если такая сущность отсутствует в схеме.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) finds an entity by name and returns S\_FALSE if there is no such entity in the schema.</span></span>
-   <span data-ttu-id="bf2fa-222">[**Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) возвращает перечисление интерфейсов [**иметадата**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-222">[**MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces.</span></span>

### <a name="ientity"></a><span data-ttu-id="bf2fa-223">иентити</span><span class="sxs-lookup"><span data-stu-id="bf2fa-223">IEntity</span></span>

<span data-ttu-id="bf2fa-224">Интерфейс [**иентити**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) — это сущность схемы, которая представляет тип с именем, имеет ряд именованных связей с другими типами (свойства) и является производным от базовой сущности.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-224">The [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) interface is a schema entity that represents a type that has a name, has a number of named relationships to other types (properties), and derives from a base entity.</span></span> <span data-ttu-id="bf2fa-225">Вот что делают отдельные методы:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-225">Here's what its individual methods do:</span></span>

-   <span data-ttu-id="bf2fa-226">[**Иентити:: Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) возвращает перечисление объектов [**ирелатионшип**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) , по одному для каждого исходящего отношения этого типа.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-226">[**IEntity::Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) returns an enumeration of [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) objects, one for each outgoing relation of this type.</span></span> <span data-ttu-id="bf2fa-227">Каждое исходящее отношение сущности имеет имя.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-227">Each outgoing relation of an entity has a name.</span></span>
-   <span data-ttu-id="bf2fa-228">[**Иентити::-relationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) находит связь по имени и возвращает \_ значение S false, если такая связь для этой сущности отсутствует.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) finds a relationship by name, and returns S\_FALSE if there is no such relationship for this entity.</span></span>
-   <span data-ttu-id="bf2fa-229">[**Иентити:: Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) возвращает перечисление интерфейсов [**иметадата**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , по одному для каждой пары метаданных этой сущности.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="bf2fa-230">[**Иентити::D ефаултфрасе**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) возвращает фразу по умолчанию для упрощения создания АКС или нксго состояния дерева условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-230">[**IEntity::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) returns a default phrase to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="irelationship"></a><span data-ttu-id="bf2fa-231">ирелатионшип</span><span class="sxs-lookup"><span data-stu-id="bf2fa-231">IRelationship</span></span>

<span data-ttu-id="bf2fa-232">Интерфейс [**ирелатионшип**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) представляет связь между двумя сущностями: источником и назначением.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-232">The [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) interface represents a relationship between two entities: a source and a destination.</span></span> <span data-ttu-id="bf2fa-233">Вот как это делают отдельные методы:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-233">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="bf2fa-234">[**Ирелатионшип:: Real**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) сообщает, является ли связь реальной.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) reports whether a relationship is real.</span></span> <span data-ttu-id="bf2fa-235">Например, если сущность A является производной от сущности B и наследует связь с именем R от нее, то может по-прежнему иметь собственную связь с именем R. Однако связь, Бевин и R, должна иметь тот же конечный тип, что и в B, и единственная причина для ее существования — хранить метаданные, относящиеся к B. Такая связь с B считается недействительной.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-235">For example, if entity A derives from entity B and inherits a relationship named R from it, A may still have its own relationship named R. However, the relationship beween A and R must have the same destination type as that of B, and the only reason for it to exist is to store metadata specific to B. Such a relationship of B is said not to be real.</span></span>
-   <span data-ttu-id="bf2fa-236">[**Ирелатионшип:: метаданным**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) возвращает перечисление интерфейсов [**иметадата**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , по одному для каждой пары метаданных этой сущности.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="bf2fa-237">[**Ирелатионшип::D ефаултфрасе**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) возвращает фразу по умолчанию, используемую для этой связи в передействиях.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-237">[**IRelationship::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) returns the default phrase to use for this relationship in restatements.</span></span> <span data-ttu-id="bf2fa-238">Каждая связь имеет фразу по умолчанию, которая обозначает, что она позволяет упростить создание АКС или НКСного состояния дерева условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-238">Each relationship has a default phrase that denotes it to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="imetadata"></a><span data-ttu-id="bf2fa-239">иметадата</span><span class="sxs-lookup"><span data-stu-id="bf2fa-239">IMetaData</span></span>

<span data-ttu-id="bf2fa-240">Метаданные представляют собой пары "ключ-значение", каждый из которых связан с сущностью, связью или всей схемой.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-240">Metadata are key-value pairs that are each associated with either an entity, a relationship, or the whole schema.</span></span> <span data-ttu-id="bf2fa-241">Поскольку ключи не обязательно являются уникальными, коллекция метаданных может рассматриваться как несколько карт.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-241">Because keys are not necessarily unique, a collection of metadata can be thought of as a multi-map.</span></span> <span data-ttu-id="bf2fa-242">Метод [**иметадата:: GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) вызывается для получения ключа и значения для пары отражение.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) is called to retrieve the key and value for a metatdata pair.</span></span>

## <a name="querying-scenarios"></a><span data-ttu-id="bf2fa-243">Сценарии запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-243">Querying Scenarios</span></span>

<span data-ttu-id="bf2fa-244">В следующих сценариях описывается использование интерфейсов API структурированных запросов в Windows Search в общих сценариях запросов, таких как создание дерева условий и запрос индекса.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-244">The following scenarios describe the use of structured query APIs in Windows Search in common querying scenarios, such as creating a condition tree and querying the index.</span></span>

### <a name="condition-extraction-and-query-parsing"></a><span data-ttu-id="bf2fa-245">Извлечение условий и синтаксический анализ запросов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-245">Condition Extraction and Query Parsing</span></span>

<span data-ttu-id="bf2fa-246">При создании запроса его область определяется путем указания системы на место поиска.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-246">When a query is created, its scope is defined by telling the system where to search.</span></span> <span data-ttu-id="bf2fa-247">Это ограничит результаты поиска.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-247">This restricts the search results.</span></span> <span data-ttu-id="bf2fa-248">После определения области применяется фильтр, и возвращается набор фильтров.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-248">After the scope is defined, a filter is applied, and a filter set is returned.</span></span> <span data-ttu-id="bf2fa-249">Результаты поиска ограничиваются путем построения дерева условий с конечными узлами аналогично графу.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-249">Search results are restricted by building a condition tree with leaf nodes, similar to a graph.</span></span> <span data-ttu-id="bf2fa-250">Затем эти условия извлекаются.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-250">Those conditions are then extracted.</span></span> <span data-ttu-id="bf2fa-251">Дерево условий — это логическое сочетание (и, или, не) конечных условий, каждое из которых связывает свойство с помощью операции со значением.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-251">A condition tree is a Boolean combination (AND, OR, NOT) of leaf conditions, each of which relates a property, through an operation, to a value.</span></span> <span data-ttu-id="bf2fa-252">Конечный узел представляет ограничение для одного свойства на значение через некоторые операции.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-252">A leaf node represents a restriction on a single property to a value through some operations.</span></span>

<span data-ttu-id="bf2fa-253">Для ограничения фильтра требуется логическое выражение, описывающее это ограничение.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-253">A filter restriction requires a logical expression that describes the restriction.</span></span> <span data-ttu-id="bf2fa-254">Определение этого выражения начинается с интерфейса [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) , который используется для создания одного узла в дереве условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-254">Defining this expression starts with the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface, which is used to create a single node in a condition tree.</span></span> <span data-ttu-id="bf2fa-255">Поскольку в следующем примере присутствует только одно условие, дерево не изменяется.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-255">Because there is only one condition in the following example, the tree does not change.</span></span>


```C++
    
    [
        object,
        uuid(0FC988D4-C935-4b97-A973-46282EA175C8),
        pointer_default(unique)
    ]
    interface ICondition : IPersistStream
    {
        HRESULT GetConditionType([out, retval] CONDITION_TYPE* pNodeType);
        HRESULT GetSubConditions([in] REFIID riid, [out, retval, iid_is(riid)] void** ppv);
        [local] HRESULT GetComparisonInfo([out, annotation("__deref_opt_out")] LPWSTR *ppszPropertyName, [out, annotation("__out_opt")] CONDITION_OPERATION *pOperation, [out, annotation("__out_opt")] PROPVARIANT *pValue);
        HRESULT GetValueType([out, retval] LPWSTR* ppszValueTypeName);
        HRESULT GetValueNormalization([out, retval] LPWSTR* ppszNormalization);
        [local] HRESULT GetInputTerms([out, annotation("__out_opt")] IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] IRichChunk** ppValueTerm);
        HRESULT Clone([out, retval] ICondition** ppc);
    };


```



<span data-ttu-id="bf2fa-256">Если имеется более одного условия фильтра, то для достижения одного дерева используются и другие логические операторы.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-256">If there is more than one filter condition, then AND and other Boolean operators are used to achieve a single tree.</span></span> <span data-ttu-id="bf2fa-257">И-деревья и-деревья представляют собой соединения и пересечения их поддеревьев.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-257">AND-trees and OR-trees represent conjunctions and disjunctions of their subtrees.</span></span> <span data-ttu-id="bf2fa-258">Недерево представляет отрицание отдельного поддерева.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-258">A NOT-tree represents the negation of its single subtree.</span></span> <span data-ttu-id="bf2fa-259">АКС предоставляет текстовый подход к достижению логических выражений с логическими операторами, и зачастую проще.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-259">AQS provides a text approach to achieving logical expressions with Boolean operators, and is often simpler.</span></span>

<span data-ttu-id="bf2fa-260">В следующем примере мы преобразуем дерево условий ([**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) в визуальную форму.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-260">In the next example we convert the condition tree ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) into visual form.</span></span> <span data-ttu-id="bf2fa-261">Средство синтаксического анализа запросов, использующее интерфейс [**икуерипарсер**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) , преобразует [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) в строку запроса форматированного текста (RTF).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-261">The query parser, using the [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) interface, converts the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) into a rich text formatted (RTF) query string.</span></span> <span data-ttu-id="bf2fa-262">Метод [**икуерипарсер:: рестатетостринг**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) возвращает текст запроса, а метод [**икуерипарсер::P Арсе**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) создает интерфейс [**икуерисолутион**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-262">The [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) method returns the query text, while the [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method produces an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface.</span></span> <span data-ttu-id="bf2fa-263">В следующем примере показано, как выполнить все эти действия.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-263">The following example shows how to do all that.</span></span>


```C++
    [
        object,
        uuid(2EBDEE67-3505-43f8-9946-EA44ABC8E5B0),
        pointer_default(unique)
    ]
    interface IQueryParser : IUnknown
    {
        HRESULT Parse([in] LPCWSTR pszInputString, [in] IEnumUnknown* pCustomProperties, [out, retval] IQuerySolution** ppSolution);
        HRESULT SetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [out, retval] PROPVARIANT* pOptionValue);
        HRESULT SetMultiOption([in] STRUCTURED_QUERY_MULTIOPTION option, [in] LPCWSTR pszOptionKey, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetSchemaProvider([out, retval] ISchemaProvider** ppSchemaProvider);
        HRESULT RestateToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszQueryString);
        HRESULT ParsePropertyValue([in] LPCWSTR pszPropertyName, [in] LPCWSTR pszInputString, [out, retval] IQuerySolution** ppSolution);
        HRESULT RestatePropertyValueToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszPropertyName, [out] LPWSTR* ppszQueryString);
    };

```



<span data-ttu-id="bf2fa-264">Основной вход для [**икуерипарсер::P Арсе**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) — это входная пользовательская строка, которую необходимо проанализировать, но приложение также может сообщать анализатору запросов все свойства, распознаваемые во входных данных (из синтаксиса конкретного приложения).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-264">The main input of [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) is a user input string to be parsed, but the application can also inform the query parser of any properties it has recognized in the input (from application-specific syntax).</span></span> <span data-ttu-id="bf2fa-265">Выходные данные **икуерипарсер::P Арсе** — это [**икуерисолутион**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), который предоставляет всю информацию, относящуюся к этому вызову синтаксического анализа.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-265">The output of **IQueryParser::Parse** is an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), which provides all information pertaining to that parse invocation.</span></span> <span data-ttu-id="bf2fa-266">Существуют методы для получения входной строки, способа разметки входной строки, любых ошибок синтаксического анализа и проанализированного запроса в качестве дерева условий, представленного [**икондитион**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-266">There are methods for obtaining the input string, how the input string was tokenized, any parse errors, and the parsed query as condition tree, represented by an [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span></span> <span data-ttu-id="bf2fa-267">В следующем примере показано...</span><span class="sxs-lookup"><span data-stu-id="bf2fa-267">The following example shows ...</span></span>


```C++
    [
        object,
        uuid(D6EBC66B-8921-4193-AFDD-A1789FB7FF57),
        pointer_default(unique)
    ]
    interface IQuerySolution : IConditionFactory
    {
        [local] HRESULT GetQuery([out, annotation("__out_opt")] ICondition** ppQueryNode, [out, annotation("__out_opt")] IEntity** ppMainType);
        HRESULT GetErrors([in] REFIID riid, [out, retval, iid_is(riid)] void** ppParseErrors);
        [local] HRESULT GetLexicalData([out, annotation("__deref_opt_out")] LPWSTR* ppszInputString, [out, annotation("__out_opt")] ITokenCollection** ppTokens, [out, annotation("__out_opt")] LCID* pLocale, [out, annotation("__out_opt")] IUnknown** ppWordBreaker);
    }    

    

```



<span data-ttu-id="bf2fa-268">В предыдущем примере [**икуерисолутион::**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) gettext может получить любые сведения о запросе, включая исходный текст, токены, составляющие текст, или дерево условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-268">In the previous example, [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) could obtain any information about the query including the original text, tokens that comprise the text, or the condition tree.</span></span> <span data-ttu-id="bf2fa-269">Примеры возможных значений запроса перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-269">Examples of possible returned query values are listed in the following table.</span></span>



| <span data-ttu-id="bf2fa-270">Примеры возвращаемых значений запроса</span><span class="sxs-lookup"><span data-stu-id="bf2fa-270">Examples of returned query values</span></span>                        | <span data-ttu-id="bf2fa-271">Описание</span><span class="sxs-lookup"><span data-stu-id="bf2fa-271">Description</span></span>                                                                                               |
|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| `  author:relja OR author:tyler`                         | <span data-ttu-id="bf2fa-272">Текст запроса, [**икуерипарсер:: рестатетостринг**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) , возвращает</span><span class="sxs-lookup"><span data-stu-id="bf2fa-272">The query text that [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) returns</span></span> |
| `?author?, ?:?, ?relja?, ?OR?, ?author?, ?:?, ?tyler?`   | <span data-ttu-id="bf2fa-273">Разбиение маркеров</span><span class="sxs-lookup"><span data-stu-id="bf2fa-273">The break-down of tokens</span></span>                                                                                  |
| ![неразрешенное дерево условий](images/queryvalues1.png) | <span data-ttu-id="bf2fa-275">Неразрешенное дерево условий</span><span class="sxs-lookup"><span data-stu-id="bf2fa-275">An unresolved condition tree</span></span>                                                                              |



 

<span data-ttu-id="bf2fa-276">Возвращенное начальное дерево условий не разрешено.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-276">The initial condition tree that is returned is unresolved.</span></span> <span data-ttu-id="bf2fa-277">В неразрешенном дереве условий ссылки на дату и время, такие как `date:yesterday` , не преобразуются в абсолютное время.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-277">In an unresolved condition tree, date and time references, such as `date:yesterday`, are not converted to absolute time.</span></span> <span data-ttu-id="bf2fa-278">Кроме того, виртуальные свойства не разворачиваются.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-278">Also, virtual properties are not expanded.</span></span> <span data-ttu-id="bf2fa-279">Виртуальные свойства — это свойства, которые действуют как статистические выражения нескольких свойств.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-279">Virtual properties are properties that act as aggregates of multiple properties.</span></span>

<span data-ttu-id="bf2fa-280">Например, запрос `kind:email from:reljai` создает следующие неразрешенные и разрешенные деревья условий.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-280">For example, the query `kind:email from:reljai` produces the following unresolved and resolved condition trees.</span></span> <span data-ttu-id="bf2fa-281">Неразрешенное дерево условий — слева, а разрешенное дерево условий — справа.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-281">The unresolved condition tree is to the left, and the resolved condition tree is to the right.</span></span>

![деревья неразрешенных и разрешенных условий](images/conditiontree.png)

<span data-ttu-id="bf2fa-283">Разрешенное дерево можно получить путем вызова [**икондитионфактори:: Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-283">The resolved tree can be obtained by calling [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span></span> <span data-ttu-id="bf2fa-284">Однако передача [**скро \_ не с \_ разрешением \_ DateTime**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) оставляет дату и время неразрешимыми.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-284">However, passing [**SQRO\_DONT\_RESOLVE\_DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) leaves the date and time unresolved.</span></span> <span data-ttu-id="bf2fa-285">Неразрешенное дерево условий имеет свои преимущества, так как неразрешенное дерево условий содержит сведения о запросе.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-285">There are advantages to an unresolved condition tree, because an unresolved condition tree contains information about the query.</span></span> <span data-ttu-id="bf2fa-286">Каждый конечный узел указывает на маркеры, возвращаемые [**икуерисолутион:: жетлексикалдата**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), которые соответствуют свойству, оператору и значению при использовании интерфейса [**ириччунк**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-286">Each leaf node points to the tokens returned by [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), which correspond to the property, operator, and value when using the [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) interface.</span></span> <span data-ttu-id="bf2fa-287">В следующем примере показано...</span><span class="sxs-lookup"><span data-stu-id="bf2fa-287">The following example shows ...</span></span>


```C++
    interface ITokenCollection : IUnknown
    {
        HRESULT NumberOfTokens(ULONG* pCount);
        HRESULT GetToken([in] ULONG i, [out, annotation("__out_opt")] ULONG* pBegin, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz);
    };

ICondition:: GetInputTerms([out, annotation("__out_opt")] 
IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] 
IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] 
IRichChunk** ppValueTerm);

    interface IRichChunk : IUnknown
    {
        HRESULT GetData([out, annotation("__out_opt")] ULONG* pFirstPos, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz, [out, annotation("__out_opt")] PROPVARIANT* pValue);
    }
```



### <a name="querying-the-index"></a><span data-ttu-id="bf2fa-288">Запрос индекса</span><span class="sxs-lookup"><span data-stu-id="bf2fa-288">Querying the Index</span></span>

<span data-ttu-id="bf2fa-289">Существует несколько подходов к отзапросу индекса.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-289">There are several approaches to querying the index.</span></span> <span data-ttu-id="bf2fa-290">Некоторые из них основаны на SQL, а другие — на АКС.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-290">Some are based on the SQL and others are based on AQS.</span></span> <span data-ttu-id="bf2fa-291">Индекс службы поиска Windows можно также запрашивать программно с помощью [интерфейсов запросов](./-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-291">You can also query the Windows Search index programmatically by using [querying interfaces](./-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="bf2fa-292">Существует три интерфейса, которые относятся к запросам индекса: [**исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**ировсетприоритизатион**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization)и [**ировсетевентс**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-292">There are three interfaces that are specific to querying the index: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization), and [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span></span> <span data-ttu-id="bf2fa-293">Основные сведения см. [в разделе Запрос индекса программным способом](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-293">For conceptual information, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

<span data-ttu-id="bf2fa-294">Можно разработать компонент или вспомогательный класс для запроса индекса с помощью интерфейса [**исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) .</span><span class="sxs-lookup"><span data-stu-id="bf2fa-294">You can develop a component or helper class to query the index by using the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span> <span data-ttu-id="bf2fa-295">Этот интерфейс реализуется как вспомогательный класс для [**исеарчкаталогманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (и [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)) и получается путем вызова [**исеарчкаталогманажер:: жеткуерихелпер**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-295">This interface is implemented as a helper class to [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)), and is obtained by calling [**ISearchCatalogManager::GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span></span> <span data-ttu-id="bf2fa-296">Основные сведения см. [в разделе запросы к индексу с помощью исеарчкуерихелпер](-search-3x-wds-qryidx-searchqueryhelper.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-296">For conceptual information, see [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span></span>

<span data-ttu-id="bf2fa-297">[**Исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) позволяет:</span><span class="sxs-lookup"><span data-stu-id="bf2fa-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permits you to:</span></span>

-   <span data-ttu-id="bf2fa-298">Получите строку подключения OLE DB для подключения к базе данных Windows Search.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-298">Obtain an OLE DB connection string to connect to the Windows Search database.</span></span>
-   <span data-ttu-id="bf2fa-299">Преобразование запросов пользователя АКС в SQL Search в Windows.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-299">Convert AQS user queries to Windows Search SQL.</span></span>
-   <span data-ttu-id="bf2fa-300">Укажите ограничения запросов, которые могут быть выражены в SQL, но не в АКС.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-300">Specify query restrictions that can be expressed in SQL but not in AQS.</span></span>

<span data-ttu-id="bf2fa-301">Приоритеты индексирования и события наборов строк поддерживаются в Windows 7 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-301">Indexing prioritization and rowset events are supported in Windows 7 and later.</span></span> <span data-ttu-id="bf2fa-302">В [**ировсетприоритизатион**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) есть стек приоритетов, который позволяет клиенту запрашивать, что области, используемые в определенном запросе, должны иметь более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-302">With [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) there is a priority stack that enables the client to request that the scopes used in a particular query be given higher than normal priority.</span></span> <span data-ttu-id="bf2fa-303">[**Ировсетевентс**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) предоставляет уведомления об изменениях элементов в наборах строк, включая добавление новых элементов, удаление элементов и изменение данных элемента.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) provides notification of changes to items in rowsets, including the addition of new items, the deletion of items, and the modification of item data.</span></span> <span data-ttu-id="bf2fa-304">Использование уведомлений о событиях наборов строк гарантирует, что результаты для существующих запросов будут как можно более актуальными.</span><span class="sxs-lookup"><span data-stu-id="bf2fa-304">Using rowset event notifications ensures that the results for existing queries are as up to date as possible.</span></span> <span data-ttu-id="bf2fa-305">Основные сведения см. [в разделе индексирование определения приоритетов и событий набора строк в Windows 7](indexing-prioritization-and-rowset-events.md).</span><span class="sxs-lookup"><span data-stu-id="bf2fa-305">For conceptual information, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bf2fa-306">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="bf2fa-306">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bf2fa-307">Индексирование, запросы и уведомления в Windows Search</span><span class="sxs-lookup"><span data-stu-id="bf2fa-307">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)
</dt> <dt>

[<span data-ttu-id="bf2fa-308">Что включено в индекс</span><span class="sxs-lookup"><span data-stu-id="bf2fa-308">What is Included in the Index</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="bf2fa-309">Процесс индексирования в Windows Search</span><span class="sxs-lookup"><span data-stu-id="bf2fa-309">Indexing Process in Windows Search</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="bf2fa-310">Обработка уведомлений в Windows Search</span><span class="sxs-lookup"><span data-stu-id="bf2fa-310">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)
</dt> <dt>

[<span data-ttu-id="bf2fa-311">Требования к форматированию URL-адресов</span><span class="sxs-lookup"><span data-stu-id="bf2fa-311">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
</dt> </dl>

 

 
