---
description: Пользователи Windows могут сохранять Поиск в виде папки поиска, созданной XML-файлом, хранящим запрос в форме, которая может использоваться подсистемой поиска Windows.
ms.assetid: 1c73e220-a999-4243-879c-ac7310151def
title: Формат сохраненного файла поиска
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d19cf936f78b045814bf7cba31a123c40d61927a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104540687"
---
# <a name="saved-search-file-format"></a><span data-ttu-id="f6c54-103">Формат сохраненного файла поиска</span><span class="sxs-lookup"><span data-stu-id="f6c54-103">Saved Search File Format</span></span>

<span data-ttu-id="f6c54-104">В Windows Vista и более поздних версиях пользователи могут сохранять Поиск в виде папки поиска, созданной XML-файлом, хранящим запрос в форме, которая может использоваться подсистемой поиска Windows.</span><span class="sxs-lookup"><span data-stu-id="f6c54-104">In Windows Vista and later, users can save searches as a Search Folder which is generated by an XML file that stores the query in a form that can be used by the Windows search subsystem.</span></span> <span data-ttu-id="f6c54-105">В этом разделе описывается формат файла ( \* . Search-MS) и приведены следующие разделы.</span><span class="sxs-lookup"><span data-stu-id="f6c54-105">This topic describes the file format (\*.search-ms) and includes the following sections:</span></span>

- [<span data-ttu-id="f6c54-106">Общие сведения о сохраненных поисковых запросах</span><span class="sxs-lookup"><span data-stu-id="f6c54-106">Overview of Saved Searches</span></span>](#overview-of-saved-searches)
- [<span data-ttu-id="f6c54-107">\<viewInfo> Элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-107">\<viewInfo> Element</span></span>](/windows)
  - [<span data-ttu-id="f6c54-108">\<viewInfo> Атрибута</span><span class="sxs-lookup"><span data-stu-id="f6c54-108">\<viewInfo> Attributes</span></span>](/windows)
  - [<span data-ttu-id="f6c54-109">\<viewInfo> Дочерние элементы</span><span class="sxs-lookup"><span data-stu-id="f6c54-109">\<viewInfo> Child Elements</span></span>](/windows)
- [<span data-ttu-id="f6c54-110">\<query> Элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-110">\<query> Element</span></span>](/windows)
  - [<span data-ttu-id="f6c54-111">\<query> Дочерние элементы</span><span class="sxs-lookup"><span data-stu-id="f6c54-111">\<query> Child Elements</span></span>](/windows)
- [<span data-ttu-id="f6c54-112">\<properties> Элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-112">\<properties> Element</span></span>](/windows)
- [<span data-ttu-id="f6c54-113">Полная спецификация формата файла поиска MS</span><span class="sxs-lookup"><span data-stu-id="f6c54-113">Full Specification of the search-ms File Format</span></span>](#full-specification-of-the-search-ms-file-format)
- [<span data-ttu-id="f6c54-114">Примеры сохраненных поисков</span><span class="sxs-lookup"><span data-stu-id="f6c54-114">Examples of Saved Searches</span></span>](#examples-of-saved-searches)

## <a name="overview-of-saved-searches"></a><span data-ttu-id="f6c54-115">Общие сведения о сохраненных поисковых запросах</span><span class="sxs-lookup"><span data-stu-id="f6c54-115">Overview of Saved Searches</span></span>

<span data-ttu-id="f6c54-116">Пользователи могут сохранить поисковый запрос как папку поиска, виртуальную папку, отображаемую в проводнике Windows в папке "Поиск".</span><span class="sxs-lookup"><span data-stu-id="f6c54-116">Users can save a search query as a Search Folder, a virtual folder displayed in Windows Explorer under the Searches folder.</span></span> <span data-ttu-id="f6c54-117">При открытии папки поиска выполняется сохраненный поиск и отображаются последние результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-117">Opening a Search Folder runs the saved search and displays up-to-date results.</span></span> <span data-ttu-id="f6c54-118">Сохраненный файл поиска хранит запрос в формате, в котором может работать Windows Search, указывая, что искать, где искать, и как представлять результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-118">The saved search file stores the query in a format Windows Search can act on, specifying what to search for, where to search, and how to present the results.</span></span>

<span data-ttu-id="f6c54-119">Сохраненный поиск создается из XML-файла ( \* . Search-MS) в папке поиска% UserProfile% \\ .</span><span class="sxs-lookup"><span data-stu-id="f6c54-119">The saved search is generated from an XML file (\*.search-ms) in the %userprofile%\\Searches folder.</span></span> <span data-ttu-id="f6c54-120">Данные делятся на три первичных элемента в XML-файле:</span><span class="sxs-lookup"><span data-stu-id="f6c54-120">The data is divided into three primary elements in the XML file:</span></span>

- <span data-ttu-id="f6c54-121">\<viewInfo> Указывает сведения о презентации</span><span class="sxs-lookup"><span data-stu-id="f6c54-121">\<viewInfo> specifies presentation information</span></span>
- <span data-ttu-id="f6c54-122">\<query> Задает (Поиск сведений о запросе</span><span class="sxs-lookup"><span data-stu-id="f6c54-122">\<query> specifies (search query information</span></span>
- <span data-ttu-id="f6c54-123">\<properties> Указывает свойства \* файла. Search-MS.</span><span class="sxs-lookup"><span data-stu-id="f6c54-123">\<properties> specifies properties of the \*.search-ms file itself</span></span>

<span data-ttu-id="f6c54-124">В следующем примере показана высокоуровневая структура сохраненного файла поиска.</span><span class="sxs-lookup"><span data-stu-id="f6c54-124">The following example shows the high-level structure of a saved search file.</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">

    <viewInfo ...>
        ...
    </viewInfo>

    <query>
        ...
    </query>

    <properties>
        ...
    </properties>

</persistedQuery>
```

## <a name="viewinfo-element"></a><span data-ttu-id="f6c54-125">Элемент \<viewInfo></span><span class="sxs-lookup"><span data-stu-id="f6c54-125">\<viewInfo> Element</span></span>

<span data-ttu-id="f6c54-126">\<viewInfo>Элемент указывает, как результаты представляются конечному пользователю.</span><span class="sxs-lookup"><span data-stu-id="f6c54-126">The \<viewInfo> element specifies how the results are presented to the end user.</span></span> <span data-ttu-id="f6c54-127">В следующем примере показана структура элемента.</span><span class="sxs-lookup"><span data-stu-id="f6c54-127">The following example shows the structure of the element.</span></span>

```XML
...
    <viewInfo viewMode=""
              iconSize=""
              stackIconSize=""
              autoListFlags=""
              folderFlags=""
              taskFlags=""
              displayName="">

        <visibleColumns>
            <column viewField=""/>
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/>
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>
        </columnChooserColumns >

        <groupBy viewField=""
                 direction=""/>

        <stackList>
            <stack viewField=""/>
        </stackList>

        <sortList>
            <sort viewField=""
                  direction=""/>
        </sortList>
    </viewInfo>
...
```

### <a name="viewinfo-attributes"></a><span data-ttu-id="f6c54-128">\<viewInfo> Атрибута</span><span class="sxs-lookup"><span data-stu-id="f6c54-128">\<viewInfo> Attributes</span></span>

<span data-ttu-id="f6c54-129">В таблице ниже описаны атрибуты элемента \<viewInfo>.</span><span class="sxs-lookup"><span data-stu-id="f6c54-129">The following table describes the attributes of the \<viewInfo> element.</span></span>

| <span data-ttu-id="f6c54-130">attribute</span><span class="sxs-lookup"><span data-stu-id="f6c54-130">Attribute</span></span>     | <span data-ttu-id="f6c54-131">Описание</span><span class="sxs-lookup"><span data-stu-id="f6c54-131">Description</span></span>                                                                     | <span data-ttu-id="f6c54-132">Значения</span><span class="sxs-lookup"><span data-stu-id="f6c54-132">Values</span></span>                     |
|---------------|---------------------------------------------------------------------------------|----------------------------|
| <span data-ttu-id="f6c54-133">viewMode</span><span class="sxs-lookup"><span data-stu-id="f6c54-133">viewMode</span></span>      | <span data-ttu-id="f6c54-134">Указывает представление папки.</span><span class="sxs-lookup"><span data-stu-id="f6c54-134">Specifies the folder view.</span></span>                                                      | <span data-ttu-id="f6c54-135">\|Плитки значков сведений \|</span><span class="sxs-lookup"><span data-stu-id="f6c54-135">Details \| Icons \| Tiles</span></span>  |
| <span data-ttu-id="f6c54-136">iconSize</span><span class="sxs-lookup"><span data-stu-id="f6c54-136">iconSize</span></span>      | <span data-ttu-id="f6c54-137">Определяет размер значков и эскизов по умолчанию для элементов, если они не находятся в стеке.</span><span class="sxs-lookup"><span data-stu-id="f6c54-137">Controls the default size of the icons and thumbnails for items when not stack.</span></span> | <span data-ttu-id="f6c54-138">Целое число от 16 до 256</span><span class="sxs-lookup"><span data-stu-id="f6c54-138">Integer between 16 and 256</span></span> |
| <span data-ttu-id="f6c54-139">стаккиконсизе</span><span class="sxs-lookup"><span data-stu-id="f6c54-139">stackIconSize</span></span> | <span data-ttu-id="f6c54-140">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-140">For internal use only.</span></span> <span data-ttu-id="f6c54-141">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-141">Do not use.</span></span>                                              | <span data-ttu-id="f6c54-142">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-142">n/a</span></span>                        |
| <span data-ttu-id="f6c54-143">displayName</span><span class="sxs-lookup"><span data-stu-id="f6c54-143">displayName</span></span>   | <span data-ttu-id="f6c54-144">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-144">For internal use only.</span></span> <span data-ttu-id="f6c54-145">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-145">Do not use.</span></span>                                              | <span data-ttu-id="f6c54-146">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-146">n/a</span></span>                        |
| <span data-ttu-id="f6c54-147">аутолистфлагс</span><span class="sxs-lookup"><span data-stu-id="f6c54-147">autoListFlags</span></span> | <span data-ttu-id="f6c54-148">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-148">For internal use only.</span></span> <span data-ttu-id="f6c54-149">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-149">Do not use.</span></span>                                              | <span data-ttu-id="f6c54-150">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-150">n/a</span></span>                        |
| <span data-ttu-id="f6c54-151">фолдерфлагс</span><span class="sxs-lookup"><span data-stu-id="f6c54-151">folderFlags</span></span>   | <span data-ttu-id="f6c54-152">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-152">For internal use only.</span></span> <span data-ttu-id="f6c54-153">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-153">Do not use.</span></span>                                              | <span data-ttu-id="f6c54-154">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-154">n/a</span></span>                        |
| <span data-ttu-id="f6c54-155">таскфлагс</span><span class="sxs-lookup"><span data-stu-id="f6c54-155">taskFlags</span></span>     | <span data-ttu-id="f6c54-156">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-156">For internal use only.</span></span> <span data-ttu-id="f6c54-157">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-157">Do not use.</span></span>                                              | <span data-ttu-id="f6c54-158">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-158">n/a</span></span>                        |

### <a name="viewinfo-child-elements"></a><span data-ttu-id="f6c54-159">\<viewInfo> Дочерние элементы</span><span class="sxs-lookup"><span data-stu-id="f6c54-159">\<viewInfo> Child Elements</span></span>

<span data-ttu-id="f6c54-160">Дочерние элементы \<viewInfo> элемента указывают, какие столбцы отображаются в результатах поиска проводника Windows, а также как группируются и сортируются результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-160">The child elements of the \<viewInfo> element specify which columns appear in the Windows Explorer search results and how the results are grouped and sorted.</span></span> <span data-ttu-id="f6c54-161">Каждый дочерний элемент содержит упорядоченный набор столбцов, идентифицируемых каноническими именами системных свойств (например, System. DisplayName).</span><span class="sxs-lookup"><span data-stu-id="f6c54-161">Each child element contains an ordered set of columns, identified by canonical names of system properties (for example, System.DisplayName).</span></span> <span data-ttu-id="f6c54-162">Если он не определен в сохраненном файле поиска, то результаты поиска будут представлены с набором столбцов по умолчанию, подходящим для отображаемых типов файлов.</span><span class="sxs-lookup"><span data-stu-id="f6c54-162">If not defined in the saved search file, the search results are presented with a default set of columns appropriate for the file types displayed.</span></span>

| <span data-ttu-id="f6c54-163">Элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-163">Element</span></span>               | <span data-ttu-id="f6c54-164">Описание</span><span class="sxs-lookup"><span data-stu-id="f6c54-164">Description</span></span>                                                                                        | <span data-ttu-id="f6c54-165">Значения</span><span class="sxs-lookup"><span data-stu-id="f6c54-165">Values</span></span>                                                       |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="f6c54-166">висиблеколумнс</span><span class="sxs-lookup"><span data-stu-id="f6c54-166">visibleColumns</span></span>        | <span data-ttu-id="f6c54-167">Указывает упорядоченный список столбцов, отображаемых в представлении результатов.</span><span class="sxs-lookup"><span data-stu-id="f6c54-167">Specifies an ordered list of columns to appear in the results view.</span></span> <span data-ttu-id="f6c54-168">Пользователь может изменить этот список.</span><span class="sxs-lookup"><span data-stu-id="f6c54-168">The user can change this list.</span></span> | <span data-ttu-id="f6c54-169">Любое системное свойство.</span><span class="sxs-lookup"><span data-stu-id="f6c54-169">Any system property.</span></span>                                         |
| <span data-ttu-id="f6c54-170">фрекуентлюседколумнс</span><span class="sxs-lookup"><span data-stu-id="f6c54-170">frequentlyUsedColumns</span></span> | <span data-ttu-id="f6c54-171">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-171">For internal use only.</span></span> <span data-ttu-id="f6c54-172">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-172">Do not use.</span></span>                                                                 | <span data-ttu-id="f6c54-173">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-173">n/a</span></span>                                                          |
| <span data-ttu-id="f6c54-174">колумнчусерколумнс</span><span class="sxs-lookup"><span data-stu-id="f6c54-174">columnChooserColumns</span></span>  | <span data-ttu-id="f6c54-175">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-175">For internal use only.</span></span> <span data-ttu-id="f6c54-176">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-176">Do not use.</span></span>                                                                 | <span data-ttu-id="f6c54-177">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-177">n/a</span></span>                                                          |
| <span data-ttu-id="f6c54-178">Применения</span><span class="sxs-lookup"><span data-stu-id="f6c54-178">groupBy</span></span>               | <span data-ttu-id="f6c54-179">Указывает одно системное свойство, по которому группируются результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-179">Specifies a single system property by which to group the results.</span></span> <span data-ttu-id="f6c54-180">Пользователь может изменить это значение.</span><span class="sxs-lookup"><span data-stu-id="f6c54-180">The user can change this value.</span></span>  | <span data-ttu-id="f6c54-181">Любое системное свойство.</span><span class="sxs-lookup"><span data-stu-id="f6c54-181">Any system property.</span></span>                                         |
| <span data-ttu-id="f6c54-182">сортлист</span><span class="sxs-lookup"><span data-stu-id="f6c54-182">sortList</span></span>              | <span data-ttu-id="f6c54-183">Указывает упорядоченный список столбцов, по которым сортируются результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-183">Specifies an ordered list of columns to sort the results by.</span></span>                                       | <span data-ttu-id="f6c54-184">До четырех системных свойств.</span><span class="sxs-lookup"><span data-stu-id="f6c54-184">Up to four system properties.</span></span> <span data-ttu-id="f6c54-185">Пользователь может изменить этот список.</span><span class="sxs-lookup"><span data-stu-id="f6c54-185">The user can change this list.</span></span> |
| <span data-ttu-id="f6c54-186">стакклист</span><span class="sxs-lookup"><span data-stu-id="f6c54-186">stackList</span></span>             | <span data-ttu-id="f6c54-187">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-187">For internal use only.</span></span> <span data-ttu-id="f6c54-188">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-188">Do not use.</span></span>                                                                 | <span data-ttu-id="f6c54-189">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-189">n/a</span></span>                                                          |

## <a name="query-element"></a><span data-ttu-id="f6c54-190">Элемент \<query></span><span class="sxs-lookup"><span data-stu-id="f6c54-190">\<query> Element</span></span>

<span data-ttu-id="f6c54-191">\<query>Элемент задает атрибуты, определяющие, как запрашиваются результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-191">The \<query> element specifies the attributes which define how the results are queried.</span></span> <span data-ttu-id="f6c54-192">В следующем примере показана структура элемента.</span><span class="sxs-lookup"><span data-stu-id="f6c54-192">The following example shows the structure of the element.</span></span>

```XML
...
    <query>
        <providers>
            <provider clsid=""/>    <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

### <a name="query-child-elements"></a><span data-ttu-id="f6c54-193">\<query> Дочерние элементы</span><span class="sxs-lookup"><span data-stu-id="f6c54-193">\<query> Child Elements</span></span>

<span data-ttu-id="f6c54-194">В таблице ниже описаны дочерние элементы элемента \<scope>.</span><span class="sxs-lookup"><span data-stu-id="f6c54-194">The following table describes the child elements of the \<scope> element.</span></span>

| <span data-ttu-id="f6c54-195">Элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-195">Element</span></span>    | <span data-ttu-id="f6c54-196">Описание</span><span class="sxs-lookup"><span data-stu-id="f6c54-196">Description</span></span>                                                                                                               | <span data-ttu-id="f6c54-197">Значение</span><span class="sxs-lookup"><span data-stu-id="f6c54-197">Value</span></span>                                                                                                                                                                                                                                                          |
|------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f6c54-198">providers</span><span class="sxs-lookup"><span data-stu-id="f6c54-198">providers</span></span>  | <span data-ttu-id="f6c54-199">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-199">For internal use only.</span></span> <span data-ttu-id="f6c54-200">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-200">Do not use.</span></span>                                                                                        | <span data-ttu-id="f6c54-201">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-201">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="f6c54-202">Вложенные запросы</span><span class="sxs-lookup"><span data-stu-id="f6c54-202">subQueries</span></span> | <span data-ttu-id="f6c54-203">Только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-203">For internal use only.</span></span> <span data-ttu-id="f6c54-204">Не используйте.</span><span class="sxs-lookup"><span data-stu-id="f6c54-204">Do not use.</span></span>                                                                                        | <span data-ttu-id="f6c54-205">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-205">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="f6c54-206">Область</span><span class="sxs-lookup"><span data-stu-id="f6c54-206">Scope</span></span>      | <span data-ttu-id="f6c54-207">Определяет расположения, которые нужно включить в поиск или исключить из него.</span><span class="sxs-lookup"><span data-stu-id="f6c54-207">Identifies locations to include or exclude in the search.</span></span>                                                                 | <span data-ttu-id="f6c54-208">Путь или [идентификатор известной папки](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) для включения или исключения.</span><span class="sxs-lookup"><span data-stu-id="f6c54-208">Either a path or a [known folder ID](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) of the location to be included or excluded.</span></span> <span data-ttu-id="f6c54-209">Этот элемент также может указывать, должен ли поиск включать или исключать дочерние пути (глубокий или глубокий поиск).</span><span class="sxs-lookup"><span data-stu-id="f6c54-209">This element can also specify whether the search should include/exclude child paths (a shallow or deep search).</span></span> |
| <span data-ttu-id="f6c54-210">киндлист</span><span class="sxs-lookup"><span data-stu-id="f6c54-210">kindList</span></span>   | <span data-ttu-id="f6c54-211">Определяет тип файлов для поиска.</span><span class="sxs-lookup"><span data-stu-id="f6c54-211">Identifies the kind of file(s) to search for.</span></span>                                                                             | <span data-ttu-id="f6c54-212">Любое значение System. Kind.</span><span class="sxs-lookup"><span data-stu-id="f6c54-212">Any System.Kind value.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="f6c54-213">условия</span><span class="sxs-lookup"><span data-stu-id="f6c54-213">conditions</span></span> | <span data-ttu-id="f6c54-214">Задает правила фильтрации результатов.</span><span class="sxs-lookup"><span data-stu-id="f6c54-214">Specifies rules for filtering results.</span></span> <span data-ttu-id="f6c54-215">Например, результаты могут быть ограничены сообщениями электронной почты, отправленными или определенным пользователем.</span><span class="sxs-lookup"><span data-stu-id="f6c54-215">For example, results could be limited to emails sent by or to a particular person.</span></span> | <span data-ttu-id="f6c54-216">andCondition, Оркондитион, Ноткондитион, Леафкондитион.</span><span class="sxs-lookup"><span data-stu-id="f6c54-216">andCondition, orCondition, notCondition, leafCondition.</span></span>                                                                                                                                                                                                        |

### <a name="scope-element"></a><span data-ttu-id="f6c54-217">Элемент \<scope></span><span class="sxs-lookup"><span data-stu-id="f6c54-217">\<scope> Element</span></span>

<span data-ttu-id="f6c54-218">\<scope>Элемент определяет расположения, которые необходимо включить в поиск или исключить из него.</span><span class="sxs-lookup"><span data-stu-id="f6c54-218">The \<scope> element identifies the locations to include or exclude from the search.</span></span> <span data-ttu-id="f6c54-219">\<scope>Элемент должен содержать по крайней мере один \<include> дочерний элемент и ноль или более \<exclude> элементов.</span><span class="sxs-lookup"><span data-stu-id="f6c54-219">The \<scope> element must contain at least one \<include> child element present and zero or more \<exclude> elements.</span></span> <span data-ttu-id="f6c54-220">Расположения можно указать как путь (переменные среды поддерживаются) или как [идентификатор известной папки](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span><span class="sxs-lookup"><span data-stu-id="f6c54-220">The locations can be specified as either a path (environment variables are supported) or as a [known folder identifier](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span></span> <span data-ttu-id="f6c54-221">Кроме того, для каждого из этих расположений можно указать глубокий или поверхностный поиск, задав для нерекурсивного поиска значение true или false (по умолчанию рекурсия).</span><span class="sxs-lookup"><span data-stu-id="f6c54-221">Furthermore, each of these locations can be specified to be searched deep or shallow by setting the nonRecursive to "true" or "false" (default is recursive).</span></span> <span data-ttu-id="f6c54-222">Части включенного списка расположений можно исключить, указав элементы exclude.</span><span class="sxs-lookup"><span data-stu-id="f6c54-222">Parts of the included list of locations can be excluded by specifying exclude elements.</span></span>

<span data-ttu-id="f6c54-223">Ниже показан \<scope> элемент, который будет искать в особой папке Documents, но не ее потомках, том "e:" и его дочерние элементы, но не каталог "e: \\ Windows" или любые его дочерние элементы:</span><span class="sxs-lookup"><span data-stu-id="f6c54-223">The following shows a \<scope> element that will search the documents special folder, but not its children, the "E:" volume and its children, but not "E:\\windows" directory or any of its children:</span></span>

```XML
...
    <query>
        ...
        <scope>
            <include knownFolder="{FDD39AD0-238F-46AF-ADB4-6C85480369C7}" nonRecursive="true"/>
            <include path="E:\"/>
            <exclude path="E:\Windows" nonRecursive="false"/>
        </scope>
        ...
    </query>
...
```

### <a name="kindlist-element"></a><span data-ttu-id="f6c54-224">Элемент \<kindList></span><span class="sxs-lookup"><span data-stu-id="f6c54-224">\<kindList> Element</span></span>

<span data-ttu-id="f6c54-225">Эти элементы определяют объединение "вида" элементов, которые должны отображаться в библиотеке.</span><span class="sxs-lookup"><span data-stu-id="f6c54-225">These elements define the union of the "kind" of items that should appear in the library.</span></span> <span data-ttu-id="f6c54-226">Допустимые значения:</span><span class="sxs-lookup"><span data-stu-id="f6c54-226">The valid values are:</span></span>

- <span data-ttu-id="f6c54-227">календарь</span><span class="sxs-lookup"><span data-stu-id="f6c54-227">calendar</span></span>
- <span data-ttu-id="f6c54-228">communication</span><span class="sxs-lookup"><span data-stu-id="f6c54-228">communication</span></span>
- <span data-ttu-id="f6c54-229">contact</span><span class="sxs-lookup"><span data-stu-id="f6c54-229">contact</span></span>
- <span data-ttu-id="f6c54-230">документ</span><span class="sxs-lookup"><span data-stu-id="f6c54-230">document</span></span>
- <span data-ttu-id="f6c54-231">email</span><span class="sxs-lookup"><span data-stu-id="f6c54-231">email</span></span>
- <span data-ttu-id="f6c54-232">feed</span><span class="sxs-lookup"><span data-stu-id="f6c54-232">feed</span></span>
- <span data-ttu-id="f6c54-233">folder</span><span class="sxs-lookup"><span data-stu-id="f6c54-233">folder</span></span>
- <span data-ttu-id="f6c54-234">игра</span><span class="sxs-lookup"><span data-stu-id="f6c54-234">game</span></span>
- <span data-ttu-id="f6c54-235">инстантмессаже</span><span class="sxs-lookup"><span data-stu-id="f6c54-235">instantmessage</span></span>
- <span data-ttu-id="f6c54-236">векселей</span><span class="sxs-lookup"><span data-stu-id="f6c54-236">journal</span></span>
- <span data-ttu-id="f6c54-237">link</span><span class="sxs-lookup"><span data-stu-id="f6c54-237">link</span></span>
- <span data-ttu-id="f6c54-238">кинофильм</span><span class="sxs-lookup"><span data-stu-id="f6c54-238">movie</span></span>
- <span data-ttu-id="f6c54-239">music</span><span class="sxs-lookup"><span data-stu-id="f6c54-239">music</span></span>
- <span data-ttu-id="f6c54-240">Примечание.</span><span class="sxs-lookup"><span data-stu-id="f6c54-240">note</span></span>
- <span data-ttu-id="f6c54-241">picture</span><span class="sxs-lookup"><span data-stu-id="f6c54-241">picture</span></span>
- <span data-ttu-id="f6c54-242">программа</span><span class="sxs-lookup"><span data-stu-id="f6c54-242">program</span></span>
- <span data-ttu-id="f6c54-243">рекордедтв</span><span class="sxs-lookup"><span data-stu-id="f6c54-243">recordedtv</span></span>
- <span data-ttu-id="f6c54-244">сеарчфолдер</span><span class="sxs-lookup"><span data-stu-id="f6c54-244">searchfolder</span></span>
- <span data-ttu-id="f6c54-245">задача</span><span class="sxs-lookup"><span data-stu-id="f6c54-245">task</span></span>
- <span data-ttu-id="f6c54-246">видео</span><span class="sxs-lookup"><span data-stu-id="f6c54-246">video</span></span>
- <span data-ttu-id="f6c54-247">Журнал</span><span class="sxs-lookup"><span data-stu-id="f6c54-247">webhistory</span></span>
- <span data-ttu-id="f6c54-248">элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-248">item</span></span>
- <span data-ttu-id="f6c54-249">др.</span><span class="sxs-lookup"><span data-stu-id="f6c54-249">other</span></span>

### <a name="conditions-element"></a><span data-ttu-id="f6c54-250">Элемент \<conditions></span><span class="sxs-lookup"><span data-stu-id="f6c54-250">\<conditions> Element</span></span>

<span data-ttu-id="f6c54-251">Условия — это фильтры, по которым сравниваются результаты поиска.</span><span class="sxs-lookup"><span data-stu-id="f6c54-251">Conditions are filters against which search results are compared.</span></span> <span data-ttu-id="f6c54-252">Например, можно отфильтровать результаты, соответствующие определенным критериям, например имя автора или размер файла.</span><span class="sxs-lookup"><span data-stu-id="f6c54-252">For example, you can filter results that meet certain criteria, like author name or file size.</span></span> <span data-ttu-id="f6c54-253">Набор условий встроен в одно дерево условий с логическими и, или, а не ветвями.</span><span class="sxs-lookup"><span data-stu-id="f6c54-253">The set of conditions are built into a single condition tree with logical AND, OR and NOT branches.</span></span>

<span data-ttu-id="f6c54-254">В следующем примере показана структура \<condition> элемента.</span><span class="sxs-lookup"><span data-stu-id="f6c54-254">The following example shows the structure of the \<condition> element.</span></span>

```XML
...
    <query>
        ...
        <conditions>
            <condition type="" ...>
                <attributes>
                    <attribute attributeID="" .../>
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

<span data-ttu-id="f6c54-255">Тип условия может быть одним из следующих:</span><span class="sxs-lookup"><span data-stu-id="f6c54-255">The condition type can be one of the following:</span></span>

| <span data-ttu-id="f6c54-256">Тип</span><span class="sxs-lookup"><span data-stu-id="f6c54-256">Type</span></span>          | <span data-ttu-id="f6c54-257">Описание</span><span class="sxs-lookup"><span data-stu-id="f6c54-257">Description</span></span>                                 | <span data-ttu-id="f6c54-258">Доступные атрибуты</span><span class="sxs-lookup"><span data-stu-id="f6c54-258">Available Attributes</span></span>                               |
|---------------|---------------------------------------------|----------------------------------------------------|
| <span data-ttu-id="f6c54-259">andCondition</span><span class="sxs-lookup"><span data-stu-id="f6c54-259">andCondition</span></span>  | <span data-ttu-id="f6c54-260">Умножение двух или более дочерних условий</span><span class="sxs-lookup"><span data-stu-id="f6c54-260">Conjunction of two or more child conditions</span></span> | <span data-ttu-id="f6c54-261">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-261">n/a</span></span>                                                |
| <span data-ttu-id="f6c54-262">оркондитион</span><span class="sxs-lookup"><span data-stu-id="f6c54-262">orCondition</span></span>   | <span data-ttu-id="f6c54-263">Отсоединение двух из более дочерних условий</span><span class="sxs-lookup"><span data-stu-id="f6c54-263">Disjunction of two of more child conditions</span></span> | <span data-ttu-id="f6c54-264">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-264">n/a</span></span>                                                |
| <span data-ttu-id="f6c54-265">ноткондитион</span><span class="sxs-lookup"><span data-stu-id="f6c54-265">notCondition</span></span>  | <span data-ttu-id="f6c54-266">Отрицание дочернего условия</span><span class="sxs-lookup"><span data-stu-id="f6c54-266">Negation of a child condition</span></span>               | <span data-ttu-id="f6c54-267">Недоступно</span><span class="sxs-lookup"><span data-stu-id="f6c54-267">n/a</span></span>                                                |
| <span data-ttu-id="f6c54-268">леафкондитион</span><span class="sxs-lookup"><span data-stu-id="f6c54-268">leafCondition</span></span> | <span data-ttu-id="f6c54-269">Сравнивает свойство со значением</span><span class="sxs-lookup"><span data-stu-id="f6c54-269">Compares a property to value</span></span>                | <span data-ttu-id="f6c54-270">свойство, propertyType, оператор, значение, ValueType</span><span class="sxs-lookup"><span data-stu-id="f6c54-270">property, propertyType, operator, value, valuetype</span></span> |

<span data-ttu-id="f6c54-271">\<leafCondition>Атрибуты элемента определяют свойства и значения, по которым фильтруются результаты.</span><span class="sxs-lookup"><span data-stu-id="f6c54-271">The \<leafCondition> element's attributes identify the properties and values the results are filtered against.</span></span>

### <a name="example-conditions-element"></a><span data-ttu-id="f6c54-272">Пример: \<conditions> элемент</span><span class="sxs-lookup"><span data-stu-id="f6c54-272">Example: \<conditions> Element</span></span>

<span data-ttu-id="f6c54-273">В следующем примере отфильтруются результаты для всех непрочитанных элементов, созданных Джон.</span><span class="sxs-lookup"><span data-stu-id="f6c54-273">The following example filters results for all unread items authored by John.</span></span> <span data-ttu-id="f6c54-274">Это значит, что свойство System. «Read» имеет значение false, а строка «John» отображается в свойствах System. Author или System. Итемаусорс.</span><span class="sxs-lookup"><span data-stu-id="f6c54-274">That is, the System.IsRead property is false and the string "john" appears in the System.Author or System.ItemAuthors properties.</span></span>

```XML
...
    <query>
        ...
        <conditions>

            <condition type="andCondition">

                <condition type="leafCondition"
                           property="System.IsRead"
                           operator="eq"
                           value="FALSE"/>

                <condition type="orCondition">

                    <condition type="leafCondition"
                               property="System.Author"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                    <condition type="leafCondition"
                               property="System.ItemAuthors"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                </condition>

            </condition>

        </conditions>

    </query>
...
```

## <a name="properties-element"></a><span data-ttu-id="f6c54-275">Элемент \<properties></span><span class="sxs-lookup"><span data-stu-id="f6c54-275">\<properties> Element</span></span>

<span data-ttu-id="f6c54-276">\<properties>Элемент описывает свойства сохраненного поиска.</span><span class="sxs-lookup"><span data-stu-id="f6c54-276">The \<properties> element describes the properties of the saved search itself.</span></span> <span data-ttu-id="f6c54-277">Сохраненные файлы поиска поддерживают четыре свойства: \<author> , \<kind> , \<description> и \<tags> .</span><span class="sxs-lookup"><span data-stu-id="f6c54-277">Saved search files support four properties: \<author>, \<kind>, \<description>, and \<tags>.</span></span> <span data-ttu-id="f6c54-278">Они предназначены только для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="f6c54-278">These are for internal use only.</span></span>

## <a name="full-specification-of-the-search-ms-file-format"></a><span data-ttu-id="f6c54-279">Полная спецификация формата файла поиска MS</span><span class="sxs-lookup"><span data-stu-id="f6c54-279">Full Specification of the search-ms File Format</span></span>

<span data-ttu-id="f6c54-280">Ниже приведен пример полного XML-кода для сохраненного файла поиска.</span><span class="sxs-lookup"><span data-stu-id="f6c54-280">The following is an example of the full XML for a saved search file.</span></span>

```XML
<?xml version="1.0"?>

<persistedQuery version="1.0">

    <!-- The viewInfo section defines how results are displayed to the end user -->
    <viewInfo viewMode=""       <!-- details | icons | tiles -->
              iconSize=""       <!-- Integer -->
              stackIconSize=""  <!-- Do not use -->
              displayName=""    <!-- Do not use -->
              folderFlags=""    <!-- Do not use -->
              taskFlags=""      <!-- Do not use -->
              autoListFlags=""> <!-- Do not use -->

        <visibleColumns>
            <column viewField=""/>  <!-- System.[propertyname] -->
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/> <!-- Do not use -->
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>  <!-- Do not use -->
        </columnChooserColumns >

        <groupBy viewField=""       <!-- System.[propertyname] -->
                 direction=""/>     <!-- ascending | descending -->

        <stackList>
            <stack viewField=""/>   <!-- Do not use -->
        </stackList>

        <sortList>
            <sort viewField=""      <!-- System.[propertyname] -->
                  direction=""/>    <!-- ascending | descending -->
        </sortList>
    </viewInfo>

    <!-- The query section defines what gets searched (locations, file kinds) -->
    <query>
        <providers>
            <provider clsid=""/>          <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>

    <!-- The properties section identifies properties of the saved search file itself. -->
    <properties>
        ...             <!-- Do not use -->
    </properties>

</persistedQuery>
```

## <a name="examples-of-saved-searches"></a><span data-ttu-id="f6c54-281">Примеры сохраненных поисков</span><span class="sxs-lookup"><span data-stu-id="f6c54-281">Examples of Saved Searches</span></span>

<span data-ttu-id="f6c54-282">Ниже приведены примеры \* файлов. Search-MS.</span><span class="sxs-lookup"><span data-stu-id="f6c54-282">The following are examples of \*.search-ms files.</span></span>

### <a name="recent-documentssearch-ms"></a><span data-ttu-id="f6c54-283">Недавние документы. Поиск-МС</span><span class="sxs-lookup"><span data-stu-id="f6c54-283">Recent Documents.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUZZXD-30NU" propertyType="wstr" />
        </conditions>
        <kindList>
            <kind name="Document"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recent-musicsearch-ms"></a><span data-ttu-id="f6c54-284">Недавние музыкальные. Search — MS</span><span class="sxs-lookup"><span data-stu-id="f6c54-284">Recent Music.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUW-1WNNU" propertyType="wstr"/>
        </conditions>
        <kindList>
            <kind name="Music"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recently-shared-by-mesearch-ms"></a><span data-ttu-id="f6c54-285">Недавно общие для меня. Поиск — МС</span><span class="sxs-lookup"><span data-stu-id="f6c54-285">Recently Shared by Me.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <visibleColumns>
            <column viewField="System.ItemNameDisplay"/>
            <column viewField="System.DateModified"/>
            <column viewField="System.Keywords"/>
            <column viewField="System.SharedWith"/>
            <column viewField="System.ItemFolderPathDisplayNarrow"/>
        </visibleColumns>
        <frequentlyUsedColumns>
            <column viewField="System.Author"/>
            <column viewField="System.Kind"/>
            <column viewField="System.Size"/>
            <column viewField="System.Title"/>
            <column viewField="System.Rating"/>
        </frequentlyUsedColumns>
        <sortList>
            <sort viewField="System.SharedWith" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="andCondition">
                <condition type="leafCondition" property="System.IsShared" operator="eq" value="true"/>
                <condition type="leafCondition" property="System.FileOwner" operator="eq" value="[Me]"/>
            </condition>
        </conditions>
        <kindList>
            <kind name="item"/>
        </kindList>
        <scope>
            <include knownFolder="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"/>
            <include knownFolder="{DFDF76A2-C82A-4D63-906A-5644AC457385}"/>
        </scope>
    </query>
</persistedQuery>
```
