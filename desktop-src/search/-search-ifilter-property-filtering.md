---
description: Свойства извлекаются из элементов с помощью зарегистрированных обработчиков свойств или с помощью фильтров, зарегистрированных для конкретных типов файлов. Обработчик фильтра (реализация интерфейса IFilter) может интерпретировать содержимое типа файла любым числом способов.
ms.assetid: 6701d151-c36f-43e5-929b-9831c5ce5823
title: Возвращение свойств из обработчика фильтра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4df0bfc811176e9b0672dbcbe4ef4f04f3c3a6f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105719313"
---
# <a name="returning-properties-from-a-filter-handler"></a><span data-ttu-id="bb482-104">Возвращение свойств из обработчика фильтра</span><span class="sxs-lookup"><span data-stu-id="bb482-104">Returning Properties from a Filter Handler</span></span>

<span data-ttu-id="bb482-105">Свойства извлекаются из элементов с помощью зарегистрированных обработчиков свойств или с помощью фильтров, зарегистрированных для конкретных типов файлов.</span><span class="sxs-lookup"><span data-stu-id="bb482-105">Properties are extracted from items using registered property handlers, or using filters registered for specific file types.</span></span> <span data-ttu-id="bb482-106">Обработчик фильтра (реализация интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) может интерпретировать содержимое типа файла любым числом способов.</span><span class="sxs-lookup"><span data-stu-id="bb482-106">A filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) can interpret the contents of a file type in any number of ways.</span></span>

<span data-ttu-id="bb482-107">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bb482-107">This topic is organized as follows:</span></span>

- [<span data-ttu-id="bb482-108">Фильтрация свойств</span><span class="sxs-lookup"><span data-stu-id="bb482-108">Property Filtering</span></span>](#returning-properties-from-a-filter-handler)
  - [<span data-ttu-id="bb482-109">Ограничения размера свойства</span><span class="sxs-lookup"><span data-stu-id="bb482-109">Property Size Limitations</span></span>](#property-size-limitations)
- [<span data-ttu-id="bb482-110">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="bb482-110">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="bb482-111">См. также</span><span class="sxs-lookup"><span data-stu-id="bb482-111">Related topics</span></span>](#related-topics)

## <a name="property-filtering"></a><span data-ttu-id="bb482-112">Фильтрация свойств</span><span class="sxs-lookup"><span data-stu-id="bb482-112">Property Filtering</span></span>

<span data-ttu-id="bb482-113">Рекомендации по фильтрации свойств приведены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="bb482-113">Best practices for property filtering are listed in the following table.</span></span>

| <span data-ttu-id="bb482-114">Метод</span><span class="sxs-lookup"><span data-stu-id="bb482-114">Method</span></span>                                                | <span data-ttu-id="bb482-115">Описание</span><span class="sxs-lookup"><span data-stu-id="bb482-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="bb482-116">**IFilter:: init**</span><span class="sxs-lookup"><span data-stu-id="bb482-116">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)      | <span data-ttu-id="bb482-117">Возвращает перечисление [**\_ флагов IFILTER**](/windows/win32/api/filter/ne-filter-ifilter_flags) .</span><span class="sxs-lookup"><span data-stu-id="bb482-117">Returns the [**IFILTER\_FLAGS**](/windows/win32/api/filter/ne-filter-ifilter_flags) enumeration.</span></span> <span data-ttu-id="bb482-118">Если для *члена \_ \_ \_ свойств OLE флагов IFILTER* этого перечисления задано значение One, то Windows Search использует интерфейсы интерфейсов [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) и [ипропертистораже](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) для перечисления и доступа к свойствам внешнего типа значения.</span><span class="sxs-lookup"><span data-stu-id="bb482-118">If the *IFILTER\_FLAGS\_OLE\_PROPERTIES* member of this enumeration is set to one, then Windows Search uses the [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) and [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) interfaces interfaces to enumerate and access external value-type properties.</span></span> |
| [<span data-ttu-id="bb482-119">**IFilter:: "блок"**</span><span class="sxs-lookup"><span data-stu-id="bb482-119">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk) | <span data-ttu-id="bb482-120">Возвращает сведения из документа в блоках с типом блока (текст или значение), именем и языковым стандартом.</span><span class="sxs-lookup"><span data-stu-id="bb482-120">Returns information from a document in "chunks" with chunk type (text or value), name, and locale.</span></span> <span data-ttu-id="bb482-121">Блок содержит одно свойство документа.</span><span class="sxs-lookup"><span data-stu-id="bb482-121">A chunk contains one document property.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="bb482-122">**IFilter:: GetText**</span><span class="sxs-lookup"><span data-stu-id="bb482-122">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)   | <span data-ttu-id="bb482-123">Возвращает свойство текстового типа из фрагмента.</span><span class="sxs-lookup"><span data-stu-id="bb482-123">Gets a text-type property from a chunk.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="bb482-124">**IFilter:: GetValue**</span><span class="sxs-lookup"><span data-stu-id="bb482-124">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue) | <span data-ttu-id="bb482-125">Возвращает свойство "тип значения" из фрагмента.</span><span class="sxs-lookup"><span data-stu-id="bb482-125">Gets a value-type property from a chunk.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                        |

<span data-ttu-id="bb482-126">На следующем рисунке показан пример документа.</span><span class="sxs-lookup"><span data-stu-id="bb482-126">The following illustration shows an example document.</span></span> <span data-ttu-id="bb482-127">Свойство внешнего типа значения `DocTitle` (полученное с помощью методов интерфейсов [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) и [ипропертистораже](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) ) и внутреннее свойство типа значения `Book` (полученное в результате реализации пользовательского [**интерфейса IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) описывают документ в целом.</span><span class="sxs-lookup"><span data-stu-id="bb482-127">The external value-type property `DocTitle` (obtained using methods of the [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) and [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) interfaces) and the internal value-type property `Book` (obtained as a result of a custom [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation) describe the document as a whole.</span></span> <span data-ttu-id="bb482-128">Свойства текстового типа `Contents` и `Chapter` описывают содержимое документа.</span><span class="sxs-lookup"><span data-stu-id="bb482-128">The text-type properties `Contents` and `Chapter` describe the content of the document.</span></span> <span data-ttu-id="bb482-129">При обработке этого документа обработчик фильтра (реализация интерфейса **IFilter** ) определяет и извлекает эти свойства.</span><span class="sxs-lookup"><span data-stu-id="bb482-129">When processing this document, the filter handler (an implementation of the **IFilter** interface) identifies and extracts these properties.</span></span>

![Схема, показывающая элементы типичного документа](images/ifilterpropertyextraction.png)

### <a name="property-size-limitations"></a><span data-ttu-id="bb482-131">Ограничения размера свойства</span><span class="sxs-lookup"><span data-stu-id="bb482-131">Property Size Limitations</span></span>

<span data-ttu-id="bb482-132">Существует два возможных ограничения размера свойства:</span><span class="sxs-lookup"><span data-stu-id="bb482-132">There are two potential limitations to property size:</span></span>

- <span data-ttu-id="bb482-133">Максимальный размер данных, принимаемых службой поиска Windows на файл.</span><span class="sxs-lookup"><span data-stu-id="bb482-133">The maximum size of data that Windows Search accepts per file.</span></span>
- <span data-ttu-id="bb482-134">Максимальный размер для каждого свойства, как определено в файле описания свойства.</span><span class="sxs-lookup"><span data-stu-id="bb482-134">The maximum size per property as defined in the property description file.</span></span>

<span data-ttu-id="bb482-135">В настоящее время при вычислении объема данных, принимаемых из элемента, Поиск Windows не использует определенный размер свойства.</span><span class="sxs-lookup"><span data-stu-id="bb482-135">Currently, Windows Search does not use the defined property size when calculating the amount of data it accepts from an item.</span></span> <span data-ttu-id="bb482-136">Вместо этого для параметра предел, используемый для поиска Windows, задается размер файла и значение `MaxGrowFactor` (Размер файла N \* максгровфактор), считанное из реестра.</span><span class="sxs-lookup"><span data-stu-id="bb482-136">Instead, the limit Windows Search uses is the product of the size of the file and the `MaxGrowFactor` (file size N \* MaxGrowFactor) read from the registry.</span></span> <span data-ttu-id="bb482-137">Значение по умолчанию `MaxGrowFactor` — 4.</span><span class="sxs-lookup"><span data-stu-id="bb482-137">The default `MaxGrowFactor` is four.</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Gathering Manager
            MaxGrowFactor
```

<span data-ttu-id="bb482-138">Следовательно, если тип файла является небольшим в общем размере, но имеет большие свойства, Поиск Windows может не принимать все данные свойства, которые вы хотите выпустить.</span><span class="sxs-lookup"><span data-stu-id="bb482-138">Consequently, if your file type tends to be small in total size but have larger properties, Windows Search may not accept all the property data you want to emit.</span></span> <span data-ttu-id="bb482-139">Тем не менее, можно увеличить в соответствии с `MaxGrowFactor` вашими потребностями.</span><span class="sxs-lookup"><span data-stu-id="bb482-139">However, you can increase the `MaxGrowFactor` to suit your needs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="bb482-140">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="bb482-140">Additional Resources</span></span>

- <span data-ttu-id="bb482-141">Пример кода [ифилтерсампле](-search-sample-ifiltersample.md) , доступный на [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), демонстрирует создание базового класса IFilter для реализации интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="bb482-141">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="bb482-142">Общие сведения о процессе индексирования см. [в разделе процесс индексирования](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb482-142">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="bb482-143">Общие сведения о типах файлов см. в разделе [типы файлов](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="bb482-143">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="bb482-144">Сведения о запросе атрибутов сопоставления файлов для типа файлов см. в разделе [перцеиведтипес, системфилеассоЦиатионс и регистрация приложения](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="bb482-144">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>
- <span data-ttu-id="bb482-145">Общие сведения о свойствах и обработчиках свойств, а также список системных свойств, которые можно использовать для форматов файлов, см. в разделе [Разработка обработчиков свойств для поиска Windows](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="bb482-145">For an overview of properties and property handlers, and a list of system properties that you can use for your file formats, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bb482-146">См. также</span><span class="sxs-lookup"><span data-stu-id="bb482-146">Related topics</span></span>

[<span data-ttu-id="bb482-147">Разработка обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="bb482-147">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="bb482-148">О обработчиках фильтров в поиске Windows</span><span class="sxs-lookup"><span data-stu-id="bb482-148">About Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="bb482-149">Рекомендации по созданию обработчиков фильтров в поиске Windows</span><span class="sxs-lookup"><span data-stu-id="bb482-149">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="bb482-150">Обработчики фильтров, поставляемые с Windows</span><span class="sxs-lookup"><span data-stu-id="bb482-150">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="bb482-151">Реализация обработчиков фильтров в поиске Windows</span><span class="sxs-lookup"><span data-stu-id="bb482-151">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="bb482-152">Регистрация обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="bb482-152">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="bb482-153">Тестирование обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="bb482-153">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
