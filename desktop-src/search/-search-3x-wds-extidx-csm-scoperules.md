---
description: Диспетчер области обхода содержимого (CSM) позволяет определять правила области, включающие или исключающие URL-адреса из области обхода для поиска Windows.
ms.assetid: 132a55f9-680d-438e-b983-f5ce4cf66a41
title: Управление правилами области
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20d45199726cfe36dc1c4936e9ac7699a288c3ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144197"
---
# <a name="managing-scope-rules"></a><span data-ttu-id="ebdf7-103">Управление правилами области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-103">Managing Scope Rules</span></span>

<span data-ttu-id="ebdf7-104">Диспетчер области обхода содержимого (CSM) позволяет определять правила области, включающие или исключающие URL-адреса из области обхода для поиска Windows.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-104">The Crawl Scope Manager (CSM) enables you define scope rules that include or exclude URLs from the Windows Search crawl scope.</span></span>

<span data-ttu-id="ebdf7-105">CSM позволяет выполнять следующие действия:</span><span class="sxs-lookup"><span data-stu-id="ebdf7-105">The CSM lets you do the following:</span></span>

-   <span data-ttu-id="ebdf7-106">Добавить новые правила области в набор рабочих правил</span><span class="sxs-lookup"><span data-stu-id="ebdf7-106">Add new scope rules to the working rule set</span></span>
-   <span data-ttu-id="ebdf7-107">Удалить существующие правила области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-107">Remove existing scope rules</span></span>
-   <span data-ttu-id="ebdf7-108">Перечислить правила области по умолчанию</span><span class="sxs-lookup"><span data-stu-id="ebdf7-108">Enumerate default scope rules</span></span>
-   <span data-ttu-id="ebdf7-109">Обнаружение того, включен ли определенный URL-адрес в область обхода содержимого или исключен из него, или имеет правило области действия "родитель" или "дочерняя"</span><span class="sxs-lookup"><span data-stu-id="ebdf7-109">Discover whether a particular URL is included or excluded from the crawl scope or has a parent or child scope rule</span></span>

 

<span data-ttu-id="ebdf7-110">В этом разделе рассматриваются следующие вопросы.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-110">This topic includes the following subjects:</span></span>

-   [<span data-ttu-id="ebdf7-111">О правилах области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-111">About Scope Rules</span></span>](#about-scope-rules)
-   [<span data-ttu-id="ebdf7-112">Перед началом</span><span class="sxs-lookup"><span data-stu-id="ebdf7-112">Before You Begin</span></span>](#before-you-begin)
-   [<span data-ttu-id="ebdf7-113">Добавление правил области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-113">Adding Scope Rules</span></span>](#adding-scope-rules)
    -   [<span data-ttu-id="ebdf7-114">Примечания к пользовательским правилам</span><span class="sxs-lookup"><span data-stu-id="ebdf7-114">Notes on User Rules</span></span>](#notes-on-user-rules)
-   [<span data-ttu-id="ebdf7-115">Удаление правил области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-115">Removing Scope Rules</span></span>](#removing-scope-rules)
-   [<span data-ttu-id="ebdf7-116">Возврат к правилам по умолчанию</span><span class="sxs-lookup"><span data-stu-id="ebdf7-116">Reverting to Default Rules</span></span>](#reverting-to-default-rules)
-   [<span data-ttu-id="ebdf7-117">Перечисление правил области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-117">Enumerating Scope Rules</span></span>](#enumerating-scope-rules)
-   [<span data-ttu-id="ebdf7-118">Правила области трассировки</span><span class="sxs-lookup"><span data-stu-id="ebdf7-118">Tracing Scope Rules</span></span>](#tracing-scope-rules)
-   [<span data-ttu-id="ebdf7-119">См. также</span><span class="sxs-lookup"><span data-stu-id="ebdf7-119">Related topics</span></span>](#related-topics)

## <a name="about-scope-rules"></a><span data-ttu-id="ebdf7-120">О правилах области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-120">About Scope Rules</span></span>

<span data-ttu-id="ebdf7-121">Правило области — это правило, которое включает или исключает URL-адреса в корне поиска для обхода и индексирования.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-121">A scope rule is a rule that includes or excludes URLs within a search root from being crawled and indexed.</span></span> <span data-ttu-id="ebdf7-122">Правила включения приводят к тому, что индексатор включает этот URL-адрес в область скравл, а правила исключения приводят к тому, что индексатор исключит этот URL-адрес (и его дочерние элементы) из области сканирования.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-122">Inclusion rules cause the indexer to include that URL in the scrawl scope, and exclusion rules cause the indexer exclude that URL (and its children) from the crawl scope.</span></span>

<span data-ttu-id="ebdf7-123">Например, предположим, что вы установили новое приложение, файлы данных которого находятся в папке Ворктеама \\ ProjectFiles на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-123">For example, suppose you've installed a new application whose data files are located in the folder WorkteamA\\ProjectFiles on a local computer.</span></span> <span data-ttu-id="ebdf7-124">Предположим, что вы хотите, чтобы все элементы в папке ProjectFiles были индексированы, за исключением элементов в прототипах вложенных папок.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-124">Suppose you want everything within the ProjectFiles folder indexed except for items in the subfolder Prototypes.</span></span> <span data-ttu-id="ebdf7-125">В этом случае вам потребуется правило включения для myPH:///C: \\ ворктеама \\ ProjectFiles \\ и правило исключения для MyPH:///C: \\ ворктеама \\ ProjectFiles \\ prototype \\ .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-125">In this situation, you would need an inclusion rule for myPH:///C:\\WorkteamA\\ProjectFiles\\ and an exclusion rule for myPH:///C:\\WorkteamA\\ProjectFiles\\Prototypes\\.</span></span>

<span data-ttu-id="ebdf7-126">Существует три типа правил со следующим порядком приоритета.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-126">There are three types of rules, with the following order of precedence:</span></span>

1.  <span data-ttu-id="ebdf7-127">Правила групповая политика задаются администраторами и могут переопределять все остальные правила.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-127">Group Policy rules are set by administrators and can override all other rules.</span></span>
2.  <span data-ttu-id="ebdf7-128">Пользовательские правила задаются пользователями, изменяющими область в пользовательском интерфейсе параметров поиска Windows.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-128">User rules are set by users modifying the scope in the Windows Search options user interface.</span></span> <span data-ttu-id="ebdf7-129">Пользователи или другие приложения могут удалить все правила пользователя и вернуться к правилам по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-129">Users or other applications can remove all user rules and revert to default rules.</span></span>
3.  <span data-ttu-id="ebdf7-130">Правила по умолчанию обычно задаются приложением для определения области по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-130">Default rules are typically set by an application to define a default scope.</span></span> <span data-ttu-id="ebdf7-131">Например, правила по умолчанию могут быть установлены при добавлении нового обработчика протокола или контейнера в систему.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-131">For example, default rules might be set when a new protocol handler or container is added to the system.</span></span>

<span data-ttu-id="ebdf7-132">Вместе эти типы правил составляют *Рабочий набор правил* , из которого диспетчер области СКАНИРОВАНИЯ (CSM) создает полный список URL-адресов для обхода.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-132">Together, these types of rules comprise the *working rule set* from which the Crawl Scope Manager (CSM) generates the full list of URLs to crawl.</span></span> <span data-ttu-id="ebdf7-133">Хотя правила по умолчанию могут быть переопределены правилами групповой политики и пользовательскими правилами, они сохраняются в собственном наборе правил по умолчанию, к которому можно вернуться в любое время.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-133">While default rules can be overridden by group policy rules and by user rules, they are maintained in their own default rule set, which you can revert to at any time.</span></span> <span data-ttu-id="ebdf7-134">Индексатор обходит URL-адреса из набора рабочих правил и добавляет элементы, свойства и содержимое в каталог.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-134">The indexer crawls the URLs from the working rule set and adds items, properties, and content to the catalog.</span></span>

> [!Note]  
> <span data-ttu-id="ebdf7-135">Пользователи с доступом к панели управления могут изменять правила через этот интерфейс.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-135">Users with access to Control Panel can modify the rules through that interface.</span></span> <span data-ttu-id="ebdf7-136">Поэтому приложения, предлагающие Управление областью, должны всегда получать правила непосредственно из CSM с помощью методов перечисления, а не полагаться на сохраненную копию пользовательских правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-136">Therefore, applications offering scope management should always get the rules directly from the CSM by using the enumeration methods instead of relying on a saved copy of user rules.</span></span>

 

<span data-ttu-id="ebdf7-137">Правила исключения могут определять URL-адреса шаблонов с подстановочным знаком " \* ", например: file:///C: \\ Project a \\ \* \\ .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-137">Exclusion rules can define pattern URLs with the wildcard character '\*'; for example: file:///C:\\ProjectA\\\*\\.</span></span> <span data-ttu-id="ebdf7-138">Правило исключения, использующее этот шаблон, запрещает индексатору выполнять обход содержимого папок в каталоге проекта.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-138">An exclusion rule using this pattern prevents the indexer from crawling any folders under the ProjectA directory.</span></span> <span data-ttu-id="ebdf7-139">Для более сложного примера предположим, что существует правило включения для file:///C: \\ Project \\ а и правило шаблона исключения для file:///C: \\ \\ \* \\ данные проекта \\ \* .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-139">For a more complicated example, suppose there is an inclusion rule for file:///C:\\ProjectA\\ and an exclusion pattern rule for file:///C:\\ProjectA\\\*\\data\\\*.</span></span> <span data-ttu-id="ebdf7-140">В этом случае индексатор будет выполнять обход элементов в:</span><span class="sxs-lookup"><span data-stu-id="ebdf7-140">In this case, the indexer would crawl items in:</span></span>

-   <span data-ttu-id="ebdf7-141">C: \\ проект а</span><span class="sxs-lookup"><span data-stu-id="ebdf7-141">C:\\ProjectA</span></span>\\
-   <span data-ttu-id="ebdf7-142">C: \\ Project a \\ **версии 1** \\ тестфилес</span><span class="sxs-lookup"><span data-stu-id="ebdf7-142">C:\\ProjectA\\**version1**\\testfiles</span></span>\\
-   <span data-ttu-id="ebdf7-143">В. \\ проект a \\ **версии 1 \\ временные** \\ данные</span><span class="sxs-lookup"><span data-stu-id="ebdf7-143">C:\\ProjectA\\**version1\\temp**\\data</span></span>\\

<span data-ttu-id="ebdf7-144">Но индексатор не будет выполнять обход элементов в:</span><span class="sxs-lookup"><span data-stu-id="ebdf7-144">But the indexer would not crawl items in:</span></span>

-   <span data-ttu-id="ebdf7-145">В. \\ проектная \\ **версии 1** \\ данных</span><span class="sxs-lookup"><span data-stu-id="ebdf7-145">C:\\ProjectA\\**version1**\\data</span></span>\\

 

## <a name="before-you-begin"></a><span data-ttu-id="ebdf7-146">Перед началом</span><span class="sxs-lookup"><span data-stu-id="ebdf7-146">Before You Begin</span></span>

<span data-ttu-id="ebdf7-147">Прежде чем использовать любой из интерфейсов диспетчера области сканирования, необходимо выполнить следующие предварительные действия.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-147">Before you use any of the Crawl Scope Manager interfaces, you must perform the following prerequisite steps:</span></span>

1.  <span data-ttu-id="ebdf7-148">Создайте объект **ксеарчманажер** и получите его интерфейс **исеарчманажер** .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-148">Create the **CSearchManager** object and obtain its **ISearchManager** interface.</span></span>
2.  <span data-ttu-id="ebdf7-149">Вызовите **исеарчманажер:: catalog** для "системиндекс", чтобы получить экземпляр интерфейса **исеарчкаталогманажер** .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-149">Call **ISearchManager::GetCatalog** for "SystemIndex" to obtain an instance of the **ISearchCatalogManager** interface.</span></span>
3.  <span data-ttu-id="ebdf7-150">Вызовите метод **исеарчкаталогманажер:: жеткравлскопеманажер** , чтобы получить экземпляр интерфейса **исеарчкравлскопеманажер** .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-150">Call **ISearchCatalogManager::GetCrawlScopeManager** to obtain an instance of the **ISearchCrawlScopeManager** interface.</span></span>

<span data-ttu-id="ebdf7-151">После внесения изменений в Диспетчер области обхода содержимого необходимо вызвать метод [**исеарчкравлскопеманажер:: савеалл**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-saveall) .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-151">After making any changes to the Crawl Scope Manager, you must call the [**ISearchCrawlScopeManager::SaveAll**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-saveall) method.</span></span> <span data-ttu-id="ebdf7-152">Этот метод не принимает параметров и возвращает значение S \_ ОК в случае успеха.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-152">This method takes no parameters and returns S\_OK on success.</span></span>

 

## <a name="adding-scope-rules"></a><span data-ttu-id="ebdf7-153">Добавление правил области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-153">Adding Scope Rules</span></span>

<span data-ttu-id="ebdf7-154">Рабочие правила, заданные для CSM, включают правила пользователя и по умолчанию, а также правила, принудительно применяемые групповой политикой.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-154">The working rules set for the CSM includes user and default rules, as well as any rules forced by group policy.</span></span> <span data-ttu-id="ebdf7-155">Пользовательские правила настраиваются пользователями в пользовательском интерфейсе, а правила по умолчанию могут быть установлены любым из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="ebdf7-155">User rules are set up by users in a user interface, and default rules can be set by any of the following:</span></span>

-   <span data-ttu-id="ebdf7-156">Групповые политики, реализуемые системным администратором (не используют интерфейс [**исеарчкравлскопеманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) ).</span><span class="sxs-lookup"><span data-stu-id="ebdf7-156">Group policies implemented by a system administrator (These do not use the [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) interface.)</span></span>
-   <span data-ttu-id="ebdf7-157">Установка или обновление приложения, например Windows Search или обработчика протокола.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-157">The installation or update of an application like Windows Search or a protocol handler</span></span>
-   <span data-ttu-id="ebdf7-158">Приложение установки для добавления нового хранилища данных или контейнера</span><span class="sxs-lookup"><span data-stu-id="ebdf7-158">A setup application for the addition of a new data store or container</span></span>

<span data-ttu-id="ebdf7-159">[**Исеарчкравлскопеманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) предоставляет два метода для добавления новых правил области, как описано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-159">The [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) provides two methods for adding new scope rules, as described in the following table.</span></span> <span data-ttu-id="ebdf7-160">Пути для правил включения файловой системы должны заканчиваться обратной косой чертой \\ (например, file:///C: \\ Files \\ ), а пути для правил исключения должны заканчиваться звездочкой (например, file:///c: \\ Files \\ \* ).</span><span class="sxs-lookup"><span data-stu-id="ebdf7-160">Paths for inclusion rules for the file system must end with a backslash '\\' (for example, file:///C:\\files\\), and paths for exclusion rules must end with an asterisk (for example, file:///c:\\files\\\*).</span></span> <span data-ttu-id="ebdf7-161">Только правила исключения могут содержать URL-адреса шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-161">Only exclusion rules can contain pattern URLs.</span></span> <span data-ttu-id="ebdf7-162">Кроме того, рекомендуется включить в пути идентификаторы безопасности пользователей (SID) для повышения безопасности.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-162">Furthermore, we recommend including users' security identifiers (SIDs) in paths, for better security.</span></span> <span data-ttu-id="ebdf7-163">Пути для каждого пользователя более безопасны, так как запросы будут выполняться в пользовательском процессе, гарантируя, что один пользователь не сможет видеть элементы, индексируемые из папки "Входящие" другого пользователя, например.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-163">Per-user paths are more secure as queries would then run in a per-user process, ensuring that one user cannot see items indexed from another user's inbox, for example.</span></span>

<span data-ttu-id="ebdf7-164">В следующей таблице описаны методы интерфейса Исеарчкравлскопеманажер, используемые для добавления новых правил области.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-164">The following table describes the methods of the ISearchCrawlScopeManager interface used for adding new scope rules.</span></span>



| <span data-ttu-id="ebdf7-165">Метод</span><span class="sxs-lookup"><span data-stu-id="ebdf7-165">Method</span></span>                                                                              | <span data-ttu-id="ebdf7-166">Описание</span><span class="sxs-lookup"><span data-stu-id="ebdf7-166">Description</span></span>                                                                                                                                                                                                                  |
|-------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ebdf7-167">**аддусерскоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-167">**AddUserScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-adduserscoperule)       | <span data-ttu-id="ebdf7-168">Добавляет правило для URL-адреса, указанного пользователем.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-168">Adds a rule for a URL, as specified by the user.</span></span> <span data-ttu-id="ebdf7-169">Эти правила переопределяют правила по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-169">These rules override default rules.</span></span> <span data-ttu-id="ebdf7-170">Используйте этот метод, если вы реализовали пользовательский интерфейс, позволяющий пользователям управлять собственными правилами области действия и URL-адресами.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-170">Use this method if you have implemented a user interface that lets users manage their own scope rules and URLs.</span></span>                         |
| [<span data-ttu-id="ebdf7-171">**адддефаултскоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-171">**AddDefaultScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-adddefaultscoperule) | <span data-ttu-id="ebdf7-172">Добавляет правило для URL-адреса в соответствии с указаниями другого приложения, например обработчика протокола.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-172">Adds a rule for a URL, as specified by another application like a protocol handler.</span></span> <span data-ttu-id="ebdf7-173">Используйте этот метод при реализации нового обработчика протокола или добавлении нового хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-173">Use this method when you have implemented a new protocol handler or added a new data store.</span></span> <span data-ttu-id="ebdf7-174">Эти правила могут быть переопределены правилами пользователя.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-174">These rules can be overridden by user rules.</span></span> |



 

<span data-ttu-id="ebdf7-175">Каждый метод принимает URL-адрес индексируемого расположения и флаги, которые определяют, следует ли включать или исключать URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-175">Each method takes a URL to an indexable location and flags that determine whether the URL should be included or excluded.</span></span> <span data-ttu-id="ebdf7-176">Параметр *ффолловфлагс* зарезервирован для использования в будущем.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-176">The *fFollowFlags* parameter is reserved for future use.</span></span> <span data-ttu-id="ebdf7-177">Когда вы добавляете новое правило области, и Диспетчер области обхода содержимого определяет, что правило уже существует (в зависимости от указанного URL-адреса или шаблона), набор рабочих правил обновляется таким образом, что старое правило заменяется новым правилом, и (2) правила пользователя, противоречащие его удалению.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-177">When you add a new scope rule and the Crawl Scope Manager determines that the rule already exists (based on the URL or the pattern provided), the working rule set is updated so that (1) the old rule is replaced by the new rule and (2) any user rules that contradict it are removed.</span></span>

<span data-ttu-id="ebdf7-178">**Совет.** Хотя корневой элемент file://включен в область обхода содержимого по умолчанию, программные файлы не индексируются по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-178">**Tip:** While the file:// root is included by default in the crawl scope, Program Files is not indexed by default.</span></span> <span data-ttu-id="ebdf7-179">Поэтому приложения с данными, сохраненными в каталоге программных файлов, должны добавить их расположение в качестве правила по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-179">Therefore, applications with data saved to their Program Files directory need to add their location as a default rule.</span></span>

### <a name="notes-on-user-rules"></a><span data-ttu-id="ebdf7-180">Примечания к пользовательским правилам</span><span class="sxs-lookup"><span data-stu-id="ebdf7-180">Notes on User Rules</span></span>

<span data-ttu-id="ebdf7-181">Если новое правило пользователя совпадает с существующим правилом по умолчанию, новое правило переопределяет правило по умолчанию в наборе рабочих правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-181">If a new user rule is the same as an existing default rule, the new user rule overrides the default rule in the working rule set.</span></span> <span data-ttu-id="ebdf7-182">Если новое правило пользователя совпадает с существующим правилом пользователя, старое правило пользователя заменяется.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-182">If the new user rule is the same as an existing user rule, the old user rule is replaced.</span></span>

<span data-ttu-id="ebdf7-183">Установка флага *фоверридечилдрен* приводит к следующим результатам в рабочем наборе правил:</span><span class="sxs-lookup"><span data-stu-id="ebdf7-183">Setting the flag *fOverrideChildren* has the following results in the working rule set:</span></span>

-   <span data-ttu-id="ebdf7-184">**Значение true** приводит к удалению всех дочерних правил из набора рабочих правил (правил пользователя и правил по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="ebdf7-184">**TRUE** results in the removal of all child rules from the working rule set (both user rules and default rules).</span></span>
-   <span data-ttu-id="ebdf7-185">Значение FALSE приводит к повторному добавлению рабочих правил задает все правила по умолчанию, дочерние для нового правила пользователя.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-185">FALSE results in re-adding to the working rules set all the default rules that are children of the new user rule.</span></span> <span data-ttu-id="ebdf7-186">Если дочернее правило по умолчанию является включением, а новое правило пользователя является исключением, правило по умолчанию изменяется на правило включения пользователя.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-186">If a child default rule is an inclusion and the new user rule is an exclusion, the default rule is changed to an inclusion user rule.</span></span>

 

## <a name="removing-scope-rules"></a><span data-ttu-id="ebdf7-187">Удаление правил области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-187">Removing Scope Rules</span></span>

<span data-ttu-id="ebdf7-188">Вы можете использовать интерфейс [**исеарчкравлскопеманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) для удаления правила области из набора рабочих правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-188">You can use the [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) interface to remove a scope rule from the working rule set.</span></span> <span data-ttu-id="ebdf7-189">Этот интерфейс предоставляет следующие два метода для удаления правил области.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-189">This interface provides the following two methods for removing scope rules.</span></span>



| <span data-ttu-id="ebdf7-190">Метод</span><span class="sxs-lookup"><span data-stu-id="ebdf7-190">Method</span></span>                                                                                    | <span data-ttu-id="ebdf7-191">Описание</span><span class="sxs-lookup"><span data-stu-id="ebdf7-191">Description</span></span>                                                                                                                                                                                           |
|-------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ebdf7-192">**ремовескоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-192">**RemoveScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removescoperule)               | <span data-ttu-id="ebdf7-193">Удаляет правило пользователя для указанного URL-адреса из набора рабочих правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-193">Removes a user rule for a specified URL from the working rule set.</span></span> <span data-ttu-id="ebdf7-194">Если правило пользователя дублируется или переопределяет правило по умолчанию, правило по умолчанию остается в наборе рабочих правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-194">If the user rule is a duplicate of or overrides a default rule, the default rule remains in the working rule set.</span></span>                  |
| [<span data-ttu-id="ebdf7-195">**ремоведефаултскоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-195">**RemoveDefaultScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removedefaultscoperule) | <span data-ttu-id="ebdf7-196">Удаляет правило по умолчанию для указанного URL-адреса из набора рабочих правил и набора правил по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-196">Removes a default rule for a specified URL from both the working rule set and the default rule set.</span></span> <span data-ttu-id="ebdf7-197">После вызова этого метода вы не сможете вернуться к этому правилу по умолчанию с помощью Реверттодефаултскопес.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-197">After calling this method, you cannot revert to this default rule by using RevertToDefaultScopes.</span></span> |



 

<span data-ttu-id="ebdf7-198">Каждый метод принимает URL-адрес и флаг, указывающий, является ли удаляемое правило правилом включения или исключения.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-198">Each method takes a URL and a flag indicating whether the rule to be removed is an inclusion or exclusion rule.</span></span> <span data-ttu-id="ebdf7-199">Эти методы возвращают ошибку, если не найдено правило с этим URL-адресом и флагом включения или исключения.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-199">These methods returns an error if a rule with that URL and inclusion/exclusion flag is not found.</span></span>

<span data-ttu-id="ebdf7-200">**Совет.** Если вы хотите полностью удалить область из области сканирования, используйте метод [**ремоверут**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removeroot) , который удаляет корень поиска и все связанные правила области.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-200">**Tip:** If you want to remove a scope from the crawl scope entirely, use the [**RemoveRoot**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removeroot) method, which removes the search root and all associated scope rules.</span></span> <span data-ttu-id="ebdf7-201">Например, это рекомендуется сделать при удалении.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-201">Doing this while uninstalling, for example, is considered best practice.</span></span>

<span data-ttu-id="ebdf7-202">Кроме того, можно удалить все переопределения набора пользователей для корня поиска и вернуться к исходному диапазону поиска и правилам области по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-202">It is also possible to remove all user-set overrides of a search root and revert to the original search root and default scope rules.</span></span> <span data-ttu-id="ebdf7-203">Дополнительные сведения см. в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-203">For more information, refer to the next section.</span></span>

> [!Note]  
> <span data-ttu-id="ebdf7-204">В Windows Vista, если пользователи удаляются с помощью профилей пользователей на панели управления, CSM удаляет все правила и корни, включающие их идентификаторы безопасности, и удаляет их индексированные элементы из каталога.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-204">On Windows Vista, if users are removed through User Profiles in Control Panel, CSM removes all rules and roots that include their SID and removes their indexed items from the catalog.</span></span> <span data-ttu-id="ebdf7-205">В Windows XP необходимо вручную удалить корни и правила пользователей.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-205">On Windows XP, you must remove the users' roots and rules manually.</span></span>

 

 

## <a name="reverting-to-default-rules"></a><span data-ttu-id="ebdf7-206">Возврат к правилам по умолчанию</span><span class="sxs-lookup"><span data-stu-id="ebdf7-206">Reverting to Default Rules</span></span>

<span data-ttu-id="ebdf7-207">При возврате к правилам по умолчанию удаляются все правила пользователя для URL-адреса или корня, а все правила по умолчанию восстанавливаются в набор рабочих правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-207">Reverting to default rules removes all user rules for a URL or root and restores all default rules to the working rule set.</span></span> <span data-ttu-id="ebdf7-208">Однако он не удаляет правила, заданные групповой политикой.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-208">It does not, however, remove rules set by group policy.</span></span> <span data-ttu-id="ebdf7-209">Метод [**реверттодефаултскопес**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-reverttodefaultscopes) не принимает параметров и возвращает код ошибки, если не удается вернуться к правилам по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-209">The [**RevertToDefaultScopes**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-reverttodefaultscopes) method takes no parameters and returns an error code if it is unable to revert to default rules.</span></span>

 

## <a name="enumerating-scope-rules"></a><span data-ttu-id="ebdf7-210">Перечисление правил области</span><span class="sxs-lookup"><span data-stu-id="ebdf7-210">Enumerating Scope Rules</span></span>

<span data-ttu-id="ebdf7-211">CSM перечисляет правила области с помощью стандартного интерфейса перечислителя в стиле COM, [**иенумсеарчскоперулес**](/windows/desktop/api/Searchapi/nn-searchapi-ienumsearchscoperules) .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-211">The CSM enumerates scope rules by using a standard COM-style enumerator interface, [**IEnumSearchScopeRules**](/windows/desktop/api/Searchapi/nn-searchapi-ienumsearchscoperules) .</span></span> <span data-ttu-id="ebdf7-212">Этот интерфейс можно использовать для перечисления правил области для нескольких целей.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-212">You can use this interface to enumerate scope rules for several purposes.</span></span> <span data-ttu-id="ebdf7-213">Например, может потребоваться отобразить весь набор рабочих правил в пользовательском интерфейсе или определить, находится ли правило или дочернее правило в области обхода содержимого.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-213">For example, you might want to display the entire working rule set in a user interface, or discover whether a rule or the child of a rule is already in the crawl scope.</span></span>

 

## <a name="tracing-scope-rules"></a><span data-ttu-id="ebdf7-214">Правила области трассировки</span><span class="sxs-lookup"><span data-stu-id="ebdf7-214">Tracing Scope Rules</span></span>

<span data-ttu-id="ebdf7-215">CSM также позволяет определить, включен ли указанный URL-адрес в область сканирования и имеет ли оно правило области действия "родитель" или "дочерняя".</span><span class="sxs-lookup"><span data-stu-id="ebdf7-215">The CSM also enables you to determine whether a specified URL is included in the crawl scope and whether it has a parent or child scope rule.</span></span> <span data-ttu-id="ebdf7-216">Кроме того, можно узнать, почему URL-адрес включен или исключен из области сканирования.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-216">You can also find out why a URL is included or excluded from the crawl scope.</span></span> <span data-ttu-id="ebdf7-217">Эти методы не предназначены для использования с URL-адресами шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-217">These methods are not intended to be used with pattern URLs.</span></span>

<span data-ttu-id="ebdf7-218">В следующей таблице описаны методы [**исеарчкравлскопеманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) , используемые для добавления новых правил области.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-218">The following table describes the methods of [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) used for adding new scope rules.</span></span>



| <span data-ttu-id="ebdf7-219">Метод</span><span class="sxs-lookup"><span data-stu-id="ebdf7-219">Method</span></span>                                                                                      | <span data-ttu-id="ebdf7-220">Описание</span><span class="sxs-lookup"><span data-stu-id="ebdf7-220">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ebdf7-221">**жетпарентскопеверсионид**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-221">**GetParentScopeVersionId**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-getparentscopeversionid) | <span data-ttu-id="ebdf7-222">Возвращает идентификатор версии родительского URL-адреса включения.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-222">Gets the version ID of the parent inclusion URL.</span></span> <span data-ttu-id="ebdf7-223">С помощью этого метода можно узнать, изменилась ли родительская область со времени последней проверки.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-223">You can use this method to see if the parent scope has changed since the last time you checked it.</span></span><br/> <span data-ttu-id="ebdf7-224">Пример. Если приложение электронной почты использует уведомления, управляемые поставщиком, оно может получить версию родительской области, прежде чем будет закрыто, и снова проверить версию при ее открытии.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-224">Example: If a mail application uses provider-managed notifications, it might get the parent scope version before it closes and check the version again when it opens.</span></span> <span data-ttu-id="ebdf7-225">Затем приложение может определить, требуется ли отправлять в индексатор новый набор уведомлений.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-225">Then the application can determine whether it needs to push a new set of notifications to the indexer.</span></span><br/> |
| [<span data-ttu-id="ebdf7-226">**хасчилдскоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-226">**HasChildScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-haschildscoperule)             | <span data-ttu-id="ebdf7-227">Возвращает **значение true** , если указанный URL-адрес имеет дочернее правило (правило, применяемое к дочернему элементу на любом уровне в иерархии URL-адресов).</span><span class="sxs-lookup"><span data-stu-id="ebdf7-227">Returns **TRUE** if the specified URL has a child rule (a rule applying to a child at any level within its URL hierarchy).</span></span> <br/> <span data-ttu-id="ebdf7-228">Пример. Если URL-адрес — file:///C: \\ Folder \\ , этот метод возвращает **значение true** , если CSM имеет правило области действия специально для \\ \\ вложенной папки File:///C: Folder \\ .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-228">Example: If the URL is file:///C:\\Folder\\, this method returns **TRUE** if the CSM has a scope rule specifically for file:///C:\\Folder\\Subfolder\\.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="ebdf7-229">**хаспарентскоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-229">**HasParentScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-hasparentscoperule)           | <span data-ttu-id="ebdf7-230">Возвращает **значение true** , если указанный URL-адрес имеет родительское правило (правило применяется к родительскому элементу на любом уровне иерархии URL-адресов).</span><span class="sxs-lookup"><span data-stu-id="ebdf7-230">Returns **TRUE** if the specified URL has a parent rule (a rule applying to a parent at any level in the URL hierarchy).</span></span><br/> <span data-ttu-id="ebdf7-231">Пример. Если URL-адрес является вложенной папкой file:///C: \\ Folder \\ , этот метод возвращает **значение true** , если CSM имеет правило области действия специально для file:///C: \\ Folder \\ .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-231">Example: If the URL is file:///C:\\Folder\\Subfolder, this method returns **TRUE** if the CSM has a scope rule specifically for file:///C:\\Folder\\.</span></span><br/>                                                                                                                                                   |
| [<span data-ttu-id="ebdf7-232">**инклудединкравлскопе**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-232">**IncludedInCrawlScope**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscope)       | <span data-ttu-id="ebdf7-233">Возвращает **значение true** , если указанный URL-адрес включен в область обхода содержимого.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-233">Returns **TRUE** if the specified URL is included in the crawl scope.</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="ebdf7-234">**инклудединкравлскопикс**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-234">**IncludedInCrawlScopeEx**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscopeex)   | <span data-ttu-id="ebdf7-235">Возвращает значение из перечисления [**клусион \_ Reason**](/windows/win32/api/searchapi/ne-searchapi-clusion_reason) , объясняющее, почему URL-адрес включен в область сканирования или исключен из нее, и получает значение **true** , если URL-адрес включен в область сканирования.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-235">Returns a value from the [**CLUSION\_REASON**](/windows/win32/api/searchapi/ne-searchapi-clusion_reason) enumeration explaining why the URL is included in or excluded from the crawl scope, and retrieves the value **TRUE** if the URL is included in the crawl scope.</span></span> <span data-ttu-id="ebdf7-236">Этот метод помогает выявить конфликты в наборе рабочих правил.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-236">This method can help you identify conflicts in your working rule set.</span></span>                                                                                                                                       |



 

 

> [!Note]  
> <span data-ttu-id="ebdf7-237">Методы [**инклудединкравлскопе**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscope) и [**инклудединкравлскопикс**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscopeex) определяют, будет ли выполняться обход содержимого URL-адреса только на основе правил в CSM.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-237">The [**IncludedInCrawlScope**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscope) and [**IncludedInCrawlScopeEx**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscopeex) methods determine whether the URL will be crawled based solely on the rules in the CSM.</span></span> <span data-ttu-id="ebdf7-238">Есть и другие причины, по которым URL-адрес не обходится, например задается бит ФАНЦИ (т. е. пользователь запретил возможность быстрого индексирования в диалоговом окне Свойства папки).</span><span class="sxs-lookup"><span data-stu-id="ebdf7-238">There can be other reasons that a URL is not crawled, such as the FANCI bit being set (that is, a user has disallowed fast indexing in the folder's Property dialog box.)</span></span>

 

<span data-ttu-id="ebdf7-239">Если вы считаете, что путь к файлу должен быть исключен, но указан как включенный, убедитесь, что правила исключения заканчиваются на " <path> \\ \* ".</span><span class="sxs-lookup"><span data-stu-id="ebdf7-239">If you believe that a file path should be excluded, but it is listed as included, be sure that exclusion rules end with "<path>\\\*".</span></span> <span data-ttu-id="ebdf7-240">Если вы считаете, что файл или путь к файлу должны быть добавлены, но это не так, обязательно проверьте параметр ФАНЦИ bit для файла или пути.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-240">If you believe that a file or file path should be included but it is not, be sure to check the FANCI bit setting for the file or path.</span></span> <span data-ttu-id="ebdf7-241">Для этого щелкните правой кнопкой мыши файл или путь к файлу и выберите пункт **Свойства**, а затем убедитесь, что установлен флажок **для быстрого поиска, разрешить индексировать службу индексирования для этой папки** .</span><span class="sxs-lookup"><span data-stu-id="ebdf7-241">You can do this by right-clicking the file or file path and selecting **Properties**, then be sure the **For fast searching, allow Indexing Service to index this folder** checkbox is selected.</span></span> <span data-ttu-id="ebdf7-242">Если путь к файлу или файлу не помечен для индексирования, он не будет индексироваться, даже если он находится в правиле включения.</span><span class="sxs-lookup"><span data-stu-id="ebdf7-242">If the file or file path is not marked for indexing here, it will not be indexed even if it is in an inclusion rule.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ebdf7-243">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="ebdf7-243">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="ebdf7-244">**Reference**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-244">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="ebdf7-245">**исеарчкравлскопеманажер**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-245">**ISearchCrawlScopeManager**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager)
</dt> <dt>

[<span data-ttu-id="ebdf7-246">**ISearchCrawlScopeManager2**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-246">**ISearchCrawlScopeManager2**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager2)
</dt> <dt>

[<span data-ttu-id="ebdf7-247">**исеарчскоперуле**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-247">**ISearchScopeRule**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchscoperule)
</dt> <dt>

[<span data-ttu-id="ebdf7-248">**иенумсеарчскоперулес**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-248">**IEnumSearchScopeRules**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-ienumsearchscoperules)
</dt> <dt>

<span data-ttu-id="ebdf7-249">**Зрения**</span><span class="sxs-lookup"><span data-stu-id="ebdf7-249">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="ebdf7-250">Управление корнями поиска</span><span class="sxs-lookup"><span data-stu-id="ebdf7-250">Managing Search Roots</span></span>](-search-3x-wds-extidx-csm-searchroots.md)
</dt> </dl>

 

 




