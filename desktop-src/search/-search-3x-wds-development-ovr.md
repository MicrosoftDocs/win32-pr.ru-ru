---
description: Чтобы индексировать содержимое и свойства новых форматов файлов и хранилищ данных, Microsoft Windows Search необходимо расширить с помощью надстроек.
ms.assetid: 04ddcd97-c358-44d2-9092-a035436c50c9
title: Windows Search как платформа разработки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 19041ac23c90006cc2f1b2f6146cb20a6b972fc2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103808981"
---
# <a name="windows-search-as-a-development-platform"></a><span data-ttu-id="30961-103">Windows Search как платформа разработки</span><span class="sxs-lookup"><span data-stu-id="30961-103">Windows Search as a Development Platform</span></span>

<span data-ttu-id="30961-104">Чтобы индексировать содержимое и свойства новых форматов файлов и хранилищ данных, Microsoft Windows Search необходимо расширить с помощью надстроек.</span><span class="sxs-lookup"><span data-stu-id="30961-104">To index the contents and properties of new file formats and data stores, Microsoft Windows Search must be extended with add-ins.</span></span>

<span data-ttu-id="30961-105">Прежде чем сторонние разработчики новых форматов файлов и хранилищ данных смогут получить эти форматы и хранилища в результатах запроса в проводнике Windows, разработчик должен выполнить три следующих действия:</span><span class="sxs-lookup"><span data-stu-id="30961-105">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must do the following three things:</span></span>

-   <span data-ttu-id="30961-106">Реализуйте источник данных оболочки для расширения пространства имен оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-106">Implement a Shell data source to extend the Shell namespace.</span></span>
-   <span data-ttu-id="30961-107">Предоставляйте элементы в хранилище данных (если они добавляют новое хранилище данных, так как их необходимо проиндексировать).</span><span class="sxs-lookup"><span data-stu-id="30961-107">Expose items in a data store (if they are adding a new data store, because it would need to be indexed).</span></span>
-   <span data-ttu-id="30961-108">Разрабатывайте обработчик протокола, чтобы поиск Windows мог получить доступ к данным для индексирования.</span><span class="sxs-lookup"><span data-stu-id="30961-108">Develop a protocol handler so that Windows Search can access the data for indexing.</span></span>

<span data-ttu-id="30961-109">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="30961-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="30961-110">Начало работы</span><span class="sxs-lookup"><span data-stu-id="30961-110">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="30961-111">Общие сведения о сценариях разработки для поиска</span><span class="sxs-lookup"><span data-stu-id="30961-111">Overview of Search Development Scenarios</span></span>](#overview-of-search-development-scenarios)
    -   [<span data-ttu-id="30961-112">Добавление нового хранилища данных</span><span class="sxs-lookup"><span data-stu-id="30961-112">Adding a New Data Store</span></span>](#adding-a-new-data-store)
    -   [<span data-ttu-id="30961-113">Добавление нового формата файла</span><span class="sxs-lookup"><span data-stu-id="30961-113">Adding a New File Format</span></span>](#adding-a-new-file-format)
    -   [<span data-ttu-id="30961-114">Использование результатов поиска Windows</span><span class="sxs-lookup"><span data-stu-id="30961-114">Consuming Windows Search Results</span></span>](#consuming-windows-search-results)
-   [<span data-ttu-id="30961-115">Общие сведения о обработчиках</span><span class="sxs-lookup"><span data-stu-id="30961-115">Overview of Handlers</span></span>](#overview-of-handlers)
-   [<span data-ttu-id="30961-116">Рекомендации по установщику для надстройки</span><span class="sxs-lookup"><span data-stu-id="30961-116">Add-in Installer Guidelines</span></span>](#add-in-installer-guidelines)
-   [<span data-ttu-id="30961-117">Примечание для разработчиков</span><span class="sxs-lookup"><span data-stu-id="30961-117">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="30961-118">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="30961-118">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="30961-119">См. также</span><span class="sxs-lookup"><span data-stu-id="30961-119">Related topics</span></span>](#related-topics)

## <a name="getting-started"></a><span data-ttu-id="30961-120">Приступая к работе</span><span class="sxs-lookup"><span data-stu-id="30961-120">Getting Started</span></span>

<span data-ttu-id="30961-121">Прежде чем приступить к созданию приложения Windows Search, помните, что предпочтительным способом сделать это с помощью источника данных оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-121">Before you start creating a Windows Search application, remember that the preferred way to do it is through a Shell data source.</span></span> <span data-ttu-id="30961-122">Источник данных оболочки расширяет пространство имен оболочки и предоставляет элементы в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="30961-122">A Shell data source extends the Shell namespace and exposes the items in a data store.</span></span> <span data-ttu-id="30961-123">Затем элементы в хранилище данных могут индексироваться системой поиска Windows с помощью обработчика протокола.</span><span class="sxs-lookup"><span data-stu-id="30961-123">The items in the data store can then be indexed by the Windows Search system by using a protocol handler.</span></span> <span data-ttu-id="30961-124">Это непрямой подход к доступу к поиску Windows путем реализации источника данных оболочки является предпочтительным, так как он обеспечивает доступ к полным функциональным возможностям оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-124">This indirect approach for accessing Windows Search by implementing a Shell data source is preferred because it provides access to full Shell functionality.</span></span> <span data-ttu-id="30961-125">Это позволяет обеспечить разумное взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="30961-125">Doing it this way ensures a reasonable user experience.</span></span>

<span data-ttu-id="30961-126">Если требуется, чтобы результаты запроса отображались в проводнике Windows, необходимо реализовать источник данных оболочки, прежде чем можно будет создать обработчик протокола для расширения индекса.</span><span class="sxs-lookup"><span data-stu-id="30961-126">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="30961-127">Однако, если все запросы будут программно (например, OLE DB) и интерпретироваться кодом приложения, а не оболочкой, пространство имен оболочки по-прежнему является предпочтительным, но не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="30961-127">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace is still preferred but not required.</span></span>

<span data-ttu-id="30961-128">Обработчик протокола необходим для того, чтобы система Windows получала сведения о содержимом файла, например элементы в базах данных или пользовательские типы файлов.</span><span class="sxs-lookup"><span data-stu-id="30961-128">A protocol handler is required for Windows to obtain knowledge of file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="30961-129">Хотя Windows Search может индексировать имя и свойства файла, Windows не имеет сведений о содержимом файла.</span><span class="sxs-lookup"><span data-stu-id="30961-129">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="30961-130">В результате такие элементы не могут индексироваться или быть представлены в оболочке Windows.</span><span class="sxs-lookup"><span data-stu-id="30961-130">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="30961-131">Реализуя пользовательский обработчик протокола, вы можете предоставить эти элементы.</span><span class="sxs-lookup"><span data-stu-id="30961-131">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="30961-132">Список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь достичь, см. в разделе [Обзор обработчиков](#overview-of-handlers).</span><span class="sxs-lookup"><span data-stu-id="30961-132">For a list of handlers identified by the developer scenario you are trying to achieve, see [Overview of Handlers](#overview-of-handlers).</span></span>

## <a name="overview-of-search-development-scenarios"></a><span data-ttu-id="30961-133">Общие сведения о сценариях разработки для поиска</span><span class="sxs-lookup"><span data-stu-id="30961-133">Overview of Search Development Scenarios</span></span>

<span data-ttu-id="30961-134">Ниже перечислены наиболее распространенные сценарии разработки в Windows Search.</span><span class="sxs-lookup"><span data-stu-id="30961-134">The most common development scenarios in Windows Search are:</span></span>

-   [<span data-ttu-id="30961-135">Добавление нового хранилища данных</span><span class="sxs-lookup"><span data-stu-id="30961-135">Adding a new data store</span></span>](#adding-a-new-data-store)
-   [<span data-ttu-id="30961-136">Добавление нового формата файла</span><span class="sxs-lookup"><span data-stu-id="30961-136">Adding a new file format</span></span>](#adding-a-new-file-format)
-   [<span data-ttu-id="30961-137">Использование результатов поиска Windows</span><span class="sxs-lookup"><span data-stu-id="30961-137">Consuming Windows Search results</span></span>](#consuming-windows-search-results)

### <a name="adding-a-new-data-store"></a><span data-ttu-id="30961-138">Добавление нового хранилища данных</span><span class="sxs-lookup"><span data-stu-id="30961-138">Adding a New Data Store</span></span>

<span data-ttu-id="30961-139">Хранилище данных оболочки для поиска Windows требуется, только если вы добавляете новое хранилище данных для индексирования.</span><span class="sxs-lookup"><span data-stu-id="30961-139">You need a Shell data store for Windows Search only if you are adding a new data store to be indexed.</span></span> <span data-ttu-id="30961-140">Хранилище данных — это репозиторий данных, которые могут быть предоставлены модели программирования оболочки в качестве контейнера с помощью источника данных оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-140">A data store is a repository of data that can be exposed to the Shell programming model as a container by using a Shell data source.</span></span> <span data-ttu-id="30961-141">Затем элементы в хранилище данных могут индексироваться системой поиска Windows с помощью обработчика протокола.</span><span class="sxs-lookup"><span data-stu-id="30961-141">The items in a data store can then be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="30961-142">Обработчик протокола реализует протокол для доступа к источнику содержимого в собственном формате.</span><span class="sxs-lookup"><span data-stu-id="30961-142">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="30961-143">Интерфейсы [**исеарчпротокол**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) и [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) используются для реализации пользовательского обработчика протокола, чтобы расширить источники данных, которые могут быть проиндексированы.</span><span class="sxs-lookup"><span data-stu-id="30961-143">The [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <span data-ttu-id="30961-144">Сведения о создании источника данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="30961-144">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

### <a name="adding-a-new-file-format"></a><span data-ttu-id="30961-145">Добавление нового формата файла</span><span class="sxs-lookup"><span data-stu-id="30961-145">Adding a New File Format</span></span>

<span data-ttu-id="30961-146">При добавлении нового пользовательского формата файла необходимо разработать обработчик фильтра или обработчик свойства, но не то и другое.</span><span class="sxs-lookup"><span data-stu-id="30961-146">If you add a new custom file format, you need to develop either a filter handler or a property handler, but not both.</span></span> <span data-ttu-id="30961-147">Фильтр является реализацией интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="30961-147">A filter is an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="30961-148">Он открывает файлы определенного типа, а также фильтрует свойства и фрагменты текста для индексатора.</span><span class="sxs-lookup"><span data-stu-id="30961-148">It opens files of a particular file type, and filters properties and chunks of text for the indexer.</span></span> <span data-ttu-id="30961-149">Фильтры связаны с типами файлов, как отмечены расширениями имен файлов, типами MIME или идентификаторами классов (CLSID).</span><span class="sxs-lookup"><span data-stu-id="30961-149">Filters are associated with file types, as denoted by file name extensions, MIME types, or class identifiers (CLSIDs).</span></span> <span data-ttu-id="30961-150">Хотя один фильтр может работать с несколькими типами файлов, каждый тип файлов работает только с одним фильтром.</span><span class="sxs-lookup"><span data-stu-id="30961-150">Although one filter can handle multiple file types, each file type works with only one filter.</span></span>

<span data-ttu-id="30961-151">Обработчик свойств преобразует данные, хранящиеся в файле, в структурированную схему, которая распознается и может быть доступна в проводнике Windows, Windows Search и других приложениях.</span><span class="sxs-lookup"><span data-stu-id="30961-151">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="30961-152">Затем эти системы могут взаимодействовать с обработчиком свойств для записи и чтения свойств в файл и из него.</span><span class="sxs-lookup"><span data-stu-id="30961-152">These systems can then interact with the property handler to write and read properties to and from a file.</span></span> <span data-ttu-id="30961-153">Переведенные данные включают в себя представление Details, инфотипс, область сведений, страницы свойств и т. д.</span><span class="sxs-lookup"><span data-stu-id="30961-153">The translated data includes details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="30961-154">Каждый обработчик свойств связан с определенным типом файла, определяемым расширением имени файла.</span><span class="sxs-lookup"><span data-stu-id="30961-154">Each property handler is associated with a particular file type, identified by the file name extension.</span></span> <span data-ttu-id="30961-155">Для этого необходим обработчик свойства.</span><span class="sxs-lookup"><span data-stu-id="30961-155">You need a property handler to do the following:</span></span>

-   <span data-ttu-id="30961-156">Отображение свойств неиндексированного элемента в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="30961-156">Show non-indexed item properties in the UI.</span></span>
-   <span data-ttu-id="30961-157">Поддержка записи свойств.</span><span class="sxs-lookup"><span data-stu-id="30961-157">Support writing properties.</span></span>

### <a name="consuming-windows-search-results"></a><span data-ttu-id="30961-158">Использование результатов поиска Windows</span><span class="sxs-lookup"><span data-stu-id="30961-158">Consuming Windows Search Results</span></span>

<span data-ttu-id="30961-159">В следующих разделах описаны несколько способов использования результатов поиска Windows.</span><span class="sxs-lookup"><span data-stu-id="30961-159">The following sections describe several ways of consuming Windows Search results:</span></span>

-   [<span data-ttu-id="30961-160">Запрос данных</span><span class="sxs-lookup"><span data-stu-id="30961-160">Querying data</span></span>](#querying-data)
-   [<span data-ttu-id="30961-161">Запрос к удаленным хранилищам данных (федеративный поиск)</span><span class="sxs-lookup"><span data-stu-id="30961-161">Querying remote data stores (Federated Search)</span></span>](#querying-remote-data-stores-federated-search)
-   [<span data-ttu-id="30961-162">Индексирование файлов и элементов</span><span class="sxs-lookup"><span data-stu-id="30961-162">Indexing files and items</span></span>](#indexing-files-and-items)
-   [<span data-ttu-id="30961-163">Индексирование хранилища данных</span><span class="sxs-lookup"><span data-stu-id="30961-163">Indexing a data store</span></span>](#indexing-a-data-store)
-   [<span data-ttu-id="30961-164">Управление процессом индексирования</span><span class="sxs-lookup"><span data-stu-id="30961-164">Managing the indexing process</span></span>](#managing-the-indexing-process)
-   [<span data-ttu-id="30961-165">Интеграция системы свойств Windows с приложениями Windows Search</span><span class="sxs-lookup"><span data-stu-id="30961-165">Integrating the Windows Property System with Windows Search applications</span></span>](#integrating-the-windows-property-system-with-windows-search-applications)

### <a name="querying-data"></a><span data-ttu-id="30961-166">Запросы к данным</span><span class="sxs-lookup"><span data-stu-id="30961-166">Querying Data</span></span>

<span data-ttu-id="30961-167">Разработчики, пишущие приложения поверх Объединенного Windows Search и системы свойств Windows, могут обращаться к файлам и элементам независимо от типа приложения или файла.</span><span class="sxs-lookup"><span data-stu-id="30961-167">Developers writing applications on top of the combined Windows Search and Windows property system can access files and items regardless of application or file type.</span></span> <span data-ttu-id="30961-168">Существуют два способа доступа приложений к данным индексатора.</span><span class="sxs-lookup"><span data-stu-id="30961-168">There are two ways for applications to access the indexer data:</span></span>

-   <span data-ttu-id="30961-169">Приложения напрямую взаимодействуют с OLE DB, отправляя запросы Windows Search язык SQL (SQL) поставщику OLE DB поиска Windows для получения результатов.</span><span class="sxs-lookup"><span data-stu-id="30961-169">Applications communicate directly with OLE DB by sending Windows Search Structured Query Language (SQL) queries to the Windows Search OLE DB provider to retrieve results.</span></span> <span data-ttu-id="30961-170">Запросы можно создавать вручную или с помощью интерфейса [**исеарчкуерихелпер**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) , чтобы создать выражение SQL из ключевых слов поиска, а также расширенный синтаксис запросов (АКС).</span><span class="sxs-lookup"><span data-stu-id="30961-170">Queries can be constructed manually or by using the [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) interface to generate the SQL from search keywords, and Advanced Query Syntax (AQS).</span></span>
-   <span data-ttu-id="30961-171">Приложения работают на уровне оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-171">Applications work through the Shell layer.</span></span> <span data-ttu-id="30961-172">Преимущество уровня оболочки заключается в том, что он также поддерживает другие источники, такие как grep.</span><span class="sxs-lookup"><span data-stu-id="30961-172">The advantage of the Shell layer is that it also supports other sources like grep.</span></span> <span data-ttu-id="30961-173">Однако недостаток заключается в том, что не все функции индексатора доступны.</span><span class="sxs-lookup"><span data-stu-id="30961-173">However, the disadvantage is that not all indexer features are available.</span></span>

<span data-ttu-id="30961-174">Другим вариантом является использование протоколов Search-MS://и search://, которые выполняют поиск на основе URL-адресов, отображаемые с помощью проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="30961-174">Another option is using the search-ms:// and search:// protocols, which execute URL-based searches rendered through Windows Explorer.</span></span> <span data-ttu-id="30961-175">Этот параметр обеспечивает очень тонкую разработку, но не возвращает результаты или выбор пользователей из представления результатов в вызывающее приложение.</span><span class="sxs-lookup"><span data-stu-id="30961-175">This option enables the lightest-weight development but does not return results or user selections from the results view to the calling application.</span></span> <span data-ttu-id="30961-176">Кроме того, как и другие протоколы, сторонние приложения поиска могут использовать протоколы Search-MS://и search://, если приложения соответствуют требуемому набору функций.</span><span class="sxs-lookup"><span data-stu-id="30961-176">Also, like other protocols, third-party search applications can take over the search-ms:// and search:// protocols if the applications conform to the required feature set.</span></span> <span data-ttu-id="30961-177">Дополнительные сведения о запросах см. в разделе [Обработка запросов в Windows Search](querying-process--windows-search-.md) и [выполнение запросов к индексу программным способом](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="30961-177">For more information on querying, see [Querying Process in Windows Search](querying-process--windows-search-.md) and [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

### <a name="querying-remote-data-stores-federated-search"></a><span data-ttu-id="30961-178">Запрос к удаленным хранилищам данных (федеративный поиск)</span><span class="sxs-lookup"><span data-stu-id="30961-178">Querying Remote Data Stores (Federated Search)</span></span>

<span data-ttu-id="30961-179">В Windows 7 и более поздних версиях федеративный поиск предлагает новый поставщик поиска, который запрашивает удаленные хранилища данных через веб-серверы, по протоколу [OpenSearch](https://github.com/dewitt/opensearch) и перечисляет результаты в виде XML-каналов RSS или Atom.</span><span class="sxs-lookup"><span data-stu-id="30961-179">In Windows 7 and later, federated search offers a new search provider that queries remote data stores through web servers, through the [OpenSearch](https://github.com/dewitt/opensearch) protocol, and enumerates the results as RSS or Atom XML feeds.</span></span> <span data-ttu-id="30961-180">Соединители поиска — это соединения пространств имен, имитирующие поведение папки с помощью поставщика поиска.</span><span class="sxs-lookup"><span data-stu-id="30961-180">Search Connectors are namespace junctions that simulate folder behavior by using a search provider.</span></span> <span data-ttu-id="30961-181">Дополнительные сведения о Федерации поиска в удаленных хранилищах данных в Windows 7 см. [в разделе федеративный поиск в Windows](-search-federated-search-overview.md).</span><span class="sxs-lookup"><span data-stu-id="30961-181">For more information about search federation to remote data stores in Windows 7, see [Federated Search in Windows](-search-federated-search-overview.md).</span></span>

### <a name="indexing-files-and-items"></a><span data-ttu-id="30961-182">Индексирование файлов и элементов</span><span class="sxs-lookup"><span data-stu-id="30961-182">Indexing Files and Items</span></span>

<span data-ttu-id="30961-183">Индексируемое содержимое основано на файлах и типах данных, поддерживаемых в надстройках, включенных в поиск Windows, и правилах включения и исключения по умолчанию для папок в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="30961-183">The content that is indexed is based on the file and data types supported through add-ins included with Windows Search and the default inclusion and exclusion rules for folders in the file system.</span></span> <span data-ttu-id="30961-184">Например, фильтры, включенные в Windows Search, поддерживают более 200 распространенных типов данных, включая документы Microsoft Office, электронную почту Microsoft Outlook (в сочетании с обработчиком протокола MAPI), обычные текстовые файлы, HTML и многие другие.</span><span class="sxs-lookup"><span data-stu-id="30961-184">For example, the filters included in Window Search support over 200 common types of data, including Microsoft Office documents, Microsoft Outlook email (in conjunction with the MAPI protocol handler), plain-text files, HTML, and many more.</span></span> <span data-ttu-id="30961-185">Полный список типов файлов, которые поддерживаются изначально, см. в разделе [что входит в индекс](-search-3x-wds-included-in-index.md).</span><span class="sxs-lookup"><span data-stu-id="30961-185">For a full list of file types natively supported, see [What Is Included in the Index](-search-3x-wds-included-in-index.md).</span></span>

<span data-ttu-id="30961-186">Индекс можно расширить с помощью обработчиков свойств и фильтров, чтобы предоставить содержимое и свойства новых форматов файлов для индекса и проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="30961-186">The index can be extended with property handlers and filters to expose the content and properties of new file formats to the index and Windows Explorer.</span></span> <span data-ttu-id="30961-187">Фильтры являются реализацией интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="30961-187">Filters are an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="30961-188">Существует два вида фильтров: один, взаимодействующий с отдельными элементами, такими как файлы, и другой, взаимодействующий с контейнерами, такими как папки.</span><span class="sxs-lookup"><span data-stu-id="30961-188">There are two kinds of filters: one that interacts with individual items such as files and one that interacts with containers such as folders.</span></span> <span data-ttu-id="30961-189">Фильтры являются многозначными в том смысле, что они поддерживают Фрагментирование данных, текстовое содержимое, некоторые свойства и несколько языков.</span><span class="sxs-lookup"><span data-stu-id="30961-189">Filters are multi-purpose in that they support chunking data, text content, some properties, and multiple languages.</span></span>

<span data-ttu-id="30961-190">Напротив, обработчики свойств имеют более конкретную цель: для предоставления свойств определенных типов файлов, определяемых расширениями имен файлов.</span><span class="sxs-lookup"><span data-stu-id="30961-190">In contrast, property handlers have a more specific purpose: to expose the properties of specific file types that are identified by file name extensions.</span></span> <span data-ttu-id="30961-191">Обработчик свойства для типа файла может включать свойства Get и Set, а также может перечислить свойства, связанные с этим типом файла.</span><span class="sxs-lookup"><span data-stu-id="30961-191">A property handler for a file type can enable get and set properties, and can enumerate the properties associated with that file type.</span></span> <span data-ttu-id="30961-192">В отличие от фильтров обработчики свойств не поддерживают чуккинг данные или текстовое содержимое, а обработчики свойств не могут определить, в каком языке находится свойство текста, если только они не поддерживают запись свойств.</span><span class="sxs-lookup"><span data-stu-id="30961-192">Unlike filters, property handlers do not support chucking data or text content, and property handlers have no way of indicating what language a text property is in unless they support writing properties.</span></span>

### <a name="indexing-a-data-store"></a><span data-ttu-id="30961-193">Индексирование хранилища данных</span><span class="sxs-lookup"><span data-stu-id="30961-193">Indexing a Data Store</span></span>

<span data-ttu-id="30961-194">Индекс можно расширить с помощью обработчиков протоколов, чтобы обеспечить доступ к собственным хранилищам данных.</span><span class="sxs-lookup"><span data-stu-id="30961-194">The index can be extended with protocol handlers to provide access to proprietary data stores.</span></span> <span data-ttu-id="30961-195">Например, для файлов и элементов, содержащихся в хранилищах данных, отличных от файловой системы (например, в базах данных и хранилищах электронной почты), требуется, чтобы обработчик протокола сопоставлялся с URL-адреса в поток.</span><span class="sxs-lookup"><span data-stu-id="30961-195">For example, files and items contained in non-file-system data stores (such as databases and email stores) require a protocol handler to map from a URL to a stream.</span></span> <span data-ttu-id="30961-196">Обработчики протоколов также могут определить правильные фильтры, используемые для извлечения информации из потока.</span><span class="sxs-lookup"><span data-stu-id="30961-196">Protocol handlers can also optionally determine the correct filters to use for extracting information from a stream.</span></span> <span data-ttu-id="30961-197">Фильтры перечисляет URL-адреса хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="30961-197">Filters enumerate the data store URLs.</span></span> <span data-ttu-id="30961-198">После этого элементы по отдельности индексируются с помощью надлежащего фильтра и обработчика свойств.</span><span class="sxs-lookup"><span data-stu-id="30961-198">The items are then individually indexed using the proper filter and/or property handler.</span></span> <span data-ttu-id="30961-199">Дополнительные сведения см. [в разделе Расширение индекса](-search-3x-wds-extidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="30961-199">For more information, see [Extending the Index](-search-3x-wds-extidx-overview.md).</span></span>

### <a name="managing-the-indexing-process"></a><span data-ttu-id="30961-200">Управление процессом индексирования</span><span class="sxs-lookup"><span data-stu-id="30961-200">Managing the Indexing Process</span></span>

<span data-ttu-id="30961-201">Разработчики приложений могут управлять областью и частотой индексирования службы поиска Windows с помощью различных интерфейсов управления.</span><span class="sxs-lookup"><span data-stu-id="30961-201">Application developers can control the scope and frequency of Windows Search indexing by using various management interfaces.</span></span> <span data-ttu-id="30961-202">Эти интерфейсы включают в себя функции добавления и удаления каталогов, которые индексатор проверяет на наличие изменений, вручную уведомляет индекс изменений данных, проверяет состояние индексатора и принудительную повторную индексацию некоторых или всех данных.</span><span class="sxs-lookup"><span data-stu-id="30961-202">These interfaces include functionality to add and remove the directories that the indexer scans for changes, manually notify the index of changes to data, check the status of the indexer, and force re-indexing of some or all data.</span></span> <span data-ttu-id="30961-203">Дополнительные сведения см. [в разделе Управление индексом](-search-3x-wds-mngidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="30961-203">For more information, see [Managing the Index](-search-3x-wds-mngidx-overview.md).</span></span>

### <a name="integrating-the-windows-property-system-with-windows-search-applications"></a><span data-ttu-id="30961-204">Интеграция системы свойств Windows с приложениями Windows Search</span><span class="sxs-lookup"><span data-stu-id="30961-204">Integrating the Windows Property System with Windows Search Applications</span></span>

<span data-ttu-id="30961-205">Система свойств Windows — это расширяемая система чтения и записи определений данных, которая обеспечивает единообразный способ представления метаданных об элементах оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-205">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="30961-206">Система свойств Windows в Windows Vista и более поздних версиях позволяет хранить и извлекать метаданные для элементов оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-206">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="30961-207">Элемент оболочки — это любой отдельный фрагмент содержимого, например файл, папка, электронная почта или контакт.</span><span class="sxs-lookup"><span data-stu-id="30961-207">A Shell item is any single piece of content, such as a file, folder, email or contact.</span></span> <span data-ttu-id="30961-208">Свойство — это отдельный элемент метаданных, связанный с элементом оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-208">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="30961-209">Значения свойств выражаются в виде структуры [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="30961-209">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="30961-210">Широкий список общих свойств включается для ряда распространенных типов элементов, таких как фотографии, музыка, документы, сообщения, контакты и файлы.</span><span class="sxs-lookup"><span data-stu-id="30961-210">An extensive list of common properties is included for a number of common item types such as photos, music, documents, messages, contacts, and files.</span></span> <span data-ttu-id="30961-211">Разработчики также могут вводить собственные свойства платформы, если ни одно из существующих свойств не соответствует их потребностям.</span><span class="sxs-lookup"><span data-stu-id="30961-211">Developers can also introduce their own properties to the platform if no existing property meets their needs.</span></span> <span data-ttu-id="30961-212">Дополнительные сведения об интеграции приложений с системой свойств Windows см. в разделе [Разработка обработчиков свойств](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="30961-212">For more information on integrating applications with the Windows property system, see [Developing Property Handlers](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="overview-of-handlers"></a><span data-ttu-id="30961-213">Общие сведения о обработчиках</span><span class="sxs-lookup"><span data-stu-id="30961-213">Overview of Handlers</span></span>

<span data-ttu-id="30961-214">Обработчик — это объект модели COM, предоставляющий функциональные возможности для элемента оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-214">A handler is a Component Object Model (COM) object that provides functionality for a Shell item.</span></span> <span data-ttu-id="30961-215">Большинство источников данных оболочки предлагают расширяемую систему для привязки обработчиков к элементам.</span><span class="sxs-lookup"><span data-stu-id="30961-215">Most Shell data sources offer an extensible system for binding handlers to items.</span></span> <span data-ttu-id="30961-216">Например, папка «файловая система» использует систему взаимосвязей для поиска обработчиков определенного типа файлов.</span><span class="sxs-lookup"><span data-stu-id="30961-216">For example, the file system folder uses the association system to look up the handlers for a particular file type.</span></span> <span data-ttu-id="30961-217">Для каждого типа файлов требуется специальный обработчик.</span><span class="sxs-lookup"><span data-stu-id="30961-217">A specific handler is required for every file type.</span></span> <span data-ttu-id="30961-218">Для типа файла Adobe Acrobat. PDF требуется один обработчик фильтра, например, для формата DOC-файла и т. д. требуется другой обработчик фильтра.</span><span class="sxs-lookup"><span data-stu-id="30961-218">One filter handler is required for the Adobe Acrobat .pdf file type, for example, another filter handler is required for the .doc file format, and so forth.</span></span>

<span data-ttu-id="30961-219">Разные обработчики имеют определенную унифицированность.</span><span class="sxs-lookup"><span data-stu-id="30961-219">Different handlers have some commonality.</span></span> <span data-ttu-id="30961-220">В Windows Vista и более поздних версиях все обработчики должны использовать один из следующих интерфейсов для инициализации обработчика: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**иинитиализевиситем**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)или [**иитинитиализевисфиле**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span><span class="sxs-lookup"><span data-stu-id="30961-220">In Windows Vista and later, all handlers must use one of the following interfaces to initialize the handler: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem), or [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span></span>

<span data-ttu-id="30961-221">В следующей таблице перечислены задачи разработчика высокого уровня, тип обработчика, необходимый для каждой задачи, а также ссылка на концептуальную информацию о том, как выполнять каждую задачу.</span><span class="sxs-lookup"><span data-stu-id="30961-221">The following table lists high-level developer tasks, the type of handler needed for each task, and provides a link to conceptual information about how to perform each task.</span></span>



| <span data-ttu-id="30961-222">Задача</span><span class="sxs-lookup"><span data-stu-id="30961-222">Task</span></span>                                                                                                                                                            | <span data-ttu-id="30961-223">Обработчик</span><span class="sxs-lookup"><span data-stu-id="30961-223">Handler</span></span>                          | <span data-ttu-id="30961-224">Концептуальные сведения</span><span class="sxs-lookup"><span data-stu-id="30961-224">Conceptual information</span></span>                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="30961-225">Доступ к свойствам файла для индексирования</span><span class="sxs-lookup"><span data-stu-id="30961-225">Accessing the properties of a file for indexing</span></span>                                                                                                                 | <span data-ttu-id="30961-226">Обработчик свойства</span><span class="sxs-lookup"><span data-stu-id="30961-226">Property handler</span></span>                 | [<span data-ttu-id="30961-227">Разработка обработчиков свойств</span><span class="sxs-lookup"><span data-stu-id="30961-227">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/> [<span data-ttu-id="30961-228">Определяемые системой свойства для пользовательских форматов файлов</span><span class="sxs-lookup"><span data-stu-id="30961-228">System-Defined Properties for Custom File Formats</span></span>](-shell-systemdefinedpropertiesforfileformats.md)<br/> |
| <span data-ttu-id="30961-229">Добавление форматов буфера обмена для объекта данных ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) элемента (объекты данных используются в сценариях перетаскивания и копирования и вставки).</span><span class="sxs-lookup"><span data-stu-id="30961-229">Adding clipboard formats for the data object ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) of an item (Data objects are used in drag-and-drop and copy/paste scenarios.)</span></span> | <span data-ttu-id="30961-230">Обработчик объекта данных</span><span class="sxs-lookup"><span data-stu-id="30961-230">Data object handler</span></span>              | <span data-ttu-id="30961-231">[Создание обработчиков данных](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="30961-231">[Creating Data Handlers](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span></span>                                                                                                                                                          |
| <span data-ttu-id="30961-232">Добавление команд для элемента, который обычно отображается в контекстном меню</span><span class="sxs-lookup"><span data-stu-id="30961-232">Adding verbs for an item that are commonly displayed in a shortcut menu</span></span>                                                                                         | <span data-ttu-id="30961-233">Обработчик контекстного меню</span><span class="sxs-lookup"><span data-stu-id="30961-233">Shortcut menu handler</span></span>            | [<span data-ttu-id="30961-234">Создание обработчиков контекстного меню</span><span class="sxs-lookup"><span data-stu-id="30961-234">Creating Context Menu Handlers</span></span>](../shell/context-menu-handlers.md)<br/> [<span data-ttu-id="30961-235">Настройка контекстного меню с помощью динамических команд</span><span class="sxs-lookup"><span data-stu-id="30961-235">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](../shell/shortcut-menu-using-dynamic-verbs.md)<br/>                         |
| <span data-ttu-id="30961-236">Связывание типа файла с указанным значком</span><span class="sxs-lookup"><span data-stu-id="30961-236">Associating a file type with a specific icon</span></span>                                                                                                                    | <span data-ttu-id="30961-237">Обработчик значков</span><span class="sxs-lookup"><span data-stu-id="30961-237">Icon handler</span></span>                     | [<span data-ttu-id="30961-238">Создание обработчиков значков</span><span class="sxs-lookup"><span data-stu-id="30961-238">Creating Icon Handlers</span></span>](../shell/how-to-create-icon-handlers.md)                                                                                                                                                          |
| <span data-ttu-id="30961-239">Создание страниц свойств с изображениями и элементами управления пользовательского интерфейса, которые допускают пользовательское взаимодействие с типом файла</span><span class="sxs-lookup"><span data-stu-id="30961-239">Creating property sheets with UI pictures and controls that permit custom interaction with a file type</span></span>                                                          | <span data-ttu-id="30961-240">Обработчик страницы свойств</span><span class="sxs-lookup"><span data-stu-id="30961-240">Property sheet handler</span></span>           | <span data-ttu-id="30961-241">[Обработчики страницы свойств](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="30961-241">[Property Sheet Handlers](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span></span>                                                                                                                                                    |
| <span data-ttu-id="30961-242">Включение типа элемента для поддержки сценариев перетаскивания и копирования и вставки</span><span class="sxs-lookup"><span data-stu-id="30961-242">Enabling an item type to support drag-and-drop and copy/paste scenarios</span></span>                                                                                         | <span data-ttu-id="30961-243">Удалить обработчик</span><span class="sxs-lookup"><span data-stu-id="30961-243">Drop handler</span></span>                     | <span data-ttu-id="30961-244">[Передача объектов оболочки с помощью перетаскивания и буфера обмена](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="30961-244">[Transferring Shell Objects with Drag-and-Drop and the Clipboard](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span></span>                                                                                                                      |
| <span data-ttu-id="30961-245">Извлечение фрагментов текста и свойств документа для индексирования</span><span class="sxs-lookup"><span data-stu-id="30961-245">Extracting chunks of text and document properties for indexing</span></span>                                                                                                  | <span data-ttu-id="30961-246">Обработчик фильтра</span><span class="sxs-lookup"><span data-stu-id="30961-246">Filter handler</span></span>                   | [<span data-ttu-id="30961-247">Разработка обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="30961-247">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)                                                                                                                                           |
| <span data-ttu-id="30961-248">Индексирование нового типа файла</span><span class="sxs-lookup"><span data-stu-id="30961-248">Indexing a new file type</span></span>                                                                                                                                        | <span data-ttu-id="30961-249">Обработчик фильтра, обработчик свойств</span><span class="sxs-lookup"><span data-stu-id="30961-249">Filter handler, property handler</span></span> | [<span data-ttu-id="30961-250">Разработка обработчиков фильтров</span><span class="sxs-lookup"><span data-stu-id="30961-250">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)<br/> [<span data-ttu-id="30961-251">Разработка обработчиков свойств</span><span class="sxs-lookup"><span data-stu-id="30961-251">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/>                                          |
| <span data-ttu-id="30961-252">Индексирование содержимого хранилища данных</span><span class="sxs-lookup"><span data-stu-id="30961-252">Indexing the contents of a data store</span></span>                                                                                                                           | <span data-ttu-id="30961-253">Обработчик протокола</span><span class="sxs-lookup"><span data-stu-id="30961-253">Protocol handler</span></span>                 | [<span data-ttu-id="30961-254">Разработка обработчиков протоколов</span><span class="sxs-lookup"><span data-stu-id="30961-254">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)                                                                                                                                            |
| <span data-ttu-id="30961-255">Предварительный просмотр упрощенного представления элемента оболочки в панели предварительного просмотра проводника Windows</span><span class="sxs-lookup"><span data-stu-id="30961-255">Previewing a simplified view of the Shell item in the Windows Explorer preview pane</span></span>                                                                             | <span data-ttu-id="30961-256">Обработчик просмотра</span><span class="sxs-lookup"><span data-stu-id="30961-256">Preview handler</span></span>                  | [<span data-ttu-id="30961-257">Обработчики просмотра</span><span class="sxs-lookup"><span data-stu-id="30961-257">Preview Handlers</span></span>](../shell/preview-handlers.md)                                                                                                                                                             |
| <span data-ttu-id="30961-258">Предоставление всплывающего текста при наведении указателя мыши на объект пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="30961-258">Supplying pop-up text when a mouse hovers over a UI object</span></span>                                                                                                      | <span data-ttu-id="30961-259">Обработчик подсказок</span><span class="sxs-lookup"><span data-stu-id="30961-259">Infotip handler</span></span>                  | <span data-ttu-id="30961-260">[Создание обработчиков расширений оболочки](../shell/handlers.md) (Настройка всплывающих подсказков)</span><span class="sxs-lookup"><span data-stu-id="30961-260">[Creating Shell Extension Handlers](../shell/handlers.md) (Infotip Customization)</span></span>                                                                                                                            |
| <span data-ttu-id="30961-261">Предоставление статического изображения для представления элемента оболочки</span><span class="sxs-lookup"><span data-stu-id="30961-261">Supplying a static image to represent a Shell item</span></span>                                                                                                              | <span data-ttu-id="30961-262">Обработчик эскизов</span><span class="sxs-lookup"><span data-stu-id="30961-262">Thumbnail handler</span></span>                | <span data-ttu-id="30961-263">[Обработчики эскизов](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="30961-263">[Thumbnail Handlers](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span></span>                                                                                                                                                        |



 

<span data-ttu-id="30961-264">В следующей таблице перечислены обработчики и интерфейсы для реализации каждого типа обработчика.</span><span class="sxs-lookup"><span data-stu-id="30961-264">The following table lists handlers and the interfaces for implementing each type of handler.</span></span>



| <span data-ttu-id="30961-265">Обработчик</span><span class="sxs-lookup"><span data-stu-id="30961-265">Handler</span></span>                | <span data-ttu-id="30961-266">Интерфейсы</span><span class="sxs-lookup"><span data-stu-id="30961-266">Interfaces</span></span>                                                                                                                                                                                                                                                                                                                                                                |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="30961-267">Удалить обработчик</span><span class="sxs-lookup"><span data-stu-id="30961-267">Drop handler</span></span>           | <span data-ttu-id="30961-268">[**Интерфейс IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**идроптаржеселпер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="30961-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                      |
| <span data-ttu-id="30961-269">Обработчик объекта данных</span><span class="sxs-lookup"><span data-stu-id="30961-269">Data object handler</span></span>    | <span data-ttu-id="30961-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [ **IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="30961-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span>                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="30961-271">Обработчик фильтра</span><span class="sxs-lookup"><span data-stu-id="30961-271">Filter handler</span></span>         | [<span data-ttu-id="30961-272">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="30961-272">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)<br/>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30961-273">Обработчик значков</span><span class="sxs-lookup"><span data-stu-id="30961-273">Icon handler</span></span>           | [<span data-ttu-id="30961-274">**иекстрактикон**</span><span class="sxs-lookup"><span data-stu-id="30961-274">**IExtractIcon**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)<br/> <span data-ttu-id="30961-275">Необязательно: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="30961-275">Optional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span><br/>                                                                                                                                                                                                                                 |
| <span data-ttu-id="30961-276">Обработчик подсказок</span><span class="sxs-lookup"><span data-stu-id="30961-276">Infotip handler</span></span>        | [<span data-ttu-id="30961-277">**икуеринфо**</span><span class="sxs-lookup"><span data-stu-id="30961-277">**IQueryInfo**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="30961-278">Обработчик просмотра</span><span class="sxs-lookup"><span data-stu-id="30961-278">Preview handler</span></span>        | [<span data-ttu-id="30961-279">**IPreviewHandler**</span><span class="sxs-lookup"><span data-stu-id="30961-279">**IPreviewHandler**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandler)                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="30961-280">Обработчик свойства</span><span class="sxs-lookup"><span data-stu-id="30961-280">Property handler</span></span>       | [<span data-ttu-id="30961-281">**ипропертисторе**</span><span class="sxs-lookup"><span data-stu-id="30961-281">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="30961-282">Обработчик протокола</span><span class="sxs-lookup"><span data-stu-id="30961-282">Protocol handler</span></span>       | <span data-ttu-id="30961-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**исеарчпротокол**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**иурлакцессор**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span><span class="sxs-lookup"><span data-stu-id="30961-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span></span><br/> <span data-ttu-id="30961-284">Необязательно: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span><span class="sxs-lookup"><span data-stu-id="30961-284">Optional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span></span><br/> |
| <span data-ttu-id="30961-285">Обработчик страницы свойств</span><span class="sxs-lookup"><span data-stu-id="30961-285">Property sheet handler</span></span> | <span data-ttu-id="30961-286">[**Ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [ **ишеллпропшитекст**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span><span class="sxs-lookup"><span data-stu-id="30961-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span></span>                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="30961-287">Обработчик контекстного меню</span><span class="sxs-lookup"><span data-stu-id="30961-287">Shortcut menu handler</span></span>  | <span data-ttu-id="30961-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**иексплореркомманд**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="30961-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                                                          |
| <span data-ttu-id="30961-289">Обработчик эскизов</span><span class="sxs-lookup"><span data-stu-id="30961-289">Thumbnail handler</span></span>      | [<span data-ttu-id="30961-290">**исумбнаилпровидер**</span><span class="sxs-lookup"><span data-stu-id="30961-290">**IThumbnailProvider**</span></span>](/windows/win32/api/thumbcache/nn-thumbcache-ithumbnailprovider)                                                                                                                                                                                                                                                                                                                        |



 

> [!Note]  
> <span data-ttu-id="30961-291">Обработчик свойств иногда ковн как обработчик метаданных.</span><span class="sxs-lookup"><span data-stu-id="30961-291">A property handler is sometimes kown as a metadata handler.</span></span> <span data-ttu-id="30961-292">Источник данных оболочки иногда называют расширением пространства имен оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-292">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="30961-293">Обработчик типа файлов иногда называют обработчиком расширения оболочки или расширением оболочки.</span><span class="sxs-lookup"><span data-stu-id="30961-293">A file type handler is sometimes known as a Shell extension handler or a Shell extension.</span></span>

 

<span data-ttu-id="30961-294">Дополнительные сведения о создании обработчиков см. в разделе [Создание обработчиков расширений оболочки](../shell/handlers.md).</span><span class="sxs-lookup"><span data-stu-id="30961-294">For more information about creating handlers, see [Creating Shell Extension Handlers](../shell/handlers.md).</span></span> <span data-ttu-id="30961-295">Дополнительные сведения о свойствах см. в разделе [система свойств Windows](../properties/windows-properties-system.md).</span><span class="sxs-lookup"><span data-stu-id="30961-295">For more information about properties, see [Windows Property System](../properties/windows-properties-system.md).</span></span>

## <a name="add-in-installer-guidelines"></a><span data-ttu-id="30961-296">Рекомендации по установщику для надстройки</span><span class="sxs-lookup"><span data-stu-id="30961-296">Add-in Installer Guidelines</span></span>

<span data-ttu-id="30961-297">При создании установщика надстройки следуйте приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="30961-297">Use the following guidelines when creating an Add-in installer:</span></span>

-   <span data-ttu-id="30961-298">Установщик должен использовать установщик EXE или MSI.</span><span class="sxs-lookup"><span data-stu-id="30961-298">The installer must use either the EXE or MSI installer.</span></span>
-   <span data-ttu-id="30961-299">Необходимо указать заметки о выпуске.</span><span class="sxs-lookup"><span data-stu-id="30961-299">Release notes must be provided.</span></span>
-   <span data-ttu-id="30961-300">Для каждой установленной надстройки необходимо создать запись « **Установка и удаление программ** ».</span><span class="sxs-lookup"><span data-stu-id="30961-300">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="30961-301">Установщик должен задействовать все параметры реестра для конкретного типа файлов или хранить данные, распознаваемые текущей надстройкой.</span><span class="sxs-lookup"><span data-stu-id="30961-301">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="30961-302">Если предыдущая надстройка перезаписывается, установщик должен уведомить пользователя.</span><span class="sxs-lookup"><span data-stu-id="30961-302">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="30961-303">Если более новая надстройка перезаписала предыдущую надстройку, пользователь должен иметь возможность восстановить функциональность предыдущей надстройки и сделать ее надстройкой по умолчанию для этого типа файлов или хранилища.</span><span class="sxs-lookup"><span data-stu-id="30961-303">If a newer add-in has overwritten a previous add-in, the user should be able to restore the previous add-in's functionality and make it the default add-in again for that file type or store.</span></span>

## <a name="note-to-implementers"></a><span data-ttu-id="30961-304">Примечание для разработчиков</span><span class="sxs-lookup"><span data-stu-id="30961-304">Note to Implementers</span></span>

<span data-ttu-id="30961-305">Перед созданием фильтра или обработчика свойств разработчики должны учитывать следующее:</span><span class="sxs-lookup"><span data-stu-id="30961-305">Before creating a filter or property handler, developers should consider the following:</span></span>

-   <span data-ttu-id="30961-306">Эти обработчики являются встроенными расширениями, которые загружаются в неуправляемые процессы, такие как процесс управляющей программы фильтрации, проводник Windows (Поиск GREP) и сторонние узлы, такие как почта Windows.</span><span class="sxs-lookup"><span data-stu-id="30961-306">These handlers are in-process extensions that are loaded into processes that you do not control, such as the filter daemon process, Windows Explorer (grep search), and third-party hosts like Windows Mail).</span></span>
-   <span data-ttu-id="30961-307">Необходимо написать безопасный код, который достаточно надежен для выполнения произвольного повреждения форм формата файлов, созданных для атаки на систему.</span><span class="sxs-lookup"><span data-stu-id="30961-307">You must write secure code that is robust enough to handle arbitrarily corrupt forms of your file format that were created to attack the system.</span></span>
-   <span data-ttu-id="30961-308">Надстройка не должна утечек ресурсов, которые будут вызывать проблемы для ведущих процессов.</span><span class="sxs-lookup"><span data-stu-id="30961-308">Your add-in must not leak resources that will produce problems for the host processes.</span></span>
-   <span data-ttu-id="30961-309">Надстройка не должна завершаться сбоем, так как это также приведет к сбою хост-процесса и замедлить процесс фильтрации.</span><span class="sxs-lookup"><span data-stu-id="30961-309">Your add-in must not crash as this will also crash the host processes and slow down the filtering process.</span></span>
-   <span data-ttu-id="30961-310">Поскольку эти обработчики выполняются в фоновом системном процессе, они должны быстро выполняться с минимальным объемом ресурсов ЦП и операций ввода-вывода, чтобы удовлетворить требования к производительности системы.</span><span class="sxs-lookup"><span data-stu-id="30961-310">Because these handlers are run in a background system process, they must perform quickly with a minimum of CPU and I/O consumed in order to meet the performance requirements of the system.</span></span>

<span data-ttu-id="30961-311">Таким же разработчикам нужно написать эти надстройки с опытом создания кода системного уровня.</span><span class="sxs-lookup"><span data-stu-id="30961-311">Thus, these add-ins should be written by developers with expertise in creating system-level code.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="30961-312">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="30961-312">Additional Resources</span></span>

-   <span data-ttu-id="30961-313">Сведения о создании источника данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="30961-313">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>
-   <span data-ttu-id="30961-314">Сведения об источниках данных, которые должны использовать объект представления системной папки по умолчанию (Дефвиев) оболочки, см. в разделе [Реализация представления папок](../lwef/nse-folderview.md), функции [**шкреатешеллфолдервиев**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) и [**СФВ \_ CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) Structure.</span><span class="sxs-lookup"><span data-stu-id="30961-314">For data sources that need to use the Shell Default System Folder View Object (DefView), see [Implementing a Folder View](../lwef/nse-folderview.md), [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) function, and [**SFV\_CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure.</span></span> <span data-ttu-id="30961-315">Источники данных, использующие объект представления системных папок по умолчанию (Дефвиев) оболочки, должны реализовывать следующий набор интерфейсов: [**ишеллфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**иперсистфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)и (необязательно) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="30961-315">Data sources that use the Shell Default System Folder View Object (DefView) must implement the following set of interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2), and (optionally) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span> <span data-ttu-id="30961-316">Если в реализации **ишеллфолдер** не используется **Шкреатешеллфолдервиев** для создания дефвиев, то для объекта представления оболочки может потребоваться [**ифолдервиев**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span><span class="sxs-lookup"><span data-stu-id="30961-316">If your **IShellFolder** implementation does not use **SHCreateShellFolderView** to create the DefView, the Shell view object may need [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span></span>
-   <span data-ttu-id="30961-317">[**Исеарчфолдеритемфактори**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) является основным интерфейсом для потребителей источника данных оболочки, известного как дбфолдер.</span><span class="sxs-lookup"><span data-stu-id="30961-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is the primary interface for consumers of the Shell data source known as DBFolder.</span></span> <span data-ttu-id="30961-318">Дополнительные сведения о Дбфолдер см. в описании инструкции STR \_ Parse \_ со \_ свойствами константы в [**строковых ключах контекста привязки**](../shell/str-constants.md).</span><span class="sxs-lookup"><span data-stu-id="30961-318">For more information about DBFolder, see the description of the STR\_PARSE\_WITH\_PROPERTIES constant in [**Bind Context String Keys**](../shell/str-constants.md).</span></span> <span data-ttu-id="30961-319">См. также [массивы ассоциаций](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) и [**Ипропертисистем:: жетпропертидескриптионлистфромстринг**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span><span class="sxs-lookup"><span data-stu-id="30961-319">See also [Association Arrays](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) and [**IPropertySystem::GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span></span>
-   <span data-ttu-id="30961-320">Дополнительные сведения о OLE DB см. в разделе [Общие сведения о программировании OLE DB](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span><span class="sxs-lookup"><span data-stu-id="30961-320">For information on OLE DB, see [OLE DB Programming Overview](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span></span> <span data-ttu-id="30961-321">Сведения о поставщике данных платформа .NET Framework для OLE DB см. в документации по [пространству имен System. Data. OLEDB](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) .</span><span class="sxs-lookup"><span data-stu-id="30961-321">For information on the .NET Framework Data Provider for OLE DB, see the [System.Data.OleDb Namespace](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) documentation.</span></span>
-   <span data-ttu-id="30961-322">Сведения о поддерживаемых сообществом платах сообщений в технологиях поиска см. в статье [Windows: Поиск форумов](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="30961-322">For community-supported message boards on Search technologies, see [Windows: Search Forums](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) on MSDN.</span></span>
-   <span data-ttu-id="30961-323">Связанные примеры кода см. в разделе [примеры кода для поиска Windows](-search-samples-ovw.md).</span><span class="sxs-lookup"><span data-stu-id="30961-323">For related code samples, see [Windows Search Code Samples](-search-samples-ovw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="30961-324">См. также</span><span class="sxs-lookup"><span data-stu-id="30961-324">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="30961-325">Обзор Windows Search</span><span class="sxs-lookup"><span data-stu-id="30961-325">Windows Search Overview</span></span>](-search-3x-wds-overview.md)
</dt> <dt>

[<span data-ttu-id="30961-326">Языки, поддерживаемые службой поиска Windows</span><span class="sxs-lookup"><span data-stu-id="30961-326">Languages Supported by Windows Search</span></span>](-search-3x-wds-language-support.md)
</dt> <dt>

[<span data-ttu-id="30961-327">Использование управляемого кода с данными оболочки и Windows Search</span><span class="sxs-lookup"><span data-stu-id="30961-327">Using Managed Code with Shell Data and Windows Search</span></span>](-search-3x-wds-managed-code.md)
</dt> <dt>

[<span data-ttu-id="30961-328">Руководством разработчика Windows Search</span><span class="sxs-lookup"><span data-stu-id="30961-328">Windows Search Developer's Guide</span></span>](-search-developers-guide-entry-page.md)
</dt> </dl>

 

 
