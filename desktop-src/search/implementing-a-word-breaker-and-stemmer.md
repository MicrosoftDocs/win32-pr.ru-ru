---
description: Корпорация Майкрософт предоставляет средство разбиения по словам и парадигматические модули для нескольких языков. В этом разделе описывается, как реализовать и использовать пользовательские средства разбиения по словам и парадигматические модули для языков, а также языковые стандарты, предоставляемые корпорацией Майкрософт.
ms.assetid: 47768691-7071-440e-bfbf-975713880c00
title: Реализация средств разбиения по словам и парадигматические модули
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bd4f4e3210e7f4e17bb035115fd694656cc6e6d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072642"
---
# <a name="implementing-a-word-breaker-and-stemmer"></a><span data-ttu-id="83d4c-104">Реализация средств разбиения по словам и парадигматические модули</span><span class="sxs-lookup"><span data-stu-id="83d4c-104">Implementing a Word Breaker and Stemmer</span></span>

<span data-ttu-id="83d4c-105">Корпорация Майкрософт предоставляет средство разбиения по словам и парадигматические модули для нескольких языков.</span><span class="sxs-lookup"><span data-stu-id="83d4c-105">Microsoft provides word breakers and stemmers for a number of languages.</span></span> <span data-ttu-id="83d4c-106">В этом разделе описывается, как реализовать и использовать пользовательские средства разбиения по словам и парадигматические модули для языков, а также языковые стандарты, предоставляемые корпорацией Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="83d4c-106">This topic describes how to implement, and use custom word breakers and stemmers for languages, and locales beyond those provided by Microsoft.</span></span>

> [!Note]
> <span data-ttu-id="83d4c-107">По состоянию на июль 2018 в Windows Server 2019 было внесено изменение безопасности, которое предотвращает загрузку библиотек DLL без подписи Майкрософт с SearchIndexer.exe.</span><span class="sxs-lookup"><span data-stu-id="83d4c-107">As of July 2018 a security change was made to Windows Server 2019 that prevents DLLs without a Microsoft signature from being loaded by SearchIndexer.exe.</span></span> <span data-ttu-id="83d4c-108">В результате Windows Server 2019 больше не поддерживает подписанные пользовательские разделители слов, не относящиеся к Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="83d4c-108">As a result Windows Server 2019 no longer supports non-Microsoft signed custom word breakers.</span></span> 

<span data-ttu-id="83d4c-109">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="83d4c-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="83d4c-110">Регистрация библиотеки DLL ресурсов языка</span><span class="sxs-lookup"><span data-stu-id="83d4c-110">Registering a Language Resource DLL</span></span>](#registering-a-language-resource-dll)
-   [<span data-ttu-id="83d4c-111">Регистрация языка</span><span class="sxs-lookup"><span data-stu-id="83d4c-111">Registering a Language</span></span>](#registering-a-language-resource-dll)
-   [<span data-ttu-id="83d4c-112">Реализация слова колба</span><span class="sxs-lookup"><span data-stu-id="83d4c-112">Implementing a Word Beaker</span></span>](#implementing-a-word-beaker)
    -   [<span data-ttu-id="83d4c-113">Вордсинк и Фрасесинк</span><span class="sxs-lookup"><span data-stu-id="83d4c-113">WordSink and PhraseSink</span></span>](#wordsink-and-phrasesink)
    -   [<span data-ttu-id="83d4c-114">Разрывы</span><span class="sxs-lookup"><span data-stu-id="83d4c-114">Breaks</span></span>](#breaks)
    -   [<span data-ttu-id="83d4c-115">Масштабируемость, Перформанци и безопасность</span><span class="sxs-lookup"><span data-stu-id="83d4c-115">Scalability, Performancy, and Security</span></span>](#scalability-performancy-and-security)
-   [<span data-ttu-id="83d4c-116">Реализация парадигматические модули</span><span class="sxs-lookup"><span data-stu-id="83d4c-116">Implementing a Stemmer</span></span>](#implementing-a-stemmer)
    -   [<span data-ttu-id="83d4c-117">Масштабируемость, Перформанци и безопасность</span><span class="sxs-lookup"><span data-stu-id="83d4c-117">Scalability, Performancy, and Security</span></span>](#scalability-performancy-and-security)
-   [<span data-ttu-id="83d4c-118">См. также</span><span class="sxs-lookup"><span data-stu-id="83d4c-118">Related topics</span></span>](#related-topics)

## <a name="registering-a-language-resource-dll"></a><span data-ttu-id="83d4c-119">Регистрация библиотеки DLL ресурсов языка</span><span class="sxs-lookup"><span data-stu-id="83d4c-119">Registering a Language Resource DLL</span></span>

<span data-ttu-id="83d4c-120">Каждая библиотека DLL ресурсов языка должна реализовывать и экспортировать следующие точки входа.</span><span class="sxs-lookup"><span data-stu-id="83d4c-120">Each language resource DLL must implement and export the following entry points.</span></span> <span data-ttu-id="83d4c-121">Библиотека DLL может быть зарегистрирована в любой папке.</span><span class="sxs-lookup"><span data-stu-id="83d4c-121">The DLL can be registered to be in any folder.</span></span>

-   <span data-ttu-id="83d4c-122">DllMain является стандартной точкой входа для библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="83d4c-122">DllMain is the standard entry point to DLL.</span></span>
-   <span data-ttu-id="83d4c-123">Функция DllRegisterServer регистрирует библиотеку DLL в реестре, например `regsvr32.exe %SystemRoot%\MyFolder\wordbreaker.dll`</span><span class="sxs-lookup"><span data-stu-id="83d4c-123">DllRegisterServer registers the DLL in the registry, such as `regsvr32.exe %SystemRoot%\MyFolder\wordbreaker.dll`</span></span>
-   <span data-ttu-id="83d4c-124">DllCanUnloadNow позволяет клиентам вызывать эту точку входа через модель COM, чтобы определить, возможно ли выгрузить DLL-файл ресурсов языка.</span><span class="sxs-lookup"><span data-stu-id="83d4c-124">DllCanUnloadNow enables clients to call this entry point through Component Object Model (COM) to determine whether it is possible to unload the language resource DLL.</span></span>
-   <span data-ttu-id="83d4c-125">DllUnRegisterServer удаляет библиотеку DLL из реестра.</span><span class="sxs-lookup"><span data-stu-id="83d4c-125">DllUnRegisterServer removes the DLL from the registry.</span></span>

## <a name="registering-a-language"></a><span data-ttu-id="83d4c-126">Регистрация языка</span><span class="sxs-lookup"><span data-stu-id="83d4c-126">Registering a Language</span></span>

<span data-ttu-id="83d4c-127">Реестр содержит зависящие от языка записи для индексируемого языка, и эти записи управляют частями процессов индексирования и запросов, зависящих от языка.</span><span class="sxs-lookup"><span data-stu-id="83d4c-127">The registry contains language-specific entries for the language being indexed, and these entries control the parts of the indexing and query processes that are language specific.</span></span> <span data-ttu-id="83d4c-128">Эти записи реестра можно найти в следующем разделе реестра.</span><span class="sxs-lookup"><span data-stu-id="83d4c-128">These registry entries can be found under the following registry key.</span></span>

```
HKEY_LOCAL_MACHINE
   SYSTEM
      CurrentControlSet
         ContentIndex
            Control
               Language
                  
```

## <a name="implementing-a-word-beaker"></a><span data-ttu-id="83d4c-129">Реализация слова колба</span><span class="sxs-lookup"><span data-stu-id="83d4c-129">Implementing a Word Beaker</span></span>

<span data-ttu-id="83d4c-130">Средства разбиения по словам реализуют [**ивордбреакер**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span><span class="sxs-lookup"><span data-stu-id="83d4c-130">Word breakers implement [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span></span> <span data-ttu-id="83d4c-131">Метод [**ивордбреакер:: бреактекст**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) выполняет обработку и синтаксический анализ текста.</span><span class="sxs-lookup"><span data-stu-id="83d4c-131">The [**IWordBreaker::BreakText**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) method performs all text processing and parsing.</span></span> <span data-ttu-id="83d4c-132">Для реализации компонента средства разбиения по словам необходимо использовать эвристику языка для вашего языка.</span><span class="sxs-lookup"><span data-stu-id="83d4c-132">To implement a word breaker component, you must have language heuristics for your language.</span></span> <span data-ttu-id="83d4c-133">Сюда входят сведения о синтаксисе и морфологи.</span><span class="sxs-lookup"><span data-stu-id="83d4c-133">This includes information about syntax and morphology.</span></span> <span data-ttu-id="83d4c-134">Также может потребоваться список слов для исключения или включения.</span><span class="sxs-lookup"><span data-stu-id="83d4c-134">You may also need a list of words to exclude or include.</span></span> <span data-ttu-id="83d4c-135">Вы создаете файл пропускаемых слов для языкового стандарта из списка исключенных слов.</span><span class="sxs-lookup"><span data-stu-id="83d4c-135">You build the file of noise words for your language locale from the list of excluded words.</span></span> <span data-ttu-id="83d4c-136">Дополнительные сведения о лингвистических аспектах и о том, как эти рекомендации влияют на реализации разбиения по словам, см. в разделе [соглашения о лингвистических и Юникоде](linguistic-and-unicode-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="83d4c-136">For more information about linguistic considerations and how these considerations affect word breaker implementations, see [Linguistic and Unicode Considerations](linguistic-and-unicode-considerations.md).</span></span>

<span data-ttu-id="83d4c-137">Основной целью [**ивордбреакер:: бреактекст**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) является обработка текста непрерывно из [**\_ исходного текста**](/windows/win32/api/indexsrv/ns-indexsrv-text_source) до тех пор, пока не будет обработан весь текст или пока средство разбиения по словам не обнаружит ошибку.</span><span class="sxs-lookup"><span data-stu-id="83d4c-137">The main purpose of [**IWordBreaker::BreakText**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) is to process text continuously from the [**TEXT\_SOURCE**](/windows/win32/api/indexsrv/ns-indexsrv-text_source) until all the text is processed, or until the word breaker encounters an error.</span></span> <span data-ttu-id="83d4c-138">В этом цикле обработки данных **ивордбреакер:: бреактекст** вызывает синтаксический анализ и служебные методы, выполняющие определенные задачи для этого процесса.</span><span class="sxs-lookup"><span data-stu-id="83d4c-138">While in this data processing loop, **IWordBreaker::BreakText** calls parsing and utility methods that perform specific tasks for that process.</span></span> <span data-ttu-id="83d4c-139">Например, немецкий средство разбиения по словам может обрабатывать составные слова, а французское средство разбиения по словам может обрабатывать [диакритические знаки](surface-form-normalization.md) или [клитикс](surface-form-normalization.md).</span><span class="sxs-lookup"><span data-stu-id="83d4c-139">For example, the German word breaker may handle compound words, whereas the French word breaker may process [diacritics](surface-form-normalization.md) or [clitics](surface-form-normalization.md).</span></span> <span data-ttu-id="83d4c-140">Конкретные функции, выполняемые программой разбиения по словам, и стратегия, используемая для выполнения этих задач, полностью зависят от требований этого языка.</span><span class="sxs-lookup"><span data-stu-id="83d4c-140">The specific functions that the word breaker performs and the strategy that it uses in performing these tasks depend entirely on the requirements for that language.</span></span>

<span data-ttu-id="83d4c-141">При разбиении текста средство разбиения по словам определяет "альтернативные" формы для слов, которые могут иметь несколько представлений.</span><span class="sxs-lookup"><span data-stu-id="83d4c-141">When breaking text, word breakers identify "alternative" forms for words that may have multiple representations.</span></span> <span data-ttu-id="83d4c-142">Между создаваемыми словами не подразумевается Семантическая связь.</span><span class="sxs-lookup"><span data-stu-id="83d4c-142">No semantic relationship is implied between the generated words.</span></span> <span data-ttu-id="83d4c-143">На самом деле, исходное слово может не включаться в список альтернатив.</span><span class="sxs-lookup"><span data-stu-id="83d4c-143">In fact, the original word may not be included among the list of alternatives.</span></span> <span data-ttu-id="83d4c-144">Альтернативные формы сохраняются в том же положении в индексе, что и исходное слово, чтобы указать, что они идентичны.</span><span class="sxs-lookup"><span data-stu-id="83d4c-144">The alternative forms are saved in the same position in the index as the original word to indicate that they are identical.</span></span>

<span data-ttu-id="83d4c-145">Если документ включен в индекс, каждому слову присваивается целочисленное значение, представляющее смещение или расстояние слова от начала документа.</span><span class="sxs-lookup"><span data-stu-id="83d4c-145">When a document is included in the index, each word is assigned an integer value that represents the offset, or the distance of the word from the beginning of a document.</span></span> <span data-ttu-id="83d4c-146">Относительное расстояние между словами в запросе сравнивается со смещением, хранящимся в полнотекстовом индексе.</span><span class="sxs-lookup"><span data-stu-id="83d4c-146">The relative distance between words in a query is compared against the offsets stored in the full-text index.</span></span> <span data-ttu-id="83d4c-147">Запрос "Where является документом Кайл" соответствует любому документу с "Where" в смещении n, "равно" в n + 1, "Кайл" в n + 2 и "Document" в n + 3.</span><span class="sxs-lookup"><span data-stu-id="83d4c-147">The query "Where is Kyle's document" matches any document with "Where" at offset n, "is" at n+1, "Kyle's" at n+2, and "document" at n+3.</span></span> <span data-ttu-id="83d4c-148">«Где Кайл документ в базе данных?»</span><span class="sxs-lookup"><span data-stu-id="83d4c-148">"Where is Kyle's document filed in the data-base?"</span></span> <span data-ttu-id="83d4c-149">представляется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="83d4c-149">is represented as:</span></span>



|       |     |                        |          |       |     |     |                               |
|-------|-----|------------------------|----------|-------|-----|-----|-------------------------------|
| <span data-ttu-id="83d4c-150">Where</span><span class="sxs-lookup"><span data-stu-id="83d4c-150">Where</span></span> | <span data-ttu-id="83d4c-151">is</span><span class="sxs-lookup"><span data-stu-id="83d4c-151">is</span></span>  | <span data-ttu-id="83d4c-152">Кайл Кайл</span><span class="sxs-lookup"><span data-stu-id="83d4c-152">Kyle Kyle's</span></span><br/> | <span data-ttu-id="83d4c-153">документ</span><span class="sxs-lookup"><span data-stu-id="83d4c-153">document</span></span> | <span data-ttu-id="83d4c-154">подан</span><span class="sxs-lookup"><span data-stu-id="83d4c-154">filed</span></span> | <span data-ttu-id="83d4c-155">in</span><span class="sxs-lookup"><span data-stu-id="83d4c-155">in</span></span>  | <span data-ttu-id="83d4c-156">мыши</span><span class="sxs-lookup"><span data-stu-id="83d4c-156">the</span></span> | <span data-ttu-id="83d4c-157">база данных БД</span><span class="sxs-lookup"><span data-stu-id="83d4c-157">database data base</span></span><br/> |



 

<span data-ttu-id="83d4c-158">В этом примере средство разбиения по словам сохраняет альтернативные формы для "Кайл" ("Кайл") и "Database" (база данных) в индексе.</span><span class="sxs-lookup"><span data-stu-id="83d4c-158">In this example, the word breaker stores alternative forms for "Kyle" ("Kyle's") and "database" ("data base") in the index.</span></span> <span data-ttu-id="83d4c-159">Средство разбиения по словам создает и сохраняет альтернативные слова в процессе создания индекса при следующих условиях.</span><span class="sxs-lookup"><span data-stu-id="83d4c-159">The word breaker generates and stores alternative words during the index creation process under the following conditions:</span></span>

-   <span data-ttu-id="83d4c-160">Если альтернативное слово, скорее всего, будет отображаться в запросе как одно слово</span><span class="sxs-lookup"><span data-stu-id="83d4c-160">If an alternative word is likely to appear as a single word in a query</span></span>
-   <span data-ttu-id="83d4c-161">Если средство извлечения корней, скорее всего, не порождает исходное слово из альтернативы</span><span class="sxs-lookup"><span data-stu-id="83d4c-161">If a stemmer is not likely to derive the original word from the alternative</span></span>

<span data-ttu-id="83d4c-162">Создание альтернативных форм-слов увеличивает число способов представления и сопоставления запросов с предложением, как показано в следующих вариантах:</span><span class="sxs-lookup"><span data-stu-id="83d4c-162">Generating alternative word forms increases the number of ways that queries represent and match a sentence, as shown in the following variations:</span></span>

1.  <span data-ttu-id="83d4c-163">Где находится документ Кайл в базе данных</span><span class="sxs-lookup"><span data-stu-id="83d4c-163">Where is Kyle document filed in the database</span></span>
2.  <span data-ttu-id="83d4c-164">Где находится документ Кайл в базе данных</span><span class="sxs-lookup"><span data-stu-id="83d4c-164">Where is Kyle's document filed in the database</span></span>
3.  <span data-ttu-id="83d4c-165">Где находится документ Кайл в базе данных</span><span class="sxs-lookup"><span data-stu-id="83d4c-165">Where is Kyle document filed in the data base</span></span>
4.  <span data-ttu-id="83d4c-166">Где хранится документ Кайл в базе данных</span><span class="sxs-lookup"><span data-stu-id="83d4c-166">Where is Kyle's document filed in the data base</span></span>

### <a name="wordsink-and-phrasesink"></a><span data-ttu-id="83d4c-167">Вордсинк и Фрасесинк</span><span class="sxs-lookup"><span data-stu-id="83d4c-167">WordSink and PhraseSink</span></span>

<span data-ttu-id="83d4c-168">Средства разбиения по словам используют объекты [**ивордсинк**](iwordsink.md) и [**ифрасесинк**](/windows/win32/api/indexsrv/nn-indexsrv-iphrasesink) для накопления и хранения всех слов и фраз, извлеченных из текста.</span><span class="sxs-lookup"><span data-stu-id="83d4c-168">Word breakers use the [**IWordSink**](iwordsink.md) and [**IPhraseSink**](/windows/win32/api/indexsrv/nn-indexsrv-iphrasesink) objects to collect and store all words and phrases that they extract from text.</span></span> <span data-ttu-id="83d4c-169">Средство разбиения по словам хранит слова в форме, как можно ближе к исходной форме Word в документе.</span><span class="sxs-lookup"><span data-stu-id="83d4c-169">A word breaker stores words in a form that is as close as possible to the original word form in the document.</span></span> <span data-ttu-id="83d4c-170">**Ифрасесинк** сохраняет фразы во время выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="83d4c-170">**IPhraseSink** stores phrases at query time.</span></span> <span data-ttu-id="83d4c-171">Фразы повышают релевантность результатов запроса, поскольку более длинные последовательности слов являются реже и предоставляют более широкие различия, чем небольшие фразы.</span><span class="sxs-lookup"><span data-stu-id="83d4c-171">Phrases improve the relevance of query results because longer sequences of words are rarer and provide greater distinction than smaller phrases.</span></span> <span data-ttu-id="83d4c-172">Когда индексатор помещает фразу в **ифрасесинк** во время запроса, он создает экземпляр средство разбиения по словам, чтобы разбить фразу на слова.</span><span class="sxs-lookup"><span data-stu-id="83d4c-172">When the indexer places a phrase in the **IPhraseSink** at query time, it creates an instance of the word breaker to break the phrase into words.</span></span> <span data-ttu-id="83d4c-173">Затем индексатор вычисляет фразу, проверяя, находятся ли слова в фразе рядом друг с другом в индексе.</span><span class="sxs-lookup"><span data-stu-id="83d4c-173">The indexer then evaluates the phrase by checking whether the words in the phrase occur adjacent to one another in the index.</span></span> <span data-ttu-id="83d4c-174">Например, если в индексе в позициях *x*, *x*+ 1, *x*+ 2 и *x*+ 3 встречается "abcd", совпадение с фразой будет возникать, если в запросе отправляется любая смежная подстрока "abcd".</span><span class="sxs-lookup"><span data-stu-id="83d4c-174">For example, if "ABCD" occurs in the index at positions *x*, *x*+1, *x*+2, and *x*+3, the phrase match will occur if any adjacent substring of "ABCD" is submitted in a query.</span></span> <span data-ttu-id="83d4c-175">Эта стратегия эффективна для разделителей слов на основе символов, которые разбивают фразы и длинные слова во время создания индекса и создают фразы во время запроса.</span><span class="sxs-lookup"><span data-stu-id="83d4c-175">This strategy is effective for character-based word breakers that split phrases and long words during index creation and that generate phrases during query time.</span></span>

### <a name="breaks"></a><span data-ttu-id="83d4c-176">Разрывы</span><span class="sxs-lookup"><span data-stu-id="83d4c-176">Breaks</span></span>

<span data-ttu-id="83d4c-177">Разрывы — это пробелы между словами.</span><span class="sxs-lookup"><span data-stu-id="83d4c-177">Breaks are the spaces between words.</span></span> <span data-ttu-id="83d4c-178">Пробелы, пунктуация, форматирование или только природа самого языка могут вызвать разрывы.</span><span class="sxs-lookup"><span data-stu-id="83d4c-178">White space, punctuation, formatting, or just the nature of the language itself can cause breaks.</span></span> <span data-ttu-id="83d4c-179">Индексатор использует четыре разных типа разрывов: конец слова (ЕОВ), конец предложения (EOS), конец абзаца (потенциал) и конец главы (EOC).</span><span class="sxs-lookup"><span data-stu-id="83d4c-179">There are four different types of breaks that the indexer uses: end of word (EOW), end of sentence (EOS), end of paragraph (EOP) and end of chapter (EOC).</span></span> <span data-ttu-id="83d4c-180">Разрыв ЕОВ является разрывом по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="83d4c-180">The EOW break is the default break.</span></span> <span data-ttu-id="83d4c-181">После каждого маркера каждый разрыв обозначает Разное семантическое расстояние между словами на обеих сторонах.</span><span class="sxs-lookup"><span data-stu-id="83d4c-181">After each token, each break indicates a different semantic distance between the words on either side.</span></span> <span data-ttu-id="83d4c-182">Слова, разделенные ЕОВ, имеют строгую семантическую связь, за которой следуют EOS, потенциал и EOC.</span><span class="sxs-lookup"><span data-stu-id="83d4c-182">Words separated by EOW have the tightest semantic link, followed by EOS, EOP, and EOC.</span></span> <span data-ttu-id="83d4c-183">Несколько вызовов [**ивордсинк::P утбреак**](iwordsink-putbreak.md) являются кумулятивными и аналогичны вставке пустых слов или предложений.</span><span class="sxs-lookup"><span data-stu-id="83d4c-183">Multiple calls to [**IWordSink::PutBreak**](iwordsink-putbreak.md) are cumulative, and are analogous to inserting null words or sentences.</span></span>

### <a name="scalability-performancy-and-security"></a><span data-ttu-id="83d4c-184">Масштабируемость, Перформанци и безопасность</span><span class="sxs-lookup"><span data-stu-id="83d4c-184">Scalability, Performancy, and Security</span></span>

<span data-ttu-id="83d4c-185">Способ, которым средство разбиения по словам реагирует на одновременные вызовы, в основном определяется выбором модели потоков.</span><span class="sxs-lookup"><span data-stu-id="83d4c-185">The way the word breaker responds to simultaneous calls is largely determined by your choice of threading model.</span></span> <span data-ttu-id="83d4c-186">Индексатор является однопотоковым приложением.</span><span class="sxs-lookup"><span data-stu-id="83d4c-186">The indexer is a single-threaded application.</span></span> <span data-ttu-id="83d4c-187">Чтобы средства разбиения по словам работали в однопотоковой среде, средства разбиения по словам должны быть написаны с помощью потоковой модели "Free" или "both".</span><span class="sxs-lookup"><span data-stu-id="83d4c-187">For word breakers to work in a single-threaded environment, word breakers must be written using a "free" or "both" threading model.</span></span> <span data-ttu-id="83d4c-188">Средства разбиения по словам не должны регистрироваться в COM с помощью потоковой модели "апартамента".</span><span class="sxs-lookup"><span data-stu-id="83d4c-188">Word breakers must not register with COM by using the "apartment" threading model.</span></span>

<span data-ttu-id="83d4c-189">Мы советуем, чтобы средство разбиения по словам не мешало глобальным состояниям и сохранить данные в экземпляре для программы разбиения по словам.</span><span class="sxs-lookup"><span data-stu-id="83d4c-189">We recommend that word breakers avoid global states and store data in the instance for the word breaker.</span></span> <span data-ttu-id="83d4c-190">Единственным содержимым, которое должно храниться в реализации средство разбиения по словам, являются параметры *фкуери* и *улмакстокенсизе*.</span><span class="sxs-lookup"><span data-stu-id="83d4c-190">The only content that should be stored in the word breaker implementation are for the parameters *fQuery* and *ulMaxTokenSize*.</span></span> <span data-ttu-id="83d4c-191">Средства разбиения по словам должны быть не более чем в два раза медленнее, чем тест, установленный средством разбиения по словам для английского языка.</span><span class="sxs-lookup"><span data-stu-id="83d4c-191">Word breakers should be no more than two times slower than the benchmark established by the English word breaker.</span></span> <span data-ttu-id="83d4c-192">Производительность средства разбиения по словам также должна быть улучшена с увеличением возможностей оборудования.</span><span class="sxs-lookup"><span data-stu-id="83d4c-192">Word breaker performance should also improve with increased hardware capability.</span></span>

<span data-ttu-id="83d4c-193">Средство разбиения по словам для индексатора выполняется в контексте безопасности локальной системы.</span><span class="sxs-lookup"><span data-stu-id="83d4c-193">Word breakers for the indexer run in the Local System security context.</span></span> <span data-ttu-id="83d4c-194">Они должны быть написаны для корректного управления буферами и их правильного стека.</span><span class="sxs-lookup"><span data-stu-id="83d4c-194">They should be written to manage buffers and to stack correctly.</span></span> <span data-ttu-id="83d4c-195">Все копии строк должны иметь явные проверки для защиты от переполнения буфера.</span><span class="sxs-lookup"><span data-stu-id="83d4c-195">All string copies must have explicit checks to guard against buffer overruns.</span></span> <span data-ttu-id="83d4c-196">Следует всегда проверять выделенный размер буфера и проверять размер данных в соответствии с размером буфера.</span><span class="sxs-lookup"><span data-stu-id="83d4c-196">You should always verify the allocated size of the buffer and test the size of the data against the size of the buffer.</span></span> <span data-ttu-id="83d4c-197">Средство разбиения по словам не может предположить, что текст, передаваемый методу [**ивордбреакер:: бреактекст**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) , имеет правильный формат.</span><span class="sxs-lookup"><span data-stu-id="83d4c-197">Word breakers cannot assume that the text passed to the [**IWordBreaker::BreakText**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) method is well formed.</span></span> <span data-ttu-id="83d4c-198">Дополнительные сведения об устранении неполадок средства разбиения по словам см. в разделе [Устранение неполадок языковых ресурсов и](troubleshooting-language-resources.md)рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="83d4c-198">For more information about troubleshooting word breakers, see [Troubleshooting Language Resources and Best Practices](troubleshooting-language-resources.md).</span></span>

## <a name="implementing-a-stemmer"></a><span data-ttu-id="83d4c-199">Реализация парадигматические модули</span><span class="sxs-lookup"><span data-stu-id="83d4c-199">Implementing a Stemmer</span></span>

<span data-ttu-id="83d4c-200">Парадигматические модули реализуют интерфейс [**истеммер**](/windows/desktop/api/Indexsrv/nn-indexsrv-istemmer) .</span><span class="sxs-lookup"><span data-stu-id="83d4c-200">Stemmers implement the [**IStemmer**](/windows/desktop/api/Indexsrv/nn-indexsrv-istemmer) interface.</span></span> <span data-ttu-id="83d4c-201">Метод [**истеммер:: женератевордформс**](/windows/desktop/api/Indexsrv/nf-indexsrv-istemmer-generatewordforms) создает список слов с определенными словами для конкретного входного слова.</span><span class="sxs-lookup"><span data-stu-id="83d4c-201">The [**IStemmer::GenerateWordForms**](/windows/desktop/api/Indexsrv/nf-indexsrv-istemmer-generatewordforms) method generates a list of inflected word forms for a particular input word.</span></span> <span data-ttu-id="83d4c-202">Чтобы реализовать компонент извлечения корней, необходимо иметь эвристику языка для вашего языка.</span><span class="sxs-lookup"><span data-stu-id="83d4c-202">To implement a stemmer component, you must have language heuristics for your language.</span></span> <span data-ttu-id="83d4c-203">Сюда входят сведения о морфологи.</span><span class="sxs-lookup"><span data-stu-id="83d4c-203">This includes information about morphology.</span></span> <span data-ttu-id="83d4c-204">Также может потребоваться список слов для исключения или включения.</span><span class="sxs-lookup"><span data-stu-id="83d4c-204">You may also need a list of words to exclude or include.</span></span> <span data-ttu-id="83d4c-205">Дополнительные сведения о лингвистических аспектах и о том, как эти вопросы влияют на реализации парадигматические модули, см. в статье [особенности лингвистических и Юникода](linguistic-and-unicode-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="83d4c-205">For more information about linguistic considerations and how these considerations affect stemmer implementations, see [Linguistic and Unicode Considerations](linguistic-and-unicode-considerations.md).</span></span>

<span data-ttu-id="83d4c-206">Рекомендуется, чтобы парадигматические модули не создавали женитиве или, например, для слов.</span><span class="sxs-lookup"><span data-stu-id="83d4c-206">We recommend that stemmers should not generate the genitive, or possessive, case for words.</span></span> <span data-ttu-id="83d4c-207">Например, «Дэвид» не создается в качестве альтернативной формы для «Дэвид».</span><span class="sxs-lookup"><span data-stu-id="83d4c-207">For example, "David" is not generated as an alternative form for "David's."</span></span> <span data-ttu-id="83d4c-208">Средство разбиения по словам создает как «Дэвид», так и «Дэвид» при анализе «Дэвид».</span><span class="sxs-lookup"><span data-stu-id="83d4c-208">The word breaker generates both "David" and "David's" when it parses "David's."</span></span>

<span data-ttu-id="83d4c-209">Парадигматические модули используют объект [ивордформсинк](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordformsink) для сбора списка альтернативных слов.</span><span class="sxs-lookup"><span data-stu-id="83d4c-209">The stemmer uses the [IWordFormSink](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordformsink) object to gather the list of alternative words.</span></span> <span data-ttu-id="83d4c-210">[**Ивордформсинк::P утворд**](iwordformsink-putword.md) создает окончательное слово из парадигматические модули.</span><span class="sxs-lookup"><span data-stu-id="83d4c-210">[**IWordFormSink::PutWord**](iwordformsink-putword.md) generates the final word from the stemmer.</span></span> <span data-ttu-id="83d4c-211">Во всех случаях это последнее слово, совпадающее с входным словом из [**истеммер:: женератевордформс**](/windows/desktop/api/Indexsrv/nf-indexsrv-istemmer-generatewordforms).</span><span class="sxs-lookup"><span data-stu-id="83d4c-211">In all cases, this final word is the same as the input word from [**IStemmer::GenerateWordForms**](/windows/desktop/api/Indexsrv/nf-indexsrv-istemmer-generatewordforms).</span></span> <span data-ttu-id="83d4c-212">Например, при наличии слова «дорожки» средство извлечения корней формирует следующие формы: «Swimming», «плавание», «купание», «свам» и «свум» с помощью вызовов [**ивордформсинк::P уталтворд**](iwordformsink-putphrase.md).</span><span class="sxs-lookup"><span data-stu-id="83d4c-212">For example, given the word "swim," the stemmer generates the following word forms: "swimming," "swimmer," "swims," "swam," and "swum," through calls to [**IWordFormSink::PutAltWord**](iwordformsink-putphrase.md).</span></span> <span data-ttu-id="83d4c-213">Средство извлечения корней создает "дорожки" через **ивордформсинк::P утворд**.</span><span class="sxs-lookup"><span data-stu-id="83d4c-213">The stemmer generates "swim" through **IWordFormSink::PutWord**.</span></span>

### <a name="scalability-performancy-and-security"></a><span data-ttu-id="83d4c-214">Масштабируемость, Перформанци и безопасность</span><span class="sxs-lookup"><span data-stu-id="83d4c-214">Scalability, Performancy, and Security</span></span>

<span data-ttu-id="83d4c-215">Парадигматические модули, такие как средство разбиения по словам, должны использовать модель бесплатного потокового взаимодействия и регистрироваться в модели COM, для которых задана модель потоковой обработки "Free" или "both".</span><span class="sxs-lookup"><span data-stu-id="83d4c-215">Stemmers, like word breakers, must use a "free" threading model and register with COM with their threading model set to "free" or "both."</span></span> <span data-ttu-id="83d4c-216">Поиск Windows вызывает отдельные экземпляры парадигматические модули из разных потоков одновременно.</span><span class="sxs-lookup"><span data-stu-id="83d4c-216">Windows Search calls separate instances of the stemmer from different threads at the same time.</span></span> <span data-ttu-id="83d4c-217">Таким образом, парадигматические модули должны иметь минимальные данные экземпляра.</span><span class="sxs-lookup"><span data-stu-id="83d4c-217">Stemmers should therefore have minimal instance data.</span></span>

<span data-ttu-id="83d4c-218">Точность парадигматические связи оказывает значительное влияние на релевантность запроса.</span><span class="sxs-lookup"><span data-stu-id="83d4c-218">Stemmer accuracy has a significant impact on query relevance.</span></span> <span data-ttu-id="83d4c-219">Если средство извлечения корней текста неправильно выдает текст, запросы могут возвращать непредсказуемые и неточные результаты.</span><span class="sxs-lookup"><span data-stu-id="83d4c-219">If the stemmer stems the text incorrectly, queries may return unpredictable and inaccurate results.</span></span> <span data-ttu-id="83d4c-220">Парадигматические модули должны обслуживать сотни запросов в секунду без негативного влияния на производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="83d4c-220">Stemmers must handle hundreds of queries per second without negatively affecting query performance.</span></span> <span data-ttu-id="83d4c-221">Производительность системы извлечения корней должна улучшиться благодаря увеличению возможностей оборудования.</span><span class="sxs-lookup"><span data-stu-id="83d4c-221">Stemmer performance should improve with increased hardware capability.</span></span> <span data-ttu-id="83d4c-222">Сведения об устранении неполадок парадигматические модули см. в разделе [Устранение неполадок и рекомендации по использованию языковых ресурсов](troubleshooting-language-resources.md).</span><span class="sxs-lookup"><span data-stu-id="83d4c-222">For information about troubleshooting stemmers, see [Troubleshooting Language Resources and Best Practices](troubleshooting-language-resources.md).</span></span>

<span data-ttu-id="83d4c-223">Парадигматические модули для поиска Windows выполняются в локальном контексте безопасности.</span><span class="sxs-lookup"><span data-stu-id="83d4c-223">Stemmers for Windows Search run in the Local Security context.</span></span> <span data-ttu-id="83d4c-224">Они должны быть написаны для корректного управления буферами и их правильного стека.</span><span class="sxs-lookup"><span data-stu-id="83d4c-224">They should be written to manage buffers and to stack correctly.</span></span> <span data-ttu-id="83d4c-225">Все копии строк должны иметь явные проверки для защиты от переполнения буфера.</span><span class="sxs-lookup"><span data-stu-id="83d4c-225">All string copies must have explicit checks to guard against buffer overruns.</span></span> <span data-ttu-id="83d4c-226">Следует всегда проверять выделенный размер буфера и проверять размер данных в соответствии с размером буфера.</span><span class="sxs-lookup"><span data-stu-id="83d4c-226">You should always verify the allocated size of the buffer and test the size of the data against the size of the buffer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="83d4c-227">См. также</span><span class="sxs-lookup"><span data-stu-id="83d4c-227">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="83d4c-228">Расширение языковых ресурсов</span><span class="sxs-lookup"><span data-stu-id="83d4c-228">Extending Language Resources</span></span>](extending-language-resources-in-windows-search.md)
</dt> <dt>

[<span data-ttu-id="83d4c-229">Основные сведения о компонентах ресурсов языка</span><span class="sxs-lookup"><span data-stu-id="83d4c-229">Understanding Language Resource Components</span></span>](understanding-language-resource-components.md)
</dt> <dt>

[<span data-ttu-id="83d4c-230">Рекомендации по лингвистическим правилам и Юникоду</span><span class="sxs-lookup"><span data-stu-id="83d4c-230">Linguistic and Unicode Considerations</span></span>](linguistic-and-unicode-considerations.md)
</dt> <dt>

[<span data-ttu-id="83d4c-231">Устранение неполадок в языковых ресурсах и рекомендациях</span><span class="sxs-lookup"><span data-stu-id="83d4c-231">Troubleshooting Language Resources and Best Practices</span></span>](troubleshooting-language-resources.md)
</dt> </dl>

 

 
