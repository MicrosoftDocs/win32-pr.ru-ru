---
description: В этом разделе описаны три этапа процесса индексирования и основные компоненты, участвующие в каждом из них, объясняется время индексирования, а также приводятся некоторые замечания для сторонних разработчиков, которые хотят индексировать свои хранилища данных или форматы файлов.
ms.assetid: cfba12eb-4123-4b57-8311-d4fc8f9f514e
title: Процесс индексирования в Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87867d5925cd53b237092435bbc9d16428418b4f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103808951"
---
# <a name="indexing-process-in-windows-search"></a><span data-ttu-id="b177d-103">Процесс индексирования в Windows Search</span><span class="sxs-lookup"><span data-stu-id="b177d-103">Indexing Process in Windows Search</span></span>

<span data-ttu-id="b177d-104">В этом разделе описаны три этапа процесса индексирования и основные компоненты, участвующие в каждом из них, объясняется время индексирования, а также приводятся некоторые замечания для сторонних разработчиков, которые хотят индексировать свои хранилища данных или форматы файлов.</span><span class="sxs-lookup"><span data-stu-id="b177d-104">This topic describes the three stages of the indexing process and the primary components involved in each, explains the timing of indexing activity, and provides some notes for third-party developers who want their data stores or file formats indexed.</span></span>

<span data-ttu-id="b177d-105">Этот раздел организован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b177d-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="b177d-106">Обзор</span><span class="sxs-lookup"><span data-stu-id="b177d-106">Overview</span></span>](#overview)
- [<span data-ttu-id="b177d-107">Этап 1. URL-адреса очереди для индексирования</span><span class="sxs-lookup"><span data-stu-id="b177d-107">Stage 1: Queuing URLs for Indexing</span></span>](#stage-1-queuing-urls-for-indexing)
- [<span data-ttu-id="b177d-108">Этап 2. обход URL-адресов</span><span class="sxs-lookup"><span data-stu-id="b177d-108">Stage 2: Crawling URLs</span></span>](#stage-2-crawling-urls)
- [<span data-ttu-id="b177d-109">Этап 3. обновление индекса</span><span class="sxs-lookup"><span data-stu-id="b177d-109">Stage 3: Updating the Index</span></span>](#stage-3-updating-the-index)
- [<span data-ttu-id="b177d-110">Как запланировано индексирование</span><span class="sxs-lookup"><span data-stu-id="b177d-110">How Indexing is Scheduled</span></span>](#how-indexing-is-scheduled)
- [<span data-ttu-id="b177d-111">Примечания для тех, кто реализует этот метод</span><span class="sxs-lookup"><span data-stu-id="b177d-111">Notes to Implementers</span></span>](#notes-to-implementers)
- [<span data-ttu-id="b177d-112">См. также</span><span class="sxs-lookup"><span data-stu-id="b177d-112">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="b177d-113">Обзор</span><span class="sxs-lookup"><span data-stu-id="b177d-113">Overview</span></span>

<span data-ttu-id="b177d-114">Поиск Windows поддерживает индексирование свойств и содержимого из файлов различных форматов, таких как формат doc или JPEG, и хранилищ данных, таких как файловая система или почтовые ящики Windows Outlook.</span><span class="sxs-lookup"><span data-stu-id="b177d-114">Windows Search supports the indexing of properties and content from files of different file formats, such as .doc or .jpeg formats, and data stores, such as the file system or Windows Outlook mailboxes.</span></span> <span data-ttu-id="b177d-115">Существует два типа индексов: индексы значений, позволяющие выполнять фильтрацию и сортировку по всему значению свойства и инвертированных индексов, которые индексируют слова в текстовых свойствах или содержимом.</span><span class="sxs-lookup"><span data-stu-id="b177d-115">There are two kinds of indices: value indices that allow filtering and sorting by the whole value of a property and inverted indices that index words within textual properties or content.</span></span> <span data-ttu-id="b177d-116">Если у вас есть пользовательский формат файла или хранилище данных, необходимо понять, как индексы Windows Search будут правильно индексировать элементы.</span><span class="sxs-lookup"><span data-stu-id="b177d-116">If you have a custom file format or data store, you need to understand how Windows Search indexes in order to get your items indexed correctly.</span></span>

<span data-ttu-id="b177d-117">Процесс индексирования выполняется в три этапа, управляемого компонентом поиска Windows, который называется средством сбора данных.</span><span class="sxs-lookup"><span data-stu-id="b177d-117">The indexing process happens in three stages controlled by a Windows Search component called the gatherer.</span></span> <span data-ttu-id="b177d-118">На первом этапе средство сбора данных добавляет URL-адреса в очереди.</span><span class="sxs-lookup"><span data-stu-id="b177d-118">In the first stage, the gatherer adds URLs to queues.</span></span> <span data-ttu-id="b177d-119">URL-адреса определяют Индексируемые элементы, а очереди являются просто приоритетными списками URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="b177d-119">The URLs identify items to be indexed, and the queues are merely prioritized lists of URLs.</span></span> <span data-ttu-id="b177d-120">На втором этапе средство сбора данных координирует другие компоненты поиска Windows и сторонних компонентов для доступа к элементам и сбора данных о них.</span><span class="sxs-lookup"><span data-stu-id="b177d-120">In the second stage, the gatherer coordinates other Windows Search and third-party components to access the items and collect data about them.</span></span> <span data-ttu-id="b177d-121">Наконец, на третьем этапе собранные данные добавляются в индекс.</span><span class="sxs-lookup"><span data-stu-id="b177d-121">Finally, in the third stage, the data collected is added to the index.</span></span>

<span data-ttu-id="b177d-122">На следующей схеме показаны основные компоненты и поток данных с помощью процесса индексирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-122">The following diagram shows the principal components and flow of data through the indexing process.</span></span> <span data-ttu-id="b177d-123">Количество компонентов, участвующих в сборе данных для индекса.</span><span class="sxs-lookup"><span data-stu-id="b177d-123">A number of components are involved in collecting data for the index.</span></span> <span data-ttu-id="b177d-124">Некоторые из них являются частью службы поиска Windows, и некоторые из них поступают из сторонних приложений.</span><span class="sxs-lookup"><span data-stu-id="b177d-124">Some of these are a part of Windows Search, and some come from third-party applications.</span></span> <span data-ttu-id="b177d-125">Если у вас есть пользовательское хранилище данных или файловый формат, Поиск Windows полагается на обработчик протокола и отфильтрует доступ к URL-адресам и порождает свойства для индексирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-125">If you have a custom data store or file format, Windows Search relies on your protocol handler and filter for accessing URLs and emitting properties for indexing.</span></span> <span data-ttu-id="b177d-126">Компоненты Windows Search отображаются синим цветом, а сторонние — зеленым.</span><span class="sxs-lookup"><span data-stu-id="b177d-126">Windows Search components are shown in blue, and third-party components are shown in green.</span></span>

![Диаграмма, демонстрирующая взаимодействие между компонентами во время процесса индексирования](images/indexingcompoverview.jpg)

## <a name="stage-1-queuing-urls-for-indexing"></a><span data-ttu-id="b177d-128">Этап 1. URL-адреса очереди для индексирования</span><span class="sxs-lookup"><span data-stu-id="b177d-128">Stage 1: Queuing URLs for Indexing</span></span>

<span data-ttu-id="b177d-129">На первом этапе индексирования сборщик собирает сведения об обновлениях в хранилищах данных, сравнивает эти сведения с известной областью сканирования, а затем создает очередь URL-адресов для прохода по сбору данных для индекса.</span><span class="sxs-lookup"><span data-stu-id="b177d-129">In the first stage of indexing, the gatherer collects information about updates to data stores, compares that information to the known crawl scope, and then builds a queue of URLs to traverse to collect data for the index.</span></span> <span data-ttu-id="b177d-130">Для источников, которые не основаны на уведомлениях, таких как диски FAT, сборщик периодически инициирует полный обход области сканирования, чтобы данные в индексе сохранялись в актуальном состоянии.</span><span class="sxs-lookup"><span data-stu-id="b177d-130">For sources that are not based on notification, such as FAT drives, the gatherer periodically initiates a full traversal of the crawl scope so that the data in the index is kept fresh.</span></span> <span data-ttu-id="b177d-131">Для таких источников, как NTFS, существует только один обход содержимого, и все остальное обрабатывается уведомлениями из [журнала изменений USN](/windows/desktop/FileIO/change-journals).</span><span class="sxs-lookup"><span data-stu-id="b177d-131">For sources such as NTFS, there is only a single crawl and everything else is handled by notifications from the [USN Change Journal](/windows/desktop/FileIO/change-journals).</span></span> <span data-ttu-id="b177d-132">Сканирование Microsoft Outlook также отсутствует.</span><span class="sxs-lookup"><span data-stu-id="b177d-132">There is also no crawl of Microsoft Outlook.</span></span> <span data-ttu-id="b177d-133">На следующей схеме показано высокоуровневое представление процесса очереди для индексирования без обхода содержимого.</span><span class="sxs-lookup"><span data-stu-id="b177d-133">The following diagram shows a high-level view of the queuing process for non-crawl indexing.</span></span>

![Схема, демонстрирующая процесс запроса для индексирования без обхода содержимого](images/queuingurls.jpg)

<span data-ttu-id="b177d-135">В оставшейся части этого раздела объясняется, как система поиска Windows определяет, какие URL-адреса следует обойти, и определяет некоторые важные термины.</span><span class="sxs-lookup"><span data-stu-id="b177d-135">The rest of this section explains how Windows Search determines what URLs to crawl, and defines some important terms along the way.</span></span>

<span data-ttu-id="b177d-136">**Область обхода содержимого**  Область обхода содержимого — это набор URL-адресов, с помощью которых Поиск Windows осуществляет сбор данных о элементах, которые пользователь желает проиндексировать для ускорения поиска.</span><span class="sxs-lookup"><span data-stu-id="b177d-136">**Crawl Scope**  The crawl scope is a set of URLs that Windows Search traverses to collect data about items that the user wants indexed for faster searches.</span></span> <span data-ttu-id="b177d-137">Поиск Windows добавляет некоторые URL-адреса в область обхода содержимого по умолчанию, например пути к папкам **Documents** и **Pictures** пользователя.</span><span class="sxs-lookup"><span data-stu-id="b177d-137">Windows Search adds some URLs to the crawl scope by default, like paths to users' **Documents** and **Pictures** folders.</span></span> <span data-ttu-id="b177d-138">Другие URL-адреса могут добавляться приложениями сторонних разработчиков, пользователями и групповая политика.</span><span class="sxs-lookup"><span data-stu-id="b177d-138">Other URLs can be added by third-party applications, users, and Group Policy.</span></span> <span data-ttu-id="b177d-139">Наконец, пользователи и групповая политика могут явно исключать URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="b177d-139">Finally, both users and Group Policy can explicitly exclude URLs.</span></span> <span data-ttu-id="b177d-140">Windows Search принимает все добавленные URL-адреса и удаляет исключенные URL-адреса для определения области обхода.</span><span class="sxs-lookup"><span data-stu-id="b177d-140">Windows Search takes all the added URLs and removes the excluded URLs to determine the crawl scope.</span></span> <span data-ttu-id="b177d-141">Это рабочий набор URL-адресов, из которого сборщик начинает работу.</span><span class="sxs-lookup"><span data-stu-id="b177d-141">This is the working set of URLs from which the gatherer begins its work.</span></span>

<span data-ttu-id="b177d-142">**Средство сбора данных**  Средство сбора данных — это компонент Windows Search, который собирает сведения об URL-адресах в области сканирования и создает очередь URL-адресов для обхода содержимого индексатора.</span><span class="sxs-lookup"><span data-stu-id="b177d-142">**Gatherer**  The gatherer is a Windows Search component that collects information about URLs within the crawl scope and creates a queue of URLs for the indexer to crawl.</span></span> <span data-ttu-id="b177d-143">При добавлении, удалении или обновлении элемента в области обхода сборщик получает уведомление от поставщика уведомлений хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="b177d-143">When an item in the crawl scope is added, deleted, or updated, the gatherer is notified by the data store's notifications provider.</span></span> <span data-ttu-id="b177d-144">Выполняется первоначальное сканирование, при котором средство сбора данных запускается в корне области обхода содержимого.</span><span class="sxs-lookup"><span data-stu-id="b177d-144">There is an initial crawl where the gatherer starts at the crawl scope root.</span></span> <span data-ttu-id="b177d-145">URL-адрес передается обработчику протокола, а затем — соответствующему [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter).</span><span class="sxs-lookup"><span data-stu-id="b177d-145">The URL is passed to the protocol handler and then to the appropriate [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter).</span></span> <span data-ttu-id="b177d-146">Фильтр обычно является перечислением каталогов, которое создает больше URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="b177d-146">The filter is usually a directory enumeration that produces more URLs.</span></span> <span data-ttu-id="b177d-147">Уведомления являются устойчивым состоянием.</span><span class="sxs-lookup"><span data-stu-id="b177d-147">Notifications are the steady-state.</span></span> <span data-ttu-id="b177d-148">Как правило, каждое хранилище данных имеет собственный обработчик протокола, который предоставляет эти уведомления.</span><span class="sxs-lookup"><span data-stu-id="b177d-148">Typically, each data store has its own protocol handler that provides these notifications.</span></span> <span data-ttu-id="b177d-149">Например, в локальной файловой системе [Журнал изменений USN](/windows/desktop/FileIO/change-journals) выступает в качестве поставщика уведомлений для всех URL-адресов в протоколе file://.</span><span class="sxs-lookup"><span data-stu-id="b177d-149">For example, on the local file system, the [USN Change Journal](/windows/desktop/FileIO/change-journals) acts as a notifications provider for all URLs under the file:// protocol.</span></span> <span data-ttu-id="b177d-150">Аналогичным образом Microsoft Outlook выступает в качестве поставщика уведомлений для всех URL-адресов в протоколе mapi://.</span><span class="sxs-lookup"><span data-stu-id="b177d-150">Similarly, Microsoft Outlook acts as a notifications provider for all URLs under the mapi:// protocol.</span></span> <span data-ttu-id="b177d-151">Когда пользователь получает, перемещает или удаляет сообщение электронной почты, Outlook уведомляет средство сбора о измененном состоянии сообщения.</span><span class="sxs-lookup"><span data-stu-id="b177d-151">When a user receives, moves, or deletes email, Outlook notifies the gatherer of the changed status of the email.</span></span> <span data-ttu-id="b177d-152">Из этих уведомлений сборщик создает очереди индексации URL-адресов для обхода.</span><span class="sxs-lookup"><span data-stu-id="b177d-152">From these notifications, the gatherer creates indexing queues of URLs to crawl.</span></span>

<span data-ttu-id="b177d-153">**Индексирование очередей**  Очереди индексирования представляют собой списки URL-адресов, которые определяют элементы, которые необходимо индексировать или повторно индексировать.</span><span class="sxs-lookup"><span data-stu-id="b177d-153">**Indexing Queues**  The indexing queues are lists of URLs that identify items that need to be indexed or re-indexed.</span></span> <span data-ttu-id="b177d-154">Сборщик сравнивает URL-адреса, получаемые от поставщиков уведомлений, с URL-адресами в области обхода.</span><span class="sxs-lookup"><span data-stu-id="b177d-154">The gatherer compares the URLs it receives from notifications providers to the URLs in the crawl scope.</span></span> <span data-ttu-id="b177d-155">Каждый URL-адрес от поставщиков уведомлений, которые попадают в область сканирования, добавляется в очередь, которую средство сбора данных использует для определения приоритета обработки следующих URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="b177d-155">Every URL from notifications providers that falls within the crawl scope is added to a queue that the gatherer uses to prioritize which URLs to process next.</span></span>

<span data-ttu-id="b177d-156">Существует три очереди: уведомления с высоким приоритетом, обычные уведомления и периодическое сканирование.</span><span class="sxs-lookup"><span data-stu-id="b177d-156">There are three queues: high priority notifications, normal notifications, and periodic crawls.</span></span> <span data-ttu-id="b177d-157">Очередь с высоким приоритетом предназначена для уведомлений, которые должны обрабатываться немедленно.</span><span class="sxs-lookup"><span data-stu-id="b177d-157">The high priority queue is for notifications that should be processed immediately.</span></span> <span data-ttu-id="b177d-158">Например, когда пользователь изменяет свойство заголовка элемента в проводнике Windows, необходимо немедленно обновить представление проводника Windows после изменения.</span><span class="sxs-lookup"><span data-stu-id="b177d-158">For example, when a user changes an item's title property in Windows Explorer, the Windows Explorer view needs to be updated immediately after the change.</span></span> <span data-ttu-id="b177d-159">Обычная очередь уведомлений — для всех оставшихся уведомлений об изменениях.</span><span class="sxs-lookup"><span data-stu-id="b177d-159">The normal notification queue is for all remaining change notifications.</span></span> <span data-ttu-id="b177d-160">Очереди уведомлений обрабатываются перед очередью сканирования, так как измененные элементы, скорее всего, будут интересны пользователю.</span><span class="sxs-lookup"><span data-stu-id="b177d-160">The notification queues are processed before the crawl queue because changed items are more likely to be of interest to a user.</span></span> <span data-ttu-id="b177d-161">Средство сбора данных обращается к данным для URL-адресов в каждой очереди в порядке поступления (FIFO).</span><span class="sxs-lookup"><span data-stu-id="b177d-161">The gatherer accesses data for the URLs on each queue in first in, first out (FIFO) order.</span></span>

<span data-ttu-id="b177d-162">Дополнительные сведения о приоритетах и API-интерфейсах событий, появившихся в Windows 7, см. [в разделе индексирование определения приоритетов и событий набора строк в Windows 7](indexing-prioritization-and-rowset-events.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-162">For more information on prioritization, and eventing APIs introduced in Windows 7, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span> <span data-ttu-id="b177d-163">Дополнительные сведения об управлении областью обхода и уведомлениях см. в разделе [предоставление уведомлений об изменениях](-search-3x-wds-notifyingofchanges.md) и [Использование диспетчера области сканирования](-search-3x-wds-extidx-csm.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-163">For more information on crawl scope management and notifications, see [Providing Change Notifications](-search-3x-wds-notifyingofchanges.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>

## <a name="stage-2-crawling-urls"></a><span data-ttu-id="b177d-164">Этап 2. обход URL-адресов</span><span class="sxs-lookup"><span data-stu-id="b177d-164">Stage 2: Crawling URLs</span></span>

<span data-ttu-id="b177d-165">На втором этапе индексирования сборщик выполняет обход содержимого очередей, доступ к хранилищам данных и получение потоков элементов.</span><span class="sxs-lookup"><span data-stu-id="b177d-165">In the second stage of indexing, the gatherer crawls through the queues, accessing data stores and retrieving item streams.</span></span> <span data-ttu-id="b177d-166">Сначала сборщик находит соответствующий обработчик протокола для каждого URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="b177d-166">First, the gatherer finds the appropriate protocol handler for each URL.</span></span> <span data-ttu-id="b177d-167">Затем средство сбора данных передает URL-адрес обработчику протокола.</span><span class="sxs-lookup"><span data-stu-id="b177d-167">Then, the gatherer passes the URL to the protocol handler.</span></span> <span data-ttu-id="b177d-168">Обработчик протокола обращается к элементу и передает метаданные элементов обратно средству сбора данных.</span><span class="sxs-lookup"><span data-stu-id="b177d-168">The protocol handler accesses the item and passes item metadata back to the gatherer.</span></span> <span data-ttu-id="b177d-169">Средство сбора данных использует метаданные для указания правильного фильтра.</span><span class="sxs-lookup"><span data-stu-id="b177d-169">The gatherer uses the metadata to identify the correct filter.</span></span>

<span data-ttu-id="b177d-170">На следующей схеме показано высокоуровневое представление процесса обхода URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="b177d-170">The following diagram shows a high-level view of the URL-crawling process.</span></span> <span data-ttu-id="b177d-171">Этот этап включает в себя значительное координирование и обмен данными между компонентами.</span><span class="sxs-lookup"><span data-stu-id="b177d-171">This stage includes considerable coordination and communication between components.</span></span>

![Схема, показывающая процесс обхода URL-адресов и доступа к элементам](images/crawlingqueues.jpg)

<span data-ttu-id="b177d-173">В оставшейся части этого раздела описывается, как поиск Windows обращается к элементам для индексирования и объясняются роли каждого задействованного компонента.</span><span class="sxs-lookup"><span data-stu-id="b177d-173">The rest of this section describes how Windows Search accesses items for indexing and explains the roles of each of the components involved.</span></span>

<span data-ttu-id="b177d-174">**Средство сбора данных**  На этапе 2 этап обхода, сборщик обрабатывает URL-адреса в очередях, начиная с очереди с высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="b177d-174">**Gatherer**  In stage 2, the crawling stage, the gatherer processes the URLs in the queues, beginning with the high priority queue.</span></span> <span data-ttu-id="b177d-175">Каждый URL-адрес проверяется для обнаружения его протокола.</span><span class="sxs-lookup"><span data-stu-id="b177d-175">Each URL is examined to identify its protocol.</span></span> <span data-ttu-id="b177d-176">Затем средство сбора данных ищет обработчик протокола, зарегистрированный для этого протокола, и создает его экземпляр в хостном процессе протокола поиска.</span><span class="sxs-lookup"><span data-stu-id="b177d-176">The gatherer then looks up the protocol handler registered for that protocol and instantiates it in the search protocol host process.</span></span>

<span data-ttu-id="b177d-177">**Узел протокола поиска**  Узел протокола поиска — это просто упакованный хост-процесс для обработчиков протоколов.</span><span class="sxs-lookup"><span data-stu-id="b177d-177">**Search Protocol Host**  The search protocol host is merely a boxed, host process for protocol handlers.</span></span> <span data-ttu-id="b177d-178">Как правило, служба поиска Windows создает два таких процесса размещения, один из которых выполняется в контексте безопасности системы и один, который выполняется в контексте безопасности пользователя.</span><span class="sxs-lookup"><span data-stu-id="b177d-178">Typically, Windows Search creates two such host processes, one that runs in the system security context and one that runs in the user security context.</span></span> <span data-ttu-id="b177d-179">Это разделение гарантирует, что данные, относящиеся к пользователю, никогда не запускаются в системном контексте.</span><span class="sxs-lookup"><span data-stu-id="b177d-179">This separation ensures that data specific to a user is never run in the system context.</span></span>

<span data-ttu-id="b177d-180">Поиск Windows также использует хост-процесс для изоляции экземпляра обработчика протокола от других процессов или приложений.</span><span class="sxs-lookup"><span data-stu-id="b177d-180">Windows Search also uses the host process to isolate an instance of a protocol handler from other processes or applications.</span></span> <span data-ttu-id="b177d-181">Таким образом, ни одно из внешних приложений не сможет получить доступ к конкретному экземпляру обработчика протокола, а в случае непредвиденного сбоя обработчика протокола это повлияет только на процесс индексирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-181">This way, no outside application can access that specific instance of the protocol handler, and if the protocol handler fails unexpectedly, only the indexing process is affected.</span></span> <span data-ttu-id="b177d-182">Поскольку хост-процесс выполняет сторонний код (обработчики протоколов), служба поиска Windows периодически перезапускает процесс, чтобы максимально сокращать время, в течение которого атака будет использована для использования информации в процессе.</span><span class="sxs-lookup"><span data-stu-id="b177d-182">Because the host process runs third party code (protocol handlers), Windows Search periodically recycles the process to minimize the time a successful attack has to exploit information in the process.</span></span> <span data-ttu-id="b177d-183">Кроме того, узел протокола поиска не влияет на обход содержимого URL-адресов или индексации элементов.</span><span class="sxs-lookup"><span data-stu-id="b177d-183">Beyond this, the search protocol host does not affect the crawling of URLs or indexing of items.</span></span>

<span data-ttu-id="b177d-184">**Обработчики протоколов**  Обработчики протоколов предоставляют доступ к элементам в хранилище данных с помощью протокола хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="b177d-184">**Protocol Handlers**  Protocol handlers provide access to items in a data store using the data store's protocol.</span></span> <span data-ttu-id="b177d-185">Например, обработчик протокола NTFS предоставляет доступ к файлам на локальном диске с помощью протокола file://.</span><span class="sxs-lookup"><span data-stu-id="b177d-185">For example, the NTFS protocol handler provides access to files on a local drive using the file:// protocol.</span></span> <span data-ttu-id="b177d-186">Обработчик протокола знает, как перемещаться по хранилищу данных, обнаруживать новые или обновленные элементы и уведомлять средство сбора данных.</span><span class="sxs-lookup"><span data-stu-id="b177d-186">The protocol handler knows how to traverse the data store, identify new or updated items, and notify the gatherer.</span></span> <span data-ttu-id="b177d-187">Затем, когда начинается обход содержимого, обработчик протокола предоставляет объект [**иурлакцессор**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) для привязки к базовому потоку элемента и возвращает метаданные элемента, такие как ограничения безопасности и время последнего изменения.</span><span class="sxs-lookup"><span data-stu-id="b177d-187">Then, when crawling begins, the protocol handler provides an [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object to the gatherer to bind to the item's underlying stream and return item metadata such as security restrictions and last modified time.</span></span>

> [!NOTE]  
> <span data-ttu-id="b177d-188">Обработчики протоколов не являются компонентами Windows Search. они являются компонентами конкретного протокола и хранилища данных, для доступа к которым они предназначены.</span><span class="sxs-lookup"><span data-stu-id="b177d-188">Protocol handlers are not Windows Search components; they are components of the specific protocol and data store they are designed to access.</span></span> <span data-ttu-id="b177d-189">Если у вас есть пользовательское хранилище данных, для которого требуется индексирование, необходимо реализовать обработчик протокола.</span><span class="sxs-lookup"><span data-stu-id="b177d-189">If you have a custom data store you want indexed, you need to implement a protocol handler.</span></span> <span data-ttu-id="b177d-190">Дополнительные сведения о обработчиках протоколов и о том, как его реализовать, см. в разделе [Разработка обработчиков протоколов](-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-190">For more information on protocol handlers and how to implement one, refer to [Developing Protocol Handlers](-search-3x-wds-phaddins.md).</span></span>

<span data-ttu-id="b177d-191">**Метаданные и поток**  С помощью метаданных, возвращаемых объектом [**иурлакцессор**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) обработчика протокола, сборщик определяет правильный фильтр для URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="b177d-191">**Metadata and Stream**  Using metadata returned by the protocol handler's [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object, the gatherer identifies the correct filter for the URL.</span></span> <span data-ttu-id="b177d-192">Средство сбора данных анализирует расширение имени файла элемента и ищет фильтр, зарегистрированный для этого расширения.</span><span class="sxs-lookup"><span data-stu-id="b177d-192">The gatherer parses the item's file name extension and looks up the filter registered for that extension.</span></span> <span data-ttu-id="b177d-193">Если сборщику не удается найти фильтр, Windows Search использует метаданные для получения минимального набора сведений о системных свойствах (например, System. ItemName) и обновляет индекс.</span><span class="sxs-lookup"><span data-stu-id="b177d-193">If the gatherer is unable to find a filter, Windows Search uses the metadata to derive a minimal set of system property information (like System.ItemName) and updates the index.</span></span> <span data-ttu-id="b177d-194">В противном случае, если сборщик обнаруживает фильтр, начинается третья стадия индексирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-194">Otherwise, if the gatherer finds the filter, the third stage of indexing begins.</span></span>

## <a name="stage-3-updating-the-index"></a><span data-ttu-id="b177d-195">Этап 3. обновление индекса</span><span class="sxs-lookup"><span data-stu-id="b177d-195">Stage 3: Updating the Index</span></span>

<span data-ttu-id="b177d-196">На третьем этапе индексирования сборщик создает правильный фильтр для URL-адреса и инициализирует фильтр с потоком из объекта [**иурлакцессор**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) .</span><span class="sxs-lookup"><span data-stu-id="b177d-196">In the third stage of indexing, the gatherer instantiates the correct filter for the URL and initializes the filter with the stream from the [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object.</span></span> <span data-ttu-id="b177d-197">Затем фильтр обращается к элементу и возвращает содержимое для индекса.</span><span class="sxs-lookup"><span data-stu-id="b177d-197">The filter then accesses the item and returns content for the index.</span></span> <span data-ttu-id="b177d-198">При наличии пользовательского формата файла Поиск Windows использует фильтр для доступа к URL-адресам и отправки содержимого и свойств для индексирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-198">If you have a custom file format, Windows Search relies on your filter to access URLs and emit content and properties for indexing.</span></span>

<span data-ttu-id="b177d-199">На следующей схеме показано высокоуровневое представление процесса доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="b177d-199">The following diagram shows a high-level view of the data access process.</span></span> <span data-ttu-id="b177d-200">Этот этап включает в себя значительное координирование и обмен данными между компонентами.</span><span class="sxs-lookup"><span data-stu-id="b177d-200">This stage includes considerable coordination and communication between components.</span></span>

![Диаграмма, показывающая данные элементов, отправленные для индекса](images/filteringdata.jpg)

<span data-ttu-id="b177d-202">В оставшейся части этого раздела описывается, как Windows Search обращается к данным элемента для индексирования и объясняет роли каждого задействованного компонента.</span><span class="sxs-lookup"><span data-stu-id="b177d-202">The rest of this section describes how Windows Search accesses item data for indexing and explains the roles of each of the components involved.</span></span>

<span data-ttu-id="b177d-203">**Средство сбора данных**  В начале этого этапа роль сборщика состоит в создании экземпляра правильного фильтра для элемента и передаче его потоку элементов.</span><span class="sxs-lookup"><span data-stu-id="b177d-203">**Gatherer**  At the beginning of this stage, the gatherer's role is to instantiate the correct filter for the item and pass it the item stream.</span></span> <span data-ttu-id="b177d-204">В конце этого этапа средство сбора данных принимает содержимое и свойства, созданные фильтром и обработчиком свойств, и обновляет индекс.</span><span class="sxs-lookup"><span data-stu-id="b177d-204">At the end of this stage, the gatherer takes the content and properties emitted by the filter and property handler and updates the index.</span></span>

<span data-ttu-id="b177d-205">**Узел фильтра**  Узел фильтра — это просто ведущий процесс для фильтров и обработчиков свойств, которые служат целью, похожей на узел протокола поиска.</span><span class="sxs-lookup"><span data-stu-id="b177d-205">**Filter Host**  The filter host is merely a host process for filters and property handlers and serves a purpose similar to the search protocol host.</span></span> <span data-ttu-id="b177d-206">Ведущий процесс изолирует фильтры и обработчики свойств от остальной части системы на наличие одинаковых соображений безопасности и стабильности, по которым хостовые процессы протокола поиска изолируют обработчики протоколов.</span><span class="sxs-lookup"><span data-stu-id="b177d-206">The host process isolates filters and property handlers from the rest of the system for the same security and stability reasons that search protocol host processes isolate protocol handlers.</span></span> <span data-ttu-id="b177d-207">Ведущий процесс выполняется с минимальными правами (он не может получить доступ к файловой системе) и иногда перезапускается для защиты от атак безопасности.</span><span class="sxs-lookup"><span data-stu-id="b177d-207">The host process runs with minimal rights (it can't even access the file system) and is occasionally recycled to protect against security attacks.</span></span> <span data-ttu-id="b177d-208">Поиск Windows также отслеживает использование ресурсов, так что если фильтр использует слишком много ресурсов, ведущий процесс перезапускается.</span><span class="sxs-lookup"><span data-stu-id="b177d-208">Windows Search also monitors resource use so that if a filter consumes too many resources, the host process is recycled.</span></span>

<span data-ttu-id="b177d-209">**Фильтры**  Фильтры являются критически важными компонентами в процессе индексирования, которые выдают сведения об элементе для средства сбора данных.</span><span class="sxs-lookup"><span data-stu-id="b177d-209">**Filters**  Filters are critical components in the indexing process that emit item information for the gatherer.</span></span> <span data-ttu-id="b177d-210">Имена фильтров задаются после основного интерфейса, используемого в их реализации, интерфейсе [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) и, следовательно, иногда называются фильтрами IFilter.</span><span class="sxs-lookup"><span data-stu-id="b177d-210">Filters are named after the principal interface used in their implementation, the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface, and consequently are sometimes referred to as IFilters.</span></span> <span data-ttu-id="b177d-211">Существует два вида фильтров: один, который взаимодействует с отдельными элементами, такими как файлы, и другой, взаимодействующий с контейнерами, такими как папки.</span><span class="sxs-lookup"><span data-stu-id="b177d-211">There are two kinds of filters: one that interacts with individual items like files and one that interacts with containers like folders.</span></span> <span data-ttu-id="b177d-212">Оба предоставляют данные для индекса.</span><span class="sxs-lookup"><span data-stu-id="b177d-212">Both provide data for the index.</span></span>

<span data-ttu-id="b177d-213">С помощью метаданных, возвращенных объектом [**иурлакцессор**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) обработчика протокола, сборщик определяет правильный фильтр для конкретного URL-адреса и передает его в поток.</span><span class="sxs-lookup"><span data-stu-id="b177d-213">Using metadata returned by the protocol handler's [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object, the gatherer identifies the correct filter for a particular URL and passes it to the stream.</span></span> <span data-ttu-id="b177d-214">Сборщик определяет правильный фильтр либо с помощью обработчика протокола, либо с помощью расширения имени файла, типа MIME или идентификатора класса (CLSID).</span><span class="sxs-lookup"><span data-stu-id="b177d-214">The gatherer identifies the correct filter either through a protocol handler or by the file name extension, MIME type, or class identifier (CLSID).</span></span> <span data-ttu-id="b177d-215">Если URL-адрес указывает на контейнер, фильтр выдает свойства для контейнера и перечисляет элементы в контейнере (дочерние URL-адреса).</span><span class="sxs-lookup"><span data-stu-id="b177d-215">If the URL points to a container, the filter emits properties for the container and enumerates the items in the container (child URLs).</span></span> <span data-ttu-id="b177d-216">Если URL-адрес указывает на элемент, фильтр возвращает текстовое содержимое, если такое считывание свойств и более сложное, чем обработчики свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-216">If the URL points to an item, the filter returns the textual content, if any the reading of properties and are more complex than property handlers.</span></span> <span data-ttu-id="b177d-217">Обычно рекомендуется, чтобы фильтры выдавали содержимое элемента, а обработчики свойств создавали свойства элемента.</span><span class="sxs-lookup"><span data-stu-id="b177d-217">Generally, we recommend that filters emit item contents while property handlers emit item properties.</span></span> <span data-ttu-id="b177d-218">Однако если фильтр должен работать с более старыми приложениями, которые не распознают обработчики свойств, можно реализовать фильтр, который также будет выдавать свойства.</span><span class="sxs-lookup"><span data-stu-id="b177d-218">However, if your filter needs to work with older applications that do not recognize property handlers, you can implement the filter to emit properties as well.</span></span>

> [!NOTE]  
> <span data-ttu-id="b177d-219">Фильтры не являются компонентами Windows Search. они представляют собой компоненты, связанные с конкретным форматом файлов или контейнером, к которому они относятся.</span><span class="sxs-lookup"><span data-stu-id="b177d-219">Filters are not Windows Search components; they are components related to the specific file format or container they are designed to access.</span></span> <span data-ttu-id="b177d-220">Дополнительные сведения о фильтрах и о том, как реализовать его для пользовательского формата файла или контейнера, см. в разделе рекомендации [по созданию обработчиков фильтров в Windows Search](-search-3x-wds-extidx-filters.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-220">For more information on filters and how to implement one for a custom file format or container, see [Best Practices for Creating Filter Handlers in Windows Search](-search-3x-wds-extidx-filters.md).</span></span>

<span data-ttu-id="b177d-221">В следующей таблице перечислены результаты, получаемые средством сбора данных фильтром ([**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)) и обработчиком свойств ([**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore)) в процессе индексирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-221">The following table lists the results that the gatherer receives from a filter ([**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)) and property handler ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)) during the indexing process.</span></span>

|                            | [<span data-ttu-id="b177d-222">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="b177d-222">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter) | [<span data-ttu-id="b177d-223">**ипропертисторе**</span><span class="sxs-lookup"><span data-stu-id="b177d-223">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore) |
|----------------------------|------------------------------------|-------------------------------------------------|
| <span data-ttu-id="b177d-224">Разрешить запись</span><span class="sxs-lookup"><span data-stu-id="b177d-224">Allow write</span></span>                | <span data-ttu-id="b177d-225">Нет</span><span class="sxs-lookup"><span data-stu-id="b177d-225">No</span></span>                                 | <span data-ttu-id="b177d-226">Да</span><span class="sxs-lookup"><span data-stu-id="b177d-226">Yes</span></span>                                             |
| <span data-ttu-id="b177d-227">Смешение содержимого и свойств</span><span class="sxs-lookup"><span data-stu-id="b177d-227">Mix content and properties</span></span> | <span data-ttu-id="b177d-228">Да</span><span class="sxs-lookup"><span data-stu-id="b177d-228">Yes</span></span>                                | <span data-ttu-id="b177d-229">Нет</span><span class="sxs-lookup"><span data-stu-id="b177d-229">No</span></span>                                              |
| <span data-ttu-id="b177d-230">Многоязычных</span><span class="sxs-lookup"><span data-stu-id="b177d-230">Multilingual</span></span>               | <span data-ttu-id="b177d-231">Да</span><span class="sxs-lookup"><span data-stu-id="b177d-231">Yes</span></span>                                | <span data-ttu-id="b177d-232">Нет</span><span class="sxs-lookup"><span data-stu-id="b177d-232">No</span></span>                                              |
| <span data-ttu-id="b177d-233">Выдавать ссылки</span><span class="sxs-lookup"><span data-stu-id="b177d-233">Emit links</span></span>                 | <span data-ttu-id="b177d-234">Да</span><span class="sxs-lookup"><span data-stu-id="b177d-234">Yes</span></span>                                | <span data-ttu-id="b177d-235">Нет</span><span class="sxs-lookup"><span data-stu-id="b177d-235">No</span></span>                                              |
| <span data-ttu-id="b177d-236">MIME</span><span class="sxs-lookup"><span data-stu-id="b177d-236">MIME</span></span>                       | <span data-ttu-id="b177d-237">Да</span><span class="sxs-lookup"><span data-stu-id="b177d-237">Yes</span></span>                                | <span data-ttu-id="b177d-238">Нет</span><span class="sxs-lookup"><span data-stu-id="b177d-238">No</span></span>                                              |
| <span data-ttu-id="b177d-239">Границы текста</span><span class="sxs-lookup"><span data-stu-id="b177d-239">Text boundaries</span></span>            | <span data-ttu-id="b177d-240">Предложение, абзац, глава</span><span class="sxs-lookup"><span data-stu-id="b177d-240">Sentence, paragraph, chapter</span></span>       | <span data-ttu-id="b177d-241">Нет</span><span class="sxs-lookup"><span data-stu-id="b177d-241">None</span></span>                                            |
| <span data-ttu-id="b177d-242">Клиент/сервер</span><span class="sxs-lookup"><span data-stu-id="b177d-242">Client / server</span></span>            | <span data-ttu-id="b177d-243">Оба</span><span class="sxs-lookup"><span data-stu-id="b177d-243">Both</span></span>                               | <span data-ttu-id="b177d-244">Клиент</span><span class="sxs-lookup"><span data-stu-id="b177d-244">Client</span></span>                                          |
| <span data-ttu-id="b177d-245">Реализация</span><span class="sxs-lookup"><span data-stu-id="b177d-245">Implementation</span></span>             | <span data-ttu-id="b177d-246">Complex</span><span class="sxs-lookup"><span data-stu-id="b177d-246">Complex</span></span>                            | <span data-ttu-id="b177d-247">Простота</span><span class="sxs-lookup"><span data-stu-id="b177d-247">Simple</span></span>                                          |

<span data-ttu-id="b177d-248">**Обработчики свойств**  Обработчики свойств — это компоненты, которые считывают и записывают свойства определенного формата файлов.</span><span class="sxs-lookup"><span data-stu-id="b177d-248">**Property Handlers**  Property handlers are components that read and write properties for a particular file format.</span></span> <span data-ttu-id="b177d-249">Они обращаются к элементам и выдают свойства для средства сбора данных так же, как и фильтры для содержимого.</span><span class="sxs-lookup"><span data-stu-id="b177d-249">They access items and emit properties for the gatherer in the same way that filters do for content.</span></span> <span data-ttu-id="b177d-250">Обработчики свойств проще реализовать, чем фильтры.</span><span class="sxs-lookup"><span data-stu-id="b177d-250">Property handlers are easier to implement than filters.</span></span> <span data-ttu-id="b177d-251">Если текстовый формат файла очень простой или файлы должны быть очень маленькими, обработчик свойств может создавать и свойства, и содержимое.</span><span class="sxs-lookup"><span data-stu-id="b177d-251">If a text-based file format is very simple or the files are expected to be very small, the property handler can emit both properties and content.</span></span>

> [!NOTE]  
> <span data-ttu-id="b177d-252">Обработчики свойств не являются компонентами Windows Search. они представляют собой компоненты, связанные с конкретным форматом файлов, для доступа к которым они предназначены.</span><span class="sxs-lookup"><span data-stu-id="b177d-252">Property handlers are not Windows Search components; they are components related to the specific file format they are designed to access.</span></span> <span data-ttu-id="b177d-253">Дополнительные сведения о обработчиках свойств и о том, как реализовать его для пользовательского формата файла, см. в разделе [Разработка обработчиков свойств для поиска Windows](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-253">For more information on property handlers and how to implement one for a custom file format, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

<span data-ttu-id="b177d-254">**Свойства** Windows Search предоставляет [систему свойств](https://msdn.microsoft.com/library/bb763010(VS.85).aspx) , которая включает в себя большую библиотеку свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-254">**Properties** Windows Search provides a [property system](https://msdn.microsoft.com/library/bb763010(VS.85).aspx) that includes a large library of properties.</span></span> <span data-ttu-id="b177d-255">Любое свойство может присутствовать в любом элементе, как определено фильтром или обработчиком свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-255">Any property can appear on any item as defined by the filter or property handler.</span></span> <span data-ttu-id="b177d-256">При наличии пользовательского формата файла можно сопоставлять свойства формата файла с этими системными свойствами, а также создавать новые пользовательские свойства.</span><span class="sxs-lookup"><span data-stu-id="b177d-256">If you have a custom file format, you can map your file format's properties to these system properties, and you can create new custom properties.</span></span> <span data-ttu-id="b177d-257">Когда обработчик фильтра или свойства порождает эти свойства, сборщик обновляет индекс, чтобы пользователи могли выполнять поиск с помощью своих свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-257">When your filter or property handler emits these properties, the gatherer updates the index so users can search using your properties.</span></span> <span data-ttu-id="b177d-258">Дополнительные сведения о создании и регистрации пользовательских свойств для формата файла см. в разделе [система свойств](../properties/building-property-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-258">For more information on creating and registering custom properties for a file format, see [Property System](../properties/building-property-handlers.md).</span></span>

<span data-ttu-id="b177d-259">**Системиндекс**  Индекс, именуемый Системиндекс, хранит индексированные данные и состоит из хранилища свойств и индексов по свойствам и содержимому для свойств элемента и инвертированному индексу для текстового содержимого и свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-259">**SystemIndex**  The index, called SystemIndex, stores indexed data and is composed of a property store and indices over the properties and content for item properties, and an inverted index for textual content and properties.</span></span> <span data-ttu-id="b177d-260">После того как средство сбора данных обновит индекс, его можно запросить с помощью поиска Windows и других приложений.</span><span class="sxs-lookup"><span data-stu-id="b177d-260">After the gatherer updates the index, the index can be queried by Windows Search and other applications.</span></span> <span data-ttu-id="b177d-261">Дополнительные сведения о способах запроса индекса см. в статье [программное выполнение запросов к индексу](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-261">For more information on ways to query the index, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

> [!NOTE]  
> <span data-ttu-id="b177d-262">Помните, что при повторной регистрации схемы изменения, внесенные в атрибуты ранее определенных свойств, могут не рассматриваться в качестве индексатора.</span><span class="sxs-lookup"><span data-stu-id="b177d-262">Remember that when you re-register a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="b177d-263">Решением может быть перестроение индекса или появление новых свойств, отражающих изменения вместо обновления старых (не рекомендуется).</span><span class="sxs-lookup"><span data-stu-id="b177d-263">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="b177d-264">Дополнительные сведения см. в разделе [Примечание для разработчиков](#notes-to-implementers) в статье [Общие сведения о системе свойств](../properties/property-system-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b177d-264">For more information, see [Note to Implementers](#notes-to-implementers) in [Properties System Overview](../properties/property-system-overview.md).</span></span>

## <a name="how-indexing-is-scheduled"></a><span data-ttu-id="b177d-265">Как запланировано индексирование</span><span class="sxs-lookup"><span data-stu-id="b177d-265">How Indexing is Scheduled</span></span>

<span data-ttu-id="b177d-266">При первой установке службы поиска Windows она выполняет полную индексацию области сканирования, приостанавливаясь в периоды высокого ввода-вывода и активности пользователей.</span><span class="sxs-lookup"><span data-stu-id="b177d-266">When Windows Search is first installed, it performs a full indexing of the crawl scope, pausing during periods of high I/O and user activity.</span></span> <span data-ttu-id="b177d-267">Область обхода по умолчанию состоит из расположений библиотеки по умолчанию, таких как **документы**, **музыка**, **изображения** и **видео**.</span><span class="sxs-lookup"><span data-stu-id="b177d-267">The default crawl scope consists of the default library locations, such as **Documents**, **Music**, **Pictures**, and **Videos**.</span></span> <span data-ttu-id="b177d-268">Уведомления обрабатываются даже до завершения первоначального сканирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-268">Notifications are processed even before the initial crawl is finished.</span></span> <span data-ttu-id="b177d-269">Иногда средство сбора данных обходит URL-адреса из области полного сканирования.</span><span class="sxs-lookup"><span data-stu-id="b177d-269">Occasionally, the gatherer crawls the URLs from the full crawl scope.</span></span> <span data-ttu-id="b177d-270">Эти полные обходные данные гарантируют актуальность данных в индексе.</span><span class="sxs-lookup"><span data-stu-id="b177d-270">These full crawls ensure that the data in the index is fresh.</span></span> <span data-ttu-id="b177d-271">Например, если поставщик уведомлений не может отправлять уведомления или служба Windows Search неожиданно завершает работу, средство сбора данных не будет иметь знания о новых или измененных элементах и не будет индексировать эти элементы.</span><span class="sxs-lookup"><span data-stu-id="b177d-271">For example, if a notification provider fails to send notifications or if the Windows Search service is terminated unexpectedly, the gatherer would have no knowledge of new or changed items and would not index these items.</span></span> <span data-ttu-id="b177d-272">Существует два типа источников: только уведомления и уведомления включены.</span><span class="sxs-lookup"><span data-stu-id="b177d-272">There are two kinds of sources: notification only and notification enabled.</span></span> <span data-ttu-id="b177d-273">В обоих источниках сборщик сначала обходит индекс.</span><span class="sxs-lookup"><span data-stu-id="b177d-273">In both sources, the gatherer initially crawls the index.</span></span> <span data-ttu-id="b177d-274">После первоначального сканирования источники, предназначенные только для уведомлений, никогда не будут выполнять полное сканирование, пока не произойдет сбой, например [Журнал изменений USN](/windows/desktop/FileIO/change-journals) .</span><span class="sxs-lookup"><span data-stu-id="b177d-274">After the initial crawl, the notification-only sources will never do a full crawl again unless there is a failure, such as the [USN Change Journal](/windows/desktop/FileIO/change-journals) rolling over.</span></span> <span data-ttu-id="b177d-275">Источники с поддержкой уведомлений выполняют добавочное сканирование при запуске индексатора, но затем прослушивают уведомления во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b177d-275">Notification-enabled sources do an incremental crawl when the indexer is started, but then listen to notifications while running.</span></span> <span data-ttu-id="b177d-276">NTFS и Microsoft Outlook являются только уведомлениями.</span><span class="sxs-lookup"><span data-stu-id="b177d-276">NTFS and Microsoft Outlook are notification only.</span></span> <span data-ttu-id="b177d-277">В Internet Explorer и FAT включены уведомления.</span><span class="sxs-lookup"><span data-stu-id="b177d-277">Internet Explorer and FAT are notification enabled.</span></span>

## <a name="notes-to-implementers"></a><span data-ttu-id="b177d-278">Примечания для тех, кто реализует этот метод</span><span class="sxs-lookup"><span data-stu-id="b177d-278">Notes to Implementers</span></span>

<span data-ttu-id="b177d-279">Качество данных в индексе и эффективность процесса индексирования зависят практически от реализации фильтра и обработчика свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-279">The quality of the data in the index and the efficiency of the indexing process depend largely on your filter and property handler implementation.</span></span> <span data-ttu-id="b177d-280">Поскольку фильтр вызывается каждый раз, когда URL-адрес определяет формат файла, процесс индексирования может сильно замедлиться, если фильтр неэффективен.</span><span class="sxs-lookup"><span data-stu-id="b177d-280">Because the filter is called every time a URL identifies your file format, the indexing process can slow down dramatically if your filter is inefficient.</span></span> <span data-ttu-id="b177d-281">Если обработчик свойств неправильно сопоставляет все свойства файла со свойствами системы или неправильно выдает эти свойства, то данные в индексе будут неправильными, а в дальнейшем поиск этих свойств вернет неверные результаты.</span><span class="sxs-lookup"><span data-stu-id="b177d-281">If your property handler doesn't correctly map all file properties to system properties or doesn't correctly emit these properties, the data in the index will be incorrect and later searches for those properties will return incorrect results.</span></span> <span data-ttu-id="b177d-282">В случае сбоя фильтра или обработчика свойств индексатор не сможет индексировать данные.</span><span class="sxs-lookup"><span data-stu-id="b177d-282">If your filter or property handler fails, the indexer won't be able to index data.</span></span>

<span data-ttu-id="b177d-283">Приложения и процессы, отличные от поиска Windows, основываются на обработчиках протоколов, фильтрах и обработчиках свойств.</span><span class="sxs-lookup"><span data-stu-id="b177d-283">Applications and processes other than Windows Search rely on protocol handlers, filters, and property handlers.</span></span> <span data-ttu-id="b177d-284">Ваши реализации могут повлиять на приложения так, как вы, возможно, не планируете.</span><span class="sxs-lookup"><span data-stu-id="b177d-284">Your implementations can affect those applications in ways you may not expect.</span></span> <span data-ttu-id="b177d-285">[Руководство по разработке Windows Search](-search-developers-guide-entry-page.md) содержит советы по выбору конструкции и тестированию каждого из этих компонентов.</span><span class="sxs-lookup"><span data-stu-id="b177d-285">The [Windows Search Development Guide](-search-developers-guide-entry-page.md) provides advice on design choices and on testing each of these components.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b177d-286">См. также</span><span class="sxs-lookup"><span data-stu-id="b177d-286">Related topics</span></span>

[<span data-ttu-id="b177d-287">Индексирование, запросы и уведомления в Windows Search</span><span class="sxs-lookup"><span data-stu-id="b177d-287">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)

[<span data-ttu-id="b177d-288">Что включено в индекс</span><span class="sxs-lookup"><span data-stu-id="b177d-288">What is Included in the Index</span></span>](-search-indexing-process-overview.md)

[<span data-ttu-id="b177d-289">Запрос процесса в Windows Search</span><span class="sxs-lookup"><span data-stu-id="b177d-289">Querying Process in Windows Search</span></span>](querying-process--windows-search-.md)

[<span data-ttu-id="b177d-290">Обработка уведомлений в Windows Search</span><span class="sxs-lookup"><span data-stu-id="b177d-290">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)

[<span data-ttu-id="b177d-291">Требования к форматированию URL-адресов</span><span class="sxs-lookup"><span data-stu-id="b177d-291">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
