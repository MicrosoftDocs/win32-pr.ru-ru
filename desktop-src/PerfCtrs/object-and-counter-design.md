---
description: Объект производительности — это сущность, для которой доступны данные о производительности.
ms.assetid: 97b9c9ec-e758-4928-b3fa-90d220bca5fb
title: Проектирование объектов и счетчиков
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9556882f5dd6c323697d9d41fa80727895550a5d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103998522"
---
# <a name="object-and-counter-design"></a><span data-ttu-id="cc13c-103">Проектирование объектов и счетчиков</span><span class="sxs-lookup"><span data-stu-id="cc13c-103">Object and Counter Design</span></span>

<span data-ttu-id="cc13c-104">Объект производительности — это сущность, для которой доступны данные о производительности.</span><span class="sxs-lookup"><span data-stu-id="cc13c-104">A performance object is an entity for which performance data is available.</span></span> <span data-ttu-id="cc13c-105">Счетчики производительности определяют тип данных, доступных для объекта производительности.</span><span class="sxs-lookup"><span data-stu-id="cc13c-105">Performance counters define the type of data that is available for a performance object.</span></span> <span data-ttu-id="cc13c-106">Приложение может предоставлять сведения для нескольких объектов производительности.</span><span class="sxs-lookup"><span data-stu-id="cc13c-106">An application can provide information for multiple performance objects.</span></span> <span data-ttu-id="cc13c-107">Объекты производительности могут содержать счетчики одного экземпляра или несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="cc13c-107">Performance objects can contain either single instance counters or multiple instance counters.</span></span> <span data-ttu-id="cc13c-108">Один объект экземпляра возвращает один набор значений счетчика.</span><span class="sxs-lookup"><span data-stu-id="cc13c-108">A single instance object returns a single set of counter values.</span></span>

<span data-ttu-id="cc13c-109">Объект с несколькими экземплярами возвращает экземпляр объекта для каждого вхождения объекта, который контролируется приложением.</span><span class="sxs-lookup"><span data-stu-id="cc13c-109">A multiple instance object returns an instance of the object for each occurrence of the object that the application controls.</span></span> <span data-ttu-id="cc13c-110">Например, приложение SCSI может определить объект Drive с двумя счетчиками, например считанные байты и записанные байты.</span><span class="sxs-lookup"><span data-stu-id="cc13c-110">For example, a SCSI application could define a drive object with two counters, such as Bytes Read and Bytes Written.</span></span> <span data-ttu-id="cc13c-111">Когда потребитель запрашивает объект, Библиотека DLL производительности возвращает экземпляр объекта для каждого диска, который управляется приложением.</span><span class="sxs-lookup"><span data-stu-id="cc13c-111">When the consumer queries the object, the performance DLL returns an instance of the object for each drive that the application controls.</span></span>

<span data-ttu-id="cc13c-112">После принятия решения о том, поддерживает ли объект один экземпляр или несколько экземпляров, необходимо выбрать тип счетчиков, которые должен предоставить объект.</span><span class="sxs-lookup"><span data-stu-id="cc13c-112">After deciding if your object supports a single instance or multiple instances, you need to decide on the type of counters that you want the object to provide.</span></span> <span data-ttu-id="cc13c-113">Например, можно указать значения счетчиков, которые отображаются как необработанные значения, как тарифы или как проценты.</span><span class="sxs-lookup"><span data-stu-id="cc13c-113">For example, you can provide counter values that are displayed as raw values, as rates, or as percentages.</span></span>

<span data-ttu-id="cc13c-114">Список стандартных типов счетчиков, которые следует выбрать, см. в разделе Типы счетчиков [комплекта средств для развертывания Windows Server 2003](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="cc13c-114">For a list of predefined counter types that you should choose from, see the Counter Types section of the [Windows Server 2003 Deployment Kit](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).</span></span> <span data-ttu-id="cc13c-115">В зависимости от типа счетчика можно просто предоставить необработанные данные или указать сведения о времени и частоте, а также дополнительные данные счетчика, используемые потребителем для вычисления воспроизводимого значения.</span><span class="sxs-lookup"><span data-stu-id="cc13c-115">Depending on the counter type, you may simply provide the raw data, or you may also have to provide time and frequency information and additional counter data used by the consumer to calculate a displayable value.</span></span>

<span data-ttu-id="cc13c-116">Метод, используемый для получения данных, может быть простым увеличением счетчика каждый раз, когда вызывается конкретная подкоманда в приложении, или может затрагивать длительные вычисления.</span><span class="sxs-lookup"><span data-stu-id="cc13c-116">The method you use to collect the data can be as simple as incrementing a counter each time a particular routine in the application is called, or it can involve time-consuming calculations.</span></span> <span data-ttu-id="cc13c-117">Счетчики и таймеры должны увеличиваться и никогда не очищаться.</span><span class="sxs-lookup"><span data-stu-id="cc13c-117">Counters and timers should increment and never be cleared.</span></span> <span data-ttu-id="cc13c-118">Счетчики могут переноситься в оболочку при условии, что они не переносятся дважды между выборке потребителем.</span><span class="sxs-lookup"><span data-stu-id="cc13c-118">Counters can wrap, as long as they do not wrap twice between being sampled by the consumer.</span></span> <span data-ttu-id="cc13c-119">Приложение может сохранять и хранить данные в течение обычного выполнения, если оно не влияет на его производительность.</span><span class="sxs-lookup"><span data-stu-id="cc13c-119">Your application can collect and store data during its normal execution, as long as it does not affect its performance.</span></span>

<span data-ttu-id="cc13c-120">Для некоторых типов данных может быть более эффективным или уместным выполнять накопление данных по запросу.</span><span class="sxs-lookup"><span data-stu-id="cc13c-120">For some types of data, it may be more efficient or appropriate to collect the data on demand.</span></span> <span data-ttu-id="cc13c-121">В этом случае библиотека DLL производительности должна взаимодействовать с приложением о том, что запрошены данные.</span><span class="sxs-lookup"><span data-stu-id="cc13c-121">In this situation, the performance DLL must communicate to the application that the data has been requested.</span></span> <span data-ttu-id="cc13c-122">Для данных, которые требуется собирать (с точки зрения загруженности процессора или использования памяти), рекомендуется собирать данные только в том случае, если потребитель запрашивает **дорогостоящие** данные.</span><span class="sxs-lookup"><span data-stu-id="cc13c-122">For data that is expensive to collect (in terms of processor time or memory usage), consider collecting data only when the consumer requests **Costly** data.</span></span> <span data-ttu-id="cc13c-123">Это позволяет потребителю выполнять регулярный запрос данных для всех счетчиков, которые не являются дорогостоящими.</span><span class="sxs-lookup"><span data-stu-id="cc13c-123">This allows a consumer to routinely request data for all counters that are not costly.</span></span> <span data-ttu-id="cc13c-124">Данные могут быть запрошены только при необходимости.</span><span class="sxs-lookup"><span data-stu-id="cc13c-124">The data can be requested only when needed.</span></span> <span data-ttu-id="cc13c-125">Средство производительности не выполняет накопления **дорогостоящих** данных.</span><span class="sxs-lookup"><span data-stu-id="cc13c-125">The Performance tool does not collect **Costly** data.</span></span>

 

 
