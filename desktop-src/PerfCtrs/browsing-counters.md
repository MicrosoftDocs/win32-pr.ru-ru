---
description: Чтобы отобразить диалоговое окно со списком объектов производительности и счетчиков, определенных на компьютере, вызовите функцию Пдхбровсекаунтерс.
ms.assetid: f2fac1d3-f643-43c9-a445-112015baecdd
title: Просмотр счетчиков
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cd4bae5ce5ae7a21ae247cf66515f7386b8d0265
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105663254"
---
# <a name="browsing-counters"></a><span data-ttu-id="5e580-103">Просмотр счетчиков</span><span class="sxs-lookup"><span data-stu-id="5e580-103">Browsing Counters</span></span>

<span data-ttu-id="5e580-104">Чтобы отобразить диалоговое окно со списком объектов производительности и счетчиков, определенных на компьютере, вызовите функцию [**пдхбровсекаунтерс**](/windows/desktop/api/Pdh/nf-pdh-pdhbrowsecountersa) .</span><span class="sxs-lookup"><span data-stu-id="5e580-104">To display a dialog box that lists the performance objects and counters defined on the computer, call the [**PdhBrowseCounters**](/windows/desktop/api/Pdh/nf-pdh-pdhbrowsecountersa) function.</span></span> <span data-ttu-id="5e580-105">Диалоговое окно позволяет пользователю просматривать и выбирать счетчики производительности.</span><span class="sxs-lookup"><span data-stu-id="5e580-105">The dialog box lets the user browse and select performance counters.</span></span> <span data-ttu-id="5e580-106">Для указания конфигурации диалогового окна используется структура [**\_ \_ \_ конфигурации PDH DLG**](/windows/win32/api/pdh/ns-pdh-pdh_browse_dlg_config_a) .</span><span class="sxs-lookup"><span data-stu-id="5e580-106">You use the [**PDH\_BROWSE\_DLG\_CONFIG**](/windows/win32/api/pdh/ns-pdh-pdh_browse_dlg_config_a) structure to specify the configuration of the dialog box.</span></span> <span data-ttu-id="5e580-107">Например, можно настроить диалоговое окно для возврата одного или нескольких выбранных элементов.</span><span class="sxs-lookup"><span data-stu-id="5e580-107">For example, you can configure the dialog to return one selection or multiple selections.</span></span>

<span data-ttu-id="5e580-108">На входе элемент **сзретурнпасбуффер** содержит объект производительности по умолчанию и счетчик, выбранный в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="5e580-108">On input, the **szReturnPathBuffer** member contains the default performance object and counter that is selected in the dialog box.</span></span> <span data-ttu-id="5e580-109">В выходных данных буфер содержит объект производительности и счетчик, выбранный пользователем.</span><span class="sxs-lookup"><span data-stu-id="5e580-109">On output, the buffer contains the performance object and counter that the user selected.</span></span> <span data-ttu-id="5e580-110">Можно также использовать элемент **пкаллбакк** , чтобы указать функцию обратного вызова для обработки имен счетчиков, возвращаемых этим диалоговым окном.</span><span class="sxs-lookup"><span data-stu-id="5e580-110">You can also use the **pCallBack** member to specify a callback function to process the counter names returned by the dialog box.</span></span>

<span data-ttu-id="5e580-111">Обратите внимание, что это диалоговое окно может возвращать \_ диалоговое окно PDH \_ , если **Бсинглекаунтерпердиалог** имеет **значение false** , и пользователь нажимает кнопку Закрыть, поэтому обработка ошибок должна учитывать это.</span><span class="sxs-lookup"><span data-stu-id="5e580-111">Note that this dialog box can return PDH\_DIALOG\_CANCELLED if **bSingleCounterPerDialog** is **FALSE** and the user clicks the Close button, so your error handling would have to account for this.</span></span>

<span data-ttu-id="5e580-112">Пример, в котором используется функция [**пдхбровсекаунтерс**](/windows/desktop/api/Pdh/nf-pdh-pdhbrowsecountersa) , см. в разделе [Просмотр счетчиков производительности](browsing-performance-counters.md).</span><span class="sxs-lookup"><span data-stu-id="5e580-112">For an example that uses the [**PdhBrowseCounters**](/windows/desktop/api/Pdh/nf-pdh-pdhbrowsecountersa) function, see [Browsing Performance Counters](browsing-performance-counters.md).</span></span>

<span data-ttu-id="5e580-113">Чтобы получить список объектов производительности на компьютере, можно также вызвать функцию [**пдхенумобжектс**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectsa) .</span><span class="sxs-lookup"><span data-stu-id="5e580-113">To retrieve a list of performance objects on the computer, you can also call the [**PdhEnumObjects**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectsa) function.</span></span> <span data-ttu-id="5e580-114">Чтобы получить список счетчиков и экземпляров для объекта производительности, вызовите функцию [**пдхенумобжектитемс**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa) .</span><span class="sxs-lookup"><span data-stu-id="5e580-114">To retrieve a list of counters and instances for a performance object, call the [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa) function.</span></span> <span data-ttu-id="5e580-115">Эти функции также можно использовать для обнаружения объектов производительности и счетчиков, содержащихся в файле журнала.</span><span class="sxs-lookup"><span data-stu-id="5e580-115">You can also use these functions to identify the performance objects and counters contained in a log file.</span></span> <span data-ttu-id="5e580-116">Повторные вызовы **пдхенумобжектитемс** будут возвращать один и тот же список счетчиков и экземпляров до тех пор, пока не будет вызван **пдхенумобжектс** для первого обновления списка объектов производительности.</span><span class="sxs-lookup"><span data-stu-id="5e580-116">Repeated calls to **PdhEnumObjectItems** will return the same list of counters and instances until you call **PdhEnumObjects** to refresh the list of performance objects first.</span></span> <span data-ttu-id="5e580-117">Пример перечисления объектов и счетчиков см. в разделе [Перечисление объектов процессов](enumerating-process-objects.md).</span><span class="sxs-lookup"><span data-stu-id="5e580-117">For an example that enumerates objects and counters, see [Enumerating Process Objects](enumerating-process-objects.md).</span></span>

## <a name="selecting-the-data-source"></a><span data-ttu-id="5e580-118">Выбор источника данных</span><span class="sxs-lookup"><span data-stu-id="5e580-118">Selecting the data source</span></span>

<span data-ttu-id="5e580-119">[**Пдхселектдатасаурце**](/windows/desktop/api/Pdh/nf-pdh-pdhselectdatasourcea) можно использовать в сочетании с [**пдхбровсекаунтерс**](/windows/desktop/api/Pdh/nf-pdh-pdhbrowsecountersa) , чтобы предложить пользователю указать, находится ли источник данных в режиме реального времени или из файла журнала, и, если это файл журнала, его имя.</span><span class="sxs-lookup"><span data-stu-id="5e580-119">You can use [**PdhSelectDataSource**](/windows/desktop/api/Pdh/nf-pdh-pdhselectdatasourcea) in conjunction with [**PdhBrowseCounters**](/windows/desktop/api/Pdh/nf-pdh-pdhbrowsecountersa) to prompt the user to select whether the data source is in real-time or from a log file, and, if it is a log file, its name.</span></span> <span data-ttu-id="5e580-120">Если вы не хотите, чтобы диалоговое окно источника данных отображалось, можно вызвать **пдхселектдатасаурце** , чтобы отобразить только каталог обозревателя файлов.</span><span class="sxs-lookup"><span data-stu-id="5e580-120">If you do not want the data source dialog to be displayed, you can call **PdhSelectDataSource** to display only the file browser catalog.</span></span> <span data-ttu-id="5e580-121">Для этого укажите \_ браузер файлов флагов \_ PDH \_ \_ только в качестве второго параметра вызова **пдхселектдатасаурце**.</span><span class="sxs-lookup"><span data-stu-id="5e580-121">To do this, specify PDH\_FLAGS\_FILE\_BROWSER\_ONLY as the second parameter of the call to **PdhSelectDataSource**.</span></span>

 

 



