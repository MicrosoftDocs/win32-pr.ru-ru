---
description: Формат данных, извлекаемых функцией процедура RegQueryValueEx, начинается с структуры заголовков фиксированной длины, \_ блока данных PERF \_ .
ms.assetid: a68fa617-834c-4ad9-b922-fac3a648ad75
title: Формат данных производительности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 88029634594843a50fd6010993eb6517dce831f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104561759"
---
# <a name="performance-data-format"></a><span data-ttu-id="4c279-103">Формат данных производительности</span><span class="sxs-lookup"><span data-stu-id="4c279-103">Performance Data Format</span></span>

<span data-ttu-id="4c279-104">Формат данных, извлекаемых функцией [**процедура RegQueryValueEx**](/windows/desktop/api/winreg/nf-winreg-regqueryvalueexa) , начинается с структуры заголовков фиксированной длины, [**\_ \_ блока данных PERF**](/windows/desktop/api/Winperf/ns-winperf-perf_data_block).</span><span class="sxs-lookup"><span data-stu-id="4c279-104">The format of the data retrieved by the [**RegQueryValueEx**](/windows/desktop/api/winreg/nf-winreg-regqueryvalueexa) function begins with a fixed-length header structure, [**PERF\_DATA\_BLOCK**](/windows/desktop/api/Winperf/ns-winperf-perf_data_block).</span></span> <span data-ttu-id="4c279-105">Структура **\_ \_ блока данных производительности** описывает систему и данные о производительности.</span><span class="sxs-lookup"><span data-stu-id="4c279-105">The **PERF\_DATA\_BLOCK** structure describes the system and the performance data.</span></span> <span data-ttu-id="4c279-106">За структурой **\_ \_ блока данных о производительности** следует переменное число элементов данных объектов с переменной длиной.</span><span class="sxs-lookup"><span data-stu-id="4c279-106">The **PERF\_DATA\_BLOCK** structure is followed by variable number of variable-length object data items.</span></span> <span data-ttu-id="4c279-107">Заголовок каждого элемента объекта содержит смещение следующего элемента объекта в списке.</span><span class="sxs-lookup"><span data-stu-id="4c279-107">The header of each object item contains the offset of the next object item in the list.</span></span> <span data-ttu-id="4c279-108">На следующей диаграмме показана базовая структура данных о производительности.</span><span class="sxs-lookup"><span data-stu-id="4c279-108">The following diagram shows the basic performance data structure.</span></span>

![Структура данных о производительности](images/perfdata.png)

<span data-ttu-id="4c279-110">Существует два формата для элементов данных объекта: один, который поддерживает несколько экземпляров, а другой, не поддерживающий несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="4c279-110">There are two formats for the object data items: one that supports multiple instances, and the other that does not support multiple instances.</span></span>

<span data-ttu-id="4c279-111">Каждый блок элемента данных объекта содержит структуру [**\_ \_ типа объекта PERF**](/windows/desktop/api/Winperf/ns-winperf-perf_object_type) , которая описывает данные производительности для объекта.</span><span class="sxs-lookup"><span data-stu-id="4c279-111">Each object data item block contains a [**PERF\_OBJECT\_TYPE**](/windows/desktop/api/Winperf/ns-winperf-perf_object_type) structure, which describes the performance data for the object.</span></span> <span data-ttu-id="4c279-112">За структурой **\_ \_ типа объекта PERF** следует список структур [**\_ \_ определения счетчиков производительности**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_definition) , по одному для каждого счетчика, определенного для объекта.</span><span class="sxs-lookup"><span data-stu-id="4c279-112">The **PERF\_OBJECT\_TYPE** structure is followed by a list of [**PERF\_COUNTER\_DEFINITION**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_definition) structures, one for each counter defined for the object.</span></span> <span data-ttu-id="4c279-113">Для объекта, имеющего только один экземпляр, список структур **\_ \_ определения счетчиков производительности** следует за одной структурой [**\_ \_ блока счетчика производительности**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_block) , за которой следуют данные счетчика.</span><span class="sxs-lookup"><span data-stu-id="4c279-113">For an object with only one instance, the list of **PERF\_COUNTER\_DEFINITION** structures is followed by a single [**PERF\_COUNTER\_BLOCK**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_block) structure, followed by the counter data.</span></span> <span data-ttu-id="4c279-114">Каждая **Структура \_ \_ определения счетчика производительности** содержит смещение от начала структуры **\_ \_ блока счетчика производительности** к соответствующим данным счетчика.</span><span class="sxs-lookup"><span data-stu-id="4c279-114">Each **PERF\_COUNTER\_DEFINITION** structure contains the offset from the start of the **PERF\_COUNTER\_BLOCK** structure to the corresponding counter data.</span></span> <span data-ttu-id="4c279-115">На следующей диаграмме показана структура объекта производительности, который не поддерживает несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="4c279-115">The following diagram shows the structure of a performance object that does not support multiple instances.</span></span>

![Структура объекта производительности, не поддерживающая несколько экземпляров](images/perfnoinst.png)

<span data-ttu-id="4c279-117">Для типа объекта, поддерживающего несколько экземпляров, за списком структур [**\_ \_ определения счетчиков производительности**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_definition) следует список блоков сведений об экземплярах (по одному для каждого экземпляра).</span><span class="sxs-lookup"><span data-stu-id="4c279-117">For an object type that supports multiple instances, the list of [**PERF\_COUNTER\_DEFINITION**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_definition) structures is followed by a list of instance information blocks (one for each instance).</span></span> <span data-ttu-id="4c279-118">Каждый блок сведений об экземпляре содержит структуру [**\_ \_ определения экземпляра производительности**](/windows/desktop/api/Winperf/ns-winperf-perf_instance_definition) , имя экземпляра и структуру [**\_ \_ блока счетчика производительности**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_block) .</span><span class="sxs-lookup"><span data-stu-id="4c279-118">Each instance information block contains a [**PERF\_INSTANCE\_DEFINITION**](/windows/desktop/api/Winperf/ns-winperf-perf_instance_definition) structure, the name of the instance, and a [**PERF\_COUNTER\_BLOCK**](/windows/desktop/api/Winperf/ns-winperf-perf_counter_block) structure.</span></span> <span data-ttu-id="4c279-119">На следующей диаграмме показана структура объекта производительности, который поддерживает два экземпляра.</span><span class="sxs-lookup"><span data-stu-id="4c279-119">The following diagram shows the structure of a performance object that supports two instances.</span></span>

![Структура объекта производительности, поддерживающего два экземпляра](images/perfinst.png)

<span data-ttu-id="4c279-121">Пример, в котором используются смещения, см. в разделе [Отображение имен объектов, экземпляров и счетчиков](displaying-object-instance-and-counter-names.md).</span><span class="sxs-lookup"><span data-stu-id="4c279-121">For an example that uses the offsets, see [Displaying Object, Instance, and Counter Names](displaying-object-instance-and-counter-names.md).</span></span>

 

 
