---
title: object - атрибут
description: Атрибут \ объект \ Interface определяет COM-интерфейс.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- атрибут объекта MIDL
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103790902"
---
# <a name="object-attribute"></a><span data-ttu-id="e86e2-104">object - атрибут</span><span class="sxs-lookup"><span data-stu-id="e86e2-104">object attribute</span></span>

<span data-ttu-id="e86e2-105">Атрибут интерфейса **\[ объекта \]** определяет COM-интерфейс.</span><span class="sxs-lookup"><span data-stu-id="e86e2-105">The **\[object\]** interface attribute identifies a COM interface.</span></span> <span data-ttu-id="e86e2-106">(Список атрибутов интерфейса, не включающий атрибут **\[ Object \]** , указывает на интерфейс DCE RPC.)</span><span class="sxs-lookup"><span data-stu-id="e86e2-106">(An interface attribute list that does not include the **\[object\]** attribute indicates a DCE RPC interface.)</span></span>

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a><span data-ttu-id="e86e2-107">Параметры</span><span class="sxs-lookup"><span data-stu-id="e86e2-107">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="e86e2-108">*Строка UUID*</span><span class="sxs-lookup"><span data-stu-id="e86e2-108">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="e86e2-109">Строка UUID, созданная служебной программой uuidgen.</span><span class="sxs-lookup"><span data-stu-id="e86e2-109">A UUID string generated by the Uuidgen utility.</span></span> <span data-ttu-id="e86e2-110">Строку UUID можно заключить в кавычки.</span><span class="sxs-lookup"><span data-stu-id="e86e2-110">You can enclose the UUID string in quotes.</span></span>

</dd> <dt>

<span data-ttu-id="e86e2-111">*Interface-список атрибутов*</span><span class="sxs-lookup"><span data-stu-id="e86e2-111">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="e86e2-112">Другие атрибуты, применяемые к интерфейсу в целом.</span><span class="sxs-lookup"><span data-stu-id="e86e2-112">Other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="e86e2-113">*имя интерфейса*</span><span class="sxs-lookup"><span data-stu-id="e86e2-113">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="e86e2-114">Имя интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e86e2-114">The name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="e86e2-115">*базовый интерфейс*</span><span class="sxs-lookup"><span data-stu-id="e86e2-115">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="e86e2-116">COM-интерфейс, от которого наследует этот интерфейс.</span><span class="sxs-lookup"><span data-stu-id="e86e2-116">The COM interface from which this interface derives.</span></span> <span data-ttu-id="e86e2-117">Базовый интерфейс должен быть [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)или другим COM-интерфейсом, который прямо или косвенно является производным от **IUnknown** или **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="e86e2-117">The base interface must be [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), or another COM interface that derives, either directly or indirectly, from **IUnknown** or **IDispatch**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="e86e2-118">Комментарии</span><span class="sxs-lookup"><span data-stu-id="e86e2-118">Remarks</span></span>

<span data-ttu-id="e86e2-119">Список атрибутов интерфейса для COM-интерфейса должен включать **\[** атрибут [**UUID**](uuid.md) **\]** , но не может включать **\[** атрибут [**Version**](version.md) **\]** .</span><span class="sxs-lookup"><span data-stu-id="e86e2-119">An interface attribute list for a COM interface must include the **\[**[**uuid**](uuid.md)**\]** attribute, but it cannot include the **\[**[**version**](version.md)**\]** attribute.</span></span>

<span data-ttu-id="e86e2-120">По умолчанию компиляция COM-интерфейса с помощью компилятора MIDL создает файлы, необходимые для создания прокси-библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="e86e2-120">By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL.</span></span> <span data-ttu-id="e86e2-121">Эта библиотека DLL содержит код для поддержки использования пользовательского COM-интерфейса как клиентскими приложениями, так и серверами объектов.</span><span class="sxs-lookup"><span data-stu-id="e86e2-121">This DLL contains the code to support the use of the custom COM interface by both client applications and object servers.</span></span> <span data-ttu-id="e86e2-122">Однако если в списке атрибутов интерфейса для COM-интерфейса указан **\[** [**локальный**](local.md) **\]** атрибут, компилятор MIDL создает только файл заголовка интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e86e2-122">However, if the interface attribute list for a COM interface specifies the **\[**[**local**](local.md)**\]** attribute, the MIDL compiler generates only the interface header file.</span></span>

<span data-ttu-id="e86e2-123">Компилятор MIDL автоматически создает тип данных интерфейса для COM-интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e86e2-123">The MIDL compiler automatically generates an interface data type for a COM interface.</span></span> <span data-ttu-id="e86e2-124">В качестве альтернативы можно использовать [**typedef**](typedef.md) с ключевым словом [**Interface**](interface.md) , чтобы явно определить тип данных интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e86e2-124">As an alternative, you can use [**typedef**](typedef.md) with the [**interface**](interface.md) keyword to explicitly define an interface data type.</span></span> <span data-ttu-id="e86e2-125">Затем спецификация интерфейса может использовать тип данных интерфейса в параметрах функции и возвращаемых значениях, элементах [**struct**](struct.md) и [**Union**](union.md) и других объявлениях типов.</span><span class="sxs-lookup"><span data-stu-id="e86e2-125">The interface specification can then use the interface data type in function parameters and return values, [**struct**](struct.md) and [**union**](union.md) members, and other type declarations.</span></span> <span data-ttu-id="e86e2-126">В следующем примере показано использование автоматически созданного типа данных [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) :</span><span class="sxs-lookup"><span data-stu-id="e86e2-126">The following example illustrates the use of an automatically generated [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) data type:</span></span>

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

<span data-ttu-id="e86e2-127">В интерфейсе COM все функции-члены интерфейса считаются виртуальными функциями.</span><span class="sxs-lookup"><span data-stu-id="e86e2-127">In a COM interface, all the interface member functions are assumed to be virtual functions.</span></span> <span data-ttu-id="e86e2-128">Виртуальная функция имеет **неявный** указатель в качестве первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e86e2-128">A virtual function has an implicit **this** pointer as the first parameter.</span></span> <span data-ttu-id="e86e2-129">Виртуальная таблица функций содержит запись для каждой функции члена интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e86e2-129">The virtual function table contains an entry for each interface member function.</span></span>

<span data-ttu-id="e86e2-130">Функции- **\[** члены [**нелокальных**](local.md) **\]** объектов интерфейса должны иметь возвращаемое значение HRESULT или SCODE.</span><span class="sxs-lookup"><span data-stu-id="e86e2-130">Non-**\[**[**local**](local.md)**\]** object interface member functions must have a return value of HRESULT or SCODE.</span></span> <span data-ttu-id="e86e2-131">(Обратите внимание, что более ранние версии MIDL позволяли функциям-членам возвращать [**значение void**](void.md).</span><span class="sxs-lookup"><span data-stu-id="e86e2-131">(Note that earlier versions of MIDL allowed member functions to return [**void**](void.md).</span></span> <span data-ttu-id="e86e2-132">Однако начиная с MIDL версии 3,0, возврат **void** приводит к ошибке компилятора.) Наличие возвращаемого значения HRESULT или SCODE означает, что если во время удаленного вызова создается исключение, созданные прокси-серверы перехватывают исключение и возвращают код исключения в возвращаемое значение.</span><span class="sxs-lookup"><span data-stu-id="e86e2-132">However, beginning with MIDL version 3.0, returning **void** generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value.</span></span> <span data-ttu-id="e86e2-133">Если приложение может позволить пропускать ошибки, возникающие во время удаленного вызова процедуры, можно указать HRESULT в качестве возвращаемого типа без проверки возвращаемого значения после вызова.</span><span class="sxs-lookup"><span data-stu-id="e86e2-133">If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</span></span>

<span data-ttu-id="e86e2-134">При перекомпиляции старого приложения изменение возвращаемых типов может привести к проблемам обратной совместимости, когда сервер отправляет недавно введенный результат клиенту.</span><span class="sxs-lookup"><span data-stu-id="e86e2-134">If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client.</span></span> <span data-ttu-id="e86e2-135">В качестве альтернативы изменению типа возвращаемого значения можно пометить функцию, возвращающую [**void**](void.md) , с помощью **\[** [**\_ вызова**](call-as.md) **\]** атрибута, делая его локальной функцией.</span><span class="sxs-lookup"><span data-stu-id="e86e2-135">As an alternative to changing the return type, you can label the function that returns [**void**](void.md) with the **\[**[**call\_as**](call-as.md)**\]** attribute, thus making it a local function.</span></span> <span data-ttu-id="e86e2-136">Затем определите связанную удаленную функцию с теми же параметрами, но с типом возвращаемого значения HRESULT.</span><span class="sxs-lookup"><span data-stu-id="e86e2-136">Then define a related remote function with the same parameters but with the return type of HRESULT.</span></span> <span data-ttu-id="e86e2-137">При необходимости локальная функция может вызвать исключение на основе этого значения HRESULT.</span><span class="sxs-lookup"><span data-stu-id="e86e2-137">The local function can raise an exception based on that HRESULT value, if necessary.</span></span>

<span data-ttu-id="e86e2-138">Атрибут **\[ Object \]** недоступен при компиляции с помощью параметра компилятора MIDL [**/ОСФ**](-osf.md) .</span><span class="sxs-lookup"><span data-stu-id="e86e2-138">The **\[object\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

## <a name="examples"></a><span data-ttu-id="e86e2-139">Примеры</span><span class="sxs-lookup"><span data-stu-id="e86e2-139">Examples</span></span>

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="e86e2-140">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="e86e2-140">See also</span></span>

<dl> <dt>

[<span data-ttu-id="e86e2-141">**вызвать \_ как**</span><span class="sxs-lookup"><span data-stu-id="e86e2-141">**call\_as**</span></span>](call-as.md)
</dt> <dt>

[<span data-ttu-id="e86e2-142">Файл определения интерфейса (IDL)</span><span class="sxs-lookup"><span data-stu-id="e86e2-142">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="e86e2-143">**IID \_ —**</span><span class="sxs-lookup"><span data-stu-id="e86e2-143">**iid\_is**</span></span>](iid-is.md)
</dt> <dt>

[<span data-ttu-id="e86e2-144">**взаимодействия**</span><span class="sxs-lookup"><span data-stu-id="e86e2-144">**interface**</span></span>](interface.md)
</dt> <dt>

[<span data-ttu-id="e86e2-145">**Языковые**</span><span class="sxs-lookup"><span data-stu-id="e86e2-145">**local**</span></span>](local.md)
</dt> <dt>

[<span data-ttu-id="e86e2-146">**/осф**</span><span class="sxs-lookup"><span data-stu-id="e86e2-146">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="e86e2-147">**определение**</span><span class="sxs-lookup"><span data-stu-id="e86e2-147">**typedef**</span></span>](typedef.md)
</dt> <dt>

[<span data-ttu-id="e86e2-148">**UUID**</span><span class="sxs-lookup"><span data-stu-id="e86e2-148">**uuid**</span></span>](uuid.md)
</dt> <dt>

[<span data-ttu-id="e86e2-149">**Версия**</span><span class="sxs-lookup"><span data-stu-id="e86e2-149">**version**</span></span>](version.md)
</dt> </dl>

 

 