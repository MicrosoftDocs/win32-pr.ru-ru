---
title: COM, DCOM и библиотеки типов
description: Модель COM и распределенные объектные модели компонентов (DCOM) используют удаленные вызовы процедур (RPC) для обеспечения взаимодействия между объектами распределенных компонентов.
ms.assetid: 7bade397-676e-43be-82f4-b23cd768fd16
keywords:
- интерфейсы MIDL, COM
- интерфейсы MIDL, DCOM
- интерфейсы MIDL, библиотеки типов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4f0b21aad9f88f02d8029d478eead50f5501ecc
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103890572"
---
# <a name="com-dcom-and-type-libraries"></a><span data-ttu-id="0dfd2-106">COM, DCOM и библиотеки типов</span><span class="sxs-lookup"><span data-stu-id="0dfd2-106">COM, DCOM, and Type Libraries</span></span>

<span data-ttu-id="0dfd2-107">Модель COM и распределенные объектные модели компонентов (DCOM) используют удаленные вызовы процедур (RPC) для обеспечения взаимодействия между объектами распределенных компонентов.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-107">Component Object Model (COM) and Distributed Component Object Model (DCOM) use Remote Procedure Calls (RPC) to enable distributed component objects to communicate with each other.</span></span> <span data-ttu-id="0dfd2-108">Таким образом, интерфейс COM или DCOM определяет идентификатор и внешние характеристики COM-объекта.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-108">Thus, a COM or DCOM interface defines the identity and external characteristics of a COM object.</span></span> <span data-ttu-id="0dfd2-109">Он формирует средства, с помощью которых клиенты могут получить доступ к методам и данным объекта.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-109">It forms the means by which clients can gain access to an object's methods and data.</span></span> <span data-ttu-id="0dfd2-110">При использовании DCOM этот доступ возможен независимо от того, существуют ли объекты в одном и том же процессе, на разных процессах на одном компьютере или на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-110">With DCOM, this access is possible regardless of whether the objects exist in the same process, different processes on the same machine, or on different machines.</span></span> <span data-ttu-id="0dfd2-111">Как и в случае с клиентскими и серверными интерфейсами RPC, объект COM или DCOM может предоставлять свою функциональность различными способами и через несколько интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-111">As with RPC client/server interfaces, a COM or DCOM object can expose its functionality in a number of different ways and through multiple interfaces.</span></span>

## <a name="type-library"></a><span data-ttu-id="0dfd2-112">Библиотека типов</span><span class="sxs-lookup"><span data-stu-id="0dfd2-112">Type Library</span></span>

<span data-ttu-id="0dfd2-113">Библиотека типов (. tlb) — это двоичный файл, в котором хранятся сведения о свойствах и методах объектов COM или DCOM в форме, доступной другим приложениям во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-113">A type library (.tlb) is a binary file that stores information about a COM or DCOM object's properties and methods in a form that is accessible to other applications at runtime.</span></span> <span data-ttu-id="0dfd2-114">С помощью библиотеки типов приложение или браузер могут определить, какие интерфейсы поддерживаются объектом, и вызвать методы интерфейса объекта.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-114">Using a type library, an application or browser can determine which interfaces an object supports, and invoke an object's interface methods.</span></span> <span data-ttu-id="0dfd2-115">Это может произойти, даже если объекты и клиентские приложения были написаны на разных языках программирования.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-115">This can occur even if the object and client applications were written in different programming languages.</span></span> <span data-ttu-id="0dfd2-116">Среда выполнения COM/DCOM также может использовать библиотеку типов для обеспечения автоматического перекрестного апартамента, кросс-процесса и кросс-машинного маршалинга для интерфейсов, описанных в библиотеках типов.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-116">The COM/DCOM run-time environment can also use a type library to provide automatic cross-apartment, cross-process, and cross-machine marshaling for interfaces described in type libraries.</span></span>

## <a name="characteristics-of-an-interface"></a><span data-ttu-id="0dfd2-117">Характеристики интерфейса</span><span class="sxs-lookup"><span data-stu-id="0dfd2-117">Characteristics of an Interface</span></span>

<span data-ttu-id="0dfd2-118">Вы определяете характеристики интерфейса в файле определения интерфейса (IDL) и необязательном файле конфигурации приложения (ACF):</span><span class="sxs-lookup"><span data-stu-id="0dfd2-118">You define the characteristics of an interface in an interface definition (IDL) file and an optional application configuration file (ACF):</span></span>

-   <span data-ttu-id="0dfd2-119">IDL-файл определяет характеристики интерфейсов приложения в сети, то есть способ передачи данных между клиентом и сервером или между COM-объектами.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-119">The IDL file specifies the characteristics of the application's interfaces on the wire — that is, how data is to be transmitted between client and server, or between COM objects.</span></span>
-   <span data-ttu-id="0dfd2-120">В файле ACF указываются характеристики интерфейса, такие как дескрипторы привязки, которые относятся только к локальной операционной среде.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-120">The ACF file specifies interface characteristics, such as binding handles, that pertain only to the local operating environment.</span></span> <span data-ttu-id="0dfd2-121">В файле ACF также можно указать способ маршалирования и передачи сложной структуры данных в независимую от компьютера форму.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-121">The ACF file can also specify how to marshal and transmit a complex data structure in a machine-independent form.</span></span>

<span data-ttu-id="0dfd2-122">Дополнительные сведения о файлах IDL и ACF см. [в разделе файлы IDL и ACF](/windows/desktop/Rpc/the-idl-and-acf-files).</span><span class="sxs-lookup"><span data-stu-id="0dfd2-122">For more information on IDL and ACF files, see [The IDL and ACF Files](/windows/desktop/Rpc/the-idl-and-acf-files).</span></span>

<span data-ttu-id="0dfd2-123">Файлы IDL и ACF — это скрипты, написанные в язык MIDL (MIDL), которые являются реализацией Майкрософт и расширением языка определения интерфейса использование-DCE (IDL).</span><span class="sxs-lookup"><span data-stu-id="0dfd2-123">The IDL and ACF files are scripts written in Microsoft Interface Definition Language (MIDL), which is the Microsoft implementation and extension of the OSF-DCE interface definition language (IDL).</span></span> <span data-ttu-id="0dfd2-124">Расширения Майкрософт для языка IDL позволяют создавать COM-интерфейсы и библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-124">The Microsoft extensions to the IDL language enable you to create COM interfaces and type libraries.</span></span> <span data-ttu-id="0dfd2-125">Компилятор, Midl.exe, использует эти скрипты для создания заглушек языка C и файлов заголовков, а также файлов библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-125">The compiler, Midl.exe, uses these scripts to generate C-language stubs and header files as well as type library files.</span></span>

## <a name="the-midl-compiler"></a><span data-ttu-id="0dfd2-126">Компилятор MIDL</span><span class="sxs-lookup"><span data-stu-id="0dfd2-126">The MIDL Compiler</span></span>

<span data-ttu-id="0dfd2-127">В зависимости от содержимого IDL-файла компилятор MIDL создаст любой из следующих файлов.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-127">Depending on the contents of your IDL file, the MIDL compiler will generate any of the following files.</span></span>

<span data-ttu-id="0dfd2-128">Прокси-сервер языка C/файл заглушки, файл идентификатора интерфейса, файл данных DLL и связанный файл заголовка для пользовательского COM-интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-128">A C-language proxy/stub file, an interface identifier file, a DLL data file, and a related header file for a custom COM interface.</span></span> <span data-ttu-id="0dfd2-129">Компилятор MIDL создает эти файлы при обнаружении атрибута объекта в списке атрибутов интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-129">The MIDL compiler generates these files when it encounters the object attribute in an interface attribute list.</span></span> <span data-ttu-id="0dfd2-130">Более подробные сведения об этих файлах см. в разделе [файлы, созданные для COM-интерфейса](files-generated-for-a-com-interface.md).</span><span class="sxs-lookup"><span data-stu-id="0dfd2-130">For more detailed information on these files, see [Files Generated for a COM Interface](files-generated-for-a-com-interface.md).</span></span>

<span data-ttu-id="0dfd2-131">Файл скомпилированной библиотеки типов (. tlb) и связанный файл заголовка.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-131">A compiled type library (.tlb) file and related header file.</span></span> <span data-ttu-id="0dfd2-132">MIDL создает эти файлы при обнаружении в IDL-файле оператора [**библиотеки**](library.md) .</span><span class="sxs-lookup"><span data-stu-id="0dfd2-132">MIDL generates these files when it encounters a [**library**](library.md) statement in the IDL file.</span></span> <span data-ttu-id="0dfd2-133">Общие сведения о библиотеках типов см. в разделе [содержимое библиотеки типов](/previous-versions/windows/desktop/automat/contents-of-a-type-library)в справочнике программиста по автоматизации.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-133">For general information about type libraries, see [Contents of a Type Library](/previous-versions/windows/desktop/automat/contents-of-a-type-library), in the Automation Programmer's Reference.</span></span>

<span data-ttu-id="0dfd2-134">C/C++ — файлы заглушки клиента и сервера языка и связанный файл заголовка для интерфейса RPC.</span><span class="sxs-lookup"><span data-stu-id="0dfd2-134">C/C++-language client and server stub files and related header file for an RPC interface.</span></span> <span data-ttu-id="0dfd2-135">Эти файлы создаются при наличии в IDL-файле интерфейсов, которые не имеют атрибута [**Object**](object.md) .</span><span class="sxs-lookup"><span data-stu-id="0dfd2-135">These files are generated when there are interfaces in the IDL file that do not have the [**object**](object.md) attribute.</span></span> <span data-ttu-id="0dfd2-136">Общие сведения о файлах заглушек и заголовков см. в разделе [Общая процедура сборки](/windows/desktop/Rpc/general-build-procedure).</span><span class="sxs-lookup"><span data-stu-id="0dfd2-136">For an overview of the stub and header files, see [General Build Procedure](/windows/desktop/Rpc/general-build-procedure).</span></span> <span data-ttu-id="0dfd2-137">Более подробные сведения см. в разделе [файлы, созданные для интерфейса RPC](files-generated-for-an-rpc-interface.md).</span><span class="sxs-lookup"><span data-stu-id="0dfd2-137">For more detailed information, see [Files Generated for an RPC Interface](files-generated-for-an-rpc-interface.md).</span></span>

 

 