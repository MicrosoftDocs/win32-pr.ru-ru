---
title: Атрибуты массива и Sized-Pointer
description: MIDL предоставляет широкий набор функций для передачи массивов данных и указателей на данные. Эти атрибуты можно использовать для задания характеристик массивов и нескольких уровней указателей.
ms.assetid: 482be83f-eb09-40a0-8dd6-a0cbf5dc4485
keywords:
- IDL MIDL, атрибуты, массив и указатель размера
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b0f9ba435d5c413ea152c2bc9b492486ccc1be94
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103890541"
---
# <a name="array-and-sized-pointer-attributes"></a><span data-ttu-id="a6579-105">Атрибуты массива и Sized-Pointer</span><span class="sxs-lookup"><span data-stu-id="a6579-105">Array and Sized-Pointer Attributes</span></span>

<span data-ttu-id="a6579-106">MIDL предоставляет широкий набор функций для передачи массивов данных и указателей на данные.</span><span class="sxs-lookup"><span data-stu-id="a6579-106">MIDL provides a rich set of features for passing arrays of data and pointers to data.</span></span> <span data-ttu-id="a6579-107">Эти атрибуты можно использовать для задания характеристик массивов и нескольких уровней указателей.</span><span class="sxs-lookup"><span data-stu-id="a6579-107">You can use these attributes to specify characteristics of arrays and multiple levels of pointers.</span></span>



| <span data-ttu-id="a6579-108">attribute</span><span class="sxs-lookup"><span data-stu-id="a6579-108">Attribute</span></span>                       | <span data-ttu-id="a6579-109">Использование</span><span class="sxs-lookup"><span data-stu-id="a6579-109">Usage</span></span>                                                                                                                                                                                                |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a6579-110">**размер \_ равен**</span><span class="sxs-lookup"><span data-stu-id="a6579-110">**size\_is**</span></span>](size-is.md)     | <span data-ttu-id="a6579-111">Задает объем памяти, выделяемый для указателей по размеру, размеров указателей на размеры указателей, а также единичных или многомерных массивов.</span><span class="sxs-lookup"><span data-stu-id="a6579-111">Specifies the amount of memory to be allocated for sized pointers, sized pointers to sized pointers, and single- or multidimensional arrays.</span></span>                                                         |
| [<span data-ttu-id="a6579-112">**Максимальное \_ число**</span><span class="sxs-lookup"><span data-stu-id="a6579-112">**max\_is**</span></span>](max-is.md)       | <span data-ttu-id="a6579-113">Максимальное значение для индекса массива.</span><span class="sxs-lookup"><span data-stu-id="a6579-113">The maximum value for an array index.</span></span>                                                                                                                                                                |
| [<span data-ttu-id="a6579-114">**Длина \_ равна**</span><span class="sxs-lookup"><span data-stu-id="a6579-114">**length\_is**</span></span>](length-is.md) | <span data-ttu-id="a6579-115">Число передаваемых элементов массива.</span><span class="sxs-lookup"><span data-stu-id="a6579-115">The number of array elements to be transmitted.</span></span>                                                                                                                                                      |
| [<span data-ttu-id="a6579-116">**первый \_ —**</span><span class="sxs-lookup"><span data-stu-id="a6579-116">**first\_is**</span></span>](first-is.md)   | <span data-ttu-id="a6579-117">Индекс первого передаваемого элемента массива.</span><span class="sxs-lookup"><span data-stu-id="a6579-117">The index of the first array element to be transmitted.</span></span>                                                                                                                                              |
| [<span data-ttu-id="a6579-118">**Последний \_ —**</span><span class="sxs-lookup"><span data-stu-id="a6579-118">**last\_is**</span></span>](last-is.md)     | <span data-ttu-id="a6579-119">Возвращает индекс последнего передаваемого элемента массива.</span><span class="sxs-lookup"><span data-stu-id="a6579-119">Gives the index of the last array element to be transmitted.</span></span>                                                                                                                                         |
| [<span data-ttu-id="a6579-120">**Строка**</span><span class="sxs-lookup"><span data-stu-id="a6579-120">**string**</span></span>](string.md)        | <span data-ttu-id="a6579-121">Указывает, что одномерный массив [**char**](char-idl.md), [**WCHAR \_ t**](wchar-t.md), [**Byte**](byte.md) (или эквивалентный) или указатель на такой массив должен обрабатываться как строка.</span><span class="sxs-lookup"><span data-stu-id="a6579-121">Indicates that the one-dimensional [**char**](char-idl.md), [**wchar\_t**](wchar-t.md), [**byte**](byte.md) (or equivalent) array, or the pointer to such an array, is to be handled as a string.</span></span> |
| [<span data-ttu-id="a6579-122">**разнообраз**</span><span class="sxs-lookup"><span data-stu-id="a6579-122">**range**</span></span>](range.md)          | <span data-ttu-id="a6579-123">Задает диапазон допустимых значений для аргументов или полей, значения которых задаются во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="a6579-123">Specifies a range of allowable values for arguments or fields whose values are set at runtime.</span></span>                                                                                                       |



 

<span data-ttu-id="a6579-124">MIDL поддерживает три вида указателей: ссылочные указатели, уникальные указатели и полные указатели.</span><span class="sxs-lookup"><span data-stu-id="a6579-124">MIDL supports three kinds of pointers: reference pointers, unique pointers, and full pointers.</span></span> <span data-ttu-id="a6579-125">Эти указатели указываются атрибутами указателей [**ref**](ref.md), [**UNIQUE**](unique.md)и [**ptr**](ptr.md).</span><span class="sxs-lookup"><span data-stu-id="a6579-125">These pointers are specified by the pointer attributes [**ref**](ref.md), [**unique**](unique.md), and [**ptr**](ptr.md).</span></span>

<span data-ttu-id="a6579-126">Атрибут указателя может быть применен как атрибут типа. в качестве атрибута поля, который применяется к члену структуры, члену объединения или параметру; или в качестве атрибута функции, который применяется к возвращаемому типу функции.</span><span class="sxs-lookup"><span data-stu-id="a6579-126">A pointer attribute can be applied as a type attribute; as a field attribute that applies to a structure member, union member, or parameter; or as a function attribute that applies to the function return type.</span></span> <span data-ttu-id="a6579-127">Атрибут указателя также может присутствовать с ключевым словом [**указателя \_ по умолчанию**](pointer-default.md) .</span><span class="sxs-lookup"><span data-stu-id="a6579-127">The pointer attribute can also appear with the [**pointer\_default**](pointer-default.md) keyword.</span></span>

<span data-ttu-id="a6579-128">Чтобы разрешить параметру указателя изменять значение во время удаленной функции, необходимо предоставить другой уровень косвенного обращения, предоставив несколько деклараторов указателя.</span><span class="sxs-lookup"><span data-stu-id="a6579-128">To allow a pointer parameter to change in value during a remote function, you must provide another level of indirection by supplying multiple pointer declarators.</span></span> <span data-ttu-id="a6579-129">Явный атрибут указателя, примененный к параметру, влияет только на декларатор самого правого указателя для параметра.</span><span class="sxs-lookup"><span data-stu-id="a6579-129">The explicit pointer attribute applied to the parameter affects only the rightmost pointer declarator for the parameter.</span></span> <span data-ttu-id="a6579-130">При наличии нескольких деклараторов указателя в объявлении параметра другой декларатор по умолчанию имеет атрибут указателя, заданный атрибутом [**указателя \_ по умолчанию**](pointer-default.md) .</span><span class="sxs-lookup"><span data-stu-id="a6579-130">When there are multiple pointer declarators in a parameter declaration, the other declarators default to the pointer attribute specified by the [**pointer\_default**](pointer-default.md) attribute.</span></span> <span data-ttu-id="a6579-131">Чтобы применить различные атрибуты указателя к нескольким деклараторам указателя, необходимо определить промежуточные типы, указывающие явные атрибуты указателя.</span><span class="sxs-lookup"><span data-stu-id="a6579-131">To apply different pointer attributes to multiple pointer declarators, you must define intermediate types that specify the explicit pointer attributes.</span></span>

## <a name="default-pointer-attribute-values"></a><span data-ttu-id="a6579-132">Значения Pointer-Attribute по умолчанию</span><span class="sxs-lookup"><span data-stu-id="a6579-132">Default Pointer-Attribute Values</span></span>

<span data-ttu-id="a6579-133">Если атрибут указателя не связан с указателем, который является параметром, то предполагается, что указатель является указателем [**ref**](ref.md) .</span><span class="sxs-lookup"><span data-stu-id="a6579-133">When no pointer attribute is associated with a pointer that is a parameter, the pointer is assumed to be a [**ref**](ref.md) pointer.</span></span>

<span data-ttu-id="a6579-134">Если атрибут указателя не связан с указателем, который является членом структуры или объединения, компилятор MIDL назначает атрибуты указателя с помощью следующих правил приоритета (1 — наивысший):</span><span class="sxs-lookup"><span data-stu-id="a6579-134">When no pointer attribute is associated with a pointer that is a member of a structure or union, the MIDL compiler assigns pointer attributes using the following priority rules (1 is highest):</span></span>

1.  <span data-ttu-id="a6579-135">Атрибуты, явно примененные к типу указателя</span><span class="sxs-lookup"><span data-stu-id="a6579-135">Attributes explicitly applied to the pointer type</span></span>
2.  <span data-ttu-id="a6579-136">Атрибуты, явно примененные к параметру или члену указателя</span><span class="sxs-lookup"><span data-stu-id="a6579-136">Attributes explicitly applied to the pointer parameter or member</span></span>
3.  <span data-ttu-id="a6579-137">Атрибут [**указателя \_ по умолчанию**](pointer-default.md) в IDL-файле, определяющем тип</span><span class="sxs-lookup"><span data-stu-id="a6579-137">The [**pointer\_default**](pointer-default.md) attribute in the IDL file that defines the type</span></span>
4.  <span data-ttu-id="a6579-138">Атрибут [**указателя \_ по умолчанию**](pointer-default.md) в IDL-файле, который импортирует тип</span><span class="sxs-lookup"><span data-stu-id="a6579-138">The [**pointer\_default**](pointer-default.md) attribute in the IDL file that imports the type</span></span>
5.  <span data-ttu-id="a6579-139">[**ptr**](ptr.md) (режим использование); [**уникальный**](unique.md) (режим Microsoft RPC по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="a6579-139">[**ptr**](ptr.md) (osf mode); [**unique**](unique.md) (Microsoft RPC default mode)</span></span>

<span data-ttu-id="a6579-140">Когда IDL-файл компилируется в режиме по умолчанию, импортированные файлы могут наследовать атрибуты указателя от импорта файлов.</span><span class="sxs-lookup"><span data-stu-id="a6579-140">When the IDL file is compiled in default mode, imported files can inherit pointer attributes from importing files.</span></span> <span data-ttu-id="a6579-141">Эта функция недоступна при компиляции с параметром/[**Использование**](-osf.md) .</span><span class="sxs-lookup"><span data-stu-id="a6579-141">This feature is not available when you compile using the /[**osf**](-osf.md) switch.</span></span> <span data-ttu-id="a6579-142">Дополнительные сведения см. в разделе [**Import**](import.md).</span><span class="sxs-lookup"><span data-stu-id="a6579-142">For more information, see [**import**](import.md).</span></span>

## <a name="function-return-types"></a><span data-ttu-id="a6579-143">Типы возвращаемых функцией значения</span><span class="sxs-lookup"><span data-stu-id="a6579-143">Function Return Types</span></span>

<span data-ttu-id="a6579-144">Указатель, возвращаемый функцией, должен быть [**уникальным**](unique.md) указателем или полным указателем.</span><span class="sxs-lookup"><span data-stu-id="a6579-144">A pointer returned by a function must be a [**unique**](unique.md) pointer or a full pointer.</span></span> <span data-ttu-id="a6579-145">Компилятор MIDL сообщает об ошибке, если результат функции является указателем ссылки, явно или по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a6579-145">The MIDL compiler reports an error if a function result is a reference pointer, either explicitly or by default.</span></span> <span data-ttu-id="a6579-146">Возвращаемый указатель всегда указывает на новое хранилище.</span><span class="sxs-lookup"><span data-stu-id="a6579-146">The returned pointer always indicates new storage.</span></span>

<span data-ttu-id="a6579-147">Функции, возвращающие значение указателя, могут указывать атрибут указателя в качестве атрибута функции.</span><span class="sxs-lookup"><span data-stu-id="a6579-147">Functions that return a pointer value can specify a pointer attribute as a function attribute.</span></span> <span data-ttu-id="a6579-148">Если отсутствует атрибут указателя, то указатель на результат функции использует значение, указанное в качестве атрибута [**\_ по умолчанию указателя**](pointer-default.md) .</span><span class="sxs-lookup"><span data-stu-id="a6579-148">If a pointer attribute is not present, the function-result pointer uses the value provided as the [**pointer\_default**](pointer-default.md) attribute.</span></span>

## <a name="pointer-attributes-in-type-definitions"></a><span data-ttu-id="a6579-149">Атрибуты указателя в определениях типов</span><span class="sxs-lookup"><span data-stu-id="a6579-149">Pointer Attributes in Type Definitions</span></span>

<span data-ttu-id="a6579-150">При указании атрибута указателя на верхнем уровне оператора [**typedef**](typedef.md) указанный атрибут применяется к декларатору указателя, как и ожидалось.</span><span class="sxs-lookup"><span data-stu-id="a6579-150">When you specify a pointer attribute at the top level of a [**typedef**](typedef.md) statement, the specified attribute is applied to the pointer declarator, as expected.</span></span> <span data-ttu-id="a6579-151">Если атрибут указателя не указан, деклараторы указателей на верхнем уровне оператора typedef наследуют тип атрибута указателя при использовании.</span><span class="sxs-lookup"><span data-stu-id="a6579-151">When no pointer attribute is specified, pointer declarators at the top level of a typedef statement inherit the pointer attribute type when used.</span></span>

<span data-ttu-id="a6579-152">Устройство DCE IDL не позволяет явно применять один и тот же атрибут указателя дважды, например в объявлении [**typedef**](typedef.md) и в списке атрибутов параметра.</span><span class="sxs-lookup"><span data-stu-id="a6579-152">DCE IDL does not allow the same pointer attribute to be explicitly applied twice—for example, in both the [**typedef**](typedef.md) declaration and the parameter attribute list.</span></span> <span data-ttu-id="a6579-153">При использовании режима по умолчанию (расширений Майкрософт) компилятора MIDL это ограничение неограниченно.</span><span class="sxs-lookup"><span data-stu-id="a6579-153">When you use the default (Microsoft extensions) mode of the MIDL compiler, this constraint is relaxed.</span></span>

<span data-ttu-id="a6579-154">Обсуждение использования массивов и указателей MIDL в удаленных вызовах процедур см. в разделе [массивы и указатели](/windows/desktop/Rpc/arrays-and-pointers).</span><span class="sxs-lookup"><span data-stu-id="a6579-154">For a discussion of using MIDL arrays and pointers in remote procedure calls, see [Arrays and Pointers](/windows/desktop/Rpc/arrays-and-pointers).</span></span>

 

 