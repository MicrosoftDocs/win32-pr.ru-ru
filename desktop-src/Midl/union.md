---
title: Union, атрибут
description: Ключевое слово UNION отображается в функциях, связанных с размеченные объединения.
ms.assetid: 135a6581-e03e-4b90-9fd8-15690820dbd0
keywords:
- атрибут Union MIDL
topic_type:
- apiref
api_name:
- union
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: bc683472d67775c4a2900695246d5f9ca920ca32
ms.sourcegitcommit: 57758ecb246c84d65e6e0e4bd5570d9176fa39cd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2019
ms.locfileid: "104532684"
---
# <a name="union-attribute"></a><span data-ttu-id="4a9b9-104">Union, атрибут</span><span class="sxs-lookup"><span data-stu-id="4a9b9-104">union attribute</span></span>

<span data-ttu-id="4a9b9-105">Ключевое слово **Union** отображается в функциях, связанных с размеченные объединения.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-105">The **union** keyword appears in functions that relate to discriminated unions.</span></span>

``` syntax
/* Encapsulated union*/
typedef [[ [type-attribute-list] ]] union [[ struct-name ]] switch (switch-type switch-name) [[ union-name ]] 
{
  C-style-case-list 
  [[ [ field-attribute-list <> ] ]] type-specifier <> declarator-list <>;

        ...
}

/* Non-encapsulated union*/
typedef [switch_type(switch-type) [[ , type-attr-list ]] ] union [[ tag ]] 
{ 
    [ case ( limited-expr-list) ]
  [[ [ field-attribute-list ] ]] type-specifier declarator-list;
  [[ [ default ]
  [[ [ field-attribute-list ] ]] type-specifier declarator-list;
  ]]
}
```

## <a name="parameters"></a><span data-ttu-id="4a9b9-106">Параметры</span><span class="sxs-lookup"><span data-stu-id="4a9b9-106">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="4a9b9-107">*Type-Attribute-List*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-107">*type-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-108">Указывает ноль или более атрибутов, применимых к типу объединения.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-108">Specifies zero or more attributes that apply to the union type.</span></span> <span data-ttu-id="4a9b9-109">К допустимым атрибутам типа относятся **\[** [**Handle**](handle.md) **\]** , **\[** " [**передать \_ как**](transmit-as.md) **\]** ", атрибут указателя " **\[** [**уникальный**](unique.md)" **\]** или "PTR", а также **\[** [](ptr.md) **\]** **\[** [**\_ маркер контекста**](context-handle.md) атрибутов использования **\]** и **\[** [**игнорировать**](ignore.md) **\]** .</span><span class="sxs-lookup"><span data-stu-id="4a9b9-109">Valid type attributes include **\[**[**handle**](handle.md)**\]**, **\[**[**transmit\_as**](transmit-as.md)**\]**; the pointer attribute **\[**[**unique**](unique.md)**\]**, or **\[**[**ptr**](ptr.md)**\]**; and the usage attributes **\[**[**context\_handle**](context-handle.md)**\]** and **\[**[**ignore**](ignore.md)**\]**.</span></span> <span data-ttu-id="4a9b9-110">Инкапсулированные объединения могут также иметь **\[** [](ref.md) **\]** атрибут типа ref Pointer.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-110">Encapsulated unions can also have the **\[**[**ref**](ref.md)**\]** pointer type attribute.</span></span> <span data-ttu-id="4a9b9-111">Несколько атрибутов разделяются запятыми.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-111">Separate multiple attributes with commas.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-112">*имя структуры*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-112">*struct-name*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-113">Задает необязательный тег, который именует структуру, созданную компилятором MIDL.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-113">Specifies an optional tag that names the structure generated by the MIDL compiler.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-114">*Тип переключателя*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-114">*switch-type*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-115">Задает тип [**int**](int.md), [**char**](char-idl.md), [**enum**](enum.md) или идентификатор, который разрешается в один из этих типов.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-115">Specifies an [**int**](int.md), [**char**](char-idl.md), [**enum**](enum.md) type, or an identifier that resolves to one of these types.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-116">*имя коммутатора*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-116">*switch-name*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-117">Задает имя переменной *типа Switch-Type* , которая выступает в качестве discriminant объединения.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-117">Specifies the name of the variable of type *switch-type* that acts as the union discriminant.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-118">*имя объединения*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-118">*union-name*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-119">Задает необязательный идентификатор, который именует объединение в структуре, созданной компилятором MIDL, который содержит Union и discriminant.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-119">Specifies an optional identifier that names the union in the structure, generated by the MIDL compiler, that contains the union and the discriminant.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-120">*C-style-Case-список*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-120">*C-style-case-list*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-121">Список "**case** *const-expr* :"</span><span class="sxs-lookup"><span data-stu-id="4a9b9-121">List of "**case** *const-expr* :"</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-122">*список ограниченных выражений*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-122">*limited-expression-list*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-123">Указывает одно или несколько выражений языка C.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-123">Specifies one or more C-language expressions.</span></span> <span data-ttu-id="4a9b9-124">Компилятор MIDL поддерживает условные выражения, логические выражения, реляционные выражения и арифметические выражения.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-124">The MIDL compiler supports conditional expressions, logical expressions, relational expressions, and arithmetic expressions.</span></span> <span data-ttu-id="4a9b9-125">MIDL не разрешает вызовы функций в выражениях и не поддерживает операторы инкремента и декремента.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-125">MIDL does not allow function invocations in expressions and does not allow increment and decrement operators.</span></span> <span data-ttu-id="4a9b9-126">Отдельные выражения в списке должны быть разделены запятыми.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-126">Individual expressions in the list should be separated by a comma.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-127">*Список атрибутов Field*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-127">*field-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-128">Указывает ноль или более атрибутов полей, применимых к элементу объединения.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-128">Specifies zero or more field attributes that apply to the union member.</span></span> <span data-ttu-id="4a9b9-129">К допустимым атрибутам полей относятся: **\[** [**First \_**](first-is.md)—, **\]** **\[** [**Last \_ —**](last-is.md), **\]** **\[** [**length \_ —**](length-is.md) **\]** , **\[** [**Max \_ —**](max-is.md) **\]** , **\[** [**size \_ —**](size-is.md), **\]** String атрибуты использования **\[** [](string.md) **\]** , **\[** [**Ignore**](ignore.md) **\]** и **\[** [**Контекстный \_ маркер**](context-handle.md) **\]** ; атрибут указателя **\[** [**UNIQUE**](unique.md) **\]** или **\[** [**ptr**](ptr.md), **\]** а для членов, которые являются неинкапсулированными, **\[** [**\_ Тип переключателя**](switch-type.md)атрибута объединения **\]** .</span><span class="sxs-lookup"><span data-stu-id="4a9b9-129">Valid field attributes include **\[**[**first\_is**](first-is.md)**\]**, **\[**[**last\_is**](last-is.md)**\]**, **\[**[**length\_is**](length-is.md)**\]**, **\[**[**max\_is**](max-is.md)**\]**, **\[**[**size\_is**](size-is.md)**\]**; the usage attributes **\[**[**string**](string.md)**\]**, **\[**[**ignore**](ignore.md)**\]**, and **\[**[**context\_handle**](context-handle.md)**\]**; the pointer attribute **\[**[**unique**](unique.md)**\]** or **\[**[**ptr**](ptr.md)**\]**; and, for members that are nonencapsulated unions, the union attribute **\[**[**switch\_type**](switch-type.md)**\]**.</span></span> <span data-ttu-id="4a9b9-130">Неинкапсулированные объединения могут также использовать **\[** [](ref.md) **\]** атрибут поля REF Pointer.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-130">Nonencapsulated unions can also use the **\[**[**ref**](ref.md)**\]** pointer field attribute.</span></span> <span data-ttu-id="4a9b9-131">Несколько атрибутов полей разделяются запятыми.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-131">Separate multiple field attributes with commas.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-132">*Описатель типа*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-132">*type-specifier*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-133">Задает [базовый тип](midl-base-types.md), [**структуру**](struct.md), **объединение**, тип [**перечисления**](enum.md) или идентификатор типа.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-133">Specifies a [base type](midl-base-types.md), [**struct**](struct.md), **union**, [**enum**](enum.md) type, or type identifier.</span></span> <span data-ttu-id="4a9b9-134">Дополнительная спецификация хранилища может предшествовать *спецификатору типа*.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-134">An optional storage specification can precede *type-specifier*.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-135">*декларатор-список*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-135">*declarator-list*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-136">Один или несколько стандартных деклараторов C, таких как идентификаторы, деклараторы указателей и деклараторы массивов.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-136">One or more standard C declarators, such as identifiers, pointer declarators, and array declarators.</span></span> <span data-ttu-id="4a9b9-137">(Деклараторы функций и объявления битовых полей не допускаются в объединениях, передаваемых в удаленных вызовах процедур.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-137">(Function declarators and bit-field declarations are not allowed in unions that are transmitted in remote procedure calls.</span></span> <span data-ttu-id="4a9b9-138">За исключением случаев, когда используется параметр компилятора MIDL [**/ОСФ**](-osf.md), эти деклараторы допускаются в объединениях, которые не передаются.) Несколько деклараторов разделяются запятыми.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-138">Except when you use the MIDL compiler switch [**/osf**](-osf.md), these declarators are allowed in unions that are not transmitted.) Separate multiple declarators with commas.</span></span>

</dd> <dt>

<span data-ttu-id="4a9b9-139">*тегами*</span><span class="sxs-lookup"><span data-stu-id="4a9b9-139">*tag*</span></span> 
</dt> <dd>

<span data-ttu-id="4a9b9-140">Указывает необязательный тег.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-140">Specifies an optional tag.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="4a9b9-141">Комментарии</span><span class="sxs-lookup"><span data-stu-id="4a9b9-141">Remarks</span></span>

<span data-ttu-id="4a9b9-142">MIDL поддерживает два типа размеченных объединений: [инкапсулированные объединения](encapsulated-unions.md) и [неинкапсулированные объединения](nonencapsulated-unions.md).</span><span class="sxs-lookup"><span data-stu-id="4a9b9-142">MIDL supports two types of discriminated unions: [encapsulated unions](encapsulated-unions.md) and [nonencapsulated unions](nonencapsulated-unions.md).</span></span> <span data-ttu-id="4a9b9-143">Инкапсулированное объединение совместимо с предыдущими реализациями RPC (NCA версии 1).</span><span class="sxs-lookup"><span data-stu-id="4a9b9-143">The encapsulated union is compatible with previous implementations of RPC (NCA version 1).</span></span> <span data-ttu-id="4a9b9-144">Неинкапсулированное объединение исключает некоторые ограничения инкапсулированного объединения и предоставляет более наглядный discriminant, чем инкапсулированное объединение.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-144">The nonencapsulated union eliminates some of the restrictions of the encapsulated union and provides a more visible discriminant than the encapsulated union.</span></span>

<span data-ttu-id="4a9b9-145">Инкапсулированное объединение определяется ключевым словом [**switch**](switch.md) и отсутствием других ключевых слов, связанных с объединением.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-145">The encapsulated union is identified by the [**switch**](switch.md) keyword and the absence of other union-related keywords.</span></span>

<span data-ttu-id="4a9b9-146">Неинкапсулированное объединение, также называемое объединением, определяется наличием **\[** [**переключателя \_**](switch-is.md) **\]** и **\[** ключевыми словами [**\_ типа Switch**](switch-type.md) **\]** , которые определяют discriminant и его тип.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-146">The nonencapsulated union, also known as a union, is identified by the presence of the **\[**[**switch\_is**](switch-is.md)**\]** and **\[**[**switch\_type**](switch-type.md)**\]** keywords, which identify the discriminant and its type.</span></span>

<span data-ttu-id="4a9b9-147">При использовании **\[** [**во**](in.md) [**внешних**](out-idl.md) **\]** объединениях имейте в виду, что изменение значения переключателя Union во время вызова может привести к поведению удаленного вызова иначе, чем при локальном вызове.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-147">When you use **\[**[**in**](in.md), [**out**](out-idl.md)**\]** unions, be aware that changing the value of the union switch during the call can make the remote call behave differently from a local call.</span></span> <span data-ttu-id="4a9b9-148">При возврате заглушки копируют **\] выходной** параметр **\[ in** в память, которая уже имеется на клиенте.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-148">On return, the stubs copy the **\[in**, **out\]** parameter into memory that is already present on the client.</span></span> <span data-ttu-id="4a9b9-149">Когда удаленная процедура изменяет значение переключателя Union и, соответственно, изменяет размер объекта данных, заглушки могут перезаписывать допустимую память с **\[ выходным \]** значением.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-149">When the remote procedure modifies the value of the union switch and consequently changes the data object's size, the stubs can overwrite valid memory with the **\[out\]** value.</span></span> <span data-ttu-id="4a9b9-150">Когда параметр Union изменяет объект данных с базового типа на тип указателя, заглушки могут перезаписывать допустимую память при копировании указателя референт в место в памяти, указанное в параметре **\[ in \]** базового типа.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-150">When the union switch changes the data object from a base type to a pointer type, the stubs can overwrite valid memory when they copy the pointer referent into the memory location indicated by the **\[in\]** value of a base type.</span></span>

<span data-ttu-id="4a9b9-151">Чтобы обеспечить взаимодействие, форма объединений должна быть идентичной на разных платформах.</span><span class="sxs-lookup"><span data-stu-id="4a9b9-151">The shape of unions must be identical across platforms to ensure interconnectivity.</span></span>

## <a name="see-also"></a><span data-ttu-id="4a9b9-152">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="4a9b9-152">See also</span></span>

<dl> <dt>

[<span data-ttu-id="4a9b9-153">Инкапсулированные объединения</span><span class="sxs-lookup"><span data-stu-id="4a9b9-153">Encapsulated Unions</span></span>](encapsulated-unions.md)
</dt> <dt>

[<span data-ttu-id="4a9b9-154">Файл определения интерфейса (IDL)</span><span class="sxs-lookup"><span data-stu-id="4a9b9-154">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="4a9b9-155">**окне**</span><span class="sxs-lookup"><span data-stu-id="4a9b9-155">**in**</span></span>](in.md)
</dt> <dt>

[<span data-ttu-id="4a9b9-156">Неинкапсулированные объединения</span><span class="sxs-lookup"><span data-stu-id="4a9b9-156">Nonencapsulated Unions</span></span>](nonencapsulated-unions.md)
</dt> <dt>

[<span data-ttu-id="4a9b9-157">**заполняет**</span><span class="sxs-lookup"><span data-stu-id="4a9b9-157">**out**</span></span>](out-idl.md)
</dt> <dt>

[<span data-ttu-id="4a9b9-158">**параметр \_ имеет**</span><span class="sxs-lookup"><span data-stu-id="4a9b9-158">**switch\_is**</span></span>](switch-is.md)
</dt> <dt>

[<span data-ttu-id="4a9b9-159">**Тип коммутатора \_**</span><span class="sxs-lookup"><span data-stu-id="4a9b9-159">**switch\_type**</span></span>](switch-type.md)
</dt> </dl>

 

 




