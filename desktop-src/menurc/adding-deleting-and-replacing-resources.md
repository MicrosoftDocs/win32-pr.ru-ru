---
title: Добавление, удаление и замена ресурсов
description: В этом разделе описывается, как добавлять, удалять или заменять ресурсы.
ms.assetid: 15b1086e-e3a2-460a-828b-17db5105309f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 941c12a1531e422efe44cbd0b3deca9f89838698
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105661607"
---
# <a name="adding-deleting-and-replacing-resources"></a><span data-ttu-id="83a53-103">Добавление, удаление и замена ресурсов</span><span class="sxs-lookup"><span data-stu-id="83a53-103">Adding, Deleting, and Replacing Resources</span></span>

<span data-ttu-id="83a53-104">Приложения часто могут добавлять, удалять или заменять ресурсы в исполняемых файлах.</span><span class="sxs-lookup"><span data-stu-id="83a53-104">Applications must frequently add, delete, or replace resources in executable files.</span></span> <span data-ttu-id="83a53-105">Для выполнения этих задач можно использовать два метода.</span><span class="sxs-lookup"><span data-stu-id="83a53-105">Two methods can be used to accomplish these tasks.</span></span> <span data-ttu-id="83a53-106">Первый — это изменение файла определения ресурса, повторная компиляция ресурсов и добавление перекомпилированных ресурсов в исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="83a53-106">The first is to edit the resource-definition file, recompile the resources, and add the recompiled resources to the application's executable file.</span></span> <span data-ttu-id="83a53-107">Второй способ заключается в копировании данных ресурсов непосредственно в исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="83a53-107">The second method is to copy the resource data directly into the application's executable file.</span></span>

<span data-ttu-id="83a53-108">Например, для локализации приложения на английском языке для использования в Норвегии может потребоваться заменить диалоговое окно на английском языке на использование норвежского языка.</span><span class="sxs-lookup"><span data-stu-id="83a53-108">For example, to localize an English-language application for use in Norway, it may be necessary to replace the English dialog box with one using Norwegian.</span></span> <span data-ttu-id="83a53-109">Разработчик создает соответствующее диалоговое окно, используя редактор диалоговых окон или записывая шаблон в файл определения ресурса.</span><span class="sxs-lookup"><span data-stu-id="83a53-109">A developer creates an appropriate dialog box by using a dialog box editor or by writing a template in the resource-definition file.</span></span> <span data-ttu-id="83a53-110">Затем разработчик перекомпилирует ресурсы и добавляет новые ресурсы в исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="83a53-110">The developer then recompiles the resources and adds the new resources to the application's executable file.</span></span>

<span data-ttu-id="83a53-111">Однако если соответствующее диалоговое окно существует в двоичной форме, разработчик может скопировать данные непосредственно в исполняемый файл, используя следующие функции.</span><span class="sxs-lookup"><span data-stu-id="83a53-111">If an appropriate dialog box exists in binary form, however, the developer can copy the data directly to the executable file being localized by using the following functions.</span></span> <span data-ttu-id="83a53-112">Функция [**бегинупдатересаурце**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea) создает обработчик обновления для исполняемого файла, ресурсы которого необходимо изменить.</span><span class="sxs-lookup"><span data-stu-id="83a53-112">The [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea) function creates an update handle to the executable file whose resources are to be changed.</span></span> <span data-ttu-id="83a53-113">Функция [**—**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) использует этот обработчик для добавления, удаления или замены ресурса в исполняемом файле.</span><span class="sxs-lookup"><span data-stu-id="83a53-113">The [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) function uses this handle to add, delete, or replace a resource in the executable file.</span></span> <span data-ttu-id="83a53-114">Функция [**ендупдатересаурце**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) закрывает маркер.</span><span class="sxs-lookup"><span data-stu-id="83a53-114">The [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) function closes the handle.</span></span>

<span data-ttu-id="83a53-115">После создания обработчика обновления для исполняемого файла с помощью [**бегинупдатересаурце**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea)приложение может многократно использовать [**—**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) для внесения изменений в данные ресурса.</span><span class="sxs-lookup"><span data-stu-id="83a53-115">After an update handle to an executable file is created by [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea), an application can use [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) repeatedly to make changes to the resource data.</span></span> <span data-ttu-id="83a53-116">Каждый вызов **—** участвует во внутреннем списке дополнений, удалений и замен, но не записывает данные в исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="83a53-116">Each call to **UpdateResource** contributes to an internal list of additions, deletions, and replacements but does not actually write the data to the executable file.</span></span> <span data-ttu-id="83a53-117">Непосредственно перед закрытием обработчика обновления [**ендупдатересаурце**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) записывает накопленные изменения в исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="83a53-117">Immediately before closing the update handle, [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) writes the accumulated changes to the executable file.</span></span>

<span data-ttu-id="83a53-118">Иногда приложение должно копировать ресурсы из другого файла.</span><span class="sxs-lookup"><span data-stu-id="83a53-118">Sometimes, an application must copy resources from another file.</span></span> <span data-ttu-id="83a53-119">[Обновление ресурсов](using-resources.md) показывает пример получения данных ресурса и их размера из файла.</span><span class="sxs-lookup"><span data-stu-id="83a53-119">[Updating Resources](using-resources.md) shows an example of obtaining the resource data and its size from a file.</span></span>

 

 




