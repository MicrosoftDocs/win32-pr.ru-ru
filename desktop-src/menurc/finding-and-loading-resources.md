---
title: Поиск и загрузка ресурсов
description: В этом разделе описывается загрузка ресурса в память.
ms.assetid: 9e56cfdd-b365-4433-a507-a30220b4a92d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca9590927cad28772a6b4a5b761d74c9ebf101a6
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104487576"
---
# <a name="finding-and-loading-resources"></a><span data-ttu-id="202e4-103">Поиск и загрузка ресурсов</span><span class="sxs-lookup"><span data-stu-id="202e4-103">Finding and Loading Resources</span></span>

<span data-ttu-id="202e4-104">Перед использованием ресурса приложение должно загрузить его в память.</span><span class="sxs-lookup"><span data-stu-id="202e4-104">Before using a resource, an application must load it into memory.</span></span> <span data-ttu-id="202e4-105">Функции [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) и [**финдресаурцеекс**](/windows/desktop/api/Winbase/nf-winbase-findresourceexa) находят ресурс в модуле и возвращают маркер в двоичные данные ресурса.</span><span class="sxs-lookup"><span data-stu-id="202e4-105">The [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**FindResourceEx**](/windows/desktop/api/Winbase/nf-winbase-findresourceexa) functions find a resource in a module and return a handle to the binary resource data.</span></span> <span data-ttu-id="202e4-106">**FindResource** находит ресурс по типу и имени.</span><span class="sxs-lookup"><span data-stu-id="202e4-106">**FindResource** locates a resource by type and name.</span></span> <span data-ttu-id="202e4-107">**Финдресаурцеекс** находит ресурс по типу, имени и языку.</span><span class="sxs-lookup"><span data-stu-id="202e4-107">**FindResourceEx** locates the resource by type, name, and language.</span></span> <span data-ttu-id="202e4-108">Сведения о **FindResource** в этом разделе также применимы к **финдресаурцеекс**.</span><span class="sxs-lookup"><span data-stu-id="202e4-108">Information about **FindResource** in this topic also applies to **FindResourceEx**.</span></span>

<span data-ttu-id="202e4-109">Функция [**лоадресаурце**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) использует для загрузки ресурса в память маркер ресурса, возвращенный [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) .</span><span class="sxs-lookup"><span data-stu-id="202e4-109">The [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) function uses the resource handle returned by [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) to load the resource into memory.</span></span> <span data-ttu-id="202e4-110">После того как приложение загрузит ресурс с помощью **лоадресаурце**, система выгрузит связанную память только в том случае, если все ссылки на его модуль освобождаются через [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span><span class="sxs-lookup"><span data-stu-id="202e4-110">After an application loads a resource by using **LoadResource**, the system will unload the associated memory only when all references to its module are freed through [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span></span> <span data-ttu-id="202e4-111">Приложения, которым требуется многократный доступ к одному или нескольким ресурсам в рамках определенного модуля, могут повлечь за собой снижение производительности из-за того, что сопоставление памяти выполняется в повторяющихся вызовах [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) и **FreeLibrary** .</span><span class="sxs-lookup"><span data-stu-id="202e4-111">Applications which need to repeatedly access the same or many resources within a particular module may incur performance penalties due to the memory mapping taking place in repeated [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) and **FreeLibrary** calls.</span></span> <span data-ttu-id="202e4-112">Приложения должны хранить один обработчик модуля, пока ресурсы больше не нужны, а затем вызываю **FreeLibrary**.</span><span class="sxs-lookup"><span data-stu-id="202e4-112">Applications should store a single module handle until resources are no longer needed, and then call **FreeLibrary**.</span></span> <span data-ttu-id="202e4-113">После выгрузки модуля из памяти дескрипторы ресурсов становятся недействительными.</span><span class="sxs-lookup"><span data-stu-id="202e4-113">After a module is unloaded from memory, resource handles become invalid.</span></span>

<span data-ttu-id="202e4-114">Приложение может использовать [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) и [**лоадресаурце**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) для поиска и загрузки ресурсов любого типа, но эти функции следует использовать только в одной из следующих ситуаций:</span><span class="sxs-lookup"><span data-stu-id="202e4-114">An application can use [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) to find and load any type of resource, but these functions should be used only in one of these situations:</span></span>

-   <span data-ttu-id="202e4-115">Если приложение не может получить доступ к ресурсу с помощью существующей функции для конкретного ресурса.</span><span class="sxs-lookup"><span data-stu-id="202e4-115">When the application cannot access the resource by using an existing resource-specific function.</span></span>
-   <span data-ttu-id="202e4-116">Когда приложение должно получить доступ к ресурсу как к двоичным данным для последующих вызовов функций.</span><span class="sxs-lookup"><span data-stu-id="202e4-116">When the application must access the resource as binary data for subsequent function calls.</span></span>

<span data-ttu-id="202e4-117">По возможности для поиска и загрузки ресурсов в одном вызове приложению следует использовать одну из следующих функций для конкретного ресурса:</span><span class="sxs-lookup"><span data-stu-id="202e4-117">Whenever possible, an application should instead use one of the following resource-specific functions to find and load resources in one call:</span></span>



| <span data-ttu-id="202e4-118">Функция</span><span class="sxs-lookup"><span data-stu-id="202e4-118">Function</span></span>                                     | <span data-ttu-id="202e4-119">Действие</span><span class="sxs-lookup"><span data-stu-id="202e4-119">Action</span></span>                                   | <span data-ttu-id="202e4-120">Удаление ресурса</span><span class="sxs-lookup"><span data-stu-id="202e4-120">To remove resource</span></span>                                                                                               |
|----------------------------------------------|------------------------------------------|------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="202e4-121">**FormatMessage**</span><span class="sxs-lookup"><span data-stu-id="202e4-121">**FormatMessage**</span></span>](/windows/desktop/api/winbase/nf-winbase-formatmessage)      | <span data-ttu-id="202e4-122">Загружает и форматирует запись в таблице сообщений.</span><span class="sxs-lookup"><span data-stu-id="202e4-122">Loads and formats a message-table entry.</span></span> | <span data-ttu-id="202e4-123">Никаких действий не требуется.</span><span class="sxs-lookup"><span data-stu-id="202e4-123">No action needed.</span></span>                                                                                                |
| [<span data-ttu-id="202e4-124">**лоадакцелераторс**</span><span class="sxs-lookup"><span data-stu-id="202e4-124">**LoadAccelerators**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) | <span data-ttu-id="202e4-125">Загружает таблицу сочетаний клавиш.</span><span class="sxs-lookup"><span data-stu-id="202e4-125">Loads an accelerator table.</span></span>              | [<span data-ttu-id="202e4-126">**дестройакцелератортабле**</span><span class="sxs-lookup"><span data-stu-id="202e4-126">**DestroyAcceleratorTable**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyacceleratortable)                                                       |
| [<span data-ttu-id="202e4-127">**лоадбитмап**</span><span class="sxs-lookup"><span data-stu-id="202e4-127">**LoadBitmap**</span></span>](/windows/desktop/api/winuser/nf-winuser-loadbitmapa)             | <span data-ttu-id="202e4-128">Загружает ресурс точечного рисунка.</span><span class="sxs-lookup"><span data-stu-id="202e4-128">Loads a bitmap resource.</span></span>                 | [<span data-ttu-id="202e4-129">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="202e4-129">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                                                                             |
| [<span data-ttu-id="202e4-130">**лоадкурсор**</span><span class="sxs-lookup"><span data-stu-id="202e4-130">**LoadCursor**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadcursora)             | <span data-ttu-id="202e4-131">Загружает ресурс курсора.</span><span class="sxs-lookup"><span data-stu-id="202e4-131">Loads a cursor resource.</span></span>                 | [<span data-ttu-id="202e4-132">**дестройкурсор**</span><span class="sxs-lookup"><span data-stu-id="202e4-132">**DestroyCursor**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroycursor)                                                                           |
| [<span data-ttu-id="202e4-133">**лоадикон**</span><span class="sxs-lookup"><span data-stu-id="202e4-133">**LoadIcon**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadicona)                 | <span data-ttu-id="202e4-134">Загружает ресурс значка.</span><span class="sxs-lookup"><span data-stu-id="202e4-134">Loads an icon resource.</span></span>                  | [<span data-ttu-id="202e4-135">**дестройикон**</span><span class="sxs-lookup"><span data-stu-id="202e4-135">**DestroyIcon**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyicon)                                                                               |
| [<span data-ttu-id="202e4-136">**лоадимаже**</span><span class="sxs-lookup"><span data-stu-id="202e4-136">**LoadImage**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadimagea)               | <span data-ttu-id="202e4-137">Загружает значок, курсор или точечный рисунок.</span><span class="sxs-lookup"><span data-stu-id="202e4-137">Loads an icon, cursor, or bitmap.</span></span>        | <span data-ttu-id="202e4-138">[**Дестройикон**](/windows/desktop/api/Winuser/nf-winuser-destroyicon), [**дестройкурсор**](/windows/desktop/api/Winuser/nf-winuser-destroycursor), [**DeleteObject**](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)</span><span class="sxs-lookup"><span data-stu-id="202e4-138">[**DestroyIcon**](/windows/desktop/api/Winuser/nf-winuser-destroyicon), [**DestroyCursor**](/windows/desktop/api/Winuser/nf-winuser-destroycursor), [**DeleteObject**](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)</span></span> |
| [<span data-ttu-id="202e4-139">**лоадмену**</span><span class="sxs-lookup"><span data-stu-id="202e4-139">**LoadMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadmenua)                 | <span data-ttu-id="202e4-140">Загружает ресурс меню.</span><span class="sxs-lookup"><span data-stu-id="202e4-140">Loads a menu resource.</span></span>                   | [<span data-ttu-id="202e4-141">**дестроймену**</span><span class="sxs-lookup"><span data-stu-id="202e4-141">**DestroyMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroymenu)                                                                               |
| [<span data-ttu-id="202e4-142">**лоадстринг**</span><span class="sxs-lookup"><span data-stu-id="202e4-142">**LoadString**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadstringa)             | <span data-ttu-id="202e4-143">Загружает запись строки таблицы.</span><span class="sxs-lookup"><span data-stu-id="202e4-143">Loads a string-table entry.</span></span>              | <span data-ttu-id="202e4-144">Никаких действий не требуется.</span><span class="sxs-lookup"><span data-stu-id="202e4-144">No action needed.</span></span>                                                                                                |



 

<span data-ttu-id="202e4-145">Обратите внимание на функции выпуска, приведенные в таблице выше.</span><span class="sxs-lookup"><span data-stu-id="202e4-145">Note the release functions in the table above.</span></span> <span data-ttu-id="202e4-146">Перед завершением работы приложение должно освободить память, занятую таблицами ускорителя, точечными рисунками, курсорами, значками и меню, с помощью соответствующих функций.</span><span class="sxs-lookup"><span data-stu-id="202e4-146">Before terminating, an application should release the memory occupied by accelerator tables, bitmaps, cursors, icons, and menus by using the appropriate functions.</span></span>

<span data-ttu-id="202e4-147">Память, связанная с ресурсами, загруженными с помощью [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) и [**лоадресаурце**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) , будет освобождена после выгрузки модуля с помощью вызова [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span><span class="sxs-lookup"><span data-stu-id="202e4-147">Memory associated with resources loaded through [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) will be released once the module has been unloaded by a call to [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span></span> <span data-ttu-id="202e4-148">Все ресурсы, которые остаются Выгруженными при завершении работы приложения, будут автоматически освобождены системой.</span><span class="sxs-lookup"><span data-stu-id="202e4-148">Any resources which remain unloaded at application termination will be automatically released by the system.</span></span>

 

 