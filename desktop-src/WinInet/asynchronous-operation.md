---
title: Асинхронная операция
description: В асинхронном режиме приложение может выполнять любую функцию, которая включает значение контекста в качестве одного из параметров, и может продолжить выполнение других команд или функций, пока приложение ожидает завершения задачи.
ms.assetid: 4b8ade00-deb3-4d9f-9ceb-5ba3296c8c68
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9a7e1d0cf84aa92691e1d926d771ea809d31a171
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103792847"
---
# <a name="asynchronous-operation"></a><span data-ttu-id="7faee-103">Асинхронная операция</span><span class="sxs-lookup"><span data-stu-id="7faee-103">Asynchronous Operation</span></span>

<span data-ttu-id="7faee-104">Время, которое требуется приложению для доступа к Интернет-ресурсу, зависит от ряда факторов, таких как используемое подключение, сервера, на котором расположен ресурс, и от количества пользователей, пытающихся получить доступ к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="7faee-104">The amount of time it takes an application to access an Internet resource depends on a number of factors, such as the connection being used, the server on which the resource is located, and the number of users trying to access the resource.</span></span> <span data-ttu-id="7faee-105">Для приложений, которые загружают несколько ресурсов или обрабатывали несколько задач (включая одну или несколько загрузок), ожидание завершения каждого скачивания перед переходом к следующей задаче может оказаться чрезвычайно неэффективным.</span><span class="sxs-lookup"><span data-stu-id="7faee-105">For applications that download multiple resources or handle multiple tasks (including one or more downloads), waiting for each download to complete before moving on to the next task can be extremely inefficient.</span></span> <span data-ttu-id="7faee-106">Чтобы уменьшить количество времени, в течение которого приложение должно ожидать, многие функции WinINet могут работать асинхронно.</span><span class="sxs-lookup"><span data-stu-id="7faee-106">To decrease the amount of time an application has to wait, many of the WinINet functions can operate asynchronously.</span></span>

<span data-ttu-id="7faee-107">В асинхронном режиме приложение может выполнять любую функцию, которая включает значение контекста в качестве одного из параметров, и может продолжить выполнение других команд или функций, пока приложение ожидает завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="7faee-107">In asynchronous mode, an application can execute any function that includes a context value as one of its parameters and can continue to execute other commands or functions while the application waits for the function to complete its task.</span></span> <span data-ttu-id="7faee-108">Пока задача завершается, функция обратного вызова состояния, предоставляемая приложением, получает уведомления о ходе выполнения задачи и о ее завершении.</span><span class="sxs-lookup"><span data-stu-id="7faee-108">While the task is completing, a status callback function provided by the application is notified about the progress of the task and when it has completed.</span></span> <span data-ttu-id="7faee-109">В настоящее время функция обратного вызова состояния может вызывать другие функции или выполнять другие обязательные задачи, которые зависят от завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="7faee-109">At this time, the status callback function can call other functions or perform any other required tasks that were dependent on the task's completion.</span></span>

<span data-ttu-id="7faee-110">Нет афинити потока обратного вызова при асинхронном вызове WinINet: вызов может начаться из одного потока, но любой другой поток может получить обратный вызов.</span><span class="sxs-lookup"><span data-stu-id="7faee-110">There is no callback thread afinity when you call WinINet asynchronously: a call might start from one thread, but any other thread can receive the callback.</span></span>

-   [<span data-ttu-id="7faee-111">Преимущества</span><span class="sxs-lookup"><span data-stu-id="7faee-111">Benefits</span></span>](#benefits)
-   [<span data-ttu-id="7faee-112">Сценарии</span><span class="sxs-lookup"><span data-stu-id="7faee-112">Scenarios</span></span>](#scenarios)
-   [<span data-ttu-id="7faee-113">См. также</span><span class="sxs-lookup"><span data-stu-id="7faee-113">Related Topics</span></span>](#related-topics)

## <a name="benefits"></a><span data-ttu-id="7faee-114">Преимущества</span><span class="sxs-lookup"><span data-stu-id="7faee-114">Benefits</span></span>

<span data-ttu-id="7faee-115">Существует несколько преимуществ для работы в асинхронном режиме.</span><span class="sxs-lookup"><span data-stu-id="7faee-115">There are several benefits to operating asynchronously.</span></span> <span data-ttu-id="7faee-116">Пример:</span><span class="sxs-lookup"><span data-stu-id="7faee-116">For example:</span></span>

-   <span data-ttu-id="7faee-117">Одновременное скачивание нескольких Интернет ресурсов.</span><span class="sxs-lookup"><span data-stu-id="7faee-117">Downloading multiple Internet resources simultaneously.</span></span>

    <span data-ttu-id="7faee-118">Можно одновременно подключиться к нескольким интернет ресурсам и скачать их по мере их появления.</span><span class="sxs-lookup"><span data-stu-id="7faee-118">You can connect to multiple Internet resources at the same time and download them as they become available.</span></span>

-   <span data-ttu-id="7faee-119">Повышение производительности приложения.</span><span class="sxs-lookup"><span data-stu-id="7faee-119">Increasing performance of your application.</span></span>

    <span data-ttu-id="7faee-120">Приложение, использующее функции WinINet, асинхронно не ждет завершения запроса, поэтому приложение может выполнять другие задачи, не зависящие от запроса, тем самым улучшая общую производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="7faee-120">An application using the WinINet functions asynchronously does not have to wait until the request is completed, so the application is free to do other tasks that are not dependent on the request, thus improving the application's overall performance.</span></span>

-   <span data-ttu-id="7faee-121">Отслеживайте ход загрузки.</span><span class="sxs-lookup"><span data-stu-id="7faee-121">Monitor the progress of the download.</span></span>

    <span data-ttu-id="7faee-122">Функция обратного вызова состояния получает уведомления во время обработки запроса.</span><span class="sxs-lookup"><span data-stu-id="7faee-122">The status callback function receives notifications while it is processing a request.</span></span> <span data-ttu-id="7faee-123">При необходимости приложение может использовать сведения, предоставляемые этой функцией обратного вызова состояния, чтобы информировать пользователя о ходе выполнения операции или прерывании запросов, выполнение которых занимает слишком много времени.</span><span class="sxs-lookup"><span data-stu-id="7faee-123">If needed, your application can use the information provided by that status callback function to keep the user informed about the progress of the operation or to interrupt requests that are taking too long to complete.</span></span>

## <a name="scenarios"></a><span data-ttu-id="7faee-124">Сценарии</span><span class="sxs-lookup"><span data-stu-id="7faee-124">Scenarios</span></span>

<span data-ttu-id="7faee-125">Предположим, ваше приложение должно загрузить цены кофе из Довнфалл кофе & чай, а также четвертый сайт кофе и сравнить цены.</span><span class="sxs-lookup"><span data-stu-id="7faee-125">Let's say your application needs to download coffee prices from the Downfall Coffee & Tea and the Fourth Coffee sites and compare prices.</span></span> <span data-ttu-id="7faee-126">Четвертый сайт кофе обычно имеет более медленное время ответа, поэтому приложение должно сначала загрузить информацию из Довнфалл кофе & чай.</span><span class="sxs-lookup"><span data-stu-id="7faee-126">The Fourth Coffee site usually has a slower response time, so your application should download the information from Downfall Coffee & Tea first.</span></span>

<span data-ttu-id="7faee-127">Разрабатывается две версии приложения.</span><span class="sxs-lookup"><span data-stu-id="7faee-127">Two versions of the application are developed.</span></span> <span data-ttu-id="7faee-128">Один работает синхронно, сначала Скачайте цены с сайта Довнфалл кофе & чай, а затем цены с четвертого сайта кофе.</span><span class="sxs-lookup"><span data-stu-id="7faee-128">One works synchronously, first downloading the prices from the Downfall Coffee & Tea site and then the prices from the Fourth Coffee site.</span></span> <span data-ttu-id="7faee-129">Второй работает асинхронно, отправляя запросы на оба сайта и загружая цены, когда они станут доступны.</span><span class="sxs-lookup"><span data-stu-id="7faee-129">The second works asynchronously, sending requests to both sites and downloading the prices when they become available.</span></span>

<span data-ttu-id="7faee-130">В следующей таблице показано, что произойдет, если четвертый сайт кофе быстрее в определенный день.</span><span class="sxs-lookup"><span data-stu-id="7faee-130">The following table illustrates what would happen if the Fourth Coffee site was faster on a particular day.</span></span>



| <span data-ttu-id="7faee-131">Событие</span><span class="sxs-lookup"><span data-stu-id="7faee-131">Event</span></span>                                                            | <span data-ttu-id="7faee-132">Синхронная версия</span><span class="sxs-lookup"><span data-stu-id="7faee-132">Synchronous version</span></span>                        | <span data-ttu-id="7faee-133">Асинхронная версия</span><span class="sxs-lookup"><span data-stu-id="7faee-133">Asynchronous version</span></span>                                     |
|------------------------------------------------------------------|--------------------------------------------|----------------------------------------------------------|
| <span data-ttu-id="7faee-134">Начать</span><span class="sxs-lookup"><span data-stu-id="7faee-134">Start</span></span>                                                            | <span data-ttu-id="7faee-135">Отправить запрос в Довнфалл кофе &</span><span class="sxs-lookup"><span data-stu-id="7faee-135">Send request to Downfall Coffee & Tea</span></span>      | <span data-ttu-id="7faee-136">Отправка запросов в Довнфалл кофе & чай и четвертый кофе</span><span class="sxs-lookup"><span data-stu-id="7faee-136">Send requests to Downfall Coffee & Tea and Fourth Coffee</span></span> |
| <span data-ttu-id="7faee-137">Запрос от асинхронной версии к четвертой кофе завершена</span><span class="sxs-lookup"><span data-stu-id="7faee-137">Request from the asynchronous version to Fourth Coffee completed</span></span> | <span data-ttu-id="7faee-138">Ожидание</span><span class="sxs-lookup"><span data-stu-id="7faee-138">Waiting</span></span>                                    | <span data-ttu-id="7faee-139">Загрузка цен с четвертого кофе</span><span class="sxs-lookup"><span data-stu-id="7faee-139">Download prices from Fourth Coffee</span></span>                       |
| <span data-ttu-id="7faee-140">Запрос на Довнфаллный чай & кофе завершена</span><span class="sxs-lookup"><span data-stu-id="7faee-140">Request to Downfall Coffee & Tea completed</span></span>                       | <span data-ttu-id="7faee-141">Загрузка цен с Довнфалл кофе & чай</span><span class="sxs-lookup"><span data-stu-id="7faee-141">Download prices from Downfall Coffee & Tea</span></span> | <span data-ttu-id="7faee-142">Загрузка цен с Довнфалл кофе & чай</span><span class="sxs-lookup"><span data-stu-id="7faee-142">Download prices from Downfall Coffee & Tea</span></span>               |
| <span data-ttu-id="7faee-143">После скачивания цен Довнфалл кофе & чай</span><span class="sxs-lookup"><span data-stu-id="7faee-143">After Downfall Coffee & Tea's prices are downloaded</span></span>              | <span data-ttu-id="7faee-144">Отправить запрос в четвертую кофе</span><span class="sxs-lookup"><span data-stu-id="7faee-144">Send request to Fourth Coffee</span></span>              | <span data-ttu-id="7faee-145">Сравнение цен</span><span class="sxs-lookup"><span data-stu-id="7faee-145">Compare prices</span></span>                                           |
| <span data-ttu-id="7faee-146">Сравнение асинхронной версии завершено</span><span class="sxs-lookup"><span data-stu-id="7faee-146">Asynchronous version's comparison completed</span></span>                      | <span data-ttu-id="7faee-147">Ожидание</span><span class="sxs-lookup"><span data-stu-id="7faee-147">Waiting</span></span>                                    | <span data-ttu-id="7faee-148">Операция завершена</span><span class="sxs-lookup"><span data-stu-id="7faee-148">Operation complete</span></span>                                       |
| <span data-ttu-id="7faee-149">Запрос от синхронной версии к четвертой кофе завершена</span><span class="sxs-lookup"><span data-stu-id="7faee-149">Request from the synchronous version to Fourth Coffee completed</span></span>  | <span data-ttu-id="7faee-150">Загрузка цен с четвертого кофе</span><span class="sxs-lookup"><span data-stu-id="7faee-150">Download prices from Fourth Coffee</span></span>         | <span data-ttu-id="7faee-151">Недоступно</span><span class="sxs-lookup"><span data-stu-id="7faee-151">n/a</span></span>                                                      |
| <span data-ttu-id="7faee-152">После скачивания цен четвертой кофе</span><span class="sxs-lookup"><span data-stu-id="7faee-152">After Fourth Coffee's prices are downloaded</span></span>                      | <span data-ttu-id="7faee-153">Сравнение цен</span><span class="sxs-lookup"><span data-stu-id="7faee-153">Compare prices</span></span>                             | <span data-ttu-id="7faee-154">Недоступно</span><span class="sxs-lookup"><span data-stu-id="7faee-154">n/a</span></span>                                                      |
| <span data-ttu-id="7faee-155">Сравнение синхронной версии завершено</span><span class="sxs-lookup"><span data-stu-id="7faee-155">Synchronous version's comparison completed</span></span>                       | <span data-ttu-id="7faee-156">Операция завершена</span><span class="sxs-lookup"><span data-stu-id="7faee-156">Operation complete</span></span>                         | <span data-ttu-id="7faee-157">Недоступно</span><span class="sxs-lookup"><span data-stu-id="7faee-157">n/a</span></span>                                                      |



 

<span data-ttu-id="7faee-158">Другим примером может служить веб-браузер, например Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="7faee-158">Another example would be a web browser such as Microsoft Internet Explorer.</span></span> <span data-ttu-id="7faee-159">Когда браузер загружает страницу, часто требуется загрузить другие ресурсы, такие как изображения и звуковые файлы.</span><span class="sxs-lookup"><span data-stu-id="7faee-159">When the browser downloads a page, it often needs to download other resources, such as images and sound files.</span></span> <span data-ttu-id="7faee-160">В асинхронном режиме страница и связанные с ней ресурсы могут запрашиваться одновременно и загружаться по мере их появления, а не запрашивать и скачивать страницу и каждый ресурс по одному за раз.</span><span class="sxs-lookup"><span data-stu-id="7faee-160">In asynchronous mode, the page and its associated resources can be requested simultaneously and downloaded as they become available, instead of requesting and downloading the page and each resource one at a time.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7faee-161">См. также</span><span class="sxs-lookup"><span data-stu-id="7faee-161">Related Topics</span></span>

<span data-ttu-id="7faee-162">Ниже приведены связанные ссылки.</span><span class="sxs-lookup"><span data-stu-id="7faee-162">The following are related links.</span></span>

<span data-ttu-id="7faee-163">Учебники</span><span class="sxs-lookup"><span data-stu-id="7faee-163">Tutorials</span></span>

-   [<span data-ttu-id="7faee-164">Создание функций обратного вызова состояния</span><span class="sxs-lookup"><span data-stu-id="7faee-164">Creating Status Callback Functions</span></span>](creating-status-callback-functions.md)

<span data-ttu-id="7faee-165">Функции, необходимые для настройки асинхронной операции</span><span class="sxs-lookup"><span data-stu-id="7faee-165">Functions needed to set up asynchronous operation</span></span>

-   [<span data-ttu-id="7faee-166">**интернетопен**</span><span class="sxs-lookup"><span data-stu-id="7faee-166">**InternetOpen**</span></span>](/windows/desktop/api/Wininet/nf-wininet-internetopena)
-   [<span data-ttu-id="7faee-167">**интернетсетстатускаллбакк**</span><span class="sxs-lookup"><span data-stu-id="7faee-167">**InternetSetStatusCallback**</span></span>](/windows/desktop/api/Wininet/nf-wininet-internetsetstatuscallback)

<span data-ttu-id="7faee-168">Функции, которые могут использоваться асинхронно</span><span class="sxs-lookup"><span data-stu-id="7faee-168">Functions that can be used asynchronously</span></span>

-   [<span data-ttu-id="7faee-169">**фтпкреатедиректори**</span><span class="sxs-lookup"><span data-stu-id="7faee-169">**FtpCreateDirectory**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpcreatedirectorya)
-   [<span data-ttu-id="7faee-170">**фтпделетефиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-170">**FtpDeleteFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpdeletefilea)
-   [<span data-ttu-id="7faee-171">**фтпфиндфирстфиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-171">**FtpFindFirstFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea)
-   [<span data-ttu-id="7faee-172">**фтпжеткуррентдиректори**</span><span class="sxs-lookup"><span data-stu-id="7faee-172">**FtpGetCurrentDirectory**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpgetcurrentdirectorya)
-   [<span data-ttu-id="7faee-173">**фтпжетфиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-173">**FtpGetFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpgetfilea)
-   [<span data-ttu-id="7faee-174">**фтпопенфиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-174">**FtpOpenFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea)
-   [<span data-ttu-id="7faee-175">**фтппутфиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-175">**FtpPutFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpputfilea)
-   [<span data-ttu-id="7faee-176">**фтпремоведиректори**</span><span class="sxs-lookup"><span data-stu-id="7faee-176">**FtpRemoveDirectory**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpremovedirectorya)
-   [<span data-ttu-id="7faee-177">**фтпренамефиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-177">**FtpRenameFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftprenamefilea)
-   [<span data-ttu-id="7faee-178">**фтпсеткуррентдиректори**</span><span class="sxs-lookup"><span data-stu-id="7faee-178">**FtpSetCurrentDirectory**</span></span>](/windows/desktop/api/Wininet/nf-wininet-ftpsetcurrentdirectorya)
-   [<span data-ttu-id="7faee-179">**гоферфиндфирстфиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-179">**GopherFindFirstFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-gopherfindfirstfilea)
-   [<span data-ttu-id="7faee-180">**гоферопенфиле**</span><span class="sxs-lookup"><span data-stu-id="7faee-180">**GopherOpenFile**</span></span>](/windows/desktop/api/Wininet/nf-wininet-gopheropenfilea)
-   [<span data-ttu-id="7faee-181">**хттпендрекуест**</span><span class="sxs-lookup"><span data-stu-id="7faee-181">**HttpEndRequest**</span></span>](/windows/desktop/api/Wininet/nf-wininet-httpendrequesta)
-   [<span data-ttu-id="7faee-182">**хттпопенрекуест**</span><span class="sxs-lookup"><span data-stu-id="7faee-182">**HttpOpenRequest**</span></span>](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta)
-   [<span data-ttu-id="7faee-183">**хттпсендрекуестекс**</span><span class="sxs-lookup"><span data-stu-id="7faee-183">**HttpSendRequestEx**</span></span>](/windows/desktop/api/Wininet/nf-wininet-httpsendrequestexa)
-   [<span data-ttu-id="7faee-184">**интернетконнект**</span><span class="sxs-lookup"><span data-stu-id="7faee-184">**InternetConnect**</span></span>](/windows/desktop/api/Wininet/nf-wininet-internetconnecta)
-   [<span data-ttu-id="7faee-185">**интернетопенурл**</span><span class="sxs-lookup"><span data-stu-id="7faee-185">**InternetOpenUrl**</span></span>](/windows/desktop/api/Wininet/nf-wininet-internetopenurla)
-   [<span data-ttu-id="7faee-186">**интернетреадфиликс**</span><span class="sxs-lookup"><span data-stu-id="7faee-186">**InternetReadFileEx**</span></span>](/windows/desktop/api/Wininet/nf-wininet-internetreadfileexa)

> [!Note]  
> <span data-ttu-id="7faee-187">Функции [**фтпкреатедиректори**](/windows/desktop/api/Wininet/nf-wininet-ftpcreatedirectorya), [**фтпремоведиректори**](/windows/desktop/api/Wininet/nf-wininet-ftpremovedirectorya), [**фтпсеткуррентдиректори**](/windows/desktop/api/Wininet/nf-wininet-ftpsetcurrentdirectorya), [**фтпжеткуррентдиректори**](/windows/desktop/api/Wininet/nf-wininet-ftpgetcurrentdirectorya), [**FtpDeleteFile**](/windows/desktop/api/Wininet/nf-wininet-ftpdeletefilea)и [**FtpRenameFile**](/windows/desktop/api/Wininet/nf-wininet-ftprenamefilea) используют значение контекста, указанное в вызове функции [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) .</span><span class="sxs-lookup"><span data-stu-id="7faee-187">The [**FtpCreateDirectory**](/windows/desktop/api/Wininet/nf-wininet-ftpcreatedirectorya), [**FtpRemoveDirectory**](/windows/desktop/api/Wininet/nf-wininet-ftpremovedirectorya), [**FtpSetCurrentDirectory**](/windows/desktop/api/Wininet/nf-wininet-ftpsetcurrentdirectorya), [**FtpGetCurrentDirectory**](/windows/desktop/api/Wininet/nf-wininet-ftpgetcurrentdirectorya), [**FtpDeleteFile**](/windows/desktop/api/Wininet/nf-wininet-ftpdeletefilea), and [**FtpRenameFile**](/windows/desktop/api/Wininet/nf-wininet-ftprenamefilea) functions use the context value provided in the call to the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function.</span></span>

 

> [!Note]  
> <span data-ttu-id="7faee-188">WinINet не поддерживает реализации серверов.</span><span class="sxs-lookup"><span data-stu-id="7faee-188">WinINet does not support server implementations.</span></span> <span data-ttu-id="7faee-189">Кроме того, его не следует использовать из службы.</span><span class="sxs-lookup"><span data-stu-id="7faee-189">In addition, it should not be used from a service.</span></span> <span data-ttu-id="7faee-190">Для серверных реализаций или служб используйте [службы Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="7faee-190">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

 