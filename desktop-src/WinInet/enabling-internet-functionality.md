---
title: Включение функций Интернета
description: Перед использованием функций WinINet приложение должно попытаться установить подключение к Интернету с помощью функции Интернетаттемптконнект.
ms.assetid: 80747c0d-5a09-4ffa-a0ca-b051b82acbf8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: adb44fadaf0726b81618dde19105da7517673a00
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070487"
---
# <a name="enabling-internet-functionality"></a><span data-ttu-id="91967-103">Включение функций Интернета</span><span class="sxs-lookup"><span data-stu-id="91967-103">Enabling Internet Functionality</span></span>

<span data-ttu-id="91967-104">Перед использованием функций WinINet приложение должно попытаться установить подключение к Интернету с помощью функции [**интернетаттемптконнект**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) .</span><span class="sxs-lookup"><span data-stu-id="91967-104">Before using the WinINet functions, the application should attempt to make a connection to the Internet by using the [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) function.</span></span> <span data-ttu-id="91967-105">Эта функция вызывает диалоговое окно удаленного доступа, чтобы установить соединение с Интернетом или проверить, существует ли уже соединение.</span><span class="sxs-lookup"><span data-stu-id="91967-105">This function calls the dial-up dialog box to initiate a connection to the Internet or check if a connection already exists.</span></span> <span data-ttu-id="91967-106">Если эта функция завершается ошибкой, приложение может перейти в автономный режим, что позволяет ему получить доступ к информации, кэшированной во время предыдущих подключений к Интернету.</span><span class="sxs-lookup"><span data-stu-id="91967-106">If this function fails, the application can enter offline mode, which allows it to access information that was cached during previous connections to the Internet.</span></span>

<span data-ttu-id="91967-107">Используйте функцию [**интернетчеккконнектион**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) для проверки подключения к Интернету.</span><span class="sxs-lookup"><span data-stu-id="91967-107">Use the [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) function to check the connection to the Internet.</span></span> <span data-ttu-id="91967-108">Он пытается проверить связь с сервером, назначенным URL-адресом, который передается функции.</span><span class="sxs-lookup"><span data-stu-id="91967-108">It attempts to ping the server designated by the URL that is passed to the function.</span></span> <span data-ttu-id="91967-109">Если \_ \_ установлен флаг флага подключения ICC Force \_ и URL-адрес имеет **значение NULL**, функция проверяет наличие записи в базе данных сервера для ближайшего сервера.</span><span class="sxs-lookup"><span data-stu-id="91967-109">If the FLAG\_ICC\_FORCE\_CONNECTION flag is set and the URL is **NULL**, the function checks to see if there is an entry in the server database for the nearest server.</span></span> <span data-ttu-id="91967-110">Если он существует, функция проверяет связь с этим сервером.</span><span class="sxs-lookup"><span data-stu-id="91967-110">If one exists, the function pings that server.</span></span>

<span data-ttu-id="91967-111">Затем используйте функцию [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) , чтобы установить характеристики подключения к Интернету, используемого клиентским приложением.</span><span class="sxs-lookup"><span data-stu-id="91967-111">Next, use the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function to establish the characteristics of the Internet connection the client application is using.</span></span> <span data-ttu-id="91967-112">[**Интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) создает корневой обработчик [**хинтернет**](appendix-a-hinternet-handles.md) , который используется для установки сеансов [FTP](ftp-sessions.md) по [протоколу HTTP](http-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="91967-112">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) creates the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is used to establish [http](http-sessions.md)[ftp](ftp-sessions.md) sessions.</span></span> <span data-ttu-id="91967-113">[**Интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) не проверяет подключение к Интернету, чтобы убедиться, что характеристики, переданные в функцию, верны.</span><span class="sxs-lookup"><span data-stu-id="91967-113">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) does not test the connection to the Internet to verify that the characteristics passed to the function are correct.</span></span>

<span data-ttu-id="91967-114">Используйте функцию [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) для создания конкретного сеанса.</span><span class="sxs-lookup"><span data-stu-id="91967-114">Use the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function to create a specific session.</span></span> <span data-ttu-id="91967-115">[**Интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) Инициализирует сеанс для указанного сайта с помощью переданных ему аргументов и создает обработчик [**хинтернет**](appendix-a-hinternet-handles.md) , который является ветвью корневого маркера.</span><span class="sxs-lookup"><span data-stu-id="91967-115">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) initializes a session for the specified site using the arguments passed to it and creates an [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is a branch off the root handle.</span></span> <span data-ttu-id="91967-116">[**Интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) не пытается получить доступ к указанному сайту или установить соединение с ним, за исключением случая сеанса FTP.</span><span class="sxs-lookup"><span data-stu-id="91967-116">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not attempt to access or establish a connection to the specified site, except in the case of an FTP session.</span></span> <span data-ttu-id="91967-117">Функции [**фтпфиндфирстфиле**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**фтпопенфиле**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea)и [**Хттпопенрекуест**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) используют маркер, созданный [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) , для установления соединения с указанным сайтом.</span><span class="sxs-lookup"><span data-stu-id="91967-117">[**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea), and [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) functions use the handle created by [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) to establish a connection to the specified site.</span></span>

## <a name="using-internetopen"></a><span data-ttu-id="91967-118">Использование Интернетопен</span><span class="sxs-lookup"><span data-stu-id="91967-118">Using InternetOpen</span></span>

<span data-ttu-id="91967-119">Чтобы включить подключение к Интернету, необходимо создать корневой обработчик [**хинтернет**](appendix-a-hinternet-handles.md) с помощью [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="91967-119">To enable a connection to the Internet, a root [**HINTERNET**](appendix-a-hinternet-handles.md) handle must be created by using [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="91967-120">Сведения об агенте пользователя (приложение, вызывающее Интернет-функции), тип доступа к Интернету, имена прокси-серверов, узлы и адреса, которые обходят прокси-сервер, и поведение передается в [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="91967-120">Information about the user agent (the application calling the Internet functions), the type of access to the Internet, the proxy names, the hosts and addresses that bypass the proxy, and the behavior are passed to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="setting-the-user-agent"></a><span data-ttu-id="91967-121">Настройка агента пользователя</span><span class="sxs-lookup"><span data-stu-id="91967-121">Setting the User Agent</span></span>

<span data-ttu-id="91967-122">Вызывающее приложение должно предоставить строку, содержащую имя приложения или сущности, обращающейся к Интернету, в параметр *Лпсзажент* [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="91967-122">The calling application should give a string that contains the name of the application or entity accessing the Internet to the *lpszAgent* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="91967-123">Эта строка используется в качестве агента пользователя в протоколе HTTP.</span><span class="sxs-lookup"><span data-stu-id="91967-123">This string is used as the user agent in the HTTP protocol.</span></span> <span data-ttu-id="91967-124">Например, Microsoft Internet Explorer использует обозреватель Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="91967-124">For example, Microsoft Internet Explorer uses "Microsoft Internet Explorer".</span></span>

### <a name="setting-access-types"></a><span data-ttu-id="91967-125">Настройка типов доступа</span><span class="sxs-lookup"><span data-stu-id="91967-125">Setting Access Types</span></span>

<span data-ttu-id="91967-126">[**Интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) поддерживает три типа доступа:</span><span class="sxs-lookup"><span data-stu-id="91967-126">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) supports three access types:</span></span>

-   <span data-ttu-id="91967-127">Используйте параметр \_ открыть \_ в Интернете введите \_ Direct, если система, в которой выполняется приложение, использует прямое подключение к Интернету.</span><span class="sxs-lookup"><span data-stu-id="91967-127">Use INTERNET\_OPEN\_TYPE\_DIRECT if the system on which the application is running uses a direct connection to the Internet.</span></span> <span data-ttu-id="91967-128">Параметры *лпсзпроксинаме* и *лпсзпроксибипасс* [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) не используются и должны иметь значение **null**.</span><span class="sxs-lookup"><span data-stu-id="91967-128">The *lpszProxyName* and *lpszProxyBypass* parameters of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) are not used and should be set to **NULL**.</span></span>
-   <span data-ttu-id="91967-129">Используйте \_ \_ \_ прокси-сервер в Интернете с открытым типом, если в системе, в которой выполняется приложение, используется один или несколько прокси-серверов для доступа к Интернету.</span><span class="sxs-lookup"><span data-stu-id="91967-129">Use INTERNET\_OPEN\_TYPE\_PROXY if the system on which the application is running uses one or more proxy servers to access the Internet.</span></span> <span data-ttu-id="91967-130">[**Интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) использует прокси-серверы, указанные в *лпсзпроксинаме* , и обходит прокси-сервер для любых имен узлов или IP-адресов, указанных в *лпсзпроксибипасс*.</span><span class="sxs-lookup"><span data-stu-id="91967-130">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) uses the proxy servers indicated by *lpszProxyName* and bypasses the proxy for any host names or IP addresses specified by *lpszProxyBypass*.</span></span>
-   <span data-ttu-id="91967-131">Используйте \_ параметр Internet Open \_ Type \_ config, чтобы сообщить приложению о необходимости извлечения конфигурации из реестра.</span><span class="sxs-lookup"><span data-stu-id="91967-131">Use INTERNET\_OPEN\_TYPE\_PRECONFIG to instruct your application to retrieve the configuration from the registry.</span></span> <span data-ttu-id="91967-132">Обычно это лучший выбор, так как большинство приложений, включая веб-браузеры, используют этот параметр.</span><span class="sxs-lookup"><span data-stu-id="91967-132">This is typically the best choice, as most applications including web browsers use this option.</span></span>

<span data-ttu-id="91967-133">В \_ \_ \_ разделе "Конфигурация открытых типов в Интернете" рассматриваются значения реестра **Проксенабле**, **proxyserver** и **проксйоверриде**.</span><span class="sxs-lookup"><span data-stu-id="91967-133">INTERNET\_OPEN\_TYPE\_PRECONFIG looks at the registry values **ProxyEnable**, **ProxyServer**, and **ProxyOverride**.</span></span> <span data-ttu-id="91967-134">Эти значения находятся в разделе "HKEY \_ Current \_ user \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings".</span><span class="sxs-lookup"><span data-stu-id="91967-134">These values are located under "HKEY\_CURRENT\_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings".</span></span>

<span data-ttu-id="91967-135">Если **проксенабле** равен нулю, приложение использует \_ прямое открытие типа "Интернет" \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="91967-135">If **ProxyEnable** is zero, the application uses INTERNET\_OPEN\_TYPE\_DIRECT.</span></span> <span data-ttu-id="91967-136">В противном случае приложение использует \_ \_ прокси-сервер с открытым типом Интернета \_ и использует сведения о **proxyserver** и **проксйоверриде** .</span><span class="sxs-lookup"><span data-stu-id="91967-136">Otherwise, the application uses INTERNET\_OPEN\_TYPE\_PROXY and uses the **ProxyServer** and **ProxyOverride** information.</span></span>

<span data-ttu-id="91967-137">Функции WinINet обеспечивают поддержку для прокси типа SOCKS, только если установлен Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="91967-137">The WinINet functions provide support for SOCKS type proxies only if Internet Explorer is installed.</span></span> <span data-ttu-id="91967-138">В состав установки Internet Explorer входит Wsock32n.dll файл, необходимый для поддержки прокси-серверов SOCKS.</span><span class="sxs-lookup"><span data-stu-id="91967-138">The installation of Internet Explorer includes the Wsock32n.dll file, which is needed to support SOCKS proxies.</span></span> <span data-ttu-id="91967-139">Wsock32n.dll не является распространяемым.</span><span class="sxs-lookup"><span data-stu-id="91967-139">Wsock32n.dll is not redistributable.</span></span>

### <a name="listing-proxy-servers"></a><span data-ttu-id="91967-140">Вывод списка прокси-серверов</span><span class="sxs-lookup"><span data-stu-id="91967-140">Listing Proxy Servers</span></span>

<span data-ttu-id="91967-141">WinINet распознает два типа прокси: CERN типа прокси (только HTTP) и TIS FTP-прокси (только FTP).</span><span class="sxs-lookup"><span data-stu-id="91967-141">WinINet recognizes two types of proxies: CERN type proxies (HTTP only) and TIS FTP proxies (FTP only).</span></span> <span data-ttu-id="91967-142">Если установлен Internet Explorer, WinINet также поддерживает прокси-серверы типа SOCKS.</span><span class="sxs-lookup"><span data-stu-id="91967-142">If Internet Explorer is installed, WinINet also support SOCKS type proxies.</span></span> <span data-ttu-id="91967-143">По умолчанию [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) предполагает, что указанный прокси-сервер является прокси-сервером CERN.</span><span class="sxs-lookup"><span data-stu-id="91967-143">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) assumes, by default, that the specified proxy is a CERN proxy.</span></span> <span data-ttu-id="91967-144">Если для параметра Тип доступа задано значение INTERNET \_ Open \_ Type \_ Direct или Internet \_ Open Type \_ \_ config, параметр *лпсзпроксинаме* [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) должен иметь значение **null**.</span><span class="sxs-lookup"><span data-stu-id="91967-144">If the access type is set to INTERNET\_OPEN\_TYPE\_DIRECT or INTERNET\_OPEN\_TYPE\_PRECONFIG, the *lpszProxyName* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) should be set to **NULL**.</span></span> <span data-ttu-id="91967-145">В противном случае значение, передаваемое в *лпсзпроксинаме* , должно содержать прокси-серверы в строке, разделенной пробелами.</span><span class="sxs-lookup"><span data-stu-id="91967-145">Otherwise, the value passed to *lpszProxyName* must contain the proxies in a space-delimited string.</span></span> <span data-ttu-id="91967-146">Списки прокси-серверов могут содержать номер порта, который используется для доступа к прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="91967-146">The proxy listings can contain the port number that is used to access the proxy.</span></span>

<span data-ttu-id="91967-147">Чтобы получить список прокси-сервера для конкретного протокола, строка должна соответствовать формату "" <protocol> <protocol> ://<имя прокси-сервера \_> "".</span><span class="sxs-lookup"><span data-stu-id="91967-147">To list a proxy for a specific protocol, the string must follow the format ""<protocol><protocol>://<proxy\_name>"".</span></span> <span data-ttu-id="91967-148">Допустимые протоколы: HTTP, HTTPS и FTP.</span><span class="sxs-lookup"><span data-stu-id="91967-148">The valid protocols are HTTP, HTTPS and FTP.</span></span> <span data-ttu-id="91967-149">Например, чтобы получить список прокси-сервера FTP, допустима строка "" FTP = FTP://ФТП \_ Proxy \_ Name: 21 "", где \_ имя прокси-сервера FTP \_ — это имя прокси-сервера FTP, а 21 — номер порта, который должен использоваться для доступа к прокси-серверу.</span><span class="sxs-lookup"><span data-stu-id="91967-149">For example, to list an FTP proxy, a valid string would be ""ftp=ftp://ftp\_proxy\_name:21"", where ftp\_proxy\_name is the name of the FTP proxy and 21 is the port number that must be used to access the proxy.</span></span> <span data-ttu-id="91967-150">Если прокси-сервер использует номер порта по умолчанию для этого протокола, номер порта можно опустить.</span><span class="sxs-lookup"><span data-stu-id="91967-150">If the proxy uses the default port number for that protocol, the port number can be omitted.</span></span> <span data-ttu-id="91967-151">Если имя прокси-сервера указано отдельно, оно используется в качестве прокси-сервера по умолчанию для всех протоколов, для которых не указан определенный прокси-сервер.</span><span class="sxs-lookup"><span data-stu-id="91967-151">If a proxy name is listed by itself, it is used as the default proxy for any protocols that do not have a specific proxy specified.</span></span> <span data-ttu-id="91967-152">Например, "" HTTP = https://http\_proxy other "" будет использовать HTTP \_ -прокси для любых операций HTTP, тогда как все остальные протоколы будут использовать другие.</span><span class="sxs-lookup"><span data-stu-id="91967-152">For example, ""http=https://http\_proxy other"" would use http\_proxy for any HTTP operations, while all other protocols would use other.</span></span>

<span data-ttu-id="91967-153">По умолчанию функция предполагает, что прокси-сервер, указанный в *лпсзпроксинаме* , является прокси-сервером CERN.</span><span class="sxs-lookup"><span data-stu-id="91967-153">By default, the function assumes that the proxy specified by *lpszProxyName* is a CERN proxy.</span></span> <span data-ttu-id="91967-154">Приложение может указывать более одного прокси-сервера, включая разные прокси для разных протоколов.</span><span class="sxs-lookup"><span data-stu-id="91967-154">An application can specify more than one proxy, including different proxies for the different protocols.</span></span> <span data-ttu-id="91967-155">Например, если указать "" FTP = FTP://ФТП-ГВ HTTP = https://jericho:99 proxy "", запросы FTP выполняются через прокси-сервер FTP-GW, который прослушивает порт 21, и HTTP-запросы выполняются через прокси-сервер CERN с именем жеричо, который прослушивает порт 99.</span><span class="sxs-lookup"><span data-stu-id="91967-155">For example, if you specify ""ftp=ftp://ftp-gw HTTP=https://jericho:99 proxy"", FTP requests are made through the ftp-gw proxy, which listens at port 21, and HTTP requests are made through a CERN proxy called jericho, which listens at port 99.</span></span> <span data-ttu-id="91967-156">В противном случае HTTP-запросы будут выполняться через прокси-сервер CERN с именем proxy, который прослушивает порт 80.</span><span class="sxs-lookup"><span data-stu-id="91967-156">Otherwise, HTTP requests would be made through the CERN proxy called proxy, which listens at port 80.</span></span> <span data-ttu-id="91967-157">Обратите внимание, что если приложение использует только FTP, например, не нужно указывать "" FTP = FTP://ФТП-ГВ: 21 "".</span><span class="sxs-lookup"><span data-stu-id="91967-157">Note that if the application is only using FTP, for example, it would not need to specify ""ftp=ftp://ftp-gw:21"".</span></span> <span data-ttu-id="91967-158">Он может указать только "" FTP-GW "".</span><span class="sxs-lookup"><span data-stu-id="91967-158">It could specify just ""ftp-gw"".</span></span> <span data-ttu-id="91967-159">Приложение требуется только для указания имен протоколов, если оно использует более одного протокола для каждого обработчика, возвращаемого функцией [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="91967-159">An application is only required to specify the protocol names if it is using more than one protocol per handle returned by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="listing-the-proxy-bypass"></a><span data-ttu-id="91967-160">Вывод списка обхода прокси-сервера</span><span class="sxs-lookup"><span data-stu-id="91967-160">Listing the Proxy Bypass</span></span>

<span data-ttu-id="91967-161">Имена узлов или IP-адреса, которые не должны отправляться в прокси-сервер, могут быть перечислены в списке обхода прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="91967-161">Host names or IP addresses that should not be sent to the proxy can be listed in the proxy bypass list.</span></span> <span data-ttu-id="91967-162">Этот список может содержать подстановочные знаки, " \* ", что приводит к тому, что приложение обходит прокси-сервер для адресов, соответствующих указанному шаблону.</span><span class="sxs-lookup"><span data-stu-id="91967-162">This list can contain wildcards, "\*", which cause the application to bypass the proxy server for addresses that fit the specified pattern.</span></span> <span data-ttu-id="91967-163">Чтобы вывести несколько адресов и имен узлов, разделите их точкой с запятой в строке обхода прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="91967-163">To list multiple addresses and host names, separate them with semicolons in the proxy bypass string.</span></span> <span data-ttu-id="91967-164">Если <local> указан макрос "", функция обходит прокси-сервер для любого имени узла, не содержащего точку.</span><span class="sxs-lookup"><span data-stu-id="91967-164">If the "<local>" macro is specified, the function bypasses the proxy for any host name that does not contain a period.</span></span>

<span data-ttu-id="91967-165">По умолчанию WinINet будет обходить прокси-сервер для запросов, использующих имена узлов "localhost", "loopback", "127.0.0.1" или " \[ :: 1 \] ".</span><span class="sxs-lookup"><span data-stu-id="91967-165">By default, WinINet will bypass the proxy for requests that use the host names "localhost", "loopback", "127.0.0.1", or "\[::1\]".</span></span> <span data-ttu-id="91967-166">Это связано с тем, что удаленный прокси-сервер обычно не будет правильно разрешать эти адреса.</span><span class="sxs-lookup"><span data-stu-id="91967-166">This behavior exists because a remote proxy server typically will not resolve these addresses properly.</span></span>

<span data-ttu-id="91967-167">**Internet Explorer 9:** Вы можете удалить локальный компьютер из списка обхода прокси-сервера с помощью макроса "<-loopback>".</span><span class="sxs-lookup"><span data-stu-id="91967-167">**Internet Explorer 9:** You can remove the local computer from the proxy bypass list using the "<-loopback>" macro.</span></span>

<span data-ttu-id="91967-168">В следующем примере показаны примеры вызовов [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) с использованием разных строк обхода прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="91967-168">The following example shows sample calls to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) using different proxy bypass strings.</span></span> <span data-ttu-id="91967-169">В комментариях, вышеуказанных при каждом вызове, описывается, какое воздействие на строку обхода имеет имя узла, доступ к которому осуществляется из создаваемого им обработчика [**хинтернет**](appendix-a-hinternet-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="91967-169">The comments above each call describe what effect the bypass string has on the host names that are accessed from the [**HINTERNET**](appendix-a-hinternet-handles.md) handle it creates.</span></span>


```C++
HINTERNET hInternetRoot;

/* bypass the proxy for any host name that does not 
    contain a period */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("<local>"), 0);

/* bypass the proxy for any host name that starts with the 
    letters "ms" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("ms*"), 0);

/* bypass the proxy for any host name that contains "int", 
    such as "internet" and "painter" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("*int*"), 0);

/* bypass the proxy for the host name "example" and any 
    host name that contains "test" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("example *test*"), 0);

/* Disable the loopback proxy bypass for localhost */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("127.0.0.1:8888"),TEXT("<-loopback>"), 0);
```



## <a name="using-internetconnect"></a><span data-ttu-id="91967-170">Использование Интернетконнект</span><span class="sxs-lookup"><span data-stu-id="91967-170">Using InternetConnect</span></span>

<span data-ttu-id="91967-171">Чтобы начать сеанс, функция [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) должна создать обработчик из корневого маркера, возвращенного функцией [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) .</span><span class="sxs-lookup"><span data-stu-id="91967-171">To begin a session, the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function must create a handle off the root handle returned by the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function.</span></span> <span data-ttu-id="91967-172">[**Интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) задает адрес сервера, номер порта, имя пользователя, пароль и тип службы.</span><span class="sxs-lookup"><span data-stu-id="91967-172">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) sets the server address, port number, user name, password, and type of service.</span></span>

<span data-ttu-id="91967-173">[**Интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) использует для установки обработчика сеанса корневой обработчик [**хинтернет**](appendix-a-hinternet-handles.md) , созданный с помощью [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena) .</span><span class="sxs-lookup"><span data-stu-id="91967-173">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle created by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) to establish a session handle.</span></span> <span data-ttu-id="91967-174">Если в вызове [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena)был установлен флаг [ \_ \_ Async в Интернете](api-flags.md) , вызов [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) должен включать ненулевое значение контекста.</span><span class="sxs-lookup"><span data-stu-id="91967-174">If the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag was set in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), the call to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) should include a nonzero context value.</span></span>

<span data-ttu-id="91967-175">Имя сервера может содержать либо имя узла (например, "www.servername.com"), либо IP-номер сайта в точечно-десятичном формате ASCII (например, "10.0.1.45").</span><span class="sxs-lookup"><span data-stu-id="91967-175">The server name can contain either the host name (for example, "www.servername.com") or IP number of the site in ASCII dotted-decimal format (for example, "10.0.1.45").</span></span>

<span data-ttu-id="91967-176">Порт сервера — это номер порта TCP/IP, к которому необходимо подключиться на сервере.</span><span class="sxs-lookup"><span data-stu-id="91967-176">The server port is the Transmission Control Protocol/Internet Protocol (TCP/IP) port number to connect to on the server.</span></span> <span data-ttu-id="91967-177">[**Интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) использует порт по умолчанию для выбранного типа службы, если \_ используется недопустимое \_ значение номера порта в Интернете \_ .</span><span class="sxs-lookup"><span data-stu-id="91967-177">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the default port for the selected service type if the INTERNET\_INVALID\_PORT\_NUMBER value is used.</span></span> <span data-ttu-id="91967-178">В следующих таблицах содержатся параметры порта сервера по умолчанию для WinINet.</span><span class="sxs-lookup"><span data-stu-id="91967-178">The following tables contain the server port defaults for WinINet.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="91967-179">Значение</span><span class="sxs-lookup"><span data-stu-id="91967-179">Value</span></span></th>
<th><span data-ttu-id="91967-180">Значение</span><span class="sxs-lookup"><span data-stu-id="91967-180">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="91967-181">INTERNET_DEFAULT_FTP_PORT</span><span class="sxs-lookup"><span data-stu-id="91967-181">INTERNET_DEFAULT_FTP_PORT</span></span></td>
<td><span data-ttu-id="91967-182">Используйте порт по умолчанию для FTP-серверов (порт 21).</span><span class="sxs-lookup"><span data-stu-id="91967-182">Use the default port for ftp servers (port 21).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="91967-183">INTERNET_DEFAULT_GOPHER_PORT</span><span class="sxs-lookup"><span data-stu-id="91967-183">INTERNET_DEFAULT_GOPHER_PORT</span></span></td>
<td><span data-ttu-id="91967-184">Используйте порт по умолчанию для серверов gopher (порт 70).</span><span class="sxs-lookup"><span data-stu-id="91967-184">Use the default port for gopher servers (port 70).</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="91967-185">Windows XP и Windows Server 2003 R2 и более ранних версий.</span><span class="sxs-lookup"><span data-stu-id="91967-185">Windows XP and Windows Server 2003 R2 and earlier only.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="91967-186">INTERNET_DEFAULT_HTTP_PORT</span><span class="sxs-lookup"><span data-stu-id="91967-186">INTERNET_DEFAULT_HTTP_PORT</span></span></td>
<td><span data-ttu-id="91967-187">Используйте порт по умолчанию для серверов HTTP (порт 80).</span><span class="sxs-lookup"><span data-stu-id="91967-187">Use the default port for http servers (port 80).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="91967-188">INTERNET_DEFAULT_HTTPS_PORT</span><span class="sxs-lookup"><span data-stu-id="91967-188">INTERNET_DEFAULT_HTTPS_PORT</span></span></td>
<td><span data-ttu-id="91967-189">Используйте порт по умолчанию для серверов HTTPS (порт 443).</span><span class="sxs-lookup"><span data-stu-id="91967-189">Use the default port for https servers (port 443).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="91967-190">INTERNET_DEFAULT_SOCKS_PORT</span><span class="sxs-lookup"><span data-stu-id="91967-190">INTERNET_DEFAULT_SOCKS_PORT</span></span></td>
<td><span data-ttu-id="91967-191">Используйте порт по умолчанию для серверов брандмауэра SOCKS (порт 1080).</span><span class="sxs-lookup"><span data-stu-id="91967-191">Use the default port for SOCKS firewall servers (port 1080).</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="defining-the-user-name-and-password"></a><span data-ttu-id="91967-192">Определение имени пользователя и пароля</span><span class="sxs-lookup"><span data-stu-id="91967-192">Defining the User Name and Password</span></span>

<span data-ttu-id="91967-193">Значение *лпсзусернаме* — это адрес строки, завершающейся **нулем,** которая содержит имя пользователя, выполнившего вход в систему.</span><span class="sxs-lookup"><span data-stu-id="91967-193">The value of *lpszUsername* is the address of a **null**-terminated string that contains the name of the user who is logging on.</span></span> <span data-ttu-id="91967-194">Если этот параметр имеет **значение NULL**, функция использует подходящее значение по умолчанию, за исключением HTTP.</span><span class="sxs-lookup"><span data-stu-id="91967-194">If this parameter is **NULL**, the function uses an appropriate default, except for HTTP.</span></span> <span data-ttu-id="91967-195">Параметр **null** в HTTP приводит к тому, что сервер возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="91967-195">A **NULL** parameter in HTTP causes the server to return an error.</span></span> <span data-ttu-id="91967-196">Для FTP-протокола значение по умолчанию — Anonymous.</span><span class="sxs-lookup"><span data-stu-id="91967-196">For the FTP protocol, the default is anonymous.</span></span>

<span data-ttu-id="91967-197">Значение *лпсзпассворд* — это адрес строки, завершающейся **нулем,** которая содержит пароль для входа.</span><span class="sxs-lookup"><span data-stu-id="91967-197">The value of *lpszPassword* is the address of a **null**-terminated string that contains the log-on password.</span></span> <span data-ttu-id="91967-198">Если оба *лпсзусернаме* и *Лпсзпассворд* имеют **значение NULL**, функция использует анонимный пароль по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="91967-198">If both *lpszUsername* and *lpszPassword* are **NULL**, the function uses the default anonymous password.</span></span> <span data-ttu-id="91967-199">В случае FTP анонимный пароль по умолчанию — это имя электронной почты пользователя.</span><span class="sxs-lookup"><span data-stu-id="91967-199">In the case of FTP, the default anonymous password is the user's email name.</span></span> <span data-ttu-id="91967-200">Если *лпсзусернаме* не равен **null** , а *лпсзпассворд* имеет **значение NULL**, функция использует пустой пароль.</span><span class="sxs-lookup"><span data-stu-id="91967-200">If *lpszUsername* is not **NULL** and *lpszPassword* is **NULL**, the function uses a blank password.</span></span> <span data-ttu-id="91967-201">Существует четыре возможных параметра *лпсзусернаме* и *лпсзпассворд*, которые создают поведение, приведенное в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="91967-201">There are four possible settings of *lpszUsername* and *lpszPassword*, which produce the behaviors shown in the following table.</span></span>



| <span data-ttu-id="91967-202">*лпсзусернаме*</span><span class="sxs-lookup"><span data-stu-id="91967-202">*lpszUsername*</span></span>      | <span data-ttu-id="91967-203">*лпсзпассворд*</span><span class="sxs-lookup"><span data-stu-id="91967-203">*lpszPassword*</span></span>      | <span data-ttu-id="91967-204">Имя пользователя, отправленное на FTP-сервер</span><span class="sxs-lookup"><span data-stu-id="91967-204">User name sent to FTP server</span></span> | <span data-ttu-id="91967-205">Пароль, отправленный на FTP-сервер</span><span class="sxs-lookup"><span data-stu-id="91967-205">Password sent to FTP server</span></span> |
|---------------------|---------------------|------------------------------|-----------------------------|
| <span data-ttu-id="91967-206">**NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-206">**NULL**</span></span>            | <span data-ttu-id="91967-207">**NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-207">**NULL**</span></span>            | <span data-ttu-id="91967-208">подключившихся</span><span class="sxs-lookup"><span data-stu-id="91967-208">"anonymous"</span></span>                  | <span data-ttu-id="91967-209">Имя электронной почты пользователя</span><span class="sxs-lookup"><span data-stu-id="91967-209">User's email name</span></span>           |
| <span data-ttu-id="91967-210">Строка, не **равная NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-210">Non-**NULL** string</span></span> | <span data-ttu-id="91967-211">**NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-211">**NULL**</span></span>            | <span data-ttu-id="91967-212">*лпсзусернаме*</span><span class="sxs-lookup"><span data-stu-id="91967-212">*lpszUsername*</span></span>               | <span data-ttu-id="91967-213">""</span><span class="sxs-lookup"><span data-stu-id="91967-213">""</span></span>                          |
| <span data-ttu-id="91967-214">**NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-214">**NULL**</span></span>            | <span data-ttu-id="91967-215">Строка, не **равная NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-215">Non-**NULL** string</span></span> | <span data-ttu-id="91967-216">ОШИБКА</span><span class="sxs-lookup"><span data-stu-id="91967-216">ERROR</span></span>                        | <span data-ttu-id="91967-217">ОШИБКА</span><span class="sxs-lookup"><span data-stu-id="91967-217">ERROR</span></span>                       |
| <span data-ttu-id="91967-218">Строка, не **равная NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-218">Non-**NULL** string</span></span> | <span data-ttu-id="91967-219">Строка, не **равная NULL**</span><span class="sxs-lookup"><span data-stu-id="91967-219">Non-**NULL** string</span></span> | <span data-ttu-id="91967-220">*лпсзусернаме*</span><span class="sxs-lookup"><span data-stu-id="91967-220">*lpszUsername*</span></span>               | <span data-ttu-id="91967-221">*лпсзпассворд*</span><span class="sxs-lookup"><span data-stu-id="91967-221">*lpszPassword*</span></span>              |



 

<span data-ttu-id="91967-222">Эти сведения можно изменить с помощью функций [**интернетсетоптион**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) и [**интернетеррордлг**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) .</span><span class="sxs-lookup"><span data-stu-id="91967-222">This information can be changed by using the [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) and [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) functions.</span></span> <span data-ttu-id="91967-223">[**Интернетсетоптион**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) изменяет значения имени пользователя и пароля, в то время как [**интернетеррордлг**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) отображает диалоговое окно, в котором запрашиваются правильные имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="91967-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) changes the user name and password values, while [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) displays a dialog box that requests the proper user name and password.</span></span>

### <a name="defining-the-session"></a><span data-ttu-id="91967-224">Определение сеанса</span><span class="sxs-lookup"><span data-stu-id="91967-224">Defining the Session</span></span>

<span data-ttu-id="91967-225">Чтобы определить установленный сеанс, задайте тип службы, флаги и значение контекста для [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span><span class="sxs-lookup"><span data-stu-id="91967-225">To define the session that is being established, set the service type, flags, and context value for [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span></span>

<span data-ttu-id="91967-226">Существует два типа служб, доступных для [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): \_ \_ FTP-служба Интернета и \_ \_ http.</span><span class="sxs-lookup"><span data-stu-id="91967-226">There are two service types available to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): INTERNET\_SERVICE\_FTP and INTERNET\_SERVICE\_HTTP.</span></span> <span data-ttu-id="91967-227">\_ \_ HTTP-служба Интернета используется как для сеансов HTTP, так и для HTTPS.</span><span class="sxs-lookup"><span data-stu-id="91967-227">INTERNET\_SERVICE\_HTTP is used for both HTTP and HTTPS sessions.</span></span>

<span data-ttu-id="91967-228">[Интернет \_ ФЛАГ \_ passive](api-flags.md) является единственным зависящим от службы флагом, используемым функциями WinInet.</span><span class="sxs-lookup"><span data-stu-id="91967-228">[INTERNET\_FLAG\_PASSIVE](api-flags.md) is the only service-specific flag used by the WinINet functions.</span></span> <span data-ttu-id="91967-229">Этот флаг можно задать, если тип службы — INTERNET \_ Service \_ FTP, чтобы использовать пассивную семантику FTP.</span><span class="sxs-lookup"><span data-stu-id="91967-229">This flag can be set when the service type is INTERNET\_SERVICE\_FTP in order to use passive FTP semantics.</span></span>

<span data-ttu-id="91967-230">Для всех синхронных операций значение *двконтекст* должно быть равно нулю.</span><span class="sxs-lookup"><span data-stu-id="91967-230">For all synchronous operations, the value of *dwContext* should be set to zero.</span></span> <span data-ttu-id="91967-231">Если асинхронные операции были установлены путем установки флага [ \_ \_ Async Internet Flag](api-flags.md) в вызове [**интернетопен**](/windows/desktop/api/Wininet/nf-wininet-internetopena), для *двконтекст* должно быть задано ненулевое значение.</span><span class="sxs-lookup"><span data-stu-id="91967-231">If asynchronous operations were established by setting the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), a nonzero value should be supplied for *dwContext*.</span></span> <span data-ttu-id="91967-232">Дополнительные сведения об асинхронных операциях см. в разделе [Настройка асинхронных операций](common-functions.md).</span><span class="sxs-lookup"><span data-stu-id="91967-232">For more information on asynchronous operations, see [Setting Up Asynchronous Operations](common-functions.md).</span></span>

<span data-ttu-id="91967-233">Для сеансов FTP [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) пытается установить подключение к серверу в Интернете.</span><span class="sxs-lookup"><span data-stu-id="91967-233">For FTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tries to establish a connection to the server on the Internet.</span></span> <span data-ttu-id="91967-234">Для сеансов HTTP [**интернетконнект**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) не устанавливает соединение, пока другая функция не попытается получить информацию с сервера.</span><span class="sxs-lookup"><span data-stu-id="91967-234">For HTTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not establish a connection until another function attempts to get information from the server.</span></span>

> [!Note]  
> <span data-ttu-id="91967-235">WinINet не поддерживает реализации серверов.</span><span class="sxs-lookup"><span data-stu-id="91967-235">WinINet does not support server implementations.</span></span> <span data-ttu-id="91967-236">Кроме того, его не следует использовать из службы.</span><span class="sxs-lookup"><span data-stu-id="91967-236">In addition, it should not be used from a service.</span></span> <span data-ttu-id="91967-237">Для серверных реализаций или служб используйте [службы Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="91967-237">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

