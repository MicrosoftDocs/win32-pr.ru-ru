---
title: расширенную защиту
description: Расширенная защита — это механизм для привязки внешнего безопасного канала, такого как SSL к протоколам проверки подлинности внутреннего канала, таким как Kerberos-АПРЕК и проверка подлинности заголовка HTTP.
ms.assetid: 35e48846-05e5-4db9-a3b5-098b62815b66
keywords:
- Встроенная поддержка расширенной защиты — веб-службы
- ввсапи
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 895bdfecf994f6673c2ed7e7367bc3a7b5bd70c9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105681478"
---
# <a name="extended-protection"></a><span data-ttu-id="3053d-106">расширенную защиту</span><span class="sxs-lookup"><span data-stu-id="3053d-106">Extended Protection</span></span>

<span data-ttu-id="3053d-107">Расширенная защита — это механизм для привязки внешнего безопасного канала, такого как SSL к протоколам проверки подлинности внутреннего канала, таким как Kerberos-АПРЕК и проверка подлинности заголовка HTTP.</span><span class="sxs-lookup"><span data-stu-id="3053d-107">Extended protection is a mechanism to bind an outer secure channel such as SSL to inner channel authentication protocols such as Kerberos-APREQ and HTTP header authentication.</span></span>

<span data-ttu-id="3053d-108">Понятие расширенной защиты определяется в RFC2743.</span><span class="sxs-lookup"><span data-stu-id="3053d-108">The concept of extended protection is defined in RFC2743.</span></span>

<span data-ttu-id="3053d-109">Расширенная защита, если она доступна, настраивается на клиенте автоматически, но может потребовать настройки на сервере для сценариев, не заносящихся по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="3053d-109">Extended protection, when available, is configured automatically on the client but may require configuration on the server for non-default scenarios.</span></span>

## <a name="supported-configurations"></a><span data-ttu-id="3053d-110">Поддерживаемые конфигурации</span><span class="sxs-lookup"><span data-stu-id="3053d-110">Supported Configurations</span></span>

<span data-ttu-id="3053d-111">Расширенная защита поддерживается при использовании [**\_ \_ \_ привязки канала WS HTTP**](/windows/desktop/api/WebServices/ne-webservices-ws_channel_binding) с привязками безопасности с помощью встроенных протоколов проверки подлинности Windows, таких как [**\_ \_ \_ \_ \_ Привязка безопасности HTTP-заголовка**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) Authentication и [**\_ \_ \_ \_ \_ Привязка безопасности сообщений WS Kerberos апрек**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding).</span><span class="sxs-lookup"><span data-stu-id="3053d-111">Extended protection is supported when using [**WS\_HTTP\_CHANNEL\_BINDING**](/windows/desktop/api/WebServices/ne-webservices-ws_channel_binding) with security bindings using Windows Integrated Authentication protocols such as [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) and [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding).</span></span> <span data-ttu-id="3053d-112">Он настраивается с помощью следующих [**свойств безопасности**](/windows/desktop/api/WebServices/ns-webservices-ws_security_property):</span><span class="sxs-lookup"><span data-stu-id="3053d-112">It is configured via the following [**security properties**](/windows/desktop/api/WebServices/ns-webservices-ws_security_property):</span></span>

-   [<span data-ttu-id="3053d-113">**\_ \_ \_ Расширенная \_ Политика защиты в свойстве WS Security \_**</span><span class="sxs-lookup"><span data-stu-id="3053d-113">**WS\_SECURITY\_PROPERTY\_EXTENDED\_PROTECTION\_POLICY**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)
-   [<span data-ttu-id="3053d-114">**\_ \_ \_ сценарий расширенной \_ защиты свойства WS Security \_**</span><span class="sxs-lookup"><span data-stu-id="3053d-114">**WS\_SECURITY\_PROPERTY\_EXTENDED\_PROTECTION\_SCENARIO**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)
-   [<span data-ttu-id="3053d-115">**\_ \_ \_ удостоверения службы свойств безопасности \_ WS**</span><span class="sxs-lookup"><span data-stu-id="3053d-115">**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)

<span data-ttu-id="3053d-116">Возможны следующие конфигурации, включающие расширенную защиту:</span><span class="sxs-lookup"><span data-stu-id="3053d-116">The following configurations involving extended protection are possible:</span></span>

<span data-ttu-id="3053d-117">Клиент</span><span class="sxs-lookup"><span data-stu-id="3053d-117">Client</span></span>

-   <span data-ttu-id="3053d-118">[**Служба WS \_ \_ \_ \_ Привязка безопасности транспорта SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) используется с привязкой безопасности [**\_ сообщений WS Kerberos \_ апрек \_ \_ \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) или [**с \_ \_ \_ \_ защитой \_ аутентификации HTTP-заголовка WS**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding).</span><span class="sxs-lookup"><span data-stu-id="3053d-118">[**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) is used with [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) or [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding).</span></span> <span data-ttu-id="3053d-119">В этой конфигурации привязка проверки подлинности привязана к SSL-соединению через маркер расширенной защиты, который автоматически извлекается из SSL-соединения.</span><span class="sxs-lookup"><span data-stu-id="3053d-119">In this configuration the authentication binding is bound to the SSL connection via an extended protection token that is automatically extracted from the SSL connection.</span></span>
-   <span data-ttu-id="3053d-120">SSL не используется, и задается [**\_ \_ \_ \_ \_ Привязка безопасности HTTP-заголовка WS**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) .</span><span class="sxs-lookup"><span data-stu-id="3053d-120">No SSL is used and [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) is set.</span></span> <span data-ttu-id="3053d-121">Привязка проверки подлинности привязана через имя участника на сервере (SPN), которое аутонатикалли определено [**по \_ \_ адресу конечной точки WS**](/windows/desktop/api/WebServices/ns-webservices-ws_endpoint_address).</span><span class="sxs-lookup"><span data-stu-id="3053d-121">The authentication binding is bound via the Server Principal Name (SPN), which is autonatically determined from the [**WS\_ENDPOINT\_ADDRESS**](/windows/desktop/api/WebServices/ns-webservices-ws_endpoint_address).</span></span>

<span data-ttu-id="3053d-122">Сервер</span><span class="sxs-lookup"><span data-stu-id="3053d-122">Server</span></span>

-   <span data-ttu-id="3053d-123">[**Служба WS \_ \_ \_ \_ Привязка безопасности транспорта SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) используется с привязкой безопасности [**\_ сообщений WS Kerberos \_ апрек \_ \_ \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) или [**с \_ \_ \_ \_ защитой \_ аутентификации HTTP-заголовка WS**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding).</span><span class="sxs-lookup"><span data-stu-id="3053d-123">[**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) is used with [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) or [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding).</span></span> <span data-ttu-id="3053d-124">В этой конфигурации привязка проверки подлинности привязана к SSL-соединению через маркер расширенной защиты, который извлекается из SSL-соединения и проверяется автоматически.</span><span class="sxs-lookup"><span data-stu-id="3053d-124">In this configuration the authentication binding is bound to the SSL connection via an extended protection token that is extracted from the SSL connection and validated automatically.</span></span>
-   <span data-ttu-id="3053d-125">SSL не используется, и задается [**\_ \_ \_ \_ \_ Привязка безопасности HTTP-заголовка WS**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) .</span><span class="sxs-lookup"><span data-stu-id="3053d-125">No SSL is used and [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) is set.</span></span> <span data-ttu-id="3053d-126">Привязка проверки подлинности привязана через имя участника-пользователя (SPN), которое должно быть предоставлено с помощью [**\_ \_ \_ \_ удостоверений службы свойств безопасности WS**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id).</span><span class="sxs-lookup"><span data-stu-id="3053d-126">The authentication binding is bound via the Server Principal Name (SPN), which must be provided via [**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id).</span></span> <span data-ttu-id="3053d-127">При получении сообщения имя участника-службы извлекается и проверяется на предмет точного соответствия с указанными именами служб.</span><span class="sxs-lookup"><span data-stu-id="3053d-127">When a message is received, the SPN is extracted and validated for an exact match with the provided service names.</span></span> <span data-ttu-id="3053d-128">Не предоставляя имена участников-служб — это эквивалентно настройке [**\_ расширенной \_ \_ политики \_ защиты WS**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy).</span><span class="sxs-lookup"><span data-stu-id="3053d-128">Not providing SPNs is the equivalent of setting [**WS\_EXTENDED\_PROTECTION\_POLICY\_NEVER**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy).</span></span>
-   <span data-ttu-id="3053d-129">SSL не используется, указан [**\_ \_ \_ \_ связанный \_ сервер для сценария расширенной защиты WS**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) и [**используется \_ \_ \_ \_ \_ Привязка безопасности сообщений WS Kerberos апрек**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) .</span><span class="sxs-lookup"><span data-stu-id="3053d-129">No SSL is used, [**WS\_EXTENDED\_PROTECTION\_SCENARIO\_BOUND\_SERVER**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) is specified and [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) is used.</span></span> <span data-ttu-id="3053d-130">В этой конфигурации не следует задавать [**\_ \_ \_ \_ удостоверения службы свойств безопасности WS**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) .</span><span class="sxs-lookup"><span data-stu-id="3053d-130">In this configuration, [**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) must not be set.</span></span> <span data-ttu-id="3053d-131">Проверка имени участника-службы не выполняется помимо того, что выполняется в рамках протокола Kerberos.</span><span class="sxs-lookup"><span data-stu-id="3053d-131">No SPN check is performed beyond what is done as part of the Kerberos protocol.</span></span>
-   <span data-ttu-id="3053d-132">[**Служба WS \_ Задано \_ \_ \_ Завершение сценария \_ расширенной защиты**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) , и используется привязка безопасности [**сообщений WS \_ Kerberos \_ Апрек \_ \_ \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) или [**\_ \_ \_ \_ \_ привязок безопасности HTTP-заголовка WS**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) .</span><span class="sxs-lookup"><span data-stu-id="3053d-132">[**WS\_EXTENDED\_PROTECTION\_SCENARIO\_TERMINATED\_SSL**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) is specified and either [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) or [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) is used.</span></span> <span data-ttu-id="3053d-133">[**Служба WS \_ Должны быть заданы \_ \_ \_ удостоверения службы свойств безопасности**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) .</span><span class="sxs-lookup"><span data-stu-id="3053d-133">[**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) must be set.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="3053d-134">Поддерживаемые платформы</span><span class="sxs-lookup"><span data-stu-id="3053d-134">Supported Platforms</span></span>

<span data-ttu-id="3053d-135">Расширенная защита поддерживается на платформах с поддержкой этой функции в операционной системе.</span><span class="sxs-lookup"><span data-stu-id="3053d-135">Extended protection is supported on platforms with support for it in the operating system.</span></span> <span data-ttu-id="3053d-136">Windows 7 и Windows Server 2008 R2 предоставляют встроенную поддержку.</span><span class="sxs-lookup"><span data-stu-id="3053d-136">Windows 7 and Windows Server 2008 R2 provide built-in support.</span></span> <span data-ttu-id="3053d-137">Для других платформ может потребоваться обновление.</span><span class="sxs-lookup"><span data-stu-id="3053d-137">Other platforms may require an update.</span></span>

<span data-ttu-id="3053d-138">Если операционная система сервера не обеспечивает такую поддержку, все сведения о расширенной защите, отправленные клиентом, игнорируются.</span><span class="sxs-lookup"><span data-stu-id="3053d-138">If the server's operating system does not provide such support, any extended protection information sent by the client is ignored.</span></span> <span data-ttu-id="3053d-139">В результате клиенты, использующие расширенную защиту, могут взаимодействовать с таким сервером, но преимущество безопасности теряется.</span><span class="sxs-lookup"><span data-stu-id="3053d-139">As a result, clients using extended protection can communicate with such a server, but the security benefit is lost.</span></span> <span data-ttu-id="3053d-140">На клиенте [**\_ \_ \_ \_ \_ Привязка безопасности сообщений WS Kerberos апрек**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) , Объединенная с [**\_ \_ \_ \_ привязкой безопасности транспорта WS SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) , поддерживает только расширенную защиту в Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="3053d-140">On the client, [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) combined with [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) only supports extended protection on Vista and above.</span></span>

<span data-ttu-id="3053d-141">Примечание. Расширенная защита недоступна, не запрещает использование какой бы то ни было конкретной конфигурации.</span><span class="sxs-lookup"><span data-stu-id="3053d-141">NOTE: Extended protection being unavailable does not prevent any particular configuration from being used.</span></span>

## <a name="interoperability"></a><span data-ttu-id="3053d-142">Совместимость</span><span class="sxs-lookup"><span data-stu-id="3053d-142">Interoperability</span></span>

<span data-ttu-id="3053d-143">Сервер, настроенный по умолчанию, может взаимодействовать с клиентами SOAP независимо от того, использует ли они расширенную защиту или нет.</span><span class="sxs-lookup"><span data-stu-id="3053d-143">A default-configured server can communicate with SOAP clients regardless of whether they use extended protection or not.</span></span> <span data-ttu-id="3053d-144">Единственным исключением являются клиенты Windows XP и Windows Server 2003 ВВСАПИ, которые были обновлены для поддержки расширенной защиты и используют привязку [**\_ \_ \_ \_ безопасности \_ сообщений WS Kerberos Апрек**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) и [**\_ \_ \_ \_ привязку безопасности транспорта WS SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding).</span><span class="sxs-lookup"><span data-stu-id="3053d-144">The one exception being Windows XP and Windows Server 2003 WWSAPI clients that have been updated to support extended protection and use both [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) and [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding).</span></span> <span data-ttu-id="3053d-145">Для поддержки таких клиентов [**\_ политика расширенной \_ защиты WS \_ \_ не**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy) должна быть указана сервером.</span><span class="sxs-lookup"><span data-stu-id="3053d-145">To support such clients [**WS\_EXTENDED\_PROTECTION\_POLICY\_NEVER**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy) must be specified by the server.</span></span> <span data-ttu-id="3053d-146">Серверы, настроенные с помощью **\_ политики расширенной защиты WS, \_ \_ \_ всегда** будут отклонять связь с клиентами, которые не используют расширенную защиту.</span><span class="sxs-lookup"><span data-stu-id="3053d-146">Servers configured with **WS\_EXTENDED\_PROTECTION\_POLICY\_ALWAYS** will reject communication from clients that do not use extended protection.</span></span> <span data-ttu-id="3053d-147">На клиенте **\_ \_ \_ \_ \_ Привязка безопасности сообщений WS Kerberos апрек** , Объединенная с **\_ \_ \_ \_ привязкой безопасности транспорта WS SSL** , приведет к отправке сообщения с использованием кодирования передачи фрагмента HTTP в Vista и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="3053d-147">On the client, **WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING** combined with **WS\_SSL\_TRANSPORT\_SECURITY\_BINDING** will result in the message being sent using the HTTP chunked transfer encoding on Vista and above.</span></span> <span data-ttu-id="3053d-148">Это может вызвать проблемы взаимодействия с серверами, которые не поддерживают поблочную пересылку.</span><span class="sxs-lookup"><span data-stu-id="3053d-148">This may cause interop issues with servers that do not support chunked transfer.</span></span>

<span data-ttu-id="3053d-149">Следующие перечисления/константы являются частью расширенной защиты:</span><span class="sxs-lookup"><span data-stu-id="3053d-149">The following Enums/Constants are part of extended protection:</span></span>

-   [<span data-ttu-id="3053d-150">**\_Расширенная \_ Политика защиты WS \_**</span><span class="sxs-lookup"><span data-stu-id="3053d-150">**WS\_EXTENDED\_PROTECTION\_POLICY**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy)
-   [<span data-ttu-id="3053d-151">**\_сценарий расширенной \_ защиты WS \_**</span><span class="sxs-lookup"><span data-stu-id="3053d-151">**WS\_EXTENDED\_PROTECTION\_SCENARIO**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario)

<span data-ttu-id="3053d-152">Следующие структуры являются частью расширенной защиты:</span><span class="sxs-lookup"><span data-stu-id="3053d-152">The following stuctures are part of extended protection:</span></span>

-   [<span data-ttu-id="3053d-153">**\_ \_ удостоверения безопасности службы \_ WS**</span><span class="sxs-lookup"><span data-stu-id="3053d-153">**WS\_SERVICE\_SECURITY\_IDENTITIES**</span></span>](/windows/desktop/api/WebServices/ns-webservices-ws_service_security_identities)

 

 




