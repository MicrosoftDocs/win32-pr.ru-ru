---
title: Примеры уровней каналов безопасности
description: В следующих примерах демонстрируется безопасность на уровне канала.
ms.assetid: ac4f0275-4783-411d-98da-2c5a1a169dcc
keywords:
- Примеры безопасности
- Примеры безопасности, Настройка
- ввсапи
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4b1283339b1a4af624e118e3f6c76a07449f9274
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105700619"
---
# <a name="security-channel-layer-examples"></a><span data-ttu-id="235b3-107">Примеры уровней каналов безопасности</span><span class="sxs-lookup"><span data-stu-id="235b3-107">Security Channel Layer Examples</span></span>

<span data-ttu-id="235b3-108">В следующих примерах демонстрируется безопасность на [уровне канала](channel-layer-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="235b3-108">The following examples illustrate security in the [Channel Layer](channel-layer-overview.md)</span></span>

<span data-ttu-id="235b3-109">Безопасность транспорта Windows через TCP: Клиент: [рекуестреплиткпклиентвисвиндовстранспортсекуритексампле](requestreplytcpclientwithwindowstransportsecurityexample.md), сервер: [рекуестреплиткпсервервисвиндовстранспортсекуритексампле](requestreplytcpserverwithwindowstransportsecurityexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-109">Windows transport security over TCP: Client: [RequestReplyTcpClientWithWindowsTransportSecurityExample](requestreplytcpclientwithwindowstransportsecurityexample.md), Server: [RequestReplyTcpServerWithWindowsTransportSecurityExample](requestreplytcpserverwithwindowstransportsecurityexample.md).</span></span>

<span data-ttu-id="235b3-110">Безопасность транспорта Windows через именованные каналы: Клиент: [рекуестреплинамедпипесклиентвисвиндовстранспортсекуритексампле](requestreplynamedpipesclientwithwindowstransportsecurityexample.md), сервер: [рекуестреплинамедпипессервервисвиндовстранспортсекуритексампле](requestreplynamedpipesserverwithwindowstransportsecurityexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-110">Windows transport security over named pipes: Client: [RequestReplyNamedPipesClientWithWindowsTransportSecurityExample](requestreplynamedpipesclientwithwindowstransportsecurityexample.md), Server: [RequestReplyNamedPipesServerWithWindowsTransportSecurityExample](requestreplynamedpipesserverwithwindowstransportsecurityexample.md).</span></span>

<span data-ttu-id="235b3-111">Безопасность транспорта SSL: Клиент: [хттпклиентвиссслексампле](httpclientwithsslexample.md), сервер: [хттпсервервиссслексампле](httpserverwithsslexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-111">SSL transport security: Client: [HttpClientWithSslExample](httpclientwithsslexample.md), Server: [HttpServerWithSslExample](httpserverwithsslexample.md).</span></span>

<span data-ttu-id="235b3-112">Имя пользователя для смешанного режима безопасности SSL: Клиент: [хттпклиентвисусернамеоверсслексампле](httpclientwithusernameoversslexample.md), сервер: [хттпсервервисусернамеоверсслексампле](httpserverwithusernameoversslexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-112">Username over SSL mixed-mode security: Client: [HttpClientWithUsernameOverSslExample](httpclientwithusernameoversslexample.md), Server: [HttpServerWithUsernameOverSslExample](httpserverwithusernameoversslexample.md).</span></span>

<span data-ttu-id="235b3-113">Имя пользователя для смешанного режима безопасности SSL: Клиент: [хттпклиентвискерберосоверсслексампле](httpclientwithkerberosoversslexample.md), сервер: [хттпсервервискерберосоверсслексампле](httpserverwithkerberosoversslexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-113">Username over SSL mixed-mode security: Client: [HttpClientWithKerberosOverSslExample](httpclientwithkerberosoversslexample.md), Server: [HttpServerWithKerberosOverSslExample](httpserverwithkerberosoversslexample.md).</span></span>

<span data-ttu-id="235b3-114">Имя пользователя в смешанном режиме безопасности SSL: [метадатаимпортвисусернамеоверсслексампле](metadataimportwithusernameoversslexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-114">Username over SSL mixed-mode security: [MetadataImportWithUsernameOverSslExample](metadataimportwithusernameoversslexample.md).</span></span> <span data-ttu-id="235b3-115">Выданный маркер по безопасности смешанного режима SSL: [метадатаимпортвисиссуедтокеноверсслексампле](metadataimportwithissuedtokenoversslexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-115">Issued token over SSL mixed-mode security: [MetadataImportWithIssuedTokenOverSslExample](metadataimportwithissuedtokenoversslexample.md).</span></span> <span data-ttu-id="235b3-116">Сертификат X509 в смешанном режиме безопасности SSL: [MetadataImportWithX509OverSslExample](metadataimportwithx509oversslexample.md).</span><span class="sxs-lookup"><span data-stu-id="235b3-116">X509 certificate over SSL mixed-mode security: [MetadataImportWithX509OverSslExample](metadataimportwithx509oversslexample.md).</span></span>

## <a name="one-time-setup-for-security-samples"></a><span data-ttu-id="235b3-117">One-Time установки для примеров безопасности</span><span class="sxs-lookup"><span data-stu-id="235b3-117">One-Time Setup for Security Samples</span></span>

<span data-ttu-id="235b3-118">Для запуска примеров безопасности ВВСАПИ необходимо настроить сертификаты клиента и сервера для SSL, а также локальную учетную запись пользователя для проверки подлинности заголовка HTTP.</span><span class="sxs-lookup"><span data-stu-id="235b3-118">To run WWSAPI security examples, you need to set up the client and server certificates for SSL, as well as a local user account for HTTP header authentication.</span></span> <span data-ttu-id="235b3-119">Перед началом работы необходимы следующие средства:</span><span class="sxs-lookup"><span data-stu-id="235b3-119">Before you start, you need the following tools:</span></span>

-   <span data-ttu-id="235b3-120">MakeCert.exe (доступно в пакете SDK для Windows 7.)</span><span class="sxs-lookup"><span data-stu-id="235b3-120">MakeCert.exe (Available in the Windows 7 SDK.)</span></span>
-   <span data-ttu-id="235b3-121">CertUtil.exe или CertMgr.exe (CertUtil.exe доступен в Windows SDK, начиная с Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="235b3-121">CertUtil.exe or CertMgr.exe (CertUtil.exe is available in the Windows SDKs starting with Windows Server 2003.</span></span> <span data-ttu-id="235b3-122">CertMgr.exe доступен в пакете SDK для Windows 7.</span><span class="sxs-lookup"><span data-stu-id="235b3-122">CertMgr.exe is available in the Windows 7 SDK.</span></span> <span data-ttu-id="235b3-123">Вам нужен только один из этих средств.)</span><span class="sxs-lookup"><span data-stu-id="235b3-123">You only need one of these tools.)</span></span>
-   <span data-ttu-id="235b3-124">HttpCfg.exe: (это необходимо, только если вы используете Windows 2003 или Windows XP.</span><span class="sxs-lookup"><span data-stu-id="235b3-124">HttpCfg.exe: (You need this only if you are using Windows 2003 or Windows XP.</span></span> <span data-ttu-id="235b3-125">Это средство доступно в средствах поддержки Windows XP SP2, а также на компакт-диске Windows Server 2003 Resource Kit Tools.)</span><span class="sxs-lookup"><span data-stu-id="235b3-125">This tool is available in Windows XP SP2 Support Tools and also comes with the Windows Server 2003 Resource Kit Tools CD.)</span></span>

<span data-ttu-id="235b3-126">Если вы получаете примеры ВВСАПИ, установив пакет SDK для Windows 7, можно найти MakeCert.exe и CertMgr.exe в разделе% ProgramFiles% \\ Microsoft SDKs \\ Windows \\ v 7.0 \\ bin.</span><span class="sxs-lookup"><span data-stu-id="235b3-126">If you get the WWSAPI examples by installing the Windows 7 SDK, you can find the MakeCert.exe and CertMgr.exe under %ProgramFiles%\\Microsoft SDKs\\Windows\\v7.0\\bin.</span></span>

<span data-ttu-id="235b3-127">Выполните следующие пять шагов установки из командной строки (с повышенными правами при использовании Windows Vista и более поздних версий):</span><span class="sxs-lookup"><span data-stu-id="235b3-127">Perform the following five-step setup from the command prompt (elevated if you are using Windows Vista and above):</span></span>

1.  <span data-ttu-id="235b3-128">Создайте самозаверяющий сертификат в качестве центра сертификации (ЦС) или издателя: **MakeCert.exe-SS root-SR-n "CN = имитировать-Test-Калифорния"-CY Authority-r-SK "какэйконтаинер"**</span><span class="sxs-lookup"><span data-stu-id="235b3-128">Generate a self-signed certificate to be the certificate authority (CA) or issuer: **MakeCert.exe -ss Root -sr LocalMachine -n "CN=Fake-Test-CA" -cy authority -r -sk "CAKeyContainer"**</span></span>
2.  <span data-ttu-id="235b3-129">Создайте сертификат сервера, используя предыдущий сертификат в качестве издателя: **MakeCert.exe-SS My-SR LocalMachine-n "CN = localhost"-Небесный Exchange-является корневым-IR хранилище LocalMachine-in-тест-CA-SK "серверкэйконтаинер"**</span><span class="sxs-lookup"><span data-stu-id="235b3-129">Generate a server certificate using the previous certificate as the issuer: **MakeCert.exe -ss My -sr LocalMachine -n "CN=localhost" -sky exchange -is Root -ir LocalMachine -in Fake-Test-CA -sk "ServerKeyContainer"**</span></span>
3.  <span data-ttu-id="235b3-130">Найдите отпечаток (40-символьный хэш SHA-1) сертификата сервера, выполнив одну из приведенных ниже команд и выполнив поиск сертификата с именем localhost с помощью команды Issuer-тест-CA:</span><span class="sxs-lookup"><span data-stu-id="235b3-130">Find the thumbprint (a 40-character SHA-1 hash) of the server certificate by running either of the following commands and search for the certificate named localhost with issuer Fake-Test-CA:</span></span>
    -   <span data-ttu-id="235b3-131">**CertUtil.exe — сохранить мое localhost**</span><span class="sxs-lookup"><span data-stu-id="235b3-131">**CertUtil.exe -store My localhost**</span></span>
    -   <span data-ttu-id="235b3-132">**CertMgr.exe-s-r LocalMachine My**</span><span class="sxs-lookup"><span data-stu-id="235b3-132">**CertMgr.exe -s -r LocalMachine My**</span></span>
4.  <span data-ttu-id="235b3-133">Зарегистрируйте сертификат сервера? s отпечаток без пробелов с HTTP.SYS:</span><span class="sxs-lookup"><span data-stu-id="235b3-133">Register the server certificate?s thumbprint with no spaces with HTTP.SYS:</span></span>
    -   <span data-ttu-id="235b3-134">В Windows Vista и более поздних версиях (параметр AppID является произвольным GUID): **Netsh.exe http add sslcert иппорт = 0.0.0.0:8443 AppID = {00112233-4455-6677-8899-AABBCCDDEEFF}** certhash =<40CharacterThumbprint></span><span class="sxs-lookup"><span data-stu-id="235b3-134">On Windows Vista and above (the "appid" option is an arbitrary GUID): **Netsh.exe http add sslcert ipport=0.0.0.0:8443 appid={00112233-4455-6677-8899-AABBCCDDEEFF}** certhash=<40CharacterThumbprint></span></span>
    -   <span data-ttu-id="235b3-135">В Windows XP или 2003: **HttpCfg.exe Set SSL-i 0.0.0.0:8443-h <40CharacterThumbprint>**</span><span class="sxs-lookup"><span data-stu-id="235b3-135">On Windows XP or 2003: **HttpCfg.exe set ssl -i 0.0.0.0:8443 -h <40CharacterThumbprint>**</span></span>
5.  <span data-ttu-id="235b3-136">Создание локального пользователя: **net user "тестусерфорбасикаус" "TstPWD@ \* 4Bsic"/Add**</span><span class="sxs-lookup"><span data-stu-id="235b3-136">Create a local user: **Net user "TestUserForBasicAuth" "TstPWD@\*4Bsic" /add**</span></span>

<span data-ttu-id="235b3-137">Чтобы очистить сертификаты, привязку SSL-сертификата и учетную запись пользователя, созданную на предыдущих шагах, выполните следующие команды.</span><span class="sxs-lookup"><span data-stu-id="235b3-137">To clean up the certificates, SSL certificate binding and the user account created in the previous steps, run the following commands.</span></span> <span data-ttu-id="235b3-138">Обратите внимание, что при наличии нескольких сертификатов с одинаковыми именами CertMgr.exe потребуется ввести их перед их удалением.</span><span class="sxs-lookup"><span data-stu-id="235b3-138">Note if there are multiple certificates of the same name, CertMgr.exe will need your input before deleting them.</span></span>

-   <span data-ttu-id="235b3-139">**CertMgr.exe-del-c-n поддельный-Test-CA-s-корневой узел LocalMachine**</span><span class="sxs-lookup"><span data-stu-id="235b3-139">**CertMgr.exe -del -c -n Fake-Test-CA -s -r LocalMachine Root**</span></span>
-   <span data-ttu-id="235b3-140">**CertMgr.exe-del-c-n localhost-s-r LocalMachine My**</span><span class="sxs-lookup"><span data-stu-id="235b3-140">**CertMgr.exe -del -c -n localhost -s -r LocalMachine My**</span></span>
-   <span data-ttu-id="235b3-141">**Netsh.exe HTTP DELETE sslcert иппорт = 0.0.0.0:8443 (или HttpCfg.exe удалить SSL-i 0.0.0.0:8443)**</span><span class="sxs-lookup"><span data-stu-id="235b3-141">**Netsh.exe http delete sslcert ipport=0.0.0.0:8443 (or HttpCfg.exe delete ssl -i 0.0.0.0:8443)**</span></span>
-   <span data-ttu-id="235b3-142">**NET User "Тестусерфорбасикаус"/Delete**</span><span class="sxs-lookup"><span data-stu-id="235b3-142">**Net user "TestUserForBasicAuth" /delete**</span></span>

<span data-ttu-id="235b3-143">Убедитесь, что существует только один корневой сертификат с именем "фальшивый — тест-CA".</span><span class="sxs-lookup"><span data-stu-id="235b3-143">Make sure there is only one root certificate named Fake-Test-CA.</span></span> <span data-ttu-id="235b3-144">Если вы не уверены, в этом случае всегда можно попробовать очистить эти сертификаты с помощью приведенных выше команд очистки (и пропускать ошибки) перед запуском 5-шаговой установки.</span><span class="sxs-lookup"><span data-stu-id="235b3-144">If you are unsure, it?s always safe to try to clean up these certificates using the cleanup commands above (and ignore errors) before starting the five-step setup.</span></span>

 

 




