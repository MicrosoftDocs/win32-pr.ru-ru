---
description: В этом разделе описывается, как можно работать с международными доменными именами (IDNs) в приложениях.
ms.assetid: e0ca356e-f8c1-4845-ae1e-ce2ae8987515
title: Обработка международных доменных имен (IDNs)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 95e853f0ea3f62fc3e5ee848431417cc031eaa5a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104265426"
---
# <a name="handling-internationalized-domain-names-idns"></a><span data-ttu-id="d7402-103">Обработка международных доменных имен (IDNs)</span><span class="sxs-lookup"><span data-stu-id="d7402-103">Handling Internationalized Domain Names (IDNs)</span></span>

<span data-ttu-id="d7402-104">В этом разделе описывается, как можно работать с международными доменными именами (IDNs) в приложениях.</span><span class="sxs-lookup"><span data-stu-id="d7402-104">This topic describes how you can work with internationalized domain names (IDNs) in your applications.</span></span> <span data-ttu-id="d7402-105">IDNs указаны в сетевой рабочей группе [RFC 3490: Интернатионализинг Domain Names in Applications (IDNA)](http://www.faqs.org/rfcs/rfc3490.html).</span><span class="sxs-lookup"><span data-stu-id="d7402-105">IDNs are specified by Network Working Group [RFC 3490: Internationalizing Domain Names in Applications (IDNA)](http://www.faqs.org/rfcs/rfc3490.html).</span></span> <span data-ttu-id="d7402-106">До этого черновой версии IDNs были ограничены восточноазиатскими символами без диакритических знаков.</span><span class="sxs-lookup"><span data-stu-id="d7402-106">Prior to this draft standard, IDNs were limited to Latin characters without diacritics.</span></span> <span data-ttu-id="d7402-107">IDNA позволяет IDNs включать латинские символы с диакритическими знаками, а также символы из нелатинских алфавитов, таких как кириллица, арабский и китайский.</span><span class="sxs-lookup"><span data-stu-id="d7402-107">IDNA allows IDNs to include Latin characters with diacritics, along with characters from non-Latin scripts, such as Cyrillic, Arabic, and Chinese.</span></span> <span data-ttu-id="d7402-108">Стандарт также устанавливает правила сопоставления IDNs с доменными именами только для ASCII.</span><span class="sxs-lookup"><span data-stu-id="d7402-108">The standard also establishes rules for mapping IDNs to ASCII-only domain names.</span></span> <span data-ttu-id="d7402-109">Поэтому проблемы IDNA можно обрабатывать на стороне клиента, не требуя изменения сервера доменных имен (DNS).</span><span class="sxs-lookup"><span data-stu-id="d7402-109">Thus, IDNA issues can be handled on the client side, without requiring any domain name server (DNS) changes.</span></span>

> [!Caution]  
> <span data-ttu-id="d7402-110">В RFC 3490 введен ряд проблем безопасности, связанных с использованием IDNs.</span><span class="sxs-lookup"><span data-stu-id="d7402-110">RFC 3490 introduces a number of security issues related to the use of IDNs.</span></span> <span data-ttu-id="d7402-111">Дополнительные сведения см. в соответствующем разделе [вопросов безопасности: международные функции](security-considerations--international-features.md).</span><span class="sxs-lookup"><span data-stu-id="d7402-111">For more information see the related section of [Security Considerations: International Features](security-considerations--international-features.md).</span></span>

 

> [!Note]  
> <span data-ttu-id="d7402-112">В настоящее время IDNA основывается на Unicode 3,2.</span><span class="sxs-lookup"><span data-stu-id="d7402-112">IDNA is currently based on Unicode 3.2.</span></span>

 

## <a name="nls-api-functions-for-handling-idns"></a><span data-ttu-id="d7402-113">Функции API NLS для обработки IDNs</span><span class="sxs-lookup"><span data-stu-id="d7402-113">NLS API Functions for Handling IDNs</span></span>

<span data-ttu-id="d7402-114">NLS включает следующие функции преобразования, которые приложение может использовать для преобразования IDN в различные представления.</span><span class="sxs-lookup"><span data-stu-id="d7402-114">NLS includes the following conversion functions that your application can use to convert an IDN to different representations.</span></span> <span data-ttu-id="d7402-115">Пример использования этих функций см. в разделе [NLS: международного доменного имени (IDN)](nls--internationalized-domain-name--idn--conversion-sample.md).</span><span class="sxs-lookup"><span data-stu-id="d7402-115">For an example of the use of these functions, see [NLS: Internationalized Domain Name (IDN) Conversion Sample](nls--internationalized-domain-name--idn--conversion-sample.md).</span></span>

-   <span data-ttu-id="d7402-116">[**ИднтоасЦии**](/windows/desktop/api/Winnls/nf-winnls-idntoascii).</span><span class="sxs-lookup"><span data-stu-id="d7402-116">[**IdnToAscii**](/windows/desktop/api/Winnls/nf-winnls-idntoascii).</span></span> <span data-ttu-id="d7402-117">Преобразует IDN в Punycode.</span><span class="sxs-lookup"><span data-stu-id="d7402-117">Converts an IDN to Punycode.</span></span>
-   <span data-ttu-id="d7402-118">[**Иднтонамепрепуникоде**](/windows/desktop/api/Winnls/nf-winnls-idntonameprepunicode).</span><span class="sxs-lookup"><span data-stu-id="d7402-118">[**IdnToNameprepUnicode**](/windows/desktop/api/Winnls/nf-winnls-idntonameprepunicode).</span></span> <span data-ttu-id="d7402-119">Выполняет Намепреп часть преобразования IDN в имя ASCII.</span><span class="sxs-lookup"><span data-stu-id="d7402-119">Performs the NamePrep portion of the conversion of an IDN to an ASCII name.</span></span> <span data-ttu-id="d7402-120">Эта функция создает каноническое представление строки в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="d7402-120">This function creates a canonical Unicode representation of a string.</span></span>
-   <span data-ttu-id="d7402-121">[**Иднтауникоде**](/windows/desktop/api/Winnls/nf-winnls-idntounicode).</span><span class="sxs-lookup"><span data-stu-id="d7402-121">[**IdnToUnicode**](/windows/desktop/api/Winnls/nf-winnls-idntounicode).</span></span> <span data-ttu-id="d7402-122">Преобразует строку Punycode в обычную строку UTF-16.</span><span class="sxs-lookup"><span data-stu-id="d7402-122">Converts a Punycode string to a normal UTF-16 string.</span></span>

<span data-ttu-id="d7402-123">NLS также определяет несколько функций API, которые можно использовать для устранения некоторых угроз безопасности, предоставляемых технологией IDN.</span><span class="sxs-lookup"><span data-stu-id="d7402-123">NLS also defines several API functions that can be used to mitigate some of the security risks presented by the IDN technology.</span></span> <span data-ttu-id="d7402-124">В Windows Vista и более поздних версиях следующие функции используются для проверки того, что символы в заданном IDN были полностью выведены из сценариев, связанных с определенным языковым стандартом или региональными стандартами.</span><span class="sxs-lookup"><span data-stu-id="d7402-124">On Windows Vista and later, the following functions are used to verify that the characters in a given IDN are drawn entirely from the scripts associated with a particular locale or locales.</span></span> <span data-ttu-id="d7402-125">Пример использования этих функций см. в разделе [NLS — пример Межязыкового доменного имени (IDN)](nls--internationalized-domain-name--idn--mitigation-sample.md).</span><span class="sxs-lookup"><span data-stu-id="d7402-125">For an example of the use of these functions, see [NLS: Internationalized Domain Name (IDN) Mitigation Sample](nls--internationalized-domain-name--idn--mitigation-sample.md).</span></span>

-   <span data-ttu-id="d7402-126">[**Жетстрингскриптс**](/windows/desktop/api/Winnls/nf-winnls-getstringscripts).</span><span class="sxs-lookup"><span data-stu-id="d7402-126">[**GetStringScripts**](/windows/desktop/api/Winnls/nf-winnls-getstringscripts).</span></span> <span data-ttu-id="d7402-127">Предоставляет список скриптов, используемых в определенной строке.</span><span class="sxs-lookup"><span data-stu-id="d7402-127">Provides a list of scripts used in a particular string.</span></span>
-   <span data-ttu-id="d7402-128">[**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa), [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex).</span><span class="sxs-lookup"><span data-stu-id="d7402-128">[**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa), [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex).</span></span> <span data-ttu-id="d7402-129">Получение сведений о языковых стандартах.</span><span class="sxs-lookup"><span data-stu-id="d7402-129">Retrieve locale information.</span></span> <span data-ttu-id="d7402-130">Использование функций с *LCType* , установленным в [locale \_ сскриптс](locale-sscripts.md) , предоставляет список сценариев, которые обычно используются для определенного языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="d7402-130">Using the functions with *LCType* set to [LOCALE\_SSCRIPTS](locale-sscripts.md) provides a list of scripts normally used for a particular locale.</span></span>
-   <span data-ttu-id="d7402-131">[**Верифискриптс**](/windows/desktop/api/Winnls/nf-winnls-verifyscripts).</span><span class="sxs-lookup"><span data-stu-id="d7402-131">[**VerifyScripts**](/windows/desktop/api/Winnls/nf-winnls-verifyscripts).</span></span> <span data-ttu-id="d7402-132">Сравнивает списки скриптов.</span><span class="sxs-lookup"><span data-stu-id="d7402-132">Compares lists of scripts.</span></span> <span data-ttu-id="d7402-133">Чтобы проверить несколько языковых стандартов, приложение может выполнить несколько вызовов [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) или [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) и [**верифискриптс**](/windows/desktop/api/Winnls/nf-winnls-verifyscripts).</span><span class="sxs-lookup"><span data-stu-id="d7402-133">To verify against multiple locales, the application can make multiple calls to [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) or [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) and [**VerifyScripts**](/windows/desktop/api/Winnls/nf-winnls-verifyscripts).</span></span>

<span data-ttu-id="d7402-134">Для приложений, работающих в Windows XP и Windows Server 2003, функции [**довнлевелжетлокалескриптс**](downlevelgetlocalescripts.md), [**довнлевелжетстрингскриптс**](downlevelgetstringscripts.md)и [**довнлевелверифискриптс**](downlevelverifyscripts.md) играют аналогичную роль в перечисленных выше функциях в целях уменьшения угроз безопасности.</span><span class="sxs-lookup"><span data-stu-id="d7402-134">For applications that run on Windows XP and Windows Server 2003, the functions [**DownlevelGetLocaleScripts**](downlevelgetlocalescripts.md), [**DownlevelGetStringScripts**](downlevelgetstringscripts.md), and [**DownlevelVerifyScripts**](downlevelverifyscripts.md) play a similar role to the functions listed above in mitigating security risk.</span></span> <span data-ttu-id="d7402-135">Загружаемые [API-интерфейсы Microsoft для международного доменного имени (IDN) по устранению проблем](https://www.microsoft.com/downloads/details.aspx?FamilyID=AD6158D7-DDBA-416A-9109-07607425A815&displaylang=en) доступны в [центре загрузки MSDN](https://www.microsoft.com/?ref=go).</span><span class="sxs-lookup"><span data-stu-id="d7402-135">The ["Microsoft Internationalized Domain Name (IDN) Mitigation APIs"](https://www.microsoft.com/downloads/details.aspx?FamilyID=AD6158D7-DDBA-416A-9109-07607425A815&displaylang=en) download is available at the [MSDN Download Center](https://www.microsoft.com/?ref=go).</span></span>

## <a name="handle-unicode-strings"></a><span data-ttu-id="d7402-136">Обрабатывайте строки в Юникоде</span><span class="sxs-lookup"><span data-stu-id="d7402-136">Handle Unicode Strings</span></span>

<span data-ttu-id="d7402-137">IDNA поддерживает преобразование строк Юникода в допустимые метки имен узлов, за исключением строк, содержащих определенные запрещенные символы, такие как управляющие символы, символы из закрытой области использования (PUA) и т. д.</span><span class="sxs-lookup"><span data-stu-id="d7402-137">IDNA supports the transformation of Unicode strings into legitimate host name labels, with the exception of strings containing certain prohibited characters, such as control characters, characters from the private use area (PUA), and the like.</span></span> <span data-ttu-id="d7402-138">Приложение может использовать \_ \_ \_ правила STD3 ASCII \_ с флагами с несколькими функциями преобразования NLS для принудительного сбоя функций, если они обнаруживают символы ASCII, отличные от букв, цифр или знаков дефиса (-), или если строка начинается или заканчивается символом дефиса-минуса.</span><span class="sxs-lookup"><span data-stu-id="d7402-138">Your application can use the IDN\_USE\_STD3\_ASCII\_RULES flag with several NLS conversion functions to force the functions to fail if they encounter ASCII characters other than letters, numbers, or the hyphen-minus (-) character, or if a string begins or ends with the hyphen-minus character.</span></span> <span data-ttu-id="d7402-139">Эти символы всегда запрещено использовать в доменных именах и остаются запрещенными в стандартном черном варианте.</span><span class="sxs-lookup"><span data-stu-id="d7402-139">These characters have always been prohibited from use in domain names, and remain prohibited in the draft standard.</span></span>

## <a name="handle-unassigned-code-points"></a><span data-ttu-id="d7402-140">Обработку неназначенных кодовых точек</span><span class="sxs-lookup"><span data-stu-id="d7402-140">Handle Unassigned Code Points</span></span>

<span data-ttu-id="d7402-141">IDNs не может содержать неназначенные кодовые точки.</span><span class="sxs-lookup"><span data-stu-id="d7402-141">IDNs cannot contain unassigned code points.</span></span> <span data-ttu-id="d7402-142">Таким образом, кодовые точки, не связанные с символом ("назначено") в Юникоде 3,2, не имеют определенных сопоставлений IDN, несмотря на то, что в \_ \_ некоторых функциях преобразования флаг IDN РАЗРЕШАЕТ неназначенные значения, позволяющий сопоставлять их с Punycode.</span><span class="sxs-lookup"><span data-stu-id="d7402-142">Therefore, code points that are not associated with a character ("assigned") as of Unicode 3.2 do not have defined IDN mappings, even though the IDN\_ALLOW\_UNASSIGNED flag in certain conversion functions allows them to be mapped to Punycode.</span></span> <span data-ttu-id="d7402-143">Список неназначенных кодовых точек можно найти в [RFC 3454](http://www.faqs.org/rfcs/rfc3454.html).</span><span class="sxs-lookup"><span data-stu-id="d7402-143">You can find a list of unassigned code points in [RFC 3454](http://www.faqs.org/rfcs/rfc3454.html).</span></span>

> [!Caution]  
> <span data-ttu-id="d7402-144">Если приложение кодирует неназначенные кодовые точки как Punycode, результирующие имена доменов должны быть недопустимыми.</span><span class="sxs-lookup"><span data-stu-id="d7402-144">If your application encodes unassigned code points as Punycode, the resulting domain names should be illegal.</span></span> <span data-ttu-id="d7402-145">Безопасность может быть скомпрометирована, если более поздняя версия IDNA делает эти имена юридическими или если приложение отфильтровывает недопустимые символы, чтобы попытаться создать юридическое имя домена.</span><span class="sxs-lookup"><span data-stu-id="d7402-145">Security can be compromised if a later version of IDNA makes these names legal or if the application filters out the illegal characters to try to create a legal domain name.</span></span>

 

<span data-ttu-id="d7402-146">Неназначенные кодовые точки не допускаются в хранимых строках, используемых в идентификаторах протоколов и именованных сущностях, таких как имена в цифровых сертификатах и компонентах доменных имен DNS.</span><span class="sxs-lookup"><span data-stu-id="d7402-146">Unassigned code points are not allowed in the stored strings used in protocol identifiers and named entities, such as names in digital certificates and DNS domain name parts.</span></span> <span data-ttu-id="d7402-147">Однако кодовые точки разрешены в строках запроса, например, в именах, вводимых пользователем, для цифровых сертификатов и поисков DNS, которые используются для сопоставления с хранимыми идентификаторами.</span><span class="sxs-lookup"><span data-stu-id="d7402-147">However, the code points are allowed in query strings, for example, user-entered names for digital certificate authorities and DNS lookups, which are used to match against stored identifiers.</span></span>

> [!Caution]  
> <span data-ttu-id="d7402-148">Хотя строки запросов могут использовать неназначенные кодовые точки, их не следует использовать в приложениях.</span><span class="sxs-lookup"><span data-stu-id="d7402-148">Although query strings can use unassigned code points, you should not use them in your applications.</span></span> <span data-ttu-id="d7402-149">Даже строка запроса, предоставляемая пользователем, представляет собой риск атаки "подмена".</span><span class="sxs-lookup"><span data-stu-id="d7402-149">Even a user-supplied query string presents a risk of a "spoofing" attack.</span></span> <span data-ttu-id="d7402-150">При таком типе атак сайт узла неразборчивые перенаправляет пользователей с сайта, к которому они обращаются, к другому сайту, который может предоставить третьим лицам конфиденциальную информацию.</span><span class="sxs-lookup"><span data-stu-id="d7402-150">In this type of attack, the unscrupulous host site reroutes users from the site they intend to access to another site that might provide sensitive information to a third party.</span></span> <span data-ttu-id="d7402-151">Например, копирование строки из входящей электронной почты может представлять те же риски, что и щелчок по ссылке в браузере.</span><span class="sxs-lookup"><span data-stu-id="d7402-151">For example, copying a string from an incoming e-mail can present the same risks as clicking on a link in a browser.</span></span>

 

## <a name="convert-domain-names-to-ascii-names"></a><span data-ttu-id="d7402-152">Преобразование доменных имен в имена ASCII</span><span class="sxs-lookup"><span data-stu-id="d7402-152">Convert Domain Names to ASCII Names</span></span>

<span data-ttu-id="d7402-153">Приложение может использовать функцию [**иднтоасЦии**](/windows/desktop/api/Winnls/nf-winnls-idntoascii) и некоторые функции по устранению рисков для преобразования IDNS в ASCII.</span><span class="sxs-lookup"><span data-stu-id="d7402-153">Your application can use the [**IdnToAscii**](/windows/desktop/api/Winnls/nf-winnls-idntoascii) function and certain mitigation functions to convert IDNs to ASCII.</span></span>

> [!Caution]  
> <span data-ttu-id="d7402-154">Поскольку строки с очень разными двоичными представлениями могут сравниваться одинаково, эта функция может вызывать определенные проблемы безопасности.</span><span class="sxs-lookup"><span data-stu-id="d7402-154">Because strings with very different binary representations can compare as identical, this function can raise certain security concerns.</span></span> <span data-ttu-id="d7402-155">Дополнительные сведения см. в обсуждении функций сравнения в статье [вопросы безопасности: международные функции](security-considerations--international-features.md).</span><span class="sxs-lookup"><span data-stu-id="d7402-155">For more information, see the discussion of comparison functions in [Security Considerations: International Features](security-considerations--international-features.md).</span></span>

 

## <a name="examples"></a><span data-ttu-id="d7402-156">Примеры</span><span class="sxs-lookup"><span data-stu-id="d7402-156">Examples</span></span>

<span data-ttu-id="d7402-157">В [примере преобразования NLS: международного доменного имени (IDN)](nls--internationalized-domain-name--idn--conversion-sample.md) демонстрируется использование функций преобразования IDN.</span><span class="sxs-lookup"><span data-stu-id="d7402-157">[NLS: Internationalized Domain Name (IDN) Conversion Sample](nls--internationalized-domain-name--idn--conversion-sample.md) demonstrates the use of the IDN conversion functions.</span></span> <span data-ttu-id="d7402-158">В [примере защиты NLS: международного доменного имени (IDN)](nls--internationalized-domain-name--idn--mitigation-sample.md) показано использование функций предотвращения использования IDN.</span><span class="sxs-lookup"><span data-stu-id="d7402-158">[NLS: Internationalized Domain Name (IDN) Mitigation Sample](nls--internationalized-domain-name--idn--mitigation-sample.md) demonstrates the use of the IDN mitigation functions.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d7402-159">См. также</span><span class="sxs-lookup"><span data-stu-id="d7402-159">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d7402-160">Поддержка национальных языков</span><span class="sxs-lookup"><span data-stu-id="d7402-160">Using National Language Support</span></span>](using-national-language-support.md)
</dt> <dt>

[<span data-ttu-id="d7402-161">Вопросы безопасности: международные функции</span><span class="sxs-lookup"><span data-stu-id="d7402-161">Security Considerations: International Features</span></span>](security-considerations--international-features.md)
</dt> </dl>

 

 



