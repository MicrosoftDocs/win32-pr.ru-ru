---
description: Приложения записывают символы, определенные конечным пользователем (Еудкс) и область частного использования (PUA), на экран или на принтер, как при написании других символов, используя функции вывода, такие как текст и ExtTextOut.
ms.assetid: c975c70d-4231-4a69-bec2-d51d6993fdd4
title: Запись, сопоставление и сортировка EUDC и PUA символов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a6c34264d956bb6a87407e249f68b2bc03fb2c99
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263113"
---
# <a name="writing-mapping-and-sorting-eudc-and-pua-characters"></a><span data-ttu-id="a6fa3-103">Запись, сопоставление и сортировка EUDC и PUA символов</span><span class="sxs-lookup"><span data-stu-id="a6fa3-103">Writing, Mapping, and Sorting EUDC and PUA Characters</span></span>

<span data-ttu-id="a6fa3-104">Приложения записывают символы, определенные конечным пользователем (Еудкс) и область частного использования (PUA), на экран или на принтер, как при написании других символов, используя функции вывода, такие как [текст](/windows/win32/api/wingdi/nf-wingdi-textouta) и [ExtTextOut](/windows/win32/api/wingdi/nf-wingdi-exttextouta).</span><span class="sxs-lookup"><span data-stu-id="a6fa3-104">Applications write end-user-defined characters (EUDCs) and private use area (PUA) characters to the screen or printer just as they write other characters, by using output functions such as [TextOut](/windows/win32/api/wingdi/nf-wingdi-textouta) and [ExtTextOut](/windows/win32/api/wingdi/nf-wingdi-exttextouta).</span></span> <span data-ttu-id="a6fa3-105">Эти функции автоматически извлекают символьные данные из шрифтов EUDC или PUA, если включен EUDC.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-105">These functions automatically retrieve character information from EUDC or PUA character fonts if EUDC is enabled.</span></span> <span data-ttu-id="a6fa3-106">Дополнительные сведения см. в разделе [ \_ пользовательские и закрытые символы области использования](end-user-defined-characters.md).</span><span class="sxs-lookup"><span data-stu-id="a6fa3-106">For more information, see [End-User\_Defined and Private Use Area Characters](end-user-defined-characters.md).</span></span>

<span data-ttu-id="a6fa3-107">При написании символов Еудкс или PUA операция функции вывода текста зависит от текущего выбранного шрифта.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-107">When writing EUDCs or PUA characters, the operation of the text output function depends on the currently selected font.</span></span> <span data-ttu-id="a6fa3-108">Если выбранный шрифт является встроенным символьным шрифтом EUDC или PUA, функция получает символьную информацию из этого шрифта.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-108">If the selected font is an integrated EUDC or PUA character font, the function retrieves character information from that font.</span></span> <span data-ttu-id="a6fa3-109">Если выбранный шрифт представляет собой шрифт [с двухбайтовой кодировкой (DBCS](double-byte-character-sets.md) ) TrueType, имеющий связанный отдельный шрифт EUDC, функция получает сведения из УКАЗАННОГО шрифта EUDC.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-109">If the selected font is a [double-byte character set](double-byte-character-sets.md) (DBCS) TrueType font that has an associated separate EUDC font, the function retrieves information from the specified EUDC font.</span></span> <span data-ttu-id="a6fa3-110">Аналогично, если выбранный шрифт является шрифтом [Юникода](unicode.md) TrueType с соответствующим отдельным шрифтом PUA символов, функция получает информацию из шрифта PUA символов.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-110">Similarly, if the selected font is a [Unicode](unicode.md) TrueType font that has an associated separate PUA character font, the function retrieves information from the PUA character font.</span></span> <span data-ttu-id="a6fa3-111">Если у выбранного шрифта нет соответствующего символьного шрифта EUDC или PUA, функция получает сведения из системного шрифта EUDC по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-111">If the selected font does not have an associated EUDC or PUA character font, the function retrieves information from the system default EUDC font.</span></span> <span data-ttu-id="a6fa3-112">Если символ отсутствует в системном шрифте EUDC по умолчанию или отсутствует системный шрифт EUDC по умолчанию, функция записывает символ по умолчанию, определенный выбранным шрифтом.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-112">If the character is not in the system default EUDC font or there is no system default EUDC font, the function writes the default character defined by the selected font.</span></span>

<span data-ttu-id="a6fa3-113">Приложения могут сопоставлять Еудкс с Юникод и обратно с помощью функций [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) и [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) .</span><span class="sxs-lookup"><span data-stu-id="a6fa3-113">Applications can map EUDCs to and from Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) and [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) functions.</span></span> <span data-ttu-id="a6fa3-114">Функция **MultiByteToWideChar** сопоставляет большинство еудкс с символами в PUAе Юникода.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-114">The **MultiByteToWideChar** function maps most EUDCs to characters in the Unicode PUA.</span></span> <span data-ttu-id="a6fa3-115">Однако для поддержки определенных национальных или региональных стандартов некоторые Еудкс могут быть сопоставлены с кодовыми позициями, отличными от PUA Юникода.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-115">However, to support certain national or regional standards, some EUDCs can be mapped to non-PUA Unicode code points.</span></span> <span data-ttu-id="a6fa3-116">Функция **WideCharToMultiByte** сопоставляет символ в PUA с его аналогом EUDC, если такое сопоставление существует и если кодовая точка не имеет допустимого СОПОСТАВЛЕНИЯ без PUA в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-116">The **WideCharToMultiByte** function maps a character in the PUA to its EUDC counterpart, if such a mapping exists and if the code point does not have a valid non-PUA mapping in Unicode.</span></span> <span data-ttu-id="a6fa3-117">Не все кодовые страницы имеют диапазон EUDC.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-117">Not all code pages have an EUDC range.</span></span> <span data-ttu-id="a6fa3-118">Кодовая страница, указанная в вызове **WideCharToMultiByte** , должна содержать диапазон кода EUDC для сопоставления с диапазоном EUDC.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-118">The code page specified in a call to **WideCharToMultiByte** must contain an EUDC code range for the mapping to the EUDC range to occur.</span></span> <span data-ttu-id="a6fa3-119">Если кодовая страница не содержит диапазон кода EUDC, функция получает символ по умолчанию для любых символов в PUAе Юникода.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-119">If the code page does not contain an EUDC code range, the function retrieves the default character for any characters in the Unicode PUA.</span></span>

<span data-ttu-id="a6fa3-120">[**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) и [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) не гарантируют сопоставление круговых поездок.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-120">[**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) and [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) do not guarantee round-trip mapping.</span></span> <span data-ttu-id="a6fa3-121">Иными словами, можно начать с определенной многобайтовой строки, содержащей Еудкс, преобразовать строку в Юникод с помощью **MultiByteToWideChar** и снова соотнести ее с исходной кодировкой DBCS с **WideCharToMultiByte**, а затем получить результат, который не идентичен исходной строке.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-121">In other words, it is possible to start with a particular multibyte string containing EUDCs, map the string to Unicode with **MultiByteToWideChar** and map it back to the original DBCS with **WideCharToMultiByte**, and end up with a result that is not identical to the original string.</span></span> <span data-ttu-id="a6fa3-122">Приложения, использующие сопоставление Еудкс с Юникодом, должны гарантировать, что все необходимые символы могут циклически переойти между соответствующей областью кодовой страницы EUDC и PUAом Юникода.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-122">Applications relying on mapping EUDCs to Unicode should ensure that all necessary characters can round-trip between the appropriate code page EUDC area and the Unicode PUA.</span></span>

<span data-ttu-id="a6fa3-123">Приложения не должны пытаться сопоставлять Еудкс из одной кодовой страницы в другую.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-123">Applications should not attempt to map EUDCs from one code page to another.</span></span> <span data-ttu-id="a6fa3-124">Если приложение начинается с EUDC с одной кодовой страницы, сопоставляется с Юникодом с помощью [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar)и сопоставляется с другой кодировкой DBCS с [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte), нет никаких гарантий относительно результатов.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-124">If an application starts with an EUDC from one code page, maps it to Unicode with [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar), and maps to a different DBCS with [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte), there are no guarantees about the results.</span></span> <span data-ttu-id="a6fa3-125">Исходный символ может быть сопоставлен с другим EUDC в кодовой странице назначения, или же он может быть сопоставлен как неопределенный символ.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-125">The original character might be mapped to a different EUDC in the destination code page, or it might be mapped as an undefined character.</span></span> <span data-ttu-id="a6fa3-126">Аналогичным образом, сопоставление строки Юникода с кодовой страницей, имеющей диапазон EUDC, может иметь непредвиденные результаты.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-126">Similarly, mapping a Unicode string to a code page that has an EUDC range can have unintended results.</span></span> <span data-ttu-id="a6fa3-127">Если строка Юникода содержит PUA кодовую точку, возможно, что кодовая точка будет сопоставлена с EUDC, которая не представляет один и тот же символ.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-127">If the Unicode string contains a PUA code point, it is possible that the code point will be mapped to an EUDC that does not represent the same character.</span></span>

<span data-ttu-id="a6fa3-128">Приложения могут сравнивать строки DBCS, содержащие Еудкс, с помощью версии ANSI функции [CompareString](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) .</span><span class="sxs-lookup"><span data-stu-id="a6fa3-128">Applications can compare DBCS strings that contain EUDCs by using the ANSI version of the [CompareString](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) function.</span></span> <span data-ttu-id="a6fa3-129">Функция фактически сопоставляет символы в Юникоде перед сравнением символьных значений.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-129">The function effectively maps the characters to Unicode before comparing character values.</span></span> <span data-ttu-id="a6fa3-130">Приложения могут создать ключ сортировки для строки с помощью версии ANSI функции [**LCMapString завершилось ошибкой**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) и \_ значения лкмап SORTKEY.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-130">Applications can create a sort key for the string by using the ANSI version of the [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) function and the LCMAP\_SORTKEY value.</span></span> <span data-ttu-id="a6fa3-131">Эта функция фактически сопоставляет символы в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-131">This function effectively maps characters to Unicode first.</span></span> <span data-ttu-id="a6fa3-132">Все символы в PUA сортируются после всех остальных символов Юникода.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-132">All characters in the PUA are sorted after all other Unicode characters.</span></span> <span data-ttu-id="a6fa3-133">Внутри области символы сортируются в числовом порядке.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-133">Within the area, characters are sorted in numerical order.</span></span> <span data-ttu-id="a6fa3-134">Если приложение пытается получить сведения о CTYPE для EUDC с помощью функции [жетстрингтипеа](/windows/desktop/api/Winnls/nf-winnls-getstringtypea) , функция получает **значение NULL** для каждого символа.</span><span class="sxs-lookup"><span data-stu-id="a6fa3-134">If an application attempts to retrieve CTYPE information for an EUDC by using the [GetStringTypeA](/windows/desktop/api/Winnls/nf-winnls-getstringtypea) function, the function retrieves **NULL** for each character.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a6fa3-135">См. также</span><span class="sxs-lookup"><span data-stu-id="a6fa3-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a6fa3-136">Использование Юникода и кодировок</span><span class="sxs-lookup"><span data-stu-id="a6fa3-136">Using Unicode and Character Sets</span></span>](using-unicode-and-character-sets.md)
</dt> </dl>

 

 
