---
description: В этом разделе описываются различия между строковыми функциями, используемыми для обработки сведений о кодировке Юникод и кодировке. Эти функции имеют как реализации кодовых страниц в Юникоде, так и Windows для поддержки параметров кодовой страницы в Юникоде и Windows.
ms.assetid: 52a15957-b44b-49ba-b915-e5c8e003a7e6
title: Различия строковых функций
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad0c940aa8be1603f7958fb1993cc521ca7b1ed7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103991539"
---
# <a name="string-function-differences"></a><span data-ttu-id="39b41-104">Различия строковых функций</span><span class="sxs-lookup"><span data-stu-id="39b41-104">String Function Differences</span></span>

<span data-ttu-id="39b41-105">В этом разделе описываются различия между строковыми функциями, используемыми для обработки сведений о кодировке Юникод и кодировке.</span><span class="sxs-lookup"><span data-stu-id="39b41-105">This topic describes differences among string functions used in handling Unicode and character set information.</span></span> <span data-ttu-id="39b41-106">Эти функции имеют как реализации [кодовых страниц](code-pages.md) в [Юникоде](unicode.md) , так и Windows для поддержки параметров кодовой страницы в Юникоде и Windows.</span><span class="sxs-lookup"><span data-stu-id="39b41-106">These functions have both [Unicode](unicode.md) and [Windows code page](code-pages.md) implementations to support Unicode and Windows code page parameters.</span></span>

<span data-ttu-id="39b41-107">Для следующих строковых функций не требуется специальный комментарий.</span><span class="sxs-lookup"><span data-stu-id="39b41-107">The following string functions do not require special comment.</span></span> <span data-ttu-id="39b41-108">Реализации кодовых страниц в Юникоде и Windows работают одинаково.</span><span class="sxs-lookup"><span data-stu-id="39b41-108">Their Unicode and Windows code page implementations work identically.</span></span>

-   [<span data-ttu-id="39b41-109">**чарнекст**</span><span class="sxs-lookup"><span data-stu-id="39b41-109">**CharNext**</span></span>](/windows/win32/api/winuser/nf-winuser-charnexta)
-   [<span data-ttu-id="39b41-110">**чарпрев**</span><span class="sxs-lookup"><span data-stu-id="39b41-110">**CharPrev**</span></span>](/windows/win32/api/winuser/nf-winuser-charpreva)
-   <span data-ttu-id="39b41-111">[**Стрингкчкат**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata), [ **стрингкчкатекс**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa)</span><span class="sxs-lookup"><span data-stu-id="39b41-111">[**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata), [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa)</span></span>
-   <span data-ttu-id="39b41-112">[**Стрингкчкопи**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya), [ **стрингкчкопекс**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa)</span><span class="sxs-lookup"><span data-stu-id="39b41-112">[**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya), [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa)</span></span>
-   <span data-ttu-id="39b41-113">[**Стркбленгс**](/windows/win32/api/strsafe/nf-strsafe-stringcblengtha), [ **стркчленгс**](/windows/win32/api/strsafe/nf-strsafe-stringcchlengtha)</span><span class="sxs-lookup"><span data-stu-id="39b41-113">[**StrCbLength**](/windows/win32/api/strsafe/nf-strsafe-stringcblengtha), [**StrCchLength**](/windows/win32/api/strsafe/nf-strsafe-stringcchlengtha)</span></span>

<span data-ttu-id="39b41-114">Значение длины, полученное одной из функций длины строки, всегда основано на обычной ширине символов: 8 бит для кодовых страниц Windows, 16 бит для Юникода.</span><span class="sxs-lookup"><span data-stu-id="39b41-114">The length value retrieved by one of the string length functions is always based on normal character width: 8 bits for Windows code pages, 16 bits for Unicode.</span></span> <span data-ttu-id="39b41-115">Это значение часто называют "количеством символов".</span><span class="sxs-lookup"><span data-stu-id="39b41-115">This value is often referred to as a "count of characters."</span></span> <span data-ttu-id="39b41-116">Этот термин является строго верным, поскольку кодовые страницы Windows, использующие [двухбайтовые](double-byte-character-sets.md) кодировки (DBCS), имеют некоторые полноширинные символы, которые фактически представлены двумя последовательными байтами.</span><span class="sxs-lookup"><span data-stu-id="39b41-116">This term is strictly correct because Windows code pages that use [double-byte character sets](double-byte-character-sets.md) (DBCSs) have some full-width characters that are actually represented by two consecutive bytes.</span></span> <span data-ttu-id="39b41-117">Аналогичная ситуация возникает для [суррогатов](surrogates-and-supplementary-characters.md) в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="39b41-117">A similar situation arises for [surrogates](surrogates-and-supplementary-characters.md) in Unicode.</span></span>

<span data-ttu-id="39b41-118">Следующие строковые функции чувствительны к языковому стандарту текущего потока, производному от выбранного пользователем языка на панели управления.</span><span class="sxs-lookup"><span data-stu-id="39b41-118">The following string functions are sensitive to the locale of the current thread, derived from the language the user selects in the Control Panel.</span></span> <span data-ttu-id="39b41-119">Функции [**лстркмп**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) и [**лстркмпи**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) не выполняют сравнения БАЙТОВ, такие как ANSI намесакес, например [strcmp](/cpp/c-runtime-library/reference/strcmp-wcscmp-mbscmp).</span><span class="sxs-lookup"><span data-stu-id="39b41-119">The [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) and [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) functions do not perform byte comparisons like their ANSI namesakes, for example, [strcmp](/cpp/c-runtime-library/reference/strcmp-wcscmp-mbscmp).</span></span> <span data-ttu-id="39b41-120">Вместо этого они сравнивают строки в соответствии с правилами языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="39b41-120">Instead, they compare strings according to the rules of the locale.</span></span>

-   [<span data-ttu-id="39b41-121">**чарловер**</span><span class="sxs-lookup"><span data-stu-id="39b41-121">**CharLower**</span></span>](/windows/win32/api/winuser/nf-winuser-charlowera)
-   [<span data-ttu-id="39b41-122">**чарловербуфф**</span><span class="sxs-lookup"><span data-stu-id="39b41-122">**CharLowerBuff**</span></span>](/windows/win32/api/winuser/nf-winuser-charlowerbuffa)
-   [<span data-ttu-id="39b41-123">**чаруппер**</span><span class="sxs-lookup"><span data-stu-id="39b41-123">**CharUpper**</span></span>](/windows/win32/api/winuser/nf-winuser-charuppera)
-   [<span data-ttu-id="39b41-124">**чаруппербуфф**</span><span class="sxs-lookup"><span data-stu-id="39b41-124">**CharUpperBuff**</span></span>](/windows/win32/api/winuser/nf-winuser-charupperbuffa)
-   [<span data-ttu-id="39b41-125">**лстркмп**</span><span class="sxs-lookup"><span data-stu-id="39b41-125">**lstrcmp**</span></span>](/windows/win32/api/winbase/nf-winbase-lstrcmpa)
-   [<span data-ttu-id="39b41-126">**лстркмпи**</span><span class="sxs-lookup"><span data-stu-id="39b41-126">**lstrcmpi**</span></span>](/windows/win32/api/winbase/nf-winbase-lstrcmpia)

<span data-ttu-id="39b41-127">Следующие функции преобразуют набор символов OEM и либо текущую кодовую страницу Windows, либо Юникод, в зависимости от используемой версии:</span><span class="sxs-lookup"><span data-stu-id="39b41-127">The following functions convert between the OEM character set and either the current Windows code page or Unicode, depending on which version is used:</span></span>

-   [<span data-ttu-id="39b41-128">**чартуем**</span><span class="sxs-lookup"><span data-stu-id="39b41-128">**CharToOem**</span></span>](/windows/win32/api/winuser/nf-winuser-chartooema)
-   [<span data-ttu-id="39b41-129">**чартуембуфф**</span><span class="sxs-lookup"><span data-stu-id="39b41-129">**CharToOemBuff**</span></span>](/windows/win32/api/winuser/nf-winuser-chartooembuffa)
-   [<span data-ttu-id="39b41-130">**оемточарбуфф**</span><span class="sxs-lookup"><span data-stu-id="39b41-130">**OemToCharBuff**</span></span>](/windows/win32/api/winuser/nf-winuser-oemtocharbuffa)

<span data-ttu-id="39b41-131">Функции печати, например [**стрингкбпринтф**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa), поддерживают Юникод, предоставляя следующие новые и измененные типы данных в спецификациях формата.</span><span class="sxs-lookup"><span data-stu-id="39b41-131">The print functions, for example, [**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa), support Unicode by providing the following new and changed data types in their format specifications.</span></span> <span data-ttu-id="39b41-132">Эти спецификации формата влияют на способ интерпретации соответствующего входного параметра функциями.</span><span class="sxs-lookup"><span data-stu-id="39b41-132">These format specifications affect the way the functions interpret the corresponding input parameter.</span></span>



| <span data-ttu-id="39b41-133">Спецификация формата</span><span class="sxs-lookup"><span data-stu-id="39b41-133">Format specification</span></span> | <span data-ttu-id="39b41-134">Тип данных для версии кодовой страницы Windows</span><span class="sxs-lookup"><span data-stu-id="39b41-134">Data type for Windows code page version</span></span> | <span data-ttu-id="39b41-135">Тип данных для версии Юникода</span><span class="sxs-lookup"><span data-stu-id="39b41-135">Data type for Unicode version</span></span> |
|----------------------|-----------------------------------------|-------------------------------|
| <span data-ttu-id="39b41-136">c</span><span class="sxs-lookup"><span data-stu-id="39b41-136">c</span></span>                    | <span data-ttu-id="39b41-137">CHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-137">CHAR</span></span>                                    | <span data-ttu-id="39b41-138">WCHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-138">WCHAR</span></span>                         |
| <span data-ttu-id="39b41-139">C</span><span class="sxs-lookup"><span data-stu-id="39b41-139">C</span></span>                    | <span data-ttu-id="39b41-140">WCHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-140">WCHAR</span></span>                                   | <span data-ttu-id="39b41-141">CHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-141">CHAR</span></span>                          |
| <span data-ttu-id="39b41-142">HC, hC</span><span class="sxs-lookup"><span data-stu-id="39b41-142">hc, hC</span></span>               | <span data-ttu-id="39b41-143">CHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-143">CHAR</span></span>                                    | <span data-ttu-id="39b41-144">CHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-144">CHAR</span></span>                          |
| <span data-ttu-id="39b41-145">HS, hS</span><span class="sxs-lookup"><span data-stu-id="39b41-145">hs, hS</span></span>               | <span data-ttu-id="39b41-146">LPSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-146">LPSTR</span></span>                                   | <span data-ttu-id="39b41-147">LPSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-147">LPSTR</span></span>                         |
| <span data-ttu-id="39b41-148">LC, lC</span><span class="sxs-lookup"><span data-stu-id="39b41-148">lc, lC</span></span>               | <span data-ttu-id="39b41-149">WCHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-149">WCHAR</span></span>                                   | <span data-ttu-id="39b41-150">WCHAR</span><span class="sxs-lookup"><span data-stu-id="39b41-150">WCHAR</span></span>                         |
| <span data-ttu-id="39b41-151">Ls, lS</span><span class="sxs-lookup"><span data-stu-id="39b41-151">ls, lS</span></span>               | <span data-ttu-id="39b41-152">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-152">LPWSTR</span></span>                                  | <span data-ttu-id="39b41-153">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-153">LPWSTR</span></span>                        |
| <span data-ttu-id="39b41-154">s</span><span class="sxs-lookup"><span data-stu-id="39b41-154">s</span></span>                    | <span data-ttu-id="39b41-155">LPSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-155">LPSTR</span></span>                                   | <span data-ttu-id="39b41-156">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-156">LPWSTR</span></span>                        |
| <span data-ttu-id="39b41-157">S</span><span class="sxs-lookup"><span data-stu-id="39b41-157">S</span></span>                    | <span data-ttu-id="39b41-158">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-158">LPWSTR</span></span>                                  | <span data-ttu-id="39b41-159">LPSTR</span><span class="sxs-lookup"><span data-stu-id="39b41-159">LPSTR</span></span>                         |



 

<span data-ttu-id="39b41-160">Тип данных для выходного текста всегда зависит от версии функции.</span><span class="sxs-lookup"><span data-stu-id="39b41-160">The data type for the output text always depends on the version of the function.</span></span> <span data-ttu-id="39b41-161">Если тип данных входного параметра и тип данных выходного текста не согласуются, функция Print выполняет преобразование из Юникода в текущую кодовую страницу Windows, или наоборот, по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="39b41-161">When the data type of the input parameter and the data type of the output text do not agree, the print function performs a conversion from Unicode to the current Windows code page, or vice versa, as required.</span></span>

<span data-ttu-id="39b41-162">Для версии функции печати, поддерживающей Юникод, строка форматирования имеет формат Юникод, а является выходным текстом.</span><span class="sxs-lookup"><span data-stu-id="39b41-162">For the Unicode version of the print functions, the format string is Unicode, as is the output text.</span></span>

> [!Caution]  
> <span data-ttu-id="39b41-163">Низкая обработка буфера фрагментацией во многих проблемах безопасности, связанных с переполнением буфера.</span><span class="sxs-lookup"><span data-stu-id="39b41-163">Poor buffer handling is implicated in many security issues that involve buffer overruns.</span></span> <span data-ttu-id="39b41-164">См. раздел [Справочник по стрсафе. h](../menurc/strsafe-ovw.md).</span><span class="sxs-lookup"><span data-stu-id="39b41-164">See [Strsafe.h Reference](../menurc/strsafe-ovw.md).</span></span> <span data-ttu-id="39b41-165">Функции, определенные в Стрсафе. h, обеспечивают дополнительную обработку для правильной обработки буфера в коде.</span><span class="sxs-lookup"><span data-stu-id="39b41-165">The functions defined in Strsafe.h provide additional processing for proper buffer handling in your code.</span></span> <span data-ttu-id="39b41-166">По этой причине они предназначены для замены встроенных аналогов C/C++, а также конкретных реализаций Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="39b41-166">For this reason, they are intended to replace their built-in C/C++ counterparts as well as specific Microsoft Windows implementations.</span></span> <span data-ttu-id="39b41-167">Дополнительные сведения см. в разделе [вопросы безопасности: международные функции](security-considerations--international-features.md).</span><span class="sxs-lookup"><span data-stu-id="39b41-167">For more information, see [Security Considerations: International Features](security-considerations--international-features.md).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="39b41-168">См. также</span><span class="sxs-lookup"><span data-stu-id="39b41-168">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="39b41-169">Юникод в Windows API</span><span class="sxs-lookup"><span data-stu-id="39b41-169">Unicode in the Windows API</span></span>](unicode-in-the-windows-api.md)
</dt> </dl>

 

 
