---
description: Чтобы обеспечить обоснование текста, приложение может использовать один из двух методов.
ms.assetid: 1190baed-5959-4f7a-8946-ac3b3da85821
title: Обработка сложных наборов символов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87bea5b75e87afc4177b03c03f4263ba2592a0e0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072707"
---
# <a name="processing-complex-scripts"></a>Обработка сложных наборов символов

Чтобы обеспечить обоснование текста, приложение может использовать один из двух методов. Для простой реализации многоязычного обоснования приложение должно вызвать [**скриптжустифи**](/windows/desktop/api/Usp10/nf-usp10-scriptjustify). Он создает разностный массив DX, учитывая кашиду, межсловные интервалы, а затем межзнаковые интервалы. Для более сложного обоснования приложение может создать обновленный разностный массив DX, используя свои знания языка и сведения, полученные [**скриптшапе**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) в массиве [**\_ висаттр скриптов**](/windows/win32/api/usp10/ns-usp10-script_visattr) .

Необходимо вставить пространство обоснования или кашиды, где определяется элементом **Ужустификатион** [**сценария \_ висаттр**](/windows/win32/api/usp10/ns-usp10-script_visattr). При сопоставлении между символами приложение должно вставлять дополнительное пространство только после глифов, помеченных \_ символом выравнивания сценария \_ .

Приложение выполняет размещение и проверку попадания с помощью [**скрипткстокп**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) и [**скрипткптокс**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox). Дополнительные сведения см. в разделе [Управление размещением курсора и проверкой попадания](managing-caret-placement-and-hit-testing.md).

Чтобы сделать ширину независимым от шрифта, приложение вызывает [**скриптжетлогикалвидсс**](/windows/desktop/api/Usp10/nf-usp10-scriptgetlogicalwidths). Передавая логические значения ширины в [**скриптапплилогикалвидс**](/windows/desktop/api/Usp10/nf-usp10-scriptapplylogicalwidth), можно отобразить блок текста в тех же границах с приемлемой потерей качества, даже если исходный шрифт недоступен. Он создает массив ширины глифов ([ширину](uniscribe-glossary.md)), подходящий для передачи в [**скрипттекстаут**](/windows/desktop/api/Usp10/nf-usp10-scripttextout). Такая запись и повторное применение сведений о ширине аванса независимо от шрифта может быть полезной в таких ситуациях, как метафилинг в формате, определенном приложением.

> [!Note]  
> Метафайлы не поддерживают индексы глифов. Для записи в расширенный метафайл приложение должно использовать [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta) и записывать логические символы напрямую. При использовании этого механизма создание и размещение глифов не происходит до тех пор, пока текст не будет воспроизведен.

 

Чтобы получить конкретные глифы, используемые для текущего шрифта по умолчанию, пробелы, кашиды и т. д., приложение должно вызвать [**скриптжетфонтпропертиес**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties). Чтобы определить, какие символы в запуске поддерживаются выбранным шрифтом, приложение вызывает [**скриптжеткмап**](/windows/desktop/api/Usp10/nf-usp10-scriptgetcmap). Недоступные символы имеют глиф по умолчанию в буфере глифов. Обратите внимание, что этот метод завершается ошибкой, если шрифт подготавливает символ, используя сочетание глифов вместо одного глифа. Например, 00C9; Латинская ПРОПИСная БУКВа E с АКУТОМ может быть визуализирована с помощью глифа в виде прописной буквы E и знака острия. Чтобы определить поддержку шрифта для строки, которая содержит эти виды кодовых точек, приложение может вызвать [**скриптшапе**](/windows/desktop/api/Usp10/nf-usp10-scriptshape). Дополнительные сведения см. [в разделе использование механизмов формирования](using-shaping-engines.md).

Функция [**скрипткачежесеигхт**](/windows/desktop/api/Usp10/nf-usp10-scriptcachegetheight) Возвращает высоту шрифта из кэша шрифтов. [**Скриптжетпропертиес**](/windows/desktop/api/Usp10/nf-usp10-scriptgetproperties) предоставляет сведения об особой обработке, необходимой для всех скриптов, индексируемых по сценарию. Например, он включает основной язык, связанный со сценарием, данные, указывающие, является ли скрипт числовым, и данные, указывающие, является ли скрипт сложным.

[**Скриптжетглифабквидс**](/windows/desktop/api/Usp10/nf-usp10-scriptgetglyphabcwidth) возвращает [ширину ABC](uniscribe-glossary.md) данного глифа, которая может быть полезной для рисования диаграмм глифов. Однако его не следует использовать для обычного форматирования текста сложного скрипта.

## <a name="related-topics"></a>См. также

[Использование Uniscribe](using-uniscribe.md)


 

 
