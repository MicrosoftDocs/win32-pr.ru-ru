---
description: Чтобы обеспечить обоснование текста, приложение может использовать один из двух методов.
ms.assetid: 1190baed-5959-4f7a-8946-ac3b3da85821
title: Обработка сложных наборов символов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87bea5b75e87afc4177b03c03f4263ba2592a0e0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072707"
---
# <a name="processing-complex-scripts"></a><span data-ttu-id="7474f-103">Обработка сложных наборов символов</span><span class="sxs-lookup"><span data-stu-id="7474f-103">Processing Complex Scripts</span></span>

<span data-ttu-id="7474f-104">Чтобы обеспечить обоснование текста, приложение может использовать один из двух методов.</span><span class="sxs-lookup"><span data-stu-id="7474f-104">To provide text justification, an application can use one of two methods.</span></span> <span data-ttu-id="7474f-105">Для простой реализации многоязычного обоснования приложение должно вызвать [**скриптжустифи**](/windows/desktop/api/Usp10/nf-usp10-scriptjustify).</span><span class="sxs-lookup"><span data-stu-id="7474f-105">For a simple implementation of multilingual justification, the application should call [**ScriptJustify**](/windows/desktop/api/Usp10/nf-usp10-scriptjustify).</span></span> <span data-ttu-id="7474f-106">Он создает разностный массив DX, учитывая кашиду, межсловные интервалы, а затем межзнаковые интервалы.</span><span class="sxs-lookup"><span data-stu-id="7474f-106">It generates the delta dx array by considering kashida, then interword spacing, and then intercharacter spacing.</span></span> <span data-ttu-id="7474f-107">Для более сложного обоснования приложение может создать обновленный разностный массив DX, используя свои знания языка и сведения, полученные [**скриптшапе**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) в массиве [**\_ висаттр скриптов**](/windows/win32/api/usp10/ns-usp10-script_visattr) .</span><span class="sxs-lookup"><span data-stu-id="7474f-107">For more sophisticated justification, the application can generate an updated delta dx array using its own language knowledge and the information retrieved by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) in the [**SCRIPT\_VISATTR**](/windows/win32/api/usp10/ns-usp10-script_visattr) array.</span></span>

<span data-ttu-id="7474f-108">Необходимо вставить пространство обоснования или кашиды, где определяется элементом **Ужустификатион** [**сценария \_ висаттр**](/windows/win32/api/usp10/ns-usp10-script_visattr).</span><span class="sxs-lookup"><span data-stu-id="7474f-108">Justification space or kashida should be inserted where identified by the **uJustification** member of [**SCRIPT\_VISATTR**](/windows/win32/api/usp10/ns-usp10-script_visattr).</span></span> <span data-ttu-id="7474f-109">При сопоставлении между символами приложение должно вставлять дополнительное пространство только после глифов, помеченных \_ символом выравнивания сценария \_ .</span><span class="sxs-lookup"><span data-stu-id="7474f-109">When performing inter-character justification, the application should insert extra space only after glyphs marked with SCRIPT\_JUSTIFY\_CHARACTER.</span></span>

<span data-ttu-id="7474f-110">Приложение выполняет размещение и проверку попадания с помощью [**скрипткстокп**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) и [**скрипткптокс**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox).</span><span class="sxs-lookup"><span data-stu-id="7474f-110">The application does caret placement and hit testing by using [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox).</span></span> <span data-ttu-id="7474f-111">Дополнительные сведения см. в разделе [Управление размещением курсора и проверкой попадания](managing-caret-placement-and-hit-testing.md).</span><span class="sxs-lookup"><span data-stu-id="7474f-111">For more information, see [Managing Caret Placement and Hit Testing](managing-caret-placement-and-hit-testing.md).</span></span>

<span data-ttu-id="7474f-112">Чтобы сделать ширину независимым от шрифта, приложение вызывает [**скриптжетлогикалвидсс**](/windows/desktop/api/Usp10/nf-usp10-scriptgetlogicalwidths).</span><span class="sxs-lookup"><span data-stu-id="7474f-112">To get widths in a font-independent manner, the application calls [**ScriptGetLogicalWidths**](/windows/desktop/api/Usp10/nf-usp10-scriptgetlogicalwidths).</span></span> <span data-ttu-id="7474f-113">Передавая логические значения ширины в [**скриптапплилогикалвидс**](/windows/desktop/api/Usp10/nf-usp10-scriptapplylogicalwidth), можно отобразить блок текста в тех же границах с приемлемой потерей качества, даже если исходный шрифт недоступен.</span><span class="sxs-lookup"><span data-stu-id="7474f-113">By passing the logical widths to [**ScriptApplyLogicalWidth**](/windows/desktop/api/Usp10/nf-usp10-scriptapplylogicalwidth), a block of text can be redisplayed in the same boundaries with acceptable loss of quality even when the original font is not available.</span></span> <span data-ttu-id="7474f-114">Он создает массив ширины глифов ([ширину](uniscribe-glossary.md)), подходящий для передачи в [**скрипттекстаут**](/windows/desktop/api/Usp10/nf-usp10-scripttextout).</span><span class="sxs-lookup"><span data-stu-id="7474f-114">It generates an array of glyph widths ([advance widths](uniscribe-glossary.md)) suitable for passing to [**ScriptTextOut**](/windows/desktop/api/Usp10/nf-usp10-scripttextout).</span></span> <span data-ttu-id="7474f-115">Такая запись и повторное применение сведений о ширине аванса независимо от шрифта может быть полезной в таких ситуациях, как метафилинг в формате, определенном приложением.</span><span class="sxs-lookup"><span data-stu-id="7474f-115">Such recording and reapplying of advance width information in a font-independent manner can be useful in situations such as metafiling in an application defined format.</span></span>

> [!Note]  
> <span data-ttu-id="7474f-116">Метафайлы не поддерживают индексы глифов.</span><span class="sxs-lookup"><span data-stu-id="7474f-116">Metafiles do not support glyph indexes.</span></span> <span data-ttu-id="7474f-117">Для записи в расширенный метафайл приложение должно использовать [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta) и записывать логические символы напрямую.</span><span class="sxs-lookup"><span data-stu-id="7474f-117">To write to an enhanced metafile, the application should use [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta) and write the logical characters directly.</span></span> <span data-ttu-id="7474f-118">При использовании этого механизма создание и размещение глифов не происходит до тех пор, пока текст не будет воспроизведен.</span><span class="sxs-lookup"><span data-stu-id="7474f-118">Using this mechanism, the glyph generation and placement does not occur until the text is played back.</span></span>

 

<span data-ttu-id="7474f-119">Чтобы получить конкретные глифы, используемые для текущего шрифта по умолчанию, пробелы, кашиды и т. д., приложение должно вызвать [**скриптжетфонтпропертиес**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties).</span><span class="sxs-lookup"><span data-stu-id="7474f-119">To retrieve the specific glyphs that are used for the default, blanks, kashida, and so forth, for the current font, the application should call [**ScriptGetFontProperties**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties).</span></span> <span data-ttu-id="7474f-120">Чтобы определить, какие символы в запуске поддерживаются выбранным шрифтом, приложение вызывает [**скриптжеткмап**](/windows/desktop/api/Usp10/nf-usp10-scriptgetcmap).</span><span class="sxs-lookup"><span data-stu-id="7474f-120">To determine which characters in a run are supported by the selected font, the application calls [**ScriptGetCMap**](/windows/desktop/api/Usp10/nf-usp10-scriptgetcmap).</span></span> <span data-ttu-id="7474f-121">Недоступные символы имеют глиф по умолчанию в буфере глифов.</span><span class="sxs-lookup"><span data-stu-id="7474f-121">Characters that are not available have the default glyph in the glyph buffer.</span></span> <span data-ttu-id="7474f-122">Обратите внимание, что этот метод завершается ошибкой, если шрифт подготавливает символ, используя сочетание глифов вместо одного глифа.</span><span class="sxs-lookup"><span data-stu-id="7474f-122">Note that this method fails if a font renders a character using a combination of glyphs instead of a single glyph.</span></span> <span data-ttu-id="7474f-123">Например, 00C9; Латинская ПРОПИСная БУКВа E с АКУТОМ может быть визуализирована с помощью глифа в виде прописной буквы E и знака острия.</span><span class="sxs-lookup"><span data-stu-id="7474f-123">For example, 00C9; LATIN CAPITAL LETTER E WITH ACUTE can be rendered using a capital E glyph and an acute glyph.</span></span> <span data-ttu-id="7474f-124">Чтобы определить поддержку шрифта для строки, которая содержит эти виды кодовых точек, приложение может вызвать [**скриптшапе**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="7474f-124">To determine the font support for a string that contains these kinds of code points, the application can call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span> <span data-ttu-id="7474f-125">Дополнительные сведения см. [в разделе использование механизмов формирования](using-shaping-engines.md).</span><span class="sxs-lookup"><span data-stu-id="7474f-125">For more information, see [Using Shaping Engines](using-shaping-engines.md).</span></span>

<span data-ttu-id="7474f-126">Функция [**скрипткачежесеигхт**](/windows/desktop/api/Usp10/nf-usp10-scriptcachegetheight) Возвращает высоту шрифта из кэша шрифтов.</span><span class="sxs-lookup"><span data-stu-id="7474f-126">The [**ScriptCacheGetHeight**](/windows/desktop/api/Usp10/nf-usp10-scriptcachegetheight) function returns the height of the font from the font cache.</span></span> <span data-ttu-id="7474f-127">[**Скриптжетпропертиес**](/windows/desktop/api/Usp10/nf-usp10-scriptgetproperties) предоставляет сведения об особой обработке, необходимой для всех скриптов, индексируемых по сценарию.</span><span class="sxs-lookup"><span data-stu-id="7474f-127">[**ScriptGetProperties**](/windows/desktop/api/Usp10/nf-usp10-scriptgetproperties) provides information on the special processing required for all the scripts, indexed by script.</span></span> <span data-ttu-id="7474f-128">Например, он включает основной язык, связанный со сценарием, данные, указывающие, является ли скрипт числовым, и данные, указывающие, является ли скрипт сложным.</span><span class="sxs-lookup"><span data-stu-id="7474f-128">For example, it includes the primary language associated with the script, data indicating if the script is numeric, and data indicating if the script is a complex script.</span></span>

<span data-ttu-id="7474f-129">[**Скриптжетглифабквидс**](/windows/desktop/api/Usp10/nf-usp10-scriptgetglyphabcwidth) возвращает [ширину ABC](uniscribe-glossary.md) данного глифа, которая может быть полезной для рисования диаграмм глифов.</span><span class="sxs-lookup"><span data-stu-id="7474f-129">[**ScriptGetGlyphABCWidth**](/windows/desktop/api/Usp10/nf-usp10-scriptgetglyphabcwidth) returns the [ABC width](uniscribe-glossary.md) of a given glyph, which might be useful for drawing glyph charts.</span></span> <span data-ttu-id="7474f-130">Однако его не следует использовать для обычного форматирования текста сложного скрипта.</span><span class="sxs-lookup"><span data-stu-id="7474f-130">However, it should not be used for normal complex script text formatting.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7474f-131">См. также</span><span class="sxs-lookup"><span data-stu-id="7474f-131">Related Topics</span></span>

[<span data-ttu-id="7474f-132">Использование Uniscribe</span><span class="sxs-lookup"><span data-stu-id="7474f-132">Using Uniscribe</span></span>](using-uniscribe.md)


 

 
