---
description: '&\# 0034; контекст ввода&\# 0034; является внутренней структурой, поддерживаемой модулем IMM.'
ms.assetid: 2b639e30-5368-45bb-943d-db1ab6b62582
title: Контекст ввода
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 16f1f83a397373e17a7d637b61a3232a3d72acde
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909499"
---
# <a name="input-context"></a><span data-ttu-id="86fcd-103">Контекст ввода</span><span class="sxs-lookup"><span data-stu-id="86fcd-103">Input Context</span></span>

<span data-ttu-id="86fcd-104">"Контекст ввода" — это внутренняя структура, поддерживаемая модулем IMM.</span><span class="sxs-lookup"><span data-stu-id="86fcd-104">An "input context" is an internal structure maintained by the IMM.</span></span> <span data-ttu-id="86fcd-105">Он содержит сведения о состоянии редактора IME и используется окнами IME.</span><span class="sxs-lookup"><span data-stu-id="86fcd-105">It contains information about the status of the IME and is used by IME windows.</span></span> <span data-ttu-id="86fcd-106">По умолчанию операционная система создает и назначает входной контекст каждому потоку.</span><span class="sxs-lookup"><span data-stu-id="86fcd-106">By default, the operating system creates and assigns an input context to each thread.</span></span> <span data-ttu-id="86fcd-107">В потоке этот контекст ввода по умолчанию является общим ресурсом и связан с каждым вновь созданным окном.</span><span class="sxs-lookup"><span data-stu-id="86fcd-107">Within the thread, this default input context is a shared resource and is associated with each newly created window.</span></span>

<span data-ttu-id="86fcd-108">Чтобы получить или задать сведения в IME, приложение, поддерживающее IME, должно сначала получить маркер для входного контекста, связанного с указанным окном.</span><span class="sxs-lookup"><span data-stu-id="86fcd-108">To retrieve or set information in the IME, an IME-aware application must first retrieve a handle to the input context associated with a specified window.</span></span> <span data-ttu-id="86fcd-109">Приложение получает этот обработчик с помощью функции [**иммжетконтекст**](/windows/desktop/api/Imm/nf-imm-immgetcontext) .</span><span class="sxs-lookup"><span data-stu-id="86fcd-109">The application retrieves the handle by using the [**ImmGetContext**](/windows/desktop/api/Imm/nf-imm-immgetcontext) function.</span></span> <span data-ttu-id="86fcd-110">Он может использовать полученный маркер при последующих вызовах функций IMM для получения и установки значений IME, таких как стиль окна композиции, стиль композиции и расположение окна состояния.</span><span class="sxs-lookup"><span data-stu-id="86fcd-110">It can use the retrieved handle in subsequent calls to the IMM functions to retrieve and set IME values, such as the composition window style, the composition style, and the status window position.</span></span> <span data-ttu-id="86fcd-111">После того как приложение завершит работу с контекстом, оно должно освободить контекст с помощью функции [**иммрелеасеконтекст**](/windows/desktop/api/Imm/nf-imm-immreleasecontext) .</span><span class="sxs-lookup"><span data-stu-id="86fcd-111">Once the application has finished using the context, it must release the context using the [**ImmReleaseContext**](/windows/desktop/api/Imm/nf-imm-immreleasecontext) function.</span></span>

<span data-ttu-id="86fcd-112">Поскольку входной контекст по умолчанию является общим ресурсом, любые изменения, вносимые приложением, применяются ко всем окнам в потоке.</span><span class="sxs-lookup"><span data-stu-id="86fcd-112">Because the default input context is a shared resource, any changes the application makes to it apply to all windows in the thread.</span></span> <span data-ttu-id="86fcd-113">Однако приложение может переопределить это поведение по умолчанию, создав собственный контекст ввода и связав его с одним или несколькими окнами потока.</span><span class="sxs-lookup"><span data-stu-id="86fcd-113">However, the application can override this default behavior by creating its own input context and associating it with one or more windows of the thread.</span></span> <span data-ttu-id="86fcd-114">Изменения, внесенные в контекст ввода конкретного приложения, применяются только к окнам, связанным с контекстом.</span><span class="sxs-lookup"><span data-stu-id="86fcd-114">The changes made to an application-specific input context apply only to the windows associated with the context.</span></span>

<span data-ttu-id="86fcd-115">Приложение может создать контекст ввода с помощью функции [**иммкреатеконтекст**](/windows/desktop/api/Imm/nf-imm-immcreatecontext) .</span><span class="sxs-lookup"><span data-stu-id="86fcd-115">Your application can create an input context by using the [**ImmCreateContext**](/windows/desktop/api/Imm/nf-imm-immcreatecontext) function.</span></span> <span data-ttu-id="86fcd-116">Чтобы назначить контекст окну, приложение вызывает функцию [**иммассоЦиатеконтекст**](/windows/desktop/api/Imm/nf-imm-immassociatecontext) .</span><span class="sxs-lookup"><span data-stu-id="86fcd-116">To assign the context to a window, the application calls the [**ImmAssociateContext**](/windows/desktop/api/Imm/nf-imm-immassociatecontext) function.</span></span> <span data-ttu-id="86fcd-117">Эта функция возвращает маркер ранее связанного входного контекста.</span><span class="sxs-lookup"><span data-stu-id="86fcd-117">This function returns a handle to the previously associated input context.</span></span> <span data-ttu-id="86fcd-118">Если приложение еще не сопоставлено входному контексту с окном, возвращаемый обработчик предназначен для входного контекста по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="86fcd-118">If the application has not already associated an input context with the window, the returned handle is for the default input context.</span></span> <span data-ttu-id="86fcd-119">Как правило, приложение сохраняет этот обработчик, а затем повторно связывает его с окном, когда пользовательский контекст больше не нужен.</span><span class="sxs-lookup"><span data-stu-id="86fcd-119">Typically, the application saves this handle and later reassociates it with the window when the customized input context is no longer needed.</span></span>

<span data-ttu-id="86fcd-120">После того как контекст ввода связан с окном, операционная система автоматически выбирает этот контекст при активации окна и получает фокус ввода.</span><span class="sxs-lookup"><span data-stu-id="86fcd-120">Once an input context is associated with a window, the operating system automatically selects that context when the window is activated and receives the input focus.</span></span> <span data-ttu-id="86fcd-121">Стиль и другие сведения во входном контексте влияют на последующий ввод с клавиатуры для этого окна, определяя, как работает редактор IME.</span><span class="sxs-lookup"><span data-stu-id="86fcd-121">The style and other information in the input context affects subsequent keyboard input for that window, determining how the IME operates.</span></span>

<span data-ttu-id="86fcd-122">Приложение должно уничтожить любой настроенный контекст ввода до завершения его работы.</span><span class="sxs-lookup"><span data-stu-id="86fcd-122">Your application must destroy any customized input context before it terminates.</span></span> <span data-ttu-id="86fcd-123">Во первых, приложение удаляет контекст ввода из любой связи, сделанной с Windows в потоке, с помощью функции [**иммассоЦиатеконтекст**](/windows/desktop/api/Imm/nf-imm-immassociatecontext) .</span><span class="sxs-lookup"><span data-stu-id="86fcd-123">First, the application removes the input context from any association it has made with windows in the thread by using the [**ImmAssociateContext**](/windows/desktop/api/Imm/nf-imm-immassociatecontext) function.</span></span> <span data-ttu-id="86fcd-124">Затем вызывается функция [**иммдестройконтекст**](/windows/desktop/api/Imm/nf-imm-immdestroycontext) .</span><span class="sxs-lookup"><span data-stu-id="86fcd-124">Then, it calls the [**ImmDestroyContext**](/windows/desktop/api/Imm/nf-imm-immdestroycontext) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="86fcd-125">См. также</span><span class="sxs-lookup"><span data-stu-id="86fcd-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="86fcd-126">О диспетчере методов ввода</span><span class="sxs-lookup"><span data-stu-id="86fcd-126">About Input Method Manager</span></span>](about-input-method-manager.md)
</dt> </dl>

 

 



