---
description: В этом разделе содержатся сведения о вопросах безопасности, связанных с международными возможностями поддержки.
ms.assetid: 4034f479-ad29-4c6f-82c6-977f420c4d4d
title: 'Вопросы безопасности: международные функции'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aeb9f8b849e9fb1a07f01031832449b9c9027ae5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272813"
---
# <a name="security-considerations-international-features"></a><span data-ttu-id="4a963-103">Вопросы безопасности: международные функции</span><span class="sxs-lookup"><span data-stu-id="4a963-103">Security Considerations: International Features</span></span>

<span data-ttu-id="4a963-104">В этом разделе содержатся сведения о вопросах безопасности, связанных с международными возможностями поддержки.</span><span class="sxs-lookup"><span data-stu-id="4a963-104">This topic provides information about security considerations related to International Support features.</span></span> <span data-ttu-id="4a963-105">Вы можете использовать его в качестве отправной точки, а затем просмотреть документацию по международной технологии, представляющей интерес в отношении безопасности, связанных с конкретными технологиями.</span><span class="sxs-lookup"><span data-stu-id="4a963-105">You can use it as a starting point and then see the documentation for the international technology of interest for technology-specific security considerations.</span></span>

<span data-ttu-id="4a963-106">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="4a963-106">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="4a963-107">Вопросы безопасности для функций преобразования символов</span><span class="sxs-lookup"><span data-stu-id="4a963-107">Security Considerations for Character Conversion Functions</span></span>](#security-considerations-for-character-conversion-functions)
-   [<span data-ttu-id="4a963-108">Вопросы безопасности для функций сравнения</span><span class="sxs-lookup"><span data-stu-id="4a963-108">Security Considerations for Comparison Functions</span></span>](#security-considerations-for-comparison-functions)
-   [<span data-ttu-id="4a963-109">Вопросы безопасности для наборов символов в именах файлов</span><span class="sxs-lookup"><span data-stu-id="4a963-109">Security Considerations for Character Sets in File Names</span></span>](#security-considerations-for-character-sets-in-file-names)
-   [<span data-ttu-id="4a963-110">Вопросы безопасности для международных доменных имен</span><span class="sxs-lookup"><span data-stu-id="4a963-110">Security Considerations for Internationalized Domain Names</span></span>](#security-considerations-for-internationalized-domain-names)
-   [<span data-ttu-id="4a963-111">Вопросы безопасности для функций ANSI</span><span class="sxs-lookup"><span data-stu-id="4a963-111">Security Considerations for ANSI Functions</span></span>](#security-considerations-for-ansi-functions)
-   [<span data-ttu-id="4a963-112">Вопросы безопасности при нормализации Юникода</span><span class="sxs-lookup"><span data-stu-id="4a963-112">Security Considerations for Unicode Normalization</span></span>](#security-considerations-for-unicode-normalization)

## <a name="security-considerations-for-character-conversion-functions"></a><span data-ttu-id="4a963-113">Вопросы безопасности для функций преобразования символов</span><span class="sxs-lookup"><span data-stu-id="4a963-113">Security Considerations for Character Conversion Functions</span></span>

<span data-ttu-id="4a963-114">[**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) и [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) — это функции Юникода и кодировки, наиболее часто используемые для преобразования символов между ANSI и Unicode.</span><span class="sxs-lookup"><span data-stu-id="4a963-114">[**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) and [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) are the Unicode and character set functions most commonly used to convert characters between ANSI and Unicode.</span></span> <span data-ttu-id="4a963-115">Эти функции могут вызвать угрозы безопасности, так как они подсчитывают элементы входных и выходных буферов по-разному.</span><span class="sxs-lookup"><span data-stu-id="4a963-115">These functions have the potential of causing security risks because they count the elements of the input and output buffers differently.</span></span> <span data-ttu-id="4a963-116">Например, [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) получает входной буфер в байтах и преобразует преобразованные символы в размер буфера в символах Юникода.</span><span class="sxs-lookup"><span data-stu-id="4a963-116">For example, [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) takes an input buffer counted in bytes and puts the converted characters into a buffer sized in Unicode characters.</span></span> <span data-ttu-id="4a963-117">Когда приложение использует эту функцию, оно должно правильно изменить размер буферов, чтобы избежать переполнения буфера.</span><span class="sxs-lookup"><span data-stu-id="4a963-117">When your application uses this function, it must size the buffers correctly to avoid a buffer overrun.</span></span>

<span data-ttu-id="4a963-118">[**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) по умолчанию имеет наилучшее сопоставление для кодовых страниц, например 1252.</span><span class="sxs-lookup"><span data-stu-id="4a963-118">[**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) defaults to "best fit" mapping for code pages, such as 1252.</span></span> <span data-ttu-id="4a963-119">Однако этот тип сопоставления допускает несколько представлений одной и той же строки, что может привести к тому, что приложение будет уязвимо для атак.</span><span class="sxs-lookup"><span data-stu-id="4a963-119">However, this type of mapping allows multiple representations of the same string, potentially leaving your application vulnerable to attack.</span></span> <span data-ttu-id="4a963-120">Например, Латинская прописная буква A с диересис ("Ä") может сопоставляться с Латинской прописной буквой а ("A"); символ Юникода в азиатском языке может соответствовать косой черте ("/").</span><span class="sxs-lookup"><span data-stu-id="4a963-120">For example, Latin capital letter A with dieresis ("Ä") might map to Latin capital letter A ("A"); a Unicode character in an Asian language might map to a slash ("/").</span></span> <span data-ttu-id="4a963-121">\_ \_ \_ \_ С точки зрения безопасности предпочтительнее использовать флаг WC не подходит.</span><span class="sxs-lookup"><span data-stu-id="4a963-121">The use of the WC\_NO\_BEST\_FIT\_CHARS flag is preferred from a security perspective.</span></span>

<span data-ttu-id="4a963-122">Некоторые кодовые страницы, например кодовые страницы 5022x (ISO-2022-x), по своей природе небезопасны, так как они позволяют использовать несколько представлений одной и той же строки.</span><span class="sxs-lookup"><span data-stu-id="4a963-122">Some code pages, for example, the 5022x (iso-2022-x) code pages, are inherently insecure because they allow multiple representations of the same string.</span></span> <span data-ttu-id="4a963-123">Правильно написанный код выполняет проверки безопасности в форме Юникода, но эти типы кодовых страниц расширяют атаку, уязвимости приложения, и их следует избегать по возможности.</span><span class="sxs-lookup"><span data-stu-id="4a963-123">Properly written code performs security checks in the Unicode form, but these types of code pages expand the attack susceptibility of your applications and should be avoided if possible.</span></span>

## <a name="security-considerations-for-comparison-functions"></a><span data-ttu-id="4a963-124">Вопросы безопасности для функций сравнения</span><span class="sxs-lookup"><span data-stu-id="4a963-124">Security Considerations for Comparison Functions</span></span>

<span data-ttu-id="4a963-125">Сравнение строк потенциально может представлять проблемы безопасности.</span><span class="sxs-lookup"><span data-stu-id="4a963-125">String comparisons can potentially present security issues.</span></span> <span data-ttu-id="4a963-126">Поскольку все функции сравнения немного различаются, одна функция может сообщать о двух строках как равных, а другая функция может считать их разными.</span><span class="sxs-lookup"><span data-stu-id="4a963-126">Because all comparison functions are slightly different, one function might report two strings as equal, while another function might consider them distinct.</span></span> <span data-ttu-id="4a963-127">Ниже приведены несколько функций, которые приложения могут использовать для сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="4a963-127">The following are several functions your applications can use to compare strings:</span></span>

-   <span data-ttu-id="4a963-128">[лстркмпи](/windows/win32/api/winbase/nf-winbase-lstrcmpia).</span><span class="sxs-lookup"><span data-stu-id="4a963-128">[lstrcmpi](/windows/win32/api/winbase/nf-winbase-lstrcmpia).</span></span> <span data-ttu-id="4a963-129">Сравнивает две символьные строки в соответствии с правилами языкового стандарта без учета регистра.</span><span class="sxs-lookup"><span data-stu-id="4a963-129">Compares two character strings according to the rules of the locale, without case-sensitivity.</span></span> <span data-ttu-id="4a963-130">Функция сравнивает строки, проверяя первые символы друг от друга, вторые символы и т. д., пока не найдет неравенство или не достигнет конца строк.</span><span class="sxs-lookup"><span data-stu-id="4a963-130">The function compares the strings by checking the first characters against each other, the second characters against each other, and so on, until it finds an inequality or reaches the ends of the strings.</span></span>
-   <span data-ttu-id="4a963-131">[лстркмп](/windows/win32/api/winbase/nf-winbase-lstrcmpa).</span><span class="sxs-lookup"><span data-stu-id="4a963-131">[lstrcmp](/windows/win32/api/winbase/nf-winbase-lstrcmpa).</span></span> <span data-ttu-id="4a963-132">Сравнивает строки с помощью методов, аналогичных методам [лстркмпи](/windows/win32/api/winbase/nf-winbase-lstrcmpia).</span><span class="sxs-lookup"><span data-stu-id="4a963-132">Compares strings using techniques similar to those of [lstrcmpi](/windows/win32/api/winbase/nf-winbase-lstrcmpia).</span></span> <span data-ttu-id="4a963-133">Единственное отличие заключается в том, что [лстркмп](/windows/win32/api/winbase/nf-winbase-lstrcmpa) выполняет сравнение строк с учетом регистра.</span><span class="sxs-lookup"><span data-stu-id="4a963-133">The only difference is that [lstrcmp](/windows/win32/api/winbase/nf-winbase-lstrcmpa) performs a case-sensitive string comparison.</span></span>
-   <span data-ttu-id="4a963-134">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**Компарестринжекс**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) (Windows Vista и более поздние версии).</span><span class="sxs-lookup"><span data-stu-id="4a963-134">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) (Windows Vista and later).</span></span> <span data-ttu-id="4a963-135">Выполнить сравнение строк в языковом стандарте, предоставляемом приложением.</span><span class="sxs-lookup"><span data-stu-id="4a963-135">Perform a string comparison on an application-supplied locale.</span></span> <span data-ttu-id="4a963-136">[**Компарестринжекс**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) аналогичен [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), но он определяет языковой стандарт по [имени локали](locale-names.md) вместо [идентификатора локали](locale-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="4a963-136">[**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) is similar to [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), but it identifies a locale by [locale name](locale-names.md) instead of [locale identifier](locale-identifiers.md).</span></span> <span data-ttu-id="4a963-137">Эти функции похожи на [лстркмпи](/windows/win32/api/winbase/nf-winbase-lstrcmpia) и [лстркмп](/windows/win32/api/winbase/nf-winbase-lstrcmpa) , за исключением того, что они работают с конкретным языковым стандартом вместо языкового стандарта, выбранного пользователем.</span><span class="sxs-lookup"><span data-stu-id="4a963-137">These functions are similar to [lstrcmpi](/windows/win32/api/winbase/nf-winbase-lstrcmpia) and [lstrcmp](/windows/win32/api/winbase/nf-winbase-lstrcmpa) except that they operate on a specific locale instead of a user-selected locale.</span></span>
-   <span data-ttu-id="4a963-138">[**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) (Windows Vista и более поздние версии).</span><span class="sxs-lookup"><span data-stu-id="4a963-138">[**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) (Windows Vista and later).</span></span> <span data-ttu-id="4a963-139">Сравнивает две строки Юникода для проверки эквивалентности двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="4a963-139">Compares two Unicode strings to test binary equivalence.</span></span> <span data-ttu-id="4a963-140">За исключением случаев, когда параметр не учитывает регистр, эта функция игнорирует все недвоичные эквиваленты и проверяет все кодовые точки на равенство, включая кодовые точки, для которых не задан вес в лингвистических схемах [сортировки](sorting.md) .</span><span class="sxs-lookup"><span data-stu-id="4a963-140">Except for the option of being case-insensitive, this function disregards all non-binary equivalences, and tests all code points for equality, including code points that are not given any weight in linguistic [sorting](sorting.md) schemes.</span></span> <span data-ttu-id="4a963-141">Обратите внимание, что другие функции сравнения, упомянутые в этом разделе, не проверяют все кодовые точки на равенство.</span><span class="sxs-lookup"><span data-stu-id="4a963-141">Note that the other comparison functions mentioned in this topic do not test all code points for equality.</span></span>
-   <span data-ttu-id="4a963-142">[**Финднлсстринг**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), [**Финднлсстринжекс**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) (Windows Vista и более поздние версии).</span><span class="sxs-lookup"><span data-stu-id="4a963-142">[**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) (Windows Vista and later).</span></span> <span data-ttu-id="4a963-143">Находите строку в Юникоде в другой строке Юникода.</span><span class="sxs-lookup"><span data-stu-id="4a963-143">Locate a Unicode string in another Unicode string.</span></span> <span data-ttu-id="4a963-144">[**Финднлсстринжекс**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) похож на [**финднлсстринг**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), за исключением того, что он определяет языковой стандарт по имени локали вместо идентификатора локали.</span><span class="sxs-lookup"><span data-stu-id="4a963-144">[**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) is similar to [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), except that it identifies a locale by locale name instead of locale identifier.</span></span>
-   <span data-ttu-id="4a963-145">[**Финдстрингординал**](/windows/desktop/api/Libloaderapi/nf-libloaderapi-findstringordinal) (Windows 7 и более поздние версии).</span><span class="sxs-lookup"><span data-stu-id="4a963-145">[**FindStringOrdinal**](/windows/desktop/api/Libloaderapi/nf-libloaderapi-findstringordinal) (Windows 7 and later).</span></span> <span data-ttu-id="4a963-146">Находит одну строку Юникода в другой строке Юникода.</span><span class="sxs-lookup"><span data-stu-id="4a963-146">Locates one Unicode string in another Unicode string.</span></span> <span data-ttu-id="4a963-147">Приложение должно использовать эту функцию вместо [**финднлсстринг**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring) для всех нелингвистических сравнений.</span><span class="sxs-lookup"><span data-stu-id="4a963-147">The application should use this function instead of [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring) for all non-linguistic comparisons.</span></span>

<span data-ttu-id="4a963-148">Как и [лстркмпи](/windows/win32/api/winbase/nf-winbase-lstrcmpia) и [лстркмп](/windows/win32/api/winbase/nf-winbase-lstrcmpa), [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) вычисляет строки по символу.</span><span class="sxs-lookup"><span data-stu-id="4a963-148">Like [lstrcmpi](/windows/win32/api/winbase/nf-winbase-lstrcmpia) and [lstrcmp](/windows/win32/api/winbase/nf-winbase-lstrcmpa), [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) evaluates strings character by character.</span></span> <span data-ttu-id="4a963-149">Однако многие языки содержат элементы с несколькими символами, например два символа "CH" в традиционном испанском.</span><span class="sxs-lookup"><span data-stu-id="4a963-149">However, many languages have multiple-character elements, for example, the two-character element "CH" in traditional Spanish.</span></span> <span data-ttu-id="4a963-150">Поскольку [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) использует языковой стандарт, предоставляемый приложением для обнаружения элементов с несколькими символами, а [лстркмпи](/windows/win32/api/winbase/nf-winbase-lstrcmpia) и [лстркмп](/windows/win32/api/winbase/nf-winbase-lstrcmpa) использует языковой стандарт потока, идентичные строки могут не сравниваться как равные.</span><span class="sxs-lookup"><span data-stu-id="4a963-150">Because [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) uses the locale furnished by the application to identify multiple-character elements and [lstrcmpi](/windows/win32/api/winbase/nf-winbase-lstrcmpia) and [lstrcmp](/windows/win32/api/winbase/nf-winbase-lstrcmpa) use the thread locale, identical strings might not compare as equal.</span></span>

<span data-ttu-id="4a963-151">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) игнорирует неопределенные символы и, таким словами, возвращает ноль (указывающий равные строки) для многих строковых пар, которые довольно уникальны.</span><span class="sxs-lookup"><span data-stu-id="4a963-151">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) ignores undefined characters, and thus returns zero (indicating equal strings) for many string pairs that are quite distinct.</span></span> <span data-ttu-id="4a963-152">Строка может содержать значения, которые не сопоставлены ни с одним символом, либо могут содержать символы с семантикой вне домена приложения, например управляющие символы в URL-адресе.</span><span class="sxs-lookup"><span data-stu-id="4a963-152">A string might contain values that do not map to any character or it might contain characters with semantics outside the domain of the application, such as control characters in a URL.</span></span> <span data-ttu-id="4a963-153">Приложения, использующие эту функцию, должны предоставлять обработчики ошибок и тестовые строки, чтобы убедиться, что они являются допустимыми, прежде чем использовать их.</span><span class="sxs-lookup"><span data-stu-id="4a963-153">Applications using this function should provide error handlers and test strings to make sure that they are valid before using them.</span></span>

> [!Note]  
> <span data-ttu-id="4a963-154">Для Windows Vista и более поздних версий [**компарестринжекс**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) аналогичен [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw).</span><span class="sxs-lookup"><span data-stu-id="4a963-154">For Windows Vista and later, [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) is similar to [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw).</span></span> <span data-ttu-id="4a963-155">Для этих функций существуют одинаковые проблемы безопасности.</span><span class="sxs-lookup"><span data-stu-id="4a963-155">The security issues are identical for these functions.</span></span>

 

<span data-ttu-id="4a963-156">Аналогичные проблемы безопасности относятся к функциям, таким как [**финднлсстринг**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), которые делают неявные сравнения.</span><span class="sxs-lookup"><span data-stu-id="4a963-156">Similar security issues apply to functions, such as [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), that make implicit comparisons.</span></span> <span data-ttu-id="4a963-157">В зависимости от установленных флагов результаты вызова [**финднлсстринг**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring) для поиска одной строки в другой строке могут значительно различаться.</span><span class="sxs-lookup"><span data-stu-id="4a963-157">Depending on the flags that are set, the results of calling [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring) to search for one string within another string can differ considerably.</span></span>

> [!Note]  
> <span data-ttu-id="4a963-158">Для Windows Vista и более поздних версий [**финднлсстринжекс**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) аналогичен [**финднлсстринг**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring).</span><span class="sxs-lookup"><span data-stu-id="4a963-158">For Windows Vista and later, [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) is similar to [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring).</span></span> <span data-ttu-id="4a963-159">Для этих функций существуют одинаковые проблемы безопасности.</span><span class="sxs-lookup"><span data-stu-id="4a963-159">The security issues are identical for these functions.</span></span>

 

## <a name="security-considerations-for-character-sets-in-file-names"></a><span data-ttu-id="4a963-160">Вопросы безопасности для наборов символов в именах файлов</span><span class="sxs-lookup"><span data-stu-id="4a963-160">Security Considerations for Character Sets in File Names</span></span>

<span data-ttu-id="4a963-161">Кодовая страница Windows и наборы символов OEM, используемые в системах на японском языке, содержат символ [¥) вместо обратной косой черты ( \\ ).</span><span class="sxs-lookup"><span data-stu-id="4a963-161">Windows code page and OEM character sets used on Japanese-language systems contain the Yen symbol (¥) instead of a backslash (\\).</span></span> <span data-ttu-id="4a963-162">Таким словами, символ «символы» является запрещенным для файловых систем NTFS и FAT.</span><span class="sxs-lookup"><span data-stu-id="4a963-162">Thus, the Yen character is a prohibited character for NTFS and FAT file systems.</span></span> <span data-ttu-id="4a963-163">При сопоставлении Юникода с кодовой страницей на японском языке функции преобразования сопоставляют обратную косую черту (U + 005C) и Стандартный символ Юникода в Юникоде (U + 00A5) к этому же символу.</span><span class="sxs-lookup"><span data-stu-id="4a963-163">When mapping Unicode to a Japanese-language code page, conversion functions map both backslash (U+005C) and the normal Unicode Yen symbol (U+00A5) to this same character.</span></span> <span data-ttu-id="4a963-164">По соображениям безопасности приложения обычно не должны допускать символ U + 00A5 в строке Юникода, которую можно преобразовать для использования в качестве имени файла FAT.</span><span class="sxs-lookup"><span data-stu-id="4a963-164">For security reasons, your applications should not typically allow the character U+00A5 in a Unicode string that might be converted for use as a FAT file name.</span></span>

## <a name="security-considerations-for-internationalized-domain-names"></a><span data-ttu-id="4a963-165">Вопросы безопасности для международных доменных имен</span><span class="sxs-lookup"><span data-stu-id="4a963-165">Security Considerations for Internationalized Domain Names</span></span>

<span data-ttu-id="4a963-166">Международные доменные имена (IDNs) указываются в сетевой рабочей группе [RFC 3490: Интернатионализинг Domain Names in Applications (IDNA)](http://www.faqs.org/rfcs/rfc3490.html).</span><span class="sxs-lookup"><span data-stu-id="4a963-166">Internationalized Domain Names (IDNs) are specified by Network Working Group [RFC 3490: Internationalizing Domain Names in Applications (IDNA)](http://www.faqs.org/rfcs/rfc3490.html).</span></span> <span data-ttu-id="4a963-167">Стандарт представляет ряд проблем безопасности.</span><span class="sxs-lookup"><span data-stu-id="4a963-167">The standard introduces a number of security issues.</span></span>

<span data-ttu-id="4a963-168">Глифы, представляющие определенные символы из разных скриптов, могут выглядеть одинаково или даже одинаково.</span><span class="sxs-lookup"><span data-stu-id="4a963-168">Glyphs representing certain characters from different scripts might appear similar or even identical.</span></span> <span data-ttu-id="4a963-169">Например, во многих шрифтах строчная буква а ("a") не различается в строчной букве а ("a").</span><span class="sxs-lookup"><span data-stu-id="4a963-169">For example, in many fonts, Cyrillic lowercase A ("a") is indistinguishable from Latin lowercase A ("a").</span></span> <span data-ttu-id="4a963-170">Не существует способа сообщить визуально, что "example.com" и "example.com" — это два разных доменных имени, одна с Латинской строчной буквой A в имени, а другая — строчная буква A. Сайт узла неразборчивые может использовать эту визуальную неоднозначность для того, чтобы стать другим сайтом в атаке с подменой.</span><span class="sxs-lookup"><span data-stu-id="4a963-170">There is no way to tell visually that "example.com" and "example.com" are two different domain names,one with a Latin lowercase A in the name, the other with a Cyrillic lowercase A. An unscrupulous host site can use this visual ambiguity to pretend to be another site in a spoofing attack.</span></span>

<span data-ttu-id="4a963-171">Расширенная кодировка, которую поддерживает IDNA для IDNs, также имеет возможность подмены в рамках конкретного сценария.</span><span class="sxs-lookup"><span data-stu-id="4a963-171">The extended character set that IDNA allows for IDNs also has spoofing potential within a particular script.</span></span> <span data-ttu-id="4a963-172">Например, существует много сходства между дефисом-минусом ("-" U + 002D), дефис ("–" U + 2010), Неразрывный дефис ("-" U + 2011), рисунок, тире ("\u2012" U + 2012), короткое тире ("–" U + 2013) и знак "минус" ("−" U + 2212).</span><span class="sxs-lookup"><span data-stu-id="4a963-172">For example, there is a strong resemblance among the hyphen-minus ("-" U+002D), the hyphen ("—" U+2010), the non-breaking hyphen ("‑" U+2011), the figure dash ("‒" U+2012), the en dash ("–" U+2013), and the minus sign ("−" U+2212).</span></span>

<span data-ttu-id="4a963-173">Аналогичные проблемы возникают при определенных композициях совместимости.</span><span class="sxs-lookup"><span data-stu-id="4a963-173">Similar issues arise from certain compatibility compositions.</span></span> <span data-ttu-id="4a963-174">Например, один символ Юникода с номером двадцать полной остановкой ("20.", U + 249B) преобразуется в "20".</span><span class="sxs-lookup"><span data-stu-id="4a963-174">For example, the single Unicode character NUMBER TWENTY FULL STOP ("⒛", U+249B) is converted to "20."</span></span> <span data-ttu-id="4a963-175">(U + 0032 u + 0030 U + 002E) на шаге Намепреп до преобразования в Punycode.</span><span class="sxs-lookup"><span data-stu-id="4a963-175">(U+0032 U+0030 U+002E) in a NamePrep step, prior to conversion to Punycode.</span></span> <span data-ttu-id="4a963-176">Иными словами, эта композиция вставляет точку (полную точку).</span><span class="sxs-lookup"><span data-stu-id="4a963-176">In other words, this composition inserts a period (full stop).</span></span> <span data-ttu-id="4a963-177">Такие композиции имеют возможность подмены.</span><span class="sxs-lookup"><span data-stu-id="4a963-177">Such compositions have spoofing potential.</span></span>

<span data-ttu-id="4a963-178">Смешивание разных сценариев в IDN не обязательно означает подмену или намерение обмана.</span><span class="sxs-lookup"><span data-stu-id="4a963-178">Mixing of different scripts in an IDN does not necessarily indicate spoofing or deceptive intent.</span></span> <span data-ttu-id="4a963-179">[Технический отчет \# 36. вопросы безопасности в Юникоде](https://www.unicode.org/reports/tr36/#international_domain_names) предоставляют несколько примеров разумных IDNs, которые содержат набор сценариев, например XML-документы. com ("документы" — Русский для документов).</span><span class="sxs-lookup"><span data-stu-id="4a963-179">[Technical Report \#36: Unicode Security Considerations](https://www.unicode.org/reports/tr36/#international_domain_names) gives several examples of reasonable IDNs that contain a mix of scripts, such as XML-Документы.com ("Документы" is Russian for "documents").</span></span>

<span data-ttu-id="4a963-180">Атаки с подменой не ограничиваются IDNs.</span><span class="sxs-lookup"><span data-stu-id="4a963-180">Spoofing attacks are not restricted to IDNs.</span></span> <span data-ttu-id="4a963-181">Например, "rnicrosoft.com" выглядит так же, как "microsoft.com", но является именем ASCII.</span><span class="sxs-lookup"><span data-stu-id="4a963-181">For example, "rnicrosoft.com" looks much like "microsoft.com", yet it is an ASCII name.</span></span> <span data-ttu-id="4a963-182">Кроме того, атака с подменой может быть вызвана повреждением имени.</span><span class="sxs-lookup"><span data-stu-id="4a963-182">Additionally, a spoofing attack can be made by corruption of a name.</span></span> <span data-ttu-id="4a963-183">Добавление дополнительных меток после хорошо известного фирменного названия или включение фирменного названия в путь URL-адреса, помеченного как безопасный, может привести к путанице пользователей, независимо от использования IDN.</span><span class="sxs-lookup"><span data-stu-id="4a963-183">Adding extra labels after a well-known brand name, or including the brand name in the path of a URL labeled as secure, can confuse novice users, regardless of the use of the IDN.</span></span> <span data-ttu-id="4a963-184">Для некоторых языковых стандартов IDNs являются обязательными, и форма Punycode этих имен неприемлема, так как имена выглядят как вам.</span><span class="sxs-lookup"><span data-stu-id="4a963-184">For some locales, IDNs are required and the Punycode form of these names is unacceptable, since it makes the names look like gibberish.</span></span>

<span data-ttu-id="4a963-185">Дополнительные сведения о вопросах безопасности, упомянутых здесь, и о большом количестве других проблем, связанных с IDNA, см. в [техническом отчете \# 36: вопросы безопасности в Юникоде](https://www.unicode.org/reports/tr36/#international_domain_names).</span><span class="sxs-lookup"><span data-stu-id="4a963-185">For more information about the security issues mentioned here, plus a large number of other issues relevant to IDNA, see [Technical Report \#36: Unicode Security Considerations](https://www.unicode.org/reports/tr36/#international_domain_names).</span></span> <span data-ttu-id="4a963-186">Помимо подробного обсуждения проблем безопасности, связанных с IDNA, этот отчет предлагает рекомендации по работе с подозрительными IDNs в ваших приложениях.</span><span class="sxs-lookup"><span data-stu-id="4a963-186">Along with detailed discussions of IDNA-related security issues, this report offers suggestions for dealing with suspect IDNs in your applications.</span></span>

## <a name="security-considerations-for-ansi-functions"></a><span data-ttu-id="4a963-187">Вопросы безопасности для функций ANSI</span><span class="sxs-lookup"><span data-stu-id="4a963-187">Security Considerations for ANSI Functions</span></span>

> [!Note]  
> <span data-ttu-id="4a963-188">В глобальных приложениях рекомендуется использовать Юникод, особенно новые, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="4a963-188">You are recommended to use Unicode in your globalized applications, particularly new ones, if at all possible.</span></span> <span data-ttu-id="4a963-189">Функции ANSI следует использовать только в том случае, если вы переопределяете причины отсутствия использования Юникода, например соответствие более старому протоколу, который не поддерживает Юникод.</span><span class="sxs-lookup"><span data-stu-id="4a963-189">You should use ANSI functions only if you have overriding reasons for not using Unicode, for example, conformance to an older protocol that does not support Unicode.</span></span>

 

<span data-ttu-id="4a963-190">Многие функции поддержки национальных языков (NLS), такие как [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) и [**жеткалендаринфо**](/windows/desktop/api/Winnls/nf-winnls-getcalendarinfoa), имеют определенные версии ANSI, в данном случае **жетлокалеинфоа** и **жеткалендаринфоа** соответственно.</span><span class="sxs-lookup"><span data-stu-id="4a963-190">Many National Language Support (NLS) functions, such as [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) and [**GetCalendarInfo**](/windows/desktop/api/Winnls/nf-winnls-getcalendarinfoa), have specific ANSI versions, in this case, **GetLocaleInfoA** and **GetCalendarInfoA**, respectively.</span></span> <span data-ttu-id="4a963-191">Если в приложении используется версия ANSI функции с операционной системой на основе Юникода, такой как Windows NT, Windows 2000, Windows XP или Windows Vista, функция может завершиться сбоем или получить неопределенные результаты.</span><span class="sxs-lookup"><span data-stu-id="4a963-191">When your application uses the ANSI version of a function with a Unicode-based operating system, such as Windows NT, Windows 2000, Windows XP, or Windows Vista, the function can fail or produce undefined results.</span></span> <span data-ttu-id="4a963-192">Если есть убедительная причина использования функций ANSI с такой операционной системой, убедитесь, что данные, передаваемые приложением, действительны для ANSI.</span><span class="sxs-lookup"><span data-stu-id="4a963-192">If you have a compelling reason to use ANSI functions with such an operating system, ensure that the data passed by your application is valid for ANSI.</span></span>

## <a name="security-considerations-for-unicode-normalization"></a><span data-ttu-id="4a963-193">Вопросы безопасности при нормализации Юникода</span><span class="sxs-lookup"><span data-stu-id="4a963-193">Security Considerations for Unicode Normalization</span></span>

<span data-ttu-id="4a963-194">Так как нормализация Юникода может изменить форму строки, механизмы безопасности или алгоритмы проверки символов, как правило, должны быть реализованы после нормализации.</span><span class="sxs-lookup"><span data-stu-id="4a963-194">Since Unicode normalization can change the form of a string, security mechanisms or character validation algorithms should usually be implemented after normalization.</span></span> <span data-ttu-id="4a963-195">Например, рассмотрим приложение с веб-интерфейсом, который принимает имя файла, но не принимает имя пути.</span><span class="sxs-lookup"><span data-stu-id="4a963-195">For example, consider an application with a Web interface that accepts a file name, but does not accept a path name.</span></span> <span data-ttu-id="4a963-196">Полная ширина u + FF43 u + FF1A U + FF3C u + FF57 u + FF49 U + FF4E U + FF44 U + FF4F u + FF57 u + FF53. в u + 0063 u + 001A u + 003C u + 0077 u + 0069 u + u + 006E u + 0064 u + 006F `(c : \ w i n d o w s)` `(c:\windows)` .</span><span class="sxs-lookup"><span data-stu-id="4a963-196">A full-width U+FF43 U+FF1A U+FF3C U+FF57 U+FF49 U+FF4E U+FF44 U+FF4F U+FF57 U+FF53 `(c : \ w i n d o w s)` changes to U+0063 U+001A U+003C U+0077 U+0069 U+006E U+0064 U+006F U+0077 U+0073 `(c:\windows)` with form KC normalization.</span></span> <span data-ttu-id="4a963-197">Если приложение проверяет наличие символа двоеточия и обратной косой черты перед реализацией нормализации, результатом может быть непреднамеренной доступ к файлу.</span><span class="sxs-lookup"><span data-stu-id="4a963-197">If an application tests for the presence of the colon and backslash characters before it implements normalization, the result can be unintentional file access.</span></span>

<span data-ttu-id="4a963-198">Хотя нормализация Юникода является элементом, обеспечивающим безопасность операционных систем, помните, что нормализация не является заменой для комплексной политики безопасности.</span><span class="sxs-lookup"><span data-stu-id="4a963-198">While Unicode normalization is an element in making operating systems secure, remember that normalization is not a replacement for a comprehensive security policy.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4a963-199">См. также</span><span class="sxs-lookup"><span data-stu-id="4a963-199">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4a963-200">Кодировки, используемые в именах файлов</span><span class="sxs-lookup"><span data-stu-id="4a963-200">Character Sets Used in File Names</span></span>](character-sets-used-in-file-names.md)
</dt> <dt>

[<span data-ttu-id="4a963-201">Правила обозначения прототипов функций</span><span class="sxs-lookup"><span data-stu-id="4a963-201">Conventions for Function Prototypes</span></span>](conventions-for-function-prototypes.md)
</dt> <dt>

[<span data-ttu-id="4a963-202">Обработка сортировки в приложениях</span><span class="sxs-lookup"><span data-stu-id="4a963-202">Handling Sorting in Your Applications</span></span>](handling-sorting-in-your-applications.md)
</dt> <dt>

[<span data-ttu-id="4a963-203">Обработка международных доменных имен (IDNs)</span><span class="sxs-lookup"><span data-stu-id="4a963-203">Handling Internationalized Domain Names (IDNs)</span></span>](handling-internationalized-domain-names--idns.md)
</dt> <dt>

[<span data-ttu-id="4a963-204">Юникод</span><span class="sxs-lookup"><span data-stu-id="4a963-204">Unicode</span></span>](unicode.md)
</dt> </dl>

 

 
