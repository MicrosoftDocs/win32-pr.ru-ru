---
description: Объект Mutex — это объект синхронизации, состояние которого равно сигнальному, если он не владеет ни одним потоком, и несигнальным, когда он принадлежит.
ms.assetid: eca0795a-1fd0-4034-9d61-9416670919cf
title: Мьютексные объекты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e84c17ba3e99e888f7d1e9137a7f24a4d78ce2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911235"
---
# <a name="mutex-objects"></a><span data-ttu-id="0e1b0-103">Мьютексные объекты</span><span class="sxs-lookup"><span data-stu-id="0e1b0-103">Mutex Objects</span></span>

<span data-ttu-id="0e1b0-104">*Объект Mutex* — это объект синхронизации, состояние которого равно сигнальному, если он не владеет ни одним потоком, и несигнальным, когда он принадлежит.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-104">A *mutex object* is a synchronization object whose state is set to signaled when it is not owned by any thread, and nonsignaled when it is owned.</span></span> <span data-ttu-id="0e1b0-105">Только один поток за раз может владеть объектом Mutex, имя которого берется из того факта, что он полезен при координации взаимоисключающего доступа к общему ресурсу.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-105">Only one thread at a time can own a mutex object, whose name comes from the fact that it is useful in coordinating mutually exclusive access to a shared resource.</span></span> <span data-ttu-id="0e1b0-106">Например, чтобы предотвратить одновременную запись двух потоков в общую память, каждый поток ждет владения объектом Mutex перед выполнением кода, который обращается к памяти.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-106">For example, to prevent two threads from writing to shared memory at the same time, each thread waits for ownership of a mutex object before executing the code that accesses the memory.</span></span> <span data-ttu-id="0e1b0-107">После записи в общую память поток освобождает объект Mutex.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-107">After writing to the shared memory, the thread releases the mutex object.</span></span>

<span data-ttu-id="0e1b0-108">Поток использует функцию [**CreateMutex**](/windows/win32/api/synchapi/nf-synchapi-createmutexa) или [**креатемутексекс**](/windows/win32/api/synchapi/nf-synchapi-createmutexexa) для создания объекта мьютекса.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-108">A thread uses the [**CreateMutex**](/windows/win32/api/synchapi/nf-synchapi-createmutexa) or [**CreateMutexEx**](/windows/win32/api/synchapi/nf-synchapi-createmutexexa) function to create a mutex object.</span></span> <span data-ttu-id="0e1b0-109">Создание потока может запрашивать немедленное владение объектом мьютекса, а также указывать имя для объекта Mutex.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-109">The creating thread can request immediate ownership of the mutex object and can also specify a name for the mutex object.</span></span> <span data-ttu-id="0e1b0-110">Он также может создать неименованный мьютекс.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-110">It can also create an unnamed mutex.</span></span> <span data-ttu-id="0e1b0-111">Дополнительные сведения об именах для мьютексов, событий, семафоров и объектов таймера см. в разделе [межпроцессная синхронизация](interprocess-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="0e1b0-111">For additional information about names for mutex, event, semaphore, and timer objects, see [Interprocess Synchronization](interprocess-synchronization.md).</span></span>

<span data-ttu-id="0e1b0-112">Потоки в других процессах могут открыть обработчик для существующего именованного объекта мьютекса, указав его имя в вызове функции [**опенмутекс**](/windows/win32/api/synchapi/nf-synchapi-openmutexw) .</span><span class="sxs-lookup"><span data-stu-id="0e1b0-112">Threads in other processes can open a handle to an existing named mutex object by specifying its name in a call to the [**OpenMutex**](/windows/win32/api/synchapi/nf-synchapi-openmutexw) function.</span></span> <span data-ttu-id="0e1b0-113">Чтобы передать маркер в неименованный мьютекс в другой процесс, используйте функцию [**дупликатехандле**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) или наследование маркера «родители-потомки».</span><span class="sxs-lookup"><span data-stu-id="0e1b0-113">To pass a handle to an unnamed mutex to another process, use the [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) function or parent-child handle inheritance.</span></span>

<span data-ttu-id="0e1b0-114">Любой поток с маркером для объекта Mutex может использовать одну из [функций ожидания](wait-functions.md) для запроса владения объектом Mutex.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-114">Any thread with a handle to a mutex object can use one of the [wait functions](wait-functions.md) to request ownership of the mutex object.</span></span> <span data-ttu-id="0e1b0-115">Если объект мьютекса принадлежит другому потоку, функция wait блокирует запрашивающий поток до тех пор, пока владеющий поток не освободит объект Mutex с помощью функции [**ReleaseMutex**](/windows/win32/api/synchapi/nf-synchapi-releasemutex) .</span><span class="sxs-lookup"><span data-stu-id="0e1b0-115">If the mutex object is owned by another thread, the wait function blocks the requesting thread until the owning thread releases the mutex object using the [**ReleaseMutex**](/windows/win32/api/synchapi/nf-synchapi-releasemutex) function.</span></span> <span data-ttu-id="0e1b0-116">Возвращаемое значение функции Wait указывает, возвращается ли функция по некоторой причине, отличной от состояния мьютекса, для которого задан сигнал.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-116">The return value of the wait function indicates whether the function returned for some reason other than the state of the mutex being set to signaled.</span></span>

<span data-ttu-id="0e1b0-117">Если несколько потоков ожидают мьютекс, выбирается ожидающий поток.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-117">If more than one thread is waiting on a mutex, a waiting thread is selected.</span></span> <span data-ttu-id="0e1b0-118">Не думайте порядок "первым поступил — первым обслужен" (FIFO).</span><span class="sxs-lookup"><span data-stu-id="0e1b0-118">Do not assume a first-in, first-out (FIFO) order.</span></span> <span data-ttu-id="0e1b0-119">Внешние события, такие как режим ядра APC, могут изменять порядок ожидания.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-119">External events such as kernel-mode APCs can change the wait order.</span></span>

<span data-ttu-id="0e1b0-120">После того как поток получает владение мьютексом, он может указать один и тот же мьютекс в повторяющихся вызовах [функций ожидания](wait-functions.md) , не блокируя его выполнение.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-120">After a thread obtains ownership of a mutex, it can specify the same mutex in repeated calls to the [wait-functions](wait-functions.md) without blocking its execution.</span></span> <span data-ttu-id="0e1b0-121">Это предотвращает взаимную взаимоблокировку потока при ожидании того, что он уже владеет мьютексом.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-121">This prevents a thread from deadlocking itself while waiting for a mutex that it already owns.</span></span> <span data-ttu-id="0e1b0-122">Чтобы освободить владение при таких обстоятельствах, поток должен вызвать [**ReleaseMutex**](/windows/win32/api/synchapi/nf-synchapi-releasemutex) один раз для каждого случая, когда мьютекс удовлетворен условиями функции Wait.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-122">To release its ownership under such circumstances, the thread must call [**ReleaseMutex**](/windows/win32/api/synchapi/nf-synchapi-releasemutex) once for each time that the mutex satisfied the conditions of a wait function.</span></span>

<span data-ttu-id="0e1b0-123">Если поток завершается без освобождения владения объектом Mutex, объект Mutex считается брошенным.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-123">If a thread terminates without releasing its ownership of a mutex object, the mutex object is considered to be abandoned.</span></span> <span data-ttu-id="0e1b0-124">Ожидающий поток может получить владение брошенным объектом мьютекса, но функция Wait возвратит значение **Wait, \_** чтобы указать, что объект Mutex брошен.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-124">A waiting thread can acquire ownership of an abandoned mutex object, but the wait function will return **WAIT\_ABANDONED** to indicate that the mutex object is abandoned.</span></span> <span data-ttu-id="0e1b0-125">Брошенный объект мьютекса указывает на то, что произошла ошибка и что все общие ресурсы, защищенные объектом Mutex, находятся в неопределенном состоянии.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-125">An abandoned mutex object indicates that an error has occurred and that any shared resource being protected by the mutex object is in an undefined state.</span></span> <span data-ttu-id="0e1b0-126">Если поток продолжается, как будто объект мьютекса не был прерван, он больше не считается брошенным после того, как поток выйдет из состояния владения.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-126">If the thread proceeds as though the mutex object had not been abandoned, it is no longer considered abandoned after the thread releases its ownership.</span></span> <span data-ttu-id="0e1b0-127">Это восстанавливает нормальное поведение, если в функции Wait впоследствии задается обработчик объекта мьютекса.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-127">This restores normal behavior if a handle to the mutex object is subsequently specified in a wait function.</span></span>

<span data-ttu-id="0e1b0-128">Обратите внимание, что [объекты критической секции](critical-section-objects.md) обеспечивают синхронизацию, аналогичную той, которая предоставляется объектами Mutex, за исключением того, что критически важные объекты раздела могут использоваться только потоками одного процесса.</span><span class="sxs-lookup"><span data-stu-id="0e1b0-128">Note that [critical section objects](critical-section-objects.md) provide synchronization similar to that provided by mutex objects, except that critical section objects can be used only by the threads of a single process.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0e1b0-129">См. также</span><span class="sxs-lookup"><span data-stu-id="0e1b0-129">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0e1b0-130">Использование объектов Mutex</span><span class="sxs-lookup"><span data-stu-id="0e1b0-130">Using Mutex Objects</span></span>](using-mutex-objects.md)
</dt> </dl>

 

 
