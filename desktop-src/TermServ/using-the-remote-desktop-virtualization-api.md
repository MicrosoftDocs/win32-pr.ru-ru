---
title: Использование API виртуализации удаленный рабочий стол
description: Разработчики могут использовать этот API для настройки логики, которую RDCB использует для определения наилучшего назначения для входящего клиентского подключения.
ms.assetid: b25eb87e-dac4-49ce-890e-b39c7e9e3408
ms.tgt_platform: multiple
keywords:
- службы удаленных рабочих столов службы удаленных рабочих столов с помощью API виртуализации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cda9ebfc014a2c8ec20d299bbb8be9183b25ce89
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413080"
---
# <a name="using-the-remote-desktop-virtualization-api"></a><span data-ttu-id="0c936-104">Использование API виртуализации удаленный рабочий стол</span><span class="sxs-lookup"><span data-stu-id="0c936-104">Using the Remote Desktop Virtualization API</span></span>

<span data-ttu-id="0c936-105">Служба роли каталога сеансов служб терминалов позволяет серверам терминалов хранить сведения о пользователях и сеансах в базе данных, называемой каталогом сеансов.</span><span class="sxs-lookup"><span data-stu-id="0c936-105">The Terminal Services Session Directory (TS  Session Directory) role service allows terminal servers to store user and session information in a database called a session directory.</span></span> <span data-ttu-id="0c936-106">Когда пользователь подключается к серверу терминалов в ферме, каталог сеансов служб терминалов определяет, имеется ли у пользователя сеанс, запущенный на сервере терминалов, и, если это так, он перенаправляет пользователя на этот сервер терминалов.</span><span class="sxs-lookup"><span data-stu-id="0c936-106">When a user connects to a terminal server in a farm, TS Session Directory determines whether the user already has a session running on a terminal server and if so, it redirects the user to that terminal server.</span></span>

<span data-ttu-id="0c936-107">В Windows Server 2008 служба роли каталога сеансов служб терминалов была развернута и переименована в Брокер сеансов служб терминалов (посредник сеансов TS).</span><span class="sxs-lookup"><span data-stu-id="0c936-107">In Windows Server 2008, the TS Session Directory role service was expanded and renamed Terminal Services Session Broker (TS Session Broker).</span></span> <span data-ttu-id="0c936-108">В дополнение к сохранению каталога существующих сеансов посредник сеансов служб терминалов также может выполнять входящие подключения через Broker.</span><span class="sxs-lookup"><span data-stu-id="0c936-108">In addition to maintaining a directory of existing sessions, TS Session Broker can also broker incoming connections.</span></span> <span data-ttu-id="0c936-109">Когда посредник сеансов служб терминалов получает входящее подключение от пользователя, он проверяет свою базу данных, чтобы определить, есть ли у пользователя сеанс на сервере терминалов.</span><span class="sxs-lookup"><span data-stu-id="0c936-109">When TS Session Broker receives an incoming connection from a user, it checks its database to determine whether the user has an existing session on a terminal server.</span></span> <span data-ttu-id="0c936-110">В этом случае посредник сеансов служб терминалов перенаправляет соединение на тот же сервер терминалов.</span><span class="sxs-lookup"><span data-stu-id="0c936-110">If so, TS Session Broker redirects the connection to that same terminal server.</span></span> <span data-ttu-id="0c936-111">Если нет, посредник сеансов служб терминалов определяет, какой сервер терминалов имеет наименьшее число подключений, и перенаправляет подключение к этому серверу.</span><span class="sxs-lookup"><span data-stu-id="0c936-111">If not, TS Session Broker determines which terminal server has the fewest connections and redirects the connection to that server.</span></span>

<span data-ttu-id="0c936-112">Начиная с Windows Server 2008 Корпорация Майкрософт также выпустила общедоступный прикладной программный интерфейс (API) для мониторинга и взаимодействия с сеансами на серверах терминалов.</span><span class="sxs-lookup"><span data-stu-id="0c936-112">Beginning with Windows Server 2008, Microsoft also released a public application programming interface (API) for monitoring and interacting with sessions on terminal servers.</span></span> <span data-ttu-id="0c936-113">Этот API описан в [справочнике по подключаемому модулю компонента Подключение к удаленному рабочему столу Broker](/windows/desktop/TermServ/terminal-services-virtualization-api-reference).</span><span class="sxs-lookup"><span data-stu-id="0c936-113">This API is described in [Remote Desktop Connection Broker Plug-in Reference](/windows/desktop/TermServ/terminal-services-virtualization-api-reference).</span></span> <span data-ttu-id="0c936-114">С помощью этого API разработчики могут создавать настраиваемые подключаемые модули политики, переопределяющие стандартную логику перенаправления посредника сеансов служб терминалов.</span><span class="sxs-lookup"><span data-stu-id="0c936-114">Using this API, developers can create custom policy plug-ins that override the standard redirection logic of TS Session Broker.</span></span> <span data-ttu-id="0c936-115">Настраиваемые подключаемые модули могут перенаправлять сеансы на серверы терминалов, а также виртуальные машины, виртуальные рабочие столы, блейд-серверы и физические рабочие столы.</span><span class="sxs-lookup"><span data-stu-id="0c936-115">The custom plug-ins can redirect sessions to terminal servers, as well as virtual machines, virtual desktops, blade servers, and physical desktops.</span></span>

<span data-ttu-id="0c936-116">В Windows Server 2008 R2 архитектура компонента подключение к удаленному рабочему столу Broker RDCB (ранее известная как посредник сеансов служб терминалов) была расширена для поддержки подключений к виртуальным машинам.</span><span class="sxs-lookup"><span data-stu-id="0c936-116">In Windows Server 2008 R2, the architecture of Remote Desktop Connection Broker (RD Connection Broker) (formerly known as TS Session Broker) was expanded to support connections to virtual machines.</span></span> <span data-ttu-id="0c936-117">Новая архитектура поддерживает управление сеансами для виртуальных машин с помощью API виртуализации удаленный рабочий стол.</span><span class="sxs-lookup"><span data-stu-id="0c936-117">The new architecture supports session management for virtual machines through the Remote Desktop Virtualization API.</span></span> <span data-ttu-id="0c936-118">Разработчики могут использовать этот API для настройки логики, которую RDCB использует для определения наилучшего назначения для входящего клиентского подключения.</span><span class="sxs-lookup"><span data-stu-id="0c936-118">Developers can use this API to customize the logic that RD Connection Broker uses to determine the best destination for an incoming client connection.</span></span>

<span data-ttu-id="0c936-119">Удаленный рабочий стол API виртуализации предоставляет разработчикам несколько преимуществ:</span><span class="sxs-lookup"><span data-stu-id="0c936-119">Remote Desktop Virtualization API offers several benefits to developers:</span></span>

-   <span data-ttu-id="0c936-120">Интерфейсы для работы с физическими серверами терминалов похожи на те, которые используются для работы с виртуальными машинами.</span><span class="sxs-lookup"><span data-stu-id="0c936-120">The interfaces for working with physical terminal servers are similar to those for working with virtual machines.</span></span>
-   <span data-ttu-id="0c936-121">Разработчики могут заменить стандартную логику перенаправления или ее часть.</span><span class="sxs-lookup"><span data-stu-id="0c936-121">Developers can replace all or part of the standard redirection logic.</span></span> <span data-ttu-id="0c936-122">Разработчики могут создавать код, который поставляется вместе с продуктом, и не должен писать все с нуля.</span><span class="sxs-lookup"><span data-stu-id="0c936-122">Developers can build on the code that ships with the product and do not have to write everything from scratch.</span></span>
-   <span data-ttu-id="0c936-123">На управляющем сервере или в пределах сеанса не требуется дополнительный агент управления.</span><span class="sxs-lookup"><span data-stu-id="0c936-123">No additional management agent is required on the managing server or within the session.</span></span>
-   <span data-ttu-id="0c936-124">Подключаемые модули посредника сеансов служб терминалов, разработанные для использования с Windows Server 2008, по-прежнему поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="0c936-124">TS Session Broker plug-ins developed for use with Windows Server 2008 are still supported.</span></span>
-   <span data-ttu-id="0c936-125">API также позволяет разработчикам создавать пользовательские интерфейсы для администрирования как серверов удаленный рабочий стол сеансов, так и узлов сеансов удаленных рабочих столов (ранее известных как "серверы терминалов") и виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="0c936-125">The API also allows developers to create user interfaces for administration of both Remote Desktop Session Host (RD Session Host) servers (formerly known as "terminal servers") and virtual machines.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0c936-126">См. также</span><span class="sxs-lookup"><span data-stu-id="0c936-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0c936-127">Справочник по API виртуализации удаленный рабочий стол</span><span class="sxs-lookup"><span data-stu-id="0c936-127">Remote Desktop Virtualization API Reference</span></span>](terminal-services-virtualization-api-reference.md)
</dt> <dt>

[<span data-ttu-id="0c936-128">Справочник по подключаемому модулю компонента подключение к удаленному рабочему столу Broker</span><span class="sxs-lookup"><span data-stu-id="0c936-128">Remote Desktop Connection Broker Plug-in Reference</span></span>](/windows/desktop/TermServ/terminal-services-virtualization-api-reference)
</dt> </dl>

 

 