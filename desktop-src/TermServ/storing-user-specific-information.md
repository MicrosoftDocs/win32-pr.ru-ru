---
title: Хранение сведений, относящихся к пользователю
description: Приложения должны хранить данные пользователя в определенных пользователем расположениях отдельно от глобальной информации, которая относится ко всем пользователям.
ms.assetid: 32bd1d24-1d2e-4c0a-acdb-0cc67f275e6e
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 40c6236b7ba11a8b3149533e920b9b9413085d93
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070168"
---
# <a name="storing-user-specific-information"></a><span data-ttu-id="c58f1-103">Хранение сведений, относящихся к пользователю</span><span class="sxs-lookup"><span data-stu-id="c58f1-103">Storing user-specific information</span></span>

<span data-ttu-id="c58f1-104">В среде службы удаленных рабочих столов приложения должны хранить сведения, относящиеся к пользователю, в пользовательских расположениях отдельно от глобальных сведений, которые применяются ко всем пользователям.</span><span class="sxs-lookup"><span data-stu-id="c58f1-104">In a Remote Desktop Services environment, applications should store user-specific information in user-specific locations, separately from global information that applies to all users.</span></span> <span data-ttu-id="c58f1-105">Это правило применяется к информации, хранящейся в реестре, а также к информации, хранящейся в файлах.</span><span class="sxs-lookup"><span data-stu-id="c58f1-105">This rule applies to information stored in the registry, as well as information stored in files.</span></span> <span data-ttu-id="c58f1-106">Как правило, не следует рассчитывать на то, что один компьютер эквивалентен одному пользователю.</span><span class="sxs-lookup"><span data-stu-id="c58f1-106">In general, do not assume that one computer is equivalent to one user.</span></span>

<span data-ttu-id="c58f1-107">Храните пользовательские данные реестра в разделе реестра **hKey \_ Current \_ User** .</span><span class="sxs-lookup"><span data-stu-id="c58f1-107">Store user-specific registry information under the **HKEY\_CURRENT\_USER** registry key.</span></span> <span data-ttu-id="c58f1-108">Службы удаленных рабочих столов загружает в раздел **hKey \_ текущего \_** пользователя куст реестра для текущего пользователя при входе пользователя в систему.</span><span class="sxs-lookup"><span data-stu-id="c58f1-108">Remote Desktop Services loads the current user's personal registry hive into **HKEY\_CURRENT\_USER** when the user logs on.</span></span> <span data-ttu-id="c58f1-109">Разумеется, службы удаленных рабочих столов управляет реестром для того, чтобы каждый вошедший в систему клиент обнаружил правильный куст пользователя в разделе **hKey \_ текущий \_ пользователь**.</span><span class="sxs-lookup"><span data-stu-id="c58f1-109">Of course, Remote Desktop Services manages the registry to ensure that each of the logged-on clients detects the correct user hive under **HKEY\_CURRENT\_USER**.</span></span> <span data-ttu-id="c58f1-110">Дополнительные сведения о разделах реестра см. в разделах [Реестр безопасность и права доступа](/windows/desktop/SysInfo/registry-key-security-and-access-rights) и [кусты реестра](/windows/desktop/SysInfo/registry-hives).</span><span class="sxs-lookup"><span data-stu-id="c58f1-110">For more information about registry keys, see [Registry Key Security and Access Rights](/windows/desktop/SysInfo/registry-key-security-and-access-rights) and [Registry Hives](/windows/desktop/SysInfo/registry-hives).</span></span>

<span data-ttu-id="c58f1-111">В отличие от этого, все пользователи совместно используют куст **\_ локального \_ компьютера hKey** .</span><span class="sxs-lookup"><span data-stu-id="c58f1-111">In contrast, all users share the **HKEY\_LOCAL\_MACHINE** hive.</span></span> <span data-ttu-id="c58f1-112">Используйте **hKey \_ локальный \_ компьютер** для хранения сведений о компьютере, а не сведений, относящихся к пользователю.</span><span class="sxs-lookup"><span data-stu-id="c58f1-112">Use **HKEY\_LOCAL\_MACHINE** to store computer-specific information, not user-specific information.</span></span>

<span data-ttu-id="c58f1-113">Храните файлы предпочтений пользователя или другие пользовательские файлы в корневом каталоге пользователя или в каталоге, указанном пользователем.</span><span class="sxs-lookup"><span data-stu-id="c58f1-113">Store user-preference files or other user-specific files in the user's root directory or in a user-specified directory.</span></span> <span data-ttu-id="c58f1-114">Это относится к временным файлам, используемым для хранения промежуточной информации (например, кэшированных данных), или для передачи данных в другое приложение.</span><span class="sxs-lookup"><span data-stu-id="c58f1-114">This consideration applies to temporary files used to store interim information (such as cached data) or to pass data on to another application.</span></span> <span data-ttu-id="c58f1-115">Временные файлы отдельных пользователей также должны храниться отдельно для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="c58f1-115">User-specific temporary files must also be stored on a per-user basis.</span></span>

<span data-ttu-id="c58f1-116">[](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation) \_ Для получения расположения каталога личных файлов пользователя можно использовать функцию шжетспеЦиалфолдерлокатион с флагом CSid (личный).</span><span class="sxs-lookup"><span data-stu-id="c58f1-116">You can use the [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation) function with the CSIDL\_PERSONAL flag to get the location of the user's personal files directory.</span></span> <span data-ttu-id="c58f1-117">Для получения пути к каталогу Windows можно также использовать функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="c58f1-117">You can also use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to retrieve the path of the Windows directory.</span></span> <span data-ttu-id="c58f1-118">В среде службы удаленных рабочих столов каталог Windows гарантированно является частным для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="c58f1-118">In a Remote Desktop Services environment, the Windows directory is guaranteed to be private for each user.</span></span> <span data-ttu-id="c58f1-119">Не храните файлы отдельных пользователей в системном каталоге, например WINDOWS или каталоге программы, например программных файлах.</span><span class="sxs-lookup"><span data-stu-id="c58f1-119">Do not store user-specific files under the system directory, such as WINDOWS, or program directory, such as Program Files.</span></span>

<span data-ttu-id="c58f1-120">Во избежание конфликтов между данными и предпочтениями пользователей приложения должны хранить временные данные отдельных пользователей в отдельных временных файлах.</span><span class="sxs-lookup"><span data-stu-id="c58f1-120">To avoid conflicts among users' information and preferences, applications should store per-user temporary information in user-specific temporary files.</span></span> <span data-ttu-id="c58f1-121">Временные файлы отдельных пользователей также предотвращают сбои приложений, вызванные конфликтом блокировки файлов.</span><span class="sxs-lookup"><span data-stu-id="c58f1-121">User-specific temporary files also prevent application failures caused by file-locking conflicts.</span></span> <span data-ttu-id="c58f1-122">Чтобы указать путь для хранения временных данных, используйте функцию [**жеттемппас**](/windows/desktop/api/fileapi/nf-fileapi-gettemppatha) .</span><span class="sxs-lookup"><span data-stu-id="c58f1-122">To specify the path for storing temporary information, use the [**GetTempPath**](/windows/desktop/api/fileapi/nf-fileapi-gettemppatha) function.</span></span>

 

 