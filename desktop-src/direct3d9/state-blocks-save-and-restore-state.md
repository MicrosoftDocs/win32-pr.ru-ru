---
description: Блок состояния — это группа состояний устройства.
ms.assetid: 6b1917a8-8685-40c3-983d-6bd2fed95642
title: Состояние блокировки сохранения и восстановления (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c9a56ed6490b0d81b7e643ef892e6a760f00b841531bd21dc69a4069f07b9aa3
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118291731"
---
# <a name="state-blocks-save-and-restore-state-direct3d-9"></a>Состояние блокировки сохранения и восстановления (Direct3D 9)

Блок состояния — это группа состояний устройства. Состояние устройства состоит из состояния прорисовки, состояния вершины, состояния пикселя или всех вышеперечисленных элементов. Блок состояния содержит моментальный снимок текущего состояния устройства или можно создать блок состояния, записывающий каждое изменение состояния, которое делает приложение.

## <a name="capture-a-block-of-state"></a>Захватить блок состояния

Выберите тип состояния, которое требуется записать, и создайте блок состояния следующим образом:


```
IDirect3DStateBlock9* pStateBlock = NULL;
pd3dDevice->CreateStateBlock( D3DSBT_ALL, &pStateBlock );
```



[**IDirect3DDevice9:: креатестатеблокк**](/windows/desktop/api) создает блок состояния и автоматически фиксирует состояние устройства. Состояние устройства определяется типом блока State в первом аргументе. Это состояние может быть одним из следующих: все состояние устройства (см. раздел [Сохранение всех состояний устройства с помощью статеблокк (Direct3D 9)](saving-all-device-states-with-a-stateblock.md)), состояние пикселей (см. раздел [Сохранение состояния пикселов с помощью статеблокк (Direct3D 9)](saving-pixel-states-with-a-stateblock.md)) или все состояние вершины (см. раздел [Сохранение состояний вершин с помощью статеблокк (Direct3D 9)](saving-vertex-states-with-a-stateblock.md)).

Система эффектов использует блок состояния для сохранения состояния. После вызова [**ID3DXEffect:: Begin**](id3dxeffect--begin.md) создается блок состояния, а состояние фиксируется. При вызове [**ID3DXEffect:: end**](id3dxeffect--end.md) состояние блока состояния повторно применяется к устройству.

## <a name="capture-individual-states"></a>Захватить отдельные состояния

Чтобы сохранить пользовательскую последовательность состояния, заключите состояние, которое вы хотите сохранить, в паре [**IDirect3DDevice9:: бегинстатеблокк**](/windows/desktop/api) и [**IDirect3DDevice9:: ендстатеблокк**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-endstateblock) . Бегинстатеблокк сообщает текущему устройству о необходимости настроить блок состояния и добавить к нему все изменения состояния, происходящие до вызова Ендстатеблокк. Ниже приведен пример:


```
IDirect3DStateBlock9* pStateBlock = NULL;
pd3dDevice->BeginStateBlock();
pd3dDevice->SetRenderState ( D3DRS_ZENABLE, true );
pd3dDevice->EndStateBlock( &pStateBlock );
```



Это позволит сохранить любое количество изменений состояния в любой последовательности в пользовательском статеблокк. Позже, когда вы хотите использовать статеблокк для сброса состояния устройства, вызовите [**IDirect3DStateBlock9:: Apply**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dstateblock9-apply). Это приведет к перезаписи только состояния устройства, записанного в блоке состояния. Любое другое состояние устройства, которое не было захвачено настраиваемым статеблокк, не будет изменено. Опять же, поскольку объект статеблокк является интерфейсом, его необходимо освободить после завершения.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Состояния (Direct3D 9)](states.md)
</dt> </dl>

 

 
