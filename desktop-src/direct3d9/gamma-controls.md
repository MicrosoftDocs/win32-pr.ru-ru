---
description: Элементы управления гаммы позволяют изменить способ отображения содержимого поверхности системой, не влияя на содержимое самой поверхности.
ms.assetid: 74f106be-8f47-4875-9908-32ff35912968
title: Элементы управления гамма (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6484bcf7e8fa5e07a3bf4bb718cd361330560f8c
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104556478"
---
# <a name="gamma-controls-direct3d-9"></a><span data-ttu-id="01783-103">Элементы управления гамма (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="01783-103">Gamma Controls (Direct3D 9)</span></span>

<span data-ttu-id="01783-104">Элементы управления гаммы позволяют изменить способ отображения содержимого поверхности системой, не влияя на содержимое самой поверхности.</span><span class="sxs-lookup"><span data-stu-id="01783-104">Gamma controls allow you to change how the system displays the contents of the surface, without affecting the contents of the surface itself.</span></span> <span data-ttu-id="01783-105">Эти элементы управления можно рассматривать как очень простые фильтры, которые Direct3D применяют к данным, когда они оставляют поверхность, и до отрисовки на экране.</span><span class="sxs-lookup"><span data-stu-id="01783-105">Think of these controls as very simple filters that Direct3D applies to data as it leaves a surface and before it is rendered on the screen.</span></span>

<span data-ttu-id="01783-106">Элементы управления гаммы являются свойством цепочки буферов.</span><span class="sxs-lookup"><span data-stu-id="01783-106">Gamma controls are a property of a swap chain.</span></span> <span data-ttu-id="01783-107">Элементы управления гаммы позволяют динамически менять уровни красного, зеленого и синего уровней поверхности, сопоставленные с фактическими уровнями, отображаемыми системой.</span><span class="sxs-lookup"><span data-stu-id="01783-107">Gamma controls make it possible to dynamically change how a surface's red, green, and blue levels map to the actual levels that the system displays.</span></span> <span data-ttu-id="01783-108">Задавая уровни гаммы, можно вызвать вспышку экрана пользователя во Flash Colors — красный цвет при воссоздании символа пользователя, зеленый, когда символ берет на себя новый элемент, и т. д. без копирования новых изображений в буфер кадров для достижения этого результата.</span><span class="sxs-lookup"><span data-stu-id="01783-108">By setting gamma levels, you can cause the user's screen to flash colors - red when the user's character is shot, green when the character picks up a new item, and so on - without copying new images to the frame buffer to achieve the effect.</span></span> <span data-ttu-id="01783-109">Кроме того, можно изменить цветовые уровни, чтобы применить цветовой сдвиг к изображениям в обратном буфере.</span><span class="sxs-lookup"><span data-stu-id="01783-109">Or, you might adjust color levels to apply a color bias to the images in the back buffer.</span></span>

<span data-ttu-id="01783-110">Всегда существует по крайней мере одна цепочка буферов (неявная цепочка подкачки) для каждого устройства, так как Direct3D 9 имеет одну цепочку подкачки в качестве свойства устройства.</span><span class="sxs-lookup"><span data-stu-id="01783-110">There is always at least one swap chain (the implicit swap chain) for each device because Direct3D 9 has one swap chain as a property of the device.</span></span> <span data-ttu-id="01783-111">Так как гамма-шкала является свойством цепочки буферов, цветовая гамма может применяться, когда цепочка буферов перемещается в окно.</span><span class="sxs-lookup"><span data-stu-id="01783-111">Because the gamma ramp is a property of the swap chain, the gamma ramp can be applied when the swap chain is windowed.</span></span> <span data-ttu-id="01783-112">Гамма-шкала вступает в силу немедленно.</span><span class="sxs-lookup"><span data-stu-id="01783-112">The gamma ramp takes effect immediately.</span></span> <span data-ttu-id="01783-113">Отсутствует ожидание операции вертикальной синхронизации.</span><span class="sxs-lookup"><span data-stu-id="01783-113">There is no waiting for a vertical sync operation.</span></span>

<span data-ttu-id="01783-114">Методы [**сетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) и [**жетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) позволяют управлять уровнями пандуса, влияющими на цветовые компоненты красного, зеленого и синего цветов пикселей, до того, как они будут отправлены в цифровой преобразователь (DAC) для отображения.</span><span class="sxs-lookup"><span data-stu-id="01783-114">The [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) and [**GetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) methods allow you to manipulate ramp levels that affect the red, green, and blue color components of pixels from the surface before they are sent to the digital-to-analog converter (DAC) for display.</span></span>

## <a name="gamma-ramp-levels"></a><span data-ttu-id="01783-115">Уровни гамма-пандус</span><span class="sxs-lookup"><span data-stu-id="01783-115">Gamma Ramp Levels</span></span>

<span data-ttu-id="01783-116">В Direct3D термин "гамма-шкала" описывает набор значений, которые сопоставляют уровень определенного компонента цвета — красный, зеленый, синий — для всех пикселов в буфере кадров до новых уровней, полученных DAC для отображения.</span><span class="sxs-lookup"><span data-stu-id="01783-116">In Direct3D, the term gamma ramp describes a set of values that map the level of a particular color component - red, green, blue - for all pixels in the frame buffer to new levels that are received by the DAC for display.</span></span> <span data-ttu-id="01783-117">Повторное сопоставление выполняется тремя таблицами поиска, по одному для каждого компонента цвета.</span><span class="sxs-lookup"><span data-stu-id="01783-117">The remapping is performed by way of three look-up tables, one for each color component.</span></span>

<span data-ttu-id="01783-118">Вот как это работает: Direct3D принимает пиксель из буфера кадров и оценивает отдельные компоненты красного, зеленого и синего цветов.</span><span class="sxs-lookup"><span data-stu-id="01783-118">Here's how it works: Direct3D takes a pixel from the frame buffer and evaluates its individual red, green, and blue color components.</span></span> <span data-ttu-id="01783-119">Каждый компонент представлен значением от 0 до 65535.</span><span class="sxs-lookup"><span data-stu-id="01783-119">Each component is represented by a value from 0 to 65535.</span></span> <span data-ttu-id="01783-120">Direct3D принимает исходное значение и использует его для индексации массива из 256 элементов (пандус), где каждый элемент содержит значение, заменяющее исходный.</span><span class="sxs-lookup"><span data-stu-id="01783-120">Direct3D takes the original value and uses it to index a 256-element array (the ramp), where each element contains a value that replaces the original one.</span></span> <span data-ttu-id="01783-121">Direct3D выполняет этот процесс поиска и замены для каждого цветового компонента каждого пикселя в буфере кадров, тем самым изменяя окончательные цвета для всех экранных пикселей.</span><span class="sxs-lookup"><span data-stu-id="01783-121">Direct3D performs this look-up and replace process for each color component of each pixel in the frame buffer, thereby changing the final colors for all the on-screen pixels.</span></span>

<span data-ttu-id="01783-122">Можно визуализировать значения пандуса, выполнив их графику, как показано на следующих двух диаграммах.</span><span class="sxs-lookup"><span data-stu-id="01783-122">It's handy to visualize the ramp values by graphing them, as shown in the following two graphs.</span></span> <span data-ttu-id="01783-123">На левой диаграмме показана шкала, которая не изменяет цвета.</span><span class="sxs-lookup"><span data-stu-id="01783-123">The left graph shows a ramp that doesn't modify colors at all.</span></span> <span data-ttu-id="01783-124">На правой диаграмме показана шкала, которая накладывает отрицательный сдвиг на компонент цвета, к которому он применяется.</span><span class="sxs-lookup"><span data-stu-id="01783-124">The right graph shows a ramp that imposes a negative bias to the color component to which it is applied.</span></span>

![графики значений гамма-шкалы](images/gammalv.png)

<span data-ttu-id="01783-126">Элементы массива для графа слева содержат значения, идентичные их индексу-0 в элементе с индексом 0 и 65535 в индексе 255.</span><span class="sxs-lookup"><span data-stu-id="01783-126">The array elements for the graph on the left contain values identical to their index - 0 in the element at index 0, and 65535 at index 255.</span></span> <span data-ttu-id="01783-127">Этот тип пандус является значением по умолчанию, так как перед отображением входные значения не изменяются.</span><span class="sxs-lookup"><span data-stu-id="01783-127">This type of ramp is the default, as it doesn't change the input values before they're displayed.</span></span> <span data-ttu-id="01783-128">Правильная диаграмма предоставляет больше вариантов; его пандус содержит значения в диапазоне от 0 в первом элементе до 32768 в последнем элементе с одинаковым диапазоном значений между.</span><span class="sxs-lookup"><span data-stu-id="01783-128">The right graph provides more variation; its ramp contains values that range from 0 in the first element to 32768 in the last element, with values ranging uniformly in between.</span></span> <span data-ttu-id="01783-129">В результате на экране отображается отключенный компонент цвета, использующий эту шкалу.</span><span class="sxs-lookup"><span data-stu-id="01783-129">The effect is that the color component that uses this ramp appears muted on the display.</span></span> <span data-ttu-id="01783-130">Вы не ограничены использованием линейных диаграмм; Если при необходимости приложение может назначить произвольное сопоставление.</span><span class="sxs-lookup"><span data-stu-id="01783-130">You are not limited to using linear graphs; if your application can assign arbitrary mapping if needed.</span></span> <span data-ttu-id="01783-131">Можно даже задать для записей все нули, чтобы полностью удалить компонент цвета из экрана.</span><span class="sxs-lookup"><span data-stu-id="01783-131">You can even set the entries to all zeroes to remove a color component completely from the display.</span></span>

## <a name="setting-and-retrieving-gamma-ramp-levels"></a><span data-ttu-id="01783-132">Установка и получение уровней гамма-шкалы</span><span class="sxs-lookup"><span data-stu-id="01783-132">Setting and Retrieving Gamma Ramp Levels</span></span>

<span data-ttu-id="01783-133">Уровни цветовой гаммы — это фактические таблицы, используемые Direct3D для соответствия компонентов цвета буфера кадров с новыми уровнями, которые будут отображены.</span><span class="sxs-lookup"><span data-stu-id="01783-133">Gamma ramp levels are effectively look-up tables that Direct3D uses to map the frame buffer color components to new levels that will be displayed.</span></span> <span data-ttu-id="01783-134">Можно задать и получить уровни пандуса для основной поверхности, вызвав методы [**сетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) и [**жетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) .</span><span class="sxs-lookup"><span data-stu-id="01783-134">You can set and retrieve ramp levels for the primary surface by calling the [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) and [**GetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) methods.</span></span> <span data-ttu-id="01783-135">**Сетгаммарамп** принимает два параметра, а **жетгаммарамп** принимает один параметр.</span><span class="sxs-lookup"><span data-stu-id="01783-135">**SetGammaRamp** accepts two parameters and **GetGammaRamp** accepts one parameter.</span></span> <span data-ttu-id="01783-136">Для **сетгаммарамп** первым параметром является либо D3DSGR \_ калибровка, либо D3DSGR \_ без \_ калибровки.</span><span class="sxs-lookup"><span data-stu-id="01783-136">For **SetGammaRamp**, the first parameter is either D3DSGR\_CALIBRATE or D3DSGR\_NO\_CALIBRATION.</span></span> <span data-ttu-id="01783-137">Второй параметр, Прамп, является указателем на структуру [**D3DGAMMARAMP**](d3dgammaramp.md) .</span><span class="sxs-lookup"><span data-stu-id="01783-137">The second parameter, pRamp, is a pointer to a [**D3DGAMMARAMP**](d3dgammaramp.md) structure.</span></span> <span data-ttu-id="01783-138">Структура **D3DGAMMARAMP** содержит массивы из 3 256 элементов, каждый из которых содержит красный, зеленый и синий цветовые гамма.</span><span class="sxs-lookup"><span data-stu-id="01783-138">The **D3DGAMMARAMP** structure contains three 256-element arrays of WORDs, one array each to contain the red, green, and blue gamma ramps.</span></span> <span data-ttu-id="01783-139">**Жетгаммарамп** имеет один параметр, который принимает указатель на тип **D3DGAMMARAMP** , который будет заполнен текущей гаммой шкалы.</span><span class="sxs-lookup"><span data-stu-id="01783-139">**GetGammaRamp** has one parameter that takes a pointer to a **D3DGAMMARAMP** type that will be filled with the current gamma ramp.</span></span>

<span data-ttu-id="01783-140">Можно включить \_ значение калибровки D3DSGR для первого параметра [**сетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) , чтобы вызвать калибратора при задании новых уровней гаммы.</span><span class="sxs-lookup"><span data-stu-id="01783-140">You can include the D3DSGR\_CALIBRATE value for the first parameter of [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) to invoke the calibrator when setting new gamma levels.</span></span> <span data-ttu-id="01783-141">Калибровка цветовых гамм влияет на определенные затраты на обработку и не следует часто использовать.</span><span class="sxs-lookup"><span data-stu-id="01783-141">Calibrating gamma ramps incurs some processing overhead, and should not be used frequently.</span></span> <span data-ttu-id="01783-142">Задание калибровки гамма-шкалы обеспечивает единообразное и абсолютное значение гаммы для пользователя, независимо от адаптера дисплея и монитора.</span><span class="sxs-lookup"><span data-stu-id="01783-142">Setting a calibrated gamma ramp provides a consistent and absolute gamma value for the user, regardless of the display adapter and monitor.</span></span>

<span data-ttu-id="01783-143">Не все системы поддерживают гамма-калибровку.</span><span class="sxs-lookup"><span data-stu-id="01783-143">Not all systems support gamma calibration.</span></span> <span data-ttu-id="01783-144">Чтобы определить, поддерживается ли гамма-калибровка, вызовите [**жетдевицекапс**](/windows/desktop/api)и изучите элемент Caps2 связанной структуры [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) после того, как метод вернет значение.</span><span class="sxs-lookup"><span data-stu-id="01783-144">To determine if gamma calibration is supported, call [**GetDeviceCaps**](/windows/desktop/api), and examine the Caps2 member of the associated [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) structure after the method returns.</span></span> <span data-ttu-id="01783-145">Если установлен \_ флаг возможностей D3DCAPS2 канкалибратегамма, то поддерживается гамма-калибровка.</span><span class="sxs-lookup"><span data-stu-id="01783-145">If the D3DCAPS2\_CANCALIBRATEGAMMA capability flag is present, then gamma calibration is supported.</span></span>

<span data-ttu-id="01783-146">При установке новых уровней пандус учитывайте, что уровни, заданные в массивах, используются только в том случае, если приложение находится в полноэкранном и монопольном режиме.</span><span class="sxs-lookup"><span data-stu-id="01783-146">When setting new ramp levels, keep in mind that the levels you set in the arrays are only used when your application is in full-screen, exclusive mode.</span></span> <span data-ttu-id="01783-147">Всякий раз, когда приложение меняется в нормальный режим, уровни пандуса откладываются, снова вступают в действие, когда приложение перейдет в полноэкранный режим.</span><span class="sxs-lookup"><span data-stu-id="01783-147">Whenever your application changes to normal mode, the ramp levels are set aside, taking effect again when the application reinstates full-screen mode.</span></span>

<span data-ttu-id="01783-148">Если устройство не поддерживает цветовые гаммы в текущем режиме представления цепочки буферов (полноэкранный или оконный), значение ошибки не возвращается.</span><span class="sxs-lookup"><span data-stu-id="01783-148">If the device does not support gamma ramps in the swap chain's current presentation mode (full-screen or windowed), no error value is returned.</span></span> <span data-ttu-id="01783-149">Приложения могут проверить \_ биты возможностей D3DCAPS2 фуллскрингамма и D3DCAPS2 \_ канкалибратегамма в элементе CAPS2 типа D3DCAPS9, чтобы определить возможности устройства и установить калибратора.</span><span class="sxs-lookup"><span data-stu-id="01783-149">Applications can check the D3DCAPS2\_FULLSCREENGAMMA and D3DCAPS2\_CANCALIBRATEGAMMA capability bits in the Caps2 member of the D3DCAPS9 type to determine the capabilities of the device and whether a calibrator is installed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="01783-150">См. также</span><span class="sxs-lookup"><span data-stu-id="01783-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="01783-151">Поверхности Direct3D</span><span class="sxs-lookup"><span data-stu-id="01783-151">Direct3D Surfaces</span></span>](direct3d-surfaces.md)
</dt> </dl>

 

 
