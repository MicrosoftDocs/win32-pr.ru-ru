---
description: Цепочка буферов — это коллекция буферов для отображения кадров пользователю.
ms.assetid: aefc0680-cbe6-42eb-8c00-eaa343eee469
title: Что такое цепочка подкачки? (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7c8fc1fd2d313c70a680d9b276a3aabedc6d8cff
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104262334"
---
# <a name="what-is-a-swap-chain-direct3d-9"></a><span data-ttu-id="ed74b-104">Что такое цепочка подкачки?</span><span class="sxs-lookup"><span data-stu-id="ed74b-104">What Is a Swap Chain?</span></span> <span data-ttu-id="ed74b-105">(Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="ed74b-105">(Direct3D 9)</span></span>

<span data-ttu-id="ed74b-106">Цепочка буферов — это коллекция буферов для отображения кадров пользователю.</span><span class="sxs-lookup"><span data-stu-id="ed74b-106">A swap chain is a collection of buffers that are used for displaying frames to the user.</span></span> <span data-ttu-id="ed74b-107">Каждый раз, когда приложение представляет новый кадр для отображение, первый буфер в цепочке буферов занимает место отображаемого буфера.</span><span class="sxs-lookup"><span data-stu-id="ed74b-107">Each time an application presents a new frame for display, the first buffer in the swap chain takes the place of the displayed buffer.</span></span> <span data-ttu-id="ed74b-108">Этот процесс называется заменой или переключением.</span><span class="sxs-lookup"><span data-stu-id="ed74b-108">This process is called swapping or flipping.</span></span>

<span data-ttu-id="ed74b-109">Графический адаптер хранит указатель на поверхность с изображением, отображаемым на мониторе. Эта поверхность называется кадровым буфером.</span><span class="sxs-lookup"><span data-stu-id="ed74b-109">A graphics adapter holds a pointer to a surface that represents the image being displayed on the monitor, called a front buffer.</span></span> <span data-ttu-id="ed74b-110">По мере обновления монитора, графическая плата отправляет содержимое кадрового буфера для показа на мониторе.</span><span class="sxs-lookup"><span data-stu-id="ed74b-110">As the monitor is refreshed, the graphics card sends the contents of the front buffer to the monitor to be displayed.</span></span> <span data-ttu-id="ed74b-111">Однако это приводит к возникновению проблемы при визуализации графики в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="ed74b-111">However, this leads to a problem when rendering real-time graphics.</span></span> <span data-ttu-id="ed74b-112">Причина проблемы заключается в том частота обновления монитора гораздо медленнее по сравнению с остальным компьютером.</span><span class="sxs-lookup"><span data-stu-id="ed74b-112">The heart of the problem is that monitor refresh rates are very slow in comparison to the rest of the computer.</span></span> <span data-ttu-id="ed74b-113">Обычно частота обновления варьируются от 60 Гц (60 раз в секунду) до 100 Гц.</span><span class="sxs-lookup"><span data-stu-id="ed74b-113">Common refresh rates range from 60 Hz (60 times per second) to 100 Hz.</span></span> <span data-ttu-id="ed74b-114">Если приложение обновит кадровый буфер пока монитор находится в середине обновления, показанное изображение будет разрезано пополам, при этом в верхней части будет старое изображение, а в нижней новое.</span><span class="sxs-lookup"><span data-stu-id="ed74b-114">If your application is updating the front buffer while the monitor is in the middle of a refresh, the image that is displayed will be cut in half with the upper half of the display containing the old image and the lower half containing the new image.</span></span> <span data-ttu-id="ed74b-115">Эта проблема называется разрывами.</span><span class="sxs-lookup"><span data-stu-id="ed74b-115">This problem is referred to as tearing.</span></span>

<span data-ttu-id="ed74b-116">В Direct3D реализовано два варианта предотвращения разрывов:</span><span class="sxs-lookup"><span data-stu-id="ed74b-116">Direct3D implements two options to avoid tearing:</span></span>

-   <span data-ttu-id="ed74b-117">Первый вариант — разрешить обновления монитора только при операции вертикального обратного хода (или вертикальной синхронизации).</span><span class="sxs-lookup"><span data-stu-id="ed74b-117">An option to only allow updates of the monitor on the vertical retrace (or vertical sync) operation.</span></span> <span data-ttu-id="ed74b-118">Монитор обычно обновляет свое изображение, перемещая точечный свет горизонтально, зигзагами от верхнего левого угла к нижнему правому.</span><span class="sxs-lookup"><span data-stu-id="ed74b-118">A monitor typically refreshes its image by moving a light pin horizontally, zigzagging from the top left of the monitor and ending at the bottom right.</span></span> <span data-ttu-id="ed74b-119">Когда точечный свет доходит до низа, монитор повторно калибрует его, перемещая точечный свет обратно в верхний левый угол для повторения цикла.</span><span class="sxs-lookup"><span data-stu-id="ed74b-119">When the light pin reaches the bottom, the monitor recalibrates the light pin by moving it back to the upper left so that the process can start again.</span></span> <span data-ttu-id="ed74b-120">Такую повторную калибровку называют вертикальной синхронизацией. Во время вертикальной синхронизации монитор ничего не рисует, поэтому любое обновление в кадровый буфер не будет показано, пока монитор снова не начнет цикл отрисовки.</span><span class="sxs-lookup"><span data-stu-id="ed74b-120">This recalibration is called a vertical sync. During a vertical sync, the monitor is not drawing anything, so any update to the front buffer will not be seen until the monitor starts to draw again.</span></span> <span data-ttu-id="ed74b-121">Вертикальная синхронизация проходит довольно медленно, однако не настолько медленно, чтобы успеть прорисовать сложную сцену.</span><span class="sxs-lookup"><span data-stu-id="ed74b-121">The vertical sync is relatively slow; however, not slow enough to render a complex scene while waiting.</span></span> <span data-ttu-id="ed74b-122">Чтобы избежать разрывов и отобразить сложную сцены, нужен процесс, который называется задней (фоновой) буферизацией.</span><span class="sxs-lookup"><span data-stu-id="ed74b-122">What is needed to avoid tearing and be able to render complex scenes is a process called back buffering.</span></span>
-   <span data-ttu-id="ed74b-123">Вариант с использованием метода задней буферизации.</span><span class="sxs-lookup"><span data-stu-id="ed74b-123">An option to use a technique called back buffering.</span></span> <span data-ttu-id="ed74b-124">Задняя буферизация — это процесс рисования сцены на плоскость вне экрана, которая называется задним буфером.</span><span class="sxs-lookup"><span data-stu-id="ed74b-124">Back buffering is the process of drawing a scene to an off-screen surface, called a back buffer.</span></span> <span data-ttu-id="ed74b-125">Обратите внимание, что любая поверхность, отличная от переднего буфера, называется экранной поверхностью, так как она никогда не просматривается монитором напрямую.</span><span class="sxs-lookup"><span data-stu-id="ed74b-125">Note that any surface other than the front buffer is called an off-screen surface because it is never directly viewed by the monitor.</span></span> <span data-ttu-id="ed74b-126">С помощью заднего буфера приложение имеет возможность рисовать сцену при всяком простое системы (то есть когда нет ожидающих обработки оконных сообщений)без необходимости учитывать частоту обновления монитора.</span><span class="sxs-lookup"><span data-stu-id="ed74b-126">By using a back buffer, an application has the freedom to render a scene whenever the system is idle (that is, no windows messages are waiting) without having to consider the monitor's refresh rate.</span></span> <span data-ttu-id="ed74b-127">Задняя буферизация подразумевает одну дополнительную сложность — когда и как перемещать задний буфер в кадровый буфер.</span><span class="sxs-lookup"><span data-stu-id="ed74b-127">Back buffering brings in an additional complication of how and when to move the back buffer to the front buffer.</span></span>

<span data-ttu-id="ed74b-128">Процесс перемещения заднего буфера в кадровый буфер называется зеркальным отображением.</span><span class="sxs-lookup"><span data-stu-id="ed74b-128">The process of moving the back buffer to the front buffer is called surface flipping.</span></span> <span data-ttu-id="ed74b-129">Так как графическая плата просто использует указатель на поверхность для представления кадрового буфера, то для переключения заднего буфера на кадровый требуется простая смена указателя.</span><span class="sxs-lookup"><span data-stu-id="ed74b-129">Because the graphics card simply uses a pointer to a surface to represent the front buffer, a simple pointer change is all that is needed to set the back buffer to the front buffer.</span></span> <span data-ttu-id="ed74b-130">Когда приложение посредством Direct3D отправляет задний буфер в кадровый буфер, Direct3D просто «зеркально отражает» (можно сказать переворачивает) два указателя на поверхности.</span><span class="sxs-lookup"><span data-stu-id="ed74b-130">When an application asks Direct3D to present the back buffer to the front buffer, Direct3D simply "flips" the two surface pointers.</span></span> <span data-ttu-id="ed74b-131">Результат — задний буфер станет новым кадровым буфером, а старый кадровый буфер новым задним.</span><span class="sxs-lookup"><span data-stu-id="ed74b-131">The result is that the back buffer is now the new front buffer, and the old front buffer is the new back buffer.</span></span> <span data-ttu-id="ed74b-132">Переворот поверхности вызывается каждый раз, когда приложение запрашивает Direct3D устройство показать задний буфер. Однако Direct3D может быть настроен так, что ставить эти запросы в очереди, пока не начнется вертикальная синхронизации.</span><span class="sxs-lookup"><span data-stu-id="ed74b-132">A surface flip is invoked whenever an application asks the Direct3D device to present the back buffer; however, Direct3D can be set up to queue the requests until a vertical sync occurs.</span></span> <span data-ttu-id="ed74b-133">Этот вариант называется интервалом презентации Direct3D устройства.</span><span class="sxs-lookup"><span data-stu-id="ed74b-133">This option is referred to as the Direct3D device's presentation interval.</span></span> <span data-ttu-id="ed74b-134">Обратите внимание, что данные в новом обратном буфере могут быть недоступны для повторного использования в зависимости от того, как приложение определяет, как Direct3D должен обрабатывать зеркальное отображение поверхности.</span><span class="sxs-lookup"><span data-stu-id="ed74b-134">Note that the data in the new back buffer may not be reusable, depending on how an application specifies how Direct3D should handle surface flipping.</span></span> <span data-ttu-id="ed74b-135">Зеркальное отражение очень важно в мультимедийных, анимационных приложениях и играх, это способ поход на анимирование персонажей на листах блокнота.</span><span class="sxs-lookup"><span data-stu-id="ed74b-135">Surface flipping is key in multimedia, animation, and game software; it is equivalent to the way you can do animation with a pad of paper.</span></span> <span data-ttu-id="ed74b-136">На каждой странице художник слегка меняет фигуры, так что при быстром пролистывании блокнота рисунок кажется анимированным.</span><span class="sxs-lookup"><span data-stu-id="ed74b-136">On each page, the artist changes the figures slightly, so that when you flip rapidly between sheets, the drawing appears animated.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ed74b-137">См. также</span><span class="sxs-lookup"><span data-stu-id="ed74b-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ed74b-138">Поверхности Direct3D</span><span class="sxs-lookup"><span data-stu-id="ed74b-138">Direct3D Surfaces</span></span>](direct3d-surfaces.md)
</dt> <dt>

[<span data-ttu-id="ed74b-139">Зеркальное отображение поверхностей (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="ed74b-139">Flipping Surfaces (Direct3D 9)</span></span>](flipping-surfaces.md)
</dt> </dl>

 

 



