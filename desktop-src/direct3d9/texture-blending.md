---
description: Direct3D может накладывать на примитивы до восьми текстур за один проход.
ms.assetid: vs|directx_sdk|~\texture_blending.htm
title: Смешение текстур (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6a89a87160bb85c1f62339380d46fa4b39736609
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "103806863"
---
# <a name="texture-blending-direct3d-9"></a><span data-ttu-id="845e2-103">Смешение текстур (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-103">Texture Blending (Direct3D 9)</span></span>

<span data-ttu-id="845e2-104">Direct3D может накладывать на примитивы до восьми текстур за один проход.</span><span class="sxs-lookup"><span data-stu-id="845e2-104">Direct3D can blend as many as eight textures onto primitives in a single pass.</span></span> <span data-ttu-id="845e2-105">Использование множественного наложения текстур способно значительно увеличить частоту кадров приложения Direct3D.</span><span class="sxs-lookup"><span data-stu-id="845e2-105">The use of multiple texture blending can profoundly increase the frame rate of a Direct3D application.</span></span> <span data-ttu-id="845e2-106">Приложения используют множественное наложение текстур для нанесения текстур, теней, зеркального освещения, рассеянного освещения и других специальных эффектов за один проход.</span><span class="sxs-lookup"><span data-stu-id="845e2-106">An application employs multiple texture blending to apply textures, shadows, specular lighting, diffuse lighting, and other special effects in a single pass.</span></span>

<span data-ttu-id="845e2-107">Чтобы использовать наложение текстур, приложению необходимо сначала проверить, поддерживает ли оно оборудованием пользователя.</span><span class="sxs-lookup"><span data-stu-id="845e2-107">To use texture blending, your application should first check if the user's hardware supports it.</span></span> <span data-ttu-id="845e2-108">Эти сведения находятся в элементе Текстурекапс структуры [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) .</span><span class="sxs-lookup"><span data-stu-id="845e2-108">This information is found in the TextureCaps member of the [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) structure.</span></span> <span data-ttu-id="845e2-109">Дополнительные сведения о том, как запросить оборудование пользователя для возможностей смешения текстур, см. в разделе [**IDirect3DDevice9:: жетдевицекапс**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span><span class="sxs-lookup"><span data-stu-id="845e2-109">For details about how to query the user's hardware for texture blending capabilities, see [**IDirect3DDevice9::GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span></span>

## <a name="texture-stages-and-the-texture-blending-cascade"></a><span data-ttu-id="845e2-110">Этапы текстуры и смешение текстур</span><span class="sxs-lookup"><span data-stu-id="845e2-110">Texture Stages and the Texture Blending Cascade</span></span>

<span data-ttu-id="845e2-111">Direct3D поддерживает однопроходное наложение нескольких текстур посредством использования шагов текстурирования.</span><span class="sxs-lookup"><span data-stu-id="845e2-111">Direct3D supports single-pass multiple texture blending through the use of texture stages.</span></span> <span data-ttu-id="845e2-112">Шаг текстурирования получает два аргумента и выполняет с ними операцию наложения, передавая результат для дальнейшей обработки или растеризации.</span><span class="sxs-lookup"><span data-stu-id="845e2-112">A texture stage takes two arguments and performs a blending operation on them, passing on the result for further processing or for rasterization.</span></span> <span data-ttu-id="845e2-113">Шаг текстурирования можно изобразить, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="845e2-113">You can visualize a texture stage as shown in the following diagram.</span></span>

![Схема шага текстурирования](images/texstg.png)

<span data-ttu-id="845e2-115">Как показано на схеме выше, на шаге текстурирования происходит наложение двух аргументов с помощью определенного оператора.</span><span class="sxs-lookup"><span data-stu-id="845e2-115">As the preceding diagram shows, texture stages blend two arguments by using a specified operator.</span></span> <span data-ttu-id="845e2-116">Среди типичных операций — простая модуляция или добавления цветовых или альфа-компонентов аргументов. При этом поддерживается более двух десятков операций.</span><span class="sxs-lookup"><span data-stu-id="845e2-116">Common operations include simple modulation or addition of the color or alpha components of the arguments, but more than two dozen operations are supported.</span></span> <span data-ttu-id="845e2-117">Аргументами для шага текстурирования могут являться связанные текстуры, обработанный цвет или альфа-канал (обработка происходит во время заливки Гуро), произвольный цвет и альфа-канал или результат предыдущего шага текстурирования.</span><span class="sxs-lookup"><span data-stu-id="845e2-117">The arguments for a stage can be an associated texture, the iterated color or alpha (iterated during Gouraud shading), arbitrary color and alpha, or the result from the previous texture stage.</span></span> <span data-ttu-id="845e2-118">Дополнительные сведения см. в разделе [операции смешения текстур и аргументы (Direct3D 9)](texture-blending-operations-and-arguments.md).</span><span class="sxs-lookup"><span data-stu-id="845e2-118">For more information, see [Texture Blending Operations and Arguments (Direct3D 9)](texture-blending-operations-and-arguments.md).</span></span>

> [!Note]  
> <span data-ttu-id="845e2-119">Direct3D отличает смешение цветов от альфа-смешения.</span><span class="sxs-lookup"><span data-stu-id="845e2-119">Direct3D distinguishes color blending from alpha blending.</span></span> <span data-ttu-id="845e2-120">Приложения задают операции и аргументы наложения цвета и альфа-канала по отдельности, и результаты этих параметров не зависят друг от друга.</span><span class="sxs-lookup"><span data-stu-id="845e2-120">Applications set blending operations and arguments for color and alpha individually, and the results of those settings are independent of one another.</span></span>

 

<span data-ttu-id="845e2-121">Сочетание аргументов и операций, производимых в ходе различных этапов наложения, определяет простой язык наложения на основе потока.</span><span class="sxs-lookup"><span data-stu-id="845e2-121">The combination of arguments and operations used by multiple blending stages define a simple flow-based blending language.</span></span> <span data-ttu-id="845e2-122">Результаты одного этапа перетекают на другой, потом на следующий и т. д.</span><span class="sxs-lookup"><span data-stu-id="845e2-122">The results from one stage flow down to another stage, from that stage to the next, and so on.</span></span> <span data-ttu-id="845e2-123">Концепцию перетекания результатов из одного этапа в другой перед конечной растеризацией на многоугольнике часто называют каскадом наложения текстур.</span><span class="sxs-lookup"><span data-stu-id="845e2-123">The concept of results flowing from stage to stage to eventually be rasterized on a polygon is often called the texture blending cascade.</span></span> <span data-ttu-id="845e2-124">На следующей схеме показано, как отдельные шаги текстурирования составляют каскад наложения текстур.</span><span class="sxs-lookup"><span data-stu-id="845e2-124">The following diagram shows how individual texture stages make up the texture blending cascade.</span></span>

![схема шагов текстурирования в каскаде наложения текстур](images/tcascade.png)

<span data-ttu-id="845e2-126">Каждый шаг на устройстве имеет индекс с отчетом от нуля</span><span class="sxs-lookup"><span data-stu-id="845e2-126">Each stage in a device has a zero-based index.</span></span> <span data-ttu-id="845e2-127">Direct3D поддерживает до восьми этапов наложения, однако следует всегда проверять возможности устройства, чтобы определить, сколько этапов поддерживает именно оно.</span><span class="sxs-lookup"><span data-stu-id="845e2-127">Direct3D allows up to eight blending stages, although you should always check device capabilities to determine how many stages the current hardware supports.</span></span> <span data-ttu-id="845e2-128">Первый этап наложения имеет индекс 0, второй — 1 и т. д., вплоть до 7.</span><span class="sxs-lookup"><span data-stu-id="845e2-128">The first blending stage is at index 0, the second is at 1, and so on, up to index 7.</span></span> <span data-ttu-id="845e2-129">Система накладывает этапы в порядке возрастания индекса.</span><span class="sxs-lookup"><span data-stu-id="845e2-129">The system blends stages in increasing index order.</span></span>

<span data-ttu-id="845e2-130">Используйте только необходимое количество этапов; по умолчанию неиспользуемые этапы отключаются.</span><span class="sxs-lookup"><span data-stu-id="845e2-130">Use only the number of stages you need; the unused blending stages are disabled by default.</span></span> <span data-ttu-id="845e2-131">Поэтому если приложение использует только первые два этапа, необходимо настроить операции и аргументы только для этапа 0 и 1.</span><span class="sxs-lookup"><span data-stu-id="845e2-131">So, if your application only uses the first two stages, it need only set operations and arguments for stage 0 and 1.</span></span> <span data-ttu-id="845e2-132">Система обрабатывает эти два этапа и игнорирует отключенные этапы.</span><span class="sxs-lookup"><span data-stu-id="845e2-132">The system blends the two stages, and ignores the disabled stages.</span></span>

> [!Note]  
> <span data-ttu-id="845e2-133">Если количество этапов в вашем приложении меняется в зависимости от ситуации, например если для некоторых объектов используется четыре этапа, а для других — только два, не нужно явно отключать все ранее использованные этапы.</span><span class="sxs-lookup"><span data-stu-id="845e2-133">If your application varies the number of stages it uses for different situations - such as four stages for some objects, and only two for others - you don't need to explicitly disable all previously used stages.</span></span> <span data-ttu-id="845e2-134">Можно отключить операцию цвета для первого неиспользуемого этапа, тогда все этапы с более высоким индексом применены не будут.</span><span class="sxs-lookup"><span data-stu-id="845e2-134">One option is to disable the color operation for the first unused stage, then all stages with a higher index will not be applied.</span></span> <span data-ttu-id="845e2-135">Кроме того, можно полностью отключить сопоставление текстур, установив для первой стадии текстуры (этап 0) значение D3DTOP \_ disable.</span><span class="sxs-lookup"><span data-stu-id="845e2-135">Another option is to disable texture mapping altogether by setting the color operation for the first texture stage (stage 0) to D3DTOP\_DISABLE.</span></span> <span data-ttu-id="845e2-136">Третьим вариантом является то, что стадия текстуры имеет D3DTSS \_ COLORARG1, равную \_ ТЕКСТУРе D3DTA, а указатель текстуры для этапа — **null**, этот этап и все этапы после этого не обрабатываются.</span><span class="sxs-lookup"><span data-stu-id="845e2-136">A third option is when a texture stage has D3DTSS\_COLORARG1 equal to D3DTA\_TEXTURE and the texture pointer for the stage is **NULL**, this stage and all stages after it are not processed.</span></span>

 

<span data-ttu-id="845e2-137">Дополнительные сведения содержатся в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="845e2-137">Additional information is contained in the following topics.</span></span>

-   [<span data-ttu-id="845e2-138">Операции и аргументы смешения текстур (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-138">Texture Blending Operations and Arguments (Direct3D 9)</span></span>](texture-blending-operations-and-arguments.md)
-   [<span data-ttu-id="845e2-139">Назначение текущих текстур (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-139">Assigning the Current Textures (Direct3D 9)</span></span>](assigning-the-current-textures.md)
-   [<span data-ttu-id="845e2-140">Создание стадий смешения (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-140">Creating Blending Stages (Direct3D 9)</span></span>](creating-blending-stages.md)
-   [<span data-ttu-id="845e2-141">Смешение текстур альфа (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-141">Alpha Texture Blending (Direct3D 9)</span></span>](alpha-texture-blending.md)
-   [<span data-ttu-id="845e2-142">Многопроходное смешение текстур (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-142">Multipass Texture Blending (Direct3D 9)</span></span>](multipass-texture-blending.md)
-   [<span data-ttu-id="845e2-143">Светлое сопоставление с текстурами (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="845e2-143">Light Mapping with Textures (Direct3D 9)</span></span>](light-mapping-with-textures.md)

## <a name="related-topics"></a><span data-ttu-id="845e2-144">См. также</span><span class="sxs-lookup"><span data-stu-id="845e2-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="845e2-145">Текстуры Direct3D</span><span class="sxs-lookup"><span data-stu-id="845e2-145">Direct3D Textures</span></span>](direct3d-textures.md)
</dt> </dl>

 

 
