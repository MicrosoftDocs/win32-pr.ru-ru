---
description: Вкратце, перенос текстур изменяет базовый способ, которым Direct3D преобразует текстурированные многоугольники с помощью координат текстуры, указанных для каждой вершины.
ms.assetid: 00683d3f-3e3c-4ee4-9aec-a0d7fd9c8941
title: Перенос текстур (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d7c0f8cb6d7793536999d5f3df128849572d3dd
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104537217"
---
# <a name="texture-wrapping-direct3d-9"></a><span data-ttu-id="22f9d-103">Перенос текстур (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="22f9d-103">Texture Wrapping (Direct3D 9)</span></span>

<span data-ttu-id="22f9d-104">Вкратце, перенос текстур изменяет базовый способ, которым Direct3D преобразует текстурированные многоугольники с помощью координат текстуры, указанных для каждой вершины.</span><span class="sxs-lookup"><span data-stu-id="22f9d-104">In short, texture wrapping changes the basic way that Direct3D rasterizes textured polygons using the texture coordinates specified for each vertex.</span></span> <span data-ttu-id="22f9d-105">Во время растеризации многоугольника система выполняет интерполяцию между координатами текстуры в каждой вершине многоугольника для определения текселя, который должен использоваться для каждого пикселя многоугольника.</span><span class="sxs-lookup"><span data-stu-id="22f9d-105">While rasterizing a polygon, the system interpolates between the texture coordinates at each of the polygon's vertices to determine the texels that should be used for every pixel of the polygon.</span></span> <span data-ttu-id="22f9d-106">Как правило, система воспринимает текстуры как двухмерные плоскости, интерполируя новые тексели, используя короткий маршрут из точки А текстуры в точку Б. Если точка А представляет собой координаты на текстуре 0,8 и 0,1, а точка Б — координаты 0,1 и 0,1, то линия интерполяции выглядит так, как представлено на следующей диаграмме.</span><span class="sxs-lookup"><span data-stu-id="22f9d-106">Normally, the system treats the texture as a 2D plane, interpolating new texels by taking the shortest route from point A within a texture to point B. If point A represents the u, v position (0.8, 0.1), and point B is at (0.1,0.1), the line of interpolation looks like the following diagram.</span></span>

![Диаграмма линии интерполяции между двумя точками](images/interp1.png)

<span data-ttu-id="22f9d-108">Обратите внимание, что кратчайший путь между точками A и B на этом рисунке проходит примерно через середину текстуры.</span><span class="sxs-lookup"><span data-stu-id="22f9d-108">Note that the shortest distance between A and B in this illustration runs roughly through the middle of the texture.</span></span> <span data-ttu-id="22f9d-109">Включение обтекания координат текстуры U или V изменяет то, каким образом Direct3D определяет кратчайший путь между координатами на текстуре в направлении U или V.</span><span class="sxs-lookup"><span data-stu-id="22f9d-109">Enabling u-texture or v-texture coordinate wrapping changes how Direct3D perceives the shortest route between texture coordinates in the u-direction and v-direction.</span></span> <span data-ttu-id="22f9d-110">По своему определению обтекание текстур заставляет средство прорисовки выбирать кратчайший путь между наборами координат текстуры, предполагая, что точки 0,0 и 1,0 совпадают.</span><span class="sxs-lookup"><span data-stu-id="22f9d-110">By definition, texture wrapping causes the rasterizer to take the shortest route between texture coordinate sets, assuming that 0.0 and 1.0 are coincident.</span></span> <span data-ttu-id="22f9d-111">Последнее представляет сложность: можно представить, что включение обтекания текстуры в одном направлении заставляет систему обрабатывать текстуру так, будто она обернута вокруг цилиндра.</span><span class="sxs-lookup"><span data-stu-id="22f9d-111">The last bit is the tricky part: You can imagine that enabling texture wrapping in one direction causes the system to treat a texture as though it were wrapped around a cylinder.</span></span> <span data-ttu-id="22f9d-112">Например, рассмотрим следующую диаграмму.</span><span class="sxs-lookup"><span data-stu-id="22f9d-112">For example, consider the following diagram.</span></span>

![диаграмма текстуры с двумя точками, обернутой вокруг цилиндра](images/interp2.png)

<span data-ttu-id="22f9d-114">На предыдущем рисунке показано как обтекание в направлении U влияет на то, как система интерполирует координаты текстуры.</span><span class="sxs-lookup"><span data-stu-id="22f9d-114">The preceding illustration shows how wrapping in the u - direction affects how the system interpolates texture coordinates.</span></span> <span data-ttu-id="22f9d-115">Используя те же точки, что и в примере для обычных текстур без обтекания, можно заметить, что короткий путь между точками A и B уже не проходит посередине текстуры; теперь он лежит через границу, где вместе располагаются координаты 0,0 и 1,0.</span><span class="sxs-lookup"><span data-stu-id="22f9d-115">Using the same points as in the example for normal, or nonwrapped, textures, you can see that the shortest route between points A and B is no longer across the middle of the texture; it's now across the border where 0.0 and 1.0 exist together.</span></span> <span data-ttu-id="22f9d-116">Обтекание в направлении V работает аналогичным образом, за исключением того, что происходит оборачивание текстурой цилиндра, лежащего на боку.</span><span class="sxs-lookup"><span data-stu-id="22f9d-116">Wrapping in the v-direction is similar, except that it wraps the texture around a cylinder that is lying on its side.</span></span> <span data-ttu-id="22f9d-117">Обтекание одновременно в направлениях U и V является более сложным.</span><span class="sxs-lookup"><span data-stu-id="22f9d-117">Wrapping in both the u-direction and v-direction is more complex.</span></span> <span data-ttu-id="22f9d-118">В этом случае текстура представляется в виде тора или кольца.</span><span class="sxs-lookup"><span data-stu-id="22f9d-118">In this situation, you can envision the texture as a torus, or doughnut.</span></span>

<span data-ttu-id="22f9d-119">Наиболее распространенное практическое применение обтекания текстур — сопоставление окружения.</span><span class="sxs-lookup"><span data-stu-id="22f9d-119">The most common practical application for texture wrapping is to perform environment mapping.</span></span> <span data-ttu-id="22f9d-120">Обычно текстурированный с помощью карты окружения объект выглядит сильно отражающим и демонстрирует в зеркальном отображении окружение объекта в сцене.</span><span class="sxs-lookup"><span data-stu-id="22f9d-120">Usually, an object textured with an environment map appears very reflective, showing a mirrored image of the object's surroundings in the scene.</span></span> <span data-ttu-id="22f9d-121">Для примера представьте комнату с четырьмя стенами, на каждой из который изображена одна из букв — R, G, B, Y и соответствующие буквам цвета: красный, зеленый, синий и желтый.</span><span class="sxs-lookup"><span data-stu-id="22f9d-121">For the sake of this discussion, picture a room with four walls, each one painted with a letter R, G, B, Y and the corresponding colors: red, green, blue, and yellow.</span></span> <span data-ttu-id="22f9d-122">Карта сопоставления окружения для такой простой комнаты может выглядеть как на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="22f9d-122">The environment map for such a simple room might look like the following illustration.</span></span>

![изображение вертикальных полос красного, зеленого, синего и желтого цветов](images/envmap.png)

<span data-ttu-id="22f9d-124">Представьте, что потолок комнаты поддерживается четырехгранной колонной с полностью отражающей поверхностью.</span><span class="sxs-lookup"><span data-stu-id="22f9d-124">Imagine that the room's ceiling is held up by a perfectly reflective, four-sided, pillar.</span></span> <span data-ttu-id="22f9d-125">Сопоставить текстуру карты окружения колонне просто, а сделать так, чтобы колонна выглядела так, будто она отражает буквы и цвета — сложнее.</span><span class="sxs-lookup"><span data-stu-id="22f9d-125">Mapping the environment map texture to the pillar is simple; making the pillar look as though it is reflecting the letters and colors is not as easy.</span></span> <span data-ttu-id="22f9d-126">На следующей схеме показана каркасная модель колонны с применимыми координатами текстуры, указанными рядом с вершинами в верхней части колонны.</span><span class="sxs-lookup"><span data-stu-id="22f9d-126">The following diagram shows a wire frame of the pillar with the applicable texture coordinates listed near the top vertices.</span></span> <span data-ttu-id="22f9d-127">Шов в месте, где обтекание пересекает края текстуры, показан пунктирной линией.</span><span class="sxs-lookup"><span data-stu-id="22f9d-127">The seam where wrapping will cross the edges of the texture is shown with a dotted line.</span></span>

![изображение прямоугольника, разделенного пунктирной линией](images/seam.png)

<span data-ttu-id="22f9d-129">При включенном обтекании в направлении U на текстурированной колонне правильно отображаются цвета и символы карты сопоставления окружения, а в месте шва в передней части текстуры средство программной прорисовки надлежащим образом выбирает кратчайший маршрут между координатами текстуры с учетом того, что координаты U 0,0 и 1,0 расположены в одном и том же месте.</span><span class="sxs-lookup"><span data-stu-id="22f9d-129">With wrapping enabled in the u-direction, the textured pillar shows the colors and symbols from the environment map appropriately and, at the seam in the front of the texture, the rasterizer properly chooses the shortest route between the texture coordinates, assuming that u-coordinates 0.0 and 1.0 share the same location.</span></span> <span data-ttu-id="22f9d-130">Текстурированная колонна выглядит как на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="22f9d-130">The textured pillar looks like the following illustration.</span></span>

![изображение колонны, состоящий из красного, зеленого, синего и желтого квадрантов](images/tex-seam.png)

<span data-ttu-id="22f9d-132">Если обтекание текстуры не включено, средство программной прорисовки не производит интерполяцию в направлении, необходимом для создания правдоподобного отраженного изображения.</span><span class="sxs-lookup"><span data-stu-id="22f9d-132">If texture wrapping isn't enabled, the rasterizer does not interpolate in the direction needed to generate a believable, reflected image.</span></span> <span data-ttu-id="22f9d-133">Вместо этого область в передней части колонны содержит сжатую по горизонтали версия текселей между координатами U 0,175 и 0,875, так как они проходят через центр текстуры.</span><span class="sxs-lookup"><span data-stu-id="22f9d-133">Rather, the area at the front of the pillar contains a horizontally compressed version of the texels between u-coordinates 0.175 and 0.875, as they pass through the center of the texture.</span></span> <span data-ttu-id="22f9d-134">Эффект обтекания не проявляется.</span><span class="sxs-lookup"><span data-stu-id="22f9d-134">The wrap effect is ruined.</span></span>

## <a name="using-texture-wrapping"></a><span data-ttu-id="22f9d-135">Использование переноса текстур</span><span class="sxs-lookup"><span data-stu-id="22f9d-135">Using Texture Wrapping</span></span>

<span data-ttu-id="22f9d-136">Чтобы включить перенос текстур, вызовите метод [**IDirect3DDevice9:: сетрендерстате**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setrenderstate) , как показано в примере кода ниже.</span><span class="sxs-lookup"><span data-stu-id="22f9d-136">To enable texture wrapping, call the [**IDirect3DDevice9::SetRenderState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setrenderstate) method as shown in the code example below.</span></span>


```
d3dDevice->SetRenderState(D3DRS_WRAP0, D3DWRAPCOORD_0);
```



<span data-ttu-id="22f9d-137">Первый параметр, принимаемый [**IDirect3DDevice9:: сетрендерстате**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setrenderstate) , — это заданное состояние визуализации.</span><span class="sxs-lookup"><span data-stu-id="22f9d-137">The first parameter accepted by [**IDirect3DDevice9::SetRenderState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setrenderstate) is a render state to set.</span></span> <span data-ttu-id="22f9d-138">Укажите один из D3DRS \_ WRAP0 через D3DRS \_ WRAP7 перечислимые значения, которые указывают уровень текстуры, для которого необходимо задать перенос.</span><span class="sxs-lookup"><span data-stu-id="22f9d-138">Specify one of the D3DRS\_WRAP0 through D3DRS\_WRAP7 enumerated values which specify which texture level to set the wrapping for.</span></span> <span data-ttu-id="22f9d-139">Укажите \_ Флаги D3DWRAPCOORD 0 – D3DWRAPCOORD \_ 3 во втором параметре, чтобы включить перенос текстур в соответствующем направлении, или объедините их, чтобы включить перенос в нескольких направлениях.</span><span class="sxs-lookup"><span data-stu-id="22f9d-139">Specify the D3DWRAPCOORD\_0 through D3DWRAPCOORD\_3 flags in the second parameter to enable texture wrapping in the corresponding direction, or combine them to enable wrapping in multiple directions.</span></span> <span data-ttu-id="22f9d-140">Если опустить флаг, то перенос текстур в соответствующем направлении отключается.</span><span class="sxs-lookup"><span data-stu-id="22f9d-140">If you omit a flag, texture wrapping in the corresponding direction is disabled.</span></span> <span data-ttu-id="22f9d-141">Чтобы отключить перенос текстур для набора координат текстуры, задайте для соответствующего состояния отрисовки значение 0.</span><span class="sxs-lookup"><span data-stu-id="22f9d-141">To disable texture wrapping for a set of texture coordinates, set the value for the corresponding render state to 0.</span></span>

<span data-ttu-id="22f9d-142">Не следует путать обтекание текстур с режимами адресации текстур с аналогичным названием.</span><span class="sxs-lookup"><span data-stu-id="22f9d-142">Do not confuse texture wrapping with the similarly named texture addressing modes.</span></span> <span data-ttu-id="22f9d-143">Обтекание текстур выполняется до адресации текстуры.</span><span class="sxs-lookup"><span data-stu-id="22f9d-143">Texture wrapping is performed before texture addressing.</span></span> <span data-ttu-id="22f9d-144">Убедитесь, что данные, обтекаемые текстурой, не содержат координаты текстуры за пределами диапазона \[ 0,0, 1,0, \] так как это приведет к неопределенным результатам.</span><span class="sxs-lookup"><span data-stu-id="22f9d-144">Be sure the texture wrapping data does not contain any texture coordinates outside of the range of \[0.0, 1.0\] because this will produce undefined results.</span></span> <span data-ttu-id="22f9d-145">Дополнительные сведения об адресации текстур см. в разделе [режимы адресации текстур (Direct3D 9)](texture-addressing-modes.md).</span><span class="sxs-lookup"><span data-stu-id="22f9d-145">For more information about texture addressing, see [Texture Addressing Modes (Direct3D 9)](texture-addressing-modes.md).</span></span>

## <a name="displacement-map-wrapping"></a><span data-ttu-id="22f9d-146">Перенос карт смещения</span><span class="sxs-lookup"><span data-stu-id="22f9d-146">Displacement Map Wrapping</span></span>

<span data-ttu-id="22f9d-147">Карты смещения интерполируются движком тесселяции.</span><span class="sxs-lookup"><span data-stu-id="22f9d-147">Displacement maps are interpolated by the tesselation engine.</span></span> <span data-ttu-id="22f9d-148">Поскольку режим обтекания для движка тесселяции указать невозможно, обтекание текстуры невозможно выполнить с помощью карт смещения.</span><span class="sxs-lookup"><span data-stu-id="22f9d-148">Because the wrap mode cannot be specified for the tessellation engine, texture wrapping cannot be performed with displacement maps.</span></span> <span data-ttu-id="22f9d-149">Приложение может использовать набор вершин, который обеспечивает интерполяцию для обтекания в любом направлении.</span><span class="sxs-lookup"><span data-stu-id="22f9d-149">An application is able to use a set of vertices that forces the interpolation to wrap in any direction.</span></span> <span data-ttu-id="22f9d-150">В приложении также можно указать, чтобы интерполяция производилась простым линейным способом.</span><span class="sxs-lookup"><span data-stu-id="22f9d-150">The application can also specify the interpolation to be done as a simple linear interpolation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="22f9d-151">См. также</span><span class="sxs-lookup"><span data-stu-id="22f9d-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="22f9d-152">Текстуры Direct3D</span><span class="sxs-lookup"><span data-stu-id="22f9d-152">Direct3D Textures</span></span>](direct3d-textures.md)
</dt> </dl>

 

 
