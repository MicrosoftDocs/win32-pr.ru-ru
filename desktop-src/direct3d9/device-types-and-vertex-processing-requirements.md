---
description: Производительность операций обработки вершин, включая преобразование и освещение, зависит интенсивно от того, где находится буфер вершин в памяти и какой тип устройства отрисовки используется.
ms.assetid: 4f9ca83d-c9d6-4749-944d-78f831b0f44e
title: Типы устройств и требования к обработке вершин (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 590cf2f5423d9c3bdf3e19c91f30b3e8c0586687
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104537235"
---
# <a name="device-types-and-vertex-processing-requirements-direct3d-9"></a><span data-ttu-id="355a7-103">Типы устройств и требования к обработке вершин (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="355a7-103">Device Types and Vertex Processing Requirements (Direct3D 9)</span></span>

<span data-ttu-id="355a7-104">Производительность операций обработки вершин, включая преобразование и освещение, зависит интенсивно от того, где находится буфер вершин в памяти и какой тип устройства отрисовки используется.</span><span class="sxs-lookup"><span data-stu-id="355a7-104">The performance of vertex processing operations, including transformation and lighting, depends heavily on where the vertex buffer exists in memory and what type of rendering device is being used.</span></span> <span data-ttu-id="355a7-105">Приложения управляют выделением памяти для буферов вершин при их создании.</span><span class="sxs-lookup"><span data-stu-id="355a7-105">Applications control the memory allocation for vertex buffers when they are created.</span></span> <span data-ttu-id="355a7-106">Если \_ установлен флаг D3DPOOL системмем Memory, буфер вершин создается в системной памяти.</span><span class="sxs-lookup"><span data-stu-id="355a7-106">When the D3DPOOL\_SYSTEMMEM memory flag is set, the vertex buffer is created in system memory.</span></span> <span data-ttu-id="355a7-107">При \_ использовании флага памяти D3DPOOL по умолчанию драйвер устройства определяет, где лучше всего выделяется память для буфера вершин, часто называемую оптимальным для драйвера памятью.</span><span class="sxs-lookup"><span data-stu-id="355a7-107">When the D3DPOOL\_DEFAULT memory flag is used, the device driver determines where the memory for the vertex buffer is best allocated, often referred to as driver-optimal memory.</span></span> <span data-ttu-id="355a7-108">Оптимальным для драйвера памятью может быть локальная видеопамять, Нелокальная видеопамять или системная память.</span><span class="sxs-lookup"><span data-stu-id="355a7-108">Driver-optimal memory can be local video memory, nonlocal video memory, or system memory.</span></span>

<span data-ttu-id="355a7-109">Установка \_ константы СОФТВАРЕПРОЦЕССИНГ D3DUSAGE с [**IDirect3DDevice9:: креатевертексбуффер**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createvertexbuffer) позволяет выполнять обработку вершин программного обеспечения на данных буфера вершин.</span><span class="sxs-lookup"><span data-stu-id="355a7-109">Setting the D3DUSAGE\_SOFTWAREPROCESSING constant with [**IDirect3DDevice9::CreateVertexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createvertexbuffer) enables software vertex processing on the vertex buffer data.</span></span> <span data-ttu-id="355a7-110">Этот флаг необходим для обработки вершин программного обеспечения в смешанном режиме.</span><span class="sxs-lookup"><span data-stu-id="355a7-110">This flag is required for software vertex processing while in mixed mode.</span></span> <span data-ttu-id="355a7-111">Этот флаг не может использоваться для аппаратного режима обработки вершин.</span><span class="sxs-lookup"><span data-stu-id="355a7-111">The flag may not be used for hardware vertex processing mode.</span></span> <span data-ttu-id="355a7-112">Буферы вершин, используемые при обработке вершин программного обеспечения, включают следующее:</span><span class="sxs-lookup"><span data-stu-id="355a7-112">Vertex buffers used with software vertex processing include the following:</span></span>

-   <span data-ttu-id="355a7-113">Все входные потоки для [**IDirect3DDevice9::P роцессвертицес**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices).</span><span class="sxs-lookup"><span data-stu-id="355a7-113">All input streams for [**IDirect3DDevice9::ProcessVertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices).</span></span>
-   <span data-ttu-id="355a7-114">Все входные потоки для [**IDirect3DDevice9::D равпримитиве**](/windows/desktop/api) и [**IDirect3DDevice9::D равиндекседпримитиве**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive).</span><span class="sxs-lookup"><span data-stu-id="355a7-114">All input streams for [**IDirect3DDevice9::DrawPrimitive**](/windows/desktop/api) and [**IDirect3DDevice9::DrawIndexedPrimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive).</span></span>

<span data-ttu-id="355a7-115">Причина, с помощью которой определяется расположение памяти (оптимальная система или драйвер) для буферов вершин, аналогична для текстур.</span><span class="sxs-lookup"><span data-stu-id="355a7-115">The reasoning you use to determine the memory location - system or driver optimal - for vertex buffers is the same as that for textures.</span></span> <span data-ttu-id="355a7-116">Обработка вершин, включая преобразование и освещение, в оборудовании лучше всего подходит, когда буферы вершин выделяются в оптимальной для драйвера памяти, а обработка вершин программного обеспечения лучше всего подходит для буферов вершин, выделенных в системной памяти.</span><span class="sxs-lookup"><span data-stu-id="355a7-116">Vertex processing, including transformation and lighting, in hardware works best when the vertex buffers are allocated in driver-optimal memory, while software vertex processing works best with vertex buffers allocated in system memory.</span></span> <span data-ttu-id="355a7-117">Для текстур аппаратное растрирование лучше всего подходит, когда текстуры выделяются в оптимальной для драйвера памяти, в то время как растрирование программного обеспечения лучше всего работает с текстурами в памяти системы.</span><span class="sxs-lookup"><span data-stu-id="355a7-117">For textures, hardware rasterization works best when textures are allocated in driver-optimal memory, while software rasterization works best with system-memory textures.</span></span>

<span data-ttu-id="355a7-118">Microsoft Direct3D 9 поддерживает автономную обработку вершин, не выполняя отрисовку какого-либо примитива методом [**IDirect3DDevice9::P роцессвертицес**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices) .</span><span class="sxs-lookup"><span data-stu-id="355a7-118">Microsoft Direct3D 9 supports standalone processing of vertices, without rendering any primitive with the [**IDirect3DDevice9::ProcessVertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices) method.</span></span> <span data-ttu-id="355a7-119">Эта автономная обработка вершин всегда выполняется в программном обеспечении процессора узла.</span><span class="sxs-lookup"><span data-stu-id="355a7-119">This standalone vertex processing is always performed in software on the host processor.</span></span> <span data-ttu-id="355a7-120">По этой причине буферы вершин, используемые в качестве источников, заданных с помощью [**IDirect3DDevice9:: сетстреамсаурце**](/windows/desktop/api) , должны быть созданы с \_ флагом D3DUSAGE софтварепроцессинг.</span><span class="sxs-lookup"><span data-stu-id="355a7-120">Because of this, vertex buffers used as sources set with [**IDirect3DDevice9::SetStreamSource**](/windows/desktop/api) must be created with the D3DUSAGE\_SOFTWAREPROCESSING flag.</span></span> <span data-ttu-id="355a7-121">Функции, предоставляемые **IDirect3DDevice9::P роцессвертицес** , идентичны методам [**IDirect3DDevice9::D равпримитиве**](/windows/desktop/api) и [**IDirect3DDevice9::D равиндекседпримитиве**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive) при использовании обработки вершин программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="355a7-121">The functionality provided by **IDirect3DDevice9::ProcessVertices** is identical to that of the [**IDirect3DDevice9::DrawPrimitive**](/windows/desktop/api) and [**IDirect3DDevice9::DrawIndexedPrimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive) methods while using software vertex processing.</span></span>

<span data-ttu-id="355a7-122">Если приложение выполняет собственную обработку вершин и передает преобразованные, освещенные и обрезанные вершины методам подготовки к просмотру, то приложение может напрямую записывать вершины в буфер вершин, выделенный в памяти, оптимальном для драйвера.</span><span class="sxs-lookup"><span data-stu-id="355a7-122">If your application performs its own vertex processing and passes transformed, lit, and clipped vertices to rendering methods, then the application can directly write vertices to a vertex buffer allocated in driver-optimal memory.</span></span> <span data-ttu-id="355a7-123">Этот метод предотвращает избыточную операцию копирования на более позднем этапе.</span><span class="sxs-lookup"><span data-stu-id="355a7-123">This technique prevents a redundant copy operation later.</span></span> <span data-ttu-id="355a7-124">Обратите внимание, что этот метод не будет работать, если приложение считывает данные из буфера вершин, так как операции чтения, выполняемые узлом из-за оптимизации памяти с помощью драйвера, могут быть очень медленными.</span><span class="sxs-lookup"><span data-stu-id="355a7-124">Note that this technique will not work well if your application reads data back from a vertex buffer, because read operations done by the host from driver-optimal memory can be very slow.</span></span> <span data-ttu-id="355a7-125">Таким образом, если приложению необходимо прочитать данные во время обработки или записи в буфер неустойчиво, лучше выбрать буфер вершин памяти системы.</span><span class="sxs-lookup"><span data-stu-id="355a7-125">Therefore, if your application needs to read during processing or writes data to the buffer erratically, a system-memory vertex buffer is a better choice.</span></span>

<span data-ttu-id="355a7-126">При использовании функций обработки вершин на уровне Direct3D (путем передачи непреобразованных вершин в методы отрисовки буфера вершин) обработка может выполняться в аппаратном или программном обеспечении в зависимости от типа устройства и флагов создания устройств.</span><span class="sxs-lookup"><span data-stu-id="355a7-126">When using the Direct3D vertex processing features (by passing untransformed vertices to vertex-buffer rendering methods), processing can occur in either hardware or software depending on the device type and device creation flags.</span></span> <span data-ttu-id="355a7-127">Рекомендуется выделить буферы вершин в пуле D3DPOOL \_ по умолчанию для лучшей производительности практически во всех случаях.</span><span class="sxs-lookup"><span data-stu-id="355a7-127">It is recommended that vertex buffers be allocated in pool D3DPOOL\_DEFAULT for best performance in virtually all cases.</span></span> <span data-ttu-id="355a7-128">Если устройство использует аппаратную обработку вершин, существует ряд дополнительных оптимизаций, которые можно выполнить на основе флагов D3DUSAGE \_ dynamic и D3DUSAGE \_ WRITEONLY.</span><span class="sxs-lookup"><span data-stu-id="355a7-128">When a device is using hardware vertex processing, there are a number of additional optimizations that may be done based on the flags D3DUSAGE\_DYNAMIC and D3DUSAGE\_WRITEONLY.</span></span> <span data-ttu-id="355a7-129">Дополнительные сведения об использовании этих флагов см. в разделе IDirect3DDevice9:: Креатевертексбуффер.</span><span class="sxs-lookup"><span data-stu-id="355a7-129">See IDirect3DDevice9::CreateVertexBuffer for more information about using these flags.</span></span>

## <a name="related-topics"></a><span data-ttu-id="355a7-130">См. также</span><span class="sxs-lookup"><span data-stu-id="355a7-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="355a7-131">Буферы вершин</span><span class="sxs-lookup"><span data-stu-id="355a7-131">Vertex Buffers</span></span>](vertex-buffers.md)
</dt> </dl>

 

 
