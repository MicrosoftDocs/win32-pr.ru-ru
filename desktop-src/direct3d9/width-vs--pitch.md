---
description: Хотя термины Width и тон часто используются неформально, они имеют очень важную и разные значения. В результате вы должны понимать смысл каждого из них и как интерпретировать значения, используемые Direct3D для их описания.
ms.assetid: 2f99881b-f95d-470f-b14d-8300ad930e2a
title: Ширина и шаг (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 50d0c8fc49b3bce984e56f7b1a727ed40fee67b2
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104553861"
---
# <a name="width-vs-pitch-direct3d-9"></a><span data-ttu-id="226f6-104">Ширина и шаг (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="226f6-104">Width vs. Pitch (Direct3D 9)</span></span>

<span data-ttu-id="226f6-105">Хотя термины Width и тон часто используются неформально, они имеют очень важную и разные значения.</span><span class="sxs-lookup"><span data-stu-id="226f6-105">Although the terms width and pitch are often used informally, they have very important, and distinctly different, meanings.</span></span> <span data-ttu-id="226f6-106">В результате вы должны понимать смысл каждого из них и как интерпретировать значения, используемые Direct3D для их описания.</span><span class="sxs-lookup"><span data-stu-id="226f6-106">As a result, you should understand the meanings for each, and how to interpret the values that Direct3D uses to describe them.</span></span>

<span data-ttu-id="226f6-107">Direct3D использует структуру [**D3DSURFACE \_ DESC**](d3dsurface-desc.md) для передачи информации, описывающей поверхность.</span><span class="sxs-lookup"><span data-stu-id="226f6-107">Direct3D uses the [**D3DSURFACE\_DESC**](d3dsurface-desc.md) structure to carry information describing a surface.</span></span> <span data-ttu-id="226f6-108">Помимо прочего, эта структура определена как содержащая сведения об измерениях поверхности, а также о том, как эти измерения представлены в памяти.</span><span class="sxs-lookup"><span data-stu-id="226f6-108">Among other things, this structure is defined to contain information about a surface's dimensions, as well as how those dimensions are represented in memory.</span></span> <span data-ttu-id="226f6-109">Структура использует элементы Height и Width для описания логических измерений поверхности.</span><span class="sxs-lookup"><span data-stu-id="226f6-109">The structure uses the Height and Width members to describe the logical dimensions of the surface.</span></span> <span data-ttu-id="226f6-110">Оба элемента измеряются в пикселях.</span><span class="sxs-lookup"><span data-stu-id="226f6-110">Both members are measured in pixels.</span></span> <span data-ttu-id="226f6-111">Таким образом, значения высоты и ширины для поверхности 640 x 480 одинаковы, независимо от того, является ли это 8-разрядной или 24-разрядной поверхностью RGB.</span><span class="sxs-lookup"><span data-stu-id="226f6-111">Therefore, the Height and Width values for a 640 x 480 surface are the same whether it is an 8-bit surface or a 24-bit RGB surface.</span></span>

<span data-ttu-id="226f6-112">При блокировке поверхности с помощью метода [**IDirect3DSurface9:: локкрект**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-lockrect) метод заполняет структуру [**D3DLOCKED \_ Rect**](d3dlocked-rect.md) , содержащую шаг поверхности, и указатель на заблокированные биты.</span><span class="sxs-lookup"><span data-stu-id="226f6-112">When you lock a surface using the [**IDirect3DSurface9::LockRect**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-lockrect) method, the method fills in a [**D3DLOCKED\_RECT**](d3dlocked-rect.md) structure that contains the pitch of the surface and a pointer to the locked bits.</span></span> <span data-ttu-id="226f6-113">Значение в элементе «шаг» описывает тон памяти поверхности, также называемый STRIDE.</span><span class="sxs-lookup"><span data-stu-id="226f6-113">The value in the Pitch member describes the surface's memory pitch, also called stride.</span></span> <span data-ttu-id="226f6-114">Шаг — это расстояние в байтах между двумя адресами памяти, представляющими начало одной строки точечного рисунка, и начало следующей строки.</span><span class="sxs-lookup"><span data-stu-id="226f6-114">Pitch is the distance, in bytes, between two memory addresses that represent the beginning of one bitmap line and the beginning of the next bitmap line.</span></span> <span data-ttu-id="226f6-115">Так как шаг измеряется в байтах, а не в пикселях, 640x480x8 поверхность имеет очень разное значение высоты, чем поверхность с теми же размерами, но с другим форматом пикселей.</span><span class="sxs-lookup"><span data-stu-id="226f6-115">Because pitch is measured in bytes rather than pixels, a 640x480x8 surface has a very different pitch value than a surface with the same dimensions but a different pixel format.</span></span> <span data-ttu-id="226f6-116">Кроме того, значение высоты иногда отражает байты, зарезервированные Direct3D в качестве кэша, поэтому неважно предположить, что высота — это просто ширина, умноженная на число байтов на пиксель.</span><span class="sxs-lookup"><span data-stu-id="226f6-116">Additionally, the pitch value sometimes reflects bytes that Direct3D has reserved as a cache, so it is not safe to assume that pitch is just the width multiplied by the number of bytes per pixel.</span></span> <span data-ttu-id="226f6-117">Вместо этого Визуализируйте разницу между шириной и шагом, как показано на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="226f6-117">Rather, visualize the difference between width and pitch as shown in the following diagram.</span></span>

![Схема высоты и ширины для одного и того же переднего буфера, заднего буфера и кэша](images/pitch.png)

<span data-ttu-id="226f6-119">На этой схеме передний буфер и задний буфер являются 640x480x8, а кэш — 384x480x8.</span><span class="sxs-lookup"><span data-stu-id="226f6-119">In this diagram, the front buffer and back buffer are both 640x480x8, and the cache is 384x480x8.</span></span>

<span data-ttu-id="226f6-120">При непосредственном доступе к поверхностям Следите за тем, чтобы память, выделенная для измерений поверхности, оставалась в памяти, зарезервированной для кэша.</span><span class="sxs-lookup"><span data-stu-id="226f6-120">When accessing surfaces directly, take care to stay within the memory allocated for the dimensions of the surface and stay out of any memory reserved for cache.</span></span> <span data-ttu-id="226f6-121">Кроме того, при блокировке только части поверхности необходимо остаться внутри прямоугольника, указанного при блокировке поверхности.</span><span class="sxs-lookup"><span data-stu-id="226f6-121">Additionally, when you lock only a portion of a surface, you must stay within the rectangle you specify when locking the surface.</span></span> <span data-ttu-id="226f6-122">Несоблюдение этих рекомендаций приведет к непредсказуемым результатам.</span><span class="sxs-lookup"><span data-stu-id="226f6-122">Failing to follow these guidelines will have unpredictable results.</span></span> <span data-ttu-id="226f6-123">При отрисовке непосредственно в памяти поверхности всегда используйте шаг, возвращаемый методом [**IDirect3DSurface9:: локкрект**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-lockrect) .</span><span class="sxs-lookup"><span data-stu-id="226f6-123">When rendering directly into surface memory, always use the pitch returned by the [**IDirect3DSurface9::LockRect**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-lockrect) method.</span></span> <span data-ttu-id="226f6-124">Не следует вылагать шаг на основе только режима экрана.</span><span class="sxs-lookup"><span data-stu-id="226f6-124">Do not assume a pitch based solely on the display mode.</span></span> <span data-ttu-id="226f6-125">Если приложение работает на некоторых видеоадаптерах, но выглядит неискаженным, это может быть причиной проблемы.</span><span class="sxs-lookup"><span data-stu-id="226f6-125">If your application works on some display adapters but looks garbled on others, this may be the cause of the problem.</span></span>

<span data-ttu-id="226f6-126">Дополнительные сведения см. в разделе [доступ к памяти Surface напрямую (Direct3D 9)](accessing-surface-memory-directly.md).</span><span class="sxs-lookup"><span data-stu-id="226f6-126">For more information, see [Accessing Surface Memory Directly (Direct3D 9)](accessing-surface-memory-directly.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="226f6-127">См. также</span><span class="sxs-lookup"><span data-stu-id="226f6-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="226f6-128">Поверхности Direct3D</span><span class="sxs-lookup"><span data-stu-id="226f6-128">Direct3D Surfaces</span></span>](direct3d-surfaces.md)
</dt> </dl>

 

 
