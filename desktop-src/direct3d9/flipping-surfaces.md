---
description: Приложение Direct3D обычно отображает анимированную последовательность, создавая кадры анимации в задних буферах и представляя их последовательно.
ms.assetid: 4ca9a845-f433-4d4a-939e-4b9ab2983927
title: Зеркальное отображение поверхностей (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30c14aa7df63c3956d4974282033b44a7129853940d475b23115f9bca344ca4f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118988043"
---
# <a name="flipping-surfaces-direct3d-9"></a>Зеркальное отображение поверхностей (Direct3D 9)

Приложение Direct3D обычно отображает анимированную последовательность, создавая кадры анимации в задних буферах и представляя их последовательно. Задние буферы организованы в цепочки подкачки. Цепочка подкачки — это последовательность буферов, которые переворачиваются на экран один за другим. Это можно использовать для отображения одной сцены в памяти и последующей перелистывания сцены на экран после завершения подготовки к просмотру. Это позволяет избежать проблем, известных как разрывы, и обеспечивает более гладкую анимацию.

Каждое устройство, созданное в Direct3D, имеет по крайней мере одну цепь подкачки. При инициализации первого устройства Direct3D задается член Баккбуфферкаунт [**\_ параметров D3DPRESENT**](d3dpresent-parameters.md), который сообщает Direct3D о количестве задних буферов, которые будут находиться в цепочке подкачки. Затем вызов [**IDirect3D9:: креатедевице**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-createdevice) создает устройство Direct3D и соответствующую цепочку подкачки.

При использовании [**IDirect3DDevice9::P**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-present) отправку для запроса операции отражения поверхности, указатели на память поверхности для переднего буфера и задние буферы меняются местами. Зеркальное отображение выполняется путем переключения указателей, которые устройство отображения использует для ссылки на память, а не копирует память поверхности. Если цепочка зеркального отображения содержит передний буфер и несколько задних буферов, указатели переключаются в циклической схеме, как показано на следующей диаграмме.

![Схема зеркальной цепочки с передним буфером и двумя задними буферами](images/trplflip.png)

Вы можете создать цепочки переменного сложения для устройства, вызвав [**IDirect3DDevice9:: креатеаддитионалсвапчаин**](/windows/desktop/api). Приложение может создать одну цепочку подкачки для каждого представления и связать каждую цепочку подкачки с определенным окном. Приложение визуализирует изображения в задних буферах каждой цепочки буферов, а затем представляет их по отдельности. Два параметра, **IDirect3DDevice9:: креатеаддитионалсвапчаин** , принимают в качестве указателя на структуру [**\_ параметров D3DPRESENT**](d3dpresent-parameters.md) и адрес указателя на интерфейс [**IDirect3DSwapChain9**](/windows/desktop/api) . Затем можно использовать [**IDirect3DSwapChain9::P**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dswapchain9-present) повторно отправить, чтобы отобразить содержимое следующего заднего буфера в интерфейсном буфере. Обратите внимание, что устройство может иметь только одну цепочку полноэкранного подкачки.

Доступ к конкретному буферу можно получить, вызвав методы [**IDirect3DDevice9:: жетбаккбуффер**](/windows/desktop/api) или [**IDirect3DSwapChain9:: жетбаккбуффер**](/windows/desktop/api) , которые возвращают указатель на интерфейс [**IDirect3DSurface9**](/windows/desktop/api) , представляющий возвращаемую поверхность заднего буфера. Обратите внимание, что вызов этого метода увеличивает внутренний счетчик ссылок в интерфейсе [**IDirect3DDevice9**](/windows/desktop/api) , поэтому необходимо вызвать [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) , когда вы завершите работу с этой областью, или у вас будет утечка памяти.

Помните, что Direct3D переворачивает поверхности путем переключения указателей памяти поверхности в цепочке буферов, а не самих поверхностей. Это означает, что вы всегда будете отрисовываться в обратном буфере, который будет отображаться далее.

Важно отметить различие между «операциями зеркального отображения», выполняемой драйвером видеоадаптера, и операцией «Present», применяемой к цепочке буфера обмена, созданной с помощью D3DSWAPEFFECT \_ reпереворот.

Термин "перелистывание" означает операцию, которая изменяет диапазон адресов видеопамяти, используемый видеоадаптером для формирования выходного сигнала, что приводит к отображению содержимого ранее скрытого заднего буфера. В Direct3D 9 термин часто используется для описания представления заднего буфера в любой цепочке буферов, созданной с помощью D3DSWAPEFFECT \_ отражения.

Хотя такие операции "Present" почти неизменно реализуются с помощью операций отражения, когда цепочка подкачки является полноэкранной, они обязательно реализуются с помощью операций копирования, когда цепочка буферов перемещается в окно. Кроме того, драйвер видеоадаптера может использовать зеркальное отображение для реализации существующих операций с цепочками полноэкранного переключения на основе D3DSWAPEFFECT \_ Discard и D3DSWAPEFFECT \_ Copy.

Приведенное выше обсуждение применяется к часто используемым вариантам цепочки полноэкранного буфера, созданной с помощью D3DSWAPEFFECT \_ reпереворот.

Более общее описание различных эффектов переключения для оконных и полноэкранных цепочек переключения см. в разделе [**D3DSWAPEFFECT**](./d3dswapeffect.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Поверхности Direct3D](direct3d-surfaces.md)
</dt> </dl>

 

 
