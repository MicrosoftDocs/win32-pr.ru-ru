---
description: Приложения могут оптимизировать, какое подмножество текстуры копируется, указав &\# 0034; dirty&\# 0034; регионах на текстурах.
ms.assetid: 102081bc-d5d5-4ec1-b935-00d4eda8f470
title: Изменившиеся регионы текстур (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35e3f1ce350a2728c99c49455b5fb8b638c47d10
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "105701143"
---
# <a name="texture-dirty-regions-direct3d-9"></a><span data-ttu-id="28e70-103">Изменившиеся регионы текстур (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="28e70-103">Texture Dirty Regions (Direct3D 9)</span></span>

<span data-ttu-id="28e70-104">Приложения могут оптимизировать, какое подмножество текстуры копируется путем указания "грязных" областей на текстурах.</span><span class="sxs-lookup"><span data-stu-id="28e70-104">Applications can optimize which subset of a texture is copied by specifying "dirty" regions on textures.</span></span> <span data-ttu-id="28e70-105">Только те регионы, которые помечены как "грязные", копируются путем вызова [**IDirect3DDevice9:: упдатетекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatetexture).</span><span class="sxs-lookup"><span data-stu-id="28e70-105">Only those regions marked as dirty are copied by a call to [**IDirect3DDevice9::UpdateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatetexture).</span></span> <span data-ttu-id="28e70-106">Однако «грязные» регионы могут быть развернуты для оптимизации выравнивания.</span><span class="sxs-lookup"><span data-stu-id="28e70-106">However, the dirty regions may be expanded to optimize alignment.</span></span> <span data-ttu-id="28e70-107">При создании текстуры вся текстура считается «грязной».</span><span class="sxs-lookup"><span data-stu-id="28e70-107">When a texture is created, the entire texture is considered dirty.</span></span> <span data-ttu-id="28e70-108">Только следующие операции влияют на «грязное» состояние текстуры.</span><span class="sxs-lookup"><span data-stu-id="28e70-108">Only the following operations affect the dirty state of a texture:</span></span>

-   <span data-ttu-id="28e70-109">Добавление «грязной» области к текстуре.</span><span class="sxs-lookup"><span data-stu-id="28e70-109">Adding a dirty region to a texture.</span></span>
-   <span data-ttu-id="28e70-110">Блокировка некоторого буфера в текстуре.</span><span class="sxs-lookup"><span data-stu-id="28e70-110">Locking some buffer in the texture.</span></span> <span data-ttu-id="28e70-111">Эта операция добавляет заблокированный регион в качестве "грязной" области.</span><span class="sxs-lookup"><span data-stu-id="28e70-111">This operation adds the locked region as a dirty region.</span></span> <span data-ttu-id="28e70-112">Приложение может отключить автоматическое обновление "грязной" области, если оно лучше знает фактические "грязные" регионы.</span><span class="sxs-lookup"><span data-stu-id="28e70-112">The application can turn off this automatic dirty region update if it has better knowledge of the actual dirty regions.</span></span>
-   <span data-ttu-id="28e70-113">Использование уровня поверхности текстуры в качестве назначения в [**IDirect3DDevice9:: упдатесурфаце**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatesurface) помечает всю текстуру как "грязную".</span><span class="sxs-lookup"><span data-stu-id="28e70-113">Using a surface level of the texture as a destination in [**IDirect3DDevice9::UpdateSurface**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatesurface) marks the entire texture as dirty.</span></span>
-   <span data-ttu-id="28e70-114">Использование текстуры в качестве источника в [**IDirect3DDevice9:: упдатетекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatetexture) очищает все изменившиеся регионы на исходной текстуре.</span><span class="sxs-lookup"><span data-stu-id="28e70-114">Using the texture as a source in [**IDirect3DDevice9::UpdateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatetexture) clears all the dirty regions on the source texture.</span></span>
-   <span data-ttu-id="28e70-115">Использование [**IDirect3DSurface9:: GetDC**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-getdc) для возврата контекста устройства.</span><span class="sxs-lookup"><span data-stu-id="28e70-115">Using [**IDirect3DSurface9::GetDC**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-getdc) to return a device context.</span></span>
-   <span data-ttu-id="28e70-116">Вызов [**IDirect3DBaseTexture9:: женератемипсублевелс**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-generatemipsublevels) помечает всю текстуру как "грязную".</span><span class="sxs-lookup"><span data-stu-id="28e70-116">Calling [**IDirect3DBaseTexture9::GenerateMipSubLevels**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-generatemipsublevels) marks the entire texture as dirty.</span></span>
-   <span data-ttu-id="28e70-117">Вызов [**IDirect3DBaseTexture9:: сетаутоженфилтертипе**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-setautogenfiltertype) помечает всю текстуру как "грязную".</span><span class="sxs-lookup"><span data-stu-id="28e70-117">Calling [**IDirect3DBaseTexture9::SetAutoGenFilterType**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-setautogenfiltertype) marks the entire texture as dirty.</span></span>

<span data-ttu-id="28e70-118">"Грязные" регионы задаются на верхнем уровне текстуры мипмаппед, а [**IDirect3DDevice9:: упдатетекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatetexture) может развернуть "грязную" область вниз по цепочке MIP, чтобы свести к минимальному числу байтов, копируемых для каждого подуровня.</span><span class="sxs-lookup"><span data-stu-id="28e70-118">Dirty regions are set on the top level of a mipmapped texture, and [**IDirect3DDevice9::UpdateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-updatetexture) can expand the dirty region down the mip chain in order to minimize the number of bytes copied for each sublevel.</span></span> <span data-ttu-id="28e70-119">Обратите внимание, что координаты «грязной» области подуровня округляются наружу, то есть их дробные части округляются в сторону ближайшего края текстуры.</span><span class="sxs-lookup"><span data-stu-id="28e70-119">Note that the sublevel dirty region coordinates are rounded outward, that is, their fractional parts are rounded toward the nearest edge of the texture.</span></span>

<span data-ttu-id="28e70-120">Так как каждый тип текстуры имеет различные типы «грязных» регионов, для каждого типа текстуры существуют методы.</span><span class="sxs-lookup"><span data-stu-id="28e70-120">Because each type of texture has different types of dirty regions, there are methods on each texture type.</span></span> <span data-ttu-id="28e70-121">2D-текстуры используют "грязный" прямоугольник, а текстуры тома — с помощью рамок.</span><span class="sxs-lookup"><span data-stu-id="28e70-121">2D textures use dirty rectangle, and volume textures use boxes.</span></span>

-   [<span data-ttu-id="28e70-122">**IDirect3DCubeTexture9:: Адддиртирект**</span><span class="sxs-lookup"><span data-stu-id="28e70-122">**IDirect3DCubeTexture9::AddDirtyRect**</span></span>](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dcubetexture9-adddirtyrect)
-   [<span data-ttu-id="28e70-123">**IDirect3DTexture9:: Адддиртирект**</span><span class="sxs-lookup"><span data-stu-id="28e70-123">**IDirect3DTexture9::AddDirtyRect**</span></span>](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-adddirtyrect)
-   [<span data-ttu-id="28e70-124">**IDirect3DVolumeTexture9:: Адддиртибокс**</span><span class="sxs-lookup"><span data-stu-id="28e70-124">**IDirect3DVolumeTexture9::AddDirtyBox**</span></span>](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dvolumetexture9-adddirtybox)

<span data-ttu-id="28e70-125">Передача **значения NULL** для параметров Пдиртирект или пдиртибокс в указанных выше методах расширяет область «грязной» области для покрытия всей текстуры.</span><span class="sxs-lookup"><span data-stu-id="28e70-125">Passing **NULL** for the pDirtyRect or pDirtyBox parameters for the above methods expands the dirty region to cover the entire texture.</span></span>

<span data-ttu-id="28e70-126">Каждый метод блокировки может принимать D3DLOCK \_ без \_ "грязного" \_ обновления, что предотвращает любые изменения в "грязном" состоянии текстуры.</span><span class="sxs-lookup"><span data-stu-id="28e70-126">Each lock method can take D3DLOCK\_NO\_DIRTY\_UPDATE, which prevents any changes to the dirty state of the texture.</span></span> <span data-ttu-id="28e70-127">Дополнительные сведения см. в разделе [Блокировка ресурсов (Direct3D 9)](locking-resources.md).</span><span class="sxs-lookup"><span data-stu-id="28e70-127">For more information, see [Locking Resources (Direct3D 9)](locking-resources.md).</span></span>

<span data-ttu-id="28e70-128">Если доступны дополнительные сведения о истинном наборе регионов, измененных во время операции блокировки, приложения должны использовать D3DLOCK \_ без \_ "грязного" \_ обновления.</span><span class="sxs-lookup"><span data-stu-id="28e70-128">When more information about the true set of regions that are changed during a lock operation is available, applications should use D3DLOCK\_NO\_DIRTY\_UPDATE.</span></span> <span data-ttu-id="28e70-129">Обратите внимание, что блокировка или копия только для подуровне текстуры (т. е. без блокировки или копирования на верхний уровень) не обновляет «грязные» регионы для этой текстуры.</span><span class="sxs-lookup"><span data-stu-id="28e70-129">Note that a lock or a copy to a texture sublevel only (that is, without locking or copying to the top level) does not update the dirty regions for that texture.</span></span> <span data-ttu-id="28e70-130">Приложения предполагают такую же ответственность за обновление «грязных» регионов при блокировке более низких уровней без блокировки самого верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="28e70-130">Applications assume the same responsibility for updating dirty regions when they lock lower levels without locking the topmost level.</span></span>

## <a name="related-topics"></a><span data-ttu-id="28e70-131">См. также</span><span class="sxs-lookup"><span data-stu-id="28e70-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="28e70-132">Основные понятия текстурирования</span><span class="sxs-lookup"><span data-stu-id="28e70-132">Basic Texturing Concepts</span></span>](basic-texturing-concepts.md)
</dt> </dl>

 

 
