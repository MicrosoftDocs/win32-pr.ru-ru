---
description: Процесс может отслеживать набор событий, происходящих в ресурсе связи. Например, приложение может использовать функцию отслеживания событий, чтобы определить, когда состояние изменения сигнала CTS (Clear-To-Send) и DSR (Ready Data-Set) изменится.
ms.assetid: 5d2a7bf3-a972-474b-b8ca-da3351f1e59c
title: События связи
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 466bd5076405427c7c348c1df3706cb7b5c3edc4
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104141522"
---
# <a name="communications-events"></a><span data-ttu-id="c3f87-104">События связи</span><span class="sxs-lookup"><span data-stu-id="c3f87-104">Communications Events</span></span>

<span data-ttu-id="c3f87-105">Процесс может отслеживать набор событий, происходящих в ресурсе связи.</span><span class="sxs-lookup"><span data-stu-id="c3f87-105">A process can monitor a set of events that occur in a communications resource.</span></span> <span data-ttu-id="c3f87-106">Например, приложение может использовать функцию отслеживания событий, чтобы определить, когда состояние изменения сигнала CTS (Clear-To-Send) и DSR (Ready Data-Set) изменится.</span><span class="sxs-lookup"><span data-stu-id="c3f87-106">For example, an application can use event monitoring to determine when the CTS (clear-to-send) and DSR (data-set-ready) signals change state.</span></span>

<span data-ttu-id="c3f87-107">Процесс может отслеживать события на данном ресурсе связи с помощью функции [**сеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) для создания маски событий.</span><span class="sxs-lookup"><span data-stu-id="c3f87-107">A process can monitor events on a given communications resource by using the [**SetCommMask**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) function to create an event mask.</span></span> <span data-ttu-id="c3f87-108">Чтобы определить текущую маску события для коммуникационного ресурса, процесс может использовать функцию [**жеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-getcommmask) .</span><span class="sxs-lookup"><span data-stu-id="c3f87-108">To determine the current event mask for a communications resource, a process can use the [**GetCommMask**](/windows/desktop/api/Winbase/nf-winbase-getcommmask) function.</span></span> <span data-ttu-id="c3f87-109">Следующие значения указывают события, которые можно отслеживать.</span><span class="sxs-lookup"><span data-stu-id="c3f87-109">The following values specify events that can be monitored.</span></span>



| <span data-ttu-id="c3f87-110">Значение</span><span class="sxs-lookup"><span data-stu-id="c3f87-110">Value</span></span>           | <span data-ttu-id="c3f87-111">Значение</span><span class="sxs-lookup"><span data-stu-id="c3f87-111">Meaning</span></span>                                                                                                                                                                                                                                           |
|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c3f87-112">**\_нарушение EV**</span><span class="sxs-lookup"><span data-stu-id="c3f87-112">**EV\_BREAK**</span></span>   | <span data-ttu-id="c3f87-113">Обнаружен разрыв на входе.</span><span class="sxs-lookup"><span data-stu-id="c3f87-113">A break was detected on input.</span></span>                                                                                                                                                                                                                    |
| <span data-ttu-id="c3f87-114">**EV \_ CTS**</span><span class="sxs-lookup"><span data-stu-id="c3f87-114">**EV\_CTS**</span></span>     | <span data-ttu-id="c3f87-115">Состояние сигнала CTS (Clear-To-Send) изменилось.</span><span class="sxs-lookup"><span data-stu-id="c3f87-115">The CTS (clear-to-send) signal changed state.</span></span>                                                                                                                                                                                                     |
| <span data-ttu-id="c3f87-116">**EV \_ DSR**</span><span class="sxs-lookup"><span data-stu-id="c3f87-116">**EV\_DSR**</span></span>     | <span data-ttu-id="c3f87-117">Состояние сигнала DSR (Data-Set-Ready) изменилось.</span><span class="sxs-lookup"><span data-stu-id="c3f87-117">The DSR (data-set-ready) signal changed state.</span></span>                                                                                                                                                                                                    |
| <span data-ttu-id="c3f87-118">**\_Ошибка EV**</span><span class="sxs-lookup"><span data-stu-id="c3f87-118">**EV\_ERR**</span></span>     | <span data-ttu-id="c3f87-119">Произошла ошибка состояния строки.</span><span class="sxs-lookup"><span data-stu-id="c3f87-119">A line-status error occurred.</span></span> <span data-ttu-id="c3f87-120">Ошибки состояния строки: **CE \_ Frame**, **CE \_**, **\_ ркспарити и CE**.</span><span class="sxs-lookup"><span data-stu-id="c3f87-120">Line-status errors are **CE\_FRAME**, **CE\_OVERRUN**, and **CE\_RXPARITY**.</span></span>                                                                                                                                        |
| <span data-ttu-id="c3f87-121">**Звонок в EV \_**</span><span class="sxs-lookup"><span data-stu-id="c3f87-121">**EV\_RING**</span></span>    | <span data-ttu-id="c3f87-122">Обнаружен индикатор вызова.</span><span class="sxs-lookup"><span data-stu-id="c3f87-122">A ring indicator was detected.</span></span>                                                                                                                                                                                                                    |
| <span data-ttu-id="c3f87-123">**RLSD (EV) \_**</span><span class="sxs-lookup"><span data-stu-id="c3f87-123">**EV\_RLSD**</span></span>    | <span data-ttu-id="c3f87-124">Состояние сигнала "RLSD (получение-строка-сигнал)" изменилось.</span><span class="sxs-lookup"><span data-stu-id="c3f87-124">The RLSD (receive-line-signal-detect) signal changed state.</span></span>                                                                                                                                                                                       |
| <span data-ttu-id="c3f87-125">**\_РКСЧАР EV**</span><span class="sxs-lookup"><span data-stu-id="c3f87-125">**EV\_RXCHAR**</span></span>  | <span data-ttu-id="c3f87-126">Символ получен и помещен во входной буфер.</span><span class="sxs-lookup"><span data-stu-id="c3f87-126">A character was received and placed in the input buffer.</span></span>                                                                                                                                                                                          |
| <span data-ttu-id="c3f87-127">**\_РКСФЛАГ EV**</span><span class="sxs-lookup"><span data-stu-id="c3f87-127">**EV\_RXFLAG**</span></span>  | <span data-ttu-id="c3f87-128">Символ события был получен и помещен во входной буфер.</span><span class="sxs-lookup"><span data-stu-id="c3f87-128">The event character was received and placed in the input buffer.</span></span> <span data-ttu-id="c3f87-129">Символ события указывается в структуре [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) устройства, которая применяется к последовательному порту с помощью функции [**сеткоммстате**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) .</span><span class="sxs-lookup"><span data-stu-id="c3f87-129">The event character is specified in the device's [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) structure, which is applied to a serial port by using the [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) function.</span></span> |
| <span data-ttu-id="c3f87-130">**\_ТКСЕМПТИ EV**</span><span class="sxs-lookup"><span data-stu-id="c3f87-130">**EV\_TXEMPTY**</span></span> | <span data-ttu-id="c3f87-131">Последний символ в выходном буфере отправлен.</span><span class="sxs-lookup"><span data-stu-id="c3f87-131">The last character in the output buffer was sent.</span></span>                                                                                                                                                                                                 |



 

<span data-ttu-id="c3f87-132">После указания набора событий процесс использует функцию [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) для ожидания одного из событий.</span><span class="sxs-lookup"><span data-stu-id="c3f87-132">After a set of events is specified, a process uses the [**WaitCommEvent**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) function to wait for one of the events to occur.</span></span> <span data-ttu-id="c3f87-133">**Ваиткоммевент** можно использовать синхронно или в качестве перекрывающейся операции.</span><span class="sxs-lookup"><span data-stu-id="c3f87-133">**WaitCommEvent** can be used synchronously or as an overlapped operation.</span></span> <span data-ttu-id="c3f87-134">Дополнительные сведения о выполнении функции в качестве перекрывающихся операций см. в разделе [Синхронизация](/windows/desktop/Sync/synchronization).</span><span class="sxs-lookup"><span data-stu-id="c3f87-134">For additional information about executing a function as an overlapped operation, see [Synchronization](/windows/desktop/Sync/synchronization).</span></span>

<span data-ttu-id="c3f87-135">При возникновении одного из событий, указанных в маске событий, процесс завершает операцию ожидания и устанавливает переменную маски события для указания типа обнаруженного события.</span><span class="sxs-lookup"><span data-stu-id="c3f87-135">When one of the events specified in the event mask occurs, the process completes the wait operation and sets an event mask variable to indicate the type of event detected.</span></span> <span data-ttu-id="c3f87-136">Если [**сеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) вызывается для коммуникационного ресурса, пока ожидается ожидание для этого ресурса, [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="c3f87-136">If the [**SetCommMask**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) is called for a communications resource while a wait is pending for that resource, [**WaitCommEvent**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) returns an error.</span></span>

<span data-ttu-id="c3f87-137">Функция [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) обнаруживает события, произошедшие с момента последнего вызова метода [**сеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) или **ваиткоммевент**.</span><span class="sxs-lookup"><span data-stu-id="c3f87-137">The [**WaitCommEvent**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) function detects events that have occurred since the last call to [**SetCommMask**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) or **WaitCommEvent**.</span></span> <span data-ttu-id="c3f87-138">Например, если указать событие **EV \_ рксчар** в качестве события, удовлетворяющего ожиданиям, вызов **ваиткоммевент** будет удовлетворен, если в входном буфере драйвера были получены символы, полученные с момента последнего вызова **ваиткоммевент** или **сеткомммаск**.</span><span class="sxs-lookup"><span data-stu-id="c3f87-138">For example, if you specify the **EV\_RXCHAR** event as a wait-satisfying event, a call to **WaitCommEvent** will be satisfied if there are characters in the driver's input buffer that have arrived since the last call to **WaitCommEvent** or **SetCommMask**.</span></span> <span data-ttu-id="c3f87-139">Поэтому, учитывая следующий псевдокод, все символы, полученные между T1 и T2, будут соответствовать следующему вызову **ваиткоммевент**.</span><span class="sxs-lookup"><span data-stu-id="c3f87-139">Thus, given the following pseudocode, any characters received between T1 and T2 will satisfy the next call to **WaitCommEvent**.</span></span>


```C++
while (!bFinished) 
{ 
    WaitCommEvent(args)
 
T1: // Read bytes 
    // Process bytes 

T2: 
}
```



<span data-ttu-id="c3f87-140">При наблюдении за событием, происходящим при изменении состояния сигнала (CTS, DSR и т. д.), [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) сообщает об изменении, но не о текущем состоянии.</span><span class="sxs-lookup"><span data-stu-id="c3f87-140">When monitoring an event that occurs when a signal (CTS, DSR, and so on) changes state, [**WaitCommEvent**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) reports the change, but not the current state.</span></span> <span data-ttu-id="c3f87-141">Для запроса текущего состояния CTS (Clear-To-Send), DSR (готовность к набору данных), RLSD (Receive-Line-SignalR-Detect) и сигналов индикатора кольца процесс может использовать функцию [**жеткомммодемстатус**](/windows/desktop/api/Winbase/nf-winbase-getcommmodemstatus) .</span><span class="sxs-lookup"><span data-stu-id="c3f87-141">To query the current state of the CTS (clear-to-send), DSR (data-set-ready), RLSD (receive-line-signal-detect), and ring indicator signals, a process can use the [**GetCommModemStatus**](/windows/desktop/api/Winbase/nf-winbase-getcommmodemstatus) function.</span></span>

 

 
