---
title: Отключается
description: Когда клиентское приложение RAS запускает операцию подключения, вызов RasDial получает маркер подключения ХРАСКОНН для обнаружения подключения.
ms.assetid: a0fddc69-44bb-4bb0-ae57-ebecbe85cbe9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 859a3751bcbaf7d95927cdf6d14de859ddcc731e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070541"
---
# <a name="disconnecting"></a><span data-ttu-id="bfee3-103">Отключается</span><span class="sxs-lookup"><span data-stu-id="bfee3-103">Disconnecting</span></span>

<span data-ttu-id="bfee3-104">Когда клиентское приложение RAS запускает операцию подключения, вызов [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) получает маркер подключения **храсконн** для обнаружения подключения.</span><span class="sxs-lookup"><span data-stu-id="bfee3-104">When a RAS client application starts a connection operation, the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) call receives an **HRASCONN** connection handle to identify the connection.</span></span> <span data-ttu-id="bfee3-105">Если возвращаемый маркер не равен **null**, клиент должен в конечном итоге вызвать функцию [**рашангуп**](/windows/desktop/api/Ras/nf-ras-rashangupa) для завершения соединения.</span><span class="sxs-lookup"><span data-stu-id="bfee3-105">If the returned handle is not **NULL**, the client must eventually call the [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa) function to end the connection.</span></span> <span data-ttu-id="bfee3-106">Если во время операции соединения возникает ошибка, клиент должен вызвать **рашангуп** , даже если соединение не было установлено.</span><span class="sxs-lookup"><span data-stu-id="bfee3-106">If an error occurs during the connection operation, the client must call **RasHangUp** even though the connection was never established.</span></span>

<span data-ttu-id="bfee3-107">Приложение, вызывающее [**рашангуп**](/windows/desktop/api/Ras/nf-ras-rashangupa) , не должно немедленно выходить из-за того, что диспетчеру подключений удаленного доступа требуется время для правильного завершения подключения.</span><span class="sxs-lookup"><span data-stu-id="bfee3-107">The application that calls [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa) should not exit immediately because the Remote Access Connection Manager needs time to properly terminate the connection.</span></span> <span data-ttu-id="bfee3-108">Вместо этого приложение должно ожидать, пока функция [**расжетконнектстатус**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa) не вернет ошибку \_ Недопустимый \_ маркер, указывая на то, что соединение было удалено.</span><span class="sxs-lookup"><span data-stu-id="bfee3-108">Instead, the application should wait until the [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa) function returns ERROR\_INVALID\_HANDLE, indicating that the connection has been deleted.</span></span>

<span data-ttu-id="bfee3-109">Клиентское приложение RAS может потребовать завершения подключения, даже если оно не имеет маркера, возвращаемого [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span><span class="sxs-lookup"><span data-stu-id="bfee3-109">A RAS client application might need to end a connection even though it does not have the handle returned by [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span></span> <span data-ttu-id="bfee3-110">Например, приложение, которое вызвало команду **rasdial** , могло выйти после успешного установления соединения.</span><span class="sxs-lookup"><span data-stu-id="bfee3-110">For example, the application that called **RasDial** might have exited after the connection was successfully established.</span></span> <span data-ttu-id="bfee3-111">В этом случае отключенное приложение может использовать функцию [**расенумконнектионс**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa) для получения всех текущих соединений.</span><span class="sxs-lookup"><span data-stu-id="bfee3-111">In this case, the disconnecting application can use the [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa) function to get all the current connections.</span></span> <span data-ttu-id="bfee3-112">Для каждого соединения **расенумконнектионс** возвращает структуру [**расконн**](/previous-versions/windows/desktop/legacy/aa376725(v=vs.85)) , содержащую маркер подключения **храсконн** и имя записи телефонной книги или номер телефона, указанный при запуске операции подключения.</span><span class="sxs-lookup"><span data-stu-id="bfee3-112">For each connection, **RasEnumConnections** returns a [**RASCONN**](/previous-versions/windows/desktop/legacy/aa376725(v=vs.85)) structure that contains the **HRASCONN** connection handle and the phone-book entry name or phone number specified when the connection operation was started.</span></span> <span data-ttu-id="bfee3-113">Эти сведения можно использовать для вывода списка подключений, из которых пользователь может выбрать подключение к концу.</span><span class="sxs-lookup"><span data-stu-id="bfee3-113">This information can be used to display a list of connections from which the user can select the connection to end.</span></span>

 

 