---
title: Общие сведения о функциях управления маршрутизаторами
description: В следующих разделах рассматриваются различные типы функций управления маршрутизаторами и то, что следует учитывать для эффективного использования.
ms.assetid: 2f6831f2-39be-43b1-80bd-9a36c0f8a2af
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: be4b1891bc55b80a18a6d0dd928044da1e0e9709
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105672369"
---
# <a name="understanding-router-management-functions"></a><span data-ttu-id="7c073-103">Общие сведения о функциях управления маршрутизаторами</span><span class="sxs-lookup"><span data-stu-id="7c073-103">Understanding Router Management Functions</span></span>

<span data-ttu-id="7c073-104">В следующих разделах рассматриваются различные типы функций управления маршрутизаторами и то, что следует учитывать для эффективного использования.</span><span class="sxs-lookup"><span data-stu-id="7c073-104">The following sections discuss the different types of router management functions and what you should know to use them effectively.</span></span>

<span data-ttu-id="7c073-105">Для всех функций управления маршрутизатором требуются права администратора.</span><span class="sxs-lookup"><span data-stu-id="7c073-105">All router management functions require administrator privileges.</span></span> <span data-ttu-id="7c073-106">Пользователь в группе опытных пользователей не имеет достаточных привилегий для использования функций управления маршрутизатором.</span><span class="sxs-lookup"><span data-stu-id="7c073-106">A user in the Power User group does not have sufficient privileges to use the router management functions.</span></span>

## <a name="the-different-classes-of-router-management-functions"></a><span data-ttu-id="7c073-107">Различные классы функций управления маршрутизаторами</span><span class="sxs-lookup"><span data-stu-id="7c073-107">The Different Classes of Router Management Functions</span></span>

<span data-ttu-id="7c073-108">Функции управления маршрутизаторами можно разделить на функции администрирования и функции настройки.</span><span class="sxs-lookup"><span data-stu-id="7c073-108">The router management functions can be divided up into the administration functions and the configuration functions.</span></span> <span data-ttu-id="7c073-109">[Функции администрирования](router-administration-functions.md) имеют префикс мпрадмин, а [функции конфигурации](router-configuration-functions.md) имеют префикс мпрконфиг.</span><span class="sxs-lookup"><span data-stu-id="7c073-109">The [administration functions](router-administration-functions.md) have a prefix of MprAdmin and the [configuration functions](router-configuration-functions.md) have a prefix of MprConfig.</span></span> <span data-ttu-id="7c073-110">Несмотря на именование, для управления маршрутизаторами используются оба набора функций.</span><span class="sxs-lookup"><span data-stu-id="7c073-110">Despite the naming, both sets of functions are used for router management.</span></span> <span data-ttu-id="7c073-111">Функции Мпрадмин работают непосредственно на работающем маршрутизаторе.</span><span class="sxs-lookup"><span data-stu-id="7c073-111">The MprAdmin functions operate directly on the running router.</span></span> <span data-ttu-id="7c073-112">Функции Мпрконфиг имеют аналогичные функции, но работают с конфигурацией маршрутизатора, хранящейся в реестре.</span><span class="sxs-lookup"><span data-stu-id="7c073-112">The MprConfig functions have similar functionality, but operate on the router configuration stored in the registry.</span></span> <span data-ttu-id="7c073-113">Оба типа функций передают [информационные блоки](router-information-functions.md).</span><span class="sxs-lookup"><span data-stu-id="7c073-113">Both types of functions pass [information blocks](router-information-functions.md).</span></span>

<span data-ttu-id="7c073-114">Функции управления маршрутизаторами также можно разделить на отдельные компоненты маршрутизатора, которыми они управляют: интерфейсы, диспетчеры маршрутизаторов или клиенты диспетчера маршрутизаторов.</span><span class="sxs-lookup"><span data-stu-id="7c073-114">The router management functions can also be divided up based on what components of the router they manage: interfaces, router managers, or router manager clients.</span></span>

<span data-ttu-id="7c073-115">[Функции интерфейса маршрутизатора](router-interface-functions.md) имеют префикс либо мпрадмининтерфаце, либо мпрконфигинтерфаце.</span><span class="sxs-lookup"><span data-stu-id="7c073-115">The [router interface functions](router-interface-functions.md) have a prefix of either MprAdminInterface or MprConfigInterface.</span></span> <span data-ttu-id="7c073-116">Используйте эти функции для доступа к интерфейсам.</span><span class="sxs-lookup"><span data-stu-id="7c073-116">Use these functions to access interfaces.</span></span> <span data-ttu-id="7c073-117">[Функции диспетчера маршрутизаторов](router-manager-transport-functions.md) имеют префикс Мпрадминтранспорт или мпрконфигтранспорт.</span><span class="sxs-lookup"><span data-stu-id="7c073-117">The [router manager functions](router-manager-transport-functions.md) have a prefix of MprAdminTransport or MprConfigTransport.</span></span> <span data-ttu-id="7c073-118">Используйте эти функции для доступа к диспетчерам маршрутизаторов.</span><span class="sxs-lookup"><span data-stu-id="7c073-118">Use these functions to access the router managers.</span></span> <span data-ttu-id="7c073-119">Наконец, у [клиента диспетчера маршрутизаторов](router-manager-client-interfacetransport-functions.md) есть префикс Мпрадмининтерфацетранспорт или мпрконфигинтерфацетранспорт.</span><span class="sxs-lookup"><span data-stu-id="7c073-119">Lastly, the [router manager client functions](router-manager-client-interfacetransport-functions.md) have a prefix of MprAdminInterfaceTransport or MprConfigInterfaceTransport.</span></span> <span data-ttu-id="7c073-120">Используйте эти функции для доступа к клиентам, работающим на маршрутизаторе.</span><span class="sxs-lookup"><span data-stu-id="7c073-120">Use these functions to access the clients running on the router.</span></span>

<span data-ttu-id="7c073-121">Подмножество функций Мпрадмин — это [функции мпрадминмиб](/windows/desktop/RRAS/about-router-management-with-mib).</span><span class="sxs-lookup"><span data-stu-id="7c073-121">A subset of MprAdmin functions are the [MprAdminMib functions](/windows/desktop/RRAS/about-router-management-with-mib).</span></span> <span data-ttu-id="7c073-122">Они также работают только с выполняющимся маршрутом.</span><span class="sxs-lookup"><span data-stu-id="7c073-122">These also operate on the running route alone.</span></span> <span data-ttu-id="7c073-123">Однако эти функции не передают информационные блоки.</span><span class="sxs-lookup"><span data-stu-id="7c073-123">However, these functions do not pass information blocks.</span></span> <span data-ttu-id="7c073-124">Эти функции обеспечивают дополнительную гибкость в конструкторе протоколов, особенно для получения сведений о неконфигурации, например статистики.</span><span class="sxs-lookup"><span data-stu-id="7c073-124">These functions provide additional flexibility to the protocol designer, especially for retrieving non-configuration information, such as statistics.</span></span>

## <a name="ensuring-that-changes-occur-immediately-and-are-persistent"></a><span data-ttu-id="7c073-125">Проверка того, что изменения происходят немедленно и являются постоянными</span><span class="sxs-lookup"><span data-stu-id="7c073-125">Ensuring that Changes Occur Immediately and are Persistent</span></span>

<span data-ttu-id="7c073-126">Разработчик может вносить изменения в конфигурацию маршрутизатора непосредственно с помощью [функций настройки маршрутизатора](router-configuration-functions.md).</span><span class="sxs-lookup"><span data-stu-id="7c073-126">A developer can make changes to the router configuration directly using the [router configuration functions](router-configuration-functions.md).</span></span> <span data-ttu-id="7c073-127">Однако любые изменения, внесенные в конфигурацию, вступают в силу только после перезапуска маршрутизатора, поскольку это единственный момент, когда DIM считывает конфигурацию из реестра.</span><span class="sxs-lookup"><span data-stu-id="7c073-127">However, any changes made to the configuration do not take effect until the router is restarted, since this is the only time that DIM reads the configuration from the registry.</span></span>

<span data-ttu-id="7c073-128">Разработчик может вносить изменения в выполняющийся маршрутизатор с помощью [функций администрирования маршрутизатора](router-administration-functions.md).</span><span class="sxs-lookup"><span data-stu-id="7c073-128">A developer can make changes to the running router by using the [router administration functions](router-administration-functions.md).</span></span> <span data-ttu-id="7c073-129">Однако эти изменения не являются постоянными: поскольку они не были записаны в реестр, они теряются при перезапуске маршрутизатора.</span><span class="sxs-lookup"><span data-stu-id="7c073-129">However, these changes are not persistent: since they have not been written to the registry, they are lost if the router is restarted.</span></span>

<span data-ttu-id="7c073-130">Для внесения немедленных и постоянных изменений разработчику необходимо использовать функции администрирования маршрутизатора и конфигурации маршрутизатора.</span><span class="sxs-lookup"><span data-stu-id="7c073-130">In order to make changes that are both immediate and persistent, a developer needs to use both the router administration and the router configuration functions.</span></span> <span data-ttu-id="7c073-131">Если маршрутизатор не работает, разработчику необходимо вызвать только соответствующие функции настройки маршрутизатора.</span><span class="sxs-lookup"><span data-stu-id="7c073-131">If the router is not running, the developer need only call the appropriate router configuration functions.</span></span>

<span data-ttu-id="7c073-132">Для запроса сведений от работающего маршрутизатора используйте функции администрирования маршрутизатора.</span><span class="sxs-lookup"><span data-stu-id="7c073-132">For querying information from the running router, use the router administration functions.</span></span> <span data-ttu-id="7c073-133">Если маршрутизатор не работает, запросите сведения, используя функции настройки маршрутизатора.</span><span class="sxs-lookup"><span data-stu-id="7c073-133">If the router is not running, query information using the router configuration functions.</span></span>

<span data-ttu-id="7c073-134">Функции [**мпрадмининтерфацекреате**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacecreate) и [**мпрадмининтерфацесетинфо**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacesetinfo) поддерживают структуру с [**\_ интерфейсом MPR \_ 2**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_2) .</span><span class="sxs-lookup"><span data-stu-id="7c073-134">The [**MprAdminInterfaceCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacecreate) and [**MprAdminInterfaceSetInfo**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacesetinfo) functions support the [**MPR\_INTERFACE\_2**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_2) structure.</span></span> <span data-ttu-id="7c073-135">Однако [**мпрконфигинтерфацекреате**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacecreate) и [**мпрконфигинтерфацесетинфо**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacesetinfo) не имеют.</span><span class="sxs-lookup"><span data-stu-id="7c073-135">However, [**MprConfigInterfaceCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacecreate) and [**MprConfigInterfaceSetInfo**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacesetinfo) do not.</span></span> <span data-ttu-id="7c073-136">Чтобы создать постоянный интерфейс вызова по требованию после перезагрузки, вызовите **мпрадмининтерфацекреате** с **\_ интерфейсом MPR \_ 2**, а затем вызовите **мпрконфигинтерфацекреате** с [**\_ интерфейсом MPR \_ 0**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_0) или [**многопротокольный \_ интерфейс \_ 1**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_1).</span><span class="sxs-lookup"><span data-stu-id="7c073-136">In order to create a demand-dial interface that is persistent after a reboot, call **MprAdminInterfaceCreate** with **MPR\_INTERFACE\_2**, then call **MprConfigInterfaceCreate** with [**MPR\_INTERFACE\_0**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_0) or [**MPR\_INTERFACE\_1**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_1).</span></span> <span data-ttu-id="7c073-137">Аналогичным образом, чтобы внести постоянные изменения в интерфейс вызова по требованию, вызовите **мпрадмининтерфацесетинфо** с **\_ Interface \_ 2**, затем вызовите **мпрконфигинтерфацесетинфо** с **\_ интерфейсом MPR \_ 0** или **многопротокольный \_ интерфейс \_ 1**.</span><span class="sxs-lookup"><span data-stu-id="7c073-137">Similarly, to make persistent changes to a demand-dial interface, call **MprAdminInterfaceSetInfo** with **MPR\_INTERFACE\_2**, then call **MprConfigInterfaceSetInfo** with **MPR\_INTERFACE\_0** or **MPR\_INTERFACE\_1**.</span></span>

## <a name="using-router-administration-and-configuration-functions-remotely"></a><span data-ttu-id="7c073-138">Удаленное использование функций администрирования и настройки маршрутизатора</span><span class="sxs-lookup"><span data-stu-id="7c073-138">Using Router Administration and Configuration Functions Remotely</span></span>

<span data-ttu-id="7c073-139">Большинство функций администрирования и настройки маршрутизатора можно вызывать на компьютере, отличном от управляемого.</span><span class="sxs-lookup"><span data-stu-id="7c073-139">Most of the router administration and configuration functions can be called on a computer other than the one being administered.</span></span> <span data-ttu-id="7c073-140">Эти функции принимают в качестве параметра, обработчика для службы маршрутизатора или конфигурацию для администрирования.</span><span class="sxs-lookup"><span data-stu-id="7c073-140">These functions take as a parameter, a handle to the router service or configuration to administer.</span></span> <span data-ttu-id="7c073-141">Функции администрирования используют RPC (удаленный вызов процедур) для взаимодействия со службой маршрутизации, заданной этим маркером.</span><span class="sxs-lookup"><span data-stu-id="7c073-141">The administration functions use RPC (Remote Procedure Call) to communicate with the routing service specified by the handle.</span></span> <span data-ttu-id="7c073-142">Функции настройки записывают и считывают данные из реестра компьютера, указанного в маркере.</span><span class="sxs-lookup"><span data-stu-id="7c073-142">The configuration functions write to and read from the registry of the computer specified by the handle.</span></span>

<span data-ttu-id="7c073-143">Для администрирования службы маршрутизации на удаленном компьютере сначала вызовите [**мпрадминиссервицеруннинг**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminisservicerunning) , чтобы убедиться, что служба запущена.</span><span class="sxs-lookup"><span data-stu-id="7c073-143">To administer the routing service on a remote machine first call [**MprAdminIsServiceRunning**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminisservicerunning) to verify that the service is running.</span></span> <span data-ttu-id="7c073-144">Затем вызовите [**мпрадминсерверконнект**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminserverconnect) , чтобы получить маркер.</span><span class="sxs-lookup"><span data-stu-id="7c073-144">Then call [**MprAdminServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminserverconnect) to obtain the handle.</span></span> <span data-ttu-id="7c073-145">Если служба маршрутизатора не запущена на удаленном компьютере, все вызовы администрирования маршрутизатора (Мпрадмин) завершатся ошибкой.</span><span class="sxs-lookup"><span data-stu-id="7c073-145">If the router service is not running on the remote machine, all router administration (MprAdmin) calls fail.</span></span>

<span data-ttu-id="7c073-146">Чтобы внести изменения в конфигурацию маршрутизатора на удаленном компьютере, получите маркер, вызвав функцию [**мпрконфигсерверконнект**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfigserverconnect) .</span><span class="sxs-lookup"><span data-stu-id="7c073-146">To make changes to the router configuration on a remote machine obtain a handle by calling the [**MprConfigServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfigserverconnect) function.</span></span>

 

 