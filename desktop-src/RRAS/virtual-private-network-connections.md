---
title: Подключения к виртуальной частной сети
description: Служба удаленного доступа (RAS) поддерживает подключения к виртуальной частной сети (VPN) в дополнение к традиционным подключениям удаленного доступа, использующим протокол PPP (PPP).
ms.assetid: c1195ebb-3107-4429-bc67-b64577d66268
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09f5fc0b80a6eb00e7587e941eea39c056a11d14
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070118"
---
# <a name="virtual-private-network-connections"></a><span data-ttu-id="5a185-103">Подключения к виртуальной частной сети</span><span class="sxs-lookup"><span data-stu-id="5a185-103">Virtual Private Network Connections</span></span>

<span data-ttu-id="5a185-104">Служба удаленного доступа (RAS) поддерживает подключения к виртуальной частной сети (VPN) в дополнение к традиционным подключениям удаленного доступа, использующим протокол PPP (PPP).</span><span class="sxs-lookup"><span data-stu-id="5a185-104">The Remote Access Service (RAS) supports Virtual Private Network (VPN) connections in addition to conventional remote access connections that use Point-to-Point Protocol (PPP).</span></span> <span data-ttu-id="5a185-105">В VPN-подключении пакеты VPN инкапсулируются в IP-пакетах и отправляются через IP-сеть, например в Интернет.</span><span class="sxs-lookup"><span data-stu-id="5a185-105">In a VPN connection, the VPN packets are encapsulated in IP packets and sent across an IP network such as the Internet.</span></span> <span data-ttu-id="5a185-106">Поэтому для установки VPN-подключения требуется доступ к IP-сети.</span><span class="sxs-lookup"><span data-stu-id="5a185-106">Therefore, access to an IP network is a requirement in order to establish a VPN connection.</span></span> <span data-ttu-id="5a185-107">Если клиентский компьютер имеет постоянное подключение к IP-сети, например подключение к IP-локальной сети, клиент может установить VPN-подключение с помощью одного вызова функции [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) .</span><span class="sxs-lookup"><span data-stu-id="5a185-107">If the client computer has an always-on connection to an IP network, for example a connection to an IP LAN, the client can establish the VPN connection using a single call to the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function.</span></span>

<span data-ttu-id="5a185-108">Если клиентский компьютер не имеет постоянного подключения к IP-сети, для установки VPN-подключения требуется два вызова команды [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) .</span><span class="sxs-lookup"><span data-stu-id="5a185-108">If the client computer does not have an always-on connection to an IP network, two calls to [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) are required to establish the VPN connection.</span></span> <span data-ttu-id="5a185-109">Первый вызов устанавливает коммутируемое подключение к IP-сети; второй вызов устанавливает VPN-подключение.</span><span class="sxs-lookup"><span data-stu-id="5a185-109">The first call establishes a dial-up connection to the IP network; the second call establishes the VPN connection.</span></span>

<span data-ttu-id="5a185-110">Элемент **сзлокалфоненумбер** структуры [**расентри**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) для VPN-подключения должен содержать либо DNS-имя, либо IP-адрес целевого VPN-сервера.</span><span class="sxs-lookup"><span data-stu-id="5a185-110">The **szLocalPhoneNumber** member of the [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) structure for the VPN connection should contain either the DNS name or IP address of the destination VPN server.</span></span>

<span data-ttu-id="5a185-111">Для каждого подключения требуется отдельная запись [телефонной книги](ras-phone-books.md) .</span><span class="sxs-lookup"><span data-stu-id="5a185-111">Each connection requires a separate [phone-book](ras-phone-books.md) entry.</span></span> <span data-ttu-id="5a185-112">Первый вызов команды [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) указывает запись телефонной книги для IP-сети.</span><span class="sxs-lookup"><span data-stu-id="5a185-112">The first call to [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) specifies the phone-book entry for the IP network.</span></span> <span data-ttu-id="5a185-113">Второй вызов задает запись телефонной книги для VPN.</span><span class="sxs-lookup"><span data-stu-id="5a185-113">The second call specifies the phone-book entry for the VPN.</span></span>

<span data-ttu-id="5a185-114">Функция [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) принимает указатель на структуру [**расдиалпарамс**](/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)) в качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="5a185-114">The [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function takes a pointer to a [**RASDIALPARAMS**](/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)) structure as a parameter.</span></span> <span data-ttu-id="5a185-115">Эта структура задает учетные данные для проверки подлинности, используемые для сети, указанной в записи телефонной книги.</span><span class="sxs-lookup"><span data-stu-id="5a185-115">This structure specifies the authentication credentials to use for the network specified by the phone-book entry.</span></span> <span data-ttu-id="5a185-116">Учетные данные, необходимые для доступа к IP-сети, обычно отличаются от тех, которые используются для VPN.</span><span class="sxs-lookup"><span data-stu-id="5a185-116">The credentials required to access the IP network are typically different from those for the VPN.</span></span> <span data-ttu-id="5a185-117">Первый вызов команды **rasdial** должен указывать учетные данные для IP-сети.</span><span class="sxs-lookup"><span data-stu-id="5a185-117">The first call to **RasDial** should specify credentials for the IP network.</span></span> <span data-ttu-id="5a185-118">Второй вызов должен указать учетные данные для VPN.</span><span class="sxs-lookup"><span data-stu-id="5a185-118">The second call should specify credentials for the VPN.</span></span>

<span data-ttu-id="5a185-119">Если функция [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) выполнена успешно, она возвращает маркер для соединения.</span><span class="sxs-lookup"><span data-stu-id="5a185-119">If the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function is successful, it returns a handle for the connection.</span></span> <span data-ttu-id="5a185-120">Используйте этот маркер в вызове [**рашангуп**](/windows/desktop/api/Ras/nf-ras-rashangupa) для завершения соединения.</span><span class="sxs-lookup"><span data-stu-id="5a185-120">Use this handle in a call to [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa) to terminate the connection.</span></span>

<span data-ttu-id="5a185-121">В предыдущем сценарии два вызова [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) возвращают отдельные дескрипторы подключения для IP-сети и VPN.</span><span class="sxs-lookup"><span data-stu-id="5a185-121">In the preceding scenario, the two calls to [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) return separate connection handles for the IP network and the VPN.</span></span> <span data-ttu-id="5a185-122">Вызов [**рашангуп**](/windows/desktop/api/Ras/nf-ras-rashangupa) с помощью МАРКЕРа VPN-подключения прерывает VPN-подключение, но оставляет подключение к IP-сети неизменным.</span><span class="sxs-lookup"><span data-stu-id="5a185-122">Calling [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa) with the handle for the VPN connection terminates the VPN connection but leaves the connection to the IP network intact.</span></span>

 

 