---
title: Использование диспетчера перезапуска
description: В следующих разделах описывается использование API диспетчера перезапуска.
ms.assetid: 78448d5e-20f6-45b6-b833-7d7791e5e4c6
keywords:
- Перезапустите диспетчер перезапуска диспетчера, с помощью
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6e4ac72edb9f2395bbd67236806c3ab3029372cc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103890961"
---
# <a name="using-restart-manager"></a><span data-ttu-id="db797-104">Использование диспетчера перезапуска</span><span class="sxs-lookup"><span data-stu-id="db797-104">Using Restart Manager</span></span>

<span data-ttu-id="db797-105">В следующих разделах описывается использование API диспетчера перезапуска.</span><span class="sxs-lookup"><span data-stu-id="db797-105">The following sections describe using the Restart Manager API.</span></span> <span data-ttu-id="db797-106">Приложения и службы также должны следовать [рекомендациям для приложений и служб](guidelines-for-applications-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="db797-106">Your applications and services should also follow the [Guidelines for Applications and Services](guidelines-for-applications-and-services.md).</span></span>

## <a name="using-the-microsoft-windows-installer"></a><span data-ttu-id="db797-107">Использование установщик Windows Майкрософт</span><span class="sxs-lookup"><span data-stu-id="db797-107">Using the Microsoft Windows Installer</span></span>

<span data-ttu-id="db797-108">[Microsoft установщик Windows](/windows/desktop/Msi/windows-installer-portal) версии 4,0 — это служба установки приложений Windows Vista или windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="db797-108">The [Microsoft Windows Installer](/windows/desktop/Msi/windows-installer-portal) Version 4.0 is the application installation service of Windows Vista or Windows Server 2008.</span></span> <span data-ttu-id="db797-109">Приложения, использующие установщик Windows версии 4,0 для установки и обслуживания, автоматически используют диспетчер перезапуска для уменьшения числа перезапусков системы.</span><span class="sxs-lookup"><span data-stu-id="db797-109">Applications that use the Windows Installer version 4.0 for installation and servicing automatically use the Restart Manager to reduce system restarts.</span></span> <span data-ttu-id="db797-110">Пользовательские установщики также могут вызывать API диспетчера перезапуска для завершения работы и перезапуска приложений и служб непосредственно во избежание перезагрузки системы.</span><span class="sxs-lookup"><span data-stu-id="db797-110">Custom installers can also be designed to call the Restart Manager API to shut down and restart applications and services directly to avoid requiring a system restart.</span></span> <span data-ttu-id="db797-111">В случаях, когда перезапуск системы недоступен, установщики могут использовать функцию [**инитиатешутдовн**](/windows/desktop/api/winreg/nf-winreg-initiateshutdowna) или [**ExitWindowsEx**](/windows/desktop/api/winuser/nf-winuser-exitwindowsex) , чтобы запланировать ее таким образом, чтобы минимизировать перерывы в работе пользователя.</span><span class="sxs-lookup"><span data-stu-id="db797-111">In cases where a system restart is unavoidable, installers can use the [**InitiateShutdown**](/windows/desktop/api/winreg/nf-winreg-initiateshutdowna) or [**ExitWindowsEx**](/windows/desktop/api/winuser/nf-winuser-exitwindowsex) function to schedule it in such a way that it minimizes the disruption to the user.</span></span> <span data-ttu-id="db797-112">Интерактивные установщик Windows пакеты должны реализовывать пользовательский интерфейс, который включает в себя диалоговое окно [мсирмфилесинусе](/windows/desktop/Msi/msirmfilesinuse-dialog) .</span><span class="sxs-lookup"><span data-stu-id="db797-112">Interactive Windows Installer packages should implement a user interface that includes a [MsiRMFilesInUse](/windows/desktop/Msi/msirmfilesinuse-dialog) dialog box.</span></span> <span data-ttu-id="db797-113">Дополнительные сведения см. в разделе [использование установщик Windows с диспетчером перезапуска](/windows/desktop/Msi/using-windows-installer-with-restart-manager) в документации по пакету SDK для установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="db797-113">For more information, see [Using Windows Installer with Restart Manager](/windows/desktop/Msi/using-windows-installer-with-restart-manager) in the Windows Installer SDK documentation.</span></span>

## <a name="using-the-restart-manager-api-with-custom-installers"></a><span data-ttu-id="db797-114">Использование API диспетчера перезапуска с пользовательскими установщиками</span><span class="sxs-lookup"><span data-stu-id="db797-114">Using the Restart Manager API with Custom Installers</span></span>

<span data-ttu-id="db797-115">Пользовательские установщики или пакет установщик Windows, содержащий настраиваемые действия, вызывающие перезагрузку системы, могут использовать API диспетчера перезапуска для завершения работы и перезапуска приложений и служб.</span><span class="sxs-lookup"><span data-stu-id="db797-115">Custom installers, or a Windows Installer package that contains custom actions that cause a system restart, can use the Restart Manager API to shut down and restart applications and services.</span></span>

-   <span data-ttu-id="db797-116">Все операции, выполняемые с помощью API диспетчера перезапуска, должны быть связаны с сеансом.</span><span class="sxs-lookup"><span data-stu-id="db797-116">All operations that are performed using the Restart Manager API must be associated with a session.</span></span> <span data-ttu-id="db797-117">В системе одновременно может быть открыто не более 64 сеансов диспетчера перезапуска на каждый сеанс пользователя.</span><span class="sxs-lookup"><span data-stu-id="db797-117">A maximum of 64 Restart Manager sessions per user session can be open on the system at the same time.</span></span> <span data-ttu-id="db797-118">Основной установщик запускается и завершает сеанс диспетчера перезапуска.</span><span class="sxs-lookup"><span data-stu-id="db797-118">The primary installer starts and ends the Restart Manager session.</span></span> <span data-ttu-id="db797-119">Дополнительные сведения об использовании диспетчера перезапуска с одним установщиком см. в разделе [Использование диспетчера перезапуска с основным установщиком](using-restart-manager-with-a-primary-installer.md).</span><span class="sxs-lookup"><span data-stu-id="db797-119">For more information about using Restart Manager with a single installer, see [Using Restart Manager with a Primary Installer](using-restart-manager-with-a-primary-installer.md).</span></span>
-   <span data-ttu-id="db797-120">При необходимости в процессе установки один или несколько вторичных установщиков могут быть присоединены к сеансу диспетчера перезапуска и могут выполняться как внутри процесса, так и вне процесса основного установщика.</span><span class="sxs-lookup"><span data-stu-id="db797-120">If necessary for the installation, one or more secondary installers can be joined to the Restart Manager session and can run either in-process or out-of-process of the primary installer.</span></span> <span data-ttu-id="db797-121">Вторичным установщикам требуется, чтобы ключ сеанса был предоставлен основным установщиком для приподключения к сеансу.</span><span class="sxs-lookup"><span data-stu-id="db797-121">Secondary installers require that the session key be provided by the primary installer to join a session.</span></span> <span data-ttu-id="db797-122">Дополнительные сведения и пример использования вторичных установщиков см. в статье [Использование диспетчера перезапуска с дополнительными установщиками](using-restart-manager-with-a-secondary-installer.md).</span><span class="sxs-lookup"><span data-stu-id="db797-122">For more information and an example of using secondary installers, see [Using Restart Manager with a Secondary Installer](using-restart-manager-with-a-secondary-installer.md).</span></span>
-   <span data-ttu-id="db797-123">Интерактивные установщики должны реализовывать пользовательский интерфейс, включающий в себя диалоговое окно [мсирмфилесинусе](/windows/desktop/Msi/msirmfilesinuse-dialog) , которое может попросить пользователей закрыть приложения и службы.</span><span class="sxs-lookup"><span data-stu-id="db797-123">Interactive installers should implement a user interface that includes an [MsiRMFilesInUse](/windows/desktop/Msi/msirmfilesinuse-dialog) dialog box that can ask users to close applications and services.</span></span> <span data-ttu-id="db797-124">Дополнительные сведения см. в разделе [использование установщик Windows с диспетчером перезапуска](/windows/desktop/Msi/using-windows-installer-with-restart-manager) в документации по пакету SDK для установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="db797-124">For more information, see [Using Windows Installer with Restart Manager](/windows/desktop/Msi/using-windows-installer-with-restart-manager) in the Windows Installer SDK documentation.</span></span>
-   <span data-ttu-id="db797-125">Установщики могут вызывать API диспетчера перезапуска для изменения, отмены и получения состояния текущей операции диспетчера перезапуска.</span><span class="sxs-lookup"><span data-stu-id="db797-125">Installers can call the Restart Manager API to change, cancel, and get the status of the current Restart Manager operation.</span></span> <span data-ttu-id="db797-126">Дополнительные сведения см. в следующих разделах: [Получение состояния операции диспетчера перезапуска](getting-the-status-of-a-restart-manager-operation.md) и [Отмена текущей операции диспетчера перезапуска](canceling-the-current-restart-manager-operation.md).</span><span class="sxs-lookup"><span data-stu-id="db797-126">For more information, see the following topics: [Getting the Status of a Restart Manager Operation](getting-the-status-of-a-restart-manager-operation.md) and [Canceling the Current Restart Manager Operation](canceling-the-current-restart-manager-operation.md).</span></span>
-   <span data-ttu-id="db797-127">Установщики не должны отключать перенаправление файловой системы перед вызовом API диспетчера перезапуска.</span><span class="sxs-lookup"><span data-stu-id="db797-127">Installers should not disable file system redirection before calling the Restart Manager API.</span></span> <span data-ttu-id="db797-128">Некоторые 32-разрядные установщики, выполняемые в 64-разрядной версии Windows, могут не зарегистрировать файл в каталоге% WINDIR% \\ System32.</span><span class="sxs-lookup"><span data-stu-id="db797-128">Some 32-bit installers run on 64-bit Windows may be unable to register a file in the %windir%\\system32 directory.</span></span>

 

 