---
title: 64-разрядные замечания
description: Благодаря повышению уровня доступности 64-разрядных ОС Windows пользователи предполагают входные методы, такие как международные клавиатуры на различных языках или редакторы методов ввода (IME) на восточноазиатских языках, для правильной работы с 32-и 64-разрядными приложениями.
ms.assetid: 6a99ad45-202c-4fbb-9707-341bc9fde21e
keywords:
- Платформа текстовых служб (TSF), 64-разрядная версия Windows
- TSF (платформа текстовых служб), 64-разрядная версия Windows
- текстовые службы, 64-разрядная версия Windows
- 64-разрядная версия Windows
- Платформа текстовых служб (TSF), редактор методов ввода (IME)
- TSF (платформа текстовых служб), редактор методов ввода (IME)
- текстовые службы, редактор методов ввода (IME)
- редактор метода ввода (IME)
- IME (редактор метода ввода)
- Платформа текстовых служб (TSF), международные клавиатуры
- TSF (платформа текстовых служб), международные клавиатуры
- текстовые службы, международные клавиатуры
- международные клавиатуры
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 045ec699c7a433f15b92467e3072d30acbf01936
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413127"
---
# <a name="64-bit-considerations"></a><span data-ttu-id="7eb03-116">64-разрядные замечания</span><span class="sxs-lookup"><span data-stu-id="7eb03-116">64-Bit Considerations</span></span>

<span data-ttu-id="7eb03-117">Благодаря повышению уровня доступности 64-разрядных ОС Windows пользователи предполагают входные методы, такие как международные клавиатуры на различных языках или редакторы методов ввода (IME) на восточноазиатских языках, для правильной работы с 32-и 64-разрядными приложениями.</span><span class="sxs-lookup"><span data-stu-id="7eb03-117">With the increasing availability of 64-bit Windows, users expect input methods, such as international keyboards in various languages or Input Method Editors (IMEs) in East Asian languages, to work properly with both 32-bit and 64-bit applications.</span></span> <span data-ttu-id="7eb03-118">При разработке компонентов метода ввода или текстовых служб для Microsoft Windows важно учитывать 64-разрядную платформу Windows в качестве потенциальной целевой платформы для вашего продукта.</span><span class="sxs-lookup"><span data-stu-id="7eb03-118">When developing input method components or text services for Microsoft Windows, it is important to consider 64-bit Windows as a potential target platform for your product.</span></span>

<span data-ttu-id="7eb03-119">Так как редакторы IME и текстовые службы (основанные на платформе текстовых служб) обычно реализуются как библиотеки динамической компоновки (DLL), важно отметить, что библиотеки DLL создаются специально для использования в 32-или 64-разрядных средах. Библиотека DLL, созданная для использования в 32-разрядных средах, не может использоваться в 64-разрядных приложениях и наоборот.</span><span class="sxs-lookup"><span data-stu-id="7eb03-119">Because IMEs and text services (based on the Text Services Framework) are typically implemented as dynamic-link libraries (DLLs), it is important to note that DLLs are built specifically for use in either 32-bit environments or 64-bit environments; a DLL built for use in 32-bit environments cannot be used by 64-bit applications, and vice versa.</span></span>

> [!Note]  
> <span data-ttu-id="7eb03-120">Подсистема WOW64 не снижает опасность этого ограничения для данной версии DLL.</span><span class="sxs-lookup"><span data-stu-id="7eb03-120">WOW64 does not mitigate this bit-specific DLL restriction.</span></span> <span data-ttu-id="7eb03-121">Сведения о WOW64 см. в разделе [выполнение 32-разрядных приложений](/windows/desktop/WinProg64/running-32-bit-applications).</span><span class="sxs-lookup"><span data-stu-id="7eb03-121">For information about WOW64, see [Running 32-bit Applications](/windows/desktop/WinProg64/running-32-bit-applications).</span></span>

 

<span data-ttu-id="7eb03-122">В этом разделе обсуждаются важные вопросы проектирования по разработке редакторов IME и текстовых служб для использования в 64-разрядных Windows.</span><span class="sxs-lookup"><span data-stu-id="7eb03-122">This topic discusses important design considerations for developing IMEs and text services for use on 64-bit Windows.</span></span>

## <a name="64-bit-considerations-for-imes"></a><span data-ttu-id="7eb03-123">64-разрядная информация по редакторам IME</span><span class="sxs-lookup"><span data-stu-id="7eb03-123">64-Bit Considerations for IMEs</span></span>

<span data-ttu-id="7eb03-124">В этом разделе описаны особые соображения, связанные с созданием редакторов IME для использования с 64-разрядными Windows.</span><span class="sxs-lookup"><span data-stu-id="7eb03-124">This section describes the special considerations involved with building IMEs for use with 64-bit Windows.</span></span> <span data-ttu-id="7eb03-125">Дополнительные сведения о редакторах IME см. в разделе [Редактор метода ввода](/previous-versions/windows/desktop/dnacc/input-method-editor-and-text-services-framework-accessibility).</span><span class="sxs-lookup"><span data-stu-id="7eb03-125">For information about IMEs, see [Input Method Editor](/previous-versions/windows/desktop/dnacc/input-method-editor-and-text-services-framework-accessibility).</span></span>

## <a name="building-32-bit-and-64-bit-versions-of-an-ime"></a><span data-ttu-id="7eb03-126">Создание 32-разрядных и 64-разрядных версий IME</span><span class="sxs-lookup"><span data-stu-id="7eb03-126">Building 32-Bit and 64-Bit Versions of an IME</span></span>

<span data-ttu-id="7eb03-127">Из-за ранее упомянутой 32-разрядной или 64-разрядной проблемы совместимости с библиотеками DLL необходимо предпринять некоторые меры предосторожности, чтобы обеспечить прозрачность работы IME с любым приложением (32-разрядным или 64-разрядным), работающим в 64-разрядной версии Windows.</span><span class="sxs-lookup"><span data-stu-id="7eb03-127">Because of the previously mentioned 32-bit/64-bit compatibility issue with DLLs, some precautions must be taken to ensure that IMEs work transparently with any application (32-bit or 64-bit) running on 64-bit Windows.</span></span> <span data-ttu-id="7eb03-128">Рекомендуемое решение для того, чтобы редактор IME работал прозрачно с 32-разрядными и 64-разрядными приложениями на 64-разрядной платформе, — это создание и установка параллельных 32-разрядных и 64-разрядных версий библиотеки DLL IME.</span><span class="sxs-lookup"><span data-stu-id="7eb03-128">The recommended solution for enabling your IME to work transparently with both 32-bit and 64-bit applications on a 64-bit platform is to build and install parallel 32-bit and 64-bit versions of the IME DLL.</span></span> <span data-ttu-id="7eb03-129">Как правило, разработчики создают параллельные библиотеки DLL из одного источника, настраивая параметры целевой платформы в своей среде сборки.</span><span class="sxs-lookup"><span data-stu-id="7eb03-129">Typically, developers build parallel DLLs from a single source by adjusting the target platform settings in their build environment.</span></span> <span data-ttu-id="7eb03-130">Дополнительные сведения о 32-разрядных и 64-разрядных приложениях с одним разрядами см. в разделе [Подготовка к 64-bit Windows](/windows/desktop/WinProg64/getting-ready-for-64-bit-windows).</span><span class="sxs-lookup"><span data-stu-id="7eb03-130">For more information about single-sourcing 32-bit and 64-bit applications, see [Getting Ready for 64-bit Windows](/windows/desktop/WinProg64/getting-ready-for-64-bit-windows).</span></span>

## <a name="side-by-side-installation-of-64-bit-and-32-bit-input-method-editors"></a><span data-ttu-id="7eb03-131">Параллельная установка 64-разрядных и 32-разрядных редакторов методов ввода</span><span class="sxs-lookup"><span data-stu-id="7eb03-131">Side-by-Side Installation of 64-Bit and 32-Bit Input Method Editors</span></span>

<span data-ttu-id="7eb03-132">Разработчикам редакторов IME и текстовых служб следует помнить о 64-разрядных вопросах, описанных в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="7eb03-132">Developers of IMEs and text services should be aware of the 64-bit considerations described throughout this topic.</span></span> <span data-ttu-id="7eb03-133">К счастью, конечным пользователям этих служб не нужно беспокоиться о конкретных реализациях.</span><span class="sxs-lookup"><span data-stu-id="7eb03-133">Fortunately, end users of these services need not be concerned with these implementation-specific details.</span></span> <span data-ttu-id="7eb03-134">Функция 64-разрядной версии Windows — это возможность скрыть от конечных пользователей необходимость в версиях DLL IME, относящихся к 64-и 32-bit.</span><span class="sxs-lookup"><span data-stu-id="7eb03-134">A feature of 64-bit Windows is the ability to hide the need for 64-bit and 32-bit-specific versions of the IME DLLs from end users.</span></span> <span data-ttu-id="7eb03-135">Если обе версии IME правильно установлены в параллельном режиме, 64-разрядная система Windows распознает наличие как 64-разрядных, так и 32-разрядных версий IME и представляет эти поразрядные редакторы IME для конечного пользователя как единый *логический* редактор IME.</span><span class="sxs-lookup"><span data-stu-id="7eb03-135">When both versions of the IME are properly installed in a side-by-side manner, 64-bit Windows recognizes the presence of both 64-bit and 32-bit versions of the IME and presents these bit-specific IMEs to the end user as a single *logical* IME.</span></span> <span data-ttu-id="7eb03-136">Когда пользователь должен использовать IME, 64-разрядная версия Windows прозрачно выбирает версию IME (32-bit или 64-bit), соответствующую заданным обстоятельствам.</span><span class="sxs-lookup"><span data-stu-id="7eb03-136">When an end user needs to use an IME, 64-bit Windows transparently chooses the version of the IME (32-bit or 64-bit) that is appropriate for the given circumstances.</span></span>

<span data-ttu-id="7eb03-137">Для параллельной установки 64-разрядного и 32-разрядного редактора IME для правильной работы (то есть для представления двух библиотек DLL, зависящих от платформы, в качестве одного логического редактора IME) должны выполняться следующие условия.</span><span class="sxs-lookup"><span data-stu-id="7eb03-137">For side-by-side installations of 64-bit and 32-bit IMEs to function properly (that is, to represent the two platform-specific DLLs as a single logical IME to the user), the following conditions must be met:</span></span>

-   <span data-ttu-id="7eb03-138">Разработчики должны создавать версии, относящиеся к платформе (одна для 32-разрядных Windows, а другая — для 64-разрядной версии Windows) библиотеки DLL IME.</span><span class="sxs-lookup"><span data-stu-id="7eb03-138">Developers must build platform-specific versions (one for 32-bit Windows and one for 64-bit Windows) of the IME DLL.</span></span>
-   <span data-ttu-id="7eb03-139">32-разрядная и 64-разрядные библиотеки DLL должны иметь одно и то же имя файла.</span><span class="sxs-lookup"><span data-stu-id="7eb03-139">The 32-bit and 64-bit DLLs must share the same file name.</span></span>
-   <span data-ttu-id="7eb03-140">Необходимо соблюдать требования к каталогу установки.</span><span class="sxs-lookup"><span data-stu-id="7eb03-140">Installation directory requirements must be followed.</span></span> <span data-ttu-id="7eb03-141">Дополнительные сведения см. в разделе Требования к каталогу установки.</span><span class="sxs-lookup"><span data-stu-id="7eb03-141">For more information, see Installation Directory Requirements.</span></span>

<span data-ttu-id="7eb03-142">Параллельная установка 32-разрядных и 64-разрядных DLL IME совместно используют один и тот же раздел реестра для хранения данных конфигурации (включая имя файла DLL):</span><span class="sxs-lookup"><span data-stu-id="7eb03-142">Side-by-side installations of 32-bit and 64-bit IME DLLs share the same registry key for storing configuration data (including the DLL file name):</span></span>


```C++
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts
```



<span data-ttu-id="7eb03-143">Для создания этого раздела реестра используется функция [**имминсталлиме**](/windows/desktop/api/imm/nf-imm-imminstallimea) .</span><span class="sxs-lookup"><span data-stu-id="7eb03-143">The [**ImmInstallIME**](/windows/desktop/api/imm/nf-imm-imminstallimea) function is used to create this registry key.</span></span> <span data-ttu-id="7eb03-144">Программа установки и установки IME должна вызывать эту функцию для регистрации IME в качестве поддерживаемой раскладки клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="7eb03-144">The setup and installation program for an IME must call this function to register the IME as a supported keyboard layout.</span></span> <span data-ttu-id="7eb03-145">Функция **имминсталлиме** должна вызываться только один раз: из 32-разрядной или 64-разрядной версии библиотеки DLL IME.</span><span class="sxs-lookup"><span data-stu-id="7eb03-145">The **ImmInstallIME** function should be called only once, either from the 32-bit or 64-bit version of the IME DLL.</span></span>

## <a name="mismatched-ime-dlls"></a><span data-ttu-id="7eb03-146">Несоответствие DLL-библиотек IME</span><span class="sxs-lookup"><span data-stu-id="7eb03-146">Mismatched IME DLLs</span></span>

<span data-ttu-id="7eb03-147">Установка только 32-разрядной версии IME в 64-bit Windows не рекомендуется и не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="7eb03-147">Installing only the 32-bit version of an IME on 64-bit Windows is neither recommended nor supported.</span></span> <span data-ttu-id="7eb03-148">Если 64-разрядное приложение пытается загрузить 32-разрядный редактор IME, редактор IME не будет автоматически работать, когда приложение попытается загрузить соответствующую раскладку клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="7eb03-148">If a 64-bit application attempts to load a 32-bit IME, the IME fails silently when the application attempts to load the associated keyboard layout.</span></span>

> [!IMPORTANT]
>
> <span data-ttu-id="7eb03-149">Не отображается диалоговое окно или сообщение предупреждения при возникновении 64-разрядного приложения/32-разрядного конфликта IME.</span><span class="sxs-lookup"><span data-stu-id="7eb03-149">No warning dialog or message displays when a 64-bit application/32-bit IME conflict error occurs.</span></span>

 

<span data-ttu-id="7eb03-150">64-разрядное замечание для текстовых служб</span><span class="sxs-lookup"><span data-stu-id="7eb03-150">64-Bit Considerations for Text Services</span></span>

<span data-ttu-id="7eb03-151">В этом разделе описаны особые соображения, связанные с созданием текстовых служб для использования в 64-разрядных средах.</span><span class="sxs-lookup"><span data-stu-id="7eb03-151">This section describes the special considerations involved with building text services for use in 64-bit environments.</span></span> <span data-ttu-id="7eb03-152">Дополнительные сведения о текстовых службах и платформе текстовых служб см. в разделе [Платформа текстовых служб](text-services-framework.md).</span><span class="sxs-lookup"><span data-stu-id="7eb03-152">For more information about text services and the Text Services Framework, see [Text Services Framework](text-services-framework.md).</span></span>

## <a name="building-32-bit-and-64-bit-text-services"></a><span data-ttu-id="7eb03-153">Создание 32-разрядных и 64-разрядных текстовых служб</span><span class="sxs-lookup"><span data-stu-id="7eb03-153">Building 32-Bit and 64-Bit Text Services</span></span>

<span data-ttu-id="7eb03-154">Текстовая служба реализуется как объект модели COM, предоставляемый в библиотеке DLL.</span><span class="sxs-lookup"><span data-stu-id="7eb03-154">A text service is implemented as a Component Object Model (COM) object exposed on a DLL.</span></span> <span data-ttu-id="7eb03-155">Следовательно, 32-разрядные или 64-разрядные конфликты DLL могут возникать при использовании текстовых служб, установленных в 64-разрядных Windows.</span><span class="sxs-lookup"><span data-stu-id="7eb03-155">Consequently, 32-bit/64-bit DLL conflicts can occur with text services installed on 64-bit Windows.</span></span> <span data-ttu-id="7eb03-156">Как и редакторы IME, рекомендуемое решение для обеспечения прозрачного функционирования службы текста с 32-и 64-разрядными приложениями на 64-разрядной платформе заключается в создании и установке параллельных 32-разрядных и 64-разрядных версий библиотеки DLL службы текстового ввода.</span><span class="sxs-lookup"><span data-stu-id="7eb03-156">Just as with IMEs, the recommended solution for enabling your text service to work transparently with both 32-bit and 64-bit applications on a 64-bit platform is to build and install parallel 32-bit and 64-bit versions of the text service DLL.</span></span>

## <a name="side-by-side-installation-of-64-bit-and-32-bit-text-services"></a><span data-ttu-id="7eb03-157">Параллельная установка 64-разрядных и 32-разрядных текстовых служб</span><span class="sxs-lookup"><span data-stu-id="7eb03-157">Side-by-Side Installation of 64-Bit and 32-Bit Text Services</span></span>

<span data-ttu-id="7eb03-158">Для 32-разрядной и 64-разрядной версии службы текстового ввода, которая должна быть установлена параллельно и представлена пользователю как единая логическая служба текстового ввода, должны выполняться следующие условия.</span><span class="sxs-lookup"><span data-stu-id="7eb03-158">For a 32-bit version and a 64-bit version of a text service to be installed side-by-side and represented to the user as a single, logical text service, the following conditions must be met:</span></span>

-   <span data-ttu-id="7eb03-159">Обе версии службы текстового ввода задают один и тот же идентификатор класса (CLSID) при регистрации в подсистеме COM.</span><span class="sxs-lookup"><span data-stu-id="7eb03-159">Both versions of the text service specify the same class identifier (CLSID) when they are registered with the COM subsystem.</span></span>
-   <span data-ttu-id="7eb03-160">Обе версии службы текстового ввода регистрируются независимо друг от друга.</span><span class="sxs-lookup"><span data-stu-id="7eb03-160">Both versions of the text service are registered independently.</span></span> <span data-ttu-id="7eb03-161">Дополнительные сведения см. в разделе [Регистрация приложений COM](/windows/desktop/com/registering-com-applications).</span><span class="sxs-lookup"><span data-stu-id="7eb03-161">For more information, see [Registering COM Applications](/windows/desktop/com/registering-com-applications).</span></span>

<span data-ttu-id="7eb03-162">Если 32-разрядная текстовая служба зарегистрирована в 64-разрядной версии Windows, операция регистрации прозрачно перенаправляется в следующий раздел реестра:</span><span class="sxs-lookup"><span data-stu-id="7eb03-162">When a 32-bit text service is registered with 64-bit Windows, the registration operation is transparently redirected to the following registry key:</span></span>


```C++
HKEY_CLASS_ROOT\Wow6432Node\CLSID
```



[<span data-ttu-id="7eb03-163">Перенаправитель реестра</span><span class="sxs-lookup"><span data-stu-id="7eb03-163">Registry Redirector</span></span>](/windows/desktop/WinProg64/registry-redirector)


```C++
HKEY_LOCAL_MACHINE\Software\Microsoft\CTF\TIP
```



<span data-ttu-id="7eb03-164">[](/windows/desktop/api/Msctf/nn-msctf-itfinputprocessorprofiles)[Регистрация службы текстового ввода](text-service-registration.md) итфинпутпроцессорпрофилес</span><span class="sxs-lookup"><span data-stu-id="7eb03-164">[ITfInputProcessorProfiles](/windows/desktop/api/Msctf/nn-msctf-itfinputprocessorprofiles)[Text Service Registration](text-service-registration.md)</span></span>

<span data-ttu-id="7eb03-165">64-разрядная и 32-разрядная версия службы текстового ввода может использоваться одновременно.</span><span class="sxs-lookup"><span data-stu-id="7eb03-165">The 64-bit version and the 32-bit version of a text service might be in use simultaneously.</span></span> <span data-ttu-id="7eb03-166">В случаях, когда обеим версиям службы текстового сервиса требуется работать с любыми общими объектами, координация для доступа к общим объектам должна разрабатываться в текстовой службе.</span><span class="sxs-lookup"><span data-stu-id="7eb03-166">In cases where both versions of a text service need to manipulate any shared objects, coordination for access shared objects should be designed into the text service.</span></span> <span data-ttu-id="7eb03-167">Каждая служба текстового ввода отвечает за управление любыми общими объектами, которые используются или необходимы.</span><span class="sxs-lookup"><span data-stu-id="7eb03-167">Each text service is responsible for managing any shared objects that are used or needed.</span></span>

## <a name="installing-only-32-bit-text-services-on-64-bit-windows"></a><span data-ttu-id="7eb03-168">Установка только 32-разрядных текстовых служб в 64-разрядной версии Windows</span><span class="sxs-lookup"><span data-stu-id="7eb03-168">Installing Only 32-Bit Text Services on 64-Bit Windows</span></span>

<span data-ttu-id="7eb03-169">Установка только 32-разрядной версии службы текстового ввода на 64-разрядной платформе Windows не рекомендуется и не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="7eb03-169">Installing only the 32-bit version of a text service on a 64-bit Windows platform is neither recommended nor supported.</span></span> <span data-ttu-id="7eb03-170">Из-за сопоставления регистрации, которое выполняется на 64-разрядных платформах Windows, 64-разрядное приложение может перечислить службы 32-bit Text Service через интерфейс **итфинпутпроцессорпрофилес** .</span><span class="sxs-lookup"><span data-stu-id="7eb03-170">Because of the registration mapping that is done on 64-bit Windows platforms, a 64-bit application can enumerate the services of a 32-bit Text Service through the **ITfInputProcessorProfiles** interface.</span></span> <span data-ttu-id="7eb03-171">Однако если 64-разрядное приложение пытается загрузить 32-разрядную текстовую службу, загрузка завершается неудачно.</span><span class="sxs-lookup"><span data-stu-id="7eb03-171">However, if a 64-bit application attempts to load a 32-bit text service, the load fails silently.</span></span>

> [!IMPORTANT]
>
> <span data-ttu-id="7eb03-172">При возникновении ошибки с конфликтом в 64-разрядном приложении или 32-разрядной службе текстового ввода не отображается предупреждение или диалоговое окно предупреждения.</span><span class="sxs-lookup"><span data-stu-id="7eb03-172">No warning dialog or message displays when a 64-bit application/32-bit text service conflict error occurs.</span></span>

 

<span data-ttu-id="7eb03-173">Другие вопросы</span><span class="sxs-lookup"><span data-stu-id="7eb03-173">Other Considerations</span></span>

## <a name="installation-directory-requirements"></a><span data-ttu-id="7eb03-174">Требования к каталогу установки</span><span class="sxs-lookup"><span data-stu-id="7eb03-174">Installation Directory Requirements</span></span>

<span data-ttu-id="7eb03-175">В этом разделе описываются требования к установке двоичных файлов IME и текстового файла.</span><span class="sxs-lookup"><span data-stu-id="7eb03-175">This section describes requirements for where to install IME and text service binary files.</span></span> <span data-ttu-id="7eb03-176">Если эти требования не соблюдаются, то Ваша текстовая служба или редактор IME могут работать неправильно.</span><span class="sxs-lookup"><span data-stu-id="7eb03-176">If these requirements are not followed, your text service or IME might not function correctly.</span></span>

<span data-ttu-id="7eb03-177">**Библиотеки DLL IME**</span><span class="sxs-lookup"><span data-stu-id="7eb03-177">**IME DLLs**</span></span>

<span data-ttu-id="7eb03-178">На 64-разрядных платформах Windows установите 32-разрядные и 64-разрядные библиотеки DLL IME в следующих каталогах:</span><span class="sxs-lookup"><span data-stu-id="7eb03-178">On 64-bit Windows platforms, install the 32-bit and 64-bit IME DLLs in the following directories:</span></span>

-   <span data-ttu-id="7eb03-179">Установите 32-разрядные библиотеки DLL IME в системном каталоге SysWOW64. чтобы получить этот путь к каталогу, вызовите [**GetSystemWow64Directory**](/windows/desktop/api/wow64apiset/nf-wow64apiset-getsystemwow64directorya)или [**шжетфолдерпас**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) с **CSid \_ SYSTEMX86** .</span><span class="sxs-lookup"><span data-stu-id="7eb03-179">Install 32-bit IME DLLs in the SysWOW64 system directory; call [**GetSystemWow64Directory**](/windows/desktop/api/wow64apiset/nf-wow64apiset-getsystemwow64directorya), or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with **CSIDL\_SYSTEMX86** to retrieve this directory path.</span></span> <span data-ttu-id="7eb03-180">Кроме того, если вы используете [установщик Windows](/windows/desktop/Msi/about-windows-installer), используйте свойство [**системфолдер**](/windows/desktop/Msi/systemfolder) .</span><span class="sxs-lookup"><span data-stu-id="7eb03-180">Alternately, if you are using [Windows Installer](/windows/desktop/Msi/about-windows-installer), use the [**SystemFolder**](/windows/desktop/Msi/systemfolder) property.</span></span>
-   <span data-ttu-id="7eb03-181">Установите 64-разрядные DLL IME в системном каталоге System32. Вызовите [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya)или **шжетфолдерпас** с [CSid \_ System](/windows/desktop/shell/csidl) , чтобы получить путь к каталогу.</span><span class="sxs-lookup"><span data-stu-id="7eb03-181">Install 64-bit IME DLLs in the System32 system directory; call [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya), or **SHGetFolderPath** with [CSIDL\_SYSTEM](/windows/desktop/shell/csidl) to retrieve this directory path.</span></span> <span data-ttu-id="7eb03-182">Для установщик Windows используйте свойство [**System64Folder**](/windows/desktop/Msi/system64folder) .</span><span class="sxs-lookup"><span data-stu-id="7eb03-182">Or, for Windows Installer, use the [**System64Folder**](/windows/desktop/Msi/system64folder) property.</span></span>

<span data-ttu-id="7eb03-183">**DLL-библиотеки текстовых служб и связанные двоичные файлы**</span><span class="sxs-lookup"><span data-stu-id="7eb03-183">**Text Service DLLs and Related Binary Files**</span></span>

<span data-ttu-id="7eb03-184">На 64-разрядных платформах Windows установите 32-и 64-bit текстовые библиотеки DLL, а также любые другие двоичные файлы, связанные с текстовой службой или IME, в следующих каталогах:</span><span class="sxs-lookup"><span data-stu-id="7eb03-184">On 64-bit Windows platforms, install the 32-bit and 64-bit text service DLLs, as well as any other binary files related to your text service or IME, in the following directories:</span></span>

-   <span data-ttu-id="7eb03-185">Установите 32-разрядные библиотеки текстовых файлов и другие 32-разрядные двоичные файлы в подкаталог в каталоге Program Files (x86). Вызовите **шжетфолдерпас** с **CSid \_ Program \_ FILESX86** , чтобы получить путь к каталогу.</span><span class="sxs-lookup"><span data-stu-id="7eb03-185">Install 32-bit text service DLLs and any other 32-bit binary files in a subdirectory in the Program Files (x86) directory; call **SHGetFolderPath** with **CSIDL\_PROGRAM\_FILESX86** to retrieve this directory path.</span></span> <span data-ttu-id="7eb03-186">Для установщик Windows используйте свойство [**ProgramFilesFolder**](/windows/desktop/Msi/programfilesfolder) .</span><span class="sxs-lookup"><span data-stu-id="7eb03-186">Or, for Windows Installer, use the [**ProgramFilesFolder**](/windows/desktop/Msi/programfilesfolder) property.</span></span>
-   <span data-ttu-id="7eb03-187">Установите 64-разрядные библиотеки текстовых файлов и другие 64-разрядные двоичные файлы в подкаталог в каталоге Program Files; Вызовите **шжетфолдерпас** с **\_ программными \_ файлами CSid** , чтобы получить путь к каталогу.</span><span class="sxs-lookup"><span data-stu-id="7eb03-187">Install 64-bit text service DLLs and any other 64-bit binary files in a subdirectory under the Program Files directory; call **SHGetFolderPath** with **CSIDL\_PROGRAM\_FILES** to retrieve this directory path.</span></span> <span data-ttu-id="7eb03-188">Для установщик Windows используйте свойство [**ProgramFiles64Folder**](/windows/desktop/Msi/programfiles64folder) .</span><span class="sxs-lookup"><span data-stu-id="7eb03-188">Or, for Windows Installer, use the [**ProgramFiles64Folder**](/windows/desktop/Msi/programfiles64folder) property.</span></span>

<span data-ttu-id="7eb03-189">Если вы не используете пакет установщик Windows для установки текстового редактора IME или Text, настоятельно рекомендуется, что вы используете приложение для установки 64-разрядной версии.</span><span class="sxs-lookup"><span data-stu-id="7eb03-189">If you are not using a Windows Installer package to install your IME or text service, it is strongly recommnded that you use a 64-bit installation application.</span></span> <span data-ttu-id="7eb03-190">Перенаправитель файловой системы WOW64 может привести к тому, что 32-разрядные установщики помещают файлы в неправильные каталоги (например, перенаправление файловой системы WOW64 может привести к тому, что файлы, предназначенные для каталога System32, будут установлены в каталог SysWOW64).</span><span class="sxs-lookup"><span data-stu-id="7eb03-190">The WOW64 file system redirector might cause 32-bit installers to place files in the wrong directories (for example, WOW64 file system redirection might cause files intended for the System32 directory to be installed in the SysWOW64 directory instead).</span></span> <span data-ttu-id="7eb03-191">Если необходимо использовать 32-разрядный установщик, отключите перенаправление файлов WOW64 во время процесса установки, чтобы служба перенаправления файлов не вызывала непреднамеренного перенаправления во время процесса установки.</span><span class="sxs-lookup"><span data-stu-id="7eb03-191">If you must use a 32-bit installer, disable WOW64 file redirection during the installation process to ensure that the file-redirector service does not cause any unintended redirection during the installation process.</span></span> <span data-ttu-id="7eb03-192">Сведения о перенаправлении файловой системы WOW64 см. в разделе [перенаправитель файловой системы](/windows/desktop/WinProg64/file-system-redirector).</span><span class="sxs-lookup"><span data-stu-id="7eb03-192">For information about the WOW64 file system redirector, see [File System Redirector](/windows/desktop/WinProg64/file-system-redirector).</span></span> <span data-ttu-id="7eb03-193">Сведения о том, как отключить или включить перенаправление файловой системы WOW64, см. в разделе [**Wow64EnableWow64FsRedirection**](/windows/desktop/api/winbase/nf-winbase-wow64enablewow64fsredirection).</span><span class="sxs-lookup"><span data-stu-id="7eb03-193">For information about how to disable or enable WOW64 file system redirection, see [**Wow64EnableWow64FsRedirection**](/windows/desktop/api/winbase/nf-winbase-wow64enablewow64fsredirection).</span></span>

> [!TIP]
>
> <span data-ttu-id="7eb03-194">Избегайте жестко запрограммированных путей установки.</span><span class="sxs-lookup"><span data-stu-id="7eb03-194">Avoid hard-coded installation paths.</span></span> <span data-ttu-id="7eb03-195">Дополнительные сведения см. [в разделе Поиск каталогов с помощью интерфейса программирования приложений, не Hard-Coded путей](/previous-versions//ms675638(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="7eb03-195">For more information, see [Locate Directories Using the Application Programming Interface Not Hard-Coded Paths](/previous-versions//ms675638(v=vs.85))</span></span>

 

> [!IMPORTANT]
>
> <span data-ttu-id="7eb03-196">Не устанавливайте файлы IME или Text Service в специальный каталог% WINDIR% \\ IME (по умолчанию, c: \\ Windows \\ IME).</span><span class="sxs-lookup"><span data-stu-id="7eb03-196">Do not install any IME or text service files in the special directory %WINDIR%\\IME (by default, c:\\Windows\\IME ).</span></span> <span data-ttu-id="7eb03-197">Этот каталог содержит системные файлы, поддерживающие текстовые службы и редакторы IME; Он не должен содержать какие-либо сторонние файлы IME или текстовые службы, а перенаправление файловой системы WOW64 для этого каталога не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="7eb03-197">This directory contains system files that support text services and IMEs; it is not intended to contain any third-party IME or text service files, and WOW64 file system redirection is not supported for this directory.</span></span>

 

## <a name="dual-ctfmonexe-processes-run-on-64-bit-windows-platforms"></a><span data-ttu-id="7eb03-198">Два Ctfmon.exeных процесса работают на 64-разрядных платформах Windows</span><span class="sxs-lookup"><span data-stu-id="7eb03-198">Dual Ctfmon.exe Processes Run on 64-Bit Windows Platforms</span></span>

<span data-ttu-id="7eb03-199">ctfmon.exe процесс управляет платформой текстовых служб на рабочем столе, а также предоставляет пользовательский интерфейс языковой панели.</span><span class="sxs-lookup"><span data-stu-id="7eb03-199">The ctfmon.exe process manages the Text Services Framework on the desktop and also provides the language bar user interface (UI).</span></span> <span data-ttu-id="7eb03-200">В 64-разрядной версии Windows одновременно выполняется 32-разрядная и 64-разрядная версия ctfmon.exe процесса.</span><span class="sxs-lookup"><span data-stu-id="7eb03-200">On 64-bit Windows, a 32-bit version and a 64-bit version of the ctfmon.exe process run simultaneously.</span></span> <span data-ttu-id="7eb03-201">64-разрядный процесс ctfmon.exe управляет 64-разрядными текстовыми службами, и, аналогичным образом, 32-разрядный ctfmon.exe процесс управляет 32-разрядными текстовыми службами.</span><span class="sxs-lookup"><span data-stu-id="7eb03-201">The 64-bit ctfmon.exe process manages 64-bit text services, and, likewise, the 32-bit ctfmon.exe process manages 32-bit text services.</span></span>

## <a name="display-behavior-for-different-versions-of-the-language-bar-ui"></a><span data-ttu-id="7eb03-202">Поведение при отображении для разных версий пользовательского интерфейса языковой панели</span><span class="sxs-lookup"><span data-stu-id="7eb03-202">Display Behavior for Different Versions of the Language Bar UI</span></span>

<span data-ttu-id="7eb03-203">В 64-разрядной системе Windows отображается только пользовательский интерфейс языковой панели, связанный с 64-разрядной версией службы текстового ввода.</span><span class="sxs-lookup"><span data-stu-id="7eb03-203">On 64-bit Windows, only the language bar UI associated with the 64-bit version of a text service is ever shown.</span></span> <span data-ttu-id="7eb03-204">В случаях, когда 32-разрядное приложение использует 32-разрядную версию службы текстового ввода, 64-bit Windows автоматически вставляет пользовательский интерфейс языковой панели для эквивалентной функции 64-bit Text Service.</span><span class="sxs-lookup"><span data-stu-id="7eb03-204">In cases where a 32-bit application is using the 32-bit version of a text service, 64-bit Windows automatically inserts the language bar UI for the equivalent 64-bit text service.</span></span> <span data-ttu-id="7eb03-205">Это гарантирует, что для появления 32-разрядных текстовых служб не требуется никаких специальных операций в 64-разрядной версии языковой панели.</span><span class="sxs-lookup"><span data-stu-id="7eb03-205">This ensures that no special work is required for 32-bit text services to appear in the 64-bit version of the language bar.</span></span>

## <a name="control-panel-considerations-on-64-bit-windows"></a><span data-ttu-id="7eb03-206">Рекомендации по панели управления в 64-разрядной версии Windows</span><span class="sxs-lookup"><span data-stu-id="7eb03-206">Control Panel Considerations on 64-Bit Windows</span></span>

<span data-ttu-id="7eb03-207">64-bit Windows предоставляет доступ к 32-и 64-разрядным версиям текстовых служб и редакторов IME с помощью панели управления.</span><span class="sxs-lookup"><span data-stu-id="7eb03-207">64-bit Windows provides access to both 32-bit and 64-bit versions of text services and IMEs through the Control Panel.</span></span> <span data-ttu-id="7eb03-208">Чтобы получить доступ к параметрам панели управления для конкретных версий текстовых служб или редакторов IME, просмотрите следующие расположения.</span><span class="sxs-lookup"><span data-stu-id="7eb03-208">To access Control Panel settings for specific versions of text services or IMEs, look in the following locations.</span></span>

-   <span data-ttu-id="7eb03-209">**Доступ к панели управления для 32-разрядных текстовых служб и редакторов IME:** Пуск-> параметры — > панель управления — > View x86 значки панели управления</span><span class="sxs-lookup"><span data-stu-id="7eb03-209">**Control Panel access for 32-bit Text Services and IMEs:** Start -> Settings -> Control Panel -> View x86 Control Panel Icons</span></span>
-   <span data-ttu-id="7eb03-210">**Доступ к панели управления для 64-разрядных текстовых служб и редакторов IME:** Параметры Пуск->-> панель управления — > язык и региональные стандарты</span><span class="sxs-lookup"><span data-stu-id="7eb03-210">**Control Panel access for 64-bit Text Services and IMEs:** Start -> Settings -> Control Panel -> Regional and Language Options</span></span>

<span data-ttu-id="7eb03-211">Могут возникнуть обстоятельства, в которых некоторые параметры могут быть доступны только через 32-разрядную панель управления.</span><span class="sxs-lookup"><span data-stu-id="7eb03-211">There may be circumstances where some settings might be available only through the 32-bit Control Panel.</span></span> <span data-ttu-id="7eb03-212">В этих случаях следует убедиться, что пользователи службы текстового ввода или IME знают об этом, предоставляя соответствующую документацию или предлагая подсказки пользовательского интерфейса в интерфейсе 64-разрядных параметров.</span><span class="sxs-lookup"><span data-stu-id="7eb03-212">In these cases, be sure that users of your text service or IME are aware of this, by providing appropriate documentation or offering UI hints in your 64-bit settings interface.</span></span>

 

 