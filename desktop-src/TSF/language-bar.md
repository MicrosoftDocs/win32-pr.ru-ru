---
title: Языковая панель (текстовые службы)
description: Языковая панель
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Платформа текстовых служб (TSF), языковая панель
- TSF (платформа текстовых служб), языковая панель
- текстовые службы, языковая панель
- Языковая панель
- Платформа текстовых служб (TSF), кнопки
- TSF (платформа текстовых служб), кнопки
- текстовые службы, кнопки
- Платформа текстовых служб (TSF), меню
- TSF (платформа текстовых служб), меню
- текстовые службы, меню
- стили кнопок
- кнопки меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c41d64a488406f6eefcff5fef6c11093af00bc5b
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104414628"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="27450-115">Языковая панель (текстовые службы)</span><span class="sxs-lookup"><span data-stu-id="27450-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="27450-116">Реализация объекта языковой панели</span><span class="sxs-lookup"><span data-stu-id="27450-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="27450-117">Для поддержки добавления элемента на языковую панель служба текстового интерфейса должна реализовать объект, который поддерживает интерфейс [итфсаурце](/windows/desktop/api/msctf/nn-msctf-itfsource) и один из элементов управления [итфлангбаритем](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) .</span><span class="sxs-lookup"><span data-stu-id="27450-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="27450-118">При установке элемента языковая панель устанавливает приемник [итфлангбаритемсинк](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) , вызывая [Итфсаурце:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) элемента с идентификатором IID \_ итфлангбаритемсинк.</span><span class="sxs-lookup"><span data-stu-id="27450-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="27450-119">Элемент использует интерфейс **итфлангбаритемсинк** для уведомления языковой панели изменений, например, когда элемент скрыт, показан, включен или отключен.</span><span class="sxs-lookup"><span data-stu-id="27450-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="27450-120">Можно установить четыре типа элементов языковой панели, и каждый из необходимых интерфейсов создается из **итфлангбаритем**.</span><span class="sxs-lookup"><span data-stu-id="27450-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="27450-121">Ниже перечислены возможные элементы управления **итфлангбаритем** .</span><span class="sxs-lookup"><span data-stu-id="27450-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|               |                                                                                                                                                                                   |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="27450-122">Кнопка</span><span class="sxs-lookup"><span data-stu-id="27450-122">Button</span></span>        | <span data-ttu-id="27450-123">Кнопка языковой панели выступает в качестве кнопки, переключателя или меню на языковой панели.</span><span class="sxs-lookup"><span data-stu-id="27450-123">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="27450-124">Объект должен поддерживать интерфейс Итфлангбаритембуттон.</span><span class="sxs-lookup"><span data-stu-id="27450-124">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="27450-125">Появится</span><span class="sxs-lookup"><span data-stu-id="27450-125">Balloon</span></span>       | <span data-ttu-id="27450-126">Всплывающее окно языковой панели выступает в качестве всплывающего уведомления на языковой панели.</span><span class="sxs-lookup"><span data-stu-id="27450-126">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="27450-127">Объект должен поддерживать интерфейс Итфлангбаритембаллун.</span><span class="sxs-lookup"><span data-stu-id="27450-127">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="27450-128">Bitmap</span><span class="sxs-lookup"><span data-stu-id="27450-128">Bitmap</span></span>        | <span data-ttu-id="27450-129">Точечный рисунок языковой панели выступает в качестве статического элемента на языковой панели, которая отображает точечный рисунок.</span><span class="sxs-lookup"><span data-stu-id="27450-129">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="27450-130">Объект должен поддерживать интерфейс Итфлангбаритембитмап.</span><span class="sxs-lookup"><span data-stu-id="27450-130">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="27450-131">Кнопка точечного рисунка</span><span class="sxs-lookup"><span data-stu-id="27450-131">Bitmap Button</span></span> | <span data-ttu-id="27450-132">Кнопка точечного рисунка языковой панели функционирует как элемент кнопки на языковой панели, которая отображает текст и точечный рисунок.</span><span class="sxs-lookup"><span data-stu-id="27450-132">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="27450-133">Объект должен поддерживать интерфейс Итфлангбаритембитмапбуттон.</span><span class="sxs-lookup"><span data-stu-id="27450-133">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="27450-134">Стили кнопок</span><span class="sxs-lookup"><span data-stu-id="27450-134">Button Styles</span></span>

<span data-ttu-id="27450-135">Элемент Button может работать как любой из следующих элементов.</span><span class="sxs-lookup"><span data-stu-id="27450-135">A button element can function as any of the following.</span></span> <span data-ttu-id="27450-136">Функция элемента Button определяется флагами, заданными в элементе **двстиле** структуры [tf \_ Лангбаритеминфо](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) в методе [итфлангбаритем::-info](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) .</span><span class="sxs-lookup"><span data-stu-id="27450-136">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|               |                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="27450-137">Кнопка</span><span class="sxs-lookup"><span data-stu-id="27450-137">Button</span></span>        | <span data-ttu-id="27450-138">Кнопка работает как стандартная Командная кнопка.</span><span class="sxs-lookup"><span data-stu-id="27450-138">The button functions as a standard command button.</span></span> <span data-ttu-id="27450-139">Этот стиль кнопки определяется \_ \_ стилем кнопки TF ЛБИ Style \_ БТН \_ .</span><span class="sxs-lookup"><span data-stu-id="27450-139">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="27450-140">Итфлангбаритембуттон:: OnClick вызывается при щелчке элемента.</span><span class="sxs-lookup"><span data-stu-id="27450-140">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="27450-141">Итфлангбаритембуттон:: Инитмену и Итфлангбаритембуттон:: Онменуселект не используются.</span><span class="sxs-lookup"><span data-stu-id="27450-141">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="27450-142">Выключатель</span><span class="sxs-lookup"><span data-stu-id="27450-142">Toggle Button</span></span> | <span data-ttu-id="27450-143">Кнопка выступает в качестве элемента управления "переключатель", который может поддерживать выбранное состояние, аналогично флажку.</span><span class="sxs-lookup"><span data-stu-id="27450-143">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="27450-144">Этот стиль кнопки определяется \_ \_ \_ \_ стилем переключателя TF ЛБИ Style БТН.</span><span class="sxs-lookup"><span data-stu-id="27450-144">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="27450-145">Итфлангбаритембуттон:: OnClick вызывается при щелчке элемента.</span><span class="sxs-lookup"><span data-stu-id="27450-145">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="27450-146">Итфлангбаритембуттон:: Инитмену и Итфлангбаритембуттон:: Онменуселект не используются.</span><span class="sxs-lookup"><span data-stu-id="27450-146">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="27450-147">Меню</span><span class="sxs-lookup"><span data-stu-id="27450-147">Menu</span></span>          | <span data-ttu-id="27450-148">Кнопка выступает в качестве раскрывающегося меню.</span><span class="sxs-lookup"><span data-stu-id="27450-148">The button functions as a drop-down menu.</span></span> <span data-ttu-id="27450-149">Этот стиль кнопки определяется \_ \_ стилем меню TF ЛБИ Style \_ БТН \_ .</span><span class="sxs-lookup"><span data-stu-id="27450-149">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="27450-150">Итфлангбаритембуттон:: Инитмену вызывается при нажатии кнопки.</span><span class="sxs-lookup"><span data-stu-id="27450-150">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="27450-151">Когда пользователь выбирает элемент в меню, языковая панель вызывает Итфлангбаритембуттон:: Онменуселект с идентификатором выбранного пункта меню.</span><span class="sxs-lookup"><span data-stu-id="27450-151">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="27450-152">Итфлангбаритембуттон:: OnClick не используется.</span><span class="sxs-lookup"><span data-stu-id="27450-152">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="27450-153">Реализация кнопки меню</span><span class="sxs-lookup"><span data-stu-id="27450-153">Implementing a Menu Button</span></span>

<span data-ttu-id="27450-154">Когда пользователь нажимает кнопку меню, языковая панель вызывает [итфлангбаритембуттон:: инитмену](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="27450-154">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="27450-155">Элемент добавляет элементы в меню с помощью интерфейса [итфмену](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) , переданного в инитмену.</span><span class="sxs-lookup"><span data-stu-id="27450-155">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="27450-156">Чтобы добавить подменю в меню, вызовите [итфмену:: аддменуитем](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) с \_ \_ подменю TF лбменуф.</span><span class="sxs-lookup"><span data-stu-id="27450-156">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="27450-157">Когда это будет сделано, новый объект **итфмену** , представляющий подменю, возвращается в параметре *ппмену* объекта аддменуитем.</span><span class="sxs-lookup"><span data-stu-id="27450-157">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="27450-158">Этот новый объект меню используется для добавления элементов в подменю.</span><span class="sxs-lookup"><span data-stu-id="27450-158">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="27450-159">Когда пользователь выбирает элемент в меню, языковая панель вызывает [итфлангбаритембуттон:: онменуселект](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) с идентификатором выбранного пункта меню.</span><span class="sxs-lookup"><span data-stu-id="27450-159">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="27450-160">Добавление элементов на языковую панель</span><span class="sxs-lookup"><span data-stu-id="27450-160">Adding Items to the Language Bar</span></span>

<span data-ttu-id="27450-161">Текстовая служба должна добавлять свои элементы на языковую панель при вызове метода [итфтекстинпутпроцессор:: Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) и удалять их при вызове [итфтекстинпутпроцессор::D еактивате](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) .</span><span class="sxs-lookup"><span data-stu-id="27450-161">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="27450-162">Чтобы добавить элемент на языковую панель, служба текстового интерфейса получает интерфейс [итфлангбаритеммгр](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) , вызывая ITfThreadMgr:: QUERYINTERFACE с IID \_ итфлангбаритеммгр.</span><span class="sxs-lookup"><span data-stu-id="27450-162">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="27450-163">Затем служба Text вызывает [итфлангбаритеммгр:: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) с указателем на объект элемента языковой панели.</span><span class="sxs-lookup"><span data-stu-id="27450-163">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="27450-164">Служба текстового ввода должна удалить элемент при деактивации.</span><span class="sxs-lookup"><span data-stu-id="27450-164">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="27450-165">В текстовой службе используется тот же интерфейс **итфлангбаритеммгр** , который используется для добавления элементов или получения другого экземпляра интерфейса.</span><span class="sxs-lookup"><span data-stu-id="27450-165">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="27450-166">Затем служба текста вызывает [итфлангбаритеммгр:: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) с указателем интерфейса удаляемого элемента.</span><span class="sxs-lookup"><span data-stu-id="27450-166">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="27450-167">Расширение системных элементов языковой панели</span><span class="sxs-lookup"><span data-stu-id="27450-167">Extending System Language Bar Items</span></span>

<span data-ttu-id="27450-168">TSF предоставляет возможность добавлять пункты меню в существующие меню языковой панели.</span><span class="sxs-lookup"><span data-stu-id="27450-168">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="27450-169">Это позволяет текстовой службе добавлять элементы в меню другой службы текстового ввода, не добавляя на панель инструментов отдельную кнопку.</span><span class="sxs-lookup"><span data-stu-id="27450-169">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="27450-170">Это также позволяет объединить пункты меню в логические группы.</span><span class="sxs-lookup"><span data-stu-id="27450-170">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="27450-171">Например, служба текстового ввода, предоставляющая дополнительные функции для стандартной службы речевого текста, может добавлять элементы в меню службы речевого текста, а не добавлять собственные кнопки меню верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="27450-171">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="27450-172">Служба текстового ввода предоставляет расширение меню языковой панели, реализуя объект, поддерживающий интерфейс [итфсистемлангбаритемсинк](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) .</span><span class="sxs-lookup"><span data-stu-id="27450-172">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="27450-173">Этот интерфейс работает точно так же, как интерфейс [итфлангбаритембуттон](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) для кнопки меню.</span><span class="sxs-lookup"><span data-stu-id="27450-173">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="27450-174">При отображении меню служба текстового ввода вызывает [итфсистемлангбаритемсинк:: инитмену](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="27450-174">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="27450-175">Расширение добавляет элементы в меню с помощью интерфейса [итфмену](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) , переданного в **инитмену**.</span><span class="sxs-lookup"><span data-stu-id="27450-175">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="27450-176">Когда пользователь выбирает элемент, добавленный расширением, служба текстового ввода вызывает [итфсистемлангбаритемсинк:: онменуселект](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) с идентификатором выбранного пункта меню.</span><span class="sxs-lookup"><span data-stu-id="27450-176">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="27450-177">Чтобы установить расширение меню языковой панели, служба Text выполняет следующие действия.</span><span class="sxs-lookup"><span data-stu-id="27450-177">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="27450-178">Получите интерфейс **итфлангбаритем** для элемента, который необходимо расширить, вызвав [итфлангбаритеммгр::-Item](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) с **идентификатором GUID** для расширяемого элемента.</span><span class="sxs-lookup"><span data-stu-id="27450-178">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="27450-179">Получите интерфейс **итфсаурце** для элемента, который необходимо расширить, вызвав итфлангбаритем:: QUERYINTERFACE с IID \_ итфсаурце.</span><span class="sxs-lookup"><span data-stu-id="27450-179">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="27450-180">Вызовите [итфсаурце:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) с IID \_ итфсистемлангбаритемсинк и указателем на объект **итфсистемлангбаритемсинк** .</span><span class="sxs-lookup"><span data-stu-id="27450-180">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="27450-181">Если происходит сбой Итфсаурце:: AdviseSink, служба текстового ввода не поддерживает расширения меню.</span><span class="sxs-lookup"><span data-stu-id="27450-181">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="27450-182">[Итфсаурце:: унадвисесинк](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**Итфсаурце:: AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="27450-182">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="27450-183">Поддержка расширений меню языковой панели</span><span class="sxs-lookup"><span data-stu-id="27450-183">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="27450-184">Служба текстового ввода может включать другие текстовые службы для добавления элементов в меню языковой панели, как показано выше.</span><span class="sxs-lookup"><span data-stu-id="27450-184">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="27450-185">Служба текстового ввода, которая должна опубликовать свой GUID, чтобы элемент можно было получить путем вызова [итфлангбаритеммгр::](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem)GetText.</span><span class="sxs-lookup"><span data-stu-id="27450-185">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="27450-186">Для поддержки расширений меню текстовая служба должна поддерживать интерфейс [итфсаурце](/windows/desktop/api/msctf/nn-msctf-itfsource) .</span><span class="sxs-lookup"><span data-stu-id="27450-186">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="27450-187">Следующие шаги включают поддержку одного или нескольких расширений меню.</span><span class="sxs-lookup"><span data-stu-id="27450-187">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="27450-188">При вызове [итфсаурце:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) с IID \_ итфсистемлангбаритемсинк служба текстового интерфейса должна хранить интерфейс **итфсистемлангбаритемсинк** и возвращать значение файла cookie, которое определяет расширение.</span><span class="sxs-lookup"><span data-stu-id="27450-188">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="27450-189">При вызове [итфлангбаритембуттон:: инитмену](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) текстовая служба вызывает метод [Итфсистемлангбаритемсинк:: инитмену](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) расширения.</span><span class="sxs-lookup"><span data-stu-id="27450-189">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="27450-190">Служба текстового ввода должна реализовать способ идентификации элементов меню, добавленных расширением, в отличие от элементов, добавленных самой службой текстового ввода.</span><span class="sxs-lookup"><span data-stu-id="27450-190">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="27450-191">При вызове [итфлангбаритембуттон:: онменуселект](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) с идентификатором пункта меню, который принадлежит к расширению, Текстовая служба вызывает метод **Итфсистемлангбаритемсинк:: онменуселект** расширения.</span><span class="sxs-lookup"><span data-stu-id="27450-191">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="27450-192">При вызове [итфсаурце:: унадвисесинк](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) с соответствующим файлом cookie служба текстового ввода удаляет расширение меню.</span><span class="sxs-lookup"><span data-stu-id="27450-192">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="27450-193">См. также</span><span class="sxs-lookup"><span data-stu-id="27450-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="27450-194">Как настроить платформу текстовых служб</span><span class="sxs-lookup"><span data-stu-id="27450-194">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="27450-195">Языковая панель (приложения)</span><span class="sxs-lookup"><span data-stu-id="27450-195">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
