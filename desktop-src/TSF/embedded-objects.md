---
title: Внедренные объекты (платформа текстовых служб)
description: Платформа текстовых служб позволяет текстовой службе внедрять объекты в поток текста приложения.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:
- Платформа текстовых служб (TSF), внедренные объекты
- TSF (платформа текстовых служб), внедренные объекты
- Приложения с поддержкой TSF, внедренные объекты
- внедренные объекты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3c45c14138df39142f503882c8d735ff1638618e028870af6aa67c25bc1a98b1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118879686"
---
# <a name="embedded-objects-text-services-framework"></a>Внедренные объекты (платформа текстовых служб)

Платформа текстовых служб позволяет текстовой службе внедрять объекты в поток текста приложения. Внедренные объекты вставляются в текстовый поток с использованием значения [TS \_ char \_ Embedded](ts-char--constants.md). Это значение разрешается в символ замены объекта Юникода U + фффк, используя шестнадцатеричную нотацию. Например, на следующем рисунке показана визуализация внедренного объекта, представляющего японские иероглифы *Hi* в сочетании с последовательностью символов Юникода, представляющих перевод на английский язык «Sun».

![Символьная кодировка внедренного объекта](images/emb-obj.gif)

В верхней строке рисунка содержится переведенный текст, состоящий из слова «Sun», за которым следует символ японского символа для Sun, *Привет*. В центральной строке рисунка показан символ Юникода. В случае с U + фффк это символ замены объекта. В нижней строке рисунка показано шестнадцатеричное значение каждого символа.

## <a name="supporting-embedded-objects-in-an-application"></a>Поддержка внедренных объектов в приложении

Диспетчер TSF вставляет внедренный объект в текстовый поток путем вызова [ITextStoreACP:: инсертембеддед](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) для приложения на основе ACP или [Итекстстореанчор:: инсертембеддед](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) для приложения на основе привязки. При вставке внедренного объекта приложение должно поместить **\_ \_ внедренное значение TS char** в позицию символа (или место привязки), где объект внедряется, и сохранить IDataObject, связанный с внедренным объектом. Если вызывается [ITextStoreACP:: GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) или [Итекстстореанчор:: GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) и внедренный объект содержится в полученном тексте, то **\_ \_ внедренное значение TS char** указывает на присутствие и расположение внедренного объекта. Чтобы получить внедренный объект, вызовите [ITextStoreACP::](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) GetObject с позицией символа внедренного объекта или [итекстстореанчор::](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) GetObject с положением привязки внедренного объекта.

Приложение обычно не распознает содержимое внедренного объекта. Приложение может попытаться получить отображаемую информацию из самого объекта. Если внедренный объект может предоставлять данные в формате, распознаваемым приложением, например CF \_ уникодетекст или CF \_ Bitmap, приложение может отображать графические данные, предоставленные объектом.

## <a name="inserting-embedded-objects"></a>Вставка внедренных объектов

Служба текстового ввода вставляет внедренный объект в контекст, вызывая [итфранже:: инсертембеддед](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) или [Итфинсертатселектион:: инсертембеддедатселектион](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection). Служба текстового ввода должна предоставить встроенный IDataObject.

 

 
