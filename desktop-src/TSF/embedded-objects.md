---
title: Внедренные объекты (платформа текстовых служб)
description: Платформа текстовых служб позволяет текстовой службе внедрять объекты в поток текста приложения.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:
- Платформа текстовых служб (TSF), внедренные объекты
- TSF (платформа текстовых служб), внедренные объекты
- Приложения с поддержкой TSF, внедренные объекты
- внедренные объекты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39e4f819e6f42cc4e8d2ed81e47c79efe5ff7407
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104560877"
---
# <a name="embedded-objects-text-services-framework"></a><span data-ttu-id="15917-107">Внедренные объекты (платформа текстовых служб)</span><span class="sxs-lookup"><span data-stu-id="15917-107">Embedded Objects (Text Services Framework)</span></span>

<span data-ttu-id="15917-108">Платформа текстовых служб позволяет текстовой службе внедрять объекты в поток текста приложения.</span><span class="sxs-lookup"><span data-stu-id="15917-108">Text Services Framework enables a text service to embed objects in an application text stream.</span></span> <span data-ttu-id="15917-109">Внедренные объекты вставляются в текстовый поток с использованием значения [TS \_ char \_ Embedded](ts-char--constants.md).</span><span class="sxs-lookup"><span data-stu-id="15917-109">Embedded objects are inserted into the text stream using the value [TS\_CHAR\_EMBEDDED](ts-char--constants.md).</span></span> <span data-ttu-id="15917-110">Это значение разрешается в символ замены объекта Юникода U + фффк, используя шестнадцатеричную нотацию.</span><span class="sxs-lookup"><span data-stu-id="15917-110">This value resolves to the Unicode object replacement character U+fffc, using hexadecimal notation.</span></span> <span data-ttu-id="15917-111">Например, на следующем рисунке показана визуализация внедренного объекта, представляющего японские иероглифы *Hi* в сочетании с последовательностью символов Юникода, представляющих перевод на английский язык «Sun».</span><span class="sxs-lookup"><span data-stu-id="15917-111">For example, the following illustration shows the rendering of an embedded object that represents the Japanese ideograph *hi*, in combination with the sequence of Unicode characters that represent the English translation of "Sun."</span></span>

![Символьная кодировка внедренного объекта](images/emb-obj.gif)

<span data-ttu-id="15917-113">В верхней строке рисунка содержится переведенный текст, состоящий из слова «Sun», за которым следует символ японского символа для Sun, *Привет*.</span><span class="sxs-lookup"><span data-stu-id="15917-113">The top row of the figure contains the translated text, consisting of the word "Sun" followed by the Japanese character for sun, *hi*.</span></span> <span data-ttu-id="15917-114">В центральной строке рисунка показан символ Юникода.</span><span class="sxs-lookup"><span data-stu-id="15917-114">The center row of the figure shows the Unicode character.</span></span> <span data-ttu-id="15917-115">В случае с U + фффк это символ замены объекта.</span><span class="sxs-lookup"><span data-stu-id="15917-115">In the case of U+fffc, this is the object replacement character.</span></span> <span data-ttu-id="15917-116">В нижней строке рисунка показано шестнадцатеричное значение каждого символа.</span><span class="sxs-lookup"><span data-stu-id="15917-116">The bottom row of the figure shows the hexadecimal value of each character.</span></span>

## <a name="supporting-embedded-objects-in-an-application"></a><span data-ttu-id="15917-117">Поддержка внедренных объектов в приложении</span><span class="sxs-lookup"><span data-stu-id="15917-117">Supporting Embedded Objects in an Application</span></span>

<span data-ttu-id="15917-118">Диспетчер TSF вставляет внедренный объект в текстовый поток путем вызова [ITextStoreACP:: инсертембеддед](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) для приложения на основе ACP или [Итекстстореанчор:: инсертембеддед](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) для приложения на основе привязки.</span><span class="sxs-lookup"><span data-stu-id="15917-118">The TSF manager inserts an embedded object into the text stream by calling [ITextStoreACP::InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) for an ACP-based application, or [ITextStoreAnchor::InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) for an anchor-based application.</span></span> <span data-ttu-id="15917-119">При вставке внедренного объекта приложение должно поместить **\_ \_ внедренное значение TS char** в позицию символа (или место привязки), где объект внедряется, и сохранить IDataObject, связанный с внедренным объектом.</span><span class="sxs-lookup"><span data-stu-id="15917-119">When an embedded object is inserted, the application should place the **TS\_CHAR\_EMBEDDED** value at the character position (or anchor location) where the object is embedded and store the IDataObject associated with the embedded object.</span></span> <span data-ttu-id="15917-120">Если вызывается [ITextStoreACP:: GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) или [Итекстстореанчор:: GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) и внедренный объект содержится в полученном тексте, то **\_ \_ внедренное значение TS char** указывает на присутствие и расположение внедренного объекта.</span><span class="sxs-lookup"><span data-stu-id="15917-120">When [ITextStoreACP::GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) or [ITextStoreAnchor::GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) is called and an embedded object is contained within the text obtained, the **TS\_CHAR\_EMBEDDED** value indicates the presence and location of the embedded object.</span></span> <span data-ttu-id="15917-121">Чтобы получить внедренный объект, вызовите [ITextStoreACP::](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) GetObject с позицией символа внедренного объекта или [итекстстореанчор::](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) GetObject с положением привязки внедренного объекта.</span><span class="sxs-lookup"><span data-stu-id="15917-121">To obtain the embedded object, call [ITextStoreACP::GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) with the character position of the embedded object, or [ITextStoreAnchor::GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) with the anchor location of the embedded object.</span></span>

<span data-ttu-id="15917-122">Приложение обычно не распознает содержимое внедренного объекта.</span><span class="sxs-lookup"><span data-stu-id="15917-122">The application does not normally recognize the embedded object contents.</span></span> <span data-ttu-id="15917-123">Приложение может попытаться получить отображаемую информацию из самого объекта.</span><span class="sxs-lookup"><span data-stu-id="15917-123">The application can attempt to obtain display information from the object itself.</span></span> <span data-ttu-id="15917-124">Если внедренный объект может предоставлять данные в формате, распознаваемым приложением, например CF \_ уникодетекст или CF \_ Bitmap, приложение может отображать графические данные, предоставленные объектом.</span><span class="sxs-lookup"><span data-stu-id="15917-124">If the embedded object can supply data in a format that the application recognizes, such as CF\_UNICODETEXT or CF\_BITMAP, the application can display graphic information supplied by the object.</span></span>

## <a name="inserting-embedded-objects"></a><span data-ttu-id="15917-125">Вставка внедренных объектов</span><span class="sxs-lookup"><span data-stu-id="15917-125">Inserting Embedded Objects</span></span>

<span data-ttu-id="15917-126">Служба текстового ввода вставляет внедренный объект в контекст, вызывая [итфранже:: инсертембеддед](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) или [Итфинсертатселектион:: инсертембеддедатселектион](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span><span class="sxs-lookup"><span data-stu-id="15917-126">A text service inserts an embedded object into a context by calling [ITfRange::InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) or [ITfInsertAtSelection::InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span></span> <span data-ttu-id="15917-127">Служба текстового ввода должна предоставить встроенный IDataObject.</span><span class="sxs-lookup"><span data-stu-id="15917-127">The text service must supply the embedded IDataObject.</span></span>

 

 
