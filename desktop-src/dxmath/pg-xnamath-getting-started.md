---
title: Приступая к работе (Директксмас)
description: Библиотека Директксмас реализует оптимальный и переносимый интерфейс для арифметических и линейных операций с векторами с плавающей запятой одиночной точности (двумерные, трехмерные и 4D) или матрицы (3 × 3 и 4 × 4).
ms.assetid: 9972e382-7a0f-88a7-ad44-18521af3520d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 05e599acfc498e28b33acfc5bbbba2bea5669d2a
ms.sourcegitcommit: 3bdf30edb314e0fcd17dc4ddbc70e4ec7d3596e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "104351022"
---
# <a name="getting-started-directxmath"></a><span data-ttu-id="5bdc7-103">Приступая к работе (Директксмас)</span><span class="sxs-lookup"><span data-stu-id="5bdc7-103">Getting started (DirectXMath)</span></span>

<span data-ttu-id="5bdc7-104">Библиотека Директксмас реализует оптимальный и переносимый интерфейс для арифметических и линейных операций с векторами с плавающей запятой одиночной точности (двумерные, трехмерные и 4D) или матрицы (3 × 3 и 4 × 4).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-104">The DirectXMath Library implements an optimal and portable interface for arithmetic and linear algebra operations on single-precision floating-point vectors (2D, 3D, and 4D) or matrices (3×3 and 4×4).</span></span> <span data-ttu-id="5bdc7-105">Библиотека имеет ограниченную поддержку для операций целочисленного вектора.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-105">The library has some limited support for integer vector operations.</span></span> <span data-ttu-id="5bdc7-106">Эти операции широко используются в отрисовке и анимации с помощью графических программ.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-106">These operations are used extensively in rendering and animation by graphics programs.</span></span> <span data-ttu-id="5bdc7-107">Нет поддержки векторов двойной точности (включая длинные, разомкнутые или байты) и ограниченные операции целочисленного вектора.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-107">There is no support for double-precision vectors (including longs, shorts, or bytes), and only limited integer vector operations.</span></span>

<span data-ttu-id="5bdc7-108">Библиотека доступна на различных платформах Windows.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-108">The library is available on a variety of Windows platforms.</span></span> <span data-ttu-id="5bdc7-109">Так как библиотека предоставляет функции, недоступные ранее, эта версия заменяет следующие библиотеки:</span><span class="sxs-lookup"><span data-stu-id="5bdc7-109">Because the library provides functionality not available previously, this version supersedes the following libraries:</span></span>

-   <span data-ttu-id="5bdc7-110">Математическая библиотека Xbox, предоставляемая заголовком Ксбоксмас. h</span><span class="sxs-lookup"><span data-stu-id="5bdc7-110">Xbox Math library provided by the Xboxmath.h header</span></span>
-   <span data-ttu-id="5bdc7-111">Библиотека D3DX 9, предоставляемая библиотеками DLL D3DX 9</span><span class="sxs-lookup"><span data-stu-id="5bdc7-111">D3DX 9 library provided by the D3DX 9 DLLs</span></span>
-   <span data-ttu-id="5bdc7-112">D3DX 10 Math Library, предоставляемая через библиотеки DLL D3DX 10</span><span class="sxs-lookup"><span data-stu-id="5bdc7-112">D3DX 10 math library provided through the D3DX 10 DLLs</span></span>
-   <span data-ttu-id="5bdc7-113">Библиотека XNA Math, предоставляемая заголовком кснамас. h в пакете SDK DirectX и Xbox 360 XDK</span><span class="sxs-lookup"><span data-stu-id="5bdc7-113">XNA Math library provided by the xnamath.h header in the DirectX SDK and Xbox 360 XDK</span></span>

<span data-ttu-id="5bdc7-114">В этих разделах описаны основы начала работы.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-114">These sections outline the basics of getting started.</span></span>

-   [<span data-ttu-id="5bdc7-115">Загрузить</span><span class="sxs-lookup"><span data-stu-id="5bdc7-115">Download</span></span>](#download)
-   [<span data-ttu-id="5bdc7-116">Требования к системе во время выполнения</span><span class="sxs-lookup"><span data-stu-id="5bdc7-116">Run-Time System Requirements</span></span>](#run-time-system-requirements)
-   [<span data-ttu-id="5bdc7-117">Общие сведения о проектировании</span><span class="sxs-lookup"><span data-stu-id="5bdc7-117">Design Overview</span></span>](#design-overview)
-   [<span data-ttu-id="5bdc7-118">Соглашение матрицы</span><span class="sxs-lookup"><span data-stu-id="5bdc7-118">Matrix convention</span></span>](#matrix-convention)
-   [<span data-ttu-id="5bdc7-119">Базовое использование</span><span class="sxs-lookup"><span data-stu-id="5bdc7-119">Basic Usage</span></span>](#basic-usage)
-   [<span data-ttu-id="5bdc7-120">Рекомендации по использованию типов</span><span class="sxs-lookup"><span data-stu-id="5bdc7-120">Type Usage Guidelines</span></span>](#type-usage-guidelines)
-   [<span data-ttu-id="5bdc7-121">Создание векторов</span><span class="sxs-lookup"><span data-stu-id="5bdc7-121">Creating Vectors</span></span>](#creating-vectors)
    -   [<span data-ttu-id="5bdc7-122">КОНСТАНТНЫЕ ВЕКТОРЫ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-122">CONSTANT VECTORS</span></span>](#constant-vectors)
    -   [<span data-ttu-id="5bdc7-123">ВЕКТОРЫ ИЗ ПЕРЕМЕННЫХ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-123">VECTORS FROM VARIABLES</span></span>](#vectors-from-variables)
    -   [<span data-ttu-id="5bdc7-124">ВЕКТОРЫ ИЗ ВЕКТОРОВ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-124">VECTORS FROM VECTORS</span></span>](#vectors-from-vectors)
    -   [<span data-ttu-id="5bdc7-125">ВЕКТОРЫ ИЗ ПАМЯТИ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-125">VECTORS FROM MEMORY</span></span>](#vectors-from-memory)
-   [<span data-ttu-id="5bdc7-126">Извлечение компонентов из векторов</span><span class="sxs-lookup"><span data-stu-id="5bdc7-126">Extracting Components from Vectors</span></span>](#extracting-components-from-vectors)
-   [<span data-ttu-id="5bdc7-127">См. также</span><span class="sxs-lookup"><span data-stu-id="5bdc7-127">Related topics</span></span>](#related-topics)

## <a name="download"></a><span data-ttu-id="5bdc7-128">Скачать</span><span class="sxs-lookup"><span data-stu-id="5bdc7-128">Download</span></span>

<span data-ttu-id="5bdc7-129">Библиотека Директксмас включена в Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-129">The DirectXMath library is included in the Windows SDK.</span></span> <span data-ttu-id="5bdc7-130">Кроме того, его можно скачать из [GitHub/Microsoft/директксмас](https://github.com/Microsoft/DirectXMath).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-130">Alternatively you can download it from [GitHub/Microsoft/DirectXMath](https://github.com/Microsoft/DirectXMath).</span></span> <span data-ttu-id="5bdc7-131">Этот сайт также содержит связанные образцы проектов.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-131">This site also contains related sample projects.</span></span>

## <a name="run-time-system-requirements"></a><span data-ttu-id="5bdc7-132">Run-Time требования к системе</span><span class="sxs-lookup"><span data-stu-id="5bdc7-132">Run-Time System Requirements</span></span>

<span data-ttu-id="5bdc7-133">Библиотека Директксмас использует специальные инструкции процессора для векторных операций, когда они доступны.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-133">The DirectXMath Library uses specialized processor instructions for vector operations when they are available.</span></span> <span data-ttu-id="5bdc7-134">Чтобы предотвратить создание программой ошибок "неизвестное исключение инструкции", проверьте поддержку процессора, вызвав [**ксмверификпусуппорт**](/windows/win32/api/directxmath/nf-directxmath-xmverifycpusupport) перед использованием библиотеки директксмас.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-134">To avoid having a program generate "unknown instruction exception" faults, check for processor support by calling [**XMVerifyCPUSupport**](/windows/win32/api/directxmath/nf-directxmath-xmverifycpusupport) before using the DirectXMath Library.</span></span>

<span data-ttu-id="5bdc7-135">Ниже приведены базовые требования к поддержке во время выполнения библиотеки Директксмас.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-135">These are the basic DirectXMath Library run-time support requirements:</span></span>

-   <span data-ttu-id="5bdc7-136">Для компиляции по умолчанию на платформе Windows (x86/x64) требуется поддержка инструкций SSE/SSE2.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-136">Default compilation on a Windows (x86/x64) platform requires SSE/SSE2 instruction support.</span></span>
-   <span data-ttu-id="5bdc7-137">Для обеспечения соответствия по умолчанию на платформе Windows RT необходима поддержка инструкций ARM-NEON.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-137">Default compliation on a Windows RT platform requires ARM-NEON instruction support.</span></span>
-   <span data-ttu-id="5bdc7-138">Для компиляции с [**\_ XM \_ не определены \_ встроенные функции \_ , поэтому**](ovw-xnamath-reference-directives.md) требуется только стандартная поддержка операций с плавающей запятой.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-138">Compilation with [**\_XM\_NO\_INTRINSICS\_**](ovw-xnamath-reference-directives.md) defined requires only standard floating-point operation support.</span></span>

> [!Note]  
> <span data-ttu-id="5bdc7-139">При вызове [**ксмверификпусуппорт**](/windows/win32/api/directxmath/nf-directxmath-xmverifycpusupport)включите <Windows. h> перед включением <директксмас. h>.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-139">When you call [**XMVerifyCPUSupport**](/windows/win32/api/directxmath/nf-directxmath-xmverifycpusupport), include <windows.h> before you include <DirectXMath.h>.</span></span> <span data-ttu-id="5bdc7-140">Это единственная функция библиотеки, которая требует любого содержимого из <Windows. h> поэтому не нужно включать <Windows. h> в каждом модуле, использующем <Директксмас. h>.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-140">This is the only function in the library that requires any content from <windows.h> so you aren't required to include <windows.h> in every module that uses <DirectXMath.h>.</span></span>

 

## <a name="design-overview"></a><span data-ttu-id="5bdc7-141">Общие сведения о проектировании</span><span class="sxs-lookup"><span data-stu-id="5bdc7-141">Design Overview</span></span>

<span data-ttu-id="5bdc7-142">Библиотека Директксмас в основном поддерживает язык программирования C++.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-142">The DirectXMath Library primarily supports the C++ programming language.</span></span> <span data-ttu-id="5bdc7-143">Библиотека реализуется с помощью встроенных подпрограмм в файлах заголовков, Директксмас \* . inl, директкспаккедвектор. inl и директксколлисион. inl.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-143">The library is implemented using inline routines in the header files, DirectXMath\*.inl, DirectXPackedVector.inl and DirectXCollision.inl.</span></span> <span data-ttu-id="5bdc7-144">В этой реализации используются высокопроизводительные встроенные функции компилятора.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-144">This implementation makes use of high-performance compiler intrinsics.</span></span>

<span data-ttu-id="5bdc7-145">Библиотека Директксмас предоставляет следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="5bdc7-145">The DirectXMath Library provides:</span></span>

-   <span data-ttu-id="5bdc7-146">Реализация с использованием встроенных функций SSE/SSE2.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-146">An implementation using SSE/SSE2 intrinsics.</span></span>
-   <span data-ttu-id="5bdc7-147">Реализация без встроенных функций.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-147">An implementation without intrinsics.</span></span>
-   <span data-ttu-id="5bdc7-148">Реализация с использованием встроенных функций ARM-NEON.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-148">An implementation using ARM-NEON intrinsics.</span></span>

<span data-ttu-id="5bdc7-149">Так как библиотека доставляется с помощью файлов заголовков, используйте исходный код для настройки и оптимизации собственного приложения.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-149">Because the library is delivered using header files, use the source code to customize and optimize for your own app.</span></span>

## <a name="matrix-convention"></a><span data-ttu-id="5bdc7-150">Соглашение матрицы</span><span class="sxs-lookup"><span data-stu-id="5bdc7-150">Matrix convention</span></span>

<span data-ttu-id="5bdc7-151">Директксмас использует основные матрицы строк, векторы строк и предварительное умножение.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-151">DirectXMath uses row-major matrices, row vectors, and pre-multiplication.</span></span> <span data-ttu-id="5bdc7-152">Правой или левой определяется используемой версией функции (RH и LH), в противном случае функция работает с координатами левого или правого представления.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-152">Handedness is determined by which function version is used (RH vs. LH), otherwise the function works with either left-handed or right-handed view coordinates.</span></span>

<span data-ttu-id="5bdc7-153">Для справки в Direct3D используется историческая система координат, основные матрицы строк, векторы строк и предварительное умножение.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-153">For reference, Direct3D has historically used left-handed coordinate system, row-major matrices, row vectors, and pre-multiplication.</span></span> <span data-ttu-id="5bdc7-154">Современные Direct3D не имеют строгого требования для левых и правых координат, и обычно HLSL шейдеров по умолчанию используются для использования основных матриц.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-154">Modern Direct3D does not have a strong requirement for left vs. right-handed coordinates, and typically HLSL shaders default to consuming column-major matrices.</span></span> <span data-ttu-id="5bdc7-155">Дополнительные сведения см. в разделе [HLSL Matrix Order](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-per-component-math) .</span><span class="sxs-lookup"><span data-stu-id="5bdc7-155">See [HLSL Matrix Ordering](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-per-component-math) for details.</span></span>

## <a name="basic-usage"></a><span data-ttu-id="5bdc7-156">Основное использование</span><span class="sxs-lookup"><span data-stu-id="5bdc7-156">Basic Usage</span></span>

<span data-ttu-id="5bdc7-157">Для использования функций библиотеки Директксмас включите заголовки Директксмас. h, Директкспаккедвектор. h, Директксколорс. h и/или Директксколлисион. h.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-157">To use DirectXMath Library functions, include the DirectXMath.h, DirectXPackedVector.h, DirectXColors.h, and/or DirectXCollision.h headers.</span></span> <span data-ttu-id="5bdc7-158">Заголовки находятся в пакете средств разработки программного обеспечения Windows для приложений Магазина Windows.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-158">The headers are found in the Windows Software Development Kit for Windows Store apps.</span></span>

## <a name="type-usage-guidelines"></a><span data-ttu-id="5bdc7-159">Рекомендации по использованию типов</span><span class="sxs-lookup"><span data-stu-id="5bdc7-159">Type Usage Guidelines</span></span>

<span data-ttu-id="5bdc7-160">Типы [**ксмвектор**](xmvector-data-type.md) и [**ксмматрикс**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) — это рабочие Кони для библиотеки директксмас.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-160">The [**XMVECTOR**](xmvector-data-type.md) and [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) types are the work horses for the DirectXMath Library.</span></span> <span data-ttu-id="5bdc7-161">Каждая операция потребляет или создает данные этих типов.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-161">Every operation consumes or produces data of these types.</span></span> <span data-ttu-id="5bdc7-162">Работа с ними является ключом к использованию библиотеки.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-162">Working with them is key to using the library.</span></span> <span data-ttu-id="5bdc7-163">Однако, поскольку Директксмас использует наборы инструкций SIMD, эти типы данных подвержены ряду ограничений.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-163">However, since DirectXMath makes use of the SIMD instruction sets, these data types are subject to a number of restrictions.</span></span> <span data-ttu-id="5bdc7-164">Важно понимать эти ограничения, если вы хотите использовать функции Директксмас.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-164">It is critical that you understand these restrictions if you want to make good use of the DirectXMath functions.</span></span>

<span data-ttu-id="5bdc7-165">Вы должны рассматривать [**ксмвектор**](xmvector-data-type.md) как прокси-сервер для регистрации оборудования SIMD и [**ксмматрикс**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) в качестве прокси-сервера для логической группировки четырех реестров оборудования SIMD.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-165">You should think of [**XMVECTOR**](xmvector-data-type.md) as a proxy for a SIMD hardware register, and [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) as a proxy for a logical grouping of four SIMD hardware registers.</span></span> <span data-ttu-id="5bdc7-166">Эти типы снабжаются заметками, чтобы указать, что для правильной работы требуется 16-байтное выравнивание.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-166">These types are annotated to indicate they require 16-byte alignment to work correctly.</span></span> <span data-ttu-id="5bdc7-167">Компилятор автоматически поместит их в стек, если они используются в качестве локальной переменной, или поместить их в сегмент данных, если они используются в качестве глобальной переменной.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-167">The compiler will automatically place them correctly on the stack when they are used as a local variable, or place them in the data segment when they are used as a global variable.</span></span> <span data-ttu-id="5bdc7-168">С соответствующими соглашениями они также могут безопасно передаваться в функцию в качестве параметров (см. Дополнительные сведения [о соглашениях о вызовах](pg-xnamath-internals.md) ).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-168">With proper conventions, they can also be passed safely as parameters to a function (see [Calling Conventions](pg-xnamath-internals.md) for details).</span></span>

<span data-ttu-id="5bdc7-169">Однако выделения из кучи являются более сложными.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-169">Allocations from the heap, however, are more complicated.</span></span> <span data-ttu-id="5bdc7-170">Таким образом, необходимо соблюдать осторожность при использовании [**ксмвектор**](xmvector-data-type.md) или [**ксмматрикс**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) в качестве члена класса или структуры для выделения из кучи.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-170">As such, you need to be careful whenever you use either [**XMVECTOR**](xmvector-data-type.md) or [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) as a member of a class or structure to be allocated from the heap.</span></span> <span data-ttu-id="5bdc7-171">В Windows x64 все выделения кучи имеют размер 16 байт, но для Windows x86 они имеют только 8-байтное соответствие.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-171">On Windows x64, all heap allocations are 16-byte aligned, but for Windows x86, they are only 8-byte aligned.</span></span> <span data-ttu-id="5bdc7-172">Существуют варианты выделения структур из кучи с выравниванием по 16 байт (см. раздел [правильное выравнивание выделений](pg-xnamath-optimizing.md)).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-172">There are options for allocating structures from the heap with 16-byte alignment (see [Properly Align Allocations](pg-xnamath-optimizing.md)).</span></span> <span data-ttu-id="5bdc7-173">Для программ на C++ можно использовать оператор new/delete/New \[ \] /DELETE \[ \] Overloads (как глобально, так и для конкретных классов), чтобы при необходимости обеспечить оптимальное выравнивание.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-173">For C++ programs, you can use operator new/delete/new\[\]/delete\[\] overloads (either globally or class-specific) to enforce optimal alignment if desired.</span></span>

> [!Note]  
> <span data-ttu-id="5bdc7-174">В качестве альтернативы реализации выравнивания в классе C++ путем перегрузки New или DELETE можно использовать [идиому Пимпл](https://en.wikipedia.org/wiki/Opaque_pointer).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-174">As an alternative to enforcing alignment in your C++ class directly by overloading new/delete, you can use the [pImpl idiom](https://en.wikipedia.org/wiki/Opaque_pointer).</span></span> <span data-ttu-id="5bdc7-175">Если вы гарантируете, что класс **Impl** будет полностью согласован по внутреннему [**\_ согласованию \_ malloc**](/cpp/c-runtime-library/reference/aligned-malloc) , можно свободно использовать согласованные типы внутри внутренней реализации.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-175">If you ensure your **Impl** class is aligned via [**\_aligned\_malloc**](/cpp/c-runtime-library/reference/aligned-malloc) internally, you can then freely use aligned types within the internal implementation.</span></span> <span data-ttu-id="5bdc7-176">Это хороший вариант, если класс Public является среда выполнения Windows классом ссылки или предназначен для использования с [**std:: Shared \_ ptr<>**](/cpp/standard-library/shared-ptr-class), что в противном случае может привести к нарушению выравнивания.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-176">This is a good option when the 'public' class is a Windows Runtime ref class or intended for use with [**std::shared\_ptr<>**](/cpp/standard-library/shared-ptr-class), which can otherwise disrupt careful alignment.</span></span>

 

<span data-ttu-id="5bdc7-177">Однако часто бывает проще и более компактно, чтобы не использовать [**ксмвектор**](xmvector-data-type.md) или [**ксмматрикс**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) непосредственно в классе или структуре.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-177">However, often it is easier and more compact to avoid using [**XMVECTOR**](xmvector-data-type.md) or [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) directly in a class or structure.</span></span> <span data-ttu-id="5bdc7-178">Вместо этого следует использовать [**XMFLOAT3**](/windows/win32/api/directxmath/ns-directxmath-xmfloat3), [**XMFLOAT4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4), [**XMFLOAT4X3**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x3), [**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4)и т. д. в качестве членов структуры.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-178">Instead, make use of the [**XMFLOAT3**](/windows/win32/api/directxmath/ns-directxmath-xmfloat3), [**XMFLOAT4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4), [**XMFLOAT4X3**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x3), [**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4), and so on, as members of your structure.</span></span> <span data-ttu-id="5bdc7-179">Кроме того, можно использовать функции [векторной загрузки](ovw-xnamath-reference-functions-load.md) и [векторного хранилища](ovw-xnamath-reference-functions-storage.md) для эффективного перемещения данных в локальные переменные **ксмвектор** или **ксмматрикс** , выполнения вычислений и сохранения результатов.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-179">Further, you can use the [Vector Loading](ovw-xnamath-reference-functions-load.md) and [Vector Storage](ovw-xnamath-reference-functions-storage.md) functions to move the data efficiently into **XMVECTOR** or **XMMATRIX** local variables, perform computations, and store the results.</span></span> <span data-ttu-id="5bdc7-180">Существуют также функции потоковой передачи ([**XMVector3TransformStream**](/windows/win32/api/directxmath/nf-directxmath-xmvector3transformstream), [**XMVector4TransformStream**](/windows/win32/api/directxmath/nf-directxmath-xmvector4transformstream)и т. д.), которые эффективно работают непосредственно с массивами этих типов данных.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-180">There are also streaming functions ([**XMVector3TransformStream**](/windows/win32/api/directxmath/nf-directxmath-xmvector3transformstream), [**XMVector4TransformStream**](/windows/win32/api/directxmath/nf-directxmath-xmvector4transformstream), and so on) that efficiently operate directly on arrays of these data types.</span></span>

## <a name="creating-vectors"></a><span data-ttu-id="5bdc7-181">Создание векторов</span><span class="sxs-lookup"><span data-stu-id="5bdc7-181">Creating Vectors</span></span>

### <a name="constant-vectors"></a><span data-ttu-id="5bdc7-182">КОНСТАНТНЫЕ ВЕКТОРЫ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-182">CONSTANT VECTORS</span></span>

<span data-ttu-id="5bdc7-183">Многие операции используют константы в вычислениях векторного типа, и существует несколько способов загрузить [**ксмвектор**](xmvector-data-type.md) с нужными значениями.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-183">Many operations require the use of constants in vector computations, and there are a number of ways to load an [**XMVECTOR**](xmvector-data-type.md) with the desired values.</span></span>

-   <span data-ttu-id="5bdc7-184">При загрузке скалярной константы во все элементы [**ксмвектор**](xmvector-data-type.md)используйте [**ксмвекторрепликате**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicate) или [**ксмвекторрепликатеинт**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateint).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-184">If loading a scalar constant into all elements of an [**XMVECTOR**](xmvector-data-type.md), use [**XMVectorReplicate**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicate) or [**XMVectorReplicateInt**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateint).</span></span>
    ```
    XMVECTOR vFive = XMVectorReplicate( 5.f );
    ```

    

-   <span data-ttu-id="5bdc7-185">При использовании константы Vector с различными фиксированными значениями в качестве [**ксмвектор**](xmvector-data-type.md)используйте структуры [**XMVECTORF32**](xmvectorf32-data-type.md), [**XMVECTORU32**](xmvectoru32-data-type.md), **XMVECTORI32** или [**XMVECTORU8**](xmvectoru8-data-type.md) .</span><span class="sxs-lookup"><span data-stu-id="5bdc7-185">If using a vector constant with different fixed values as an [**XMVECTOR**](xmvector-data-type.md), use the [**XMVECTORF32**](xmvectorf32-data-type.md), [**XMVECTORU32**](xmvectoru32-data-type.md), **XMVECTORI32**, or [**XMVECTORU8**](xmvectoru8-data-type.md) structures.</span></span> <span data-ttu-id="5bdc7-186">На них можно ссылаться непосредственно в любом месте, где бы вы ни передали значение **ксмвектор** .</span><span class="sxs-lookup"><span data-stu-id="5bdc7-186">These can be then referenced directly anywhere you would pass an **XMVECTOR** value.</span></span>
    ```
    static const XMVECTORF32 vFactors = { 1.0f, 2.0f, 3.0f, 4.0f };
    ```

    

    > [!Note]  
    > <span data-ttu-id="5bdc7-187">Не используйте списки инициализаторов непосредственно с [**ксмвектор**](xmvector-data-type.md) (т. е. ксмвектор v = {1.0 f, 2.0 f, 3.0 f, 4.0 f}).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-187">Do not use initializer lists directly with [**XMVECTOR**](xmvector-data-type.md) (that is, XMVECTOR v = { 1.0f, 2.0f, 3.0f, 4.0f }).</span></span> <span data-ttu-id="5bdc7-188">Такой код неэффективен и не является переносимым на всех платформах, поддерживаемых Директксмас.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-188">Such code is inefficient and is not portable across all platforms that are supported by DirectXMath.</span></span>

     

-   <span data-ttu-id="5bdc7-189">Директксмас включает ряд предварительно определенных глобальных констант, которые можно использовать в коде (g \_ ксмоне, g \_ XMOne3, g \_ ксмтво, g \_ ксмонехалф, g \_ ксмхалфпи, g \_ ксмпи и т. д.).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-189">DirectXMath includes a number of pre-defined global constants you can make use of in your code (g\_XMOne, g\_XMOne3, g\_XMTwo, g\_XMOneHalf, g\_XMHalfPi, g\_XMPi, and so on).</span></span> <span data-ttu-id="5bdc7-190">Выполните поиск значений **ксмглобалконстант** в заголовке директксмас. h.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-190">Search the DirectXMath.h header for the **XMGLOBALCONSTANT** values.</span></span>
-   <span data-ttu-id="5bdc7-191">Существует набор констант Vector для распространенных цветов RGB (красный, зеленый, синий, желтый и т. д.).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-191">There are a set of vector constants for common RGB colors (Red, Green, Blue, Yellow, and so on).</span></span> <span data-ttu-id="5bdc7-192">Дополнительные сведения об этих константах вектора см. в разделе Директксколорс. h и пространство имен DirectX:: Colors.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-192">For more info about these vector constants, see DirectXColors.h and the DirectX::Colors namespace.</span></span>

### <a name="vectors-from-variables"></a><span data-ttu-id="5bdc7-193">ВЕКТОРЫ ИЗ ПЕРЕМЕННЫХ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-193">VECTORS FROM VARIABLES</span></span>

-   <span data-ttu-id="5bdc7-194">Если создается вектор из одной скалярной переменной, см. раздел [**ксмвекторрепликате**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicate) and [**ксмвекторрепликатеинт**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateint).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-194">If creating a vector from a single scalar variable, see [**XMVectorReplicate**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicate) and [**XMVectorReplicateInt**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateint).</span></span>
    ```
    XMVECTOR v = XMVectorReplicate( f  );
    ```

    

-   <span data-ttu-id="5bdc7-195">Если создается вектор из четырех скалярных переменных, см. раздел [**ксмвекторсет**](/windows/win32/api/directxmath/nf-directxmath-xmvectorset) and [**ксмвекторсетинт**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsetint).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-195">If creating a vector from four scalar variables, see [**XMVectorSet**](/windows/win32/api/directxmath/nf-directxmath-xmvectorset) and [**XMVectorSetInt**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsetint).</span></span>
    ```
    XMVECTOR v = XMVectorSet( fx, fy, fz, fw );
    ```

    

### <a name="vectors-from-vectors"></a><span data-ttu-id="5bdc7-196">ВЕКТОРЫ ИЗ ВЕКТОРОВ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-196">VECTORS FROM VECTORS</span></span>

-   <span data-ttu-id="5bdc7-197">При создании вектора из другого вектора с заданным для переменной компонентом можно использовать [функции метода доступа Vector](ovw-xnamath-reference-functions-accessors.md).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-197">If creating a vector from another vector with a specific component set to a variable, you can consider using [Vector Accessor Functions](ovw-xnamath-reference-functions-accessors.md).</span></span>
    ```
    XMVECTOR v2 = XMVectorSetW( v1, fw );
    ```

    

-   <span data-ttu-id="5bdc7-198">При создании вектора из другого вектора с единственным реплицируемым компонентом используйте [**ксмвекторсплаткс**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplatx), [**ксмвекторсплати**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplaty), [**ксмвекторсплатз**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplatz)и [**ксмвекторсплатв**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplatw).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-198">If creating a vector from another vector with a single component replicated, use [**XMVectorSplatX**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplatx), [**XMVectorSplatY**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplaty), [**XMVectorSplatZ**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplatz), and [**XMVectorSplatW**](/windows/win32/api/directxmath/nf-directxmath-xmvectorsplatw).</span></span>
    ```
    XMVECTOR vz = XMVectorSplatZ( v );
    ```

    

-   <span data-ttu-id="5bdc7-199">Если создать вектор из другого вектора или пары векторов с переупорядоченными компонентами, см. раздел [**ксмвекторсвиззле**](/windows/win32/api/directxmath/nf-directxmath-xmvectorswizzle) and [**ксмвекторпермуте**](/windows/win32/api/directxmath/nf-directxmath-xmvectorpermute).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-199">If creating a vector from another vector or pair of vectors with reordered components, see [**XMVectorSwizzle**](/windows/win32/api/directxmath/nf-directxmath-xmvectorswizzle) and [**XMVectorPermute**](/windows/win32/api/directxmath/nf-directxmath-xmvectorpermute).</span></span>
    ```
    XMVECTOR v2 = XMVectorSwizzle<XM_SWIZZLE_Z, XM_SWIZZLE_Y, XM_SWIZZLE_W, XM_SWIZZLE_X>( v1 );

    XMVECTOR v3 = XMVectorPermute<XM_PERMUTE_0W, XM_PERMUTE_1X, XM_PERMUTE_0X, XM_PERMUTE_1Z>( v1, v2 );
    ```

    

### <a name="vectors-from-memory"></a><span data-ttu-id="5bdc7-200">ВЕКТОРЫ ИЗ ПАМЯТИ</span><span class="sxs-lookup"><span data-stu-id="5bdc7-200">VECTORS FROM MEMORY</span></span>

-   <span data-ttu-id="5bdc7-201">Сведения о загрузке одного значения с плавающей запятой из памяти см. в разделе [**ксмвекторрепликатептр**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateptr), [**ксмвекторрепликатеинтптр**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateintptr), [**ксмлоадфлоат**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat)и [**ксмлоадинт**](/windows/win32/api/directxmath/nf-directxmath-xmloadint).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-201">For loading a single float value from memory, see [**XMVectorReplicatePtr**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateptr), [**XMVectorReplicateIntPtr**](/windows/win32/api/directxmath/nf-directxmath-xmvectorreplicateintptr), [**XMLoadFloat**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat), and [**XMLoadInt**](/windows/win32/api/directxmath/nf-directxmath-xmloadint).</span></span>
-   <span data-ttu-id="5bdc7-202">Распространенные способы загрузки массивов с плавающей запятой: [**XMLoadFloat2**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat2), [**XMLoadFloat3**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat3), [**XMLoadFloat4**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat4), [**XMLoadFloat3x3**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat3x3), [**XMLoadFloat4x3**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat4x3)и [**XMLoadFloat4x4**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat4x4).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-202">Common ways to load float arrays are: [**XMLoadFloat2**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat2), [**XMLoadFloat3**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat3), [**XMLoadFloat4**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat4), [**XMLoadFloat3x3**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat3x3), [**XMLoadFloat4x3**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat4x3), and [**XMLoadFloat4x4**](/windows/win32/api/directxmath/nf-directxmath-xmloadfloat4x4).</span></span>
-   <span data-ttu-id="5bdc7-203">Директксмас включает обширный набор типов и связанных нагрузок и магазинов для обработки различных структур данных и распространенных форматов GPU.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-203">DirectXMath includes a rich set of types and related loads and stores for handling various data-structures and common GPU formats.</span></span> <span data-ttu-id="5bdc7-204">См. раздел [векторная нагрузка](ovw-xnamath-reference-functions-load.md) и [хранилище векторов](ovw-xnamath-reference-functions-storage.md).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-204">See [Vector Load](ovw-xnamath-reference-functions-load.md) and [Vector Store](ovw-xnamath-reference-functions-storage.md).</span></span>

## <a name="extracting-components-from-vectors"></a><span data-ttu-id="5bdc7-205">Извлечение компонентов из векторов</span><span class="sxs-lookup"><span data-stu-id="5bdc7-205">Extracting Components from Vectors</span></span>

<span data-ttu-id="5bdc7-206">Обработка SIMD наиболее эффективна, когда данные загружаются в регистры SIMD и полностью обрабатываются перед извлечением результатов.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-206">SIMD processing is most efficient when data is loaded into the SIMD registers and fully processed before extracting the results.</span></span> <span data-ttu-id="5bdc7-207">Преобразование между скалярными и векторными формами неэффективно, поэтому рекомендуется делать это только при необходимости.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-207">Conversion between scalar and vector forms is inefficient, so we recommend that you do it only when required.</span></span> <span data-ttu-id="5bdc7-208">По этой причине функции в библиотеке Директксмас, возвращающие скалярное значение, возвращаются в векторной форме, где скалярный результат реплицируется по результирующему вектору (т. е. [**XMVector2Dot**](/windows/win32/api/directxmath/nf-directxmath-xmvector2dot), [**XMVector3Length**](/windows/win32/api/directxmath/nf-directxmath-xmvector3length)и т. д.).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-208">For this reason, functions in the DirectXMath library that produce a scalar value are returned in a vector form where the scalar result is replicated across the resulting vector (that is, [**XMVector2Dot**](/windows/win32/api/directxmath/nf-directxmath-xmvector2dot), [**XMVector3Length**](/windows/win32/api/directxmath/nf-directxmath-xmvector3length), and so on).</span></span> <span data-ttu-id="5bdc7-209">Однако если вам нужны скалярные значения, вот несколько вариантов:</span><span class="sxs-lookup"><span data-stu-id="5bdc7-209">However, when you need scalar values, here are a few choices on how to go about it:</span></span>

-   <span data-ttu-id="5bdc7-210">При вычислении одного скалярного ответа необходимо использовать [функции метода доступа Vector](ovw-xnamath-reference-functions-accessors.md) :</span><span class="sxs-lookup"><span data-stu-id="5bdc7-210">If a single scalar answer is computed, use of the [Vector Accessor Functions](ovw-xnamath-reference-functions-accessors.md) is appropriate:</span></span>
    ```
    float f = XMVectorGetX( v );
    ```

    

-   <span data-ttu-id="5bdc7-211">Если требуется извлечь несколько компонентов вектора, рассмотрите возможность сохранения вектора в структуре памяти и считывания их обратно.</span><span class="sxs-lookup"><span data-stu-id="5bdc7-211">If multiple components of the vector are required to be extracted, consider storing the vector in a memory structure and reading it back.</span></span> <span data-ttu-id="5bdc7-212">Пример:</span><span class="sxs-lookup"><span data-stu-id="5bdc7-212">For example:</span></span>
    ```
    XMFLOAT4A t;
    XMStoreFloat4A( &t, v );
    // t.x, t.y, t.z, and t.w can be individually accessed now
    ```

    

-   <span data-ttu-id="5bdc7-213">Наиболее эффективная обработка векторной обработки заключается в использовании потоковой передачи из памяти, когда входные данные загружаются из памяти (с помощью [функций векторной загрузки](ovw-xnamath-reference-functions-load.md)), полностью обрабатываются в SIMD-форме, а затем записываются в память (с помощью [функций векторного хранилища](ovw-xnamath-reference-functions-storage.md)).</span><span class="sxs-lookup"><span data-stu-id="5bdc7-213">The most efficient form of vector processing is to use memory-to-memory streaming where the input data is loaded from memory (using [Vector Load Functions](ovw-xnamath-reference-functions-load.md)), processed fully in SIMD form, and then written to memory (using [Vector Store Functions](ovw-xnamath-reference-functions-storage.md)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5bdc7-214">См. также</span><span class="sxs-lookup"><span data-stu-id="5bdc7-214">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5bdc7-215">Директксмас по программированию</span><span class="sxs-lookup"><span data-stu-id="5bdc7-215">DirectXMath Programming Guide</span></span>](ovw-xnamath-progguide.md)
</dt> </dl>

 

 