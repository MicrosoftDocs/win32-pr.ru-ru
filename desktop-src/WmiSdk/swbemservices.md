---
description: Методы объекта SWbemServices можно использовать для выполнения операций с пространством имен на локальном или удаленном узле. Не удается создать этот объект с помощью вызова функции VBScript.
ms.assetid: 7fcfa404-2fe6-42e5-85ac-64536f6d2a44
ms.tgt_platform: multiple
title: Объект SWbemServices (Wbemdisp. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemServices
- ISWbemServices
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: 4303b3226acc6d773ed35e77176e05e3a58c567d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711619"
---
# <a name="swbemservices-object"></a>Объект SWbemServices

Методы объекта **SwbemServices** можно использовать для выполнения операций с пространством имен на локальном или удаленном узле. Не удается создать этот объект с **помощью вызова функции** VBScript.

## <a name="members"></a>Элементы

Объект **SwbemServices** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Объект **SwbemServices** содержит эти методы.



| Метод                                                                         | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**ассоЦиаторсоф**](swbemservices-associatorsof.md)                           | Извлекает экземпляры управляемых ресурсов, связанные с указанным ресурсом, через один или несколько классов взаимосвязей. Вы предоставляете путь к объекту для исходной конечной точки, а [**ассоЦиаторсоф**](swbemservices-associatorsof.md) возвращает управляемые ресурсы в противоположной конечной точке. Метод **ассоЦиаторсоф** выполняет ту же функцию, что и "соединители", ВЫПОЛНЯЕМые WQL-запросом.<br/>                                                                           |
| [**ассоЦиаторсофасинк**](swbemservices-associatorsofasync.md)                 | Асинхронно возвращает коллекцию объектов (классов или экземпляров), связанных с указанным объектом.<br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [**Удалить**](swbemservices-delete.md)                                         | Удаляет экземпляр управляемого ресурса (или определение класса из репозитория CIM).<br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**DeleteAsync**](swbemservices-deleteasync.md)                               | Асинхронно удаляет класс или экземпляр, указанный в пути объекта.<br/>                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**ExecMethod**](swbemservices-execmethod.md)                                 | Предоставляет альтернативный способ выполнения метода, определенного определением управляемого класса ресурсов. В основном используется в ситуациях, когда язык сценариев не поддерживает параметры out. Например, JScript не поддерживает параметры out.<br/>                                                                                                                                                                                                                                            |
| [**ексекмесодасинк**](swbemservices-execmethodasync.md)                       | Асинхронно выполняет метод, который экспортируется поставщиком метода.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**ексекнотификатионкуери**](swbemservices-execnotificationquery.md)           | Выполняет запрос подписки на события для получения событий. Запрос подписки на события — это запрос, который определяет изменение управляемой среды, которую необходимо отслеживать. Когда происходит изменение, инфраструктура WMI доставляет событие, описывающее изменение вызывающего скрипта.<br/>                                                                                                                                                                                                        |
| [**ExecNotificationQueryAsync**](swbemservices-execnotificationqueryasync.md) | Асинхронно выполняет запрос на получение событий.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**ExecQuery**](swbemservices-execquery.md)                                   | Выполняет запрос для получения коллекции экземпляров управляемых WMI ресурсов (или определений классов). [**ExecQuery**](swbemservices-execquery.md) можно использовать для получения отфильтрованной коллекции экземпляров, соответствующих критериям, определенным в запросе, переданном в **ExecQuery**.<br/>                                                                                                                                                                                                           |
| [**ексеккуерясинк**](swbemservices-execqueryasync.md)                         | Асинхронно выполняет запрос для получения объектов.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**Получить**](swbemservices-get.md)                                               | Извлекает один экземпляр управляемого ресурса (или определения класса) на основе пути к объекту.<br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| [**GetAsync**](swbemservices-getasync.md)                                     | Асинхронно извлекает объект, который является либо определением класса, либо экземпляром на основе пути к объекту.<br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [**инстанцесоф**](swbemservices-instancesof.md)                               | Извлекает все экземпляры управляемого ресурса на основе имени класса. По умолчанию [**инстанцесоф**](swbemservices-instancesof.md) выполняет глубокое извлечение. То есть **инстанцесоф** извлекает экземпляры ресурса, идентифицируемые именем класса, переданного в метод, а также извлекает все экземпляры всех ресурсов, являющихся подклассами (определенные ниже) целевого класса.<br/>                                                                                       |
| [**инстанцесофасинк**](swbemservices-instancesofasync.md)                     | Асинхронно возвращает экземпляры указанного класса в соответствии с заданным пользователем критерием выбора.<br/>                                                                                                                                                                                                                                                                                                                                                                                  |
| [**референцесто**](swbemservices-referencesto.md)                             | Возвращает все ассоциации, ссылающиеся на указанный ресурс. Лучший способ понять [**референцесто**](swbemservices-referencesto.md) — это сравнить его с методом [**ассоЦиаторсоф**](swbemservices-associatorsof.md) . **АссоЦиаторсоф** возвращает динамические ресурсы, которые находятся на противоположном конце ассоциации. **Референцесто** возвращает саму связь. Метод **референцесто** выполняет ту же функцию, что и "ссылки" на WQL-запрос.<br/> |
| [**референцестоасинк**](swbemservices-referencesto.md)                        | Асинхронно возвращает коллекцию всех классов или экземпляров взаимосвязей, которые ссылаются на конкретный класс или экземпляр.<br/>                                                                                                                                                                                                                                                                                                                                                                        |
| [**субклассесоф**](swbemservices-subclassesof.md)                             | Извлекает все подклассы указанного класса из репозитория CIM.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**субклассесофасинк**](swbemservices-subclassesofasync.md)                   | Асинхронно возвращает коллекцию подклассов для указанного класса.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

### <a name="properties"></a>Свойства

Объект **SwbemServices** имеет следующие свойства.



| Свойство                                                 | Тип доступа          | Описание                                                                          |
|:---------------------------------------------------------|:---------------------|:-------------------------------------------------------------------------------------|
| [**Безопасность\_**](swbemservices-security-.md)<br/> | Только для чтения<br/> | Используется для получения или задания параметров безопасности для объекта **SwbemServices** .<br/> |



 

## <a name="remarks"></a>Комментарии

Методы могут вызываться либо в синхронном, либо в асинхронном режиме, либо в режиме семисинчронаус. Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).

**Обзор**

**SwbemServices** обслуживает две основные роли. Сначала объект **SwbemServices** представляет подключение с проверкой подлинности к пространству имен WMI на целевом компьютере. Во-вторых, **SwbemServices** — это объект автоматизации, используемый для получения ресурсов, управляемых WMI. Ссылку на объект **SwbemServices** можно получить одним из двух способов:

-   Как показано в большинстве сценариев WMI, представленных до сих пор, можно использовать функцию языка VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) в сочетании с моникером WMI "винмгмтс:". В следующем примере показана простейшая форма WMI-соединения. Пример подключается к пространству имен по умолчанию (обычно "root \\ CIMv2") на локальном компьютере:

    `Set objSWbemServices = GetObject("winmgmts:")`

-   Для получения ссылки на объект **SwbemServices** можно также использовать метод [**коннектсервер**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) объекта [**SWbemLocator**](swbemlocator.md) .

После получения ссылки на объект **SwbemServices** используйте ссылку на объект, чтобы вызвать 1 из 18 методов, доступных с помощью **SwbemServices**. **SwbemServices** может возвращать один из трех различных объектов библиотеки сценариев WMI ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md)или [**свбемевентсаурце**](swbemeventsource.md)) в зависимости от вызываемого метода. Знание типа объекта, возвращаемого каждым методом, поможет определить следующий шаг, который должен быть выполнен сценарием. Например, если возвращается **SWbemObjectSet**, необходимо перечислить коллекцию для доступа к каждому **SWbemObject** в коллекции. При возврате **SWbemObject** можно сразу же получить доступ к методам и свойствам объекта, не перечисляя коллекцию первыми.

**Режимы работы**

**SwbemServices** поддерживает три режима работы: синхронный, асинхронный и семисинчронаус.

-   **Синхронный**. В синхронном режиме блоки сценария (приостанавливаются) до завершения метода **SwbemServices** . Не только выполняет ожидание сценария, но в случаях, когда инструментарий WMI извлекает экземпляры управляемых ресурсов, Инструментарий WMI создает весь [**SWbemObjectSet**](swbemobjectset.md) в памяти до возвращения первого байта данных вызывающему сценарию. Это может оказать негативное воздействие на производительность скрипта и на компьютере, на котором работает сценарий. Например, синхронное извлечение тысяч событий из журналов событий Windows может занять много времени и использовать большой объем памяти. По этим причинам синхронные операции не рекомендуются, за исключением трех методов ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md)и [**Get**](swbemservices-get.md)), которые по умолчанию являются синхронными. Эти методы не возвращают большие наборы данных, поэтому операция семисинчронаус не требуется.
-   **Асинхронный**. В асинхронном режиме скрипт вызывает один из девяти асинхронных методов и немедленно возвращает результат. То есть, как только вызывается асинхронный метод, сценарий возобновляет выполнение следующей строки кода. Чтобы использовать асинхронный метод, сценарий должен сначала создать объект [**свбемсинк**](swbemsink.md) и специальную подпрограммы, называемую обработчиком событий. Инструментарий WMI выполняет асинхронную операцию и уведомляет скрипт, вызывая подпрограммы обработчика событий после завершения операции.
-   **Семисинчронаус**. Режим семисинчронаус является компромиссом между синхронным и асинхронным. Операции семисинчронаус обеспечивают лучшую производительность, чем синхронные операции, но они не требуют дополнительных знаний и шагов сценариев, необходимых для выполнения асинхронных операций. Это тип операции по умолчанию для большинства запросов WMI.

    В режиме семисинчронаус сценарий вызывает один из шести методов извлечения данных и немедленно возвращает результат. Инструментарий WMI извлекает управляемые ресурсы в фоновом режиме по мере продолжения выполнения скрипта. По мере извлечения ресурсов они немедленно возвращаются в скрипт с помощью SWbemObjectSet. Вы можете начать доступ к управляемым ресурсам, не дожидаясь сборки всей коллекции.

    При работе с управляемыми ресурсами, имеющими много экземпляров (множество значений больше 1 000), таких как [**CIM- \_ файл**](/windows/desktop/CIMWin32Prov/cim-datafile) и [**Win32 \_ нтложевент**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent), следует заменять семисинчронаус операции. Предостережение является следствием того, как инструментарий WMI обрабатывает экземпляры управляемых ресурсов. Для каждого экземпляра управляемого ресурса Инструментарий WMI создает и кэширует объект [**SWbemObject**](swbemobject.md) . Если для управляемого ресурса существует большое количество экземпляров, извлечение экземпляра может захватить доступные ресурсы, уменьшая производительность как сценария, так и компьютера.

    Чтобы обойти эту проблему, можно оптимизировать вызовы методов семисинчронаус с помощью флага **вбемфлагфорвардонли** . Флаг **вбемфлагфорвардонли** в сочетании с флагом **вбемфлагретурниммедиатели** (установленным по умолчанию флагом семисинчронаус) сообщает инструментарию WMI, что он возвращает только однонаправленную [**SWbemObjectSet**](swbemobjectset.md), что устраняет проблему с производительностью больших наборов данных. Однако использование флага **вбемфлагфорвардонли** сопровождается ценой. Однопроходный **SWbemObjectSet** можно перечислить только один раз. После доступа к каждому [**SWbemObjectу**](swbemobject.md) в однонаправленном **SWbemObjectSet** освобождается память, выделенная для экземпляра.

За исключением асинхронных методов [**удаления**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md)и девяти, семисинчронаус является предпочтительным и рекомендуемым режимом работы по умолчанию.

**Часто используемые методы**

Чаще всего в сценариях администрирования системы используются методы [**инстанцесоф**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md)и [**ексекнотификатионкуери**](swbemservices-execnotificationquery.md). Хотя часто используется, **инстанцесоф** не обязательно является рекомендуемым способом получения информации (хотя это, вероятно, самый простой способ).

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Header<br/>                   | <dl> <dt>Wbemdisp. h</dt> </dl>   |
| Библиотека типов<br/>             | <dl> <dt>Wbemdisp. tlb</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Wbemdisp.dll</dt> </dl> |
| CLSID<br/>                    | \_SWBEMSERVICES CLSID<br/>                                                         |
| IID<br/>                      | IID \_ исвбемсервицес<br/>                                                          |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Создание скриптов для объектов API](scripting-api-objects.md)
</dt> <dt>

[Вызов метода](calling-a-method.md)
</dt> </dl>

 

