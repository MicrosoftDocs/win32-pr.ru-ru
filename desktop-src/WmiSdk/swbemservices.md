---
description: Методы объекта SWbemServices можно использовать для выполнения операций с пространством имен на локальном или удаленном узле. Не удается создать этот объект с помощью вызова функции VBScript.
ms.assetid: 7fcfa404-2fe6-42e5-85ac-64536f6d2a44
ms.tgt_platform: multiple
title: Объект SWbemServices (Wbemdisp. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemServices
- ISWbemServices
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: 4303b3226acc6d773ed35e77176e05e3a58c567d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711619"
---
# <a name="swbemservices-object"></a><span data-ttu-id="b4e54-104">Объект SWbemServices</span><span class="sxs-lookup"><span data-stu-id="b4e54-104">SWbemServices object</span></span>

<span data-ttu-id="b4e54-105">Методы объекта **SwbemServices** можно использовать для выполнения операций с пространством имен на локальном или удаленном узле.</span><span class="sxs-lookup"><span data-stu-id="b4e54-105">You can use the methods of an **SWbemServices** object to perform operations against a namespace on either a local host or a remote host.</span></span> <span data-ttu-id="b4e54-106">Не удается создать этот объект с **помощью вызова функции** VBScript.</span><span class="sxs-lookup"><span data-stu-id="b4e54-106">This object cannot be created by the VBScript **CreateObject** call.</span></span>

## <a name="members"></a><span data-ttu-id="b4e54-107">Элементы</span><span class="sxs-lookup"><span data-stu-id="b4e54-107">Members</span></span>

<span data-ttu-id="b4e54-108">Объект **SwbemServices** имеет следующие типы членов:</span><span class="sxs-lookup"><span data-stu-id="b4e54-108">The **SWbemServices** object has these types of members:</span></span>

-   [<span data-ttu-id="b4e54-109">Методы</span><span class="sxs-lookup"><span data-stu-id="b4e54-109">Methods</span></span>](#methods)
-   [<span data-ttu-id="b4e54-110">Свойства</span><span class="sxs-lookup"><span data-stu-id="b4e54-110">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="b4e54-111">Методы</span><span class="sxs-lookup"><span data-stu-id="b4e54-111">Methods</span></span>

<span data-ttu-id="b4e54-112">Объект **SwbemServices** содержит эти методы.</span><span class="sxs-lookup"><span data-stu-id="b4e54-112">The **SWbemServices** object has these methods.</span></span>



| <span data-ttu-id="b4e54-113">Метод</span><span class="sxs-lookup"><span data-stu-id="b4e54-113">Method</span></span>                                                                         | <span data-ttu-id="b4e54-114">Описание</span><span class="sxs-lookup"><span data-stu-id="b4e54-114">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b4e54-115">**ассоЦиаторсоф**</span><span class="sxs-lookup"><span data-stu-id="b4e54-115">**AssociatorsOf**</span></span>](swbemservices-associatorsof.md)                           | <span data-ttu-id="b4e54-116">Извлекает экземпляры управляемых ресурсов, связанные с указанным ресурсом, через один или несколько классов взаимосвязей.</span><span class="sxs-lookup"><span data-stu-id="b4e54-116">Retrieves the instances of managed resources that are associated with a specified resource through one or more association classes.</span></span> <span data-ttu-id="b4e54-117">Вы предоставляете путь к объекту для исходной конечной точки, а [**ассоЦиаторсоф**](swbemservices-associatorsof.md) возвращает управляемые ресурсы в противоположной конечной точке.</span><span class="sxs-lookup"><span data-stu-id="b4e54-117">You provide the object path for the originating endpoint, and [**AssociatorsOf**](swbemservices-associatorsof.md) returns the managed resources at the opposite endpoint.</span></span> <span data-ttu-id="b4e54-118">Метод **ассоЦиаторсоф** выполняет ту же функцию, что и "соединители", ВЫПОЛНЯЕМые WQL-запросом.</span><span class="sxs-lookup"><span data-stu-id="b4e54-118">The **AssociatorsOf** method performs the same function that the "ASSOCIATORS OF" WQL query performs.</span></span><br/>                                                                           |
| [<span data-ttu-id="b4e54-119">**ассоЦиаторсофасинк**</span><span class="sxs-lookup"><span data-stu-id="b4e54-119">**AssociatorsOfAsync**</span></span>](swbemservices-associatorsofasync.md)                 | <span data-ttu-id="b4e54-120">Асинхронно возвращает коллекцию объектов (классов или экземпляров), связанных с указанным объектом.</span><span class="sxs-lookup"><span data-stu-id="b4e54-120">Asynchronously returns a collection of objects (classes or instances) that are associated with a specified object.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="b4e54-121">**Удалить**</span><span class="sxs-lookup"><span data-stu-id="b4e54-121">**Delete**</span></span>](swbemservices-delete.md)                                         | <span data-ttu-id="b4e54-122">Удаляет экземпляр управляемого ресурса (или определение класса из репозитория CIM).</span><span class="sxs-lookup"><span data-stu-id="b4e54-122">Deletes an instance of a managed resource (or a class definition from the CIM repository).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="b4e54-123">**DeleteAsync**</span><span class="sxs-lookup"><span data-stu-id="b4e54-123">**DeleteAsync**</span></span>](swbemservices-deleteasync.md)                               | <span data-ttu-id="b4e54-124">Асинхронно удаляет класс или экземпляр, указанный в пути объекта.</span><span class="sxs-lookup"><span data-stu-id="b4e54-124">Asynchronously deletes the class or instance that is specified in the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="b4e54-125">**ExecMethod**</span><span class="sxs-lookup"><span data-stu-id="b4e54-125">**ExecMethod**</span></span>](swbemservices-execmethod.md)                                 | <span data-ttu-id="b4e54-126">Предоставляет альтернативный способ выполнения метода, определенного определением управляемого класса ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b4e54-126">Provides an alternative way to execute a method defined by a managed resource class definition.</span></span> <span data-ttu-id="b4e54-127">В основном используется в ситуациях, когда язык сценариев не поддерживает параметры out.</span><span class="sxs-lookup"><span data-stu-id="b4e54-127">Primarily used in situations in which the scripting language does not support out parameters.</span></span> <span data-ttu-id="b4e54-128">Например, JScript не поддерживает параметры out.</span><span class="sxs-lookup"><span data-stu-id="b4e54-128">For example, JScript does not support out parameters.</span></span><br/>                                                                                                                                                                                                                                            |
| [<span data-ttu-id="b4e54-129">**ексекмесодасинк**</span><span class="sxs-lookup"><span data-stu-id="b4e54-129">**ExecMethodAsync**</span></span>](swbemservices-execmethodasync.md)                       | <span data-ttu-id="b4e54-130">Асинхронно выполняет метод, который экспортируется поставщиком метода.</span><span class="sxs-lookup"><span data-stu-id="b4e54-130">Asynchronously executes a method that is exported by a method provider.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="b4e54-131">**ексекнотификатионкуери**</span><span class="sxs-lookup"><span data-stu-id="b4e54-131">**ExecNotificationQuery**</span></span>](swbemservices-execnotificationquery.md)           | <span data-ttu-id="b4e54-132">Выполняет запрос подписки на события для получения событий.</span><span class="sxs-lookup"><span data-stu-id="b4e54-132">Executes an event subscription query to receive events.</span></span> <span data-ttu-id="b4e54-133">Запрос подписки на события — это запрос, который определяет изменение управляемой среды, которую необходимо отслеживать.</span><span class="sxs-lookup"><span data-stu-id="b4e54-133">An event subscription query is a query that defines a change to the managed environment that you want to monitor.</span></span> <span data-ttu-id="b4e54-134">Когда происходит изменение, инфраструктура WMI доставляет событие, описывающее изменение вызывающего скрипта.</span><span class="sxs-lookup"><span data-stu-id="b4e54-134">When the change occurs, the WMI infrastructure delivers an event describing the change to the calling script.</span></span><br/>                                                                                                                                                                                                        |
| [<span data-ttu-id="b4e54-135">**ExecNotificationQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="b4e54-135">**ExecNotificationQueryAsync**</span></span>](swbemservices-execnotificationqueryasync.md) | <span data-ttu-id="b4e54-136">Асинхронно выполняет запрос на получение событий.</span><span class="sxs-lookup"><span data-stu-id="b4e54-136">Asynchronously executes a query to receive events.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="b4e54-137">**ExecQuery**</span><span class="sxs-lookup"><span data-stu-id="b4e54-137">**ExecQuery**</span></span>](swbemservices-execquery.md)                                   | <span data-ttu-id="b4e54-138">Выполняет запрос для получения коллекции экземпляров управляемых WMI ресурсов (или определений классов).</span><span class="sxs-lookup"><span data-stu-id="b4e54-138">Executes a query to retrieve a collection of instances of WMI-managed resources (or class definitions).</span></span> <span data-ttu-id="b4e54-139">[**ExecQuery**](swbemservices-execquery.md) можно использовать для получения отфильтрованной коллекции экземпляров, соответствующих критериям, определенным в запросе, переданном в **ExecQuery**.</span><span class="sxs-lookup"><span data-stu-id="b4e54-139">[**ExecQuery**](swbemservices-execquery.md) can be used to retrieve a filtered collection of instances that match criteria you define in the query passed to **ExecQuery**.</span></span><br/>                                                                                                                                                                                                           |
| [<span data-ttu-id="b4e54-140">**ексеккуерясинк**</span><span class="sxs-lookup"><span data-stu-id="b4e54-140">**ExecQueryAsync**</span></span>](swbemservices-execqueryasync.md)                         | <span data-ttu-id="b4e54-141">Асинхронно выполняет запрос для получения объектов.</span><span class="sxs-lookup"><span data-stu-id="b4e54-141">Asynchronously executes a query to retrieve objects.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="b4e54-142">**Получить**</span><span class="sxs-lookup"><span data-stu-id="b4e54-142">**Get**</span></span>](swbemservices-get.md)                                               | <span data-ttu-id="b4e54-143">Извлекает один экземпляр управляемого ресурса (или определения класса) на основе пути к объекту.</span><span class="sxs-lookup"><span data-stu-id="b4e54-143">Retrieves a single instance of a managed resource (or class definition) based on an object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="b4e54-144">**GetAsync**</span><span class="sxs-lookup"><span data-stu-id="b4e54-144">**GetAsync**</span></span>](swbemservices-getasync.md)                                     | <span data-ttu-id="b4e54-145">Асинхронно извлекает объект, который является либо определением класса, либо экземпляром на основе пути к объекту.</span><span class="sxs-lookup"><span data-stu-id="b4e54-145">Asynchronously retrieves an object, that is either a class definition or an instance, based on the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="b4e54-146">**инстанцесоф**</span><span class="sxs-lookup"><span data-stu-id="b4e54-146">**InstancesOf**</span></span>](swbemservices-instancesof.md)                               | <span data-ttu-id="b4e54-147">Извлекает все экземпляры управляемого ресурса на основе имени класса.</span><span class="sxs-lookup"><span data-stu-id="b4e54-147">Retrieves all the instances of a managed resource based on a class name.</span></span> <span data-ttu-id="b4e54-148">По умолчанию [**инстанцесоф**](swbemservices-instancesof.md) выполняет глубокое извлечение.</span><span class="sxs-lookup"><span data-stu-id="b4e54-148">By default, [**InstancesOf**](swbemservices-instancesof.md) performs a deep retrieval.</span></span> <span data-ttu-id="b4e54-149">То есть **инстанцесоф** извлекает экземпляры ресурса, идентифицируемые именем класса, переданного в метод, а также извлекает все экземпляры всех ресурсов, являющихся подклассами (определенные ниже) целевого класса.</span><span class="sxs-lookup"><span data-stu-id="b4e54-149">That is, **InstancesOf** retrieves the instances of the resource identified by the class name passed to the method and also retrieves all the instances of all the resources that are subclasses (defined beneath) of the target class.</span></span><br/>                                                                                       |
| [<span data-ttu-id="b4e54-150">**инстанцесофасинк**</span><span class="sxs-lookup"><span data-stu-id="b4e54-150">**InstancesOfAsync**</span></span>](swbemservices-instancesofasync.md)                     | <span data-ttu-id="b4e54-151">Асинхронно возвращает экземпляры указанного класса в соответствии с заданным пользователем критерием выбора.</span><span class="sxs-lookup"><span data-stu-id="b4e54-151">Asynchronously returns the instances of a specified class according to the user-specified selection criteria.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="b4e54-152">**референцесто**</span><span class="sxs-lookup"><span data-stu-id="b4e54-152">**ReferencesTo**</span></span>](swbemservices-referencesto.md)                             | <span data-ttu-id="b4e54-153">Возвращает все ассоциации, ссылающиеся на указанный ресурс.</span><span class="sxs-lookup"><span data-stu-id="b4e54-153">Returns all of the associations that reference a specified resource.</span></span> <span data-ttu-id="b4e54-154">Лучший способ понять [**референцесто**](swbemservices-referencesto.md) — это сравнить его с методом [**ассоЦиаторсоф**](swbemservices-associatorsof.md) .</span><span class="sxs-lookup"><span data-stu-id="b4e54-154">The best way to understand [**ReferencesTo**](swbemservices-referencesto.md) is to compare it with the [**AssociatorsOf**](swbemservices-associatorsof.md) method.</span></span> <span data-ttu-id="b4e54-155">**АссоЦиаторсоф** возвращает динамические ресурсы, которые находятся на противоположном конце ассоциации.</span><span class="sxs-lookup"><span data-stu-id="b4e54-155">**AssociatorsOf** returns the dynamic resources that are at the opposite end of an association.</span></span> <span data-ttu-id="b4e54-156">**Референцесто** возвращает саму связь.</span><span class="sxs-lookup"><span data-stu-id="b4e54-156">**ReferencesTo** returns the association itself.</span></span> <span data-ttu-id="b4e54-157">Метод **референцесто** выполняет ту же функцию, что и "ссылки" на WQL-запрос.</span><span class="sxs-lookup"><span data-stu-id="b4e54-157">The **ReferencesTo** method performs the same function that the "REFERENCES OF" WQL query performs.</span></span><br/> |
| [<span data-ttu-id="b4e54-158">**референцестоасинк**</span><span class="sxs-lookup"><span data-stu-id="b4e54-158">**ReferencesToAsync**</span></span>](swbemservices-referencesto.md)                        | <span data-ttu-id="b4e54-159">Асинхронно возвращает коллекцию всех классов или экземпляров взаимосвязей, которые ссылаются на конкретный класс или экземпляр.</span><span class="sxs-lookup"><span data-stu-id="b4e54-159">Asynchronously returns a collection of all association classes or instances that refer to a specific class or instance.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="b4e54-160">**субклассесоф**</span><span class="sxs-lookup"><span data-stu-id="b4e54-160">**SubclassesOf**</span></span>](swbemservices-subclassesof.md)                             | <span data-ttu-id="b4e54-161">Извлекает все подклассы указанного класса из репозитория CIM.</span><span class="sxs-lookup"><span data-stu-id="b4e54-161">Retrieves all the subclasses of a specified class from the CIM repository.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="b4e54-162">**субклассесофасинк**</span><span class="sxs-lookup"><span data-stu-id="b4e54-162">**SubclassesOfAsync**</span></span>](swbemservices-subclassesofasync.md)                   | <span data-ttu-id="b4e54-163">Асинхронно возвращает коллекцию подклассов для указанного класса.</span><span class="sxs-lookup"><span data-stu-id="b4e54-163">Asynchronously returns a collection of subclasses for a specified class.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

### <a name="properties"></a><span data-ttu-id="b4e54-164">Свойства</span><span class="sxs-lookup"><span data-stu-id="b4e54-164">Properties</span></span>

<span data-ttu-id="b4e54-165">Объект **SwbemServices** имеет следующие свойства.</span><span class="sxs-lookup"><span data-stu-id="b4e54-165">The **SWbemServices** object has these properties.</span></span>



| <span data-ttu-id="b4e54-166">Свойство</span><span class="sxs-lookup"><span data-stu-id="b4e54-166">Property</span></span>                                                 | <span data-ttu-id="b4e54-167">Тип доступа</span><span class="sxs-lookup"><span data-stu-id="b4e54-167">Access type</span></span>          | <span data-ttu-id="b4e54-168">Описание</span><span class="sxs-lookup"><span data-stu-id="b4e54-168">Description</span></span>                                                                          |
|:---------------------------------------------------------|:---------------------|:-------------------------------------------------------------------------------------|
| [<span data-ttu-id="b4e54-169">**Безопасность\_**</span><span class="sxs-lookup"><span data-stu-id="b4e54-169">**Security\_**</span></span>](swbemservices-security-.md)<br/> | <span data-ttu-id="b4e54-170">Только для чтения</span><span class="sxs-lookup"><span data-stu-id="b4e54-170">Read-only</span></span><br/> | <span data-ttu-id="b4e54-171">Используется для получения или задания параметров безопасности для объекта **SwbemServices** .</span><span class="sxs-lookup"><span data-stu-id="b4e54-171">Used to get or set the security settings for an **SWbemServices** object.</span></span><br/> |



 

## <a name="remarks"></a><span data-ttu-id="b4e54-172">Комментарии</span><span class="sxs-lookup"><span data-stu-id="b4e54-172">Remarks</span></span>

<span data-ttu-id="b4e54-173">Методы могут вызываться либо в синхронном, либо в асинхронном режиме, либо в режиме семисинчронаус.</span><span class="sxs-lookup"><span data-stu-id="b4e54-173">The methods can be called in either the synchronous mode, the asynchronous mode, or the semisynchronous mode.</span></span> <span data-ttu-id="b4e54-174">Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="b4e54-174">For more information see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="b4e54-175">**Обзор**</span><span class="sxs-lookup"><span data-stu-id="b4e54-175">**Overview**</span></span>

<span data-ttu-id="b4e54-176">**SwbemServices** обслуживает две основные роли.</span><span class="sxs-lookup"><span data-stu-id="b4e54-176">**SWbemServices** serves two primary roles.</span></span> <span data-ttu-id="b4e54-177">Сначала объект **SwbemServices** представляет подключение с проверкой подлинности к пространству имен WMI на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="b4e54-177">First, the **SWbemServices** object represents an authenticated connection to a WMI namespace on a target computer.</span></span> <span data-ttu-id="b4e54-178">Во-вторых, **SwbemServices** — это объект автоматизации, используемый для получения ресурсов, управляемых WMI.</span><span class="sxs-lookup"><span data-stu-id="b4e54-178">Second, **SWbemServices** is the Automation object you use to retrieve WMI-managed resources.</span></span> <span data-ttu-id="b4e54-179">Ссылку на объект **SwbemServices** можно получить одним из двух способов:</span><span class="sxs-lookup"><span data-stu-id="b4e54-179">You can obtain a reference to an **SWbemServices** object in either of two ways:</span></span>

-   <span data-ttu-id="b4e54-180">Как показано в большинстве сценариев WMI, представленных до сих пор, можно использовать функцию языка VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) в сочетании с моникером WMI "винмгмтс:".</span><span class="sxs-lookup"><span data-stu-id="b4e54-180">As demonstrated in most of the WMI scripts presented thus far, you can use the VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) function in combination with the WMI moniker "winmgmts:".</span></span> <span data-ttu-id="b4e54-181">В следующем примере показана простейшая форма WMI-соединения.</span><span class="sxs-lookup"><span data-stu-id="b4e54-181">The following example is the simplest form of a WMI connection.</span></span> <span data-ttu-id="b4e54-182">Пример подключается к пространству имен по умолчанию (обычно "root \\ CIMv2") на локальном компьютере:</span><span class="sxs-lookup"><span data-stu-id="b4e54-182">The example connects to the default namespace (typically "Root\\CIMv2") on the local computer:</span></span>

    `Set objSWbemServices = GetObject("winmgmts:")`

-   <span data-ttu-id="b4e54-183">Для получения ссылки на объект **SwbemServices** можно также использовать метод [**коннектсервер**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) объекта [**SWbemLocator**](swbemlocator.md) .</span><span class="sxs-lookup"><span data-stu-id="b4e54-183">You can also use the [**SWbemLocator**](swbemlocator.md) object [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) method to obtain a reference to an **SWbemServices** object.</span></span>

<span data-ttu-id="b4e54-184">После получения ссылки на объект **SwbemServices** используйте ссылку на объект, чтобы вызвать 1 из 18 методов, доступных с помощью **SwbemServices**.</span><span class="sxs-lookup"><span data-stu-id="b4e54-184">After you obtain a reference to an **SWbemServices** object, you use the object reference to call 1 of 18 methods available using **SWbemServices**.</span></span> <span data-ttu-id="b4e54-185">**SwbemServices** может возвращать один из трех различных объектов библиотеки сценариев WMI ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md)или [**свбемевентсаурце**](swbemeventsource.md)) в зависимости от вызываемого метода.</span><span class="sxs-lookup"><span data-stu-id="b4e54-185">**SWbemServices** can return one of three different WMI scripting library objects ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md), or [**SWbemEventSource**](swbemeventsource.md)), depending on the method you call.</span></span> <span data-ttu-id="b4e54-186">Знание типа объекта, возвращаемого каждым методом, поможет определить следующий шаг, который должен быть выполнен сценарием.</span><span class="sxs-lookup"><span data-stu-id="b4e54-186">Knowing the type of object each method returns will help you determine the next step your script must take.</span></span> <span data-ttu-id="b4e54-187">Например, если возвращается **SWbemObjectSet**, необходимо перечислить коллекцию для доступа к каждому **SWbemObject** в коллекции.</span><span class="sxs-lookup"><span data-stu-id="b4e54-187">For example, if you get back an **SWbemObjectSet**, you must enumerate the collection to access each **SWbemObject** in the collection.</span></span> <span data-ttu-id="b4e54-188">При возврате **SWbemObject** можно сразу же получить доступ к методам и свойствам объекта, не перечисляя коллекцию первыми.</span><span class="sxs-lookup"><span data-stu-id="b4e54-188">If you get back an **SWbemObject**, you can immediately access the object methods and properties without enumerating the collection first.</span></span>

<span data-ttu-id="b4e54-189">**Режимы работы**</span><span class="sxs-lookup"><span data-stu-id="b4e54-189">**Modes of Operation**</span></span>

<span data-ttu-id="b4e54-190">**SwbemServices** поддерживает три режима работы: синхронный, асинхронный и семисинчронаус.</span><span class="sxs-lookup"><span data-stu-id="b4e54-190">**SWbemServices** supports three modes of operation: synchronous, asynchronous, and semisynchronous.</span></span>

-   <span data-ttu-id="b4e54-191">**Синхронный**.</span><span class="sxs-lookup"><span data-stu-id="b4e54-191">**Synchronous**.</span></span> <span data-ttu-id="b4e54-192">В синхронном режиме блоки сценария (приостанавливаются) до завершения метода **SwbemServices** .</span><span class="sxs-lookup"><span data-stu-id="b4e54-192">In synchronous mode, your script blocks (pauses) until the **SWbemServices** method completes.</span></span> <span data-ttu-id="b4e54-193">Не только выполняет ожидание сценария, но в случаях, когда инструментарий WMI извлекает экземпляры управляемых ресурсов, Инструментарий WMI создает весь [**SWbemObjectSet**](swbemobjectset.md) в памяти до возвращения первого байта данных вызывающему сценарию.</span><span class="sxs-lookup"><span data-stu-id="b4e54-193">Not only does your script wait, but in cases in which WMI retrieves instances of managed resources, WMI builds the entire [**SWbemObjectSet**](swbemobjectset.md) in memory before the first byte of data is returned to the calling script.</span></span> <span data-ttu-id="b4e54-194">Это может оказать негативное воздействие на производительность скрипта и на компьютере, на котором работает сценарий.</span><span class="sxs-lookup"><span data-stu-id="b4e54-194">This can have an adverse effect on the script performance and on the computer running the script.</span></span> <span data-ttu-id="b4e54-195">Например, синхронное извлечение тысяч событий из журналов событий Windows может занять много времени и использовать большой объем памяти.</span><span class="sxs-lookup"><span data-stu-id="b4e54-195">For example, synchronously retrieving thousands of events from the Windows Event Logs can take a long time and use a lot of memory.</span></span> <span data-ttu-id="b4e54-196">По этим причинам синхронные операции не рекомендуются, за исключением трех методов ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md)и [**Get**](swbemservices-get.md)), которые по умолчанию являются синхронными.</span><span class="sxs-lookup"><span data-stu-id="b4e54-196">For these reasons, synchronous operations are not recommended except for the three methods ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), and [**Get**](swbemservices-get.md)) that are synchronous by default.</span></span> <span data-ttu-id="b4e54-197">Эти методы не возвращают большие наборы данных, поэтому операция семисинчронаус не требуется.</span><span class="sxs-lookup"><span data-stu-id="b4e54-197">These methods do not return large data sets, so semisynchronous operation is not required.</span></span>
-   <span data-ttu-id="b4e54-198">**Асинхронный**.</span><span class="sxs-lookup"><span data-stu-id="b4e54-198">**Asynchronous**.</span></span> <span data-ttu-id="b4e54-199">В асинхронном режиме скрипт вызывает один из девяти асинхронных методов и немедленно возвращает результат.</span><span class="sxs-lookup"><span data-stu-id="b4e54-199">In asynchronous mode, your script calls one of the nine asynchronous methods and returns immediately.</span></span> <span data-ttu-id="b4e54-200">То есть, как только вызывается асинхронный метод, сценарий возобновляет выполнение следующей строки кода.</span><span class="sxs-lookup"><span data-stu-id="b4e54-200">That is, as soon as the asynchronous method is called, your script resumes running the next line of code.</span></span> <span data-ttu-id="b4e54-201">Чтобы использовать асинхронный метод, сценарий должен сначала создать объект [**свбемсинк**](swbemsink.md) и специальную подпрограммы, называемую обработчиком событий.</span><span class="sxs-lookup"><span data-stu-id="b4e54-201">To use an asynchronous method, your script must first create an [**SWbemSink**](swbemsink.md) object and a special subroutine called an event handler.</span></span> <span data-ttu-id="b4e54-202">Инструментарий WMI выполняет асинхронную операцию и уведомляет скрипт, вызывая подпрограммы обработчика событий после завершения операции.</span><span class="sxs-lookup"><span data-stu-id="b4e54-202">WMI performs the asynchronous operation and notifies the script by calling the event handler subroutine when the operation is complete.</span></span>
-   <span data-ttu-id="b4e54-203">**Семисинчронаус**.</span><span class="sxs-lookup"><span data-stu-id="b4e54-203">**Semisynchronous**.</span></span> <span data-ttu-id="b4e54-204">Режим семисинчронаус является компромиссом между синхронным и асинхронным.</span><span class="sxs-lookup"><span data-stu-id="b4e54-204">Semisynchronous mode is a compromise between synchronous and asynchronous.</span></span> <span data-ttu-id="b4e54-205">Операции семисинчронаус обеспечивают лучшую производительность, чем синхронные операции, но они не требуют дополнительных знаний и шагов сценариев, необходимых для выполнения асинхронных операций.</span><span class="sxs-lookup"><span data-stu-id="b4e54-205">Semisynchronous operations offer better performance than synchronous operations, yet they do not require the extra knowledge and scripting steps necessary to handle asynchronous operations.</span></span> <span data-ttu-id="b4e54-206">Это тип операции по умолчанию для большинства запросов WMI.</span><span class="sxs-lookup"><span data-stu-id="b4e54-206">This is the default operation type for most WMI queries.</span></span>

    <span data-ttu-id="b4e54-207">В режиме семисинчронаус сценарий вызывает один из шести методов извлечения данных и немедленно возвращает результат.</span><span class="sxs-lookup"><span data-stu-id="b4e54-207">In semisynchronous mode, your script calls one of the six data retrieval methods and returns immediately.</span></span> <span data-ttu-id="b4e54-208">Инструментарий WMI извлекает управляемые ресурсы в фоновом режиме по мере продолжения выполнения скрипта.</span><span class="sxs-lookup"><span data-stu-id="b4e54-208">WMI retrieves the managed resources in the background as your script continues to run.</span></span> <span data-ttu-id="b4e54-209">По мере извлечения ресурсов они немедленно возвращаются в скрипт с помощью SWbemObjectSet.</span><span class="sxs-lookup"><span data-stu-id="b4e54-209">As the resources are retrieved, they are immediately returned to your script by way of an SWbemObjectSet.</span></span> <span data-ttu-id="b4e54-210">Вы можете начать доступ к управляемым ресурсам, не дожидаясь сборки всей коллекции.</span><span class="sxs-lookup"><span data-stu-id="b4e54-210">You can begin to access the managed resources without waiting for the entire collection to be assembled.</span></span>

    <span data-ttu-id="b4e54-211">При работе с управляемыми ресурсами, имеющими много экземпляров (множество значений больше 1 000), таких как [**CIM- \_ файл**](/windows/desktop/CIMWin32Prov/cim-datafile) и [**Win32 \_ нтложевент**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent), следует заменять семисинчронаус операции.</span><span class="sxs-lookup"><span data-stu-id="b4e54-211">There is a caveat to semisynchronous operations when you are working with managed resources that have many instances (many meaning greater than 1,000), such as [**CIM\_DataFile**](/windows/desktop/CIMWin32Prov/cim-datafile) and [**Win32\_NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).</span></span> <span data-ttu-id="b4e54-212">Предостережение является следствием того, как инструментарий WMI обрабатывает экземпляры управляемых ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b4e54-212">The caveat is a result of how WMI handles instances of managed resources.</span></span> <span data-ttu-id="b4e54-213">Для каждого экземпляра управляемого ресурса Инструментарий WMI создает и кэширует объект [**SWbemObject**](swbemobject.md) .</span><span class="sxs-lookup"><span data-stu-id="b4e54-213">For each instance of a managed resource, WMI creates and caches an [**SWbemObject**](swbemobject.md) object.</span></span> <span data-ttu-id="b4e54-214">Если для управляемого ресурса существует большое количество экземпляров, извлечение экземпляра может захватить доступные ресурсы, уменьшая производительность как сценария, так и компьютера.</span><span class="sxs-lookup"><span data-stu-id="b4e54-214">When a large number of instances exist for a managed resource, instance retrieval can monopolize available resources, reducing the performance of both the script and the computer.</span></span>

    <span data-ttu-id="b4e54-215">Чтобы обойти эту проблему, можно оптимизировать вызовы методов семисинчронаус с помощью флага **вбемфлагфорвардонли** .</span><span class="sxs-lookup"><span data-stu-id="b4e54-215">To work around the problem, you can optimize semisynchronous method calls using the **wbemFlagForwardOnly** flag.</span></span> <span data-ttu-id="b4e54-216">Флаг **вбемфлагфорвардонли** в сочетании с флагом **вбемфлагретурниммедиатели** (установленным по умолчанию флагом семисинчронаус) сообщает инструментарию WMI, что он возвращает только однонаправленную [**SWbemObjectSet**](swbemobjectset.md), что устраняет проблему с производительностью больших наборов данных.</span><span class="sxs-lookup"><span data-stu-id="b4e54-216">The **wbemFlagForwardOnly** flag, combined with the **wbemFlagReturnImmediately** flag (the default semisynchronous flag), tells WMI to return a forward-only [**SWbemObjectSet**](swbemobjectset.md), which eliminates the large data set performance problem.</span></span> <span data-ttu-id="b4e54-217">Однако использование флага **вбемфлагфорвардонли** сопровождается ценой.</span><span class="sxs-lookup"><span data-stu-id="b4e54-217">However, using the **wbemFlagForwardOnly** flag comes with a cost.</span></span> <span data-ttu-id="b4e54-218">Однопроходный **SWbemObjectSet** можно перечислить только один раз.</span><span class="sxs-lookup"><span data-stu-id="b4e54-218">A forward-only **SWbemObjectSet** can be enumerated only once.</span></span> <span data-ttu-id="b4e54-219">После доступа к каждому [**SWbemObjectу**](swbemobject.md) в однонаправленном **SWbemObjectSet** освобождается память, выделенная для экземпляра.</span><span class="sxs-lookup"><span data-stu-id="b4e54-219">After each [**SWbemObject**](swbemobject.md) in a forward-only **SWbemObjectSet** is accessed, the memory allocated to the instance is released.</span></span>

<span data-ttu-id="b4e54-220">За исключением асинхронных методов [**удаления**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md)и девяти, семисинчронаус является предпочтительным и рекомендуемым режимом работы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b4e54-220">With the exception of the [**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md), and nine asynchronous methods, semisynchronous is the default and recommended mode of operation.</span></span>

<span data-ttu-id="b4e54-221">**Часто используемые методы**</span><span class="sxs-lookup"><span data-stu-id="b4e54-221">**Commonly-used Methods**</span></span>

<span data-ttu-id="b4e54-222">Чаще всего в сценариях администрирования системы используются методы [**инстанцесоф**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md)и [**ексекнотификатионкуери**](swbemservices-execnotificationquery.md).</span><span class="sxs-lookup"><span data-stu-id="b4e54-222">The methods most often used in system administration scripts are [**InstancesOf**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md), and [**ExecNotificationQuery**](swbemservices-execnotificationquery.md).</span></span> <span data-ttu-id="b4e54-223">Хотя часто используется, **инстанцесоф** не обязательно является рекомендуемым способом получения информации (хотя это, вероятно, самый простой способ).</span><span class="sxs-lookup"><span data-stu-id="b4e54-223">Although often used, **InstancesOf** is not necessarily the recommended way to retrieve information (although it is arguably the easiest way).</span></span>

## <a name="requirements"></a><span data-ttu-id="b4e54-224">Требования</span><span class="sxs-lookup"><span data-stu-id="b4e54-224">Requirements</span></span>



| <span data-ttu-id="b4e54-225">Требование</span><span class="sxs-lookup"><span data-stu-id="b4e54-225">Requirement</span></span> | <span data-ttu-id="b4e54-226">Значение</span><span class="sxs-lookup"><span data-stu-id="b4e54-226">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="b4e54-227">Минимальная версия клиента</span><span class="sxs-lookup"><span data-stu-id="b4e54-227">Minimum supported client</span></span><br/> | <span data-ttu-id="b4e54-228">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="b4e54-228">Windows Vista</span></span><br/>                                                                |
| <span data-ttu-id="b4e54-229">Минимальная версия сервера</span><span class="sxs-lookup"><span data-stu-id="b4e54-229">Minimum supported server</span></span><br/> | <span data-ttu-id="b4e54-230">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="b4e54-230">Windows Server 2008</span></span><br/>                                                          |
| <span data-ttu-id="b4e54-231">Header</span><span class="sxs-lookup"><span data-stu-id="b4e54-231">Header</span></span><br/>                   | <dl> <span data-ttu-id="b4e54-232"><dt>Wbemdisp. h</dt></span><span class="sxs-lookup"><span data-stu-id="b4e54-232"><dt>Wbemdisp.h</dt></span></span> </dl>   |
| <span data-ttu-id="b4e54-233">Библиотека типов</span><span class="sxs-lookup"><span data-stu-id="b4e54-233">Type library</span></span><br/>             | <dl> <span data-ttu-id="b4e54-234"><dt>Wbemdisp. tlb</dt></span><span class="sxs-lookup"><span data-stu-id="b4e54-234"><dt>Wbemdisp.tlb</dt></span></span> </dl> |
| <span data-ttu-id="b4e54-235">DLL</span><span class="sxs-lookup"><span data-stu-id="b4e54-235">DLL</span></span><br/>                      | <dl> <span data-ttu-id="b4e54-236"><dt>Wbemdisp.dll</dt></span><span class="sxs-lookup"><span data-stu-id="b4e54-236"><dt>Wbemdisp.dll</dt></span></span> </dl> |
| <span data-ttu-id="b4e54-237">CLSID</span><span class="sxs-lookup"><span data-stu-id="b4e54-237">CLSID</span></span><br/>                    | <span data-ttu-id="b4e54-238">\_SWBEMSERVICES CLSID</span><span class="sxs-lookup"><span data-stu-id="b4e54-238">CLSID\_SWbemServices</span></span><br/>                                                         |
| <span data-ttu-id="b4e54-239">IID</span><span class="sxs-lookup"><span data-stu-id="b4e54-239">IID</span></span><br/>                      | <span data-ttu-id="b4e54-240">IID \_ исвбемсервицес</span><span class="sxs-lookup"><span data-stu-id="b4e54-240">IID\_ISWbemServices</span></span><br/>                                                          |



## <a name="see-also"></a><span data-ttu-id="b4e54-241">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="b4e54-241">See also</span></span>

<dl> <dt>

[<span data-ttu-id="b4e54-242">Создание скриптов для объектов API</span><span class="sxs-lookup"><span data-stu-id="b4e54-242">Scripting API Objects</span></span>](scripting-api-objects.md)
</dt> <dt>

[<span data-ttu-id="b4e54-243">Вызов метода</span><span class="sxs-lookup"><span data-stu-id="b4e54-243">Calling a Method</span></span>](calling-a-method.md)
</dt> </dl>

 

