---
description: Свойства в классах WMI описывают данные об управляемом объекте.
ms.assetid: 4046bfc7-9528-4737-ad61-bbb8419d0b51
ms.tgt_platform: multiple
title: Добавление свойства WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bba8944da155ca250edfed0c6e9160f555ba9551
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105712774"
---
# <a name="adding-a-wmi-property"></a><span data-ttu-id="21961-103">Добавление свойства WMI</span><span class="sxs-lookup"><span data-stu-id="21961-103">Adding a WMI Property</span></span>

<span data-ttu-id="21961-104">Свойства в классах WMI описывают данные об управляемом объекте.</span><span class="sxs-lookup"><span data-stu-id="21961-104">Properties in WMI classes describe data about a managed object.</span></span> <span data-ttu-id="21961-105">Например, **Handle**, **ProcessID** и **пажефаултс** определяются как свойства класса [**\_ процесса Win32**](/windows/desktop/CIMWin32Prov/win32-process) и описывают аспекты процесса операционной системы.</span><span class="sxs-lookup"><span data-stu-id="21961-105">For example, **Handle**, **ProcessId**, and **PageFaults** are defined as properties of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class and describe aspects of an operating system process.</span></span> <span data-ttu-id="21961-106">Дополнительные сведения см. [в разделе Написание поставщика свойств](writing-a-property-provider.md).</span><span class="sxs-lookup"><span data-stu-id="21961-106">For more information, see [Writing a Property Provider](writing-a-property-provider.md).</span></span>

## <a name="defining-a-property-in-mof"></a><span data-ttu-id="21961-107">Определение свойства в MOF</span><span class="sxs-lookup"><span data-stu-id="21961-107">Defining a Property in MOF</span></span>

<span data-ttu-id="21961-108">Свойство WMI представляет аспект или состояние в объекте.</span><span class="sxs-lookup"><span data-stu-id="21961-108">A WMI property represents an aspect or state in the object.</span></span> <span data-ttu-id="21961-109">Вместо создания методов, которые просто получают и задают значение, можно создать свойство.</span><span class="sxs-lookup"><span data-stu-id="21961-109">Rather than create methods that simply get and set a value, you can create a property.</span></span> <span data-ttu-id="21961-110">Например, свойство **NetEnabled** объекта [**Win32 \_ сетевого адаптера**](/windows/desktop/CIMWin32Prov/win32-networkadapter) показывает, включено или отключено состояние адаптера.</span><span class="sxs-lookup"><span data-stu-id="21961-110">For example, the **NetEnabled** property of [**Win32\_NetworkAdapter**](/windows/desktop/CIMWin32Prov/win32-networkadapter) displays whether the state of the adapter is enabled or disabled.</span></span> <span data-ttu-id="21961-111">Однако методы [**включения**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) и [**отключения**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) фактически выполняют действие по изменению состояния адаптера.</span><span class="sxs-lookup"><span data-stu-id="21961-111">However, the [**Enable**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) and [**Disable**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) methods actually perform the action of changing the adapter state.</span></span>

<span data-ttu-id="21961-112">Свойство должно иметь тип данных.</span><span class="sxs-lookup"><span data-stu-id="21961-112">A property must have a data type.</span></span> <span data-ttu-id="21961-113">Тип данных **маркера** свойства [**\_ процесса Win32**](/windows/desktop/CIMWin32Prov/win32-process) — **String** , а тип данных **пажефаултс** — **UInt32**.</span><span class="sxs-lookup"><span data-stu-id="21961-113">The data type of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) property **Handle** is **string** and the data type of **PageFaults** is **uint32**.</span></span> <span data-ttu-id="21961-114">Если свойство может иметь только два состояния, то для типа данных свойства обычно устанавливается **значение Boolean**.</span><span class="sxs-lookup"><span data-stu-id="21961-114">If a property can have only two states, the data type of the property is normally set to **boolean**.</span></span>

<span data-ttu-id="21961-115">Свойство также может быть массивом.</span><span class="sxs-lookup"><span data-stu-id="21961-115">The property may also be an array.</span></span> <span data-ttu-id="21961-116">Например, свойство идентификатора безопасности (**SID**) [**\_ доверенного лица Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) представляет собой массив байтов (**Uint8**), который содержит идентификатор безопасности.</span><span class="sxs-lookup"><span data-stu-id="21961-116">For example, the security identifier (**SID**) property of [**Win32\_Trustee**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) is a byte array (**uint8**) that contains the SID.</span></span> <span data-ttu-id="21961-117">Свойства могут содержать внедренные объекты, которые являются ссылками на один или несколько экземпляров другого класса WMI.</span><span class="sxs-lookup"><span data-stu-id="21961-117">Properties can contain embedded objects which are references to one or more instances of another WMI class.</span></span> <span data-ttu-id="21961-118">Например, список управления доступом на уровне пользователей **(DACL)** и свойства системного списка управления доступом **(SACL)** для [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor)являются массивами объектов [**\_ ACE Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) , описывающих группы и учетные записи, имеющие доступ.</span><span class="sxs-lookup"><span data-stu-id="21961-118">The discretionary access control list **(DACL)** and system access control list **(SACL)** properties of [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), for example, are arrays of [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) objects that describe the groups and accounts that have access.</span></span> <span data-ttu-id="21961-119">Свойство **Group** в **Win32 \_ SecurityDescriptor** содержит ссылку на один экземпляр **\_ доверенного лица Win32**.</span><span class="sxs-lookup"><span data-stu-id="21961-119">The **Group** property in **Win32\_SecurityDescriptor** contains a reference to a single instance of **Win32\_Trustee**.</span></span> <span data-ttu-id="21961-120">Дополнительные сведения см. [в разделе внедрение объектов в класс](embedded-objects.md).</span><span class="sxs-lookup"><span data-stu-id="21961-120">For more information, see [Embedding Objects in a Class](embedded-objects.md).</span></span>

<span data-ttu-id="21961-121">Свойство может иметь несколько [*квалификаторов*](gloss-q.md).</span><span class="sxs-lookup"><span data-stu-id="21961-121">A property may have several [*qualifiers*](gloss-q.md).</span></span> <span data-ttu-id="21961-122">Эти [Квалификаторы](wmi-qualifiers.md) могут быть [*модель CIM (CIM)*](gloss-c.md) или квалификаторы WMI или могут быть специфичными для определенных типов классов, например квалификаторов класса [счетчика производительности](qualifiers-specific-to-wmi-performance-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="21961-122">These [qualifiers](wmi-qualifiers.md) may be [*Common Information Model (CIM)*](gloss-c.md) or WMI qualifiers or may be specific to certain types of classes, for example, the [performance Counter](qualifiers-specific-to-wmi-performance-classes.md) class qualifiers.</span></span> <span data-ttu-id="21961-123">Квалификаторы задают определенный аспект свойства, например, если он доступен только для чтения или не может быть изменен без особых привилегий.</span><span class="sxs-lookup"><span data-stu-id="21961-123">Qualifiers specify some aspect of the property, such as if it is read-only or if it cannot be changed without a specific privilege.</span></span> <span data-ttu-id="21961-124">Например, приложению, которое пытается выполнить запись в свойство **DACL** [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), требуются права **SeSecurityPrivilege** и **сересторепривилеже**.</span><span class="sxs-lookup"><span data-stu-id="21961-124">An application which attempts to write to the [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor)**DACL** property, for example, requires the privileges **SeSecurityPrivilege** and **SeRestorePrivilege**.</span></span> <span data-ttu-id="21961-125">Дополнительные сведения см. [в разделе Добавление квалификатора](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="21961-125">For more information, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

<span data-ttu-id="21961-126">Наконец, свойство должно иметь имя.</span><span class="sxs-lookup"><span data-stu-id="21961-126">Finally, a property must have a name.</span></span> <span data-ttu-id="21961-127">Вы можете назвать свойство любым из границ стандартной практики программирования.</span><span class="sxs-lookup"><span data-stu-id="21961-127">You may name a property anything within the bounds of standard programming practice.</span></span> <span data-ttu-id="21961-128">Однако существует два основных исключения.</span><span class="sxs-lookup"><span data-stu-id="21961-128">However, there are two main exceptions.</span></span> <span data-ttu-id="21961-129">Во-первых, вы не можете использовать любое ключевое слово MOF, например "class", в качестве имени свойства.</span><span class="sxs-lookup"><span data-stu-id="21961-129">First, you may not use any MOF keyword, such as "class", as a property name.</span></span> <span data-ttu-id="21961-130">Во-вторых, нельзя использовать ключевые слова WQL, например "Group", в качестве имени свойства.</span><span class="sxs-lookup"><span data-stu-id="21961-130">Second, you may not use any WQL keywords, such as "group", as a property name either.</span></span> <span data-ttu-id="21961-131">Дополнительные сведения о ключевых словах MOF и WQL см. в разделе [типы данных MOF](mof-data-types.md) и [WQL (SQL для WMI)](wql-sql-for-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="21961-131">For more information on MOF and WQL keywords, see [MOF Data Types](mof-data-types.md) and [WQL (SQL for WMI)](wql-sql-for-wmi.md).</span></span>

<span data-ttu-id="21961-132">Для кода C++ и MOF-файл (MOF) можно объявить свойства класса одновременно с объявлением класса.</span><span class="sxs-lookup"><span data-stu-id="21961-132">For both C++ and Managed Object Format (MOF) code, you declare the properties of a class at the same time that you declare the class.</span></span>

<span data-ttu-id="21961-133">**Определение свойства**</span><span class="sxs-lookup"><span data-stu-id="21961-133">**To define a property**</span></span>

-   <span data-ttu-id="21961-134">Включите тип данных свойства, имя и необязательное значение по умолчанию и квалификатор между фигурными скобками в описании класса.</span><span class="sxs-lookup"><span data-stu-id="21961-134">Include the property data type, name, and an optional default value and qualifier between the curly braces of the class description.</span></span>

    ``` syntax
    class MyClass 
    {
        [key] string   strProp;
        sint32         dwProp1 = 21;
        uint32         dwProp2;
    };
    ```

    <span data-ttu-id="21961-135">Класс MyClass в предыдущем примере имеет три свойства: строку символов, 32-разрядное целое число со знаком и 32-разрядное целое число без знака.</span><span class="sxs-lookup"><span data-stu-id="21961-135">The MyClass class in the preceding example has three properties: a character string, a 32-bit signed integer, and a 32-bit unsigned integer.</span></span> <span data-ttu-id="21961-136">Каждому свойству присваивается имя, не учитывающее регистр, и тип данных MOF.</span><span class="sxs-lookup"><span data-stu-id="21961-136">Each property is assigned a case-insensitive name and a MOF data type.</span></span>

    <span data-ttu-id="21961-137">Квалификатор [**ключа**](key-qualifier.md) определяет строковое свойство в качестве ключевого свойства, уникально идентифицирующего экземпляр класса.</span><span class="sxs-lookup"><span data-stu-id="21961-137">The [**Key**](key-qualifier.md) qualifier defines the string property as the key property that uniquely identifies an instance of the class.</span></span> <span data-ttu-id="21961-138">Дополнительные сведения об квалификаторах см. [в разделе Добавление квалификатора](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="21961-138">For more information about qualifiers, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="21961-139">См. также</span><span class="sxs-lookup"><span data-stu-id="21961-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="21961-140">Создание класса</span><span class="sxs-lookup"><span data-stu-id="21961-140">Creating a Class</span></span>](creating-a-class.md)
</dt> </dl>

 

 
