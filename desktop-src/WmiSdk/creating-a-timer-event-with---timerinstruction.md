---
description: Событие таймера создается путем создания экземпляра классов, производных от \_ \_ класса тимеринструктион в любом пространстве имен WMI.
ms.assetid: 3df2a75a-5231-40d7-ae9d-a7a735fbf316
ms.tgt_platform: multiple
title: Создание события таймера с __TimerInstruction
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e502678525569dae272edb7b03c0916db25edfd0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272228"
---
# <a name="creating-a-timer-event-with-__timerinstruction"></a><span data-ttu-id="2053e-103">Создание события таймера с помощью \_ \_ тимеринструктион</span><span class="sxs-lookup"><span data-stu-id="2053e-103">Creating a Timer Event with \_\_TimerInstruction</span></span>

<span data-ttu-id="2053e-104">Событие таймера создается путем создания экземпляра классов, производных от класса [**\_ \_ тимеринструктион**](--timerinstruction.md) в любом пространстве имен WMI.</span><span class="sxs-lookup"><span data-stu-id="2053e-104">You create a timer event by creating an instance of classes derived from the [**\_\_TimerInstruction**](--timerinstruction.md) class in any WMI namespace.</span></span> <span data-ttu-id="2053e-105">Затем Инструментарий WMI создает событие таймера в соответствующее время.</span><span class="sxs-lookup"><span data-stu-id="2053e-105">WMI then generates the timer event at the appropriate time.</span></span> <span data-ttu-id="2053e-106">Если вы пропустили событие таймера из-за простоя компьютера, Инструментарий WMI сообщит о пропущенном событии.</span><span class="sxs-lookup"><span data-stu-id="2053e-106">If you miss a timer event due to computer downtime, WMI notifies you about the missed event.</span></span> <span data-ttu-id="2053e-107">Инструментарий WMI поддерживает события таймера для обеспечения обратной совместимости и в тех случаях, когда необходимо выяснить, сколько событий было пропущено с момента последнего доставленного события.</span><span class="sxs-lookup"><span data-stu-id="2053e-107">WMI supports timer events for backward compatibility and for scenarios where you must know how many events you have missed since the last delivered event.</span></span> <span data-ttu-id="2053e-108">Однако для большинства событий таймера следует создать фильтр событий для [**Win32 \_ localtime**](/previous-versions/windows/desktop/wmitimepprov/win32-localtime) или [**Win32 \_ утктиме**](/previous-versions/windows/desktop/wmitimepprov/win32-utctime).</span><span class="sxs-lookup"><span data-stu-id="2053e-108">For most timer events, however, you should create an event filter for [**Win32\_LocalTime**](/previous-versions/windows/desktop/wmitimepprov/win32-localtime) or [**Win32\_UTCTime**](/previous-versions/windows/desktop/wmitimepprov/win32-utctime).</span></span> <span data-ttu-id="2053e-109">Дополнительные сведения см. в разделе [Создание события таймера с помощью Win32 \_ LocalTime или Win32 \_ утктиме](creating-a-timer-event-with-win32-localtime-or-win32-utctime.md).</span><span class="sxs-lookup"><span data-stu-id="2053e-109">For more information, see [Creating a Timer Event with Win32\_LocalTime or Win32\_UTCTime](creating-a-timer-event-with-win32-localtime-or-win32-utctime.md).</span></span>

<span data-ttu-id="2053e-110">В следующей процедуре описывается создание и получение события таймера с помощью \_ \_ тимеринструктион.</span><span class="sxs-lookup"><span data-stu-id="2053e-110">The following procedure describes how to create and receive a timer event with \_\_TimerInstruction.</span></span>

<span data-ttu-id="2053e-111">**Создание и получение события таймера с помощью \_ \_ тимеринструктион**</span><span class="sxs-lookup"><span data-stu-id="2053e-111">**To create and receive a timer event with \_\_TimerInstruction**</span></span>

1.  <span data-ttu-id="2053e-112">Создайте экземпляр классов [**\_ \_ абсолутетимеринструктион**](--absolutetimerinstruction.md) или [**\_ \_ интервалтимеринструктион**](--intervaltimerinstruction.md) .</span><span class="sxs-lookup"><span data-stu-id="2053e-112">Create an instance of the [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) or [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) classes.</span></span>

    <span data-ttu-id="2053e-113">Классы [**\_ \_ абсолутетимеринструктион**](--absolutetimerinstruction.md) и [**\_ \_ интервалтимеринструктион**](--intervaltimerinstruction.md) являются производными от класса [**\_ \_ тимеринструктион**](--timerinstruction.md) , который содержит уникальную строку, назначенную разработчиком, которая определяет тип события таймера.</span><span class="sxs-lookup"><span data-stu-id="2053e-113">The [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) and [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) classes are derived from the [**\_\_TimerInstruction**](--timerinstruction.md) class, which contains a unique developer-assigned string that identifies the type of timer event.</span></span> <span data-ttu-id="2053e-114">Класс **\_ \_ тимеринструктион** также содержит значение, указывающее, должен ли Инструментарий WMI отправить уведомление белатед, если событие Timer возникает при недоступности инструментария WMI.</span><span class="sxs-lookup"><span data-stu-id="2053e-114">The **\_\_TimerInstruction** class also contains a value that specifies whether WMI should send a belated notification if the timer event occurs when WMI is unavailable.</span></span>

    <span data-ttu-id="2053e-115">Используйте [**\_ \_ абсолутетимеринструктион**](--absolutetimerinstruction.md) для отправки абсолютных событий таймера, которые происходят в указанную дату в определенное время.</span><span class="sxs-lookup"><span data-stu-id="2053e-115">Use [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) to send absolute timer events, which occur on a specific date at a specific time.</span></span> <span data-ttu-id="2053e-116">Используйте [**\_ \_ интервалтимеринструктион**](--intervaltimerinstruction.md) для отправки событий интервала таймера, которые происходят на регулярной основе.</span><span class="sxs-lookup"><span data-stu-id="2053e-116">Use [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) to send interval timer events, which occur on a regular basis.</span></span>

2.  <span data-ttu-id="2053e-117">Настройте приложение для получения экземпляра [**\_ \_ тимеревент**](--timerevent.md) .</span><span class="sxs-lookup"><span data-stu-id="2053e-117">Set your application to receive a [**\_\_TimerEvent**](--timerevent.md) instance.</span></span>

    <span data-ttu-id="2053e-118">Чтобы создать событие, WMI создает экземпляр класса [**\_ \_ тимеревент**](--timerevent.md) и пересылает экземпляр потребителю.</span><span class="sxs-lookup"><span data-stu-id="2053e-118">To generate an event, WMI creates an instance of the [**\_\_TimerEvent**](--timerevent.md) class and forwards the instance to your consumer.</span></span> <span data-ttu-id="2053e-119">Экземпляр **\_ \_ тимеревент** содержит идентификатор инструкции таймера от потребителя.</span><span class="sxs-lookup"><span data-stu-id="2053e-119">The **\_\_TimerEvent** instance contains the timer instruction identifier from the consumer.</span></span> <span data-ttu-id="2053e-120">Экземпляр также содержит значение, указывающее, сколько раз WMI должен отправить уведомление о событии таймера в течение любого интервала, когда WMI не может связаться с потребителем.</span><span class="sxs-lookup"><span data-stu-id="2053e-120">The instance also contains a value that specifies how many times WMI should send the timer event notification during any interval when WMI cannot reach the consumer.</span></span>

 

 
