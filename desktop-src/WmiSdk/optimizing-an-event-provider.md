---
description: Поставщик событий может посвятить много времени созданию событий.
ms.assetid: 5cf414f0-b3a8-4623-9aaa-08e2a28b40c0
ms.tgt_platform: multiple
title: Оптимизация поставщика событий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 613fa6b054f979d0f7d1a33a87f927df9ef129a280cf7cd1675cbe0cf9818473
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117923411"
---
# <a name="optimizing-an-event-provider"></a>Оптимизация поставщика событий

Поставщик событий может посвятить много времени созданию событий. Если ни одно из клиентских приложений не использует созданные события, поставщик затратит системные ресурсы. Кроме того, Инструментарий WMI тратит значительный объем ресурсов на синтаксический анализ и отправку сложных запросов соответствующему поставщику. Чтобы избежать траты системных ресурсов и повышения производительности поставщика событий, можно реализовать интерфейс [**ивбемевентпровидеркуерисинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) . **Ивбемевентпровидеркуерисинк** отслеживает запросы, регистрируемые клиентскими приложениями в WMI с помощью методов [**невкуери**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) и [**канцелкуери**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) . Отслеживая зарегистрированные запросы клиентов, поставщик может определить, какие сообщения должны отправляться в WMI.

Инструментарий WMI вызывает [**невкуери**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) в поставщике событий, когда потребитель клиента регистрирует запрос фильтра событий, содержащий ссылки на события, поддерживаемые этим поставщиком событий. Поэтому поставщик событий, ответственный за события изменения экземпляра для класса **емаилкласс** , можно настроить для создания уведомлений только для **отправителя**. Когда поставщик получает запрос, запрашивающий уведомления об изменениях свойства **subject** , поставщик может приступить к формированию этих уведомлений. В этом сценарии Инструментарий WMI не требуется для отмены уведомлений, которые только изменяют **получатель** отчета.

Аналогичным образом, Инструментарий WMI вызывает [**канцелкуери**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) в поставщике событий, когда потребитель клиента отменяет регистрацию запроса фильтра событий, содержащего ссылки на события, поддерживаемые поставщиком событий. Целью **канцелкуери** является то, что поставщик событий обновляет список событий, которые должны быть отправлены.

> [!Note]  
> Если поставщик поддерживает как [**ивбемевентпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) , так и [**ивбемевентпровидеркуерисинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), убедитесь, что реализация метода **IUnknown:: QueryInterface** Возвращает указатели на оба интерфейса.

 

 

 



