---
description: Поставщик WDM (WDM) предоставляет доступ к классам, экземплярам, методам и событиям драйверов оборудования, которые соответствуют модели WDM.
ms.assetid: 8686a613-0e53-4e6e-b193-7839abfb70de
ms.tgt_platform: multiple
title: Доступ к данным из драйверов устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72a59b59116ca0f71178fb2faed290d6bc76c9d6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105703317"
---
# <a name="accessing-data-from-device-drivers"></a><span data-ttu-id="35724-103">Доступ к данным из драйверов устройств</span><span class="sxs-lookup"><span data-stu-id="35724-103">Accessing Data from Device Drivers</span></span>

<span data-ttu-id="35724-104">Поставщик WDM (WDM) предоставляет доступ к классам, экземплярам, методам и событиям драйверов оборудования, которые соответствуют модели WDM.</span><span class="sxs-lookup"><span data-stu-id="35724-104">The Windows Driver Model (WDM) provider grants access to the classes, instances, methods, and events of hardware drivers that conform to the WDM model.</span></span> <span data-ttu-id="35724-105">Классы для драйверов оборудования находятся в \\ \\ корневом \\ пространстве имен WMI.</span><span class="sxs-lookup"><span data-stu-id="35724-105">The classes for hardware drivers reside in the \\\\root\\wmi namespace.</span></span>

<span data-ttu-id="35724-106">Поставщик WDM представляет интерес для тех, кто записывает драйверы устройств и администраторам, заинтересованным в данных драйвера устройства.</span><span class="sxs-lookup"><span data-stu-id="35724-106">The WDM provider is of interest to those who write device drivers and to administrators who are interested in device driver data.</span></span>

<span data-ttu-id="35724-107">В этом разделе обсуждаются следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="35724-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="35724-108">Сведения для модулей записи драйверов устройств</span><span class="sxs-lookup"><span data-stu-id="35724-108">Information for Device Driver Writers</span></span>](#information-for-device-driver-writers)
-   [<span data-ttu-id="35724-109">Сведения для администраторов и пользователей данных драйвера</span><span class="sxs-lookup"><span data-stu-id="35724-109">Information for Administrators and Users of Driver Data</span></span>](#information-for-administrators-and-users-of-driver-data)
-   [<span data-ttu-id="35724-110">См. также</span><span class="sxs-lookup"><span data-stu-id="35724-110">Related topics</span></span>](#related-topics)

## <a name="information-for-device-driver-writers"></a><span data-ttu-id="35724-111">Сведения для модулей записи драйверов устройств</span><span class="sxs-lookup"><span data-stu-id="35724-111">Information for Device Driver Writers</span></span>

<span data-ttu-id="35724-112">Классы WMI, связанные с конкретным драйвером устройства, создаются, когда поставщик WDM извлекает двоичный MOF-файл из исполняемого файла драйвера устройства.</span><span class="sxs-lookup"><span data-stu-id="35724-112">WMI classes related to a specific device driver are created when the WDM provider extracts the binary MOF from the device driver executable file.</span></span> <span data-ttu-id="35724-113">Это происходит при каждом запуске WMI, установке нового драйвера устройства или удалении экземпляра [вмибинаримофресаурце](/windows/desktop/WmiCoreProv/wmibinarymofresource) для конкретного драйвера.</span><span class="sxs-lookup"><span data-stu-id="35724-113">This takes place whenever WMI is started, a new device driver is installed, or the instance of [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) for a particular driver is deleted.</span></span> <span data-ttu-id="35724-114">Путем проверки Вмипров. log можно определить, произошла ли ошибка, приводящая к сбою, при извлечении двоичного MOF-файла.</span><span class="sxs-lookup"><span data-stu-id="35724-114">By checking Wmiprov.log, you can determine if an error resulting in failure occurred while extracting the binary MOF file.</span></span> <span data-ttu-id="35724-115">Сведения об ошибках [mofcomp](mofcomp.md) приведены в сообщении MOFCOMP. log.</span><span class="sxs-lookup"><span data-stu-id="35724-115">Details of [mofcomp](mofcomp.md) errors are reported in Mofcomp.log.</span></span> <span data-ttu-id="35724-116">Дополнительные сведения см. в разделе [файлы журналов WMI](wmi-log-files.md).</span><span class="sxs-lookup"><span data-stu-id="35724-116">For more information, see [WMI Log Files](wmi-log-files.md).</span></span> <span data-ttu-id="35724-117">Из соображений производительности Поставщик WDM не создает события при создании или удалении классов из-за запуска или остановки поставщика WDM.</span><span class="sxs-lookup"><span data-stu-id="35724-117">For performance reasons, the WDM provider does not generate events while creating or deleting classes due to a WDM provider starting or stopping.</span></span>

<span data-ttu-id="35724-118">Поставщик WDM преобразует все данные ВНОДЕ в сведения о классе.</span><span class="sxs-lookup"><span data-stu-id="35724-118">The WDM provider transforms all WNODE data into class information.</span></span> <span data-ttu-id="35724-119">Если при преобразовании данных из ВНОДЕ в данные класса возникает ошибка, она сообщается в Вмипров. log с форматированным заголовком и байтами, отображаемыми в той же форме, что и дамп памяти.</span><span class="sxs-lookup"><span data-stu-id="35724-119">If an error is encountered when transforming the data from WNODE to class data, it is reported in Wmiprov.log with the header formatted and bytes rendered in the same form as a memory dump.</span></span>

<span data-ttu-id="35724-120">Изменения, внесенные в параметры безопасности драйвера, вступают в силу только после выгрузки и перезагрузки поставщика WDM.</span><span class="sxs-lookup"><span data-stu-id="35724-120">Changes made to driver security settings do not take effect until the WDM provider is unloaded and reloaded.</span></span> <span data-ttu-id="35724-121">Дополнительные сведения см. [в разделе выгрузка поставщика](unloading-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="35724-121">For more information, see [Unloading a Provider](unloading-a-provider.md).</span></span>

<span data-ttu-id="35724-122">Инструментарий WMI также может создавать высокопроизводительные счетчики для драйверов оборудования.</span><span class="sxs-lookup"><span data-stu-id="35724-122">WMI can also make high-performance counters for hardware drivers available.</span></span> <span data-ttu-id="35724-123">Дополнительные сведения о создании высокопроизводительных классов и отображении данных в системном мониторе системного монитора см. в разделе [повышение эффективности работы поставщика экземпляров](improving-the-efficiency-of-an-instance-provider.md).</span><span class="sxs-lookup"><span data-stu-id="35724-123">For more information about creating high-performance classes and displaying data in Perfmon System Monitor, see [Improving the Efficiency of an Instance Provider](improving-the-efficiency-of-an-instance-provider.md).</span></span> <span data-ttu-id="35724-124">Дополнительные сведения о создании драйверов устройств с поддержкой WMI см. в разделе [https://www.microsoft.com/ddk](https://msdn.microsoft.com/library/aa972908.aspx) .</span><span class="sxs-lookup"><span data-stu-id="35724-124">For more information about writing WMI-enabled device drivers, see [https://www.microsoft.com/ddk](https://msdn.microsoft.com/library/aa972908.aspx).</span></span> <span data-ttu-id="35724-125">Дополнительные сведения об квалификаторах WDM в MOF-файле см. в разделе [**квалификаторы, относящиеся к поставщику WDM**](qualifiers-specific-to-the-wdm-provider.md).</span><span class="sxs-lookup"><span data-stu-id="35724-125">For more information about WDM specific qualifiers in the MOF file, see [**Qualifiers Specific to the WDM Provider**](qualifiers-specific-to-the-wdm-provider.md).</span></span>

## <a name="information-for-administrators-and-users-of-driver-data"></a><span data-ttu-id="35724-126">Сведения для администраторов и пользователей данных драйвера</span><span class="sxs-lookup"><span data-stu-id="35724-126">Information for Administrators and Users of Driver Data</span></span>

<span data-ttu-id="35724-127">Перечисление экземпляров класса [вмибинаримофресаурце](/windows/desktop/WmiCoreProv/wmibinarymofresource) предоставляет список драйверов в системе и сведения о том, был ли поставщик WDM выполнил компиляцию MOF для каждого драйвера.</span><span class="sxs-lookup"><span data-stu-id="35724-127">Listing the instances of the [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) class provides a list of the drivers in the system and information about whether the WDM provider succeeded in compiling the MOFs for each driver.</span></span> <span data-ttu-id="35724-128">Можно принудительно выполнить повторную компиляцию и повторное создание классов для драйвера, удалив экземпляр Вмибинаримофресаурце, который представляет этот драйвер.</span><span class="sxs-lookup"><span data-stu-id="35724-128">You can force the provider to recompile and regenerate the classes for a driver by deleting the instance of WMIBinaryMofResource that represents that driver.</span></span> <span data-ttu-id="35724-129">Сведения об ошибках [mofcomp](mofcomp.md) приведены в сообщении MOFCOMP. log.</span><span class="sxs-lookup"><span data-stu-id="35724-129">Details of [mofcomp](mofcomp.md) errors are reported in the Mofcomp.log.</span></span>

<span data-ttu-id="35724-130">Если пространство имен WMI повреждено, его можно удалить и открыть повторно, чтобы принудительно перестроить классы драйверов с помощью WDM.</span><span class="sxs-lookup"><span data-stu-id="35724-130">If the WMI namespace is corrupted, it can be deleted and reopened to force WDM to rebuild the driver classes.</span></span> <span data-ttu-id="35724-131">Дополнительные сведения об открытии пространства имен см. [в разделе Создание иерархий в WMI](creating-hierarchies-within-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="35724-131">For more information about opening a namespace, see [Creating Hierarchies Within WMI](creating-hierarchies-within-wmi.md).</span></span>

<span data-ttu-id="35724-132">Когда загрузка драйвера прерывается или происходят другие аномальные операции, классы драйверов иногда могут получить «неудачно».</span><span class="sxs-lookup"><span data-stu-id="35724-132">Driver classes can occasionally get "stranded" if driver loading is interrupted or other abnormal operations occur.</span></span> <span data-ttu-id="35724-133">Поставщик WDM будет искать и очищать "потерянные" классы при установке нового драйвера или если для **программного обеспечения \\ Microsoft \\ WBEM \\ Вдмпровидер** значение раздела реестра **процессстрандедклассес** равно **true**.</span><span class="sxs-lookup"><span data-stu-id="35724-133">The WDM provider will only search for and clean up "stranded" classes when a new driver is installed or when the **Software\\Microsoft\\WBEM\\WDMProvider** registry key value **ProcessStrandedClasses** is set to **TRUE**.</span></span> <span data-ttu-id="35724-134">Установка этого параметра в значение **true** снижает производительность запуска WMI из-за операции очистки.</span><span class="sxs-lookup"><span data-stu-id="35724-134">Setting this value to **TRUE** slows WMI startup performance because of the cleanup operation.</span></span> <span data-ttu-id="35724-135">Значение по умолчанию — **false**.</span><span class="sxs-lookup"><span data-stu-id="35724-135">The default value is **FALSE**.</span></span> <span data-ttu-id="35724-136">Поставщик WDM проверяет это значение реестра, только если корневое \\ пространство имен WMI открыто в первый раз.</span><span class="sxs-lookup"><span data-stu-id="35724-136">The WDM provider only checks this registry value when the "Root\\Wmi" namespace is opened for the first time.</span></span>

<span data-ttu-id="35724-137">Если в драйвер устройства WDM вносятся изменения в систему безопасности, изменения не вступят в силу до выгрузки и перезагрузки поставщика WDM.</span><span class="sxs-lookup"><span data-stu-id="35724-137">If security changes are made to a WDM device driver, the changes will not go into effect until the WDM provider is unloaded and reloaded.</span></span> <span data-ttu-id="35724-138">Для этого необходимо остановить и перезапустить службу управления Windows.</span><span class="sxs-lookup"><span data-stu-id="35724-138">The Windows Management service must be stopped and restarted to accomplish this.</span></span>

## <a name="related-topics"></a><span data-ttu-id="35724-139">См. также</span><span class="sxs-lookup"><span data-stu-id="35724-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="35724-140">Использование инструментария WMI</span><span class="sxs-lookup"><span data-stu-id="35724-140">Using WMI</span></span>](using-wmi.md)
</dt> </dl>

 

 
