---
description: Объект Свбемсинк реализуется клиентскими приложениями для получения результатов асинхронных операций и уведомлений о событиях.
ms.assetid: a90777ef-fa26-4bfb-b196-c083a0c92a29
ms.tgt_platform: multiple
title: Объект Свбемсинк (Wbemdisp. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemSink
- ISWbemSinkEvents
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: b8007b7387a09e31f49dbc833f657bc959ee11e7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711615"
---
# <a name="swbemsink-object"></a>Объект Свбемсинк

Объект **свбемсинк** реализуется клиентскими приложениями для получения результатов асинхронных операций и уведомлений о событиях. Чтобы выполнить асинхронный вызов, необходимо создать экземпляр объекта **свбемсинк** и передать его в качестве параметра *обжвбемсинк* . События в реализации **свбемсинк** запускаются при возвращении состояния или результатов, а также после завершения вызова. Вызов функции **CreateObject** VBScript создает этот объект.

## <a name="members"></a>Элементы

Объект **свбемсинк** имеет следующие типы членов:

-   [Методы](#methods)

### <a name="methods"></a>Методы

Объект **свбемсинк** содержит эти методы.



| Метод                             | Описание                                                                        |
|:-----------------------------------|:-----------------------------------------------------------------------------------|
| [**Отменить**](swbemsink-cancel.md) | Отменяет все асинхронные операции, связанные с этим приемником.<br/> |



 

## <a name="remarks"></a>Комментарии

Асинхронный обратный вызов позволяет пользователю без проверки подлинности предоставлять данные в приемник. Это создает угрозы безопасности для сценариев и приложений. Чтобы устранить риски, используйте либо семисинчронаус связь, либо синхронное взаимодействие. Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).

### <a name="events"></a>События

Можно реализовать подпрограммы, которые будут вызываться при запуске событий. Например, если требуется обработать каждый объект, возвращаемый асинхронным вызовом запроса, например [**SWbemServices.Exeккуерясинк**](swbemservices-execqueryasync.md), создайте подпрограммы с помощью приемника, указанного в асинхронном вызове, как показано в следующем примере.


```VB
Sub SinkName_OnObjectReady(objObject, objAsyncContext)
```



Используйте следующую таблицу в качестве ссылки для задания событий и описаний триггеров.



| Событие                                            | Описание                                                             |
|--------------------------------------------------|-------------------------------------------------------------------------|
| [**OnCompleted**](swbemsink-oncompleted.md)     | Активируется после завершения асинхронной операции.                   |
| [**онобжектпут**](swbemsink-onobjectput.md)     | Активируется при завершении асинхронной операции размещения.               |
| [**онобжектреади**](swbemsink-onobjectready.md) | Активируется, когда доступен объект, предоставленный асинхронным вызовом. |
| [**OnProgress**](swbemsink-onprogress.md)       | Активируется для предоставления состояния асинхронной операции.            |



 

**Асинхронное получение статистики журнала событий**

Инструментарий WMI поддерживает как асинхронные, так и частично Синхронные сценарии. При получении событий из журналов событий асинхронные скрипты часто извлекают эти данные гораздо быстрее.

В асинхронном скрипте выдается запрос, и управление немедленно возвращается в скрипт. Запрос по-своему обрабатывается в отдельном потоке, а скрипт начинает немедленно реагировать на возвращаемые сведения. Асинхронные скрипты управляются событиями: при каждом извлечении записи события срабатывает событие Онобжектреади. По завершении запроса будет срабатывать событие OnComplete, и скрипт может продолжаться в зависимости от того факта, что были возвращены все доступные записи.

В частично синхронном сценарии, напротив, выдается запрос, а затем сценарий помещает в очередь большой объем извлеченных сведений, прежде чем реагировать на нее. Для многих объектов достаточно частично синхронной обработки. Например, при запросах к диску для его свойств может существовать только промежуток времени между моментом выдачи запроса и временем возврата и обработки информации. Это связано с тем, что объем возвращаемой информации относительно невелик.

Однако при запросе к журналу событий интервал между моментом выдачи запроса и временем, когда односинхронный сценарий может завершиться возвратом и обработкой данных, может занять несколько часов. С поверх этого сценарий может завершиться нехваткой памяти и создать ошибку самостоятельно, прежде чем завершить работу.

Для журналов событий с большим количеством записей разница во времени обработки может быть значительной. На тестовом компьютере под управлением Windows 2000 с 2 000 записями в журнале событий синхронный запрос, который извлекает все события и отображает их в окне командной строки, занял 10 минут 45 секунд. Асинхронный запрос, выполняющий одну и ту же операцию, занял одну минуту 54 секунд.

## <a name="examples"></a>Примеры

Следующий сценарий VBScript асинхронно запрашивает журналы событий для всех записей.


```VB
Const POPUP_DURATION = 10
Const OK_BUTTON = 0
Set objWSHShell = Wscript.CreateObject("Wscript.Shell")
strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
 & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
Set objSink = WScript.CreateObject("WbemScripting.SWbemSink","SINK_")
objWMIService.InstancesOfAsync objSink, "Win32_NTLogEvent"
errReturn = objWshShell.Popup("Retrieving events", POPUP_DURATION, _
"Event Retrieval", OK_BUTTON)
Sub SINK_OnCompleted(iHResult, objErrorObject, objAsyncContext)
 WScript.Echo "Asynchronous operation is done."
End Sub
Sub SINK_OnObjectReady(objEvent, objAsyncContext)
 Wscript.Echo "Category: " & objEvent.Category
 Wscript.Echo "Computer Name: " & objEvent.ComputerName
 Wscript.Echo "Event Code: " & objEvent.EventCode
 Wscript.Echo "Message: " & objEvent.Message
 Wscript.Echo "Record Number: " & objEvent.RecordNumber
 Wscript.Echo "Source Name: " & objEvent.SourceName
 Wscript.Echo "Time Written: " & objEvent.TimeWritten
 Wscript.Echo "Event Type: " & objEvent.Type
 Wscript.Echo "User: " & objEvent.User
End Sub
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Header<br/>                   | <dl> <dt>Wbemdisp. h</dt> </dl>   |
| IDL<br/>                      | <dl> <dt>Wbemdisp. idl</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Wbemdisp.dll</dt> </dl> |
| CLSID<br/>                    | \_СВБЕМСИНК CLSID<br/> \_СВБЕМСИНКЕВЕНТС CLSID<br/>                           |
| IID<br/>                      | IID \_ исвбемсинк<br/> IID \_ исвбемсинкевентс<br/>                             |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Создание скриптов для объектов API](scripting-api-objects.md)
</dt> </dl>

 

 




