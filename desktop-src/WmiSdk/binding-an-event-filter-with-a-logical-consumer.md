---
description: После создания логического потребителя событий и фильтра событий необходимо связать его, который регистрирует логического потребителя для получения уведомлений о событиях, заданных фильтром.
ms.assetid: 2fc3d781-2b93-4e9e-90a1-1b975ab40a01
ms.tgt_platform: multiple
title: Привязка фильтра событий к логическому потребителю
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e99f44c4b64b98877231b73543d8753c765c3219
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103912407"
---
# <a name="binding-an-event-filter-with-a-logical-consumer"></a>Привязка фильтра событий к логическому потребителю

После создания логического потребителя событий и фильтра событий необходимо связать его, который регистрирует логического потребителя для получения уведомлений о событиях, заданных фильтром.

Следующая процедура описывает, как привязать фильтр событий к логическому потребителю.

**Привязка фильтра событий к логическому потребителю**

1.  Создайте экземпляр класса System [**\_ \_ филтертоконсумербиндинг**](--filtertoconsumerbinding.md) в репозитории WMI.

    Класс [**\_ \_ филтертоконсумербиндинг**](--filtertoconsumerbinding.md) является классом ассоциации, который связывает экземпляр фильтра событий и экземпляр логического потребителя с помощью свойств ссылки на **Фильтр** и **потребитель** . Дополнительные сведения см. в разделе [объявление класса ассоциации](declaring-an-association-class.md).

2.  Задайте свойство **Filter** для экземпляра фильтра.
3.  Задайте для свойства **потребителя** экземпляр логического потребителя.
4.  Задайте свойство **деливерсинчронаусли** , чтобы определить нужный тип доставки.

    Свойство **деливерсинчронаусли** определяет, когда инструментарий WMI доставляет уведомления о событиях синхронно или асинхронно. Установка этого свойства в **значение true** запрашивает синхронную доставку. Синхронная доставка используется только в том случае, когда постоянный потребитель может обрабатывать события приблизительно в 100 МКС.

    > [!Note]  
    > Поскольку обратный вызов приемника может не возвращаться на том же уровне проверки подлинности, что и клиент, рекомендуется использовать семисинчронаус вместо асинхронного взаимодействия. Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).

     

5.  При отмене регистрации потребителя логических событий убедитесь, что вы удалили экземпляр [**\_ \_ филтертоконсумербиндинг**](--filtertoconsumerbinding.md) .

    Каждый экземпляр [**\_ \_ филтертоконсумербиндинг**](--filtertoconsumerbinding.md) представляет регистрацию для конкретного уведомления о событии. При удалении привязки WMI отключает регистрацию. Возможно, потребуется удалить экземпляры логического потребителя и фильтра событий, чтобы отключить регистрацию в зависимости от реализации.

В следующем примере кода показан экземпляр [**\_ \_ филтертоконсумербиндинг**](--filtertoconsumerbinding.md) , связывающий экземпляр класса [**активескриптевентконсумер**](activescripteventconsumer.md) с конкретным фильтром событий (экземпляр потребителя событий был создан в разделе [Создание логического потребителя](creating-a-logical-consumer.md) , а фильтр событий был создан в разделе [Создание фильтра событий](creating-an-event-filter.md) ).

``` syntax
instance of __FilterToConsumerBinding
{
    Filter = $FILTER;
    Consumer = $CONSUMER;
    DeliverSynchronously=FALSE;

    // this is the Administrators SID in array of bytes format
    CreatorSID = {1,2,0,0,0,0,0,5,32,0,0,0,32,2,0,0}; 
};
```

Два потребителя, [**активескриптевентконсумер**](activescripteventconsumer.md) и [**коммандлинивентконсумер**](commandlineeventconsumer.md), не будут работать, если их создатель не является членом локальной группы администраторов.

**:** Когда администратор создает подписку, ее идентификатор безопасности не используется для свойства **креаторсид** , но вместо него используется идентификатор безопасности локальной группы администраторов. Таким образом, экземпляры могут создаваться разными администраторами, и подписка по-прежнему будет работать. Дополнительные сведения см. в статье [безопасное получение событий](receiving-events-securely.md).

Если фильтр привязан к логическому потребителю, событие записывается с помощью [трассировки событий](/windows/desktop/ETW/event-tracing-portal) для Windows (ETW). Дополнительные сведения см. в разделе [Трассировка действия WMI](tracing-wmi-activity.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Получение событий в любое время](receiving-events-at-all-times.md)
</dt> </dl>

 

 
