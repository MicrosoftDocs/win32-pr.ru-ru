---
description: Инструментарий WMI предоставляет доступ к данным об управляемых объектах Windows через поставщики WMI.
ms.assetid: 74558c6e-28b6-479f-9de6-2fbad793ae26
ms.tgt_platform: multiple
title: Предоставление данных инструментарию WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60df0384bd6f512b931870775067d9d9e6d4077d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103811411"
---
# <a name="providing-data-to-wmi"></a><span data-ttu-id="b6cc0-103">Предоставление данных инструментарию WMI</span><span class="sxs-lookup"><span data-stu-id="b6cc0-103">Providing Data to WMI</span></span>

<span data-ttu-id="b6cc0-104">Инструментарий WMI предоставляет доступ к данным об управляемых объектах Windows через [*поставщики*](gloss-p.md)WMI.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-104">WMI makes data about Windows manageable objects available through WMI [*providers*](gloss-p.md).</span></span> <span data-ttu-id="b6cc0-105">Поставщик получает данные из системного компонента, например процесса, или инструментированного приложения, такого как SNMP или IIS, и передает эти данные через WMI в приложение управления.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-105">A provider retrieves data from a system component, such as a process, or an instrumented application, such as SNMP or IIS, and passes that data through WMI to a management application.</span></span> <span data-ttu-id="b6cc0-106">Например, когда приложение или сценарий запрашивают информацию о процессе с помощью класса [**\_ процесса Win32**](/windows/desktop/CIMWin32Prov/win32-process) WMI, данные получаются динамически через предварительно установленный поставщик.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-106">For example, when an application or script requests process information using the WMI [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class, the data is obtained dynamically through a preinstalled provider.</span></span>

<span data-ttu-id="b6cc0-107">В этом разделе обсуждаются следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="b6cc0-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="b6cc0-108">Создание модели для управляемого объекта</span><span class="sxs-lookup"><span data-stu-id="b6cc0-108">Creating a Model for a Manageable Object</span></span>](#creating-a-model-for-a-manageable-object)
-   [<span data-ttu-id="b6cc0-109">Реализация модели для управляемого объекта</span><span class="sxs-lookup"><span data-stu-id="b6cc0-109">Implementing a Model for a Manageable Object</span></span>](#implementing-a-model-for-a-manageable-object)
-   [<span data-ttu-id="b6cc0-110">Определение типа поставщика для реализации</span><span class="sxs-lookup"><span data-stu-id="b6cc0-110">Determining a Provider Type to Implement</span></span>](#determining-a-provider-type-to-implement)
-   [<span data-ttu-id="b6cc0-111">Определение модели размещения (реализации) для поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-111">Determining a Hosting (Implementation) Model for a Provider</span></span>](#determining-a-hosting-implementation-model-for-a-provider)
-   [<span data-ttu-id="b6cc0-112">Реализация поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-112">Implementing a Provider</span></span>](#implementing-a-provider)
-   [<span data-ttu-id="b6cc0-113">Регистрация поставщика с помощью WMI и системы</span><span class="sxs-lookup"><span data-stu-id="b6cc0-113">Registering a Provider with WMI and the System</span></span>](#registering-a-provider-with-wmi-and-the-system)
-   [<span data-ttu-id="b6cc0-114">Тестирование поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-114">Testing a Provider</span></span>](#testing-a-provider)
-   [<span data-ttu-id="b6cc0-115">См. также</span><span class="sxs-lookup"><span data-stu-id="b6cc0-115">Related topics</span></span>](#related-topics)

## <a name="creating-a-model-for-a-manageable-object"></a><span data-ttu-id="b6cc0-116">Создание модели для управляемого объекта</span><span class="sxs-lookup"><span data-stu-id="b6cc0-116">Creating a Model for a Manageable Object</span></span>

<span data-ttu-id="b6cc0-117">Перед разработкой поставщика создайте модель данных, представляющую управляемый объект, который будет предоставляться через WMI.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-117">Before developing a provider, create a data model to represent the manageable object to be exposed through WMI.</span></span> <span data-ttu-id="b6cc0-118">Вы планируете предоставлять объекты данных, предоставляемые поставщиком.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-118">You plan which data objects your provider will expose.</span></span> <span data-ttu-id="b6cc0-119">Например, если планируется управлять разрешением экрана фона рабочего стола, необходимо решить, как моделировать Рабочий стол в файле [*MOF-файл (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="b6cc0-119">For example, if you plan to manage the screen resolution of the desktop background, you must decide how to model the Desktop in a [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

<span data-ttu-id="b6cc0-120">Чтобы создать полезную модель, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-120">To create a useful model:</span></span>

-   <span data-ttu-id="b6cc0-121">Определите реальные сценарии и укажите сведения, которые клиент может читать и обновлять (например, изменение фонового изображения) для каждого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-121">Determine real world scenarios and model the information a customer may want to read and update (for example, changing the background image) for each manageable object.</span></span> <span data-ttu-id="b6cc0-122">Это свойства класса.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-122">These are your class properties.</span></span>
-   <span data-ttu-id="b6cc0-123">Определите, какие действия может потребоваться клиенту с каждым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-123">Determine which kind of actions a customer may want to perform with each manageable object.</span></span> <span data-ttu-id="b6cc0-124">Это ваши методы.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-124">These are your methods.</span></span>

## <a name="implementing-a-model-for-a-manageable-object"></a><span data-ttu-id="b6cc0-125">Реализация модели для управляемого объекта</span><span class="sxs-lookup"><span data-stu-id="b6cc0-125">Implementing a Model for a Manageable Object</span></span>

<span data-ttu-id="b6cc0-126">Чтобы реализовать модель для управляемых объектов, создайте MOF-файл, содержащий класс WMI, представляющий каждый объект.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-126">To implement a model for manageable objects, create a MOF file containing a WMI class that represents each object.</span></span> <span data-ttu-id="b6cc0-127">Дополнительные сведения о создании MOF-файла для определения классов WMI см. в разделе [Разработка классов MOF-файл (MOF)](designing-managed-object-format--mof--classes.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-127">For more information about creating a MOF file to define WMI classes, see [Designing Managed Object Format (MOF) Classes](designing-managed-object-format--mof--classes.md).</span></span> <span data-ttu-id="b6cc0-128">Регистрация поставщика и его классов обычно включается в MOF-файл, хотя для создания классов и методов можно использовать [API COM](com-api-for-wmi.md) .</span><span class="sxs-lookup"><span data-stu-id="b6cc0-128">The registration of the provider and its classes are usually included in the MOF file, although it is possible to use the [COM API](com-api-for-wmi.md) to create classes and methods.</span></span> <span data-ttu-id="b6cc0-129">Дополнительные сведения см. [в разделе Разработка поставщика WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-129">For more information, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

> [!Note]  
> <span data-ttu-id="b6cc0-130">Чтобы гарантировать, что все определения классов WMI для управляемых объектов будут восстановлены в [*репозитории WMI*](gloss-w.md) в случае сбоя и перезапуска WMI, используйте инструкцию препроцессора [**\# pragma автовосстановления**](pragma-autorecover.md) в файле [*MOF-файл (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="b6cc0-130">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

 

<span data-ttu-id="b6cc0-131">После создания MOF-файла скомпилируйте его с помощью средства [**Mofcomp.exe**](mofcomp.md) .</span><span class="sxs-lookup"><span data-stu-id="b6cc0-131">After you create the MOF file, compile it using the [**Mofcomp.exe**](mofcomp.md) tool.</span></span> <span data-ttu-id="b6cc0-132">Это уведомление об ошибках в MOF-файле и добавляет класс WMI, определенный в MOF-файле, в [*репозиторий WMI*](gloss-w.md) , чтобы класс мог использоваться поставщиком.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-132">This notifies you of errors in your MOF file, and adds the WMI class defined in the MOF file to the [*WMI repository*](gloss-w.md) so that the class can be used by a provider.</span></span>

## <a name="determining-a-provider-type-to-implement"></a><span data-ttu-id="b6cc0-133">Определение типа поставщика для реализации</span><span class="sxs-lookup"><span data-stu-id="b6cc0-133">Determining a Provider Type to Implement</span></span>

<span data-ttu-id="b6cc0-134">Инструментарий WMI поддерживает определенное количество типов поставщиков, которые определяют характер предоставляемых данных и операций, поддерживаемых поставщиками.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-134">WMI supports a certain number of provider types, which determines the nature of the information delivered and operations supported by the providers.</span></span>

<span data-ttu-id="b6cc0-135">Типы поставщиков:</span><span class="sxs-lookup"><span data-stu-id="b6cc0-135">The provider types are:</span></span>

-   [<span data-ttu-id="b6cc0-136">*Поставщик экземпляров*</span><span class="sxs-lookup"><span data-stu-id="b6cc0-136">*Instance provider*</span></span>](gloss-i.md)
-   [<span data-ttu-id="b6cc0-137">*Поставщик метода*</span><span class="sxs-lookup"><span data-stu-id="b6cc0-137">*Method provider*</span></span>](gloss-m.md)
-   [<span data-ttu-id="b6cc0-138">*Поставщик свойств*</span><span class="sxs-lookup"><span data-stu-id="b6cc0-138">*Property provider*</span></span>](gloss-p.md)
-   <span data-ttu-id="b6cc0-139">Поставщик класса</span><span class="sxs-lookup"><span data-stu-id="b6cc0-139">Class provider</span></span>
-   [<span data-ttu-id="b6cc0-140">*Поставщик событий*</span><span class="sxs-lookup"><span data-stu-id="b6cc0-140">*Event provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="b6cc0-141">*Поставщик потребителей событий*</span><span class="sxs-lookup"><span data-stu-id="b6cc0-141">*Event consumer provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="b6cc0-142">*Поставщик ассоциаций*</span><span class="sxs-lookup"><span data-stu-id="b6cc0-142">*Association provider*</span></span>](gloss-a.md)

<span data-ttu-id="b6cc0-143">Подавляющее большинство поставщиков — поставщики экземпляров и поставщики методов.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-143">The vast majority of providers are instance providers and method providers.</span></span> <span data-ttu-id="b6cc0-144">Поставщик экземпляров является наиболее распространенным поставщиком и предоставляет экземпляры данного класса.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-144">An instance provider is the most common provider, and it supplies the instances of a given class.</span></span> <span data-ttu-id="b6cc0-145">Поставщик метода реализует методы одного или нескольких классов.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-145">A method provider implements the methods of one or more classes.</span></span> <span data-ttu-id="b6cc0-146">Дополнительные сведения о типах поставщиков см. в разделе [Разработка поставщика WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-146">For more information about the types of providers, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

## <a name="determining-a-hosting-implementation-model-for-a-provider"></a><span data-ttu-id="b6cc0-147">Определение модели размещения (реализации) для поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-147">Determining a Hosting (Implementation) Model for a Provider</span></span>

<span data-ttu-id="b6cc0-148">Поставщики WMI — это двоичные файлы, реализуемые как COM-объекты.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-148">WMI providers are binaries implemented as COM objects.</span></span> <span data-ttu-id="b6cc0-149">Это означает, что у каждого поставщика есть DLL-файл, который может быть выполнен в определенном процессе и контексте безопасности.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-149">This means that each provider has a DLL file which can be executed within a specific process and security context.</span></span> <span data-ttu-id="b6cc0-150">Это то, что WMI относится к [*модели размещения*](gloss-h.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-150">This is what WMI refers to as the [*hosting model*](gloss-h.md).</span></span> <span data-ttu-id="b6cc0-151">Инструментарий WMI предлагает различные способы размещения поставщиков, но наиболее распространенный подход заключается в использовании взаимодействующей модели поставщика (выполняемой в процессе WMI) в контексте безопасности Нетворксервицехост.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-151">WMI offers various ways to host providers, but the most common approach is to use the coupled provider model (running under the WMI process) in the NetworkServiceHost security context.</span></span> <span data-ttu-id="b6cc0-152">Поставщик WMI может классифицироваться [*как связанный или*](gloss-d.md)отсоединенный.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-152">A WMI provider can be classified as either coupled or [*decoupled*](gloss-d.md).</span></span>

<span data-ttu-id="b6cc0-153">Термин "связанный" или "несвязанный" поставщик определяет, в каком хост-процессе выполняется поставщик, по отношению к инструментарию WMI, предоставленному WMIPRVSE.EXE процессом.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-153">The term coupled or decoupled provider determines under which host process the provider is running with respect to the WMI provided WMIPRVSE.EXE process.</span></span> <span data-ttu-id="b6cc0-154">Рекомендуется определить, являются ли данные управления, предоставляемые поставщиком, и API или приложение, на котором они основаны, всегда доступны в системе.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-154">A best practice is to determine if the management data that the provider exposes and the API or application it relies on are always available in the system or not.</span></span> <span data-ttu-id="b6cc0-155">Если API или приложение, от которого зависит поставщик, всегда доступно (работает в системе), то поставщик должен быть связанным поставщиком, если нет, то он должен быть несвязанным поставщиком.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-155">If the API or application the provider relies on is always available (running on the system), then the provider should be a coupled provider, if not, it must be a decoupled provider.</span></span> <span data-ttu-id="b6cc0-156">Дополнительные сведения о моделях размещения см. в разделе [размещение и безопасность поставщика](provider-hosting-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-156">For more information about hosting models, see [Provider Hosting and Security](provider-hosting-and-security.md).</span></span>

<span data-ttu-id="b6cc0-157">Дополнительные сведения о создании взаимосвязанных поставщиков см. в статьях [предоставление данных в WMI путем написания поставщика](supplying-data-to-wmi-by-writing-a-provider.md), а сведения о включении в приложение несвязанного поставщика см. в разделе [Включение поставщика в приложение](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-157">For more information about creating a coupled provider, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md), and for information about incorporating a decoupled provider in an application, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="b6cc0-158">Связанные поставщики можно описать как внутрипроцессный (in-proc) или внепроцессный (внепроцессный) процесс.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-158">Coupled providers can be described as in-process (in-proc) or out-of-process (out-of-proc).</span></span> <span data-ttu-id="b6cc0-159">Если связанный поставщик является внутрипроцессным поставщиком, он выполняется с общим WMIPRVSE.EXE хост-процессом WMI и реализуется как внутрипроцессный сервер COM (DLL).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-159">When a coupled provider is an in-proc provider, it runs under a shared WMIPRVSE.EXE WMI hosting process and is implemented as a COM in-proc server (.dll).</span></span> <span data-ttu-id="b6cc0-160">Если поставщик является внепроцессный, он запускается WMI при запросе клиента или события, но выполняется как отдельный процесс и реализуется как исполняемый файл (. exe).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-160">When a provider is an out-of-proc provider, it is started by WMI on request of a client or event, but it runs as a separated process and is implemented as an executable (.exe).</span></span>

## <a name="implementing-a-provider"></a><span data-ttu-id="b6cc0-161">Реализация поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-161">Implementing a Provider</span></span>

<span data-ttu-id="b6cc0-162">Поставщик может быть реализован следующими способами.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-162">A provider can be implemented in the following ways:</span></span>

-   <span data-ttu-id="b6cc0-163">Использование мастера ATL в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-163">Using the ATL Wizard in Visual Studio.</span></span>

    <span data-ttu-id="b6cc0-164">Мастер ATL создает код поставщика, реализующий связанный поставщик.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-164">The ATL Wizard generates provider code that implements a coupled provider.</span></span> <span data-ttu-id="b6cc0-165">При использовании мастера ATL можно указать, что вы хотите создать внутрипроцессный (DLL) или внепроцессных (exe) модель времени выполнения поставщика.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-165">While using the ATL Wizard, you can specify that you want to create an in-proc (.dll) or out-of-proc (.exe) provider run-time model.</span></span>

-   <span data-ttu-id="b6cc0-166">Определение COM-объекта, который будет содержать поставщик.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-166">Defining a COM object to contain your provider.</span></span>

    <span data-ttu-id="b6cc0-167">Код поставщика написан на языке C++.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-167">The provider code is written in C++.</span></span> <span data-ttu-id="b6cc0-168">Дополнительные сведения см. в разделе [предоставление данных WMI с помощью записи поставщика](supplying-data-to-wmi-by-writing-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-168">For more information, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md).</span></span>

-   <span data-ttu-id="b6cc0-169">Использование классов в пространстве имен [**Microsoft. Management. Infrastructure**](/previous-versions//hh872326(v=vs.85)) в платформа .NET Framework для создания поставщика с помощью управляемого кода.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-169">Using the classes in the [**Microsoft.Management.Infrastructure**](/previous-versions//hh872326(v=vs.85)) namespace in the .NET Framework to create a provider using managed code.</span></span> <span data-ttu-id="b6cc0-170">(Пространство имен **System. Management. Instrumentation** больше не поддерживается.)</span><span class="sxs-lookup"><span data-stu-id="b6cc0-170">(The **System.Management.Instrumentation** namespace is no longer supported.)</span></span>

    <span data-ttu-id="b6cc0-171">Этот процесс создает несвязанный поставщик.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-171">This process creates a decoupled provider.</span></span>

## <a name="registering-a-provider-with-wmi-and-the-system"></a><span data-ttu-id="b6cc0-172">Регистрация поставщика с помощью WMI и системы</span><span class="sxs-lookup"><span data-stu-id="b6cc0-172">Registering a Provider with WMI and the System</span></span>

<span data-ttu-id="b6cc0-173">Прежде чем использовать поставщик из потребителя, важно зарегистрировать его в системе WMI и подсистеме Windows COM.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-173">Before using the provider from a consumer, it is important to register it with the WMI system and the Windows COM subsystem.</span></span>

<span data-ttu-id="b6cc0-174">MOF-файл может содержать несколько типов поставщиков для одних и тех же классов.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-174">A MOF file can contain multiple types of providers for the same classes.</span></span> <span data-ttu-id="b6cc0-175">То же имя поставщика регистрируется как, например, экземпляр или поставщик метода.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-175">The same provider name is registered as, for example, an instance or a method provider.</span></span> <span data-ttu-id="b6cc0-176">Дополнительные сведения см. [в разделе Регистрация поставщика](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-176">For more information, see [Registering a Provider](registering-a-provider.md).</span></span>

## <a name="testing-a-provider"></a><span data-ttu-id="b6cc0-177">Тестирование поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-177">Testing a Provider</span></span>

<span data-ttu-id="b6cc0-178">При регистрации кода поставщика важно правильно протестировать поставщик с помощью поставщика от разных потребителей (например, скриптов, управляемого кода .NET и потребителей C++).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-178">When the provider code is registered, it is important to properly test the provider by using the provider from different consumers (for example, scripts, .NET managed code, and C++ consumers).</span></span>

<span data-ttu-id="b6cc0-179">Для проверки поставщика выполните следующие задачи.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-179">Perform the following tasks to test your provider:</span></span>

-   <span data-ttu-id="b6cc0-180">Убедитесь, что поставщик загружается должным образом, отследяя уведомления о событии [**MSFT \_ события \_ оператионевент**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) .</span><span class="sxs-lookup"><span data-stu-id="b6cc0-180">Ensure that your provider is loading properly by tracking the [**MSFT\_WmiProvider\_OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) event notifications.</span></span> <span data-ttu-id="b6cc0-181">Эти события сообщают о сбоях при загрузке поставщика.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-181">These events will inform you about any provider load failures.</span></span> <span data-ttu-id="b6cc0-182">Другими классами для устранения неполадок, которые могут быть полезными, являются [**Win32 \_ Процессстарттраце**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) и [**Win32 \_ процессстоптраце**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-182">Other troubleshooting classes that may be helpful are [**Win32\_ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) and [**Win32\_ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span></span> <span data-ttu-id="b6cc0-183">Дополнительные сведения об устранении неполадок поставщиков см. в разделе [Отладка поставщиков](debugging-providers.md) и [конфигурации поставщика и устранение неполадок классов](provider-configuration-and-troubleshooting-classes.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-183">For more information about troubleshooting providers, see [Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md).</span></span>
-   <span data-ttu-id="b6cc0-184">Если поставщик является экземпляром или поставщиком метода, убедитесь, что каждый из возможностей поставщика проверяются один за другим, чтобы избежать путаницы в работе логики кода.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-184">If the provider is an instance or method provider, ensure you test each provider capability one-by-one to avoid confusion in following your code logic.</span></span>
-   <span data-ttu-id="b6cc0-185">Для поставщика экземпляров Создайте клиентское приложение или скрипт, который вызывает каждый интерфейс поставщика (перечисление, получение, размещение и удаление).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-185">For an instance provider, create a client application or script that invokes every interface of the provider (enumeration, get, put, and delete).</span></span> <span data-ttu-id="b6cc0-186">Даже если поставщик не должен реализовывать ничего, он должен вернуть сообщение "не поддерживается".</span><span class="sxs-lookup"><span data-stu-id="b6cc0-186">Even if the provider is not supposed to implement anything, it should return a "not supported" message.</span></span> <span data-ttu-id="b6cc0-187">Возвращаемые значения, уже определенные в [кодах возврата WMI](wmi-return-codes.md), можно найти.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-187">You can find the return values already defined in [WMI Return Codes](wmi-return-codes.md).</span></span>
-   <span data-ttu-id="b6cc0-188">Чтобы обеспечить работу требуемого контекста безопасности в соответствии с планом, вызовите поддерживаемые операции поставщика из контекста безопасности неадминистратора.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-188">To ensure that the desired security context is working as planned, invoke the provider supported operations from a nonadministrator security context.</span></span> <span data-ttu-id="b6cc0-189">Поставщик должен поддерживать олицетворение.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-189">The provider must support impersonation.</span></span> <span data-ttu-id="b6cc0-190">Если пользователь, не имеющий правильных учетных данных, пытается обновить данные или выполнить операцию, которая выполняет метод, поставщик должен запретить доступ с указанием соответствующего сообщения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="b6cc0-190">If a user lacking the correct security credentials tries to update data or perform an operation that executes a method, your provider should deny access with the appropriate error message.</span></span>
-   <span data-ttu-id="b6cc0-191">Дополнительные сведения о безопасности поставщика см. [в разделе Защита поставщика](securing-your-provider.md).</span><span class="sxs-lookup"><span data-stu-id="b6cc0-191">For more information about provider security, see [Securing Your Provider](securing-your-provider.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b6cc0-192">См. также</span><span class="sxs-lookup"><span data-stu-id="b6cc0-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b6cc0-193">Разработка поставщика WMI</span><span class="sxs-lookup"><span data-stu-id="b6cc0-193">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-194">Размещение и безопасность поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-194">Provider Hosting and Security</span></span>](provider-hosting-and-security.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-195">Предоставление данных в WMI путем написания поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-195">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-196">Включение поставщика в приложение</span><span class="sxs-lookup"><span data-stu-id="b6cc0-196">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-197">Регистрация поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-197">Registering a Provider</span></span>](registering-a-provider.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-198">Устранение неполадок клиентских приложений WMI</span><span class="sxs-lookup"><span data-stu-id="b6cc0-198">Troubleshooting WMI Client Applications</span></span>](troubleshooting-wmi-client-applications.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-199">Защита поставщика</span><span class="sxs-lookup"><span data-stu-id="b6cc0-199">Securing Your Provider</span></span>](securing-your-provider.md)
</dt> <dt>

[<span data-ttu-id="b6cc0-200">Получение и предоставление данных на 64-разрядной платформе</span><span class="sxs-lookup"><span data-stu-id="b6cc0-200">Getting and Providing Data on a 64-bit Platform</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)
</dt> </dl>

 

 
