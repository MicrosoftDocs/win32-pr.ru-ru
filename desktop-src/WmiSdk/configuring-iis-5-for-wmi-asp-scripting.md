---
description: Все параметры проверки подлинности выполняются с помощью диспетчер служб Интернета.
ms.assetid: 9b118120-f0cb-4973-b537-dd3d12a7a6d5
ms.tgt_platform: multiple
title: Настройка IIS 5,0 и более поздних версий для сценариев ASP WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff4b5ddde139b3eef32fd7c80f4cca4e10fd816a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711757"
---
# <a name="configuring-iis-50-and-later-for-wmi-asp-scripting"></a>Настройка IIS 5,0 и более поздних версий для сценариев ASP WMI

Все параметры проверки подлинности выполняются с помощью диспетчер служб Интернета.

При настройке безопасности Internet Information Server (IIS) 5,0 и IIS 6,0 для сценариев ASP WMI необходимо учитывать следующие моменты.

-   [Уровень проверки подлинности](#authentication-level)

    Можно настроить на уровне сервера, каталога или файла.

-   [Настройка проверки подлинности](#authentication-setting)

    Для проверки подлинности можно задать значение анонимно, интегрированные окна или и то, и другое.

-   [Защита](#protection)

    Можно настроить выполнение ASP в процессе (низкий уровень защиты) или вне процесса с помощью Dllhost.exe (среднего или высокого уровня защиты).

## <a name="authentication-level"></a>Уровень проверки подлинности

Для повышения безопасности можно настроить проверку подлинности на уровне каталога или файла.

Если проверка подлинности установлена на уровне сервера, все последующие каталоги и файлы соответствуют проверке подлинности сервера, если только на уровне каталога или файла не было явно изменено. Можно создать структуру каталогов, которая будет содержать все сценарии ASP WMI, в которых страницы HTML и планах ASP, относящиеся к WMI, можно настроить независимо от остальной части сервера. Чтобы изменить уровень проверки подлинности сервера, каталога или файла, выполните следующие действия.

**Настройка проверки подлинности на любом уровне**

1.  На панели управления дважды щелкните **Администрирование**, а затем дважды щелкните оснастку IIS.

2.  Найдите значок страницы ASP, а затем откройте свойства заданного уровня, который может быть сервером, каталогом или файлом.

    > [!Note]  
    > Параметры проверки подлинности расположены на вкладке **Безопасность каталога** или **Безопасность файла** страницы **свойств**.

     

## <a name="authentication-setting"></a>Настройка проверки подлинности

Для сценариев ASP WMI сочетание отключенной анонимной проверки подлинности (снято) и встроенной проверки подлинности Windows (установлен) обеспечивает большую возможность настройки безопасности. Чтобы использовать параметры проверки подлинности с помощью NT LAN Manager (NTLM), Passport или Digest IIS, необходимо включить разрешения на удаленное включение, так как пользователь обрабатывается как сетевое удостоверение и регистрируется удаленно. Параметр Remote Enable не требуется для анонимной и обычной проверки подлинности. Однако при использовании анонимной и обычной проверки подлинности система гораздо менее безопасна.

Если анонимная проверка подлинности используется с встроенной проверкой подлинности Windows или без нее, самый безопасный подход заключается в использовании входа, требующего ввода имени пользователя и пароля. При входе по умолчанию используется удостоверение IIS, но можно создать вход с помощью специальных разрешений, предназначенных для сценариев ASP WMI, которые можно использовать в качестве учетной записи для анонимных или гостевых подключений.

Если выбран идентификатор входа, не являющийся удостоверением IIS, снимите флажок **Разрешить управление паролем в IIS** и введите правильный пароль. Это заставляет все анонимные или гостевые подключения использовать идентификатор входа. Создавая имя входа отдельно от удостоверения IIS, привилегии учетной записи, обращающейся к WMI, можно контролировать, не затрагивая другие каталоги или файлы на сервере IIS — если только проверка подлинности не установлена на уровне сервера.

Выполните следующую процедуру, чтобы задать требования к проверке подлинности для страницы ASP с помощью оснастки IIS на панели управления.

**Чтобы перейти к параметру учетной записи**

1.  На панели управления дважды щелкните значок " **Администрирование** ", откройте оснастку "службы IIS", перейдите на страницу ASP и откройте свойства заданного уровня, который может быть сервером, каталогом или файлом.

    Параметры проверки подлинности можно найти на вкладке **Безопасность каталога** или **Безопасность файла** на странице **свойств** .

2.  В области анонимная проверка подлинности нажмите кнопку **изменить**.

3.  Если выбран идентификатор входа, отличный от удостоверения IIS, снимите флажок **разрешить службе IIS управлять паролем** и введите правильный пароль. Это заставляет все анонимные или гостевые подключения использовать идентификатор входа.

При использовании имени входа, отличного от удостоверения IIS, привилегии учетной записи, обращающейся к WMI, можно контролировать, не затрагивая другие каталоги или файлы на сервере IIS, если только проверка подлинности не установлена на уровне сервера.

Предыдущая конфигурация позволяет серверу IIS использовать анонимную проверку подлинности в некоторых областях, а также интегрированную аутентификацию Windows или смешанную проверку подлинности в других.

## <a name="protection"></a>Защита

Последнее замечание при настройке сервера IIS — какую защиту использовать при выполнении ASP.

Вы можете настроить ASP для выполнения следующих действий:

-   Внутрипроцессный в IIS (низкая защита).

-   Внешние к службам IIS с Dllhost.exe как в пуле, так и вне процесса (в составе пула со средним уровнем защиты).

-   Вне процесса (высокая защита).

> [!Note]  
> Для лучшего баланса безопасности и производительности используйте узел в составе пула.

 

 

 



