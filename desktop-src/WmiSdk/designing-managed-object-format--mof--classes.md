---
description: Поставщик WMI состоит из файла MOF-файл (MOF) и DLL-файла. MOF-файл определяет классы, для которых реализация поставщика предоставляет данные.
ms.assetid: 20ef6b88-2aaa-4e86-bc4a-bebc34069672
ms.tgt_platform: multiple
title: Разработка классов MOF-файл (MOF)
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 201f8c45f7a247fbca5695baa6dd440fc5dc323f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104265380"
---
# <a name="designing-managed-object-format-mof-classes"></a><span data-ttu-id="84a62-104">Разработка классов MOF-файл (MOF)</span><span class="sxs-lookup"><span data-stu-id="84a62-104">Designing Managed Object Format (MOF) Classes</span></span>

<span data-ttu-id="84a62-105">[*Поставщик WMI*](gloss-p.md) состоит из файла MOF-файл (MOF) и DLL-файла.</span><span class="sxs-lookup"><span data-stu-id="84a62-105">A [*WMI provider*](gloss-p.md) consists of a Managed Object Format (MOF) file and DLL file.</span></span> <span data-ttu-id="84a62-106">MOF-файл определяет классы, для которых реализация поставщика предоставляет данные.</span><span class="sxs-lookup"><span data-stu-id="84a62-106">The MOF file defines the classes for which the provider implementation supplies data.</span></span>

<span data-ttu-id="84a62-107">Определения классов MOF компилируются программой [**mofcomp**](mofcomp.md) и хранятся в [*репозитории WMI*](gloss-w.md), также известном как репозиторий модель CIM (CIM).</span><span class="sxs-lookup"><span data-stu-id="84a62-107">The MOF class definitions are compiled by the [**mofcomp**](mofcomp.md) utility and stored in the [*WMI repository*](gloss-w.md), also known as the Common Information Model (CIM) repository.</span></span> <span data-ttu-id="84a62-108">Менее распространенный способ создания классов заключается в использовании методов [API COM для WMI](com-api-for-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-108">A less common way to create classes is through the methods of the [COM API for WMI](com-api-for-wmi.md).</span></span>

> [!Note]  
> <span data-ttu-id="84a62-109">Чтобы гарантировать, что все определения классов WMI для управляемых объектов будут восстановлены в [*репозитории WMI*](gloss-w.md) в случае сбоя и перезапуска WMI, используйте инструкцию препроцессора [**\# pragma автовосстановления**](pragma-autorecover.md) в MOF-файле.</span><span class="sxs-lookup"><span data-stu-id="84a62-109">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your MOF file.</span></span>

 

<span data-ttu-id="84a62-110">В этом разделе обсуждаются следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="84a62-110">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="84a62-111">Определение объектов для управления</span><span class="sxs-lookup"><span data-stu-id="84a62-111">Defining the Objects to Manage</span></span>](#defining-the-objects-to-manage)
-   [<span data-ttu-id="84a62-112">Определение свойств или методов</span><span class="sxs-lookup"><span data-stu-id="84a62-112">Defining Properties or Methods</span></span>](#defining-properties-or-methods)
-   [<span data-ttu-id="84a62-113">Связывание объектов друг с другом</span><span class="sxs-lookup"><span data-stu-id="84a62-113">Relating Objects to Each Other</span></span>](#relating-objects-to-each-other)
-   [<span data-ttu-id="84a62-114">См. также</span><span class="sxs-lookup"><span data-stu-id="84a62-114">Related topics</span></span>](#related-topics)

## <a name="defining-the-objects-to-manage"></a><span data-ttu-id="84a62-115">Определение объектов для управления</span><span class="sxs-lookup"><span data-stu-id="84a62-115">Defining the Objects to Manage</span></span>

<span data-ttu-id="84a62-116">Определив часть организации для управления, определите объекты для управления.</span><span class="sxs-lookup"><span data-stu-id="84a62-116">After you identify the part of your enterprise to manage, define the objects to manage.</span></span> <span data-ttu-id="84a62-117">Определение должно включать необходимые данные и позволяет точно реализовать соответствующие бизнес-правила.</span><span class="sxs-lookup"><span data-stu-id="84a62-117">The definition must include the required data, and allow you to implement the relevant business rules accurately.</span></span> <span data-ttu-id="84a62-118">Объекты можно определять на детализированном уровне, но лучше выбрать уровень детализации, содержащийся в определении, и необходимость предоставить достаточно подробное описание.</span><span class="sxs-lookup"><span data-stu-id="84a62-118">You can define objects at a granular level, but it is best to decide between the level of detail contained in the definition, and the need to provide enough detail to be useful.</span></span> <span data-ttu-id="84a62-119">Ярлыки на ранних этапах процесса могут сэкономить время, но в будущем это может привести к большей работе.</span><span class="sxs-lookup"><span data-stu-id="84a62-119">Shortcuts early in the process may save time, but may be cause more work in the future.</span></span>

<span data-ttu-id="84a62-120">В руководстве по CIM на веб-сайте распределенной задачи управления (DMTF) содержится отличная информация о процессе разработки.</span><span class="sxs-lookup"><span data-stu-id="84a62-120">The CIM Tutorial at the Distributed Management Task Force (DMTF) website contains excellent information about the design process.</span></span> <span data-ttu-id="84a62-121">Дополнительные сведения см. в разделе [www.DMTF.org](https://www.dmtf.org/).</span><span class="sxs-lookup"><span data-stu-id="84a62-121">For more information, see [www.dmtf.org](https://www.dmtf.org/).</span></span>

<span data-ttu-id="84a62-122">При разработке и реализации структуры схемы учитывайте следующие факторы.</span><span class="sxs-lookup"><span data-stu-id="84a62-122">Consider the following factors when you develop and implement a schema design:</span></span>

-   <span data-ttu-id="84a62-123">Квалификаторы</span><span class="sxs-lookup"><span data-stu-id="84a62-123">Qualifiers</span></span>

    <span data-ttu-id="84a62-124">Квалификаторы предоставляют сведения о том, как описывать классы, объекты, свойства, методы и параметры. они применяются к определениям классов и свойств.</span><span class="sxs-lookup"><span data-stu-id="84a62-124">Qualifiers provide information about how to describe classes, objects, properties, methods, and parameters; and they are applied to class and property definitions.</span></span> <span data-ttu-id="84a62-125">В коде MOF квалификаторы заключаются в квадратные скобки и могут включать \[ ключ \] или \[ связь \] .</span><span class="sxs-lookup"><span data-stu-id="84a62-125">In MOF code, qualifiers are enclosed in brackets and may include \[key\] or \[association\].</span></span> <span data-ttu-id="84a62-126">Дополнительные сведения см. в разделе Добавление квалификаторов [квалификатора](adding-a-qualifier.md) и [WMI](wmi-qualifiers.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-126">For more information, see [Adding a Qualifier](adding-a-qualifier.md) and [WMI Qualifiers](wmi-qualifiers.md).</span></span>

-   <span data-ttu-id="84a62-127">Пространство имен</span><span class="sxs-lookup"><span data-stu-id="84a62-127">Namespace</span></span>

    <span data-ttu-id="84a62-128">Пространство имен — это логическая единица для группирования классов и объектов, управления областью и видимостью.</span><span class="sxs-lookup"><span data-stu-id="84a62-128">A namespace is a logical unit to group classes and objects, and control scope and visibility.</span></span> <span data-ttu-id="84a62-129">Как правило, пространство имен содержит набор классов и объектов, представляющих управляемые объекты в определенной среде.</span><span class="sxs-lookup"><span data-stu-id="84a62-129">Typically, a namespace contains a set of classes and objects that represent managed objects in a specific environment.</span></span> <span data-ttu-id="84a62-130">Дополнительные сведения см. [в разделе Создание иерархий в WMI](creating-hierarchies-within-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-130">For more information, see [Creating Hierarchies Within WMI](creating-hierarchies-within-wmi.md).</span></span>

-   <span data-ttu-id="84a62-131">Объект</span><span class="sxs-lookup"><span data-stu-id="84a62-131">Object</span></span>

    <span data-ttu-id="84a62-132">Смоделированный объект может быть физическим или логическим элементом схемы.</span><span class="sxs-lookup"><span data-stu-id="84a62-132">A modeled object might be a physical or logical element of the schema.</span></span> <span data-ttu-id="84a62-133">Например, можно смоделировать физический диск, например жесткий диск, или логический диск, который может быть разделом на физическом диске.</span><span class="sxs-lookup"><span data-stu-id="84a62-133">For example, you can model a physical disk drive such as a hard disk drive, or a logical disk that can be a partition on a physical disk.</span></span> <span data-ttu-id="84a62-134">Проект, использующий класс для моделирования физического диска, а затем расширяет этот класс для моделирования логического диска, является более расширяемым, чем тот, который пытается создать отдельный класс для каждого типа диска.</span><span class="sxs-lookup"><span data-stu-id="84a62-134">A design that uses a class to model a physical disk drive, and then extends that class to model a logical disk is more extensible than one that attempts to create a separate class for each type of disk.</span></span>

-   <span data-ttu-id="84a62-135">Данные</span><span class="sxs-lookup"><span data-stu-id="84a62-135">Data</span></span>

    <span data-ttu-id="84a62-136">Данные могут быть динамическими или статическими.</span><span class="sxs-lookup"><span data-stu-id="84a62-136">Data may be dynamic or static.</span></span> <span data-ttu-id="84a62-137">Если данные являются динамическими, необходимо создать для него поставщик класса.</span><span class="sxs-lookup"><span data-stu-id="84a62-137">If the data is dynamic, you must create a class provider for it.</span></span>

    <span data-ttu-id="84a62-138">Чтобы разрешить пользователю изменять данные, необходимо определить, нужно ли, чтобы свойство можно было напрямую записывать или изменять только с помощью метода, который вызывает пользователь.</span><span class="sxs-lookup"><span data-stu-id="84a62-138">To enable the user to modify data, you must determine whether or not you want a property to be directly writable or modifiable only by using a method that the user calls.</span></span>

## <a name="defining-properties-or-methods"></a><span data-ttu-id="84a62-139">Определение свойств или методов</span><span class="sxs-lookup"><span data-stu-id="84a62-139">Defining Properties or Methods</span></span>

<span data-ttu-id="84a62-140">Как правило, свойство класса WMI аналогично свойству в классе C++.</span><span class="sxs-lookup"><span data-stu-id="84a62-140">Generally, a WMI class property is similar to a property in a C++ class.</span></span> <span data-ttu-id="84a62-141">Если единственными действиями, которые ваш код реализует для фрагмента данных, является получение значения или установка значения, то данные должны быть определены как свойство класса WMI.</span><span class="sxs-lookup"><span data-stu-id="84a62-141">If the only actions your code implements for the piece of data is to get the value or set the value, then the data should be defined as a property of the WMI class.</span></span>

<span data-ttu-id="84a62-142">Метод WMI обычно выполняет действие, которое изменяет состояние управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="84a62-142">A WMI method generally performs an action that changes the state of a managed object.</span></span> <span data-ttu-id="84a62-143">Например, если действием является включение или отключение операции аппаратного объекта, то, вероятно, предпочтительнее создать свойство для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="84a62-143">For example, if the action is to enable or disable the operation of a hardware object, then a method is probably preferable to creating a read/write property.</span></span> <span data-ttu-id="84a62-144">Вы также можете создать свойство, отображающее состояние оборудования.</span><span class="sxs-lookup"><span data-stu-id="84a62-144">You may decide also to create a property that displays the state of the hardware.</span></span>

<span data-ttu-id="84a62-145">При создании класса или экземпляра можно включить комментарии.</span><span class="sxs-lookup"><span data-stu-id="84a62-145">When you create a class or an instance, you can include comments.</span></span> <span data-ttu-id="84a62-146">Используйте этот метод для документирования класса или объяснения методов программирования.</span><span class="sxs-lookup"><span data-stu-id="84a62-146">Use this technique to document your class or explain your programming techniques.</span></span> <span data-ttu-id="84a62-147">Дополнительные сведения см. [в разделе Создание комментария](creating-a-comment.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-147">For more information, see [Creating a Comment](creating-a-comment.md).</span></span> <span data-ttu-id="84a62-148">Кроме того, можно добавить данные, чтобы уточнить назначение объекта данных.</span><span class="sxs-lookup"><span data-stu-id="84a62-148">In addition, you can add data to qualify the purpose of a data object.</span></span> <span data-ttu-id="84a62-149">Дополнительные сведения см. [в разделе Добавление квалификатора](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-149">For more information, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

## <a name="relating-objects-to-each-other"></a><span data-ttu-id="84a62-150">Связывание объектов друг с другом</span><span class="sxs-lookup"><span data-stu-id="84a62-150">Relating Objects to Each Other</span></span>

<span data-ttu-id="84a62-151">Существует два способа связать объекты друг с другом: путем создания отдельных объектов и объекта связи, связывающего их, или путем внедрения одного объекта в другой.</span><span class="sxs-lookup"><span data-stu-id="84a62-151">There are two ways to relate objects to each other: by creating separate objects and an association object that relates them, or by embedding one object in the other.</span></span> <span data-ttu-id="84a62-152">CIM не поддерживает внедренные объекты, поэтому для обеспечения совместимости с CIM необходимо использовать первый метод.</span><span class="sxs-lookup"><span data-stu-id="84a62-152">CIM does not support embedded objects, so to be CIM-compliant you must use the first method.</span></span> <span data-ttu-id="84a62-153">Однако Инструментарий WMI поддерживает внедренные объекты, поэтому для представления связи между объектами используется любой из методов.</span><span class="sxs-lookup"><span data-stu-id="84a62-153">However, WMI supports embedded objects so use either method to represent a relationship between objects.</span></span> <span data-ttu-id="84a62-154">Примеры внедренных объектов можно найти в [классах Win32](/windows/desktop/CIMWin32Prov/win32-provider).</span><span class="sxs-lookup"><span data-stu-id="84a62-154">You can find examples of embedded objects in the [Win32 Classes](/windows/desktop/CIMWin32Prov/win32-provider).</span></span> <span data-ttu-id="84a62-155">Например, в [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) есть внедренный объект [**\_ ACE Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-ace), который имеет другой внедренный объект [**— \_ доверенное лицо Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee).</span><span class="sxs-lookup"><span data-stu-id="84a62-155">For example, [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) has the embedded object [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace), which has another embedded object, [**Win32\_Trustee**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee).</span></span>

<span data-ttu-id="84a62-156">При принятии решения о том, как представлять отношения между объектами, учитывайте следующее.</span><span class="sxs-lookup"><span data-stu-id="84a62-156">Consider the following when deciding how to represent relationships between objects:</span></span>

-   <span data-ttu-id="84a62-157">Если экземпляр является полезным для себя, то Ассоциация работает лучше.</span><span class="sxs-lookup"><span data-stu-id="84a62-157">If an instance is useful by itself, then an association works best.</span></span> <span data-ttu-id="84a62-158">Например, [**Win32 \_ Process**](/windows/desktop/CIMWin32Prov/win32-process) и [**Win32 \_ UserAccount**](/windows/desktop/CIMWin32Prov/win32-useraccount).</span><span class="sxs-lookup"><span data-stu-id="84a62-158">For example, [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) and [**Win32\_UserAccount**](/windows/desktop/CIMWin32Prov/win32-useraccount).</span></span> <span data-ttu-id="84a62-159">Дополнительные сведения см. в разделе [объявление класса ассоциации](declaring-an-association-class.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-159">For more information, see [Declaring an Association Class](declaring-an-association-class.md).</span></span>
-   <span data-ttu-id="84a62-160">Если экземпляр не существует за пределами родительского объекта, лучше подходит внедренный объект.</span><span class="sxs-lookup"><span data-stu-id="84a62-160">If an instance does not exist outside of the parent object, an embedded object works best.</span></span> <span data-ttu-id="84a62-161">Например, [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) и [**\_ ACE Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-ace).</span><span class="sxs-lookup"><span data-stu-id="84a62-161">For example, [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) and [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace).</span></span> <span data-ttu-id="84a62-162">Дополнительные сведения см. [в разделе внедрение объектов в класс](embedded-objects.md).</span><span class="sxs-lookup"><span data-stu-id="84a62-162">For more information, see [Embedding Objects in a Class](embedded-objects.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="84a62-163">См. также</span><span class="sxs-lookup"><span data-stu-id="84a62-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="84a62-164">Разработка поставщика WMI</span><span class="sxs-lookup"><span data-stu-id="84a62-164">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="84a62-165">Предоставление данных инструментарию WMI</span><span class="sxs-lookup"><span data-stu-id="84a62-165">Providing Data to WMI</span></span>](providing-data-to-wmi.md)
</dt> <dt>

[<span data-ttu-id="84a62-166">Типы данных MOF</span><span class="sxs-lookup"><span data-stu-id="84a62-166">MOF Data Types</span></span>](mof-data-types.md)
</dt> </dl>

 

 
