---
description: Для подключения к удаленному компьютеру с помощью инструментария WMI убедитесь, что для подключения включены правильные параметры DCOM и параметры безопасности пространства имен WMI.
ms.assetid: 96ebaa9b-a062-4300-a637-8eb71cb80d1c
ms.tgt_platform: multiple
title: Защита удаленного WMI-подключения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df2a044e49fed5eaa27fbc246dca3306a6c29650
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104544687"
---
# <a name="securing-a-remote-wmi-connection"></a><span data-ttu-id="8aff4-103">Защита удаленного WMI-подключения</span><span class="sxs-lookup"><span data-stu-id="8aff4-103">Securing a Remote WMI Connection</span></span>

<span data-ttu-id="8aff4-104">Для подключения к удаленному компьютеру с помощью инструментария WMI убедитесь, что для подключения включены правильные параметры DCOM и параметры безопасности пространства имен WMI.</span><span class="sxs-lookup"><span data-stu-id="8aff4-104">To connect to a remote computer using WMI, ensure that the correct DCOM settings and WMI namespace security settings are enabled for the connection.</span></span>

<span data-ttu-id="8aff4-105">Инструментарий WMI имеет параметры олицетворения, проверки подлинности и службы проверки подлинности (NTLM или Kerberos) по умолчанию, необходимые для целевого компьютера в удаленном подключении.</span><span class="sxs-lookup"><span data-stu-id="8aff4-105">WMI has default impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the target computer in a remote connection requires.</span></span> <span data-ttu-id="8aff4-106">На локальном компьютере могут использоваться разные значения по умолчанию, которые целевая система не принимает.</span><span class="sxs-lookup"><span data-stu-id="8aff4-106">Your local machine may use different defaults that the target system does not accept.</span></span> <span data-ttu-id="8aff4-107">Эти параметры можно изменить в вызове соединения.</span><span class="sxs-lookup"><span data-stu-id="8aff4-107">You can change these settings in the connection call.</span></span>

<span data-ttu-id="8aff4-108">В этом разделе обсуждаются следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="8aff4-108">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="8aff4-109">Параметры олицетворения и проверки подлинности DCOM для WMI</span><span class="sxs-lookup"><span data-stu-id="8aff4-109">DCOM Impersonation and Authentication Settings for WMI</span></span>](#dcom-impersonation-and-authentication-settings-for-wmi)
-   [<span data-ttu-id="8aff4-110">Настройка безопасности DCOM для удаленного доступа пользователя к компьютеру</span><span class="sxs-lookup"><span data-stu-id="8aff4-110">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>](#setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely)
-   [<span data-ttu-id="8aff4-111">Предоставление пользователям доступа к определенному пространству имен WMI</span><span class="sxs-lookup"><span data-stu-id="8aff4-111">Allowing Users Access to a Specific WMI Namespace</span></span>](#allowing-users-access-to-a-specific-wmi-namespace)
-   [<span data-ttu-id="8aff4-112">Настройка безопасности пространства имен для обязательного шифрования данных для удаленных подключений</span><span class="sxs-lookup"><span data-stu-id="8aff4-112">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>](#setting-namespace-security-to-require-data-encryption-for-remote-connections)
-   [<span data-ttu-id="8aff4-113">См. также</span><span class="sxs-lookup"><span data-stu-id="8aff4-113">Related topics</span></span>](#related-topics)

## <a name="dcom-impersonation-and-authentication-settings-for-wmi"></a><span data-ttu-id="8aff4-114">Параметры олицетворения и проверки подлинности DCOM для WMI</span><span class="sxs-lookup"><span data-stu-id="8aff4-114">DCOM Impersonation and Authentication Settings for WMI</span></span>

<span data-ttu-id="8aff4-115">WMI использует параметры олицетворения DCOM по умолчанию, проверки подлинности и службы проверки подлинности (NTLM или Kerberos), необходимые удаленной системе.</span><span class="sxs-lookup"><span data-stu-id="8aff4-115">WMI has default DCOM impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the a remote system requires.</span></span> <span data-ttu-id="8aff4-116">Локальная система может использовать разные значения по умолчанию, которые не принимает Целевая удаленная система.</span><span class="sxs-lookup"><span data-stu-id="8aff4-116">Your local system may use different defaults that the target remote system does not accept.</span></span> <span data-ttu-id="8aff4-117">Эти параметры можно изменить в вызове соединения.</span><span class="sxs-lookup"><span data-stu-id="8aff4-117">You can change these settings in the connection call.</span></span> <span data-ttu-id="8aff4-118">Дополнительные сведения см. в разделе [Установка параметров безопасности процессов для клиентских приложений](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="8aff4-118">For more information, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span> <span data-ttu-id="8aff4-119">Однако для службы проверки подлинности рекомендуется указать **RPC \_ C \_ AUTHN \_ по умолчанию** и разрешить DCOM выбрать соответствующую службу для целевого компьютера.</span><span class="sxs-lookup"><span data-stu-id="8aff4-119">However, for the authentication service, it is recommended that you specify **RPC\_C\_AUTHN\_DEFAULT** and allow DCOM to choose the appropriate service for the target computer.</span></span>

<span data-ttu-id="8aff4-120">Вы можете указать параметры в параметрах для вызовов [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) или [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) в C++.</span><span class="sxs-lookup"><span data-stu-id="8aff4-120">You can supply settings in parameters for the calls to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span></span> <span data-ttu-id="8aff4-121">В скриптах можно установить параметры безопасности в вызовах [**SWbemLocator. коннектсервер**](swbemlocator-connectserver.md), в объекте [**свбемсекурити**](swbemsecurity.md) или в строке [моникера](constructing-a-moniker-string.md) скрипта.</span><span class="sxs-lookup"><span data-stu-id="8aff4-121">In scripts, you can establish security settings in calls to [**SWbemLocator.ConnectServer**](swbemlocator-connectserver.md), in an [**SWbemSecurity**](swbemsecurity.md) object, or in the scripting [moniker](constructing-a-moniker-string.md) string.</span></span>

<span data-ttu-id="8aff4-122">Список всех констант олицетворения C++ см. в разделе [Задание уровня безопасности процесса по умолчанию с помощью C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="8aff4-122">For a list of all the C++ impersonation constants, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span> <span data-ttu-id="8aff4-123">Сведения о Visual Basic констант и строках скрипта для использования моникера Connection см. в разделе [Задание уровня безопасности процесса по умолчанию с помощью VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="8aff4-123">For the Visual Basic constants and scripting strings for using the moniker connection, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

<span data-ttu-id="8aff4-124">В следующей таблице перечислены параметры олицетворения DCOM, проверки подлинности и службы проверки подлинности по умолчанию, необходимые конечному компьютеру (компьютер б) в удаленном соединении.</span><span class="sxs-lookup"><span data-stu-id="8aff4-124">The following table lists the default DCOM impersonation, authentication, and authentication service settings required by the target computer (Computer B) in a remote connection.</span></span> <span data-ttu-id="8aff4-125">Дополнительные сведения см. в разделе Защита удаленного WMI-подключения.</span><span class="sxs-lookup"><span data-stu-id="8aff4-125">For more information, see Securing a Remote WMI Connection.</span></span>



| <span data-ttu-id="8aff4-126">Операционная система компьютера B</span><span class="sxs-lookup"><span data-stu-id="8aff4-126">Computer B operating system</span></span> | <span data-ttu-id="8aff4-127">Строка скрипта для уровня олицетворения</span><span class="sxs-lookup"><span data-stu-id="8aff4-127">Impersonation level scripting string</span></span> | <span data-ttu-id="8aff4-128">Строка скрипта уровня проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="8aff4-128">Authentication level scripting string</span></span> | <span data-ttu-id="8aff4-129">Служба проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="8aff4-129">Authentication service</span></span> |
|-----------------------------|--------------------------------------|---------------------------------------|------------------------|
| <span data-ttu-id="8aff4-130">Windows Vista или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="8aff4-130">Windows Vista or later</span></span>      | <span data-ttu-id="8aff4-131">Impersonate</span><span class="sxs-lookup"><span data-stu-id="8aff4-131">Impersonate</span></span>                          | <span data-ttu-id="8aff4-132">PKT</span><span class="sxs-lookup"><span data-stu-id="8aff4-132">Pkt</span></span>                                   | <span data-ttu-id="8aff4-133">Kerberos</span><span class="sxs-lookup"><span data-stu-id="8aff4-133">Kerberos</span></span>               |



 

<span data-ttu-id="8aff4-134">На удаленные подключения WMI влияют [контроль учетных записей (UAC)](/previous-versions/aa905108(v=msdn.10)) и [Брандмауэр Windows](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span><span class="sxs-lookup"><span data-stu-id="8aff4-134">WMI remote connections are affected by [User Account Control (UAC)](/previous-versions/aa905108(v=msdn.10)) and [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span></span> <span data-ttu-id="8aff4-135">Дополнительные сведения см. [в статье подключение к инструментарию WMI удаленно с помощью Vista](connecting-to-wmi-remotely-starting-with-vista.md) и [подключение через брандмауэр Windows](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span><span class="sxs-lookup"><span data-stu-id="8aff4-135">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md) and [Connecting Through Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span></span>

<span data-ttu-id="8aff4-136">Имейте в виду, что подключение к WMI на локальном компьютере имеет уровень проверки подлинности **пктприваци** по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8aff4-136">Be aware that connecting to WMI on the local computer has a default authentication level of **PktPrivacy**.</span></span>

## <a name="setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely"></a><span data-ttu-id="8aff4-137">Настройка безопасности DCOM для удаленного доступа пользователя к компьютеру</span><span class="sxs-lookup"><span data-stu-id="8aff4-137">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>

<span data-ttu-id="8aff4-138">Безопасность в WMI связана с подключением к пространству имен WMI.</span><span class="sxs-lookup"><span data-stu-id="8aff4-138">Security in WMI is related to connecting to a WMI namespace.</span></span> <span data-ttu-id="8aff4-139">Инструментарий WMI использует DCOM для управления удаленными вызовами.</span><span class="sxs-lookup"><span data-stu-id="8aff4-139">WMI uses DCOM to handle remote calls.</span></span> <span data-ttu-id="8aff4-140">Одной из причин сбоя подключения к удаленному компьютеру является сбой DCOM (ошибка "доступ DCOM запрещен" — десятичное число 2147024891 или шестнадцатеричное 0x80070005).</span><span class="sxs-lookup"><span data-stu-id="8aff4-140">One reason for failure to connect to a remote computer is due to a DCOM failure (error "DCOM Access Denied" decimal -2147024891 or hex 0x80070005).</span></span> <span data-ttu-id="8aff4-141">Дополнительные сведения о безопасности DCOM в инструментарии WMI для приложений C++ см. в разделе [Установка параметров безопасности процессов для клиентских приложений](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="8aff4-141">For more information about DCOM security in WMI for C++ applications, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span>

<span data-ttu-id="8aff4-142">Параметры DCOM для WMI можно настроить с помощью служебной программы настройки DCOM (**DCOMCnfg.exe**), которая находится в **меню "Администрирование** " на **панели управления**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-142">You can configure DCOM settings for WMI using the DCOM Config utility (**DCOMCnfg.exe**) found in **Administrative Tools** in **Control Panel**.</span></span> <span data-ttu-id="8aff4-143">Эта программа предоставляет параметры, позволяющие определенным пользователям подключаться к компьютеру удаленно через DCOM.</span><span class="sxs-lookup"><span data-stu-id="8aff4-143">This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM.</span></span> <span data-ttu-id="8aff4-144">Члены группы "Администраторы" могут удаленно подключаться к компьютеру по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8aff4-144">Members of the Administrators group are allowed to remotely connect to the computer by default.</span></span> <span data-ttu-id="8aff4-145">С помощью этой служебной программы можно настроить безопасность для запуска, доступа и настройки службы WMI.</span><span class="sxs-lookup"><span data-stu-id="8aff4-145">With this utility you can set the security to start, access, and configure the WMI service.</span></span>

<span data-ttu-id="8aff4-146">В следующей процедуре описывается, как предоставить разрешения на удаленный запуск и активацию DCOM для определенных пользователей и групп.</span><span class="sxs-lookup"><span data-stu-id="8aff4-146">The following procedure describes how to grant DCOM remote startup and activation permissions for certain users and groups.</span></span> <span data-ttu-id="8aff4-147">Если компьютер A удаленно подключается к компьютеру б, можно установить эти разрешения на компьютере B, чтобы разрешить запуск DCOM на компьютере b для пользователя или группы, не входящей в группу администраторов на компьютере B.</span><span class="sxs-lookup"><span data-stu-id="8aff4-147">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to execute DCOM startup and activation calls on Computer B.</span></span>

<span data-ttu-id="8aff4-148">**Предоставление разрешений на удаленный запуск и активацию DCOM для пользователя или группы**</span><span class="sxs-lookup"><span data-stu-id="8aff4-148">**To grant DCOM remote launch and activation permissions for a user or group**</span></span>

1.  <span data-ttu-id="8aff4-149">Нажмите кнопку **Пуск**, выберите пункт **выполнить**, введите **DCOMCNFG** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-149">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="8aff4-150">В диалоговом окне **службы компонентов** разверните узел **службы компонентов**, разверните узел **Компьютеры**, а затем щелкните правой кнопкой мыши элемент **Мой компьютер** и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-150">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="8aff4-151">В диалоговом окне **свойства мой компьютер** перейдите на вкладку **Безопасность COM** .</span><span class="sxs-lookup"><span data-stu-id="8aff4-151">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="8aff4-152">В разделе **разрешения на запуск и активацию** нажмите кнопку **изменить ограничения**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-152">Under **Launch and Activation Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="8aff4-153">В диалоговом окне **разрешение на запуск** выполните следующие действия, если имя или группа не отображаются в **списке группы или имена пользователей**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-153">In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names list**:</span></span>

    1.  <span data-ttu-id="8aff4-154">В диалоговом окне **разрешение на запуск** нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-154">In the **Launch Permission** dialog box, click **Add**.</span></span>
    2.  <span data-ttu-id="8aff4-155">В диалоговом окне **Выбор пользователей, компьютеров или групп** добавьте имя и группу в поле **Введите имена объектов для выбора** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-155">In the **Select Users, Computers, or Groups** dialog box, add your name and the group in the **Enter the object names to select** box, and then click **OK**.</span></span>

6.  <span data-ttu-id="8aff4-156">В диалоговом окне **разрешение на запуск** выберите пользователя и группу в поле **группы или пользователи** .</span><span class="sxs-lookup"><span data-stu-id="8aff4-156">In the **Launch Permission** dialog box, select your user and group in the **Group or user names** box.</span></span> <span data-ttu-id="8aff4-157">В столбце **Разрешить** в разделе **разрешения для пользователя** выберите **Удаленный запуск** и выберите **Удаленная активация**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-157">In the **Allow** column under **Permissions for User**, select **Remote Launch** and select **Remote Activation**, and then click **OK**.</span></span>

<span data-ttu-id="8aff4-158">В следующей процедуре описывается предоставление разрешений на удаленный доступ DCOM для определенных пользователей и групп.</span><span class="sxs-lookup"><span data-stu-id="8aff4-158">The following procedure describes how to grant DCOM remote access permissions for certain users and groups.</span></span> <span data-ttu-id="8aff4-159">Если компьютер A удаленно подключается к компьютеру б, можно установить эти разрешения на компьютере B, чтобы разрешить пользователю или группе, не входящему в группу "Администраторы" на компьютере B, подключаться к компьютеру B.</span><span class="sxs-lookup"><span data-stu-id="8aff4-159">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to connect to Computer B.</span></span>

<span data-ttu-id="8aff4-160">**Предоставление разрешений на удаленный доступ DCOM**</span><span class="sxs-lookup"><span data-stu-id="8aff4-160">**To grant DCOM remote access permissions**</span></span>

1.  <span data-ttu-id="8aff4-161">Нажмите кнопку **Пуск**, выберите пункт **выполнить**, введите **DCOMCNFG** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-161">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="8aff4-162">В диалоговом окне **службы компонентов** разверните узел **службы компонентов**, разверните узел **Компьютеры**, а затем щелкните правой кнопкой мыши элемент **Мой компьютер** и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-162">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="8aff4-163">В диалоговом окне **свойства мой компьютер** перейдите на вкладку **Безопасность COM** .</span><span class="sxs-lookup"><span data-stu-id="8aff4-163">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="8aff4-164">В разделе **разрешения на доступ** нажмите кнопку **изменить ограничения**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-164">Under **Access Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="8aff4-165">В диалоговом окне **разрешение доступа** выберите имя **анонимного входа** в поле **имена групп или пользователей** .</span><span class="sxs-lookup"><span data-stu-id="8aff4-165">In the **Access Permission** dialog box, select **ANONYMOUS LOGON** name in the **Group or user names** box.</span></span> <span data-ttu-id="8aff4-166">В столбце **Разрешить** в разделе **разрешения для пользователя** выберите **Удаленный доступ**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-166">In the **Allow** column under **Permissions for User**, select **Remote Access**, and then click **OK**.</span></span>

## <a name="allowing-users-access-to-a-specific-wmi-namespace"></a><span data-ttu-id="8aff4-167">Предоставление пользователям доступа к определенному пространству имен WMI</span><span class="sxs-lookup"><span data-stu-id="8aff4-167">Allowing Users Access to a Specific WMI Namespace</span></span>

<span data-ttu-id="8aff4-168">Вы можете разрешить или запретить пользователям доступ к определенному пространству имен WMI, установив разрешение Remote Enable в элементе управления WMI для пространства имен.</span><span class="sxs-lookup"><span data-stu-id="8aff4-168">You can allow or disallow users access to a specific WMI namespace by setting the "Remote Enable" permission in the WMI Control for a namespace.</span></span> <span data-ttu-id="8aff4-169">Если пользователь пытается подключиться к пространству имен, к которому им не разрешен доступ, они получат ошибку 0x80041003.</span><span class="sxs-lookup"><span data-stu-id="8aff4-169">If a user tries to connect to a namespace they are not allowed access to, they will receive error 0x80041003.</span></span> <span data-ttu-id="8aff4-170">По умолчанию это разрешение включено только для администраторов.</span><span class="sxs-lookup"><span data-stu-id="8aff4-170">By default, this permission is enabled only for administrators.</span></span> <span data-ttu-id="8aff4-171">Администратор может включить удаленный доступ к конкретным пространствам имен WMI для пользователя, не имеющего прав администратора.</span><span class="sxs-lookup"><span data-stu-id="8aff4-171">An administrator can enable remote access to specific WMI namespaces for a nonadministrator user.</span></span>

<span data-ttu-id="8aff4-172">Следующая процедура задает разрешения на удаленную включение для пользователя без прав администратора.</span><span class="sxs-lookup"><span data-stu-id="8aff4-172">The following procedure sets remote enable permissions for a non-administrator user.</span></span>

<span data-ttu-id="8aff4-173">**Установка разрешений на удаленное включение**</span><span class="sxs-lookup"><span data-stu-id="8aff4-173">**To set remote enable permissions**</span></span>

1.  <span data-ttu-id="8aff4-174">Подключитесь к удаленному компьютеру с помощью элемента управления WMI.</span><span class="sxs-lookup"><span data-stu-id="8aff4-174">Connect to the remote computer using the WMI Control.</span></span>

    <span data-ttu-id="8aff4-175">Дополнительные сведения об элементе управления WMI см. [в разделе Настройка безопасности пространства имен с помощью элемента управления WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="8aff4-175">For more information about the WMI Control, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

2.  <span data-ttu-id="8aff4-176">На вкладке **Безопасность** выберите пространство имен и щелкните **Безопасность**.</span><span class="sxs-lookup"><span data-stu-id="8aff4-176">In the **Security** tab, select the namespace and click **Security**.</span></span>
3.  <span data-ttu-id="8aff4-177">Откройте соответствующую учетную запись и установите флажок **включить удаленно** в списке **разрешений** .</span><span class="sxs-lookup"><span data-stu-id="8aff4-177">Locate the appropriate account and check **Remote Enable** in the **Permissions** list.</span></span>

## <a name="setting-namespace-security-to-require-data-encryption-for-remote-connections"></a><span data-ttu-id="8aff4-178">Настройка безопасности пространства имен для обязательного шифрования данных для удаленных подключений</span><span class="sxs-lookup"><span data-stu-id="8aff4-178">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>

<span data-ttu-id="8aff4-179">Администратор или MOF-файл может настроить пространство имен WMI таким образом, чтобы никакие данные не возвращались, если только вы не используете конфиденциальность пакетов (**RPC \_ C \_ уровня "AUTHN \_ \_ \_** " или **пктприваци** в качестве моникера в сценарии) в соединении с этим пространством имен.</span><span class="sxs-lookup"><span data-stu-id="8aff4-179">An administrator or a MOF file can configure a WMI namespace so that no data is returned unless you use packet privacy (**RPC\_C\_AUTHN\_LEVEL\_PKT\_PRIVACY** or **PktPrivacy** as a moniker in a script) in a connection to that namespace.</span></span> <span data-ttu-id="8aff4-180">Это гарантирует, что данные шифруются по мере пересечения сети.</span><span class="sxs-lookup"><span data-stu-id="8aff4-180">This ensures that data is encrypted as it crosses the network.</span></span> <span data-ttu-id="8aff4-181">При попытке задать более низкий уровень проверки подлинности будет получено сообщение об отказе в доступе.</span><span class="sxs-lookup"><span data-stu-id="8aff4-181">If you try to set a lower authentication level, you will get an access denied message.</span></span> <span data-ttu-id="8aff4-182">Дополнительные сведения см. в разделе [требуется зашифрованное соединение с пространством имен](requiring-an-encrypted-connection-to-a-namespace.md).</span><span class="sxs-lookup"><span data-stu-id="8aff4-182">For more information, see [Requiring an Encrypted Connection to a Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span></span>

<span data-ttu-id="8aff4-183">В следующем примере кода VBScript показано, как подключиться к зашифрованному пространству имен с помощью "Пктприваци".</span><span class="sxs-lookup"><span data-stu-id="8aff4-183">The following VBScript code example shows how to connect to an encrypted namespace using "pktPrivacy".</span></span>


```VB
strComputer = "RemoteComputer"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" _
                              & strComputer & "\root\EncryptedNamespace")
```



## <a name="related-topics"></a><span data-ttu-id="8aff4-184">См. также</span><span class="sxs-lookup"><span data-stu-id="8aff4-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8aff4-185">Делегирование с помощью WMI</span><span class="sxs-lookup"><span data-stu-id="8aff4-185">Delegating with WMI</span></span>](connecting-to-a-3rd-computer-delegation.md)
</dt> <dt>

[<span data-ttu-id="8aff4-186">Удаленное создание процессов с помощью WMI</span><span class="sxs-lookup"><span data-stu-id="8aff4-186">Creating Processes Remotely with WMI</span></span>](creating-processes-remotely.md)
</dt> <dt>

[<span data-ttu-id="8aff4-187">Защита клиентов и поставщиков C++</span><span class="sxs-lookup"><span data-stu-id="8aff4-187">Securing C++ Clients and Providers</span></span>](securing-c---clients-and-providers.md)
</dt> <dt>

[<span data-ttu-id="8aff4-188">Защита клиентов скриптов</span><span class="sxs-lookup"><span data-stu-id="8aff4-188">Securing Scripting Clients</span></span>](securing-scripting-clients.md)
</dt> </dl>

 

 
