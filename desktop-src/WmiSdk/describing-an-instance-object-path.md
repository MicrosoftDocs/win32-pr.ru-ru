---
description: Путь к объекту экземпляра описывает расположение экземпляра данного класса в определенном пространстве имен.
ms.assetid: 78a194f0-cd21-4622-9242-be7e430b96c0
ms.tgt_platform: multiple
title: Описание пути к объекту экземпляра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a152d68390c899709cfe6041bfa2880482a0d4498dc371aafd4426aef8f14489
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119412064"
---
# <a name="describing-an-instance-object-path"></a>Описание пути к объекту экземпляра

Путь к объекту экземпляра описывает расположение экземпляра данного класса в определенном пространстве имен.

Можно использовать несколько различных типов путей объектов экземпляров.

-   Полное

    Путь к объекту полного экземпляра добавляет имя и значение ключевого свойства класса в полный путь к объекту класса.

    В следующем примере показано определение пути к объекту полного экземпляра.

    ``` syntax
    \\Server\Namespace:Class.KeyName="KeyValue"
    ```

-   Относительное значение

    Относительный путь к объекту ссылается на экземпляр, расположенный в текущем пространстве имен на текущем сервере. Относительный путь состоит из имени класса, за которым следуют имена и значения ключевых свойств этого экземпляра.

    В следующем примере показано определение пути к объекту относительного экземпляра.

    ``` syntax
    MyClass.MyProp="e:"
    ```

-   Относительно одного ключа

    Для классов с одним свойством, назначенным в качестве ключа, можно опустить имя ключевого свойства.

    В следующем примере показано определение пути к объекту относительного экземпляра с одним ключом.

    ``` syntax
    MyClass="e:"
    ```

-   Относительно нескольких ключей

    Используйте запятую для различения ключей экземпляра с несколькими ключами.

    В следующем примере показаны определения пути к объекту относительного экземпляра с несколькими ключами.

    ``` syntax
    MyOtherClass.FirstKey=1,SecondKey=2
    ```

-   Относительно одноэлементного класса

    Относительный путь к объекту для одноэлементного класса состоит из имени класса, за которым следует нотация "= @".

    В следующем примере показано определение пути к объекту относительного экземпляра для одноэлементного класса.

    ``` syntax
    MySingletonClass=@
    ```

В следующей процедуре описывается извлечение экземпляра класса.

**Извлечение экземпляра класса**

1.  Инициализируйте строку, содержащую путь к объекту, с помощью вызова функции [**сисаллокстринг**](/windows/win32/api/oleauto/nf-oleauto-sysallocstring) .
2.  Инициализируйте объект, который будет принимать экземпляр.
3.  Извлеките объект с помощью вызова [**IWbemServices:: GetObject**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-getobject) или [**IWbemServices:: жетобжектасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-getobjectasync).

    Чтобы использовать [**жетобжектасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-getobjectasync), необходимо реализовать интерфейс [**ивбемсинк**](swbemsink.md) .

Следующая \# Инструкция include необходима для правильной компиляции кода, приведенного далее в этом разделе.


```C++
#include <wbemidl.h>
```



В следующем примере кода показано, как получить экземпляр класса, используя путь к объекту.


```C++
IWbemServices* pWbemSvcs = 0;

BSTR Path = SysAllocString(L"ComPort=2");    
IWbemClassObject *pComPort = 0;
pWbemSvcs->GetObject(Path, 0, 0, &pComPort, 0);
```



Для экземпляров классов, в которых в качестве ключа задано несколько свойств, инструментарию WMI не требуется конкретное упорядочение ключевых свойств в путях объектов. Необходимо указать только значение каждого свойства в пути к объекту.

В следующем примере кода описаны два эквивалентных описания ключа.

``` syntax
MyClass.IntVal=33,StrVal="AAA"
MyClass.StrVal="AAA",IntVal=33
```

 

 
