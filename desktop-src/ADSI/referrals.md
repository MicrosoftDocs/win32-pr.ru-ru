---
title: Ссылки (ADSI)
description: Ссылки происходят, когда запрашиваемый сервер не содержит этих данных, но может его найти.
ms.assetid: 2068ce7a-0b94-4d25-a18f-97f26863bd1d
ms.tgt_platform: multiple
keywords:
- Ссылки ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e79e6b2e8a737f6bb40386effd68f7f31d8d490d
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104134563"
---
# <a name="referrals-adsi"></a><span data-ttu-id="bbe47-104">Ссылки (ADSI)</span><span class="sxs-lookup"><span data-stu-id="bbe47-104">Referrals (ADSI)</span></span>

<span data-ttu-id="bbe47-105">Ссылки происходят, когда запрашиваемый сервер не содержит этих данных, но может его найти.</span><span class="sxs-lookup"><span data-stu-id="bbe47-105">Referrals occur when the server you are querying does not contain that data, but can find it.</span></span> <span data-ttu-id="bbe47-106">Целевой сервер возвращает результирующий набор, который может содержать как фактические данные, так и ссылку на другой сервер для получения дополнительных данных.</span><span class="sxs-lookup"><span data-stu-id="bbe47-106">The target server returns the result set, which may include both the actual data and a referral to another server to retrieve the additional data.</span></span> <span data-ttu-id="bbe47-107">Включив *Отслеживание ссылок*, базовый код клиента ADSI будет использовать эти ссылочные данные, чтобы попытаться получить целевой объект с сервера, описанного в ссылочных данных.</span><span class="sxs-lookup"><span data-stu-id="bbe47-107">By enabling *referral chasing*, the underlying ADSI client code will use that referral data to attempt to retrieve the target object from the server described in the referral data.</span></span> <span data-ttu-id="bbe47-108">Имейте в виду, что отключение отслеживание ссылок может привести к уменьшению результирующего набора, в то время как включение отслеживание ссылок может привести к тому, что запрос будет охватывать много серверов.</span><span class="sxs-lookup"><span data-stu-id="bbe47-108">Be aware that the disabling referral chasing may result in a smaller result set, whereas enabling referral chasing may cause a query to span many servers.</span></span> <span data-ttu-id="bbe47-109">Если это возможно, рекомендуемым решением будет использование глобального каталога.</span><span class="sxs-lookup"><span data-stu-id="bbe47-109">When possible, the recommended solution is to use the global catalog.</span></span>

<span data-ttu-id="bbe47-110">Дополнительные сведения о ссылках и прослеживании ссылок в Active Directory см. в разделе [ссылки](/windows/desktop/AD/referrals).</span><span class="sxs-lookup"><span data-stu-id="bbe47-110">For more information about referrals and referral chasing in Active Directory, see [Referrals](/windows/desktop/AD/referrals).</span></span>

<span data-ttu-id="bbe47-111">Например, когда клиент сообщает серверу A (а) о запросе объекта пользователя (U), может предложить, что клиент продолжит поиск на сервере B (б), если U не находится в, но известно как B. Клиент имеет возможность выбора в соответствии с ссылкой или нет.</span><span class="sxs-lookup"><span data-stu-id="bbe47-111">For example, when a client instructs Server A (A) to query a user object (U), A can suggest that the client continue the search on Server B (B) if U does not reside on A, but is known to be on B. The client has the choice of pursuing the referral or not.</span></span> <span data-ttu-id="bbe47-112">Поиск по ссылкам освобождает клиента от обязательного расширенного распознавания возможностей каждого сервера.</span><span class="sxs-lookup"><span data-stu-id="bbe47-112">Search referrals free the client from requiring advanced recognition of the capability of each server.</span></span> <span data-ttu-id="bbe47-113">Однако клиент должен указать тип ссылок, которые должен выполнить сервер.</span><span class="sxs-lookup"><span data-stu-id="bbe47-113">However, the client must specify the type of referrals a server should make.</span></span>

<span data-ttu-id="bbe47-114">Active Directory предлагает службы поиска по справочным службам.</span><span class="sxs-lookup"><span data-stu-id="bbe47-114">Active Directory offers search referral services.</span></span> <span data-ttu-id="bbe47-115">Клиент может выбрать любой из следующих типов прослеживания ссылок:</span><span class="sxs-lookup"><span data-stu-id="bbe47-115">A client can choose any of the following types of referral chasing:</span></span>

-   <span data-ttu-id="bbe47-116">Никогда: сервер не должен создавать ссылку на клиент, хотя он распознает, что другой сервер хранит запрошенные данные.</span><span class="sxs-lookup"><span data-stu-id="bbe47-116">Never: The server should not generate a referral to a client even though it recognizes that another server stores the requested data.</span></span>
-   <span data-ttu-id="bbe47-117">External: сервер должен создавать ссылки, если запрос может быть разрешен на другом сервере другого дерева каталогов.</span><span class="sxs-lookup"><span data-stu-id="bbe47-117">External: The server should generate referrals if the request can be resolved on another server of a different directory tree.</span></span> <span data-ttu-id="bbe47-118">Например, клиент запрашивает "OU = Sales, DC = Fabrikam, DC = COM" на сервере "fab01" в домене "Fabrikam.com".</span><span class="sxs-lookup"><span data-stu-id="bbe47-118">For example, a client queries "OU=Sales,DC=Fabrikam,DC=COM" on the "fab01" server on the "Fabrikam.com" domain.</span></span> <span data-ttu-id="bbe47-119">Однако объект не принадлежит "fab01", но известно, что он находится на сервере "ARC01" в домене "Fabrikam.com".</span><span class="sxs-lookup"><span data-stu-id="bbe47-119">However, the object does not belong to "fab01", but is known to be on the "arc01" server on the "Fabrikam.com" domain.</span></span> <span data-ttu-id="bbe47-120">Таким словами, "fab01" указывает клиенту на "ARC01".</span><span class="sxs-lookup"><span data-stu-id="bbe47-120">Thus, "fab01" refers the client to "arc01".</span></span>
-   <span data-ttu-id="bbe47-121">Подчиненный: сервер должен создавать ссылки, если запрос может быть разрешен на сервере, имя которого образует непрерывный путь от исходного сервера.</span><span class="sxs-lookup"><span data-stu-id="bbe47-121">Subordinate: The server should generate referrals if the request can be resolved on a server whose name forms a contiguous path from the originating server.</span></span> <span data-ttu-id="bbe47-122">Область поиска должна быть на уровне поддерева.</span><span class="sxs-lookup"><span data-stu-id="bbe47-122">The search scope must be at the subtree level.</span></span>

    <span data-ttu-id="bbe47-123">Например, сервер A содержит объекты в «DC = Sales, DC = Fabrikam, DC = com».</span><span class="sxs-lookup"><span data-stu-id="bbe47-123">For example, Server A contains objects in "DC=Sales,DC=Fabrikam,DC=Com".</span></span> <span data-ttu-id="bbe47-124">Сервер B содержит объекты в "DC = Сиэтл, DC = Sales, DC = Fabrikam, DC = com".</span><span class="sxs-lookup"><span data-stu-id="bbe47-124">Server B contains objects in "DC=Seattle,DC=Sales,DC=Fabrikam,DC=Com".</span></span> <span data-ttu-id="bbe47-125">Имейте в виду, что имя сервера B образует непрерывный путь от сервера A. Когда клиент обращается к серверу A, запрос к поддереву "DC = Sales, DC = Fabrikam, DC = com" запрашивается и указывает, что ссылка является подчиненным типом, возникает следующее событие:</span><span class="sxs-lookup"><span data-stu-id="bbe47-125">Be aware that the name of Server B forms a contiguous path from Server A. When a client contacts Server A, requests a subtree search on "DC=Sales,DC=Fabrikam,DC=Com", and specifies the referral to be a subordinate type, the following event occurs:</span></span>

    -   <span data-ttu-id="bbe47-126">Сервер A возвращает все объекты, которые он знает в области.</span><span class="sxs-lookup"><span data-stu-id="bbe47-126">Server A returns all objects that it knows within its scope.</span></span>
    -   <span data-ttu-id="bbe47-127">Сервер A информирует клиента, что объекты в "DC = Сиэтл, DC = Sales, DC = Fabrikam, DC = COM" можно найти на сервере B.</span><span class="sxs-lookup"><span data-stu-id="bbe47-127">Server A informs the client that objects in "DC=Seattle,DC=Sales,DC=Fabrikam,DC=COM" can be found on Server B.</span></span>

    <span data-ttu-id="bbe47-128">Клиент может выбрать связь с сервером б. Если это так, происходит следующее событие:</span><span class="sxs-lookup"><span data-stu-id="bbe47-128">The client can choose to contact Server B. If so, the following event occurs:</span></span>

    -   <span data-ttu-id="bbe47-129">Сервер B отвечает запрошенным объектам.</span><span class="sxs-lookup"><span data-stu-id="bbe47-129">Server B responds with the requested objects.</span></span>
    -   <span data-ttu-id="bbe47-130">Если сервер B обнаруживает другие серверы по непрерывному пути именования и процесс продолжится.</span><span class="sxs-lookup"><span data-stu-id="bbe47-130">If Server B detects other servers on the contiguous naming path and the process continues.</span></span>

-   <span data-ttu-id="bbe47-131">Всегда: сервер создает ссылки, если поиск может быть разрешен на основе внешнего типа или подчиненного типа.</span><span class="sxs-lookup"><span data-stu-id="bbe47-131">Always: The server generates referrals if the search can be resolved based on either the external type or the subordinate type.</span></span>

> [!Note]  
> <span data-ttu-id="bbe47-132">В Active Directory глобальный каталог содержит все объекты в определенном предприятии.</span><span class="sxs-lookup"><span data-stu-id="bbe47-132">In Active Directory, the global catalog contains all objects in a given enterprise.</span></span> <span data-ttu-id="bbe47-133">Поиск сервера глобального каталога обеспечивает лучшую производительность, чем в соответствии с тем, что предоставляет ссылки с одного сервера на другой.</span><span class="sxs-lookup"><span data-stu-id="bbe47-133">Searching a global catalog server yields better performance than pursuing referrals from one server to another.</span></span>

 

<span data-ttu-id="bbe47-134">В большинстве случаев отслеживание ссылок будет прозрачным для вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="bbe47-134">In most cases, the referral chasing will be transparent to the caller.</span></span> <span data-ttu-id="bbe47-135">Если ссылка относится к объекту в другом домене или лесу, базовый API LDAP будет пытаться использовать текущие учетные данные для привязки к целевому объекту ссылки.</span><span class="sxs-lookup"><span data-stu-id="bbe47-135">If the referral is to an object in a different domain or forest, the underlying LDAP API will attempt to use the current credentials to bind to the target of the referral.</span></span> <span data-ttu-id="bbe47-136">В случае успеха отслеживание ссылок будет прозрачным.</span><span class="sxs-lookup"><span data-stu-id="bbe47-136">If this is successful, the referral chasing will be transparent.</span></span> <span data-ttu-id="bbe47-137">Если это не удалось, будет возвращена ссылка и код ошибки ссылки.</span><span class="sxs-lookup"><span data-stu-id="bbe47-137">If this is not successful, the referral and a referral error code will be returned.</span></span>

<span data-ttu-id="bbe47-138">Дополнительные сведения об использовании параметров прослеживания ссылок с конкретным интерфейсом поиска см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="bbe47-138">For more information about using the referral chasing options with a specific search interface, see:</span></span>

-   [<span data-ttu-id="bbe47-139">Отслеживание ссылок с помощью IDirectorySearch</span><span class="sxs-lookup"><span data-stu-id="bbe47-139">Referral Chasing with IDirectorySearch</span></span>](referral-chasing-with-idirectorysearch.md)
-   [<span data-ttu-id="bbe47-140">Поиск с помощью объекты данных ActiveX</span><span class="sxs-lookup"><span data-stu-id="bbe47-140">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="bbe47-141">Поиск с помощью OLE DB</span><span class="sxs-lookup"><span data-stu-id="bbe47-141">Searching with OLE DB</span></span>](searching-with-ole-db.md)

 

 