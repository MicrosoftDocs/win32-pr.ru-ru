---
title: Использование интерфейсов IADs
description: ADSI каждый элемент службы каталогов представлен объектом ADSI, который представляет собой объект модели COM, поддерживающий стандартный интерфейс IUnknown COM, а также интерфейсы IDispatch и IADs.
ms.assetid: bdbf2012-6863-4611-8173-6a3cd9c4960f
ms.tgt_platform: multiple
keywords:
- IADs ADSI, использование
- ADSI ADSI, использование, использование интерфейсов IADs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 878afa9350a45f18238bebb69df1a96eba52715e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104413744"
---
# <a name="using-the-iads-interfaces"></a><span data-ttu-id="239c2-105">Использование интерфейсов IADs</span><span class="sxs-lookup"><span data-stu-id="239c2-105">Using the IADs Interfaces</span></span>

<span data-ttu-id="239c2-106">ADSI каждый элемент службы каталогов представлен объектом ADSI, который представляет собой объект модели COM, поддерживающий стандартный интерфейс [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) com, а также интерфейсы [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) и [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="239c2-106">ADSI, each element of a directory service is represented by an ADSI object, which is a Component Object Model (COM) object that supports the standard COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface as well as the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interfaces.</span></span> <span data-ttu-id="239c2-107">Функция **iAds** предоставляет основные функции обслуживания для объектов ADSI.</span><span class="sxs-lookup"><span data-stu-id="239c2-107">**IADs** supplies the basic maintenance functions for ADSI objects.</span></span>

<span data-ttu-id="239c2-108">Каждый объект ADSI должен поддерживать этот интерфейс, который служит для:</span><span class="sxs-lookup"><span data-stu-id="239c2-108">Each ADSI object must support this interface, which serves to:</span></span>

-   <span data-ttu-id="239c2-109">Укажите идентификатор объекта по имени, классу или ADsPath.</span><span class="sxs-lookup"><span data-stu-id="239c2-109">Provide object identification by name, class, or ADsPath.</span></span>
-   <span data-ttu-id="239c2-110">Определяет контейнер объектов, который управляет созданием и удалением объектов.</span><span class="sxs-lookup"><span data-stu-id="239c2-110">Identify the object container that manages creating and deleting objects.</span></span>
-   <span data-ttu-id="239c2-111">Получите определение схемы объекта.</span><span class="sxs-lookup"><span data-stu-id="239c2-111">Obtain the object schema definition.</span></span>
-   <span data-ttu-id="239c2-112">Загрузите атрибуты объекта в кэш свойств и зафиксируйте изменения в хранилище постоянного каталога.</span><span class="sxs-lookup"><span data-stu-id="239c2-112">Load the object attributes to the property cache and commit changes to the persistent directory store.</span></span>
-   <span data-ttu-id="239c2-113">Доступ к значениям атрибута объекта и их изменение в кэше свойств.</span><span class="sxs-lookup"><span data-stu-id="239c2-113">Access and modify the object attribute values in the property cache.</span></span>

<span data-ttu-id="239c2-114">Интерфейс [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) предназначен для того, чтобы объекты ADSI предоставляющих сетевым администраторам и поставщикам служб каталогов эффективное и устойчивое представление различных базовых служб каталогов.</span><span class="sxs-lookup"><span data-stu-id="239c2-114">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface is designed to ensure that ADSI objects provide network administrators and directory service providers with an efficient and consistent representation of various underlying directory services.</span></span>

![объект ADSI, поддерживающий интерфейс iAds](images/ds2iads.png)

<span data-ttu-id="239c2-116">На предыдущем рисунке показан универсальный объект ADSI, поддерживающий фундаментальные интерфейсы [**iAds**](/windows/desktop/api/Iads/nn-iads-iads), [**иадспропертилист**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject)и [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span><span class="sxs-lookup"><span data-stu-id="239c2-116">The preceding figure shows a generic ADSI object that support the fundamental interfaces [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject), and [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span> <span data-ttu-id="239c2-117">Объект ADSI, такой как, управляет данными из хранилища данных базовой службы каталогов через интерфейсы, которые она поддерживает.</span><span class="sxs-lookup"><span data-stu-id="239c2-117">An ADSI object such as this manages data from the data store of the underlying directory service through the interfaces it supports.</span></span> <span data-ttu-id="239c2-118">Эти данные называются свойствами объекта, а подпрограммы, которые получают и задают эти свойства, называются методами свойств.</span><span class="sxs-lookup"><span data-stu-id="239c2-118">This data is known as the properties of the object, and the routines that obtain and set these properties are known as property methods.</span></span> <span data-ttu-id="239c2-119">Свойства только для чтения имеют один метод свойства, который получает значение свойства.</span><span class="sxs-lookup"><span data-stu-id="239c2-119">Read-only properties have one property method that obtains the property value.</span></span> <span data-ttu-id="239c2-120">Свойства чтения и записи имеют два метода: метод, который задает значение и одно из них, которое получает значение.</span><span class="sxs-lookup"><span data-stu-id="239c2-120">Read/write properties have two methods; a method that sets the value and one that obtains the value.</span></span> <span data-ttu-id="239c2-121">Свойства реализуются для каждого объекта ADSI с помощью [кэша свойств](the-adsi-attribute-cache.md).</span><span class="sxs-lookup"><span data-stu-id="239c2-121">Properties are implemented on each ADSI object using a [property cache](the-adsi-attribute-cache.md).</span></span> <span data-ttu-id="239c2-122">[**IAds:: Get \_ ADsPath**](iads-property-methods.md) и **IADs::p UT \_ ADsPath** — примеры методов свойств.</span><span class="sxs-lookup"><span data-stu-id="239c2-122">[**IADs::get\_ADsPath**](iads-property-methods.md) and **IADs::put\_ADsPath** are examples of property methods.</span></span> <span data-ttu-id="239c2-123">Методы свойств не являются очевидными для Visual Basic и других клиентов автоматизации, которые обеспечивают прямые ссылки на свойство.</span><span class="sxs-lookup"><span data-stu-id="239c2-123">Property methods are not apparent to Visual Basic and other Automation clients that enable direct references to the property.</span></span> <span data-ttu-id="239c2-124">Например, Visual Basic ссылается на **iAds:: ADsPath** непосредственно с использованием синтаксиса **Object. ADsPath** .</span><span class="sxs-lookup"><span data-stu-id="239c2-124">For example, Visual Basic refers to **IADs::ADsPath** directly using the **Object.ADsPath** syntax.</span></span> <span data-ttu-id="239c2-125">Дополнительные сведения см. в разделе [методы свойств интерфейса](interface-property-methods.md).</span><span class="sxs-lookup"><span data-stu-id="239c2-125">For more information, see [Interface Property Methods](interface-property-methods.md).</span></span>

<span data-ttu-id="239c2-126">Кроме того, объект ADSI взаимодействует с другими объектами ADSI и напрямую с пространством имен с помощью методов.</span><span class="sxs-lookup"><span data-stu-id="239c2-126">In addition, an ADSI object interacts with other ADSI objects and directly to a namespace through methods.</span></span> <span data-ttu-id="239c2-127">Методы выполняются немедленно.</span><span class="sxs-lookup"><span data-stu-id="239c2-127">Methods execute immediately.</span></span> <span data-ttu-id="239c2-128">Примеры методов включают в себя [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) и [**iAds:: info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span><span class="sxs-lookup"><span data-stu-id="239c2-128">Examples of methods include [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) and [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span></span>

<span data-ttu-id="239c2-129">Доступ к свойствам, методам свойств и методам осуществляется через стандартные интерфейсы COM.</span><span class="sxs-lookup"><span data-stu-id="239c2-129">Properties, property methods, and methods are all accessed through standard COM interfaces.</span></span>

<span data-ttu-id="239c2-130">Объект ADSI однозначно идентифицируется по его ADsPath.</span><span class="sxs-lookup"><span data-stu-id="239c2-130">An ADSI object is uniquely identified by its ADsPath.</span></span> <span data-ttu-id="239c2-131">Например, путь к пространству имен LDAP — «LDAP://MyServer/DC=Fabrikam,DC=COM».</span><span class="sxs-lookup"><span data-stu-id="239c2-131">For example, an ADsPath for the LDAP namespace is "LDAP://MyServer/DC=Fabrikam,DC=COM".</span></span> <span data-ttu-id="239c2-132">Дополнительные сведения о Адспасс см. в разделе [Привязка ADSI](binding-to-an-adsi-object.md).</span><span class="sxs-lookup"><span data-stu-id="239c2-132">For more information about ADsPaths, see [ADSI Binding](binding-to-an-adsi-object.md).</span></span> <span data-ttu-id="239c2-133">Для программистов, знакомых с моникерами COM, это концептуально похоже на отображаемое имя моникера COM.</span><span class="sxs-lookup"><span data-stu-id="239c2-133">For programmers familiar with COM monikers, this is conceptually similar to the COM moniker display name.</span></span>

<span data-ttu-id="239c2-134">Любой объект ADSI, который содержит другие объекты ADSI, называемый объектом контейнера ADSI, также поддерживает интерфейс [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) , предоставляющий методы и свойства, управляющие созданием, удалением и перечислением объектов ADSI, содержащихся в объекте.</span><span class="sxs-lookup"><span data-stu-id="239c2-134">Any ADSI object that contains other ADSI objects, called an ADSI container object, also supports the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface, which provides methods and properties that manage the creation, deletion, and enumeration of ADSI objects contained by the object.</span></span> <span data-ttu-id="239c2-135">На следующем рисунке показан объект контейнера ADSI.</span><span class="sxs-lookup"><span data-stu-id="239c2-135">The following figure shows an ADSI container object.</span></span>

![Объект контейнера ADSI](images/dsiadsc.png)

<span data-ttu-id="239c2-137&quot;>Большинство объектов ADSI содержатся в других объектах.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;239c2-137&quot;>Most ADSI objects are contained by other objects.</span></span> <span data-ttu-id=&quot;239c2-138&quot;>Единственным объектом ADSI без родительского контейнера является объект **пространств имен** ADSI верхнего уровня (&quot;ADS:").</span><span class="sxs-lookup"><span data-stu-id="239c2-138">The only ADSI object with no parent container is the top-level ADSI **Namespaces** object ("ADS:").</span></span>

<span data-ttu-id="239c2-139">Метод [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) объекта-контейнера постоянно сохраняет кэшированные свойства объекта контейнера ADSI в хранилище в дополнение к любым объектам, созданным с помощью метода [**Иадсконтаинер:: Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) .</span><span class="sxs-lookup"><span data-stu-id="239c2-139">The [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method on a container object persistently stores the cached properties of the ADSI container object to storage in addition to any objects created with the [**IADsContainer::Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method.</span></span> <span data-ttu-id="239c2-140">[**Иадсконтаинер::D удалить**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) не влияет на кэш свойств, но удаляет базовый элемент каталога пространства имен, представленный этим объектом.</span><span class="sxs-lookup"><span data-stu-id="239c2-140">[**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) does not affect the property cache but deletes the underlying namespace directory element represented by this object.</span></span>

 

 