---
title: Настройка и изменение паролей пользователей с помощью поставщика LDAP
description: Чтобы задать пароль пользователя, используйте метод IADsUser. SetPassword.
ms.assetid: da3d9861-dd04-406c-9356-db1e4ff0eebc
ms.tgt_platform: multiple
keywords:
- ADSI поставщика LDAP, объект User, установка паролей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5488146de271ac1108a904cd85163fad9d7dd205
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104339220"
---
# <a name="setting-and-changing-user-passwords-with-the-ldap-provider"></a><span data-ttu-id="3f800-104">Настройка и изменение паролей пользователей с помощью поставщика LDAP</span><span class="sxs-lookup"><span data-stu-id="3f800-104">Setting and Changing User Passwords with the LDAP Provider</span></span>

<span data-ttu-id="3f800-105">Чтобы задать пароль пользователя, используйте метод [**IADsUser. SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) .</span><span class="sxs-lookup"><span data-stu-id="3f800-105">To a set a user password, use the [**IADsUser.SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) method.</span></span>

<span data-ttu-id="3f800-106">Поставщик LDAP для Active Directory использует один из трех процессов для задания пароля (сторонние каталоги LDAP, такие как iPlanet, не используют этот процесс проверки подлинности пароля).</span><span class="sxs-lookup"><span data-stu-id="3f800-106">The LDAP provider for Active Directory uses one of three processes to set the password (third-party LDAP directories such as iPlanet do not use this password authentication process).</span></span> <span data-ttu-id="3f800-107">Метод может отличаться в зависимости от конфигурации сети.</span><span class="sxs-lookup"><span data-stu-id="3f800-107">The method may vary according to the network configuration.</span></span> <span data-ttu-id="3f800-108">Методы задания пароля выполняются в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="3f800-108">The set password methods occur in the following order:</span></span>

-   <span data-ttu-id="3f800-109">Во-первых, поставщик LDAP пытается использовать LDAP через 128-разрядное подключение SSL.</span><span class="sxs-lookup"><span data-stu-id="3f800-109">First, the LDAP provider attempts to use LDAP over a 128-bit SSL connection.</span></span> <span data-ttu-id="3f800-110">Чтобы протокол LDAP SSL успешно работал, на сервере LDAP должен быть установлен соответствующий сертификат проверки подлинности сервера, а клиенты, выполняющие код ADSI, должны доверять центру сертификации, выдавшей сертификаты.</span><span class="sxs-lookup"><span data-stu-id="3f800-110">For LDAP SSL to operate successfully, the LDAP server must have the appropriate server authentication certificate installed and the clients running the ADSI code must trust the authority that issued those certificates.</span></span> <span data-ttu-id="3f800-111">Как сервер, так и клиент должны поддерживать 128-разрядное шифрование.</span><span class="sxs-lookup"><span data-stu-id="3f800-111">Both the server and the client must support 128-bit encryption.</span></span>
-   <span data-ttu-id="3f800-112">Во-вторых, в случае неудачного подключения SSL поставщик LDAP пытается использовать Kerberos.</span><span class="sxs-lookup"><span data-stu-id="3f800-112">Second, if the SSL connection is unsuccessful, the LDAP provider attempts to use Kerberos.</span></span> <span data-ttu-id="3f800-113">В Windows 2000 Kerberos может не поддерживать проверку подлинности между лесами.</span><span class="sxs-lookup"><span data-stu-id="3f800-113">On Windows 2000, Kerberos may not support cross-forest authentication.</span></span> <span data-ttu-id="3f800-114">Более поздние усовершенствования поддерживают проверку подлинности между лесами.</span><span class="sxs-lookup"><span data-stu-id="3f800-114">Later enhancements to Kerberos support cross-forest authentication.</span></span>
-   <span data-ttu-id="3f800-115">В-третьих, если Kerberos не удалось, поставщик LDAP пытается вызвать API [**нетусерсетинфо**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) .</span><span class="sxs-lookup"><span data-stu-id="3f800-115">Third, if Kerberos is unsuccessful, the LDAP provider attempts a [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API call.</span></span> <span data-ttu-id="3f800-116">В предыдущих выпусках ADSI назывался **нетусерсетинфо** в контексте безопасности, в котором выполнялся поток, а не в контексте безопасности, указанном в вызове [**иадсопендсобжект. опендсобжект**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) или [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span><span class="sxs-lookup"><span data-stu-id="3f800-116">In previous releases, ADSI called **NetUserSetInfo** in the security context in which the thread was running, and not the security context specified in the call to [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span></span> <span data-ttu-id="3f800-117">В более поздних выпусках это было изменено, так что поставщик ADSI LDAP будет олицетворять пользователя, указанного в вызове **опендсобжект** при вызове **нетусерсетинфо**.</span><span class="sxs-lookup"><span data-stu-id="3f800-117">In later releases, this was changed so that the ADSI LDAP provider would impersonate the user specified in the **OpenDSObject** call when it calls **NetUserSetInfo**.</span></span>

<span data-ttu-id="3f800-118">Чтобы изменить пароль пользователя, используйте метод [**IADsUser. ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) .</span><span class="sxs-lookup"><span data-stu-id="3f800-118">To change a user password, use the [**IADsUser.ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) method.</span></span> <span data-ttu-id="3f800-119">Как и [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), этот метод может использовать несколько процессов для изменения пароля.</span><span class="sxs-lookup"><span data-stu-id="3f800-119">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), this method can use multiple processes to change the password.</span></span> <span data-ttu-id="3f800-120">Методы изменения пароля выполняются в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="3f800-120">The change password methods occur in the following order:</span></span>

-   <span data-ttu-id="3f800-121">Во-первых, поставщик LDAP пытается использовать LDAP через 128-разрядное подключение SSL.</span><span class="sxs-lookup"><span data-stu-id="3f800-121">First, the LDAP provider tries to use LDAP over a 128-bit SSL connection.</span></span>
-   <span data-ttu-id="3f800-122">Во-вторых, если не удалось выполнить подключение 128 SSL, поставщик LDAP пытается вызвать API [**нетусерчанжепассворд**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) .</span><span class="sxs-lookup"><span data-stu-id="3f800-122">Second, if the 128-SSL connection is unsuccessful, the LDAP provider tries a [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API call.</span></span> <span data-ttu-id="3f800-123">Как и [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), в более ранних выпусках поставщик LDAP ADSI олицетворяет учетные данные пользователя, переданные с помощью метода [**иадсопендсобжект. Опендсобжект**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) или функции [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) .</span><span class="sxs-lookup"><span data-stu-id="3f800-123">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), in earlier releases, the ADSI LDAP provider impersonates the user credentials passed using the [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) method or the [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) function.</span></span>

 

 