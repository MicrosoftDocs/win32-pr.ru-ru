---
title: Что делает быстрый запрос
description: В этом разделе перечислены предпочтительные методы программирования, используемые при запросах к каталогу.
ms.assetid: d96f330f-3c57-4edc-9fd2-970f908b54c2
ms.tgt_platform: multiple
keywords:
- Что делает интерфейс ADSI быстрого запроса
- запросы к ADSI, что делает быстрый запрос
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 883db1e9de7b7b7a1179c814d6f66f774685083e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103891081"
---
# <a name="what-makes-a-fast-query"></a><span data-ttu-id="021f7-105">Что делает быстрый запрос?</span><span class="sxs-lookup"><span data-stu-id="021f7-105">What Makes a Fast Query?</span></span>

<span data-ttu-id="021f7-106">При выполнении запроса учитывайте следующие основные понятия, связанные с улучшением производительности.</span><span class="sxs-lookup"><span data-stu-id="021f7-106">Consider the following performance enhancement concepts when executing a query:</span></span>

-   <span data-ttu-id="021f7-107">По возможности Фильтруйте только по индексированным атрибутам.</span><span class="sxs-lookup"><span data-stu-id="021f7-107">If possible, filter on indexed attributes only.</span></span> <span data-ttu-id="021f7-108">Используйте индексные атрибуты, которые будут создавать наименьшее число попаданий.</span><span class="sxs-lookup"><span data-stu-id="021f7-108">Use index attributes that you expect will generate the fewest number of hits.</span></span> <span data-ttu-id="021f7-109">Дополнительные сведения и полный список индексированных атрибутов для Windows см. в разделе [Active Directory Schema](/windows/desktop/ADSchema/active-directory-schema).</span><span class="sxs-lookup"><span data-stu-id="021f7-109">For more information and a comprehensive list of indexed attributes for Windows, see [Active Directory Schema](/windows/desktop/ADSchema/active-directory-schema).</span></span>
-   <span data-ttu-id="021f7-110">Поиск по **objectCategory** вместо **objectClass** , так как **objectClass** не является индексированным свойством.</span><span class="sxs-lookup"><span data-stu-id="021f7-110">Search on **objectCategory** instead of **objectClass** because **objectClass** is not an indexed property.</span></span>
-   <span data-ttu-id="021f7-111">Помните о ссылках.</span><span class="sxs-lookup"><span data-stu-id="021f7-111">Be aware of referrals.</span></span> <span data-ttu-id="021f7-112">Рассмотрите возможность поиска в глобальном каталоге, если атрибуты перечислены как реплицируемые GC.</span><span class="sxs-lookup"><span data-stu-id="021f7-112">Consider searching the global catalog if your attributes are listed as GC replicated.</span></span>
-   <span data-ttu-id="021f7-113">Старайтесь не искать текст в середине и в конце строки.</span><span class="sxs-lookup"><span data-stu-id="021f7-113">Avoid searching for text in the middle and at the end of a string.</span></span> <span data-ttu-id="021f7-114">Например, "CN = \* Хилле \* " или "CN = \* лараусе".</span><span class="sxs-lookup"><span data-stu-id="021f7-114">For example, "cn=\*hille\*" or "cn=\*larouse".</span></span>
-   <span data-ttu-id="021f7-115">Предположим, что поиск по поддереву вернет большой результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="021f7-115">Assume that a subtree search will return a large result set.</span></span> <span data-ttu-id="021f7-116">Используйте разбиение по страницам при выполнении поиска по поддереву.</span><span class="sxs-lookup"><span data-stu-id="021f7-116">Use paging when performing subtree searches.</span></span> <span data-ttu-id="021f7-117">Затем сервер сможет передавать большой результирующий набор в блоки, уменьшая ресурсы памяти на стороне сервера.</span><span class="sxs-lookup"><span data-stu-id="021f7-117">The server will then be able to stream a large result set in chunks reducing the server-side memory resources.</span></span> <span data-ttu-id="021f7-118">Это эффективно сводит к минимуму использование сети и снижает потребность в отправке очень больших фрагментов данных по сети.</span><span class="sxs-lookup"><span data-stu-id="021f7-118">This effectively flattens out network usage and reduces the need for sending extremely large chunks of data over the network.</span></span>
-   <span data-ttu-id="021f7-119">Правильно выполните область поиска, чтобы не получать больше, чем требуется.</span><span class="sxs-lookup"><span data-stu-id="021f7-119">Properly scope your searches so as to not retrieve more than is necessary.</span></span>
-   <span data-ttu-id="021f7-120">Выполнение сложного поиска по нескольким атрибутам, так как это снижает производительность, чем выполнение нескольких операций поиска.</span><span class="sxs-lookup"><span data-stu-id="021f7-120">Perform a complex search on multiple attributes, because it is less performance intensive than performing multiple searches.</span></span> <span data-ttu-id="021f7-121">Один поиск объекта, считывающего два атрибута, более эффективен, чем два поиска для одного и того же объекта, каждый из которых возвращает один атрибут.</span><span class="sxs-lookup"><span data-stu-id="021f7-121">One search for an object that reads two attributes is more efficient than two searches for the same object, each returning one attribute.</span></span>
-   <span data-ttu-id="021f7-122">Для чтения атрибута с большим количеством значений используйте ограничения диапазона, чтобы максимально сокращать размер поиска, чтобы можно было одновременно читать несколько тысяч элементов.</span><span class="sxs-lookup"><span data-stu-id="021f7-122">For reading attribute with a large number of values, use range limits to minimize the search size so that you can read a few thousand members at a time.</span></span> <span data-ttu-id="021f7-123">Дополнительные сведения об указании ограничений диапазона атрибутов см. в разделе [получение диапазона атрибутов](attribute-range-retrieval.md).</span><span class="sxs-lookup"><span data-stu-id="021f7-123">For more information about specifying attribute range limits, see [Attribute Range Retrieval](attribute-range-retrieval.md).</span></span>
-   <span data-ttu-id="021f7-124">Привязка к объекту удерживает маркер привязки для оставшейся части сеанса.</span><span class="sxs-lookup"><span data-stu-id="021f7-124">Bind to an object hold the binding handle for the remainder of your session.</span></span> <span data-ttu-id="021f7-125">Не привязывать и не привязывать к каждому вызову.</span><span class="sxs-lookup"><span data-stu-id="021f7-125">Do not bind and unbind for each call.</span></span> <span data-ttu-id="021f7-126">Если вы используете ADO или OLE DB, не создавайте много объектов соединения.</span><span class="sxs-lookup"><span data-stu-id="021f7-126">If you are using ADO or OLE DB, do not create many connection objects.</span></span>
-   <span data-ttu-id="021f7-127">Прочтите rootDSE и запомните его содержимое в оставшейся части сеанса.</span><span class="sxs-lookup"><span data-stu-id="021f7-127">Read the rootDSE once and remember its contents for the remainder of your session.</span></span>

 

 