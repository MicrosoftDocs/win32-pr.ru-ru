---
title: Проблемы проверки подлинности для ADSI с ASP
description: В зависимости от конфигурации интрасети, при запуске кода ADSI из страницы ASP могут возникнуть проблемы с проверкой подлинности.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, страницы ASP, проблемы проверки подлинности
- ADSI, проверка подлинности, проблемы ASP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103793801"
---
# <a name="authentication-issues-for-adsi-with-asp"></a><span data-ttu-id="c5590-105">Проблемы проверки подлинности для ADSI с ASP</span><span class="sxs-lookup"><span data-stu-id="c5590-105">Authentication Issues for ADSI with ASP</span></span>

<span data-ttu-id="c5590-106">В зависимости от конфигурации интрасети, при запуске кода ADSI из страницы ASP могут возникнуть проблемы с проверкой подлинности.</span><span class="sxs-lookup"><span data-stu-id="c5590-106">Depending on the configuration of your intranet, authentication issues may occur when ADSI code is run from an ASP page.</span></span>

<span data-ttu-id="c5590-107">Проверка подлинности для доступа к контроллеру домена может быть предоставлена с помощью делегирования.</span><span class="sxs-lookup"><span data-stu-id="c5590-107">Authentication to access the domain controller can be given using delegation.</span></span> <span data-ttu-id="c5590-108">Делегирование позволяет службе работать в качестве пользователя, поэтому она может получить доступ к сетевому ресурсу с помощью учетных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="c5590-108">Delegation permits a service to act as the user, so it can access a network resource using that user credentials.</span></span> <span data-ttu-id="c5590-109">Если ваша интрасеть соответствует этой конфигурации, необходимо настроить IIS для использования делегирования.</span><span class="sxs-lookup"><span data-stu-id="c5590-109">If your intranet follows this configuration, you must set up IIS to use delegation.</span></span> <span data-ttu-id="c5590-110">Установите механизм проверки подлинности IIS как анонимный или NTLM.</span><span class="sxs-lookup"><span data-stu-id="c5590-110">Set the IIS Authentication mechanism as Anonymous or NTLM.</span></span> <span data-ttu-id="c5590-111">Если выбран параметр анонимный, то контекст безопасности будет сопоставлен с \_ учетной записью компьютера IUSR.</span><span class="sxs-lookup"><span data-stu-id="c5590-111">If you choose anonymous, your security context will be mapped to IUSR\_MACHINE account.</span></span> <span data-ttu-id="c5590-112">При выборе NTLM контекст безопасности изменится в зависимости от того, какой пользователь входит в систему на веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="c5590-112">If you select NTLM, the security context will change, depending on which user logs on to your website.</span></span> <span data-ttu-id="c5590-113">Дополнительные сведения и инструкции по настройке сервера IIS для делегирования см. в разделе [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span><span class="sxs-lookup"><span data-stu-id="c5590-113">For more information and instructions for setting up the IIS server for delegation, see [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span></span>

<span data-ttu-id="c5590-114">Если используется сервер IIS, использующий запрос или ответ NT, или клиент браузера, не поддерживающий Kerberos, то проверка подлинности с двойным прыжком не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c5590-114">If you are using a an IIS server that uses the NT challenge/response, or a browser client that does not support Kerberos, then double-hop authentication is not supported.</span></span> <span data-ttu-id="c5590-115">Проверка подлинности с двойным прыжком означает, что учетные данные пользователя передаются с клиента браузера на сервер IIS, а затем сервер IIS передает учетные данные на внутренний сервер.</span><span class="sxs-lookup"><span data-stu-id="c5590-115">Double-hop authentication means that the user credentials are passed from the browser client to the IIS server, and then the IIS server passes the credentials to the backend server.</span></span> <span data-ttu-id="c5590-116">В этом случае можно использовать одно из следующих решений, чтобы разрешить доступ к каталогу со страницы ASP:</span><span class="sxs-lookup"><span data-stu-id="c5590-116">In this situation, you can use one of the following solutions to allow access to the directory from the ASP page:</span></span>

-   <span data-ttu-id="c5590-117">Используйте [**иадсопендсобжект:: опендсобжект**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) или [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) для передачи учетных данных в Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c5590-117">Use [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) to pass credentials to Active Directory.</span></span> <span data-ttu-id="c5590-118">На веб-странице выполняется проверка подлинности подключенного пользователя к серверу IIS.</span><span class="sxs-lookup"><span data-stu-id="c5590-118">The webpage authenticates the connected user against the IIS server.</span></span> <span data-ttu-id="c5590-119">После проверки подлинности пользователя веб-страница может использовать Опендсобжект или ADsOpenObject для передачи имени пользователя и пароля в службу каталогов для получения проверки подлинности на внутреннем сервере.</span><span class="sxs-lookup"><span data-stu-id="c5590-119">When the user has been authenticated, the webpage can use OpenDSObject or ADsOpenObject to pass a user name and password to the directory service to obtain authentication to the backend server.</span></span> <span data-ttu-id="c5590-120">Затем веб-страница может получить доступ к данным из каталога.</span><span class="sxs-lookup"><span data-stu-id="c5590-120">The webpage can then access data from the directory.</span></span>
-   <span data-ttu-id="c5590-121">Добавьте код в COM-объект и помещайте этот объект в [приложение COM+](../cossdk/com--application-overview.md) (которое ранее называлось пакетом MTS).</span><span class="sxs-lookup"><span data-stu-id="c5590-121">Add your code to a COM object and put this object into a [COM+ application](../cossdk/com--application-overview.md) (previously called an MTS package).</span></span> <span data-ttu-id="c5590-122">Затем приложение COM+ можно запустить от имени [учетной записи пользователя домена](/windows/desktop/AD/domain-user-accounts).</span><span class="sxs-lookup"><span data-stu-id="c5590-122">The COM+ application can then be run as a [domain user account](/windows/desktop/AD/domain-user-accounts).</span></span>
-   <span data-ttu-id="c5590-123">Используйте несколько страниц ASP, где одна страница проверяет подлинность клиента, а другая страница передает учетные данные в каталог, используя анонимную проверку подлинности для учетной записи пользователя домена.</span><span class="sxs-lookup"><span data-stu-id="c5590-123">Use multiple ASP pages, where one page authenticates the client and another page passes credentials to the directory using anonymous authentication on a domain user account.</span></span>

<span data-ttu-id="c5590-124">Эти методы подразумевают проверку подлинности веб-клиента, а затем изменяют учетные данные при обращении к каталогу, так как проверка подлинности с двойным прыжком с теми же учетными данными невозможна.</span><span class="sxs-lookup"><span data-stu-id="c5590-124">These methods involve authenticating the web client and then changing the credentials when contacting the directory because double-hop authentication, with the same credentials, is not possible.</span></span>

 

 