---
title: Получение больших наборов результатов
description: Если существует вероятность того, что возвращаемый результирующий набор будет содержать более 1000 элементов, необходимо использовать поиск на странице.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Получение списка больших наборов результатов ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105654108"
---
# <a name="retrieving-large-results-sets"></a><span data-ttu-id="bc019-104">Получение больших наборов результатов</span><span class="sxs-lookup"><span data-stu-id="bc019-104">Retrieving Large Results Sets</span></span>

<span data-ttu-id="bc019-105">Если существует вероятность того, что возвращаемый результирующий набор будет содержать более 1000 элементов, необходимо использовать поиск на странице.</span><span class="sxs-lookup"><span data-stu-id="bc019-105">When there is the possibility that the result set that will be returned will contain more than 1000 items, you must use a paged search.</span></span> <span data-ttu-id="bc019-106">Поиск Active Directory, выполненных без разбиения на страницы, ограничивается возвратом максимум из первых 1000 записей.</span><span class="sxs-lookup"><span data-stu-id="bc019-106">Searches of Active Directory performed without paging are limited to returning a maximum of the first 1000 records.</span></span> <span data-ttu-id="bc019-107">При поиске с постраничным поиском результирующий набор представляется отдельными страницами, каждый из которых содержит предварительно определенное количество записей результатов.</span><span class="sxs-lookup"><span data-stu-id="bc019-107">With a paged search, the result set is presented as individual pages, each containing a predetermined number of result entries.</span></span> <span data-ttu-id="bc019-108">При таком типе поиска новые страницы результирующих записей возвращаются до тех пор, пока не будет достигнут конец результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="bc019-108">With this type of search, new pages of result entries are returned until the end of the result set is reached.</span></span>

<span data-ttu-id="bc019-109">По умолчанию сервер, отвечающий на запрос запроса, полностью вычисляет результирующий набор перед возвратом данных.</span><span class="sxs-lookup"><span data-stu-id="bc019-109">By default, the server that responds to a query request completely calculates a result set before returning data.</span></span> <span data-ttu-id="bc019-110">В большом результирующем наборе для этого требуется память сервера, так как получен результирующий набор, и пропускная способность сети при возвращении большого результата.</span><span class="sxs-lookup"><span data-stu-id="bc019-110">In a large result set, this requires server memory as the result set is acquired, and network bandwidth when the large result is returned.</span></span> <span data-ttu-id="bc019-111">Установка размера страницы позволяет серверу отправить данные на страницах во время построения страниц.</span><span class="sxs-lookup"><span data-stu-id="bc019-111">Setting a page size allows the server to send the data in pages as the pages are being built.</span></span> <span data-ttu-id="bc019-112">Затем клиент кэширует эти данные и предоставляет курсор на код уровня приложения.</span><span class="sxs-lookup"><span data-stu-id="bc019-112">The client then caches this data and provides a cursor to the application level code.</span></span> <span data-ttu-id="bc019-113">Подкачка настраивается путем определения количества строк, которые сервер вычисляет перед возвратом данных по сети клиенту.</span><span class="sxs-lookup"><span data-stu-id="bc019-113">Paging is set by defining how many rows the server calculates before the data is returned over the network to the client.</span></span>

<span data-ttu-id="bc019-114">Страничный поиск обеспечивает преимущества для клиента и сервера.</span><span class="sxs-lookup"><span data-stu-id="bc019-114">Paged searching offers benefits to both the client and the server.</span></span> <span data-ttu-id="bc019-115">Например, клиент может более быстро реагировать на представление результатов для конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="bc019-115">For example, the client can be more responsive in presenting the results to end users.</span></span> <span data-ttu-id="bc019-116">Это особенно важно для графических средств пользовательского интерфейса, которые могут отображать данные, в то время как другой поток одновременно получает больше данных от сервера.</span><span class="sxs-lookup"><span data-stu-id="bc019-116">This is especially relevant for graphical user interface tools that can display data while another thread concurrently receives more data from the server.</span></span>

<span data-ttu-id="bc019-117">При настройке запроса при указании порядка сортировки для результирующего набора сервер должен полностью вычислить результирующий набор перед возвратом данных клиенту, что влияет на время отклика для запроса.</span><span class="sxs-lookup"><span data-stu-id="bc019-117">When you set up your query, if you specify a sort order for your result set, then the server must completely calculate the result set before returning the data to the client, which impacts the response time for the query.</span></span>

<span data-ttu-id="bc019-118">На стороне сервера страничный поиск делает операцию масштабируемой.</span><span class="sxs-lookup"><span data-stu-id="bc019-118">On the server side, paged searching makes the operation scalable.</span></span> <span data-ttu-id="bc019-119">Например, если 100 Клиенты выдают запросы на поиск одновременно и, в среднем, каждый клиент возвращает 200 объектов, если размер страницы не указан, сервер должен иметь достаточно памяти для хранения полного результирующего набора записей по 20 000.</span><span class="sxs-lookup"><span data-stu-id="bc019-119">For example, if one hundred clients issue search requests simultaneously and, on the average, each client is returned two hundred objects, if page size is not specified, the server must have sufficient memory to hold the complete result set of 20,000 entries.</span></span> <span data-ttu-id="bc019-120">Кроме того, если каждый клиент указал размер страницы в десять объектов, требования к памяти на сервере будут снижены до 20.</span><span class="sxs-lookup"><span data-stu-id="bc019-120">Alternately, if each client specified a page size of ten objects, the memory requirements on the server would be reduced by a factor of 20.</span></span>

> [!Note]  
> <span data-ttu-id="bc019-121">Не все службы каталогов поддерживают страничный поиск.</span><span class="sxs-lookup"><span data-stu-id="bc019-121">Not all directory services support paged searches.</span></span> <span data-ttu-id="bc019-122">Active Directory реализует архитектуру размера страницы.</span><span class="sxs-lookup"><span data-stu-id="bc019-122">Active Directory implements page size architecture.</span></span>

 

<span data-ttu-id="bc019-123">Многие серверы каталогов задают административное ограничение для максимального числа объектов, которые они могут возвращать, если клиент не указал размер страницы.</span><span class="sxs-lookup"><span data-stu-id="bc019-123">Many directory servers specify an Administrative Limit for the maximum number of objects they can return if a client does not specify the page size.</span></span> <span data-ttu-id="bc019-124">При достижении ограничения по администрированию ADSI формирует **\_ \_ \_ \_ превышение лимита администратора DS** с ошибкой Win32.</span><span class="sxs-lookup"><span data-stu-id="bc019-124">When the Administrative Limit is reached, ADSI generates the **ERROR\_DS\_ADMIN\_LIMIT\_EXCEEDED** Win32 error.</span></span>

<span data-ttu-id="bc019-125">На стороне клиента страничный поиск позволяет клиенту прерывать операцию, пока она все еще выполняется.</span><span class="sxs-lookup"><span data-stu-id="bc019-125">On the client side, a paged search allows a client to stop the operation while it is still in progress.</span></span> <span data-ttu-id="bc019-126">В отличие от этого, при нестраничном поиске клиент блокируется до тех пор, пока данные не будут полностью возвращены или произойдет ошибка.</span><span class="sxs-lookup"><span data-stu-id="bc019-126">By contrast, in a non-paged search, the client is blocked until the data is completely returned, or an error occurs.</span></span> <span data-ttu-id="bc019-127">Это может повлиять на производительность сети, если результирующий набор оказывается больше и занимает больше времени, чем ожидалось.</span><span class="sxs-lookup"><span data-stu-id="bc019-127">This could impact network performance if the result set turns out to be larger and takes more time than expected.</span></span>

<span data-ttu-id="bc019-128">От имени клиента ADSI обрабатывает размер страницы прозрачно.</span><span class="sxs-lookup"><span data-stu-id="bc019-128">On behalf of the client, ADSI handles the page size transparently.</span></span> <span data-ttu-id="bc019-129">Клиенту не нужно подсчитывать количество выполняемых объектов.</span><span class="sxs-lookup"><span data-stu-id="bc019-129">The client does not have to count the number of objects in progress.</span></span> <span data-ttu-id="bc019-130">ADSI инкапсулирует взаимодействие сервера для клиента.</span><span class="sxs-lookup"><span data-stu-id="bc019-130">ADSI encapsulates the server interaction for the client.</span></span> <span data-ttu-id="bc019-131">С точки зрения клиента, поиск возвращает полный результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="bc019-131">From the client perspective, the search returns a complete result set.</span></span>

<span data-ttu-id="bc019-132">Дополнительные сведения об использовании параметра "искать время ожидания" с конкретным интерфейсом поиска см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="bc019-132">For more information about using the search time out option with a specific search interface, see:</span></span>

-   [<span data-ttu-id="bc019-133">Подкачка с помощью IDirectorySearch</span><span class="sxs-lookup"><span data-stu-id="bc019-133">Paging with IDirectorySearch</span></span>](paging-with-idirectorysearch.md)
-   [<span data-ttu-id="bc019-134">Поиск с помощью объекты данных ActiveX</span><span class="sxs-lookup"><span data-stu-id="bc019-134">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="bc019-135">Поиск с помощью OLE DB</span><span class="sxs-lookup"><span data-stu-id="bc019-135">Searching with OLE DB</span></span>](searching-with-ole-db.md)

<span data-ttu-id="bc019-136">Страничный поиск прозрачен для приложения, так как ADSI автоматически получает дополнительные страницы результатов, пока не достигнет конца результирующего набора или окончания заданного предела времени.</span><span class="sxs-lookup"><span data-stu-id="bc019-136">A paged search is transparent to your application because ADSI automatically continues to retrieve additional pages of results until it reaches the end of the result set or the end of the time limit that you set.</span></span> <span data-ttu-id="bc019-137">При использовании страничного поиска предельный размер не переопределяет размер страницы.</span><span class="sxs-lookup"><span data-stu-id="bc019-137">When you use a paged search, the size limit does not override page size.</span></span> <span data-ttu-id="bc019-138">Ограничение размера можно использовать только при получении результирующего набора, содержащего менее 1000 записей.</span><span class="sxs-lookup"><span data-stu-id="bc019-138">Size limit can only be used when you retrieve a result set that contains fewer than 1000 entries.</span></span>

 

 




