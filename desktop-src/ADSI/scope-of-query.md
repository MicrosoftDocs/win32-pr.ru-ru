---
title: Область запроса
description: Область запроса определяется объектом, с которым выполняется привязка.
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- область запросов ADSI
- запросы к ADSI, область
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103772923"
---
# <a name="scope-of-query"></a><span data-ttu-id="774a0-105">Область запроса</span><span class="sxs-lookup"><span data-stu-id="774a0-105">Scope of Query</span></span>

<span data-ttu-id="774a0-106">Область запроса определяется объектом, с которым выполняется привязка.</span><span class="sxs-lookup"><span data-stu-id="774a0-106">The scope of a query is determined by the object to which you bind.</span></span> <span data-ttu-id="774a0-107">Если вы не уверены, где находится объект в пределах предприятия, вам потребуется сделать так, чтобы он был максимально широким.</span><span class="sxs-lookup"><span data-stu-id="774a0-107">If you are unsure where the object is located within the enterprise then you will need to do as wide a search as possible.</span></span> <span data-ttu-id="774a0-108">Однако если известно, что объект будет находиться в определенном домене, например в домене, к которому подключен пользователь, или в определенной группе, например в группе диспетчеры, то следует задать область поиска, чтобы отразить условия.</span><span class="sxs-lookup"><span data-stu-id="774a0-108">However, if you know that the object will be contained within a specific domain, such as the domain that the user is connected to, or within a specific group, such as the Managers group, then you should set the scope of the search to reflect the circumstance.</span></span> <span data-ttu-id="774a0-109">Для лучшей производительности следует попытаться выбрать область для поиска наименьшего числа объектов.</span><span class="sxs-lookup"><span data-stu-id="774a0-109">For the best performance, you should try to target the scope to search the smallest number of objects possible.</span></span>

<span data-ttu-id="774a0-110">Если вы не знаете, где находится объект в Организации, можно выполнить привязку к службе глобального каталога.</span><span class="sxs-lookup"><span data-stu-id="774a0-110">When you are not sure where an object will be located in the enterprise, you can bind to the global catalog service.</span></span> <span data-ttu-id="774a0-111">Служба глобального каталога содержит список всех объектов в каталоге и небольшое подмножество атрибутов каждого объекта.</span><span class="sxs-lookup"><span data-stu-id="774a0-111">The global catalog service contains a list of every object in the directory and a small subset of each object's attributes.</span></span> <span data-ttu-id="774a0-112">После нахождения объекта в глобальном каталоге можно извлечь его различающееся имя из глобального каталога и использовать его для привязки к объекту для выполнения других операций.</span><span class="sxs-lookup"><span data-stu-id="774a0-112">After you find the object in the global catalog, you can retrieve its distinguished name from the global catalog and use it to bind to the object to perform other operations.</span></span>

<span data-ttu-id="774a0-113">После выбора объекта для привязки можно дополнительно ограничить запрос одной из следующих областей: базовый запрос, одноуровневый запрос или поиск по поддереву, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="774a0-113">After you decide which object to bind to, you can further restrict the query to one of the following scopes: a base query, a one-level query, or a subtree search, as shown in the following illustration.</span></span>

![объекты в корне поиска для базового, одноуровневого или поддерева поиска](images/netds6.png)

## <a name="base"></a><span data-ttu-id="774a0-115">Основной</span><span class="sxs-lookup"><span data-stu-id="774a0-115">Base</span></span>

<span data-ttu-id="774a0-116">Базовый запрос ограничивает поиск только базовым объектом.</span><span class="sxs-lookup"><span data-stu-id="774a0-116">A base query limits the search to only the base object.</span></span> <span data-ttu-id="774a0-117">Максимальное число возвращаемых объектов всегда равно единице.</span><span class="sxs-lookup"><span data-stu-id="774a0-117">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="774a0-118">Этот поиск можно использовать для проверки существования объекта.</span><span class="sxs-lookup"><span data-stu-id="774a0-118">This search can be used to verify the existence of an object.</span></span> <span data-ttu-id="774a0-119">Например, если у вас есть различающееся имя объекта и необходимо проверить существование объекта на основе пути, можно использовать одноуровневый поиск.</span><span class="sxs-lookup"><span data-stu-id="774a0-119">For example, if you have an object's distinguished name and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="774a0-120">Если поиск завершается неудачей, можно предположить, что объект был переименован или перемещен в другое место или если вы задаете неверные данные об объекте.</span><span class="sxs-lookup"><span data-stu-id="774a0-120">If the search fails, you can assume that the object may have been renamed or moved to a different location, or that you were given incorrect data about the object.</span></span> <span data-ttu-id="774a0-121">Имейте в виду, что при необходимости повторного посещения объекта следует хранить идентификатор GUID вместо различающегося имени.</span><span class="sxs-lookup"><span data-stu-id="774a0-121">Be aware that you should store the GUID instead of the distinguished name if you want to revisit an object.</span></span> <span data-ttu-id="774a0-122">Это позволяет переименование или перемещение объекта в иерархии каталогов без разрыва сохраненной ссылки.</span><span class="sxs-lookup"><span data-stu-id="774a0-122">This allows the object to be renamed or moved in the directory hierarchy without breaking the persisted link.</span></span>

## <a name="one-level"></a><span data-ttu-id="774a0-123">Один уровень</span><span class="sxs-lookup"><span data-stu-id="774a0-123">One Level</span></span>

<span data-ttu-id="774a0-124">Одноуровневый поиск ограничивается непосредственными дочерними элементами базового объекта, но исключает сам базовый объект.</span><span class="sxs-lookup"><span data-stu-id="774a0-124">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="774a0-125">Этот параметр может выполнять целевой поиск непосредственных дочерних объектов родительского объекта.</span><span class="sxs-lookup"><span data-stu-id="774a0-125">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="774a0-126">Например, если у вас есть родительский объект с именем P1, а его непосредственные дочерние элементы: C1, C2, C3, то при вычислении критериев необходимо добавить C1, C2 и C3. но P1 не будет частью поиска.</span><span class="sxs-lookup"><span data-stu-id="774a0-126">For example, if you have a parent object called P1, and its immediate children are: C1, C2, C3, then in a one-level search, C1, C2, and C3 should be included when evaluating the criteria, but P1 would not be part of the search.</span></span> <span data-ttu-id="774a0-127">Одноуровневый поиск можно использовать для перечисления всех дочерних элементов объекта.</span><span class="sxs-lookup"><span data-stu-id="774a0-127">A one-level search can be used to enumerate all children of an object.</span></span> <span data-ttu-id="774a0-128">Фактически, в некоторых поставщиках ADSI перечисление [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) преобразуется в одноуровневый поиск.</span><span class="sxs-lookup"><span data-stu-id="774a0-128">In fact, in some ADSI providers, [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>

## <a name="subtree"></a><span data-ttu-id="774a0-129">Поддерево</span><span class="sxs-lookup"><span data-stu-id="774a0-129">Subtree</span></span>

<span data-ttu-id="774a0-130">Поиск в поддереве, также известный как глубокий поиск, включает все объекты, расположенные под базовым объектом, за исключением самого базового объекта.</span><span class="sxs-lookup"><span data-stu-id="774a0-130">A subtree search, also known as a deep search, includes all the objects beneath the base object, excluding the base object itself.</span></span> <span data-ttu-id="774a0-131">Этот поиск может формировать ссылки на другие серверы.</span><span class="sxs-lookup"><span data-stu-id="774a0-131">This search may generate referrals to other servers.</span></span> <span data-ttu-id="774a0-132">Этот поиск имеет наибольшую область и может возвращать большой результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="774a0-132">This search has the greatest scope and may return a large result set.</span></span> <span data-ttu-id="774a0-133">По возможности выполните поиск по крайней мере на одном индексированном атрибуте и задайте параметры ссылок (Дополнительные сведения см. в разделе [производительность и обработка больших результирующих наборов](performance-and-handling-large-result-sets.md)) в соответствии с требованиями поиска.</span><span class="sxs-lookup"><span data-stu-id="774a0-133">If possible, search on at least one indexed attribute and set the referrals settings (for more information, see [Performance and Handling Large Result Sets](performance-and-handling-large-result-sets.md)) to match your search requirements.</span></span> <span data-ttu-id="774a0-134">Также рекомендуется, чтобы результаты поиска в поддереве выполнялись асинхронно и постранично, чтобы снизить нагрузку на сервер и эффективность сети.</span><span class="sxs-lookup"><span data-stu-id="774a0-134">It is also suggested that the results of a subtree search be performed asynchronously and paged to reduce the server overhead and network effectiveness.</span></span> <span data-ttu-id="774a0-135">Поиск по поддереву обычно используется для поиска объектов в заданной области.</span><span class="sxs-lookup"><span data-stu-id="774a0-135">A subtree search is normally used to search objects for a given scope.</span></span> <span data-ttu-id="774a0-136">Например, выполните поиск всех пользователей с учетными записями, срок действия которых истечет через 30 дней.</span><span class="sxs-lookup"><span data-stu-id="774a0-136">For example, search for all users with accounts that will expire in 30 days or less.</span></span>

 

 




