---
title: Область запроса
description: Область запроса определяется объектом, с которым выполняется привязка.
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- область запросов ADSI
- запросы к ADSI, область
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103772923"
---
# <a name="scope-of-query"></a>Область запроса

Область запроса определяется объектом, с которым выполняется привязка. Если вы не уверены, где находится объект в пределах предприятия, вам потребуется сделать так, чтобы он был максимально широким. Однако если известно, что объект будет находиться в определенном домене, например в домене, к которому подключен пользователь, или в определенной группе, например в группе диспетчеры, то следует задать область поиска, чтобы отразить условия. Для лучшей производительности следует попытаться выбрать область для поиска наименьшего числа объектов.

Если вы не знаете, где находится объект в Организации, можно выполнить привязку к службе глобального каталога. Служба глобального каталога содержит список всех объектов в каталоге и небольшое подмножество атрибутов каждого объекта. После нахождения объекта в глобальном каталоге можно извлечь его различающееся имя из глобального каталога и использовать его для привязки к объекту для выполнения других операций.

После выбора объекта для привязки можно дополнительно ограничить запрос одной из следующих областей: базовый запрос, одноуровневый запрос или поиск по поддереву, как показано на следующем рисунке.

![объекты в корне поиска для базового, одноуровневого или поддерева поиска](images/netds6.png)

## <a name="base"></a>Основной

Базовый запрос ограничивает поиск только базовым объектом. Максимальное число возвращаемых объектов всегда равно единице. Этот поиск можно использовать для проверки существования объекта. Например, если у вас есть различающееся имя объекта и необходимо проверить существование объекта на основе пути, можно использовать одноуровневый поиск. Если поиск завершается неудачей, можно предположить, что объект был переименован или перемещен в другое место или если вы задаете неверные данные об объекте. Имейте в виду, что при необходимости повторного посещения объекта следует хранить идентификатор GUID вместо различающегося имени. Это позволяет переименование или перемещение объекта в иерархии каталогов без разрыва сохраненной ссылки.

## <a name="one-level"></a>Один уровень

Одноуровневый поиск ограничивается непосредственными дочерними элементами базового объекта, но исключает сам базовый объект. Этот параметр может выполнять целевой поиск непосредственных дочерних объектов родительского объекта. Например, если у вас есть родительский объект с именем P1, а его непосредственные дочерние элементы: C1, C2, C3, то при вычислении критериев необходимо добавить C1, C2 и C3. но P1 не будет частью поиска. Одноуровневый поиск можно использовать для перечисления всех дочерних элементов объекта. Фактически, в некоторых поставщиках ADSI перечисление [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) преобразуется в одноуровневый поиск.

## <a name="subtree"></a>Поддерево

Поиск в поддереве, также известный как глубокий поиск, включает все объекты, расположенные под базовым объектом, за исключением самого базового объекта. Этот поиск может формировать ссылки на другие серверы. Этот поиск имеет наибольшую область и может возвращать большой результирующий набор. По возможности выполните поиск по крайней мере на одном индексированном атрибуте и задайте параметры ссылок (Дополнительные сведения см. в разделе [производительность и обработка больших результирующих наборов](performance-and-handling-large-result-sets.md)) в соответствии с требованиями поиска. Также рекомендуется, чтобы результаты поиска в поддереве выполнялись асинхронно и постранично, чтобы снизить нагрузку на сервер и эффективность сети. Поиск по поддереву обычно используется для поиска объектов в заданной области. Например, выполните поиск всех пользователей с учетными записями, срок действия которых истечет через 30 дней.

 

 




