---
title: Кэш атрибутов ADSI
description: Объектная модель ADSI предоставляет кэш атрибутов на стороне клиента для каждого объекта ADSI.
ms.assetid: 0d2b4117-11f2-4b39-8fe5-3b176e4256f4
ms.tgt_platform: multiple
keywords:
- Кэш ADSI для кэша атрибутов ADSI
- ADSI ADSI, использование, доступ к данным и управление ими с помощью ADSI, кэш атрибутов
- атрибуты ADSI, кэширование атрибутов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df3062ed5862f11e9db5dadd83b80ac624218c81
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103772911"
---
# <a name="the-adsi-attribute-cache"></a>Кэш атрибутов ADSI

Объектная модель ADSI предоставляет кэш атрибутов на стороне клиента для каждого объекта ADSI. Кэш атрибутов сравним с таблицей в памяти, которая содержит имена и значения большинства загруженных атрибутов объектов. Некоторые атрибуты, такие как операционные атрибуты, не кэшируются. ADSI использует кэширование свойств для повышения производительности манипуляций с атрибутами и добавления возможностей транзакций для операций чтения и записи атрибутов. Эта возможность важна для клиентов, написанных на языках, которые не имеют собственного механизма пакетной обработки для настройки атрибутов, таких как система разработки Microsoft Visual Basic. Без кэша свойств ADSI такие клиенты должны иметь доступ к серверу при каждом считывании или записи атрибута.

Когда объект создается или сначала привязан к, кэш свойств для объекта пуст. Когда вызывается метод [**iAds::-info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) , ADSI загружает запрошенные атрибуты объекта из базовой службы каталогов в локальный кэш. Когда считывается значение определенного атрибута и кэш пуст, ADSI делает неявный вызов метода **iAds::-info** . При заполнении кэша все операции чтения атрибута работают только с содержимым кэша.

При записи значения атрибута новое значение сохраняется в локальном кэше до тех пор, пока не будет вызван метод [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) . При вызове метода **iAds:: сетинфо** атрибуты в кэше фиксируются в базовой службе каталогов. После вызова метода **iAds:: сетинфо** значения остаются в кэше до тех пор, пока не будет явно обновлен другой вызов метода [**iAds::-info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) .

> [!IMPORTANT]
> Метод [**iAds::**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) OutAttribute следует использовать аккуратно, так как этот метод всегда перезаписывает значения атрибутов в кэше из базовой службы каталогов, даже если кэшированное значение было изменено. То есть он перезапишет значения атрибутов, которые были изменены в кэше, но не зафиксированы в базовой службе каталогов с помощью вызова метода [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) .

 

На следующем рисунке показаны различные методы, используемые при работе с кэшем.

![кэш атрибутов ADSI](images/ds2propc.png)

 

 




