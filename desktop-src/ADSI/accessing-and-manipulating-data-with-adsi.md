---
title: Доступ к данным и управление ими с помощью ADSI
description: Все объекты имеют свойства.
ms.assetid: 366a1fbc-3089-406a-9819-cf2ba7636c5f
ms.tgt_platform: multiple
keywords:
- ADSI ADSI, доступ к данным и управление ими
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3291db7490c79aae6363f619582ed24339fb83d
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105654354"
---
# <a name="accessing-and-manipulating-data-with-adsi"></a><span data-ttu-id="43577-104">Доступ к данным и управление ими с помощью ADSI</span><span class="sxs-lookup"><span data-stu-id="43577-104">Accessing and Manipulating Data with ADSI</span></span>

<span data-ttu-id="43577-105">Все объекты имеют свойства.</span><span class="sxs-lookup"><span data-stu-id="43577-105">All objects have properties.</span></span> <span data-ttu-id="43577-106">Все COM-объекты Active Directory интерфейсов служб (ADSI) имеют один или несколько интерфейсов с методами, которые извлекают свойства объекта каталога, представляемого объектом COM.</span><span class="sxs-lookup"><span data-stu-id="43577-106">All Active Directory Service Interface (ADSI) COM objects have one or more interfaces with methods that retrieve the properties of the directory object that the COM object represents.</span></span> <span data-ttu-id="43577-107">Существует несколько способов чтения свойств объекта.</span><span class="sxs-lookup"><span data-stu-id="43577-107">There are a number of ways you can read properties from an object:</span></span>

-   <span data-ttu-id="43577-108">Получить конкретное свойство по имени: интерфейс [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) имеет два метода [**iAds:: Get**](/windows/desktop/api/Iads/nf-iads-iads-get) и [**iAds:: жетекс**](/windows/desktop/api/Iads/nf-iads-iads-getex) для чтения определенного свойства.</span><span class="sxs-lookup"><span data-stu-id="43577-108">Get a specific property by name: The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface has two methods [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get) and [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex) to read a specific property.</span></span> <span data-ttu-id="43577-109">Каждый COM-объект ADSI имеет интерфейс **iAds** .</span><span class="sxs-lookup"><span data-stu-id="43577-109">Every ADSI COM object has an **IADs** interface.</span></span>
-   <span data-ttu-id="43577-110">Получить указанный список свойств: интерфейс [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) имеет метод [**Идиректорйобжект:: жетобжектаттрибутес**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-getobjectattributes) , который позволяет указать список, содержащий имена свойств для чтения, и возвращает массив структур, содержащих запрошенные значения свойств.</span><span class="sxs-lookup"><span data-stu-id="43577-110">Get a specified list of properties: The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface has the method [**IDirectoryObject::GetObjectAttributes**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-getobjectattributes) that allows you to specify a list containing the names of the properties to read and returns an array of structures containing the requested property values.</span></span>
-   <span data-ttu-id="43577-111">Перечисление всех свойств объекта. интерфейс [**иадспропертилист**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) позволяет перечислить все свойства объекта.</span><span class="sxs-lookup"><span data-stu-id="43577-111">Enumerate all properties on the object: The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) interface allows you to enumerate all the properties on an object.</span></span>
-   <span data-ttu-id="43577-112">Получить специальные свойства: интерфейсы автоматизации ([**iAds**](/windows/desktop/api/Iads/nn-iads-iads) \* ) имеют методы свойств, позволяющие получать специальные свойства, которые не хранятся в объекте.</span><span class="sxs-lookup"><span data-stu-id="43577-112">Get special properties: The Automation interfaces ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads)\*) have property methods that allow you to get special properties that are not stored in an object.</span></span> <span data-ttu-id="43577-113">Или методы свойств позволяют получить свойство объекта в формате данных, отличающемся от фактического типа данных.</span><span class="sxs-lookup"><span data-stu-id="43577-113">Or the property methods may allow you to get an object property in a data format that differs from the actual data type stored.</span></span> <span data-ttu-id="43577-114">Например, интерфейс **iAds** имеет методы свойств, такие как [**iAds:: Get \_ Name**](iads-property-methods.md), который извлекает относительное различающееся имя объекта (RDN); **IAds:: Get \_ Класс**, который получает класс объекта и параметр **iAds:: Get \_ Parent**, который извлекает путь к родителю объекта.</span><span class="sxs-lookup"><span data-stu-id="43577-114">For example, the **IADs** interface has property methods such as [**IADs::get\_Name**](iads-property-methods.md), which retrieves an object's relative distinguished name (RDN); **IADs::get\_Class**, which retrieves an object's class, and **IADs::get\_Parent**, which retrieves the ADsPath to the object's parent.</span></span>

<span data-ttu-id="43577-115">ADSI позволяет локально кэшировать свойства после их чтения с сервера каталогов.</span><span class="sxs-lookup"><span data-stu-id="43577-115">ADSI allows you to cache properties locally after they have been read from the directory server.</span></span> <span data-ttu-id="43577-116">Это позволяет считывать свойства из локального кэша свойств или получать свойства непосредственно с сервера каталогов.</span><span class="sxs-lookup"><span data-stu-id="43577-116">This allows you a choice of reading the properties from the local property cache or retrieving the properties directly from the directory server.</span></span> <span data-ttu-id="43577-117">В ADSI также есть методы для обновления кэша, а также указано, будут ли кэшироваться все свойства объекта или только указанные.</span><span class="sxs-lookup"><span data-stu-id="43577-117">ADSI also has methods to update the cache as well as specifying whether all properties for an object are cached or just those you have specified.</span></span>

<span data-ttu-id="43577-118">После получения свойства вы читаете его значение.</span><span class="sxs-lookup"><span data-stu-id="43577-118">After you have retrieved a property, you read its value.</span></span> <span data-ttu-id="43577-119">Тип данных свойства зависит от определения свойства (также известного как атрибут) в схеме Active Directory.</span><span class="sxs-lookup"><span data-stu-id="43577-119">The data type of a property depends on the definition of the property (also known as an attribute) in the Active Directory schema.</span></span> <span data-ttu-id="43577-120">Для каждого типа свойства, которое может существовать в Active Directory, существует объект **attributeSchema** в схеме Active Directory.</span><span class="sxs-lookup"><span data-stu-id="43577-120">For each type of property that can exist in Active Directory, there is an **attributeSchema** object in the Active Directory schema.</span></span> <span data-ttu-id="43577-121">Объект **attributeSchema** определяет характеристики атрибута.</span><span class="sxs-lookup"><span data-stu-id="43577-121">An **attributeSchema** object defines the characteristics of the attribute.</span></span> <span data-ttu-id="43577-122">Одной из этих характеристик является синтаксис атрибута, который определяет тип данных значений атрибута.</span><span class="sxs-lookup"><span data-stu-id="43577-122">One of these characteristics is the attribute's syntax, which determines the data type of the attribute's values.</span></span> <span data-ttu-id="43577-123">Дополнительные сведения см. в разделе [характеристики атрибутов](/windows/desktop/AD/characteristics-of-attributes) и [синтаксиса для Active Directoryных атрибутов](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="43577-123">For more information, see [Characteristics of Attributes](/windows/desktop/AD/characteristics-of-attributes) and [Syntaxes for Active Directory Attributes](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services).</span></span>

<span data-ttu-id="43577-124">Интерфейсы автоматизации ([**iAds**](/windows/desktop/api/Iads/nn-iads-iads) \* ) возвращают значение свойства как [**вариант**](/windows/win32/api/oaidl/ns-oaidl-variant) или указатель на интерфейс автоматизации для COM-объекта, представляющего свойство.</span><span class="sxs-lookup"><span data-stu-id="43577-124">The Automation interfaces ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads)\*) return a property value as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) or a pointer to an Automation interface on a COM object that represents the property.</span></span> <span data-ttu-id="43577-125">Интерфейсы [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) и [**IDirectorySearch**](/windows/desktop/api/Iads/nn-iads-idirectorysearch) возвращают свойство в виде указателя на структуру, содержащую типизированное значение свойства или указатель на строку байтов.</span><span class="sxs-lookup"><span data-stu-id="43577-125">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) and [**IDirectorySearch**](/windows/desktop/api/Iads/nn-iads-idirectorysearch) interfaces return a property as a pointer to a structure containing a typed property value or a pointer to a string of bytes.</span></span> <span data-ttu-id="43577-126">Кроме того, **идиректорйобжект** и **IDirectorySearch** получают свойства непосредственно с сервера каталогов, а не с помощью локального кэша свойств.</span><span class="sxs-lookup"><span data-stu-id="43577-126">In addition, **IDirectoryObject** and **IDirectorySearch** retrieve properties directly from the directory server instead of using a local property cache.</span></span>

<span data-ttu-id="43577-127">В этом разделе описаны следующие темы:</span><span class="sxs-lookup"><span data-stu-id="43577-127">This section describes the following topics:</span></span>

-   [<span data-ttu-id="43577-128">Интерфейсы IADs и Идиректорйобжект</span><span class="sxs-lookup"><span data-stu-id="43577-128">The IADs and IDirectoryObject Interfaces</span></span>](the-iads-and-idirectoryobject-interfaces.md)
-   [<span data-ttu-id="43577-129">Доступ к атрибутам с помощью ADSI</span><span class="sxs-lookup"><span data-stu-id="43577-129">Accessing Attributes with ADSI</span></span>](accessing-attributes-with-adsi.md)
-   [<span data-ttu-id="43577-130">Изменение атрибутов с помощью ADSI</span><span class="sxs-lookup"><span data-stu-id="43577-130">Modifying Attributes with ADSI</span></span>](modifying-attributes-with-adsi.md)
-   [<span data-ttu-id="43577-131">Доступ к кэшу свойств напрямую с помощью интерфейсов Иадспроперти</span><span class="sxs-lookup"><span data-stu-id="43577-131">Accessing the Property Cache Directly with the IADsProperty Interfaces</span></span>](accessing-the-property-cache-directly-with-the-iadsproperty-interfaces.md)
-   [<span data-ttu-id="43577-132">Синтаксис атрибутов ADSI</span><span class="sxs-lookup"><span data-stu-id="43577-132">ADSI Attribute Syntax</span></span>](adsi-attribute-syntax.md)

 

 