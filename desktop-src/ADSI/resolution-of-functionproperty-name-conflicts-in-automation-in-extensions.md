---
title: Разрешение конфликтов имен функций и свойств в автоматизации в расширениях
description: 'В этом разделе: \ 0034; объект \ 0034; Указывает объект в целом, как клиент ADSI просматривает его. То есть ADSI и все его расширения.'
ms.assetid: 76207326-879e-408b-8004-06d940401a41
ms.tgt_platform: multiple
keywords:
- Разрешение конфликтов имен функций и свойств в автоматизации в расширениях
- расширения ADSI, разрешение конфликтов имен функций и свойств в службе автоматизации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d9a7ac99b99ecdf0ee1b940f066d9e8166a15542
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104413720"
---
# <a name="resolution-of-functionproperty-name-conflicts-in-automation-in-extensions"></a><span data-ttu-id="3c85d-106">Разрешение конфликтов имен функций и свойств в автоматизации в расширениях</span><span class="sxs-lookup"><span data-stu-id="3c85d-106">Resolution of Function/Property Name Conflicts in Automation in Extensions</span></span>

<span data-ttu-id="3c85d-107">В этом разделе «Object» обозначает объект в целом, как клиент ADSI просматривает его.</span><span class="sxs-lookup"><span data-stu-id="3c85d-107">In this topic, "object" indicates the object, as a whole, as an ADSI client views it.</span></span> <span data-ttu-id="3c85d-108">То есть ADSI и все его расширения.</span><span class="sxs-lookup"><span data-stu-id="3c85d-108">That is, ADSI and all its extensions.</span></span>

## <a name="same-function-name-with-the-same-parameters"></a><span data-ttu-id="3c85d-109">Имя функции с одинаковыми параметрами</span><span class="sxs-lookup"><span data-stu-id="3c85d-109">Same Function Name With the Same Parameters</span></span>

<span data-ttu-id="3c85d-110">Если два или более сдвоенных интерфейса [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) в объекте поддерживают свойство или метод с тем же именем, например **func1**, то вызов определяется по следующим критериям.</span><span class="sxs-lookup"><span data-stu-id="3c85d-110">If two or more dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interfaces in an object support a property or method of the same name, for example, **Func1**, invocation is determined using the following criteria.</span></span> <span data-ttu-id="3c85d-111">Если клиент имеет указатель на один из сдвоенных интерфейсов, поддерживающих метод с именем **func1** , а среда автоматизации поддерживает доступ vtable, **func1** вызывается напрямую через доступ к таблице vtable ADSI.</span><span class="sxs-lookup"><span data-stu-id="3c85d-111">If the client has a pointer to one of the dual interfaces that support a method called **Func1** and if the Automation environment supports vtable access, **Func1** is invoked directly through ADSI vtable access.</span></span>

<span data-ttu-id="3c85d-112">Если любое из указанных выше условий имеет значение false, то для вызова **func1** вызываются [**IDispatch:: GetIdsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) и [**IDispatch:: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) .</span><span class="sxs-lookup"><span data-stu-id="3c85d-112">If either of the conditions above is false, [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) and [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) are called to invoke **Func1**.</span></span>

<span data-ttu-id="3c85d-113">Дополнительные сведения и краткое описание того, как клиент может добавить указатель на сдвоенный интерфейс, а также описания типов сред, поддерживающих доступ к таблице vtable, см. в разделе [позднее связывание и доступ vtable в модели расширения ADSI](late-binding-vs--vtable-access-in-the-adsi-extension-model.md).</span><span class="sxs-lookup"><span data-stu-id="3c85d-113">For more information and a brief explanation about how a client can add a pointer to a dual interface, and a description of the types of environments that support vtable access, see [Late Binding versus Vtable Access in the ADSI Extension Model](late-binding-vs--vtable-access-in-the-adsi-extension-model.md).</span></span>

<span data-ttu-id="3c85d-114">Так как все объекты расширения переправляют функции [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) обратно в агрегатор, агрегатор определяет, какой **func1** вызывается.</span><span class="sxs-lookup"><span data-stu-id="3c85d-114">Because all extension objects redirect the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) functions back to the aggregator, the aggregator controls which **Func1** is invoked.</span></span> <span data-ttu-id="3c85d-115">Правила:</span><span class="sxs-lookup"><span data-stu-id="3c85d-115">The rules are:</span></span>

-   <span data-ttu-id="3c85d-116">Если какой-либо интерфейс, и будет только один из них, в агрегаторе (ADSI) поддерживает функцию с именем **func1**, агрегатор вызывает собственный **func1**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-116">If any interface, and there will be only one, if any, in the aggregator (ADSI) supports a function called **Func1**, the aggregator invokes its own **Func1**.</span></span>
-   <span data-ttu-id="3c85d-117">В противном случае агрегатор проходит через все свои расширения в порядке, указанном в реестре, и находит первое расширение, реализующее функцию с именем **func1**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-117">Otherwise, the aggregator goes through each of its extensions, in the order listed in the registry, and finds the first extension that implements a function called **Func1**.</span></span> <span data-ttu-id="3c85d-118">Возможно, но маловероятно, что несколько сдвоенных интерфейсов [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) в этом первом расширении имеют функцию с именем **func1**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-118">It is possible, but unlikely, that multiple dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interfaces in this first extension have a function called **Func1**.</span></span> <span data-ttu-id="3c85d-119">Расширение должно определять, какой **func1** всегда должен вызываться в службе автоматизации.</span><span class="sxs-lookup"><span data-stu-id="3c85d-119">The extension must determine which **Func1** should always be invoked in Automation.</span></span>

## <a name="same-function-name-with-different-parameters"></a><span data-ttu-id="3c85d-120">Имя функции с разными параметрами</span><span class="sxs-lookup"><span data-stu-id="3c85d-120">Same Function Name With Different Parameters</span></span>

<span data-ttu-id="3c85d-121">В предыдущем разделе было рассмотрено разрешение конфликтов имен функций, то есть имена функций с одинаковыми именами функций и списком параметров, например число, тип и порядок, при возникновении в службе автоматизации.</span><span class="sxs-lookup"><span data-stu-id="3c85d-121">The previous section discussed how to resolve function name conflicts, that is, function names that have the same function name and same parameter list, such as number, type and order, when it occurs in Automation.</span></span> <span data-ttu-id="3c85d-122">Что делать, если две функции имеют одинаковые имена, но разные параметры?</span><span class="sxs-lookup"><span data-stu-id="3c85d-122">What if two functions have the same name but different parameters?</span></span> <span data-ttu-id="3c85d-123">Если клиент ADSI вызывает функцию с помощью [**IDispatch:: GetIdsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) без использования нескольких имен для указания параметров, модель расширения ADSI не может устранить неоднозначность функций.</span><span class="sxs-lookup"><span data-stu-id="3c85d-123">If an ADSI client invokes the function using [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) without using multiple names to specify the parameters, the ADSI extension model cannot disambiguate the functions.</span></span> <span data-ttu-id="3c85d-124">В соответствии со схемой разрешения, описанной выше, первое расширение в реестре, которое поддерживает эту функцию через один из своих интерфейсов, вызывает ее версию, и вызов может завершиться ошибкой или привести к неправильным результатам.</span><span class="sxs-lookup"><span data-stu-id="3c85d-124">Based on the resolution scheme discussed in above, the first extension in the registry that supports this function through one of its interfaces has its version of this function invoked, and the call may fail or yield incorrect results.</span></span>

<span data-ttu-id="3c85d-125">Пример:</span><span class="sxs-lookup"><span data-stu-id="3c85d-125">For example:</span></span>

-   <span data-ttu-id="3c85d-126">Extn1 (сначала в реестре с классом CA — более высокий приоритет) поддерживает **IInterface1**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-126">Extn1 (first in the registry under class CA – higher priority) supports **IInterface1**.</span></span>
-   <span data-ttu-id="3c85d-127">Extn2 (третья в реестре с классом CA — низший приоритет) поддерживает **IInterface2**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-127">Extn2 (third in the registry under class CA – lower priority) supports **IInterface2**.</span></span>
-   <span data-ttu-id="3c85d-128">**IInterface1** поддерживает **Method1 (тип Param1, int Param2)**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-128">**IInterface1** supports **Method1(int param1, int param2)**.</span></span>
-   <span data-ttu-id="3c85d-129">**IInterface2** поддерживает **Method1 (тип Param1)**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-129">**IInterface2** supports **Method1(int param1)**.</span></span>

<span data-ttu-id="3c85d-130">Клиент ADSI имеет указатель интерфейса [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) на объект CA класса.</span><span class="sxs-lookup"><span data-stu-id="3c85d-130">An ADSI client has an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface pointer to an object of class CA.</span></span> <span data-ttu-id="3c85d-131">Он хочет вызвать **IInterface2:: Method1**.</span><span class="sxs-lookup"><span data-stu-id="3c85d-131">It wants to invoke **IInterface2::Method1**.</span></span> <span data-ttu-id="3c85d-132">Если клиент вызывает "Пдиспатч->GetIDsOfNames (IID \_ null, ргсзнамес, 1, My \_ LCID, ргдиспид)", просто сохранив имя функции "Method1" в *ргсзнамес \[ 0 \]*, тогда **IInterface1:: Method1** вместо нужного метода **IInterface2:: Method1** вызывается ошибка, так как число параметров отличается.</span><span class="sxs-lookup"><span data-stu-id="3c85d-132">If the client calls "pDispatch->GetIDsOfNames(IID\_NULL, rgszNames, 1, MY\_LCID, rgDispId)" by just storing the function name "Method1" in *rgszNames\[0\]*, then **IInterface1::Method1** instead of the desired **IInterface2::Method1** is invoked, and the function fails because the number of parameters are different.</span></span>

<span data-ttu-id="3c85d-133">Чтобы устранить эту проблему, разработчики расширений могут добавить префиксы своих функций к собственным идентификаторам и избежать проектирования интерфейсов, использующих функции с одинаковыми именами, но разными параметрами.</span><span class="sxs-lookup"><span data-stu-id="3c85d-133">To minimize this problem, extension developers can prefix their function names with their own specific identifiers and avoid interface designs that use functions of the same name, but different parameters.</span></span>

<span data-ttu-id="3c85d-134">Если возникает конфликт имен, клиенты ADSI могут избежать проблемы путем прямого доступа к vtable, если интерфейс является сдвоенным интерфейсом.</span><span class="sxs-lookup"><span data-stu-id="3c85d-134">If a name conflict does occur, ADSI clients can avoid the problem by direct vtable access if the interface is a dual interface.</span></span> <span data-ttu-id="3c85d-135">Если прямой доступ к таблице vtable невозможен, клиенты ADSI должны вызывать [**IDispatch:: GetIdsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) с несколькими именами, указывая имена функций, а также параметры в массиве *ргсзнамес* , описанные выше.</span><span class="sxs-lookup"><span data-stu-id="3c85d-135">If direct vtable access is not possible, ADSI clients should call [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) with multiple names, specifying the function names as well as the parameters in the array *rgszNames* described previously.</span></span>

<span data-ttu-id="3c85d-136">Visual Basic 5 не вызывает функцию [**IDispatch:: GetIdsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) с несколькими именами.</span><span class="sxs-lookup"><span data-stu-id="3c85d-136">Visual Basic 5 does not call the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) function with multiple names.</span></span> <span data-ttu-id="3c85d-137">То есть он передает только имя функции в **GetIDsOfNames**, но не аргументы.</span><span class="sxs-lookup"><span data-stu-id="3c85d-137">That is, it passes only the function name to **GetIDsOfNames**, but not arguments.</span></span> <span data-ttu-id="3c85d-138">Однако Visual Basic 5 позволяет пользователям вызывать функцию путем прямого доступа к таблице vtable вместо вызова функции **IDispatch:: GetIdsOfNames** , если интерфейс является сдвоенным интерфейсом.</span><span class="sxs-lookup"><span data-stu-id="3c85d-138">However, Visual Basic 5 allows users to invoke a function by direct vtable access, instead of invoking the **IDispatch::GetIDsOfNames** function if the interface is a dual interface.</span></span> <span data-ttu-id="3c85d-139">Если это возможно, разработчики должны использовать прямой доступ к vtable.</span><span class="sxs-lookup"><span data-stu-id="3c85d-139">Developers should use direct vtable access, if possible.</span></span>

<span data-ttu-id="3c85d-140">Дополнительные сведения об устранении конфликтов имен см. в разделе [пример разрешения конфликтов имен функций](example-for-resolving-function-name-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="3c85d-140">For more information about name conflict resolution, see [Example for Resolving Function Name Conflicts](example-for-resolving-function-name-conflicts.md).</span></span>

 

 