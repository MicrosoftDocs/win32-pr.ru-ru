---
title: Создание и удаление объектов
description: При использовании ADSI объекты создаются и удаляются с помощью интерфейса Иадсконтаинер или Идиректорйобжект.
ms.assetid: 4d1f7ac5-48d3-4ea9-91e4-0cd4bb2ec9f8
ms.tgt_platform: multiple
keywords:
- Создание и удаление объектов ADSI
- ADSI, создание и удаление объектов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4730c4cc6a95ad37bfd3953474d3d488fcf05abb
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104488280"
---
# <a name="creating-and-deleting-objects"></a><span data-ttu-id="6acf0-105">Создание и удаление объектов</span><span class="sxs-lookup"><span data-stu-id="6acf0-105">Creating and Deleting Objects</span></span>

<span data-ttu-id="6acf0-106">При использовании ADSI объекты создаются и удаляются с помощью интерфейса [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) или [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-106">With ADSI, objects are created and deleted using either the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) or [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>

## <a name="creating-an-object-with-iadscontainer"></a><span data-ttu-id="6acf0-107">Создание объекта с помощью Иадсконтаинер</span><span class="sxs-lookup"><span data-stu-id="6acf0-107">Creating an Object with IADsContainer</span></span>

<span data-ttu-id="6acf0-108">**Создание объекта с помощью интерфейса Иадсконтаинер**</span><span class="sxs-lookup"><span data-stu-id="6acf0-108">**To create an object with the IADsContainer interface**</span></span>

1.  <span data-ttu-id="6acf0-109">Выполните привязку к контейнеру, который будет содержать создаваемый объект, и получите интерфейс [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-109">Bind to the container that will contain the object to be created and obtain the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span>
2.  <span data-ttu-id="6acf0-110">Используйте метод [**иадсконтаинер. Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) , чтобы создать новый объект в контейнере.</span><span class="sxs-lookup"><span data-stu-id="6acf0-110">Use the [**IADsContainer.Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method to create a new object in the container.</span></span>
3.  <span data-ttu-id="6acf0-111">Задайте значения для всех необходимых атрибутов объекта с помощью метода [**iAds.**](/windows/desktop/api/Iads/nf-iads-iads-put) WHERE или [**iAds. путекс**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-111">Set the values for all of the required attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span> <span data-ttu-id="6acf0-112">Атрибуты, необходимые для создания объекта, зависят от службы каталогов и типа создаваемого объекта.</span><span class="sxs-lookup"><span data-stu-id="6acf0-112">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="6acf0-113">Дополнительные сведения о создании Active Directory объектов см. в разделе [Создание и удаление объектов Active Directory](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="6acf0-113">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="6acf0-114">Задайте значения для всех требуемых дополнительных атрибутов объекта с помощью метода [**iAds.**](/windows/desktop/api/Iads/nf-iads-iads-put) WHERE или [**iAds. путекс**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-114">Set the values for all of the desired optional attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span>
5.  <span data-ttu-id="6acf0-115">Вызовите метод [**iAds. сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) , чтобы зафиксировать объект и его атрибуты.</span><span class="sxs-lookup"><span data-stu-id="6acf0-115">Call the [**IADs.SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method to commit the object and its attributes.</span></span> <span data-ttu-id="6acf0-116">Новый объект фактически не создается в базовой службе каталогов до тех пор, пока не будет вызван метод **iAds. сетинфо** для фиксации атрибутов.</span><span class="sxs-lookup"><span data-stu-id="6acf0-116">The new object is not actually created in the underlying directory service until the **IADs.SetInfo** method is called to commit the attributes.</span></span>

## <a name="creating-an-object-with-idirectoryobject"></a><span data-ttu-id="6acf0-117">Создание объекта с помощью Идиректорйобжект</span><span class="sxs-lookup"><span data-stu-id="6acf0-117">Creating an Object with IDirectoryObject</span></span>

<span data-ttu-id="6acf0-118">**Создание объекта с помощью интерфейса Идиректорйобжект**</span><span class="sxs-lookup"><span data-stu-id="6acf0-118">**To create an object with the IDirectoryObject interface**</span></span>

1.  <span data-ttu-id="6acf0-119">Выполните привязку к контейнеру, который будет содержать создаваемый объект, и получите интерфейс [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-119">Bind to the container that will contain the object to be created and obtain the [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>
2.  <span data-ttu-id="6acf0-120">Выделите массив структур [**\_ \_ сведений attr**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) , содержащий одну структуру для каждого атрибута, который должен быть задан при создании объекта.</span><span class="sxs-lookup"><span data-stu-id="6acf0-120">Allocate an array of [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structures that contains one structure for each attribute to be set when the object is created.</span></span>
3.  <span data-ttu-id="6acf0-121">Заполните [**структуру \_ \_ сведений attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) для каждого обязательного атрибута объекта.</span><span class="sxs-lookup"><span data-stu-id="6acf0-121">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each required attribute for the object.</span></span> <span data-ttu-id="6acf0-122">Атрибуты, необходимые для создания объекта, зависят от службы каталогов и типа создаваемого объекта.</span><span class="sxs-lookup"><span data-stu-id="6acf0-122">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="6acf0-123">Дополнительные сведения о создании Active Directory объектов см. в разделе [Создание и удаление объектов Active Directory](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="6acf0-123">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="6acf0-124">Заполните [**структуру \_ \_ сведений о attr в ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) для каждого необязательного атрибута объекта.</span><span class="sxs-lookup"><span data-stu-id="6acf0-124">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each optional attribute for the object.</span></span>
5.  <span data-ttu-id="6acf0-125">Чтобы создать объект в контейнере, используйте метод [**идиректорйобжект:: креатедсобжект**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-125">Use the [**IDirectoryObject::CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) method to create the object in the container.</span></span> <span data-ttu-id="6acf0-126">Этот метод также фиксирует объект в базовой службе каталогов.</span><span class="sxs-lookup"><span data-stu-id="6acf0-126">This method also commits the object to the underlying directory service.</span></span> <span data-ttu-id="6acf0-127">Если массив [**\_ \_ сведений о**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) атрибутах ADS не содержит все необходимые атрибуты для объекта, **идиректорйобжект:: креатедсобжект** завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="6acf0-127">If the [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) array does not contain all of the required attributes for the object, **IDirectoryObject::CreateDSObject** will fail.</span></span>

## <a name="deleting-an-object"></a><span data-ttu-id="6acf0-128">Удаление объекта</span><span class="sxs-lookup"><span data-stu-id="6acf0-128">Deleting an Object</span></span>

<span data-ttu-id="6acf0-129">Чтобы удалить объект, используйте метод [**иадсконтаинер::D удалить**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) или [**Идиректорйобжект::D елетедсобжект**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) .</span><span class="sxs-lookup"><span data-stu-id="6acf0-129">To delete an object use the [**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) or the [**IDirectoryObject::DeleteDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) method.</span></span> <span data-ttu-id="6acf0-130">Эти методы завершатся ошибкой, если удаленный объект содержит любые дочерние объекты.</span><span class="sxs-lookup"><span data-stu-id="6acf0-130">These methods will fail if the deleted object contains any child objects.</span></span> <span data-ttu-id="6acf0-131">Используйте метод [**иадсделетеопс::D елетеобжект**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) , чтобы удалить контейнер и все дочерние объекты контейнера.</span><span class="sxs-lookup"><span data-stu-id="6acf0-131">Use the [**IADsDeleteOps::DeleteObject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) method to delete a container and all of the container's child objects.</span></span>

<span data-ttu-id="6acf0-132">Что происходит с удаленным объектом, зависит от базовой службы каталогов.</span><span class="sxs-lookup"><span data-stu-id="6acf0-132">What happens to a deleted object depends on the underlying directory service.</span></span> <span data-ttu-id="6acf0-133">Дополнительные сведения об удалении объектов Active Directory см. в разделе [Создание и удаление объектов Active Directory](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="6acf0-133">For more information about deleting Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>

 

 