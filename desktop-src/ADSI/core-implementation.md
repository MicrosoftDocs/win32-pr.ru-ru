---
title: Базовая реализация
description: 'Поставщик ADSI поддерживает следующие функции:'
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- интерфейсы ADSI для базовой реализации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070623"
---
# <a name="core-implementation"></a><span data-ttu-id="02e19-104">Базовая реализация</span><span class="sxs-lookup"><span data-stu-id="02e19-104">Core Implementation</span></span>

<span data-ttu-id="02e19-105">Поставщик ADSI поддерживает следующие функции:</span><span class="sxs-lookup"><span data-stu-id="02e19-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="02e19-106">ADsPath строк в формате COM и URL.</span><span class="sxs-lookup"><span data-stu-id="02e19-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="02e19-107">По определению можно получить объект Active Directory с помощью ADsPath.</span><span class="sxs-lookup"><span data-stu-id="02e19-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="02e19-108">Поставщики поддерживают синтаксис, который служба каталогов требует использовать для реализации **парседисплайнаме** .</span><span class="sxs-lookup"><span data-stu-id="02e19-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="02e19-109">Объект пространства имен верхнего уровня, поддерживающий [**ипарседисплайнаме::P арседисплайнаме**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) и [**иадсопендсобжект**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span><span class="sxs-lookup"><span data-stu-id="02e19-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="02e19-110">Этот объект содержит корневые узлы для этого пространства имен.</span><span class="sxs-lookup"><span data-stu-id="02e19-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="02e19-111">Часть реализации **парседисплайнаме** должна включать средство синтаксического анализа, которое проверяет синтаксические ошибки в своем собственном пространстве имен.</span><span class="sxs-lookup"><span data-stu-id="02e19-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="02e19-112">Этот объект также должен поддерживать [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) и **иадсопендсобжект**.</span><span class="sxs-lookup"><span data-stu-id="02e19-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="02e19-113">Интерфейс [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="02e19-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="02e19-114">Сюда входит простая реализация кэша свойств с помощью метода [**iAds::-info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) и [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span><span class="sxs-lookup"><span data-stu-id="02e19-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="02e19-115">Операции, которые получают или задают свойства объекта, выполняются в режиме кэширования.</span><span class="sxs-lookup"><span data-stu-id="02e19-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="02e19-116">Значения кэша записываются в базовое хранилище каталога во время процедуры **iAds:: сетинфо**.</span><span class="sxs-lookup"><span data-stu-id="02e19-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="02e19-117">Однако метод ADSI не кэшируется, но выполняется немедленно.</span><span class="sxs-lookup"><span data-stu-id="02e19-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="02e19-118">Интерфейсы [**иадспропертилист**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**иадспропертентри**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) и [**иадспропертивалуе**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) для прямого доступа к свойствам и их перечисления в кэше свойств.</span><span class="sxs-lookup"><span data-stu-id="02e19-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="02e19-119">Для служб каталогов, которые не предоставляют схему, этот интерфейс позволяет управлять свойствами объекта.</span><span class="sxs-lookup"><span data-stu-id="02e19-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="02e19-120">Интерфейс [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) для клиентов, не поддерживающих автоматизацию.</span><span class="sxs-lookup"><span data-stu-id="02e19-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="02e19-121">При этом используется протокол over-Wire для максимальной производительности и обход кэша свойств.</span><span class="sxs-lookup"><span data-stu-id="02e19-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="02e19-122">Интерфейс [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="02e19-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="02e19-123">Каждый объект Active Directory имеет родительский контейнер, который управляет его временем существования.</span><span class="sxs-lookup"><span data-stu-id="02e19-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="02e19-124">Имейте в виду, что для объектов контейнера ADs параметр [**iAds:: info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) влияет только на свойства контейнера, а не на его содержимое.</span><span class="sxs-lookup"><span data-stu-id="02e19-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="02e19-125">Сетинфо для объектов контейнера ADs затрагивает только свойства контейнера и не влияет на вновь созданные объекты или объекты, которые уже существуют в контейнере.</span><span class="sxs-lookup"><span data-stu-id="02e19-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="02e19-126">Интерфейс [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="02e19-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="02e19-127">Это интерфейс автоматизации для таких языков, как Visual Basic Scripting Edition, которые не используют привязку времени компиляции.</span><span class="sxs-lookup"><span data-stu-id="02e19-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="02e19-128">Связано с этим данными библиотеки типов, которые должен предоставить поставщик.</span><span class="sxs-lookup"><span data-stu-id="02e19-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="02e19-129">Дополнительные сведения см. в статье [вопросы реализации поставщиков ADSI](implementation-issues-for-adsi-providers.md).</span><span class="sxs-lookup"><span data-stu-id="02e19-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="02e19-130">Объект контейнера класса схемы, соответствующий синтаксис, свойство и объекты класса схемы, поддерживающие [**иадссинтакс**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**иадспроперти**](/windows/desktop/api/Iads/nn-iads-iadsproperty)и [**иадскласс**](/windows/desktop/api/Iads/nn-iads-iadsclass) соответственно.</span><span class="sxs-lookup"><span data-stu-id="02e19-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="02e19-131">Как минимум, каждый корневой узел должен содержать собственный объект-контейнер класса схемы.</span><span class="sxs-lookup"><span data-stu-id="02e19-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="02e19-132">Интерфейс [**иадсмемберс**](/windows/desktop/api/Iads/nn-iads-iadsmembers) , если какие – либо поддерживаемые атрибуты являются коллекциями объектов ADSI, например группами безопасности.</span><span class="sxs-lookup"><span data-stu-id="02e19-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="02e19-133">Интерфейс [**иадсколлектион**](/windows/desktop/api/Iads/nn-iads-iadscollection) , если поддерживаемые атрибуты являются коллекциями одного и того же типа элементов каталога с [**Иадсколлектион:: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) и [**иадсколлектион:: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) .</span><span class="sxs-lookup"><span data-stu-id="02e19-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="02e19-134">Перечисление **иенумкскскскс** поддерживает все определенные объекты перечислителя.</span><span class="sxs-lookup"><span data-stu-id="02e19-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="02e19-135">Подпрограммы для отображения синтаксиса и преобразования собственных данных в тип данных [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="02e19-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="02e19-136">Следуйте соглашениям ADSI для предоставляемых поставщиком объектов ADSI.</span><span class="sxs-lookup"><span data-stu-id="02e19-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="02e19-137">Включает файлы справки и библиотеки типов, которые задокументированы свойства и методы интерфейса.</span><span class="sxs-lookup"><span data-stu-id="02e19-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="02e19-138">Как и в случае любой реализации COM, вызовы [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) должны возвращать **\_ интерфейс e** для нереализованных интерфейсов, **e \_ нотимпл** для нереализованных методов интерфейсов, которые в противном случае реализованы, и возвращать **E \_ ADS \_ свойство \_ не \_ поддерживается** для нереализованных свойств.</span><span class="sxs-lookup"><span data-stu-id="02e19-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="02e19-139">Дополнительные сведения о сдвоенных интерфейсах и их влиянии на реализацию свойства см. в разделе [сдвоенные интерфейсы](dual-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="02e19-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 