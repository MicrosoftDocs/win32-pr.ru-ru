---
title: Сведения о коде
description: В этом разделе приведен исходный код для реализации компонента поставщика в примере ADSI. Все ссылки на исходный код в этом документе могут быть изменены и доступны в каталоге примеров кода, который входит в состав пакета SDK для ADSI.
ms.assetid: 207912e5-ac17-48c7-9536-981a8e92e8cf
ms.tgt_platform: multiple
keywords:
- Сведения о коде ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1d959357f2cdd094b26cde4f649c3286389b8415
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070612"
---
# <a name="code-details"></a><span data-ttu-id="ffa91-105">Сведения о коде</span><span class="sxs-lookup"><span data-stu-id="ffa91-105">Code Details</span></span>

<span data-ttu-id="ffa91-106">В этом разделе приведен исходный код для реализации компонента поставщика в примере ADSI.</span><span class="sxs-lookup"><span data-stu-id="ffa91-106">This section lists the source code for the ADSI example provider component implementation.</span></span> <span data-ttu-id="ffa91-107">Все ссылки на исходный код в этом документе могут быть изменены и доступны в каталоге примеров кода, который входит в состав пакета SDK для ADSI.</span><span class="sxs-lookup"><span data-stu-id="ffa91-107">All source code references in this document are subject to change and are available in the example code directory included in the ADSI SDK.</span></span>

> [!Note]  
> <span data-ttu-id="ffa91-108">Методы [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) **жетекс** и **путекс** не реализованы в компоненте "пример поставщика ADSI".</span><span class="sxs-lookup"><span data-stu-id="ffa91-108">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) methods **GetEx** and **PutEx** are not implemented in the ADSI example provider component.</span></span> <span data-ttu-id="ffa91-109">Это значит, что код, реализующий Active Directory объекты, наследуемые от **iAds** , не имеет методов **жетекс** и **путекс** .</span><span class="sxs-lookup"><span data-stu-id="ffa91-109">That is, code that implements Active Directory objects that inherit from **IADs** do not have **GetEx** and **PutEx** methods.</span></span> <span data-ttu-id="ffa91-110">Сюда входит объект класса схемы, который поддерживает [**иадскласс**](/windows/desktop/api/Iads/nn-iads-iadsclass), объект Property, поддерживающий [**иадспроперти**](/windows/desktop/api/Iads/nn-iads-iadsproperty), универсальный объект Active Directory, поддерживающий **iAds**, и любой объект контейнера, поддерживающий [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer).</span><span class="sxs-lookup"><span data-stu-id="ffa91-110">This includes the schema class object that supports [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), the property object that supports [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), the generic Active Directory object that supports **IADs**, and any container object that supports [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer).</span></span> <span data-ttu-id="ffa91-111">Кроме того, в примере компонента поставщика отсутствует объект синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="ffa91-111">In addition, syntax objects are not present in the example provider component.</span></span> <span data-ttu-id="ffa91-112">Однако архитектура ADSI требует включения в объект контейнера схемы объектов синтаксиса, как и для классов схемы и объектов свойств.</span><span class="sxs-lookup"><span data-stu-id="ffa91-112">However, the ADSI architecture requires the syntax objects to be included in the schema container object, just as are the schema class and property objects.</span></span>

 

<span data-ttu-id="ffa91-113">В следующей таблице перечислены файлы исходного кода, которые включены в каталог примеров поставщика в пакете SDK для интерфейсов служб Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ffa91-113">The following table lists source code files that are included in the provider example directory in the Active Directory Service Interfaces SDK.</span></span>



| <span data-ttu-id="ffa91-114">Файл исходного кода</span><span class="sxs-lookup"><span data-stu-id="ffa91-114">Source code file</span></span>                 | <span data-ttu-id="ffa91-115">Описание</span><span class="sxs-lookup"><span data-stu-id="ffa91-115">Description</span></span>                                                                                                                                                       |
|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ffa91-116">кклсобж. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-116">cclsobj.cpp</span></span>](cclsobj-cpp.md)   | <span data-ttu-id="ffa91-117">Подпрограммы объекта класса схемы.</span><span class="sxs-lookup"><span data-stu-id="ffa91-117">Schema class object routines.</span></span>                                                                                                                                     |
| [<span data-ttu-id="ffa91-118">кдиспмгр. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-118">cdispmgr.cpp</span></span>](cdispmgr-cpp.md) | <span data-ttu-id="ffa91-119">Реализация диспетчера диспетчеризации.</span><span class="sxs-lookup"><span data-stu-id="ffa91-119">Dispatch Manager implementation.</span></span>                                                                                                                                  |
| [<span data-ttu-id="ffa91-120">ценумнс. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-120">cenumns.cpp</span></span>](cenumns-cpp.md)   | <span data-ttu-id="ffa91-121">Подпрограммы перечисления пространства имен.</span><span class="sxs-lookup"><span data-stu-id="ffa91-121">Namespace enumeration routines.</span></span>                                                                                                                                   |
| [<span data-ttu-id="ffa91-122">ценумсч. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-122">cenumsch.cpp</span></span>](cenumsch-cpp.md) | <span data-ttu-id="ffa91-123">Подпрограммы перечисления схем.</span><span class="sxs-lookup"><span data-stu-id="ffa91-123">Schema enumeration routines.</span></span>                                                                                                                                      |
| [<span data-ttu-id="ffa91-124">ценумобж. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-124">cenumobj.cpp</span></span>](cenumobj-cpp.md) | <span data-ttu-id="ffa91-125">Универсальные подпрограммы перечисления объектов.</span><span class="sxs-lookup"><span data-stu-id="ffa91-125">Generic object enumeration routines.</span></span>                                                                                                                              |
| [<span data-ttu-id="ffa91-126">ценумвар. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-126">cenumvar.cpp</span></span>](cenumvar-cpp.md) | <span data-ttu-id="ffa91-127">Базовая реализация для производных классов Ксксксенумвариант.</span><span class="sxs-lookup"><span data-stu-id="ffa91-127">Base implementation for xxxEnumVariant derived classes.</span></span>                                                                                                           |
| [<span data-ttu-id="ffa91-128">кженобж. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-128">cgenobj.cpp</span></span>](cgenobj-cpp.md)   | <span data-ttu-id="ffa91-129">Универсальные объектные подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="ffa91-129">Generic object routines.</span></span>                                                                                                                                          |
| [<span data-ttu-id="ffa91-130">кнамкф. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-130">cnamcf.cpp</span></span>](cnamcf-cpp.md)     | <span data-ttu-id="ffa91-131">Подпрограммы фабрики класса пространства имен.</span><span class="sxs-lookup"><span data-stu-id="ffa91-131">Namespace class factory routines.</span></span>                                                                                                                                 |
| [<span data-ttu-id="ffa91-132">кнамесп. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-132">cnamesp.cpp</span></span>](cnamesp-cpp.md)   | <span data-ttu-id="ffa91-133">Объектные подпрограммы пространства имен.</span><span class="sxs-lookup"><span data-stu-id="ffa91-133">Namespace object routines.</span></span>                                                                                                                                        |
| [<span data-ttu-id="ffa91-134">Common. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-134">common.cpp</span></span>](common-cpp.md)     | <span data-ttu-id="ffa91-135">Код, общий для всех объектов поставщика.</span><span class="sxs-lookup"><span data-stu-id="ffa91-135">Code common to all provider objects.</span></span>                                                                                                                              |
| [<span data-ttu-id="ffa91-136">Core. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-136">core.cpp</span></span>](core-cpp.md)         | <span data-ttu-id="ffa91-137">Реализации для свойств "Core", совместно используемых всеми объектами Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ffa91-137">Implementations for 'core' properties shared by all Active Directory objects.</span></span>                                                                                     |
| [<span data-ttu-id="ffa91-138">кпропс. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-138">cprops.cpp</span></span>](cprops-cpp.md)     | <span data-ttu-id="ffa91-139">Функции кэша свойств.</span><span class="sxs-lookup"><span data-stu-id="ffa91-139">Property cache features.</span></span>                                                                                                                                          |
| [<span data-ttu-id="ffa91-140">кпров. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-140">cprov.cpp</span></span>](cprov-cpp.md)       | <span data-ttu-id="ffa91-141">Объектные подпрограммы поставщика верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="ffa91-141">Top-level provider object routines.</span></span>                                                                                                                               |
| [<span data-ttu-id="ffa91-142">кпровкф. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-142">cprovcf.cpp</span></span>](cprovcf-cpp.md)   | <span data-ttu-id="ffa91-143">Подпрограммы фабрики класса объектов поставщика верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="ffa91-143">Top-level provider object class factory routines.</span></span>                                                                                                                 |
| [<span data-ttu-id="ffa91-144">кпрпобж. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-144">cprpobj.cpp</span></span>](cprpobj-cpp.md)   | <span data-ttu-id="ffa91-145">Подпрограммы объекта Property.</span><span class="sxs-lookup"><span data-stu-id="ffa91-145">Property object routines.</span></span>                                                                                                                                         |
| [<span data-ttu-id="ffa91-146">ксчобж. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-146">cschobj.cpp</span></span>](cschobj-cpp.md)   | <span data-ttu-id="ffa91-147">Подпрограммы объекта схемы.</span><span class="sxs-lookup"><span data-stu-id="ffa91-147">Schema object routines.</span></span>                                                                                                                                           |
| [<span data-ttu-id="ffa91-148">жетобж. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-148">getobj.cpp</span></span>](getobj-cpp.md)     | <span data-ttu-id="ffa91-149">Функция GetObject.</span><span class="sxs-lookup"><span data-stu-id="ffa91-149">GetObject feature.</span></span>                                                                                                                                                |
| [<span data-ttu-id="ffa91-150">Globals. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-150">globals.cpp</span></span>](globals-cpp.md)   | <span data-ttu-id="ffa91-151">Примеры поставщиков компонентов поставщика ADSI.</span><span class="sxs-lookup"><span data-stu-id="ffa91-151">ADSI example provider component globals.</span></span>                                                                                                                          |
| [<span data-ttu-id="ffa91-152">GUID. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-152">guid.cpp</span></span>](guid-cpp.md)         | <span data-ttu-id="ffa91-153">Примеры идентификаторов CLSID компонента поставщика и Либидс.</span><span class="sxs-lookup"><span data-stu-id="ffa91-153">Example provider component CLSIDs and LIBIDs.</span></span>                                                                                                                     |
| [<span data-ttu-id="ffa91-154">либмаин. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-154">libmain.cpp</span></span>](libmain-cpp.md)   | <span data-ttu-id="ffa91-155">Либмаин для adssmp.dll.</span><span class="sxs-lookup"><span data-stu-id="ffa91-155">Libmain for adssmp.dll.</span></span>                                                                                                                                           |
| [<span data-ttu-id="ffa91-156">Memory. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-156">memory.cpp</span></span>](memory-cpp.md)     | <span data-ttu-id="ffa91-157">Пример компонента поставщика. подпрограммы управления памятью.</span><span class="sxs-lookup"><span data-stu-id="ffa91-157">Example provider component memory management routines.</span></span>                                                                                                            |
| [<span data-ttu-id="ffa91-158">Pack. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-158">pack.cpp</span></span>](pack-cpp.md)         | <span data-ttu-id="ffa91-159">Пример пакета компонентов поставщика/распаковка данных в вариантах.</span><span class="sxs-lookup"><span data-stu-id="ffa91-159">Example provider component pack/unpack data in VARIANTs.</span></span>                                                                                                          |
| [<span data-ttu-id="ffa91-160">синтаксический анализ cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-160">parse.cpp</span></span>](parse-cpp.md)       | <span data-ttu-id="ffa91-161">Синтаксический анализ пути для примера пространства имен компонента поставщика.</span><span class="sxs-lookup"><span data-stu-id="ffa91-161">Path parsing for example provider component namespace.</span></span>                                                                                                            |
| [<span data-ttu-id="ffa91-162">свойство. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-162">property.cpp</span></span>](property-cpp.md) | <span data-ttu-id="ffa91-163">Получение и размещение свойств по имени.</span><span class="sxs-lookup"><span data-stu-id="ffa91-163">Get and Put properties by name.</span></span>                                                                                                                                   |
| [<span data-ttu-id="ffa91-164">Object. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-164">object.cpp</span></span>](object-cpp.md)     | <span data-ttu-id="ffa91-165">Пример типа объекта компонента поставщика список кода для фильтрации.</span><span class="sxs-lookup"><span data-stu-id="ffa91-165">Example provider component object type list code for filtering.</span></span>                                                                                                   |
| [<span data-ttu-id="ffa91-166">регдсапи. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-166">regdsapi.cpp</span></span>](regdsapi-cpp.md) | <span data-ttu-id="ffa91-167">Пример компонента поставщика API службы каталогов реестра.</span><span class="sxs-lookup"><span data-stu-id="ffa91-167">Example provider component registry directory service APIs.</span></span>                                                                                                       |
| <span data-ttu-id="ffa91-168">смпопер. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-168">smpoper.cpp</span></span>                      | <span data-ttu-id="ffa91-169">Подпрограммы преобразования данных.</span><span class="sxs-lookup"><span data-stu-id="ffa91-169">Data conversion routines.</span></span>                                                                                                                                         |
| [<span data-ttu-id="ffa91-170">стдфакт. cpp</span><span class="sxs-lookup"><span data-stu-id="ffa91-170">stdfact.cpp</span></span>](stdfact-cpp.md)   | <span data-ttu-id="ffa91-171">Стандартная реализация [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) .</span><span class="sxs-lookup"><span data-stu-id="ffa91-171">Standard [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) implementation.</span></span>                                                                                                  |
| <span data-ttu-id="ffa91-172">адссмп. INF</span><span class="sxs-lookup"><span data-stu-id="ffa91-172">adssmp.inf</span></span>                       | <span data-ttu-id="ffa91-173">Пример данных в реестре хранилища данных каталога.</span><span class="sxs-lookup"><span data-stu-id="ffa91-173">Example directory data store registry data.</span></span> <span data-ttu-id="ffa91-174">Дополнительные сведения см. [в разделе Установка компонента поставщика примера](installing-the-example-provider-component.md).</span><span class="sxs-lookup"><span data-stu-id="ffa91-174">For more information, see [Installing the Example Provider Component](installing-the-example-provider-component.md).</span></span> |



 

 

 