---
title: Модель схемы ADSI
description: Схема похожа на словарь в том, что она содержит определение каждого типа объекта, известного службе каталогов.
ms.assetid: 70561a11-1560-4b1c-a999-e2a7b2002ab0
ms.tgt_platform: multiple
keywords:
- ADSI модель схемы ADSI
- ADSI ADSI, о программе, схема
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 23eec9264ae2692952106802cc06cbad937a42a9
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103987878"
---
# <a name="adsi-schema-model"></a><span data-ttu-id="557f2-105">Модель схемы ADSI</span><span class="sxs-lookup"><span data-stu-id="557f2-105">ADSI Schema Model</span></span>

<span data-ttu-id="557f2-106">Схема похожа на словарь в том, что она содержит определение каждого типа объекта, известного службе каталогов.</span><span class="sxs-lookup"><span data-stu-id="557f2-106">A schema is similar to a dictionary in that it holds the definition of every type of object known to a directory service.</span></span> <span data-ttu-id="557f2-107">Клиентские приложения ADSI могут просматривать схему для обнаружения функций любой конкретной реализации ADSI.</span><span class="sxs-lookup"><span data-stu-id="557f2-107">ADSI client applications can browse through a schema to discover the features of any given ADSI implementation.</span></span> <span data-ttu-id="557f2-108">Кроме того, ADSI предоставляет интерфейсы управления схемой, которые можно использовать для взаимодействия с базовой схемой службы каталогов.</span><span class="sxs-lookup"><span data-stu-id="557f2-108">In addition, ADSI supplies schema management interfaces that can be used to communicate with a directory service's underlying schema.</span></span>

<span data-ttu-id="557f2-109">Некоторые схемы являются расширяемыми, поставщики ADSI или сторонние поставщики могут выбрать публикацию новых интерфейсов или дополнительных свойств для существующих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="557f2-109">Some schemas are extensible and ADSI providers or third-party suppliers may choose to publish new interfaces or additional properties for existing interfaces there.</span></span> <span data-ttu-id="557f2-110">Клиенты ADSI используют эти данные, чтобы определить, какие функции поддерживаются для каждой службы каталогов.</span><span class="sxs-lookup"><span data-stu-id="557f2-110">ADSI clients use this data to determine what features are supported for each directory service.</span></span>

<span data-ttu-id="557f2-111">Существует три вида объектов схемы: классы, свойства и синтаксис, каждый из которых поддерживает интерфейсы управления схемой [**иадскласс**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**иадспроперти**](/windows/desktop/api/Iads/nn-iads-iadsproperty)и [**иадссинтакс**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="557f2-111">There are three kinds of schema objects: classes, properties, and syntaxes, each respectively supporting the schema management interfaces [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span>

> [!Note]  
> <span data-ttu-id="557f2-112">Класс является перегруженным термином.</span><span class="sxs-lookup"><span data-stu-id="557f2-112">Class is an overloaded term.</span></span> <span data-ttu-id="557f2-113">Существуют классы C++, классы Java, классы COM и классы ADSI.</span><span class="sxs-lookup"><span data-stu-id="557f2-113">There are C++ classes, Java classes, COM classes, and ADSI classes.</span></span> <span data-ttu-id="557f2-114">В этом документе класс Word, если иное не является квалифицированным, ссылается на категорию или тип объекта схемы.</span><span class="sxs-lookup"><span data-stu-id="557f2-114">In this document, the word class, unless otherwise qualified, refers to a category or type of schema object.</span></span>

 

<span data-ttu-id="557f2-115">ADSI абстрагирует схему каждой службы каталогов и помещает ее в каждый корневой узел верхнего уровня в объекте **Namespace** .</span><span class="sxs-lookup"><span data-stu-id="557f2-115">ADSI abstracts the schema of every directory service and places it in every top-level root node in the **Namespace** object.</span></span> <span data-ttu-id="557f2-116">Чтобы определить, какие классы поддерживает служба каталогов на данном корневом узле, необходимо перечислить объект схемы и получить список объектов класса, объектов свойств и объектов синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="557f2-116">To identify what classes a directory service supports on a given root-node, you enumerate the schema object and get a list of class objects, property objects, and syntax objects.</span></span> <span data-ttu-id="557f2-117">Дополнительные сведения см. [в разделе Использование схемы ADSI](using-the-adsi-schema.md).</span><span class="sxs-lookup"><span data-stu-id="557f2-117">For more information, see [Using the ADSI Schema](using-the-adsi-schema.md).</span></span>

## <a name="adsi-ldap-provider-schema-cache"></a><span data-ttu-id="557f2-118">Кэш схемы поставщика LDAP ADSI</span><span class="sxs-lookup"><span data-stu-id="557f2-118">ADSI LDAP Provider Schema Cache</span></span>

<span data-ttu-id="557f2-119">Поставщик LDAP для ADSI пытается кэшировать данные схемы на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="557f2-119">The LDAP provider for ADSI attempts to cache schema data to the local computer.</span></span> <span data-ttu-id="557f2-120">Подсхема определяется различающимся именем, хранящимся в атрибуте [**субсчемасубентри**](/windows/desktop/ADSchema/a-subschemasubentry) , расположенном в корне службы каталогов Enterprise (RootDSE).</span><span class="sxs-lookup"><span data-stu-id="557f2-120">A subschema is identified by a distinguished name stored in the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute located in the root of the directory service enterprise (rootDSE).</span></span> <span data-ttu-id="557f2-121">Помимо предоставления данных о подсхеме серверы LDAP V3 должны предоставлять атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) , который используется для определения времени последнего изменения схемы.</span><span class="sxs-lookup"><span data-stu-id="557f2-121">In addition to providing the subschema data, LDAP v3 servers should expose a [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute that is used to determine the last time the schema was modified.</span></span>

<span data-ttu-id="557f2-122">Когда ADSI сначала выполняет привязку к серверу LDAP, он получает данные о подсхеме с помощью атрибута [**субсчемасубентри**](/windows/desktop/ADSchema/a-subschemasubentry) .</span><span class="sxs-lookup"><span data-stu-id="557f2-122">When ADSI first binds to the LDAP server, it retrieves the subschema data using the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute.</span></span> <span data-ttu-id="557f2-123">Если ADSI обнаруживает объект подсхемы, он сохраняет указатель на данные в реестре на компьютере, который подключается к LDAP-серверу.</span><span class="sxs-lookup"><span data-stu-id="557f2-123">If ADSI succeeds in finding the subschema object, it stores a pointer to the data in the registry on the computer that is connecting to the LDAP server.</span></span> <span data-ttu-id="557f2-124">Сведения о том, где хранятся эти значения в реестре, см. в разделе [ADSI и управление учетными записями пользователей](adsi-and-uac.md).</span><span class="sxs-lookup"><span data-stu-id="557f2-124">For information on exactly where these values are stored in the registry, see [ADSI and User Account Control](adsi-and-uac.md).</span></span>

<span data-ttu-id="557f2-125">Затем ADSI пытается обработать данные схемы и считывает атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="557f2-125">ADSI then attempts to process the schema data and reads the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="557f2-126">Если атрибут **модифитиместамп** существует и интерфейсы ADSI успешно обработают схему, ADSI записывает эту подсхему на диск и создает два следующих значения реестра в разделе раздела.</span><span class="sxs-lookup"><span data-stu-id="557f2-126">If the **modifyTimeStamp** attribute exists and ADSI successfully processes the schema, ADSI writes the subschema to disk and creates the two following registry values under the key.</span></span> <span data-ttu-id="557f2-127">Если данные подсхемы существуют, но не могут быть обработаны, ни один из этих значений реестра не будет создан:</span><span class="sxs-lookup"><span data-stu-id="557f2-127">If the subschema data exists, but cannot be processed, neither of these registry values is created:</span></span>

-   <span data-ttu-id="557f2-128">Значение **времени** , которое содержит атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="557f2-128">A **Time** value, which contains the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="557f2-129">Это значение используется для обеспечения актуальности данных схемы и предотвращения перезагрузки данных схемы.</span><span class="sxs-lookup"><span data-stu-id="557f2-129">This value is used to ensure that the schema data is current and prevents the constant reloading of the schema data.</span></span>
-   <span data-ttu-id="557f2-130">Значение **файла** , содержащее путь, по которому ADSI хранит данные схемы в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="557f2-130">A **File** value, which contains the path to where ADSI stores the schema data in the file system.</span></span> <span data-ttu-id="557f2-131">По умолчанию ADSI кэширует подсхему в <systemroot> \\ каталоге счкаче с именем файла, СООТВЕТСТВУЮЩИМ имени LDAP-сервера.</span><span class="sxs-lookup"><span data-stu-id="557f2-131">By default, ADSI caches the subschema in the <systemroot>\\SchCache directory with a file name corresponding to the name of the LDAP server.</span></span>

<span data-ttu-id="557f2-132">Если данные подсхемы могут быть обработаны, но атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) не предоставляется, данные схемы кэшируются в памяти, но не записываются на диск.</span><span class="sxs-lookup"><span data-stu-id="557f2-132">If the subschema data can be processed, but no [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute is exposed, the schema data is cached in memory, but not written to disk.</span></span> <span data-ttu-id="557f2-133">Если сервер LDAP V3 подключен через ADSI на локальном компьютере, а кэшированная подсхема отсутствует, скорее всего, это может быть вызвано одной из следующих причин:</span><span class="sxs-lookup"><span data-stu-id="557f2-133">If an LDAP v3 server has been contacted through ADSI on the local computer and a cached subschema is not present, it is most likely for one of the following reasons:</span></span>

-   <span data-ttu-id="557f2-134">Сервер не предоставил правильные свойства.</span><span class="sxs-lookup"><span data-stu-id="557f2-134">The server did not expose the correct properties.</span></span>
-   <span data-ttu-id="557f2-135">Интерфейсу ADSI не удалось обработать схему.</span><span class="sxs-lookup"><span data-stu-id="557f2-135">ADSI was unable to process the schema.</span></span>
-   <span data-ttu-id="557f2-136">Интерфейсу ADSI не удалось записать файл в файловую систему.</span><span class="sxs-lookup"><span data-stu-id="557f2-136">ADSI was unable to write the file to the file system.</span></span>

 

 