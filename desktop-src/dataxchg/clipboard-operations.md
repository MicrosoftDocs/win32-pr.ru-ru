---
title: Операции с буфером обмена
description: Окно должно использовать буфер обмена при вырезании, копировании или вставлении данных. Окно помещает данные в буфер обмена для операций вырезания и копирования и извлекает данные из буфера обмена для операций вставки.
ms.assetid: 27f9142c-3154-4de5-aea6-3c53f7e940ec
keywords:
- Пользовательский интерфейс Windows, буфер обмена
- буфер обмена, Windows
- буфер обмена, вырезание данных
- буфер обмена, копирование данных
- буфер обмена, вставленные данные
- буфер обмена, окно "владелец"
- буфер обмена, отложенная визуализация
- буфер обмена, память
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5cb2c3451cf562b35b976e137a974e19892acbb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338913"
---
# <a name="clipboard-operations"></a><span data-ttu-id="ee35b-112">Операции с буфером обмена</span><span class="sxs-lookup"><span data-stu-id="ee35b-112">Clipboard Operations</span></span>

<span data-ttu-id="ee35b-113">Окно должно использовать буфер обмена при вырезании, копировании или вставлении данных.</span><span class="sxs-lookup"><span data-stu-id="ee35b-113">A window should use the clipboard when cutting, copying, or pasting data.</span></span> <span data-ttu-id="ee35b-114">Окно помещает данные в буфер обмена для операций вырезания и копирования и извлекает данные из буфера обмена для операций вставки.</span><span class="sxs-lookup"><span data-stu-id="ee35b-114">A window places data on the clipboard for cut and copy operations and retrieves data from the clipboard for paste operations.</span></span> <span data-ttu-id="ee35b-115">В следующих разделах описываются эти операции и связанные с ними проблемы.</span><span class="sxs-lookup"><span data-stu-id="ee35b-115">The following sections describe these operations and related issues.</span></span>

<span data-ttu-id="ee35b-116">Чтобы поместить данные в буфер обмена или получить данные из него, окно должно сначала открыть буфер обмена с помощью функции [**опенклипбоард**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-116">To place data on or retrieve data from the clipboard, a window must first open the clipboard by using the [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) function.</span></span> <span data-ttu-id="ee35b-117">Только в одном окне может быть открыт буфер обмена за раз.</span><span class="sxs-lookup"><span data-stu-id="ee35b-117">Only one window can have the clipboard open at a time.</span></span> <span data-ttu-id="ee35b-118">Чтобы узнать, в каком окне открыт буфер обмена, вызовите функцию [**жетопенклипбоардвиндов**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-118">To find out which window has the clipboard open, call the [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) function.</span></span> <span data-ttu-id="ee35b-119">По завершении окно должно закрыть буфер обмена, вызвав функцию [**клосеклипбоард**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-119">When it has finished, the window must close the clipboard by calling the [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) function.</span></span>

<span data-ttu-id="ee35b-120">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="ee35b-120">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="ee35b-121">Операции вырезания и копирования</span><span class="sxs-lookup"><span data-stu-id="ee35b-121">Cut and Copy Operations</span></span>](#cut-and-copy-operations)
-   [<span data-ttu-id="ee35b-122">Операции вставки</span><span class="sxs-lookup"><span data-stu-id="ee35b-122">Paste Operations</span></span>](#paste-operations)
-   [<span data-ttu-id="ee35b-123">Владение буфером обмена</span><span class="sxs-lookup"><span data-stu-id="ee35b-123">Clipboard Ownership</span></span>](#clipboard-ownership)
-   [<span data-ttu-id="ee35b-124">Отложенная визуализация</span><span class="sxs-lookup"><span data-stu-id="ee35b-124">Delayed Rendering</span></span>](#delayed-rendering)
-   [<span data-ttu-id="ee35b-125">Память и буфер обмена</span><span class="sxs-lookup"><span data-stu-id="ee35b-125">Memory and the Clipboard</span></span>](#memory-and-the-clipboard)

## <a name="cut-and-copy-operations"></a><span data-ttu-id="ee35b-126">Операции вырезания и копирования</span><span class="sxs-lookup"><span data-stu-id="ee35b-126">Cut and Copy Operations</span></span>

<span data-ttu-id="ee35b-127">Чтобы поместить сведения в буфер обмена, окно сначала очищает содержимое буфера обмена с помощью функции [**емптиклипбоард**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-127">To place information on the clipboard, a window first clears any previous clipboard content by using the [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="ee35b-128">Эта функция отправляет сообщение [**WM \_ дестройклипбоард**](wm-destroyclipboard.md) предыдущему владельцу буфера обмена, освобождает ресурсы, связанные с данными в буфере обмена, и назначает владение буферу обмена для окна, в котором открыт буфер обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-128">This function sends the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message to the previous clipboard owner, frees resources associated with data on the clipboard, and assigns clipboard ownership to the window that has the clipboard open.</span></span> <span data-ttu-id="ee35b-129">Чтобы узнать, какое окно владеет буфером обмена, вызовите функцию [**жетклипбоардовнер**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-129">To find out which window owns the clipboard, call the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function.</span></span>

<span data-ttu-id="ee35b-130">После очистки буфера обмена окно помещает данные в буфер обмена в максимальном количестве форматов буфера обмена, упорядоченном от наиболее описательного формата буфера обмена к крайней описательной.</span><span class="sxs-lookup"><span data-stu-id="ee35b-130">After emptying the clipboard, the window places data on the clipboard in as many clipboard formats as possible, ordered from the most descriptive clipboard format to the least descriptive.</span></span> <span data-ttu-id="ee35b-131">Для каждого формата окно вызывает функцию [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) , указывая идентификатор формата и глобальный маркер памяти.</span><span class="sxs-lookup"><span data-stu-id="ee35b-131">For each format, the window calls the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function, specifying the format identifier and a global memory handle.</span></span> <span data-ttu-id="ee35b-132">Маркер памяти может иметь значение NULL, что означает, что окно визуализирует данные по запросу.</span><span class="sxs-lookup"><span data-stu-id="ee35b-132">The memory handle can be NULL, indicating that the window renders the data on request.</span></span> <span data-ttu-id="ee35b-133">Дополнительные сведения см. в разделе [отложенная визуализация](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="ee35b-133">For more information, see [Delayed Rendering](#delayed-rendering).</span></span>

## <a name="paste-operations"></a><span data-ttu-id="ee35b-134">Операции вставки</span><span class="sxs-lookup"><span data-stu-id="ee35b-134">Paste Operations</span></span>

<span data-ttu-id="ee35b-135">Чтобы получить сведения о вставке из буфера обмена, окно сначала определяет формат буфера обмена для извлечения.</span><span class="sxs-lookup"><span data-stu-id="ee35b-135">To retrieve paste information from the clipboard, a window first determines the clipboard format to retrieve.</span></span> <span data-ttu-id="ee35b-136">Как правило, окно перечисляет доступные форматы буфера обмена с помощью функции [**енумклипбоардформатс**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) и использует первый распознаваемый формат.</span><span class="sxs-lookup"><span data-stu-id="ee35b-136">Typically, a window enumerates the available clipboard formats by using the [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) function and uses the first format it recognizes.</span></span> <span data-ttu-id="ee35b-137">Этот метод выбирает наилучший доступный формат в соответствии с приоритетом, установленным при помещении данных в буфер обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-137">This method selects the best available format according to the priority set when the data was placed on the clipboard.</span></span>

<span data-ttu-id="ee35b-138">Кроме того, окно может использовать функцию [**жетприоритиклипбоардформат**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-138">Alternatively, a window can use the [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) function.</span></span> <span data-ttu-id="ee35b-139">Эта функция определяет наилучший доступный формат буфера обмена в соответствии с заданным приоритетом.</span><span class="sxs-lookup"><span data-stu-id="ee35b-139">This function identifies the best available clipboard format according to a specified priority.</span></span> <span data-ttu-id="ee35b-140">Окно, которое распознает только один формат буфера обмена, может просто определить, доступен ли этот формат с помощью функции [**исклипбоардформатаваилабле**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-140">A window that recognizes only one clipboard format can simply determine whether that format is available by using the [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) function.</span></span>

<span data-ttu-id="ee35b-141">Определив используемый формат буфера обмена, окно вызывает функцию [**жетклипбоарддата**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-141">After determining the clipboard format to use, a window calls the [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) function.</span></span> <span data-ttu-id="ee35b-142">Эта функция возвращает маркер в глобальный объект памяти, содержащий данные в указанном формате.</span><span class="sxs-lookup"><span data-stu-id="ee35b-142">This function returns the handle to a global memory object containing data in the specified format.</span></span> <span data-ttu-id="ee35b-143">Окно может временно заблокировать объект памяти, чтобы проверить или скопировать данные.</span><span class="sxs-lookup"><span data-stu-id="ee35b-143">A window can briefly lock the memory object in order to examine or copy the data.</span></span> <span data-ttu-id="ee35b-144">Однако окно не должно освобождать объект или оставаться заблокированным в течение длительного периода времени.</span><span class="sxs-lookup"><span data-stu-id="ee35b-144">However, a window should not free the object or leave it locked for a long period of time.</span></span>

## <a name="clipboard-ownership"></a><span data-ttu-id="ee35b-145">Владение буфером обмена</span><span class="sxs-lookup"><span data-stu-id="ee35b-145">Clipboard Ownership</span></span>

<span data-ttu-id="ee35b-146">*Владелец буфера обмена* — это окно, связанное с информацией в буфере обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-146">The *clipboard owner* is the window associated with the information on the clipboard.</span></span> <span data-ttu-id="ee35b-147">Окно превращается в владельца буфера обмена при размещении данных в буфере обмена, в частности, при вызове функции [**емптиклипбоард**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-147">A window becomes the clipboard owner when it places data on the clipboard, specifically, when it calls the [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="ee35b-148">Окно остается владельцем буфера обмена до тех пор, пока оно не будет закрыто, или другое окно не будет очищать буфер обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-148">The window remains the clipboard owner until it is closed or another window empties the clipboard.</span></span>

<span data-ttu-id="ee35b-149">Когда буфер обмена очищается, владелец буфера получает сообщение [**WM \_ дестройклипбоард**](wm-destroyclipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-149">When the clipboard is emptied, the clipboard owner receives a [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="ee35b-150">Ниже приведены некоторые причины, по которым окно может обработать это сообщение:</span><span class="sxs-lookup"><span data-stu-id="ee35b-150">Following are some reasons why a window might process this message:</span></span>

-   <span data-ttu-id="ee35b-151">Окно отложенной отрисовки одного или нескольких форматов буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-151">The window delayed rendering of one or more clipboard formats.</span></span> <span data-ttu-id="ee35b-152">В ответ на сообщение [**\_ дестройклипбоард WM**](wm-destroyclipboard.md) окно может освободить ресурсы, выделенные для отображения данных по запросу.</span><span class="sxs-lookup"><span data-stu-id="ee35b-152">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had allocated in order to render data on request.</span></span> <span data-ttu-id="ee35b-153">Дополнительные сведения о подготовке данных к просмотру см. в разделе [отложенная визуализация](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="ee35b-153">For more information about the rendering of data, see [Delayed Rendering](#delayed-rendering).</span></span>
-   <span data-ttu-id="ee35b-154">Окно поместило данные в буфер обмена в частном формате буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-154">The window placed data on the clipboard in a private clipboard format.</span></span> <span data-ttu-id="ee35b-155">Данные для закрытых форматов буфера обмена не освобождаются системой при очистке буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-155">The data for private clipboard formats is not freed by the system when the clipboard is emptied.</span></span> <span data-ttu-id="ee35b-156">Поэтому владелец буфера обмена должен освобождать данные при получении сообщения [**WM \_ дестройклипбоард**](wm-destroyclipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-156">Therefore, the clipboard owner should free the data upon receiving the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="ee35b-157">Дополнительные сведения о форматах частных буферов обмена см. в разделе [форматы буфера обмена](clipboard-formats.md).</span><span class="sxs-lookup"><span data-stu-id="ee35b-157">For more information about private clipboard formats, see [Clipboard Formats](clipboard-formats.md).</span></span>
-   <span data-ttu-id="ee35b-158">Окно поместило данные в буфер обмена, используя формат буфера обмена **CF \_ овнердисплай** .</span><span class="sxs-lookup"><span data-stu-id="ee35b-158">The window placed data on the clipboard using the **CF\_OWNERDISPLAY** clipboard format.</span></span> <span data-ttu-id="ee35b-159">В ответ на сообщение [**\_ дестройклипбоард WM**](wm-destroyclipboard.md) окно может освободить ресурсы, которые использовались для вывода сведений в окне средства просмотра буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-159">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had used to display information in the clipboard viewer window.</span></span> <span data-ttu-id="ee35b-160">Дополнительные сведения об этом альтернативном формате см. в разделе [Формат отображаемого владельца](about-the-clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="ee35b-160">For more information about this alternative format, see [Owner Display Format](about-the-clipboard.md).</span></span>

## <a name="delayed-rendering"></a><span data-ttu-id="ee35b-161">Отложенная визуализация</span><span class="sxs-lookup"><span data-stu-id="ee35b-161">Delayed Rendering</span></span>

<span data-ttu-id="ee35b-162">При помещении формата буфера обмена в буфер обмена окно может отложить отображение данных в этом формате до тех пор, пока не будут нужны данные.</span><span class="sxs-lookup"><span data-stu-id="ee35b-162">When placing a clipboard format on the clipboard, a window can delay rendering the data in that format until the data is needed.</span></span> <span data-ttu-id="ee35b-163">Для этого в приложении можно указать **значение NULL** для параметра *хдата* функции [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-163">To do so, an application can specify **NULL** for the *hData* parameter of the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function.</span></span> <span data-ttu-id="ee35b-164">Это полезно, если приложение поддерживает несколько форматов буфера обмена, некоторые или все из которых занимают много времени для отрисовки.</span><span class="sxs-lookup"><span data-stu-id="ee35b-164">This is useful if the application supports several clipboard formats, some or all of which are time-consuming to render.</span></span> <span data-ttu-id="ee35b-165">При передаче маркера **null** окно отображает сложные форматы буфера обмена только в том случае, если они необходимы.</span><span class="sxs-lookup"><span data-stu-id="ee35b-165">By passing a **NULL** handle, a window renders complex clipboard formats only when and if they are needed.</span></span>

<span data-ttu-id="ee35b-166">Если окно задерживает формат буфера обмена, оно должно быть подготовлено для подготовки к просмотру формата по запросу, если он является владельцем буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-166">If a window delays rendering a clipboard format, it must be prepared to render the format upon request for as long as it is the clipboard owner.</span></span> <span data-ttu-id="ee35b-167">Система отправляет владельцу буфера обмена сообщение [**WM \_ RENDERFORMAT**](wm-renderformat.md) при получении запроса для определенного формата, который не был подготовлен к просмотру.</span><span class="sxs-lookup"><span data-stu-id="ee35b-167">The system sends the clipboard owner a [**WM\_RENDERFORMAT**](wm-renderformat.md) message when a request is received for a specific format that has not been rendered.</span></span> <span data-ttu-id="ee35b-168">После получения этого сообщения окно должно вызвать функцию [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) , чтобы поместить глобальный маркер памяти в буфер обмена в запрошенном формате.</span><span class="sxs-lookup"><span data-stu-id="ee35b-168">Upon receiving this message, the window should call the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function to place a global memory handle on the clipboard in the requested format.</span></span>

<span data-ttu-id="ee35b-169">Приложение не должно открывать буфер обмена перед вызовом [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) в ответ на сообщение [**\_ RENDERFORMAT WM**](wm-renderformat.md) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-169">An application must not open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) in response to the [**WM\_RENDERFORMAT**](wm-renderformat.md) message.</span></span> <span data-ttu-id="ee35b-170">Открытие буфера обмена не является обязательным, и любая попытка сделать это приведет к сбою, так как буфер обмена открывается приложением, запрашивающим формат для подготовки к просмотру.</span><span class="sxs-lookup"><span data-stu-id="ee35b-170">Opening the clipboard is not necessary, and any attempt to do so will fail because the clipboard is currently being held open by the application that requested the format to be rendered.</span></span>

<span data-ttu-id="ee35b-171">Если владелец буфера обмена собирается уничтожить и откладывает визуализацию некоторых или всех форматов буфера обмена, он получает сообщение [**WM \_ рендераллформатс**](wm-renderallformats.md) .</span><span class="sxs-lookup"><span data-stu-id="ee35b-171">If the clipboard owner is about to be destroyed and has delayed rendering some or all clipboard formats, it receives the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message.</span></span> <span data-ttu-id="ee35b-172">После получения этого сообщения окно должно открыть буфер обмена, убедиться, что он по-прежнему является владельцем буфера обмена с функцией [**жетклипбоардовнер**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) , а затем поместить в буфер обмена допустимые дескрипторы памяти для всех форматов буфера обмена, которые он предоставляет.</span><span class="sxs-lookup"><span data-stu-id="ee35b-172">Upon receiving this message, the window should open the clipboard, check that it is still the clipboard owner with the the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function, and then place valid memory handles on the clipboard for all clipboard formats that it provides.</span></span> <span data-ttu-id="ee35b-173">Это гарантирует, что эти форматы останутся доступными после уничтожения владельца буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-173">This ensures that these formats remain available after the clipboard owner is destroyed.</span></span>

<span data-ttu-id="ee35b-174">В отличие от [**WM \_ RENDERFORMAT**](wm-renderformat.md), приложение, отвечающее [**на \_ рендераллформатс WM**](wm-renderallformats.md) , должно открыть буфер обмена перед вызовом [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) для размещения любых глобальных дескрипторов памяти в буфере обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-174">Unlike with [**WM\_RENDERFORMAT**](wm-renderformat.md), an application responding to [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) should open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) to place any global memory handles on the clipboard.</span></span>

<span data-ttu-id="ee35b-175">Все форматы буфера обмена, не отображаемые в ответ на [**сообщение \_ рендераллформатс WM**](wm-renderallformats.md) , становятся доступны другим приложениям и больше не перечисляются функциями буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="ee35b-175">Any clipboard formats that are not rendered in response to the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message cease to be available to other applications and are no longer enumerated by the clipboard functions.</span></span>

## <a name="memory-and-the-clipboard"></a><span data-ttu-id="ee35b-176">Память и буфер обмена</span><span class="sxs-lookup"><span data-stu-id="ee35b-176">Memory and the Clipboard</span></span>

<span data-ttu-id="ee35b-177">Объект памяти, помещаемый в буфер обмена, должен быть выделен с помощью функции [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) с флагом **\_ перемещаемой ГМЕМ** .</span><span class="sxs-lookup"><span data-stu-id="ee35b-177">A memory object that is to be placed on the clipboard should be allocated by using the [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) function with the **GMEM\_MOVEABLE** flag.</span></span>

<span data-ttu-id="ee35b-178">После помещения объекта памяти в буфер обмена владение этим маркером памяти передается в систему.</span><span class="sxs-lookup"><span data-stu-id="ee35b-178">After a memory object is placed on the clipboard, ownership of that memory handle is transferred to the system.</span></span> <span data-ttu-id="ee35b-179">Когда буфер обмена очищается и объект памяти имеет один из следующих форматов буфера обмена, система освобождает объект памяти, вызывая указанную функцию:</span><span class="sxs-lookup"><span data-stu-id="ee35b-179">When the clipboard is emptied and the memory object has one of the following clipboard formats, the system frees the memory object by calling the specified function:</span></span>



| <span data-ttu-id="ee35b-180">Функция для освобождения объекта</span><span class="sxs-lookup"><span data-stu-id="ee35b-180">Function to free object</span></span>                             | <span data-ttu-id="ee35b-181">Формат буфера обмена</span><span class="sxs-lookup"><span data-stu-id="ee35b-181">Clipboard format</span></span>                                                                                                                                               |
|-----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ee35b-182">**делетеметафиле**</span><span class="sxs-lookup"><span data-stu-id="ee35b-182">**DeleteMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile)<br/> | <span data-ttu-id="ee35b-183">**\_ДСПЕНХМЕТАФИЛЕ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-183">**CF\_DSPENHMETAFILE**</span></span><br/> <span data-ttu-id="ee35b-184">**\_ДСПМЕТАФИЛЕПИКТ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-184">**CF\_DSPMETAFILEPICT**</span></span><br/> <span data-ttu-id="ee35b-185">**\_ЕНХМЕТАФИЛЕ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-185">**CF\_ENHMETAFILE**</span></span><br/> <span data-ttu-id="ee35b-186">**\_МЕТАФИЛЕПИКТ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-186">**CF\_METAFILEPICT**</span></span><br/>                            |
| [<span data-ttu-id="ee35b-187">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="ee35b-187">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)<br/>     | <span data-ttu-id="ee35b-188">**\_точечный рисунок CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-188">**CF\_BITMAP**</span></span><br/> <span data-ttu-id="ee35b-189">**\_ДСПБИТМАП CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-189">**CF\_DSPBITMAP**</span></span><br/> <span data-ttu-id="ee35b-190">**\_Палитра CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-190">**CF\_PALETTE**</span></span><br/>                                                                              |
| [<span data-ttu-id="ee35b-191">**GlobalFree**</span><span class="sxs-lookup"><span data-stu-id="ee35b-191">**GlobalFree**</span></span>](/windows/desktop/api/winbase/nf-winbase-globalfree)<br/>        | <span data-ttu-id="ee35b-192">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="ee35b-192">**CF\_DIB**</span></span><br/> <span data-ttu-id="ee35b-193">**\_DIBV5 CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-193">**CF\_DIBV5**</span></span><br/> <span data-ttu-id="ee35b-194">**\_ДСПТЕКСТ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-194">**CF\_DSPTEXT**</span></span><br/> <span data-ttu-id="ee35b-195">**\_ОЕМТЕКСТ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-195">**CF\_OEMTEXT**</span></span><br/> <span data-ttu-id="ee35b-196">**\_текст CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-196">**CF\_TEXT**</span></span><br/> <span data-ttu-id="ee35b-197">**\_УНИКОДЕТЕКСТ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-197">**CF\_UNICODETEXT**</span></span><br/>   |
| <span data-ttu-id="ee35b-198">нет</span><span class="sxs-lookup"><span data-stu-id="ee35b-198">none</span></span><br/>                                     | <span data-ttu-id="ee35b-199">**\_ОВНЕРДИСПЛАЙ CF**</span><span class="sxs-lookup"><span data-stu-id="ee35b-199">**CF\_OWNERDISPLAY**</span></span><br/> <span data-ttu-id="ee35b-200">Когда буфер обмена очищается от объекта **CF \_ овнердисплай** , само приложение должно освободить объект памяти.</span><span class="sxs-lookup"><span data-stu-id="ee35b-200">When the clipboard is emptied of a **CF\_OWNERDISPLAY** object, the application itself must free the memory object.</span></span><br/> |



 

 

