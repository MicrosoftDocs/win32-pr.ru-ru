---
title: Сведения о платформа динамических данных Exchange
description: В этом разделе обсуждается передача данных между приложениями.
ms.assetid: 0bcd8de4-a6f0-4f2a-8b9d-0b1b638925fb
keywords:
- Платформа динамических данных Exchange (DDE), сведения
- DDE (платформа динамических данных Exchange), сведения
- Обмен данными, платформа динамических данных Exchange (DDE)
- Платформа динамических данных Exchange (DDE), связывание с данными в режиме реального времени
- DDE (платформа динамических данных Exchange), связывание с данными в режиме реального времени
- Платформа динамических данных Exchange (DDE), создание составных документов
- DDE (платформа динамических данных Exchange), создание составных документов
- Платформа динамических данных Exchange (DDE), запросы данных
- DDE (платформа динамических данных Exchange), запросы данных
- Платформа динамических данных Exchange (DDE), примеры
- DDE (платформа динамических данных Exchange), примеры
- Платформа динамических данных Exchange (DDE), олицетворение
- DDE (платформа динамических данных Exchange), олицетворение
- Платформа динамических данных Exchange (DDE), сообщения
- DDE (платформа динамических данных Exchange), сообщения
- Платформа динамических данных Exchange (DDE), атомы
- DDE (платформа динамических данных Exchange), атомы
- Платформа динамических данных Exchange (DDE), объекты общей памяти
- DDE (платформа динамических данных Exchange), объекты общей памяти
- Платформа динамических данных Exchange (DDE), функции упаковки параметров
- DDE (платформа динамических данных Exchange), функции упаковки параметров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d38574e9182255e8f6761520aea60575d8affbc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413461"
---
# <a name="about-dynamic-data-exchange"></a><span data-ttu-id="a9db7-124">Сведения о платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-124">About Dynamic Data Exchange</span></span>

<span data-ttu-id="a9db7-125">Windows предоставляет несколько способов передачи данных между приложениями.</span><span class="sxs-lookup"><span data-stu-id="a9db7-125">Windows provides several methods for transferring data between applications.</span></span> <span data-ttu-id="a9db7-126">Одним из способов является использование протокола платформа динамических данных Exchange (DDE).</span><span class="sxs-lookup"><span data-stu-id="a9db7-126">One method is to use the Dynamic Data Exchange (DDE) protocol.</span></span> <span data-ttu-id="a9db7-127">Протокол DDE — это набор сообщений и руководств.</span><span class="sxs-lookup"><span data-stu-id="a9db7-127">The DDE protocol is a set of messages and guidelines.</span></span> <span data-ttu-id="a9db7-128">Он отправляет сообщения между приложениями, которые совместно используют данные, и использует общую память для обмена данными между приложениями.</span><span class="sxs-lookup"><span data-stu-id="a9db7-128">It sends messages between applications that share data and uses shared memory to exchange data between applications.</span></span> <span data-ttu-id="a9db7-129">Приложения могут использовать протокол DDE для одноразовой передачи данных и для непрерывного обмена, при котором приложения отправляют обновления друг другу по мере того, как новые данные становятся доступными.</span><span class="sxs-lookup"><span data-stu-id="a9db7-129">Applications can use the DDE protocol for one-time data transfers and for continuous exchanges in which applications send updates to one another as new data becomes available.</span></span>

<span data-ttu-id="a9db7-130">Windows также поддерживает библиотеку управления платформа динамических данных Exchange (ДДЕМЛ).</span><span class="sxs-lookup"><span data-stu-id="a9db7-130">Windows also supports the Dynamic Data Exchange Management Library (DDEML).</span></span> <span data-ttu-id="a9db7-131">ДДЕМЛ — это библиотека динамической компоновки (DLL), которую приложения могут использовать для совместного использования данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-131">The DDEML is a dynamic-link library (DLL) that applications can use to share data.</span></span> <span data-ttu-id="a9db7-132">ДДЕМЛ предоставляет функции и сообщения, упрощающие задачу добавления возможностей DDE в приложение.</span><span class="sxs-lookup"><span data-stu-id="a9db7-132">The DDEML provides functions and messages that simplify the task of adding DDE capability to an application.</span></span> <span data-ttu-id="a9db7-133">Вместо отправки, публикации и обработки сообщений DDE напрямую приложение использует функции ДДЕМЛ для управления сеансами DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-133">Instead of sending, posting, and processing DDE messages directly, an application uses the DDEML functions to manage DDE conversations.</span></span> <span data-ttu-id="a9db7-134">(Сеанс DDE — это взаимодействие между клиентскими и серверными приложениями.)</span><span class="sxs-lookup"><span data-stu-id="a9db7-134">(A DDE conversation is the interaction between client and server applications.)</span></span>

<span data-ttu-id="a9db7-135">ДДЕМЛ также предоставляет средство для управления строками и данными, которые совместно используют приложения DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-135">The DDEML also provides a facility for managing the strings and data that DDE applications share.</span></span> <span data-ttu-id="a9db7-136">Вместо использования атомов и указателей на объекты общей памяти приложения DDE создают и обмениваются дескрипторами строк, которые обозначают строки и дескрипторы данных, определяющие объекты памяти.</span><span class="sxs-lookup"><span data-stu-id="a9db7-136">Instead of using atoms and pointers to shared memory objects, DDE applications create and exchange string handles, which identify strings, and data handles, which identify memory objects.</span></span> <span data-ttu-id="a9db7-137">ДДЕМЛ также позволяет серверному приложению регистрировать имена служб, которые она поддерживает.</span><span class="sxs-lookup"><span data-stu-id="a9db7-137">The DDEML also makes it possible for a server application to register the service names it supports.</span></span> <span data-ttu-id="a9db7-138">Имена передаются в другие приложения в системе, которые могут использовать имена для подключения к серверу.</span><span class="sxs-lookup"><span data-stu-id="a9db7-138">The names are broadcast to other applications in the system, which can use the names to connect to the server.</span></span> <span data-ttu-id="a9db7-139">Более того, ДДЕМЛ обеспечивает совместимость приложений DDE, представляя их единообразно реализовать протокол DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-139">Moreover, the DDEML ensures compatibility among DDE applications by forcing them to implement the DDE protocol in a consistent manner.</span></span>

<span data-ttu-id="a9db7-140">Существующие приложения, использующие протокол DDE на основе сообщений, полностью совместимы с теми, которые используют ДДЕМЛ.</span><span class="sxs-lookup"><span data-stu-id="a9db7-140">Existing applications that use the message-based DDE protocol are fully compatible with those that use the DDEML.</span></span> <span data-ttu-id="a9db7-141">Это значит, что приложение, использующее DDE на основе сообщений, может устанавливать диалоги и выполнять транзакции с приложениями, использующими ДДЕМЛ.</span><span class="sxs-lookup"><span data-stu-id="a9db7-141">That is, an application that uses message-based DDE can establish conversations and perform transactions with applications that use the DDEML.</span></span> <span data-ttu-id="a9db7-142">Из-за множества преимуществ ДДЕМЛ новые приложения должны использовать его, а не сообщения DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-142">Because of the many advantages of the DDEML, new applications should use it rather than the DDE messages.</span></span> <span data-ttu-id="a9db7-143">Чтобы использовать элементы API ДДЕМЛ, необходимо включить в исходные файлы файл заголовка ДДЕМЛ, связать с библиотекой ДДЕМЛ и убедиться, что библиотека динамической компоновки ДДЕМЛ находится в системном пути поиска.</span><span class="sxs-lookup"><span data-stu-id="a9db7-143">To use the API elements of the DDEML, you must include the DDEML header file in your source files, link with the DDEML library, and ensure that the DDEML dynamic-link library is in the system's search path.</span></span>

<span data-ttu-id="a9db7-144">В этом разделе рассматриваются следующие темы.</span><span class="sxs-lookup"><span data-stu-id="a9db7-144">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="a9db7-145">Протокол платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-145">Dynamic Data Exchange Protocol</span></span>](#dynamic-data-exchange-protocol)
-   [<span data-ttu-id="a9db7-146">Использование для Windows платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-146">Uses for Windows Dynamic Data Exchange</span></span>](#uses-for-windows-dynamic-data-exchange)
-   [<span data-ttu-id="a9db7-147">платформа динамических данных обмен с точки зрения пользователя</span><span class="sxs-lookup"><span data-stu-id="a9db7-147">Dynamic Data Exchange from the User's Point of View</span></span>](#dynamic-data-exchange-from-the-users-point-of-view)
-   [<span data-ttu-id="a9db7-148">Основные понятия платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-148">Dynamic Data Exchange Concepts</span></span>](#dynamic-data-exchange-concepts)
    -   [<span data-ttu-id="a9db7-149">Клиент, сервер и беседа</span><span class="sxs-lookup"><span data-stu-id="a9db7-149">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
    -   [<span data-ttu-id="a9db7-150">Имена приложений, разделов и элементов</span><span class="sxs-lookup"><span data-stu-id="a9db7-150">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
    -   [<span data-ttu-id="a9db7-151">Раздел System</span><span class="sxs-lookup"><span data-stu-id="a9db7-151">The System Topic</span></span>](#the-system-topic)
    -   [<span data-ttu-id="a9db7-152">Постоянные ссылки на данные</span><span class="sxs-lookup"><span data-stu-id="a9db7-152">Permanent Data Links</span></span>](#permanent-data-links)
    -   [<span data-ttu-id="a9db7-153">Атомы и объекты общей памяти</span><span class="sxs-lookup"><span data-stu-id="a9db7-153">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)
-   [<span data-ttu-id="a9db7-154">Общие сведения об обмене сообщениями платформа динамических данных</span><span class="sxs-lookup"><span data-stu-id="a9db7-154">Dynamic Data Exchange Messages Overview</span></span>](#dynamic-data-exchange-messages-overview)
-   [<span data-ttu-id="a9db7-155">Поток сообщений платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-155">Dynamic Data Exchange Message Flow</span></span>](#dynamic-data-exchange-message-flow)
-   [<span data-ttu-id="a9db7-156">Функции упаковки параметров</span><span class="sxs-lookup"><span data-stu-id="a9db7-156">Parameter Packing Functions</span></span>](#parameter-packing-functions)
-   [<span data-ttu-id="a9db7-157">платформа динамических данных Exchange и олицетворение</span><span class="sxs-lookup"><span data-stu-id="a9db7-157">Dynamic Data Exchange and Impersonation</span></span>](#dynamic-data-exchange-and-impersonation)

## <a name="dynamic-data-exchange-protocol"></a><span data-ttu-id="a9db7-158">Протокол платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-158">Dynamic Data Exchange Protocol</span></span>

<span data-ttu-id="a9db7-159">Так как Windows имеет архитектуру на основе сообщений, передача сообщений является наиболее подходящим методом для автоматической передачи информации между приложениями.</span><span class="sxs-lookup"><span data-stu-id="a9db7-159">Because Windows has a message-based architecture, passing messages is the most appropriate method for automatically transferring information between applications.</span></span> <span data-ttu-id="a9db7-160">Однако сообщения содержат только два параметра (*wParam* и *lParam*) для передачи данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-160">However, messages contain only two parameters (*wParam* and *lParam*) for passing data.</span></span> <span data-ttu-id="a9db7-161">В результате эти параметры должны ссылаться косвенно на другие фрагменты данных, когда между приложениями передаются несколько слов данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-161">As a result, these parameters must refer indirectly to other pieces of data when more than a few words of information pass between applications.</span></span> <span data-ttu-id="a9db7-162">Протокол DDE точно определяет, как приложения должны использовать параметры *wParam* и *lParam* для передачи больших фрагментов данных с помощью глобальных атомов и дескрипторов общей памяти.</span><span class="sxs-lookup"><span data-stu-id="a9db7-162">The DDE protocol defines exactly how applications should use the *wParam* and *lParam* parameters to pass larger pieces of data by means of global atoms and shared memory handles.</span></span> <span data-ttu-id="a9db7-163">Протокол DDE имеет определенные правила для выделения и удаления глобальных атомов и объектов общей памяти.</span><span class="sxs-lookup"><span data-stu-id="a9db7-163">The DDE protocol has specific rules for allocating and deleting global atoms and shared memory objects.</span></span>

<span data-ttu-id="a9db7-164">Глобальный Atom — это ссылка на символьную строку.</span><span class="sxs-lookup"><span data-stu-id="a9db7-164">A global atom is a reference to a character string.</span></span> <span data-ttu-id="a9db7-165">В протоколе DDE атомы идентифицируют приложения, которые обмениваются данными, характер обмена данными и сами элементы данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-165">In the DDE protocol, atoms identify the applications exchanging data, the nature of the data being exchanged, and the data items themselves.</span></span> <span data-ttu-id="a9db7-166">Дополнительные сведения о атомах см. в разделе [о атомах](about-atom-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a9db7-166">For more information about atoms, see [About Atoms](about-atom-tables.md).</span></span>

## <a name="uses-for-windows-dynamic-data-exchange"></a><span data-ttu-id="a9db7-167">Использование для Windows платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-167">Uses for Windows Dynamic Data Exchange</span></span>

<span data-ttu-id="a9db7-168">Протокол DDE наиболее подходит для обмена данными, который не требует текущего взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="a9db7-168">DDE is most appropriate for data exchanges that do not require ongoing user interaction.</span></span> <span data-ttu-id="a9db7-169">Как правило, приложение предоставляет пользователю способ установить связь между приложениями, которые обмениваются данными.</span><span class="sxs-lookup"><span data-stu-id="a9db7-169">Usually, an application provides a method for the user to establish the link between the applications exchanging data.</span></span> <span data-ttu-id="a9db7-170">Однако после того, как связь установлена, приложения обмениваются данными без участия пользователя.</span><span class="sxs-lookup"><span data-stu-id="a9db7-170">Once that link is established, however, the applications exchange data without further user involvement.</span></span>

<span data-ttu-id="a9db7-171">DDE можно использовать для реализации широкого спектра функций приложений, например:</span><span class="sxs-lookup"><span data-stu-id="a9db7-171">DDE can be used to implement a broad range of application features — for example:</span></span>

-   <span data-ttu-id="a9db7-172">Связывание с данными в режиме реального времени, например с обновлениями рынка, научных инструментов или процессом управления процессами.</span><span class="sxs-lookup"><span data-stu-id="a9db7-172">Linking to real-time data, such as to stock market updates, scientific instruments, or process control.</span></span>
-   <span data-ttu-id="a9db7-173">Создание составных документов, таких как документ обработки текста, который содержит диаграмму, созданную графическим приложением.</span><span class="sxs-lookup"><span data-stu-id="a9db7-173">Creating compound documents, such as a word processing document that includes a chart produced by a graphics application.</span></span> <span data-ttu-id="a9db7-174">При использовании DDE диаграмма изменится при изменении исходных данных, а оставшаяся часть документа останется неизменной.</span><span class="sxs-lookup"><span data-stu-id="a9db7-174">Using DDE, the chart will change when the source data is changed, while the rest of the document remains the same.</span></span>
-   <span data-ttu-id="a9db7-175">Выполнение запросов данных между приложениями, например электронной таблицей, которая запрашивает у базы данных учетные записи, которые просрочены.</span><span class="sxs-lookup"><span data-stu-id="a9db7-175">Performing data queries between applications, such as a spreadsheet querying a database for accounts past due.</span></span>

## <a name="dynamic-data-exchange-from-the-users-point-of-view"></a><span data-ttu-id="a9db7-176">платформа динамических данных обмен с точки зрения пользователя</span><span class="sxs-lookup"><span data-stu-id="a9db7-176">Dynamic Data Exchange from the User's Point of View</span></span>

<span data-ttu-id="a9db7-177">В следующем примере показано, как могут взаимодействовать два приложения DDE, как видно из точки зрения пользователя.</span><span class="sxs-lookup"><span data-stu-id="a9db7-177">The following example illustrates how two DDE applications can cooperate, as seen from the user's point of view.</span></span>

<span data-ttu-id="a9db7-178">Пользователь электронной таблицы хочет использовать Microsoft Excel для контроля цены на конкретную акцию на фондовой бирже в Нью-Йорке.</span><span class="sxs-lookup"><span data-stu-id="a9db7-178">A spreadsheet user wants to use Microsoft Excel to track the price of a particular stock on the New York Stock Exchange.</span></span> <span data-ttu-id="a9db7-179">У пользователя есть приложение с именем quote, которое, в свою очередь, имеет доступ к данным Нисе.</span><span class="sxs-lookup"><span data-stu-id="a9db7-179">The user has an application called Quote that in turn has access to NYSE data.</span></span> <span data-ttu-id="a9db7-180">Сеанс DDE между Excel и quote происходит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a9db7-180">The DDE conversation between Excel and Quote takes place as follows:</span></span>

-   <span data-ttu-id="a9db7-181">Пользователь инициирует диалог, предоставляя имя приложения (цитата), которое будет предоставлять данные, и определенную тему интереса (Нисе).</span><span class="sxs-lookup"><span data-stu-id="a9db7-181">The user initiates the conversation by supplying the name of the application (Quote) that will supply the data and the particular topic of interest (NYSE).</span></span> <span data-ttu-id="a9db7-182">Полученный сеанс DDE используется для запроса квот на определенные акции.</span><span class="sxs-lookup"><span data-stu-id="a9db7-182">The resulting DDE conversation is used to request quotes on specific stocks.</span></span>
-   <span data-ttu-id="a9db7-183">Excel передает имена приложений и разделов во все приложения DDE, выполняющиеся в системе в данный момент.</span><span class="sxs-lookup"><span data-stu-id="a9db7-183">Excel broadcasts the application and topic names to all DDE applications currently running in the system.</span></span> <span data-ttu-id="a9db7-184">Кавычки отвечают, создавая диалог с Excel в разделе Нисе.</span><span class="sxs-lookup"><span data-stu-id="a9db7-184">Quote responds, establishing a conversation with Excel about the NYSE topic.</span></span>
-   <span data-ttu-id="a9db7-185">Пользователь может создать формулу таблицы в ячейке, которая запрашивает автоматическое обновление таблицы при каждом изменении конкретного котировка.</span><span class="sxs-lookup"><span data-stu-id="a9db7-185">The user can then create a spreadsheet formula in a cell that requests that the spreadsheet be automatically updated whenever a particular stock quotation changes.</span></span> <span data-ttu-id="a9db7-186">Например, пользователь может запросить автоматическое обновление каждый раз, когда происходит изменение в продажной цене ЗАКСКС акций, указав следующую формулу Excel: = ' quote ' \| ' Нисе '! закскс</span><span class="sxs-lookup"><span data-stu-id="a9db7-186">For example, the user could request an automatic update whenever a change occurs in the selling price of ZAXX stock by specifying the following Excel formula: ='Quote'\|'NYSE'!ZAXX</span></span>
-   <span data-ttu-id="a9db7-187">Пользователь может в любое время завершить автоматическое обновление котировки ЗАКСКС.</span><span class="sxs-lookup"><span data-stu-id="a9db7-187">The user can terminate the automatic updating of the ZAXX stock quotation at any time.</span></span> <span data-ttu-id="a9db7-188">Другие ссылки на данные, которые были установлены отдельно (например, для предложений других акций), по-прежнему останутся активными в рамках одной Нисе диалога.</span><span class="sxs-lookup"><span data-stu-id="a9db7-188">Other data links that were established separately (such as for quotations for other stocks) still will remain active under the same NYSE conversation.</span></span>
-   <span data-ttu-id="a9db7-189">Пользователь также может завершить весь диалог между Excel и кавычками в разделе Нисе, чтобы не создавать никаких ссылок на данные в этом разделе без инициации нового диалога.</span><span class="sxs-lookup"><span data-stu-id="a9db7-189">The user can also terminate the entire conversation between Excel and Quote on the NYSE topic, so that no specific data links on that topic can be established without initiating a new conversation.</span></span>

## <a name="dynamic-data-exchange-concepts"></a><span data-ttu-id="a9db7-190">Основные понятия платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-190">Dynamic Data Exchange Concepts</span></span>

<span data-ttu-id="a9db7-191">В следующих разделах объясняются важные понятия и терминология, которые являются ключевыми для понимания динамического обмена данными.</span><span class="sxs-lookup"><span data-stu-id="a9db7-191">The following sections explain the important concepts and terminology that are key to understanding dynamic data exchange.</span></span>

-   [<span data-ttu-id="a9db7-192">Клиент, сервер и беседа</span><span class="sxs-lookup"><span data-stu-id="a9db7-192">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
-   [<span data-ttu-id="a9db7-193">Имена приложений, разделов и элементов</span><span class="sxs-lookup"><span data-stu-id="a9db7-193">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
-   [<span data-ttu-id="a9db7-194">Раздел System</span><span class="sxs-lookup"><span data-stu-id="a9db7-194">The System Topic</span></span>](#the-system-topic)
-   [<span data-ttu-id="a9db7-195">Постоянные ссылки на данные</span><span class="sxs-lookup"><span data-stu-id="a9db7-195">Permanent Data Links</span></span>](#permanent-data-links)
-   [<span data-ttu-id="a9db7-196">Атомы и объекты общей памяти</span><span class="sxs-lookup"><span data-stu-id="a9db7-196">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)

### <a name="client-server-and-conversation"></a><span data-ttu-id="a9db7-197">Клиент, сервер и беседа</span><span class="sxs-lookup"><span data-stu-id="a9db7-197">Client, Server, and Conversation</span></span>

<span data-ttu-id="a9db7-198">Два приложения, участвующие в DDE, говорят, что они вовлечены в сеанс DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-198">Two applications participating in DDE are said to be engaged in a DDE conversation.</span></span> <span data-ttu-id="a9db7-199">Приложение, инициирующее диалог, является клиентским приложением DDE. приложение, отвечающее на клиент, является приложением сервера DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-199">The application that initiates the conversation is the DDE client application; the application that responds to the client is the DDE server application.</span></span> <span data-ttu-id="a9db7-200">Приложение может одновременно работать в нескольких диалогах, действуя как клиент в некоторых и в качестве сервера в других.</span><span class="sxs-lookup"><span data-stu-id="a9db7-200">An application can engage in several conversations at the same time, acting as the client in some and as the server in others.</span></span>

<span data-ttu-id="a9db7-201">Сеанс DDE происходит между двумя окнами, по одному для каждого из участвующих в приложении приложений.</span><span class="sxs-lookup"><span data-stu-id="a9db7-201">A DDE conversation takes place between two windows, one for each of the participating applications.</span></span> <span data-ttu-id="a9db7-202">Окно может быть основным окном приложения; окно, связанное с конкретным документом, как в приложении с многодокументным интерфейсом (MDI); или скрытое (невидимое) окно, предназначенное только для обработки сообщений DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-202">A window may be the main window of the application; a window associated with a specific document, as in a multiple-document interface (MDI) application; or a hidden (invisible) window whose only purpose is to process DDE messages.</span></span>

<span data-ttu-id="a9db7-203">Так как сеанс DDE определяется парой дескрипторов для окон диалога, ни одно окно не должно быть вовлечено в несколько диалогов с другим окном.</span><span class="sxs-lookup"><span data-stu-id="a9db7-203">Since a DDE conversation is identified by the pair of handles to the windows engaged in the conversation, no window should be engaged in more than one conversation with another window.</span></span> <span data-ttu-id="a9db7-204">Клиентское приложение или серверное приложение должно предоставлять другое окно для каждого диалога с конкретным сервером или клиентским приложением.</span><span class="sxs-lookup"><span data-stu-id="a9db7-204">Either the client application or the server application must provide a different window for each of its conversations with a particular server or client application.</span></span>

<span data-ttu-id="a9db7-205">Приложение может обеспечить, чтобы пара клиентских и серверных окон никогда не участвовала в нескольких диалогах, создавая скрытое окно для каждого диалога.</span><span class="sxs-lookup"><span data-stu-id="a9db7-205">An application can ensure a pair of client and server windows is never involved in more than one conversation by creating a hidden window for each conversation.</span></span> <span data-ttu-id="a9db7-206">Единственное назначение этого окна — Обработка сообщений DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-206">The sole purpose of this window is to process DDE messages.</span></span>

### <a name="application-topic-and-item-names"></a><span data-ttu-id="a9db7-207">Имена приложений, разделов и элементов</span><span class="sxs-lookup"><span data-stu-id="a9db7-207">Application, Topic, and Item Names</span></span>

<span data-ttu-id="a9db7-208">Протокол DDE определяет единицы данных, передаваемых между клиентом и сервером с трехуровневой иерархией имен приложений, разделов и элементов.</span><span class="sxs-lookup"><span data-stu-id="a9db7-208">The DDE protocol identifies the units of data passed between the client and server with a three-level hierarchy of application, topic, and item names.</span></span>

<span data-ttu-id="a9db7-209">Каждый сеанс DDE однозначно определяется именем приложения и темой.</span><span class="sxs-lookup"><span data-stu-id="a9db7-209">Each DDE conversation is uniquely defined by the application name and topic.</span></span> <span data-ttu-id="a9db7-210">В начале сеанса DDE клиент и сервер определяют имя приложения и раздел.</span><span class="sxs-lookup"><span data-stu-id="a9db7-210">At the beginning of a DDE conversation, the client and server determine the application name and topic.</span></span> <span data-ttu-id="a9db7-211">Имя приложения обычно является именем серверного приложения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-211">The application name is usually the name of the server application.</span></span> <span data-ttu-id="a9db7-212">Например, когда Excel выступает в качестве сервера в диалоге, имя приложения — Excel.</span><span class="sxs-lookup"><span data-stu-id="a9db7-212">For example, when Excel acts as the server in a conversation, the application name is Excel.</span></span>

<span data-ttu-id="a9db7-213">Раздел DDE представляет собой общую классификацию данных, в которой во время диалога несколько элементов данных могут быть «обсуждаемыми» (в Exchange).</span><span class="sxs-lookup"><span data-stu-id="a9db7-213">The DDE topic is a general classification of data within which multiple data items may be "discussed" (exchanged) during the conversation.</span></span> <span data-ttu-id="a9db7-214">Для приложений, работающих с документами на основе файлов, раздел обычно представляет собой имя файла.</span><span class="sxs-lookup"><span data-stu-id="a9db7-214">For applications that operate on file-based documents, the topic is usually a filename.</span></span> <span data-ttu-id="a9db7-215">Для других приложений раздел является именем, зависящим от приложения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-215">For other applications, the topic is an application-specific name.</span></span>

<span data-ttu-id="a9db7-216">Так как окно клиента и сервера обрабатываются совместно, определите сеанс DDE, имя приложения и раздел, описывающие диалог, не могут быть изменены во время диалога.</span><span class="sxs-lookup"><span data-stu-id="a9db7-216">Because the client and server window handles together identify a DDE conversation, the application name and topic that define a conversation cannot be changed during the course of the conversation.</span></span>

<span data-ttu-id="a9db7-217">Элемент данных DDE — это информация, относящаяся к теме диалога, который обменивается между приложениями.</span><span class="sxs-lookup"><span data-stu-id="a9db7-217">A DDE data item is information related to the conversation topic exchanged between the applications.</span></span> <span data-ttu-id="a9db7-218">Значения для элемента данных могут передаваться с сервера клиенту или с клиента на сервер.</span><span class="sxs-lookup"><span data-stu-id="a9db7-218">Values for the data item can be passed from the server to the client, or from the client to the server.</span></span> <span data-ttu-id="a9db7-219">Данные могут передаваться с помощью любого стандартного формата буфера обмена или с зарегистрированным форматом буфера обмена.</span><span class="sxs-lookup"><span data-stu-id="a9db7-219">Data can be passed with any of the standard clipboard formats or with a registered clipboard format.</span></span> <span data-ttu-id="a9db7-220">Специальный зарегистрированный формат с именем Link определяет элемент в сеансе DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-220">A special, registered format named Link identifies an item in a DDE conversation.</span></span> <span data-ttu-id="a9db7-221">Дополнительные сведения о форматах буфера обмена см. в разделе [буфер обмена](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="a9db7-221">For more information about clipboard formats, see [Clipboard](clipboard.md).</span></span>

### <a name="the-system-topic"></a><span data-ttu-id="a9db7-222">Раздел System</span><span class="sxs-lookup"><span data-stu-id="a9db7-222">The System Topic</span></span>

<span data-ttu-id="a9db7-223">Приложения должны поддерживать системный раздел все время.</span><span class="sxs-lookup"><span data-stu-id="a9db7-223">Applications should support the system topic at all times.</span></span> <span data-ttu-id="a9db7-224">В этом разделе представлен контекст для информации, которая может представлять собой общий интерес для другого приложения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-224">This topic provides a context for information that may be of general interest to another application.</span></span>

<span data-ttu-id="a9db7-225">Значения элементов данных должны подготавливаться к просмотру в формате [**\_ текстовых**](standard-clipboard-formats.md) буферов CF.</span><span class="sxs-lookup"><span data-stu-id="a9db7-225">Data-item values must be rendered in the [**CF\_TEXT**](standard-clipboard-formats.md) clipboard format.</span></span> <span data-ttu-id="a9db7-226">Отдельные элементы значений элементов для системного раздела должны быть разделены символами табуляции.</span><span class="sxs-lookup"><span data-stu-id="a9db7-226">Individual elements of item values for a system topic must be delimited by tab characters.</span></span> <span data-ttu-id="a9db7-227">В следующей таблице представлены некоторые элементы для системного раздела.</span><span class="sxs-lookup"><span data-stu-id="a9db7-227">The following table suggests some items for the system topic.</span></span>



| <span data-ttu-id="a9db7-228">Элемент</span><span class="sxs-lookup"><span data-stu-id="a9db7-228">Item</span></span>          | <span data-ttu-id="a9db7-229">Описание</span><span class="sxs-lookup"><span data-stu-id="a9db7-229">Description</span></span>                                                                                                                                                                                                                                                                                             |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a9db7-230">Форматы</span><span class="sxs-lookup"><span data-stu-id="a9db7-230">Formats</span></span>       | <span data-ttu-id="a9db7-231">Разделенный символами табуляцией список форматов буфера обмена, которые приложение может визуализировать.</span><span class="sxs-lookup"><span data-stu-id="a9db7-231">Tab-delimited list of clipboard formats the application can render.</span></span> <span data-ttu-id="a9db7-232">Как правило, форматы **\_ CF** указываются с частью **" \_ CF**" удаляемых имен (например, **\_ текст CF** указан как "**Text**").</span><span class="sxs-lookup"><span data-stu-id="a9db7-232">Typically, **CF\_** formats are listed with the "**CF\_**" portion of the names removed (for example, **CF\_TEXT** is listed as "**TEXT**").</span></span>                                                                                        |
| <span data-ttu-id="a9db7-233">Справка</span><span class="sxs-lookup"><span data-stu-id="a9db7-233">Help</span></span>          | <span data-ttu-id="a9db7-234">Текст, который кратко описывает использование сервера DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-234">Text that briefly explains how to use the DDE server.</span></span>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="a9db7-235">ретурнмессаже</span><span class="sxs-lookup"><span data-stu-id="a9db7-235">ReturnMessage</span></span> | <span data-ttu-id="a9db7-236">Поддержка подробных сведений о недавно использованном сообщении [**WM \_ DDE \_ ACK**](wm-dde-ack.md) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-236">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="a9db7-237">Этот элемент полезен, если требуются более восьми бит возвращаемых данных приложения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-237">This item is useful when more than eight bits of application-specific return data are required.</span></span>                                                                                                                |
| <span data-ttu-id="a9db7-238">Состояние</span><span class="sxs-lookup"><span data-stu-id="a9db7-238">Status</span></span>        | <span data-ttu-id="a9db7-239">Указывает текущее состояние приложения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-239">Indication of the current status of the application.</span></span> <span data-ttu-id="a9db7-240">Когда сервер получает сообщение [**запроса WM \_ DDE \_**](wm-dde-request.md) для этого элемента системы, он должен ответить, отправляя сообщение [**\_ \_ данных DDE WM**](wm-dde-data.md) со строкой, содержащей значение busy или Ready, в зависимости от ситуации.</span><span class="sxs-lookup"><span data-stu-id="a9db7-240">When a server receives a [**WM\_DDE\_REQUEST**](wm-dde-request.md) message for this system-topic item, it should respond by posting a [**WM\_DDE\_DATA**](wm-dde-data.md) message with a string containing either Busy or Ready, as appropriate.</span></span> |
| <span data-ttu-id="a9db7-241">сиситемс</span><span class="sxs-lookup"><span data-stu-id="a9db7-241">SysItems</span></span>      | <span data-ttu-id="a9db7-242">Список элементов системного раздела, поддерживаемых приложением.</span><span class="sxs-lookup"><span data-stu-id="a9db7-242">List of system-topic items the application supports.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="a9db7-243">топиЦитемлист</span><span class="sxs-lookup"><span data-stu-id="a9db7-243">TopicItemList</span></span> | <span data-ttu-id="a9db7-244">Аналогично элементу Сиситемс, за исключением того, что ТопиЦитемлист должен поддерживаться для каждого раздела, кроме системного раздела.</span><span class="sxs-lookup"><span data-stu-id="a9db7-244">Similar to the SysItems item, except that TopicItemList should be supported for each topic other than the system topic.</span></span> <span data-ttu-id="a9db7-245">Это позволяет просматривать элементы, поддерживаемые в любой теме.</span><span class="sxs-lookup"><span data-stu-id="a9db7-245">This allows browsing of the items supported under any topic.</span></span> <span data-ttu-id="a9db7-246">Если элементы не могут быть перечислены, этот элемент должен содержать только "ТопиЦитемлист".</span><span class="sxs-lookup"><span data-stu-id="a9db7-246">If the items cannot be enumerated, this item should contain only "TopicItemList".</span></span>                                  |
| <span data-ttu-id="a9db7-247">Разделы</span><span class="sxs-lookup"><span data-stu-id="a9db7-247">Topics</span></span>        | <span data-ttu-id="a9db7-248">Список разделов, поддерживаемых приложением в настоящее время; Этот список может быть в разных секундах.</span><span class="sxs-lookup"><span data-stu-id="a9db7-248">List of topics the application supports at the current time; this list can vary from moment to moment.</span></span>                                                                                                                                                                                                  |



 

### <a name="permanent-data-links"></a><span data-ttu-id="a9db7-249">Постоянные ссылки на данные</span><span class="sxs-lookup"><span data-stu-id="a9db7-249">Permanent Data Links</span></span>

<span data-ttu-id="a9db7-250">После начала сеанса DDE клиент может установить одну или несколько постоянных ссылок на данные с сервера.</span><span class="sxs-lookup"><span data-stu-id="a9db7-250">Once a DDE conversation has begun, the client can establish one or more permanent data links with the server.</span></span> <span data-ttu-id="a9db7-251">Канал передачи данных — это механизм связи, с помощью которого сервер уведомляет клиента при каждом изменении значения указанного элемента данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-251">A data link is a communications mechanism by which the server notifies the client whenever the value of a specified data item changes.</span></span> <span data-ttu-id="a9db7-252">Канал данных является постоянным в том смысле, что этот процесс уведомления будет продолжаться до тех пор, пока не завершится связь с данными или сеанс DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-252">The data link is permanent in the sense that this notification process continues until the data link or the DDE conversation itself is terminated.</span></span>

<span data-ttu-id="a9db7-253">Существует два вида постоянных ссылок на данные DDE: горячий и горячий.</span><span class="sxs-lookup"><span data-stu-id="a9db7-253">There are two kinds of permanent DDE data links: warm and hot.</span></span> <span data-ttu-id="a9db7-254">В канале горячий передачи данных сервер уведомляет клиента о том, что значение элемента данных изменилось, но сервер не отправляет клиенту значение данных, пока клиент не запросит его.</span><span class="sxs-lookup"><span data-stu-id="a9db7-254">In a warm data link, the server notifies the client that the value of the data item has changed, but the server does not send the data value to the client until the client requests it.</span></span> <span data-ttu-id="a9db7-255">В канале горячего передачи данных сервер немедленно отправляет клиенту измененное значение данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-255">In a hot data link, the server immediately sends the changed data value to the client.</span></span>

<span data-ttu-id="a9db7-256">Приложения, поддерживающие горячую или горячую связь, обычно предоставляют команду **Копировать** или **Вставить ссылку** в своем меню " **Правка** ", чтобы позволить пользователю устанавливать ссылки между приложениями.</span><span class="sxs-lookup"><span data-stu-id="a9db7-256">Applications that support warm or hot data links typically provide a **Copy** or **Paste Link** command in their **Edit** menu to enable the user to establish links between applications.</span></span>

### <a name="atoms-and-shared-memory-objects"></a><span data-ttu-id="a9db7-257">Атомы и объекты общей памяти</span><span class="sxs-lookup"><span data-stu-id="a9db7-257">Atoms and Shared Memory Objects</span></span>

<span data-ttu-id="a9db7-258">Некоторыми аргументами сообщений DDE являются глобальные атомы или объекты общей памяти.</span><span class="sxs-lookup"><span data-stu-id="a9db7-258">Certain arguments of DDE messages are global atoms or shared memory objects.</span></span> <span data-ttu-id="a9db7-259">Приложения, использующие эти аргументы, должны следовать явным правилам о том, когда следует распределять и удалять их.</span><span class="sxs-lookup"><span data-stu-id="a9db7-259">Applications using these arguments must follow explicit rules about when to allocate and delete them.</span></span> <span data-ttu-id="a9db7-260">Во всех случаях отправителю сообщения необходимо удалить любой объект Atom или Shared Memory, который не будет получен из-за состояния ошибки, например при сбое функции отправки [**сообщений**](/windows/desktop/api/winuser/nf-winuser-postmessagea) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-260">In all cases, the message sender must delete any atom or shared memory object that the intended receiver will not receive because of an error condition, such as failure of the [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) function.</span></span>

<span data-ttu-id="a9db7-261">DDE использует объекты общей памяти для трех целей:</span><span class="sxs-lookup"><span data-stu-id="a9db7-261">DDE uses shared memory objects for three purposes:</span></span>

-   <span data-ttu-id="a9db7-262">Для переноса значения элемента данных для обмена.</span><span class="sxs-lookup"><span data-stu-id="a9db7-262">To carry a data-item value to be exchanged.</span></span> <span data-ttu-id="a9db7-263">Это элемент, на который ссылается параметр *хдата* в [**\_ \_ данных WM DDE**](wm-dde-data.md) , а [**WM DDE \_ — \_ Вставка**](wm-dde-poke.md) сообщений.</span><span class="sxs-lookup"><span data-stu-id="a9db7-263">This is an item referenced by the *hData* parameter in the [**WM\_DDE\_DATA**](wm-dde-data.md) and [**WM\_DDE\_POKE**](wm-dde-poke.md) messages.</span></span>
-   <span data-ttu-id="a9db7-264">Для выполнения параметров в сообщении.</span><span class="sxs-lookup"><span data-stu-id="a9db7-264">To carry options in a message.</span></span> <span data-ttu-id="a9db7-265">Это элемент, на который ссылается параметр *хоптионс* в сообщении с рекомендацией [**WM \_ DDE \_**](wm-dde-advise.md) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-265">This is an item referenced by the *hOptions* parameter in a [**WM\_DDE\_ADVISE**](wm-dde-advise.md) message.</span></span>
-   <span data-ttu-id="a9db7-266">Для выполнения строки выполнения команды.</span><span class="sxs-lookup"><span data-stu-id="a9db7-266">To carry a command execution string.</span></span> <span data-ttu-id="a9db7-267">Это элемент, на который ссылается параметр *хкоммандс* в сообщении об [**\_ \_ исполнении WM DDE**](wm-dde-execute.md) и соответствующее сообщение [**WM \_ DDE \_ ACK**](wm-dde-ack.md) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-267">This is an item referenced by the *hCommands* parameter in the [**WM\_DDE\_EXECUTE**](wm-dde-execute.md) message and its corresponding [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span>

<span data-ttu-id="a9db7-268">Приложение, получающее объект общей памяти DDE, должно обрабатывать его как доступное только для чтения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-268">An application that receives a DDE shared memory object must treat it as read only.</span></span> <span data-ttu-id="a9db7-269">Приложение не должно использовать объект в качестве обоюдной области для чтения и записи для бесплатного обмена данными.</span><span class="sxs-lookup"><span data-stu-id="a9db7-269">The application must not use the object as a mutual read-write area for the free exchange of data.</span></span>

<span data-ttu-id="a9db7-270">Как и в случае с Atom DDE, приложение должно освободить объект общей памяти для эффективного управления памятью.</span><span class="sxs-lookup"><span data-stu-id="a9db7-270">As it does with a DDE atom, an application should free a shared memory object to manage memory effectively.</span></span> <span data-ttu-id="a9db7-271">Приложение также должно блокировать и разблокировать объекты памяти.</span><span class="sxs-lookup"><span data-stu-id="a9db7-271">The application should also lock and unlock memory objects.</span></span>

## <a name="dynamic-data-exchange-messages-overview"></a><span data-ttu-id="a9db7-272">Общие сведения об обмене сообщениями платформа динамических данных</span><span class="sxs-lookup"><span data-stu-id="a9db7-272">Dynamic Data Exchange Messages Overview</span></span>

<span data-ttu-id="a9db7-273">Так как DDE является протоколом на основе сообщений, он не использует никаких функций или библиотек.</span><span class="sxs-lookup"><span data-stu-id="a9db7-273">Because DDE is a message-based protocol, it employs no functions or libraries.</span></span> <span data-ttu-id="a9db7-274">Все транзакции DDE проходят через передачу определенных сообщений DDE между клиентскими и серверными окнами.</span><span class="sxs-lookup"><span data-stu-id="a9db7-274">All DDE transactions are conducted by passing certain defined DDE messages between the client and server windows.</span></span>

<span data-ttu-id="a9db7-275">Имеется девять сообщений DDE; Символьные константы для этих сообщений определяются в файле заголовка DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-275">There are nine DDE messages; the symbolic constants for these messages are defined in the DDE header file.</span></span> <span data-ttu-id="a9db7-276">Некоторые структуры для различных сообщений DDE также определяются в этом файле заголовка.</span><span class="sxs-lookup"><span data-stu-id="a9db7-276">Certain structures for the various DDE messages are also defined in this header file.</span></span>

<span data-ttu-id="a9db7-277">В следующей таблице перечислены сообщения DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-277">The following table summarizes the DDE messages.</span></span>



| <span data-ttu-id="a9db7-278">Сообщение</span><span class="sxs-lookup"><span data-stu-id="a9db7-278">Message</span></span>                                        | <span data-ttu-id="a9db7-279">Описание</span><span class="sxs-lookup"><span data-stu-id="a9db7-279">Description</span></span>                                                                                                                                      |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a9db7-280">**WM \_ DDE \_ ACK**</span><span class="sxs-lookup"><span data-stu-id="a9db7-280">**WM\_DDE\_ACK**</span></span>](wm-dde-ack.md)             | <span data-ttu-id="a9db7-281">Подтверждает получение или отсутствие получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="a9db7-281">Acknowledges receiving or not receiving a message.</span></span>                                                                                               |
| [<span data-ttu-id="a9db7-282">**Протокол WM \_ DDE \_ advise**</span><span class="sxs-lookup"><span data-stu-id="a9db7-282">**WM\_DDE\_ADVISE**</span></span>](wm-dde-advise.md)       | <span data-ttu-id="a9db7-283">Запрашивает серверное приложение на предоставление обновления или уведомления для элемента данных при каждом изменении.</span><span class="sxs-lookup"><span data-stu-id="a9db7-283">Requests the server application to supply an update or notification for a data item whenever it changes.</span></span> <span data-ttu-id="a9db7-284">Это устанавливает постоянный канал данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-284">This establishes a permanent data link.</span></span> |
| [<span data-ttu-id="a9db7-285">**\_данные DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a9db7-285">**WM\_DDE\_DATA**</span></span>](wm-dde-data.md)           | <span data-ttu-id="a9db7-286">Отправляет в клиентское приложение значение элемента данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-286">Sends a data-item value to the client application.</span></span>                                                                                               |
| [<span data-ttu-id="a9db7-287">**\_выполнение WM DDE \_**</span><span class="sxs-lookup"><span data-stu-id="a9db7-287">**WM\_DDE\_EXECUTE**</span></span>](wm-dde-execute.md)     | <span data-ttu-id="a9db7-288">Отправляет строку в серверное приложение, которое предполагает обработку строки в виде последовательности команд.</span><span class="sxs-lookup"><span data-stu-id="a9db7-288">Sends a string to the server application, which is expected to process the string as a series of commands.</span></span>                                       |
| [<span data-ttu-id="a9db7-289">**\_Запуск WM DDE \_**</span><span class="sxs-lookup"><span data-stu-id="a9db7-289">**WM\_DDE\_INITIATE**</span></span>](wm-dde-initiate.md)   | <span data-ttu-id="a9db7-290">Инициирует диалог между клиентскими и серверными приложениями.</span><span class="sxs-lookup"><span data-stu-id="a9db7-290">Initiates a conversation between the client and server applications.</span></span>                                                                             |
| [<span data-ttu-id="a9db7-291">**\_Вставка DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a9db7-291">**WM\_DDE\_POKE**</span></span>](wm-dde-poke.md)           | <span data-ttu-id="a9db7-292">Отправляет значение элемента данных в серверное приложение.</span><span class="sxs-lookup"><span data-stu-id="a9db7-292">Sends a data-item value to the server application.</span></span>                                                                                               |
| [<span data-ttu-id="a9db7-293">**\_запрос DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a9db7-293">**WM\_DDE\_REQUEST**</span></span>](wm-dde-request.md)     | <span data-ttu-id="a9db7-294">Запрашивает серверное приложение для предоставления значения элемента данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-294">Requests the server application to provide the value of a data item.</span></span>                                                                             |
| [<span data-ttu-id="a9db7-295">**\_прерывание работы WM DDE \_**</span><span class="sxs-lookup"><span data-stu-id="a9db7-295">**WM\_DDE\_TERMINATE**</span></span>](wm-dde-terminate.md) | <span data-ttu-id="a9db7-296">Завершает диалог.</span><span class="sxs-lookup"><span data-stu-id="a9db7-296">Terminates a conversation.</span></span>                                                                                                                       |
| [<span data-ttu-id="a9db7-297">**WM \_ DDE \_ unadvise**</span><span class="sxs-lookup"><span data-stu-id="a9db7-297">**WM\_DDE\_UNADVISE**</span></span>](wm-dde-unadvise.md)   | <span data-ttu-id="a9db7-298">Завершает связь с постоянными данными.</span><span class="sxs-lookup"><span data-stu-id="a9db7-298">Terminates a permanent data link.</span></span>                                                                                                                |



 

<span data-ttu-id="a9db7-299">Приложение вызывает [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) , чтобы выдать сообщение об [**\_ \_ инициации DDE WM**](wm-dde-initiate.md) или сообщение [**WM \_ DDE \_ ACK**](wm-dde-ack.md) , отправленное в ответ на **Запуск программы WM \_ DDE \_**.</span><span class="sxs-lookup"><span data-stu-id="a9db7-299">An application calls [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) to issue the [**WM\_DDE\_INITIATE**](wm-dde-initiate.md) message or a [**WM\_DDE\_ACK**](wm-dde-ack.md) message sent in response to **WM\_DDE\_INITIATE**.</span></span> <span data-ttu-id="a9db7-300">Все остальные сообщения отправляются [**сообщением**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span><span class="sxs-lookup"><span data-stu-id="a9db7-300">All other messages are sent by [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span></span> <span data-ttu-id="a9db7-301">Первый параметр этих вызовов — это обработчик принимающего окна; Второй параметр содержит отправляемое сообщение; Третий параметр определяет окно отправки; и четвертый параметр содержит аргументы, относящиеся к конкретному сообщению.</span><span class="sxs-lookup"><span data-stu-id="a9db7-301">The first parameter of these calls is a handle to the receiving window; the second parameter contains the message to be sent; the third parameter identifies the sending window; and the fourth parameter contains the message-specific arguments.</span></span>

## <a name="dynamic-data-exchange-message-flow"></a><span data-ttu-id="a9db7-302">Поток сообщений платформа динамических данных Exchange</span><span class="sxs-lookup"><span data-stu-id="a9db7-302">Dynamic Data Exchange Message Flow</span></span>

<span data-ttu-id="a9db7-303">Типичный сеанс DDE состоит из следующих событий.</span><span class="sxs-lookup"><span data-stu-id="a9db7-303">A typical DDE conversation consists of the following events:</span></span>

1.  <span data-ttu-id="a9db7-304">Клиентское приложение инициирует диалог, и серверное приложение отвечает.</span><span class="sxs-lookup"><span data-stu-id="a9db7-304">The client application initiates the conversation, and the server application responds.</span></span>
2.  <span data-ttu-id="a9db7-305">Приложения обмениваются данными с помощью любого или всех следующих методов:</span><span class="sxs-lookup"><span data-stu-id="a9db7-305">The applications exchange data by any or all of the following methods:</span></span>
    -   -   <span data-ttu-id="a9db7-306">Серверное приложение отправляет данные клиенту по запросу клиента.</span><span class="sxs-lookup"><span data-stu-id="a9db7-306">The server application sends data to the client at the client's request.</span></span>
        -   <span data-ttu-id="a9db7-307">Клиентское приложение отправляет незапрошенные данные в серверное приложение.</span><span class="sxs-lookup"><span data-stu-id="a9db7-307">The client application sends unsolicited data to the server application.</span></span>
        -   <span data-ttu-id="a9db7-308">Клиентское приложение запрашивает серверное приложение для уведомления клиента при каждом изменении элемента данных (горячий канал данных).</span><span class="sxs-lookup"><span data-stu-id="a9db7-308">The client application requests the server application to notify the client whenever a data item changes (warm data link).</span></span>
        -   <span data-ttu-id="a9db7-309">Клиентское приложение запрашивает серверное приложение на отправку данных при каждом изменении данных (ссылка на горячую передачу данных).</span><span class="sxs-lookup"><span data-stu-id="a9db7-309">The client application requests the server application to send data whenever the data changes (hot data link).</span></span>
        -   <span data-ttu-id="a9db7-310">Серверное приложение выполняет команду по запросу клиента.</span><span class="sxs-lookup"><span data-stu-id="a9db7-310">The server application carries out a command at the client's request.</span></span>

3.  <span data-ttu-id="a9db7-311">Клиент или серверное приложение завершает диалог.</span><span class="sxs-lookup"><span data-stu-id="a9db7-311">Either the client or server application terminates the conversation.</span></span>

<span data-ttu-id="a9db7-312">Окно приложения, обрабатывающее запросы от клиента или сервера, должно обрабатывать их строго в том порядке, в котором они получены.</span><span class="sxs-lookup"><span data-stu-id="a9db7-312">An application window that processes requests from a client or server must process them strictly in the order they are received.</span></span>

<span data-ttu-id="a9db7-313">Клиент может устанавливать диалоги с несколькими серверами. сервер может иметь диалоги с несколькими клиентами.</span><span class="sxs-lookup"><span data-stu-id="a9db7-313">A client can establish conversations with more than one server; a server can have conversations with more than one client.</span></span> <span data-ttu-id="a9db7-314">При обработке сообщений из более чем одного источника клиент или сервер должен синхронно обрабатывать сообщения диалога, но не должны обрабатывать все сообщения синхронно.</span><span class="sxs-lookup"><span data-stu-id="a9db7-314">When handling messages from more than one source, a client or server must process the messages of a conversation synchronously, but need not process all messages synchronously.</span></span> <span data-ttu-id="a9db7-315">Иными словами, он может переходить от одного диалога к другому при необходимости.</span><span class="sxs-lookup"><span data-stu-id="a9db7-315">In other words, it can shift from one conversation to another as needed.</span></span>

<span data-ttu-id="a9db7-316">Если приложению не удается обработать входящий запрос, так как он ожидает ответа DDE, он должен предотвратить блокировку, отправляя сообщение [**WM \_ DDE \_ ACK**](wm-dde-ack.md) с членом **фбуси** структуры [**ддеакк**](/windows/desktop/api/Dde/ns-dde-ddeack) , равным 1.</span><span class="sxs-lookup"><span data-stu-id="a9db7-316">If an application is unable to process an incoming request because it is waiting for a DDE response, it must prevent deadlock by posting a [**WM\_DDE\_ACK**](wm-dde-ack.md) message with the **fBusy** member of the [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) structure set to 1.</span></span> <span data-ttu-id="a9db7-317">Приложение также может отправить занятое сообщение **WM \_ DDE \_ ACK** , если по какой-либо причине оно не может обработать входящий запрос в течение разумного промежутка времени.</span><span class="sxs-lookup"><span data-stu-id="a9db7-317">An application can also send a busy **WM\_DDE\_ACK** message if, for any reason, it cannot process an incoming request within a reasonable amount of time.</span></span>

<span data-ttu-id="a9db7-318">Приложение должно быть способно обработать сбой клиента или сервера для реагирования на сообщение в течение определенного времени.</span><span class="sxs-lookup"><span data-stu-id="a9db7-318">An application should be able to handle the failure of a client or server to respond to a message within a certain time.</span></span> <span data-ttu-id="a9db7-319">Так как интервал времени ожидания может различаться в зависимости от характера приложения и конфигурации системы пользователя (включая подключение к сети), приложение должно предоставить пользователю способ указания интервала в.</span><span class="sxs-lookup"><span data-stu-id="a9db7-319">Since the time-out interval may vary depending on the nature of the application and the configuration of the user's system (including whether it is connected to a network), the application should provide a way for the user to specify the interval.</span></span>

## <a name="parameter-packing-functions"></a><span data-ttu-id="a9db7-320">Функции упаковки параметров</span><span class="sxs-lookup"><span data-stu-id="a9db7-320">Parameter Packing Functions</span></span>

<span data-ttu-id="a9db7-321">Параметр *lParam* многих сообщений DDE содержит два фрагмента данных.</span><span class="sxs-lookup"><span data-stu-id="a9db7-321">The *lParam* parameter of many DDE messages contains two pieces of data.</span></span> <span data-ttu-id="a9db7-322">Например, *lParam* сообщения [**\_ \_ данных DDE WM**](wm-dde-data.md) содержит маркер данных и Atom.</span><span class="sxs-lookup"><span data-stu-id="a9db7-322">For example, the *lParam* of the [**WM\_DDE\_DATA**](wm-dde-data.md) message contains a data handle and an atom.</span></span> <span data-ttu-id="a9db7-323">Приложения должны использовать функцию [**паккдделпарам**](/windows/desktop/api/Dde/nf-dde-packddelparam) для упаковки маркера и Atom в параметр *lParam* , а также функцию [**унпаккдделпарам**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) для удаления значений.</span><span class="sxs-lookup"><span data-stu-id="a9db7-323">Applications must use the [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) function to pack the handle and atom into an *lParam* parameter, and the [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) function to remove the values.</span></span> <span data-ttu-id="a9db7-324">Приложения DDE должны использовать **паккдделпарам** и **унпаккдделпарам** для всех сообщений, опубликованных во время сеанса DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-324">DDE applications must use **PackDDElParam** and **UnpackDDElParam** for all messages posted during a DDE conversation.</span></span>

<span data-ttu-id="a9db7-325">Приложения также могут использовать функции [**реуседделпарам**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) и [**фридделпарам**](/windows/desktop/api/Dde/nf-dde-freeddelparam) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-325">Applications can also use the [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) and [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) functions.</span></span> <span data-ttu-id="a9db7-326">**Реуседделпарам** позволяет приложению DDE повторно использовать упакованный параметр *lParam* , помогая сократить количество перераспределений памяти, которые приложение должно выполнить во время диалога.</span><span class="sxs-lookup"><span data-stu-id="a9db7-326">**ReuseDDElParam** allows a DDE application to reuse a packed *lParam* parameter, helping reduce the number of memory reallocations the application must perform during a conversation.</span></span> <span data-ttu-id="a9db7-327">Приложение может использовать **фридделпарам** для высвобождения памяти, связанной с маркером данных, полученным во время сеанса DDE.</span><span class="sxs-lookup"><span data-stu-id="a9db7-327">An application can use **FreeDDElParam** to free the memory associated with a data handle received during a DDE conversation.</span></span>

## <a name="dynamic-data-exchange-and-impersonation"></a><span data-ttu-id="a9db7-328">платформа динамических данных Exchange и олицетворение</span><span class="sxs-lookup"><span data-stu-id="a9db7-328">Dynamic Data Exchange and Impersonation</span></span>

<span data-ttu-id="a9db7-329">Чтобы разрешить серверу олицетворять клиента, клиент вызывает функцию [**ддесеткуалитйофсервице**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-329">To allow a server to impersonate a client, the client calls the [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) function.</span></span> <span data-ttu-id="a9db7-330">Для управления уровнем олицетворения, который может выполнять сервер, используется структура [**\_ \_ уровня олицетворения безопасности**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-330">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) structure is used to control the level of impersonation the server may perform.</span></span>

<span data-ttu-id="a9db7-331">Сервер DDE может олицетворять клиент DDE, вызывая функцию [**имперсонатеддеклиентвиндов**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-331">A DDE server can impersonate a DDE client by calling the [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) function.</span></span> <span data-ttu-id="a9db7-332">Сервер ДДЕМЛ должен использовать функцию [**ддеимперсонатеклиент**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) .</span><span class="sxs-lookup"><span data-stu-id="a9db7-332">A DDEML server should use the [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) function.</span></span>

 

 