---
title: Управление транзакциями (обмен данными)
description: В этом разделе обсуждается, как клиент может отсылать транзакции для получения данных и служб с сервера.
ms.assetid: 2d08ffa3-cbd7-4806-b94f-979938322c38
keywords:
- Пользовательский интерфейс Windows, платформа динамических данных Exchange (DDE)
- Платформа динамических данных Exchange (DDE), транзакции
- DDE (платформа динамических данных Exchange), транзакции
- Обмен данными, платформа динамических данных Exchange (DDE)
- Пользовательский интерфейс Windows, Библиотека управления платформа динамических данных Exchange (ДДЕМЛ)
- Библиотека управления платформа динамических данных Exchange (ДДЕМЛ), транзакции
- ДДЕМЛ (Библиотека управления Exchange платформа динамических данных), транзакции
- Обмен данными, Библиотека управления платформа динамических данных Exchange (ДДЕМЛ)
- Платформа динамических данных Exchange (DDE), запрос транзакций
- DDE (платформа динамических данных Exchange), запрос транзакций
- Библиотека управления платформа динамических данных Exchange (ДДЕМЛ), запрос транзакций
- ДДЕМЛ (Библиотека управления Exchange платформа динамических данных), запрос транзакций
- Платформа динамических данных Exchange (DDE), вставка транзакций
- DDE (платформа динамических данных Exchange), вставка транзакций
- Платформа динамических данных Библиотека управления Exchange (ДДЕМЛ), вставка транзакций
- ДДЕМЛ (платформа динамических данных Библиотека управления Exchange), вставка транзакций
- Платформа динамических данных Exchange (DDE), рекомендовать транзакции
- DDE (платформа динамических данных Exchange), рекомендовать транзакции
- Платформа динамических данных Библиотека управления Exchange (ДДЕМЛ), advise
- ДДЕМЛ (Библиотека управления Exchange платформа динамических данных), уведомления о транзакциях
- Платформа динамических данных Exchange (DDE), выполнение транзакций
- DDE (платформа динамических данных Exchange), выполнение транзакций
- Библиотека управления платформа динамических данных Exchange (ДДЕМЛ), выполнение транзакций
- ДДЕМЛ (Библиотека управления Exchange платформа динамических данных), выполнение транзакций
- Платформа динамических данных Exchange (DDE), синхронные транзакции
- DDE (платформа динамических данных Exchange), синхронные транзакции
- Библиотека управления платформа динамических данных Exchange (ДДЕМЛ), синхронные транзакции
- ДДЕМЛ (Библиотека управления Exchange платформа динамических данных), синхронные транзакции
- Платформа динамических данных Exchange (DDE), асинхронные транзакции
- DDE (платформа динамических данных Exchange), асинхронные транзакции
- Библиотека управления платформа динамических данных Exchange (ДДЕМЛ), асинхронные транзакции
- ДДЕМЛ (Библиотека управления Exchange платформа динамических данных), асинхронные транзакции
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 570aa48b4dcdbb31855b3e1b15a091908feb2ba4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070145"
---
# <a name="transaction-management-data-exchange"></a><span data-ttu-id="7740c-135">Управление транзакциями (обмен данными)</span><span class="sxs-lookup"><span data-stu-id="7740c-135">Transaction Management (Data Exchange)</span></span>

<span data-ttu-id="7740c-136">После установления диалога с сервером клиент может передавать транзакции для получения данных и служб с сервера.</span><span class="sxs-lookup"><span data-stu-id="7740c-136">After establishing a conversation with a server, a client can send transactions to obtain data and services from the server.</span></span>

<span data-ttu-id="7740c-137">В следующих разделах описываются типы транзакций, которые клиенты могут использовать для взаимодействия с сервером.</span><span class="sxs-lookup"><span data-stu-id="7740c-137">The following topics describe the types of transactions that clients can use to interact with a server.</span></span>

-   [<span data-ttu-id="7740c-138">Транзакция запроса</span><span class="sxs-lookup"><span data-stu-id="7740c-138">Request Transaction</span></span>](#request-transaction)
-   [<span data-ttu-id="7740c-139">Вставка транзакции</span><span class="sxs-lookup"><span data-stu-id="7740c-139">Poke Transaction</span></span>](#poke-transaction)
-   [<span data-ttu-id="7740c-140">Рекомендовать транзакцию</span><span class="sxs-lookup"><span data-stu-id="7740c-140">Advise Transaction</span></span>](#advise-transaction)
-   [<span data-ttu-id="7740c-141">Выполнить транзакцию</span><span class="sxs-lookup"><span data-stu-id="7740c-141">Execute Transaction</span></span>](#execute-transaction)
-   [<span data-ttu-id="7740c-142">Синхронные и асинхронные транзакции</span><span class="sxs-lookup"><span data-stu-id="7740c-142">Synchronous and Asynchronous Transactions</span></span>](#synchronous-and-asynchronous-transactions)
-   [<span data-ttu-id="7740c-143">Управление транзакциями</span><span class="sxs-lookup"><span data-stu-id="7740c-143">Transaction Control</span></span>](#transaction-control)
-   [<span data-ttu-id="7740c-144">Классы транзакций</span><span class="sxs-lookup"><span data-stu-id="7740c-144">Transaction Classes</span></span>](#transaction-classes)
-   [<span data-ttu-id="7740c-145">Типы транзакций</span><span class="sxs-lookup"><span data-stu-id="7740c-145">Transaction Types</span></span>](#transaction-types)

## <a name="request-transaction"></a><span data-ttu-id="7740c-146">Транзакция запроса</span><span class="sxs-lookup"><span data-stu-id="7740c-146">Request Transaction</span></span>

<span data-ttu-id="7740c-147">Клиентское приложение может использовать транзакцию [**\_ запроса кстип**](xtyp-request.md) для запроса элемента данных из серверного приложения.</span><span class="sxs-lookup"><span data-stu-id="7740c-147">A client application can use the [**XTYP\_REQUEST**](xtyp-request.md) transaction to request a data item from a server application.</span></span> <span data-ttu-id="7740c-148">Клиент вызывает функцию [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) , указывая **\_ запрос кстип** в качестве типа транзакции и указывая элемент данных, который требуется приложению.</span><span class="sxs-lookup"><span data-stu-id="7740c-148">The client calls the [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) function, specifying **XTYP\_REQUEST** as the transaction type and specifying the data item the application needs.</span></span>

<span data-ttu-id="7740c-149">Платформа динамических данных Библиотека управления Exchange (ДДЕМЛ) передает транзакцию [**\_ запроса кстип**](xtyp-request.md) на сервер, указывая имя раздела, имя элемента и формат данных, запрошенный клиентом.</span><span class="sxs-lookup"><span data-stu-id="7740c-149">The Dynamic Data Exchange Management Library (DDEML) passes the [**XTYP\_REQUEST**](xtyp-request.md) transaction to the server, specifying the topic name, item name, and data format requested by the client.</span></span> <span data-ttu-id="7740c-150">Если сервер поддерживает запрошенный раздел, элемент и формат, сервер должен вернуть маркер данных, который определяет текущее значение элемента.</span><span class="sxs-lookup"><span data-stu-id="7740c-150">If the server supports the requested topic, item, and format, the server should return a data handle that identifies the current value of the item.</span></span> <span data-ttu-id="7740c-151">ДДЕМЛ передает этот обработчик клиенту в качестве возвращаемого значения из [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-151">The DDEML passes this handle to the client as the return value from [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="7740c-152">Сервер должен вернуть **значение NULL** , если он не поддерживает запрошенный раздел, элемент или формат.</span><span class="sxs-lookup"><span data-stu-id="7740c-152">The server should return **NULL** if it does not support the topic, item, or format requested.</span></span>

<span data-ttu-id="7740c-153">[**Ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) использует параметр *лпдвресулт* для возвращения клиенту флага состояния транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-153">[**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) uses the *lpdwResult* parameter to return a transaction-status flag to the client.</span></span> <span data-ttu-id="7740c-154">Если сервер не обрабатывает транзакцию [**\_ запроса Кстип**](xtyp-request.md) , **ддеклиенттрансактион** возвращает **значение NULL**, а *лпдвресулт* указывает на \_ флаг DDE фнотпроцессед или DDE \_ фбуси.</span><span class="sxs-lookup"><span data-stu-id="7740c-154">If the server does not process the [**XTYP\_REQUEST**](xtyp-request.md) transaction, **DdeClientTransaction** returns **NULL**, and *lpdwResult* points to the DDE\_FNOTPROCESSED or DDE\_FBUSY flag.</span></span> <span data-ttu-id="7740c-155">Если \_ возвращается флаг DDE фнотпроцессед, клиент не может определить, почему сервер не обработал транзакцию.</span><span class="sxs-lookup"><span data-stu-id="7740c-155">If the DDE\_FNOTPROCESSED flag is returned, the client cannot determine why the server did not process the transaction.</span></span>

<span data-ttu-id="7740c-156">Если сервер не поддерживает транзакцию [**\_ запроса кстип**](xtyp-request.md) , он должен указать \_ флаг фильтра неудачных \_ запросов КБФ в функции [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="7740c-156">If a server does not support the [**XTYP\_REQUEST**](xtyp-request.md) transaction, it should specify the CBF\_FAIL\_REQUESTS filter flag in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="7740c-157">Этот флаг предотвращает отправку ДДЕМЛ транзакции на сервер.</span><span class="sxs-lookup"><span data-stu-id="7740c-157">This flag prevents the DDEML from sending the transaction to the server.</span></span>

## <a name="poke-transaction"></a><span data-ttu-id="7740c-158">Вставка транзакции</span><span class="sxs-lookup"><span data-stu-id="7740c-158">Poke Transaction</span></span>

<span data-ttu-id="7740c-159">Клиент может отправить незапрошенные данные на сервер с помощью [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) , чтобы отправить транзакцию [**кстип \_**](xtyp-poke.md) в функцию обратного вызова сервера.</span><span class="sxs-lookup"><span data-stu-id="7740c-159">A client can send unsolicited data to a server by using [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) to send an [**XTYP\_POKE**](xtyp-poke.md) transaction to a server's callback function.</span></span>

<span data-ttu-id="7740c-160">Клиентское приложение сначала создает буфер, содержащий данные для отправки на сервер, а затем передает указатель на буфер в качестве параметра [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-160">The client application first creates a buffer that contains the data to send to the server and then passes a pointer to the buffer as a parameter to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="7740c-161">Кроме того, клиент может использовать функцию [**ддекреатедатахандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) для получения маркера данных, определяющего данные, а затем передать его в **ддеклиенттрансактион**.</span><span class="sxs-lookup"><span data-stu-id="7740c-161">Alternatively, the client can use the [**DdeCreateDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) function to obtain a data handle that identifies the data and then pass the handle to **DdeClientTransaction**.</span></span> <span data-ttu-id="7740c-162">В любом случае клиент также задает имя раздела, имя элемента и формат данных при вызове **ддеклиенттрансактион**.</span><span class="sxs-lookup"><span data-stu-id="7740c-162">In either case, the client also specifies the topic name, item name, and data format when it calls **DdeClientTransaction**.</span></span>

<span data-ttu-id="7740c-163">ДДЕМЛ передает на сервер [**\_ транзакцию кстип**](xtyp-poke.md) , указывая имя раздела, имя элемента и формат данных, запрошенный клиентом.</span><span class="sxs-lookup"><span data-stu-id="7740c-163">The DDEML passes the [**XTYP\_POKE**](xtyp-poke.md) transaction to the server, specifying the topic name, item name, and data format that the client requested.</span></span> <span data-ttu-id="7740c-164">Чтобы принять элемент данных и формат, сервер должен вернуть DDE \_ факк.</span><span class="sxs-lookup"><span data-stu-id="7740c-164">To accept the data item and format, the server should return DDE\_FACK.</span></span> <span data-ttu-id="7740c-165">Чтобы отклонить данные, сервер должен вернуть DDE \_ фнотпроцессед.</span><span class="sxs-lookup"><span data-stu-id="7740c-165">To reject the data, the server should return DDE\_FNOTPROCESSED.</span></span> <span data-ttu-id="7740c-166">Если сервер слишком занят для приема данных, сервер должен вернуть DDE \_ фбуси.</span><span class="sxs-lookup"><span data-stu-id="7740c-166">If the server is too busy to accept the data, the server should return DDE\_FBUSY.</span></span>

<span data-ttu-id="7740c-167">Когда [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) возвращает, клиент может использовать параметр *лпдвресулт* для доступа к флагу Transaction-Status.</span><span class="sxs-lookup"><span data-stu-id="7740c-167">When [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) returns, the client can use the *lpdwResult* parameter to access the transaction-status flag.</span></span> <span data-ttu-id="7740c-168">Если флаг имеет значение DDE \_ фбуси, клиент должен отправить транзакцию позже.</span><span class="sxs-lookup"><span data-stu-id="7740c-168">If the flag is DDE\_FBUSY, the client should send the transaction again later.</span></span>

<span data-ttu-id="7740c-169">Если сервер не поддерживает транзакцию [**кстип, \_**](xtyp-poke.md) он должен указать \_ флаг фильтра КБФ Failed \_ в [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea).</span><span class="sxs-lookup"><span data-stu-id="7740c-169">If a server does not support the [**XTYP\_POKE**](xtyp-poke.md) transaction, it should specify the CBF\_FAIL\_POKES filter flag in [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea).</span></span> <span data-ttu-id="7740c-170">Этот флаг предотвращает отправку этой транзакции сервером ДДЕМЛ.</span><span class="sxs-lookup"><span data-stu-id="7740c-170">This flag prevents the DDEML from sending this transaction to the server.</span></span>

## <a name="advise-transaction"></a><span data-ttu-id="7740c-171">Рекомендовать транзакцию</span><span class="sxs-lookup"><span data-stu-id="7740c-171">Advise Transaction</span></span>

<span data-ttu-id="7740c-172">Клиентское приложение может использовать ДДЕМЛ для установки одной или нескольких ссылок на элементы в серверном приложении.</span><span class="sxs-lookup"><span data-stu-id="7740c-172">A client application can use the DDEML to establish one or more links to items in a server application.</span></span> <span data-ttu-id="7740c-173">Если такая связь установлена, сервер отправляет периодические обновления связанного элемента клиенту (как правило, при каждом изменении значения элемента, связанного с серверным приложением).</span><span class="sxs-lookup"><span data-stu-id="7740c-173">When such a link has been established, the server sends periodic updates about the linked item to the client (typically, whenever the value of the item associated with the server application changes).</span></span> <span data-ttu-id="7740c-174">Связывание устанавливает цикл рекомендаций между двумя приложениями, которые остаются на месте, пока клиент не завершит его.</span><span class="sxs-lookup"><span data-stu-id="7740c-174">Linking establishes an advise loop between the two applications that remains in place until the client ends it.</span></span>

<span data-ttu-id="7740c-175">Существует два вида циклов рекомендаций: "горячий" и "тепло".</span><span class="sxs-lookup"><span data-stu-id="7740c-175">There are two kinds of advise loops: "hot" and "warm."</span></span> <span data-ttu-id="7740c-176">В цикле onadvise сервер немедленно отправляет обработчик данных, который определяет измененное значение.</span><span class="sxs-lookup"><span data-stu-id="7740c-176">In a hot advise loop, the server immediately sends a data handle that identifies the changed value.</span></span> <span data-ttu-id="7740c-177">В цикле горячий advise сервер уведомляет клиента о том, что значение элемента изменилось, но не отправляет его, пока клиент не запросит его.</span><span class="sxs-lookup"><span data-stu-id="7740c-177">In a warm advise loop, the server notifies the client that the value of the item has changed but does not send the data handle until the client requests it.</span></span>

<span data-ttu-id="7740c-178">Клиент может запросить цикл рекомендаций с сервером, указав тип транзакции [**кстип \_ адвстарт**](xtyp-advstart.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-178">A client can request a hot advise loop with a server by specifying the [**XTYP\_ADVSTART**](xtyp-advstart.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="7740c-179">Чтобы запросить цикл теплого получения рекомендаций, клиент должен объединить флаг КСТИПФ \_ NoData с типом транзакции **кстип \_ адвстарт** .</span><span class="sxs-lookup"><span data-stu-id="7740c-179">To request a warm advise loop, the client must combine the XTYPF\_NODATA flag with the **XTYP\_ADVSTART** transaction type.</span></span> <span data-ttu-id="7740c-180">В любом из этих событий ДДЕМЛ передает транзакцию **\_ адвстарт кстип** на серверную функцию обратного вызова Exchange (DDE) платформа динамических данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-180">In either event, the DDEML passes the **XTYP\_ADVSTART** transaction to the server's Dynamic Data Exchange (DDE) callback function.</span></span> <span data-ttu-id="7740c-181">Функция обратного вызова DDE сервера должна проверять параметры, сопровождающие транзакцию **кстип \_ адвстарт** (включая запрошенный формат, имя раздела и имя элемента), а затем возвращать **значение true** , чтобы разрешить цикл advise или **значение false** для его запрета.</span><span class="sxs-lookup"><span data-stu-id="7740c-181">The server's DDE callback function should examine the parameters that accompany the **XTYP\_ADVSTART** transaction (including the requested format, topic name, and item name) and then return **TRUE** to allow the advise loop or **FALSE** to deny it.</span></span>

<span data-ttu-id="7740c-182">После установки цикла рекомендаций серверное приложение должно вызывать функцию [**ддепостадвисе**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) всякий раз, когда значение элемента, связанного с запрошенным именем элемента, изменяется.</span><span class="sxs-lookup"><span data-stu-id="7740c-182">After an advise loop has been established, the server application should call the [**DdePostAdvise**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) function whenever the value of the item associated with the requested item name changes.</span></span> <span data-ttu-id="7740c-183">В результате этого вызова транзакция [**кстип \_ Адврек**](xtyp-advreq.md) отправляется в собственную функцию ОБРАТНОго вызова DDE на сервере.</span><span class="sxs-lookup"><span data-stu-id="7740c-183">This call results in an [**XTYP\_ADVREQ**](xtyp-advreq.md) transaction being sent to the server's own DDE callback function.</span></span> <span data-ttu-id="7740c-184">Функция обратного вызова DDE сервера должна возвращать маркер данных, который определяет новое значение элемента данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-184">The server's DDE callback function should return a data handle that identifies the new value of the data item.</span></span> <span data-ttu-id="7740c-185">Затем ДДЕМЛ уведомляет клиента о том, что указанный элемент изменился путем отправки транзакции [**кстип \_ адвдата**](xtyp-advdata.md) в функцию обратного вызова DDE клиента.</span><span class="sxs-lookup"><span data-stu-id="7740c-185">The DDEML then notifies the client that the specified item has changed by sending the [**XTYP\_ADVDATA**](xtyp-advdata.md) transaction to the client's DDE callback function.</span></span>

<span data-ttu-id="7740c-186">Если клиент запросил цикл onadvise, ДДЕМЛ передает этот обработчик в измененный элемент клиенту во время транзакции [**кстип \_ адвдата**](xtyp-advdata.md) .</span><span class="sxs-lookup"><span data-stu-id="7740c-186">If the client requested a hot advise loop, the DDEML passes the data handle to the changed item to the client during the [**XTYP\_ADVDATA**](xtyp-advdata.md) transaction.</span></span> <span data-ttu-id="7740c-187">В противном случае клиент может отправить транзакцию [**\_ запроса кстип**](xtyp-request.md) для получения маркера данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-187">Otherwise, the client can send an [**XTYP\_REQUEST**](xtyp-request.md) transaction to obtain the data handle.</span></span>

<span data-ttu-id="7740c-188">Сервер может отсылать обновления быстрее, чем клиенты могут обрабатывать новые данные.</span><span class="sxs-lookup"><span data-stu-id="7740c-188">It is possible for a server to send updates faster than a client can process the new data.</span></span> <span data-ttu-id="7740c-189">Скорость обновления может быть проблемой для клиента, который должен выполнять длительные операции обработки данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-189">The speed of updates can be a problem for a client that must perform lengthy processing operations on the data.</span></span> <span data-ttu-id="7740c-190">В этом случае клиент должен указать \_ флаг кстипф аккрек при запросе цикла рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="7740c-190">In this case, the client should specify the XTYPF\_ACKREQ flag when it requests an advise loop.</span></span> <span data-ttu-id="7740c-191">Этот флаг заставляет сервер ожидать, что клиент получил и обработал элемент данных до того, как сервер отправит следующий элемент данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-191">This flag causes the server to wait for the client to acknowledge that it has received and processed a data item before the server sends the next data item.</span></span> <span data-ttu-id="7740c-192">Циклы advise, установленные с \_ флагом кстипф аккрек, более надежны при работе с быстрыми серверами, но иногда могут пропускать обновления.</span><span class="sxs-lookup"><span data-stu-id="7740c-192">Advise loops that are established with the XTYPF\_ACKREQ flag are more robust with fast servers but can occasionally miss updates.</span></span> <span data-ttu-id="7740c-193">Циклы advise, установленные без \_ флага кстипф аккрек, гарантированно не пропускают обновления при условии, что клиент поддерживает сервер.</span><span class="sxs-lookup"><span data-stu-id="7740c-193">Advise loops established without the XTYPF\_ACKREQ flag are guaranteed not to miss updates as long as the client keeps up with the server.</span></span>

<span data-ttu-id="7740c-194">Клиент может завершить цикл рекомендаций, указав тип транзакции [**кстип \_ адвстоп**](xtyp-advstop.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-194">A client can end an advise loop by specifying the [**XTYP\_ADVSTOP**](xtyp-advstop.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>

<span data-ttu-id="7740c-195">Если сервер не поддерживает циклы advise, он должен указывать \_ флаг фильтра КБФ Failed \_ advise в функции [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="7740c-195">If a server does not support advise loops, it should specify the CBF\_FAIL\_ADVISES filter flag in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="7740c-196">Этот флаг предотвращает отправку ДДЕМЛ [**кстип \_ Адвстарт**](xtyp-advstart.md) и [**кстип \_ адвстоп**](xtyp-advstop.md) транзакций на сервер.</span><span class="sxs-lookup"><span data-stu-id="7740c-196">This flag prevents the DDEML from sending the [**XTYP\_ADVSTART**](xtyp-advstart.md) and [**XTYP\_ADVSTOP**](xtyp-advstop.md) transactions to the server.</span></span>

## <a name="execute-transaction"></a><span data-ttu-id="7740c-197">Выполнить транзакцию</span><span class="sxs-lookup"><span data-stu-id="7740c-197">Execute Transaction</span></span>

<span data-ttu-id="7740c-198">Клиент может использовать транзакцию [**кстип \_ EXECUTE**](xtyp-execute.md) , чтобы сервер мог выполнить команду или ряд команд.</span><span class="sxs-lookup"><span data-stu-id="7740c-198">A client can use the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction to cause a server to execute a command or a series of commands.</span></span>

<span data-ttu-id="7740c-199">Чтобы выполнить команду сервера, клиент сначала создает буфер, содержащий командную строку для выполнения сервера, а затем передает либо указатель на буфер, либо обработчик данных, идентифицирующий буфер при вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-199">To execute a server command, the client first creates a buffer that contains a command string for the server to execute and then passes either a pointer to the buffer or a data handle identifying the buffer when it calls [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="7740c-200">Другие обязательные параметры включают в себя обработчик диалога, обработчик строки имени элемента, спецификацию формата и тип [**\_ выполнения транзакции кстип**](xtyp-execute.md) .</span><span class="sxs-lookup"><span data-stu-id="7740c-200">Other required parameters include the conversation handle, the item name string handle, the format specification, and the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction type.</span></span> <span data-ttu-id="7740c-201">Приложение, которое создает обработчик данных для передачи данных о выполнении, должно указывать **значение NULL** для параметра *хсзитем* функции [**Ддекреатедатахандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) и ноль для параметра *уфмт* .</span><span class="sxs-lookup"><span data-stu-id="7740c-201">An application that creates a data handle to passing execute data must specify **NULL** for the *hszItem* parameter of the [**DdeCreateDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) function and zero for the *uFmt* parameter.</span></span>

<span data-ttu-id="7740c-202">ДДЕМЛ передает [**\_ исполняемую**](xtyp-execute.md) транзакцию кстип в функцию обратного вызова DDE сервера и задает имя формата, обработчик диалога, имя раздела и обработчик данных, идентифицирующие командную строку.</span><span class="sxs-lookup"><span data-stu-id="7740c-202">The DDEML passes the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction to the server's DDE callback function and specifies the format name, conversation handle, topic name, and data handle identifying the command string.</span></span> <span data-ttu-id="7740c-203">Если сервер поддерживает команду, он должен использовать функцию [**ддеакцессдата**](/windows/desktop/api/Ddeml/nf-ddeml-ddeaccessdata) для получения указателя на командную строку, выполнения команды и возврата DDE \_ факк.</span><span class="sxs-lookup"><span data-stu-id="7740c-203">If the server supports the command, it should use the [**DdeAccessData**](/windows/desktop/api/Ddeml/nf-ddeml-ddeaccessdata) function to obtain a pointer to the command string, execute the command, and then return DDE\_FACK.</span></span> <span data-ttu-id="7740c-204">Если сервер не поддерживает команду или не может завершить транзакцию, он должен вернуть DDE \_ фнотпроцессед.</span><span class="sxs-lookup"><span data-stu-id="7740c-204">If the server does not support the command or cannot complete the transaction, it should return DDE\_FNOTPROCESSED.</span></span> <span data-ttu-id="7740c-205">Сервер должен вернуть DDE \_ фбуси, если он слишком занят для завершения транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-205">The server should return DDE\_FBUSY if it is too busy to complete the transaction.</span></span>

<span data-ttu-id="7740c-206">В общем случае функция обратного вызова сервера должна обработать транзакцию [**кстип \_ EXECUTE**](xtyp-execute.md) перед возвратом со следующими исключениями:</span><span class="sxs-lookup"><span data-stu-id="7740c-206">In general, a server's callback function should process the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction before returning with the following exceptions:</span></span>

1.  <span data-ttu-id="7740c-207">Когда команда, передаваемая с помощью транзакции [**кстип \_ EXECUTE**](xtyp-execute.md) , запрашивает прекращение работы сервера, сервер не должен завершаться до тех пор, пока функция обратного вызова не вернется из обработки **кстип \_ EXECUTE**.</span><span class="sxs-lookup"><span data-stu-id="7740c-207">When the command passed with the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction requests the server to terminate, the server should not terminate until its callback function returns from processing **XTYP\_EXECUTE**.</span></span>
2.  <span data-ttu-id="7740c-208">Если сервер должен выполнить операцию, например обработку диалогового окна или транзакции DDE, которая может вызвать проблемы рекурсии ДДЕМЛ, то сервер должен вернуть \_ код возврата блока CBR для блокировки выполнения транзакции, выполнения операции и возобновления обработки выполнения транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-208">If the server must perform an operation, such as processing a dialog box or a DDE transaction that might cause DDEML recursion problems, the server should return the CBR\_BLOCK return code to block the execute transaction, perform the operation, and then resume processing the execute transaction.</span></span>

<span data-ttu-id="7740c-209">Когда [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) возвращает, клиент может использовать параметр *лпдвресулт* для доступа к флагу состояния транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-209">When [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) returns, the client can use the *lpdwResult* parameter to access the transaction status flag.</span></span> <span data-ttu-id="7740c-210">Если флаг имеет значение DDE \_ фбуси, клиент должен отправить транзакцию позже.</span><span class="sxs-lookup"><span data-stu-id="7740c-210">If the flag is DDE\_FBUSY, the client should send the transaction again later.</span></span>

<span data-ttu-id="7740c-211">Если сервер не поддерживает транзакцию [**кстип \_ EXECUTE**](xtyp-execute.md) , он должен указать \_ флаг фильтра Failed EXECUTEing (сбой КБФ) \_ в функции [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="7740c-211">If a server does not support the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction, it should specify the CBF\_FAIL\_EXECUTES filter flag in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="7740c-212">Это предотвращает отправку ДДЕМЛ транзакции на сервер.</span><span class="sxs-lookup"><span data-stu-id="7740c-212">Doing so prevents the DDEML from sending the transaction to the server.</span></span>

## <a name="synchronous-and-asynchronous-transactions"></a><span data-ttu-id="7740c-213">Синхронные и асинхронные транзакции</span><span class="sxs-lookup"><span data-stu-id="7740c-213">Synchronous and Asynchronous Transactions</span></span>

<span data-ttu-id="7740c-214">Клиент может передавать как синхронные, так и асинхронные транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-214">A client can send either synchronous or asynchronous transactions.</span></span> <span data-ttu-id="7740c-215">В синхронной транзакции клиент указывает значение времени ожидания, указывающее на максимальное время ожидания сервером обработки транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-215">In a synchronous transaction, the client specifies a time-out value that indicates the maximum amount of time it will wait for the server to process the transaction.</span></span> <span data-ttu-id="7740c-216">[**Ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) не возвращает значение, пока сервер не обработает транзакцию, транзакция завершается ошибкой или истекает время ожидания.</span><span class="sxs-lookup"><span data-stu-id="7740c-216">[**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) does not return until the server processes the transaction, the transaction fails, or the time-out value expires.</span></span> <span data-ttu-id="7740c-217">Клиент задает значение времени ожидания при вызове **ддеклиенттрансактион**.</span><span class="sxs-lookup"><span data-stu-id="7740c-217">The client specifies the time-out value when it calls **DdeClientTransaction**.</span></span>

<span data-ttu-id="7740c-218">Во время синхронной транзакции клиент переходит в модальный цикл во время ожидания обработки транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-218">During a synchronous transaction, the client enters a modal loop while waiting for the transaction to be processed.</span></span> <span data-ttu-id="7740c-219">Клиент по-прежнему может обрабатывать введенные пользователем данные, но не может отправить еще одну синхронную транзакцию, пока [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) не вернет.</span><span class="sxs-lookup"><span data-stu-id="7740c-219">The client can still process user input but cannot send another synchronous transaction until [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) returns.</span></span>

<span data-ttu-id="7740c-220">Клиент отправляет асинхронную транзакцию, указывая \_ флаг асинхронного времени ожидания в [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-220">A client sends an asynchronous transaction by specifying the TIMEOUT\_ASYNC flag in [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="7740c-221">Функция возвращает значение после начала транзакции, передавая идентификатор транзакции клиенту.</span><span class="sxs-lookup"><span data-stu-id="7740c-221">The function returns after the transaction has begun, passing a transaction identifier to the client.</span></span> <span data-ttu-id="7740c-222">Когда сервер завершает обработку асинхронной транзакции, ДДЕМЛ отправляет клиенту транзакцию [**транзакции \_ кстип \_ Complete**](xtyp-xact-complete.md) .</span><span class="sxs-lookup"><span data-stu-id="7740c-222">When the server finishes processing the asynchronous transaction, the DDEML sends an [**XTYP\_XACT\_COMPLETE**](xtyp-xact-complete.md) transaction to the client.</span></span> <span data-ttu-id="7740c-223">Один из параметров, переданный ДДЕМЛ в клиент во время транзакции **кстип транзакций \_ \_ Complete** , — это идентификатор транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-223">One of the parameters that the DDEML passes to the client during the **XTYP\_XACT\_COMPLETE** transaction is the transaction identifier.</span></span> <span data-ttu-id="7740c-224">Сравнивая этот идентификатор транзакции с идентификатором, возвращенным **ддеклиенттрансактион**, клиент определяет, какая асинхронная транзакция завершается сервером.</span><span class="sxs-lookup"><span data-stu-id="7740c-224">By comparing this transaction identifier with the identifier returned by **DdeClientTransaction**, the client identifies which asynchronous transaction the server has finished processing.</span></span>

<span data-ttu-id="7740c-225">Клиент может использовать функцию [**ддесетусерхандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddesetuserhandle) в качестве вспомогательной функции обработки асинхронной транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-225">A client can use the [**DdeSetUserHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddesetuserhandle) function as an aid in processing an asynchronous transaction.</span></span> <span data-ttu-id="7740c-226">Эта функция позволяет клиенту связать определяемое приложением значение с маркером диалога и идентификатором транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-226">This function makes it possible for a client to associate an application-defined value with a conversation handle and a transaction identifier.</span></span> <span data-ttu-id="7740c-227">Клиент может использовать функцию [**ддекуериконвинфо**](/windows/desktop/api/Ddeml/nf-ddeml-ddequeryconvinfo) во время транзакции [**кстип транзакций \_ \_ Complete**](xtyp-xact-complete.md) для получения значения, определяемого приложением.</span><span class="sxs-lookup"><span data-stu-id="7740c-227">The client can use the [**DdeQueryConvInfo**](/windows/desktop/api/Ddeml/nf-ddeml-ddequeryconvinfo) function during the [**XTYP\_XACT\_COMPLETE**](xtyp-xact-complete.md) transaction to obtain the application-defined value.</span></span> <span data-ttu-id="7740c-228">Из-за этой функции приложению не требуется поддерживать список идентификаторов активных транзакций.</span><span class="sxs-lookup"><span data-stu-id="7740c-228">Because of this function, an application need not maintain a list of active transaction identifiers.</span></span>

<span data-ttu-id="7740c-229">Когда клиент успешно завершает запрос данных с помощью синхронной транзакции, ДДЕМЛ не имеет возможности определить, когда клиент завершил использование полученных данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-229">When a client successfully completes a request for data using a synchronous transaction, the DDEML has no way to tell when the client has finished using the data received.</span></span> <span data-ttu-id="7740c-230">Клиентское приложение должно передать полученный обработчик данных в функцию [**ддефридатахандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreedatahandle) , УВЕДОМЛЯя ддемл о том, что этот маркер больше не используется.</span><span class="sxs-lookup"><span data-stu-id="7740c-230">The client application must pass the data handle received to the [**DdeFreeDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreedatahandle) function, notifying the DDEML that the handle will no longer be used.</span></span> <span data-ttu-id="7740c-231">Дескрипторы данных, возвращаемые синхронными транзакциями, фактически принадлежат клиенту.</span><span class="sxs-lookup"><span data-stu-id="7740c-231">Data handles returned by synchronous transactions are effectively owned by the client.</span></span>

<span data-ttu-id="7740c-232">Если сервер своевременно не обрабатывает асинхронную транзакцию, клиент может отказаться от транзакции, вызвав функцию [**ддеабандонтрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeabandontransaction) .</span><span class="sxs-lookup"><span data-stu-id="7740c-232">If a server does not process an asynchronous transaction in a timely manner, the client can abandon the transaction by calling the [**DdeAbandonTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeabandontransaction) function.</span></span> <span data-ttu-id="7740c-233">ДДЕМЛ освобождает все ресурсы, связанные с транзакцией, и отклоняет результаты транзакции, когда сервер завершает ее обработку.</span><span class="sxs-lookup"><span data-stu-id="7740c-233">The DDEML releases all resources associated with the transaction and discards the results of the transaction when the server finishes processing it.</span></span> <span data-ttu-id="7740c-234">Время ожидания в синхронной транзакции фактически отменяет транзакцию.</span><span class="sxs-lookup"><span data-stu-id="7740c-234">A time-out during a synchronous transaction effectively cancels the transaction.</span></span>

<span data-ttu-id="7740c-235">Асинхронный метод транзакции предоставляется для приложений, которые должны отправить большое количество транзакций DDE, одновременно выполняя значительный объем обработки, например выполнение вычислений.</span><span class="sxs-lookup"><span data-stu-id="7740c-235">The asynchronous transaction method is provided for applications that must send a high volume of DDE transactions while simultaneously performing a substantial amount of processing, such as performing calculations.</span></span> <span data-ttu-id="7740c-236">Асинхронный метод также полезен в приложениях, которые должны временно остановить обработку транзакций DDE, чтобы они могли выполнять другие задачи без прерывания.</span><span class="sxs-lookup"><span data-stu-id="7740c-236">The asynchronous method is also useful in applications that must stop processing DDE transactions temporarily so they can complete other tasks without interruption.</span></span> <span data-ttu-id="7740c-237">В большинстве случаев приложение должно использовать синхронный метод.</span><span class="sxs-lookup"><span data-stu-id="7740c-237">In most other situations, an application should use the synchronous method.</span></span>

<span data-ttu-id="7740c-238">Синхронные транзакции проще в обслуживании и выполняются быстрее, чем асинхронные транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-238">Synchronous transactions are simpler to maintain and are faster than asynchronous transactions.</span></span> <span data-ttu-id="7740c-239">Однако в каждый момент времени может выполняться только одна синхронная транзакция, в то время как многие асинхронные транзакции могут выполняться одновременно.</span><span class="sxs-lookup"><span data-stu-id="7740c-239">However, only one synchronous transaction can be performed at a time, whereas many asynchronous transactions can be performed simultaneously.</span></span> <span data-ttu-id="7740c-240">При использовании синхронных транзакций медленный сервер может привести к тому, что клиент будет оставаться неактивным, пока он ожидает ответа.</span><span class="sxs-lookup"><span data-stu-id="7740c-240">With synchronous transactions, a slow server can cause a client to remain idle while it is waiting for a response.</span></span> <span data-ttu-id="7740c-241">Кроме того, синхронные транзакции приводят к тому, что клиент вводит модальный цикл, который может обходить фильтрацию сообщений в собственном цикле обработки сообщений приложения.</span><span class="sxs-lookup"><span data-stu-id="7740c-241">Also, synchronous transactions cause the client to enter a modal loop that could bypass message filtering in the application's own message loop.</span></span>

<span data-ttu-id="7740c-242">Если клиент установил процедуру-обработчик для фильтрации сообщений (то есть при указании \_ типа обработчика мсгфилтер в вызове функции [**сетвиндовшукекс**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) ), синхронная транзакция не будет приводить к тому, что система обходит процедуру обработчика.</span><span class="sxs-lookup"><span data-stu-id="7740c-242">If the client has installed a hook procedure to filter messages (that is, specified the WH\_MSGFILTER hook type in a call to the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function), a synchronous transaction will not cause the system to bypass the hook procedure.</span></span> <span data-ttu-id="7740c-243">При возникновении входного события, когда клиент ожидает завершения синхронной транзакции, процедура-обработчик получает \_ код обработчика мсгф ддемгр.</span><span class="sxs-lookup"><span data-stu-id="7740c-243">When an input event occurs while the client is waiting for a synchronous transaction to end, the hook procedure receives an MSGF\_DDEMGR hook code.</span></span> <span data-ttu-id="7740c-244">Основной опасность использования модального цикла синхронных транзакций заключается в том, что модальный цикл, созданный с помощью диалогового окна, может повлиять на работу.</span><span class="sxs-lookup"><span data-stu-id="7740c-244">The main danger of using a synchronous transaction modal loop is that a modal loop created by a dialog box can interfere with its operation.</span></span> <span data-ttu-id="7740c-245">Асинхронные транзакции всегда следует использовать, если ДДЕМЛ используется библиотекой DLL.</span><span class="sxs-lookup"><span data-stu-id="7740c-245">Asynchronous transactions should always be used when the DDEML is being used by a DLL.</span></span>

## <a name="transaction-control"></a><span data-ttu-id="7740c-246">Управление транзакциями</span><span class="sxs-lookup"><span data-stu-id="7740c-246">Transaction Control</span></span>

<span data-ttu-id="7740c-247">Приложение может приостанавливать транзакции обратного вызова по протоколу DDE либо из транзакций, связанных с конкретным обработчиком диалога, либо для всех транзакций независимо от обработчика диалога.</span><span class="sxs-lookup"><span data-stu-id="7740c-247">An application can suspend transactions to its DDE callback function   either those transactions associated with a specific conversation handle or all transactions regardless of the conversation handle.</span></span> <span data-ttu-id="7740c-248">Эта возможность полезна, когда приложение получает транзакцию, требующую длительной обработки.</span><span class="sxs-lookup"><span data-stu-id="7740c-248">This capability is useful when an application receives a transaction that requires lengthy processing.</span></span> <span data-ttu-id="7740c-249">В этом случае приложение может вернуть \_ код возврата блока CBR, чтобы приостановить будущие транзакции, связанные с маркером диалога транзакции, чтобы приложение было свободно обрабатывать другие диалоги.</span><span class="sxs-lookup"><span data-stu-id="7740c-249">In such a case, the application can return the CBR\_BLOCK return code to suspend future transactions associated with the transaction's conversation handle, so that the application is free to process other conversations.</span></span>

<span data-ttu-id="7740c-250">После завершения обработки приложение вызывает функцию [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback) для возобновления транзакций, связанных с приостановленным диалогом.</span><span class="sxs-lookup"><span data-stu-id="7740c-250">When processing has been completed, the application calls the [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback) function to resume transactions associated with the suspended conversation.</span></span> <span data-ttu-id="7740c-251">Вызов **ддинаблекаллбакк** приводит к повторной отправке ддемл транзакции, которая привела к приостановке диалога приложением.</span><span class="sxs-lookup"><span data-stu-id="7740c-251">Calling **DdeEnableCallback** causes the DDEML to resend the transaction that resulted in the application suspending the conversation.</span></span> <span data-ttu-id="7740c-252">Поэтому приложение должно сохранить результат транзакции таким образом, чтобы он мог получить и вернуть результат без повторной обработки транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-252">Therefore, the application should store the result of the transaction in such a way that it can obtain and return the result without reprocessing the transaction.</span></span>

<span data-ttu-id="7740c-253">Приложение может приостановить все транзакции, связанные с конкретным обработчиком диалога, указав в \_ вызове [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback)маркер и флаг EC Disable.</span><span class="sxs-lookup"><span data-stu-id="7740c-253">An application can suspend all transactions associated with a specific conversation handle by specifying the handle and the EC\_DISABLE flag in a call to [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span></span> <span data-ttu-id="7740c-254">При указании маркера **null** приложение может приостановить все транзакции для всех диалогов.</span><span class="sxs-lookup"><span data-stu-id="7740c-254">By specifying a **NULL** handle, an application can suspend all transactions for all conversations.</span></span>

<span data-ttu-id="7740c-255">При приостановке диалога ДДЕМЛ сохраняет транзакции для диалога в очереди транзакций.</span><span class="sxs-lookup"><span data-stu-id="7740c-255">When a conversation has been suspended, the DDEML saves transactions for the conversation in a transaction queue.</span></span> <span data-ttu-id="7740c-256">Когда приложение повторно включает диалог, ДДЕМЛ удаляет сохраненные транзакции из очереди и передает каждую транзакцию в соответствующую функцию обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="7740c-256">When the application reenables the conversation, the DDEML removes the saved transactions from the queue and passes each transaction to the appropriate callback function.</span></span> <span data-ttu-id="7740c-257">Емкость очереди транзакций велика, но приложение должно повторно включить отложенный диалог как можно скорее, чтобы избежать потери транзакций.</span><span class="sxs-lookup"><span data-stu-id="7740c-257">The capacity of the transaction queue is large, but an application should reenable a suspended conversation as soon as possible to avoid losing transactions.</span></span>

<span data-ttu-id="7740c-258">Приложение может возобновить нормальную обработку транзакций, указав \_ флаг EC енаблеалл в [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span><span class="sxs-lookup"><span data-stu-id="7740c-258">An application can resume usual transaction processing by specifying the EC\_ENABLEALL flag in [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span></span> <span data-ttu-id="7740c-259">Для более контролируемого возобновления обработки транзакций в приложении можно указать \_ флаг EC енаблеоне.</span><span class="sxs-lookup"><span data-stu-id="7740c-259">For a more controlled resumption of transaction processing, the application can specify the EC\_ENABLEONE flag.</span></span> <span data-ttu-id="7740c-260">Этот флаг удаляет одну транзакцию из очереди транзакций и передает ее в соответствующую функцию обратного вызова. После обработки транзакции все диалоги снова отключаются.</span><span class="sxs-lookup"><span data-stu-id="7740c-260">This flag removes one transaction from the transaction queue and passes it to the appropriate callback function; after that transaction has been processed, any conversations are again disabled.</span></span>

<span data-ttu-id="7740c-261">Если флаг EC \_ енаблеоне и обработчик диалога указаны в вызове [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback), только этот диалог блокируется после обработки транзакции.</span><span class="sxs-lookup"><span data-stu-id="7740c-261">If the EC\_ENABLEONE flag and a conversation handle are specified in the call to [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback), only that conversation is blocked after the transaction has been processed.</span></span> <span data-ttu-id="7740c-262">Если задан **нулевой** обработчик диалога, все диалоги блокируются после обработки транзакции в любом диалоге.</span><span class="sxs-lookup"><span data-stu-id="7740c-262">If a **NULL** conversation handle is specified, all conversations are blocked after a transaction has been processed in any conversation.</span></span>

## <a name="transaction-classes"></a><span data-ttu-id="7740c-263">Классы транзакций</span><span class="sxs-lookup"><span data-stu-id="7740c-263">Transaction Classes</span></span>

<span data-ttu-id="7740c-264">ДДЕМЛ имеет четыре класса транзакций.</span><span class="sxs-lookup"><span data-stu-id="7740c-264">The DDEML has four classes of transactions.</span></span> <span data-ttu-id="7740c-265">Каждый класс определяется константой, которая начинается с \_ префикса кскласс.</span><span class="sxs-lookup"><span data-stu-id="7740c-265">Each class is identified by a constant that begins with the XCLASS\_ prefix.</span></span> <span data-ttu-id="7740c-266">Классы определяются в файле заголовка ДДЕМЛ.</span><span class="sxs-lookup"><span data-stu-id="7740c-266">The classes are defined in the DDEML header file.</span></span> <span data-ttu-id="7740c-267">Значение класса объединяется со значением типа транзакции и передается функции обратного вызова DDE принимающего приложения.</span><span class="sxs-lookup"><span data-stu-id="7740c-267">The class value is combined with the transaction-type value and is passed to the DDE callback function of the receiving application.</span></span>

<span data-ttu-id="7740c-268">Класс транзакции определяет возвращаемое значение, которое функция обратного вызова должна возвращать, если обрабатывает транзакцию.</span><span class="sxs-lookup"><span data-stu-id="7740c-268">A transaction's class determines the return value that a callback function is expected to return if it processes the transaction.</span></span> <span data-ttu-id="7740c-269">Следующие возвращаемые значения и типы транзакций связаны с каждым из четырех классов транзакций.</span><span class="sxs-lookup"><span data-stu-id="7740c-269">The following return values and transaction types are associated with each of the four transaction classes.</span></span>



| <span data-ttu-id="7740c-270">Класс</span><span class="sxs-lookup"><span data-stu-id="7740c-270">Class</span></span>                | <span data-ttu-id="7740c-271">Возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="7740c-271">Return value</span></span>                                                     | <span data-ttu-id="7740c-272">Транзакция</span><span class="sxs-lookup"><span data-stu-id="7740c-272">Transaction</span></span>                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------|------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7740c-273">\_bool кскласс</span><span class="sxs-lookup"><span data-stu-id="7740c-273">XCLASS\_BOOL</span></span>         | <span data-ttu-id="7740c-274">**True** или **false**</span><span class="sxs-lookup"><span data-stu-id="7740c-274">**TRUE** or **FALSE**</span></span>                                            | [<span data-ttu-id="7740c-275">**КСТИП \_ адвстарт**</span><span class="sxs-lookup"><span data-stu-id="7740c-275">**XTYP\_ADVSTART**</span></span>](xtyp-advstart.md)<br/> [<span data-ttu-id="7740c-276">**КСТИП \_ подключение**</span><span class="sxs-lookup"><span data-stu-id="7740c-276">**XTYP\_CONNECT**</span></span>](xtyp-connect.md)<br/>                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="7740c-277">\_данные кскласс</span><span class="sxs-lookup"><span data-stu-id="7740c-277">XCLASS\_DATA</span></span>         | <span data-ttu-id="7740c-278">Маркер данных, \_ код возврата блока CBR или **значение NULL** .</span><span class="sxs-lookup"><span data-stu-id="7740c-278">A data handle, the CBR\_BLOCK return code, or **NULL**</span></span>           | [<span data-ttu-id="7740c-279">**КСТИП \_ Адврек**</span><span class="sxs-lookup"><span data-stu-id="7740c-279">**XTYP\_ADVREQ**</span></span>](xtyp-advreq.md)<br/> [<span data-ttu-id="7740c-280">**\_запрос кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-280">**XTYP\_REQUEST**</span></span>](xtyp-request.md)<br/> [<span data-ttu-id="7740c-281">**КСТИП \_ вилдконнект**</span><span class="sxs-lookup"><span data-stu-id="7740c-281">**XTYP\_WILDCONNECT**</span></span>](xtyp-wildconnect.md)<br/>                                                                                                                                                                                                                                       |
| <span data-ttu-id="7740c-282">\_Флаги кскласс</span><span class="sxs-lookup"><span data-stu-id="7740c-282">XCLASS\_FLAGS</span></span>        | <span data-ttu-id="7740c-283">Флаг транзакции: DDE \_ факк, DDE \_ ФБУСИ или DDE \_ фнотпроцессед</span><span class="sxs-lookup"><span data-stu-id="7740c-283">A transaction flag: DDE\_FACK, DDE\_FBUSY, or DDE\_FNOTPROCESSED</span></span> | [<span data-ttu-id="7740c-284">**КСТИП \_ адвдата**</span><span class="sxs-lookup"><span data-stu-id="7740c-284">**XTYP\_ADVDATA**</span></span>](xtyp-advdata.md)<br/> [<span data-ttu-id="7740c-285">**\_выполнение кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-285">**XTYP\_EXECUTE**</span></span>](xtyp-execute.md)<br/> [<span data-ttu-id="7740c-286">**КСТИП \_**</span><span class="sxs-lookup"><span data-stu-id="7740c-286">**XTYP\_POKE**</span></span>](xtyp-poke.md)<br/>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="7740c-287">\_уведомление кскласс</span><span class="sxs-lookup"><span data-stu-id="7740c-287">XCLASS\_NOTIFICATION</span></span> | <span data-ttu-id="7740c-288">Нет</span><span class="sxs-lookup"><span data-stu-id="7740c-288">None</span></span>                                                             | [<span data-ttu-id="7740c-289">**КСТИП \_ адвстоп**</span><span class="sxs-lookup"><span data-stu-id="7740c-289">**XTYP\_ADVSTOP**</span></span>](xtyp-advstop.md)<br/> [<span data-ttu-id="7740c-290">**\_подтверждение подключения \_ кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-290">**XTYP\_CONNECT\_CONFIRM**</span></span>](xtyp-connect-confirm.md)<br/> [<span data-ttu-id="7740c-291">**КСТИП \_ Отключение**</span><span class="sxs-lookup"><span data-stu-id="7740c-291">**XTYP\_DISCONNECT**</span></span>](xtyp-disconnect.md)<br/> [<span data-ttu-id="7740c-292">**КСТИП, \_ Ошибка**</span><span class="sxs-lookup"><span data-stu-id="7740c-292">**XTYP\_ERROR**</span></span>](xtyp-error.md)<br/> [<span data-ttu-id="7740c-293">**КСТИП \_ регистр**</span><span class="sxs-lookup"><span data-stu-id="7740c-293">**XTYP\_REGISTER**</span></span>](xtyp-register.md)<br/> [<span data-ttu-id="7740c-294">**\_Отмена регистрации кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-294">**XTYP\_UNREGISTER**</span></span>](xtyp-unregister.md)<br/> [<span data-ttu-id="7740c-295">**\_ \_ Завершено транзакций кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-295">**XTYP\_XACT\_COMPLETE**</span></span>](xtyp-xact-complete.md)<br/> |



 

## <a name="transaction-types"></a><span data-ttu-id="7740c-296">Типы транзакций</span><span class="sxs-lookup"><span data-stu-id="7740c-296">Transaction Types</span></span>

<span data-ttu-id="7740c-297">Каждый тип транзакции DDE имеет приемник и связанное действие, которое приводит к тому, что ДДЕМЛ создает каждый тип.</span><span class="sxs-lookup"><span data-stu-id="7740c-297">Each DDE transaction type has a receiver and an associated activity that causes the DDEML to generate each type.</span></span>



| <span data-ttu-id="7740c-298">Тип транзакции</span><span class="sxs-lookup"><span data-stu-id="7740c-298">Transaction type</span></span>                                       | <span data-ttu-id="7740c-299">Получатель</span><span class="sxs-lookup"><span data-stu-id="7740c-299">Receiver</span></span>                   | <span data-ttu-id="7740c-300">Причина</span><span class="sxs-lookup"><span data-stu-id="7740c-300">Cause</span></span>                                                                                                                                                                         |
|--------------------------------------------------------|----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="7740c-301">**КСТИП \_ адвдата**</span><span class="sxs-lookup"><span data-stu-id="7740c-301">**XTYP\_ADVDATA**</span></span>](xtyp-advdata.md)                  | <span data-ttu-id="7740c-302">Клиент</span><span class="sxs-lookup"><span data-stu-id="7740c-302">Client</span></span>                     | <span data-ttu-id="7740c-303">Сервер ответил на транзакцию [**\_ Адврек кстип**](xtyp-advreq.md) , возвращая маркер данных.</span><span class="sxs-lookup"><span data-stu-id="7740c-303">A server responded to an [**XTYP\_ADVREQ**](xtyp-advreq.md) transaction by returning a data handle.</span></span>                                                                          |
| [<span data-ttu-id="7740c-304">**КСТИП \_ Адврек**</span><span class="sxs-lookup"><span data-stu-id="7740c-304">**XTYP\_ADVREQ**</span></span>](xtyp-advreq.md)                    | <span data-ttu-id="7740c-305">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-305">Server</span></span>                     | <span data-ttu-id="7740c-306">Сервер, именуемый функцией [**ддепостадвисе**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) , указывающий, что значение элемента данных в цикле рекомендаций было изменено.</span><span class="sxs-lookup"><span data-stu-id="7740c-306">A server called the [**DdePostAdvise**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) function, indicating that the value of a data item in an advise loop had changed.</span></span>                                  |
| [<span data-ttu-id="7740c-307">**КСТИП \_ адвстарт**</span><span class="sxs-lookup"><span data-stu-id="7740c-307">**XTYP\_ADVSTART**</span></span>](xtyp-advstart.md)                | <span data-ttu-id="7740c-308">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-308">Server</span></span>                     | <span data-ttu-id="7740c-309">Клиент указал тип транзакции [**кстип \_ адвстарт**](xtyp-advstart.md) в вызове функции [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) .</span><span class="sxs-lookup"><span data-stu-id="7740c-309">A client specified the [**XTYP\_ADVSTART**](xtyp-advstart.md) transaction type in a call to the [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) function.</span></span>               |
| [<span data-ttu-id="7740c-310">**КСТИП \_ адвстоп**</span><span class="sxs-lookup"><span data-stu-id="7740c-310">**XTYP\_ADVSTOP**</span></span>](xtyp-advstop.md)                  | <span data-ttu-id="7740c-311">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-311">Server</span></span>                     | <span data-ttu-id="7740c-312">Клиент указал тип транзакции [**кстип \_ адвстоп**](xtyp-advstop.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-312">A client specified the [**XTYP\_ADVSTOP**](xtyp-advstop.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                              |
| [<span data-ttu-id="7740c-313">**КСТИП \_ подключение**</span><span class="sxs-lookup"><span data-stu-id="7740c-313">**XTYP\_CONNECT**</span></span>](xtyp-connect.md)                  | <span data-ttu-id="7740c-314">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-314">Server</span></span>                     | <span data-ttu-id="7740c-315">Клиент вызывает функцию [**ддеконнект**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) и указал имя службы и имя раздела, поддерживаемые сервером.</span><span class="sxs-lookup"><span data-stu-id="7740c-315">A client called the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) function and specified a service name and topic name supported by the server.</span></span>                                            |
| [<span data-ttu-id="7740c-316">**\_подтверждение подключения \_ кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-316">**XTYP\_CONNECT\_CONFIRM**</span></span>](xtyp-connect-confirm.md) | <span data-ttu-id="7740c-317">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-317">Server</span></span>                     | <span data-ttu-id="7740c-318">Сервер вернул **значение true** в ответ на транзакцию [**Кстип \_ Connect**](xtyp-connect.md) или [**кстип \_ вилдконнект**](xtyp-wildconnect.md) .</span><span class="sxs-lookup"><span data-stu-id="7740c-318">The server returned **TRUE** in response to an [**XTYP\_CONNECT**](xtyp-connect.md) or [**XTYP\_WILDCONNECT**](xtyp-wildconnect.md) transaction.</span></span>                            |
| [<span data-ttu-id="7740c-319">**КСТИП \_ Отключение**</span><span class="sxs-lookup"><span data-stu-id="7740c-319">**XTYP\_DISCONNECT**</span></span>](xtyp-disconnect.md)            | <span data-ttu-id="7740c-320">Клиентская/серверная библиотека</span><span class="sxs-lookup"><span data-stu-id="7740c-320">Client/Server</span></span>              | <span data-ttu-id="7740c-321">Участник в диалоге, именуемый функцией [**ддедисконнект**](/windows/desktop/api/Ddeml/nf-ddeml-ddedisconnect) , в результате чего оба участника получают эту транзакцию.</span><span class="sxs-lookup"><span data-stu-id="7740c-321">A partner in a conversation called the [**DdeDisconnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddedisconnect) function, causing both partners to receive this transaction.</span></span>                                    |
| [<span data-ttu-id="7740c-322">**КСТИП, \_ Ошибка**</span><span class="sxs-lookup"><span data-stu-id="7740c-322">**XTYP\_ERROR**</span></span>](xtyp-error.md)                      | <span data-ttu-id="7740c-323">Клиентская/серверная библиотека</span><span class="sxs-lookup"><span data-stu-id="7740c-323">Client/Server</span></span>              | <span data-ttu-id="7740c-324">Произошла критическая ошибка.</span><span class="sxs-lookup"><span data-stu-id="7740c-324">A critical error has occurred.</span></span> <span data-ttu-id="7740c-325">Возможно, у ДДЕМЛ недостаточно ресурсов для продолжения.</span><span class="sxs-lookup"><span data-stu-id="7740c-325">The DDEML may not have sufficient resources to continue.</span></span>                                                                                       |
| [<span data-ttu-id="7740c-326">**\_выполнение кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-326">**XTYP\_EXECUTE**</span></span>](xtyp-execute.md)                  | <span data-ttu-id="7740c-327">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-327">Server</span></span>                     | <span data-ttu-id="7740c-328">Клиент указал тип [**\_ выполнения транзакции кстип**](xtyp-execute.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-328">A client specified the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                              |
| [<span data-ttu-id="7740c-329">**\_монитор кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-329">**XTYP\_MONITOR**</span></span>](xtyp-monitor.md)                  | <span data-ttu-id="7740c-330">Приложение мониторинга DDE</span><span class="sxs-lookup"><span data-stu-id="7740c-330">DDE monitoring application</span></span> | <span data-ttu-id="7740c-331">В системе произошло событие DDE.</span><span class="sxs-lookup"><span data-stu-id="7740c-331">A DDE event occurred in the system.</span></span> <span data-ttu-id="7740c-332">Дополнительные сведения о приложениях мониторинга DDE см. в разделе [мониторинг приложений](monitoring-applications.md).</span><span class="sxs-lookup"><span data-stu-id="7740c-332">For more information about DDE monitoring applications, see [Monitoring Applications](monitoring-applications.md).</span></span>                       |
| [<span data-ttu-id="7740c-333">**КСТИП \_**</span><span class="sxs-lookup"><span data-stu-id="7740c-333">**XTYP\_POKE**</span></span>](xtyp-poke.md)                        | <span data-ttu-id="7740c-334">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-334">Server</span></span>                     | <span data-ttu-id="7740c-335">Клиент указал тип транзакции [**кстип \_**](xtyp-poke.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-335">A client specified the [**XTYP\_POKE**](xtyp-poke.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                                    |
| [<span data-ttu-id="7740c-336">**КСТИП \_ регистр**</span><span class="sxs-lookup"><span data-stu-id="7740c-336">**XTYP\_REGISTER**</span></span>](xtyp-register.md)                | <span data-ttu-id="7740c-337">Клиентская/серверная библиотека</span><span class="sxs-lookup"><span data-stu-id="7740c-337">Client/Server</span></span>              | <span data-ttu-id="7740c-338">Серверное приложение использовало функцию [**дденамесервице**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) для регистрации имени службы.</span><span class="sxs-lookup"><span data-stu-id="7740c-338">A server application used the [**DdeNameService**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) function to register a service name.</span></span>                                                                   |
| [<span data-ttu-id="7740c-339">**\_запрос кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-339">**XTYP\_REQUEST**</span></span>](xtyp-request.md)                  | <span data-ttu-id="7740c-340">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-340">Server</span></span>                     | <span data-ttu-id="7740c-341">Клиент указал тип транзакции [**\_ запроса кстип**](xtyp-request.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="7740c-341">A client specified the [**XTYP\_REQUEST**](xtyp-request.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                              |
| [<span data-ttu-id="7740c-342">**\_Отмена регистрации кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-342">**XTYP\_UNREGISTER**</span></span>](xtyp-unregister.md)            | <span data-ttu-id="7740c-343">Клиентская/серверная библиотека</span><span class="sxs-lookup"><span data-stu-id="7740c-343">Client/Server</span></span>              | <span data-ttu-id="7740c-344">Серверное приложение, использующее [**дденамесервице**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) для отмены регистрации имени службы.</span><span class="sxs-lookup"><span data-stu-id="7740c-344">A server application used [**DdeNameService**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) to unregister a service name.</span></span>                                                                              |
| [<span data-ttu-id="7740c-345">**КСТИП \_ вилдконнект**</span><span class="sxs-lookup"><span data-stu-id="7740c-345">**XTYP\_WILDCONNECT**</span></span>](xtyp-wildconnect.md)          | <span data-ttu-id="7740c-346">Сервер</span><span class="sxs-lookup"><span data-stu-id="7740c-346">Server</span></span>                     | <span data-ttu-id="7740c-347">Клиент вызывает функцию [**ддеконнект**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) или [**Ддеконнектлист**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnectlist) , указывая **значение NULL** для имени службы, имени раздела или и того и другого.</span><span class="sxs-lookup"><span data-stu-id="7740c-347">A client called the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) or [**DdeConnectList**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnectlist) function, specifying **NULL** for the service name, the topic name, or both.</span></span> |
| [<span data-ttu-id="7740c-348">**\_ \_ Завершено транзакций кстип**</span><span class="sxs-lookup"><span data-stu-id="7740c-348">**XTYP\_XACT\_COMPLETE**</span></span>](xtyp-xact-complete.md)     | <span data-ttu-id="7740c-349">Клиент</span><span class="sxs-lookup"><span data-stu-id="7740c-349">Client</span></span>                     | <span data-ttu-id="7740c-350">Асинхронная транзакция, отправленная, когда клиент указал \_ асинхронный флаг timeout в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction), завершился.</span><span class="sxs-lookup"><span data-stu-id="7740c-350">An asynchronous transaction, sent when the client specified the TIMEOUT\_ASYNC flag in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction), has concluded.</span></span>         |



 

 

