---
description: Система отправляет \_ сообщение WM нкпаинт в окно всякий раз, когда часть неклиентской области окна, например строка заголовка, строка меню или рамка окна, должна быть обновлена.
ms.assetid: e4dc61f3-6a9f-4ed4-8685-62eb4ceb85f1
title: Неклиентская область
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c51da31709f5bd9326cc0d05a9e37e2df78bfbb4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263665"
---
# <a name="nonclient-area"></a><span data-ttu-id="fe591-103">Неклиентская область</span><span class="sxs-lookup"><span data-stu-id="fe591-103">Nonclient Area</span></span>

<span data-ttu-id="fe591-104">Система отправляет сообщение [**WM \_ нкпаинт**](wm-ncpaint.md) в окно всякий раз, когда часть неклиентской области окна, например строка заголовка, строка меню или рамка окна, должна быть обновлена.</span><span class="sxs-lookup"><span data-stu-id="fe591-104">The system sends a [**WM\_NCPAINT**](wm-ncpaint.md) message to the window whenever a part of the nonclient area of the window, such as the title bar, menu bar, or window frame, must be updated.</span></span> <span data-ttu-id="fe591-105">Система также может отсылать другие сообщения, чтобы направлять окно для обновления части его клиентской области. Например, когда окно станет активным или неактивным, оно отправляет сообщение [**WM \_ нкактивате**](../winmsg/wm-ncactivate.md) , чтобы обновить заголовок окна.</span><span class="sxs-lookup"><span data-stu-id="fe591-105">The system may also send other messages to direct a window to update a portion of its client area; for example, when a window becomes active or inactive, it sends the [**WM\_NCACTIVATE**](../winmsg/wm-ncactivate.md) message to update its title bar.</span></span> <span data-ttu-id="fe591-106">Как правило, обработка этих сообщений для стандартных окон не рекомендуется, так как приложение должно иметь возможность рисовать все необходимые части неклиентской области для окна.</span><span class="sxs-lookup"><span data-stu-id="fe591-106">In general, processing these messages for standard windows is not recommended, because the application must be able to draw all the required parts of the nonclient area for the window.</span></span> <span data-ttu-id="fe591-107">По этой причине большинство приложений передают эти сообщения [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) для обработки по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="fe591-107">For this reason, most applications pass these messages to [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) for default processing.</span></span>

<span data-ttu-id="fe591-108">Приложение, которое создает пользовательские области, не являющиеся клиентскими, должно обрабатывать эти сообщения.</span><span class="sxs-lookup"><span data-stu-id="fe591-108">An application that creates custom nonclient areas for its windows must process these messages.</span></span> <span data-ttu-id="fe591-109">При этом приложение должно использовать контекст устройства окна для выполнения рисования в окне.</span><span class="sxs-lookup"><span data-stu-id="fe591-109">When doing so, the application must use a window device context to carry out drawing in the window.</span></span> <span data-ttu-id="fe591-110">*Контекст устройства Window* позволяет приложению рисовать во всех частях окна, включая неклиентскую область.</span><span class="sxs-lookup"><span data-stu-id="fe591-110">The *window device context* enables the application to draw in all portions of the window, including the nonclient area.</span></span> <span data-ttu-id="fe591-111">Приложение получает контекст устройства окна с помощью функции [**жетвиндовдк**](/windows/desktop/api/Winuser/nf-winuser-getwindowdc) или [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) и, когда рисование завершено, должно освободить контекст окна устройства с помощью функции [**релеаседк**](/windows/desktop/api/Winuser/nf-winuser-releasedc) .</span><span class="sxs-lookup"><span data-stu-id="fe591-111">An application retrieves a window device context by using the [**GetWindowDC**](/windows/desktop/api/Winuser/nf-winuser-getwindowdc) or [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) function and, when drawing is complete, must release the window device context by using the [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) function.</span></span>

<span data-ttu-id="fe591-112">Система поддерживает регион обновления для неклиентской области.</span><span class="sxs-lookup"><span data-stu-id="fe591-112">The system maintains an update region for the nonclient area.</span></span> <span data-ttu-id="fe591-113">Когда приложение получает сообщение [**WM \_ нкпаинт**](wm-ncpaint.md) , параметр *wParam* содержит маркер для региона, определяющего размеры области обновления.</span><span class="sxs-lookup"><span data-stu-id="fe591-113">When an application receives a [**WM\_NCPAINT**](wm-ncpaint.md) message, the *wParam* parameter contains a handle to a region defining the dimensions of the update region.</span></span> <span data-ttu-id="fe591-114">Приложение может использовать этот маркер для объединения области обновления с областью отсечения для контекста устройства окна.</span><span class="sxs-lookup"><span data-stu-id="fe591-114">The application can use the handle to combine the update region with the clipping region for the window device context.</span></span> <span data-ttu-id="fe591-115">Система не будет автоматически объединять область обновления при получении контекста устройства окна, если приложение не использует [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) и не задает как маркер региона, так и флаг дккс \_ интерсектргн.</span><span class="sxs-lookup"><span data-stu-id="fe591-115">The system does not automatically combine the update region when retrieving the window device context unless the application uses [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) and specifies both the region handle and the DCX\_INTERSECTRGN flag.</span></span> <span data-ttu-id="fe591-116">Если приложение не объединяет область обновления, то обрезаются только операции рисования, которые в противном случае выходят за пределы окна.</span><span class="sxs-lookup"><span data-stu-id="fe591-116">If the application does not combine the update region, only drawing operations that would otherwise extend outside the window are clipped.</span></span> <span data-ttu-id="fe591-117">Приложение не несет ответственности за очистку региона обновления, независимо от того, использует ли он регион.</span><span class="sxs-lookup"><span data-stu-id="fe591-117">The application is not responsible for clearing the update region, regardless of whether it uses the region.</span></span>

<span data-ttu-id="fe591-118">Если приложение обрабатывает сообщение [**WM \_ нкактивате**](../winmsg/wm-ncactivate.md) , после его обработки должно возвращаться **значение true** , чтобы система занаправляла изменение активного окна.</span><span class="sxs-lookup"><span data-stu-id="fe591-118">If an application processes the [**WM\_NCACTIVATE**](../winmsg/wm-ncactivate.md) message, after processing it must return **TRUE** to direct the system to complete the change of active window.</span></span> <span data-ttu-id="fe591-119">Если окно свернется, когда приложение получает сообщение **WM \_ нкактивате** , оно должно передавать сообщение в [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span><span class="sxs-lookup"><span data-stu-id="fe591-119">If the window is minimized when the application receives the **WM\_NCACTIVATE** message, it should pass the message to [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span></span> <span data-ttu-id="fe591-120">В таких случаях функция по умолчанию перерисовывает метку для значка.</span><span class="sxs-lookup"><span data-stu-id="fe591-120">In such cases, the default function redraws the label for the icon.</span></span>

 

 
