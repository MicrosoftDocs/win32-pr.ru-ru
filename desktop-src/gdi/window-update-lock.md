---
description: Блокировка обновления окна — это временная приостановка рисования в окне.
ms.assetid: 92b1ba04-ff79-4a37-9633-99412cdafe95
title: Блокировка обновления окна
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4897915020134387947c7a77009c4bdbd63cfdd6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264122"
---
# <a name="window-update-lock"></a>Блокировка обновления окна

*Блокировка обновления окна* — это временная приостановка рисования в окне. Система использует блокировку, чтобы другие окна не нарисованы на прямоугольнике отслеживания всякий раз, когда пользователь перемещает или изменяет размеры окна. Приложения могут использовать блокировку для предотвращения рисования, если они выполняют аналогичные операции перемещения или изменения размера с собственными окнами.

Приложение использует функцию [**локквиндовупдате**](/windows/desktop/api/Winuser/nf-winuser-lockwindowupdate) , чтобы установить или очистить блокировку обновления окна, указав окно для блокировки. Блокировка применяется к указанному окну и всем его дочерним окнам. После установки блокировки функции [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) и [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) возвращают контекст отображаемого устройства с видимой областью, которая является пустой. Учитывая это, приложение может продолжать рисовать в окне, но все выходные данные обрезаются. Блокировка сохраняется до тех пор, пока приложение не очистит его путем вызова **локквиндовупдате**, указав **значение NULL** для окна. Несмотря на то что **локквиндовупдате** заставляет видимую область окна пустой, функция не делает указанное окно невидимым и не очищает \_ бит стиля, видимый WS.

После установки блокировки приложение может использовать функцию [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) со \_ значением дккс локквиндовупдате, чтобы получить контекст устройства отображения для рисования в заблокированном окне. Это позволяет приложению нарисовать прямоугольник отслеживания при обработке сообщений клавиатуры или мыши. Система использует этот метод, когда пользователь перемещает окна и размеры. **Жетдцекс** извлекает контекст устройства отображения из кэша контекста устройства отображения, поэтому приложение должно освободить контекст устройства как можно скорее после рисования.

Пока установлена блокировка обновления окна, система создает накопленный ограничивающий прямоугольник для каждого заблокированного окна. При снятии блокировки система использует этот ограничивающий прямоугольник, чтобы задать область обновления для окна и его дочерних окон, заставляя в конечном итоге сообщение [**WM \_ Paint**](wm-paint.md) . Если накопленный ограничивающий прямоугольник пуст (т. е. Если во время установки блокировки не происходило никакой прорисовки), то область обновления не задается.

 

 



