---
description: Блокировка обновления окна — это временная приостановка рисования в окне.
ms.assetid: 92b1ba04-ff79-4a37-9633-99412cdafe95
title: Блокировка обновления окна
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4897915020134387947c7a77009c4bdbd63cfdd6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264122"
---
# <a name="window-update-lock"></a><span data-ttu-id="a408b-103">Блокировка обновления окна</span><span class="sxs-lookup"><span data-stu-id="a408b-103">Window Update Lock</span></span>

<span data-ttu-id="a408b-104">*Блокировка обновления окна* — это временная приостановка рисования в окне.</span><span class="sxs-lookup"><span data-stu-id="a408b-104">A *window update lock* is a temporary suspension of drawing in a window.</span></span> <span data-ttu-id="a408b-105">Система использует блокировку, чтобы другие окна не нарисованы на прямоугольнике отслеживания всякий раз, когда пользователь перемещает или изменяет размеры окна.</span><span class="sxs-lookup"><span data-stu-id="a408b-105">The system uses the lock to prevent other windows from drawing over the tracking rectangle whenever the user moves or sizes a window.</span></span> <span data-ttu-id="a408b-106">Приложения могут использовать блокировку для предотвращения рисования, если они выполняют аналогичные операции перемещения или изменения размера с собственными окнами.</span><span class="sxs-lookup"><span data-stu-id="a408b-106">Applications can use the lock to prevent drawing if they carry out similar moving or sizing operations with their own windows.</span></span>

<span data-ttu-id="a408b-107">Приложение использует функцию [**локквиндовупдате**](/windows/desktop/api/Winuser/nf-winuser-lockwindowupdate) , чтобы установить или очистить блокировку обновления окна, указав окно для блокировки.</span><span class="sxs-lookup"><span data-stu-id="a408b-107">An application uses the [**LockWindowUpdate**](/windows/desktop/api/Winuser/nf-winuser-lockwindowupdate) function to set or clear a window update lock, specifying the window to lock.</span></span> <span data-ttu-id="a408b-108">Блокировка применяется к указанному окну и всем его дочерним окнам.</span><span class="sxs-lookup"><span data-stu-id="a408b-108">The lock applies to the specified window and all of its child windows.</span></span> <span data-ttu-id="a408b-109">После установки блокировки функции [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) и [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) возвращают контекст отображаемого устройства с видимой областью, которая является пустой.</span><span class="sxs-lookup"><span data-stu-id="a408b-109">When the lock is set, the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) and [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) functions return a display device context with a visible region that is empty.</span></span> <span data-ttu-id="a408b-110">Учитывая это, приложение может продолжать рисовать в окне, но все выходные данные обрезаются.</span><span class="sxs-lookup"><span data-stu-id="a408b-110">Given this, the application can continue to draw in the window, but all output is clipped.</span></span> <span data-ttu-id="a408b-111">Блокировка сохраняется до тех пор, пока приложение не очистит его путем вызова **локквиндовупдате**, указав **значение NULL** для окна.</span><span class="sxs-lookup"><span data-stu-id="a408b-111">The lock persists until the application clears it by calling **LockWindowUpdate**, specifying **NULL** for the window.</span></span> <span data-ttu-id="a408b-112">Несмотря на то что **локквиндовупдате** заставляет видимую область окна пустой, функция не делает указанное окно невидимым и не очищает \_ бит стиля, видимый WS.</span><span class="sxs-lookup"><span data-stu-id="a408b-112">Although **LockWindowUpdate** forces a window's visible region to be empty, the function does not make the specified window invisible and does not clear the WS\_VISIBLE style bit.</span></span>

<span data-ttu-id="a408b-113">После установки блокировки приложение может использовать функцию [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) со \_ значением дккс локквиндовупдате, чтобы получить контекст устройства отображения для рисования в заблокированном окне.</span><span class="sxs-lookup"><span data-stu-id="a408b-113">After the lock is set, the application can use the [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) function, with the DCX\_LOCKWINDOWUPDATE value, to retrieve a display device context to draw over the locked window.</span></span> <span data-ttu-id="a408b-114">Это позволяет приложению нарисовать прямоугольник отслеживания при обработке сообщений клавиатуры или мыши.</span><span class="sxs-lookup"><span data-stu-id="a408b-114">This allows the application to draw a tracking rectangle when processing keyboard or mouse messages.</span></span> <span data-ttu-id="a408b-115">Система использует этот метод, когда пользователь перемещает окна и размеры.</span><span class="sxs-lookup"><span data-stu-id="a408b-115">The system uses this method when the user moves and sizes windows.</span></span> <span data-ttu-id="a408b-116">**Жетдцекс** извлекает контекст устройства отображения из кэша контекста устройства отображения, поэтому приложение должно освободить контекст устройства как можно скорее после рисования.</span><span class="sxs-lookup"><span data-stu-id="a408b-116">**GetDCEx** retrieves the display device context from the display device context cache, so the application must release the device context as soon as possible after drawing.</span></span>

<span data-ttu-id="a408b-117">Пока установлена блокировка обновления окна, система создает накопленный ограничивающий прямоугольник для каждого заблокированного окна.</span><span class="sxs-lookup"><span data-stu-id="a408b-117">While a window update lock is set, the system creates an accumulated bounding rectangle for each locked window.</span></span> <span data-ttu-id="a408b-118">При снятии блокировки система использует этот ограничивающий прямоугольник, чтобы задать область обновления для окна и его дочерних окон, заставляя в конечном итоге сообщение [**WM \_ Paint**](wm-paint.md) .</span><span class="sxs-lookup"><span data-stu-id="a408b-118">When the lock is cleared, the system uses this bounding rectangle to set the update region for the window and its child windows, forcing an eventual [**WM\_PAINT**](wm-paint.md) message.</span></span> <span data-ttu-id="a408b-119">Если накопленный ограничивающий прямоугольник пуст (т. е. Если во время установки блокировки не происходило никакой прорисовки), то область обновления не задается.</span><span class="sxs-lookup"><span data-stu-id="a408b-119">If the accumulated bounding rectangle is empty (that is, if no drawing has occurred while the lock was set), the update region is not set.</span></span>

 

 



