---
description: Аппаратно-независимый точечный рисунок (DIB) содержит таблицу цветов.
ms.assetid: 56b39a3d-48a4-4620-9652-ec41ea4d6423
title: Device-Independent растровые изображения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1aa35201a9a27c2d16a5a18b0125d25a3938890c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155646"
---
# <a name="device-independent-bitmaps"></a><span data-ttu-id="6f991-103">Device-Independent растровые изображения</span><span class="sxs-lookup"><span data-stu-id="6f991-103">Device-Independent Bitmaps</span></span>

<span data-ttu-id="6f991-104">Аппаратно-независимый точечный рисунок (DIB) содержит *таблицу цветов*.</span><span class="sxs-lookup"><span data-stu-id="6f991-104">A device-independent bitmap (DIB) contains a *color table*.</span></span> <span data-ttu-id="6f991-105">Таблица цветов описывает, как значения пикселя соответствуют значениям цвета *RGB* , которые описывают цвета, создаваемые источником освещения.</span><span class="sxs-lookup"><span data-stu-id="6f991-105">A color table describes how pixel values correspond to *RGB* color values, which describe colors that are produced by emitting light.</span></span> <span data-ttu-id="6f991-106">Таким образом, рисунок DIB может обеспечить правильную цветовую схему на любом устройстве.</span><span class="sxs-lookup"><span data-stu-id="6f991-106">Thus, a DIB can achieve the proper color scheme on any device.</span></span> <span data-ttu-id="6f991-107">DIB содержит следующие сведения о цвете и измерении:</span><span class="sxs-lookup"><span data-stu-id="6f991-107">A DIB contains the following color and dimension information:</span></span>

-   <span data-ttu-id="6f991-108">Формат цвета устройства, на котором было создано прямоугольное изображение.</span><span class="sxs-lookup"><span data-stu-id="6f991-108">The color format of the device on which the rectangular image was created.</span></span>
-   <span data-ttu-id="6f991-109">Разрешение устройства, на котором было создано прямоугольное изображение.</span><span class="sxs-lookup"><span data-stu-id="6f991-109">The resolution of the device on which the rectangular image was created.</span></span>
-   <span data-ttu-id="6f991-110">Палитра для устройства, на котором было создано изображение.</span><span class="sxs-lookup"><span data-stu-id="6f991-110">The palette for the device on which the image was created.</span></span>
-   <span data-ttu-id="6f991-111">Массив битов, который сопоставляет красный, зеленый, синий ( [**RGB**](/windows/desktop/api/Wingdi/nf-wingdi-rgb) ) триады с пикселями прямоугольного изображения.</span><span class="sxs-lookup"><span data-stu-id="6f991-111">An array of bits that maps red, green, blue ( [**RGB**](/windows/desktop/api/Wingdi/nf-wingdi-rgb) ) triplets to pixels in the rectangular image.</span></span>
-   <span data-ttu-id="6f991-112">Идентификатор сжатия данных, который указывает схему сжатия данных (при ее наличии), используемую для уменьшения размера массива битов.</span><span class="sxs-lookup"><span data-stu-id="6f991-112">A data-compression identifier that indicates the data compression scheme (if any) used to reduce the size of the array of bits.</span></span>

<span data-ttu-id="6f991-113">Сведения о цвете и измерении хранятся в структуре [**битмапинфо**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) , состоящей из структуры [**битмапинфохеадер**](/previous-versions//dd183376(v=vs.85)) , за которой следуют две или более структуры [**ргбкуад**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) .</span><span class="sxs-lookup"><span data-stu-id="6f991-113">The color and dimension information is stored in a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure, which consists of a [**BITMAPINFOHEADER**](/previous-versions//dd183376(v=vs.85)) structure followed by two or more [**RGBQUAD**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) structures.</span></span> <span data-ttu-id="6f991-114">Структура **битмапинфохеадер** задает размеры пиксельного прямоугольника, описывает цветовую технологию устройства и определяет схемы сжатия, используемые для уменьшения размера точечного рисунка.</span><span class="sxs-lookup"><span data-stu-id="6f991-114">The **BITMAPINFOHEADER** structure specifies the dimensions of the pixel rectangle, describes the device's color technology, and identifies the compression schemes used to reduce the size of the bitmap.</span></span> <span data-ttu-id="6f991-115">Структуры **ргбкуад** указывают цвета, которые отображаются в прямоугольнике.</span><span class="sxs-lookup"><span data-stu-id="6f991-115">The **RGBQUAD** structures identify the colors that appear in the pixel rectangle.</span></span>

<span data-ttu-id="6f991-116">Существует два вида DIB:</span><span class="sxs-lookup"><span data-stu-id="6f991-116">There are two varieties of DIBs:</span></span>

-   <span data-ttu-id="6f991-117">Элемент DIB снизу вверх, в котором начало координат находится в левом нижнем углу.</span><span class="sxs-lookup"><span data-stu-id="6f991-117">A bottom-up DIB, in which the origin lies at the lower-left corner.</span></span>
-   <span data-ttu-id="6f991-118">Значение DIB сверху вниз, в котором начало координат находится в левом верхнем углу.</span><span class="sxs-lookup"><span data-stu-id="6f991-118">A top-down DIB, in which the origin lies at the upper-left corner.</span></span>

<span data-ttu-id="6f991-119">Если высота DIB, как указано элементом **Height** структуры заголовка сведений о точечных рисунках, является положительным значением, это будет элемент DIB с именем «снизу вверх». Если высота является отрицательным значением, то это элемент списка DIB.</span><span class="sxs-lookup"><span data-stu-id="6f991-119">If the height of a DIB, as indicated by the **Height** member of the bitmap information header structure, is a positive value, it is a bottom-up DIB; if the height is a negative value, it is a top-down DIB.</span></span> <span data-ttu-id="6f991-120">Не удается сжать файлы DIB, расположенные сверху вниз.</span><span class="sxs-lookup"><span data-stu-id="6f991-120">Top-down DIBs cannot be compressed.</span></span>

<span data-ttu-id="6f991-121">Цветовой формат задается в виде числа цветовых плоскостей и цветовых битов.</span><span class="sxs-lookup"><span data-stu-id="6f991-121">The color format is specified in terms of a count of color planes and color bits.</span></span> <span data-ttu-id="6f991-122">Число цветовых плоскостей всегда равно 1; число цветовых битов равно 1 для монохромных точечных рисунков, 4 для точечных рисунков VGA и 8, 16, 24 или 32 для точечных рисунков на других цветовых устройствах.</span><span class="sxs-lookup"><span data-stu-id="6f991-122">The count of color planes is always 1; the count of color bits is 1 for monochrome bitmaps, 4 for VGA bitmaps, and 8, 16, 24, or 32 for bitmaps on other color devices.</span></span> <span data-ttu-id="6f991-123">Приложение получает количество цветовых бит, используемых определенным дисплеем (или принтером), вызывая функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указывая битспиксел в качестве второго аргумента.</span><span class="sxs-lookup"><span data-stu-id="6f991-123">An application retrieves the number of color bits that a particular display (or printer) uses by calling the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying BITSPIXEL as the second argument.</span></span>

<span data-ttu-id="6f991-124">Разрешение отображаемого устройства задается в пикселях на единицу измерения.</span><span class="sxs-lookup"><span data-stu-id="6f991-124">The resolution of a display device is specified in pixels-per-meter.</span></span> <span data-ttu-id="6f991-125">Приложение может получить разрешение экрана или принтера по горизонтали, выполнив этот процесс в три этапа.</span><span class="sxs-lookup"><span data-stu-id="6f991-125">An application can retrieve the horizontal resolution for a video display, or printer, by following this three-step process.</span></span>

1.  <span data-ttu-id="6f991-126">Вызовите функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав хорзрес в качестве второго аргумента.</span><span class="sxs-lookup"><span data-stu-id="6f991-126">Call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying HORZRES as the second argument.</span></span>
2.  <span data-ttu-id="6f991-127">Вызовите [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) во второй раз, указав хорзсизе в качестве второго аргумента.</span><span class="sxs-lookup"><span data-stu-id="6f991-127">Call [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) a second time, specifying HORZSIZE as the second argument.</span></span>
3.  <span data-ttu-id="6f991-128">Разделить первое возвращаемое значение на второе возвращаемое значение.</span><span class="sxs-lookup"><span data-stu-id="6f991-128">Divide the first return value by the second return value.</span></span>

<span data-ttu-id="6f991-129">Приложение может получить разрешение по вертикали, используя один и тот же процесс из трех шагов с различными параметрами: вместо ВЕРТРЕС вместо ХОРЗРЕС и ВЕРТСИЗЕ вместо ХОРЗСИЗЕ.</span><span class="sxs-lookup"><span data-stu-id="6f991-129">The application can retrieve the vertical resolution by using the same three-step process with different parameters: VERTRES in place of HORZRES, and VERTSIZE in place of HORZSIZE.</span></span>

<span data-ttu-id="6f991-130">Палитра представляется массивом структур [**ргбкуад**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) , определяющих компоненты интенсивности красного, зеленого и синего для каждого цвета в цветовой палитре устройства показа.</span><span class="sxs-lookup"><span data-stu-id="6f991-130">The palette is represented by an array of [**RGBQUAD**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) structures that specify the red, green, and blue intensity components for each color in a display device's color palette.</span></span> <span data-ttu-id="6f991-131">Каждый цветовой индекс в массиве палитры сопоставляется с конкретным пикселем в прямоугольной области, связанной с точечным рисунком.</span><span class="sxs-lookup"><span data-stu-id="6f991-131">Each color index in the palette array maps to a specific pixel in the rectangular region associated with the bitmap.</span></span> <span data-ttu-id="6f991-132">Размер этого массива в битах эквивалентен ширине прямоугольника в пикселях, умноженной на высоту прямоугольника (в пикселях), умноженную на число цветовых битов для устройства.</span><span class="sxs-lookup"><span data-stu-id="6f991-132">The size of this array, in bits, is equivalent to the width of the rectangle, in pixels, multiplied by the height of the rectangle, in pixels, multiplied by the count of color bits for the device.</span></span> <span data-ttu-id="6f991-133">Приложение может получить размер палитры устройства, вызвав функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав нумколорс в качестве второго аргумента.</span><span class="sxs-lookup"><span data-stu-id="6f991-133">An application can retrieve the size of the device's palette by calling the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying NUMCOLORS as the second argument.</span></span>

<span data-ttu-id="6f991-134">Windows поддерживает сжатие массива палитры для 8-битовых и 4-битных рисунков DIB.</span><span class="sxs-lookup"><span data-stu-id="6f991-134">Windows supports the compression of the palette array for 8-bpp and 4-bpp bottom-up DIBs.</span></span> <span data-ttu-id="6f991-135">Эти массивы можно сжимать с помощью схемы кодирования длины выполнения (RLE).</span><span class="sxs-lookup"><span data-stu-id="6f991-135">These arrays can be compressed by using the run-length encoding (RLE) scheme.</span></span> <span data-ttu-id="6f991-136">Схема RLE использует 2-байтовые значения, первый байт, указывающий количество последовательных пикселов, использующих индекс цвета, и второй байт, указывающий индекс.</span><span class="sxs-lookup"><span data-stu-id="6f991-136">The RLE scheme uses 2-byte values, the first byte specifying the number of consecutive pixels that use a color index and the second byte specifying the index.</span></span> <span data-ttu-id="6f991-137">Дополнительные сведения о сжатии растровых изображений см. в описании структур [**битмапинфохеадер**](/previous-versions//dd183376(v=vs.85)), [**битмапфилехеадер**](/windows/win32/api/wingdi/ns-wingdi-bitmapfileheader), [**BITMAPV4HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv4header)и [**BITMAPV5HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv5header) .</span><span class="sxs-lookup"><span data-stu-id="6f991-137">For more information about bitmap compression, see the description of the [**BITMAPINFOHEADER**](/previous-versions//dd183376(v=vs.85)), [**BITMAPFILEHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapfileheader), [**BITMAPV4HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv4header), and [**BITMAPV5HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv5header) structures.</span></span>

<span data-ttu-id="6f991-138">Приложение может создать DIB из DDB, инициализируя необходимые структуры и вызывая функцию [**жетдибитс**](/windows/desktop/api/Wingdi/nf-wingdi-getdibits) .</span><span class="sxs-lookup"><span data-stu-id="6f991-138">An application can create a DIB from a DDB by initializing the required structures and calling the [**GetDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-getdibits) function.</span></span> <span data-ttu-id="6f991-139">Чтобы определить, поддерживает ли устройство эту функцию, вызовите функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав \_ битовую карту RC di в \_ качестве флага растеркапс.</span><span class="sxs-lookup"><span data-stu-id="6f991-139">To determine whether a device supports this function, call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying RC\_DI\_BITMAP as the RASTERCAPS flag.</span></span>

<span data-ttu-id="6f991-140">Приложение, которому требуется скопировать растровое изображение, может использовать [**транспарентблт**](/windows/desktop/api/WinGdi/nf-wingdi-transparentblt) для копирования всех пикселов исходного растрового изображения в целевое растровое изображение, за исключением тех точек, которые соответствуют прозрачному цвету.</span><span class="sxs-lookup"><span data-stu-id="6f991-140">An application that needs to copy a bitmap can use [**TransparentBlt**](/windows/desktop/api/WinGdi/nf-wingdi-transparentblt) to copy all pixels in a source bitmap to a destination bitmap except those pixels that match the transparent color.</span></span>

<span data-ttu-id="6f991-141">Приложение может использовать DIB для установки пикселов на устройстве вывода путем вызова функции [**сетдибитстодевице**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) или [**стретчдибитс**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits) .</span><span class="sxs-lookup"><span data-stu-id="6f991-141">An application can use a DIB to set pixels on the display device by calling the [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) or the [**StretchDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits) function.</span></span> <span data-ttu-id="6f991-142">Чтобы определить, поддерживает ли устройство функцию **сетдибитстодевице** , вызовите функцию [**ЖЕТДЕВИЦЕКАПС**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав RC \_ ДИБТОДЕВ в качестве флага растеркапс.</span><span class="sxs-lookup"><span data-stu-id="6f991-142">To determine whether a device supports the **SetDIBitsToDevice** function, call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying RC\_DIBTODEV as the RASTERCAPS flag.</span></span> <span data-ttu-id="6f991-143">Укажите RC \_ стретчдиб в качестве флага растеркапс, чтобы определить, поддерживает ли устройство **стретчдибитс**.</span><span class="sxs-lookup"><span data-stu-id="6f991-143">Specify RC\_STRETCHDIB as the RASTERCAPS flag to determine if the device supports **StretchDIBits**.</span></span>

<span data-ttu-id="6f991-144">Приложение, которое просто должно отобразить существующий DIB, может использовать функцию [**сетдибитстодевице**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) .</span><span class="sxs-lookup"><span data-stu-id="6f991-144">An application that simply needs to display a pre-existing DIB can use the [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) function.</span></span> <span data-ttu-id="6f991-145">Например, приложение электронной таблицы может открывать существующие диаграммы и отображать их в окне с помощью функции **сетдибитстодевице** .</span><span class="sxs-lookup"><span data-stu-id="6f991-145">For example, a spreadsheet application can open existing charts and display them in a window by using the **SetDIBitsToDevice** function.</span></span> <span data-ttu-id="6f991-146">Однако для многократного перерисовки растрового изображения в окне приложение должно использовать функцию [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) .</span><span class="sxs-lookup"><span data-stu-id="6f991-146">To repeatedly redraw a bitmap in a window, however, the application should use the [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) function.</span></span> <span data-ttu-id="6f991-147">Например, приложение для мультимедиа, объединяющее анимированную графику со звуком, получит преимущество от вызова функции **BitBlt** , так как она выполняется быстрее, чем **сетдибитстодевице**.</span><span class="sxs-lookup"><span data-stu-id="6f991-147">For example, a multimedia application that combines animated graphics with sound would benefit from calling the **BitBlt** function because it executes faster than **SetDIBitsToDevice**.</span></span>

 

 
