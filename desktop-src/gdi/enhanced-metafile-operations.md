---
description: 'Вы можете использовать этот маркер в расширенном метафайле для выполнения следующих задач:'
ms.assetid: 8f887c38-6cfa-4918-aa44-dd5fb837b40b
title: Операции расширенного метафайла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18ba9e2ac2f14c4436c039a66cc3211b471c0461
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155626"
---
# <a name="enhanced-metafile-operations"></a>Операции расширенного метафайла

Вы можете использовать этот маркер в расширенном метафайле для выполнения следующих задач:

-   Отобразить изображение, хранящееся в расширенном метафайле.
-   Создание копий расширенного метафайла.
-   Изменение расширенного метафайла.
-   Получите необязательное описание, хранящееся в расширенном метафайле.
-   Получение копии заголовка расширенного метафайла.
-   Получение двоичной версии расширенного метафайла.
-   Перечислите цвета в дополнительной палитре.

Эти задачи обсуждаются в разделах оставшейся части этого раздела.

## <a name="display-the-picture-stored-in-an-enhanced-metafile"></a>Отобразить изображение, хранящееся в расширенном метафайле

Изображение, хранящееся в расширенном метафайле, можно отобразить с помощью функции [**плайенхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) . Передайте функцию в расширенный метафайл, не отвлекаясь на формат расширенных записей метафайлов. Однако иногда желательно перечислить записи в расширенном метафайле, чтобы найти определенную функцию GDI и изменить параметры функции каким-либо образом. Для этого можно использовать [**енуменхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) и предоставить функцию обратного вызова [**енхметафилепрок**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc)для обработки расширенных записей метафайлов. Чтобы изменить параметры записи расширенного метафайла, необходимо иметь представление о формате параметров в записи.

## <a name="create-copies-of-an-enhanced-metafile"></a>Создание копий расширенного метафайла

Некоторые приложения создают временные копии файлов резервных копий (или дубликатов), прежде чем разрешить пользователю изменять исходный файл. Приложение может создать резервную копию расширенного метафайла, вызвав функцию [**копенхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) , предоставив маркер, определяющий расширенный метафайл, и указав указатель на имя нового файла.

Чтобы создать метафайл с расширенным форматом на основе памяти, вызовите функцию [**сетенхметафилебитс**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) .

## <a name="edit-an-enhanced-metafile"></a>Изменение расширенного метафайла

Большинство приложений для рисования, иллюстраций и программно-ориентированного проектирования (CAD) требует наличия средства редактирования изображения, хранящегося в расширенном метафайле. Хотя редактирование расширенного метафайла является сложной задачей, для предоставления этой возможности в приложении можно использовать функцию [**енуменхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) в сочетании с другими функциями. Функция **енуменхметафиле** и связанная с ней функция обратного вызова [**енхметафилепрок**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc)позволяют приложению обрабатывать отдельные записи в расширенном метафайле.

## <a name="retrieve-the-optional-description-stored-in-an-enhanced-metafile"></a>Извлечение необязательного описания, хранящегося в расширенном метафайле

Некоторые приложения отображают текстовое описание расширенного метафайла с соответствующим именем файла в диалоговом окне **Открыть** . Определить, существует ли эта строка в расширенном метафайле, можно путем получения заголовка Metafile с помощью функции [**жетенхметафилехеадер**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) и проверки одного из его членов. Если строка существует, приложение извлекает ее, вызывая функцию [**жетенхметафиледескриптион**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) .

## <a name="retrieve-a-binary-version-of-an-enhanced-metafile"></a>Получение двоичной версии расширенного метафайла

Содержимое метафайла можно получить, вызвав функцию [**жетенхметафилебитс**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) . Однако перед извлечением содержимого необходимо указать размер файла. Чтобы получить размер, можно использовать функцию [**жетенхметафилехеадер**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) и проверить соответствующий элемент.

## <a name="enumerate-the-colors-in-the-optional-palette"></a>Перечислить цвета в дополнительной палитре

Чтобы обеспечить согласованность цветов при отображении изображения на различных устройствах вывода, можно вызвать функцию [**креатепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) и сохранить логическую палитру в расширенном метафайле. Приложение, которое отображает изображение, хранящееся в расширенном метафайле, извлекает эту палитру и вызывает функцию [**реализепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) перед отображением изображения. Чтобы определить, хранится ли палитра в расширенном метафайле, извлеките заголовок метафайла и проверьте соответствующий элемент. Если палитра существует, можно вызвать функцию [**жетенхметафилепалеттинтриес**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) для получения логической палитры.

 

 
