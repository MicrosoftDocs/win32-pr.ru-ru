---
description: 'Вы можете использовать этот маркер в расширенном метафайле для выполнения следующих задач:'
ms.assetid: 8f887c38-6cfa-4918-aa44-dd5fb837b40b
title: Операции расширенного метафайла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18ba9e2ac2f14c4436c039a66cc3211b471c0461
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155626"
---
# <a name="enhanced-metafile-operations"></a><span data-ttu-id="1864e-103">Операции расширенного метафайла</span><span class="sxs-lookup"><span data-stu-id="1864e-103">Enhanced Metafile Operations</span></span>

<span data-ttu-id="1864e-104">Вы можете использовать этот маркер в расширенном метафайле для выполнения следующих задач:</span><span class="sxs-lookup"><span data-stu-id="1864e-104">You can use the handle to an enhanced metafile to accomplish the following tasks:</span></span>

-   <span data-ttu-id="1864e-105">Отобразить изображение, хранящееся в расширенном метафайле.</span><span class="sxs-lookup"><span data-stu-id="1864e-105">Display the picture stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="1864e-106">Создание копий расширенного метафайла.</span><span class="sxs-lookup"><span data-stu-id="1864e-106">Create copies of an enhanced metafile.</span></span>
-   <span data-ttu-id="1864e-107">Изменение расширенного метафайла.</span><span class="sxs-lookup"><span data-stu-id="1864e-107">Edit an enhanced metafile.</span></span>
-   <span data-ttu-id="1864e-108">Получите необязательное описание, хранящееся в расширенном метафайле.</span><span class="sxs-lookup"><span data-stu-id="1864e-108">Retrieve the optional description stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="1864e-109">Получение копии заголовка расширенного метафайла.</span><span class="sxs-lookup"><span data-stu-id="1864e-109">Retrieve a copy of an enhanced-metafile header.</span></span>
-   <span data-ttu-id="1864e-110">Получение двоичной версии расширенного метафайла.</span><span class="sxs-lookup"><span data-stu-id="1864e-110">Retrieve a binary version of an enhanced metafile.</span></span>
-   <span data-ttu-id="1864e-111">Перечислите цвета в дополнительной палитре.</span><span class="sxs-lookup"><span data-stu-id="1864e-111">Enumerate the colors in the optional palette.</span></span>

<span data-ttu-id="1864e-112">Эти задачи обсуждаются в разделах оставшейся части этого раздела.</span><span class="sxs-lookup"><span data-stu-id="1864e-112">These tasks are discussed in the sections in the remainder of this topic.</span></span>

## <a name="display-the-picture-stored-in-an-enhanced-metafile"></a><span data-ttu-id="1864e-113">Отобразить изображение, хранящееся в расширенном метафайле</span><span class="sxs-lookup"><span data-stu-id="1864e-113">Display the Picture Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="1864e-114">Изображение, хранящееся в расширенном метафайле, можно отобразить с помощью функции [**плайенхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="1864e-114">You can display the picture stored in an enhanced metafile using the [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) function.</span></span> <span data-ttu-id="1864e-115">Передайте функцию в расширенный метафайл, не отвлекаясь на формат расширенных записей метафайлов.</span><span class="sxs-lookup"><span data-stu-id="1864e-115">Pass the function a handle to the enhanced metafile, without being concerned with the format of the enhanced metafile records.</span></span> <span data-ttu-id="1864e-116">Однако иногда желательно перечислить записи в расширенном метафайле, чтобы найти определенную функцию GDI и изменить параметры функции каким-либо образом.</span><span class="sxs-lookup"><span data-stu-id="1864e-116">However, it is sometimes desirable to enumerate the records in the enhanced metafile to search for a particular GDI function and modify the parameters of the function in some manner.</span></span> <span data-ttu-id="1864e-117">Для этого можно использовать [**енуменхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) и предоставить функцию обратного вызова [**енхметафилепрок**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc)для обработки расширенных записей метафайлов.</span><span class="sxs-lookup"><span data-stu-id="1864e-117">To do this, you can use [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) and provide a callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), to process the enhanced metafile records.</span></span> <span data-ttu-id="1864e-118">Чтобы изменить параметры записи расширенного метафайла, необходимо иметь представление о формате параметров в записи.</span><span class="sxs-lookup"><span data-stu-id="1864e-118">To modify the parameters for an enhanced metafile record, you must know the format of the parameters within the record.</span></span>

## <a name="create-copies-of-an-enhanced-metafile"></a><span data-ttu-id="1864e-119">Создание копий расширенного метафайла</span><span class="sxs-lookup"><span data-stu-id="1864e-119">Create Copies of an Enhanced Metafile</span></span>

<span data-ttu-id="1864e-120">Некоторые приложения создают временные копии файлов резервных копий (или дубликатов), прежде чем разрешить пользователю изменять исходный файл.</span><span class="sxs-lookup"><span data-stu-id="1864e-120">Some applications create temporary backup (or duplicate) copies of a file before enabling the user to alter the original.</span></span> <span data-ttu-id="1864e-121">Приложение может создать резервную копию расширенного метафайла, вызвав функцию [**копенхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) , предоставив маркер, определяющий расширенный метафайл, и указав указатель на имя нового файла.</span><span class="sxs-lookup"><span data-stu-id="1864e-121">An application can create a backup copy of an enhanced metafile by calling the [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) function, supplying a handle that identifies the enhanced metafile, and supplying a pointer to the name of the new file.</span></span>

<span data-ttu-id="1864e-122">Чтобы создать метафайл с расширенным форматом на основе памяти, вызовите функцию [**сетенхметафилебитс**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) .</span><span class="sxs-lookup"><span data-stu-id="1864e-122">To create a memory-based enhanced-format metafile, call the [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) function.</span></span>

## <a name="edit-an-enhanced-metafile"></a><span data-ttu-id="1864e-123">Изменение расширенного метафайла</span><span class="sxs-lookup"><span data-stu-id="1864e-123">Edit an Enhanced Metafile</span></span>

<span data-ttu-id="1864e-124">Большинство приложений для рисования, иллюстраций и программно-ориентированного проектирования (CAD) требует наличия средства редактирования изображения, хранящегося в расширенном метафайле.</span><span class="sxs-lookup"><span data-stu-id="1864e-124">Most drawing, illustration, and computer-aided design (CAD) applications require a means of editing a picture stored in an enhanced metafile.</span></span> <span data-ttu-id="1864e-125">Хотя редактирование расширенного метафайла является сложной задачей, для предоставления этой возможности в приложении можно использовать функцию [**енуменхметафиле**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) в сочетании с другими функциями.</span><span class="sxs-lookup"><span data-stu-id="1864e-125">Although editing an enhanced metafile is a complex task, you can use the [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) function in combination with other functions to provide this capability in your application.</span></span> <span data-ttu-id="1864e-126">Функция **енуменхметафиле** и связанная с ней функция обратного вызова [**енхметафилепрок**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc)позволяют приложению обрабатывать отдельные записи в расширенном метафайле.</span><span class="sxs-lookup"><span data-stu-id="1864e-126">The **EnumEnhMetaFile** function and its associated callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), enable the application to process individual records in an enhanced metafile.</span></span>

## <a name="retrieve-the-optional-description-stored-in-an-enhanced-metafile"></a><span data-ttu-id="1864e-127">Извлечение необязательного описания, хранящегося в расширенном метафайле</span><span class="sxs-lookup"><span data-stu-id="1864e-127">Retrieve the Optional Description Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="1864e-128">Некоторые приложения отображают текстовое описание расширенного метафайла с соответствующим именем файла в диалоговом окне **Открыть** .</span><span class="sxs-lookup"><span data-stu-id="1864e-128">Some applications display the text description of an enhanced metafile with the corresponding file name in the **Open** dialog box.</span></span> <span data-ttu-id="1864e-129">Определить, существует ли эта строка в расширенном метафайле, можно путем получения заголовка Metafile с помощью функции [**жетенхметафилехеадер**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) и проверки одного из его членов.</span><span class="sxs-lookup"><span data-stu-id="1864e-129">You can determine whether this string exists in an enhanced metafile by retrieving the metafile header with the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examining one of its members.</span></span> <span data-ttu-id="1864e-130">Если строка существует, приложение извлекает ее, вызывая функцию [**жетенхметафиледескриптион**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) .</span><span class="sxs-lookup"><span data-stu-id="1864e-130">If the string exists, the application retrieves it by calling the [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) function.</span></span>

## <a name="retrieve-a-binary-version-of-an-enhanced-metafile"></a><span data-ttu-id="1864e-131">Получение двоичной версии расширенного метафайла</span><span class="sxs-lookup"><span data-stu-id="1864e-131">Retrieve a Binary Version of an Enhanced Metafile</span></span>

<span data-ttu-id="1864e-132">Содержимое метафайла можно получить, вызвав функцию [**жетенхметафилебитс**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) . Однако перед извлечением содержимого необходимо указать размер файла.</span><span class="sxs-lookup"><span data-stu-id="1864e-132">You can retrieve the contents of a metafile by calling the [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) function; however, before retrieving the contents, you must specify the size of the file.</span></span> <span data-ttu-id="1864e-133">Чтобы получить размер, можно использовать функцию [**жетенхметафилехеадер**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) и проверить соответствующий элемент.</span><span class="sxs-lookup"><span data-stu-id="1864e-133">To get the size, you can use the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examine the appropriate member.</span></span>

## <a name="enumerate-the-colors-in-the-optional-palette"></a><span data-ttu-id="1864e-134">Перечислить цвета в дополнительной палитре</span><span class="sxs-lookup"><span data-stu-id="1864e-134">Enumerate the Colors in the Optional Palette</span></span>

<span data-ttu-id="1864e-135">Чтобы обеспечить согласованность цветов при отображении изображения на различных устройствах вывода, можно вызвать функцию [**креатепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) и сохранить логическую палитру в расширенном метафайле.</span><span class="sxs-lookup"><span data-stu-id="1864e-135">To achieve consistent colors when a picture is displayed on various output devices, you can call the [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) function and store a logical palette in an enhanced metafile.</span></span> <span data-ttu-id="1864e-136">Приложение, которое отображает изображение, хранящееся в расширенном метафайле, извлекает эту палитру и вызывает функцию [**реализепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) перед отображением изображения.</span><span class="sxs-lookup"><span data-stu-id="1864e-136">An application that displays the picture stored in the enhanced metafile retrieves this palette and calls the [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) function before displaying the picture.</span></span> <span data-ttu-id="1864e-137">Чтобы определить, хранится ли палитра в расширенном метафайле, извлеките заголовок метафайла и проверьте соответствующий элемент.</span><span class="sxs-lookup"><span data-stu-id="1864e-137">To determine whether a palette is stored in an enhanced metafile, retrieve the metafile header and examine the appropriate member.</span></span> <span data-ttu-id="1864e-138">Если палитра существует, можно вызвать функцию [**жетенхметафилепалеттинтриес**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) для получения логической палитры.</span><span class="sxs-lookup"><span data-stu-id="1864e-138">If a palette exists, you can call the [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) function to retrieve the logical palette.</span></span>

 

 
