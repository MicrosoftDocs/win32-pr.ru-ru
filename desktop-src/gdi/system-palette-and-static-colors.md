---
description: Обычно записи палитры системы, которые система резервирует для статических цветов, не могут быть изменены.
ms.assetid: be258151-36cc-42ba-8005-ff9d8e59b894
title: Системная палитра и статические цвета
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 537bdc87fecdd055334b83a56b0a53f9999be94c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104985372"
---
# <a name="system-palette-and-static-colors"></a><span data-ttu-id="89890-103">Системная палитра и статические цвета</span><span class="sxs-lookup"><span data-stu-id="89890-103">System Palette and Static Colors</span></span>

<span data-ttu-id="89890-104">Обычно записи палитры системы, которые система резервирует для статических цветов, не могут быть изменены.</span><span class="sxs-lookup"><span data-stu-id="89890-104">Ordinarily, the system palette entries that the system reserves for static colors cannot be changed.</span></span> <span data-ttu-id="89890-105">Приложение может переопределить это поведение по умолчанию с помощью функции [**сетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) , чтобы уменьшить число записей статического цвета и, таким образом, увеличить число неиспользуемых записей в системной палитре.</span><span class="sxs-lookup"><span data-stu-id="89890-105">An application can override this default behavior by using the [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) function to reduce the number of static color entries and, thereby, increase the number of unused system palette entries.</span></span> <span data-ttu-id="89890-106">Однако, поскольку изменение статических цветов может иметь немедленный и незначительное воздействие на все окна на экране, приложение не должно вызывать **сетсистемпалеттеусе**, если оно не имеет развернутого окна и фокуса ввода.</span><span class="sxs-lookup"><span data-stu-id="89890-106">However, because changing the static colors can have an immediate and dramatic effect on all windows on the display, an application should not call **SetSystemPaletteUse**, unless it has a maximized window and the input focus.</span></span>

<span data-ttu-id="89890-107">Когда приложение вызывает [**сетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) с \_ нестатическим значением сиспал, система освобождает все, кроме двух зарезервированных записей, позволяя этим записям получить новые значения цвета, когда приложение в дальнейшем поймет логическую палитру.</span><span class="sxs-lookup"><span data-stu-id="89890-107">When an application calls [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) with the SYSPAL\_NOSTATIC value, the system frees all but two of the reserved entries, allowing those entries to receive new color values when the application subsequently realizes its logical palette.</span></span> <span data-ttu-id="89890-108">Остальные две записи статического цвета остаются зарезервированными и устанавливаются в белый и черный цвет.</span><span class="sxs-lookup"><span data-stu-id="89890-108">The remaining two static color entries remain reserved and are set to white and black.</span></span> <span data-ttu-id="89890-109">Приложение может восстановить зарезервированные записи путем вызова **сетсистемпалеттеусе** со \_ статическим значением сиспал.</span><span class="sxs-lookup"><span data-stu-id="89890-109">An application can restore the reserved entries by calling **SetSystemPaletteUse** with the SYSPAL\_STATIC value.</span></span> <span data-ttu-id="89890-110">Она может обнаружить использование текущей системной палитры с помощью функции [**жетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteuse) .</span><span class="sxs-lookup"><span data-stu-id="89890-110">It can discover the current system palette usage by using the [**GetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteuse) function.</span></span>

<span data-ttu-id="89890-111">Кроме того, после настройки использования палитры «СИСПАЛ \_ static» приложение должно сразу же понять логическую палитру, вызвать функцию [**жетсисколор**](/windows/win32/api/winuser/nf-winuser-getsyscolor) , чтобы сохранить текущие параметры системного цвета, вызвать функцию [**сетсисколорс**](/windows/win32/api/winuser/nf-winuser-setsyscolors) , чтобы задать для системных цветов разумные значения с помощью черного и белого, и, наконец, отправить сообщение [**WM \_ сисколорчанже**](wm-syscolorchange.md) в другие окна верхнего уровня, чтобы разрешить их перерисовку новыми системными цветами.</span><span class="sxs-lookup"><span data-stu-id="89890-111">Furthermore, after setting the system palette usage to SYSPAL\_NOSTATIC, the application must immediately realize its logical palette, call the [**GetSysColor**](/windows/win32/api/winuser/nf-winuser-getsyscolor) function to save the current system color settings, call the [**SetSysColors**](/windows/win32/api/winuser/nf-winuser-setsyscolors) function to set the system colors to reasonable values using black and white, and finally send the [**WM\_SYSCOLORCHANGE**](wm-syscolorchange.md) message to other top-level windows to allow them to be redrawn with the new system colors.</span></span> <span data-ttu-id="89890-112">При задании системных цветов с помощью черного и белого приложение должно убедиться, что соседние или перекрывающиеся элементы, такие как фреймы и границы окна, установлены как черные и белые соответственно.</span><span class="sxs-lookup"><span data-stu-id="89890-112">When setting system colors using black and white, the application should make sure adjacent or overlapping items, such as window frames and borders, are set to black and white, respectively.</span></span>

<span data-ttu-id="89890-113">Прежде чем приложение теряет фокус ввода, закрывает его окно или завершается, оно должно немедленно вызвать [**сетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) со \_ статическим значением сиспал, реализовать его логическую палитру, восстановить системные цвета до их предыдущих значений и отправить сообщение [**WM \_ сисколорчанже**](wm-syscolorchange.md) .</span><span class="sxs-lookup"><span data-stu-id="89890-113">Before the application loses the input focus, closes its window, or terminates, it must immediately call [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) with the SYSPAL\_STATIC value, realize its logical palette, restore the system colors to their previous values, and send the [**WM\_SYSCOLORCHANGE**](wm-syscolorchange.md) message.</span></span> <span data-ttu-id="89890-114">Система отправляет сообщение [**WM \_ Paint**](wm-paint.md) в любое окно, на которое влияет изменение цвета системы.</span><span class="sxs-lookup"><span data-stu-id="89890-114">The system sends a [**WM\_PAINT**](wm-paint.md) message to any window that is affected by a system color change.</span></span> <span data-ttu-id="89890-115">Приложения, имеющие кисти, использующие существующие системные цвета, должны удалить эти кисти и создать их повторно с помощью новых системных цветов.</span><span class="sxs-lookup"><span data-stu-id="89890-115">Applications that have brushes using the existing system colors should delete those brushes and re-create them using the new system colors.</span></span>

 

 
