---
description: Общее диалоговое окно Шрифт упрощает процесс создания и выбора шрифтов.
ms.assetid: 7183be25-a8e4-47a0-a34a-63eadf6ca10d
title: Создание и выбор шрифта
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 37b4a70a1a49fc318ca69998d97e15fca838668d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104997391"
---
# <a name="font-creation-and-selection"></a><span data-ttu-id="ff292-103">Создание и выбор шрифта</span><span class="sxs-lookup"><span data-stu-id="ff292-103">Font Creation and Selection</span></span>

<span data-ttu-id="ff292-104">Общее диалоговое окно **Шрифт** упрощает процесс создания и выбора шрифтов.</span><span class="sxs-lookup"><span data-stu-id="ff292-104">The **Font** common dialog box simplifies the process of creating and selecting fonts.</span></span> <span data-ttu-id="ff292-105">При инициализации структуры [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) и вызове функции [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) приложение может поддерживать тот же интерфейс выбора шрифта, который ранее требовал много строк пользовательского кода.</span><span class="sxs-lookup"><span data-stu-id="ff292-105">By initializing the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure and calling the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function, an application can support the same font-selection interface that previously required many lines of custom code.</span></span> <span data-ttu-id="ff292-106">(Дополнительные сведения о диалоговом окне **Шрифт** Common см. в разделе [Библиотека общих диалоговых окон](../dlgbox/common-dialog-box-library.md).)</span><span class="sxs-lookup"><span data-stu-id="ff292-106">(For more information about the **Font** common dialog box, see [Common Dialog Box Library](../dlgbox/common-dialog-box-library.md).)</span></span>

## <a name="selection-by-the-user"></a><span data-ttu-id="ff292-107">Выбор пользователем</span><span class="sxs-lookup"><span data-stu-id="ff292-107">Selection by the User</span></span>

<span data-ttu-id="ff292-108">Большинство операций создания и выбора шрифтов затрагивают пользователя.</span><span class="sxs-lookup"><span data-stu-id="ff292-108">Most font creation and selection operations involve the user.</span></span> <span data-ttu-id="ff292-109">Например, приложения обработки текста позволяют пользователю выбирать уникальные шрифты для заголовков, сносок и основного текста.</span><span class="sxs-lookup"><span data-stu-id="ff292-109">For example, word processing applications let the user select unique fonts for headings, footnotes, and body text.</span></span> <span data-ttu-id="ff292-110">После того как пользователь выберет шрифт с помощью диалогового окна **Шрифт** и нажмет кнопку **ОК** , функция [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) инициализирует элементы структуры [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) атрибутами запрошенного шрифта.</span><span class="sxs-lookup"><span data-stu-id="ff292-110">After the user selects a font by using the **Font** dialog box and presses the **OK** button, the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function initializes the members of a [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure with the attributes of the requested font.</span></span> <span data-ttu-id="ff292-111">Чтобы использовать этот шрифт для операций вывода текста, приложение должно сначала создать логический шрифт, а затем выбрать этот шрифт в контексте устройства.</span><span class="sxs-lookup"><span data-stu-id="ff292-111">To use this font for text-output operations, an application must first create a logical font and then select that font into its device context.</span></span> <span data-ttu-id="ff292-112">*Логический шрифт* — это предоставляемое приложением описание идеального шрифта.</span><span class="sxs-lookup"><span data-stu-id="ff292-112">A *logical font* is an application-supplied description of an ideal font.</span></span> <span data-ttu-id="ff292-113">Разработчик может создать логический шрифт, вызвав функции [**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta) или [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) .</span><span class="sxs-lookup"><span data-stu-id="ff292-113">A developer can create a logical font by calling the [**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta) or the [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) functions.</span></span> <span data-ttu-id="ff292-114">В этом случае приложение вызовет [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) и предоставляет указатель на структуру [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) , инициализированную [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta).</span><span class="sxs-lookup"><span data-stu-id="ff292-114">In this case, the application would call [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) and supply a pointer to the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure initialized by [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta).</span></span> <span data-ttu-id="ff292-115">Как правило, вызов **CreateFontIndirect** более эффективен, так как [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta) требует несколько параметров, а **CreateFontIndirect** требует только одного указателя на **LOGFONT**.</span><span class="sxs-lookup"><span data-stu-id="ff292-115">In general, it is more efficient to call **CreateFontIndirect** because [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta) requires several parameters while **CreateFontIndirect** requires only one pointer to **LOGFONT**.</span></span>

<span data-ttu-id="ff292-116">Прежде чем приложение сможет начать рисование текста с помощью логического шрифта, оно должно найти ближайшее соответствие из шрифтов, хранящихся внутри устройства, и шрифтов, ресурсы которых были загружены в операционную систему.</span><span class="sxs-lookup"><span data-stu-id="ff292-116">Before an application can actually begin drawing text with a logical font, it must find the closest match from the fonts stored internally on the device and the fonts whose resources have been loaded into the operating system.</span></span> <span data-ttu-id="ff292-117">Шрифты, хранящиеся на устройстве или в операционной системе, называются *физическими шрифтами*.</span><span class="sxs-lookup"><span data-stu-id="ff292-117">The fonts stored on the device or in the operating system are called *physical fonts*.</span></span> <span data-ttu-id="ff292-118">Процесс поиска физического шрифта, который наиболее полно соответствует заданному логическому шрифту, называется сопоставлением шрифтов.</span><span class="sxs-lookup"><span data-stu-id="ff292-118">The process of finding the physical font that most closely matches a specified logical font is called font mapping.</span></span> <span data-ttu-id="ff292-119">Этот процесс происходит, когда приложение вызывает функцию [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) и предоставляет маркер, идентифицирующий логический шрифт.</span><span class="sxs-lookup"><span data-stu-id="ff292-119">This process occurs when an application calls the [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) function and supplies a handle identifying a logical font.</span></span> <span data-ttu-id="ff292-120">Сопоставление шрифтов выполняется с помощью внутреннего алгоритма, который сравнивает атрибуты запрошенного логического шрифта с атрибутами доступных физических шрифтов.</span><span class="sxs-lookup"><span data-stu-id="ff292-120">Font mapping is performed by using an internal algorithm that compares the attributes of the requested logical font against the attributes of available physical fonts.</span></span> <span data-ttu-id="ff292-121">Когда алгоритм сопоставления шрифтов завершает Поиск и определяет ближайшее возможное совпадение, функция [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject) возвращает значение, и приложение может начать рисование текста с помощью нового шрифта.</span><span class="sxs-lookup"><span data-stu-id="ff292-121">When the font mapper algorithm completes its search and determines the closest possible match, the [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject) function returns and the application can begin drawing text with the new font.</span></span>

<span data-ttu-id="ff292-122">Функция [**сетмапперфлагс**](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags) указывает, будет ли алгоритм сопоставления шрифтов искать только физические шрифты с пропорциями, соответствующими физическому устройству.</span><span class="sxs-lookup"><span data-stu-id="ff292-122">The [**SetMapperFlags**](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags) function specifies whether the font mapper algorithm searches only for physical fonts with aspect ratios that match the physical device.</span></span> <span data-ttu-id="ff292-123">Пропорции устройства — это отношение, сформированное по ширине и высоте пикселя на этом устройстве.</span><span class="sxs-lookup"><span data-stu-id="ff292-123">The aspect ratio for a device is the ratio formed by the width and the height of a pixel on that device.</span></span>

<span data-ttu-id="ff292-124">Системный шрифт (также называемый оболочкой или шрифтом по умолчанию) — это шрифт, используемый для текста в заголовках, меню и диалоговых окнах.</span><span class="sxs-lookup"><span data-stu-id="ff292-124">The system font (also known as the shell or default font) is the font used for text in the title bars, menus, and dialog boxes.</span></span>

## <a name="special-font-selection-considerations"></a><span data-ttu-id="ff292-125">Специальные рекомендации по выбору шрифтов</span><span class="sxs-lookup"><span data-stu-id="ff292-125">Special Font Selection Considerations</span></span>

<span data-ttu-id="ff292-126">Хотя большинство операций выбора шрифтов затрагивает пользователя, существуют некоторые экземпляры, в которых это не так.</span><span class="sxs-lookup"><span data-stu-id="ff292-126">Although most font selection operations involve the user, there are some instances where this is not true.</span></span> <span data-ttu-id="ff292-127">Например, разработчику может потребоваться использовать уникальный шрифт в приложении для рисования текста в окне управления.</span><span class="sxs-lookup"><span data-stu-id="ff292-127">For example, a developer may want to use a unique font in an application to draw text in a control window.</span></span> <span data-ttu-id="ff292-128">Чтобы выбрать подходящий шрифт, приложение должно иметь возможность определить доступные шрифты, создать логический шрифт, который описывает один из этих доступных шрифтов, а затем выбрать этот шрифт в соответствующем контексте устройства.</span><span class="sxs-lookup"><span data-stu-id="ff292-128">To select an appropriate font, the application must be able to determine what fonts are available, create a logical font that describes one of these available fonts, and then select that font into the appropriate device context.</span></span>

<span data-ttu-id="ff292-129">Приложение может перечислить доступные шрифты с помощью функций [**енумфонтс**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontsa) или [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) .</span><span class="sxs-lookup"><span data-stu-id="ff292-129">An application can enumerate the available fonts by using the [**EnumFonts**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontsa) or [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) functions.</span></span> <span data-ttu-id="ff292-130">Рекомендуется использовать [**EnumFontFamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa) , так как он перечисляет все стили, связанные с именем семейства.</span><span class="sxs-lookup"><span data-stu-id="ff292-130">[**EnumFontFamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa) is recommended because it enumerates all the styles associated with a family name.</span></span> <span data-ttu-id="ff292-131">Это может быть полезно для шрифтов с множеством или необычными стилями и для шрифтов, пересекающих международные границы.</span><span class="sxs-lookup"><span data-stu-id="ff292-131">This can be useful for fonts with many or unusual styles and for fonts that cross international borders.</span></span>

<span data-ttu-id="ff292-132">Когда приложение перечислит доступные шрифты и подходящее совпадение, оно должно использовать значения, возвращенные функцией перечисления шрифтов для инициализации элементов структуры [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) .</span><span class="sxs-lookup"><span data-stu-id="ff292-132">Once an application has enumerated the available fonts and located an appropriate match, it should use the values returned by the font enumeration function to initialize the members of a [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure.</span></span> <span data-ttu-id="ff292-133">Затем он может вызвать функцию [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) , передав ей указатель на инициализированную структуру [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) .</span><span class="sxs-lookup"><span data-stu-id="ff292-133">Then it can call the [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) function, passing to it a pointer to the initialized [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure.</span></span> <span data-ttu-id="ff292-134">Если функция [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) выполнена успешно, приложение может выбрать логический шрифт, вызвав функцию [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) .</span><span class="sxs-lookup"><span data-stu-id="ff292-134">If the [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) function is successful, the application can then select the logical font by calling the [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) function.</span></span> <span data-ttu-id="ff292-135">При инициализации элементов структуры **LOGFONT** не забудьте указать определенную кодировку в элементе **лфчарсет** .</span><span class="sxs-lookup"><span data-stu-id="ff292-135">When initializing the members of the **LOGFONT** structure, be sure to specify a specific character set in the **lfCharSet** member.</span></span> <span data-ttu-id="ff292-136">Этот элемент важен в процессе сопоставления шрифтов, и результаты будут непоследовательными, если этот элемент не инициализирован правильно.</span><span class="sxs-lookup"><span data-stu-id="ff292-136">This member is important in the font mapping process and the results will be inconsistent if this member is not initialized correctly.</span></span> <span data-ttu-id="ff292-137">Если указать имя гарнитуры в элементе **лффаценаме** структуры **LOGFONT** , убедитесь, что значение **лфчарсет** совпадает с кодировкой шрифта, указанного в **лффаценаме**.</span><span class="sxs-lookup"><span data-stu-id="ff292-137">If you specify a typeface name in the **lfFaceName** member of the **LOGFONT** structure, make sure that the **lfCharSet** value matches the character set of the typeface specified in **lfFaceName**.</span></span> <span data-ttu-id="ff292-138">Например, если вы хотите выбрать шрифт, например MS Минчо, **лфчарсет** должен иметь предварительно заданное значение символов shiftjis \_ CharSet.</span><span class="sxs-lookup"><span data-stu-id="ff292-138">For example, if you want to select a font such as MS Mincho, **lfCharSet** must be set to the predefined value SHIFTJIS\_CHARSET.</span></span>

<span data-ttu-id="ff292-139">Шрифты для многих восточноазиатских языков имеют два названия гарнитуры: имя на английском языке и локализованное имя.</span><span class="sxs-lookup"><span data-stu-id="ff292-139">The fonts for many East Asian languages have two typeface names: an English name and a localized name.</span></span> <span data-ttu-id="ff292-140">[**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta)и [**креатефонтиндиректекс**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirectexa) используют локализованное название гарнитуры для языкового стандарта системы, совпадающего с языком, но они принимают название гарнитуры английского языка для всех других языковых стандартов системы.</span><span class="sxs-lookup"><span data-stu-id="ff292-140">[**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta), and [**CreateFontIndirectEx**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirectexa) take the localized typeface name for a system locale that matches the language, but they take the English typeface name for all other system locales.</span></span> <span data-ttu-id="ff292-141">Лучший способ — попробовать одно имя, а в случае сбоя — попробовать другое.</span><span class="sxs-lookup"><span data-stu-id="ff292-141">The best method is to try one name and, on failure, try the other.</span></span> <span data-ttu-id="ff292-142">Обратите внимание, что [**енумфонтс**](/windows/win32/api/wingdi/nf-wingdi-enumfontsa), [**EnumFontFamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa)и [**EnumFontFamiliesEx**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesexa) возвращают название гарнитуры на английском языке, если язык системы не соответствует языку шрифта.</span><span class="sxs-lookup"><span data-stu-id="ff292-142">Note that [**EnumFonts**](/windows/win32/api/wingdi/nf-wingdi-enumfontsa), [**EnumFontFamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa), and [**EnumFontFamiliesEx**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesexa) return the English typeface name if the system locale does not match the language of the font.</span></span> <span data-ttu-id="ff292-143">Начиная с Windows 2000, это больше не является проблемой, поскольку средство сопоставления шрифтов для [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta)и [**креатефонтиндиректекс**](/windows/win32/api/wingdi/nf-wingdi-createfontindirectexa) распознает любое имя гарнитуры независимо от языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="ff292-143">Starting with Windows 2000, this is no longer a problem because the font mapper for [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta), and [**CreateFontIndirectEx**](/windows/win32/api/wingdi/nf-wingdi-createfontindirectexa) recognizes either typeface name, regardless of locale.</span></span>

 

 
