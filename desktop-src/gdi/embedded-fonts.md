---
description: Внедрение шрифта — это способ объединения документа и содержащихся в нем шрифтов в файл для передачи на другой компьютер.
ms.assetid: ded409f1-5bd9-411b-b905-fc49c484786a
title: Внедренные шрифты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83fb8ab821afa5f44ded05a4a61a53439b8db9fc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155627"
---
# <a name="embedded-fonts"></a><span data-ttu-id="8da7b-103">Внедренные шрифты</span><span class="sxs-lookup"><span data-stu-id="8da7b-103">Embedded Fonts</span></span>

<span data-ttu-id="8da7b-104">Внедрение шрифта — это способ объединения документа и содержащихся в нем шрифтов в файл для передачи на другой компьютер.</span><span class="sxs-lookup"><span data-stu-id="8da7b-104">Embedding a font is the technique of bundling a document and the fonts it contains into a file for transmission to another computer.</span></span> <span data-ttu-id="8da7b-105">Внедрение шрифта гарантирует, что шрифт, указанный в переданном файле, будет присутствовать на компьютере, получающем файл.</span><span class="sxs-lookup"><span data-stu-id="8da7b-105">Embedding a font guarantees that a font specified in a transmitted file will be present on the computer receiving the file.</span></span> <span data-ttu-id="8da7b-106">Не все шрифты можно перемещать с компьютера на компьютер, так как большинство шрифтов лицензируется только на один компьютер за раз.</span><span class="sxs-lookup"><span data-stu-id="8da7b-106">Not all fonts can be moved from computer to computer, however, since most fonts are licensed to only one computer at a time.</span></span> <span data-ttu-id="8da7b-107">Внедрять можно только шрифты TrueType и OpenType.</span><span class="sxs-lookup"><span data-stu-id="8da7b-107">Only TrueType and OpenType fonts can be embedded.</span></span>

<span data-ttu-id="8da7b-108">Приложения должны внедрять шрифт в документ только по запросу пользователя.</span><span class="sxs-lookup"><span data-stu-id="8da7b-108">Applications should embed a font in a document only when requested by a user.</span></span> <span data-ttu-id="8da7b-109">Приложение не может распространяться вместе с документами, содержащими внедренные шрифты, а само приложение не может содержать внедренный шрифт.</span><span class="sxs-lookup"><span data-stu-id="8da7b-109">An application cannot be distributed along with documents that contain embedded fonts, nor can an application itself contain an embedded font.</span></span> <span data-ttu-id="8da7b-110">Каждый раз, когда приложение распространяет шрифт в любом формате, права владельца шрифта должны быть подтверждены.</span><span class="sxs-lookup"><span data-stu-id="8da7b-110">Whenever an application distributes a font, in any format, the proprietary rights of the owner of the font must be acknowledged.</span></span>

<span data-ttu-id="8da7b-111">Это может быть нарушение прав собственности поставщика шрифтов или лицензионного соглашения для внедрения любых шрифтов, в которых внедрение не разрешено, или не может следовать приведенным ниже рекомендациям по внедрению шрифтов.</span><span class="sxs-lookup"><span data-stu-id="8da7b-111">It may be a violation of a font vendor's proprietary rights or user license agreement to embed any fonts where embedding is not permitted or to fail to observe the following guidelines on embedding fonts.</span></span> <span data-ttu-id="8da7b-112">Лицензия шрифта может предоставлять только разрешение на чтение и запись для установки и использования шрифта на конечном компьютере.</span><span class="sxs-lookup"><span data-stu-id="8da7b-112">A font's license may give only read/write permission for a font to be installed and used on the destination computer.</span></span> <span data-ttu-id="8da7b-113">Или лицензия может предоставить разрешение только для чтения.</span><span class="sxs-lookup"><span data-stu-id="8da7b-113">Or the license may give read-only permission.</span></span> <span data-ttu-id="8da7b-114">Разрешение только для чтения позволяет конечному компьютеру просматривать и печатать документ (но не изменять его); документы с внедренными шрифтами только для чтения доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="8da7b-114">Read-only permission allows a document to be viewed and printed (but not modified) by the destination computer; documents with read-only embedded fonts are themselves read-only.</span></span> <span data-ttu-id="8da7b-115">Внедренные шрифты, предназначенные только для чтения, не могут быть извлечены из документа и установлены на конечном компьютере.</span><span class="sxs-lookup"><span data-stu-id="8da7b-115">Read-only embedded fonts may not be unbundled from the document and installed on the destination computer.</span></span>

<span data-ttu-id="8da7b-116">Приложение может определить состояние лицензии, вызвав функцию [**жетаутлинетекстметрикс**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) и изучив элемент **отмфстипе** структуры [**аутлинетекстметрик**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) .</span><span class="sxs-lookup"><span data-stu-id="8da7b-116">An application can determine the license status by calling the [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) function and examining the **otmfsType** member of the [**OUTLINETEXTMETRIC**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) structure.</span></span> <span data-ttu-id="8da7b-117">Если задан бит 1 из **отмфстипе** , встраивание для шрифта не разрешено.</span><span class="sxs-lookup"><span data-stu-id="8da7b-117">If bit 1 of **otmfsType** is set, embedding is not permitted for the font.</span></span> <span data-ttu-id="8da7b-118">Если бит 1 снят, шрифт может быть внедрен.</span><span class="sxs-lookup"><span data-stu-id="8da7b-118">If bit 1 is clear, the font can be embedded.</span></span> <span data-ttu-id="8da7b-119">Если задан бит 2, то внедрение будет доступно только для чтения.</span><span class="sxs-lookup"><span data-stu-id="8da7b-119">If bit 2 is set, the embedding is read-only.</span></span>

<span data-ttu-id="8da7b-120">Чтобы внедрить шрифт TrueType, приложение может использовать функцию [**жетфонтдата**](/windows/desktop/api/Wingdi/nf-wingdi-getfontdata) для чтения файла шрифта.</span><span class="sxs-lookup"><span data-stu-id="8da7b-120">To embed a TrueType font, an application can use the [**GetFontData**](/windows/desktop/api/Wingdi/nf-wingdi-getfontdata) function to read the font file.</span></span> <span data-ttu-id="8da7b-121">Установка параметров *двтабле* и *двоффсет* для [**жетфонтдата**](/windows/win32/api/wingdi/nf-wingdi-getfontdata) в 0L, а параметр *cbData* — 1L гарантирует, что приложение считывает весь файл шрифта с самого начала.</span><span class="sxs-lookup"><span data-stu-id="8da7b-121">Setting the *dwTable* and *dwOffset* parameters of [**GetFontData**](/windows/win32/api/wingdi/nf-wingdi-getfontdata) to 0L and the *cbData* parameter to 1L ensures that the application reads the entire font file from the beginning.</span></span>

<span data-ttu-id="8da7b-122">Для внедрения шрифтов OpenType можно использовать несколько функций в зависимости от ширины символов и расположения данных шрифтов.</span><span class="sxs-lookup"><span data-stu-id="8da7b-122">Several functions are available to embed OpenType fonts depending on the character width and where the font data resides.</span></span> <span data-ttu-id="8da7b-123">Чтобы внедрить шрифт OpenType Юникода, находящийся в контексте устройства, приложение может использовать [**ттембедфонт**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfont).</span><span class="sxs-lookup"><span data-stu-id="8da7b-123">To embed an OpenType Unicode font that resides in a device context, an application can use [**TTEmbedFont**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfont).</span></span> <span data-ttu-id="8da7b-124">Чтобы внедрить шрифт OpenType UCS-4, находящийся в контексте устройства, приложение может использовать [**ттембедфонтекс**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontex).</span><span class="sxs-lookup"><span data-stu-id="8da7b-124">To embed an OpenType UCS-4 font that resides in a device context, an application can use [**TTEmbedFontEx**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontex).</span></span> <span data-ttu-id="8da7b-125">Чтобы внедрить шрифт OpenType Юникода, находящийся в файле шрифта, приложение может использовать [**ттембедфонтфромфиле**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontfromfilea).</span><span class="sxs-lookup"><span data-stu-id="8da7b-125">To embed an OpenType Unicode font that resides in a font file, an application can use [**TTEmbedFontFromFile**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontfromfilea).</span></span> <span data-ttu-id="8da7b-126">Дополнительные сведения о внедрении шрифтов OpenType см. в разделе [Справочник по внедрению шрифтов](font-embedding-reference.md).</span><span class="sxs-lookup"><span data-stu-id="8da7b-126">For additional information on OpenType font embedding, see the [Font Embedding Reference](font-embedding-reference.md).</span></span>

<span data-ttu-id="8da7b-127">После того как приложение извлекает данные шрифтов, оно может сохранить данные в документе с помощью любого применимого формата.</span><span class="sxs-lookup"><span data-stu-id="8da7b-127">After an application retrieves the font data, it can store the data with the document by using any applicable format.</span></span> <span data-ttu-id="8da7b-128">Большинство приложений создают в документе каталог шрифтов, выводит список внедренных шрифтов и указывает, доступен ли внедренный объект для чтения и записи или только для чтения.</span><span class="sxs-lookup"><span data-stu-id="8da7b-128">Most applications build a font directory in the document, listing the embedded fonts and whether the embedding is read/write or read-only.</span></span> <span data-ttu-id="8da7b-129">Приложение может использовать члены **отмпстиленаме** и **отмфамилинаме** структуры [**аутлинетекстметрик**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica) для распознавания шрифта.</span><span class="sxs-lookup"><span data-stu-id="8da7b-129">An application can use the **otmpStyleName** and **otmFamilyName** members of the [**OUTLINETEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica) structure to identify the font.</span></span>

<span data-ttu-id="8da7b-130">Если для внедренного шрифта установлен бит только для чтения, приложения должны зашифровать данные шрифта, прежде чем сохранять их вместе с документом.</span><span class="sxs-lookup"><span data-stu-id="8da7b-130">If the read-only bit is set for the embedded font, applications must encrypt the font data before storing it with the document.</span></span> <span data-ttu-id="8da7b-131">Метод шифрования не должен быть сложным; Например, использование оператора XOR для объединения данных шрифта с константой, определяемой приложением, является достаточной и быстрой.</span><span class="sxs-lookup"><span data-stu-id="8da7b-131">The encryption method need not be complicated; for example, using the XOR operator to combine the font data with an application-defined constant is adequate and fast.</span></span>

 

 
