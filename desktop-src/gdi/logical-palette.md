---
description: Логическая палитра — это цветовая палитра, которую приложение создает и связывает с заданным контекстом устройства.
ms.assetid: 7cc86771-237d-4539-8f48-2474edb764a4
title: Логическая палитра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 597e049c4320ff3ac30099e767c35a3438237904
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984944"
---
# <a name="logical-palette"></a>Логическая палитра

*Логическая палитра* — это цветовая палитра, которую приложение создает и связывает с заданным контекстом устройства. Логические палитры позволяют приложениям определять и использовать цвета, соответствующие определенным потребностям. Приложения могут создавать любое количество логических палитр, используя их для отдельных контекстов устройств или переключения между ними в контексте одного устройства. Максимальное число палитр, которое может создать приложение, зависит от ресурсов системы.

Приложение создает логическую палитру с помощью функции [**креатепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) . Приложение заполняет структуру [**логпалетте**](/windows/win32/api/wingdi/ns-wingdi-logpalette) , которая задает количество записей и цветовых значений для каждой записи, а затем приложение передает структуру в **креатепалетте**. Функция возвращает маркер палитры, используемый приложением во всех последующих операциях для задания палитры. Чтобы использовать цвета в логической палитре, приложение выбирает палитру в контексте устройства с помощью функции [**селектпалетте**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette) , а затем реализует палитру с помощью функции [**реализепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) . Цвета палитры доступны сразу после реализации логической палитры.

Приложение должно ограничивать размер логических палитр до достаточного количества записей, представляющих нужные цвета. Приложения не могут создавать логические палитры, размер которых превышает максимальный размер палитры, зависящее от устройства значение. Приложения могут получить максимальный размер, используя функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) для получения значения сизепалетте.

Хотя приложение может указывать любое значение цвета для определенной записи в логической палитре, не все цвета могут создаваться данным устройством. Система не позволяет определить, какие цвета поддерживаются, но приложение может обнаружить общее число этих цветов, извлекая цветное разрешение устройства. Разрешение цвета, заданное в цветовых битах на пиксель, равно значению КОЛОРРЕС, возвращаемому функцией [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) . Устройство с цветовым разрешением 18 имеет 262 144 возможных цветов. Если приложение запрашивает неподдерживаемый цвет, система выбирает соответствующую аппроксимацию.

После создания логической палитры приложение может изменить цвета в палитре с помощью функции [**сетпалеттинтриес**](/windows/desktop/api/Wingdi/nf-wingdi-setpaletteentries) . Если логическая палитра была выбрана и реализована, изменение палитры не сразу влияет на отображаемые цвета. Для обновления цветов приложение должно использовать функции [**унреализеобжект**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) и [**реализепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) . В некоторых случаях приложению может потребоваться отменить выбор, не выделять, выбрать и реализовать логическую палитру, чтобы обеспечить точное обновление цветов по запросу. Если приложение выбирает логическую палитру в более чем одном контексте устройства, изменения в логической палитре влияют на все контексты устройств, для которых он выбран.

Приложение может изменить число записей в логической палитре с помощью функции [**ресизепалетте**](/windows/desktop/api/Wingdi/nf-wingdi-resizepalette) . Если приложение уменьшает размер, оставшиеся записи не меняются. Если приложение расширяет размер, система устанавливает для каждой новой записи цвет черного (0, 0, 0), а флаг — ноль.

Приложение может извлекать значения цвета и флага для записей в заданной логической палитре с помощью функции [**жетпалеттинтриес**](/windows/desktop/api/Wingdi/nf-wingdi-getpaletteentries) . Приложение может получить индекс для записи в заданной логической палитре, которая наиболее точно соответствует заданному значению цвета, с помощью функции [**жетнеарестпалеттеиндекс**](/windows/desktop/api/Wingdi/nf-wingdi-getnearestpaletteindex) .

Если приложению больше не нужна логическая палитра, ее можно удалить с помощью функции [**DeleteObject**](/windows/desktop/api/Wingdi/nf-wingdi-deleteobject) . Перед удалением палитры приложение должно убедиться, что логическая палитра больше не выбрана в контексте устройства.

 

 



