---
description: Для рисования в клиентской области окна используется общий контекст устройства.
ms.assetid: 63c4f775-b1a3-4f7c-808b-81c596f26353
title: Общие контексты отображаемых устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 890b0235784ec1ed11c8ce3a553244629a008d75
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103991498"
---
# <a name="common-display-device-contexts"></a><span data-ttu-id="c89ef-103">Общие контексты отображаемых устройств</span><span class="sxs-lookup"><span data-stu-id="c89ef-103">Common Display Device Contexts</span></span>

<span data-ttu-id="c89ef-104">Для рисования в клиентской области окна используется *общий контекст устройства* .</span><span class="sxs-lookup"><span data-stu-id="c89ef-104">A *common device context* is used for drawing in the client area of the window.</span></span> <span data-ttu-id="c89ef-105">По умолчанию система предоставляет общий контекст устройства для любого окна, в котором класс Window не указывает стиль контекста устройства вывода.</span><span class="sxs-lookup"><span data-stu-id="c89ef-105">The system provides a common device context by default for any window whose window class does not explicitly specify a display device context style.</span></span> <span data-ttu-id="c89ef-106">Общие контексты устройств обычно используются с Windows, которые могут быть выведены без внесения значительных изменений в атрибуты контекста устройства.</span><span class="sxs-lookup"><span data-stu-id="c89ef-106">Common device contexts are typically used with windows that can be drawn without extensive changes to the device context attributes.</span></span> <span data-ttu-id="c89ef-107">Общие контексты устройств удобны, поскольку они не нуждаются в дополнительной памяти или системных ресурсах, но они могут оказаться неудобными, если приложение должно настроить множество атрибутов перед их использованием.</span><span class="sxs-lookup"><span data-stu-id="c89ef-107">Common device contexts are convenient because they do not require additional memory or system resources, but they can be inconvenient if the application must set up many attributes before using them.</span></span>

<span data-ttu-id="c89ef-108">Система извлекает все общие контексты устройств из кэша контекста устройства вывода.</span><span class="sxs-lookup"><span data-stu-id="c89ef-108">The system retrieves all common device contexts from the display device context cache.</span></span> <span data-ttu-id="c89ef-109">Приложение может получить общий контекст устройства сразу после создания окна.</span><span class="sxs-lookup"><span data-stu-id="c89ef-109">An application can retrieve a common device context immediately after the window is created.</span></span> <span data-ttu-id="c89ef-110">Так как общий контекст устройства находится в кэше, приложение всегда должно освобождать контекст устройства как можно скорее после рисования.</span><span class="sxs-lookup"><span data-stu-id="c89ef-110">Because the common device context is from the cache, the application must always release the device context as soon as possible after drawing.</span></span> <span data-ttu-id="c89ef-111">После выпуска общего контекста устройства он становится недействительным, и приложение не должно пытаться его рисовать.</span><span class="sxs-lookup"><span data-stu-id="c89ef-111">After the common device context is released, it is no longer valid and the application must not attempt to draw with it.</span></span> <span data-ttu-id="c89ef-112">Для повторного рисования приложение должно получить новый общий контекст устройства и продолжать извлекать и освобождать общий контекст устройства каждый раз при его прорисовке в окне.</span><span class="sxs-lookup"><span data-stu-id="c89ef-112">To draw again, the application must retrieve a new common device context, and continue to retrieve and release a common device context each time it draws in the window.</span></span> <span data-ttu-id="c89ef-113">Если приложение получает обработчик контекста устройства с помощью функции [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) , оно должно использовать функцию [**релеаседк**](/windows/desktop/api/Winuser/nf-winuser-releasedc) для освобождения этого маркера.</span><span class="sxs-lookup"><span data-stu-id="c89ef-113">If the application retrieves the device context handle by using the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) function, it must use the [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) function to release the handle.</span></span> <span data-ttu-id="c89ef-114">Аналогичным образом для каждой функции [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) приложение должно использовать соответствующую функцию [**ендпаинт**](/windows/desktop/api/Winuser/nf-winuser-endpaint) .</span><span class="sxs-lookup"><span data-stu-id="c89ef-114">Similarly, for each [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) function, the application must use a corresponding [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) function.</span></span>

<span data-ttu-id="c89ef-115">Когда приложение получает контекст устройства, система корректирует источник так, чтобы он совпадал с верхним левым углом клиентской области.</span><span class="sxs-lookup"><span data-stu-id="c89ef-115">When the application retrieves the device context, the system adjusts the origin so that it aligns with the upper left corner of the client area.</span></span> <span data-ttu-id="c89ef-116">Он также задает область отсечения таким образом, чтобы выходные данные в контексте устройства обрезались в клиентской области.</span><span class="sxs-lookup"><span data-stu-id="c89ef-116">It also sets the clipping region so that output to the device context is clipped to the client area.</span></span> <span data-ttu-id="c89ef-117">Все выходные данные, которые в противном случае будут отображаться вне области клиента, будут обрезаны.</span><span class="sxs-lookup"><span data-stu-id="c89ef-117">Any output that would otherwise appear outside the client area is clipped.</span></span> <span data-ttu-id="c89ef-118">Если приложение получает общий контекст устройства с помощью [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint), система также включает область обновления в область обрезки для дальнейшего ограничения выходных данных.</span><span class="sxs-lookup"><span data-stu-id="c89ef-118">If the application retrieves the common device context by using [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint), the system also includes the update region in the clipping region to further restrict the output.</span></span>

<span data-ttu-id="c89ef-119">Когда приложение освобождает общий контекст устройства, система восстанавливает значения по умолчанию для атрибутов контекста устройства.</span><span class="sxs-lookup"><span data-stu-id="c89ef-119">When an application releases a common device context, the system restores the default values for the attributes of the device context.</span></span> <span data-ttu-id="c89ef-120">Приложение, изменяющее значения атрибутов, должно выполнять эти действия каждый раз, когда он получает общий контекст устройства.</span><span class="sxs-lookup"><span data-stu-id="c89ef-120">An application that modifies attribute values must do so each time it retrieves a common device context.</span></span> <span data-ttu-id="c89ef-121">Освобождение контекста устройства освобождает все объекты рисования, которые приложение может выбрать в нем, поэтому приложению не нужно освобождать эти объекты перед освобождением контекста устройства.</span><span class="sxs-lookup"><span data-stu-id="c89ef-121">Releasing the device context releases any drawing objects the application may have selected into it, so the application need not release these objects before releasing the device context.</span></span> <span data-ttu-id="c89ef-122">Во всех случаях приложение не должно рассчитывать на то, что общий контекст устройства оставляет нестандартные параметры после освобождения.</span><span class="sxs-lookup"><span data-stu-id="c89ef-122">In all cases, an application must never assume that the common device context retains nondefault selections after being released.</span></span>

 

 



