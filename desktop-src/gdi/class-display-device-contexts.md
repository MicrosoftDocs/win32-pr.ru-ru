---
description: С помощью контекста устройства класса приложение может использовать контекст одного устройства вывода для каждого окна, принадлежащего указанному классу.
ms.assetid: fc76abbf-68da-47f2-8145-4fad806297b4
title: Отображение контекстов устройств в классе
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e5a4cc0268d948e1a6f95050409698217e3f13e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104985052"
---
# <a name="class-display-device-contexts"></a><span data-ttu-id="dd9c4-103">Отображение контекстов устройств в классе</span><span class="sxs-lookup"><span data-stu-id="dd9c4-103">Class Display Device Contexts</span></span>

<span data-ttu-id="dd9c4-104">С помощью *контекста устройства класса* приложение может использовать контекст одного устройства вывода для каждого окна, принадлежащего указанному классу.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-104">By using a *class device context*, an application can use a single display device context for every window belonging to a specified class.</span></span> <span data-ttu-id="dd9c4-105">Контексты устройств класса часто используются с окнами управления, которые рисуются с использованием одинаковых значений атрибутов.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-105">Class device contexts are often used with control windows that are drawn using the same attribute values.</span></span> <span data-ttu-id="dd9c4-106">Как и в частных контекстах устройств, контексты устройств класса сокращают время, необходимое для подготовки контекста устройства к рисованию.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-106">Like private device contexts, class device contexts minimize the time required to prepare a device context for drawing.</span></span>

<span data-ttu-id="dd9c4-107">Система предоставляет контекст устройства класса для окна, если он принадлежит классу окна, имеющему \_ стиль CS классдк.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-107">The system supplies a class device context for a window if it belongs to a window class having the CS\_CLASSDC style.</span></span> <span data-ttu-id="dd9c4-108">Система создает контекст устройства при создании первого окна, принадлежащего классу, а затем использует тот же контекст устройства для всех последовательно созданных окон в классе.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-108">The system creates the device context when creating the first window belonging to the class and then uses the same device context for all subsequently created windows in the class.</span></span> <span data-ttu-id="dd9c4-109">Изначально контекст устройства класса имеет те же значения по умолчанию для атрибутов, что и общий контекст устройства, но приложение может изменить их в любое время.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-109">Initially, the class device context has the same default values for attributes as a common device context, but the application can modify these at any time.</span></span> <span data-ttu-id="dd9c4-110">Система сохраняет все изменения, за исключением области обрезки и источника устройства, пока не будет уничтожено Последнее окно в классе.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-110">The system preserves all changes, except for the clipping region and device origin, until the last window in the class has been destroyed.</span></span> <span data-ttu-id="dd9c4-111">Изменение, выполненное для одного окна, применяется ко всем окнам в этом классе.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-111">A change made for one window applies to all windows in that class.</span></span>

<span data-ttu-id="dd9c4-112">Приложение может получить маркер контекста устройства класса с помощью функции [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) в любое время после создания первого окна.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-112">An application can retrieve the handle to the class device context by using the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) function any time after the first window has been created.</span></span> <span data-ttu-id="dd9c4-113">Приложение может держать и использовать этот обработчик, не освобождая его, так как контекст устройства класса не является частью кэша контекста устройства вывода.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-113">The application can keep and use the handle without releasing it because the class device context is not part of the display device context cache.</span></span> <span data-ttu-id="dd9c4-114">Если приложение создает другое окно в том же классе окна, приложение должно снова получить контекст устройства класса.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-114">If the application creates another window in the same window class, the application must retrieve the class device context again.</span></span> <span data-ttu-id="dd9c4-115">При извлечении контекста устройства устанавливается правильное исходное положение устройства и область отсечения для нового окна.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-115">Retrieving the device context sets the correct device origin and clipping region for the new window.</span></span> <span data-ttu-id="dd9c4-116">После того как приложение извлекает контекст устройства класса для нового окна в классе, контекст устройства больше не может использоваться для рисования в исходном окне без повторного получения этого окна.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-116">After the application retrieves the class device context for a new window in the class, the device context can no longer be used to draw in the original window without again retrieving it for that window.</span></span> <span data-ttu-id="dd9c4-117">В общем случае каждый раз, когда она должна рисоваться в окне, приложение должно явно получить контекст устройства класса для окна.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-117">In general, each time it must draw in a window, an application must explicitly retrieve the class device context for the window.</span></span>

<span data-ttu-id="dd9c4-118">Приложения, использующие контексты устройств класса, должны всегда вызывать [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) при обработке сообщения [**WM \_ Paint**](wm-paint.md) .</span><span class="sxs-lookup"><span data-stu-id="dd9c4-118">Applications that use class device contexts should always call [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) when processing a [**WM\_PAINT**](wm-paint.md) message.</span></span> <span data-ttu-id="dd9c4-119">Функция задает правильный источник устройства и область отсечения для окна, а также включает регион обновления.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-119">The function sets the correct device origin and clipping region for the window, and incorporates the update region.</span></span> <span data-ttu-id="dd9c4-120">Приложение также должно вызывать [**ендпаинт**](/windows/desktop/api/Winuser/nf-winuser-endpaint) для восстановления курсора, если **бегинпаинт** его HID.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-120">The application should also call [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) to restore the caret if **BeginPaint** hid it.</span></span> <span data-ttu-id="dd9c4-121">**Ендпаинт** никак не влияет на контекст устройства класса.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-121">**EndPaint** has no other effect on a class device context.</span></span>

<span data-ttu-id="dd9c4-122">Система передает контекст устройства класса при отправке в приложение сообщения [**WM \_ ерасебкгнд**](../winmsg/wm-erasebkgnd.md) , что позволяет текущим значениям атрибутов влиять на любые прорисовки, выполняемые приложением или системой при обработке этого сообщения.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-122">The system passes the class device context when sending the [**WM\_ERASEBKGND**](../winmsg/wm-erasebkgnd.md) message to the application, permitting the current attribute values to affect any drawing carried out by the application or the system when processing this message.</span></span> <span data-ttu-id="dd9c4-123">Как и в случае с окном частного контекста устройства, приложение может использовать [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) , чтобы заставить систему вернуть общий контекст устройства для окна с контекстом устройства класса.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-123">As it could with a window having a private device context, an application can use [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) to force the system to return a common device context for the window that has a class device context.</span></span>

<span data-ttu-id="dd9c4-124">Использовать контексты устройств класса не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="dd9c4-124">Using class device contexts is not recommended.</span></span>

 

 
