---
description: В следующей таблице указаны наиболее важные метрики шрифтов для приложений, которым требуются переносимые документы и функции, позволяющие приложению извлекать их.
ms.assetid: 61f6d244-7397-42af-af58-0ab9d07bf19e
title: Метрики для переносимых документов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3762846e6d8280c2680f47f3cb32cd847ea4e664dab47a8a0995f5505c393da3
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119558504"
---
# <a name="metrics-for-portable-documents"></a>Метрики для переносимых документов

В следующей таблице указаны наиболее важные метрики шрифтов для приложений, которым требуются переносимые документы и функции, позволяющие приложению извлекать их.



| Функция                                               | Метрика                | Назначение                                                                                                          |
|--------------------------------------------------------|-----------------------|--------------------------------------------------------------------------------------------------------------|
| [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa)           | **нтмсизим**         | Получение метрик проектирования; Преобразование в метрики устройства.                                                   |
| [**жетчарабквидсс**](/windows/desktop/api/Wingdi/nf-wingdi-getcharabcwidthsa)           | **абквидсс**         | Точное размещение символов в начале и в конце полей, границы рисунка и другие разрывы текста. |
| [**GetCharWidth32**](/windows/desktop/api/Wingdi/nf-wingdi-getcharwidth32a)               | **адванцевидсс**     | Размещение символов в строке.                                                                           |
| [**жетаутлинетекстметрикс**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) | **отмфстипе**         | Биты для встраивания шрифтов.                                                                                         |
|                                                        | **отмсчарслоперисе** | Y-компонент для наклона курсора для курсивного шрифта.                                                            |
|                                                        | **отмсчарслоперун**  | Компонент X для наклона курсора для курсивного шрифта.                                                            |
|                                                        | **отмасцент**         | Междустрочный зазор.                                                                                                |
|                                                        | **отмдесцент**        | Междустрочный зазор.                                                                                                |
|                                                        | **отмлинегап**        | Междустрочный зазор.                                                                                                |
|                                                        | **отмпфамилинаме**    | Идентификация шрифта.                                                                                         |
|                                                        | **отмпстиленаме**     | Идентификация шрифта.                                                                                         |
|                                                        | **отмпфуллнаме**      | Идентификация шрифта (как правило, семейство и имя стиля).                                                      |



 

Элементы **отмсчарслоперисе**, **отмсчарслоперун**, **отмасцент**, **отмдесцент** и **отмлинегап** структуры [аутлинетекстметрик](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) масштабируются или преобразуются в соответствии с текущим режимом устройства и физической высотой (как указано в элементе **tmHeight** структуры [NEWTEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-newtextmetrica) ).

Идентификация шрифта важна в тех случаях, когда приложение должно выбрать один и тот же шрифт, например при повторном открытии документа или перемещении его в другую операционную систему. Средство сопоставления шрифтов всегда выбирает правильный шрифт, когда приложение запрашивает шрифт по полному имени. Имена семейства и стиля обеспечивают ввод в диалоговом окне стандартный шрифт, что обеспечивает правильное размещение полос выбора.

Значения **отмсчарслоперисе** и **отмсчарслоперун** используются для получения приблизительного приближения основного курсивного угла шрифта. Для типичных шрифтов латиницы **отмсчарслоперисе** имеет значение 1, а **отмсчарслоперун** — 0. Для курсивных шрифтов значения попытаются приблизительно вычислить синус и косинус основного курсивного угла шрифта (в градусах против часовой стрелки по вертикали); Обратите внимание, что угол наклона для вертикальных шрифтов равен 0. Поскольку эти значения не выражаются в единицах проектирования, их не следует преобразовывать в единицы устройства.

Метрики размещения символов и межстрочного интервала позволяют приложению вычислять независимые от устройства разрывы строк, переносимые на экраны, принтеры, типесеттерс и даже платформы.

**Выполнение независимого от устройства макета страницы**

1.  Нормализация всех метрик проектирования до общего значения Ultra-High resolution (УХР) (например, 65 536 DPI); Это предотвращает округление ошибок.
2.  Вычисление разрывов строк на основе метрик УХР и физической ширины страницы; Это дает начальную точку и конечную точку линии в текстовом потоке.
3.  Вычислите ширину страницы устройства в единицах устройства (например, пикселах).
4.  Вписать каждую строку текста в ширину страницы устройства, используя разрывы строк, вычисленные на шаге 2.
5.  Вычисление разрывов страниц с использованием метрик УХР и физической длины страницы; При этом выдается количество строк на страницу.
6.  Вычислите высоту линий в единицах устройства.
7.  Разместить строки текста на странице, используя строки на странице из шага 5 и высоту строк из шага 6.

Если все приложения принимают эти приемы, разработчики могут гарантировать, что документы, перемещенные из одного приложения в другое, будут оставаться в исходном виде и формате.

 

 



