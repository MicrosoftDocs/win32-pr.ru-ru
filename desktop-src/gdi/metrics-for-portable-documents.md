---
description: В следующей таблице указаны наиболее важные метрики шрифтов для приложений, которым требуются переносимые документы и функции, позволяющие приложению извлекать их.
ms.assetid: 61f6d244-7397-42af-af58-0ab9d07bf19e
title: Метрики для переносимых документов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9c840b1b8e8014086b97098a44890f170a6bd11d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984937"
---
# <a name="metrics-for-portable-documents"></a><span data-ttu-id="7dd93-103">Метрики для переносимых документов</span><span class="sxs-lookup"><span data-stu-id="7dd93-103">Metrics for Portable Documents</span></span>

<span data-ttu-id="7dd93-104">В следующей таблице указаны наиболее важные метрики шрифтов для приложений, которым требуются переносимые документы и функции, позволяющие приложению извлекать их.</span><span class="sxs-lookup"><span data-stu-id="7dd93-104">The following table specifies the most important font metrics for applications that require portable documents and the functions that allow an application to retrieve them.</span></span>



| <span data-ttu-id="7dd93-105">Функция</span><span class="sxs-lookup"><span data-stu-id="7dd93-105">Function</span></span>                                               | <span data-ttu-id="7dd93-106">Метрика</span><span class="sxs-lookup"><span data-stu-id="7dd93-106">Metric</span></span>                | <span data-ttu-id="7dd93-107">Использовать</span><span class="sxs-lookup"><span data-stu-id="7dd93-107">Use</span></span>                                                                                                          |
|--------------------------------------------------------|-----------------------|--------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="7dd93-108">**EnumFontFamilies**</span><span class="sxs-lookup"><span data-stu-id="7dd93-108">**EnumFontFamilies**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa)           | <span data-ttu-id="7dd93-109">**нтмсизим**</span><span class="sxs-lookup"><span data-stu-id="7dd93-109">**ntmSizeEM**</span></span>         | <span data-ttu-id="7dd93-110">Получение метрик проектирования; Преобразование в метрики устройства.</span><span class="sxs-lookup"><span data-stu-id="7dd93-110">Retrieval of design metrics; conversion to device metrics.</span></span>                                                   |
| [<span data-ttu-id="7dd93-111">**жетчарабквидсс**</span><span class="sxs-lookup"><span data-stu-id="7dd93-111">**GetCharABCWidths**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-getcharabcwidthsa)           | <span data-ttu-id="7dd93-112">**абквидсс**</span><span class="sxs-lookup"><span data-stu-id="7dd93-112">**ABCWidths**</span></span>         | <span data-ttu-id="7dd93-113">Точное размещение символов в начале и в конце полей, границы рисунка и другие разрывы текста.</span><span class="sxs-lookup"><span data-stu-id="7dd93-113">Accurate placement of characters at the start and end of margins, picture boundaries, and other text breaks.</span></span> |
| [<span data-ttu-id="7dd93-114">**GetCharWidth32**</span><span class="sxs-lookup"><span data-stu-id="7dd93-114">**GetCharWidth32**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-getcharwidth32a)               | <span data-ttu-id="7dd93-115">**адванцевидсс**</span><span class="sxs-lookup"><span data-stu-id="7dd93-115">**AdvanceWidths**</span></span>     | <span data-ttu-id="7dd93-116">Размещение символов в строке.</span><span class="sxs-lookup"><span data-stu-id="7dd93-116">Placement of characters on a line.</span></span>                                                                           |
| [<span data-ttu-id="7dd93-117">**жетаутлинетекстметрикс**</span><span class="sxs-lookup"><span data-stu-id="7dd93-117">**GetOutlineTextMetrics**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) | <span data-ttu-id="7dd93-118">**отмфстипе**</span><span class="sxs-lookup"><span data-stu-id="7dd93-118">**otmfsType**</span></span>         | <span data-ttu-id="7dd93-119">Биты для встраивания шрифтов.</span><span class="sxs-lookup"><span data-stu-id="7dd93-119">Font-embedding bits.</span></span>                                                                                         |
|                                                        | <span data-ttu-id="7dd93-120">**отмсчарслоперисе**</span><span class="sxs-lookup"><span data-stu-id="7dd93-120">**otmsCharSlopeRise**</span></span> | <span data-ttu-id="7dd93-121">Y-компонент для наклона курсора для курсивного шрифта.</span><span class="sxs-lookup"><span data-stu-id="7dd93-121">Y-component for slope of cursor for italic fonts.</span></span>                                                            |
|                                                        | <span data-ttu-id="7dd93-122">**отмсчарслоперун**</span><span class="sxs-lookup"><span data-stu-id="7dd93-122">**otmsCharSlopeRun**</span></span>  | <span data-ttu-id="7dd93-123">Компонент X для наклона курсора для курсивного шрифта.</span><span class="sxs-lookup"><span data-stu-id="7dd93-123">X-component for slope of cursor for italic fonts.</span></span>                                                            |
|                                                        | <span data-ttu-id="7dd93-124">**отмасцент**</span><span class="sxs-lookup"><span data-stu-id="7dd93-124">**otmAscent**</span></span>         | <span data-ttu-id="7dd93-125">Междустрочный зазор.</span><span class="sxs-lookup"><span data-stu-id="7dd93-125">Line spacing.</span></span>                                                                                                |
|                                                        | <span data-ttu-id="7dd93-126">**отмдесцент**</span><span class="sxs-lookup"><span data-stu-id="7dd93-126">**otmDescent**</span></span>        | <span data-ttu-id="7dd93-127">Междустрочный зазор.</span><span class="sxs-lookup"><span data-stu-id="7dd93-127">Line spacing.</span></span>                                                                                                |
|                                                        | <span data-ttu-id="7dd93-128">**отмлинегап**</span><span class="sxs-lookup"><span data-stu-id="7dd93-128">**otmLineGap**</span></span>        | <span data-ttu-id="7dd93-129">Междустрочный зазор.</span><span class="sxs-lookup"><span data-stu-id="7dd93-129">Line spacing.</span></span>                                                                                                |
|                                                        | <span data-ttu-id="7dd93-130">**отмпфамилинаме**</span><span class="sxs-lookup"><span data-stu-id="7dd93-130">**otmpFamilyName**</span></span>    | <span data-ttu-id="7dd93-131">Идентификация шрифта.</span><span class="sxs-lookup"><span data-stu-id="7dd93-131">Font identification.</span></span>                                                                                         |
|                                                        | <span data-ttu-id="7dd93-132">**отмпстиленаме**</span><span class="sxs-lookup"><span data-stu-id="7dd93-132">**otmpStyleName**</span></span>     | <span data-ttu-id="7dd93-133">Идентификация шрифта.</span><span class="sxs-lookup"><span data-stu-id="7dd93-133">Font identification.</span></span>                                                                                         |
|                                                        | <span data-ttu-id="7dd93-134">**отмпфуллнаме**</span><span class="sxs-lookup"><span data-stu-id="7dd93-134">**otmpFullName**</span></span>      | <span data-ttu-id="7dd93-135">Идентификация шрифта (как правило, семейство и имя стиля).</span><span class="sxs-lookup"><span data-stu-id="7dd93-135">Font identification (typically, family and style name).</span></span>                                                      |



 

<span data-ttu-id="7dd93-136">Элементы **отмсчарслоперисе**, **отмсчарслоперун**, **отмасцент**, **отмдесцент** и **отмлинегап** структуры [аутлинетекстметрик](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) масштабируются или преобразуются в соответствии с текущим режимом устройства и физической высотой (как указано в элементе **tmHeight** структуры [NEWTEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-newtextmetrica) ).</span><span class="sxs-lookup"><span data-stu-id="7dd93-136">The **otmsCharSlopeRise**, **otmsCharSlopeRun**, **otmAscent**, **otmDescent**, and **otmLineGap** members of the [OUTLINETEXTMETRIC](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) structure are scaled or transformed to correspond to the current device mode and physical height (as specified in the **tmHeight** member of the [NEWTEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-newtextmetrica) structure).</span></span>

<span data-ttu-id="7dd93-137">Идентификация шрифта важна в тех случаях, когда приложение должно выбрать один и тот же шрифт, например при повторном открытии документа или перемещении его в другую операционную систему.</span><span class="sxs-lookup"><span data-stu-id="7dd93-137">Font identification is important in those instances when an application must select the same font, for example, when a document is reopened or moved to a different operating system.</span></span> <span data-ttu-id="7dd93-138">Средство сопоставления шрифтов всегда выбирает правильный шрифт, когда приложение запрашивает шрифт по полному имени.</span><span class="sxs-lookup"><span data-stu-id="7dd93-138">The font mapper always selects the correct font when an application requests a font by full name.</span></span> <span data-ttu-id="7dd93-139">Имена семейства и стиля обеспечивают ввод в диалоговом окне стандартный шрифт, что обеспечивает правильное размещение полос выбора.</span><span class="sxs-lookup"><span data-stu-id="7dd93-139">The family and style names provide input to the standard font dialog box, which ensures that the selection bars are properly placed.</span></span>

<span data-ttu-id="7dd93-140">Значения **отмсчарслоперисе** и **отмсчарслоперун** используются для получения приблизительного приближения основного курсивного угла шрифта.</span><span class="sxs-lookup"><span data-stu-id="7dd93-140">The **otmsCharSlopeRise** and **otmsCharSlopeRun** values are used to produce a close approximation of the main italic angle of the font.</span></span> <span data-ttu-id="7dd93-141">Для типичных шрифтов латиницы **отмсчарслоперисе** имеет значение 1, а **отмсчарслоперун** — 0.</span><span class="sxs-lookup"><span data-stu-id="7dd93-141">For typical roman fonts, **otmsCharSlopeRise** is 1 and **otmsCharSlopeRun** is 0.</span></span> <span data-ttu-id="7dd93-142">Для курсивных шрифтов значения попытаются приблизительно вычислить синус и косинус основного курсивного угла шрифта (в градусах против часовой стрелки по вертикали); Обратите внимание, что угол наклона для вертикальных шрифтов равен 0.</span><span class="sxs-lookup"><span data-stu-id="7dd93-142">For italic fonts, the values attempt to approximate the sine and cosine of the main italic angle of the font (in counterclockwise degrees past vertical); note that the italic angle for upright fonts is 0.</span></span> <span data-ttu-id="7dd93-143">Поскольку эти значения не выражаются в единицах проектирования, их не следует преобразовывать в единицы устройства.</span><span class="sxs-lookup"><span data-stu-id="7dd93-143">Because these values are not expressed in design units, they should not be converted into device units.</span></span>

<span data-ttu-id="7dd93-144">Метрики размещения символов и межстрочного интервала позволяют приложению вычислять независимые от устройства разрывы строк, переносимые на экраны, принтеры, типесеттерс и даже платформы.</span><span class="sxs-lookup"><span data-stu-id="7dd93-144">The character placement and line spacing metrics enable an application to compute device-independent line breaks that are portable across screens, printers, typesetters, and even platforms.</span></span>

<span data-ttu-id="7dd93-145">**Выполнение независимого от устройства макета страницы**</span><span class="sxs-lookup"><span data-stu-id="7dd93-145">**To perform device-independent page layout**</span></span>

1.  <span data-ttu-id="7dd93-146">Нормализация всех метрик проектирования до общего значения Ultra-High resolution (УХР) (например, 65 536 DPI); Это предотвращает округление ошибок.</span><span class="sxs-lookup"><span data-stu-id="7dd93-146">Normalize all design metrics to a common ultra-high resolution (UHR) value (for example, 65,536 DPI); this prevents round-off errors.</span></span>
2.  <span data-ttu-id="7dd93-147">Вычисление разрывов строк на основе метрик УХР и физической ширины страницы; Это дает начальную точку и конечную точку линии в текстовом потоке.</span><span class="sxs-lookup"><span data-stu-id="7dd93-147">Compute line breaks based on UHR metrics and physical page width; this yields a starting point and an ending point of a line within the text stream.</span></span>
3.  <span data-ttu-id="7dd93-148">Вычислите ширину страницы устройства в единицах устройства (например, пикселах).</span><span class="sxs-lookup"><span data-stu-id="7dd93-148">Compute the device page width in device units (for example, pixels).</span></span>
4.  <span data-ttu-id="7dd93-149">Вписать каждую строку текста в ширину страницы устройства, используя разрывы строк, вычисленные на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="7dd93-149">Fit each line of text into the device page width, using the line breaks computed in step 2.</span></span>
5.  <span data-ttu-id="7dd93-150">Вычисление разрывов страниц с использованием метрик УХР и физической длины страницы; При этом выдается количество строк на страницу.</span><span class="sxs-lookup"><span data-stu-id="7dd93-150">Compute page breaks by using UHR metrics and the physical page length; this yields the number of lines per page.</span></span>
6.  <span data-ttu-id="7dd93-151">Вычислите высоту линий в единицах устройства.</span><span class="sxs-lookup"><span data-stu-id="7dd93-151">Compute the line heights in device units.</span></span>
7.  <span data-ttu-id="7dd93-152">Разместить строки текста на странице, используя строки на странице из шага 5 и высоту строк из шага 6.</span><span class="sxs-lookup"><span data-stu-id="7dd93-152">Fit the lines of text onto the page, using the lines per page from step 5 and the line heights from step 6.</span></span>

<span data-ttu-id="7dd93-153">Если все приложения принимают эти приемы, разработчики могут гарантировать, что документы, перемещенные из одного приложения в другое, будут оставаться в исходном виде и формате.</span><span class="sxs-lookup"><span data-stu-id="7dd93-153">If all applications adopt these techniques, developers can virtually guarantee that documents moved from one application to another will retain their original appearance and format.</span></span>

 

 



