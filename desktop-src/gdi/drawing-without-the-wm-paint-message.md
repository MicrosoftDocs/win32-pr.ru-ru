---
description: Несмотря на то, что приложения выполняют большинство операций рисования во время \_ обработки сообщения WM Paint, иногда более эффективно нарисовать приложение непосредственно в окне, не полагаясь на \_ сообщение WM Paint.
ms.assetid: 2d015879-58d2-4cbe-b1cc-445f2e8fd316
title: Прорисовка без сообщения WM_PAINT
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 66695e85b700de6f62366dedb6fe082f410d4385
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103898414"
---
# <a name="drawing-without-the-wm_paint-message"></a><span data-ttu-id="efbe2-103">Рисование без сообщения WM \_ Paint</span><span class="sxs-lookup"><span data-stu-id="efbe2-103">Drawing Without the WM\_PAINT Message</span></span>

<span data-ttu-id="efbe2-104">Несмотря на то, что приложения выполняют большинство операций рисования во время обработки сообщения [**WM \_ Paint**](wm-paint.md) , иногда более эффективно нарисовать приложение непосредственно в окне, не полагаясь на сообщение **WM \_ Paint** .</span><span class="sxs-lookup"><span data-stu-id="efbe2-104">Although applications carry out most drawing operations while the [**WM\_PAINT**](wm-paint.md) message is processing, it is sometimes more efficient for an application to draw directly in a window without relying on the **WM\_PAINT** message.</span></span> <span data-ttu-id="efbe2-105">Это может быть полезно, когда пользователю требуется немедленный отзыв, например при выборе текста и перетаскивании или изменении размера объекта.</span><span class="sxs-lookup"><span data-stu-id="efbe2-105">This can be useful when the user needs immediate feedback, such as when selecting text and dragging or sizing an object.</span></span> <span data-ttu-id="efbe2-106">В таких случаях приложение обычно рисуется при обработке сообщений клавиатуры или мыши.</span><span class="sxs-lookup"><span data-stu-id="efbe2-106">In such cases, the application usually draws while processing keyboard or mouse messages.</span></span>

<span data-ttu-id="efbe2-107">Для рисования в окне без использования сообщения [**WM \_ Paint**](wm-paint.md) приложение использует функцию [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) или [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) , чтобы получить контекст устройства отображения для окна.</span><span class="sxs-lookup"><span data-stu-id="efbe2-107">To draw in a window without using a [**WM\_PAINT**](wm-paint.md) message, the application uses the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) or [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) function to retrieve a display device context for the window.</span></span> <span data-ttu-id="efbe2-108">В контексте устройства отображения приложение может нарисоваться в окне и избежать атак на другие окна.</span><span class="sxs-lookup"><span data-stu-id="efbe2-108">With the display device context, the application can draw in the window and avoid intruding into other windows.</span></span> <span data-ttu-id="efbe2-109">Когда приложение завершит рисование, оно вызывает функцию [**релеаседк**](/windows/desktop/api/Winuser/nf-winuser-releasedc) , чтобы освободить контекст устройства отображения для использования другими приложениями.</span><span class="sxs-lookup"><span data-stu-id="efbe2-109">When the application has finished drawing, it calls the [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) function to release the display device context for use by other applications.</span></span>

<span data-ttu-id="efbe2-110">При рисовании без использования сообщения [**WM \_ Paint**](wm-paint.md) приложение обычно не делает это окно недействительным.</span><span class="sxs-lookup"><span data-stu-id="efbe2-110">When drawing without using a [**WM\_PAINT**](wm-paint.md) message, the application usually does not invalidate the window.</span></span> <span data-ttu-id="efbe2-111">Вместо этого он рисуется таким образом, что он может легко восстановить окно и удалить рисунок.</span><span class="sxs-lookup"><span data-stu-id="efbe2-111">Instead, it draws in such a fashion that it can easily restore the window and remove the drawing.</span></span> <span data-ttu-id="efbe2-112">Например, когда пользователь выбирает текст или объект, приложение обычно выводит выделение путем инвертирования того, что уже есть в окне.</span><span class="sxs-lookup"><span data-stu-id="efbe2-112">For example, when the user selects text or an object, the application typically draws the selection by inverting whatever is already in the window.</span></span> <span data-ttu-id="efbe2-113">Приложение может удалить выборку и восстановить исходное содержимое окна, просто переменив его.</span><span class="sxs-lookup"><span data-stu-id="efbe2-113">The application can remove the selection and restore the original contents of the window by simply inverting again.</span></span>

<span data-ttu-id="efbe2-114">Приложение отвечает за тщательное управление любыми изменениями, которые он делает в окне.</span><span class="sxs-lookup"><span data-stu-id="efbe2-114">The application is responsible for carefully managing any changes it makes to the window.</span></span> <span data-ttu-id="efbe2-115">В частности, если приложение рисует выделение и возникает промежуточное сообщение [**WM \_ Paint**](wm-paint.md) , приложение должно убедиться, что любой рисунок, сделанный во время сообщения, не повреждает выбор.</span><span class="sxs-lookup"><span data-stu-id="efbe2-115">In particular, if an application draws a selection and an intervening [**WM\_PAINT**](wm-paint.md) message occurs, the application must ensure that any drawing done during the message does not corrupt the selection.</span></span> <span data-ttu-id="efbe2-116">Чтобы избежать этого, многие приложения удаляют выбор, выполняют обычные операции рисования, а затем восстанавливают выбор после завершения рисования.</span><span class="sxs-lookup"><span data-stu-id="efbe2-116">To avoid this, many applications remove the selection, carry out usual drawing operations, and then restore the selection when drawing is complete.</span></span>

 

 



