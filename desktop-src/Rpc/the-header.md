---
title: Заголовок
description: Следующий заголовок представляет один из стилей заголовка, которые могут быть созданы текущей версией MIDL. Для удобства здесь предоставляется полный список полей заголовков.
ms.assetid: 2078d2d9-1757-4449-9cc1-a21804654722
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0afcc9ad880278fdbcb8efc45fdabdc22ad06224
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103891009"
---
# <a name="the-header"></a>Заголовок

Следующий заголовок представляет один из стилей заголовка, которые могут быть созданы текущей версией MIDL. Для удобства здесь предоставляется полный список полей заголовков.

([**— Заголовок ОИФ**](/windows/desktop/Midl/-oi) )

``` syntax
handle_type<1> 
Oi_flags<1>
[rpc_flags<4>]
proc_num<2>  
stack_size<2>
[explicit_handle_description<>]
constant_client_buffer_size<2>
constant_server_buffer_size<2>
INTERPRETER_OPT_FLAGS<1>
number_of_params<1>
```

Расширения, начиная с Windows 2000: <8> для 32-бит, <12> для 64-bit)

``` syntax
extension_version<1>
INTERPRETER_OPT_FLAGS2<1>
ClientCorrHint<2>
ServerCorrHint<2>
NotifyIndex<2>
[ FloatDoubleMask<2> ]
```

Версия расширения \_<1> предоставляет размер раздела расширения в байтах. Это позволяет текущему модулю ОНД правильно выполнить шаг с заходом в раздел расширения, даже если этот раздел был взят из более поздней версии компилятора с дополнительными полями, чем текущий механизм понимает.

ИНТЕРПРЕТАТОР \_ OPT \_ FLAGS2 определяется следующим образом:

``` syntax
typedef struct
  {
  unsigned char   HasNewCorrDesc      : 1;    // 0x01
  unsigned char   ClientCorrCheck     : 1;    // 0x02
  unsigned char   ServerCorrCheck     : 1;    // 0x04
  unsigned char   HasNotify           : 1;    // 0x08
  unsigned char   HasNotify2          : 1;    // 0x10
  unsigned char   Unused              : 3;
  } INTERPRETER_OPT_FLAGS2, *PINTERPRETER_OPT_FLAGS2;
```

Элемент **хасневкоррдеск** указывает, используются ли новые дескрипторы корреляции в строках формата, создаваемых компилятором. Новый дескриптор корреляции связан с функцией отказа в атаке. Элементы **клиенткоррчекк** и **серверкоррчекк** задаются, когда подзадаче требуется проверка корреляции на указанной стороне.

Флаги **хаснотифи** и **HasNotify2** указывают, что подпрограммы используют функцию уведомления, как определено атрибутами **\[ \_ флага \]** **\[ Notify \]** и notify соответственно.

Элемент **клиенткоррчекк** является указанием размера кэша на стороне клиента, а **серверкоррчекк** — указанием на стороне сервера. Если размер равен нулю, следует использовать размер по умолчанию.

Элемент **нотифиндекс** является индексом для подпрограммы notify, если она используется.

Элемент **флоатдаублемаск** решает выдачу аргумента с плавающей запятой для 64-разрядной версии Windows. Это поле создается только для 64-разрядных заглушек. Маска необходима для подпрограмм сборки, которые загружают или отправляют регистры в виртуальный стек, чтобы правильно регистрировать аргументы с плавающей запятой. Маска состоит из двух бит на аргумент или, вместо регистра с плавающей запятой. Код выглядит следующим образом: наименее значимые биты соответствуют первому регистру FP, следующие два бита соответствуют второму регистру и т. д.

> [!Note]  
> Для объектных подпрограмм первый аргумент заканчивается во второй регистрации, так как этот указатель является первым. Для каждой регистрации значение битов указано в следующей таблице.

 



| Bits | Значение                                          |
|------|--------------------------------------------------|
| 01   | Значение float должно быть загружено в регистр.  |
| 10   | Значение типа Double должно быть загружено в регистр. |



 

00 и 11 — недопустимые значения для битов.

В настоящее время в 64-разрядном процессоре архитектуры Intel имеется восемь регистров FP, поэтому у маски может быть только 16b наименьший набор битов. Размер маски был установлен равным 16 битам на основе маски C-компилятора, которая остается неизменной.

## <a name="header-streamlining-for-performance"></a>Упрощение заголовка для повышения производительности

Чтобы упростить код и повысить производительность, компилятор пытается создать заголовок фиксированного размера везде, где это возможно. В частности, для асинхронной модели DCOM используется следующий заголовок:

``` syntax
typedef struct _NDR_DCOM_OI2_PROC_HEADER
  {
  unsigned char               HandleType;        // The Oi header
  INTERPRETER_FLAGS           OldOiFlags;        //
  unsigned short              RpcFlagsLow;       //
  unsigned short              RpcFlagsHi;        //
  unsigned short              ProcNum;           //
  unsigned short              StackSize;         //
  // expl handle descr is never generated        //
  unsigned short              ClientBufferSize;  // The Oi2 header
  unsigned short              ServerBufferSize;  //
  INTERPRETER_OPT_FLAGS       Oi2Flags;          //
  unsigned char               NumberParams;      //
  } NDR_DCOM_OI2_PROC_HEADER, *PNDR_DCOM_OI2_PROC_HEADER;
```

 

 