---
title: Пользовательская упаковка
description: Пользовательская упаковка в удаленном вызове процедур (RPC).
ms.assetid: 5119e959-d8b8-4fca-8910-568bb9063a9d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c901fd8c75137b4657322a89692ff8a3afb5408
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888376"
---
# <a name="user-marshal"></a>Пользовательская упаковка

Пользовательская упаковка имеет строку формата, похожую на \_ "передать как":

``` syntax
FC_USER_MARSHAL
flags<1>
quadruple_index<2>
user_type_memory_size<2>
transmitted_type_buffer size<2>
offset_to_the_transmitted_type<2>
```

Флаги<1> байт состоят из верхнего флага, а также более низкого выравнивания.

Верхние 2 бита флага используются для описания того, определен ли тип провода как уникальный указатель, указатель ссылки или отсутствие указателя (он не может быть PTR). Для установки и получения флагов определены следующие манифесты:

``` syntax
#define USER_MARSHAL_UNIQUE         0x80
#define USER_MARSHAL_REF            0x40
#define USER_MARSHAL_POINTER        0xc0  /* unique or ref */
#define USER_MARSHAL_IID            0x20  /* JIT compiler only */
```

Выравнивание по пометке в Word обеспечивает выравнивание передачи переданного типа.

Четверный \_ индекс<2> является индексом подпрограммы обратного вызова, четверной для пользовательских функций маршалирования. Ниже приведены положения подпрограмм: изменение размера, маршалирование, распаковка и освобождение подпрограммы.

\_ \_ Размер памяти пользовательского типа \_<2> предоставляет размер для конкретного типа пользователя, включая неизвестные типы.

\_Размер переданного \_ буфера типа \_<2> равен нулю, если размер изменен, или фактический фиксированный размер. Это оптимизация, позволяющая MIDL пропустить обратные вызовы при определении размера буфера, а также при освобождении.

## <a name="range"></a>Диапазон

\[Проверка диапазона \] предоставляет дополнительные средства для проверки аргументов на уровне NDR. \[Дескриптор диапазона \] имеет следующий формат:

``` syntax
FC_RANGE,   flags_type <1>
low value<4>
high value<4>
```

Флаги занимают верхнюю часть, а тип — нижнюю посекунду второго байта. Низкие и высокие значения зависят от типа проверяемой переменной.

Флаги предназначены для расширения; компилятор установил в качестве значения "ноль" значение 0.

 

 




