---
title: Дескрипторы контекста
description: Иногда для распределенных приложений требуется, чтобы серверная программа поддерживала сведения о состоянии между клиентскими вызовами.
ms.assetid: 91732a75-0a3a-44bd-9db9-c11be6fd2d70
keywords:
- Удаленный вызов процедур RPC, описание, дескрипторы контекста
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a8ff36ff8f1a36843293060e091b7eecee0d8666
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105672063"
---
# <a name="context-handles"></a><span data-ttu-id="4896b-104">Дескрипторы контекста</span><span class="sxs-lookup"><span data-stu-id="4896b-104">Context Handles</span></span>

<span data-ttu-id="4896b-105">Иногда для распределенных приложений требуется, чтобы серверная программа поддерживала сведения о состоянии между клиентскими вызовами.</span><span class="sxs-lookup"><span data-stu-id="4896b-105">It is sometimes the case that distributed applications require the server program to maintain status information between client calls.</span></span> <span data-ttu-id="4896b-106">Серверные программы, обслуживающие более одного клиента за раз, должны иметь сведения о состоянии для каждого клиента.</span><span class="sxs-lookup"><span data-stu-id="4896b-106">Server programs that service more than one client at a time must keep the state information for each client.</span></span> <span data-ttu-id="4896b-107">Так как клиент и сервер используют разные адресные пространства на разных компьютерах и не всегда являются надежными, распространенные подходы к совместному использованию данных часто не работают.</span><span class="sxs-lookup"><span data-stu-id="4896b-107">Because the client and the server use different address spaces on different computers, and they do not necessarily trust each other, common approaches to data sharing often do not work.</span></span> <span data-ttu-id="4896b-108">Например, клиент и сервер не могут поддерживать сведения о состоянии удаленного сеанса в глобальных переменных, так как они не используют одно и то же глобальное адресное пространство.</span><span class="sxs-lookup"><span data-stu-id="4896b-108">For instance, the client and server are unable to maintain status information on their remote session in global variables because they do not share the same global address space.</span></span> <span data-ttu-id="4896b-109">Трудно удержать информацию в общем файле, так как они выполняются на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="4896b-109">It is difficult to keep the information in a shared file because they run on different computers.</span></span> <span data-ttu-id="4896b-110">Упрощенный подход может быть отправкой всех состояний клиенту и возвратить его при следующем вызове, но этот подход имеет недостатки: сервер не обязательно доверяет клиенту для возврата правильного состояния, и состояние может быть неявно привязано к другому состоянию на сервере, например дескрипторы файлов или открытые сокеты.</span><span class="sxs-lookup"><span data-stu-id="4896b-110">A simplistic approach may be to ship all state to the client and have the client return it on the next call, but this approach has flaws: the server does not necessarily trust the client to return the right state, and the state may be implicitly tied to some other state on the server, such as file handles or opened sockets.</span></span>

<span data-ttu-id="4896b-111">Microsoft RPC предоставляет мощный и безопасный механизм, называемый дескрипторами контекста для сохранения состояния, связанного с данным клиентом на сервере.</span><span class="sxs-lookup"><span data-stu-id="4896b-111">Microsoft RPC provides a powerful and secure mechanism called context handles for keeping state associated with a given client on a server.</span></span> <span data-ttu-id="4896b-112">Сведения о состоянии называются контекстом сервера.</span><span class="sxs-lookup"><span data-stu-id="4896b-112">The state information is called the server's context.</span></span> <span data-ttu-id="4896b-113">Клиенты могут получить описатель контекста, чтобы определить контекст сервера для отдельных сеансов RPC.</span><span class="sxs-lookup"><span data-stu-id="4896b-113">Clients can obtain a context handle to identify the server's context for their individual RPC sessions.</span></span>

<span data-ttu-id="4896b-114">Например, каждый клиент в распределенном приложении может иметь серверную программу, которая создает и обновляет файл данных для сеанса RPC.</span><span class="sxs-lookup"><span data-stu-id="4896b-114">As an example, each client in a distributed application can have the server program create and update a data file for their RPC session.</span></span> <span data-ttu-id="4896b-115">Сервер может использовать свой файловый обработчик для каждого файла данных клиента в качестве маркера контекста.</span><span class="sxs-lookup"><span data-stu-id="4896b-115">The server can use its file handle for each client's data file as the context handle.</span></span> <span data-ttu-id="4896b-116">Каждый раз, когда клиент запрашивает операции с файлом данных, создаваемым сервером для него, клиент передает этот контекст на сервер.</span><span class="sxs-lookup"><span data-stu-id="4896b-116">Each time a client requests operations on the data file that the server creates for it, the client passes the context handle to the server.</span></span> <span data-ttu-id="4896b-117">Клиент фактически не получает сам обработчик файла; он получает непрозрачный маркер, который сервер времени выполнения RPC может однозначно связать с этим маркером файла.</span><span class="sxs-lookup"><span data-stu-id="4896b-117">The client does not actually get the file handle itself; it gets an opaque token that the server RPC run time can uniquely associate with the file handle.</span></span> <span data-ttu-id="4896b-118">Поскольку обработчик контекста действительно является файлом, контекстный обработчик имеет смысл только в адресном пространстве сервера.</span><span class="sxs-lookup"><span data-stu-id="4896b-118">Since the context handle is really a file handle, the context handle only makes sense in the server's address space.</span></span> <span data-ttu-id="4896b-119">Однако клиентская программа может использовать контекстный маркер, чтобы сообщить серверу, на каком файле выполнять обновления.</span><span class="sxs-lookup"><span data-stu-id="4896b-119">However, the client program can use the context handle to tell the server on which file to perform updates.</span></span>

<span data-ttu-id="4896b-120">Другие данные также могут быть дескрипторами контекста.</span><span class="sxs-lookup"><span data-stu-id="4896b-120">Other data can also be context handles.</span></span> <span data-ttu-id="4896b-121">Например, клиент и сервер могут использовать номер записи записи базы данных в качестве маркера файла.</span><span class="sxs-lookup"><span data-stu-id="4896b-121">For instance, a client and server can use a record number of a database record as a file handle.</span></span> <span data-ttu-id="4896b-122">Если клиент должен выполнить ряд обновлений для определенной записи, он может получить номер записи в виде маркера контекста.</span><span class="sxs-lookup"><span data-stu-id="4896b-122">If the client needed to perform a number of updates on a particular record, it could obtain the record number as a context handle.</span></span> <span data-ttu-id="4896b-123">Он передаст номер записи серверу при каждом вызове удаленной процедуры для обновления записи базы данных.</span><span class="sxs-lookup"><span data-stu-id="4896b-123">It would pass the record number to the server each time it invoked a remote procedure to update the database record.</span></span>

<span data-ttu-id="4896b-124">Чаще всего обработчик контекста указывает на блок памяти на сервере, где сервер хранит различные данные управления.</span><span class="sxs-lookup"><span data-stu-id="4896b-124">Most often a context handle points to a block of memory on the server where the server keeps various management information.</span></span>

<span data-ttu-id="4896b-125">В этом разделе представлены сведения об определении и использовании дескрипторов контекста.</span><span class="sxs-lookup"><span data-stu-id="4896b-125">This section presents information on defining and using context handles.</span></span> <span data-ttu-id="4896b-126">Обсуждение представлено в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="4896b-126">The discussion is presented in the following topics:</span></span>

-   [<span data-ttu-id="4896b-127">Разработка интерфейса с использованием дескрипторов контекста</span><span class="sxs-lookup"><span data-stu-id="4896b-127">Interface Development Using Context Handles</span></span>](interface-development-using-context-handles.md)
-   [<span data-ttu-id="4896b-128">Разработка сервера с помощью дескрипторов контекста</span><span class="sxs-lookup"><span data-stu-id="4896b-128">Server Development Using Context Handles</span></span>](server-development-using-context-handles.md)
-   [<span data-ttu-id="4896b-129">Разработка клиентов с помощью дескрипторов контекста</span><span class="sxs-lookup"><span data-stu-id="4896b-129">Client Development Using Context Handles</span></span>](client-development-using-context-handles.md)
-   [<span data-ttu-id="4896b-130">Подпрограммы запуска контекста сервера</span><span class="sxs-lookup"><span data-stu-id="4896b-130">Server Context Run-down Routine</span></span>](server-context-run-down-routine.md)
-   [<span data-ttu-id="4896b-131">Сброс контекста клиента</span><span class="sxs-lookup"><span data-stu-id="4896b-131">Client Context Reset</span></span>](client-context-reset.md)
-   [<span data-ttu-id="4896b-132">Многопоточные клиенты и дескрипторы контекста</span><span class="sxs-lookup"><span data-stu-id="4896b-132">Multithreaded Clients and Context Handles</span></span>](multithreaded-clients-and-context-handles.md)

 

 




