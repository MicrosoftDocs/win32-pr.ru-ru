---
title: Многомерные массивы
description: Атрибуты массива также можно использовать с многомерными массивами.
ms.assetid: a01b904c-fbe8-4af4-8393-6864f7ef7364
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6eb7bcf94d97e1f35fdd6ab432ea5869e47f79ed
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103987728"
---
# <a name="multidimensional-arrays"></a>Многомерные массивы

Атрибуты массива также можно использовать с многомерными массивами. Однако будьте внимательны, чтобы гарантировать, что каждое измерение массива имеет соответствующий атрибут. Пример:

``` syntax
/* IDL file */
[ 
  uuid(ba209999-0c6c-11d2-97cf-00c04f8eea45),
  version(2.0)
]
interface multiarray
{
  void arr2d( [in] short        d1size,
              [in] short        d2len,
              [in, size_is( d1size, ), length_is ( , d2len) ] long array2d[*][30] ) ;
}
```

Предыдущий массив является согласованным массивом (размером d1size) из 30 массивов элементов (с элементами d2len, поставляющимися для каждого). Запятая в круглых скобках \[ [**размера \_**](/windows/desktop/Midl/size-is) \] Attribute указывает, что значение в d1size применяется к первому измерению массива. Аналогичным образом, команда в круглых скобках \[ [**атрибута \_ length**](/windows/desktop/Midl/length-is) \] указывает, что значение в d2len применяется ко второму измерению массива.

Компилятор MIDL 2,0 предоставляет два метода для маршалирования параметров: смешанный режим (/**ОС**) и полностью интерпретируемый (/**ОИФ** или/**оикф**). По умолчанию компилятор MIDL компилирует интерфейсы в смешанном режиме. Не нужно явно указывать параметр [**/OS**](/windows/desktop/Midl/-os) для получения упакованного смешанного режима.

Полностью интерпретируемый метод маршалирует данные полностью в автономном режиме. Это значительно сокращает размер кода заглушки, но также приводит к снижению производительности. В смешанном режиме упаковки заглушки маршалируются некоторые параметры в режиме в сети. Хотя это приводит к увеличению размера заглушки, оно также обеспечивает повышенную производительность.

> [!Caution]  
> Соблюдайте осторожность при компиляции IDL-файлов в этом режиме. Использование многомерных массивов в смешанном режиме может привести к неправильному маршалировании параметров. Параметр командной строки [**/Oicf**](/windows/desktop/Midl/-oi) рекомендуется использовать, если интерфейс определяет параметры многомерных массивов.

 

Атрибут \[ [**String**](/windows/desktop/Midl/string) \] можно также использовать с многомерными массивами. Атрибут применяется к наименее значимому измерению, такому как согласованный массив строк. Можно также использовать атрибуты многомерных указателей. Пример:

``` syntax
/* IDL file */
[ 
  uuid(ba209999-0c6c-11d2-97cf-00c04f8eea45),
  version(2.0)
]
interface multiarray
{
  void arr2d([in] short  d1len,
             [in] short  d2len,
             [in] size_is(d1len, d2len) ] long  ** ptr2d) ;
}
```

В предыдущем примере переменная ptr2d является указателем на блок указателей d1len, каждый из которых указывает на значение **Long** в указателе на d2len.

Многомерные массивы не эквивалентны массивам указателей. Многомерный массив — это один большой блок данных в памяти. Массив указателей содержит только блок указателей в массиве. Данные, на которые указывают указатели, могут находиться в любом месте памяти. Кроме того, синтаксис ANSI C позволяет не указывать наиболее значимое (крайнее самое левое) измерение массива в многомерном массиве. Поэтому ниже приведена допустимая инструкция:

`long a1[] [20]`

Сравните это с следующей недопустимой инструкцией:

`long a1[20] []`

 

 