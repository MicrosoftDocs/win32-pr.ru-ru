---
title: Использование MSMQ в качестве транспорта RPC
description: Подсистема RPC поддерживает использование MSMQ в качестве транспорта в синхронном и асинхронном режимах.
ms.assetid: c3f96a91-b7bb-4c2a-8699-2100324af165
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a647fe4111e3ba4fc2ad0fe05fb7bcb48729a4c2
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103793123"
---
# <a name="using-msmq-as-an-rpc-transport"></a><span data-ttu-id="f0816-103">Использование MSMQ в качестве транспорта RPC</span><span class="sxs-lookup"><span data-stu-id="f0816-103">Using MSMQ as an RPC Transport</span></span>

<span data-ttu-id="f0816-104">Подсистема RPC поддерживает использование MSMQ в качестве транспорта в синхронном и асинхронном режимах.</span><span class="sxs-lookup"><span data-stu-id="f0816-104">The RPC subsystem supports using MSMQ as a transport in synchronous and asynchronous modes.</span></span>

<span data-ttu-id="f0816-105">В синхронном режиме используются обычные удаленные вызовы процедур.</span><span class="sxs-lookup"><span data-stu-id="f0816-105">Synchronous mode uses conventional remote procedure calls.</span></span> <span data-ttu-id="f0816-106">Эти вызовы используют хорошо известные конечные точки и транспорт очереди сообщений [нкадг \_ MQ](/windows/desktop/Midl/ncadg-mq)в качестве транспортного протокола.</span><span class="sxs-lookup"><span data-stu-id="f0816-106">These calls use well-known endpoints and the message queue transport, [ncadg\_mq](/windows/desktop/Midl/ncadg-mq), as the transport protocol.</span></span> <span data-ttu-id="f0816-107">В синхронном режиме удаленные процедуры могут иметь параметры \[ [in](/windows/desktop/Midl/in) \] и \[ [out](/windows/desktop/Midl/out-idl) , \] а также использовать стандартные службы безопасности RPC.</span><span class="sxs-lookup"><span data-stu-id="f0816-107">In synchronous mode, your remote procedures can have \[ [in](/windows/desktop/Midl/in)\] and \[ [out](/windows/desktop/Midl/out-idl)\] parameters and can use the standard RPC security services.</span></span> <span data-ttu-id="f0816-108">Подсистема RPC создает очередь ответов для удаленных вызовов, содержащих **\[ выходные \]** параметры.</span><span class="sxs-lookup"><span data-stu-id="f0816-108">The RPC subsystem creates a reply queue for remote calls containing **\[out\]** parameters.</span></span> <span data-ttu-id="f0816-109">Синхронный режим удобен для приложений, в которых клиенту требуется получение данных с сервера.</span><span class="sxs-lookup"><span data-stu-id="f0816-109">The synchronous mode is useful for applications where the client needs to receive data from the server.</span></span> <span data-ttu-id="f0816-110">Основное ограничение этого режима заключается в том, что, как и в случае обычных удаленных вызовов процедур, клиент и сервер должны работать и оставаться работающими в течение всего времени вызова.</span><span class="sxs-lookup"><span data-stu-id="f0816-110">The main limitation of this mode is that, as with conventional remote procedure calls, both the client and server must be running and remain running for the duration of the call.</span></span>

<span data-ttu-id="f0816-111">Асинхронный режим позволяет клиентским приложениям выполнять вызовы к серверу и возвращаться немедленно, независимо от состояния серверного приложения или компьютера сервера.</span><span class="sxs-lookup"><span data-stu-id="f0816-111">Asynchronous mode lets client applications make calls to the server and return immediately, regardless of the state of the server application or the server computer.</span></span> <span data-ttu-id="f0816-112">Он также делает подмножество функций MSMQ, доступных для управления очередями сообщений и информационным потоком.</span><span class="sxs-lookup"><span data-stu-id="f0816-112">It also makes a subset of MSMQ features available for managing message queues and information flow.</span></span> <span data-ttu-id="f0816-113">Функция [**рпкбиндингсетоптион**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption) позволяет управлять качеством обслуживания, приоритетом вызовов, ведением журнала, безопасностью и временем существования очереди серверных процессов.</span><span class="sxs-lookup"><span data-stu-id="f0816-113">The [**RpcBindingSetOption**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption) function lets you control quality of service, call priority, journaling, security, and the lifetime of the server process queue.</span></span> <span data-ttu-id="f0816-114">Функция [**рпксерверусепротсекепекс**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) позволяет задавать атрибуты очереди серверных процессов, такие как сохраняемость очереди, проверка подлинности и шифрование.</span><span class="sxs-lookup"><span data-stu-id="f0816-114">The [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) function lets you specify attributes of the server process queue, such as queue persistence, authentication, and encryption.</span></span>

<span data-ttu-id="f0816-115">Асинхронный MSMQ реализуется так же, как и синхронный.</span><span class="sxs-lookup"><span data-stu-id="f0816-115">You implement asynchronous MSMQ as you would synchronous MSMQ.</span></span> <span data-ttu-id="f0816-116">Необходимо использовать хорошо известные конечные точки и определить транспортный протокол как [нкадг \_ MQ](/windows/desktop/Midl/ncadg-mq).</span><span class="sxs-lookup"><span data-stu-id="f0816-116">You must use well-known endpoints, and define the transport protocol to be [ncadg\_mq](/windows/desktop/Midl/ncadg-mq).</span></span> <span data-ttu-id="f0816-117">В IDL-файле примените атрибут [Message](/windows/desktop/Midl/message) к функциям, использующим асинхронную очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="f0816-117">In your IDL file, apply the [message](/windows/desktop/Midl/message) attribute to the functions that use asynchronous message queuing.</span></span> <span data-ttu-id="f0816-118">Обратите внимание, что функции сообщений могут иметь \[ \] только параметры.</span><span class="sxs-lookup"><span data-stu-id="f0816-118">Note that message functions can have \[in\] parameters only.</span></span>

 

 