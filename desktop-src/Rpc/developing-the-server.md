---
title: Разработка сервера
description: При создании серверной программы для распределенного приложения необходимо использовать заголовочный файл и серверную заглушку, создаваемую компилятором MIDL.
ms.assetid: 2b7b14f5-5692-41b8-bb98-7edd36309d21
keywords:
- Удаленный вызов процедур RPC, задачи, разработка сервера
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0fc3405c52c48f531572ab159ad083bad93f95e0
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338729"
---
# <a name="developing-the-server"></a><span data-ttu-id="e5608-104">Разработка сервера</span><span class="sxs-lookup"><span data-stu-id="e5608-104">Developing the Server</span></span>

<span data-ttu-id="e5608-105">При создании серверной программы для распределенного приложения необходимо использовать заголовочный файл и серверную заглушку, создаваемую компилятором MIDL.</span><span class="sxs-lookup"><span data-stu-id="e5608-105">When you create a server program for a distributed application, you must use the header file and server stub that the MIDL compiler generates.</span></span> <span data-ttu-id="e5608-106">Дополнительные сведения см. [в разделе Разработка интерфейса](developing-the-interface.md).</span><span class="sxs-lookup"><span data-stu-id="e5608-106">For details, see [Developing the Interface](developing-the-interface.md).</span></span> <span data-ttu-id="e5608-107">Включите заголовочный файл в файл программы на сервере C.</span><span class="sxs-lookup"><span data-stu-id="e5608-107">Include the header file in your server C program file.</span></span> <span data-ttu-id="e5608-108">Скомпилируйте заглушку сервера с исходными файлами C, составляющими приложение.</span><span class="sxs-lookup"><span data-stu-id="e5608-108">Compile the server stub with the C source files that compose your application.</span></span> <span data-ttu-id="e5608-109">Свяжите полученные объектные файлы вместе с библиотекой импорта.</span><span class="sxs-lookup"><span data-stu-id="e5608-109">Link the resulting object files together with the import library.</span></span> <span data-ttu-id="e5608-110">Этот процесс показан на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="e5608-110">This process is illustrated in the following diagram.</span></span>

![процесс создания серверной программы для распределенного приложения](images/srvrdev.png)

<span data-ttu-id="e5608-112">Как видно из примера на рисунке, для определения интерфейса использовался MIDL-файл с именем MyApp. idl.</span><span class="sxs-lookup"><span data-stu-id="e5608-112">As you can see from the example in the illustration, a MIDL file called MyApp.idl was used to define the interface.</span></span> <span data-ttu-id="e5608-113">Компилятор MIDL использовал MyApp. IDL для создания MyApp \_ s. c и MyApp. h.</span><span class="sxs-lookup"><span data-stu-id="e5608-113">The MIDL compiler used MyApp.idl to produce MyApp\_s.c and MyApp.h.</span></span> <span data-ttu-id="e5608-114">Он также создает исходный файл на языке C для клиентской заглушки, но это не относится к конкретному обсуждению.</span><span class="sxs-lookup"><span data-stu-id="e5608-114">It also produces a C source file for the client stub, but that is not relevant to this particular discussion.</span></span> <span data-ttu-id="e5608-115">Исходный файл C для серверной программы (в данном случае Мисрвр. C) должен включать файл MyApp. h.</span><span class="sxs-lookup"><span data-stu-id="e5608-115">The C source file for the server program (in this case, Mysrvr.c) must include the file Myapp.h.</span></span> <span data-ttu-id="e5608-116">Кроме того, необходимо включить файлы RPC. h и Рпкндр. h.</span><span class="sxs-lookup"><span data-stu-id="e5608-116">It will also need to include the files Rpc.h and Rpcndr.h.</span></span>

<span data-ttu-id="e5608-117">Серверное приложение было разработано в двух файлах: Мисрвр. c и Рпрокс. c.</span><span class="sxs-lookup"><span data-stu-id="e5608-117">The server application was developed in two files, Mysrvr.c and Rprocs.c.</span></span> <span data-ttu-id="e5608-118">Файл Мисрвр. c содержит функции, необходимые для установления и запуска серверной программы.</span><span class="sxs-lookup"><span data-stu-id="e5608-118">The file Mysrvr.c contains the functions necessary for getting the server program up and running.</span></span> <span data-ttu-id="e5608-119">Удаленные процедуры, предлагаемые серверной программой, содержатся в файле Рпрокс. c.</span><span class="sxs-lookup"><span data-stu-id="e5608-119">The remote procedures that the server program offers are contained in the file Rprocs.c.</span></span>

<span data-ttu-id="e5608-120">Файлы Мисрвр. c и Рпрокс. c были скомпилированы вместе с MyApp \_ s. c для создания объектных файлов.</span><span class="sxs-lookup"><span data-stu-id="e5608-120">The files Mysrvr.c and Rprocs.c were compiled together with Myapp\_s.c to produce object files.</span></span> <span data-ttu-id="e5608-121">Объектные файлы затем были связаны с библиотекой времени выполнения RPC и другими библиотеками, которые могут потребоваться.</span><span class="sxs-lookup"><span data-stu-id="e5608-121">The object files were then linked with the RPC run-time library, and any other libraries that they might need.</span></span> <span data-ttu-id="e5608-122">Результатом является исполняемая программа сервера с именем Mysrvr.exe.</span><span class="sxs-lookup"><span data-stu-id="e5608-122">The result is an executable server program named Mysrvr.exe.</span></span>

<span data-ttu-id="e5608-123">Если вы не компилируете IDL-файл в режиме совместимости Open Software Foundation (использование) ([**/ОСФ**](/windows/desktop/Midl/-osf)), серверная программа должна предоставить функцию для выделения памяти и функцию для ее освобождения.</span><span class="sxs-lookup"><span data-stu-id="e5608-123">If you do not compile your IDL file in Open Software Foundation (OSF) compatibility mode ([**/osf**](/windows/desktop/Midl/-osf)), your server program must provide a function for allocating memory and a function for deallocating it.</span></span> <span data-ttu-id="e5608-124">Для Windows 2000 и более поздних версий Windows рекомендуется использовать режим [**/Oicf**](/windows/desktop/Midl/-oi).</span><span class="sxs-lookup"><span data-stu-id="e5608-124">For Windows 2000 and later versions of Windows, the recommended mode is [**/Oicf**](/windows/desktop/Midl/-oi).</span></span> <span data-ttu-id="e5608-125">Дополнительные сведения см. в статье [о выделении и](how-memory-is-allocated-and-deallocated.md)освобождении памяти и назначении [указателей и выделении памяти](pointers-and-memory-allocation.md).</span><span class="sxs-lookup"><span data-stu-id="e5608-125">For details, see [How Memory Is Allocated and Deallocated](how-memory-is-allocated-and-deallocated.md), and [Pointers and Memory Allocation](pointers-and-memory-allocation.md).</span></span>

 

 