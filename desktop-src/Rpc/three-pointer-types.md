---
title: Три типа указателей
description: MIDL поддерживает три типа указателей для размещения широкого спектра приложений.
ms.assetid: 6684c252-6fbe-49ca-9967-6d4baf5dc298
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: efdcc9548568c8fca24d8abb40bf0eaa8b6e7da3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103987553"
---
# <a name="three-pointer-types"></a><span data-ttu-id="169d6-103">Три типа указателей</span><span class="sxs-lookup"><span data-stu-id="169d6-103">Three Pointer Types</span></span>

<span data-ttu-id="169d6-104">MIDL поддерживает три типа указателей для размещения широкого спектра приложений.</span><span class="sxs-lookup"><span data-stu-id="169d6-104">MIDL supports three types of pointers to accommodate a wide range of applications.</span></span> <span data-ttu-id="169d6-105">Три разных уровня называются ссылками, уникальными и полными указателями, и они обозначаются атрибутами **\[** [**ref**](/windows/desktop/Midl/ref) **\]** , **\[** [**UNIQUE**](/windows/desktop/Midl/unique) **\]** и **\[** [**ptr**](/windows/desktop/Midl/ptr) **\]** соответственно.</span><span class="sxs-lookup"><span data-stu-id="169d6-105">The three different levels are called reference, unique, and full pointers, and are indicated by the attributes **\[**[**ref**](/windows/desktop/Midl/ref)**\]**, **\[**[**unique**](/windows/desktop/Midl/unique)**\]**, and **\[**[**ptr**](/windows/desktop/Midl/ptr)**\]**, respectively.</span></span> <span data-ttu-id="169d6-106">Классы указателей, описываемые этими атрибутами, являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="169d6-106">The pointer classes described by these attributes are mutually exclusive.</span></span> <span data-ttu-id="169d6-107">Атрибуты указателя можно применять к указателям в определениях типов, возвращаемых функцией типов, параметрах функций, членам структур или объединений, а также элементам массива.</span><span class="sxs-lookup"><span data-stu-id="169d6-107">Pointer attributes can be applied to pointers in type definitions, function return types, function parameters, members of structures or unions, or array elements.</span></span>

<span data-ttu-id="169d6-108">Внедренные указатели — это указатели, которые являются элементами структур или объединений.</span><span class="sxs-lookup"><span data-stu-id="169d6-108">Embedded pointers are pointers that are members of structures or unions.</span></span> <span data-ttu-id="169d6-109">Они также могут быть элементами массивов.</span><span class="sxs-lookup"><span data-stu-id="169d6-109">They can also be elements of arrays.</span></span> <span data-ttu-id="169d6-110">В **\[** [](/windows/desktop/Midl/in) **\]** направлении внедренные указатели **\[ ref \]** предполагают указание на допустимое хранилище и не должны иметь значение null.</span><span class="sxs-lookup"><span data-stu-id="169d6-110">In the **\[**[**in**](/windows/desktop/Midl/in)**\]** direction, embedded **\[ref\]** pointers are assumed to be pointing to valid storage and must not be null.</span></span> <span data-ttu-id="169d6-111">Эта ситуация рекурсивно применяется к любым **\[ ссылочным \]** указателям, на которые они указывают.</span><span class="sxs-lookup"><span data-stu-id="169d6-111">This situation is recursively applicable to any **\[ref\]** pointers they are pointing to.</span></span> <span data-ttu-id="169d6-112">В направлении внедренные **\[ уникальные \]** и полные указатели (указатели с атрибутом **\[ ptr \]** ) могут иметь или не иметь значение null. **\[ \]**</span><span class="sxs-lookup"><span data-stu-id="169d6-112">In the **\[in\]** direction, embedded **\[unique\]** and full pointers (pointers with the **\[ptr\]** attribute) may or may not be null.</span></span>

<span data-ttu-id="169d6-113">Любой атрибут указателя, помещаемый в параметр в синтаксисе объявления функции, влияет только на декларатор самого правого указателя для этого параметра.</span><span class="sxs-lookup"><span data-stu-id="169d6-113">Any pointer attribute placed on a parameter in the syntax of a function declaration affects only the rightmost pointer declarator for that parameter.</span></span> <span data-ttu-id="169d6-114">Чтобы задействовать другие деклараторы указателя, необходимо использовать промежуточные именованные типы.</span><span class="sxs-lookup"><span data-stu-id="169d6-114">To affect other pointer declarators, intermediate named types must be used.</span></span>

<span data-ttu-id="169d6-115">Функции, возвращающие указатель, могут иметь атрибут указателя в качестве атрибута функции.</span><span class="sxs-lookup"><span data-stu-id="169d6-115">Functions that return a pointer can have a pointer attribute as a function attribute.</span></span> <span data-ttu-id="169d6-116">Атрибуты **\[ Unique \]** и **\[ ptr \]** должны применяться к типам возвращаемых функцией функций.</span><span class="sxs-lookup"><span data-stu-id="169d6-116">The **\[unique\]** and **\[ptr\]** attributes must be applied to function return types.</span></span> <span data-ttu-id="169d6-117">Объявления членов, являющиеся указателями, могут указывать атрибут указателя в качестве атрибута поля.</span><span class="sxs-lookup"><span data-stu-id="169d6-117">Member declarations that are pointers can specify a pointer attribute as a field attribute.</span></span> <span data-ttu-id="169d6-118">Атрибут указателя можно также применить как атрибут типа в конструкциях [**typedef**](/windows/desktop/Midl/typedef) .</span><span class="sxs-lookup"><span data-stu-id="169d6-118">A pointer attribute can also be applied as a type attribute in [**typedef**](/windows/desktop/Midl/typedef) constructs.</span></span>

<span data-ttu-id="169d6-119">Если атрибут указателя не указан в качестве поля или атрибута типа, атрибуты указателя применяются в соответствии с правилами для объявления неатрибутивного указателя, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="169d6-119">When no pointer attribute is specified as a field or type attribute, pointer attributes are applied according to the rules for an unattributed pointer declaration as follows.</span></span>

<span data-ttu-id="169d6-120">В режиме совместимости DCE атрибуты указателя определяются в определяющем IDL-файле.</span><span class="sxs-lookup"><span data-stu-id="169d6-120">In DCE-compatibility mode, pointer attributes are determined in the defining IDL file.</span></span> <span data-ttu-id="169d6-121">Если **\[** в определяющем интерфейсе указан атрибут [**указателя \_ по умолчанию**](/windows/desktop/Midl/pointer-default) **\]** , то используется этот атрибут.</span><span class="sxs-lookup"><span data-stu-id="169d6-121">If there is a **\[**[**pointer\_default**](/windows/desktop/Midl/pointer-default)**\]** attribute specified in the defining interface, that attribute is used.</span></span> <span data-ttu-id="169d6-122">Если атрибут **\[ указателя \_ по \] умолчанию** отсутствует, все указатели без атрибутов являются полными указателями.</span><span class="sxs-lookup"><span data-stu-id="169d6-122">If no **\[pointer\_default\]** attribute is present, all unattributed pointers are full pointers.</span></span>

<span data-ttu-id="169d6-123">В режиме расширений Майкрософт атрибуты указателя могут быть определены путем импорта IDL-файлов и применяются в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="169d6-123">In Microsoft-extensions mode, pointer attributes can be determined by importing IDL files and are applied in the following order:</span></span>

1.  <span data-ttu-id="169d6-124">Явный атрибут указателя, примененный на сайте использования.</span><span class="sxs-lookup"><span data-stu-id="169d6-124">An explicit pointer attribute applied at the use site.</span></span>
2.  <span data-ttu-id="169d6-125">Атрибут **\[ ref \]** , если указатель без атрибута является параметром указателя верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="169d6-125">The **\[ref\]** attribute, when the unattributed pointer is a top-level pointer parameter.</span></span>
3.  <span data-ttu-id="169d6-126">Атрибут **\[ указателя \_ по \] умолчанию** , указанный в определяющем интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="169d6-126">A **\[pointer\_default\]** attribute specified in the defining interface.</span></span>
4.  <span data-ttu-id="169d6-127">Атрибут **\[ указателя \_ по \] умолчанию** , указанный в базовом интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="169d6-127">A **\[pointer\_default\]** attribute specified in the base interface.</span></span>
5.  <span data-ttu-id="169d6-128">**\[ Уникальный \]** атрибут.</span><span class="sxs-lookup"><span data-stu-id="169d6-128">The **\[unique\]** attribute.</span></span>

<span data-ttu-id="169d6-129">Атрибут **\[** [**интерфейса \_ по умолчанию указателя**](/windows/desktop/Midl/pointer-default) **\]** задает атрибуты указателя по умолчанию, применяемые к декларатору указателя в типе, параметре или объявлении возвращаемого типа, если к этому объявлению не применен явный атрибут указателя.</span><span class="sxs-lookup"><span data-stu-id="169d6-129">The **\[**[**pointer\_default**](/windows/desktop/Midl/pointer-default)**\]** interface attribute specifies the default pointer attributes to be applied to a pointer declarator in a type, parameter, or return type declaration when that declaration does not have an explicit pointer attribute applied to it.</span></span> <span data-ttu-id="169d6-130">Атрибут интерфейса **\[ \_ по \] умолчанию указателя** не применяется к неатрибутному указателю верхнего уровня параметра, который считается **\[ ссылочным \]**.</span><span class="sxs-lookup"><span data-stu-id="169d6-130">The **\[pointer\_default\]** interface attribute does not apply to an unattributed top-level pointer of a parameter, which is assumed to be **\[ref\]**.</span></span>

 

 