---
title: Функция midl_user_free
description: '\_Пользовательская \_ функция MIDL должна предоставляться разработчиками RPC.'
ms.assetid: 5e940e93-bdd4-48cc-b84e-654637699719
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dd6ca52635da5bedb60fdc7f94165ad9c888c030d5fe3340c53dfc970a90ff49
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120080824"
---
# <a name="the-midl_user_free-function"></a>\_ \_ Функция Free пользователя MIDL

**\_ Пользовательская \_ функция MIDL** должна предоставляться разработчиками RPC. Она выделяет память для заглушек RPC и подпрограмм библиотеки. Функция **\_ \_ бесплатного пользователя MIDL** должна соответствовать следующему прототипу:

``` syntax
void __RPC_USER midl_user_free(void * pBuffer);
```

Параметр *pBuffer* указывает указатель на память, которая должна быть освобождена. Как клиентское приложение, так и серверное приложение должны реализовывать функцию **\_ пользовательского \_ освобождения MIDL** , если только не выполняется компиляция в режиме использование-Compatibility ([**/ОСФ**](/windows/desktop/Midl/-osf)). Функция **\_ \_ бесплатного пользователя MIDL** должна иметь возможность освободить все хранилище, выделенное [**пользователем MIDL \_ \_**](the-midl-user-allocate-function.md).

Приложения и заглушки **вызывают \_ \_ свободный пользователь MIDL** при работе с выделенными объектами:

-   Серверное приложение должно вызывать **MIDL \_ user \_ бесплатно** для освобождения памяти, выделенной приложением, например при удалении динамически выделенного узла данных.
-   Заглушка сервера вызывает **метод \_ MIDL \_ ,** чтобы освободить память на сервере после маршалирования всех \[ \] аргументов out, in, \[ \] \[ out \] и возвращаемого значения функции.

например, пример программы RPC Windows, которая отображает "Hello, world", реализует небезопасный **\_ пользователь \_ midl** в терминах функции C:


```C++
void __RPC_USER midl_user_free(void __RPC_FAR * p)
{
    free(p);
}
```



> [!Note]  
> Если пакет RPCSS включен (например, в результате использования \[ атрибута [**включения \_ выделения**](/windows/desktop/Midl/enable-allocate) \] ), серверная программа должна использовать [**рпксмфри**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmfree) для освобождения памяти. Дополнительные сведения см. в статье [пакет управления памятью RPCSS](rpcss-memory-management-package.md).

 

 

 