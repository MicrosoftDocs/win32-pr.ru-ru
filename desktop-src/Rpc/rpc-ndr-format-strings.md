---
title: Строки формата NDR для RPC
description: Строки формата ОНД для удаленного вызова процедур (RPC).
ms.assetid: 9c83a039-49d3-491d-8110-29d1548730de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cf0569a913d6c5a4b19b342cc288d6a8682dfc4a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103891013"
---
# <a name="rpc-ndr-format-strings"></a>Строки формата NDR для RPC

## <a name="ndr-engine-32-bit-interpreter"></a>Модуль NDR: 32-разрядный интерпретатор

В этом документе описываются дескрипторы строк формата, иногда называемые MOPs, для подсистемы доставки 32-бит NDR. В этом разделе описываются изменения, связанные с развитием, от интерпретатора [**– Oi**](/windows/desktop/Midl/-oi) до уровня интерпретатора **– ОИФ** , а также дополнений, связанных с каналами и асинхронной поддержкой.

В этом документе описывается текущая технология язык MIDL (MIDL) с точки зрения ядра и текущая подсистема NDR.

## <a name="overview"></a>Обзор

Модуль NDR — это модуль упаковки компонентов удаленного вызова процедур (RPC) и DCOM. Он обрабатывает все проблемы, связанные с заглушкой удаленного вызова. В качестве процесса маршалирование ОНД управляется кодом C из заглушек, созданных MIDL, генератором JIT-типа MIDL или заглушками, созданными другими инструментами или написанными вручную. В свою очередь, подсистема доставки ОНД управляет базовым временем выполнения (DCOM или RPC), которое взаимодействует с конкретными транспортами.

Первоначальной целью разработки было предоставление средства для эффективного маршалирования произвольных данных на основе информации, предоставляемой компилятором MIDL. Строки формата, описанные в этом документе, и фактически все сведения, создаваемые компилятором для использования модуля NDR, всегда считаются внутренним интерфейсом между компилятором и ядром. Аналогично, интерфейсы, доступные механизму для обработки проблем во время выполнения, также являются внутренними (некоторые исключения существуют на стороне среды выполнения RPC, а некоторые интерфейсы DCOM, используемые ядром, являются внешними).

Два типичных подхода к упаковке всегда были встроенными и управляемыми данными (интерпретируемыми) технологиями. MIDL поддерживает оба параметра [**– OS**](/windows/desktop/Midl/-os) и [**– Oi \***](/windows/desktop/Midl/-oi) в заглушках, созданных C. Кроме того, MIDL может создавать библиотеки TLB, используемые пакетом oleautomation. Соответственно, одна из точек внутренних компонентов ядра заключается в том, что она состоит из двух частей.

Первый — это набор подпрограмм, которые обрабатывали изменение размера, маршалирование и т. д., соответствующие типичным объектам типа данных, таким как структура или массив. Эти подпрограммы точно настроены для повышения производительности; Например, они обычно пытаются блокировать и копировать данные везде, где это возможно. Эта часть часто называется основной подсистемой NDR.

Вторая часть состоит из интерпретатора и связанных с ним частей. Интерпретатор использует подпрограммы из основной подсистемы доставки ОНД, как если бы из внутренней библиотеки выполнить удаленный вызов со всеми его аргументами, упакованными и неупакованными, в зависимости от ситуации.

Основная подсистема ОНД используется аналогичным образом независимо от того, используется ли из встроенных заглушек или интерпретатора. Все подпрограммы ядра СУБД зависят от состояния, переданного структурой сообщений-заглушек. Структура настраивается соответствующим образом встроенной заглушкой или интерпретатором. В течение нескольких лет ядро ядра использовалось в другом контексте. в настоящее время интерпретатор представляет собой набор из нескольких отдельных циклов интерпретатора. Они связаны со старыми и новыми интерпретаторами ([**– Oi**](/windows/desktop/Midl/-oi) и **– ОИФ**), а также с циклами, связанными с сериализацией данных (в области выбора), асинхронной поддержкой RPC и поддержкой асинхронной поддержки DCOM (RPC и DCOM имеют разные модели асинхронного программирования).

Помимо добавления новых функций, важным аспектом развития механизма NDR является общий сдвиг в подходе к интерпретаторам. ОНД версии 1.1 была проведена в рамках нового подхода MIDL 2,0 для упаковки, а встроенные заглушки предпочтительны для соображений производительности. С последней версией NDR, [**– ОИФ**](/windows/desktop/Midl/-oi) стал наиболее широко используемым режимом компилятора, почти до исключения встроенных заглушек.

Дескрипторы строк формата модуля NDR RPC более подробно описаны в следующих разделах:

-   [Строки форматирования](format-strings.md)
-   [Строки формата процедур](procedure-format-strings.md)
-   [Дескриптор заголовка процедуры](procedure-header-descriptor.md)
-   [Handles](handles.md)
-   [Заголовок](the-header.md)
-   [Дескрипторы параметров](parameter-descriptors.md)
-   [Строки формата типов](type-format-strings.md)

 

 