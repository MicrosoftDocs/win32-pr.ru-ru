---
title: Настройка компьютеров для RPC через HTTP
description: Чтобы использовать протокол HTTP в качестве транспортного протокола для RPC, прокси-сервер RPC, запущенный в Internet Information Server (IIS), должен быть настроен в сети серверной программы.
ms.assetid: 5a67af51-924a-4f2b-b013-a4fd1bfaeddd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 62d1b39276633f3b827f778deef77edd5630c599
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105650286"
---
# <a name="configuring-computers-for-rpc-over-http"></a><span data-ttu-id="4177f-103">Настройка компьютеров для RPC через HTTP</span><span class="sxs-lookup"><span data-stu-id="4177f-103">Configuring Computers for RPC over HTTP</span></span>

<span data-ttu-id="4177f-104">Чтобы использовать протокол HTTP в качестве транспортного протокола для RPC, прокси-сервер RPC, запущенный в Internet Information Server (IIS), должен быть настроен в сети серверной программы.</span><span class="sxs-lookup"><span data-stu-id="4177f-104">To use HTTP as a transport protocol for RPC, RPC Proxy running within Internet Information Server (IIS) must be configured on the server program's network.</span></span> <span data-ttu-id="4177f-105">В этом разделе описываются параметры конфигурации.</span><span class="sxs-lookup"><span data-stu-id="4177f-105">This section describes configuration options.</span></span> <span data-ttu-id="4177f-106">Рекомендации по оптимальным методикам программирования и настройки при использовании RPC через HTTP см. в статье [рекомендации по развертыванию RPC по](rpc-over-http-deployment-recommendations.md)протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="4177f-106">For recommendations on best programming and configuration practices when using RPC over HTTP, see [RPC over HTTP Deployment Recommendations](rpc-over-http-deployment-recommendations.md).</span></span> <span data-ttu-id="4177f-107">Основная задача — Настройка прокси-сервера RPC для приема и переадресации подключений RPC через HTTP к серверной программе RPC через HTTP.</span><span class="sxs-lookup"><span data-stu-id="4177f-107">The primary task is configuring the RPC Proxy to accept and forward RPC over HTTP connections to an RPC over HTTP server program.</span></span>

<span data-ttu-id="4177f-108">Сначала необходимо установить службы IIS на компьютере, на котором запущен прокси-сервер RPC.</span><span class="sxs-lookup"><span data-stu-id="4177f-108">IIS must first be installed on the machine running the RPC Proxy.</span></span> <span data-ttu-id="4177f-109">После установки служб IIS устанавливается прокси-сервер RPC.</span><span class="sxs-lookup"><span data-stu-id="4177f-109">Once IIS is installed, the RPC Proxy is installed.</span></span> <span data-ttu-id="4177f-110">Службы IIS и прокси-сервер RPC можно установить одновременно с помощью компонента " **Установка и удаление компонентов Windows** " на панели управления.</span><span class="sxs-lookup"><span data-stu-id="4177f-110">Both IIS and the RPC Proxy can be installed simultaneously from **Add/Remove Windows Components** in the Control Panel.</span></span> <span data-ttu-id="4177f-111">Прокси-сервер RPC устанавливается из **сетевых служб** и называется **прокси-сервером RPC через HTTP** в программе установки Windows.</span><span class="sxs-lookup"><span data-stu-id="4177f-111">RPC Proxy is installed from **Networking Services**, and is called **RPC over HTTP Proxy** in Windows setup.</span></span> <span data-ttu-id="4177f-112">Если одновременно установлены службы IIS и RPC-прокси, Windows гарантирует их установку в правильном порядке.</span><span class="sxs-lookup"><span data-stu-id="4177f-112">If both IIS and RPC Proxy are installed at the same time, Windows ensures they are installed in the proper order.</span></span>

> [!Note]  
> <span data-ttu-id="4177f-113">После завершения установки необходимо перезапустить службы IIS, если они были запущены в процессе установки.</span><span class="sxs-lookup"><span data-stu-id="4177f-113">After installation is complete, IIS must be restarted if it was running during the installation process.</span></span>

 

<span data-ttu-id="4177f-114">После установки прокси-сервера RPC необходимо выполнить некоторые дополнительные задачи настройки.</span><span class="sxs-lookup"><span data-stu-id="4177f-114">After installed of the RPC Proxy, some additional configuration tasks must be performed:</span></span>

1.  <span data-ttu-id="4177f-115">Откройте оснастку консоли MMC IIS и настройте виртуальный каталог RPC для прокси-сервера, как описано в [подсистеме безопасности RPC по протоколу HTTP](rpc-over-http-security.md).</span><span class="sxs-lookup"><span data-stu-id="4177f-115">Open the IIS MMC snap-in and configure the RPC Proxy virtual directory to require security, as explained in [RPC over HTTP Security](rpc-over-http-security.md).</span></span> <span data-ttu-id="4177f-116">Этот шаг необходим только в том случае, если вы планируете использовать RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-116">This step is required only if you plan to use RPC over HTTP v2.</span></span>
2.  <span data-ttu-id="4177f-117">Если на сервере IIS не установлен сертификат, для использования SSL при взаимодействии с прокси-сервером RPC необходимо получить и установить действительный сертификат.</span><span class="sxs-lookup"><span data-stu-id="4177f-117">If IIS does not have a certificate installed, a valid certificate must be obtained and installed for that computer in order to use SSL when communicating with the RPC Proxy.</span></span> <span data-ttu-id="4177f-118">Этот шаг относится только к RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-118">This step is relevant only for RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-119">Так как RPC через HTTP v1 не поддерживает SSL, этот шаг можно опустить для RPC через HTTP v1.</span><span class="sxs-lookup"><span data-stu-id="4177f-119">Since RPC over HTTP v1 does not support SSL, this step can be omitted for RPC over HTTP v1.</span></span>
3.  <span data-ttu-id="4177f-120">Задайте ключ **ValidPorts** , как описано в статье [безопасность RPC через HTTP](rpc-over-http-security.md).</span><span class="sxs-lookup"><span data-stu-id="4177f-120">Set the **ValidPorts** key as described in [RPC over HTTP Security](rpc-over-http-security.md).</span></span>

<span data-ttu-id="4177f-121">По завершении этих задач настройки прокси-сервер RPC через HTTP готов к пересылке запросов от клиента RPC через HTTP к серверу RPC через HTTP.</span><span class="sxs-lookup"><span data-stu-id="4177f-121">When these configuration tasks are completed, the RPC over HTTP proxy is ready to forward requests from the RPC over HTTP client to the RPC over HTTP server.</span></span>

## <a name="rpc-over-http-registry-keys"></a><span data-ttu-id="4177f-122">Ключи реестра RPC через HTTP</span><span class="sxs-lookup"><span data-stu-id="4177f-122">RPC over HTTP Registry Keys</span></span>

<span data-ttu-id="4177f-123">В этом разделе описываются дополнительные разделы реестра, используемые для настройки клиента, сервера или прокси-сервера RPC при подключении RPC через HTTP.</span><span class="sxs-lookup"><span data-stu-id="4177f-123">This section explains additional registry keys used to configure the client, server or RPC Proxy in an RPC over HTTP connection.</span></span> <span data-ttu-id="4177f-124">Как правило, эти ключи не являются обязательными; они предоставляются здесь для полноты.</span><span class="sxs-lookup"><span data-stu-id="4177f-124">These keys are generally not required; they are provided here for completeness.</span></span>

<span data-ttu-id="4177f-125">**HKLM \\ Software \\ Microsoft \\ RPC \\ дефаултчаннеллифетиме**</span><span class="sxs-lookup"><span data-stu-id="4177f-125">**HKLM\\Software\\Microsoft\\Rpc\\DefaultChannelLifetime**</span></span>

<span data-ttu-id="4177f-126">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-126">DWORD.</span></span> <span data-ttu-id="4177f-127">Переопределяет время существования канала по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4177f-127">Overrides the default channel lifetime.</span></span> <span data-ttu-id="4177f-128">Используется на клиенте и прокси-сервере RPC.</span><span class="sxs-lookup"><span data-stu-id="4177f-128">Used on the client and the RPC Proxy.</span></span> <span data-ttu-id="4177f-129">Время жизни канала выражается в байтах.</span><span class="sxs-lookup"><span data-stu-id="4177f-129">The channel lifetime is expressed in bytes.</span></span> <span data-ttu-id="4177f-130">Если значение не указано, используется 1 ГБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-130">If not specified, 1GB is used.</span></span> <span data-ttu-id="4177f-131">Используется только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-131">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-132">При изменении прокси-сервера RPC необходимо перезапустить службы IIS, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="4177f-132">When changed on RPC Proxy, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="4177f-133">**HKLM \\ Software \\ Microsoft \\ RPC \\ клиентрецеивевиндов**</span><span class="sxs-lookup"><span data-stu-id="4177f-133">**HKLM\\Software\\Microsoft\\Rpc\\ClientReceiveWindow**</span></span>

<span data-ttu-id="4177f-134">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-134">DWORD.</span></span> <span data-ttu-id="4177f-135">При наличии указывает окно приема, используемое клиентом для данных, полученных от прокси-сервера RPC.</span><span class="sxs-lookup"><span data-stu-id="4177f-135">When present, specifies the receive window used by the client for data received from the RPC Proxy.</span></span> <span data-ttu-id="4177f-136">Минимальное допустимое значение — 8 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-136">The minimum valid value is 8K.</span></span> <span data-ttu-id="4177f-137">Максимальное значение — 1 ГБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-137">The maximum is 1GB.</span></span> <span data-ttu-id="4177f-138">Если значение не указано, используется 64 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-138">If the value is not present, 64K is used.</span></span> <span data-ttu-id="4177f-139">Используется только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-139">Used only in RPC over HTTP v2.</span></span>

\-

<span data-ttu-id="4177f-140">**HKLM \\ Software \\ Microsoft \\ RPC \\ инпроксирецеивевиндов**</span><span class="sxs-lookup"><span data-stu-id="4177f-140">**HKLM\\Software\\Microsoft\\Rpc\\InProxyReceiveWindow**</span></span>

<span data-ttu-id="4177f-141">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-141">DWORD.</span></span> <span data-ttu-id="4177f-142">При наличии указывает окно приема, используемое прокси-сервером RPC для данных, полученных от клиента.</span><span class="sxs-lookup"><span data-stu-id="4177f-142">When present, specifies the receive window used by the RPC Proxy for data received from the client.</span></span> <span data-ttu-id="4177f-143">Минимальное допустимое значение — 8 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-143">The minimum valid value is 8K.</span></span> <span data-ttu-id="4177f-144">Максимальное значение — 1 ГБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-144">The maximum is 1GB.</span></span> <span data-ttu-id="4177f-145">Если значение не указано, используется 64 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-145">If the value is not present, 64K is used.</span></span> <span data-ttu-id="4177f-146">Используется только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-146">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-147">При внесении изменений в это значение необходимо перезапустить службы IIS, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="4177f-147">When changes are made to this value, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="4177f-148">**HKLM \\ Software \\ Microsoft \\ RPC \\ аутпроксирецеивевиндов**</span><span class="sxs-lookup"><span data-stu-id="4177f-148">**HKLM\\Software\\Microsoft\\Rpc\\OutProxyReceiveWindow**</span></span>

<span data-ttu-id="4177f-149">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-149">DWORD.</span></span> <span data-ttu-id="4177f-150">При наличии указывает окно приема, используемое прокси-сервером RPC для данных, полученных с сервера.</span><span class="sxs-lookup"><span data-stu-id="4177f-150">When present, specifies the receive window used by the RPC Proxy for data received from the server.</span></span> <span data-ttu-id="4177f-151">Минимальное допустимое значение — 8 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-151">The minimum valid value is 8K.</span></span> <span data-ttu-id="4177f-152">Максимальное значение — 1 ГБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-152">The maximum is 1GB.</span></span> <span data-ttu-id="4177f-153">Если значение не указано, используется 64 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-153">If the value is not present, 64K is used.</span></span> <span data-ttu-id="4177f-154">Используется только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-154">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-155">При внесении изменений в это значение необходимо перезапустить службы IIS, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="4177f-155">When changes are made to this value, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="4177f-156">**HKLM \\ Software \\ Microsoft \\ RPC \\ серверрецеивевиндов**</span><span class="sxs-lookup"><span data-stu-id="4177f-156">**HKLM\\Software\\Microsoft\\Rpc\\ServerReceiveWindow**</span></span>

<span data-ttu-id="4177f-157">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-157">DWORD.</span></span> <span data-ttu-id="4177f-158">При наличии указывает окно приема, используемое сервером для данных, полученных от прокси-сервера RPC.</span><span class="sxs-lookup"><span data-stu-id="4177f-158">When present, specifies the receive window used by the server for data received from the RPC Proxy.</span></span> <span data-ttu-id="4177f-159">Минимальное допустимое значение — 8 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-159">The minimum valid value is 8K.</span></span> <span data-ttu-id="4177f-160">Максимальное значение — 1 ГБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-160">The maximum is 1GB.</span></span> <span data-ttu-id="4177f-161">Если значение не указано, используется 64 КБ.</span><span class="sxs-lookup"><span data-stu-id="4177f-161">If the value is not present, 64K is used.</span></span> <span data-ttu-id="4177f-162">Используется только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-162">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-163">При внесении изменений в это значение необходимо перезапустить службы IIS, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="4177f-163">When changes are made to this value, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="4177f-164">**\\Политики программного обеспечения HKLM \\ \\ Microsoft \\ Windows NT \\ RPC \\ минимумконнектионтимеаут**</span><span class="sxs-lookup"><span data-stu-id="4177f-164">**HKLM\\Software\\Policies\\Microsoft\\Windows NT\\Rpc\\MinimumConnectionTimeout**</span></span>

<span data-ttu-id="4177f-165">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-165">DWORD.</span></span> <span data-ttu-id="4177f-166">При наличии указывает минимальное время ожидания соединения, используемое клиентом и прокси-сервером RPC, в секундах.</span><span class="sxs-lookup"><span data-stu-id="4177f-166">When present, specifies the minimum connection timeout used by the client and RPC Proxy, in seconds.</span></span> <span data-ttu-id="4177f-167">Фактически используемое время ожидания — это меньшее из этих значений и время ожидания бездействующего подключения IIS.</span><span class="sxs-lookup"><span data-stu-id="4177f-167">The actual timeout used is the lower of this value and the IIS idle connection timeout.</span></span> <span data-ttu-id="4177f-168">Если значение равно нулю или ключ отсутствует, используется время ожидания бездействующего подключения IIS.</span><span class="sxs-lookup"><span data-stu-id="4177f-168">If zero, or the key is not present, the IIS idle connection timeout is used.</span></span> <span data-ttu-id="4177f-169">Используется только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-169">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-170">При внесении изменений в это значение прокси-сервера RPC необходимо перезапустить службы IIS, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="4177f-170">When changes are made to this value on the RPC Proxy, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="4177f-171">**HKLM \\ Software \\ Microsoft \\ RPC \\ усепроксифорипаддрифрднсфаилс**</span><span class="sxs-lookup"><span data-stu-id="4177f-171">**HKLM\\Software\\Microsoft\\Rpc\\UseProxyForIPAddrIfRDNSFails**</span></span>

<span data-ttu-id="4177f-172">Если задано ненулевое значение, а в качестве адреса прокси-сервера RPC указан числовой IP-адрес, то клиент RPC через HTTP попытается отменить разрешение имени и, если это не удается, будет пытаться подключиться к прокси-серверу RPC через прокси-сервер HTTP.</span><span class="sxs-lookup"><span data-stu-id="4177f-172">When present and set to non-zero, and a numeric IP address is provided as the RPC Proxy address, an RPC over HTTP client will attempt reverse name resolution and, if that fails, will attempt connection to the RPC Proxy through an HTTP proxy.</span></span> <span data-ttu-id="4177f-173">Может использоваться для эмуляции поведения Windows NT при установке, требующей такого поведения.</span><span class="sxs-lookup"><span data-stu-id="4177f-173">Can be used to emulate Windows NT behavior on installations that require such behavior.</span></span> <span data-ttu-id="4177f-174">Игнорируется для RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-174">Ignored for RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-175">Используется только при использовании RPC через HTTP v1.</span><span class="sxs-lookup"><span data-stu-id="4177f-175">Used only when RPC over HTTP v1 is used.</span></span> <span data-ttu-id="4177f-176">Поддерживается только в Windows 2000 с пакетом обновления 3 (SP3) и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="4177f-176">Supported only on Windows 2000 with Service Pack 3 (SP3) and later.</span></span>

\-

<span data-ttu-id="4177f-177">**HKLM \\ Software \\ Microsoft \\ RPC \\ RPCProxy \\ allowAnonymous**</span><span class="sxs-lookup"><span data-stu-id="4177f-177">**HKLM\\Software\\Microsoft\\Rpc\\RpcProxy\\AllowAnonymous**</span></span>

<span data-ttu-id="4177f-178">DWORD.</span><span class="sxs-lookup"><span data-stu-id="4177f-178">DWORD.</span></span> <span data-ttu-id="4177f-179">Если значение отсутствует или равно нулю, прокси-сервер RPC проверяет, прошел ли подключение проверку подлинности и является ли оно безопасным (используется SSL или другая форма шифрования).</span><span class="sxs-lookup"><span data-stu-id="4177f-179">When not present or set to zero, the RPC Proxy checks whether the connection is authenticated, and whether it is secure (SSL or other form of encryption is used).</span></span> <span data-ttu-id="4177f-180">Если значение равно false, соединение отклоняется.</span><span class="sxs-lookup"><span data-stu-id="4177f-180">If either is false, the connection is rejected.</span></span> <span data-ttu-id="4177f-181">Если это значение содержит ненулевое, анонимные и незашифрованные соединения разрешены.</span><span class="sxs-lookup"><span data-stu-id="4177f-181">If this value contains non-zero, anonymous and non-encrypted connections are allowed.</span></span> <span data-ttu-id="4177f-182">Этот параметр является дополнением к любым параметрам виртуального каталога.</span><span class="sxs-lookup"><span data-stu-id="4177f-182">This setting is an addition to any virtual directory settings.</span></span> <span data-ttu-id="4177f-183">Например, если анонимный доступ отключен на уровне виртуального каталога, но **allowAnonymous** не равен нулю, анонимный доступ по-прежнему будет заблокирован на уровне IIS.</span><span class="sxs-lookup"><span data-stu-id="4177f-183">For example, if anonymous access is disabled on the virtual directory level, but **AllowAnonymous** is non-zero, anonymous access will still be blocked at the IIS level.</span></span> <span data-ttu-id="4177f-184">Используется в RPC-прокси только в RPC через HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="4177f-184">Used on the RPC Proxy only in RPC over HTTP v2.</span></span> <span data-ttu-id="4177f-185">При внесении изменений в это значение прокси-сервера RPC необходимо перезапустить службы IIS, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="4177f-185">When changes are made to this value on the RPC Proxy, IIS must be restarted for the change to take effect.</span></span>

> [!WARNING]
> <span data-ttu-id="4177f-186">Корпорация Майкрософт настоятельно рекомендует устанавливать значение **allowAnonymous** в производственных системах для обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="4177f-186">Microsoft strongly recommends against setting the **AllowAnonymous** value on production systems for security considerations.</span></span> <span data-ttu-id="4177f-187">Единственная причина, по которой этот ключ должен быть установлен, — тестирование в закрытых сетях без доступа к ним.</span><span class="sxs-lookup"><span data-stu-id="4177f-187">The only reason this key should be set is for testing on closed networks without outside access.</span></span> <span data-ttu-id="4177f-188">Любая система, подключенная к Интернету и выполняющая RPC-прокси с ключом **allowAnonymous** , для которого установлено ненулевое значение, может быть уязвима для атак.</span><span class="sxs-lookup"><span data-stu-id="4177f-188">Any system connected to the Internet and running the RPC Proxy with the **AllowAnonymous** key set to a nonzero value may be vulnerable to attacks.</span></span>

 

 

 




