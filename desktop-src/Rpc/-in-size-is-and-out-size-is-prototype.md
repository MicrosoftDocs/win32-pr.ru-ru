---
title: " в, size_is и out size_is prototype"
description: В следующем прототипе функции используются две подсчитанные строки. Разработчик должен написать код как на клиенте, так и на сервере, чтобы контролировать длину массивов символов и передавать параметры, которые указывают заглушкам, сколько элементов массива передавать.
ms.assetid: 334c5e0f-b1fb-41ca-8157-d92525e78b3a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75075ccabe4a29ca1765a189c371c407c791cb868d2980386488879415e8f60d
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120073634"
---
# <a name="in-size_is-and-out-size_is-prototype"></a>\[в, размер \_ \] и \[ , размер \_ — \] прототип

В следующем прототипе функции используются две подсчитанные строки. Разработчик должен написать код как на клиенте, так и на сервере, чтобы контролировать длину массивов символов и передавать параметры, которые указывают заглушкам, сколько элементов массива передавать.

``` syntax
void Analyze(
    [in,  length_is(cbIn), size_is(STRSIZE)]    char  achIn[],
    [in]                                        long  cbIn,
    [out, length_is(*pcbOut), size_is(STRSIZE)] char  achOut[],
    [out]                                       long *pcbOut);
```

Обратите внимание, что параметры, описывающие длину массива, передаются в том же направлении, что и массивы: *кбин* и *Ачин* находятся \[ [**в**](/windows/desktop/Midl/in) \] параметрах, тогда как *пкбаут* и *ачаут* являются \[ [**выходными**](/windows/desktop/Midl/out-idl) \] параметрами. В качестве параметра **\[ \] out** параметр *Пкбаут* должен следовать соглашению C и объявляться как указатель.

Клиентский код подсчитывает количество символов в строке, включая замыкающий нуль, перед вызовом удаленной процедуры, как показано ниже:

``` syntax
/* client */
char achIn[STRSIZE], achOut[STRSIZE];
long cbIn, cbOut;
...
gets_s(achIn, STRSIZE);                   // get patient input
cbIn = strlen(achIn) + 1;      // transmitted elements
Analyze(achIn, cbIn, achOut, &cbOut);
```

Удаленная процедура на сервере предоставляет длину буфера возврата в *кбаут* , как показано ниже:

``` syntax
/* server */
void Analyze(char *pchIn,
             long cbIn,
             char *pchOut,
             long *pcbOut)
{
   ...
   *pcbOut = strlen(pchOut) + 1; // transmitted elements
   return;
}
```

\[  \] Если известно, что параметр является строковым, можно использовать атрибут String. Этот атрибут направляет заглушку для вычисления размера строки, тем самым устраняя издержки, связанные с \[ [**длиной, —**](/windows/desktop/Midl/size-is) \] параметрами. Кроме того, она будет направлять заглушку для проверки того, что строка **была прервана, перед** передачей параметра в приложение.

 

 