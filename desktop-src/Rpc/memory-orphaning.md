---
title: Потеря памяти
description: Если в распределенном приложении используется параметр "\ in", "out", "Unique" или "\ in", "out", "PTR \ указатель", серверная часть приложения может изменить значение параметра указателя на null.
ms.assetid: 65588b4d-6bf4-44f7-994c-29a5b185c6b9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 32042911695f377e0a628168e91387bfa25f0d79
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105672389"
---
# <a name="memory-orphaning"></a><span data-ttu-id="27436-103">Потеря памяти</span><span class="sxs-lookup"><span data-stu-id="27436-103">Memory Orphaning</span></span>

<span data-ttu-id="27436-104">Если распределенное приложение использует параметр " \[ [in](/windows/desktop/Midl/in)" [,](/windows/desktop/Midl/out-idl)" [UNIQUE](/windows/desktop/Midl/unique) " \] или " \[ **in**" **,** [](/windows/desktop/Midl/ptr) \] "pointer", то Серверная часть приложения может изменить значение параметра указателя на null.</span><span class="sxs-lookup"><span data-stu-id="27436-104">If your distributed application uses an \[ [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl), [unique](/windows/desktop/Midl/unique)\] or \[**in**, **out**, [ptr](/windows/desktop/Midl/ptr)\] pointer parameter, the server side of the application can change the value of the pointer parameter to null.</span></span> <span data-ttu-id="27436-105">Когда сервер затем возвращает клиенту значение null, память, на которую ссылается указатель перед вызовом удаленной процедуры, по-прежнему остается на клиентской стороне, но больше не доступна из этого указателя (за исключением случаев, когда указатель полностью имеет псевдоним).</span><span class="sxs-lookup"><span data-stu-id="27436-105">When the server subsequently returns the null value to the client, memory referenced by the pointer before the remote procedure call is still present on the client side, but is no longer accessible from that pointer (except in the case of an aliased full pointer).</span></span> <span data-ttu-id="27436-106">Такая память называется *потерянной*.</span><span class="sxs-lookup"><span data-stu-id="27436-106">This memory is said to be *orphaned*.</span></span> <span data-ttu-id="27436-107">Это также называется *утечкой памяти*.</span><span class="sxs-lookup"><span data-stu-id="27436-107">This is also termed a *memory leak*.</span></span> <span data-ttu-id="27436-108">Повторный потерянный объем памяти на клиенте приводит к тому, что клиент выполнит недоступные ресурсы памяти.</span><span class="sxs-lookup"><span data-stu-id="27436-108">Repeated orphaning of memory on the client causes the client to run out of available memory resources.</span></span>

<span data-ttu-id="27436-109">Память также может быть потеряна каждый раз, когда сервер изменяет внедренный указатель на значение null.</span><span class="sxs-lookup"><span data-stu-id="27436-109">Memory can also be orphaned whenever the server changes an embedded pointer to a null value.</span></span> <span data-ttu-id="27436-110">Например, если параметр указывает на сложную структуру данных, такую как дерево, серверная часть приложения может удалять узлы дерева и устанавливать указатели внутри дерева в значение null.</span><span class="sxs-lookup"><span data-stu-id="27436-110">For example, if the parameter points to a complex data structure such as a tree, the server side of the application can delete nodes of the tree and set pointers inside the tree to null.</span></span>

<span data-ttu-id="27436-111">Другая ситуация, которая может привести к утечке памяти, заключается в согласованности, различном и открытом массиве, содержащем указатели.</span><span class="sxs-lookup"><span data-stu-id="27436-111">Another situation that can lead to a memory leak involves conformant, varying, and open arrays containing pointers.</span></span> <span data-ttu-id="27436-112">Когда серверное приложение изменяет параметр, указывающий размер массива или переданный диапазон таким образом, что он представляет меньшее значение, заглушки используют меньшее значение для освобождения памяти.</span><span class="sxs-lookup"><span data-stu-id="27436-112">When the server application modifies the parameter that specifies the array size or transmitted range so that it represents a smaller value, the stubs use the smaller value(s) to free memory.</span></span> <span data-ttu-id="27436-113">Элементы массива с индексами, превышающими параметр size, считаются потерянными.</span><span class="sxs-lookup"><span data-stu-id="27436-113">The array elements with indices larger than the size parameter are orphaned.</span></span> <span data-ttu-id="27436-114">Приложение должно освобождать элементы за пределами переданного диапазона.</span><span class="sxs-lookup"><span data-stu-id="27436-114">Your application must free elements outside the transmitted range.</span></span>

 

 