---
title: Общие сведения о раскадровке
description: В этом обзоре основное внимание уделяется использованию переходов и раскадровок в анимации Windows.
ms.assetid: d37718ac-0256-4a24-a26c-d29173593be0
keywords:
- Анимация Windows анимации Windows, общие сведения о раскадровке
- Анимированные раскадровки Windows, описание
- переходы по анимации Windows, описание
- переходы по анимации Windows, пользовательские
- Анимация Windows для интерполяции, описание
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22d8e0af3937cd31ccdc43216a9d3426bad0e7b0
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103792228"
---
# <a name="storyboard-overview"></a><span data-ttu-id="9352f-108">Общие сведения о раскадровке</span><span class="sxs-lookup"><span data-stu-id="9352f-108">Storyboard Overview</span></span>

<span data-ttu-id="9352f-109">В этом обзоре основное внимание уделяется использованию переходов и раскадровок в анимации Windows.</span><span class="sxs-lookup"><span data-stu-id="9352f-109">This overview focuses on how transitions and storyboards are used in Windows Animation.</span></span> <span data-ttu-id="9352f-110">Общие сведения о компонентах анимации Windows см. в разделе [Общие сведения об анимации Windows](scenic-animation-api-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9352f-110">For an overview of the components of Windows Animation, see [Windows Animation Overview](scenic-animation-api-overview.md).</span></span>

<span data-ttu-id="9352f-111">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="9352f-111">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="9352f-112">Transitions</span><span class="sxs-lookup"><span data-stu-id="9352f-112">Transitions</span></span>](#custom-transitions)
    -   [<span data-ttu-id="9352f-113">Библиотека переходов</span><span class="sxs-lookup"><span data-stu-id="9352f-113">Transition Library</span></span>](#transition-library)
    -   [<span data-ttu-id="9352f-114">Пользовательские переходы</span><span class="sxs-lookup"><span data-stu-id="9352f-114">Custom Transitions</span></span>](#custom-transitions)
-   [<span data-ttu-id="9352f-115">элементы раскадровки;</span><span class="sxs-lookup"><span data-stu-id="9352f-115">Storyboards</span></span>](#storyboards)
    -   [<span data-ttu-id="9352f-116">Создание простой раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-116">Building a Simple Storyboard</span></span>](#building-a-simple-storyboard)
    -   [<span data-ttu-id="9352f-117">Использование Context-Sensitive длительности</span><span class="sxs-lookup"><span data-stu-id="9352f-117">Using a Context-Sensitive Duration</span></span>](#using-a-context-sensitive-duration)
    -   [<span data-ttu-id="9352f-118">Создание более сложной раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-118">Building a More Complex Storyboard</span></span>](#building-a-more-complex-storyboard)
    -   [<span data-ttu-id="9352f-119">Использование опорных кадров</span><span class="sxs-lookup"><span data-stu-id="9352f-119">Using Keyframes</span></span>](#using-keyframes)
    -   [<span data-ttu-id="9352f-120">Хранение переменных</span><span class="sxs-lookup"><span data-stu-id="9352f-120">Holding Variables</span></span>](#holding-variables)
    -   [<span data-ttu-id="9352f-121">Планирование раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-121">Scheduling a Storyboard</span></span>](#scheduling-a-storyboard)
-   [<span data-ttu-id="9352f-122">См. также</span><span class="sxs-lookup"><span data-stu-id="9352f-122">Related topics</span></span>](#related-topics)

## <a name="transitions"></a><span data-ttu-id="9352f-123">Transitions</span><span class="sxs-lookup"><span data-stu-id="9352f-123">Transitions</span></span>

<span data-ttu-id="9352f-124">Переход определяет, как изменяется одна переменная анимации за определенный интервал времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-124">A transition defines how a single animation variable changes over a particular time interval.</span></span> <span data-ttu-id="9352f-125">Анимация Windows включает библиотеку распространенных переходов, которые разработчики могут применять к одной или нескольким переменным анимации.</span><span class="sxs-lookup"><span data-stu-id="9352f-125">Windows Animation includes a library of common transitions that developers can apply to one or more animation variables.</span></span> <span data-ttu-id="9352f-126">Различные виды переходов имеют разные наборы параметров, которые могут включать значение переменной после завершения перехода, длительность перехода или количества, уникальные для базовой математической функции, например ускорение или диапазон колебаний.</span><span class="sxs-lookup"><span data-stu-id="9352f-126">Different kinds of transitions have different sets of parameters, which may include the value of the variable when the transition completes, the duration of the transition, or quantities unique to the underlying mathematical function, such as acceleration or range of oscillation.</span></span>

<span data-ttu-id="9352f-127">Все переходы совместно используют два неявных параметра: начальное значение и начальную скорость (наклон) математической функции.</span><span class="sxs-lookup"><span data-stu-id="9352f-127">All transitions share two implicit parameters: the initial value and initial velocity (slope) of the mathematical function.</span></span> <span data-ttu-id="9352f-128">Они могут быть заданы явным образом приложением, но обычно задаются диспетчером анимации как значение и скорость переменной анимации при начале перехода.</span><span class="sxs-lookup"><span data-stu-id="9352f-128">These may be specified explicitly by the application, but are typically set by the animation manager to the value and velocity of the animation variable when the transition begins.</span></span>

-   [<span data-ttu-id="9352f-129">Библиотека переходов</span><span class="sxs-lookup"><span data-stu-id="9352f-129">Transition Library</span></span>](#transition-library)
-   [<span data-ttu-id="9352f-130">Пользовательские переходы</span><span class="sxs-lookup"><span data-stu-id="9352f-130">Custom Transitions</span></span>](#custom-transitions)

### <a name="transition-library"></a><span data-ttu-id="9352f-131">Библиотека переходов</span><span class="sxs-lookup"><span data-stu-id="9352f-131">Transition Library</span></span>

<span data-ttu-id="9352f-132">В настоящее время в библиотеке переходов предоставляются следующие переходы.</span><span class="sxs-lookup"><span data-stu-id="9352f-132">The following transitions are currently provided by the transition library.</span></span> <span data-ttu-id="9352f-133">Если приложению требуется воздействие, которое не может быть указано с помощью библиотеки переходов, разработчики могут создавать другие виды переходов, реализуя пользовательский интерполяцию для приложения или используя библиотеку переходов от третьей стороны.</span><span class="sxs-lookup"><span data-stu-id="9352f-133">If an application requires an effect that cannot be specified by using the transition library, developers can create other kinds of transitions by implementing a custom interpolator for the application, or using a transition library from a third party.</span></span>



| <span data-ttu-id="9352f-134">Имя перехода</span><span class="sxs-lookup"><span data-stu-id="9352f-134">Transition Name</span></span>                        | <span data-ttu-id="9352f-135">Описание</span><span class="sxs-lookup"><span data-stu-id="9352f-135">Description</span></span>                                                                                                                                                                                          |
|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9352f-136">ускорение — замедление</span><span class="sxs-lookup"><span data-stu-id="9352f-136">accelerate-decelerate</span></span><br/>       | <span data-ttu-id="9352f-137">Переменная анимации ускоряется, а затем замедляется в течение заданного времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-137">The animation variable speeds up and then slows down over a given duration.</span></span><br/>                                                                                                               |
| <span data-ttu-id="9352f-138">constant</span><span class="sxs-lookup"><span data-stu-id="9352f-138">constant</span></span><br/>                    | <span data-ttu-id="9352f-139">Переменная анимации остается в исходном значении во время перехода.</span><span class="sxs-lookup"><span data-stu-id="9352f-139">The animation variable remains at its initial value throughout the transition.</span></span><br/>                                                                                                            |
| <span data-ttu-id="9352f-140">кубические</span><span class="sxs-lookup"><span data-stu-id="9352f-140">cubic</span></span><br/>                       | <span data-ttu-id="9352f-141">Переменная анимации меняется с исходного значения на указанное конечное значение с указанной конечной скоростью в течение заданного времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-141">The animation variable changes from its initial value to a specified final value, with a specified final velocity, over a given duration.</span></span><br/>                                                 |
| <span data-ttu-id="9352f-142">отдельного</span><span class="sxs-lookup"><span data-stu-id="9352f-142">discrete</span></span><br/>                    | <span data-ttu-id="9352f-143">Переменная анимации остается в исходном значении для указанного времени задержки, затем переключается на указанное конечное значение и остается в этом значении в течение заданного времени удержания.</span><span class="sxs-lookup"><span data-stu-id="9352f-143">The animation variable remains at its initial value for a specified delay time, then switches instantaneously to a specified final value and remains at that value for a given hold time.</span></span><br/> |
| <span data-ttu-id="9352f-144">котором</span><span class="sxs-lookup"><span data-stu-id="9352f-144">instantaneous</span></span><br/>               | <span data-ttu-id="9352f-145">Переменная анимации сразу же меняется от текущего значения к указанному конечному значению.</span><span class="sxs-lookup"><span data-stu-id="9352f-145">The animation variable changes instantly from its current value to a specified final value.</span></span><br/>                                                                                               |
| <span data-ttu-id="9352f-146">linear</span><span class="sxs-lookup"><span data-stu-id="9352f-146">linear</span></span><br/>                      | <span data-ttu-id="9352f-147">Переменная анимации переходит линейно от начального значения к указанному конечному значению за заданную длительность.</span><span class="sxs-lookup"><span data-stu-id="9352f-147">The animation variable transitions linearly from its initial value to a specified final value over a given duration.</span></span><br/>                                                                      |
| <span data-ttu-id="9352f-148">линейная с скорости</span><span class="sxs-lookup"><span data-stu-id="9352f-148">linear from speed</span></span><br/>           | <span data-ttu-id="9352f-149">Переменная анимации переходит линейно от начального значения к указанному конечному значению с указанной скоростью.</span><span class="sxs-lookup"><span data-stu-id="9352f-149">The animation variable transitions linearly from its initial value to a specified final value with a specified speed.</span></span><br/>                                                                     |
| <span data-ttu-id="9352f-150">параболическим от ускорения</span><span class="sxs-lookup"><span data-stu-id="9352f-150">parabolic from acceleration</span></span><br/> | <span data-ttu-id="9352f-151">Переменная анимации переходит от исходного значения к указанному конечному значению с указанной конечной скоростью, изменяя его скорость с указанным ускорением.</span><span class="sxs-lookup"><span data-stu-id="9352f-151">The animation variable transitions from its initial value to a specified final value, with a specified final velocity, changing its velocity with a specified acceleration.</span></span><br/>               |
| <span data-ttu-id="9352f-152">обратный порядок</span><span class="sxs-lookup"><span data-stu-id="9352f-152">reversal</span></span><br/>                    | <span data-ttu-id="9352f-153">Переменная изменяет направление в течение заданного времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-153">The variable changes direction over a given duration.</span></span> <span data-ttu-id="9352f-154">Конечное значение будет таким же, как исходное значение, а последняя скорость будет отрицательной на начальную скорость.</span><span class="sxs-lookup"><span data-stu-id="9352f-154">The final value will be the same as the initial value and the final velocity will be the negative of the initial velocity.</span></span><br/>          |
| <span data-ttu-id="9352f-155">синусоидальной из диапазона</span><span class="sxs-lookup"><span data-stu-id="9352f-155">sinusoidal from range</span></span><br/>       | <span data-ttu-id="9352f-156">Переменная осЦиллатес в заданном диапазоне значений с указанным периодом колебаний для заданной длительности.</span><span class="sxs-lookup"><span data-stu-id="9352f-156">The variable oscillates within a given range of values, with a specified period of oscillation, for a given duration.</span></span><br/>                                                                     |
| <span data-ttu-id="9352f-157">синусоидальной с скорости</span><span class="sxs-lookup"><span data-stu-id="9352f-157">sinusoidal from velocity</span></span><br/>    | <span data-ttu-id="9352f-158">Переменная осЦиллатес с указанным периодом колебаний для заданной длительности.</span><span class="sxs-lookup"><span data-stu-id="9352f-158">The variable oscillates with a specified period of oscillation, for a given duration.</span></span> <span data-ttu-id="9352f-159">Амплитуда колебаний определяется начальной скоростью переменной.</span><span class="sxs-lookup"><span data-stu-id="9352f-159">The amplitude of oscillation is determined by the variable's initial velocity.</span></span><br/>                      |
| <span data-ttu-id="9352f-160">гладкая Отмена</span><span class="sxs-lookup"><span data-stu-id="9352f-160">smooth stop</span></span><br/>                 | <span data-ttu-id="9352f-161">Переменная анимации переходит на гладкую точку в указанном окончательном значении в пределах максимальной длительности времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-161">The animation variable comes to a smooth stop at a specified final value, within a maximum duration of time.</span></span><br/>                                                                              |



 

<span data-ttu-id="9352f-162">В следующей таблице приводятся иллюстрации для каждого из этих переходов.</span><span class="sxs-lookup"><span data-stu-id="9352f-162">The following table contains illustrations for each of these transitions.</span></span>



|                                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![Иллюстрация мгновенного перехода](images/instantaneoustransition.png)  ![Иллюстрация постоянного перехода](images/constanttransition.png)  ![Иллюстрация линейного перехода](images/lineartransition.png)  ![Иллюстрация линеатного перехода с скорости](images/lineartransitionfromspeed.png)  ![Иллюстрация дискретного перехода](images/discretetransition.png) |
| ![Иллюстрация параболическимного перехода из ускорения](images/parabolictransitionfromacceleration.png)  ![Иллюстрация третьего перехода](images/cubictransition.png)  ![Иллюстрация плавного перехода на новую точку](images/smoothstoptransition.png)                                                                                                                                       |
| ![Иллюстрация обратного перехода](images/reversaltransition.png)  ![Иллюстрация синусоидальнойного перехода с скорости](images/sinusolidaltransitionfromvelocity.png)  ![Иллюстрация синусоидальнойного перехода из диапазона](images/sinusolidaltransitionfromrange.png)                                                                                                                  |
| ![Иллюстрация акцеллерате и замедляет переходы](images/acceleratedeceleratetransition.png)                                                                                                                                                                                                                                                                                               |



 

### <a name="custom-transitions"></a><span data-ttu-id="9352f-175">Пользовательские переходы</span><span class="sxs-lookup"><span data-stu-id="9352f-175">Custom Transitions</span></span>

<span data-ttu-id="9352f-176">*Интерполяция* определяет математическую функцию, определяющую изменение переменной анимации с течением времени по мере продвижения ее начального значения к конечному значению.</span><span class="sxs-lookup"><span data-stu-id="9352f-176">An *interpolator* defines the mathematical function that determines how an animation variable changes over time as it progresses from its initial value to a final value.</span></span> <span data-ttu-id="9352f-177">Каждый переход в библиотеке переходов имеет связанный объект интерполяции, предоставляемый системой, и реализует функцию интерполяции.</span><span class="sxs-lookup"><span data-stu-id="9352f-177">Each transition in the transition library has an associated interpolator object that is provided by the system and implements the interpolator function.</span></span> <span data-ttu-id="9352f-178">Если приложению требуется результат, который не может быть указан с помощью библиотеки переходов, он может реализовать один или несколько пользовательских переходов, реализуя объект интерполяции для каждого нового перехода.</span><span class="sxs-lookup"><span data-stu-id="9352f-178">If an application requires an effect that cannot be specified using the transition library, it can implement one or more custom transitions by implementing an interpolator object for each new transition.</span></span> <span data-ttu-id="9352f-179">Объекты интерполяции не могут использоваться приложениями напрямую и должны быть заключены в соответствующий переход.</span><span class="sxs-lookup"><span data-stu-id="9352f-179">Interpolator objects cannot be used directly by applications and must instead be wrapped in an associated transition.</span></span> <span data-ttu-id="9352f-180">*Фабрика переходов* используется для создания переходов из объекта интерполяции.</span><span class="sxs-lookup"><span data-stu-id="9352f-180">A *transition factory* is used to generate transitions from an interpolator object.</span></span> <span data-ttu-id="9352f-181">Дополнительные сведения см. в разделе [**иуианиматионинтерполатор**](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationinterpolator) и [**иуианиматионтранситионфактори**](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationtransitionfactory) .</span><span class="sxs-lookup"><span data-stu-id="9352f-181">See [**IUIAnimationInterpolator**](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationinterpolator) and [**IUIAnimationTransitionFactory**](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationtransitionfactory) for more details.</span></span>

<span data-ttu-id="9352f-182">Обратите внимание, что большинство приложений будут иметь все необходимые вам переходы с помощью библиотеки переходов, поэтому не нужно реализовывать интерполяцию.</span><span class="sxs-lookup"><span data-stu-id="9352f-182">Note that most applications will have all of the transitions they need by using the transition library, and therefore would not need to implement an interpolator.</span></span>

## <a name="storyboards"></a><span data-ttu-id="9352f-183">элементы раскадровки;</span><span class="sxs-lookup"><span data-stu-id="9352f-183">Storyboards</span></span>

<span data-ttu-id="9352f-184">Раскадровка — это коллекция переходов, применяемых к одной или нескольким переменным анимации с течением времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-184">A storyboard is a collection of transitions applied to one or more animation variables over time.</span></span> <span data-ttu-id="9352f-185">Переходы в раскадровке гарантированно остаются синхронизированными относительно друг друга, а раскадровка планируется или отменяется как единое целое.</span><span class="sxs-lookup"><span data-stu-id="9352f-185">The transitions in a storyboard are guaranteed to remain synchronized relative to one another, and the storyboard is scheduled or canceled as a unit.</span></span> <span data-ttu-id="9352f-186">После создания нужных переходов приложение создает раскадровку с помощью диспетчера анимации, добавляет переходы в раскадровку, настраивает раскадровку соответствующим образом и планирует ее воспроизведение как можно быстрее.</span><span class="sxs-lookup"><span data-stu-id="9352f-186">After creating the desired transitions, an application creates a storyboard using the animation manager, adds the transitions to the storyboard, configures the storyboard appropriately, and schedules it to play as soon as possible.</span></span> <span data-ttu-id="9352f-187">Диспетчер анимации определяет фактическое время начала раскадровки, так как может возникнуть состязание с другими раскадровками, которые в настоящее время анимированы одних и тех же переменных.</span><span class="sxs-lookup"><span data-stu-id="9352f-187">The animation manager determines the storyboard's actual start time, because there may be contention with other storyboards currently animating the same variables.</span></span>

<span data-ttu-id="9352f-188">Общая длительность раскадровки зависит от длительности переходов в раскадровке.</span><span class="sxs-lookup"><span data-stu-id="9352f-188">The overall duration of a storyboard depends on the durations of the transitions within the storyboard.</span></span> <span data-ttu-id="9352f-189">Длительность перехода не требует исправления; его можно определить по значению и скорости анимированных переменных при начале перехода.</span><span class="sxs-lookup"><span data-stu-id="9352f-189">The duration of a transition need not be fixed; it can be determined by the value and velocity of the animated variables when the transition begins.</span></span> <span data-ttu-id="9352f-190">Таким образом, длительность раскадровки также может зависеть от состояния переменных, которые она анимирует.</span><span class="sxs-lookup"><span data-stu-id="9352f-190">So, the duration of a storyboard can also depend on the state of the variables it animates.</span></span>

<span data-ttu-id="9352f-191">В следующих примерах предполагается, что были созданы диспетчер анимации, Библиотека переходов и таймер.</span><span class="sxs-lookup"><span data-stu-id="9352f-191">The following examples assume that an animation manager, transition library, and timer have been created.</span></span> <span data-ttu-id="9352f-192">Дополнительные сведения см. [в разделе Создание основных объектов анимации](adding-animation-to-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="9352f-192">For more information, see [Create the Main Animation Objects](adding-animation-to-an-application.md).</span></span> <span data-ttu-id="9352f-193">В примерах также предполагается, что приложение создало три переменные анимации (X, Y и Z) с помощью метода [**иуианиматионманажер:: креатеаниматионвариабле**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationmanager-createanimationvariable) и пять переходов (T1, T2, T3, T4 и T5) с помощью одного из методов интерфейса [**иуианиматионтранситионлибрари**](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationtransitionlibrary) .</span><span class="sxs-lookup"><span data-stu-id="9352f-193">The examples also assume that the application has created three animation variables (X, Y and Z) by using the [**IUIAnimationManager::CreateAnimationVariable**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationmanager-createanimationvariable) method, and five transitions (T1, T2, T3, T4, and T5) by using the one of the methods of the [**IUIAnimationTransitionLibrary**](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationtransitionlibrary) interface.</span></span>

-   [<span data-ttu-id="9352f-194">Создание простой раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-194">Building a Simple Storyboard</span></span>](#building-a-simple-storyboard)
-   [<span data-ttu-id="9352f-195">Использование Context-Sensitive длительности</span><span class="sxs-lookup"><span data-stu-id="9352f-195">Using a Context-Sensitive Duration</span></span>](#using-a-context-sensitive-duration)
-   [<span data-ttu-id="9352f-196">Создание более сложной раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-196">Building a More Complex Storyboard</span></span>](#building-a-more-complex-storyboard)
-   [<span data-ttu-id="9352f-197">Использование опорных кадров</span><span class="sxs-lookup"><span data-stu-id="9352f-197">Using Keyframes</span></span>](#using-keyframes)
-   [<span data-ttu-id="9352f-198">Хранение переменных</span><span class="sxs-lookup"><span data-stu-id="9352f-198">Holding Variables</span></span>](#holding-variables)
-   [<span data-ttu-id="9352f-199">Планирование раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-199">Scheduling a Storyboard</span></span>](#scheduling-a-storyboard)

### <a name="building-a-simple-storyboard"></a><span data-ttu-id="9352f-200">Создание простой раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-200">Building a Simple Storyboard</span></span>

<span data-ttu-id="9352f-201">Чтобы создать простую раскадровку, используйте метод [**иуианиматионманажер:: креатесторибоард**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationmanager-createstoryboard) для создания новой раскадровки, метод [**Иуианиматионтранситионлибрари:: креателинеартранситион**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationtransitionlibrary-createlineartransition) , чтобы создать линейный переход, T1 и метод [**IUIAnimationStoryboard:: AddTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransition) для применения перехода T1 к переменной X и добавления результирующего перехода в раскадровку.</span><span class="sxs-lookup"><span data-stu-id="9352f-201">To build a simple storyboard, use the [**IUIAnimationManager::CreateStoryboard**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationmanager-createstoryboard) method to create a new storyboard, the [**IUIAnimationTransitionLibrary::CreateLinearTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationtransitionlibrary-createlineartransition) method to create a linear transition, T1, and the [**IUIAnimationStoryboard::AddTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransition) method to apply the T1 transition to the variable X and add the resulting transition to the storyboard.</span></span>

<span data-ttu-id="9352f-202">Этот процесс дает простую раскадровку, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="9352f-202">This process yields a simple storyboard, as shown in the following figure.</span></span> <span data-ttu-id="9352f-203">Раскадровка содержит один переход (T1), так что значение переменной X изменяется линейно за фиксированный период времени.</span><span class="sxs-lookup"><span data-stu-id="9352f-203">The storyboard contains one transition, T1, such that the value of variable X changes linearly over a fixed duration of time.</span></span>

![Иллюстрация, демонстрирующая простую раскадровку с фиксированной длительностью](images/simplestoryboardfixedduration.png)

<span data-ttu-id="9352f-205">Обратите внимание, что для такого простого сценария альтернативным вариантом является использование метода [**иуианиматионманажер:: счедулетранситион**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationmanager-scheduletransition) .</span><span class="sxs-lookup"><span data-stu-id="9352f-205">Note that for such a simple scenario, an alternative option is to use the [**IUIAnimationManager::ScheduleTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationmanager-scheduletransition) method.</span></span>

### <a name="using-a-context-sensitive-duration"></a><span data-ttu-id="9352f-206">Использование Context-Sensitive длительности</span><span class="sxs-lookup"><span data-stu-id="9352f-206">Using a Context-Sensitive Duration</span></span>

<span data-ttu-id="9352f-207">Хотя некоторые переходы имеют фиксированную длительность, длительность других зависит от первоначального значения или скорости анимированной переменной при начале перехода.</span><span class="sxs-lookup"><span data-stu-id="9352f-207">While some transitions have a fixed duration, the duration of others depends on the initial value or velocity of the animated variable when the transition begins.</span></span> <span data-ttu-id="9352f-208">Например, метод [**иуианиматионтранситионлибрари:: креателинеартранситионфромспид**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationtransitionlibrary-createlineartransitionfromspeed) создает переход с длительностью, пропорциональной разнице между начальным значением переменной анимации и указанным итоговым значением.</span><span class="sxs-lookup"><span data-stu-id="9352f-208">For example, the [**IUIAnimationTransitionLibrary::CreateLinearTransitionFromSpeed**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationtransitionlibrary-createlineartransitionfromspeed) method creates a transition with a duration that is proportional to the difference between the initial value of the animation variable and the specified final value.</span></span> <span data-ttu-id="9352f-209">На этом рисунке и на оставшихся иллюстрациях, таких переходов с произвольными продолжительностью, отображается вопросительный знак (?), а их фактическая длительность определяется при воспроизведении раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-209">In this illustration, and the remaining illustrations, such transitions with arbitrary durations are shown with a question mark (?), and their actual durations are determined when the storyboard plays.</span></span>

![Иллюстрация, демонстрирующая простую раскадровку с неизвестной длительностью](images/simplestoryboardunknownduration.png)

### <a name="building-a-more-complex-storyboard"></a><span data-ttu-id="9352f-211">Создание более сложной раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-211">Building a More Complex Storyboard</span></span>

<span data-ttu-id="9352f-212">После создания раскадровки и добавления одного перехода (T1) можно добавить второй переход для переменной X, вызвав метод [**иуианиматионсторибоард:: аддтранситион**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransition) еще раз, но с T2 вместо T1.</span><span class="sxs-lookup"><span data-stu-id="9352f-212">After creating a storyboard and adding a single transition, T1, you can append a second transition for the X variable by calling the [**IUIAnimationStoryboard::AddTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransition) method again, but with T2 instead of T1.</span></span>

<span data-ttu-id="9352f-213">Предполагая, что переход T2 имеет длительность, зависящую от контекста, раскадровка теперь содержит два обратных перехода от произвольной длительности, влияющие на переменную X.</span><span class="sxs-lookup"><span data-stu-id="9352f-213">Assuming that the T2 transition has a duration that is context-sensitive, the storyboard now contains two back-to-back transitions of arbitrary duration affecting the variable X.</span></span>

![Иллюстрация, показывающая раскадровку, содержащую два перехода на одну и ту же переменную](images/appendingwithaddtransition.png)

<span data-ttu-id="9352f-215">Повторный вызов [**аддтранситион**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransition) с переменной Y и Transition T3 добавляет третий переход в начало раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-215">Calling [**AddTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransition) again with variable Y and transition T3 adds a third transition at the start of the storyboard.</span></span> <span data-ttu-id="9352f-216">В зависимости от значений X и Y при воспроизведении раскадровки T3 могут заканчиваться после T1 или даже после T2.</span><span class="sxs-lookup"><span data-stu-id="9352f-216">Depending on the values of X and Y when the storyboard plays, T3 may end after T1 or even after T2.</span></span>

![Иллюстрация, показывающая раскадровку, содержащую переходы по нескольким переменным](images/multivariablestoryboard.png)

### <a name="using-keyframes"></a><span data-ttu-id="9352f-218">Использование опорных кадров</span><span class="sxs-lookup"><span data-stu-id="9352f-218">Using Keyframes</span></span>

<span data-ttu-id="9352f-219">Чтобы добавить переход со смещением от начала раскадровки, необходимо сначала добавить опорный кадр.</span><span class="sxs-lookup"><span data-stu-id="9352f-219">To add a transition at an offset from the start of the storyboard, you must first add a keyframe.</span></span> <span data-ttu-id="9352f-220">Ключевые кадры представляют мгновенные сообщения, и сами по себе не влияют на поведение раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-220">Keyframes represent instants in time and by themselves have no effect on the behavior of the storyboard.</span></span> <span data-ttu-id="9352f-221">У каждой раскадровки есть неявный ключевой кадр, представляющий начало раскадровки, [**\_ \_ \_ \_ начало раскадровки анимации пользовательского интерфейса**](/previous-versions/windows/desktop/legacy/dd756780(v=vs.85)); вы можете добавлять новые опорные кадры по смещению от начала, вызывая метод [**иуианиматионсторибоард:: аддкэйфрамеатоффсет**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addkeyframeatoffset) с **\_ \_ \_ \_ началом раскадровки для анимации пользовательского интерфейса**.</span><span class="sxs-lookup"><span data-stu-id="9352f-221">Every storyboard has an implicit keyframe representing the start of the storyboard, [**UI\_ANIMATION\_KEYFRAME\_STORYBOARD\_START**](/previous-versions/windows/desktop/legacy/dd756780(v=vs.85)); you can add new keyframes at offsets from the start by calling the [**IUIAnimationStoryboard::AddKeyframeAtOffset**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addkeyframeatoffset) method with **UI\_ANIMATION\_KEYFRAME\_STORYBOARD\_START**.</span></span>

<span data-ttu-id="9352f-222">Смещение, при котором добавляется опорный кадр, всегда отсчитывается относительно другого опорного кадра.</span><span class="sxs-lookup"><span data-stu-id="9352f-222">The offset at which you add a keyframe is always relative to another keyframe.</span></span> <span data-ttu-id="9352f-223">На следующей диаграмме показан результат добавления keyframe1 и переходов T4, который применяется к переменной Z, соответствует keyframe1 и создается с фиксированной длительностью.</span><span class="sxs-lookup"><span data-stu-id="9352f-223">The following diagram shows the result of adding keyframe1 and transition T4, which is applied to variable Z, aligned with keyframe1, and created with a fixed duration.</span></span> <span data-ttu-id="9352f-224">Конечно, поскольку длительность других переходов еще не известна, T4 может не быть последним переходом к завершению.</span><span class="sxs-lookup"><span data-stu-id="9352f-224">Of course, because the durations of the other transitions are not yet known, T4 might not be the last transition to finish.</span></span>

![Иллюстрация, показывающая добавление перехода по опорному кадру](images/addtransitionatkeyframe.png)

<span data-ttu-id="9352f-226">Опорные кадры также можно разместить на концах переходов с помощью метода [**иуианиматионсторибоард:: аддкэйфрамеафтертранситион**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addkeyframeaftertransition) .</span><span class="sxs-lookup"><span data-stu-id="9352f-226">Keyframes can also be placed at the ends of transitions, using the [**IUIAnimationStoryboard::AddKeyframeAfterTransition**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addkeyframeaftertransition) method.</span></span> <span data-ttu-id="9352f-227">На следующей диаграмме показан результат добавления keyframe2 после T1 и keyframe3 после T2.</span><span class="sxs-lookup"><span data-stu-id="9352f-227">The following diagram shows the result of adding keyframe2 after T1 and keyframe3 after T2.</span></span>

![Иллюстрация, демонстрирующая Добавление опорных кадров после различных переходов](images/addkeyframeaftertransition.png)

<span data-ttu-id="9352f-229">Так как длительность T1 и T2 неизвестны до воспроизведения раскадровки, смещения keyframe2 и keyframe3 также не определяются до тех пор, пока не будут воспроизводиться.</span><span class="sxs-lookup"><span data-stu-id="9352f-229">Because the durations of T1 and T2 are not known until the storyboard plays, the offsets of keyframe2 and keyframe3 also are not determined until then.</span></span> <span data-ttu-id="9352f-230">Следовательно, keyframe2 и даже keyframe3 могут происходить раньше keyframe1.</span><span class="sxs-lookup"><span data-stu-id="9352f-230">Consequently, keyframe2 and even keyframe3 can occur earlier than keyframe1.</span></span>

<span data-ttu-id="9352f-231">Начало и конец перехода можно согласовать с опорными кадрами с помощью метода [**иуианиматионсторибоард:: аддтранситионбетвинкэйфрамес**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransitionbetweenkeyframes) .</span><span class="sxs-lookup"><span data-stu-id="9352f-231">Both the start and end of a transition can be aligned with keyframes by using the [**IUIAnimationStoryboard::AddTransitionBetweenKeyframes**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-addtransitionbetweenkeyframes) method.</span></span> <span data-ttu-id="9352f-232">На следующей диаграмме показан результат добавления пятого перехода (T5) для переменной Y между keyframe2 и keyframe3.</span><span class="sxs-lookup"><span data-stu-id="9352f-232">The following diagram shows the result of adding a fifth transition, T5, on variable Y, between keyframe2 and keyframe3.</span></span> <span data-ttu-id="9352f-233">Это изменяет длительность T5, делая его более длинным или коротким в зависимости от относительного смещения keyframe2 и keyframe3.</span><span class="sxs-lookup"><span data-stu-id="9352f-233">This alters the duration of T5, making it longer or shorter depending on the relative offsets of keyframe2 and keyframe3.</span></span>

![Иллюстрация, демонстрирующая аддитон перехода между опорными кадрами](images/addtransitionbetweenkeyframes.png)

### <a name="holding-variables"></a><span data-ttu-id="9352f-235">Хранение переменных</span><span class="sxs-lookup"><span data-stu-id="9352f-235">Holding Variables</span></span>

<span data-ttu-id="9352f-236">Если T4 завершается после T2 и T5, то раскадровка прекращает анимировать переменные X и Y, делая их доступными для анимации других раскадровок.</span><span class="sxs-lookup"><span data-stu-id="9352f-236">If T4 does end after T2 and T5, the storyboard stops animating variables X and Y, making them available for other storyboards to animate.</span></span> <span data-ttu-id="9352f-237">Однако приложение может вызвать метод [**иуианиматионсторибоард:: холдвариабле**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-holdvariable) , чтобы запрашивать, что раскадровка удерживает некоторые или все переменные, которые она анимирует, в своих конечных значениях до завершения раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-237">However, the application can call the [**IUIAnimationStoryboard::HoldVariable**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-holdvariable) method to request that the storyboard hold some or all of the variables it animates at their final values until the storyboard has completed.</span></span> <span data-ttu-id="9352f-238">На следующей диаграмме показан результат удержания X и Z при последнем завершении T4.</span><span class="sxs-lookup"><span data-stu-id="9352f-238">The following diagram shows the result of holding X and Z when T4 finishes last.</span></span> <span data-ttu-id="9352f-239">Обратите внимание, что раскадровка содержит X в своем окончательном значении до завершения раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-239">Notice that the storyboard holds X at its final value until the storyboard has completed.</span></span> <span data-ttu-id="9352f-240">Удержание не влияет на Z, поскольку раскадровка заканчивается после завершения T4.</span><span class="sxs-lookup"><span data-stu-id="9352f-240">The hold has no effect on Z because the storyboard ends when T4 finishes.</span></span>

![Иллюстрация, показывающая хранение переменных в конечных значениях до завершения раскадровки](images/holdvariable.png)

<span data-ttu-id="9352f-242">Несмотря на то, что эта раскадровка не удерживает Y, ее значение не меняется после завершения T5, если только другая раскадровка не выполняет анимацию.</span><span class="sxs-lookup"><span data-stu-id="9352f-242">Even though Y is not held by this storyboard, its value does not change after T5 completes unless another storyboard animates it.</span></span> <span data-ttu-id="9352f-243">Поскольку Y не удерживается, любая другая раскадровка, независимо от приоритета, может анимировать Y после завершения T5.</span><span class="sxs-lookup"><span data-stu-id="9352f-243">Because Y is not held, any other storyboard, regardless of priority, can animate Y after T5 has finished.</span></span> <span data-ttu-id="9352f-244">В отличие от этого, поскольку удерживается X, раскадровка с более низким приоритетом не может анимировать X до завершения этой раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-244">In contrast, because X is held, a lower-priority storyboard cannot animate X until this storyboard is finished.</span></span>

<span data-ttu-id="9352f-245">Во всех этих иллюстрациях предполагается произвольный набор текущих значений для переменных, когда начинается воспроизведение раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-245">All of these illustrations have assumed an arbitrary set of current values for the variables when the storyboard starts playing.</span></span> <span data-ttu-id="9352f-246">При обнаружении других значений длительность контекстно-зависимых переходов, скорее всего, будет отличаться, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="9352f-246">If other values are encountered, the durations of the context-sensitive transitions are likely to be different, as shown in the following illustration.</span></span>

![Иллюстрация, демонстрирующая результат изменения начальных условий, использованных для предыдущей иллюстрации](images/holdvariablez.png)

<span data-ttu-id="9352f-248">В этом сценарии T5 начинается до того, как T3 завершен, а T3, следовательно, усекается.</span><span class="sxs-lookup"><span data-stu-id="9352f-248">In this scenario, T5 begins before T3 has finished, and T3 is therefore trimmed.</span></span> <span data-ttu-id="9352f-249">Поскольку T4 завершается раньше T2 и T5, значение Z удерживается до конца раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-249">Because T4 finishes earlier than T2 and T5, the value of Z is held until the end of the storyboard.</span></span> <span data-ttu-id="9352f-250">Как правило, значения и скоростей переменных при запуске раскадровки могут повлиять на порядок кадров и общую длину и форму раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-250">In general, the values and velocities of variables when a storyboard starts playing can affect keyframe ordering and the overall length and shape of the storyboard.</span></span>

### <a name="scheduling-a-storyboard"></a><span data-ttu-id="9352f-251">Планирование раскадровки</span><span class="sxs-lookup"><span data-stu-id="9352f-251">Scheduling a Storyboard</span></span>

<span data-ttu-id="9352f-252">При планировании раскадровки ее время начала определяется по структуре и контурам раскадровок, которые в данный момент находятся в расписании.</span><span class="sxs-lookup"><span data-stu-id="9352f-252">When scheduling a storyboard, its start time is determined by its outline and the outlines of the storyboards that are currently in the schedule.</span></span> <span data-ttu-id="9352f-253">В частности, первое и последнее время, когда раскадровка анимируется каждую отдельную переменную, определяют, когда две раскадровки конфликтуют, а внутренние сведения о переходах в пределах не важны.</span><span class="sxs-lookup"><span data-stu-id="9352f-253">Specifically, the first and last moments when the storyboard animates each individual variable determine whether and when two storyboards collide, but the internal details of the transitions within are not important.</span></span>

<span data-ttu-id="9352f-254">На следующем рисунке показана структура раскадровки с пятью переходами, которая выполняет анимацию трех переменных.</span><span class="sxs-lookup"><span data-stu-id="9352f-254">The following illustration shows the outline of a storyboard with five transitions animating three variables.</span></span>

![Иллюстрация с раскадровкой с пятью переходами анимация трех переменных](images/storyboardwithoutline.png)

<span data-ttu-id="9352f-256">Основой платформы анимации Windows является поддержка выполнения одной анимации до начала другой, когда это необходимо.</span><span class="sxs-lookup"><span data-stu-id="9352f-256">A cornerstone of the Windows Animation platform is its support for letting one animation complete before another begins, when necessary.</span></span> <span data-ttu-id="9352f-257">Хотя это устраняет многие логические проблемы, оно также вводит произвольную задержку в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9352f-257">While this eliminates many logical problems, it also introduces arbitrary latency in the UI.</span></span> <span data-ttu-id="9352f-258">Для решения этой задачи приложения могут указать *самую длинную допустимую задержку* для запуска раскадровки с помощью метода [**Иуианиматионсторибоард:: сетлонжестакцептабледелай**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-setlongestacceptabledelay) , а диспетчер анимации использует эти сведения для планирования раскадровки до истечения указанного периода задержки.</span><span class="sxs-lookup"><span data-stu-id="9352f-258">To address this, applications can specify the *longest acceptable delay* for a storyboard to start, using the [**IUIAnimationStoryboard::SetLongestAcceptableDelay**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-setlongestacceptabledelay) method, and the animation manager uses this information to schedule the storyboard before the specified latency period elapses.</span></span> <span data-ttu-id="9352f-259">При планировании раскадровки диспетчер анимации определяет, должны ли быть отменены, обрезаны, завершены или сжаты другие раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-259">When a storyboard is scheduled, the animation manager determines if other storyboards must first be canceled, trimmed, concluded, and/or compressed.</span></span>

<span data-ttu-id="9352f-260">Приложение может зарегистрировать обработчик, который будет вызываться при изменении состояния раскадровки.</span><span class="sxs-lookup"><span data-stu-id="9352f-260">An application can register a handler that will be called when a storyboard's status changes.</span></span> <span data-ttu-id="9352f-261">Это позволяет приложению ответить, когда раскадровка начинается, выполняется до завершения, удаляется полностью из расписания или из-за прерывания с помощью раскадровки с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="9352f-261">This enables the application to respond when the storyboard starts playing, runs to completion, is removed entirely from the schedule, or is prevented from completing due to interruption by a higher-priority storyboard.</span></span> <span data-ttu-id="9352f-262">Для обнаружения раскадровки, передаваемых обработчикам событий раскадровки (или сравнению приоритетов), приложение может использовать метод [**иуианиматионсторибоард:: сеттаг**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-settag) для применения тегов к раскадровкам аналогично тем, которые можно использовать для обозначения переменных.</span><span class="sxs-lookup"><span data-stu-id="9352f-262">To identify the storyboards passed to storyboard event handlers (or priority comparisons), an application can use the [**IUIAnimationStoryboard::SetTag**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationstoryboard-settag) method to apply tags to storyboards, similar to those that can be used to identify variables.</span></span> <span data-ttu-id="9352f-263">Как и в случае повторного использования раскадровки, разработчики должны соблюдать осторожность при использовании тегов для определения раскадровок и убедиться, что неоднозначность возникает, когда пользовательские действия приводят к постановке в очередь нескольких раскадровок.</span><span class="sxs-lookup"><span data-stu-id="9352f-263">As with storyboard re-use, developers must exercise caution when using tags to identify storyboards, and be sure that ambiguities do not arise when user actions result in many storyboards being queued.</span></span>

<span data-ttu-id="9352f-264">В следующих примерах показаны два варианта планирования раскадровки, построенной в предыдущих разделах этого раздела.</span><span class="sxs-lookup"><span data-stu-id="9352f-264">The following examples show two variations of an attempt to schedule the storyboard built in the earlier sections of this topic.</span></span>

<span data-ttu-id="9352f-265">В этом сценарии шесть раскадровок, от A до F, уже запланировали анимацию переменных W, X, Y и Z, но началось воспроизведение только A и B.</span><span class="sxs-lookup"><span data-stu-id="9352f-265">In this scenario, six storyboards, A through F, have already been scheduled to animate variables W, X, Y and Z, but only A and B have started playing.</span></span> <span data-ttu-id="9352f-266">Новая раскадровка с меткой G имеет самую длинную допустимую задержку, указанную на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="9352f-266">The new storyboard, labeled G, has its longest acceptable delay set to the duration shown in the following illustration.</span></span>

![Иллюстрация, демонстрирующая Добавление новой раскадровки к существующему расписанию](images/existingschedule1withlines.png)

<span data-ttu-id="9352f-268">В приложении зарегистрированы сравнения приоритетов, включающие следующую логику:</span><span class="sxs-lookup"><span data-stu-id="9352f-268">The application has registered priority comparisons that include the following logic:</span></span>

-   <span data-ttu-id="9352f-269">G может отменять только C и E и только для предотвращения сбоя.</span><span class="sxs-lookup"><span data-stu-id="9352f-269">G can cancel only C and E, and only to prevent failure.</span></span>
-   <span data-ttu-id="9352f-270">G может обрезать только A, C, E и F и только для предотвращения сбоя.</span><span class="sxs-lookup"><span data-stu-id="9352f-270">G can trim only A, C, E and F, and only to prevent failure.</span></span>
-   <span data-ttu-id="9352f-271">Любая раскадровка может сжимать любую другую раскадровку (сжатие всегда выполняется только во избежание сбоя).</span><span class="sxs-lookup"><span data-stu-id="9352f-271">Any storyboard can compress any other storyboard (compression is always done only to prevent failure).</span></span>

> [!Note]  
> <span data-ttu-id="9352f-272">Квалификатор "только для предотвращения сбоя" означает, что зарегистрированные сравнения приоритетов возвращают значение " \_ ОК" только в том случае, если параметр *приоритеффект* имеет значение " **\_ \_ \_ \_ сбой эффекта анимации пользовательского интерфейса**".</span><span class="sxs-lookup"><span data-stu-id="9352f-272">The qualifier "only to prevent failure" means that the registered priority comparisons return S\_OK only when the *priorityEffect* parameter is **UI\_ANIMATION\_PRIORITY\_EFFECT\_FAILURE**.</span></span> <span data-ttu-id="9352f-273">Дополнительные сведения см. в описании метода [**иуианиматионприоритикомпарисон:: хасприорити**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationprioritycomparison-haspriority) .</span><span class="sxs-lookup"><span data-stu-id="9352f-273">See the [**IUIAnimationPriorityComparison::HasPriority**](/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationprioritycomparison-haspriority) method for details.</span></span>

 

<span data-ttu-id="9352f-274">Чтобы начать G до истечения максимальной допустимой задержки, диспетчер анимации должен выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9352f-274">To start G before the longest acceptable delay has elapsed, the animation manager must do the following:</span></span>

-   <span data-ttu-id="9352f-275">Обрезать F</span><span class="sxs-lookup"><span data-stu-id="9352f-275">Trim F</span></span>
-   <span data-ttu-id="9352f-276">Отмена E</span><span class="sxs-lookup"><span data-stu-id="9352f-276">Cancel E</span></span>

<span data-ttu-id="9352f-277">Когда E отменяется, D и F открываются и возвращаются к исходным контурам:</span><span class="sxs-lookup"><span data-stu-id="9352f-277">When E is canceled, D and F are uncovered and revert to their original outlines:</span></span>

![Иллюстрация, демонстрирующая исходные контуры](images/existingschedule1bwithlines.png)

<span data-ttu-id="9352f-279">Диспетчеру анимации не нужно отменять или обрезать C до расписания до истечения максимальной допустимой задержки, поэтому встреча C и G определяет время начала операции G.</span><span class="sxs-lookup"><span data-stu-id="9352f-279">The animation manager does not need to cancel or trim C to schedule before its longest acceptable delay has elapsed, so the meeting of C and G determines when G starts.</span></span>

![Иллюстрация, показывающая, что f обрезан, чтобы разрешить c и g отвечать](images/schedule1withgwithlines.png)

<span data-ttu-id="9352f-281">После успешного планирования операции G можно определить продолжительность ее переходов, и в остальной части ее структуры будет известно, что она известна.</span><span class="sxs-lookup"><span data-stu-id="9352f-281">After G has been successfully scheduled, the durations of its transitions can be determined, and the remainder of its outline is therefore known.</span></span> <span data-ttu-id="9352f-282">Однако структура может измениться, если другая раскадровка будет удалена из расписания.</span><span class="sxs-lookup"><span data-stu-id="9352f-282">However, the outline can change if another storyboard is subsequently removed from the schedule.</span></span>

<span data-ttu-id="9352f-283">Во втором примере рассмотрим сценарий, подобный приведенному выше, но с более короткой допустимой задержкой, заданной для G.</span><span class="sxs-lookup"><span data-stu-id="9352f-283">As a second example, consider a scenario like that above, but with a shorter longest acceptable delay specified for G.</span></span>

![Иллюстрация, показанная в предыдущем сценарии, но с более короткой допустимой задержкой для g](images/existingschedule2withlines.png)

<span data-ttu-id="9352f-285">В этом случае выполняются следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9352f-285">In this case, the following actions are taken:</span></span>

-   <span data-ttu-id="9352f-286">Обрезать F</span><span class="sxs-lookup"><span data-stu-id="9352f-286">Trim F</span></span>
-   <span data-ttu-id="9352f-287">Отмена E</span><span class="sxs-lookup"><span data-stu-id="9352f-287">Cancel E</span></span>
-   <span data-ttu-id="9352f-288">Отмена в</span><span class="sxs-lookup"><span data-stu-id="9352f-288">Cancel C</span></span>

<span data-ttu-id="9352f-289">Кроме того, диспетчер анимации должен сжимать D по показанному объему, чтобы разрешить запуск G по истечении максимальной допустимой задержки, а не позже.</span><span class="sxs-lookup"><span data-stu-id="9352f-289">Also, the animation manager must compress D by the amount shown to enable G to start after its longest acceptable delay, and no later.</span></span>

![Иллюстрация, показывающая, где d должен быть сжат, чтобы разрешить запуск g с максимальной допустимой задержкой](images/trimmedandcancelledwithlines.png)

<span data-ttu-id="9352f-291">Для сохранения относительных сроков, A, B и F также сжимаются.</span><span class="sxs-lookup"><span data-stu-id="9352f-291">To preserve their relative timing, A, B, and F are compressed as well.</span></span>

![Иллюстрация, в которой показаны сжатые, b, d и f](images/schedule2withgwithlines.png)

<span data-ttu-id="9352f-293">Однако раскадровки несвязанных переменных (не показано) не будут сжиматься.</span><span class="sxs-lookup"><span data-stu-id="9352f-293">However, storyboards on unrelated variables (not shown) would not be compressed.</span></span>

<span data-ttu-id="9352f-294">Опять же, структура G теперь известна и отличается от результата в первом сценарии, так как переменные имеют разные значения при начале G.</span><span class="sxs-lookup"><span data-stu-id="9352f-294">Once again, the outline of G is now known and is different from the result in the first scenario because the variables have different values when G begins.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9352f-295">См. также</span><span class="sxs-lookup"><span data-stu-id="9352f-295">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9352f-296">**иуианиматионманажер**</span><span class="sxs-lookup"><span data-stu-id="9352f-296">**IUIAnimationManager**</span></span>](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationmanager)
</dt> <dt>

[<span data-ttu-id="9352f-297">**иуианиматионприоритикомпарисон**</span><span class="sxs-lookup"><span data-stu-id="9352f-297">**IUIAnimationPriorityComparison**</span></span>](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationprioritycomparison)
</dt> <dt>

[<span data-ttu-id="9352f-298">**иуианиматионсторибоард**</span><span class="sxs-lookup"><span data-stu-id="9352f-298">**IUIAnimationStoryboard**</span></span>](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationstoryboard)
</dt> <dt>

[<span data-ttu-id="9352f-299">**иуианиматионтранситионлибрари**</span><span class="sxs-lookup"><span data-stu-id="9352f-299">**IUIAnimationTransitionLibrary**</span></span>](/windows/desktop/api/UIAnimation/nn-uianimation-iuianimationtransitionlibrary)
</dt> </dl>

 

