---
title: Общие сведения о анимации Windows
description: В этом обзоре представлено введение в диспетчер анимации Windows и основное внимание уделяется основным компонентам и концепциям.
ms.assetid: de1380c9-6801-4178-9281-a23af7d71d77
keywords:
- Анимация Windows для анимации Windows, обзор
- Анимация Windows объектов диспетчера анимации, описание
- Анимация Windows, описание переменных анимации
- Анимация объектов таймера Windows, описание
- Анимация системы управления временем Windows
- контекстно-зависимая длительность анимации Windows
- Анимация Windows, соответствующая скорости
- Анимация Windows для управления состязаниями
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6a60b02b29d8d434cc93420f36c3cdca4428f94c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070103"
---
# <a name="windows-animation-overview"></a><span data-ttu-id="d6ef5-111">Общие сведения о анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-111">Windows Animation Overview</span></span>

<span data-ttu-id="d6ef5-112">В этом обзоре представлено введение в диспетчер анимации Windows и основное внимание уделяется основным компонентам и концепциям.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-112">This overview provides an introduction to the Windows Animation Manager and focuses on key components and concepts.</span></span> <span data-ttu-id="d6ef5-113">Дополнительные сведения о раскадровках и переходах см. в разделе [Общие сведения о раскадровке](storyboard-construction.md).</span><span class="sxs-lookup"><span data-stu-id="d6ef5-113">For more information on storyboards and transitions, see [Storyboard Overview](storyboard-construction.md).</span></span>

<span data-ttu-id="d6ef5-114">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-114">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="d6ef5-115">Основные понятия</span><span class="sxs-lookup"><span data-stu-id="d6ef5-115">Basic Concepts</span></span>](#basic-concepts)
-   [<span data-ttu-id="d6ef5-116">Компоненты анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-116">Components of Windows Animation</span></span>](#components-of-windows-animation)
-   [<span data-ttu-id="d6ef5-117">API анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-117">The Windows Animation API</span></span>](#the-windows-animation-api)
-   [<span data-ttu-id="d6ef5-118">Конфигурации</span><span class="sxs-lookup"><span data-stu-id="d6ef5-118">Configurations</span></span>](#configurations)
    -   [<span data-ttu-id="d6ef5-119">Управляемая приложением анимация</span><span class="sxs-lookup"><span data-stu-id="d6ef5-119">Application-Driven Animation</span></span>](#application-driven-animation)
    -   [<span data-ttu-id="d6ef5-120">Управляемая таймером анимация</span><span class="sxs-lookup"><span data-stu-id="d6ef5-120">Timer-Driven Animation</span></span>](#timer-driven-animation)
-   [<span data-ttu-id="d6ef5-121">Дополнительные функции</span><span class="sxs-lookup"><span data-stu-id="d6ef5-121">Advanced Features</span></span>](#advanced-features)
    -   [<span data-ttu-id="d6ef5-122">Управление состязанием</span><span class="sxs-lookup"><span data-stu-id="d6ef5-122">Contention Management</span></span>](#contention-management)
-   [<span data-ttu-id="d6ef5-123">См. также</span><span class="sxs-lookup"><span data-stu-id="d6ef5-123">Related topics</span></span>](#related-topics)

## <a name="basic-concepts"></a><span data-ttu-id="d6ef5-124">Основные понятия</span><span class="sxs-lookup"><span data-stu-id="d6ef5-124">Basic Concepts</span></span>

<span data-ttu-id="d6ef5-125">*Анимация* — это последовательность последовательных изображений, которые создают иллюзию движения при воспроизведении.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-125">*Animation* is a sequence of successive still images that produces an illusion of movement when played back.</span></span> <span data-ttu-id="d6ef5-126">Использование интерактивной анимации в пользовательском интерфейсе может дать приложению уникальную личность, а также улучшить взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-126">Using interactive animation in its user interface can give an application a unique personality as well as improve the user experience.</span></span> <span data-ttu-id="d6ef5-127">Анимация может помочь в обмене основными изменениями состояния в пользовательском интерфейсе и помочь в управлении сложностью пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-127">Animation can help to communicate major state changes in the user interface and help to manage the complexity of the user interface.</span></span> <span data-ttu-id="d6ef5-128">Кроме того, анимация может добавлять пользователя к восприятию качества приложения.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-128">Animation can also add to the user's perception of the quality of an application.</span></span>

<span data-ttu-id="d6ef5-129">Например, анимация Windows используется на панели задач для управления файлами и программами и доступа к ним, а также с помощью экранной лупы для увеличения различных частей экрана, чтобы облегчить пользователям доступ к ним.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-129">As examples, Windows Animation is used in the taskbar to help you manage and access files and programs, and Magnifier to enlarge different parts of the screen to make them easier for users to see.</span></span>

<span data-ttu-id="d6ef5-130">Фундаментальными единицами анимации являются характеристики визуального элемента, который будет анимирован, и описание способа изменения этой характеристики с течением времени.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-130">The fundamental units of an animation are the characteristic of a visual element to be animated and the description of how that characteristic changes over time.</span></span> <span data-ttu-id="d6ef5-131">Приложение может анимировать разнообразные характеристики, такие как расположение, цвет, размер, поворот, контрастность и непрозрачность.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-131">An application can animate a wide variety of characteristics such as position, color, size, rotation, contrast, and opacity.</span></span>

<span data-ttu-id="d6ef5-132">В анимации Windows *переменная анимации* представляет характеристики для анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-132">In Windows Animation, an *animation variable* represents the characteristic to be animated.</span></span> <span data-ttu-id="d6ef5-133">*Переход* описывает, как происходит изменение значения этой переменной анимации при анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-133">A *transition* describes how the value of that animation variable changes as animation occurs.</span></span> <span data-ttu-id="d6ef5-134">Например, визуальный элемент может иметь переменную анимации, указывающую ее непрозрачность, а пользовательское действие может создать переход, который принимает эту непрозрачность из значения 50 в 100, представляющего анимацию с полупрозрачной на полностью непрозрачный.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-134">For example, a visual element might have an animation variable that specifies its opacity, and a user action might generate a transition that takes that opacity from a value of 50 to 100, representing an animation from semi-transparent to fully opaque.</span></span>

<span data-ttu-id="d6ef5-135">*Раскадровка* — это набор переходов, применяемых к одной или нескольким переменным анимации с течением времени.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-135">A *storyboard* is a set of transitions applied to one or more animation variables over time.</span></span> <span data-ttu-id="d6ef5-136">Приложение отображает анимацию, создавая и проигрывать раскадровки, а затем рисуя последовательности дискретных кадров по мере изменения значений переменных анимации со временем.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-136">An application displays animations by constructing and playing storyboards and then drawing sequences of discrete frames as the values of animation variables change over time.</span></span>

## <a name="components-of-windows-animation"></a><span data-ttu-id="d6ef5-137">Компоненты анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-137">Components of Windows Animation</span></span>

<span data-ttu-id="d6ef5-138">Анимация Windows состоит из следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="d6ef5-138">Windows Animation consists of the following components:</span></span>

<dl> <dt>

<span data-ttu-id="d6ef5-139"><span id="animation_manager"></span><span id="ANIMATION_MANAGER"></span>диспетчер анимации</span><span class="sxs-lookup"><span data-stu-id="d6ef5-139"><span id="animation_manager"></span><span id="ANIMATION_MANAGER"></span>animation manager</span></span>
</dt> <dd>

<span data-ttu-id="d6ef5-140">Приложения используют объект диспетчера анимации для создания переменных и раскадровок анимации, планирования и управления анимацией, а также обновления сведений о состоянии до того, как приложение рисует каждый кадр.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-140">Applications use an animation manager object to create animation variables and storyboards, schedule and control animations, and update state information before the application draws each frame.</span></span> <span data-ttu-id="d6ef5-141">Один объект диспетчера анимации обычно управляет всеми анимациями в приложении и, таким образом, обладает глобальным контролем над всеми запланированными раскадровкой.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-141">A single animation manager object typically manages all animations across an application and therefore has global control over all scheduled storyboards.</span></span>

</dd> <dt>

<span data-ttu-id="d6ef5-142"><span id="animation_variables"></span><span id="ANIMATION_VARIABLES"></span>переменные анимации</span><span class="sxs-lookup"><span data-stu-id="d6ef5-142"><span id="animation_variables"></span><span id="ANIMATION_VARIABLES"></span>animation variables</span></span>
</dt> <dd>

<span data-ttu-id="d6ef5-143">Перед запуском анимации приложению необходимо создать объекты переменных анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-143">Before starting any animations, an application needs to create animation variable objects.</span></span> <span data-ttu-id="d6ef5-144">Переменная анимации представляет один аспект визуального элемента для анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-144">An animation variable represents one aspect of a visual element to be animated.</span></span> <span data-ttu-id="d6ef5-145">Переменная является скалярным значением с плавающей запятой, хотя значение может быть округлено до целого значения.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-145">The variable is a scalar floating-point value, although the value can be rounded to an integer value.</span></span>

<span data-ttu-id="d6ef5-146">Переменная анимации обычно имеет то же время существования, что и визуальный элемент, предназначенный для анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-146">An animation variable typically has the same lifetime as the visual element it is to animate.</span></span> <span data-ttu-id="d6ef5-147">Начальное значение переменной анимации указывается при создании переменной.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-147">The initial value of an animation variable is specified when the variable is created.</span></span> <span data-ttu-id="d6ef5-148">После этого его значение нельзя изменить напрямую. его необходимо обновить с помощью диспетчера анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-148">Thereafter, its value cannot be changed directly; it must be updated through the animation manager.</span></span>

<span data-ttu-id="d6ef5-149">Переменная анимации может быть идентифицирована с помощью *тега*, который представляет собой пару целочисленных идентификаторов с указателем на COM-объект.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-149">An animation variable can be identified by a *tag*, which is a pairing of an integer identifier with a pointer to a COM object.</span></span> <span data-ttu-id="d6ef5-150">Тег не должен быть уникальным, если только приложение не использует его для поиска переменной.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-150">A tag need not be unique, unless the application uses it to search for a variable.</span></span> <span data-ttu-id="d6ef5-151">По умолчанию у переменной анимации отсутствует тег, и любые попытки чтения тега будут завершаться ошибкой, пока не будет задан другой.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-151">By default, an animation variable does not have a tag, and any attempts to read its tag will fail until one has been set.</span></span>

</dd> <dt>

<span data-ttu-id="d6ef5-152"><span id="timing_system"></span><span id="TIMING_SYSTEM"></span>система управления временем</span><span class="sxs-lookup"><span data-stu-id="d6ef5-152"><span id="timing_system"></span><span id="TIMING_SYSTEM"></span>timing system</span></span>
</dt> <dd>

<span data-ttu-id="d6ef5-153">Анимация Windows включает систему времени, позволяющую обеспечить визуализацию анимации по частоте кадров, которая является гладким и последовательным, а также сокращает использование системных ресурсов для отрисовки при занятости системы.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-153">Windows Animation includes a timing system that helps to ensure that animations are rendered at a frame rate that is smooth and consistent, while also reducing the use of system resources for rendering when the system is busy.</span></span> <span data-ttu-id="d6ef5-154">*Таймер* помогает управлять отрисовкой анимации, автоматически указывая на небольшую единицу времени, называемую *тактовой*.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-154">A *timer* helps to manage animation rendering by automatically indicating the passage of a small unit of time, called a *tick*.</span></span> <span data-ttu-id="d6ef5-155">Система управления временем отслеживает общую производительность отрисовки системы и *регулирует* анимацию за счет динамического увеличения или уменьшения частоты тактов.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-155">The timing system monitors overall system rendering performance and *throttles* animations by dynamically increasing or decreasing the frequency of ticks.</span></span> <span data-ttu-id="d6ef5-156">Приложения могут позволить устройству таймера использовать диспетчер анимации и регистрировать обработчик, который должен получать уведомления до и после обновления руководителя для каждого такта.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-156">Applications can let a timer drive the animation manager and can register a handler to be notified before and after the manager is updated for each tick.</span></span> <span data-ttu-id="d6ef5-157">Приложения могут задавать минимально приемлемую частоту кадров анимации для таймера и получать уведомления, если фактическая частота кадров анимации падает ниже этой скорости.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-157">Applications can specify the minimum acceptable animation frame rate for a timer and be notified if an animation's actual frame rate falls below this rate.</span></span>

<span data-ttu-id="d6ef5-158">Для экономии системных ресурсов таймер можно настроить на отключение самого себя, если анимация не выполняется.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-158">To conserve system resources, a timer can be configured to disable itself when no animation is taking place.</span></span>

</dd> </dl>

## <a name="the-windows-animation-api"></a><span data-ttu-id="d6ef5-159">API анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-159">The Windows Animation API</span></span>

<span data-ttu-id="d6ef5-160">API анимации Windows — это однопотоковый API на основе COM, который предоставляет разработчикам следующие возможности:</span><span class="sxs-lookup"><span data-stu-id="d6ef5-160">The Windows Animation API is a single-threaded COM-based API that provides the following features for developers:</span></span>

-   <span data-ttu-id="d6ef5-161">Объект диспетчера анимации [**уианиматионманажер**](/previous-versions/windows/desktop/legacy/dd317019(v=vs.85))для создания объектов анимации и управления анимациями</span><span class="sxs-lookup"><span data-stu-id="d6ef5-161">An animation manager object, [**UIAnimationManager**](/previous-versions/windows/desktop/legacy/dd317019(v=vs.85)), for creating animation objects and controlling animations</span></span>
-   <span data-ttu-id="d6ef5-162">Переменные и раскадровки анимации</span><span class="sxs-lookup"><span data-stu-id="d6ef5-162">Animation variables and storyboards</span></span>
-   <span data-ttu-id="d6ef5-163">Базовая библиотека, [**уианиматионтранситионлибрари**](/previous-versions/windows/desktop/legacy/dd317028(v=vs.85)), готовые к использованию переходы</span><span class="sxs-lookup"><span data-stu-id="d6ef5-163">A foundational library, [**UIAnimationTransitionLibrary**](/previous-versions/windows/desktop/legacy/dd317028(v=vs.85)), of ready-to-use transitions</span></span>
-   <span data-ttu-id="d6ef5-164">Объект Timer, [**уианиматионтимер**](/previous-versions/windows/desktop/legacy/dd317021(v=vs.85)), для определения текущего времени и (необязательно) для анимации движения.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-164">A timer object, [**UIAnimationTimer**](/previous-versions/windows/desktop/legacy/dd317021(v=vs.85)), for determining the current time and, optionally, for driving animation</span></span>
-   <span data-ttu-id="d6ef5-165">Обработчики событий для наблюдения за состоянием и ходом выполнения анимации</span><span class="sxs-lookup"><span data-stu-id="d6ef5-165">Event hooks for monitoring the state and progress of animation</span></span>

<span data-ttu-id="d6ef5-166">Полный справочник по API см. в [справочнике по анимации Windows](windows-animation-reference.md).</span><span class="sxs-lookup"><span data-stu-id="d6ef5-166">For the complete API reference, see [Windows Animation Reference](windows-animation-reference.md).</span></span> <span data-ttu-id="d6ef5-167">Пример кода см. в разделе [задачи анимации Windows](using-windows-animation.md) и [примеры анимации Windows](windows-animation-samples.md).</span><span class="sxs-lookup"><span data-stu-id="d6ef5-167">For example code, see [Windows Animation Tasks](using-windows-animation.md) and [Windows Animation Samples](windows-animation-samples.md).</span></span>

## <a name="configurations"></a><span data-ttu-id="d6ef5-168">Конфигурации</span><span class="sxs-lookup"><span data-stu-id="d6ef5-168">Configurations</span></span>

<span data-ttu-id="d6ef5-169">Перед планированием новой анимации приложения должны получить текущее время.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-169">Applications must get the current time before scheduling a new animation.</span></span> <span data-ttu-id="d6ef5-170">Ниже приведены механизмы синхронизации, поддерживаемые анимацией Windows.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-170">The following are the timing mechanisms supported by Windows Animation:</span></span>

-   [<span data-ttu-id="d6ef5-171">Управляемая приложением анимация</span><span class="sxs-lookup"><span data-stu-id="d6ef5-171">Application-Driven Animation</span></span>](#application-driven-animation)
-   [<span data-ttu-id="d6ef5-172">Управляемая таймером анимация</span><span class="sxs-lookup"><span data-stu-id="d6ef5-172">Timer-Driven Animation</span></span>](#timer-driven-animation)

### <a name="application-driven-animation"></a><span data-ttu-id="d6ef5-173">Анимация Application-Driven</span><span class="sxs-lookup"><span data-stu-id="d6ef5-173">Application-Driven Animation</span></span>

<span data-ttu-id="d6ef5-174">Приложения, использующие графический API с аппаратным ускорением, могут синхронизироваться с частотой обновления монитора для отрисовки гладких анимаций.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-174">Applications using a hardware-accelerated graphics API can synchronize with the monitor refresh rate to render smooth animations.</span></span> <span data-ttu-id="d6ef5-175">Кроме того, приложение может использовать собственный механизм управления временем, чтобы определить, когда следует рисовать каждый кадр анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-175">Alternately, an application may use a timing mechanism of its own to determine when to draw each frame of an animation.</span></span> <span data-ttu-id="d6ef5-176">В любом случае приложение сообщит диспетчеру анимации о необходимости обновления своего состояния.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-176">In either case, the application will tell the animation manager when to update its state.</span></span> <span data-ttu-id="d6ef5-177">Таймер анимации по-прежнему можно использовать для определения текущего времени с высокой точностью в единицах, необходимых для диспетчера анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-177">An animation timer can still be used to determine the current time with high precision, in the units required by the animation manager.</span></span>

<span data-ttu-id="d6ef5-178">На следующей диаграмме показано взаимодействие между приложением и компонентами анимации Windows, когда приложение непосредственно изменяет анимацию.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-178">The following diagram shows the interactions between an application and the Windows Animation components when the application is driving animation updates directly.</span></span>

![Схема, показывающая взаимодействие между приложением и компонентами анимации Windows, когда приложение перемещает обновления анимации напрямую.](images/animationupdates.png)

<span data-ttu-id="d6ef5-180">В простейшей конфигурации приложение будет перерисовывать все при каждом обновлении экрана, даже если анимация не воспроизводится.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-180">In the simplest configuration, an application will redraw everything every time the screen is refreshed, even when no animations are playing.</span></span> <span data-ttu-id="d6ef5-181">Чтобы избежать излишней работы, приложение может зарегистрировать обработчик событий руководителя, чтобы получать уведомления о запланированных анимациях, а также определить, когда расписание пусто, чтобы его можно было переустановить.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-181">To avoid wasted work, an application can register a manager event handler to be notified when there are animations scheduled, and can detect when the schedule is empty so that it can stop redrawing.</span></span>

### <a name="timer-driven-animation"></a><span data-ttu-id="d6ef5-182">Анимация Timer-Driven</span><span class="sxs-lookup"><span data-stu-id="d6ef5-182">Timer-Driven Animation</span></span>

<span data-ttu-id="d6ef5-183">Вместо непосредственного обновления диспетчера анимации приложения могут позволить таймеру анимации сообщить диспетчеру анимации о необходимости обновления его состояния и просто получать уведомления о каждом обновлении.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-183">Rather than updating the animation manager directly, applications may let the animation timer tell the animation manager when to update its state, and simply be notified when each update has taken place.</span></span> <span data-ttu-id="d6ef5-184">Этот подход рекомендуется для более старых графических API.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-184">This approach is recommended for older graphics APIs.</span></span> <span data-ttu-id="d6ef5-185">В общем случае, если можно выполнить синхронизацию с частотой обновления монитора, лучше сделать это и использовать управляемую приложением анимацию.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-185">In general, if it is possible to synchronize with the monitor refresh rate, it is better to do so and use application-driven animation.</span></span>

<span data-ttu-id="d6ef5-186">На следующей диаграмме показано взаимодействие между приложением и компонентами анимации Windows, когда таймер анимации управляет обновлением анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-186">The following diagram shows the interactions between an application and the Windows Animation components when the animation timer is driving animation updates.</span></span>

![Схема, показывающая взаимодействие между приложением и компонентами анимации Windows, когда таймер анимации управляет обновлением анимации.](images/animationtimerupdates.png)

<span data-ttu-id="d6ef5-188">Таймер можно настроить так, чтобы он выполнялся только при планировании анимации. Это позволяет просто передать определенный параметр при подключении таймера и диспетчера анимации.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-188">The timer can be configured to run only when the animations are scheduled; doing so is a simple matter of passing a particular parameter when the timer and animation manager are connected.</span></span>

## <a name="advanced-features"></a><span data-ttu-id="d6ef5-189">Дополнительные функции</span><span class="sxs-lookup"><span data-stu-id="d6ef5-189">Advanced Features</span></span>

<span data-ttu-id="d6ef5-190">Помимо базовой основы для поддержки анимации, в Windows анимация включена поддержка нескольких улучшенных методик анимации, включая:</span><span class="sxs-lookup"><span data-stu-id="d6ef5-190">Beyond a basic foundation to support animation, Windows Animation includes support for several advanced animation techniques, including:</span></span>

<dl> <dt>

<span data-ttu-id="d6ef5-191"><span id="context-sensitive_duration"></span><span id="CONTEXT-SENSITIVE_DURATION"></span>*Длительность, зависящая от контекста*</span><span class="sxs-lookup"><span data-stu-id="d6ef5-191"><span id="context-sensitive_duration"></span><span id="CONTEXT-SENSITIVE_DURATION"></span>*context-sensitive duration*</span></span>
</dt> <dd>

<span data-ttu-id="d6ef5-192">Длительность перехода не требует исправления; его можно определить на основе значения и скорости анимированной переменной при начале перехода.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-192">The duration of a transition need not be fixed; it can be determined based on the value and velocity of the animated variable when the transition begins.</span></span>

</dd> <dt>

<span data-ttu-id="d6ef5-193"><span id="velocity_matching"></span><span id="VELOCITY_MATCHING"></span>*Сопоставление скорости*</span><span class="sxs-lookup"><span data-stu-id="d6ef5-193"><span id="velocity_matching"></span><span id="VELOCITY_MATCHING"></span>*velocity matching*</span></span>
</dt> <dd>

<span data-ttu-id="d6ef5-194">Движение, как правило, более привлекательно для глаза, если расположение и скорость перемещаемого объекта не переходят между значениями.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-194">Movement is generally more pleasing to the eye if a moving object's position and velocity do not jump instantaneously between values.</span></span> <span data-ttu-id="d6ef5-195">При прерывании новой раскадровки, которая сейчас воспроизводится, новая раскадровка обеспечивает бесперебойную работу, где закончилась Предыдущая.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-195">When a new storyboard interrupts one that is currently playing, velocity matching enables the new storyboard to pick up smoothly where the previous one ended.</span></span>

</dd> <dt>

<span data-ttu-id="d6ef5-196"><span id="contention_management"></span><span id="CONTENTION_MANAGEMENT"></span>*Управление состязанием*</span><span class="sxs-lookup"><span data-stu-id="d6ef5-196"><span id="contention_management"></span><span id="CONTENTION_MANAGEMENT"></span>*contention management*</span></span>
</dt> <dd>

<span data-ttu-id="d6ef5-197">Если две раскадровки нуждаются в одновременном обновлении одной и той же переменной анимации, возникает конфликт планирования.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-197">If two storyboards need to update the same animation variable simultaneously, a scheduling conflict occurs.</span></span> <span data-ttu-id="d6ef5-198">Вместо того чтобы требовать определенного числового приоритета для каждой раскадровки, анимация Windows позволяет приложению определять относительные приоритеты любых двух раскадровок.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-198">Rather than requiring a specific numeric priority for each storyboard, Windows Animation enables the application to determine the relative priorities of any two storyboards.</span></span>

</dd> </dl>

### <a name="contention-management"></a><span data-ttu-id="d6ef5-199">Управление состязанием</span><span class="sxs-lookup"><span data-stu-id="d6ef5-199">Contention Management</span></span>

<span data-ttu-id="d6ef5-200">Разработчики могут реализовать обратный вызов *сравнения приоритетов* , чтобы сравнить приоритет раскадровки, для которой выполняется планирование, и раскадровки, которая уже находится в расписании.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-200">Developers can implement a *priority comparison* callback to compare the priority of the storyboard of being scheduled and the storyboard that is already in the schedule.</span></span> <span data-ttu-id="d6ef5-201">Приложение, реализующее сравнение приоритетов, может использовать любую предпочтительную логику, чтобы определить, когда раскадровка емптс другой.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-201">An application implementing a priority comparison can use any preferred logic to determine when a storyboard pre-empts another.</span></span> <span data-ttu-id="d6ef5-202">Чтобы устранить конфликт планирования, анимация Windows запрашивает у приложения, какое из этих действий может быть выполнено, в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="d6ef5-202">To resolve the scheduling conflict, Windows Animation asks the application which of these actions may be taken, in the following order:</span></span>

-   <span data-ttu-id="d6ef5-203">**Отмена запланированной раскадровки.**</span><span class="sxs-lookup"><span data-stu-id="d6ef5-203">**Cancel the scheduled storyboard.**</span></span> <span data-ttu-id="d6ef5-204">Если запланированная раскадровка еще не началась для воспроизведения, она может быть отменена и сразу же удалена из расписания.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-204">If the scheduled storyboard has not yet started to play, it might be canceled and immediately removed from the schedule.</span></span>
-   <span data-ttu-id="d6ef5-205">**Обрезать запланированную раскадровку.**</span><span class="sxs-lookup"><span data-stu-id="d6ef5-205">**Trim the scheduled storyboard.**</span></span> <span data-ttu-id="d6ef5-206">Когда новая раскадровка обрезает запланированную раскадровку, запланированная раскадровка перестает влиять на переменную, как только новая раскадровка начинает ее анимировать.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-206">When a new storyboard trims a scheduled storyboard, the scheduled storyboard ceases to affect the variable as soon as the new storyboard begins to animate it.</span></span> <span data-ttu-id="d6ef5-207">Скоростей сопоставляются, что позволяет новой раскадровки восприниматься, когда предыдущая из них была отключена.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-207">The velocities are matched, enabling the new storyboard to pick up smoothly where the previous one left off.</span></span>
-   <span data-ttu-id="d6ef5-208">**Заключение запланированной раскадровки.**</span><span class="sxs-lookup"><span data-stu-id="d6ef5-208">**Conclude the scheduled storyboard.**</span></span> <span data-ttu-id="d6ef5-209">Раскадровка может быть выполнена только в том случае, если она содержит цикл, повторяемый неограниченное время.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-209">A storyboard may be concluded only if it contains a loop that repeats indefinitely.</span></span> <span data-ttu-id="d6ef5-210">Если раскадровка находится в таком цикле по завершении, текущее повторение завершается, а оставшаяся часть раскадровки воспроизводится.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-210">If the storyboard is in such a loop when concluded, the current repetition completes, and the remainder of the storyboard then plays.</span></span> <span data-ttu-id="d6ef5-211">Если цикл еще не начался при завершении раскадровки, цикл пропускается полностью.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-211">If the loop has not yet begun when a storyboard is concluded, the loop is skipped entirely.</span></span>
-   <span data-ttu-id="d6ef5-212">**Сжатие раскадровки по расписанию.**</span><span class="sxs-lookup"><span data-stu-id="d6ef5-212">**Compress the scheduled storyboard.**</span></span> <span data-ttu-id="d6ef5-213">Если усечение или отмена запланированной раскадровки не является параметром, раскадровка может быть завершена.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-213">If trimming or canceling the scheduled storyboard is not an option, the storyboard is allowed to complete.</span></span> <span data-ttu-id="d6ef5-214">В Windows Animation появилась возможность сжатия времени, доступного для запланированной раскадровки (и всех раскадровок, запланированных до него), поэтому переменные достигают их окончательное состояние быстрее.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-214">Windows Animation introduces the possibility of compressing the time available for the scheduled storyboard (and any storyboards scheduled before it), so the variables reach their final state more quickly.</span></span> <span data-ttu-id="d6ef5-215">При применении сжатия время временно ускоряется для затронутых раскадровок, поэтому они воспроизводятся быстрее.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-215">When compression is applied, time is temporarily accelerated for affected storyboards, so they play faster.</span></span>

<span data-ttu-id="d6ef5-216">Если ни одно из указанных выше действий не разрешено зарегистрированными объектами сравнения приоритетов, попытка запланировать новую раскадровку завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-216">If none of the above actions is allowed by the registered priority comparison objects, the attempt to schedule the new storyboard fails.</span></span> <span data-ttu-id="d6ef5-217">По умолчанию все раскадровки могут быть обрезаны, завершены или сжаты для предотвращения сбоев, но их нельзя отменить.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-217">By default, all storyboards can be trimmed, concluded, or compressed to prevent failure, but none can be canceled.</span></span>

<span data-ttu-id="d6ef5-218">На следующей диаграмме показан жизненный цикл раскадровки с использованием состояний, определенных в перечислении [**\_ \_ \_ состояния раскадровки анимации пользовательского интерфейса**](/windows/win32/api/uianimation/ne-uianimation-ui_animation_storyboard_status) .</span><span class="sxs-lookup"><span data-stu-id="d6ef5-218">The following diagram shows the life cycle of a storyboard, using the states defined by the [**UI\_ANIMATION\_STORYBOARD\_STATUS**](/windows/win32/api/uianimation/ne-uianimation-ui_animation_storyboard_status) enumeration.</span></span> <span data-ttu-id="d6ef5-219">Приложения используют API анимации Windows для создания раскадровки и их отправки для планирования.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-219">Applications use the Windows Animation API to build a storyboard and submit it for scheduling.</span></span> <span data-ttu-id="d6ef5-220">Диспетчер анимации планирует раскадровку и управляет анимацией.</span><span class="sxs-lookup"><span data-stu-id="d6ef5-220">The animation manager schedules the storyboard and manages the animation.</span></span>

![Схема, показывающая, как диспетчер анимации планирует раскадровку и управляет анимацией.](images/statediagram.png)

<span data-ttu-id="d6ef5-222">Дополнительные сведения о планировании и управлении раскадровкой см. в разделе [Общие сведения о раскадровке](storyboard-construction.md).</span><span class="sxs-lookup"><span data-stu-id="d6ef5-222">For more information on storyboard scheduling and management, see [Storyboard Overview](storyboard-construction.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d6ef5-223">См. также</span><span class="sxs-lookup"><span data-stu-id="d6ef5-223">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d6ef5-224">Справочник по анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-224">Windows Animation Reference</span></span>](windows-animation-reference.md)
</dt> <dt>

[<span data-ttu-id="d6ef5-225">Примеры анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-225">Windows Animation Samples</span></span>](windows-animation-samples.md)
</dt> <dt>

[<span data-ttu-id="d6ef5-226">Задачи анимации Windows</span><span class="sxs-lookup"><span data-stu-id="d6ef5-226">Windows Animation Tasks</span></span>](using-windows-animation.md)
</dt> </dl>

 

 