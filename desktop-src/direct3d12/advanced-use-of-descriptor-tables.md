---
title: Расширенное использование таблиц дескрипторов
description: В следующих разделах приводятся сведения о расширенном использовании таблиц дескрипторов.
ms.assetid: BB0CA29C-65CB-48B1-8351-EE13CC470B54
ms.date: 05/31/2018
ms.localizationpriority: high
ms.topic: article
ms.openlocfilehash: 79dad6914cff07726c2d40ed2ee27cccb6a0cf1e
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "74105025"
---
# <a name="advanced-use-of-descriptor-tables"></a><span data-ttu-id="ce776-103">Расширенное использование таблиц дескрипторов</span><span class="sxs-lookup"><span data-stu-id="ce776-103">Advanced use of Descriptor Tables</span></span>

<span data-ttu-id="ce776-104">В следующих разделах приводятся сведения о расширенном использовании таблиц дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="ce776-104">The following sections provide information about the advanced use of descriptor tables.</span></span>

-   [<span data-ttu-id="ce776-105">Изменение записей таблицы дескрипторов между вызовами отрисовки</span><span class="sxs-lookup"><span data-stu-id="ce776-105">Changing Descriptor Table Entries between Rendering Calls</span></span>](#changing-descriptor-table-entries-between-rendering-calls)
-   [<span data-ttu-id="ce776-106">Индексация вне границ</span><span class="sxs-lookup"><span data-stu-id="ce776-106">Out of Bounds Indexing</span></span>](#out-of-bounds-indexing)
-   [<span data-ttu-id="ce776-107">Производные шейдеры и разные индексы</span><span class="sxs-lookup"><span data-stu-id="ce776-107">Shader Derivatives and Divergent Indexing</span></span>](#shader-derivatives-and-divergent-indexing)
-   [<span data-ttu-id="ce776-108">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="ce776-108">Related topics</span></span>](#related-topics)

## <a name="changing-descriptor-table-entries-between-rendering-calls"></a><span data-ttu-id="ce776-109">Изменение записей таблицы дескрипторов между вызовами отрисовки</span><span class="sxs-lookup"><span data-stu-id="ce776-109">Changing Descriptor Table Entries between Rendering Calls</span></span>

<span data-ttu-id="ce776-110">После того как списки команд, которые задают таблицы дескрипторов, были отправлены в очередь для выполнения, приложение не должно отменять загрузку ЦП частями кучи дескрипторов, на которые может ссылаться графический процессор, до тех пор, пока приложению не известно, что GPU завершило использовать ссылки.</span><span class="sxs-lookup"><span data-stu-id="ce776-110">After command lists that set descriptor tables have been submitted to a queue for execution, the application must not edit from the CPU the portions of descriptor heaps that the GPU might reference until the application knows that the GPU has finished using the references.</span></span>

<span data-ttu-id="ce776-111">Завершение работы можно определить с помощью ограниченных границ, используя границы API для отслеживания хода выполнения GPU или более грубых механизмов, таких как ожидание, чтобы увидеть, что отрисовка была отправлена для отображения, что подходит для приложения.</span><span class="sxs-lookup"><span data-stu-id="ce776-111">Work completion can be determined at a tight bound using API fences for tracking GPU progress, or more coarse mechanisms like waiting to see that rendering has been sent to display - whatever suits the application.</span></span> <span data-ttu-id="ce776-112">Если приложение знает, что к нему будет обращаться только подмножество региона, к которому обращается таблица дескрипторов (скажем, из-за управления потоком в шейдере), другие дескрипторы без ссылок по-прежнему можно изменять.</span><span class="sxs-lookup"><span data-stu-id="ce776-112">If an application knows that only a subset of the region a descriptor table points to will be accessed (say due to flow control in the shader), the other unreferenced descriptors are still free to be changed.</span></span> <span data-ttu-id="ce776-113">Если приложению необходимо переключаться между разными таблицами дескрипторов между вызовами отрисовки, существует несколько подходов, которые может выбрать приложение.</span><span class="sxs-lookup"><span data-stu-id="ce776-113">If an application needs to switch between different descriptor tables between rendering calls, there are a few approaches the application can choose from:</span></span>

-   <span data-ttu-id="ce776-114">Управление версиями таблицы дескрипторов: создание (или повторное использование) отдельной таблицы дескрипторов для каждой уникальной коллекции описательов, на которые будет ссылаться список команд.</span><span class="sxs-lookup"><span data-stu-id="ce776-114">Descriptor Table Versioning: Create (or reuse) a separate descriptor table for every unique collection of descriptors that is to be referenced by a command list.</span></span> <span data-ttu-id="ce776-115">При редактировании и повторном использовании ранее заполненных областей в кучах дескрипторов приложения должны сначала убедиться, что GPU завершил использование любой части кучи дескрипторов, которая будет перезапущена.</span><span class="sxs-lookup"><span data-stu-id="ce776-115">When editing and reusing previously populated areas on descriptor heaps, applications must first ensure that the GPU has finished using any portion of a descriptor heap that will be recycled.</span></span>
-   <span data-ttu-id="ce776-116">Динамическое индексирование. приложения могут упорядочивать объекты, которые зависят от рисования или диспетчеризации (или даже могут изменяться в рамках рисования) в диапазоне кучи дескрипторов, определять таблицу дескрипторов, охватывающую все из них, и из шейдера использовать динамическую индексацию таблицы во время выполнения шейдера для выбора используемого объекта.</span><span class="sxs-lookup"><span data-stu-id="ce776-116">Dynamic Indexing: Applications can arrange objects that vary across draw/dispatch (or even vary within a draw) in a range of a descriptor heap, define a descriptor table that spans all of them, and from the shader, use dynamic indexing of the table during shader execution to select which object to use.</span></span>
-   <span data-ttu-id="ce776-117">Размещение дескрипторов в корневой подписи напрямую.</span><span class="sxs-lookup"><span data-stu-id="ce776-117">Putting descriptors in the root signature directly.</span></span> <span data-ttu-id="ce776-118">Таким образом можно управлять только очень небольшим числом дескрипторов, так как пространство корневых подписей ограничено.</span><span class="sxs-lookup"><span data-stu-id="ce776-118">Only a very small number of descriptors can be managed this way because root signature space is limited.</span></span>

<span data-ttu-id="ce776-119">Следствием использования управления версиями таблицы дескриптора является то, что память дескриптора из кучи дескрипторов должна быть записана с помощью каждого уникального набора дескрипторов, на которые ссылается графический конвейер, для каждого списка команд, который может быть выполнен, помещен в очередь на выполнение или записывается в любое заданное время.</span><span class="sxs-lookup"><span data-stu-id="ce776-119">The implication of using descriptor table versioning is that descriptor memory out of a descriptor heap must be burned through for every unique set of descriptors referenced by the graphics pipeline for every command list that could be either executing, queued for execution, or being recorded at any given time.</span></span>

<span data-ttu-id="ce776-120">D3D12 оставляет за собой ответственность за управление версиями в приложении для типов объектов, управляемых с помощью куч дескрипторов и таблиц дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="ce776-120">D3D12 leaves the responsibility of managing versioning to the application for the object types managed via descriptor heaps and descriptor tables.</span></span> <span data-ttu-id="ce776-121">Одно из преимуществ этого заключается в том, что приложения могут выбрать повторное использование содержимого таблицы дескрипторов как можно скорее, а не всегда определяя новую версию таблицы дескрипторов для каждого отправляемого списка команд.</span><span class="sxs-lookup"><span data-stu-id="ce776-121">One benefit of this is that applications can choose to reuse descriptor table contents as much as possible rather than always defining a new descriptor table version for every command list submission.</span></span> <span data-ttu-id="ce776-122">Корневая подпись — это пространство, которое драйвер D3D12 автоматически версии.</span><span class="sxs-lookup"><span data-stu-id="ce776-122">The root signature is a space that the D3D12 driver automatically versions.</span></span>

<span data-ttu-id="ce776-123">Возможность привязки нескольких таблиц дескрипторов к корневой подписи (и, таким образом, к конвейеру) за раз позволяет приложениям группировать и переключать наборы ссылок дескрипторов по различным частотам при необходимости.</span><span class="sxs-lookup"><span data-stu-id="ce776-123">The ability to bind multiple descriptor tables to the root signature (and thus to the pipeline) at a time allows applications to group and switch sets of descriptor references at different frequencies if desired.</span></span> <span data-ttu-id="ce776-124">Например, приложение может использовать небольшое число (возможно, только одно) больших статических таблиц дескрипторов, которые меняются редко или в каких регионах память кучи дескрипторов заполняется по мере необходимости, используя динамическое индексирование шейдера для выбора текстур.</span><span class="sxs-lookup"><span data-stu-id="ce776-124">For example, an application could use a small number (perhaps just one) of large static descriptor tables that rarely change, or in which regions in the underlying descriptor heap memory are being populated as needed, with the use of dynamic indexing from the shader to select textures.</span></span> <span data-ttu-id="ce776-125">В то же время приложение может поддерживать другой класс ресурсов, где набор, на который ссылается каждый вызов Draw, переключается из ЦП с помощью метода управления версиями таблиц дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="ce776-125">At the same time, the application could maintain another class of resources where the set referenced by each draw call is switched from the CPU using the descriptor table versioning technique.</span></span>

## <a name="out-of-bounds-indexing"></a><span data-ttu-id="ce776-126">Индексация вне границ</span><span class="sxs-lookup"><span data-stu-id="ce776-126">Out of Bounds Indexing</span></span>

<span data-ttu-id="ce776-127">Индексация недопустимых границ любой таблицы дескрипторов из шейдера приводит к значительному неопределенному доступу к памяти, включая возможность считывания произвольной памяти в процессе, как если бы это дескриптор состояния оборудования, и его работа с следствием аппаратного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="ce776-127">Out of bounds indexing of any descriptor table from the shader results in a largely undefined memory access, including the possibility of reading arbitrary in-process memory as if it is a hardware state descriptor and living with the consequence of what the hardware does with that.</span></span> <span data-ttu-id="ce776-128">Это может привести к сбросу устройства, но не приведет к сбою Windows.</span><span class="sxs-lookup"><span data-stu-id="ce776-128">This could produce a device reset, but will not crash Windows.</span></span>

## <a name="shader-derivatives-and-divergent-indexing"></a><span data-ttu-id="ce776-129">Производные шейдеры и разные индексы</span><span class="sxs-lookup"><span data-stu-id="ce776-129">Shader Derivatives and Divergent Indexing</span></span>

<span data-ttu-id="ce776-130">Если вызовы шейдера пикселей, которые выполняются в отметке 2x2 (для поддержки производных вычислений), выбирают разные индексы текстуры для выборки из таблицы дескрипторов, а если выбранная конфигурация и текстура для любого заданного пикселя требует вычисления Лод из производной координаты текстуры, то процесс вычисления Лод и выбор текстуры выполняется аппаратно независимо для каждого уточняющего запроса в формате 2x2. , что влияет на производительность.</span><span class="sxs-lookup"><span data-stu-id="ce776-130">If pixel shader invocations that are executing in a 2x2 stamp (to support derivative calculations) choose different texture indices to sample from out of a descriptor table, and if the selected sampler configuration and texture for any given pixel requires an LOD calculation from texture coordinate derivatives, then the LOD calculation and texture sampling process is done by the hardware independently for each texture lookup in the 2x2 stamp, which will impact performance.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ce776-131">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="ce776-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ce776-132">Таблицы дескрипторов</span><span class="sxs-lookup"><span data-stu-id="ce776-132">Descriptor Tables</span></span>](descriptor-tables.md)
</dt> </dl>

 

 




