---
description: Приложения могут управлять расположением, из которого загружается DLL, путем указания полного пути или использования другого механизма, например манифеста. Если эти методы не используются, система выполняет поиск библиотеки DLL во время загрузки, как описано в этом разделе.
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Порядок поиска библиотеки динамической компоновки (DLL)
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/04/2021
ms.locfileid: "104536401"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="cd58a-104">Порядок поиска библиотеки динамической компоновки (DLL)</span><span class="sxs-lookup"><span data-stu-id="cd58a-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="cd58a-105">Система может содержать несколько версий одной библиотеки динамической компоновки (DLL).</span><span class="sxs-lookup"><span data-stu-id="cd58a-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="cd58a-106">Приложения могут управлять расположением, из которого загружается DLL, путем указания полного пути или использования другого механизма, например манифеста.</span><span class="sxs-lookup"><span data-stu-id="cd58a-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="cd58a-107">Если эти методы не используются, система выполняет поиск библиотеки DLL во время загрузки, как описано в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="cd58a-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="cd58a-108">Факторы, влияющие на поиск</span><span class="sxs-lookup"><span data-stu-id="cd58a-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="cd58a-109">Порядок поиска для приложений UWP</span><span class="sxs-lookup"><span data-stu-id="cd58a-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="cd58a-110">Стандартный порядок поиска для приложений UWP</span><span class="sxs-lookup"><span data-stu-id="cd58a-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="cd58a-111">Альтернативный порядок поиска для приложений UWP</span><span class="sxs-lookup"><span data-stu-id="cd58a-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="cd58a-112">Порядок поиска для настольных приложений</span><span class="sxs-lookup"><span data-stu-id="cd58a-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="cd58a-113">Стандартный порядок поиска для настольных приложений</span><span class="sxs-lookup"><span data-stu-id="cd58a-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="cd58a-114">Альтернативный порядок поиска для настольных приложений</span><span class="sxs-lookup"><span data-stu-id="cd58a-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="cd58a-115">Порядок поиска с помощью флагов **\_ \_ поиска "загрузить библиотеку** "</span><span class="sxs-lookup"><span data-stu-id="cd58a-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="cd58a-116">См. также</span><span class="sxs-lookup"><span data-stu-id="cd58a-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="cd58a-117">Факторы, влияющие на поиск</span><span class="sxs-lookup"><span data-stu-id="cd58a-117">Factors That Affect Searching</span></span>

<span data-ttu-id="cd58a-118">На то, что система осуществляет поиск библиотеки DLL, влияют следующие факторы:</span><span class="sxs-lookup"><span data-stu-id="cd58a-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="cd58a-119">Если библиотека DLL с таким же именем модуля уже загружена в память, система проверяет только перенаправление и манифест перед разрешением в загруженную библиотеку DLL, независимо от того, в каком каталоге он находится.</span><span class="sxs-lookup"><span data-stu-id="cd58a-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="cd58a-120">Система не выполняет поиск библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="cd58a-121">Если библиотека DLL находится в списке известных библиотек DLL для версии Windows, в которой выполняется приложение, система использует свою копию известной библиотеки DLL (и зависимые библиотеки DLL, если они есть) вместо поиска библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="cd58a-122">Список известных библиотек DLL в текущей системе см. в следующем разделе реестра: **hKey \_ локальный \_ компьютер \\ System \\ CurrentControlSet \\ Control \\ Manager \\ кновндллс**.</span><span class="sxs-lookup"><span data-stu-id="cd58a-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="cd58a-123">Если библиотека DLL имеет зависимости, система выполняет поиск зависимых библиотек DLL, как если бы они загружались только с именами модулей.</span><span class="sxs-lookup"><span data-stu-id="cd58a-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="cd58a-124">Это справедливо, даже если первая библиотека DLL была загружена путем указания полного пути.</span><span class="sxs-lookup"><span data-stu-id="cd58a-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="cd58a-125">Порядок поиска для приложений UWP</span><span class="sxs-lookup"><span data-stu-id="cd58a-125">Search Order for UWP apps</span></span>

<span data-ttu-id="cd58a-126">Когда приложение UWP для Windows 10 (или приложение магазина для Windows 8. x) загружает упакованный модуль путем вызова функции [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) , Библиотека DLL должна находиться в графе зависимостей пакета процесса.</span><span class="sxs-lookup"><span data-stu-id="cd58a-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="cd58a-127">Дополнительные сведения см. в разделе **LoadPackagedLibrary**.</span><span class="sxs-lookup"><span data-stu-id="cd58a-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="cd58a-128">Когда приложение UWP загружает модуль другими способами и не указывает полный путь, система выполняет поиск библиотеки DLL и ее зависимостей во время загрузки, как описано в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="cd58a-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="cd58a-129">Прежде чем система будет искать библиотеку DLL, она проверяет следующее:</span><span class="sxs-lookup"><span data-stu-id="cd58a-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="cd58a-130">Если библиотека DLL с таким же именем модуля уже загружена в память, система использует загруженную библиотеку DLL независимо от того, в каком каталоге она находится.</span><span class="sxs-lookup"><span data-stu-id="cd58a-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="cd58a-131">Система не выполняет поиск библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="cd58a-132">Если библиотека DLL находится в списке известных библиотек DLL для версии Windows, в которой выполняется приложение, система использует свою копию известной библиотеки DLL (и зависимые от нее библиотеки DLL, если таковые имеются).</span><span class="sxs-lookup"><span data-stu-id="cd58a-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="cd58a-133">Система не выполняет поиск библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-133">The system does not search for the DLL.</span></span> <span data-ttu-id="cd58a-134">Список известных библиотек DLL в текущей системе см. в следующем разделе реестра: **hKey \_ локальный \_ компьютер \\ System \\ CurrentControlSet \\ Control \\ Manager \\ кновндллс**.</span><span class="sxs-lookup"><span data-stu-id="cd58a-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="cd58a-135">Если система должна искать модуль или его зависимости, она всегда использует порядок поиска для приложений UWP, даже если зависимость не является кодом приложения UWP.</span><span class="sxs-lookup"><span data-stu-id="cd58a-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="cd58a-136">Стандартный порядок поиска для приложений UWP</span><span class="sxs-lookup"><span data-stu-id="cd58a-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="cd58a-137">Если модуль еще не загружен или в списке известных библиотек DLL, система выполняет поиск в следующих расположениях в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="cd58a-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="cd58a-138">Граф зависимостей пакета для процесса.</span><span class="sxs-lookup"><span data-stu-id="cd58a-138">The package dependency graph of the process.</span></span> <span data-ttu-id="cd58a-139">Это пакет приложения, а также все зависимости, указанные как `<PackageDependency>` в `<Dependencies>` разделе манифеста пакета приложения.</span><span class="sxs-lookup"><span data-stu-id="cd58a-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="cd58a-140">Поиск зависимостей осуществляется в том порядке, в котором они отображаются в манифесте.</span><span class="sxs-lookup"><span data-stu-id="cd58a-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="cd58a-141">Каталог, из которого был загружен вызывающий процесс.</span><span class="sxs-lookup"><span data-stu-id="cd58a-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="cd58a-142">Системный каталог (% SystemRoot% \\ System32).</span><span class="sxs-lookup"><span data-stu-id="cd58a-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="cd58a-143">Если библиотека DLL имеет зависимости, система выполняет поиск зависимых библиотек DLL, как если бы они загружались только с именами модулей.</span><span class="sxs-lookup"><span data-stu-id="cd58a-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="cd58a-144">Это справедливо, даже если первая библиотека DLL была загружена путем указания полного пути.</span><span class="sxs-lookup"><span data-stu-id="cd58a-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="cd58a-145">Альтернативный порядок поиска для приложений UWP</span><span class="sxs-lookup"><span data-stu-id="cd58a-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="cd58a-146">Если модуль изменяет стандартный порядок поиска, вызывая функцию [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) с параметром **Load \_ с \_ измененным \_ \_ путем поиска**, система выполняет поиск в каталоге указанного модуля вместо каталога вызывающего процесса.</span><span class="sxs-lookup"><span data-stu-id="cd58a-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="cd58a-147">Система выполняет поиск в следующих расположениях в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="cd58a-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="cd58a-148">Граф зависимостей пакета для процесса.</span><span class="sxs-lookup"><span data-stu-id="cd58a-148">The package dependency graph of the process.</span></span> <span data-ttu-id="cd58a-149">Это пакет приложения, а также все зависимости, указанные как `<PackageDependency>` в `<Dependencies>` разделе манифеста пакета приложения.</span><span class="sxs-lookup"><span data-stu-id="cd58a-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="cd58a-150">Поиск зависимостей осуществляется в том порядке, в котором они отображаются в манифесте.</span><span class="sxs-lookup"><span data-stu-id="cd58a-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="cd58a-151">Каталог, из которого был загружен указанный модуль.</span><span class="sxs-lookup"><span data-stu-id="cd58a-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="cd58a-152">Системный каталог (% SystemRoot% \\ System32).</span><span class="sxs-lookup"><span data-stu-id="cd58a-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="cd58a-153">Порядок поиска для настольных приложений</span><span class="sxs-lookup"><span data-stu-id="cd58a-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="cd58a-154">Настольные приложения могут управлять расположением, из которого загружается DLL, путем указания полного пути, использования [перенаправления DLL](dynamic-link-library-redirection.md)или [манифеста](/windows/desktop/SbsCs/manifests).</span><span class="sxs-lookup"><span data-stu-id="cd58a-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="cd58a-155">Если ни один из этих методов не используется, система выполняет поиск библиотеки DLL во время загрузки, как описано в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="cd58a-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="cd58a-156">Прежде чем система будет искать библиотеку DLL, она проверяет следующее:</span><span class="sxs-lookup"><span data-stu-id="cd58a-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="cd58a-157">Если библиотека DLL с таким же именем модуля уже загружена в память, система использует загруженную библиотеку DLL независимо от того, в каком каталоге она находится.</span><span class="sxs-lookup"><span data-stu-id="cd58a-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="cd58a-158">Система не выполняет поиск библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="cd58a-159">Если библиотека DLL находится в списке известных библиотек DLL для версии Windows, в которой выполняется приложение, система использует свою копию известной библиотеки DLL (и зависимые от нее библиотеки DLL, если таковые имеются).</span><span class="sxs-lookup"><span data-stu-id="cd58a-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="cd58a-160">Система не выполняет поиск библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-160">The system does not search for the DLL.</span></span> <span data-ttu-id="cd58a-161">Список известных библиотек DLL в текущей системе см. в следующем разделе реестра: **hKey \_ локальный \_ компьютер \\ System \\ CurrentControlSet \\ Control \\ Manager \\ кновндллс**.</span><span class="sxs-lookup"><span data-stu-id="cd58a-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="cd58a-162">Если библиотека DLL имеет зависимости, система выполняет поиск зависимых библиотек DLL, как если бы они загружались только с именами модулей.</span><span class="sxs-lookup"><span data-stu-id="cd58a-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="cd58a-163">Это справедливо, даже если первая библиотека DLL была загружена путем указания полного пути.</span><span class="sxs-lookup"><span data-stu-id="cd58a-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cd58a-164">Если злоумышленник получает контроль над одним из каталогов, в котором выполняется поиск, он может поместить в этот каталог вредоносную копию библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="cd58a-165">Способы предотвращения таких атак см. в разделе [безопасность библиотеки динамической компоновки](dynamic-link-library-security.md).</span><span class="sxs-lookup"><span data-stu-id="cd58a-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="cd58a-166">Стандартный порядок поиска для настольных приложений</span><span class="sxs-lookup"><span data-stu-id="cd58a-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="cd58a-167">Стандартный порядок поиска библиотек DLL, используемый системой, зависит от того, включен или отключен режим поиска "Защищенная библиотека DLL".</span><span class="sxs-lookup"><span data-stu-id="cd58a-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="cd58a-168">Режим поиска в защищенных библиотеках DLL помещает текущий каталог пользователя в последующий порядок поиска.</span><span class="sxs-lookup"><span data-stu-id="cd58a-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="cd58a-169">Защищенный режим поиска DLL включен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="cd58a-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="cd58a-170">Чтобы отключить эту функцию, создайте параметр реестра **hKey \_ Local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Manager** \\ **сафедллсеарчмоде** и задайте для него значение 0.</span><span class="sxs-lookup"><span data-stu-id="cd58a-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="cd58a-171">Вызов функции [**сетдллдиректори**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) эффективно отключает **сафедллсеарчмоде** , пока указанный каталог находится в пути поиска и изменяет порядок поиска, как описано в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="cd58a-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="cd58a-172">Если **сафедллсеарчмоде** включен, порядок поиска выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cd58a-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="cd58a-173">Каталог, из которого загружено приложение.</span><span class="sxs-lookup"><span data-stu-id="cd58a-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="cd58a-174">Системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-174">The system directory.</span></span> <span data-ttu-id="cd58a-175">Чтобы получить путь к этому каталогу, используйте функцию [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="cd58a-176">16-разрядный системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-176">The 16-bit system directory.</span></span> <span data-ttu-id="cd58a-177">Отсутствует функция, которая получает путь к этому каталогу, но ищет его.</span><span class="sxs-lookup"><span data-stu-id="cd58a-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="cd58a-178">Каталог Windows.</span><span class="sxs-lookup"><span data-stu-id="cd58a-178">The Windows directory.</span></span> <span data-ttu-id="cd58a-179">Чтобы получить путь к этому каталогу, используйте функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="cd58a-180">Текущий каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-180">The current directory.</span></span>
6.  <span data-ttu-id="cd58a-181">Каталоги, перечисленные в переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="cd58a-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cd58a-182">Обратите внимание, что сюда не входит путь для каждого приложения, указанный в разделе реестра **пути к** приложению.</span><span class="sxs-lookup"><span data-stu-id="cd58a-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cd58a-183">Ключ **путей приложений** не используется при вычислении пути поиска DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cd58a-184">Если **сафедллсеарчмоде** отключен, то порядок поиска выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cd58a-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="cd58a-185">Каталог, из которого загружено приложение.</span><span class="sxs-lookup"><span data-stu-id="cd58a-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="cd58a-186">Текущий каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-186">The current directory.</span></span>
3.  <span data-ttu-id="cd58a-187">Системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-187">The system directory.</span></span> <span data-ttu-id="cd58a-188">Чтобы получить путь к этому каталогу, используйте функцию [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="cd58a-189">16-разрядный системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-189">The 16-bit system directory.</span></span> <span data-ttu-id="cd58a-190">Отсутствует функция, которая получает путь к этому каталогу, но ищет его.</span><span class="sxs-lookup"><span data-stu-id="cd58a-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="cd58a-191">Каталог Windows.</span><span class="sxs-lookup"><span data-stu-id="cd58a-191">The Windows directory.</span></span> <span data-ttu-id="cd58a-192">Чтобы получить путь к этому каталогу, используйте функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="cd58a-193">Каталоги, перечисленные в переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="cd58a-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cd58a-194">Обратите внимание, что сюда не входит путь для каждого приложения, указанный в разделе реестра **пути к** приложению.</span><span class="sxs-lookup"><span data-stu-id="cd58a-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cd58a-195">Ключ **путей приложений** не используется при вычислении пути поиска DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="cd58a-196">Альтернативный порядок поиска для настольных приложений</span><span class="sxs-lookup"><span data-stu-id="cd58a-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="cd58a-197">Стандартный порядок поиска, используемый системой, можно изменить, вызвав функцию [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) с параметром **Load \_ с \_ измененным \_ \_ путем поиска**.</span><span class="sxs-lookup"><span data-stu-id="cd58a-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="cd58a-198">Стандартный порядок поиска также можно изменить, вызвав функцию [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="cd58a-199">Стандартный порядок поиска процесса также будет зависеть от вызова функции [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) в родительском процессе перед началом текущего процесса.</span><span class="sxs-lookup"><span data-stu-id="cd58a-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="cd58a-200">Если указать альтернативную стратегию поиска, ее поведение будет продолжаться до тех пор, пока не будут найдены все связанные исполняемые модули.</span><span class="sxs-lookup"><span data-stu-id="cd58a-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="cd58a-201">После того как система начнет обработку подпрограмм инициализации DLL, система вернется к стандартной стратегии поиска.</span><span class="sxs-lookup"><span data-stu-id="cd58a-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="cd58a-202">Функция [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) поддерживает альтернативный порядок поиска, если вызов указывает **загрузку \_ с \_ измененным \_ \_ путем поиска** , а параметр *лпфиленаме* указывает абсолютный путь.</span><span class="sxs-lookup"><span data-stu-id="cd58a-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="cd58a-203">Обратите внимание, что стандартная стратегия поиска и альтернативная стратегия поиска, заданная параметром [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) с **\_ путем загрузки с \_ измененным \_ \_ путем поиска** , отличаются только одним способом: Стандартный поиск начинается в каталоге вызывающего приложения, а альтернативный Поиск начинается в каталоге исполняемого модуля, который загружает **LoadLibraryEx** .</span><span class="sxs-lookup"><span data-stu-id="cd58a-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="cd58a-204">Если **сафедллсеарчмоде** включен, альтернативный порядок поиска выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cd58a-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="cd58a-205">Каталог, заданный параметром *лпфиленаме*.</span><span class="sxs-lookup"><span data-stu-id="cd58a-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="cd58a-206">Системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-206">The system directory.</span></span> <span data-ttu-id="cd58a-207">Чтобы получить путь к этому каталогу, используйте функцию [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="cd58a-208">16-разрядный системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-208">The 16-bit system directory.</span></span> <span data-ttu-id="cd58a-209">Отсутствует функция, которая получает путь к этому каталогу, но ищет его.</span><span class="sxs-lookup"><span data-stu-id="cd58a-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="cd58a-210">Каталог Windows.</span><span class="sxs-lookup"><span data-stu-id="cd58a-210">The Windows directory.</span></span> <span data-ttu-id="cd58a-211">Чтобы получить путь к этому каталогу, используйте функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="cd58a-212">Текущий каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-212">The current directory.</span></span>
6.  <span data-ttu-id="cd58a-213">Каталоги, перечисленные в переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="cd58a-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cd58a-214">Обратите внимание, что сюда не входит путь для каждого приложения, указанный в разделе реестра **пути к** приложению.</span><span class="sxs-lookup"><span data-stu-id="cd58a-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cd58a-215">Ключ **путей приложений** не используется при вычислении пути поиска DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cd58a-216">Если **сафедллсеарчмоде** отключен, альтернативный порядок поиска выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cd58a-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="cd58a-217">Каталог, заданный параметром *лпфиленаме*.</span><span class="sxs-lookup"><span data-stu-id="cd58a-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="cd58a-218">Текущий каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-218">The current directory.</span></span>
3.  <span data-ttu-id="cd58a-219">Системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-219">The system directory.</span></span> <span data-ttu-id="cd58a-220">Чтобы получить путь к этому каталогу, используйте функцию [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="cd58a-221">16-разрядный системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-221">The 16-bit system directory.</span></span> <span data-ttu-id="cd58a-222">Отсутствует функция, которая получает путь к этому каталогу, но ищет его.</span><span class="sxs-lookup"><span data-stu-id="cd58a-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="cd58a-223">Каталог Windows.</span><span class="sxs-lookup"><span data-stu-id="cd58a-223">The Windows directory.</span></span> <span data-ttu-id="cd58a-224">Чтобы получить путь к этому каталогу, используйте функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="cd58a-225">Каталоги, перечисленные в переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="cd58a-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cd58a-226">Обратите внимание, что сюда не входит путь для каждого приложения, указанный в разделе реестра **пути к** приложению.</span><span class="sxs-lookup"><span data-stu-id="cd58a-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cd58a-227">Ключ **путей приложений** не используется при вычислении пути поиска DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cd58a-228">Функция [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) поддерживает альтернативный порядок поиска, если параметр *лппаснаме* задает путь.</span><span class="sxs-lookup"><span data-stu-id="cd58a-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="cd58a-229">Альтернативный порядок поиска выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="cd58a-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="cd58a-230">Каталог, из которого загружено приложение.</span><span class="sxs-lookup"><span data-stu-id="cd58a-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="cd58a-231">Каталог, указанный параметром *лппаснаме* параметра [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span><span class="sxs-lookup"><span data-stu-id="cd58a-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="cd58a-232">Системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-232">The system directory.</span></span> <span data-ttu-id="cd58a-233">Чтобы получить путь к этому каталогу, используйте функцию [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="cd58a-234">Имя этого каталога — System32.</span><span class="sxs-lookup"><span data-stu-id="cd58a-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="cd58a-235">16-разрядный системный каталог.</span><span class="sxs-lookup"><span data-stu-id="cd58a-235">The 16-bit system directory.</span></span> <span data-ttu-id="cd58a-236">Отсутствует функция, которая получает путь к этому каталогу, но ищет его.</span><span class="sxs-lookup"><span data-stu-id="cd58a-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="cd58a-237">Имя этого каталога — System.</span><span class="sxs-lookup"><span data-stu-id="cd58a-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="cd58a-238">Каталог Windows.</span><span class="sxs-lookup"><span data-stu-id="cd58a-238">The Windows directory.</span></span> <span data-ttu-id="cd58a-239">Чтобы получить путь к этому каталогу, используйте функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="cd58a-240">Каталоги, перечисленные в переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="cd58a-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cd58a-241">Обратите внимание, что сюда не входит путь для каждого приложения, указанный в разделе реестра **пути к** приложению.</span><span class="sxs-lookup"><span data-stu-id="cd58a-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cd58a-242">Ключ **путей приложений** не используется при вычислении пути поиска DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cd58a-243">Если параметр *лппаснаме* является пустой строкой, вызов удаляет текущий каталог из порядка поиска.</span><span class="sxs-lookup"><span data-stu-id="cd58a-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="cd58a-244">[**Сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) эффективно отключает режим поиска в защищенных библиотеках DLL, пока указанный каталог находится в пути поиска.</span><span class="sxs-lookup"><span data-stu-id="cd58a-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="cd58a-245">Чтобы восстановить защищенный режим поиска DLL на основе значения реестра **сафедллсеарчмоде** и восстановить текущий каталог в порядке поиска, вызовите **сетдллдиректори** с *лппаснаме* как null.</span><span class="sxs-lookup"><span data-stu-id="cd58a-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="cd58a-246">Порядок поиска с помощью флагов **\_ \_ поиска "загрузить библиотеку** "</span><span class="sxs-lookup"><span data-stu-id="cd58a-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="cd58a-247">Приложение может указать порядок поиска, используя один или несколько флагов **\_ \_ поиска в библиотеке загрузки** с помощью функции [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="cd58a-248">Приложение также может использовать флаги **\_ \_ поиска библиотеки Load** с функцией [**сетдефаултдллдиректориес**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) , чтобы установить порядок поиска библиотек DLL для процесса.</span><span class="sxs-lookup"><span data-stu-id="cd58a-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="cd58a-249">Приложение может указать дополнительные каталоги для порядка поиска DLL процесса с помощью функций [**адддллдиректори**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) или [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="cd58a-250">Искомые каталоги зависят от флагов, указанных в [**сетдефаултдллдиректориес**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) или [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="cd58a-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="cd58a-251">Если используется более одного флага, поиск соответствующих каталогов выполняется в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="cd58a-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="cd58a-252">Каталог, содержащий библиотеку DLL (**Загрузка \_ библиотеки \_ DLL поиска \_ \_ \_ по библиотеке** Load).</span><span class="sxs-lookup"><span data-stu-id="cd58a-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="cd58a-253">Этот каталог ищет только зависимости загружаемой библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="cd58a-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="cd58a-254">Каталог приложения (**Загрузка \_ библиотеки поиск \_ каталога \_ приложения \_**).</span><span class="sxs-lookup"><span data-stu-id="cd58a-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="cd58a-255">Пути, явно добавленные с помощью функции [**адддллдиректори**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) (**Загрузка \_ библиотеки \_ Поиск \_ пользователя \_ dirs**) или функции [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cd58a-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="cd58a-256">Если добавлен более одного пути, порядок поиска путей не определен.</span><span class="sxs-lookup"><span data-stu-id="cd58a-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="cd58a-257">Системный каталог (**загрузить \_ библиотеку \_ поиска \_ system32**).</span><span class="sxs-lookup"><span data-stu-id="cd58a-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="cd58a-258">Если приложение не вызывает [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) с любыми флагами **\_ \_ поиска в библиотеке нагрузки** или не устанавливает порядок поиска DLL для процесса, система выполняет поиск библиотек DLL, используя стандартный или альтернативный порядок поиска.</span><span class="sxs-lookup"><span data-stu-id="cd58a-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cd58a-259">См. также</span><span class="sxs-lookup"><span data-stu-id="cd58a-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cd58a-260">**адддллдиректори**</span><span class="sxs-lookup"><span data-stu-id="cd58a-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="cd58a-261">Регистрация приложения</span><span class="sxs-lookup"><span data-stu-id="cd58a-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="cd58a-262">Перенаправление библиотек динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="cd58a-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="cd58a-263">Безопасность библиотеки динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="cd58a-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="cd58a-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="cd58a-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="cd58a-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="cd58a-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="cd58a-266">**LoadPackagedLibrary**</span><span class="sxs-lookup"><span data-stu-id="cd58a-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="cd58a-267">**сетдефаултдллдиректориес**</span><span class="sxs-lookup"><span data-stu-id="cd58a-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="cd58a-268">**сетдллдиректори**</span><span class="sxs-lookup"><span data-stu-id="cd58a-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="cd58a-269">Параллельные компоненты</span><span class="sxs-lookup"><span data-stu-id="cd58a-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 