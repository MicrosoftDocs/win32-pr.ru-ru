---
description: Когда приложение динамически загружает библиотеку динамической компоновки без указания полного имени пути, Windows пытается найти библиотеку DLL, выполняя поиск четко определенного набора каталогов в определенном порядке, как описано в Dynamic-Link порядке поиска библиотек. Если злоумышленник получает контроль над одним из каталогов в пути поиска DLL, он может поместить в этот каталог вредоносную копию библиотеки DLL. Это иногда называется атакой с предварительной загрузкой DLL или двоичной плантинг атакой.
ms.assetid: 9493F299-789D-4CBC-9822-96EEAE39B494
title: Безопасность библиотеки Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4016139762461784702ac0190c1ee65d8bc6e72d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664443"
---
# <a name="dynamic-link-library-security"></a><span data-ttu-id="7f8fb-105">Безопасность библиотеки Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="7f8fb-105">Dynamic-Link Library Security</span></span>

<span data-ttu-id="7f8fb-106">Когда приложение динамически загружает библиотеку динамической компоновки без указания полного имени пути, Windows пытается найти библиотеку DLL, выполняя поиск четко определенного набора каталогов в определенном порядке, как описано в статье [Порядок поиска библиотек динамической компоновки](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="7f8fb-106">When an application dynamically loads a dynamic-link library without specifying a fully qualified path name, Windows attempts to locate the DLL by searching a well-defined set of directories in a particular order, as described in [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span> <span data-ttu-id="7f8fb-107">Если злоумышленник получает контроль над одним из каталогов в пути поиска DLL, он может поместить в этот каталог вредоносную копию библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-107">If an attacker gains control of one of the directories on the DLL search path, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="7f8fb-108">Это иногда называется *атакой с предварительной загрузкой DLL* или *двоичной плантинг атакой*.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-108">This is sometimes called a *DLL preloading attack* or a *binary planting attack*.</span></span> <span data-ttu-id="7f8fb-109">Если система не найдет легальную копию библиотеки DLL до того, как будет выполнен поиск скомпрометированного каталога, он загружает вредоносную библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-109">If the system does not find a legitimate copy of the DLL before it searches the compromised directory, it loads the malicious DLL.</span></span> <span data-ttu-id="7f8fb-110">Если приложение выполняется с правами администратора, злоумышленник может выполнить его в случае несанкционированного использования локальных привилегий.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-110">If the application is running with administrator privileges, the attacker may succeed in local privilege elevation.</span></span>

<span data-ttu-id="7f8fb-111">Например, предположим, что приложение предназначено для загрузки библиотеки DLL из текущего каталога пользователя и корректно завершает работу, если библиотека DLL не найдена.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-111">For example, suppose an application is designed to load a DLL from the user's current directory and fail gracefully if the DLL is not found.</span></span> <span data-ttu-id="7f8fb-112">Приложение вызывает [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) только с именем библиотеки DLL, что приводит к тому, что система ищет библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-112">The application calls [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) with just the name of the DLL, which causes the system to search for the DLL.</span></span> <span data-ttu-id="7f8fb-113">Если включен режим поиска безопасного DLL и приложение не использует альтернативный порядок поиска, система выполняет поиск в каталогах в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="7f8fb-113">Assuming safe DLL search mode is enabled and the application is not using an alternate search order, the system searches directories in the following order:</span></span>

1.  <span data-ttu-id="7f8fb-114">Каталог, из которого загружено приложение.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-114">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="7f8fb-115">Системный каталог.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-115">The system directory.</span></span>
3.  <span data-ttu-id="7f8fb-116">16-разрядный системный каталог.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-116">The 16-bit system directory.</span></span>
4.  <span data-ttu-id="7f8fb-117">Каталог Windows.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-117">The Windows directory.</span></span>
5.  <span data-ttu-id="7f8fb-118">Текущий каталог.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-118">The current directory.</span></span>
6.  <span data-ttu-id="7f8fb-119">Каталоги, перечисленные в переменной среды PATH.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-119">The directories that are listed in the PATH environment variable.</span></span>

<span data-ttu-id="7f8fb-120">Продолжая пример, злоумышленник с знанием приложения получает контроль над текущим каталогом и помещает вредоносную копию библиотеки DLL в этот каталог.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-120">Continuing the example, an attacker with knowledge of the application gains control of the current directory and places a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="7f8fb-121">Когда приложение выдает вызов **LoadLibrary** , система выполняет поиск библиотеки DLL, находит вредоносную копию библиотеки DLL в текущем каталоге и загружает ее.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-121">When the application issues the **LoadLibrary** call, the system searches for the DLL, finds the malicious copy of the DLL in the current directory, and loads it.</span></span> <span data-ttu-id="7f8fb-122">Затем вредоносная копия библиотеки DLL запускается в приложении и получает права доступа пользователя.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-122">The malicious copy of the DLL then runs within the application and gains the privileges of the user.</span></span>

<span data-ttu-id="7f8fb-123">С помощью следующих рекомендаций разработчики могут защитить свои приложения от атак с предварительной загрузкой библиотек DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-123">Developers can help safeguard their applications against DLL preloading attacks by following these guidelines:</span></span>

-   <span data-ttu-id="7f8fb-124">Везде, где это возможно, укажите полный путь при использовании функций [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)или [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="7f8fb-124">Wherever possible, specify a fully qualified path when using the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), or [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) functions.</span></span>
-   <span data-ttu-id="7f8fb-125">Используйте \_ \_ Флаги поиска в библиотеке Load с [**функцией LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) или используйте эти флаги вместе с функцией [**сетдефаултдллдиректориес**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) , чтобы установить порядок поиска DLL для процесса, а затем используйте функции [**адддллдиректори**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) или [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) для изменения списка.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-125">Use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="7f8fb-126">Дополнительные сведения см. в статье [Порядок поиска библиотек динамической компоновки](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="7f8fb-126">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>

    <span data-ttu-id="7f8fb-127">**Windows 7, Windows server 2008 R2, Windows Vista и Windows server 2008:** Эти флаги и функции доступны в системах с установленным [KB2533623](https://support.microsoft.com/kb/2533623) .</span><span class="sxs-lookup"><span data-stu-id="7f8fb-127">**Windows 7, Windows Server 2008 R2, Windows Vista and Windows Server 2008:** These flags and functions are available on systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed.</span></span>

-   <span data-ttu-id="7f8fb-128">В системах с установленным [KB2533623](https://support.microsoft.com/kb/2533623) используйте \_ \_ Флаги поиска в библиотеке Load с функцией [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) или используйте эти флаги вместе с функцией [**сетдефаултдллдиректориес**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) , чтобы установить порядок поиска DLL для процесса, а затем используйте функции [**адддллдиректори**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) или [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) для изменения списка.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-128">On systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed, use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="7f8fb-129">Дополнительные сведения см. в статье [Порядок поиска библиотек динамической компоновки](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="7f8fb-129">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="7f8fb-130">Рассмотрите возможность использования [перенаправления DLL](dynamic-link-library-redirection.md) или [манифеста](/windows/desktop/SbsCs/manifests) , чтобы убедиться, что приложение использует правильную библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-130">Consider using [DLL redirection](dynamic-link-library-redirection.md) or a [manifest](/windows/desktop/SbsCs/manifests) to ensure that your application uses the correct DLL.</span></span>
-   <span data-ttu-id="7f8fb-131">При использовании стандартного порядка поиска убедитесь, что включен режим поиска "защищенные библиотеки DLL".</span><span class="sxs-lookup"><span data-stu-id="7f8fb-131">When using the standard search order, make sure that safe DLL search mode is enabled.</span></span> <span data-ttu-id="7f8fb-132">В этом случае текущий каталог пользователя помещается позже в порядок поиска, что повышает вероятность того, что Windows найдет законную копию библиотеки DLL перед вредоносной копией.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-132">This places the user's current directory later in the search order, increasing the chances that Windows will find a legitimate copy of the DLL before a malicious copy.</span></span> <span data-ttu-id="7f8fb-133">Режим поиска в защищенных библиотеках DLL включен по умолчанию, начиная с Windows XP с пакетом обновления 2 (SP2), и управляется параметром реестра **hKey \_ Local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Manager** \\ **сафедллсеарчмоде** .</span><span class="sxs-lookup"><span data-stu-id="7f8fb-133">Safe DLL search mode is enabled by default starting with Windows XP with Service Pack 2 (SP2) and is controlled by the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value.</span></span> <span data-ttu-id="7f8fb-134">Дополнительные сведения см. в статье [Порядок поиска библиотек динамической компоновки](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="7f8fb-134">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="7f8fb-135">Рекомендуется удалить текущий каталог из стандартного пути поиска, вызвав [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) с пустой строкой ("").</span><span class="sxs-lookup"><span data-stu-id="7f8fb-135">Consider removing the current directory from the standard search path by calling [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) with an empty string ("").</span></span> <span data-ttu-id="7f8fb-136">Это необходимо сделать на раннем этапе инициализации процесса, а не до и после вызовов [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span><span class="sxs-lookup"><span data-stu-id="7f8fb-136">This should be done once early in process initialization, not before and after calls to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span></span> <span data-ttu-id="7f8fb-137">Имейте в виду, что **сетдллдиректори** влияет на весь процесс, и что несколько потоков, вызывающих **сетдллдиректори** с разными значениями, могут вызвать неопределенное поведение.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-137">Be aware that **SetDllDirectory** affects the entire process and that multiple threads calling **SetDllDirectory** with different values can cause undefined behavior.</span></span> <span data-ttu-id="7f8fb-138">Если приложение загружает сторонние библиотеки DLL, тщательно протестируйте их, чтобы определить любые несовместимости.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-138">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="7f8fb-139">Не используйте функцию [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) для получения пути к библиотеке DLL для последующего вызова [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) , если не включен режим поиска безопасного процесса.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-139">Do not use the [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) function to retrieve a path to a DLL for a subsequent [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call unless safe process search mode is enabled.</span></span> <span data-ttu-id="7f8fb-140">Если режим безопасного поиска процессов не включен, функция **SearchPath** использует разный порядок поиска, чем **LoadLibrary** , и, скорее всего, сначала выполняет поиск указанной библиотеки DLL в текущем каталоге пользователя.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-140">When safe process search mode is not enabled, the **SearchPath** function uses a different search order than **LoadLibrary** and is likely to first search the user's current directory for the specified DLL.</span></span> <span data-ttu-id="7f8fb-141">Чтобы включить режим поиска безопасного процесса для функции **SearchPath** , используйте функцию [**сетсеарчпасмоде**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) с базовым \_ путем поиска \_ , \_ включив \_ Сейф \_ SEARCHMODE.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-141">To enable safe process search mode for the **SearchPath** function, use the [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) function with BASE\_SEARCH\_PATH\_ENABLE\_SAFE\_SEARCHMODE.</span></span> <span data-ttu-id="7f8fb-142">При этом текущий каталог перемещается в конец списка поиска **SearchPath** в течение жизненного цикла процесса.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-142">This moves the current directory to the end of the **SearchPath** search list for the life of the process.</span></span> <span data-ttu-id="7f8fb-143">Обратите внимание, что текущий каталог не удаляется из пути поиска, поэтому если система не найдет легальную копию библиотеки DLL до того, как она достигнет текущего каталога, приложение остается уязвимым.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-143">Note that the current directory is not removed from the search path, so if the system does not find a legitimate copy of the DLL before it reaches the current directory, the application is still vulnerable.</span></span> <span data-ttu-id="7f8fb-144">Как и в случае с [**сетдллдиректори**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), вызов **сетсеарчпасмоде** должен выполняться на раннем этапе инициализации процесса и влияет на весь процесс.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-144">As with [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), calling **SetSearchPathMode** should be done early in process initialization and it affects the entire process.</span></span> <span data-ttu-id="7f8fb-145">Если приложение загружает сторонние библиотеки DLL, тщательно протестируйте их, чтобы определить любые несовместимости.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-145">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="7f8fb-146">Не следует делать предположения о версии операционной системы на основе вызова [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) , выполняющего поиск библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-146">Do not make assumptions about the operating system version based on a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call that searches for a DLL.</span></span> <span data-ttu-id="7f8fb-147">Если приложение выполняется в среде, в которой библиотека DLL является действительной, но в пути поиска находится вредоносная копия библиотеки DLL, может быть загружена вредоносная копия библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-147">If the application is running in an environment where the DLL is legitimately not present but a malicious copy of the DLL is in the search path, the malicious copy of the DLL may be loaded.</span></span> <span data-ttu-id="7f8fb-148">Вместо этого используйте Рекомендуемые методы, описанные в статье [получение системной версии](/windows/desktop/SysInfo/getting-the-system-version).</span><span class="sxs-lookup"><span data-stu-id="7f8fb-148">Instead, use the recommended techniques described in [Getting the System Version](/windows/desktop/SysInfo/getting-the-system-version).</span></span>

<span data-ttu-id="7f8fb-149">С помощью средства "монитор процессов" можно определить, какие операции загрузки DLL могут быть уязвимыми.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-149">The Process Monitor tool can be used to help identify DLL load operations that might be vulnerable.</span></span> <span data-ttu-id="7f8fb-150">Средство "монитор процессов" можно скачать из <https://technet.microsoft.com/sysinternals/bb896645.aspx> .</span><span class="sxs-lookup"><span data-stu-id="7f8fb-150">The Process Monitor tool can be downloaded from <https://technet.microsoft.com/sysinternals/bb896645.aspx>.</span></span>

<span data-ttu-id="7f8fb-151">В следующей процедуре описывается использование монитора обработки для проверки операций загрузки библиотек DLL в приложении.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-151">The following procedure describes how to use Process Monitor to examine DLL load operations in your application.</span></span>

<span data-ttu-id="7f8fb-152">**Использование монитора процессов для проверки операций загрузки DLL в приложении**</span><span class="sxs-lookup"><span data-stu-id="7f8fb-152">**To use Process Monitor to examine DLL load operations in your application**</span></span>

1.  <span data-ttu-id="7f8fb-153">Запустите монитор процесса.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-153">Start Process Monitor.</span></span>
2.  <span data-ttu-id="7f8fb-154">В мониторе процессов включите следующие фильтры:</span><span class="sxs-lookup"><span data-stu-id="7f8fb-154">In Process Monitor, include the following filters:</span></span>
    -   <span data-ttu-id="7f8fb-155">Операция является CreateFile</span><span class="sxs-lookup"><span data-stu-id="7f8fb-155">Operation is CreateFile</span></span>
    -   <span data-ttu-id="7f8fb-156">Операция — Лоадимаже</span><span class="sxs-lookup"><span data-stu-id="7f8fb-156">Operation is LoadImage</span></span>
    -   <span data-ttu-id="7f8fb-157">Путь содержит. cpl</span><span class="sxs-lookup"><span data-stu-id="7f8fb-157">Path contains .cpl</span></span>
    -   <span data-ttu-id="7f8fb-158">Путь содержит DLL-файл</span><span class="sxs-lookup"><span data-stu-id="7f8fb-158">Path contains .dll</span></span>
    -   <span data-ttu-id="7f8fb-159">Путь содержит. drv</span><span class="sxs-lookup"><span data-stu-id="7f8fb-159">Path contains .drv</span></span>
    -   <span data-ttu-id="7f8fb-160">Путь содержит. exe</span><span class="sxs-lookup"><span data-stu-id="7f8fb-160">Path contains .exe</span></span>
    -   <span data-ttu-id="7f8fb-161">Путь содержит. ocx</span><span class="sxs-lookup"><span data-stu-id="7f8fb-161">Path contains .ocx</span></span>
    -   <span data-ttu-id="7f8fb-162">Путь содержит. SCR</span><span class="sxs-lookup"><span data-stu-id="7f8fb-162">Path contains .scr</span></span>
    -   <span data-ttu-id="7f8fb-163">Путь содержит. sys</span><span class="sxs-lookup"><span data-stu-id="7f8fb-163">Path contains .sys</span></span>
3.  <span data-ttu-id="7f8fb-164">Исключите следующие фильтры:</span><span class="sxs-lookup"><span data-stu-id="7f8fb-164">Exclude the following filters:</span></span>
    -   <span data-ttu-id="7f8fb-165">Имя процесса — procmon.exe</span><span class="sxs-lookup"><span data-stu-id="7f8fb-165">Process Name is procmon.exe</span></span>
    -   <span data-ttu-id="7f8fb-166">Имя процесса — Procmon64.exe</span><span class="sxs-lookup"><span data-stu-id="7f8fb-166">Process Name is Procmon64.exe</span></span>
    -   <span data-ttu-id="7f8fb-167">Имя процесса — System</span><span class="sxs-lookup"><span data-stu-id="7f8fb-167">Process Name is System</span></span>
    -   <span data-ttu-id="7f8fb-168">Операция начинается с IRP \_ MJ\_</span><span class="sxs-lookup"><span data-stu-id="7f8fb-168">Operation begins with IRP\_MJ\_</span></span>
    -   <span data-ttu-id="7f8fb-169">Операция начинается с ФАСТИО\_</span><span class="sxs-lookup"><span data-stu-id="7f8fb-169">Operation begins with FASTIO\_</span></span>
    -   <span data-ttu-id="7f8fb-170">Результат успешно выполнен</span><span class="sxs-lookup"><span data-stu-id="7f8fb-170">Result is SUCCESS</span></span>
    -   <span data-ttu-id="7f8fb-171">Путь заканчивается на pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="7f8fb-171">Path ends with pagefile.sys</span></span>
4.  <span data-ttu-id="7f8fb-172">Попытка запуска приложения с текущим каталогом, установленным в определенном каталоге.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-172">Attempt to start your application with the current directory set to a specific directory.</span></span> <span data-ttu-id="7f8fb-173">Например, дважды щелкните файл с расширением, обработчиком файлов которого назначено ваше приложение.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-173">For example, double-click a file with an extension whose file handler is assigned to your application.</span></span>
5.  <span data-ttu-id="7f8fb-174">Проверьте выходные данные монитора обработки для путей, которые выглядят подозрительно, например, вызов текущего каталога для загрузки библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-174">Check Process Monitor output for paths that look suspicious, such as a call to the current directory to load a DLL.</span></span> <span data-ttu-id="7f8fb-175">Этот тип вызова может указывать на уязвимость в приложении.</span><span class="sxs-lookup"><span data-stu-id="7f8fb-175">This kind of call might indicate a vulnerability in your application.</span></span>

 

 
