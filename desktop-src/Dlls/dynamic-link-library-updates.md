---
description: Иногда требуется заменить библиотеку DLL новой версией.
ms.assetid: 82349a33-dc2c-4309-b0fc-890f230e3f2c
title: Обновления библиотеки Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a10f76103ddebc723466fb7e32a216c0c039691d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104080425"
---
# <a name="dynamic-link-library-updates"></a><span data-ttu-id="d2f24-103">Обновления библиотеки Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="d2f24-103">Dynamic-Link Library Updates</span></span>

<span data-ttu-id="d2f24-104">Иногда требуется заменить библиотеку DLL новой версией.</span><span class="sxs-lookup"><span data-stu-id="d2f24-104">It is sometimes necessary to replace a DLL with a newer version.</span></span> <span data-ttu-id="d2f24-105">Прежде чем заменить библиотеку DLL, выполните проверку версии, чтобы убедиться, что вы заменяете более старую версию новой версией.</span><span class="sxs-lookup"><span data-stu-id="d2f24-105">Before replacing a DLL, perform a version check to ensure that you are replacing an older version with a newer version.</span></span> <span data-ttu-id="d2f24-106">Можно заменить используемую библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-106">It is possible to replace a DLL that is in use.</span></span> <span data-ttu-id="d2f24-107">Метод, используемый для замены используемых библиотек DLL, зависит от используемой операционной системы.</span><span class="sxs-lookup"><span data-stu-id="d2f24-107">The method you use to replace DLLs that are in use depends on the operating system you are using.</span></span> <span data-ttu-id="d2f24-108">В Windows XP и более поздних версиях приложения должны использовать [изолированные приложения и параллельные сборки](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="d2f24-108">On Windows XP and later, applications should use [Isolated Applications and Side-by-side Assemblies](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="d2f24-109">Перезагружать компьютер не требуется, если выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d2f24-109">It is not necessary to restart the computer if you perform the following steps:</span></span>

1.  <span data-ttu-id="d2f24-110">Используйте функцию [**мовефиликс**](/windows/desktop/api/winbase/nf-winbase-movefileexa) , чтобы переименовать ЗАМЕНЯЕМУЮ библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-110">Use the [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) function to rename the DLL being replaced.</span></span> <span data-ttu-id="d2f24-111">Не указывайте \_ \_ разрешенную копию MOVEFILE и убедитесь, что переименованный файл находится на том же томе, который содержит исходный файл.</span><span class="sxs-lookup"><span data-stu-id="d2f24-111">Do not specify MOVEFILE\_COPY\_ALLOWED, and make sure the renamed file is on the same volume that contains the original file.</span></span> <span data-ttu-id="d2f24-112">Можно также просто переименовать файл в том же каталоге, предоставив ему другое расширение.</span><span class="sxs-lookup"><span data-stu-id="d2f24-112">You could also simply rename the file in the same directory by giving it a different extension.</span></span>
2.  <span data-ttu-id="d2f24-113">Скопируйте новую библиотеку DLL в каталог, содержащий переименованную библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-113">Copy the new DLL to the directory that contains the renamed DLL.</span></span> <span data-ttu-id="d2f24-114">Все приложения теперь будут использовать новую библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-114">All applications will now use the new DLL.</span></span>
3.  <span data-ttu-id="d2f24-115">Используйте [**мовефиликс**](/windows/desktop/api/winbase/nf-winbase-movefileexa) с MOVEFILE \_ delay \_ до \_ перезагрузки, чтобы удалить переименованную библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-115">Use [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) with MOVEFILE\_DELAY\_UNTIL\_REBOOT to delete the renamed DLL.</span></span>

<span data-ttu-id="d2f24-116">Перед выполнением замены приложения будут использовать исходную библиотеку DLL, пока она не будет выгружена.</span><span class="sxs-lookup"><span data-stu-id="d2f24-116">Before you make this replacement, applications will use the original DLL until it is unloaded.</span></span> <span data-ttu-id="d2f24-117">После внесения замены приложения будут использовать новую библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-117">After you make the replacement, applications will use the new DLL.</span></span> <span data-ttu-id="d2f24-118">При написании библиотеки DLL необходимо внимательно следить за тем, чтобы она была подготовлена в этой ситуации, особенно если библиотека DLL хранит глобальные сведения о состоянии или взаимодействует с другими службами.</span><span class="sxs-lookup"><span data-stu-id="d2f24-118">When you write a DLL, you must be careful to ensure that it is prepared for this situation, especially if the DLL maintains global state information or communicates with other services.</span></span> <span data-ttu-id="d2f24-119">Если библиотека DLL не подготовлена к изменению глобальных сведений о состоянии или протоколах связи, то для обновления библиотеки DLL потребуется перезагрузить компьютер, чтобы все приложения использовали ту же версию библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="d2f24-119">If the DLL is not prepared for a change in global state information or communication protocols, updating the DLL will require you to restart the computer to ensure that all applications are using the same version of the DLL.</span></span>

 

 
