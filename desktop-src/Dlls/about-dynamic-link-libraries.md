---
description: Динамическая компоновка позволяет модулю включать только сведения, необходимые для локализации экспортируемой функции DLL во время загрузки или во время выполнения.
ms.assetid: df2a8e4c-7ad0-46ea-9643-1528a9ea1503
title: Сведения о библиотеках Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bdb24048e17e9164aaf39d0ab337aea33576c95
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103898142"
---
# <a name="about-dynamic-link-libraries"></a><span data-ttu-id="de5f0-103">Сведения о библиотеках Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="de5f0-103">About Dynamic-Link Libraries</span></span>

<span data-ttu-id="de5f0-104">Динамическая компоновка позволяет модулю включать только сведения, необходимые для локализации экспортируемой функции DLL во время загрузки или во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="de5f0-104">Dynamic linking allows a module to include only the information needed to locate an exported DLL function at load time or run time.</span></span> <span data-ttu-id="de5f0-105">Динамическая компоновка отличается от более привычной статической компоновки, при которой компоновщик копирует код библиотечной функции в каждый модуль, который ее вызывает.</span><span class="sxs-lookup"><span data-stu-id="de5f0-105">Dynamic linking differs from the more familiar static linking, in which the linker copies a library function's code into each module that calls it.</span></span>

## <a name="types-of-dynamic-linking"></a><span data-ttu-id="de5f0-106">Типы динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-106">Types of Dynamic Linking</span></span>

<span data-ttu-id="de5f0-107">Существует два метода вызова функции в библиотеке DLL:</span><span class="sxs-lookup"><span data-stu-id="de5f0-107">There are two methods for calling a function in a DLL:</span></span>

-   <span data-ttu-id="de5f0-108">При *динамической компоновке во время загрузки* модуль выполняет явные вызовы экспортированных функций DLL, как если бы они были локальными функциями.</span><span class="sxs-lookup"><span data-stu-id="de5f0-108">In *load-time dynamic linking*, a module makes explicit calls to exported DLL functions as if they were local functions.</span></span> <span data-ttu-id="de5f0-109">Для этого необходимо связать модуль с библиотекой импорта для библиотеки DLL, содержащей функции.</span><span class="sxs-lookup"><span data-stu-id="de5f0-109">This requires you to link the module with the import library for the DLL that contains the functions.</span></span> <span data-ttu-id="de5f0-110">Библиотека импорта предоставляет системе сведения, необходимые для загрузки библиотеки DLL, и нахождение экспортированных функций DLL при загрузке приложения.</span><span class="sxs-lookup"><span data-stu-id="de5f0-110">An import library supplies the system with the information needed to load the DLL and locate the exported DLL functions when the application is loaded.</span></span>
-   <span data-ttu-id="de5f0-111">При *динамической компоновке во время выполнения* модуль использует функцию [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) или [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) для загрузки библиотеки DLL во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="de5f0-111">In *run-time dynamic linking*, a module uses the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function to load the DLL at run time.</span></span> <span data-ttu-id="de5f0-112">После загрузки библиотеки DLL модуль вызывает функцию [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) для получения адресов экспортированных функций DLL.</span><span class="sxs-lookup"><span data-stu-id="de5f0-112">After the DLL is loaded, the module calls the [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) function to get the addresses of the exported DLL functions.</span></span> <span data-ttu-id="de5f0-113">Модуль вызывает экспортированные функции DLL с помощью указателей функций, возвращаемых **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="de5f0-113">The module calls the exported DLL functions using the function pointers returned by **GetProcAddress**.</span></span> <span data-ttu-id="de5f0-114">Это устраняет необходимость в библиотеке импорта.</span><span class="sxs-lookup"><span data-stu-id="de5f0-114">This eliminates the need for an import library.</span></span>

## <a name="dlls-and-memory-management"></a><span data-ttu-id="de5f0-115">Библиотеки DLL и управление памятью</span><span class="sxs-lookup"><span data-stu-id="de5f0-115">DLLs and Memory Management</span></span>

<span data-ttu-id="de5f0-116">Каждый процесс, загружающий библиотеку DLL, сопоставляет его с виртуальным адресным пространством.</span><span class="sxs-lookup"><span data-stu-id="de5f0-116">Every process that loads the DLL maps it into its virtual address space.</span></span> <span data-ttu-id="de5f0-117">После того как процесс загрузит библиотеку DLL в свой виртуальный адрес, он может вызвать экспортированные функции DLL.</span><span class="sxs-lookup"><span data-stu-id="de5f0-117">After the process loads the DLL into its virtual address, it can call the exported DLL functions.</span></span>

<span data-ttu-id="de5f0-118">Система поддерживает счетчик ссылок по процессам для каждой библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="de5f0-118">The system maintains a per-process reference count for each DLL.</span></span> <span data-ttu-id="de5f0-119">Когда поток загружает библиотеку DLL, счетчик ссылок увеличивается на единицу.</span><span class="sxs-lookup"><span data-stu-id="de5f0-119">When a thread loads the DLL, the reference count is incremented by one.</span></span> <span data-ttu-id="de5f0-120">Когда процесс завершается или значение счетчика ссылок становится нулевым (только динамическая компоновка во время выполнения), Библиотека DLL выгружается из виртуального адресного пространства процесса.</span><span class="sxs-lookup"><span data-stu-id="de5f0-120">When the process terminates, or when the reference count becomes zero (run-time dynamic linking only), the DLL is unloaded from the virtual address space of the process.</span></span>

<span data-ttu-id="de5f0-121">Как и любая другая функция, экспортированная функция DLL выполняется в контексте потока, который ее вызывает.</span><span class="sxs-lookup"><span data-stu-id="de5f0-121">Like any other function, an exported DLL function runs in the context of the thread that calls it.</span></span> <span data-ttu-id="de5f0-122">Поэтому применяются следующие условия.</span><span class="sxs-lookup"><span data-stu-id="de5f0-122">Therefore, the following conditions apply:</span></span>

-   <span data-ttu-id="de5f0-123">Потоки процесса, вызвавшие библиотеку DLL, могут использовать дескрипторы, открытые функцией DLL.</span><span class="sxs-lookup"><span data-stu-id="de5f0-123">The threads of the process that called the DLL can use handles opened by a DLL function.</span></span> <span data-ttu-id="de5f0-124">Аналогичным образом дескрипторы, открытые в любом потоке вызывающего процесса, можно использовать в функции DLL.</span><span class="sxs-lookup"><span data-stu-id="de5f0-124">Similarly, handles opened by any thread of the calling process can be used in the DLL function.</span></span>
-   <span data-ttu-id="de5f0-125">Библиотека DLL использует стек вызывающего потока и виртуальное адресное пространство вызывающего процесса.</span><span class="sxs-lookup"><span data-stu-id="de5f0-125">The DLL uses the stack of the calling thread and the virtual address space of the calling process.</span></span>
-   <span data-ttu-id="de5f0-126">Библиотека DLL выделяет память из виртуального адресного пространства вызывающего процесса.</span><span class="sxs-lookup"><span data-stu-id="de5f0-126">The DLL allocates memory from the virtual address space of the calling process.</span></span>

<span data-ttu-id="de5f0-127">Дополнительные сведения о библиотеках DLL см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="de5f0-127">For more information about DLLs, see the following topics:</span></span>

-   [<span data-ttu-id="de5f0-128">Преимущества динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-128">Advantages of Dynamic Linking</span></span>](advantages-of-dynamic-linking.md)
-   [<span data-ttu-id="de5f0-129">Создание библиотеки динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-129">Dynamic-Link Library Creation</span></span>](dynamic-link-library-creation.md)
-   [<span data-ttu-id="de5f0-130">Функция Entry-Point библиотеки динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-130">Dynamic-Link Library Entry-Point Function</span></span>](dynamic-link-library-entry-point-function.md)
-   [<span data-ttu-id="de5f0-131">Динамическая компоновка во время загрузки</span><span class="sxs-lookup"><span data-stu-id="de5f0-131">Load-Time Dynamic Linking</span></span>](load-time-dynamic-linking.md)
-   [<span data-ttu-id="de5f0-132">Динамическая компоновка во время выполнения</span><span class="sxs-lookup"><span data-stu-id="de5f0-132">Run-Time Dynamic Linking</span></span>](run-time-dynamic-linking.md)
-   [<span data-ttu-id="de5f0-133">Порядок поиска библиотеки динамической компоновки (DLL)</span><span class="sxs-lookup"><span data-stu-id="de5f0-133">Dynamic-Link Library Search Order</span></span>](dynamic-link-library-search-order.md)
-   [<span data-ttu-id="de5f0-134">Данные библиотеки динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-134">Dynamic-Link Library Data</span></span>](dynamic-link-library-data.md)
-   [<span data-ttu-id="de5f0-135">Перенаправление библиотек динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-135">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
-   [<span data-ttu-id="de5f0-136">Обновления библиотеки динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-136">Dynamic-Link Library Updates</span></span>](dynamic-link-library-updates.md)
-   [<span data-ttu-id="de5f0-137">Безопасность библиотеки динамической компоновки</span><span class="sxs-lookup"><span data-stu-id="de5f0-137">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
-   [<span data-ttu-id="de5f0-138">Библиотеки DLL и безопасная загрузка</span><span class="sxs-lookup"><span data-stu-id="de5f0-138">AppInit DLLs and Secure Boot</span></span>](secure-boot-and-appinit-dlls.md)

 

 
