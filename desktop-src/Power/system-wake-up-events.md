---
description: Приложение может восстановить состояние компьютера в спящем режиме до рабочего состояния с помощью запланированного таймера или события устройства.
ms.assetid: b7326b09-0829-4e76-80d0-e4ecdf7f556e
title: События пробуждения системы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f13332305ef023d932f2912f7299aa12cd402733
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673791"
---
# <a name="system-wake-up-events"></a><span data-ttu-id="e4414-103">События пробуждения системы</span><span class="sxs-lookup"><span data-stu-id="e4414-103">System Wake-up Events</span></span>

<span data-ttu-id="e4414-104">Следующие сведения относятся к пробуждению из [спящего режима (S3) и гибернации (S4)](/windows-hardware/drivers/kernel/system-sleeping-states).</span><span class="sxs-lookup"><span data-stu-id="e4414-104">The following information applies to wakes from [sleep (S3) and hibernate (S4)](/windows-hardware/drivers/kernel/system-sleeping-states).</span></span> <span data-ttu-id="e4414-105">Сведения о пробуждении из современного режима ожидания (низкое энергопотребление S0) см. в статье [переходы в режиме простоя в состояние "активно](/windows-hardware/design/device-experiences/transition-from-idle-to-active)".</span><span class="sxs-lookup"><span data-stu-id="e4414-105">For wakes from Modern Standby (S0 Low Power Idle), please refer to [transitions from idle to active](/windows-hardware/design/device-experiences/transition-from-idle-to-active).</span></span>

<span data-ttu-id="e4414-106">Приложение может восстановить состояние компьютера в спящем режиме до рабочего состояния с помощью запланированного таймера или события устройства.</span><span class="sxs-lookup"><span data-stu-id="e4414-106">Your application can restore a computer that is in a sleep state to the working state by using a scheduled timer or a device event.</span></span> <span data-ttu-id="e4414-107">Это называется *событием пробуждения*.</span><span class="sxs-lookup"><span data-stu-id="e4414-107">This is known as a *wake-up event*.</span></span> <span data-ttu-id="e4414-108">Используйте [объект таймера](/windows/desktop/Sync/waitable-timer-objects) с возможностью ожидания, чтобы указать время, когда система должна пробудиться.</span><span class="sxs-lookup"><span data-stu-id="e4414-108">Use a [waitable timer object](/windows/desktop/Sync/waitable-timer-objects) to specify the time at which the system should wake.</span></span> <span data-ttu-id="e4414-109">Чтобы создать объект, используйте функцию [**сбой createwaitabletimer**](/windows/win32/api/synchapi/nf-synchapi-createwaitabletimerw) .</span><span class="sxs-lookup"><span data-stu-id="e4414-109">To create the object, use the [**CreateWaitableTimer**](/windows/win32/api/synchapi/nf-synchapi-createwaitabletimerw) function.</span></span> <span data-ttu-id="e4414-110">Чтобы задать таймер, используйте функцию [**сетваитаблетимер**](/windows/desktop/api/synchapi/nf-synchapi-setwaitabletimer) .</span><span class="sxs-lookup"><span data-stu-id="e4414-110">To set the timer, use the [**SetWaitableTimer**](/windows/desktop/api/synchapi/nf-synchapi-setwaitabletimer) function.</span></span> <span data-ttu-id="e4414-111">Параметр *пдуетиме* указывает, когда таймер будет получать сигнал.</span><span class="sxs-lookup"><span data-stu-id="e4414-111">The *pDueTime* parameter specifies when the timer will be signaled.</span></span> <span data-ttu-id="e4414-112">Чтобы указать, что система должна пробудиться при получении сигнала таймера, установите  для параметра Фресуме **значение true**.</span><span class="sxs-lookup"><span data-stu-id="e4414-112">To specify that the system should wake when the timer is signaled, set the *fResume* parameter to **TRUE**.</span></span>

<span data-ttu-id="e4414-113">При автоматическом пробуждении системы из-за события (отличного от выключателя питания или активности пользователя) система автоматически устанавливает таймер бездействия автоматического простоя в течение не менее 2 минут.</span><span class="sxs-lookup"><span data-stu-id="e4414-113">When the system wakes automatically because of an event (other than power switch or user activity), the system automatically sets an unattended idle timer to at least 2 minutes.</span></span> <span data-ttu-id="e4414-114">Этот таймер предоставляет приложениям достаточно времени для вызова функции [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) , чтобы указать, что они заняты.</span><span class="sxs-lookup"><span data-stu-id="e4414-114">This timer gives applications sufficient time to call the [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) function to indicate that they are busy.</span></span> <span data-ttu-id="e4414-115">На этот раз система может быстро вернуться в спящий режим после того, как компьютер больше не требуется.</span><span class="sxs-lookup"><span data-stu-id="e4414-115">This time enables the system to return to the sleep state quickly after the computer is no longer required.</span></span> <span data-ttu-id="e4414-116">Следующие критерии определяют, возвращается ли система к состоянию сна:</span><span class="sxs-lookup"><span data-stu-id="e4414-116">The following criteria determine whether the system returns to the sleep state:</span></span>

-   <span data-ttu-id="e4414-117">Если система автоматически выходит из спящего режима (то есть никакие действия пользователя отсутствуют), работа завершается сразу же после истечения таймера автоматического простоя, предполагая, что ни одно приложение не вызвало [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) , чтобы указать, что система является обязательной.</span><span class="sxs-lookup"><span data-stu-id="e4414-117">If the system wakes automatically (that is, no user activity is present), it shuts down as soon as the unattended idle timer expires, assuming that no applications have called [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) to indicate that the system is required.</span></span>
-   <span data-ttu-id="e4414-118">Пробуждение на основе устройства активирует таймер автоматического простоя по умолчанию, если драйвер устройства не указывает на присутствие пользователя.</span><span class="sxs-lookup"><span data-stu-id="e4414-118">Device-based wakes trigger the unattended idle timer by default unless the device driver indicates user presence.</span></span> <span data-ttu-id="e4414-119">Если драйвер указывает на присутствие пользователя, то используется таймер простоя системы.</span><span class="sxs-lookup"><span data-stu-id="e4414-119">If the driver indicates user presence, then the system idle timer is used.</span></span>
-   <span data-ttu-id="e4414-120">Если система автоматически выходит из системы, но пользователь предоставляет новые входные данные во время обработки события, система не возвращается автоматически в спящий режим на основе таймера автоматического простоя.</span><span class="sxs-lookup"><span data-stu-id="e4414-120">If the system wakes automatically, but the user provides new input while the event is handled, the system does not automatically return to sleep based on the unattended idle timer.</span></span> <span data-ttu-id="e4414-121">Вместо этого система возвращается в спящий режим на основе таймера простоя системы.</span><span class="sxs-lookup"><span data-stu-id="e4414-121">Instead, the system returns to sleep based on the system idle timer.</span></span>
-   <span data-ttu-id="e4414-122">Если система пробуждается из-за активности пользователя, система не автоматически возвращается в спящий режим на основе таймера автоматического простоя.</span><span class="sxs-lookup"><span data-stu-id="e4414-122">If the system wakes due to user activity, the system does not automatically return to sleep based on the unattended idle timer.</span></span> <span data-ttu-id="e4414-123">Вместо этого система возвращается в спящий режим на основе таймера простоя системы.</span><span class="sxs-lookup"><span data-stu-id="e4414-123">Instead the system returns to sleep based on the system idle timer.</span></span>

<span data-ttu-id="e4414-124">Когда система автоматически пробуждается, она передает событие [ПБТ \_ апмресумеаутоматик](pbt-apmresumeautomatic.md) всем приложениям.</span><span class="sxs-lookup"><span data-stu-id="e4414-124">When the system wakes automatically, it broadcasts the [PBT\_APMRESUMEAUTOMATIC](pbt-apmresumeautomatic.md) event to all applications.</span></span> <span data-ttu-id="e4414-125">Поскольку пользователь отсутствует, большинство приложений не должны выполнять никаких действий.</span><span class="sxs-lookup"><span data-stu-id="e4414-125">Because the user is not present, most applications should do nothing.</span></span> <span data-ttu-id="e4414-126">Приложения обработки событий, такие как факс-серверы, должны обрабатывать свои события.</span><span class="sxs-lookup"><span data-stu-id="e4414-126">Event-handling applications, such as fax servers, should handle their events.</span></span> <span data-ttu-id="e4414-127">Чтобы определить, находится ли система в этом состоянии, вызовите функцию [**иссистемресумеаутоматик**](/windows/desktop/api/Winbase/nf-winbase-issystemresumeautomatic) .</span><span class="sxs-lookup"><span data-stu-id="e4414-127">To determine whether the system is in this state, call the [**IsSystemResumeAutomatic**](/windows/desktop/api/Winbase/nf-winbase-issystemresumeautomatic) function.</span></span> <span data-ttu-id="e4414-128">При автоматическом пробуждении системы отображение не включается автоматически.</span><span class="sxs-lookup"><span data-stu-id="e4414-128">When the system wakes automatically, the display is not automatically turned on.</span></span>

<span data-ttu-id="e4414-129">Если система выходит из-за активности пользователя, система сначала передает событие [ПБТ \_ апмресумеаутоматик](pbt-apmresumeautomatic.md) , за которым следует событие [ПБТ \_ апмресумесуспенд](pbt-apmresumesuspend.md) .</span><span class="sxs-lookup"><span data-stu-id="e4414-129">If the system wakes due to user activity, the system will first broadcast the [PBT\_APMRESUMEAUTOMATIC](pbt-apmresumeautomatic.md) event followed by a [PBT\_APMRESUMESUSPEND](pbt-apmresumesuspend.md) event.</span></span> <span data-ttu-id="e4414-130">Кроме того, система будет включать дисплей.</span><span class="sxs-lookup"><span data-stu-id="e4414-130">In addition, the system will turn on the display.</span></span> <span data-ttu-id="e4414-131">Приложение должно повторно открывать закрытые файлы, когда система перешла в спящий режим, и подготовиться к вводу данных пользователем.</span><span class="sxs-lookup"><span data-stu-id="e4414-131">Your application should reopen files that it closed when the system entered sleep and prepare for user input.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e4414-132">См. также</span><span class="sxs-lookup"><span data-stu-id="e4414-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e4414-133">Сведения об управлении питанием</span><span class="sxs-lookup"><span data-stu-id="e4414-133">About Power Management</span></span>](about-power-management.md)
</dt> <dt>

[<span data-ttu-id="e4414-134">Критерии спящего режима системы</span><span class="sxs-lookup"><span data-stu-id="e4414-134">System Sleep Criteria</span></span>](system-sleep-criteria.md)
</dt> </dl>

 

 
