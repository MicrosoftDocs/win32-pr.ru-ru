---
description: Событие управления питанием системы — это изменение состояния питания системы, рабочего режима устройства или системы или значения параметра питания.
ms.assetid: f73b072a-1f69-4e26-9712-dab428edca18
title: События управления питанием системы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ab18fad9116cfff9e1cd35703e32a49e3b12c8b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105663101"
---
# <a name="system-power-management-events"></a><span data-ttu-id="0a720-103">События управления питанием системы</span><span class="sxs-lookup"><span data-stu-id="0a720-103">System Power Management Events</span></span>

<span data-ttu-id="0a720-104">Событие управления питанием системы — это изменение состояния питания системы, рабочего режима устройства или системы или значения параметра питания.</span><span class="sxs-lookup"><span data-stu-id="0a720-104">A system power management event is a change in the system power status, the operational mode of a device or the system, or the value of a power setting.</span></span> <span data-ttu-id="0a720-105">Так как эти события могут повлиять на работу приложений и устанавливаемых драйверов, система уведомляет все приложения и устанавливаемые драйверы, выполнив широковещательную рассылку уведомлений для каждого события.</span><span class="sxs-lookup"><span data-stu-id="0a720-105">Because these events can affect the operation of applications and installable drivers, the system notifies all applications and installable drivers by broadcasting a notification for each event.</span></span> <span data-ttu-id="0a720-106">Приложения и службы регистрируются для получения уведомлений с помощью функции [**RegisterPowerSettingNotification**](/windows/desktop/api/WinUser/nf-winuser-registerpowersettingnotification) .</span><span class="sxs-lookup"><span data-stu-id="0a720-106">Applications and services register for notifications by using the [**RegisterPowerSettingNotification**](/windows/desktop/api/WinUser/nf-winuser-registerpowersettingnotification) function.</span></span> <span data-ttu-id="0a720-107">Уведомления поступают через сообщение [**WM \_ поверброадкаст**](wm-powerbroadcast.md) , которое содержит событие управления питанием и все связанные данные события.</span><span class="sxs-lookup"><span data-stu-id="0a720-107">Notifications are received via the [**WM\_POWERBROADCAST**](wm-powerbroadcast.md) message, which contains the power management event and any associated event-specific data.</span></span>

## <a name="system-power-status-events"></a><span data-ttu-id="0a720-108">События состояния питания системы</span><span class="sxs-lookup"><span data-stu-id="0a720-108">System Power Status Events</span></span>

<span data-ttu-id="0a720-109">*Событие состояния системы питания* возникает при изменении источника питания или в состоянии аккумулятора системы.</span><span class="sxs-lookup"><span data-stu-id="0a720-109">A *system power status event* occurs when there is a change in the power supply or in the system battery status.</span></span> <span data-ttu-id="0a720-110">Например, система передает событие [ПБТ \_ апмповерстатусчанже](pbt-apmpowerstatuschange.md) всякий раз, когда пользователь переключается от аккумулятора к питанию от сети или наоборот.</span><span class="sxs-lookup"><span data-stu-id="0a720-110">For example, the system broadcasts a [PBT\_APMPOWERSTATUSCHANGE](pbt-apmpowerstatuschange.md) event whenever the user switches from battery to AC power or vice versa.</span></span> <span data-ttu-id="0a720-111">Это событие возникает также, если уровень заряда батареи становится ниже заданного пользователем порога или изменяется на заданную величину в процентах.</span><span class="sxs-lookup"><span data-stu-id="0a720-111">The system also broadcasts this event when remaining battery power slips below the threshold specified by the user or if the battery power changes by a specified percentage.</span></span>

## <a name="operational-mode-events"></a><span data-ttu-id="0a720-112">События рабочего режима</span><span class="sxs-lookup"><span data-stu-id="0a720-112">Operational Mode Events</span></span>

<span data-ttu-id="0a720-113">*Событие рабочего режима* возникает при изменении энергопотребления, например при переключении системы в состояние сна из-за неактивности или при ручном переводе системы в спящий режим.</span><span class="sxs-lookup"><span data-stu-id="0a720-113">An *operational mode event* occurs when there is a change in power consumption, such as the system switching to a sleep state due to inactivity or the user manually putting the system to sleep.</span></span> <span data-ttu-id="0a720-114">Система передает события об этих изменениях до внесения изменений в энергопотребление.</span><span class="sxs-lookup"><span data-stu-id="0a720-114">The system broadcasts events about these changes before the change in power consumption is made.</span></span> <span data-ttu-id="0a720-115">Например, если система определяет, что она бездействует, она передает событие [ПБТ \_ апмсуспенд](pbt-apmsuspend.md) , которое уведомляет о том, что приложения и драйверы, которые он собирается приостановить, приостанавливают работу и спящий режим для экономии энергии.</span><span class="sxs-lookup"><span data-stu-id="0a720-115">For example, if the system determines that it is idle, it broadcasts a [PBT\_APMSUSPEND](pbt-apmsuspend.md) event that notifies applications and drivers that it is about to suspend operation and sleep to conserve power.</span></span> <span data-ttu-id="0a720-116">Приложения и драйверы могут подготовиться к переходу в спящий режим путем закрытия файлов и сохранения данных во избежание возможной потери данных.</span><span class="sxs-lookup"><span data-stu-id="0a720-116">Applications and drivers can prepare for sleep by closing files and saving data to avoid potential data loss.</span></span>

<span data-ttu-id="0a720-117">Когда система выполняет *критическую приостановку*, система немедленно переходит в спящий режим из-за критической ситуации, такой как оповещение о критическом аккумуляторе.</span><span class="sxs-lookup"><span data-stu-id="0a720-117">When the system carries out a *critical suspension*, the system is immediately put to sleep due to a critical condition such as a critical battery alarm.</span></span> <span data-ttu-id="0a720-118">В отличие от обычного перехода в спящий режим, система не уведомляет приложения и драйверы перед выполнением критической приостановки.</span><span class="sxs-lookup"><span data-stu-id="0a720-118">In contrast to a normal sleep transition, the system does not notify applications and drivers before carrying out a critical suspension.</span></span> <span data-ttu-id="0a720-119">Поэтому приложения должны быть готовы к обработке критических приостановк.</span><span class="sxs-lookup"><span data-stu-id="0a720-119">Therefore, applications must be prepared to handle critical suspensions.</span></span>

<span data-ttu-id="0a720-120">Когда Системная операция восстанавливается после приостановки, система уведомляет все приложения и драйверы.</span><span class="sxs-lookup"><span data-stu-id="0a720-120">When system operation is restored after having been suspended, the system notifies all applications and drivers.</span></span> <span data-ttu-id="0a720-121">Он также указывает, возобновляется ли система с критической приостановки, чтобы приложение или драйвер могли предпринять соответствующие меры для восстановления данных и продолжения работы.</span><span class="sxs-lookup"><span data-stu-id="0a720-121">It also indicates whether the system is resuming from a critical suspension so the application or driver can take appropriate steps to restore its data and continue operation.</span></span>

<span data-ttu-id="0a720-122">Приложения должны выполнять каждую попытку обработать переход в состояние сна без вмешательства пользователя, так как может быть невозможно ответить пользователю.</span><span class="sxs-lookup"><span data-stu-id="0a720-122">Applications should make every attempt to handle the transition to the sleep state without any user intervention because it may not be possible for the user to respond.</span></span> <span data-ttu-id="0a720-123">Например, крышка на компьютере ноутбука может быть закрыта.</span><span class="sxs-lookup"><span data-stu-id="0a720-123">For example, the lid on the notebook computer may be closed.</span></span> <span data-ttu-id="0a720-124">Когда приложение получает уведомление о том, что система собирается перейти в спящий режим, она должна быстро выполнять все необходимые операции и возвращать из цикла обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="0a720-124">When an application receives notification that the system is about to enter sleep, it should perform any necessary operations quickly and return out of the message loop.</span></span> <span data-ttu-id="0a720-125">Система допускает не более двух секунд на приложение при обработке этого сообщения до истечения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="0a720-125">The system allows for a maximum of two seconds per application when handling this message before timing out.</span></span>

## <a name="power-setting-change-events"></a><span data-ttu-id="0a720-126">События изменения параметров питания</span><span class="sxs-lookup"><span data-stu-id="0a720-126">Power Setting Change Events</span></span>

<span data-ttu-id="0a720-127">Событие изменения параметра питания возникает при изменении значения параметра питания.</span><span class="sxs-lookup"><span data-stu-id="0a720-127">A power setting change event occurs when there is a change in the value of a power setting.</span></span> <span data-ttu-id="0a720-128">Например, пользователь изменяет схему управления питанием с высокой производительности на сбалансированную в приложении "Параметры электропитания" на панели управления.</span><span class="sxs-lookup"><span data-stu-id="0a720-128">For example, the user changes the power plan from High Performance to Balanced in the Power Options application in Control Panel.</span></span> <span data-ttu-id="0a720-129">В этом случае система рассылает событие, указывающее на изменение схемы управления питанием.</span><span class="sxs-lookup"><span data-stu-id="0a720-129">In this case, the system would broadcast an event that indicates that the power plan has changed.</span></span> <span data-ttu-id="0a720-130">Это событие включает новое значение параметра питания.</span><span class="sxs-lookup"><span data-stu-id="0a720-130">This event includes the new value for the power setting.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0a720-131">См. также</span><span class="sxs-lookup"><span data-stu-id="0a720-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0a720-132">Сведения об управлении питанием</span><span class="sxs-lookup"><span data-stu-id="0a720-132">About Power Management</span></span>](about-power-management.md)
</dt> </dl>

 

 



