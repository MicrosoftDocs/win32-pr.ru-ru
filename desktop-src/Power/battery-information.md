---
description: Батареи могут предоставить питание для портативных компьютеров и компьютеров, работающих на источнике бесперебойного питания (ИБП).
ms.assetid: 3580b37d-611c-46b4-9300-4943833d6852
title: Сведения о батарее
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4f9838a2a95db037b9655f116f07e3cf2e072d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105663131"
---
# <a name="battery-information"></a><span data-ttu-id="5685c-103">Сведения о батарее</span><span class="sxs-lookup"><span data-stu-id="5685c-103">Battery Information</span></span>

<span data-ttu-id="5685c-104">Батареи могут предоставить питание для портативных компьютеров и компьютеров, работающих на источнике бесперебойного питания (ИБП).</span><span class="sxs-lookup"><span data-stu-id="5685c-104">Batteries can provide power for portable computers and computers running on an uninterruptible power supply (UPS).</span></span> <span data-ttu-id="5685c-105">На этих компьютерах операционная система предоставляет сведения о состоянии аккумулятора, чтобы приложения могли предоставлять пользователям полезные функции.</span><span class="sxs-lookup"><span data-stu-id="5685c-105">On these computers, the operating system provides information on the state of the battery so applications can provide useful functions for the user.</span></span> <span data-ttu-id="5685c-106">(Некоторые старые нестандартные системы аккумулятора и ИБП не поддерживаются.)</span><span class="sxs-lookup"><span data-stu-id="5685c-106">(Some older nonstandard battery systems and UPSs are not supported.)</span></span>

<span data-ttu-id="5685c-107">Обратите внимание, что в этом обзоре предполагается, что вы знакомы с [управлением устройствами](/windows/desktop/DevIO/device-management).</span><span class="sxs-lookup"><span data-stu-id="5685c-107">Note that this overview assumes you are familiar with [device management](/windows/desktop/DevIO/device-management).</span></span>

<span data-ttu-id="5685c-108">Чтобы получить сведения о состоянии аккумулятора, используйте функцию [**GetSystemPowerStatus**](/windows/desktop/api/Winbase/nf-winbase-getsystempowerstatus) , которая возвращает общие сведения обо всех источниках питания в системе.</span><span class="sxs-lookup"><span data-stu-id="5685c-108">To obtain information about the battery status, use the [**GetSystemPowerStatus**](/windows/desktop/api/Winbase/nf-winbase-getsystempowerstatus) function, which returns general information about all power sources in the system.</span></span> <span data-ttu-id="5685c-109">При возможности следует использовать **GetSystemPowerStatus** .</span><span class="sxs-lookup"><span data-stu-id="5685c-109">You should use **GetSystemPowerStatus** whenever possible.</span></span>

<span data-ttu-id="5685c-110">Однако в некоторых случаях требуется подробная информация о каждом отдельном батарее.</span><span class="sxs-lookup"><span data-stu-id="5685c-110">In some cases, however, detailed information about each individual battery is necessary.</span></span> <span data-ttu-id="5685c-111">Для этой цели каждое батареное устройство предоставляет интерфейс IOCTL.</span><span class="sxs-lookup"><span data-stu-id="5685c-111">For this purpose, each battery device exposes an IOCTL interface.</span></span> <span data-ttu-id="5685c-112">Следующие операции IOCTL выполняются с помощью функции [**DeviceIoControl**](/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol) :</span><span class="sxs-lookup"><span data-stu-id="5685c-112">The following IOCTL operations are performed using the [**DeviceIoControl**](/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol) function:</span></span>

<dl>

[<span data-ttu-id="5685c-113">**\_ \_ сведения о запросе от аккумулятора ioctl \_**</span><span class="sxs-lookup"><span data-stu-id="5685c-113">**IOCTL\_BATTERY\_QUERY\_INFORMATION**</span></span>](ioctl-battery-query-information.md)  
[<span data-ttu-id="5685c-114">**\_ \_ состояние запроса аккумулятора \_ ioctl**</span><span class="sxs-lookup"><span data-stu-id="5685c-114">**IOCTL\_BATTERY\_QUERY\_STATUS**</span></span>](ioctl-battery-query-status.md)  
[<span data-ttu-id="5685c-115">**\_тег запроса на батарею ioctl \_ \_**</span><span class="sxs-lookup"><span data-stu-id="5685c-115">**IOCTL\_BATTERY\_QUERY\_TAG**</span></span>](ioctl-battery-query-tag.md)  
[<span data-ttu-id="5685c-116">**\_ \_ сведения о настройке аккумулятора ioctl \_**</span><span class="sxs-lookup"><span data-stu-id="5685c-116">**IOCTL\_BATTERY\_SET\_INFORMATION**</span></span>](ioctl-battery-set-information.md)  
</dl>

<span data-ttu-id="5685c-117">Чтобы использовать этот интерфейс, приложение должно выполнить несколько шагов.</span><span class="sxs-lookup"><span data-stu-id="5685c-117">To use this interface, an application must follow several steps.</span></span> <span data-ttu-id="5685c-118">Во-первых, он должен использовать программы установки для перечисления всех устройств, имеющих интерфейс класса аккумулятора.</span><span class="sxs-lookup"><span data-stu-id="5685c-118">First, it must use setup routines to enumerate all devices that have a battery class interface.</span></span> <span data-ttu-id="5685c-119">Обратите внимание, что эти устройства представляют порты батареи, а не фактические батареи в системе.</span><span class="sxs-lookup"><span data-stu-id="5685c-119">Note that these devices represent the battery ports, not actual batteries present in the system.</span></span> <span data-ttu-id="5685c-120">После этого приложение должно открыть обработчик для каждого устройства, чтобы он мог использовать функцию [**DeviceIoControl**](/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol) для отправки запросов на устройство, а затем получать теги для всех вставленных батарей.</span><span class="sxs-lookup"><span data-stu-id="5685c-120">The application must then open a handle to each device so it can use the [**DeviceIoControl**](/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol) function to send requests to the device, and then acquire tags for any batteries that are inserted.</span></span> <span data-ttu-id="5685c-121">После выполнения этих действий приложение может отсылать запросы на каждое устройство с батареей.</span><span class="sxs-lookup"><span data-stu-id="5685c-121">After completing these steps, the application can send queries to each battery device.</span></span>

## <a name="battery-tags"></a><span data-ttu-id="5685c-122">Теги аккумулятора</span><span class="sxs-lookup"><span data-stu-id="5685c-122">Battery Tags</span></span>

<span data-ttu-id="5685c-123">Так как каждое устройство батареи представляет собой слот, в который можно вставить батарею, необходимо определить, когда батарея будет удалена, заменена или изменена любым другим способом.</span><span class="sxs-lookup"><span data-stu-id="5685c-123">Because each battery device represents a slot into which a battery can be inserted, there must be a way to determine when the battery is removed and reinserted, replaced, or changed in any other way.</span></span> <span data-ttu-id="5685c-124">Для этого каждой батареей в определенном слоте назначается тег.</span><span class="sxs-lookup"><span data-stu-id="5685c-124">To do this, each battery in a particular slot is assigned a tag.</span></span> <span data-ttu-id="5685c-125">Этот тег должен использоваться для всех запросов для получения сведений.</span><span class="sxs-lookup"><span data-stu-id="5685c-125">This tag must be used for all queries for information.</span></span> <span data-ttu-id="5685c-126">Если тег, предоставленный приложением, не соответствует батарее, запрос завершается неудачей, указывая на то, что батарея изменилась.</span><span class="sxs-lookup"><span data-stu-id="5685c-126">If the tag provided by the application does not match the battery, the query fails, indicating to the application that the battery has changed in some way.</span></span> <span data-ttu-id="5685c-127">Для успешного выполнения запроса требуется новый тег батареи.</span><span class="sxs-lookup"><span data-stu-id="5685c-127">To successfully complete the query, a new battery tag is required.</span></span> <span data-ttu-id="5685c-128">Получите тег с помощью операции [**с \_ \_ \_ тегом запроса аккумулятора**](ioctl-battery-query-tag.md) .</span><span class="sxs-lookup"><span data-stu-id="5685c-128">Acquire the tag using the [**IOCTL\_BATTERY\_QUERY\_TAG**](ioctl-battery-query-tag.md) operation.</span></span> <span data-ttu-id="5685c-129">Если в этом слоте есть батарея, возвращаемый тег может быть передан любым другим функциям IOCTL от аккумулятора для выполнения других функций.</span><span class="sxs-lookup"><span data-stu-id="5685c-129">If a battery is present in that slot, the tag returned can be passed to any of the other battery IOCTLs to perform other functions.</span></span> <span data-ttu-id="5685c-130">В системе с несколькими батареями каждое устройство батареи (слот) выдает Теги аккумулятора независимо, поэтому тег из двух отдельных устройств может быть одинаковым.</span><span class="sxs-lookup"><span data-stu-id="5685c-130">On a multi-battery system, each battery device (slot) issues battery tags independently, so the tag from two separate devices could at times be identical.</span></span>

<span data-ttu-id="5685c-131">Изменение в теге батареи не обязательно означает, что батарея была удалена, повторно вставлена или заменена.</span><span class="sxs-lookup"><span data-stu-id="5685c-131">A change in the battery tag does not necessarily mean that the battery was removed and reinserted or replaced.</span></span> <span data-ttu-id="5685c-132">Новый тег может быть создан при изменении любого из данных, которые обычно являются статическими.</span><span class="sxs-lookup"><span data-stu-id="5685c-132">A new tag can be generated if there is a change in any of the data that would normally be static.</span></span> <span data-ttu-id="5685c-133">Например, после зарядки аккумулятора может измениться последняя полностью заряженная емкость.</span><span class="sxs-lookup"><span data-stu-id="5685c-133">For example, when a battery is done charging, the last fully charged capacity may have changed.</span></span> <span data-ttu-id="5685c-134">Кроме того, тег может измениться, если батарея была временно утрачена или если в BIOS возникло неправильное уведомление.</span><span class="sxs-lookup"><span data-stu-id="5685c-134">The tag can also change if battery communication was temporarily lost or if there was an improper notification from the BIOS.</span></span> <span data-ttu-id="5685c-135">В некоторых системах тег аккумулятора может обновляться при каждом изменении состояния сети.</span><span class="sxs-lookup"><span data-stu-id="5685c-135">On some systems, the battery tag may be updated whenever the AC status changes.</span></span> <span data-ttu-id="5685c-136">Такое поведение обусловлено характеристикой системы аккумулятора и не является распространенным.</span><span class="sxs-lookup"><span data-stu-id="5685c-136">This behavior is due to a characteristic of the battery system and isn't common.</span></span>

<span data-ttu-id="5685c-137">При обновлении тега батареи батарея должна считаться новым аккумулятором, а все кэшированные данные должны быть прочитаны повторно.</span><span class="sxs-lookup"><span data-stu-id="5685c-137">Whenever the battery tag is updated, the battery should be treated as if it were a new battery and all cached data should be re-read.</span></span> <span data-ttu-id="5685c-138">Если приложению необходимо узнать, имеется ли тот же физический аккумулятор, то при вызове с уровнем информации **баттерюникуеид** он должен проверить значение **баттерюникуеид** в выходном буфере [**\_ \_ запроса \_ на батарею ioctl**](ioctl-battery-query-information.md) .</span><span class="sxs-lookup"><span data-stu-id="5685c-138">If an application needs to know if the same physical battery is present, it should check the value of **BatteryUniqueID** in the output buffer of [**IOCTL\_BATTERY\_QUERY\_INFORMATION**](ioctl-battery-query-information.md) when called with the **BatteryUniqueID** information level.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5685c-139">См. также</span><span class="sxs-lookup"><span data-stu-id="5685c-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5685c-140">Сведения об управлении питанием</span><span class="sxs-lookup"><span data-stu-id="5685c-140">About Power Management</span></span>](about-power-management.md)
</dt> <dt>

[<span data-ttu-id="5685c-141">Перечисление устройств с батареей</span><span class="sxs-lookup"><span data-stu-id="5685c-141">Enumerating Battery Devices</span></span>](enumerating-battery-devices.md)
</dt> </dl>

 

 
