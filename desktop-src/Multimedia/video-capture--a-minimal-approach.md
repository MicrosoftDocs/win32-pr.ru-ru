---
title: Запись видео с минимальным подходом
description: Запись видео с минимальным подходом
ms.assetid: e39ff590-69c0-4927-90c2-786c6082068f
keywords:
- Видео для Windows (VFW), запись видео
- VFW (видео для Windows), запись видео
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7a65d5d5bbdc00dfd947c5d917e514d72e3ac069
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103890524"
---
# <a name="video-capture-a-minimal-approach"></a>Видеозапись: минимальный подход

Видеозапись помещает поток видео и звуковых данных и сохраняет их на жестком диске или на любом другом типе постоянного запоминающего устройства. В этом разделе описывается добавление простой формы видеозаписи в приложение с помощью трех инструкций кода. В нем также описывается завершение или прерывание сеанса записи путем отправки сообщений в окно Capture (захват).

Окно записи Авикап обрабатывает сведения о потоковой передаче аудио и видео в файлы AVI. Это освобождает ваше приложение от участия в формате AVI, управлении видео-и аудио-буферами, а также на низком уровне доступа к видео и драйверам звуковых устройств. Авикап предоставляет гибкий интерфейс для приложений. Вы можете добавить запись видео в приложение, используя только следующие строки кода:


```C++
hWndC = capCreateCaptureWindow ( "My Own Capture Window", 
    WS_CHILD | WS_VISIBLE , 0, 0, 160, 120, hwndParent, nID);

SendMessage (hWndC, WM_CAP_DRIVER_CONNECT, 0 /* wIndex */, 0L);

SendMessage (hWndC, WM_CAP_SEQUENCE, 0, 0L);
 
```



Также доступен интерфейс макросов, который предоставляет альтернативу использованию функции [SendMessage](/windows/win32/api/winuser/nf-winuser-sendmessage) и повышает удобочитаемость приложения. В следующем примере для добавления видеозаписи в приложение используется интерфейс макросов.


```C++
hWndC = capCreateCaptureWindow (   "My Own Capture Window", 
    WS_CHILD | WS_VISIBLE ,   0, 0, 160, 120, hwndParent, nID);

capDriverConnect (hWndC, 0);

capCaptureSequence (hWndC); 
 
```



После того как приложение создаст окно записи класса Авикап и подключится к видеодрайверу, окно записи готово к записи данных. На этом этапе приложение может просто отправить сообщение [**\_ \_ последовательности авторизации WM**](wm-cap-sequence.md) (или макрос [**капкаптуресекуенце**](/windows/desktop/api/Vfw/nf-vfw-capcapturesequence) ) для начала записи.

С помощью параметров по умолчанию \_ последовательность закрепления WM \_ инициирует запись видео-и звукового ввода в файл с именем CAPTURE.AVI. Запись сохраняется до тех пор, пока не произойдет одно из следующих событий:

-   Пользователь нажимает клавишу ESC или кнопку мыши.
-   Приложение останавливает или прерывает операцию записи.
-   Диск заполнен.

В приложении можно запретить потоковую передачу записанных данных в файл, отправив сообщение [**об \_ \_ окончании крепления WM**](wm-cap-stop.md) (или макрос [**капкаптурестоп**](/windows/desktop/api/Vfw/nf-vfw-capcapturestop) ) в окно записи. Можно также прервать операцию записи, отправив сообщение [**об \_ \_ отмене крепления WM**](wm-cap-abort.md) (или макрос [**капкаптуреаборт**](/windows/desktop/api/Vfw/nf-vfw-capcaptureabort) ) в окно записи.

 

 