---
title: Запись потоков в файл
description: Запись потоков в файл
ms.assetid: a3766f8c-aaa6-4fc5-a306-54aee71018f1
keywords:
- Функция Авифилекреатестреам
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 370df08534bbdde870f6d28c828d47935abd80db
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103790308"
---
# <a name="writing-streams-to-a-file"></a>Запись потоков в файл

Кроме того, можно создать файл, содержащий потоки данных, записав новый поток данных в файл.

Новый поток можно создать в новом или существующем файле с помощью функции [**авифилекреатестреам**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream) . Эта функция определяет новый поток согласно характеристикам, описанным в структуре [**авистреаминфо**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) , создает интерфейс потока для нового потока, увеличивает счетчик ссылок потока и возвращает адрес указателя интерфейса потока.

Перед записью содержимого потока необходимо указать формат потока. Формат потока можно задать с помощью функции [**авистреамсетформат**](/windows/desktop/api/Vfw/nf-vfw-avistreamsetformat) . При задании формата видеопотока необходимо указать эту функцию со структурой [**битмапинфо**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) , содержащей соответствующую информацию. При задании формата аудиопотока необходимо указать структуру [**вавеформат**](/windows/win32/api/mmreg/ns-mmreg-waveformat) или [**вавеформатекс**](/windows/win32/api/mmeapi/ns-mmeapi-waveformatex) , содержащую соответствующие сведения. Сведения, которые необходимо передать функции для других типов потоков, зависят от типа потока и обработчика потока.

Вы можете записать мультимедийное содержимое в поток с помощью функции [**авистреамврите**](/windows/desktop/api/Vfw/nf-vfw-avistreamwrite) . Эта функция копирует необработанные данные из буфера, предоставляемого приложением, в указанный поток. Обработчик файла AVI по умолчанию добавляет сведения в конец потока. Обработчик волн по умолчанию может записывать аудиоданные-аудио в потоке, а также в конец потока.

Дополнительные сведения о файле или потоке, которые не включаются в функцию [**авифилекреатестреам**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream) или [**авистреамсетформат**](/windows/desktop/api/Vfw/nf-vfw-avistreamsetformat) , можно записать с помощью функций [**авифилевритедата**](/windows/desktop/api/Vfw/nf-vfw-avifilewritedata) и [**авистреамвритедата**](/windows/desktop/api/Vfw/nf-vfw-avistreamwritedata) . Данные, применимые ко всему файлу, например сведения об авторских правах и журнале изменений, можно записать с помощью **авифилевритедата**. Данные, относящиеся к потокам, такие как сжатие и распаковку, можно записать с помощью **авистреамвритедата**. Дополнительные сведения хранятся в отдельных блоках внутри файла.

Вы можете закрыть поток после завершения записи в новый поток с помощью функции [**авистреамрелеасе**](/windows/desktop/api/Vfw/nf-vfw-avistreamrelease) . Эта функция очищает буферы, используемые при записи потоковых данных, и завершает и закрывает все неполные фрагменты данных в файле.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Потоковые операции](stream-operations.md)
</dt> </dl>

 

 