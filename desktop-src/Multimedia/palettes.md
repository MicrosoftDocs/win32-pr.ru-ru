---
title: Палитр
description: Палитр
ms.assetid: ee048f9a-3036-40dc-a6d7-f612b9ef767c
keywords:
- Дравдиб, палитры
- Функция Дравдибреализе
- Функция Дравдибдрав
- Функция Дравдибсетпалетте
- Функция Дравдибжетпалетте
- Функция Дравдибчанжепалетте
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5935831d8996c424a386f86082282f9cf7c1c12
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987466"
---
# <a name="palettes"></a><span data-ttu-id="44a77-109">Палитр</span><span class="sxs-lookup"><span data-stu-id="44a77-109">Palettes</span></span>

<span data-ttu-id="44a77-110">Для функций Дравдиб требуется, чтобы приложение отвечало на два сообщения, ориентированные на палитру: [**WM \_ Куериневпалетте**](/windows/desktop/gdi/wm-querynewpalette) и [**WM \_ палеттечанжед**](/windows/desktop/gdi/wm-palettechanged).</span><span class="sxs-lookup"><span data-stu-id="44a77-110">The DrawDib functions require that an application respond to two palette-oriented messages: [**WM\_QUERYNEWPALETTE**](/windows/desktop/gdi/wm-querynewpalette) and [**WM\_PALETTECHANGED**](/windows/desktop/gdi/wm-palettechanged).</span></span> <span data-ttu-id="44a77-111">Если приложение не поддерживает палитру, необходимо добавить обработчик для каждого из этих сообщений.</span><span class="sxs-lookup"><span data-stu-id="44a77-111">If your application is not palette-aware, you will need to add a handler for each of these messages.</span></span> <span data-ttu-id="44a77-112">Дополнительные сведения об обработке сообщений **WM \_ Куериневпалетте** и **WM \_ Палеттечанжед** см. в разделе [Добавление обработчиков сообщений для палитры](adding-palette-message-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="44a77-112">For more information about processing the **WM\_QUERYNEWPALETTE** and **WM\_PALETTECHANGED** messages, see [Adding Palette Message Handlers](adding-palette-message-handlers.md).</span></span>

<span data-ttu-id="44a77-113">Вы можете реализовать текущую палитру Дравдиб для контроллера домена с помощью функции [**дравдибреализе**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) .</span><span class="sxs-lookup"><span data-stu-id="44a77-113">You can realize the current DrawDib palette to the DC by using the [**DrawDibRealize**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) function.</span></span> <span data-ttu-id="44a77-114">Необходимо реализовать палитру в ответ на сообщение [**WM \_ Куериневпалетте**](/windows/desktop/gdi/wm-querynewpalette) или [**WM \_ палеттечанжед**](/windows/desktop/gdi/wm-palettechanged) или при подготовке к отображению последовательности изображений с помощью функции [**дравдибдрав**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) .</span><span class="sxs-lookup"><span data-stu-id="44a77-114">You should realize the palette in response to the [**WM\_QUERYNEWPALETTE**](/windows/desktop/gdi/wm-querynewpalette) or [**WM\_PALETTECHANGED**](/windows/desktop/gdi/wm-palettechanged) message, or when you prepare to display an image sequence by using the [**DrawDibDraw**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) function.</span></span>

<span data-ttu-id="44a77-115">Изображение, сопоставленное с другой палитрой, можно нарисовать с помощью функции [**дравдибсетпалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) .</span><span class="sxs-lookup"><span data-stu-id="44a77-115">You can draw an image mapped to another palette by using the [**DrawDibSetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) function.</span></span> <span data-ttu-id="44a77-116">Эта функция заставляет Дравдиб DC использовать указанную палитру, которая может повлиять на качество изображения.</span><span class="sxs-lookup"><span data-stu-id="44a77-116">This function forces the DrawDib DC to use the specified palette, which can affect the image quality.</span></span> <span data-ttu-id="44a77-117">Например, приложение, которое поддерживает палитру, может быть реализовано в виде палитры и должно препятствовать реализации собственной палитры Дравдиб.</span><span class="sxs-lookup"><span data-stu-id="44a77-117">For example, an application that is palette-aware might have realized a palette and needs to prevent DrawDib from realizing its own palette.</span></span> <span data-ttu-id="44a77-118">Приложение может использовать **дравдибсетпалетте** для уведомления дравдиб используемой палитры.</span><span class="sxs-lookup"><span data-stu-id="44a77-118">The application can use **DrawDibSetPalette** to notify DrawDib of the palette to use.</span></span>

<span data-ttu-id="44a77-119">Вы можете получить маркер текущей основной палитры с помощью функции [**дравдибжетпалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibgetpalette) .</span><span class="sxs-lookup"><span data-stu-id="44a77-119">You can obtain a handle of the current foreground palette by using the [**DrawDibGetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibgetpalette) function.</span></span> <span data-ttu-id="44a77-120">Если приложение использует текущую палитру переднего плана, оно не имеет монопольного использования палитры, а другое приложение может сделать недействительным маркер палитры.</span><span class="sxs-lookup"><span data-stu-id="44a77-120">If your application uses the current foreground palette, it does not have exclusive use of the palette and another application can invalidate the palette handle.</span></span> <span data-ttu-id="44a77-121">Приложение не должно освобождать палитру по завершении ее использования.</span><span class="sxs-lookup"><span data-stu-id="44a77-121">Your application should not free the palette when you finish using it.</span></span> <span data-ttu-id="44a77-122">Освобождение палитры может сделать недействительным маркер палитры для другого приложения.</span><span class="sxs-lookup"><span data-stu-id="44a77-122">Freeing the palette could invalidate the palette handle for another application.</span></span>

<span data-ttu-id="44a77-123">Вы можете подготовить Дравдиб для получения новых значений цвета для палитры с помощью функции [**дравдибчанжепалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibchangepalette) .</span><span class="sxs-lookup"><span data-stu-id="44a77-123">You can prepare DrawDib to receive new color values for its palette by using the [**DrawDibChangePalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibchangepalette) function.</span></span> <span data-ttu-id="44a77-124">В коде, приведенном ниже **дравдибчанжепалетте**, вы назначаете новые значения для таблицы цветов палитры.</span><span class="sxs-lookup"><span data-stu-id="44a77-124">In the code following **DrawDibChangePalette**, you assign new values for the palette color table.</span></span> <span data-ttu-id="44a77-125">Если флаг **\_ анимации DDF** не установлен в дравдиб DC при вызове **дравдибчанжепалетте**, можно применить изменения палитры с помощью [**дравдибреализе**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) , чтобы реализовать палитру.</span><span class="sxs-lookup"><span data-stu-id="44a77-125">If the **DDF\_ANIMATE** flag is not set in the DrawDib DC when you call **DrawDibChangePalette**, you can enact the palette changes by using [**DrawDibRealize**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) to realize the palette.</span></span> <span data-ttu-id="44a77-126">Затем можно использовать [**дравдибдрав**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) для перерисовки изображения.</span><span class="sxs-lookup"><span data-stu-id="44a77-126">You can then use [**DrawDibDraw**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) to redraw the image.</span></span> <span data-ttu-id="44a77-127">Если в Дравдиб DC установлен флаг **\_ анимации DDF** , можно анимировать палитру и цвета отображаемого растрового изображения с помощью **дравдибдрав** или **дравдибреализе**.</span><span class="sxs-lookup"><span data-stu-id="44a77-127">If the **DDF\_ANIMATE** flag is set in the DrawDib DC, you can animate the palette and the colors of the displayed bitmap by using **DrawDibDraw** or **DrawDibRealize**.</span></span> <span data-ttu-id="44a77-128">Флаг **\_ анимации DDF** можно обновить с помощью функций [**дравдибенд**](/windows/desktop/api/Vfw/nf-vfw-drawdibend) и [**дравдиббегин**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) .</span><span class="sxs-lookup"><span data-stu-id="44a77-128">You can update the **DDF\_ANIMATE** flag by using the [**DrawDibEnd**](/windows/desktop/api/Vfw/nf-vfw-drawdibend) and [**DrawDibBegin**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) functions.</span></span>

> [!Note]  
> <span data-ttu-id="44a77-129">Если вы освободите палитру Дравдиб, пока она выбрана контроллером домена, то при использовании этой палитры контроллер домена может вызвать ошибку интерфейса графических устройств (GDI).</span><span class="sxs-lookup"><span data-stu-id="44a77-129">If you free the DrawDib palette while it is selected by a DC, a graphics device interface (GDI) error can result when the DC uses the palette.</span></span> <span data-ttu-id="44a77-130">Вместо этого приложение должно использовать [**дравдибсетпалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) , чтобы изменить дравдиб DC для использования палитры по умолчанию или другой палитры.</span><span class="sxs-lookup"><span data-stu-id="44a77-130">Instead, your application should use [**DrawDibSetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) to change the DrawDib DC to use the default palette or another palette.</span></span>

 

<span data-ttu-id="44a77-131">Функции [**дравдибенд**](/windows/desktop/api/Vfw/nf-vfw-drawdibend), [**дравдибклосе**](/windows/desktop/api/Vfw/nf-vfw-drawdibclose)и [**Дравдиббегин**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) могут освободить палитру дравдиб.</span><span class="sxs-lookup"><span data-stu-id="44a77-131">The [**DrawDibEnd**](/windows/desktop/api/Vfw/nf-vfw-drawdibend), [**DrawDibClose**](/windows/desktop/api/Vfw/nf-vfw-drawdibclose), and [**DrawDibBegin**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) functions can free the DrawDib palette.</span></span> <span data-ttu-id="44a77-132">Однако эти функции следует использовать только в том случае, если эта палитра не была выбрана контроллером домена.</span><span class="sxs-lookup"><span data-stu-id="44a77-132">However, these functions should be used only when the palette has not been selected by the DC.</span></span> <span data-ttu-id="44a77-133">Функция Дравдибдрав также может освободить палитру, если она использует тот же Дравдиб контроллер домена, но определяет различные параметры рисования (*лпби*, *дксдст*, *дидст*, *дкссрк* или *дисрк*) или другой формат.</span><span class="sxs-lookup"><span data-stu-id="44a77-133">The DrawDibDraw function can also free the palette when it uses the same DrawDib DC, but specifies different drawing parameters (*lpbi*, *dxDst*, *dyDst*, *dxSrc*, or *dySrc*) or a different format.</span></span>

## <a name="related-topics"></a><span data-ttu-id="44a77-134">См. также</span><span class="sxs-lookup"><span data-stu-id="44a77-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="44a77-135">Рендеринг изображений</span><span class="sxs-lookup"><span data-stu-id="44a77-135">Image Rendering</span></span>](image-rendering.md)
</dt> </dl>

 

 