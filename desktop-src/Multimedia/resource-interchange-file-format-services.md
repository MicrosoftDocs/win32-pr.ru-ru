---
title: Службы формата файлов обмена ресурсами
description: Службы формата файлов обмена ресурсами
ms.assetid: 8526794b-7b40-470f-94f7-935d7dbf9151
keywords:
- файловый ввод-вывод в формате мультимедиа, формат файла обмена ресурсами (Metallica)
- файловый ввод-вывод, формат файла обмена ресурсами (Metallica)
- входные и выходные данные (ввод-вывод), формат файла обмена ресурсами (Metallica)
- Ввод-вывод (входные и выходные данные), формат файла обмена ресурсами (Metallica)
- Функция Ммиупен
- формат файла обмена ресурсами (Metallica)
- Metallica (формат файла обмена ресурсами)
- ВВОД-ВЫВОД METALLICA
- Фрагмент Metallica
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 50cca3792ccded248951065c7b69f2e50d27e0ba
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104336868"
---
# <a name="resource-interchange-file-format-services"></a><span data-ttu-id="c92c1-112">Службы формата файлов обмена ресурсами</span><span class="sxs-lookup"><span data-stu-id="c92c1-112">Resource Interchange File Format Services</span></span>

<span data-ttu-id="c92c1-113">Для файлов мультимедиа предпочтительным форматом является формат файла обмена ресурсами (Metallica).</span><span class="sxs-lookup"><span data-stu-id="c92c1-113">The preferred format for multimedia files is resource interchange file format (RIFF).</span></span> <span data-ttu-id="c92c1-114">Функции файлового ввода-вывода Metallica работают с базовыми буферизованными и небуферизованными файловыми службами ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="c92c1-114">The RIFF file I/O functions work with the basic buffered and unbuffered file I/O services.</span></span> <span data-ttu-id="c92c1-115">Файлы Metallica можно открывать, читать и записывать так же, как и другие типы файлов.</span><span class="sxs-lookup"><span data-stu-id="c92c1-115">You can open, read, and write RIFF files in the same way as other file types.</span></span> <span data-ttu-id="c92c1-116">Подробные сведения о Metallica см. в разделе [функции и макросы авифиле](avifile-functions-and-macros.md).</span><span class="sxs-lookup"><span data-stu-id="c92c1-116">For detailed information about RIFF, see [AVIFile Functions and Macros](avifile-functions-and-macros.md).</span></span>

<span data-ttu-id="c92c1-117">Metallica-файлы используют четыре символа для поиска элементов файла.</span><span class="sxs-lookup"><span data-stu-id="c92c1-117">RIFF files use four-character codes to identify file elements.</span></span> <span data-ttu-id="c92c1-118">Эти коды представляют собой 32-битные количества, представляющие последовательность из одного до четырех буквенно-цифровых символов ASCII, дополненную справа символами пробела.</span><span class="sxs-lookup"><span data-stu-id="c92c1-118">These codes are 32-bit quantities representing a sequence of one to four ASCII alphanumeric characters, padded on the right with space characters.</span></span> <span data-ttu-id="c92c1-119">Тип данных для кодов из четырех символов — **FourCC**.</span><span class="sxs-lookup"><span data-stu-id="c92c1-119">The data type for four-character codes is **FOURCC**.</span></span> <span data-ttu-id="c92c1-120">Используйте макрос [**ммиофауркк**](/windows/win32/api/vfw/nf-vfw-mmiofourcc) для преобразования четырех символов в код из четырех символов.</span><span class="sxs-lookup"><span data-stu-id="c92c1-120">Use the [**mmioFOURCC**](/windows/win32/api/vfw/nf-vfw-mmiofourcc) macro to convert four characters into a four-character code.</span></span> <span data-ttu-id="c92c1-121">Чтобы преобразовать строку, завершающуюся нулем, в код из четырех символов, используйте функцию [**ммиострингтофауркк**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmiostringtofourcc) .</span><span class="sxs-lookup"><span data-stu-id="c92c1-121">To convert a null-terminated string into a four-character code, use the [**mmioStringToFOURCC**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmiostringtofourcc) function.</span></span>

<span data-ttu-id="c92c1-122">Базовый стандартный блок файла Metallica — это *фрагмент*.</span><span class="sxs-lookup"><span data-stu-id="c92c1-122">The basic building block of a RIFF file is a *chunk*.</span></span> <span data-ttu-id="c92c1-123">Фрагмент — это логическая единица мультимедийных данных, например один кадр в видеоролике.</span><span class="sxs-lookup"><span data-stu-id="c92c1-123">A chunk is a logical unit of multimedia data, such as a single frame in a video clip.</span></span> <span data-ttu-id="c92c1-124">Каждый блок содержит следующие поля:</span><span class="sxs-lookup"><span data-stu-id="c92c1-124">Each chunk contains the following fields:</span></span>

-   <span data-ttu-id="c92c1-125">Код из четырех символов, указывающий идентификатор блока</span><span class="sxs-lookup"><span data-stu-id="c92c1-125">A four-character code specifying the chunk identifier</span></span>
-   <span data-ttu-id="c92c1-126">Значение даублеворд, указывающее размер элемента данных в блоке</span><span class="sxs-lookup"><span data-stu-id="c92c1-126">A doubleword value specifying the size of the data member in the chunk</span></span>
-   <span data-ttu-id="c92c1-127">Поле данных</span><span class="sxs-lookup"><span data-stu-id="c92c1-127">A data field</span></span>

<span data-ttu-id="c92c1-128">На следующем рисунке показан фрагмент "Metallica", содержащий два подфрагмента.</span><span class="sxs-lookup"><span data-stu-id="c92c1-128">The following illustration shows a "RIFF" chunk that contains two subchunks.</span></span>

![фрагмент Metallica, содержащий два фрагмента изображения](images/mmio1.gif)

<span data-ttu-id="c92c1-130">Фрагмент, содержащийся в другом фрагменте, является *подблоком*.</span><span class="sxs-lookup"><span data-stu-id="c92c1-130">A chunk contained in another chunk is a *subchunk*.</span></span> <span data-ttu-id="c92c1-131">Единственными фрагментами, которые могут содержать подблокы, являются идентификаторы блоков "Metallica" и "LIST".</span><span class="sxs-lookup"><span data-stu-id="c92c1-131">The only chunks allowed to contain subchunks are those with a chunk identifier of "RIFF" or "LIST".</span></span> <span data-ttu-id="c92c1-132">Фрагмент, содержащий другой фрагмент, называется *родительским фрагментом*.</span><span class="sxs-lookup"><span data-stu-id="c92c1-132">A chunk that contains another chunk is called a *parent chunk*.</span></span> <span data-ttu-id="c92c1-133">Первый фрагмент в файле Metallica должен быть блоком "Metallica".</span><span class="sxs-lookup"><span data-stu-id="c92c1-133">The first chunk in a RIFF file must be a "RIFF" chunk.</span></span> <span data-ttu-id="c92c1-134">Все остальные фрагменты в файле являются подфрагментами фрагмента "Metallica".</span><span class="sxs-lookup"><span data-stu-id="c92c1-134">All other chunks in the file are subchunks of the "RIFF" chunk.</span></span>

<span data-ttu-id="c92c1-135">Фрагменты "Metallica" содержат дополнительное поле в первых четырех байтах поля данных.</span><span class="sxs-lookup"><span data-stu-id="c92c1-135">"RIFF" chunks include an additional field in the first four bytes of the data field.</span></span> <span data-ttu-id="c92c1-136">Это дополнительное поле предоставляет *тип формы* для поля.</span><span class="sxs-lookup"><span data-stu-id="c92c1-136">This additional field provides the *form type* of the field.</span></span> <span data-ttu-id="c92c1-137">Тип формы — это код из четырех символов, идентифицирующий формат данных, хранящихся в файле.</span><span class="sxs-lookup"><span data-stu-id="c92c1-137">The form type is a four-character code identifying the format of the data stored in the file.</span></span> <span data-ttu-id="c92c1-138">Например, файлы Microsoft Wave-Audio имеют тип «WAVE».</span><span class="sxs-lookup"><span data-stu-id="c92c1-138">For example, Microsoft waveform-audio files have a form type of "WAVE".</span></span>

<span data-ttu-id="c92c1-139">Блоки "LIST" также включают дополнительное поле в первые четыре байта поля данных.</span><span class="sxs-lookup"><span data-stu-id="c92c1-139">"LIST" chunks also include an additional field in the first four bytes of the data field.</span></span> <span data-ttu-id="c92c1-140">Это дополнительное поле содержит *тип списка* для поля.</span><span class="sxs-lookup"><span data-stu-id="c92c1-140">This additional field contains the *list type* of the field.</span></span> <span data-ttu-id="c92c1-141">Тип списка — это код из четырех символов, идентифицирующий содержимое списка.</span><span class="sxs-lookup"><span data-stu-id="c92c1-141">The list type is a four-character code identifying the contents of the list.</span></span> <span data-ttu-id="c92c1-142">Например, блок "LIST" со списком "INFO" может содержать фрагменты "ИКОП" и "ИКРД", предоставляющие авторские права и сведения о дате создания.</span><span class="sxs-lookup"><span data-stu-id="c92c1-142">For example, a "LIST" chunk with a list type of "INFO" can contain "ICOP" and "ICRD" chunks providing copyright and creation date information.</span></span> <span data-ttu-id="c92c1-143">На следующем рисунке показан фрагмент "Metallica", содержащий блок "LIST" и один другой подблок (блок "LIST" содержит два подфрагмента).</span><span class="sxs-lookup"><span data-stu-id="c92c1-143">The following illustration shows a "RIFF" chunk that contains a "LIST" chunk and one other subchunk (the "LIST" chunk contains two subchunks).</span></span>

![блок Metallica, содержащий образ блока списка](images/mmio2.gif)

<span data-ttu-id="c92c1-145">Службы файлового ввода-вывода содержат две функции, которые можно использовать для перемещения между фрагментами в файле Metallica: [**ммиоасценд**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmioascend) и [**ммиодесценд**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmiodescend).</span><span class="sxs-lookup"><span data-stu-id="c92c1-145">Multimedia file I/O services include two functions you can use to navigate among chunks in a RIFF file: [**mmioAscend**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmioascend) and [**mmioDescend**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmiodescend).</span></span> <span data-ttu-id="c92c1-146">Эти функции можно использовать как функции верхнего уровня поиска.</span><span class="sxs-lookup"><span data-stu-id="c92c1-146">You can use these functions as high-level seek functions.</span></span> <span data-ttu-id="c92c1-147">При пошаговом выполнении в блоке расположение файла устанавливается в поле данных фрагмента (8 байтов с начала фрагмента).</span><span class="sxs-lookup"><span data-stu-id="c92c1-147">When you descend into a chunk, the file position is set to the data field of the chunk (8 bytes from the beginning of the chunk).</span></span> <span data-ttu-id="c92c1-148">Для фрагментов "Metallica" и "LIST" положение файла устанавливается в расположение, следующее за типом или типом списка (12 байт с начала фрагмента).</span><span class="sxs-lookup"><span data-stu-id="c92c1-148">For "RIFF" and "LIST" chunks, the file position is set to the location following the form type or list type (12 bytes from the beginning of the chunk).</span></span> <span data-ttu-id="c92c1-149">Когда вы выйдете по возрастанию для фрагмента, положение файла устанавливается в расположение после конца фрагмента.</span><span class="sxs-lookup"><span data-stu-id="c92c1-149">When you ascend out of a chunk, the file position is set to the location following the end of the chunk.</span></span>

<span data-ttu-id="c92c1-150">Чтобы создать новый фрагмент, используйте функцию [**ммиокреатечунк**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmiocreatechunk) для записи заголовка блока в текущей позиции в открытом файле.</span><span class="sxs-lookup"><span data-stu-id="c92c1-150">To create a new chunk, use the [**mmioCreateChunk**](/windows/win32/api/mmiscapi/nf-mmiscapi-mmiocreatechunk) function to write a chunk header at the current position in an open file.</span></span> <span data-ttu-id="c92c1-151">Функции **ммиоасценд**, **ммиодесценд** и **ммиокреатечунк** используют структуру [**ммккинфо**](/windows/win32/api/mmiscapi/ns-mmiscapi-mmckinfo) для указания и получения сведений о блоках "Metallica".</span><span class="sxs-lookup"><span data-stu-id="c92c1-151">The **mmioAscend**, **mmioDescend**, and **mmioCreateChunk** functions use the [**MMCKINFO**](/windows/win32/api/mmiscapi/ns-mmiscapi-mmckinfo) structure to specify and retrieve information about "RIFF" chunks.</span></span>

 

 