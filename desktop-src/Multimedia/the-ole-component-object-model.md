---
title: Объектная модель OLE Component
description: Объектная модель OLE Component
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: 52d79b29f3b9933c8bef43207ff80c668a81cb73
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "103987981"
---
# <a name="the-ole-component-object-model"></a><span data-ttu-id="55c2a-103">Объектная модель OLE Component</span><span class="sxs-lookup"><span data-stu-id="55c2a-103">The OLE Component Object Model</span></span>

<span data-ttu-id="55c2a-104">Объекты, используемые библиотекой Авифиле, являются частью модели объектов OLE Component.</span><span class="sxs-lookup"><span data-stu-id="55c2a-104">The objects used by the AVIFile library are all part of the OLE Component Object Model.</span></span> <span data-ttu-id="55c2a-105">В основном это означает, что они совместно используют определенные методы, упрощающие работу с, и возвращаемые ими значения являются общими для большинства методов интерфейса OLE.</span><span class="sxs-lookup"><span data-stu-id="55c2a-105">Primarily, this means they share certain methods that make them easier to work with, and the values they return are common to most OLE interface methods.</span></span>

<span data-ttu-id="55c2a-106">Объектная модель компонента OLE обработчиков файлов и потоков использует интерфейс OLE **IClassFactory** для создания экземпляров класса объектов.</span><span class="sxs-lookup"><span data-stu-id="55c2a-106">The OLE Component Object Model of the file and stream handlers uses the OLE **IClassFactory** interface to create instances of their object class.</span></span> <span data-ttu-id="55c2a-107">Как объекты компонентов, они реализуют интерфейс [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , который состоит из методов [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)и [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) .</span><span class="sxs-lookup"><span data-stu-id="55c2a-107">As component objects, they implement the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface, which consists of the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release), and [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) methods.</span></span> <span data-ttu-id="55c2a-108">Интерфейс **IUnknown** позволяет приложению получать указатели на другие интерфейсы, поддерживаемые одним и тем же объектом.</span><span class="sxs-lookup"><span data-stu-id="55c2a-108">The **IUnknown** interface lets an application obtain pointers to other interfaces supported by the same object.</span></span>

<span data-ttu-id="55c2a-109">Можно определить, поддерживает ли объект определенный интерфейс с помощью метода **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="55c2a-109">You can determine if an object supports a specific interface by using the **QueryInterface** method.</span></span> <span data-ttu-id="55c2a-110">Если объект поддерживает указанный интерфейс, **QueryInterface** возвращает указатель на этот интерфейс.</span><span class="sxs-lookup"><span data-stu-id="55c2a-110">If an object supports a specified interface, **QueryInterface** returns a pointer to that interface.</span></span>

<span data-ttu-id="55c2a-111">Счетчик ссылок, связанный с объектом, можно увеличить и уменьшить с помощью методов [**AddRef**](/previous-versions//dd757100(v=vs.85)) и [**Release**](/previous-versions//dd757102(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="55c2a-111">You can increment and decrement the reference count associated with an object by using the [**AddRef**](/previous-versions//dd757100(v=vs.85)) and [**Release**](/previous-versions//dd757102(v=vs.85)) methods.</span></span> <span data-ttu-id="55c2a-112">Счетчик ссылок позволяет нескольким клиентам обращаться к объекту.</span><span class="sxs-lookup"><span data-stu-id="55c2a-112">The reference count lets multiple clients access an object.</span></span> <span data-ttu-id="55c2a-113">Если объект используется в первом приложении, его счетчик ссылок устанавливается в значение 1.</span><span class="sxs-lookup"><span data-stu-id="55c2a-113">When an object is used by the first application, its reference count is set to 1.</span></span> <span data-ttu-id="55c2a-114">В дальнейшем приложения используют метод **AddRef** для увеличения числа, что позволяет объекту отследить количество обращений к нему.</span><span class="sxs-lookup"><span data-stu-id="55c2a-114">Applications subsequently use the **AddRef** method to increment the count to let the object keep track of the number of times it is accessed.</span></span>

<span data-ttu-id="55c2a-115">Когда приложение выполняется с помощью объекта, оно вызывает метод **Release** для уменьшения числа ссылок.</span><span class="sxs-lookup"><span data-stu-id="55c2a-115">When an application is done using an object, it calls the **Release** method to decrement the reference count.</span></span> <span data-ttu-id="55c2a-116">Если счетчик ссылок равен нулю, объект больше не нужен и освобождает все используемые им **ресурсы и уничтожает** объект.</span><span class="sxs-lookup"><span data-stu-id="55c2a-116">When the reference count is zero, the object is no longer needed and **Release** frees any resources it uses and destroys the object.</span></span> <span data-ttu-id="55c2a-117">Поскольку объект использует внутренние ресурсы, прозрачные для приложения, объект отвечает за их освобождение.</span><span class="sxs-lookup"><span data-stu-id="55c2a-117">Because an object uses internal resources transparent to the application, the object is responsible for freeing them.</span></span> <span data-ttu-id="55c2a-118">Например, обработчику файла может потребоваться закрыть открытые файлы на диске и освободить буфер памяти при освобождении.</span><span class="sxs-lookup"><span data-stu-id="55c2a-118">For example, a file handler might need to close open disk files and free buffer memory when released.</span></span>

<span data-ttu-id="55c2a-119">Большинство методов интерфейса OLE возвращают дескрипторы результатов, определенные с помощью типа данных **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="55c2a-119">Most OLE interface methods return result handles that are defined by using the **HRESULT** data type.</span></span> <span data-ttu-id="55c2a-120">Этот тип данных состоит из кода серьезности, контекстной информации, кода средства и кода состояния.</span><span class="sxs-lookup"><span data-stu-id="55c2a-120">This data type is made of a severity code, contextual information, a facility code, and a status code.</span></span> <span data-ttu-id="55c2a-121">Возвращаемый результат, который указывает, что Success имеет нулевое значение.</span><span class="sxs-lookup"><span data-stu-id="55c2a-121">A return result handle that indicates success has the value zero.</span></span> <span data-ttu-id="55c2a-122">Ненулевое значение указывает на сбой, а элемент кода состояния возвращаемого результата представляет собой базу для дополнительной интерпретации.</span><span class="sxs-lookup"><span data-stu-id="55c2a-122">A nonzero value indicates failure and the status code member of the return result handle provides a basis for additional interpretation.</span></span> <span data-ttu-id="55c2a-123">Дополнительные сведения о возможностях возвращаемых дескрипторов OLE см. в *справочнике по программированию OLE*.</span><span class="sxs-lookup"><span data-stu-id="55c2a-123">For additional information about OLE return result handles, see the *OLE Programmer's Reference*.</span></span>

 

 