---
title: Открытие и закрытие потоков
description: Открытие и закрытие потоков
ms.assetid: 7dcaccbe-63d8-410a-ae00-16ce9e252ad0
keywords:
- Функция Авифилежетстреам
- Функция Авистреамрелеасе
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ec4462e261f1480129c073b70ddc61f91a422c8c
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067690"
---
# <a name="opening-and-closing-streams"></a>Открытие и закрытие потоков

Открытие потоков данных похоже на открытие файлов. Вы можете открыть поток с помощью функции [**авифилежетстреам**](/windows/desktop/api/Vfw/nf-vfw-avifilegetstream) . Эта функция создает потоковый интерфейс, размещает в интерфейсе маркер потока и возвращает указатель на интерфейс. **Авифилежетстреам** также поддерживает количество ссылок приложений, открывших поток, но не открыв его.

Если требуется получить доступ к одному потоку в файле, можно открыть файл и поток с помощью функции [**авистреамопенфромфиле**](/windows/desktop/api/Vfw/nf-vfw-avistreamopenfromfilea) . Эта функция сочетает операции и аргументы функции функций [**авифилеопен**](/windows/desktop/api/Vfw/nf-vfw-avifileopen) и **авифилежетстреам** .

Для доступа к более чем одному потоку в файле используйте **авифилеопен** один раз, за которым следует несколько вызовов **авифилежетстреам**.

Можно увеличить счетчик ссылок в потоке с помощью функции [**авистреамаддреф**](/windows/desktop/api/Vfw/nf-vfw-avistreamaddref) , чтобы оставить поток открытым при использовании функции, которая обычно закрывает поток.

Вы можете закрыть поток с помощью функции [**авистреамрелеасе**](/windows/desktop/api/Vfw/nf-vfw-avistreamrelease) . Эта функция уменьшает значение счетчика ссылок потока и закрывает его, когда счетчик ссылок достигает нуля. Приложения должны сбалансировать количество ссылок, включив вызов **авистреамрелеасе** для каждого использования функции [**авифилежетстреам**](/windows/desktop/api/Vfw/nf-vfw-avifilegetstream), [**авифилекреатестреам**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream), **авистреамаддреф** или **авистреамопенфромфиле** . При освобождении потока, открытого с помощью **авистреамопенфромфиле**, авифиле закрывает файл, содержащий поток. Если приложение освобождает файл с открытыми потоками данных, Авифиле не закрывает потоки до тех пор, пока не будут освобождены все потоки.

 

 




