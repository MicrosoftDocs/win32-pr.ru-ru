---
title: Потоковая передача данных с устройства MCI
description: Потоковая передача данных с устройства MCI
ms.assetid: 44cbf375-f97e-426a-a703-dfb1b1933138
keywords:
- MCI (интерфейс управления мультимедийными файлами), потоковая передача данных
- Сообщение WM_CAP_SET_MCI_DEVICE
- макрос КапсетмЦидевиценаме
- Сообщение WM_CAP_GET_MCI_DEVICE
- макрос КапжетмЦидевиценаме
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab8cf358a87a812024328abf7fc1aae0509a126f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104532360"
---
# <a name="streaming-capture-from-an-mci-device"></a><span data-ttu-id="0ac50-108">Потоковая передача данных с устройства MCI</span><span class="sxs-lookup"><span data-stu-id="0ac50-108">Streaming Capture from an MCI Device</span></span>

<span data-ttu-id="0ac50-109">Устройства MCI дополняют операцию записи в режиме записи в реальном времени и записи кадров.</span><span class="sxs-lookup"><span data-stu-id="0ac50-109">MCI devices augment the capture operation in real-time capture and step-frame capture.</span></span> <span data-ttu-id="0ac50-110">Вы можете указать устройство MCI, например видеодиск или видеокассету (ВИДЕОМАГНИТОФОН), действующее в качестве источника видео для операции записи, используя сообщение с [**\_ ограничением WM \_ Set \_ MCI \_**](wm-cap-set-mci-device.md) (или макрос [**капсетмЦидевиценаме**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) ) и указав имя устройства.</span><span class="sxs-lookup"><span data-stu-id="0ac50-110">You can specify the MCI device, such as a videodisc or video-cassette recorder (VCR), acting as the video source for your capture operation by using the [**WM\_CAP\_SET\_MCI\_DEVICE**](wm-cap-set-mci-device.md) message (or the [**capSetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) macro) and specifying the name of the device.</span></span> <span data-ttu-id="0ac50-111">Вы также можете получить имя устройства, установленное в данный момент, с помощью сообщения с [**\_ ограничением WM \_ Получение \_ \_ Устройства MCI**](wm-cap-get-mci-device.md) (или макроса [**капжетмЦидевиценаме**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) ).</span><span class="sxs-lookup"><span data-stu-id="0ac50-111">You can also retrieve the device name currently set by using the [**WM\_CAP\_GET\_MCI\_DEVICE**](wm-cap-get-mci-device.md) message (or the [**capGetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) macro).</span></span>

<span data-ttu-id="0ac50-112">В режиме записи в реальном времени окно записи синхронизирует операцию записи и компенсирует задержки, связанные с расположением источника видео MCI и инициализацией ресурсов (например, буферов записи), необходимых для записи данных.</span><span class="sxs-lookup"><span data-stu-id="0ac50-112">In real-time capture, the capture window synchronizes the capture operation and compensates for delays associated with positioning the MCI video source and initializing the resources (such as capture buffers) required for capturing data.</span></span> <span data-ttu-id="0ac50-113">Окно Capture (захват) ожидает установки в системе допустимого видеоустройства MCI для записи данных таким способом.</span><span class="sxs-lookup"><span data-stu-id="0ac50-113">The capture window expects a valid MCI video device to be installed in the system for capturing data this way.</span></span>

<span data-ttu-id="0ac50-114">Спецификации для управления устройством MCI хранятся в элементах структуры [**каптурепармс**](/windows/win32/api/vfw/ns-vfw-captureparms) .</span><span class="sxs-lookup"><span data-stu-id="0ac50-114">Specifications for controlling an MCI device are stored in the members of the [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) structure.</span></span> <span data-ttu-id="0ac50-115">Источники видео, совместимые с MCI, включают видеомагнитофоны и ласердискс.</span><span class="sxs-lookup"><span data-stu-id="0ac50-115">MCI-compatible video sources include VCRs and laserdiscs.</span></span> <span data-ttu-id="0ac50-116">Если элемент **фмЦиконтрол** этой структуры имеет значение **true**, окно отслеживания координирует операцию MCI.</span><span class="sxs-lookup"><span data-stu-id="0ac50-116">If the **fMCIControl** member of this structure is set to **TRUE**, the capture window coordinates MCI operation.</span></span> <span data-ttu-id="0ac50-117">Окно Capture использует параметры, указанные в члене **двмЦистарттиме** и **двмЦистоптиме** , чтобы получить начальные и конечные позиции последовательности в миллисекундах.</span><span class="sxs-lookup"><span data-stu-id="0ac50-117">The capture window uses the parameters specified in the **dwMCIStartTime** and **dwMCIStopTime** members to obtain the starting and stopping positions, in milliseconds, of the sequence.</span></span> <span data-ttu-id="0ac50-118">Если значение **фмЦиконтрол** равно **false**, источник видео не рассматривается как устройство MCI, а содержимое **двмЦистарттиме** и **двмЦистоптиме** игнорируется.</span><span class="sxs-lookup"><span data-stu-id="0ac50-118">If the value of **fMCIControl** is **FALSE**, the video source is not treated as an MCI device and the contents of **dwMCIStartTime** and **dwMCIStopTime** are ignored.</span></span>

<span data-ttu-id="0ac50-119">Проигрыватель мультимедиа можно использовать для быстрой проверки правильности подключения видеоустройства MCI к системе.</span><span class="sxs-lookup"><span data-stu-id="0ac50-119">You can use Media Player to quickly verify that an MCI video device is properly connected to the system.</span></span> <span data-ttu-id="0ac50-120">Воспроизведение устройства с помощью проигрывателя мультимедиа проверяет правильность конфигурации MCI для устройства.</span><span class="sxs-lookup"><span data-stu-id="0ac50-120">Playing a device with Media Player verifies that the MCI configuration for the device is correct.</span></span> <span data-ttu-id="0ac50-121">Если изображение отображается на дисплее, то источник видео правильно подключен к оборудованию для записи.</span><span class="sxs-lookup"><span data-stu-id="0ac50-121">If an image appears on the video display, the video source is connected properly to the capture hardware.</span></span>

<span data-ttu-id="0ac50-122">На шаге запись кадров окно записи синхронизирует операцию записи и компенсирует задержки, связанные с расположением источника видео MCI и инициализацией ресурсов, необходимых для записи данных.</span><span class="sxs-lookup"><span data-stu-id="0ac50-122">In step-frame capture, the capture window synchronizes the capture operation and compensates for the delays associated with positioning the MCI video source and initializing the resources required for capturing data.</span></span> <span data-ttu-id="0ac50-123">Кроме того, окно Capture (захват) гарантирует, что никакие кадры не удаляются; Он проходит через видеоматериалы по отдельности, гарантируя, что кадр записывается и сохраняется перед записью следующего кадра в потоке видео.</span><span class="sxs-lookup"><span data-stu-id="0ac50-123">In addition, the capture window ensures that no frames are dropped; it steps through the video frames individually, ensuring that the frame is captured and stored before capturing the next frame in the video stream.</span></span>

<span data-ttu-id="0ac50-124">Спецификации для управления записью промежуточных кадров хранятся в элементах структуры [**каптурепармс**](/windows/win32/api/vfw/ns-vfw-captureparms) .</span><span class="sxs-lookup"><span data-stu-id="0ac50-124">Specifications for controlling step-frame capture are stored in the members of the [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) structure.</span></span> <span data-ttu-id="0ac50-125">В дополнение к элементам, используемым для записи в режиме реального времени, в записи о кадрах используются следующие элементы: **фстепмЦидевице**, **fStepCaptureAt2x** и **встепкаптуреаверажефрамес**.</span><span class="sxs-lookup"><span data-stu-id="0ac50-125">Step-frame capture uses the following members in addition to the members used for real-time capture: **fStepMCIDevice**, **fStepCaptureAt2x**, and **wStepCaptureAverageFrames**.</span></span> <span data-ttu-id="0ac50-126">Если для элемента **фстепмЦидевице** задано **значение true**, окно отслеживания координирует запись кадра.</span><span class="sxs-lookup"><span data-stu-id="0ac50-126">If the **fStepMCIDevice** member is set to **TRUE**, the capture window coordinates step-frame capture.</span></span> <span data-ttu-id="0ac50-127">В окне отслеживания используются параметры, указанные в элементах **двмЦистарттиме** и **двмЦистоптиме** , для начальной и останавливаемой позиций последовательности в миллисекундах.</span><span class="sxs-lookup"><span data-stu-id="0ac50-127">The capture window uses the parameters specified in the **dwMCIStartTime** and **dwMCIStopTime** members for the starting and stopping positions, in milliseconds, of the sequence.</span></span> <span data-ttu-id="0ac50-128">В окне Capture (захват) используется **fStepCaptureAt2x** , чтобы определить, должно ли оборудование для записи записывать видеокадры в два раза больше обычного разрешения, и использовать **встепкаптуреаверажефрамес** для указания числа выборки каждого кадра в операции записи.</span><span class="sxs-lookup"><span data-stu-id="0ac50-128">The capture window uses **fStepCaptureAt2x** to determine if the capture hardware should capture video frames at twice the normal resolution and uses **wStepCaptureAverageFrames** to specify the number of times each frame in the capture operation is sampled.</span></span>

<span data-ttu-id="0ac50-129">Если **фстепмЦидевице** имеет **значение false**, запись в режиме реального времени используется вместо записи кадра этапа, а содержимое **fStepCaptureAt2x** и **встепкаптуреаверажефрамес** игнорируется.</span><span class="sxs-lookup"><span data-stu-id="0ac50-129">If **fStepMCIDevice** is **FALSE**, real-time capture is used instead of step-frame capture and the contents of **fStepCaptureAt2x**, and **wStepCaptureAverageFrames** are ignored.</span></span>

<span data-ttu-id="0ac50-130">Если задано создание фрагмента шага, а для **fStepCaptureAt2x** задано **значение true**, запись данных о оборудовании будет записана в два раза больше указанного разрешения.</span><span class="sxs-lookup"><span data-stu-id="0ac50-130">If a step-frame capture is specified and **fStepCaptureAt2x** is set to **TRUE**, the capture hardware captures at twice the specified resolution.</span></span> <span data-ttu-id="0ac50-131">(Разрешения как по высоте, так и к ширине являются двойными.) Программное обеспечение интерполирует пикселы изображения с более высоким разрешением для создания изображения с указанным разрешением.</span><span class="sxs-lookup"><span data-stu-id="0ac50-131">(The resolutions of both the height and width are doubled.) The software interpolates the pixels in the higher resolution image to produce the image at the specified resolution.</span></span> <span data-ttu-id="0ac50-132">Такая форма усреднения может улучшить определение пограничных изображений в кадре.</span><span class="sxs-lookup"><span data-stu-id="0ac50-132">This form of averaging can improve the edge definition of images in a frame.</span></span> <span data-ttu-id="0ac50-133">Этот параметр можно включить, если оборудование не поддерживает децимации на основе оборудования и выполняется запись в формате RGB.</span><span class="sxs-lookup"><span data-stu-id="0ac50-133">You can enable this option if the hardware does not support hardware-based decimation and you are capturing in the RGB format.</span></span>

> [!Note]  
> <span data-ttu-id="0ac50-134">Если оборудование поддерживает децимации с аппаратным обеспечением, оно может захватывать выборки с более высокой скоростью, чем указано, и использовать эти дополнительные примеры для получения определений цветов, которые более согласуются с исходным изображением.</span><span class="sxs-lookup"><span data-stu-id="0ac50-134">If your hardware supports hardware-based decimation, it can capture samples at a higher rate than specified and use these additional samples to obtain color definitions that are more consistent with the original image.</span></span> <span data-ttu-id="0ac50-135">Дополнительные образцы удаляются после их использования, а оборудование передает образцы в драйвер записи по указанной ставке.</span><span class="sxs-lookup"><span data-stu-id="0ac50-135">The additional samples are discarded after they are used, and the hardware passes samples to the capture driver at the specified rate.</span></span>

 

<span data-ttu-id="0ac50-136">Если задается запись шага-кадра, элемент **встепкаптуреаверажефрамес** указывает, сколько раз кадр выдается при создании кадра на основе среднего примера.</span><span class="sxs-lookup"><span data-stu-id="0ac50-136">If a step-frame capture is specified, the **wStepCaptureAverageFrames** member specifies the number of times a frame is sampled when creating a frame based on the average sample.</span></span> <span data-ttu-id="0ac50-137">Эта методика усреднения уменьшает шум случайной цифры, отображаемый в кадре.</span><span class="sxs-lookup"><span data-stu-id="0ac50-137">This averaging technique reduces the random digitization noise appearing in a frame.</span></span> <span data-ttu-id="0ac50-138">Стандартное значение для числа средних значений равно 5.</span><span class="sxs-lookup"><span data-stu-id="0ac50-138">A typical value for the number of averages is 5.</span></span>

<span data-ttu-id="0ac50-139">Дополнительные сведения о MCI см. в разделе [MCI](mci.md).</span><span class="sxs-lookup"><span data-stu-id="0ac50-139">For more information about MCI, see [MCI](mci.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="0ac50-140">См. также</span><span class="sxs-lookup"><span data-stu-id="0ac50-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0ac50-141">Варианты захвата</span><span class="sxs-lookup"><span data-stu-id="0ac50-141">Capture Variations</span></span>](capture-variations.md)
</dt> </dl>

 

 




