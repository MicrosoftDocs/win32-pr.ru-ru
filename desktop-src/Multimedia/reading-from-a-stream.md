---
title: Чтение из потока
description: Чтение из потока
ms.assetid: be961f06-cf5f-4093-9b31-7d1d69e62fec
keywords:
- Функция Авистреаминфо
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3cc7ecd606a33503557e7c7209bff68015756523
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987507"
---
# <a name="reading-from-a-stream"></a><span data-ttu-id="99573-104">Чтение из потока</span><span class="sxs-lookup"><span data-stu-id="99573-104">Reading from a Stream</span></span>

<span data-ttu-id="99573-105">Сведения о открытом потоке можно получить с помощью функции [**авистреаминфо**](/windows/desktop/api/Vfw/nf-vfw-avistreaminfoa) .</span><span class="sxs-lookup"><span data-stu-id="99573-105">You can retrieve information about an open stream by using the [**AVIStreamInfo**](/windows/desktop/api/Vfw/nf-vfw-avistreaminfoa) function.</span></span> <span data-ttu-id="99573-106">Эта функция заполняет структуру [**авистреаминфо**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) данными, такими как тип данных в потоке, метод сжатия, используемый при записи потоковых данных, рекомендуемый размер буфера, скорость воспроизведения и текстовое описание потока.</span><span class="sxs-lookup"><span data-stu-id="99573-106">This function fills the [**AVISTREAMINFO**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) structure with information such as the type of data in the stream, the compression method used when writing stream data, the suggested buffer size, the playback rate, and a text description of the stream.</span></span>

<span data-ttu-id="99573-107">Некоторые элементы структуры [**авистреаминфо**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) также существуют в структуре [**авифилеинфо**](/windows/desktop/api/Vfw/ns-vfw-avifileinfoa) .</span><span class="sxs-lookup"><span data-stu-id="99573-107">Some members of the [**AVISTREAMINFO**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) structure are also present in the [**AVIFILEINFO**](/windows/desktop/api/Vfw/ns-vfw-avifileinfoa) structure.</span></span> <span data-ttu-id="99573-108">Сведения в структуре **авифилеинфо** применяются ко всему файлу.</span><span class="sxs-lookup"><span data-stu-id="99573-108">The information in the **AVIFILEINFO** structure applies to the entire file.</span></span> <span data-ttu-id="99573-109">Сведения в структуре **авистреаминфо** относятся к потоку, доступному для доступа, и имеют приоритет над сведениями в структуре **авифилеинфо** .</span><span class="sxs-lookup"><span data-stu-id="99573-109">The information in the **AVISTREAMINFO** structure is specific to the accessed stream and has precedence over the information in the **AVIFILEINFO** structure.</span></span>

<span data-ttu-id="99573-110">Если с потоком связаны дополнительные сведения, эти сведения можно получить с помощью функции [**авистреамреаддата**](/windows/desktop/api/Vfw/nf-vfw-avistreamreaddata) .</span><span class="sxs-lookup"><span data-stu-id="99573-110">If a stream has supplementary information associated with it, you can retrieve this information by using the [**AVIStreamReadData**](/windows/desktop/api/Vfw/nf-vfw-avistreamreaddata) function.</span></span> <span data-ttu-id="99573-111">Эта функция возвращает сведения в буфер, предоставляемый приложением.</span><span class="sxs-lookup"><span data-stu-id="99573-111">This function returns the information in an application-supplied buffer.</span></span> <span data-ttu-id="99573-112">Дополнительные сведения о потоке могут включать параметры конфигурации для методов сжатия и распаковки, используемых в потоке.</span><span class="sxs-lookup"><span data-stu-id="99573-112">Supplementary stream information might include configuration settings for the compression and decompression methods used on a stream.</span></span> <span data-ttu-id="99573-113">Требуемый размер буфера можно получить с помощью макроса [**авистреамдатасизе**](/windows/desktop/api/Vfw/nf-vfw-avistreamdatasize) .</span><span class="sxs-lookup"><span data-stu-id="99573-113">You can obtain the required buffer size by using the [**AVIStreamDataSize**](/windows/desktop/api/Vfw/nf-vfw-avistreamdatasize) macro.</span></span>

<span data-ttu-id="99573-114">Сведения о форматировании потока можно получить с помощью функции [**авистреамреадформат**](/windows/desktop/api/Vfw/nf-vfw-avistreamreadformat) .</span><span class="sxs-lookup"><span data-stu-id="99573-114">You can retrieve formatting information about a stream by using the [**AVIStreamReadFormat**](/windows/desktop/api/Vfw/nf-vfw-avistreamreadformat) function.</span></span> <span data-ttu-id="99573-115">Эта функция возвращает структуру, относящуюся к потоку, в буфер, предоставляемый приложением.</span><span class="sxs-lookup"><span data-stu-id="99573-115">This function returns a stream-specific structure in an application-supplied buffer.</span></span> <span data-ttu-id="99573-116">Для потока видео буфер содержит сведения о форматировании в структуре [**битмапинфо**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) .</span><span class="sxs-lookup"><span data-stu-id="99573-116">For a video stream, the buffer contains formatting information in a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure.</span></span> <span data-ttu-id="99573-117">Для аудиопотока в буфере содержатся сведения о форматировании в структуре [**вавеформатекс**](/windows/win32/api/mmeapi/ns-mmeapi-waveformatex) или [**пкмвавеформат**](/windows/win32/api/mmreg/ns-mmreg-pcmwaveformat) .</span><span class="sxs-lookup"><span data-stu-id="99573-117">For an audio stream, the buffer contains formatting information in a [**WAVEFORMATEX**](/windows/win32/api/mmeapi/ns-mmeapi-waveformatex) or [**PCMWAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-pcmwaveformat) structure.</span></span> <span data-ttu-id="99573-118">Для других типов потоков обработчик потока возвращает сведения, относящиеся к потоку.</span><span class="sxs-lookup"><span data-stu-id="99573-118">For other stream types, the stream handler returns information specific to the stream.</span></span> <span data-ttu-id="99573-119">Требуемый размер буфера можно определить с помощью **авистреамреадформат** и указав **пустой** адрес буфера или с помощью макроса [**авистреамформатсизе**](/windows/desktop/api/Vfw/nf-vfw-avistreamformatsize) .</span><span class="sxs-lookup"><span data-stu-id="99573-119">You can determine the required buffer size by using **AVIStreamReadFormat** and specifying a **NULL** buffer address or by using the [**AVIStreamFormatSize**](/windows/desktop/api/Vfw/nf-vfw-avistreamformatsize) macro.</span></span>

<span data-ttu-id="99573-120">Содержимое мультимедиа можно получить в потоке с помощью функции [**авистреамреад**](/windows/desktop/api/Vfw/nf-vfw-avistreamread) .</span><span class="sxs-lookup"><span data-stu-id="99573-120">You can retrieve the multimedia content in a stream by using the [**AVIStreamRead**](/windows/desktop/api/Vfw/nf-vfw-avistreamread) function.</span></span> <span data-ttu-id="99573-121">Эта функция копирует необработанные данные из потока в предоставляемый приложением буфер.</span><span class="sxs-lookup"><span data-stu-id="99573-121">This function copies raw data from the stream into an application-supplied buffer.</span></span> <span data-ttu-id="99573-122">Для видеопотоков эта функция получает растровые изображения, составляющие содержимое фрейма.</span><span class="sxs-lookup"><span data-stu-id="99573-122">For video streams, this function retrieves the bitmapped images that make up the frame content.</span></span> <span data-ttu-id="99573-123">Для звуковых потоков эта функция получает образцы аудио-звука, которые составляют звуковое содержимое.</span><span class="sxs-lookup"><span data-stu-id="99573-123">For audio streams, this function retrieves waveform-audio samples that make up the sound content.</span></span> <span data-ttu-id="99573-124">Требуемый размер буфера можно определить с помощью **авистреамреад** и указав **пустой** адрес буфера или с помощью макроса [**авистреамсамплесизе**](/windows/desktop/api/Vfw/nf-vfw-avistreamsamplesize) .</span><span class="sxs-lookup"><span data-stu-id="99573-124">You can determine the required buffer size by using **AVIStreamRead** and specifying a **NULL** buffer address or by using the [**AVIStreamSampleSize**](/windows/desktop/api/Vfw/nf-vfw-avistreamsamplesize) macro.</span></span>

<span data-ttu-id="99573-125">Некоторые обработчики потока AVI представляют задержки, связанные с инициализацией программного обеспечения и оборудованием или координацией.</span><span class="sxs-lookup"><span data-stu-id="99573-125">Some AVI stream handlers introduce delays associated with software and hardware initialization or coordination.</span></span> <span data-ttu-id="99573-126">Эти обработчики можно сообщить, чтобы подготовиться к потоковой передаче данных с помощью функции [**авистреамбегинстреаминг**](/windows/desktop/api/Vfw/nf-vfw-avistreambeginstreaming) .</span><span class="sxs-lookup"><span data-stu-id="99573-126">You can inform these handlers to prepare for data streaming by using the [**AVIStreamBeginStreaming**](/windows/desktop/api/Vfw/nf-vfw-avistreambeginstreaming) function.</span></span> <span data-ttu-id="99573-127">Эта функция позволяет обработчику потока выделять и инициализировать необходимые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="99573-127">This function lets the stream handler allocate and initialize the resources it needs.</span></span> <span data-ttu-id="99573-128">Чтобы проинформировать эти обработчики о завершении потоковой передачи, используйте функцию [**авистреамендстреаминг**](/windows/desktop/api/Vfw/nf-vfw-avistreamendstreaming) .</span><span class="sxs-lookup"><span data-stu-id="99573-128">To inform these handlers when streaming has ended, use the [**AVIStreamEndStreaming**](/windows/desktop/api/Vfw/nf-vfw-avistreamendstreaming) function.</span></span> <span data-ttu-id="99573-129">Эта функция позволяет обработчику потока освобождать ресурсы, выделенные для **авистреамбегинстреаминг**.</span><span class="sxs-lookup"><span data-stu-id="99573-129">This function lets the stream handler deallocate the resources it allocated for **AVIStreamBeginStreaming**.</span></span>

<span data-ttu-id="99573-130">Функция [**авистреамреад**](/windows/desktop/api/Vfw/nf-vfw-avistreamread) не предоставляет службы распаковки.</span><span class="sxs-lookup"><span data-stu-id="99573-130">The [**AVIStreamRead**](/windows/desktop/api/Vfw/nf-vfw-avistreamread) function does not provide decompression services.</span></span> <span data-ttu-id="99573-131">Сведения о сжатии и распаковке звуковых потоков см. в разделе [Диспетчер аудиосжатия](audio-compression-manager.md).</span><span class="sxs-lookup"><span data-stu-id="99573-131">For information about compressing and decompressing audio streams, see [Audio Compression Manager](audio-compression-manager.md).</span></span> <span data-ttu-id="99573-132">Сведения о сжатии и распаковке видеопотоков см. в разделе [Диспетчер сжатия видео](video-compression-manager.md).</span><span class="sxs-lookup"><span data-stu-id="99573-132">For information about compressing and decompressing video streams, see [Video Compression Manager](video-compression-manager.md).</span></span> <span data-ttu-id="99573-133">Сведения о сжатии и распаковке отдельных кадров в видеопотоке см. в разделе [Работа с сжатыми видео-данными в потоке](working-with-compressed-video-data-in-a-stream.md).</span><span class="sxs-lookup"><span data-stu-id="99573-133">For information about compressing and decompressing individual frames in a video stream, see [Working with Compressed Video Data in a Stream](working-with-compressed-video-data-in-a-stream.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="99573-134">См. также</span><span class="sxs-lookup"><span data-stu-id="99573-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="99573-135">Потоковые операции</span><span class="sxs-lookup"><span data-stu-id="99573-135">Stream Operations</span></span>](stream-operations.md)
</dt> </dl>

 

 