---
title: Ярлыки и варианты команд
description: Ярлыки и варианты команд
ms.assetid: 4f854c78-435c-4a10-8938-645ad605fff3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a82ce41aaa9cc5744a2f199a7f7761111734e848
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103778065"
---
# <a name="command-shortcuts-and-variations"></a>Ярлыки и варианты команд

При работе с командами MCI можно использовать несколько сочетаний клавиш. Эти сочетания клавиш позволяют использовать один идентификатор для ссылки на все устройства, открытые приложением, или для открытия устройства без явного [**запуска команды Open**](open.md) ([**MCI \_ Open**](mci-open.md)).

\_ \_ \_ Для любой команды, не возвращающей сведения, можно указать значение "ALL" (идентификатор устройства MCI) в качестве идентификатора устройства. При указании «ALL» MCI отправляет команду последовательно на все устройства, открытые текущим приложением.

Например, команда [**Close**](close.md) "все" закрывает все открытые устройства, а команда " [**воспроизвести**](play.md) все" запускает воспроизведение всех устройств, открытых приложением. Так как MCI последовательно отправляет команды на устройства MCI, между первым и последним устройствами, получающими команду, существует интервал.

Использование «ALL» — удобный способ вещания команды на все устройства, но не следует полагаться на нее для синхронизации устройств; время между сообщениями может отличаться.

Когда вы выдаете команду и указываете неоткрытое устройство, MCI пытается открыть устройство перед реализацией команды. Для автоматического открытия устройств применяются следующие правила.

-   Функция автоматического открытия работает только с интерфейсом командной строки.
-   Функция автоматического открытия не работает для команд, характерных для пользовательских драйверов устройств.
-   Автоматически открытые устройства не отвечают на команды, в которых в качестве имени устройства используется "все".
-   Функция автоматического открытия не позволяет приложению задавать флаг "Type". Без имени устройства MCI определяет имя устройства из записей в реестре. Чтобы использовать конкретное устройство, можно объединить имя устройства с именем файла, используя восклицательный знак, как описано в справочном материале по команде [**Open**](open.md) .

Если приложение использует функцию автоматического открытия для открытия устройства, приложение должно проверить возвращаемое значение каждой последующей команды Open, чтобы убедиться, что устройство по-прежнему открыто. Кроме того, MCI автоматически закрывает все автоматически открываемые устройства. MCI обычно закрывает устройство в следующих ситуациях:

-   Команда завершена.
-   Команда прерывается.
-   Вы запрашиваете уведомление в последующей команде.
-   MCI обнаруживает сбой.

 

 




