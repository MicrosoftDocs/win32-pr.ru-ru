---
title: Воспроизведение устройства
description: Воспроизведение устройства
ms.assetid: 48d83e06-9e6e-498b-ad9b-0b66f235db25
keywords:
- Команда MCI_PLAY
- Окно воспроизведения МЦИАВИ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af9efc06b3d5f33dfb798aa4c47bf7d5a7a8bab45842de1da170c860d2a4a5f2
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118372645"
---
# <a name="playing-a-device"></a>Воспроизведение устройства

Команда [**воспроизвести**](play.md) ([**MCI \_ Play**](mci-play.md)) запускает воспроизведение устройства. Без флагов эта команда начинает воспроизведение с текущей позицией и выполняется до тех пор, пока команда не будет прервана или пока не будет достигнут конец носителя или файла. После воспроизведения Текущее расположение находится в конце носителя. Чтобы изменить текущую положение, можно также использовать команду [**поиска**](seek.md) ([**MCI \_ Seek**](mci-seek.md)).

Большинство устройств, которые поддерживают команду **Play** , также поддерживают флаги "от" (MCI \_ от) и "to" (MCI \_ to). Эти флаги указывают на расположение, в котором устройство должно запускаться и останавливаться. Например, следующая команда воспроизводит аудио компакт-диск из начала первой записи с помощью функции [**mciSendString**](/previous-versions//dd757161(v=vs.85)) :


```C++
mciSendString("play cdaudio from 0", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
```



Некоторые типы устройств расширяют эту команду, чтобы использовать возможности конкретного устройства. например, команда [**play**](play.md) для типа устройства **видеодиск** включает «fast» (mci \_ VD \_ play \_ FAST), «медленные» ( \_ скорость воспроизведения mci VD) \_ \_ и «сканирование» (сканирование mci \_ VD \_ play \_ ).

> [!Note]  
> Единицы, назначенные значению "значение должности", зависят от формата времени, используемого устройством. Каждое устройство имеет формат времени по умолчанию, но следует указать формат времени с помощью команды [**Set**](set.md) ([**MCI \_ Set**](mci-set.md)) перед выполнением команд, использующих значения позиций.

 

## <a name="playing-an-avi-file"></a>Воспроизведение файла AVI

видеофайлы в Windows состоят по крайней мере из двух потоков данных с чередованием: видео (виде рисунков) и звукового потока. Вы можете легко воспроизводить файлы AVI с чередованием с помощью команд MCI. В следующих разделах рассматриваются воспроизводимые AVI файлы.

## <a name="setting-up-an-mciavi-playback-window"></a>Настройка окна воспроизведения МЦИАВИ

Приложение может указать следующие параметры, чтобы определить окно воспроизведения для воспроизведения файла AVI:

-   Используйте всплывающее окно по умолчанию драйвера МЦИАВИ.
-   Укажите родительское окно и стиль окна, которые драйвер МЦИАВИ может использовать для создания окна воспроизведения.
-   Укажите окно воспроизведения для драйвера МЦИАВИ, который будет использоваться для воспроизведения.
-   Воспроизведение AVI-файла на полноэкранном дисплее.

Если в приложении не указаны параметры окна, драйвер МЦИАВИ создает окно по умолчанию для воспроизведения последовательности. Драйвер создает это окно воспроизведения для команды [**Open**](open.md) ([**MCI \_ Open**](mci-open.md)), но не отображает окно, пока приложение не отправит команду, чтобы отобразить окно или воспроизвести файл. Это окно воспроизведения по умолчанию — это всплывающее окно с границей изменения размера, заголовком, толстой рамкой, меню **окна** и кнопкой сворачивания.

В приложении также можно указать маркер родительского окна и стиль окна при выпуске команды **Open** . В этом случае драйвер МЦИАВИ создает окно на основе этих спецификаций вместо всплывающего окна по умолчанию. Приложение может указать любой стиль окна, доступный для функции [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa) . Стили, которым требуется родительское окно, например WS \_ , должны включать в себя маркер родительского окна.

Приложение также может создать собственное окно и предоставить ему обработчик для драйвера МЦИАВИ с помощью команды [**Window**](window.md) ([**\_ окно MCI**](mci-window.md)). Драйвер МЦИАВИ использует это окно вместо создания одного из его собственных.

Когда драйвер МЦИАВИ создает окно воспроизведения или получает в приложении маркер окна, он не отображает окно, пока приложение не воспроизводит последовательность или не отправит команду для вывода окна. Приложение может использовать команду **Window** для вывода окна без воспроизведения последовательности. Например, следующая команда отображает окно с помощью [**mciSendString**](/previous-versions//dd757161(v=vs.85)):


```C++
mciSendString("window movie state show", lpszReturnString,
    lstrlen(lpszReturnString), NULL);
```



В этом примере "Movie" — это псевдоним для устройства цифрового видео.

Приложение может также воспроизводить AVI-файл в полноэкранном режиме. Чтобы воспроизвести полноэкранный режим, измените команду [**воспроизвести**](play.md) ([**MCI \_ Play**](mci-play.md)) с помощью флага "Полноэкранный" (MCI \_ мЦиави \_ Воспроизведение в \_ полноэкранном режиме). Когда приложение использует этот флаг, драйвер МЦИАВИ использует полноэкранный формат размером 320 в 240 пикселей для воспроизведения последовательности. Например, следующая команда воспроизводит открытый файл в полноэкранном режиме (с помощью "Movie" в качестве псевдонима):


```C++
mciSendString("play movie fullscreen", lpszReturnString,
    lstrlen(lpszReturnString), NULL);
```



## <a name="changing-the-playback-state-for-an-avi-file"></a>Изменение состояния воспроизведения для файла AVI

Приложение может использовать команду [**поиска**](seek.md) ([**MCI \_ Seek**](mci-seek.md)), чтобы переместить текущую точку в начало, в конец или в произвольную точку в файле AVI. Существует два режима поиска драйвера МЦИАВИ: точный и неточный. Приложение может изменить режим поиска с помощью команды [**Set**](set.md) ([**MCI \_ Set**](mci-set.md)). При использовании **параметра Set** "Поиск в точности" драйвер мЦиави ищет в точности тот кадр, который указывает ваше приложение. Это может привести к задержке при временной сжатии файла, если в приложении не указан ключевой кадр. При использовании **параметра Set** "Поиск в точности", драйвер мЦиави выполняет поиск ближайшего ключевого кадра в временно сжатом файле.

Некоторые команды MCI позволяют приложению изменять воспроизведение файла AVI другими способами. Например, файл AVI по умолчанию воспроизводится со стандартной скоростью, но приложение может увеличить или уменьшить эту скорость, используя флаг "Speed" с командой **Set** . Для AVI-файлов значение скорости 1000 является типичным. Таким способом, чтобы воспроизвести фильм на половину стандартной скорости, приложение может использовать **набор** команд "movie Speed 500"; Кроме того, он может использовать **Set** "speed Movie 2000" для воспроизведения последовательности в два раза подряд.

Команда [**сетаудио**](setaudio.md) ([**MCI \_ сетаудио**](mci-setaudio.md)) позволяет приложению управлять звуковой частью AVI-файла. Приложение может отключить звук во время воспроизведения или, в случае с несколькими файлами звуковых потоков, выбрать воспроизводимый звуковой поток.

Драйвер МЦИАВИ содержит диалоговое окно для управления некоторыми параметрами воспроизведения. Некоторые параметры, доступные пользователю, включают выбор экранного или полноэкранного воспроизведения, выбор режима поиска и масштабирования изображения. Приложение может иметь МЦИАВИ отобразить это диалоговое окно с помощью команды [**Configure**](configure.md) ([**\_ Настройка MCI**](mci-configure.md)).

## <a name="stream-handlers"></a>Обработчики потоков

Данные в AVI-файле рассматриваются как ряд потоков. AVI-файл обычно содержит аудио-и видеопоток, а также может быть пользовательским потоком, содержащим текст или другие пользовательские данные. Драйвер МЦИАВИ может использовать разные обработчики для этих потоков данных. Дополнительные сведения о пользовательских файлах AVI см. в разделе [пользовательские обработчики файлов и потоков](custom-file-and-stream-handlers.md).

 

 