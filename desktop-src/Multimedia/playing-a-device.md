---
title: Воспроизведение устройства
description: Воспроизведение устройства
ms.assetid: 48d83e06-9e6e-498b-ad9b-0b66f235db25
keywords:
- Команда MCI_PLAY
- Окно воспроизведения МЦИАВИ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f73d8b6539e842a1ffa632ed1efae5c2c8d3cda1
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987509"
---
# <a name="playing-a-device"></a><span data-ttu-id="e4064-105">Воспроизведение устройства</span><span class="sxs-lookup"><span data-stu-id="e4064-105">Playing a Device</span></span>

<span data-ttu-id="e4064-106">Команда [**воспроизвести**](play.md) ([**MCI \_ Play**](mci-play.md)) запускает воспроизведение устройства.</span><span class="sxs-lookup"><span data-stu-id="e4064-106">The [**play**](play.md) ([**MCI\_PLAY**](mci-play.md)) command starts playing a device.</span></span> <span data-ttu-id="e4064-107">Без флагов эта команда начинает воспроизведение с текущей позицией и выполняется до тех пор, пока команда не будет прервана или пока не будет достигнут конец носителя или файла.</span><span class="sxs-lookup"><span data-stu-id="e4064-107">Without any flags, this command starts playing from the current position and plays until the command is interrupted or until the end of the media or file is reached.</span></span> <span data-ttu-id="e4064-108">После воспроизведения Текущее расположение находится в конце носителя.</span><span class="sxs-lookup"><span data-stu-id="e4064-108">After playback, the current position is at the end of the media.</span></span> <span data-ttu-id="e4064-109">Чтобы изменить текущую положение, можно также использовать команду [**поиска**](seek.md) ([**MCI \_ Seek**](mci-seek.md)).</span><span class="sxs-lookup"><span data-stu-id="e4064-109">You can also use the [**seek**](seek.md) ([**MCI\_SEEK**](mci-seek.md)) command to change the current position.</span></span>

<span data-ttu-id="e4064-110">Большинство устройств, которые поддерживают команду **Play** , также поддерживают флаги "от" (MCI \_ от) и "to" (MCI \_ to).</span><span class="sxs-lookup"><span data-stu-id="e4064-110">Most devices that support the **play** command also support the "from" (MCI\_FROM) and "to" (MCI\_TO) flags.</span></span> <span data-ttu-id="e4064-111">Эти флаги указывают на расположение, в котором устройство должно запускаться и останавливаться.</span><span class="sxs-lookup"><span data-stu-id="e4064-111">These flags indicate the position at which the device should start and stop playing.</span></span> <span data-ttu-id="e4064-112">Например, следующая команда воспроизводит аудио компакт-диск из начала первой записи с помощью функции [**mciSendString**](/previous-versions//dd757161(v=vs.85)) :</span><span class="sxs-lookup"><span data-stu-id="e4064-112">For example, the following command plays a CD audio disc from the beginning of the first track using the [**mciSendString**](/previous-versions//dd757161(v=vs.85)) function:</span></span>


```C++
mciSendString("play cdaudio from 0", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
```



<span data-ttu-id="e4064-113">Некоторые типы устройств расширяют эту команду, чтобы использовать возможности конкретного устройства.</span><span class="sxs-lookup"><span data-stu-id="e4064-113">Some device types extend this command to exploit the capabilities of a particular device.</span></span> <span data-ttu-id="e4064-114">Например, команда [**Play**](play.md) для типа устройства **видеодиск** включает "быстрое" (MCI \_ VD \_ Play \_ fast), "медленный" ( \_ \_ слишком медленный MCI VD воспроизведения \_ ) и "сканирование" (сканирование MCI \_ VD \_ Play \_ ).</span><span class="sxs-lookup"><span data-stu-id="e4064-114">For example, the [**play**](play.md) command for the **videodisc** device type includes the "fast" (MCI\_VD\_PLAY\_FAST) , "slow" (MCI\_VD\_PLAY\_SLOW), and "scan" (MCI\_VD\_PLAY\_SCAN) flags.</span></span>

> [!Note]  
> <span data-ttu-id="e4064-115">Единицы, назначенные значению "значение должности", зависят от формата времени, используемого устройством.</span><span class="sxs-lookup"><span data-stu-id="e4064-115">The units assigned to the position value depend on the time format used by the device.</span></span> <span data-ttu-id="e4064-116">Каждое устройство имеет формат времени по умолчанию, но следует указать формат времени с помощью команды [**Set**](set.md) ([**MCI \_ Set**](mci-set.md)) перед выполнением команд, использующих значения позиций.</span><span class="sxs-lookup"><span data-stu-id="e4064-116">Each device has a default time format, but you should specify the time format by using the [**set**](set.md) ([**MCI\_SET**](mci-set.md)) command before issuing any commands that use position values.</span></span>

 

## <a name="playing-an-avi-file"></a><span data-ttu-id="e4064-117">Воспроизведение файла AVI</span><span class="sxs-lookup"><span data-stu-id="e4064-117">Playing an AVI File</span></span>

<span data-ttu-id="e4064-118">Видеофайлы в Windows состоят из по крайней мере двух потоков данных с чередованием: видео (виде рисунков) и звукового потока.</span><span class="sxs-lookup"><span data-stu-id="e4064-118">Video files in Windows are made up of at least two interleaved data streams: a video (pictorial) stream and an audio stream.</span></span> <span data-ttu-id="e4064-119">Вы можете легко воспроизводить файлы AVI с чередованием с помощью команд MCI.</span><span class="sxs-lookup"><span data-stu-id="e4064-119">You can easily play these audio-video interleaved (AVI) files by using MCI commands.</span></span> <span data-ttu-id="e4064-120">В следующих разделах рассматриваются воспроизводимые AVI файлы.</span><span class="sxs-lookup"><span data-stu-id="e4064-120">The following sections discuss playing AVI files.</span></span>

## <a name="setting-up-an-mciavi-playback-window"></a><span data-ttu-id="e4064-121">Настройка окна воспроизведения МЦИАВИ</span><span class="sxs-lookup"><span data-stu-id="e4064-121">Setting Up an MCIAVI Playback Window</span></span>

<span data-ttu-id="e4064-122">Приложение может указать следующие параметры, чтобы определить окно воспроизведения для воспроизведения файла AVI:</span><span class="sxs-lookup"><span data-stu-id="e4064-122">Your application can specify the following options to define the playback window for playing an AVI file:</span></span>

-   <span data-ttu-id="e4064-123">Используйте всплывающее окно по умолчанию драйвера МЦИАВИ.</span><span class="sxs-lookup"><span data-stu-id="e4064-123">Use the MCIAVI driver's default pop-up window.</span></span>
-   <span data-ttu-id="e4064-124">Укажите родительское окно и стиль окна, которые драйвер МЦИАВИ может использовать для создания окна воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="e4064-124">Specify a parent window and window style that the MCIAVI driver can use to create the playback window.</span></span>
-   <span data-ttu-id="e4064-125">Укажите окно воспроизведения для драйвера МЦИАВИ, который будет использоваться для воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="e4064-125">Specify a playback window for the MCIAVI driver to use for playback.</span></span>
-   <span data-ttu-id="e4064-126">Воспроизведение AVI-файла на полноэкранном дисплее.</span><span class="sxs-lookup"><span data-stu-id="e4064-126">Play the AVI file on a full-screen display.</span></span>

<span data-ttu-id="e4064-127">Если в приложении не указаны параметры окна, драйвер МЦИАВИ создает окно по умолчанию для воспроизведения последовательности.</span><span class="sxs-lookup"><span data-stu-id="e4064-127">If your application does not specify any window options, the MCIAVI driver creates a default window for playing the sequence.</span></span> <span data-ttu-id="e4064-128">Драйвер создает это окно воспроизведения для команды [**Open**](open.md) ([**MCI \_ Open**](mci-open.md)), но не отображает окно, пока приложение не отправит команду, чтобы отобразить окно или воспроизвести файл.</span><span class="sxs-lookup"><span data-stu-id="e4064-128">The driver creates this playback window for the [**open**](open.md) ([**MCI\_OPEN**](mci-open.md)) command, but it does not display the window until your application sends a command to either display the window or play the file.</span></span> <span data-ttu-id="e4064-129">Это окно воспроизведения по умолчанию — это всплывающее окно с границей изменения размера, заголовком, толстой рамкой, меню **окна** и кнопкой сворачивания.</span><span class="sxs-lookup"><span data-stu-id="e4064-129">This default playback window is a pop-up window with a sizing border, title bar, a thick frame, a **window** menu, and a Minimize button.</span></span>

<span data-ttu-id="e4064-130">В приложении также можно указать маркер родительского окна и стиль окна при выпуске команды **Open** .</span><span class="sxs-lookup"><span data-stu-id="e4064-130">Your application can also specify a parent window handle and a window style when it issues the **open** command.</span></span> <span data-ttu-id="e4064-131">В этом случае драйвер МЦИАВИ создает окно на основе этих спецификаций вместо всплывающего окна по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e4064-131">In this case, the MCIAVI driver creates a window based on these specifications instead of the default pop-up window.</span></span> <span data-ttu-id="e4064-132">Приложение может указать любой стиль окна, доступный для функции [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa) .</span><span class="sxs-lookup"><span data-stu-id="e4064-132">Your application can specify any window style available for the [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa) function.</span></span> <span data-ttu-id="e4064-133">Стили, которым требуется родительское окно, например WS \_ , должны включать в себя маркер родительского окна.</span><span class="sxs-lookup"><span data-stu-id="e4064-133">Styles that require a parent window, such as WS\_CHILD, should include a parent window handle.</span></span>

<span data-ttu-id="e4064-134">Приложение также может создать собственное окно и предоставить ему обработчик для драйвера МЦИАВИ с помощью команды [**Window**](window.md) ([**\_ окно MCI**](mci-window.md)).</span><span class="sxs-lookup"><span data-stu-id="e4064-134">Your application can also create its own window and supply the handle to the MCIAVI driver by using the [**window**](window.md) ([**MCI\_WINDOW**](mci-window.md)) command.</span></span> <span data-ttu-id="e4064-135">Драйвер МЦИАВИ использует это окно вместо создания одного из его собственных.</span><span class="sxs-lookup"><span data-stu-id="e4064-135">The MCIAVI driver uses this window instead of creating one of its own.</span></span>

<span data-ttu-id="e4064-136">Когда драйвер МЦИАВИ создает окно воспроизведения или получает в приложении маркер окна, он не отображает окно, пока приложение не воспроизводит последовательность или не отправит команду для вывода окна.</span><span class="sxs-lookup"><span data-stu-id="e4064-136">When the MCIAVI driver creates the playback window or obtains a window handle from your application, it does not display the window until your application either plays the sequence or sends a command to display the window.</span></span> <span data-ttu-id="e4064-137">Приложение может использовать команду **Window** для вывода окна без воспроизведения последовательности.</span><span class="sxs-lookup"><span data-stu-id="e4064-137">Your application can use the **window** command to display the window without playing the sequence.</span></span> <span data-ttu-id="e4064-138">Например, следующая команда отображает окно с помощью [**mciSendString**](/previous-versions//dd757161(v=vs.85)):</span><span class="sxs-lookup"><span data-stu-id="e4064-138">For example, the following command displays the window using [**mciSendString**](/previous-versions//dd757161(v=vs.85)):</span></span>


```C++
mciSendString("window movie state show", lpszReturnString,
    lstrlen(lpszReturnString), NULL);
```



<span data-ttu-id="e4064-139">В этом примере "Movie" — это псевдоним для устройства цифрового видео.</span><span class="sxs-lookup"><span data-stu-id="e4064-139">In this example, "movie" is an alias for the digital-video device.</span></span>

<span data-ttu-id="e4064-140">Приложение может также воспроизводить AVI-файл в полноэкранном режиме.</span><span class="sxs-lookup"><span data-stu-id="e4064-140">Your application can also play an AVI file full-screen.</span></span> <span data-ttu-id="e4064-141">Чтобы воспроизвести полноэкранный режим, измените команду [**воспроизвести**](play.md) ([**MCI \_ Play**](mci-play.md)) с помощью флага "Полноэкранный" (MCI \_ мЦиави \_ Воспроизведение в \_ полноэкранном режиме).</span><span class="sxs-lookup"><span data-stu-id="e4064-141">To play full-screen, modify the [**play**](play.md) ([**MCI\_PLAY**](mci-play.md)) command with the "fullscreen" (MCI\_MCIAVI\_PLAY\_FULLSCREEN) flag.</span></span> <span data-ttu-id="e4064-142">Когда приложение использует этот флаг, драйвер МЦИАВИ использует полноэкранный формат размером 320 в 240 пикселей для воспроизведения последовательности.</span><span class="sxs-lookup"><span data-stu-id="e4064-142">When your application uses this flag, the MCIAVI driver uses a 320- by 240-pixel full-screen format for playing the sequence.</span></span> <span data-ttu-id="e4064-143">Например, следующая команда воспроизводит открытый файл в полноэкранном режиме (с помощью "Movie" в качестве псевдонима):</span><span class="sxs-lookup"><span data-stu-id="e4064-143">For example, the following command plays the opened file full-screen (using "movie" as an alias):</span></span>


```C++
mciSendString("play movie fullscreen", lpszReturnString,
    lstrlen(lpszReturnString), NULL);
```



## <a name="changing-the-playback-state-for-an-avi-file"></a><span data-ttu-id="e4064-144">Изменение состояния воспроизведения для файла AVI</span><span class="sxs-lookup"><span data-stu-id="e4064-144">Changing the Playback State for an AVI file</span></span>

<span data-ttu-id="e4064-145">Приложение может использовать команду [**поиска**](seek.md) ([**MCI \_ Seek**](mci-seek.md)), чтобы переместить текущую точку в начало, в конец или в произвольную точку в файле AVI.</span><span class="sxs-lookup"><span data-stu-id="e4064-145">Your application can use the [**seek**](seek.md) ([**MCI\_SEEK**](mci-seek.md)) command to move the current position to the beginning, the end, or an arbitrary position in an AVI file.</span></span> <span data-ttu-id="e4064-146">Существует два режима поиска драйвера МЦИАВИ: точный и неточный.</span><span class="sxs-lookup"><span data-stu-id="e4064-146">There are two seek modes for the MCIAVI driver: exact and inexact.</span></span> <span data-ttu-id="e4064-147">Приложение может изменить режим поиска с помощью команды [**Set**](set.md) ([**MCI \_ Set**](mci-set.md)).</span><span class="sxs-lookup"><span data-stu-id="e4064-147">Your application can change the seek mode by using the [**set**](set.md) ([**MCI\_SET**](mci-set.md)) command.</span></span> <span data-ttu-id="e4064-148">При использовании **параметра Set** "Поиск в точности" драйвер мЦиави ищет в точности тот кадр, который указывает ваше приложение.</span><span class="sxs-lookup"><span data-stu-id="e4064-148">When you use **set** "seek exactly on", the MCIAVI driver seeks exactly to the frame your application specifies.</span></span> <span data-ttu-id="e4064-149">Это может привести к задержке при временной сжатии файла, если в приложении не указан ключевой кадр.</span><span class="sxs-lookup"><span data-stu-id="e4064-149">This might cause a delay if the file is temporally compressed and your application does not specify a key frame.</span></span> <span data-ttu-id="e4064-150">При использовании **параметра Set** "Поиск в точности", драйвер мЦиави выполняет поиск ближайшего ключевого кадра в временно сжатом файле.</span><span class="sxs-lookup"><span data-stu-id="e4064-150">When you use **set** "seek exactly off", the MCIAVI driver seeks to the nearest key frame in a temporally compressed file.</span></span>

<span data-ttu-id="e4064-151">Некоторые команды MCI позволяют приложению изменять воспроизведение файла AVI другими способами.</span><span class="sxs-lookup"><span data-stu-id="e4064-151">Some MCI commands let your application alter the playback of an AVI file in other ways.</span></span> <span data-ttu-id="e4064-152">Например, файл AVI по умолчанию воспроизводится со стандартной скоростью, но приложение может увеличить или уменьшить эту скорость, используя флаг "Speed" с командой **Set** .</span><span class="sxs-lookup"><span data-stu-id="e4064-152">For example, an AVI file, by default, plays at its normal speed, but your application can increase or decrease this speed by using the "speed" flag with the **set** command.</span></span> <span data-ttu-id="e4064-153">Для AVI-файлов значение скорости 1000 является типичным.</span><span class="sxs-lookup"><span data-stu-id="e4064-153">For AVI files, a speed value of 1000 is typical.</span></span> <span data-ttu-id="e4064-154">Таким способом, чтобы воспроизвести фильм на половину стандартной скорости, приложение может использовать **набор** команд "movie Speed 500"; Кроме того, он может использовать **Set** "speed Movie 2000" для воспроизведения последовательности в два раза подряд.</span><span class="sxs-lookup"><span data-stu-id="e4064-154">Thus, to play a movie at half its typical speed, your application can use the command **set** "movie speed 500"; alternatively, it can use **set** "movie speed 2000" to play the sequence at twice its normal speed.</span></span>

<span data-ttu-id="e4064-155">Команда [**сетаудио**](setaudio.md) ([**MCI \_ сетаудио**](mci-setaudio.md)) позволяет приложению управлять звуковой частью AVI-файла.</span><span class="sxs-lookup"><span data-stu-id="e4064-155">The [**setaudio**](setaudio.md) ([**MCI\_SETAUDIO**](mci-setaudio.md)) command lets your application control the audio portion of an AVI file.</span></span> <span data-ttu-id="e4064-156">Приложение может отключить звук во время воспроизведения или, в случае с несколькими файлами звуковых потоков, выбрать воспроизводимый звуковой поток.</span><span class="sxs-lookup"><span data-stu-id="e4064-156">Your application can mute audio during playback or, in the case of multiple audio stream files, select the audio stream that is played.</span></span>

<span data-ttu-id="e4064-157">Драйвер МЦИАВИ содержит диалоговое окно для управления некоторыми параметрами воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="e4064-157">The MCIAVI driver has a dialog box to control some of its playback options.</span></span> <span data-ttu-id="e4064-158">Некоторые параметры, доступные пользователю, включают выбор экранного или полноэкранного воспроизведения, выбор режима поиска и масштабирования изображения.</span><span class="sxs-lookup"><span data-stu-id="e4064-158">Some of the options available to the user include selecting window-oriented or full-screen playback, selecting the seek mode, and zooming the image.</span></span> <span data-ttu-id="e4064-159">Приложение может иметь МЦИАВИ отобразить это диалоговое окно с помощью команды [**Configure**](configure.md) ([**\_ Настройка MCI**](mci-configure.md)).</span><span class="sxs-lookup"><span data-stu-id="e4064-159">Your application can have MCIAVI display this dialog box by using the [**configure**](configure.md) ([**MCI\_CONFIGURE**](mci-configure.md)) command.</span></span>

## <a name="stream-handlers"></a><span data-ttu-id="e4064-160">Обработчики потоков</span><span class="sxs-lookup"><span data-stu-id="e4064-160">Stream Handlers</span></span>

<span data-ttu-id="e4064-161">Данные в AVI-файле рассматриваются как ряд потоков.</span><span class="sxs-lookup"><span data-stu-id="e4064-161">The data in an AVI file is treated as a series of streams.</span></span> <span data-ttu-id="e4064-162">AVI-файл обычно содержит аудио-и видеопоток, а также может быть пользовательским потоком, содержащим текст или другие пользовательские данные.</span><span class="sxs-lookup"><span data-stu-id="e4064-162">An AVI file typically contains an audio and video stream, and there might also be a custom stream that contains text or some other custom data.</span></span> <span data-ttu-id="e4064-163">Драйвер МЦИАВИ может использовать разные обработчики для этих потоков данных.</span><span class="sxs-lookup"><span data-stu-id="e4064-163">The MCIAVI driver can use different handlers for these data streams.</span></span> <span data-ttu-id="e4064-164">Дополнительные сведения о пользовательских файлах AVI см. в разделе [пользовательские обработчики файлов и потоков](custom-file-and-stream-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="e4064-164">For more information about custom AVI files, see [Custom File and Stream Handlers](custom-file-and-stream-handlers.md).</span></span>

 

 