---
description: Реализует интерфейсы IX509PrivateKey и IX509PublicKey.
ms.assetid: 1358053e-ed4e-4482-b160-5b9b1024c771
title: Функции закрытых и открытых ключей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2c1d8ec481c87337e7d7e56cffee47f1f483b84
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683715"
---
# <a name="private-and-public-key-functions"></a><span data-ttu-id="7258b-103">Функции закрытых и открытых ключей</span><span class="sxs-lookup"><span data-stu-id="7258b-103">Private and Public Key Functions</span></span>

<span data-ttu-id="7258b-104">CertEnroll.dll реализует интерфейсы [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) и [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) .</span><span class="sxs-lookup"><span data-stu-id="7258b-104">CertEnroll.dll implements the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) and [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) interfaces.</span></span> <span data-ttu-id="7258b-105">Например, можно использовать интерфейс [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) для выполнения следующих действий с [*закрытым ключом*](/windows/desktop/SecGloss/p-gly):</span><span class="sxs-lookup"><span data-stu-id="7258b-105">You can, for example, use the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) interface to perform the following actions on a [*private key*](/windows/desktop/SecGloss/p-gly):</span></span>

-   <span data-ttu-id="7258b-106">Создание, открытие, закрытие, импорт, экспорт и удаление ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-106">Create, open, close, import, export, and delete the key.</span></span>
-   <span data-ttu-id="7258b-107">Укажите или получите [*алгоритм открытого ключа*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-107">Specify or retrieve the [*public key algorithm*](/windows/desktop/SecGloss/p-gly).</span></span>
-   <span data-ttu-id="7258b-108">Укажите или получите сведения о доступном [*поставщике служб шифрования*](/windows/desktop/SecGloss/c-gly) (CSP), поддерживающем алгоритм открытого ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-108">Specify or retrieve information about the available [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP) that support the public key algorithm.</span></span>
-   <span data-ttu-id="7258b-109">Укажите или получите [*сертификат*](/windows/desktop/SecGloss/c-gly) , связанный с [*закрытым ключом*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-109">Specify or retrieve the [*certificate*](/windows/desktop/SecGloss/c-gly) associated with the [*private key*](/windows/desktop/SecGloss/p-gly).</span></span>
-   <span data-ttu-id="7258b-110">Укажите или получите имя [*контейнера ключей*](/windows/desktop/SecGloss/k-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-110">Specify or retrieve the name of the [*key container*](/windows/desktop/SecGloss/k-gly).</span></span>
-   <span data-ttu-id="7258b-111">Укажите или получите описание и отображаемое имя ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-111">Specify or retrieve a description of and a display name for the key.</span></span>
-   <span data-ttu-id="7258b-112">Укажите или получите ограничения экспорта для закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-112">Specify or retrieve the export constraints places on a private key.</span></span>
-   <span data-ttu-id="7258b-113">Укажите или получите логическое значение, указывающее, существует ли ключ.</span><span class="sxs-lookup"><span data-stu-id="7258b-113">Specify or retrieve a Boolean value that indicates whether the key exists.</span></span>
-   <span data-ttu-id="7258b-114">Укажите или извлеките значение, указывающее, как ключ защищается перед использованием.</span><span class="sxs-lookup"><span data-stu-id="7258b-114">Specify or retrieve a value that indicates how the key is protected before use.</span></span>
-   <span data-ttu-id="7258b-115">Укажите или извлеките значение, указывающее, можно ли использовать ключ для подписывания, шифрования или и того, и другого.</span><span class="sxs-lookup"><span data-stu-id="7258b-115">Specify or retrieve a value that indicates whether the key can be used for signing, encryption, or both.</span></span>
-   <span data-ttu-id="7258b-116">Укажите или извлеките значение, определяющее конкретную цель, для которой можно использовать ключ.</span><span class="sxs-lookup"><span data-stu-id="7258b-116">Specify or retrieve a value that identifies the specific purpose for which the key can be used.</span></span>
-   <span data-ttu-id="7258b-117">Укажите или получите длину ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-117">Specify or retrieve the length of the key.</span></span>
-   <span data-ttu-id="7258b-118">Укажите или извлеките значение, указывающее, используется ли ключ или сохранен в контексте компьютера или пользователя.</span><span class="sxs-lookup"><span data-stu-id="7258b-118">Specify or retrieve a value that indicates whether the key is used or saved in the context of a computer or user.</span></span>
-   <span data-ttu-id="7258b-119">Получение логического значения, указывающего, был ли открыт ключ.</span><span class="sxs-lookup"><span data-stu-id="7258b-119">Retrieve a Boolean value that specifies whether the key has been opened.</span></span>
-   <span data-ttu-id="7258b-120">Укажите личный идентификационный номер для доступа к закрытому ключу на [*смарт-карте*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-120">Specify a personal identification number to access a private key on a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>
-   <span data-ttu-id="7258b-121">Укажите или получите имя CSP, связанного с ключом.</span><span class="sxs-lookup"><span data-stu-id="7258b-121">Specify or retrieve the name of the CSP associated with the key.</span></span>
-   <span data-ttu-id="7258b-122">Укажите или получите [*дескриптор безопасности*](/windows/desktop/SecGloss/s-gly) для ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-122">Specify or retrieve the [*security descriptor*](/windows/desktop/SecGloss/s-gly) for the key.</span></span>

<span data-ttu-id="7258b-123">В каждом из следующих разделов определяется функция, экспортируемая с помощью Xenroll.dll, которую можно использовать для управления [*криптографическим ключом*](/windows/desktop/SecGloss/c-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-123">Each of the following sections identifies a function exported by Xenroll.dll that can be used to manage a [*cryptographic key*](/windows/desktop/SecGloss/c-gly).</span></span> <span data-ttu-id="7258b-124">В каждом разделе также обсуждается использование CertEnroll.dll для замены функции или указывает, что сопоставление между двумя библиотеками не существует:</span><span class="sxs-lookup"><span data-stu-id="7258b-124">Each topic also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="7258b-125">контаинернамевстр</span><span class="sxs-lookup"><span data-stu-id="7258b-125">ContainerNameWStr</span></span>](#containernamewstr)
-   [<span data-ttu-id="7258b-126">женкэйфлагс</span><span class="sxs-lookup"><span data-stu-id="7258b-126">GenKeyFlags</span></span>](#genkeyflags)
-   [<span data-ttu-id="7258b-127">жеткэйлен</span><span class="sxs-lookup"><span data-stu-id="7258b-127">GetKeyLen</span></span>](#getkeylenex)
-   [<span data-ttu-id="7258b-128">жеткэйленекс</span><span class="sxs-lookup"><span data-stu-id="7258b-128">GetKeyLenEx</span></span>](#getkeylenex)
-   [<span data-ttu-id="7258b-129">жетсуппортедкэйспек</span><span class="sxs-lookup"><span data-stu-id="7258b-129">GetSupportedKeySpec</span></span>](#getsupportedkeyspec)
-   [<span data-ttu-id="7258b-130">KeySpec</span><span class="sxs-lookup"><span data-stu-id="7258b-130">KeySpec</span></span>](#getsupportedkeyspec)
-   [<span data-ttu-id="7258b-131">лимитексчанжекэйтоенЦифермент</span><span class="sxs-lookup"><span data-stu-id="7258b-131">LimitExchangeKeyToEncipherment</span></span>](#limitexchangekeytoencipherment)
-   [<span data-ttu-id="7258b-132">пвкфиленамевстр</span><span class="sxs-lookup"><span data-stu-id="7258b-132">PVKFileNameWStr</span></span>](#pvkfilenamewstr)
-   [<span data-ttu-id="7258b-133">реусехардварекэйифунаблетоженнев</span><span class="sxs-lookup"><span data-stu-id="7258b-133">ReuseHardwareKeyIfUnableToGenNew</span></span>](#reusehardwarekeyifunabletogennew)
-   [<span data-ttu-id="7258b-134">усиксистингкэйсет</span><span class="sxs-lookup"><span data-stu-id="7258b-134">UseExistingKeySet</span></span>](#useexistingkeyset)
-   [<span data-ttu-id="7258b-135">См. также</span><span class="sxs-lookup"><span data-stu-id="7258b-135">Related topics</span></span>](#related-topics)

## <a name="containernamewstr"></a><span data-ttu-id="7258b-136">контаинернамевстр</span><span class="sxs-lookup"><span data-stu-id="7258b-136">ContainerNameWStr</span></span>

<span data-ttu-id="7258b-137">Функция [**контаинернамевстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_containernamewstr) в Xenroll.dll указывает или получает имя [*контейнера ключей*](/windows/desktop/SecGloss/k-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-137">The [**ContainerNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_containernamewstr) function in Xenroll.dll specifies or retrieves the name of the [*key container*](/windows/desktop/SecGloss/k-gly).</span></span>

<span data-ttu-id="7258b-138">При использовании CertEnroll.dll можно выполнить следующие действия, чтобы получить имя контейнера ключей:</span><span class="sxs-lookup"><span data-stu-id="7258b-138">When using CertEnroll.dll, you can perform the following actions to retrieve the name of a key container:</span></span>

1.  <span data-ttu-id="7258b-139">Вызовите свойство [**request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) для существующего объекта [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="7258b-139">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="7258b-140">Вызовите метод [**жетиннеррекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) для запроса, возвращенного на шаге 1, чтобы получить самый внутренний запрос.</span><span class="sxs-lookup"><span data-stu-id="7258b-140">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="7258b-141">Вызовите **QueryInterface** для объекта [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) , возвращенного из шага 2, для приведения к объекту [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) .</span><span class="sxs-lookup"><span data-stu-id="7258b-141">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="7258b-142">Вызовите свойство [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) в запросе PKCS \# 10.</span><span class="sxs-lookup"><span data-stu-id="7258b-142">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="7258b-143">Вызовите свойство [**ContainerName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_containername) объекта [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) , полученного на шаге 4.</span><span class="sxs-lookup"><span data-stu-id="7258b-143">Call the [**ContainerName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_containername) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="genkeyflags"></a><span data-ttu-id="7258b-144">женкэйфлагс</span><span class="sxs-lookup"><span data-stu-id="7258b-144">GenKeyFlags</span></span>

<span data-ttu-id="7258b-145">Функция [**женкэйфлагс**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_genkeyflags) , определенная в Xenroll.dll указывает или получает флаги, используемые для создания пары закрытого или [*открытого и закрытого ключей*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="7258b-145">The [**GenKeyFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_genkeyflags) function defined in Xenroll.dll specifies or retrieves flags used to generate a private key or [*public/private key pair*](/windows/desktop/SecGloss/p-gly).</span></span>

<span data-ttu-id="7258b-146">При использовании CertEnroll.dll можно указать ряд различных свойств, определяющих способ создания закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-146">When using CertEnroll.dll, you can specify a number of different properties that will determine how a private key is created.</span></span> <span data-ttu-id="7258b-147">Дополнительные сведения см. в разделе [**CREATE**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-create).</span><span class="sxs-lookup"><span data-stu-id="7258b-147">For more information, see [**Create**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-create).</span></span>

## <a name="getkeylen"></a><span data-ttu-id="7258b-148">жеткэйлен</span><span class="sxs-lookup"><span data-stu-id="7258b-148">GetKeyLen</span></span>

<span data-ttu-id="7258b-149">Функция [**жеткэйлен**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getkeylen) , определенная в Xenroll.dll, получает максимальный или минимальный размер ключа шифрования.</span><span class="sxs-lookup"><span data-stu-id="7258b-149">The [**GetKeyLen**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getkeylen) function defined in Xenroll.dll retrieves the maximum or minimum key size of an encryption key.</span></span>

<span data-ttu-id="7258b-150">При использовании CertEnroll.dll можно вызвать свойство [**length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) объекта [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) или [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) , чтобы получить размер ключа в битах.</span><span class="sxs-lookup"><span data-stu-id="7258b-150">When using CertEnroll.dll, you can call the [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) object to retrieve the key size, in bits.</span></span>

## <a name="getkeylenex"></a><span data-ttu-id="7258b-151">жеткэйленекс</span><span class="sxs-lookup"><span data-stu-id="7258b-151">GetKeyLenEx</span></span>

<span data-ttu-id="7258b-152">Функция [**жеткэйленекс**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getkeylenex) , определенная в Xenroll.dll, получает максимальный или минимальный размер ключа или длину приращения ключа шифрования.</span><span class="sxs-lookup"><span data-stu-id="7258b-152">The [**GetKeyLenEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getkeylenex) function defined in Xenroll.dll retrieves the maximum or minimum key size or the increment length of an encryption key.</span></span>

<span data-ttu-id="7258b-153">При использовании CertEnroll.dll можно вызвать свойство [**length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) объекта [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) или [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) , чтобы получить размер ключа в битах.</span><span class="sxs-lookup"><span data-stu-id="7258b-153">When using CertEnroll.dll, you can call the [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) object to retrieve the key size, in bits.</span></span> <span data-ttu-id="7258b-154">Если алгоритм поддерживает добавочную длину ключей, можно вызвать свойство [**инкрементленгс**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_incrementlength) объекта [**икспалгорисм**](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm) , чтобы получить значение приращения.</span><span class="sxs-lookup"><span data-stu-id="7258b-154">If an algorithm supports incremental key lengths, you can call the [**IncrementLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_incrementlength) property on the [**ICspAlgorithm**](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm) object to retrieve the increment value.</span></span> <span data-ttu-id="7258b-155">Можно также вызвать свойства [**minLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_minlength) и [**MaxLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_maxlength) , чтобы получить минимальный и максимальный размеры ключей.</span><span class="sxs-lookup"><span data-stu-id="7258b-155">You can also call the [**MinLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_minlength) and [**MaxLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_maxlength) properties to retrieve the minimum and maximum key sizes.</span></span>

## <a name="getsupportedkeyspec"></a><span data-ttu-id="7258b-156">жетсуппортедкэйспек</span><span class="sxs-lookup"><span data-stu-id="7258b-156">GetSupportedKeySpec</span></span>

<span data-ttu-id="7258b-157">Функция [**жетсуппортедкэйспек**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getsupportedkeyspec) , определенная в Xenroll.dll, извлекает значение, указывающее, поддерживает ли CSP ключи обмена, ключи подписывания или и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="7258b-157">The [**GetSupportedKeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getsupportedkeyspec) function defined in Xenroll.dll retrieves a value that indicates whether a CSP supports exchange keys, signing keys, or both.</span></span>

<span data-ttu-id="7258b-158">При использовании CertEnroll.dll можно вызвать свойство [**keySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) для объектов [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) или [**икспинформатион**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation) , чтобы получить операции, поддерживаемые ключом.</span><span class="sxs-lookup"><span data-stu-id="7258b-158">When using CertEnroll.dll, you can call the [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation) objects to retrieve the operations supported by the key.</span></span>

## <a name="keyspec"></a><span data-ttu-id="7258b-159">KeySpec</span><span class="sxs-lookup"><span data-stu-id="7258b-159">KeySpec</span></span>

<span data-ttu-id="7258b-160">Функция [**keySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_keyspec) , определенная в Xenroll.dll указывает или получает тип ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-160">The [**KeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_keyspec) function defined in Xenroll.dll specifies or retrieves the key type.</span></span>

<span data-ttu-id="7258b-161">При использовании CertEnroll.dll можно вызвать свойство [**keySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) объекта [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) для получения операций, поддерживаемых ключом.</span><span class="sxs-lookup"><span data-stu-id="7258b-161">When using CertEnroll.dll, you can call the [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to retrieve the operations supported by the key.</span></span>

## <a name="limitexchangekeytoencipherment"></a><span data-ttu-id="7258b-162">лимитексчанжекэйтоенЦифермент</span><span class="sxs-lookup"><span data-stu-id="7258b-162">LimitExchangeKeyToEncipherment</span></span>

<span data-ttu-id="7258b-163">Функция [**лимитексчанжекэйтоенЦифермент**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_limitexchangekeytoencipherment) , определенная в Xenroll.dll указывает или получает логическое значение, указывающее, можно ли использовать ключ шифрования только для защиты данных или шифрования ключей.</span><span class="sxs-lookup"><span data-stu-id="7258b-163">The [**LimitExchangeKeyToEncipherment**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_limitexchangekeytoencipherment) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether an encryption key can be used only for data or key encipherment.</span></span>

<span data-ttu-id="7258b-164">CertEnroll.dll не содержит прямого эквивалента для этой функции.</span><span class="sxs-lookup"><span data-stu-id="7258b-164">CertEnroll.dll does not contain a direct equivalent for this function.</span></span> <span data-ttu-id="7258b-165">Однако можно добиться почти эквивалентного результата, указав объект [**IX509ExtensionKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage) и добавив его в запрос сертификата.</span><span class="sxs-lookup"><span data-stu-id="7258b-165">You can, however, achieve a nearly equivalent result by specifying an [**IX509ExtensionKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage) object and adding it to the certificate request.</span></span>

## <a name="pvkfilenamewstr"></a><span data-ttu-id="7258b-166">пвкфиленамевстр</span><span class="sxs-lookup"><span data-stu-id="7258b-166">PVKFileNameWStr</span></span>

<span data-ttu-id="7258b-167">Функция [**пвкфиленамевстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_pvkfilenamewstr) , определенная в Xenroll.dll, указывает или получает имя файла, содержащего экспортированные ключи.</span><span class="sxs-lookup"><span data-stu-id="7258b-167">The [**PVKFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_pvkfilenamewstr) function defined in Xenroll.dll specifies or retrieves the name of a file that contains exported keys.</span></span>

<span data-ttu-id="7258b-168">При использовании CertEnroll.dll можно вызвать метод [**Export**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-export) для объекта [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) , чтобы экспортировать ключ в **BSTR**.</span><span class="sxs-lookup"><span data-stu-id="7258b-168">When using CertEnroll.dll, you can call the [**Export**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-export) method on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to export a key to a **BSTR**.</span></span> <span data-ttu-id="7258b-169">Можно вызвать метод [**експортпубликкэй**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-exportpublickey) для экспорта [*открытого ключа*](/windows/desktop/SecGloss/p-gly) из пары асимметричных ключей.</span><span class="sxs-lookup"><span data-stu-id="7258b-169">You can call the [**ExportPublicKey**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-exportpublickey) method to export the [*public key*](/windows/desktop/SecGloss/p-gly) portion of an asymmetric key pair.</span></span>

## <a name="reusehardwarekeyifunabletogennew"></a><span data-ttu-id="7258b-170">реусехардварекэйифунаблетоженнев</span><span class="sxs-lookup"><span data-stu-id="7258b-170">ReuseHardwareKeyIfUnableToGenNew</span></span>

<span data-ttu-id="7258b-171">Функция [**реусехардварекэйифунаблетоженнев**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_reusehardwarekeyifunabletogennew) , определенная в Xenroll.dll указывает или получает логическое значение, указывающее, используется ли существующий ключ при обнаружении ошибки при создании нового ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-171">The [**ReuseHardwareKeyIfUnableToGenNew**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_reusehardwarekeyifunabletogennew) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether an existing key is reused when an error is encountered when generating a new key.</span></span>

<span data-ttu-id="7258b-172">При использовании CertEnroll.dll можно вызвать метод [**инитиализефромцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) для объекта [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) и указать значение типа перечисления [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) для повторного использования существующего закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="7258b-172">When using CertEnroll.dll, you can call the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) method on an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and specify a value of the [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) enumeration type to reuse an existing private key.</span></span>

## <a name="useexistingkeyset"></a><span data-ttu-id="7258b-173">усиксистингкэйсет</span><span class="sxs-lookup"><span data-stu-id="7258b-173">UseExistingKeySet</span></span>

<span data-ttu-id="7258b-174">Функция [**усиксистингкэйсет**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_useexistingkeyset) , определенная в Xenroll.dll, указывает или получает логическое значение, указывающее, следует ли использовать существующие ключи.</span><span class="sxs-lookup"><span data-stu-id="7258b-174">The [**UseExistingKeySet**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_useexistingkeyset) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to use existing keys.</span></span>

<span data-ttu-id="7258b-175">При использовании CertEnroll.dll можно вызвать метод [**инитиализефромцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) для объекта [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) и указать значение типа перечисления [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) для повторного использования существующих закрытых и открытых ключей.</span><span class="sxs-lookup"><span data-stu-id="7258b-175">When using CertEnroll.dll, you can call the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) method on an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and specify a value of the [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) enumeration type to reuse existing private and public keys.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7258b-176">См. также</span><span class="sxs-lookup"><span data-stu-id="7258b-176">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7258b-177">Сопоставление Xenroll.dll CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="7258b-177">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> </dl>

 

 
