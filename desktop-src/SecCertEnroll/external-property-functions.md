---
description: Свойства используются для связывания значения с сертификатом.
ms.assetid: a6433416-fe77-4bb0-bd8e-9410a49ab861
title: Функции внешних свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 26c8148022bf604aa90780787c068b330c469ae6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104266117"
---
# <a name="external-property-functions"></a><span data-ttu-id="99e03-103">Функции внешних свойств</span><span class="sxs-lookup"><span data-stu-id="99e03-103">External Property Functions</span></span>

<span data-ttu-id="99e03-104">Свойства используются для связывания значения с сертификатом.</span><span class="sxs-lookup"><span data-stu-id="99e03-104">Properties are used to associate a value with a certificate.</span></span> <span data-ttu-id="99e03-105">Свойства никогда не отправляются или не обрабатываются [*центром сертификации*](/windows/desktop/SecGloss/c-gly) (ЦС) и не хранятся в сертификате.</span><span class="sxs-lookup"><span data-stu-id="99e03-105">Properties are never sent to or processed by a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), and they are not stored inside a certificate.</span></span> <span data-ttu-id="99e03-106">Как правило, они связаны с сертификатом после получения сертификата из центра сертификации и перед его сохранением в хранилище.</span><span class="sxs-lookup"><span data-stu-id="99e03-106">Typically, they are associated with a certificate after the certificate is received from the CA and before it is saved in a store.</span></span> <span data-ttu-id="99e03-107">Свойства сохраняются в хранилище вместе с сертификатом.</span><span class="sxs-lookup"><span data-stu-id="99e03-107">The properties are saved in the store along with the certificate.</span></span> <span data-ttu-id="99e03-108">CertEnroll.dll реализует интерфейс [**ицертпроперти**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) и следующие интерфейсы, производные от **ицертпроперти**:</span><span class="sxs-lookup"><span data-stu-id="99e03-108">CertEnroll.dll implements the [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) interface and the following interfaces derived from **ICertProperty**:</span></span>

-   [<span data-ttu-id="99e03-109">**ицертпропертярчивед**</span><span class="sxs-lookup"><span data-stu-id="99e03-109">**ICertPropertyArchived**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyarchived)
-   [<span data-ttu-id="99e03-110">**ицертпропертярчиведкэйхаш**</span><span class="sxs-lookup"><span data-stu-id="99e03-110">**ICertPropertyArchivedKeyHash**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyarchivedkeyhash)
-   [<span data-ttu-id="99e03-111">**ицертпропертяутоенролл**</span><span class="sxs-lookup"><span data-stu-id="99e03-111">**ICertPropertyAutoEnroll**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyautoenroll)
-   [<span data-ttu-id="99e03-112">**ицертпропертибаккедуп**</span><span class="sxs-lookup"><span data-stu-id="99e03-112">**ICertPropertyBackedUp**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertybackedup)
-   [<span data-ttu-id="99e03-113">**ицертпропертидескриптион**</span><span class="sxs-lookup"><span data-stu-id="99e03-113">**ICertPropertyDescription**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertydescription)
-   [<span data-ttu-id="99e03-114">**ицертпропертенроллмент**</span><span class="sxs-lookup"><span data-stu-id="99e03-114">**ICertPropertyEnrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyenrollment)
-   [<span data-ttu-id="99e03-115">**ицертпропертифриендлинаме**</span><span class="sxs-lookup"><span data-stu-id="99e03-115">**ICertPropertyFriendlyName**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyfriendlyname)
-   [<span data-ttu-id="99e03-116">**ицертпропертикэйпровинфо**</span><span class="sxs-lookup"><span data-stu-id="99e03-116">**ICertPropertyKeyProvInfo**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertykeyprovinfo)
-   [<span data-ttu-id="99e03-117">**ицертпропертиреневал**</span><span class="sxs-lookup"><span data-stu-id="99e03-117">**ICertPropertyRenewal**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyrenewal)
-   [<span data-ttu-id="99e03-118">**ицертпропертирекуесторигинатор**</span><span class="sxs-lookup"><span data-stu-id="99e03-118">**ICertPropertyRequestOriginator**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyrequestoriginator)
-   [<span data-ttu-id="99e03-119">**ICertPropertySHA1Hash**</span><span class="sxs-lookup"><span data-stu-id="99e03-119">**ICertPropertySHA1Hash**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertysha1hash)

<span data-ttu-id="99e03-120">В каждом из следующих разделов определяется функция, экспортируемая с помощью Xenroll.dll для управления свойствами внешнего сертификата.</span><span class="sxs-lookup"><span data-stu-id="99e03-120">Each of the following sections identifies a function exported by Xenroll.dll to manage external certificate properties.</span></span> <span data-ttu-id="99e03-121">В каждом разделе также обсуждается использование CertEnroll.dll для замены функции или указывает, что сопоставление между двумя библиотеками не существует:</span><span class="sxs-lookup"><span data-stu-id="99e03-121">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="99e03-122">аддблобпропертитоцертификатевстр</span><span class="sxs-lookup"><span data-stu-id="99e03-122">addBlobPropertyToCertificateWStr</span></span>](#addblobpropertytocertificatewstr)
-   [<span data-ttu-id="99e03-123">жетприватекэйарчивецертификате</span><span class="sxs-lookup"><span data-stu-id="99e03-123">GetPrivateKeyArchiveCertificate</span></span>](#getprivatekeyarchivecertificate)
-   [<span data-ttu-id="99e03-124">ресетблобпропертиес</span><span class="sxs-lookup"><span data-stu-id="99e03-124">resetBlobProperties</span></span>](#resetblobproperties)
-   [<span data-ttu-id="99e03-125">сетприватекэйарчивецертификате</span><span class="sxs-lookup"><span data-stu-id="99e03-125">SetPrivateKeyArchiveCertificate</span></span>](#setprivatekeyarchivecertificate)
-   [<span data-ttu-id="99e03-126">сетсигнерцертификате</span><span class="sxs-lookup"><span data-stu-id="99e03-126">SetSignerCertificate</span></span>](#setsignercertificate)
-   [<span data-ttu-id="99e03-127">сумбпринтвстр</span><span class="sxs-lookup"><span data-stu-id="99e03-127">ThumbPrintWStr</span></span>](#thumbprintwstr)
-   [<span data-ttu-id="99e03-128">См. также</span><span class="sxs-lookup"><span data-stu-id="99e03-128">Related topics</span></span>](#related-topics)

## <a name="addblobpropertytocertificatewstr"></a><span data-ttu-id="99e03-129">аддблобпропертитоцертификатевстр</span><span class="sxs-lookup"><span data-stu-id="99e03-129">addBlobPropertyToCertificateWStr</span></span>

<span data-ttu-id="99e03-130">Функция [**аддблобпропертитоцертификатевстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addblobpropertytocertificatewstr) в Xenroll.dll добавляет свойство к сертификату.</span><span class="sxs-lookup"><span data-stu-id="99e03-130">The [**addBlobPropertyToCertificateWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addblobpropertytocertificatewstr) function in Xenroll.dll adds a property to the certificate.</span></span>

<span data-ttu-id="99e03-131">В CertEnroll.dll все объекты, производные от [**ицертпроперти**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) , реализуют метод [**сетвалуеонцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-setvalueoncertificate) , который можно использовать для связывания свойства с сертификатом.</span><span class="sxs-lookup"><span data-stu-id="99e03-131">In CertEnroll.dll, all of the objects derived from [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) implement a [**SetValueOnCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-setvalueoncertificate) method that you can use to associate a property with a certificate.</span></span> <span data-ttu-id="99e03-132">Кроме того, объект [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) напрямую реализует свойства [**CertificateFriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatefriendlyname) и [**цертификатедескриптион**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatedescription) .</span><span class="sxs-lookup"><span data-stu-id="99e03-132">Also, the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object directly implements the [**CertificateFriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatefriendlyname) and [**CertificateDescription**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatedescription) properties.</span></span>

## <a name="getprivatekeyarchivecertificate"></a><span data-ttu-id="99e03-133">жетприватекэйарчивецертификате</span><span class="sxs-lookup"><span data-stu-id="99e03-133">GetPrivateKeyArchiveCertificate</span></span>

<span data-ttu-id="99e03-134">Функция [**жетприватекэйарчивецертификате**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprivatekeyarchivecertificate) в Xenroll.dll извлекает сертификат Exchange, используемый для архивации [*закрытого ключа*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="99e03-134">The [**GetPrivateKeyArchiveCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprivatekeyarchivecertificate) function in Xenroll.dll retrieves the exchange certificate used to archive a [*private key*](/windows/desktop/SecGloss/p-gly).</span></span>

<span data-ttu-id="99e03-135">Вы можете использовать объект [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) в CertEnroll.dll, чтобы создать запрос к центру сертификации для архивации закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="99e03-135">You can use the [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) object in CertEnroll.dll to create a request for a CA to archive your private key.</span></span> <span data-ttu-id="99e03-136">Необходимо получить сертификат Exchange из центра сертификации и использовать [*открытый ключ*](/windows/desktop/SecGloss/p-gly) , содержащийся в этом сертификате, для шифрования закрытого ключа, отправляемого для архивации.</span><span class="sxs-lookup"><span data-stu-id="99e03-136">You must retrieve an exchange certificate from the CA and use the [*public key*](/windows/desktop/SecGloss/p-gly) contained in that certificate to encrypt the private key that you are submitting for archival.</span></span> <span data-ttu-id="99e03-137">Чтобы указать или получить сертификат обмена ЦС, вызовите свойство [**кэйарчивалцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) этого объекта.</span><span class="sxs-lookup"><span data-stu-id="99e03-137">To specify or retrieve a CA exchange certificate, call the [**KeyArchivalCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) property on that object.</span></span>

## <a name="resetblobproperties"></a><span data-ttu-id="99e03-138">ресетблобпропертиес</span><span class="sxs-lookup"><span data-stu-id="99e03-138">resetBlobProperties</span></span>

<span data-ttu-id="99e03-139">Функция [**ресетблобпропертиес**](/windows/desktop/api/xenroll/nf-xenroll-icenroll4-resetblobproperties) в Xenroll.dll удаляет коллекцию свойств из сертификата.</span><span class="sxs-lookup"><span data-stu-id="99e03-139">The [**resetBlobProperties**](/windows/desktop/api/xenroll/nf-xenroll-icenroll4-resetblobproperties) function in Xenroll.dll removes the property collection from the certificate.</span></span>

<span data-ttu-id="99e03-140">В CertEnroll.dll все объекты свойств, производные от [**ицертпроперти**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) , реализуют свойство [**ремовефромцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-removefromcertificate) , которое можно использовать для отсвязи свойства от сертификата.</span><span class="sxs-lookup"><span data-stu-id="99e03-140">In CertEnroll.dll, all of the property objects derived from [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) implement the [**RemoveFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-removefromcertificate) property that you can use to disassociate a property from a certificate.</span></span>

## <a name="setprivatekeyarchivecertificate"></a><span data-ttu-id="99e03-141">сетприватекэйарчивецертификате</span><span class="sxs-lookup"><span data-stu-id="99e03-141">SetPrivateKeyArchiveCertificate</span></span>

<span data-ttu-id="99e03-142">Функция [**сетприватекэйарчивецертификате**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setprivatekeyarchivecertificate) в Xenroll.dll указывает сертификат Exchange, используемый для архивации закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="99e03-142">The [**SetPrivateKeyArchiveCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setprivatekeyarchivecertificate) function in Xenroll.dll specifies an exchange certificate used to archive a private key.</span></span>

<span data-ttu-id="99e03-143">Вы можете использовать объект [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) в CertEnroll.dll, чтобы создать запрос к центру сертификации для архивации закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="99e03-143">You can use the [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) object in CertEnroll.dll to create a request for a CA to archive your private key.</span></span> <span data-ttu-id="99e03-144">Необходимо получить сертификат Exchange из центра сертификации и использовать открытый ключ, содержащийся в этом сертификате, для шифрования закрытого ключа, отправляемого для архивации.</span><span class="sxs-lookup"><span data-stu-id="99e03-144">You must retrieve an exchange certificate from the CA and use the public key contained in that certificate to encrypt the private key that you are submitting for archival.</span></span> <span data-ttu-id="99e03-145">Чтобы указать или получить сертификат обмена ЦС, вызовите свойство [**кэйарчивалцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) этого объекта.</span><span class="sxs-lookup"><span data-stu-id="99e03-145">To specify or retrieve a CA exchange certificate, call the [**KeyArchivalCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) property on that object.</span></span>

## <a name="setsignercertificate"></a><span data-ttu-id="99e03-146">сетсигнерцертификате</span><span class="sxs-lookup"><span data-stu-id="99e03-146">SetSignerCertificate</span></span>

<span data-ttu-id="99e03-147">Функция [**сетсигнерцертификате**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setsignercertificate) в Xenroll.dll указывает сертификат подписавший.</span><span class="sxs-lookup"><span data-stu-id="99e03-147">The [**SetSignerCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setsignercertificate) function in Xenroll.dll Specifies a signer certificate.</span></span>

<span data-ttu-id="99e03-148">Объект [**исигнерцертификате**](/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificate) в CertEnroll.dll может использоваться для подписания запроса [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly), CMC или самозаверяющего [*сертификата*](/windows/desktop/SecGloss/c-gly).</span><span class="sxs-lookup"><span data-stu-id="99e03-148">The [**ISignerCertificate**](/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificate) object in CertEnroll.dll can be used to sign a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly), CMC, or self-signed [*certificate request*](/windows/desktop/SecGloss/c-gly).</span></span> <span data-ttu-id="99e03-149">Вы можете инициализировать объект, используя существующий сертификат подписи, и связать его с запросом, вызвав одно из следующих свойств:</span><span class="sxs-lookup"><span data-stu-id="99e03-149">You can initialize the object by using an existing signing certificate and associate it with a request by calling one of the following properties:</span></span>

-   <span data-ttu-id="99e03-150">[**Сигнерцертификатес**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_signercertificates) в [ **IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc)</span><span class="sxs-lookup"><span data-stu-id="99e03-150">[**SignerCertificates**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_signercertificates) on [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc)</span></span>
-   <span data-ttu-id="99e03-151">[**Сигнерцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate) в [ **IX509CertificateRequestPkcs7**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs7)</span><span class="sxs-lookup"><span data-stu-id="99e03-151">[**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate) on [**IX509CertificateRequestPkcs7**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs7)</span></span>
-   <span data-ttu-id="99e03-152">[**Сигнерцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcertificate-get_signercertificate) в [ **IX509CertificateRequestCertificate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcertificate)</span><span class="sxs-lookup"><span data-stu-id="99e03-152">[**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcertificate-get_signercertificate) on [**IX509CertificateRequestCertificate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcertificate)</span></span>

<span data-ttu-id="99e03-153">Кроме того, при инициализации запроса CMC из внутреннего запроса и шаблона или инициализации \# запроса PKCS 7 из существующего запроса может быть установлен сертификат подписи.</span><span class="sxs-lookup"><span data-stu-id="99e03-153">Also, if you initialize a CMC request from an inner request and a template or you initialize a PKCS \#7 request from an existing request, the signing certificate may be set.</span></span>

## <a name="thumbprintwstr"></a><span data-ttu-id="99e03-154">сумбпринтвстр</span><span class="sxs-lookup"><span data-stu-id="99e03-154">ThumbPrintWStr</span></span>

<span data-ttu-id="99e03-155">Функция [**сумбпринтвстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_thumbprintwstr) в Xenroll.dll указывает или получает значение хэша сертификата.</span><span class="sxs-lookup"><span data-stu-id="99e03-155">The [**ThumbPrintWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_thumbprintwstr) function in Xenroll.dll specifies or retrieves the value of the certificate hash.</span></span>

<span data-ttu-id="99e03-156">В CertEnroll.dll можно использовать объект [**ICertPropertySHA1Hash**](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertysha1hash) для получения [*хэш-*](/windows/desktop/SecGloss/h-gly) значения ([*отпечатка*](/windows/desktop/SecGloss/t-gly)), созданного путем вызова метода [**инитиализефромцертификате**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-initializefromcertificate) .</span><span class="sxs-lookup"><span data-stu-id="99e03-156">In CertEnroll.dll, you can use the [**ICertPropertySHA1Hash**](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertysha1hash) object to retrieve a [*hash*](/windows/desktop/SecGloss/h-gly) value ([*thumbprint*](/windows/desktop/SecGloss/t-gly)) created by calling the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-initializefromcertificate) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="99e03-157">См. также</span><span class="sxs-lookup"><span data-stu-id="99e03-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="99e03-158">Сопоставление Xenroll.dll CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="99e03-158">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> </dl>

 

 
