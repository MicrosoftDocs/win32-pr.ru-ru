---
description: Формат сертификата X. 509 версии 3 определяет несколько расширений, которые могут быть добавлены к сертификату для предоставления расширенной информации об использовании ключа, политиках сертификатов и ограничениях, других формах имен и т. д.
ms.assetid: d53107b7-a153-41cf-9876-1d28aaf99816
title: Функции расширения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bc490c8763a00fae9e7fb1e8a702ff87e2c18fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683954"
---
# <a name="extension-functions"></a><span data-ttu-id="37403-103">Функции расширения</span><span class="sxs-lookup"><span data-stu-id="37403-103">Extension Functions</span></span>

<span data-ttu-id="37403-104">Формат сертификата [*X. 509*](/windows/desktop/SecGloss/x-gly) версии 3 определяет несколько расширений, которые могут быть добавлены к сертификату для предоставления расширенной информации об использовании ключа, политиках сертификатов и ограничениях, других формах имен и т. д.</span><span class="sxs-lookup"><span data-stu-id="37403-104">The [*X.509*](/windows/desktop/SecGloss/x-gly) version 3 certificate format identifies multiple extensions that can be added to a certificate to provide enhanced information about key usage, certificate policies and constraints, alternative name forms, and more.</span></span>

<span data-ttu-id="37403-105">CertEnroll.dll реализует следующие интерфейсы для управления расширениями сертификатов:</span><span class="sxs-lookup"><span data-stu-id="37403-105">CertEnroll.dll implements the following interfaces to manage certificate extensions:</span></span>

-   [<span data-ttu-id="37403-106">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="37403-106">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
-   [<span data-ttu-id="37403-107">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="37403-107">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
-   [<span data-ttu-id="37403-108">**IX509ExtensionAlternativeNames**</span><span class="sxs-lookup"><span data-stu-id="37403-108">**IX509ExtensionAlternativeNames**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames)
-   [<span data-ttu-id="37403-109">**IX509ExtensionAuthorityKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="37403-109">**IX509ExtensionAuthorityKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionauthoritykeyidentifier)
-   [<span data-ttu-id="37403-110">**IX509ExtensionBasicConstraints**</span><span class="sxs-lookup"><span data-stu-id="37403-110">**IX509ExtensionBasicConstraints**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionbasicconstraints)
-   [<span data-ttu-id="37403-111">**IX509ExtensionCertificatePolicies**</span><span class="sxs-lookup"><span data-stu-id="37403-111">**IX509ExtensionCertificatePolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensioncertificatepolicies)
-   [<span data-ttu-id="37403-112">**IX509ExtensionEnhancedKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="37403-112">**IX509ExtensionEnhancedKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage)
-   [<span data-ttu-id="37403-113">**IX509ExtensionKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="37403-113">**IX509ExtensionKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage)
-   [<span data-ttu-id="37403-114">**IX509ExtensionMSApplicationPolicies**</span><span class="sxs-lookup"><span data-stu-id="37403-114">**IX509ExtensionMSApplicationPolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionmsapplicationpolicies)
-   [<span data-ttu-id="37403-115">**IX509ExtensionSmimeCapabilities**</span><span class="sxs-lookup"><span data-stu-id="37403-115">**IX509ExtensionSmimeCapabilities**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities)
-   [<span data-ttu-id="37403-116">**IX509ExtensionSubjectKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="37403-116">**IX509ExtensionSubjectKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier)
-   [<span data-ttu-id="37403-117">**IX509ExtensionTemplate**</span><span class="sxs-lookup"><span data-stu-id="37403-117">**IX509ExtensionTemplate**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate)
-   [<span data-ttu-id="37403-118">**IX509ExtensionTemplateName**</span><span class="sxs-lookup"><span data-stu-id="37403-118">**IX509ExtensionTemplateName**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename)

<span data-ttu-id="37403-119">В каждом из следующих разделов обсуждается функция, экспортируемая с помощью Xenroll.dll для управления расширениями сертификатов.</span><span class="sxs-lookup"><span data-stu-id="37403-119">Each of the following sections discusses a function exported by Xenroll.dll to manage certificate extensions.</span></span> <span data-ttu-id="37403-120">В каждом разделе также обсуждается использование CertEnroll.dll для замены функции или указывает, что сопоставление между двумя библиотеками не существует:</span><span class="sxs-lookup"><span data-stu-id="37403-120">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="37403-121">аддцерттипеторекуествстр</span><span class="sxs-lookup"><span data-stu-id="37403-121">AddCertTypeToRequestWStr</span></span>](#addcerttypetorequestwstr)
-   [<span data-ttu-id="37403-122">аддцерттипеторекуествстрекс</span><span class="sxs-lookup"><span data-stu-id="37403-122">AddCertTypeToRequestWStrEx</span></span>](#addcerttypetorequestwstrex)
-   [<span data-ttu-id="37403-123">аддекстенсионсторекуест</span><span class="sxs-lookup"><span data-stu-id="37403-123">AddExtensionsToRequest</span></span>](#addextensionstorequest)
-   [<span data-ttu-id="37403-124">аддекстенсионторекуествстр</span><span class="sxs-lookup"><span data-stu-id="37403-124">addExtensionToRequestWStr</span></span>](#addextensiontorequestwstr)
-   [<span data-ttu-id="37403-125">енаблесмимекапабилитиес</span><span class="sxs-lookup"><span data-stu-id="37403-125">EnableSMIMECapabilities</span></span>](#enablesmimecapabilities)
-   [<span data-ttu-id="37403-126">инклудесубжекткэйид</span><span class="sxs-lookup"><span data-stu-id="37403-126">IncludeSubjectKeyID</span></span>](#includesubjectkeyid)
-   [<span data-ttu-id="37403-127">ресетекстенсионс</span><span class="sxs-lookup"><span data-stu-id="37403-127">resetExtensions</span></span>](#resetextensions)
-   [<span data-ttu-id="37403-128">См. также</span><span class="sxs-lookup"><span data-stu-id="37403-128">Related topics</span></span>](#related-topics)

## <a name="addcerttypetorequestwstr"></a><span data-ttu-id="37403-129">аддцерттипеторекуествстр</span><span class="sxs-lookup"><span data-stu-id="37403-129">AddCertTypeToRequestWStr</span></span>

<span data-ttu-id="37403-130">Функция [**аддцерттипеторекуествстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) в Xenroll.dll добавляет к запросу шаблон сертификата по имени.</span><span class="sxs-lookup"><span data-stu-id="37403-130">The [**AddCertTypeToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) function in Xenroll.dll adds a certificate template, by name, to a request.</span></span>

<span data-ttu-id="37403-131">С помощью CertEnroll.dll предпочтительным методом включения шаблона в запрос на сертификат является использование метода [**инитиализефромтемплатенаме**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) для \# объекта запроса PKCS 10 или [\* PKCS) или метода [**инитиализефроминнеррекуесттемплатенаме**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) в запросе CMC.</span><span class="sxs-lookup"><span data-stu-id="37403-131">Using CertEnroll.dll, the preferred method to incorporate a template into a certificate request is to use the [**InitializeFromTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) method on a PKCS\#10 or [\*PKCS ) request object or the [**InitializeFromInnerRequestTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) method on a CMC request.</span></span>

<span data-ttu-id="37403-132">Если конкретный шаблон недоступен на клиенте, но должен быть понят [*центром сертификации*](/windows/desktop/SecGloss/c-gly) (ЦС), можно использовать интерфейс [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) для добавления шаблона версии 1 или использовать интерфейс [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) для добавления шаблона версии 2 к запросу на сертификат.</span><span class="sxs-lookup"><span data-stu-id="37403-132">If a specific template is not available on the client but is expected to be understood by the [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), you can use the [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) interface to add a version 1 template or you can use the [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) interface to add a version 2 template to a certificate request.</span></span> <span data-ttu-id="37403-133">Например, чтобы добавить шаблон версии 1, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="37403-133">For example, to add a version 1 template, perform the following actions:</span></span>

1.  <span data-ttu-id="37403-134">Создайте объект [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="37403-134">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="37403-135">Создайте объект [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) и вызовите метод [**инитиализинкоде**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) , указав имя шаблона.</span><span class="sxs-lookup"><span data-stu-id="37403-135">Create an [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) method, specifying the template name.</span></span>
3.  <span data-ttu-id="37403-136">Добавьте расширение, созданное в коллекцию [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) , вызвав метод [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) .</span><span class="sxs-lookup"><span data-stu-id="37403-136">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="37403-137">Создайте объект [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) и вызовите метод [**инитиализинкоде**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) , указав коллекцию [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) во входных данных.</span><span class="sxs-lookup"><span data-stu-id="37403-137">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="37403-138">Получите объект коллекции [**икриптаттрибутес**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) , вызвав свойство [**криптаттрибутес**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) для существующего объекта запроса [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) или [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) .</span><span class="sxs-lookup"><span data-stu-id="37403-138">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="addcerttypetorequestwstrex"></a><span data-ttu-id="37403-139">аддцерттипеторекуествстрекс</span><span class="sxs-lookup"><span data-stu-id="37403-139">AddCertTypeToRequestWStrEx</span></span>

<span data-ttu-id="37403-140">Функция [**аддцерттипеторекуествстрекс**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) в Xenroll.dll добавляет шаблон сертификата к запросу по имени, идентификатору объекта и версии.</span><span class="sxs-lookup"><span data-stu-id="37403-140">The [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) function in Xenroll.dll adds a certificate template to a request by name, object identifier, and version.</span></span>

<span data-ttu-id="37403-141">Сведения об использовании CertEnroll.dll для включения сведений о шаблоне в запрос см. в разделе Аддцерттипеторекуествстр.</span><span class="sxs-lookup"><span data-stu-id="37403-141">For information about how to use CertEnroll.dll to incorporate template information in a request, see AddCertTypeToRequestWStr.</span></span>

## <a name="addextensionstorequest"></a><span data-ttu-id="37403-142">аддекстенсионсторекуест</span><span class="sxs-lookup"><span data-stu-id="37403-142">AddExtensionsToRequest</span></span>

<span data-ttu-id="37403-143">Функция [**аддекстенсионсторекуест**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) в Xenroll.dll Добавляет коллекцию расширений в запрос.</span><span class="sxs-lookup"><span data-stu-id="37403-143">The [**AddExtensionsToRequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) function in Xenroll.dll adds a collection of extensions to a request.</span></span>

<span data-ttu-id="37403-144">В CertEnroll.dll расширения добавляются в коллекцию Attributes запроса CMC или PKCS \# 10.</span><span class="sxs-lookup"><span data-stu-id="37403-144">In CertEnroll.dll, extensions are added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="37403-145">Чтобы добавить расширения, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="37403-145">To add extensions, perform the following actions:</span></span>

1.  <span data-ttu-id="37403-146">Создайте объект [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="37403-146">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="37403-147">Создайте объект [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) и вызовите метод [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) , чтобы создать расширение на основе идентификатора объекта и значения расширения или использовать любой из перечисленных выше интерфейсов, чтобы определить одно из более распространенных расширений.</span><span class="sxs-lookup"><span data-stu-id="37403-147">Create an [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) object and call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) method to create an extension from an object identifier and extension value or use any of the interfaces listed earlier to define one of the more common extensions.</span></span>
3.  <span data-ttu-id="37403-148">Добавьте каждое новое расширение, созданное на предыдущем шаге, в коллекцию [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) , вызвав метод [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) .</span><span class="sxs-lookup"><span data-stu-id="37403-148">Add each new extension created in the preceding step to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>

## <a name="addextensiontorequestwstr"></a><span data-ttu-id="37403-149">аддекстенсионторекуествстр</span><span class="sxs-lookup"><span data-stu-id="37403-149">addExtensionToRequestWStr</span></span>

<span data-ttu-id="37403-150">Функция [**аддекстенсионторекуествстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) в Xenroll.dll добавляет к запросу определенное расширение.</span><span class="sxs-lookup"><span data-stu-id="37403-150">The [**addExtensionToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) function in Xenroll.dll adds a specific extension to the request.</span></span>

<span data-ttu-id="37403-151">В CertEnroll.dll конкретное расширение должно быть определено и Добавлено в коллекцию Extensions перед добавлением коллекции Extensions в коллекцию Attributes запроса CMC или PKCS \# 10.</span><span class="sxs-lookup"><span data-stu-id="37403-151">In CertEnroll.dll, a specific extension must be defined and added to an extensions collection before the extension collection is added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="37403-152">Дополнительные сведения см. в обсуждении Аддекстенсионсторекуест выше.</span><span class="sxs-lookup"><span data-stu-id="37403-152">For more information see the AddExtensionsToRequest discussion above.</span></span>

## <a name="enablesmimecapabilities"></a><span data-ttu-id="37403-153">енаблесмимекапабилитиес</span><span class="sxs-lookup"><span data-stu-id="37403-153">EnableSMIMECapabilities</span></span>

<span data-ttu-id="37403-154">Функция [**енаблесмимекапабилитиес**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) в Xenroll.dll указывает или получает логическое значение, указывающее, следует ли добавить расширение **смимекапабилитиес** в запрос.</span><span class="sxs-lookup"><span data-stu-id="37403-154">The [**EnableSMIMECapabilities**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SMIMECapabilities** extension to the request.</span></span>

<span data-ttu-id="37403-155">Можно вызвать свойство [**смимекапабилитиес**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) объекта [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) , чтобы автоматически добавить объект [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) в запрос перед кодированием.</span><span class="sxs-lookup"><span data-stu-id="37403-155">You can call the [**SmimeCapabilities**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) property on the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object to automatically add an [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) object to the request before encoding.</span></span>

## <a name="includesubjectkeyid"></a><span data-ttu-id="37403-156">инклудесубжекткэйид</span><span class="sxs-lookup"><span data-stu-id="37403-156">IncludeSubjectKeyID</span></span>

<span data-ttu-id="37403-157">Функция [**инклудесубжекткэйид**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) в Xenroll.dll указывает или получает логическое значение, указывающее, следует ли добавить расширение **субжекткэйидентифиер** в запрос.</span><span class="sxs-lookup"><span data-stu-id="37403-157">The [**IncludeSubjectKeyID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SubjectKeyIdentifier** extension to the request.</span></span>

<span data-ttu-id="37403-158">По умолчанию расширение **субжекткэйидентифиер** создается при инициализации объекта запроса [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) .</span><span class="sxs-lookup"><span data-stu-id="37403-158">By default, the **SubjectKeyIdentifier** extension is created when the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) request object is initialized.</span></span> <span data-ttu-id="37403-159">Это поведение можно переопределить, вызвав свойство [**суппрессоидс**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) .</span><span class="sxs-lookup"><span data-stu-id="37403-159">You can override this behavior by calling the [**SuppressOids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) property.</span></span>

<span data-ttu-id="37403-160">Если у вас есть [*пара из открытого и закрытого ключей*](/windows/desktop/SecGloss/p-gly), можно также использовать интерфейс [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) в CertEnroll.dll, чтобы добавить расширение **субжекткэйидентифиер** к запросу сертификата, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="37403-160">If you have a [*public/private key pair*](/windows/desktop/SecGloss/p-gly), you can also use the [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) interface in CertEnroll.dll to add a **SubjectKeyIdentifier** extension to a certificate request by performing the following actions:</span></span>

1.  <span data-ttu-id="37403-161">Создайте объект [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="37403-161">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="37403-162">Создайте объект [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) и вызовите метод [**инитиализинкоде**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) , указав строку, содержащую идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37403-162">Create an [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) method, specifying a string that contains the identifier.</span></span> <span data-ttu-id="37403-163">Как правило, это 20-байтовый хэш SHA-1 [*открытого ключа*](/windows/desktop/SecGloss/p-gly) , содержащегося в сертификате подписи ЦС.</span><span class="sxs-lookup"><span data-stu-id="37403-163">Typically, this is a 20-byte SHA-1 hash of the [*public key*](/windows/desktop/SecGloss/p-gly) contained in the CA signing certificate.</span></span>
3.  <span data-ttu-id="37403-164">Добавьте расширение, созданное в коллекцию [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) , вызвав метод [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) .</span><span class="sxs-lookup"><span data-stu-id="37403-164">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="37403-165">Создайте объект [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) и вызовите метод [**инитиализинкоде**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) , указав коллекцию [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) во входных данных.</span><span class="sxs-lookup"><span data-stu-id="37403-165">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="37403-166">Получите объект коллекции [**икриптаттрибутес**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) , вызвав свойство [**криптаттрибутес**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) для существующего объекта запроса [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) или [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) .</span><span class="sxs-lookup"><span data-stu-id="37403-166">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="resetextensions"></a><span data-ttu-id="37403-167">ресетекстенсионс</span><span class="sxs-lookup"><span data-stu-id="37403-167">resetExtensions</span></span>

<span data-ttu-id="37403-168">Функция [**ресетекстенсионс**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) в Xenroll.dll удаляет коллекцию расширений из запроса.</span><span class="sxs-lookup"><span data-stu-id="37403-168">The [**resetExtensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) function in Xenroll.dll removes the extension collection from the request.</span></span>

<span data-ttu-id="37403-169">Чтобы удалить расширение из запроса по номеру индекса с помощью CertEnroll.dll, вызовите метод [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) в коллекции [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="37403-169">To remove an extension from a request by index number using CertEnroll.dll, call the [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) method on the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection.</span></span> <span data-ttu-id="37403-170">Чтобы удалить все атрибуты из запроса, вызовите метод [**clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) .</span><span class="sxs-lookup"><span data-stu-id="37403-170">To remove all attributes from a request, call the [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="37403-171">См. также</span><span class="sxs-lookup"><span data-stu-id="37403-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="37403-172">Сопоставление Xenroll.dll CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="37403-172">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="37403-173">**икриптаттрибутес**</span><span class="sxs-lookup"><span data-stu-id="37403-173">**ICryptAttributes**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes)
</dt> <dt>

[<span data-ttu-id="37403-174">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="37403-174">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
</dt> <dt>

[<span data-ttu-id="37403-175">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="37403-175">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
</dt> </dl>

 

 
