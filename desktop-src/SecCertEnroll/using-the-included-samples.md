---
description: API регистрации сертификатов содержит несколько примеров, предназначенных для создания пользовательских приложений. Большинство примеров написано с использованием C++, но также включены примеры C# и Visual Basic Scripting Edition (VBScript).
ms.assetid: 70ac7b75-542c-4d79-85ce-4b1bac414879
title: Использование прилагаемых примеров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd3cbf17d35e65ade52e97438d638cbd4f1489e0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664015"
---
# <a name="using-the-included-samples"></a><span data-ttu-id="f1b34-104">Использование прилагаемых примеров</span><span class="sxs-lookup"><span data-stu-id="f1b34-104">Using the Included Samples</span></span>

<span data-ttu-id="f1b34-105">API регистрации сертификатов содержит несколько примеров, предназначенных для создания пользовательских приложений.</span><span class="sxs-lookup"><span data-stu-id="f1b34-105">The Certificate Enrollment API includes multiple samples designed to help you create custom applications.</span></span> <span data-ttu-id="f1b34-106">Большинство примеров написано с использованием C++, но также включены примеры C# и Visual Basic Scripting Edition (VBScript).</span><span class="sxs-lookup"><span data-stu-id="f1b34-106">Most of the samples are written by using C++, but C# and Visual Basic Scripting Edition (VBScript) samples are also included.</span></span>

<span data-ttu-id="f1b34-107">При установке пакета средств разработки программного обеспечения (SDK) для Microsoft Windows устанавливаются следующие образцы по умолчанию в папке *% ProgramFiles%* \\ Microsoft SDK \\ Windows \\ v 7.0 \\ Samples \\ Security SSL \\ Certificate \\ .</span><span class="sxs-lookup"><span data-stu-id="f1b34-107">When you install the Microsoft Windows Software Development Kit (SDK), the following samples are installed, by default, in the *%ProgramFiles%*\\Microsoft SDKs\\Windows\\v7.0\\Samples\\Security\\X509 Certificate Enrollment\\ folder.</span></span>



| <span data-ttu-id="f1b34-108">Образец</span><span class="sxs-lookup"><span data-stu-id="f1b34-108">Sample</span></span>                                                                 | <span data-ttu-id="f1b34-109">Описание</span><span class="sxs-lookup"><span data-stu-id="f1b34-109">Description</span></span>                                                                                                                                                                                                                                                                                                                                                | <span data-ttu-id="f1b34-110">Язык</span><span class="sxs-lookup"><span data-stu-id="f1b34-110">Language</span></span>            |
|------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
| [<span data-ttu-id="f1b34-111">креатекнгкустомкмк</span><span class="sxs-lookup"><span data-stu-id="f1b34-111">createCNGCustomCMC</span></span>](createcngcustomcmc.md)                           | <span data-ttu-id="f1b34-112">Создает объект запроса CMC из внутреннего вложенного запроса PKCS \# 10.</span><span class="sxs-lookup"><span data-stu-id="f1b34-112">Creates a CMC request object from an inner nested PKCS \#10 request.</span></span><br/>                                                                                                                                                                                                                                                                            | <span data-ttu-id="f1b34-113">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-113">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-114">енроллкоммон</span><span class="sxs-lookup"><span data-stu-id="f1b34-114">enrollCommon</span></span>](enrollcommon.md)                                       | <span data-ttu-id="f1b34-115">Содержит следующие вспомогательные функции и макросы, используемые в прилагаемых примерах.</span><span class="sxs-lookup"><span data-stu-id="f1b34-115">Contains the following helper functions and macros used by the included samples.</span></span><br/>                                                                                                                                                                                                                                                                | <span data-ttu-id="f1b34-116">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-116">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-117">енроллкустомкмк</span><span class="sxs-lookup"><span data-stu-id="f1b34-117">enrollCustomCMC</span></span>](enrollcustomcmc.md)                                 | <span data-ttu-id="f1b34-118">Создает запрос на сертификат CMC и регистрирует компьютер в иерархии сертификатов.</span><span class="sxs-lookup"><span data-stu-id="f1b34-118">Creates a CMC certificate request and enrolls a computer in a certificate hierarchy.</span></span><br/>                                                                                                                                                                                                                                                            | <span data-ttu-id="f1b34-119">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-119">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-120">enrollCustomPKCS10</span><span class="sxs-lookup"><span data-stu-id="f1b34-120">enrollCustomPKCS10</span></span>](enrollcustompkcs10.md)                           | <span data-ttu-id="f1b34-121">Создает пользовательский запрос PKCS \# 10, отправляет его в автономный [*центр сертификации*](/windows/desktop/SecGloss/c-gly) (ЦС) и устанавливает выданный сертификат в [*хранилище сертификатов*](/windows/desktop/SecGloss/c-gly).</span><span class="sxs-lookup"><span data-stu-id="f1b34-121">Creates a custom PKCS \#10 request, submits it to a stand-alone [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), and installs the issued certificate in the [*certificate store*](/windows/desktop/SecGloss/c-gly).</span></span><br/> | <span data-ttu-id="f1b34-122">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-122">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-123">enrollCustomPKCS10 \_ 2</span><span class="sxs-lookup"><span data-stu-id="f1b34-123">enrollCustomPKCS10\_2</span></span>](enrollcustompkcs10-2.md)                      | <span data-ttu-id="f1b34-124">Создает пользовательский запрос PKCS \# 10 и пытается зарегистрировать его в корпоративном ЦС.</span><span class="sxs-lookup"><span data-stu-id="f1b34-124">Creates a custom PKCS \#10 request and attempts to enroll it in an enterprise CA.</span></span><br/>                                                                                                                                                                                                                                                               | <span data-ttu-id="f1b34-125">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-125">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-126">енроллеобокмк</span><span class="sxs-lookup"><span data-stu-id="f1b34-126">enrollEOBOCMC</span></span>](enrolleobocmc.md)                                     | <span data-ttu-id="f1b34-127">Создает запрос на сертификат CMC от имени другого пользователя и регистрирует пользователя в иерархии сертификатов.</span><span class="sxs-lookup"><span data-stu-id="f1b34-127">Creates a CMC certificate request on behalf of another user and enrolls the user in a certificate hierarchy.</span></span><br/>                                                                                                                                                                                                                                    | <span data-ttu-id="f1b34-128">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-128">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-129">енроллфромпубликкэй</span><span class="sxs-lookup"><span data-stu-id="f1b34-129">enrollFromPublicKey</span></span>](enrollfrompublickey.md)                         | <span data-ttu-id="f1b34-130">Инициализирует \# объект запроса сертификата PKCS 10, заключает его в объект запроса CMC, отправляет запрос CMC в ЦС предприятия и сохраняет сертификат, возвращенный ЦС, в файле.</span><span class="sxs-lookup"><span data-stu-id="f1b34-130">Initializes a PKCS \#10 certificate request object, wraps it in a CMC request object, submits the CMC request to an enterprise CA, and saves the certificate returned by the CA in a file.</span></span><br/>                                                                                                                                                      | <span data-ttu-id="f1b34-131">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-131">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-132">енроллкэйарчивалкмк</span><span class="sxs-lookup"><span data-stu-id="f1b34-132">enrollKeyArchivalCMC</span></span>](enrollkeyarchivalcmc.md)                       | <span data-ttu-id="f1b34-133">Создает запрос на сертификат CMC для архивации [*закрытого ключа*](/windows/desktop/SecGloss/p-gly) в центре сертификации.</span><span class="sxs-lookup"><span data-stu-id="f1b34-133">Creates a CMC certificate request to archive a [*private key*](/windows/desktop/SecGloss/p-gly) on a CA.</span></span><br/>                                                                                                                                                                                                     | <span data-ttu-id="f1b34-134">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-134">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-135">енроллнестедкмк</span><span class="sxs-lookup"><span data-stu-id="f1b34-135">enrollNestedCMC</span></span>](enrollnestedcmc.md)                                 | <span data-ttu-id="f1b34-136">Считывает существующий запрос сертификата CMC из файла, заключает его в другой запрос CMC, подписывает этот внешний запрос, отправляет его в центр сертификации и сохраняет ответ сертификата из ЦС в файл.</span><span class="sxs-lookup"><span data-stu-id="f1b34-136">Reads an existing CMC certificate request from a file, wraps it in another CMC request, signs this outer request, submits it to a CA, and saves the certificate response from the CA to a file.</span></span><br/>                                                                                                                                                 | <span data-ttu-id="f1b34-137">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-137">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-138">enrollPKCS7</span><span class="sxs-lookup"><span data-stu-id="f1b34-138">enrollPKCS7</span></span>](enrollpkcs7.md)                                         | <span data-ttu-id="f1b34-139">Создает запрос [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) из существующего сертификата, наследуя открытый и закрытый ключи и шаблон сертификата.</span><span class="sxs-lookup"><span data-stu-id="f1b34-139">Creates a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) request from an existing certificate by inheriting the public and private keys and the certificate template.</span></span> <span data-ttu-id="f1b34-140">Пример регистрирует пользователя в иерархии сертификатов и устанавливает ответ на сертификат.</span><span class="sxs-lookup"><span data-stu-id="f1b34-140">The sample enrolls the user in a certificate hierarchy and installs the certificate response.</span></span><br/>                                   | <span data-ttu-id="f1b34-141">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-141">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-142">enrollRenewalPKCS7</span><span class="sxs-lookup"><span data-stu-id="f1b34-142">enrollRenewalPKCS7</span></span>](enrollrenewalpkcs7.md)                           | <span data-ttu-id="f1b34-143">Создает \# объект запроса PKCS 7 для продления существующего сертификата.</span><span class="sxs-lookup"><span data-stu-id="f1b34-143">Creates a PKCS \#7 request object to renew an existing certificate.</span></span><br/>                                                                                                                                                                                                                                                                             | <span data-ttu-id="f1b34-144">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-144">C++</span></span><br/>      |
| [<span data-ttu-id="f1b34-145">енроллсимплемачинецерт</span><span class="sxs-lookup"><span data-stu-id="f1b34-145">enrollSimpleMachineCert</span></span>](enrollsimplemachinecert.md)                 | <span data-ttu-id="f1b34-146">Регистрирует компьютер в иерархии сертификатов с помощью шаблона, отображаемого имени сертификата и описания сертификата.</span><span class="sxs-lookup"><span data-stu-id="f1b34-146">Enrolls a computer in a certificate hierarchy by using a template, a certificate display name, and the certificate description.</span></span><br/>                                                                                                                                                                                                                 | <span data-ttu-id="f1b34-147">C++, VBS</span><span class="sxs-lookup"><span data-stu-id="f1b34-147">C++, VBS</span></span><br/> |
| [<span data-ttu-id="f1b34-148">енроллсимплеусерцерт</span><span class="sxs-lookup"><span data-stu-id="f1b34-148">enrollSimpleUserCert</span></span>](enrollsimpleusercert.md)                       | <span data-ttu-id="f1b34-149">Регистрация конечного пользователя в центре сертификации с помощью шаблона, имени субъекта и длины ключа (в битах).</span><span class="sxs-lookup"><span data-stu-id="f1b34-149">Enrolls an end user with a CA by using a template, the subject name, and the length, in bits, of the key.</span></span><br/>                                                                                                                                                                                                                                       | <span data-ttu-id="f1b34-150">C++, C #</span><span class="sxs-lookup"><span data-stu-id="f1b34-150">C++, C#</span></span><br/> |
| [<span data-ttu-id="f1b34-151">enrollWithIX509EnrollmentHelper</span><span class="sxs-lookup"><span data-stu-id="f1b34-151">enrollWithIX509EnrollmentHelper</span></span>](enrollwithix509enrollmenthelper.md) | <span data-ttu-id="f1b34-152">Демонстрирует использование протокола HTTP Windows 7 для регистрации сертификата в корпоративном ЦС.</span><span class="sxs-lookup"><span data-stu-id="f1b34-152">Demonstrates how to use the Windows 7 HTTP protocol to enroll a certificate in an enterprise CA.</span></span><br/>                                                                                                                                                                                                                                                | <span data-ttu-id="f1b34-153">C#</span><span class="sxs-lookup"><span data-stu-id="f1b34-153">C#</span></span><br/>      |
| [<span data-ttu-id="f1b34-154">инсталлреспонсефромпфкс</span><span class="sxs-lookup"><span data-stu-id="f1b34-154">installResponseFromPFX</span></span>](installresponsefrompfx.md)                   | <span data-ttu-id="f1b34-155">Устанавливает зарегистрированный сертификат из файла обмена личной информацией (PFX) в хранилище сертификатов.</span><span class="sxs-lookup"><span data-stu-id="f1b34-155">Installs an enrolled certificate from a Personal Information Exchange (PFX) file to the certificate store.</span></span><br/>                                                                                                                                                                                                                                      | <span data-ttu-id="f1b34-156">C++</span><span class="sxs-lookup"><span data-stu-id="f1b34-156">C++</span></span><br/>      |



 

## <a name="related-topics"></a><span data-ttu-id="f1b34-157">См. также</span><span class="sxs-lookup"><span data-stu-id="f1b34-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f1b34-158">Использование API регистрации сертификатов</span><span class="sxs-lookup"><span data-stu-id="f1b34-158">Using the Certificate Enrollment API</span></span>](about-the-certificate-enrollment-api.md)
</dt> </dl>

 

