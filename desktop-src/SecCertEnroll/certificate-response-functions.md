---
description: Реализует интерфейс IX509Enrollment.
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: Функции ответа на сертификат
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683834"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="e590f-103">Функции ответа на сертификат</span><span class="sxs-lookup"><span data-stu-id="e590f-103">Certificate Response Functions</span></span>

<span data-ttu-id="e590f-104">CertEnroll.dll реализует интерфейс [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) для отправки запроса на сертификат клиента и установки ответа от [*центра сертификации*](/windows/desktop/SecGloss/c-gly) (ЦС).</span><span class="sxs-lookup"><span data-stu-id="e590f-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="e590f-105">Процесс регистрации может соответствовать следующим трем сценариям:</span><span class="sxs-lookup"><span data-stu-id="e590f-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="e590f-106">Нестандартная регистрация</span><span class="sxs-lookup"><span data-stu-id="e590f-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="e590f-107">Вызовите любой метод инициализации, реализованный объектом [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="e590f-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="e590f-108">Вызовите метод [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) , чтобы получить запрос.</span><span class="sxs-lookup"><span data-stu-id="e590f-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="e590f-109">Отправьте запрос из аппаратного контроллера управления (вручную или с помощью другого процесса).</span><span class="sxs-lookup"><span data-stu-id="e590f-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="e590f-110">Получение ответа от центра сертификации.</span><span class="sxs-lookup"><span data-stu-id="e590f-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="e590f-111">Вызовите метод [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="e590f-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="e590f-112">Автоматическая регистрация</span><span class="sxs-lookup"><span data-stu-id="e590f-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="e590f-113">Вызовите любой метод инициализации, реализованный объектом [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="e590f-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="e590f-114">Вызовите метод [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) .</span><span class="sxs-lookup"><span data-stu-id="e590f-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="e590f-115">Отложенная регистрация</span><span class="sxs-lookup"><span data-stu-id="e590f-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="e590f-116">Вызовите любой метод инициализации, реализованный объектом [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="e590f-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="e590f-117">Вызовите метод [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) , чтобы получить запрос.</span><span class="sxs-lookup"><span data-stu-id="e590f-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="e590f-118">Сохраните запрос, пока вы не будете готовы отправить его.</span><span class="sxs-lookup"><span data-stu-id="e590f-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="e590f-119">Когда вы будете готовы к регистрации, вызовите метод [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) для повторной инициализации объекта регистрации.</span><span class="sxs-lookup"><span data-stu-id="e590f-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="e590f-120">Вызовите метод [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) , когда ЦС возвращает сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="e590f-121">Во время процесса регистрации можно вызвать свойство [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) объекта [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) , чтобы получить значение перечисления [**енроллментенроллстатус**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) , определяющее, успешно ли выполнена регистрация, ожидание, пропущено, сформировано сообщение об ошибке или было отказано.</span><span class="sxs-lookup"><span data-stu-id="e590f-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="e590f-122">В каждом из следующих разделов указывается функция, экспортированная с помощью Xenroll.dll для установки ответа сертификата из центра сертификации.</span><span class="sxs-lookup"><span data-stu-id="e590f-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="e590f-123">В каждом разделе также обсуждается использование CertEnroll.dll для замены функции или указывает, что сопоставление между двумя библиотеками не существует:</span><span class="sxs-lookup"><span data-stu-id="e590f-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="e590f-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="e590f-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="e590f-125">акцептфилереспонсевстр</span><span class="sxs-lookup"><span data-stu-id="e590f-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="e590f-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e590f-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="e590f-127">акцептреспонсеблоб</span><span class="sxs-lookup"><span data-stu-id="e590f-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="e590f-128">жетцертконтекстфромфилереспонсевстр</span><span class="sxs-lookup"><span data-stu-id="e590f-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="e590f-129">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="e590f-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="e590f-130">жетцертконтекстфромреспонсеблоб</span><span class="sxs-lookup"><span data-stu-id="e590f-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="e590f-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e590f-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="e590f-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="e590f-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="e590f-133">спкфиленамевстр</span><span class="sxs-lookup"><span data-stu-id="e590f-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="e590f-134">вритецерттоксп</span><span class="sxs-lookup"><span data-stu-id="e590f-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="e590f-135">вритецерттаусердс</span><span class="sxs-lookup"><span data-stu-id="e590f-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="e590f-136">См. также</span><span class="sxs-lookup"><span data-stu-id="e590f-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="e590f-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="e590f-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="e590f-138">Функция [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) в Xenroll.dll устанавливает ответ [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) из файла.</span><span class="sxs-lookup"><span data-stu-id="e590f-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="e590f-139">Библиотека CertEnroll.dll напрямую не реализует функции для установки \# ответа сертификата PKCS 7 из файла.</span><span class="sxs-lookup"><span data-stu-id="e590f-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="e590f-140">Однако можно создать пользовательскую функцию для чтения файловых данных в массив байтов и вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) для установки ответа.</span><span class="sxs-lookup"><span data-stu-id="e590f-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="e590f-141">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, тем самым позволяя установить сертификат без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-142">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-143">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="e590f-144">акцептфилереспонсевстр</span><span class="sxs-lookup"><span data-stu-id="e590f-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="e590f-145">Функция [**акцептфилереспонсевстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) в Xenroll.dll устанавливает \# ответ на сертификат PKCS 7 или CMC из файла.</span><span class="sxs-lookup"><span data-stu-id="e590f-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="e590f-146">Библиотека CertEnroll.dll не реализует напрямую функции для установки ответа на сертификат из файла.</span><span class="sxs-lookup"><span data-stu-id="e590f-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="e590f-147">Однако можно создать пользовательскую функцию для чтения файловых данных в массив байтов и вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) для установки \# ответа PKCS 7 или CMC.</span><span class="sxs-lookup"><span data-stu-id="e590f-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="e590f-148">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, тем самым позволяя установить сертификат без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-149">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-150">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="e590f-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e590f-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="e590f-152">Функция [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) в Xenroll.dll устанавливает \# ответ PKCS 7, содержащийся в массиве байтов.</span><span class="sxs-lookup"><span data-stu-id="e590f-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="e590f-153">Чтобы установить сообщение PKCS 7, можно вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) \# .</span><span class="sxs-lookup"><span data-stu-id="e590f-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="e590f-154">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, тем самым позволяя установить \# ответ PKCS 7 без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-155">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-156">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="e590f-157">акцептреспонсеблоб</span><span class="sxs-lookup"><span data-stu-id="e590f-157">acceptResponseBlob</span></span>

<span data-ttu-id="e590f-158">Функция [**акцептреспонсеблоб**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) в Xenroll.dll устанавливает \# ответ на сертификат PKCS 7 или CMC, содержащийся в массиве байтов.</span><span class="sxs-lookup"><span data-stu-id="e590f-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="e590f-159">Вы можете вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) , чтобы установить \# ответ PKCS 7 или CMC.</span><span class="sxs-lookup"><span data-stu-id="e590f-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="e590f-160">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, что позволит установить ответ без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-161">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-162">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="e590f-163">жетцертконтекстфромфилереспонсевстр</span><span class="sxs-lookup"><span data-stu-id="e590f-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="e590f-164">Функция [**жетцертконтекстфромфилереспонсевстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) в Xenroll.dll извлекает сертификат клиента из файла.</span><span class="sxs-lookup"><span data-stu-id="e590f-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="e590f-165">Библиотека CertEnroll.dll напрямую не реализует функции для получения сертификата из ответа центра сертификации, сохраненного в файле.</span><span class="sxs-lookup"><span data-stu-id="e590f-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="e590f-166">Однако можно создать пользовательскую функцию для чтения файловых данных в массив байтов и вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) для установки \# ответа PKCS 7 или CMC и вызвать свойство [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) для получения сертификата.</span><span class="sxs-lookup"><span data-stu-id="e590f-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="e590f-167">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, тем самым позволяя установить сертификат без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-168">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-169">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="e590f-170">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="e590f-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="e590f-171">Функция [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) в Xenroll.dll извлекает сертификат клиента из \# ответа PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="e590f-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="e590f-172">Чтобы получить сертификат после вызова метода [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) , можно вызвать свойство [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) объекта [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="e590f-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="e590f-173">жетцертконтекстфромреспонсеблоб</span><span class="sxs-lookup"><span data-stu-id="e590f-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="e590f-174">Функция [**жетцертконтекстфромреспонсеблоб**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) в Xenroll.dll извлекает сертификат клиента из \# ответа PKCS 7 или CMC.</span><span class="sxs-lookup"><span data-stu-id="e590f-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="e590f-175">Чтобы получить сертификат после вызова метода [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) , можно вызвать свойство [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) объекта [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="e590f-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="e590f-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e590f-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="e590f-177">Функция [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) в Xenroll.dll устанавливает \# ответ PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="e590f-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="e590f-178">Вы можете вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) , чтобы установить \# ответ PKCS 7 или CMC.</span><span class="sxs-lookup"><span data-stu-id="e590f-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="e590f-179">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, что позволит установить ответ без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-180">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-181">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="e590f-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="e590f-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="e590f-183">Функция [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) в Xenroll.dll устанавливает \# ответ PKCS 7 и возвращает число установленных сертификатов.</span><span class="sxs-lookup"><span data-stu-id="e590f-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="e590f-184">Вы можете вызвать [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) , чтобы установить \# ответ PKCS 7 или CMC.</span><span class="sxs-lookup"><span data-stu-id="e590f-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="e590f-185">Если указать значение **алловнуутстандингрекуест** перечисления [**инсталлреспонсерестриктионфлагс**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) для первого параметра [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), то не требуется наличие фиктивного сертификата, что позволит установить ответ без предварительного вызова функции [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) или [**креатерекуест**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="e590f-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e590f-186">Однако если вы устанавливаете сертификат с помощью веб-скрипта, в хранилище запросов должен присутствовать фиктивный сертификат.</span><span class="sxs-lookup"><span data-stu-id="e590f-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e590f-187">Поэтому необходимо указать **алловноне** для первого параметра.</span><span class="sxs-lookup"><span data-stu-id="e590f-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="e590f-188">спкфиленамевстр</span><span class="sxs-lookup"><span data-stu-id="e590f-188">SPCFileNameWStr</span></span>

<span data-ttu-id="e590f-189">Функция [**спкфиленамевстр**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) в Xenroll.dll указывает или получает имя файла, в котором следует сохранить ответ сертификата.</span><span class="sxs-lookup"><span data-stu-id="e590f-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="e590f-190">Библиотека CertEnroll.dll не реализует функциональность, позволяющую копировать сертификат в конкретный файл.</span><span class="sxs-lookup"><span data-stu-id="e590f-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="e590f-191">Процесс регистрации автоматически устанавливает цепочку сертификатов в файлы в соответствующих хранилищах.</span><span class="sxs-lookup"><span data-stu-id="e590f-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="e590f-192">вритецерттоксп</span><span class="sxs-lookup"><span data-stu-id="e590f-192">WriteCertToCSP</span></span>

<span data-ttu-id="e590f-193">Функция [**вритецерттоксп**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) в Xenroll.dll указывает или получает логическое значение, указывающее, должен ли сертификат быть записан в [*поставщик служб шифрования*](/windows/desktop/SecGloss/c-gly) (CSP).</span><span class="sxs-lookup"><span data-stu-id="e590f-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="e590f-194">Как правило, при вызове этой функции поставщик является [*смарт-картой*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="e590f-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="e590f-195">В CertEnroll.dll, когда клиент вызывает метод [**регистрации**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) для отправки запроса на сертификат смарт-карты и выдается сертификат, [**Регистрация**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) автоматически устанавливает сертификат на смарт-карту при условии, что карта установлена в модуле чтения.</span><span class="sxs-lookup"><span data-stu-id="e590f-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="e590f-196">Метод [**инсталлреспонсе**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) также автоматически записывает сертификат на смарт-карту.</span><span class="sxs-lookup"><span data-stu-id="e590f-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="e590f-197">вритецерттаусердс</span><span class="sxs-lookup"><span data-stu-id="e590f-197">WriteCertToUserDS</span></span>

<span data-ttu-id="e590f-198">Функция [**вритецерттаусердс**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) в Xenroll.dll указывает или получает логическое значение, указывающее, следует ли сохранять сертификат в хранилище Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e590f-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="e590f-199">Библиотека CertEnroll.dll не реализует функциональность, позволяющую указать хранилище для копирования сертификата.</span><span class="sxs-lookup"><span data-stu-id="e590f-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e590f-200">См. также</span><span class="sxs-lookup"><span data-stu-id="e590f-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e590f-201">Сопоставление Xenroll.dll CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="e590f-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="e590f-202">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="e590f-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
