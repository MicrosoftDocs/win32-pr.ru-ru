---
description: Документ компонентов резервного копирования сохраняется экземплярами интерфейса Ивссбаккупкомпонентс.
ms.assetid: 8c7ebba8-58c4-4733-ba59-802abf902c5e
title: Содержимое документа компонентов резервного копирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e12c88ebffa0037702e1f30dd818d4fd23fe4e2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913388"
---
# <a name="backup-components-document-contents"></a><span data-ttu-id="c4ee8-103">Содержимое документа компонентов резервного копирования</span><span class="sxs-lookup"><span data-stu-id="c4ee8-103">Backup Components Document Contents</span></span>

<span data-ttu-id="c4ee8-104">Документ компонентов резервного копирования сохраняется экземплярами интерфейса [**ивссбаккупкомпонентс**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="c4ee8-104">The Backup Components Document is maintained by instances of the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="c4ee8-105">Этот интерфейс также содержит множество методов управления операциями резервного копирования, управления теневыми копиями и выполнения запросов к состоянию системы.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-105">This interface also contains numerous methods for controlling backup operations, manipulating shadow copies, and querying the system state.</span></span> <span data-ttu-id="c4ee8-106">Однако не все данные документа доступны напрямую через этот интерфейс.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-106">However, not all of the document's information is directly accessible through this interface.</span></span>

<span data-ttu-id="c4ee8-107">Документ компонентов резервного копирования состоит из нескольких наборов данных.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-107">The Backup Components Document consists of several sets of data:</span></span>

-   <span data-ttu-id="c4ee8-108">Сведения о том, какие компоненты были явно добавлены в операцию резервного копирования или восстановления</span><span class="sxs-lookup"><span data-stu-id="c4ee8-108">Information about which components were explicitly included in a backup or restore operation</span></span>
-   <span data-ttu-id="c4ee8-109">Представление хранимой информации о компоненте и модуле записи</span><span class="sxs-lookup"><span data-stu-id="c4ee8-109">A representation of the stored component and writer information</span></span>
-   <span data-ttu-id="c4ee8-110">Сведения о состоянии операции резервного копирования и восстановления</span><span class="sxs-lookup"><span data-stu-id="c4ee8-110">State information about the backup/recover operation</span></span>

<span data-ttu-id="c4ee8-111">Хотя сведения о компоненте доступны как для запрашивающего, так и для модуля записи, доступ к сведениям о состоянии предоставляется только модулю записи.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-111">While the component information is available to both the requester and the writer, only the writer has access to the state information.</span></span>

## <a name="component-inclusion-information"></a><span data-ttu-id="c4ee8-112">Сведения об включении компонентов</span><span class="sxs-lookup"><span data-stu-id="c4ee8-112">Component Inclusion Information</span></span>

<span data-ttu-id="c4ee8-113">Документ компоненты резервного копирования содержит список компонентов, явно включаемых в резервное копирование и восстановление инициатором запроса.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-113">The Backup Components Document contains a list of those components explicitly included in backup and restore by the requester.</span></span> <span data-ttu-id="c4ee8-114">Список содержит следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="c4ee8-114">The list contains the following:</span></span>

-   <span data-ttu-id="c4ee8-115">Явно включаемые [*выбираемые компоненты*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-115">Explicitly included [*selectable components*](vssgloss-s.md).</span></span>

    <span data-ttu-id="c4ee8-116">Включение этих файлов в операции резервного копирования обозначается [**ивссбаккупкомпонентс:: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) и в операциях восстановления с помощью [**Ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-116">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="c4ee8-117">Невыбираемые для резервного копирования подкомпоненты без выбора для предка компонента резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-117">Nonselectable for backup subcomponents without a selectable for backup component ancestor.</span></span>

    <span data-ttu-id="c4ee8-118">Все эти компоненты должны быть включены, если в операцию включаются какие бы то ни было компоненты модуля записи.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-118">All of these components must be included if any components of the writer are to be included in the operation.</span></span> <span data-ttu-id="c4ee8-119">Включение этих файлов в операции резервного копирования обозначается [**ивссбаккупкомпонентс:: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) и в операциях восстановления с помощью [**Ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-119">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="c4ee8-120">Компоненты неявно добавляются в резервную копию ([*подкомпоненты*](vssgloss-s.md)), которые можно [*выбрать для восстановления*](vssgloss-s.md) и явно добавлять в восстановление.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-120">Components implicitly added to the backup ([*subcomponents*](vssgloss-s.md)) that are [*selectable for restore*](vssgloss-s.md) and are explicitly added to the restore.</span></span>

    <span data-ttu-id="c4ee8-121">Эти компоненты могут быть либо выбираемыми, либо невыбираемыми, но иметь возможность выбора предка, который использовался для их неявного выбора для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-121">These components may be either selectable or nonselectable, but have a selectable ancestor that was used to implicitly select them for backup.</span></span> <span data-ttu-id="c4ee8-122">Они добавляются в документ компонентов резервного копирования с помощью [**ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-122">They are added to the Backup Components Document by [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="c4ee8-123">Удостоверения компонентов, неявно включаемых в восстановление, не хранятся в документе компоненты резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-123">The identities of components implicitly included in the restore are not stored in the Backup Components Document.</span></span>

<span data-ttu-id="c4ee8-124">Служба VSS имеет доступ к сведениям о включении компонентов: модули записи без компонентов, явно включенные в восстановление или резервное копирование, не получают события VSS после создания [*PrepareForBackup*](vssgloss-p.md) или предварительно [*восстановленных*](vssgloss-p.md) событий.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-124">VSS has access to information about component inclusion: writers with no components explicitly included in a restore or backup receive no VSS events following the generation of the [*PrepareForBackup*](vssgloss-p.md) or [*PreRestore*](vssgloss-p.md) events.</span></span>

<span data-ttu-id="c4ee8-125">Модули записи не могут напрямую запрашивать эти сведения.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-125">Writers cannot directly query this information.</span></span> <span data-ttu-id="c4ee8-126">Это не является существенным ограничением, так как при проектировании отдельные модули записи VSS не должны требовать подробных сведений о состоянии других модулей записи в системе и, как отмечалось выше, они не будут участвовать в операции VSS.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-126">This is not a significant limitation because by design, individual VSS writers should not require detailed information about the status of other writers on the system and, as noted above, those with no included components will not have to participate in the VSS operation.</span></span>

<span data-ttu-id="c4ee8-127">Инициатор запроса может определить, какие компоненты были явно добавлены в операцию.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-127">A requester can determine which components have been explicitly included in an operation.</span></span>

<span data-ttu-id="c4ee8-128">Метод [**ивссбаккупкомпонентс:: жетвритеркомпонентскаунт**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) возвращает число модулей записи со сведениями о компонентах, хранящихся в документе резервных копий (а не число компонентов в документе).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-128">The [**IVssBackupComponents::GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) method returns the number of writers with component information stored in the Backup Components Document (and not the number of components in the document).</span></span>

<span data-ttu-id="c4ee8-129">Инициатор запроса индексирует данные хранимой записи с помощью [**ивссбаккупкомпонентс:: жетвритеркомпонентс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), которая возвращает экземпляры интерфейса [**ивссвритеркомпонентсекст**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) .</span><span class="sxs-lookup"><span data-stu-id="c4ee8-129">The requester indexes through the stored writer information using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface.</span></span> <span data-ttu-id="c4ee8-130">Интерфейс **ивссвритеркомпонентсекст** позволяет инициатору запроса получить [*класс модуля записи*](vssgloss-w.md) и [*экземпляр модуля*](vssgloss-w.md) записи участвующих модулей записи, а также получить доступ к сведениям о его компонентах, хранящихся в документе архивных компонентов.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-130">The **IVssWriterComponentsExt** interface allows the requester to obtain the [*writer class*](vssgloss-w.md) and [*writer instance*](vssgloss-w.md) of participating writers, as well as to access information about those of its components stored in the Backup Components Document.</span></span>

## <a name="information-on-included-components"></a><span data-ttu-id="c4ee8-131">Сведения о включенных компонентах</span><span class="sxs-lookup"><span data-stu-id="c4ee8-131">Information on Included Components</span></span>

<span data-ttu-id="c4ee8-132">В документе компонентов резервного копирования содержится представление данных компонента (которые не включают сведения о пути и спецификации файла), доступ к которым осуществляется через экземпляры интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="c4ee8-132">The Backup Components Document's representation of the component data (which does not include path and file specification information), which is accessed through instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="c4ee8-133">Запрашивающие стороны и модули записи получают доступ к экземплярам интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) различными способами.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-133">Requesters and writers obtain access to instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface in different ways.</span></span>

<span data-ttu-id="c4ee8-134">Инициатор запроса проверяет данные компонента в модуле записи с помощью экземпляров интерфейса [**ивссвритеркомпонентсекст**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) , возвращаемого [**Ивссбаккупкомпонентс:: жетвритеркомпонентс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-134">A requester examines component data on a writer by writer basis by using instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span></span>

<span data-ttu-id="c4ee8-135">Помимо идентификационной информации модуля записи, интерфейс [**ивссвритеркомпонентсекст**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) предоставляет массив экземпляров интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) — по одному для каждого из выбранных модулей записи.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-135">In addition to the writer identification information, the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface provides an array of instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface—one for each of the selected writers included components.</span></span>

<span data-ttu-id="c4ee8-136">Как отмечалось в [жизненном цикле документа компоненты резервного копирования](backup-components-document-life-cycle.md), модули записи могут получить доступ к одной и той же информации через интерфейс [**ивссвритеркомпонентс**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) при обработке события PrepareForBackup, Препарефорснапшот, моментального снимка, баккупкомплете, с помощью инструкции RESTORE или на этапе восстановления.</span><span class="sxs-lookup"><span data-stu-id="c4ee8-136">As noted in [Backup Components Document Life Cycle](backup-components-document-life-cycle.md), the writers can gain access to the same information through the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface when handling the PrepareForBackup, PrepareForSnapshot, PostSnapshot, BackupComplete, PreRestore, or PostRestore event.</span></span>

<span data-ttu-id="c4ee8-137">[**Ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) позволяет модулю записи и инициатору запроса получить следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="c4ee8-137">[**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) allows both writer and requesters to get the following information:</span></span>

-   <span data-ttu-id="c4ee8-138">Имя, тип и [*логический путь*](vssgloss-l.md) компонента ([**жеткомпонентнаме**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**жеткомпоненттипе**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**жетлогикалпас**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-138">A component's name, type, and [*logical path*](vssgloss-l.md) ([**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**GetComponentType**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span></span>
-   <span data-ttu-id="c4ee8-139">Как компонент должен быть восстановлен, как указано в [*целевом объекте восстановления*](vssgloss-r.md) ([**Ивсскомпонент:: жетресторетаржет**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-139">How a component should be restored as indicated by the [*restore target*](vssgloss-r.md) ([**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span></span>
-   <span data-ttu-id="c4ee8-140">Если при восстановлении файла использовалось альтернативное расположение ([**жеталтернателокатионмаппинг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**жеталтернателокатионмаппингкаунт**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-140">If an alternate location was used in restoring a file ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span></span>
-   <span data-ttu-id="c4ee8-141">Новые целевые сведения (если таковые имеются) ([**жетневтаржет**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**жетневтаржеткаунт**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-141">New target information, if any ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span></span>
-   <span data-ttu-id="c4ee8-142">Сообщения об ошибках до и после восстановления ([**жетпрересторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**жетпостресторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-142">Pre-and post-restore error messages ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span></span>
-   <span data-ttu-id="c4ee8-143">Если для компонента [*резервного копирования*](vssgloss-s.md) , определяющего набор компонентов, выбран параметр для восстановления ([**исселектедфорресторе**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore)), то</span><span class="sxs-lookup"><span data-stu-id="c4ee8-143">If a [*selectable for backup*](vssgloss-s.md) component defining a component set has been selected for restore ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span></span>
-   <span data-ttu-id="c4ee8-144">Успешность резервного копирования или восстановления ([**жетбаккупсукцеедед**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**жетфилересторестатус**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-144">Whether a backup or restore succeeded ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span></span>
-   <span data-ttu-id="c4ee8-145">Любые параметры резервного копирования или восстановления, которые могут быть заданы [**ивссбаккупкомпонентс:: сетбаккупоптионс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) или [**Ивссбаккупкомпонентс:: сетрестореоптионс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**жетбаккупоптионс**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions)).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-145">Any writer-specific backup or restore options that may have been set by [**IVssBackupComponents::SetBackupOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) or [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**GetBackupOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="c4ee8-146">Метаданные для резервного копирования или восстановления метаданных конкретного модуля записи ([**жетбаккупметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**жетрестореметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-146">Any writer-specific metadata backup or restore metadata ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span></span>
-   <span data-ttu-id="c4ee8-147">Сведения о временной метке ([**жетбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**жетпревиаусбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-147">Time-stamp information ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span></span>
-   <span data-ttu-id="c4ee8-148">Сведения о подкомпонентах резервного копирования, явно включаемых в восстановление ([**жетресторесубкомпонент**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**жетресторесубкомпоненткаунт**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-148">Information about backup subcomponents explicitly included in a restore ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span></span>

<span data-ttu-id="c4ee8-149">В отличие от запрашивающих, модули записи могут изменять определенную информацию в документе компоненты резервного копирования через интерфейс [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) :</span><span class="sxs-lookup"><span data-stu-id="c4ee8-149">Unlike requesters, writers can change certain information in the Backup Components Document via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface:</span></span>

-   <span data-ttu-id="c4ee8-150">Как компонент должен быть восстановлен, как указано в целевом объекте восстановления ([**ивсскомпонент:: сетресторетаржет**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-150">How a component should be restored as indicated by the restore target ([**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span></span>
-   <span data-ttu-id="c4ee8-151">Метаданные для записи резервных копий и восстановления ([**ивсскомпонент:: сетбаккупметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**Ивсскомпонент:: сетрестореметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)).</span><span class="sxs-lookup"><span data-stu-id="c4ee8-151">Writer-specific backup and restore metadata ([**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="c4ee8-152">Сведения о временной метке ([**сетбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-152">Time-stamp information ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span></span>
-   <span data-ttu-id="c4ee8-153">Сообщения об ошибках до и после восстановления ([**сетпрересторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**сетпостресторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="c4ee8-153">Pre- and post-restore error messages ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span></span>

## <a name="requester-state-information"></a><span data-ttu-id="c4ee8-154">Сведения о состоянии инициатора запроса</span><span class="sxs-lookup"><span data-stu-id="c4ee8-154">Requester State Information</span></span>

<span data-ttu-id="c4ee8-155">Запрашивающие стороны вставляют сведения о состоянии операции резервного копирования или восстановления в документ компонентов резервного копирования с помощью интерфейса [**ивссбаккупкомпонентс**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="c4ee8-155">Requesters insert information about the state of a backup or restore operation into the Backup Components Document using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="c4ee8-156">Приложения для записи могут запрашивать эти сведения с помощью класса [**квссвритер**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) .</span><span class="sxs-lookup"><span data-stu-id="c4ee8-156">Writer applications are able to query for this information through the [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) class.</span></span>

<span data-ttu-id="c4ee8-157">Сведения о состоянии, хранящиеся в документе резервного копирования компонентов, включают следующее:</span><span class="sxs-lookup"><span data-stu-id="c4ee8-157">State information stored in the Backup Components Document includes the following:</span></span>

<span data-ttu-id="c4ee8-158">Общие сведения о резервной копии</span><span class="sxs-lookup"><span data-stu-id="c4ee8-158">General Information about the Backup</span></span>

-   <span data-ttu-id="c4ee8-159">Общий тип резервного копирования (добавочный, разностный или полный);</span><span class="sxs-lookup"><span data-stu-id="c4ee8-159">The overall backup type (incremental, differential, or full)</span></span><dl> <dt>

<span data-ttu-id="c4ee8-160">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-160">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-161">Извлекается модулями записи с помощью [ **квссвритер:: жетбаккуптипе**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-161">Retrieved by writers using [**CVssWriter::GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span></span>
</dt> </dl>
-   Whether component operations are supported<dl> <dt>

<span data-ttu-id="c4ee8-162">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-162">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-163">Извлекается модулями записи с помощью [ **квссвритер:: арекомпонентсселектед**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-163">Retrieved by writers using [**CVssWriter::AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span></span>
</dt> </dl>
-   Whether the bootable system state is backed up<dl> <dt>

<span data-ttu-id="c4ee8-164">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-164">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-165">Извлекается модулями записи с помощью [ **квссвритер:: исбутаблестатебаккедуп**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-165">Retrieved by writers using [**CVssWriter::IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span></span>
</dt> </dl>
-   Whether partial file operations are supported<dl> <dt>

<span data-ttu-id="c4ee8-166">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-166">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-167">Извлекается модулями записи с помощью [ **квссвритер:: испартиалфилесуппортенаблед**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-167">Retrieved by writers using [**CVssWriter::IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span></span>
</dt> </dl>

<span data-ttu-id="c4ee8-168">Общие сведения о восстановлении</span><span class="sxs-lookup"><span data-stu-id="c4ee8-168">General Information about the Restore</span></span>

-   <span data-ttu-id="c4ee8-169">Общий тип восстановления (для восстановления — копирование или импорт)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-169">The overall restore type (whether restore is by copy or import)</span></span><dl> <dt>

<span data-ttu-id="c4ee8-170">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетресторестате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-170">Set by requesters using [**IVssBackupComponents::SetRestoreState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-171">Извлекается модулями записи с помощью [ **квссвритер:: жетресторетипе**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-171">Retrieved by writers using [**CVssWriter::GetRestoreType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span></span>
</dt> </dl>

<span data-ttu-id="c4ee8-172">Сведения о вспомогательных файлах</span><span class="sxs-lookup"><span data-stu-id="c4ee8-172">Information about Supporting Files</span></span>

-   <span data-ttu-id="c4ee8-173">Расположение файлов Ranges, используемых конкретным компонентом в частичных операциях с файлами</span><span class="sxs-lookup"><span data-stu-id="c4ee8-173">The location of ranges files used by a specific component in partial file operations</span></span><dl> <dt>

<span data-ttu-id="c4ee8-174">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетранжесфилепас**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-174">Set by requesters using [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-175">Извлекается модулями записи (или запрашивающими стороны) с помощью [ **ивсскомпонент:: жетпартиалфиле**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-175">Retrieved by writers (or requesters) using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span></span>
</dt> </dl>

<span data-ttu-id="c4ee8-176">Состояние информации</span><span class="sxs-lookup"><span data-stu-id="c4ee8-176">Status of Information</span></span>

-   <span data-ttu-id="c4ee8-177">Укажите, успешно ли создана резервная копия одного из компонентов данного модуля записи</span><span class="sxs-lookup"><span data-stu-id="c4ee8-177">Indicate whether one of a given writer's components was successfully backed up</span></span><dl> <dt>

<span data-ttu-id="c4ee8-178">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетбаккупсукцеедед**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-178">Set by requesters using [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-179">Извлекается модулями записи и запрашивающими стороны с помощью [ **ивсскомпонент:: жетбаккупсукцеедед**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-179">Retrieved by writers and requesters using [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span></span>
</dt> </dl>
-   Indicate whether one of a given writer's components was successfully restored<dl> <dt>

<span data-ttu-id="c4ee8-180">Задается инициаторами запроса с помощью [ **ивссбаккупкомпонентс:: сетфилересторестатус**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-180">Set by requesters using [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-181">Извлекается модулями записи и инициатором запроса с помощью [ **ивсскомпонент:: жетфилересторестатус**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-181">Retrieved by writers and requester using [**IVssComponent::GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span></span>
</dt> </dl>

<span data-ttu-id="c4ee8-182">Сведения о Writer-Settable</span><span class="sxs-lookup"><span data-stu-id="c4ee8-182">Writer-Settable Information</span></span>

-   <span data-ttu-id="c4ee8-183">Дополнительная спецификация резервного копирования для одного из компонентов конкретного модуля записи</span><span class="sxs-lookup"><span data-stu-id="c4ee8-183">Additional backup specification for one of a given writer's components</span></span><dl> <dt>

<span data-ttu-id="c4ee8-184">Задается модулями записи с помощью [ **ивсскомпонент:: сетбаккупметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-184">Set by writers using [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-185">Извлекается модулями записи и запрашивающими стороны с помощью [ **ивсскомпонент:: жетбаккупметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-185">Retrieved by writers and requesters using [**IVssComponent::GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span></span>
</dt> </dl>
-   Additional restore specification for one of a given writer's components<dl> <dt>

<span data-ttu-id="c4ee8-186">Задается модулями записи с помощью [ **ивсскомпонент:: сетрестореметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-186">Set by writers using [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-187">Извлекается модулями записи и запрашивающими стороны с помощью [ **ивсскомпонент:: жетрестореметадата**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-187">Retrieved by writers and requesters using [**IVssComponent::GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span></span>
</dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the current backup of one of its component's backups<dl> <dt>

<span data-ttu-id="c4ee8-188">Задается модулями записи с помощью [ **ивсскомпонент:: сетбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-188">Set by writers using [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-189">Извлекается модулями записи и запрашивающими стороны с помощью [ **ивсскомпонент:: жетбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-189">Retrieved by writers and requesters using [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span></span>
<span data-ttu-id="c4ee8-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">Ивсскомпонент:: Сетбаккупстамп</a></span><span class="sxs-lookup"><span data-stu-id="c4ee8-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent::SetBackupStamp</a></span></span><dl> <dt>

<span data-ttu-id="c4ee8-191">Сохраняются и задаются запрашивающими стороны для определенного компонента с помощью [ **ивссбаккупкомпонентс:: сетпревиаусбаккупстамп**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-191">Stored and set by requesters for a specific component using [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-192">Извлекается модулями записи и запрашивающими стороны с помощью [ **ивсскомпонент:: жетпревиаусбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-192">Retrieved by writers and requesters using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span></span>
</dt> </dl>
-   Error messages for failure before and after restore operations<dl> <dt>

<span data-ttu-id="c4ee8-193">Задается модулями записи с помощью [**ивсскомпонент:: сетпрересторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) или [**Ивсскомпонент:: сетпостресторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-193">Set by writers using [**IVssComponent::SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) or [**IVssComponent::SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span></span>
</dt> <dt>

<span data-ttu-id="c4ee8-194">Извлекается модулями записи и запрашивающими стороны с помощью [**ивсскомпонент:: жетпрересторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) или [**Ивсскомпонент:: жетпостресторефаилуремсг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="c4ee8-194">Retrieved by writers and requesters using [**IVssComponent::GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) or [**IVssComponent::GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span></span>
</dt> </dl>

 

 
