---
description: 'Документ метаданных модуля записи содержит три набора данных: идентификация модуля записи и сведения о классификации, спецификации уровня записи и данные компонентов.'
ms.assetid: 1a84790a-8f46-4e1b-8e45-5036830e8fee
title: Содержимое документа метаданных модуля записи
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f222977f1c8d785e6f69613f219545dc3402af7f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072756"
---
# <a name="writer-metadata-document-contents"></a>Содержимое документа метаданных модуля записи

Документ метаданных модуля записи содержит три набора данных: идентификация модуля записи и сведения о классификации, спецификации уровня записи и данные компонентов.

## <a name="writer-identification-information"></a>Сведения об идентификации модуля записи

Сведения о идентификации и классификации модуля записи включают следующее.

-   Имя модуля записи
-   [*Идентификатор класса модуля записи*](vssgloss-w.md)
-   [*Экземпляр модуля записи*](vssgloss-w.md)
-   Как данные, управляемые модулем записи, используются в основной системе (см. [**раздел \_ \_ тип использования VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type)).
-   Тип данных, управляемых модулем записи (см. [**раздел \_ \_ тип источника VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type)).

За исключением экземпляра модуля записи, который является уникальным и создается системой при инициализации объекта [**квссвритер**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) , все эти значения задаются модулем записи при вызове [**Квссвритер:: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize) и доступны инициатору запроса путем вызова [**ивссексаминевритерметадата:: Identity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).

Поскольку экземпляр модуля записи создается уникальным образом, хранимый экземпляр модуля записи, извлеченный из документа метаданных сохраненного модуля записи, скорее всего, не будет полезен.

Проверка [**\_ \_ типа использования VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type)позволяет приложению определить, управляет ли модуль записи общими данными приложений, или если файлы, с которыми он работает, являются частью состояния загрузки системы или используются системной службой. Приложения для резервного копирования и восстановления должны учитывать типы использования для обеспечения стабильной работы системы.

Флаг [**\_ \_ типа источника VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type) указывает, какой тип приложения модуль записи, управляющий данными для резервного копирования, выполняет во время нормальной работы.

В настоящее время различие ограничено указанием того, создает ли модуль записи файлы в рамках операций транзакционной или нетранзакционной базы данных, или если файлы являются результатом более общего типа действий. Этот список может расти со временем. Эти сведения могут быть полезны при определении обычного уровня активности, ожидаемого в файлах модуля записи.

## <a name="writer-level-specification"></a>Спецификация Writer-Level

Спецификации уровня модуля записи содержат сведения, которые являются частью модуля записи в области видимости, что применяется ко всем данным независимо от того, какой компонент управляет им.

Модуль записи всегда должен задавать [*методы восстановления*](vssgloss-r.md).

При необходимости можно указать следующее:

-   Исключить список файлов
-   [*Сопоставления альтернативного расположения*](vssgloss-a.md) для восстановления

Списки включения и исключения файлов содержат сведения о файлах, которые выходят за рамки компонентов, а их спецификация заменяет спецификацию компонента.

## <a name="restore-method-specification"></a>Спецификация метода Restore

[*Метод Restore*](vssgloss-r.md) задается в документе метаданных модуля записи с помощью [**Ивсскреатевритерметадата:: сетресторемесод**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) и извлекается инициатором запроса с [**ивссексаминевритерметадата:: жетресторемесод**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod).

При установке метода Restore модуль записи указывает предпочтительный способ восстановления файлов, также известный как исходный целевой объект восстановления, для всех файлов, управляемых модулем записи. Например, метод Restore указывает, должны ли все файлы, управляемые модулем записи, перезаписывать файлы, находящиеся на диске. (Дополнительные сведения см. в разделе [конфигурации восстановления VSS](vss-restore-configurations.md) и [**\_ \_ перечисление ресторемесод VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) .)

## <a name="exclude-file-list-specification"></a>Исключить спецификацию списка файлов

Список исключений позволяет точно настраивать спецификации подстановочных знаков в компонентах, явно предотвращая включение определенных файлов в резервный набор данных.

Например, компонент может иметь [*набор файлов*](vssgloss-f.md) , содержащий спецификацию файла c: \\ Database \\ \* . \* . Хотя это удобное определение, иногда могут быть созданы временные файлы (например, Form \* . tmp), и модуль записи всегда хочет предотвратить их резервное копирование.

В этом случае средство записи добавляет \* . tmp в список исключений с помощью [**ивсскреатевритерметадата:: аддексклудефилес**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addexcludefiles). Эта спецификация может быть рекурсивной.

Инициатор запроса будет запрашивать эту информацию с помощью [**ивссексаминевритерметадата:: жетексклудефиле**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getexcludefile).

Список исключаемых файлов имеет приоритет над списками файлов компонентов.

Таким образом, список файлов, заданных для резервного копирования в документе метаданных модуля записи, будет состоять из всех файлов, указанных в [*явно включенных*](vssgloss-e.md) компонентах, и [*неявно включенных*](vssgloss-i.md) компонентов, за исключением всех исключаемых файлов.

## <a name="alternate-location-mappings-specification"></a>Спецификация альтернативного сопоставления расположения

Сопоставления альтернативного расположения изначально устанавливаются во время создания документа метаданных модуля записи и указывают расположение на диске, в котором файлы могут быть восстановлены, если восстановление файла в исходное расположение невозможно.

Сведения добавляются в виде строки расширенных символов, заканчивающейся нулем, с помощью [**ивсскреатевритерметадата:: аддалтернателокатионмаппинг**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addalternatelocationmapping) и извлекаются как объект [**Ивссвмфиледеск**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) с помощью [**ивссексаминевритерметадата:: GetAlternateLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping).

Несмотря на то, что сопоставления альтернативного расположения указаны и проверяются с помощью интерфейсов уровня записи ([**ивсскреатевритерметадата**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) и [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata)), они указываются в виде [*наборов файлов*](vssgloss-f.md). Набор файлов, используемый при указании сопоставления альтернативного расположения (путь, спецификация файла и флаг рекурсии), должен соответствовать одному из наборов файлов, уже добавленных в один из компонентов модуля записи (см. раздел [Добавление файлов в компоненты](definition-of-components-by-writers.md)).

Дополнительные сведения см. в разделе [расположения резервного копирования и восстановления не по умолчанию](non-default-backup-and-restore-locations.md).

## <a name="component-level-information"></a>Сведения о Component-Level

[*Компоненты*](vssgloss-c.md) представляют собой коллекции файлов, образующих логическую единицу в целях резервного копирования и восстановления. Все файлы компонента (за исключением явно исключенных) должны быть резервными копиями и восстановлены как единое целое.

Модули записи добавляют компоненты с помощью [**ивсскреатевритерметадата:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), указывая следующие сведения о компоненте:

-   Тип
-   Имя
-   Логический путь (если имеется)
-   Поддерживаемая функция
-   [*Выбор*](vssgloss-s.md)
-   Метаданные, используемые модулем записи во время восстановления
-   Отображение сведений
-   Сведения об уведомлении

[*Выбор варианта резервного копирования*](vssgloss-s.md) и возможность [*выбора для восстановления*](vssgloss-s.md) полностью независимы друг от друга, а модуль записи использует их вместе с логическими путями для обозначения отношений между различными компонентами, которыми он управляет. Модули записи могут указывать, какие компоненты требуются для [*явного включения*](vssgloss-e.md) (которые могут быть явно включены в запрос запроса), и те, которые могут быть включены только [*неявно*](vssgloss-i.md). (См. раздел [Работа с выборкой и логическими путями](working-with-selectability-and-logical-paths.md).)

Файлы добавляются в указанный компонент с помощью [**ивсскреатевритерметадата:: аддфилестофилеграуп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**Ивсскреатевритерметадата:: адддатабасефилес**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles)или [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles). (См. раздел [Добавление файлов в компоненты](definition-of-components-by-writers.md).)

При добавлении файлов в компонент во время резервного копирования модуль записи должен указать набор файлов (путь, спецификацию файла и флаг рекурсии), который определяет файлы для резервного копирования.

Модули записи могут также указывать [*альтернативный путь*](vssgloss-a.md) для резервного копирования, который не следует путать с [*сопоставлениями альтернативного расположения*](vssgloss-a.md) , упомянутыми ранее. Этот альтернативный путь указывает на расположение файлов, которые будут копироваться при резервном копировании тома, не по умолчанию.

Сведения об определенном компоненте в документе метаданных модуля записи можно получить с помощью интерфейса [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) , возвращаемого [**ивссексаминевритерметадата::-Component**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).

Файлы и пути возвращаются в [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) как объекты [**ивссвмфиледеск**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) .

Сведения о компоненте модуля записи подробно рассматриваются в разделе [Определение компонентов с помощью модулей записи](definition-of-components-by-writers.md).

 

 



