---
description: Существуют определенные обстоятельства, в которых файлы для резервного копирования не являются расположением по умолчанию для этих файлов.
ms.assetid: b9e96827-a678-45ca-8ede-4508a406f071
title: Работа с альтернативными путями во время резервного копирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a98e93af4d12b804032a64841542e731ff77e048
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692339"
---
# <a name="working-with-alternate-paths-during-backup"></a><span data-ttu-id="647af-103">Работа с альтернативными путями во время резервного копирования</span><span class="sxs-lookup"><span data-stu-id="647af-103">Working with Alternate Paths during Backup</span></span>

<span data-ttu-id="647af-104">Существуют определенные обстоятельства, в которых файлы для резервного копирования не являются расположением по умолчанию для этих файлов.</span><span class="sxs-lookup"><span data-stu-id="647af-104">There are certain circumstances where the files to be backed up are not the default location for those files.</span></span>

<span data-ttu-id="647af-105">Например, некоторые модули записи не гарантируют, что данные записываются в течение временного интервала между событиями [*замораживания*](vssgloss-f.md) и [*разморозки*](vssgloss-t.md) .</span><span class="sxs-lookup"><span data-stu-id="647af-105">For example, some writers cannot guarantee to have flushed of their data within the time window between [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) events.</span></span> <span data-ttu-id="647af-106">Такие модули записи могут создавать дублирующиеся файлы, содержащие последнюю известную удачную конфигурацию в исходном каталоге, отличном от используемого по умолчанию, или по [*альтернативному пути*](vssgloss-a.md).</span><span class="sxs-lookup"><span data-stu-id="647af-106">Such writers may choose to generate duplicate files containing a last known good configuration in a non-default source directory, or [*alternate path*](vssgloss-a.md).</span></span>

<span data-ttu-id="647af-107">Термин альтернативный путь, используемый с VSS, не следует путать с [*сопоставлением альтернативного расположения*](vssgloss-a.md).</span><span class="sxs-lookup"><span data-stu-id="647af-107">The term alternate path, as used with VSS, should not be confused with the term [*alternate location mapping*](vssgloss-a.md).</span></span> <span data-ttu-id="647af-108">Альтернативные пути используются только во время операций резервного копирования и относятся к альтернативному источнику, из которого производится резервное копирование.</span><span class="sxs-lookup"><span data-stu-id="647af-108">Alternate paths are used only during backup operations, and refer to an alternate source from which to back up.</span></span> <span data-ttu-id="647af-109">Сопоставления альтернативного расположения используются только во время операций восстановления и ссылаются на альтернативное назначение для операций восстановления.</span><span class="sxs-lookup"><span data-stu-id="647af-109">Alternate location mappings are used only during restore operations, and refer to an alternate destination for restore operations.</span></span>

<span data-ttu-id="647af-110">**Использование альтернативного пути во время резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="647af-110">**To use an alternate path during backup**</span></span>

1.  <span data-ttu-id="647af-111">На этапе обнаружения операции резервного копирования (см. [Обзор этапа обнаружения резервных копий](overview-of-the-backup-discovery-phase.md)) инициатор запроса должен исследовать данные компонента каждого модуля записи с помощью [**ивссексаминевритерметадата::-Component**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) и Get Instances интерфейса [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) .</span><span class="sxs-lookup"><span data-stu-id="647af-111">During the discovery phase of a backup operation (see [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md)) a requester would examine each writer's component data using [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) and get instances of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface.</span></span>
2.  <span data-ttu-id="647af-112">Затем инициатор запроса получает [*набор файлов*](vssgloss-f.md) , управляемых каждым компонентом, представленный экземплярами интерфейса [**ивссвмфиледеск**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) , вызывая метод [**ивссвмкомпонент::-File**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getfile) .</span><span class="sxs-lookup"><span data-stu-id="647af-112">A requester then obtains the [*file set*](vssgloss-f.md) managed by each component, represented by instances of the [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) interface, by calling the [**IVssWMComponent::GetFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getfile) method.</span></span>
3.  <span data-ttu-id="647af-113">Помимо пути ([**ивссвмфиледеск::**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)ивссвмфиледеск), спецификации файла ([**:: жетфилеспек**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec)) и флага рекурсии ([**ивссвмфиледеск:: жетрекурсиве**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive)), объект [**ивссвмфиледеск**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) может содержать альтернативное расположение (используемое в качестве альтернативного пути для операций резервного копирования и сопоставление альтернативного расположения для операций восстановления) с помощью метода [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) .</span><span class="sxs-lookup"><span data-stu-id="647af-113">In addition to a path ([**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), a file specification ([**IVssWMFiledesc::GetFilespec**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec)), and a recursion flag ([**IVssWMFiledesc::GetRecursive**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive)), a [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) object may contain an alternate location (used as an alternate path for backup operations and an alternate location mapping for restore operations) by using the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method.</span></span>
4.  <span data-ttu-id="647af-114">Если значение, возвращаемое [**ивссвмфиледеск:: жеталтернателокатион**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) , не равно null, приложения резервного копирования используют это значение вместо значения, полученного из [**Ивссвмфиледеск:: Multipath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) для выбора и поиска файлов для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="647af-114">If the value returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) is non-NULL, backup applications use that value instead of the value obtained from [**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) to select and locate files to back up.</span></span>
5.  <span data-ttu-id="647af-115">Несмотря на использование альтернативного пути, запрашивающие стороны должны по-прежнему учитывать спецификацию файла и рекурсивные параметры, возвращаемые [**ивссвмфиледеск:: жетфилеспек**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec) и [**Ивссвмфиледеск:: жетрекурсиве**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive).</span><span class="sxs-lookup"><span data-stu-id="647af-115">Despite using an alternate path, requesters should still respect the file specification and recursive settings returned by [**IVssWMFiledesc::GetFilespec**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec) and [**IVssWMFiledesc::GetRecursive**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive).</span></span>

<span data-ttu-id="647af-116">Обратите внимание, что при восстановлении любой альтернативный путь, т. е. альтернативное расположение, возвращаемое экземпляром [**ивссвмфиледеск:: жеталтернателокатион**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) , получено из экземпляра [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent), который, в свою очередь, был извлечен из экземпляра [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , получаемого путем извлечения хранимого документа метаданных модуля записи, не используется во время восстановления.</span><span class="sxs-lookup"><span data-stu-id="647af-116">Note that on restore, any alternate path—that is, an alternate location returned by an instance of [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) gotten from an instance of [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent), which in turn was obtained from an instance of [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) gotten by retrieving a stored Writer Metadata Document—is not used during restoration.</span></span>

<span data-ttu-id="647af-117">Либо путь по умолчанию (возвращаемый методом [**Multipath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) того же экземпляра [**ивссвмфиледеск**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)) используется для определения расположения для восстановления, либо сопоставление альтернативного расположения, найденное с помощью метода [**ивссвмфиледеск:: жеталтернателокатион**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) , указывает, где следует восстановить файл (см. раздел [Работа с альтернативными расположениями во время восстановления](working-with-alternate-locations-during-restore.md)).</span><span class="sxs-lookup"><span data-stu-id="647af-117">Either the default path (returned by the [**GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) method of the same instance of [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)) is used to define a restore location, or an alternate location mapping—found by using the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method—indicates where a file is to be restored (see [Working with Alternate Locations during Restore](working-with-alternate-locations-during-restore.md)).</span></span>

 

 



