---
description: Поставщики управляют работающими томами и создают их теневые копии по запросу.
ms.assetid: 4e6b46b0-df9e-4458-b0ac-e237d7656337
title: Поставщики
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bb336dbb51fcbd715ea236ecdc0c62d81daf29d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692889"
---
# <a name="providers"></a><span data-ttu-id="e04bb-103">Поставщики</span><span class="sxs-lookup"><span data-stu-id="e04bb-103">Providers</span></span>

<span data-ttu-id="e04bb-104">[*Поставщики*](vssgloss-p.md) управляют работающими томами и создают их теневые копии по запросу.</span><span class="sxs-lookup"><span data-stu-id="e04bb-104">[*Providers*](vssgloss-p.md) manage running volumes and create the shadow copies of them on demand.</span></span>

<span data-ttu-id="e04bb-105">В ответ на запрос от инициатора запроса поставщик создает события COM для сигнализации приложений с помощью теневой копии, затем создает и обслуживает эту копию, пока она больше не нужна.</span><span class="sxs-lookup"><span data-stu-id="e04bb-105">In response to a request from a requester, a provider generates COM events to signal applications of a coming shadow copy, then creates and maintains that copy until it is no longer needed.</span></span>

<span data-ttu-id="e04bb-106">В то время как теневая копия существует, поставщик создает среду, в которой есть две независимые копии тома, которые были скопированы: один запущенный диск используется и обновляется как обычная, а другой — с фиксированным и стабильным для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="e04bb-106">While a shadow copy is in existence, the provider creates an environment where there are effectively two independent copies of any volume that has been shadow copied: one the running disk being used and updated as normal, the other a copy that is disk fixed and stable for backup.</span></span>

<span data-ttu-id="e04bb-107">Хотя поставщик по умолчанию предоставляется как часть Windows, другие поставщики могут предоставлять собственные реализации, оптимизированные для собственных предложений по оборудованию и программному обеспечению хранилища.</span><span class="sxs-lookup"><span data-stu-id="e04bb-107">While a default provider is supplied as part of Windows, other vendors are free to supply their own implementations that are optimized for their own storage hardware and software offerings.</span></span>

<span data-ttu-id="e04bb-108">С точки зрения разработчика приложения для конечных пользователей или резервного копирования и восстановления, все поставщики будут иметь один и тот же интерфейс (см. раздел [Выбор поставщиков](selecting-providers.md)).</span><span class="sxs-lookup"><span data-stu-id="e04bb-108">From the point of view of an end-user or backup/restore application developer, all providers will have the same interface (see [Selecting Providers](selecting-providers.md)).</span></span>

<span data-ttu-id="e04bb-109">Все поставщики должны иметь возможность выполнять следующие действия:</span><span class="sxs-lookup"><span data-stu-id="e04bb-109">All providers must be able to do the following:</span></span>

-   <span data-ttu-id="e04bb-110">Перехват запросов ввода-вывода между файловой системой и базовой системой массового хранения.</span><span class="sxs-lookup"><span data-stu-id="e04bb-110">Intercept I/O requests between the file system and the underlying mass storage system.</span></span>
-   <span data-ttu-id="e04bb-111">Захватывать и получать сведения о состоянии тома во время создания теневого копирования, сохраняя представление файлов на диске с неполными операциями ввода-вывода, которые отражаются в состоянии.</span><span class="sxs-lookup"><span data-stu-id="e04bb-111">Capture and retrieve the status of a volume at the time of shadow copy, maintaining a "point in time" view of the files on the disk with no partial I/O operations reflected in its state.</span></span>
-   <span data-ttu-id="e04bb-112">Используйте представление "точка во времени" для предоставления (минимальных версий приложений с поддержкой VSS) виртуального тома, содержащего теневые скопированные данные.</span><span class="sxs-lookup"><span data-stu-id="e04bb-112">Use this "point in time" view to expose (minimally to VSS-enabled applications) a virtual volume containing the shadow copied data.</span></span>

<span data-ttu-id="e04bb-113">В зависимости от того, как это сделано, поставщик может иметь один из трех типов:</span><span class="sxs-lookup"><span data-stu-id="e04bb-113">Depending on how this is done, a provider can be one of three types:</span></span>

-   [<span data-ttu-id="e04bb-114">Поставщик системы</span><span class="sxs-lookup"><span data-stu-id="e04bb-114">System Provider</span></span>](#system-provider)
-   [<span data-ttu-id="e04bb-115">Поставщики программного обеспечения</span><span class="sxs-lookup"><span data-stu-id="e04bb-115">Software Providers</span></span>](#software-providers)
-   [<span data-ttu-id="e04bb-116">Поставщики оборудования</span><span class="sxs-lookup"><span data-stu-id="e04bb-116">Hardware Providers</span></span>](#hardware-providers)

## <a name="system-provider"></a><span data-ttu-id="e04bb-117">Поставщик системы</span><span class="sxs-lookup"><span data-stu-id="e04bb-117">System Provider</span></span>

<span data-ttu-id="e04bb-118">Один поставщик теневых копий, [*поставщик системы*](vssgloss-s.md), предоставляется как часть установки операционной системы Windows по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e04bb-118">One shadow copy provider, the [*system provider*](vssgloss-s.md), is supplied as a default part of a Windows operating system installation.</span></span> <span data-ttu-id="e04bb-119">В настоящее время поставщик системы является определенным экземпляром поставщика программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="e04bb-119">Currently, the system provider is a particular instance of a software provider.</span></span> <span data-ttu-id="e04bb-120">Однако это может измениться в будущем.</span><span class="sxs-lookup"><span data-stu-id="e04bb-120">However, this may change in the future.</span></span>

<span data-ttu-id="e04bb-121">Для сохранения представления тома, содержащегося в теневой копии, поставщик системы использует метод копирования при записи.</span><span class="sxs-lookup"><span data-stu-id="e04bb-121">To maintain a "point in time" view of a volume contained in the shadow copy, the system provider uses a copy-on-write technique.</span></span> <span data-ttu-id="e04bb-122">Копии секторов на диске, которые были изменены («diff»), начиная с начала создания теневой копии, хранятся в области хранения теневых копий.</span><span class="sxs-lookup"><span data-stu-id="e04bb-122">Copies of the sectors on disk that have been modified (called "diffs") since the beginning of the shadow copy creation are stored in a shadow copy storage area.</span></span>

<span data-ttu-id="e04bb-123">Таким образом, поставщик системы может предоставлять динамический том, который может быть записан и прочитан обычным способом, и применять "diff" к данным динамического тома для эффективного предоставления замороженных данных теневой копии.</span><span class="sxs-lookup"><span data-stu-id="e04bb-123">Therefore, the system provider can expose the live volume, which can be written to and read from normally, and apply the "diffs" to the live volume's data to effectively expose the frozen data of the shadow copy.</span></span>

<span data-ttu-id="e04bb-124">Для системного поставщика область хранения теневой копии должна находиться в томе NTFS.</span><span class="sxs-lookup"><span data-stu-id="e04bb-124">For the system provider, the shadow copy storage area must be on an NTFS volume.</span></span> <span data-ttu-id="e04bb-125">Том для теневого копирования не обязательно должен быть томом NTFS, однако среди подключенных к системе томов должен быть по крайней мере один том NTFS.</span><span class="sxs-lookup"><span data-stu-id="e04bb-125">The volume to be shadow copied does not need to be an NTFS volume, but at least one volume mounted on the system must be an NTFS volume.</span></span>

## <a name="software-providers"></a><span data-ttu-id="e04bb-126">Поставщики программного обеспечения</span><span class="sxs-lookup"><span data-stu-id="e04bb-126">Software Providers</span></span>

<span data-ttu-id="e04bb-127">Поставщики теневого копирования программного обеспечения перехватывают и обрабатывают запросы ввода-вывода в программном уровне между файловой системой и программным обеспечением диспетчера томов.</span><span class="sxs-lookup"><span data-stu-id="e04bb-127">Software shadow copy providers intercept and process I/O requests in a software layer between the file system and the volume manager software.</span></span> <span data-ttu-id="e04bb-128">Эти поставщики реализуются как компонент DLL пользовательского режима и как минимум один драйвер устройства в режиме ядра (как правило, но не обязательно) драйвер фильтра хранилища.</span><span class="sxs-lookup"><span data-stu-id="e04bb-128">These providers are implemented as a user-mode DLL component and at least one kernel-mode device driver, typically (but not necessarily) a storage filter driver.</span></span> <span data-ttu-id="e04bb-129">Работа по созданию этих теневых копий выполняется в программном обеспечении.</span><span class="sxs-lookup"><span data-stu-id="e04bb-129">The work of creating these shadow copies is done in software.</span></span>

<span data-ttu-id="e04bb-130">Поставщик теневого копирования программного обеспечения должен поддерживать представление тома "на момент времени", имея доступ к набору файлов, который можно использовать для правильного повторного создания состояния тома перед теневой копией.</span><span class="sxs-lookup"><span data-stu-id="e04bb-130">A software shadow copy provider must maintain a "point-in-time" view of a volume by having access to a set of files that can be used to accurately re-create volume status prior to the shadow copy.</span></span> <span data-ttu-id="e04bb-131">Примером этого является метод копирования при записи поставщика системы.</span><span class="sxs-lookup"><span data-stu-id="e04bb-131">An example of this is the copy-on-write technique of the system provider.</span></span>

<span data-ttu-id="e04bb-132">Однако служба VSS не накладывает никаких ограничений на то, какие методы используются поставщиками программного обеспечения для создания и обслуживания теневых копий, а сторонние производители могут реализовать свои поставщики программного обеспечения по мере их появлении.</span><span class="sxs-lookup"><span data-stu-id="e04bb-132">However, VSS places no restrictions on what technique that software providers use to create and maintain shadow copies, and third-party vendors are free to implement their software providers as they see fit.</span></span>

<span data-ttu-id="e04bb-133">Кроме того, служба VSS обеспечивает поддержку большинства функций поставщиков теневого копирования программного обеспечения, таких как определение точки во времени, синхронизацию данных и очистку, предоставление общего интерфейса для резервного копирования приложений и управление теневой копией.</span><span class="sxs-lookup"><span data-stu-id="e04bb-133">In addition, VSS provides support for much of the functionality of software shadow copy providers, such as defining the point-in-time, data synchronization and flushing, providing a common interface for backup applications, and management of the shadow copy.</span></span>

<span data-ttu-id="e04bb-134">Поставщик программного обеспечения, по определению, будет применяться к более широкому спектру платформ хранения, чем поставщик оборудования, и должен иметь одинаковую возможность работать с базовыми дисками или логическими томами.</span><span class="sxs-lookup"><span data-stu-id="e04bb-134">A software provider will, by definition, be applicable to a wider range of storage platforms than a hardware provider, and should be able to work with basic disks or logical volumes equally well.</span></span> <span data-ttu-id="e04bb-135">Это общее снижение производительности, которое может быть доступно при реализации теневых копий на оборудовании, и не использует какие-либо функции отслеживания томов или зеркального отображения файлов, характерные для конкретного поставщика.</span><span class="sxs-lookup"><span data-stu-id="e04bb-135">This generality sacrifices the performance that may be available by implementing shadow copies in hardware and does not make use of any vendor-specific volume capture or file mirroring features.</span></span>

## <a name="hardware-providers"></a><span data-ttu-id="e04bb-136">Поставщики оборудования</span><span class="sxs-lookup"><span data-stu-id="e04bb-136">Hardware Providers</span></span>

<span data-ttu-id="e04bb-137">Аппаратные поставщики теневого копирования перехватывают запросы ввода-вывода из файловой системы на уровне оборудования, работая в сочетании с адаптером или контроллером хранилища оборудования.</span><span class="sxs-lookup"><span data-stu-id="e04bb-137">Hardware shadow copy providers intercept I/O requests from the file system at the hardware level by working in conjunction with a hardware storage adapter or controller.</span></span> <span data-ttu-id="e04bb-138">Работа по созданию теневой копии выполняется адаптером узла, устройством хранения или RAID-контроллером за пределами операционной системы.</span><span class="sxs-lookup"><span data-stu-id="e04bb-138">The work of creating the shadow copy is performed by a host adapter, storage appliance, or RAID controller outside of the operating system.</span></span>

<span data-ttu-id="e04bb-139">Эти поставщики реализуются как компонент DLL пользовательского режима, взаимодействующий с оборудованием, которое будет предоставлять данные теневого копирования. Таким образом, поставщику теневого копирования может потребоваться вызвать или создать другие компоненты режима ядра.</span><span class="sxs-lookup"><span data-stu-id="e04bb-139">These providers are implemented as a user-mode DLL component communicating with the hardware that will expose the shadow copy data: therefore, hardware shadow copy providers may need to call or create other kernel-mode components.</span></span>

<span data-ttu-id="e04bb-140">Поставщики оборудования предоставляют теневые копии всех дисков или логических устройств (LUN) VSS.</span><span class="sxs-lookup"><span data-stu-id="e04bb-140">Hardware providers expose to VSS shadow copies of entire disks or logical units (LUNs).</span></span> <span data-ttu-id="e04bb-141">Запросы по-прежнему работают с теневыми копиями томов. все сопоставления томов и дисков обрабатываются внутренним образом с помощью VSS.</span><span class="sxs-lookup"><span data-stu-id="e04bb-141">Requesters still deal with shadow copies of volumes; all the volume-to-disk mapping is handled internally by VSS.</span></span> <span data-ttu-id="e04bb-142">Теневые копии, созданные поставщиками оборудования для томов, расположенных на динамических дисках, имеют определенное требование: они не могут быть импортированы в одну и ту же систему.</span><span class="sxs-lookup"><span data-stu-id="e04bb-142">Shadow copies created by hardware providers of volumes that reside on dynamic disks have a specific requirement:  They cannot be imported onto the same system.</span></span> <span data-ttu-id="e04bb-143">Они должны быть созданы и импортированы в другую систему.</span><span class="sxs-lookup"><span data-stu-id="e04bb-143">They must be created transportable and imported on a second system.</span></span>

<span data-ttu-id="e04bb-144">Хотя поставщик аппаратного теневого копирования использует функции VSS, определяющие момент времени, обеспечивает синхронизацию данных, управляет теневой копией и предоставляет общий интерфейс с приложениями резервного копирования, VSS не задает базовый механизм, по которому поставщик оборудования создает и поддерживает теневые копии.</span><span class="sxs-lookup"><span data-stu-id="e04bb-144">While a hardware shadow copy provider makes use of VSS functionality that defines the point in time, allows data synchronization, manages the shadow copy, and provides a common interface with backup applications, VSS does not specify the underlying mechanism by which the hardware provider produces and maintains shadow copies.</span></span>

 

 



