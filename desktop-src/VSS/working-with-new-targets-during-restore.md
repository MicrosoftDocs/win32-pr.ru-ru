---
description: Инициатору запроса может потребоваться восстановить файлы в расположении, указанном не по стандартному пути к набору файлов или сопоставлению альтернативного расположения.
ms.assetid: ce11485c-da0e-4c16-962e-eeedc2da3de4
title: Работа с новыми целевыми объектами во время восстановления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 31f20a6e8c27c186648d0f662921160ab5c76988
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692337"
---
# <a name="working-with-new-targets-during-restore"></a><span data-ttu-id="3967f-103">Работа с новыми целевыми объектами во время восстановления</span><span class="sxs-lookup"><span data-stu-id="3967f-103">Working with New Targets during Restore</span></span>

<span data-ttu-id="3967f-104">Инициатору запроса может потребоваться восстановить файлы в расположении, указанном не по стандартному пути к набору файлов или [*сопоставлению альтернативного расположения*](vssgloss-a.md).</span><span class="sxs-lookup"><span data-stu-id="3967f-104">A requester may need to restore files to a location indicated by something other than a file set's default path or its [*alternate location mapping*](vssgloss-a.md).</span></span> <span data-ttu-id="3967f-105">Существует множество причин, по которым это может произойти, например, ни одно место назначения восстановления недоступно, либо пользователь, запросивший запрос, намеренно запрашивает восстановление файлов в неизвестном месте.</span><span class="sxs-lookup"><span data-stu-id="3967f-105">There are many reasons why this might happen—for example, neither restore destination was accessible, or a requester user intentionally requests that files be restored to some previously unknown location.</span></span> <span data-ttu-id="3967f-106">В этом случае инициатор запроса использует новый целевой механизм, чтобы указать средствам записи о восстановлении файла в другую область на диске.</span><span class="sxs-lookup"><span data-stu-id="3967f-106">In this case, the requester uses the new target mechanism to indicate to writers that it has restored a file to a different area on disk.</span></span>

<span data-ttu-id="3967f-107">Не все модули записи поддерживают инициатор запроса, изменяя место назначения для восстановления файла.</span><span class="sxs-lookup"><span data-stu-id="3967f-107">Not all writers support a requester changing the restore destination of a file.</span></span> <span data-ttu-id="3967f-108">Инициатору запроса необходимо проверить поддержку модуля записи, проверив маску схемы резервного копирования (возвращенную [**ивссексаминевритерметадата:: жетбаккупсчема**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)) записи и убедившись, что она содержит модуль записи в VSS, \_ \_ \_ поддерживает \_ новый \_ целевой флаг.</span><span class="sxs-lookup"><span data-stu-id="3967f-108">A requester needs to verify writer support by checking the writer's backup schema mask (returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)) and verifying that it contains the VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET flag.</span></span>

<span data-ttu-id="3967f-109">Инициатор запроса указывает на такое восстановление с помощью метода [**ивссбаккупкомпонентс:: аддневтаржет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) .</span><span class="sxs-lookup"><span data-stu-id="3967f-109">The requester indicates such a restoration through the [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) method.</span></span> <span data-ttu-id="3967f-110">Помимо указания спецификации файла и исходного и нового назначения восстановления, инициатор запроса указывает сведения о компоненте — логический путь и имя компонента.</span><span class="sxs-lookup"><span data-stu-id="3967f-110">In addition to specifying a file specification and an original and a new restore destination, the requester specifies component information—a logical path and component name.</span></span>

<span data-ttu-id="3967f-111">Сведения об используемых компонентах зависят от того, был ли компонент, управляющий файлом с новым целевым объектом, был [*явно включен*](vssgloss-e.md) или [*неявно включен*](vssgloss-i.md) в резервную копию.</span><span class="sxs-lookup"><span data-stu-id="3967f-111">Which component's information is used depends on whether or not the component managing the file having a new target added was [*explicitly included*](vssgloss-e.md) or [*implicitly included*](vssgloss-i.md) in the backup.</span></span>

<span data-ttu-id="3967f-112">Если управляющий компонент был явно включен, то используются его сведения.</span><span class="sxs-lookup"><span data-stu-id="3967f-112">If the managing component was explicitly included, then its information is used.</span></span> <span data-ttu-id="3967f-113">Если управляющий компонент был неявно включен, то он является подкомпонентом в наборе компонентов.</span><span class="sxs-lookup"><span data-stu-id="3967f-113">If the managing component was implicitly included, it is a subcomponent in a component set.</span></span> <span data-ttu-id="3967f-114">В этом случае используются сведения о компоненте, определяющем набор компонентов.</span><span class="sxs-lookup"><span data-stu-id="3967f-114">In this case, the component set's defining component's information is used.</span></span>

<span data-ttu-id="3967f-115">При обработке события, записывающего [**событие, модули**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) записи должны проверить, не были ли восстановлены файлы в новом расположении.</span><span class="sxs-lookup"><span data-stu-id="3967f-115">While handling the [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) event, writers should check to see if any of its files were restored to a new location.</span></span> <span data-ttu-id="3967f-116">Это можно сделать с помощью методов [**ивсскомпонент:: жетневтаржеткаунт**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) и [**Ивсскомпонент:: жетневтаржет**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget) .</span><span class="sxs-lookup"><span data-stu-id="3967f-116">This can be done by using the [**IVssComponent::GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) and [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget) methods.</span></span>

<span data-ttu-id="3967f-117">Используемый экземпляр интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) зависит от того, был ли управляющий компонент файла явно или неявно добавлен в резервную копию.</span><span class="sxs-lookup"><span data-stu-id="3967f-117">The instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface that is used depends on whether the file's managing component was explicitly or implicitly added to the backup.</span></span>

 

 



