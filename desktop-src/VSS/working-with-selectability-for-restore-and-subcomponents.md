---
description: Возможность выбора для восстановления позволяет инициатору запроса определить, когда компонент может быть восстановлен отдельно.
ms.assetid: 684dc50f-5d7b-4c95-85dd-77c320d65fff
title: Работа с выборкой для восстановления и подкомпонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d988f4c4e029c7dd8623ad22fcaee7662d33e82
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104541706"
---
# <a name="working-with-selectability-for-restore-and-subcomponents"></a><span data-ttu-id="f446f-103">Работа с выборкой для восстановления и подкомпонентов</span><span class="sxs-lookup"><span data-stu-id="f446f-103">Working with Selectability For Restore and Subcomponents</span></span>

<span data-ttu-id="f446f-104">Возможность выбора для восстановления позволяет инициатору запроса определить, когда компонент может быть восстановлен отдельно.</span><span class="sxs-lookup"><span data-stu-id="f446f-104">Selectability for restore allows the requester to determine when a component can be individually restored.</span></span> <span data-ttu-id="f446f-105">Компонент, который был включен для резервного копирования, может отображаться одним из двух способов:</span><span class="sxs-lookup"><span data-stu-id="f446f-105">A component that has been included for backup can appear in one of two ways:</span></span>

-   <span data-ttu-id="f446f-106">Возможно, компонент был [*явно включен*](vssgloss-e.md) в резервную копию.</span><span class="sxs-lookup"><span data-stu-id="f446f-106">A component may have been [*explicitly included*](vssgloss-e.md) in the backup.</span></span> <span data-ttu-id="f446f-107">Эти компоненты имеют соответствующий экземпляр [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) в документе компонента резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="f446f-107">These components have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document.</span></span> <span data-ttu-id="f446f-108">Эти компоненты включаются в восстановление с помощью [**ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="f446f-108">These components are included in a restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>
-   <span data-ttu-id="f446f-109">Возможно, компонент был [*неявно включен*](vssgloss-i.md) в резервную копию.</span><span class="sxs-lookup"><span data-stu-id="f446f-109">A component may have been [*implicitly included*](vssgloss-i.md) in the backup.</span></span> <span data-ttu-id="f446f-110">Эти компоненты не имеют соответствующего экземпляра [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) в документе архивных компонентов. Однако в документе всегда будет экземпляр **ивсскомпонент** для некоторого компонента предка.</span><span class="sxs-lookup"><span data-stu-id="f446f-110">These components do not have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document; however, there will always be an **IVssComponent** instance for some ancestor component in the document.</span></span> <span data-ttu-id="f446f-111">Эти компоненты включаются в восстановление с помощью [**ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="f446f-111">These components are included in a restore using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="f446f-112">Любой компонент, явно включенный в резервную копию, всегда может быть выбран для восстановления отдельно, независимо от значения выборки для восстановления.</span><span class="sxs-lookup"><span data-stu-id="f446f-112">Any component that has been explicitly included in the backup can always be individually selected for restore, regardless of its selectability-for-restore value.</span></span> <span data-ttu-id="f446f-113">Инициатор запроса вызывает [**ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), передавая ему идентификатор модуля записи, логический путь и имя конкретного компонента.</span><span class="sxs-lookup"><span data-stu-id="f446f-113">The requester calls [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), passing in the writer ID, logical path, and name of the specific component.</span></span> <span data-ttu-id="f446f-114">Компоненты, неявно включенные в резервную копию, будут восстановлены при восстановлении явно включенного предка.</span><span class="sxs-lookup"><span data-stu-id="f446f-114">Components that have been implicitly included in the backup will be restored when an explicitly included ancestor is restored.</span></span> <span data-ttu-id="f446f-115">Неявно включенные компоненты можно выбирать отдельно для восстановления только в том случае, если они помечены как доступные для восстановления.</span><span class="sxs-lookup"><span data-stu-id="f446f-115">Implicitly included components can be individually selected for restore only if they are marked as selectable for restore.</span></span> <span data-ttu-id="f446f-116">Инициатор запроса сначала вызывает **ивссбаккупкомпонентс:: сетселектедфорресторе** на ближайшем явно включенном компоненте предка, а затем вызывает [**Ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) в компоненте предка, чтобы выбрать неявно включенный компонент для восстановления.</span><span class="sxs-lookup"><span data-stu-id="f446f-116">The requester first calls **IVssBackupComponents::SetSelectedForRestore** on the closest explicitly included ancestor component, and then calls [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) on the ancestor component to select the implicitly included component for restore.</span></span> <span data-ttu-id="f446f-117">После этого будет восстановлен только неявно выбранный компонент. все остальные компоненты набора компонентов не будут восстановлены.</span><span class="sxs-lookup"><span data-stu-id="f446f-117">After this is done, only the implicitly selected component will be restored; all other components in the component set will not be restored.</span></span>

<span data-ttu-id="f446f-118">В отличие от выбора для резервного копирования, которое всегда должно быть задано явно при добавлении компонента с помощью [**ивсскреатевритерметадата:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), возможность выбора для восстановления имеет значение по умолчанию false, которое может быть переопределено.</span><span class="sxs-lookup"><span data-stu-id="f446f-118">Unlike selectability for backup, which must always be explicitly set when a component is added with [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), selectability for restore has a default value of false, which can be overridden.</span></span>

<span data-ttu-id="f446f-119">Поскольку компоненты верхнего уровня (компоненты с пустым логическим путем) можно явно включать в резервную копию, выбор для восстановления не имеет смысла для этих компонентов.</span><span class="sxs-lookup"><span data-stu-id="f446f-119">Because top-level components (components with an empty logical path) can only be explicitly included in a backup, selectability for restore has no meaning for these components.</span></span>

 

 



