---
description: Помимо выполнения резервного копирования или восстановления, а также управления теневыми копиями, инициатор запроса должен управлять сведениями о компонентах модулей записи, с которыми он взаимодействует.
ms.assetid: 641abfbe-fc72-4468-9ef6-69c452adb1b3
title: Использование компонентов инициатором запроса
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83efdb9e80ac0331289c3b611978e66a58098de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104541767"
---
# <a name="use-of-components-by-the-requester"></a><span data-ttu-id="caf79-103">Использование компонентов инициатором запроса</span><span class="sxs-lookup"><span data-stu-id="caf79-103">Use of Components by the Requester</span></span>

<span data-ttu-id="caf79-104">Помимо выполнения резервного копирования или восстановления, а также управления теневыми копиями, инициатор запроса должен управлять сведениями о компонентах модулей записи, с которыми он взаимодействует.</span><span class="sxs-lookup"><span data-stu-id="caf79-104">In addition to performing a backup or restore, and supervising shadow copies, a requester must manage information about the components of the writers it interacts with.</span></span> <span data-ttu-id="caf79-105">Выбор компонентов и логический путь используются для включения или исключения данных из резервной копии, а также для принятия решения о том, какие сведения о компонентах включены в документ компонентов резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="caf79-105">Component selectability and logical path are used to include or exclude data from a backup, and to decide what component information is included in the Backup Components Document.</span></span>

## <a name="requester-component-selection-during-backup"></a><span data-ttu-id="caf79-106">Выбор компонента инициатора запроса во время резервного копирования</span><span class="sxs-lookup"><span data-stu-id="caf79-106">Requester Component Selection during Backup</span></span>

<span data-ttu-id="caf79-107">Во время операций резервного копирования инициатор запроса импортирует данные компонента метаданных модуля записи с помощью методов [**ивссбаккупкомпонентс:: гасервритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) и [**Ивссбаккупкомпонентс:: жетвритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (Дополнительные сведения см. [в разделе Общие сведения об инициализации резервного копирования](overview-of-backup-initialization.md) ).</span><span class="sxs-lookup"><span data-stu-id="caf79-107">During backup operations, a requester imports writer metadata component data using the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) methods (see [Overview of Backup Initialization](overview-of-backup-initialization.md) for more information).</span></span>

<span data-ttu-id="caf79-108">После изучения сведений модуля записи с помощью интерфейса [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) инициатор запроса решает, какие модули записи будут создавать резервные копии, а в ограниченном экстенте — какие компоненты модуля записи будут создавать резервные копии.</span><span class="sxs-lookup"><span data-stu-id="caf79-108">After examining writer information with the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, a requester decides which writers it will back up and, to a limited extent, which of a given writer's components it will back up.</span></span>

<span data-ttu-id="caf79-109">При резервном копировании модуля записи инициатор запроса:</span><span class="sxs-lookup"><span data-stu-id="caf79-109">When backing up a writer, a requester:</span></span>

-   <span data-ttu-id="caf79-110">Необходимо [*явно включить*](vssgloss-e.md) все невыбираемые компоненты модуля записи для компонентов резервного копирования, не выбрав их для предков с помощью [**Ивссбаккупкомпонентс:: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) , чтобы добавить компонент в документ компонентов резервного копирования</span><span class="sxs-lookup"><span data-stu-id="caf79-110">Must [*explicitly include*](vssgloss-e.md) all of a writer's nonselectable for backup components without selectable for backup ancestors using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) to add the component to the Backup Components Document</span></span>
-   <span data-ttu-id="caf79-111">Может явно включать любой из компонентов модуля записи, который можно выбрать для резервного копирования, с помощью [**ивссбаккупкомпонентс:: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) для добавления компонента в документ компонентов резервного копирования</span><span class="sxs-lookup"><span data-stu-id="caf79-111">May explicitly include any of a writer's selectable for backup components using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) to add the component to the Backup Components Document</span></span>
-   <span data-ttu-id="caf79-112">Если компонент, который можно выбрать для резервного копирования, определяет [*набор компонентов*](vssgloss-c.md), его явное включение [*неявно включает*](vssgloss-i.md) все члены набора компонентов — возможность выбора для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="caf79-112">If a selectable for backup component defines a [*component set*](vssgloss-c.md), its explicit inclusion [*implicitly includes*](vssgloss-i.md) all the component set's members—whether selectable for backup or not.</span></span> <span data-ttu-id="caf79-113">Эти компоненты не добавляются в документ компонентов резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="caf79-113">These components are not added to the Backup Components Document.</span></span>

<span data-ttu-id="caf79-114">При добавлении компонента для резервного копирования, который можно выбрать, или невыбираемого для компонентов резервного копирования без выбора для резервного копирования предков в документ компонентов резервного копирования, запросивший объект определяет следующее:</span><span class="sxs-lookup"><span data-stu-id="caf79-114">In adding a selectable for backup component or a nonselectable for backup components without selectable for backup ancestors to its Backup Components Document, a requester specifies the following:</span></span>

-   <span data-ttu-id="caf79-115">Экземпляр модуля записи, управляющий компонентом</span><span class="sxs-lookup"><span data-stu-id="caf79-115">The instance of the writer managing the component</span></span>
-   <span data-ttu-id="caf79-116">Идентификатор класса модуля записи</span><span class="sxs-lookup"><span data-stu-id="caf79-116">The writer's class identifier</span></span>
-   <span data-ttu-id="caf79-117">[*Логический путь*](vssgloss-l.md) компонента (который может иметь **значение NULL**)</span><span class="sxs-lookup"><span data-stu-id="caf79-117">The [*logical path*](vssgloss-l.md) of the component (which may be **NULL**)</span></span>
-   <span data-ttu-id="caf79-118">Имя компонента</span><span class="sxs-lookup"><span data-stu-id="caf79-118">The component's name</span></span>

<span data-ttu-id="caf79-119">Если компонент не соответствует спецификации, будет возвращена ошибка.</span><span class="sxs-lookup"><span data-stu-id="caf79-119">If a component does not match the specification, an error will be returned.</span></span>

<span data-ttu-id="caf79-120">Если такой компонент существует, VSS создает интерфейс [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) для компонента в документе архивных компонентов.</span><span class="sxs-lookup"><span data-stu-id="caf79-120">If such a component exists, VSS creates an [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface for the component in the Backup Components Document.</span></span> <span data-ttu-id="caf79-121">Эта информация будет доступна и может быть изменена модулем записи и инициатором запроса.</span><span class="sxs-lookup"><span data-stu-id="caf79-121">This information will be accessible and modifiable by the writer and requester.</span></span> <span data-ttu-id="caf79-122">Для выбираемого компонента, определяющего [*набор компонентов*](vssgloss-c.md), он описывает не только свойства компонента, но и все содержащиеся в нем компоненты.</span><span class="sxs-lookup"><span data-stu-id="caf79-122">For a selectable component that defines a [*component set*](vssgloss-c.md), it describes not only properties of the component but also all the subcomponents it contains.</span></span>

<span data-ttu-id="caf79-123">Сведения о неявно добавляемых компонентах недоступны в документе архивные компоненты.</span><span class="sxs-lookup"><span data-stu-id="caf79-123">Information about implicitly added components is not available in the Backup Components Document.</span></span> <span data-ttu-id="caf79-124">Кроме того, в документе компоненты резервного копирования нет доступных сведений о файле.</span><span class="sxs-lookup"><span data-stu-id="caf79-124">In addition, no file information is available in the Backup Components Document.</span></span> <span data-ttu-id="caf79-125">Чтобы получить эти сведения, инициатору запроса потребуется изучить документы метаданных модуля записи (которые уже были считаны) в контексте выбранных сохраненных компонентов в документе компонента резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="caf79-125">To obtain that information, the requester will have to examine the Writer Metadata Documents (which will have already been read) in the context of the selected stored components in the Backup Components Document.</span></span>

## <a name="requester-component-selection-during-restore"></a><span data-ttu-id="caf79-126">Выбор компонента инициатора запроса во время восстановления</span><span class="sxs-lookup"><span data-stu-id="caf79-126">Requester Component Selection during Restore</span></span>

<span data-ttu-id="caf79-127">Во время операций восстановления инициатор запроса не должен импортировать сведения о компонентах из модулей записи, которые в настоящее время активны в системе через [**ивссбаккупкомпонентс:: гасервритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), так как состояние выполняющихся процессов не обязательно отражает состояние процессов при резервном копировании.</span><span class="sxs-lookup"><span data-stu-id="caf79-127">During restore operations, a requester should not import component information from the writers currently active on the system via [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), because the state of currently executing processes will not necessarily reflect the state of processes when a backup was made.</span></span>

<span data-ttu-id="caf79-128">Он по-прежнему должен создавать [*событие Identify*](vssgloss-i.md) через [**Ивссбаккупкомпонентс:: гасервритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), чтобы создать *событие определения* и определить, какие модули записи в настоящее время находятся в системе, и их состояние.</span><span class="sxs-lookup"><span data-stu-id="caf79-128">It should still generate an [*Identify event*](vssgloss-i.md) via [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), both to create an *Identify event* and to determine which writers are currently on the system and their status.</span></span>

<span data-ttu-id="caf79-129">Инициатор запроса получает сохраненный документ компонентов резервного копирования во время его инициализации, а также документы метаданных хранимой программы записи (Дополнительные сведения см. в разделе [Обзор инициализации восстановления](overview-of-restore-initialization.md) ).</span><span class="sxs-lookup"><span data-stu-id="caf79-129">The requester retrieves the stored Backup Components Document during its initialization as well as stored Writer Metadata Documents (see [Overview of Restore Initialization](overview-of-restore-initialization.md) for more information) .</span></span>

<span data-ttu-id="caf79-130">Включение компонентов во время резервного копирования во многом аналогично тому, что требуется для восстановления, за исключением того, что необходимо рассмотреть возможность [*выбора для восстановления*](vssgloss-s.md) вместе с [*логическим путем*](vssgloss-l.md)— [*невыбираемым для резервного копирования*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="caf79-130">Inclusion of components during backup is largely the same as that for restore, except that you must consider [*selectable for restore*](vssgloss-s.md) along with [*logical path*](vssgloss-l.md)—not [*selectable for backup*](vssgloss-s.md).</span></span>

<span data-ttu-id="caf79-131">Однако существуют некоторые отличия.</span><span class="sxs-lookup"><span data-stu-id="caf79-131">There are, however, some differences:</span></span>

-   <span data-ttu-id="caf79-132">Если компонент уже был [*явно включен*](vssgloss-e.md) в документ компонентов резервного копирования во время резервного копирования, если он включен для восстановления (явно или неявно), [**Ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) используется для явного добавления его в документ компонентов резервного копирования для восстановления.</span><span class="sxs-lookup"><span data-stu-id="caf79-132">If a component has already been [*explicitly included*](vssgloss-e.md) to the Backup Components Document during backup, if it is included for restore (either explicitly or implicitly), [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) is used to explicitly add it to the Backup Components Document for restore.</span></span>
-   <span data-ttu-id="caf79-133">Если компонент был [*неявно включен*](vssgloss-i.md) в резервную копию и недоступен для восстановления без выбора для предков восстановления, который в случае резервного копирования будет требовать явного включения — компонент не включается явным образом (то есть не добавляется в документ компонентов резервного копирования с помощью [**Ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore)).</span><span class="sxs-lookup"><span data-stu-id="caf79-133">If a component was [*implicitly included*](vssgloss-i.md) to the backup, and is nonselectable for restore with no selectable for restore ancestors—which in the backup case would imply the need for explicit inclusion—the component is not explicitly included (that is, it is not added to the Backup Components Document using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore)).</span></span> <span data-ttu-id="caf79-134">Такой компонент следует считать неявно выбранным для восстановления.</span><span class="sxs-lookup"><span data-stu-id="caf79-134">Such a component should be considered implicitly selected for restore.</span></span>
-   <span data-ttu-id="caf79-135">Из этих компонентов, неявно выбранных для резервного копирования (независимо от того, был ли этот компонент выбран для резервного копирования или нет), в документ компонентов резервного копирования можно добавить только те компоненты, которые могут быть выбраны для восстановления, с помощью [**ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="caf79-135">Of those components implicitly selected for backup (whether that component was selectable for backup or not), only those that are selectable for restore can be added to the Backup Components Document using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>
-   <span data-ttu-id="caf79-136">Возможность выбора для компонентов восстановления может определять [*набор компонентов*](vssgloss-c.md) для восстановления, так же как и для компонентов резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="caf79-136">Selectable for restore components may define a [*component set*](vssgloss-c.md) for restore—just as selectable for backup components do.</span></span> <span data-ttu-id="caf79-137">Этот компонент, выбираемый для восстановления, затем определяет этот набор компонентов для операции восстановления.</span><span class="sxs-lookup"><span data-stu-id="caf79-137">This selectable for restore component then defines this component set for the restore operation.</span></span>

<span data-ttu-id="caf79-138">Модуль записи без компонентов, явно выбранных для восстановления до создания события предварительного [*восстановления*](vssgloss-p.md) , не получит никаких событий VSS.</span><span class="sxs-lookup"><span data-stu-id="caf79-138">A writer with no components explicitly selected for restore prior to the generation of a [*PreRestore*](vssgloss-p.md) event will not receive any VSS events.</span></span>

<span data-ttu-id="caf79-139">Запрашивающие стороны и модули записи могут получать доступ к хранящимся сведениям о компонентах с помощью интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="caf79-139">Requesters and writers can access stored component information using the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span> <span data-ttu-id="caf79-140">С помощью интерфейса **ивсскомпонент** модули записи могут изменять некоторые параметры его компонентов, явно включаемые в документ компонентов резервного копирования для поддержки восстановления (например, [*цель восстановления*](vssgloss-r.md)).</span><span class="sxs-lookup"><span data-stu-id="caf79-140">Through the **IVssComponent** interface, writers can modify some of the settings of those of its components explicitly included in the Backup Components Document to support a restore (such as the [*restore target*](vssgloss-r.md)).</span></span> <span data-ttu-id="caf79-141">Если он определяет набор компонентов, изменения, внесенные средством записи явно включаемого компонента, распространяются на его [*подкомпоненты*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="caf79-141">If it defines a component set, writer modifications of an explicitly included component will propagate to its [*subcomponents*](vssgloss-s.md).</span></span> <span data-ttu-id="caf79-142">Кроме того, интерфейс предоставляет механизм передачи сведений об успешном и неуспешном завершении восстановления между модулем записи и инициатором запроса.</span><span class="sxs-lookup"><span data-stu-id="caf79-142">In addition, the interface provides a mechanism for passing information about restore success and failure between writer and requester.</span></span>

<span data-ttu-id="caf79-143">Как и во время резервного копирования, в документе "компоненты резервного копирования" недостаточно сведений для реализации восстановления.</span><span class="sxs-lookup"><span data-stu-id="caf79-143">As during backup, there is insufficient information in the Backup Components Document itself to implement the restore.</span></span> <span data-ttu-id="caf79-144">Опять же, документы метаданных модуля записи должны предоставлять сведения о фактических путях восстанавливаемых файлов, а также определить, какие невыбираемые компоненты входят в набор компонентов выбора компонентов и поэтому их необходимо восстановить.</span><span class="sxs-lookup"><span data-stu-id="caf79-144">Again, the Writer Metadata Documents will be required to supply information about the actual paths of files to be restored and to discover what nonselectable components are part of the selectable components component set and therefore need to be restored.</span></span>

<span data-ttu-id="caf79-145">Сведения о типах выбора и их использовании см. в разделе [Работа с использованием выбора и логических путей](working-with-selectability-and-logical-paths.md) .</span><span class="sxs-lookup"><span data-stu-id="caf79-145">See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md) for information about the types of selectability and their usage.</span></span>

## <a name="use-of-writer-component-document-information-by-the-requester"></a><span data-ttu-id="caf79-146">Использование сведений о документе компонента модуля записи инициатором запроса</span><span class="sxs-lookup"><span data-stu-id="caf79-146">Use of Writer Component Document Information by the Requester</span></span>

<span data-ttu-id="caf79-147">Каждый компонент однозначно идентифицируется [*идентификатором класса модуля записи*](vssgloss-w.md) его родительского модуля записи, его именем и [*логическим путем*](vssgloss-l.md).</span><span class="sxs-lookup"><span data-stu-id="caf79-147">Each component is uniquely identified by the [*Writer Class ID*](vssgloss-w.md) of its parent writer, its name, and its [*logical path*](vssgloss-l.md).</span></span>

<span data-ttu-id="caf79-148">Инициатор запроса может использовать интерфейс [**ивссвритеркомпонентсекст**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) , возвращенный методом [**Ивссбаккупкомпонентс:: жетвритеркомпонентс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) , для получения сведений о каждом сохраненном компоненте.</span><span class="sxs-lookup"><span data-stu-id="caf79-148">The requester can use the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by the [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) method to obtain information about each stored component.</span></span>

<span data-ttu-id="caf79-149">Имя компонента и логический путь (помимо других элементов) можно найти с помощью интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , возвращаемого [**ивссвритеркомпонентсекст::-Component**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent).</span><span class="sxs-lookup"><span data-stu-id="caf79-149">The component's name and logical path (among other items) can be found via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface returned by [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent).</span></span>

> [!Note]  
> <span data-ttu-id="caf79-150">На этапе восстановления запрашивающий объект должен вызвать [**ивссвритеркомпонентсекст::**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) или [**Ивссвритеркомпонентсекст:: жеткомпоненткаунт**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) только после вызова [**ивссбаккупкомпонентс::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) , чтобы разрешить модулю записи обновлять документ компонентов резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="caf79-150">During the restore phase, the requester should call [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) or [**IVssWriterComponentsExt::GetComponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) only after the call to [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) has returned, to allow time for the writer to update the Backup Components Document.</span></span> <span data-ttu-id="caf79-151">Одним из примеров такого обновления является изменение целевого объекта восстановления.</span><span class="sxs-lookup"><span data-stu-id="caf79-151">One example of such an update would be to change the restore target.</span></span>

 

<span data-ttu-id="caf79-152">Сведения о каждом сохраненном выбранном компоненте записи родительского модуля можно найти с помощью [**ивссвритеркомпонентсекст:: жетвритеринфо**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getwriterinfo).</span><span class="sxs-lookup"><span data-stu-id="caf79-152">Information about each stored selectable component's parent writer can be found using [**IVssWriterComponentsExt::GetWriterInfo**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getwriterinfo).</span></span>

<span data-ttu-id="caf79-153">С помощью этих сведений можно запросить документы метаданных модуля записи и определить соответствующий документ.</span><span class="sxs-lookup"><span data-stu-id="caf79-153">With this information, the Writer Metadata Documents can be queried and the matching document identified.</span></span> <span data-ttu-id="caf79-154">Затем, используя [*логический путь*](vssgloss-l.md), инициатор запроса может определить зависимые невыбираемые компоненты для каждого выбираемого компонента, то есть определить всех членов [*набора компонентов*](vssgloss-c.md)выбираемого компонента.</span><span class="sxs-lookup"><span data-stu-id="caf79-154">Then, by using the [*logical path*](vssgloss-l.md), the requester can identify the dependent nonselectable components for each selectable component—that is, identify all members of the selectable component's [*component set*](vssgloss-c.md).</span></span>

<span data-ttu-id="caf79-155">С помощью интерфейса [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) инициатор запроса теперь имеет полные сведения о компонентах, включая спецификацию пути (от интерфейса [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) ) — для выбираемых и невыбираемых компонентов, для которых требуется резервное копирование или восстановление.</span><span class="sxs-lookup"><span data-stu-id="caf79-155">Using the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, the requester now has full component information—including path specification (from the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface)—for both selectable and nonselectable components it needs to back up or restore.</span></span>

<span data-ttu-id="caf79-156">Это одна из причин того, что необходимо, чтобы инициатор запроса сохранял как состояние собственных компонентов резервного копирования, так и документы метаданных модуля записи, с которыми происходит резервное копирование.</span><span class="sxs-lookup"><span data-stu-id="caf79-156">This is one reason why it is vital for a requester to save both the state of its own Backup Components Document and the Writer Metadata Documents of the writers it is backing up.</span></span>

<span data-ttu-id="caf79-157">Более подробные сведения см. [в разделе Работа с выборкой и логическими путями](working-with-selectability-and-logical-paths.md) .</span><span class="sxs-lookup"><span data-stu-id="caf79-157">See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md) for more detailed information.</span></span>

 

 
