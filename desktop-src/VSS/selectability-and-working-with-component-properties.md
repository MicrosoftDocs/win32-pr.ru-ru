---
description: Для работы с неявными выбранными компонентами требуется доступ к документам с метаданными и документами метаданных для модуля резервного копирования.
ms.assetid: ede51931-be50-4286-818b-0e6122247bdd
title: Выбор и работа со свойствами компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d06683bafb02802d84f152f1ceb662eb7491f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156103"
---
# <a name="selectability-and-working-with-component-properties"></a><span data-ttu-id="06dc6-103">Выбор и работа со свойствами компонентов</span><span class="sxs-lookup"><span data-stu-id="06dc6-103">Selectability and Working with Component Properties</span></span>

<span data-ttu-id="06dc6-104">Для работы с неявными выбранными компонентами требуется доступ к документам с метаданными и документами метаданных для модуля резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="06dc6-104">Working with implicitly selected components requires access to both the Backup Components Document and Writer Metadata Documents.</span></span>

<span data-ttu-id="06dc6-105">Для этого имеются две причины:</span><span class="sxs-lookup"><span data-stu-id="06dc6-105">There are two reasons for this:</span></span>

-   <span data-ttu-id="06dc6-106">Данные компонента, хранящиеся в документе резервных копий (представленном интерфейсом [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) ), не имеют доступа к сведениям о наборе файлов компонентов — спецификации файла, пути и флаге рекурсии.</span><span class="sxs-lookup"><span data-stu-id="06dc6-106">The component data stored in the Backup Components Document (represented by the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface) lacks access to component file set information—file specification, path, and recursion flag.</span></span> <span data-ttu-id="06dc6-107">(См. раздел [Работа с компонентом Backup Components](working-with-the-backup-components-document.md).)</span><span class="sxs-lookup"><span data-stu-id="06dc6-107">(See [Working with the Backup Components Document](working-with-the-backup-components-document.md).)</span></span>
-   <span data-ttu-id="06dc6-108">Только компоненты, которые [*явно включены*](vssgloss-e.md) в документ резервных копий во время резервного копирования, содержат сведения, непосредственно хранящиеся в документе резервные компоненты.</span><span class="sxs-lookup"><span data-stu-id="06dc6-108">Only components that are [*included explicitly*](vssgloss-e.md) in the Backup Components Document during backup have their information directly stored in the Backup Components Document.</span></span> <span data-ttu-id="06dc6-109">Запрашивающие стороны и модули записи должны использовать информацию, доступную через интерфейс [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , в сочетании с метаданными о [*логическом пути*](vssgloss-l.md) и документах метаданных модуля записи для получения сведений о и задании свойств [*неявно включаемых*](vssgloss-i.md) компонентов.</span><span class="sxs-lookup"><span data-stu-id="06dc6-109">Requesters and writers must use the information available through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, in conjunction with [*logical path*](vssgloss-l.md) information and Writer Metadata Documents to obtain information about, and set properties of, [*implicitly included*](vssgloss-i.md) components.</span></span>

<span data-ttu-id="06dc6-110">Вариант "Мивритер", обсуждаемый в разделе " [логические пути к компонентам](logical-pathing-of-components.md) ", можно использовать для демонстрации выбора для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="06dc6-110">The "MyWriter" case discussed in [Logical Pathing of Components](logical-pathing-of-components.md) can be used to illustrate selectability for backup.</span></span>



| <span data-ttu-id="06dc6-111">Имя компонента</span><span class="sxs-lookup"><span data-stu-id="06dc6-111">Component name</span></span> | <span data-ttu-id="06dc6-112">Логический путь</span><span class="sxs-lookup"><span data-stu-id="06dc6-112">Logical path</span></span>            | <span data-ttu-id="06dc6-113">Выбор для резервного копирования</span><span class="sxs-lookup"><span data-stu-id="06dc6-113">Selectable for backup</span></span> | <span data-ttu-id="06dc6-114">Выбор для восстановления</span><span class="sxs-lookup"><span data-stu-id="06dc6-114">Selectable for restore</span></span> | <span data-ttu-id="06dc6-115">Явно включена</span><span class="sxs-lookup"><span data-stu-id="06dc6-115">Explicitly included</span></span> |
|----------------|-------------------------|-----------------------|------------------------|---------------------|
| <span data-ttu-id="06dc6-116">Исполняемые файлы</span><span class="sxs-lookup"><span data-stu-id="06dc6-116">"Executables"</span></span>  | <span data-ttu-id="06dc6-117">""</span><span class="sxs-lookup"><span data-stu-id="06dc6-117">""</span></span>                      | <span data-ttu-id="06dc6-118">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-118">N</span></span>                     | <span data-ttu-id="06dc6-119">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-119">N</span></span>                      | <span data-ttu-id="06dc6-120">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-120">Y</span></span>                   |
| <span data-ttu-id="06dc6-121">"Конфигфилес"</span><span class="sxs-lookup"><span data-stu-id="06dc6-121">"ConfigFiles"</span></span>  | <span data-ttu-id="06dc6-122">Исполняемые файлы</span><span class="sxs-lookup"><span data-stu-id="06dc6-122">"Executables"</span></span>           | <span data-ttu-id="06dc6-123">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-123">N</span></span>                     | <span data-ttu-id="06dc6-124">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-124">N</span></span>                      | <span data-ttu-id="06dc6-125">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-125">Y</span></span>                   |
| <span data-ttu-id="06dc6-126">"Лиценсеинфо"</span><span class="sxs-lookup"><span data-stu-id="06dc6-126">"LicenseInfo"</span></span>  | <span data-ttu-id="06dc6-127">""</span><span class="sxs-lookup"><span data-stu-id="06dc6-127">""</span></span>                      | <span data-ttu-id="06dc6-128">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-128">Y</span></span>                     | <span data-ttu-id="06dc6-129">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-129">N</span></span>                      | <span data-ttu-id="06dc6-130">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-130">Y</span></span>                   |
| <span data-ttu-id="06dc6-131">Security</span><span class="sxs-lookup"><span data-stu-id="06dc6-131">"Security"</span></span>     | <span data-ttu-id="06dc6-132">""</span><span class="sxs-lookup"><span data-stu-id="06dc6-132">""</span></span>                      | <span data-ttu-id="06dc6-133">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-133">Y</span></span>                     | <span data-ttu-id="06dc6-134">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-134">N</span></span>                      | <span data-ttu-id="06dc6-135">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-135">Y</span></span>                   |
| <span data-ttu-id="06dc6-136">UserInfo</span><span class="sxs-lookup"><span data-stu-id="06dc6-136">"UserInfo"</span></span>     | <span data-ttu-id="06dc6-137">Security</span><span class="sxs-lookup"><span data-stu-id="06dc6-137">"Security"</span></span>              | <span data-ttu-id="06dc6-138">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-138">N</span></span>                     | <span data-ttu-id="06dc6-139">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-139">N</span></span>                      | <span data-ttu-id="06dc6-140">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-140">N</span></span>                   |
| <span data-ttu-id="06dc6-141">Сертификаты</span><span class="sxs-lookup"><span data-stu-id="06dc6-141">"Certificates"</span></span> | <span data-ttu-id="06dc6-142">Security</span><span class="sxs-lookup"><span data-stu-id="06dc6-142">"Security"</span></span>              | <span data-ttu-id="06dc6-143">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-143">N</span></span>                     | <span data-ttu-id="06dc6-144">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-144">N</span></span>                      | <span data-ttu-id="06dc6-145">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-145">N</span></span>                   |
| <span data-ttu-id="06dc6-146">"Вритердата"</span><span class="sxs-lookup"><span data-stu-id="06dc6-146">"writerData"</span></span>   | <span data-ttu-id="06dc6-147">""</span><span class="sxs-lookup"><span data-stu-id="06dc6-147">""</span></span>                      | <span data-ttu-id="06dc6-148">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-148">Y</span></span>                     | <span data-ttu-id="06dc6-149">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-149">Y</span></span>                      | <span data-ttu-id="06dc6-150">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-150">Y</span></span>                   |
| <span data-ttu-id="06dc6-151">Set1</span><span class="sxs-lookup"><span data-stu-id="06dc6-151">"Set1"</span></span>         | <span data-ttu-id="06dc6-152">"Вритердата"</span><span class="sxs-lookup"><span data-stu-id="06dc6-152">"writerData"</span></span>            | <span data-ttu-id="06dc6-153">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-153">N</span></span>                     | <span data-ttu-id="06dc6-154">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-154">Y</span></span>                      | <span data-ttu-id="06dc6-155">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-155">N</span></span>                   |
| <span data-ttu-id="06dc6-156">Янв</span><span class="sxs-lookup"><span data-stu-id="06dc6-156">"Jan"</span></span>          | <span data-ttu-id="06dc6-157">"Вритердата \\ Set1"</span><span class="sxs-lookup"><span data-stu-id="06dc6-157">"writerData\\Set1"</span></span>      | <span data-ttu-id="06dc6-158">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-158">N</span></span>                     | <span data-ttu-id="06dc6-159">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-159">N</span></span>                      | <span data-ttu-id="06dc6-160">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-160">N</span></span>                   |
| <span data-ttu-id="06dc6-161">Уменьшение</span><span class="sxs-lookup"><span data-stu-id="06dc6-161">"Dec"</span></span>          | <span data-ttu-id="06dc6-162">"Вритердата \\ Set1"</span><span class="sxs-lookup"><span data-stu-id="06dc6-162">"writerData\\Set1"</span></span>      | <span data-ttu-id="06dc6-163">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-163">N</span></span>                     | <span data-ttu-id="06dc6-164">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-164">N</span></span>                      | <span data-ttu-id="06dc6-165">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-165">N</span></span>                   |
| <span data-ttu-id="06dc6-166">Set2</span><span class="sxs-lookup"><span data-stu-id="06dc6-166">"Set2"</span></span>         | <span data-ttu-id="06dc6-167">"Вритердата"</span><span class="sxs-lookup"><span data-stu-id="06dc6-167">"writerData"</span></span>            | <span data-ttu-id="06dc6-168">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-168">N</span></span>                     | <span data-ttu-id="06dc6-169">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-169">Y</span></span>                      | <span data-ttu-id="06dc6-170">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-170">N</span></span>                   |
| <span data-ttu-id="06dc6-171">Янв</span><span class="sxs-lookup"><span data-stu-id="06dc6-171">"Jan"</span></span>          | <span data-ttu-id="06dc6-172">"Вритердата \\ Set2"</span><span class="sxs-lookup"><span data-stu-id="06dc6-172">"writerData\\Set2"</span></span>      | <span data-ttu-id="06dc6-173">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-173">N</span></span>                     | <span data-ttu-id="06dc6-174">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-174">N</span></span>                      | <span data-ttu-id="06dc6-175">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-175">N</span></span>                   |
| <span data-ttu-id="06dc6-176">Уменьшение</span><span class="sxs-lookup"><span data-stu-id="06dc6-176">"Dec"</span></span>          | <span data-ttu-id="06dc6-177">"Вритердата \\ Set2"</span><span class="sxs-lookup"><span data-stu-id="06dc6-177">"writerData\\Set2"</span></span>      | <span data-ttu-id="06dc6-178">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-178">N</span></span>                     | <span data-ttu-id="06dc6-179">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-179">N</span></span>                      | <span data-ttu-id="06dc6-180">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-180">N</span></span>                   |
| <span data-ttu-id="06dc6-181">Выбор</span><span class="sxs-lookup"><span data-stu-id="06dc6-181">"Query"</span></span>        | <span data-ttu-id="06dc6-182">"Вритердата \\ куерилогс"</span><span class="sxs-lookup"><span data-stu-id="06dc6-182">"writerData\\QueryLogs"</span></span> | <span data-ttu-id="06dc6-183">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-183">N</span></span>                     | <span data-ttu-id="06dc6-184">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-184">N</span></span>                      | <span data-ttu-id="06dc6-185">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-185">N</span></span>                   |
| <span data-ttu-id="06dc6-186">Загрузка</span><span class="sxs-lookup"><span data-stu-id="06dc6-186">"Usage"</span></span>        | <span data-ttu-id="06dc6-187">"Вритердата"</span><span class="sxs-lookup"><span data-stu-id="06dc6-187">"writerData"</span></span>            | <span data-ttu-id="06dc6-188">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-188">Y</span></span>                     | <span data-ttu-id="06dc6-189">Да</span><span class="sxs-lookup"><span data-stu-id="06dc6-189">Y</span></span>                      | <span data-ttu-id="06dc6-190">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-190">N</span></span>                   |
| <span data-ttu-id="06dc6-191">Янв</span><span class="sxs-lookup"><span data-stu-id="06dc6-191">"Jan"</span></span>          | <span data-ttu-id="06dc6-192">" \\ Использование вритердата"</span><span class="sxs-lookup"><span data-stu-id="06dc6-192">"writerData\\Usage"</span></span>     | <span data-ttu-id="06dc6-193">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-193">N</span></span>                     | <span data-ttu-id="06dc6-194">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-194">N</span></span>                      | <span data-ttu-id="06dc6-195">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-195">N</span></span>                   |
| <span data-ttu-id="06dc6-196">Уменьшение</span><span class="sxs-lookup"><span data-stu-id="06dc6-196">"Dec"</span></span>          | <span data-ttu-id="06dc6-197">" \\ Использование вритердата"</span><span class="sxs-lookup"><span data-stu-id="06dc6-197">"writerData\\Usage"</span></span>     | <span data-ttu-id="06dc6-198">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-198">N</span></span>                     | <span data-ttu-id="06dc6-199">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-199">N</span></span>                      | <span data-ttu-id="06dc6-200">Нет</span><span class="sxs-lookup"><span data-stu-id="06dc6-200">N</span></span>                   |



 

## <a name="implicitly-included-components-in-the-backup-set"></a><span data-ttu-id="06dc6-201">Неявно включаемые компоненты в резервном наборе данных</span><span class="sxs-lookup"><span data-stu-id="06dc6-201">Implicitly Included Components in the Backup Set</span></span>

<span data-ttu-id="06dc6-202">При проверке документа метаданных модуля записи (см. [**ивссбаккупкомпонентс:: жетвритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata)) во время резервного копирования инициатор запроса должен хранить список всех компонентов, их [*логические пути*](vssgloss-l.md)и сведения о наборах файлов.</span><span class="sxs-lookup"><span data-stu-id="06dc6-202">While examining a writer's Writer Metadata Document (see [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata)) during backup, a requester should be storing a list of all components, their [*logical paths*](vssgloss-l.md), and their file set information.</span></span>

<span data-ttu-id="06dc6-203">Чтобы определить список файлов для любого (явно или неявно) включенного компонента, необходимы сведения о наборе файлов и исключенном файле.</span><span class="sxs-lookup"><span data-stu-id="06dc6-203">File set and excluded file information will be needed to determine a list of files for any (explicitly or implicitly) included component.</span></span>

<span data-ttu-id="06dc6-204">Для невыбираемых компонентов резервного копирования без возможности выбора для предков резервного копирования и выбора для компонентов резервного копирования, которые не определяют [*набор компонентов*](vssgloss-c.md), для определения всех кандидатов компонента резервного копирования необходимы только сведения о наборе файлов и исключенных файлах, так как эти компоненты не определяют подкомпоненты.</span><span class="sxs-lookup"><span data-stu-id="06dc6-204">For nonselectable for backup components with no selectable for backup ancestors and selectable for backup components that do not define a [*component set*](vssgloss-c.md), only file set and excluded file information will be needed to identify all the component's candidates for backup, because these components do not define subcomponents.</span></span>

<span data-ttu-id="06dc6-205">Для явно включаемых компонентов для резервного копирования, определяющих набор компонентов, файл устанавливает и исключает сведения о файле как для определяющего компонента, так и во всех [*подкомпонентах*](vssgloss-s.md) для выбора файлов для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="06dc6-205">For explicitly included selectable for backup components that define a component set, the file sets and exclude file information both for the defining component and all [*subcomponents*](vssgloss-s.md) needs to be used to select files for backup.</span></span>

<span data-ttu-id="06dc6-206">Это означает, что резервные наборы данных для компонентов "Executable", "Конфигфилес" и "Лиценсеинфо" можно найти только путем проверки метаданных модуля записи для этих компонентов с помощью экземпляров интерфейса [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) .</span><span class="sxs-lookup"><span data-stu-id="06dc6-206">This means that backup sets for the components "Executables", "ConfigFiles", and "LicenseInfo" can be found only by examining the writer metadata for just these components using their instances of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface.</span></span>

<span data-ttu-id="06dc6-207">Однако если Вритердата явно включено в резервную копию, необходимо изучить его экземпляр интерфейса [**ивссвмкомпонент**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) и для "set1", "Jan" (с логическим путем "вритердата \\ Set1"), "Dec" (с логическим путем "вритердата \\ Set1"), "set2", "Jan" (с логическим путем "вритердата \\ Set2"), "Dec" (с логическим путем "вритердата \\ Set2"), "Query", "Usage", "Янв" (с логическим путем "Вритердата \\ Usage") и "Dec" (с логическим путем "writerData \\ Usage").</span><span class="sxs-lookup"><span data-stu-id="06dc6-207">However, if writerData is explicitly included in the backup, you must examine its instance of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface and those for "Set1", "Jan" (with logical path "writerData\\Set1"), "Dec" (with logical path "writerData\\Set1"), "Set2", "Jan" (with logical path "writerData\\Set2"), "Dec" (with logical path "writerData\\Set2"), "Query", "Usage", "Jan" (with logical path "writerData\\Usage"), and "Dec" (with logical path "writerData\\Usage").</span></span>

<span data-ttu-id="06dc6-208">Для этого инициатору запроса необходимо сначала указать, что компонент "Вритердата" (логический путь "") доступен для выбора.</span><span class="sxs-lookup"><span data-stu-id="06dc6-208">To do this, a requester will have to first identify that the component "writerData" (logical path "") is selectable.</span></span> <span data-ttu-id="06dc6-209">Затем он должен проверять все другие компоненты, управляемые модулем записи, чтобы определить, является ли первый элемент в их логическом пути "Вритердата".</span><span class="sxs-lookup"><span data-stu-id="06dc6-209">It will then have to scan all the other components managed by the writer to determine whether the first element in their logical path is "writerData".</span></span> <span data-ttu-id="06dc6-210">Эти компоненты, имеющие "Вритердата" в качестве ведущих членов их логического пути, определяются как подкомпоненты "Вритердата" и неявно выбираются при явном выборе.</span><span class="sxs-lookup"><span data-stu-id="06dc6-210">Those components that have "writerData" as the leading members of their logical path are identified as being subcomponents of "writerData" and are implicitly selected when it is explicitly selected.</span></span>

<span data-ttu-id="06dc6-211">На самом деле необходимо выполнить аналогичную проверку, чтобы определить, что ни один из компонентов не имеет "Лиценсеинфо" в качестве ведущего члена его логического пути, и, таким образом, "Лиценсеинфо" не имеет подкомпонентов.</span><span class="sxs-lookup"><span data-stu-id="06dc6-211">In fact, a similar scan will need to be made to determine that no component has "LicenseInfo" as the leading member of its logical path, and thus that "LicenseInfo" has no subcomponents.</span></span>

<span data-ttu-id="06dc6-212">Из-за сложности этого механизма в VSS многие модули записи инициаторов могут оказаться полезными при создании собственных структур для хранения компонентов и сведений о резервных наборах как для явно, так и для неявно добавляемых компонентов.</span><span class="sxs-lookup"><span data-stu-id="06dc6-212">Because of the complexity of this mechanism in VSS, many requester writers may find it useful to create their own structures for storing component and backup set information for both explicitly and implicitly added components.</span></span>

## <a name="properties-of-implicitly-included-components"></a><span data-ttu-id="06dc6-213">Свойства неявно включаемых компонентов</span><span class="sxs-lookup"><span data-stu-id="06dc6-213">Properties of Implicitly Included Components</span></span>

<span data-ttu-id="06dc6-214">Во время операций восстановления и резервного копирования экземпляры интерфейсов [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) и [**ивссбаккупкомпонентс**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) используются как для получения сведений о компонентах, так и для установки или изменения свойств компонента.</span><span class="sxs-lookup"><span data-stu-id="06dc6-214">During restore and backup operations, instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) and [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interfaces are used both to retrieve information about components, and to set or change component properties.</span></span> <span data-ttu-id="06dc6-215">Однако только явно включаемые компоненты будут иметь экземпляры интерфейса **ивсскомпонент** или будут доступны интерфейсу **ивссбаккупкомпонентс** .</span><span class="sxs-lookup"><span data-stu-id="06dc6-215">However, only components explicitly included will have instances of the **IVssComponent** interface or be accessible to the **IVssBackupComponents** interface.</span></span>

<span data-ttu-id="06dc6-216">Некоторые свойства задаются на уровне компонентов в области.</span><span class="sxs-lookup"><span data-stu-id="06dc6-216">Some properties are component-set-wide in scope.</span></span> <span data-ttu-id="06dc6-217">К этим свойствам относятся следующие.</span><span class="sxs-lookup"><span data-stu-id="06dc6-217">These properties include the following:</span></span>

-   <span data-ttu-id="06dc6-218">Состояние резервного копирования и восстановления:</span><span class="sxs-lookup"><span data-stu-id="06dc6-218">Backup and restore status:</span></span> <dl>

[<span data-ttu-id="06dc6-219">**Ивссбаккупкомпонентс:: Сетбаккупсукцеедед**</span><span class="sxs-lookup"><span data-stu-id="06dc6-219">**IVssBackupComponents::SetBackupSucceeded**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)  
    [<span data-ttu-id="06dc6-220">**Ивсскомпонент:: Жетбаккупсукцеедед**</span><span class="sxs-lookup"><span data-stu-id="06dc6-220">**IVssComponent::GetBackupSucceeded**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)  
    [<span data-ttu-id="06dc6-221">**Ивссбаккупкомпонентс:: Сетфилересторестатус**</span><span class="sxs-lookup"><span data-stu-id="06dc6-221">**IVssBackupComponents::SetFileRestoreStatus**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)  
    [<span data-ttu-id="06dc6-222">**Ивсскомпонент:: Жетфилересторестатус**</span><span class="sxs-lookup"><span data-stu-id="06dc6-222">**IVssComponent::GetFileRestoreStatus**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)  
    </dl>
-   <span data-ttu-id="06dc6-223">Параметры резервного копирования и восстановления:</span><span class="sxs-lookup"><span data-stu-id="06dc6-223">Backup and restore options:</span></span> <dl>

[<span data-ttu-id="06dc6-224">**Ивссбаккупкомпонентс:: Сетбаккупоптионс**</span><span class="sxs-lookup"><span data-stu-id="06dc6-224">**IVssBackupComponents::SetBackupOptions**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions)  
    [<span data-ttu-id="06dc6-225">**Ивсскомпонент:: Жетбаккупоптионс**</span><span class="sxs-lookup"><span data-stu-id="06dc6-225">**IVssComponent::GetBackupOptions**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions)  
    [<span data-ttu-id="06dc6-226">**Ивссбаккупкомпонентс:: Сетрестореоптионс**</span><span class="sxs-lookup"><span data-stu-id="06dc6-226">**IVssBackupComponents::SetRestoreOptions**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions)  
    [<span data-ttu-id="06dc6-227">**Ивсскомпонент:: Жетрестореоптионс**</span><span class="sxs-lookup"><span data-stu-id="06dc6-227">**IVssComponent::GetRestoreOptions**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions)  
    </dl>
-   <span data-ttu-id="06dc6-228">Сообщения о сбое:</span><span class="sxs-lookup"><span data-stu-id="06dc6-228">Failure messages:</span></span> <dl>

[<span data-ttu-id="06dc6-229">**Ивсскомпонент:: Сетпостресторефаилуремсг**</span><span class="sxs-lookup"><span data-stu-id="06dc6-229">**IVssComponent::SetPostRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)  
    [<span data-ttu-id="06dc6-230">**Ивсскомпонент:: Сетпрересторефаилуремсг**</span><span class="sxs-lookup"><span data-stu-id="06dc6-230">**IVssComponent::SetPreRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)  
    [<span data-ttu-id="06dc6-231">**Ивсскомпонент:: Сетпостресторефаилуремсг**</span><span class="sxs-lookup"><span data-stu-id="06dc6-231">**IVssComponent::SetPostRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)  
    [<span data-ttu-id="06dc6-232">**Ивсскомпонент:: Сетпрересторефаилуремсг**</span><span class="sxs-lookup"><span data-stu-id="06dc6-232">**IVssComponent::SetPreRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)  
    </dl>
-   <span data-ttu-id="06dc6-233">Целевые объекты восстановления:</span><span class="sxs-lookup"><span data-stu-id="06dc6-233">Restore targets:</span></span> <dl>

[<span data-ttu-id="06dc6-234">**Ивсскомпонент:: Сетресторетаржет**</span><span class="sxs-lookup"><span data-stu-id="06dc6-234">**IVssComponent::SetRestoreTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget)  
    [<span data-ttu-id="06dc6-235">**Ивсскомпонент:: Жетресторетаржет**</span><span class="sxs-lookup"><span data-stu-id="06dc6-235">**IVssComponent::GetRestoreTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget)  
    </dl>
-   <span data-ttu-id="06dc6-236">Метки резервного копирования:</span><span class="sxs-lookup"><span data-stu-id="06dc6-236">Backup stamps:</span></span> <dl>

[<span data-ttu-id="06dc6-237">**Ивсскомпонент:: Сетбаккупстамп**</span><span class="sxs-lookup"><span data-stu-id="06dc6-237">**IVssComponent::SetBackupStamp**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)  
    [<span data-ttu-id="06dc6-238">**Ивсскомпонент:: Жетбаккупстамп**</span><span class="sxs-lookup"><span data-stu-id="06dc6-238">**IVssComponent::GetBackupStamp**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)  
    </dl>
-   <span data-ttu-id="06dc6-239">Дополнительные метаданные:</span><span class="sxs-lookup"><span data-stu-id="06dc6-239">Additional metadata:</span></span> <dl>

[<span data-ttu-id="06dc6-240">**Ивсскомпонент:: Сетрестореметадата**</span><span class="sxs-lookup"><span data-stu-id="06dc6-240">**IVssComponent::SetRestoreMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)  
    [<span data-ttu-id="06dc6-241">**Ивсскомпонент:: Жетрестореметадата**</span><span class="sxs-lookup"><span data-stu-id="06dc6-241">**IVssComponent::GetRestoreMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)  
    [<span data-ttu-id="06dc6-242">**Ивсскомпонент:: Сетбаккупметадата**</span><span class="sxs-lookup"><span data-stu-id="06dc6-242">**IVssComponent::SetBackupMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)  
    [<span data-ttu-id="06dc6-243">**Ивсскомпонент:: Жетбаккупметадата**</span><span class="sxs-lookup"><span data-stu-id="06dc6-243">**IVssComponent::GetBackupMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)  
    </dl>

<span data-ttu-id="06dc6-244">Поэтому используется экземпляр интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) в определяющем члене набора компонентов или используется имя, тип и логический путь определяющего члена с методом [**ивссбаккупкомпонентс**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) для установки или получения свойств всех членов набора компонентов.</span><span class="sxs-lookup"><span data-stu-id="06dc6-244">Therefore, you use the instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface of a component set's defining member or use the defining member's name, type, and logical path with an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) method to set or retrieve properties for all the component set's members.</span></span>

<span data-ttu-id="06dc6-245">По этой причине Наборы компонентов обрабатываются как единицы измерения.</span><span class="sxs-lookup"><span data-stu-id="06dc6-245">For this reason, component sets are treated as units.</span></span> <span data-ttu-id="06dc6-246">Например, резервная копия набора компонентов завершается успешно, только если резервное копирование всех наборов файлов всех его компонентов прошло успешно.</span><span class="sxs-lookup"><span data-stu-id="06dc6-246">For instance, a backup of a component set is successful only if the backup of all of the file sets of all of its components is successful.</span></span>

<span data-ttu-id="06dc6-247">В предыдущем примере предположим, что один файл в компоненте «Jan» (с логическим путем «Вритердата \\ Set2») является членом набора компонентов, определенного параметром «вритердата».</span><span class="sxs-lookup"><span data-stu-id="06dc6-247">In the preceding example, suppose one file in the component "Jan" (with logical path "writerData\\Set2") is a member of the component set defined by "writerData".</span></span> <span data-ttu-id="06dc6-248">Если не удалось выполнить резервное копирование одного из файлов "Jan", запрашивающая сторона будет использовать сведения "Вритердата" (имя "Вритердата", путь "" и тип компонента) в качестве аргументов при задании [**ивссбаккупкомпонентс:: сетбаккупсукцеедед**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) с **false** для указания на сбой набора компонентов.</span><span class="sxs-lookup"><span data-stu-id="06dc6-248">If one of "Jan"'s files failed to back up, a requester would use "writerData"'s information (its name "writerData", its path "", and its component type) as arguments when setting [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) with **false** to indicate the component set's failure.</span></span>

<span data-ttu-id="06dc6-249">Аналогично, состояние, возвращаемое [**ивсскомпонент:: жетбаккупсукцеедед**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded) для экземпляра Вритердата интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , применяется не только к "вритердата", но и ко всем его подкомпонентам.</span><span class="sxs-lookup"><span data-stu-id="06dc6-249">Similarly, the state returned by [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded) for "writerData"'s instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface applies not just to "writerData" but to all its subcomponents as well.</span></span>

<span data-ttu-id="06dc6-250">Кроме того, если модуль записи решил изменить цель восстановления с помощью [**ивсскомпонент:: сетресторетаржет**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget) экземпляра вритердата [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), то он изменит целевой объект восстановления для всех наборов файлов всех подкомпонентов "вритердата".</span><span class="sxs-lookup"><span data-stu-id="06dc6-250">In addition, if a writer chose to change the restore target using [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget) of "writerData"'s instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), that would change the restore target for all the file sets of all of "writerData"'s subcomponents.</span></span>

<span data-ttu-id="06dc6-251">Следующие свойства применяются не ко всему компоненту, а к определенным файлам или наборам файлов:</span><span class="sxs-lookup"><span data-stu-id="06dc6-251">The following properties apply not component-wide, but to particular files or file sets:</span></span>

-   <span data-ttu-id="06dc6-252">Сопоставления альтернативного расположения:</span><span class="sxs-lookup"><span data-stu-id="06dc6-252">Alternate location mappings:</span></span> <dl>

[<span data-ttu-id="06dc6-253">**Ивссбаккупкомпонентс:: Аддалтернативелокатионмаппинг**</span><span class="sxs-lookup"><span data-stu-id="06dc6-253">**IVssBackupComponents::AddAlternativeLocationMapping**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping)  
    [<span data-ttu-id="06dc6-254">**Ивсскомпонент:: Жеталтернателокатионмаппинг**</span><span class="sxs-lookup"><span data-stu-id="06dc6-254">**IVssComponent::GetAlternateLocationMapping**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping)  
    [<span data-ttu-id="06dc6-255">**Ивсскомпонент:: Жеталтернателокатионмаппингкаунт**</span><span class="sxs-lookup"><span data-stu-id="06dc6-255">**IVssComponent::GetAlternateLocationMappingCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount)  
    </dl>
-   <span data-ttu-id="06dc6-256">Разностные файлы:</span><span class="sxs-lookup"><span data-stu-id="06dc6-256">Differenced files:</span></span> <dl>

[<span data-ttu-id="06dc6-257">**Ивсскомпонент:: Адддифференцедфилесбиластмодифитиме**</span><span class="sxs-lookup"><span data-stu-id="06dc6-257">**IVssComponent::AddDifferencedFilesByLastModifyTime**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime)  
    [<span data-ttu-id="06dc6-258">**Ивсскомпонент:: Жетдифференцедфиле**</span><span class="sxs-lookup"><span data-stu-id="06dc6-258">**IVssComponent::GetDifferencedFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile)  
    [<span data-ttu-id="06dc6-259">**Ивсскомпонент:: Жетдифференцедфилескаунт**</span><span class="sxs-lookup"><span data-stu-id="06dc6-259">**IVssComponent::GetDifferencedFilesCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount)  
    </dl>
-   <span data-ttu-id="06dc6-260">Частичные файлы:</span><span class="sxs-lookup"><span data-stu-id="06dc6-260">Partial files:</span></span> <dl>

[<span data-ttu-id="06dc6-261">**Ивсскомпонент:: Аддпартиалфиле**</span><span class="sxs-lookup"><span data-stu-id="06dc6-261">**IVssComponent::AddPartialFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)  
    [<span data-ttu-id="06dc6-262">**Ивсскомпонент:: Жетпартиалфиле**</span><span class="sxs-lookup"><span data-stu-id="06dc6-262">**IVssComponent::GetPartialFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)  
    [<span data-ttu-id="06dc6-263">**Ивсскомпонент:: Жетпартиалфилекаунт**</span><span class="sxs-lookup"><span data-stu-id="06dc6-263">**IVssComponent::GetPartialFileCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount)  
    </dl>
-   <span data-ttu-id="06dc6-264">Направленные целевые объекты:</span><span class="sxs-lookup"><span data-stu-id="06dc6-264">Directed targets:</span></span> <dl>

[<span data-ttu-id="06dc6-265">**Ивсскомпонент:: Адддиректедтаржет**</span><span class="sxs-lookup"><span data-stu-id="06dc6-265">**IVssComponent::AddDirectedTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget)  
    [<span data-ttu-id="06dc6-266">**Ивсскомпонент:: Жетдиректедтаржет**</span><span class="sxs-lookup"><span data-stu-id="06dc6-266">**IVssComponent::GetDirectedTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget)  
    [<span data-ttu-id="06dc6-267">**Ивсскомпонент:: Жетдиректедтаржеткаунт**</span><span class="sxs-lookup"><span data-stu-id="06dc6-267">**IVssComponent::GetDirectedTargetCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount)  
    </dl>
-   <span data-ttu-id="06dc6-268">Новые целевые объекты:</span><span class="sxs-lookup"><span data-stu-id="06dc6-268">New targets:</span></span> <dl>

[<span data-ttu-id="06dc6-269">**Ивссбаккупкомпонентс:: Аддневтаржет**</span><span class="sxs-lookup"><span data-stu-id="06dc6-269">**IVssBackupComponents::AddNewTarget**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)  
    [<span data-ttu-id="06dc6-270">**Ивсскомпонент:: Жетневтаржет**</span><span class="sxs-lookup"><span data-stu-id="06dc6-270">**IVssComponent::GetNewTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)  
    [<span data-ttu-id="06dc6-271">**Ивсскомпонент:: Жетневтаржеткаунт**</span><span class="sxs-lookup"><span data-stu-id="06dc6-271">**IVssComponent::GetNewTargetCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount)  
    </dl>

<span data-ttu-id="06dc6-272">Когда инициатор запроса обращается к этим функциям для подкомпонента с помощью интерфейса [**ивссбаккупкомпонентс**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) , он использует сведения о компоненте для компонента, определяющего набор компонентов, но сведения о файле или наборе файлов для подкомпонента.</span><span class="sxs-lookup"><span data-stu-id="06dc6-272">When a requester accesses these features for a subcomponent using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface, it uses the component information for the component set's defining component, but the file or file set information for the subcomponent.</span></span>

<span data-ttu-id="06dc6-273">Аналогично, если свойство доступно через интерфейс [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , используется экземпляр, соответствующий определяющему подкомпоненту, но аргументы файла или набора файлов берутся из подкомпонента.</span><span class="sxs-lookup"><span data-stu-id="06dc6-273">Likewise, if the property is accessible through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, the instance corresponding to the defining subcomponent is used, but the file or file set arguments are taken from the subcomponent.</span></span>

<span data-ttu-id="06dc6-274">Например, предположим, что подкомпоненту «Jan» (с логическим путем «Вритердата \\ Set2») присвоено множество файлов с путем «c: \\ Fred», спецификация файла « \* . dat», а рекурсивный флаг « **Истина** » может быть восстановлен в альтернативное расположение.</span><span class="sxs-lookup"><span data-stu-id="06dc6-274">For instance, suppose the subcomponent "Jan" (with logical path "writerData\\Set2") had a file set with a path of "c:\\fred", a file specification of "\*.dat", and a recursive flag of **true** might have to be restored to an alternate location.</span></span>

<span data-ttu-id="06dc6-275">В этом случае инициатор запроса вызовет [**ивссбаккупкомпонентс:: аддалтернативелокатионмаппинг**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping), используя сведения об "вритердата" (тип компонента, имя компонента "writeData" и логический путь ""), а также сведения о наборе файлов "Jan" (путь "c: \\ Fred", спецификация файла " \* . dat", а рекурсия — **true**).</span><span class="sxs-lookup"><span data-stu-id="06dc6-275">If this was the case, a requester would call [**IVssBackupComponents::AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping), using "writerData"'s information (component type, a component name of "writeData", and a logical path of "") along with "Jan"'s file set information (path "c:\\fred", file specification "\*.dat", and recursion equals **true**).</span></span>

<span data-ttu-id="06dc6-276">Обратите внимание, что в этом случае сведения о наборе файлов должны точно соответствовать сведениям о наборе файлов, используемых [**ивсскреатевритерметадата:: аддфилестофилеграуп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**Ивсскреатевритерметадата:: адддатабасефилес**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles)или [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) для добавления файлов в Jan.</span><span class="sxs-lookup"><span data-stu-id="06dc6-276">Note that in this case the file set information must exactly match the file set information used by [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), or [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) to add files to Jan.</span></span>

<span data-ttu-id="06dc6-277">Аналогично, если модуль записи хочет добавить направленный целевой объект в файл с путем "c: \\ есел" и именем "Люси. dat", управляемый с помощью "Jan" (с логическим путем "вритердата \\ Set2"), будет использоваться экземпляр [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , соответствующий "вритердата", но сведения о файле "Jan".</span><span class="sxs-lookup"><span data-stu-id="06dc6-277">Similarly, if a writer wanted to add a directed target to a file with a path of "c:\\ethel" and name "lucy.dat" managed by "Jan" (with logical path "writerData\\Set2"), it would use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance corresponding to "writerData", but "Jan"'s file information.</span></span>

## <a name="implicitly-included-components-in-the-restore-set"></a><span data-ttu-id="06dc6-278">Неявно включаемые компоненты в набор восстановления</span><span class="sxs-lookup"><span data-stu-id="06dc6-278">Implicitly Included Components in the Restore Set</span></span>

<span data-ttu-id="06dc6-279">Компоненты, которые были неявно включены в резервную копию, могут быть явно включены в восстановление, если они могут быть выбраны для восстановления.</span><span class="sxs-lookup"><span data-stu-id="06dc6-279">Components that were implicitly included in a backup can be explicitly included in a restore if they are selectable for restore.</span></span> <span data-ttu-id="06dc6-280">Как отмечалось при [работе с выборкой для восстановления и подкомпонентов](working-with-selectability-for-restore-and-subcomponents.md), такие компоненты добавляются в документ компонентов резервного копирования с помощью метода [**Ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) .</span><span class="sxs-lookup"><span data-stu-id="06dc6-280">As noted in [Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md), such components are added to the Backup Components Document using the [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) method.</span></span>

<span data-ttu-id="06dc6-281">Однако это не создает новый экземпляр интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , а также компонент, напрямую доступный через интерфейс [**ивссбаккупкомпонентс**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="06dc6-281">However, this does not create a new instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, nor is the component directly accessible through the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span>

<span data-ttu-id="06dc6-282">Вместо этого компонент, явно включаемый в восстановление, но неявно включаемый для резервного копирования, должен быть доступен через экземпляр интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , соответствующий компоненту, который определил, что он был членом при резервном копировании.</span><span class="sxs-lookup"><span data-stu-id="06dc6-282">Instead, a component explicitly included for restore, but implicitly included for backup, must be accessed through an instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface corresponding to the component that defined the component set of which it was a member upon backup.</span></span>

<span data-ttu-id="06dc6-283">Например, чтобы явно включить для Restore "set1", подкомпонент выбираемого компонента для резервного копирования "Вритердата", необходимо получить сведения о нем, вызвав метод [**ивсскомпонент:: жетресторесубкомпонент**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent) экземпляра Вритердата интерфейса [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="06dc6-283">For example, to explicitly include for restore "Set1", a subcomponent of the selectable for backup component "writerData", you would obtain information about it by calling the [**IVssComponent::GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent) method of "writerData"'s instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

 

 



