---
description: 'В ответ на событие Identify каждый модуль записи, представленный в системе, конструирует собственный документ метаданных записи с помощью Ивсскреатевритерметадата. Событие Identify обычно создается инициатором запроса, вызывающим Ивссбаккупкомпонентс:: Гасервритерметадата.'
ms.assetid: bae9bbe7-ca55-47cb-b253-8092007cb181
title: Жизненный цикл документа метаданных модуля записи
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45be5748625d21f99abe3e77e0d6474a62210904
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692329"
---
# <a name="writer-metadata-document-life-cycle"></a><span data-ttu-id="8d52b-104">Жизненный цикл документа метаданных модуля записи</span><span class="sxs-lookup"><span data-stu-id="8d52b-104">Writer Metadata Document Life Cycle</span></span>

<span data-ttu-id="8d52b-105">В ответ на [*событие Identify*](vssgloss-i.md)каждый модуль записи, представленный в системе, конструирует собственный документ метаданных записи с помощью [**ивсскреатевритерметадата**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata).</span><span class="sxs-lookup"><span data-stu-id="8d52b-105">In response to an [*Identify event*](vssgloss-i.md), each writer present on the system constructs its own Writer Metadata Document using [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata).</span></span> <span data-ttu-id="8d52b-106">*Событие Identify* обычно создается инициатором запроса, вызывающим [**Ивссбаккупкомпонентс:: гасервритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="8d52b-106">An *Identify event* is typically generated by a requester calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span>

<span data-ttu-id="8d52b-107">При создании документа метаданных модуля записи с помощью интерфейса [**ивсскреатевритерметадата**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) или инициализации модуля записи ([**Квссвритер:: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize)) модуль записи должен явным образом указать следующее:</span><span class="sxs-lookup"><span data-stu-id="8d52b-107">When creating a Writer Metadata Document, either through the [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) interface or through writer initialization ([**CVssWriter::Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize)), a writer must explicitly specify the following:</span></span>

-   [<span data-ttu-id="8d52b-108">*Метод Restore*</span><span class="sxs-lookup"><span data-stu-id="8d52b-108">*Restore method*</span></span>](vssgloss-r.md)
-   <span data-ttu-id="8d52b-109">Имя модуля записи</span><span class="sxs-lookup"><span data-stu-id="8d52b-109">Writer name</span></span>
-   [<span data-ttu-id="8d52b-110">*Идентификатор класса модуля записи*</span><span class="sxs-lookup"><span data-stu-id="8d52b-110">*Writer class ID*</span></span>](vssgloss-w.md)
-   <span data-ttu-id="8d52b-111">Использование данных (см. раздел [**\_ \_ тип использования VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type))</span><span class="sxs-lookup"><span data-stu-id="8d52b-111">Data usage (see [**VSS\_USAGE\_TYPE**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type))</span></span>
-   <span data-ttu-id="8d52b-112">Тип источника данных (см. раздел [**\_ \_ тип источника VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type))</span><span class="sxs-lookup"><span data-stu-id="8d52b-112">Date source type (see [**VSS\_SOURCE\_TYPE**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type))</span></span>

<span data-ttu-id="8d52b-113">Кроме того, он может также указать следующее:</span><span class="sxs-lookup"><span data-stu-id="8d52b-113">In addition, it may also specify the following:</span></span>

-   <span data-ttu-id="8d52b-114">Компоненты (которые могут или не могут содержать наборы файлов)</span><span class="sxs-lookup"><span data-stu-id="8d52b-114">Components (which may or may not contain file sets)</span></span>
-   <span data-ttu-id="8d52b-115">Добавление альтернативных сопоставлений</span><span class="sxs-lookup"><span data-stu-id="8d52b-115">Add alternate mappings</span></span>
-   <span data-ttu-id="8d52b-116">Исключить списки файлов</span><span class="sxs-lookup"><span data-stu-id="8d52b-116">Exclude file lists</span></span>

<span data-ttu-id="8d52b-117">Обзор создания документов метаданных модуля записи находится в [действиях модуля записи во время инициализации резервного копирования](overview-of-backup-initialization.md).</span><span class="sxs-lookup"><span data-stu-id="8d52b-117">An overview of Writer Metadata Document creation is found in [Writer Actions during Backup Initialization](overview-of-backup-initialization.md).</span></span>

<span data-ttu-id="8d52b-118">Как правило, запрашивающие стороны используют один из двух методов для получения доступа к метаданным модуля записи:</span><span class="sxs-lookup"><span data-stu-id="8d52b-118">Requesters typically make use of one of two methods to obtain access to writer metadata:</span></span>

-   <span data-ttu-id="8d52b-119">Во время большинства операций резервного копирования запрашивающий объект использует [**ивссбаккупкомпонентс:: жетвритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) для получения экземпляра интерфейса [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , чтобы предоставить доступ к метаданным выполняющегося в данный момент модуля записи.</span><span class="sxs-lookup"><span data-stu-id="8d52b-119">During most backup operations, a requester uses [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) to obtain an instance of the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface to allow access to the metadata of a currently executing writer.</span></span>
-   <span data-ttu-id="8d52b-120">Для операций восстановления или резервных копий с использованием импортированных теневых копий [(см.](importing-transportable-shadow-copied-volumes.md) дополнительные сведения об импорте теневых копий) инициатор запроса получает XML-документ, содержащий метаданные, и использует [**креатевссексаминевритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) для получения интерфейса [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , используемого для чтения метаданных восстановления.</span><span class="sxs-lookup"><span data-stu-id="8d52b-120">For restore operations, or backups using imported shadow copies (see [Importing Transportable Shadow Copied Volumes](importing-transportable-shadow-copied-volumes.md) for more information on importing shadow copies), a requester retrieves an XML document containing the metadata and uses [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) to obtain an [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, which it uses to read the restore metadata.</span></span>

<span data-ttu-id="8d52b-121">Документы метаданных модуля записи позволяют инициатору запроса выполнить резервное копирование, чтобы узнать о выполняемых в данный момент модулях записи на этапе обнаружения резервной копии.</span><span class="sxs-lookup"><span data-stu-id="8d52b-121">Writer Metadata Documents enable the requester performing a backup to learn about currently executing writers during the discovery phase of a backup.</span></span>

<span data-ttu-id="8d52b-122">Для тех модулей записи, которые выбраны для участия в резервной копии, инициатор запроса импортирует многие, но не все данные из документа метаданных модуля записи в собственный документ компонентов резервного копирования на этапе обнаружения резервной копии.</span><span class="sxs-lookup"><span data-stu-id="8d52b-122">For those writers chosen to participate in a backup, a requester imports much, but not all, of the information in the Writer Metadata Document into its own Backup Components Document during the discovery phase of a backup.</span></span>

<span data-ttu-id="8d52b-123">Тем не менее, только документы с метаданными модуля записи, а не документ компонентов резервного копирования содержат спецификации файла и пути.</span><span class="sxs-lookup"><span data-stu-id="8d52b-123">However, only Writer Metadata Documents and not the Backup Components Document contain the file and path specifications.</span></span>

<span data-ttu-id="8d52b-124">Дополнительные сведения о выполнении фазы обнаружения операции резервного копирования см. [в разделе Обзор фазы обнаружения резервных копий](overview-of-the-backup-discovery-phase.md).</span><span class="sxs-lookup"><span data-stu-id="8d52b-124">For more information on how the discovery phase of a backup operation is conducted, see [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md).</span></span>

<span data-ttu-id="8d52b-125">Кроме того, в процессе резервного копирования только [*явно включаемые*](vssgloss-e.md) компоненты содержат сведения, хранящиеся в документе компонента резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="8d52b-125">In addition, only [*explicitly included*](vssgloss-e.md) components have their information stored in the Backup Components Document during a backup operation.</span></span> <span data-ttu-id="8d52b-126">Сведения о [*неявно включенных*](vssgloss-i.md) компонентах не включаются в документ компонентов резервного копирования во время операции резервного копирования и должны быть интерполируются с использованием сведений о явно включенных компонентах и документах метаданных модуля записи.</span><span class="sxs-lookup"><span data-stu-id="8d52b-126">Information on [*implicitly included*](vssgloss-i.md) components is not included in the Backup Components Document during a backup operation, and must be interpolated using information about the explicitly included components and the available Writer Metadata Documents.</span></span>

<span data-ttu-id="8d52b-127">Неявно включаемые компоненты по-прежнему могут быть доступны [*для восстановления*](vssgloss-s.md) и должны быть явно добавлены в документ компонентов резервного копирования во время восстановления.</span><span class="sxs-lookup"><span data-stu-id="8d52b-127">Implicitly included components may still be [*selectable for restore*](vssgloss-s.md) and may need to be explicitly included in the Backup Components Document at restore time.</span></span> <span data-ttu-id="8d52b-128">В этом случае, как только Добавление компонента во время операции резервного копирования требовало доступа к документу метаданных модуля записи вритер'с компонента (затем извлекается из модуля записи), инициатору запроса потребуется доступ к копии документов метаданных модуля записи, хранящихся во время резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="8d52b-128">In this case, just as adding a component during a backup operation required access to the component's writer's Writer Metadata Document (then retrieved from the writer), a requester will require access to a copy of that writer's Writer Metadata Documents stored at backup time.</span></span>

<span data-ttu-id="8d52b-129">Таким образом, единственным способом получения всех сведений обо всех файлах и компонентах, участвующих в резервном копировании или восстановлении, является наличие каждого документа метаданных модуля записи для каждого модуля записи, участвующего в резервной копии, хранящейся вместе с документом компонентов резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="8d52b-129">Therefore, the only way to obtain all the information about all the files and components involved in a backup or restore is to have each Writer Metadata Document for each writer participating in a backup stored along with the Backup Components Document.</span></span> <span data-ttu-id="8d52b-130">(Дополнительные сведения см. в разделе [Обзор фактического восстановления файлов](overview-of-actual-file-restoration.md).)</span><span class="sxs-lookup"><span data-stu-id="8d52b-130">(For more information, see [Overview of Actual File Restoration](overview-of-actual-file-restoration.md).)</span></span>

 

 



