---
description: 'В ответ на событие Identify каждый модуль записи, представленный в системе, конструирует собственный документ метаданных записи с помощью Ивсскреатевритерметадата. Событие Identify обычно создается инициатором запроса, вызывающим Ивссбаккупкомпонентс:: Гасервритерметадата.'
ms.assetid: bae9bbe7-ca55-47cb-b253-8092007cb181
title: Жизненный цикл документа метаданных модуля записи
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45be5748625d21f99abe3e77e0d6474a62210904
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692329"
---
# <a name="writer-metadata-document-life-cycle"></a>Жизненный цикл документа метаданных модуля записи

В ответ на [*событие Identify*](vssgloss-i.md)каждый модуль записи, представленный в системе, конструирует собственный документ метаданных записи с помощью [**ивсскреатевритерметадата**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata). *Событие Identify* обычно создается инициатором запроса, вызывающим [**Ивссбаккупкомпонентс:: гасервритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).

При создании документа метаданных модуля записи с помощью интерфейса [**ивсскреатевритерметадата**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) или инициализации модуля записи ([**Квссвритер:: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize)) модуль записи должен явным образом указать следующее:

-   [*Метод Restore*](vssgloss-r.md)
-   Имя модуля записи
-   [*Идентификатор класса модуля записи*](vssgloss-w.md)
-   Использование данных (см. раздел [**\_ \_ тип использования VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type))
-   Тип источника данных (см. раздел [**\_ \_ тип источника VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type))

Кроме того, он может также указать следующее:

-   Компоненты (которые могут или не могут содержать наборы файлов)
-   Добавление альтернативных сопоставлений
-   Исключить списки файлов

Обзор создания документов метаданных модуля записи находится в [действиях модуля записи во время инициализации резервного копирования](overview-of-backup-initialization.md).

Как правило, запрашивающие стороны используют один из двух методов для получения доступа к метаданным модуля записи:

-   Во время большинства операций резервного копирования запрашивающий объект использует [**ивссбаккупкомпонентс:: жетвритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) для получения экземпляра интерфейса [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , чтобы предоставить доступ к метаданным выполняющегося в данный момент модуля записи.
-   Для операций восстановления или резервных копий с использованием импортированных теневых копий [(см.](importing-transportable-shadow-copied-volumes.md) дополнительные сведения об импорте теневых копий) инициатор запроса получает XML-документ, содержащий метаданные, и использует [**креатевссексаминевритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) для получения интерфейса [**ивссексаминевритерметадата**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , используемого для чтения метаданных восстановления.

Документы метаданных модуля записи позволяют инициатору запроса выполнить резервное копирование, чтобы узнать о выполняемых в данный момент модулях записи на этапе обнаружения резервной копии.

Для тех модулей записи, которые выбраны для участия в резервной копии, инициатор запроса импортирует многие, но не все данные из документа метаданных модуля записи в собственный документ компонентов резервного копирования на этапе обнаружения резервной копии.

Тем не менее, только документы с метаданными модуля записи, а не документ компонентов резервного копирования содержат спецификации файла и пути.

Дополнительные сведения о выполнении фазы обнаружения операции резервного копирования см. [в разделе Обзор фазы обнаружения резервных копий](overview-of-the-backup-discovery-phase.md).

Кроме того, в процессе резервного копирования только [*явно включаемые*](vssgloss-e.md) компоненты содержат сведения, хранящиеся в документе компонента резервного копирования. Сведения о [*неявно включенных*](vssgloss-i.md) компонентах не включаются в документ компонентов резервного копирования во время операции резервного копирования и должны быть интерполируются с использованием сведений о явно включенных компонентах и документах метаданных модуля записи.

Неявно включаемые компоненты по-прежнему могут быть доступны [*для восстановления*](vssgloss-s.md) и должны быть явно добавлены в документ компонентов резервного копирования во время восстановления. В этом случае, как только Добавление компонента во время операции резервного копирования требовало доступа к документу метаданных модуля записи вритер'с компонента (затем извлекается из модуля записи), инициатору запроса потребуется доступ к копии документов метаданных модуля записи, хранящихся во время резервного копирования.

Таким образом, единственным способом получения всех сведений обо всех файлах и компонентах, участвующих в резервном копировании или восстановлении, является наличие каждого документа метаданных модуля записи для каждого модуля записи, участвующего в резервной копии, хранящейся вместе с документом компонентов резервного копирования. (Дополнительные сведения см. в разделе [Обзор фактического восстановления файлов](overview-of-actual-file-restoration.md).)

 

 



