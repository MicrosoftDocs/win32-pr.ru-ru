---
description: Модуль записи теста — это служебная программа, которую можно использовать для тестирования приложений инициатора запроса VSS.
ms.assetid: 02434cb9-390c-4cf0-9941-b833ace55685
title: Средство записи тестов VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 61ffdbb513697a701866be5ceeb40168e8c28368
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692363"
---
# <a name="vss-test-writer-tool"></a><span data-ttu-id="01010-103">Средство записи тестов VSS</span><span class="sxs-lookup"><span data-stu-id="01010-103">VSS Test Writer Tool</span></span>

<span data-ttu-id="01010-104">Модуль записи теста — это служебная программа, которую можно использовать для тестирования приложений инициатора запроса VSS.</span><span class="sxs-lookup"><span data-stu-id="01010-104">The Test Writer is a utility that you can use to test VSS requester applications.</span></span> <span data-ttu-id="01010-105">Этот модуль записи можно настроить для выполнения практически всех действий, которые может выполнять модуль записи VSS.</span><span class="sxs-lookup"><span data-stu-id="01010-105">This writer can be configured to perform almost all of the actions that a VSS writer can perform.</span></span> <span data-ttu-id="01010-106">Кроме того, модуль записи тестов выполняет расширенные проверки, чтобы убедиться, что инициатор запроса правильно обработал эти действия записи.</span><span class="sxs-lookup"><span data-stu-id="01010-106">In addition, the Test Writer performs extensive checks to ensure that the requester has dealt with these writer actions correctly.</span></span>

<span data-ttu-id="01010-107">Каждый экземпляр модуля записи инициализируется с помощью XML-файла конфигурации, в котором точно описаны компоненты, на которые будет сообщать модуль записи, а также принципы работы модуля записи.</span><span class="sxs-lookup"><span data-stu-id="01010-107">Each instance of the writer is initialized with an XML configuration file that describes exactly what components the writer will report on, and how the writer behaves.</span></span> <span data-ttu-id="01010-108">Модуль записи можно настроить для создания отчетов о различных типах сценариев, включая более сложные сценарии с использованием добавочных и разностных интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="01010-108">The writer can be configured to report on various types of scenarios, including more complicated scenarios using the incremental and differential interfaces.</span></span> <span data-ttu-id="01010-109">Модуль записи выполняет проверки в различных точках во время процесса, чтобы убедиться, что инициатор запроса правильно работает надлежащим образом.</span><span class="sxs-lookup"><span data-stu-id="01010-109">The writer will perform checks at various points during the process to ensure that the requester is behaving in a proper manner.</span></span> <span data-ttu-id="01010-110">После завершения восстановления модуль записи проверяет, что все необходимые файлы были восстановлены без повреждений.</span><span class="sxs-lookup"><span data-stu-id="01010-110">After the restore is completed, the writer will check that all necessary files have been restored without corruption.</span></span> <span data-ttu-id="01010-111">Кроме того, модуль записи можно настроить для выполнения других операций, таких как сбой конкретных событий.</span><span class="sxs-lookup"><span data-stu-id="01010-111">The writer can also be configured to perform other operations such as failing specific events.</span></span>

> [!Note]  
> <span data-ttu-id="01010-112">Это средство входит в состав пакета средств разработки программного обеспечения Microsoft Windows (SDK) для Windows Vista и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="01010-112">This tool is included in the Microsoft Windows Software Development Kit (SDK) for Windows Vista and later.</span></span> <span data-ttu-id="01010-113">Вы можете скачать Windows SDK из [https://msdn.microsoft.com/windowsvista](https://msdn.microsoft.com/windows/default.aspx) .</span><span class="sxs-lookup"><span data-stu-id="01010-113">You can download the Windows SDK from [https://msdn.microsoft.com/windowsvista](https://msdn.microsoft.com/windows/default.aspx).</span></span>

 

<span data-ttu-id="01010-114">В Windows SDK установки средство Всссамплепровидер можно найти в `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (для 64-разрядной версии Windows) и `%Program Files(x86)%\Windows Kits\8.1\bin\x86` .</span><span class="sxs-lookup"><span data-stu-id="01010-114">In the Windows SDK installation, the VssSampleProvider tool can be found in `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (for 64-bit Windows) and `%Program Files(x86)%\Windows Kits\8.1\bin\x86`.</span></span>

## <a name="running-the-test-writer-tool"></a><span data-ttu-id="01010-115">Запуск средства записи теста</span><span class="sxs-lookup"><span data-stu-id="01010-115">Running the Test Writer Tool</span></span>

<span data-ttu-id="01010-116">Чтобы запустить модуль записи теста, введите в командной строке следующее:</span><span class="sxs-lookup"><span data-stu-id="01010-116">To start the Test Writer, type the following at the command prompt:</span></span>

<span data-ttu-id="01010-117"> *Файл конфигурацииvswriter.exe-File*</span><span class="sxs-lookup"><span data-stu-id="01010-117">**vswriter.exe** *config-file*</span></span>

<span data-ttu-id="01010-118">где *config-file* — это путь к файлу конфигурации, в котором указывается поведение этого модуля записи.</span><span class="sxs-lookup"><span data-stu-id="01010-118">where *config-file* is the path to a configuration file that specifies the behavior of this writer.</span></span>

<span data-ttu-id="01010-119">Чтобы прерывать модуль записи теста, нажмите клавиши CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="01010-119">To stop the Test Writer, press CTRL+C.</span></span>

<span data-ttu-id="01010-120">Несколько экземпляров модуля записи теста можно запустить одновременно.</span><span class="sxs-lookup"><span data-stu-id="01010-120">Multiple instances of the Test Writer can be run at the same time.</span></span> <span data-ttu-id="01010-121">Однако каждый экземпляр модуля записи будет сообщать один и тот же идентификатор класса записи (хотя другой идентификатор экземпляра модуля записи), поэтому логические пути и имена компонентов должны быть уникальными во всех одновременно работающих экземплярах модуля записи.</span><span class="sxs-lookup"><span data-stu-id="01010-121">However, each instance of the writer will report the same writer class ID (though a different writer instance ID), so logical paths and component names must be unique across all simultaneously running instances of the writer.</span></span>

<span data-ttu-id="01010-122">Чтобы убедиться в том, что модуль записи может проверить правильность спецификаций файла исключения, все файлы, резервные копии которых были созданы, необходимо удалить из исходного тома, прежде чем пытаться восстановить их.</span><span class="sxs-lookup"><span data-stu-id="01010-122">To ensure that the writer can properly check that the requester has honored the exclude file specifications, all files that were backed up should be deleted from the original volume before attempting to restore them.</span></span> <span data-ttu-id="01010-123">Рекомендуется хранить шаблон каждого сценария записи, чтобы сценарий можно было легко воссоздать.</span><span class="sxs-lookup"><span data-stu-id="01010-123">It is recommended that a template of each writer scenario be stored, so the scenario can be easily recreated.</span></span>

## <a name="using-a-configuration-file"></a><span data-ttu-id="01010-124">Использование файла конфигурации</span><span class="sxs-lookup"><span data-stu-id="01010-124">Using a Configuration File</span></span>

<span data-ttu-id="01010-125">Следующий пример файла конфигурации, всвритер \_config.xml, можно найти в `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` на платформах x86 и `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` на платформах x64.</span><span class="sxs-lookup"><span data-stu-id="01010-125">The following sample configuration file, vswriter\_config.xml, can be found in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` on x86 platforms and `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` on x64 platforms.</span></span>

``` syntax
<TestWriter usage="USER_DATA">

    <RestoreMethod method="RESTORE_IF_CAN_BE_REPLACED"
                   writerRestore="always"
                   rebootRequired="no" />

    <ExcludeFile path="c:\writerData\notTheseFiles" 
                 filespec="excludeThisFile.txt" 
                 recursive="no"/>

    <Component componentType="filegroup"
               componentName="TestFiles">
        <ComponentFile path="c:\writerData\myFilesHere" 
                       filespec="*"
                       recursive="no" />
    </Component>

</TestWriter>
```

<span data-ttu-id="01010-126">Корневой элемент в этом файле конфигурации называется Тествритер.</span><span class="sxs-lookup"><span data-stu-id="01010-126">The root element in this configuration file is named TestWriter.</span></span> <span data-ttu-id="01010-127">Все остальные элементы упорядочиваются по элементу Тествритер.</span><span class="sxs-lookup"><span data-stu-id="01010-127">All other elements are arranged under the TestWriter element.</span></span>

<span data-ttu-id="01010-128">Один из атрибутов, связанных с Тествритер, — это атрибут Usage.</span><span class="sxs-lookup"><span data-stu-id="01010-128">One of the attributes associated with TestWriter is the usage attribute.</span></span> <span data-ttu-id="01010-129">Этот атрибут указывает тип использования, сообщаемый через [**ивссексаминевритерметадата::-Identity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).</span><span class="sxs-lookup"><span data-stu-id="01010-129">This attribute specifies the usage type reported through [**IVssExamineWriterMetadata::GetIdentity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).</span></span> <span data-ttu-id="01010-130">Одним из возможных значений этого атрибута являются \_ данные пользователя.</span><span class="sxs-lookup"><span data-stu-id="01010-130">One of the possible values for this attribute is USER\_DATA.</span></span>

<span data-ttu-id="01010-131">Первый дочерний элемент корневого элемента всегда должен быть элементом Ресторемесод.</span><span class="sxs-lookup"><span data-stu-id="01010-131">The first child element of the root element must always be a RestoreMethod element.</span></span> <span data-ttu-id="01010-132">Этот элемент задает следующее:</span><span class="sxs-lookup"><span data-stu-id="01010-132">This element specifies the following:</span></span>

-   <span data-ttu-id="01010-133">Метод Restore (в данном случае Restore \_ , \_ Если \_ можно \_ заменить)</span><span class="sxs-lookup"><span data-stu-id="01010-133">The restore method (in this case, RESTORE\_IF\_CAN\_BE\_REPLACED)</span></span>
-   <span data-ttu-id="01010-134">Требует ли модуль записи события восстановления (в данном случае всегда)</span><span class="sxs-lookup"><span data-stu-id="01010-134">Whether the writer requires restore events (in this case, always)</span></span>
-   <span data-ttu-id="01010-135">Требуется ли перезагрузка после восстановления модуля записи (в данном случае нет)</span><span class="sxs-lookup"><span data-stu-id="01010-135">Whether a reboot is required after the writer is restored (in this case, no)</span></span>

<span data-ttu-id="01010-136">Этот элемент может дополнительно указывать сопоставление альтернативного расположения.</span><span class="sxs-lookup"><span data-stu-id="01010-136">This element can optionally specify an alternate-location mapping.</span></span> <span data-ttu-id="01010-137">(В этом случае альтернативное расположение не указано.)</span><span class="sxs-lookup"><span data-stu-id="01010-137">(In this case, no alternate location is specified.)</span></span>

<span data-ttu-id="01010-138">Второй дочерний элемент является элементом Ексклудефиле.</span><span class="sxs-lookup"><span data-stu-id="01010-138">The second child element is an ExcludeFile element.</span></span> <span data-ttu-id="01010-139">Этот элемент заставляет модуль записи исключить файл или набор файлов из резервной копии.</span><span class="sxs-lookup"><span data-stu-id="01010-139">This element causes the writer to exclude a file or a set of files from backup.</span></span>

<span data-ttu-id="01010-140">Третий дочерний элемент является элементом компонента.</span><span class="sxs-lookup"><span data-stu-id="01010-140">The third child element is a Component element.</span></span> <span data-ttu-id="01010-141">Этот элемент заставляет модуль записи добавить компонент в свои метаданные.</span><span class="sxs-lookup"><span data-stu-id="01010-141">This element causes the writer to add a component to its metadata.</span></span> <span data-ttu-id="01010-142">Элемент component содержит атрибуты, описывающие компонент и дочерние элементы для описания содержимого компонента, например следующие:</span><span class="sxs-lookup"><span data-stu-id="01010-142">A Component element contains attributes to describe the component and child elements to describe the content of the component, such as the following:</span></span>

-   <span data-ttu-id="01010-143">Параметра ComponentType, указывающее, является ли это файловой группой или базой данных</span><span class="sxs-lookup"><span data-stu-id="01010-143">componentType to indicate whether this is a filegroup or a database</span></span>
-   <span data-ttu-id="01010-144">Логикалпас для логического пути к компоненту</span><span class="sxs-lookup"><span data-stu-id="01010-144">logicalPath for the component logical path</span></span>
-   <span data-ttu-id="01010-145">componentName для имени компонента</span><span class="sxs-lookup"><span data-stu-id="01010-145">componentName for the name of the component</span></span>
-   <span data-ttu-id="01010-146">Выберите параметр, чтобы указать состояние для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="01010-146">selectable to indicate selectable-for-backup status</span></span>

<span data-ttu-id="01010-147">Элемент Component также имеет дочерний элемент с именем Компонентфиле, который добавляет спецификацию файла в этот компонент.</span><span class="sxs-lookup"><span data-stu-id="01010-147">The Component element also has a child element named ComponentFile to add a file specification to this component.</span></span> <span data-ttu-id="01010-148">(Элемент компонента может иметь произвольное число элементов Компонентфиле, которые можно указать для каждого компонента.) Этот элемент Компонентфиле имеет следующие атрибуты:</span><span class="sxs-lookup"><span data-stu-id="01010-148">(A Component element can have an arbitrary number of ComponentFile elements that can be specified for each component.) This ComponentFile element has the following attributes:</span></span>

-   <span data-ttu-id="01010-149">path = "c: \\ вритердата \\ мифилешере"</span><span class="sxs-lookup"><span data-stu-id="01010-149">path="c:\\writerData\\myFilesHere"</span></span>
-   <span data-ttu-id="01010-150">filespec = " \* "</span><span class="sxs-lookup"><span data-stu-id="01010-150">filespec="\*"</span></span>
-   <span data-ttu-id="01010-151">recursive = "нет"</span><span class="sxs-lookup"><span data-stu-id="01010-151">recursive="no"</span></span>

<span data-ttu-id="01010-152">Хотя модуль записи тестов проверяет поведение инициатора запроса, он не проверяет, что файл конфигурации всегда поддерживает документированную семантику для модуля записи.</span><span class="sxs-lookup"><span data-stu-id="01010-152">Although the Test Writer verifies requester behavior, it does not verify that the configuration file always maintains the documented semantics for a writer.</span></span> <span data-ttu-id="01010-153">Существует много операций, которые не должны делать хорошо работающий модуль записи (например, отчет о том же файле в нескольких компонентах), а также автор XML-файла конфигурации для поддержки этой семантики.</span><span class="sxs-lookup"><span data-stu-id="01010-153">There are many operations that a well-behaved writer should not do (such as report the same file in multiple components), and it is up to the author of the XML configuration file to maintain these semantics.</span></span>

## <a name="configuring-writer-attributes"></a><span data-ttu-id="01010-154">Настройка атрибутов модуля записи</span><span class="sxs-lookup"><span data-stu-id="01010-154">Configuring Writer Attributes</span></span>

<span data-ttu-id="01010-155">Корневой элемент Тествритер содержит атрибуты, определяющие различные режимы работы модуля записи.</span><span class="sxs-lookup"><span data-stu-id="01010-155">The TestWriter root element contains attributes that determine various behaviors of the writer.</span></span> <span data-ttu-id="01010-156">Ниже перечислены некоторые из вариантов поведения, которые можно изменить.</span><span class="sxs-lookup"><span data-stu-id="01010-156">Some of the behaviors that can be altered are the following:</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="01010-157">attribute</span><span class="sxs-lookup"><span data-stu-id="01010-157">Attribute</span></span></th>
<th><span data-ttu-id="01010-158">Описание</span><span class="sxs-lookup"><span data-stu-id="01010-158">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="01010-159"><span id="verbosity"></span><span id="VERBOSITY"></span>уровень детализации</span><span class="sxs-lookup"><span data-stu-id="01010-159"><span id="verbosity"></span><span id="VERBOSITY"></span>verbosity</span></span><br/></td>
<td><span data-ttu-id="01010-160">Модуль записи выводит состояние на консоль при получении событий и их обработке.</span><span class="sxs-lookup"><span data-stu-id="01010-160">The writer prints the status to the console as it receives events and processes them.</span></span> <span data-ttu-id="01010-161">Уровень детализации определяется атрибутом детализации.</span><span class="sxs-lookup"><span data-stu-id="01010-161">The level of verbosity displayed is specified by the verbosity attribute.</span></span> <span data-ttu-id="01010-162">Вы можете выбрать один из трех уровней детализации:</span><span class="sxs-lookup"><span data-stu-id="01010-162">There are three verbosity levels to choose from:</span></span><br/> <dl> <span data-ttu-id="01010-163"><dt><span id="low"></span><span id="LOW"></span>низшую</dt> </span><span class="sxs-lookup"><span data-stu-id="01010-163"><dt><span id="low"></span><span id="LOW"></span>low</dt> </span></span><dd> <span data-ttu-id="01010-164">Будут распечатаны только сбои в модуле записи или неправильное поведение инициатора запроса.</span><span class="sxs-lookup"><span data-stu-id="01010-164">Only failures in the writer or incorrect behavior from the requester will be printed.</span></span><br/> </dd> <span data-ttu-id="01010-165"><dt><span id="medium"></span><span id="MEDIUM"></span>высокое</dt> </span><span class="sxs-lookup"><span data-stu-id="01010-165"><dt><span id="medium"></span><span id="MEDIUM"></span>medium</dt> </span></span><dd> <span data-ttu-id="01010-166">В дополнение к дополнительным сведениям о состоянии, например при получении событий, печатается все на низком уровне детализации.</span><span class="sxs-lookup"><span data-stu-id="01010-166">Everything at the low verbosity level is printed in addition to extra status information such as when events are received.</span></span> <span data-ttu-id="01010-167">Это уровень, заданный по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="01010-167">This is the default level.</span></span><br/> </dd> <span data-ttu-id="01010-168"><dt><span id="high"></span><span id="HIGH"></span>высоком</dt> </span><span class="sxs-lookup"><span data-stu-id="01010-168"><dt><span id="high"></span><span id="HIGH"></span>high</dt> </span></span><dd> <span data-ttu-id="01010-169">Отображается подробная информация о состоянии операции модуля записи.</span><span class="sxs-lookup"><span data-stu-id="01010-169">Detailed status information about the operation of the writer is reported.</span></span><br/> </dd> </dl></td>
</tr>
<tr class="even">
<td><span data-ttu-id="01010-170"><span id="deleteFiles"></span><span id="deletefiles"></span><span id="DELETEFILES"></span>делетефилес</span><span class="sxs-lookup"><span data-stu-id="01010-170"><span id="deleteFiles"></span><span id="deletefiles"></span><span id="DELETEFILES"></span>deleteFiles</span></span><br/></td>
<td><span data-ttu-id="01010-171">Чтобы выполнить дополнительные проверки, присвойте этому атрибуту значение &quot; Да, &quot; чтобы модуль записи удалил все файлы сразу после создания теневой копии тома.</span><span class="sxs-lookup"><span data-stu-id="01010-171">To perform extra verification, set this attribute to &quot;yes&quot; to cause the writer to delete all of its files immediately after the volume shadow copy is created.</span></span> <span data-ttu-id="01010-172">Затем инициатор запроса должен скопировать файлы из теневой копии, так как они больше не существуют на исходном томе.</span><span class="sxs-lookup"><span data-stu-id="01010-172">The requester must then copy the files from the shadow copy, because they no longer exist on the original volume.</span></span> <br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="01010-173">В случае выдам Writer файлы удаляются из исходного расположения после выдам, но до создания теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-173">In the case of spit writers, the files are deleted from the original location after the spit but before the shadow copy is created.</span></span> <span data-ttu-id="01010-174">После создания теневой копии файлы удаляются из каталога выдам.</span><span class="sxs-lookup"><span data-stu-id="01010-174">After the shadow copy is created, the files are deleted from the spit directory.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="01010-175"><span id="deletePartialFiles"></span><span id="deletepartialfiles"></span><span id="DELETEPARTIALFILES"></span>делетепартиалфилес</span><span class="sxs-lookup"><span data-stu-id="01010-175"><span id="deletePartialFiles"></span><span id="deletepartialfiles"></span><span id="DELETEPARTIALFILES"></span>deletePartialFiles</span></span><br/></td>
<td><span data-ttu-id="01010-176">Чтобы удалить частичные файлы, установите для этого атрибута значение &quot; Да &quot; .</span><span class="sxs-lookup"><span data-stu-id="01010-176">To delete partial files, set this attribute to &quot;yes&quot;.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="01010-177"><span id="deleteDifferencedFiles"></span><span id="deletedifferencedfiles"></span><span id="DELETEDIFFERENCEDFILES"></span>делетедифференцедфилес</span><span class="sxs-lookup"><span data-stu-id="01010-177"><span id="deleteDifferencedFiles"></span><span id="deletedifferencedfiles"></span><span id="DELETEDIFFERENCEDFILES"></span>deleteDifferencedFiles</span></span><br/></td>
<td><span data-ttu-id="01010-178">Чтобы удалить файлы с разной разницей, установите для этого атрибута значение &quot; Да &quot; .</span><span class="sxs-lookup"><span data-stu-id="01010-178">To delete differenced files, set this attribute to &quot;yes&quot;.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="01010-179"><span id="checkIncludes"></span><span id="checkincludes"></span><span id="CHECKINCLUDES"></span>чеккинклудес</span><span class="sxs-lookup"><span data-stu-id="01010-179"><span id="checkIncludes"></span><span id="checkincludes"></span><span id="CHECKINCLUDES"></span>checkIncludes</span></span><br/></td>
<td><span data-ttu-id="01010-180">Задайте для этого атрибута значение &quot; Да, &quot; чтобы модуль записи проводил проверку на то, что все резервные копии файлов были восстановлены в соответствующее расположение и что файл не был поврежден.</span><span class="sxs-lookup"><span data-stu-id="01010-180">Set this attribute to &quot;yes&quot; to cause the writer to check that every file that has been backed up has been restored to an appropriate location, and that the file has not been corrupted.</span></span> <span data-ttu-id="01010-181">Частичные файлы и файлы различий также обрабатываются правильно.</span><span class="sxs-lookup"><span data-stu-id="01010-181">Partial files and differenced files are also correctly handled.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="01010-182"><span id="checkExcludes"></span><span id="checkexcludes"></span><span id="CHECKEXCLUDES"></span>чеккексклудес</span><span class="sxs-lookup"><span data-stu-id="01010-182"><span id="checkExcludes"></span><span id="checkexcludes"></span><span id="CHECKEXCLUDES"></span>checkExcludes</span></span><br/></td>
<td><span data-ttu-id="01010-183">Задайте для этого атрибута значение &quot; Да, &quot; чтобы модуль записи не восстановил файлы, соответствующие спецификации файла в списке исключений.</span><span class="sxs-lookup"><span data-stu-id="01010-183">Set this attribute to &quot;yes&quot; to cause the writer to check that files matching a file specification in the exclude list are not restored.</span></span> <span data-ttu-id="01010-184">Чтобы эта функция правильно функционировала, перед восстановлением необходимо очистить каталоги восстановления.</span><span class="sxs-lookup"><span data-stu-id="01010-184">For this to function correctly, the restore directories must be emptied prior to restore.</span></span><br/></td>
</tr>
</tbody>
</table>



 

## <a name="specifying-alternate-location-mappings"></a><span data-ttu-id="01010-185">Указание сопоставлений альтернативного расположения</span><span class="sxs-lookup"><span data-stu-id="01010-185">Specifying Alternate Location Mappings</span></span>

<span data-ttu-id="01010-186">Сопоставление альтернативного расположения задает расположение для восстановления в, если метод Restore является VSS \_ WRE \_ RESTORE \_ в \_ другое \_ расположение или если не удается выполнить нормальное восстановление компонента.</span><span class="sxs-lookup"><span data-stu-id="01010-186">An alternate location mapping specifies a location to restore to if the restore method is VSS\_WRE\_RESTORE\_TO\_ALTERNATE\_LOCATION or if normal restore of a component fails.</span></span> <span data-ttu-id="01010-187">Модуль записи может сообщить о сопоставлении альтернативного расположения инициатору запроса с помощью метода [**ивссексаминевритерметадата:: жеталтернателокатионмаппинг**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping) .</span><span class="sxs-lookup"><span data-stu-id="01010-187">A writer can report its alternate location mappings to the requester by using the [**IVssExamineWriterMetadata::GetAlternateLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping) method.</span></span> <span data-ttu-id="01010-188">Можно добавить сопоставления альтернативного расположения в файл конфигурации модуля записи теста, добавив подэлементы Алтернателокатионмаппинг в элемент Ресторемесод.</span><span class="sxs-lookup"><span data-stu-id="01010-188">You can add alternate location mappings to the Test Writer configuration file by adding AlternateLocationMapping subelements to the RestoreMethod element.</span></span>

<span data-ttu-id="01010-189">Следующий элемент Ресторемесод содержит вложенный элемент Алтернателокатионмаппинг.</span><span class="sxs-lookup"><span data-stu-id="01010-189">The following RestoreMethod element contains a AlternateLocationMapping subelement.</span></span>

``` syntax
<RestoreMethod method="RESTORE_IF_CAN_REPLACE"
              writerRestore="always"
              rebootRequired="no">
    <AlternateLocationMapping path="c:\files"
                              filespec="*.txt"
                              recursive="no"
                              alternatePath="c:\altfiles"/>
</RestoreMethod>
```

<span data-ttu-id="01010-190">Этот пример указывает, что инициатор запроса должен сначала попытаться восстановить все файлы, соответствующие c: \\ Files \\ \* . txt, в \\ каталог c: Files.</span><span class="sxs-lookup"><span data-stu-id="01010-190">This example specifies that the requester should first attempt to restore all of the files matching c:\\files\\\*.txt to the c:\\files directory.</span></span> <span data-ttu-id="01010-191">Если один из этих файлов не может быть заменен, инициатор запроса должен восстановить все файлы в каталоге c: \\ алтфилес.</span><span class="sxs-lookup"><span data-stu-id="01010-191">If one of these files cannot be replaced, the requester should restore all the files to the c:\\altfiles directory instead.</span></span> <span data-ttu-id="01010-192">Инициатор запроса должен сохранить сопоставление этого альтернативного расположения с помощью метода [**ивссбаккупкомпонентс:: аддалтернативелокатионмаппинг**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping) .</span><span class="sxs-lookup"><span data-stu-id="01010-192">The requester should save this alternate location mapping by using the [**IVssBackupComponents::AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping) method.</span></span> <span data-ttu-id="01010-193">Если модуль записи тестов настроен для проверки того, были ли файлы восстановлены, он также проверяет, вызвал ли инициатор запроса **аддалтернативелокатионмаппинг**.</span><span class="sxs-lookup"><span data-stu-id="01010-193">If the Test Writer is configured to check whether files have been restored, it will also check whether the requester has called **AddAlternativeLocationMapping**.</span></span>

## <a name="specifying-files-to-be-excluded"></a><span data-ttu-id="01010-194">Указание исключаемых файлов</span><span class="sxs-lookup"><span data-stu-id="01010-194">Specifying Files to Be Excluded</span></span>

<span data-ttu-id="01010-195">Каждый модуль записи может указывать список спецификаций файлов, указывающих файлы, которые должны быть исключены из резервной копии для инициатора запроса.</span><span class="sxs-lookup"><span data-stu-id="01010-195">Every writer can specify a list of file specifications that specify files for the requester to exclude from backup.</span></span> <span data-ttu-id="01010-196">Эти спецификации файлов можно добавить в файл конфигурации модуля записи теста, добавив подэлементы Ексклудефиле в корневой элемент Тествритер.</span><span class="sxs-lookup"><span data-stu-id="01010-196">You can add these file specifications to the Test Writer configuration file by adding ExcludeFile subelements to the TestWriter root element.</span></span>

<span data-ttu-id="01010-197">Ниже приведен пример вложенного элемента Ексклудефиле, который исключает все файлы в каталоге C: \\ Files, соответствующие c: \\ temp \* . \*</span><span class="sxs-lookup"><span data-stu-id="01010-197">Here is an example of an ExcludeFile subelement that excludes all files in the C:\\files directory that match C:\\temp\*.\*.</span></span>

``` syntax
    <ExcludeFile path="c:\files" 
                 filespec="temp*.*" 
                 recursive="no"/>
```

## <a name="backing-up-spit-writers"></a><span data-ttu-id="01010-198">Резервное копирование модулей записи выдам</span><span class="sxs-lookup"><span data-stu-id="01010-198">Backing Up Spit Writers</span></span>

<span data-ttu-id="01010-199">Многие авторы работают как «выдам Writers».</span><span class="sxs-lookup"><span data-stu-id="01010-199">Many writers act as "spit writers."</span></span> <span data-ttu-id="01010-200">Модуль записи выдам создает промежуточные файлы или файлы выдам, основываясь на исходном наборе файлов, и помещает файлы выдам в альтернативное расположение во время резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="01010-200">A spit writer creates intermediate files, or "spit files," based on an original set of files, and puts the spit files in an alternate location at backup time.</span></span> <span data-ttu-id="01010-201">Модуль записи использует метод [**ивссвмфиледеск:: жеталтернателокатион**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) , чтобы уведомить инициатор запроса о том, что эти файлы должны быть восстановлены из альтернативного расположения.</span><span class="sxs-lookup"><span data-stu-id="01010-201">The writer uses the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method to notify the requester that it should back these files up from the alternate location.</span></span> <span data-ttu-id="01010-202">Однако эти файлы по-прежнему должны быть восстановлены до активного расположения исходных файлов.</span><span class="sxs-lookup"><span data-stu-id="01010-202">However, these files should still be restored to the active location of the original files.</span></span> <span data-ttu-id="01010-203">Модуль записи теста можно настроить так, чтобы он работал как модуль записи выдам для конкретной спецификации файла.</span><span class="sxs-lookup"><span data-stu-id="01010-203">The Test Writer can be configured to act as a spit writer for a particular file specification.</span></span>

<span data-ttu-id="01010-204">Следующий элемент Компонентфиле содержит атрибут Алтернатепас:</span><span class="sxs-lookup"><span data-stu-id="01010-204">The following ComponentFile element contains an alternatePath attribute:</span></span>

``` syntax
    <ComponentFile path="c:\files"
                   filespec="*.txt"
                   recursive="no"
                   alternatePath="c:\files\spit" />
```

<span data-ttu-id="01010-205">В этом примере модуль записи тестов настраивается на копирование всех файлов, соответствующих c: \\ Files \\ \* . txt, в каталог c: Files \\ \\ выдам непосредственно перед созданием теневой копии тома.</span><span class="sxs-lookup"><span data-stu-id="01010-205">This example configures the Test Writer to copy all files matching c:\\files\\\*.txt to the c:\\files\\spit directory immediately before the volume shadow copy is created.</span></span> <span data-ttu-id="01010-206">Инициатор запроса должен создать резервную копию файлов из каталога c: \\ Files \\ выдам.</span><span class="sxs-lookup"><span data-stu-id="01010-206">The requester must back up the files from the c:\\files\\spit directory.</span></span> <span data-ttu-id="01010-207">Если модуль записи тестов настроен на удаление файлов, он удаляет исходные файлы перед созданием теневой копии, поэтому они не отображаются в каталоге c: \\ Files на томе теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-207">If the Test Writer is configured to delete files, it deletes the original files before the shadow copy is created, so they do not appear in the c:\\files directory on the shadow copy volume.</span></span> <span data-ttu-id="01010-208">В этом случае файлы в c: \\ Files \\ выдам удаляются после создания теневой копии, поэтому их необходимо архивировать из каталога c: \\ Files \\ выдам на томе теневого копирования.</span><span class="sxs-lookup"><span data-stu-id="01010-208">In this case, the files in c:\\files\\spit are deleted after the shadow copy is created, so they must be backed up from the c:\\files\\spit directory on the shadow copy volume.</span></span>

## <a name="reporting-component-dependencies"></a><span data-ttu-id="01010-209">Зависимости компонентов отчетности</span><span class="sxs-lookup"><span data-stu-id="01010-209">Reporting Component Dependencies</span></span>

<span data-ttu-id="01010-210">Модули записи могут указывать зависимость между локальным компонентом и компонентом, который существует в другом модуле записи.</span><span class="sxs-lookup"><span data-stu-id="01010-210">Writers can specify a dependency between a local component and a component that exists in another writer.</span></span> <span data-ttu-id="01010-211">Эти зависимости передаются инициатору запроса с помощью [**ивссвмкомпонент:: dependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span><span class="sxs-lookup"><span data-stu-id="01010-211">These dependencies are reported to the requester using [**IVssWMComponent::GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span></span> <span data-ttu-id="01010-212">Модуль записи теста может быть настроен для передачи этих зависимостей путем добавления одного или нескольких вложенных элементов зависимостей в элемент Component.</span><span class="sxs-lookup"><span data-stu-id="01010-212">The Test Writer can be configured to report these dependencies by adding one or more Dependency subelements to the Component element.</span></span>

<span data-ttu-id="01010-213">Следующий элемент component содержит вложенный элемент dependency:</span><span class="sxs-lookup"><span data-stu-id="01010-213">The following Component element contains a Dependency subelement:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
         <Dependency writerId="<GUID of target writer>"
                     logicalPath="ComponentPath"
                     componentName="Writer2Component" />
    </Component>
```

<span data-ttu-id="01010-214">Зависимость указывается как атрибуты элемента зависимости.</span><span class="sxs-lookup"><span data-stu-id="01010-214">The dependency is specified as attributes of the Dependency element.</span></span> <span data-ttu-id="01010-215">Вритерид — это идентификатор класса модуля записи, содержащего целевой объект зависимости, Логикалпас — это логический путь к компоненту в этом модуле записи, а componentName — имя компонента.</span><span class="sxs-lookup"><span data-stu-id="01010-215">writerId is the class id of the writer containing the target of the dependency, logicalPath is the logical path to the component in that writer, and componentName is the name of the component.</span></span> <span data-ttu-id="01010-216">В этом случае, если инициатор запроса создает резервную копию "Вритеркомпонент" в текущем модуле записи, он должен также создать резервную копию компонента "Компонентпас \\ Writer2Component" в целевом модуле записи.</span><span class="sxs-lookup"><span data-stu-id="01010-216">In this case, if the requester is backing up "WriterComponent" in the current writer, it should also back up the component "ComponentPath\\Writer2Component" in the target writer.</span></span>

> [!Note]  
> <span data-ttu-id="01010-217">Модуль записи тестов не проверяет соответствие зависимостей.</span><span class="sxs-lookup"><span data-stu-id="01010-217">The Test Writer performs no checking to ensure dependencies are honored.</span></span>

 

## <a name="failing-events"></a><span data-ttu-id="01010-218">События с ошибками</span><span class="sxs-lookup"><span data-stu-id="01010-218">Failing Events</span></span>

<span data-ttu-id="01010-219">Модуль записи теста можно настроить для отказа от обычных событий, получаемых средством записи.</span><span class="sxs-lookup"><span data-stu-id="01010-219">The Test Writer can be configured to fail any of the normal events that a writer receives.</span></span> <span data-ttu-id="01010-220">Ниже приведены эти события.</span><span class="sxs-lookup"><span data-stu-id="01010-220">These events are as follows:</span></span>



| <span data-ttu-id="01010-221">Событие</span><span class="sxs-lookup"><span data-stu-id="01010-221">Event</span></span>                                                                                                                                    | <span data-ttu-id="01010-222">Описание</span><span class="sxs-lookup"><span data-stu-id="01010-222">Description</span></span>                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="01010-223"><span id="Identify"></span><span id="identify"></span><span id="IDENTIFY"></span>Указывается</span><span class="sxs-lookup"><span data-stu-id="01010-223"><span id="Identify"></span><span id="identify"></span><span id="IDENTIFY"></span>Identify</span></span><br/>                                     | <span data-ttu-id="01010-224">Получен как ответ на вызов [**ивссбаккупкомпонентс:: гасервритерметадата**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) .</span><span class="sxs-lookup"><span data-stu-id="01010-224">Received as a response to a [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) call.</span></span> <span data-ttu-id="01010-225">Ошибка здесь приведет к тому, что средство записи не будет сообщено.</span><span class="sxs-lookup"><span data-stu-id="01010-225">Failure here will cause the writer to not be reported.</span></span><br/>                                                                 |
| <span data-ttu-id="01010-226"><span id="PrepareForBackup"></span><span id="prepareforbackup"></span><span id="PREPAREFORBACKUP"></span>PrepareForBackup</span><span class="sxs-lookup"><span data-stu-id="01010-226"><span id="PrepareForBackup"></span><span id="prepareforbackup"></span><span id="PREPAREFORBACKUP"></span>PrepareForBackup</span></span><br/>     | <span data-ttu-id="01010-227">Получен как ответ на запрашивающий вызов [**ивссбаккупкомпонентс::P репарефорбаккуп**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup).</span><span class="sxs-lookup"><span data-stu-id="01010-227">Received as a response to the requester calling [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup).</span></span><br/>                                                                                                                 |
| <span data-ttu-id="01010-228"><span id="PrepareForSnapsot"></span><span id="prepareforsnapsot"></span><span id="PREPAREFORSNAPSOT"></span>препарефорснапсот</span><span class="sxs-lookup"><span data-stu-id="01010-228"><span id="PrepareForSnapsot"></span><span id="prepareforsnapsot"></span><span id="PREPAREFORSNAPSOT"></span>PrepareForSnapsot</span></span><br/> | <span data-ttu-id="01010-229">Получается, когда инициатор запроса вызывает [**ивссбаккупкомпонентс::D оснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), но до создания теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-229">Received when the requester calls [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), but before the shadow copy is created.</span></span><br/>                                                                                              |
| <span data-ttu-id="01010-230"><span id="Freeze"></span><span id="freeze"></span><span id="FREEZE"></span>Фиксировать</span><span class="sxs-lookup"><span data-stu-id="01010-230"><span id="Freeze"></span><span id="freeze"></span><span id="FREEZE"></span>Freeze</span></span><br/>                                             | <span data-ttu-id="01010-231">Получено сразу после [*препарефорснапшот*](vssgloss-p.md), но по-прежнему до создания теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-231">Received immediately after [*PrepareForSnapshot*](vssgloss-p.md), but still before the shadow copy is created.</span></span><br/>                                                                                                      |
| <span data-ttu-id="01010-232"><span id="Thaw"></span><span id="thaw"></span><span id="THAW"></span>Постепенно</span><span class="sxs-lookup"><span data-stu-id="01010-232"><span id="Thaw"></span><span id="thaw"></span><span id="THAW"></span>Thaw</span></span><br/>                                                     | <span data-ttu-id="01010-233">Получено после завершения создания теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-233">Received after the shadow copy creation is finished.</span></span><br/>                                                                                                                                                                                                     |
| <span data-ttu-id="01010-234"><span id="PostSnapshot"></span><span id="postsnapshot"></span><span id="POSTSNAPSHOT"></span>Моментальный снимок</span><span class="sxs-lookup"><span data-stu-id="01010-234"><span id="PostSnapshot"></span><span id="postsnapshot"></span><span id="POSTSNAPSHOT"></span>PostSnapshot</span></span><br/>                     | <span data-ttu-id="01010-235">Получено после разморозки, но до завершения [**ивссбаккупкомпонентс::D оснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) .</span><span class="sxs-lookup"><span data-stu-id="01010-235">Received after Thaw completes, but before [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) completes.</span></span><br/>                                                                                                                   |
| <span data-ttu-id="01010-236"><span id="Abort"></span><span id="abort"></span><span id="ABORT"></span>Рвал</span><span class="sxs-lookup"><span data-stu-id="01010-236"><span id="Abort"></span><span id="abort"></span><span id="ABORT"></span>Abort</span></span><br/>                                                 | <span data-ttu-id="01010-237">Получается, если истекает слишком много времени между [*закреплением*](vssgloss-f.md) и [*размораживанием*](vssgloss-t.md) или если инициатор запроса вызывает [**ивссбаккупкомпонентс:: абортбаккуп**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span><span class="sxs-lookup"><span data-stu-id="01010-237">Received if too much time elapses between [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) or if the requester calls [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span></span><br/> |
| <span data-ttu-id="01010-238"><span id="BackupComplete"></span><span id="backupcomplete"></span><span id="BACKUPCOMPLETE"></span>баккупкомплете</span><span class="sxs-lookup"><span data-stu-id="01010-238"><span id="BackupComplete"></span><span id="backupcomplete"></span><span id="BACKUPCOMPLETE"></span>BackupComplete</span></span><br/>             | <span data-ttu-id="01010-239">Получено при завершении запроса.</span><span class="sxs-lookup"><span data-stu-id="01010-239">Received when the requester exits.</span></span> <span data-ttu-id="01010-240">Здесь ошибки никогда не будут передаваться.</span><span class="sxs-lookup"><span data-stu-id="01010-240">Failures here will never be reported.</span></span><br/>                                                                                                                                                                                 |
| <span data-ttu-id="01010-241"><span id="PreRestore"></span><span id="prerestore"></span><span id="PRERESTORE"></span>Предвосстановление</span><span class="sxs-lookup"><span data-stu-id="01010-241"><span id="PreRestore"></span><span id="prerestore"></span><span id="PRERESTORE"></span>PreRestore</span></span><br/>                             | <span data-ttu-id="01010-242">Получается, когда инициатор запроса вызывает [**ивссбаккупкомпонентс::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span><span class="sxs-lookup"><span data-stu-id="01010-242">Received when the requester calls [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span></span><br/>                                                                                                                                           |
| <span data-ttu-id="01010-243"><span id="PostRestore"></span><span id="postrestore"></span><span id="POSTRESTORE"></span>Восстановление после восстановления</span><span class="sxs-lookup"><span data-stu-id="01010-243"><span id="PostRestore"></span><span id="postrestore"></span><span id="POSTRESTORE"></span>PostRestore</span></span><br/>                         | <span data-ttu-id="01010-244">Получается, когда инициатор запроса вызывает [**ивссбаккупкомпонентс::P остресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="01010-244">Received when the requester calls [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span><br/>                                                                                                                                         |



 

<span data-ttu-id="01010-245">Эти сбои настраиваются путем добавления одного или нескольких вложенных элементов Фаилевент в корневой элемент Тествритер.</span><span class="sxs-lookup"><span data-stu-id="01010-245">These failures are configured by adding one or more FailEvent subelements to the TestWriter root element.</span></span> <span data-ttu-id="01010-246">Существует два класса сбоев, которые можно задать: повторяемые и неповторяемые.</span><span class="sxs-lookup"><span data-stu-id="01010-246">There are two classes of failures that can be set: retryable and non-retryable.</span></span> <span data-ttu-id="01010-247">Повторяемые ошибки — это ошибки, которые могут исчезнуть при повторном выполнении всего процесса резервного копирования, в то время как ошибки, не допускающие повторения, вряд ли исчезнут.</span><span class="sxs-lookup"><span data-stu-id="01010-247">Retryable errors are errors that may go away if the entire backup process is retried, while non-retryable errors are unlikely to disappear.</span></span> <span data-ttu-id="01010-248">Тип сбоя для события выбирается на основе атрибута повторяемости.</span><span class="sxs-lookup"><span data-stu-id="01010-248">The failure type for the event is chosen based on the retryable attribute.</span></span>

<span data-ttu-id="01010-249">Ниже приведен пример простой неповторяемой ошибки:</span><span class="sxs-lookup"><span data-stu-id="01010-249">Here is an example of a basic non-retryable failure:</span></span>

``` syntax
    <FailEvent writerEvent="Freeze"
               retryable="no" />
```

<span data-ttu-id="01010-250">Этот пример приведет к сбою модуля записи во время события [*Freeze*](vssgloss-f.md) .</span><span class="sxs-lookup"><span data-stu-id="01010-250">This example will cause the writer to fail during the [*Freeze*](vssgloss-f.md) event.</span></span> <span data-ttu-id="01010-251">[**Ивссбаккупкомпонентс:: гасервритерстатус**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) сообщит о сбое модуля записи в VSS \_ E \_ вритереррор \_ нонретрябле.</span><span class="sxs-lookup"><span data-stu-id="01010-251">[**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) will report the writer failure to be VSS\_E\_WRITERERROR\_NONRETRYABLE.</span></span>

<span data-ttu-id="01010-252">Ниже приведен пример базовой ошибки повторяемости.</span><span class="sxs-lookup"><span data-stu-id="01010-252">Here is an example of a basic retryable error:</span></span>

``` syntax
    <FailEvent writerEvent="Freeze"
               retryable="yes"
               numFailures="2"/>
```

<span data-ttu-id="01010-253">В этом примере средство записи будет завершаться сбоем первыми двумя раз, когда он получает событие [*Freeze*](vssgloss-f.md) .</span><span class="sxs-lookup"><span data-stu-id="01010-253">This example will cause the writer to fail the first two times it receives a [*Freeze*](vssgloss-f.md) event.</span></span> <span data-ttu-id="01010-254">Через первые два раза модуль записи всегда будет выполнен.</span><span class="sxs-lookup"><span data-stu-id="01010-254">After the first two times, the writer will always succeed.</span></span> <span data-ttu-id="01010-255">Ошибка модуля записи, полученная через [**гасервритерстатус**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) , будет возможной случайным кодом ошибки.</span><span class="sxs-lookup"><span data-stu-id="01010-255">The writer failure reported through [**GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) will be a random retryable error code.</span></span>

## <a name="declaring-supported-backup-types"></a><span data-ttu-id="01010-256">Объявление поддерживаемых типов резервного копирования</span><span class="sxs-lookup"><span data-stu-id="01010-256">Declaring Supported Backup Types</span></span>

<span data-ttu-id="01010-257">Модули записи обмениваются данными о том, какие типы резервного копирования поддерживаются посредством вызова [**ивссексаминевритерметадата:: жетбаккупсчема**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)инициатора запроса.</span><span class="sxs-lookup"><span data-stu-id="01010-257">Writers communicate what backup types are supported through the requester's calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="01010-258">Корневой элемент Тествритер содержит атрибуты для каждого типа резервной копии для указания поддержки.</span><span class="sxs-lookup"><span data-stu-id="01010-258">The TestWriter root element contains attributes for each backup type to indicate support.</span></span> <span data-ttu-id="01010-259">Эти атрибуты: Суппортскопи, Суппортсдифферентиал, Суппортсинкрементал и Суппортслог.</span><span class="sxs-lookup"><span data-stu-id="01010-259">These attributes are supportsCopy, supportsDifferential, supportsIncremental, and supportsLog.</span></span> <span data-ttu-id="01010-260">Чтобы указать поддержку для конкретного типа резервного копирования, установите для соответствующего атрибута значение "Да".</span><span class="sxs-lookup"><span data-stu-id="01010-260">To indicate support for a particular backup type, set the corresponding attribute to "yes".</span></span>

<span data-ttu-id="01010-261">Если инициатор запроса задает для типа резервного копирования тип резервного копирования, который не поддерживается модулем записи, то модуль записи запустит этот факт во время [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), но в противном случае будет работать правильно.</span><span class="sxs-lookup"><span data-stu-id="01010-261">If the requester sets the backup type to a backup type that is not supported by the writer, the writer will note this fact during [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), but otherwise work correctly.</span></span>

## <a name="indicating-the-file-backup-type"></a><span data-ttu-id="01010-262">Указание типа резервной копии файла</span><span class="sxs-lookup"><span data-stu-id="01010-262">Indicating the File Backup Type</span></span>

<span data-ttu-id="01010-263">Метод [**ивссвмфиледеск:: жетбаккуптипемаск**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) возвращает битовую маску для инициатора запроса, указывающего, как следует выполнять резервное копирование файла.</span><span class="sxs-lookup"><span data-stu-id="01010-263">The [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) method returns a bitmask to the requester indicating how a file should be backed up.</span></span> <span data-ttu-id="01010-264">Это указывает, является ли файл обязательным или необязательным во время конкретных типов резервного копирования, а также необходимость создания теневой копии во время конкретных типов резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="01010-264">This will indicate whether a file is required or not required during specific types of backup, and also whether a shadow copy is required during specific types of backup.</span></span> <span data-ttu-id="01010-265">Типы резервных копий в этой битовой маске более подробно описаны в [роли "инициатор запроса документа" при резервном копировании сложных хранилищ](requestor-role-in-backing-up-complex-stores.md).</span><span class="sxs-lookup"><span data-stu-id="01010-265">The backup types in this bitmask are explained at greater length in the document [Requester Role in Backing Up Complex Stores](requestor-role-in-backing-up-complex-stores.md).</span></span>

<span data-ttu-id="01010-266">В модуле записи теста элементы этой битовой маски задаются путем установки атрибутов в каждом элементе Компонентфиле.</span><span class="sxs-lookup"><span data-stu-id="01010-266">In the Test Writer, the elements of this bitmask are specified by setting attributes in each ComponentFile element.</span></span> <span data-ttu-id="01010-267">Атрибуты Фуллбаккупрекуиред, Диффбаккупрекуиред, Инкбаккупрекуиред и Логбаккупрекуиред указывают, когда требуется создать резервную копию файла.</span><span class="sxs-lookup"><span data-stu-id="01010-267">The fullBackupRequired, diffBackupRequired, incBackupRequired, and logBackupRequired attributes specify when a file needs to be backed up.</span></span> <span data-ttu-id="01010-268">Атрибуты Фуллснапшотрекуиред, Диффснапшотрекуиред, Инкснапшотрекуиред и Логснапшотрекуиред указывают, когда необходимо создать резервную копию файла из теневой копии тома (и никогда не от исходного тома).</span><span class="sxs-lookup"><span data-stu-id="01010-268">The fullSnapshotRequired, diffSnapshotRequired, incSnapshotRequired, and logSnapshotRequired attributes specify when a file must be backed up from a shadow copy of a volume (and never from the original volume).</span></span> <span data-ttu-id="01010-269">По умолчанию для всех этих значений задано значение "Да", указывающее, что файл должен всегда быть резервным и должен быть создан из теневой копии тома.</span><span class="sxs-lookup"><span data-stu-id="01010-269">The default for all of these values is "yes", indicating that a file must always be backed up and must be backed up from a shadow copy of a volume.</span></span>

## <a name="adding-partial-files"></a><span data-ttu-id="01010-270">Добавление частичных файлов</span><span class="sxs-lookup"><span data-stu-id="01010-270">Adding Partial Files</span></span>

<span data-ttu-id="01010-271">Во время обработки [**доснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset)средство записи имеет шанс добавить к каждому компоненту частичные файлы.</span><span class="sxs-lookup"><span data-stu-id="01010-271">During the processing of [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), a writer has a chance to add partial files to each component.</span></span> <span data-ttu-id="01010-272">Эти частичные файлы выводятся с помощью [**ивсскомпонент:: жетпартиалфиле**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="01010-272">These partial files are reported using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="01010-273">Модуль записи теста можно настроить для добавления частичных файлов, указав подэлементы Партиалфиле в элементе Component.</span><span class="sxs-lookup"><span data-stu-id="01010-273">The Test Writer can be configured to add partial files by specifying PartialFile subelements in a Component element.</span></span>

<span data-ttu-id="01010-274">Ниже приведен пример элемента Component с двумя подэлементами Партиалфиле:</span><span class="sxs-lookup"><span data-stu-id="01010-274">Here is an example of a Component element that has two PartialFile subelements:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
        <ComponentFile path="c:\files"
                       filespec="*.txt"
                       recursive="no"/>
        <PartialFile path="c:\files"
                     filespec="partial.txt"
                     ranges="0:5,100:20" />
        <PartialFile path="c:\files2"
                     filespec="partial.txt"
                     ranges="0:5,100:20" />
    </Component>
```

<span data-ttu-id="01010-275">Таким образом можно указать только частичные файлы, которые частично соответствуют существующему Компонентфиле (как в первом частичном файле в примере) или новые частичные файлы на том же томе, что и существующий Компонентфиле (как во втором частичном файле).</span><span class="sxs-lookup"><span data-stu-id="01010-275">Only partial files that partially match an existing ComponentFile (as in the first partial file in the example) or new partial files that are on the same volume as an existing ComponentFile (as in the second partial file) should be specified this way.</span></span> <span data-ttu-id="01010-276">Для этого компонента инициатор запроса должен полностью создать резервную копию всех файлов, соответствующих c: \\ Files \\ \* . txt, за исключением partial.txt.</span><span class="sxs-lookup"><span data-stu-id="01010-276">For this component, the requester must fully back up all files matching c:\\files\\\*.txt except for partial.txt.</span></span> <span data-ttu-id="01010-277">Затем инициатор запроса должен выполнить резервное копирование указанных диапазонов (где диапазон — это смещение, за которым следует длина) для файлов c: \\ files \\partial.txt и c: \\ files2 \\partial.txt.</span><span class="sxs-lookup"><span data-stu-id="01010-277">The requester must then back up the specified ranges (where a range is an offset followed by a length) for the files c:\\files\\partial.txt and c:\\files2\\partial.txt.</span></span>

<span data-ttu-id="01010-278">Если модуль записи настроен для проверки восстановления файлов, при восстановлении будут проверяться только резервные диапазоны частичного файла.</span><span class="sxs-lookup"><span data-stu-id="01010-278">If the writer is configured to check file restores, only the backed-up ranges of the partial file will be checked at restore time.</span></span> <span data-ttu-id="01010-279">Изменения, внесенные в другие части файла, будут незамеченными.</span><span class="sxs-lookup"><span data-stu-id="01010-279">Modifications to other portions of the file will go unnoticed.</span></span> <span data-ttu-id="01010-280">Если задан атрибут Делетепартиалфилес корневого элемента Тествритер, частичные файлы удаляются из исходного тома сразу после создания теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-280">If the deletePartialFiles attribute of the TestWriter root element is set, the partial files are deleted from the original volume immediately after the shadow copy is created.</span></span>

## <a name="adding-differenced-files"></a><span data-ttu-id="01010-281">Добавление различных файлов</span><span class="sxs-lookup"><span data-stu-id="01010-281">Adding Differenced Files</span></span>

<span data-ttu-id="01010-282">Во время обработки [**доснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset)модуль записи может добавлять в каждый компонент файлы с различиями.</span><span class="sxs-lookup"><span data-stu-id="01010-282">During the processing of [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), a writer can add differenced files to each component.</span></span> <span data-ttu-id="01010-283">Эти файлы выводятся с помощью [**ивсскомпонент:: жетдифференцедфиле**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="01010-283">These differenced files are reported using [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="01010-284">Модуль записи теста можно настроить для добавления различных файлов, указав подэлементы Дифференцедфиле в элементе Component.</span><span class="sxs-lookup"><span data-stu-id="01010-284">The Test Writer can be configured to add differenced files by specifying DifferencedFile subelements in a Component element.</span></span>

<span data-ttu-id="01010-285">Ниже приведен пример элемента Component с двумя подэлементами Дифференцедфиле:</span><span class="sxs-lookup"><span data-stu-id="01010-285">Here is an example of a Component element that has two DifferencedFile subelements:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
        <ComponentFile path="c:\files"
                       filespec="*.txt"
                       recursive="no"/>
        <DifferencedFile path="c:\files"
                         filespec="*.txt"
                         year="2007"
                         month="1"
                         day="22"
                         hour="12"
                         minute="44"
                         second="17" />
        <DifferencedFile path="c:\files2"
                         filespec="*.txt"
                         year="2007"
                         month="1"
                         day="22"
                         hour="12"
                         minute="44"
                         second="17" />
    </Component>
```

<span data-ttu-id="01010-286">В отличие от частичных файлов, файлы различий не должны частично соответствовать спецификации Компонентфиле.</span><span class="sxs-lookup"><span data-stu-id="01010-286">Unlike partial files, differenced files should never partially match a ComponentFile specification.</span></span> <span data-ttu-id="01010-287">Спецификация файла в элементе Дифференцедфиле должна либо точно соответствовать Компонентфиле (как в примере выше), либо не должна соответствовать этому файлу, но находиться на томе, на который ссылается Компонентфиле (как во втором файле различий).</span><span class="sxs-lookup"><span data-stu-id="01010-287">The file specification in a DifferencedFile element should either exactly match a ComponentFile (as in the first differenced file in the example) or it should not match it at all, but be on a volume that is referenced in a ComponentFile (as in the second differenced file).</span></span> <span data-ttu-id="01010-288">Значения даты и времени должны относиться к локальному часовому поясу, но они будут преобразованы в формат GMT перед передачей инициатору запроса.</span><span class="sxs-lookup"><span data-stu-id="01010-288">The date and time values should be relative to the local time zone, but they will be converted to GMT before being reported to the requester.</span></span> <span data-ttu-id="01010-289">В этом примере \\ выполняется резервное копирование только файлов c: Files \\ \* . txt или c: \\ files2 \\ \* . txt, которые были изменены с момента выпуска 1/22/2003:12:44:17.</span><span class="sxs-lookup"><span data-stu-id="01010-289">In the example, only files matching c:\\files\\\*.txt or c:\\files2\\\*.txt that have been modified since 1/22/2003:12:44:17 will be backed up.</span></span>

<span data-ttu-id="01010-290">Если модуль записи тестов настроен для проверки восстановления файлов, то восстановление будет проверяться только для измененных файлов.</span><span class="sxs-lookup"><span data-stu-id="01010-290">If the Test Writer is configured to check file restores, only the modified files will be checked for restore.</span></span> <span data-ttu-id="01010-291">Если задан атрибут Делетедифференцедфилес корневого элемента Тествритер, то файлы с отличиями удаляются из исходного тома сразу после создания теневой копии.</span><span class="sxs-lookup"><span data-stu-id="01010-291">If the deleteDifferencedFiles attribute of the TestWriter root element is set, the differenced files are deleted from the original volume immediately after the shadow copy is created.</span></span>

## <a name="new-targets"></a><span data-ttu-id="01010-292">Новые цели</span><span class="sxs-lookup"><span data-stu-id="01010-292">New Targets</span></span>

<span data-ttu-id="01010-293">Определенные модули записи позволяют инициатору запроса сообщить о том, что было выбрано новое расположение для восстановления определенных файлов.</span><span class="sxs-lookup"><span data-stu-id="01010-293">Certain writers allow the requester to inform them that a new location has been chosen to restore certain files to.</span></span> <span data-ttu-id="01010-294">Модуль записи указывает, что этот режим поддерживается как часть битовой маски, возвращаемой [**ивссексаминевритерметадата:: жетбаккупсчема**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="01010-294">The writer indicates that it supports this mode as part of the bitmask returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="01010-295">По умолчанию модуль записи теста всегда поддерживает новые целевые объекты.</span><span class="sxs-lookup"><span data-stu-id="01010-295">By default, the Test Writer always supports new targets.</span></span> <span data-ttu-id="01010-296">Эту поддержку можно отключить, присвоив атрибуту Суппортсневтаржет в корневом элементе Тествритер значение "No".</span><span class="sxs-lookup"><span data-stu-id="01010-296">This support can be disabled by setting the supportsNewTarget attribute in the TestWriter root element to "no".</span></span>

<span data-ttu-id="01010-297">Если модуль записи поддерживает новые целевые объекты, инициатор запроса может уведомить средство записи о новых целевых объектах, вызвав [**ивссбаккупкомпонентс:: аддневтаржет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget).</span><span class="sxs-lookup"><span data-stu-id="01010-297">If a writer supports new targets, the requester can inform the writer of new targets by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget).</span></span> <span data-ttu-id="01010-298">Затем модуль записи проверяет новое целевое расположение для проверки восстановления, а не исходного расположения.</span><span class="sxs-lookup"><span data-stu-id="01010-298">The writer will then check the new target location to verify restore rather than the original location.</span></span>

## <a name="more-information"></a><span data-ttu-id="01010-299">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="01010-299">More Information</span></span>

<span data-ttu-id="01010-300">Модуль записи теста поддерживает больше параметров конфигурации, которые не описаны здесь.</span><span class="sxs-lookup"><span data-stu-id="01010-300">The Test Writer supports more configuration options that are not described here.</span></span> <span data-ttu-id="01010-301">Полная схема для всех возможностей настройки модуля записи теста указана в swriter.xml в `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` (для 64-разрядной версии Windows) и `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` (для 32-разрядной версии Windows).</span><span class="sxs-lookup"><span data-stu-id="01010-301">The full schema for all of the configuration capabilities of the Test Writer is specified in swriter.xml in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` (for 64-bit Windows) and `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` (for 32-bit Windows).</span></span> <span data-ttu-id="01010-302">Этот файл содержит схему XML, которая полностью описывает все элементы и атрибуты, составляющие файл конфигурации.</span><span class="sxs-lookup"><span data-stu-id="01010-302">This file contains an XML schema that completely describes all of the elements and attributes that make up a configuration file.</span></span> <span data-ttu-id="01010-303">Каждый элемент и каждый атрибут в этом файле снабжен комментариями с описанием, которое документирует использование этого элемента или атрибута.</span><span class="sxs-lookup"><span data-stu-id="01010-303">Each element and each attribute in this file is commented with a description that documents that element's or attribute's use.</span></span>

 

 




