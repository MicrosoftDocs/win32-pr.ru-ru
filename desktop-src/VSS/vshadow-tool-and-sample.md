---
description: Вшадов — это программа командной строки, которую можно использовать для создания и управления теневыми копиями томов.
ms.assetid: 19109f92-b9da-4df7-8628-374e37a3f624
title: Средство Вшадов и пример
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 306d759d10875b03cb0d2e4e2064a85614400ff5240800da3fc4c1ce94add8c7
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118998074"
---
# <a name="vshadow-tool-and-sample"></a>Средство Вшадов и пример

Вшадов — это программа командной строки, которую можно использовать для создания и управления теневыми копиями томов.

> [!Note]  
> вшадов входит в комплект Microsoft Windows Software Development Kit (SDK) для Windows Vista и более поздних версий. пакет SDK для VSS 7,2 включает версию вшадов, которая работает только на Windows Server 2003. сведения о скачивании Windows SDK и пакета SDK для VSS 7,2 см. в разделе [служба теневого копирования томов](volume-shadow-copy-service-portal.md).

 

Средство Вшадов использует параметры командной строки и необязательные флаги для задания выполняемой работы. При использовании без параметров командной строки команда Вшадов создает новый набор теневых копий.

Команды Вшадов выполняют следующие операции:

-   [Создание набора теневых копий](#creating-a-shadow-copy-set)
-   [Импорт набора теневых копий](#importing-a-shadow-copy-set)
-   [Запрос свойств теневого копирования](#querying-shadow-copy-properties)
-   [Удаление теневых копий](#deleting-shadow-copies)
-   [Разбиение набора теневых копий](#breaking-a-shadow-copy-set)
-   [Разбиение набора теневых копий с помощью метода Бреакснапшотсетекс](#breaking-a-shadow-copy-set-using-the-breaksnapshotsetex-method)
-   [Локальное предоставление теневой копии](#exposing-a-shadow-copy-locally)
-   [Удаленное предоставление теневой копии](#exposing-a-shadow-copy-remotely)
-   [Вывод сведений о состоянии и метаданных модуля записи](#listing-writer-status-and-metadata)
-   [Выполнение операций восстановления](#performing-restore-operations)
-   [Возврат к предыдущей теневой копии](#reverting-to-a-previous-shadow-copy)
-   [Повторная синхронизация LUN](#resynchronizing-luns)

## <a name="creating-a-shadow-copy-set"></a>Создание набора теневых копий

**вшадов** \[ Оптионалфлагс \] *волумелист*

Эта команда создает новый набор теневых копий.

*Волумелист* — это список имен томов. Вшадов создает одну теневую копию для каждого тома в списке. При необходимости имя тома можно завершить с помощью обратной косой черты ( \\ ). Например, C: и C: \\ являются допустимыми именами томов. Можно также указать имена подключенных папок (например, C: \\ директоринаме) или идентификатор GUID тома (например, \\ \\ ? \\ Том {edbed95e-7e8d-11d8-9d01-505054503030}).

*Оптионалфлагс* — это битовая маска необязательных значений флагов из следующей таблицы.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Необязательное значение флага</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="-ad"></span><span id="-AD"></span><strong>-AD</strong><br/></td>
<td>Этот необязательный флаг указывает разностное аппаратное теневое копирование. Этот флаг и флаг <strong>-AP</strong> являются взаимоисключающими.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td><span id="-ap"></span><span id="-AP"></span><strong>-AP</strong><br/></td>
<td>Этот необязательный флаг указывает на плекс аппаратных теневых копий. Этот флаг и флаг <strong>-AD</strong> являются взаимоисключающими.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span id="_-bc_File.xml"></span><span id="_-bc_file.xml"></span><span id="_-BC_FILE.XML"></span><strong></strong> <strong>-BC =</strong><em>файл</em> <strong>.xml</strong><br/></td>
<td>Этот необязательный флаг задает непереносимые теневые копии и сохраняет документ компонентов резервного копирования в указанном файле. Этот файл можно использовать в последующей операции восстановления. Этот флаг и флаг <strong>-t</strong> являются взаимоисключающими.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td><span id="-exec_Command"></span><span id="-exec_command"></span><span id="-EXEC_COMMAND"></span><strong>-exec =</strong>-<em>команда</em><br/></td>
<td>Этот необязательный флаг выполняет команду или сценарий после создания теневых копий, но перед завершением работы средства Вшадов. <em>Команда</em> может указать исполняемую команду оболочки или CMD-файл. Если он указывает команду оболочки, параметры команды указывать нельзя.<br/>
<blockquote>
[!Note]<br />
По соображениям безопасности и для простоты реализации необязательный флаг <strong>-exec</strong> не принимает параметры, передаваемые команде или сценарию. Вся строка, передаваемая в необязательный флаг <strong>-exec</strong> , рассматривается как отдельный файл CMD или exe. Дополнительные сведения об этом ограничении см. в разделе исходный код Вшадов.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span id="-forcerevert"></span><span id="-FORCEREVERT"></span><strong>-форцереверт</strong><br/></td>
<td>Этот необязательный флаг указывает, что операция теневого копирования должна быть выполнена только в том случае, если все подписи диска можно восстановить.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/> <strong>Windows Server 2003:</strong> Не поддерживается.<br/></td>
</tr>
<tr class="even">
<td><span id="-mask"></span><span id="-MASK"></span><strong>-Mask</strong><br/></td>
<td>Этот необязательный флаг указывает, что при разрыве набора теневых копий LUN теневой копии должен быть замаскирован с компьютера.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/> <strong>Windows Server 2003:</strong> Не поддерживается.<br/></td>
</tr>
<tr class="odd">
<td><span id="-nar"></span><span id="-NAR"></span><strong>-нар</strong><br/></td>
<td>Этот необязательный флаг указывает теневые копии без автоматического восстановления. Дополнительные сведения об этом параметре см. в документации по флагу VSS_VOLSNAP_ATTR_NO_AUTORECOVERY перечисления <a href="/windows/desktop/api/Vss/ne-vss-vss_volume_snapshot_attributes"><strong>_VSS_VOLUME_SNAPSHOT_ATTRIBUTES</strong></a> .<br/></td>
</tr>
<tr class="even">
<td><span id="-norevert"></span><span id="-NOREVERT"></span><strong>-невозвратно</strong><br/></td>
<td>Этот необязательный флаг указывает, что не следует выполнять откат для подписей дисков.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/> <strong>Windows Server 2003:</strong> Не поддерживается.<br/></td>
</tr>
<tr class="odd">
<td><span id="-nw"></span><span id="-NW"></span><strong>-NW</strong><br/></td>
<td>Этот необязательный флаг указывает теневые копии без участия в модулях записи. Дополнительные сведения о теневых копиях без участия в записи см. в разделе <a href="shadow-copy-creation-details.md">сведения о создании теневого копирования</a>. Этот флаг и флаги <strong>-Wi</strong> и <strong>-WX</strong> являются взаимоисключающими.<br/></td>
</tr>
<tr class="even">
<td><span id="-p"></span><span id="-P"></span><strong>-p</strong><br/></td>
<td>Этот необязательный флаг указывает <a href="vssgloss-p.md"><em>постоянные теневые копии</em></a>.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span id="-rw"></span><span id="-RW"></span><strong>-RW</strong><br/></td>
<td>Этот необязательный флаг указывает, что LUN теневой копии должен быть доступен для чтения и записи, если набор теневых копий поврежден.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/> <strong>Windows Server 2003:</strong> Не поддерживается.<br/></td>
</tr>
<tr class="even">
<td><span id="-scsf"></span><span id="-SCSF"></span><strong>-сксф</strong><br/></td>
<td>Этот необязательный флаг указывает <a href="vssgloss-c.md"><em>теневые копии, доступные для клиента</em></a>.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span id="-script_File.cmd"></span><span id="-script_file.cmd"></span><span id="-SCRIPT_FILE.CMD"></span><strong>-script =</strong><em>File</em><strong>. cmd</strong><br/></td>
<td>Этот необязательный флаг создает CMD-файл, содержащий переменные среды, связанные с созданными теневыми копиями, такие как идентификаторы теневых копий и идентификаторы наборов теневых копий.<br/></td>
</tr>
<tr class="even">
<td><span id="-t_File.xml"></span><span id="-t_file.xml"></span><span id="-T_FILE.XML"></span><strong>-t =</strong><em>файл</em> <strong>.xml</strong><br/></td>
<td>Этот необязательный флаг определяет переносимые теневые копии и сохраняет документ компонентов резервного копирования в файл, указанный параметром <em>File.xml</em> . Этот файл можно использовать в последующих операциях импорта и (или) восстановления. Этот флаг и флаг <strong>-BC</strong> являются взаимоисключающими.<br/> <strong>Windows server 2003, выпуск Standard и Windows server 2003, Web Edition:</strong> Перепереносимые теневые копии не поддерживаются. все выпуски Windows Server 2003 с пакетом обновления 1 (SP1) поддерживают переносимые теневые копии.<br/></td>
</tr>
<tr class="odd">
<td><span id="-tr"></span><span id="-TR"></span><strong>-TR</strong><br/></td>
<td>Этот необязательный флаг указывает, что во время создания теневой копии необходимо принудительно выполнить восстановление TxF.<br/>
<blockquote>
[!Note]<br />
этот флаг поддерживается только в операционных системах Windows server.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td><span id="-tracing"></span><span id="-TRACING"></span><strong>-Трассировка</strong><br/></td>
<td>Этот необязательный флаг создает подробный вывод, который можно использовать для устранения неполадок.<br/></td>
</tr>
<tr class="odd">
<td><span id="-wait"></span><span id="-WAIT"></span><strong>-Wait</strong><br/></td>
<td>Этот необязательный флаг заставляет средство Вшадов ждать подтверждения пользователя перед выходом.<br/></td>
</tr>
<tr class="even">
<td><span id="-wi_Writer"></span><span id="-wi_writer"></span><span id="-WI_WRITER"></span><strong>-Wi =</strong><em>модуль записи</em><br/></td>
<td>Этот необязательный флаг проверяет, включен ли указанный модуль записи или компонент в теневую копию. <em>Модуль записи</em> может указывать путь к компоненту, имя модуля записи, идентификатор модуля записи или идентификатор экземпляра модуля записи. Этот флаг и флаг <strong>-NW</strong> являются взаимоисключающими.<br/></td>
</tr>
<tr class="odd">
<td><span id="-wx_Writer"></span><span id="-wx_writer"></span><span id="-WX_WRITER"></span><strong>-WX =</strong><em>модуль записи</em><br/></td>
<td>Этот необязательный флаг проверяет, исключен ли указанный модуль записи или компонент из теневой копии. <em>Модуль записи</em> может указывать путь к компоненту, имя модуля записи, идентификатор модуля записи или идентификатор экземпляра модуля записи. Этот флаг и флаг <strong>-NW</strong> являются взаимоисключающими.<br/></td>
</tr>
</tbody>
</table>



 

## <a name="importing-a-shadow-copy-set"></a>Импорт набора теневых копий

**вшадов** \[ Оптионалфлагс \] **-i =**_файл_ *_.xml_*

Параметр командной строки **-i** импортирует транспортный набор теневых копий.

> [!Note]  
> этот параметр командной строки поддерживается только в операционных системах Windows server.

 

Файл *File.xml* должен быть файлом документа компонентов резервного копирования для переносимого набора теневых копий, который был создан с помощью необязательного флага **-t** или **-BC** .

Набор теневых копий является [*постоянной теневой копией*](vssgloss-p.md) , если он был создан с помощью необязательного флага **-p** . Если транспортный набор теневых копий является непостоянным, он появляется в течение короткого промежутка времени во время выполнения команды создания теневого копирования и автоматически удаляется при возврате команды. Вы можете импортировать непостоянные теневые копии только во время создания теневого копирования, создав набор теневых копий с помощью флага **-exec** , чтобы выполнить cmd-файл, вызывающий вшадов **– i**.

Параметр командной строки **-i** не может использоваться вместе с другими параметрами командной строки.

*Оптионалфлагс* — это битовая маска необязательных значений флагов из следующей таблицы.



| Необязательное значение флага                                                                                                            | Описание                                                                                                                                                                                                                                                                  |
|--------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="-exec_Command"></span><span id="-exec_command"></span><span id="-EXEC_COMMAND"></span>**-exec =**-_команда_<br/> | Этот необязательный флаг выполняет команду или сценарий после импорта теневых копий, но до завершения работы средства Вшадов. *Команда* может указать исполняемую команду оболочки или CMD-файл. Если он указывает команду оболочки, параметры команды указывать нельзя.<br/> |
| <span id="-tracing"></span><span id="-TRACING"></span>**-Трассировка**<br/>                                                  | Этот необязательный флаг создает подробный вывод, который можно использовать для устранения неполадок.<br/>                                                                                                                                                                                 |
| <span id="-wait"></span><span id="-WAIT"></span>**-Wait**<br/>                                                           | Этот необязательный флаг заставляет средство Вшадов ждать подтверждения пользователя перед выходом.<br/>                                                                                                                                                                          |



 

## <a name="querying-shadow-copy-properties"></a>Запрос свойств теневого копирования

**вшадов** **-q**

**вшадов** **-ККС =**_шадовкописетид_

**вшадов** **-s =**_шадовкопид_

Параметр командной строки **-q** содержит свойства всех теневых копий на компьютере.

Параметр командной строки **-ККС** перечисляет свойства всех теневых копий в наборе теневых копий, идентификатор которых указан в параметре *шадовкописетид*.

Параметр командной строки **-s** перечисляет свойства теневой копии, идентификатор которой указан в *шадовкопид*.

Эти параметры командной строки используют сочетание [**ивссбаккупкомпонентс:: Query**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-query) и [**Ивссбаккупкомпонентс:: жетснапшотпропертиес**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties) для получения свойств заданного набора теневых копий.

Параметры командной строки **-q**, **-ККС** и **-s** являются взаимоисключающими и не могут быть объединены с другими параметрами командной строки.

## <a name="deleting-shadow-copies"></a>Удаление теневых копий

**вшадов** **-Da**

**вшадов** **-Do**

**вшадов** **-DX =**_шадовкописетид_

**вшадов** **-DS =**_шадовкопид_

Команда **-Da** удаляет все теневые копии на компьютере.

> [!Note]  
> Параметр командной строки **-Da** требует подтверждения пользователя.

 

Параметр командной строки **-Do** удаляет старую теневую копию на компьютере.

Параметр командной строки **-DX** удаляет все теневые копии в наборе теневых копий, идентификатор которых указан в параметре *шадовкописетид*.

Параметр командной строки **-DS** удаляет теневую копию, идентификатор которой указан в *шадовкопид*.

Эти параметры командной строки предназначены для использования только с [*постоянными теневыми копиями*](vssgloss-p.md) . Непостоянные теневые копии не нужно удалять явным образом, так как они автоматически удаляются при выходе из команды Вшадов-создания.

Параметры командной строки **-Da**, **-Do**, **-DX** и **-DS** являются взаимоисключающими и не могут быть объединены с другими параметрами командной строки.

## <a name="breaking-a-shadow-copy-set"></a>Разбиение набора теневых копий

**вшадов** **-b =**_шадовкописетид_

**вшадов** **-BW =**_шадовкописетид_

Параметр командной строки **-b =**_шадовкописетид_ преобразует каждую теневую копию в наборе теневых копий в изолированный том только для чтения.

Параметр командной строки **-BW =**_шадовкописетид_ преобразует каждую теневую копию в наборе теневых копий в изолированный доступный для записи том.

> [!Note]  
> параметры командной строки **-b** и **-bw** поддерживаются только в операционных системах Windows server.

 

Сведения о разбиении набора теневых копий см. в разделе [критическое копирование теневых копий](breaking-shadow-copies.md).

После разрыва набора теневых копий набор теневых копий и отдельные теневые копии больше не существуют и не могут управляться с помощью команд VSS.

Набор теневых копий является постоянным, если он был создан с помощью необязательного флага **-p** . Если транспортный набор теневых копий является непостоянным, он появляется в течение короткого промежутка времени во время выполнения команды создания теневого копирования и автоматически удаляется при возврате команды. Неустойчивые наборы теневых копий можно прерывать только во время создания теневого копирования, создав набор теневых копий с помощью флага **-exec** , чтобы выполнить cmd-файл, вызывающий **вшадов** **– b** или **вшадов** **-BW**.

Параметры командной строки **-b** и **-BW** являются взаимоисключающими и не могут быть объединены с другими параметрами командной строки.

## <a name="breaking-a-shadow-copy-set-using-the-breaksnapshotsetex-method"></a>Разбиение набора теневых копий с помощью метода Бреакснапшотсетекс

**вшадов** **— BEX**

Параметр командной строки **-BEX** прерывает набор теневых копий в соответствии с параметрами, заданными флагами необязательных параметров **-Mask**, **-RW**, **-форцереверт** и **-не revert** . Этот параметр командной строки похож на параметры командной строки **-b** и **-BW** . Параметр командной строки **-BEX** использует метод [**IVssBackupComponentsEx2:: бреакснапшотсетекс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-breaksnapshotsetex) , тогда как параметры командной строки **-b** и **-BW** используют метод [**ивссбаккупкомпонентс:: бреакснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-breaksnapshotset) .

Сведения о разбиении набора теневых копий см. в разделе [критическое копирование теневых копий](breaking-shadow-copies.md).

> [!Note]  
> параметр командной строки **-bex** поддерживается только в операционных системах Windows server.

 

**вшадов** **-BEX** **-Mask**

Флаг **-Mask** указывает, что LUN теневой копии будет маскироваться от узла. Если указан флаг **-Mask** , то флаги **-RW**, **-форцереверт** и **-** не могут быть указаны.

**вшадов** **-BEX** **-RW**

Флаг **-RW** указывает, что LUN теневой копии будет предоставляться узлу в качестве тома для чтения и записи.

**вшадов** **-BEX** **-форцереверт**

Флаг **-форцереверт** указывает, что идентификаторы дисков всех LUN теневой копии будут возвращены к исходным LUN. Однако если в системе имеются какие либо исходные LUN, операция завершится ошибкой и ни один из идентификаторов не будет отменен. Этот флаг и флаг **-без изменений** являются взаимоисключающими.

**вшадов** **-BEX** **-revert**

Флаг **-with revert** указывает, что ни один из идентификаторов диска LUN теневой копии не будет возвращен. Этот флаг и флаг **-форцереверт** являются взаимоисключающими.

## <a name="exposing-a-shadow-copy-locally"></a>Локальное предоставление теневой копии

**вшадов** **-El =**_шадовкопид_*_,_*_локалемптидиректори_

 **вшадов** **-El =**_шадовкопид_*_,_*_унуседдривелеттер_

Параметр командной строки **-El** назначает подключенной папке или букве диска постоянную теневую копию. Обратите внимание, что содержимое тома будет доступно только для чтения, пока вы не назовите **вшадов** **-BW** , чтобы нарушить набор теневых копий.

> [!Note]  
> Непостоянные теневые копии и [*теневые копии, доступные для клиента*](vssgloss-c.md) , нельзя предоставлять локально.

 

Например, если {edbed95e-7e8d-11d8-9d01-505054503030} является идентификатором GUID существующей сохраняемой теневой копии, а X: является неиспользуемой буквой диска, следующая команда предоставляет теневую копию в разделе X:

**вшадов** **-El = {edbed95e-7e8d-11d8-9d01-505054503030}, x:**

В следующем примере показано, как предоставить ту же теневую копию в подключенной папке C: \\ шадовкопиес \\ June23:

**mkdir c: \\ шадовкопиес \\ June23**

**вшадов** **-El = {edbed95e-7e8d-11d8-9d01-505054503030}, c: \\ шадовкопиес \\ June23**

Параметр командной строки **-El** не может использоваться вместе с другими параметрами командной строки.

## <a name="exposing-a-shadow-copy-remotely"></a>Удаленное предоставление теневой копии

**вшадов** **-ER =**_шадовкопид_*_,_*_унуседшаренаме_

 **вшадов** **-ER =**_шадовкопид_*_,_*_унуседшаренаме_*_,_*_пасфромрутоншадов_

Параметр командной строки **-ER** назначает имя общего ресурса только для чтения корневому каталогу (или подкаталогу) из теневой копии. Обратите внимание, что содержимое общей папки будет доступно только для чтения, пока вы не назовите **вшадов** **-BW** , чтобы нарушить набор теневых копий.

> [!Note]  
> [*Доступ к теневым копиям, доступным для клиента*](vssgloss-c.md) , нельзя предоставить удаленно.

 

Например, если {edbed95e-7e8d-11d8-9d01-505054503030} является идентификатором GUID существующей сохраняемой теневой копии, а общий ресурс \_ 123 является неиспользуемым именем общей папки, то следующая команда предоставляет теневую копию в разделе share \_ 123:

**вшадов** **-ER = {edbed95e-7e8d-11d8-9d01-505054503030}, общий ресурс \_ 123**

В следующем примере показано, как предоставить только поддерево (с именем "папка1 \\ folder2") той же теневой копии в той же общей папке:

**вшадов** **-ER = {edbed95e-7e8d-11d8-9d01-505054503030}, Share \_ 123, папка1 \\ folder2**

Параметр командной строки **-ER** не может использоваться вместе с другими параметрами командной строки.

## <a name="listing-writer-status-and-metadata"></a>Вывод сведений о состоянии и метаданных модуля записи

**вшадов** **-WS**

**вшадов** **-WM**

**вшадов** **— wm2**

**вшадов** **— WM3**

Параметр командной строки **-WS** перечисляет модули записи VSS, которые в данный момент выполняются на компьютере, и описывает их состояние. Эта команда эквивалентна команде [vssadmin list writers](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc754968(v=ws.11)) . Существует шесть возможных значений состояния: стабильный, сбойный, неизвестный, ожидание фиксации, замораживания и ожидание завершения.

Параметр командной строки **-WM** содержит сводку метаданных модуля записи, включая затронутые тома.

Параметр командной строки **-wm2** перечисляет все метаданные модуля записи.

Параметр командной строки **-WM3** перечисляет все метаданные модуля записи в формате RAW XML.

**Windows Vista и Windows Server 2003:** Параметр командной строки **-WM3** не поддерживается.

Эти сведения можно использовать, чтобы определить, какие тома следует включить в набор теневых копий томов.

> [!Note]  
> Если состояние модуля записи является стабильным или ожидает завершения, модуль записи может считаться в стабильном состоянии, готовым к следующей резервной копии.

 

Параметры командной строки **-WS**, **-WM**, **-wm2** и **-WM3** являются взаимоисключающими и не могут использоваться вместе с другими параметрами командной строки.

## <a name="performing-restore-operations"></a>Выполнение операций восстановления

**вшадов** \[ Оптионалфлагс \] **-r =**_файл_ *_.xml_*

**вшадов** \[ Оптионалфлагс \] **-RS =**_файл_ *_.xml_*

Параметр командной строки **-r** выполняет операцию восстановления.

Параметр командной строки **-RS** выполняет имитацию операции восстановления.

Файл *File.xml* должен быть файлом документа компонентов резервного копирования для набора теневых копий, который был создан с помощью необязательного флага **-t** или **-BC** .

Параметры командной строки **-r** и **-RS** являются взаимоисключающими и не могут использоваться совместно с другими параметрами командной строки.

*Оптионалфлагс* — это битовая маска необязательных значений флагов из следующей таблицы.



| Необязательное значение флага                                                                                                            | Описание                                                                                                                                                                                                                                                                        |
|--------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="-wi_Writer"></span><span id="-wi_writer"></span><span id="-WI_WRITER"></span>**-Wi =**_модуль записи_<br/>             | Этот необязательный флаг проверяет, включен ли указанный модуль записи или компонент в восстановление. *Модуль записи* может указывать путь к компоненту, имя модуля записи, идентификатор модуля записи или идентификатор экземпляра модуля записи.<br/>                                                                                    |
| <span id="-wx_Writer"></span><span id="-wx_writer"></span><span id="-WX_WRITER"></span>**-WX =**_модуль записи_<br/>             | Этот необязательный флаг проверяет, исключен ли указанный модуль записи или компонент из восстановления. *Модуль записи* может указывать путь к компоненту, имя модуля записи, идентификатор модуля записи или идентификатор экземпляра модуля записи.<br/>                                                                                  |
| <span id="-exec_Command"></span><span id="-exec_command"></span><span id="-EXEC_COMMAND"></span>**-exec =**-_команда_<br/> | Этот необязательный флаг выполняет команду или скрипт между событиями перед восстановлением и после восстановления, которые отправляются модулям записи. *Команда* может указать исполняемую команду оболочки или CMD-файл. Если он указывает команду оболочки, параметры команды указывать нельзя.<br/> |
| <span id="-tracing"></span><span id="-TRACING"></span>**-Трассировка**<br/>                                                  | Этот необязательный флаг создает подробный вывод, который можно использовать для устранения неполадок.<br/>                                                                                                                                                                                       |



 

## <a name="reverting-to-a-previous-shadow-copy"></a>Возврат к предыдущей теневой копии

**вшадов** **-revert =**_шадовкопид_

> [!Note]  
> этот параметр командной строки поддерживается только в операционных системах Windows server.

 

**Windows server 2008 и Windows server 2003:** Не поддерживается.

Параметр командной строки **-revert** восстанавливает из тома предыдущую теневую копию, идентификатор которой указан в *шадовкопид*.

Параметр командной строки **-revert** не может использоваться вместе с другими параметрами командной строки.

## <a name="resynchronizing-luns"></a>Повторная синхронизация LUN

**вшадов** **-аддресинк =**_шадовкопид_ **— Повторная синхронизация =**_бкдфиленаме_ \[ оптионалресинкфлагс\]

**вшадов** **-аддресинк =**_шадовкопид_*_,_* *таржетволумедривелеттер* **-Resync =**_бкдфиленаме_ \[ оптионалресинкфлагс\]

Параметр командной строки **-аддресинк** указывает тома, которые будут включаться в операцию повторной синхронизации LUN. Параметр *шадовкопид* задает идентификатор теневой копии. Необязательный параметр *таржетволумедривелеттер* указывает том назначения, куда будут копироваться содержимое тома теневой копии.

Параметр командной строки **-Resync** инициирует операцию повторной синхронизации LUN. После завершения операции сигнатура каждого целевого LUN будет совпадать с подписью LUN целевого тома. Параметр *бкдфиленаме* указывает имя XML-файла, содержащего документ компонента резервного копирования.

> [!Note]  
> параметры командной строки **-аддресинк** и **-resync** поддерживаются только в операционных системах Windows server.

 

**Windows server 2008 и Windows server 2003:** Не поддерживается.

*Оптионалресинкфлагс* — это битовая маска необязательных значений флагов из следующей таблицы.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Необязательное значение флага</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="-revertsig"></span><span id="-REVERTSIG"></span><strong>-ревертсиг</strong><br/></td>
<td>Этот необязательный флаг указывает, что после завершения операции подпись каждого целевого LUN должна быть идентична исходной LUN, использованной для создания теневой копии, а не LUN целевого тома.<br/>
<blockquote>
[!Note]<br />
флаг <strong>-ревертсиг</strong> поддерживается только в операционных системах сервера Windows.
</blockquote>
<br/> <strong>Windows server 2008 и Windows server 2003:</strong> Не поддерживается.<br/></td>
</tr>
<tr class="even">
<td><span id="-novolcheck"></span><span id="-NOVOLCHECK"></span><strong>-новолчекк</strong><br/></td>
<td>Этот необязательный флаг указывает, что службе VSS не следует проверять наличие невыбранных томов, которые будут перезаписаны операцией повторной синхронизации LUN.<br/>
<blockquote>
[!Note]<br />
флаг <strong>-новолчекк</strong> поддерживается только в операционных системах сервера Windows.
</blockquote>
<br/> <strong>Windows server 2008 и Windows server 2003:</strong> Не поддерживается.<br/></td>
</tr>
</tbody>
</table>



 

 

 
