---
description: После завершения теневой копии наиболее важный механизм получения доступа к содержащимся в нем данным файлов заключается в использовании объекта устройства теневой копии.
ms.assetid: 21efdbd6-a487-4e6f-8e3c-b9224bcf92da
title: Доступ инициатора запроса к теневым скопированным данным
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 779e3947adff28c8f3190026921c398677afc7efaa484903bf165250f41bc191
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119767704"
---
# <a name="requester-access-to-shadow-copied-data"></a>Доступ инициатора запроса к теневым скопированным данным

После завершения теневой копии наиболее важный механизм получения доступа к содержащимся в нем данным файлов заключается в использовании [*объекта устройства*](vssgloss-d.md)теневой копии.

Элемент **m \_ пвсзснапшотдевицеобжект** структуры [**\_ снимков \_ VSS**](/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop) представляет собой строку, содержащую объект устройства теневого копирования тома. Инициатор запроса может получить объект **\_ \_ prop snapshot** теневого копирования тома VSS, если он знает **\_ идентификатор VSS** тома (идентифицирует идентификатор GUID) и передает его в [**ивссбаккупкомпонентс:: жетснапшотпропертиес**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties).

Инициатор запроса может также получить сведения о свойстве теневого копирования с помощью элемента **obj. Snap** структуры [**\_ объекта \_ VSS**](/windows/desktop/api/Vss/ns-vss-vss_object_prop) (структура snapshot, которая представляет собой структуру [**\_ снимков \_ VSS**](/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop) ), полученную с помощью [**ивссенумобжект**](/windows/desktop/api/Vss/nn-vss-ivssenumobject) , чтобы выполнить итерацию по списку объектов, возвращенных вызовом [**ивссбаккупкомпонентс:: Query**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-query).

Объект устройства должен интерпретироваться как корень тома, скопированного с помощью теневого копирования. По этой причине объект устройства не содержит обратную косую черту (" \\ ").

Пути к теневому скопированному тому получаются путем замены корня исходного пути на объект устройства. Например, по указанному пути к исходному тому "C: \\ Database \\ \* . mdb" и экземпляру [**снаппроп \_ снимка \_ VSS**](/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop) можно получить путь к теневому скопированному тому путем сцепления снаппропм \_ пвсзшадов копидевицеобжект, " \\ " и " \\ Database \\ \* . mdb".

Наборы файлов VSS могут содержать подстановочные знаки в дескрипторах файлов, поэтому получение полного списка файлов в теневой копии, управляемой компонентом, может потребовать использования таких методов, как **финдфилефирст**, **финдфилефирстекс** и **FindNextFile**.

 

 



