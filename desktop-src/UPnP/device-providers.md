---
title: Поставщики устройств
description: Поставщики устройств — это зарегистрированные объекты, которые компьютер запускает при каждом запуске системы.
ms.assetid: 80c08993-0a8b-4ee9-93cd-bcc3c00e843b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 67fac270342830045fc3bac9f0573f283d87dc6a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104133986"
---
# <a name="device-providers"></a>Поставщики устройств

Поставщики устройств — это зарегистрированные объекты, которые компьютер запускает при каждом запуске системы. Поставщики устройств регистрируют и отменяют регистрацию выполняющихся устройств на узле устройства в ответ на определенное событие. Эти устройства — это устройства, которые автоматически запускаются во время запуска системы. По соображениям безопасности поставщик устройства обычно работает как [Локальная](/windows/desktop/Services/localservice-account)служба, а не [LocalSystem](/windows/desktop/Services/localsystem-account).

Поставщики устройств можно использовать для переходных устройств. Поставщики устройств также можно использовать для моста устройств на просылаемые носители. Например, периферийное устройство, например проигрыватель цифрового музыкального проигрывателя, подключается к компьютеру через последовательный порт. Чтобы предоставить музыкальный проигрыватель в качестве устройства на основе UPnP, требуется объект управления устройством и набор объектов служб. Эти объекты реализуют действия музыкального проигрывателя на основе UPnP в качестве последовательных команд. Однако проигрыватель музыки должен быть подключен к последовательному порту и доступен для управления перед регистрацией этих объектов.

Так как последовательный порт не предоставляет явный механизм уведомления при подключении устройств, требуется опрашивающий код. Этот код может быть реализован в объекте поставщика устройства, в службе или в автономном приложении. При запуске компьютера узел устройства создает экземпляр объекта поставщика устройства, а затем вызывает его метод [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) . Когда поставщик устройства обнаруживает наличие устройства воспроизведения музыки, он создает экземпляр соответствующего объекта управления устройством и регистрирует его, вызывая [**иупнпрегистрар:: регистерруннингдевице**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice). Этот метод публикует устройство и объявляет его сети на основе UPnP.

Те же функциональные возможности можно реализовать с помощью службы, которая опрашивает последовательный порт. Тем не менее поставщики устройств упрощают работу, так как для запуска и завершения работы поставщики устройств используют только основные функциональные возможности (опрос). Использование поставщиков устройств проще, чем реализация службы.

Во время регистрации и при каждом последующем запуске системы компьютер создает экземпляр объекта поставщика устройства, а затем вызывает метод [**иупнпдевицепровидер:: Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) , передавая ему строку инициализации, указанную во время регистрации.

После вызова метода [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) поставщик устройства выполняет необходимую обработку, и при необходимости поставщик устройства регистрирует устройства путем вызова [**Иупнпрегистрар:: регистерруннингдевице**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), как описано в разделе [Регистрация размещенного устройства на узле устройства](registering-a-hosted-device-with-the-device-host.md).

Когда компьютер завершает работу, узел устройства вызывает метод [**иупнпдевицепровидер::**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-stop) Terminate, указывающий, что поставщик устройства прекращает работу.

 

 