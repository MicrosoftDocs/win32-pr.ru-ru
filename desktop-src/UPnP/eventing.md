---
title: Обработка событий
description: Размещенная служба должна реализовывать интерфейс Иупнпевентсаурце, если он имеет переменные состояния события.
ms.assetid: 7558496d-c909-4602-bfaa-d21108392fed
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68a6382ee88d2ca5168c94eac20727bbfee4a598
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888507"
---
# <a name="eventing"></a><span data-ttu-id="e8ee5-103">Обработка событий</span><span class="sxs-lookup"><span data-stu-id="e8ee5-103">Eventing</span></span>

<span data-ttu-id="e8ee5-104">Размещенная служба должна реализовывать интерфейс [**иупнпевентсаурце**](/windows/desktop/api/Upnphost/nn-upnphost-iupnpeventsource) , если он имеет переменные состояния события.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-104">A hosted service must implement the [**IUPnPEventSource**](/windows/desktop/api/Upnphost/nn-upnphost-iupnpeventsource) interface if it has evented state variables.</span></span> <span data-ttu-id="e8ee5-105">Этот интерфейс имеет два метода: [**advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise) и [**unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise).</span><span class="sxs-lookup"><span data-stu-id="e8ee5-105">This interface has two methods: [**Advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise) and [**Unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise).</span></span> <span data-ttu-id="e8ee5-106">Этот интерфейс предоставляет механизм для подписки узла устройства на уведомления о событиях, созданные размещенной службой.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-106">This interface provides a mechanism for the device host to subscribe to event notifications generated by the hosted service.</span></span> <span data-ttu-id="e8ee5-107">В каждый момент времени будет зарегистрировано больше одного приемника событий.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-107">There will be no more than one event sink registered at a time.</span></span>

<span data-ttu-id="e8ee5-108">Размещенная служба должна реализовать метод [**advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise) , задерживая ссылку на интерфейс [**иупнпевентсинк**](/windows/desktop/api/Upnphost/nn-upnphost-iupnpeventsink) , который был передан в качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-108">A hosted service must implement the [**Advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise) method by holding a reference to the [**IUPnPEventSink**](/windows/desktop/api/Upnphost/nn-upnphost-iupnpeventsink) interface, which was passed as a parameter.</span></span> <span data-ttu-id="e8ee5-109">Если интерфейс найден, метод **advise** содержит ссылку на этот интерфейс до вызова метода [**unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise) или до тех пор, пока объект размещенной службы не будет удален.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-109">If the interface is found, the **Advise** method holds a reference to that interface until [**Unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise) is invoked, or until the hosted service object is removed.</span></span> <span data-ttu-id="e8ee5-110">Предложение **advise** вызывается только один раз.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-110">**Advise** is called only once.</span></span>

<span data-ttu-id="e8ee5-111">Чтобы удалить подписку, узел устройства вызывает метод [**unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise) и передает указатель на объект, используемый при вызове [**advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise).</span><span class="sxs-lookup"><span data-stu-id="e8ee5-111">To remove the subscription, the device host invokes [**Unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise) and passes in the object pointer used when it called [**Advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise).</span></span> <span data-ttu-id="e8ee5-112">Размещенная служба удаляет подписку, если указатель совпадает с именем, передаваемым в предложение **advise**.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-112">The hosted service removes the subscription if the pointer is the same as the one passed to **Advise**.</span></span>

<span data-ttu-id="e8ee5-113">При изменении значения переменной состояния размещенная служба должна сообщить о возникновении события.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-113">When a state variable's value changes, the hosted service must signal that an event has occurred.</span></span> <span data-ttu-id="e8ee5-114">Эти службы выполняет это путем вызова метода [**иупнпевентсинк:: онстатечанжед**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsink-onstatechanged) .</span><span class="sxs-lookup"><span data-stu-id="e8ee5-114">The services does this by invoking the [**IUPnPEventSink::OnStateChanged**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsink-onstatechanged) method.</span></span>

<span data-ttu-id="e8ee5-115">Когда узлу устройства больше не требуется получать уведомления от размещенной службы, он вызывает [**иупнпевентсаурце:: unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise), передавая тот же указатель объекта, который был получен от [**advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise).</span><span class="sxs-lookup"><span data-stu-id="e8ee5-115">When the device host no longer needs to receive notifications from the hosted service, it invokes [**IUPnPEventSource::Unadvise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise), passing in the same object pointer that it received from [**Advise**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise).</span></span> <span data-ttu-id="e8ee5-116">Узел устройства вызывает этот метод, когда устройство больше не будет находиться в сети.</span><span class="sxs-lookup"><span data-stu-id="e8ee5-116">The device host invokes this method when the device is no longer going to be on the network.</span></span>

 

 




