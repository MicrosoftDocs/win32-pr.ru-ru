---
title: Использование содержимого измерения
description: Использование содержимого измерения
ms.assetid: f87b5d95-a497-4356-817f-49ac3819df08
keywords:
- Диспетчер устройств Windows Media, использование содержимого измерения
- Диспетчер устройств, использование содержимого измерения
- программное содержимое, отслеживание использования содержимого
- Классические приложения, использование содержимого с учетом измерений
- Создание приложений диспетчер устройств Windows Media, использование содержимого измерения
- использование содержимого измерения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 649eee810e7bbdbc2ea93a32c6368ec345fa7364
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2020
ms.locfileid: "105691701"
---
# <a name="metering-content-usage"></a><span data-ttu-id="1bf5f-109">Использование содержимого измерения</span><span class="sxs-lookup"><span data-stu-id="1bf5f-109">Metering Content Usage</span></span>

<span data-ttu-id="1bf5f-110">С помощью технологии Windows Media 10 теперь можно отслеживать использование содержимого на портативном устройстве.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-110">With Windows Media 10 technology, you can now meter content usage on a portable device.</span></span> <span data-ttu-id="1bf5f-111">Если лицензия Windows Media 10 разрешает измерение, устройство может сохранять число воспроизводимых композиций и передавать их на издатель лицензий через Интернет.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-111">If a Windows Media 10 license allows metering, the device can store the play count for songs and upload usage back to the license issuer over the Internet.</span></span> <span data-ttu-id="1bf5f-112">Эта система позволяет поставщикам содержимого настраивать свою оплату за счет точного измерения использования содержимого.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-112">This system enables content providers to adjust their royalty fees by accurately measuring content usage.</span></span>

<span data-ttu-id="1bf5f-113">Для отслеживания содержимого приложение должно иметь сертификат отслеживания, предоставленный службой лицензирования, созданной на основе пакета SDK Windows Media Rights Manager 10.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-113">To meter content, the application must have a metering certificate provided by a licensing service built on the Windows Media Rights Manager 10 SDK.</span></span> <span data-ttu-id="1bf5f-114">Измерение можно отслеживать только для содержимого, лицензированного этой же службой.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-114">Only content licensed by this same service can be metered.</span></span> <span data-ttu-id="1bf5f-115">Дополнительные сведения о том, как работает измерение, и о том, как создать службу контроля использования лицензий, см. в [документации по пакету SDK Windows Media Rights Manager](/previous-versions/ms986509(v=msdn.10)) на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-115">For more information on how metering works, and how to build a license metering service, see the [Windows Media Rights Manager SDK documentation](/previous-versions/ms986509(v=msdn.10)) on MSDN.</span></span> <span data-ttu-id="1bf5f-116">Пакет SDK можно получить, заполнив необходимые сведения на [странице Лицензирование Windows Media](https://www.microsoft.com/licensing/default).</span><span class="sxs-lookup"><span data-stu-id="1bf5f-116">The SDK can be acquired by filling out the necessary information on the [Windows Media Licensing Page](https://www.microsoft.com/licensing/default).</span></span>

<span data-ttu-id="1bf5f-117">В приложении может быть встроено измерение, или можно создать подключаемый модуль COM для существующего приложения, например проигрыватель Windows Media, если приложение принимает подключаемые модули измерения.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-117">An application can have metering built in to it, or you can build a COM plug-in for an existing application, such as the Windows Media Player, if the application accepts metering plug-ins.</span></span>

<span data-ttu-id="1bf5f-118">Приложение должно предупредить пользователей о том, что будет использоваться измерение использования содержимого.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-118">An application should warn users if content usage will be metered.</span></span> <span data-ttu-id="1bf5f-119">Дополнительные сведения см. на веб-страницах Майкрософт, перечисленных в заявлении [о конфиденциальности](privacy-statement.md).</span><span class="sxs-lookup"><span data-stu-id="1bf5f-119">For more information, see the Microsoft Web pages listed in the [Privacy Statement](privacy-statement.md).</span></span>

<span data-ttu-id="1bf5f-120">Получение данных метрик с устройства может быть слишком высокой.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-120">Acquiring metering data from a device can be slow.</span></span> <span data-ttu-id="1bf5f-121">Таким образом, если использование измеряется приложением, оно будет часто выполняться для предотвращения накопления больших объемов данных на устройстве и снижения скорости передачи данных.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-121">Therefore, if an application meters usage, it should do so frequently to prevent large amounts of data from accumulating on the device and slowing down the data transfer.</span></span> <span data-ttu-id="1bf5f-122">Чтобы предотвратить передачу данных, которые будут слишком замедляться, производители устройств могут отсылать подмножества доступных данных о метриках.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-122">To prevent data transfers that would be too slow, device manufacturers can send subsets of available metering data.</span></span> <span data-ttu-id="1bf5f-123">Приложение должно отслеживать флаги, полученные с помощью [**ивмдрмдевицеапп::P роцессметерреспонсе**](iwmdrmdeviceapp-processmeterresponse.md) , чтобы узнать, остались ли на устройстве все больше данных отслеживания использования.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-123">The application should monitor the flags retrieved by [**IWMDRMDeviceApp::ProcessMeterResponse**](iwmdrmdeviceapp-processmeterresponse.md) to see if any more metering data remains on the device.</span></span>

<span data-ttu-id="1bf5f-124">Ниже показано, как приложение может использовать содержимое для отслеживания использования содержимого.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-124">The following steps show how an application can meter content usage.</span></span>

1.  <span data-ttu-id="1bf5f-125">Так как измерение доступно только на устройствах, поддерживающих Windows Media DRM 10 для переносных устройств, приложение должно в некоторый момент вызвать **куеридевицестатус**, как описано в разделе [Обработка защищенного содержимого в приложении](handling-protected-content-in-the-application.md), чтобы убедиться, что устройство является действительным и актуальным.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-125">Because metering is only available on devices that support Windows Media DRM 10 for Portable Devices, your application should at some point call **QueryDeviceStatus**, as described in [Handling Protected Content in the Application](handling-protected-content-in-the-application.md), to ensure that the device is valid and up to date.</span></span>
2.  <span data-ttu-id="1bf5f-126">Запрос сведений о метриках с устройства путем вызова [**ивмдрмдевицеапп:: женератеметерчалленже**](iwmdrmdeviceapp-generatemeterchallenge.md).</span><span class="sxs-lookup"><span data-stu-id="1bf5f-126">Request metering information from the device by calling [**IWMDRMDeviceApp::GenerateMeterChallenge**](iwmdrmdeviceapp-generatemeterchallenge.md).</span></span>
3.  <span data-ttu-id="1bf5f-127">Отправьте полученные данные о метриках в службу измерения по URL-адресу, полученному с помощью **женератеметерчалленже**.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-127">Send the retrieved metering data to the metering service at the URL retrieved by **GenerateMeterChallenge**.</span></span> <span data-ttu-id="1bf5f-128">Формат данных, отправляемых в службу, зависит от сценария для этой службы.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-128">The format of data sent to the service depends on the scripting on that particular service.</span></span> <span data-ttu-id="1bf5f-129">Например, некоторые службы могут потребовать, чтобы данные отправлялись в качестве команды POST в виде пары "имя-значение".</span><span class="sxs-lookup"><span data-stu-id="1bf5f-129">For example, some services might require the data sent as a POST command as a name/value pair.</span></span> <span data-ttu-id="1bf5f-130">Поставщик услуг должен сообщить о конкретных требованиях к форматированию.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-130">The service provider should let you know their particular formatting requirements.</span></span>
4.  <span data-ttu-id="1bf5f-131">Получите ответ от службы контроля использования и отправьте его на устройство, вызвав [**ивмдрмдевицеапп::P роцессметерреспонсе**](iwmdrmdeviceapp-processmeterresponse.md).</span><span class="sxs-lookup"><span data-stu-id="1bf5f-131">Get a response from the metering service, and send it to the device by calling [**IWMDRMDeviceApp::ProcessMeterResponse**](iwmdrmdeviceapp-processmeterresponse.md).</span></span> <span data-ttu-id="1bf5f-132">Это заставляет устройство сбрасывать счетчики воспроизведения, а также возвращает значение, указывающее, существуют ли на устройстве больше данных отслеживания использования, которые необходимо получить, вызвав **женератеметерчалленже** еще раз.</span><span class="sxs-lookup"><span data-stu-id="1bf5f-132">This causes the device to reset play counts, and also returns a value indicating whether more metering data exists on the device that should be retrieved by calling **GenerateMeterChallenge** again.</span></span>

<span data-ttu-id="1bf5f-133">Подробные сведения и примеры кода для измерения см. на [веб-сайте Windows Media](/previous-versions//bb614723(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="1bf5f-133">For extensive information and sample code for metering, see the [Windows Media Web site](/previous-versions//bb614723(v=vs.85)).</span></span>

 

 