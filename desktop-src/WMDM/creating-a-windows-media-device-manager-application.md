---
title: Создание приложения диспетчер устройств Windows Media
description: Создание приложения диспетчер устройств Windows Media
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:
- Диспетчер устройств Windows Media, создание приложений
- Диспетчер устройств, создание приложений
- Диспетчер устройств Windows Media, программное руководством
- Диспетчер устройств, программное руководством
- Программное обеспечено, классические приложения
- инструкции по программированию, Windows Media диспетчер устройств
- инструкции по программированию, подключаемые модули
- инструкции по программированию, создание приложений
- Windows Media диспетчер устройств, классические приложения
- Диспетчер устройств, классические приложения
- Диспетчер устройств Windows Media, подключаемые модули
- Диспетчер устройств, Plug-инсп
- подключаемые модули, создание
- подключаемые модули, программное обеспеченное программирование
- Классические приложения, создание
- Создание приложений диспетчер устройств Windows Media, о
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b50a2dfce057b993f84c0aca4c8f45796f67ba8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105691184"
---
# <a name="creating-a-windows-media-device-manager-application"></a><span data-ttu-id="56bd6-119">Создание приложения диспетчер устройств Windows Media</span><span class="sxs-lookup"><span data-stu-id="56bd6-119">Creating a Windows Media Device Manager Application</span></span>

<span data-ttu-id="56bd6-120">В этом разделе описывается использование диспетчер устройств Windows Media в приложении.</span><span class="sxs-lookup"><span data-stu-id="56bd6-120">This section describes how to use Windows Media Device Manager in your application.</span></span> <span data-ttu-id="56bd6-121">Термин "приложение" здесь означает либо исполняемый файл, например проигрыватель мультимедиа, либо подключаемый модуль COM, например подключаемый модуль измерения.</span><span class="sxs-lookup"><span data-stu-id="56bd6-121">The term "application" here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</span></span>

<span data-ttu-id="56bd6-122">Корпорация Майкрософт предоставляет несколько поставщиков услуг с Windows XP и проигрывателем Windows Media 10, включая поставщика услуг MTP, Windows CE поставщика услуг (для устройств под управлением Windows CE и с помощью протокола RAPI, такого как Pocket PC), и поставщика услуг для устройств категории запоминающих устройств (MSC).</span><span class="sxs-lookup"><span data-stu-id="56bd6-122">Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices.</span></span> <span data-ttu-id="56bd6-123">Вы также можете создать собственный поставщик услуг, чтобы обеспечить взаимодействие с вашим устройством. Дополнительные сведения см. [в разделе Создание поставщика услуг](creating-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-123">You can also create your own service provider to ensure communication with your own device; for more information, see [Creating a Service Provider](creating-a-service-provider.md).</span></span>

<span data-ttu-id="56bd6-124">Существует несколько сторонних поставщиков услуг прежних версий, использующих устройство, отличное от MTP, не RAPI или не поддерживающее MSC.</span><span class="sxs-lookup"><span data-stu-id="56bd6-124">There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device.</span></span> <span data-ttu-id="56bd6-125">Эти поставщики услуг входят в состав диска драйверов, поставляемого вместе с этими устройствами.</span><span class="sxs-lookup"><span data-stu-id="56bd6-125">These service providers are included on the driver disk shipped with these devices.</span></span>

<span data-ttu-id="56bd6-126">Приложение, использующее диспетчер устройств Windows Media, должно выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="56bd6-126">An application that uses Windows Media Device Manager must perform the following steps.</span></span>

1.  <span data-ttu-id="56bd6-127">**Учитывайте вопросы конфиденциальности, связанные с разработкой приложения.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-127">**Become aware of privacy issues involved with developing an application.**</span></span> <span data-ttu-id="56bd6-128">Ознакомьтесь с заявлением [о конфиденциальности](privacy-statement.md) , чтобы узнать о некоторых проблемах с конфиденциальностью, связанных с разработкой приложения Диспетчер устройств Windows Media.</span><span class="sxs-lookup"><span data-stu-id="56bd6-128">See [Privacy Statement](privacy-statement.md) to learn about some privacy issues involving developing a Windows Media Device Manager application.</span></span>
2.  <span data-ttu-id="56bd6-129">**Включите необходимые файлы библиотек и заголовков для приложения.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-129">**Include the required library and header files for your application.**</span></span> <span data-ttu-id="56bd6-130">Сведения о том, какие файлы необходимо включить в проект, см. в разделе [необходимые файлы библиотеки и заголовков приложения](required-library-and-header-files-for-an-application.md) .</span><span class="sxs-lookup"><span data-stu-id="56bd6-130">See [Required Library and Header Files for an Application](required-library-and-header-files-for-an-application.md) to learn what files you will need to include in your project.</span></span>
3.  <span data-ttu-id="56bd6-131">**Проверяйте подлинность приложения и получите корневой интерфейс Ивмдмдевице.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-131">**Authenticate the application and acquire the root IWMDMDevice interface.**</span></span> <span data-ttu-id="56bd6-132">Первая задача, которую приложение должно выполнить для использования диспетчер устройств Windows Media, — это проверка подлинности.</span><span class="sxs-lookup"><span data-stu-id="56bd6-132">The first task an application must do to use Windows Media Device Manager is to authenticate itself.</span></span> <span data-ttu-id="56bd6-133">Этот процесс проверяет подлинность приложения на диспетчер устройств Windows Media, используя фиктивный сертификат для ограниченного функционирования Windows Media диспетчер устройств или используя официальный сертификат для полной функциональности.</span><span class="sxs-lookup"><span data-stu-id="56bd6-133">This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality.</span></span> <span data-ttu-id="56bd6-134">Дополнительные сведения см. [в разделе Проверка подлинности приложения](authenticating-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-134">For more information, see [Authenticating the Application](authenticating-the-application.md).</span></span>
4.  <span data-ttu-id="56bd6-135">**Перечисление подключенных устройств.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-135">**Enumerate the connected devices.**</span></span> <span data-ttu-id="56bd6-136">Первый шаг при взаимодействии с устройствами — узнать, какие устройства подключены и доступны для Windows Media диспетчер устройств.</span><span class="sxs-lookup"><span data-stu-id="56bd6-136">The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager.</span></span> <span data-ttu-id="56bd6-137">Дополнительные сведения см. в разделе [Перечисление устройств](enumerating-devices.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-137">For more information, see [Enumerating Devices](enumerating-devices.md).</span></span>
5.  <span data-ttu-id="56bd6-138">**Проверьте состояние компонентов DRM устройства.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-138">**Check the status of the device's DRM components.**</span></span> <span data-ttu-id="56bd6-139">Для использования файлов, защищенных DRM, устройство должно быть создано на основе какой-либо версии Windows Media DRM для переносных устройств, а компоненты DRM должны быть актуальными.</span><span class="sxs-lookup"><span data-stu-id="56bd6-139">To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date.</span></span> <span data-ttu-id="56bd6-140">Прежде чем начать обработку файлов на устройстве, лучше узнать, поддерживает ли устройство файлы, защищенные DRM, а также необходимость обновления устройства.</span><span class="sxs-lookup"><span data-stu-id="56bd6-140">Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated.</span></span> <span data-ttu-id="56bd6-141">Дополнительные сведения см. [в разделе Обработка защищенного содержимого в приложении](handling-protected-content-in-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-141">For more information, see [Handling Protected Content in the Application](handling-protected-content-in-the-application.md).</span></span>
6.  <span data-ttu-id="56bd6-142">**Изучите устройство.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-142">**Explore a device.**</span></span> <span data-ttu-id="56bd6-143">После того как вы нашли нужное устройство, вы сможете просмотреть содержимое этого устройства.</span><span class="sxs-lookup"><span data-stu-id="56bd6-143">After you have found the device you want, you can explore the contents of that device.</span></span> <span data-ttu-id="56bd6-144">Дополнительные сведения см. [в разделе Просмотр устройства](exploring-a-device.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-144">For more information, see [Exploring a Device](exploring-a-device.md).</span></span>
7.  <span data-ttu-id="56bd6-145">**Чтение файлов с устройства и запись файлов на устройство.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-145">**Read files from the device, and write files to the device.**</span></span> <span data-ttu-id="56bd6-146">После того как вы узнаете о макете устройства, вы можете начать передачу файлов на устройство и с него.</span><span class="sxs-lookup"><span data-stu-id="56bd6-146">After you know about the layout of the device, you can begin transferring files to and from the device.</span></span> <span data-ttu-id="56bd6-147">Дополнительные сведения см. в разделе [чтение файлов с устройства](reading-files-from-the-device.md) и [запись файлов на устройство](writing-files-to-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-147">For more information, see [Reading Files from the Device](reading-files-from-the-device.md) and [Writing Files to the Device](writing-files-to-the-device.md).</span></span>
8.  <span data-ttu-id="56bd6-148">**Создание списков воспроизведения на устройстве.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-148">**Create playlists on the device.**</span></span> <span data-ttu-id="56bd6-149">Файлы одного типа, которые можно записать на устройство, — это абстрактный файл, который представляет собой коллекцию ссылок на другие файлы.</span><span class="sxs-lookup"><span data-stu-id="56bd6-149">One kind of file you can write to the device is an abstract file, which is a collection of references to other files.</span></span> <span data-ttu-id="56bd6-150">Хотя возможность записи абстрактных файлов на устройство зависит от поставщика услуг и устройства, обычно эта возможность доступна только для устройств MTP.</span><span class="sxs-lookup"><span data-stu-id="56bd6-150">Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability.</span></span> <span data-ttu-id="56bd6-151">Дополнительные сведения см. в разделе [Создание списка воспроизведения на устройстве](creating-a-playlist-on-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-151">For more information, see [Creating a Playlist on the Device](creating-a-playlist-on-the-device.md).</span></span>

<span data-ttu-id="56bd6-152">В дополнение к этим действиям в приложении можно включить еще несколько функций:</span><span class="sxs-lookup"><span data-stu-id="56bd6-152">In addition to these steps, there are several more features that you can enable in your application:</span></span>

-   <span data-ttu-id="56bd6-153">**Уведомления.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-153">**Notifications.**</span></span> <span data-ttu-id="56bd6-154">Вы можете разрешить приложению получать уведомления, когда устройства подключаются к компьютеру или отключаются от него.</span><span class="sxs-lookup"><span data-stu-id="56bd6-154">You can enable your application to receive notifications when devices connect or disconnect from the computer.</span></span> <span data-ttu-id="56bd6-155">Дополнительные сведения см. в разделе [Включение уведомлений](enabling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-155">For more information, see [Enabling Notifications](enabling-notifications.md).</span></span>
-   <span data-ttu-id="56bd6-156">**Подробности.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-156">**Logging.**</span></span> <span data-ttu-id="56bd6-157">Диспетчер устройств Windows Media использует объект ведения журнала, который сохраняет запись своих действий в локальный текстовый файл.</span><span class="sxs-lookup"><span data-stu-id="56bd6-157">Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file.</span></span> <span data-ttu-id="56bd6-158">В этот журнал можно добавлять сообщения, помогающие анализировать ошибки или производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="56bd6-158">You can add messages to this log to help you analyze errors or performance in your application.</span></span> <span data-ttu-id="56bd6-159">Дополнительные сведения см. в разделе [Включение ведения журнала](enabling-logging.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-159">For more information, see [Enabling Logging](enabling-logging.md).</span></span>
-   <span data-ttu-id="56bd6-160">**Использование содержимого измерения.**</span><span class="sxs-lookup"><span data-stu-id="56bd6-160">**Metering content usage.**</span></span> <span data-ttu-id="56bd6-161">Вы можете получить статистику использования содержимого для лицензий, которые предоставляют это право.</span><span class="sxs-lookup"><span data-stu-id="56bd6-161">You can retrieve content usage statistics for licenses that grant this right.</span></span> <span data-ttu-id="56bd6-162">Затем эти статистические данные можно отправить на веб-сервер, чтобы вычислить прямые платежи владельцам содержимого.</span><span class="sxs-lookup"><span data-stu-id="56bd6-162">These statistics can then be sent up to a Web server to calculate royalty payments to content owners.</span></span> <span data-ttu-id="56bd6-163">Дополнительные сведения см. в разделе [измерение использования содержимого](metering-content-usage.md).</span><span class="sxs-lookup"><span data-stu-id="56bd6-163">For more information, see [Metering Content Usage](metering-content-usage.md).</span></span>

<span data-ttu-id="56bd6-164">**Обратите внимание на предупреждение**</span><span class="sxs-lookup"><span data-stu-id="56bd6-164">**A note of caution**</span></span>

<span data-ttu-id="56bd6-165">Приложению может потребоваться работать с различными устройствами, в том числе некоторые из которых вы не разработали и никогда не тестировали код.</span><span class="sxs-lookup"><span data-stu-id="56bd6-165">Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against.</span></span> <span data-ttu-id="56bd6-166">Эти устройства могут не отвечать на запросы и команды или реализовывать MTP или другие спецификации.</span><span class="sxs-lookup"><span data-stu-id="56bd6-166">These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications.</span></span> <span data-ttu-id="56bd6-167">Не забудьте обеспечить надежную проверку ошибок и возможности резервного использования, чтобы работать с непредвиденными.</span><span class="sxs-lookup"><span data-stu-id="56bd6-167">Be sure to include robust error checking and fallback functionality to deal with the unexpected.</span></span> <span data-ttu-id="56bd6-168">Программа защищена.</span><span class="sxs-lookup"><span data-stu-id="56bd6-168">Program defensively.</span></span>

## <a name="related-topics"></a><span data-ttu-id="56bd6-169">См. также</span><span class="sxs-lookup"><span data-stu-id="56bd6-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="56bd6-170">**Инструкции по программированию**</span><span class="sxs-lookup"><span data-stu-id="56bd6-170">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 




