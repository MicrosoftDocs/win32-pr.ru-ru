---
title: Образец поставщика услуг
description: Образец поставщика услуг
ms.assetid: bbdeddb5-4ddf-4a61-828c-a9ba7af307ea
keywords:
- Windows Диспетчер устройств мультимедиа, примеры
- Диспетчер устройств, примеры
- Windows Диспетчер устройств носителя, пример поставщика услуг
- Диспетчер устройств, пример поставщика услуг
- поставщики услуг, примеры
- Примеры, поставщики услуг
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8eead5296a1ba3213f291027c0b1e4d50275497ad2ebe5a3feaea994e4a5c8e3
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120004914"
---
# <a name="sample-service-provider"></a>Образец поставщика услуг

пакет SDK для Windows Media диспетчер устройств содержит образец поставщика услуг, который вы хотите использовать. Этот поставщик услуг включает класс, сообщающий каждый жесткий диск компьютера, как если бы он был подключенным устройством. Единственным приложением, которое будет использовать этот поставщик услуг, является пример приложения. Windows Обозреватель не увидит "устройства", предоставленные этим поставщиком услуг. Пример поставщика услуг представляет собой COM-объект, созданный на основе ATL. Ниже описано, как использовать образец поставщика услуг.

> [!Note]  
> в примере поставщика служб реализовано очень мало функций, поэтому его не следует использовать для тестирования Windows мультимедиа диспетчер устройств приложений. Чтобы протестировать приложение, используйте полностью реализованный поставщик услуг.

 

-   Пример был доставлен с ошибкой в коде, которая приведет к сбою поставщика услуг. Чтобы исправить эту ошибку, откройте файл мдспенумстораже. cpp, установленный в папке < *путь установки пакета SDK*  > \\ WMFSDK95 \\ вмдм \\ МДСП \\ мшдсп, перейдите в строку 185 и измените следующую строку:

`wcsncpy(pStg->m_wcsName, m_wcsPath, dwLen);`

На эту:

`wcsncpy(pStg->m_wcsName, m_wcsPath, ARRAYSIZE(pStg->m_wcsName));`

1.  Скомпилируйте файл MsHDSP.dll. Это можно сделать с помощью NMAKE или Visual Studio. сведения о компиляции приложения см. в разделе [компиляция примера поставщика услуг с помощью NMAKE](compiling-the-sample-service-provider-using-nmake.md) или [компиляция примера поставщика услуг с помощью Visual Studio](compiling-the-sample-service-provider-using-visual-studio.md) .
2.  Зарегистрируйте MsHDSP.dll с помощью regsvr32. Следующая строка, введенная в окно командной строки в той же папке, что и MsHDSP.dll, зарегистрирует образец поставщика услуг:

    ```C++
    regsvr32 mshdsp.dll
    ```

    

    Чтобы отключить олицетворение устройства, введите в командной строке следующую строку:

    ```C++
    regsvr32 /u mshdsp.dll
    ```

    

3.  Съемные устройства, олицетворенные с помощью этой библиотеки DLL, могут рассматриваться только в примере приложения, поставляемого с этим пакетом SDK. Скомпилируйте пример приложения с помощью одного из методов, описанных в [примере классического приложения](sample-desktop-application.md).
4.  чтобы выполнить отладку поставщика услуг с Visual Studio, откройте поставщик службы в Visual Studio и выберите команду **запустить** в меню **отладка** . Во всплывающем диалоговом окне перейдите к образцу приложения, созданному на предыдущем шаге, и нажмите кнопку **ОК**, и поставщик услуг начнет работать в режиме отладки.

    чтобы запустить поставщик службы без отладки в Visual Studio, просто зарегистрируйте msdhsp.dll и запустите пример приложения для настольных систем, которое поставляется вместе с пакетом SDK. Пример классического приложения запускает образец поставщика услуг автоматически.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Примеры**](samples.md)
</dt> </dl>

 

 




