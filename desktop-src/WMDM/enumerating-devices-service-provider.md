---
title: Перечисление устройств (ВМДМ)
description: Windows Диспетчер устройств мультимедиа поддерживает кэш подключенных устройств. узнайте, как Windows Media диспетчер устройств поддерживает или обновляет свой кэш.
ms.assetid: 7602da65-4c98-4766-b206-2129dad4cc2a
keywords:
- Windows Диспетчер устройств мультимедиа, перечисление устройств
- Диспетчер устройств, перечисление устройств
- программное содержимое, перечисление устройств
- поставщики услуг, перечисление устройств
- Создание поставщиков услуг, перечисление устройств
- Перечисление устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 500375f01e718ab6f9824868ffabd7c83e11c3e812ce0288f0c15186bc1d2de9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119767054"
---
# <a name="enumerating-devices-wmdm"></a>Перечисление устройств (ВМДМ)

Windows диспетчер устройств мультимедиа поддерживает кэш подключенных устройств, которые обновляются при запуске Windowsного приложения диспетчер устройств мультимедиа, при подключении или отключении устройства самонастраивающийся (PnP) или при вызове [**IWMDeviceManager2:: reinitialize**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdevicemanager2-reinitialize). Этот кэш предоставляется приложению при вызове [**ивмдевицеманажер:: енумдевицес**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdevicemanager-enumdevices) или [**IWMDeviceManager2:: EnumDevices2**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdevicemanager2-enumdevices2). Каждое устройство предоставляется приложению как интерфейс [**ивмдмдевице**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmdevice) . если поставщик услуг зарегистрирован для работы с устройствами PnP, Windows Media диспетчер устройств будет знать о текущем списке подключенных устройств. Если поставщик услуг зарегистрирован для управления устройствами, не поддерживающими PnP, поставщик услуг отвечает за обнаружение подключенных устройств. Поставщик услуг может быть зарегистрирован только для устройств PnP или не на основе PnP, но не в обоих случаях.

следующие действия показывают, как Windows Media диспетчер устройств обслуживает или обновляет свой кэш. Обратите внимание, что кэш никогда не обновляется при подключении или отключении устройства, не поддерживающего PnP.

запуск приложения диспетчер устройств Windows Media

-   Windows Media диспетчер устройств извлекает список подключенных устройств PnP из подсистемы PnP и вызывает [**IMDServiceProvider2:: креатедевице**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice) для служб SP, зарегистрированных для каждого подключенного устройства. (Он обнаруживает правильного поставщика услуг, запрашивая параметр устройства ВМДМСПКЛСИД для идентификатора класса поставщика услуг, ответственного за это устройство. Дополнительные сведения см. в разделе [Параметры устройства](device-parameters.md) .) все возвращенные устройства добавляются в кэш устройств Windows Media диспетчер устройств.
-   Windows Диспетчер устройств носителя находит все зарегистрированные в нем поставщики служб, не поддерживающих PnP, и вызывает [**имдсервицепровидер:: енумдевицес**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices) для каждого поставщика услуг, чтобы получить список устройств от каждого из них. Все возвращенные устройства добавляются в кэш.

Приложение вызывает Ивмдевицеманажер/2:: Енумдевицес/2

-   Windows Диспетчер устройств мультимедиа возвращает свой список кэшированных устройств.

Устройство PnP подключается

-   Windows Media диспетчер устройств находит соответствующего поставщика услуг и вызывает **IMDServiceProvider2:: креатедевице** и добавляет устройство в свой кэш.
-   если приложение реализует [**ивмдмнотификатион**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmnotification), Windows Media диспетчер устройств вызывает [**ивмдмнотификатион:: вмдммессаже**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmnotification-wmdmmessage) с уведомлением о получении.

PnP-устройство отключается

-   Windows Диспетчер устройств носителя удаляет элемент из своего кэша.
-   если приложение реализует ивмдмнотификатион, Windows Media диспетчер устройств вызывает ивмдмнотификатион:: вмдммессаже с уведомлением о отправлении.

Приложение вызывает IWMDeviceManager2:: Reinitialize

-   Обновляет кэш всеми подключенными устройствами.

Устройство, не поддерживающее PnP, подключается или отключается

-   Windows Диспетчер устройств носителя не сообщает о прибытии или отправлении и не выполняет никаких действий.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Создание поставщика услуг**](creating-a-service-provider.md)
</dt> </dl>

 

 




