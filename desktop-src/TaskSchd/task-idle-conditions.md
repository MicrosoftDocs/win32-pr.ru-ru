---
title: Условия простоя задачи
description: Задача может быть обработана несколькими способами, когда компьютер переходит в состояние простоя. Это включает определение триггера Idle или задание условий простоя для запуска задачи.
ms.assetid: 1e480681-b77a-48fe-a732-dd1591eaa08d
keywords:
- условия простоя планировщик задач
- условия бездействия планировщик задач, обсуждение
- Создание триггеров бездействия планировщик задач
- триггеры бездействия планировщик задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 501be9b73e3ec355b998697fb5e87c5163224b71
ms.sourcegitcommit: 857e701bbd35004661bb047e1f24622af9ff1dd7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2020
ms.locfileid: "103797149"
---
# <a name="task-idle-conditions"></a>Условия простоя задачи

Задача может быть обработана несколькими способами, когда компьютер переходит в состояние простоя. Это включает определение триггера Idle или задание условий простоя для запуска задачи.

## <a name="detecting-the-idle-state"></a>Обнаружение состояния простоя

В Windows 7 планировщик задач проверяет, что компьютер находится в состоянии простоя каждые 15 минут. Планировщик задач проверяет состояние простоя, используя два критерия: отсутствие пользователя и отсутствие потребления ресурсов. Пользователь считается отсутствующим, если в этот период времени нет ввода с клавиатуры или мыши. Компьютер считается неактивным, если все процессоры и все диски были бездействующими в течение более чем 90% времени последнего интервала обнаружения. (Исключением может быть любое приложение типа Presentation, устанавливающее \_ ОТОБРАЗИТЬ \_ необходимый флаг. Этот флаг заставляет расписание задач не считать систему бездействующей, независимо от активности пользователей или потребления ресурсов.)

В Windows 7 планировщик задач рассматривает процессор как бездействующий, даже если выполняются потоки с низким приоритетом (приоритет потока < нормальная).

В Windows 7, когда планировщик задач обнаруживает, что компьютер находится в режиме бездействия, служба ожидает, что только входные данные пользователя помечают окончание состояния простоя.

В Windows 8 планировщик задач выполняет те же общие проверки отсутствия и потребления ресурсов пользователя. Однако планировщик задач полагается на подсистему питания операционной системы для обнаружения присутствия пользователя. По умолчанию пользователь считается отсутствующим по истечении четырех минут без ввода с клавиатуры или с помощью мыши. Время проверки потребления ресурсов сокращается до 10 минут, когда пользователь представлен. При отсутствии пользователя время проверки сокращается до 30 секунд. Планировщик задач выполняет дополнительные проверки потребления ресурсов для следующих событий:

-   Состояние присутствия пользователя изменено
-   Источник питания AC/DC изменен
-   Уровень аккумулятора изменен (только при питании от батарей)

Когда происходит любое из приведенных выше событий, планировщик задач проверяет компьютер для время простоя с момента последней проверки. На практике это означает, что планировщик задач может объявить систему как бездействие немедленно после обнаружения отсутствия пользователя, если другие условия были выполнены с момента последней проверки.

В Windows 8 пороговые значения ЦП и ввода-вывода задаются равными 80%.

При обнаружении состояния простоя в Windows 8 Server планировщик задач не учитывает присутствие пользователя или его отсутствие в учетной записи. Чтобы отметить окончание состояния простоя, планировщик задач изменяет потребление ресурсов через 90 минут.

## <a name="defining-an-idle-trigger"></a>Определение триггера Idle

Задача может быть запущена, когда компьютер переходит в состояние простоя путем определения триггера Idle.

Триггер простоя активирует действие задачи, только если компьютер переходит в состояние простоя после начальной границы триггера.

Приложение может определить триггер простоя с помощью интерфейса [**иидлетригжер**](/windows/win32/api/taskschd/nn-taskschd-iidletrigger) .

При чтении или записи XML-кода триггер простоя задается элементом [**идлетригжер**](taskschedulerschema-idletrigger-triggergroup-element.md) схемы планировщик задач.

## <a name="task-settings-for-idle-conditions"></a>Параметры задачи для условий простоя

Параметры задачи можно использовать для определения того, как планировщик задач обрабатывает задачу, когда компьютер переходит в состояние простоя.

На следующих иллюстрациях представлены три возможные временные шкалы, которые показывают, как разные условия простоя связаны друг с другом. Имейте в виду, что иллюстрации запускаются при активации триггера задачи или при запуске задачи по требованию (без запроса на [игнорирование существующих ограничений задач](/windows/win32/api/taskschd/ne-taskschd-task_run_flags)).

> [!NOTE]
> Параметры *Duration* и *ваиттимеаут* являются устаревшими. Они по-прежнему находятся в пользовательском интерфейсе планировщик задач, а методы интерфейса по-прежнему могут возвращать допустимые значения, но они больше не используются.

![Временная шкала условий простоя](images/idle-conditions2.png)

В следующем списке описываются условия простоя.
- Запуск при простое: время, когда компьютер переходит в состояние простоя.
- Конец бездействия: время, когда компьютер переходит из состояния простоя. Имейте в виду, что количество времени, в течение которого компьютер находится в состоянии простоя, не зависит от времени простоя, описанного ранее.

Ожидание бездействия и длительность простоя устарели.
- Ожидание простоя: время, в течение которого планировщик задач будет ожидать наступления состояния простоя после активации триггера задачи или после запуска задачи по требованию.
- Длительность простоя: время, в течение которого компьютер должен быть бездействует перед запуском задачи.

Например, если задача настроена на запуск только в том случае, если компьютер бездействует 30 минут, а задача ожидает бездействия компьютера в течение 10 минут, то задача будет запущена через 5 минут только в том случае, если компьютер бездействует через 25 минут до момента активации триггера. Задача не запускается, если компьютер переходит в состояние простоя через 5 минут после активации триггера.

По умолчанию для свойства [**дисалловстартифонбаттериес**](/windows/desktop/api/taskschd/nf-taskschd-itasksettings-get_disallowstartifonbatteries) задачи задано значение true, то есть служба Планировщик задач не будет выполнять задачи, активируемые триггером Idle (или триггером с условиями простоя), когда компьютер работает от аккумулятора. Это поведение можно изменить, задав для свойства **дисалловстартифонбаттериес** значение false.

Если задача запускается триггером Idle, свойство [**ваиттимеаут**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_waittimeout) интерфейса [**иидлесеттингс**](/windows/desktop/api/taskschd/nn-taskschd-iidlesettings) ([**идлесеттингс**](idlesettings.md) для скриптов) игнорируется.

Приложения могут управлять условиями простоя, задавая свойства в интерфейсах [**иидлесеттингс**](/windows/desktop/api/taskschd/nn-taskschd-iidlesettings) и [**иидлетригжер**](/windows/win32/api/taskschd/nn-taskschd-iidletrigger) .

При чтении или записи XML эти условия задаются в элементе [**Settings**](taskschedulerschema-settings-tasktype-element.md) схемы планировщик задач.

## <a name="cycling-idle-condition"></a>Условие циклического простоя

Если компьютер переключается в состояние простоя и выходит из него, можно завершить и перезапустить задачу, используя следующие условия простоя. Для завершения и перезапуска задачи оба свойства и элемента должны быть установлены в значение true:

-   Чтобы завершить задачу при завершении условия простоя, задайте для свойства [**стопонидлинд**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_stoponidleend) или элемента [**стопонидлинд**](taskschedulerschema-terminateonidleend-idlesettingstype-element.md) значение true.
-   Чтобы перезапустить задачу, когда компьютер снова перейдет в состояние простоя, задайте для свойства [**рестартонидле**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_restartonidle) или элемента [**рестартонидле**](taskschedulerschema-restartonidle-idlesettingstype-element.md) значение true.
