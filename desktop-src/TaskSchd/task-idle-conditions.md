---
title: Условия простоя задачи
description: Задача может быть обработана несколькими способами, когда компьютер переходит в состояние простоя. Это включает определение триггера Idle или задание условий простоя для запуска задачи.
ms.assetid: 1e480681-b77a-48fe-a732-dd1591eaa08d
keywords:
- условия простоя планировщик задач
- условия бездействия планировщик задач, обсуждение
- Создание триггеров бездействия планировщик задач
- триггеры бездействия планировщик задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 501be9b73e3ec355b998697fb5e87c5163224b71
ms.sourcegitcommit: 857e701bbd35004661bb047e1f24622af9ff1dd7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2020
ms.locfileid: "103797149"
---
# <a name="task-idle-conditions"></a><span data-ttu-id="fb7e1-108">Условия простоя задачи</span><span class="sxs-lookup"><span data-stu-id="fb7e1-108">Task idle conditions</span></span>

<span data-ttu-id="fb7e1-109">Задача может быть обработана несколькими способами, когда компьютер переходит в состояние простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-109">A task can be handled in several ways when the computer enters an idle state.</span></span> <span data-ttu-id="fb7e1-110">Это включает определение триггера Idle или задание условий простоя для запуска задачи.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-110">This includes defining an idle trigger or setting the idle conditions for when the task starts.</span></span>

## <a name="detecting-the-idle-state"></a><span data-ttu-id="fb7e1-111">Обнаружение состояния простоя</span><span class="sxs-lookup"><span data-stu-id="fb7e1-111">Detecting the idle state</span></span>

<span data-ttu-id="fb7e1-112">В Windows 7 планировщик задач проверяет, что компьютер находится в состоянии простоя каждые 15 минут.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-112">In Windows 7, the Task Scheduler verifies that the computer is in an idle state every 15 minutes.</span></span> <span data-ttu-id="fb7e1-113">Планировщик задач проверяет состояние простоя, используя два критерия: отсутствие пользователя и отсутствие потребления ресурсов.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-113">Task Scheduler checks for an idle state using two criteria: user absence, and a lack of resource consumption.</span></span> <span data-ttu-id="fb7e1-114">Пользователь считается отсутствующим, если в этот период времени нет ввода с клавиатуры или мыши.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-114">The user is considered absent if there is no keyboard or mouse input during this period of time.</span></span> <span data-ttu-id="fb7e1-115">Компьютер считается неактивным, если все процессоры и все диски были бездействующими в течение более чем 90% времени последнего интервала обнаружения.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-115">The computer is considered idle if all the processors and all the disks were idle for more than 90% of the last detection interval.</span></span> <span data-ttu-id="fb7e1-116">(Исключением может быть любое приложение типа Presentation, устанавливающее \_ ОТОБРАЗИТЬ \_ необходимый флаг.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-116">(An exception would be for any presentation type application that sets the ES\_DISPLAY\_REQUIRED flag.</span></span> <span data-ttu-id="fb7e1-117">Этот флаг заставляет расписание задач не считать систему бездействующей, независимо от активности пользователей или потребления ресурсов.)</span><span class="sxs-lookup"><span data-stu-id="fb7e1-117">This flag forces Task Schedule to not consider the system as being idle, regardless of user activity or resource consumption.)</span></span>

<span data-ttu-id="fb7e1-118">В Windows 7 планировщик задач рассматривает процессор как бездействующий, даже если выполняются потоки с низким приоритетом (приоритет потока < нормальная).</span><span class="sxs-lookup"><span data-stu-id="fb7e1-118">In Windows 7, Task Scheduler considers a processor as idle even when low priority threads (thread priority < normal) execute.</span></span>

<span data-ttu-id="fb7e1-119">В Windows 7, когда планировщик задач обнаруживает, что компьютер находится в режиме бездействия, служба ожидает, что только входные данные пользователя помечают окончание состояния простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-119">In Windows 7, when the Task Scheduler detects that the computer is idle, the service waits only for user input to mark the end of the idle state.</span></span>

<span data-ttu-id="fb7e1-120">В Windows 8 планировщик задач выполняет те же общие проверки отсутствия и потребления ресурсов пользователя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-120">In Windows 8, Task Scheduler performs the same general user absence and resource consumption checks.</span></span> <span data-ttu-id="fb7e1-121">Однако планировщик задач полагается на подсистему питания операционной системы для обнаружения присутствия пользователя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-121">However, Task Scheduler relies on the operating system power subsystem to detect user presence.</span></span> <span data-ttu-id="fb7e1-122">По умолчанию пользователь считается отсутствующим по истечении четырех минут без ввода с клавиатуры или с помощью мыши.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-122">By default, the user is considered absent after four minutes of no keyboard or mouse input.</span></span> <span data-ttu-id="fb7e1-123">Время проверки потребления ресурсов сокращается до 10 минут, когда пользователь представлен.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-123">The resource consumption verification time is shortened to 10 minute intervals when the user is present.</span></span> <span data-ttu-id="fb7e1-124">При отсутствии пользователя время проверки сокращается до 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-124">When the user is away, the verification time is shortened to 30 second intervals.</span></span> <span data-ttu-id="fb7e1-125">Планировщик задач выполняет дополнительные проверки потребления ресурсов для следующих событий:</span><span class="sxs-lookup"><span data-stu-id="fb7e1-125">Task Scheduler makes additional resource consumption checks for the following events:</span></span>

-   <span data-ttu-id="fb7e1-126">Состояние присутствия пользователя изменено</span><span class="sxs-lookup"><span data-stu-id="fb7e1-126">User presence state changed</span></span>
-   <span data-ttu-id="fb7e1-127">Источник питания AC/DC изменен</span><span class="sxs-lookup"><span data-stu-id="fb7e1-127">AC/DC power source changed</span></span>
-   <span data-ttu-id="fb7e1-128">Уровень аккумулятора изменен (только при питании от батарей)</span><span class="sxs-lookup"><span data-stu-id="fb7e1-128">Battery level changed (only when on batteries)</span></span>

<span data-ttu-id="fb7e1-129">Когда происходит любое из приведенных выше событий, планировщик задач проверяет компьютер для время простоя с момента последней проверки.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-129">When any of the events above happens, Task Scheduler tests the computer for idleness since the last verification time.</span></span> <span data-ttu-id="fb7e1-130">На практике это означает, что планировщик задач может объявить систему как бездействие немедленно после обнаружения отсутствия пользователя, если другие условия были выполнены с момента последней проверки.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-130">In practice, this means that Task Scheduler may declare the system as idle immediately after user absence is detected, if the other conditions have been met since the last verification time.</span></span>

<span data-ttu-id="fb7e1-131">В Windows 8 пороговые значения ЦП и ввода-вывода задаются равными 80%.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-131">In Windows 8, the CPU and IO thresholds are set to 80%.</span></span>

<span data-ttu-id="fb7e1-132">При обнаружении состояния простоя в Windows 8 Server планировщик задач не учитывает присутствие пользователя или его отсутствие в учетной записи.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-132">When detecting the idle state in Windows 8 Server, Task Scheduler does not take user presence or absence into account.</span></span> <span data-ttu-id="fb7e1-133">Чтобы отметить окончание состояния простоя, планировщик задач изменяет потребление ресурсов через 90 минут.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-133">To mark the end of the idle state, Task Scheduler revises the resource consumption once in 90 minutes.</span></span>

## <a name="defining-an-idle-trigger"></a><span data-ttu-id="fb7e1-134">Определение триггера Idle</span><span class="sxs-lookup"><span data-stu-id="fb7e1-134">Defining an idle trigger</span></span>

<span data-ttu-id="fb7e1-135">Задача может быть запущена, когда компьютер переходит в состояние простоя путем определения триггера Idle.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-135">A task can be started when the computer enters an idle state by defining an idle trigger.</span></span>

<span data-ttu-id="fb7e1-136">Триггер простоя активирует действие задачи, только если компьютер переходит в состояние простоя после начальной границы триггера.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-136">An idle trigger will only trigger a task action if the computer enters an idle state after the start boundary of the trigger.</span></span>

<span data-ttu-id="fb7e1-137">Приложение может определить триггер простоя с помощью интерфейса [**иидлетригжер**](/windows/win32/api/taskschd/nn-taskschd-iidletrigger) .</span><span class="sxs-lookup"><span data-stu-id="fb7e1-137">An application can define an idle trigger by using the [**IIdleTrigger**](/windows/win32/api/taskschd/nn-taskschd-iidletrigger) interface.</span></span>

<span data-ttu-id="fb7e1-138">При чтении или записи XML-кода триггер простоя задается элементом [**идлетригжер**](taskschedulerschema-idletrigger-triggergroup-element.md) схемы планировщик задач.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-138">If reading or writing XML, the idle trigger is specified by the [**IdleTrigger**](taskschedulerschema-idletrigger-triggergroup-element.md) element of the Task Scheduler schema.</span></span>

## <a name="task-settings-for-idle-conditions"></a><span data-ttu-id="fb7e1-139">Параметры задачи для условий простоя</span><span class="sxs-lookup"><span data-stu-id="fb7e1-139">Task settings for idle conditions</span></span>

<span data-ttu-id="fb7e1-140">Параметры задачи можно использовать для определения того, как планировщик задач обрабатывает задачу, когда компьютер переходит в состояние простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-140">The task settings can be used to define how the Task Scheduler handles the task when the computer enters an idle state.</span></span>

<span data-ttu-id="fb7e1-141">На следующих иллюстрациях представлены три возможные временные шкалы, которые показывают, как разные условия простоя связаны друг с другом.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-141">The following illustrations provide three possible timelines that show how these different idle conditions relate to each other.</span></span> <span data-ttu-id="fb7e1-142">Имейте в виду, что иллюстрации запускаются при активации триггера задачи или при запуске задачи по требованию (без запроса на [игнорирование существующих ограничений задач](/windows/win32/api/taskschd/ne-taskschd-task_run_flags)).</span><span class="sxs-lookup"><span data-stu-id="fb7e1-142">Be aware that the illustrations start when the task trigger is activated or when the task is started on demand (without requesting to [ignore the existing task constraints](/windows/win32/api/taskschd/ne-taskschd-task_run_flags)).</span></span>

> [!NOTE]
> <span data-ttu-id="fb7e1-143">Параметры *Duration* и *ваиттимеаут* являются устаревшими.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-143">The *Duration* and *WaitTimeout* settings are deprecated.</span></span> <span data-ttu-id="fb7e1-144">Они по-прежнему находятся в пользовательском интерфейсе планировщик задач, а методы интерфейса по-прежнему могут возвращать допустимые значения, но они больше не используются.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-144">They're still present in the Task Scheduler user interface, and their interface methods may still return valid values, but they're no longer used.</span></span>

![Временная шкала условий простоя](images/idle-conditions2.png)

<span data-ttu-id="fb7e1-146">В следующем списке описываются условия простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-146">The following list describes the idle conditions.</span></span>
- <span data-ttu-id="fb7e1-147">Запуск при простое: время, когда компьютер переходит в состояние простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-147">Idle start: The time when the computer enters the idle state.</span></span>
- <span data-ttu-id="fb7e1-148">Конец бездействия: время, когда компьютер переходит из состояния простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-148">Idle end: The time when the computer transitions out of the idle state.</span></span> <span data-ttu-id="fb7e1-149">Имейте в виду, что количество времени, в течение которого компьютер находится в состоянии простоя, не зависит от времени простоя, описанного ранее.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-149">Be aware that the amount of time the computer is in the idle state is independent of the idle duration time that was described previously.</span></span>

<span data-ttu-id="fb7e1-150">Ожидание бездействия и длительность простоя устарели.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-150">Idle wait and Idle duration have been deprecated.</span></span>
- <span data-ttu-id="fb7e1-151">Ожидание простоя: время, в течение которого планировщик задач будет ожидать наступления состояния простоя после активации триггера задачи или после запуска задачи по требованию.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-151">Idle wait: The amount of time that the Task Scheduler will wait for an idle state to occur after a task trigger is activated or after the task is started on demand.</span></span>
- <span data-ttu-id="fb7e1-152">Длительность простоя: время, в течение которого компьютер должен быть бездействует перед запуском задачи.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-152">Idle duration: The amount of time you want the computer to have been idle before starting the task.</span></span>

<span data-ttu-id="fb7e1-153">Например, если задача настроена на запуск только в том случае, если компьютер бездействует 30 минут, а задача ожидает бездействия компьютера в течение 10 минут, то задача будет запущена через 5 минут только в том случае, если компьютер бездействует через 25 минут до момента активации триггера.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-153">For example, if a task is set to start only if the computer is idle for 30 minutes, and the task waits for the computer to be idle for 10 minutes, then the task will launch in 5 minutes only if the computer has been idle for 25 minutes prior to the time the trigger was activated.</span></span> <span data-ttu-id="fb7e1-154">Задача не запускается, если компьютер переходит в состояние простоя через 5 минут после активации триггера.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-154">The task will not start if the computer enters an idle state 5 minutes after the trigger is activated.</span></span>

<span data-ttu-id="fb7e1-155">По умолчанию для свойства [**дисалловстартифонбаттериес**](/windows/desktop/api/taskschd/nf-taskschd-itasksettings-get_disallowstartifonbatteries) задачи задано значение true, то есть служба Планировщик задач не будет выполнять задачи, активируемые триггером Idle (или триггером с условиями простоя), когда компьютер работает от аккумулятора.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-155">By default, a task [**DisallowStartIfOnBatteries**](/windows/desktop/api/taskschd/nf-taskschd-itasksettings-get_disallowstartifonbatteries) property is set to true, which means the Task Scheduler service will not run tasks that are triggered by an idle trigger (or a trigger with idle conditions) when a computer is running on battery power.</span></span> <span data-ttu-id="fb7e1-156">Это поведение можно изменить, задав для свойства **дисалловстартифонбаттериес** значение false.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-156">You can change this behavior by setting the **DisallowStartIfOnBatteries** property to false.</span></span>

<span data-ttu-id="fb7e1-157">Если задача запускается триггером Idle, свойство [**ваиттимеаут**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_waittimeout) интерфейса [**иидлесеттингс**](/windows/desktop/api/taskschd/nn-taskschd-iidlesettings) ([**идлесеттингс**](idlesettings.md) для скриптов) игнорируется.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-157">If a task is triggered by an idle trigger, then the [**WaitTimeout**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_waittimeout) property of the [**IIdleSettings**](/windows/desktop/api/taskschd/nn-taskschd-iidlesettings) interface ([**IdleSettings**](idlesettings.md) for scripting) is ignored.</span></span>

<span data-ttu-id="fb7e1-158">Приложения могут управлять условиями простоя, задавая свойства в интерфейсах [**иидлесеттингс**](/windows/desktop/api/taskschd/nn-taskschd-iidlesettings) и [**иидлетригжер**](/windows/win32/api/taskschd/nn-taskschd-iidletrigger) .</span><span class="sxs-lookup"><span data-stu-id="fb7e1-158">Applications can control the idle conditions by setting the properties in the [**IIdleSettings**](/windows/desktop/api/taskschd/nn-taskschd-iidlesettings) and [**IIdleTrigger**](/windows/win32/api/taskschd/nn-taskschd-iidletrigger) interfaces.</span></span>

<span data-ttu-id="fb7e1-159">При чтении или записи XML эти условия задаются в элементе [**Settings**](taskschedulerschema-settings-tasktype-element.md) схемы планировщик задач.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-159">If reading or writing XML, these conditions are specified in the [**Settings**](taskschedulerschema-settings-tasktype-element.md) element of the Task Scheduler schema.</span></span>

## <a name="cycling-idle-condition"></a><span data-ttu-id="fb7e1-160">Условие циклического простоя</span><span class="sxs-lookup"><span data-stu-id="fb7e1-160">Cycling idle condition</span></span>

<span data-ttu-id="fb7e1-161">Если компьютер переключается в состояние простоя и выходит из него, можно завершить и перезапустить задачу, используя следующие условия простоя.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-161">If the computer is cycling in and out of the idle state, you can terminate and restart the task using the following idle conditions.</span></span> <span data-ttu-id="fb7e1-162">Для завершения и перезапуска задачи оба свойства и элемента должны быть установлены в значение true:</span><span class="sxs-lookup"><span data-stu-id="fb7e1-162">To terminate and restart a task, both properties and elements must be set to True:</span></span>

-   <span data-ttu-id="fb7e1-163">Чтобы завершить задачу при завершении условия простоя, задайте для свойства [**стопонидлинд**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_stoponidleend) или элемента [**стопонидлинд**](taskschedulerschema-terminateonidleend-idlesettingstype-element.md) значение true.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-163">To terminate the task when the idle condition ends, set the [**StopOnIdleEnd**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_stoponidleend) property or the [**StopOnIdleEnd**](taskschedulerschema-terminateonidleend-idlesettingstype-element.md) element to True.</span></span>
-   <span data-ttu-id="fb7e1-164">Чтобы перезапустить задачу, когда компьютер снова перейдет в состояние простоя, задайте для свойства [**рестартонидле**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_restartonidle) или элемента [**рестартонидле**](taskschedulerschema-restartonidle-idlesettingstype-element.md) значение true.</span><span class="sxs-lookup"><span data-stu-id="fb7e1-164">To restart the task when the computer cycles into the idle condition again, set the [**RestartOnIdle**](/windows/desktop/api/taskschd/nf-taskschd-iidlesettings-get_restartonidle) property or the [**RestartOnIdle**](taskschedulerschema-restartonidle-idlesettingstype-element.md) element to True.</span></span>
