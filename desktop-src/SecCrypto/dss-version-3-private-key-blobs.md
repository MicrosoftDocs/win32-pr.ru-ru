---
description: Описывает формат экспортированного закрытого ключа DSS версии 3.
ms.assetid: 650532fd-919b-495a-9fb9-981790447d3d
title: BLOB-объекты закрытого ключа DSS версии 3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7a6434e411ba3268901176a5c9739ceecfa79689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264476"
---
# <a name="dss-version-3-private-key-blobs"></a>BLOB-объекты закрытого ключа DSS версии 3

При экспорте [*закрытого ключа*](../secgloss/p-gly.md) [*DSS*](../secgloss/d-gly.md) версии 3 он имеет следующий формат:


```C++
BLOBHEADER        blobheader; 
DSSPRIVKEY_VER3   dssprivkeyver3;
BYTE p[dssprivkeyver3.bitlenP/8]; 
                    // Where P is the prime modulus
BYTE q[dssprivkeyver3.bitlenQ/8]; 
                    // Where Q is a large factor of P-1
BYTE g[dssprivkeyver3.bitlenP/8]; 
                    // Where G is the generator parameter
BYTE j[dssprivkeyver3.bitlenJ/8]; 
                    // Where J is (P-1)/Q
BYTE y[dssprivkeyver3.bitlenP/8]; 
                    // Where Y is (G^X) mod P
BYTE x[dssprivkeyver3.bitlenX/8]; 
                    // Where X is the private exponent
```



Этот формат [*большого двоичного объекта*](../secgloss/b-gly.md) экспортируется, когда \_ флаг шифрования BLOB \_ -объекта VER3 используется с [**криптекспорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey). Так как версия находится в большом двоичном объекте, нет необходимости указывать флаг при использовании этого большого двоичного объекта с [**криптимпорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey).

В следующей таблице описаны все компоненты [*большого двоичного объекта ключа*](../secgloss/k-gly.md).



| Поле          | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| блобхеадер     | Структура [**блобхеадер**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) . Элемент **бтипе** должен иметь значение публиккэйблоб.                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Dssprivkeyver3 | Структура **\_ VER3 дсспривкэй** . Для элемента **Magic** необходимо задать значение "DSS4" (0x34535344) для закрытых ключей. Обратите внимание, что шестнадцатеричное значение — это просто кодировка [*ASCII*](../secgloss/a-gly.md) "DSS4".<br/>                                                                                                                                                                                                                                                                     |
| С              | Значение P размещается непосредственно после структуры **дсспривкэй \_ VER3** и всегда должно быть длиной в байтах поля **дсспривкэй \_ VER3 Битленп** (разрядная длина P), разделенной на 8 (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ).                                                                                                                                                                                                                           |
| Q              | Значение Q находится непосредственно после значения P и всегда должно быть длиной в байтах поля **дсспривкэй \_ VER3 битленк** , разделенного на восемь (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ).                                                                                                                                                                                                                                                                     |
| G              | Значение G расположено непосредственно после значения Q и всегда должно быть длиной (в байтах) поля **дсспривкэй \_ VER3 битленп** (разрядная длина P), деленная на восемь. Если длина данных равна одному или нескольким байтам, меньшим, чем P, деленному на 8, то данные должны быть дополнены требуемыми байтами (нулевыми значениями), чтобы данные были требуемой длины (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ).                                                                 |
| J              | Значение J находится непосредственно после значения G и всегда должно быть длиной в байтах поля **дсспривкэй \_ VER3 битленж** , разделенного на восемь (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ). Если значение Битленж равно 0, то значение отсутствует в большом двоичном объекте.                                                                                                                                                                                                   |
| Да              | Значение Y (G ^ X) mod P находится непосредственно после значения J и всегда должно быть длиной (в байтах) поля **дсспривкэй \_ VER3 битленп** (разрядная длина P), деленная на восемь. Если длина данных, полученная в результате вычисления (G ^ X) mod P, равна одному или более байтам, меньшим, чем P, то данные должны быть дополнены требуемыми байтами (нулевыми значениями), чтобы данные были требуемой длины (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ). |
| X              | Значение X является случайным целым числом, таким образом, что открытая часть пары ключей Диффи-Хелмана, Y, равна: Y = (G ^ X) mod P<br/>                                                                                                                                                                                                                                                                                                                                                                                               |



 

При вызове [**криптекспорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey)разработчик может выбрать, следует ли шифровать ключ. Ключ шифруется, если параметр *хекспкэй* содержит допустимый маркер для ключа сеанса. Все, кроме [**блобхеадер**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) части большого двоичного объекта, шифруется. Обратите внимание, что алгоритм шифрования и параметры ключа шифрования не хранятся вместе с [*BLOB-объектом закрытого ключа*](../secgloss/p-gly.md). Приложение должно управлять и хранить эти сведения. Если для *хекспкэй* передается ноль, закрытый ключ будет экспортирован без шифрования.

> [!IMPORTANT]
> Экспортировать закрытые ключи без шифрования небезопасно, так как они уязвимы для перехвата и использования неавторизованными сущностями.

 

 

 
