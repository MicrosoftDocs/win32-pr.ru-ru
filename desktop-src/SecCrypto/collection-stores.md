---
description: По мере роста числа сертификатов, списков отзыва сертификатов (CRL) и списка доверия сертификатов (CTL) в коллекции пользователей Организация этих сертификатов становится проблемой.
ms.assetid: 13e7e077-e8be-4ba4-99e1-08421fd2452e
title: Хранилища коллекций
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5bfeb8ef071d7a5ccf6bc7ce43ba418117879536
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911776"
---
# <a name="collection-stores"></a><span data-ttu-id="16a0a-103">Хранилища коллекций</span><span class="sxs-lookup"><span data-stu-id="16a0a-103">Collection Stores</span></span>

<span data-ttu-id="16a0a-104">По мере роста числа [*сертификатов*](../secgloss/c-gly.md), [*списков отзыва сертификатов*](../secgloss/c-gly.md) (CRL) и [*списка доверия сертификатов*](../secgloss/c-gly.md) (CTL) в коллекции пользователей Организация этих сертификатов становится проблемой.</span><span class="sxs-lookup"><span data-stu-id="16a0a-104">As the number of [*certificates*](../secgloss/c-gly.md), [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs), and [*certificate trust list*](../secgloss/c-gly.md) (CTLs) in a user's collection grows, the organization of those certificates becomes an issue.</span></span> <span data-ttu-id="16a0a-105">Одним из возможных решений является создание отдельных хранилищ сертификатов для хранения разных типов сертификатов.</span><span class="sxs-lookup"><span data-stu-id="16a0a-105">One possible solution is to create separate certificate stores to keep different kinds of certificates.</span></span> <span data-ttu-id="16a0a-106">Это решение создает новую проблему, так как приложению может потребоваться выполнить поиск по нескольким разным магазинам, чтобы найти конкретный сертификат.</span><span class="sxs-lookup"><span data-stu-id="16a0a-106">This solution creates a new problem because an application might need to search several different stores to find a specific certificate.</span></span> <span data-ttu-id="16a0a-107">Эта проблема решается с помощью логических хранилищ или хранилища коллекций.</span><span class="sxs-lookup"><span data-stu-id="16a0a-107">The use of logical or collection stores solves this problem.</span></span>

<span data-ttu-id="16a0a-108">[*Логическое хранилище*](../secgloss/l-gly.md) и хранилище сертификатов коллекции — это группы физических хранилищ, которые отображаются в приложении как единое хранилище.</span><span class="sxs-lookup"><span data-stu-id="16a0a-108">A [*logical store*](../secgloss/l-gly.md) and a collection certificate store are groups of physical stores that appears to an application as a single store.</span></span> <span data-ttu-id="16a0a-109">Для всех хранилищ элементов в логическом хранилище или хранилища коллекции можно выполнить поиск или перечислить с помощью одного вызова функции либо [**цертфиндцертификатеинсторе**](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcertificateinstore) , либо [**цертенумцертификатесинсторе**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatesinstore).</span><span class="sxs-lookup"><span data-stu-id="16a0a-109">All member stores of a logical or collection store can be searched or enumerated with a single function call to either [**CertFindCertificateInStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcertificateinstore) or [**CertEnumCertificatesInStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatesinstore).</span></span>

<span data-ttu-id="16a0a-110">Использование логических хранилищ и хранилища коллекций также обеспечивает гибкость, которую трудно достичь с помощью бумажных записей.</span><span class="sxs-lookup"><span data-stu-id="16a0a-110">The use of logical or collection stores also provides flexibility that is difficult to achieve with paper records.</span></span> <span data-ttu-id="16a0a-111">Сертификат в одном физическом хранилище может быть членом нескольких разных логических групп.</span><span class="sxs-lookup"><span data-stu-id="16a0a-111">A certificate in a single physical store might need to be a member of several different logical groups.</span></span> <span data-ttu-id="16a0a-112">Таким образом, отдельное физическое хранилище может быть членом нескольких логических хранилищ или хранилищем коллекций, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="16a0a-112">Therefore, an individual physical store can be a member of more than one logical or collection store as shown in the following illustration.</span></span>

![хранилища коллекций](images/mancert.png)

<span data-ttu-id="16a0a-114">На этом рисунке представлены следующие основные понятия хранилища логических сертификатов:</span><span class="sxs-lookup"><span data-stu-id="16a0a-114">This illustration presents the following basic, logical certificate store concepts:</span></span>

-   <span data-ttu-id="16a0a-115">Хранилище сертификатов коллекции имеет указатель на первый блок указателя для этого хранилища коллекции.</span><span class="sxs-lookup"><span data-stu-id="16a0a-115">A collection certificate store has a pointer to the first pointer block for that collection store.</span></span>
-   <span data-ttu-id="16a0a-116">Каждый блок указателя в хранилище коллекции имеет указатель на родственное хранилище и указатель на следующий блок указателя коллекции.</span><span class="sxs-lookup"><span data-stu-id="16a0a-116">Each pointer block of a collection store has a pointer to a sibling store and a pointer to the next pointer block of the collection.</span></span>
-   <span data-ttu-id="16a0a-117">Каждое хранилище одного уровня в коллекции является простым физическим хранилищем сертификатов.</span><span class="sxs-lookup"><span data-stu-id="16a0a-117">Each sibling store in a collection is a simple physical certificate store.</span></span>
-   <span data-ttu-id="16a0a-118">Простое хранилище сертификатов может быть одноэлементным хранилищем элементов во многих разных хранилищах коллекций.</span><span class="sxs-lookup"><span data-stu-id="16a0a-118">A simple certificate store can be a member sibling store in many different collection stores.</span></span>
-   <span data-ttu-id="16a0a-119">Сертификаты, добавленные в хранилище коллекции, физически добавляются в одно из одноуровневого хранилища в коллекции.</span><span class="sxs-lookup"><span data-stu-id="16a0a-119">Certificates added to a collection store are physically added to one of the sibling stores in the collection.</span></span>
-   <span data-ttu-id="16a0a-120">Сертификаты в хранилище одного уровня могут быть доступны любому хранилищу, в котором входит одноуровневый магазин.</span><span class="sxs-lookup"><span data-stu-id="16a0a-120">Certificates in a sibling store can be accessed by any collection store in which the sibling store is a member.</span></span>

<span data-ttu-id="16a0a-121">Хранилища коллекций создаются в приложении путем открытия хранилища коллекции с помощью [**цертопенсторе**](/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore) и последующего использования [**цертаддсторетоколлектион**](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddstoretocollection) для добавления в хранилище коллекции открытого одноуровневого хранилища.</span><span class="sxs-lookup"><span data-stu-id="16a0a-121">Collection stores are built within an application by opening a collection store by using [**CertOpenStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore) and then using [**CertAddStoreToCollection**](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddstoretocollection) to add an open sibling store to the collection store.</span></span> <span data-ttu-id="16a0a-122">Хранилище с общим родителем можно удалить из хранилища коллекции, вызвав [**цертремовесторефромколлектион**](/windows/desktop/api/Wincrypt/nf-wincrypt-certremovestorefromcollection).</span><span class="sxs-lookup"><span data-stu-id="16a0a-122">A sibling store can be deleted from a collection store by calling [**CertRemoveStoreFromCollection**](/windows/desktop/api/Wincrypt/nf-wincrypt-certremovestorefromcollection).</span></span>

 

 
