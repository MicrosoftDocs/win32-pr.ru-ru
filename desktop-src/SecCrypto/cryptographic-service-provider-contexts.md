---
description: Первая функция CryptoAPI, вызываемая приложением, использующей любые API-интерфейсы шифрования, — это функция CryptAcquireContext.
ms.assetid: ad1ff45c-7d02-431b-a287-e9db765476ce
title: Контексты поставщика служб шифрования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df20df528b0ba0c385c7ab690436351d918f1521
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144476"
---
# <a name="cryptographic-service-provider-contexts"></a><span data-ttu-id="66892-103">Контексты поставщика служб шифрования</span><span class="sxs-lookup"><span data-stu-id="66892-103">Cryptographic Service Provider Contexts</span></span>

<span data-ttu-id="66892-104">Первая функция [*CryptoAPI*](../secgloss/c-gly.md) , вызываемая приложением, использующей любые API-интерфейсы шифрования, — это функция [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) .</span><span class="sxs-lookup"><span data-stu-id="66892-104">The first [*CryptoAPI*](../secgloss/c-gly.md) function called by an application that uses any cryptographic APIs is the [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) function.</span></span> <span data-ttu-id="66892-105">Эта функция возвращает маркер для конкретного CSP, который включает спецификацию определенного [*контейнера ключей*](../secgloss/k-gly.md) в CSP.</span><span class="sxs-lookup"><span data-stu-id="66892-105">This function returns a handle to a particular CSP which includes the specification of a particular [*key container*](../secgloss/k-gly.md) within the CSP.</span></span> <span data-ttu-id="66892-106">Этот контейнер ключей является либо специально запрошенным контейнером ключей, либо контейнером ключей по умолчанию для текущего пользователя, вошедшего в систему.</span><span class="sxs-lookup"><span data-stu-id="66892-106">This key container is either a specifically requested key container or it is the default key container for the currently logged-on user.</span></span>

<span data-ttu-id="66892-107">[**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) также может создать новый контейнер ключей.</span><span class="sxs-lookup"><span data-stu-id="66892-107">[**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) can also create a new key container.</span></span> <span data-ttu-id="66892-108">Дополнительные сведения см. в разделе [Пример программы C: создание контейнера ключей и создание ключей](example-c-program-creating-a-key-container-and-generating-keys.md) и [Пример программы C: использование CryptAcquireContext](example-c-program-using-cryptacquirecontext.md).</span><span class="sxs-lookup"><span data-stu-id="66892-108">For more information, see [Example C Program: Creating a Key Container and Generating Keys](example-c-program-creating-a-key-container-and-generating-keys.md) and [Example C Program: Using CryptAcquireContext](example-c-program-using-cryptacquirecontext.md).</span></span>

<span data-ttu-id="66892-109">[*Поставщик служб шифрования*](../secgloss/c-gly.md) (CSP) имеет как имя, так и тип.</span><span class="sxs-lookup"><span data-stu-id="66892-109">A [*cryptographic service provider*](../secgloss/c-gly.md) (CSP) has both a name and a type.</span></span> <span data-ttu-id="66892-110">Например, имя одного из CSP, поставляемое в настоящее время с операционной системой, — [базовый поставщик служб шифрования Майкрософт](microsoft-base-cryptographic-provider.md).</span><span class="sxs-lookup"><span data-stu-id="66892-110">For example, the name of one of the CSPs currently shipped with the operating system is [Microsoft Base Cryptographic Provider](microsoft-base-cryptographic-provider.md).</span></span> <span data-ttu-id="66892-111">Это Prov поставщик [ \_ \_ полных типов RSA](prov-rsa-full.md) .</span><span class="sxs-lookup"><span data-stu-id="66892-111">It is a [PROV\_RSA\_FULL](prov-rsa-full.md) type provider.</span></span> <span data-ttu-id="66892-112">Имя каждого поставщика является уникальным; Тип поставщика — not.</span><span class="sxs-lookup"><span data-stu-id="66892-112">The name of each provider is unique; the provider type is not.</span></span>

<span data-ttu-id="66892-113">Когда приложение вызывает [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) для получения обработчика CSP, оно указывает тип поставщика и, при необходимости, имя поставщика.</span><span class="sxs-lookup"><span data-stu-id="66892-113">When an application calls [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) to obtain a CSP handle, it specifies a provider type and, optionally, a provider name.</span></span> <span data-ttu-id="66892-114">Если указаны и тип, и имя, функция загружает CSP с соответствующим типом поставщика и именем поставщика.</span><span class="sxs-lookup"><span data-stu-id="66892-114">If both a type and a name are specified, the function loads the CSP with the matching provider type and provider name.</span></span> <span data-ttu-id="66892-115">Функция возвращает маркер CSP, который предоставляет доступ к CSP и [*контейнеру ключей*](../secgloss/k-gly.md) в CSP.</span><span class="sxs-lookup"><span data-stu-id="66892-115">The function returns the CSP's handle which provides access to both the CSP and to a [*key container*](../secgloss/k-gly.md) within the CSP.</span></span>

<span data-ttu-id="66892-116">Когда приложение вызывает [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) и указывает тип поставщика, но не имеет имени поставщика, функция ищет именованного поставщика, сначала проверяет список именованных поставщиков по умолчанию, связанных с вошедшим в систему пользователем, и, если это происходит, из списка именованных поставщиков по умолчанию, связанных с компьютером.</span><span class="sxs-lookup"><span data-stu-id="66892-116">When an application calls [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) and specifies a provider type but no provider name, the function looks for a named provider, first checking a list of default named providers associated with the logged-on user and, if that fails, from a list of default named providers associated with the computer.</span></span> <span data-ttu-id="66892-117">После определения имени поставщика функция **CryptAcquireContext** ищет CSP для этого поставщика, загружает его и возвращает его обработчик.</span><span class="sxs-lookup"><span data-stu-id="66892-117">After the provider name has been determined, the **CryptAcquireContext** function searches for the CSP for that provider, loads it, and returns its handle.</span></span>

<span data-ttu-id="66892-118">После завершения использования обработчика CSP выпустите его, вызвав функцию [**криптрелеасеконтекст**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptreleasecontext) .</span><span class="sxs-lookup"><span data-stu-id="66892-118">When you have finished using a CSP handle, release it by calling the [**CryptReleaseContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptreleasecontext) function.</span></span>

 

 
