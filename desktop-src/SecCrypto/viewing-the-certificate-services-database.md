---
description: Интерфейс Ицертвиев используется надлежащими клиентами для просмотра базы данных служб сертификации.
ms.assetid: c8f316dd-186b-4e4a-b0ce-561a23b266cb
title: Просмотр базы данных служб сертификации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43c553cee2f64c3096e733d588c9e0ad3d08ceb4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104156570"
---
# <a name="viewing-the-certificate-services-database"></a><span data-ttu-id="0073f-103">Просмотр базы данных служб сертификации</span><span class="sxs-lookup"><span data-stu-id="0073f-103">Viewing the Certificate Services Database</span></span>

<span data-ttu-id="0073f-104">Интерфейс [**ицертвиев**](/windows/desktop/api/Certview/nn-certview-icertview) используется надлежащими клиентами для просмотра базы данных служб сертификации.</span><span class="sxs-lookup"><span data-stu-id="0073f-104">The [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) interface is used by properly authorized clients to view the Certificate Services database.</span></span> <span data-ttu-id="0073f-105">Следует отметить, что в составе поставляемого продукта оснастка MMC центра сертификации может использоваться для просмотра базы данных служб сертификации.</span><span class="sxs-lookup"><span data-stu-id="0073f-105">It should be noted that, as part of the shipped product, the Certification Authority MMC snap-in can be used to view the Certificate Services database.</span></span> <span data-ttu-id="0073f-106">[**Ицертвиев**](/windows/desktop/api/Certview/nn-certview-icertview) предоставляется для программного просмотра базы данных.</span><span class="sxs-lookup"><span data-stu-id="0073f-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) is provided for programmatically viewing the database.</span></span> <span data-ttu-id="0073f-107">Поддержка интерфейса **ицертвиев** начинается с Windows XP.</span><span class="sxs-lookup"><span data-stu-id="0073f-107">Support for the **ICertView** interface begins with Windows XP.</span></span>

<span data-ttu-id="0073f-108">Полномочный клиент означает, что пользователь предоставил разрешение на просмотр базы данных служб сертификатов; оснастку MMC "центр сертификации" можно использовать для предоставления или ограничения доступа для просмотра базы данных (в разделе **Свойства** [*центра сертификации*](../secgloss/c-gly.md)перейдите на вкладку **Безопасность** ).</span><span class="sxs-lookup"><span data-stu-id="0073f-108">A properly authorized client means a user who has been granted permission to view the Certificate Services database; the Certification Authority MMC snap-in can be used to grant or restrict access to view the database (under **Properties** for the [*certification authority*](../secgloss/c-gly.md), click the **Security** tab).</span></span> <span data-ttu-id="0073f-109">Кроме того, чтобы использовать объект [**ицертвиев**](/windows/desktop/api/Certview/nn-certview-icertview) , клиентская рабочая станция должна установить клиентские компоненты служб сертификации.</span><span class="sxs-lookup"><span data-stu-id="0073f-109">Additionally, to use the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, the client workstation is required to have installed the Certificate Services client components.</span></span>

<span data-ttu-id="0073f-110">Хотя существуют различные сценарии для использования [**ицертвиев**](/windows/desktop/api/Certview/nn-certview-icertview) и связанных с ним интерфейсов, на следующем изображена одна возможная последовательность для разработки клиентского приложения на основе **ицертвиев**:</span><span class="sxs-lookup"><span data-stu-id="0073f-110">Although there are various scenarios for using [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) and its related interfaces, the following depicts one possible sequence for developing a client application based on **ICertView**:</span></span>

<span data-ttu-id="0073f-111">**Просмотр базы данных служб сертификации**</span><span class="sxs-lookup"><span data-stu-id="0073f-111">**To view the Certificate Services database**</span></span>

1.  <span data-ttu-id="0073f-112">После получения экземпляра объекта [**ицертвиев**](/windows/desktop/api/Certview/nn-certview-icertview) вызовите [**Ицертвиев:: OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) для взаимодействия с [*центром сертификации*](../secgloss/c-gly.md) на определенном компьютере.</span><span class="sxs-lookup"><span data-stu-id="0073f-112">After obtaining an instance of the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, call [**ICertView::OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) to communicate with a [*certification authority*](../secgloss/c-gly.md) on a specific computer.</span></span>
2.  <span data-ttu-id="0073f-113">Вызовите метод [**ицертвиев:: сетресултколумнкаунт**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) , чтобы указать число столбцов в представлении. Этот вызов также используется для указания представления по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0073f-113">Call [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) to specify the number of columns in the view; this call is also used to specify a default view.</span></span> <span data-ttu-id="0073f-114">Если в вызове не указано представление по умолчанию, вызывающий объект должен вызвать [**ицертвиев:: сетресултколумн**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) для каждого столбца, который должен содержаться в представлении.</span><span class="sxs-lookup"><span data-stu-id="0073f-114">If a default view is not specified in the call, the caller must call [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) for each of the columns to be contained in the view.</span></span>
3.  <span data-ttu-id="0073f-115">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="0073f-115">Optional.</span></span> <span data-ttu-id="0073f-116">Укажите критерии сортировки и (или) критерии соответствия для запроса к базе данных, вызвав функцию [**ицертвиев:: сетрестриктион**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) .</span><span class="sxs-lookup"><span data-stu-id="0073f-116">Specify sorting criteria and/or qualifying criteria for the database query by calling the [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) function.</span></span> <span data-ttu-id="0073f-117">Квалифицированные критерии состоят из представления для получения данных на основе квалификаторов, таких как «больше», «меньше», «равно» и т. д.</span><span class="sxs-lookup"><span data-stu-id="0073f-117">Qualifying criteria consists of informing the view to retrieve data based on qualifiers such as Greater Than, Less Than, Equal To, and so on.</span></span>
4.  <span data-ttu-id="0073f-118">Вызовите метод [**ицертвиев:: OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) , чтобы получить данные в представлении. данные представления будут состоять из столбцов, запрошенных с помощью [**ицертвиев:: сетресултколумнкаунт**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (и если не указано представление по умолчанию, [**Ицертвиев:: сетресултколумн**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span><span class="sxs-lookup"><span data-stu-id="0073f-118">Call [**ICertView::OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) to retrieve the data in the view; the view's data will consist of the columns requested by means of [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (and if a default view was not specified, [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span></span> <span data-ttu-id="0073f-119">Если был вызван метод [**ицертвиев:: сетрестриктион**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) , то данные в столбцах будут отсортированы и (или) определены.</span><span class="sxs-lookup"><span data-stu-id="0073f-119">If [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) was called, data in the columns will be sorted and/or qualified.</span></span> <span data-ttu-id="0073f-120">**Ицертвиев:: OpenView** создает объект [**иенумцертвиевров**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) , который может использоваться для перечисления строк представления.</span><span class="sxs-lookup"><span data-stu-id="0073f-120">**ICertView::OpenView** creates a [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) object, which can be used to enumerate the view's rows.</span></span>
5.  <span data-ttu-id="0073f-121">Используйте методы [**Иенумцертвиевров**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) [**Иенумцертвиевров:: енумцертвиеваттрибуте**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**Иенумцертвиевров:: Енумцертвиевколумн**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn)и [**IEnumCERTVIEWROW:: EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) для получения данных атрибута, столбца и расширения по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="0073f-121">Use the [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) methods [**IEnumCERTVIEWROW::EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**IEnumCERTVIEWROW::EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn), and [**IEnumCERTVIEWROW::EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) to retrieve attribute, column, and extension data as desired.</span></span>

 

 
