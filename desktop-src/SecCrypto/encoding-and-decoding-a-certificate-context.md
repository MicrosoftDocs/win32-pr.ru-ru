---
description: Кодирование и декодирование контекста сертификата с помощью CryptoAPI.
ms.assetid: 149d1097-5f50-40ba-84f1-b815f54ba33d
title: Кодирование и декодирование контекста сертификата
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b4168d15ad8db5d4711a18f2042106e7d6d46010
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263425"
---
# <a name="encoding-and-decoding-a-certificate-context"></a><span data-ttu-id="e9767-103">Кодирование и декодирование контекста сертификата</span><span class="sxs-lookup"><span data-stu-id="e9767-103">Encoding and Decoding a Certificate Context</span></span>

<span data-ttu-id="e9767-104">[*CryptoAPI*](../secgloss/c-gly.md) поддерживает кодирование и декодирование [*сертификатов*](../secgloss/c-gly.md).</span><span class="sxs-lookup"><span data-stu-id="e9767-104">[*CryptoAPI*](../secgloss/c-gly.md) supports the encoding and decoding of [*certificates*](../secgloss/c-gly.md).</span></span> <span data-ttu-id="e9767-105">Интерфейс CryptoAPI включает в себя обширную, гибкую систему функций и структур C, которые позволяют выполнять кодирование и декодирование различными способами.</span><span class="sxs-lookup"><span data-stu-id="e9767-105">CryptoAPI includes an extensive, flexible system of functions and C structures that allow encoding and decoding in various ways.</span></span> <span data-ttu-id="e9767-106">CryptoAPI поддерживает стандартную структуру сертификатов [*X. 509*](../secgloss/x-gly.md) и стандартную [*синтаксическую нотацию синтаксиса*](../secgloss/a-gly.md) (ASN. 1) для обеспечения взаимодействия с другими системами.</span><span class="sxs-lookup"><span data-stu-id="e9767-106">CryptoAPI supports standard [*X.509*](../secgloss/x-gly.md) certificate structure and standard [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) encoding to provide interoperability with other systems.</span></span>

<span data-ttu-id="e9767-107">Общие сведения о кодированных данных см. в разделе [закодированные и декодированные данные](encoded-and-decoded-data.md).</span><span class="sxs-lookup"><span data-stu-id="e9767-107">For an overview of encoded data, see [Encoded and Decoded Data](encoded-and-decoded-data.md).</span></span>

## <a name="certificate-contexts"></a><span data-ttu-id="e9767-108">Контексты сертификатов</span><span class="sxs-lookup"><span data-stu-id="e9767-108">Certificate Contexts</span></span>

<span data-ttu-id="e9767-109">[*Контекст сертификата*](../secgloss/c-gly.md), [**\_ контекст CERT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_context), представляет собой структуру C, которая содержит закодированный элемент, маркер [*хранилища сертификатов*](../secgloss/c-gly.md), указатель на исходный [*BLOB-объект*](../secgloss/c-gly.md)закодированного сертификата и указатель на структуру сертификата C. [**\_**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info)</span><span class="sxs-lookup"><span data-stu-id="e9767-109">A [*certificate context*](../secgloss/c-gly.md), [**CERT\_CONTEXT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_context), is a C structure that contains an encoded member, a handle to a [*certificate store*](../secgloss/c-gly.md), a pointer to the original encoded [*certificate BLOB*](../secgloss/c-gly.md), and a pointer to a [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) C structure.</span></span>

<span data-ttu-id="e9767-110">Структура [**\_ сведений о**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) сертификате — это сердце сертификата.</span><span class="sxs-lookup"><span data-stu-id="e9767-110">The [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure is the heart of the certificate.</span></span> <span data-ttu-id="e9767-111">В нем содержатся все основные сведения о сертификате, в прямой форме и в кодированной форме.</span><span class="sxs-lookup"><span data-stu-id="e9767-111">It contains, in direct form and in encoded form, all the basic information in the certificate.</span></span> <span data-ttu-id="e9767-112">На следующем рисунке показана **Структура \_ сведений о сертификате** со всеми закодированными членами, отображаемыми как затененные.</span><span class="sxs-lookup"><span data-stu-id="e9767-112">The following illustration shows the **CERT\_INFO** structure with all of its encoded members shown as shaded.</span></span>

![\-Структура сведений о сертификате](images/certinf2.png)

<span data-ttu-id="e9767-114">Члены **иссуеруникуеид** и **субжектуникуеид** являются частью реализации сертификата [*X. 509*](../secgloss/x-gly.md) версии 2, но редко используются.</span><span class="sxs-lookup"><span data-stu-id="e9767-114">The **IssuerUniqueID** and **SubjectUniqueID** members are part of the [*X.509*](../secgloss/x-gly.md) version 2 certificate implementation but are seldom used.</span></span> <span data-ttu-id="e9767-115">Расширения сертификатов в версии 3 заменяют функциональные возможности этих членов.</span><span class="sxs-lookup"><span data-stu-id="e9767-115">Certificate extensions in version 3 replace the functionality of these members.</span></span>

<span data-ttu-id="e9767-116">Если требуются сведения, содержащиеся в закодированных (затененных) элементах **Issuer** и **subject** , эти члены необходимо декодировать.</span><span class="sxs-lookup"><span data-stu-id="e9767-116">If the information contained in the encoded (shaded) members **Issuer** and **Subject** is needed, those members must be decoded.</span></span> <span data-ttu-id="e9767-117">Для декодирования этих элементов используйте [**криптдекодеобжект**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject) .</span><span class="sxs-lookup"><span data-stu-id="e9767-117">Use [**CryptDecodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject) to decode these members.</span></span> <span data-ttu-id="e9767-118">На следующем рисунке показан процесс декодирования одного из этих элементов.</span><span class="sxs-lookup"><span data-stu-id="e9767-118">The following illustration shows the process of decoding one of these members.</span></span>

![Декодирование с помощью криптдекодеобжект](images/infoflow.png)

<span data-ttu-id="e9767-120">В проиллюстрированном примере функция [**криптдекодеобжект**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject) создает [**\_ \_ информационную**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) структуру сертификата, массив структур [**\_ RDN**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) , соответствующий массиву структур [**\_ \_ attr**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) , а также строку, содержащую имя.</span><span class="sxs-lookup"><span data-stu-id="e9767-120">In the illustrated case, the [**CryptDecodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject) function creates a [**CERT\_NAME\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) structure, an array of [**CERT\_RDN**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) structures, a corresponding array of [**CERT\_RDN\_ATTR**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) structures, and a string that contains the name.</span></span> <span data-ttu-id="e9767-121">Элементы структуры **\_ \_ attr RDN сертификата** определяют содержимое строки.</span><span class="sxs-lookup"><span data-stu-id="e9767-121">Members of the **CERT\_RDN\_ATTR** structure determine the contents of the string.</span></span> <span data-ttu-id="e9767-122">Например, если элемент **псзобжид** имеет значение 2.5.4.3, строка содержит общее имя.</span><span class="sxs-lookup"><span data-stu-id="e9767-122">For example, if the **pszObjId** member is 2.5.4.3, the string contains a common name.</span></span> <span data-ttu-id="e9767-123">Если это 2.5.4.10, строка будет содержать название организации.</span><span class="sxs-lookup"><span data-stu-id="e9767-123">If it is 2.5.4.10, the string would contain an organization name.</span></span> <span data-ttu-id="e9767-124">Список [*идентификаторов объектов*](../secgloss/o-gly.md) (OID) см. в разделе **CERT \_ RDN \_ attr**.</span><span class="sxs-lookup"><span data-stu-id="e9767-124">For a list of these [*object identifiers*](../secgloss/o-gly.md) (OIDs), see **CERT\_RDN\_ATTR**.</span></span>

<span data-ttu-id="e9767-125">Элемент **дввалуетипе** содержит сведения о типе строки.</span><span class="sxs-lookup"><span data-stu-id="e9767-125">The **dwValueType** member contains information about the type of string.</span></span> <span data-ttu-id="e9767-126">Если он является \_ \_ печатаемой \_ строкой с RDN CERT, то элемент value содержит строку символов, заканчивающуюся нулем.</span><span class="sxs-lookup"><span data-stu-id="e9767-126">If it is CERT\_RDN\_PRINTABLE\_STRING, the value member contains a byte-width, zero-terminated character string.</span></span> <span data-ttu-id="e9767-127">Если строка имеет значение \_ RDN в \_ Юникоде \_ , строка представляет собой строку символов двойной ширины (размер слова).</span><span class="sxs-lookup"><span data-stu-id="e9767-127">If it is CERT\_RDN\_UNICODE\_STRING, the string is a double-width (word-sized) character string.</span></span>

<span data-ttu-id="e9767-128">Подробный процесс кодирования и декодирования сертификатов см. в разделе [кодирование \_ структуры сведений о сертификате](encoding-a-cert-info-structure.md) и [декодирование \_ структуры сведений о сертификате](decoding-a-cert-info-structure.md).</span><span class="sxs-lookup"><span data-stu-id="e9767-128">For a detailed process for encoding and decoding certificates, see [Encoding a CERT\_INFO Structure](encoding-a-cert-info-structure.md) and [Decoding a CERT\_INFO Structure](decoding-a-cert-info-structure.md).</span></span>

 

 
