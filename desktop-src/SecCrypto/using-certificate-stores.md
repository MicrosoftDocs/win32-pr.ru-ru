---
description: CAPICOM использует цифровые сертификаты для создания подписей, шифрования ключей шифрования сеанса при создании сообщений с оболочкой и расшифровки зашифрованных ключей сеанса при получении сообщения из конверта.
ms.assetid: 018fc41a-19fd-4e4c-bfed-e0215afb5150
title: Использование хранилищ сертификатов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 682068ba8f2f88d0fedabeef7ccee676f092e52e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662630"
---
# <a name="using-certificate-stores"></a><span data-ttu-id="0ff87-103">Использование хранилищ сертификатов</span><span class="sxs-lookup"><span data-stu-id="0ff87-103">Using Certificate Stores</span></span>

<span data-ttu-id="0ff87-104">\[CAPICOM — это 32-разрядный компонент, доступный для использования в следующих операционных системах: Windows Server 2008, Windows Vista и Windows XP.</span><span class="sxs-lookup"><span data-stu-id="0ff87-104">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="0ff87-105">Вместо этого используйте платформа .NET Framework для реализации функций безопасности.</span><span class="sxs-lookup"><span data-stu-id="0ff87-105">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="0ff87-106">Дополнительные сведения см. [в разделе альтернативы использованию элемента CAPICOM](alternatives-to-using-capicom.md).\]</span><span class="sxs-lookup"><span data-stu-id="0ff87-106">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="0ff87-107">CAPICOM использует [*цифровые сертификаты*](../secgloss/d-gly.md) для создания подписей, шифрования ключей шифрования сеанса при создании сообщений с оболочкой и расшифровки зашифрованных ключей сеанса при получении сообщения из конверта.</span><span class="sxs-lookup"><span data-stu-id="0ff87-107">CAPICOM uses [*digital certificates*](../secgloss/d-gly.md) to create signatures, encrypt session encryption keys when creating enveloped messages, and decrypt encrypted session keys when an enveloped message is received.</span></span> <span data-ttu-id="0ff87-108">По умолчанию CAPICOM использует сертификаты в хранилище My, имеющие связанный закрытый ключ для создания [*цифровых подписей*](../secgloss/d-gly.md) и расшифровки ключа сеанса.</span><span class="sxs-lookup"><span data-stu-id="0ff87-108">By default, CAPICOM uses certificates in the My store that have an associated private key for both [*digital signatures*](../secgloss/d-gly.md) creation and session key decryption.</span></span> <span data-ttu-id="0ff87-109">В большинстве случаев приложению никогда не нужно открывать или иным образом напрямую работать с хранилищем сертификатов.</span><span class="sxs-lookup"><span data-stu-id="0ff87-109">In most cases, an application would never need to open or otherwise directly deal with a certificate store.</span></span>

<span data-ttu-id="0ff87-110">Однако приложения, создающие запечатанные сообщения, используют [*открытый ключ*](../secgloss/p-gly.md) каждого получателя сообщения.</span><span class="sxs-lookup"><span data-stu-id="0ff87-110">However, applications creating enveloped messages use the [*public key*](../secgloss/p-gly.md) of each intended recipient of an enveloped message.</span></span> <span data-ttu-id="0ff87-111">Эти ключи извлекаются из сертификатов предполагаемых получателей.</span><span class="sxs-lookup"><span data-stu-id="0ff87-111">These keys are retrieved from the certificates of the intended recipients.</span></span> <span data-ttu-id="0ff87-112">Таким образом, чтобы создать запечатанные сообщения для группы предполагаемых получателей, сертификаты этих получателей будут собраны в хранилище сертификатов.</span><span class="sxs-lookup"><span data-stu-id="0ff87-112">Thus, to create enveloped messages for a group of intended recipients, the certificates of those recipients would be collected in a certificate store.</span></span>

<span data-ttu-id="0ff87-113">В следующей таблице перечислены стандартные хранилища сертификатов, обычно сохраняемые на пользовательской станции.</span><span class="sxs-lookup"><span data-stu-id="0ff87-113">The following table lists the standard certificate stores normally persisted on a user station.</span></span>



| <span data-ttu-id="0ff87-114">Магазин</span><span class="sxs-lookup"><span data-stu-id="0ff87-114">Store</span></span>        | <span data-ttu-id="0ff87-115">Описание</span><span class="sxs-lookup"><span data-stu-id="0ff87-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                 |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0ff87-116">My</span><span class="sxs-lookup"><span data-stu-id="0ff87-116">My</span></span>           | <span data-ttu-id="0ff87-117">Содержит персональные сертификаты.</span><span class="sxs-lookup"><span data-stu-id="0ff87-117">Contains personal certificates.</span></span> <span data-ttu-id="0ff87-118">Эти сертификаты, как правило, имеют связанный закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="0ff87-118">These certificates will usually have an associated private key.</span></span>                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="0ff87-119">Другие пользователи</span><span class="sxs-lookup"><span data-stu-id="0ff87-119">Other people</span></span> | <span data-ttu-id="0ff87-120">Содержит сертификаты, из которых пользователь обычно отправляет сообщения с оболочкой или получает их.</span><span class="sxs-lookup"><span data-stu-id="0ff87-120">Contains the certificates of those that the user normally sends enveloped messages to or receives signed messages from.</span></span>                                                                                                                                                                                                                                                     |
| <span data-ttu-id="0ff87-121">Центр сертификации и корневой каталог</span><span class="sxs-lookup"><span data-stu-id="0ff87-121">Ca and Root</span></span>  | <span data-ttu-id="0ff87-122">Содержит [*Сертификаты*](../secgloss/r-gly.md) центров сертификации, которым пользователь доверяет для выдачи сертификатов другим пользователям.</span><span class="sxs-lookup"><span data-stu-id="0ff87-122">Contains the [*certificates*](../secgloss/r-gly.md) of certificate authorities that the user trusts to issue certificates to others.</span></span> <span data-ttu-id="0ff87-123">Сертификаты в этих магазинах обычно предоставляются операционной системой или администратором сети пользователя.</span><span class="sxs-lookup"><span data-stu-id="0ff87-123">Certificates in these stores are normally supplied with the operating system or by the user's network administrator.</span></span> <span data-ttu-id="0ff87-124">Сертификаты в корневом хранилище обычно являются самозаверяющими.</span><span class="sxs-lookup"><span data-stu-id="0ff87-124">Certificates in the Root store are typically self-signed.</span></span> |



 

<span data-ttu-id="0ff87-125">\_ \_ Можно создать, открыть и сохранить дополнительные хранилища CAPICOM Current User, указав другое имя хранилища в виде строки.</span><span class="sxs-lookup"><span data-stu-id="0ff87-125">Additional CAPICOM\_CURRENT\_USER stores can be created, opened, and persisted by giving a different store name as a string.</span></span> <span data-ttu-id="0ff87-126">Если хранилище с таким именем не существует, создается и открывается пустое хранилище.</span><span class="sxs-lookup"><span data-stu-id="0ff87-126">If a store by that name does not exist, an empty store is created and opened.</span></span> <span data-ttu-id="0ff87-127">Если хранилище существует, оно открывается и все сертификаты, находящиеся в хранилище, становятся доступными.</span><span class="sxs-lookup"><span data-stu-id="0ff87-127">If a store does exist, it is opened and any certificates currently in the store are made available.</span></span>

<span data-ttu-id="0ff87-128">В следующих разделах приведены примеры для задач хранилища сертификатов.</span><span class="sxs-lookup"><span data-stu-id="0ff87-128">The following sections show examples for certificate store tasks:</span></span>

-   [<span data-ttu-id="0ff87-129">Открытие хранилища Active Directory и получение сертификатов</span><span class="sxs-lookup"><span data-stu-id="0ff87-129">Opening the Active Directory Store and Retrieving Certificates</span></span>](opening-the-active-directory-store-and-retrieving-certificates.md)
-   [<span data-ttu-id="0ff87-130">Добавление сертификатов в хранилище сертификатов</span><span class="sxs-lookup"><span data-stu-id="0ff87-130">Adding Certificates to a Certificate Store</span></span>](adding-certificates-to-a-certificate-store.md)
-   [<span data-ttu-id="0ff87-131">Использование магазинов в разных местах</span><span class="sxs-lookup"><span data-stu-id="0ff87-131">Using Stores in Different Locations</span></span>](using-stores-in-different-locations.md)
-   [<span data-ttu-id="0ff87-132">Сбор и проверка сертификатов</span><span class="sxs-lookup"><span data-stu-id="0ff87-132">Collecting and Verifying Certificates</span></span>](collecting-and-verifying-certificates.md)

 

 
