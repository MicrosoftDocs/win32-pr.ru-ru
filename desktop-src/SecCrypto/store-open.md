---
description: Открывает указанное хранилище сертификатов.
ms.assetid: d6f398b4-dba6-4d84-b5eb-3c7737d17a6e
title: Метод Store. Open
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Store.Open
api_type:
- COM
api_location:
- Capicom.dll
ms.openlocfilehash: d70c6410d0ecb8edb91aa722bcf6f35cb9536c3ed2b7f03c2d5cb141937aeb69
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118897813"
---
# <a name="storeopen-method"></a>Метод Store. Open

\[Метод **Open** доступен для использования в операционных системах, указанных в разделе требования. Вместо этого используйте [**класс X509Store**](/dotnet/api/system.security.cryptography.x509certificates.x509store?view=netcore-3.1) в пространстве имен [**System. Security. Cryptography. X509Certificates**](/dotnet/api/system.security.cryptography.x509certificates.publickey.-ctor?view=netcore-3.1) .\]

Метод **Open** открывает указанное [*хранилище сертификатов*](../secgloss/c-gly.md). По умолчанию \_ \_ расположение хранилища CAPICOM Current User \_ и хранилище CAPICOM \_ My \_ Store открываются только для чтения.

## <a name="syntax"></a>Синтаксис


```VB
Store.Open( _
  [ ByVal StoreLocation ], _
  [ ByVal StoreName ], _
  [ ByVal OpenMode ] _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*StoreLocation* \[ в необязательное\]
</dt> <dd>

Значение перечисления [CAPICOM \_ \_ Location](capicom-store-location.md) , указывающее расположение открываемого хранилища. Значение по умолчанию — "CAPICOM \_ Current \_ user \_ Store". Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                                                              | Значение                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CAPICOM_ACTIVE_DIRECTORY_USER_STORE"></span><span id="capicom_active_directory_user_store"></span><dl> <dt>**CAPICOM \_ Active \_ Directory \_ пользовательское \_ хранилище**</dt> </dl> | Магазин является хранилищем Active Directory. Если хранилище Active Directory открыто как доступное для чтения и записи, то ошибка не будет сформирована, но любые изменения в хранилище не будут сохранены. Сертификаты нельзя добавлять в хранилища Active Directory или удалять из них.<br/>                   |
| <span id="CAPICOM_CURRENT_USER_STORE"></span><span id="capicom_current_user_store"></span><dl> <dt>**\_хранилище CAPICOM текущего \_ пользователя \_**</dt> </dl>                             | Хранилище является хранилищем текущего пользователя. Хранилище текущего пользователя может быть хранилищем для чтения и записи. Если это так, изменения в содержимом хранилища сохраняются.<br/>                                                                                                                        |
| <span id="CAPICOM_LOCAL_MACHINE_STORE"></span><span id="capicom_local_machine_store"></span><dl> <dt>**хранилище CAPICOM на \_ локальном \_ компьютере \_**</dt> </dl>                          | Это хранилище локального компьютера. Хранилища локальных компьютеров могут быть хранилищами для чтения и записи только в том случае, если у пользователя есть разрешения на чтение и запись. Если у пользователя есть разрешения на чтение и запись и если хранилище открыто для чтения и записи, то изменения в содержимом хранилища сохраняются.<br/> |
| <span id="CAPICOM_MEMORY_STORE"></span><span id="capicom_memory_store"></span><dl> <dt>**\_хранилище CAPICOM Memory \_**</dt> </dl>                                                | Хранилище является хранилищем памяти. Любые изменения в содержимом хранилища не сохраняются.<br/>                                                                                                                                                                                |
| <span id="CAPICOM_SMART_CARD_USER_STORE"></span><span id="capicom_smart_card_user_store"></span><dl> <dt>**\_хранилище CAPICOM смарт- \_ карты \_ пользователя \_**</dt> </dl>                   | Магазин — это группа существующих смарт-карт. Представлено в CAPICOM 2,0.<br/>                                                                                                                                                                                               |



 

</dd> <dt>

*StoreName* \[ в необязательное\]
</dt> <dd>

Строка, содержащая имя системного хранилища сертификатов, которое необходимо открыть. Значение по умолчанию — CAPICOM \_ My \_ Store. Если хранилище открывается из веб-скрипта, \\ в имени не может использоваться символ обратной косой черты (). В дополнение к хранилищам, определенным системой, можно открыть пользовательские хранилища.

Этот параметр может быть определяемым пользователем хранилищем или одним из следующих системных хранилищ сертификатов.



| Значение                                                                                                                                                                            | Значение                                                                                               |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| <span id="CAPICOM_CA_STORE"></span><span id="capicom_ca_store"></span><dl> <dt>**\_хранилище CAPICOM CA \_**</dt> </dl>          | Хранилище CA. Это хранилище используется для хранения промежуточных сертификатов ЦС.<br/>                        |
| <span id="CAPICOM_MY_STORE"></span><span id="capicom_my_store"></span><dl> <dt>**CAPICOM \_ My \_ Store**</dt> </dl>          | Мое хранилище. Это хранилище используется для персональных сертификатов пользователя.<br/>                           |
| <span id="CAPICOM_OTHER_STORE"></span><span id="capicom_other_store"></span><dl> <dt>**CAPICOM \_ другое \_ хранилище**</dt> </dl> | Хранилище AddressBook. Это хранилище используется для хранения сертификатов других пользователей.<br/>                  |
| <span id="CAPICOM_ROOT_STORE"></span><span id="capicom_root_store"></span><dl> <dt>**\_корневое \_ хранилище CAPICOM**</dt> </dl>    | Корневое хранилище. Это хранилище используется для хранения корневого ЦС и самозаверяющих доверенных сертификатов.<br/> |



 

</dd> <dt>

*OpenMode* \[ в необязательное\]
</dt> <dd>

Значение перечисления в [ \_ \_ открытом \_ режиме CAPICOM Store](capicom-store-open-mode.md) , указывающее режим открытия хранилища. Значение по умолчанию — CAPICOM \_ Store \_ открыть только для \_ чтения \_ . Если хранилище открывается из веб-скрипта, это значение принудительно устанавливается в режим \_ CAPICOM \_ Store \_ открыть \_ только существующий. Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                                                           | Значение                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| <span id="CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED"></span><span id="capicom_store_open_maximum_allowed"></span><dl> <dt>**\_ \_ \_ Максимальное \_ допустимое число открытых в CAPICOM Store**</dt> </dl> | Откройте хранилище в режиме чтения и записи, если пользователь имеет разрешения на чтение и запись. в противном случае откройте хранилище в режиме только для чтения.<br/> |
| <span id="CAPICOM_STORE_OPEN_READ_ONLY"></span><span id="capicom_store_open_read_only"></span><dl> <dt>**CAPICOM \_ Store \_ открыт \_ только для чтения \_**</dt> </dl>                   | Откройте хранилище в режиме только для чтения.<br/>                                                                                      |
| <span id="CAPICOM_STORE_OPEN_READ_WRITE"></span><span id="capicom_store_open_read_write"></span><dl> <dt>**CAPICOM \_ Store \_ открыть \_ чтение и \_ запись**</dt> </dl>                | Откройте хранилище в режиме чтения и записи.<br/>                                                                                     |



 

Следующие флаги можно объединять со значениями из предыдущей таблицы с помощью операции логического **или** .



| Значение                                                                                                                                                                                                                              | Значение                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
| <span id="CAPICOM_STORE_OPEN_EXISTING_ONLY"></span><span id="capicom_store_open_existing_only"></span><dl> <dt>**в \_ CAPICOM \_ Store \_ открыто \_ только существующее**</dt> </dl>          | Открывать только существующие магазины; не создавать новое хранилище. Представлено в CAPICOM 2,0.<br/> |
| <span id="CAPICOM_STORE_OPEN_INCLUDE_ARCHIVED"></span><span id="capicom_store_open_include_archived"></span><dl> <dt>**\_открыто хранилище CAPICOM, \_ \_ включая \_ архивированные**</dt> </dl> | Включать архивные сертификаты при использовании хранилища. Представлено в CAPICOM 2,0.<br/>   |



 

Хранилища в некоторых местах можно открывать только в режиме "только для чтения". К ним относятся все магазины в \_ \_ хранилище CAPICOM \_ , для которых у пользователя нет разрешений на запись. Попытки открыть хранилище в качестве хранилища для чтения и записи без правильного доступа и разрешений приведут к сбою метода **Open** . Хранилища Active Directory можно открыть как хранилище для чтения и записи без сбоя метода **Open** , но изменения в хранилище не будут сохранены.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Remarks

Если этот метод вызывается в хранилище смарт-карты, можно вызвать дополнительные пользовательские интерфейсы смарт-карты.

> [!IMPORTANT]
> При вызове этого метода из веб-скрипта сценарий должен получить доступ к цифровым сертификатам на локальном компьютере. Если разрешить сценарию доступ к цифровым сертификатам, веб-сайт, с которого выполняется сценарий, также будет получать доступ к личным сведениям, хранящимся в сертификатах. При первом вызове этого метода из определенного домена создается диалоговое окно, в котором пользователь должен указать, следует ли разрешить доступ к сертификатам. Хранилища, открытые из веб-скрипта, автоматически принудительно применяют \_ флаг CAPICOM Store \_ открыть \_ \_ только существующий.

 

Если *StoreLocation* является **\_ \_ \_ пользовательским \_ хранилищем CAPICOM смарт-карты**, *StoreName* игнорируется. В этом случае CAPICOM считывает все сертификаты из всех доступных читателей, содержащих смарт-карту.

## <a name="requirements"></a>Требования



| Требование | Значение |
|----------------------------|----------------------------------------------------------------------------------------|
| Распространяемые компоненты<br/> | CAPICOM 2,0 или более поздней версии на Windows Server 2003 и Windows XP<br/>                  |
| DLL<br/>             | <dl> <dt>Capicom.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Сообщений**](store.md)
</dt> <dt>

[**Криптографические объекты**](cryptography-objects.md)
</dt> <dt>

[**Выхода**](store-close.md)
</dt> </dl>

 

 
