---
description: Службы сертификатов предоставляют веб-страницы регистрации, которые можно использовать для запроса сертификатов.
ms.assetid: 1e198bc8-c712-4d0f-9e3a-35a295445acf
title: Настройка страниц веб-регистрации служб сертификатов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4eb2fbf421eceb1ebf0b15379aca5d0788a992ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913047"
---
# <a name="customizing-certificate-services-web-enrollment-pages"></a><span data-ttu-id="f9d7b-103">Настройка страниц веб-регистрации служб сертификатов</span><span class="sxs-lookup"><span data-stu-id="f9d7b-103">Customizing Certificate Services Web Enrollment Pages</span></span>

<span data-ttu-id="f9d7b-104">[*Службы сертификатов*](../secgloss/c-gly.md) предоставляют веб-страницы регистрации, которые можно использовать для запроса сертификатов.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-104">[*Certificate Services*](../secgloss/c-gly.md) provides web enrollment pages that can be used to request certificates.</span></span> <span data-ttu-id="f9d7b-105">Администратор может настраивать некоторые элементы, которые можно просматривать на страницах веб-регистрации. Однако перед внесением изменений необходимо ознакомиться с веб-страницами регистрации и веб-скриптами.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-105">An administrator can customize some of the items that can be viewed in the web enrollment pages; however, you should be familiar with the web enrollment pages and web scripting before making any changes.</span></span> <span data-ttu-id="f9d7b-106">Дополнительные сведения о веб-сценариях см. в разделе [сценарии](/previous-versions/ms950396(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-106">For more information about web scripting, see [Scripting](/previous-versions/ms950396(v=msdn.10)).</span></span>

<span data-ttu-id="f9d7b-107">Значения по умолчанию для полей различающегося имени для Организации, подразделений, регионов, штат и страны или региона являются значениями, указанными для [*центра сертификации*](../secgloss/c-gly.md) (ЦС) при установке служб сертификатов.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-107">The default values for the Distinguished Name fields for Organization, Organizational Unit, Locality, State, and Country/Region are the values specified for the [*certification authority*](../secgloss/c-gly.md) (CA) when Certificate Services is installed.</span></span> <span data-ttu-id="f9d7b-108">Эти значения по умолчанию отображаются на веб-страницах и могут быть изменены пользователем в процессе регистрации сертификата.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-108">These default values appear in the webpages and can be changed by the user during the certificate enrollment process.</span></span> <span data-ttu-id="f9d7b-109">Однако если вы хотите, чтобы на веб-страницах отображались другие значения по умолчанию, можно изменить файл Цертдат. Inc (в каталоге \\ *виндовсдиректори* \\ system32 \\ certsrv \\ ). в частности, можно присвоить пользовательские значения следующим переменным, предоставленным для настройки.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-109">However, if you want other default values to appear in the webpages, you can edit the Certdat.inc file (in the path \\*WindowsDirectory*\\System32\\Certsrv\\); specifically, you can assign custom values to the following variables provided for customization.</span></span>



| <span data-ttu-id="f9d7b-110">Переменная</span><span class="sxs-lookup"><span data-stu-id="f9d7b-110">Variable</span></span>            | <span data-ttu-id="f9d7b-111">Описание</span><span class="sxs-lookup"><span data-stu-id="f9d7b-111">Description</span></span>                                                                                                                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f9d7b-112">сдефаулткомпани</span><span class="sxs-lookup"><span data-stu-id="f9d7b-112">sDefaultCompany</span></span>     | <span data-ttu-id="f9d7b-113">Компания по умолчанию (отображается в [*запросе сертификата*](../secgloss/c-gly.md) как поле Организации [*X. 509*](../secgloss/x-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-113">Default company (appears in the [*certificate request*](../secgloss/c-gly.md) as the [*X.509*](../secgloss/x-gly.md) Organization field).</span></span> |
| <span data-ttu-id="f9d7b-114">сдефаулторгунит</span><span class="sxs-lookup"><span data-stu-id="f9d7b-114">sDefaultOrgUnit</span></span>     | <span data-ttu-id="f9d7b-115">Отдел по умолчанию (отображается в запросе сертификата как поле подразделения X. 509).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-115">Default department (appears in the certificate request as the X.509 Organizational Unit field).</span></span>                                                                                                                                           |
| <span data-ttu-id="f9d7b-116">сдефаултлокалити</span><span class="sxs-lookup"><span data-stu-id="f9d7b-116">sDefaultLocality</span></span>    | <span data-ttu-id="f9d7b-117">Город по умолчанию (отображается в запросе сертификата как поле расположения X. 509).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-117">Default city (appears in the certificate request as the X.509 Location field).</span></span>                                                                                                                                                            |
| <span data-ttu-id="f9d7b-118">сдефаултстате</span><span class="sxs-lookup"><span data-stu-id="f9d7b-118">sDefaultState</span></span>       | <span data-ttu-id="f9d7b-119">Область или край по умолчанию (отображается в запросе сертификата как поле состояния X. 509).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-119">Default state/province (appears in the certificate request as the X.509 State field).</span></span>                                                                                                                                                     |
| <span data-ttu-id="f9d7b-120">сдефаулткаунтри</span><span class="sxs-lookup"><span data-stu-id="f9d7b-120">sDefaultCountry</span></span>     | <span data-ttu-id="f9d7b-121">Страна или регион по умолчанию (отображается в запросе сертификата как поле страны или региона X. 509).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-121">Default country/region (appears in the certificate request as the X.509 Country/Region field).</span></span>                                                                                                                                            |
| <span data-ttu-id="f9d7b-122">нпендингтимеаутдайс</span><span class="sxs-lookup"><span data-stu-id="f9d7b-122">nPendingTimeoutDays</span></span> | <span data-ttu-id="f9d7b-123">Число дней, в течение которых пользователь может получить ожидающий сертификат после запроса.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-123">Number of days in which the user can retrieve a pending certificate after it has been requested.</span></span>                                                                                                                                          |



 

<span data-ttu-id="f9d7b-124">Другие переменные не должны изменяться в файле Цертдат. Inc.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-124">No other variables should be changed in the Certdat.inc file.</span></span>

<span data-ttu-id="f9d7b-125">В следующем примере для подразделения по умолчанию задается значение "Marketing".</span><span class="sxs-lookup"><span data-stu-id="f9d7b-125">The following example sets the default Organizational Unit to "Marketing".</span></span>


```VB
sDefaultOrgUnit="Marketing"
```



<span data-ttu-id="f9d7b-126">Кроме того, файл Цертрктп. Inc можно изменить для добавления, изменения или удаления [*шаблонов сертификатов*](../secgloss/c-gly.md) или типов, доступных пользователю.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-126">Additionally, you can edit the Certrqtp.inc file to add, change, or remove [*certificate templates*](../secgloss/c-gly.md) or types available to the user.</span></span> <span data-ttu-id="f9d7b-127">Эти шаблоны и типы, а также связанные сведения содержатся в массиве измерений с именем Ргаваилректипес (*m*, 5).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-127">These templates and types, as well as related information, are contained in a dimensioned array called rgAvailReqTypes(*m*,5).</span></span>

<span data-ttu-id="f9d7b-128">Этот массив, как и все массивы Visual Basic Scripting Edition, основан на нулях, и в результате первое измерение массива *m*, выделяет память для *m*+ 1 элементов.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-128">This array, like all Visual Basic Scripting Edition arrays, is zero based, and as a result, the array's first dimension, *m*, allocates memory for *m*+1 items.</span></span> <span data-ttu-id="f9d7b-129">Поэтому при настройке веб-страниц необходимо изменить число элементов в массиве Ргаваилректипес, присвоить измерению *m* значение меньше, чем общее число необходимых элементов.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-129">Therefore, if in customizing the webpages, you need to modify the number of items in the rgAvailReqTypes array, set the *m* dimension to one less than the total number of items you need.</span></span> <span data-ttu-id="f9d7b-130">Например, если у вас будут семь шаблонов сертификатов, измените объявление Ргаваилректипес, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-130">For example, if you will have seven certificate templates, change the declaration of rgAvailReqTypes as shown in the following example.</span></span>


```VB
Dim rgAvailReqTypes(6,5)
```



<span data-ttu-id="f9d7b-131">Второе измерение массива, которое всегда имеет значение 5, выделяет шесть полей, составляющих каждый элемент.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-131">The array's second dimension, which always has the value five, allocates the six fields that compose each item.</span></span> <span data-ttu-id="f9d7b-132">Эти шесть полей представляют шаблон или тип сертификата, отображаемое имя, связанное с этим шаблоном или типом, а также указывает, требуется ли для шаблона наличие [*расширений электронной почты в Интернете*](../secgloss/s-gly.md) (S/MIME).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-132">These six fields represent the certificate template or type, the display name associated with this template or type, and whether the template requires [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME).</span></span>

<span data-ttu-id="f9d7b-133">Чтобы облегчить понимание того, к какому из этих полей обращается доступ, Цертрктп. Inc также предоставляет следующие константы, которые можно использовать при задании значений полей.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-133">To make it easier to understand which of these fields is being accessed, Certrqtp.inc also provides the following constants you can use when setting field values.</span></span>



| <span data-ttu-id="f9d7b-134">Константа</span><span class="sxs-lookup"><span data-stu-id="f9d7b-134">Constant</span></span>                              | <span data-ttu-id="f9d7b-135">Описание</span><span class="sxs-lookup"><span data-stu-id="f9d7b-135">Description</span></span>                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f9d7b-136">**\_OID поля**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-136">**FIELD\_OID**</span></span>                        | <span data-ttu-id="f9d7b-137">(Относится к автономным ЦС) Индекс для первого поля элемента; представляет [*идентификатор объекта*](../secgloss/o-gly.md) (OID) для типа сертификата.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-137">(Applies to stand-alone CAs) Index to the item's first field; represents an [*object identifier*](../secgloss/o-gly.md) (OID) for a certificate type.</span></span><br/>                                                                                                           |
| <span data-ttu-id="f9d7b-138">**\_шаблон поля**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-138">**FIELD\_TEMPLATE**</span></span>                   | <span data-ttu-id="f9d7b-139">(Относится к ЦС предприятия) Индекс для первого поля элемента; представляет шаблон сертификата.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-139">(Applies to enterprise CAs) Index to the item's first field; represents a certificate template.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="f9d7b-140">**ПОЛЕ \_ FRIENDLYNAME**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-140">**FIELD\_FRIENDLYNAME**</span></span>               | <span data-ttu-id="f9d7b-141">Индекс для второго поля элемента; Представляет отображаемое имя (которое пользователь увидит при регистрации) элемента в первом поле.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-141">Index to the item's second field; represents the display name (which the user will see when enrolling) of the item in the first field.</span></span>                                                                                                                                                                                               |
| <span data-ttu-id="f9d7b-142">**ПОЛЕ \_ ксплист**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-142">**FIELD\_CSPLIST**</span></span>                    | <span data-ttu-id="f9d7b-143">Индекс для третьего поля элемента.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-143">Index to the item's third field.</span></span> <span data-ttu-id="f9d7b-144">Список имен [*поставщиков служб шифрования*](../secgloss/c-gly.md) , разрешенных шаблоном.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-144">A list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="f9d7b-145">Каждое имя в списке отделяется вопросительным знаком (?).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-145">Each name in the list is separated by a question mark (?).</span></span>                                                    |
| <span data-ttu-id="f9d7b-146">**ПОЛЕ \_ CSPLIST2**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-146">**FIELD\_CSPLIST2**</span></span>                   | <span data-ttu-id="f9d7b-147">Индекс четвертого поля элемента.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-147">Index to the item's fourth field.</span></span> <span data-ttu-id="f9d7b-148">Дополнительный список имен [*поставщиков служб шифрования*](../secgloss/c-gly.md) , разрешенных шаблоном.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-148">A secondary list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="f9d7b-149">Каждое имя в списке отделяется вопросительным знаком (?).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-149">Each name in the list is separated by a question mark (?).</span></span> <span data-ttu-id="f9d7b-150">Этот список содержит разные значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-150">This list provides a different default.</span></span> |
| <span data-ttu-id="f9d7b-151">**\_экспортируемое поле**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-151">**FIELD\_EXPORTABLE**</span></span>                 | <span data-ttu-id="f9d7b-152">Индекс для пятого поля элемента.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-152">Index to the item's fifth field.</span></span> <span data-ttu-id="f9d7b-153">Указывает, указывает ли шаблон, что ключ должен быть экспортирован.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-153">Indicates whether the template specifies that the key should be exportable.</span></span> <span data-ttu-id="f9d7b-154">Если это поле содержит значение "true", ключ может быть экспортирован.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-154">If this field contains "True", the key is exportable.</span></span> <span data-ttu-id="f9d7b-155">Если это поле содержит значение "false", ключ не может быть экспортирован.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-155">If this field contains "False", the key is not exportable.</span></span>                                                                                                        |
| <span data-ttu-id="f9d7b-156">**для \_ поля \_ требуются \_ возможности SMIME**</span><span class="sxs-lookup"><span data-stu-id="f9d7b-156">**FIELD\_NEEDS\_SMIME\_CAPABILITIES**</span></span> | <span data-ttu-id="f9d7b-157">Эта константа не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-157">This constant is not supported.</span></span>                                                                                                                                                                                                                                                                                                      |



 

<span data-ttu-id="f9d7b-158">Например, следующие выражения присваивают идентификатор объекта 1.3.6.1.5.5.7.3.2 первому полю первого элемента и присваивают полю "сертификат веб-браузера" второе поле первого элемента (значение массива 0 индексирует первый элемент).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-158">For example, the following expressions assign the OID of 1.3.6.1.5.5.7.3.2 to the first item's first field and assign "Web Browser Certificate" to the first item's second field (the array value of zero indexes the first item).</span></span>


```VB
rgAvailReqTypes(0, FIELD_OID) = "1.3.6.1.5.5.7.3.2"
rgAvailReqTypes(0, FIELD_FRIENDLYNAME) = "Web Browser Certificate"
```



<span data-ttu-id="f9d7b-159">Результатом этих назначений является то, что пользователь увидит текстовый **сертификат веб-браузера** при регистрации, и если пользователь выберет **сертификат веб-браузера**, [*запрос сертификата*](../secgloss/c-gly.md) будет содержать идентификатор объекта 1.3.6.1.5.5.7.3.2.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-159">The result of these assignments is that the user will see the text **Web Browser Certificate** when enrolling, and if the user selects **Web Browser Certificate**, the [*certificate request*](../secgloss/c-gly.md) will contain the OID 1.3.6.1.5.5.7.3.2.</span></span>

<span data-ttu-id="f9d7b-160">Файл Цертрктп. Inc также содержит константы, которые используются для отображаемых имен шаблонов сертификатов или типов.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-160">The Certrqtp.inc file also contains constants that are used for the display names of the certificate templates or types.</span></span> <span data-ttu-id="f9d7b-161">В следующем примере показан формат.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-161">The following example shows the format.</span></span>


```VB
' Strings for localization.
Const L_WebBrowserCert_Text="Web Browser Certificate"
Const L_EmailProtectionCert_Text="E-Mail Protection Certificate"
Const L_UserTemplateCert_Text="User Certificate"
```



<span data-ttu-id="f9d7b-162">Эти константы определяются в блоке в файле Цертрктп. Inc, и эта группировка упрощает Присвоение каждому из них пользовательского значения.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-162">These constants are defined in a block in the Certrqtp.inc file, and this grouping makes it easier to assign each of them a custom value.</span></span> <span data-ttu-id="f9d7b-163">Это особенно полезно при локализации отображаемых имен для международных версий веб-страниц.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-163">This is particularly helpful when you localize the display names for international versions of the webpages.</span></span>

<span data-ttu-id="f9d7b-164">Наконец, файл Цертрктп. Inc содержит переменную, представляющую количество шаблонов сертификатов или типов в массиве Ргаваилректипес.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-164">Finally, the Certrqtp.inc file contains a variable that represents the number of certificate templates or types in the rgAvailReqTypes array.</span></span> <span data-ttu-id="f9d7b-165">В отличие от измерения *m* массива, присвойте значение переменной наваилректипес фактическому числу шаблонов сертификатов или типов, которые будут использоваться при установке. Это значение должно быть не больше *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-165">In contrast to the *m* dimension of the array, set the value of the nAvailReqTypes variable to the actual number of certificate templates or types that your installation will use; this value must be no larger than *m*+1.</span></span> <span data-ttu-id="f9d7b-166">Несмотря на то, что объявлено ближе к началу файла Цертрктп. Inc, Наваилректипес присваивает значение после заполнения массива Ргаваилректипес, что упрощает просмотр количества элементов, которые фактически используются массивом.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-166">Although declared near the top of the Certrqtp.inc file, nAvailReqTypes is assigned a value after the rgAvailReqTypes array is populated, making it easier to see how many elements are actually used by the array.</span></span> <span data-ttu-id="f9d7b-167">Значение Наваилректипес используется в другой итерации на страницах веб-регистрации, поэтому важно, чтобы эта переменная точно отражала количество шаблонов сертификатов или типов, которые должны быть доступны пользователю для просмотра.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-167">The nAvailReqTypes value is used in an iteration elsewhere in the web enrollment pages, so it is important that this variable accurately reflect the number of certificate templates or types that you want to be viewable to the user.</span></span>

<span data-ttu-id="f9d7b-168">Обратите внимание, что добавление [*шаблонов сертификатов*](../secgloss/c-gly.md) и типов в файл цертрктп. Inc не гарантирует, что пользователь сможет получить сертификат с этими характеристиками. ЦС должен иметь разрешение на выдачу сертификата для указанного шаблона или типа сертификата.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-168">Note that merely adding [*certificate templates*](../secgloss/c-gly.md) and types to the Certrqtp.inc file does not guarantee that the user will be able to get a certificate with those traits; the CA must be authorized to issue a certificate for the specified certificate template or type.</span></span>

<span data-ttu-id="f9d7b-169">Установки могут создавать собственные приложения или веб-страницы для запроса и получения сертификата.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-169">Installations can create their own applications or webpages to request and receive a certificate.</span></span> <span data-ttu-id="f9d7b-170">Объекты [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) и [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) позволяют программистам и разработчикам создавать приложения для [*запросов сертификатов*](../secgloss/c-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="f9d7b-170">The [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) and [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) objects allow programmers or scripters to build [*certificate request*](../secgloss/c-gly.md) applications.</span></span>

<span data-ttu-id="f9d7b-171">Чтобы запросить сертификат для [*смарт-карты*](../secgloss/s-gly.md), можно использовать Управление регистрацией смарт-карты.</span><span class="sxs-lookup"><span data-stu-id="f9d7b-171">To request a certificate to be issued on a [*smart card*](../secgloss/s-gly.md), you can use the Smart Card Enrollment Control.</span></span> <span data-ttu-id="f9d7b-172">Дополнительные сведения и примеры кода см. в разделе [**искрденр**](iscrdenr.md).</span><span class="sxs-lookup"><span data-stu-id="f9d7b-172">For details and example code, see [**ISCrdEnr**](iscrdenr.md).</span></span>

 

 
