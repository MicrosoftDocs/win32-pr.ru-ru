---
description: Приложения, использующие объекты CAPICOM, должны создаваться с помощью CAPICOM.dll. CAPICOM.dll также должны присутствовать и быть зарегистрированы во время выполнения для использования объектов CAPICOM.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Подготовка к использованию элемента CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6fc1ad0dbfe3d4f8c4dae3286eb3ffa5e1ae03d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664130"
---
# <a name="getting-ready-to-use-capicom"></a><span data-ttu-id="108af-104">Подготовка к использованию элемента CAPICOM</span><span class="sxs-lookup"><span data-stu-id="108af-104">Getting Ready to Use CAPICOM</span></span>

<span data-ttu-id="108af-105">\[CAPICOM — это 32-разрядный компонент, доступный для использования в следующих операционных системах: Windows Server 2008, Windows Vista и Windows XP.</span><span class="sxs-lookup"><span data-stu-id="108af-105">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="108af-106">Вместо этого используйте платформа .NET Framework для реализации функций безопасности.</span><span class="sxs-lookup"><span data-stu-id="108af-106">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="108af-107">Дополнительные сведения см. [в разделе альтернативы использованию элемента CAPICOM](alternatives-to-using-capicom.md).\]</span><span class="sxs-lookup"><span data-stu-id="108af-107">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="108af-108">Приложения, использующие объекты CAPICOM, должны создаваться с помощью CAPICOM.dll.</span><span class="sxs-lookup"><span data-stu-id="108af-108">Applications that use CAPICOM objects must be created by using CAPICOM.dll.</span></span> <span data-ttu-id="108af-109">CAPICOM.dll также должны присутствовать и быть зарегистрированы во время выполнения для использования объектов CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="108af-109">CAPICOM.dll must also be present and registered at run time to use CAPICOM objects.</span></span> <span data-ttu-id="108af-110">CAPICOM.dll следует добавлять в ссылки на проекты Visual Basic для использования объектов CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="108af-110">CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</span></span>

<span data-ttu-id="108af-111">CAPICOM доступен в виде распространяемого файла, который можно скачать из [распространяемого пакета Platform SDK: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span><span class="sxs-lookup"><span data-stu-id="108af-111">CAPICOM is available as a redistributable file that can be downloaded from [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span></span> <span data-ttu-id="108af-112">Дополнительные сведения о версиях CAPICOM см. в разделе [CAPICOM Versions](capicom-versions.md).</span><span class="sxs-lookup"><span data-stu-id="108af-112">For information about CAPICOM versions, see [CAPICOM Versions](capicom-versions.md).</span></span>

<span data-ttu-id="108af-113">**Регистрация CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="108af-113">**To register CAPICOM.dll**</span></span>

-   <span data-ttu-id="108af-114">В командной строке измените каталог на каталог, где хранится CAPICOM.dll, а затем введите следующую команду:</span><span class="sxs-lookup"><span data-stu-id="108af-114">At a command prompt, change the directory to the directory where CAPICOM.dll is stored, and then enter the following command:</span></span>

    <span data-ttu-id="108af-115">**regsvr32 CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="108af-115">**regsvr32 CAPICOM.dll**</span></span>

## <a name="example-code-limitations"></a><span data-ttu-id="108af-116">Примеры ограничений для кода</span><span class="sxs-lookup"><span data-stu-id="108af-116">Example Code Limitations</span></span>

<span data-ttu-id="108af-117">Для более краткого и более удобного для чтения кода принципы хорошей практики программирования не всегда следуют в этих примерах.</span><span class="sxs-lookup"><span data-stu-id="108af-117">To provide more concise, more readable code, principles of good programming practice are not always followed in these examples.</span></span> <span data-ttu-id="108af-118">В частности, отображаются только ограниченные ответы на ошибки.</span><span class="sxs-lookup"><span data-stu-id="108af-118">In particular, only limited error responses are shown.</span></span> <span data-ttu-id="108af-119">Работающие приложения всегда должны проверять возвращенные коды ошибок и выполнять соответствующие действия при обнаружении ошибки.</span><span class="sxs-lookup"><span data-stu-id="108af-119">Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</span></span>

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a><span data-ttu-id="108af-120">Необходимые контейнеры ключей, ключи и сертификаты в CAPICOM</span><span class="sxs-lookup"><span data-stu-id="108af-120">Necessary Key Containers, Keys, and Certificates in CAPICOM</span></span>

<span data-ttu-id="108af-121">Хотя некоторые операции с объектами CAPICOM можно выполнять на любом компьютере любым пользователем, создание [*цифровых подписей*](../secgloss/d-gly.md) и получение содержимого в виде текста в оболочке сообщения с помощью объектов CAPICOM — это операции на основе сертификатов.</span><span class="sxs-lookup"><span data-stu-id="108af-121">While some operations with CAPICOM objects can be done on any computer by any user, creating [*digital signatures*](../secgloss/d-gly.md) and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations.</span></span> <span data-ttu-id="108af-122">Пользователь, который создает цифровую подпись и пользователь, который получает зашифрованное содержимое запечатанного сообщения, должен иметь цифровой сертификат с доступным связанным закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="108af-122">The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key.</span></span> <span data-ttu-id="108af-123">Если сертификат с соответствующим закрытым ключом отсутствует, операция шифрования завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="108af-123">If a certificate with an associated private key is not present, the cryptographic operation will fail.</span></span> <span data-ttu-id="108af-124">Пользователи приложений CAPICOM должны обеспечить наличие соответствующего сертификата и доступного закрытого ключа при выполнении приложений.</span><span class="sxs-lookup"><span data-stu-id="108af-124">Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</span></span>

<span data-ttu-id="108af-125">Некоторые примеры в следующих разделах выполняют операции, для которых требуется доступная [*пара открытого и закрытого ключей*](../secgloss/p-gly.md) для шифрования и расшифровки файлов, сообщений и подписей.</span><span class="sxs-lookup"><span data-stu-id="108af-125">Some examples in the following sections perform operations that require an available [*public/private key pair*](../secgloss/p-gly.md) for encrypting and decrypting files, messages, and signatures.</span></span> <span data-ttu-id="108af-126">Во время выполнения многие из этих программ будут компилироваться и выполняться, но при этом не будет иметь соответствующие [*контейнеры ключей*](../secgloss/k-gly.md), ключи, хранилища сертификатов и [*Сертификаты*](../secgloss/c-gly.md) в этих хранилищах.</span><span class="sxs-lookup"><span data-stu-id="108af-126">Many of these programs will compile and run but fail at run time without the existence of proper [*key containers*](../secgloss/k-gly.md), keys, certificate stores, and [*certificates*](../secgloss/c-gly.md) in those stores.</span></span>

<span data-ttu-id="108af-127">**Создание самозаверяющего сертификата**</span><span class="sxs-lookup"><span data-stu-id="108af-127">**To create a self-signed certificate**</span></span>

1.  <span data-ttu-id="108af-128">Установите средства подписывания.</span><span class="sxs-lookup"><span data-stu-id="108af-128">Install the signing tools.</span></span> <span data-ttu-id="108af-129">Они устанавливаются в составе пакета средств разработки программного обеспечения (SDK) для Microsoft Windows, пакета SDK для платформы или пакета SDK для платформа .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="108af-129">These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</span></span>
2.  <span data-ttu-id="108af-130">После загрузки Makecert.exe выполните следующую команду в командной строке, подставив имя пользователя *username*, название организации для *название_организации* и название компании для *CompanyName*:</span><span class="sxs-lookup"><span data-stu-id="108af-130">After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for *UserName*, an organization name for *OrganizationName*, and a company name for *CompanyName*:</span></span>

    <span data-ttu-id="108af-131">**MakeCert-r-n "CN =**_имя_пользователя_\*_, OU =_\*_название_организации_*_, o =_*_CompanyName_*_"-SS My_*</span><span class="sxs-lookup"><span data-stu-id="108af-131">**makecert -r -n "cn=**_UserName_*_, ou=_*_OrganizationName_*_, o=_*_CompanyName_*_" -ss my_*</span></span>

3.  <span data-ttu-id="108af-132">Сертификат можно поместить в хранилище My текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="108af-132">The certificate can be placed in the My store of the current user.</span></span> <span data-ttu-id="108af-133">Импортируйте сертификат, созданный в корневом хранилище, чтобы он был доверенным.</span><span class="sxs-lookup"><span data-stu-id="108af-133">Import the certificate created into the root store so that it is trusted.</span></span>

 

 
