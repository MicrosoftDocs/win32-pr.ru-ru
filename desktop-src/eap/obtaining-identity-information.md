---
title: Получение сведений об удостоверении
description: Поставщик, реализующий протокол проверки подлинности, может также предоставить интерфейс функции, который получает начальную идентификационную информацию для пользователя, запрашивающего проверку подлинности.
ms.assetid: 773c9fdb-c810-4cea-afed-df6484a9c9c9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9519da9d66937fd25245fe78f12ef34c3c0ad8
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104069845"
---
# <a name="obtaining-identity-information"></a><span data-ttu-id="3f3b9-103">Получение сведений об удостоверении</span><span class="sxs-lookup"><span data-stu-id="3f3b9-103">Obtaining Identity Information</span></span>

<span data-ttu-id="3f3b9-104">Поставщик, реализующий протокол проверки подлинности, может также предоставить интерфейс функции, который получает начальную идентификационную информацию для пользователя, запрашивающего проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-104">The vendor that implements the authentication protocol may also provide a function interface that obtains initial identifying information for the user requesting authentication.</span></span>

<span data-ttu-id="3f3b9-105">Поставщик должен реализовать следующие функции.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-105">The vendor should implement the following functions.</span></span>

-   [<span data-ttu-id="3f3b9-106">**расеапжетидентити**</span><span class="sxs-lookup"><span data-stu-id="3f3b9-106">**RasEapGetIdentity**</span></span>](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity)
-   [<span data-ttu-id="3f3b9-107">**расеапфримемори**</span><span class="sxs-lookup"><span data-stu-id="3f3b9-107">**RasEapFreeMemory**</span></span>](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory)

<span data-ttu-id="3f3b9-108">Эти функции могут быть реализованы в той же библиотеке DLL, что и протокол проверки подлинности, или в отдельной библиотеке DLL.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-108">These functions may be implemented in the same DLL as the authentication protocol, or in a separate DLL.</span></span> <span data-ttu-id="3f3b9-109">Кроме того, Библиотека DLL, реализующая функции идентификации, может поддерживать более одного протокола проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-109">Also, the DLL that implements the identity functions may support more than one authentication protocol.</span></span> <span data-ttu-id="3f3b9-110">Путь к библиотеке DLL для этих функций хранится в значении реестра [RAS \_ EAP \_ valueName \_ Identity](authentication-protocol-registry-values.md) в разделе ключа для протокола проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-110">The path to the DLL for these functions is stored in the [RAS\_EAP\_VALUENAME\_IDENTITY](authentication-protocol-registry-values.md) registry value, under the key for the authentication protocol.</span></span> <span data-ttu-id="3f3b9-111">Дополнительные сведения о создании этого значения реестра см. в разделе [Установка EAP](eap-installation.md).</span><span class="sxs-lookup"><span data-stu-id="3f3b9-111">For more information about creating this registry value, see [EAP Installation](eap-installation.md).</span></span>

<span data-ttu-id="3f3b9-112">Функция [**расеапжетидентити**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) обычно отображает пользовательский интерфейс для получения сведений об удостоверении для пользователя.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-112">The [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) function typically displays a user interface (UI) to obtain identity information for the user.</span></span> <span data-ttu-id="3f3b9-113">Однако если параметр *dwFlags* содержит флаг RAS \_ EAP, не \_ \_ являющийся \_ интерактивным, **расеапжетидентити** не должен отображать пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-113">However, if the *dwFlags* parameter contains the RAS\_EAP\_FLAG\_NON\_INTERACTIVE flag, **RasEapGetIdentity** should not display a UI.</span></span>

<span data-ttu-id="3f3b9-114">Если [**расеапжетидентити**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) отображает пользовательский интерфейс, Пользовательский интерфейс должен поддерживать [**\_ Командные сообщения WM**](../menurc/wm-command.md) , где значение [**ловорд**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85))(*wParam*) равно идканцел.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-114">If [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) does display a UI, the UI must support [**WM\_COMMAND**](../menurc/wm-command.md) messages where the value of [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85))(*wParam*) is equal to IDCANCEL.</span></span>

<span data-ttu-id="3f3b9-115">Служба проверки подлинности вызывает [**расеапжетидентити**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) , если значение параметра [RAS \_ EAP \_ valueName \_ Invoke \_ намедлг](authentication-protocol-registry-values.md) , которое находится в реестре для этого EAP, установлено в 0.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-115">The authentication service calls [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) if the [RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG](authentication-protocol-registry-values.md) value that is in the registry for this EAP is set to zero.</span></span> <span data-ttu-id="3f3b9-116">Если параметр \_ RAS \_ EAP \_ Invoke \_ намедлг отсутствует или имеется и имеет значение 1, служба проверки подлинности отображает диалоговое окно стандартное системное имя пользователя.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-116">If RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG is not present, or is present and is set to one, the authentication service displays the standard system user name dialog box.</span></span>

<span data-ttu-id="3f3b9-117">В дополнение к службе RAS- \_ \_ valueName EAP \_ Invoke \_ намедлг, поставщик EAP может создать связанное значение, а в реестре — [службу RAS \_ EAP \_ \_ Invoke \_ пвддлг](authentication-protocol-registry-values.md).</span><span class="sxs-lookup"><span data-stu-id="3f3b9-117">In addition to RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG, the EAP vendor may create a related value, [RAS\_EAP\_VALUENAME\_INVOKE\_PWDDLG](authentication-protocol-registry-values.md), in the registry.</span></span> <span data-ttu-id="3f3b9-118">Если это значение имеется и имеет значение 0, то служба не будет отображать стандартный системный пароль.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-118">If this value is present and is set to zero, the service will not display the standard system password dialog.</span></span> <span data-ttu-id="3f3b9-119">Это значение полезно при реализации биометрического метода, такого как сканирование отпечатков пальцев для проверки подлинности пользователя.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-119">This value is useful when implementing a biometric method such as a fingerprint scan to authenticate the user.</span></span> <span data-ttu-id="3f3b9-120">Если значения для RAS \_ EAP \_ valueName \_ Invoke \_ намедлг и RAS \_ EAP \_ valueName \_ Invoke \_ пвддлг равны нулю, Пользовательский интерфейс идентификации можно использовать для получения сведений об удостоверении и биометрической метрике.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-120">If both the RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG and RAS\_EAP\_VALUENAME\_INVOKE\_PWDDLG values are zero, an identity UI could be used to obtain both the identity and biometric information.</span></span> <span data-ttu-id="3f3b9-121">Тем не менее, если только RAS \_ \_ \_ \_ -значение проверки значения EAP Invoke пвддлг равен нулю, служба проверки подлинности не будет вызывать [**расеапжетидентити**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span><span class="sxs-lookup"><span data-stu-id="3f3b9-121">However, if only RAS\_EAP\_VALUENAME\_INVOKE\_PWDDLG is zero, the authentication service will not call [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span></span> <span data-ttu-id="3f3b9-122">В этом случае для получения биометрической информации можно использовать [интерактивный пользовательский интерфейс](interactive-user-interface.md) .</span><span class="sxs-lookup"><span data-stu-id="3f3b9-122">In this case, you could use the [interactive user interface](interactive-user-interface.md) to obtain the biometric information.</span></span>

<span data-ttu-id="3f3b9-123">Дополнительные сведения об этих значениях реестра см. в разделе [значения реестра протокола проверки подлинности](authentication-protocol-registry-values.md).</span><span class="sxs-lookup"><span data-stu-id="3f3b9-123">For more information on these registry values, see [Authentication Protocol Registry Values](authentication-protocol-registry-values.md).</span></span>

<span data-ttu-id="3f3b9-124">Сведения, полученные с помощью [**расеапжетидентити**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) , передаются в протокол проверки подлинности во время вызова [**расеапбегин**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="3f3b9-124">The information obtained by [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) is passed to the authentication protocol during the call to [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)).</span></span> <span data-ttu-id="3f3b9-125">На эти сведения указывает члены **псзидентити** и **Пусердата** структуры [**\_ \_ ввода PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) .</span><span class="sxs-lookup"><span data-stu-id="3f3b9-125">The information is pointed to by the **pszIdentity** and **pUserData** members of the [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) structure.</span></span> <span data-ttu-id="3f3b9-126">Чтобы сохранить эти сведения в реестре на клиентском компьютере, протокол проверки подлинности должен вернуть сведения в параметре *пеапаутпут* объекта [**расеапмакемессаже**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="3f3b9-126">To save this information in the registry on the client computer, the authentication protocol should return the information in the *pEapOutput* parameter of [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)).</span></span>

<span data-ttu-id="3f3b9-127">После вызова [**расеапбегин**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85))служба проверки подлинности вызывает [**расеапфримемори**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) , чтобы освободить память, занятую этими данными.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-127">After the call to [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)), the authentication service calls [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) to free the memory occupied by this data.</span></span> <span data-ttu-id="3f3b9-128">Поэтому протокол проверки подлинности должен скопировать информацию в буфер закрытой памяти во время вызова **расеапбегин**.</span><span class="sxs-lookup"><span data-stu-id="3f3b9-128">Therefore, the authentication protocol should copy the information into a private memory buffer during the call to **RasEapBegin**.</span></span>

 

 