---
title: Сведения о записи компакт-дисков
description: Сведения о записи компакт-дисков
ms.assetid: 1ecc73ed-c49d-4190-baa9-93162f075a4c
keywords:
- Проигрыватель Windows Media, запись компакт-дисков
- Объектная модель проигрывателя Windows Media, запись компакт-дисков
- Объектная модель, запись компакт-диска
- Элемент управления ActiveX проигрывателя Windows Media, запись компакт-дисков
- Элемент управления ActiveX, запись компакт-дисков
- Мобильный элемент управления ActiveX проигрывателя Windows Media, запись компакт-дисков
- Проигрыватель Windows Media Mobile, запись компакт-дисков
- Запись компакт-дисков, о программе
- запись компакт-дисков, сведения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc921080d02bef6ffbf916fe4d7d1df09f1e8bbc
ms.sourcegitcommit: b04e152a7f51618fc174ffa872654623fe088db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/21/2020
ms.locfileid: "103789187"
---
# <a name="about-cd-burning"></a><span data-ttu-id="be545-112">Сведения о записи компакт-дисков</span><span class="sxs-lookup"><span data-stu-id="be545-112">About CD Burning</span></span>

<span data-ttu-id="be545-113">В пакете SDK для проигрывателя Windows Media 11 появились новые возможности для создания компакт-дисков.</span><span class="sxs-lookup"><span data-stu-id="be545-113">The Windows Media Player 11 SDK introduces new functionality for creating CDs.</span></span> <span data-ttu-id="be545-114">Этот процесс называется *записью*.</span><span class="sxs-lookup"><span data-stu-id="be545-114">This process is called *burning*.</span></span>

<span data-ttu-id="be545-115">Чтобы перечислить дисководы компакт-дисков на компьютере пользователя, используйте интерфейс **ивмпкдромколлектион** .</span><span class="sxs-lookup"><span data-stu-id="be545-115">To enumerate the CD drives on the user's computer, use the **IWMPCdromCollection** interface.</span></span> <span data-ttu-id="be545-116">Чтобы получить указатель на этот интерфейс, вызовите [ивмпкоре:: Get \_ кдромколлектион](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_cdromcollection).</span><span class="sxs-lookup"><span data-stu-id="be545-116">You retrieve a pointer to this interface by calling [IWMPCore::get\_cdromCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_cdromcollection).</span></span> <span data-ttu-id="be545-117">С помощью методов **Count** и **Item** можно выполнить итерацию коллекции, чтобы получить указатель интерфейса **ивмпкдром** для каждого компакт-дисковода на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="be545-117">By using the **count** and **item** methods, you can iterate the collection to retrieve an **IWMPCdrom** interface pointer for each CD drive on the user's computer.</span></span> <span data-ttu-id="be545-118">Интерфейс **ивмпкдром** представляет отдельный компакт-диск.</span><span class="sxs-lookup"><span data-stu-id="be545-118">The **IWMPCdrom** interface represents an individual CD drive.</span></span>

<span data-ttu-id="be545-119">Перед началом записи компакт-диска необходимо сначала вызвать **QueryInterface** через указатель **ивмпкдром** , чтобы получить указатель на интерфейс **ивмпкдромбурн** .</span><span class="sxs-lookup"><span data-stu-id="be545-119">Before you begin burning a CD, you must first call **QueryInterface** through an **IWMPCdrom** pointer to retrieve a pointer to the **IWMPCdromBurn** interface.</span></span> <span data-ttu-id="be545-120">С помощью метода, **доступного** для чтения, можно определить, может ли конкретный компакт-диск записывать компакт-диски, есть ли в дисководе диск и как можно использовать этот компакт-диск.</span><span class="sxs-lookup"><span data-stu-id="be545-120">By using the **isAvailable** method, you can determine whether a particular CD drive can burn CDs, whether there is a CD in the drive, and how the CD can be used.</span></span>

<span data-ttu-id="be545-121">Чтобы указать элементы для записи на компакт-диск, необходимо создать список воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="be545-121">To specify the items to burn to CD, you must create a playlist.</span></span> <span data-ttu-id="be545-122">Проигрыватель Windows Media представляет списки воспроизведения с помощью интерфейса **ивмпплайлист** .</span><span class="sxs-lookup"><span data-stu-id="be545-122">Windows Media Player represents playlists by using the **IWMPPlaylist** interface.</span></span> <span data-ttu-id="be545-123">Этот список воспроизведения можно создать любым способом.</span><span class="sxs-lookup"><span data-stu-id="be545-123">You can create this playlist any way you like.</span></span> <span data-ttu-id="be545-124">Например, вы можете просто извлечь список воспроизведения из библиотеки, вызвав [ивмпмедиаколлектион:: жетбялбум](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection-getbyalbum).</span><span class="sxs-lookup"><span data-stu-id="be545-124">For example, you might simply retrieve a playlist from the library by calling [IWMPMediaCollection::getByAlbum](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection-getbyalbum).</span></span> <span data-ttu-id="be545-125">После создания списка воспроизведения, который необходимо записать на компакт-диск, необходимо вызвать метод [ивмпкдромбурн::p UT \_ бурнплайлист](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_burnplaylist) и передать указатель списка воспроизведения в качестве аргумента.</span><span class="sxs-lookup"><span data-stu-id="be545-125">After you create the playlist that you want to burn to CD, you must call the [IWMPCdromBurn::put\_burnPlaylist](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_burnplaylist) method and pass the playlist pointer as an argument.</span></span> <span data-ttu-id="be545-126">Этот параметр задает список воспроизведения, который проигрыватель Windows Media будет копировать на компакт-диск.</span><span class="sxs-lookup"><span data-stu-id="be545-126">This sets your playlist as the one that Windows Media Player will copy to the CD.</span></span>

<span data-ttu-id="be545-127">При извлечении списка воспроизведения из библиотеки все изменения, внесенные в список воспроизведения, будут отражены в библиотеке пользователя.</span><span class="sxs-lookup"><span data-stu-id="be545-127">If you retrieve a playlist from the library, any changes you make to the playlist will be reflected in the user's library.</span></span> <span data-ttu-id="be545-128">Чтобы избежать этого, вызовите метод [ивмпплайлист:: сетитеминфо](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpplaylist-setiteminfo), передав имя атрибута "Temporary" и значение "true".</span><span class="sxs-lookup"><span data-stu-id="be545-128">To avoid this, call [IWMPPlaylist::setItemInfo](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpplaylist-setiteminfo), passing the attribute name "Temporary" and the value "true".</span></span> <span data-ttu-id="be545-129">При этом экземпляр списка воспроизведения преобразуется во временный список воспроизведения, который можно изменить без изменения исходного списка воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="be545-129">This converts your playlist instance to a temporary playlist, which can be edited without changing the original playlist.</span></span>

<span data-ttu-id="be545-130">Каждый раз, когда вы задаете новый список воспроизведения для записи или вносите изменения в существующий список воспроизведения, необходимо вызвать [ивмпкдромбурн:: рефрешстатус](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-refreshstatus) , чтобы обновить сведения о состоянии.</span><span class="sxs-lookup"><span data-stu-id="be545-130">Each time you set a new playlist for burning, or make changes to an existing burn playlist, you must call [IWMPCdromBurn::refreshStatus](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-refreshstatus) to update the status information.</span></span> <span data-ttu-id="be545-131">Это гарантирует, что проигрыватель Windows Media выполняет обработку, необходимую для предоставления точных сведений о состоянии для операции записи компакт-дисков.</span><span class="sxs-lookup"><span data-stu-id="be545-131">This ensures that Windows Media Player does the processing necessary to provide you with accurate status information for the CD burning operation.</span></span>

<span data-ttu-id="be545-132">Чтобы указать тип записываемого компакт-диска, вызовите [ивмпкдромбурн::p UT \_ бурнформат](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_burnformat).</span><span class="sxs-lookup"><span data-stu-id="be545-132">To specify the type of CD to burn, call [IWMPCdromBurn::put\_burnFormat](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_burnformat).</span></span> <span data-ttu-id="be545-133">Проигрыватель Windows Media позволяет записывать два типа компакт-дисков: аудио компакт-диски и компакт-диски с данными.</span><span class="sxs-lookup"><span data-stu-id="be545-133">Windows Media Player enables you to burn two types of CDs: audio CDs and data CDs.</span></span> <span data-ttu-id="be545-134">Перечисление [вмпбурнформат](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmpburnformat) определяет типы компакт-дисков.</span><span class="sxs-lookup"><span data-stu-id="be545-134">The [WMPBurnFormat](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmpburnformat) enumeration defines the CD types.</span></span>

<span data-ttu-id="be545-135">Вы можете указать метку тома для компакт-диска, вызвав [ивмпкдромбурн::p UT \_ Label](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_label).</span><span class="sxs-lookup"><span data-stu-id="be545-135">You can specify a volume label for the CD by calling [IWMPCdromBurn::put\_label](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_label).</span></span>

<span data-ttu-id="be545-136">Когда вы будете готовы начать запись компакт-диска, вызовите [ивмпкдромбурн:: стартбурн](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-startburn).</span><span class="sxs-lookup"><span data-stu-id="be545-136">When you are ready to begin burning the CD, call [IWMPCdromBurn::startBurn](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-startburn).</span></span> <span data-ttu-id="be545-137">Ход выполнения операции записи можно отслеживать, периодически вызывая [ивмпкдромбурн:: Get \_ бурнпрогресс](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-get_burnprogress).</span><span class="sxs-lookup"><span data-stu-id="be545-137">You can monitor the progress of the burning operation by periodically calling [IWMPCdromBurn::get\_burnProgress](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-get_burnprogress).</span></span> <span data-ttu-id="be545-138">Этот метод получает значение хода выполнения для всей операции записи.</span><span class="sxs-lookup"><span data-stu-id="be545-138">This method retrieves a progress value for the entire burning operation.</span></span> <span data-ttu-id="be545-139">Полученное значение является числом, представляющим процент завершенной записи.</span><span class="sxs-lookup"><span data-stu-id="be545-139">The value retrieved is a number that represents the percentage of burning completed.</span></span> <span data-ttu-id="be545-140">Состояние операции записи можно отслеживать, обрабатывая событие [IWMPEvents3:: кдромбурнстатечанже](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnstatechange) , которое использует перечисление [вмпбурнстате](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmpburnstate) для указания текущего состояния.</span><span class="sxs-lookup"><span data-stu-id="be545-140">You can monitor the state of the burning operation by handling the [IWMPEvents3::CdromBurnStateChange](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnstatechange) event, which uses the [WMPBurnState](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmpburnstate) enumeration to indicate the current state.</span></span> <span data-ttu-id="be545-141">Необходимо внимательно сравнить указатель **ивмпкдромбурн** (предоставленный событием) с указателем, который представляет операцию записи, чтобы убедиться, что событие было вызвано операцией.</span><span class="sxs-lookup"><span data-stu-id="be545-141">You should be careful to compare the **IWMPCdromBurn** pointer (provided by the event) to the pointer that represents your burning operation to ensure that the event was raised by your operation.</span></span> <span data-ttu-id="be545-142">Можно прерывать операцию записи путем вызова [ивмпкдромбурн:: стопбурн](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-stopburn).</span><span class="sxs-lookup"><span data-stu-id="be545-142">You can stop the burning operation by calling [IWMPCdromBurn::stopBurn](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-stopburn).</span></span>

<span data-ttu-id="be545-143">Существует два события, которые можно выполнять для получения уведомлений об ошибках операции записи.</span><span class="sxs-lookup"><span data-stu-id="be545-143">There are two events that you can handle to receive error notifications about your burning operation.</span></span> <span data-ttu-id="be545-144">Событие [IWMPEvents3:: кдромбурнеррор](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnerror) возникает при возникновении универсальной ошибки.</span><span class="sxs-lookup"><span data-stu-id="be545-144">The [IWMPEvents3::CdromBurnError](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnerror) event is raised when a generic error occurs.</span></span> <span data-ttu-id="be545-145">[IWMPEvents3:: кдромбурнмедиаеррор](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnmediaerror) возникает, когда конкретный элемент мультимедиа вызывает ошибку во время записи.</span><span class="sxs-lookup"><span data-stu-id="be545-145">[IWMPEvents3::CdromBurnMediaError](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnmediaerror) is raised when a particular media item causes an error during burning.</span></span> <span data-ttu-id="be545-146">Как и событие **кдромбурнстатечанже** , каждое из этих событий предоставляет указатель **ивмпкдромбурн** , представляющий операцию записи, вызвавшую событие.</span><span class="sxs-lookup"><span data-stu-id="be545-146">Like the **CdromBurnStateChange** event, each of these events provides an **IWMPCdromBurn** pointer that represents the burning operation that raised the event.</span></span> <span data-ttu-id="be545-147">Событие **кдромбурнмедиаеррор** предоставляет указатель **IDispatch** , представляющий элемент мультимедиа, вызвавший событие.</span><span class="sxs-lookup"><span data-stu-id="be545-147">The **CdromBurnMediaError** event provides an **IDispatch** pointer that represents the media item that raised the event.</span></span> <span data-ttu-id="be545-148">С помощью этого указателя можно вызвать метод **QueryInterface** , чтобы получить указатель **ивмпмедиа** .</span><span class="sxs-lookup"><span data-stu-id="be545-148">You can call **QueryInterface** through this pointer to retrieve an **IWMPMedia** pointer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="be545-149">См. также</span><span class="sxs-lookup"><span data-stu-id="be545-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="be545-150">**Сведения об объектной модели проигрывателя**</span><span class="sxs-lookup"><span data-stu-id="be545-150">**About the Player Object Model**</span></span>](about-the-player-object-model.md)
</dt> <dt>

[<span data-ttu-id="be545-151">**Интерфейс Ивмпкдром**</span><span class="sxs-lookup"><span data-stu-id="be545-151">**IWMPCdrom Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcdrom)
</dt> <dt>

[<span data-ttu-id="be545-152">**Интерфейс Ивмпкдромбурн**</span><span class="sxs-lookup"><span data-stu-id="be545-152">**IWMPCdromBurn Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcdromburn)
</dt> <dt>

[<span data-ttu-id="be545-153">**Интерфейс Ивмпкдромколлектион**</span><span class="sxs-lookup"><span data-stu-id="be545-153">**IWMPCdromCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcdromcollection)
</dt> <dt>

[<span data-ttu-id="be545-154">**Интерфейс IWMPEvents3**</span><span class="sxs-lookup"><span data-stu-id="be545-154">**IWMPEvents3 Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpevents3)
</dt> <dt>

[<span data-ttu-id="be545-155">**Интерфейс Ивмпмедиа**</span><span class="sxs-lookup"><span data-stu-id="be545-155">**IWMPMedia Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpmedia)
</dt> <dt>

[<span data-ttu-id="be545-156">**Интерфейс Ивмпплайлист**</span><span class="sxs-lookup"><span data-stu-id="be545-156">**IWMPPlaylist Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpplaylist)
</dt> <dt>

[<span data-ttu-id="be545-157">**Временный атрибут**</span><span class="sxs-lookup"><span data-stu-id="be545-157">**Temporary Attribute**</span></span>](temporary-attribute.md)
</dt> </dl>

 

 




