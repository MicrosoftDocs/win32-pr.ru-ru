---
title: Расширения устройств MTP для обмена метаданными
description: Расширения устройств MTP для обмена метаданными
ms.assetid: 9cf68373-e84f-4568-a9da-16ddee0fc4e9
keywords:
- Проигрыватель Windows Media, расширения для устройств MTP
- Проигрыватель Windows Media, расширения устройств
- Проигрыватель Windows Media, расширения
- Проигрыватель Windows Media, метаданные
- Проигрыватель Windows Media, протокол передачи мультимедиа (MTP)
- Протокол передачи мультимедиа (MTP)
- MTP (протокол передачи мультимедиа)
- метаданные, расширения для устройств MTP
- метаданные, расширения устройств
- метаданные, расширения
- расширения устройств, перенос метаданных
- расширения, перенос метаданных
- Расширения устройств MTP для обмена метаданными
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f64ff16fd97f135d7f8c902af823b967079408fb
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067298"
---
# <a name="mtp-device-extensions-for-metadata-transfer"></a><span data-ttu-id="11db1-116">Расширения устройств MTP для обмена метаданными</span><span class="sxs-lookup"><span data-stu-id="11db1-116">MTP Device Extensions for Metadata Transfer</span></span>

<span data-ttu-id="11db1-117">Протокол передачи мультимедиа (MTP) — это протокол, предназначенный для переносных устройств мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="11db1-117">Media Transfer Protocol (MTP) is a protocol designed for portable media devices.</span></span> <span data-ttu-id="11db1-118">Основной целью этого протокола является предоставление общего протокола для обмена данными между компьютером и портативным устройством мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="11db1-118">The primary purpose of this protocol is to provide a common protocol for exchanging data between a computer and a portable media device.</span></span> <span data-ttu-id="11db1-119">Это включает получение и отправку объектов мультимедиа и перечисление содержимого и возможностей устройства.</span><span class="sxs-lookup"><span data-stu-id="11db1-119">This includes receiving and sending media objects and enumerating the contents and capabilities of the device.</span></span>

<span data-ttu-id="11db1-120">MTP использует постоянные уникальные идентификаторы объектов (Пуоидс) для уникальной идентификации цифровых мультимедийных объектов (и других объектов), хранящихся на устройстве.</span><span class="sxs-lookup"><span data-stu-id="11db1-120">MTP uses persistent unique object identifiers (PUOIDs) to uniquely identify digital media items (and other objects) stored on a device.</span></span> <span data-ttu-id="11db1-121">При обмене сведениями об изменениях, произошедших на устройстве, которое поддерживает MTP, устройство и проигрыватель Windows Media используют Пуоидс для указания объектов, которые были изменены.</span><span class="sxs-lookup"><span data-stu-id="11db1-121">When exchanging information about changes that have occurred on a device that supports MTP, the device and Windows Media Player use PUOIDs to identify which objects have changed.</span></span>

<span data-ttu-id="11db1-122">Файл заголовка с именем вмпдевицес. h, который устанавливается как часть пакета SDK проигрывателя Windows Media, определяет структуры и константы, необходимые для поддержки расширений устройств проигрывателя Windows Media.</span><span class="sxs-lookup"><span data-stu-id="11db1-122">The header file named wmpdevices.h, which is installed as part of the Windows Media Player SDK, defines the structures and constants needed to support Windows Media Player device extensions.</span></span>

<span data-ttu-id="11db1-123">Чтобы устройство было распознано как поддерживающее передаваемые метаданные с помощью расширения Windows Media Player MTP, оно должно содержать следующие сведения в наборе данных DeviceInfo.</span><span class="sxs-lookup"><span data-stu-id="11db1-123">For a device to be recognized as supporting metadata transfer through the Windows Media Player MTP device extension set, it must include the following information in the DeviceInfo dataset.</span></span> <span data-ttu-id="11db1-124">(Дополнительные сведения об этом наборе данных см. в разделе 4.6.1 спецификации MTP.)</span><span class="sxs-lookup"><span data-stu-id="11db1-124">(For more information about this dataset, see section 4.6.1 of the MTP specification.)</span></span>



| <span data-ttu-id="11db1-125">Поле набора данных</span><span class="sxs-lookup"><span data-stu-id="11db1-125">Dataset field</span></span>          | <span data-ttu-id="11db1-126">Порядок полей</span><span class="sxs-lookup"><span data-stu-id="11db1-126">Field order</span></span> | <span data-ttu-id="11db1-127">Тип данных</span><span class="sxs-lookup"><span data-stu-id="11db1-127">Data type</span></span>  | <span data-ttu-id="11db1-128">Значение</span><span class="sxs-lookup"><span data-stu-id="11db1-128">Value</span></span>                       |
|------------------------|-------------|------------|-----------------------------|
| <span data-ttu-id="11db1-129">вендорекстенсионид</span><span class="sxs-lookup"><span data-stu-id="11db1-129">VendorExtensionID</span></span>      | <span data-ttu-id="11db1-130">2</span><span class="sxs-lookup"><span data-stu-id="11db1-130">2</span></span>           | <span data-ttu-id="11db1-131">**UINT32**</span><span class="sxs-lookup"><span data-stu-id="11db1-131">**UINT32**</span></span> | <span data-ttu-id="11db1-132">0x00000006</span><span class="sxs-lookup"><span data-stu-id="11db1-132">0x00000006</span></span>                  |
| <span data-ttu-id="11db1-133">вендорекстенсионверсион</span><span class="sxs-lookup"><span data-stu-id="11db1-133">VendorExtensionVersion</span></span> | <span data-ttu-id="11db1-134">3</span><span class="sxs-lookup"><span data-stu-id="11db1-134">3</span></span>           | <span data-ttu-id="11db1-135">**UINT16**</span><span class="sxs-lookup"><span data-stu-id="11db1-135">**UINT16**</span></span> | <span data-ttu-id="11db1-136">0x0064 (100)</span><span class="sxs-lookup"><span data-stu-id="11db1-136">0x0064 (100)</span></span>                |
| <span data-ttu-id="11db1-137">вендорекстенсиондеск</span><span class="sxs-lookup"><span data-stu-id="11db1-137">VendorExtensionDesc</span></span>    | <span data-ttu-id="11db1-138">4</span><span class="sxs-lookup"><span data-stu-id="11db1-138">4</span></span>           | <span data-ttu-id="11db1-139">**String**</span><span class="sxs-lookup"><span data-stu-id="11db1-139">**String**</span></span> | <span data-ttu-id="11db1-140">"microsoft.com/WMPPD: 10,0"</span><span class="sxs-lookup"><span data-stu-id="11db1-140">"microsoft.com/WMPPD: 10.0"</span></span> |



 

<span data-ttu-id="11db1-141">В следующей таблице приведены сведения об операции MTP для ускоренной пересылки метаданных.</span><span class="sxs-lookup"><span data-stu-id="11db1-141">The following table provides details about the MTP operation for accelerated metadata transfer.</span></span>



| <span data-ttu-id="11db1-142">Элемент</span><span class="sxs-lookup"><span data-stu-id="11db1-142">Item</span></span>                  | <span data-ttu-id="11db1-143">Описание</span><span class="sxs-lookup"><span data-stu-id="11db1-143">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="11db1-144">Код операции</span><span class="sxs-lookup"><span data-stu-id="11db1-144">Operation Code</span></span>        | <span data-ttu-id="11db1-145">0x9201</span><span class="sxs-lookup"><span data-stu-id="11db1-145">0x9201</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="11db1-146">Параметр операции 1</span><span class="sxs-lookup"><span data-stu-id="11db1-146">Operation Parameter 1</span></span> | <span data-ttu-id="11db1-147">Идентификатор транзакции, предоставленный устройством во время предыдущего сеанса.</span><span class="sxs-lookup"><span data-stu-id="11db1-147">The transaction ID supplied by the device during the previous session.</span></span> <span data-ttu-id="11db1-148">Для первого сеанса это значение равно нулю.</span><span class="sxs-lookup"><span data-stu-id="11db1-148">This value is zero for the first session.</span></span>                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="11db1-149">Параметр операции 2</span><span class="sxs-lookup"><span data-stu-id="11db1-149">Operation Parameter 2</span></span> | <span data-ttu-id="11db1-150">Начальный индекс.</span><span class="sxs-lookup"><span data-stu-id="11db1-150">Starting index.</span></span> <span data-ttu-id="11db1-151">Это значение всегда равно нулю при первом вызове сеанса.</span><span class="sxs-lookup"><span data-stu-id="11db1-151">This value is always zero on the first call of a session.</span></span> <span data-ttu-id="11db1-152">При последующих вызовах в рамках одного сеанса синхронизации это значение увеличивается на сумму количества измененных и удаленных элементов из предыдущих данных ответа.</span><span class="sxs-lookup"><span data-stu-id="11db1-152">On subsequent calls within the same synchronization session, this value increases by the sum of the count of the modified and the deleted items from the previous response data.</span></span>                                                                                                                                                                                                                                             |
| <span data-ttu-id="11db1-153">Параметр операции 3</span><span class="sxs-lookup"><span data-stu-id="11db1-153">Operation Parameter 3</span></span> | <span data-ttu-id="11db1-154">0x10000.</span><span class="sxs-lookup"><span data-stu-id="11db1-154">0x10000.</span></span> <span data-ttu-id="11db1-155">Эта константа, определенная в вмпдевицес. h, является максимальным числом Пуоидс, которое может быть возвращено в ответе.</span><span class="sxs-lookup"><span data-stu-id="11db1-155">This constant, defined in wmpdevices.h, is the maximum number of PUOIDs that can be returned in the response.</span></span> <span data-ttu-id="11db1-156">Обратите внимание, что значение этой константы может быть пересмотрено в будущих выпусках этого файла заголовка.</span><span class="sxs-lookup"><span data-stu-id="11db1-156">Note that the value of this constant may be revised in future releases of this header file.</span></span>                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="11db1-157">Параметр операции 4</span><span class="sxs-lookup"><span data-stu-id="11db1-157">Operation Parameter 4</span></span> | <span data-ttu-id="11db1-158">0</span><span class="sxs-lookup"><span data-stu-id="11db1-158">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="11db1-159">Параметр операции 5</span><span class="sxs-lookup"><span data-stu-id="11db1-159">Operation Parameter 5</span></span> | <span data-ttu-id="11db1-160">0</span><span class="sxs-lookup"><span data-stu-id="11db1-160">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="11db1-161">Данные</span><span class="sxs-lookup"><span data-stu-id="11db1-161">Data</span></span>                  | <span data-ttu-id="11db1-162">Устройство возвращает два непрерывных массива MTP, содержащие Пуоидс.</span><span class="sxs-lookup"><span data-stu-id="11db1-162">The device returns two contiguous MTP arrays containing PUOIDs.</span></span> <span data-ttu-id="11db1-163">Каждый массив MTP начинается с значения **DWORD** , показывающего количество элементов в массиве, за которым следует массив элементов.</span><span class="sxs-lookup"><span data-stu-id="11db1-163">Each MTP array begins with a **DWORD** value indicating the count of items in the array, followed by the array of elements.</span></span> <span data-ttu-id="11db1-164">Первый массив MTP содержит список добавленных или измененных Пуоидс.</span><span class="sxs-lookup"><span data-stu-id="11db1-164">The first MTP array contains the list of PUOIDs that have been added or changed.</span></span> <span data-ttu-id="11db1-165">Второй массив MTP содержит список Пуоидс, удаленных с переносного устройства. Обратите внимание, что сумма числа ПУОИД в двух массивах не должна превышать значение, переданное в параметре операции 3.</span><span class="sxs-lookup"><span data-stu-id="11db1-165">The second MTP array contains the list of PUOIDs that have been deleted from the portable device.Note that the sum of PUOID count in the two arrays must not exceed the value passed in Operation Parameter 3.</span></span><br/> |
| <span data-ttu-id="11db1-166">Направление данных</span><span class="sxs-lookup"><span data-stu-id="11db1-166">Data Direction</span></span>        | <span data-ttu-id="11db1-167">R->I</span><span class="sxs-lookup"><span data-stu-id="11db1-167">R->I</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="11db1-168">Параметры кода ответа</span><span class="sxs-lookup"><span data-stu-id="11db1-168">Response Code Options</span></span> | <span data-ttu-id="11db1-169">**MTP \_ ОТВЕТ \_ OK** (0x2001) или допустимый код ответа ошибки.</span><span class="sxs-lookup"><span data-stu-id="11db1-169">**MTP\_RESPONSE\_OK** (0x2001) or valid error response code.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="11db1-170">Параметр ответа 1</span><span class="sxs-lookup"><span data-stu-id="11db1-170">Response Parameter 1</span></span>  | <span data-ttu-id="11db1-171">ИДЕНТИФИКАТОР текущей транзакции устройства.</span><span class="sxs-lookup"><span data-stu-id="11db1-171">The device's current transaction ID.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="11db1-172">Параметр ответа 2</span><span class="sxs-lookup"><span data-stu-id="11db1-172">Response Parameter 2</span></span>  | <span data-ttu-id="11db1-173">Число Пуоидс, которые остаются для получения в будущих запросах.</span><span class="sxs-lookup"><span data-stu-id="11db1-173">The number of PUOIDs that remain to be retrieved by future requests.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="11db1-174">Параметр ответа 3</span><span class="sxs-lookup"><span data-stu-id="11db1-174">Response Parameter 3</span></span>  | <span data-ttu-id="11db1-175">**DWORD** , содержащий сведения о состоянии.</span><span class="sxs-lookup"><span data-stu-id="11db1-175">**DWORD** containing status information.</span></span> <span data-ttu-id="11db1-176">Состояние указывается в побитовой последовательности.</span><span class="sxs-lookup"><span data-stu-id="11db1-176">Status is indicated in a bitwise fashion.</span></span> <span data-ttu-id="11db1-177">Дополнительные сведения об используемых флагах см. в разделе Примечания.</span><span class="sxs-lookup"><span data-stu-id="11db1-177">See Remarks for information about flags to use.</span></span>                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="11db1-178">Параметр ответа 4</span><span class="sxs-lookup"><span data-stu-id="11db1-178">Response Parameter 4</span></span>  | <span data-ttu-id="11db1-179">0</span><span class="sxs-lookup"><span data-stu-id="11db1-179">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="11db1-180">Параметр ответа 5</span><span class="sxs-lookup"><span data-stu-id="11db1-180">Response Parameter 5</span></span>  | <span data-ttu-id="11db1-181">0</span><span class="sxs-lookup"><span data-stu-id="11db1-181">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="remarks"></a><span data-ttu-id="11db1-182">Комментарии</span><span class="sxs-lookup"><span data-stu-id="11db1-182">Remarks</span></span>

<span data-ttu-id="11db1-183">Состояние указывается в ответном параметре 3 в побитовом режиме с помощью следующих флагов.</span><span class="sxs-lookup"><span data-stu-id="11db1-183">Status is indicated through Response Parameter 3 in a bitwise fashion by using the following flags.</span></span>



| <span data-ttu-id="11db1-184">Флаг</span><span class="sxs-lookup"><span data-stu-id="11db1-184">Flag</span></span>                                             | <span data-ttu-id="11db1-185">Значение</span><span class="sxs-lookup"><span data-stu-id="11db1-185">Value</span></span> | <span data-ttu-id="11db1-186">Описание</span><span class="sxs-lookup"><span data-stu-id="11db1-186">Description</span></span>                                                                                                                                                                                                                          |
|--------------------------------------------------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="11db1-187">**WMP \_ мдрт \_ Флаги \_ \_ \_ неотправленные удаленные элементы**</span><span class="sxs-lookup"><span data-stu-id="11db1-187">**WMP\_MDRT\_FLAGS\_UNREPORTED\_DELETED\_ITEMS**</span></span> | <span data-ttu-id="11db1-188">0x1</span><span class="sxs-lookup"><span data-stu-id="11db1-188">0x1</span></span>   | <span data-ttu-id="11db1-189">Элементы были удалены до того, как будет сообщено первое имя пути к объекту.</span><span class="sxs-lookup"><span data-stu-id="11db1-189">Items were deleted before the first object path name being reported.</span></span> <span data-ttu-id="11db1-190">Это часто означает, что устройство было переформатировано.</span><span class="sxs-lookup"><span data-stu-id="11db1-190">This often indicates that the device was reformatted.</span></span>                                                                                                           |
| <span data-ttu-id="11db1-191">**WMP \_ мдрт \_ Флаги \_ \_ невключенных добавленных \_ элементов**</span><span class="sxs-lookup"><span data-stu-id="11db1-191">**WMP\_MDRT\_FLAGS\_UNREPORTED\_ADDED\_ITEMS**</span></span>   | <span data-ttu-id="11db1-192">0x2</span><span class="sxs-lookup"><span data-stu-id="11db1-192">0x2</span></span>   | <span data-ttu-id="11db1-193">Устройство содержит некоторые добавленные элементы, которые не могут быть возвращены в списке ПУОИДС.</span><span class="sxs-lookup"><span data-stu-id="11db1-193">The device contains some added items that cannot be returned in the list of PUOIDS.</span></span> <span data-ttu-id="11db1-194">Обратите внимание, что этот флаг не является избыточным для параметра ответа 2.</span><span class="sxs-lookup"><span data-stu-id="11db1-194">Note that this flag is not redundant with Response Parameter 2.</span></span> <span data-ttu-id="11db1-195">Установите этот флаг только в том случае, если запрошенные элементы не могут быть возвращены устройством.</span><span class="sxs-lookup"><span data-stu-id="11db1-195">Set this flag only when there are requested items that the device cannot return.</span></span> |



 

<span data-ttu-id="11db1-196">Биты с 2 по 31 зарезервированы для будущего использования.</span><span class="sxs-lookup"><span data-stu-id="11db1-196">Bits 2 through 31 are reserved for future use.</span></span> <span data-ttu-id="11db1-197">Эти биты должны иметь значение 0.</span><span class="sxs-lookup"><span data-stu-id="11db1-197">These bits should be set to zero.</span></span>

<span data-ttu-id="11db1-198">Проигрыватель Windows Media отправляет команду MTP на устройство в начале сеанса синхронизации до передачи файлов мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="11db1-198">Windows Media Player sends the MTP command to a device at the start of a synchronization session before media files are transferred.</span></span> <span data-ttu-id="11db1-199">Устройство должно вернуть свой ответ как можно быстрее, чтобы избежать задержек в операции синхронизации.</span><span class="sxs-lookup"><span data-stu-id="11db1-199">The device should return its response as quickly as possible to avoid delays in the synchronization operation.</span></span>

<span data-ttu-id="11db1-200">Проигрыватель Windows Media запрашивает значения для атрибутов, перечисленных в [сведениях о метаданных](about-the-metadata.md) для каждого измененного пауид, возвращенного в ответе.</span><span class="sxs-lookup"><span data-stu-id="11db1-200">Windows Media Player will request values for the attributes listed in [About the Metadata](about-the-metadata.md) for each modified POUID returned in the response.</span></span> <span data-ttu-id="11db1-201">Проигрыватель Windows Media может отправить обновленные значения этих атрибутов устройству в последующих командах.</span><span class="sxs-lookup"><span data-stu-id="11db1-201">Windows Media Player might send updated values for these attributes to the device in subsequent commands.</span></span>

<span data-ttu-id="11db1-202">Файлы, которые были удалены с устройства, можно скопировать на устройство еще раз, если это требуется для параметров пользователя.</span><span class="sxs-lookup"><span data-stu-id="11db1-202">Files reported as having been removed from the device can be copied to the device again if the user's settings require it.</span></span>

## <a name="related-topics"></a><span data-ttu-id="11db1-203">См. также</span><span class="sxs-lookup"><span data-stu-id="11db1-203">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="11db1-204">**Расширения устройств для ускоренной пересылки метаданных**</span><span class="sxs-lookup"><span data-stu-id="11db1-204">**Device Extensions for Accelerated Metadata Transfer**</span></span>](device-extensions-for-accelerated-metadata-transfer.md)
</dt> </dl>

 

 





