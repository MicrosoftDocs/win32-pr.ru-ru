---
title: Реализация страницы свойств для подключаемого модуля DSP
description: Реализация страницы свойств для подключаемого модуля DSP
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Подключаемые модули проигрывателя Windows Media, DSP аудиоподсистемы
- подключаемые модули, DSP аудиоподсистемы
- подключаемые модули обработки цифровых сигналов, свойства аудио
- Подключаемые модули DSP, звуковые свойства
- подключаемые модули DSP аудио, свойства
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888035"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a><span data-ttu-id="e6e73-108">Реализация страницы свойств для подключаемого модуля DSP</span><span class="sxs-lookup"><span data-stu-id="e6e73-108">Implementing the Property Page for a DSP Plug-in</span></span>

<span data-ttu-id="e6e73-109">Проигрыватель Windows Media может отображать страницу свойств для каждого подключаемого модуля DSP, чтобы позволить пользователям задавать значения, изменяющие поведение подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="e6e73-109">Windows Media Player can display a property page for each DSP plug-in to enable users to set values that change the behavior of the plug-in.</span></span> <span data-ttu-id="e6e73-110">Пользователи могут получить доступ к странице свойств на вкладке " **подключаемые модули** " диалогового окна "Параметры", щелкнув имя подключаемого модуля DSP, чтобы выбрать его, а затем выбрав пункт **свойства**.</span><span class="sxs-lookup"><span data-stu-id="e6e73-110">Users can access the property page from the **Plug-ins** tab of the Options dialog box by clicking the name of the DSP plug-in to select it and then clicking **Properties**.</span></span>

<span data-ttu-id="e6e73-111">Пример кода в мастере подключаемого модуля проигрывателя Windows Media предоставляет стандартную реализацию страницы свойств, которая содержит одно поле ввода, которое получает от пользователя значение, представляющее коэффициент масштабирования для громкости звука.</span><span class="sxs-lookup"><span data-stu-id="e6e73-111">The Windows Media Player Plug-in Wizard sample code provides a default implementation of a property page that includes a single edit box that receives from the user a value representing a scale factor for the audio volume.</span></span> <span data-ttu-id="e6e73-112">Когда пользователь нажимает кнопку " **Применить**", страница свойств передает это значение в подключаемый объект, чтобы подключаемый модуль мог изменить значение, используемое для масштабирования тома во время обработки.</span><span class="sxs-lookup"><span data-stu-id="e6e73-112">When the user clicks **Apply**, the property page passes this value to the plug-in object so the plug-in can change the value it uses to scale the volume during processing.</span></span>

## <a name="about-the-property-page-object"></a><span data-ttu-id="e6e73-113">Сведения об объекте страницы свойств</span><span class="sxs-lookup"><span data-stu-id="e6e73-113">About the Property Page Object</span></span>

<span data-ttu-id="e6e73-114">Объект страницы свойств — это COM-объект, реализующий интерфейс **ипропертипаже** .</span><span class="sxs-lookup"><span data-stu-id="e6e73-114">The property page object is a COM object that implements the **IPropertyPage** interface.</span></span> <span data-ttu-id="e6e73-115">В примере кода, созданном мастером подключаемых модулей, используется реализация **ипропертипаже** в библиотеке ATL, которая описана в документации по Visual C++ на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="e6e73-115">The sample code generated by the plug-in wizard uses the ATL implementation of **IPropertyPage**, which is documented in the Visual C++ documentation on MSDN.</span></span> <span data-ttu-id="e6e73-116">Код, по крайней мере, должен предоставлять реализации переопределения для **ипропертипаже:: онинитдиалог**, который обрабатывает событие, возникающее при открытии страницы свойств, и **Ипропертипаже:: Apply**, который обрабатывает событие, происходящее при нажатии пользователем кнопки **Применить**.</span><span class="sxs-lookup"><span data-stu-id="e6e73-116">Your code at least should provide override implementations for **IPropertyPage::OnInitDialog**, which handles the event that occurs when the property page opens, and **IPropertyPage::Apply**, which handles the event that occurs when the user clicks **Apply**.</span></span> <span data-ttu-id="e6e73-117">Мастер подключаемых модулей создает пример кода для каждого из этих обработчиков событий.</span><span class="sxs-lookup"><span data-stu-id="e6e73-117">The plug-in wizard generates sample code for each of these event handlers.</span></span> <span data-ttu-id="e6e73-118">Пример реализации **онинитдиалог** извлекает значение из реестра, чтобы он мог отобразить текущий параметр коэффициента масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e6e73-118">The sample implementation of **OnInitDialog** retrieves a value from the registry so that it can display the current scale factor setting.</span></span> <span data-ttu-id="e6e73-119">Пример реализации метода **Apply** выполняет проверку вводимых пользователем данных путем тестирования, чтобы убедиться, что он попадает в указанный диапазон, затем сохраняет значение в реестр, а затем передает значение (если оно допустимо) в метод размещения DSP, именуемый **размещением \_**.</span><span class="sxs-lookup"><span data-stu-id="e6e73-119">The sample implementation of **Apply** validates the user input by testing to ensure that it falls within a specified range, then persists the value to the registry, and then passes the value (if valid) to the DSP plug-in property put method, named **put\_scale**.</span></span>

<span data-ttu-id="e6e73-120">Кроме того, необходимо добавить код, обрабатывающий событие, возникающее, когда пользователь изменяет значение в элементе управления, который вы задасте на странице свойств.</span><span class="sxs-lookup"><span data-stu-id="e6e73-120">Additionally, you will need to add code to handle the event that occurs when the user changes a value in a control you provide in the property page.</span></span> <span data-ttu-id="e6e73-121">Например, мастер подключаемых модулей реализует функцию с именем **ончанжескале**, которая просто активирует кнопку **Apply** , когда пользователь изменяет текст в поле редактирования на странице свойств, вызывая метод **Сетдирти** с значением аргумента **true**.</span><span class="sxs-lookup"><span data-stu-id="e6e73-121">For example, the plug-in wizard implements a function named **OnChangeScale**, which simply enables the **Apply** button when the user changes the text in the edit box on the property page by calling the **SetDirty** method with an argument value of **TRUE**.</span></span>

## <a name="about-the-property-page-dialog-resource"></a><span data-ttu-id="e6e73-122">Общие сведения о ресурсе диалогового окна "страница свойств"</span><span class="sxs-lookup"><span data-stu-id="e6e73-122">About the Property Page Dialog Resource</span></span>

<span data-ttu-id="e6e73-123">Пользовательский интерфейс для страницы свойств хранится в виде диалогового ресурса.</span><span class="sxs-lookup"><span data-stu-id="e6e73-123">The user interface for the property page is stored as a dialog resource.</span></span> <span data-ttu-id="e6e73-124">Можно легко просмотреть и изменить диалоговое окно страницы свойств в Visual Studio, выбрав вкладку **ресаурцевиев** в окне рабочей области проекта, открыв папку **диалогового окна** , а затем дважды щелкнув имя ресурса страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="e6e73-124">You can easily view and edit the property page dialog in Visual Studio by selecting the **ResourceView** tab in the Project Workspace window, then opening the **Dialog** folder, and then double-clicking the property page resource name.</span></span> <span data-ttu-id="e6e73-125">Редактор ресурсов диалоговых окон в Visual Studio предоставляет средства, необходимые для добавления элементов управления в диалоговое окно страницы свойств и для создания обработчиков событий, сопоставленных с соответствующими сообщениями Windows.</span><span class="sxs-lookup"><span data-stu-id="e6e73-125">The dialog resource editor in Visual Studio provides you with the tools you need to add controls to the property page dialog and to create event handlers that are mapped to the appropriate Windows messages.</span></span> <span data-ttu-id="e6e73-126">Дополнительные сведения об использовании редактора ресурсов в Visual Studio см. в справке Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e6e73-126">For details about how to use the resource editor in Visual Studio, refer to Visual Studio Help.</span></span>

## <a name="about-ispecifypropertypages"></a><span data-ttu-id="e6e73-127">О ИспеЦифипропертипажес</span><span class="sxs-lookup"><span data-stu-id="e6e73-127">About ISpecifyPropertyPages</span></span>

<span data-ttu-id="e6e73-128">Если подключаемый модуль DSP предоставляет страницу свойств, подключаемый модуль должен реализовывать интерфейс **испеЦифипропертипажес** .</span><span class="sxs-lookup"><span data-stu-id="e6e73-128">If a DSP plug-in provides a property page, the plug-in must implement the **ISpecifyPropertyPages** interface.</span></span> <span data-ttu-id="e6e73-129">Этот интерфейс содержит только один метод: **испеЦифипропертипажес::-**.</span><span class="sxs-lookup"><span data-stu-id="e6e73-129">This interface contains only one method: **ISpecifyPropertyPages::GetPages**.</span></span> <span data-ttu-id="e6e73-130">Это метод, связывающий страницу свойств с подключаемым модулем DSP.</span><span class="sxs-lookup"><span data-stu-id="e6e73-130">This is the method that associates the property page with the DSP plug-in.</span></span> <span data-ttu-id="e6e73-131">Проигрыватель Windows Media вызывает этот метод, когда пользователь вызывает страницу свойств, передавая параметр типа КАУУИД, который является массивом идентификаторов GUID.</span><span class="sxs-lookup"><span data-stu-id="e6e73-131">Windows Media Player calls this method when the user invokes the property page, passing a parameter of type CAUUID, which is a counted array of GUIDs.</span></span> <span data-ttu-id="e6e73-132">В примере реализации подключаемых модулей для служб GetObject эта **Структура заполняется** одним идентификатором GUID, который является идентификатором класса для объекта страницы свойств подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="e6e73-132">The sample plug-in implementation of **GetPages** fills this structure with a single GUID that is the class id of the plug-in property page object.</span></span> <span data-ttu-id="e6e73-133">Проигрыватель Windows Media использует идентификатор класса для создания объекта страницы свойств.</span><span class="sxs-lookup"><span data-stu-id="e6e73-133">Windows Media Player then uses the class id to create the property page object.</span></span>

<span data-ttu-id="e6e73-134">Можно заметить, что в образце реализации методов **-страниц** метод **CoTaskMemAlloc** используется для выделения памяти для структуры GUID.</span><span class="sxs-lookup"><span data-stu-id="e6e73-134">You might notice that the sample implementation of **GetPages** uses **CoTaskMemAlloc** to allocate memory for the GUID structure.</span></span> <span data-ttu-id="e6e73-135">В этом случае в проигрывателе Windows Media Вы несете ответственность за освобождение памяти с помощью **CoTaskMemFree** .</span><span class="sxs-lookup"><span data-stu-id="e6e73-135">It is the responsibility of the caller, in this case Windows Media Player, to use **CoTaskMemFree** to release the memory.</span></span> <span data-ttu-id="e6e73-136">Дополнительные сведения о структуре КАУУИД см. в документации по пакету SDK для платформы.</span><span class="sxs-lookup"><span data-stu-id="e6e73-136">For details about the CAUUID structure, see the Platform SDK documentation.</span></span>

## <a name="about-the-proxystub-dll"></a><span data-ttu-id="e6e73-137">Сведения о прокси-библиотеке DLL</span><span class="sxs-lookup"><span data-stu-id="e6e73-137">About the Proxy/Stub DLL</span></span>

<span data-ttu-id="e6e73-138">Чтобы подключаемый модуль DSP работал в проигрывателе Windows Media 11, работающем под управлением Windows Vista, необходимо предоставить библиотеку DLL прокси-сервера или заглушки для пользовательских интерфейсов, используемых для передачи изменений в параметрах из диалогового окна страницы свойств в класс подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="e6e73-138">For a DSP plug-in to work in Windows Media Player 11 running on Windows Vista, you must provide a proxy/stub DLL for custom interfaces used to communicate changes in settings from a property page dialog box to the plug-in class.</span></span> <span data-ttu-id="e6e73-139">Вызовы методов, выполненные через такие интерфейсы, должны быть упакованы при выполнении вызовов через границы процесса или апартамента.</span><span class="sxs-lookup"><span data-stu-id="e6e73-139">Method calls made through such interfaces must be marshaled when the calls are made across process or apartment boundaries.</span></span> <span data-ttu-id="e6e73-140">Последняя версия мастера подключаемых модулей создает пример проекта прокси-сервера или библиотеки DLL-заглушки.</span><span class="sxs-lookup"><span data-stu-id="e6e73-140">The latest version of the plug-in wizard creates a sample proxy/stub DLL project.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e6e73-141">См. также</span><span class="sxs-lookup"><span data-stu-id="e6e73-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e6e73-142">**Реализация подключаемого модуля DSP аудиоподсистемы**</span><span class="sxs-lookup"><span data-stu-id="e6e73-142">**Implementing an Audio DSP Plug-in**</span></span>](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




