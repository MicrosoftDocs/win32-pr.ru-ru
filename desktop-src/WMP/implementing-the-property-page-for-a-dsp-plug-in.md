---
title: Реализация страницы свойств для подключаемого модуля DSP
description: Реализация страницы свойств для подключаемого модуля DSP
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Подключаемые модули проигрывателя Windows Media, DSP аудиоподсистемы
- подключаемые модули, DSP аудиоподсистемы
- подключаемые модули обработки цифровых сигналов, свойства аудио
- Подключаемые модули DSP, звуковые свойства
- подключаемые модули DSP аудио, свойства
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888035"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a>Реализация страницы свойств для подключаемого модуля DSP

Проигрыватель Windows Media может отображать страницу свойств для каждого подключаемого модуля DSP, чтобы позволить пользователям задавать значения, изменяющие поведение подключаемого модуля. Пользователи могут получить доступ к странице свойств на вкладке " **подключаемые модули** " диалогового окна "Параметры", щелкнув имя подключаемого модуля DSP, чтобы выбрать его, а затем выбрав пункт **свойства**.

Пример кода в мастере подключаемого модуля проигрывателя Windows Media предоставляет стандартную реализацию страницы свойств, которая содержит одно поле ввода, которое получает от пользователя значение, представляющее коэффициент масштабирования для громкости звука. Когда пользователь нажимает кнопку " **Применить**", страница свойств передает это значение в подключаемый объект, чтобы подключаемый модуль мог изменить значение, используемое для масштабирования тома во время обработки.

## <a name="about-the-property-page-object"></a>Сведения об объекте страницы свойств

Объект страницы свойств — это COM-объект, реализующий интерфейс **ипропертипаже** . В примере кода, созданном мастером подключаемых модулей, используется реализация **ипропертипаже** в библиотеке ATL, которая описана в документации по Visual C++ на сайте MSDN. Код, по крайней мере, должен предоставлять реализации переопределения для **ипропертипаже:: онинитдиалог**, который обрабатывает событие, возникающее при открытии страницы свойств, и **Ипропертипаже:: Apply**, который обрабатывает событие, происходящее при нажатии пользователем кнопки **Применить**. Мастер подключаемых модулей создает пример кода для каждого из этих обработчиков событий. Пример реализации **онинитдиалог** извлекает значение из реестра, чтобы он мог отобразить текущий параметр коэффициента масштабирования. Пример реализации метода **Apply** выполняет проверку вводимых пользователем данных путем тестирования, чтобы убедиться, что он попадает в указанный диапазон, затем сохраняет значение в реестр, а затем передает значение (если оно допустимо) в метод размещения DSP, именуемый **размещением \_**.

Кроме того, необходимо добавить код, обрабатывающий событие, возникающее, когда пользователь изменяет значение в элементе управления, который вы задасте на странице свойств. Например, мастер подключаемых модулей реализует функцию с именем **ончанжескале**, которая просто активирует кнопку **Apply** , когда пользователь изменяет текст в поле редактирования на странице свойств, вызывая метод **Сетдирти** с значением аргумента **true**.

## <a name="about-the-property-page-dialog-resource"></a>Общие сведения о ресурсе диалогового окна "страница свойств"

Пользовательский интерфейс для страницы свойств хранится в виде диалогового ресурса. Можно легко просмотреть и изменить диалоговое окно страницы свойств в Visual Studio, выбрав вкладку **ресаурцевиев** в окне рабочей области проекта, открыв папку **диалогового окна** , а затем дважды щелкнув имя ресурса страницы свойств. Редактор ресурсов диалоговых окон в Visual Studio предоставляет средства, необходимые для добавления элементов управления в диалоговое окно страницы свойств и для создания обработчиков событий, сопоставленных с соответствующими сообщениями Windows. Дополнительные сведения об использовании редактора ресурсов в Visual Studio см. в справке Visual Studio.

## <a name="about-ispecifypropertypages"></a>О ИспеЦифипропертипажес

Если подключаемый модуль DSP предоставляет страницу свойств, подключаемый модуль должен реализовывать интерфейс **испеЦифипропертипажес** . Этот интерфейс содержит только один метод: **испеЦифипропертипажес::-**. Это метод, связывающий страницу свойств с подключаемым модулем DSP. Проигрыватель Windows Media вызывает этот метод, когда пользователь вызывает страницу свойств, передавая параметр типа КАУУИД, который является массивом идентификаторов GUID. В примере реализации подключаемых модулей для служб GetObject эта **Структура заполняется** одним идентификатором GUID, который является идентификатором класса для объекта страницы свойств подключаемого модуля. Проигрыватель Windows Media использует идентификатор класса для создания объекта страницы свойств.

Можно заметить, что в образце реализации методов **-страниц** метод **CoTaskMemAlloc** используется для выделения памяти для структуры GUID. В этом случае в проигрывателе Windows Media Вы несете ответственность за освобождение памяти с помощью **CoTaskMemFree** . Дополнительные сведения о структуре КАУУИД см. в документации по пакету SDK для платформы.

## <a name="about-the-proxystub-dll"></a>Сведения о прокси-библиотеке DLL

Чтобы подключаемый модуль DSP работал в проигрывателе Windows Media 11, работающем под управлением Windows Vista, необходимо предоставить библиотеку DLL прокси-сервера или заглушки для пользовательских интерфейсов, используемых для передачи изменений в параметрах из диалогового окна страницы свойств в класс подключаемого модуля. Вызовы методов, выполненные через такие интерфейсы, должны быть упакованы при выполнении вызовов через границы процесса или апартамента. Последняя версия мастера подключаемых модулей создает пример проекта прокси-сервера или библиотеки DLL-заглушки.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Реализация подключаемого модуля DSP аудиоподсистемы**](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




