---
title: Сведения о службах библиотек
description: Сведения о службах библиотек
ms.assetid: 2334aa4a-7988-481d-9b21-9f7b432fbd05
keywords:
- Проигрыватель Windows Media, Библиотека
- Объектная модель проигрывателя Windows Media, Библиотека
- Объектная модель, Библиотека
- Элемент управления ActiveX проигрывателя Windows Media, Библиотека для объектной модели
- Элемент управления ActiveX, Библиотека для объектной модели
- Элемент управления ActiveX мобильных устройств Windows Media Player, Библиотека для объектной модели
- Проигрыватель Windows Media Mobile, Библиотека для объектной модели
- Библиотека проигрывателя Windows Media, сведения
- Библиотека проигрывателя Windows Media, службы
- Библиотека, службы
- Библиотека, сведения
- версии проигрывателя Windows Media, службы библиотек
- перечисления, службы библиотек
- события, службы библиотек
- Примеры, службы библиотек
- интерфейсы, службы библиотек
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 743efc8ae5cb464aa38655314c52112bc9541de6
ms.sourcegitcommit: b04e152a7f51618fc174ffa872654623fe088db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/21/2020
ms.locfileid: "105691474"
---
# <a name="about-library-services"></a>Сведения о службах библиотек

В более ранних версиях проигрывателя Windows Media программное обеспечение использовало одну базу данных библиотеки для каждого пользователя. Эта база данных хранилась на компьютере пользователя и была концептуально привязана к пользователю и конкретному экземпляру проигрывателя.

Проигрыватель Windows Media 11 содержит основные понятия нескольких и удаленных библиотек. Теперь в дополнение к по умолчанию, или *Локальная* Библиотека, проигрыватель Windows Media может отображать содержимое, полученное из библиотек на других компьютерах, подключенных к сети, которые могут включать других пользователей, вошедших в систему на том же компьютере. Проигрыватель также может отображать представления библиотек из других источников, таких как устройства с поддержкой MTP или компакт-диски с данными. С точки зрения конечного пользователя это означает, что мультимедийное содержимое, расположенное во многих разных местах, может управляться из нескольких расположений с помощью того же привычного пользовательского интерфейса проигрывателя Windows Media. С точки зрения разработчика это означает, что вы можете использовать интерфейсы COM пакета SDK для проигрывателя Windows Media, чтобы перечислить доступные библиотеки, а затем использовать их, как и локальная библиотека в более ранних версиях.

Чтобы перечислить доступные библиотеки, используйте интерфейс **ивмплибрарисервицес** . Этот интерфейс предоставляет метод [ивмплибрарисервицес:: жеткаунтбитипе](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) , который получает количество библиотек данного типа. Типы библиотек определяются перечислением [вмплибраритипе](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) . Это перечисление включает значение для локальной библиотеки Вмплтлокал. Это обусловлено тем, что функция служб библиотеки всегда позволяет работать с локальной библиотекой с помощью **ивмплибрарисервицес** и связанных с ней интерфейсов.

> [!Note]  
> Перечисление **вмплибраритипе** включает значение вмплтремоте, представляющее библиотеки мультимедиа, общие для сети. Для доступа к этим общим библиотекам элемент управления проигрывателя должен работать в удаленном режиме. Сведения о запуске проигрывателя в удаленном режиме см. в разделе [Удаленное управление проигрывателем Windows Media](remoting-the-windows-media-player-control.md).

 

После получения счетчика библиотеки можно выполнить итерацию коллекции доступных библиотек, повторно вызвав [ивмплибрарисервицес:: жетлибрарибитипе](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) в цикле, передав новое значение индекса при каждой итерации. Этот метод получает указатель на интерфейс [ивмплибрари](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) , представляющий отдельную библиотеку.

После получения указателя на **ивмплибрари** можно вызвать [ивмплибрари:: Get \_ медиаколлектион](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) , чтобы получить указатель на интерфейс **ивмпмедиаколлектион** . С помощью этого указателя интерфейса можно работать с отдельной библиотекой так же, как при использовании локальной библиотеки. Можно также получить строку, содержащую имя библиотеки, вызвав [ивмплибрари:: Get \_ Name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), которая полезна, если необходимо отобразить имя библиотеки для пользователя. Можно вызвать [ивмплибрари:: Get \_ Type](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) , чтобы получить **вмплибраритипе** определенной библиотеки.

Можно выполнить обработку события [IWMPEvents3:: либрариконнект](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) , чтобы выяснить, когда библиотека станет доступной, и событие [IWMPEvents3:: либраридисконнект](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) , чтобы известно, когда библиотека отключается. Каждое из этих событий предоставляет указатель **ивмплибрари** , представляющий библиотеку, которая подключена или отключена. Можно вызвать [ивмплибрари:: тождественно](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) , чтобы определить, является ли библиотека, которая подключена или отключена, библиотекой, которую вы используете в данный момент.

Существуют некоторые важные отличия при работе с библиотекой, полученной через интерфейс **ивмплибрарисервицес** , по сравнению с работой с библиотекой, полученной с помощью [ивмпкоре:: Get \_ медиаколлектион](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection). Существуют следующие отличия.

-   Обычно результаты запроса можно получить гораздо быстрее из библиотек, полученных через **ивмплибрарисервицес**. (Предполагается, что другие факторы, такие как время доступа к сети и жесткому диску, равны.)
-   Список атрибутов метаданных элементов мультимедиа, доступных из библиотек, полученных с помощью **ивмплибрарисервицес** , обычно является подмножеством, доступным из локальной библиотеки, полученной с помощью [ивмпкоре](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).
-   При извлечении локальной библиотеки с помощью **ивмплибрарисервицес** все атрибуты, доступные при извлечении локальной библиотеки через **ивмпкоре**, будут доступны для использования. Тем не менее вы сможете быстрее получать результаты запроса для наиболее часто используемых атрибутов.
-   Коллекции строк следует использовать для создания элементов пользовательского интерфейса при работе с библиотеками, полученными через **ивмплибрарисервицес**. Например, [IWMPMediaCollection2:: жетстрингколлектионбикуери](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) позволяет использовать пользовательский запрос (представленный интерфейсом **ивмпкуери** ) для получения коллекции строк.
-   Удаленные библиотеки, полученные через интерфейс **ивмплибрарисервицес** , могут не всегда быть подключены к текущему экземпляру проигрывателя. Это означает, что важно управлять событиями **либрариконнект** и **либраридисконнект** , чтобы они были осведомлены об изменении доступности библиотеки, а также о событии [IWMPEvents3:: стрингколлектиончанже](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) , чтобы иметь представление о добавлении или удалении строк из коллекций строк, используемых для вывода элементов пользовательского интерфейса. Также следует обрабатывайте события **стрингколлектиончанже** для локальной библиотеки по тем же причинам.

Важно понимать, что коллекции строк для определенной библиотеки могут измениться в любое время. Коллекция строк может быть пустой при первом извлечении, как в случае с библиотекой, которая была недавно соединена, но еще не перечисляет ее содержимое. И наоборот, коллекция строк может уже содержать всю необходимую информацию. В этом случае вы можете никогда не получить событие **стрингколлектиончанже** , так как содержимое библиотеки было полностью перечислено до создания запроса и никакие другие изменения не изменяются.

Таким образом, чтобы обеспечить актуальность пользовательского интерфейса, необходимо перечислить содержимое коллекции строк при получении интерфейса **ивмпстрингколлектион** и обменять событие **стрингколлектиончанже** для получения сведений об обновлениях, когда они происходят.

## <a name="sample"></a>Образец

Пример с именем ВМПМЛ демонстрирует работу со службами библиотек. Дополнительные сведения о примерах пакета SDK для проигрывателя Windows Media см. в разделе [образцы](samples.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Сведения о библиотеке**](about-the-library.md)
</dt> <dt>

[**Сведения об объекте Query**](about-the-query-object.md)
</dt> <dt>

[**Интерфейс IWMPEvents3**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpevents3)
</dt> <dt>

[**Интерфейс Ивмплибрари**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary)
</dt> <dt>

[**Интерфейс Ивмплибрари (VB и C#)**](iwmplibrary--vb-and-c.md)
</dt> <dt>

[**Интерфейс Ивмплибрарисервицес**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibraryservices)
</dt> <dt>

[**Интерфейс Ивмплибрарисервицес (VB и C#)**](iwmplibraryservices--vb-and-c.md)
</dt> <dt>

[**Интерфейс Ивмпмедиаколлектион**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpmediacollection)
</dt> <dt>

[**Интерфейс Ивмпмедиаколлектион (VB и C#)**](iwmpmediacollection--vb-and-c.md)
</dt> <dt>

[**Интерфейс Ивмпстрингколлектион**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpstringcollection)
</dt> <dt>

[**Интерфейс Ивмпстрингколлектион (VB и C#)**](iwmpstringcollection--vb-and-c.md)
</dt> <dt>

[**Интерфейс Ивмпкуери**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpquery)
</dt> <dt>

[**Интерфейс Ивмпкуери (VB и C#)**](iwmpquery--vb-and-c.md)
</dt> <dt>

[**Работа с библиотекой**](working-with-the-library.md)
</dt> </dl>

 

 




