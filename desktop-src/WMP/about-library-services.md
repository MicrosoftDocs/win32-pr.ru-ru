---
title: Сведения о службах библиотек
description: Сведения о службах библиотек
ms.assetid: 2334aa4a-7988-481d-9b21-9f7b432fbd05
keywords:
- Проигрыватель Windows Media, Библиотека
- Объектная модель проигрывателя Windows Media, Библиотека
- Объектная модель, Библиотека
- Элемент управления ActiveX проигрывателя Windows Media, Библиотека для объектной модели
- Элемент управления ActiveX, Библиотека для объектной модели
- Элемент управления ActiveX мобильных устройств Windows Media Player, Библиотека для объектной модели
- Проигрыватель Windows Media Mobile, Библиотека для объектной модели
- Библиотека проигрывателя Windows Media, сведения
- Библиотека проигрывателя Windows Media, службы
- Библиотека, службы
- Библиотека, сведения
- версии проигрывателя Windows Media, службы библиотек
- перечисления, службы библиотек
- события, службы библиотек
- Примеры, службы библиотек
- интерфейсы, службы библиотек
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 743efc8ae5cb464aa38655314c52112bc9541de6
ms.sourcegitcommit: b04e152a7f51618fc174ffa872654623fe088db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/21/2020
ms.locfileid: "105691474"
---
# <a name="about-library-services"></a><span data-ttu-id="352b2-119">Сведения о службах библиотек</span><span class="sxs-lookup"><span data-stu-id="352b2-119">About Library Services</span></span>

<span data-ttu-id="352b2-120">В более ранних версиях проигрывателя Windows Media программное обеспечение использовало одну базу данных библиотеки для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="352b2-120">In earlier versions of Windows Media Player, the software used a single library database for each user.</span></span> <span data-ttu-id="352b2-121">Эта база данных хранилась на компьютере пользователя и была концептуально привязана к пользователю и конкретному экземпляру проигрывателя.</span><span class="sxs-lookup"><span data-stu-id="352b2-121">This database was stored on the user's computer and was conceptually tied to the user and a particular instance of the Player.</span></span>

<span data-ttu-id="352b2-122">Проигрыватель Windows Media 11 содержит основные понятия нескольких и удаленных библиотек.</span><span class="sxs-lookup"><span data-stu-id="352b2-122">Windows Media Player 11 introduces the concepts of multiple and remote libraries.</span></span> <span data-ttu-id="352b2-123">Теперь в дополнение к по умолчанию, или *Локальная* Библиотека, проигрыватель Windows Media может отображать содержимое, полученное из библиотек на других компьютерах, подключенных к сети, которые могут включать других пользователей, вошедших в систему на том же компьютере.</span><span class="sxs-lookup"><span data-stu-id="352b2-123">Now, in addition to its default, or *local*, library, Windows Media Player can display content retrieved from libraries on other computers connected to a network, which might include other users logged on to the same computer.</span></span> <span data-ttu-id="352b2-124">Проигрыватель также может отображать представления библиотек из других источников, таких как устройства с поддержкой MTP или компакт-диски с данными.</span><span class="sxs-lookup"><span data-stu-id="352b2-124">The Player can also display library views from other sources, such as MTP-enabled devices or data CDs.</span></span> <span data-ttu-id="352b2-125">С точки зрения конечного пользователя это означает, что мультимедийное содержимое, расположенное во многих разных местах, может управляться из нескольких расположений с помощью того же привычного пользовательского интерфейса проигрывателя Windows Media.</span><span class="sxs-lookup"><span data-stu-id="352b2-125">From the end user's perspective, this means that digital media content located in many different places can be managed from multiple locations by using the same, familiar Windows Media Player user interface.</span></span> <span data-ttu-id="352b2-126">С точки зрения разработчика это означает, что вы можете использовать интерфейсы COM пакета SDK для проигрывателя Windows Media, чтобы перечислить доступные библиотеки, а затем использовать их, как и локальная библиотека в более ранних версиях.</span><span class="sxs-lookup"><span data-stu-id="352b2-126">From the developer's perspective, this means that you can use the Windows Media Player SDK COM interfaces to enumerate the available libraries and then use them like you have used the local library in earlier versions.</span></span>

<span data-ttu-id="352b2-127">Чтобы перечислить доступные библиотеки, используйте интерфейс **ивмплибрарисервицес** .</span><span class="sxs-lookup"><span data-stu-id="352b2-127">To enumerate the available libraries, use the **IWMPLibraryServices** interface.</span></span> <span data-ttu-id="352b2-128">Этот интерфейс предоставляет метод [ивмплибрарисервицес:: жеткаунтбитипе](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) , который получает количество библиотек данного типа.</span><span class="sxs-lookup"><span data-stu-id="352b2-128">This interface exposes the [IWMPLibraryServices::getCountByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) method, which retrieves the count of libraries of a given type.</span></span> <span data-ttu-id="352b2-129">Типы библиотек определяются перечислением [вмплибраритипе](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) .</span><span class="sxs-lookup"><span data-stu-id="352b2-129">Library types are defined by the [WMPLibraryType](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) enumeration.</span></span> <span data-ttu-id="352b2-130">Это перечисление включает значение для локальной библиотеки Вмплтлокал.</span><span class="sxs-lookup"><span data-stu-id="352b2-130">This enumeration includes a value for the local library, wmpltLocal.</span></span> <span data-ttu-id="352b2-131">Это обусловлено тем, что функция служб библиотеки всегда позволяет работать с локальной библиотекой с помощью **ивмплибрарисервицес** и связанных с ней интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="352b2-131">This is because the library services feature always enables you work with the local library by using **IWMPLibraryServices** and the related interfaces.</span></span>

> [!Note]  
> <span data-ttu-id="352b2-132">Перечисление **вмплибраритипе** включает значение вмплтремоте, представляющее библиотеки мультимедиа, общие для сети.</span><span class="sxs-lookup"><span data-stu-id="352b2-132">The **WMPLibraryType** enumeration includes the value wmpltRemote, which represents media libraries shared by the network.</span></span> <span data-ttu-id="352b2-133">Для доступа к этим общим библиотекам элемент управления проигрывателя должен работать в удаленном режиме.</span><span class="sxs-lookup"><span data-stu-id="352b2-133">To access those shared libraries, the Player control must be running in remote mode.</span></span> <span data-ttu-id="352b2-134">Сведения о запуске проигрывателя в удаленном режиме см. в разделе [Удаленное управление проигрывателем Windows Media](remoting-the-windows-media-player-control.md).</span><span class="sxs-lookup"><span data-stu-id="352b2-134">For information about running the Player control in remote mode, see [Remoting the Windows Media Player Control](remoting-the-windows-media-player-control.md).</span></span>

 

<span data-ttu-id="352b2-135">После получения счетчика библиотеки можно выполнить итерацию коллекции доступных библиотек, повторно вызвав [ивмплибрарисервицес:: жетлибрарибитипе](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) в цикле, передав новое значение индекса при каждой итерации.</span><span class="sxs-lookup"><span data-stu-id="352b2-135">After you retrieve the library count, you can iterate the collection of available libraries by repeatedly calling [IWMPLibraryServices::getLibraryByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) in a loop, passing a new index value with each iteration.</span></span> <span data-ttu-id="352b2-136">Этот метод получает указатель на интерфейс [ивмплибрари](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) , представляющий отдельную библиотеку.</span><span class="sxs-lookup"><span data-stu-id="352b2-136">This method retrieves a pointer to an [IWMPLibrary](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) interface, which represents the individual library.</span></span>

<span data-ttu-id="352b2-137">После получения указателя на **ивмплибрари** можно вызвать [ивмплибрари:: Get \_ медиаколлектион](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) , чтобы получить указатель на интерфейс **ивмпмедиаколлектион** .</span><span class="sxs-lookup"><span data-stu-id="352b2-137">After you retrieve a pointer to **IWMPLibrary**, you can call [IWMPLibrary::get\_mediaCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) to retrieve a pointer to an **IWMPMediaCollection** interface.</span></span> <span data-ttu-id="352b2-138">С помощью этого указателя интерфейса можно работать с отдельной библиотекой так же, как при использовании локальной библиотеки.</span><span class="sxs-lookup"><span data-stu-id="352b2-138">With this interface pointer, you can work with an individual library much like you would use the local library.</span></span> <span data-ttu-id="352b2-139">Можно также получить строку, содержащую имя библиотеки, вызвав [ивмплибрари:: Get \_ Name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), которая полезна, если необходимо отобразить имя библиотеки для пользователя.</span><span class="sxs-lookup"><span data-stu-id="352b2-139">You can also retrieve a string containing the name of the library by calling [IWMPLibrary::get\_name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), which is useful if you need to display the library name to the user.</span></span> <span data-ttu-id="352b2-140">Можно вызвать [ивмплибрари:: Get \_ Type](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) , чтобы получить **вмплибраритипе** определенной библиотеки.</span><span class="sxs-lookup"><span data-stu-id="352b2-140">You can call [IWMPLibrary::get\_type](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) to get the **WMPLibraryType** of a particular library.</span></span>

<span data-ttu-id="352b2-141">Можно выполнить обработку события [IWMPEvents3:: либрариконнект](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) , чтобы выяснить, когда библиотека станет доступной, и событие [IWMPEvents3:: либраридисконнект](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) , чтобы известно, когда библиотека отключается.</span><span class="sxs-lookup"><span data-stu-id="352b2-141">You can handle the [IWMPEvents3::LibraryConnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) event to know when a library becomes available and the [IWMPEvents3::LibraryDisconnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) event to know when a library disconnects.</span></span> <span data-ttu-id="352b2-142">Каждое из этих событий предоставляет указатель **ивмплибрари** , представляющий библиотеку, которая подключена или отключена.</span><span class="sxs-lookup"><span data-stu-id="352b2-142">Each of these events provides an **IWMPLibrary** pointer that represents the library that connected or disconnected.</span></span> <span data-ttu-id="352b2-143">Можно вызвать [ивмплибрари:: тождественно](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) , чтобы определить, является ли библиотека, которая подключена или отключена, библиотекой, которую вы используете в данный момент.</span><span class="sxs-lookup"><span data-stu-id="352b2-143">You can call [IWMPLibrary::isIdentical](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) to determine whether the library that connected or disconnected is a library that you are currently using.</span></span>

<span data-ttu-id="352b2-144">Существуют некоторые важные отличия при работе с библиотекой, полученной через интерфейс **ивмплибрарисервицес** , по сравнению с работой с библиотекой, полученной с помощью [ивмпкоре:: Get \_ медиаколлектион](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection).</span><span class="sxs-lookup"><span data-stu-id="352b2-144">There are some important differences when you work with a library retrieved through the **IWMPLibraryServices** interface compared to working with a library retrieved by using [IWMPCore::get\_mediaCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection).</span></span> <span data-ttu-id="352b2-145">Существуют следующие отличия.</span><span class="sxs-lookup"><span data-stu-id="352b2-145">The following differences apply:</span></span>

-   <span data-ttu-id="352b2-146">Обычно результаты запроса можно получить гораздо быстрее из библиотек, полученных через **ивмплибрарисервицес**.</span><span class="sxs-lookup"><span data-stu-id="352b2-146">You can usually retrieve query results much faster from libraries retrieved through **IWMPLibraryServices**.</span></span> <span data-ttu-id="352b2-147">(Предполагается, что другие факторы, такие как время доступа к сети и жесткому диску, равны.)</span><span class="sxs-lookup"><span data-stu-id="352b2-147">(This assumes that other factors such as network and hard disk access times are equal.)</span></span>
-   <span data-ttu-id="352b2-148">Список атрибутов метаданных элементов мультимедиа, доступных из библиотек, полученных с помощью **ивмплибрарисервицес** , обычно является подмножеством, доступным из локальной библиотеки, полученной с помощью [ивмпкоре](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).</span><span class="sxs-lookup"><span data-stu-id="352b2-148">The list of media item metadata attributes available from libraries retrieved through **IWMPLibraryServices** is usually a subset of those available from the local library retrieved through [IWMPCore](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).</span></span>
-   <span data-ttu-id="352b2-149">При извлечении локальной библиотеки с помощью **ивмплибрарисервицес** все атрибуты, доступные при извлечении локальной библиотеки через **ивмпкоре**, будут доступны для использования.</span><span class="sxs-lookup"><span data-stu-id="352b2-149">If you retrieve the local library through **IWMPLibraryServices**, all of the same attributes are available for your use as those available when you retrieve the local library through **IWMPCore**.</span></span> <span data-ttu-id="352b2-150">Тем не менее вы сможете быстрее получать результаты запроса для наиболее часто используемых атрибутов.</span><span class="sxs-lookup"><span data-stu-id="352b2-150">However, you will be able to retrieve query results much faster for the most commonly-used attributes.</span></span>
-   <span data-ttu-id="352b2-151">Коллекции строк следует использовать для создания элементов пользовательского интерфейса при работе с библиотеками, полученными через **ивмплибрарисервицес**.</span><span class="sxs-lookup"><span data-stu-id="352b2-151">You should use string collections to create user interface elements when you work with libraries retrieved through **IWMPLibraryServices**.</span></span> <span data-ttu-id="352b2-152">Например, [IWMPMediaCollection2:: жетстрингколлектионбикуери](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) позволяет использовать пользовательский запрос (представленный интерфейсом **ивмпкуери** ) для получения коллекции строк.</span><span class="sxs-lookup"><span data-stu-id="352b2-152">For example, [IWMPMediaCollection2::getStringCollectionByQuery](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) enables you to use a custom query (represented by the **IWMPQuery** interface) to retrieve a string collection.</span></span>
-   <span data-ttu-id="352b2-153">Удаленные библиотеки, полученные через интерфейс **ивмплибрарисервицес** , могут не всегда быть подключены к текущему экземпляру проигрывателя.</span><span class="sxs-lookup"><span data-stu-id="352b2-153">Remote libraries retrieved through the **IWMPLibraryServices** interface might not always be connected to the current Player instance.</span></span> <span data-ttu-id="352b2-154">Это означает, что важно управлять событиями **либрариконнект** и **либраридисконнект** , чтобы они были осведомлены об изменении доступности библиотеки, а также о событии [IWMPEvents3:: стрингколлектиончанже](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) , чтобы иметь представление о добавлении или удалении строк из коллекций строк, используемых для вывода элементов пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="352b2-154">This means that it is important to handle the **LibraryConnect** and **LibraryDisconnect** events to know when library availability changes, and to handle the [IWMPEvents3::StringCollectionChange](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) event to know when strings are added to or removed from the string collections you use to display user interface elements.</span></span> <span data-ttu-id="352b2-155">Также следует обрабатывайте события **стрингколлектиончанже** для локальной библиотеки по тем же причинам.</span><span class="sxs-lookup"><span data-stu-id="352b2-155">You should also handle **StringCollectionChange** events for the local library for similar reasons.</span></span>

<span data-ttu-id="352b2-156">Важно понимать, что коллекции строк для определенной библиотеки могут измениться в любое время.</span><span class="sxs-lookup"><span data-stu-id="352b2-156">It is important to understand that string collections for a particular library can change at any time.</span></span> <span data-ttu-id="352b2-157">Коллекция строк может быть пустой при первом извлечении, как в случае с библиотекой, которая была недавно соединена, но еще не перечисляет ее содержимое.</span><span class="sxs-lookup"><span data-stu-id="352b2-157">A string collection could be empty when you first retrieve it, as in the case of a library that has recently connected but the Player has not yet enumerated its contents.</span></span> <span data-ttu-id="352b2-158">И наоборот, коллекция строк может уже содержать всю необходимую информацию.</span><span class="sxs-lookup"><span data-stu-id="352b2-158">Conversely, a string collection might already contain all the information you need.</span></span> <span data-ttu-id="352b2-159">В этом случае вы можете никогда не получить событие **стрингколлектиончанже** , так как содержимое библиотеки было полностью перечислено до создания запроса и никакие другие изменения не изменяются.</span><span class="sxs-lookup"><span data-stu-id="352b2-159">In this case, you might never receive a **StringCollectionChange** event because the library's contents had been completely enumerated before you created your query and nothing else is changing.</span></span>

<span data-ttu-id="352b2-160">Таким образом, чтобы обеспечить актуальность пользовательского интерфейса, необходимо перечислить содержимое коллекции строк при получении интерфейса **ивмпстрингколлектион** и обменять событие **стрингколлектиончанже** для получения сведений об обновлениях, когда они происходят.</span><span class="sxs-lookup"><span data-stu-id="352b2-160">Therefore, to keep your user interface current, you must both enumerate the string collection contents when you retrieve the **IWMPStringCollection** interface and handle the **StringCollectionChange** event to know about updates when they happen.</span></span>

## <a name="sample"></a><span data-ttu-id="352b2-161">Образец</span><span class="sxs-lookup"><span data-stu-id="352b2-161">Sample</span></span>

<span data-ttu-id="352b2-162">Пример с именем ВМПМЛ демонстрирует работу со службами библиотек.</span><span class="sxs-lookup"><span data-stu-id="352b2-162">The sample named WMPML demonstrates how to work with library services.</span></span> <span data-ttu-id="352b2-163">Дополнительные сведения о примерах пакета SDK для проигрывателя Windows Media см. в разделе [образцы](samples.md).</span><span class="sxs-lookup"><span data-stu-id="352b2-163">For more information about Windows Media Player SDK samples, see [Samples](samples.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="352b2-164">См. также</span><span class="sxs-lookup"><span data-stu-id="352b2-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="352b2-165">**Сведения о библиотеке**</span><span class="sxs-lookup"><span data-stu-id="352b2-165">**About the Library**</span></span>](about-the-library.md)
</dt> <dt>

[<span data-ttu-id="352b2-166">**Сведения об объекте Query**</span><span class="sxs-lookup"><span data-stu-id="352b2-166">**About the Query Object**</span></span>](about-the-query-object.md)
</dt> <dt>

[<span data-ttu-id="352b2-167">**Интерфейс IWMPEvents3**</span><span class="sxs-lookup"><span data-stu-id="352b2-167">**IWMPEvents3 Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpevents3)
</dt> <dt>

[<span data-ttu-id="352b2-168">**Интерфейс Ивмплибрари**</span><span class="sxs-lookup"><span data-stu-id="352b2-168">**IWMPLibrary Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary)
</dt> <dt>

[<span data-ttu-id="352b2-169">**Интерфейс Ивмплибрари (VB и C#)**</span><span class="sxs-lookup"><span data-stu-id="352b2-169">**IWMPLibrary Interface (VB and C#)**</span></span>](iwmplibrary--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="352b2-170">**Интерфейс Ивмплибрарисервицес**</span><span class="sxs-lookup"><span data-stu-id="352b2-170">**IWMPLibraryServices Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibraryservices)
</dt> <dt>

[<span data-ttu-id="352b2-171">**Интерфейс Ивмплибрарисервицес (VB и C#)**</span><span class="sxs-lookup"><span data-stu-id="352b2-171">**IWMPLibraryServices Interface (VB and C#)**</span></span>](iwmplibraryservices--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="352b2-172">**Интерфейс Ивмпмедиаколлектион**</span><span class="sxs-lookup"><span data-stu-id="352b2-172">**IWMPMediaCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpmediacollection)
</dt> <dt>

[<span data-ttu-id="352b2-173">**Интерфейс Ивмпмедиаколлектион (VB и C#)**</span><span class="sxs-lookup"><span data-stu-id="352b2-173">**IWMPMediaCollection Interface (VB and C#)**</span></span>](iwmpmediacollection--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="352b2-174">**Интерфейс Ивмпстрингколлектион**</span><span class="sxs-lookup"><span data-stu-id="352b2-174">**IWMPStringCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpstringcollection)
</dt> <dt>

[<span data-ttu-id="352b2-175">**Интерфейс Ивмпстрингколлектион (VB и C#)**</span><span class="sxs-lookup"><span data-stu-id="352b2-175">**IWMPStringCollection Interface (VB and C#)**</span></span>](iwmpstringcollection--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="352b2-176">**Интерфейс Ивмпкуери**</span><span class="sxs-lookup"><span data-stu-id="352b2-176">**IWMPQuery Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpquery)
</dt> <dt>

[<span data-ttu-id="352b2-177">**Интерфейс Ивмпкуери (VB и C#)**</span><span class="sxs-lookup"><span data-stu-id="352b2-177">**IWMPQuery Interface (VB and C#)**</span></span>](iwmpquery--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="352b2-178">**Работа с библиотекой**</span><span class="sxs-lookup"><span data-stu-id="352b2-178">**Working with the Library**</span></span>](working-with-the-library.md)
</dt> </dl>

 

 




