---
description: Интерфейс поставщика услуг безопасности (SSPI) предоставляет универсальный промышленно-стандартный интерфейс для защищенных распределенных приложений.
ms.assetid: c3cebb9d-9094-493f-96d3-763a0c282dfb
title: Поставщики услуг безопасности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b2121940337d0f4e06c53981cf30f0125180c466
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105663962"
---
# <a name="security-service-providers"></a><span data-ttu-id="f0908-103">Поставщики услуг безопасности</span><span class="sxs-lookup"><span data-stu-id="f0908-103">Security Service Providers</span></span>

<span data-ttu-id="f0908-104">Интерфейс поставщика услуг безопасности (SSPI) предоставляет универсальный промышленно-стандартный интерфейс для защищенных распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="f0908-104">The Security Service Provider Interface (SSPI) provides a universal, industry-standard interface for secure distributed applications.</span></span> <span data-ttu-id="f0908-105">API-интерфейс одноранговых диаграмм предоставляет приложениям возможность защиты ссылок в графе путем указания поставщика службы безопасности (SSP), который является библиотекой DLL, реализующей интерфейс SSPI.</span><span class="sxs-lookup"><span data-stu-id="f0908-105">The Peer Graphing API provides a way for applications to secure links in a graph by specifying a Security Service Provider (SSP), which is a DLL that implements an SSPI interface.</span></span> <span data-ttu-id="f0908-106">Приложение указывает SSP при создании графа с помощью [**пирграфкреате**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="f0908-106">An application specifies an SSP when it creates a graph by using [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span>

<span data-ttu-id="f0908-107">Дополнительные сведения о создании собственного поставщика общих служб см. в справочной документации по SSPI в списке [справочников по графике](graphing-reference-links.md).</span><span class="sxs-lookup"><span data-stu-id="f0908-107">For more information about creating your own SSP, see the SSPI documentation link in the list of [Graphing Reference Links](graphing-reference-links.md).</span></span>

## <a name="programming-considerations-for-implementing-an-ssp"></a><span data-ttu-id="f0908-108">Рекомендации по программированию для реализации поставщика общих служб</span><span class="sxs-lookup"><span data-stu-id="f0908-108">Programming Considerations for Implementing an SSP</span></span>

<span data-ttu-id="f0908-109">Будьте внимательны при вызове приложения из поставщика общих служб.</span><span class="sxs-lookup"><span data-stu-id="f0908-109">Use caution when calling into an application from within an SSP.</span></span> <span data-ttu-id="f0908-110">Следующие рекомендации относятся к обратным вызовам SSP:</span><span class="sxs-lookup"><span data-stu-id="f0908-110">The following considerations apply to SSP callbacks:</span></span>

-   <span data-ttu-id="f0908-111">Возвращаемые обратные вызовы не должны занимать много времени, так как они вызываются во время согласования соединения.</span><span class="sxs-lookup"><span data-stu-id="f0908-111">Callbacks should not take a long time to return, because they are called during connection negotiation.</span></span> <span data-ttu-id="f0908-112">Если соединение установлено слишком долго, соединение может быть удалено.</span><span class="sxs-lookup"><span data-stu-id="f0908-112">If it takes too long for a connection to be established, the connection can be dropped.</span></span>
-   <span data-ttu-id="f0908-113">API одноранговых диаграмм динамически корректирует значения времени ожидания соединения в зависимости от фактической нагрузки системы.</span><span class="sxs-lookup"><span data-stu-id="f0908-113">The Peer Graphing API dynamically adjusts connection timeout values, based on the actual load of a system.</span></span> <span data-ttu-id="f0908-114">Наименьшее значение времени ожидания — 20 секунд.</span><span class="sxs-lookup"><span data-stu-id="f0908-114">The lowest timeout value is 20 seconds.</span></span>
-   <span data-ttu-id="f0908-115">Чтобы избежать потенциальных ситуаций взаимоблокировки, приложение не должно получать доступ к базе данных одноранговых диаграмм из обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="f0908-115">To avoid potential deadlock situations, an application must not access the peer graphing database from a callback.</span></span> <span data-ttu-id="f0908-116">Если приложению требуются сведения из базы данных Graph, приложение может кэшировать необходимую информацию, а затем ссылаться на кэш из обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="f0908-116">If an application requires information from the graphing database, the application can cache the necessary information, and then refer to the cache from within the callback.</span></span> <span data-ttu-id="f0908-117">Кэширование также может помочь уменьшить время подключения.</span><span class="sxs-lookup"><span data-stu-id="f0908-117">Caching can also help decrease connection time.</span></span>

<span data-ttu-id="f0908-118">При вызове точек входа SSPI Инфраструктура одноранговых диаграмм требует определенные значения для конкретных параметров пяти (5) функций.</span><span class="sxs-lookup"><span data-stu-id="f0908-118">When calling the SSPI entry points, the Peer Graphing Infrastructure requires specific values for specific parameters of five (5) functions.</span></span> <span data-ttu-id="f0908-119">Вы не можете изменить эти значения параметров для SSP, и поставщик общих служб может либо проигнорировать значения для этих пяти параметров, либо правильно обработать их.</span><span class="sxs-lookup"><span data-stu-id="f0908-119">You cannot change these parameter values provided to SSP, and the SSP can either ignore the values for the five parameters or handle them gracefully.</span></span> <span data-ttu-id="f0908-120">В следующем списке указаны указанные параметры и необходимые значения.</span><span class="sxs-lookup"><span data-stu-id="f0908-120">The following list identifies these specific parameters and required values:</span></span>

-   [<span data-ttu-id="f0908-121">**AcquireCredentialsHandle**</span><span class="sxs-lookup"><span data-stu-id="f0908-121">**AcquireCredentialsHandle**</span></span>](graphing-reference-links.md)

    <span data-ttu-id="f0908-122">Укажите один (1) для параметра *пвжеткэйаргумент* .</span><span class="sxs-lookup"><span data-stu-id="f0908-122">Specify one (1) for the *pvGetKeyArgument* parameter.</span></span> <span data-ttu-id="f0908-123">Указывает **значение NULL** для параметров *псзпринЦипал*, *пвлогонид* и *пжеткэйфн* .</span><span class="sxs-lookup"><span data-stu-id="f0908-123">Specifies **NULL** for the *pszPrincipal*, *pvLogonID*, and *pGetKeyFn* parameters.</span></span>

-   [<span data-ttu-id="f0908-124">**InitializeSecurityContext**</span><span class="sxs-lookup"><span data-stu-id="f0908-124">**InitializeSecurityContext**</span></span>](graphing-reference-links.md)

    <span data-ttu-id="f0908-125">Укажите следующие флаги для параметра *фконтекстрек* : **ISC \_ req \_ взаимная \_ Проверка подлинности \| ISC \_ Заявка для \_ конфиденциальной \| \_ \_ \| \_ \_ \_ \| \_ \_ \| \_ \_ \_** информации ISC req Integrity</span><span class="sxs-lookup"><span data-stu-id="f0908-125">Specify the following flags for the *fContextReq* parameter: **ISC\_REQ\_MUTUAL\_AUTH \| ISC\_REQ\_CONFIDENTIALITY \| ISC\_REQ\_INTEGRITY \| ISC\_REQ\_SEQUENCE\_DETECT \| ISC\_REQ\_STREAM \| ISC\_REQ\_ALLOCATE\_MEMORY**.</span></span>

-   [<span data-ttu-id="f0908-126">**AcceptSecurityContext**</span><span class="sxs-lookup"><span data-stu-id="f0908-126">**AcceptSecurityContext**</span></span>](graphing-reference-links.md)

    <span data-ttu-id="f0908-127">Укажите следующие флаги для параметра *фконтекстрек* : **ASC \_ req \_ взаимная \_ Проверка подлинности ASC req \| \_ \_ \| \_ Integrity ASC требования \_ целостность \| ASC req. \_ \_ \_ определение \| ASC \_ req \_ Stream \| ASC \_ требования \_ выделить \_ память**.</span><span class="sxs-lookup"><span data-stu-id="f0908-127">Specify the following flags for the *fContextReq* parameter: **ASC\_REQ\_MUTUAL\_AUTH \| ASC\_REQ\_CONFIDENTIALITY \| ASC\_REQ\_INTEGRITY \| ASC\_REQ\_SEQUENCE\_DETECT \| ASC\_REQ\_STREAM \| ASC\_REQ\_ALLOCATE\_MEMORY**.</span></span>

-   [<span data-ttu-id="f0908-128">**енкриптмессаже**</span><span class="sxs-lookup"><span data-stu-id="f0908-128">**EncryptMessage**</span></span>](graphing-reference-links.md)

    <span data-ttu-id="f0908-129">Укажите ноль (0) для параметров *фкоп* и *мессажесекно* .</span><span class="sxs-lookup"><span data-stu-id="f0908-129">Specify zero (0) for the *fQOP* and *MessageSeqNo* parameters.</span></span>

-   [<span data-ttu-id="f0908-130">**декриптмессаже**</span><span class="sxs-lookup"><span data-stu-id="f0908-130">**DecryptMessage**</span></span>](graphing-reference-links.md)

    <span data-ttu-id="f0908-131">Укажите ноль (0) для параметра *мессажесекно* и **значение NULL** для параметра *пфкоп* .</span><span class="sxs-lookup"><span data-stu-id="f0908-131">Specify zero (0) for the *MessageSeqNo* parameter and **NULL** for the *pfQOP* parameter.</span></span>

<span data-ttu-id="f0908-132">При вызове [**енкриптмессаже**](graphing-reference-links.md)в структуру **секбуффердеск** передается четыре буфера.</span><span class="sxs-lookup"><span data-stu-id="f0908-132">When calling [**EncryptMessage**](graphing-reference-links.md), four buffers are passed in the **SecBufferDesc** structure.</span></span> <span data-ttu-id="f0908-133">В следующей таблице указывается порядок передачи буферов.</span><span class="sxs-lookup"><span data-stu-id="f0908-133">The following table identifies the order to pass the buffers.</span></span>

| <span data-ttu-id="f0908-134">Структура, относящаяся к поставщику общих служб</span><span class="sxs-lookup"><span data-stu-id="f0908-134">SSP-specific structure</span></span>         | <span data-ttu-id="f0908-135">Описание</span><span class="sxs-lookup"><span data-stu-id="f0908-135">Description</span></span>                                                                                                                                                                                                       |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f0908-136">**\_заголовок потока \_ pvbuffer**</span><span class="sxs-lookup"><span data-stu-id="f0908-136">**SECBUFFER\_STREAM\_HEADER**</span></span>  | <span data-ttu-id="f0908-137">Содержит данные заголовка безопасности.</span><span class="sxs-lookup"><span data-stu-id="f0908-137">Contains the security header data.</span></span> <span data-ttu-id="f0908-138">Размер буфера заголовков получается путем вызова [**QueryContextAttributes**](graphing-reference-links.md) и указания атрибута **\_ \_ \_ Размер потока SECPKG attr** .</span><span class="sxs-lookup"><span data-stu-id="f0908-138">The size of the header buffer is obtained by calling [**QueryContextAttributes**](graphing-reference-links.md) and specifying the **SECPKG\_ATTR\_STREAM\_SIZES** attribute.</span></span>  |
| <span data-ttu-id="f0908-139">**\_данные pvbuffer**</span><span class="sxs-lookup"><span data-stu-id="f0908-139">**SECBUFFER\_DATA**</span></span>            | <span data-ttu-id="f0908-140">Содержит обычное текстовое сообщение для шифрования.</span><span class="sxs-lookup"><span data-stu-id="f0908-140">Contains the plain-text message to be encrypted.</span></span>                                                                                                                                                                  |
| <span data-ttu-id="f0908-141">**\_трейлер потока \_ pvbuffer**</span><span class="sxs-lookup"><span data-stu-id="f0908-141">**SECBUFFER\_STREAM\_TRAILER**</span></span> | <span data-ttu-id="f0908-142">Содержит данные трейлеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="f0908-142">Contains the security trailer data.</span></span> <span data-ttu-id="f0908-143">Размер буфера заголовков получается путем вызова [**QueryContextAttributes**](graphing-reference-links.md) и указания атрибута **\_ \_ \_ Размер потока SECPKG attr** .</span><span class="sxs-lookup"><span data-stu-id="f0908-143">The size of the header buffer is obtained by calling [**QueryContextAttributes**](graphing-reference-links.md) and specifying the **SECPKG\_ATTR\_STREAM\_SIZES** attribute.</span></span> |
| <span data-ttu-id="f0908-144">**PVBUFFER \_ пусто**</span><span class="sxs-lookup"><span data-stu-id="f0908-144">**SECBUFFER\_EMPTY**</span></span>           | <span data-ttu-id="f0908-145">Не инициализировано.</span><span class="sxs-lookup"><span data-stu-id="f0908-145">Not initialized.</span></span> <span data-ttu-id="f0908-146">Размер этого буфера равен нулю (0).</span><span class="sxs-lookup"><span data-stu-id="f0908-146">The size of this buffer is zero (0).</span></span>                                                                                                                                                             |



 

<span data-ttu-id="f0908-147">При вызове [**декриптмессаже**](graphing-reference-links.md)API-интерфейс одноранговых диаграмм передает ровно четыре структуры **pvbuffer** .</span><span class="sxs-lookup"><span data-stu-id="f0908-147">When calling [**DecryptMessage**](graphing-reference-links.md), the Peer Graphing API passes exactly four **SecBuffer** structures.</span></span> <span data-ttu-id="f0908-148">Первый буфер **pvbuffer \_ данные** и содержит зашифрованное сообщение.</span><span class="sxs-lookup"><span data-stu-id="f0908-148">The first buffer is **SECBUFFER\_DATA**, and contains an encrypted message.</span></span> <span data-ttu-id="f0908-149">Оставшиеся буферы используются для вывода и имеют тип **pvbuffer \_ Empty**.</span><span class="sxs-lookup"><span data-stu-id="f0908-149">The remaining buffers are used for output, and are of type **SECBUFFER\_EMPTY**.</span></span>

<span data-ttu-id="f0908-150">Поставщику общих служб требуется поддержка шифрования и расшифровки пользовательских буферов данных размером 16 КБ и выше в одном вызове.</span><span class="sxs-lookup"><span data-stu-id="f0908-150">The SSP needs to support encrypting and decrypting user data buffers with sizes of 16K and greater in one call.</span></span>

 

 



