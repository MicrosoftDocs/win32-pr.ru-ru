---
description: Таблица распределенной маршрутизации (DRT) существует в виде сетки сооперационных узлов, где каждый узел является экземпляром приложения с помощью API-интерфейса DRT.
ms.assetid: 257ad7ea-636b-45f2-b514-4a213939d107
title: Сведения о таблицах распределенной маршрутизации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2dfca9f81cc609d97584ef5a11f999722c696858
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909800"
---
# <a name="about-distributed-routing-tables"></a><span data-ttu-id="86d11-103">Сведения о таблицах распределенной маршрутизации</span><span class="sxs-lookup"><span data-stu-id="86d11-103">About Distributed Routing Tables</span></span>

<span data-ttu-id="86d11-104">Таблица распределенной маршрутизации (DRT) существует в виде сетки сооперационных узлов, где каждый узел является экземпляром приложения с помощью API-интерфейса DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-104">A Distributed Routing Table (DRT) exists as a mesh of cooperating nodes, where each node is an instance of an application using the DRT API.</span></span> <span data-ttu-id="86d11-105">Узлы, публикующие ключи, несут ответственность за помощь другим узлам в публикации и разрешении ключей.</span><span class="sxs-lookup"><span data-stu-id="86d11-105">Nodes that publish keys are responsible for assisting other nodes publish and resolve keys.</span></span> <span data-ttu-id="86d11-106">Узлы также могут участвовать в «разрешении», что не требует от них помощь одноранговым узлам.</span><span class="sxs-lookup"><span data-stu-id="86d11-106">Nodes can also participate in a "resolve only" fashion, which does not require them to assist peers.</span></span> <span data-ttu-id="86d11-107">Протокол DRT выполняется через транспорт UDP/IPv6.</span><span class="sxs-lookup"><span data-stu-id="86d11-107">The DRT protocol executes over a UDP/IPv6 transport.</span></span>

<span data-ttu-id="86d11-108">Узел, который публикует ключ, создает и поддерживает локальную таблицу маршрутизации других узлов в сети.</span><span class="sxs-lookup"><span data-stu-id="86d11-108">A node that publishes a key builds and maintains a local routing table of other nodes in the mesh.</span></span> <span data-ttu-id="86d11-109">Эта таблица маршрутизации оптимизирована таким образом, что узел может быстро найти конкретный ключ в сети, находя ключ непосредственно в локальной таблице маршрутизации, или запросив другие узлы, которые публикуют ключи, расположенные ближе к целевому.</span><span class="sxs-lookup"><span data-stu-id="86d11-109">This routing table is optimized so that the node can quickly locate a specific key in the mesh by finding the key directly in the local routing table, or by asking other nodes publishing keys numerically close to the target.</span></span> <span data-ttu-id="86d11-110">Это действие повторяется до тех пор, пока требуемый ключ не будет найден или узел не определит, что такого ключа не существует.</span><span class="sxs-lookup"><span data-stu-id="86d11-110">This action is repeated until the required key is found or the node determines that no such key exists.</span></span>

<span data-ttu-id="86d11-111">Ключи DRT — это 256-разрядные целые числа без знака.</span><span class="sxs-lookup"><span data-stu-id="86d11-111">DRT keys are 256-bit unsigned integers.</span></span> <span data-ttu-id="86d11-112">Замыкание между ключами определяется числовым различием между ними.</span><span class="sxs-lookup"><span data-stu-id="86d11-112">Closeness between keys is defined by the numerical difference between them.</span></span> <span data-ttu-id="86d11-113">Пространства ключей DRT считается циклическим.</span><span class="sxs-lookup"><span data-stu-id="86d11-113">The DRT keyspace is considered circular.</span></span> <span data-ttu-id="86d11-114">Например, первое возможное значение ключа и Последнее возможное значение ключа считаются соседями.</span><span class="sxs-lookup"><span data-stu-id="86d11-114">For example, the first possible key value, and the last possible key value are considered neighbors.</span></span>

<span data-ttu-id="86d11-115">В Secure DRT узлы необходимы для проверки подлинности публикуемых ключей.</span><span class="sxs-lookup"><span data-stu-id="86d11-115">In a secure DRT, nodes are required to authenticate the keys they publish.</span></span> <span data-ttu-id="86d11-116">Механизм, с помощью которого узлы проходят проверку подлинности ключей с помощью API-интерфейса DRT при инициализации DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-116">The mechanism by which nodes authenticate keys must be set using the DRT API when the DRT is initialized.</span></span> <span data-ttu-id="86d11-117">Это можно сделать, выбрав поставщик безопасности для DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-117">This is done by choosing a security provider for the DRT.</span></span> <span data-ttu-id="86d11-118">Поставщик безопасности — это модуль, который может создавать маркеры, используемые для проверки подлинности ключей, и проверять маркеры, созданные другими узлами.</span><span class="sxs-lookup"><span data-stu-id="86d11-118">A security provider is a module that can produce tokens used to authenticate keys, and verify tokens produced by other nodes.</span></span> <span data-ttu-id="86d11-119">Он должен реализовывать интерфейс поставщика безопасности, который определен в этой документации.</span><span class="sxs-lookup"><span data-stu-id="86d11-119">It must implement the security provider interface that is defined in this documentation.</span></span> <span data-ttu-id="86d11-120">В составе DRT Windows 7 поставляется два полностью реализованных поставщика безопасности, которые можно использовать для создания приложений Windows.</span><span class="sxs-lookup"><span data-stu-id="86d11-120">The Windows 7 DRT ships with two fully implemented security providers that can be used to build Windows applications.</span></span>

<span data-ttu-id="86d11-121">Во время инициализации приложение должно также предоставить экземпляр DRT с поставщиком начальной загрузки.</span><span class="sxs-lookup"><span data-stu-id="86d11-121">During initialization, an application must also supply the DRT with a bootstrap provider.</span></span> <span data-ttu-id="86d11-122">Поставщик начальной загрузки — это модуль, который может получать сетевые конечные точки узлов, уже имеющихся в сетке DRT, и вызывается службой DRT при установке нового узла.</span><span class="sxs-lookup"><span data-stu-id="86d11-122">The bootstrap provider is a module that can retrieve the network endpoints of nodes already present in the DRT mesh, and is called upon by the DRT when a new node is established.</span></span> <span data-ttu-id="86d11-123">Как и модуль поставщика безопасности, поставщик начальной загрузки должен реализовать хорошо определенный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="86d11-123">Like the security provider module, the bootstrap provider must implement a well defined interface.</span></span> <span data-ttu-id="86d11-124">В составе DRT Windows 7 входит два полностью реализованных поставщика начальной загрузки.</span><span class="sxs-lookup"><span data-stu-id="86d11-124">The Windows 7 DRT ships with two fully implemented bootstrap providers.</span></span>

<span data-ttu-id="86d11-125">DRT считает непосредственные соседние ключи специальными.</span><span class="sxs-lookup"><span data-stu-id="86d11-125">The DRT considers the immediate neighbors of a key special.</span></span> <span data-ttu-id="86d11-126">Пять ближайших к числу ключей меньше, а пять ближайших ключей больше, чем опубликованный ключ, что называется конечным набором.</span><span class="sxs-lookup"><span data-stu-id="86d11-126">The five closest keys numerically smaller and the five closest keys numerically larger than a published key form what is called a leaf set.</span></span> <span data-ttu-id="86d11-127">Объект DRT сообщает об изменениях в конечном наборе ключа через API-интерфейс DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-127">The DRT reports changes to the leaf set of a key through the DRT API.</span></span>

## <a name="drt-life-cycle-and-state-transitions"></a><span data-ttu-id="86d11-128">Жизненный цикл DRT и переходы состояний</span><span class="sxs-lookup"><span data-stu-id="86d11-128">DRT Life Cycle and State Transitions</span></span>

<span data-ttu-id="86d11-129">Приложение может инициализировать локальный экземпляр DRT с помощью функции [**дртопен**](/windows/desktop/api/drt/nf-drt-drtopen) .</span><span class="sxs-lookup"><span data-stu-id="86d11-129">An application can initialize a local DRT instance using the [**DrtOpen**](/windows/desktop/api/drt/nf-drt-drtopen) function.</span></span> <span data-ttu-id="86d11-130">Эта функция запускает процесс начальной загрузки, в котором API DRT вызывает поставщик начальной загрузки для изучения ключей и сетевых конечных точек других узлов, уже участвующих в DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-130">This function triggers the bootstrapping process, where the DRT API calls upon the bootstrap provider to learn the keys and network endpoints of other nodes already participating in the DRT.</span></span> <span data-ttu-id="86d11-131">Если поставщик начальной загрузки успешно находит по крайней мере один другой узел, то DRT переходит в \_ активное состояние DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-131">If the bootstrap provider successfully locates at least one other node, the DRT enters the DRT\_ACTIVE state.</span></span> <span data-ttu-id="86d11-132">В этом состоянии приложение может искать ключи, опубликованные другими узлами, а также публиковать ключи, которые можно разрешить.</span><span class="sxs-lookup"><span data-stu-id="86d11-132">In this state, the application can search for keys published by other nodes, and can publish keys that can be resolved.</span></span> <span data-ttu-id="86d11-133">Если поставщику начальной загрузки не удается успешно выполнить обнаружение других узлов, то DRT переходит в \_ автономное состояние DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-133">If the bootstrap provider cannot successfully locate other nodes, the DRT enters the DRT\_ALONE state.</span></span> <span data-ttu-id="86d11-134">DRT останется в \_ отдельном состоянии DRT и будет периодически пытаться выполнить загрузку, чтобы нахождение узлов и переходить в \_ состояние DRT Active.</span><span class="sxs-lookup"><span data-stu-id="86d11-134">The DRT will stay in the DRT\_ALONE state and will attempt to bootstrap periodically in order to locate peers and move to the DRT\_ACTIVE state.</span></span>

<span data-ttu-id="86d11-135">Узел может переходить к этим состояниям из DRT \_ Active.</span><span class="sxs-lookup"><span data-stu-id="86d11-135">A node can transition to these states from DRT\_ACTIVE.</span></span>

| <span data-ttu-id="86d11-136">Состояние жизненного цикла</span><span class="sxs-lookup"><span data-stu-id="86d11-136">Life Cycle State</span></span> | <span data-ttu-id="86d11-137">Условия</span><span class="sxs-lookup"><span data-stu-id="86d11-137">Conditions</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="86d11-138">\_только DRT</span><span class="sxs-lookup"><span data-stu-id="86d11-138">DRT\_ALONE</span></span>       | <span data-ttu-id="86d11-139">Локальный узел не обнаружил других узлов в DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-139">The local node has not discovered other nodes in the DRT.</span></span> <span data-ttu-id="86d11-140">В этом состоянии узел продолжит прослушивать другие узлы в DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-140">While in this state, the node continues to listen for other nodes within the DRT.</span></span><br/> <span data-ttu-id="86d11-141">Если другой узел присоединяется к DRT, локальный узел переходит в \_ состояние DRT Active.</span><span class="sxs-lookup"><span data-stu-id="86d11-141">If another node joins the DRT, the local node will transition to the DRT\_ACTIVE state.</span></span> <span data-ttu-id="86d11-142">Если сеть не работает, она будет переведена в DRT \_ без \_ сети.</span><span class="sxs-lookup"><span data-stu-id="86d11-142">If the network is down, it will transition to DRT\_NO\_NETWORK.</span></span> <span data-ttu-id="86d11-143">В случае серьезной ошибки в DRT узел переходит в \_ состояние сбоя DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-143">In the event of a serious error with the DRT the node will transition to the DRT\_FAULTED state.</span></span><br/> |
| <span data-ttu-id="86d11-144">DRT \_ нет \_ сети</span><span class="sxs-lookup"><span data-stu-id="86d11-144">DRT\_NO\_NETWORK</span></span> | <span data-ttu-id="86d11-145">Когда узел теряет подключение к сети, он переходит в состояние DRT \_ No \_ Network.</span><span class="sxs-lookup"><span data-stu-id="86d11-145">When a node loses network connectivity, it transitions to the DRT\_NO\_NETWORK state.</span></span> <span data-ttu-id="86d11-146">На этом этапе приложение может ожидать восстановления сетевого подключения и может закрыть DRT.</span><span class="sxs-lookup"><span data-stu-id="86d11-146">At this point the application can wait for network connectivity to be restored, and can close the DRT.</span></span><br/>                                                                                                                                                                                                                    |
| <span data-ttu-id="86d11-147">\_сбой DRT</span><span class="sxs-lookup"><span data-stu-id="86d11-147">DRT\_FAULTED</span></span>     | <span data-ttu-id="86d11-148">В локальном узле произошла серьезная ошибка.</span><span class="sxs-lookup"><span data-stu-id="86d11-148">A serious error has occurred within the local node.</span></span> <span data-ttu-id="86d11-149">Например, если на локальном компьютере заканчивается физическая память.</span><span class="sxs-lookup"><span data-stu-id="86d11-149">For example, if the local machine runs out of physical memory.</span></span><br/> <span data-ttu-id="86d11-150">Когда узел переходит в это состояние, приложение должно вызвать API [**дртклосе**](/windows/desktop/api/drt/nf-drt-drtclose) , устранить проблему и повторно инициализировать DRT с [**дртопен**](/windows/desktop/api/drt/nf-drt-drtopen).</span><span class="sxs-lookup"><span data-stu-id="86d11-150">While a node enters this state, the application must call the [**DrtClose**](/windows/desktop/api/drt/nf-drt-drtclose) API, correct the problem, and re-initialize the DRT with [**DrtOpen**](/windows/desktop/api/drt/nf-drt-drtopen).</span></span><br/>                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="86d11-151">См. также</span><span class="sxs-lookup"><span data-stu-id="86d11-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="86d11-152">Использование API таблиц распределенной маршрутизации</span><span class="sxs-lookup"><span data-stu-id="86d11-152">Using the Distributed Routing Table API</span></span>](using-the-distributed-routing-table-api.md)
</dt> <dt>

[<span data-ttu-id="86d11-153">Справочник по распределенной маршрутизации API таблиц</span><span class="sxs-lookup"><span data-stu-id="86d11-153">Distributed Routing Table API Reference</span></span>](distributed-routing-table-api-reference.md)
</dt> </dl>

 

 




