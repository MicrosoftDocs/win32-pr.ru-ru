---
description: В этом разделе обсуждается процесс приглашения однорангового узла к присоединению к одноранговой группе с помощью интерфейсов API группирования одноранговых узлов.
ms.assetid: 6afcbfec-b1df-45cd-8a43-221dfe5d8c33
title: Приглашение однорангового узла в группу
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68b1e8852f58387d424944d4a8821f56b5e11e8d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103998544"
---
# <a name="inviting-a-peer-to-a-group"></a>Приглашение однорангового узла в группу

В этом разделе обсуждается процесс приглашения однорангового узла к присоединению к одноранговой группе с помощью интерфейсов API группирования одноранговых узлов.

Для участия в одноранговой группе требуются действительные учетные данные. Учетные данные выдаются вне группы в виде приглашений или непосредственно членам группы при необходимости обновления учетных данных.

## <a name="group-member-certificates"></a>Сертификаты членов групп

Одноранговая группа создается, когда приложение вызывает [**пирграупкреате**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate).

Для участия в одноранговой группе каждый узел должен иметь одноранговый идентификатор. Вызовите [**пиренумидентитиес**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities) , пока не будут возвращены все идентификаторы узлов, определенные для однорангового узла, и выберите тот, который следует использовать. Если одноранговый идентификатор не существует, создайте его, вызвав [**пиридентитикреате**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).

Каждое удостоверение однорангового узла связано с конкретным набором учетных данных, которые можно использовать для подтверждения членства в одноранговой группе при подключении, а также при публикации записей или приглашении дополнительных участников. Эти учетные данные представляются в виде цепочек [сертификатов X. 509](https://www.ietf.org/rfc/rfc2511.txt) , называемых сертификатами членства в группах (ГМК).

Чтобы создать ГМК для однорангового удостоверения, необходимо сначала получить его открытый ключ. Этот ключ получается путем вызова [**пиридентитижетксмл**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml) на потенциальном приглашении и передачи его удостоверения однорангового узла. Эта функция возвращает сертификат в кодировке Base-64, содержащий открытый ключ RSA, используемый для создания ГМК для удостоверения однорангового узла (помимо прочего), инкапсулированного в большой двоичный объект XML, в следующем формате:

``` syntax
<PEERIDENTITYINFO VERSION="1.0">
     <IDC xmlns:dt="urn:schemas-microsoft-com:datatypes" dt:dt="bin.base64">
          <!-- Base-64 encoded certificate  -->
     </IDC>
</PEERIDENTITYINFO>
```

Эту строку можно передать в [**пирграупкреатеинвитатион**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation), которая возвращает приглашение, содержащее ГМК для этого удостоверения однорангового узла. Приглашение должно быть передано приглашению с помощью другого процесса, например электронной почты, FTP или защищенного файлового ресурса.

В качестве альтернативы можно разместить IDC в новой структуре [**\_ \_ сведений об учетных данных одноранговых узлов**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) и передать ее в [**пирграуписсуекредентиалс**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials), что также создает приглашение.

Обратите внимание, что приложениям запрещено добавлять теги внутри тега **пиридентитинфо** или изменять этот фрагмент XML каким-либо образом. Приложениям разрешено включать этот фрагмент XML в другие XML-документы, но перед передачей этого фрагмента в функции [**пирграупкреатеинвитатион**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) или [**пирграуписсуекредентиалс**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials) необходимо извлечь все зависящие от приложения XML.

Члены Гмкс выдаются администраторами и создателем одноранговой группы. Участники должны получить новые Гмкс с расширенным временем существования их Гмкс до момента истечения срока действия. Администратор одноранговой группы выдает обновленные учетные данные, вызывая [**пирграуписсуекредентиалс**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials) с существующими учетными данными для этого узла.

Структура [**\_ \_ сведений об учетных данных одноранговых узлов**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) содержит основные данные о состоянии членства однорангового узла, включая открытый ключ для их ГМК. Новые учетные данные можно опубликовать в одноранговой группе, установив \_ \_ флаг учетных данных для хранилища одноранговых групп \_ в вызове [**пирграуписсуекредентиалс**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials). Когда получатель новых учетных данных присоединяется к одноранговой группе, существующие учетные данные будут обновлены инфраструктурой однорангового группирования.

## <a name="issuing-an-invitation"></a>Выдача приглашения

Участник приглашен на присоединение к одноранговой группе одним из следующих двух способов:

-   Администратор одноранговой группы вызывает [**пирграупкреатеинвитатион**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation), передавая строку XML со сведениями об удостоверениях, полученную из потенциальных приглашений, с помощью общего механизма, такого как электронная почта или сеанс обмена мгновенными сообщениями. Приглашение также передается через некоторый внешний процесс или механизм одноранговому узлу, который в конечном итоге получает его в виде XML-строки или текстового файла.
-   Администратор одноранговой группы вызывает [**пирграуписсуекредентиалс**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials). Чтобы использовать эту функцию, узел должен уже публиковать сведения о членстве в одноранговой группе ([**одноранговый \_ член**](/windows/desktop/api/P2P/ns-p2p-peer_member)) или иметь доступный открытый ключ (пары ключей RSA, используемый для создания удостоверения субъекта). В первом случае структура одноранговых [**\_ \_ сведений об учетных данных**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) , необходимая для **пирграуписсуекредентиалс** , может быть получена из структуры **одноранговых \_ членов** . в последнем случае новая структура **\_ учетных данных \_ однорангового узла** может быть заполнена открытым ключом.

После получения строки приглашения одноранговая группа передает ее в [**пирграупжоин**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) для присоединения к одноранговой группе. Если вызов **пирграупжоин** успешно выполнен, узел может позже открыть одноранговую группу, вызвав [**пирграупопен**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).

## <a name="parsing-an-invitation"></a>Анализ приглашения

При необходимости можно проанализировать приглашение, вызвав [**пирграуппарсеинвитатион**](/windows/desktop/api/P2P/nf-p2p-peergroupparseinvitation), который возвращает структуру [**\_ \_ сведений о приглашении однорангового узла**](/windows/desktop/api/P2P/ns-p2p-peer_invitation_info) . Поля в структуре можно легко получить в целях показа.

 

 



