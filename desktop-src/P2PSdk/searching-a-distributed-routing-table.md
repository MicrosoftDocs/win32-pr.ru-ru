---
description: Прежде чем приложение сможет выполнять поиск в таблице распределенной маршрутизации (DRT), необходимо создать запрос поиска.
ms.assetid: b3403a64-128c-461e-9384-8e62c03322e1
title: Поиск в таблице распределенной маршрутизации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9977ca395393cef09198182fb8790738d2b00c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105663964"
---
# <a name="searching-a-distributed-routing-table"></a><span data-ttu-id="f845c-103">Поиск в таблице распределенной маршрутизации</span><span class="sxs-lookup"><span data-stu-id="f845c-103">Searching a Distributed Routing Table</span></span>

<span data-ttu-id="f845c-104">Прежде чем приложение сможет выполнять поиск в таблице распределенной маршрутизации (DRT), необходимо создать запрос поиска.</span><span class="sxs-lookup"><span data-stu-id="f845c-104">Before an application can search the Distributed Routing Table (DRT), a search query must be created.</span></span> <span data-ttu-id="f845c-105">Требуемое значение ключа задается приложением при вызове функции [**дртстартсеарч**](/windows/desktop/api/drt/nf-drt-drtstartsearch) .</span><span class="sxs-lookup"><span data-stu-id="f845c-105">The desired key value is specified by the application when the [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) function is called.</span></span> <span data-ttu-id="f845c-106">Поведение поиска определяется сведениями, заданными приложением в структуре [**\_ \_ сведений о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info) .</span><span class="sxs-lookup"><span data-stu-id="f845c-106">The behavior of the search is determined by information specified by the application in the [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info) structure.</span></span>

<span data-ttu-id="f845c-107">Как правило, событие приложения сигнализирует, когда поиск обнаруживает результаты, а другой — в конце поиска.</span><span class="sxs-lookup"><span data-stu-id="f845c-107">Typically, an application event is signaled when the search discovers results and another at the conclusion of the search.</span></span> <span data-ttu-id="f845c-108">Однако если **фитеративе** заданы в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info), то событие приложения может быть сигнальным при установлении связи с каждым узлом.</span><span class="sxs-lookup"><span data-stu-id="f845c-108">However, if **fIterative** is set in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info), an application event can be signaled when contact is made with each node along the way.</span></span>

<span data-ttu-id="f845c-109">После получения сигнала о событии приложение вызывает функцию [**дртжетсеарчресулт**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) для получения результатов.</span><span class="sxs-lookup"><span data-stu-id="f845c-109">After an event is signaled, the application then calls the [**DrtGetSearchResult**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) function for the results.</span></span> <span data-ttu-id="f845c-110">Если возвращенный код имеет значение S, результаты указываются в структуре [**\_ \_ результатов поиска DRT**](/windows/desktop/api/drt/ns-drt-drt_search_result) , возвращенной API. **\_**</span><span class="sxs-lookup"><span data-stu-id="f845c-110">If the returned code is **S\_OK**, the results are pointed to in the [**DRT\_SEARCH\_RESULT**](/windows/desktop/api/drt/ns-drt-drt_search_result) structure returned by the API.</span></span> <span data-ttu-id="f845c-111">Возвращаемые результаты попадают в диапазон значений, указанных в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="f845c-111">The returned results fall into the range of values specified in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span> <span data-ttu-id="f845c-112">Если поиск не находит совпадений, то при завершении возвращаемых результатов будет возвращено только значение **DRT \_ E \_ \_** .</span><span class="sxs-lookup"><span data-stu-id="f845c-112">In the event that the search finds no matches, only the **DRT\_E\_NO\_MORE** value will be returned at the conclusion of result returns.</span></span>

<span data-ttu-id="f845c-113">Ниже приведены сведения о том, как члены, содержащиеся в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info) , позволяют приложению специально определять поведение поиска инфраструктуры DRT:</span><span class="sxs-lookup"><span data-stu-id="f845c-113">The following information details how the members contained in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info) allow an application to specifically dictate the search behavior of the DRT infrastructure:</span></span>

## <a name="fallowcurrentinstancematch"></a><span data-ttu-id="f845c-114">фалловкуррентинстанцематч</span><span class="sxs-lookup"><span data-stu-id="f845c-114">fAllowCurrentInstanceMatch</span></span>

<span data-ttu-id="f845c-115">По умолчанию результаты поиска DRT содержат только совпадения, найденные за пределами локального узла.</span><span class="sxs-lookup"><span data-stu-id="f845c-115">By default, DRT search results include only matches found outside of the local node.</span></span> <span data-ttu-id="f845c-116">Параметр **фалловкуррентинстанцематч** указывает, что результаты поиска также содержат совпадения, обнаруженные в локальном экземпляре DRT.</span><span class="sxs-lookup"><span data-stu-id="f845c-116">Setting **fAllowCurrentInstanceMatch** specifies that the search results also include matches found in the local DRT instance.</span></span>

## <a name="cmaxendpoints"></a><span data-ttu-id="f845c-117">кмаксендпоинтс</span><span class="sxs-lookup"><span data-stu-id="f845c-117">cMaxEndpoints</span></span>

<span data-ttu-id="f845c-118">Количество и диапазон результатов, возвращаемых поиском, задаются приложением с использованием значений **кмаксендпоинтс** (Quantity) и **пминимумкэй** и **пмаксимумкэй** (Range), а также ссылками на [**\_ \_ сведения о поиске в DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="f845c-118">The quantity and range of the results returned by the search are specified by the application with the **cMaxEndpoints** (quantity) and the **pMinimumKey** and **pMaximumKey** (range) values, and referenced by [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span>

<span data-ttu-id="f845c-119">Если **кмаксендпоинтс = 1**, инфраструктура DRT ищет ключ, возвращая одно совпадение в диапазоне, указанном значениями **пминимумкэй** и **пмаксимумкэй** в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="f845c-119">When **cMaxEndpoints = 1**, the DRT infrastructure searches for a key, returning one match within the range specified by the **pMinimumKey** and **pMaximumKey** values in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span> <span data-ttu-id="f845c-120">Это может быть точное совпадение или ближайшее соответствие в пределах диапазона.</span><span class="sxs-lookup"><span data-stu-id="f845c-120">This match can be either an exact match or the nearest match within range.</span></span> <span data-ttu-id="f845c-121">Если совпадение не найдено, то не возвращается **DRT \_ E \_ \_** .</span><span class="sxs-lookup"><span data-stu-id="f845c-121">If a match is not found, **DRT\_E\_NO\_MORE** is returned.</span></span>

<span data-ttu-id="f845c-122">Если **кмаксендпоинтс > 1**, инфраструктура DRT вернет совпадения в диапазоне вплоть до значения **кмаксендпоинтс**.</span><span class="sxs-lookup"><span data-stu-id="f845c-122">If **cMaxEndpoints > 1**, the DRT infrastructure will return matches within the range up to the value of **cMaxEndpoints**.</span></span> <span data-ttu-id="f845c-123">Возвращаемые совпадения могут содержать точное совпадение или ближайшие результаты соответствия в пределах диапазона.</span><span class="sxs-lookup"><span data-stu-id="f845c-123">The returned matches can contain an exact match or the nearest match results within range.</span></span> <span data-ttu-id="f845c-124">Кроме того, если для **пминимумкэй** и **пмаксимумкэй** задано одно и то же значение, поиск выполняется только для этого значения и возвращает **DRT \_ е \_ \_** , если он не найден.</span><span class="sxs-lookup"><span data-stu-id="f845c-124">Additionally, if **pMinimumKey** and **pMaximumKey** are set to the same value, a search is carried out only for that value, returning **DRT\_E\_NO\_MORE** if it is not found.</span></span>

## <a name="fanymatchinrange"></a><span data-ttu-id="f845c-125">фаниматчинранже</span><span class="sxs-lookup"><span data-stu-id="f845c-125">fAnyMatchInRange</span></span>

<span data-ttu-id="f845c-126">Элемент **фаниматчинранже** указывает, будет ли поиск останавливаться после того, как первое совпадение находится в пределах указанного диапазона, или если поиск будет продолжаться в соответствии с ключом, указанным в API [**дртстартсеарч**](/windows/desktop/api/drt/nf-drt-drtstartsearch) .</span><span class="sxs-lookup"><span data-stu-id="f845c-126">The **fAnyMatchInRange** member indicates whether the search will stop after the first match is located within the specified range, or if the search will continue for the closest match to the key specified in the [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) API.</span></span> <span data-ttu-id="f845c-127">Если задан параметр **фаниматчинранже** , поиск выполняется с **кмаксендпоинтс = 1** независимо от указанного значения **Кмаксендпоинтс** в [**\_ \_ сведениях поиска DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="f845c-127">When **fAnyMatchInRange** is set, the search is carried out with **cMaxEndpoints = 1** regardless of the specified value of **cMaxEndpoints** in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span>

## <a name="fiterative"></a><span data-ttu-id="f845c-128">фитеративе</span><span class="sxs-lookup"><span data-stu-id="f845c-128">fIterative</span></span>

<span data-ttu-id="f845c-129">Член **фитеративе** указывает, будет ли каждый узел, к которому осуществляется обращение в инфраструктуре DRT во время поиска, иметь связанные с ним данные ключа или конечной точки, которые были доступны приложению через [**\_ \_ Результаты поиска DRT**](/windows/desktop/api/drt/ns-drt-drt_search_result).</span><span class="sxs-lookup"><span data-stu-id="f845c-129">The **fIterative** member specifies if each node contacted by the DRT infrastructure during the search will have the key/endpoint data associated with it made available to the application via [**DRT\_SEARCH\_RESULT**](/windows/desktop/api/drt/ns-drt-drt_search_result).</span></span> <span data-ttu-id="f845c-130">Если присвоить параметру **фитеративе** значение **true**, то для параметра **кмаксендпоинтс = 1** будет принудительно установлен.</span><span class="sxs-lookup"><span data-stu-id="f845c-130">By setting **fIterative** to **TRUE**, the value of **cMaxEndpoints = 1** will be forced.</span></span> <span data-ttu-id="f845c-131">Если **фитеративе** имеет значение **true** в поисковом запросе для DRT, то приложение вызывается обратно после связи с каждым узлом или "прыжком".</span><span class="sxs-lookup"><span data-stu-id="f845c-131">When **fIterative** is set to **TRUE** within a search query for the DRT, the application is called back after contact with each node or "hop."</span></span> <span data-ttu-id="f845c-132">Каждый результат прыжка содержит ключ, указывающий на узел, который будет искать в DRT.</span><span class="sxs-lookup"><span data-stu-id="f845c-132">Each hop result contains a key indicating which node the DRT will search next.</span></span> <span data-ttu-id="f845c-133">Результат прыжка возвращается через [**дртжетсеарчресулт**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) в качестве **\_ \_ промежуточного результата сопоставления DRT** .</span><span class="sxs-lookup"><span data-stu-id="f845c-133">A hop result is returned via [**DrtGetSearchResult**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) as a **DRT\_MATCH\_INTERMEDIATE** result.</span></span>

## <a name="pminimumkey-and-pmaximumkey"></a><span data-ttu-id="f845c-134">Пминимумкэй и Пмаксимумкэй</span><span class="sxs-lookup"><span data-stu-id="f845c-134">pMinimumKey and pMaximumKey</span></span>

<span data-ttu-id="f845c-135">Члены **пминимумкэй** и **пмаксимумкэй** можно использовать для поиска ключей, попадающих в диапазон.</span><span class="sxs-lookup"><span data-stu-id="f845c-135">The **pMinimumKey** and **pMaximumKey** members can be used to search for keys falling within a range.</span></span> <span data-ttu-id="f845c-136">Если для элемента **фаниматчинранже** задано **значение false**, то DRT вернет ближайший ключ к целевому объекту поиска (указанный с помощью аргумента pKey, переданного в функцию [**дртстартсеарч**](/windows/desktop/api/drt/nf-drt-drtstartsearch) ), в пределах диапазона.</span><span class="sxs-lookup"><span data-stu-id="f845c-136">If the **fAnyMatchInRange** member is set to **FALSE**, the DRT will return the closest key(s) to the search target (specified using the pKey argument passed in the [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) function) falling within the range.</span></span> <span data-ttu-id="f845c-137">Обратите внимание, что аргумент *pKey* , переданный в **дртстартсеарч** , должен попадать в диапазон, определенный **пминимумкэй** и **пмаксимумкэй**.</span><span class="sxs-lookup"><span data-stu-id="f845c-137">Note that the *pKey* argument passed to **DrtStartSearch** must fall within the range defined by **pMinimumKey** and **pMaximumKey**.</span></span> <span data-ttu-id="f845c-138">Чтобы найти точный ключ, задайте для **пминимумкэй**, **пмаксимумкэй** и *pKey* одно и то же значение.</span><span class="sxs-lookup"><span data-stu-id="f845c-138">To search for a precise key, set **pMinimumKey**, **pMaximumKey** and *pKey* to the same value.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f845c-139">См. также</span><span class="sxs-lookup"><span data-stu-id="f845c-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f845c-140">Регистрация и Отмена регистрации ключей</span><span class="sxs-lookup"><span data-stu-id="f845c-140">Registering and Deregistering Keys</span></span>](registering-and-deregistering-keys.md)
</dt> <dt>

[<span data-ttu-id="f845c-141">Сведения о таблицах распределенной маршрутизации</span><span class="sxs-lookup"><span data-stu-id="f845c-141">About Distributed Routing Tables</span></span>](about-distributed-routing-tables.md)
</dt> <dt>

[<span data-ttu-id="f845c-142">Справочник по распределенной маршрутизации API таблиц</span><span class="sxs-lookup"><span data-stu-id="f845c-142">Distributed Routing Table API Reference</span></span>](distributed-routing-table-api-reference.md)
</dt> </dl>

 

 



