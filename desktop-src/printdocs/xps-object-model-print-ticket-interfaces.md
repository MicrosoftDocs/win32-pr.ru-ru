---
description: Этот интерфейс Икспсомпринттиккетресаурце API документов XPS предоставляет доступ к существующему билету на печать, а также возможность создания билета на печать в OM-модели XPS.
ms.assetid: 53c95da0-1601-4945-83a1-e3266d251aee
title: Интерфейсы билета на печать Operations Manager XPS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 646089455e7106b1be3716c0ccf0774be361f130
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "105713337"
---
# <a name="xps-om-print-ticket-interfaces"></a><span data-ttu-id="d01b8-103">Интерфейсы билета на печать Operations Manager XPS</span><span class="sxs-lookup"><span data-stu-id="d01b8-103">XPS OM Print Ticket Interfaces</span></span>

<span data-ttu-id="d01b8-104">Этот интерфейс [**ИКСПСОМПРИНТТИККЕТРЕСАУРЦЕ**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) API документов XPS предоставляет доступ к существующему билету на печать, а также возможность создания билета на печать в OM-модели XPS.</span><span class="sxs-lookup"><span data-stu-id="d01b8-104">This [**IXpsOMPrintTicketResource**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) interface of the XPS Document API provides access to an existing print ticket and also the ability to create a print ticket in an XPS OM.</span></span>

## <a name="print-ticket-resources"></a><span data-ttu-id="d01b8-105">Печать ресурсов билетов</span><span class="sxs-lookup"><span data-stu-id="d01b8-105">Print Ticket Resources</span></span>

<span data-ttu-id="d01b8-106">Интерфейс [**икспсомпринттиккетресаурце**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) позволяет программе считывать содержимое существующего билета на печать путем вызова метода **жетпринттиккетресаурце** интерфейса, поддерживающего билет печати.</span><span class="sxs-lookup"><span data-stu-id="d01b8-106">The [**IXpsOMPrintTicketResource**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) interface enables a program to read the contents of an existing print ticket by calling the **GetPrintTicketResource** method of an interface that supports a print ticket.</span></span> <span data-ttu-id="d01b8-107">Новые ресурсы билетов на печать можно добавить в часть документа путем вызова **сетпринттиккетресаурце**.</span><span class="sxs-lookup"><span data-stu-id="d01b8-107">New print ticket resources can be added to a document part by calling **SetPrintTicketResource**.</span></span>

<span data-ttu-id="d01b8-108">Существует три уровня билетов на печать, которые определяют область действия билета на печать.</span><span class="sxs-lookup"><span data-stu-id="d01b8-108">There are three print ticket levels, which specify the scope of the print ticket.</span></span> <span data-ttu-id="d01b8-109">Уровни билетов на печать: уровень задания (пакета), уровень документа и уровень страницы.</span><span class="sxs-lookup"><span data-stu-id="d01b8-109">The print ticket levels are: the job (or package) level, the document level, and the page level.</span></span> <span data-ttu-id="d01b8-110">В следующей таблице показана связь между уровнем билета на печать, соответствующим интерфейсом модели XPS и методами, используемыми для доступа к ресурсу билета на печать.</span><span class="sxs-lookup"><span data-stu-id="d01b8-110">The following table shows the relationship between the print ticket level, the corresponding XPS OM interface, and the methods used to access the print ticket resource.</span></span>

| <span data-ttu-id="d01b8-111">Уровень билета на печать</span><span class="sxs-lookup"><span data-stu-id="d01b8-111">Print Ticket Level</span></span> | <span data-ttu-id="d01b8-112">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="d01b8-112">Interface</span></span>                                                | <span data-ttu-id="d01b8-113">Метод Get</span><span class="sxs-lookup"><span data-stu-id="d01b8-113">Get Method</span></span>                                                                      | <span data-ttu-id="d01b8-114">Метод Set</span><span class="sxs-lookup"><span data-stu-id="d01b8-114">Set Method</span></span>                                                                      |
|--------------------|----------------------------------------------------------|---------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
| <span data-ttu-id="d01b8-115">Задание</span><span class="sxs-lookup"><span data-stu-id="d01b8-115">Job</span></span>                | [<span data-ttu-id="d01b8-116">**икспсомдокументсекуенце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-116">**IXpsOMDocumentSequence**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomdocumentsequence) | [<span data-ttu-id="d01b8-117">**жетпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-117">**GetPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomdocumentsequence-getprintticketresource) | [<span data-ttu-id="d01b8-118">**сетпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-118">**SetPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomdocumentsequence-setprintticketresource) |
| <span data-ttu-id="d01b8-119">Документ</span><span class="sxs-lookup"><span data-stu-id="d01b8-119">Document</span></span>           | [<span data-ttu-id="d01b8-120">**икспсомдокумент**</span><span class="sxs-lookup"><span data-stu-id="d01b8-120">**IXpsOMDocument**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomdocument)                 | [<span data-ttu-id="d01b8-121">**жетпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-121">**GetPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomdocument-getprintticketresource)         | [<span data-ttu-id="d01b8-122">**сетпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-122">**SetPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomdocument-setprintticketresource)         |
| <span data-ttu-id="d01b8-123">Страница</span><span class="sxs-lookup"><span data-stu-id="d01b8-123">Page</span></span>               | [<span data-ttu-id="d01b8-124">**икспсомпажереференце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-124">**IXpsOMPageReference**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompagereference)       | [<span data-ttu-id="d01b8-125">**жетпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-125">**GetPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompagereference-getprintticketresource)    | [<span data-ttu-id="d01b8-126">**сетпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-126">**SetPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompagereference-setprintticketresource)    |



 

## <a name="print-ticket-content"></a><span data-ttu-id="d01b8-127">Печать содержимого билетов</span><span class="sxs-lookup"><span data-stu-id="d01b8-127">Print Ticket Content</span></span>

<span data-ttu-id="d01b8-128">Доступ к содержимому существующего билета на печать может осуществляться путем считывания из потока, связанного с ресурсом.</span><span class="sxs-lookup"><span data-stu-id="d01b8-128">The content of an existing print ticket resource can be accessed by reading from the stream associated with the resource.</span></span> <span data-ttu-id="d01b8-129">Метод [**WebMethod**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomprintticketresource-getstream) интерфейса [**икспсомпринттиккетресаурце**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) возвращает указатель на поток только для чтения, содержащий XML-содержимое билета на печать.</span><span class="sxs-lookup"><span data-stu-id="d01b8-129">The [**GetStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomprintticketresource-getstream) method of the [**IXpsOMPrintTicketResource**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) interface returns the pointer to a read-only stream that contains the XML-formatted contents of the print ticket.</span></span> <span data-ttu-id="d01b8-130">Формат содержимого билета на печать описывается в [спецификации схемы печати](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="d01b8-130">The format of the print ticket content is described in the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="d01b8-131">Новый ресурс билета на печать можно создать, создав новый интерфейс [**икспсомпринттиккетресаурце**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) .</span><span class="sxs-lookup"><span data-stu-id="d01b8-131">A new print ticket resource can be created by creating a new [**IXpsOMPrintTicketResource**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource) interface.</span></span> <span data-ttu-id="d01b8-132">В потоке записывается допустимый XML-запрос на печать в формате, а для обнаружения части билета на печать создается URI части.</span><span class="sxs-lookup"><span data-stu-id="d01b8-132">A valid, XML-formatted print ticket is written to a stream and a part URI is created to identify the print ticket part.</span></span> <span data-ttu-id="d01b8-133">Дополнительные сведения о содержимом допустимого билета на печать см. в [спецификации печати схемы](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="d01b8-133">For more information about the content of a valid print ticket, refer to the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span> <span data-ttu-id="d01b8-134">Поток и URI части передаются как параметры вызова [**сетконтент**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomprintticketresource-setcontent) для установки нового ресурса билета на печать, а ресурс запроса на печать добавляется в соответствующую часть документа путем вызова метода **сетпринттиккетресаурце** , показанного в предыдущей таблице.</span><span class="sxs-lookup"><span data-stu-id="d01b8-134">The stream and the part URI are passed as parameters of the [**SetContent**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomprintticketresource-setcontent) call to set the new print ticket resource and the print ticket resource is added to the corresponding document part by calling the **SetPrintTicketResource** method shown in the preceding table.</span></span>

## <a name="print-ticket-inheritance"></a><span data-ttu-id="d01b8-135">Наследование билетов на печать</span><span class="sxs-lookup"><span data-stu-id="d01b8-135">Print Ticket Inheritance</span></span>

<span data-ttu-id="d01b8-136">Билеты на печать наследуют свойства билетов на печать с большей областью действия.</span><span class="sxs-lookup"><span data-stu-id="d01b8-136">Print tickets inherit the properties of print tickets with greater scope.</span></span> <span data-ttu-id="d01b8-137">Например, билет печати на уровне документа наследует свойства билета на печать на уровне задания, связанного с последовательностью документов документа.</span><span class="sxs-lookup"><span data-stu-id="d01b8-137">For example, a document-level print ticket inherits the properties of the job-level print ticket that is associated with the document's document sequence.</span></span> <span data-ttu-id="d01b8-138">Аналогичным образом, билет печати на уровне страницы наследует свойства билета печати на уровне документа, связанного с документом страницы.</span><span class="sxs-lookup"><span data-stu-id="d01b8-138">Likewise, a page-level print ticket inherits the properties of the document-level print ticket that is associated with the page's document.</span></span> <span data-ttu-id="d01b8-139">В этом процессе наследования свойства, указанные в билете печати нижнего уровня, переопределяют соответствующие свойства, которые в противном случае были бы унаследованы от билета печати более высокого уровня.</span><span class="sxs-lookup"><span data-stu-id="d01b8-139">In this inheritance process, properties that are specified in the lower-level print ticket override the corresponding properties that would otherwise be inherited from the higher-level print ticket.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d01b8-140">См. также</span><span class="sxs-lookup"><span data-stu-id="d01b8-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d01b8-141">Печать спецификации схемы</span><span class="sxs-lookup"><span data-stu-id="d01b8-141">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> <dt>

[<span data-ttu-id="d01b8-142">**икспсомдокумент**</span><span class="sxs-lookup"><span data-stu-id="d01b8-142">**IXpsOMDocument**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomdocument)
</dt> <dt>

[<span data-ttu-id="d01b8-143">**икспсомдокументсекуенце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-143">**IXpsOMDocumentSequence**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomdocumentsequence)
</dt> <dt>

[<span data-ttu-id="d01b8-144">**икспсомпажереференце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-144">**IXpsOMPageReference**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompagereference)
</dt> <dt>

[<span data-ttu-id="d01b8-145">**икспсомпринттиккетресаурце**</span><span class="sxs-lookup"><span data-stu-id="d01b8-145">**IXpsOMPrintTicketResource**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomprintticketresource)
</dt> <dt>

[<span data-ttu-id="d01b8-146">XPS</span><span class="sxs-lookup"><span data-stu-id="d01b8-146">XML Paper Specification</span></span>](https://www.ecma-international.org/activities/XML%20Paper%20Specification/XPS%20Standard%20WD%201.6.pdf)
</dt> </dl>

 

 



