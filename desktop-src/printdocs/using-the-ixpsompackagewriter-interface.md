---
description: Интерфейс Икспсомпаккажевритер создает файл документа XPS, в который приложения могут записывать содержимое интерфейсов Икспсомпаже OM модели XPS.
ms.assetid: eff1ab1e-2205-4f5c-9e32-199e073f5dbf
title: Использование интерфейса Икспсомпаккажевритер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1e8a34a0538ff09cc050ac287d5314be93f0da8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105702913"
---
# <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="50e89-103">Использование интерфейса Икспсомпаккажевритер</span><span class="sxs-lookup"><span data-stu-id="50e89-103">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="50e89-104">Интерфейс [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) создает файл документа XPS, в который приложения могут записывать содержимое интерфейсов [**ИКСПСОМПАЖЕ**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) OM модели XPS.</span><span class="sxs-lookup"><span data-stu-id="50e89-104">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an XPS document file into which applications can write the contents of the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interfaces of an XPS OM.</span></span> <span data-ttu-id="50e89-105">Интерфейс [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) наиболее удобен, когда содержимое документа обрабатывается или создается последовательно.</span><span class="sxs-lookup"><span data-stu-id="50e89-105">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface is most useful when document contents are being processed or created sequentially.</span></span> <span data-ttu-id="50e89-106">В отличие от методов [**вритетофиле**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) и [**вритетостреам**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) интерфейса [**Икспсомпаккаже**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) , для использования интерфейса **Икспсомпаккажевритер** не требуется использовать весь FixedDocument или FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="50e89-106">Unlike the [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) and [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) methods of the [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) interface, for the **IXpsOMPackageWriter** interface to be used neither the entire FixedDocument nor the FixedDocumentSequence has to be finished.</span></span>

## <a name="overview"></a><span data-ttu-id="50e89-107">Обзор</span><span class="sxs-lookup"><span data-stu-id="50e89-107">Overview</span></span>

<span data-ttu-id="50e89-108">Интерфейс [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) записывает по одной странице за раз, начиная от первой страницы документа XPS до последнего.</span><span class="sxs-lookup"><span data-stu-id="50e89-108">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface writes one page at a time, from the first page of an XPS document to the last.</span></span> <span data-ttu-id="50e89-109">Интерфейс можно использовать для создания простых файлов документов XPS, а также сложных файлов документов XPS, содержащих более одного FixedDocument в FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="50e89-109">The interface can be used to create simple XPS document files and also complex XPS document files that contain more than one FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="50e89-110">В сложных файлах документов XPS Фикседдокументс также создаются последовательно, начиная с первого FixedDocument в FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="50e89-110">In complex XPS document files, the FixedDocuments are also created in sequence, starting with the first FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="50e89-111">Интерфейс **икспсомпаккажевритер** не поддерживает создание содержимого документа в случайном порядке.</span><span class="sxs-lookup"><span data-stu-id="50e89-111">The **IXpsOMPackageWriter** interface does not support the creation of document contents in random order.</span></span> <span data-ttu-id="50e89-112">Используйте его, например, чтобы создать последовательный отчет или выполнить обработку в фильтре драйверов устройств, где содержимое документа подается в драйвер последовательно.</span><span class="sxs-lookup"><span data-stu-id="50e89-112">Use it, for example, to create a sequential report or to perform processing in a device driver filter where the document contents are fed to the driver in sequence.</span></span>

## <a name="terminology-review"></a><span data-ttu-id="50e89-113">Проверка терминологии</span><span class="sxs-lookup"><span data-stu-id="50e89-113">Terminology Review</span></span>

<span data-ttu-id="50e89-114">*Файл документа XPS* — это пакет Open Packaging Conventions (OPC), который соответствует спецификации формата XML.</span><span class="sxs-lookup"><span data-stu-id="50e89-114">An *XPS document file* is an Open Packaging Conventions (OPC) package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="50e89-115">Так что, технически, интерфейс [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) создает *пакет OPC*, но это пакет OPC, который соответствует спецификации формата XML.</span><span class="sxs-lookup"><span data-stu-id="50e89-115">So, technically, the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an *OPC package*, but it is an OPC package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="50e89-116">По этой причине в обсуждении документов XPS термины « *документ XPS* » и « *пакет* » часто взаимозаменяемы.</span><span class="sxs-lookup"><span data-stu-id="50e89-116">For this reason, in discussions about XPS documents, the terms *XPS document* and *package* are often used interchangeably.</span></span>

<span data-ttu-id="50e89-117">*Пакет* , созданный интерфейсом [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) , будет содержать необходимые компоненты документа XPS: FixedDocumentSequence, хотя бы один FixedDocument и хотя бы одну FixedPage.</span><span class="sxs-lookup"><span data-stu-id="50e89-117">The *package* created by the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface will contain the required XPS document components: a FixedDocumentSequence, at least one FixedDocument, and at least one FixedPage.</span></span> <span data-ttu-id="50e89-118">FixedDocumentSequence создается при создании экземпляра интерфейса **икспсомпаккажевритер** .</span><span class="sxs-lookup"><span data-stu-id="50e89-118">The FixedDocumentSequence is created when the **IXpsOMPackageWriter** interface is instantiated.</span></span> <span data-ttu-id="50e89-119">FixedDocument создается каждый раз, когда вызывается [**икспсомпаккажевритер:: стартневдокумент**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) , а FixedPage создается каждый раз, когда вызывается [**Икспсомпаккажевритер:: addPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) .</span><span class="sxs-lookup"><span data-stu-id="50e89-119">A FixedDocument is created every time [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) is called, and a FixedPage is created every time [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) is called.</span></span> <span data-ttu-id="50e89-120">Поскольку интерфейс записывает содержимое документа последовательно, метод **addPage** добавляет страницу к последнему созданному FixedDocument.</span><span class="sxs-lookup"><span data-stu-id="50e89-120">Because the interface writes the document contents sequentially, the **AddPage** method adds the page to the most recently created FixedDocument.</span></span>

## <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="50e89-121">Использование интерфейса Икспсомпаккажевритер</span><span class="sxs-lookup"><span data-stu-id="50e89-121">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="50e89-122">В следующей процедуре описывается создание файла документа XPS с помощью интерфейса [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="50e89-122">The following procedure describes how to create an XPS document file by using the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span> <span data-ttu-id="50e89-123">Процедура не описывает, как создать экземпляр интерфейса [**икспсомпаже**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) и его содержимое.</span><span class="sxs-lookup"><span data-stu-id="50e89-123">The procedure does not describe how to instantiate an [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface and its contents.</span></span> <span data-ttu-id="50e89-124">Дополнительные сведения о **икспсомпаже** и добавлении содержимого на страницу см. в разделе [интерфейсы страничной модели XPS](xps-object-model-page-interfaces.md) и разделы, перечисленные в статье см. также.</span><span class="sxs-lookup"><span data-stu-id="50e89-124">For more information about **IXpsOMPage** and adding content to a page, see [XPS OM Page Interfaces](xps-object-model-page-interfaces.md) and the topics listed in the See Also section.</span></span>

 <span data-ttu-id="50e89-125">**Создание документа**</span><span class="sxs-lookup"><span data-stu-id="50e89-125">**Creating a document**</span></span>

1.  <span data-ttu-id="50e89-126">Создайте экземпляр интерфейса [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="50e89-126">Instantiate an [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span>

    <span data-ttu-id="50e89-127">В пакете будет создано пустое FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="50e89-127">This creates an empty FixedDocumentSequence in the package.</span></span>

    -   <span data-ttu-id="50e89-128">Чтобы создать документ XPS в файле, вызовите [**икспсомобжектфактори:: креатепаккажевритеронфиле**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span><span class="sxs-lookup"><span data-stu-id="50e89-128">To create an XPS document in a file, call [**IXpsOMObjectFactory::CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span></span>
    -   <span data-ttu-id="50e89-129">Чтобы создать документ XPS в потоке, вызовите метод [**икспсомобжектфактори:: креатепаккажевритеронстреам**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span><span class="sxs-lookup"><span data-stu-id="50e89-129">To create an XPS document in a stream, call [**IXpsOMObjectFactory::CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span></span>

2.  <span data-ttu-id="50e89-130">Запустите новый документ в пакете, вызвав [**икспсомпаккажевритер:: стартневдокумент**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="50e89-130">Start a new document in the package by calling [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>

    <span data-ttu-id="50e89-131">Перед добавлением страницы вызовите [**икспсомпаккажевритер:: стартневдокумент**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) , чтобы добавить FixedDocument в FixedDocumentSequence, созданный на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="50e89-131">Before adding a page, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) to add a FixedDocument to the FixedDocumentSequence that was created in step 1.</span></span>

3.  <span data-ttu-id="50e89-132">Добавление содержимого.</span><span class="sxs-lookup"><span data-stu-id="50e89-132">Add content.</span></span>
    -   <span data-ttu-id="50e89-133">Чтобы добавить в документ новую FixedPage, вызовите метод [**икспсомпаккажевритер:: addPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), передав ему указатель на интерфейс [**икспсомпаже**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) , который содержит содержимое FixedPage, которое требуется добавить.</span><span class="sxs-lookup"><span data-stu-id="50e89-133">To add a new FixedPage to the document, call [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), passing it a pointer to the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface that has the contents of the FixedPage that you want to add.</span></span>
    -   <span data-ttu-id="50e89-134">Чтобы создать новый FixedDocument в FixedDocumentSequence, вызовите [**икспсомпаккажевритер:: стартневдокумент**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="50e89-134">To create a new FixedDocument in the FixedDocumentSequence, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>
4.  <span data-ttu-id="50e89-135">Закройте пакет и его содержимое, вызвав [**икспсомпаккажевритер:: Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span><span class="sxs-lookup"><span data-stu-id="50e89-135">Close the package and its contents by calling [**IXpsOMPackageWriter::Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span></span>

## <a name="advanced-features"></a><span data-ttu-id="50e89-136">Дополнительные функции</span><span class="sxs-lookup"><span data-stu-id="50e89-136">Advanced Features</span></span>

<span data-ttu-id="50e89-137">Методы интерфейса [**икспсомпаккажевритер**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) также поддерживают добавление ресурсов, эскизов и билетов на печать.</span><span class="sxs-lookup"><span data-stu-id="50e89-137">The methods of the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface also support the adding of resources, thumbnails, and print tickets.</span></span> <span data-ttu-id="50e89-138">Эти компоненты документов можно добавлять на уровнях Package, FixedDocumentSequence, FixedDocument и FixedPage.</span><span class="sxs-lookup"><span data-stu-id="50e89-138">These document components can be added at the package, FixedDocumentSequence, FixedDocument, and FixedPage levels.</span></span> <span data-ttu-id="50e89-139">Дополнительные сведения об использовании этого интерфейса для печати см. [в разделе Printing a XPS OM](print-an-xps-om.md).</span><span class="sxs-lookup"><span data-stu-id="50e89-139">For more information about using this interface for printing, see [Print an XPS OM](print-an-xps-om.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="50e89-140">См. также</span><span class="sxs-lookup"><span data-stu-id="50e89-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="50e89-141">Использование API цифровых подписей XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-141">Using XPS Digital Signature API</span></span>](using-digital-signatures-in-xps-documents.md)
</dt> <dt>

[<span data-ttu-id="50e89-142">Интерфейсы страницы OM XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-142">XPS OM Page Interfaces</span></span>](xps-object-model-page-interfaces.md)
</dt> <dt>

[<span data-ttu-id="50e89-143">Навигация по OM XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-143">Navigate the XPS OM</span></span>](navigate-the-xps-om.md)
</dt> <dt>

[<span data-ttu-id="50e89-144">Работа с холстом и визуальными интерфейсами в модели XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-144">Working with XPS OM Canvas and Visual Interfaces</span></span>](working-with-xpsomcanvas-interfaces.md)
</dt> <dt>

[<span data-ttu-id="50e89-145">Работа с интерфейсами Path в модели XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-145">Working with XPS OM Path Interfaces</span></span>](working-with-xps-object-model-path-interfaces.md)
</dt> <dt>

[<span data-ttu-id="50e89-146">Работа с интерфейсами Text, Graphics и Image в XPS OM</span><span class="sxs-lookup"><span data-stu-id="50e89-146">Working with XPS OM Text, Graphics, and Image Interfaces</span></span>](working-with-xps-object-model-text-and-image-interfaces.md)
</dt> <dt>

[<span data-ttu-id="50e89-147">Интерфейсы билета на печать Operations Manager XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-147">XPS OM Print Ticket Interfaces</span></span>](xps-object-model-print-ticket-interfaces.md)
</dt> <dt>

[<span data-ttu-id="50e89-148">**икспсомсумбнаилженератор**</span><span class="sxs-lookup"><span data-stu-id="50e89-148">**IXpsOMThumbnailGenerator**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator)
</dt> <dt>

[<span data-ttu-id="50e89-149">Справочник по API документов XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-149">XPS Document API Reference</span></span>](xps-programming-reference.md)
</dt> <dt>

[<span data-ttu-id="50e89-150">XPS</span><span class="sxs-lookup"><span data-stu-id="50e89-150">XML Paper Specification</span></span>](https://www.ecma-international.org/activities/XML%20Paper%20Specification/XPS%20Standard%20WD%201.6.pdf)
</dt> </dl>

 

 



