---
description: Функция AddJob добавляет задание печати в список заданий печати, которые могут быть запланированы диспетчером очереди печати. Функция возвращает имя файла, который можно использовать для хранения задания.
ms.assetid: cfafa874-6022-4bf4-bf3d-096213eb0c98
title: Функция AddJob (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- AddJob
- AddJobA
- AddJobW
api_type:
- DllExport
api_location:
- Winspool.drv
ms.openlocfilehash: de99b0866e8cd7ec8486d2a3f15f95194b4350008a43fe4db8ae82d970684c39
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119950754"
---
# <a name="addjob-function"></a>Функция AddJob

Функция **AddJob** добавляет задание печати в список заданий печати, которые могут быть запланированы диспетчером очереди печати. Функция возвращает имя файла, который можно использовать для хранения задания.

> [!NOTE]
> в Windows 8 и более поздних операционных системах мы не рекомендуем использовать **AddJob** напрямую, так как существуют случаи (например, печать в очередь с помощью файла: или портпромпт:). где **AddJob** завершится ошибкой. Вместо этого рекомендуется использовать [API печати GDI](gdi-printing.md), [API печати XPS](xps-printing.md), [**стартдокпринтер**](startdocprinter.md)или соответствующий метод из [**Windows. Графическое. Печать**](/uwp/api/Windows.Graphics.Printing) пространства имен в зависимости от сценария печати.
>
> Если попытаться выполнить печать в очередь с помощью **файла:** или **портпромпт:**, **AddJob** вернет ошибку Not \_ Supported.

## <a name="syntax"></a>Синтаксис

```C++
BOOL AddJob(
  _In_  HANDLE  hPrinter,
  _In_  DWORD   Level,
  _Out_ LPBYTE  pData,
  _In_  DWORD   cbBuf,
  _Out_ LPDWORD pcbNeeded
);
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*хпринтер* \[ окне\]
</dt> <dd>

Маркер, указывающий принтер для задания печати. Это должен быть локальный принтер, настроенный в качестве принтера с буферизацией. Если *хпринтер* является маркером подключения к удаленному принтеру или если принтер настроен для прямой печати, функция **AddJob** завершается ошибкой. Используйте функцию [**опенпринтер**](openprinter.md) или [**аддпринтер**](addprinter.md) для получения маркера принтера.

</dd> <dt>

*Уровень* \[ окне\]
</dt> <dd>

Версия структуры данных о задании печати, которую функция сохраняет в буфер, на который указывает *pData*. Присвойте этому параметру значение One.

</dd> <dt>

*pData* \[ заполняет\]
</dt> <dd>

Указатель на буфер, который получает структуру данных [**ADDJOB \_ info \_ 1**](addjob-info-1.md) и строку пути.

</dd> <dt>

*кббуф* \[ окне\]
</dt> <dd>

Размер (в байтах) буфера, на который указывает *pData*. Буфер должен быть достаточно большим, чтобы содержать структуру [**ADDJOB \_ info \_ 1**](addjob-info-1.md) и строку пути.

</dd> <dt>

*пкбнидед* \[ заполняет\]
</dt> <dd>

Указатель на переменную, которая получает общий размер (в байтах) структуры данных [**ADDJOB \_ info \_ 1**](addjob-info-1.md) плюс строку пути. Если это значение меньше или равно *кббуф* и функция выполнена, это фактическое число байтов, записанных в буфер, на который указывает *pData*. Если это число больше *кббуф*, буфер слишком мал, и необходимо повторно вызвать функцию с размером буфера по крайней мере до размера \* *пкбнидед*.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение будет ненулевым.

Если функция выполняется неудачно, возвращается нулевое значение.

## <a name="remarks"></a>Remarks

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Можно вызвать функцию [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , чтобы открыть файл очереди, заданный элементом **path** структуры [**ADDJOB \_ info \_ 1**](addjob-info-1.md) , а затем вызвать функцию [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) для записи в него данных задания печати. После этого вызовите функцию [**ScheduleJob**](schedulejob.md) , чтобы уведомить Диспетчер очереди печати о том, что задание печати может быть запланировано с помощью диспетчера очереди печати.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>винспул. h (включает Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Винспул. drv</dt> </dl>                   |
| Имя в кодировке Юникод и ANSI<br/>   | **Адджобв** (Юникод) и **адджоба** (ANSI)<br/>                                                   |



## <a name="see-also"></a>См. также

<dl> <dt>

[**\_Сведения о ADDJOB \_ 1**](addjob-info-1.md)
</dt> <dt>

[**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea)
</dt> <dt>

[API печати GDI](gdi-printing.md)
</dt> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**опенпринтер**](openprinter.md)
</dt> <dt>

[**ScheduleJob**](schedulejob.md)
</dt> <dt>

[**стартдокпринтер**](startdocprinter.md)
</dt> <dt>

[**Windows. Graphics. Printing**](/uwp/api/Windows.Graphics.Printing)
</dt> <dt>

[**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile)
</dt> <dt>

[API печати XPS](xps-printing.md)
</dt> </dl>

 

