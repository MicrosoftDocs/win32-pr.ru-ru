---
description: Функция Сетжоб приостанавливает, возобновляет, отменяет или перезапускает задание печати на указанном принтере. Можно также использовать функцию Сетжоб, чтобы задать параметры задания печати, такие как приоритет задания печати и имя документа.
ms.assetid: 21947c69-c517-4962-8eb7-b45ed4211d9a
title: Функция Сетжоб (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SetJob
- SetJobA
- SetJobW
api_type:
- DllExport
api_location:
- WinSpool.drv
- Ext-MS-Win-Printer-WinSpool-l1-1-2.dll
- Ext-MS-Win-Printer-WinSpool-L1-1-3.dll
ms.openlocfilehash: 34dfc8c0239a10d7e7f036beed457d57329f4c67
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683872"
---
# <a name="setjob-function"></a>Функция Сетжоб

Функция **сетжоб** приостанавливает, возобновляет, отменяет или перезапускает задание печати на указанном принтере. Можно также использовать функцию **сетжоб** , чтобы задать параметры задания печати, такие как приоритет задания печати и имя документа.

Функцию **сетжоб** можно использовать, чтобы передать команду заданию печати или задать параметры задания печати или выполнить оба действия в одном вызове. Значение параметра *команды* не влияет на то, как функция использует параметры *Level* и *пжоб* . Кроме того, можно использовать **сетжоб** со [**\_ сведениями \_ о задании 3**](job-info-3.md) , чтобы связать набор заданий печати. Дополнительные сведения см. в разделе "Примечания".

## <a name="syntax"></a>Синтаксис


```C++
BOOL SetJob(
  _In_ HANDLE hPrinter,
  _In_ DWORD  JobId,
  _In_ DWORD  Level,
  _In_ LPBYTE pJob,
  _In_ DWORD  Command
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*хпринтер* \[ окне\]
</dt> <dd>

Описатель объекта принтера, который нужно заинтересовать. Используйте функцию [**опенпринтер**](openprinter.md), [**OpenPrinter2**](openprinter2.md)или [**аддпринтер**](addprinter.md) для получения маркера принтера.

</dd> <dt>

Идентификатор *задания* \[ окне\]
</dt> <dd>

Идентификатор, указывающий задание печати. Чтобы получить идентификатор задания печати, вызовите функцию [**AddJob**](addjob.md) или функцию [**стартдок**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca) .

Если параметр *Level* имеет значение 3, то параметр *JOBID* должен соответствовать элементу **JOBID** структуры [**задания \_ \_ 3**](job-info-3.md) , на которую указывает *пжоб*

</dd> <dt>

*Уровень* \[ окне\]
</dt> <dd>

Тип структуры сведений о задании, на которую указывает параметр *пжоб* .

**Все версии Windows**: для параметра *уровня* можно задать значение 0, 1 или 2. Если для параметра *Level* задать значение 0, *Пжоб* должен иметь **значение NULL**. Используйте эти значения, если не заданы какие либо параметры задания печати.

Можно также задать для параметра *уровня* значение 3.

Начиная с **Windows Vista**, можно также задать для параметра *уровня* значение 4.

</dd> <dt>

*пжоб* \[ окне\]
</dt> <dd>

Указатель на структуру, которая задает параметры задания печати.

**Все версии Windows**: *пжоб* могут указывать на структуру [**\_ сведений о задании \_ 1**](job-info-1.md) или [**о задании \_ \_ 2**](job-info-2.md) .

*пжоб* также может указывать на структуру [**\_ сведений о \_ задании 3**](job-info-3.md) . Необходимо иметь **\_ доступ к заданиям \_ Администрирование** разрешение на доступ для заданий, указанных в элементах **JOBID** и **некстжобид** структуры **\_ сведений о задании \_ 3** .

Начиная с **Windows Vista**: *пжоб* также может указывать на структуру [**\_ сведений о \_ задании 4**](job-info-4.md) .

Если параметр *уровня* равен 0, *Пжоб* должен иметь **значение NULL**.

</dd> <dt>

*Команда* \[ окне\]
</dt> <dd>

Выполняемая операция задания печати. Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                                            | Значение                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| <span id="JOB_CONTROL_CANCEL"></span><span id="job_control_cancel"></span><dl> <dt>**\_Отмена управления заданиями \_**</dt> </dl>                                    | Не используйте. Чтобы удалить задание печати, используйте **\_ элемент управления заданием \_ Удалить**.<br/>        |
| <span id="JOB_CONTROL_PAUSE"></span><span id="job_control_pause"></span><dl> <dt>**Приостановка задания \_ управления \_**</dt> </dl>                                       | Приостановка задания печати.<br/>                                                    |
| <span id="JOB_CONTROL_RESTART"></span><span id="job_control_restart"></span><dl> <dt>**Управление ЗАДАНИЕм \_ \_ перезапуска**</dt> </dl>                                 | Перезапустите задание печати. Задание может быть перезапущено только при его печати.<br/>  |
| <span id="JOB_CONTROL_RESUME"></span><span id="job_control_resume"></span><dl> <dt>**возобновление управления ЗАДАНИЯми \_ \_**</dt> </dl>                                    | Возобновление приостановленного задания печати.<br/>                                              |
| <span id="JOB_CONTROL_DELETE"></span><span id="job_control_delete"></span><dl> <dt>**\_Удаление элемента управления заданием \_**</dt> </dl>                                    | Удалите задание печати.<br/>                                                   |
| <span id="JOB_CONTROL_SENT_TO_PRINTER"></span><span id="job_control_sent_to_printer"></span><dl> <dt>**Управление ЗАДАНИЕм \_ \_ Отправлено \_ на \_ принтер**</dt> </dl>       | Используется мониторами портов для завершения задания печати.<br/>                             |
| <span id="JOB_CONTROL_LAST_PAGE_EJECTED"></span><span id="job_control_last_page_ejected"></span><dl> <dt>**Последняя страница "Управление ЗАДАНИЕм" \_ \_ \_ \_ извлечена**</dt> </dl> | Используется мониторами языка для завершения задания печати.<br/>                         |
| <span id="JOB_CONTROL_RETAIN"></span><span id="job_control_retain"></span><dl> <dt>**\_сохраняемый элемент управления задания \_**</dt> </dl>                                    | **Windows Vista и более поздние версии**: задание должно находиться в очереди после печати.<br/> |
| <span id="JOB_CONTROL_RELEASE"></span><span id="job_control_release"></span><dl> <dt>**\_выпуск элемента управления задания \_**</dt> </dl>                                 | **Windows Vista и более поздние версии**: отпустите задание печати.<br/>                     |



 

Вы можете использовать тот же вызов функции **сетжоб** , чтобы задать параметры задания печати и дать команду заданию печати. Поэтому *команда* не должна иметь значение 0, если заданы параметры задания печати, хотя это может быть.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение будет ненулевым.

Если функция выполняется неудачно, возвращается нулевое значение.

## <a name="remarks"></a>Комментарии

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Для задания различных параметров задания печати можно использовать функцию **сетжоб** , указав указатель на сведения о задании [**\_ \_ 1**](job-info-1.md), [**сведения о задании \_ \_ 2**](job-info-2.md), [**\_ сведения о задании \_ 3**](job-info-3.md)или [**\_ сведения о задании \_ 4**](job-info-4.md) , содержащие необходимые данные.

Чтобы удалить или удалить все задания печати для конкретного принтера, вызовите функцию [**сетпринтер**](setprinter.md) с параметром *Command* , для которого задана **\_ \_ Очистка элемента управления принтера**.

Следующие члены структуры [**\_ сведений о задании \_ 1**](job-info-1.md), [**\_ сведения о \_ задании 2**](job-info-2.md)или [**\_ сведения о задании \_ 4**](job-info-4.md) игнорируются при вызове **сетжоб**: **JOBID**, **ппринтернаме**, **пмачиненаме**, **пусернаме**, **пдривернаме**, **size**, **отправлен**, **time** и **TotalPages**.

Чтобы изменить расположение задания печати в очереди печати, необходимо иметь разрешение на доступ к **принтеру \_ \_ Управление** доступом к принтеру.

Если вы не хотите задавать расположение задания печати в очереди печати, необходимо задать для элемента **должность** в структуре задания [**\_ \_ 1**](job-info-1.md), [**\_ сведения о задании \_ 2**](job-info-2.md)или [**\_ сведения о задании \_ 4**](job-info-4.md) значение **должность задания не \_ \_ указано**.

Используйте функцию **сетжоб** с структурой [**\_ сведений о \_ задании 3**](job-info-3.md) , чтобы связать набор заданий печати (также называемых цепочкой). Это полезно в ситуациях, когда один документ состоит из нескольких частей, которые нужно визуализировать отдельно. Для печати заданий A, B, C и D по порядку вызовите **сетжоб** со [**\_ сведениями \_ о задании 4**](job-info-4.md) , чтобы связать A с b, b с c и c по D.

При связывании заданий печати обратите внимание на следующее.

-   Задания можно добавлять в начало или в конец цепочки.
-   Все задания в цепочке должны иметь один и тот же тип данных.
-   Цепочка должна быть полностью связана перед началом буферизации, в противном случае диспетчер очереди печати может печатать и удалять задания, помещенные в очередь, прежде чем связать их все. Существует два способа сделать цепочку непреждевременной печати:

    -   Приостановите первое задание в цепочке, пока цепочка не будет полностью связана. Приостановленное состояние первого задания управляет состоянием всех заданий в цепочке.
    -   Не заключайте первое задание в неполное, т. е. не вызывайте [**енддок**](/windows/desktop/api/Wingdi/nf-wingdi-enddoc) или [**ScheduleJob**](schedulejob.md) для первого задания. Тем не менее, если включен параметр "печатать при постановке в очередь" (по умолчанию), этот метод блокирует порт во время сборки цепочки, что также предотвращает печать несвязанных заданий.

-   Приложение должно работать в случае, когда пользователь удаляет задание в цепочке до того, как цепочка завершает печать. Аргумент [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) возвращает **Недопустимый \_ параметр** , если идентификатор задания не существует.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>Винспул. h (включение Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Винспул. drv</dt> </dl>                   |
| Имя в кодировке Юникод и ANSI<br/>   | **Сетжобв** (Юникод) и **сетжоба** (ANSI)<br/>                                                   |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**AddJob**](addjob.md)
</dt> <dt>

[**жетжоб**](getjob.md)
</dt> <dt>

[**опенпринтер**](openprinter.md)
</dt> <dt>

[**сетпринтер**](setprinter.md)
</dt> <dt>

[**\_Сведения о задании \_ 1**](job-info-1.md)
</dt> <dt>

[**\_Сведения о задании \_ 2**](job-info-2.md)
</dt> <dt>

[**\_Сведения о задании \_ 3**](job-info-3.md)
</dt> <dt>

[**\_Сведения о задании \_ 4**](job-info-4.md)
</dt> </dl>

 

