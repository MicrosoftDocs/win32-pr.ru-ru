---
description: Уровни API (Direct3D 10)
ms.assetid: 19c81383-6ac7-49ea-98a3-bf761a32ab40
title: Уровни API (Direct3D 10)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b07b33dfd8280af13ea3df74e5e6d0fd040bb2c
ms.sourcegitcommit: ca37395fd832e798375e81142b97cffcffabf184
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/24/2021
ms.locfileid: "110335418"
---
# <a name="api-layers-direct3d-10"></a><span data-ttu-id="65978-103">Уровни API (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="65978-103">API Layers (Direct3D 10)</span></span>

<span data-ttu-id="65978-104">Среда выполнения Direct3D 10 создается с использованием слоев, начиная с базовой функциональности ядра и создавая необязательные функции и возможности для разработчиков во внешних слоях.</span><span class="sxs-lookup"><span data-stu-id="65978-104">The Direct3D 10 runtime is constructed with layers, starting with the basic functionality at the core and building optional and developer-assist functionality in outer layers.</span></span>

## <a name="core-layer"></a><span data-ttu-id="65978-105">Уровень ядра</span><span class="sxs-lookup"><span data-stu-id="65978-105">Core Layer</span></span>

<span data-ttu-id="65978-106">Основной слой существует по умолчанию. обеспечение очень тонкого сопоставления между API и драйвером устройства, что сводит к минимуму затраты на вызовы с высокой частотой.</span><span class="sxs-lookup"><span data-stu-id="65978-106">The core layer exists by default; providing a very thin mapping between the API and the device driver, minimizing overhead for high-frequency calls.</span></span> <span data-ttu-id="65978-107">Поскольку основной уровень является важным для производительности, он выполняет только критическую проверку.</span><span class="sxs-lookup"><span data-stu-id="65978-107">As the core layer is essential for performance, it only performs critical validation.</span></span>

<span data-ttu-id="65978-108">Остальные слои являются необязательными.</span><span class="sxs-lookup"><span data-stu-id="65978-108">The remaining layers are optional.</span></span> <span data-ttu-id="65978-109">Как правило, слои добавляют функциональные возможности, но не изменяют существующее поведение.</span><span class="sxs-lookup"><span data-stu-id="65978-109">As a general rule, layers add functionality, but do not modify existing behavior.</span></span> <span data-ttu-id="65978-110">Например, основные функции будут иметь одинаковые возвращаемые значения независимо от создаваемого слоя отладки, хотя при создании экземпляра слоя отладки могут быть предоставлены дополнительные выходные данные отладки.</span><span class="sxs-lookup"><span data-stu-id="65978-110">For example, core functions will have the same return values independent of the debug layer being instantiated, although additional debug output may be provided if the debug layer is instantiated.</span></span>

<span data-ttu-id="65978-111">Создавайте слои при создании устройства, вызвав [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) и указав один или несколько [**D3D10 \_ создать значения \_ \_ флагов устройства**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) .</span><span class="sxs-lookup"><span data-stu-id="65978-111">Create layers when a device is created by calling [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) and supplying one or more [**D3D10\_CREATE\_DEVICE\_FLAG**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) values.</span></span>

## <a name="debug-layer"></a><span data-ttu-id="65978-112">Отладочный слой</span><span class="sxs-lookup"><span data-stu-id="65978-112">Debug Layer</span></span>

<span data-ttu-id="65978-113">Слой отладки предоставляет широкие возможности проверки целостности и согласованности (например, проверка компоновки шейдера и привязки ресурсов, проверка согласованности параметров и сообщения об ошибках).</span><span class="sxs-lookup"><span data-stu-id="65978-113">The debug layer provides extensive additional parameter and consistency validation (such as validating shader linkage and resource binding, validating parameter consistency, and reporting error descriptions).</span></span> <span data-ttu-id="65978-114">Выходные данные, формируемые слоем отладки, состоят из очереди строк, доступ к которой можно получить с помощью [**интерфейса ID3D10InfoQueue**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) (см. раздел [Настройка выходных данных отладки с использованием ID3D10InfoQueue (Direct3D 10)](d3d10-graphics-programming-guide-api-features-layers-info-queue.md)).</span><span class="sxs-lookup"><span data-stu-id="65978-114">The output generated by the debug layer consists of a queue of strings which are accessible using the [**ID3D10InfoQueue Interface**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) (see [Customize Debug Output with ID3D10InfoQueue (Direct3D 10)](d3d10-graphics-programming-guide-api-features-layers-info-queue.md)).</span></span> <span data-ttu-id="65978-115">Ошибки, создаваемые основным слоем, выделяются предупреждениями слоя отладки.</span><span class="sxs-lookup"><span data-stu-id="65978-115">Errors generated by the core layer are highlighted with warnings by the debug layer.</span></span>

<span data-ttu-id="65978-116">Чтобы создать устройство, поддерживающее уровень отладки, необходимо установить пакет SDK DirectX (для получения D3D10SDKLayers.DLL), а затем указать \_ флаг D3D10 Create \_ Device \_ Debug при вызове [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice).</span><span class="sxs-lookup"><span data-stu-id="65978-116">To create a device that supports the debug layer, you must install the DirectX SDK (to get D3D10SDKLayers.DLL), and then specify the D3D10\_CREATE\_DEVICE\_DEBUG flag when calling [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice).</span></span> <span data-ttu-id="65978-117">Конечно, запуск приложения с отладочным слоем будет существенно медленнее.</span><span class="sxs-lookup"><span data-stu-id="65978-117">Of course, running an application with the debug layer will be substantially slower.</span></span> <span data-ttu-id="65978-118">Чтобы включить или отключить сообщения отладки для API-интерфейсов D3DX10, вызовите [**D3DX10DebugMute**](d3dx10debugmute.md).</span><span class="sxs-lookup"><span data-stu-id="65978-118">To enable/disable debug messages for D3DX10 APIs, call [**D3DX10DebugMute**](d3dx10debugmute.md).</span></span>

<span data-ttu-id="65978-119">Когда уровень отладки перечисляет утечки памяти, он выводит список указателей на объектные интерфейсы и их понятные имена.</span><span class="sxs-lookup"><span data-stu-id="65978-119">When the debug layer lists memory leaks, it outputs a list of object interface pointers along with their friendly names.</span></span> <span data-ttu-id="65978-120">Понятное имя по умолчанию — безымянное &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="65978-120">The default friendly name is "&lt;unnamed&gt;".</span></span> <span data-ttu-id="65978-121">Понятное имя можно задать с помощью метода [**ID3D10DeviceChild:: сетприватедата**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) и идентификатора GUID **вкпдид \_ D3DDebugObjectName** , который находится в D3Dcommon. h.</span><span class="sxs-lookup"><span data-stu-id="65978-121">You can set the friendly name by using the [**ID3D10DeviceChild::SetPrivateData**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) method and the **WKPDID\_D3DDebugObjectName** GUID that is in D3Dcommon.h.</span></span> <span data-ttu-id="65978-122">Например, чтобы присвоить имя Птекстуре имя Сдклайер mytexture.jpg, используйте следующий код:</span><span class="sxs-lookup"><span data-stu-id="65978-122">For example, to name pTexture with a SDKLayer name of mytexture.jpg, use the following code:</span></span>


```
const char c_szName[] = "mytexture.jpg";
pTexture->SetPrivateData( WKPDID_D3DDebugObjectName, sizeof( c_szName ) - 1, c_szName );
```



<span data-ttu-id="65978-123">Как правило, следует компилировать эти вызовы из рабочей версии.</span><span class="sxs-lookup"><span data-stu-id="65978-123">Typically, you should compile these calls out of your production version.</span></span>

## <a name="switch-to-reference-layer"></a><span data-ttu-id="65978-124">Уровень переключения на ссылку</span><span class="sxs-lookup"><span data-stu-id="65978-124">Switch-to-Reference Layer</span></span>

<span data-ttu-id="65978-125">Этот уровень позволяет приложению переходить между аппаратным устройством (HAL) и ссылкой или программным устройством (REF).</span><span class="sxs-lookup"><span data-stu-id="65978-125">This layer enables an application to transition between a hardware device (HAL) and a reference or software device (REF).</span></span> <span data-ttu-id="65978-126">Чтобы переключить устройство, необходимо сначала создать устройство, которое поддерживает уровень переключения на ссылку (см. [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)), а затем вызвать [**ID3D10SwitchToRef:: сетусереф**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref).</span><span class="sxs-lookup"><span data-stu-id="65978-126">To switch a device, you must first create a device that supports the switch-to-reference layer (see [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)) and then call [**ID3D10SwitchToRef::SetUseRef**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref).</span></span>

<span data-ttu-id="65978-127">Все состояния устройств, ресурсы и объекты поддерживаются в этом переходе на устройство.</span><span class="sxs-lookup"><span data-stu-id="65978-127">All device states, resources and objects are maintained through this device transition.</span></span> <span data-ttu-id="65978-128">Однако иногда невозможно точно сопоставить данные ресурсов.</span><span class="sxs-lookup"><span data-stu-id="65978-128">However, it is sometimes not possible to exactly match resource data.</span></span> <span data-ttu-id="65978-129">Это связано с тем, что некоторые сведения доступны для устройства, которое недоступно для устройства-образца.</span><span class="sxs-lookup"><span data-stu-id="65978-129">This is due to the fact that some information is available to a hardware device that is not available to a reference device.</span></span>

<span data-ttu-id="65978-130">Практически все приложения в режиме реального времени используют реализацию HAL конвейера.</span><span class="sxs-lookup"><span data-stu-id="65978-130">Virtually all real-time applications use the HAL implementation of the pipeline.</span></span> <span data-ttu-id="65978-131">Когда конвейер переключается с аппаратного устройства на эталонное устройство, операции отрисовки выполняются одновременно в аппаратном и программном обеспечении.</span><span class="sxs-lookup"><span data-stu-id="65978-131">When the pipeline is switched from a hardware device to a reference device, rendering operations are done simultaneously in both hardware and software.</span></span> <span data-ttu-id="65978-132">При отрисовке программного обеспечения оно потребует загрузки ресурсов в системную память.</span><span class="sxs-lookup"><span data-stu-id="65978-132">As the software device is rendering, it will require that resources are downloaded to system memory.</span></span> <span data-ttu-id="65978-133">Это может потребовать исключения других ресурсов, кэшированных в системной памяти, для освобождения места.</span><span class="sxs-lookup"><span data-stu-id="65978-133">This may require other resources cached in system memory to be evicted to make room.</span></span>

> [!Note]  
> <span data-ttu-id="65978-134">Эта функция уровня "переключение на ссылку" поддерживается только в Direct3D 10 и Direct3D 10,1 и больше не поддерживается в Direct3D 11 и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="65978-134">This switch-to-reference-layer feature is supported only in Direct3D 10 and Direct3D 10.1, and is no longer supported in Direct3D 11 and later versions.</span></span>

 

## <a name="thread-safe-layer"></a><span data-ttu-id="65978-135">Уровень Thread-Safe</span><span class="sxs-lookup"><span data-stu-id="65978-135">Thread-Safe Layer</span></span>

<span data-ttu-id="65978-136">Этот уровень предназначен для предоставления многопоточным приложениям доступа к устройству из нескольких потоков.</span><span class="sxs-lookup"><span data-stu-id="65978-136">This layer is designed to allow multi-threaded applications to access the device from multiple threads.</span></span>

<span data-ttu-id="65978-137">Приложение Direct3D 10 может управлять синхронизацией устройства с помощью функций устройства.</span><span class="sxs-lookup"><span data-stu-id="65978-137">A Direct3D 10 application can control a device synchronization using device functions.</span></span> <span data-ttu-id="65978-138">Это позволяет приложению включать и отключать критически важные разделы (временно включать и отключать защиту от многопоточности) и принимать/освобождать блокировку критических разделов на нескольких точках входа API Direct3D 10.</span><span class="sxs-lookup"><span data-stu-id="65978-138">This enables an application to enable/disable critical sections (temporarily enabling/disabling multithreading protection), and take/release a critical-section lock over multiple Direct3D 10 API entry points.</span></span> <span data-ttu-id="65978-139">Потокобезопасный уровень включен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="65978-139">The thread-safe layer is enabled by default.</span></span> <span data-ttu-id="65978-140">Для однопотоковых приложений уровень, который является потокобезопасным, не влияет на производительность.</span><span class="sxs-lookup"><span data-stu-id="65978-140">For single-threaded applications, the thread-safe layer has no impact on performance.</span></span>




<span data-ttu-id="65978-141">Различия между Direct3D 9 и Direct3D 10:</span><span class="sxs-lookup"><span data-stu-id="65978-141">Differences between Direct3D 9 and Direct3D 10:</span></span>

- <span data-ttu-id="65978-142">В отличие от Direct3D 9, API Direct3D 10 по умолчанию имеет полностью потокобезопасную.</span><span class="sxs-lookup"><span data-stu-id="65978-142">Unlike Direct3D 9, the Direct3D 10 API defaults to fully thread-safe.</span></span>



 

## <a name="related-topics"></a><span data-ttu-id="65978-143">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="65978-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="65978-144">Функции API (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="65978-144">API Features (Direct3D 10)</span></span>](d3d10-graphics-programming-guide-api-features.md)
</dt> </dl>

 

 




