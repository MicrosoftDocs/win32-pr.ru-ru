---
title: Управление наборами свойств
description: Набор постоянных свойств содержит связанные данные в виде свойств.
ms.assetid: 19ff2751-87f3-43d8-9307-ce2dd399f694
keywords:
- Управление наборами свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af3f9862d3074a5221bf1d5d975754486a562f87
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105661740"
---
# <a name="managing-property-sets"></a><span data-ttu-id="d586b-104">Управление наборами свойств</span><span class="sxs-lookup"><span data-stu-id="d586b-104">Managing Property Sets</span></span>

<span data-ttu-id="d586b-105">Набор постоянных свойств содержит связанные данные в виде свойств.</span><span class="sxs-lookup"><span data-stu-id="d586b-105">A persistent property set contains related data as properties.</span></span> <span data-ttu-id="d586b-106">Каждый набор свойств определяется с помощью FMTID и глобально уникального идентификатора (GUID), который позволяет приложениям получать доступ к набору свойств, чтобы идентифицировать набор свойств.</span><span class="sxs-lookup"><span data-stu-id="d586b-106">Each property set is identified with an FMTID, and a globally unique identifier (GUID) that enables applications, accessing the property set, to identify the property set.</span></span> <span data-ttu-id="d586b-107">С помощью этой идентификации приложение интерпретирует свойства, которые содержит набор.</span><span class="sxs-lookup"><span data-stu-id="d586b-107">Through this identification, the application interprets the properties that the set contains.</span></span>

<span data-ttu-id="d586b-108">Например, свойства форматирования символов в текстовом процессоре или атрибуты отрисовки элемента в программе рисования являются наборами свойств.</span><span class="sxs-lookup"><span data-stu-id="d586b-108">For example, the character-formatting properties in a word processor or the rendering attributes of an element in a drawing program are property sets.</span></span>

<span data-ttu-id="d586b-109">COM определяет интерфейс [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) для упрощения управления наборами свойств.</span><span class="sxs-lookup"><span data-stu-id="d586b-109">COM defines the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to facilitate management of property sets.</span></span> <span data-ttu-id="d586b-110">С помощью методов этого интерфейса можно создать новый набор свойств или открыть или удалить существующий набор свойств.</span><span class="sxs-lookup"><span data-stu-id="d586b-110">Through the methods of this interface, you can create a new property set, or open or delete an existing property set.</span></span> <span data-ttu-id="d586b-111">Кроме того, он предоставляет метод, который создает перечислитель и предоставляет указатель на его интерфейс [**иенумстатпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="d586b-111">In addition, it provides a method that creates an enumerator and supplies a pointer to its [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface.</span></span> <span data-ttu-id="d586b-112">Вы можете вызывать методы этого интерфейса для перечисления структур [**статпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) в объекте, которые будут предоставлять сведения обо всех наборах свойств объекта.</span><span class="sxs-lookup"><span data-stu-id="d586b-112">You can call the methods of this interface to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures on your object, which will provide information about all of the property sets on the object.</span></span>

<span data-ttu-id="d586b-113">При создании или открытии экземпляра [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)аналогичен открытию объекта, который поддерживает [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) или [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), поскольку необходимо указать режим хранения, в котором будет открыт интерфейс.</span><span class="sxs-lookup"><span data-stu-id="d586b-113">When you create or open an instance of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), it is similar to opening an object that supports [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), because you need to specify the storage mode in which you are opening the interface.</span></span> <span data-ttu-id="d586b-114">Для **IStorage** они включают режим транзакции, режим чтения/записи и режим общего доступа.</span><span class="sxs-lookup"><span data-stu-id="d586b-114">For **IStorage**, these include the transaction mode, the read/write mode, and the sharing mode.</span></span>

<span data-ttu-id="d586b-115">При создании набора свойств с вызовом метода [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)укажите, является ли свойство простым или непростым.</span><span class="sxs-lookup"><span data-stu-id="d586b-115">When you create a property set with a call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), specify whether the property set is to be simple or nonsimple.</span></span> <span data-ttu-id="d586b-116">Простой набор свойств содержит типы, которые могут быть полностью записаны в поток набора свойств, который должен быть ограничен размером, и не может превышать 256 КБ в Windows NT 4,0 и более ранних версиях или 1 МБ в Windows 2000, Windows XP и Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="d586b-116">A simple property set contains types that can be written fully within the property set stream, which is intended to be limited in size, and can be no larger than 256 KB in Windows NT 4.0 and earlier, or 1 MB in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="d586b-117">Тем не менее, если необходимо сохранить больший объем информации в наборе свойств, можно указать, что свойство является непростым.</span><span class="sxs-lookup"><span data-stu-id="d586b-117">However, when you need to store a larger amount of information in the property set, you can specify that the property set be nonsimple.</span></span> <span data-ttu-id="d586b-118">Это позволяет использовать один или несколько типов, указывающих только указатель на объект хранилища или поток.</span><span class="sxs-lookup"><span data-stu-id="d586b-118">This allows you to use one or more of the types that specify only a pointer to a storage or stream object.</span></span> <span data-ttu-id="d586b-119">Эти типы представляют собой \_ поток VT, \_ ПОТОКОВЫЕ объекты VT, \_ хранилище VT и \_ \_ объект VT.</span><span class="sxs-lookup"><span data-stu-id="d586b-119">These types are VT\_STREAM, VT\_STREAMED OBJECT, VT\_STORAGE and VT\_STORED\_OBJECT.</span></span>

<span data-ttu-id="d586b-120">Данные, хранящиеся в этих свойствах, не учитываются с ограничением размера набора свойств 256 KB в Windows NT 4,0 или более ранней версии или ограничения 1 МБ в Windows 2000, Windows XP и Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="d586b-120">Data stored in these properties is not counted against the 256 KB property-set size limit in Windows NT 4.0 or earlier, or the 1 MB limit in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="d586b-121">Однако данные о свойстве, такие как имя, применяются.</span><span class="sxs-lookup"><span data-stu-id="d586b-121">However, data about the property, such as its name, does apply.</span></span> <span data-ttu-id="d586b-122">Кроме того, если требуется обновление транзакций, набор свойств должен быть непростым.</span><span class="sxs-lookup"><span data-stu-id="d586b-122">Also, if you need a transacted update, the property set must be nonsimple.</span></span> <span data-ttu-id="d586b-123">Конечно, есть определенный выигрыш в производительности при открытии этих типов, так как он требует открытия потока или объекта хранилища, на который имеется указатель.</span><span class="sxs-lookup"><span data-stu-id="d586b-123">There is, of course, a certain performance penalty for opening these types, because it requires opening the stream or storage object to which you have the pointer.</span></span>

<span data-ttu-id="d586b-124">Если приложение использует составные файлы, можно использовать реализацию этих интерфейсов, предоставляемую моделью COM, которая реализуется в объекте хранилища составных файлов COM.</span><span class="sxs-lookup"><span data-stu-id="d586b-124">If your application uses compound files, you can use the COM-provided implementation of these interfaces, which are implemented on the COM compound file storage object.</span></span>

<span data-ttu-id="d586b-125">Каждый набор свойств состоит в основном из логически подключенной группы свойств, как описано в разделе [Управление свойствами](managing-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d586b-125">Each property set consists primarily of a logically connected group of properties, as described in [Managing Properties](managing-properties.md).</span></span>

<span data-ttu-id="d586b-126">Дополнительные сведения о наборах свойств в COM см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="d586b-126">For more information about property sets in COM, see:</span></span>

-   [<span data-ttu-id="d586b-127">Реализация наборов свойств в COM</span><span class="sxs-lookup"><span data-stu-id="d586b-127">Property Set Implementations in COM</span></span>](property-set-implementations-in-com.md)
-   [<span data-ttu-id="d586b-128">Рекомендации по установке свойств</span><span class="sxs-lookup"><span data-stu-id="d586b-128">Property Set Considerations</span></span>](property-set-considerations.md)
-   [<span data-ttu-id="d586b-129">Рекомендации по реализации IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="d586b-129">IPropertySetStorage Implementation Considerations</span></span>](ipropertysetstorage-implementation-considerations.md)
-   [<span data-ttu-id="d586b-130">Хранение наборов свойств</span><span class="sxs-lookup"><span data-stu-id="d586b-130">Storing Property Sets</span></span>](storing-property-sets.md)
-   [<span data-ttu-id="d586b-131">Характеристики производительности</span><span class="sxs-lookup"><span data-stu-id="d586b-131">Performance Characteristics</span></span>](performance-characteristics.md)
-   [<span data-ttu-id="d586b-132">Реализация набора свойств сводных данных</span><span class="sxs-lookup"><span data-stu-id="d586b-132">Implementing the Summary Information Property Set</span></span>](implementing-the-summary-information-property-set.md)

 

 