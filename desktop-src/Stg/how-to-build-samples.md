---
title: Создание образцов
description: Чтобы создать пример COM, необходимо настроить компьютерную среду для сборки приложений Microsoft Win32 C++.
ms.assetid: c62b8b4d-a9d2-4587-8bb6-7b2c30d1c00d
keywords:
- Создание образцов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 593d3465d3ebcc32a6768dd8b2dffe1f0a653d07
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2020
ms.locfileid: "105661683"
---
# <a name="how-to-build-samples"></a><span data-ttu-id="6f0c2-104">Создание образцов</span><span class="sxs-lookup"><span data-stu-id="6f0c2-104">How to Build Samples</span></span>

<span data-ttu-id="6f0c2-105">Чтобы создать пример COM, необходимо настроить компьютерную среду для сборки приложений Microsoft Win32 C++.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-105">To build a COM sample, the computer environment must be set up to build Microsoft Win32 C++ applications.</span></span>

## <a name="preparing-a-computer-to-create-com-samples"></a><span data-ttu-id="6f0c2-106">Подготовка компьютера к созданию примеров COM</span><span class="sxs-lookup"><span data-stu-id="6f0c2-106">Preparing a Computer to Create COM Samples</span></span>

<span data-ttu-id="6f0c2-107">Компьютерная среда должна быть настроена с помощью правильно установленного 32-разрядного компилятора C++, компоновщика и компилятора ресурсов, совместимых с Microsoft Visual C++ 4. x или более поздней версии и правильно установленной Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-107">The computer environment must be set up with a properly installed 32-bit C++ compiler, linker, and resource compiler that are compatible with Microsoft Visual C++ 4.x or later, and a properly installed Windows SDK.</span></span> <span data-ttu-id="6f0c2-108">Лучше установить Windows SDK последним.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-108">It is best to install the Windows SDK last.</span></span> <span data-ttu-id="6f0c2-109">Windows SDK предоставляет файлы библиотеки include и lib, необходимые для функциональности COM, закодированной в примерах.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-109">The Windows SDK provides .h include and .lib library files required for the COM functionality coded in the samples.</span></span>

<span data-ttu-id="6f0c2-110">Для успешного выполнения примеров Ремклиен, Фресерве и Фреклиен требуются системные средства, доступные в операционных системах Windows: Windows Server 2003, Windows XP, Windows 2000 или Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-110">To successfully run the Remclien, Freserve, and Freclien samples requires system facilities that are available in the Windows operating systems: Windows Server 2003, Windows XP, Windows 2000, or Windows NT 4.0.</span></span> <span data-ttu-id="6f0c2-111">Примеры Ремклиен, Фресерве и Фреклиен будут создаваться, но не будут работать в операционных системах Windows Me, Windows 98 или Windows 95, если только не распределенный COM (DCOM) и COM-объект, свободный поток, являются частью операционной системы.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-111">The Remclien, Freserve, and Freclien samples will build but will not run on the Windows Me, Windows 98, or Windows 95 operating systems unless Distributed COM (DCOM) and free threaded COM are part of the operating system.</span></span> <span data-ttu-id="6f0c2-112">Эта поддержка доступна для операционных систем Windows Me, Windows 98 и Windows 95 в DCOM95 Add on.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-112">This support is available for the Windows Me, Windows 98, and Windows 95 operating systems in the DCOM95 add on.</span></span> <span data-ttu-id="6f0c2-113">В настоящее время DCOM95 можно получить с помощью [скачивания из корпорации Майкрософт](https://www.microsoft.com/download/details.aspx?id=31661).</span><span class="sxs-lookup"><span data-stu-id="6f0c2-113">DCOM95 can currently be obtained by [download from Microsoft](https://www.microsoft.com/download/details.aspx?id=31661).</span></span>

<span data-ttu-id="6f0c2-114">Каждый каталог примеров содержит необходимые исходные файлы для сборки и запуска примера.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-114">Each sample directory has the necessary source files to build and run the sample.</span></span> <span data-ttu-id="6f0c2-115">Родительский каталог примеров содержит файл Makeall.bat, который можно запустить из командной строки, чтобы сделать все примеры кода в ветви ниже.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-115">The parent sample directory has a Makeall.bat file, which you can run from the command prompt to make all the code samples in the branch below.</span></span> <span data-ttu-id="6f0c2-116">Дополнительные сведения см. в файле Makeall.bat.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-116">For more information, see the Makeall.bat file.</span></span> <span data-ttu-id="6f0c2-117">Если среда настроена на сборку приложений Win32 C++, можно просто запустить Makeall.bat из каталога, в котором он находится, чтобы создать все примеры кода в ветви ниже.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-117">If your environment is set up to build Win32 C++ applications, you can simply run Makeall.bat from the directory where it resides to build all the code samples in the branch below.</span></span> <span data-ttu-id="6f0c2-118">Макеалл обеспечивает правильный порядок сборки, чтобы удовлетворялись все зависимости примера кода.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-118">Makeall ensures the correct order to the build so that all the code sample dependencies are satisfied.</span></span>

<span data-ttu-id="6f0c2-119">В главном каталоге также имеется файл makefile, который строит все примеры кода учебника с использованием параметров, аналогичных параметрам, поддерживаемым Makeall.bat.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-119">The main directory also has a makefile that builds all the tutorial code samples using options similar to those supported by Makeall.bat.</span></span> <span data-ttu-id="6f0c2-120">Дополнительные сведения см. в этом файле Makefile.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-120">For more information, see this makefile.</span></span> <span data-ttu-id="6f0c2-121">В этом файле Makefile предполагается, что в составе Windows SDK установлена вся ветвь Code Samples.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-121">This makefile assumes that the entire code samples branch is installed as part of the Windows SDK.</span></span> <span data-ttu-id="6f0c2-122">В настоящее время это расположение имеет путь, аналогичный *d: \\ мссдк \\ Samples \\ COM \\ тутсамп*, где D: представляет установочный диск.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-122">Currently this location has a path similar to *D:\\MSSDK\\SAMPLES\\COM\\TUTSAMP*, where D: represents the installation drive.</span></span> <span data-ttu-id="6f0c2-123">Если вы извлекли ветвь образца кода учебника (например, COM-приложение и его подкаталоги) в другое расположение за пределами Windows SDK (или если вы получили пример набора как отдельную загрузку с веб-сайта Майкрософт), используйте Makeall.bat для компиляции всех примеров в ветви.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-123">If you have extracted the tutorial code sample branch (for example, the COM directory COM and its subdirectories) to another location outside the Windows SDK (or if you obtained the sample set as a separate download from the Microsoft website), then use Makeall.bat to compile all the samples in the branch.</span></span> <span data-ttu-id="6f0c2-124">В общем случае рекомендуется Makeall.bat.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-124">In general, Makeall.bat is recommended.</span></span> <span data-ttu-id="6f0c2-125">Также предоставляется файл Logmall.bat.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-125">A Logmall.bat file is also provided.</span></span> <span data-ttu-id="6f0c2-126">Он выполняется так же, как и пакетный файл Макеалл, за исключением того, что он записывает все выходные данные компиляции в файловые Errorlog.txt в главном каталоге Tutorial.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-126">It does the same as Makeall batch file except that it logs all compilation output to file Errorlog.txt in the main tutorial directory.</span></span>

<span data-ttu-id="6f0c2-127">Два пакетных файла, Regall.bat и Unregall.bat, также предоставляются в основном каталоге для регистрации и отмены регистрации всех серверов COM в серии образцов кода руководства.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-127">Two batch files, Regall.bat and Unregall.bat, are also provided in the main directory to register and unregister all COM servers in the tutorial code sample series.</span></span> <span data-ttu-id="6f0c2-128">Чтобы зарегистрировать все серверы, запустите файл Regall.bat из основного каталога.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-128">To register all servers, run Regall.bat file from the main directory.</span></span> <span data-ttu-id="6f0c2-129">Чтобы отменить регистрацию всех серверов, выполните Unregall.bat таким же образом.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-129">To unregister all servers, run Unregall.bat in the same manner.</span></span> <span data-ttu-id="6f0c2-130">Для этих пакетных файлов требуется предварительная сборка с примерами кода для регистрации, МАРШАЛИРОВАНИЯ, ДЛЛСЕРВЕ, ЛИКСЕРВЕ, ЛОКСЕРВЕ, АПТСЕРВЕ, ФРЕСЕРВЕ и сохранения.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-130">These batch files require a prior build of the REGISTER, MARSHAL, DLLSERVE, LICSERVE, LOCSERVE, APTSERVE, FRESERVE, and CONSERVE code samples.</span></span> <span data-ttu-id="6f0c2-131">Если выполняется обычная сборка образцов кода, файлы Makefile сервера будут автоматически регистрировать серверы.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-131">If you perform a normal build of the code samples, the server makefiles will automatically register the servers.</span></span> <span data-ttu-id="6f0c2-132">В этом случае нет необходимости запускать пакетный файл Регалл.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-132">In this case, it is not necessary to run the Regall batch file.</span></span>

<span data-ttu-id="6f0c2-133">Запустите пакетный файл Cleanall.bat, чтобы выполнить исчерпывающие Клеаналл из всех примеров учебника по COM.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-133">Run the Cleanall.bat batch file to perform an exhaustive Cleanall of all the COM Tutorial Samples.</span></span>

> [!WARNING]
> <span data-ttu-id="6f0c2-134">Этот пакетный файл удаляет все файлы проектов Visual Studio и другие временные рабочие файлы, созданные Visual C++ в примерах.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-134">This batch file deletes all Visual Studio project files and other temporary work files created by Visual C++ in the samples.</span></span> <span data-ttu-id="6f0c2-135">Все COM-серверы, встроенные в учебные примеры кода, отменяются из реестра.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-135">All of the COM servers built in the tutorial code samples are unregistered from the registry.</span></span> <span data-ttu-id="6f0c2-136">Все исполняемые exe-и DLL-файлы удаляются.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-136">All executable exe and .dll files are deleted.</span></span> <span data-ttu-id="6f0c2-137">Удаляются все файлы отладочных символов.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-137">All debug symbol files are deleted.</span></span> <span data-ttu-id="6f0c2-138">Файлы, созданные в различных средах сборки, также удаляются.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-138">Files generated in a variety of build environments are also deleted.</span></span>

 

<span data-ttu-id="6f0c2-139">Выполните команду "Макеалл Clean", чтобы ускорить выполнение, но более небольшое удаление всех примеров кода.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-139">Run 'Makeall Clean' to perform a faster, but more modest, cleanup of all the code samples.</span></span> <span data-ttu-id="6f0c2-140">Эта операция очистки не попытается быть такой же полной, как в Cleanall.bat.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-140">This cleaning operation does not attempt to be as comprehensive as that performed by Cleanall.bat.</span></span> <span data-ttu-id="6f0c2-141">OBJ-файлы удаляются, но выходные двоичные данные сохраняются.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-141">The .obj files are deleted, but the output binaries are retained.</span></span> <span data-ttu-id="6f0c2-142">Регистрация серверов COM в реестре не выполняется.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-142">The COM servers are not unregistered from the registry.</span></span>

<span data-ttu-id="6f0c2-143">Этот пример серии создан как неотъемлемая часть Windows SDK, поэтому в этом руководстве предполагается, что среда с Windows SDK правильно установлена.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-143">This sample series originated as an integral part of the Windows SDK, therefore the tutorial narrative assumes an environment with the Windows SDK properly installed.</span></span>

<span data-ttu-id="6f0c2-144">Однако выпуски Microsoft Visual C++ версии 4,0 и более поздних версий также могут предоставлять файлы библиотеки include и lib, необходимые для компиляции.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-144">However, releases of Microsoft Visual C++ version 4.0 and later may also provide the .h include and .lib library files required for compilation.</span></span> <span data-ttu-id="6f0c2-145">В таких случаях установка Windows SDK может не потребоваться для компиляции образцов.</span><span class="sxs-lookup"><span data-stu-id="6f0c2-145">In such cases, installation of the Windows SDK may not be required to compile the samples.</span></span>

<span data-ttu-id="6f0c2-146">Дополнительные сведения и полный пример сведений о сборке см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="6f0c2-146">For more information and complete sample build details, see:</span></span>

[<span data-ttu-id="6f0c2-147">Настройка среды</span><span class="sxs-lookup"><span data-stu-id="6f0c2-147">Environment Setup</span></span>](environment-setup.md)

[<span data-ttu-id="6f0c2-148">Файлы Makefile</span><span class="sxs-lookup"><span data-stu-id="6f0c2-148">Makefiles</span></span>](makefiles.md)

[<span data-ttu-id="6f0c2-149">Использование Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6f0c2-149">Using Visual Studio</span></span>](using-visual-studio.md)

[<span data-ttu-id="6f0c2-150">Извлечение примеров кода</span><span class="sxs-lookup"><span data-stu-id="6f0c2-150">Extracting the Code Samples</span></span>](extracting-the-code-samples.md)

[<span data-ttu-id="6f0c2-151">Соглашения о стиле написания кода</span><span class="sxs-lookup"><span data-stu-id="6f0c2-151">Coding Style Conventions</span></span>](coding-style-conventions.md)

 

 




