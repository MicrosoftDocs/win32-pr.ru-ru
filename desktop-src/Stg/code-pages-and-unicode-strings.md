---
title: Кодовые страницы и строки в Юникоде
description: Еще один вопрос при реализации IPropertySetStorage заключается в том, как имена свойств в Юникоде хранятся в свойстве с ИДЕНТИФИКАТОРом 0 (словарь имен свойств), в котором не используются строки в Юникоде.
ms.assetid: 830c90c9-d2a5-4ecf-8cb6-9950ed5320bf
keywords:
- Кодовые страницы и строки в Юникоде
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 508d508ec21e7e763a683e534cf485ebbeec018d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104328720"
---
# <a name="code-pages-and-unicode-strings"></a><span data-ttu-id="f1b4a-104">Кодовые страницы и строки в Юникоде</span><span class="sxs-lookup"><span data-stu-id="f1b4a-104">Code Pages and Unicode Strings</span></span>

<span data-ttu-id="f1b4a-105">Еще один вопрос при реализации [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) заключается в том, как имена свойств в Юникоде хранятся в свойстве с идентификатором 0 (словарь имен свойств), в котором не используются строки в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-105">Another consideration in implementing [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is how Unicode property names are stored in the property ID 0 (the property name dictionary), which does not use Unicode strings.</span></span>

<span data-ttu-id="f1b4a-106">В Юникоде официально указано значение кодовой страницы 1200.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-106">Unicode officially has a code page value of 1200.</span></span> <span data-ttu-id="f1b4a-107">Чтобы сохранить значения Юникода в словаре имен свойств, используйте значение кодовой страницы 1200 для всего набора свойств (в свойстве с ИДЕНТИФИКАТОРом 1), которое указывается отсутствием флага **\_ ANSI Пропсетфлаг** в [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="f1b4a-107">To store Unicode values in the property name dictionary, use a code page value of 1200 for the whole property set (in property ID 1), specified by the absence of the **PROPSETFLAG\_ANSI** flag in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="f1b4a-108">Учтите, что это побочный результат хранения всех строковых значений в свойстве, заданном в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-108">Be aware that this has the side effect of storing all string values in the property set in Unicode.</span></span> <span data-ttu-id="f1b4a-109">Во всех кодовых страницах число, найденное в начале **VT \_ LPSTR** , является числом байтов, а не числом символов.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-109">In all code pages, the count found at the start of a **VT\_LPSTR** is a byte count, not a character count.</span></span> <span data-ttu-id="f1b4a-110">Это необходимо для обеспечения совместимости с клиентами более ранних версий.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-110">This is necessary to provide for compatibility with earlier-version clients.</span></span>

<span data-ttu-id="f1b4a-111">Реализация составного файла [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) создает все новые наборы свойств полностью либо в Юникоде (кодовую страницу 1200), либо в текущей системной кодовой странице ANSI.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-111">The compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) creates all new property sets completely either in Unicode (code page 1200) or in the current system ANSI code page.</span></span> <span data-ttu-id="f1b4a-112">Это управляется отсутствием или присутствием флага **\_ ANSI пропсетфлаг** в параметре *грффлагс* объекта [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="f1b4a-112">This is controlled by the absence or presence of the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span>

<span data-ttu-id="f1b4a-113">Создание и открытие наборов свойств в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-113">Create and open property sets as Unicode.</span></span> <span data-ttu-id="f1b4a-114">Для реализации этого не устанавливайте флаг **\_ ANSI пропсетфлаг** в параметре *грффлагс* объекта [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="f1b4a-114">To implement this, do not set the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="f1b4a-115">Избегайте использования значений **VT \_ LPSTR** и вместо этого используйте значения **VT \_ LPWSTR** .</span><span class="sxs-lookup"><span data-stu-id="f1b4a-115">Avoid using **VT\_LPSTR** values, and instead use **VT\_LPWSTR** values.</span></span> <span data-ttu-id="f1b4a-116">Если кодовая страница набора свойств — Unicode, строковые значения **VT \_ LPSTR** преобразуются в Юникод при сохранении и возвращаются в многобайтовые строковые значения при извлечении.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-116">When the code page of the property set is Unicode, **VT\_LPSTR** string values are converted to Unicode when stored, and back to multibyte string values when retrieved.</span></span>

<span data-ttu-id="f1b4a-117">Установка флага **\_ ANSI пропсетфлаг** , сообщаемого с помощью вызова [**ипропертистораже:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) , отражает, является ли базовая кодовая страница или не Unicode.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-117">Setting the **PROPSETFLAG\_ANSI** flag as reported through a call to [**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) reflects whether the underlying code page is or is not Unicode.</span></span> <span data-ttu-id="f1b4a-118">Обратите внимание, что свойство с ИДЕНТИФИКАТОРом 1 может быть явно Прочитано для изучения кодовой страницы.</span><span class="sxs-lookup"><span data-stu-id="f1b4a-118">Be aware that Property ID 1 can be explicitly read to learn the code page.</span></span>

<span data-ttu-id="f1b4a-119">Доступ к свойству с ИДЕНТИФИКАТОРом 1 можно получить через вызов [**ипропертистораже:: реадмултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span><span class="sxs-lookup"><span data-stu-id="f1b4a-119">You can access Property ID 1 through a call to [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span></span> <span data-ttu-id="f1b4a-120">Однако он доступен только для чтения и не может быть обновлен с помощью [**вритемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span><span class="sxs-lookup"><span data-stu-id="f1b4a-120">However, it is read-only, and may not be updated with [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="f1b4a-121">Кроме того, он не может быть удален с помощью [**делетемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span><span class="sxs-lookup"><span data-stu-id="f1b4a-121">Furthermore, it may not be deleted with [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span></span>

 

 




