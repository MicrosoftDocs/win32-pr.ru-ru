---
title: COM-объекты и структурированное хранилище
description: Одним из наиболее распространенных текущих применений постоянных свойств является использование их для хранения данных о системном объекте, таком как документ, с этим объектом.
ms.assetid: 95136e9a-4c80-4704-ae65-9759487cf8f8
keywords:
- COM-объекты и структурированное хранилище
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 472a3d2fb9c145538bbd6b5e87dfcc9523feff78
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104410682"
---
# <a name="com-objects-and-structured-storage"></a><span data-ttu-id="a422e-104">COM-объекты и структурированное хранилище</span><span class="sxs-lookup"><span data-stu-id="a422e-104">COM Objects and Structured Storage</span></span>

<span data-ttu-id="a422e-105">Одним из наиболее распространенных текущих применений постоянных свойств является использование их для хранения данных о системном объекте, таком как документ, с этим объектом.</span><span class="sxs-lookup"><span data-stu-id="a422e-105">One of the most common current uses of persistent properties is to use them to store data about a system object, such as a document, with that object.</span></span> <span data-ttu-id="a422e-106">Конечно, существует вероятность сохранения свойств с любым объектом, таким как принтер, поэтому необходимо только просмотреть его свойства, чтобы определить его расположение, тип и т. д.</span><span class="sxs-lookup"><span data-stu-id="a422e-106">There is, of course, the potential of storing properties with any object, such as a printer, so it would only be necessary to look at its properties to determine its location, its type, and so on.</span></span> <span data-ttu-id="a422e-107">Объект пользователя может иметь набор свойств, включающий такие данные, как имя, фамилия, офис и телефон.</span><span class="sxs-lookup"><span data-stu-id="a422e-107">A user object could have a property set that includes data such as First Name, Last Name, Office, and Phone.</span></span> <span data-ttu-id="a422e-108">Приложения могут быть написаны для запроса набора объектов на уровне системы на основе их свойств, например для отображения всех принтеров, расположенных в определенном здании.</span><span class="sxs-lookup"><span data-stu-id="a422e-108">Applications can be written to query a system-wide set of objects based on their properties, for example, displaying all printers located in a certain building.</span></span> <span data-ttu-id="a422e-109">Однако в текущих системах наиболее часто используются свойства документов.</span><span class="sxs-lookup"><span data-stu-id="a422e-109">Current systems, however, most frequently use properties on documents.</span></span>

<span data-ttu-id="a422e-110">Стандартным набором свойств, определяемым моделью COM, является [набор свойств сводных данных](the-summary-information-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="a422e-110">The primary property set standard defined by COM is [The Summary Information Property Set](the-summary-information-property-set.md).</span></span> <span data-ttu-id="a422e-111">Этот набор свойств является простым и часто используемым.</span><span class="sxs-lookup"><span data-stu-id="a422e-111">This property set is both simple and commonly used.</span></span> <span data-ttu-id="a422e-112">Большинство документов, создаваемых приложениями, имеют общий набор атрибутов, полезных для пользователей этих документов.</span><span class="sxs-lookup"><span data-stu-id="a422e-112">Most documents created by applications have a common set of attributes useful to users of those documents.</span></span> <span data-ttu-id="a422e-113">Эти атрибуты включают имя автора документа, тему документа, время его создания и т. д.</span><span class="sxs-lookup"><span data-stu-id="a422e-113">These attributes include the name of the document author, the subject of the document, when it was created, and so on.</span></span> <span data-ttu-id="a422e-114">Для Microsoft Office 95, Office 97 и более поздних версий определены два других набора свойств.</span><span class="sxs-lookup"><span data-stu-id="a422e-114">Two other property sets are defined for Microsoft Office 95, Office 97 and later.</span></span> <span data-ttu-id="a422e-115">Это набор свойств «сводка документа COM», а свойство «свойства User-Defined» установлено.</span><span class="sxs-lookup"><span data-stu-id="a422e-115">These are the COM Document Summary property set and the User-Defined Properties property set.</span></span> <span data-ttu-id="a422e-116">Дополнительные сведения см. в разделе [структурированное хранилище. формат набора свойств сериализованный](structured-storage-serialized-property-set-format.md).</span><span class="sxs-lookup"><span data-stu-id="a422e-116">For more information, see [Structured Storage Serialized Property Set Format](structured-storage-serialized-property-set-format.md).</span></span>

<span data-ttu-id="a422e-117">В Windows 3,1 Каждое приложение имеет другой способ хранения этих данных в своих документах.</span><span class="sxs-lookup"><span data-stu-id="a422e-117">In Windows 3.1, each application had a different way of storing this data within its documents.</span></span> <span data-ttu-id="a422e-118">Чтобы просмотреть сводные данные по данному документу, пользователю нужно было запустить приложение, создавшее документ, открыть его и вызвать диалоговое окно Сводные данные приложения, чтобы отображались сведения только о приложении.</span><span class="sxs-lookup"><span data-stu-id="a422e-118">To examine the summary information for a given document, the user had to run the application that created the document, open it, and invoke the application Summary Information dialog box, so only the application could display its summary information.</span></span>

<span data-ttu-id="a422e-119">Наборы свойств COM и интерфейсы набора свойств позволяют просматривать свойства документа без запуска создания приложения.</span><span class="sxs-lookup"><span data-stu-id="a422e-119">COM property sets and the property set interfaces make it possible to see the document properties without running the creating application.</span></span> <span data-ttu-id="a422e-120">Например, все версии Microsoft Word 6,0 и более поздних версий и многие другие приложения с поддержкой COM теперь сохраняют свои документы с помощью структурированного хранилища COM и стандартного набора свойств, описанного здесь.</span><span class="sxs-lookup"><span data-stu-id="a422e-120">For example, all versions of Microsoft Word 6.0 or later, and many other COM-enabled applications now save their documents using COM structured storage and the property set standard described here.</span></span> <span data-ttu-id="a422e-121">Таким образом, другие приложения Office Suite могут отображать [набор свойств сводных данных](the-summary-information-property-set.md) для такого файла, если этот файл является структурированным ФАЙЛОМ хранилища com, а создание приложения сохранило информацию в формате набора свойств COM.</span><span class="sxs-lookup"><span data-stu-id="a422e-121">Thus, other Office Suite applications are able to display [The Summary Information Property Set](the-summary-information-property-set.md) for such a file, as long as that file is a COM structured storage file, and the creating application saved the information in the COM Property Set format.</span></span> <span data-ttu-id="a422e-122">Например, оболочка Windows 95 или Windows 98 использует это значение и позволяет конечному пользователю просматривать свойства любого документа Word 6,0 или более поздней версии непосредственно из оболочки.</span><span class="sxs-lookup"><span data-stu-id="a422e-122">The Windows 95 or Windows 98 shell, for example, uses this, and allows the end user to view the properties of any Word 6.0 or later document directly from the shell.</span></span>

<span data-ttu-id="a422e-123">Чтобы использовать наборы свойств из других приложений, другие приложения должны распознать, как интерпретировать свойства в наборе свойств, что подразумевает стандарт.</span><span class="sxs-lookup"><span data-stu-id="a422e-123">To use property sets from other applications, the other applications must recognize how to interpret the properties within a property set, which implies a standard.</span></span> <span data-ttu-id="a422e-124">COM построил этот подход путем определения одного набора стандартных свойств, набора свойств сводной информации COM.</span><span class="sxs-lookup"><span data-stu-id="a422e-124">COM has pioneered this approach by defining one standard property set, the COM Summary Information Property Set.</span></span> <span data-ttu-id="a422e-125">Любое приложение, имеющее определение этого набора свойств, может легко получить доступ к сводным сведениям, содержащимся в любом документе, созданном приложением COM, которое использует спецификацию набора свойств.</span><span class="sxs-lookup"><span data-stu-id="a422e-125">Any application that has the definition of this property set can easily access the summary information contained in any document created by an COM application that uses that property set specification.</span></span>

 

 




