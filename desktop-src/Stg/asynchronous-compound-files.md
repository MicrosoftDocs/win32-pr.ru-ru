---
title: Асинхронные составные файлы
description: Асинхронные составные файлы, предоставляемые системой асинхронного хранилища, обеспечивают эффективную загрузку составных файлов из Интернета в целом и в частности, в Интернете.
ms.assetid: 6cad074e-07a8-434f-a402-e29cb66a1a18
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04de2162b50283b12bc8deed6ec908d92e7584d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413439"
---
# <a name="asynchronous-compound-files"></a><span data-ttu-id="3de13-103">Асинхронные составные файлы</span><span class="sxs-lookup"><span data-stu-id="3de13-103">Asynchronous Compound Files</span></span>

<span data-ttu-id="3de13-104">Асинхронные составные файлы, предоставляемые системой асинхронного хранилища, обеспечивают эффективную загрузку составных файлов из Интернета в целом и в частности, в Интернете.</span><span class="sxs-lookup"><span data-stu-id="3de13-104">Asynchronous Compound Files, the system-provided implementation of asynchronous storage, enables the efficient downloading of compound files from the Internet in general and the Web in particular.</span></span> <span data-ttu-id="3de13-105">Базовая архитектура асинхронных составных файлов показана на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="3de13-105">The basic architecture of Asynchronous Compound Files is shown in the following diagram.</span></span>

![Базовая архитектура асинхронных составных файлов](images/asy-stor.png)

<span data-ttu-id="3de13-107">Реализация асинхронных составных файлов может работать с новыми асинхронными типами моникера, которые понимают протоколы Интернета и могут быть привязаны к объекту, определяемому URL-адресом.</span><span class="sxs-lookup"><span data-stu-id="3de13-107">The Asynchronous Compound Files implementation can work with new asynchronous moniker types that understand Internet protocols and can bind to an object identified by a URL.</span></span> <span data-ttu-id="3de13-108">Такое специальное имя возвращает асинхронный указатель [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) или [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) из вызова клиента в [**IMoniker:: биндтостораже**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span><span class="sxs-lookup"><span data-stu-id="3de13-108">Such a moniker would return an asynchronous [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) or [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) pointer from the client's call to [**IMoniker::BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span></span>

<span data-ttu-id="3de13-109">Составные файлы в целом реализуются на основе объекта массива байтов — абстракции файла, представляющего данные объекта в виде массива плоских байтов.</span><span class="sxs-lookup"><span data-stu-id="3de13-109">Compound Files in general are implemented on top of a byte array object, an abstraction of a file that represents an object's data as a flat byte array.</span></span> <span data-ttu-id="3de13-110">Объект массива байтов предоставляет свои функциональные возможности через интерфейс [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) .</span><span class="sxs-lookup"><span data-stu-id="3de13-110">The byte array object exposes its functionality through the [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) interface.</span></span> <span data-ttu-id="3de13-111">Если массив байтов поддерживает неблокируемое асинхронное хранилище, он возвращает E в \_ ожидании реализации составного файла, который, в свою очередь, передает ошибку обратно вызывающему объекту.</span><span class="sxs-lookup"><span data-stu-id="3de13-111">If a byte array supports nonblocking asynchronous storage, it returns E\_PENDING to the compound-file implementation, which in turn propagates the error back to the caller.</span></span>

<span data-ttu-id="3de13-112">Чтобы контролировать данные, доступные во время загрузки, массив байтов, поддерживающий асинхронное хранилище, предоставляет интерфейс [**ифилллоккбитес**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) для объекта-оболочки, предоставляемого системой специально для этой цели.</span><span class="sxs-lookup"><span data-stu-id="3de13-112">To keep track of the data available during a download, a byte array that supports asynchronous storage exposes the [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) interface on a wrapper object provided by the system specifically for this purpose.</span></span> <span data-ttu-id="3de13-113">Код загрузки, предоставленный асинхронным моникером, вызывает этот интерфейс для асинхронного заполнения массива байтов по мере доступности данных.</span><span class="sxs-lookup"><span data-stu-id="3de13-113">The downloading code provided by an asynchronous moniker calls this interface to fill the byte array asynchronously, as data is available.</span></span> <span data-ttu-id="3de13-114">Объект-оболочка также предоставляет интерфейс **ILockBytes** , который используется реализацией асинхронных составных файлов для чтения и записи данных из массива и в него.</span><span class="sxs-lookup"><span data-stu-id="3de13-114">The wrapper object also exposes an **ILockBytes** interface, which the Asynchronous Compound Files implementation uses to read and write data from and to the array.</span></span>

<span data-ttu-id="3de13-115">Объекты асинхронного хранения и потока предоставляют точку подключения для интерфейса [**ипрогресснотифи**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) , который реализуется кодом скачивания асинхронного моникера.</span><span class="sxs-lookup"><span data-stu-id="3de13-115">Asynchronous storage and stream objects provide a connection point for the [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) interface, which is implemented by the asynchronous moniker's downloading code.</span></span> <span data-ttu-id="3de13-116">Реализация асинхронных составных файлов вызывает **ипрогресснотифи** , чтобы предоставить загрузчику сведения о состоянии операции загрузки.</span><span class="sxs-lookup"><span data-stu-id="3de13-116">The Asynchronous Compound Files implementation calls **IProgressNotify** to provide the downloader with information about the status of the downloading operation.</span></span>

 

 