---
title: Создание и запуск примера Стоклиен
description: Стоклиен работает совместно со современным объектом на COM-сервере для обеспечения постоянного хранения чертежей в составных файлах COM.
ms.assetid: bf622104-10dd-4649-88f0-e2bfb15289b1
keywords:
- Создание и запуск примера Стоклиен
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f00274293c05e21e660dc8e9448ca95946cab8a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105661540"
---
# <a name="create-and-run-stoclien-sample"></a><span data-ttu-id="66174-104">Создание и запуск примера Стоклиен</span><span class="sxs-lookup"><span data-stu-id="66174-104">Create and Run StoClien Sample</span></span>

<span data-ttu-id="66174-105">**Стоклиен** работает совместно со современным объектом на com-сервере для обеспечения постоянного хранения чертежей в составных файлах com.</span><span class="sxs-lookup"><span data-stu-id="66174-105">**StoClien** works in cooperation with a COPaper object in a COM server to achieve persistent storage of drawings in COM compound files.</span></span> <span data-ttu-id="66174-106">Дополнительные сведения об использовании потоков в составном файле, предоставляемом для **Состоклиени**, см. в разделе [**стосерве**](structured-storage-server-sample--stoserve-.md) Sample and STOSERVE.HTM.</span><span class="sxs-lookup"><span data-stu-id="66174-106">For more information about COPaper's use of streams in the compound file provided to COPaper by **StoClien**, see [**StoServe**](structured-storage-server-sample--stoserve-.md) sample and STOSERVE.HTM.</span></span> <span data-ttu-id="66174-107">Конструкция собумаги и ее интерфейс Ипапер также рассматриваются в примере **стосерве** .</span><span class="sxs-lookup"><span data-stu-id="66174-107">COPaper's construction and its IPaper interface are also covered in the **StoServe** sample.</span></span>

## <a name="code-tour"></a><span data-ttu-id="66174-108">Обзор кода</span><span class="sxs-lookup"><span data-stu-id="66174-108">Code Tour</span></span>

<span data-ttu-id="66174-109">В этом обзоре кода рассматриваются следующие основные темы:</span><span class="sxs-lookup"><span data-stu-id="66174-109">The major topics covered in this code tour are:</span></span>

-   <span data-ttu-id="66174-110">Как **кгуипапер** инкапсулирует поведение графического интерфейса пользователя в электронном документе **стоклиен**</span><span class="sxs-lookup"><span data-stu-id="66174-110">How **CGuiPaper** encapsulates the GUI behavior of **StoClien**'s electronic drawing paper</span></span>
-   <span data-ttu-id="66174-111">Как **стоклиен** фиксирует и отображает интерактивное действие рисования</span><span class="sxs-lookup"><span data-stu-id="66174-111">How **StoClien** captures and displays interactive drawing activity</span></span>
-   <span data-ttu-id="66174-112">Как объект **кгуипапер** использует собумагу для записи данных о рисовании</span><span class="sxs-lookup"><span data-stu-id="66174-112">How the **CGuiPaper** object uses COPaper to record drawing data</span></span>
-   <span data-ttu-id="66174-113">Использование подключения Ипаперсинк в перерисовки</span><span class="sxs-lookup"><span data-stu-id="66174-113">How an IPaperSink connection is used in repainting</span></span>
-   <span data-ttu-id="66174-114">Как методы Кпапфиле **Load** и **Save** используют структурированное хранилище в составных файлах</span><span class="sxs-lookup"><span data-stu-id="66174-114">How the CPapFile **Load** and **Save** methods use the structured storage in compound files</span></span>

<span data-ttu-id="66174-115">Так как класс **кгуибалл** , используемый в примерах ФРЕКЛИЕН и конклиен, инкапсулирует поведение Bounce-шарика, **Стоклиен** использует класс **кгуипапер** C++ для инкапсуляции данных и графического пользовательского интерфейса электронного документа.</span><span class="sxs-lookup"><span data-stu-id="66174-115">As the **CGuiBall** class used in the FRECLIEN and CONCLIEN samples encapsulated the behavior of a bouncing ball, **StoClien** uses a **CGuiPaper** C++ class to encapsulate the data and GUI behavior of electronic drawing paper.</span></span>

<span data-ttu-id="66174-116">В следующей таблице перечислены файлы, относящиеся к примеру **стоклиен** .</span><span class="sxs-lookup"><span data-stu-id="66174-116">The following table lists the files pertinent to the **StoClien** sample.</span></span>



| <span data-ttu-id="66174-117">Файлы</span><span class="sxs-lookup"><span data-stu-id="66174-117">Files</span></span>        | <span data-ttu-id="66174-118">Описание</span><span class="sxs-lookup"><span data-stu-id="66174-118">Description</span></span>                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="66174-119">STOCLIEN.TXT</span><span class="sxs-lookup"><span data-stu-id="66174-119">STOCLIEN.TXT</span></span> | <span data-ttu-id="66174-120">Краткое описание образца.</span><span class="sxs-lookup"><span data-stu-id="66174-120">Short sample description.</span></span>                                                                                                        |
| <span data-ttu-id="66174-121">ФАЙЛЫ</span><span class="sxs-lookup"><span data-stu-id="66174-121">MAKEFILE</span></span>     | <span data-ttu-id="66174-122">Универсальный файл makefile для создания примера кода.</span><span class="sxs-lookup"><span data-stu-id="66174-122">The generic makefile for building the code sample.</span></span>                                                                               |
| <span data-ttu-id="66174-123">СТОКЛИЕН. Высоты</span><span class="sxs-lookup"><span data-stu-id="66174-123">STOCLIEN.H</span></span>   | <span data-ttu-id="66174-124">Включаемый файл для приложения **стоклиен** .</span><span class="sxs-lookup"><span data-stu-id="66174-124">The include file for the **StoClien** application.</span></span> <span data-ttu-id="66174-125">Содержит объявления классов, прототипы функций и идентификаторы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="66174-125">Contains class declarations, function prototypes, and resource identifiers.</span></span>   |
| <span data-ttu-id="66174-126">СТОКЛИЕН. CPP</span><span class="sxs-lookup"><span data-stu-id="66174-126">STOCLIEN.CPP</span></span> | <span data-ttu-id="66174-127">Основной файл реализации для STOCLIEN.EXE.</span><span class="sxs-lookup"><span data-stu-id="66174-127">The main implementation file for STOCLIEN.EXE.</span></span> <span data-ttu-id="66174-128">Содержит реализацию WinMain и Кмаинвиндов, а также установку главного меню.</span><span class="sxs-lookup"><span data-stu-id="66174-128">Has WinMain and CMainWindow implementation, as well as the main menu dispatching.</span></span> |
| <span data-ttu-id="66174-129">СТОКЛИЕН. RC</span><span class="sxs-lookup"><span data-stu-id="66174-129">STOCLIEN.RC</span></span>  | <span data-ttu-id="66174-130">Файл определения ресурса приложения.</span><span class="sxs-lookup"><span data-stu-id="66174-130">The application resource definition file.</span></span>                                                                                        |
| <span data-ttu-id="66174-131">СТОКЛИЕН. ICO</span><span class="sxs-lookup"><span data-stu-id="66174-131">STOCLIEN.ICO</span></span> | <span data-ttu-id="66174-132">Ресурс значка приложения.</span><span class="sxs-lookup"><span data-stu-id="66174-132">The application icon resource.</span></span>                                                                                                   |
| <span data-ttu-id="66174-133">СТОКЛИЕН. PAP</span><span class="sxs-lookup"><span data-stu-id="66174-133">STOCLIEN.PAP</span></span> | <span data-ttu-id="66174-134">Файл рисунка бумаги по умолчанию для приложения.</span><span class="sxs-lookup"><span data-stu-id="66174-134">A default paper drawing file for the application.</span></span>                                                                                |
| <span data-ttu-id="66174-135">«. ВЫРАВНИВАНИ</span><span class="sxs-lookup"><span data-stu-id="66174-135">PENCIL.CUR</span></span>   | <span data-ttu-id="66174-136">Изображение карандаша для курсора окна клиента.</span><span class="sxs-lookup"><span data-stu-id="66174-136">A pencil image for the client window cursor.</span></span>                                                                                     |
| <span data-ttu-id="66174-137">Радиатор. Высоты</span><span class="sxs-lookup"><span data-stu-id="66174-137">SINK.H</span></span>       | <span data-ttu-id="66174-138">Объявление класса для класса COM-объекта Копаперсинк.</span><span class="sxs-lookup"><span data-stu-id="66174-138">The class declaration for the COPaperSink COM object class.</span></span>                                                                      |
| <span data-ttu-id="66174-139">Радиатор. CPP</span><span class="sxs-lookup"><span data-stu-id="66174-139">SINK.CPP</span></span>     | <span data-ttu-id="66174-140">Файл реализации класса COM-объекта Копаперсинк.</span><span class="sxs-lookup"><span data-stu-id="66174-140">Implementation file for the COPaperSink COM object class.</span></span>                                                                        |
| <span data-ttu-id="66174-141">ПАПФИЛЕ. Высоты</span><span class="sxs-lookup"><span data-stu-id="66174-141">PAPFILE.H</span></span>    | <span data-ttu-id="66174-142">Объявление класса для класса **кпапфиле** C++.</span><span class="sxs-lookup"><span data-stu-id="66174-142">The class declaration for the **CPapFile** C++ class.</span></span>                                                                            |
| <span data-ttu-id="66174-143">ПАПФИЛЕ. CPP</span><span class="sxs-lookup"><span data-stu-id="66174-143">PAPFILE.CPP</span></span>  | <span data-ttu-id="66174-144">Файл реализации для класса **кпапфиле** C++.</span><span class="sxs-lookup"><span data-stu-id="66174-144">Implementation file for the **CPapFile** C++ class.</span></span>                                                                              |
| <span data-ttu-id="66174-145">ГУИПАПЕР. Высоты</span><span class="sxs-lookup"><span data-stu-id="66174-145">GUIPAPER.H</span></span>   | <span data-ttu-id="66174-146">Объявление класса для класса **кгуипапер** C++.</span><span class="sxs-lookup"><span data-stu-id="66174-146">The class declaration for the **CGuiPaper** C++ class.</span></span>                                                                           |
| <span data-ttu-id="66174-147">ГУИПАПЕР. CPP</span><span class="sxs-lookup"><span data-stu-id="66174-147">GUIPAPER.CPP</span></span> | <span data-ttu-id="66174-148">Файл реализации для класса **кгуипапер** C++.</span><span class="sxs-lookup"><span data-stu-id="66174-148">Implementation file for the **CGuiPaper** C++ class.</span></span>                                                                             |
| <span data-ttu-id="66174-149">СТОКЛИЕН. DSP</span><span class="sxs-lookup"><span data-stu-id="66174-149">STOCLIEN.DSP</span></span> | <span data-ttu-id="66174-150">Microsoft Visual Studio файл проекта.</span><span class="sxs-lookup"><span data-stu-id="66174-150">Microsoft Visual Studio Project file.</span></span>                                                                                            |



 

## <a name="compound-files"></a><span data-ttu-id="66174-151">Составные файлы</span><span class="sxs-lookup"><span data-stu-id="66174-151">Compound Files</span></span>

<span data-ttu-id="66174-152">**Стоклиен** использует собумагу для записи данных о рисовании.</span><span class="sxs-lookup"><span data-stu-id="66174-152">**StoClien** relies on COPaper to record drawing data.</span></span> <span data-ttu-id="66174-153">Он также использует собумагу для хранения данных в составном файле.</span><span class="sxs-lookup"><span data-stu-id="66174-153">It also relies on COPaper to store the data in a compound file.</span></span> <span data-ttu-id="66174-154">Однако в типичном разделении ресурсов между клиентом и сервером COM **стоклиен** разделяет ответственность за хранение файлов.</span><span class="sxs-lookup"><span data-stu-id="66174-154">However, in a typical division of labor between COM client and server, **StoClien** shares part of the responsibility for file storage.</span></span> <span data-ttu-id="66174-155">Это разделение рабочих ролей играет важную роль в приложениях COM, где клиент является контейнером, а сервер является внедренным объектом.</span><span class="sxs-lookup"><span data-stu-id="66174-155">This division of labor is important in COM applications where the client is a container and the server is an embedded object.</span></span> <span data-ttu-id="66174-156">В этом случае клиент отвечает за создание или открытие структурированного файла хранилища, в то время как объект Server отвечает за использование этого хранилища для собственных целей хранения данных.</span><span class="sxs-lookup"><span data-stu-id="66174-156">In this arrangement, the client is responsible for creating or opening a structured storage file, while the server object is responsible for using that storage for its own data storage purposes.</span></span> <span data-ttu-id="66174-157">Это может затрагивать объект сервера, создающий подхранилища в хранилище, которое ему предоставлено.</span><span class="sxs-lookup"><span data-stu-id="66174-157">This may involve the server object creating substorages in the storage that is given to it.</span></span> <span data-ttu-id="66174-158">Обычно он включает объект Server, создающий объекты потока в хранилище.</span><span class="sxs-lookup"><span data-stu-id="66174-158">It usually involves the server object creating stream objects in the storage.</span></span> <span data-ttu-id="66174-159">Использование потоков хранилища в документе подробно описано в примере **стоклиен** .</span><span class="sxs-lookup"><span data-stu-id="66174-159">COPaper's use of storage streams is detailed in the **StoClien** sample.</span></span>

<span data-ttu-id="66174-160">Интерфейс [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) используется объектами клиента и сервера для выполнения операций с файлами.</span><span class="sxs-lookup"><span data-stu-id="66174-160">The [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is used by both client and server object to perform file operations.</span></span> <span data-ttu-id="66174-161">Используется реализация составных файлов архитектуры структурированного хранилища.</span><span class="sxs-lookup"><span data-stu-id="66174-161">The compound files implementation of the Structured Storage architecture is used.</span></span> <span data-ttu-id="66174-162">Стандартные функции службы используются для операций с составными файлами.</span><span class="sxs-lookup"><span data-stu-id="66174-162">Standard service functions are used for operations on compound files.</span></span> <span data-ttu-id="66174-163">Например, функция [**стгкреатедокфиле**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) изначально создает составной файл и передает указатель **IStorage** , который может использоваться для работы с файлом.</span><span class="sxs-lookup"><span data-stu-id="66174-163">For example, the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) function initially creates a compound file and passes back an **IStorage** pointer that can be used to manipulate the file.</span></span> <span data-ttu-id="66174-164">Эта конкретная функция вызывается в **стоклиен**.</span><span class="sxs-lookup"><span data-stu-id="66174-164">This particular function is called in **StoClien**.</span></span> <span data-ttu-id="66174-165">Интерфейс **IStorage** , который он получает, передается в качестве параметра собумагам для использования.</span><span class="sxs-lookup"><span data-stu-id="66174-165">The **IStorage** interface it obtains is passed as a parameter to COPaper for its use.</span></span> <span data-ttu-id="66174-166">Объект совместной печати не создает и не открывает собственные составные файлы. он использует интерфейсы **IStorage** и [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) для работы с предоставленными им составными файлами.</span><span class="sxs-lookup"><span data-stu-id="66174-166">The COPaper object does not create or open compound files on its own: It uses the **IStorage** and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces to work in compound files that are given to it.</span></span>

<span data-ttu-id="66174-167">Эти интерфейсы [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) и [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) не реализованы в **стоклиен** или **стосерве**.</span><span class="sxs-lookup"><span data-stu-id="66174-167">These [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces are not implemented within **StoClien** or **StoServe**.</span></span> <span data-ttu-id="66174-168">Они реализуются в библиотеках COM.</span><span class="sxs-lookup"><span data-stu-id="66174-168">They are implemented within the COM libraries.</span></span> <span data-ttu-id="66174-169">При получении указателя на один из этих интерфейсов их методы по сути используются в качестве набора служб для работы с составным файлом.</span><span class="sxs-lookup"><span data-stu-id="66174-169">When a pointer to one of these interfaces is obtained, their methods are essentially used as a set of services to operate on a compound file.</span></span>

 

 




