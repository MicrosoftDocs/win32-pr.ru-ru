---
title: Реализация файла IEnumSTATPROPSETSTG-Compound
description: Реализация составного файла интерфейса Иенумстатпропсетстг используется для перечисления массива структур СТАТПРОПСЕТСТГ, содержащих данные статистических свойств.
ms.assetid: 1ce36e40-518c-411b-be5a-835a2dd0995e
keywords:
- Иенумстатпропсетстг Стрктд STG, реализация составного файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9566af1a1956b3a951a996b6198f4a3161680042
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104337740"
---
# <a name="ienumstatpropsetstg-compound-file-implementation"></a><span data-ttu-id="37c00-104">Реализация файла IEnumSTATPROPSETSTG-Compound</span><span class="sxs-lookup"><span data-stu-id="37c00-104">IEnumSTATPROPSETSTG-Compound File Implementation</span></span>

<span data-ttu-id="37c00-105">Реализация составного файла интерфейса [**иенумстатпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) используется для перечисления массива структур [**статпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , содержащих данные статистических свойств.</span><span class="sxs-lookup"><span data-stu-id="37c00-105">The compound file implementation of the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface is used to enumerate an array of [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures that contain statistical property data.</span></span> <span data-ttu-id="37c00-106">Реализация [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) управляет статистическими данными и связывается с текущим объектом хранилища составных файлов.</span><span class="sxs-lookup"><span data-stu-id="37c00-106">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) implementation manages the statistical data and is associated with a current compound file storage object.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="37c00-107">Назначение</span><span class="sxs-lookup"><span data-stu-id="37c00-107">When to Use</span></span>

<span data-ttu-id="37c00-108">Вызывайте методы [**иенумстатпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) для перечисления структур [**статпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , каждый из которых предоставляет данные о одном из наборов свойств, связанных с объектом хранилища составного файла.</span><span class="sxs-lookup"><span data-stu-id="37c00-108">Call the methods of [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures, each of which provide data about one of the property sets associated with the compound file storage object.</span></span>

## <a name="remarks"></a><span data-ttu-id="37c00-109">Комментарии</span><span class="sxs-lookup"><span data-stu-id="37c00-109">Remarks</span></span>

<dl> <dt>

<span data-ttu-id="37c00-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**Иенумстатпропсетстг:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span><span class="sxs-lookup"><span data-stu-id="37c00-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span></span>
</dt> <dd>

<span data-ttu-id="37c00-111">Возвращает следующую одну или несколько структур [**статпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) (число определяется параметром *celt* ).</span><span class="sxs-lookup"><span data-stu-id="37c00-111">Gets the next one or more [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures (the number is specified by the *celt* parameter).</span></span> <span data-ttu-id="37c00-112">Элементы **статпропсетстг** , предоставляемые через вызов реализации составного файла [**Иенумстатпропсетстг:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) , следуют следующим правилам.</span><span class="sxs-lookup"><span data-stu-id="37c00-112">The **STATPROPSETSTG** elements provided through a call to the compound file implementation of [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) follow these rules:</span></span>

-   <span data-ttu-id="37c00-113">Если [**иенумстатпропсетстг:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) не может предоставить статпропсетстг. fmtid, то нули записываются в этот элемент.</span><span class="sxs-lookup"><span data-stu-id="37c00-113">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.fmtid, zeros are written to that member.</span></span> <span data-ttu-id="37c00-114">Это происходит, когда набор свойств не имеет предопределенного имени (например, \\ 005SummaryInformation) и не является допустимым значением.</span><span class="sxs-lookup"><span data-stu-id="37c00-114">This occurs when the property set does not have a predefined name (such as \\005SummaryInformation) and is not a legal value.</span></span>
-   <span data-ttu-id="37c00-115">Набор свойств Документсуммаринформатион и Пользователяопределенные является специальным, в том, что он может иметь два раздела набора свойств.</span><span class="sxs-lookup"><span data-stu-id="37c00-115">The DocumentSummaryInformation and UserDefined property set is special, in that it may have two property set sections.</span></span> <span data-ttu-id="37c00-116">Этот набор свойств описан в разделе, посвященном [наборам свойств документсуммаринформатион и пользователяопределенные](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="37c00-116">This property set is described in the section [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span> <span data-ttu-id="37c00-117">Второй раздел называется User-Defined свойствами.</span><span class="sxs-lookup"><span data-stu-id="37c00-117">The second section is referred to as the User-Defined Properties.</span></span> <span data-ttu-id="37c00-118">Каждый раздел идентифицируется с помощью уникального идентификатора формата (FMTID).</span><span class="sxs-lookup"><span data-stu-id="37c00-118">Each section is identified with a unique format identifier (FMTID).</span></span> <span data-ttu-id="37c00-119">Если для перечисления наборов свойств используется [**IPropertySetStorage:: Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) , набор свойств User-Defined не будет перечислен.</span><span class="sxs-lookup"><span data-stu-id="37c00-119">When [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) is used to enumerate property sets, the User-Defined property set will not be enumerated.</span></span>

> [!Note]  
> <span data-ttu-id="37c00-120">Если вы всегда создаете набор свойств с помощью [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), а затем, так как для имени хранилища создается "символьный GUID", [**Иенумстатпропсетстг:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) вернет ненулевое, допустимое FMTID для свойства Set \[ статпропсетстг. FMTID \] .</span><span class="sxs-lookup"><span data-stu-id="37c00-120">If you always create a property set using [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), then, because a "Character GUID" is created for the storage name, [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) will return a nonzero, valid FMTID for the property set \[STATPROPSETSTG.fmtid\].</span></span>

 

-   <span data-ttu-id="37c00-121">Элемент СТАТПРОПСЕТСТГ. Грффлагс не обязательно отражает, имеет ли свойство значение ANSI.</span><span class="sxs-lookup"><span data-stu-id="37c00-121">The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not.</span></span> <span data-ttu-id="37c00-122">Если \_ задано значение пропсетфлаг ANSI, свойство устанавливается в определенном формате ANSI.</span><span class="sxs-lookup"><span data-stu-id="37c00-122">If PROPSETFLAG\_ANSI is set, the property set is definitely ANSI.</span></span> <span data-ttu-id="37c00-123">Если ПРОПСЕТФЛАГ \_ ANSI является четким, набор свойств может быть либо в Юникоде, либо в формате, отличном от Юникода, так как невозможно определить, является ли он ANSI без открытия.</span><span class="sxs-lookup"><span data-stu-id="37c00-123">If PROPSETFLAG\_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</span></span>
-   <span data-ttu-id="37c00-124">Член СТАТПРОПСЕТСТГ. Грффлагс отражает, является ли набор свойств простым или нет, поэтому параметр \_ непростой флага пропсетфлаг всегда является допустимым.</span><span class="sxs-lookup"><span data-stu-id="37c00-124">The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG\_NONSIMPLE flag is always valid.</span></span>
-   <span data-ttu-id="37c00-125">Если [**иенумстатпропсетстг:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) не может предоставить статпропсетстг. CLSID, ему присваивается значение все НУЛИ (CLSID \_ null).</span><span class="sxs-lookup"><span data-stu-id="37c00-125">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID\_NULL).</span></span> <span data-ttu-id="37c00-126">В реализации составного файла COM это происходит, когда набор свойств является простым ( \_ непростой флаг пропсетфлаг не задан) или является непростым, но CLSID не задан явно.</span><span class="sxs-lookup"><span data-stu-id="37c00-126">In the COM compound file implementation, this occurs when the property set is simple (the PROPSETFLAG\_NONSIMPLE flag is not set), or is nonsimple, but the CLSID was not explicitly set.</span></span> <span data-ttu-id="37c00-127">Для непростых наборов свойств полученный CLSID — это тот, который поддерживается базовым [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span><span class="sxs-lookup"><span data-stu-id="37c00-127">For nonsimple property sets, the CLSID that is received is the one that is maintained by the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span></span>
-   <span data-ttu-id="37c00-128">Если [**иенумстатпропсетстг:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) не может предоставить поля времени \[ **CTime**, **мтиме**, **времени atime** \] , для каждого неподдерживаемого времени будет установлено нулевое значение.</span><span class="sxs-lookup"><span data-stu-id="37c00-128">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide the time fields \[**ctime**, **mtime**, **atime**\], each non-supported time will be set to zeroes.</span></span> <span data-ttu-id="37c00-129">В реализации составного файла COM получение этих значений зависит от их извлечения из базовой реализации [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="37c00-129">In the COM compound file implementation, getting these values depends on retrieving them from the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation.</span></span>

</dd> <dt>

<span data-ttu-id="37c00-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**Иенумстатпропсетстг:: Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="37c00-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG::Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="37c00-131">Пропускает количество элементов, указанное в параметре *celt*.</span><span class="sxs-lookup"><span data-stu-id="37c00-131">Skips the number of elements specified in *celt*.</span></span> <span data-ttu-id="37c00-132">Возвращает значение S \_ ОК, если заданное число элементов пропущено, возвращает S \_ false, если меньше элементов, чем запрошено, пропускаются.</span><span class="sxs-lookup"><span data-stu-id="37c00-132">Returns S\_OK if the specified number of elements are skipped, returns S\_FALSE if fewer elements than requested are skipped.</span></span> <span data-ttu-id="37c00-133">В любом другом случае возвращает соответствующую ошибку.</span><span class="sxs-lookup"><span data-stu-id="37c00-133">In any other case, returns the appropriate error.</span></span>

</dd> <dt>

<span data-ttu-id="37c00-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**Иенумстатпропсетстг:: Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="37c00-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG::Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="37c00-135">Устанавливает курсор в начало перечисления.</span><span class="sxs-lookup"><span data-stu-id="37c00-135">Sets the cursor to the beginning of the enumeration.</span></span> <span data-ttu-id="37c00-136">В случае успеха возвращает S \_ ОК, в противном случае ВОЗВРАЩАЕТ STG \_ E \_ инвалидхандле.</span><span class="sxs-lookup"><span data-stu-id="37c00-136">If successful, returns S\_OK, otherwise, returns STG\_E\_INVALIDHANDLE.</span></span>

</dd> <dt>

<span data-ttu-id="37c00-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**Иенумстатпропсетстг:: Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="37c00-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG::Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="37c00-138">Копирует текущее состояние перечисления этого перечислителя.</span><span class="sxs-lookup"><span data-stu-id="37c00-138">Copies the current enumeration state of this enumerator.</span></span>

</dd> </dl>

 

 