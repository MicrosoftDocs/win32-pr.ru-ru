---
title: Характеристики производительности
description: Вызов реализации составного файла COM интерфейса IPropertySetStorage для создания набора свойств вызывает создание потока или хранилища с помощью вызова IStorage Креатестреам или IStorage Креатестораже.
ms.assetid: 7773e649-19a4-4df2-84ed-027d73283140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8597862602a367ed93a3d6e5e0bcac76035c337a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103987660"
---
# <a name="performance-characteristics"></a><span data-ttu-id="c0c2e-103">Характеристики производительности</span><span class="sxs-lookup"><span data-stu-id="c0c2e-103">Performance Characteristics</span></span>

<span data-ttu-id="c0c2e-104">Вызов реализации составного файла COM интерфейса [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) для создания набора свойств вызывает создание потока или хранилища с помощью вызова [**IStorage:: креатестреам**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) или [**IStorage:: креатестораже**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span><span class="sxs-lookup"><span data-stu-id="c0c2e-104">A call to the COM compound file implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to create a property set causes either a stream or storage to be created through a call to [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) or [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span></span> <span data-ttu-id="c0c2e-105">Набор свойств по умолчанию создается в памяти, но не сбрасывается на диск.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-105">A default property set is created in memory, but not flushed to disk.</span></span> <span data-ttu-id="c0c2e-106">При вызове [**ипропертистораже:: вритемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)он работает в буфере.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-106">When there is a call to [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), it operates within the buffer.</span></span>

<span data-ttu-id="c0c2e-107">При открытии набора свойств используется [IStorage:: опенстреам](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) или [IStorage:: опенстораже](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) .</span><span class="sxs-lookup"><span data-stu-id="c0c2e-107">When a property set is opened, [IStorage::OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [IStorage::OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) is used.</span></span> <span data-ttu-id="c0c2e-108">Весь поток набора свойств считывается в смежную память.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-108">The entire property set stream is read into contiguous memory.</span></span> <span data-ttu-id="c0c2e-109">Операции [**ипропертистораже:: реадмултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) работают, считывая буфер памяти.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-109">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) operations then operate by reading the memory buffer.</span></span> <span data-ttu-id="c0c2e-110">Таким образом, первый доступ требует много времени (из-за операций чтения с диска), но последующие обращения очень эффективны.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-110">Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient.</span></span> <span data-ttu-id="c0c2e-111">Операции записи могут быть немного более ресурсоемкими, так как для обеспечения доступности дискового пространства при добавлении данных может потребоваться выполнение операций в базовом потоке.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-111">Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</span></span>

<span data-ttu-id="c0c2e-112">Нет никаких гарантий относительно того, будут ли [**ипропертистораже:: вритемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) записывать обновления.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-112">No guarantees are made as to whether [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) will flush updates.</span></span> <span data-ttu-id="c0c2e-113">Как правило, клиент должен предположить, что **ипропертистораже:: вритемултипле** обновляет только буфер в памяти.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-113">In general, the client should assume that **IPropertyStorage::WriteMultiple** only updates the in memory buffer.</span></span> <span data-ttu-id="c0c2e-114">Чтобы записать данные на диск, необходимо вызвать [**ипропертистораже:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) или [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (последний выпуск).</span><span class="sxs-lookup"><span data-stu-id="c0c2e-114">To flush data, [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (last release) should be called.</span></span>

<span data-ttu-id="c0c2e-115">Такая схема означает, что [**вритемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) может быть выполнена, но данные на самом деле не сохраняются.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-115">This design means that [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) may succeed but the data is not actually persistently written.</span></span>

> [!Note]  
> <span data-ttu-id="c0c2e-116">Этот размер потока набора свойств не может превышать 256 КБ байт.</span><span class="sxs-lookup"><span data-stu-id="c0c2e-116">This size of the property set stream cannot exceed 256K bytes.</span></span>

 

 

 