---
title: Объекты хранения и потока для набора свойств
description: Программист указывает, хранится ли набор свойств в хранилище или потоке при создании набора свойств.
ms.assetid: d0ca649a-d405-4c34-af02-9c2ca8b2790e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4ebd5d03c3b17e02aa47a7a859576b4cc04607a
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/08/2020
ms.locfileid: "104070777"
---
# <a name="storage-and-stream-objects-for-a-property-set"></a><span data-ttu-id="0c129-103">Объекты хранения и потока для набора свойств</span><span class="sxs-lookup"><span data-stu-id="0c129-103">Storage and Stream Objects for a Property Set</span></span>

<span data-ttu-id="0c129-104">Программист указывает, хранится ли набор свойств в хранилище или потоке при создании набора свойств.</span><span class="sxs-lookup"><span data-stu-id="0c129-104">The programmer specifies whether a property set is stored in a storage or a stream when the property set is created.</span></span> <span data-ttu-id="0c129-105">Непростое \_ значение ПЕРЕЧИСЛЕНИЯ пропсетфлаг, переданное в параметре *грффлагс* в метод [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) , указывает на это.</span><span class="sxs-lookup"><span data-stu-id="0c129-105">The PROPSETFLAG\_NONSIMPLE enumeration value, passed in the *grfFlags* parameter to the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method, indicates this.</span></span> <span data-ttu-id="0c129-106">Настройка, где хранится набор свойств, предоставляет необходимые элементы управления приложениями для полного взаимодействия через интерфейс [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) с набором свойств COM.</span><span class="sxs-lookup"><span data-stu-id="0c129-106">Setting where the property set is stored provides proper application controls to fully interoperate through the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface with the COM property set.</span></span>

<span data-ttu-id="0c129-107">Если \_ установлен непростой флаг пропсетфлаг, набор свойств хранится в объекте хранилища, и в него могут быть записаны непростые значения свойств.</span><span class="sxs-lookup"><span data-stu-id="0c129-107">If the PROPSETFLAG\_NONSIMPLE flag is set, the property set is stored in a storage object, and nonsimple property values can be written to it.</span></span> <span data-ttu-id="0c129-108">Непростые значения включают значения с объектом **VarType** хранилища VT \_ , потоком VT \_ , \_ хранящимся \_ объектом VT или \_ потокового объекта VT \_ .</span><span class="sxs-lookup"><span data-stu-id="0c129-108">Nonsimple values include values with a **VARTYPE** of VT\_STORAGE, VT\_STREAM, VT\_STORED\_OBJECT, or VT\_STREAMED\_OBJECT.</span></span> <span data-ttu-id="0c129-109">Дополнительные сведения о значениях **VarType** и способах их использования см. в разделе Структура [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="0c129-109">For more information about **VARTYPE** values and how to use them, see the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="0c129-110">Если \_ непростой флаг пропсетфлаг не задан, в набор свойств могут быть записаны только простые значения.</span><span class="sxs-lookup"><span data-stu-id="0c129-110">If the PROPSETFLAG\_NONSIMPLE flag is not set, only simple values can be written to the property set.</span></span>

<span data-ttu-id="0c129-111">В объекте хранилища непростого набора свойств поток создается с именованным содержимым.</span><span class="sxs-lookup"><span data-stu-id="0c129-111">In the storage object of a nonsimple property set, a stream is created named Contents.</span></span> <span data-ttu-id="0c129-112">Это основной поток набора свойств, содержащий все простые значения свойств.</span><span class="sxs-lookup"><span data-stu-id="0c129-112">This is the primary stream of the property set, and holds all simple property values.</span></span> <span data-ttu-id="0c129-113">Непростые значения свойств (потоки и хранилища) хранятся в основном объекте хранилища, заданного свойством как подпотоки и хранилища.</span><span class="sxs-lookup"><span data-stu-id="0c129-113">Nonsimple property values (streams and storages) are stored under the main storage object of the property set as substreams and storages.</span></span> <span data-ttu-id="0c129-114">То есть эти непростые значения хранятся как элементы того же уровня в потоке содержимого.</span><span class="sxs-lookup"><span data-stu-id="0c129-114">That is, these nonsimple values are stored as siblings to the Contents stream.</span></span> <span data-ttu-id="0c129-115">Имя параллельных потоков и хранилищ определяется реализацией и сохраняется в потоке содержимого аналогично тому, как хранится простое строковое свойство.</span><span class="sxs-lookup"><span data-stu-id="0c129-115">The name of the sibling streams and storages is determined by the implementation, and stored in the Contents stream similar to the way a simple string property is stored.</span></span>

 

 