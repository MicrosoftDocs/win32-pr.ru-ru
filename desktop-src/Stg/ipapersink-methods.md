---
title: Методы Ипаперсинк
description: Собумага предоставляет интерфейс IConnectionPointContainer, чтобы клиенты могли подключаться к сопоставлению, чтобы получать уведомления об указанных событиях, происходящих в соотношении.
ms.assetid: 2466c721-b275-4dbc-a604-2d5e6a29d6a1
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ac8dee615b278c5214ad1efa3c10d22759620103
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104260966"
---
# <a name="ipapersink-methods"></a><span data-ttu-id="2e785-103">Методы Ипаперсинк</span><span class="sxs-lookup"><span data-stu-id="2e785-103">IPaperSink Methods</span></span>

<span data-ttu-id="2e785-104">Собумага предоставляет интерфейс [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) , чтобы клиенты могли подключаться к сопоставлению, чтобы получать уведомления об указанных событиях, происходящих в соотношении.</span><span class="sxs-lookup"><span data-stu-id="2e785-104">COPaper exposes the [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) interface so clients can connect to COPaper in order to receive notifications of specified events that occur in COPaper.</span></span> <span data-ttu-id="2e785-105">При предоставлении доступа к этому интерфейсу собумага превращается в подключаемый объект.</span><span class="sxs-lookup"><span data-stu-id="2e785-105">By exposing this interface, COPaper becomes a connectable object.</span></span> <span data-ttu-id="2e785-106">Клиент может вызвать [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) для этого интерфейса и использовать его для получения точек соединения объекта.</span><span class="sxs-lookup"><span data-stu-id="2e785-106">A client can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for this interface and use it to obtain the object's connection points.</span></span> <span data-ttu-id="2e785-107">Участие клиента в этой схеме рассматривается в соответствующем образце **стоклиен** .</span><span class="sxs-lookup"><span data-stu-id="2e785-107">The client participation in this scheme is covered in the associated **StoClien** sample.</span></span>

<span data-ttu-id="2e785-108">В сущности, клиент реализует, что называется приемником в виде объекта приемника с интерфейсом приемника.</span><span class="sxs-lookup"><span data-stu-id="2e785-108">Basically, the client implements what is called a sink in the form of a sink object with a sink interface.</span></span> <span data-ttu-id="2e785-109">Интерфейс приемника получает исходящие вызовы уведомлений о событиях из собумаги после того, как приемник правильно соединен клиентом с экземпляром собумаги.</span><span class="sxs-lookup"><span data-stu-id="2e785-109">The sink interface receives outgoing event notification calls from COPaper after the sink is properly connected by the client to a COPaper instance.</span></span> <span data-ttu-id="2e785-110">Клиент устанавливает соединение с помощью объекта точки соединения, который управляется собумагами.</span><span class="sxs-lookup"><span data-stu-id="2e785-110">The client makes the connection by using a connection point object that is managed by COPaper.</span></span> <span data-ttu-id="2e785-111">В одном подключаемом COM-объекте может быть несколько точек соединения.</span><span class="sxs-lookup"><span data-stu-id="2e785-111">There can be numerous connection points on a single connectable COM object.</span></span> <span data-ttu-id="2e785-112">В образце **стосерве** собумага имеет только одну точку соединения, которая обрабатывает события бумажной бумаги.</span><span class="sxs-lookup"><span data-stu-id="2e785-112">In the **StoServe** sample, COPaper has only one connection point, which handles drawing paper events.</span></span>

<span data-ttu-id="2e785-113">Любое число клиентов может подключаться к одной точке соединения.</span><span class="sxs-lookup"><span data-stu-id="2e785-113">Any number of clients can connect to a single connection point.</span></span> <span data-ttu-id="2e785-114">\_Точка подключения коннпоинт паперсинк в сохранит группу соединений, которые могут динамически увеличиваться во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="2e785-114">The CONNPOINT\_PAPERSINK connection point in COPaper maintains a group of connections that can grow dynamically at run time.</span></span> <span data-ttu-id="2e785-115">Полные сведения о поддержке подключаемых объектов кобумага кодируются в файле CONNECT. H и ПОДКЛЮЧИТЕсь. CPP и не будет рассматриваться здесь.</span><span class="sxs-lookup"><span data-stu-id="2e785-115">The full details on COPaper's connectable object support is coded in files CONNECT.H and CONNECT.CPP and will not be covered here.</span></span> <span data-ttu-id="2e785-116">Эта конструкция очень похожа на то, что было в примере для сохранения кода.</span><span class="sxs-lookup"><span data-stu-id="2e785-116">The construction is very similar to what was studied in the CONSERVE code sample.</span></span>

<span data-ttu-id="2e785-117">Клиент **стоклиен** реализует соответствующие объекты приемника для точек подключения, которые он ожидает найти в содокументе.</span><span class="sxs-lookup"><span data-stu-id="2e785-117">The **StoClien** client implements appropriate sink objects for the connection points it expects to find in COPaper.</span></span> <span data-ttu-id="2e785-118">Из контекста собумаги важный объект приемника, который **стоклиен** реализует, предоставляет интерфейс **ипаперсинк** .</span><span class="sxs-lookup"><span data-stu-id="2e785-118">From the context of COPaper, the important sink object that **StoClien** implements exposes the **IPaperSink** interface.</span></span> <span data-ttu-id="2e785-119">Это исходящий интерфейс, используемый содокументом для уведомления **стоклиен** различных событий в содокументе.</span><span class="sxs-lookup"><span data-stu-id="2e785-119">This is the outgoing interface used by COPaper to notify **StoClien** of various events in COPaper.</span></span>

<span data-ttu-id="2e785-120">Ниже приведена сводка методов в **ипаперсинк** из ипапер. H в \\ каталоге с общим родителем Inc.</span><span class="sxs-lookup"><span data-stu-id="2e785-120">Here is a summary of the methods in **IPaperSink** from IPAPER.H in the \\INC sibling directory.</span></span>



| <span data-ttu-id="2e785-121">Метод</span><span class="sxs-lookup"><span data-stu-id="2e785-121">Method</span></span>   | <span data-ttu-id="2e785-122">Описание</span><span class="sxs-lookup"><span data-stu-id="2e785-122">Description</span></span>                                                   |
|----------|---------------------------------------------------------------|
| <span data-ttu-id="2e785-123">Заблокировано</span><span class="sxs-lookup"><span data-stu-id="2e785-123">Locked</span></span>   | <span data-ttu-id="2e785-124">Клиент получает контроль над документом и блокирует его.</span><span class="sxs-lookup"><span data-stu-id="2e785-124">A client has taken control of and locked the paper.</span></span>           |
| <span data-ttu-id="2e785-125">Открыт</span><span class="sxs-lookup"><span data-stu-id="2e785-125">Unlocked</span></span> | <span data-ttu-id="2e785-126">Клиент имеет непредусмотренный контроль над бумагой.</span><span class="sxs-lookup"><span data-stu-id="2e785-126">A client has relinquished control of the paper.</span></span>               |
| <span data-ttu-id="2e785-127">Загружен</span><span class="sxs-lookup"><span data-stu-id="2e785-127">Loaded</span></span>   | <span data-ttu-id="2e785-128">Клиент загрузил бумажное содержимое из своего составного файла.</span><span class="sxs-lookup"><span data-stu-id="2e785-128">A client has loaded paper content from its own compound file.</span></span> |
| <span data-ttu-id="2e785-129">Сохранено</span><span class="sxs-lookup"><span data-stu-id="2e785-129">Saved</span></span>    | <span data-ttu-id="2e785-130">Клиент сохранил содержимое бумаги в свой составной файл.</span><span class="sxs-lookup"><span data-stu-id="2e785-130">A client has saved paper content to its own compound file.</span></span>    |
| <span data-ttu-id="2e785-131">инкстарт</span><span class="sxs-lookup"><span data-stu-id="2e785-131">InkStart</span></span> | <span data-ttu-id="2e785-132">Клиент запустил последовательность рисования цветной краски на бумаге.</span><span class="sxs-lookup"><span data-stu-id="2e785-132">A client started a color ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="2e785-133">инкдрав</span><span class="sxs-lookup"><span data-stu-id="2e785-133">InkDraw</span></span>  | <span data-ttu-id="2e785-134">Клиент помещает точки данных рукописного ввода на бумаге.</span><span class="sxs-lookup"><span data-stu-id="2e785-134">A client is putting ink data points on the paper surface.</span></span>     |
| <span data-ttu-id="2e785-135">инкстоп</span><span class="sxs-lookup"><span data-stu-id="2e785-135">InkStop</span></span>  | <span data-ttu-id="2e785-136">Клиент остановил свою последовательность рукописного рисования на бумаге.</span><span class="sxs-lookup"><span data-stu-id="2e785-136">A client has stopped its ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="2e785-137">Удалены</span><span class="sxs-lookup"><span data-stu-id="2e785-137">Erased</span></span>   | <span data-ttu-id="2e785-138">Клиент удаляет все рукописные данные из бумаги.</span><span class="sxs-lookup"><span data-stu-id="2e785-138">A client has erased all ink data from the paper.</span></span>              |
| <span data-ttu-id="2e785-139">Изменен</span><span class="sxs-lookup"><span data-stu-id="2e785-139">Resized</span></span>  | <span data-ttu-id="2e785-140">Размер документа изменился клиентом.</span><span class="sxs-lookup"><span data-stu-id="2e785-140">A client has resized the paper.</span></span>                               |



 

<span data-ttu-id="2e785-141">Эти методы в основном говорят сами за себя.</span><span class="sxs-lookup"><span data-stu-id="2e785-141">These methods are largely self-explanatory.</span></span> <span data-ttu-id="2e785-142">Хотя приемник должен реализовывать все эти методы в некоторой манере, многие из них реализуются как заглушки и не используются в  / примерах стосерве **стоклиен** .</span><span class="sxs-lookup"><span data-stu-id="2e785-142">Although the sink must implement all these methods in some fashion, many are implemented as stubs and are not used in the **StoServe**/**StoClien** samples.</span></span>

<span data-ttu-id="2e785-143">Важным методом, используемым в этих примерах, является загруженный метод.</span><span class="sxs-lookup"><span data-stu-id="2e785-143">An important method used in these samples is the Loaded method.</span></span> <span data-ttu-id="2e785-144">Когда клиент получает сообщение о загрузке нового документа из файла, ему требуется способ уведомления клиента о загрузке новых данных.</span><span class="sxs-lookup"><span data-stu-id="2e785-144">When COPaper is told by the client to load a new drawing from file, it needs a way to notify the client when the new data is loaded.</span></span> <span data-ttu-id="2e785-145">Для этого сопечатка вызывает **ипаперсинк:: Loaded** в приемнике клиента.</span><span class="sxs-lookup"><span data-stu-id="2e785-145">To do this, COPaper Calls **IPaperSink::Loaded** on the client sink.</span></span> <span data-ttu-id="2e785-146">После этого клиент может вызвать [**ипапер:: Redraw**](ipaper--redraw.md) , чтобы запросить, что собумага воспроизводила новые данные клиенту.</span><span class="sxs-lookup"><span data-stu-id="2e785-146">The client can then call [**IPaper::Redraw**](ipaper--redraw.md) to request that COPaper play back the new data to the client.</span></span> <span data-ttu-id="2e785-147">Перерисовка вызывает перерисовку загруженного рисунка на экране клиента.</span><span class="sxs-lookup"><span data-stu-id="2e785-147">Redraw causes the loaded drawing in the client's display to be repainted.</span></span> <span data-ttu-id="2e785-148">После завершения загрузки недавно загруженный документ автоматически отображается в окне, предоставленном клиентом.</span><span class="sxs-lookup"><span data-stu-id="2e785-148">When the load is completed, the newly loaded drawing is displayed automatically in the window provided by the client.</span></span>

<span data-ttu-id="2e785-149">Полные сведения о подключении этого метода Ипапер к **ипаперсинк** см. в разделе [**ипапер:: Redraw**](ipaper--redraw.md) .</span><span class="sxs-lookup"><span data-stu-id="2e785-149">See [**IPaper::Redraw**](ipaper--redraw.md) for complete information of this IPaper method's connectivity to **IPaperSink**.</span></span>

<span data-ttu-id="2e785-150">Методы **Ипаперсинк** **инкстарт**, **инкдрав** и **инкстоп** используются для отправки отдельных пакетов рукописных данных обратно клиенту.</span><span class="sxs-lookup"><span data-stu-id="2e785-150">The **IPaperSink** methods **InkStart**, **InkDraw**, and **InkStop** are used to send individual ink data packets back to the client.</span></span> <span data-ttu-id="2e785-151">При приеме клиент выводит их на экран так же, как и при первоначальной отправке их в собумагу.</span><span class="sxs-lookup"><span data-stu-id="2e785-151">On reception, the client paints them in its display in the same manner as when it originally sent them to COPaper.</span></span> <span data-ttu-id="2e785-152">Приведенная выше логика достаточно велика, чтобы позволить нескольким клиентам прослушивать одну и ту же \_ точку подключения коннпоинт паперсинк.</span><span class="sxs-lookup"><span data-stu-id="2e785-152">The above logic is general enough to allow for multiple clients that are all listening on the same CONNPOINT\_PAPERSINK connection point.</span></span> <span data-ttu-id="2e785-153">Если общий экземпляр совместной печати был общим для этих клиентов, все они могут отображать один и тот же рисунок путем подключения к этой точке подключения.</span><span class="sxs-lookup"><span data-stu-id="2e785-153">If a common COPaper instance was shared by these clients, they could all display the same drawing by connecting to this connection point.</span></span>

 

 