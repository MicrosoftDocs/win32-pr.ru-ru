---
title: Обзор Стоклиен
description: В примере Стоклиен показано, как клиент использует структурированное хранилище и как он направляет серверный компонент для использования этого хранилища.
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- Обзор Стоклиен
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105661483"
---
# <a name="stoclien-overview"></a>Обзор Стоклиен

## <a name="purpose"></a>Назначение

Основной задачей примера [стоклиен](structured-storage-client-sample--stoclien-.md) является то, как клиент использует структурированное хранилище и как он указывает серверному компоненту использовать это хранилище. В примере Стоклиен демонстрируется модель программирования структурированных служб хранилища.

## <a name="functionality"></a>Функциональность

Функции [стоклиен](structured-storage-client-sample--stoclien-.md) похожи на образцы "Scribble" в некоторых версиях Microsoft Visual C++. Разница между образцом Стоклиен и примером [стосерве](structured-storage-server-sample--stoserve-.md) является внутренней архитектурой на основе технологии COM. Между COM-клиентом и COM-сервером хранится четкое различие в архитектуре.

[Стоклиен](structured-storage-client-sample--stoclien-.md) загружает и сохраняет свои чертежи в структурированном хранилище составных файлов com.

В примере [стоклиен](structured-storage-client-sample--stoclien-.md) создается и используется подключаемый объект COM, который предоставляется в качестве \_ компонента дллпапер CLSID на сервере [стосерве](structured-storage-server-sample--stoserve-.md) . Клиент Стоклиен создает объект собумаги и управляет им через интерфейс Ипапер, предоставляемый объектом. Стоклиен получает данные рисования от пользователя и графически представляет его в управляемом окне. Стоклиен использует интерфейс Ипапер для сохранения данных в содокументе, а также для направления операций с хранилищем файлов на основе этих данных.

Объект COM-объекта сопечатной бумаги инкапсулирует только серверное хранилище данных, предназначенных для отображения бумаги. на стороне сервера не отображается графический интерфейс пользователя. Все поведение графического пользовательского интерфейса изолировано в клиенте. Функции управления данными и хранения объектов-распечатки доступны только через пользовательский интерфейс COM Ипапер.

[Стоклиен](structured-storage-client-sample--stoclien-.md) взаимодействует с кодокументом, чтобы загрузить и сохранить данные рисования. Стоклиен получает интерфейс [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) для объекта хранилища в составном файле. При выполнении операций Load и Save Стоклиен передает указатель на интерфейс **IStorage** к собумагам на сервере. Собумага использует предоставленный **IStorage** для создания потоков в хранилище. Собумага может использовать стандартный интерфейс [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) для чтения и записи данных рисования, которыми он управляет.

Собумага управляет только данными рисования. Он не выполняет никаких действий GUI. [Стоклиен](structured-storage-client-sample--stoclien-.md) предоставляет графический интерфейс пользователя для приложения для рисования. Он инкапсулирует это в центральном объекте Кгуипапер C++.

[Стоклиен](structured-storage-client-sample--stoclien-.md) также реализует пользовательский интерфейс ипаперсинк в COM-объекте копаперсинк и подключает этот интерфейс к соответствующей точке соединения в объекте серверной бумаги. Собумага использует подключенный интерфейс Ипаперсинк для отправки уведомлений обратно в Стоклиен. Нормальное перерисовка графических элементов графического интерфейса пользователя осуществляется в Стоклиен с помощью технологии взаимосвязанных объектов.

[Стоклиен](structured-storage-client-sample--stoclien-.md) — это приложение, которое можно выполнять напрямую обычным образом или из окна командной строки. Стоклиен принимает необязательный параметр имени файла в командной строке.

В следующем примере Drawing. PAP — это составной файл, содержащий Дллпапер-совместимые структурированные хранилища данных для рисования. Если не указан параметр имени файла командной строки, [стоклиен](structured-storage-client-sample--stoclien-.md) использует имя файла по умолчанию стоклиен. PAP и пытается открыть его в том же каталоге, что и исполняемый Stoclien.exe.

**Стоклиен c: \\ чертежи \\ Drawing. PAP**

## <a name="support-information"></a>Данные поддержки

Дополнительные сведения, функциональные описания и учебник по коду для [стоклиен](structured-storage-client-sample--stoclien-.md)см. в разделе "Обзор кода" в Stoclien.htm. Дополнительные сведения об операции внешнего пользователя Стоклиен см. в разделах об использовании и работе в Stoclien.htm. Чтобы прочитать Stoclient.htm, запустите Tutorial.exe в главном каталоге Tutorial и щелкните урок Стоклиен в таблице занятий. Кроме того, можно нажать кнопку Stoclien.htm после поиска основного каталога Tutorial в проводнике Windows. Дополнительные сведения о том, как работает [**стосерве**](structured-storage-server-sample--stoserve-.md) и предоставляет свои службы для стоклиен, см. в разделе Stoserve.htm в главном каталоге Tutorial. Имейте в виду, что необходимо создать Stoserve.dll перед построением Стоклиен. Файл makefile для [**стосерве**](structured-storage-server-sample--stoserve-.md) регистрирует этот сервер в системном реестре, поэтому перед запуском стоклиен необходимо создать [**стосерве**](structured-storage-server-sample--stoserve-.md) .

Дополнительные сведения о настройке системы для сборки и тестирования примеров кода в этой серии руководств по COM см. в разделе [Создание образцов](how-to-build-samples.md). Указанный файл Makefile (MAKEFILE) совместим с Microsoft NMAKE. Чтобы создать отладочную сборку, выполните команду NMAKE в окне командной строки.

Для удобства файл проекта предоставляется для каждого примера, используемого в Microsoft Visual Studio. Чтобы загрузить проект для примера [стоклиен](structured-storage-client-sample--stoclien-.md) , запустите Visual Studio из командной строки в каталоге примеров следующим образом:

МСДЕВ СТОКЛИЕН. DSP

Можно также дважды щелкнуть файл Стоклиент. DSP в проводнике Windows, чтобы загрузить пример проекта в Visual Studio. В Visual Studio можно просмотреть классы C++ образца источника и, как правило, выполнить другие операции Edit-Compile-Debug. Имейте в виду, что в составе пакета SDK для сервера компиляция этих примеров из Visual Studio требует правильной настройки путей к каталогам в Visual Studio. Дополнительные сведения см. [в разделе Создание образцов](how-to-build-samples.md).

## <a name="remarks"></a>Комментарии

Перед запуском клиента необходимо скомпилировать образец клиента и другие связанные образцы. Дополнительные сведения о построении образцов см. в разделе Создание [образцов](how-to-build-samples.md). Если вы создали соответствующие примеры, Stoclien.exe — клиентский исполняемый файл для выполнения этого примера.

Приложение Stoclien.exe предоставляет пользовательский интерфейс для работы с этим руководством. Он выполняет связанные, но независимые Stoserve.dll, чтобы продемонстрировать использование в составных файлах как клиентских, так и серверных структурных хранилищ COM.

 

 




