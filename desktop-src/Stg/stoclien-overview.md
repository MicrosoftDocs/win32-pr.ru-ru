---
title: Обзор Стоклиен
description: В примере Стоклиен показано, как клиент использует структурированное хранилище и как он направляет серверный компонент для использования этого хранилища.
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- Обзор Стоклиен
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105661483"
---
# <a name="stoclien-overview"></a><span data-ttu-id="6a421-104">Обзор Стоклиен</span><span class="sxs-lookup"><span data-stu-id="6a421-104">StoClien Overview</span></span>

## <a name="purpose"></a><span data-ttu-id="6a421-105">Назначение</span><span class="sxs-lookup"><span data-stu-id="6a421-105">Purpose</span></span>

<span data-ttu-id="6a421-106">Основной задачей примера [стоклиен](structured-storage-client-sample--stoclien-.md) является то, как клиент использует структурированное хранилище и как он указывает серверному компоненту использовать это хранилище.</span><span class="sxs-lookup"><span data-stu-id="6a421-106">The principal focus of the [StoClien](structured-storage-client-sample--stoclien-.md) sample is how the client uses structured storage and how it instructs a server component to use this storage.</span></span> <span data-ttu-id="6a421-107">В примере Стоклиен демонстрируется модель программирования структурированных служб хранилища.</span><span class="sxs-lookup"><span data-stu-id="6a421-107">The StoClien sample demonstrates a programming model of structured storage services.</span></span>

## <a name="functionality"></a><span data-ttu-id="6a421-108">Функциональность</span><span class="sxs-lookup"><span data-stu-id="6a421-108">Functionality</span></span>

<span data-ttu-id="6a421-109">Функции [стоклиен](structured-storage-client-sample--stoclien-.md) похожи на образцы "Scribble" в некоторых версиях Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="6a421-109">The [StoClien](structured-storage-client-sample--stoclien-.md) functionality is similar to the "scribble" samples in some versions of Microsoft Visual C++.</span></span> <span data-ttu-id="6a421-110">Разница между образцом Стоклиен и примером [стосерве](structured-storage-server-sample--stoserve-.md) является внутренней архитектурой на основе технологии COM.</span><span class="sxs-lookup"><span data-stu-id="6a421-110">The difference between the StoClien sample and the [StoServe](structured-storage-server-sample--stoserve-.md) sample is an internal architecture based on COM technology.</span></span> <span data-ttu-id="6a421-111">Между COM-клиентом и COM-сервером хранится четкое различие в архитектуре.</span><span class="sxs-lookup"><span data-stu-id="6a421-111">A clear architectural distinction is kept between COM client and COM server.</span></span>

<span data-ttu-id="6a421-112">[Стоклиен](structured-storage-client-sample--stoclien-.md) загружает и сохраняет свои чертежи в структурированном хранилище составных файлов com.</span><span class="sxs-lookup"><span data-stu-id="6a421-112">[StoClien](structured-storage-client-sample--stoclien-.md) loads and saves its drawings in the structured storage of COM compound files.</span></span>

<span data-ttu-id="6a421-113">В примере [стоклиен](structured-storage-client-sample--stoclien-.md) создается и используется подключаемый объект COM, который предоставляется в качестве \_ компонента дллпапер CLSID на сервере [стосерве](structured-storage-server-sample--stoserve-.md) .</span><span class="sxs-lookup"><span data-stu-id="6a421-113">The [StoClien](structured-storage-client-sample--stoclien-.md) sample creates and uses the connectable COPaper COM object that is provided as the CLSID\_DllPaper component in the [StoServe](structured-storage-server-sample--stoserve-.md) server.</span></span> <span data-ttu-id="6a421-114">Клиент Стоклиен создает объект собумаги и управляет им через интерфейс Ипапер, предоставляемый объектом.</span><span class="sxs-lookup"><span data-stu-id="6a421-114">The StoClien client creates a COPaper object and controls it through the IPaper interface that the object exposes.</span></span> <span data-ttu-id="6a421-115">Стоклиен получает данные рисования от пользователя и графически представляет его в управляемом окне.</span><span class="sxs-lookup"><span data-stu-id="6a421-115">StoClien obtains drawing data from the user and graphically represents it in a window that it manages.</span></span> <span data-ttu-id="6a421-116">Стоклиен использует интерфейс Ипапер для сохранения данных в содокументе, а также для направления операций с хранилищем файлов на основе этих данных.</span><span class="sxs-lookup"><span data-stu-id="6a421-116">StoClien uses the COPaper IPaper interface to save the drawing data in COPaper and to direct file storage operations on this data.</span></span>

<span data-ttu-id="6a421-117">Объект COM-объекта сопечатной бумаги инкапсулирует только серверное хранилище данных, предназначенных для отображения бумаги. на стороне сервера не отображается графический интерфейс пользователя.</span><span class="sxs-lookup"><span data-stu-id="6a421-117">A COPaper COM object encapsulates only the server-based storage of the drawing paper data: No graphical user interface (GUI) behavior is provided on the server side.</span></span> <span data-ttu-id="6a421-118">Все поведение графического пользовательского интерфейса изолировано в клиенте.</span><span class="sxs-lookup"><span data-stu-id="6a421-118">All GUI behavior is isolated in the client.</span></span> <span data-ttu-id="6a421-119">Функции управления данными и хранения объектов-распечатки доступны только через пользовательский интерфейс COM Ипапер.</span><span class="sxs-lookup"><span data-stu-id="6a421-119">The data management and storage features of COPaper objects are available only through an COM custom interface, IPaper.</span></span>

<span data-ttu-id="6a421-120">[Стоклиен](structured-storage-client-sample--stoclien-.md) взаимодействует с кодокументом, чтобы загрузить и сохранить данные рисования.</span><span class="sxs-lookup"><span data-stu-id="6a421-120">[StoClien](structured-storage-client-sample--stoclien-.md) cooperates with the COPaper to load and save the COPaper drawing data.</span></span> <span data-ttu-id="6a421-121">Стоклиен получает интерфейс [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) для объекта хранилища в составном файле.</span><span class="sxs-lookup"><span data-stu-id="6a421-121">StoClien obtains an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface for the storage object in a compound file.</span></span> <span data-ttu-id="6a421-122">При выполнении операций Load и Save Стоклиен передает указатель на интерфейс **IStorage** к собумагам на сервере.</span><span class="sxs-lookup"><span data-stu-id="6a421-122">In its load and save operations, StoClien passes a pointer to the **IStorage** interface to COPaper in the server.</span></span> <span data-ttu-id="6a421-123">Собумага использует предоставленный **IStorage** для создания потоков в хранилище.</span><span class="sxs-lookup"><span data-stu-id="6a421-123">COPaper uses the provided **IStorage** to create streams in the storage.</span></span> <span data-ttu-id="6a421-124">Собумага может использовать стандартный интерфейс [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) для чтения и записи данных рисования, которыми он управляет.</span><span class="sxs-lookup"><span data-stu-id="6a421-124">COPaper can then use the standard [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interface for reading and writing the drawing data it manages.</span></span>

<span data-ttu-id="6a421-125">Собумага управляет только данными рисования. Он не выполняет никаких действий GUI.</span><span class="sxs-lookup"><span data-stu-id="6a421-125">COPaper only manages the drawing data; it performs no GUI actions.</span></span> <span data-ttu-id="6a421-126">[Стоклиен](structured-storage-client-sample--stoclien-.md) предоставляет графический интерфейс пользователя для приложения для рисования.</span><span class="sxs-lookup"><span data-stu-id="6a421-126">[StoClien](structured-storage-client-sample--stoclien-.md) provides the GUI for the drawing application.</span></span> <span data-ttu-id="6a421-127">Он инкапсулирует это в центральном объекте Кгуипапер C++.</span><span class="sxs-lookup"><span data-stu-id="6a421-127">It encapsulates this in a central CGuiPaper C++ object.</span></span>

<span data-ttu-id="6a421-128">[Стоклиен](structured-storage-client-sample--stoclien-.md) также реализует пользовательский интерфейс ипаперсинк в COM-объекте копаперсинк и подключает этот интерфейс к соответствующей точке соединения в объекте серверной бумаги.</span><span class="sxs-lookup"><span data-stu-id="6a421-128">[StoClien](structured-storage-client-sample--stoclien-.md) also implements the custom IPaperSink interface in a COPaperSink COM object and connects this interface to an appropriate connection point in the server COPaper object.</span></span> <span data-ttu-id="6a421-129">Собумага использует подключенный интерфейс Ипаперсинк для отправки уведомлений обратно в Стоклиен.</span><span class="sxs-lookup"><span data-stu-id="6a421-129">COPaper uses the connected IPaperSink interface to send notifications back to StoClien.</span></span> <span data-ttu-id="6a421-130">Нормальное перерисовка графических элементов графического интерфейса пользователя осуществляется в Стоклиен с помощью технологии взаимосвязанных объектов.</span><span class="sxs-lookup"><span data-stu-id="6a421-130">The normal GUI repainting of the COPaper drawing data is done in StoClien using the COPaper connectable object technology.</span></span>

<span data-ttu-id="6a421-131">[Стоклиен](structured-storage-client-sample--stoclien-.md) — это приложение, которое можно выполнять напрямую обычным образом или из окна командной строки.</span><span class="sxs-lookup"><span data-stu-id="6a421-131">[StoClien](structured-storage-client-sample--stoclien-.md) is an application that you can execute directly in the normal manner or from the command prompt window.</span></span> <span data-ttu-id="6a421-132">Стоклиен принимает необязательный параметр имени файла в командной строке.</span><span class="sxs-lookup"><span data-stu-id="6a421-132">StoClien accepts an optional file name parameter on the command line.</span></span>

<span data-ttu-id="6a421-133">В следующем примере Drawing. PAP — это составной файл, содержащий Дллпапер-совместимые структурированные хранилища данных для рисования.</span><span class="sxs-lookup"><span data-stu-id="6a421-133">In the following example, Drawing.pap is a compound file containing DllPaper-compatible structured storage of drawing data.</span></span> <span data-ttu-id="6a421-134">Если не указан параметр имени файла командной строки, [стоклиен](structured-storage-client-sample--stoclien-.md) использует имя файла по умолчанию стоклиен. PAP и пытается открыть его в том же каталоге, что и исполняемый Stoclien.exe.</span><span class="sxs-lookup"><span data-stu-id="6a421-134">If no command line file name parameter is specified, [StoClien](structured-storage-client-sample--stoclien-.md) uses the default file name Stoclien.pap and attempts to open it in the same directory as the executing Stoclien.exe.</span></span>

<span data-ttu-id="6a421-135">**Стоклиен c: \\ чертежи \\ Drawing. PAP**</span><span class="sxs-lookup"><span data-stu-id="6a421-135">**StoClien c:\\drawings\\drawing.pap**</span></span>

## <a name="support-information"></a><span data-ttu-id="6a421-136">Данные поддержки</span><span class="sxs-lookup"><span data-stu-id="6a421-136">Support Information</span></span>

<span data-ttu-id="6a421-137">Дополнительные сведения, функциональные описания и учебник по коду для [стоклиен](structured-storage-client-sample--stoclien-.md)см. в разделе "Обзор кода" в Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="6a421-137">For more information, functional descriptions and a code tutorial for [StoClien](structured-storage-client-sample--stoclien-.md), see the Code Tour section in Stoclien.htm.</span></span> <span data-ttu-id="6a421-138">Дополнительные сведения об операции внешнего пользователя Стоклиен см. в разделах об использовании и работе в Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="6a421-138">For more information about the external user operation of StoClien, see the Usage and Operation sections in Stoclien.htm.</span></span> <span data-ttu-id="6a421-139">Чтобы прочитать Stoclient.htm, запустите Tutorial.exe в главном каталоге Tutorial и щелкните урок Стоклиен в таблице занятий.</span><span class="sxs-lookup"><span data-stu-id="6a421-139">To read Stoclient.htm, run Tutorial.exe in the main tutorial directory and click the StoClien lesson in the table of lessons.</span></span> <span data-ttu-id="6a421-140">Кроме того, можно нажать кнопку Stoclien.htm после поиска основного каталога Tutorial в проводнике Windows.</span><span class="sxs-lookup"><span data-stu-id="6a421-140">Alternatively, click Stoclien.htm after locating the main tutorial directory in Windows Explorer.</span></span> <span data-ttu-id="6a421-141">Дополнительные сведения о том, как работает [**стосерве**](structured-storage-server-sample--stoserve-.md) и предоставляет свои службы для стоклиен, см. в разделе Stoserve.htm в главном каталоге Tutorial.</span><span class="sxs-lookup"><span data-stu-id="6a421-141">For more information about how [**StoServe**](structured-storage-server-sample--stoserve-.md) works and exposes its services to StoClien, see Stoserve.htm in the main tutorial directory.</span></span> <span data-ttu-id="6a421-142">Имейте в виду, что необходимо создать Stoserve.dll перед построением Стоклиен.</span><span class="sxs-lookup"><span data-stu-id="6a421-142">Be aware that you must build the Stoserve.dll before building StoClien.</span></span> <span data-ttu-id="6a421-143">Файл makefile для [**стосерве**](structured-storage-server-sample--stoserve-.md) регистрирует этот сервер в системном реестре, поэтому перед запуском стоклиен необходимо создать [**стосерве**](structured-storage-server-sample--stoserve-.md) .</span><span class="sxs-lookup"><span data-stu-id="6a421-143">The makefile for [**StoServe**](structured-storage-server-sample--stoserve-.md) registers that server in the system registry, so you must build [**StoServe**](structured-storage-server-sample--stoserve-.md) before attempting to run StoClien.</span></span>

<span data-ttu-id="6a421-144">Дополнительные сведения о настройке системы для сборки и тестирования примеров кода в этой серии руководств по COM см. в разделе [Создание образцов](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="6a421-144">For more information about setting up a system to build and test the code samples in this COM Tutorial series, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="6a421-145">Указанный файл Makefile (MAKEFILE) совместим с Microsoft NMAKE.</span><span class="sxs-lookup"><span data-stu-id="6a421-145">The supplied makefile (MAKEFILE) is Microsoft NMAKE-compatible.</span></span> <span data-ttu-id="6a421-146">Чтобы создать отладочную сборку, выполните команду NMAKE в окне командной строки.</span><span class="sxs-lookup"><span data-stu-id="6a421-146">To create a debug build, issue the NMAKE command in the command prompt window.</span></span>

<span data-ttu-id="6a421-147">Для удобства файл проекта предоставляется для каждого примера, используемого в Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6a421-147">For convenience, a project file is provided for each sample for use in Microsoft Visual Studio.</span></span> <span data-ttu-id="6a421-148">Чтобы загрузить проект для примера [стоклиен](structured-storage-client-sample--stoclien-.md) , запустите Visual Studio из командной строки в каталоге примеров следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6a421-148">To load the project for the [StoClien](structured-storage-client-sample--stoclien-.md) sample, run Visual Studio at the command prompt in the sample directory as follows:</span></span>

<span data-ttu-id="6a421-149">МСДЕВ СТОКЛИЕН. DSP</span><span class="sxs-lookup"><span data-stu-id="6a421-149">MSDEV STOCLIEN.DSP</span></span>

<span data-ttu-id="6a421-150">Можно также дважды щелкнуть файл Стоклиент. DSP в проводнике Windows, чтобы загрузить пример проекта в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6a421-150">You can also double-click the Stoclient.dsp file in Windows Explorer to load a sample project into Visual Studio.</span></span> <span data-ttu-id="6a421-151">В Visual Studio можно просмотреть классы C++ образца источника и, как правило, выполнить другие операции Edit-Compile-Debug.</span><span class="sxs-lookup"><span data-stu-id="6a421-151">In Visual Studio, you can browse the C++ classes of the sample source and generally perform the other edit-compile-debug operations.</span></span> <span data-ttu-id="6a421-152">Имейте в виду, что в составе пакета SDK для сервера компиляция этих примеров из Visual Studio требует правильной настройки путей к каталогам в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6a421-152">Be aware that, as part of the Server SDK, the compilation of these samples from within Visual Studio requires the proper setting of directory paths in Visual Studio.</span></span> <span data-ttu-id="6a421-153">Дополнительные сведения см. [в разделе Создание образцов](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="6a421-153">For more information, see [How to Build Samples](how-to-build-samples.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="6a421-154">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6a421-154">Remarks</span></span>

<span data-ttu-id="6a421-155">Перед запуском клиента необходимо скомпилировать образец клиента и другие связанные образцы.</span><span class="sxs-lookup"><span data-stu-id="6a421-155">The client sample and other related samples must be compiled before you can run the client.</span></span> <span data-ttu-id="6a421-156">Дополнительные сведения о построении образцов см. в разделе Создание [образцов](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="6a421-156">For more information about building the samples, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="6a421-157">Если вы создали соответствующие примеры, Stoclien.exe — клиентский исполняемый файл для выполнения этого примера.</span><span class="sxs-lookup"><span data-stu-id="6a421-157">If you have built the appropriate samples, Stoclien.exe is the client executable to run for this sample.</span></span>

<span data-ttu-id="6a421-158">Приложение Stoclien.exe предоставляет пользовательский интерфейс для работы с этим руководством.</span><span class="sxs-lookup"><span data-stu-id="6a421-158">The Stoclien.exe application provides the user interface for this tutorial.</span></span> <span data-ttu-id="6a421-159">Он выполняет связанные, но независимые Stoserve.dll, чтобы продемонстрировать использование в составных файлах как клиентских, так и серверных структурных хранилищ COM.</span><span class="sxs-lookup"><span data-stu-id="6a421-159">It exercises the associated, but independent, Stoserve.dll to demonstrate both client and server use of COM structured storage in compound files.</span></span>

 

 




