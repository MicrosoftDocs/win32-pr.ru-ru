---
title: Константы ПРОПСЕТФЛАГ (Пропидл. h)
description: Определите характеристики набора свойств.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e8f31d7b2659eeaa003c1a0d15103e94ad1a5c89
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103988707"
---
# <a name="propsetflag-constants"></a><span data-ttu-id="9a236-103">Константы ПРОПСЕТФЛАГ</span><span class="sxs-lookup"><span data-stu-id="9a236-103">PROPSETFLAG Constants</span></span>

<span data-ttu-id="9a236-104">Константы ПРОПСЕТФЛАГ определяют характеристики набора свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-104">The PROPSETFLAG constants define characteristics of a property set.</span></span> <span data-ttu-id="9a236-105">Значения, перечисленные в следующей таблице, используются в параметре *грффлагс* методов [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , функции [**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) и функции [**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .</span><span class="sxs-lookup"><span data-stu-id="9a236-105">The values, listed in the following table, are used in the *grfFlags* parameter of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) methods, the [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) function, and the [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) function.</span></span>



| <span data-ttu-id="9a236-106">Константа/значение</span><span class="sxs-lookup"><span data-stu-id="9a236-106">Constant/value</span></span>                                                                                                                                                                                                                                               | <span data-ttu-id="9a236-107">Описание</span><span class="sxs-lookup"><span data-stu-id="9a236-107">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <span data-ttu-id="9a236-108"><dt>**Пропсетфлаг \_ ПО УМОЛЧАНИю**</dt> <dt>0</dt></span><span class="sxs-lookup"><span data-stu-id="9a236-108"><dt>**PROPSETFLAG\_DEFAULT**</dt> <dt>0</dt></span></span> </dl>                       | <span data-ttu-id="9a236-109">Если параметр left не указан, то по умолчанию в набор свойств могут быть записаны только простые значения свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-109">If left unspecified, by default only simple property values may be written to the property set.</span></span> <span data-ttu-id="9a236-110">Использование простых значений свойств предотвращает транзакционные наборы свойств в составном файле и изолированных реализациях [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage).</span><span class="sxs-lookup"><span data-stu-id="9a236-110">Using simple property values prevents property sets from being transacted in the compound file and stand-alone implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage).</span></span> <span data-ttu-id="9a236-111">Для этой цели необходимо использовать значения свойств, отличных от e.</span><span class="sxs-lookup"><span data-stu-id="9a236-111">Non-e property values must be used for this purpose.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <span data-ttu-id="9a236-112"><dt>**Пропсетфлаг \_ Непростая**</dt> <dt>1</dt></span><span class="sxs-lookup"><span data-stu-id="9a236-112"><dt>**PROPSETFLAG\_NONSIMPLE**</dt> <dt>1</dt></span></span> </dl>                 | <span data-ttu-id="9a236-113">Если указано, непростые значения свойств могут быть записаны в набор свойств, а набор свойств сохраняется в объекте хранилища.</span><span class="sxs-lookup"><span data-stu-id="9a236-113">If specified, nonsimple property values can be written to the property set and the property set is saved in a storage object.</span></span> <span data-ttu-id="9a236-114">Непростые значения свойств включают в себя объекты с VARTYPE хранилища VT \_ , VT \_ Stream, объект VT \_ , хранящийся \_ \_ потоковый объект VT \_ .</span><span class="sxs-lookup"><span data-stu-id="9a236-114">Non-simple property values include those with a VARTYPE of VT\_STORAGE, VT\_STREAM, VT\_STORED\_OBJECT, or VT\_STREAMED\_OBJECT.</span></span> <span data-ttu-id="9a236-115">Если этот флаг не указан, непростые типы не могут быть записаны в набор свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-115">If this flag is not specified, non-simple types cannot be written into the property set.</span></span> <span data-ttu-id="9a236-116">В составном файле и изолированных реализациях наборы свойств могут быть транзакционными, только если указано **пропсетфлаг \_ непростое** .</span><span class="sxs-lookup"><span data-stu-id="9a236-116">In the compound file and stand-alone implementations, property sets may be transacted only if **PROPSETFLAG\_NONSIMPLE** is specified.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <span data-ttu-id="9a236-117"><dt>**Пропсетфлаг \_ ANSI**</dt> <dt>2</dt></span><span class="sxs-lookup"><span data-stu-id="9a236-117"><dt>**PROPSETFLAG\_ANSI**</dt> <dt>2</dt></span></span> </dl>                                | <span data-ttu-id="9a236-118">Если задано значение, все строковые значения в наборе свойств, которые не являются явно заданными в Юникоде, т. е. Кроме VT \_ LPWSTR, хранятся в текущей системной кодовой странице ANSI.</span><span class="sxs-lookup"><span data-stu-id="9a236-118">If specified, all string values in the property set that are not explicitly Unicode, that is, those other than VT\_LPWSTR, are stored with the current system ANSI code page.</span></span> <span data-ttu-id="9a236-119">Дополнительные сведения см. в разделе [**жетакп**](/windows/desktop/api/winnls/nf-winnls-getacp).</span><span class="sxs-lookup"><span data-stu-id="9a236-119">For more information, see [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp).</span></span> <span data-ttu-id="9a236-120">Использовать это значение не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="9a236-120">Use of this value is not recommended.</span></span> <span data-ttu-id="9a236-121">Дополнительные сведения см. в подразделе "Примечания".</span><span class="sxs-lookup"><span data-stu-id="9a236-121">For more information, see Remarks.</span></span><br/> <span data-ttu-id="9a236-122">Если это значение отсутствует, строковые значения в новом наборе свойств хранятся в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="9a236-122">If this value is absent, string values in the new property set are stored in Unicode.</span></span> <span data-ttu-id="9a236-123">Степень контроля, предоставляемая этим значением, необходима, чтобы клиенты, использующие интерфейсы, связанные со свойствами, могли взаимодействовать со стандартными наборами свойств, такими как сводные данные OLE2, которые могут существовать в кодовой странице ANSI.</span><span class="sxs-lookup"><span data-stu-id="9a236-123">The degree of control that this value provides is necessary so that clients using the property-related interfaces can interoperate with standard property sets such as the OLE2 summary information, which may exist in the ANSI code page.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <span data-ttu-id="9a236-124"><dt>**Пропсетфлаг \_ Без БУФЕРИЗАЦИи**</dt> <dt>4</dt></span><span class="sxs-lookup"><span data-stu-id="9a236-124"><dt>**PROPSETFLAG\_UNBUFFERED**</dt> <dt>4</dt></span></span> </dl>              | <span data-ttu-id="9a236-125">Используется только с функциями [**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) и [**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) ; то есть в изолированных реализациях интерфейсов набора свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-125">Used only with the [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) and [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) functions; that is, in the stand-alone implementations of property set interfaces.</span></span> <span data-ttu-id="9a236-126">Если этот параметр указан в этих функциях, изменения в наборе свойств не буферизуются.</span><span class="sxs-lookup"><span data-stu-id="9a236-126">If specified in these functions, changes to the property set are not buffered.</span></span> <span data-ttu-id="9a236-127">Вместо этого изменения всегда записываются непосредственно в набор свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-127">Instead, changes are always written directly to the property set.</span></span> <span data-ttu-id="9a236-128">Вызовы методов набора свойств [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) изменятся.</span><span class="sxs-lookup"><span data-stu-id="9a236-128">Calls to a property set [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) methods will change it.</span></span> <span data-ttu-id="9a236-129">Однако по умолчанию изменения буферизованы во внутренний кэш набора свойств и затем записываются в свойство, заданное при вызове метода [**ипропертистораже:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) .</span><span class="sxs-lookup"><span data-stu-id="9a236-129">However, by default, changes are buffered in an internal property set cache and are subsequently written to the property set when the [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) method is called.</span></span> <br/> <span data-ttu-id="9a236-130">Установка **пропсетфлаг без \_ буферизации** приводит к снижению производительности, так как внутренний буфер набора свойств автоматически очищается после каждого изменения набора свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-130">Setting **PROPSETFLAG\_UNBUFFERED** decreases performance because the property set internal buffer is automatically flushed after every change to the property set.</span></span> <span data-ttu-id="9a236-131">Однако непосредственная запись изменений предотвратит проблемы координации.</span><span class="sxs-lookup"><span data-stu-id="9a236-131">However, writing changes directly will prevent coordination problems.</span></span> <span data-ttu-id="9a236-132">Например, если объект хранилища открыт в режиме транзакций, а набор свойств буферизован.</span><span class="sxs-lookup"><span data-stu-id="9a236-132">For example, if the storage object is opened in transacted mode, and the property set is buffered.</span></span> <span data-ttu-id="9a236-133">Затем, если вызвать метод [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) объекта хранилища, изменения набора свойств не будут выбраны как часть транзакции, так как они находятся в буфере, который еще не был сброшен.</span><span class="sxs-lookup"><span data-stu-id="9a236-133">Then, if you call the [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) method on the storage object, the property set changes will not be picked up as part of the transaction, because they are in a buffer that has not been flushed yet.</span></span> <span data-ttu-id="9a236-134">Необходимо вызвать метод [**ипропертистораже:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) перед вызовом **IStorage:: Commit** для очистки буфера набора свойств перед фиксацией изменений в хранилище.</span><span class="sxs-lookup"><span data-stu-id="9a236-134">You must call [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) prior to calling **IStorage::Commit** to flush the property set buffer before committing changes to the storage.</span></span> <span data-ttu-id="9a236-135">В качестве альтернативы выполнению двух вызовов можно установить **пропсетфлаг без \_ буферизации** , чтобы изменения всегда записывались непосредственно в набор свойств и никогда не помещаются в буфер во внутреннем кэше набора свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-135">As an alternative to making two calls, you can set **PROPSETFLAG\_UNBUFFERED** so that changes are always written directly to the property set and are never buffered in the property set's internal cache.</span></span> <span data-ttu-id="9a236-136">Затем изменения будут отобраны при фиксации хранилища транзакций.</span><span class="sxs-lookup"><span data-stu-id="9a236-136">Then, the changes will be picked up when the transacted storage is committed.</span></span><br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <span data-ttu-id="9a236-137"><dt>**Пропсетфлаг \_ \_С учетом регистра**</dt> <dt>8</dt></span><span class="sxs-lookup"><span data-stu-id="9a236-137"><dt>**PROPSETFLAG\_CASE\_SENSITIVE**</dt> <dt>8</dt></span></span> </dl> | <span data-ttu-id="9a236-138">Если указано, в именах свойств учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="9a236-138">If specified, property names are case sensitive.</span></span> <span data-ttu-id="9a236-139">Имена свойств с учетом регистра возможны только в формате сериализации набора свойств версии 1.</span><span class="sxs-lookup"><span data-stu-id="9a236-139">Case-sensitive property names are only possible in the version 1 property set serialization format.</span></span> <span data-ttu-id="9a236-140">Дополнительные сведения см. в разделе [Свойства Сериализация набора свойств](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="9a236-140">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a><span data-ttu-id="9a236-141">Комментарии</span><span class="sxs-lookup"><span data-stu-id="9a236-141">Remarks</span></span>

<span data-ttu-id="9a236-142">Эти значения можно установить и проверить с помощью побитовых операций, которые определяют, как создаются и открываются наборы свойств.</span><span class="sxs-lookup"><span data-stu-id="9a236-142">These values can be set and checked using bitwise operations that determine how property sets are created and opened.</span></span> <span data-ttu-id="9a236-143">Наборы свойств создаются с помощью метода [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) или функции [**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) .</span><span class="sxs-lookup"><span data-stu-id="9a236-143">Property sets are created using the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method or the [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) function.</span></span> <span data-ttu-id="9a236-144">Они открываются с помощью метода [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) или функции [**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .</span><span class="sxs-lookup"><span data-stu-id="9a236-144">They are opened using the [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method or the [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) function.</span></span>

<span data-ttu-id="9a236-145">Рекомендуется создавать наборы свойств в Юникоде, не устанавливая флаг **\_ ANSI пропсетфлаг** в параметре *грффлагс* .</span><span class="sxs-lookup"><span data-stu-id="9a236-145">It is recommended that property sets be created as Unicode by not setting the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter.</span></span> <span data-ttu-id="9a236-146">Также рекомендуется избегать использования \_ значений VT LPSTR и использовать \_ вместо них значения VT LPWSTR.</span><span class="sxs-lookup"><span data-stu-id="9a236-146">It is also recommended that you avoid using VT\_LPSTR values, and use VT\_LPWSTR values instead.</span></span> <span data-ttu-id="9a236-147">Если кодовая страница набора свойств — Unicode, \_ строковые значения VT LPSTR преобразуются в Юникод при сохранении и преобразуются обратно в многобайтовые строковые значения при извлечении.</span><span class="sxs-lookup"><span data-stu-id="9a236-147">When the property set code page is Unicode, VT\_LPSTR string values are converted to Unicode when stored, and converted back to multibyte string values when retrieved.</span></span> <span data-ttu-id="9a236-148">Если кодовая страница набора свойств не является Юникодом, имена свойств, строки VT \_ и непростые значения свойств преобразуются в многобайтовые строки при сохранении и преобразуются обратно в Юникод при извлечении, то все используют текущую системную кодовую страницу ANSI.</span><span class="sxs-lookup"><span data-stu-id="9a236-148">When the code page of the property set is not Unicode, property names, VT\_BSTR strings, and nonsimple property values are converted to multibyte strings when stored, and converted back to Unicode when retrieved, all using the current system ANSI code page.</span></span>

## <a name="requirements"></a><span data-ttu-id="9a236-149">Требования</span><span class="sxs-lookup"><span data-stu-id="9a236-149">Requirements</span></span>



| <span data-ttu-id="9a236-150">Требование</span><span class="sxs-lookup"><span data-stu-id="9a236-150">Requirement</span></span> | <span data-ttu-id="9a236-151">Значение</span><span class="sxs-lookup"><span data-stu-id="9a236-151">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------|
| <span data-ttu-id="9a236-152">Минимальная версия клиента</span><span class="sxs-lookup"><span data-stu-id="9a236-152">Minimum supported client</span></span><br/> | <span data-ttu-id="9a236-153">Windows 2000 Professional \[только классические приложения\]</span><span class="sxs-lookup"><span data-stu-id="9a236-153">Windows 2000 Professional \[desktop apps only\]</span></span><br/>                           |
| <span data-ttu-id="9a236-154">Минимальная версия сервера</span><span class="sxs-lookup"><span data-stu-id="9a236-154">Minimum supported server</span></span><br/> | <span data-ttu-id="9a236-155">Windows 2000 Server \[только классические приложения\]</span><span class="sxs-lookup"><span data-stu-id="9a236-155">Windows 2000 Server \[desktop apps only\]</span></span><br/>                                 |
| <span data-ttu-id="9a236-156">Заголовок</span><span class="sxs-lookup"><span data-stu-id="9a236-156">Header</span></span><br/>                   | <dl> <span data-ttu-id="9a236-157"><dt>Пропидл. h</dt></span><span class="sxs-lookup"><span data-stu-id="9a236-157"><dt>Propidl.h</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="9a236-158">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="9a236-158">See also</span></span>

<dl> <dt>

[<span data-ttu-id="9a236-159">**фмтидтопропстгнаме**</span><span class="sxs-lookup"><span data-stu-id="9a236-159">**FmtIdToPropStgName**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[<span data-ttu-id="9a236-160">**IPropertySetStorage:: Create**</span><span class="sxs-lookup"><span data-stu-id="9a236-160">**IPropertySetStorage::Create**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[<span data-ttu-id="9a236-161">**IPropertySetStorage:: Open**</span><span class="sxs-lookup"><span data-stu-id="9a236-161">**IPropertySetStorage::Open**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[<span data-ttu-id="9a236-162">**пропстгнаметофмтид**</span><span class="sxs-lookup"><span data-stu-id="9a236-162">**PropStgNameToFmtId**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[<span data-ttu-id="9a236-163">**стгкреатепропсетстг**</span><span class="sxs-lookup"><span data-stu-id="9a236-163">**StgCreatePropSetStg**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[<span data-ttu-id="9a236-164">**стгкреатепропстг**</span><span class="sxs-lookup"><span data-stu-id="9a236-164">**StgCreatePropStg**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[<span data-ttu-id="9a236-165">**стгопенпропстг**</span><span class="sxs-lookup"><span data-stu-id="9a236-165">**StgOpenPropStg**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

