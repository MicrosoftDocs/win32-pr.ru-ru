---
title: Реализация файла IPropertyStorage-Compound
description: Реализация структурированной архитектуры хранилища COM называется составными файлами.
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- Ипропертистораже Стрктд STG, реализации, составной файл
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103890773"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="ffd56-104">Реализация файла IPropertyStorage-Compound</span><span class="sxs-lookup"><span data-stu-id="ffd56-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="ffd56-105">Реализация структурированной архитектуры хранилища COM называется [составными файлами](istorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="ffd56-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="ffd56-106">Объекты хранения, реализованные в составных файлах, включают реализацию обоих [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), интерфейс, управляющий одним набором постоянных свойств, и [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), интерфейс, который управляет группами постоянных наборов свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="ffd56-107">Дополнительные сведения об интерфейсе **ипропертистораже** см. в разделе [рекомендации по хранению](property-storage-considerations.md) **ипропертистораже** и свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="ffd56-108">Чтобы получить указатель на реализацию составного файла [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), вызовите [**стгкреатесторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) , чтобы создать новый объект составного файла, или [**стгопенсторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , чтобы открыть ранее созданный объект составного файла.</span><span class="sxs-lookup"><span data-stu-id="ffd56-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="ffd56-109">В случае с **стгкреатесторажеекс** параметр *стгфмт* должен иметь значение стгфмт \_ Storage.</span><span class="sxs-lookup"><span data-stu-id="ffd56-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="ffd56-110">В случае с **стгопенсторажеекс** параметр *стгфмт* должен иметь значение стгфмт \_ Storage или стгфмт \_ ANY.</span><span class="sxs-lookup"><span data-stu-id="ffd56-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="ffd56-111">В обоих случаях параметр *riid* должен иметь значение IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="ffd56-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="ffd56-112">Обе функции предоставляют указатель на интерфейс [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) объекта.</span><span class="sxs-lookup"><span data-stu-id="ffd56-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="ffd56-113">Вызвав метод [**создания**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) или [**открытия**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) этого интерфейса, вы получите указатель на интерфейс **ипропертистораже** , который можно использовать для вызова любого из его методов.</span><span class="sxs-lookup"><span data-stu-id="ffd56-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="ffd56-114">Альтернативный способ получения указателя на реализацию составного файла [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) заключается в вызове более старых функций [**стгкреатедокфиле**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) и [**стгопенстораже**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) или при указании параметра *riid* IID \_ IStorage для функции [**стгкреатесторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) или [**стгопенсторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="ffd56-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="ffd56-115">В любом случае возвращается указатель на интерфейс [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) объекта.</span><span class="sxs-lookup"><span data-stu-id="ffd56-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="ffd56-116">С помощью постоянных наборов свойств вызовите [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) для интерфейса **IPropertySetStorage** , указав определенное заголовком имя для идентификатора интерфейса IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="ffd56-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="ffd56-117">Назначение</span><span class="sxs-lookup"><span data-stu-id="ffd56-117">When to Use</span></span>

<span data-ttu-id="ffd56-118">Используйте [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) для управления свойствами в пределах одного набора свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="ffd56-119">Его методы поддерживают чтение, запись и удаление обоих свойств, а также необязательные имена строк, которые могут быть связаны с идентификаторами свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="ffd56-120">Другие методы поддерживают стандартные операции фиксации и отката хранилища.</span><span class="sxs-lookup"><span data-stu-id="ffd56-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="ffd56-121">Существует также метод, который позволяет задать время, связанное с хранилищем свойств, и другое, которое позволяет назначить идентификатор CLSID, который может использоваться для связывания другого кода, например кода пользовательского интерфейса, с набором свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="ffd56-122">Вызов метода [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) предоставляет указатель на реализацию составного файла [**иенумстатпропстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), который позволяет перечислить свойства в наборе.</span><span class="sxs-lookup"><span data-stu-id="ffd56-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="ffd56-123">Если вы получаете указатель на [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , вызывая [**стгкреатедокфиле**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**стгкреатесторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**стгопенстораже**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) или [**стгопенсторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) в хранилище с набором свойств простого режима, методы **IPropertyStorage** соответствуют правилам потоков простого режима.</span><span class="sxs-lookup"><span data-stu-id="ffd56-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="ffd56-124">Свойство хранилище устанавливается в простом режиме, если оно было получено для файла, который был создан или открыт с помощью \_ простого флага стгм.</span><span class="sxs-lookup"><span data-stu-id="ffd56-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="ffd56-125">В этом случае не всегда можно сделать базовый поток большим, и нельзя заменить существующие свойства более крупными свойствами.</span><span class="sxs-lookup"><span data-stu-id="ffd56-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="ffd56-126">Дополнительные сведения см. в разделе [реализация составного файла IPropertySetStorage](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="ffd56-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="ffd56-127">Ипропертистораже и кэширование</span><span class="sxs-lookup"><span data-stu-id="ffd56-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="ffd56-128">Реализация составного файла в кэше [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) открывает наборы свойств в памяти, чтобы повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="ffd56-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="ffd56-129">В результате изменения набора свойств не записываются в составной файл до тех пор, пока не будут вызваны методы [**фиксации**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) или **выпуска** (последняя ссылка).</span><span class="sxs-lookup"><span data-stu-id="ffd56-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="ffd56-130">Наборы свойств простого режима</span><span class="sxs-lookup"><span data-stu-id="ffd56-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="ffd56-131">Объект хранилища свойств находится в простом режиме, если он создается из объекта хранилища, установленного в простом режиме.</span><span class="sxs-lookup"><span data-stu-id="ffd56-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="ffd56-132">Например, объект хранилища, заданный свойством, будет находиться в простом режиме, если он был получен из функции [**стгопенсторажеекс**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) с \_ установленным в параметре *грфмоде* флагом стгм Simple.</span><span class="sxs-lookup"><span data-stu-id="ffd56-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="ffd56-133">Обратите внимание, что "простой режим" не связан с "простыми наборами свойств".</span><span class="sxs-lookup"><span data-stu-id="ffd56-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="ffd56-134">Набор свойств является простым, если он создается путем вызова [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) с \_ непростым флагом пропсетфлаг, установленным в параметре *грффлагс* .</span><span class="sxs-lookup"><span data-stu-id="ffd56-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="ffd56-135">Дополнительные сведения о простых и непростых наборах свойств см. [в разделе объекты хранилища и потока для набора свойств](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="ffd56-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="ffd56-136">При создании объекта хранилища свойств простого режима ограничения его использования отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="ffd56-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="ffd56-137">При открытии существующего объекта хранилища свойств простого режима его базовый объект потока, хранящий набор свойств, не может быть увеличен.</span><span class="sxs-lookup"><span data-stu-id="ffd56-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="ffd56-138">Следовательно, не всегда можно изменить такой объект хранилища свойств, если это изменение требует большого потока.</span><span class="sxs-lookup"><span data-stu-id="ffd56-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="ffd56-139">Форматы набора свойств</span><span class="sxs-lookup"><span data-stu-id="ffd56-139">Property Set Formats</span></span>

<span data-ttu-id="ffd56-140">Реализация составного файла [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) поддерживает свойства версии 0 и версии 1, устанавливающие форматы сериализации.</span><span class="sxs-lookup"><span data-stu-id="ffd56-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="ffd56-141">Формат версии 1 поддерживается на компьютерах под управлением Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="ffd56-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="ffd56-142">Дополнительные сведения см. в разделе [Свойства Сериализация набора свойств](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="ffd56-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="ffd56-143">Наборы свойств создаются в формате версии 0 и остаются в этом формате, если не запрашиваются новые функции.</span><span class="sxs-lookup"><span data-stu-id="ffd56-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="ffd56-144">В этом случае формат обновляется до версии 1.</span><span class="sxs-lookup"><span data-stu-id="ffd56-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="ffd56-145">Например, если набор свойств создается с \_ флагом пропсетфлаг по умолчанию, его формат имеет версию 0.</span><span class="sxs-lookup"><span data-stu-id="ffd56-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="ffd56-146">При условии, что типы свойств, соответствующие формату версии 0, записываются и считываются из этого набора свойств, набор свойств остается в формате версии 0.</span><span class="sxs-lookup"><span data-stu-id="ffd56-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="ffd56-147">Если тип свойства версии 1 записывается в набор свойств, набор свойств автоматически обновляется до версии 1.</span><span class="sxs-lookup"><span data-stu-id="ffd56-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="ffd56-148">Впоследствии этот набор свойств больше не может быть прочитан реализациями, которые распознают только версию 0.</span><span class="sxs-lookup"><span data-stu-id="ffd56-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="ffd56-149">Типы Ипропертистораже и Variant</span><span class="sxs-lookup"><span data-stu-id="ffd56-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="ffd56-150">Реализация составного файла [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) не поддерживает типы Variant \_ неизвестные или VT \_ Dispatch в элементе **VT** структуры [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="ffd56-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="ffd56-151">В следующей таблице перечислены типы Variant, которые поддерживаются в массиве SafeArray. Это значит, что эти значения можно комбинировать с \_ массивом VT в элементе **VT** структуры [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="ffd56-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="ffd56-152">Типы Variant, поддерживаемые в SafeArray путем реализации составного файла для Ипропертистораже</span><span class="sxs-lookup"><span data-stu-id="ffd56-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="ffd56-153">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="ffd56-153">VT\_I1</span></span>

<span data-ttu-id="ffd56-154">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="ffd56-154">VT\_UI1</span></span>

<span data-ttu-id="ffd56-155">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="ffd56-155">VT\_I2</span></span>

<span data-ttu-id="ffd56-156">VT \_ UI2</span><span class="sxs-lookup"><span data-stu-id="ffd56-156">VT\_UI2</span></span>

<span data-ttu-id="ffd56-157">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="ffd56-157">VT\_I4</span></span>

<span data-ttu-id="ffd56-158">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="ffd56-158">VT\_UI4</span></span>

<span data-ttu-id="ffd56-159">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="ffd56-159">VT\_INT</span></span>

<span data-ttu-id="ffd56-160">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="ffd56-160">VT\_UINT</span></span>

<span data-ttu-id="ffd56-161">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="ffd56-161">VT\_R4</span></span>

<span data-ttu-id="ffd56-162">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="ffd56-162">VT\_R8</span></span>

<span data-ttu-id="ffd56-163">VT \_ CY</span><span class="sxs-lookup"><span data-stu-id="ffd56-163">VT\_CY</span></span>

<span data-ttu-id="ffd56-164">\_Дата VT</span><span class="sxs-lookup"><span data-stu-id="ffd56-164">VT\_DATE</span></span>

<span data-ttu-id="ffd56-165">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="ffd56-165">VT\_BSTR</span></span>

<span data-ttu-id="ffd56-166">Логическое значение VT \_</span><span class="sxs-lookup"><span data-stu-id="ffd56-166">VT\_BOOL</span></span>

<span data-ttu-id="ffd56-167">VT \_ Decimal</span><span class="sxs-lookup"><span data-stu-id="ffd56-167">VT\_DECIMAL</span></span>

<span data-ttu-id="ffd56-168">\_Ошибка VT</span><span class="sxs-lookup"><span data-stu-id="ffd56-168">VT\_ERROR</span></span>

<span data-ttu-id="ffd56-169">\_вариант VT</span><span class="sxs-lookup"><span data-stu-id="ffd56-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="ffd56-170">Когда VT \_ Variant сочетается с \_ массивом VT, сам массив SafeArray содержит структуры [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="ffd56-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="ffd56-171">Тем не менее типы этих элементов должны быть взяты из предыдущего списка, не могут быть VT \_ и не могут включать \_ векторы VT, VT \_ или VT \_ ByRef.</span><span class="sxs-lookup"><span data-stu-id="ffd56-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="ffd56-172">Методы Ипропертистораже</span><span class="sxs-lookup"><span data-stu-id="ffd56-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="ffd56-173">Реализация составного файла [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) поддерживает следующие методы:</span><span class="sxs-lookup"><span data-stu-id="ffd56-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="ffd56-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**Ипропертистораже:: Реадмултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="ffd56-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-175">Считывает свойства, указанные в массиве *ргпспек* , и предоставляет значения всех допустимых свойств в массиве *ргвар* объекта пропвариантс.</span><span class="sxs-lookup"><span data-stu-id="ffd56-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="ffd56-176">В реализации составного файла COM дублированные идентификаторы свойств, которые ссылаются на типы Stream или Storage, приводят к многократному вызову [**IStorage:: опенстреам**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) или [**IStorage:: опенстораже**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) , а успех или неудача **реадмултипле** зависят от возможности реализации базового хранилища для совместного использования операций открытия.</span><span class="sxs-lookup"><span data-stu-id="ffd56-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="ffd56-177">Так как в составном файле СТГМ \_ общий ресурс с \_ монопольным доступом принудительно, несколько неудачных попыток открытия не удастся.</span><span class="sxs-lookup"><span data-stu-id="ffd56-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="ffd56-178">Открытие одного и того же объекта хранилища более одного раза из одного родительского хранилища не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="ffd56-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="ffd56-179">\_ \_ Необходимо указать флаг монопольного доступа стгм.</span><span class="sxs-lookup"><span data-stu-id="ffd56-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="ffd56-180">Кроме того, чтобы обеспечить поточно-ориентированную операцию, если одно и то же свойство Stream или Storage-value запрашивается несколько раз с помощью одного и того же указателя [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) в реализации составного файла com, операция открытия будет выполнена успешно или неудачно, в зависимости от того, открыто ли свойство, и является ли базовая файловая система, обрабатывающая несколько вакансий потока или хранилища.</span><span class="sxs-lookup"><span data-stu-id="ffd56-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="ffd56-181">Таким образом, операция **реадмултипле** для потока или свойства, возвращающего хранение, всегда приводит к вызову [**IStorage:: опенстреам**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)или [**IStorage:: опенстораже**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), который передает доступ (стгм ReadWrite и т. д. \_ ) и используют флаги общего доступа (стгм \_ Share \_ монопольно и т. д.), указанные при открытии или создании исходного набора свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="ffd56-182">Если метод завершается ошибкой, значения, записанные в *ргвар* , \[ \] не определяются.</span><span class="sxs-lookup"><span data-stu-id="ffd56-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="ffd56-183">Если некоторые свойства потока или значения, возвращающие хранилище, успешно открыты, но перед завершением выполнения возникает ошибка, они должны быть освобождены перед возвратом из метода.</span><span class="sxs-lookup"><span data-stu-id="ffd56-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**Ипропертистораже:: Вритемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="ffd56-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-185">Записывает свойства, указанные в  \[ \] массиве ргпспек, присваивая им теги [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) и значения, указанные в *ргвар* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="ffd56-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="ffd56-186">Свойства, которые уже существуют, присваиваются указанным значениям **пропвариант** .</span><span class="sxs-lookup"><span data-stu-id="ffd56-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="ffd56-187">Создаются свойства, которые в настоящее время не существуют.</span><span class="sxs-lookup"><span data-stu-id="ffd56-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**Ипропертистораже::D Елетемултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="ffd56-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-189">Удаляет свойства, указанные в параметре *ргпспек* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="ffd56-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**Ипропертистораже:: Реадпропертинамес**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="ffd56-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-191">Считывает существующие имена строк, связанные с идентификаторами свойств, указанными в  \[ \] массиве ргпропид.</span><span class="sxs-lookup"><span data-stu-id="ffd56-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**Ипропертистораже:: Вритепропертинамес**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="ffd56-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-193">Присваивает строковые имена, указанные в массиве *рглпвстрнаме* , с идентификаторами свойств, указанными в массиве *ргпропид* .</span><span class="sxs-lookup"><span data-stu-id="ffd56-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**Ипропертистораже::D Елетепропертинамес**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="ffd56-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-195">Удаляет имена свойств, указанных в  \[ \] массиве ргпропид.</span><span class="sxs-lookup"><span data-stu-id="ffd56-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**Ипропертистораже:: Сеткласс**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="ffd56-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-197">Задает **идентификатор CLSID** потока набора свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="ffd56-198">В реализации составного файла установка идентификатора CLSID для непростого набора свойств (в котором может храниться значение свойства, возвращающего хранение или потоковые значения, как описано в разделе [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) также задает идентификатор CLSID для базового подхранилища, чтобы его можно было получить с помощью вызова метода [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span><span class="sxs-lookup"><span data-stu-id="ffd56-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**Ипропертистораже:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="ffd56-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-200">Для простых и непростых наборов свойств очищает образ памяти, заданный свойством, в базовое хранилище.</span><span class="sxs-lookup"><span data-stu-id="ffd56-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="ffd56-201">Кроме того, для непростых наборов свойств в режиме транзакций этот метод выполняет фиксацию (как в [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) для хранилища, содержащего набор свойств.</span><span class="sxs-lookup"><span data-stu-id="ffd56-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**Ипропертистораже:: revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="ffd56-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-203">Для непростых наборов свойств вызывает метод [**reopen**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) базового хранилища и повторно открывает поток "содержимое".</span><span class="sxs-lookup"><span data-stu-id="ffd56-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="ffd56-204">Для простых наборов свойств этот интерфейс всегда возвращает значение S \_ ОК.</span><span class="sxs-lookup"><span data-stu-id="ffd56-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="ffd56-205">Непростые наборы свойств — это те, которые были созданы с помощью \_ НЕпростого флага пропсетфлаг в методе [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) .</span><span class="sxs-lookup"><span data-stu-id="ffd56-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="ffd56-206">Дополнительные сведения см. [в разделе объекты хранилища и потока для набора свойств](storage-vs--stream-for-a-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="ffd56-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**Ипропертистораже:: Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="ffd56-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-208">Конструирует экземпляр [**иенумстатпропстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), методы которого могут быть вызваны для перечисления структур [**статпропстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) , предоставляющих сведения о каждом свойстве в наборе.</span><span class="sxs-lookup"><span data-stu-id="ffd56-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="ffd56-209">Эта реализация создает массив, в который считывается весь набор свойств и который может использоваться совместно при вызове **иенумстатпропстг:: Clone** .</span><span class="sxs-lookup"><span data-stu-id="ffd56-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="ffd56-210">Изменения в наборе свойств не отражаются в открытом экземпляре **иенумстатпропстг** .</span><span class="sxs-lookup"><span data-stu-id="ffd56-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="ffd56-211">Чтобы увидеть такие изменения, необходимо создать новый экземпляр этого перечислителя.</span><span class="sxs-lookup"><span data-stu-id="ffd56-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**Ипропертистораже:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="ffd56-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-213">Заполняет элементы структуры [**статпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , которая содержит данные о свойстве, заданном в целом.</span><span class="sxs-lookup"><span data-stu-id="ffd56-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="ffd56-214">При возврате предоставляет указатель на структуру.</span><span class="sxs-lookup"><span data-stu-id="ffd56-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="ffd56-215">Для непростых наборов хранения Эта реализация вызывает метод [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (или [**IStream:: stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)), чтобы получить время из базового хранилища или потока.</span><span class="sxs-lookup"><span data-stu-id="ffd56-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="ffd56-216">Для простых наборов хранения время не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="ffd56-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="ffd56-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**Ипропертистораже:: Сеттимес**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="ffd56-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="ffd56-218">Для непростых наборов свойств задает время, поддерживаемое базовым хранилищем.</span><span class="sxs-lookup"><span data-stu-id="ffd56-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="ffd56-219">Реализация хранилища составных файлов поддерживает все три: изменение, доступ и создание.</span><span class="sxs-lookup"><span data-stu-id="ffd56-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="ffd56-220">Эта реализация [**сеттимес**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) вызывает метод [**IStorage:: сетелементтимес**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) базового хранилища для получения этих значений.</span><span class="sxs-lookup"><span data-stu-id="ffd56-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="ffd56-221">См. также</span><span class="sxs-lookup"><span data-stu-id="ffd56-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ffd56-222">**ипропертистораже**</span><span class="sxs-lookup"><span data-stu-id="ffd56-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="ffd56-223">**IStorage:: Сетелементтимес**</span><span class="sxs-lookup"><span data-stu-id="ffd56-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 